import{a0 as t,p as f,s as m,az as E,aA as T,d8 as y,a3 as d,bo as D}from"./index-bdd9114a.js";const P={BingMapsLayer:async()=>(await t(()=>import("./BingMapsLayer-f685dd39.js"),["./BingMapsLayer-f685dd39.js","./index-bdd9114a.js","..\\index-b7f3bae3.css","./imageBitmapUtils-bb779f7f.js"],import.meta.url)).default,BuildingSceneLayer:async()=>(await t(()=>import("./BuildingSceneLayer-709d0ef3.js"),["./BuildingSceneLayer-709d0ef3.js","./index-bdd9114a.js","..\\index-b7f3bae3.css","./I3SUtil-3f7f6aaf.js","./mat3f64-221ce671.js","./mat4f64-1413b4a7.js","./quat-4dfca788.js","./quatf64-3363c48e.js","./spatialReferenceEllipsoidUtils-c03118e9.js","./I3SBinaryReader-fc534e2a.js","./VertexAttribute-0e674613.js","./orientedBoundingBox-cb008ab4.js","./plane-4aef2251.js","./sphere-942f6d64.js","./SceneService-2acbdaa0.js","./originUtils-cfe4feaf.js","./multiOriginJSONSupportUtils-c978f4c3.js","./saveAPIKeyUtils-e295716d.js","./saveUtils-41c3215f.js","./resourceUtils-5b91417f.js","./I3SLayerDefinitions-1a92b4bb.js","./popupUtils-57751b93.js","./elevationInfoUtils-fe63a931.js"],import.meta.url)).default,CSVLayer:async()=>(await t(()=>import("./CSVLayer-8ca63e6c.js"),["./CSVLayer-8ca63e6c.js","./index-bdd9114a.js","..\\index-b7f3bae3.css","./clientSideDefaults-f9ec58e3.js","./QueryEngineCapabilities-85c4f1d0.js"],import.meta.url)).default,DimensionLayer:async()=>(await t(()=>import("./DimensionLayer-dd3f2303.js"),["./DimensionLayer-dd3f2303.js","./index-bdd9114a.js","..\\index-b7f3bae3.css","./Analysis-a901a3f5.js"],import.meta.url)).default,ElevationLayer:async()=>(await t(()=>import("./ElevationLayer-6bcd21cb.js"),["./ElevationLayer-6bcd21cb.js","./index-bdd9114a.js","..\\index-b7f3bae3.css"],import.meta.url)).default,FeatureLayer:async()=>(await t(()=>import("./index-bdd9114a.js").then(e=>e.oV),["./index-bdd9114a.js","..\\index-b7f3bae3.css"],import.meta.url)).default,GeoJSONLayer:async()=>(await t(()=>import("./GeoJSONLayer-f35f308d.js"),["./GeoJSONLayer-f35f308d.js","./index-bdd9114a.js","..\\index-b7f3bae3.css","./clientSideDefaults-f9ec58e3.js","./QueryEngineCapabilities-85c4f1d0.js"],import.meta.url)).default,GeoRSSLayer:async()=>(await t(()=>import("./GeoRSSLayer-a0dc99b1.js"),["./GeoRSSLayer-a0dc99b1.js","./index-bdd9114a.js","..\\index-b7f3bae3.css"],import.meta.url)).default,GroupLayer:async()=>(await t(()=>import("./GroupLayer-e848b759.js"),["./GroupLayer-e848b759.js","./index-bdd9114a.js","..\\index-b7f3bae3.css","./saveUtils-41c3215f.js","./resourceUtils-5b91417f.js"],import.meta.url)).default,ImageryLayer:async()=>(await t(()=>import("./ImageryLayer-fa70aaf9.js"),["./ImageryLayer-fa70aaf9.js","./index-bdd9114a.js","..\\index-b7f3bae3.css","./ImageHistogramParameters-6bb7fd2c.js","./multidimensionalUtils-714c94c9.js","./dataUtils-d865d188.js","./RasterSymbolizer-10ac6b47.js","./utils-8326fd80.js","./utils-d90cc435.js","./generateRendererUtils-acbb584b.js","./imageBitmapUtils-bb779f7f.js","./executeQueryJSON-187de969.js","./query-a68e62d5.js","./pbfQueryUtils-9ac2349f.js","./pbf-8dd696ed.js","./OptimizedGeometry-d94e541f.js","./OptimizedFeatureSet-1d1ac4b9.js","./featureConversionUtils-29e5d71f.js","./AttachmentInfo-79046b05.js","./executeForIds-6bdd557b.js"],import.meta.url)).default,ImageryTileLayer:async()=>(await t(()=>import("./ImageryTileLayer-e85adc60.js"),["./ImageryTileLayer-e85adc60.js","./index-bdd9114a.js","..\\index-b7f3bae3.css","./ImageHistogramParameters-6bb7fd2c.js","./multidimensionalUtils-714c94c9.js","./dataUtils-d865d188.js","./RasterSymbolizer-10ac6b47.js","./utils-8326fd80.js","./utils-d90cc435.js","./generateRendererUtils-acbb584b.js","./RawBlockCache-0576a381.js","./rasterProjectionHelper-260582cb.js","./utils-fb8e2d6f.js"],import.meta.url)).default,IntegratedMeshLayer:async()=>(await t(()=>import("./IntegratedMeshLayer-ca17f43c.js"),["./IntegratedMeshLayer-ca17f43c.js","./index-bdd9114a.js","..\\index-b7f3bae3.css","./persistable-df3d1f1e.js","./multiOriginJSONSupportUtils-c978f4c3.js","./resourceExtension-e2e7e11a.js","./SceneService-2acbdaa0.js","./originUtils-cfe4feaf.js","./saveAPIKeyUtils-e295716d.js","./saveUtils-41c3215f.js","./resourceUtils-5b91417f.js","./I3SLayerDefinitions-1a92b4bb.js","./elevationInfoUtils-fe63a931.js"],import.meta.url)).default,KMLLayer:async()=>(await t(()=>import("./KMLLayer-d2cc119d.js"),["./KMLLayer-d2cc119d.js","./index-bdd9114a.js","..\\index-b7f3bae3.css","./kmlUtils-d7163388.js"],import.meta.url)).default,LineOfSightLayer:async()=>(await t(()=>import("./LineOfSightLayer-c1a6de2f.js"),["./LineOfSightLayer-c1a6de2f.js","./index-bdd9114a.js","..\\index-b7f3bae3.css","./Analysis-a901a3f5.js","./persistable-df3d1f1e.js","./multiOriginJSONSupportUtils-c978f4c3.js","./resourceExtension-e2e7e11a.js","./elevationInfoUtils-fe63a931.js"],import.meta.url)).default,LinkChartLayer:async()=>(await t(()=>import("./LinkChartLayer-32374b0b.js"),["./LinkChartLayer-32374b0b.js","./index-bdd9114a.js","..\\index-b7f3bae3.css","./geohashUtils-77d8429b.js","./featureConversionUtils-29e5d71f.js","./OptimizedGeometry-d94e541f.js","./OptimizedFeatureSet-1d1ac4b9.js","./FeatureStore-ccd3f922.js","./BoundsStore-d765e314.js","./PooledRBush-5922a1c6.js","./timeSupport-621a6ccc.js","./projectionSupport-9a5294ee.js","./json-48e3ea08.js","./QueryEngine-b3610a24.js","./WhereClause-c3938d69.js","./TimeOnly-b3735f81.js","./QueryEngineCapabilities-85c4f1d0.js","./quantizationUtils-6d48d3ad.js","./utils-83a8940b.js","./utils-97c80fd4.js","./generateRendererUtils-acbb584b.js","./RenderState-1d6218ee.js","./clientSideDefaults-f9ec58e3.js"],import.meta.url)).default,MapImageLayer:async()=>(await t(()=>import("./MapImageLayer-5e76477a.js"),["./MapImageLayer-5e76477a.js","./index-bdd9114a.js","..\\index-b7f3bae3.css","./scaleUtils-6eb2bff6.js","./SublayersOwner-f643dc20.js","./QueryTask-3945e4cf.js","./executeForIds-6bdd557b.js","./query-a68e62d5.js","./pbfQueryUtils-9ac2349f.js","./pbf-8dd696ed.js","./OptimizedGeometry-d94e541f.js","./OptimizedFeatureSet-1d1ac4b9.js","./executeQueryJSON-187de969.js","./executeQueryPBF-0811e4b5.js","./featureConversionUtils-29e5d71f.js","./sublayerUtils-636bcdd1.js","./ExportImageParameters-4411c534.js","./floorFilterUtils-080a7cd2.js","./imageBitmapUtils-bb779f7f.js"],import.meta.url)).default,MapNotesLayer:async()=>(await t(()=>import("./MapNotesLayer-0df44c2c.js"),["./MapNotesLayer-0df44c2c.js","./index-bdd9114a.js","..\\index-b7f3bae3.css","./GraphicsLayer-2eac48bf.js","./objectIdUtils-789e911a.js"],import.meta.url)).default,MediaLayer:async()=>(await t(()=>import("./MediaLayer-87a384bb.js"),["./MediaLayer-87a384bb.js","./index-bdd9114a.js","..\\index-b7f3bae3.css","./imageUtils-1bdc933e.js","./perspectiveUtils-42f6bd4b.js","./normalizeUtilsSync-78fceabd.js","./mat3f64-221ce671.js","./resourceExtension-e2e7e11a.js","./BoundsStore-d765e314.js","./PooledRBush-5922a1c6.js"],import.meta.url)).default,OGCFeatureLayer:async()=>(await t(()=>import("./OGCFeatureLayer-5f20f4f8.js"),["./OGCFeatureLayer-5f20f4f8.js","./index-bdd9114a.js","..\\index-b7f3bae3.css","./ogcFeatureUtils-cc079f9d.js","./featureConversionUtils-29e5d71f.js","./OptimizedGeometry-d94e541f.js","./OptimizedFeatureSet-1d1ac4b9.js","./geojson-1e3b75bf.js","./date-d60e9730.js","./clientSideDefaults-f9ec58e3.js","./QueryEngineCapabilities-85c4f1d0.js"],import.meta.url)).default,OpenStreetMapLayer:async()=>(await t(()=>import("./OpenStreetMapLayer-e99eb7d2.js"),["./OpenStreetMapLayer-e99eb7d2.js","./index-bdd9114a.js","..\\index-b7f3bae3.css","./WebTileLayer-8aa30fd0.js","./imageBitmapUtils-bb779f7f.js"],import.meta.url)).default,OrientedImageryLayer:async()=>(await t(()=>import("./OrientedImageryLayer-064b92d1.js"),["./OrientedImageryLayer-064b92d1.js","./index-bdd9114a.js","..\\index-b7f3bae3.css"],import.meta.url)).default,PointCloudLayer:async()=>(await t(()=>import("./PointCloudLayer-e2b9b612.js"),["./PointCloudLayer-e2b9b612.js","./index-bdd9114a.js","..\\index-b7f3bae3.css","./SceneService-2acbdaa0.js","./originUtils-cfe4feaf.js","./multiOriginJSONSupportUtils-c978f4c3.js","./saveAPIKeyUtils-e295716d.js","./saveUtils-41c3215f.js","./resourceUtils-5b91417f.js","./PointCloudUniqueValueRenderer-548b2dce.js","./elevationInfoUtils-fe63a931.js"],import.meta.url)).default,RouteLayer:async()=>(await t(()=>import("./RouteLayer-c658df62.js"),["./RouteLayer-c658df62.js","./index-bdd9114a.js","..\\index-b7f3bae3.css","./originUtils-cfe4feaf.js","./multiOriginJSONSupportUtils-c978f4c3.js","./Stop-aa79ad32.js","./commonProperties-da958896.js"],import.meta.url)).default,SceneLayer:async()=>(await t(()=>import("./SceneLayer-8cc528f0.js"),["./SceneLayer-8cc528f0.js","./index-bdd9114a.js","..\\index-b7f3bae3.css","./SceneService-2acbdaa0.js","./originUtils-cfe4feaf.js","./multiOriginJSONSupportUtils-c978f4c3.js","./saveAPIKeyUtils-e295716d.js","./saveUtils-41c3215f.js","./resourceUtils-5b91417f.js","./I3SUtil-3f7f6aaf.js","./mat3f64-221ce671.js","./mat4f64-1413b4a7.js","./quat-4dfca788.js","./quatf64-3363c48e.js","./spatialReferenceEllipsoidUtils-c03118e9.js","./I3SBinaryReader-fc534e2a.js","./VertexAttribute-0e674613.js","./orientedBoundingBox-cb008ab4.js","./plane-4aef2251.js","./sphere-942f6d64.js","./I3SLayerDefinitions-1a92b4bb.js","./persistable-df3d1f1e.js","./resourceExtension-e2e7e11a.js","./elevationInfoUtils-fe63a931.js","./popupUtils-57751b93.js"],import.meta.url)).default,StreamLayer:async()=>(await t(()=>import("./StreamLayer-b245e8f4.js"),["./StreamLayer-b245e8f4.js","./index-bdd9114a.js","..\\index-b7f3bae3.css"],import.meta.url)).default,SubtypeGroupLayer:async()=>(await t(()=>import("./SubtypeGroupLayer-97a041bd.js"),["./SubtypeGroupLayer-97a041bd.js","./index-bdd9114a.js","..\\index-b7f3bae3.css"],import.meta.url)).default,TileLayer:async()=>(await t(()=>import("./TileLayer-1ce046f7.js"),["./TileLayer-1ce046f7.js","./index-bdd9114a.js","..\\index-b7f3bae3.css","./SublayersOwner-f643dc20.js","./QueryTask-3945e4cf.js","./executeForIds-6bdd557b.js","./query-a68e62d5.js","./pbfQueryUtils-9ac2349f.js","./pbf-8dd696ed.js","./OptimizedGeometry-d94e541f.js","./OptimizedFeatureSet-1d1ac4b9.js","./executeQueryJSON-187de969.js","./executeQueryPBF-0811e4b5.js","./featureConversionUtils-29e5d71f.js","./sublayerUtils-636bcdd1.js","./imageBitmapUtils-bb779f7f.js"],import.meta.url)).default,UnknownLayer:async()=>(await t(()=>import("./UnknownLayer-87be466e.js"),["./UnknownLayer-87be466e.js","./index-bdd9114a.js","..\\index-b7f3bae3.css"],import.meta.url)).default,UnsupportedLayer:async()=>(await t(()=>import("./UnsupportedLayer-69af102e.js"),["./UnsupportedLayer-69af102e.js","./index-bdd9114a.js","..\\index-b7f3bae3.css"],import.meta.url)).default,VectorTileLayer:async()=>(await t(()=>import("./index-bdd9114a.js").then(e=>e.oR),["./index-bdd9114a.js","..\\index-b7f3bae3.css"],import.meta.url)).default,VoxelLayer:async()=>(await t(()=>import("./VoxelLayer-6cb99cba.js"),["./VoxelLayer-6cb99cba.js","./index-bdd9114a.js","..\\index-b7f3bae3.css","./SceneService-2acbdaa0.js","./originUtils-cfe4feaf.js","./multiOriginJSONSupportUtils-c978f4c3.js","./saveAPIKeyUtils-e295716d.js","./saveUtils-41c3215f.js","./resourceUtils-5b91417f.js","./persistable-df3d1f1e.js","./resourceExtension-e2e7e11a.js","./quat-4dfca788.js","./mat3f64-221ce671.js","./quatf64-3363c48e.js"],import.meta.url)).default,WFSLayer:async()=>(await t(()=>import("./WFSLayer-7a1dea3f.js"),["./WFSLayer-7a1dea3f.js","./index-bdd9114a.js","..\\index-b7f3bae3.css","./clientSideDefaults-f9ec58e3.js","./QueryEngineCapabilities-85c4f1d0.js","./wfsUtils-199bb74a.js","./geojson-1e3b75bf.js","./date-d60e9730.js","./OptimizedGeometry-d94e541f.js","./xmlUtils-444cb4c0.js"],import.meta.url)).default,WMSLayer:async()=>(await t(()=>import("./WMSLayer-7a716b31.js"),["./WMSLayer-7a716b31.js","./index-bdd9114a.js","..\\index-b7f3bae3.css","./scaleUtils-6eb2bff6.js","./crsUtils-3bab3d8c.js","./ExportWMSImageParameters-03286aef.js","./imageBitmapUtils-bb779f7f.js"],import.meta.url)).default,WMTSLayer:async()=>(await t(()=>import("./WMTSLayer-1fb9e90c.js"),["./WMTSLayer-1fb9e90c.js","./index-bdd9114a.js","..\\index-b7f3bae3.css","./WebTileLayer-8aa30fd0.js","./imageBitmapUtils-bb779f7f.js","./crsUtils-3bab3d8c.js","./xmlUtils-444cb4c0.js"],import.meta.url)).default,WebTileLayer:async()=>(await t(()=>import("./WebTileLayer-8aa30fd0.js").then(e=>e.W),["./WebTileLayer-8aa30fd0.js","./index-bdd9114a.js","..\\index-b7f3bae3.css","./imageBitmapUtils-bb779f7f.js"],import.meta.url)).default};async function h(e,o){const i=f(e);if(!i)throw new m("invalid-url","Invalid scene service url");const a={...o,sceneServerUrl:i.url.path,layerId:i.sublayer??void 0};if(a.sceneLayerItem??(a.sceneLayerItem=await A(a)),a.sceneLayerItem==null)return L(a.sceneServerUrl.replace("/SceneServer","/FeatureServer"),a);const r=await R(a);if(!(r!=null&&r.url))throw new m("related-service-not-found","Could not find feature service through portal item relationship");const _=await L(r.url,a);return _.portalItem=r,_}async function A(e){const o=(await v(e)).serviceItemId;if(!o)return null;const i=new E({id:o,apiKey:e.apiKey}),a=await O(e);a!=null&&(i.portal=new T({url:a}));try{return i.load({signal:e.signal})}catch(r){return y(r),null}}async function v(e){if(e.rootDocument)return e.rootDocument;const o={query:{f:"json",token:e.apiKey},responseType:"json",signal:e.signal};try{const i=await d(e.sceneServerUrl,o);e.rootDocument=i.data}catch{e.rootDocument={}}return e.rootDocument}async function O(e){var a;const o=(a=D)==null?void 0:a.findServerInfo(e.sceneServerUrl);if(o!=null&&o.owningSystemUrl)return o.owningSystemUrl;const i=e.sceneServerUrl.replace(/(.*\/rest)\/.*/i,"$1")+"/info";try{const r=(await d(i,{query:{f:"json"},responseType:"json",signal:e.signal})).data.owningSystemUrl;if(r)return r}catch(r){y(r)}return null}async function L(e,o){const i=f(e);if(!i)throw new m("invalid-feature-service-url","Invalid feature service url");const a=i.url.path,r=o.layerId;if(r==null)return{serverUrl:a};const _=v(o),c=n=>{const I={query:{f:"json"},responseType:"json",authMode:n,signal:o.signal};return d(a,I)},w=c("anonymous").catch(()=>c("no-prompt")),[p,l]=await Promise.all([w,_]),s=l==null?void 0:l.layers,u=p.data&&p.data.layers;if(!Array.isArray(u))throw new Error("expected layers array");if(Array.isArray(s)){for(let n=0;n<Math.min(s.length,u.length);n++)if(s[n].id===r)return{serverUrl:a,layerId:u[n].id}}else if(r!=null&&r<u.length)return{serverUrl:a,layerId:u[r].id};throw new Error("could not find matching associated sublayer")}async function R({sceneLayerItem:e,signal:o}){if(!e)return null;try{const i=(await e.fetchRelatedItems({relationshipType:"Service2Service",direction:"reverse"},{signal:o})).find(r=>r.type==="Feature Service")||null;if(!i)return null;const a=new E({portal:i.portal,id:i.id});return await a.load(),a}catch(i){return y(i),null}}export{P as a,h as l};
