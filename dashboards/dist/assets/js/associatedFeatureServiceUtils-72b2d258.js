import{a0 as t,p as f,s as m,az as E,aA as T,d8 as y,a3 as d,bo as D}from"./index-2abb185a.js";const P={BingMapsLayer:async()=>(await t(()=>import("./BingMapsLayer-a497ac8f.js"),["./BingMapsLayer-a497ac8f.js","./index-2abb185a.js","..\\index-b7f3bae3.css","./imageBitmapUtils-2e90eec1.js"],import.meta.url)).default,BuildingSceneLayer:async()=>(await t(()=>import("./BuildingSceneLayer-a5bc5581.js"),["./BuildingSceneLayer-a5bc5581.js","./index-2abb185a.js","..\\index-b7f3bae3.css","./I3SUtil-e2ec904c.js","./mat3f64-221ce671.js","./mat4f64-1413b4a7.js","./quat-87c2ed51.js","./quatf64-3363c48e.js","./spatialReferenceEllipsoidUtils-9d3b30dd.js","./I3SBinaryReader-a951d5da.js","./VertexAttribute-0e674613.js","./orientedBoundingBox-58bcc5b5.js","./plane-3e55c930.js","./sphere-1cb8d3a6.js","./SceneService-208b5e82.js","./originUtils-cfe4feaf.js","./multiOriginJSONSupportUtils-c978f4c3.js","./saveAPIKeyUtils-31f46756.js","./saveUtils-2eb77573.js","./resourceUtils-e689da6c.js","./I3SLayerDefinitions-83902bae.js","./popupUtils-3e90e5e6.js","./elevationInfoUtils-aace8559.js"],import.meta.url)).default,CSVLayer:async()=>(await t(()=>import("./CSVLayer-67cc5eb3.js"),["./CSVLayer-67cc5eb3.js","./index-2abb185a.js","..\\index-b7f3bae3.css","./clientSideDefaults-0f4882b5.js","./QueryEngineCapabilities-85c4f1d0.js"],import.meta.url)).default,DimensionLayer:async()=>(await t(()=>import("./DimensionLayer-4e9b96af.js"),["./DimensionLayer-4e9b96af.js","./index-2abb185a.js","..\\index-b7f3bae3.css","./Analysis-36904fde.js"],import.meta.url)).default,ElevationLayer:async()=>(await t(()=>import("./ElevationLayer-0e83dec1.js"),["./ElevationLayer-0e83dec1.js","./index-2abb185a.js","..\\index-b7f3bae3.css"],import.meta.url)).default,FeatureLayer:async()=>(await t(()=>import("./index-2abb185a.js").then(e=>e.oV),["./index-2abb185a.js","..\\index-b7f3bae3.css"],import.meta.url)).default,GeoJSONLayer:async()=>(await t(()=>import("./GeoJSONLayer-c9ea9e60.js"),["./GeoJSONLayer-c9ea9e60.js","./index-2abb185a.js","..\\index-b7f3bae3.css","./clientSideDefaults-0f4882b5.js","./QueryEngineCapabilities-85c4f1d0.js"],import.meta.url)).default,GeoRSSLayer:async()=>(await t(()=>import("./GeoRSSLayer-46aed5a3.js"),["./GeoRSSLayer-46aed5a3.js","./index-2abb185a.js","..\\index-b7f3bae3.css"],import.meta.url)).default,GroupLayer:async()=>(await t(()=>import("./GroupLayer-47454588.js"),["./GroupLayer-47454588.js","./index-2abb185a.js","..\\index-b7f3bae3.css","./saveUtils-2eb77573.js","./resourceUtils-e689da6c.js"],import.meta.url)).default,ImageryLayer:async()=>(await t(()=>import("./ImageryLayer-b50f7533.js"),["./ImageryLayer-b50f7533.js","./index-2abb185a.js","..\\index-b7f3bae3.css","./ImageHistogramParameters-bf71bf94.js","./multidimensionalUtils-12f8b146.js","./dataUtils-66be3267.js","./RasterSymbolizer-d67548e8.js","./utils-1e91064a.js","./utils-cb049025.js","./generateRendererUtils-e5f93c6e.js","./imageBitmapUtils-2e90eec1.js","./executeQueryJSON-f6d084f7.js","./query-a5dbc95d.js","./pbfQueryUtils-6ff0a88e.js","./pbf-29db252e.js","./OptimizedGeometry-d94e541f.js","./OptimizedFeatureSet-1d1ac4b9.js","./featureConversionUtils-c2728820.js","./AttachmentInfo-ef8f0992.js","./executeForIds-3cd9e1e5.js"],import.meta.url)).default,ImageryTileLayer:async()=>(await t(()=>import("./ImageryTileLayer-1c3b2cfd.js"),["./ImageryTileLayer-1c3b2cfd.js","./index-2abb185a.js","..\\index-b7f3bae3.css","./ImageHistogramParameters-bf71bf94.js","./multidimensionalUtils-12f8b146.js","./dataUtils-66be3267.js","./RasterSymbolizer-d67548e8.js","./utils-1e91064a.js","./utils-cb049025.js","./generateRendererUtils-e5f93c6e.js","./RawBlockCache-61df3e78.js","./rasterProjectionHelper-b8a984ac.js","./utils-fa19f314.js"],import.meta.url)).default,IntegratedMeshLayer:async()=>(await t(()=>import("./IntegratedMeshLayer-5278067e.js"),["./IntegratedMeshLayer-5278067e.js","./index-2abb185a.js","..\\index-b7f3bae3.css","./persistable-fbb506a3.js","./multiOriginJSONSupportUtils-c978f4c3.js","./resourceExtension-f4ce7406.js","./SceneService-208b5e82.js","./originUtils-cfe4feaf.js","./saveAPIKeyUtils-31f46756.js","./saveUtils-2eb77573.js","./resourceUtils-e689da6c.js","./I3SLayerDefinitions-83902bae.js","./elevationInfoUtils-aace8559.js"],import.meta.url)).default,KMLLayer:async()=>(await t(()=>import("./KMLLayer-f7ae3ffd.js"),["./KMLLayer-f7ae3ffd.js","./index-2abb185a.js","..\\index-b7f3bae3.css","./kmlUtils-a4d01804.js"],import.meta.url)).default,LineOfSightLayer:async()=>(await t(()=>import("./LineOfSightLayer-1a03261c.js"),["./LineOfSightLayer-1a03261c.js","./index-2abb185a.js","..\\index-b7f3bae3.css","./Analysis-36904fde.js","./persistable-fbb506a3.js","./multiOriginJSONSupportUtils-c978f4c3.js","./resourceExtension-f4ce7406.js","./elevationInfoUtils-aace8559.js"],import.meta.url)).default,LinkChartLayer:async()=>(await t(()=>import("./LinkChartLayer-fb10b29f.js"),["./LinkChartLayer-fb10b29f.js","./index-2abb185a.js","..\\index-b7f3bae3.css","./geohashUtils-77d8429b.js","./featureConversionUtils-c2728820.js","./OptimizedGeometry-d94e541f.js","./OptimizedFeatureSet-1d1ac4b9.js","./FeatureStore-b13747b4.js","./BoundsStore-710604db.js","./PooledRBush-a7dab2f1.js","./timeSupport-c46a2e39.js","./projectionSupport-cad60f3a.js","./json-48e3ea08.js","./QueryEngine-dfcb7d10.js","./WhereClause-a0f53c1c.js","./TimeOnly-a161df0d.js","./QueryEngineCapabilities-85c4f1d0.js","./quantizationUtils-9cf921fd.js","./utils-e75eabcf.js","./utils-6f27852a.js","./generateRendererUtils-e5f93c6e.js","./RenderState-1d6218ee.js","./clientSideDefaults-0f4882b5.js"],import.meta.url)).default,MapImageLayer:async()=>(await t(()=>import("./MapImageLayer-6aa68f1a.js"),["./MapImageLayer-6aa68f1a.js","./index-2abb185a.js","..\\index-b7f3bae3.css","./scaleUtils-16c32eb5.js","./SublayersOwner-82a60ace.js","./QueryTask-c5b84bcd.js","./executeForIds-3cd9e1e5.js","./query-a5dbc95d.js","./pbfQueryUtils-6ff0a88e.js","./pbf-29db252e.js","./OptimizedGeometry-d94e541f.js","./OptimizedFeatureSet-1d1ac4b9.js","./executeQueryJSON-f6d084f7.js","./executeQueryPBF-3b1302b4.js","./featureConversionUtils-c2728820.js","./sublayerUtils-b247735f.js","./ExportImageParameters-1f4bf929.js","./floorFilterUtils-080a7cd2.js","./imageBitmapUtils-2e90eec1.js"],import.meta.url)).default,MapNotesLayer:async()=>(await t(()=>import("./MapNotesLayer-920d48f1.js"),["./MapNotesLayer-920d48f1.js","./index-2abb185a.js","..\\index-b7f3bae3.css","./GraphicsLayer-f05152d1.js","./objectIdUtils-789e911a.js"],import.meta.url)).default,MediaLayer:async()=>(await t(()=>import("./MediaLayer-c7573e0c.js"),["./MediaLayer-c7573e0c.js","./index-2abb185a.js","..\\index-b7f3bae3.css","./imageUtils-970969b3.js","./perspectiveUtils-7611af9c.js","./normalizeUtilsSync-19ff226f.js","./mat3f64-221ce671.js","./resourceExtension-f4ce7406.js","./BoundsStore-710604db.js","./PooledRBush-a7dab2f1.js"],import.meta.url)).default,OGCFeatureLayer:async()=>(await t(()=>import("./OGCFeatureLayer-9ac2e1cf.js"),["./OGCFeatureLayer-9ac2e1cf.js","./index-2abb185a.js","..\\index-b7f3bae3.css","./ogcFeatureUtils-ebbadf17.js","./featureConversionUtils-c2728820.js","./OptimizedGeometry-d94e541f.js","./OptimizedFeatureSet-1d1ac4b9.js","./geojson-74b91be6.js","./date-d60e9730.js","./clientSideDefaults-0f4882b5.js","./QueryEngineCapabilities-85c4f1d0.js"],import.meta.url)).default,OpenStreetMapLayer:async()=>(await t(()=>import("./OpenStreetMapLayer-4f04160f.js"),["./OpenStreetMapLayer-4f04160f.js","./index-2abb185a.js","..\\index-b7f3bae3.css","./WebTileLayer-be8101ec.js","./imageBitmapUtils-2e90eec1.js"],import.meta.url)).default,OrientedImageryLayer:async()=>(await t(()=>import("./OrientedImageryLayer-9f79bb2d.js"),["./OrientedImageryLayer-9f79bb2d.js","./index-2abb185a.js","..\\index-b7f3bae3.css"],import.meta.url)).default,PointCloudLayer:async()=>(await t(()=>import("./PointCloudLayer-13ad391c.js"),["./PointCloudLayer-13ad391c.js","./index-2abb185a.js","..\\index-b7f3bae3.css","./SceneService-208b5e82.js","./originUtils-cfe4feaf.js","./multiOriginJSONSupportUtils-c978f4c3.js","./saveAPIKeyUtils-31f46756.js","./saveUtils-2eb77573.js","./resourceUtils-e689da6c.js","./PointCloudUniqueValueRenderer-3e1df72d.js","./elevationInfoUtils-aace8559.js"],import.meta.url)).default,RouteLayer:async()=>(await t(()=>import("./RouteLayer-20082b95.js"),["./RouteLayer-20082b95.js","./index-2abb185a.js","..\\index-b7f3bae3.css","./originUtils-cfe4feaf.js","./multiOriginJSONSupportUtils-c978f4c3.js","./Stop-f508f066.js","./commonProperties-da958896.js"],import.meta.url)).default,SceneLayer:async()=>(await t(()=>import("./SceneLayer-ece37745.js"),["./SceneLayer-ece37745.js","./index-2abb185a.js","..\\index-b7f3bae3.css","./SceneService-208b5e82.js","./originUtils-cfe4feaf.js","./multiOriginJSONSupportUtils-c978f4c3.js","./saveAPIKeyUtils-31f46756.js","./saveUtils-2eb77573.js","./resourceUtils-e689da6c.js","./I3SUtil-e2ec904c.js","./mat3f64-221ce671.js","./mat4f64-1413b4a7.js","./quat-87c2ed51.js","./quatf64-3363c48e.js","./spatialReferenceEllipsoidUtils-9d3b30dd.js","./I3SBinaryReader-a951d5da.js","./VertexAttribute-0e674613.js","./orientedBoundingBox-58bcc5b5.js","./plane-3e55c930.js","./sphere-1cb8d3a6.js","./I3SLayerDefinitions-83902bae.js","./persistable-fbb506a3.js","./resourceExtension-f4ce7406.js","./elevationInfoUtils-aace8559.js","./popupUtils-3e90e5e6.js"],import.meta.url)).default,StreamLayer:async()=>(await t(()=>import("./StreamLayer-112b230a.js"),["./StreamLayer-112b230a.js","./index-2abb185a.js","..\\index-b7f3bae3.css"],import.meta.url)).default,SubtypeGroupLayer:async()=>(await t(()=>import("./SubtypeGroupLayer-6d6b5670.js"),["./SubtypeGroupLayer-6d6b5670.js","./index-2abb185a.js","..\\index-b7f3bae3.css"],import.meta.url)).default,TileLayer:async()=>(await t(()=>import("./TileLayer-94b37911.js"),["./TileLayer-94b37911.js","./index-2abb185a.js","..\\index-b7f3bae3.css","./SublayersOwner-82a60ace.js","./QueryTask-c5b84bcd.js","./executeForIds-3cd9e1e5.js","./query-a5dbc95d.js","./pbfQueryUtils-6ff0a88e.js","./pbf-29db252e.js","./OptimizedGeometry-d94e541f.js","./OptimizedFeatureSet-1d1ac4b9.js","./executeQueryJSON-f6d084f7.js","./executeQueryPBF-3b1302b4.js","./featureConversionUtils-c2728820.js","./sublayerUtils-b247735f.js","./imageBitmapUtils-2e90eec1.js"],import.meta.url)).default,UnknownLayer:async()=>(await t(()=>import("./UnknownLayer-ddd07079.js"),["./UnknownLayer-ddd07079.js","./index-2abb185a.js","..\\index-b7f3bae3.css"],import.meta.url)).default,UnsupportedLayer:async()=>(await t(()=>import("./UnsupportedLayer-3c06bf04.js"),["./UnsupportedLayer-3c06bf04.js","./index-2abb185a.js","..\\index-b7f3bae3.css"],import.meta.url)).default,VectorTileLayer:async()=>(await t(()=>import("./index-2abb185a.js").then(e=>e.oR),["./index-2abb185a.js","..\\index-b7f3bae3.css"],import.meta.url)).default,VoxelLayer:async()=>(await t(()=>import("./VoxelLayer-3ce54412.js"),["./VoxelLayer-3ce54412.js","./index-2abb185a.js","..\\index-b7f3bae3.css","./SceneService-208b5e82.js","./originUtils-cfe4feaf.js","./multiOriginJSONSupportUtils-c978f4c3.js","./saveAPIKeyUtils-31f46756.js","./saveUtils-2eb77573.js","./resourceUtils-e689da6c.js","./persistable-fbb506a3.js","./resourceExtension-f4ce7406.js","./quat-87c2ed51.js","./mat3f64-221ce671.js","./quatf64-3363c48e.js"],import.meta.url)).default,WFSLayer:async()=>(await t(()=>import("./WFSLayer-e77d18e1.js"),["./WFSLayer-e77d18e1.js","./index-2abb185a.js","..\\index-b7f3bae3.css","./clientSideDefaults-0f4882b5.js","./QueryEngineCapabilities-85c4f1d0.js","./wfsUtils-455c29d3.js","./geojson-74b91be6.js","./date-d60e9730.js","./OptimizedGeometry-d94e541f.js","./xmlUtils-444cb4c0.js"],import.meta.url)).default,WMSLayer:async()=>(await t(()=>import("./WMSLayer-ec1f3dab.js"),["./WMSLayer-ec1f3dab.js","./index-2abb185a.js","..\\index-b7f3bae3.css","./scaleUtils-16c32eb5.js","./crsUtils-3bab3d8c.js","./ExportWMSImageParameters-2e2833c2.js","./imageBitmapUtils-2e90eec1.js"],import.meta.url)).default,WMTSLayer:async()=>(await t(()=>import("./WMTSLayer-b0f338d7.js"),["./WMTSLayer-b0f338d7.js","./index-2abb185a.js","..\\index-b7f3bae3.css","./WebTileLayer-be8101ec.js","./imageBitmapUtils-2e90eec1.js","./crsUtils-3bab3d8c.js","./xmlUtils-444cb4c0.js"],import.meta.url)).default,WebTileLayer:async()=>(await t(()=>import("./WebTileLayer-be8101ec.js").then(e=>e.W),["./WebTileLayer-be8101ec.js","./index-2abb185a.js","..\\index-b7f3bae3.css","./imageBitmapUtils-2e90eec1.js"],import.meta.url)).default};async function h(e,o){const i=f(e);if(!i)throw new m("invalid-url","Invalid scene service url");const a={...o,sceneServerUrl:i.url.path,layerId:i.sublayer??void 0};if(a.sceneLayerItem??(a.sceneLayerItem=await A(a)),a.sceneLayerItem==null)return L(a.sceneServerUrl.replace("/SceneServer","/FeatureServer"),a);const r=await R(a);if(!(r!=null&&r.url))throw new m("related-service-not-found","Could not find feature service through portal item relationship");const _=await L(r.url,a);return _.portalItem=r,_}async function A(e){const o=(await v(e)).serviceItemId;if(!o)return null;const i=new E({id:o,apiKey:e.apiKey}),a=await O(e);a!=null&&(i.portal=new T({url:a}));try{return i.load({signal:e.signal})}catch(r){return y(r),null}}async function v(e){if(e.rootDocument)return e.rootDocument;const o={query:{f:"json",token:e.apiKey},responseType:"json",signal:e.signal};try{const i=await d(e.sceneServerUrl,o);e.rootDocument=i.data}catch{e.rootDocument={}}return e.rootDocument}async function O(e){var a;const o=(a=D)==null?void 0:a.findServerInfo(e.sceneServerUrl);if(o!=null&&o.owningSystemUrl)return o.owningSystemUrl;const i=e.sceneServerUrl.replace(/(.*\/rest)\/.*/i,"$1")+"/info";try{const r=(await d(i,{query:{f:"json"},responseType:"json",signal:e.signal})).data.owningSystemUrl;if(r)return r}catch(r){y(r)}return null}async function L(e,o){const i=f(e);if(!i)throw new m("invalid-feature-service-url","Invalid feature service url");const a=i.url.path,r=o.layerId;if(r==null)return{serverUrl:a};const _=v(o),c=n=>{const I={query:{f:"json"},responseType:"json",authMode:n,signal:o.signal};return d(a,I)},w=c("anonymous").catch(()=>c("no-prompt")),[p,l]=await Promise.all([w,_]),s=l==null?void 0:l.layers,u=p.data&&p.data.layers;if(!Array.isArray(u))throw new Error("expected layers array");if(Array.isArray(s)){for(let n=0;n<Math.min(s.length,u.length);n++)if(s[n].id===r)return{serverUrl:a,layerId:u[n].id}}else if(r!=null&&r<u.length)return{serverUrl:a,layerId:u[r].id};throw new Error("could not find matching associated sublayer")}async function R({sceneLayerItem:e,signal:o}){if(!e)return null;try{const i=(await e.fetchRelatedItems({relationshipType:"Service2Service",direction:"reverse"},{signal:o})).find(r=>r.type==="Feature Service")||null;if(!i)return null;const a=new E({portal:i.portal,id:i.id});return await a.load(),a}catch(i){return y(i),null}}export{P as a,h as l};
