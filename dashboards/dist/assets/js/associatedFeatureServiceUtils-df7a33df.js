import{$ as t,p as f,s as m,av as E,aw as T,ds as y,a2 as d,bi as D}from"./index-709d080c.js";const V={BingMapsLayer:async()=>(await t(()=>import("./BingMapsLayer-b57ad5e3.js"),["./BingMapsLayer-b57ad5e3.js","./index-709d080c.js","..\\index-b7f3bae3.css"],import.meta.url)).default,BuildingSceneLayer:async()=>(await t(()=>import("./BuildingSceneLayer-d335db69.js"),["./BuildingSceneLayer-d335db69.js","./index-709d080c.js","..\\index-b7f3bae3.css","./I3SUtil-fffbdbfc.js","./mat3f64-221ce671.js","./mat4f64-1413b4a7.js","./quat-b577bc6f.js","./quatf64-3363c48e.js","./spatialReferenceEllipsoidUtils-7bd835a4.js","./I3SBinaryReader-e09ced86.js","./VertexAttribute-0e674613.js","./orientedBoundingBox-561a611f.js","./plane-73eda233.js","./sphere-92fb014f.js","./SceneService-7c8b3ec6.js","./originUtils-cfe4feaf.js","./multiOriginJSONSupportUtils-c978f4c3.js","./saveAPIKeyUtils-79aeec32.js","./saveUtils-c136f737.js","./resourceUtils-f25aefe7.js","./I3SLayerDefinitions-b2c647ea.js","./popupUtils-bf474c38.js","./elevationInfoUtils-ce2bc3fc.js"],import.meta.url)).default,CSVLayer:async()=>(await t(()=>import("./CSVLayer-b0ba8efb.js"),["./CSVLayer-b0ba8efb.js","./index-709d080c.js","..\\index-b7f3bae3.css","./clientSideDefaults-793fa108.js","./QueryEngineCapabilities-85c4f1d0.js"],import.meta.url)).default,DimensionLayer:async()=>(await t(()=>import("./DimensionLayer-95cec5e3.js"),["./DimensionLayer-95cec5e3.js","./index-709d080c.js","..\\index-b7f3bae3.css","./Analysis-51f194ef.js"],import.meta.url)).default,ElevationLayer:async()=>(await t(()=>import("./ElevationLayer-0a4d5ea3.js"),["./ElevationLayer-0a4d5ea3.js","./index-709d080c.js","..\\index-b7f3bae3.css"],import.meta.url)).default,FeatureLayer:async()=>(await t(()=>import("./index-709d080c.js").then(e=>e.r9),["./index-709d080c.js","..\\index-b7f3bae3.css"],import.meta.url)).default,GeoJSONLayer:async()=>(await t(()=>import("./GeoJSONLayer-631d0e36.js"),["./GeoJSONLayer-631d0e36.js","./index-709d080c.js","..\\index-b7f3bae3.css","./clientSideDefaults-793fa108.js","./QueryEngineCapabilities-85c4f1d0.js"],import.meta.url)).default,GeoRSSLayer:async()=>(await t(()=>import("./GeoRSSLayer-6e44ca5a.js"),["./GeoRSSLayer-6e44ca5a.js","./index-709d080c.js","..\\index-b7f3bae3.css"],import.meta.url)).default,GroupLayer:async()=>(await t(()=>import("./GroupLayer-f90b3726.js"),["./GroupLayer-f90b3726.js","./index-709d080c.js","..\\index-b7f3bae3.css","./saveUtils-c136f737.js","./resourceUtils-f25aefe7.js"],import.meta.url)).default,ImageryLayer:async()=>(await t(()=>import("./index-709d080c.js").then(e=>e.ra),["./index-709d080c.js","..\\index-b7f3bae3.css"],import.meta.url)).default,ImageryTileLayer:async()=>(await t(()=>import("./ImageryTileLayer-6fef6810.js"),["./ImageryTileLayer-6fef6810.js","./index-709d080c.js","..\\index-b7f3bae3.css","./RawBlockCache-dfb13c05.js","./rasterProjectionHelper-a462b8fa.js","./utils-1b979567.js"],import.meta.url)).default,IntegratedMeshLayer:async()=>(await t(()=>import("./IntegratedMeshLayer-75a6c191.js"),["./IntegratedMeshLayer-75a6c191.js","./index-709d080c.js","..\\index-b7f3bae3.css","./persistable-6604d82d.js","./multiOriginJSONSupportUtils-c978f4c3.js","./resourceExtension-5906821c.js","./SceneService-7c8b3ec6.js","./originUtils-cfe4feaf.js","./saveAPIKeyUtils-79aeec32.js","./saveUtils-c136f737.js","./resourceUtils-f25aefe7.js","./I3SLayerDefinitions-b2c647ea.js","./elevationInfoUtils-ce2bc3fc.js"],import.meta.url)).default,KMLLayer:async()=>(await t(()=>import("./KMLLayer-2def56bf.js"),["./KMLLayer-2def56bf.js","./index-709d080c.js","..\\index-b7f3bae3.css","./kmlUtils-a653f2d1.js"],import.meta.url)).default,LineOfSightLayer:async()=>(await t(()=>import("./LineOfSightLayer-1e27874e.js"),["./LineOfSightLayer-1e27874e.js","./index-709d080c.js","..\\index-b7f3bae3.css","./Analysis-51f194ef.js","./persistable-6604d82d.js","./multiOriginJSONSupportUtils-c978f4c3.js","./resourceExtension-5906821c.js","./elevationInfoUtils-ce2bc3fc.js"],import.meta.url)).default,LinkChartLayer:async()=>(await t(()=>import("./LinkChartLayer-e45b2233.js"),["./LinkChartLayer-e45b2233.js","./index-709d080c.js","..\\index-b7f3bae3.css","./geohashUtils-77d8429b.js","./FeatureStore-1b979ea5.js","./BoundsStore-646348fa.js","./PooledRBush-726f5f27.js","./timeSupport-abcfefa5.js","./projectionSupport-1063052c.js","./json-48e3ea08.js","./QueryEngine-0790e1d8.js","./WhereClause-6b44fbb1.js","./TimeOnly-94cbed0e.js","./QueryEngineCapabilities-85c4f1d0.js","./quantizationUtils-0cd11aba.js","./utils-8e9cfd21.js","./utils-3c9a1959.js","./RenderState-1d6218ee.js","./clientSideDefaults-793fa108.js"],import.meta.url)).default,MapImageLayer:async()=>(await t(()=>import("./MapImageLayer-b6392bc8.js"),["./MapImageLayer-b6392bc8.js","./index-709d080c.js","..\\index-b7f3bae3.css","./scaleUtils-139fb2fb.js","./SublayersOwner-db849cb0.js","./QueryTask-f18f06ad.js","./executeQueryPBF-e5a83a2f.js","./sublayerUtils-56268c12.js","./ExportImageParameters-768ba672.js","./floorFilterUtils-080a7cd2.js"],import.meta.url)).default,MapNotesLayer:async()=>(await t(()=>import("./MapNotesLayer-b11f5c02.js"),["./MapNotesLayer-b11f5c02.js","./index-709d080c.js","..\\index-b7f3bae3.css","./GraphicsLayer-43a34dc5.js","./objectIdUtils-789e911a.js"],import.meta.url)).default,MediaLayer:async()=>(await t(()=>import("./MediaLayer-89bbff9a.js"),["./MediaLayer-89bbff9a.js","./index-709d080c.js","..\\index-b7f3bae3.css","./imageUtils-918ea0ae.js","./perspectiveUtils-904d9623.js","./normalizeUtilsSync-6a6170eb.js","./mat3f64-221ce671.js","./resourceExtension-5906821c.js","./BoundsStore-646348fa.js","./PooledRBush-726f5f27.js"],import.meta.url)).default,OGCFeatureLayer:async()=>(await t(()=>import("./OGCFeatureLayer-88982042.js"),["./OGCFeatureLayer-88982042.js","./index-709d080c.js","..\\index-b7f3bae3.css","./ogcFeatureUtils-87aec3f6.js","./geojson-4e08126f.js","./date-d60e9730.js","./clientSideDefaults-793fa108.js","./QueryEngineCapabilities-85c4f1d0.js"],import.meta.url)).default,OpenStreetMapLayer:async()=>(await t(()=>import("./OpenStreetMapLayer-be762ace.js"),["./OpenStreetMapLayer-be762ace.js","./index-709d080c.js","..\\index-b7f3bae3.css","./WebTileLayer-0e39f26f.js"],import.meta.url)).default,OrientedImageryLayer:async()=>(await t(()=>import("./OrientedImageryLayer-f5cf687b.js"),["./OrientedImageryLayer-f5cf687b.js","./index-709d080c.js","..\\index-b7f3bae3.css"],import.meta.url)).default,PointCloudLayer:async()=>(await t(()=>import("./PointCloudLayer-e3be4b7d.js"),["./PointCloudLayer-e3be4b7d.js","./index-709d080c.js","..\\index-b7f3bae3.css","./SceneService-7c8b3ec6.js","./originUtils-cfe4feaf.js","./multiOriginJSONSupportUtils-c978f4c3.js","./saveAPIKeyUtils-79aeec32.js","./saveUtils-c136f737.js","./resourceUtils-f25aefe7.js","./PointCloudUniqueValueRenderer-e0a3766a.js","./elevationInfoUtils-ce2bc3fc.js"],import.meta.url)).default,RouteLayer:async()=>(await t(()=>import("./RouteLayer-54c4b6bf.js"),["./RouteLayer-54c4b6bf.js","./index-709d080c.js","..\\index-b7f3bae3.css","./originUtils-cfe4feaf.js","./multiOriginJSONSupportUtils-c978f4c3.js","./Stop-5d48e28f.js","./commonProperties-da958896.js"],import.meta.url)).default,SceneLayer:async()=>(await t(()=>import("./SceneLayer-a8dca306.js"),["./SceneLayer-a8dca306.js","./index-709d080c.js","..\\index-b7f3bae3.css","./SceneService-7c8b3ec6.js","./originUtils-cfe4feaf.js","./multiOriginJSONSupportUtils-c978f4c3.js","./saveAPIKeyUtils-79aeec32.js","./saveUtils-c136f737.js","./resourceUtils-f25aefe7.js","./I3SUtil-fffbdbfc.js","./mat3f64-221ce671.js","./mat4f64-1413b4a7.js","./quat-b577bc6f.js","./quatf64-3363c48e.js","./spatialReferenceEllipsoidUtils-7bd835a4.js","./I3SBinaryReader-e09ced86.js","./VertexAttribute-0e674613.js","./orientedBoundingBox-561a611f.js","./plane-73eda233.js","./sphere-92fb014f.js","./I3SLayerDefinitions-b2c647ea.js","./persistable-6604d82d.js","./resourceExtension-5906821c.js","./elevationInfoUtils-ce2bc3fc.js","./popupUtils-bf474c38.js"],import.meta.url)).default,StreamLayer:async()=>(await t(()=>import("./StreamLayer-28490874.js"),["./StreamLayer-28490874.js","./index-709d080c.js","..\\index-b7f3bae3.css"],import.meta.url)).default,SubtypeGroupLayer:async()=>(await t(()=>import("./SubtypeGroupLayer-e6a2325a.js"),["./SubtypeGroupLayer-e6a2325a.js","./index-709d080c.js","..\\index-b7f3bae3.css"],import.meta.url)).default,TileLayer:async()=>(await t(()=>import("./TileLayer-92067bb5.js"),["./TileLayer-92067bb5.js","./index-709d080c.js","..\\index-b7f3bae3.css","./SublayersOwner-db849cb0.js","./QueryTask-f18f06ad.js","./executeQueryPBF-e5a83a2f.js","./sublayerUtils-56268c12.js"],import.meta.url)).default,UnknownLayer:async()=>(await t(()=>import("./UnknownLayer-641905e8.js"),["./UnknownLayer-641905e8.js","./index-709d080c.js","..\\index-b7f3bae3.css"],import.meta.url)).default,UnsupportedLayer:async()=>(await t(()=>import("./UnsupportedLayer-30b3a326.js"),["./UnsupportedLayer-30b3a326.js","./index-709d080c.js","..\\index-b7f3bae3.css"],import.meta.url)).default,VectorTileLayer:async()=>(await t(()=>import("./index-709d080c.js").then(e=>e.r5),["./index-709d080c.js","..\\index-b7f3bae3.css"],import.meta.url)).default,VoxelLayer:async()=>(await t(()=>import("./VoxelLayer-679af4a0.js"),["./VoxelLayer-679af4a0.js","./index-709d080c.js","..\\index-b7f3bae3.css","./SceneService-7c8b3ec6.js","./originUtils-cfe4feaf.js","./multiOriginJSONSupportUtils-c978f4c3.js","./saveAPIKeyUtils-79aeec32.js","./saveUtils-c136f737.js","./resourceUtils-f25aefe7.js","./persistable-6604d82d.js","./resourceExtension-5906821c.js","./quat-b577bc6f.js","./mat3f64-221ce671.js","./quatf64-3363c48e.js"],import.meta.url)).default,WFSLayer:async()=>(await t(()=>import("./WFSLayer-776ec559.js"),["./WFSLayer-776ec559.js","./index-709d080c.js","..\\index-b7f3bae3.css","./clientSideDefaults-793fa108.js","./QueryEngineCapabilities-85c4f1d0.js","./wfsUtils-e29f6e3c.js","./geojson-4e08126f.js","./date-d60e9730.js","./xmlUtils-444cb4c0.js"],import.meta.url)).default,WMSLayer:async()=>(await t(()=>import("./WMSLayer-36cc5290.js"),["./WMSLayer-36cc5290.js","./index-709d080c.js","..\\index-b7f3bae3.css","./scaleUtils-139fb2fb.js","./crsUtils-3bab3d8c.js","./ExportWMSImageParameters-685d430a.js"],import.meta.url)).default,WMTSLayer:async()=>(await t(()=>import("./WMTSLayer-02281cc7.js"),["./WMTSLayer-02281cc7.js","./index-709d080c.js","..\\index-b7f3bae3.css","./WebTileLayer-0e39f26f.js","./crsUtils-3bab3d8c.js","./xmlUtils-444cb4c0.js"],import.meta.url)).default,WebTileLayer:async()=>(await t(()=>import("./WebTileLayer-0e39f26f.js").then(e=>e.W),["./WebTileLayer-0e39f26f.js","./index-709d080c.js","..\\index-b7f3bae3.css"],import.meta.url)).default};async function h(e,o){const i=f(e);if(!i)throw new m("invalid-url","Invalid scene service url");const r={...o,sceneServerUrl:i.url.path,layerId:i.sublayer??void 0};if(r.sceneLayerItem??(r.sceneLayerItem=await O(r)),r.sceneLayerItem==null)return L(r.sceneServerUrl.replace("/SceneServer","/FeatureServer"),r);const a=await P(r);if(!(a!=null&&a.url))throw new m("related-service-not-found","Could not find feature service through portal item relationship");const _=await L(a.url,r);return _.portalItem=a,_}async function O(e){const o=(await v(e)).serviceItemId;if(!o)return null;const i=new E({id:o,apiKey:e.apiKey}),r=await A(e);r!=null&&(i.portal=new T({url:r}));try{return i.load({signal:e.signal})}catch(a){return y(a),null}}async function v(e){if(e.rootDocument)return e.rootDocument;const o={query:{f:"json",token:e.apiKey},responseType:"json",signal:e.signal};try{const i=await d(e.sceneServerUrl,o);e.rootDocument=i.data}catch{e.rootDocument={}}return e.rootDocument}async function A(e){var r;const o=(r=D)==null?void 0:r.findServerInfo(e.sceneServerUrl);if(o!=null&&o.owningSystemUrl)return o.owningSystemUrl;const i=e.sceneServerUrl.replace(/(.*\/rest)\/.*/i,"$1")+"/info";try{const a=(await d(i,{query:{f:"json"},responseType:"json",signal:e.signal})).data.owningSystemUrl;if(a)return a}catch(a){y(a)}return null}async function L(e,o){const i=f(e);if(!i)throw new m("invalid-feature-service-url","Invalid feature service url");const r=i.url.path,a=o.layerId;if(a==null)return{serverUrl:r};const _=v(o),c=n=>{const I={query:{f:"json"},responseType:"json",authMode:n,signal:o.signal};return d(r,I)},w=c("anonymous").catch(()=>c("no-prompt")),[p,l]=await Promise.all([w,_]),s=l==null?void 0:l.layers,u=p.data&&p.data.layers;if(!Array.isArray(u))throw new Error("expected layers array");if(Array.isArray(s)){for(let n=0;n<Math.min(s.length,u.length);n++)if(s[n].id===a)return{serverUrl:r,layerId:u[n].id}}else if(a!=null&&a<u.length)return{serverUrl:r,layerId:u[a].id};throw new Error("could not find matching associated sublayer")}async function P({sceneLayerItem:e,signal:o}){if(!e)return null;try{const i=(await e.fetchRelatedItems({relationshipType:"Service2Service",direction:"reverse"},{signal:o})).find(a=>a.type==="Feature Service")||null;if(!i)return null;const r=new E({portal:i.portal,id:i.id});return await r.load(),r}catch(i){return y(i),null}}export{V as a,h as l};
