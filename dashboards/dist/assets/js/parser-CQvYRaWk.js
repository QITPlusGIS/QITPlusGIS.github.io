import{eV as Vt,am as Wt,o as $,eW as Zt,eX as Kt,eY as Lt,eZ as Qt}from"./uuid-De2V3pkO.js";import{e as Oe}from"./mat4f32-BYh1DbDV.js";import{s as q,o as I}from"./mat4-DR7ljCfE.js";const er=(r,a)=>{const u=q(r,a,0,0,0,0,a,0,0,0,0,a,0,0,0,0,1);return I(u,u)},tr=(r,a)=>{const u=q(r,a,0,0,.5-.5*a,0,a,0,.5-.5*a,0,0,a,.5-.5*a,0,0,0,1);return I(u,u)},rr=(r,a)=>{const u=1-a,l=q(r,.2126+.7874*u,.7152-.7152*u,.0722-.0722*u,0,.2126-.2126*u,.7152+.2848*u,.0722-.0722*u,0,.2126-.2126*u,.7152-.7152*u,.0722+.9278*u,0,0,0,0,1);return I(l,l)},nr=(r,a)=>{const u=Math.sin(a*Math.PI/180),l=Math.cos(a*Math.PI/180),i=q(r,.213+.787*l-.213*u,.715-.715*l-.715*u,.072-.072*l+.928*u,0,.213-.213*l+.143*u,.715+.285*l+.14*u,.072-.072*l-.283*u,0,.213-.213*l-.787*u,.715-.715*l+.715*u,.072+.928*l+.072*u,0,0,0,0,1);return I(i,i)},ar=(r,a)=>{const u=1-2*a,l=q(r,u,0,0,a,0,u,0,a,0,0,u,a,0,0,0,1);return I(l,l)},or=(r,a)=>{const u=q(r,.213+.787*a,.715-.715*a,.072-.072*a,0,.213-.213*a,.715+.285*a,.072-.072*a,0,.213-.213*a,.715-.715*a,.072+.928*a,0,0,0,0,1);return I(u,u)},ur=(r,a)=>{const u=1-a,l=q(r,.393+.607*u,.769-.769*u,.189-.189*u,0,.349-.349*u,.686+.314*u,.168-.168*u,0,.272-.272*u,.534-.534*u,.131+.869*u,0,0,0,0,1);return I(l,l)};class V{constructor(a,u,l){this.strength=a,this.radius=u,this.threshold=l,this.type="bloom"}interpolate(a,u,l){this.strength=C(a.strength,u.strength,l),this.radius=C(a.radius,u.radius,l),this.threshold=C(a.threshold,u.threshold,l)}clone(){return new V(this.strength,this.radius,this.threshold)}toJSON(){return{type:"bloom",radius:T(this.radius),strength:this.strength,threshold:this.threshold}}}let Re=class Se{constructor(a){this.radius=a,this.type="blur"}interpolate(a,u,l){this.radius=Math.round(C(a.radius,u.radius,l))}clone(){return new Se(this.radius)}toJSON(){return{type:"blur",radius:T(this.radius)}}};class U{constructor(a,u){this.type=a,this.amount=u,this.type!=="invert"&&this.type!=="grayscale"&&this.type!=="sepia"||(this.amount=Math.min(this.amount,1))}get colorMatrix(){return this._colorMatrix||this._updateMatrix(),this._colorMatrix}interpolate(a,u,l){this.amount=C(a.amount,u.amount,l),this._updateMatrix()}clone(){return new U(this.type,this.amount)}toJSON(){return{type:this.type,amount:this.amount}}_updateMatrix(){const a=this._colorMatrix||Oe();switch(this.type){case"brightness":this._colorMatrix=er(a,this.amount);break;case"contrast":this._colorMatrix=tr(a,this.amount);break;case"grayscale":this._colorMatrix=rr(a,this.amount);break;case"invert":this._colorMatrix=ar(a,this.amount);break;case"saturate":this._colorMatrix=or(a,this.amount);break;case"sepia":this._colorMatrix=ur(a,this.amount)}}}let ke=class Ne{constructor(a,u,l,i){this.offsetX=a,this.offsetY=u,this.blurRadius=l,this.color=i,this.type="drop-shadow"}interpolate(a,u,l){this.offsetX=C(a.offsetX,u.offsetX,l),this.offsetY=C(a.offsetY,u.offsetY,l),this.blurRadius=C(a.blurRadius,u.blurRadius,l),this.color[0]=Math.round(C(a.color[0],u.color[0],l)),this.color[1]=Math.round(C(a.color[1],u.color[1],l)),this.color[2]=Math.round(C(a.color[2],u.color[2],l)),this.color[3]=C(a.color[3],u.color[3],l)}clone(){return new Ne(this.offsetX,this.offsetY,this.blurRadius,[...this.color])}toJSON(){const a=[...this.color];return a[3]*=255,{type:"drop-shadow",xoffset:T(this.offsetX),yoffset:T(this.offsetY),blurRadius:T(this.blurRadius),color:a}}},je=class Xe{constructor(a){this.angle=a,this.type="hue-rotate"}get colorMatrix(){return this._colorMatrix||this._updateMatrix(),this._colorMatrix}interpolate(a,u,l){this.angle=C(a.angle,u.angle,l),this._updateMatrix()}clone(){return new Xe(this.angle)}toJSON(){return{type:"hue-rotate",angle:this.angle}}_updateMatrix(){const a=this._colorMatrix||Oe();this._colorMatrix=nr(a,this.angle)}};class W{constructor(a){this.amount=a,this.type="opacity",this.amount=Math.min(this.amount,1)}interpolate(a,u,l){this.amount=C(a.amount,u.amount,l)}clone(){return new W(this.amount)}toJSON(){return{type:"opacity",amount:this.amount}}}function C(r,a,u){return r+(a-r)*u}function T(r){return Math.round(1e3*Wt(r))/1e3}function sr(r){switch(r.type){case"grayscale":case"sepia":case"invert":return new U(r.type,0);case"saturate":case"brightness":case"contrast":return new U(r.type,1);case"opacity":return new W(1);case"hue-rotate":return new je(0);case"blur":return new Re(0);case"drop-shadow":return new ke(0,0,0,[...Vt("transparent")]);case"bloom":return new V(0,0,1)}}function ir(r,a){const u=r.length>a.length?r:a;return(r.length>a.length?a:r).every(((l,i)=>l.type===u[i].type))}function cr(r,a){const u=r.length>a.length?r:a,l=r.length>a.length?a:r;for(let i=l.length;i<u.length;i++)l.push(sr(u[i]))}function Sr(r){const a=r[0];return!!a&&"type"in a}var Fe,Ee,ee={exports:{}};ee.exports,Ee=function(){function r(i,d){function y(){this.constructor=i}y.prototype=d.prototype,i.prototype=new y}function a(i,d,y,t){var x=Error.call(this,i);return Object.setPrototypeOf&&Object.setPrototypeOf(x,a.prototype),x.expected=d,x.found=y,x.location=t,x.name="SyntaxError",x}function u(i,d,y){return y=y||" ",i.length>d?i:(d-=i.length,i+(y+=y.repeat(d)).slice(0,d))}function l(i,d){var y,t={},x=(d=d!==void 0?d:{}).grammarSource,_={start:$e},X=$e,Y="none",J=")",p=",",v="(",O="%",b="px",ae="cm",oe="mm",ue="in",se="pt",ie="pc",ce="deg",le="rad",fe="grad",he="turn",qe="#",Ie=".",Je="e",pe=/^[ \t\n\r]/,me=/^[a-z\-]/,ge=/^[0-9a-fA-F]/,de=/^[+\-]/,N=/^[0-9]/,Pe=k("none"),ze=A("none",!1),Te=A(")",!1),ye=A(",",!1),Ue=k("whitespace"),ve=z([" ","	",`
`,"\r"],!1,!1),Be=k("function"),De=A("(",!1),Ge=k("identifier"),we=z([["a","z"],"-"],!1,!1),He=k("percentage"),Ve=A("%",!1),We=k("length"),Ze=A("px",!1),Ke=A("cm",!1),Le=A("mm",!1),Qe=A("in",!1),et=A("pt",!1),tt=A("pc",!1),rt=k("angle"),nt=A("deg",!1),at=A("rad",!1),ot=A("grad",!1),ut=A("turn",!1),st=k("number"),it=k("color"),ct=A("#",!1),xe=z([["0","9"],["a","f"],["A","F"]],!1,!1),be=z(["+","-"],!1,!1),j=z([["0","9"]],!1,!1),lt=A(".",!1),ft=A("e",!1),ht=function(){return[]},pt=function(e,o){return{type:"function",name:e,parameters:o||[]}},mt=function(e,o){return o.length>0?Ht(e,o,3):[e]},gt=function(e){return{type:"quantity",value:e.value,unit:e.unit}},dt=function(e){return{type:"color",colorType:e.type,value:e.value}},yt=function(e){return e},vt=function(){return G()},wt=function(e){return{value:e,unit:"%"}},xt=function(e){return{value:e,unit:"px"}},bt=function(e){return{value:e,unit:"cm"}},At=function(e){return{value:e,unit:"mm"}},Mt=function(e){return{value:e,unit:"in"}},$t=function(e){return{value:e,unit:"pt"}},Ct=function(e){return{value:e,unit:"pc"}},Ft=function(e){return{value:e,unit:"deg"}},Et=function(e){return{value:e,unit:"rad"}},_t=function(e){return{value:e,unit:"grad"}},Ot=function(e){return{value:e,unit:"turn"}},Rt=function(e){return{value:e,unit:null}},St=function(){return{type:"hex",value:G()}},kt=function(e){return{type:"function",value:e}},Nt=function(){return{type:"named",value:G()}},jt=function(){return parseFloat(G())},n=0,g=0,D=[{line:1,column:1}],S=0,K=[],c=0;if("startRule"in d){if(!(d.startRule in _))throw new Error(`Can't start parsing from rule "`+d.startRule+'".');X=_[d.startRule]}function G(){return i.substring(g,n)}function A(e,o){return{type:"literal",text:e,ignoreCase:o}}function z(e,o,s){return{type:"class",parts:e,inverted:o,ignoreCase:s}}function Xt(){return{type:"end"}}function k(e){return{type:"other",description:e}}function Ae(e){var o,s=D[e];if(s)return s;for(o=e-1;!D[o];)o--;for(s={line:(s=D[o]).line,column:s.column};o<e;)i.charCodeAt(o)===10?(s.line++,s.column=1):s.column++,o++;return D[e]=s,s}function Me(e,o,s){var h=Ae(e),w=Ae(o),m={source:x,start:{offset:e,line:h.line,column:h.column},end:{offset:o,line:w.line,column:w.column}};return m}function f(e){n<S||(n>S&&(S=n,K=[]),K.push(e))}function Yt(e,o,s){return new a(a.buildMessage(e,o),e,o,s)}function $e(){var e;return(e=qt())===t&&(e=It()),e}function qt(){var e,o;return c++,e=n,M(),i.substr(n,4)===Y?(o=Y,n+=4):(o=t,c===0&&f(ze)),o!==t?(M(),g=e,e=ht()):(n=e,e=t),c--,e===t&&c===0&&f(Pe),e}function It(){var e,o;if(e=[],(o=L())!==t)for(;o!==t;)e.push(o),o=L();else e=t;return e}function L(){var e,o,s,h;return e=n,M(),(o=Pt())!==t?(M(),(s=Jt())===t&&(s=null),M(),i.charCodeAt(n)===41?(h=J,n++):(h=t,c===0&&f(Te)),h!==t?(M(),g=e,e=pt(o,s)):(n=e,e=t)):(n=e,e=t),e}function Jt(){var e,o,s,h,w,m,E,H;if(e=n,(o=Q())!==t){for(s=[],h=n,w=M(),i.charCodeAt(n)===44?(m=p,n++):(m=t,c===0&&f(ye)),m===t&&(m=null),E=M(),(H=Q())!==t?h=w=[w,m,E,H]:(n=h,h=t);h!==t;)s.push(h),h=n,w=M(),i.charCodeAt(n)===44?(m=p,n++):(m=t,c===0&&f(ye)),m===t&&(m=null),E=M(),(H=Q())!==t?h=w=[w,m,E,H]:(n=h,h=t);g=e,e=mt(o,s)}else n=e,e=t;return e}function Q(){var e,o;return e=n,(o=zt())===t&&(o=Tt())===t&&(o=Ut())===t&&(o=Bt()),o!==t&&(g=e,o=gt(o)),(e=o)===t&&(e=n,(o=Dt())!==t&&(g=e,o=dt(o)),e=o),e}function M(){var e,o;for(c++,e=[],pe.test(i.charAt(n))?(o=i.charAt(n),n++):(o=t,c===0&&f(ve));o!==t;)e.push(o),pe.test(i.charAt(n))?(o=i.charAt(n),n++):(o=t,c===0&&f(ve));return c--,o=t,c===0&&f(Ue),e}function Pt(){var e,o,s;return c++,e=n,(o=Ce())!==t?(i.charCodeAt(n)===40?(s=v,n++):(s=t,c===0&&f(De)),s!==t?(g=e,e=yt(o)):(n=e,e=t)):(n=e,e=t),c--,e===t&&(o=t,c===0&&f(Be)),e}function Ce(){var e,o,s;if(c++,e=n,o=[],me.test(i.charAt(n))?(s=i.charAt(n),n++):(s=t,c===0&&f(we)),s!==t)for(;s!==t;)o.push(s),me.test(i.charAt(n))?(s=i.charAt(n),n++):(s=t,c===0&&f(we));else o=t;return o!==t&&(g=e,o=vt()),c--,(e=o)===t&&(o=t,c===0&&f(Ge)),e}function zt(){var e,o,s;return c++,e=n,M(),(o=F())!==t?(i.charCodeAt(n)===37?(s=O,n++):(s=t,c===0&&f(Ve)),s!==t?(g=e,e=wt(o)):(n=e,e=t)):(n=e,e=t),c--,e===t&&c===0&&f(He),e}function Tt(){var e,o,s;return c++,e=n,M(),(o=F())!==t?(i.substr(n,2)===b?(s=b,n+=2):(s=t,c===0&&f(Ze)),s!==t?(g=e,e=xt(o)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,M(),(o=F())!==t?(i.substr(n,2)===ae?(s=ae,n+=2):(s=t,c===0&&f(Ke)),s!==t?(g=e,e=bt(o)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,M(),(o=F())!==t?(i.substr(n,2)===oe?(s=oe,n+=2):(s=t,c===0&&f(Le)),s!==t?(g=e,e=At(o)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,M(),(o=F())!==t?(i.substr(n,2)===ue?(s=ue,n+=2):(s=t,c===0&&f(Qe)),s!==t?(g=e,e=Mt(o)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,M(),(o=F())!==t?(i.substr(n,2)===se?(s=se,n+=2):(s=t,c===0&&f(et)),s!==t?(g=e,e=$t(o)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,M(),(o=F())!==t?(i.substr(n,2)===ie?(s=ie,n+=2):(s=t,c===0&&f(tt)),s!==t?(g=e,e=Ct(o)):(n=e,e=t)):(n=e,e=t)))))),c--,e===t&&c===0&&f(We),e}function Ut(){var e,o,s;return c++,e=n,(o=F())!==t?(i.substr(n,3)===ce?(s=ce,n+=3):(s=t,c===0&&f(nt)),s!==t?(g=e,e=Ft(o)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(o=F())!==t?(i.substr(n,3)===le?(s=le,n+=3):(s=t,c===0&&f(at)),s!==t?(g=e,e=Et(o)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(o=F())!==t?(i.substr(n,4)===fe?(s=fe,n+=4):(s=t,c===0&&f(ot)),s!==t?(g=e,e=_t(o)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(o=F())!==t?(i.substr(n,4)===he?(s=he,n+=4):(s=t,c===0&&f(ut)),s!==t?(g=e,e=Ot(o)):(n=e,e=t)):(n=e,e=t)))),c--,e===t&&(o=t,c===0&&f(rt)),e}function Bt(){var e,o;return c++,e=n,M(),(o=F())!==t?(g=e,e=Rt(o)):(n=e,e=t),c--,e===t&&c===0&&f(st),e}function Dt(){var e,o,s,h;if(c++,e=n,i.charCodeAt(n)===35?(o=qe,n++):(o=t,c===0&&f(ct)),o!==t){if(s=[],ge.test(i.charAt(n))?(h=i.charAt(n),n++):(h=t,c===0&&f(xe)),h!==t)for(;h!==t;)s.push(h),ge.test(i.charAt(n))?(h=i.charAt(n),n++):(h=t,c===0&&f(xe));else s=t;s!==t?(g=e,e=St()):(n=e,e=t)}else n=e,e=t;return e===t&&(e=n,(o=L())!==t&&(g=e,o=kt(o)),(e=o)===t&&(e=n,(o=Ce())!==t&&(g=e,o=Nt()),e=o)),c--,e===t&&(o=t,c===0&&f(it)),e}function F(){var e,o,s,h,w,m,E;for(e=n,de.test(i.charAt(n))?(i.charAt(n),n++):c===0&&f(be),o=n,s=[],N.test(i.charAt(n))?(h=i.charAt(n),n++):(h=t,c===0&&f(j));h!==t;)s.push(h),N.test(i.charAt(n))?(h=i.charAt(n),n++):(h=t,c===0&&f(j));if(i.charCodeAt(n)===46?(h=Ie,n++):(h=t,c===0&&f(lt)),h!==t){if(w=[],N.test(i.charAt(n))?(m=i.charAt(n),n++):(m=t,c===0&&f(j)),m!==t)for(;m!==t;)w.push(m),N.test(i.charAt(n))?(m=i.charAt(n),n++):(m=t,c===0&&f(j));else w=t;w!==t?o=s=[s,h,w]:(n=o,o=t)}else n=o,o=t;if(o===t)if(o=[],N.test(i.charAt(n))?(s=i.charAt(n),n++):(s=t,c===0&&f(j)),s!==t)for(;s!==t;)o.push(s),N.test(i.charAt(n))?(s=i.charAt(n),n++):(s=t,c===0&&f(j));else o=t;if(o!==t){if(s=n,i.charCodeAt(n)===101?(h=Je,n++):(h=t,c===0&&f(ft)),h!==t){if(de.test(i.charAt(n))?(w=i.charAt(n),n++):(w=t,c===0&&f(be)),w===t&&(w=null),m=[],N.test(i.charAt(n))?(E=i.charAt(n),n++):(E=t,c===0&&f(j)),E!==t)for(;E!==t;)m.push(E),N.test(i.charAt(n))?(E=i.charAt(n),n++):(E=t,c===0&&f(j));else m=t;m!==t?s=h=[h,w,m]:(n=s,s=t)}else n=s,s=t;s===t&&(s=null),g=e,e=jt()}else n=e,e=t;return e}function Gt(e,o){return e.map((function(s){return s[o]}))}function Ht(e,o,s){return[e].concat(Gt(o,s))}if((y=X())!==t&&n===i.length)return y;throw y!==t&&n<i.length&&f(Xt()),Yt(K,S<i.length?i.charAt(S):null,S<i.length?Me(S,S+1):Me(S,S))}return r(a,Error),a.prototype.format=function(i){var d="Error: "+this.message;if(this.location){var y,t=null;for(y=0;y<i.length;y++)if(i[y].source===this.location.source){t=i[y].text.split(/\r\n|\n|\r/g);break}var x=this.location.start,_=this.location.source&&typeof this.location.source.offset=="function"?this.location.source.offset(x):x,X=this.location.source+":"+_.line+":"+_.column;if(t){var Y=this.location.end,J=u("",_.line.toString().length," "),p=t[x.line-1],v=(x.line===Y.line?Y.column:p.length+1)-x.column||1;d+=`
 --> `+X+`
`+J+` |
`+_.line+" | "+p+`
`+J+" | "+u("",x.column-1," ")+u("",v,"^")}else d+=`
 at `+X}return d},a.buildMessage=function(i,d){var y={literal:function(p){return'"'+x(p.text)+'"'},class:function(p){var v=p.parts.map((function(O){return Array.isArray(O)?_(O[0])+"-"+_(O[1]):_(O)}));return"["+(p.inverted?"^":"")+v.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(p){return p.description}};function t(p){return p.charCodeAt(0).toString(16).toUpperCase()}function x(p){return p.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(v){return"\\x0"+t(v)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(v){return"\\x"+t(v)}))}function _(p){return p.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(v){return"\\x0"+t(v)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(v){return"\\x"+t(v)}))}function X(p){return y[p.type](p)}function Y(p){var v,O,b=p.map(X);if(b.sort(),b.length>0){for(v=1,O=1;v<b.length;v++)b[v-1]!==b[v]&&(b[O]=b[v],O++);b.length=O}switch(b.length){case 1:return b[0];case 2:return b[0]+" or "+b[1];default:return b.slice(0,-1).join(", ")+", or "+b[b.length-1]}}function J(p){return p?'"'+x(p)+'"':"end of input"}return"Expected "+Y(i)+" but "+J(d)+" found."},{SyntaxError:a,parse:l}},(Fe=ee).exports&&(Fe.exports=Ee());var lr=ee.exports;function kr(r){if(!r||r.length===0)return null;if(typeof r=="string"){const u=_e(r);return u&&u.length!==0?u:null}const a=r.map((u=>{if(!Number.isFinite(u.scale)||u.scale<=0)throw new $("effect:invalid-scale","scale must be finite and greater than 0",{stop:u});return{scale:u.scale,effects:_e(u.value)}}));a.sort(((u,l)=>l.effects.length-u.effects.length));for(let u=0;u<a.length-1;u++){if(!ir(a[u].effects,a[u+1].effects))throw new $("effect:interpolation-impossible","Cannot interpolate by scale between 2 lists of mixed effects",{a:a[u].effects,b:a[u+1].effects});cr(a[u].effects,a[u+1].effects)}return a.sort(((u,l)=>l.scale-u.scale)),a}function _e(r){let a;if(!r)return[];try{a=lr.parse(r)}catch(u){throw new $("effect:invalid-syntax","Invalid effect syntax",{value:r,error:u})}return a.map((u=>fr(u)))}function fr(r){try{switch(r.name){case"grayscale":case"sepia":case"saturate":case"invert":case"brightness":case"contrast":return hr(r);case"opacity":return pr(r);case"hue-rotate":return mr(r);case"blur":return gr(r);case"drop-shadow":return dr(r);case"bloom":return yr(r)}}catch(a){throw a.details.filter=r,a}throw new $("effect:unknown-effect",`Effect '${r.name}' is not supported`,{effect:r})}function hr(r){let a=1;return P(r.parameters,1),r.parameters.length===1&&(a=R(r.parameters[0])),new U(r.name,a)}function pr(r){let a=1;return P(r.parameters,1),r.parameters.length===1&&(a=R(r.parameters[0])),new W(a)}function mr(r){let a=0;return P(r.parameters,1),r.parameters.length===1&&(a=Mr(r.parameters[0])),new je(a)}function gr(r){let a=0;return P(r.parameters,1),r.parameters.length===1&&(a=ne(r.parameters[0]),B(a,r.parameters[0])),new Re(a)}function dr(r){const a=[];let u=null;for(const l of r.parameters)if(l.type==="color"){if(a.length&&Object.freeze(a),u)throw new $("effect:type-error","Accepts only one color",{});u=$r(l)}else{const i=ne(l);if(Object.isFrozen(a))throw new $("effect:type-error","<length> parameters not consecutive",{lengths:a});a.push(i),a.length===3&&B(i,l)}if(a.length<2||a.length>3)throw new $("effect:type-error",`Expected <length>{2,3}, Actual: <length>{${a.length}}`,{lengths:a});return new ke(a[0],a[1],a[2]||0,u||Ye("black"))}function yr(r){let a=1,u=0,l=0;return P(r.parameters,3),r.parameters[0]&&(a=R(r.parameters[0])),r.parameters[1]&&(u=ne(r.parameters[1]),B(u,r.parameters[1])),r.parameters[2]&&(l=R(r.parameters[2])),new V(a,u,l)}function P(r,a){if(r.length>a)throw new $("effect:type-error",`Function supports up to ${a} parameters, Actual: ${r.length}`,{parameters:r})}function Z(r){if(r.type==="color")return"<color>";if(r.unit){if(r.unit in re)return"<length>";if(r.unit in te)return"<angle>";if(r.unit==="%")return"<percentage>"}return"<double>"}function B(r,a){if(r<0)throw new $("effect:type-error",`Negative values are not allowed, Actual: ${r}`,{term:a})}function vr(r){if(r.type!=="quantity"||r.unit!==null)throw new $("effect:type-error",`Expected <double>, Actual: ${Z(r)}`,{term:r})}function wr(r){if(r.type!=="quantity"||r.unit!==null&&r.unit!=="%")throw new $("effect:type-error",`Expected <double> or <percentage>, Actual: ${Z(r)}`,{term:r})}const te={deg:1,grad:.9,rad:180/Math.PI,turn:360};function xr(r){if(r.type!=="quantity"||!(r.value===0&&r.unit===null||r.unit&&te[r.unit]!=null))throw new $("effect:type-error",`Expected <angle>, Actual: ${Z(r)}`,{term:r})}const re={px:1,cm:96/2.54,mm:96/2.54/10,in:96,pc:16,pt:96/72};function br(r){if(r.type!=="quantity"||!(r.value===0&&r.unit===null||r.unit&&re[r.unit]!=null))throw new $("effect:type-error",`Expected <length>, Actual: ${Z(r)}`,{term:r})}function R(r){wr(r);const a=r.value;return B(a,r),r.unit==="%"?.01*a:a}function Ar(r){return vr(r),B(r.value,r),r.value}function Mr(r){return xr(r),r.value*te[r.unit]||0}function ne(r){return br(r),r.value*re[r.unit]||0}function $r(r){switch(r.colorType){case"hex":return Zt(r.value);case"named":return Ye(r.value);case"function":return Er(r.value)}}function Ye(r){if(!Kt(r))throw new $("effect:unknown-color",`color '${r}' isn't valid`,{namedColor:r});return Lt(r)}const Cr=/^rgba?/i,Fr=/^hsla?/i;function Er(r){if(P(r.parameters,4),Cr.test(r.name))return[R(r.parameters[0]),R(r.parameters[1]),R(r.parameters[2]),r.parameters[3]?R(r.parameters[3]):1];if(Fr.test(r.name))return Qt(Ar(r.parameters[0]),R(r.parameters[1]),R(r.parameters[2]),r.parameters[3]?R(r.parameters[3]):1);throw new $("effect:syntax-error",`Invalid color function '${r.name}'`,{colorFunction:r})}export{cr as e,Sr as l,ir as t,kr as y};
