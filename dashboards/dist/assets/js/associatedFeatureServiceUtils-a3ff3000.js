import{a0 as t,p as f,s as m,az as E,aA as T,d8 as y,a3 as d,bo as D}from"./index-7211d811.js";const P={BingMapsLayer:async()=>(await t(()=>import("./BingMapsLayer-c95b15c2.js"),["./BingMapsLayer-c95b15c2.js","./index-7211d811.js","..\\index-b7f3bae3.css","./imageBitmapUtils-45469bae.js"],import.meta.url)).default,BuildingSceneLayer:async()=>(await t(()=>import("./BuildingSceneLayer-06d9566b.js"),["./BuildingSceneLayer-06d9566b.js","./index-7211d811.js","..\\index-b7f3bae3.css","./I3SUtil-b8b1b4a0.js","./mat3f64-221ce671.js","./mat4f64-1413b4a7.js","./quat-1e6ecbc4.js","./quatf64-3363c48e.js","./spatialReferenceEllipsoidUtils-2fa5526c.js","./I3SBinaryReader-7f2c8353.js","./VertexAttribute-0e674613.js","./orientedBoundingBox-ca74ac70.js","./plane-e5351bee.js","./sphere-8017ea55.js","./SceneService-184bc1a6.js","./originUtils-cfe4feaf.js","./multiOriginJSONSupportUtils-c978f4c3.js","./saveAPIKeyUtils-6d8415a3.js","./saveUtils-168b1619.js","./resourceUtils-ef8e266b.js","./I3SLayerDefinitions-e1784666.js","./popupUtils-dca4fb1f.js","./elevationInfoUtils-d6eb0487.js"],import.meta.url)).default,CSVLayer:async()=>(await t(()=>import("./CSVLayer-b7123e0e.js"),["./CSVLayer-b7123e0e.js","./index-7211d811.js","..\\index-b7f3bae3.css","./clientSideDefaults-19dfa0e9.js","./QueryEngineCapabilities-85c4f1d0.js"],import.meta.url)).default,DimensionLayer:async()=>(await t(()=>import("./DimensionLayer-62450f1e.js"),["./DimensionLayer-62450f1e.js","./index-7211d811.js","..\\index-b7f3bae3.css","./Analysis-fec5d18c.js"],import.meta.url)).default,ElevationLayer:async()=>(await t(()=>import("./ElevationLayer-98101539.js"),["./ElevationLayer-98101539.js","./index-7211d811.js","..\\index-b7f3bae3.css"],import.meta.url)).default,FeatureLayer:async()=>(await t(()=>import("./index-7211d811.js").then(e=>e.oV),["./index-7211d811.js","..\\index-b7f3bae3.css"],import.meta.url)).default,GeoJSONLayer:async()=>(await t(()=>import("./GeoJSONLayer-5824cf24.js"),["./GeoJSONLayer-5824cf24.js","./index-7211d811.js","..\\index-b7f3bae3.css","./clientSideDefaults-19dfa0e9.js","./QueryEngineCapabilities-85c4f1d0.js"],import.meta.url)).default,GeoRSSLayer:async()=>(await t(()=>import("./GeoRSSLayer-9bf69cf9.js"),["./GeoRSSLayer-9bf69cf9.js","./index-7211d811.js","..\\index-b7f3bae3.css"],import.meta.url)).default,GroupLayer:async()=>(await t(()=>import("./GroupLayer-e0802245.js"),["./GroupLayer-e0802245.js","./index-7211d811.js","..\\index-b7f3bae3.css","./saveUtils-168b1619.js","./resourceUtils-ef8e266b.js"],import.meta.url)).default,ImageryLayer:async()=>(await t(()=>import("./ImageryLayer-0996cc1f.js"),["./ImageryLayer-0996cc1f.js","./index-7211d811.js","..\\index-b7f3bae3.css","./ImageHistogramParameters-e8de5355.js","./multidimensionalUtils-e0de3fa5.js","./dataUtils-7b541edc.js","./RasterSymbolizer-4cec21ab.js","./utils-80707573.js","./utils-859f11ff.js","./generateRendererUtils-863cc806.js","./imageBitmapUtils-45469bae.js","./executeQueryJSON-4a8eef9e.js","./query-4006ca16.js","./pbfQueryUtils-5af3209d.js","./pbf-e184c7c2.js","./OptimizedGeometry-d94e541f.js","./OptimizedFeatureSet-1d1ac4b9.js","./featureConversionUtils-7dacf99d.js","./AttachmentInfo-b0928934.js","./executeForIds-422a42ec.js"],import.meta.url)).default,ImageryTileLayer:async()=>(await t(()=>import("./ImageryTileLayer-32b01df1.js"),["./ImageryTileLayer-32b01df1.js","./index-7211d811.js","..\\index-b7f3bae3.css","./ImageHistogramParameters-e8de5355.js","./multidimensionalUtils-e0de3fa5.js","./dataUtils-7b541edc.js","./RasterSymbolizer-4cec21ab.js","./utils-80707573.js","./utils-859f11ff.js","./generateRendererUtils-863cc806.js","./RawBlockCache-51261fc7.js","./rasterProjectionHelper-7832c0a9.js","./utils-13f08e34.js"],import.meta.url)).default,IntegratedMeshLayer:async()=>(await t(()=>import("./IntegratedMeshLayer-4328b19c.js"),["./IntegratedMeshLayer-4328b19c.js","./index-7211d811.js","..\\index-b7f3bae3.css","./persistable-7cb69658.js","./multiOriginJSONSupportUtils-c978f4c3.js","./resourceExtension-87d4be87.js","./SceneService-184bc1a6.js","./originUtils-cfe4feaf.js","./saveAPIKeyUtils-6d8415a3.js","./saveUtils-168b1619.js","./resourceUtils-ef8e266b.js","./I3SLayerDefinitions-e1784666.js","./elevationInfoUtils-d6eb0487.js"],import.meta.url)).default,KMLLayer:async()=>(await t(()=>import("./KMLLayer-4820b438.js"),["./KMLLayer-4820b438.js","./index-7211d811.js","..\\index-b7f3bae3.css","./kmlUtils-f3ee87af.js"],import.meta.url)).default,LineOfSightLayer:async()=>(await t(()=>import("./LineOfSightLayer-420d6ab7.js"),["./LineOfSightLayer-420d6ab7.js","./index-7211d811.js","..\\index-b7f3bae3.css","./Analysis-fec5d18c.js","./persistable-7cb69658.js","./multiOriginJSONSupportUtils-c978f4c3.js","./resourceExtension-87d4be87.js","./elevationInfoUtils-d6eb0487.js"],import.meta.url)).default,LinkChartLayer:async()=>(await t(()=>import("./LinkChartLayer-d5306695.js"),["./LinkChartLayer-d5306695.js","./index-7211d811.js","..\\index-b7f3bae3.css","./geohashUtils-77d8429b.js","./featureConversionUtils-7dacf99d.js","./OptimizedGeometry-d94e541f.js","./OptimizedFeatureSet-1d1ac4b9.js","./FeatureStore-8acd37b5.js","./BoundsStore-bb9b20ce.js","./PooledRBush-68c11578.js","./timeSupport-b60fec71.js","./projectionSupport-26da4a4e.js","./json-48e3ea08.js","./QueryEngine-3281d686.js","./WhereClause-90a7d96b.js","./TimeOnly-52b98de5.js","./QueryEngineCapabilities-85c4f1d0.js","./quantizationUtils-d7291828.js","./utils-4a3b8a02.js","./utils-bcaf1a8c.js","./generateRendererUtils-863cc806.js","./RenderState-1d6218ee.js","./clientSideDefaults-19dfa0e9.js"],import.meta.url)).default,MapImageLayer:async()=>(await t(()=>import("./MapImageLayer-7c31c29d.js"),["./MapImageLayer-7c31c29d.js","./index-7211d811.js","..\\index-b7f3bae3.css","./scaleUtils-6f53eafc.js","./SublayersOwner-18b4286e.js","./QueryTask-9c089958.js","./executeForIds-422a42ec.js","./query-4006ca16.js","./pbfQueryUtils-5af3209d.js","./pbf-e184c7c2.js","./OptimizedGeometry-d94e541f.js","./OptimizedFeatureSet-1d1ac4b9.js","./executeQueryJSON-4a8eef9e.js","./executeQueryPBF-bce3696b.js","./featureConversionUtils-7dacf99d.js","./sublayerUtils-66e320cd.js","./ExportImageParameters-e7677a7d.js","./floorFilterUtils-080a7cd2.js","./imageBitmapUtils-45469bae.js"],import.meta.url)).default,MapNotesLayer:async()=>(await t(()=>import("./MapNotesLayer-e24f7fa0.js"),["./MapNotesLayer-e24f7fa0.js","./index-7211d811.js","..\\index-b7f3bae3.css","./GraphicsLayer-74f4c208.js","./objectIdUtils-789e911a.js"],import.meta.url)).default,MediaLayer:async()=>(await t(()=>import("./MediaLayer-82e9cc40.js"),["./MediaLayer-82e9cc40.js","./index-7211d811.js","..\\index-b7f3bae3.css","./imageUtils-ae84c990.js","./perspectiveUtils-bf082877.js","./normalizeUtilsSync-54a1e768.js","./mat3f64-221ce671.js","./resourceExtension-87d4be87.js","./BoundsStore-bb9b20ce.js","./PooledRBush-68c11578.js"],import.meta.url)).default,OGCFeatureLayer:async()=>(await t(()=>import("./OGCFeatureLayer-5a66256e.js"),["./OGCFeatureLayer-5a66256e.js","./index-7211d811.js","..\\index-b7f3bae3.css","./ogcFeatureUtils-0078222c.js","./featureConversionUtils-7dacf99d.js","./OptimizedGeometry-d94e541f.js","./OptimizedFeatureSet-1d1ac4b9.js","./geojson-e47af753.js","./date-d60e9730.js","./clientSideDefaults-19dfa0e9.js","./QueryEngineCapabilities-85c4f1d0.js"],import.meta.url)).default,OpenStreetMapLayer:async()=>(await t(()=>import("./OpenStreetMapLayer-b482c357.js"),["./OpenStreetMapLayer-b482c357.js","./index-7211d811.js","..\\index-b7f3bae3.css","./WebTileLayer-fa7016c8.js","./imageBitmapUtils-45469bae.js"],import.meta.url)).default,OrientedImageryLayer:async()=>(await t(()=>import("./OrientedImageryLayer-00bb93a1.js"),["./OrientedImageryLayer-00bb93a1.js","./index-7211d811.js","..\\index-b7f3bae3.css"],import.meta.url)).default,PointCloudLayer:async()=>(await t(()=>import("./PointCloudLayer-3d5b924e.js"),["./PointCloudLayer-3d5b924e.js","./index-7211d811.js","..\\index-b7f3bae3.css","./SceneService-184bc1a6.js","./originUtils-cfe4feaf.js","./multiOriginJSONSupportUtils-c978f4c3.js","./saveAPIKeyUtils-6d8415a3.js","./saveUtils-168b1619.js","./resourceUtils-ef8e266b.js","./PointCloudUniqueValueRenderer-a5c0dade.js","./elevationInfoUtils-d6eb0487.js"],import.meta.url)).default,RouteLayer:async()=>(await t(()=>import("./RouteLayer-56334138.js"),["./RouteLayer-56334138.js","./index-7211d811.js","..\\index-b7f3bae3.css","./originUtils-cfe4feaf.js","./multiOriginJSONSupportUtils-c978f4c3.js","./Stop-1945e2a3.js","./commonProperties-da958896.js"],import.meta.url)).default,SceneLayer:async()=>(await t(()=>import("./SceneLayer-b92c0078.js"),["./SceneLayer-b92c0078.js","./index-7211d811.js","..\\index-b7f3bae3.css","./SceneService-184bc1a6.js","./originUtils-cfe4feaf.js","./multiOriginJSONSupportUtils-c978f4c3.js","./saveAPIKeyUtils-6d8415a3.js","./saveUtils-168b1619.js","./resourceUtils-ef8e266b.js","./I3SUtil-b8b1b4a0.js","./mat3f64-221ce671.js","./mat4f64-1413b4a7.js","./quat-1e6ecbc4.js","./quatf64-3363c48e.js","./spatialReferenceEllipsoidUtils-2fa5526c.js","./I3SBinaryReader-7f2c8353.js","./VertexAttribute-0e674613.js","./orientedBoundingBox-ca74ac70.js","./plane-e5351bee.js","./sphere-8017ea55.js","./I3SLayerDefinitions-e1784666.js","./persistable-7cb69658.js","./resourceExtension-87d4be87.js","./elevationInfoUtils-d6eb0487.js","./popupUtils-dca4fb1f.js"],import.meta.url)).default,StreamLayer:async()=>(await t(()=>import("./StreamLayer-f895fd31.js"),["./StreamLayer-f895fd31.js","./index-7211d811.js","..\\index-b7f3bae3.css"],import.meta.url)).default,SubtypeGroupLayer:async()=>(await t(()=>import("./SubtypeGroupLayer-7243da42.js"),["./SubtypeGroupLayer-7243da42.js","./index-7211d811.js","..\\index-b7f3bae3.css"],import.meta.url)).default,TileLayer:async()=>(await t(()=>import("./TileLayer-fb56d458.js"),["./TileLayer-fb56d458.js","./index-7211d811.js","..\\index-b7f3bae3.css","./SublayersOwner-18b4286e.js","./QueryTask-9c089958.js","./executeForIds-422a42ec.js","./query-4006ca16.js","./pbfQueryUtils-5af3209d.js","./pbf-e184c7c2.js","./OptimizedGeometry-d94e541f.js","./OptimizedFeatureSet-1d1ac4b9.js","./executeQueryJSON-4a8eef9e.js","./executeQueryPBF-bce3696b.js","./featureConversionUtils-7dacf99d.js","./sublayerUtils-66e320cd.js","./imageBitmapUtils-45469bae.js"],import.meta.url)).default,UnknownLayer:async()=>(await t(()=>import("./UnknownLayer-6976cd17.js"),["./UnknownLayer-6976cd17.js","./index-7211d811.js","..\\index-b7f3bae3.css"],import.meta.url)).default,UnsupportedLayer:async()=>(await t(()=>import("./UnsupportedLayer-946d70f2.js"),["./UnsupportedLayer-946d70f2.js","./index-7211d811.js","..\\index-b7f3bae3.css"],import.meta.url)).default,VectorTileLayer:async()=>(await t(()=>import("./index-7211d811.js").then(e=>e.oR),["./index-7211d811.js","..\\index-b7f3bae3.css"],import.meta.url)).default,VoxelLayer:async()=>(await t(()=>import("./VoxelLayer-41853e53.js"),["./VoxelLayer-41853e53.js","./index-7211d811.js","..\\index-b7f3bae3.css","./SceneService-184bc1a6.js","./originUtils-cfe4feaf.js","./multiOriginJSONSupportUtils-c978f4c3.js","./saveAPIKeyUtils-6d8415a3.js","./saveUtils-168b1619.js","./resourceUtils-ef8e266b.js","./persistable-7cb69658.js","./resourceExtension-87d4be87.js","./quat-1e6ecbc4.js","./mat3f64-221ce671.js","./quatf64-3363c48e.js"],import.meta.url)).default,WFSLayer:async()=>(await t(()=>import("./WFSLayer-d7424d24.js"),["./WFSLayer-d7424d24.js","./index-7211d811.js","..\\index-b7f3bae3.css","./clientSideDefaults-19dfa0e9.js","./QueryEngineCapabilities-85c4f1d0.js","./wfsUtils-e665d2f5.js","./geojson-e47af753.js","./date-d60e9730.js","./OptimizedGeometry-d94e541f.js","./xmlUtils-444cb4c0.js"],import.meta.url)).default,WMSLayer:async()=>(await t(()=>import("./WMSLayer-3388a8a5.js"),["./WMSLayer-3388a8a5.js","./index-7211d811.js","..\\index-b7f3bae3.css","./scaleUtils-6f53eafc.js","./crsUtils-3bab3d8c.js","./ExportWMSImageParameters-9033b335.js","./imageBitmapUtils-45469bae.js"],import.meta.url)).default,WMTSLayer:async()=>(await t(()=>import("./WMTSLayer-15a3ca17.js"),["./WMTSLayer-15a3ca17.js","./index-7211d811.js","..\\index-b7f3bae3.css","./WebTileLayer-fa7016c8.js","./imageBitmapUtils-45469bae.js","./crsUtils-3bab3d8c.js","./xmlUtils-444cb4c0.js"],import.meta.url)).default,WebTileLayer:async()=>(await t(()=>import("./WebTileLayer-fa7016c8.js").then(e=>e.W),["./WebTileLayer-fa7016c8.js","./index-7211d811.js","..\\index-b7f3bae3.css","./imageBitmapUtils-45469bae.js"],import.meta.url)).default};async function h(e,o){const i=f(e);if(!i)throw new m("invalid-url","Invalid scene service url");const a={...o,sceneServerUrl:i.url.path,layerId:i.sublayer??void 0};if(a.sceneLayerItem??(a.sceneLayerItem=await A(a)),a.sceneLayerItem==null)return L(a.sceneServerUrl.replace("/SceneServer","/FeatureServer"),a);const r=await R(a);if(!(r!=null&&r.url))throw new m("related-service-not-found","Could not find feature service through portal item relationship");const _=await L(r.url,a);return _.portalItem=r,_}async function A(e){const o=(await v(e)).serviceItemId;if(!o)return null;const i=new E({id:o,apiKey:e.apiKey}),a=await O(e);a!=null&&(i.portal=new T({url:a}));try{return i.load({signal:e.signal})}catch(r){return y(r),null}}async function v(e){if(e.rootDocument)return e.rootDocument;const o={query:{f:"json",token:e.apiKey},responseType:"json",signal:e.signal};try{const i=await d(e.sceneServerUrl,o);e.rootDocument=i.data}catch{e.rootDocument={}}return e.rootDocument}async function O(e){var a;const o=(a=D)==null?void 0:a.findServerInfo(e.sceneServerUrl);if(o!=null&&o.owningSystemUrl)return o.owningSystemUrl;const i=e.sceneServerUrl.replace(/(.*\/rest)\/.*/i,"$1")+"/info";try{const r=(await d(i,{query:{f:"json"},responseType:"json",signal:e.signal})).data.owningSystemUrl;if(r)return r}catch(r){y(r)}return null}async function L(e,o){const i=f(e);if(!i)throw new m("invalid-feature-service-url","Invalid feature service url");const a=i.url.path,r=o.layerId;if(r==null)return{serverUrl:a};const _=v(o),c=n=>{const I={query:{f:"json"},responseType:"json",authMode:n,signal:o.signal};return d(a,I)},w=c("anonymous").catch(()=>c("no-prompt")),[p,l]=await Promise.all([w,_]),s=l==null?void 0:l.layers,u=p.data&&p.data.layers;if(!Array.isArray(u))throw new Error("expected layers array");if(Array.isArray(s)){for(let n=0;n<Math.min(s.length,u.length);n++)if(s[n].id===r)return{serverUrl:a,layerId:u[n].id}}else if(r!=null&&r<u.length)return{serverUrl:a,layerId:u[r].id};throw new Error("could not find matching associated sublayer")}async function R({sceneLayerItem:e,signal:o}){if(!e)return null;try{const i=(await e.fetchRelatedItems({relationshipType:"Service2Service",direction:"reverse"},{signal:o})).find(r=>r.type==="Feature Service")||null;if(!i)return null;const a=new E({portal:i.portal,id:i.id});return await a.load(),a}catch(i){return y(i),null}}export{P as a,h as l};
