import{fK as T,fL as F,C as _,c9 as L,ca as m,bV as Y,cc as b,cd as p,c8 as x,dX as f,fI as v,eR as G,bT as z,bR as Q,fi as j,eQ as H,s as J,fM as P,B as U,cb as tt,bW as E,fN as et,bY as st,fO as R,dM as O,dY as it}from"./uuid-De2V3pkO.js";import{g as rt}from"./mat4-DR7ljCfE.js";import{u as nt,n as ot,r as I}from"./vec4f64-Jk3PXxMO.js";import{E as ct}from"./ByteSizeUnit-BsxeN7wM.js";import{n as ut}from"./mat3f64-BVJGbF0t.js";import{n as at}from"./mat4f64-D0ba0WBC.js";import{n as ft}from"./quatf64-QCogZAoR.js";import{o as ht}from"./vec2f64-BuJjW9A-.js";class mt{constructor(e){this._allocator=e,this._items=[],this._itemsPtr=0,this._grow()}get(){return this._itemsPtr===0&&T((()=>this._reset())),this._itemsPtr===this._items.length&&this._grow(),this._items[this._itemsPtr++]}_reset(){const e=Math.min(3*Math.max(8,this._itemsPtr),this._itemsPtr+3*q);this._items.length=Math.min(e,this._items.length),this._itemsPtr=0}_grow(){for(let e=0;e<Math.max(8,Math.min(this._items.length,q));e++)this._items.push(this._allocator())}}const q=1024;let g=class a{constructor(e,s,i){this._itemByteSize=e,this._itemCreate=s,this._buffers=new Array,this._items=new Array,this._itemsPtr=0,this._itemsPerBuffer=Math.ceil(i/this._itemByteSize)}get(){this._itemsPtr===0&&T((()=>this._reset()));const e=Math.floor(this._itemsPtr/this._itemsPerBuffer);for(;this._buffers.length<=e;){const s=new ArrayBuffer(this._itemsPerBuffer*this._itemByteSize);for(let i=0;i<this._itemsPerBuffer;++i)this._items.push(this._itemCreate(s,i*this._itemByteSize));this._buffers.push(s)}return this._items[this._itemsPtr++]}_reset(){const e=2*(Math.floor(this._itemsPtr/this._itemsPerBuffer)+1);for(;this._buffers.length>e;)this._buffers.pop(),this._items.length=this._buffers.length*this._itemsPerBuffer;this._itemsPtr=0}static createVec2f64(e=l){return new a(16,ht,e)}static createVec3f64(e=l){return new a(24,F,e)}static createVec4f64(e=l){return new a(32,nt,e)}static createMat3f64(e=l){return new a(72,ut,e)}static createMat4f64(e=l){return new a(128,at,e)}static createQuatf64(e=l){return new a(32,ft,e)}get test(){return{size:this._buffers.length*this._itemsPerBuffer*this._itemByteSize}}};const l=4*ct.KILOBYTES;g.createVec2f64();const h=g.createVec3f64();g.createVec4f64();g.createMat3f64();const lt=g.createMat4f64();g.createQuatf64();function K(t){return t?C(x(t.origin),x(t.direction)):C(_(),_())}function C(t,e){return{origin:t,direction:e}}function kt(t,e){const s=pt.get();return s.origin=t,s.direction=e,s}function _t(t,e,s=K()){return L(s.origin,t),m(s.direction,e,t),s}function gt(t,e,s){const i=Y(t.direction,m(s,e,t.origin));return b(s,t.origin,p(s,t.direction,i)),s}const pt=new mt((()=>K()));function dt(t,e){const s=Y(t,e)/(f(t)*f(e));return-v(s)}const Mt=d();function d(){return ot()}const Pt=Q,$t=Q;function N(t,e=d()){return z(e,t)}function bt(t,e){return I(t[0],t[1],t[2],e)}function wt(t){return t}function yt(t){t[0]=t[1]=t[2]=t[3]=0}function Bt(t,e){return t[0]=t[1]=t[2]=0,t[3]=e,t}function w(t){return t[3]}function St(t){return t}function zt(t,e,s,i){return I(t,e,s,i)}function At(t,e,s){return t!==s&&L(s,t),s[3]=t[3]+e,s}function Vt(t,e,s){return J.getLogger("esri.geometry.support.sphere").error("sphere.setExtent is not yet supported"),t===s?s:N(t,s)}function y(t,e,s){if(e==null||!X(t,e,$))return!1;let{t0:i,t1:r}=$;if((i<0||r<i&&r>0)&&(i=r),i<0)return!1;if(s){const{origin:n,direction:o}=e;s[0]=n[0]+o[0]*i,s[1]=n[1]+o[1]*i,s[2]=n[2]+o[2]*i}return!0}function xt(t,e,s){const i=_t(e,s);if(!X(t,i,$))return[];const{origin:r,direction:n}=i,{t0:o,t1:c}=$,u=M=>{const B=_();return it(B,r,n,M),V(t,B,B)};return Math.abs(o-c)<U()?[u(o)]:[u(o),u(c)]}const $={t0:0,t1:0};function X(t,e,s){const{origin:i,direction:r}=e,n=Et;n[0]=i[0]-t[0],n[1]=i[1]-t[1],n[2]=i[2]-t[2];const o=r[0]*r[0]+r[1]*r[1]+r[2]*r[2];if(o===0)return!1;const c=2*(r[0]*n[0]+r[1]*n[1]+r[2]*n[2]),u=c*c-4*o*(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]-t[3]*t[3]);if(u<0)return!1;const M=Math.sqrt(u);return s.t0=(-c-M)/(2*o),s.t1=(-c+M)/(2*o),!0}const Et=_();function Rt(t,e){return y(t,e,null)}function Ot(t,e,s){if(y(t,e,s))return s;const i=Z(t,e,h.get());return b(s,e.origin,p(h.get(),e.direction,j(e.origin,i)/f(e.direction))),s}function Z(t,e,s){const i=h.get(),r=lt.get();E(i,e.origin,e.direction);const n=w(t);E(s,i,e.origin),p(s,s,1/f(s)*n);const o=W(t,e.origin),c=dt(e.origin,s);return rt(r,c+o,i),et(s,s,r),s}function qt(t,e,s){return y(t,e,s)?s:(gt(e,t,s),V(t,s,s))}function V(t,e,s){const i=m(h.get(),e,t),r=p(h.get(),i,t[3]/f(i));return b(s,r,t)}function Ct(t,e){const s=m(h.get(),e,t),i=tt(s),r=t[3]*t[3];return Math.sqrt(Math.abs(i-r))}function W(t,e){const s=m(h.get(),e,t),i=f(s),r=w(t),n=r+Math.abs(r-i);return v(r/n)}const S=_();function k(t,e,s,i){const r=m(S,e,t);switch(s){case P.X:{const n=R(r,S)[2];return O(i,-Math.sin(n),Math.cos(n),0)}case P.Y:{const n=R(r,S),o=n[1],c=n[2],u=Math.sin(o);return O(i,-u*Math.cos(c),-u*Math.sin(c),Math.cos(o))}case P.Z:return st(i,r);default:return}}function D(t,e){const s=m(A,e,t);return f(s)-t[3]}function Tt(t,e,s,i){const r=D(t,e),n=k(t,e,P.Z,A),o=p(A,n,s-r);return b(i,e,o)}function Lt(t,e){const s=G(t,e),i=w(t);return s<=i*i}function Yt(t,e,s=d()){const i=j(t,e),r=t[3],n=e[3];return i+n<r?(z(s,t),s):i+r<n?(z(s,e),s):(H(s,t,e,(i+n-r)/(2*i)),s[3]=(i+r+n)/2,s)}const A=_(),vt=d();Object.freeze(Object.defineProperty({__proto__:null,NullSphere:Mt,altitudeAt:D,angleToSilhouette:W,axisAt:k,clear:yt,closestPoint:qt,closestPointOnSilhouette:Z,containsPoint:Lt,copy:N,create:d,distanceToSilhouette:Ct,elevate:At,equals:$t,exactEquals:Pt,fromCenterAndRadius:bt,fromRadius:Bt,fromValues:zt,getCenter:St,getRadius:w,intersectLine:xt,intersectRay:y,intersectRayClosestSilhouette:Ot,intersectsRay:Rt,projectPoint:V,setAltitudeAt:Tt,setExtent:Vt,tmpSphere:vt,union:Yt,wrap:wt},Symbol.toStringTag,{value:"Module"}));export{w as B,d as E,Rt as J,N as T,St as U,h as c,K as d,Lt as i,kt as p,mt as s};
