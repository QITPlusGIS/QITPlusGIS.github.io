import{a as r,bK as Ra,R as xt,c as _,cE as Va,V as O,b as Tt,s as T,u as F,n as La,o as P,W as ue,q as Ei,y as h,U as _s,aK as wn,ey as Oa,fd as Aa,aJ as ge,m as Ii,d as pt,l as za,dl as Ji,D as b,d4 as Ne,a3 as vs,b4 as D,fk as Le,T as Na,I as Bt,a8 as Ha,a7 as bn,f,P as B,fa as It,a4 as ne,hh as fs,hr as dt,f9 as Me,e8 as Ga,w as ei,ee as Fa,hN as Ua,hO as ja,hP as Tn,hi as qa,hQ as kn,h6 as Za,b$ as Qi,b1 as en,F as Ba,er as ci,v as tn,e2 as Ge,ex as ws,hR as ti,eu as pi,ea as Z,e as bs,f8 as Wa,cj as Ka,hS as Pt,de as Di,ew as Ya,fb as Xa,gs as Ts,fu as Mn,au as Ja,E as kt,G as ii,eO as Qa,S as Ye,N as nn,g$ as eo,db as to,a$ as ks,aO as io,da as no,gk as Ms,aU as so,hT as ao,gl as sn,fF as xs,hU as oo,b5 as ro,a6 as xn,gK as lo,cc as ho,cA as di,h as Ri,hV as Pn,g as co,bx as po,_ as uo,el as mo,c7 as go,dn as Cn,cx as yo,j as _o,dm as Sn}from"./uuid-fb53ae2e.js";import{R as vo}from"./Basemap-fc4d26ee.js";import{_ as w}from"./index-e42a63f9.js";import{o as fo}from"./compilerUtils-811a6f43.js";import{t as wo}from"./loadAll-76369e9a.js";import{l as Wt}from"./CollectionFlattener-5cd5b172.js";import{u as bo,i as To}from"./infoFor3D-24efd44a.js";import{x as ko,O as Mo}from"./layerUtils-a8920453.js";import{y as xo,m as Po,b as Co}from"./basemapUtils-0a6b5a56.js";import{l as So,d as $o,t as Eo,n as ui}from"./TablesMixin-2871072c.js";import{s as Io}from"./Cyclical-8c26e7c7.js";import{s as $n,m as Do}from"./workers-3c8ba252.js";import{f as an,p as Ro,E as on,D as ni,b as Ct,_ as rn,c as Vo,T as Lo}from"./arcgisLayerUrl-fc2d909c.js";import{p as Oo,j as Ao}from"./TileInfo-238dd4b6.js";import{P as En,Q as Ps,R as In,S as Cs,K as zo,U as Dn,D as si,O as St,E as z,I as xe,J as No}from"./jsxFactory-8f2e778f.js";import{h as ai}from"./UpdatingHandles-9a53fef9.js";import{r as Ho}from"./signal-a61cc993.js";import{n as Go,i as Ss,l as Rn}from"./GraphicsCollection-2966693c.js";import{l as Vn}from"./ViewingMode-fb6259a5.js";import{t as Vi,r as Fo}from"./unitBezier-881ac1eb.js";import{f as $s,e as ln,c as Es,i as Kt,h as Uo,M as jo,d as Is,n as qo}from"./mat2df32-b9bfc1f5.js";import{g as Zo,l as oi,r as A,o as Li,v as Ln,y as Bo,j as Wo,q as On,C as Ds,z as de,a as Yt,s as Ko,m as Yo}from"./vec2-aed931ac.js";import{r as Xo,n as R}from"./vec2f64-95bf678d.js";import{P as Rs,v as Jo}from"./normalizeUtils-a2b8b8b6.js";import{h as Qo}from"./TileInfoView-be4d795d.js";import{s as er,r as tr,M as An,h as ir,i as nr}from"./mat3-1b291d2f.js";import{e as mi}from"./mat3f32-6c416b1c.js";import{t as zn}from"./vec2f32-eaf29605.js";import{d as sr}from"./TileStore-6570f2cc.js";import{a as ar,n as or}from"./capabilities-6261cefc.js";import{a as hn,e as X,t as rr}from"./GoTo-2cdac7e7.js";var Oi;let zt=Oi=class extends xt{constructor(t){super(t),this.type="none"}clone(){return new Oi({type:this.type})}};r([Ra({none:"none",stayAbove:"stay-above"})],zt.prototype,"type",void 0),zt=Oi=r([_("esri.ground.NavigationConstraint")],zt);var Ai;let fe=Ai=class extends Va(Ii){constructor(t){super(t),this.opacity=1,this.surfaceColor=null,this.navigationConstraint=null,this.layers=new O;const e=n=>{n.parent&&n.parent!==this&&"remove"in n.parent&&n.parent.remove(n),n.parent=this,n.type!=="elevation"&&n.type!=="base-elevation"&&T.getLogger(this).error(`Layer '${n.title}, id:${n.id}' of type '${n.type}' is not supported as a ground layer and will therefore be ignored. Only layers of type 'elevation' are supported.`)},i=n=>{n.parent=null};this.addHandles([this.layers.on("after-add",n=>e(n.item)),this.layers.on("after-remove",n=>i(n.item))])}initialize(){this.when().catch(t=>{Tt(t)||T.getLogger(this).error("#load()","Failed to load ground",t)}),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}destroy(){const t=this.layers.removeAll();for(const e of t)F(e);this.layers.destroy()}normalizeCtorArgs(t){return t&&"resourceInfo"in t&&(this._set("resourceInfo",t.resourceInfo),delete(t={...t}).resourceInfo),t}set layers(t){this._set("layers",La(t,this._get("layers")))}writeLayers(t,e,i,n){const s=[];t&&(n={...n,layerContainerType:"ground"},t.forEach(a=>{if("write"in a){const o={};fo(a)().write(o,n)&&s.push(o)}else n!=null&&n.messages&&n.messages.push(new P("layer:unsupported",`Layers (${a.title}, ${a.id}) of type '${a.declaredClass}' cannot be persisted in the ground`,{layer:a}))})),e.layers=s}load(t){return this.addResolvingPromise(this._loadFromSource(t)),Promise.resolve(this)}loadAll(){return wo(this,t=>{t(this.layers)})}async queryElevation(t,e){await this.load({signal:e==null?void 0:e.signal});const{ElevationQuery:i}=await w(()=>import("./ElevationQuery-ad2b6591.js"),["./ElevationQuery-ad2b6591.js","./uuid-fb53ae2e.js","./index-e42a63f9.js","./arcgisLayerUrl-fc2d909c.js","./TileInfo-238dd4b6.js"],import.meta.url);ue(e);const n=new i,s=this.layers.filter(Nn).toArray();return n.queryAll(s,t,e)}async createElevationSampler(t,e){await this.load({signal:e==null?void 0:e.signal});const{ElevationQuery:i}=await w(()=>import("./ElevationQuery-ad2b6591.js"),["./ElevationQuery-ad2b6591.js","./uuid-fb53ae2e.js","./index-e42a63f9.js","./arcgisLayerUrl-fc2d909c.js","./TileInfo-238dd4b6.js"],import.meta.url);ue(e);const n=new i,s=this.layers.filter(Nn).toArray();return n.createSamplerAll(s,t,e)}clone(){const t={opacity:this.opacity,surfaceColor:Ei(this.surfaceColor),navigationConstraint:Ei(this.navigationConstraint),layers:this.layers.slice()};return this.loaded&&(t.loadStatus="loaded"),new Ai({resourceInfo:this.resourceInfo}).set(t)}read(t,e){this.resourceInfo||this._set("resourceInfo",{data:t,context:e}),super.read(t,e)}_loadFromSource(t){const e=this.resourceInfo;return e?this._loadLayersFromJSON(e.data,e.context,t):Promise.resolve()}async _loadLayersFromJSON(t,e,i){const n=(e==null?void 0:e.origin)||"web-scene",s=(e==null?void 0:e.portal)||null,a=(e==null?void 0:e.url)||null,{populateOperationalLayers:o}=await w(()=>import("./layersCreator-c5283148.js"),["./layersCreator-c5283148.js","./uuid-fb53ae2e.js","./index-e42a63f9.js","./portalLayers-408a31ab.js","./associatedFeatureServiceUtils-8124dbc4.js","./arcgisLayerUrl-fc2d909c.js","./PortalItem-01395053.js","./requestPresets-25d3d846.js","./layerUtils-a8920453.js","./portalItemUtils-064daa72.js","./styleUtils-acaf630f.js"],import.meta.url);ue(i);const l=[];if(t.layers&&Array.isArray(t.layers)){const c={context:{origin:n,url:a,portal:s,layerContainerType:"ground"},defaultLayerType:"ArcGISTiledElevationServiceLayer"};l.push(o(this.layers,t.layers,c))}await Promise.allSettled(l)}};function lr(t){return t&&"createElevationSampler"in t}function Nn(t){return t.type==="elevation"||lr(t)}r([h({json:{read:!1}})],fe.prototype,"layers",null),r([_s("layers")],fe.prototype,"writeLayers",null),r([h({readOnly:!0})],fe.prototype,"resourceInfo",void 0),r([h({type:Number,nonNullable:!0,range:{min:0,max:1},json:{type:wn,read:{reader:Oa,source:"transparency"},write:{writer:(t,e)=>{e.transparency=Aa(t)},target:"transparency"}}})],fe.prototype,"opacity",void 0),r([h({type:ge,json:{type:[wn],write:(t,e)=>{e.surfaceColor=t.toJSON().slice(0,3)}}})],fe.prototype,"surfaceColor",void 0),r([h({type:zt,json:{write:!0}})],fe.prototype,"navigationConstraint",void 0),fe=Ai=r([_("esri.Ground")],fe);const Xt=fe;function hr(t){var e,i;return!(!(t&&typeof t=="object"&&"loaded"in t&&t.loaded&&((i=(e=ko(t))==null?void 0:e.operations)!=null&&i.supportsEditing)&&"type"in t)||"editingEnabled"in t&&!Mo(t)||t.type==="scene"&&!cr(t))}function cr(t){const{associatedLayer:e}=t,i=e==null?void 0:e.infoFor3D;if(!i)return!0;const{supportedFormats:n,queryFormats:s}=i,a=bo("model/gltf-binary",n)??To("glb",n);if(!(a!=null&&s.includes(a)))return T.getLogger("esri.layers.support.editableLayers").warnOnce(`SceneLayer (${t.title??"Untitled layer"}, ${t.id}) is not editable because it does not support GLB queries.`),!1;const o=t.spatialReference,l=e.spatialReference;if(!pt(o,l))return T.getLogger("esri.layers.support.editableLayers").warnOnce(`SceneLayer (${t.title??"Untitled layer"}, ${t.id}) is not editable because its spatial reference (wkid:${o.wkid}) is different from its associated FeatureLayer's spatial reference (wkid:${l.wkid}).`),!1;const c=e.sourceJSON.sourceSpatialReference;return!(c!=null&&!pt(c,l))||(T.getLogger("esri.layers.support.editableLayers").warnOnce(`SceneLayer (${t.title??"Untitled layer"}, ${t.id}) is not editable because the spatial reference of its associated FeatureLayer's service (wkid:${l.wkid}) is different from its source spatial reference (wkid:${c.wkid}).`),!1)}const Hn={"world-elevation":{id:"worldElevation",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"},"world-topobathymetry":{id:"worldTopoBathymetry",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/TopoBathy3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"}};function pr(t){let e=null;if(typeof t=="string")if(t in Hn){const i=Hn[t];e=new Xt({resourceInfo:{data:{layers:[i]}}})}else T.getLogger("esri.support.groundUtils").warn(`Unable to find ground definition for: ${t}. Try "world-elevation"`);else e=za(Xt,t);return e}let oe=class extends So($o(Ji.EventedMixin(b))){constructor(e){super(e),this.allLayers=new Wt({getCollections:()=>{var i,n,s;return[(i=this.basemap)==null?void 0:i.baseLayers,(n=this.ground)==null?void 0:n.layers,this.layers,(s=this.basemap)==null?void 0:s.referenceLayers]},getChildrenFunction:i=>"layers"in i?i.layers:null}),this.allTables=Eo(this),this.basemap=null,this.editableLayers=new Wt({getCollections:()=>[this.allLayers],itemFilterFunction:hr}),this.ground=new Xt,this._basemapCache=xo()}destroy(){Po(this._basemapCache),this._basemapCache=null,this.allLayers.destroy(),this.allTables.destroy(),this.editableLayers.destroy(),this.basemap=F(this.basemap),F(this.ground),this._set("ground",null)}castBasemap(e){return Co(e,this._basemapCache)}castGround(e){return pr(e)??this._get("ground")}findLayerById(e){return this.allLayers.find(i=>i.id===e)}findTableById(e){return this.allTables.find(i=>i.id===e)}};r([h({readOnly:!0,dependsOn:[]})],oe.prototype,"allLayers",void 0),r([h({readOnly:!0})],oe.prototype,"allTables",void 0),r([h({type:vo,json:{read:{source:"baseMap"},write:{target:"baseMap"}}})],oe.prototype,"basemap",void 0),r([Ne("basemap")],oe.prototype,"castBasemap",null),r([h({readOnly:!0})],oe.prototype,"editableLayers",void 0),r([h({type:Xt,nonNullable:!0})],oe.prototype,"ground",void 0),r([Ne("ground")],oe.prototype,"castGround",null),oe=r([_("esri.Map")],oe);const Vs=oe;let we=class extends vs(xt){constructor(...e){super(...e),this.position=new D([0,0,0]),this.heading=0,this.tilt=0,this.fov=55}normalizeCtorArgs(e,i,n,s){if(e&&typeof e=="object"&&("x"in e||Array.isArray(e))){const a={position:e};return i!=null&&(a.heading=i),n!=null&&(a.tilt=n),s!=null&&(a.fov=s),a}return e}writePosition(e,i,n,s){const a=e.clone();a.x=Le(e.x||0),a.y=Le(e.y||0),a.z=e.hasZ?Le(e.z||0):e.z,i[n]=a.write({},s)}readPosition(e,i){const n=new D;return n.read(e,i),n.x=Le(n.x||0),n.y=Le(n.y||0),n.z=n.hasZ?Le(n.z||0):n.z,n}equals(e){return e!=null&&this.tilt===e.tilt&&this.heading===e.heading&&this.fov===e.fov&&this.position.equals(e.position)}};r([h({type:D,json:{write:{isRequired:!0}}})],we.prototype,"position",void 0),r([_s("position")],we.prototype,"writePosition",null),r([Na("position")],we.prototype,"readPosition",null),r([h({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),Ne(t=>Io.normalize(Le(t)))],we.prototype,"heading",void 0),r([h({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),Ne(t=>Bt(Le(t),-180,180))],we.prototype,"tilt",void 0),r([h({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],we.prototype,"fov",void 0),we=r([_("esri.Camera")],we);const dr=we;var zi;let Se=zi=class extends xt{constructor(t){super(t),this.rotation=0,this.scale=0,this.targetGeometry=null,this.camera=null}castRotation(t){return(t%=360)<0&&(t+=360),t}clone(){return new zi({rotation:this.rotation,scale:this.scale,targetGeometry:this.targetGeometry!=null?this.targetGeometry.clone():null,camera:this.camera!=null?this.camera.clone():null})}};function gi(){return{enabled:!this.camera}}r([h({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:gi}}}}})],Se.prototype,"rotation",void 0),r([Ne("rotation")],Se.prototype,"castRotation",null),r([h({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:gi}}}}})],Se.prototype,"scale",void 0),r([h({types:Ha,json:{read:bn,write:!0,origins:{"web-scene":{read:bn,write:{overridePolicy:gi}}}}})],Se.prototype,"targetGeometry",void 0),r([h({type:dr,json:{write:!0}})],Se.prototype,"camera",void 0),Se=zi=r([_("esri.Viewpoint")],Se);const me=Se,Nt={widthBreakpoint:{getValue(t){const e=t.viewSize[0],i=t.breakpoints,n=this.values;return e<=i.xsmall?n.xsmall:e<=i.small?n.small:e<=i.medium?n.medium:e<=i.large?n.large:n.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-width-xsmall esri-view-width-less-than-small esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",small:"esri-view-width-small esri-view-width-greater-than-xsmall esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",medium:"esri-view-width-medium esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-less-than-large esri-view-width-less-than-xlarge",large:"esri-view-width-large esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-less-than-xlarge",xlarge:"esri-view-width-xlarge esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-greater-than-large"}},heightBreakpoint:{getValue(t){const e=t.viewSize[1],i=t.breakpoints,n=this.values;return e<=i.xsmall?n.xsmall:e<=i.small?n.small:e<=i.medium?n.medium:e<=i.large?n.large:n.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-height-xsmall esri-view-height-less-than-small esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",small:"esri-view-height-small esri-view-height-greater-than-xsmall esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",medium:"esri-view-height-medium esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-less-than-large esri-view-height-less-than-xlarge",large:"esri-view-height-large esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-less-than-xlarge",xlarge:"esri-view-height-xlarge esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-greater-than-large"}},orientation:{getValue(t){const e=t.viewSize,i=e[0],n=e[1],s=this.values;return n>=i?s.portrait:s.landscape},values:{portrait:"portrait",landscape:"landscape"},valueToClassName:{portrait:"esri-view-orientation-portrait",landscape:"esri-view-orientation-landscape"}}},yi={xsmall:544,small:768,medium:992,large:1200};function ur(t){const e=t;return e&&e.xsmall<e.small&&e.small<e.medium&&e.medium<e.large}function _i(t,e){return e?Nt[t].valueToClassName[e].split(" "):[]}const mr=t=>{let e=class extends t{constructor(...i){super(...i),this.orientation=null,this.widthBreakpoint=null,this.heightBreakpoint=null,this.breakpoints=yi}initialize(){this.addHandles(f(()=>[this.breakpoints,this.size],()=>this._updateClassNames(),B))}destroy(){this.destroyed||this._removeActiveClassNames()}set breakpoints(i){if(i===this._get("breakpoints"))return;const n=ur(i);if(!n){const s=JSON.stringify(yi,null,2);console.warn("provided breakpoints are not valid, using defaults:"+s)}i=n?i:yi,this._set("breakpoints",{...i})}_updateClassNames(){if(!this.container)return;const i=It.acquire(),n=It.acquire();let s,a=!1;for(s in Nt){const o=this[s],l=Nt[s].getValue({viewSize:this.size,breakpoints:this.breakpoints});o!==l&&(a=!0,this[s]=l,_i(s,o).forEach(c=>n.push(c)),_i(s,l).forEach(c=>i.push(c)))}a&&(this._applyClassNameChanges(i,n),It.release(i),It.release(n))}_applyClassNameChanges(i,n){const s=this.container;s&&(n.forEach(a=>s.classList.remove(a)),i.forEach(a=>s.classList.add(a)))}_removeActiveClassNames(){const i=this.container;if(!i)return;let n;for(n in Nt)_i(n,this[n]).forEach(s=>i.classList.remove(s))}};return r([h()],e.prototype,"breakpoints",null),r([h()],e.prototype,"orientation",void 0),r([h()],e.prototype,"widthBreakpoint",void 0),r([h()],e.prototype,"heightBreakpoint",void 0),e=r([_("esri.views.BreakpointsOwner")],e),e};let $e=class extends b{constructor(){super(...arguments),this.items=new O,this._watchUpdatingTracking=new ai,this._callbacks=new Map,this._projector=En(),this._hiddenProjector=En()}get needsRender(){return this.items.length>0}get updating(){var e;return((e=this._watchUpdatingTracking)==null?void 0:e.updating)??!1}initialize(){const e=document.createElement("div");e.className="esri-overlay-surface",this._set("surface",e),this._hiddenSurface=document.createElement("div"),this._hiddenSurface.setAttribute("style","visibility: hidden;"),e.appendChild(this._hiddenSurface),this._watchUpdatingTracking.addOnCollectionChange(()=>this.items,i=>{for(const n of i.added){const s=()=>n.render();this._callbacks.set(n,s),this._projector.append(this.surface,s)}for(const n of i.removed){const s=this._projector.detach(this._callbacks.get(n));this.surface.removeChild(s.domNode),this._callbacks.delete(n)}})}addItem(e){this.items.add(e)}removeItem(e){this.items.remove(e)}destroy(){this.items.removeAll(),this._callbacks.forEach(e=>this._projector.detach(e)),this._callbacks=null,this._projector=null,this._watchUpdatingTracking.destroy()}render(){this._projector.renderNow()}computeBoundingRect(e){const i=this._hiddenSurface,n=this._hiddenProjector;let s;const a=()=>(s=e.render(),s);n.append(i,a),n.renderNow();const o={left:0,top:0,right:0,bottom:0};if(s!=null&&s.domNode){const l=s.domNode.getBoundingClientRect();o.left=l.left,o.top=l.top,o.right=l.right,o.bottom=l.bottom}for(n.detach(a);i.firstChild;)i.removeChild(i.firstChild);return o}overlaps(e,i){const n=this.computeBoundingRect(e),s=this.computeBoundingRect(i);return Math.max(n.left,s.left)<=Math.min(n.right,s.right)&&Math.max(n.top,s.top)<=Math.min(n.bottom,s.bottom)}get hasVisibleItems(){return this.items.some(e=>e.visible)}async prepare(){await document.fonts.load(this._fontString()).catch(()=>{})}renderCanvas(e,i){const n=!!(i!=null&&i.disableDecorations);if(!this.items.some(a=>a.visible&&!(n&&a.isDecoration)))return;const s=e.getContext("2d");s.save(),s.font=this._fontString(),this.items.forEach(a=>{n&&a.isDecoration||(s.save(),a.renderCanvas(s),s.restore())}),s.restore()}_fontString(){return`10px ${getComputedStyle(this.surface).fontFamily}`}};r([h({readOnly:!0})],$e.prototype,"surface",void 0),r([h({readOnly:!0})],$e.prototype,"items",void 0),r([h({readOnly:!0})],$e.prototype,"needsRender",null),r([h({readOnly:!0})],$e.prototype,"_watchUpdatingTracking",void 0),r([h({readOnly:!0})],$e.prototype,"updating",null),$e=r([_("esri.views.overlay.ViewOverlay")],$e);const Gn=$e,vi=[0,0];function gr(t){const e=(t.ownerDocument||window.document).defaultView,i=t.getBoundingClientRect();return vi[0]=i.left+((e==null?void 0:e.pageXOffset)??0),vi[1]=i.top+((e==null?void 0:e.pageYOffset)??0),vi}function Fn(t){t&&(Cs(t),t.parentNode&&t.parentNode.removeChild(t))}function yr(t){const e=document.createElement("div");return t.appendChild(e),e}const mt=16,Dt=750,_r=512,vr=2,fr=t=>{let e=class extends t{constructor(...i){super(...i),this._freqInfo={freq:mt,time:Dt},this._overlayRenderTaskHandle=null,this.height=0,this.messagesCommon=null,this.overlay=null,this.position=null,this.resizing=!1,this.root=null,this.surface=null,this.suspended=!0,this.ui=null,this.userContent=null,this.width=0,this.widthBreakpoint=null,this.addHandles([f(()=>this.cursor,n=>{const{surface:s}=this;s&&s.setAttribute("data-cursor",n)}),f(()=>this.navigating,n=>{const{surface:s}=this;s&&s.setAttribute("data-navigating",n.toString())})])}initialize(){const i=ne("mac"),n=async()=>{i&&(await ei(()=>this.ready),this.messagesCommon=await Fa("esri/t9n/common").catch(()=>{}))};n(),this.addHandles([f(()=>this.ui,(s,a)=>this._handleUIChange(s,a),B),this.on("focus",()=>this.notifyChange("focused")),this.on("blur",()=>this.notifyChange("focused")),fs(n)])}destroy(){this.destroyed||(this.ui=F(this.ui),this.container=null)}get container(){return this._get("container")??null}set container(i){const n=this._get("container"),s=Ps(i);if(s||typeof i!="string"||T.getLogger(this).error("#container",`element with id '${i}' not found`),n===s)return;if(this._stopMeasuring(),n&&(n.classList.remove("esri-view"),this._overlayRenderTaskHandle&&(this._overlayRenderTaskHandle.remove(),this._overlayRenderTaskHandle=null),this.overlay&&(this.overlay.destroy(),this._set("overlay",null)),this.root&&(Fn(this.root),this._set("root",null)),this.userContent&&(In(this.userContent,n),Fn(this.userContent),this._set("userContent",null))),!s)return this._set("width",0),this._set("height",0),this._set("position",null),this._set("suspended",!0),this._set("surface",null),void this._set("container",null);s.classList.add("esri-view");const a=document.createElement("div");a.className="esri-view-user-storage",In(s,a),s.appendChild(a),this._set("userContent",a);const o=document.createElement("div");o.className="esri-view-root",s.insertBefore(o,s.firstChild),this._set("root",o);const l=document.createElement("div");l.className="esri-view-surface",l.setAttribute("role","application"),l.tabIndex=0,o.appendChild(l),this._set("surface",l);const c=new Gn;o.appendChild(c.surface),this._set("overlay",c),this.addHandles(f(()=>c.needsRender,p=>{p&&!this._overlayRenderTaskHandle?this._overlayRenderTaskHandle=dt({render:()=>{var u;return(u=this.overlay)==null?void 0:u.render()}}):this._overlayRenderTaskHandle=Me(this._overlayRenderTaskHandle)})),this.forceDOMReadyCycle(),this._set("container",s),this._startMeasuring()}get focused(){const i=document.activeElement===this.surface;return document.hasFocus()&&i}get size(){return[this.width,this.height]}blur(){var i;(i=this.surface)==null||i.blur()}focus(){var i;(i=this.surface)==null||i.focus()}pageToContainer(i,n,s){const a=this.position;return i-=a?a[0]:0,n-=a?a[1]:0,s?(s[0]=i,s[1]=n):s=[i,n],s}containerToPage(i,n,s){const a=this.position;return i+=a?a[0]:0,n+=a?a[1]:0,s?(s[0]=i,s[1]=n):s=[i,n],s}_handleUIChange(i,n){this.removeHandles("ui"),n&&n!==i&&n.destroy(),i&&(i.view=this,this.addHandles(f(()=>this.root,s=>{i.container=s?yr(s):null},B),"ui")),this._set("ui",i)}_stopMeasuring(){this.removeHandles("measuring"),this._get("resizing")&&this._set("resizing",!1)}_startMeasuring(){const i=this._freqInfo;i.freq=mt,i.time=Dt,this.addHandles([Ga(window,"resize",()=>{i.freq=mt,i.time=Dt}),dt({prepare:n=>{const s=this._measure(),a=this._freqInfo;if(a.time+=n.deltaTime,s&&(a.freq=mt,this._get("resizing")||this._set("resizing",!0)),a.time<a.freq)return;a.time=0;const o=this._position();a.freq=o||s?mt:Math.min(Dt,a.freq*vr),!s&&a.freq>=_r&&this._get("resizing")&&this._set("resizing",!1)}})],"measuring"),this._measure(),this._position()}_measure(){const i=this.container,n=i?i.clientWidth:0,s=i?i.clientHeight:0;if(n===0||s===0)return this.suspended||this._set("suspended",!0),!1;const a=this.width,o=this.height;return n===a&&s===o?(this.suspended&&this._set("suspended",!1),!1):(this._set("width",n),this._set("height",s),this.suspended&&this._set("suspended",!1),this.emit("resize",{oldWidth:a,oldHeight:o,width:n,height:s}),!0)}_position(){const i=this.container,n=this.position,s=i&&gr(i);return!!s&&(!n||s[0]!==n[0]||s[1]!==n[1])&&(this._set("position",[s[0],s[1]]),!0)}forceDOMReadyCycle(){}};return r([h()],e.prototype,"container",null),r([h({readOnly:!0})],e.prototype,"focused",null),r([h({readOnly:!0})],e.prototype,"height",void 0),r([h()],e.prototype,"messagesCommon",void 0),r([h({type:Gn})],e.prototype,"overlay",void 0),r([h({readOnly:!0})],e.prototype,"position",void 0),r([h({readOnly:!0})],e.prototype,"resizing",void 0),r([h({readOnly:!0})],e.prototype,"root",void 0),r([h({value:null,readOnly:!0})],e.prototype,"size",null),r([h({readOnly:!0})],e.prototype,"surface",void 0),r([h({readOnly:!0})],e.prototype,"suspended",void 0),r([h()],e.prototype,"ui",void 0),r([h({readOnly:!0})],e.prototype,"userContent",void 0),r([h({readOnly:!0})],e.prototype,"width",void 0),r([h()],e.prototype,"widthBreakpoint",void 0),e=r([_("esri.views.DOMContainer")],e),e};let wr=class{constructor(e,i){this._owner=i,this._properties={},this._afterDispatchHandle=null;for(const n in e){const s=e[n],a=new Ua(s,void 0,void 0,2,2);this._properties[n]={pool:a,acquired:[]}}this._afterDispatchHandle=ja(()=>this._release())}destroy(){this._afterDispatchHandle&&(this._afterDispatchHandle.remove(),this._afterDispatchHandle=null);for(const e in this._properties){const i=this._properties[e];for(const n of i.acquired)Tn(n)||i.pool.release(n);i.pool.destroy(),i.pool=null,i.acquired=null}this._properties=null,this._owner=null}get(e){const i=this._owner._get(e),n=this._properties[e];let s=n.pool.acquire();for(n.acquired.push(s);s===i;)n.acquired.push(s),s=n.pool.acquire();return s}_release(){for(const e in this._properties){const i=this._properties[e];let n=0;for(const s of i.acquired)Tn(s)?i.acquired[n++]=s:i.pool.release(s);i.acquired.length=n}}};const br=ne("mac")?"Meta":"Ctrl",ri={8:"Backspace",9:"Tab",13:"Enter",27:"Escape",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete"};for(let t=48;t<58;t++)ri[t]=String.fromCharCode(t);for(let t=1;t<25;t++)ri[111+t]=`F${t}`;for(let t=65;t<91;t++)ri[t]=[String.fromCharCode(t+32),String.fromCharCode(t)];function Tr(t){if(t.key!==void 0)return qa(t);const e=ri[t.keyCode];return Array.isArray(e)?t.shiftKey?e[1]:e[0]:e}function kr(t){switch(t){case"Ctrl":case"Alt":case"Shift":case"Meta":case"Primary":return!0}return!1}let Mr=class{constructor(e,i=[]){this.eventType=e,this.keyModifiers=i}matches(e){if(e.type!==this.eventType)return!1;if(this.keyModifiers.length===0)return!0;const i=e.modifiers;for(const n of this.keyModifiers)if(!i.has(n))return!1;return!0}};const Un=T.getLogger("esri.views.input.InputHandler");let V=class{constructor(e){this._manager=null,this._incoming={},this._outgoing={},this._incomingEventMatches=null,this._incomingEventTypes=null,this._outgoingEventTypes=null,this._hasSideEffects=e}get incomingEventMatches(){if(!this._incomingEventMatches){this._incomingEventMatches=[];for(const e in this._incoming){const i=this._incoming[e];for(const n of i)this._incomingEventMatches.push(n.match)}}return this._incomingEventMatches}get incomingEventTypes(){return this._incomingEventTypes||(this._incomingEventTypes=this.incomingEventMatches.map(e=>e.eventType)),this._incomingEventTypes}get outgoingEventTypes(){return this._outgoingEventTypes||(this._outgoingEventTypes=Object.keys(this._outgoing)),this._outgoingEventTypes}get hasSideEffects(){return this._hasSideEffects}get hasPendingInputs(){return!1}onInstall(e){this._manager?Un.error("This InputHandler has already been registered with an InputManager"):(e.setEventCallback(i=>this._handleEvent(i)),e.setUninstallCallback(()=>this._onUninstall()),this._manager=e)}onUninstall(){}registerIncoming(e,i,n){let s;typeof i=="function"?(n=i,s=[]):s=i||[];const a=typeof e=="string"?new Mr(e,s):e,o=()=>{this._incomingEventTypes=null,this._incomingEventMatches=null},l=u=>{const m=this._incoming[u.match.eventType];if(m){const d=m.indexOf(u);m.splice(d,1),o(),this._manager&&this._manager.updateDependencies()}},c=new xr(a,n,{onPause:l,onRemove:l,onResume:u=>{const m=this._incoming[u.match.eventType];m&&!m.includes(u)&&(m.push(u),o(),this._manager&&this._manager.updateDependencies())}});let p=this._incoming[a.eventType];return p||(p=[],this._incoming[a.eventType]=p),p.push(c),o(),this._manager&&this._manager.updateDependencies(),c}registerOutgoing(e){if(this._outgoing[e])throw new Error("There is already a callback registered for this outgoing InputEvent: "+e);const i=new Pr(e,{onEmit:(n,s,a,o)=>{var l;(l=this._manager)==null||l.emit(n.eventType,s,a,o)},onRemove:n=>{var s;delete this._outgoing[n.eventType],(s=this._manager)==null||s.updateDependencies()}});return this._outgoing[e]=i,this._outgoingEventTypes=null,this._manager&&this._manager.updateDependencies(),i}startCapturingPointer(e){var i;(i=this._manager)==null||i.setPointerCapture(e,!0)}stopCapturingPointer(e){var i;(i=this._manager)==null||i.setPointerCapture(e,!1)}refreshHasPendingInputs(){var e;(e=this._manager)==null||e.refreshHasPendingInputs()}_onUninstall(){this._manager?(this.onUninstall(),this._manager=null):Un.error("This InputHandler is not registered with an InputManager")}_handleEvent(e){var n;const i=this._incoming[e.type];if(i){for(const s of i)if(s.match.matches(e)&&((n=s.callback)==null||n.call(s,e),e.shouldStopPropagation()))break}}},xr=class{constructor(e,i,n){this.match=e,this._callback=i,this._handler=n}pause(){this._handler.onPause(this)}resume(){this._handler.onResume(this)}remove(){this._handler.onRemove(this)}get callback(){return this._callback}},Pr=class{constructor(e,i){this.eventType=e,this._removed=!1,this._handler=i}emit(e,i,n){this._removed||this._handler.onEmit(this,e,i,n)}remove(){this._removed=!0,this._handler.onRemove(this)}},Cr=class extends V{constructor(e){super(!0),this._onChange=e,this._value="mouse",this._x=null,this._y=null,this.registerIncoming("pointer-move",i=>{this._update(i.data)})}_update(e){const i=e.native.pointerType==="touch"?"touch":"mouse",{x:n,y:s}=e;i===this._value&&this._x===n&&this._y===s||(this._value=i,this._x=n,this._y=s,this._onChange(i,n,s))}},Sr=class extends V{get multiTouchActive(){return this._multiTouchActive.value}constructor(){super(!0),this._activeTouchPointerIds=new Set,this._multiTouchActive=Ho(!1),this._onPointerAdd=({data:e})=>{e.pointerType==="touch"&&(this._activeTouchPointerIds.add(e.native.pointerId),this._update())},this._onPointerRemove=({data:e})=>{e.pointerType==="touch"&&(this._activeTouchPointerIds.delete(e.native.pointerId),this._update())},this.registerIncoming("pointer-down",this._onPointerAdd),this.registerIncoming("pointer-up",this._onPointerRemove),this.registerIncoming("pointer-capture-lost",this._onPointerRemove),this.registerIncoming("pointer-cancel",this._onPointerRemove)}_update(){this._multiTouchActive.value=this._activeTouchPointerIds.size>1}},J=class extends b{constructor(e){super(e),this._pointerCaptures=new Map,this._nameToGroup={},this._handlers=[],this._handlersPriority=[],this._currentPropagation=null,this._updateDependenciesAfterPropagation=!1,this._sourceEvents=new Set,this._keyModifiers=new Set,this._activeKeyModifiers=new Set,this._stoppedPropagationEventIds=new Set,this.primaryKey=br,this._latestPointerType="mouse",this._propertiesPool=new wr({latestPointerLocation:Ir},this),this.latestPointerLocation=null,this._paused=!1,this.test={timestamp:void 0,hasCurrentPropagation:()=>!!this._currentPropagation}}initialize(){this.eventSource.onEventReceived=this._onEventReceived.bind(this),this._installRecognizers()}destroy(){const e=Object.keys(this._nameToGroup);for(const i of e)this.uninstallHandlers(i);this.eventSource.destroy(),this._currentPropagation=null,this._propertiesPool.destroy()}get hasPendingInputs(){return this._handlers.some(e=>e.handler.hasPendingInputs)}get latestPointerType(){return this._latestPointerType}get multiTouchActive(){return this._multiTouchHandler.multiTouchActive}get updating(){return this.hasPendingInputs||this._paused}installHandlers(e,i,n=Ae.INTERNAL){if(this._nameToGroup[e])return void T.getLogger(this).error("There is already an InputHandler group registered under the name `"+e+"`");if(i.length===0)return void T.getLogger(this).error("Can't register a group of zero handlers");const s={name:e,handlers:i.map(a=>({handler:a,active:!0,removed:!1,priorityIndex:0,groupPriority:n,eventCallback:null,uninstallCallback:null}))};this._nameToGroup[e]=s;for(let a=s.handlers.length-1;a>=0;a--){const o=s.handlers[a];this._handlers.push(o),o.handler.onInstall({updateDependencies:()=>{this.updateDependencies()},emit:(l,c,p,u,m)=>{this._emitInputEvent(o.priorityIndex+1,l,c,p,m,u)},setPointerCapture:(l,c)=>{this._setPointerCapture(s,o,l,c)},setEventCallback:l=>{o.eventCallback=l},setUninstallCallback:l=>{o.uninstallCallback=l},refreshHasPendingInputs:()=>{this.notifyChange("hasPendingInputs")}})}this.updateDependencies()}uninstallHandlers(e){const i=this._nameToGroup[e];i?(i.handlers.forEach(n=>{var s;n.removed=!0,(s=n.uninstallCallback)==null||s.call(n)}),delete this._nameToGroup[e],this._currentPropagation?this._currentPropagation.needsHandlerGarbageCollect=!0:this._garbageCollectRemovedHandlers()):T.getLogger(this).error("There is no InputHandler group registered under the name `"+e+"`")}hasHandlers(e){return this._nameToGroup[e]!==void 0}updateDependencies(){if(this._currentPropagation)return void(this._updateDependenciesAfterPropagation=!0);this._updateDependenciesAfterPropagation=!1;const e=new Set,i=new Set;this._handlersPriority=[];for(let n=this._handlers.length-1;n>=0;n--){const s=this._handlers[n];s.priorityIndex=n,this._handlersPriority.push(s)}this._handlersPriority=this._sortHandlersPriority(this._handlersPriority);for(let n=this._handlersPriority.length-1;n>=0;n--){const s=this._handlersPriority[n];s.priorityIndex=n;let a=s.handler.hasSideEffects;if(!a){for(const o of s.handler.outgoingEventTypes)if(e.has(o)){a=!0;break}}if(a)for(const o of s.handler.incomingEventMatches){e.add(o.eventType);for(const l of o.keyModifiers)kr(l)||i.add(l)}s.active=a}this._sourceEvents=e,this._keyModifiers=i,this._pointerCaptures.size>0&&this._sourceEvents.add("pointer-capture-lost"),this._keyModifiers.size>0&&(this._sourceEvents.add("key-down"),this._sourceEvents.add("key-up")),this.eventSource&&(this.eventSource.activeEvents=this._sourceEvents)}_setLatestPointer(e,i,n){this._latestPointerType=e;const s=this._get("latestPointerLocation");if(s==null||s.x!==i||s.y!==n){const a=this._propertiesPool.get("latestPointerLocation");a.x=i,a.y=n,this._set("latestPointerLocation",a)}}_onEventReceived(e,i){if(e==="pointer-capture-lost"){const a=i;this._pointerCaptures.delete(a.native.pointerId)}this._updateKeyModifiers(e,i);const n=this.test.timestamp!=null?this.test.timestamp:i.native?i.native.timestamp:void 0,s=i.native?i.native.cancelable:void 0;this._emitInputEventFromSource(e,i,n,s)}_updateKeyModifiers(e,i){if(!i)return;let n=!1;const s=()=>{if(!n){const l=new Set;this._activeKeyModifiers.forEach(c=>{l.add(c)}),this._activeKeyModifiers=l,n=!0}},a=(l,c)=>{c&&!this._activeKeyModifiers.has(l)?(s(),this._activeKeyModifiers.add(l)):!c&&this._activeKeyModifiers.has(l)&&(s(),this._activeKeyModifiers.delete(l))};if(e==="key-down"||e==="key-up"){const l=i.key;this._keyModifiers.has(l)&&a(l,e==="key-down")}const o=i.native;a("Alt",!(!o||!o.altKey)),a("Ctrl",!(!o||!o.ctrlKey)),a("Shift",!(!o||!o.shiftKey)),a("Meta",!(!o||!o.metaKey)),a("Primary",this._activeKeyModifiers.has(this.primaryKey))}_installRecognizers(){this._latestPointerHandler=new Cr((e,i,n)=>this._setLatestPointer(e,i,n)),this._multiTouchHandler=new Sr,this.installHandlers("input-manager-logic",[this._latestPointerHandler,this._multiTouchHandler],Ae.ALWAYS),this.recognizers.length>0&&this.installHandlers("default",this.recognizers,Ae.INTERNAL)}_setPointerCapture(e,i,n,s){const a=e.name+"-"+i.priorityIndex,o=this._pointerCaptures.get(n.pointerId)||new Set;this._pointerCaptures.set(n.pointerId,o),s?(o.add(a),o.size===1&&this.eventSource&&this.eventSource.setPointerCapture(n,!0)):o.has(a)&&(o.delete(a),o.size===0&&(this._pointerCaptures.delete(n.pointerId),this.eventSource&&this.eventSource.setPointerCapture(n,!1)))}_garbageCollectRemovedHandlers(){this._handlers=this._handlers.filter(e=>!e.removed),this.updateDependencies()}_emitInputEventFromSource(e,i,n,s){this._emitInputEvent(0,e,i,n,s)}_emitInputEvent(e,i,n,s,a,o){const l=s!==void 0?s:this._currentPropagation?this._currentPropagation.timestamp:performance.now(),c=a!==void 0&&a,p={event:new $r(i,n,l,o||this._activeKeyModifiers,c),priorityIndex:e};this._currentPropagation?this._currentPropagation.events.push(p):this._doNewPropagation(p)}_doNewPropagation(e){this._currentPropagation={events:new $n,currentHandler:null,needsHandlerGarbageCollect:!1,timestamp:e.event.timestamp},this._currentPropagation.events.push(e),this._continuePropagation()}_continuePropagation(){var i,n,s;this._paused=!1;const e=this._currentPropagation;if(e){for(;e.events.length>0;){const{event:a,priorityIndex:o}=e.events.pop(),l=(i=a.data)==null?void 0:i.eventId;if(!(l!=null&&this._stoppedPropagationEventIds.has(l)))for(e.currentHandler=this._handlersPriority[o];e.currentHandler;){if(e.currentHandler.removed)e.needsHandlerGarbageCollect=!0;else{if(e.currentHandler.active&&!a.shouldStopPropagation()&&((s=(n=e.currentHandler).eventCallback)==null||s.call(n,a)),a.shouldStopPropagation()){l!=null&&this._stoppedPropagationEventIds.add(l);break}if(a.shouldPausePropagation(()=>this._continuePropagation()))return void this._pausePropagation({event:a,priorityIndex:e.currentHandler.priorityIndex+1})}e.currentHandler=this._handlersPriority[e.currentHandler.priorityIndex+1]}}e.needsHandlerGarbageCollect&&this._garbageCollectRemovedHandlers(),this.hasPendingInputs||this._stoppedPropagationEventIds.clear(),this._currentPropagation=null,this._updateDependenciesAfterPropagation&&this.updateDependencies()}}_pausePropagation(e){const i=new $n;i.push(e);const n=this._currentPropagation;if(n){for(;n.events.length;)i.push(n.events.pop());n.events=i,n.currentHandler=null,this._paused=!0}}_compareHandlerPriority(e,i){if(e.handler.hasSideEffects!==i.handler.hasSideEffects)return e.handler.hasSideEffects?1:-1;if(e.groupPriority!==i.groupPriority)return e.groupPriority>i.groupPriority?-1:1;for(const n of e.handler.incomingEventMatches)for(const s of i.handler.incomingEventMatches){if(n.eventType!==s.eventType)continue;const a=n.keyModifiers.filter(o=>s.keyModifiers.includes(o));if(a.length===n.keyModifiers.length!=(a.length===s.keyModifiers.length))return n.keyModifiers.length>s.keyModifiers.length?-1:1}return e.priorityIndex>i.priorityIndex?-1:1}_sortHandlersPriority(e){const i=[];for(const n of e){let s=0;for(;s<i.length&&this._compareHandlerPriority(n,i[s])>=0;)s++;i.splice(s,0,n)}return i}get debug(){const e=i=>{const n=this._setPointerCapture;this._setPointerCapture=()=>{},i(),this._setPointerCapture=n};return{injectEvent:(i,n)=>{e(()=>{this._onEventReceived(i,n)})},disablePointerCapture:e}}};r([h({readOnly:!0})],J.prototype,"hasPendingInputs",null),r([h({constructOnly:!0})],J.prototype,"eventSource",void 0),r([h({constructOnly:!0})],J.prototype,"recognizers",void 0),r([h()],J.prototype,"_latestPointerType",void 0),r([h()],J.prototype,"latestPointerType",null),r([h()],J.prototype,"multiTouchActive",null),r([h({readOnly:!0})],J.prototype,"latestPointerLocation",void 0),r([h()],J.prototype,"_paused",void 0),r([h({readOnly:!0})],J.prototype,"updating",null),J=r([_("esri.views.input.InputManager")],J);let $r=class{constructor(e,i,n,s,a){this.type=e,this.data=i,this.timestamp=n,this.modifiers=s,this.cancelable=a,this._propagationState=Oe.NONE,this._resumeCallback=null}stopPropagation(){this._propagationState|=Oe.STOPPED}shouldStopPropagation(){return(this._propagationState&Oe.STOPPED)!=0}async(e){this._propagationState|=Oe.PAUSED;const i=(n,s)=>{this._propagationState&=~Oe.PAUSED;const a=this._resumeCallback;if(this._resumeCallback=null,a&&a(),s)throw n;return n};return(typeof e=="function"?e():e).then(n=>i(n,!1),n=>i(n,!0))}shouldPausePropagation(e){return!!(this._propagationState&Oe.PAUSED)&&(this._resumeCallback=e,!0)}preventDefault(){this.data.native.preventDefault()}};var Oe;(function(t){t[t.NONE=0]="NONE",t[t.STOPPED=1]="STOPPED",t[t.PAUSED=2]="PAUSED"})(Oe||(Oe={}));const Ae={ALWAYS:1,DEFAULT:0,TOOL:-1,WIDGET:-2,INTERNAL:-3};let Er=class{};const Ir=Er;function ae(t){return t!=null&&"open"in t&&"declaredClass"in t}function jn(t){return t!=null&&"declaredClass"in t&&"dockOptions"in t}const Dr=t=>{let e=class extends t{constructor(){super(...arguments),this._popupSetupTask=null,this.popup={},this.popupEnabled=!0}initialize(){this.addHandles([f(()=>[this.ui,this.popup],([i,n],s)=>{const a="popup",o="manual";if(s){const[l,c]=s;l&&ae(c)&&(c.view=null,jn(c)&&l.remove(c,a))}i&&ae(n)&&(n.view=this,jn(n)&&i.add(n,{key:a,position:o,internal:!0}))},B),this.on("click",i=>{this.popup&&this.popupEnabled&&(i.pointerType!=="mouse"||i.button===0)&&(!ae(this.popup)&&"autoOpenEnabled"in this.popup&&this.popup.autoOpenEnabled===!1||(ae(this.popup)?this.popup.viewModel.handleViewClick(i):i.async(async()=>{await this.setupPopup(),ae(this.popup)&&!this.destroyed&&this.ready&&this.popupEnabled&&this.popup.viewModel.handleViewClick(i)})))},Ae.WIDGET)]),ei(()=>this.ready&&this.popupEnabled&&!this.updating).then(()=>{w(()=>import("./Popup-1a399eb1.js"),["./Popup-1a399eb1.js","./uuid-fb53ae2e.js","./index-e42a63f9.js","./throttle-7bf02de9.js","./jsxFactory-8f2e778f.js","./ByteSizeUnit-d4757d40.js","./Cyclical-8c26e7c7.js","./AttachmentInfo-32a4354e.js","./AttachmentQuery-293581a3.js","./layerUtils-a8920453.js","./utils-69d10af2.js","./basemapUtils-0a6b5a56.js","./Basemap-fc4d26ee.js","./loadAll-76369e9a.js","./PortalItem-01395053.js","./writeUtils-3673b1a7.js","./mat4f32-60a2394b.js","./mat4-f091cc2b.js","./GoTo-2cdac7e7.js","./widget-99046a3f.js","./ColorStop-4bfca0a7.js","./utils-c005c353.js","./parser-450a99c3.js","./utils-d023eda3.js","./LRUCache-9b8f5520.js","./jsonUtils-ca31df3a.js","./UniqueValueRenderer-eeb3ca28.js","./LegendOptions-21ba0c6d.js","./diffUtils-7a67a389.js","./SizeVariable-d8011d21.js","./colorRamps-18dfa72a.js","./compilerUtils-811a6f43.js","./lengthUtils-5d9bdf3f.js","./jsonUtils-6741d81c.js","./styleUtils-957365ee.js","./DictionaryLoader-153eea1f.js","./FieldsIndex-406a2400.js","./heatmapUtils-c2569515.js","./vec4f64-3c9d0901.js","./Query-56eb5454.js","./arcgisLayerUrl-fc2d909c.js","./Field-2e745f35.js","./fieldType-5ce7d1ed.js","./FullTextSearch-92b839ce.js","./QuantizationParameters-a323cbe3.js","./executeQueryJSON-426095f0.js","./query-75d7ff71.js","./normalizeUtils-a2b8b8b6.js","./normalizeUtilsCommon-05ad6f6d.js","./pbfQueryUtils-6e2dfdcf.js","./pbf-0c5d1fff.js","./OptimizedFeature-ded94d90.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-45e23751.js","./FeatureSet-46acd907.js","./featureConversionUtils-5ad02385.js","./RelationshipQuery-c73acba6.js","./TopFeaturesQuery-2a03aa6d.js","./FeatureLayer-82c27456.js","./MultiOriginJSONSupport-0ac2102c.js","./commonProperties-dc1396d3.js","./ElevationInfo-c9711b5d.js","./FeatureLayerBase-031726c8.js","./featureLayerUtils-e818abf0.js","./LayerFloorInfo-5a946a6e.js","./serviceCapabilitiesUtils-4afaedbc.js","./workers-3c8ba252.js","./APIKeyMixin-e0a32935.js","./ArcGISService-73c5a696.js","./BlendLayer-840b2c27.js","./jsonUtils-2946bd15.js","./CustomParametersMixin-b959de81.js","./EditBusLayer-bfd28f9d.js","./FeatureEffectLayer-3b8f0448.js","./FeatureEffect-3edf5c32.js","./FeatureReductionLayer-d08e423b.js","./clusterUtils-80867c68.js","./MD5-715f37cd.js","./FeatureReductionSelection-29ad62c4.js","./LabelClass-03af2031.js","./labelUtils-f4e57b25.js","./defaultsJSON-b087dd4d.js","./OperationalLayer-37855d78.js","./OrderedLayer-4f625116.js","./PortalLayer-5667eeff.js","./portalItemUtils-064daa72.js","./RefreshableLayer-a50327d1.js","./ScaleRangeLayer-f6774238.js","./TemporalLayer-938bf204.js","./FeatureTemplate-a4a4ff4d.js","./FeatureType-233007f9.js","./fieldProperties-a1eafbe1.js","./labelingInfo-144cafce.js","./versionUtils-3d1d9820.js","./styleUtils-acaf630f.js","./popupUtils-7cecbe49.js","./interfaces-f1f22245.js","./colorUtils-fd566245.js","./mat2df32-b9bfc1f5.js","./vec2-aed931ac.js","./TileStore-6570f2cc.js","./signal-a61cc993.js","./quickselect-149a6b43.js","./commonjsHelpers-2f3e7994.js","./TileInfoView-be4d795d.js","./vmEvent-7cce6b5f.js","./CollectionFlattener-5cd5b172.js","./infoFor3D-24efd44a.js","./TablesMixin-2871072c.js","./TileInfo-238dd4b6.js","./UpdatingHandles-9a53fef9.js","./GraphicsCollection-2966693c.js","./ViewingMode-fb6259a5.js","./unitBezier-881ac1eb.js","./vec2f64-95bf678d.js","./mat3-1b291d2f.js","./mat3f32-6c416b1c.js","./vec2f32-eaf29605.js","./capabilities-6261cefc.js"],import.meta.url)})}destroy(){this.destroyed||this.closePopup()}async openPopup(i){ae(this.popup)&&this.popup.open(i);try{if(await this.setupPopup(),!this.popup)return void T.getLogger(this).error(new P("view:null-popup","Popup is null and can't be opened"));this.popup.open(i)}catch{}}closePopup(){var i;(i=this._popupSetupTask)==null||i.abort(),ae(this.popup)&&this.popup.close()}async fetchPopupFeatures(i,n){await this.when();const{location:s,queryArea:a,layerViewsAndGraphics:o,clientOnlyGraphics:l}=await this._prepareFetchPopupFeatures(i,n),c=Promise.resolve(l),p=this._queryLayerPopupFeatures(a,o,n),u=p.map(m=>m.promise);return{location:s,clientOnlyGraphics:l,allGraphicsPromise:Za([c,...u]).then(m=>Array.from(new Set(m.flat()))),promisesPerLayerView:p}}async setupPopup(){var i;if((i=this._popupSetupTask)==null||i.abort(),this.popup&&!ae(this.popup))return this._popupSetupTask=Qi(async n=>{const{default:s}=await w(()=>import("./Popup-1a399eb1.js"),["./Popup-1a399eb1.js","./uuid-fb53ae2e.js","./index-e42a63f9.js","./throttle-7bf02de9.js","./jsxFactory-8f2e778f.js","./ByteSizeUnit-d4757d40.js","./Cyclical-8c26e7c7.js","./AttachmentInfo-32a4354e.js","./AttachmentQuery-293581a3.js","./layerUtils-a8920453.js","./utils-69d10af2.js","./basemapUtils-0a6b5a56.js","./Basemap-fc4d26ee.js","./loadAll-76369e9a.js","./PortalItem-01395053.js","./writeUtils-3673b1a7.js","./mat4f32-60a2394b.js","./mat4-f091cc2b.js","./GoTo-2cdac7e7.js","./widget-99046a3f.js","./ColorStop-4bfca0a7.js","./utils-c005c353.js","./parser-450a99c3.js","./utils-d023eda3.js","./LRUCache-9b8f5520.js","./jsonUtils-ca31df3a.js","./UniqueValueRenderer-eeb3ca28.js","./LegendOptions-21ba0c6d.js","./diffUtils-7a67a389.js","./SizeVariable-d8011d21.js","./colorRamps-18dfa72a.js","./compilerUtils-811a6f43.js","./lengthUtils-5d9bdf3f.js","./jsonUtils-6741d81c.js","./styleUtils-957365ee.js","./DictionaryLoader-153eea1f.js","./FieldsIndex-406a2400.js","./heatmapUtils-c2569515.js","./vec4f64-3c9d0901.js","./Query-56eb5454.js","./arcgisLayerUrl-fc2d909c.js","./Field-2e745f35.js","./fieldType-5ce7d1ed.js","./FullTextSearch-92b839ce.js","./QuantizationParameters-a323cbe3.js","./executeQueryJSON-426095f0.js","./query-75d7ff71.js","./normalizeUtils-a2b8b8b6.js","./normalizeUtilsCommon-05ad6f6d.js","./pbfQueryUtils-6e2dfdcf.js","./pbf-0c5d1fff.js","./OptimizedFeature-ded94d90.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-45e23751.js","./FeatureSet-46acd907.js","./featureConversionUtils-5ad02385.js","./RelationshipQuery-c73acba6.js","./TopFeaturesQuery-2a03aa6d.js","./FeatureLayer-82c27456.js","./MultiOriginJSONSupport-0ac2102c.js","./commonProperties-dc1396d3.js","./ElevationInfo-c9711b5d.js","./FeatureLayerBase-031726c8.js","./featureLayerUtils-e818abf0.js","./LayerFloorInfo-5a946a6e.js","./serviceCapabilitiesUtils-4afaedbc.js","./workers-3c8ba252.js","./APIKeyMixin-e0a32935.js","./ArcGISService-73c5a696.js","./BlendLayer-840b2c27.js","./jsonUtils-2946bd15.js","./CustomParametersMixin-b959de81.js","./EditBusLayer-bfd28f9d.js","./FeatureEffectLayer-3b8f0448.js","./FeatureEffect-3edf5c32.js","./FeatureReductionLayer-d08e423b.js","./clusterUtils-80867c68.js","./MD5-715f37cd.js","./FeatureReductionSelection-29ad62c4.js","./LabelClass-03af2031.js","./labelUtils-f4e57b25.js","./defaultsJSON-b087dd4d.js","./OperationalLayer-37855d78.js","./OrderedLayer-4f625116.js","./PortalLayer-5667eeff.js","./portalItemUtils-064daa72.js","./RefreshableLayer-a50327d1.js","./ScaleRangeLayer-f6774238.js","./TemporalLayer-938bf204.js","./FeatureTemplate-a4a4ff4d.js","./FeatureType-233007f9.js","./fieldProperties-a1eafbe1.js","./labelingInfo-144cafce.js","./versionUtils-3d1d9820.js","./styleUtils-acaf630f.js","./popupUtils-7cecbe49.js","./interfaces-f1f22245.js","./colorUtils-fd566245.js","./mat2df32-b9bfc1f5.js","./vec2-aed931ac.js","./TileStore-6570f2cc.js","./signal-a61cc993.js","./quickselect-149a6b43.js","./commonjsHelpers-2f3e7994.js","./TileInfoView-be4d795d.js","./vmEvent-7cce6b5f.js","./CollectionFlattener-5cd5b172.js","./infoFor3D-24efd44a.js","./TablesMixin-2871072c.js","./TileInfo-238dd4b6.js","./UpdatingHandles-9a53fef9.js","./GraphicsCollection-2966693c.js","./ViewingMode-fb6259a5.js","./unitBezier-881ac1eb.js","./vec2f64-95bf678d.js","./mat3-1b291d2f.js","./mat3f32-6c416b1c.js","./vec2f32-eaf29605.js","./capabilities-6261cefc.js"],import.meta.url);if(ue(n),!this.popup||ae(this.popup))return;const a=this.popup;delete a.open,delete a.close,this.popup=new s(a)}),this._popupSetupTask.promise}_queryLayerPopupFeatures(i,n,s){return n.map(({layerView:a,graphics:o})=>{const l={clientGraphics:o,event:s!=null?s.event:void 0,signal:s!=null?s.signal:void 0,defaultPopupTemplateEnabled:s!=null&&!!s.defaultPopupTemplateEnabled},c=a.fetchPopupFeatures(i,l);return{layerView:a,promise:c}})}_isValidPopupGraphic(i,n){return i&&!!i.getEffectivePopupTemplate(n!=null&&n.defaultPopupTemplateEnabled)}async _prepareFetchPopupFeatures(i,n){const{clientGraphics:s,queryArea:a,location:o}=await this._popupHitTestGraphics(i,n),l=this._getFetchPopupLayerViews(),{layerViewsAndGraphics:c,clientOnlyGraphics:p}=this._graphicsPerFetchPopupLayerView(s,l);return{clientOnlyGraphics:p,layerViewsAndGraphics:c,queryArea:a,location:o}}async _popupHitTestGraphics(i,n){const s=await this.popupHitTest(i),a=s.results,o=s.mapPoint,l=a.filter(p=>p.type==="graphic"&&this._isValidPopupGraphic(p.graphic,n)),c=l.length?l[0].mapPoint:null;return{clientGraphics:l.map(p=>p.graphic),queryArea:o,location:o||c}}_getFetchPopupLayerViews(){const i=[];return this.allLayerViews.forEach(n=>{this._isValidPopupLayerView(n)&&i.push(n)}),this.graphicsView!=null&&this._isValidPopupLayerView(this.graphicsView)&&i.push(this.graphicsView),i.reverse()}_isValidPopupLayerView(i){return i!=null&&(!("layer"in i)||!i.suspended)&&"fetchPopupFeatures"in i}_graphicsPerFetchPopupLayerView(i,n){const s=[],a=new Map,o=n.map(l=>{const c=[];return"layer"in l?a.set(l.layer,c):a.set(l.graphics,c),{layerView:l,graphics:c}});for(const l of i){const c=a.get(l.layer)||a.get(l.sourceLayer)||null;c?c.push(l):s.push(l)}return{layerViewsAndGraphics:o,clientOnlyGraphics:s}}};return r([h({cast(i){return!i||ae(i)||typeof i=="object"&&(i.open=n=>(kn(T.getLogger(this),"view.popup is no longer created by default. view.popup.open() will stop working when the popup isn't created",{replacement:"Use view.openPopup() instead.",version:"4.27"}),this.openPopup(n)),i.close=()=>(kn(T.getLogger(this),"view.popup is no longer created by default. view.popup.close() will stop working when the popup isn't created",{replacement:"Use view.closePopup() instead.",version:"4.27"}),this.closePopup())),i}})],e.prototype,"popup",void 0),r([h()],e.prototype,"popupEnabled",void 0),e=r([_("esri.views.PopupView")],e),e};let Jt=class extends Go{constructor(e){super(e),this.addHandles(this.on("before-add",i=>{i.item!=null&&i.item.parent===this.owner&&(T.getLogger(this).warn("Analysis inside the collection must be unique. Not adding this element again."),i.preventDefault())}))}_own(e){e.parent=this.owner}_release(e){e.parent=null}};Jt=r([_("esri.support.AnalysesCollection")],Jt);let Ee=class extends b{constructor(e){super(e),this.view=null,this.baseLayerViews=new O,this.referenceLayerViews=new O,this._loadingHandle=f(()=>{var i,n;return(n=(i=this.view)==null?void 0:i.map)==null?void 0:n.basemap},i=>{i&&i.load().catch(()=>{})},B)}destroy(){this._set("view",null),this._loadingHandle&&(this._loadingHandle.remove(),this._loadingHandle=null);for(const e of this.baseLayerViews)e.destroy();this.baseLayerViews.length=0;for(const e of this.referenceLayerViews)e.destroy();this.referenceLayerViews.length=0}get suspended(){return!this.view||this.view.suspended}get updating(){var i,n;if(this.view&&this.view.suspended)return!1;const e=(n=(i=this.view)==null?void 0:i.map)==null?void 0:n.basemap;return!!e&&!!e.loaded&&(this.baseLayerViews.some(s=>s.updating)||this.referenceLayerViews.some(s=>s.updating))}};r([h({constructOnly:!0})],Ee.prototype,"view",void 0),r([h({readOnly:!0})],Ee.prototype,"baseLayerViews",void 0),r([h({readOnly:!0})],Ee.prototype,"referenceLayerViews",void 0),r([h({readOnly:!0})],Ee.prototype,"suspended",null),r([h({type:Boolean,readOnly:!0})],Ee.prototype,"updating",null),Ee=r([_("esri.views.BasemapView")],Ee);function Rr(t){return"tryRecycleWith"in t}let Vr=class{constructor(e,i,n){this.layer=e,this.view=i,this.layerViewImporter=n,this._controller=new AbortController,this._deferred=en(),this._started=!1,this.done=!1,this.promise=this._deferred.promise,pi(this._controller.signal,()=>{const s=new P("cancelled:layerview-create","layerview creation cancelled",{layer:e});this._deferred.reject(s)})}tryRecycle(e){if(!this.done||!this.layerView||!Rr(this.layerView))return null;const i=this.layer.type,n=this._controller.signal;for(let s=0;s<e.length;s++){const a=e[s];if(a.type!==i)continue;const o=this.layerView.tryRecycleWith(a,{signal:n});if(o){e.splice(s,1),this.layer=a;const l=this.layerView,c=l.view;return this.promise=Promise.race([o.then(()=>(ue(this._controller.signal),a.emit("layerview-destroy",{view:c,layerView:l}),c.emit("layerview-destroy",{view:c,layerView:l}),a.emit("layerview-create",{view:c,layerView:l}),c.emit("layerview-create",{view:c,layerView:l}),l)),new Promise((p,u)=>pi(this._controller.signal,()=>u(ws())))]),this.promise}}return null}destroy(){this._controller.abort();const{layerView:e}=this;if(e){const{layer:i,view:n}=this;i.emit("layerview-destroy",{view:n,layerView:e}),n.emit("layerview-destroy",{layer:i,layerView:e})}this.done=!0,this.layer=null,this.layerView=null,this.view=null,this.layerViewImporter=null,this._map=null}async start(){var s,a;if(this._started)return;this._started=!0;const{_controller:{signal:e},layer:i,view:n}=this;this._map=n.map;try{let o,l;if(await i.load({signal:e}),i.prefetchResources&&await i.prefetchResources({signal:e}),Or(i))o=await i.createLayerView(n,{signal:e});else{if(!this.layerViewImporter.hasLayerViewModule(i))throw new P("layer:view-not-supported","No layerview implementation was found");const u=await this.layerViewImporter.importLayerView(i);ue(e),o="default"in u?new u.default({layer:i,view:n}):new u({layer:i,view:n})}const c=()=>{l=Me(l),o.destroyed||o.destroy(),o.layer=null,o.parent=null,o.view=null,this.done=!0};l=pi(e,c),ue(e);try{await o.when()}catch(u){throw c(),u}if(!((a=(s=this._map)==null?void 0:s.allLayers)==null?void 0:a.includes(i)))return c(),void this._deferred.reject(new P("view:no-layerview-for-layer","The layer has been removed from the map",{layer:i}));this.layerView=o,i.emit("layerview-create",{view:n,layerView:o}),n.emit("layerview-create",{layer:i,layerView:o}),this.done=!0,this._deferred.resolve(o)}catch(o){i.emit("layerview-create-error",{view:n,error:o}),n.emit("layerview-create-error",{layer:i,error:o}),this.done=!0,this._deferred.reject(new P("layerview:create-error","layerview creation failed",{layer:i,error:o}))}}},Q=class extends b{constructor(e){super(e),this._layerLayerViewInfoMap=new Map,this._recyclingInfoMap=new Map,this._watchUpdatingTracking=new ai,this.supportsGround=!0,this._preloadLayerViewModules=()=>{var n;const i=(n=this.view.map)==null?void 0:n.allLayers;if(i)for(const s of i)this.layerViewImporter.hasLayerViewModule(s)&&this.layerViewImporter.importLayerView(s)},this._reschedule=()=>this.destroyed?Promise.reject():(this._workPromise==null&&(this._workPromise=en(),this._workPromise.promise.catch(()=>{})),this.removeHandles("reschedule"),this.addHandles(Ba(this._doWork),"reschedule"),this._workPromise.promise),this._doWork=()=>{var c,p,u;if(this.destroyed)return;const i=this.view.map;if(this._map!==i&&(this.clear(),this._map=i),this._workPromise==null)return void this.notifyChange("updating");this.removeHandles("reschedule"),this.removeHandles("collection-change");const n=new Set,s=[],a=this.view.ready,o=m=>{if(m!=null){for(const d of m)if(d){n.add(d);const g=this._layerLayerViewInfoMap.get(d);g&&a?g.start():g||this._recyclingInfoMap.has(d)||s.push(d),"layers"in d&&d.layers&&o(d.layers)}}};for(const m of this._rootCollectionNames)o(ci(this,m));for(const[m,d]of this._layerLayerViewInfoMap)if(!n.has(m)){this._layerLayerViewInfoMap.delete(d.layer);const g=d.tryRecycle(s);g?(this.notifyChange("updating"),this._recyclingInfoMap.set(d.layer,d),g.then(()=>{this.notifyChange("updating"),this._recyclingInfoMap.delete(d.layer),this._layerLayerViewInfoMap.set(d.layer,d),this._reschedule()}).catch(()=>{this.notifyChange("updating"),this._recyclingInfoMap.delete(d.layer),d.destroy(),this._reschedule()})):d.destroy()}for(const[m,d]of this._recyclingInfoMap)n.has(m)||(this.notifyChange("updating"),this._recyclingInfoMap.delete(d.layer),d.destroy());for(const m of s)this._createLayerView(m);this._refreshCollections();const l=[(c=i==null?void 0:i.ground)==null?void 0:c.layers,(p=i==null?void 0:i.basemap)==null?void 0:p.baseLayers,(u=i==null?void 0:i.basemap)==null?void 0:u.referenceLayers,i==null?void 0:i.layers].filter(m=>!!m);n.forEach(m=>"layers"in m&&l.push(m.layers)),this.addHandles(l.map(m=>this._watchUpdatingTracking.addOnCollectionChange(()=>m,this._reschedule)),"collection-change"),this._workPromise.resolve(),this._workPromise=null}}initialize(){this.addHandles([tn(()=>{var e,i;return(i=(e=this.view)==null?void 0:e.map)==null?void 0:i.allLayers},"change",this._preloadLayerViewModules,{onListenerAdd:this._preloadLayerViewModules}),f(()=>{const e=this.view,i=e==null?void 0:e.map;return[i==null?void 0:i.basemap,i==null?void 0:i.ground,i==null?void 0:i.layers,e==null?void 0:e.ready]},()=>this._reschedule(),Ge)]),this._preloadLayerViewModules(),this._reschedule()}destroy(){this.clear(),ui(this._recyclingInfoMap),ui(this._layerLayerViewInfoMap),this._watchUpdatingTracking.destroy(),this._map=null,this._workPromise!=null&&(this._workPromise.reject(ws()),this._workPromise=null)}get _layersToLayerViews(){const e=[["view.map.basemap.baseLayers","view.basemapView.baseLayerViews"],["view.map.layers","view.layerViews"],["view.map.basemap.referenceLayers","view.basemapView.referenceLayerViews"]];return this.supportsGround&&e.push(["view.map.ground.layers","view.groundView.layerViews"]),new Map(e)}get _rootCollectionNames(){return Array.from(this._layersToLayerViews.keys())}get updating(){return this._workPromise!=null||this._watchUpdatingTracking.updating||ti(this._layerLayerViewInfoMap,e=>!e.done)||this._recyclingInfoMap.size>0}get updatingRemaining(){let e=0;for(const i of this._layerLayerViewInfoMap.values())i.done||++e;return e}clear(){this.destroyed||(ui(this._layerLayerViewInfoMap),this._refreshCollections())}async whenLayerView(e){if(await this._reschedule(),!this._layerLayerViewInfoMap.has(e)){if(this._recyclingInfoMap.has(e))return this._recyclingInfoMap.get(e).promise;throw new P("view:no-layerview-for-layer","No layerview has been found for the layer",{layer:e})}return this._layerLayerViewInfoMap.get(e).promise}_refreshCollections(){for(const[e,i]of this._layersToLayerViews)this._populateLayerViewsOwners(ci(this,e),ci(this,i),this.view);this.notifyChange("updating"),this.notifyChange("updatingRemaining")}_populateLayerViewsOwners(e,i,n){if(!e||!i)return void(i&&i.removeAll());let s=0;for(const a of e){const o=this._layerLayerViewInfoMap.get(a);if(!(o!=null&&o.layerView))continue;const l=o.layerView;l.layer=a,l.parent=n,i.at(s)!==l&&i.splice(s,0,l),a.layers&&this._populateLayerViewsOwners(a.layers,l.layerViews,l),s+=1}s<i.length&&i.splice(s,i.length)}_createLayerView(e){e.load().catch(()=>{}),this.layerViewImporter.hasLayerViewModule(e)&&this.layerViewImporter.importLayerView(e);const i=new Vr(e,this.view,this.layerViewImporter);i.promise.then(()=>this._refreshCollections(),n=>{n&&(Tt(n)||n.name==="cancelled:layerview-create")||T.getLogger(this).error(`Failed to create layerview for layer title:'${e.title??"no title"}', id:'${e.id??"no id"}' of type '${e.type}'.`,{layer:e,error:n}),this._refreshCollections()}),this._layerLayerViewInfoMap.set(e,i),this.view.ready&&i.start(),this.notifyChange("updating"),this.notifyChange("updatingRemaining")}};r([h()],Q.prototype,"_workPromise",void 0),r([h({readOnly:!0})],Q.prototype,"_watchUpdatingTracking",void 0),r([h({readOnly:!0})],Q.prototype,"_layersToLayerViews",null),r([h({readOnly:!0})],Q.prototype,"_rootCollectionNames",null),r([h()],Q.prototype,"layerViewImporter",void 0),r([h()],Q.prototype,"supportsGround",void 0),r([h({readOnly:!0})],Q.prototype,"updating",null),r([h({readOnly:!0})],Q.prototype,"updatingRemaining",null),r([h({constructOnly:!0})],Q.prototype,"view",void 0),Q=r([_("esri.views.LayerViewManager")],Q);const Lr=Q;function Or(t){return"createLayerView"in t&&t.createLayerView!=null}let Y=class extends b{constructor(e){super(e),this.factor=1.5,this.offset=Z(0,0),this.position=null,this.size=120,this.maskUrl=null,this.maskEnabled=!0,this.overlayUrl=null,this.overlayEnabled=!0,this.visible=!0}get version(){return this.commitProperty("factor"),this.commitProperty("offset"),this.commitProperty("position"),this.commitProperty("visible"),this.commitProperty("size"),this.commitProperty("maskUrl"),this.commitProperty("maskEnabled"),this.commitProperty("overlayUrl"),this.commitProperty("overlayEnabled"),(this._get("version")||0)+1}};r([h({type:Number})],Y.prototype,"factor",void 0),r([h({nonNullable:!0})],Y.prototype,"offset",void 0),r([h()],Y.prototype,"position",void 0),r([h({type:Number,range:{min:0}})],Y.prototype,"size",void 0),r([h()],Y.prototype,"maskUrl",void 0),r([h()],Y.prototype,"maskEnabled",void 0),r([h()],Y.prototype,"overlayUrl",void 0),r([h()],Y.prototype,"overlayEnabled",void 0),r([h({readOnly:!0})],Y.prototype,"version",null),r([h({type:Boolean})],Y.prototype,"visible",void 0),Y=r([_("esri.views.Magnifier")],Y);const Ls=Y;let yt=class extends vs(b){constructor(e){super(e),this.accentColor=new ge([255,127,0]),this.textColor=new ge([255,255,255])}};r([h({type:ge,nonNullable:!0})],yt.prototype,"accentColor",void 0),r([h({type:ge,nonNullable:!0})],yt.prototype,"textColor",void 0),yt=r([_("esri.views.Theme")],yt);const Ni=yt;var qn;(function(t){t[t.Left=0]="Left",t[t.Middle=1]="Middle",t[t.Right=2]="Right"})(qn||(qn={}));const Os=["click","double-click","immediate-click","immediate-double-click","hold","drag","key-down","key-up","pointer-down","pointer-move","pointer-up","pointer-drag","mouse-wheel","pointer-enter","pointer-leave","gamepad","focus","blur"],As={};function zs(t){return!!As[t]}function Ar(t){for(const e of t)if(!zs(e))return!1;return!0}Os.forEach(t=>{As[t]=!0});let zr=class{constructor(e){this._handlers=new Map,this._counter=0,this._handlerCounts=new Map,this.view=e,this.inputManager=null}connect(e){e&&this.disconnect(),this.inputManager=e,this._handlers.forEach(({handler:i,priority:n},s)=>{var a;return(a=this.inputManager)==null?void 0:a.installHandlers(s,[i],n)})}disconnect(){this.inputManager&&this._handlers.forEach((e,i)=>{var n;return(n=this.inputManager)==null?void 0:n.uninstallHandlers(i)}),this.inputManager=null}destroy(){this.disconnect(),this._handlers.clear(),this.view=null}on(e,i,n,s){const a=Array.isArray(e)?e:e.split(",");if(!Ar(a))return a.some(zs)&&console.error("Error: registering input events and other events on the view at the same time is not supported."),null;let o,l;Array.isArray(i)?l=i:(o=i,l=[]),typeof n=="function"?o=n:s=n,s=s??Ae.DEFAULT;const c=this._createUniqueGroupName(),p=new Nr(this.view,a,l,o);this._handlers.set(c,{handler:p,priority:s});for(const u of a){const m=this._handlerCounts.get(u)||0;this._handlerCounts.set(u,m+1)}return this.inputManager&&this.inputManager.installHandlers(c,[p],s),bs(()=>this._removeHandler(c,a))}hasHandler(e){return!!this._handlerCounts.get(e)}_removeHandler(e,i){if(this._handlers.has(e)){this._handlers.delete(e);for(const n of i){const s=this._handlerCounts.get(n);s===void 0?console.error("Trying to remove handler for event that has no handlers registered: ",n):s===1?this._handlerCounts.delete(n):this._handlerCounts.set(n,s-1)}}this.inputManager&&this.inputManager.uninstallHandlers(e)}_createUniqueGroupName(){return this._counter+=1,`viewEvents_${this._counter}`}},Nr=class extends V{constructor(e,i,n,s){super(!0),this._latestDragStart=void 0,this.view=e;for(const a of i)switch(a){case"click":this.registerIncoming("click",n,o=>s(this._wrapClick(o)));break;case"double-click":this.registerIncoming("double-click",n,o=>s(this._wrapDoubleClick(o)));break;case"immediate-click":this.registerIncoming("immediate-click",n,o=>s(this._wrapImmediateClick(o)));break;case"immediate-double-click":this.registerIncoming("immediate-double-click",n,o=>s(this._wrapImmediateDoubleClick(o)));break;case"hold":this.registerIncoming("hold",n,o=>s(this._wrapHold(o)));break;case"drag":this.registerIncoming("drag",n,o=>{const l=this._wrapDrag(o);l&&s(l)});break;case"key-down":this.registerIncoming("key-down",n,o=>s(this._wrapKeyDown(o)));break;case"key-up":this.registerIncoming("key-up",n,o=>s(this._wrapKeyUp(o)));break;case"pointer-down":this.registerIncoming("pointer-down",n,o=>s(this._wrapPointer(o,"pointer-down")));break;case"pointer-move":this.registerIncoming("pointer-move",n,o=>s(this._wrapPointer(o,"pointer-move")));break;case"pointer-up":this.registerIncoming("pointer-up",n,o=>s(this._wrapPointer(o,"pointer-up")));break;case"pointer-drag":this.registerIncoming("pointer-drag",n,o=>s(this._wrapPointerDrag(o)));break;case"mouse-wheel":this.registerIncoming("mouse-wheel",n,o=>s(this._wrapMouseWheel(o)));break;case"pointer-enter":this.registerIncoming("pointer-enter",n,o=>s(this._wrapPointer(o,"pointer-enter")));break;case"pointer-leave":this.registerIncoming("pointer-leave",n,o=>s(this._wrapPointer(o,"pointer-leave")));break;case"gamepad":this.registerIncoming("gamepad",n,o=>{s(this._wrapGamepad(o))});break;case"focus":this.registerIncoming("focus",n,o=>{s(this._wrapFocus(o))});break;case"blur":this.registerIncoming("blur",n,o=>{s(this._wrapBlur(o))})}}_wrapFocus(e){return{type:"focus",timestamp:e.timestamp,native:e.data.native,cancelable:e.cancelable,stopPropagation:()=>e.stopPropagation(),async:i=>e.async(i),preventDefault:()=>e.preventDefault()}}_wrapBlur(e){return{type:"blur",timestamp:e.timestamp,native:e.data.native,cancelable:e.cancelable,stopPropagation:()=>e.stopPropagation(),async:i=>e.async(i),preventDefault:()=>e.preventDefault()}}_wrapClick(e){const{pointerType:i,button:n,buttons:s,x:a,y:o,native:l,eventId:c}=e.data,{cancelable:p,timestamp:u}=e;return{type:"click",pointerType:i,button:n,buttons:s,x:a,y:o,native:l,timestamp:u,screenPoint:Z(a,o),mapPoint:this._getMapPoint(a,o),eventId:c,cancelable:p,stopPropagation:()=>e.stopPropagation(),async:m=>e.async(m),preventDefault:()=>e.preventDefault()}}_wrapDoubleClick(e){const{pointerType:i,button:n,buttons:s,x:a,y:o,native:l,eventId:c}=e.data,{cancelable:p,timestamp:u}=e;return{type:"double-click",pointerType:i,button:n,buttons:s,x:a,y:o,native:l,timestamp:u,mapPoint:this._getMapPoint(a,o),eventId:c,cancelable:p,stopPropagation:()=>e.stopPropagation(),async:m=>e.async(m),preventDefault:()=>e.preventDefault()}}_wrapImmediateClick(e){const{pointerType:i,button:n,buttons:s,x:a,y:o,native:l,eventId:c}=e.data,p=l.pointerId,{cancelable:u,timestamp:m}=e;return{type:"immediate-click",pointerId:p,pointerType:i,button:n,buttons:s,x:a,y:o,native:l,timestamp:m,mapPoint:this._getMapPoint(a,o),eventId:c,cancelable:u,stopPropagation:()=>e.stopPropagation(),async:d=>e.async(d),preventDefault:()=>e.preventDefault()}}_wrapImmediateDoubleClick(e){const{pointerType:i,button:n,buttons:s,x:a,y:o,native:l,eventId:c}=e.data,p=l.pointerId,{cancelable:u,timestamp:m}=e;return{type:"immediate-double-click",pointerId:p,pointerType:i,button:n,buttons:s,x:a,y:o,native:l,timestamp:m,mapPoint:this._getMapPoint(a,o),eventId:c,cancelable:u,stopPropagation:()=>e.stopPropagation(),async:d=>e.async(d),preventDefault:()=>e.preventDefault()}}_wrapHold(e){const{pointerType:i,button:n,buttons:s,x:a,y:o,native:l}=e.data,{cancelable:c,timestamp:p}=e;return{type:"hold",pointerType:i,button:n,buttons:s,x:a,y:o,native:l,timestamp:p,mapPoint:this._getMapPoint(a,o),cancelable:c,stopPropagation:()=>e.stopPropagation(),async:u=>e.async(u),preventDefault:()=>e.preventDefault()}}_getMapPoint(e,i){return this.view.toMap(Z(e,i),{exclude:[]})}_wrapDrag(e){const i=e.data,{x:n,y:s}=i.center,{action:a,pointerType:o,button:l}=i;if(a==="start"&&(this._latestDragStart=i),!this._latestDragStart)return;const c=i.pointer.native,p=i.buttons,{cancelable:u,timestamp:m}=e,d={x:this._latestDragStart.center.x,y:this._latestDragStart.center.y};return a==="end"&&(this._latestDragStart=void 0),{type:"drag",action:a,x:n,y:s,origin:d,pointerType:o,button:l,buttons:p,radius:i.radius,angle:Wa(i.angle),native:c,timestamp:m,cancelable:u,stopPropagation:()=>e.stopPropagation(),async:g=>e.async(g),preventDefault:()=>e.preventDefault()}}_wrapKeyDown(e){const{key:i,repeat:n,native:s}=e.data,{cancelable:a,timestamp:o}=e;return{type:"key-down",key:i,repeat:n,native:s,timestamp:o,cancelable:a,stopPropagation:()=>e.stopPropagation(),async:l=>e.async(l),preventDefault:()=>e.preventDefault()}}_wrapKeyUp(e){const{key:i,native:n}=e.data,{cancelable:s,timestamp:a}=e;return{type:"key-up",key:i,native:n,timestamp:a,cancelable:s,stopPropagation:()=>e.stopPropagation(),async:o=>e.async(o),preventDefault:()=>e.preventDefault()}}_wrapPointer(e,i){const{x:n,y:s,button:a,buttons:o,native:l,eventId:c}=e.data,p=l.pointerId,u=l.pointerType,{cancelable:m,timestamp:d}=e;return{type:i,x:n,y:s,pointerId:p,pointerType:u,button:a,buttons:o,native:l,timestamp:d,eventId:c,cancelable:m,stopPropagation:()=>e.stopPropagation(),async:g=>e.async(g),preventDefault:()=>e.preventDefault()}}_wrapPointerDrag(e){const{x:i,y:n,buttons:s,native:a,eventId:o}=e.data.currentEvent,{button:l}=e.data.startEvent,c=e.data.startEvent.native.pointerId,p=e.data.startEvent.native.pointerType,u=e.data.action,m={x:e.data.startEvent.x,y:e.data.startEvent.y},{cancelable:d,timestamp:g}=e;return{type:"pointer-drag",x:i,y:n,pointerId:c,pointerType:p,button:l,buttons:s,action:u,origin:m,native:a,timestamp:g,eventId:o,cancelable:d,stopPropagation:()=>e.stopPropagation(),async:S=>e.async(S),preventDefault:()=>e.preventDefault()}}_wrapMouseWheel(e){const{cancelable:i,data:n,timestamp:s}=e,{x:a,y:o,deltaY:l,native:c}=n;return{type:"mouse-wheel",x:a,y:o,deltaY:l,native:c,timestamp:s,cancelable:i,stopPropagation:()=>e.stopPropagation(),async:p=>e.async(p),preventDefault:()=>e.preventDefault()}}_wrapGamepad(e){const{action:i,state:n,device:s}=e.data,{cancelable:a,timestamp:o}=e,{buttons:l,axes:c}=n;return{type:"gamepad",device:s,timestamp:o,action:i,buttons:l,axes:c,cancelable:a,stopPropagation:()=>e.stopPropagation(),async:p=>e.async(p),preventDefault:()=>e.preventDefault()}}};var Mt,Zn,Bn;(function(t){t[t.USER=0]="USER",t[t.MANAGER=1]="MANAGER"})(Mt||(Mt={})),function(t){t[t.None=0]="None",t[t.Unfocused=1]="Unfocused",t[t.Focused=2]="Focused",t[t.Unselected=4]="Unselected",t[t.Selected=8]="Selected",t[t.All=15]="All"}(Zn||(Zn={})),function(t){t[t.None=0]="None",t[t.Custom1=16]="Custom1",t[t.Custom2=32]="Custom2",t[t.Custom3=64]="Custom3",t[t.Custom4=128]="Custom4",t[t.Custom5=256]="Custom5",t[t.Custom6=512]="Custom6",t[t.Custom7=1024]="Custom7",t[t.Custom8=2048]="Custom8",t[t.Custom9=4096]="Custom9",t[t.Custom10=8192]="Custom10",t[t.Custom11=16384]="Custom11",t[t.Custom12=32768]="Custom12",t[t.All=65520]="All"}(Bn||(Bn={}));function Hr(t){return[t.on("before-add",e=>{const i=e.item;if(i==null||t.includes(i))return T.getLogger("esri.views.interactive.interactiveToolUtils").warn("Tool is either already in the list of tools or tool is `null`. Not adding tool."),void e.preventDefault();i.onAdd()}),t.on("after-remove",e=>{const i=e.item;i.active&&(i.view.activeTool=null),i.destroy()})]}function Hi(t){return t.visible&&t.getEditableFlag!=null&&t.getEditableFlag(Mt.USER)&&t.getEditableFlag(Mt.MANAGER)}function re(t){return Z(t.x,t.y)}function Ns(t,e){var n;const i=(n=t instanceof HTMLElement?t:t.surface)==null?void 0:n.getBoundingClientRect();return i?Z(e.clientX-i.left,e.clientY-i.top):Z(0,0)}function Hs(t,e){return e instanceof Event?Ns(t,e):re(e)}function Gs(t){if(t instanceof Event)return!0;if(typeof t=="object"&&"type"in t)switch(t.type){case"click":case"double-click":case"pointer-down":case"pointer-drag":case"pointer-enter":case"pointer-leave":case"pointer-up":case"pointer-move":case"immediate-click":case"immediate-double-click":case"hold":case"drag":case"mouse-wheel":return!0;default:return!1}return!1}let Gr=class{constructor(){this._pointerLocations=new Map,this._hoveredManipulators=new Map,this._grabbedManipulators=new Map,this._draggedManipulators=new Map,this._stopDrag=!1,this._revertToNullActiveTool=!1,this._cursor=null}get cursor(){return this._cursor}hasFocusedManipulators(){return this._grabbedManipulators.size>0||this._draggedManipulators.size>0}handleInputEvent(e,i){const n=()=>e.stopPropagation();switch(e.type){case"pointer-move":Wn(e.pointerType)&&this._pointerLocations.set(e.pointerId,{x:e.x,y:e.y,pointerType:e.pointerType});break;case"drag":this._grabbedManipulators.size>0&&(this._stopDrag=!0),this._stopDrag&&(n(),e.action==="end"&&(this._stopDrag=!1));break;case"pointer-down":{if(!Kn(e))break;const s=re(e),a=this._intersect(s,e.pointerType,i.forEachTool);if(a==null)break;const o=a.manipulator,l=a.tool;o==null||l==null||!o.interactive||o.grabbable&&o.grabbableForEvent(e)||!o.grabbing||o.dragging||this._ungrabManipulatorBeforeDragging(o,e,i),o!=null&&l!=null&&o.interactive&&o.grabbable&&o.grabbableForEvent(e)&&!o.grabbing&&(this._grabbedManipulators.set(e.pointerId,{manipulator:o,tool:l,start:s,pointerType:e.pointerType}),this._grabbedManipulators.size===1&&i.activeTool==null&&(this._revertToNullActiveTool=!0,i.setActiveTool(a.tool)),o.grabbing=!0,o.events.emit("grab-changed",{action:"start",pointerType:e.pointerType,screenPoint:s}),n());break}case"pointer-up":this._draggedManipulators.has(e.pointerId)||this._handlePointerEnd(e,i);break;case"pointer-drag":{if(!Kn(e))break;const s=this._grabbedManipulators.get(e.pointerId),a=s==null?void 0:s.manipulator,o=s==null?void 0:s.tool;if(a==null||o==null)break;const l=re(e);l.x=Bt(l.x,0,i.view.width),l.y=Bt(l.y,0,i.view.height);const c=s.start,p=this._draggedManipulators.get(e.pointerId);switch(e.action){case"start":case"update":e.action!=="update"&&this._grabbedManipulators.size!==1||(a.dragging=!0,p?a.events.emit("drag",{action:"update",start:c,screenPoint:l}):a.events.emit("drag",{action:"start",start:c,screenPoint:l,pointerType:e.pointerType}),this._draggedManipulators.set(e.pointerId,{tool:o,manipulator:a,start:c}));break;case"end":a.dragging=!1,p&&a.events.emit("drag",{action:"end",start:c,screenPoint:l}),this._draggedManipulators.delete(e.pointerId),this._handlePointerEnd(e,i)}n();break}case"immediate-click":{const s=re(e),a=this._intersect(s,e.pointerType,i.forEachTool);if(Fr(e)||i.forEachTool(p=>{if((a==null||a.tool!==p||p.automaticManipulatorSelection)&&p.manipulators){let u=!1;p.manipulators.forEach(({manipulator:m})=>{m.selected&&(m.selected=!1,u=!0)}),u&&p.onManipulatorSelectionChanged&&p.onManipulatorSelectionChanged()}}),a==null)break;const{manipulator:o,tool:l}=a;if(!o.interactive)break;o.selectable&&l.automaticManipulatorSelection&&(o.selected=!o.selected,l.onManipulatorSelectionChanged&&l.onManipulatorSelectionChanged());const c=e.native.shiftKey;o.events.emit("immediate-click",{screenPoint:s,button:e.button,pointerType:e.pointerType,shiftKey:c,stopPropagation:n}),fi(o,n);break}case"click":{const s=re(e),a=this._intersect(s,e.pointerType,i.forEachTool),o=a==null?void 0:a.manipulator;if(o==null||!o.interactive)break;const l=e.native.shiftKey;o.events.emit(e.type,{screenPoint:s,button:e.button,pointerType:e.pointerType,shiftKey:l}),n();break}case"double-click":{const s=re(e),a=this._intersect(s,e.pointerType,i.forEachTool),o=a!=null?a.manipulator:null;if(o==null||!o.interactive)break;const l=e.native.shiftKey;o.events.emit("double-click",{screenPoint:s,button:e.button,pointerType:e.pointerType,shiftKey:l,stopPropagation:n}),fi(o,n);break}case"immediate-double-click":{const s=re(e),a=this._intersect(s,e.pointerType,i.forEachTool),o=a!=null?a.manipulator:null;if(o==null||!o.interactive)break;const l=e.native.shiftKey;o.events.emit("immediate-double-click",{screenPoint:s,button:e.button,pointerType:e.pointerType,shiftKey:l,stopPropagation:n}),fi(o,n);break}}this._onFocusChange(i.forEachTool)}_ungrabManipulatorBeforeDragging(e,i,n){e.grabbing=!1,e.events.emit("grab-changed",{action:"end",pointerType:i.pointerType,screenPoint:re(i)}),this._grabbedManipulators.forEach(({manipulator:s},a)=>{s===e&&this._grabbedManipulators.delete(a)}),this._afterManipulatorUngrab(n.setActiveTool)}_handlePointerEnd(e,i){var s;const n=(s=this._grabbedManipulators.get(e.pointerId))==null?void 0:s.manipulator;n!=null&&n.grabbing&&(n.grabbing=!1,n.events.emit("grab-changed",{action:"end",pointerType:e.pointerType,screenPoint:re(e)}),this._grabbedManipulators.delete(e.pointerId),this._afterManipulatorUngrab(i.setActiveTool))}_cursorFromMap(e){let i=null;return ti(e,({manipulator:n})=>!(n==null||!n.interactive)&&(n.grabbing&&n.grabCursor?(i=n.grabCursor,!0):!!n.cursor&&(i=n.cursor,!0))),i}_onFocusChange(e){this._updateCursor(),this._updateFocusedManipulatorTools(e)}_updateCursor(){this._grabbedManipulators.size>0?this._cursor=this._cursorFromMap(this._grabbedManipulators)||"grabbing":this._hoveredManipulators.size>0?this._cursor=this._cursorFromMap(this._hoveredManipulators)||"pointer":this._cursor=null}_updateFocusedManipulatorTools(e){const i=new Set,n=new Set;this._grabbedManipulators.forEach(({tool:s})=>{i.add(s)}),this._hoveredManipulators.forEach(({tool:s})=>{n.add(s)}),e(s=>{s.hasGrabbedManipulators=i.has(s),s.hasHoveredManipulators=n.has(s);const a=this._grabbedManipulators.values(),o=Ka(a,({tool:l})=>l===s);s.firstGrabbedManipulator=o!=null?o.manipulator:null})}clearPointers(e,{forEachTool:i,setActiveTool:n},s=!0,a){const o=(l,c)=>l===e&&(a==null||a===c);this._grabbedManipulators.forEach(({tool:l,manipulator:c,pointerType:p},u)=>{o(l,c)&&(this._grabbedManipulators.delete(u),c.grabbing=!1,c.events.emit("grab-changed",{action:"end",screenPoint:null,pointerType:p}))}),this._draggedManipulators.forEach(({tool:l,manipulator:c},p)=>{o(l,c)&&(this._draggedManipulators.delete(p),c.dragging=!1,c.events.emit("drag",{action:"cancel"}))}),s&&this._hoveredManipulators.forEach(({tool:l,manipulator:c},p)=>{o(l,c)&&(this._hoveredManipulators.delete(p),c.hovering=!1)}),this._afterManipulatorUngrab(n),this._onFocusChange(i)}_intersect(e,i,n){let s=null;return n(a=>{if(a.manipulators==null||!Hi(a))return!1;const o=a.manipulators.intersect(e,i);return o!=null&&(s={tool:a,manipulator:o},!0)}),s}updateHoveredStateFromKnownPointers(e){this._pointerLocations.forEach((i,n)=>{this._updateHoveredStateForPointerAtScreenPosition(Z(i.x,i.y),n,i.pointerType,e)})}handleHoverEvent(e,i){e.type!=="pointer-up"&&e.type!=="immediate-click"&&e.type!=="pointer-move"||!Wn(e.pointerType)||this._updateHoveredStateForPointerAtScreenPosition(re(e),e.pointerId,e.pointerType,i)}_updateHoveredStateForPointerAtScreenPosition(e,i,n,s){var l;let a=this._intersect(e,n,s);const o=(l=this._hoveredManipulators.get(i))==null?void 0:l.manipulator;a==null||a.manipulator.interactive||(a=null),a!=null&&o===a.manipulator||(o!=null&&(o.hovering=!1),a!=null?(a.manipulator.hovering=!0,this._hoveredManipulators.set(i,a)):this._hoveredManipulators.delete(i),this._onFocusChange(s))}_afterManipulatorUngrab(e){this._grabbedManipulators.size===0&&this._revertToNullActiveTool&&(e(null),this._revertToNullActiveTool=!1)}};function Wn(t){return t==="mouse"}function Kn(t){return t.pointerType!=="mouse"||t.button===0}function Fr(t){return!!t.native.shiftKey}function fi(t,e){t!=null&&t.consumesClicks&&e()}const Yn="attached",wi="tools",Xn=1e3;let le=class extends b{constructor(e){super(e),this._updatingHandles=new ai,this._clock=Pt,this._manipulatorState=new Gr,this.tools=new O,this.cursor=null,this._interacting=!1,this._interactingTimeout=Xn,this._interactingTimeoutHandle=null,this._forEachTool=i=>{for(const n of this.tools.items)if(i(n))return}}initialize(){this.addHandles([this.view.on(Os,e=>{this._handleInputEvent(e)},Ae.TOOL),...Hr(this.tools),this.tools.on("before-add",({item:e})=>{this._updateToolEditableFlag(e)}),this.tools.on("before-remove",({item:e})=>{this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs),this._updateCursor()}),this.tools.on("change",()=>{this._refreshToolWatchers()})])}destroy(){this.activeTool=null,this.tools.drain(e=>e.destroy()),this._clearInteractingTimeout(),this._interacting=!1,this._updatingHandles.destroy()}get _manipulatorStateEventArgs(){return{forEachTool:this._forEachTool,activeTool:this.activeTool,setActiveTool:e=>{this.activeTool=e},view:this.view}}set activeTool(e){if(e!=null&&!this.view.ready)return void T.getLogger(this).error("Cannot set active tool while view is not ready.");if(e===this.activeTool)return;const i=this.activeTool;this._set("activeTool",e),i!=null&&i.deactivate(),e!=null&&e.activate(),this._removeIncompleteTools(e);for(const n of this.tools){this._updateToolEditableFlag(n);const s=Hi(n);this.activeTool!=null&&s||this._manipulatorState.clearPointers(n,this._manipulatorStateEventArgs,!s)}this._updateCursor()}get updating(){return this._updatingHandles.updating||this.tools.some(e=>e.updating)}get interacting(){return this._interacting}_clearInteractingTimeout(){this._interactingTimeoutHandle=Me(this._interactingTimeoutHandle)}_startInteractingTimeout(){this._clearInteractingTimeout(),this._interactingTimeoutHandle=this._clock.setTimeout(()=>this._interacting=!1,this._interactingTimeout)}attach(){var e;this.view.type==="3d"?this.addHandles([f(()=>{const{state:i}=this.view;return"camera"in i&&i.camera},()=>this._forEachManipulator(i=>i.onViewChange())),(e=this.view.elevationProvider)==null?void 0:e.on("elevation-change",i=>this._forEachManipulator(n=>n.onElevationChange(i)))],Yn):this.addHandles(f(()=>this.view.extent,()=>this._forEachManipulator(i=>i.onViewChange())))}detach(){this.activeTool=null,this.tools.removeAll(),this.removeHandles(Yn),this._clearInteractingTimeout(),this._interacting=!1}_forEachManipulator(e){this._forEachTool(i=>{i.manipulators&&i.manipulators.forEach(({manipulator:n})=>e(n,i))})}_handleInputEvent(e){let i=!1;const n={...e,stopPropagation:()=>{i=!0,e.stopPropagation()}};this.activeTool!=null?this.activeTool.handleInputEvent&&this.activeTool.handleInputEvent(n):this._forEachTool(s=>{!i&&s.visible&&s.handleInputEvent(n)}),!i&&e.type==="key-down"&&e.key==="Escape"&&this.activeTool&&(e.stopPropagation(),this.activeTool=null),this._manipulatorState.handleInputEvent(n,this._manipulatorStateEventArgs),i||this.activeTool==null||this.activeTool.handleInputEventAfter(n),this._manipulatorState.handleHoverEvent(n,this._forEachTool),this._updateCursor(),e.type==="pointer-move"&&(this._manipulatorState.hasFocusedManipulators()||this.activeTool)&&(this._interacting=!0,this._startInteractingTimeout())}_refreshToolWatchers(){this.removeHandles(wi),this._forEachTool(e=>{if(e instanceof b){const i=f(()=>[e.cursor,e.visible,e.editable],()=>{Hi(e)||this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs),this._updateCursor()});this.addHandles(i,wi)}e.manipulators&&this.addHandles([e.manipulators.on("after-remove",i=>{this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs,!0,i.item.manipulator)}),e.manipulators.on("change",()=>{this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor()})],wi)}),this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor()}_updateToolEditableFlag(e){var i;(i=e.setEditableFlag)==null||i.call(e,Mt.MANAGER,this.activeTool==null||e===this.activeTool)}_updateCursor(){let e=this._manipulatorState.cursor;e==null&&this._forEachTool(i=>!(i.cursor==null||!i.visible)&&(e=i.cursor,!0)),this._get("cursor")!==e&&this._set("cursor",e)}_removeIncompleteTools(e){this.tools.filter(i=>(e==null||i!==e)&&!i.created&&i.removeIncompleteOnCancel).forEach(i=>{this.tools.remove(i)})}get test(){const e=this;return{setClock:i=>this._clock=i,set interactingTimeoutEnabled(i){e._interactingTimeout=i?Xn:0},get interactingTimeoutEnabled(){return e._interactingTimeout!==0}}}};r([h({constructOnly:!0,nonNullable:!0})],le.prototype,"view",void 0),r([h({value:null})],le.prototype,"activeTool",null),r([h({readOnly:!0,type:O})],le.prototype,"tools",void 0),r([h({readOnly:!0})],le.prototype,"cursor",void 0),r([h({readOnly:!0})],le.prototype,"updating",null),r([h()],le.prototype,"_interacting",void 0),r([h({readOnly:!0})],le.prototype,"interacting",null),le=r([_("esri.views.ToolViewManager")],le);let st=class extends b{constructor(e){super(),this.nativeIndex=null,this._detectedDeviceType="unknown",e.mapping==="standard"?this._detectedDeviceType="standard":Ur.test(e.id)?this._detectedDeviceType="spacemouse":this._detectedDeviceType="unknown",this.nativeIndex=e.index}get native(){const e=navigator.getGamepads?navigator.getGamepads():[];return this.nativeIndex!=null&&this.nativeIndex<e.length?e[this.nativeIndex]:null}get deviceType(){return this._detectedDeviceType}get axisThreshold(){return jr[this.deviceType]}};r([h({nonNullable:!0,readOnly:!0})],st.prototype,"nativeIndex",void 0),r([h({type:String,readOnly:!0})],st.prototype,"deviceType",null),r([h({type:Number,readOnly:!0})],st.prototype,"axisThreshold",null),st=r([_("esri.views.input.gamepad.GamepadInputDevice")],st);const Ur=new RegExp("^(3dconnexion|space(mouse|navigator|pilot|explorer))","i"),jr={standard:.15,spacemouse:.025,unknown:0},cn=st;let _t=class extends b{constructor(...e){super(...e),this.devices=new O,this.enabledFocusMode="document"}};r([h({type:O.ofType(cn),readOnly:!0})],_t.prototype,"devices",void 0),r([h({type:["document","view","none"]})],_t.prototype,"enabledFocusMode",void 0),_t=r([_("esri.views.input.gamepad.GamepadSettings")],_t);const qr=_t;let Ht=class extends b{constructor(){super(...arguments),this.gamepad=new qr}};r([h({readOnly:!0})],Ht.prototype,"gamepad",void 0),Ht=r([_("esri.views.input.Input")],Ht);const Zr=Ht;let Ie=class extends b{constructor(e){super(e),this.enabled=!0,this.device=null,this.mode="pan",this.tiltDirection="forward-down",this.velocityFactor=1}};r([h({type:Boolean,nonNullable:!0})],Ie.prototype,"enabled",void 0),r([h({type:cn})],Ie.prototype,"device",void 0),r([h({type:["pan","zoom"],nonNullable:!0})],Ie.prototype,"mode",void 0),r([h({type:["forward-down","forward-up"],nonNullable:!0})],Ie.prototype,"tiltDirection",void 0),r([h({type:Number,nonNullable:!0})],Ie.prototype,"velocityFactor",void 0),Ie=r([_("esri.views.navigation.gamepad.GamepadSettings")],Ie);const Fs=Ie;let Fe=class extends b{constructor(e){super(e),this.browserTouchPanEnabled=!0,this.gamepad=new Fs,this.momentumEnabled=!0,this.mouseWheelZoomEnabled=!0}};r([h({type:Boolean})],Fe.prototype,"browserTouchPanEnabled",void 0),r([h({type:Fs,nonNullable:!0})],Fe.prototype,"gamepad",void 0),r([h({type:Boolean})],Fe.prototype,"momentumEnabled",void 0),r([h({type:Boolean})],Fe.prototype,"mouseWheelZoomEnabled",void 0),Fe=r([_("esri.views.navigation.Navigation")],Fe);const Us=Fe;var Jn;function Br(t){var n;const e=t.url?Ro(t.url):void 0;return!(((n=t.spatialReference)==null?void 0:n.vcsWkid)==null&&e!=null&&e.serverType==="ImageServer")&&js(t)&&t.heightModelInfo?t.heightModelInfo:Wr(t)?an.deriveUnitFromSR(Yr,t.spatialReference):null}function js(t){return"heightModelInfo"in t}function qs(t){if(t.type==="unknown"||!("capabilities"in t))return!1;switch(t.type){case"csv":case"feature":case"geojson":case"subtype-group":case"ogc-feature":case"oriented-imagery":case"wfs":case"knowledge-graph-sublayer":return!0;default:return!1}}function Wr(t){return qs(t)?!!(t.capabilities&&t.capabilities.data&&t.capabilities.data.supportsZ):Zs(t)}function Kr(t){return t.layers!=null||Zs(t)||qs(t)||js(t)}function Zs(t){switch(t.type){case"building-scene":case"elevation":case"integrated-mesh":case"point-cloud":case"scene":case"voxel":return!0;case"base-dynamic":case"base-elevation":case"base-tile":case"bing-maps":case"csv":case"dimension":case"geojson":case"feature":case"subtype-group":case"geo-rss":case"graphics":case"group":case"imagery":case"imagery-tile":case"kml":case"knowledge-graph":case"link-chart":case"knowledge-graph-sublayer":case"line-of-sight":case"map-image":case"map-notes":case"media":case"ogc-feature":case"open-street-map":case"oriented-imagery":case"route":case"stream":case"tile":case"unknown":case"unsupported":case"vector-tile":case"video":case"wcs":case"web-tile":case"wfs":case"wms":case"wmts":case null:return!1}return!1}(function(t){t[t.Ok=0]="Ok",t[t.Units=1]="Units",t[t.HeightModel=2]="HeightModel",t[t.CRS=3]="CRS",t[t.Unsupported=4]="Unsupported"})(Jn||(Jn={}));const Yr=new an({heightModel:"gravity-related-height"});let Gi,bi=null;async function Xr(t){bi||(bi=w(()=>import("./geometryServiceUtils-7bade42a.js"),["./geometryServiceUtils-7bade42a.js","./uuid-fb53ae2e.js","./index-e42a63f9.js","./project-51979a4c.js"],import.meta.url).then(e=>Gi=e)),await bi,ue(t)}async function Bs(t,e,i,n){if(!t)return null;const s=t.spatialReference;return on()||ni(s,e)?Ct(t,e):Gi?Gi.projectGeometry(t,e,i,n):(await Promise.race([Xr(n),rn(n)]),Bs(t,e,i,n))}let x=class extends b{constructor(e){super(e),this.required={tileInfo:!1,heightModelInfo:!1,extent:!1},this.defaultSpatialReference=null,this.userSpatialReference=null,this.sourcePreloadCount=10,this.priorityCollection=null,this.requiresExtentInSpatialReference=!0,this.suspended=!1,this._projectExtentTask={task:null,input:null,output:null,spatialReference:null}}destroy(){this._projectExtentTask.task&&(this._projectExtentTask.task=Di(this._projectExtentTask.task)),this._set("map",null)}get ready(){return!this._spatialReferenceTask.updating&&!this._tileInfoTask.updating&&!this._extentTask.updating}get heightModelInfoReady(){return!this._heightModelInfoTask.updating}get spatialReference(){return this.userSpatialReference!=null?this.userSpatialReference:this._spatialReferenceTask.spatialReference}get extent(){return this._extentTask.extent}get heightModelInfo(){return this._heightModelInfoTask.heightModelInfo}get vcsWkid(){return this._heightModelInfoTask.vcsWkid}get latestVcsWkid(){return this._heightModelInfoTask.latestVcsWkid}get viewingMode(){return this.userSpatialReference==null||this.userSpatialReference.equals(this._spatialReferenceTask.spatialReference)?this._spatialReferenceTask.viewingMode:null}get tileInfo(){return this._tileInfoTask.tileInfo}get mapCollections(){var n,s,a,o;const e=(n=this.map)==null?void 0:n.call(this),i=[];return this.priorityCollection!=null&&i.push(this.priorityCollection),i.push({parent:e==null?void 0:e.basemap,layers:(s=e==null?void 0:e.basemap)==null?void 0:s.baseLayers},{layers:e==null?void 0:e.layers},{parent:e==null?void 0:e.ground,layers:(a=e==null?void 0:e.ground)==null?void 0:a.layers},{parent:e==null?void 0:e.basemap,layers:(o=e==null?void 0:e.basemap)==null?void 0:o.referenceLayers}),i}get _allLayers(){return this._collectLayers(this.mapCollections)}get _spatialReferenceTask(){if(this.suspended)return this._get("_spatialReferenceTask")??{updating:!1};const{layers:e,updating:i}=this._allLayers;let n=null;for(const a of e){const o=this._getSupportedSpatialReferences(a);if(o.length>0){const l=this._narrowDownSpatialReferenceCandidates(n,o);l!=null&&(n=l)}if(n!=null&&n.length===1)break}if(i&&(n==null||n.length!==1))return{updating:!0};const s=this._pickSpatialReferenceCandidate(n);return{spatialReference:s!=null?s.spatialReference:null,viewingMode:s!=null?s.viewingMode:null,updating:!1}}get _tileInfoTask(){var n,s,a,o,l,c,p;if(!this.required.tileInfo)return this._get("_tileInfoTask")??{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const{layers:e,updating:i}=this._collectLayers([{parent:(s=(n=this.map)==null?void 0:n.call(this))==null?void 0:s.basemap,layers:(l=(o=(a=this.map)==null?void 0:a.call(this))==null?void 0:o.basemap)==null?void 0:l.baseLayers},{layers:(p=(c=this.map)==null?void 0:c.call(this))==null?void 0:p.layers}]);if(e&&e.length>0&&"tileInfo"in e[0]){const u=e[0].tileInfo;return{tileInfo:u&&u.spatialReference.equals(this.spatialReference)?u:null,updating:!1}}return{updating:i}}get _heightModelInfoTask(){var n,s,a;if(!this.required.heightModelInfo||this.suspended&&((n=this._get("_heightModelInfoTask"))!=null&&n.heightModelInfo))return this._get("_heightModelInfoTask")??{updating:!1};const{layers:e,updating:i}=this._allLayers;for(const o of e)if(Kr(o)){const l=Br(o);if(l)return{heightModelInfo:l,vcsWkid:(s=o.spatialReference)==null?void 0:s.vcsWkid,latestVcsWkid:(a=o.spatialReference)==null?void 0:a.latestVcsWkid,updating:!1}}return{updating:i}}get _extentCandidatesTask(){if(this.suspended||!this.required.extent)return this._get("_extentCandidatesTask")??{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const e=this._allLayers,i=e.updating,n=[];for(const s of e.layers){const a="fullExtents"in s&&s.fullExtents||(s.fullExtent!=null?[s.fullExtent]:[]),o=this.requiresExtentInSpatialReference?null:a[0],l=a.find(c=>c.spatialReference.equals(this.spatialReference))??o;if(l)return{candidates:[{extent:l,layer:s}],updating:!1};if(this._getSupportedSpatialReferences(s).length>0)for(const c of a)n.push({extent:c,layer:s})}return{candidates:n,updating:i}}get _extentTask(){const{candidates:e,updating:i}=this._extentCandidatesTask;if(i)return{updating:i};if(e==null||e.length===0)return{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const n=this._pickExtentCandidate(e),s=this.spatialReference;return n.extent.equals(this._projectExtentTask.input)&&s.equals(this._projectExtentTask.spatialReference)?{extent:this._projectExtentTask.output,updating:this._projectExtentTask.task!=null&&!this._projectExtentTask.task.finished}:(this._projectExtentTask.task!=null&&(this._projectExtentTask.task=Di(this._projectExtentTask.task)),this._projectExtentTask={input:n.extent.clone(),output:null,spatialReference:s.clone(),task:Qi(async a=>{try{const o=await Bs(n.extent,s,"portalItem"in n.layer?n.layer.portalItem:void 0,a);this._projectExtentTask={...this._projectExtentTask,task:null,output:o}}catch{if(Ya(a))return;this._projectExtentTask={...this._projectExtentTask,task:null}}})},{updating:!0})}_narrowDownSpatialReferenceCandidates(e,i){if(e==null)return i;const n=[],s=(a,o)=>a!=null?o!=null?a===o&&a:a:o;for(const a of e)for(const o of i){if(!a.spatialReference.equals(o.spatialReference))continue;const l=s(a.viewingMode,o.viewingMode);if(l!==!1){n.push({spatialReference:a.spatialReference,viewingMode:l});break}}return n.length>0?n:null}_pickSpatialReferenceCandidate(e){const i=this.defaultSpatialReference;return e==null||e.length<1?i!=null?{spatialReference:i,viewingMode:null}:null:(i!=null&&e.length>1&&e.some(({spatialReference:n})=>n.equals(i))&&(e=e.filter(({spatialReference:n})=>n.equals(i))),e.length>1&&e.some(({viewingMode:n})=>n!==Vn.Local)&&(e=e.filter(({viewingMode:n})=>n!==Vn.Local)),e[0])}_getSupportedSpatialReferences(e){const i="supportedSpatialReferences"in e&&e.supportedSpatialReferences||(e.spatialReference?[e.spatialReference]:[]);if(i.length===0)return[];const n=[];for(const s of i){const a=this.getSpatialReferenceSupport({spatialReference:s,layer:e});if(a!=null){const o=a.constraints!=null?a.constraints:[{spatialReference:s,viewingMode:null}];for(const{spatialReference:l,viewingMode:c}of o)this.requiresExtentInSpatialReference&&this.userSpatialReference!=null&&!l.equals(this.userSpatialReference)||n.push({spatialReference:l,viewingMode:c})}}return n}_pickExtentCandidate(e){const i=this.spatialReference;return e.find(({extent:n})=>i.equals(n.spatialReference))||e[0]}_collectLayers(e){var n;if(this._loadMaybe((n=this.map)==null?void 0:n.call(this))!=="loaded")return{layers:[],updating:!0};const i=new Jr;for(const s of e)if(this._collectCollection(s,i),i.preloading===this.sourcePreloadCount)break;return{layers:i.layers,updating:i.updating}}_collectCollection(e,i){if(e.layers){switch(this._loadMaybe(e.parent)){case"loading":return i.updating=!0,void++i.preloading;case"failed":return}for(const n of e.layers){switch(this._loadMaybe(n)){case"failed":continue;case"loading":i.updating=!0,++i.preloading;break;case"loaded":i.updating||i.layers.push(n),"layers"in n&&this._collectCollection({layers:n.layers},i)}if(i.preloading===this.sourcePreloadCount)break}}}_loadMaybe(e){return e&&"loadStatus"in e&&e.loadStatus!=null?e.loadStatus==="not-loaded"?(e.load().catch(i=>{Tt(i)||console.log(i)}),"loading"):e.loadStatus:"loaded"}};r([h()],x.prototype,"required",void 0),r([h({constructOnly:!0})],x.prototype,"map",void 0),r([h({constructOnly:!0})],x.prototype,"getSpatialReferenceSupport",void 0),r([h()],x.prototype,"defaultSpatialReference",void 0),r([h()],x.prototype,"userSpatialReference",void 0),r([h()],x.prototype,"sourcePreloadCount",void 0),r([h()],x.prototype,"priorityCollection",void 0),r([h()],x.prototype,"requiresExtentInSpatialReference",void 0),r([h()],x.prototype,"suspended",void 0),r([h({readOnly:!0})],x.prototype,"ready",null),r([h({readOnly:!0})],x.prototype,"heightModelInfoReady",null),r([h({readOnly:!0})],x.prototype,"spatialReference",null),r([h({readOnly:!0})],x.prototype,"extent",null),r([h({readOnly:!0})],x.prototype,"heightModelInfo",null),r([h({readOnly:!0})],x.prototype,"vcsWkid",null),r([h({readOnly:!0})],x.prototype,"latestVcsWkid",null),r([h({readOnly:!0})],x.prototype,"viewingMode",null),r([h({readOnly:!0})],x.prototype,"tileInfo",null),r([h({readOnly:!0})],x.prototype,"mapCollections",null),r([h({readOnly:!0})],x.prototype,"_allLayers",null),r([h({readOnly:!0})],x.prototype,"_spatialReferenceTask",null),r([h({readOnly:!0})],x.prototype,"_tileInfoTask",null),r([h({readOnly:!0})],x.prototype,"_heightModelInfoTask",null),r([h({readOnly:!0})],x.prototype,"_extentCandidatesTask",null),r([h()],x.prototype,"_extentTask",null),r([h()],x.prototype,"_projectExtentTask",void 0),x=r([_("esri.views.support.DefaultsFromMap")],x);let Jr=class{constructor(){this.layers=new Array,this.preloading=-1,this.updating=!1}};var vt;let y=vt=class extends Ji.EventedMixin(Xa(b)){constructor(t){super(t),this._userSpatialReference=null,this._cursor=null,this.handles=new Ts,this.updatingHandles=new ai,this.allLayerViews=new Wt({getCollections:()=>{var e,i,n;return[(e=this.basemapView)==null?void 0:e.baseLayerViews,(i=this.groundView)==null?void 0:i.layerViews,this.layerViews,(n=this.basemapView)==null?void 0:n.referenceLayerViews]},getChildrenFunction:el}),this.groundView=null,this.basemapView=null,this.fatalError=null,this.graphics=new Ss,this.analyses=new Jt,this.typeSpecificPreconditionsReady=!0,this.layerViews=new O,this.magnifier=new Ls,this.padding={left:0,top:0,right:0,bottom:0},this.ready=!1,this.spatialReferenceWarningDelay=1e3,this.supportsGround=!0,this.timeExtent=null,this.type=null,this.scale=null,this.updating=!1,this.initialExtentRequired=!0,this.input=new Zr,this.navigation=new Us,this.layerViewManager=null,this.analysisViewManager=null,this.isHeightModelInfoRequired=!1,this.width=null,this.height=null,this.resizing=!1,this.suspended=!1,this.viewEvents=new zr(this),this.persistableViewModels=new O,this._isValid=!1,this._readyCycleForced=!1,this._lockedSpatialReference=null,this._userTimeZone=null,this._lockedTimeZone=null,this.theme=null,this.handles.add(f(()=>this.preconditionsReady,e=>{var i,n;e?(this._lockedSpatialReference=this.spatialReference,this._lockedTimeZone=this.timeZone,vt.views.add(this)):(this._lockedSpatialReference=null,vt.views.remove(this)),this.notifyChange("spatialReference"),!e&&this.ready?((i=this.toolViewManager)==null||i.detach(),this.analysisViewManager!=null&&this.analysisViewManager.detach(),(n=this.layerViewManager)==null||n.clear(),this._teardown()):e&&!this.ready&&(this._startup(),this.analysisViewManager!=null&&this.analysisViewManager.attach(),this.toolViewManager.attach())},ii))}initialize(){this.addResolvingPromise(Promise.all([this.loadAsyncDependencies(),this.validate()]).then(()=>(this._isValid=!0,ei(()=>this.ready)))),this.basemapView=new Ee({view:this}),this.layerViewManager=new Lr({view:this,layerViewImporter:{importLayerView:t=>this.importLayerView(t),hasLayerViewModule:t=>this.hasLayerViewModule(t)},supportsGround:this.supportsGround}),this.toolViewManager=new le({view:this}),this._setupSpatialReferenceLogger(),this.addHandles([f(()=>this.initialExtentRequired,t=>this.defaultsFromMap.required={...this.defaultsFromMap.required,extent:t},{sync:!0,initial:!0}),f(()=>this.ready,t=>{this.defaultsFromMap&&(this.defaultsFromMap.suspended=t,this.defaultsFromMap.userSpatialReference=t?this.spatialReference:this._userSpatialReference)},{sync:!0}),f(()=>this._userSpatialReference,t=>{this.defaultsFromMap&&(this.defaultsFromMap.userSpatialReference=t)},{sync:!0,initial:!0})])}_setupSpatialReferenceLogger(){let t=null;this.addHandles([f(()=>{var e;return(e=this.defaultsFromMap)==null?void 0:e.ready},e=>{var n;const i=((n=this.map)==null?void 0:n.allLayers.length)>0;if(e&&!this.spatialReference&&i){if(t!=null)return;const s=bs(()=>t=Di(t));t=Qi(async a=>{try{await Qa(this.spatialReferenceWarningDelay,null,a)}catch{return}finally{t=null}T.getLogger(this).warn("#spatialReference","no spatial reference could be derived from the currently added map layers")}),this.addHandles(s,"spatial-reference-logger-task")}else this.removeHandles("spatial-reference-logger-task")},{sync:!0})])}destroy(){var t,e;this.destroyed||(vt.views.remove(this),this.viewEvents.destroy(),this.allLayerViews.destroy(),this.navigation&&(this.navigation.destroy(),this._set("navigation",null)),this.graphics=F(this.graphics),this.analyses=F(this.analyses),this.defaultsFromMap.destroy(),this._set("defaultsFromMap",null),F(this.analysisViewManager),this.toolViewManager=F(this.toolViewManager),this.layerViewManager=F(this.layerViewManager),this.basemapView=F(this.basemapView),(t=this.groundView)==null||t.destroy(),(e=this.layerViews)==null||e.forEach(i=>i.destroy()),this.layerViews.length=0,this.invalidate(),this._emitter.clear(),this.handles.destroy(),this.map=F(this.map),this.updatingHandles.destroy())}_startup(){this._set("ready",!0)}_teardown(){this._set("ready",!1)}whenReady(){return Promise.resolve(this)}toMap(){return T.getLogger(this).error("#toMap()","Not implemented on this instance of View"),null}get activeTool(){var t;return(t=this.toolViewManager)==null?void 0:t.activeTool}set activeTool(t){this.toolViewManager&&(this.toolViewManager.activeTool=t)}get animation(){return this._get("animation")}set animation(t){this._set("animation",t)}get center(){return null}get _defaultsFromMapSettings(){return{}}get defaultsFromMap(){return new x({required:{tileInfo:!1,heightModelInfo:!1,extent:!1},map:()=>this.map,getSpatialReferenceSupport:t=>this.getSpatialReferenceSupport(t),...this._defaultsFromMapSettings})}get extent(){return this._get("extent")}set extent(t){this._set("extent",t)}get heightModelInfo(){return this.getDefaultHeightModelInfo()}get interacting(){return this.navigating}get navigating(){return!1}get preconditionsReady(){var t;return!(this.fatalError||!this._isValid||this._readyCycleForced||!this.map||Ii.isLoadable(this.map)&&!this.map.loaded||this.width===0||this.height===0||!this.spatialReference||!this._validateSpatialReference(this.spatialReference)||!this._lockedSpatialReference&&!((t=this.defaultsFromMap)!=null&&t.ready)||!this.typeSpecificPreconditionsReady)}get resolution(){return 0}set map(t){t!==this._get("map")&&(t!=null&&t.destroyed&&(T.getLogger(this).warn("#map","The provided map is already destroyed",{map:t}),t=null),Ii.isLoadable(t)&&t.load().catch(()=>{}),this.constructed&&!this.destroyed&&(this.forceReadyCycle(),this._lockedSpatialReference=null),this._set("map",t))}get spatialReference(){var e,i;let t=this._userSpatialReference||this._lockedSpatialReference||this.getDefaultSpatialReference()||null;return t&&((i=(e=this.defaultsFromMap)==null?void 0:e.required)!=null&&i.heightModelInfo)&&(t=t.clone(),t.vcsWkid=this.defaultsFromMap.vcsWkid,t.latestVcsWkid=this.defaultsFromMap.latestVcsWkid),t}set spatialReference(t){const e=!pt(t,this._get("spatialReference"));this._set("_userSpatialReference",t),e&&(this._set("spatialReference",t),this._spatialReferenceChanged(t))}_spatialReferenceChanged(t){}get stationary(){return!this.animation&&!this.navigating&&!this.resizing}get timeZone(){return this._userTimeZone??this._lockedTimeZone??this.getDefaultTimeZone()??Mn}set timeZone(t){const e=new Set(["etc/utc","etc/gmt","gmt"]),i=new Set(Intl.supportedValuesOf("timeZone").map(n=>n.toLowerCase()));this._userTimeZone=t,t===Mn||t===Ja||e.has(t.toLowerCase())||i.has(t.toLowerCase())||T.getLogger(this).warn("#timeZone",`the parsed value '${t}' may not be a valid IANA time zone`)}get tools(){var t;return(t=this.toolViewManager)==null?void 0:t.tools}get initialExtent(){var t;return(t=this.defaultsFromMap)==null?void 0:t.extent}get cursor(){var t;return((t=this.toolViewManager)==null?void 0:t.cursor)??this._cursor??"default"}set cursor(t){this._cursor=t,this.notifyChange("cursor")}get size(){return[this.width,this.height]}get effectiveTheme(){return this.theme??new Ni}whenLayerView(t){var e;return((e=this.layerViewManager)==null?void 0:e.whenLayerView(t))??Promise.reject()}getDefaultSpatialReference(){var t;return(t=this.defaultsFromMap)==null?void 0:t.spatialReference}getDefaultHeightModelInfo(){var t;return(this.map&&"heightModelInfo"in this.map?this.map.heightModelInfo:void 0)??((t=this.defaultsFromMap)==null?void 0:t.heightModelInfo)??null}getDefaultTimeZone(){return null}importLayerView(t){throw new P("importLayerView() not implemented")}hasLayerViewModule(t){return!1}async validate(){}async loadAsyncDependencies(){}invalidate(){this._isValid=!1}getSpatialReferenceSupport(){return{constraints:null}}_validateSpatialReference(t){return this.getSpatialReferenceSupport({spatialReference:t})!=null}when(t,e){return this.isResolved()&&!this.ready&&T.getLogger(this).warn("#when()","Calling view.when() while the view is no longer ready but was already resolved once will resolve immediately. Use reactiveUtils.whenOnce(() => view.ready).then(...) instead."),super.when(t,e)}forceReadyCycle(){this.ready&&(kt(()=>this.destroyed||this.preconditionsReady===!1,()=>this._readyCycleForced=!1,{once:!0}),this._readyCycleForced=!0)}addAndActivateTool(t){this.toolViewManager.tools.add(t),this.activeTool=t}tryFatalErrorRecovery(){this.fatalError=null}};y.views=new O,r([h()],y.prototype,"_userSpatialReference",void 0),r([h()],y.prototype,"activeTool",null),r([h({readOnly:!0})],y.prototype,"allLayerViews",void 0),r([h()],y.prototype,"groundView",void 0),r([h()],y.prototype,"animation",null),r([h()],y.prototype,"basemapView",void 0),r([h()],y.prototype,"center",null),r([h({readOnly:!0})],y.prototype,"_defaultsFromMapSettings",null),r([h()],y.prototype,"defaultsFromMap",null),r([h()],y.prototype,"fatalError",void 0),r([h({type:Ye})],y.prototype,"extent",null),r([h(Rn(Ss,"graphics"))],y.prototype,"graphics",void 0),r([h(Rn(Jt,"analyses"))],y.prototype,"analyses",void 0),r([h({readOnly:!0,type:an})],y.prototype,"heightModelInfo",null),r([h({readOnly:!0})],y.prototype,"interacting",null),r([h({readOnly:!0})],y.prototype,"navigating",null),r([h({readOnly:!0,dependsOn:["fatalError","_isValid","_readyCycleForced","map","map.loaded?","width","height","spatialReference","_lockedSpatialReference","defaultsFromMap.ready","typeSpecificPreconditionsReady"]})],y.prototype,"preconditionsReady",null),r([h({readOnly:!0})],y.prototype,"typeSpecificPreconditionsReady",void 0),r([h({type:O,readOnly:!0})],y.prototype,"layerViews",void 0),r([h()],y.prototype,"resolution",null),r([h({type:Ls})],y.prototype,"magnifier",void 0),r([h({value:null,type:Vs})],y.prototype,"map",null),r([h()],y.prototype,"padding",void 0),r([h({readOnly:!0})],y.prototype,"ready",void 0),r([h({type:nn})],y.prototype,"spatialReference",null),r([h()],y.prototype,"spatialReferenceWarningDelay",void 0),r([h()],y.prototype,"stationary",null),r([h({readOnly:!0})],y.prototype,"supportsGround",void 0),r([h({type:Vo})],y.prototype,"timeExtent",void 0),r([h({type:String,nonNullable:!0})],y.prototype,"timeZone",null),r([h()],y.prototype,"tools",null),r([h()],y.prototype,"toolViewManager",void 0),r([h({readOnly:!0})],y.prototype,"type",void 0),r([h({type:Number})],y.prototype,"scale",void 0),r([h({readOnly:!0})],y.prototype,"updating",void 0),r([h({readOnly:!0})],y.prototype,"initialExtentRequired",void 0),r([h({readOnly:!0})],y.prototype,"initialExtent",null),r([h()],y.prototype,"cursor",null),r([h({readOnly:!0})],y.prototype,"input",void 0),r([h({type:Us,nonNullable:!0})],y.prototype,"navigation",void 0),r([h()],y.prototype,"layerViewManager",void 0),r([h()],y.prototype,"analysisViewManager",void 0),r([h()],y.prototype,"width",void 0),r([h()],y.prototype,"height",void 0),r([h({readOnly:!0})],y.prototype,"resizing",void 0),r([h({value:null,readOnly:!0})],y.prototype,"size",null),r([h({readOnly:!0})],y.prototype,"suspended",void 0),r([h({readOnly:!0})],y.prototype,"viewEvents",void 0),r([h({readOnly:!0})],y.prototype,"persistableViewModels",void 0),r([h()],y.prototype,"_isValid",void 0),r([h()],y.prototype,"_readyCycleForced",void 0),r([h()],y.prototype,"_lockedSpatialReference",void 0),r([h()],y.prototype,"_userTimeZone",void 0),r([h()],y.prototype,"_lockedTimeZone",void 0),r([h({type:Ni})],y.prototype,"theme",void 0),r([h({readOnly:!0,type:Ni})],y.prototype,"effectiveTheme",null),y=vt=r([_("esri.views.View")],y);const Qr=y;function el(t){return t.layerViews}let De=class extends eo{constructor(e){super(e),this.state="running",this.target=null,this._resolver=null}initialize(){this._resolver=en(),this.addResolvingPromise(this._resolver.promise)}get done(){return this.state==="finished"||this.state==="stopped"}stop(){var e;this.state!=="stopped"&&this.state!=="finished"&&(this._set("state","stopped"),(e=this._resolver)==null||e.reject(new P("ViewAnimation stopped")))}finish(){var e;this.state!=="stopped"&&this.state!=="finished"&&(this._set("state","finished"),(e=this._resolver)==null||e.resolve())}update(e,i){i||(i=to(e)?"waiting-for-target":"running"),this._set("target",e),this._set("state",i)}};r([h({readOnly:!0})],De.prototype,"done",null),r([h({readOnly:!0,type:String})],De.prototype,"state",void 0),r([h()],De.prototype,"target",void 0),De=r([_("esri.views.ViewAnimation")],De),function(t){t.State={RUNNING:"running",STOPPED:"stopped",FINISHED:"finished",WAITING_FOR_TARGET:"waiting-for-target"}}(De||(De={}));const Fi=De;function ze(){return[1,0,0,1,0,0]}function tl(t){return[t[0],t[1],t[2],t[3],t[4],t[5]]}function il(t,e,i,n,s,a){return[t,e,i,n,s,a]}function nl(t,e){return new Float64Array(t,e,6)}Object.freeze(Object.defineProperty({__proto__:null,clone:tl,create:ze,createView:nl,fromValues:il},Symbol.toStringTag,{value:"Module"}));const Ws=96,Ks=39.37,sl=180/Math.PI;function Ys(t){return t.wkid?t:t.spatialReference||nn.WGS84}function pn(t,e){return e.type?A(t,e.x,e.y):Yt(t,e)}function Xs(t){return io(t)}function ct(t,e){const i=Math.max(1,e[0]),n=Math.max(1,e[1]);return Math.max(t.width/i,t.height/n)*ul(t.spatialReference)}async function ft(t,e,i,n){var l,c;let s,a;if(!t||Array.isArray(t)&&!t.length)return null;if(O.isCollection(t)&&(t=t.toArray()),Array.isArray(t)&&t.length&&typeof t[0]=="object"){const p=t.every(d=>"attributes"in d),u=t.some(d=>!d.geometry);let m=t;if(p&&u&&e&&e.allLayerViews){const d=new Map;for(const M of t){const I=M.layer,U=d.get(I)||[],k=M.attributes[I.objectIdField];k!=null&&U.push(k),d.set(I,U)}const g=[];d.forEach((M,I)=>{const U=e.allLayerViews.find(k=>k.layer.id===I.id);if(U&&"queryFeatures"in U){const k=I.createQuery();k.objectIds=M,k.returnGeometry=!0,g.push(U.queryFeatures(k))}});const S=await Promise.all(g),C=[];for(const M of S)if(M&&M.features&&M.features.length)for(const I of M.features)I.geometry!=null&&C.push(I.geometry);m=C}for(const d of m)n=await ft(d,e,i,n);return n}if(Array.isArray(t)&&t.length===2&&typeof t[0]=="number"&&typeof t[1]=="number")s=new D(t);else if(t instanceof no)s=t;else if("geometry"in t){if(t.geometry)s=t.geometry;else if(t.layer){const p=t.layer,u=e.allLayerViews.find(m=>m.layer.id===p.id);if(u&&"queryFeatures"in u){const m=p.createQuery();m.objectIds=[t.attributes[p.objectIdField]],m.returnGeometry=!0;const d=await u.queryFeatures(m);s=(c=(l=d==null?void 0:d.features)==null?void 0:l[0])==null?void 0:c.geometry}}}if(s==null)return null;switch(s.type){case"point":a=new Ye({xmin:s.x,ymin:s.y,xmax:s.x,ymax:s.y,spatialReference:s.spatialReference});break;case"extent":case"multipoint":case"polygon":case"polyline":a=Jo(s);break;default:a=s.extent}if(!a)return null;on()||ni(a.spatialReference,i)||await rn();const o=Ct(a,i);return o?n=n?n.union(o):o:null}function al(t){var e;if(t&&(!Array.isArray(t)||typeof t[0]!="number")&&(typeof t=="object"||Array.isArray(t)&&typeof t[0]=="object")){if("layer"in t&&((e=t.layer)==null?void 0:e.minScale)!=null&&t.layer.maxScale!=null){const i=t.layer;return{min:i.minScale,max:i.maxScale}}if(Array.isArray(t)&&t.length&&t.every(i=>"layer"in i)){let i=0,n=0;for(const s of t){const a=s.layer;a!=null&&a.minScale&&a.maxScale&&(i=a.minScale<i?a.minScale:i,n=a.maxScale>n?a.maxScale:n)}return i&&n?{min:i,max:n}:null}}}function Ti(t,e){return pt(Ys(t),e)?t:Ct(t,e)}async function ol(t,e){var C;if(!t||!e)return new me({targetGeometry:new D,scale:0,rotation:0});let i=e.spatialReference;const{constraints:n,padding:s,viewpoint:a,size:o}=e,l=[s?o[0]-s.left-s.right:o[0],s?o[1]-s.top-s.bottom:o[1]];let c=null;t instanceof me?c=t:t.viewpoint?c=t.viewpoint:t.target&&t.target.declaredClass==="esri.Viewpoint"&&(c=t.target);let p=null;c!=null&&c.targetGeometry?p=c.targetGeometry:t instanceof Ye?p=t:(t||t&&("center"in t||"extent"in t||"target"in t))&&(p=await ft(t.center,e,i)||await ft(t.extent,e,i)||await ft(t.target,e,i)||await ft(t,e,i)),!p&&(a!=null&&a.targetGeometry)?p=a.targetGeometry:!p&&e.extent&&(p=e.extent),i||(i=Ys(e.spatialReference||e.extent||p)),on()||pt(p.spatialReference,i)||ni(p.spatialReference,i)||await rn();const u=Ti("center"in p?p.center:p,i);e.pickClosestTarget!==!1&&u.type==="point"&&((C=a.targetGeometry)==null?void 0:C.type)==="point"&&(u.x=Rs(u.x,a.targetGeometry.x,u.spatialReference));let m=0;if((c==null?void 0:c.targetGeometry)!=null&&c.targetGeometry.type==="point")m=c.scale;else if("scale"in t&&t.scale)m=t.scale;else if("zoom"in t&&t.zoom!==-1&&n&&n.effectiveLODs)m=n.zoomToScale(t.zoom);else if(Array.isArray(p)||p.type==="point"||p.type==="extent"&&p.width===0&&p.height===0){const M=Ti(e.extent,i);m=M!=null?ct(M,l):e.extent?ct(e.extent,l):a.scale}else m=ct(Ti(p.extent,i),l);const d=al(t.target??t);d&&(d.min&&d.min<m?m=d.min:d.max&&d.max>m&&(m=d.max));let g=0;c?g=c.rotation:t.hasOwnProperty("rotation")?g=t.rotation:a&&(g=a.rotation);let S=new me({targetGeometry:u,scale:m,rotation:g});return n&&(S=n.fit(S),n.constrainByGeometry(S),n.rotationEnabled||(S.rotation=a.rotation)),S}function se(t,e){const i=t.targetGeometry,n=e.targetGeometry;return i.x=n.x,i.y=n.y,i.spatialReference=n.spatialReference,t.scale=e.scale,t.rotation=e.rotation,t}function rl(t,e,i){return i?A(t,.5*(e[0]-i.right+i.left),.5*(e[1]-i.bottom+i.top)):oi(t,e,.5)}const ll=function(){const t=R();return function(e,i,n){const s=i.targetGeometry;pn(t,s);const a=.5*ut(i);return e.xmin=t[0]-a*n[0],e.ymin=t[1]-a*n[1],e.xmax=t[0]+a*n[0],e.ymax=t[1]+a*n[1],e.spatialReference=s.spatialReference,e}}();function hl(t,e,i,n,s){var a;return Ui(t,e,i.center),t.scale=ct(i,n),(a=s==null?void 0:s.constraints)==null||a.constrain(t),t}function cl(t,e,i,n){return mn(t,e,i,n),Is(t,t)}const Js=function(){const t=R();return function(e,i,n){return Ds(e,ml(e,i),rl(t,i,n))}}(),pl=function(){const t=ze(),e=R();return function(i,n,s,a){const o=ut(n),l=dn(n);return A(e,o,o),jo(t,e),ln(t,t,l),Kt(t,t,Js(e,s,a)),Kt(t,t,[0,a.top-a.bottom]),A(i,t[4],t[5])}}();function ut(t){return t.scale*dl(t.targetGeometry)}function dl(t){return t!=null&&ks(t.spatialReference)?1/(Xs(t.spatialReference)*Ks*Ws):1}function dn(t){return Ms(t.rotation)||0}function ul(t){return ks(t)?Xs(t)*Ks*Ws:1}function ml(t,e){return oi(t,e,.5)}const un=function(){const t=R(),e=R(),i=R();return function(n,s,a,o,l,c){return Zo(t,s),oi(e,a,.5*c),A(i,1/o*c,-1/o*c),$s(n,e),l&&ln(n,n,l),Es(n,n,i),Kt(n,n,t),n}}(),mn=function(){const t=R();return function(e,i,n,s){const a=ut(i),o=dn(i);return pn(t,i.targetGeometry),un(e,t,n,a,o,s)}}(),gl=function(){const t=R();return function(e,i,n,s){const a=ut(i);return pn(t,i.targetGeometry),un(e,t,n,a,0,s)}}();function yl(t){const e=so(t);return e?e.valid[1]-e.valid[0]:0}function _l(t,e){return Math.round(yl(t)/e)}const vl=function(){const t=R(),e=R(),i=[0,0,0];return function(n,s,a){Li(t,n,s),Ln(t,t),Li(e,n,a),Ln(e,e),Bo(i,t,e);let o=Math.acos(Wo(t,e)/(On(t)*On(e)))*sl;return i[2]<0&&(o=-o),isNaN(o)&&(o=0),o}}(),fl=function(){const t=R();return function(e,i,n,s){const a=e.targetGeometry;return se(e,i),pl(t,i,n,s),a.x+=t[0],a.y+=t[1],e}}(),Ui=function(t,e,i){se(t,e);const n=t.targetGeometry;return n.x=i.x,n.y=i.y,n.spatialReference=i.spatialReference,t},wl=function(){const t=R();return function(e,i,n,s,a){a||(a="center"),Ds(t,n,s),oi(t,t,.5);const o=t[0],l=t[1];switch(a){case"center":A(t,0,0);break;case"left":A(t,-o,0);break;case"top":A(t,0,l);break;case"right":A(t,o,0);break;case"bottom":A(t,0,-l);break;case"top-left":A(t,-o,l);break;case"bottom-left":A(t,-o,-l);break;case"top-right":A(t,o,l);break;case"bottom-right":A(t,o,-l)}return li(e,i,t),e}}();function yp(t,e,i){return se(t,e),t.rotation+=i,t}function bl(t,e,i){return se(t,e),t.rotation=i,t}const Tl=function(){const t=R();return function(e,i,n,s,a){return se(e,i),isNaN(n)||n===0||(ea(t,s,i,a),e.scale=i.scale*n,ta(t,t,e,a),li(e,e,A(t,t[0]-s[0],s[1]-t[1]))),e}}();function Qn(t,e,i){return se(t,e),t.scale=i,t}const Qs=function(){const t=R();return function(e,i,n,s,a,o){return se(e,i),isNaN(n)||n===0||(ea(t,a,i,o),e.scale=i.scale*n,e.rotation+=s,ta(t,t,e,o),li(e,e,A(t,t[0]-a[0],a[1]-t[1]))),e}}(),_p=function(){const t=R(),e=R();return function(i,n,s,a,o,l,c){return Js(e,l,c),Ko(t,o,e),a?Qs(i,n,s,a,t,l):Tl(i,n,s,t,l)}}(),ea=function(){const t=ze();return function(e,i,n,s){return de(e,i,cl(t,n,s,1))}}(),ta=function(){const t=ze();return function(e,i,n,s){return de(e,i,mn(t,n,s,1))}}(),li=function(){const t=R(),e=ze();return function(i,n,s){se(i,n);const a=ut(n),o=i.targetGeometry;return Uo(e,dn(n)),Es(e,e,Xo(a,a)),de(t,s,e),o.x+=t[0],o.y+=t[1],i}}();let kl=class{constructor(e,i,n,s){const a=e.targetGeometry,o=i.targetGeometry;s?typeof s=="string"&&(s=Fo(s)||Vi.ease):s=Vi.ease,this.easing=s,this.duration=n,this.sCenterX=a.x,this.sCenterY=a.y,this.sScale=e.scale,this.sRotation=e.rotation,this.tCenterX=o.x,this.tCenterY=o.y,this.tScale=i.scale,this.tRotation=i.rotation,this.dCenterX=this.tCenterX-this.sCenterX,this.dCenterY=this.tCenterY-this.sCenterY,this.dScale=this.tScale-this.sScale,this.dRotation=this.tRotation-this.sRotation,this.dRotation>180?this.dRotation-=360:this.dRotation<-180&&(this.dRotation+=360)}applyRatio(e,i){const n=this.easing(i);let s,a,o,l;i>=1?(s=this.tCenterX,a=this.tCenterY,o=this.tRotation,l=this.tScale):(s=this.sCenterX+n*this.dCenterX,a=this.sCenterY+n*this.dCenterY,o=this.sRotation+n*this.dRotation,l=this.sScale+n*this.dScale),e.targetGeometry.x=s,e.targetGeometry.y=a,e.scale=l,e.rotation=o}},be=class extends b{constructor(e){super(e),this.updateFunction=null,this.animation=null,this.duration=200,this.transition=null,this.easing=Vi.ease,this.view=null,this.viewpoint=new me({targetGeometry:new D,scale:0,rotation:0}),this._updateTask=dt({postRender:this._postRender.bind(this)}),this._updateTask.pause()}destroy(){this._updateTask=Me(this._updateTask)}animate(e,i,n){this.stop();const s=this.viewpoint;se(s,i),this.transition=new kl(this.viewpoint,e.target,(n==null?void 0:n.duration)||this.duration,(n==null?void 0:n.easing)||this.easing);const a=()=>{var o,l;this.animation===e&&this._updateTask&&(e.state==="finished"&&((o=this.transition)==null||o.applyRatio(this.viewpoint,1),(l=this.view)!=null&&l.state&&(this.view.state.viewpoint=this.viewpoint.clone())),this.animation=null,this.updateFunction=null)};return e.when(a,a),this._startTime=performance.now(),this._updateTask.resume(),this.animation=e,e}animateContinous(e,i){this.stop(),this.updateFunction=i,this.viewpoint=e;const n=new Fi({target:e.clone()}),s=()=>{this.animation===n&&this._updateTask&&(this.animation=null,this.updateFunction=null)};return n.when(s,s),this._startTime=performance.now(),this._updateTask.resume(),this.animation=n,n}stop(){this.animation&&(this.animation.stop(),this.animation=null,this.updateFunction=null)}_postRender(e){var n,s;const i=this.animation;if(i&&i.state!==Fi.State.STOPPED){if(this.updateFunction)this.updateFunction(this.viewpoint,e.deltaTime);else{const a=this.transition,o=(performance.now()-this._startTime)/a.duration,l=o>=1;a.applyRatio(this.viewpoint,o),l&&((n=this.animation)==null||n.finish())}(s=this.view)!=null&&s.state&&(this.view.state.viewpoint=this.viewpoint.clone())}else this._updateTask.pause()}};r([h()],be.prototype,"animation",void 0),r([h()],be.prototype,"duration",void 0),r([h()],be.prototype,"transition",void 0),r([h()],be.prototype,"easing",void 0),r([h()],be.prototype,"view",void 0),r([h()],be.prototype,"viewpoint",void 0),be=r([_("esri.views.2d.AnimationManager")],be);const Ml=be;let xl=class{constructor(e){this.view=e,this._stationaryHandle=null,this._frameTaskHandle=null,this._updateParameters=null,this._updateRequested=!1,this.stationary=!0,this.animationInProgress=!1,this.prepare=()=>{this._updateParameters&&(this._updateParameters.state=this.view.state,this._updateParameters.stationary=this.view.stationary,this._updateParameters.pixelRatio=window.devicePixelRatio,this._updateParameters.renderingOptions=this.view.renderingOptions)},this.update=()=>{var o,l;if(this._updateRequested=!1,(o=this.view)==null?void 0:o.destroyed)return;const{allLayerViews:i,graphicsView:n,labelManager:s,state:{id:a}}=this.view;i.forEach(this._updateLayerView,this),s!=null&&(s.lastUpdateId!==a&&(s.viewChange(),s.lastUpdateId=a),s.updateRequested&&s.processUpdate(this._updateParameters)),n!=null&&(n.lastUpdateId!==a&&(n.viewChange(),n.lastUpdateId=a),n.updateRequested&&n.processUpdate(this._updateParameters)),this.view.graphicsTileStore.setViewState(this._updateParameters.state),this.animationInProgress||this._updateRequested||((l=this._frameTaskHandle)==null||l.pause())}}destroy(){this.stop()}start(){if(this._frameTaskHandle)return;const e=this.view;this.stationary=e.stationary,this._updateParameters={state:e.state,pixelRatio:window.devicePixelRatio,stationary:this.stationary,renderingOptions:e.renderingOptions},this._stationaryHandle=f(()=>e.stationary,i=>{this.stationary=i,this.requestFrame()}),this._frameTaskHandle=dt(this),this.requestUpdate()}stop(){var e;this._frameTaskHandle&&(this._updateRequested=!1,(e=this._stationaryHandle)==null||e.remove(),this._frameTaskHandle.remove(),this._updateParameters=this._stationaryHandle=this._frameTaskHandle=null,this.stationary=!0,this.animationInProgress=!1)}requestUpdate(){this._updateRequested||(this._updateRequested=!0,this.requestFrame())}requestFrame(){this._frameTaskHandle&&this._frameTaskHandle.resume()}_updateLayerView(e){var s;if(!e.attached)return void this.requestUpdate();const i=this.view.state,n=e.lastUpdateId;n!=null&&(this.stationary||e.moving)||(e.moving=!0,e.moveStart()),n!==i.id&&e.viewChange(),this.stationary&&e.moving&&(e.moving=!1,e.moveEnd()),e.lastUpdateId=i.id,e.updateRequested&&e.processUpdate(this._updateParameters),"layerViews"in e&&((s=e.layerViews)==null||s.forEach(this._updateLayerView,this))}},Gt=class extends b{constructor(e){super(e),this._gotoTask=null}destroy(){this._gotoTask=null}async goTo(e,i){if(!e)return void T.getLogger(this).error("#goTo()","target cannot be null or undefined");this.view.animation&&(this.view.animation=null);const n=this._createAnimation();await ei(()=>this.view.ready,i);const s={animate:!0,...i},{extent:a,spatialReference:o,size:l,viewpoint:c,constraints:p,padding:u,allLayerViews:m}=this.view,d=ol(e,{extent:a,spatialReference:o,size:l,viewpoint:c,constraints:p,padding:u,allLayerViews:m,pickClosestTarget:(i==null?void 0:i.pickClosestTarget)??!0});return n==null||n.update(d),this._gotoTask={},s.animate?this._gotoAnimated(d,s):this._gotoImmediate(d,s)}_gotoImmediate(e,i){const n=this._gotoTask,s=this.view.animation,a=e.then(o=>{if(ue(i),n!==this._gotoTask)throw new P("view:goto-interrupted","Goto was interrupted");this.view.viewpoint=s.target=o,s.finish()});return this._cancellableGoTo(n,s,a)}_gotoAnimated(e,i){const n=this._gotoTask,s=this.view.animation;if(!s)return Promise.resolve();const a=e.then(o=>{if(ue(i),n!==this._gotoTask)throw new P("view:goto-interrupted","Goto was interrupted");return s.update(o),this.view.animationManager.animate(s,this.view.viewpoint,i),s.when().then(()=>{},()=>{})});return this._cancellableGoTo(n,s,a)}_createAnimation(){return this.view.animation&&!this.view.animation.done||(this.view.animation=new Fi),this.view.animation}_cancellableGoTo(e,i,n){const s=()=>e===this._gotoTask;return n.finally(()=>{s()&&(i.done||i.stop(),this.view.animation=null)})}};r([h({constructOnly:!0})],Gt.prototype,"view",void 0),Gt=r([_("esri.views.2d.GoToManager")],Gt);function $(){return Promise.all([w(()=>import("./webglDeps-600b65d5.js"),["./webglDeps-600b65d5.js","./FramebufferObject-f8937356.js","./uuid-fb53ae2e.js","./index-e42a63f9.js","./Texture-909bfb08.js","./capabilities-6261cefc.js","./enums-bdecffa2.js","./ProgramTemplate-12d63168.js","./commonjsHelpers-2f3e7994.js","./programUtils-351b494d.js","./NestedMap-1b5db22e.js"],import.meta.url),w(()=>import("./mapViewDeps-20d3fc4f.js"),["./mapViewDeps-20d3fc4f.js","./uuid-fb53ae2e.js","./index-e42a63f9.js","./signal-a61cc993.js","./mat3f32-6c416b1c.js","./ExpandedCIM-870ec490.js","./BidiEngine-9a40f2f4.js","./visualVariablesUtils-e6903ea9.js","./OptimizedFeature-ded94d90.js","./color-a4b304a5.js","./enums-f1a6a48a.js","./enums-bdecffa2.js","./VertexElementDescriptor-2925c6af.js","./definitions-d96ec118.js","./GeometryUtils-984e8446.js","./utils-d023eda3.js","./GeometryUtils-c1de866e.js","./mat2df32-b9bfc1f5.js","./vec2-aed931ac.js","./TileStore-6570f2cc.js","./workers-3c8ba252.js","./quickselect-149a6b43.js","./commonjsHelpers-2f3e7994.js","./QuantizationParameters-a323cbe3.js","./TileInfoView-be4d795d.js","./vec2f32-eaf29605.js","./Rect-ea14f53a.js","./quantizationUtils-7998a127.js","./floatRGBA-04143c6a.js","./imageUtils-cd1e4411.js","./Container-15ae821f.js","./parser-450a99c3.js","./mat4f32-60a2394b.js","./mat4-f091cc2b.js","./Texture-909bfb08.js","./capabilities-6261cefc.js","./BufferPool-f1313648.js","./AttributeStoreView-43278226.js","./mat3-1b291d2f.js","./TiledDisplayObject-097260a9.js","./diffUtils-7a67a389.js","./labelingInfo-144cafce.js","./LabelClass-03af2031.js","./labelUtils-f4e57b25.js","./layerUtils-a8920453.js","./defaultsJSON-b087dd4d.js","./jsonUtils-6741d81c.js","./WGLContainer-a031049d.js","./FramebufferObject-f8937356.js","./ProgramTemplate-12d63168.js","./heatmapUtils-c2569515.js","./vec4f64-3c9d0901.js","./StyleDefinition-29c49b98.js","./config-1337d16e.js","./earcut-b84353bc.js","./vec2f64-95bf678d.js","./featureConversionUtils-5ad02385.js","./OptimizedFeatureSet-1d1ac4b9.js","./clusterUtils-80867c68.js","./MD5-715f37cd.js","./SizeVariable-d8011d21.js","./colorRamps-18dfa72a.js","./LegendOptions-21ba0c6d.js","./compilerUtils-811a6f43.js","./lengthUtils-5d9bdf3f.js","./util-0cf8b7dd.js","./enums-fb086c25.js","./programUtils-351b494d.js","./NestedMap-1b5db22e.js","./MagnifierPrograms-83cf9dff.js","./rasterizingUtils-7a00076e.js","./pbf-0c5d1fff.js","./imageutils-8a04d22c.js","./Matcher-5cde60f7.js","./tileUtils-c2f19f52.js","./TurboLine-470e4fcd.js","./LRUCache-9b8f5520.js","./CircularArray-ef508845.js","./testSVGPremultipliedAlpha-ad111ba4.js","./throttle-7bf02de9.js","./ComputedAttributeStorage-1c26e0db.js","./FieldsIndex-406a2400.js","./TimeOnly-f07e8b54.js","./UpdatingHandles-9a53fef9.js","./RenderingContext-da2621c6.js","./OrderIndependentTransparency-6ae10952.js","./basicInterfaces-11f56cb3.js","./doublePrecisionUtils-e3c3d0d8.js","./GraphicsView2D-cf1235ce.js","./normalizeUtilsSync-20755c4d.js","./normalizeUtilsCommon-05ad6f6d.js","./projectionSupport-29174b46.js","./arcgisLayerUrl-fc2d909c.js","./json-48e3ea08.js","./normalizeUtils-a2b8b8b6.js","./GraphicContainer-6ae2ea3e.js","./BaseGraphicContainer-d8dd2bed.js","./FeatureContainer-7b9710d6.js","./TileContainer-a854d921.js","./vec3f32-2da9db36.js","./requestImageUtils-0e269fd5.js","./Basemap-fc4d26ee.js","./loadAll-76369e9a.js","./PortalItem-01395053.js","./writeUtils-3673b1a7.js","./CollectionFlattener-5cd5b172.js","./infoFor3D-24efd44a.js","./basemapUtils-0a6b5a56.js","./TablesMixin-2871072c.js","./Cyclical-8c26e7c7.js","./TileInfo-238dd4b6.js","./jsxFactory-8f2e778f.js","./GraphicsCollection-2966693c.js","./ViewingMode-fb6259a5.js","./unitBezier-881ac1eb.js","./GoTo-2cdac7e7.js"],import.meta.url)])}const gt=()=>$().then(()=>w(()=>import("./TileLayerView2D-f504c3f5.js"),["./TileLayerView2D-f504c3f5.js","./uuid-fb53ae2e.js","./index-e42a63f9.js","./GraphicsCollection-2966693c.js","./Container-15ae821f.js","./mat3f32-6c416b1c.js","./parser-450a99c3.js","./mat4f32-60a2394b.js","./mat4-f091cc2b.js","./definitions-d96ec118.js","./enums-bdecffa2.js","./Texture-909bfb08.js","./capabilities-6261cefc.js","./BufferPool-f1313648.js","./AttributeStoreView-43278226.js","./mat2df32-b9bfc1f5.js","./vec2-aed931ac.js","./TileStore-6570f2cc.js","./workers-3c8ba252.js","./signal-a61cc993.js","./quickselect-149a6b43.js","./commonjsHelpers-2f3e7994.js","./QuantizationParameters-a323cbe3.js","./TileInfoView-be4d795d.js","./mat3-1b291d2f.js","./TiledDisplayObject-097260a9.js","./diffUtils-7a67a389.js","./labelingInfo-144cafce.js","./LabelClass-03af2031.js","./labelUtils-f4e57b25.js","./layerUtils-a8920453.js","./defaultsJSON-b087dd4d.js","./jsonUtils-6741d81c.js","./color-a4b304a5.js","./enums-f1a6a48a.js","./VertexElementDescriptor-2925c6af.js","./WGLContainer-a031049d.js","./FramebufferObject-f8937356.js","./ProgramTemplate-12d63168.js","./GeometryUtils-c1de866e.js","./heatmapUtils-c2569515.js","./vec4f64-3c9d0901.js","./StyleDefinition-29c49b98.js","./vec2f32-eaf29605.js","./config-1337d16e.js","./earcut-b84353bc.js","./vec2f64-95bf678d.js","./featureConversionUtils-5ad02385.js","./OptimizedFeature-ded94d90.js","./OptimizedFeatureSet-1d1ac4b9.js","./visualVariablesUtils-e6903ea9.js","./ExpandedCIM-870ec490.js","./BidiEngine-9a40f2f4.js","./GeometryUtils-984e8446.js","./utils-d023eda3.js","./Rect-ea14f53a.js","./quantizationUtils-7998a127.js","./floatRGBA-04143c6a.js","./clusterUtils-80867c68.js","./MD5-715f37cd.js","./SizeVariable-d8011d21.js","./colorRamps-18dfa72a.js","./LegendOptions-21ba0c6d.js","./compilerUtils-811a6f43.js","./lengthUtils-5d9bdf3f.js","./util-0cf8b7dd.js","./enums-fb086c25.js","./MagnifierPrograms-83cf9dff.js","./rasterizingUtils-7a00076e.js","./pbf-0c5d1fff.js","./imageutils-8a04d22c.js","./Matcher-5cde60f7.js","./tileUtils-c2f19f52.js","./TurboLine-470e4fcd.js","./LRUCache-9b8f5520.js","./CircularArray-ef508845.js","./testSVGPremultipliedAlpha-ad111ba4.js","./throttle-7bf02de9.js","./ComputedAttributeStorage-1c26e0db.js","./FieldsIndex-406a2400.js","./TimeOnly-f07e8b54.js","./UpdatingHandles-9a53fef9.js","./OrderIndependentTransparency-6ae10952.js","./basicInterfaces-11f56cb3.js","./GraphicsView2D-cf1235ce.js","./normalizeUtilsSync-20755c4d.js","./normalizeUtilsCommon-05ad6f6d.js","./projectionSupport-29174b46.js","./arcgisLayerUrl-fc2d909c.js","./json-48e3ea08.js","./normalizeUtils-a2b8b8b6.js","./vec3f32-2da9db36.js","./imageUtils-932a49a3.js","./BitmapTileContainer-de805481.js","./Bitmap-f012754b.js","./TileContainer-a854d921.js","./LayerView-8590f61c.js","./scaleUtils-bba7f8bb.js","./HighlightGraphicContainer-5db5c709.js","./BaseGraphicContainer-d8dd2bed.js","./FeatureContainer-7b9710d6.js","./RefreshableLayerView-f354dee3.js","./drapedUtils-a4b2d4ef.js","./floorFilterUtils-080a7cd2.js","./sublayerUtils-9959f72e.js","./popupUtils-73dae124.js","./Basemap-fc4d26ee.js","./loadAll-76369e9a.js","./PortalItem-01395053.js","./writeUtils-3673b1a7.js","./CollectionFlattener-5cd5b172.js","./infoFor3D-24efd44a.js","./basemapUtils-0a6b5a56.js","./TablesMixin-2871072c.js","./Cyclical-8c26e7c7.js","./TileInfo-238dd4b6.js","./jsxFactory-8f2e778f.js","./ViewingMode-fb6259a5.js","./unitBezier-881ac1eb.js","./GoTo-2cdac7e7.js"],import.meta.url)),et=()=>$().then(()=>w(()=>import("./FeatureLayerView2D-6da362b5.js"),["./FeatureLayerView2D-6da362b5.js","./uuid-fb53ae2e.js","./index-e42a63f9.js","./Container-15ae821f.js","./mat3f32-6c416b1c.js","./parser-450a99c3.js","./mat4f32-60a2394b.js","./mat4-f091cc2b.js","./definitions-d96ec118.js","./enums-bdecffa2.js","./Texture-909bfb08.js","./capabilities-6261cefc.js","./FeatureEffect-3edf5c32.js","./jsonUtils-2946bd15.js","./arcgisLayerUrl-fc2d909c.js","./Query-56eb5454.js","./Field-2e745f35.js","./fieldType-5ce7d1ed.js","./FullTextSearch-92b839ce.js","./QuantizationParameters-a323cbe3.js","./layerUtils-a8920453.js","./FeatureSet-46acd907.js","./LayerView-8590f61c.js","./scaleUtils-bba7f8bb.js","./UpdatingHandles-9a53fef9.js","./AttributeStoreView-43278226.js","./mat2df32-b9bfc1f5.js","./vec2-aed931ac.js","./TileStore-6570f2cc.js","./workers-3c8ba252.js","./signal-a61cc993.js","./quickselect-149a6b43.js","./commonjsHelpers-2f3e7994.js","./TileInfoView-be4d795d.js","./mat3-1b291d2f.js","./TiledDisplayObject-097260a9.js","./diffUtils-7a67a389.js","./labelingInfo-144cafce.js","./LabelClass-03af2031.js","./labelUtils-f4e57b25.js","./defaultsJSON-b087dd4d.js","./jsonUtils-6741d81c.js","./color-a4b304a5.js","./enums-f1a6a48a.js","./VertexElementDescriptor-2925c6af.js","./WGLContainer-a031049d.js","./FramebufferObject-f8937356.js","./ProgramTemplate-12d63168.js","./GeometryUtils-c1de866e.js","./heatmapUtils-c2569515.js","./vec4f64-3c9d0901.js","./StyleDefinition-29c49b98.js","./vec2f32-eaf29605.js","./config-1337d16e.js","./earcut-b84353bc.js","./vec2f64-95bf678d.js","./featureConversionUtils-5ad02385.js","./OptimizedFeature-ded94d90.js","./OptimizedFeatureSet-1d1ac4b9.js","./visualVariablesUtils-e6903ea9.js","./ExpandedCIM-870ec490.js","./BidiEngine-9a40f2f4.js","./GeometryUtils-984e8446.js","./utils-d023eda3.js","./Rect-ea14f53a.js","./quantizationUtils-7998a127.js","./floatRGBA-04143c6a.js","./clusterUtils-80867c68.js","./MD5-715f37cd.js","./SizeVariable-d8011d21.js","./colorRamps-18dfa72a.js","./LegendOptions-21ba0c6d.js","./compilerUtils-811a6f43.js","./lengthUtils-5d9bdf3f.js","./util-0cf8b7dd.js","./BitmapTileContainer-de805481.js","./Bitmap-f012754b.js","./TileContainer-a854d921.js","./CircularArray-ef508845.js","./BufferPool-f1313648.js","./FeatureContainer-7b9710d6.js","./commonProperties-dc1396d3.js","./ElevationInfo-c9711b5d.js","./floorFilterUtils-080a7cd2.js","./popupUtils-73dae124.js","./RefreshableLayerView-f354dee3.js","./Basemap-fc4d26ee.js","./loadAll-76369e9a.js","./PortalItem-01395053.js","./writeUtils-3673b1a7.js","./CollectionFlattener-5cd5b172.js","./infoFor3D-24efd44a.js","./basemapUtils-0a6b5a56.js","./TablesMixin-2871072c.js","./Cyclical-8c26e7c7.js","./TileInfo-238dd4b6.js","./jsxFactory-8f2e778f.js","./GraphicsCollection-2966693c.js","./ViewingMode-fb6259a5.js","./unitBezier-881ac1eb.js","./normalizeUtils-a2b8b8b6.js","./normalizeUtilsCommon-05ad6f6d.js","./GoTo-2cdac7e7.js"],import.meta.url)),es={"base-dynamic":()=>$().then(()=>w(()=>import("./BaseDynamicLayerView2D-8f6d52b9.js"),["./BaseDynamicLayerView2D-8f6d52b9.js","./uuid-fb53ae2e.js","./index-e42a63f9.js","./BitmapContainer-f711c539.js","./WGLContainer-a031049d.js","./definitions-d96ec118.js","./FramebufferObject-f8937356.js","./Texture-909bfb08.js","./capabilities-6261cefc.js","./enums-bdecffa2.js","./ProgramTemplate-12d63168.js","./commonjsHelpers-2f3e7994.js","./VertexElementDescriptor-2925c6af.js","./color-a4b304a5.js","./enums-f1a6a48a.js","./GeometryUtils-c1de866e.js","./heatmapUtils-c2569515.js","./vec4f64-3c9d0901.js","./mat3f32-6c416b1c.js","./StyleDefinition-29c49b98.js","./vec2f32-eaf29605.js","./config-1337d16e.js","./Container-15ae821f.js","./parser-450a99c3.js","./mat4f32-60a2394b.js","./mat4-f091cc2b.js","./earcut-b84353bc.js","./vec2-aed931ac.js","./vec2f64-95bf678d.js","./featureConversionUtils-5ad02385.js","./OptimizedFeature-ded94d90.js","./OptimizedFeatureSet-1d1ac4b9.js","./LayerView-8590f61c.js","./scaleUtils-bba7f8bb.js","./UpdatingHandles-9a53fef9.js","./ExportStrategy-ceec4f3c.js","./TileInfo-238dd4b6.js","./Bitmap-f012754b.js","./mat3-1b291d2f.js","./TileInfoView-be4d795d.js","./RefreshableLayerView-f354dee3.js","./Basemap-fc4d26ee.js","./loadAll-76369e9a.js","./PortalItem-01395053.js","./writeUtils-3673b1a7.js","./layerUtils-a8920453.js","./compilerUtils-811a6f43.js","./CollectionFlattener-5cd5b172.js","./infoFor3D-24efd44a.js","./basemapUtils-0a6b5a56.js","./TablesMixin-2871072c.js","./arcgisLayerUrl-fc2d909c.js","./Cyclical-8c26e7c7.js","./workers-3c8ba252.js","./jsxFactory-8f2e778f.js","./signal-a61cc993.js","./GraphicsCollection-2966693c.js","./ViewingMode-fb6259a5.js","./unitBezier-881ac1eb.js","./mat2df32-b9bfc1f5.js","./TileStore-6570f2cc.js","./quickselect-149a6b43.js","./QuantizationParameters-a323cbe3.js","./normalizeUtils-a2b8b8b6.js","./normalizeUtilsCommon-05ad6f6d.js","./GoTo-2cdac7e7.js"],import.meta.url)),"base-tile":gt,"bing-maps":gt,csv:et,"geo-rss":()=>$().then(()=>w(()=>import("./GeoRSSLayerView2D-9464a3d4.js"),["./GeoRSSLayerView2D-9464a3d4.js","./uuid-fb53ae2e.js","./index-e42a63f9.js","./jsonUtils-ca31df3a.js","./UniqueValueRenderer-eeb3ca28.js","./LegendOptions-21ba0c6d.js","./diffUtils-7a67a389.js","./SizeVariable-d8011d21.js","./colorRamps-18dfa72a.js","./compilerUtils-811a6f43.js","./lengthUtils-5d9bdf3f.js","./ColorStop-4bfca0a7.js","./jsonUtils-6741d81c.js","./layerUtils-a8920453.js","./styleUtils-957365ee.js","./DictionaryLoader-153eea1f.js","./LRUCache-9b8f5520.js","./FieldsIndex-406a2400.js","./heatmapUtils-c2569515.js","./vec4f64-3c9d0901.js","./FeatureSet-46acd907.js","./Field-2e745f35.js","./fieldType-5ce7d1ed.js","./LayerView-8590f61c.js","./scaleUtils-bba7f8bb.js","./Container-15ae821f.js","./mat3f32-6c416b1c.js","./parser-450a99c3.js","./mat4f32-60a2394b.js","./mat4-f091cc2b.js","./definitions-d96ec118.js","./enums-bdecffa2.js","./Texture-909bfb08.js","./capabilities-6261cefc.js","./UpdatingHandles-9a53fef9.js","./GraphicContainer-6ae2ea3e.js","./color-a4b304a5.js","./enums-f1a6a48a.js","./VertexElementDescriptor-2925c6af.js","./BaseGraphicContainer-d8dd2bed.js","./FeatureContainer-7b9710d6.js","./workers-3c8ba252.js","./AttributeStoreView-43278226.js","./mat2df32-b9bfc1f5.js","./vec2-aed931ac.js","./TileStore-6570f2cc.js","./signal-a61cc993.js","./quickselect-149a6b43.js","./commonjsHelpers-2f3e7994.js","./QuantizationParameters-a323cbe3.js","./TileInfoView-be4d795d.js","./mat3-1b291d2f.js","./TiledDisplayObject-097260a9.js","./labelingInfo-144cafce.js","./LabelClass-03af2031.js","./labelUtils-f4e57b25.js","./defaultsJSON-b087dd4d.js","./WGLContainer-a031049d.js","./FramebufferObject-f8937356.js","./ProgramTemplate-12d63168.js","./GeometryUtils-c1de866e.js","./StyleDefinition-29c49b98.js","./vec2f32-eaf29605.js","./config-1337d16e.js","./earcut-b84353bc.js","./vec2f64-95bf678d.js","./featureConversionUtils-5ad02385.js","./OptimizedFeature-ded94d90.js","./OptimizedFeatureSet-1d1ac4b9.js","./visualVariablesUtils-e6903ea9.js","./ExpandedCIM-870ec490.js","./BidiEngine-9a40f2f4.js","./GeometryUtils-984e8446.js","./utils-d023eda3.js","./Rect-ea14f53a.js","./quantizationUtils-7998a127.js","./floatRGBA-04143c6a.js","./clusterUtils-80867c68.js","./MD5-715f37cd.js","./util-0cf8b7dd.js","./TileContainer-a854d921.js","./vec3f32-2da9db36.js","./normalizeUtils-a2b8b8b6.js","./normalizeUtilsCommon-05ad6f6d.js","./GraphicsView2D-cf1235ce.js","./normalizeUtilsSync-20755c4d.js","./projectionSupport-29174b46.js","./arcgisLayerUrl-fc2d909c.js","./json-48e3ea08.js","./Matcher-5cde60f7.js","./tileUtils-c2f19f52.js","./TurboLine-470e4fcd.js","./ComputedAttributeStorage-1c26e0db.js","./TimeOnly-f07e8b54.js","./Basemap-fc4d26ee.js","./loadAll-76369e9a.js","./PortalItem-01395053.js","./writeUtils-3673b1a7.js","./CollectionFlattener-5cd5b172.js","./infoFor3D-24efd44a.js","./basemapUtils-0a6b5a56.js","./TablesMixin-2871072c.js","./Cyclical-8c26e7c7.js","./TileInfo-238dd4b6.js","./jsxFactory-8f2e778f.js","./GraphicsCollection-2966693c.js","./ViewingMode-fb6259a5.js","./unitBezier-881ac1eb.js","./GoTo-2cdac7e7.js"],import.meta.url)),feature:et,geojson:et,graphics:()=>$().then(()=>w(()=>import("./GraphicsLayerView2D-45163f0c.js"),["./GraphicsLayerView2D-45163f0c.js","./uuid-fb53ae2e.js","./index-e42a63f9.js","./LayerView-8590f61c.js","./scaleUtils-bba7f8bb.js","./Container-15ae821f.js","./mat3f32-6c416b1c.js","./parser-450a99c3.js","./mat4f32-60a2394b.js","./mat4-f091cc2b.js","./definitions-d96ec118.js","./enums-bdecffa2.js","./Texture-909bfb08.js","./capabilities-6261cefc.js","./UpdatingHandles-9a53fef9.js","./GraphicContainer-6ae2ea3e.js","./color-a4b304a5.js","./enums-f1a6a48a.js","./VertexElementDescriptor-2925c6af.js","./BaseGraphicContainer-d8dd2bed.js","./FeatureContainer-7b9710d6.js","./workers-3c8ba252.js","./AttributeStoreView-43278226.js","./mat2df32-b9bfc1f5.js","./vec2-aed931ac.js","./TileStore-6570f2cc.js","./signal-a61cc993.js","./quickselect-149a6b43.js","./commonjsHelpers-2f3e7994.js","./QuantizationParameters-a323cbe3.js","./TileInfoView-be4d795d.js","./mat3-1b291d2f.js","./TiledDisplayObject-097260a9.js","./diffUtils-7a67a389.js","./labelingInfo-144cafce.js","./LabelClass-03af2031.js","./labelUtils-f4e57b25.js","./layerUtils-a8920453.js","./defaultsJSON-b087dd4d.js","./jsonUtils-6741d81c.js","./WGLContainer-a031049d.js","./FramebufferObject-f8937356.js","./ProgramTemplate-12d63168.js","./GeometryUtils-c1de866e.js","./heatmapUtils-c2569515.js","./vec4f64-3c9d0901.js","./StyleDefinition-29c49b98.js","./vec2f32-eaf29605.js","./config-1337d16e.js","./earcut-b84353bc.js","./vec2f64-95bf678d.js","./featureConversionUtils-5ad02385.js","./OptimizedFeature-ded94d90.js","./OptimizedFeatureSet-1d1ac4b9.js","./visualVariablesUtils-e6903ea9.js","./ExpandedCIM-870ec490.js","./BidiEngine-9a40f2f4.js","./GeometryUtils-984e8446.js","./utils-d023eda3.js","./Rect-ea14f53a.js","./quantizationUtils-7998a127.js","./floatRGBA-04143c6a.js","./clusterUtils-80867c68.js","./MD5-715f37cd.js","./SizeVariable-d8011d21.js","./colorRamps-18dfa72a.js","./LegendOptions-21ba0c6d.js","./compilerUtils-811a6f43.js","./lengthUtils-5d9bdf3f.js","./util-0cf8b7dd.js","./TileContainer-a854d921.js","./vec3f32-2da9db36.js","./normalizeUtils-a2b8b8b6.js","./normalizeUtilsCommon-05ad6f6d.js","./GraphicsView2D-cf1235ce.js","./normalizeUtilsSync-20755c4d.js","./projectionSupport-29174b46.js","./arcgisLayerUrl-fc2d909c.js","./json-48e3ea08.js","./Matcher-5cde60f7.js","./tileUtils-c2f19f52.js","./TurboLine-470e4fcd.js","./LRUCache-9b8f5520.js","./ComputedAttributeStorage-1c26e0db.js","./FieldsIndex-406a2400.js","./TimeOnly-f07e8b54.js","./Basemap-fc4d26ee.js","./loadAll-76369e9a.js","./PortalItem-01395053.js","./writeUtils-3673b1a7.js","./CollectionFlattener-5cd5b172.js","./infoFor3D-24efd44a.js","./basemapUtils-0a6b5a56.js","./TablesMixin-2871072c.js","./Cyclical-8c26e7c7.js","./TileInfo-238dd4b6.js","./jsxFactory-8f2e778f.js","./GraphicsCollection-2966693c.js","./ViewingMode-fb6259a5.js","./unitBezier-881ac1eb.js","./GoTo-2cdac7e7.js"],import.meta.url)),group:()=>$().then(()=>w(()=>import("./GroupLayerView2D-03a821f3.js"),["./GroupLayerView2D-03a821f3.js","./uuid-fb53ae2e.js","./index-e42a63f9.js","./LayerView-8590f61c.js","./scaleUtils-bba7f8bb.js","./Container-15ae821f.js","./mat3f32-6c416b1c.js","./parser-450a99c3.js","./mat4f32-60a2394b.js","./mat4-f091cc2b.js","./definitions-d96ec118.js","./enums-bdecffa2.js","./Texture-909bfb08.js","./capabilities-6261cefc.js","./UpdatingHandles-9a53fef9.js","./Basemap-fc4d26ee.js","./loadAll-76369e9a.js","./PortalItem-01395053.js","./writeUtils-3673b1a7.js","./layerUtils-a8920453.js","./compilerUtils-811a6f43.js","./CollectionFlattener-5cd5b172.js","./infoFor3D-24efd44a.js","./basemapUtils-0a6b5a56.js","./TablesMixin-2871072c.js","./arcgisLayerUrl-fc2d909c.js","./Cyclical-8c26e7c7.js","./workers-3c8ba252.js","./TileInfo-238dd4b6.js","./jsxFactory-8f2e778f.js","./signal-a61cc993.js","./GraphicsCollection-2966693c.js","./ViewingMode-fb6259a5.js","./unitBezier-881ac1eb.js","./mat2df32-b9bfc1f5.js","./vec2-aed931ac.js","./TileStore-6570f2cc.js","./quickselect-149a6b43.js","./commonjsHelpers-2f3e7994.js","./QuantizationParameters-a323cbe3.js","./TileInfoView-be4d795d.js","./vec2f64-95bf678d.js","./normalizeUtils-a2b8b8b6.js","./normalizeUtilsCommon-05ad6f6d.js","./mat3-1b291d2f.js","./vec2f32-eaf29605.js","./GoTo-2cdac7e7.js"],import.meta.url)),imagery:()=>$().then(()=>w(()=>import("./ImageryLayerView2D-edbc7f6b.js"),["./ImageryLayerView2D-edbc7f6b.js","./uuid-fb53ae2e.js","./index-e42a63f9.js","./GraphicsCollection-2966693c.js","./RasterVFDisplayObject-372095ec.js","./FramebufferObject-f8937356.js","./Texture-909bfb08.js","./capabilities-6261cefc.js","./enums-bdecffa2.js","./ProgramTemplate-12d63168.js","./commonjsHelpers-2f3e7994.js","./VertexElementDescriptor-2925c6af.js","./dataUtils-e8a4f0ad.js","./mat3f32-6c416b1c.js","./WGLContainer-a031049d.js","./definitions-d96ec118.js","./color-a4b304a5.js","./enums-f1a6a48a.js","./GeometryUtils-c1de866e.js","./heatmapUtils-c2569515.js","./vec4f64-3c9d0901.js","./StyleDefinition-29c49b98.js","./vec2f32-eaf29605.js","./config-1337d16e.js","./Container-15ae821f.js","./parser-450a99c3.js","./mat4f32-60a2394b.js","./mat4-f091cc2b.js","./earcut-b84353bc.js","./vec2-aed931ac.js","./vec2f64-95bf678d.js","./featureConversionUtils-5ad02385.js","./OptimizedFeature-ded94d90.js","./OptimizedFeatureSet-1d1ac4b9.js","./mat3-1b291d2f.js","./LayerView-8590f61c.js","./scaleUtils-bba7f8bb.js","./UpdatingHandles-9a53fef9.js","./GraphicsView2D-cf1235ce.js","./ExpandedCIM-870ec490.js","./BidiEngine-9a40f2f4.js","./visualVariablesUtils-e6903ea9.js","./GeometryUtils-984e8446.js","./utils-d023eda3.js","./mat2df32-b9bfc1f5.js","./TileStore-6570f2cc.js","./workers-3c8ba252.js","./signal-a61cc993.js","./quickselect-149a6b43.js","./QuantizationParameters-a323cbe3.js","./TileInfoView-be4d795d.js","./Rect-ea14f53a.js","./quantizationUtils-7998a127.js","./floatRGBA-04143c6a.js","./normalizeUtilsSync-20755c4d.js","./normalizeUtilsCommon-05ad6f6d.js","./projectionSupport-29174b46.js","./arcgisLayerUrl-fc2d909c.js","./json-48e3ea08.js","./LabelClass-03af2031.js","./labelUtils-f4e57b25.js","./layerUtils-a8920453.js","./defaultsJSON-b087dd4d.js","./jsonUtils-6741d81c.js","./AttributeStoreView-43278226.js","./TiledDisplayObject-097260a9.js","./diffUtils-7a67a389.js","./labelingInfo-144cafce.js","./clusterUtils-80867c68.js","./MD5-715f37cd.js","./SizeVariable-d8011d21.js","./colorRamps-18dfa72a.js","./LegendOptions-21ba0c6d.js","./compilerUtils-811a6f43.js","./lengthUtils-5d9bdf3f.js","./util-0cf8b7dd.js","./Matcher-5cde60f7.js","./tileUtils-c2f19f52.js","./TurboLine-470e4fcd.js","./LRUCache-9b8f5520.js","./ComputedAttributeStorage-1c26e0db.js","./FieldsIndex-406a2400.js","./TimeOnly-f07e8b54.js","./normalizeUtils-a2b8b8b6.js","./HighlightGraphicContainer-5db5c709.js","./BaseGraphicContainer-d8dd2bed.js","./FeatureContainer-7b9710d6.js","./TileContainer-a854d921.js","./vec3f32-2da9db36.js","./BitmapContainer-f711c539.js","./Bitmap-f012754b.js","./ExportStrategy-ceec4f3c.js","./TileInfo-238dd4b6.js","./rasterProjectionHelper-003ea8ea.js","./commonProperties-dc1396d3.js","./ElevationInfo-c9711b5d.js","./Query-56eb5454.js","./Field-2e745f35.js","./fieldType-5ce7d1ed.js","./FullTextSearch-92b839ce.js","./popupUtils-73dae124.js","./RefreshableLayerView-f354dee3.js","./Basemap-fc4d26ee.js","./loadAll-76369e9a.js","./PortalItem-01395053.js","./writeUtils-3673b1a7.js","./CollectionFlattener-5cd5b172.js","./infoFor3D-24efd44a.js","./basemapUtils-0a6b5a56.js","./TablesMixin-2871072c.js","./Cyclical-8c26e7c7.js","./jsxFactory-8f2e778f.js","./ViewingMode-fb6259a5.js","./unitBezier-881ac1eb.js","./GoTo-2cdac7e7.js"],import.meta.url)),"imagery-tile":()=>$().then(()=>w(()=>import("./ImageryTileLayerView2D-34d7a691.js"),["./ImageryTileLayerView2D-34d7a691.js","./uuid-fb53ae2e.js","./index-e42a63f9.js","./multidimensionalUtils-f2e9d7de.js","./RasterVFDisplayObject-372095ec.js","./FramebufferObject-f8937356.js","./Texture-909bfb08.js","./capabilities-6261cefc.js","./enums-bdecffa2.js","./ProgramTemplate-12d63168.js","./commonjsHelpers-2f3e7994.js","./VertexElementDescriptor-2925c6af.js","./dataUtils-e8a4f0ad.js","./mat3f32-6c416b1c.js","./WGLContainer-a031049d.js","./definitions-d96ec118.js","./color-a4b304a5.js","./enums-f1a6a48a.js","./GeometryUtils-c1de866e.js","./heatmapUtils-c2569515.js","./vec4f64-3c9d0901.js","./StyleDefinition-29c49b98.js","./vec2f32-eaf29605.js","./config-1337d16e.js","./Container-15ae821f.js","./parser-450a99c3.js","./mat4f32-60a2394b.js","./mat4-f091cc2b.js","./earcut-b84353bc.js","./vec2-aed931ac.js","./vec2f64-95bf678d.js","./featureConversionUtils-5ad02385.js","./OptimizedFeature-ded94d90.js","./OptimizedFeatureSet-1d1ac4b9.js","./mat3-1b291d2f.js","./LayerView-8590f61c.js","./scaleUtils-bba7f8bb.js","./UpdatingHandles-9a53fef9.js","./rasterUtils-4731e2fe.js","./TiledDisplayObject-097260a9.js","./TileInfoView-be4d795d.js","./TileContainer-a854d921.js","./TileInfo-238dd4b6.js","./RawBlockCache-928cb705.js","./rasterProjectionHelper-003ea8ea.js","./arcgisLayerUrl-fc2d909c.js","./mat2df32-b9bfc1f5.js","./TileStore-6570f2cc.js","./workers-3c8ba252.js","./signal-a61cc993.js","./quickselect-149a6b43.js","./QuantizationParameters-a323cbe3.js","./util-0cf8b7dd.js","./commonProperties-dc1396d3.js","./ElevationInfo-c9711b5d.js","./lengthUtils-5d9bdf3f.js","./popupUtils-73dae124.js","./RefreshableLayerView-f354dee3.js","./Basemap-fc4d26ee.js","./loadAll-76369e9a.js","./PortalItem-01395053.js","./writeUtils-3673b1a7.js","./layerUtils-a8920453.js","./compilerUtils-811a6f43.js","./CollectionFlattener-5cd5b172.js","./infoFor3D-24efd44a.js","./basemapUtils-0a6b5a56.js","./TablesMixin-2871072c.js","./Cyclical-8c26e7c7.js","./jsxFactory-8f2e778f.js","./GraphicsCollection-2966693c.js","./ViewingMode-fb6259a5.js","./unitBezier-881ac1eb.js","./normalizeUtils-a2b8b8b6.js","./normalizeUtilsCommon-05ad6f6d.js","./GoTo-2cdac7e7.js"],import.meta.url)),kml:()=>$().then(()=>w(()=>import("./KMLLayerView2D-105e349a.js"),["./KMLLayerView2D-105e349a.js","./uuid-fb53ae2e.js","./index-e42a63f9.js","./arcgisLayerUrl-fc2d909c.js","./kmlUtils-c7731380.js","./jsonUtils-ca31df3a.js","./UniqueValueRenderer-eeb3ca28.js","./LegendOptions-21ba0c6d.js","./diffUtils-7a67a389.js","./SizeVariable-d8011d21.js","./colorRamps-18dfa72a.js","./compilerUtils-811a6f43.js","./lengthUtils-5d9bdf3f.js","./ColorStop-4bfca0a7.js","./jsonUtils-6741d81c.js","./layerUtils-a8920453.js","./styleUtils-957365ee.js","./DictionaryLoader-153eea1f.js","./LRUCache-9b8f5520.js","./FieldsIndex-406a2400.js","./heatmapUtils-c2569515.js","./vec4f64-3c9d0901.js","./FeatureSet-46acd907.js","./Field-2e745f35.js","./fieldType-5ce7d1ed.js","./GraphicsCollection-2966693c.js","./Bitmap-f012754b.js","./mat3-1b291d2f.js","./mat3f32-6c416b1c.js","./vec2f32-eaf29605.js","./Container-15ae821f.js","./parser-450a99c3.js","./mat4f32-60a2394b.js","./mat4-f091cc2b.js","./definitions-d96ec118.js","./enums-bdecffa2.js","./Texture-909bfb08.js","./capabilities-6261cefc.js","./BitmapContainer-f711c539.js","./WGLContainer-a031049d.js","./FramebufferObject-f8937356.js","./ProgramTemplate-12d63168.js","./commonjsHelpers-2f3e7994.js","./VertexElementDescriptor-2925c6af.js","./color-a4b304a5.js","./enums-f1a6a48a.js","./GeometryUtils-c1de866e.js","./StyleDefinition-29c49b98.js","./config-1337d16e.js","./earcut-b84353bc.js","./vec2-aed931ac.js","./vec2f64-95bf678d.js","./featureConversionUtils-5ad02385.js","./OptimizedFeature-ded94d90.js","./OptimizedFeatureSet-1d1ac4b9.js","./LayerView-8590f61c.js","./scaleUtils-bba7f8bb.js","./UpdatingHandles-9a53fef9.js","./GraphicContainer-6ae2ea3e.js","./BaseGraphicContainer-d8dd2bed.js","./FeatureContainer-7b9710d6.js","./workers-3c8ba252.js","./AttributeStoreView-43278226.js","./mat2df32-b9bfc1f5.js","./TileStore-6570f2cc.js","./signal-a61cc993.js","./quickselect-149a6b43.js","./QuantizationParameters-a323cbe3.js","./TileInfoView-be4d795d.js","./TiledDisplayObject-097260a9.js","./labelingInfo-144cafce.js","./LabelClass-03af2031.js","./labelUtils-f4e57b25.js","./defaultsJSON-b087dd4d.js","./visualVariablesUtils-e6903ea9.js","./ExpandedCIM-870ec490.js","./BidiEngine-9a40f2f4.js","./GeometryUtils-984e8446.js","./utils-d023eda3.js","./Rect-ea14f53a.js","./quantizationUtils-7998a127.js","./floatRGBA-04143c6a.js","./clusterUtils-80867c68.js","./MD5-715f37cd.js","./util-0cf8b7dd.js","./TileContainer-a854d921.js","./vec3f32-2da9db36.js","./normalizeUtils-a2b8b8b6.js","./normalizeUtilsCommon-05ad6f6d.js","./GraphicsView2D-cf1235ce.js","./normalizeUtilsSync-20755c4d.js","./projectionSupport-29174b46.js","./json-48e3ea08.js","./Matcher-5cde60f7.js","./tileUtils-c2f19f52.js","./TurboLine-470e4fcd.js","./ComputedAttributeStorage-1c26e0db.js","./TimeOnly-f07e8b54.js","./rasterProjectionHelper-003ea8ea.js","./RenderingContext-da2621c6.js","./programUtils-351b494d.js","./NestedMap-1b5db22e.js","./OrderIndependentTransparency-6ae10952.js","./basicInterfaces-11f56cb3.js","./testSVGPremultipliedAlpha-ad111ba4.js","./doublePrecisionUtils-e3c3d0d8.js","./rasterUtils-4731e2fe.js","./Basemap-fc4d26ee.js","./loadAll-76369e9a.js","./PortalItem-01395053.js","./writeUtils-3673b1a7.js","./CollectionFlattener-5cd5b172.js","./infoFor3D-24efd44a.js","./basemapUtils-0a6b5a56.js","./TablesMixin-2871072c.js","./Cyclical-8c26e7c7.js","./TileInfo-238dd4b6.js","./jsxFactory-8f2e778f.js","./ViewingMode-fb6259a5.js","./unitBezier-881ac1eb.js","./GoTo-2cdac7e7.js"],import.meta.url)),"knowledge-graph":()=>$().then(()=>w(()=>import("./KnowledgeGraphLayerView2D-f8195b68.js"),["./KnowledgeGraphLayerView2D-f8195b68.js","./uuid-fb53ae2e.js","./index-e42a63f9.js","./LayerView-8590f61c.js","./scaleUtils-bba7f8bb.js","./Container-15ae821f.js","./mat3f32-6c416b1c.js","./parser-450a99c3.js","./mat4f32-60a2394b.js","./mat4-f091cc2b.js","./definitions-d96ec118.js","./enums-bdecffa2.js","./Texture-909bfb08.js","./capabilities-6261cefc.js","./UpdatingHandles-9a53fef9.js","./Basemap-fc4d26ee.js","./loadAll-76369e9a.js","./PortalItem-01395053.js","./writeUtils-3673b1a7.js","./layerUtils-a8920453.js","./compilerUtils-811a6f43.js","./CollectionFlattener-5cd5b172.js","./infoFor3D-24efd44a.js","./basemapUtils-0a6b5a56.js","./TablesMixin-2871072c.js","./arcgisLayerUrl-fc2d909c.js","./Cyclical-8c26e7c7.js","./workers-3c8ba252.js","./TileInfo-238dd4b6.js","./jsxFactory-8f2e778f.js","./signal-a61cc993.js","./GraphicsCollection-2966693c.js","./ViewingMode-fb6259a5.js","./unitBezier-881ac1eb.js","./mat2df32-b9bfc1f5.js","./vec2-aed931ac.js","./TileStore-6570f2cc.js","./quickselect-149a6b43.js","./commonjsHelpers-2f3e7994.js","./QuantizationParameters-a323cbe3.js","./TileInfoView-be4d795d.js","./vec2f64-95bf678d.js","./normalizeUtils-a2b8b8b6.js","./normalizeUtilsCommon-05ad6f6d.js","./mat3-1b291d2f.js","./vec2f32-eaf29605.js","./GoTo-2cdac7e7.js"],import.meta.url)),"link-chart":()=>$().then(()=>w(()=>import("./KnowledgeGraphLayerView2D-f8195b68.js"),["./KnowledgeGraphLayerView2D-f8195b68.js","./uuid-fb53ae2e.js","./index-e42a63f9.js","./LayerView-8590f61c.js","./scaleUtils-bba7f8bb.js","./Container-15ae821f.js","./mat3f32-6c416b1c.js","./parser-450a99c3.js","./mat4f32-60a2394b.js","./mat4-f091cc2b.js","./definitions-d96ec118.js","./enums-bdecffa2.js","./Texture-909bfb08.js","./capabilities-6261cefc.js","./UpdatingHandles-9a53fef9.js","./Basemap-fc4d26ee.js","./loadAll-76369e9a.js","./PortalItem-01395053.js","./writeUtils-3673b1a7.js","./layerUtils-a8920453.js","./compilerUtils-811a6f43.js","./CollectionFlattener-5cd5b172.js","./infoFor3D-24efd44a.js","./basemapUtils-0a6b5a56.js","./TablesMixin-2871072c.js","./arcgisLayerUrl-fc2d909c.js","./Cyclical-8c26e7c7.js","./workers-3c8ba252.js","./TileInfo-238dd4b6.js","./jsxFactory-8f2e778f.js","./signal-a61cc993.js","./GraphicsCollection-2966693c.js","./ViewingMode-fb6259a5.js","./unitBezier-881ac1eb.js","./mat2df32-b9bfc1f5.js","./vec2-aed931ac.js","./TileStore-6570f2cc.js","./quickselect-149a6b43.js","./commonjsHelpers-2f3e7994.js","./QuantizationParameters-a323cbe3.js","./TileInfoView-be4d795d.js","./vec2f64-95bf678d.js","./normalizeUtils-a2b8b8b6.js","./normalizeUtilsCommon-05ad6f6d.js","./mat3-1b291d2f.js","./vec2f32-eaf29605.js","./GoTo-2cdac7e7.js"],import.meta.url)),"knowledge-graph-sublayer":et,"map-image":()=>$().then(()=>w(()=>import("./MapImageLayerView2D-dfbf7b9f.js"),["./MapImageLayerView2D-dfbf7b9f.js","./uuid-fb53ae2e.js","./index-e42a63f9.js","./GraphicsCollection-2966693c.js","./BitmapContainer-f711c539.js","./WGLContainer-a031049d.js","./definitions-d96ec118.js","./FramebufferObject-f8937356.js","./Texture-909bfb08.js","./capabilities-6261cefc.js","./enums-bdecffa2.js","./ProgramTemplate-12d63168.js","./commonjsHelpers-2f3e7994.js","./VertexElementDescriptor-2925c6af.js","./color-a4b304a5.js","./enums-f1a6a48a.js","./GeometryUtils-c1de866e.js","./heatmapUtils-c2569515.js","./vec4f64-3c9d0901.js","./mat3f32-6c416b1c.js","./StyleDefinition-29c49b98.js","./vec2f32-eaf29605.js","./config-1337d16e.js","./Container-15ae821f.js","./parser-450a99c3.js","./mat4f32-60a2394b.js","./mat4-f091cc2b.js","./earcut-b84353bc.js","./vec2-aed931ac.js","./vec2f64-95bf678d.js","./featureConversionUtils-5ad02385.js","./OptimizedFeature-ded94d90.js","./OptimizedFeatureSet-1d1ac4b9.js","./LayerView-8590f61c.js","./scaleUtils-bba7f8bb.js","./UpdatingHandles-9a53fef9.js","./GraphicsView2D-cf1235ce.js","./ExpandedCIM-870ec490.js","./BidiEngine-9a40f2f4.js","./visualVariablesUtils-e6903ea9.js","./GeometryUtils-984e8446.js","./utils-d023eda3.js","./mat2df32-b9bfc1f5.js","./TileStore-6570f2cc.js","./workers-3c8ba252.js","./signal-a61cc993.js","./quickselect-149a6b43.js","./QuantizationParameters-a323cbe3.js","./TileInfoView-be4d795d.js","./Rect-ea14f53a.js","./quantizationUtils-7998a127.js","./floatRGBA-04143c6a.js","./normalizeUtilsSync-20755c4d.js","./normalizeUtilsCommon-05ad6f6d.js","./projectionSupport-29174b46.js","./arcgisLayerUrl-fc2d909c.js","./json-48e3ea08.js","./LabelClass-03af2031.js","./labelUtils-f4e57b25.js","./layerUtils-a8920453.js","./defaultsJSON-b087dd4d.js","./jsonUtils-6741d81c.js","./AttributeStoreView-43278226.js","./mat3-1b291d2f.js","./TiledDisplayObject-097260a9.js","./diffUtils-7a67a389.js","./labelingInfo-144cafce.js","./clusterUtils-80867c68.js","./MD5-715f37cd.js","./SizeVariable-d8011d21.js","./colorRamps-18dfa72a.js","./LegendOptions-21ba0c6d.js","./compilerUtils-811a6f43.js","./lengthUtils-5d9bdf3f.js","./util-0cf8b7dd.js","./Matcher-5cde60f7.js","./tileUtils-c2f19f52.js","./TurboLine-470e4fcd.js","./LRUCache-9b8f5520.js","./ComputedAttributeStorage-1c26e0db.js","./FieldsIndex-406a2400.js","./TimeOnly-f07e8b54.js","./normalizeUtils-a2b8b8b6.js","./HighlightGraphicContainer-5db5c709.js","./BaseGraphicContainer-d8dd2bed.js","./FeatureContainer-7b9710d6.js","./TileContainer-a854d921.js","./vec3f32-2da9db36.js","./ExportStrategy-ceec4f3c.js","./TileInfo-238dd4b6.js","./Bitmap-f012754b.js","./commonProperties-dc1396d3.js","./ElevationInfo-c9711b5d.js","./ExportImageParameters-cc2e5e57.js","./floorFilterUtils-080a7cd2.js","./sublayerUtils-9959f72e.js","./RefreshableLayerView-f354dee3.js","./drapedUtils-a4b2d4ef.js","./popupUtils-73dae124.js","./Basemap-fc4d26ee.js","./loadAll-76369e9a.js","./PortalItem-01395053.js","./writeUtils-3673b1a7.js","./CollectionFlattener-5cd5b172.js","./infoFor3D-24efd44a.js","./basemapUtils-0a6b5a56.js","./TablesMixin-2871072c.js","./Cyclical-8c26e7c7.js","./jsxFactory-8f2e778f.js","./ViewingMode-fb6259a5.js","./unitBezier-881ac1eb.js","./GoTo-2cdac7e7.js"],import.meta.url)),"map-notes":()=>$().then(()=>w(()=>import("./MapNotesLayerView2D-b6623a35.js"),["./MapNotesLayerView2D-b6623a35.js","./uuid-fb53ae2e.js","./index-e42a63f9.js","./LayerView-8590f61c.js","./scaleUtils-bba7f8bb.js","./Container-15ae821f.js","./mat3f32-6c416b1c.js","./parser-450a99c3.js","./mat4f32-60a2394b.js","./mat4-f091cc2b.js","./definitions-d96ec118.js","./enums-bdecffa2.js","./Texture-909bfb08.js","./capabilities-6261cefc.js","./UpdatingHandles-9a53fef9.js","./GraphicContainer-6ae2ea3e.js","./color-a4b304a5.js","./enums-f1a6a48a.js","./VertexElementDescriptor-2925c6af.js","./BaseGraphicContainer-d8dd2bed.js","./FeatureContainer-7b9710d6.js","./workers-3c8ba252.js","./AttributeStoreView-43278226.js","./mat2df32-b9bfc1f5.js","./vec2-aed931ac.js","./TileStore-6570f2cc.js","./signal-a61cc993.js","./quickselect-149a6b43.js","./commonjsHelpers-2f3e7994.js","./QuantizationParameters-a323cbe3.js","./TileInfoView-be4d795d.js","./mat3-1b291d2f.js","./TiledDisplayObject-097260a9.js","./diffUtils-7a67a389.js","./labelingInfo-144cafce.js","./LabelClass-03af2031.js","./labelUtils-f4e57b25.js","./layerUtils-a8920453.js","./defaultsJSON-b087dd4d.js","./jsonUtils-6741d81c.js","./WGLContainer-a031049d.js","./FramebufferObject-f8937356.js","./ProgramTemplate-12d63168.js","./GeometryUtils-c1de866e.js","./heatmapUtils-c2569515.js","./vec4f64-3c9d0901.js","./StyleDefinition-29c49b98.js","./vec2f32-eaf29605.js","./config-1337d16e.js","./earcut-b84353bc.js","./vec2f64-95bf678d.js","./featureConversionUtils-5ad02385.js","./OptimizedFeature-ded94d90.js","./OptimizedFeatureSet-1d1ac4b9.js","./visualVariablesUtils-e6903ea9.js","./ExpandedCIM-870ec490.js","./BidiEngine-9a40f2f4.js","./GeometryUtils-984e8446.js","./utils-d023eda3.js","./Rect-ea14f53a.js","./quantizationUtils-7998a127.js","./floatRGBA-04143c6a.js","./clusterUtils-80867c68.js","./MD5-715f37cd.js","./SizeVariable-d8011d21.js","./colorRamps-18dfa72a.js","./LegendOptions-21ba0c6d.js","./compilerUtils-811a6f43.js","./lengthUtils-5d9bdf3f.js","./util-0cf8b7dd.js","./TileContainer-a854d921.js","./vec3f32-2da9db36.js","./normalizeUtils-a2b8b8b6.js","./normalizeUtilsCommon-05ad6f6d.js","./GraphicsView2D-cf1235ce.js","./normalizeUtilsSync-20755c4d.js","./projectionSupport-29174b46.js","./arcgisLayerUrl-fc2d909c.js","./json-48e3ea08.js","./Matcher-5cde60f7.js","./tileUtils-c2f19f52.js","./TurboLine-470e4fcd.js","./LRUCache-9b8f5520.js","./ComputedAttributeStorage-1c26e0db.js","./FieldsIndex-406a2400.js","./TimeOnly-f07e8b54.js","./Basemap-fc4d26ee.js","./loadAll-76369e9a.js","./PortalItem-01395053.js","./writeUtils-3673b1a7.js","./CollectionFlattener-5cd5b172.js","./infoFor3D-24efd44a.js","./basemapUtils-0a6b5a56.js","./TablesMixin-2871072c.js","./Cyclical-8c26e7c7.js","./TileInfo-238dd4b6.js","./jsxFactory-8f2e778f.js","./GraphicsCollection-2966693c.js","./ViewingMode-fb6259a5.js","./unitBezier-881ac1eb.js","./GoTo-2cdac7e7.js"],import.meta.url)),media:()=>$().then(()=>w(()=>import("./MediaLayerView2D-80e52803.js"),["./MediaLayerView2D-80e52803.js","./uuid-fb53ae2e.js","./index-e42a63f9.js","./UniqueValueRenderer-eeb3ca28.js","./LegendOptions-21ba0c6d.js","./diffUtils-7a67a389.js","./SizeVariable-d8011d21.js","./colorRamps-18dfa72a.js","./compilerUtils-811a6f43.js","./lengthUtils-5d9bdf3f.js","./ColorStop-4bfca0a7.js","./jsonUtils-6741d81c.js","./layerUtils-a8920453.js","./styleUtils-957365ee.js","./jsonUtils-ca31df3a.js","./DictionaryLoader-153eea1f.js","./LRUCache-9b8f5520.js","./FieldsIndex-406a2400.js","./heatmapUtils-c2569515.js","./vec4f64-3c9d0901.js","./perspectiveUtils-1bde7b20.js","./arcgisLayerUrl-fc2d909c.js","./normalizeUtilsSync-20755c4d.js","./normalizeUtilsCommon-05ad6f6d.js","./mat3-1b291d2f.js","./mat3f64-221ce671.js","./vec2-aed931ac.js","./Container-15ae821f.js","./mat3f32-6c416b1c.js","./parser-450a99c3.js","./mat4f32-60a2394b.js","./mat4-f091cc2b.js","./definitions-d96ec118.js","./enums-bdecffa2.js","./Texture-909bfb08.js","./capabilities-6261cefc.js","./BufferPool-f1313648.js","./AttributeStoreView-43278226.js","./mat2df32-b9bfc1f5.js","./TileStore-6570f2cc.js","./workers-3c8ba252.js","./signal-a61cc993.js","./quickselect-149a6b43.js","./commonjsHelpers-2f3e7994.js","./QuantizationParameters-a323cbe3.js","./TileInfoView-be4d795d.js","./TiledDisplayObject-097260a9.js","./labelingInfo-144cafce.js","./LabelClass-03af2031.js","./labelUtils-f4e57b25.js","./defaultsJSON-b087dd4d.js","./color-a4b304a5.js","./enums-f1a6a48a.js","./VertexElementDescriptor-2925c6af.js","./WGLContainer-a031049d.js","./FramebufferObject-f8937356.js","./ProgramTemplate-12d63168.js","./GeometryUtils-c1de866e.js","./StyleDefinition-29c49b98.js","./vec2f32-eaf29605.js","./config-1337d16e.js","./earcut-b84353bc.js","./vec2f64-95bf678d.js","./featureConversionUtils-5ad02385.js","./OptimizedFeature-ded94d90.js","./OptimizedFeatureSet-1d1ac4b9.js","./visualVariablesUtils-e6903ea9.js","./ExpandedCIM-870ec490.js","./BidiEngine-9a40f2f4.js","./GeometryUtils-984e8446.js","./utils-d023eda3.js","./Rect-ea14f53a.js","./quantizationUtils-7998a127.js","./floatRGBA-04143c6a.js","./clusterUtils-80867c68.js","./MD5-715f37cd.js","./util-0cf8b7dd.js","./enums-fb086c25.js","./MagnifierPrograms-83cf9dff.js","./rasterizingUtils-7a00076e.js","./pbf-0c5d1fff.js","./imageutils-8a04d22c.js","./Matcher-5cde60f7.js","./tileUtils-c2f19f52.js","./TurboLine-470e4fcd.js","./CircularArray-ef508845.js","./testSVGPremultipliedAlpha-ad111ba4.js","./throttle-7bf02de9.js","./ComputedAttributeStorage-1c26e0db.js","./TimeOnly-f07e8b54.js","./UpdatingHandles-9a53fef9.js","./OrderIndependentTransparency-6ae10952.js","./basicInterfaces-11f56cb3.js","./GraphicsView2D-cf1235ce.js","./projectionSupport-29174b46.js","./json-48e3ea08.js","./normalizeUtils-a2b8b8b6.js","./vec3f32-2da9db36.js","./LayerView-8590f61c.js","./scaleUtils-bba7f8bb.js","./Basemap-fc4d26ee.js","./loadAll-76369e9a.js","./PortalItem-01395053.js","./writeUtils-3673b1a7.js","./CollectionFlattener-5cd5b172.js","./infoFor3D-24efd44a.js","./basemapUtils-0a6b5a56.js","./TablesMixin-2871072c.js","./Cyclical-8c26e7c7.js","./TileInfo-238dd4b6.js","./jsxFactory-8f2e778f.js","./GraphicsCollection-2966693c.js","./ViewingMode-fb6259a5.js","./unitBezier-881ac1eb.js","./GoTo-2cdac7e7.js"],import.meta.url)),"ogc-feature":()=>$().then(()=>w(()=>import("./OGCFeatureLayerView2D-599f2ac1.js"),["./OGCFeatureLayerView2D-599f2ac1.js","./uuid-fb53ae2e.js","./index-e42a63f9.js","./FeatureLayerView2D-6da362b5.js","./Container-15ae821f.js","./mat3f32-6c416b1c.js","./parser-450a99c3.js","./mat4f32-60a2394b.js","./mat4-f091cc2b.js","./definitions-d96ec118.js","./enums-bdecffa2.js","./Texture-909bfb08.js","./capabilities-6261cefc.js","./FeatureEffect-3edf5c32.js","./jsonUtils-2946bd15.js","./arcgisLayerUrl-fc2d909c.js","./Query-56eb5454.js","./Field-2e745f35.js","./fieldType-5ce7d1ed.js","./FullTextSearch-92b839ce.js","./QuantizationParameters-a323cbe3.js","./layerUtils-a8920453.js","./FeatureSet-46acd907.js","./LayerView-8590f61c.js","./scaleUtils-bba7f8bb.js","./UpdatingHandles-9a53fef9.js","./AttributeStoreView-43278226.js","./mat2df32-b9bfc1f5.js","./vec2-aed931ac.js","./TileStore-6570f2cc.js","./workers-3c8ba252.js","./signal-a61cc993.js","./quickselect-149a6b43.js","./commonjsHelpers-2f3e7994.js","./TileInfoView-be4d795d.js","./mat3-1b291d2f.js","./TiledDisplayObject-097260a9.js","./diffUtils-7a67a389.js","./labelingInfo-144cafce.js","./LabelClass-03af2031.js","./labelUtils-f4e57b25.js","./defaultsJSON-b087dd4d.js","./jsonUtils-6741d81c.js","./color-a4b304a5.js","./enums-f1a6a48a.js","./VertexElementDescriptor-2925c6af.js","./WGLContainer-a031049d.js","./FramebufferObject-f8937356.js","./ProgramTemplate-12d63168.js","./GeometryUtils-c1de866e.js","./heatmapUtils-c2569515.js","./vec4f64-3c9d0901.js","./StyleDefinition-29c49b98.js","./vec2f32-eaf29605.js","./config-1337d16e.js","./earcut-b84353bc.js","./vec2f64-95bf678d.js","./featureConversionUtils-5ad02385.js","./OptimizedFeature-ded94d90.js","./OptimizedFeatureSet-1d1ac4b9.js","./visualVariablesUtils-e6903ea9.js","./ExpandedCIM-870ec490.js","./BidiEngine-9a40f2f4.js","./GeometryUtils-984e8446.js","./utils-d023eda3.js","./Rect-ea14f53a.js","./quantizationUtils-7998a127.js","./floatRGBA-04143c6a.js","./clusterUtils-80867c68.js","./MD5-715f37cd.js","./SizeVariable-d8011d21.js","./colorRamps-18dfa72a.js","./LegendOptions-21ba0c6d.js","./compilerUtils-811a6f43.js","./lengthUtils-5d9bdf3f.js","./util-0cf8b7dd.js","./BitmapTileContainer-de805481.js","./Bitmap-f012754b.js","./TileContainer-a854d921.js","./CircularArray-ef508845.js","./BufferPool-f1313648.js","./FeatureContainer-7b9710d6.js","./commonProperties-dc1396d3.js","./ElevationInfo-c9711b5d.js","./floorFilterUtils-080a7cd2.js","./popupUtils-73dae124.js","./RefreshableLayerView-f354dee3.js","./Basemap-fc4d26ee.js","./loadAll-76369e9a.js","./PortalItem-01395053.js","./writeUtils-3673b1a7.js","./CollectionFlattener-5cd5b172.js","./infoFor3D-24efd44a.js","./basemapUtils-0a6b5a56.js","./TablesMixin-2871072c.js","./Cyclical-8c26e7c7.js","./TileInfo-238dd4b6.js","./jsxFactory-8f2e778f.js","./GraphicsCollection-2966693c.js","./ViewingMode-fb6259a5.js","./unitBezier-881ac1eb.js","./normalizeUtils-a2b8b8b6.js","./normalizeUtilsCommon-05ad6f6d.js","./GoTo-2cdac7e7.js"],import.meta.url)),"open-street-map":gt,"oriented-imagery":et,route:()=>$().then(()=>w(()=>import("./RouteLayerView2D-73f09e3b.js"),["./RouteLayerView2D-73f09e3b.js","./uuid-fb53ae2e.js","./index-e42a63f9.js","./CollectionFlattener-5cd5b172.js","./Stop-42c7cfd1.js","./LayerView-8590f61c.js","./scaleUtils-bba7f8bb.js","./Container-15ae821f.js","./mat3f32-6c416b1c.js","./parser-450a99c3.js","./mat4f32-60a2394b.js","./mat4-f091cc2b.js","./definitions-d96ec118.js","./enums-bdecffa2.js","./Texture-909bfb08.js","./capabilities-6261cefc.js","./UpdatingHandles-9a53fef9.js","./GraphicContainer-6ae2ea3e.js","./color-a4b304a5.js","./enums-f1a6a48a.js","./VertexElementDescriptor-2925c6af.js","./BaseGraphicContainer-d8dd2bed.js","./FeatureContainer-7b9710d6.js","./workers-3c8ba252.js","./AttributeStoreView-43278226.js","./mat2df32-b9bfc1f5.js","./vec2-aed931ac.js","./TileStore-6570f2cc.js","./signal-a61cc993.js","./quickselect-149a6b43.js","./commonjsHelpers-2f3e7994.js","./QuantizationParameters-a323cbe3.js","./TileInfoView-be4d795d.js","./mat3-1b291d2f.js","./TiledDisplayObject-097260a9.js","./diffUtils-7a67a389.js","./labelingInfo-144cafce.js","./LabelClass-03af2031.js","./labelUtils-f4e57b25.js","./layerUtils-a8920453.js","./defaultsJSON-b087dd4d.js","./jsonUtils-6741d81c.js","./WGLContainer-a031049d.js","./FramebufferObject-f8937356.js","./ProgramTemplate-12d63168.js","./GeometryUtils-c1de866e.js","./heatmapUtils-c2569515.js","./vec4f64-3c9d0901.js","./StyleDefinition-29c49b98.js","./vec2f32-eaf29605.js","./config-1337d16e.js","./earcut-b84353bc.js","./vec2f64-95bf678d.js","./featureConversionUtils-5ad02385.js","./OptimizedFeature-ded94d90.js","./OptimizedFeatureSet-1d1ac4b9.js","./visualVariablesUtils-e6903ea9.js","./ExpandedCIM-870ec490.js","./BidiEngine-9a40f2f4.js","./GeometryUtils-984e8446.js","./utils-d023eda3.js","./Rect-ea14f53a.js","./quantizationUtils-7998a127.js","./floatRGBA-04143c6a.js","./clusterUtils-80867c68.js","./MD5-715f37cd.js","./SizeVariable-d8011d21.js","./colorRamps-18dfa72a.js","./LegendOptions-21ba0c6d.js","./compilerUtils-811a6f43.js","./lengthUtils-5d9bdf3f.js","./util-0cf8b7dd.js","./TileContainer-a854d921.js","./vec3f32-2da9db36.js","./normalizeUtils-a2b8b8b6.js","./normalizeUtilsCommon-05ad6f6d.js","./GraphicsView2D-cf1235ce.js","./normalizeUtilsSync-20755c4d.js","./projectionSupport-29174b46.js","./arcgisLayerUrl-fc2d909c.js","./json-48e3ea08.js","./Matcher-5cde60f7.js","./tileUtils-c2f19f52.js","./TurboLine-470e4fcd.js","./LRUCache-9b8f5520.js","./ComputedAttributeStorage-1c26e0db.js","./FieldsIndex-406a2400.js","./TimeOnly-f07e8b54.js","./Basemap-fc4d26ee.js","./loadAll-76369e9a.js","./PortalItem-01395053.js","./writeUtils-3673b1a7.js","./infoFor3D-24efd44a.js","./basemapUtils-0a6b5a56.js","./TablesMixin-2871072c.js","./Cyclical-8c26e7c7.js","./TileInfo-238dd4b6.js","./jsxFactory-8f2e778f.js","./GraphicsCollection-2966693c.js","./ViewingMode-fb6259a5.js","./unitBezier-881ac1eb.js","./GoTo-2cdac7e7.js"],import.meta.url)),stream:()=>$().then(()=>w(()=>import("./StreamLayerView2D-06e3b8d8.js"),["./StreamLayerView2D-06e3b8d8.js","./uuid-fb53ae2e.js","./index-e42a63f9.js","./FeatureSet-46acd907.js","./Field-2e745f35.js","./fieldType-5ce7d1ed.js","./FeatureLayerView2D-6da362b5.js","./Container-15ae821f.js","./mat3f32-6c416b1c.js","./parser-450a99c3.js","./mat4f32-60a2394b.js","./mat4-f091cc2b.js","./definitions-d96ec118.js","./enums-bdecffa2.js","./Texture-909bfb08.js","./capabilities-6261cefc.js","./FeatureEffect-3edf5c32.js","./jsonUtils-2946bd15.js","./arcgisLayerUrl-fc2d909c.js","./Query-56eb5454.js","./FullTextSearch-92b839ce.js","./QuantizationParameters-a323cbe3.js","./layerUtils-a8920453.js","./LayerView-8590f61c.js","./scaleUtils-bba7f8bb.js","./UpdatingHandles-9a53fef9.js","./AttributeStoreView-43278226.js","./mat2df32-b9bfc1f5.js","./vec2-aed931ac.js","./TileStore-6570f2cc.js","./workers-3c8ba252.js","./signal-a61cc993.js","./quickselect-149a6b43.js","./commonjsHelpers-2f3e7994.js","./TileInfoView-be4d795d.js","./mat3-1b291d2f.js","./TiledDisplayObject-097260a9.js","./diffUtils-7a67a389.js","./labelingInfo-144cafce.js","./LabelClass-03af2031.js","./labelUtils-f4e57b25.js","./defaultsJSON-b087dd4d.js","./jsonUtils-6741d81c.js","./color-a4b304a5.js","./enums-f1a6a48a.js","./VertexElementDescriptor-2925c6af.js","./WGLContainer-a031049d.js","./FramebufferObject-f8937356.js","./ProgramTemplate-12d63168.js","./GeometryUtils-c1de866e.js","./heatmapUtils-c2569515.js","./vec4f64-3c9d0901.js","./StyleDefinition-29c49b98.js","./vec2f32-eaf29605.js","./config-1337d16e.js","./earcut-b84353bc.js","./vec2f64-95bf678d.js","./featureConversionUtils-5ad02385.js","./OptimizedFeature-ded94d90.js","./OptimizedFeatureSet-1d1ac4b9.js","./visualVariablesUtils-e6903ea9.js","./ExpandedCIM-870ec490.js","./BidiEngine-9a40f2f4.js","./GeometryUtils-984e8446.js","./utils-d023eda3.js","./Rect-ea14f53a.js","./quantizationUtils-7998a127.js","./floatRGBA-04143c6a.js","./clusterUtils-80867c68.js","./MD5-715f37cd.js","./SizeVariable-d8011d21.js","./colorRamps-18dfa72a.js","./LegendOptions-21ba0c6d.js","./compilerUtils-811a6f43.js","./lengthUtils-5d9bdf3f.js","./util-0cf8b7dd.js","./BitmapTileContainer-de805481.js","./Bitmap-f012754b.js","./TileContainer-a854d921.js","./CircularArray-ef508845.js","./BufferPool-f1313648.js","./FeatureContainer-7b9710d6.js","./commonProperties-dc1396d3.js","./ElevationInfo-c9711b5d.js","./floorFilterUtils-080a7cd2.js","./popupUtils-73dae124.js","./RefreshableLayerView-f354dee3.js","./Basemap-fc4d26ee.js","./loadAll-76369e9a.js","./PortalItem-01395053.js","./writeUtils-3673b1a7.js","./CollectionFlattener-5cd5b172.js","./infoFor3D-24efd44a.js","./basemapUtils-0a6b5a56.js","./TablesMixin-2871072c.js","./Cyclical-8c26e7c7.js","./TileInfo-238dd4b6.js","./jsxFactory-8f2e778f.js","./GraphicsCollection-2966693c.js","./ViewingMode-fb6259a5.js","./unitBezier-881ac1eb.js","./normalizeUtils-a2b8b8b6.js","./normalizeUtilsCommon-05ad6f6d.js","./GoTo-2cdac7e7.js"],import.meta.url)),"subtype-group":()=>$().then(()=>w(()=>import("./SubtypeGroupLayerView2D-509e7b2c.js"),["./SubtypeGroupLayerView2D-509e7b2c.js","./uuid-fb53ae2e.js","./index-e42a63f9.js","./FeatureEffect-3edf5c32.js","./jsonUtils-2946bd15.js","./parser-450a99c3.js","./mat4f32-60a2394b.js","./mat4-f091cc2b.js","./arcgisLayerUrl-fc2d909c.js","./Query-56eb5454.js","./Field-2e745f35.js","./fieldType-5ce7d1ed.js","./FullTextSearch-92b839ce.js","./QuantizationParameters-a323cbe3.js","./FeatureLayerView2D-6da362b5.js","./Container-15ae821f.js","./mat3f32-6c416b1c.js","./definitions-d96ec118.js","./enums-bdecffa2.js","./Texture-909bfb08.js","./capabilities-6261cefc.js","./layerUtils-a8920453.js","./FeatureSet-46acd907.js","./LayerView-8590f61c.js","./scaleUtils-bba7f8bb.js","./UpdatingHandles-9a53fef9.js","./AttributeStoreView-43278226.js","./mat2df32-b9bfc1f5.js","./vec2-aed931ac.js","./TileStore-6570f2cc.js","./workers-3c8ba252.js","./signal-a61cc993.js","./quickselect-149a6b43.js","./commonjsHelpers-2f3e7994.js","./TileInfoView-be4d795d.js","./mat3-1b291d2f.js","./TiledDisplayObject-097260a9.js","./diffUtils-7a67a389.js","./labelingInfo-144cafce.js","./LabelClass-03af2031.js","./labelUtils-f4e57b25.js","./defaultsJSON-b087dd4d.js","./jsonUtils-6741d81c.js","./color-a4b304a5.js","./enums-f1a6a48a.js","./VertexElementDescriptor-2925c6af.js","./WGLContainer-a031049d.js","./FramebufferObject-f8937356.js","./ProgramTemplate-12d63168.js","./GeometryUtils-c1de866e.js","./heatmapUtils-c2569515.js","./vec4f64-3c9d0901.js","./StyleDefinition-29c49b98.js","./vec2f32-eaf29605.js","./config-1337d16e.js","./earcut-b84353bc.js","./vec2f64-95bf678d.js","./featureConversionUtils-5ad02385.js","./OptimizedFeature-ded94d90.js","./OptimizedFeatureSet-1d1ac4b9.js","./visualVariablesUtils-e6903ea9.js","./ExpandedCIM-870ec490.js","./BidiEngine-9a40f2f4.js","./GeometryUtils-984e8446.js","./utils-d023eda3.js","./Rect-ea14f53a.js","./quantizationUtils-7998a127.js","./floatRGBA-04143c6a.js","./clusterUtils-80867c68.js","./MD5-715f37cd.js","./SizeVariable-d8011d21.js","./colorRamps-18dfa72a.js","./LegendOptions-21ba0c6d.js","./compilerUtils-811a6f43.js","./lengthUtils-5d9bdf3f.js","./util-0cf8b7dd.js","./BitmapTileContainer-de805481.js","./Bitmap-f012754b.js","./TileContainer-a854d921.js","./CircularArray-ef508845.js","./BufferPool-f1313648.js","./FeatureContainer-7b9710d6.js","./commonProperties-dc1396d3.js","./ElevationInfo-c9711b5d.js","./floorFilterUtils-080a7cd2.js","./popupUtils-73dae124.js","./RefreshableLayerView-f354dee3.js","./Basemap-fc4d26ee.js","./loadAll-76369e9a.js","./PortalItem-01395053.js","./writeUtils-3673b1a7.js","./CollectionFlattener-5cd5b172.js","./infoFor3D-24efd44a.js","./basemapUtils-0a6b5a56.js","./TablesMixin-2871072c.js","./Cyclical-8c26e7c7.js","./TileInfo-238dd4b6.js","./jsxFactory-8f2e778f.js","./GraphicsCollection-2966693c.js","./ViewingMode-fb6259a5.js","./unitBezier-881ac1eb.js","./normalizeUtils-a2b8b8b6.js","./normalizeUtilsCommon-05ad6f6d.js","./GoTo-2cdac7e7.js"],import.meta.url)),tile:gt,"vector-tile":()=>$().then(()=>w(()=>import("./VectorTileLayerView2D-09e9b912.js"),["./VectorTileLayerView2D-09e9b912.js","./uuid-fb53ae2e.js","./index-e42a63f9.js","./diffUtils-7a67a389.js","./enums-fb086c25.js","./workers-3c8ba252.js","./Rect-ea14f53a.js","./enums-bdecffa2.js","./Texture-909bfb08.js","./capabilities-6261cefc.js","./pbf-0c5d1fff.js","./rasterizingUtils-7a00076e.js","./floatRGBA-04143c6a.js","./TileInfoView-be4d795d.js","./LRUCache-9b8f5520.js","./mat3-1b291d2f.js","./mat3f32-6c416b1c.js","./FramebufferObject-f8937356.js","./ProgramTemplate-12d63168.js","./commonjsHelpers-2f3e7994.js","./config-1337d16e.js","./TiledDisplayObject-097260a9.js","./Container-15ae821f.js","./parser-450a99c3.js","./mat4f32-60a2394b.js","./mat4-f091cc2b.js","./definitions-d96ec118.js","./signal-a61cc993.js","./StyleDefinition-29c49b98.js","./enums-f1a6a48a.js","./color-a4b304a5.js","./VertexElementDescriptor-2925c6af.js","./TileContainer-a854d921.js","./WGLContainer-a031049d.js","./GeometryUtils-c1de866e.js","./heatmapUtils-c2569515.js","./vec4f64-3c9d0901.js","./vec2f32-eaf29605.js","./earcut-b84353bc.js","./vec2-aed931ac.js","./vec2f64-95bf678d.js","./featureConversionUtils-5ad02385.js","./OptimizedFeature-ded94d90.js","./OptimizedFeatureSet-1d1ac4b9.js","./StyleRepository-0200cd9b.js","./colorUtils-fd566245.js","./GeometryUtils-984e8446.js","./unitBezier-881ac1eb.js","./LayerView-8590f61c.js","./scaleUtils-bba7f8bb.js","./UpdatingHandles-9a53fef9.js","./TileInfo-238dd4b6.js","./mat2df32-b9bfc1f5.js","./TileStore-6570f2cc.js","./quickselect-149a6b43.js","./QuantizationParameters-a323cbe3.js","./Basemap-fc4d26ee.js","./loadAll-76369e9a.js","./PortalItem-01395053.js","./writeUtils-3673b1a7.js","./layerUtils-a8920453.js","./compilerUtils-811a6f43.js","./CollectionFlattener-5cd5b172.js","./infoFor3D-24efd44a.js","./basemapUtils-0a6b5a56.js","./TablesMixin-2871072c.js","./arcgisLayerUrl-fc2d909c.js","./Cyclical-8c26e7c7.js","./jsxFactory-8f2e778f.js","./GraphicsCollection-2966693c.js","./ViewingMode-fb6259a5.js","./normalizeUtils-a2b8b8b6.js","./normalizeUtilsCommon-05ad6f6d.js","./GoTo-2cdac7e7.js"],import.meta.url)),video:()=>$().then(()=>w(()=>import("./VideoLayerView2D-331b3dd3.js"),["./VideoLayerView2D-331b3dd3.js","./uuid-fb53ae2e.js","./index-e42a63f9.js","./GraphicsLayer-328067ab.js","./GraphicsCollection-2966693c.js","./arcgisLayerUrl-fc2d909c.js","./BlendLayer-840b2c27.js","./jsonUtils-2946bd15.js","./parser-450a99c3.js","./mat4f32-60a2394b.js","./mat4-f091cc2b.js","./ScaleRangeLayer-f6774238.js","./ElevationInfo-c9711b5d.js","./lengthUtils-5d9bdf3f.js","./LayerView-8590f61c.js","./scaleUtils-bba7f8bb.js","./Container-15ae821f.js","./mat3f32-6c416b1c.js","./definitions-d96ec118.js","./enums-bdecffa2.js","./Texture-909bfb08.js","./capabilities-6261cefc.js","./UpdatingHandles-9a53fef9.js","./GraphicContainer-6ae2ea3e.js","./color-a4b304a5.js","./enums-f1a6a48a.js","./VertexElementDescriptor-2925c6af.js","./BaseGraphicContainer-d8dd2bed.js","./FeatureContainer-7b9710d6.js","./workers-3c8ba252.js","./AttributeStoreView-43278226.js","./mat2df32-b9bfc1f5.js","./vec2-aed931ac.js","./TileStore-6570f2cc.js","./signal-a61cc993.js","./quickselect-149a6b43.js","./commonjsHelpers-2f3e7994.js","./QuantizationParameters-a323cbe3.js","./TileInfoView-be4d795d.js","./mat3-1b291d2f.js","./TiledDisplayObject-097260a9.js","./diffUtils-7a67a389.js","./labelingInfo-144cafce.js","./LabelClass-03af2031.js","./labelUtils-f4e57b25.js","./layerUtils-a8920453.js","./defaultsJSON-b087dd4d.js","./jsonUtils-6741d81c.js","./WGLContainer-a031049d.js","./FramebufferObject-f8937356.js","./ProgramTemplate-12d63168.js","./GeometryUtils-c1de866e.js","./heatmapUtils-c2569515.js","./vec4f64-3c9d0901.js","./StyleDefinition-29c49b98.js","./vec2f32-eaf29605.js","./config-1337d16e.js","./earcut-b84353bc.js","./vec2f64-95bf678d.js","./featureConversionUtils-5ad02385.js","./OptimizedFeature-ded94d90.js","./OptimizedFeatureSet-1d1ac4b9.js","./visualVariablesUtils-e6903ea9.js","./ExpandedCIM-870ec490.js","./BidiEngine-9a40f2f4.js","./GeometryUtils-984e8446.js","./utils-d023eda3.js","./Rect-ea14f53a.js","./quantizationUtils-7998a127.js","./floatRGBA-04143c6a.js","./clusterUtils-80867c68.js","./MD5-715f37cd.js","./SizeVariable-d8011d21.js","./colorRamps-18dfa72a.js","./LegendOptions-21ba0c6d.js","./compilerUtils-811a6f43.js","./util-0cf8b7dd.js","./TileContainer-a854d921.js","./vec3f32-2da9db36.js","./normalizeUtils-a2b8b8b6.js","./normalizeUtilsCommon-05ad6f6d.js","./GraphicsView2D-cf1235ce.js","./normalizeUtilsSync-20755c4d.js","./projectionSupport-29174b46.js","./json-48e3ea08.js","./Matcher-5cde60f7.js","./tileUtils-c2f19f52.js","./TurboLine-470e4fcd.js","./LRUCache-9b8f5520.js","./ComputedAttributeStorage-1c26e0db.js","./FieldsIndex-406a2400.js","./TimeOnly-f07e8b54.js","./Basemap-fc4d26ee.js","./loadAll-76369e9a.js","./PortalItem-01395053.js","./writeUtils-3673b1a7.js","./CollectionFlattener-5cd5b172.js","./infoFor3D-24efd44a.js","./basemapUtils-0a6b5a56.js","./TablesMixin-2871072c.js","./Cyclical-8c26e7c7.js","./TileInfo-238dd4b6.js","./jsxFactory-8f2e778f.js","./ViewingMode-fb6259a5.js","./unitBezier-881ac1eb.js","./GoTo-2cdac7e7.js"],import.meta.url)),wcs:()=>$().then(()=>w(()=>import("./ImageryTileLayerView2D-34d7a691.js"),["./ImageryTileLayerView2D-34d7a691.js","./uuid-fb53ae2e.js","./index-e42a63f9.js","./multidimensionalUtils-f2e9d7de.js","./RasterVFDisplayObject-372095ec.js","./FramebufferObject-f8937356.js","./Texture-909bfb08.js","./capabilities-6261cefc.js","./enums-bdecffa2.js","./ProgramTemplate-12d63168.js","./commonjsHelpers-2f3e7994.js","./VertexElementDescriptor-2925c6af.js","./dataUtils-e8a4f0ad.js","./mat3f32-6c416b1c.js","./WGLContainer-a031049d.js","./definitions-d96ec118.js","./color-a4b304a5.js","./enums-f1a6a48a.js","./GeometryUtils-c1de866e.js","./heatmapUtils-c2569515.js","./vec4f64-3c9d0901.js","./StyleDefinition-29c49b98.js","./vec2f32-eaf29605.js","./config-1337d16e.js","./Container-15ae821f.js","./parser-450a99c3.js","./mat4f32-60a2394b.js","./mat4-f091cc2b.js","./earcut-b84353bc.js","./vec2-aed931ac.js","./vec2f64-95bf678d.js","./featureConversionUtils-5ad02385.js","./OptimizedFeature-ded94d90.js","./OptimizedFeatureSet-1d1ac4b9.js","./mat3-1b291d2f.js","./LayerView-8590f61c.js","./scaleUtils-bba7f8bb.js","./UpdatingHandles-9a53fef9.js","./rasterUtils-4731e2fe.js","./TiledDisplayObject-097260a9.js","./TileInfoView-be4d795d.js","./TileContainer-a854d921.js","./TileInfo-238dd4b6.js","./RawBlockCache-928cb705.js","./rasterProjectionHelper-003ea8ea.js","./arcgisLayerUrl-fc2d909c.js","./mat2df32-b9bfc1f5.js","./TileStore-6570f2cc.js","./workers-3c8ba252.js","./signal-a61cc993.js","./quickselect-149a6b43.js","./QuantizationParameters-a323cbe3.js","./util-0cf8b7dd.js","./commonProperties-dc1396d3.js","./ElevationInfo-c9711b5d.js","./lengthUtils-5d9bdf3f.js","./popupUtils-73dae124.js","./RefreshableLayerView-f354dee3.js","./Basemap-fc4d26ee.js","./loadAll-76369e9a.js","./PortalItem-01395053.js","./writeUtils-3673b1a7.js","./layerUtils-a8920453.js","./compilerUtils-811a6f43.js","./CollectionFlattener-5cd5b172.js","./infoFor3D-24efd44a.js","./basemapUtils-0a6b5a56.js","./TablesMixin-2871072c.js","./Cyclical-8c26e7c7.js","./jsxFactory-8f2e778f.js","./GraphicsCollection-2966693c.js","./ViewingMode-fb6259a5.js","./unitBezier-881ac1eb.js","./normalizeUtils-a2b8b8b6.js","./normalizeUtilsCommon-05ad6f6d.js","./GoTo-2cdac7e7.js"],import.meta.url)),"web-tile":gt,wfs:et,wms:()=>$().then(()=>w(()=>import("./WMSLayerView2D-46d39c98.js"),["./WMSLayerView2D-46d39c98.js","./uuid-fb53ae2e.js","./index-e42a63f9.js","./BitmapContainer-f711c539.js","./WGLContainer-a031049d.js","./definitions-d96ec118.js","./FramebufferObject-f8937356.js","./Texture-909bfb08.js","./capabilities-6261cefc.js","./enums-bdecffa2.js","./ProgramTemplate-12d63168.js","./commonjsHelpers-2f3e7994.js","./VertexElementDescriptor-2925c6af.js","./color-a4b304a5.js","./enums-f1a6a48a.js","./GeometryUtils-c1de866e.js","./heatmapUtils-c2569515.js","./vec4f64-3c9d0901.js","./mat3f32-6c416b1c.js","./StyleDefinition-29c49b98.js","./vec2f32-eaf29605.js","./config-1337d16e.js","./Container-15ae821f.js","./parser-450a99c3.js","./mat4f32-60a2394b.js","./mat4-f091cc2b.js","./earcut-b84353bc.js","./vec2-aed931ac.js","./vec2f64-95bf678d.js","./featureConversionUtils-5ad02385.js","./OptimizedFeature-ded94d90.js","./OptimizedFeatureSet-1d1ac4b9.js","./LayerView-8590f61c.js","./scaleUtils-bba7f8bb.js","./UpdatingHandles-9a53fef9.js","./ExportStrategy-ceec4f3c.js","./TileInfo-238dd4b6.js","./Bitmap-f012754b.js","./mat3-1b291d2f.js","./TileInfoView-be4d795d.js","./RefreshableLayerView-f354dee3.js","./commonProperties-dc1396d3.js","./arcgisLayerUrl-fc2d909c.js","./ElevationInfo-c9711b5d.js","./lengthUtils-5d9bdf3f.js","./ExportWMSImageParameters-041924b3.js","./Basemap-fc4d26ee.js","./loadAll-76369e9a.js","./PortalItem-01395053.js","./writeUtils-3673b1a7.js","./layerUtils-a8920453.js","./compilerUtils-811a6f43.js","./CollectionFlattener-5cd5b172.js","./infoFor3D-24efd44a.js","./basemapUtils-0a6b5a56.js","./TablesMixin-2871072c.js","./Cyclical-8c26e7c7.js","./workers-3c8ba252.js","./jsxFactory-8f2e778f.js","./signal-a61cc993.js","./GraphicsCollection-2966693c.js","./ViewingMode-fb6259a5.js","./unitBezier-881ac1eb.js","./mat2df32-b9bfc1f5.js","./TileStore-6570f2cc.js","./quickselect-149a6b43.js","./QuantizationParameters-a323cbe3.js","./normalizeUtils-a2b8b8b6.js","./normalizeUtilsCommon-05ad6f6d.js","./GoTo-2cdac7e7.js"],import.meta.url)),wmts:()=>$().then(()=>w(()=>import("./WMTSLayerView2D-a69624e5.js"),["./WMTSLayerView2D-a69624e5.js","./uuid-fb53ae2e.js","./index-e42a63f9.js","./imageUtils-932a49a3.js","./BitmapTileContainer-de805481.js","./mat3f32-6c416b1c.js","./Bitmap-f012754b.js","./mat3-1b291d2f.js","./vec2f32-eaf29605.js","./Container-15ae821f.js","./parser-450a99c3.js","./mat4f32-60a2394b.js","./mat4-f091cc2b.js","./definitions-d96ec118.js","./enums-bdecffa2.js","./Texture-909bfb08.js","./capabilities-6261cefc.js","./TiledDisplayObject-097260a9.js","./TileInfoView-be4d795d.js","./WGLContainer-a031049d.js","./FramebufferObject-f8937356.js","./ProgramTemplate-12d63168.js","./commonjsHelpers-2f3e7994.js","./VertexElementDescriptor-2925c6af.js","./color-a4b304a5.js","./enums-f1a6a48a.js","./GeometryUtils-c1de866e.js","./heatmapUtils-c2569515.js","./vec4f64-3c9d0901.js","./StyleDefinition-29c49b98.js","./config-1337d16e.js","./earcut-b84353bc.js","./vec2-aed931ac.js","./vec2f64-95bf678d.js","./featureConversionUtils-5ad02385.js","./OptimizedFeature-ded94d90.js","./OptimizedFeatureSet-1d1ac4b9.js","./TileContainer-a854d921.js","./LayerView-8590f61c.js","./scaleUtils-bba7f8bb.js","./UpdatingHandles-9a53fef9.js","./mat2df32-b9bfc1f5.js","./TileStore-6570f2cc.js","./workers-3c8ba252.js","./signal-a61cc993.js","./quickselect-149a6b43.js","./QuantizationParameters-a323cbe3.js","./RefreshableLayerView-f354dee3.js","./Basemap-fc4d26ee.js","./loadAll-76369e9a.js","./PortalItem-01395053.js","./writeUtils-3673b1a7.js","./layerUtils-a8920453.js","./compilerUtils-811a6f43.js","./CollectionFlattener-5cd5b172.js","./infoFor3D-24efd44a.js","./basemapUtils-0a6b5a56.js","./TablesMixin-2871072c.js","./arcgisLayerUrl-fc2d909c.js","./Cyclical-8c26e7c7.js","./TileInfo-238dd4b6.js","./jsxFactory-8f2e778f.js","./GraphicsCollection-2966693c.js","./ViewingMode-fb6259a5.js","./unitBezier-881ac1eb.js","./normalizeUtils-a2b8b8b6.js","./normalizeUtilsCommon-05ad6f6d.js","./GoTo-2cdac7e7.js"],import.meta.url)),"line-of-sight":null,"base-elevation":null,"building-scene":null,dimension:null,elevation:null,"integrated-mesh":null,"point-cloud":null,voxel:null,scene:null,unknown:null,unsupported:null};function Pl(t){const e=t.declaredClass?t.declaredClass.slice(t.declaredClass.lastIndexOf(".")+1):"Unknown",i=e.replaceAll(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();return new P(`${i}:view-not-supported`,`${e} is not supported in 2D`)}const ts={hasLayerViewModule:t=>es[t.type]!=null,importLayerView:t=>{const e=es[t.type];if(e==null)throw Pl(t);return e(t)}};function Cl(t,e){const{spatialReference:i}=e,n=[e.x,e.y];let s=Number.POSITIVE_INFINITY,a=0,o=0;const l=[0,0],c=t.type==="extent"?[[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]]:t.rings;for(const p of c)for(let u=0;u<p.length-1;u++){ao(l,n,p,u);const m=Yo(n,l);m<s&&(s=m,a=l[0],o=l[1])}return{coordinate:new D({x:a,y:o,spatialReference:i}),distance:s}}var ji;let We=ji=class extends sn(b){constructor(t){super(t),this.geometry=null,this.spatialReference=null}get normalizedGeometry(){if(this.geometry==null||!this.spatialReference)return null;if(!this.spatialReference.equals(this.geometry.spatialReference))try{return Ct(this.geometry,this.spatialReference)}catch(t){return T.getLogger(this).error("#constraints.geometry","could not project the geometry to the view's spatial reference",{geometry:this.geometry,spatialReference:this.spatialReference,error:t}),null}return this.geometry}constrain(t,e){if(this.normalizedGeometry==null)return t;const i=t.targetGeometry;if(this.normalizedGeometry.type==="extent"?xs(this.normalizedGeometry,i):oo(this.normalizedGeometry,i))return t;const{coordinate:n}=Cl(this.normalizedGeometry,i);return n&&(t.targetGeometry=n),t}clone(){var t,e;return new ji({geometry:(t=this.geometry)==null?void 0:t.clone(),spatialReference:(e=this.spatialReference)==null?void 0:e.clone()})}};r([h({constructOnly:!0})],We.prototype,"geometry",void 0),r([h({readOnly:!0})],We.prototype,"normalizedGeometry",null),r([h({constructOnly:!0})],We.prototype,"spatialReference",void 0),We=ji=r([_("esri.views.2d.constraints.GeometryConstraint")],We);var qi;let wt=qi=class extends sn(b){constructor(){super(...arguments),this.enabled=!0,this.rotationEnabled=!0}constrain(t,e){return this.enabled&&e&&(this.rotationEnabled||(t.rotation=e.rotation)),t}clone(){return new qi({enabled:this.enabled,rotationEnabled:this.rotationEnabled})}};r([h()],wt.prototype,"enabled",void 0),r([h()],wt.prototype,"rotationEnabled",void 0),wt=qi=r([_("esri.views.2d.constraints.RotationConstraint")],wt);const ia=wt;var Zi;let K=Zi=class extends sn(b){constructor(t){super(t),this._lodByScale={},this._scales=[],this.effectiveLODs=null,this.effectiveMinZoom=-1,this.effectiveMaxZoom=-1,this.effectiveMinScale=0,this.effectiveMaxScale=0,this.lods=null,this.minZoom=-1,this.maxZoom=-1,this.minScale=0,this.maxScale=0,this.snapToZoom=!0}initialize(){let t,{lods:e,minScale:i,maxScale:n,minZoom:s,maxZoom:a}=this,o=-1,l=-1,c=!1,p=!1;if(i!==0&&n!==0&&i<n&&([i,n]=[n,i]),!(e!=null&&e.length))return this._set("effectiveMinScale",i),void this._set("effectiveMaxScale",n);e=e.map(u=>u.clone()),e.sort((u,m)=>m.scale-u.scale),e.forEach((u,m)=>u.level=m);for(const u of e)!c&&i>0&&i>=u.scale&&(o=u.level,c=!0),!p&&n>0&&n>=u.scale&&(l=t?t.level:-1,p=!0),t=u;s===-1&&(s=i===0?0:o),a===-1&&(a=n===0?e.length-1:l),s=Math.max(s,0),s=Math.min(s,e.length-1),a=Math.max(a,0),a=Math.min(a,e.length-1),s>a&&([s,a]=[a,s]),i=e[s].scale,n=e[a].scale,e.splice(0,s),e.splice(a-s+1,e.length),e.forEach((u,m)=>{this._lodByScale[u.scale]=u,this._scales[m]=u.scale}),this._set("effectiveLODs",e),this._set("effectiveMinZoom",s),this._set("effectiveMaxZoom",a),this._set("effectiveMinScale",i),this._set("effectiveMaxScale",n)}constrain(t,e){if(e&&t.scale===e.scale)return t;const i=this.effectiveMinScale,n=this.effectiveMaxScale,s=t.targetGeometry,a=e&&e.targetGeometry,o=n!==0&&t.scale<n,l=i!==0&&t.scale>i;if(o||l){const c=l?i:n;if(e&&a){const p=(c-e.scale)/(t.scale-e.scale);s.x=a.x+(s.x-a.x)*p,s.y=a.y+(s.y-a.y)*p}t.scale=c}return this.snapToZoom&&this.effectiveLODs&&(t.scale=this._getClosestScale(t.scale)),t}fit(t){if(!this.effectiveLODs||!this.snapToZoom)return this.constrain(t,null);const e=this.scaleToZoom(t.scale),i=Math.abs(e-Math.floor(e));return t.scale=this.zoomToScale(i>.99?Math.round(e):Math.floor(e)),t}zoomToScale(t){if(!this.effectiveLODs)return 0;t-=this.effectiveMinZoom,t=Math.max(0,t);const e=this._scales;if(t<=0)return e[0];if(t>=e.length)return e[e.length-1];const i=Math.round(t-.5),n=Math.round(t);return e[n]+(n-t)*(e[i]-e[n])}scaleToZoom(t){if(!this.effectiveLODs)return-1;const e=this._scales;let i,n;if(t>=e[0])return this.effectiveMinZoom;if(t<=e[e.length-1])return this.effectiveMaxZoom;for(let s=0;s<e.length-1;s++){if(i=e[s],n=e[s+1],n===t)return s+this.effectiveMinZoom+1;if(i>t&&n<t)return s+this.effectiveMinZoom+1-(t-n)/(i-n)}return-1}snapToClosestScale(t){if(!this.effectiveLODs)return t;const e=this.scaleToZoom(t);return this.zoomToScale(Math.round(e))}snapToNextScale(t,e=.5){if(!this.effectiveLODs)return t*e;const i=Math.round(this.scaleToZoom(t));return this.zoomToScale(i+1)}snapToPreviousScale(t,e=2){if(!this.effectiveLODs)return t*e;const i=Math.round(this.scaleToZoom(t));return this.zoomToScale(i-1)}clone(){return new Zi({lods:this.lods,minZoom:this.minZoom,maxZoom:this.maxZoom,minScale:this.minScale,maxScale:this.maxScale})}_getClosestScale(t){return this._lodByScale[t]||(t=this._scales.reduce((e,i)=>Math.abs(i-t)<=Math.abs(e-t)?i:e,this._scales[0])),this._lodByScale[t].scale}};r([h({readOnly:!0})],K.prototype,"effectiveLODs",void 0),r([h({readOnly:!0})],K.prototype,"effectiveMinZoom",void 0),r([h({readOnly:!0})],K.prototype,"effectiveMaxZoom",void 0),r([h({readOnly:!0})],K.prototype,"effectiveMinScale",void 0),r([h({readOnly:!0})],K.prototype,"effectiveMaxScale",void 0),r([h()],K.prototype,"lods",void 0),r([h()],K.prototype,"minZoom",void 0),r([h()],K.prototype,"maxZoom",void 0),r([h()],K.prototype,"minScale",void 0),r([h()],K.prototype,"maxScale",void 0),r([h()],K.prototype,"snapToZoom",void 0),K=Zi=r([_("esri.views.2d.constraints.ZoomConstraint")],K);const na=K,Sl={base:null,key:"type",typeMap:{extent:Ye,polygon:ro}};let E=class extends b{constructor(e){super(e),this.lods=null,this.minScale=0,this.maxScale=0,this.minZoom=-1,this.maxZoom=-1,this.rotationEnabled=!0,this.snapToZoom=!0,this.customConstraints=new O}destroy(){this.view=null}get effectiveLODs(){return this._zoom.effectiveLODs}get effectiveMinScale(){return this._zoom.effectiveMinScale}get effectiveMaxScale(){return this._zoom.effectiveMaxScale}get effectiveMinZoom(){return this._zoom.effectiveMinZoom}get effectiveMaxZoom(){return this._zoom.effectiveMaxZoom}set geometry(e){e?this._set("geometry",e):this._set("geometry",null)}get version(){var e,i,n;return`${(e=this._zoom)==null?void 0:e.uid}/${(i=this._rotation)==null?void 0:i.uid}/${(n=this._geometry)==null?void 0:n.uid}`}get _geometry(){var i,n;const e=this._get("_geometry");return e&&this.geometry===e.geometry&&((i=this.view)==null?void 0:i.constraintsInfo.spatialReference)===e.spatialReference?e:new We({geometry:this.geometry,spatialReference:(n=this.view)==null?void 0:n.constraintsInfo.spatialReference})}get _rotation(){return new ia({rotationEnabled:this.rotationEnabled})}get _zoom(){var c;const e=this._get("_zoom"),i=this.lods||((c=this.view)==null?void 0:c.constraintsInfo.lods),n=this.minZoom,s=this.maxZoom,a=this.minScale,o=this.maxScale,l=this.snapToZoom;return e&&e.lods===i&&e.minZoom===n&&e.maxZoom===s&&e.minScale===a&&e.maxScale===o&&e.snapToZoom===l?e:new na({lods:i,minZoom:n,maxZoom:s,minScale:a,maxScale:o,snapToZoom:l})}canZoomInTo(e){const i=this.effectiveMaxScale;return i===0||e>=i}canZoomOutTo(e){const i=this.effectiveMinScale;return i===0||e<=i}constrain(e,i){return this._zoom.constrain(e,i),this._rotation.constrain(e,i),this._geometry.constrain(e,i),this.customConstraints.forEach(n=>n.constrain(e,i)),e}constrainByGeometry(e){return this._geometry.constrain(e),this.customConstraints.forEach(i=>{var n;return(n=i.applyPanConstraint)==null?void 0:n.call(i,e)}),e}fit(e){return this._zoom.fit(e)}zoomToScale(e){return this._zoom.zoomToScale(e)}scaleToZoom(e){return this._zoom.scaleToZoom(e)}snapScale(e){return this._zoom.snapToClosestScale(e)}snapToNextScale(e){return this._zoom.snapToNextScale(e)}snapToPreviousScale(e){return this._zoom.snapToPreviousScale(e)}};r([h({readOnly:!0})],E.prototype,"effectiveLODs",null),r([h({readOnly:!0})],E.prototype,"effectiveMinScale",null),r([h({readOnly:!0})],E.prototype,"effectiveMaxScale",null),r([h({readOnly:!0})],E.prototype,"effectiveMinZoom",null),r([h({readOnly:!0})],E.prototype,"effectiveMaxZoom",null),r([h({types:Sl,value:null})],E.prototype,"geometry",null),r([h({type:[Oo]})],E.prototype,"lods",void 0),r([h()],E.prototype,"minScale",void 0),r([h()],E.prototype,"maxScale",void 0),r([h()],E.prototype,"minZoom",void 0),r([h()],E.prototype,"maxZoom",void 0),r([h()],E.prototype,"rotationEnabled",void 0),r([h()],E.prototype,"snapToZoom",void 0),r([h({type:O})],E.prototype,"customConstraints",void 0),r([h()],E.prototype,"view",void 0),r([h({readOnly:!0})],E.prototype,"version",null),r([h({type:We,readOnly:!0})],E.prototype,"_geometry",null),r([h({type:ia})],E.prototype,"_rotation",null),r([h({readOnly:!0,type:na})],E.prototype,"_zoom",null),E=r([_("esri.views.2d.MapViewConstraints")],E);const sa=E;function $l(t){return t instanceof Float32Array&&t.length>=2}function El(t){return Array.isArray(t)&&t.length>=2}function Rt(t){return $l(t)||El(t)}var Bi;const H=[0,0];let Re=Bi=class extends xt{constructor(t){super(t),this._viewpoint2D={center:R(),rotation:0,scale:0,spatialReference:void 0},this.center=[0,0],this.extent=new Ye,this.id=0,this.inverseTransform=ze(),this.resolution=0,this.rotation=0,this.scale=0,this.transform=ze(),this.transformNoRotation=ze(),this.displayMat3=mi(),this.displayViewMat3=mi(),this.viewMat3=mi(),this.viewMat2d=qo(),this.worldScreenWidth=0,this.size=[0,0]}set pixelRatio(t){this._set("pixelRatio",t),this._update()}set size(t){this._set("size",t),this._update()}set viewpoint(t){if(t){const e=this._viewpoint2D,i=t.targetGeometry;e.center[0]=i.x,e.center[1]=i.y,e.rotation=t.rotation,e.scale=t.scale,e.spatialReference=i.spatialReference}this._update()}copy(t){const e=this.size,i=this.viewpoint;return i&&e?(this.viewpoint=se(i,t.viewpoint),this._set("size",Yt(e,t.size))):(this.viewpoint=t.viewpoint.clone(),this._set("size",[t.size[0],t.size[1]])),this._set("pixelRatio",t.pixelRatio),this}clone(){return new Bi({size:this.size,viewpoint:this.viewpoint.clone(),pixelRatio:this.pixelRatio})}toMap(t,e,i){return Rt(e)?de(t,e,this.inverseTransform):(H[0]=e,H[1]=i,de(t,H,this.inverseTransform))}toScreen(t,e,i){return Rt(e)?de(t,e,this.transform):(H[0]=e,H[1]=i,de(t,H,this.transform))}toScreenNoRotation(t,e,i){return Rt(e)?de(t,e,this.transformNoRotation):(H[0]=e,H[1]=i,de(t,H,this.transformNoRotation))}toScreenClosest(t,e,i){Rt(e)?(H[0]=e[0],H[1]=e[1]):(H[0]=e,H[1]=i);const[n]=H,{center:s,extent:a,spatialReference:o,transform:l}=this;return(n<a.xmin||n>a.xmax)&&(H[0]=Rs(n,s[0],o)),de(t,H,l)}getScreenTransform(t,e){const{center:i}=this._viewpoint2D,n=this._get("pixelRatio")||1,s=this._get("size");return un(t,i,s,e,0,n),t}_update(){const{center:t,spatialReference:e,scale:i,rotation:n}=this._viewpoint2D,s=this._get("pixelRatio")||1,a=this._get("size"),o=new me({targetGeometry:new D(t[0],t[1],e),scale:i,rotation:n});if(this._set("viewpoint",o),!a||!e||!i)return;this.resolution=ut(o),this.rotation=n,this.scale=i,this.spatialReference=e,Yt(this.center,t);const l=a[0]!==0?2/a[0]:0,c=a[1]!==0?-2/a[1]:0;er(this.displayMat3,l,0,0,0,c,0,-1,1,1);const p=tr(this.viewMat3),u=zn(a[0]/2,a[1]/2),m=zn(-a[0]/2,-a[1]/2),d=Ms(n);An(p,p,u),ir(p,p,d),An(p,p,m),nr(this.displayViewMat3,this.displayMat3,p);const g=$s(this.viewMat2d,u);return ln(g,g,d),Kt(g,g,m),ll(this.extent,o,a),mn(this.transform,o,a,s),Is(this.inverseTransform,this.transform),gl(this.transformNoRotation,o,a,s),this.worldScreenWidth=_l(this.spatialReference,this.resolution),this._set("id",this.id+1),this}};r([h({readOnly:!0})],Re.prototype,"id",void 0),r([h({value:1,json:{write:!0}})],Re.prototype,"pixelRatio",null),r([h({json:{write:!0}})],Re.prototype,"size",null),r([h()],Re.prototype,"spatialReference",void 0),r([h({type:me,json:{write:!0}})],Re.prototype,"viewpoint",null),Re=Bi=r([_("esri.views.2d.ViewState")],Re);const is=Re;var Wi,Ki;let ke=Wi=class extends b{constructor(){super(...arguments),this.left=0,this.top=0,this.right=0,this.bottom=0}clone(){return new Wi({left:this.left,top:this.top,right:this.right,bottom:this.bottom})}};r([h()],ke.prototype,"left",void 0),r([h()],ke.prototype,"top",void 0),r([h()],ke.prototype,"right",void 0),r([h()],ke.prototype,"bottom",void 0),ke=Wi=r([_("esri.views.2d.PaddedViewState.Padding")],ke);let at=Ki=class extends is{constructor(...t){super(...t),this.paddedViewState=new is,this._updateContent=(()=>{const e=R();return()=>{const i=this._get("size"),n=this._get("padding");if(!i||!n)return;const s=this.paddedViewState;A(e,n.left+n.right,n.top+n.bottom),Li(e,i,e),Yt(s.size,e);const a=s.viewpoint;a&&(this.viewpoint=a)}})(),this.addHandles(f(()=>[this.size,this.padding],()=>this._updateContent(),ii)),this.padding=new ke,this.size=[0,0]}set padding(t){this._set("padding",t||new ke)}set viewpoint(t){if(t){const e=t.clone();this.paddedViewState.viewpoint=t,fl(e,t,this._get("size"),this._get("padding"));const i=this._viewpoint2D,n=e.targetGeometry;i.center[0]=n.x,i.center[1]=n.y,i.rotation=e.rotation,i.scale=e.scale,i.spatialReference=n.spatialReference,this._update()}}clone(){return new Ki({padding:this.padding.clone(),size:this.size.slice(),viewpoint:this.paddedViewState.viewpoint.clone(),pixelRatio:this.pixelRatio})}};r([h()],at.prototype,"paddedViewState",void 0),r([h({type:ke})],at.prototype,"padding",null),r([h()],at.prototype,"viewpoint",null),at=Ki=r([_("esri.views.2d.PaddedViewState")],at);const Il=at;let q=class extends b{constructor(e){super(e),this.constraints=null,this.ready=!1,this.resizeAlign="center",this.addHandles([f(()=>{var i;return(i=this.constraints)==null?void 0:i.version},i=>{this.constraints&&i&&this.ready&&(this.state.viewpoint=this.constraints.fit(this.state.paddedViewState.viewpoint))},ii)])}get center(){if(!this.ready)return this._get("center");const{center:e,spatialReference:i}=this.state.paddedViewState;return this.state.commitProperty("id"),new D({x:e[0],y:e[1],spatialReference:i})}set center(e){if(e==null)return;if(!this.ready)return void this._set("center",e);let i;try{i=this._project(e,this.state.spatialReference)}catch(s){return void T.getLogger(this).error(new P("mapview:invalid-center","could not project the value in the view's spatial reference",{input:e,error:s}))}const n=this.viewpoint;Ui(n,n,i),this.viewpoint=n}get extent(){return this.ready?(this.state.commitProperty("id"),this.state.paddedViewState.extent.clone()):this._get("extent")}set extent(e){if(e==null)return;if(!e.width||!e.height)return void T.getLogger(this).error(new P("mapview:invalid-extent","invalid extent size"));if(!this.ready)return this._set("extent",e),this._set("center",void 0),this._set("viewpoint",void 0),this._set("scale",void 0),void this._set("zoom",void 0);let i;try{i=this._project(e,this.state.spatialReference)}catch(s){return void T.getLogger(this).error(new P("mapview:invalid-extent","could not project the value in the view's spatial reference",{error:s}))}const n=this.viewpoint;hl(n,n,i,this.state.size,{constraints:this.constraints}),this.viewpoint=n}get padding(){return this.ready?this.state.padding:this._get("padding")}set padding(e){this.ready?(this.state.padding=e,this._set("padding",this.state.padding)):this._set("padding",e)}get resolution(){return this.ready?(this.state.commitProperty("id"),this.state.resolution):0}get rotation(){return this.ready?(this.state.commitProperty("id"),this.state.rotation):this._get("rotation")}set rotation(e){if(isNaN(e))return;if(!this.ready)return void this._set("rotation",e);const i=this.viewpoint;bl(i,i,e),this.viewpoint=i}get scale(){return this.ready?(this.state.commitProperty("id"),this.state.scale):this._get("scale")}set scale(e){if(!e||isNaN(e))return;if(!this.ready){this._set("scale",e),this._set("zoom",void 0);const n=this._get("extent");return void(n&&(this._set("extent",void 0),this._set("center",n.center)))}const i=this.viewpoint;Qn(i,i,e),this.viewpoint=i}get viewpoint(){return this.ready?this.state.paddedViewState.viewpoint.clone():this._get("viewpoint")}set viewpoint(e){var a;if(e==null)return;if(!this.ready)return this._set("viewpoint",e),this._set("extent",void 0),this._set("center",void 0),this._set("zoom",void 0),void this._set("scale",void 0);let i,n;try{i=this._project(e,this.state.spatialReference),!e.scale||isNaN(e.scale)?n=new P("mapview:invalid-viewpoint",`invalid scale value of ${e.scale}`):e.targetGeometry==null&&(n=new P("mapview:invalid-viewpoint","geometry not defined"))}catch(o){n=new P("mapview:invalid-viewpoint","could not project the value in the view's spatial reference",{error:o})}if(n)return void T.getLogger(this).error(n);this._scaleBeforeChangingSpatialReference=null;const s=new me({targetGeometry:new D,scale:0,rotation:0});se(s,i),(a=this.constraints)==null||a.constrain(s,this.state.paddedViewState.viewpoint),this.state.viewpoint=s,this._set("viewpoint",s)}get zoom(){var e;return this.ready?((e=this.constraints)==null?void 0:e.scaleToZoom(this.scale))??-1:this._get("zoom")}set zoom(e){var s,a;if(!(e>=0))return;if(!this.ready){this._set("zoom",e),this._set("scale",void 0);const o=this._get("extent");return void(o&&(this._set("extent",void 0),this._set("center",o.center)))}const i=((s=this.constraints)==null?void 0:s.zoomToScale(e))??0;if(!i)return void this._set("zoom",-1);const n=this.viewpoint;Qn(n,n,i),this.viewpoint=n,this._set("zoom",((a=this.constraints)==null?void 0:a.scaleToZoom(this.scale))??-1)}getUserStartupOptions(e){if(!e[0]&&!e[1])return{center:void 0,rotation:void 0,scale:void 0};const{padding:i,constraints:n}=this,s=this._get("center"),a=this._get("extent"),o=this._get("scale"),l=this._get("rotation"),c=this._get("viewpoint"),p=this._get("zoom"),u=p!=null&&n!=null&&n.zoomToScale(p)||void 0;let m,d,g;const S=c==null?void 0:c.rotation,C=c==null?void 0:c.targetGeometry;(C==null?void 0:C.type)==="extent"?m=C:(C==null?void 0:C.type)==="point"&&(d=C,g=c==null?void 0:c.scale);const M=a??m;return{center:s??d??(M==null?void 0:M.center),rotation:l??S,scale:(o??u??g??(M&&ct(M,[e[0]-i.left-i.right,e[1]-i.top-i.bottom])))||void 0}}startup(e,i,n,s){var o;const a=e.targetGeometry;try{this._project(e,n)}catch(l){T.getLogger(this).warn(new xn("mapview:startup-projection-error","projection of initial viewpoint to the view's spatial reference, defaulting to the initial viewpoint.",{center:a.toJSON(),spatialReference:n,error:l})),e.targetGeometry=s||new D({x:0,y:0,spatialReference:n})}(o=this.constraints)==null||o.fit(e),this._set("state",new Il({padding:this.padding,size:i,viewpoint:e})),this._set("ready",!0)}teardown(){this._set("ready",!1);const{center:[e,i],spatialReference:n,rotation:s,scale:a}=this.state.paddedViewState,o=new D({x:e,y:i,spatialReference:n});this._set("viewpoint",null),this._set("extent",null),this._set("center",o),this._set("zoom",-1),this._set("rotation",s),this._set("scale",a),this._set("state",null)}changeSpatialReference(e){var c;const i=this.state.paddedViewState.clone();if(this._scaleBeforeChangingSpatialReference==null)this._scaleBeforeChangingSpatialReference=i.scale;else{const p=i.viewpoint.clone();p.scale=this._scaleBeforeChangingSpatialReference,i.viewpoint=p}const n=i.clone(),[s,a]=i.center;let o=null;try{o=this._project(new D({x:s,y:a,spatialReference:i.spatialReference}),e)}catch(p){lo()||T.getLogger(this).warn(new xn("mapview:spatial-reference-change","could not project the view's center to the new spatial reference",{center:o==null?void 0:o.toJSON(),spatialReference:e,error:p}))}o||(o=new D({x:0,y:0,spatialReference:e}));const l=Ui(new me({targetGeometry:new D,scale:0,rotation:0}),i.viewpoint,o);n.viewpoint=l;try{const u=[i.size[0]/2,i.size[1]/2],m=[u[0]+20,u[1]],d=i.toMap([0,0],m),{x:g,y:S}=this._project(new D({x:d[0],y:d[1],spatialReference:i.spatialReference}),e);d[0]=g,d[1]=S,n.toScreen(d,d);const C=vl(u,d,m),M=Math.hypot(d[0]-u[0],d[1]-u[1])/20;!Number.isFinite(M)||Math.abs(M)>4?(l.rotation=0,l.targetGeometry=new D({x:0,y:0,spatialReference:e})):(l.scale*=M,l.scale>ne("mapview-srswitch-adjust-rotation-scale-threshold")?l.rotation=0:l.rotation+=Number.isFinite(C)?C:0)}catch{}(c=this._get("constraints"))==null||c.constrain(l,void 0),this._get("state").viewpoint=l}resize(e,i){var o;if(!this.ready)return;const n=this.state;let s=this.state.paddedViewState.viewpoint;const a=this.state.paddedViewState.size.concat();n.size=[e,i],wl(s,s,a,this.state.paddedViewState.size,this.resizeAlign),s=((o=this.constraints)==null?void 0:o.constrain(s,void 0))??s,this.state.viewpoint=s}toMap(e){if(!this.ready)return null;const i=[0,0],[n,s]=this.state.toMap(i,[e.x,e.y]),a=this.state.spatialReference;return new D({x:n,y:s,spatialReference:a})}toScreen(e,i){if(!this.ready)return null;const n=this._project(e,this.state.spatialReference),s=[n.x,n.y];return(i==null?void 0:i.pickClosestTarget)===!1?this.state.toScreen(s,s):this.state.toScreenClosest(s,s),Z(s[0],s[1])}_project(e,i){var a;const n=(e==null?void 0:e.targetGeometry)||e;if(!i)return e;if(!n)return null;if(i.imageCoordinateSystem||(a=n.spatialReference)!=null&&a.imageCoordinateSystem||pt(i,n.spatialReference))return e;const s=Ct(n,i);if(!s)throw new P("mapview:projection-not-possible","projecting input geometry to target spatial reference returned a null value",{geometry:n,spatialReference:i});return Dl(e)?(e.targetGeometry=s,e):s}};function Dl(t){return(t==null?void 0:t.declaredClass)==="esri.Viewpoint"}r([h({type:D})],q.prototype,"center",null),r([h()],q.prototype,"constraints",void 0),r([h({type:Ye})],q.prototype,"extent",null),r([h({value:{top:0,right:0,bottom:0,left:0},cast:t=>({top:0,right:0,bottom:0,left:0,...t})})],q.prototype,"padding",null),r([h()],q.prototype,"ready",void 0),r([h()],q.prototype,"resizeAlign",void 0),r([h({readOnly:!0})],q.prototype,"resolution",null),r([h({type:Number})],q.prototype,"rotation",null),r([h({type:Number})],q.prototype,"scale",null),r([h({readOnly:!0})],q.prototype,"state",void 0),r([h({type:me})],q.prototype,"viewpoint",null),r([h()],q.prototype,"zoom",null),q=r([_("esri.views.2d.ViewStateManager")],q);function gn(t,e){switch(e){case"primary":return t.pointerType==="touch"||t.button===0;case"secondary":return t.pointerType!=="touch"&&t.button===2;case"tertiary":return t.pointerType!=="touch"&&t.button===1}}let ns=class extends V{constructor(e,i){super(!0),this._view=e,this.registerIncoming("double-click",i,n=>this._handleDoubleClick(n,i))}_handleDoubleClick(e,i){gn(e.data,"primary")&&(e.stopPropagation(),i?this._view.mapViewNavigation.zoomOut([e.data.x,e.data.y]):this._view.mapViewNavigation.zoomIn([e.data.x,e.data.y]))}},Rl=class extends V{constructor(e,i,n){super(!0),this.view=e,this.pointerType=i,this.registerIncoming("double-tap-drag",n,s=>this._handleDoubleTapDrag(s))}_handleDoubleTapDrag(e){const{data:i}=e,{pointerType:n}=i;if(n!==this.pointerType)return;e.stopPropagation();const{action:s,delta:a}=i,{view:o}=this,{mapViewNavigation:l}=o;switch(s){case"begin":{const{scale:c}=o;this._startScale=c,this._currentScale=c,this._previousDelta=a,l.begin();break}case"update":{if(this._previousDelta.y===a.y)return;this._previousDelta=a;const c=1.015**a.y,p=this._startScale*c,u=p/this._currentScale;l.setViewpointImmediate(u),this._currentScale=p;break}case"end":{const{constraints:c}=o,{effectiveLODs:p,snapToZoom:u}=c;if(!u||!p)return void l.end();const m=c.snapScale(this._currentScale),d=(a.y>0?Math.max(m,c.snapToPreviousScale(this._startScale)):Math.min(m,c.snapToNextScale(this._startScale)))/this._currentScale;l.zoom(d);break}}}},hi=class{constructor(e){this._callbacks=e,this._currentCount=0,this._callbacks.condition||(this._callbacks.condition=()=>!0)}handle(e){const i=e.data,n=i.pointers.size;switch(i.action){case"start":this._currentCount=n,this._emitStart(e);break;case"added":this._emitEnd(this._previousEvent),this._currentCount=n,this._emitStart(e);break;case"update":this._emitUpdate(e);break;case"removed":this._startEvent&&this._emitEnd(this._previousEvent),this._currentCount=n,this._emitStart(e);break;case"end":this._emitEnd(e),this._currentCount=0}this._previousEvent=e}_emitStart(e){var i,n;this._startEvent=e,(n=(i=this._callbacks).condition)!=null&&n.call(i,this._currentCount,e)&&this._callbacks.start(this._currentCount,e,this._startEvent)}_emitUpdate(e){var i,n;(n=(i=this._callbacks).condition)!=null&&n.call(i,this._currentCount,e)&&this._callbacks.update(this._currentCount,e,this._startEvent)}_emitEnd(e){var i,n;(n=(i=this._callbacks).condition)!=null&&n.call(i,this._currentCount,e)&&this._callbacks.end(this._currentCount,e,this._startEvent),this._startEvent=null}},Vl=class extends V{constructor(e,i,n){super(!0),this.view=e,this.pointerAction=i,this.registerIncoming("drag",n,s=>this._handleDrag(s)),this.registerIncoming("pointer-down",()=>this.stopMomentumNavigation())}onInstall(e){super.onInstall(e),this._dragEventSeparator=new hi({start:(i,n)=>{this.view.mapViewNavigation.pan.begin(this.view,n.data),n.stopPropagation()},update:(i,n)=>{this.view.mapViewNavigation.pan.update(this.view,n.data),n.stopPropagation()},end:(i,n)=>{this.view.mapViewNavigation.pan.end(this.view,n.data),n.stopPropagation()},condition:(i,n)=>i===1&&gn(n.data,this.pointerAction)})}_handleDrag(e){const i=this.view.mapViewNavigation;i.pinch.zoomMomentum||i.pinch.rotateMomentum?this.stopMomentumNavigation():this._dragEventSeparator.handle(e)}stopMomentumNavigation(){this.view.mapViewNavigation.pan.stopMomentumNavigation()}},Ll=class extends V{constructor(e,i,n){super(!0),this._view=e,this.pointerAction=i;const s=this._view.mapViewNavigation;this._dragEventSeparator=new hi({start:(a,o)=>{s.rotate.begin(this._view,o.data),o.stopPropagation()},update:(a,o)=>{s.rotate.update(this._view,o.data),o.stopPropagation()},end:(a,o)=>{s.rotate.end(),o.stopPropagation()},condition:(a,o)=>a===1&&gn(o.data,this.pointerAction)}),this.registerIncoming("drag",n,a=>this._dragEventSeparator.handle(a))}};function te(t){let e=t*t;return t<0&&(e*=-1),e}function Ol(t){return t.translation[0]=0,t.translation[1]=0,t.translation[2]=0,t.heading=0,t.tilt=0,t}function Al(t,e,i){const n=i,s=t.state,a=t.device,o=e.tiltDirection==="forward-down"?1:-1,l=1;return a.deviceType==="standard"?(n.translation[0]=te(s.axes[0]),n.translation[1]=te(s.axes[1]),n.translation[2]=te(s.buttons[7])-te(s.buttons[6]),n.heading=te(s.axes[2]),n.tilt=te(s.axes[3])):a.deviceType==="spacemouse"&&(n.translation[0]=1.2*te(s.axes[0]),n.translation[1]=1.2*te(s.axes[1]),n.translation[2]=2*-te(s.axes[2]),n.heading=1.2*te(s.axes[5]),n.tilt=1.2*te(s.axes[3])),n.tilt*=o,ho(n.translation,n.translation,l),n}function zl(t){return t.translation[0]===0&&t.translation[1]===0&&t.translation[2]===0&&t.heading===0&&t.tilt===0&&t.zoom===0}let Nl=class extends V{constructor(e){super(!0),this._view=e,this._frameTask=null,this._watchHandles=new Ts,this._currentDevice=null,this._transformation={translation:[0,0,0],heading:0,tilt:0,zoom:0},this._handle=this.registerIncoming("gamepad",i=>this._handleGamePadEvent(i)),this._handle.pause()}onInstall(e){super.onInstall(e),this._watchHandles.add([f(()=>{var i;return(i=this._view.navigation.gamepad)==null?void 0:i.enabled},i=>{i?(this._handle.resume(),this._frameTask||(this._frameTask=dt({update:n=>this._frameUpdate(n.deltaTime)}))):(this._handle.pause(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null))},B)])}onUninstall(){this._watchHandles.removeAll(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null),super.onUninstall()}_handleGamePadEvent(e){const i=this._view.navigation.gamepad.device;i&&e.data.device!==i||this._currentDevice&&this._currentDevice!==e.data.device||(e.data.action==="end"?(this._currentDevice=null,Ol(this._transformation)):(this._currentDevice=e.data.device,Al(e.data,this._view.navigation.gamepad,this._transformation)))}_frameUpdate(e){const i=this._transformation;if(zl(i))return;const n=this._view.viewpoint.clone(),s=this._view.navigation.gamepad.velocityFactor,a=Gl*s*e;li(n,n,[i.translation[0]*a,-i.translation[1]*a]);const o=1+i.translation[2]*Fl*e,l=this._view.constraints.rotationEnabled?-i.heading*Hl*e:0,c=this._view.size,p=[c[0]/2,c[1]];Qs(n,n,o,l,p,c);const u=this._view.constraints.constrain(n,this._view.viewpoint);this._view.viewpoint=u}};const Hl=.06,Gl=.7,Fl=6e-4;function aa(t){const e=()=>t(document.visibilityState==="visible");return document.addEventListener("visibilitychange",e),{remove:()=>document.addEventListener("visibilitychange",e)}}let Ul=class extends V{constructor(e,i,n){super(!0),this.view=e,this.keys=i,this._isSticky=!1,this._pressedKeys=new Set,this._timeout=void 0,this._currentDirection=void 0,this._stickyKeyDuration=200,this._handleKey=s=>{const a=this._keyMap[s.data.key];if(s.modifiers.has("Meta")||s.modifiers.has("Ctrl"))return void this._stopMovement();if(a==null)return;s.stopPropagation(),s.preventDefault();const o=s.type==="key-down";if(this._pressedKeys[o?"add":"delete"](a),o){if(this._direction===a)return;this._direction=a,this._isSticky=!1,this._setTimeout(()=>{this._isSticky&&this._handlePopKey()})}else{const l=this._timeout===void 0,c=this._pressedKeys.size>0;l||c?this._handlePopKey():this._isSticky=!0}},this._handlePopKey=()=>{this._direction=Array.from(this._pressedKeys).pop(),this._direction==null&&this._stopMovement()},this._stopMovement=()=>{this._isSticky=!1,this._direction=void 0,this._pressedKeys.clear(),this._setTimeout(void 0)},this._keyMap={[i.left]:"left",[i.right]:"right",[i.up]:"up",[i.down]:"down"},this.registerIncoming("key-down",n,this._handleKey),this.registerIncoming("key-up",n,this._handleKey),this.registerIncoming("blur",n,this._stopMovement),this._visibilityHandle=aa(s=>s?null:this._stopMovement())}onUninstall(){var e;this._stopMovement(),(e=this._visibilityHandle)==null||e.remove()}get _direction(){return this._currentDirection}set _direction(e){const i=this._currentDirection!=null;if(e!=null){if(i||this.view.mapViewNavigation.begin(),this._currentDirection!==e)switch(e){case"left":this.view.mapViewNavigation.continousPanLeft();break;case"right":this.view.mapViewNavigation.continousPanRight();break;case"up":this.view.mapViewNavigation.continousPanUp();break;case"down":this.view.mapViewNavigation.continousPanDown()}}else i&&this.view.mapViewNavigation.stop();this._currentDirection=e}_setTimeout(e){clearTimeout(this._timeout),this._timeout=e===void 0?void 0:setTimeout(()=>{this._timeout=void 0,e()},this._stickyKeyDuration)}},jl=class extends V{constructor(e,i,n){super(!0),this.view=e,this.keys=i,this._pressed=!1,this._keyToDirection={[i.clockwiseOption1]:"clockwise",[i.clockwiseOption2]:"clockwise",[i.counterClockwiseOption1]:"counterClockwise",[i.counterClockwiseOption2]:"counterClockwise",[i.resetOption1]:"reset",[i.resetOption2]:"reset"},this.registerIncoming("key-down",n,s=>this._handleKeyDown(s)),this.registerIncoming("key-up",n,s=>this._handleKeyUp(s)),this.registerIncoming("blur",n,()=>this._handleStop()),this._visibilityHandle=aa(s=>s?null:this._handleStop())}onUninstall(){var e;(e=this._visibilityHandle)==null||e.remove(),this._handleStop()}_handleKeyDown(e){e.data.repeat||this._handleKey(e,!0)}_handleKeyUp(e){this._handleKey(e,!1)}_handleStop(){this._pressed&&(this._pressed=!1,this.view.mapViewNavigation.stop())}_handleKey(e,i){const n=e.modifiers;if(n.size>0&&!n.has("Shift")||!this.view.constraints.rotationEnabled)return;const s=this._keyToDirection[e.data.key];if(this._pressed=s!=null,this._pressed){if(e.preventDefault(),i)switch(this.view.mapViewNavigation.begin(),s){case"clockwise":this.view.mapViewNavigation.continousRotateClockwise();break;case"counterClockwise":this.view.mapViewNavigation.continousRotateCounterclockwise();break;case"reset":this.view.mapViewNavigation.resetRotation()}else this._pressed=!1,this.view.mapViewNavigation.stop();e.stopPropagation()}}};var ht;(function(t){t[t.IN=0]="IN",t[t.OUT=1]="OUT"})(ht||(ht={}));let ql=class extends V{constructor(e,i,n){super(!0),this.view=e,this.keys=i,this._keysToZoomAction={},this.registerIncoming("key-down",n,s=>this._handleKeyDown(s)),i.zoomIn.forEach(s=>this._keysToZoomAction[s]=ht.IN),i.zoomOut.forEach(s=>this._keysToZoomAction[s]=ht.OUT)}_handleKeyDown(e){this._handleKey(e)}_handleKey(e){const i=e.modifiers;if(i.size>0&&!i.has("Shift"))return;const{key:n}=e.data;if(!(n in this._keysToZoomAction))return;const s=this._keysToZoomAction[n],{mapViewNavigation:a}=this.view;let o=null;switch(s){case ht.IN:o=a.zoomIn();break;case ht.OUT:o=a.zoomOut();break;default:return}a.begin(),o.then(()=>a.end()),e.stopPropagation()}};const Zl=.6;let Bl=class extends V{constructor(e,i){super(!0),this._view=e,this._canZoom=!0,this.registerIncoming("mouse-wheel",i,n=>this._handleMouseWheel(n))}_handleMouseWheel(e){if(!this._view.navigation.mouseWheelZoomEnabled||(e.preventDefault(),e.stopPropagation(),!this._canZoom))return;const i=this._view.mapViewNavigation,{x:n,y:s,deltaY:a}=e.data,o=1/Zl**(1/60*a),l=i.zoom(o,[n,s]);l&&(this._canZoom=!1,l.catch(()=>{}).then(()=>{this._canZoom=!0,i.end()}))}},Wl=class extends V{constructor(e){super(!0),this.view=e,this.registerIncoming("drag",n=>this._handleDrag(n)),this.registerIncoming("pointer-down",()=>this._stopMomentumNavigation());const i=this.view.mapViewNavigation;this._dragEventSeparator=new hi({start:(n,s)=>{i.pinch.begin(this.view,s.data),s.stopPropagation()},update:(n,s)=>{i.pinch.update(this.view,s.data),s.stopPropagation()},end:(n,s)=>{i.pinch.end(this.view),s.stopPropagation()},condition:n=>n>=2})}_handleDrag(e){this._dragEventSeparator.handle(e)}_stopMomentumNavigation(){this.view.mapViewNavigation.pinch.stopMomentumNavigation()}};function ss(t){const e=t.native;return e?{buttons:e.buttons.map(i=>i.pressed?i.value||1:0),axes:e.axes.map(i=>Xl(i,t.axisThreshold))}:{buttons:[],axes:[]}}function Kl(t,e){if(t.axes.length!==e.axes.length||t.buttons.length!==e.buttons.length)return!1;for(let i=0;i<t.axes.length;i++)if(t.axes[i]!==e.axes[i])return!1;for(let i=0;i<t.buttons.length;i++)if(t.buttons[i]!==e.buttons[i])return!1;return!0}function Yl(t){for(let e=0;e<t.axes.length;e++)if(t.axes[e]!==0)return!1;for(let e=0;e<t.buttons.length;e++)if(t.buttons[e]!==0)return!1;return!0}function Xl(t,e){const i=Math.abs(t);return i<e?0:Math.sign(t)*(i-e)/(1-e)}let Jl=class{constructor(e,i){this._element=e,this._input=i,this._hasEventListeners=!1,this._onConnectGamepad=a=>{this._connectGamepad(a.gamepad)},this._onDisconnectGamepad=a=>{const o=a.gamepad,l=o.index,c=this._inputDevices[l];c&&(this._emitGamepadEvent(o,ss(c),!1),this._inputDevices.splice(l,1),this._latestUpdate.splice(l,1),this._input.gamepad.devices.remove(c),this.ensurePollingState())},this._frameTask=null,this._latestUpdate=new Array,this._inputDevices=new Array,this._callback=null;const n="getGamepads"in window.navigator,s=window.isSecureContext;this.supported=n&&s,this.supported&&(this._forEachGamepad(a=>this._connectGamepad(a)),window.addEventListener("gamepadconnected",this._onConnectGamepad),window.addEventListener("gamepaddisconnected",this._onDisconnectGamepad),this.ensurePollingState())}destroy(){this.hasEventListeners=!1,this.supported&&(window.removeEventListener("gamepadconnected",this._onConnectGamepad),window.removeEventListener("gamepaddisconnected",this._onDisconnectGamepad))}set hasEventListeners(e){this._hasEventListeners!==e&&(this._hasEventListeners=e,this.ensurePollingState())}get _eventsEnabled(){return this.supported&&this._inputDevices.length>0&&this._hasEventListeners}set onEvent(e){this._callback=e}_connectGamepad(e){const i=new cn(e);i.deviceType!=="unknown"&&(this._inputDevices[e.index]=i,this._input.gamepad.devices.add(i)),this.ensurePollingState()}ensurePollingState(){this._eventsEnabled?this._startPolling():this._stopPolling()}_startPolling(){this._frameTask==null&&(this._frameTask=dt({update:()=>this._readGamepadState()}))}_stopPolling(){this._frameTask!=null&&(this._frameTask.remove(),this._frameTask=null,this._latestUpdate=new Array)}_readGamepadState(){const e=document.hasFocus(),i=this._element.contains(document.activeElement),n=this._input.gamepad.enabledFocusMode==="document"&&!e||this._input.gamepad.enabledFocusMode==="view"&&!i;this._forEachGamepad(s=>{const a=this._inputDevices[s.index];if(!a)return;const o=this._latestUpdate[s.index],l=ss(a),c=n||Yl(l);o&&(o.timestamp===s.timestamp||!o.active&&c||Kl(o.state,l))||this._emitGamepadEvent(s,l,!c)})}_forEachGamepad(e){const i=window.navigator.getGamepads();for(let n=0;n<i.length;n++){const s=i[n];this._validate(s)&&e(s)}}_emitGamepadEvent(e,i,n){const s=this._latestUpdate[e.index],a=s&&s.active;if(!a&&!n)return;const o=!a&&n?"start":a&&n?"update":"end";this._latestUpdate[e.index]={timestamp:e.timestamp,state:i,active:n},this._callback&&this._callback({device:this._inputDevices[e.index],state:i,action:o})}_validate(e){if(!e||!e.connected)return!1;for(let i=0;i<e.axes.length;i++)if(isNaN(e.axes[i]))return!1;return!0}};const as=ne("edge"),Ql=ne("chrome"),eh=ne("ff"),th=ne("safari"),os="esri-view-surface",tt={touchNone:`${os}--touch-none`,touchPan:`${os}--touch-pan`};let oa=class ra{constructor(e,i){this._input=i,this._active={},this._callback=()=>{},this._activePointerCaptures=new Set,this._keyDownState=new Set,this._eventId=1,this._browserTouchPanningEnabled=!1,this._element=e,e.getAttribute("tabindex")||e.setAttribute("tabindex","0"),this._eventHandlers={"key-down":this._handleKey,"key-up":this._handleKey,"pointer-down":this._handlePointer,"pointer-move":this._handlePointerPreventDefault,"pointer-up":this._handlePointerPreventDefault,"pointer-enter":this._handlePointer,"pointer-leave":this._handlePointer,"pointer-cancel":this._handlePointer,"mouse-wheel":this._handleMouseWheel,"pointer-capture-lost":this._handlePointerCaptureLost},this._updateTouchAction(),this._element.addEventListener("keydown",this._preventAltKeyDefault),this._gamepadSource=new Jl(e,this._input),this._gamepadSource.onEvent=n=>this._callback("gamepad",n)}destroy(){this._callback=()=>{},this.activeEvents=null,this._activePointerCaptures.forEach(e=>{this._releasePointerCaptureSafe(e)}),this._gamepadSource=F(this._gamepadSource),this._activePointerCaptures=null,this._removeTouchAction(),this._element.removeEventListener("keydown",this._preventAltKeyDefault)}get browserTouchPanningEnabled(){return this._browserTouchPanningEnabled}set browserTouchPanningEnabled(e){this._browserTouchPanningEnabled=e,this._updateTouchAction(),this._updateTouchEventHandling()}set onEventReceived(e){this._callback=e}set activeEvents(e){for(const i in this._active)if(!e||!e.has(i)){const n=this._active[i];this._element.removeEventListener(ki[i],n),delete this._active[i]}e&&e.forEach(i=>{if(!this._active[i]&&ki[i]){const n=(this._eventHandlers[i]||this._handleDefault).bind(this,i);this._element.addEventListener(ki[i],n),this._active[i]=n}}),this._gamepadSource.hasEventListeners=(e==null?void 0:e.has("gamepad"))??!1}setPointerCapture(e,i){i?this._setPointerCatpureSafe(e.pointerId):(this._releasePointerCaptureSafe(e.pointerId),this._activePointerCaptures.delete(e.pointerId))}_updateTouchAction(){this._element.classList.remove(this._browserTouchPanningEnabled?tt.touchNone:tt.touchPan),this._element.classList.add(this._browserTouchPanningEnabled?tt.touchPan:tt.touchNone)}_updateTouchEventHandling(){this._browserTouchPanningEnabled?this._element.addEventListener("touchmove",this._preventMultiTouchPanning):this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_removeTouchAction(){this._element.classList.remove(tt.touchNone),this._element.classList.remove(tt.touchPan),this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_setPointerCatpureSafe(e){try{this._element.setPointerCapture(e),this._activePointerCaptures.add(e)}catch{}}_releasePointerCaptureSafe(e){try{if(this._element.hasPointerCapture&&!this._element.hasPointerCapture(e))return;this._element.releasePointerCapture(e)}catch{}}_updateNormalizedPointerLikeEvent(e,i){const n=Ns(this._element,e);return ra.test.disableSubpixelCoordinates&&(n.x=Math.round(n.x),n.y=Math.round(n.y)),i.x=n.x,i.y=n.y,i}_handleKey(e,i){const n=Tr(i);n&&e==="key-up"&&this._keyDownState.delete(n);const s={native:i,key:n,repeat:!!n&&this._keyDownState.has(n)};n&&e==="key-down"&&this._keyDownState.add(s.key),this._callback(e,s)}_handlePointer(e,i){const n=this._updateNormalizedPointerLikeEvent(i,{native:i,x:0,y:0,pointerType:i.pointerType,button:i.button,buttons:i.buttons,eventId:this._eventId++});this._callback(e,n)}_handlePointerPreventDefault(e,i){const n=this._updateNormalizedPointerLikeEvent(i,{native:i,x:0,y:0,pointerType:i.pointerType,button:i.button,buttons:i.buttons,eventId:this._eventId++});i.preventDefault(),this._callback(e,n)}_handleMouseWheel(e,i){let n=i.deltaY;switch(i.deltaMode){case 0:as&&(n=n/document.documentElement.clientHeight*600);break;case 1:n*=30;break;case 2:n*=900}as?n*=.7:Ql||th?n*=.6:eh&&(n*=1.375);const s=100,a=Math.abs(n);a>s&&(n=n/a*200/(1+Math.exp(-.02*(a-s))));const o=this._updateNormalizedPointerLikeEvent(i,{native:i,x:0,y:0,deltaY:n});this._callback(e,o)}_handlePointerCaptureLost(e,i){this._activePointerCaptures.delete(i.pointerId),this._handleDefault(e,i)}_handleDefault(e,i){const n={native:i};i.preventDefault(),this._callback(e,n)}_preventAltKeyDefault(e){e.key==="Alt"&&e.preventDefault()}_preventMultiTouchPanning(e){e.touches.length>1&&e.preventDefault()}};oa.test={disableSubpixelCoordinates:!1};const ki={"key-down":"keydown","key-up":"keyup","pointer-down":"pointerdown","pointer-up":"pointerup","pointer-move":"pointermove","mouse-wheel":"wheel","pointer-capture-got":"gotpointercapture","pointer-capture-lost":"lostpointercapture","context-menu":"contextmenu","pointer-enter":"pointerenter","pointer-leave":"pointerleave","pointer-cancel":"pointercancel",focus:"focus",blur:"blur"};let ih=class extends V{constructor(){super(!0),this.registerIncoming("context-menu",e=>{e.data.native.preventDefault()})}};const N={maximumClickDelay:300,movementUntilMouseDrag:1.5,movementUntilPenDrag:6,movementUntilTouchDrag:6,holdDelay:500,maximumDoubleClickDelay:250,maximumDoubleClickDistance:10,maximumDoubleTouchDelay:350,maximumDoubleTouchDistance:35};function Qt(t,e){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)}function nh(t,e){const i=e.x-t.x,n=e.y-t.y;return Math.sqrt(i*i+n*n)}function sh(t,e){if(e?(e.radius=0,e.center.x=0,e.center.y=0):e={radius:0,center:Z()},t.length===0)return e;if(t.length===1)return e.center.x=t[0].x,e.center.y=t[0].y,e;if(t.length===2){const[k,j]=t,[ee,ye]=[j.x-k.x,j.y-k.y];return e.radius=Math.sqrt(ee*ee+ye*ye)/2,e.center.x=(k.x+j.x)/2,e.center.y=(k.y+j.y)/2,e}let i=0,n=0;for(let k=0;k<t.length;k++)i+=t[k].x,n+=t[k].y;i/=t.length,n/=t.length;const s=t.map(k=>k.x-i),a=t.map(k=>k.y-n);let o=0,l=0,c=0,p=0,u=0,m=0,d=0;for(let k=0;k<s.length;k++){const j=s[k],ee=a[k],ye=j*j,Xe=ee*ee;o+=ye,l+=Xe,c+=j*ee,p+=ye*j,u+=Xe*ee,m+=j*Xe,d+=ee*ye}const g=.5*(p+m),S=.5*(u+d),C=o*l-c*c,M=(g*l-S*c)/C,I=(o*S-c*g)/C,U=Z(M+i,I+n);return{radius:Math.sqrt(M*M+I*I+(o+l)/t.length),center:U}}function Ke(t){const{native:e}=t,{pointerId:i,button:n,pointerType:s}=e;return s==="mouse"?`${i}:${n}`:`${s}`}let ah=class extends V{constructor(e=N.maximumDoubleClickDelay,i=N.maximumDoubleClickDistance,n=N.maximumDoubleTouchDelay,s=N.maximumDoubleTouchDistance,a=Pt){super(!1),this._maximumDoubleClickDelay=e,this._maximumDoubleClickDistance=i,this._maximumDoubleTouchDelay=n,this._maximumDoubleTouchDistance=s,this._clock=a,this._doubleTapDragReady=!1,this._doubleTapDragActive=!1,this._dragStartCenter=Z(0,0),this._pointerState=new Map,this._doubleTapDrag=this.registerOutgoing("double-tap-drag"),this._dragEventSeparator=new hi({start:(o,l)=>this._dragStart(o,l),update:(o,l)=>this._dragUpdate(l),end:(o,l)=>this._dragEnd(l)}),this.registerIncoming("drag",o=>this._dragEventSeparator.handle(o)),this.registerIncoming("pointer-down",o=>this._handlePointerDown(o)),this.registerIncoming("pointer-up",()=>this._handlePointerUp())}onUninstall(){this._pointerState.forEach(e=>{e.doubleTapTimeout=Me(e.doubleTapTimeout)})}get hasPendingInputs(){return ti(this._pointerState,e=>e.doubleTapTimeout!=null)}_clearPointerDown(e){const i=this._pointerState.get(e);i&&(i.doubleTapTimeout=Me(i.doubleTapTimeout),this._pointerState.delete(e),this.refreshHasPendingInputs())}_createDoubleTapDragData(e,i,n){const{button:s,buttons:a,pointer:o,pointers:l,pointerType:c,timestamp:p}=n;return{action:e,delta:i,button:s,buttons:a,pointer:o,pointers:l,pointerType:c,timestamp:p}}_dragStart(e,i){if(!this._doubleTapDragReady||e!==1)return;this._doubleTapDragReady=!1,this._doubleTapDragActive=!0;const{data:n,modifiers:s}=i,{center:a}=n;this._dragStartCenter=a;const o=this._createDoubleTapDragData("begin",Z(0,0),n);this._doubleTapDrag.emit(o,void 0,s),i.stopPropagation()}_dragUpdate(e){if(!this._doubleTapDragActive)return;const{data:i,modifiers:n}=e,{center:s}=i,a=Z(s.x-this._dragStartCenter.x,s.y-this._dragStartCenter.y),o=this._createDoubleTapDragData("update",a,i);this._doubleTapDrag.emit(o,void 0,n),e.stopPropagation()}_dragEnd(e){if(!this._doubleTapDragActive)return;const{data:i,modifiers:n}=e,{center:s}=i,a=Z(s.x-this._dragStartCenter.x,s.y-this._dragStartCenter.y),o=this._createDoubleTapDragData("end",a,i);this._doubleTapDrag.emit(o,void 0,n),this._doubleTapDragActive=!1,e.stopPropagation()}_handlePointerDown(e){const{data:i}=e,n=Ke(i),s=this._pointerState.get(n),{pointerType:a}=i.native;if(s){const o=a==="touch"?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;this._clearPointerDown(n),Qt(s.event.data,i)>o?this._storePointerDown(e):this._doubleTapDragReady=!0}else this._storePointerDown(e)}_handlePointerUp(){this._doubleTapDragReady=!1}_storePointerDown(e){const{data:i}=e,{pointerType:n}=i.native,s=Ke(i),a=n==="touch"?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay,o=this._clock.setTimeout(()=>this._clearPointerDown(s),a);this._pointerState.set(s,{event:e,doubleTapTimeout:o}),this.refreshHasPendingInputs()}},oh=class extends V{constructor(e){super(!1),this._navigationTouch=e,this._startStateModifiers=new Set,this._activePointerMap=new Map,this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._drag=this.registerOutgoing("drag"),this.registerIncoming("pointer-drag",this._handlePointerDrag.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-capture-lost",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-cancel",this._handlePointerUpAndPointerLost.bind(this))}_createPayload(e,i,n,s){return{action:e,pointerType:this._pointerType,button:this._mouseButton,buttons:i.buttons,timestamp:s,pointers:rh(this._activePointerMap),pointer:i,angle:n.angle,radius:n.radius,center:n.center}}_addPointer(e){const i=e.native.pointerId,n=Vt(this._activePointerMap).angle,s={event:e,initialAngle:0,lastAngle:0};this._activePointerMap.set(i,s);const a=Ft(s,la(this._activePointerMap));s.initialAngle=a,s.lastAngle=a,this._updatePointerAngles(n)}_updatePointer(e){if(e&&e.x==null&&e.y==null)return;const i=e.native.pointerId,n=this._activePointerMap.get(i);n?n.event=e:this._addPointer(e)}_removePointer(e){const i=Vt(this._activePointerMap).angle;this._activePointerMap.delete(e),this._updatePointerAngles(i)}_updatePointerAngles(e){const i=Vt(this._activePointerMap);this._activePointerMap.forEach(n=>{n.initialAngle=Ft(n,i)-e,n.lastAngle=Ft(n,i)-e})}_emitEvent(e,i,n){const s=Vt(this._activePointerMap);this._drag.emit(this._createPayload(e,i,s,n),void 0,this._startStateModifiers)}_handlePointerUpAndPointerLost(e){const i=e.data.native.pointerId,n=di(e.timestamp);this._activePointerMap.get(i)&&(this._activePointerMap.size===1?(this._updatePointer(e.data),!this._isCurrentDragSuppressed&&this._emitEvent("end",e.data,n),this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._removePointer(i)):(this._removePointer(i),this._emitEvent("removed",e.data,di(e.timestamp))))}_handlePointerDrag(e){const i=e.data,n=i.currentEvent,s=di(e.timestamp);switch(i.action){case"start":case"update":this._isDragging?this._activePointerMap.has(n.native.pointerId)?(this._updatePointer(n),!this._isCurrentDragSuppressed&&this._emitEvent("update",n,s)):(this._addPointer(n),this._emitEvent("added",n,s),this._isCurrentDragSuppressed=this._isSuppressed):(this._updatePointer(n),this._pointerType=e.data.startEvent.pointerType,this._mouseButton=e.data.startEvent.button,this._startStateModifiers=e.modifiers,this._isDragging=!0,this._isCurrentDragSuppressed=this._isSuppressed,!this._isCurrentDragSuppressed&&this._emitEvent("start",n,s))}}get _isSuppressed(){return!!this._navigationTouch&&!this._navigationTouch.browserTouchPanEnabled&&this._pointerType==="touch"&&this._activePointerMap.size===1}};function la(t){const e=[];return t.forEach(i=>{e.push(Z(i.event.x,i.event.y))}),sh(e)}function Vt(t){const e=la(t);let i=0;return t.forEach(n=>{let s=Ft(n,e),a=s-n.lastAngle;for(;a>Math.PI;)a-=2*Math.PI;for(;a<-Math.PI;)a+=2*Math.PI;s=n.lastAngle+a,n.lastAngle=s;const o=s-n.initialAngle;i+=o}),i/=t.size||1,{angle:i,radius:e.radius,center:e.center}}function rh(t){const e=new Map;return t.forEach((i,n)=>e.set(n,i.event)),e}function Ft(t,e){const i=t.event,n=i.x-e.center.x,s=i.y-e.center.y;return Math.atan2(s,n)}var rs;(function(t){t[t.Left=0]="Left",t[t.Middle=1]="Middle",t[t.Right=2]="Right",t[t.Back=3]="Back",t[t.Forward=4]="Forward",t[t.Undefined=-1]="Undefined"})(rs||(rs={}));let lh=class extends V{constructor(e=N.maximumDoubleClickDelay,i=N.maximumDoubleClickDistance,n=N.maximumDoubleTouchDelay,s=N.maximumDoubleTouchDistance,a=Pt){super(!1),this._maximumDoubleClickDelay=e,this._maximumDoubleClickDistance=i,this._maximumDoubleTouchDelay=n,this._maximumDoubleTouchDistance=s,this._clock=a,this._pointerState=new Map,this._immediateDoubleClick=this.registerOutgoing("immediate-double-click"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUp.bind(this))}onUninstall(){this._pointerState.forEach(e=>{e.immediateDoubleClick&&e.immediateDoubleClick.timeoutHandle.remove()}),super.onUninstall()}_handlePointerDown(e){const i=e.data,n=Ke(i);if(!this._pointerState.has(n)){const s={downButton:i.native.button,x:i.x,y:i.y,immediateDoubleClick:null};this._pointerState.set(n,s),this.startCapturingPointer(i.native)}}_handlePointerUp(e){const i=e.data,n=Ke(i),s=this._pointerState.get(n);if(s&&s.downButton===i.native.button){const a=s.immediateDoubleClick,o=e.data.native.pointerType==="touch"?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;a?(a.timeoutHandle.remove(),Qt(a,e.data)>o?this._startImmediateDoubleClick(e,s):(this._immediateDoubleClick.emit(e.data,void 0,a.modifiers),this._removeState(i))):Qt(s,e.data)>o?this._removeState(i):this._startImmediateDoubleClick(e,s)}}_startImmediateDoubleClick(e,i){const n=e.data.native.pointerType==="touch"?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay;i.immediateDoubleClick={x:e.data.x,y:e.data.y,modifiers:e.modifiers,timeoutHandle:this._clock.setTimeout(()=>this._removeState(e.data),n)}}_removeState(e){const i=Ke(e);this._pointerState.delete(i),this.stopCapturingPointer(e.native),this.refreshHasPendingInputs()}},hh=class extends V{constructor(e=N.maximumClickDelay,i=N.movementUntilMouseDrag,n=N.movementUntilPenDrag,s=N.movementUntilTouchDrag,a=N.holdDelay,o=Pt){super(!1),this._maximumClickDelay=e,this._movementUntilMouseDrag=i,this._movementUntilPenDrag=n,this._movementUntilTouchDrag=s,this._holdDelay=a,this._clock=o,this._pointerState=new Map,this._pointerDrag=this.registerOutgoing("pointer-drag"),this._immediateClick=this.registerOutgoing("immediate-click"),this._pointerHold=this.registerOutgoing("hold"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",l=>{this._handlePointerLoss(l,"pointer-up")}),this.registerIncoming("pointer-capture-lost",l=>{this._handlePointerLoss(l,"pointer-capture-lost")}),this.registerIncoming("pointer-cancel",l=>{this._handlePointerLoss(l,"pointer-cancel")}),this._moveHandle=this.registerIncoming("pointer-move",this._handlePointerMove.bind(this)),this._moveHandle.pause()}onUninstall(){this._pointerState.forEach(e=>{e.holdTimeout=Me(e.holdTimeout)}),super.onUninstall()}_handlePointerDown(e){const i=e.data,n=i.native.pointerId;let s=null;this._pointerState.size===0&&(s=this._clock.setTimeout(()=>{const o=this._pointerState.get(n);if(o){if(!o.isDragging){const l=o.previousEvent;this._pointerHold.emit(l,void 0,e.modifiers),o.holdEmitted=!0}o.holdTimeout=null}},this._holdDelay));const a={startEvent:i,previousEvent:i,startTimestamp:e.timestamp,isDragging:!1,downButton:i.native.button,holdTimeout:s,modifiers:new Set};this._pointerState.set(n,a),this.startCapturingPointer(i.native),this._moveHandle.resume(),this._pointerState.size>1&&this._startDragging(e)}_createPointerDragData(e,i,n){return{action:e,startEvent:i.startEvent,previousEvent:i.previousEvent,currentEvent:n}}_handlePointerMove(e){const i=e.data,n=i.native.pointerId,s=this._pointerState.get(n);s&&(s.isDragging?this._pointerDrag.emit(this._createPointerDragData("update",s,i),void 0,s.modifiers):nh(i,s.startEvent)>this._getDragThreshold(i.native.pointerType)&&this._startDragging(e),s.previousEvent=i)}_getDragThreshold(e){switch(e){case"touch":return this._movementUntilTouchDrag;case"pen":return this._movementUntilPenDrag;default:return this._movementUntilMouseDrag}}_startDragging(e){const i=e.data,n=i.native.pointerId;this._pointerState.forEach(s=>{s.holdTimeout!=null&&(s.holdTimeout.remove(),s.holdTimeout=null),s.isDragging||(s.modifiers=e.modifiers,s.isDragging=!0,n===s.startEvent.native.pointerId?this._pointerDrag.emit(this._createPointerDragData("start",s,i)):this._pointerDrag.emit(this._createPointerDragData("start",s,s.previousEvent),e.timestamp))})}_handlePointerLoss(e,i){const n=e.data,s=n.native.pointerId,a=this._pointerState.get(s);a&&(a.holdTimeout!=null&&(a.holdTimeout.remove(),a.holdTimeout=null),a.isDragging?this._pointerDrag.emit(this._createPointerDragData("end",a,i==="pointer-up"?n:a.previousEvent),void 0,a.modifiers):i==="pointer-up"&&a.downButton===n.native.button&&e.timestamp-a.startTimestamp<=this._maximumClickDelay&&!a.holdEmitted&&this._immediateClick.emit(n),this._pointerState.delete(s),this.stopCapturingPointer(n.native),this._pointerState.size===0&&this._moveHandle.pause())}},ch=class extends V{constructor(e=N.maximumDoubleClickDelay,i=N.maximumDoubleClickDistance,n=N.maximumDoubleTouchDelay,s=N.maximumDoubleTouchDistance,a=Pt){super(!1),this._maximumDoubleClickDelay=e,this._maximumDoubleClickDistance=i,this._maximumDoubleTouchDelay=n,this._maximumDoubleTouchDistance=s,this._clock=a,this._pointerState=new Map,this._click=this.registerOutgoing("click"),this._doubleClick=this.registerOutgoing("double-click"),this.registerIncoming("immediate-click",this._handleImmediateClick.bind(this)),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this))}onUninstall(){this._pointerState.forEach(e=>e.doubleClickTimer=Me(e.doubleClickTimer))}get hasPendingInputs(){return ti(this._pointerState,e=>e.doubleClickTimer!=null)}_clearDoubleClickTimer(e,i){const n=this._pointerState.get(e);n&&(n.doubleClickTimer=Me(n.doubleClickTimer),i&&this._click.emit(n.event.data,void 0,n.event.modifiers),this._pointerState.delete(e),this.refreshHasPendingInputs())}_doubleClickTimeoutExceeded(e){const i=this._pointerState.get(e);i.pointerDownCount===1&&this._click.emit(i.event.data,void 0,i.event.modifiers),i.doubleClickTimer=null,this._pointerState.delete(e),this.refreshHasPendingInputs()}_getPointerId(e){const{pointerId:i,pointerType:n,button:s}=e.native;return n==="mouse"?`${i}:${s}`:`${n}`}_handleImmediateClick(e){const i=e.data,{pointerType:n}=i.native,s=this._getPointerId(i);if(!this._pointerState.has(s))return void this._startClick(e);const a=this._pointerState.get(s),{data:o,modifiers:l}=a.event,c=n==="touch"?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;Qt(o,i)>c?(this._clearDoubleClickTimer(s,!0),this._startClick(e)):(this._clearDoubleClickTimer(s,!1),a.pointerDownCount===2&&this._doubleClick.emit(o,void 0,l))}_handlePointerDown(e){const i=Ke(e.data),n=this._pointerState.get(i);n&&(n.pointerDownCount+=1)}_startClick(e){const{data:i}=e,{native:{pointerType:n}}=i,s=Ke(i),a=n==="touch"?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay,o=this._clock.setTimeout(()=>this._doubleClickTimeoutExceeded(s),a),l=1;this._pointerState.set(s,{event:e,doubleClickTimer:o,pointerDownCount:l}),this.refreshHasPendingInputs()}};const Lt={counter:"Ctrl",pan:{left:"ArrowLeft",right:"ArrowRight",up:"ArrowUp",down:"ArrowDown"},zoom:{zoomIn:["=","+"],zoomOut:["-","_"]},rotate:{clockwiseOption1:"a",clockwiseOption2:"A",counterClockwiseOption1:"d",counterClockwiseOption2:"D",resetOption1:"n",resetOption2:"N"}};let Ue=class extends b{initialize(){const t=()=>{var e;return(e=this.view)==null?void 0:e.ready};this.addHandles([kt(()=>!t(),()=>this._disconnect()),kt(t,()=>this._connect())])}destroy(){this._disconnect()}get latestPointerType(){var t;return(t=this._inputManager)==null?void 0:t.latestPointerType}get latestPointerLocation(){var t;return(t=this._inputManager)==null?void 0:t.latestPointerLocation}get multiTouchActive(){var t;return((t=this._inputManager)==null?void 0:t.multiTouchActive)??!1}_disconnect(){this.view.viewEvents.disconnect(),this._inputManager=F(this._inputManager)}_connect(){const t=this.view.surface,e=new oa(t,this.view.input),i=[new lh,new hh,new ch,new oh(this.view.navigation),new ah],n=new J({eventSource:e,recognizers:i});n.installHandlers("prevent-context-menu",[new ih],Ae.INTERNAL),n.installHandlers("navigation",[new Wl(this.view),new Nl(this.view),new Bl(this.view),new ns(this.view),new ns(this.view,[Lt.counter]),new Vl(this.view,"primary"),new Ul(this.view,Lt.pan),new ql(this.view,Lt.zoom),new jl(this.view,Lt.rotate),new Ll(this.view,"secondary"),new Rl(this.view,"touch")],Ae.INTERNAL),this.view.viewEvents.connect(n),this._source=e,this._inputManager=n,f(()=>{var s,a;return(a=(s=this.view)==null?void 0:s.navigation)==null?void 0:a.browserTouchPanEnabled},s=>{this._source&&(this._source.browserTouchPanningEnabled=!s)},B)}get test(){return{inputManager:this._inputManager}}};r([h()],Ue.prototype,"view",void 0),r([h()],Ue.prototype,"latestPointerType",null),r([h()],Ue.prototype,"latestPointerLocation",null),r([h()],Ue.prototype,"multiTouchActive",null),Ue=r([_("esri.views.2d.input.MapViewInputManager")],Ue);const ph=Ue;let je=class extends b{constructor(){super(...arguments),this.color=new ge([0,255,255]),this.haloOpacity=1,this.fillOpacity=.25}equals(e){return this.color.equals(e.color)&&(this.haloColor||this.color).equals(e.haloColor||e.color)&&this.haloOpacity===e.haloOpacity&&this.fillOpacity===e.fillOpacity}};r([h({type:ge})],je.prototype,"color",void 0),r([h({type:ge})],je.prototype,"haloColor",void 0),r([h()],je.prototype,"haloOpacity",void 0),r([h()],je.prototype,"fillOpacity",void 0),je=r([_("esri.views.2d.support.HighlightOptions")],je);const ha=je;async function dh(t,e,i){const n=Gs(e)?Hs(t,e):e;if(!t.ready||isNaN(n.x)||isNaN(n.y))return{screenPoint:n,results:[]};let s=new Set;const a=new Set;let o=!1,l=null,c=null;i!=null&&i.include?hs(i.include,ls(t,d=>{s.add(d),Mi(d,g=>a.add(g))},(d,g)=>{a.add(d),s.add(g)},d=>{l||(l=new Set),l.add(d)},d=>s.add(d),()=>o=!0)):(o=!0,s=new Set(t.allLayerViews),s.forEach(d=>{Mi(d,g=>a.add(g))})),i!=null&&i.exclude&&hs(i.exclude,ls(t,d=>{s.delete(d),Mi(d,g=>a.delete(g))},d=>a.delete(d),d=>{c||(c=new Set),c.add(d)}));const p=t.allLayerViews.filter(d=>!d.suspended&&s.has(d)).reverse(),u=t.toMap(n);let m=[...o?t.graphicsView.hitTest(u).map(d=>({type:"graphic",graphic:d,layer:null,mapPoint:u})):[],...await Promise.all(p.map(d=>d.hitTest(u,n)).toArray())].filter(Ri).flat().filter(Ri);return m=m.filter(d=>{var g;return d.type!=="graphic"||((g=d.layer)==null?void 0:g.type)!=="subtype-group"||a.has(d.graphic.layer)}),l&&(m=m.filter(d=>!("graphic"in d)||!d.graphic||(l==null?void 0:l.has(Yi(d.graphic))))),c&&(m=m.filter(d=>!("graphic"in d)||!d.graphic||!(c!=null&&c.has(Yi(d.graphic))))),{screenPoint:n,results:m}}function ls(t,e,i,n,s,a){return o=>{if(o instanceof co){if(o.layer===t)a==null||a();else{const l=t.allLayerViews.find(c=>c.layer===o.layer);l&&(s==null||s(l))}n(Yi(o))}else if(o.type==="subtype-sublayer"){const l=t.allLayerViews.find(c=>c.layer===o.parent);l&&i(o,l)}else{const l=t.allLayerViews.find(c=>c.layer===o);l&&e(l)}}}function hs(t,e){if(t)if(Pn(t))for(const i of t)if(Pn(i))for(const n of i)e(n);else e(i);else e(t)}function Yi(t){var i,n;const e=t.getObjectId();return e?`${((i=t.layer)==null?void 0:i.uid)??((n=t.sourceLayer)==null?void 0:n.uid)??"MapView"}/${e}`:`"MapView/${t.uid}`}function Mi({layer:t},e){t.type==="subtype-group"&&t.sublayers.forEach(i=>{e(i)})}function uh(t,e,i){const{ctx:n,canvas:s}=ca(t,i),a=n.getImageData(0,0,t.width,t.height),o=yh(s,e);return pa(s),{dataUrl:o,data:a}}function mh(t,e){const{ctx:i,canvas:n}=ca(t,e),s=i.getImageData(0,0,t.width,t.height);return pa(n),s}function ca(t,e){const i=gh();e.premultipliedAlpha&&bh(t),i.width=t.width,i.height=t.height;const n=i.getContext("2d",{willReadFrequently:!0});return n.putImageData(t,0,0),e.flipY&&wh(n),{ctx:n,canvas:i}}function pa(t){t.width=0,t.height=0}function gh(){return xi==null&&(xi=document.createElement("canvas")),xi}let xi=null;function yh(t,e){const i=Th[e.format],n=e.quality/100;return t.toDataURL(i,n)}function _h(t,e){const i=fh(t),n=Mh[i];return{format:i,quality:Bt(e??n,0,100)}}function vh(t,e){return e/Math.max(t[0],t[1])}function Up(t,e,i,n=0,s=0,a=t.width-n,o=t.height-s,l=!1){const{data:c}=t,{width:p,height:u,data:m}=e,d=a/p,g=o/u,S=Math.ceil(d/2),C=Math.ceil(g/2),M=t.width;for(let I=0;I<u;I++)for(let U=0;U<p;U++){const k=4*(U+(l?u-I-1:I)*p);let j=0,ee=0,ye=0,Xe=0,yn=0,_n=0;const Ea=(I+.5)*g;for(let $t=Math.floor(I*g);$t<(I+1)*g;$t++){const vn=Math.abs(Ea-($t+.5))/C,Ia=(U+.5)*d,Da=vn*vn;for(let Et=Math.floor(U*d);Et<(U+1)*d;Et++){const fn=Math.abs(Ia-(Et+.5))/S,Je=Math.sqrt(Da+fn*fn);if(Je>=1)continue;let Pe=2*Je*Je*Je-3*Je*Je+1;const Qe=4*(n+Et+(s+$t)*M);_n+=Pe*c[Qe+3],ee+=Pe,!i&&c[Qe+3]<255&&(Pe=Pe*c[Qe+3]/255),ye+=Pe*c[Qe],Xe+=Pe*c[Qe+1],yn+=Pe*c[Qe+2],j+=Pe}}m[k]=ye/j,m[k+1]=Xe/j,m[k+2]=yn/j,m[k+3]=_n/ee}return e}function fh(t){switch(t){case"png":case"jpg":case"jpeg":return t;default:return kh}}function wh(t){t.save(),t.globalCompositeOperation="copy",t.scale(1,-1),t.translate(0,-t.canvas.height),t.drawImage(t.canvas,0,0),t.restore()}function bh(t){const e=t.data,i=e.length;for(let n=0;n<i;n+=4){const s=e[n+3];if(s!==255&&s>0){const a=255/s;e[n]=e[n]*a,e[n+1]=e[n+1]*a,e[n+2]=e[n+2]*a}}}const Th={png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg"},cs=98,kh="png",Mh={png:100,jpg:cs,jpeg:cs},da={flipY:!0,premultipliedAlpha:!0};async function xh(t,e){const i=await ua(t,e),{format:n,quality:s}=_h(e==null?void 0:e.format,e==null?void 0:e.quality);return uh(i,{format:n,quality:s,rotation:0,disableDecorations:!1},da)}async function Ph(t,e){const i=await ua(t,e);return mh(i,da)}function ua(t,e){const i=$h(e||{},Sh(t.stage,t.size),t.size,t.padding),n=Ch(e,t.allLayerViews);return t.stage.takeScreenshot(i,n,t.backgroundColor,e==null?void 0:e.rotation)}function Ch(t={},e){if(!t.layers)return;const i=[];return t.layers.forEach(n=>{const s=e.find(a=>a.layer.id===n.id);s!=null&&s.container&&i.push(s.container)}),i}function Sh(t,e){return Math.min(4,vh(e,Math.min(4096,t.context.parameters.maxTextureSize)))}function $h(t,e,i,n){t.ignorePadding&&(n={left:0,right:0,top:0,bottom:0});let s=null;t.width!=null&&t.height!=null?s=[t.width,t.height]:t.width==null&&t.height!=null?s=[t.height,t.height]:t.width!=null&&t.height==null?s=[t.width,t.width]:t.width==null&&t.height==null&&(s=null);const a=i[0]-(n.left+n.right),o=i[1]-(n.top+n.bottom);let l,c,p=t.area||{x:0,y:0,width:a,height:o};if(s){const u=a/o,m=s[0]/s[1];if(m>u){const d=p.width/m;p={x:p.x,y:Math.round(p.y+(p.height-d)/2),width:p.width,height:Math.round(d)}}else{const d=p.height*m;p={x:Math.round(p.x+(p.width-d)/2),y:p.y,width:Math.round(d),height:p.height}}}else s=[p.width,p.height];return s[0]>p.width?(l=Math.min(s[0]/p.width,e),c=s[0]/p.width/l):(l=1,c=s[0]/p.width),{cropArea:{x:Math.round((p.x+n.left)*l),y:Math.round((p.y+n.top)*l),width:Math.round(p.width*l),height:Math.round(p.height*l)},outputScale:c,resolutionScale:l}}const ps=160;let bt=class extends b{constructor(){super(...arguments),this._timer=void 0}get stationary(){return!this._timer}flip(){this._timestamp=performance.now(),this._timer==null&&(this._timer=setInterval(()=>{performance.now()-this._timestamp>=ps&&this.clear()},ps))}clear(){this._timer&&(clearInterval(this._timer),this._timer=void 0)}};r([h()],bt.prototype,"_timer",void 0),r([h()],bt.prototype,"stationary",null),bt=r([_("esri.views.2d.support.StationaryManager")],bt);const Eh=t=>t.includes("Brush");let ma=class{constructor(){this._names=new Map}begin(e){this._names.has(e)||(this._names.set(e,!1),Eh(e)&&this.record("Esri.FirstDraw"),performance.mark(`Esri.${e}.Start`))}end(e){this._names.has(e)&&!this._names.get(e)&&(this._names.set(e,!0),performance.mark(`Esri.${e}.End`))}record(e){this._names.has(e)||(this._names.set(e,!0),performance.mark(`Esri.${e}`))}};function Ih(t){const e=ar(t);if(!e.available)return new P("webgl:required",t==="3d"?"WebGL2 is required but not supported.":"WebGL is required but not supported.",new Error().stack);if(t==="3d"&&e.majorPerformanceCaveat)return new P("webgl:major-performance-caveat-detected","Your WebGL implementation doesn't seem to support hardware accelerated rendering. Check your browser settings or if your GPU is in a blocklist.");if(!e.supportsHighPrecisionFragment)return new P("webgl:high-precision-fragment-required","WebGL support for high precision fragment shaders is required but not supported.");if(!e.supportsVertexShaderSamplers)return new P("webgl:vertex-shader-samplers-required","WebGL support for vertex shader samplers is required but not supported.");if(e.type===or.WEBGL1){if(!e.supportsElementIndexUint)return new P("webgl:element-index-uint-required","WebGL support for uint vertex indices is required but not supported.");if(!e.supportsStandardDerivatives)return new P("webgl:standard-derivatives-required","WebGL support for standard derivatives is required but not supported.");if(!e.supportsInstancedArrays)return new P("webgl:instanced-arrays-required","WebGL support for instanced rendering is required but not supported.")}return null}function Dh(t){return t&&"nodeType"in t}function Rh(t){return t&&typeof t.render=="function"}const ds={component:"esri-component"};let qe=class extends b{constructor(){super(...arguments),this.widget=null}destroy(){var e;this.node=null,(e=this.widget)==null||e.destroy()}get id(){var e,i;return this._get("id")??((e=this.widget)==null?void 0:e.id)??((i=this.node)==null?void 0:i.id)}set id(e){this._set("id",e)}set node(e){const i=this._get("node");e!==i&&(e&&e.classList.add(ds.component),i&&i.classList.remove(ds.component),this._set("node",e))}castNode(e){var i;return(i=this.widget)==null||i.destroy(),e?typeof e=="string"||Dh(e)?(this._set("widget",null),Ps(e)):(Rh(e)&&!e.domNode&&(e.domNode=document.createElement("div")),this._set("widget",e),e.domNode):(this._set("widget",null),null)}};r([h()],qe.prototype,"id",null),r([h()],qe.prototype,"node",null),r([Ne("node")],qe.prototype,"castNode",null),r([h({readOnly:!0})],qe.prototype,"widget",void 0),qe=r([_("esri.views.ui.Component")],qe);const Ut=qe,ga="calcite-mode-";function Vh(){return getComputedStyle(document.body).getPropertyValue("--esri-calcite-mode-name").replaceAll(/\s|'|"/g,"")}function Lh(){return Vh().startsWith("dark")}function Oh(){return`${ga}${Lh()?"dark":"light"}`}function Ah(t){zh(t),t.classList.add(Oh())}function zh(t){Array.from(t.classList).forEach(e=>{e.startsWith(ga)&&t.classList.remove(e)})}const Nh={left:0,top:0,bottom:0,right:0},ya={bottom:30,top:15,right:15,left:15},_e="esri-ui",W={ui:_e,corner:`${_e}-corner`,innerContainer:`${_e}-inner-container`,manualContainer:`${_e}-manual-container`,cornerContainer:`${_e}-corner-container`,topLeft:`${_e}-top-left`,topRight:`${_e}-top-right`,bottomLeft:`${_e}-bottom-left`,bottomRight:`${_e}-bottom-right`};function Hh(t){return t&&!t._started&&typeof t.postMixInProperties=="function"&&typeof t.buildRendering=="function"&&typeof t.postCreate=="function"&&typeof t.startup=="function"}function Ot(t){return t===0?"0":`${t}px`}function Pi(t){const e=typeof t=="object"&&t!==null&&Object.getPrototypeOf(t);return(e===null||e===Object.prototype)&&("component"in t||"index"in t||"position"in t)?t:null}function Ci(t,{top:e,bottom:i,left:n,right:s}){t.style.top=e,t.style.bottom=i,t.style.left=n,t.style.right=s}let he=class extends Ji.EventedAccessor{constructor(t){super(t),this._cornerNameToContainerLookup={},this._positionNameToContainerLookup={},this._components=new Array,this._componentMap=new Map,this._locale=po(),this.view=null,this._applyViewPadding=()=>{const e=this.container;e&&Ci(e,this._toPixelPosition(this._getViewPadding()))},this._applyUIPadding=()=>{const e=this._innerContainer;e&&Ci(e,this._toPixelPosition(this.padding))},this._initContainers()}initialize(){this.addHandles([f(()=>{var t;return[(t=this.view)==null?void 0:t.padding,this.container]},this._applyViewPadding,B),f(()=>this.padding,this._applyUIPadding,B),f(()=>[this.container,this._locale],([t,e])=>{t&&t.setAttribute("lang",e)},B),fs(t=>{this._locale=t})])}destroy(){this.container=null;for(const t of this._components)t.destroy();this._components.length=0,this._componentMap.clear()}set container(t){const e=this._get("container");t!==e&&(t&&(t.classList.add(W.ui),Ah(t),this._attachContainers(t)),e&&(e.classList.remove(W.ui),Ci(e,{top:"",bottom:"",left:"",right:""}),Cs(e)),this._set("container",t))}get height(){var s;const t=((s=this.view)==null?void 0:s.height)??0;if(t===0)return t;const e=this._getViewPadding(),{top:i,bottom:n}=e;return Math.max(t-i-n,0)}get padding(){return this._get("padding")}set padding(t){this._overrideIfSome("padding",t)}castPadding(t){return typeof t=="number"?{bottom:t,top:t,right:t,left:t}:{...ya,...t}}get width(){var s;const t=((s=this.view)==null?void 0:s.width)??0;if(t===0)return t;const e=this._getViewPadding(),{left:i,right:n}=e;return Math.max(t-i-n,0)}add(t,e){let i,n,s;if(Array.isArray(t))return void t.forEach(o=>this.add(o,e));const a=Pi(t);a&&({index:i,position:e,component:t,key:n}=a),e&&typeof e=="object"&&({index:i,key:n,position:e,internal:s}=e),!t||e&&!this._isValidPosition(e)||this._add(t,e,i,n,s)}remove(t,e){var n;if(!t)return;if(Array.isArray(t))return t.map(s=>this.remove(s,e));const i=this._find(t);if(i){if(this._componentMap.has(i)&&((n=this._componentMap.get(i))==null?void 0:n.key)!==e)return;const s=this._components.indexOf(i),a=i.node.parentNode;return a==null||a.removeChild(i.node),this._componentMap.delete(i),this._components.splice(s,1)[0]}}empty(t,e={removeInternal:!1}){if(Array.isArray(t)){for(const s of t)this.empty(s,e);return}const i=this._positionNameToContainerLookup[t??"manual"],n=Array.prototype.slice.call(i.children).map(s=>this._findByNode(s)).filter(s=>{var a;return s==null?!1:!(((a=this._componentMap.get(s))==null?void 0:a.internal)??!1)||e.removeInternal});for(const s of n)this.remove(s)}move(t,e){if(Array.isArray(t)&&t.forEach(a=>this.move(a,e)),!t)return;let i;const n=Pi(t)||Pi(e);if(n&&(i=n.index,e=n.position,t=n.component||t),e&&!this._isValidPosition(e))return;const s=this.remove(t);s&&this.add(s,{position:e,index:i})}find(t){if(!t)return null;const e=this._findById(t);return e&&(e.widget||e.node)}getComponents(t,e={includeInternal:!1}){return t?Array.isArray(t)?t.flatMap(i=>this._getComponentsAtPosition(i,e)):this._getComponentsAtPosition(t,e):this._components.filter(i=>{var n;return e.includeInternal||!((n=this._componentMap.get(i))!=null&&n.internal)}).map(({widget:i,node:n})=>i??n)}getPosition(t){for(const e in this._positionNameToContainerLookup)if(this._positionNameToContainerLookup[e].contains(t))return e;return null}_add(t,e,i,n,s){t instanceof Ut||(t=new Ut({node:t})),this._place({component:t,position:e,index:i}),this._components.push(t),this._componentMap.set(t,{key:n,internal:s})}_find(t){return t?t instanceof Ut?this._findByComponent(t):typeof t=="string"?this._findById(t):this._findByNode(t.domNode||t):null}_getViewPadding(){var t;return((t=this.view)==null?void 0:t.padding)??Nh}_attachContainers(t){t.appendChild(this._innerContainer),t.appendChild(this._manualContainer)}_initContainers(){const t=document.createElement("div");t.classList.add(W.innerContainer,W.cornerContainer);const e=document.createElement("div");e.classList.add(W.innerContainer,W.manualContainer);const i=document.createElement("div");i.classList.add(W.topLeft,W.corner),t.appendChild(i);const n=document.createElement("div");n.classList.add(W.topRight,W.corner),t.appendChild(n);const s=document.createElement("div");s.classList.add(W.bottomLeft,W.corner),t.appendChild(s);const a=document.createElement("div");a.classList.add(W.bottomRight,W.corner),t.appendChild(a),this._innerContainer=t,this._manualContainer=e;const o=zo();this._cornerNameToContainerLookup={"top-left":i,"top-right":n,"bottom-left":s,"bottom-right":a,"top-leading":o?n:i,"top-trailing":o?i:n,"bottom-leading":o?a:s,"bottom-trailing":o?s:a},this._positionNameToContainerLookup={manual:e,...this._cornerNameToContainerLookup}}_isValidPosition(t){return!!this._positionNameToContainerLookup[t]}_place(t){const e=t.position??"manual",{component:i,index:n}=t,s=this._positionNameToContainerLookup[e],a=n!=null&&n>-1;if(Hh(i.widget)&&i.widget.startup(),!a)return void s.appendChild(i.node);const o=Array.from(s.children);if(n===0)return void(s.firstChild?Dn(i.node,s.firstChild):s.appendChild(i.node));n>=o.length?s.appendChild(i.node):Dn(i.node,o[n])}_toPixelPosition(t){return{top:Ot(t.top),left:Ot(t.left),right:Ot(t.right),bottom:Ot(t.bottom)}}_findByComponent(t){return this._components.find(e=>e===t)??null}_findById(t){return this._components.find(({id:e})=>e===t)??null}_findByNode(t){return this._components.find(({node:e})=>e===t)??null}_getComponentsAtPosition(t,e){const i=this._positionNameToContainerLookup[t];return Array.prototype.slice.call(i.children).map(n=>this._findByNode(n)).filter(Ri).filter(n=>{var s;return e.includeInternal||!((s=this._componentMap.get(n))!=null&&s.internal)}).map(({widget:n,node:s})=>n??s)}};r([h()],he.prototype,"_locale",void 0),r([h()],he.prototype,"container",null),r([h()],he.prototype,"height",null),r([h({value:ya})],he.prototype,"padding",null),r([Ne("padding")],he.prototype,"castPadding",null),r([h()],he.prototype,"view",void 0),r([h()],he.prototype,"width",null),he=r([_("esri.views.ui.UI")],he);const Gh=he;function us(t,e){return t&&"copyright"in t&&(!e||typeof t.originOf=="function"&&t.originOf("copyright")==="user")}function Fh(t,e){return t.length!==e.length||t.some((i,n)=>i.text!==e[n].text)}function At(t,e,i){!i||!e||t.find(n=>n.layerView===e&&n.text===i)||t.push({text:i,layerView:e})}function Uh(t){return t.type==="bing-maps"}const Ce=[];let ot=class extends b{constructor(t){super(t),this._clear=()=>{this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.removeHandles("suspension"),this.notifyChange("state")},this._pendingAttributions=new Set,this._fetchedAttributionData=new Map,this.items=new O,this.view=null,this._allLayerViewsChange=e=>{var n;this.removeHandles("suspension");const i=(n=this.view)==null?void 0:n.allLayerViews;i&&this.addHandles(i.map(s=>f(()=>{var a;return[s.suspended,(a=s.layer)==null?void 0:a.attributionVisible]},()=>this._updateAttributionItems())).toArray(),"suspension"),e!=null&&e.removed&&e.removed.forEach(s=>{this._pendingAttributions.delete(s),this._fetchedAttributionData.delete(s)}),this._updateAttributionItems()},this.addHandles([tn(()=>{var e;return(e=this.view)==null?void 0:e.allLayerViews},"change",e=>this._allLayerViewsChange(e),{onListenerAdd:()=>this._allLayerViewsChange(),onListenerRemove:this._clear}),kt(()=>{var e;return((e=this.view)==null?void 0:e.stationary)===!0},()=>this._updateAttributionItems())])}destroy(){this.view=null,this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.items.removeAll()}get state(){var t;return(t=this.view)!=null&&t.ready?this._pendingAttributions.size>0?"loading":"ready":"disabled"}_updateAttributionItems(){const t=this.view,e=t==null?void 0:t.allLayerViews;Ce.length=0,t&&e?(e.forEach(i=>{var a,o;if(i.suspended||!((a=i.layer)!=null&&a.attributionVisible))return;const n=i.layer;if(us(n,"user"))return void At(Ce,i,n.copyright);if(n.hasAttributionData){if(this._fetchedAttributionData.has(i)){const l=this._fetchedAttributionData.get(i);return void(l?At(Ce,i,this._getDynamicAttribution(l,t,n)):us(n)&&At(Ce,i,n.copyright))}return void this._fetchAttributionData(i)}const s="portalItem"in n?(o=n.portalItem)==null?void 0:o.accessInformation:void 0;At(Ce,i,s||n.copyright)}),Fh(this.items,Ce)&&(this.items.removeAll(),this.items.addMany(Ce)),Ce.length=0,this.notifyChange("state")):this._clear()}async _fetchAttributionData(t){if(this._pendingAttributions.has(t))return;this._pendingAttributions.add(t);const e=await uo(t.layer.fetchAttributionData());if(this._pendingAttributions.has(t)){const i=e.ok?this._createContributionIndex(e.value,Uh(t.layer)):null;this._pendingAttributions.delete(t),this._fetchedAttributionData.set(t,i)}this._updateAttributionItems()}_createContributionIndex(t,e){const i=t.contributors,n={};if(!i)return n;for(let s=0;s<i.length;s++){const a=i[s],o=a.coverageAreas;if(!o)return;for(const l of o){const c=l.bbox,p=l.zoomMin-(e&&l.zoomMin?1:0),u=l.zoomMax-(e&&l.zoomMax?1:0),m=new Ye({xmin:c[1],ymin:c[0],xmax:c[3],ymax:c[2],spatialReference:nn.WGS84}),d={extent:mo(m),attribution:a.attribution||"",score:l.score!=null?l.score:100,id:s};for(let g=p;g<=u;g++)n[g]??(n[g]=[]),n[g].push(d)}}return n.maxKey=Math.max.apply(null,Object.keys(n)),n}_getDynamicAttribution(t,e,i){var p;const{extent:n,scale:s}=e;let a=((p=i.tileInfo)==null?void 0:p.scaleToZoom(s))??0;if(a=Math.min(t.maxKey??0,Math.round(a)),!n||a==null||a<=-1)return"";const o=t[a],l=go(n.center.clone().normalize(),e.spatialReference),c=new Set;return o?o.filter(u=>{const m=u.id,d=!c.has(m)&&l&&u.extent&&xs(u.extent,l);return d&&c.add(m),d}).sort((u,m)=>m.score-u.score||u.objectId-m.objectId).map(u=>u.attribution).join(", "):""}};r([h({readOnly:!0,type:O})],ot.prototype,"items",void 0),r([h({readOnly:!0})],ot.prototype,"state",null),r([h()],ot.prototype,"view",void 0),ot=r([_("esri.widgets.Attribution.AttributionViewModel")],ot);const _a=ot,it="esri-attribution",He={base:it,poweredBy:`${it}__powered-by`,sources:`${it}__sources`,open:`${it}--open`,sourcesOpen:`${it}__sources--open`,link:`${it}__link`,widgetIcon:xe.description};let G=class extends St{constructor(e,i){super(e,i),this._isOpen=!1,this._attributionTextOverflowed=!1,this._prevSourceNodeHeight=0,this._resizeObserver=new ResizeObserver(n=>n.forEach(({target:s})=>this._checkSourceTextOverflow(s))),this.iconClass=He.widgetIcon,this.icon=null,this.itemDelimiter=" | ",this.messages=null,this.viewModel=new _a}initialize(){this.addHandles(tn(()=>{var e;return(e=this.viewModel)==null?void 0:e.items},"change",()=>this.scheduleRender()))}destroy(){var e;(e=this._resizeObserver)==null||e.disconnect()}get _isInteractive(){return this._isOpen||this._attributionTextOverflowed}get attributionText(){return this.viewModel.items.reduce((e,i)=>(e.includes(i.text)||e.push(i.text),e),[]).join(this.itemDelimiter)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){const e={[He.open]:this._isOpen};return z("div",{bind:this,class:this.classes(He.base,X.widget,e),dir:"ltr",onclick:this._toggleState,onkeydown:this._toggleState},this._renderSourcesNode(),this._renderPoweredBy())}_renderPoweredBy(){return z("div",{class:He.poweredBy},"Powered by"," ",z("a",{class:He.link,href:"http://www.esri.com/",rel:"noreferrer",target:"_blank"},"Esri"))}_renderSourcesNode(){const e=this._isOpen,i=this._isInteractive,n=i?0:void 0,{attributionText:s}=this,a={[He.sourcesOpen]:e,[X.interactive]:i};return z("div",{afterCreate:this._afterSourcesNodeCreate,bind:this,class:this.classes(He.sources,a),innerHTML:s,tabIndex:n})}_afterSourcesNodeCreate(e){this._prevSourceNodeHeight=e.clientWidth,this._resizeObserver.observe(e)}_checkSourceTextOverflow(e){let i=!1;const{clientHeight:n,clientWidth:s,scrollWidth:a}=e,o=a>s,l=this._attributionTextOverflowed!==o;if(this._attributionTextOverflowed=o,l&&(i=!0),this._isOpen){const c=n<this._prevSourceNodeHeight;this._prevSourceNodeHeight=n,c&&(this._isOpen=!1,i=!0)}i&&this.scheduleRender()}_toggleState(){this._isInteractive&&(this._isOpen=!this._isOpen)}};r([h()],G.prototype,"_isOpen",void 0),r([h()],G.prototype,"_isInteractive",null),r([h()],G.prototype,"_attributionTextOverflowed",void 0),r([h()],G.prototype,"_prevSourceNodeHeight",void 0),r([h({readOnly:!0,dependsOn:["viewModel.items.length","itemDelimiter"]})],G.prototype,"attributionText",null),r([h()],G.prototype,"iconClass",void 0),r([h()],G.prototype,"icon",void 0),r([h()],G.prototype,"itemDelimiter",void 0),r([h()],G.prototype,"label",null),r([h(),si("esri/widgets/Attribution/t9n/Attribution")],G.prototype,"messages",void 0),r([h()],G.prototype,"view",null),r([h({type:_a})],G.prototype,"viewModel",void 0),r([hn()],G.prototype,"_toggleState",null),G=r([_("esri.widgets.Attribution")],G);const jh=G;function qh(t){var e,i;return((e=t==null?void 0:t.spatialReference)==null?void 0:e.isWebMercator)||((i=t==null?void 0:t.spatialReference)==null?void 0:i.isGeographic)||!1}const Zh="esri.widgets.CompassViewModel";let Ze=class extends rr(b){constructor(e){super(e),this.orientation={x:0,y:0,z:0},this.view=null,this._updateForCamera=this._updateForCamera.bind(this),this._updateForRotation=this._updateForRotation.bind(this),this._updateRotationWatcher=this._updateRotationWatcher.bind(this)}initialize(){this.addHandles(f(()=>this.view,this._updateRotationWatcher,B))}destroy(){this.view=null}get canShowNorth(){return qh(this.view)}get state(){var e;return!((e=this.view)!=null&&e.ready)||this.view.type==="2d"&&!this.view.constraints.rotationEnabled?"disabled":this.canShowNorth?"compass":"rotation"}reset(){var i,n;if(!((i=this.view)!=null&&i.ready))return;const e={};((n=this.view)==null?void 0:n.type)==="2d"?e.rotation=0:e.heading=0,this.callGoTo({target:e})}_updateForRotation(e){e!=null&&(this.orientation={z:e})}_updateForCamera(e){if(!e)return;const i=-e.heading;this.orientation={x:0,y:0,z:i}}_updateRotationWatcher(e){this.removeAllHandles(),e&&this.addHandles(e.type==="2d"?f(()=>e==null?void 0:e.rotation,this._updateForRotation,B):f(()=>e==null?void 0:e.camera,this._updateForCamera,B))}};r([h({readOnly:!0})],Ze.prototype,"canShowNorth",null),r([h()],Ze.prototype,"orientation",void 0),r([h({readOnly:!0})],Ze.prototype,"state",null),r([h()],Ze.prototype,"view",void 0),Ze=r([_(Zh)],Ze);const va=Ze,ms="esri-compass",Si={base:ms,widgetIcon:xe.locateCircled,iconContainer:`${ms}__icon-container`};let ce=class extends St{constructor(e,i){super(e,i),this.iconClass=Si.widgetIcon,this.icon=null,this.messages=null,this.viewModel=new va,this._reset=()=>{this.viewModel.reset()},this._toRotationTransform=n=>({transform:`rotateZ(${n.z}deg)`})}loadDependencies(){return No({button:()=>w(()=>import("./calcite-button-ddac965b.js"),["./calcite-button-ddac965b.js","./jsxFactory-8f2e778f.js","./uuid-fb53ae2e.js","./index-e42a63f9.js","./label2-f86245b7.js","./interactive-b1644484.js","./loadable-771c79be.js","./t9n-61ead37b.js","./observers-51354515.js","./icon-4db32148.js","./loader-7a827692.js"],import.meta.url),icon:()=>w(()=>import("./calcite-icon-ffa84850.js"),["./calcite-icon-ffa84850.js","./icon-4db32148.js","./jsxFactory-8f2e778f.js","./uuid-fb53ae2e.js","./index-e42a63f9.js","./observers-51354515.js"],import.meta.url)})}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}reset(){return this.viewModel.reset()}render(){const{orientation:e,state:i}=this.viewModel,n=i==="rotation"?"arrow-up":"compass-needle",{messages:s}=this;return z("div",{class:this.classes(Si.base,X.widget)},z("calcite-button",{"aria-label":s.reset,class:X.widgetButton,disabled:i==="disabled",kind:"neutral",onclick:this._reset,round:!0,scale:"s",title:s.reset},z("div",{"aria-hidden":"true",class:Si.iconContainer,title:s.reset},z("calcite-icon",{icon:n,scale:"m",styles:this._toRotationTransform(e)}))))}};r([h()],ce.prototype,"goToOverride",null),r([h()],ce.prototype,"iconClass",void 0),r([h()],ce.prototype,"icon",void 0),r([h()],ce.prototype,"label",null),r([h(),si("esri/widgets/Compass/t9n/Compass")],ce.prototype,"messages",void 0),r([h()],ce.prototype,"view",null),r([h({type:va})],ce.prototype,"viewModel",void 0),ce=r([_("esri.widgets.Compass")],ce);const Bh=ce,nt="esri-navigation-toggle",ve={base:nt,widgetIcon:xe.pan2,button:`${nt}__button`,activeButton:`${nt}__button--active`,panButton:`${nt}__button--pan`,rotateButton:`${nt}__button--rotate`,isLayoutHorizontal:`${nt}--horizontal`};let rt=class extends b{constructor(e){super(e),this.navigationMode="pan",this.view=null}initialize(){this.addHandles(kt(()=>{var e;return(e=this.view)==null?void 0:e.inputManager},()=>this._setNavigationMode()))}destroy(){this.view=null}get state(){var e,i;return(e=this.view)!=null&&e.ready&&((i=this.view)==null?void 0:i.type)==="3d"?"ready":"disabled"}toggle(){this.state!=="disabled"&&(this.navigationMode=this.navigationMode!=="pan"?"pan":"rotate",this._setNavigationMode())}_setNavigationMode(){var i;const e=(i=this.view)==null?void 0:i.inputManager;e&&(e.primaryDragAction=this.navigationMode==="pan"?"pan":"rotate")}};r([h({readOnly:!0})],rt.prototype,"state",null),r([h()],rt.prototype,"navigationMode",void 0),r([h()],rt.prototype,"view",void 0),rt=r([_("esri.widgets.NavigationToggleViewModel")],rt);const fa=rt;let ie=class extends St{constructor(e,i){super(e,i),this.iconClass=ve.widgetIcon,this.icon=null,this.messages=null,this.viewModel=new fa}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}set layout(e){e!=="horizontal"&&(e="vertical"),this._set("layout",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}toggle(){return this.viewModel.toggle()}render(){var c,p;const e=((c=this.viewModel)==null?void 0:c.state)==="disabled",i=((p=this.viewModel)==null?void 0:p.navigationMode)==="pan",n={[X.disabled]:e,[ve.isLayoutHorizontal]:this.layout==="horizontal"},s={[ve.activeButton]:i},a={[ve.activeButton]:!i},o=e?-1:0,l=this.messages.toggle;return z("div",{"aria-label":l,bind:this,class:this.classes(ve.base,X.widget,n),onclick:this._toggle,onkeydown:this._toggle,tabIndex:o,title:l},z("div",{class:this.classes(ve.button,X.widgetButton,ve.panButton,s)},z("span",{class:xe.pan})),z("div",{class:this.classes(ve.button,X.widgetButton,ve.rotateButton,a)},z("span",{class:xe.rotate})))}_toggle(){this.toggle()}};r([h()],ie.prototype,"iconClass",void 0),r([h()],ie.prototype,"icon",void 0),r([h()],ie.prototype,"label",null),r([h({value:"vertical"})],ie.prototype,"layout",null),r([h(),si("esri/widgets/NavigationToggle/t9n/NavigationToggle")],ie.prototype,"messages",void 0),r([h()],ie.prototype,"view",null),r([h({type:fa})],ie.prototype,"viewModel",void 0),r([hn()],ie.prototype,"_toggle",null),ie=r([_("esri.widgets.NavigationToggle")],ie);const Wh=ie,L="esri-feature",Kh={base:L,container:`${L}__size-container`,title:`${L}__title`,main:`${L}__main-container`,btn:`${L}__button`,icon:`${L}__icon`,content:`${L}__content`,contentNode:`${L}__content-node`,contentNodeText:`${L}__content-node--text`,contentElement:`${L}__content-element`,text:`${L}__text`,lastEditedInfo:`${L}__last-edited-info`,fields:`${L}__fields`,fieldHeader:`${L}__field-header`,fieldData:`${L}__field-data`,fieldDataDate:`${L}__field-data--date`,loadingSpinnerContainer:`${L}__loading-container`,spinner:`${L}__loading-spinner`};let Te=class extends St{constructor(){super(...arguments),this.enabled=!0,this.iconClass=null,this.icon=null,this.title=""}render(){const t=this.enabled?0:-1,e={[X.disabled]:!this.enabled,[X.interactive]:this.enabled};return z("div",{bind:this,class:this.classes(X.widgetButton,X.widget,e),onclick:this._triggerAction,onkeydown:this._triggerAction,role:"button",tabIndex:t,title:this.title},z("span",{"aria-hidden":"true",class:this.classes(Kh.icon,this.iconClass??""),role:"presentation"}),z("span",{class:xe.fontFallbackText},this.title))}_triggerAction(){this.action.call(this)}};r([h()],Te.prototype,"action",void 0),r([h()],Te.prototype,"enabled",void 0),r([h()],Te.prototype,"iconClass",void 0),r([h()],Te.prototype,"icon",void 0),r([h()],Te.prototype,"title",void 0),r([hn()],Te.prototype,"_triggerAction",null),Te=r([_("esri.widgets.IconButton")],Te);const gs=Te;let Be=class extends b{get canZoomIn(){var i,n,s;if(!((i=this.view)==null?void 0:i.ready))return!1;const e=(s=(n=this.view)==null?void 0:n.constraints)==null?void 0:s.effectiveMaxScale;return e===0||this._scale>e}get canZoomOut(){var n;const{view:t}=this;if(!(t==null?void 0:t.ready))return!1;const i=(n=t.constraints)==null?void 0:n.effectiveMinScale;return i===0||this._scale<i}get _scale(){var e,i,n;const t=(i=(e=this.view)==null?void 0:e.animation)==null?void 0:i.target;return(t&&"then"in t||t==null?void 0:t.scale)??((n=this.view)==null?void 0:n.scale)??0}};r([h({readOnly:!0})],Be.prototype,"canZoomIn",null),r([h({readOnly:!0})],Be.prototype,"canZoomOut",null),r([h()],Be.prototype,"view",void 0),r([h()],Be.prototype,"_scale",null),Be=r([_("esri.widgets.Zoom.ZoomConditions2D")],Be);const Yh=Be;let lt=class extends b{get canZoomIn(){return!!this.view.ready}get canZoomOut(){return!!this.view.ready}};r([h({readOnly:!0})],lt.prototype,"canZoomIn",null),r([h({readOnly:!0})],lt.prototype,"canZoomOut",null),r([h()],lt.prototype,"view",void 0),lt=r([_("esri.widgets.Zoom.ZoomConditions3D")],lt);const Xh=lt;let Ve=class extends b{constructor(e){super(e)}destroy(){this.view=null}get canZoomIn(){return this._zoomConditions!=null&&this._zoomConditions.canZoomIn}get canZoomOut(){var e;return this._zoomConditions!=null&&((e=this._zoomConditions)==null?void 0:e.canZoomOut)}get state(){var e;return(e=this.view)!=null&&e.ready?"ready":"disabled"}set view(e){e?e.type==="2d"?this._zoomConditions=new Yh({view:e}):e.type==="3d"&&(this._zoomConditions=new Xh({view:e})):this._zoomConditions=null,this._set("view",e)}zoomIn(){if(!this.canZoomIn)return;const e=this.view;e.type==="2d"?e.mapViewNavigation.zoomIn():Cn(e.goTo({zoomFactor:2}))}zoomOut(){if(!this.canZoomOut)return;const e=this.view;e.type==="2d"?e.mapViewNavigation.zoomOut():Cn(e.goTo({zoomFactor:.5}))}};r([h()],Ve.prototype,"_zoomConditions",void 0),r([h()],Ve.prototype,"canZoomIn",null),r([h()],Ve.prototype,"canZoomOut",null),r([h({readOnly:!0})],Ve.prototype,"state",null),r([h()],Ve.prototype,"view",null),Ve=r([_("esri.widgets.Zoom.ZoomViewModel")],Ve);const wa=Ve,$i={base:"esri-zoom",widgetIcon:xe.zoomInMagnifyingGlass,horizontalLayout:"esri-zoom--horizontal"};let pe=class extends St{constructor(t,e){super(t,e),this.iconClass=$i.widgetIcon,this.icon=null,this.messages=null,this.viewModel=new wa}initialize(){this._zoomInButton=new gs({action:this.zoomIn.bind(this),iconClass:xe.plus}),this._zoomOutButton=new gs({action:this.zoomOut.bind(this),iconClass:xe.minus})}destroy(){this._zoomInButton=F(this._zoomInButton),this._zoomOutButton=F(this._zoomOutButton)}get label(){var t;return((t=this.messages)==null?void 0:t.widgetLabel)??""}set label(t){this._overrideIfSome("label",t)}set layout(t){t!=="horizontal"&&(t="vertical"),this._set("layout",t)}set view(t){this.viewModel.view=t}get view(){return this.viewModel.view}render(){const t=this.viewModel,e={[$i.horizontalLayout]:this.layout==="horizontal"},{canZoomIn:i,canZoomOut:n}=t;this._zoomInButton.enabled=i,this._zoomOutButton.enabled=n;const{zoomIn:s,zoomOut:a}=this.messages;return this._zoomInButton.title=s,this._zoomOutButton.title=a,z("div",{class:this.classes($i.base,X.widget,e)},this._zoomInButton.render(),this._zoomOutButton.render())}zoomIn(){return this.viewModel.zoomIn()}zoomOut(){return this.viewModel.zoomOut()}};r([h()],pe.prototype,"iconClass",void 0),r([h()],pe.prototype,"icon",void 0),r([h()],pe.prototype,"label",null),r([h({value:"vertical"})],pe.prototype,"layout",null),r([h(),si("esri/widgets/Zoom/t9n/Zoom")],pe.prototype,"messages",void 0),r([h()],pe.prototype,"view",null),r([h({type:wa})],pe.prototype,"viewModel",void 0),pe=r([_("esri.widgets.Zoom")],pe);const Jh=pe;function Qh(t){return(t==null?void 0:t.view)!==void 0}let jt=class extends Gh{constructor(t){super(t),this._defaultPositionLookup={attribution:"manual",compass:"top-left","navigation-toggle":"top-left",zoom:"top-left"},this.components=[],this._updateViewAwareWidgets=e=>{this.components.forEach(i=>{const n=this._find(i),s=n==null?void 0:n.widget;Qh(s)&&(s.view=e)})},this._componentsWatcher=(e,i)=>{this._removeComponents(i),this._addComponents(e),this._adjustPadding(e)}}initialize(){this.addHandles([f(()=>this.components,this._componentsWatcher,B),f(()=>this.view,this._updateViewAwareWidgets,B)])}_add(t,e,i,n,s){let a=t;if(typeof t=="string"&&this._defaultPositionLookup[t]){if(this._find(t))return;a=this._createComponent(t)}super._add(a,e,i,n,s)}_removeComponents(t){t.forEach(e=>{const i=this._find(e);i&&(this.remove(i),i.destroy())})}_adjustPadding(t){if(!t.includes("attribution")&&!this._isOverridden("padding")){const{top:e}=this.padding;this.padding=e}}_addComponents(t){this.constructed&&t.forEach(e=>this.add(this._createComponent(e),this._defaultPositionLookup[e]))}_createComponent(t){const e=this._createWidget(t);return new Ut({id:t,node:e})}_createWidget(t){const{view:e}=this;switch(t){case"attribution":return new jh({view:e});case"compass":return new Bh({view:e});case"navigation-toggle":return new Wh({view:e});case"zoom":return new Jh({view:e})}}};r([h()],jt.prototype,"components",void 0),jt=r([_("esri.views.ui.DefaultUI")],jt);const ba=jt;let qt=class extends ba{constructor(t){super(t),this.components=["attribution","zoom"]}};r([h()],qt.prototype,"components",void 0),qt=r([_("esri.views.ui.2d.DefaultUI2D")],qt);const Ta=qt;var Xi;let Zt=Xi=class extends xt{constructor(t){super(t),this.color=new ge([0,0,0,1])}clone(){return new Xi(Ei({color:this.color}))}};r([h({type:ge,json:{write:!0}})],Zt.prototype,"color",void 0),Zt=Xi=r([_("esri.webmap.background.ColorBackground")],Zt);const ec=Zt;let ka,Ma,xa,Pa,Ca,Sa;async function tc(){const[,{GraphicsView2D:t,GraphicContainer:e,LabelManager:i,MapViewNavigation:n,MagnifierView2D:s,Stage:a}]=await Promise.all([w(()=>import("./webglDeps-600b65d5.js"),["./webglDeps-600b65d5.js","./FramebufferObject-f8937356.js","./uuid-fb53ae2e.js","./index-e42a63f9.js","./Texture-909bfb08.js","./capabilities-6261cefc.js","./enums-bdecffa2.js","./ProgramTemplate-12d63168.js","./commonjsHelpers-2f3e7994.js","./programUtils-351b494d.js","./NestedMap-1b5db22e.js"],import.meta.url),w(()=>import("./mapViewDeps-20d3fc4f.js"),["./mapViewDeps-20d3fc4f.js","./uuid-fb53ae2e.js","./index-e42a63f9.js","./signal-a61cc993.js","./mat3f32-6c416b1c.js","./ExpandedCIM-870ec490.js","./BidiEngine-9a40f2f4.js","./visualVariablesUtils-e6903ea9.js","./OptimizedFeature-ded94d90.js","./color-a4b304a5.js","./enums-f1a6a48a.js","./enums-bdecffa2.js","./VertexElementDescriptor-2925c6af.js","./definitions-d96ec118.js","./GeometryUtils-984e8446.js","./utils-d023eda3.js","./GeometryUtils-c1de866e.js","./mat2df32-b9bfc1f5.js","./vec2-aed931ac.js","./TileStore-6570f2cc.js","./workers-3c8ba252.js","./quickselect-149a6b43.js","./commonjsHelpers-2f3e7994.js","./QuantizationParameters-a323cbe3.js","./TileInfoView-be4d795d.js","./vec2f32-eaf29605.js","./Rect-ea14f53a.js","./quantizationUtils-7998a127.js","./floatRGBA-04143c6a.js","./imageUtils-cd1e4411.js","./Container-15ae821f.js","./parser-450a99c3.js","./mat4f32-60a2394b.js","./mat4-f091cc2b.js","./Texture-909bfb08.js","./capabilities-6261cefc.js","./BufferPool-f1313648.js","./AttributeStoreView-43278226.js","./mat3-1b291d2f.js","./TiledDisplayObject-097260a9.js","./diffUtils-7a67a389.js","./labelingInfo-144cafce.js","./LabelClass-03af2031.js","./labelUtils-f4e57b25.js","./layerUtils-a8920453.js","./defaultsJSON-b087dd4d.js","./jsonUtils-6741d81c.js","./WGLContainer-a031049d.js","./FramebufferObject-f8937356.js","./ProgramTemplate-12d63168.js","./heatmapUtils-c2569515.js","./vec4f64-3c9d0901.js","./StyleDefinition-29c49b98.js","./config-1337d16e.js","./earcut-b84353bc.js","./vec2f64-95bf678d.js","./featureConversionUtils-5ad02385.js","./OptimizedFeatureSet-1d1ac4b9.js","./clusterUtils-80867c68.js","./MD5-715f37cd.js","./SizeVariable-d8011d21.js","./colorRamps-18dfa72a.js","./LegendOptions-21ba0c6d.js","./compilerUtils-811a6f43.js","./lengthUtils-5d9bdf3f.js","./util-0cf8b7dd.js","./enums-fb086c25.js","./programUtils-351b494d.js","./NestedMap-1b5db22e.js","./MagnifierPrograms-83cf9dff.js","./rasterizingUtils-7a00076e.js","./pbf-0c5d1fff.js","./imageutils-8a04d22c.js","./Matcher-5cde60f7.js","./tileUtils-c2f19f52.js","./TurboLine-470e4fcd.js","./LRUCache-9b8f5520.js","./CircularArray-ef508845.js","./testSVGPremultipliedAlpha-ad111ba4.js","./throttle-7bf02de9.js","./ComputedAttributeStorage-1c26e0db.js","./FieldsIndex-406a2400.js","./TimeOnly-f07e8b54.js","./UpdatingHandles-9a53fef9.js","./RenderingContext-da2621c6.js","./OrderIndependentTransparency-6ae10952.js","./basicInterfaces-11f56cb3.js","./doublePrecisionUtils-e3c3d0d8.js","./GraphicsView2D-cf1235ce.js","./normalizeUtilsSync-20755c4d.js","./normalizeUtilsCommon-05ad6f6d.js","./projectionSupport-29174b46.js","./arcgisLayerUrl-fc2d909c.js","./json-48e3ea08.js","./normalizeUtils-a2b8b8b6.js","./GraphicContainer-6ae2ea3e.js","./BaseGraphicContainer-d8dd2bed.js","./FeatureContainer-7b9710d6.js","./TileContainer-a854d921.js","./vec3f32-2da9db36.js","./requestImageUtils-0e269fd5.js","./Basemap-fc4d26ee.js","./loadAll-76369e9a.js","./PortalItem-01395053.js","./writeUtils-3673b1a7.js","./CollectionFlattener-5cd5b172.js","./infoFor3D-24efd44a.js","./basemapUtils-0a6b5a56.js","./TablesMixin-2871072c.js","./Cyclical-8c26e7c7.js","./TileInfo-238dd4b6.js","./jsxFactory-8f2e778f.js","./GraphicsCollection-2966693c.js","./ViewingMode-fb6259a5.js","./unitBezier-881ac1eb.js","./GoTo-2cdac7e7.js"],import.meta.url)]);Ma=t,xa=e,Pa=i,Ca=n,Sa=s,ka=a}let v=class extends mr(Dr(fr(Qr))){constructor(t){super(t),this._magnifierView=null,this.stage=null,this._resolveWhenReady=[],this.rootLayerViews=new Wt({getCollections:()=>{var e,i;return[(e=this.basemapView)==null?void 0:e.baseLayerViews,this.layerViews,(i=this.basemapView)==null?void 0:i.referenceLayerViews]},getChildrenFunction:()=>null}),this.featuresTilingScheme=null,this.fullOpacity=1,this.goToManager=new Gt({view:this}),this.graphicsView=null,this.stateManager=new q({constraints:new sa({view:this})}),this.stationaryManager=new bt,this.labelManager=null,this.mapViewNavigation=null,this.renderingOptions={samplingMode:"dynamic",edgeLabelsVisible:!0,labelsAnimationTime:125,labelCollisionsEnabled:!0},this.supersampleScreenshotsEnabled=!0,this.supportsGround=!1,this.frameTask=new xl(this),this.floors=new O,this.highlightOptions=new ha,this.inputManager=new ph({view:this}),this.map=null,this.spatialReferenceLocked=!1,this.timeline=new ma,this.type="2d",this.ui=new Ta,this.test={takeScreenshot:async e=>Ph(this._getScreenshotView(e),e)},this.padding={top:0,right:0,bottom:0,left:0},this.addHandles([f(()=>this.viewpoint,()=>this.stationaryManager.flip(),ii),this.on("resize",e=>this.stateManager.resize(e.width,e.height)),f(()=>{var e;return(e=this.animationManager)==null?void 0:e.animation},e=>{this.animation=e})]),Do()}destroy(){this._set("preconditionsReady",!1),this.frameTask=F(this.frameTask),this.goToManager.destroy(),this.rootLayerViews.destroy(),this.inputManager.destroy(),this._set("inputManager",null)}get graphicsTileStore(){return new sr(this.featuresTilingScheme)}get constraintsInfo(){var i,n;const t=(i=this.defaultsFromMap)==null?void 0:i.tileInfo,e=this.spatialReference;return{lods:(n=t==null?void 0:t.spatialReference)!=null&&n.equals(e)?t.lods:null,spatialReference:e}}get state(){return this.stateManager.state}get initialExtentRequired(){var o;if(!this.stateManager)return!1;const{scale:t,constraints:e,center:i,viewpoint:n,extent:s}=this;let a=this.zoom;return!(this.map&&"initialViewProperties"in this.map&&((o=this.map.initialViewProperties)!=null&&o.viewpoint))&&!s&&(e!=null&&e.effectiveLODs||(a=-1),(!i||t===0&&a===-1)&&((n==null?void 0:n.targetGeometry)==null||n.targetGeometry.type!=="extent"&&!n.scale))}get _defaultsFromMapSettings(){return{required:{tileInfo:!0,heightModelInfo:!1,extent:!1},requiresExtentInSpatialReference:this.spatialReferenceLocked}}get typeSpecificPreconditionsReady(){const t=this._getDefaultViewpoint();if(!t)return!1;const e=this.spatialReference,i=t.targetGeometry;return!!ni(i.spatialReference,e)||Lo()}set animation(t){const e=this._get("animation");if(t===e)return;if(e&&e.stop(),!t||t.isFulfilled())return this._set("animation",null),void(this.frameTask.animationInProgress=!1);this._set("animation",t),this.frameTask.animationInProgress=!0;const i=()=>{var n;t===this._get("animation")&&(this._set("animation",null),(n=this.frameTask)==null||n.requestFrame()),this.frameTask.animationInProgress=!1};t.when(i,i)}get background(){return ys(this.map)?this.map.initialViewProperties.background:null}set background(t){this._override("background",t)}get center(){var t;return((t=this.stateManager)==null?void 0:t.center)??null}set center(t){this.stateManager.center=t}get constraints(){var t;return(t=this.stateManager)==null?void 0:t.constraints}set constraints(t){t.view=this;const e=this.stateManager.constraints;this.stateManager.constraints=t,e==null||e.destroy()}get extent(){var t;return((t=this.stateManager)==null?void 0:t.extent)??null}set extent(t){this.stateManager.extent=t}get padding(){var t;return(t=this.stateManager)==null?void 0:t.padding}set padding(t){this.stateManager&&(this.stateManager.padding=t)}get rendering(){var t;return((t=this.stage)==null?void 0:t.renderRequested)??!1}get resizeAlign(){return this.stateManager.resizeAlign}set resizeAlign(t){this.stateManager.resizeAlign=t}get resolution(){return this.stateManager.resolution??0}get rotation(){return this.stateManager.rotation??0}set rotation(t){const{rotationEnabled:e}=this.constraints;this.constraints.rotationEnabled=!0,this.stateManager.rotation=t,this.constraints.rotationEnabled=e}get scale(){var t;return((t=this.stateManager)==null?void 0:t.scale)??0}set scale(t){this.stateManager&&(this.stateManager.scale=t)}get stationary(){return!this.animation&&!this.navigating&&!this.resizing&&this.stationaryManager.stationary}get updating(){var e,i,n;const t=!this.destroyed&&(!this.layerViewManager||!this.labelManager||!this.graphicsView||this.layerViewManager.updating===!0||this.labelManager.updating===!0||this.graphicsView.updating===!0||this.allLayerViews.some(s=>!s.destroyed&&!("layerViews"in s)&&s.updating===!0));if(ne("esri-2d-log-updating")){const s=this.allLayerViews.reduce((a,o)=>({...a,[o.layer.id]:!o.destroyed&&!("layerViews"in o)&&o.updating}),{});console.log(`Updating MapView: ${t}
-> Null LayerViewManager: ${!this.layerViewManager}
-> Null LabelManager: ${!this.labelManager}
-> Null GraphicsView: ${!this.graphicsView}
-> layerViewManager.updating: ${(e=this.layerViewManager)==null?void 0:e.updating}
-> labelManager.updating: ${(i=this.labelManager)==null?void 0:i.updating}
-> graphicsView.updating: ${(n=this.graphicsView)==null?void 0:n.updating}
-> allLayerViews: ${JSON.stringify(s)}
`)}return t}get viewpoint(){return this.stateManager.viewpoint??null}set viewpoint(t){this.stateManager.viewpoint=t,this.frameTask.requestFrame()}get zoom(){return this.stateManager.zoom??-1}set zoom(t){this.stateManager.zoom=t}get navigating(){var t;return((t=this.mapViewNavigation)==null?void 0:t.interacting)??!1}goTo(t,e){return this.goToManager.goTo(t,e)}async hitTest(t,e){return dh(this,t,e)}async takeScreenshot(t){return xh(this._getScreenshotView(t),t)}toMap(t){if(!this.ready)return null;const e=Gs(t)?Hs(this,t):t;return this.stateManager.toMap(e)}toScreen(t,e){return this.stateManager.toScreen(t,e)}on(t,e,i,n){return this.inputManager&&this.viewEvents.on(t,e,i,n)||super.on(t,e)}hasEventListener(t){return super.hasEventListener(t)||this.viewEvents.hasHandler(t)}whenLayerView(t){return super.whenLayerView(t)}graphicChanged(t){this.graphicsView&&this.graphicsView.graphicUpdateHandler(t)}whenReady(){return new Promise(t=>{this.ready?t(this):this._resolveWhenReady.push(t)})}forceDOMReadyCycle(){this.forceReadyCycle()}getDefaultSpatialReference(){var t,e,i;return this.map&&"initialViewProperties"in this.map&&((e=(t=this.map)==null?void 0:t.initialViewProperties)==null?void 0:e.spatialReference)||((i=this.defaultsFromMap)==null?void 0:i.spatialReference)||null}getDefaultTimeZone(){return ys(this.map)?this.map.initialViewProperties.timeZone:null}hasLayerViewModule(t){return ts.hasLayerViewModule(t)}importLayerView(t){return ts.importLayerView(t)}pixelSizeAt(){return this.ready?this.resolution:(T.getLogger(this).error("#pixelSizeAt()","Map view cannot be used before it is ready"),null)}popupHitTest(t){return this.hitTest(t).then(e=>({...e,mapPoint:this.toMap(t)}))}requestUpdate(){this.ready&&this.frameTask.requestUpdate()}async validate(){let t=Ih(this.type);if(ne("safari")&&ne("safari")<9&&(t=new P("mapview:browser-not-supported","This browser is not supported by MapView (Safari < 9)",{type:"safari",requiredVersion:9,detectedVersion:ne("safari")})),t!=null)throw T.getLogger(this).warn("#validate()",t.message),t}loadAsyncDependencies(){return tc()}_getDefaultViewpoint(){var C;const{constraints:t,initialExtent:e,map:i,padding:n,size:s}=this;if(!t)return null;const a=i&&"initialViewProperties"in i?i.initialViewProperties:void 0,o=this.stateManager.getUserStartupOptions(this.size),l=a==null?void 0:a.viewpoint,c=((C=l==null?void 0:l.targetGeometry)==null?void 0:C.extent)??e,p=c==null?void 0:c.center,u=(l==null?void 0:l.rotation)??0,m=(l==null?void 0:l.scale)||c&&ct(c,[s[0]-n.left-n.right,s[1]-n.top-n.bottom]),d=o.center??p,g=o.rotation??u,S=o.scale??m;return d&&S?new me({targetGeometry:d,scale:S,rotation:g}):null}_startup(){var o;this.timeline.begin("MapView Startup");const t=this._getDefaultViewpoint();this.stateManager.startup(t,this.size,this.spatialReference,(o=this.defaultsFromMap.extent)==null?void 0:o.center),this.graphics.owner=this;const e=new ka(this.surface,{canvas:this.renderCanvas,contextOptions:{disabledExtensions:this.deactivatedWebGLExtensions,debugWebGLExtensions:this.debugWebGLExtensions},renderingOptions:this.renderingOptions,timeline:this.timeline});this.stage=e,this._magnifierView=new Sa,this._magnifierView.magnifier=this.magnifier;const i=new Pa({view:this});this._set("labelManager",i);const n=new Ml({view:this});this._set("animationManager",n);const s=new Ca({view:this,animationManager:n});this._set("mapViewNavigation",s),this._setupSpatialReferenceDependentProperties(),this.addHandles([this.rootLayerViews.on("change",()=>this._updateStageChildren()),e.on("webgl-error",l=>this.fatalError=l.error),f(()=>this.stationary,l=>e.stationary=l,Ge),f(()=>this.background,l=>{e.backgroundColor=l==null?void 0:l.color,this._magnifierView.backgroundColor=l==null?void 0:l.color},Ge),f(()=>this.magnifier,l=>this._magnifierView.magnifier=l,Ge),f(()=>this.renderingOptions,l=>e.renderingOptions=l,Ge),f(()=>this.highlightOptions,l=>e.highlightOptions=l,Ge),f(()=>this.state.id,()=>e.state=this.state,Ge)],"map-view"),this._updateStageChildren();const a=this._resolveWhenReady;this._resolveWhenReady=[],a.forEach(l=>l(this)),this.timeline.end("MapView Startup"),this.frameTask.start(),this._set("ready",!0)}_teardown(){this._destroySpatialReferenceDependentProperties(),this.removeHandles("map-view"),this.mapViewNavigation.destroy(),this._set("mapViewNavigation",null),this.animationManager.destroy(),this._set("animationManager",null),this.layerViewManager.clear(),this.labelManager.destroy(),this._magnifierView.destroy(),this.stage.destroy(),this.stage=null,this._set("graphicsView",null),this._magnifierView=null,this._set("labelManager",null),this._set("mapViewNavigation",null),this.graphics.owner=null,this.frameTask.stop(),this.stationaryManager.clear(),this._set("ready",!1),this.stateManager.teardown(),this.animation=null}_updateStageChildren(){this.stage.removeAllChildren(),this.rootLayerViews.forEach(e=>{this.stage.addChild(e.container)});const t=this.graphicsView;this.stage.addChild(t.container),this.stage.addChild(this._magnifierView)}_setupSpatialReferenceDependentProperties(){const t=new Qo(Ao.create({spatialReference:this.spatialReference,size:512,numLODs:36}));this._set("featuresTilingScheme",t);const e=new Ma({view:this,graphics:this.graphics,requestUpdateCallback:()=>this.requestUpdate(),container:new xa(t)});this._set("graphicsView",e)}_destroySpatialReferenceDependentProperties(){const t=this.graphicsView;this._set("graphicsView",null),t.destroy(),this._set("featuresTilingScheme",null)}_getScreenshotView(t){var a;const{allLayerViews:e,padding:i,size:n,stage:s}=this;return{allLayerViews:e,backgroundColor:t!=null&&t.ignoreBackground?null:(a=this.background)==null?void 0:a.color,padding:i,size:n,stage:s}}_spatialReferenceChanged(t){if(this.ready){this.frameTask.stop();for(const e of this.allLayerViews)e.processDetach();this._destroySpatialReferenceDependentProperties(),this.stateManager.changeSpatialReference(t),this.stage.state=this.state,this._setupSpatialReferenceDependentProperties();for(const e of this.allLayerViews)e.processAttach();this.frameTask.requestFrame(),this.frameTask.start(),this._updateStageChildren()}}};v.type="2d",r([h({readOnly:!0})],v.prototype,"animationManager",void 0),r([h({constructOnly:!0})],v.prototype,"deactivatedWebGLExtensions",void 0),r([h({constructOnly:!0})],v.prototype,"debugWebGLExtensions",void 0),r([h({readOnly:!0})],v.prototype,"featuresTilingScheme",void 0),r([h({readOnly:!0})],v.prototype,"fullOpacity",void 0),r([h()],v.prototype,"goToManager",void 0),r([h({readOnly:!0})],v.prototype,"graphicsTileStore",null),r([h()],v.prototype,"graphicsView",void 0),r([h()],v.prototype,"stateManager",void 0),r([h()],v.prototype,"constraintsInfo",null),r([h({readOnly:!0})],v.prototype,"state",null),r([h()],v.prototype,"initialExtentRequired",null),r([h()],v.prototype,"labelManager",void 0),r([h({readOnly:!0})],v.prototype,"mapViewNavigation",void 0),r([h({constructOnly:!0})],v.prototype,"renderCanvas",void 0),r([h()],v.prototype,"renderingOptions",void 0),r([h({constructOnly:!0})],v.prototype,"supersampleScreenshotsEnabled",void 0),r([h({readOnly:!0})],v.prototype,"supportsGround",void 0),r([h()],v.prototype,"_defaultsFromMapSettings",null),r([h({readOnly:!0})],v.prototype,"typeSpecificPreconditionsReady",null),r([h()],v.prototype,"animation",null),r([h({type:ec})],v.prototype,"background",null),r([h()],v.prototype,"center",null),r([h({type:sa})],v.prototype,"constraints",null),r([h()],v.prototype,"extent",null),r([h()],v.prototype,"floors",void 0),r([h({type:ha})],v.prototype,"highlightOptions",void 0),r([h({readOnly:!0})],v.prototype,"inputManager",void 0),r([h()],v.prototype,"map",void 0),r([h()],v.prototype,"padding",null),r([h({readOnly:!0})],v.prototype,"rendering",null),r([h()],v.prototype,"resizeAlign",null),r([h({readOnly:!0})],v.prototype,"resolution",null),r([h()],v.prototype,"rotation",null),r([h()],v.prototype,"scale",null),r([h({constructOnly:!0})],v.prototype,"spatialReferenceLocked",void 0),r([h()],v.prototype,"stationary",null),r([h({type:ma,readOnly:!0})],v.prototype,"timeline",void 0),r([h({readOnly:!0})],v.prototype,"type",void 0),r([h({readOnly:!0})],v.prototype,"updating",null),r([h()],v.prototype,"viewpoint",null),r([h()],v.prototype,"zoom",null),r([h({readOnly:!0})],v.prototype,"navigating",null),r([h(),Ne(t=>t instanceof ba?t:yo(Ta,t))],v.prototype,"ui",void 0),v=r([_("esri.views.MapView")],v);const ic=v;function ys(t){return(t==null?void 0:t.declaredClass)==="esri.WebMap"}const nc="AAPK30f9595f237e4f1e89808a1fae6ab62alZTmtvbzc6_rS84n1fQkkWSHiDCqby1pMpPgLmc7HKIb4X4skqCFbsRw-kZjrsFk";_o.apiKey=nc;const sc=t=>{t.map=ac(),t.mapView=oc(t),rc(t)},ac=t=>new Vs({}),oc=t=>new ic({map:t.map,center:[133,-27],scale:25e6,constraints:{rotationEnabled:!1,minScale:2e8,maxScale:1e5,snapToZoom:!1,geometry:{type:"extent",xmin:112,ymin:-44,xmax:154,ymax:-9}},container:"mapViewContainer",highlightOptions:{color:t.colorTemplate.mapHighlightColor},background:{color:t.colorTemplate.backgroundColor}}),rc=t=>{t.mapView.when(()=>{t.layers.ab&&t.mapView.whenLayerView(t.layers.ab).then(n=>{t.utils.zoomToQueryLayer(t,t.layers.ab,"dash_url is not null"),t.mainLayerView=n}),t.mapView.ui.find("attribution").when(()=>{const n=document.getElementsByClassName("esri-attribution__powered-by")[0];if(n){const s=n.innerHTML,a='Powered by <a class="esri-attribution__link" href="https://qitplus.com">QIT Plus</a>,';n.innerHTML=s.replace("Powered by",a)}});const i=document.createElement("div");i.id="default-extent",i.className="esri-widget esri-widget--button esri-interactive",i.title="Default extent",i.innerHTML=t.ui.icons.home,document.body.appendChild(i),t.mapView.ui.add("default-extent","top-left"),i.addEventListener("click",()=>{t.highlightSelect&&t.highlightSelect.remove(),t.utils.zoomToQueryLayer(t,t.layers.ab,"dash_url is not null"),t.utils.resetSearchPanel(t)}),t.layers.ab&&$a(t)})},$a=t=>{const e=t.mapView,i=t.layers.ab,n={include:i};e.whenLayerView(i).then(s=>{let a,o;const l=document.getElementById("tooltip");document.body.appendChild(l);const c=Sn(async u=>{const d=(await e.hitTest(u,n)).results[0],g=d&&d.graphic.attributes[i.objectIdField];if(!g)e.cursor="auto",l.innerHTML="",l.style.display="none",a==null||a.remove(),o=null;else if(o!==g){let S=d.graphic.attributes.name+", "+d.graphic.attributes.state;d.graphic.attributes.dash_url?e.cursor="pointer":e.cursor="auto",a==null||a.remove(),o=g,a=s.highlight(d.graphic),l.innerHTML=S;const M=t.ui.headerContainer?t.ui.headerContainer.offsetHeight:0;l.style.left="60px",l.style.top=`${15+M}px`,l.style.display="block"}}),p=Sn(async u=>{const m=await e.hitTest(u,n);if(m.results.length==0)t.utils.resetSearchPanel(t),t.highlightSelect&&t.highlightSelect.remove();else{t.highlightSelect&&t.highlightSelect.remove(),t.highlightSelect=t.mainLayerView.highlight(m.results[0].graphic);const d=m.results[0].graphic.attributes;t.utils.showResultInfo(t,d)}});e.on("pointer-move",u=>{t.ui.pointerDown||c(u).catch(m=>{if(!Tt(m))throw m})}),e.on("immediate-click",u=>{p(u).catch(m=>{if(!Tt(m))throw m})}),e.on("pointer-down",u=>{t.ui.pointerDown=!0}),e.on("pointer-up",u=>{t.ui.pointerDown=!1})})},Qp=Object.freeze(Object.defineProperty({__proto__:null,addMap:sc,addMapViewHandlers:$a},Symbol.toStringTag,{value:"Module"}));export{li as A,_p as G,rl as Z,Ae as _,ma as a,me as b,ha as c,Js as d,ze as e,yp as h,Qs as j,yl as l,Qp as m,Lh as r,Kh as t,Up as w,vl as y};
