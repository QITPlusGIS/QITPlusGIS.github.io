import{s as ue,o as Z,aB as le,aC as ce,O as ie,aD as ae,aE as fe,aF as he,aG as de,aH as me}from"./uuid-De2V3pkO.js";import{t as F,a as T}from"./OptimizedFeature-CuDeWVOV.js";import{e as ge}from"./OptimizedFeatureSet-Blu9Ckm7.js";function p(e,n){return e?n?4:3:n?3:2}const x=ue.getLogger("esri.layers.graphics.featureConversionUtils"),B={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0,esriGeometryEnvelope:0},ye=(e,n,r,t,s,o)=>{e[r]=s,e[r+1]=o},_=(e,n,r,t,s,o)=>{e[r]=s,e[r+1]=o,e[r+2]=n[t+2]},pe=(e,n,r,t,s,o)=>{e[r]=s,e[r+1]=o,e[r+2]=n[t+3]},be=(e,n,r,t,s,o)=>{e[r]=s,e[r+1]=o,e[r+2]=n[t+2],e[r+3]=n[t+3]};function L(e,n,r,t){if(e){if(r)return n&&t?be:_;if(n&&t)return pe}else if(n&&t)return _;return ye}function E({scale:e,translate:n},r){return Math.round((r-n[0])/e[0])}function z({scale:e,translate:n},r){return Math.round((n[1]-r)/e[1])}function $({scale:e,translate:n},r,t){return r*e[t]+n[t]}function qe(e,n,r){return e?n?r?A(e):U(e):r?S(e):j(e):null}function j(e){const n=e.coords;return{x:n[0],y:n[1]}}function D(e,n){return e.coords[0]=n.x,e.coords[1]=n.y,e}function U(e){const n=e.coords;return{x:n[0],y:n[1],z:n[2]}}function we(e,n){return e.coords[0]=n.x,e.coords[1]=n.y,e.coords[2]=n.z,e}function S(e){const n=e.coords;return{x:n[0],y:n[1],m:n[2]}}function Ie(e,n){return e.coords[0]=n.x,e.coords[1]=n.y,e.coords[2]=n.m,e}function A(e){const n=e.coords;return{x:n[0],y:n[1],z:n[2],m:n[3]}}function Ge(e,n){return e.coords[0]=n.x,e.coords[1]=n.y,e.coords[2]=n.z,e.coords[3]=n.m,e}function Me(e,n,r,t){let s=j;r&&t?s=A:r?s=U:t&&(s=S);for(const o of n){const{geometry:u,attributes:l}=o,i=u!=null?s(u):null;e.push({attributes:l,geometry:i})}return e}function R(e,n){return e&&n?Ge:e?we:n?Ie:D}function H(e,n,r,t,s){const o=R(r,t);for(const{geometry:u,attributes:l}of n){const i=u!=null?o(new T,u):null;e.push(new F(i,l,null,s?l[s]:void 0))}return e}function Le(e,n,r=R(n.z!=null,n.m!=null)){return r(e,n)}function Ne(e,n,r,t){for(const{geometry:s,attributes:o}of n)e.push({attributes:o,geometry:s!=null?J(s,r,t):null});return e}function J(e,n,r){if(e==null)return null;const t=p(n,r),s=[];for(let o=0;o<e.coords.length;o+=t){const u=[];for(let l=0;l<t;l++)u.push(e.coords[o+l]);s.push(u)}return n?r?{points:s,hasZ:n,hasM:r}:{points:s,hasZ:n}:r?{points:s,hasM:r}:{points:s}}function K(e,n,r,t,s){const o=p(r,t);for(const{geometry:u,attributes:l}of n){const i=u!=null?Q(new T,u,o):null;e.push(new F(i,l,null,s?l[s]:void 0))}return e}function Q(e,n,r=p(n.hasZ,n.hasM)){e.lengths[0]=n.points.length;const t=e.coords;let s=0;for(const o of n.points)for(let u=0;u<r;u++)t[s++]=o[u];return e}function Te(e,n,r,t){for(const{geometry:s,attributes:o}of n)e.push({attributes:o,geometry:s!=null?W(s,r,t):null});return e}function W(e,n,r){if(!e)return null;const t=p(n,r),{coords:s,lengths:o}=e,u=[];let l=0;for(const i of o){const c=[];for(let a=0;a<i;a++){const f=[];for(let h=0;h<t;h++)f.push(s[l++]);c.push(f)}u.push(c)}return n?r?{paths:u,hasZ:n,hasM:r}:{paths:u,hasZ:n}:r?{paths:u,hasM:r}:{paths:u}}function X(e,n,r,t,s){const o=p(r,t);for(const{geometry:u,attributes:l}of n){const i=u!=null?ee(new T,u,o):null;e.push(new F(i,l,null,s?l[s]:void 0))}return e}function ee(e,n,r=p(n.hasZ,n.hasM)){const{lengths:t,coords:s}=e;let o=0;for(const u of n.paths){for(const l of u)for(let i=0;i<r;i++)s[o++]=l[i];t.push(u.length)}return e}function Pe(e,n,r,t){for(const{geometry:s,attributes:o,centroid:u}of n){const l=s!=null?ne(s,r,t):null;if(u!=null){const i=j(u);e.push({attributes:o,centroid:i,geometry:l})}else e.push({attributes:o,geometry:l})}return e}function ne(e,n,r){if(!e)return null;const t=p(n,r),{coords:s,lengths:o}=e,u=[];let l=0;for(const i of o){const c=[];for(let a=0;a<i;a++){const f=[];for(let h=0;h<t;h++)f.push(s[l++]);c.push(f)}u.push(c)}return n?r?{rings:u,hasZ:n,hasM:r}:{rings:u,hasZ:n}:r?{rings:u,hasM:r}:{rings:u}}function re(e,n,r,t,s){for(const{geometry:o,centroid:u,attributes:l}of n){const i=o!=null?te(new T,o,r,t):null,c=s?l[s]:void 0;u!=null?e.push(new F(i,l,D(new T,u),c)):e.push(new F(i,l,null,c))}return e}function te(e,n,r=n.hasZ,t=n.hasM){return Fe(e,n.rings,r,t)}function Fe(e,n,r,t){const s=p(r,t),{lengths:o,coords:u}=e;let l=0;N(e);for(const i of n){for(const c of i)for(let a=0;a<s;a++)u[l++]=c[a];o.push(i.length)}return e}const P=[],k=[];function Ue(e,n,r,t,s){P[0]=e;const[o]=oe(k,P,n,r,t,s);return M(P),M(k),o}function oe(e,n,r,t,s,o){if(M(e),!r){for(const u of n){const l=o?u.attributes[o]:void 0;e.push(new F(null,u.attributes,null,l))}return e}switch(r){case"esriGeometryPoint":return H(e,n,t,s,o);case"esriGeometryMultipoint":return K(e,n,t,s,o);case"esriGeometryPolyline":return X(e,n,t,s,o);case"esriGeometryPolygon":return re(e,n,t,s,o);default:x.error("convertToFeatureSet:unknown-geometry",new Z(`Unable to parse unknown geometry type '${r}'`)),M(e)}return e}function Se(e,n,r,t,s,o){const u=e.length;switch(r){case"esriGeometryPoint":H(e,n,t,s,o);break;case"esriGeometryMultipoint":K(e,n,t,s,o);break;case"esriGeometryPolyline":X(e,n,t,s,o);break;case"esriGeometryPolygon":re(e,n,t,s,o);break;default:x.error("convertToFeatureSet:unknown-geometry",new Z(`Unable to parse unknown geometry type '${r}'`))}for(let l=0;l<n.length;l++)e[l+u].geometryType=r,e[l+u].insertAfter=n[l].insertAfter,e[l+u].groupId=n[l].groupId;return e}function Ae(e,n,r,t){k[0]=e,se(P,k,n,r,t);const s=P[0];return M(P),M(k),s}function Re(e,n,r){if(e==null)return null;const t=new T;return"hasZ"in e&&n==null&&(n=e.hasZ),"hasM"in e&&r==null&&(r=e.hasM),ce(e)?R(n??e.z!=null,r??e.m!=null)(t,e):ie(e)?te(t,e,n,r):ae(e)?ee(t,e,p(n,r)):fe(e)?Q(t,e,p(n,r)):void x.error("convertFromGeometry:unknown-geometry",new Z(`Unable to parse unknown geometry type '${e}'`))}function Ze(e,n,r,t){const s=e&&("coords"in e?e:e.geometry);if(s==null)return null;switch(n){case"esriGeometryPoint":{let o=j;return r&&t?o=A:r?o=U:t&&(o=S),o(s)}case"esriGeometryMultipoint":return J(s,r,t);case"esriGeometryPolyline":return W(s,r,t);case"esriGeometryPolygon":return ne(s,r,t);default:return x.error("convertToGeometry:unknown-geometry",new Z(`Unable to parse unknown geometry type '${n}'`)),null}}function xe(e,n){for(const r of n)e.push({attributes:r.attributes});return e}function se(e,n,r,t,s){if(M(e),r==null)return xe(e,n);switch(r){case"esriGeometryPoint":return Me(e,n,t,s);case"esriGeometryMultipoint":return Ne(e,n,t,s);case"esriGeometryPolyline":return Te(e,n,t,s);case"esriGeometryPolygon":return Pe(e,n,t,s);default:x.error("convertToFeatureSet:unknown-geometry",new Z(`Unable to parse unknown geometry type '${r}'`))}return e}function Ve(e){const{objectIdFieldName:n,spatialReference:r,transform:t,fields:s,hasM:o,hasZ:u,features:l,geometryType:i,exceededTransferLimit:c,uniqueIdField:a,queryGeometry:f,queryGeometryType:h}=e,d={features:se([],l,i,u,o),fields:s,geometryType:i,objectIdFieldName:n,spatialReference:r,uniqueIdField:a,queryGeometry:Ze(f,h,!1,!1)};return t&&(d.transform=t),c&&(d.exceededTransferLimit=c),o&&(d.hasM=o),u&&(d.hasZ=u),d}function Ye(e,n){const r=new ge,{hasM:t,hasZ:s,features:o,objectIdFieldName:u,spatialReference:l,geometryType:i,exceededTransferLimit:c,transform:a,fields:f}=e;return f&&(r.fields=f),r.geometryType=i??null,r.objectIdFieldName=u??n??null,r.spatialReference=l??null,r.objectIdFieldName?(o&&oe(r.features,o,i,s,t,r.objectIdFieldName),c&&(r.exceededTransferLimit=c),t&&(r.hasM=t),s&&(r.hasZ=s),a&&(r.transform=a),r):(x.error(new Z("optimized-features:invalid-objectIdFieldName","objectIdFieldName is missing")),r)}function _e(e){const{transform:n,features:r,hasM:t,hasZ:s}=e;if(!n)return e;for(const o of r)o.geometry!=null&&O(o.geometry,o.geometry,t,s,n),o.centroid!=null&&O(o.centroid,o.centroid,t,s,n);return e.transform=null,e}function Ce(e,n){const{geometryType:r,features:t,hasM:s,hasZ:o}=n;if(!e)return n;for(let u=0;u<t.length;u++){const l=t[u],i=l.weakClone();i.geometry=new T,C(i.geometry,l.geometry,s,o,r,e),l.centroid&&(i.centroid=new T,C(i.centroid,l.centroid,s,o,"esriGeometryPoint",e)),t[u]=i}return n.transform=e,n}function C(e,n,r,t,s,o,u=r,l=t){if(N(e),!n?.coords.length)return null;const i=B[s],{coords:c,lengths:a}=n,f=p(r,t),h=p(r&&u,t&&l),d=L(r,t,u,l);if(!a.length)return d(e.coords,c,0,0,E(o,c[0]),z(o,c[1])),N(e,f,0),e;let m,y,w,I,b=0,g=0,G=g;for(const V of a){if(V<i)continue;let v=0;g=G,w=m=E(o,c[b]),I=y=z(o,c[b+1]),d(e.coords,c,g,b,w,I),v++,b+=f,g+=h;for(let Y=1;Y<V;Y++,b+=f)w=E(o,c[b]),I=z(o,c[b+1]),w===m&&I===y||(d(e.coords,c,g,b,w-m,I-y),g+=h,v++,m=w,y=I);v>=i&&(e.lengths.push(v),G=g)}return M(e.coords,G),e.coords.length?e:null}function Oe(e,n,r,t,s,o,u=r,l=t){if(N(e),!n?.coords.length)return null;const i=B[s],{coords:c,lengths:a}=n,f=p(r,t),h=p(r&&u,t&&l),d=L(r,t,u,l);if(!a.length)return d(e.coords,c,0,0,c[0],c[1]),N(e,f,0),e;let m=0;const y=o*o;for(const w of a){if(w<i){m+=w*f;continue}const I=e.coords.length/h,b=m,g=m+(w-1)*f;d(e.coords,c,e.coords.length,b,c[b],c[b+1]),q(e.coords,c,f,y,d,b,g),d(e.coords,c,e.coords.length,g,c[g],c[g+1]);const G=e.coords.length/h-I;G>=i?e.lengths.push(G):M(e.coords,I*h),m+=w*f}return e.coords.length?e:null}function ke(e,n,r,t){const s=e[n],o=e[n+1],u=e[r],l=e[r+1],i=e[t],c=e[t+1];let a=u,f=l,h=i-a,d=c-f;if(h!==0||d!==0){const m=((s-a)*h+(o-f)*d)/(h*h+d*d);m>1?(a=i,f=c):m>0&&(a+=h*m,f+=d*m)}return h=s-a,d=o-f,h*h+d*d}function q(e,n,r,t,s,o,u){let l,i=t,c=0;for(let a=o+r;a<u;a+=r)l=ke(n,a,o,u),l>i&&(c=a,i=l);i>t&&(c-o>r&&q(e,n,r,t,s,o,c),s(e,n,e.length,c,n[c],n[c+1]),u-c>r&&q(e,n,r,t,s,c,u))}function Be(e,n,r,t){if(!n?.coords?.length)return null;const s=p(r,t);let o=Number.POSITIVE_INFINITY,u=Number.POSITIVE_INFINITY,l=Number.NEGATIVE_INFINITY,i=Number.NEGATIVE_INFINITY;if(n&&n.coords){const c=n.coords;for(let a=0;a<c.length;a+=s){const f=c[a],h=c[a+1];o=Math.min(o,f),l=Math.max(l,f),u=Math.min(u,h),i=Math.max(i,h)}}return he(e)?de(e,o,u,l,i):me(o,u,l,i,e),e}function O(e,n,r,t,s){const{coords:o,lengths:u}=n,l=p(r,t);if(!o.length)return e!==n&&N(e),e;le(s);const{originPosition:i,scale:c,translate:a}=s,f=je;f.originPosition=i;const h=f.scale;h[0]=c[0]??1,h[1]=-(c[1]??1),h[2]=c[2]??1,h[3]=c[3]??1;const d=f.translate;if(d[0]=a[0]??0,d[1]=a[1]??0,d[2]=a[2]??0,d[3]=a[3]??0,!u.length){for(let y=0;y<l;++y)e.coords[y]=$(f,o[y],y);return e!==n&&N(e,l,0),e}let m=0;for(let y=0;y<u.length;y++){const w=u[y];e.lengths[y]=w;for(let g=0;g<l;++g)e.coords[m+g]=$(f,o[m+g],g);let I=e.coords[m],b=e.coords[m+1];m+=l;for(let g=1;g<w;g++,m+=l){I+=o[m]*h[0],b+=o[m+1]*h[1],e.coords[m]=I,e.coords[m+1]=b;for(let G=2;G<l;++G)e.coords[m+G]=$(f,o[m+G],G)}}return e!==n&&N(e,o.length,u.length),e}function De(e,n,r,t,s,o){if(N(e),e.lengths.push(...n.lengths),r===s&&t===o)for(let u=0;u<n.coords.length;u++)e.coords.push(n.coords[u]);else{const u=p(r,t),l=L(r,t,s,o),i=n.coords;for(let c=0;c<i.length;c+=u)l(e.coords,i,e.coords.length,c,i[c],i[c+1])}return e}function ve(e,n,r,t){let s=0,o=e[t*n],u=e[t*(n+1)];for(let l=1;l<r;l++){const i=o+e[t*(n+l)],c=u+e[t*(n+l)+1],a=(i-o)*(c+u);o=i,u=c,s+=a}return .5*s}function He(e,n){const{coords:r,lengths:t}=e;let s=0,o=0;for(let u=0;u<t.length;u++){const l=t[u];o+=ve(r,s,l,n),s+=l}return Math.abs(o)}function N(e,n=0,r=0){M(e.lengths,r),M(e.coords,n)}function M(e,n=0){e.length!==n&&(e.length=n)}const je={originPosition:"lowerLeft",scale:[1,1,1,1],translate:[0,0,0,0]};export{W as $,ee as C,ne as H,O as I,te as K,Le as L,E as M,He as N,qe as P,Fe as Q,J as U,Ce as a,De as b,Ve as c,Oe as d,oe as e,_e as f,z as g,C as h,Ye as i,Ae as n,Se as o,Re as r,Ze as s,Ue as t,Be as y};
