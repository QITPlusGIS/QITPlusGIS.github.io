import{a5 as C}from"./uuid-De2V3pkO.js";import{w as g,p as S}from"./arcgisLayerUrl-DMpJLG2u.js";function e(s,r,t){return!!m(s,r,t)}function l(s,r,t){return m(s,r,t)}function m(s,r,t){return s&&s.hasOwnProperty(r)?s[r]:t}const A={name:"supportsName",size:"supportsSize",contentType:"supportsContentType",keywords:"supportsKeywords",exifInfo:"supportsExifInfo"};function Q(s){const r=s?.supportedSpatialAggregationStatistics?.map((t=>t.toLowerCase()));return{envelope:!!r?.includes("envelopeaggregate"),centroid:!!r?.includes("centroidaggregate"),convexHull:!!r?.includes("convexhullaggregate")}}function c(s,r){return!!s?.supportedOperationsWithCacheHint?.map((p=>p.toLowerCase()))?.includes(r.toLowerCase())}function O(s,r){return{analytics:R(s),attachment:v(s),data:x(s),metadata:T(s),operations:F(s.capabilities,s,r),query:w(s,r),queryRelated:D(s),queryTopFeatures:E(s),editing:z(s)}}function R(s){return{supportsCacheHint:c(s.advancedQueryCapabilities,"queryAnalytics")}}function v(s){const r=s.attachmentProperties,t={supportsName:!1,supportsSize:!1,supportsContentType:!1,supportsKeywords:!1,supportsExifInfo:!1,supportsCacheHint:c(s.advancedQueryCapabilities,"queryAttachments"),supportsResize:e(s,"supportsAttachmentsResizing",!1)};return r&&Array.isArray(r)&&r.forEach((p=>{const o=A[p.name];o&&(t[o]=!!p.isEnabled)})),t}function x(s){return{isVersioned:e(s,"isDataVersioned",!1),supportsAttachment:e(s,"hasAttachments",!1),supportsM:e(s,"hasM",!1),supportsZ:e(s,"hasZ",!1)}}function T(s){return{supportsAdvancedFieldProperties:e(s,"supportsFieldDescriptionProperty",!1)}}function F(s,r,t){const p=s?s.toLowerCase().split(",").map((h=>h.trim())):[],o=t?S(t):null,d=p.includes(o!=null&&o.serverType==="MapServer"?"data":"query"),a=p.includes("editing")&&!r.datesInUnknownTimezone;let u=a&&p.includes("create"),n=a&&p.includes("delete"),i=a&&p.includes("update");const y=p.includes("changetracking"),f=r.advancedQueryCapabilities;return a&&!(u||n||i)&&(u=n=i=!0),{supportsCalculate:e(r,"supportsCalculate",!1),supportsTruncate:e(r,"supportsTruncate",!1),supportsValidateSql:e(r,"supportsValidateSql",!1),supportsAdd:u,supportsDelete:n,supportsEditing:a,supportsChangeTracking:y,supportsQuery:d,supportsQueryAnalytics:e(f,"supportsQueryAnalytic",!1),supportsQueryAttachments:e(f,"supportsQueryAttachments",!1),supportsQueryTopFeatures:e(f,"supportsTopFeaturesQuery",!1),supportsResizeAttachments:e(r,"supportsAttachmentsResizing",!1),supportsSync:p.includes("sync"),supportsUpdate:i,supportsExceedsLimitStatistics:e(r,"supportsExceedsLimitStatistics",!1),supportsAsyncConvert3D:e(r,"supportsAsyncConvert3D",!1)}}function w(s,r){const t=s.advancedQueryCapabilities,p=s.ownershipBasedAccessControlForFeatures,o=s.archivingInfo,d=s.currentVersion,a=r?.includes("MapServer"),u=!a||d>=C("mapserver-pbf-version-support"),n=g(r),i=new Set((s.supportedQueryFormats??"").split(",").map((y=>y.toLowerCase().trim())));return{supportsStatistics:e(t,"supportsStatistics",s.supportsStatistics),supportsPercentileStatistics:e(t,"supportsPercentileStatistics",!1),supportsSpatialAggregationStatistics:e(t,"supportsSpatialAggregationStatistics",!1),supportedSpatialAggregationStatistics:Q(t),supportsCentroid:e(t,"supportsReturningGeometryCentroid",!1),supportsDistance:e(t,"supportsQueryWithDistance",!1),supportsDistinct:e(t,"supportsDistinct",s.supportsAdvancedQueries),supportsExtent:e(t,"supportsReturningQueryExtent",!1),supportsGeometryProperties:e(t,"supportsReturningGeometryProperties",!1),supportsHavingClause:e(t,"supportsHavingClause",!1),supportsOrderBy:e(t,"supportsOrderBy",s.supportsAdvancedQueries),supportsPagination:e(t,"supportsPagination",!1),supportsQuantization:e(s,"supportsCoordinatesQuantization",!1),supportsQuantizationEditMode:e(s,"supportsQuantizationEditMode",!1),supportsQueryGeometry:e(s,"supportsReturningQueryGeometry",!1),supportsResultType:e(t,"supportsQueryWithResultType",!1),supportsMaxRecordCountFactor:e(t,"supportsMaxRecordCountFactor",!1),supportsSqlExpression:e(t,"supportsSqlExpression",!1),supportsStandardizedQueriesOnly:e(s,"useStandardizedQueries",!1),supportsTopFeaturesQuery:e(t,"supportsTopFeaturesQuery",!1),supportsQueryByAnonymous:e(p,"allowAnonymousToQuery",!0),supportsQueryByOthers:e(p,"allowOthersToQuery",!0),supportsHistoricMoment:e(o,"supportsQueryWithHistoricMoment",!1),supportsFormatPBF:u&&i.has("pbf"),supportsDisjointSpatialRelationship:e(t,"supportsDisjointSpatialRel",!1),supportsCacheHint:e(t,"supportsQueryWithCacheHint",!1)||c(t,"query"),supportsDefaultSpatialReference:e(t,"supportsDefaultSR",!1),supportsCompactGeometry:n,supportsFullTextSearch:e(t,"supportsFullTextSearch",!1),maxRecordCountFactor:l(s,"maxRecordCountFactor",void 0),maxRecordCount:l(s,"maxRecordCount",void 0),standardMaxRecordCount:l(s,"standardMaxRecordCount",void 0),tileMaxRecordCount:l(s,"tileMaxRecordCount",void 0)}}function D(s){const r=s.advancedQueryCapabilities,t=e(r,"supportsAdvancedQueryRelated",!1);return{supportsPagination:e(r,"supportsQueryRelatedPagination",!1),supportsCount:t,supportsOrderBy:t,supportsCacheHint:c(r,"queryRelated")}}function E(s){return{supportsCacheHint:c(s.advancedQueryCapabilities,"queryTopFilter")}}function z(s){const r=s.ownershipBasedAccessControlForFeatures,t=s?s.advancedEditingCapabilities:void 0;return{supportsGeometryUpdate:e(s,"allowGeometryUpdates",!0),supportsGlobalId:e(s,"supportsApplyEditsWithGlobalIds",!1),supportsReturnServiceEditsInSourceSpatialReference:e(s,"supportsReturnServiceEditsInSourceSR",!1),supportsRollbackOnFailure:e(s,"supportsRollbackOnFailureParameter",!1),supportsUpdateWithoutM:e(s,"allowUpdateWithoutMValues",!1),supportsUploadWithItemId:e(s,"supportsAttachmentsByUploadId",!1),supportsDeleteByAnonymous:e(r,"allowAnonymousToDelete",!0),supportsDeleteByOthers:e(r,"allowOthersToDelete",!0),supportsUpdateByAnonymous:e(r,"allowAnonymousToUpdate",!0),supportsUpdateByOthers:e(r,"allowOthersToUpdate",!0),supportsAsyncApplyEdits:e(t,"supportsAsyncApplyEdits",!1),zDefault:l(s,"zDefault",void 0)}}export{O as a};
