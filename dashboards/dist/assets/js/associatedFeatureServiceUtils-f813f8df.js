import{a0 as t,p as f,s as m,az as E,aA as T,d8 as y,a3 as d,bo as D}from"./index-7a11ac30.js";const P={BingMapsLayer:async()=>(await t(()=>import("./BingMapsLayer-a748e2e6.js"),["./BingMapsLayer-a748e2e6.js","./index-7a11ac30.js","..\\index-b7f3bae3.css","./imageBitmapUtils-e3eddf37.js"],import.meta.url)).default,BuildingSceneLayer:async()=>(await t(()=>import("./BuildingSceneLayer-37468b36.js"),["./BuildingSceneLayer-37468b36.js","./index-7a11ac30.js","..\\index-b7f3bae3.css","./I3SUtil-1d027cef.js","./mat3f64-221ce671.js","./mat4f64-1413b4a7.js","./quat-cb1223d7.js","./quatf64-3363c48e.js","./spatialReferenceEllipsoidUtils-a9c221d0.js","./I3SBinaryReader-10b1e9b4.js","./VertexAttribute-0e674613.js","./orientedBoundingBox-7e8a589e.js","./plane-fe8ff856.js","./sphere-fbf33a2d.js","./SceneService-ae7599ce.js","./originUtils-cfe4feaf.js","./multiOriginJSONSupportUtils-c978f4c3.js","./saveAPIKeyUtils-12fb5bc7.js","./saveUtils-83d268df.js","./resourceUtils-7bd0505d.js","./I3SLayerDefinitions-9483c3b4.js","./popupUtils-2ea9bb09.js","./elevationInfoUtils-d138af65.js"],import.meta.url)).default,CSVLayer:async()=>(await t(()=>import("./CSVLayer-17714f38.js"),["./CSVLayer-17714f38.js","./index-7a11ac30.js","..\\index-b7f3bae3.css","./clientSideDefaults-fdfc3785.js","./QueryEngineCapabilities-85c4f1d0.js"],import.meta.url)).default,DimensionLayer:async()=>(await t(()=>import("./DimensionLayer-6474c7d6.js"),["./DimensionLayer-6474c7d6.js","./index-7a11ac30.js","..\\index-b7f3bae3.css","./Analysis-ec0dad76.js"],import.meta.url)).default,ElevationLayer:async()=>(await t(()=>import("./ElevationLayer-e01aadd9.js"),["./ElevationLayer-e01aadd9.js","./index-7a11ac30.js","..\\index-b7f3bae3.css"],import.meta.url)).default,FeatureLayer:async()=>(await t(()=>import("./index-7a11ac30.js").then(e=>e.oV),["./index-7a11ac30.js","..\\index-b7f3bae3.css"],import.meta.url)).default,GeoJSONLayer:async()=>(await t(()=>import("./GeoJSONLayer-46e96596.js"),["./GeoJSONLayer-46e96596.js","./index-7a11ac30.js","..\\index-b7f3bae3.css","./clientSideDefaults-fdfc3785.js","./QueryEngineCapabilities-85c4f1d0.js"],import.meta.url)).default,GeoRSSLayer:async()=>(await t(()=>import("./GeoRSSLayer-7ba0327c.js"),["./GeoRSSLayer-7ba0327c.js","./index-7a11ac30.js","..\\index-b7f3bae3.css"],import.meta.url)).default,GroupLayer:async()=>(await t(()=>import("./GroupLayer-c8215035.js"),["./GroupLayer-c8215035.js","./index-7a11ac30.js","..\\index-b7f3bae3.css","./saveUtils-83d268df.js","./resourceUtils-7bd0505d.js"],import.meta.url)).default,ImageryLayer:async()=>(await t(()=>import("./ImageryLayer-1ce45b0f.js"),["./ImageryLayer-1ce45b0f.js","./index-7a11ac30.js","..\\index-b7f3bae3.css","./ImageHistogramParameters-3bfda6a4.js","./multidimensionalUtils-257143d6.js","./dataUtils-30175347.js","./RasterSymbolizer-4e1e716c.js","./utils-9e802c72.js","./utils-a4d17ea4.js","./generateRendererUtils-f470ead4.js","./imageBitmapUtils-e3eddf37.js","./executeQueryJSON-4c848e82.js","./query-e38a6974.js","./pbfQueryUtils-70cbfb32.js","./pbf-4e4a1fd1.js","./OptimizedGeometry-d94e541f.js","./OptimizedFeatureSet-1d1ac4b9.js","./featureConversionUtils-6562612a.js","./AttachmentInfo-11faf605.js","./executeForIds-4a2a808a.js"],import.meta.url)).default,ImageryTileLayer:async()=>(await t(()=>import("./ImageryTileLayer-8f20d1dd.js"),["./ImageryTileLayer-8f20d1dd.js","./index-7a11ac30.js","..\\index-b7f3bae3.css","./ImageHistogramParameters-3bfda6a4.js","./multidimensionalUtils-257143d6.js","./dataUtils-30175347.js","./RasterSymbolizer-4e1e716c.js","./utils-9e802c72.js","./utils-a4d17ea4.js","./generateRendererUtils-f470ead4.js","./RawBlockCache-fc073872.js","./rasterProjectionHelper-0477e6e7.js","./utils-093feb12.js"],import.meta.url)).default,IntegratedMeshLayer:async()=>(await t(()=>import("./IntegratedMeshLayer-be27cb71.js"),["./IntegratedMeshLayer-be27cb71.js","./index-7a11ac30.js","..\\index-b7f3bae3.css","./persistable-05b06bc4.js","./multiOriginJSONSupportUtils-c978f4c3.js","./resourceExtension-7a823dd5.js","./SceneService-ae7599ce.js","./originUtils-cfe4feaf.js","./saveAPIKeyUtils-12fb5bc7.js","./saveUtils-83d268df.js","./resourceUtils-7bd0505d.js","./I3SLayerDefinitions-9483c3b4.js","./elevationInfoUtils-d138af65.js"],import.meta.url)).default,KMLLayer:async()=>(await t(()=>import("./KMLLayer-5a38ea55.js"),["./KMLLayer-5a38ea55.js","./index-7a11ac30.js","..\\index-b7f3bae3.css","./kmlUtils-bfeb799a.js"],import.meta.url)).default,LineOfSightLayer:async()=>(await t(()=>import("./LineOfSightLayer-aec76f97.js"),["./LineOfSightLayer-aec76f97.js","./index-7a11ac30.js","..\\index-b7f3bae3.css","./Analysis-ec0dad76.js","./persistable-05b06bc4.js","./multiOriginJSONSupportUtils-c978f4c3.js","./resourceExtension-7a823dd5.js","./elevationInfoUtils-d138af65.js"],import.meta.url)).default,LinkChartLayer:async()=>(await t(()=>import("./LinkChartLayer-e2dd9f93.js"),["./LinkChartLayer-e2dd9f93.js","./index-7a11ac30.js","..\\index-b7f3bae3.css","./geohashUtils-77d8429b.js","./featureConversionUtils-6562612a.js","./OptimizedGeometry-d94e541f.js","./OptimizedFeatureSet-1d1ac4b9.js","./FeatureStore-e0526620.js","./BoundsStore-7763f3dc.js","./PooledRBush-6b55d9e9.js","./timeSupport-30c0f8f9.js","./projectionSupport-3c44e125.js","./json-48e3ea08.js","./QueryEngine-c1de2eee.js","./WhereClause-e08a1c07.js","./TimeOnly-85e707c1.js","./QueryEngineCapabilities-85c4f1d0.js","./quantizationUtils-cf2615da.js","./utils-f0f66bbd.js","./utils-77f23937.js","./generateRendererUtils-f470ead4.js","./RenderState-1d6218ee.js","./clientSideDefaults-fdfc3785.js"],import.meta.url)).default,MapImageLayer:async()=>(await t(()=>import("./MapImageLayer-8043be61.js"),["./MapImageLayer-8043be61.js","./index-7a11ac30.js","..\\index-b7f3bae3.css","./scaleUtils-b7ab4a17.js","./SublayersOwner-ece3b893.js","./QueryTask-7d3ac9d5.js","./executeForIds-4a2a808a.js","./query-e38a6974.js","./pbfQueryUtils-70cbfb32.js","./pbf-4e4a1fd1.js","./OptimizedGeometry-d94e541f.js","./OptimizedFeatureSet-1d1ac4b9.js","./executeQueryJSON-4c848e82.js","./executeQueryPBF-c39a1a7e.js","./featureConversionUtils-6562612a.js","./sublayerUtils-3a2c65d6.js","./ExportImageParameters-494fb1c2.js","./floorFilterUtils-080a7cd2.js","./imageBitmapUtils-e3eddf37.js"],import.meta.url)).default,MapNotesLayer:async()=>(await t(()=>import("./MapNotesLayer-d9dbfa1a.js"),["./MapNotesLayer-d9dbfa1a.js","./index-7a11ac30.js","..\\index-b7f3bae3.css","./GraphicsLayer-f79d58c7.js","./objectIdUtils-789e911a.js"],import.meta.url)).default,MediaLayer:async()=>(await t(()=>import("./MediaLayer-1a800421.js"),["./MediaLayer-1a800421.js","./index-7a11ac30.js","..\\index-b7f3bae3.css","./imageUtils-c0ee6d1f.js","./perspectiveUtils-ea72dad5.js","./normalizeUtilsSync-61cb78de.js","./mat3f64-221ce671.js","./resourceExtension-7a823dd5.js","./BoundsStore-7763f3dc.js","./PooledRBush-6b55d9e9.js"],import.meta.url)).default,OGCFeatureLayer:async()=>(await t(()=>import("./OGCFeatureLayer-78eefb34.js"),["./OGCFeatureLayer-78eefb34.js","./index-7a11ac30.js","..\\index-b7f3bae3.css","./ogcFeatureUtils-8713b586.js","./featureConversionUtils-6562612a.js","./OptimizedGeometry-d94e541f.js","./OptimizedFeatureSet-1d1ac4b9.js","./geojson-ea94f1b6.js","./date-d60e9730.js","./clientSideDefaults-fdfc3785.js","./QueryEngineCapabilities-85c4f1d0.js"],import.meta.url)).default,OpenStreetMapLayer:async()=>(await t(()=>import("./OpenStreetMapLayer-035fb30a.js"),["./OpenStreetMapLayer-035fb30a.js","./index-7a11ac30.js","..\\index-b7f3bae3.css","./WebTileLayer-975526f8.js","./imageBitmapUtils-e3eddf37.js"],import.meta.url)).default,OrientedImageryLayer:async()=>(await t(()=>import("./OrientedImageryLayer-6108e9f0.js"),["./OrientedImageryLayer-6108e9f0.js","./index-7a11ac30.js","..\\index-b7f3bae3.css"],import.meta.url)).default,PointCloudLayer:async()=>(await t(()=>import("./PointCloudLayer-d23cf5c7.js"),["./PointCloudLayer-d23cf5c7.js","./index-7a11ac30.js","..\\index-b7f3bae3.css","./SceneService-ae7599ce.js","./originUtils-cfe4feaf.js","./multiOriginJSONSupportUtils-c978f4c3.js","./saveAPIKeyUtils-12fb5bc7.js","./saveUtils-83d268df.js","./resourceUtils-7bd0505d.js","./PointCloudUniqueValueRenderer-f6b32038.js","./elevationInfoUtils-d138af65.js"],import.meta.url)).default,RouteLayer:async()=>(await t(()=>import("./RouteLayer-3afb617e.js"),["./RouteLayer-3afb617e.js","./index-7a11ac30.js","..\\index-b7f3bae3.css","./originUtils-cfe4feaf.js","./multiOriginJSONSupportUtils-c978f4c3.js","./Stop-be210005.js","./commonProperties-da958896.js"],import.meta.url)).default,SceneLayer:async()=>(await t(()=>import("./SceneLayer-884365ae.js"),["./SceneLayer-884365ae.js","./index-7a11ac30.js","..\\index-b7f3bae3.css","./SceneService-ae7599ce.js","./originUtils-cfe4feaf.js","./multiOriginJSONSupportUtils-c978f4c3.js","./saveAPIKeyUtils-12fb5bc7.js","./saveUtils-83d268df.js","./resourceUtils-7bd0505d.js","./I3SUtil-1d027cef.js","./mat3f64-221ce671.js","./mat4f64-1413b4a7.js","./quat-cb1223d7.js","./quatf64-3363c48e.js","./spatialReferenceEllipsoidUtils-a9c221d0.js","./I3SBinaryReader-10b1e9b4.js","./VertexAttribute-0e674613.js","./orientedBoundingBox-7e8a589e.js","./plane-fe8ff856.js","./sphere-fbf33a2d.js","./I3SLayerDefinitions-9483c3b4.js","./persistable-05b06bc4.js","./resourceExtension-7a823dd5.js","./elevationInfoUtils-d138af65.js","./popupUtils-2ea9bb09.js"],import.meta.url)).default,StreamLayer:async()=>(await t(()=>import("./StreamLayer-c7a1461d.js"),["./StreamLayer-c7a1461d.js","./index-7a11ac30.js","..\\index-b7f3bae3.css"],import.meta.url)).default,SubtypeGroupLayer:async()=>(await t(()=>import("./SubtypeGroupLayer-09110591.js"),["./SubtypeGroupLayer-09110591.js","./index-7a11ac30.js","..\\index-b7f3bae3.css"],import.meta.url)).default,TileLayer:async()=>(await t(()=>import("./TileLayer-35c82132.js"),["./TileLayer-35c82132.js","./index-7a11ac30.js","..\\index-b7f3bae3.css","./SublayersOwner-ece3b893.js","./QueryTask-7d3ac9d5.js","./executeForIds-4a2a808a.js","./query-e38a6974.js","./pbfQueryUtils-70cbfb32.js","./pbf-4e4a1fd1.js","./OptimizedGeometry-d94e541f.js","./OptimizedFeatureSet-1d1ac4b9.js","./executeQueryJSON-4c848e82.js","./executeQueryPBF-c39a1a7e.js","./featureConversionUtils-6562612a.js","./sublayerUtils-3a2c65d6.js","./imageBitmapUtils-e3eddf37.js"],import.meta.url)).default,UnknownLayer:async()=>(await t(()=>import("./UnknownLayer-24f70cb6.js"),["./UnknownLayer-24f70cb6.js","./index-7a11ac30.js","..\\index-b7f3bae3.css"],import.meta.url)).default,UnsupportedLayer:async()=>(await t(()=>import("./UnsupportedLayer-ba84e748.js"),["./UnsupportedLayer-ba84e748.js","./index-7a11ac30.js","..\\index-b7f3bae3.css"],import.meta.url)).default,VectorTileLayer:async()=>(await t(()=>import("./index-7a11ac30.js").then(e=>e.oR),["./index-7a11ac30.js","..\\index-b7f3bae3.css"],import.meta.url)).default,VoxelLayer:async()=>(await t(()=>import("./VoxelLayer-396cfdba.js"),["./VoxelLayer-396cfdba.js","./index-7a11ac30.js","..\\index-b7f3bae3.css","./SceneService-ae7599ce.js","./originUtils-cfe4feaf.js","./multiOriginJSONSupportUtils-c978f4c3.js","./saveAPIKeyUtils-12fb5bc7.js","./saveUtils-83d268df.js","./resourceUtils-7bd0505d.js","./persistable-05b06bc4.js","./resourceExtension-7a823dd5.js","./quat-cb1223d7.js","./mat3f64-221ce671.js","./quatf64-3363c48e.js"],import.meta.url)).default,WFSLayer:async()=>(await t(()=>import("./WFSLayer-a7c2c28a.js"),["./WFSLayer-a7c2c28a.js","./index-7a11ac30.js","..\\index-b7f3bae3.css","./clientSideDefaults-fdfc3785.js","./QueryEngineCapabilities-85c4f1d0.js","./wfsUtils-d88faaac.js","./geojson-ea94f1b6.js","./date-d60e9730.js","./OptimizedGeometry-d94e541f.js","./xmlUtils-444cb4c0.js"],import.meta.url)).default,WMSLayer:async()=>(await t(()=>import("./WMSLayer-303e4a71.js"),["./WMSLayer-303e4a71.js","./index-7a11ac30.js","..\\index-b7f3bae3.css","./scaleUtils-b7ab4a17.js","./crsUtils-3bab3d8c.js","./ExportWMSImageParameters-fa6e6e6e.js","./imageBitmapUtils-e3eddf37.js"],import.meta.url)).default,WMTSLayer:async()=>(await t(()=>import("./WMTSLayer-80de1eda.js"),["./WMTSLayer-80de1eda.js","./index-7a11ac30.js","..\\index-b7f3bae3.css","./WebTileLayer-975526f8.js","./imageBitmapUtils-e3eddf37.js","./crsUtils-3bab3d8c.js","./xmlUtils-444cb4c0.js"],import.meta.url)).default,WebTileLayer:async()=>(await t(()=>import("./WebTileLayer-975526f8.js").then(e=>e.W),["./WebTileLayer-975526f8.js","./index-7a11ac30.js","..\\index-b7f3bae3.css","./imageBitmapUtils-e3eddf37.js"],import.meta.url)).default};async function h(e,o){const i=f(e);if(!i)throw new m("invalid-url","Invalid scene service url");const a={...o,sceneServerUrl:i.url.path,layerId:i.sublayer??void 0};if(a.sceneLayerItem??(a.sceneLayerItem=await A(a)),a.sceneLayerItem==null)return L(a.sceneServerUrl.replace("/SceneServer","/FeatureServer"),a);const r=await R(a);if(!(r!=null&&r.url))throw new m("related-service-not-found","Could not find feature service through portal item relationship");const _=await L(r.url,a);return _.portalItem=r,_}async function A(e){const o=(await v(e)).serviceItemId;if(!o)return null;const i=new E({id:o,apiKey:e.apiKey}),a=await O(e);a!=null&&(i.portal=new T({url:a}));try{return i.load({signal:e.signal})}catch(r){return y(r),null}}async function v(e){if(e.rootDocument)return e.rootDocument;const o={query:{f:"json",token:e.apiKey},responseType:"json",signal:e.signal};try{const i=await d(e.sceneServerUrl,o);e.rootDocument=i.data}catch{e.rootDocument={}}return e.rootDocument}async function O(e){var a;const o=(a=D)==null?void 0:a.findServerInfo(e.sceneServerUrl);if(o!=null&&o.owningSystemUrl)return o.owningSystemUrl;const i=e.sceneServerUrl.replace(/(.*\/rest)\/.*/i,"$1")+"/info";try{const r=(await d(i,{query:{f:"json"},responseType:"json",signal:e.signal})).data.owningSystemUrl;if(r)return r}catch(r){y(r)}return null}async function L(e,o){const i=f(e);if(!i)throw new m("invalid-feature-service-url","Invalid feature service url");const a=i.url.path,r=o.layerId;if(r==null)return{serverUrl:a};const _=v(o),c=n=>{const I={query:{f:"json"},responseType:"json",authMode:n,signal:o.signal};return d(a,I)},w=c("anonymous").catch(()=>c("no-prompt")),[p,l]=await Promise.all([w,_]),s=l==null?void 0:l.layers,u=p.data&&p.data.layers;if(!Array.isArray(u))throw new Error("expected layers array");if(Array.isArray(s)){for(let n=0;n<Math.min(s.length,u.length);n++)if(s[n].id===r)return{serverUrl:a,layerId:u[n].id}}else if(r!=null&&r<u.length)return{serverUrl:a,layerId:u[r].id};throw new Error("could not find matching associated sublayer")}async function R({sceneLayerItem:e,signal:o}){if(!e)return null;try{const i=(await e.fetchRelatedItems({relationshipType:"Service2Service",direction:"reverse"},{signal:o})).find(r=>r.type==="Feature Service")||null;if(!i)return null;const a=new E({portal:i.portal,id:i.id});return await a.load(),a}catch(i){return y(i),null}}export{P as a,h as l};
