import{s as L,bI as M,bJ as d,bK as g,bL as _,bM as O,bN as B,bO as N,bP as j,bC as z,bD as U,bj as E,bQ as W,bR as Y,bS as R,bT as h}from"./index-4457faad.js";import{c as A}from"./spatialReferenceEllipsoidUtils-db62ad95.js";import{i as m,T as u}from"./BufferView-eb3bc1bb.js";import{n as V,s as $}from"./vec32-3504bc6a.js";const F=L.getLogger("esri.geometry.support.meshUtils.normalProjection");function I(r,e,t,a,o){return C(a)?(l(y.TO_PCPF,m.fromTypedArray(r),u.fromTypedArray(e),u.fromTypedArray(t),a,m.fromTypedArray(o)),o):(F.error("Cannot convert spatial reference to PCPF"),o)}function J(r,e,t,a,o){return C(a)?(l(y.FROM_PCPF,m.fromTypedArray(r),u.fromTypedArray(e),u.fromTypedArray(t),a,m.fromTypedArray(o)),o):(F.error("Cannot convert to spatial reference from PCPF"),o)}function K(r,e,t){return M(r,e,0,t,A(e),0,r.length/3),t}function Q(r,e,t){return M(r,A(t),0,e,t,0,r.length/3),e}function q(r,e,t){return R(n,t),V(e,r,n),h(n)||$(e,e),e}function H(r,e,t){if(R(n,t),V(e,r,n,4),h(n)||$(e,e,4),r!==e)for(let a=3;a<r.length;a+=4)e[a]=r[a];return e}function X(r,e,t,a,o){if(!C(a))return F.error("Cannot convert spatial reference to PCPF"),o;l(y.TO_PCPF,m.fromTypedArray(r,4*Float32Array.BYTES_PER_ELEMENT),u.fromTypedArray(e),u.fromTypedArray(t),a,m.fromTypedArray(o,4*Float32Array.BYTES_PER_ELEMENT));for(let f=3;f<r.length;f+=4)o[f]=r[f];return o}function Z(r,e,t,a,o){if(!C(a))return F.error("Cannot convert to spatial reference from PCPF"),o;l(y.FROM_PCPF,m.fromTypedArray(r,16),u.fromTypedArray(e),u.fromTypedArray(t),a,m.fromTypedArray(o,16));for(let f=3;f<r.length;f+=4)o[f]=r[f];return o}function l(r,e,t,a,o,f){if(!e)return;const b=t.count,i=A(o);if(v(o))for(let c=0;c<b;c++)a.getVec(c,T),e.getVec(c,s),d(i,T,p,i),g(n,p),r===y.FROM_PCPF&&_(n,n),O(s,s,n),f.setVec(c,s);else for(let c=0;c<b;c++){a.getVec(c,T),e.getVec(c,s),d(i,T,p,i),g(n,p);const S=B(t.get(c,1));let P=Math.cos(S);r===y.TO_PCPF&&(P=1/P),n[0]*=P,n[1]*=P,n[2]*=P,n[3]*=P,n[4]*=P,n[5]*=P,r===y.FROM_PCPF&&_(n,n),O(s,s,n),N(s,s),f.setVec(c,s)}return f}function C(r){return v(r)||k(r)}function v(r){return r.isWGS84||j(r)||z(r)||U(r)}function k(r){return r.isWebMercator}var y;(function(r){r[r.TO_PCPF=0]="TO_PCPF",r[r.FROM_PCPF=1]="FROM_PCPF"})(y||(y={}));const T=E(),s=E(),p=W(),n=Y();export{Q as E,q as M,H as O,X as R,I as _,K as h,J as j,Z as v};
