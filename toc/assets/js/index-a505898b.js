var Vwe=Object.defineProperty;var zwe=(t,e,i)=>e in t?Vwe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i;var we=(t,e,i)=>(zwe(t,typeof e!="symbol"?e+"":e,i),i);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function i(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(n){if(n.ep)return;n.ep=!0;const s=i(n);fetch(n.href,s)}})();const jwe=""+new URL("../qit-plus-logo-a21383a8.png",import.meta.url).href,Bwe=t=>{document.title=t},Uwe=(t,e,i)=>{const r=document.createElement("div");i||(i=e),r.id="titleDiv",r.innerHTML=`
        <h1 id="title">
            <img src="${i}" alt="" id="logo" />
            ${t}
        </h1>
    `,document.body.appendChild(r)},Gwe=()=>{const t=document.getElementById("titleDiv"),e=document.createElement("div");e.id="menuButtonDiv",e.innerHTML='<button id="menuButton"><span id="menuButtonText">Menu</span> <calcite-icon icon="hamburger" text-label="Menu"></button>',t.appendChild(e);const i=document.createElement("div");i.id="menuItemsContainer",i.innerHTML='<div id="menuItemsContent"></div>',document.body.appendChild(i);const r=[{id:"gold-coast-city",href:"?lga=gold-coast-city",text:"Gold Coast City"},{id:"somerset-regional",href:"?lga=somerset-regional",text:"Somerset Regional"},{id:"scenic-rim-regional",href:"?lga=scenic-rim-regional",text:"Scenic Rim Regional"}];let n='<button id="closeMenuButton" class="closeButton"><calcite-icon icon="x" text-label="Close"></button><ul>';for(const o of r)n+=`<li><a id="${o.id}" href="${o.href}">${o.text}</a></li>`;n+="</ul>";const s=()=>{document.getElementById("menuItemsContainer").classList.toggle("active")};document.getElementById("menuItemsContent").innerHTML=n,document.getElementById("menuButton").onclick=()=>{s()},document.getElementById("closeMenuButton").onclick=()=>{s()}},Hwe=()=>{const t=document.createElement("div");t.id="viewDiv",document.body.appendChild(t)},qwe=()=>{const t=document.createElement("div");t.id="loader",t.innerHTML=`
        <div class="loader-inner">
            <div class="loader-line-wrap">
                <div class="loader-line"></div>
            </div>
            <div class="loader-line-wrap">
                <div class="loader-line"></div>
            </div>
            <div class="loader-line-wrap">
                <div class="loader-line"></div>
            </div>
            <div class="loader-line-wrap">
                <div class="loader-line"></div>
            </div>
            <div class="loader-line-wrap">
                <div class="loader-line"></div>
            </div>
        </div>
    `,document.body.appendChild(t)},Wwe=()=>{const t=["#311802","#924907","#f48420","#f8af6d","#fde4ce"],e={center:[153,-28],zoom:11},i=document.getElementById("loader");return{tocColors:t,defaultView:e,startLoader:()=>{i.classList.remove("hidden")},stopLoader:()=>{i.classList.add("hidden")}}};let Tm;function ee(t){return typeof Tm[t]=="function"?Tm[t]=Tm[t](globalThis):Tm[t]}var fre,mre,gre,yre;Tm=(fre=globalThis.dojoConfig)!=null&&fre.has||(mre=globalThis.esriConfig)!=null&&mre.has?{...(gre=globalThis.dojoConfig)==null?void 0:gre.has,...(yre=globalThis.esriConfig)==null?void 0:yre.has}:{},ee.add=(t,e,i,r)=>((r||Tm[t]===void 0)&&(Tm[t]=e),i&&ee(t)),ee.cache=Tm,ee.add("esri-deprecation-warnings",!0),ee.add("esri-force-fullscreen-debug",!1),(()=>{var e;ee.add("host-webworker",globalThis.WorkerGlobalScope!==void 0&&self instanceof globalThis.WorkerGlobalScope);const t=typeof window<"u"&&typeof location<"u"&&typeof document<"u"&&window.location===location&&window.document===document;if(ee.add("host-browser",t),ee.add("host-node",typeof globalThis.process=="object"&&((e=globalThis.process.versions)==null?void 0:e.node)&&globalThis.process.versions.v8),ee.add("dom",t),ee("host-browser")){const i=navigator,r=i.userAgent,n=i.appVersion,s=parseFloat(n);if(ee.add("wp",parseFloat(r.split("Windows Phone")[1])||void 0),ee.add("msapp",parseFloat(r.split("MSAppHost/")[1])||void 0),ee.add("khtml",n.includes("Konqueror")?s:void 0),ee.add("edge",parseFloat(r.split("Edge/")[1])||void 0),ee.add("opr",parseFloat(r.split("OPR/")[1])||void 0),ee.add("webkit",!ee("wp")&&!ee("edge")&&parseFloat(r.split("WebKit/")[1])||void 0),ee.add("chrome",!ee("edge")&&!ee("opr")&&parseFloat(r.split("Chrome/")[1])||void 0),ee.add("android",!ee("wp")&&parseFloat(r.split("Android ")[1])||void 0),ee.add("safari",!n.includes("Safari")||ee("wp")||ee("chrome")||ee("android")||ee("edge")||ee("opr")?void 0:parseFloat(n.split("Version/")[1])),ee.add("mac",n.includes("Macintosh")),!ee("wp")&&/(iPhone|iPod|iPad)/.test(r)){const o=RegExp.$1.replace(/P/,"p"),a=/OS ([\d_]+)/.test(r)?RegExp.$1:"1",l=parseFloat(a.replace(/_/,".").replaceAll("_",""));ee.add(o,l),ee.add("ios",l)}ee("webkit")||(!r.includes("Gecko")||ee("wp")||ee("khtml")||ee("edge")||ee.add("mozilla",s),ee("mozilla")&&ee.add("ff",parseFloat(r.split("Firefox/")[1]||r.split("Minefield/")[1])||void 0))}})(),(()=>{if(globalThis.navigator){const t=navigator.userAgent,e=/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini|IEMobile/i.test(t),i=/iPhone/i.test(t);e&&ee.add("esri-mobile",e),i&&ee.add("esri-iPhone",i),ee.add("esri-geolocation",!!navigator.geolocation)}ee.add("esri-wasm","WebAssembly"in globalThis),ee.add("esri-shared-array-buffer",()=>{const t="SharedArrayBuffer"in globalThis,e=globalThis.crossOriginIsolated===!1;return t&&!e}),ee.add("wasm-simd",()=>{const t=[0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11];return WebAssembly.validate(new Uint8Array(t))}),ee.add("esri-atomics","Atomics"in globalThis),ee.add("esri-workers","Worker"in globalThis),ee.add("web-feat:cache","caches"in globalThis),ee.add("esri-workers-arraybuffer-transfer",!ee("safari")||Number(ee("safari"))>=12),ee.add("workers-pool-size",8),ee.add("featurelayer-simplify-thresholds",[.5,.5,.5,.5]),ee.add("featurelayer-simplify-payload-size-factors",[1,1,4]),ee.add("featurelayer-animation-enabled",!0),ee.add("featurelayer-snapshot-enabled",!0),ee.add("featurelayer-snapshot-point-min-threshold",8e4),ee.add("featurelayer-snapshot-point-max-threshold",4e5),ee.add("featurelayer-snapshot-point-coverage",.1),ee.add("featurelayer-advanced-symbols",!1),ee.add("featurelayer-pbf",!0),ee.add("featurelayer-pbf-statistics",!1),ee.add("feature-layers-workers",!0),ee.add("feature-polyline-generalization-factor",1),ee.add("mapview-transitions-duration",200),ee.add("mapview-srswitch-adjust-rotation-scale-threshold",24e6),ee.add("mapserver-pbf-version-support",10.81),ee.add("mapservice-popup-identify-max-tolerance",20),ee.add("heatmap-allow-raster-fallback",!1),ee.add("heatmap-force-raster",!1),ee("host-webworker")||ee("host-browser")&&(ee.add("esri-csp-restrictions",()=>{try{new Function}catch{return!0}return!1}),ee.add("esri-image-decode",()=>{if("decode"in new Image){const t=new Image;return t.src='data:image/svg+xml;charset=UTF-8,<svg version="1.1" xmlns="http://www.w3.org/2000/svg"></svg>',void t.decode().then(()=>{ee.add("esri-image-decode",!0,!0,!0)}).catch(()=>{ee.add("esri-image-decode",!1,!0,!0)})}return!1}),ee.add("esri-url-encodes-apostrophe",()=>{const t=window.document.createElement("a");return t.href="?'",t.href.includes("?%27")}))})();let j2=class oy{constructor(e=1){this._seed=e}set seed(e){this._seed=e??Math.random()*oy._m}getInt(){return this._seed=(oy._a*this._seed+oy._c)%oy._m,this._seed}getFloat(){return this.getInt()/(oy._m-1)}getIntRange(e,i){return Math.round(this.getFloatRange(e,i))}getFloatRange(e,i){const r=i-e;return e+this.getInt()/oy._m*r}};j2._m=2147483647,j2._a=48271,j2._c=0;const Jwe=1.5,mmt=1/Jwe,gmt=.5;function Zwe(t){if(!t)return;const e=t.length;return e>0?t[e-1]:void 0}function xre(t){return t}function Ywe(t,e=xre){if(!t||t.length===0)return;let i=t[0],r=e(i);for(let n=1;n<t.length;++n){const s=t[n],o=Number(e(s));o>r&&(r=o,i=s)}return i}function Sre(t,e=xre){return Ywe(t,i=>-e(i))}function Kwe(t,e){return e?t.filter((i,r,n)=>n.findIndex(e.bind(null,i))===r):t.filter((i,r,n)=>n.indexOf(i)===r)}function JT(t,e,i){if(t==null&&e==null)return!0;if(t==null||e==null||t.length!==e.length)return!1;if(i){for(let r=0;r<t.length;r++)if(!i(t[r],e[r]))return!1}else for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function Xwe(t,e){let i=t.length!==e.length;i&&(t.length=e.length);for(let r=0;r<e.length;++r)t[r]!==e[r]&&(t[r]=e[r],i=!0);return i}function ymt(t,e,i){let r,n;return i?(r=e.filter(s=>!t.some(o=>i(o,s))),n=t.filter(s=>!e.some(o=>i(o,s)))):(r=e.filter(s=>!t.includes(s)),n=t.filter(s=>!e.includes(s))),{added:r,removed:n}}function vmt(t){return t&&typeof t.length=="number"}function Qwe(t,e){const i=t.length;if(i===0)return[];const r=[];for(let n=0;n<i;n+=e)r.push(t.slice(n,n+e));return r}const e1e=!!Array.prototype.fill;function t1e(t,e){if(e1e)return new Array(t).fill(e);const i=new Array(t);for(let r=0;r<t;r++)i[r]=e;return i}function _mt(t,e){e===void 0&&(e=t,t=0);const i=new Array(e-t);for(let r=t;r<e;r++)i[r-t]=r;return i}function Ire(t,e,i){if(!t||t.length===0)return;const r=t.length-1,n=t[0];if(e<=i(n))return n;const s=t[r];if(e>=i(s))return s;let o=0,a=0,l=r;for(;o<l;){a=o+Math.floor((l-o)/2);const c=t[a],u=i(c);if(u===e)return c;if(e<u){if(a>0){const h=t[a-1],f=i(h);if(e>f)return e-f>=u-e?c:h}l=a}else{if(a<r){const h=t[a+1],f=i(h);if(e<f)return e-u>=f-e?h:c}o=a+1}}return t[a]}let Tre=class{constructor(){this.last=0}};const Cre=new Tre;function yD(t,e,i,r){r=r||Cre;const n=Math.max(0,r.last-10);for(let o=n;o<i;++o)if(t[o]===e)return r.last=o,o;const s=Math.min(n,i);for(let o=0;o<s;++o)if(t[o]===e)return r.last=o,o;return-1}function i1e(t,e,i,r){const n=i??t.length,s=yD(t,e,n,r);if(s!==-1)return t[s]=t[n-1],i==null&&t.pop(),e}const vc=new Set;function r1e(t,e,i=t.length,r=e.length,n,s){if(r===0||i===0)return i;vc.clear();for(let a=0;a<r;++a)vc.add(e[a]);n=n||Cre;const o=Math.max(0,n.last-10);for(let a=o;a<i;++a)if(vc.has(t[a])&&(s&&s.push(t[a]),vc.delete(t[a]),t[a]=t[i-1],--i,--a,vc.size===0||i===0))return vc.clear(),i;for(let a=0;a<o;++a)if(vc.has(t[a])&&(s&&s.push(t[a]),vc.delete(t[a]),t[a]=t[i-1],--i,--a,vc.size===0||i===0))return vc.clear(),i;return vc.clear(),i}function wmt(t,e){let i=0;for(let r=0;r<t.length;++r){const n=t[r];e(n,r)&&(t[i]=n,i++)}t.length=i}function ww(t,e){const i=t.indexOf(e);return i!==-1?(t.splice(i,1),e):null}function Dt(t,e){return t!=null}const xmt=[];function Smt(t){return t instanceof ArrayBuffer}function D6(t){var e;return((e=t==null?void 0:t.constructor)==null?void 0:e.name)==="Int8Array"}function Ere(t){var e;return((e=t==null?void 0:t.constructor)==null?void 0:e.name)==="Uint8Array"}function Mre(t){var e;return((e=t==null?void 0:t.constructor)==null?void 0:e.name)==="Uint8ClampedArray"}function N6(t){var e;return((e=t==null?void 0:t.constructor)==null?void 0:e.name)==="Int16Array"}function $re(t){var e;return((e=t==null?void 0:t.constructor)==null?void 0:e.name)==="Uint16Array"}function V6(t){var e;return((e=t==null?void 0:t.constructor)==null?void 0:e.name)==="Int32Array"}function Are(t){var e;return((e=t==null?void 0:t.constructor)==null?void 0:e.name)==="Uint32Array"}function VO(t){var e;return((e=t==null?void 0:t.constructor)==null?void 0:e.name)==="Float32Array"}function zO(t){var e;return((e=t==null?void 0:t.constructor)==null?void 0:e.name)==="Float64Array"}function n1e(t){return!("buffer"in t)}function s1e(t){return t!=null?n1e(t)?8*t.length+12:t.byteLength+o1e:0}const o1e=145,a1e=1024;function Imt(t){return zO(t)||VO(t)||V6(t)||N6(t)||D6(t)}function Tmt(t){return zO(t)||VO(t)}function Cmt(t){return zO(t)?179769e303:VO(t)?3402823e32:Are(t)?4294967295:$re(t)?65535:Ere(t)||Mre(t)?255:V6(t)?2147483647:N6(t)?32767:D6(t)?127:256}function kre(t,e){let i;if(e)for(i in t)t.hasOwnProperty(i)&&(t[i]===void 0?delete t[i]:t[i]instanceof Object&&kre(t[i],!0));else for(i in t)t.hasOwnProperty(i)&&t[i]===void 0&&delete t[i];return t}function U(t){if(!t||typeof t!="object"||typeof t=="function")return t;const e=Lre(t);if(e!=null)return e;if(bk(t))return t.clone();if(Pre(t))return t.map(U);if(Ore(t))return t.clone();const i={};for(const r of Object.getOwnPropertyNames(t))i[r]=U(t[r]);return i}function vD(t){if(!t||typeof t!="object"||typeof t=="function"||"HTMLElement"in globalThis&&t instanceof HTMLElement)return t;const e=Lre(t);if(e!=null)return e;if(Pre(t)){let i=!0;const r=t.map(n=>{const s=vD(n);return n!=null&&s==null&&(i=!1),s});return i?r:null}if(bk(t))return t.clone();if(t instanceof File||t instanceof Blob)return t;if(!Ore(t)){const i=new(Object.getPrototypeOf(t)).constructor;for(const r of Object.getOwnPropertyNames(t)){const n=t[r],s=vD(n);if(n!=null&&s==null)return null;i[r]=s}return i}return null}function bk(t){return typeof t.clone=="function"}function Pre(t){return typeof t.map=="function"&&typeof t.forEach=="function"}function Ore(t){return typeof t.notifyChange=="function"&&typeof t.watch=="function"}function yH(t){if(Object.prototype.toString.call(t)!=="[object Object]")return!1;const e=Object.getPrototypeOf(t);return e===null||e===Object.prototype}function Lre(t){if(D6(t)||Ere(t)||Mre(t)||N6(t)||$re(t)||V6(t)||Are(t)||VO(t)||zO(t))return t.slice();if(t instanceof Date)return new Date(t.getTime());if(t instanceof ArrayBuffer)return t.slice(0,t.byteLength);if(t instanceof Map){const e=new Map;for(const[i,r]of t)e.set(i,U(r));return e}if(t instanceof Set){const e=new Set;for(const i of t)e.add(U(i));return e}return null}function z6(t,e){return t===e||typeof t=="number"&&isNaN(t)&&typeof e=="number"&&isNaN(e)||typeof(t||{}).getTime=="function"&&typeof(e||{}).getTime=="function"&&t.getTime()===e.getTime()||!1}function Rre(t,e){return t===e||(t==null||typeof t=="string"?t===e:typeof t=="number"?t===e||typeof e=="number"&&isNaN(t)&&isNaN(e):t instanceof Date?e instanceof Date&&t.getTime()===e.getTime():Array.isArray(t)?Array.isArray(e)&&JT(t,e):t instanceof Set?e instanceof Set&&c1e(t,e):t instanceof Map?e instanceof Map&&u1e(t,e):!!yH(t)&&yH(e)&&l1e(t,e))}function l1e(t,e){if(t===null||e===null)return!1;const i=Object.keys(t);if(e===null||Object.keys(e).length!==i.length)return!1;for(const r of i)if(t[r]!==e[r]||!Object.prototype.hasOwnProperty.call(e,r))return!1;return!0}function c1e(t,e){if(t.size!==e.size)return!1;for(const i of t)if(!e.has(i))return!1;return!0}function u1e(t,e){if(t.size!==e.size)return!1;for(const[i,r]of t){const n=e.get(i);if(n!==r||n===void 0&&!e.has(i))return!1}return!0}function Fre(t,e,i=!1){return Nre(t,e,i)}function ZT(t,e){if(e!=null)return e[t]||Dre(t.split("."),!1,e)}function ho(t,e,i){const r=t.split("."),n=r.pop(),s=Dre(r,!0,i);s&&n&&(s[n]=e)}function Dre(t,e,i){let r=i;for(const n of t){if(r==null)return;if(!(n in r)){if(!e)return;r[n]={}}r=r[n]}return r}function Nre(t,e,i){return e?Object.keys(e).reduce((r,n)=>{let s=r[n],o=e[n];return s===o?r:s===void 0?(r[n]=U(o),r):(Array.isArray(o)||Array.isArray(r)?(s=s?Array.isArray(s)?r[n]=s.concat():r[n]=[s]:r[n]=[],o&&(Array.isArray(o)||(o=[o]),i?o.forEach(a=>{s.includes(a)||s.push(a)}):r[n]=o.concat())):o&&typeof o=="object"?r[n]=Nre(s,o,i):r.hasOwnProperty(n)&&!e.hasOwnProperty(n)||(r[n]=o),r)},t||{}):t}var vre;const Lt={analysisTheme:{accentColor:[255,127,0],textColor:"white"},apiKey:void 0,applicationName:"",applicationUrl:(vre=globalThis.location)==null?void 0:vre.href,assetsPath:"",fontsUrl:"https://static.arcgis.com/fonts",geometryServiceUrl:"https://utility.arcgisonline.com/arcgis/rest/services/Geometry/GeometryServer",geoRSSServiceUrl:"https://utility.arcgis.com/sharing/rss",kmlServiceUrl:"https://utility.arcgis.com/sharing/kml",userPrivilegesApplied:!1,portalUrl:"https://www.arcgis.com",routeServiceUrl:"https://route-api.arcgis.com/arcgis/rest/services/World/Route/NAServer/Route_World",workers:{loaderConfig:{has:{},paths:{},map:{},packages:[]}},request:{crossOriginNoCorsDomains:null,httpsDomains:["arcgis.com","arcgisonline.com","esrikr.com","premiumservices.blackbridge.com","esripremium.accuweather.com","gbm.digitalglobe.com","firstlook.digitalglobe.com","msi.digitalglobe.com"],interceptors:[],maxUrlLength:2e3,priority:"high",proxyRules:[],proxyUrl:null,timeout:6e4,trustedServers:[],useIdentity:!0},log:{interceptors:[],level:null}};if(globalThis.esriConfig&&(Fre(Lt,globalThis.esriConfig,!0),delete Lt.has),!Lt.assetsPath){{const t="4.27";Lt.assetsPath=`https://js.arcgis.com/${t}/@arcgis/core/assets`}Lt.defaultAssetsPath=Lt.assetsPath}function d(t,e,i,r){var n,s=arguments.length,o=s<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,i):r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(o=(s<3?n(o):s>3?n(e,i,o):n(e,i))||o);return s>3&&o&&Object.defineProperty(e,i,o),o}function Emt(t,e,i,r){function n(s){return s instanceof i?s:new i(function(o){o(s)})}return new(i||(i=Promise))(function(s,o){function a(u){try{c(r.next(u))}catch(h){o(h)}}function l(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?s(u.value):n(u.value).then(a,l)}c((r=r.apply(t,e||[])).next())})}const d1e="modulepreload",h1e=function(t,e){return new URL(t,e).href},vH={},W=function(e,i,r){if(!i||i.length===0)return e();const n=document.getElementsByTagName("link");return Promise.all(i.map(s=>{if(s=h1e(s,r),s in vH)return;vH[s]=!0;const o=s.endsWith(".css"),a=o?'[rel="stylesheet"]':"";if(!!r)for(let u=n.length-1;u>=0;u--){const h=n[u];if(h.href===s&&(!o||h.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${a}`))return;const c=document.createElement("link");if(c.rel=o?"stylesheet":d1e,o||(c.as="script",c.crossOrigin=""),c.href=s,document.head.appendChild(c),o)return new Promise((u,h)=>{c.addEventListener("load",u),c.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>e()).catch(s=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s})};function p1e(t){return t&&t.release&&typeof t.release=="function"}function f1e(t){return t&&t.acquire&&typeof t.acquire=="function"}let yp=class _D{constructor(e,i,r,n=1,s=0){if(this._ctor=e,this._acquireFunction=i,this._releaseFunction=r,this.allocationSize=n,this._pool=new Array(s),this._initialSize=s,this._ctor)for(let o=0;o<s;o++)this._pool[o]=new this._ctor;this.allocationSize=Math.max(n,1)}destroy(){this.prune(0)}acquire(...e){let i;if(_D.test.disabled)i=new this._ctor;else{if(this._pool.length===0){const r=this.allocationSize;for(let n=0;n<r;n++)this._pool[n]=new this._ctor}i=this._pool.pop()}return this._acquireFunction?this._acquireFunction(i,...e):f1e(i)&&i.acquire(...e),i}release(e){e&&!_D.test.disabled&&(this._releaseFunction?this._releaseFunction(e):p1e(e)&&e.release(),this._pool.push(e))}prune(e=this._initialSize){if(!(e>=this._pool.length)){for(let i=e;i<this._pool.length;++i){const r=this._pool[i];this._dispose(r)}this._pool.length=e}}_dispose(e){e.dispose&&typeof e.dispose=="function"&&e.dispose()}};yp.test={disabled:!1};function m1e(t){t.length=0}let Oo=class{constructor(e=50,i=50){this._pool=new yp(Array,void 0,m1e,i,e)}acquire(){return this._pool.acquire()}release(e){this._pool.release(e)}prune(){this._pool.prune(0)}static acquire(){return s3.acquire()}static release(e){return s3.release(e)}static prune(){s3.prune()}};const s3=new Oo(100);function $mt(t){const e=[];return function*(){yield*e;for(const i of t)e.push(i),yield i}}function g1e(t,e){for(const i of t)if(i!=null&&e(i))return i}function wk(t){return t!=null&&typeof t[Symbol.iterator]=="function"}function lt(t,e){return t!=null?e(t):null}function us(t,e){return lo(t,e),t}function lo(t,e){if(t==null)throw new Error(e??"value is None")}function je(t){return t==null||t.destroy(),null}function Amt(t){return t==null||t.dispose(),null}function $i(t){return t==null||t.remove(),null}function Qr(t){return t==null||t.abort(),null}function kmt(t){return t==null||t.release(),null}function y1e(t,e,i){return t!=null&&e!=null?i!=null?i(t,e):t.equals(e):t===e}function v1e(t){return null}function Pmt(t,e){const i=new Array;for(const r of t)i.push(r!=null?e(r):null);return i}function _1e(t,e){for(const i of t)lt(i,e)}function Omt(t){return t}let gs=class bD{constructor(){this._groups=new Map}destroy(){this.removeAll()}get size(){let e=0;return this._groups.forEach(i=>{e+=i.length}),e}add(e,i){if(wk(e)){const r=this._getOrCreateGroup(i);for(const n of e)this._isHandle(n)&&r.push(n)}else this._isHandle(e)&&this._getOrCreateGroup(i).push(e);return this}forEach(e,i){if(typeof e=="function")this._groups.forEach(r=>r.forEach(e));else{const r=this._getGroup(e);r&&i&&r.forEach(i)}}has(e){return this._groups.has(this._ensureGroupKey(e))}remove(e){if(typeof e!="string"&&wk(e)){for(const i of e)this.remove(i);return this}return this.has(e)?(this._removeAllFromGroup(this._getGroup(e)),this._groups.delete(this._ensureGroupKey(e)),this):this}removeAll(){return this._groups.forEach(e=>this._removeAllFromGroup(e)),this._groups.clear(),this}_isHandle(e){return e&&(!!e.remove||e instanceof bD)}_getOrCreateGroup(e){if(this.has(e))return this._getGroup(e);const i=[];return this._groups.set(this._ensureGroupKey(e),i),i}_getGroup(e){return this._groups.get(this._ensureGroupKey(e))}_ensureGroupKey(e){return e||"_default_"}_removeAllFromGroup(e){for(const i of e)i instanceof bD?i.removeAll():i.remove()}};const Vre=Symbol("Accessor-beforeDestroy");function kn(t){return Et(()=>t.forEach(e=>e!=null&&e.remove()))}function Et(t){return{remove:()=>{t&&(t(),t=void 0)}}}function Lmt(t){return Et(()=>{const e=t();e!=null&&e.remove()})}function b1e(t){return Et(()=>t==null?void 0:t.abort())}function Rmt(t){return Et(t!=null?()=>t.destroy():void 0)}function Vo(t){return t.__accessor__??null}function w1e(t,e){return t!=null&&t.metadatas&&t.metadatas[e]!=null}function b$(t,e,i){return i?xk(t,e,{policy:i,path:""}):xk(t,e,null)}function xk(t,e,i){return e?Object.keys(e).reduce((r,n)=>{const s=n;let o=null,a="merge";if(i&&(o=i.path?`${i.path}.${n}`:n,a=i.policy(o)),a==="replace"||a==="replace-arrays"&&Array.isArray(r[s]))return r[s]=e[s],r;if(r[s]===void 0)return r[s]=U(e[s]),r;let l=r[s],c=e[s];if(l===c)return r;if(Array.isArray(c)||Array.isArray(r))l=l?Array.isArray(l)?r[s]=l.concat():r[s]=[l]:r[s]=[],c&&(Array.isArray(c)||(c=[c]),c.forEach(u=>{l.includes(u)||l.push(u)}));else if(c&&typeof c=="object")if(i){const u=i.path;i.path=o,r[s]=xk(l,c,i),i.path=u}else r[s]=xk(l,c,null);else r.hasOwnProperty(n)&&!e.hasOwnProperty(n)||(r[s]=c);return r},t||{}):t}function zre(t){return Array.isArray(t)?t:t.split(".")}function _H(t){return t.includes(",")?t.split(",").map(e=>e.trim()):[t.trim()]}function x1e(t){if(Array.isArray(t)){const e=[];for(const i of t)e.push(..._H(i));return e}return _H(t)}function jre(t,e,i,r){const n=x1e(e);if(n.length!==1){const s=n.map(o=>r(t,o,i));return kn(s)}return r(t,n[0],i)}function Bre(t){let e=!1;return()=>{e||(e=!0,t())}}function Ure(t,e){const i=t[t.length-1]==="?"?t.slice(0,-1):t;if(e.getItemAt!=null||Array.isArray(e)){const n=parseInt(i,10);if(!isNaN(n))return Array.isArray(e)?e[n]:e.at(n)}const r=Vo(e);return w1e(r,i)?r.get(i):e[i]}function Gre(t,e,i){if(t==null)return t;const r=Ure(e[i],t);return!r&&i<e.length-1?void 0:i===e.length-1?r:Gre(r,e,i+1)}function YT(t,e,i=0){return typeof e!="string"||e.includes(".")?Gre(t,zre(e),i):Ure(e,t)}function Sk(t,e){return YT(t,e)}function bH(t,e){return YT(e,t)!==void 0}function KT(t){let e=t.constructor.__accessorMetadata__;const i=Object.prototype.hasOwnProperty.call(t.constructor,"__accessorMetadata__");if(e){if(!i){e=Object.create(e);for(const r in e)e[r]=U(e[r]);Object.defineProperty(t.constructor,"__accessorMetadata__",{value:e,enumerable:!1,configurable:!0,writable:!0})}}else e={},Object.defineProperty(t.constructor,"__accessorMetadata__",{value:e,enumerable:!1,configurable:!0,writable:!0});return t.constructor.__accessorMetadata__}function jO(t,e){const i=KT(t);let r=i[e];return r||(r=i[e]={}),r}function S1e(t,e){return b$(t,e,T1e)}const I1e=/^(?:[^.]+\.)?(?:value|type|(?:json\.type|json\.origins\.[^.]\.type))$/;function T1e(t){return I1e.test(t)?"replace":"merge"}const C1e=/\{([^\}]+)\}/g;function wH(t){return t??""}function oc(t,e){return t.replaceAll(C1e,typeof e=="object"?(i,r)=>wH(ZT(r,e)):(i,r)=>wH(e(r)))}function E1e(t,e){return t.replaceAll(/([\.$?*|{}\(\)\[\]\\\/\+\-^])/g,i=>e&&e.includes(i)?i:`\\${i}`)}function j6(t){let e=0;for(let i=0;i<t.length;i++)e=(e<<5)-e+t.charCodeAt(i),e|=0;return e}function Fmt(t){return new DOMParser().parseFromString(t||"","text/html").body.innerText||""}function NI(t,e){return new RegExp(`{${e}}`,"ig").test(t)}const xH={info:0,warn:1,error:2,none:3};let ie=class Us{constructor(e){this.level=null,this._module="",this._parent=null,this.writer=null,this._loggedMessages={error:new Map,warn:new Map,info:new Map},e.level!=null&&(this.level=e.level),e.writer!=null&&(this.writer=e.writer),this._module=e.module,Us._loggers.set(this.module,this);const i=this.module.lastIndexOf(".");i!==-1&&(this._parent=Us.getLogger(this.module.slice(0,i)))}get module(){return this._module}get parent(){return this._parent}error(...e){this._log("error","always",...e)}warn(...e){this._log("warn","always",...e)}info(...e){this._log("info","always",...e)}errorOnce(...e){this._log("error","once",...e)}warnOnce(...e){this._log("warn","once",...e)}infoOnce(...e){this._log("info","once",...e)}errorOncePerTick(...e){this._log("error","oncePerTick",...e)}warnOncePerTick(...e){this._log("warn","oncePerTick",...e)}infoOncePerTick(...e){this._log("info","oncePerTick",...e)}get test(){const e=this;return{loggedMessages:e._loggedMessages,clearLoggedWarnings:()=>e._loggedMessages.warn.clear()}}static get test(){return{resetLoggers(e=new Map){const i=Us._loggers;return Us._loggers=e,i},set throttlingDisabled(e){Us._throttlingDisabled=e}}}static getLogger(e){return e=typeof e!="string"?e.declaredClass:e,Us._loggers.get(e)||new Us({module:e})}_log(e,i,...r){if(this._matchLevel(e)){if(i!=="always"&&!Us._throttlingDisabled){const n=this._argsToKey(r),s=this._loggedMessages[e].get(n);if(i==="once"&&s!=null||i==="oncePerTick"&&s&&s>=Us._tickCounter)return;this._loggedMessages[e].set(n,Us._tickCounter),Us._scheduleTickCounterIncrement()}for(const n of Lt.log.interceptors)if(n(e,this.module,...r))return;this._inheritedWriter()(e,this.module,...r)}}_parentWithMember(e,i){let r=this;for(;r!=null;){const n=r[e];if(n!=null)return n;r=r.parent}return i}_inheritedWriter(){return this._parentWithMember("writer",this._consoleWriter)}_consoleWriter(e,i,...r){console[e](`[${i}]`,...r)}_matchLevel(e){const i=Lt.log.level||"warn";return xH[this._parentWithMember("level",i)]<=xH[e]}_argsToKey(...e){return j6(JSON.stringify(e,(r,n)=>typeof n!="object"||Array.isArray(n)?n:"[Object]"))}static _scheduleTickCounterIncrement(){Us._tickCounterScheduled||(Us._tickCounterScheduled=!0,Promise.resolve().then(()=>{Us._tickCounter++,Us._tickCounterScheduled=!1}))}};ie._loggers=new Map,ie._tickCounter=0,ie._tickCounterScheduled=!1,ie._throttlingDisabled=!1;var Hh;(function(t){t[t.INITIALIZING=0]="INITIALIZING",t[t.CONSTRUCTING=1]="CONSTRUCTING",t[t.CONSTRUCTED=2]="CONSTRUCTED"})(Hh||(Hh={}));let M1e=class{constructor(e,i){this._observers=e,this._observer=i}remove(){ww(this._observers,this._observer)}},Hre=class{constructor(){this._observers=null,this.destroyed=!1}observe(e){if(this.destroyed||e.destroyed)return $1e;this._observers==null&&(this._observers=[]);const i=this._observers;let r=!1,n=!1;const s=i.length;for(let o=0;o<s;++o){const a=i[o];if(a.destroyed)n=!0;else if(a===e){r=!0;break}}return r||(i.push(e),n&&this._removeDestroyedObservers()),new M1e(i,e)}_removeDestroyedObservers(){const e=this._observers;if(!e||e.length===0)return;const i=e.length;let r=0;for(let n=0;n<i;++n){for(;n+r<i&&e[n+r].destroyed;)++r;if(r>0){if(!(n+r<i))break;e[n]=e[n+r]}}e.length=i-r}destroy(){if(this.destroyed)return;this.destroyed=!0;const e=this._observers;if(e!=null){for(const i of e)i.onCommitted();this._observers=null}}};const $1e=Et();var Ye;(function(t){t[t.DEFAULTS=0]="DEFAULTS",t[t.COMPUTED=1]="COMPUTED",t[t.SERVICE=2]="SERVICE",t[t.PORTAL_ITEM=3]="PORTAL_ITEM",t[t.WEB_SCENE=4]="WEB_SCENE",t[t.WEB_MAP=5]="WEB_MAP",t[t.LINK_CHART=6]="LINK_CHART",t[t.USER=7]="USER"})(Ye||(Ye={}));const wD=Ye.USER+1;function Cm(t){switch(t){case"defaults":return Ye.DEFAULTS;case"service":return Ye.SERVICE;case"portal-item":return Ye.PORTAL_ITEM;case"web-scene":return Ye.WEB_SCENE;case"web-map":return Ye.WEB_MAP;case"link-chart":return Ye.LINK_CHART;case"user":return Ye.USER;default:return null}}function Ik(t){switch(t){case Ye.DEFAULTS:return"defaults";case Ye.SERVICE:return"service";case Ye.PORTAL_ITEM:return"portal-item";case Ye.WEB_SCENE:return"web-scene";case Ye.WEB_MAP:return"web-map";case Ye.LINK_CHART:return"link-chart";case Ye.USER:return"user"}return void 0}function A1e(t){return Ik(t)}var vi;(function(t){t[t.Dirty=1]="Dirty",t[t.Overriden=2]="Overriden",t[t.Computing=4]="Computing",t[t.NonNullable=8]="NonNullable",t[t.HasDefaultValue=16]="HasDefaultValue",t[t.DepTrackingInitialized=32]="DepTrackingInitialized",t[t.AutoTracked=64]="AutoTracked",t[t.ExplicitlyTracking=128]="ExplicitlyTracking"})(vi||(vi={}));const Tk={onObservableAccessed:()=>{},onTrackingEnd:()=>{}},fS=[];let B2=Tk;function Ke(t){B2.onObservableAccessed(t)}let w$=!1,x$=!1;function vp(t,e,i){if(w$)return B6(t,e,i);qre(t);const r=e.call(i);return Wre(),r}function k1e(t,e){return vp(Tk,t,e)}function B6(t,e,i){const r=w$;w$=!0,qre(t);let n=null;try{n=e.call(i)}catch(s){x$&&ie.getLogger("esri.core.accessorSupport.tracking").error(s)}return Wre(),w$=r,n}function qre(t){B2=t,fS.push(t)}function Wre(){const t=fS.length;if(t>1){const e=fS.pop();B2=fS[t-2],e.onTrackingEnd()}else if(t===1){const e=fS.pop();B2=Tk,e.onTrackingEnd()}else B2=Tk}function Jre(t,e){const i=e.observerObject;if(i.flags&vi.DepTrackingInitialized)return;const r=x$;x$=!1,i.flags&vi.AutoTracked?B6(e,e.metadata.get,t):Zre(t,e),x$=r}const P1e=[];function Zre(t,e){const i=e.observerObject;i.flags&vi.ExplicitlyTracking||(i.flags|=vi.ExplicitlyTracking,B6(e,()=>{const r=e.metadata.dependsOn||P1e;for(const n of r)if(typeof n!="string"||n.includes(".")){const s=zre(n);for(let o=0,a=t;o<s.length&&a!=null&&typeof a=="object";++o)a=SH(a,s[o],o!==s.length-1)}else SH(t,n,!1)}),i.flags&=~vi.ExplicitlyTracking)}function SH(t,e,i){const r=e[e.length-1]==="?"?e.slice(0,-1):e;if(t.getItemAt!=null||Array.isArray(t)){const s=parseInt(r,10);if(!isNaN(s))return Array.isArray(t)?t[s]:t.at(s)}const n=Vo(t);if(n){const s=n.propertiesByName.get(r);s&&(Ke(s.observerObject),Jre(t,s))}return i?t[r]:void 0}let IH=class{constructor(e,i){this.propertyName=e,this.metadata=i,this.observerObject=new O1e,this._accessed=null,this._handles=null,this.observerObject.flags=vi.Dirty|(i.nonNullable?vi.NonNullable:0)|(i.hasOwnProperty("value")?vi.HasDefaultValue:0)|(i.get===void 0?vi.DepTrackingInitialized:0)|(i.dependsOn===void 0?vi.AutoTracked:0)}destroy(){this.observerObject.destroy(),this._accessed=null,this._clearObservationHandles()}getComputed(e){const i=this.observerObject;Ke(i);const r=e.store,n=this.propertyName,s=i.flags,o=r.get(n);if(s&vi.Computing||~s&vi.Dirty&&r.has(n))return o;i.flags|=vi.Computing;const a=e.host;let l;s&vi.AutoTracked?l=vp(this,this.metadata.get,a):(Zre(a,this),l=this.metadata.get.call(a)),r.set(n,l,Ye.COMPUTED);const c=r.get(n);return c===o?i.flags&=~vi.Dirty:k1e(this.commit,this),i.flags&=~vi.Computing,c}onObservableAccessed(e){if(e===this.observerObject)return;let i=this._accessed;if(i==null)i=[],this._accessed=i;else if(i.includes(e))return;i.push(e)}onTrackingEnd(){this._clearObservationHandles();const e=this.observerObject;e.flags|=vi.DepTrackingInitialized;const i=this._accessed;if(i==null||i.length===0)return;let r=this._handles;r==null&&(r=[],this._handles=r);for(let n=0;n<i.length;++n)r.push(i[n].observe(e));i.length=0}notifyChange(){const e=this.observerObject;e.onInvalidated(),e.onCommitted()}invalidate(){this.observerObject.onInvalidated()}commit(){const e=this.observerObject;e.flags&=~vi.Dirty,e.onCommitted()}_clearObservationHandles(){const e=this._handles;if(e!==null){for(let i=0;i<e.length;++i)e[i].remove();e.length=0}}},O1e=class extends Hre{constructor(){super(...arguments),this.flags=0}onInvalidated(){~this.flags&vi.Overriden&&(this.flags|=vi.Dirty);const e=this._observers;if(e&&e.length>0)for(const i of e)i.onInvalidated()}onCommitted(){const e=this._observers;if(e&&e.length>0){const i=e.slice();for(const r of i)r.onCommitted()}}destroy(){this.flags&vi.Dirty&&this.onCommitted(),super.destroy()}},L1e=class Yre{constructor(){this._values=new Map,this.multipleOriginsSupported=!1}clone(e){const i=new Yre;return this._values.forEach((r,n)=>{e&&e.has(n)||i.set(n,U(r))}),i}get(e){return this._values.get(e)}originOf(){return Ye.USER}keys(){return[...this._values.keys()]}set(e,i){this._values.set(e,i)}delete(e){this._values.delete(e)}has(e){return this._values.has(e)}forEach(e){this._values.forEach(e)}};function cE(t,e,i){return t!==void 0}function TH(t,e,i,r){return t!==void 0&&(!(i==null&&t.observerObject.flags&vi.NonNullable)||(r.lifecycle,Hh.INITIALIZING,!1))}function R1e(t){return t&&typeof t.destroy=="function"}ie.getLogger("esri.core.accessorSupport.Properties");let F1e=class{constructor(e){this.host=e,this.propertiesByName=new Map,this.ctorArgs=null,this.destroyed=!1,this.lifecycle=Hh.INITIALIZING,this.store=new L1e,this._origin=Ye.USER;const i=this.host.constructor.__accessorMetadata__;for(const r in i){const n=new IH(r,i[r]);this.propertiesByName.set(r,n)}this.metadatas=i}initialize(){this.lifecycle=Hh.CONSTRUCTING}constructed(){this.lifecycle=Hh.CONSTRUCTED}destroy(){this.destroyed=!0;for(const[e,i]of this.propertiesByName){if(i.metadata.autoDestroy){const r=this.internalGet(e);r&&R1e(r)&&(r.destroy(),~i.observerObject.flags&vi.NonNullable&&this._internalSet(i,null))}i.destroy()}}get initialized(){return this.lifecycle!==Hh.INITIALIZING}get(e){const i=this.propertiesByName.get(e);if(i.metadata.get)return i.getComputed(this);Ke(i.observerObject);const r=this.store;return r.has(e)?r.get(e):i.metadata.value}originOf(e){const i=this.store.originOf(e);if(i===void 0){const r=this.propertiesByName.get(e);if(r!==void 0&&r.observerObject.flags&vi.HasDefaultValue)return"defaults"}return Ik(i)}has(e){return!!this.propertiesByName.has(e)&&this.store.has(e)}keys(){return[...this.propertiesByName.keys()]}internalGet(e){const i=this.propertiesByName.get(e);if(cE(i))return this.store.has(e)?this.store.get(e):i.metadata.value}internalSet(e,i){const r=this.propertiesByName.get(e);cE(r)&&this._internalSet(r,i)}getDependsInfo(e,i,r){const n=this.propertiesByName.get(i);if(!cE(n))return"";const s=new Set,o=vp({onObservableAccessed:l=>s.add(l),onTrackingEnd:()=>{}},()=>{var l;return(l=n.metadata.get)==null?void 0:l.call(e)});let a=`${r}${e.declaredClass.split(".").pop()}.${i}: ${o}
`;if(s.size===0)return a;r+="  ";for(const l of s)l instanceof IH&&(a+=`${r}${l.propertyName}: undefined
`);return a}setAtOrigin(e,i,r){const n=this.propertiesByName.get(e);if(cE(n))return this._setAtOrigin(n,i,r)}isOverridden(e){const i=this.propertiesByName.get(e);return i!==void 0&&!!(i.observerObject.flags&vi.Overriden)}clearOverride(e){const i=this.propertiesByName.get(e),r=i==null?void 0:i.observerObject;r&&r.flags&vi.Overriden&&(r.flags&=~vi.Overriden,i.notifyChange())}override(e,i){const r=this.propertiesByName.get(e);if(!TH(r,e,i,this))return;const n=r.metadata.cast;if(n){const s=this._cast(n,i),{valid:o,value:a}=s;if(o3.release(s),!o)return;i=a}r.observerObject.flags|=vi.Overriden,this._internalSet(r,i)}set(e,i){const r=this.propertiesByName.get(e);if(!TH(r,e,i,this))return;const n=r.metadata.cast;if(n){const o=this._cast(n,i),{valid:a,value:l}=o;if(o3.release(o),!a)return;i=l}const s=r.metadata.set;s?s.call(this.host,i):this._internalSet(r,i)}setDefaultOrigin(e){this._origin=Cm(e)}getDefaultOrigin(){return Ik(this._origin)}notifyChange(e){const i=this.propertiesByName.get(e);i!==void 0&&i.notifyChange()}invalidate(e){const i=this.propertiesByName.get(e);i!==void 0&&i.invalidate()}commit(e){const i=this.propertiesByName.get(e);i!==void 0&&i.commit()}_internalSet(e,i){const r=this.lifecycle!==Hh.INITIALIZING?this._origin:Ye.DEFAULTS;this._setAtOrigin(e,i,r)}_setAtOrigin(e,i,r){const n=this.store,s=e.propertyName;n.has(s,r)&&z6(i,n.get(s))&&~e.observerObject.flags&vi.Overriden&&r===n.originOf(s)||(e.invalidate(),n.set(s,i,r),e.commit(),Jre(this.host,e))}_cast(e,i){const r=o3.acquire();return r.valid=!0,r.value=i,e&&(r.value=e.call(this.host,i,r)),r}},D1e=class{constructor(){this.value=null,this.valid=!0}acquire(){this.valid=!0}release(){this.value=null}};const o3=new yp(D1e);function N1e(t,e){return t.replaceAll(/\$\{([^\s\:\}]*)(?:\:([^\s\:\}]+))?\}/g,(i,r)=>r===""?"$":(ZT(r,e)??"").toString())}let Kre=class{constructor(e,i,r){this.name=e,this.details=r,this.message=(i&&N1e(i,r))??""}toString(){return"["+this.name+"]: "+this.message}},N=class Xre extends Kre{constructor(e,i,r){super(e,i,r)}toJSON(){if(this.details!=null)try{return{name:this.name,message:this.message,details:JSON.parse(JSON.stringify(this.details,(e,i)=>{if(i&&typeof i=="object"&&typeof i.toJSON=="function")return i;try{return U(i)}catch{return"[object]"}}))}}catch(e){throw ie.getLogger("esri.core.Error").error(e),e}return{name:this.name,message:this.message,details:this.details}}static fromJSON(e){return new Xre(e.name,e.message,e.details)}};N.prototype.type="error";function Ck(t,e,i){if(t&&e)if(typeof e=="object")for(const r of Object.getOwnPropertyNames(e))Ck(t,r,e[r]);else{if(e.includes(".")){const n=e.split("."),s=n.splice(n.length-1,1)[0];return void Ck(Sk(t,n),s,i)}const r=t.__accessor__;r!=null&&V1e(e,r),t[e]=i}}function V1e(t,e){if(ee("esri-unknown-property-errors")&&!z1e(t,e))throw new N("set:unknown-property",j1e(t,e))}function z1e(t,e){return e.metadatas[t]!=null}function j1e(t,e){return"setting unknown property '"+t+"' on instance of "+e.host.declaredClass}let B1e;function U1e(){return B1e}let Qre=class extends yp{constructor(){super(...arguments),this._set=new Set}destroy(){super.destroy(),this._set=v1e(this._set)}acquire(...e){const i=super.acquire(...e);return this._set.delete(i),i}release(e){e&&!this._set.has(e)&&(super.release(e),this._set.add(e))}_dispose(e){this._set.delete(e),super._dispose(e)}};const uE=[];function Ww(t){uE.push(t),uE.length===1&&queueMicrotask(()=>{const e=uE.slice();uE.length=0;for(const i of e)i()})}let U2=class{constructor(e,i=30){this.name=e,this._counter=0,this._samples=new Array(i)}record(e){e!=null&&(this._samples[++this._counter%this._samples.length]=e)}get median(){return this._samples.slice().sort((e,i)=>e-i)[Math.floor(this._samples.length/2)]}get average(){return this._samples.reduce((e,i)=>e+i,0)/this._samples.length}get last(){return this._samples[this._counter%this._samples.length]}};var xD;(function(t){const e=(s,o,a,l)=>{let c=o,u=o;const h=a>>>1,f=s[c-1];for(;u<=h;){u=c<<1,u<a&&l(s[u-1],s[u])<0&&++u;const m=s[u-1];if(l(m,f)<=0)break;s[c-1]=m,c=u}s[c-1]=f},i=(s,o)=>s<o?-1:s>o?1:0;function r(s,o,a,l){o===void 0&&(o=0),a===void 0&&(a=s.length),l===void 0&&(l=i);for(let u=a>>>1;u>o;u--)e(s,u,a,l);const c=o+1;for(let u=a-1;u>o;u--){const h=s[o];s[o]=s[u],s[u]=h,e(s,c,u,l)}}function*n(s,o,a,l){o===void 0&&(o=0),a===void 0&&(a=s.length),l===void 0&&(l=i);for(let u=a>>>1;u>o;u--)e(s,u,a,l),yield;const c=o+1;for(let u=a-1;u>o;u--){const h=s[o];s[o]=s[u],s[u]=h,e(s,c,u,l),yield}}t.sort=r,t.iterableSort=n})(xD||(xD={}));const CH=xD,G1e=1.5,H1e=1.1;let qm=class{constructor(e){this.data=[],this._length=0,this._allocator=void 0,this._deallocator=()=>null,this._shrink=()=>{},this._hint=new Tre,e&&(e.initialSize&&(this.data=new Array(e.initialSize)),e.allocator&&(this._allocator=e.allocator),e.deallocator!==void 0&&(this._deallocator=e.deallocator),e.shrink&&(this._shrink=()=>EH(this)))}toArray(){return this.data.slice(0,this.length)}filter(e){const i=new Array;for(let r=0;r<this._length;r++){const n=this.data[r];e(n)&&i.push(n)}return i}at(e){if((e=Math.trunc(e)||0)<0&&(e+=this._length),!(e<0||e>=this._length))return this.data[e]}includes(e,i){const r=this.data.indexOf(e,i);return r!==-1&&r<this.length}get length(){return this._length}set length(e){if(e>this._length){if(this._allocator){for(;this._length<e;)this.data[this._length++]=this._allocator(this.data[this._length]);return}this._length=e}else{if(this._deallocator)for(let i=e;i<this._length;++i)this.data[i]=this._deallocator(this.data[i]);this._length=e,this._shrink()}}clear(){this.length=0}prune(){this.clear(),this.data=[]}push(e){this.data[this._length++]=e}pushArray(e,i=e.length){for(let r=0;r<i;r++)this.data[this._length++]=e[r]}fill(e,i){for(let r=0;r<i;r++)this.data[this._length++]=e}pushNew(){this._allocator&&(this.data[this.length]=this._allocator(this.data[this.length]));const e=this.data[this._length];return++this._length,e}unshift(e){this.data.unshift(e),this._length++,EH(this)}pop(){if(this.length===0)return;const e=this.data[this.length-1];return this.length=this.length-1,this._shrink(),e}remove(e){const i=yD(this.data,e,this.length,this._hint);if(i!==-1)return this.data.splice(i,1),this.length=this.length-1,e}removeUnordered(e){return this.removeUnorderedIndex(yD(this.data,e,this.length,this._hint))}removeUnorderedIndex(e){if(!(e>=this.length||e<0))return this.swapElements(e,this.length-1),this.pop()}removeUnorderedMany(e,i=e.length,r){this.length=r1e(this.data,e,this.length,i,this._hint,r),this._shrink()}front(){if(this.length!==0)return this.data[0]}back(){if(this.length!==0)return this.data[this.length-1]}swapElements(e,i){if(e>=this.length||i>=this.length||e===i)return;const r=this.data[e];this.data[e]=this.data[i],this.data[i]=r}sort(e){CH.sort(this.data,0,this.length,e)}iterableSort(e){return CH.iterableSort(this.data,0,this.length,e)}some(e,i){for(let r=0;r<this.length;++r)if(e.call(i,this.data[r],r,this.data))return!0;return!1}find(e,i){for(let r=0;r<this.length;++r){const n=this.data[r];if(e.call(i,n,r))return n}}filterInPlace(e,i){let r=0;for(let n=0;n<this._length;++n){const s=this.data[n];e.call(i,s,n,this.data)&&(this.data[n]=this.data[r],this.data[r]=s,r++)}if(this._deallocator)for(let n=r;n<this._length;n++)this.data[n]=this._deallocator(this.data[n]);return this._length=r,this._shrink(),this}forAll(e,i){const r=this.length,n=this.data;for(let s=0;s<r;++s)e.call(i,n[s],s,n)}forEach(e,i){for(let r=0;r<this.length;++r)e.call(i,this.data[r],r,this.data)}map(e,i){const r=new Array(this.length);for(let n=0;n<this.length;++n)r[n]=e.call(i,this.data[n],n,this.data);return r}reduce(e,i){let r=i;for(let n=0;n<this.length;++n)r=e(r,this.data[n],n,this.data);return r}has(e){const i=this.length,r=this.data;for(let n=0;n<i;++n)if(r[n]===e)return!0;return!1}};function EH(t){t.data.length>G1e*t.length&&(t.data.length=Math.floor(t.length*H1e))}function q1e(t){return{setTimeout:(e,i)=>{const r=t.setTimeout(e,i);return{remove:()=>t.clearTimeout(r)}}}}const P1=q1e(globalThis);function BO(t){return t&&(typeof t.on=="function"||typeof t.addEventListener=="function")}function Wh(t,e,i){if(!BO(t))throw new TypeError("target is not a Evented or EventTarget object");if("on"in t)return t.on(e,i);if(Array.isArray(e)){const r=e.slice();for(const n of r)t.addEventListener(n,i);return{remove(){for(const n of r)t.removeEventListener(n,i)}}}return t.addEventListener(e,i),{remove(){t.removeEventListener(e,i)}}}function ene(t,e,i){if(!BO(t))throw new TypeError("target is not a Evented or EventTarget object");if("once"in t)return t.once(e,i);const r=Wh(t,e,n=>{r.remove(),i.call(t,n)});return{remove(){r.remove()}}}const W1e={Win:"Meta",Scroll:"ScrollLock",Spacebar:" ",Down:"ArrowDown",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Del:"Delete",Apps:"ContextMenu",Esc:"Escape",Multiply:"*",Add:"+",Subtract:"-",Decimal:".",Divide:"/"};function ip({key:t}){return W1e[t]||t}function wi(t="Aborted"){return new N("AbortError",t)}function _t(t,e="Aborted"){if(zo(t))throw wi(e)}function UO(t){return t!=null?"aborted"in t?t:t.signal:t}function zo(t){const e=UO(t);return e!=null&&e.aborted}function Lo(t){if(ys(t))throw t}function Ek(t){if(!ys(t))throw t}function Fo(t,e){const i=UO(t);if(i!=null){if(!i.aborted)return ene(i,"abort",()=>e());e()}}function U6(t,e){const i=UO(t);if(i!=null)return _t(i),ene(i,"abort",()=>e(wi()))}function gu(t,e){return UO(e)==null?t:new Promise((i,r)=>{let n=Fo(e,()=>r(wi()));const s=()=>n=$i(n);t.then(s,s),t.then(i,r)})}function ys(t){return(t==null?void 0:t.name)==="AbortError"}async function $d(t){try{return await t}catch(e){if(!ys(e))throw e;return}}async function br(t){if(!t)return;if(typeof t.forEach!="function"){const i=Object.keys(t),r=i.map(o=>t[o]),n=await br(r),s={};return i.map((o,a)=>s[o]=n[a]),s}const e=t;return Promise.allSettled(e).then(i=>Array.from(e,(r,n)=>{const s=i[n];return s.status==="fulfilled"?{promise:r,value:s.value}:{promise:r,error:s.reason}}))}async function tne(t){return(await br(t)).filter(e=>!!e.value).map(e=>e.value)}function XT(t,e=void 0,i){const r=new AbortController;return Fo(i,()=>r.abort()),new Promise((n,s)=>{let o=setTimeout(()=>{o=0,n(e)},t);Fo(r,()=>{o&&(clearTimeout(o),s(wi()))})})}function Tp(t){return t&&typeof t.then=="function"}function SD(t){return Tp(t)?t:Promise.resolve(t)}function Ad(t,e=-1){let i,r,n,s,o=null;const a=(...l)=>{if(i){r=l,s&&s.reject(wi()),s=Ta();const f=s.promise;if(o){const m=o;o=null,m.abort()}return f}if(n=s||Ta(),s=null,e>0){const f=new AbortController;i=SD(t(...l,f.signal));const m=i;XT(e).then(()=>{i===m&&(s?f.abort():o=f)})}else i=1,i=SD(t(...l));const c=()=>{const f=r;r=n=i=o=null,f!=null&&a(...f)},u=i,h=n;return u.then(c,c),u.then(h.resolve,h.reject),h.promise};return a}function Ta(){let t,e;const i=new Promise((n,s)=>{t=n,e=s}),r=n=>{t(n)};return r.resolve=n=>t(n),r.reject=n=>e(n),r.timeout=(n,s)=>P1.setTimeout(()=>r.reject(s),n),r.promise=i,r}async function MH(t){await Promise.resolve(),_t(t)}function Wmt(t){return t}function Jmt(t){return .001*t}function Zmt(){return performance.now()}let J1e=class{constructor(e){this.phases=e,this.paused=!1,this.ticks=-1,this.removed=!1}},Z1e=class{constructor(e){this.callback=e,this.isActive=!0}remove(){this.isActive=!1}},ID=0;const mx={time:0,deltaTime:0,elapsedFrameTime:0,frameDuration:0},TD=["prepare","preRender","render","postRender","update","finish"],CD=[],yv=new qm;let Y1e=class{constructor(e){this._task=e}remove(){this._task.removed=!0}pause(){this._task.paused=!0}resume(){this._task.paused=!1}};const Mk={frameTasks:yv,willDispatch:!1,clearFrameTasks:K1e,dispatch:nne,executeFrameTasks:X1e};function O1(t){const e=new Z1e(t);return CD.push(e),Mk.willDispatch||(Mk.willDispatch=!0,Ww(nne)),e}function Jw(t){const e=new J1e(t);return yv.push(e),$k==null&&(ID=performance.now(),$k=requestAnimationFrame(ine)),new Y1e(e)}let $k=null;function K1e(t=!1){yv.forAll(e=>{e.removed=!0}),t&&rne()}function ine(){const t=performance.now();$k=null,$k=yv.length>0?requestAnimationFrame(ine):null,Mk.executeFrameTasks(t)}function X1e(t){const e=t-ID;ID=t;const i=1e3/60,r=Math.max(0,e-i);mx.time=t,mx.frameDuration=i-r;for(let n=0;n<TD.length;n++){const s=performance.now(),o=TD[n];yv.forAll(a=>{var l;a.paused||a.removed||(n===0&&a.ticks++,a.phases[o]&&(mx.elapsedFrameTime=performance.now()-t,mx.deltaTime=a.ticks===0?0:e,(l=a.phases[o])==null||l.call(a,mx)))}),exe[n].record(performance.now()-s)}rne(),txe.record(performance.now()-t)}const dE=new qm;function rne(){yv.forAll(t=>{t.removed&&dE.push(t)}),yv.removeUnorderedMany(dE.data,dE.length),dE.clear()}function nne(){for(;CD.length;){const t=CD.shift();t.isActive&&t.callback()}Mk.willDispatch=!1}function Q1e(t=1,e){const i=Ta(),r=()=>{zo(e)?i.reject(wi()):t===0?i():(--t,Ww(()=>r()))};return r(),i.promise}const exe=TD.map(t=>new U2(t)),txe=new U2("total");function ixe(t,e){for(const i of t.entries())if(e(i[0]))return!0;return!1}function rxe(t,e){const i=new Set;return t!=null&&t.forEach(r=>i.add(r)),e!=null&&e.forEach(r=>i.add(r)),i}let nxe=0;function X0(){return++nxe}let GO=class{constructor(e){this._accessed=[],this._handles=[],this._observerObject=new sxe(e),$H.register(this,new WeakRef(this._observerObject),this)}destroy(){var e;$H.unregister(this._observerObject),this._accessed.length=0,(e=this._observerObject)==null||e.destroy(),this.clear()}onObservableAccessed(e){const i=this._accessed;i.includes(e)||i.push(e)}onTrackingEnd(){const e=this._handles,i=this._accessed,r=this._observerObject;for(let n=0;n<i.length;++n)e.push(i[n].observe(r));i.length=0}clear(){const e=this._handles;for(let i=0;i<e.length;++i)e[i].remove();e.length=0}},sxe=class{constructor(e){this._notify=e,this._invalidCount=0,this.destroyed=!1}onInvalidated(){this._invalidCount++}onCommitted(){if(this.destroyed)return;const e=this._invalidCount;if(e===1)return this._invalidCount=0,void this._notify();this._invalidCount=e>0?e-1:0}destroy(){this.destroyed=!0,this._notify=oxe}};const $H=new FinalizationRegistry(t=>{var e;(e=t.deref())==null||e.destroy()});function oxe(){}let xw=!1;const Ak=[];function sne(t,e){let i=new GO(s),r=null,n=!1;function s(){if(!i||n)return;if(xw)return void ane(s);const a=r;i.clear(),xw=!0,n=!0,r=vp(i,t),n=!1,xw=!1,e(r,a),lne()}function o(){i&&(i.destroy(),i=null,r=null)}return n=!0,r=vp(i,t),n=!1,{remove:o}}function one(t,e){let i=new GO(n),r=null;function n(){e(r,o)}function s(){i&&(i.destroy(),i=null),r=null}function o(){return i?(i.clear(),r=vp(i,t),r):null}return o(),{remove:s}}function G6(t){let e=new GO(r),i=!1;function r(){e&&!i&&(xw?ane(r):(e.clear(),xw=!0,i=!0,vp(e,t),i=!1,xw=!1,lne()))}function n(){e&&(e.destroy(),e=null)}return i=!0,vp(e,t),i=!1,{remove:n}}function ane(t){Ak.includes(t)||Ak.unshift(t)}function lne(){for(;Ak.length;)Ak.pop()()}var G2;(function(t){t[t.Untracked=0]="Untracked",t[t.Tracked=1]="Tracked"})(G2||(G2={}));let VI=class{constructor(){this.uid=X0(),this.removed=!1,this.type=null,this.oldValue=null,this.callback=null,this.getValue=null,this.target=null,this.path=null,this.equals=null}static acquireUntracked(e,i,r,n,s){return this.pool.acquire(G2.Untracked,e,i,r,n,s,z6)}static acquireTracked(e,i,r,n){return this.pool.acquire(G2.Tracked,e,i,r,null,null,n)}notify(e,i){this.type===G2.Untracked?this.callback.call(this.target,e,i,this.path,this.target):this.callback.call(null,e,i,void 0,void 0)}acquire(e,i,r,n,s,o,a){this.uid=X0(),this.removed=!1,this.type=e,this.oldValue=i,this.callback=r,this.getValue=n,this.target=s,this.path=o,this.equals=a}release(){this.target=this.path=this.oldValue=this.callback=this.getValue=null,this.uid=X0(),this.removed=!0}};VI.pool=new Qre(VI);const S$=new Oo,rp=new Set;let kk;function Pk(t){rp.delete(t),rp.add(t),kk||(kk=O1(cxe))}function axe(t){if(t.removed)return;const e=t.oldValue,i=t.getValue();t.equals(e,i)||(t.oldValue=i,t.notify(i,e))}function lxe(t){for(const e of rp.values())e.target===t&&(e.removed=!0)}function cxe(){let t=10;for(;kk&&t--;){kk=null;const e=uxe(),i=S$.acquire();for(const r of e){const n=r.uid;axe(r),n===r.uid&&r.removed&&i.push(r)}for(const r of rp)r.removed&&(i.push(r),rp.delete(r));for(const r of i)VI.pool.release(r);S$.release(i),S$.release(e),ED.forEach(r=>r())}}function uxe(){const t=S$.acquire();t.length=rp.size;let e=0;for(const i of rp)t[e]=i,++e;return rp.clear(),t}const ED=new Set;function dxe(t){return ED.add(t),{remove(){ED.delete(t)}}}function hxe(t,e,i){let r=jre(t,e,i,(n,s,o)=>{let a,l,c=one(()=>YT(n,s),(u,h)=>{n.__accessor__.destroyed||a&&a.uid!==l?r.remove():(a||(a=VI.acquireUntracked(u,o,h,n,s),l=a.uid),Pk(a))});return{remove:Bre(()=>{c.remove(),a&&(a.uid!==l||a.removed||(a.removed=!0,Pk(a)),a=null),r=c=null})}});return r}function pxe(t,e,i){const r=jre(t,e,i,(n,s,o)=>{let a=!1;return sne(()=>YT(n,s),(l,c)=>{n.__accessor__.destroyed?r.remove():a||(a=!0,z6(c,l)||o.call(n,l,c,s,n),a=!1)})});return r}function fxe(t,e,i,r=!1){return!t.__accessor__||t.__accessor__.destroyed?{remove(){}}:r?pxe(t,e,i):hxe(t,e,i)}function mxe(t,e,i){let r,n,s=one(t,(o,a)=>{r&&r.uid!==n?s.remove():(r||(r=VI.acquireTracked(o,e,a,i),n=r.uid),Pk(r))});return{remove:Bre(()=>{s.remove(),r&&(r.uid!==n||r.removed||(r.removed=!0,Pk(r)),r=null),s=null})}}function gxe(t,e,i){let r=!1;return sne(t,(n,s)=>{r||(r=!0,i(s,n)||e(n,s),r=!1)})}function yxe(t,e,i=!1,r=Rre){return i?gxe(t,e,r):mxe(t,e,r)}function AH(t){return ixe(rp,e=>e.oldValue===t)}function QT(t,e){for(const[i,r]of t)if(e(r,i))return!0;return!1}function igt(t,e){for(const[i,r]of t)if(e(r,i))return r;return null}function rw(t,e,i){const r=t.get(e);if(r!==void 0)return r;const n=i();return t.set(e,n),n}const Sw=ie.getLogger("esri.core.accessorSupport.ensureTypes");function vxe(t){return t==null?t:new Date(t)}function _xe(t){return t==null?t:!!t}function eC(t){return t==null?t:t.toString()}function ql(t){return t==null?t:(t=parseFloat(t),isNaN(t)?0:t)}function H6(t){return t==null?t:Math.round(parseFloat(t))}function cne(t){return t&&t.constructor&&t.constructor.__accessorMetadata__!==void 0}function Ok(t,e){return e!=null&&t&&!(e instanceof t)}function une(t){return t&&"isCollection"in t}function kH(t){return t&&t.Type?typeof t.Type=="function"?t.Type:t.Type.base:null}function bxe(t,e){if(!e||!e.constructor||!une(e.constructor))return MD(t,e)?e:new t(e);const i=kH(t.prototype.itemType),r=kH(e.constructor.prototype.itemType);return i?r?i===r?e:i.prototype.isPrototypeOf(r.prototype)?new t(e):(MD(t,e),e):new t(e):e}function MD(t,e){return!!cne(e)&&(Sw.error("Accessor#set","Assigning an instance of '"+(e.declaredClass||"unknown")+"' which is not a subclass of '"+HO(t)+"'"),!0)}function jv(t,e){return e==null?e:une(t)?bxe(t,e):Ok(t,e)?MD(t,e)?e:new t(e):e}function HO(t){return t&&t.prototype&&t.prototype.declaredClass||"unknown"}const wxe=new WeakMap;function xxe(t){switch(t){case Number:return ql;case wt:return H6;case Boolean:return _xe;case String:return eC;case Date:return vxe;default:return rw(wxe,t,()=>jv.bind(null,t))}}function lr(t,e){const i=xxe(t);return arguments.length===1?i:i(e)}function zI(t,e,i){return arguments.length===1?zI.bind(null,t):e&&(Array.isArray(e)?e.map(r=>t(r,i)):[t(e,i)])}function Sxe(t,e){return arguments.length===1?zI(i=>lr(t,i)):zI(i=>lr(t,i),e)}function dne(t,e,i){return e!==0&&Array.isArray(i)?i.map(r=>dne(t,e-1,r)):t(i)}function Lk(t,e,i){if(arguments.length===2)return s=>Lk(t,e,s);if(!i)return i;i=dne(t,e,i);let r=e,n=i;for(;r>0&&Array.isArray(n);)r--,n=n[0];if(n!==void 0)for(let s=0;s<r;s++)i=[i];return i}function Ixe(t,e,i){return arguments.length===2?Lk(r=>lr(t,r),e):Lk(r=>lr(t,r),e,i)}function hne(t){return!!Array.isArray(t)&&!t.some(e=>{const i=typeof e;return!(i==="string"||i==="number"||i==="function"&&t.length>1)})}function $D(t,e){if(arguments.length===2)return $D(t).call(null,e);const i=new Set,r=t.filter(a=>typeof a!="function"),n=t.filter(a=>typeof a=="function");for(const a of t)typeof a!="string"&&typeof a!="number"||i.add(a);let s=null,o=null;return(a,l)=>{if(a==null)return a;const c=typeof a,u=c==="string"||c==="number";return u&&(i.has(a)||n.some(h=>c==="string"&&h===String||c==="number"&&h===Number))||c==="object"&&n.some(h=>!Ok(a,h))?a:(u&&r.length?(s||(s=r.map(h=>typeof h=="string"?`'${h}'`:`${h}`).join(", ")),Sw.error("Accessor#set",`'${a}' is not a valid value for this property, only the following values are valid: ${s}`)):typeof a=="object"&&n.length?(o||(o=n.map(h=>HO(h)).join(", ")),Sw.error("Accessor#set",`'${a}' is not a valid value for this property, value must be one of ${o}`)):Sw.error("Accessor#set",`'${a}' is not a valid value for this property`),l&&(l.valid=!1),null)}}function Dd(t,e){if(arguments.length===2)return Dd(t).call(null,e);const i={},r=[],n=[];for(const l in t.typeMap){const c=t.typeMap[l];i[l]=lr(c),r.push(HO(c)),n.push(l)}const s=()=>`'${r.join("', '")}'`,o=()=>`'${n.join("', '")}'`,a=typeof t.key=="string"?l=>l[t.key]:t.key;return l=>{if(t.base&&!Ok(t.base,l)||l==null)return l;const c=a(l)||t.defaultKeyValue,u=i[c];if(!u)return Sw.error("Accessor#set",`Invalid property value, value needs to be one of ${s()}, or a plain object that can autocast (having .type = ${o()})`),null;if(!Ok(t.typeMap[c],l))return l;if(typeof t.key=="string"&&!cne(l)){const h={};for(const f in l)f!==t.key&&(h[f]=l[f]);return u(h)}return u(l)}}let wt=class{};const gx={native:t=>({type:"native",value:t}),array:t=>({type:"array",value:t}),oneOf:t=>({type:"one-of",values:t})};function Txe(t){if(!t||!("type"in t))return!1;switch(t.type){case"native":case"array":case"one-of":return!0}return!1}function pne(t){switch(t.type){case"native":return lr(t.value);case"array":return zI(pne(t.value));case"one-of":return Cxe(t);default:return null}}function Cxe(t){let e=null;return(i,r)=>kD(i,t)?i:(e==null&&(e=AD(t)),Sw.error("Accessor#set",`Invalid property value, value needs to be of type ${e}`),r&&(r.valid=!1),null)}function AD(t){switch(t.type){case"native":switch(t.value){case Number:return"number";case String:return"string";case Boolean:return"boolean";case wt:return"integer";case Date:return"date";default:return HO(t.value)}case"array":return`array of ${AD(t.value)}`;case"one-of":{const e=t.values.map(i=>AD(i));return`one of ${e.slice(0,e.length-1)} or ${e[e.length-1]}`}}return"unknown"}function kD(t,e){if(t==null)return!0;switch(e.type){case"native":switch(e.value){case Number:case wt:return typeof t=="number";case Boolean:return typeof t=="boolean";case String:return typeof t=="string"}return t instanceof e.value;case"array":return!!Array.isArray(t)&&!t.some(i=>!kD(i,e.value));case"one-of":return e.values.some(i=>kD(t,i))}}function p(t={}){return(e,i)=>{if(e===Function.prototype)throw new Error(`Inappropriate use of @property() on a static field: ${e.name}.${i}. Accessor does not support static properties.`);const r=Object.getOwnPropertyDescriptor(e,i),n=jO(e,i);r&&(r.get||r.set?(n.get=r.get||n.get,n.set=r.set||n.set):"value"in r&&("value"in t&&ie.getLogger("esri.core.accessorSupport.decorators.property").warn(`@property() will redefine the value of "${i}" on "${e.constructor.name}" already defined in the metadata`,t),n.value=t.value=r.value)),t.readOnly!=null&&(n.readOnly=t.readOnly);const s=t.aliasOf;if(s){const l=typeof s=="string"?s:s.source,c=typeof s=="string"?null:s.overridable===!0;let u;n.dependsOn=[l],n.get=function(){let h=Sk(this,l);if(typeof h=="function"){u||(u=l.split(".").slice(0,-1).join("."));const f=Sk(this,u);f&&(h=h.bind(f))}return h},n.readOnly||(n.set=c?function(h){this._override(i,h)}:function(h){Ck(this,l,h)})}const o=t.type,a=t.types;n.cast||(o?n.cast=Exe(o):a&&(Array.isArray(a)?n.cast=zI(Dd(a[0])):n.cast=Dd(a))),S1e(n,t),t.range&&(n.cast=Mxe(n.cast,t.range))}}function fne(t,e,i){const r=jO(t,i);r.json||(r.json={});let n=r.json;return e!==void 0&&(n.origins||(n.origins={}),n.origins[e]||(n.origins[e]={}),n=n.origins[e]),n}function Exe(t){let e=0,i=t;if(Txe(t))return pne(t);for(;Array.isArray(i)&&i.length===1&&typeof i[0]!="string"&&typeof i[0]!="number";)i=i[0],e++;const r=i;if(hne(r))return e===0?$D(r):Lk($D(r),e);if(e===1)return Sxe(r);if(e>1)return Ixe(r,e);const n=t;return n.from?n.from:lr(n)}function Mxe(t,e){return i=>{let r=+t(i);return e.step!=null&&(r=Math.round(r/e.step)*e.step),e.min!=null&&(r=Math.max(e.min,r)),e.max!=null&&(r=Math.min(e.max,r)),r}}function $xe(t){if(t.json&&t.json.origins){const e=t.json.origins,i={"web-document":["web-scene","web-map"]};for(const r in i)if(e[r]){const n=e[r];i[r].forEach(s=>{e[s]=n}),delete e[r]}}}let ol=class extends Kre{constructor(e,i,r){super(e,i,r)}};ol.prototype.type="warning";function mne(t){return!!t&&t.prototype&&t.prototype.declaredClass&&t.prototype.declaredClass.indexOf("esri.core.Collection")===0}const PD=ie.getLogger("esri.core.accessorSupport.extensions.serializableProperty.reader");function PH(t,e,i){var r,n;t&&(!i&&!e.read||(r=e.read)!=null&&r.reader||((n=e.read)==null?void 0:n.enabled)===!1||Pxe(t)&&ho("read.reader",L1(t),e))}function L1(t){var i,r;const e=t.ndimArray??0;if(e>1)return kxe(t);if(e===1)return OH(t);if("type"in t&&yne(t.type)){const n=(r=(i=t.type.prototype)==null?void 0:i.itemType)==null?void 0:r.Type,s=OH(typeof n=="function"?{type:n}:{types:n});return(o,a,l)=>{const c=s(o,a,l);return c&&new t.type(c)}}return q6(t)}function q6(t){return"type"in t?Axe(t.type):Oxe(t.types)}function Axe(t){return t.prototype.read?(e,i,r)=>{if(e==null)return e;const n=typeof e;if(n!=="object")return void PD.error(`Expected JSON value of type 'object' to deserialize type '${t.prototype.declaredClass}', but got '${n}'`);const s=new t;return s.read(e,r),s}:t.fromJSON}function gne(t,e,i,r){return r!==0&&Array.isArray(e)?e.map(n=>gne(t,n,i,r-1)):t(e,void 0,i)}function kxe(t){const e=q6(t),i=gne.bind(null,e),r=t.ndimArray??0;return(n,s,o)=>{if(n==null)return n;n=i(n,o,r);let a=r,l=n;for(;a>0&&Array.isArray(l);)a--,l=l[0];if(l!==void 0)for(let c=0;c<a;c++)n=[n];return n}}function OH(t){const e=q6(t);return(i,r,n)=>{if(i==null)return i;if(Array.isArray(i)){const o=[];for(const a of i){const l=e(a,void 0,n);l!==void 0&&o.push(l)}return o}const s=e(i,void 0,n);return s!==void 0?[s]:void 0}}function yne(t){if(!mne(t))return!1;const e=t.prototype.itemType;return!(!e||!e.Type)&&(typeof e.Type=="function"?W6(e.Type):vne(e.Type))}function Pxe(t){return"types"in t?vne(t.types):W6(t.type)}function W6(t){return!Array.isArray(t)&&!!t&&t.prototype&&("read"in t.prototype||"fromJSON"in t||yne(t))}function vne(t){for(const e in t.typeMap)if(!W6(t.typeMap[e]))return!1;return!0}function Oxe(t){let e=null;const i=t.errorContext??"type";return(r,n,s)=>{if(r==null)return r;const o=typeof r;if(o!=="object")return void PD.error(`Expected JSON value of type 'object' to deserialize, but got '${o}'`);e||(e=Lxe(t));const a=t.key;if(typeof a!="string")return;const l=r[a],c=l?e[l]:t.defaultKeyValue?t.typeMap[t.defaultKeyValue]:void 0;if(!c){const h=`Type '${l||"unknown"}' is not supported`;return s&&s.messages&&r&&s.messages.push(new ol(`${i}:unsupported`,h,{definition:r,context:s})),void PD.error(h)}const u=new c;return u.read(r,s),u}}function Lxe(t){var i,r;const e={};for(const n in t.typeMap){const s=t.typeMap[n],o=KT(s.prototype);if(typeof t.key=="function")continue;const a=o[t.key];if(!a)continue;(i=a.json)!=null&&i.type&&Array.isArray(a.json.type)&&a.json.type.length===1&&typeof a.json.type[0]=="string"&&(e[a.json.type[0]]=s);const l=(r=a.json)==null?void 0:r.write;if(!l||!l.writer){e[n]=s;continue}const c=l.target,u=typeof c=="string"?c:t.key,h={};l.writer(n,h,u),h[u]&&(e[h[u]]=s)}return e}function Rxe(t){if(t.json||(t.json={}),RH(t.json),FH(t.json),LH(t.json),t.json.origins)for(const e in t.json.origins)RH(t.json.origins[e]),FH(t.json.origins[e]),LH(t.json.origins[e]);return!0}function LH(t){t.name&&(t.read&&typeof t.read=="object"?t.read.source===void 0&&(t.read.source=t.name):t.read={source:t.name},t.write&&typeof t.write=="object"?t.write.target===void 0&&(t.write.target=t.name):t.write={target:t.name})}function RH(t){typeof t.read=="boolean"?t.read={enabled:t.read}:typeof t.read=="function"?t.read={enabled:!0,reader:t.read}:t.read&&typeof t.read=="object"&&t.read.enabled===void 0&&(t.read.enabled=!0)}function FH(t){typeof t.write=="boolean"?t.write={enabled:t.write}:typeof t.write=="function"?t.write={enabled:!0,writer:t.write}:t.write&&typeof t.write=="object"&&t.write.enabled===void 0&&(t.write.enabled=!0)}function DH(t,e){if(!e.write||e.write.writer||e.write.enabled===!1&&!e.write.overridePolicy)return;const i=(t==null?void 0:t.ndimArray)??0;t&&(i===1||"type"in t&&mne(t.type))?e.write.writer=Nxe:i>1?e.write.writer=Vxe(i):e.types?Array.isArray(e.types)?e.write.writer=Dxe(e.types[0]):e.write.writer=Fxe(e.types):e.write.writer=jI}function Fxe(t){return(e,i,r,n)=>e?_ne(e,t,n)?jI(e,i,r,n):void 0:jI(e,i,r,n)}function _ne(t,e,i){for(const r in e.typeMap)if(t instanceof e.typeMap[r])return!0;if(i!=null&&i.messages){const r=e.errorContext??"type",n=`Values of type '${(typeof e.key!="function"?t[e.key]:t.declaredClass)??"Unknown"}' cannot be written`;i&&i.messages&&t&&i.messages.push(new N(`${r}:unsupported`,n,{definition:t,context:i})),ie.getLogger("esri.core.accessorSupport.extensions.serializableProperty.writer").error(n)}return!1}function Dxe(t){return(e,i,r,n)=>!e||!Array.isArray(e)?jI(e,i,r,n):jI(e.filter(s=>_ne(s,t,n)),i,r,n)}function jI(t,e,i,r){ho(i,Rk(t,r),e)}function Rk(t,e){return t&&typeof t.write=="function"?t.write({},e):t&&typeof t.toJSON=="function"?t.toJSON():typeof t=="number"?Fk(t):t}function Fk(t){return t===-1/0?-Number.MAX_VALUE:t===1/0?Number.MAX_VALUE:isNaN(t)?null:t}function Nxe(t,e,i,r){let n;t===null?n=null:t&&typeof t.map=="function"?(n=t.map(s=>Rk(s,r)),typeof n.toArray=="function"&&(n=n.toArray())):n=[Rk(t,r)],ho(i,n,e)}function bne(t,e,i){return i!==0&&Array.isArray(t)?t.map(r=>bne(r,e,i-1)):Rk(t,e)}function Vxe(t){return(e,i,r,n)=>{let s;if(e===null)s=null;else{s=bne(e,n,t);let o=t,a=s;for(;o>0&&Array.isArray(a);)o--,a=a[0];if(a!==void 0)for(let l=0;l<o;l++)s=[s]}ho(r,s,i)}}function zxe(t,e){return J6(t,"any",e==null?void 0:e.origin)}function OD(t,e){return J6(t,"read",e==null?void 0:e.origin)}function wne(t,e){return J6(t,"write",e==null?void 0:e.origin)}function J6(t,e,i){let r=t==null?void 0:t.json;if(r!=null&&r.origins&&i){let n;n=i==="link-chart"?r.origins[i]&&(e==="any"||e in r.origins[i])?r.origins[i]:r.origins["web-map"]:r.origins[i],n&&(e==="any"||e in n)&&(r=n)}return r}function jxe(t){const e=Bxe(t);if(t.json.origins)for(const i in t.json.origins){const r=t.json.origins[i],n=r.types?Uxe(r):e;PH(n,r,!1),r.types&&!r.write&&t.json.write&&t.json.write.enabled&&(r.write={...t.json.write}),DH(n,r)}PH(e,t.json,!0),DH(e,t.json)}function Bxe(t){return t.json.types?LD(t.json):t.type?xne(t):LD(t)}function Uxe(t){return t.type?xne(t):LD(t)}function xne(t){if(!t.type)return;let e=0,i=t.type;for(;Array.isArray(i)&&!hne(i);)i=i[0],e++;return{type:i,ndimArray:e}}function LD(t){if(!t.types)return;let e=0,i=t.types;for(;Array.isArray(i);)i=i[0],e++;return{types:i,ndimArray:e}}function Gxe(t){Rxe(t)&&($xe(t),jxe(t))}const a3=new Set,l3=new Set;function A(t){return e=>{e.prototype.declaredClass=t,qxe(e);const i=[],r=[];let n=e.prototype;for(;n;)n.hasOwnProperty("initialize")&&!a3.has(n.initialize)&&(a3.add(n.initialize),i.push(n.initialize)),n.hasOwnProperty("destroy")&&!l3.has(n.destroy)&&(l3.add(n.destroy),r.push(n.destroy)),n=Object.getPrototypeOf(n);a3.clear(),l3.clear();class s extends e{constructor(...a){if(super(...a),this.constructor===s&&typeof this.postscript=="function"){if(i.length&&Object.defineProperty(this,"initialize",{enumerable:!1,configurable:!0,value(){for(let l=i.length-1;l>=0;l--)i[l].call(this)}}),r.length){let l=!1;const c=this[Vre];Object.defineProperty(this,"destroy",{enumerable:!1,configurable:!0,value(){if(!l){l=!0,c.call(this);for(let u=0;u<r.length;u++)r[u].call(this)}}})}this.postscript(...a)}}}return s.__accessorMetadata__=KT(e.prototype),s.prototype.declaredClass=t,s}}function Hxe(t,e){return e.get==null?function(){const i=this.__accessor__,r=i.propertiesByName.get(t);if(r===void 0)return;Ke(r.observerObject);const n=i.store;return n.has(t)?n.get(t):r.metadata.value}:function(){const i=this.__accessor__,r=i.propertiesByName.get(t);if(r!==void 0)return r.getComputed(i)}}function qxe(t){const e=t.prototype,i=KT(e),r={};for(const n of Object.getOwnPropertyNames(i)){const s=i[n];Gxe(s),r[n]={enumerable:!0,configurable:!0,get:Hxe(n,s),set(o){const a=this.__accessor__;if(a!==void 0){if(!Object.isFrozen(this)){if(a.initialized&&s.readOnly)throw new TypeError(`[accessor] cannot assign to read-only property '${n}' of ${this.declaredClass}`);if(a.lifecycle===Hh.CONSTRUCTED&&s.constructOnly)throw new TypeError(`[accessor] cannot assign to construct-only property '${n}' of ${this.declaredClass}`);a.set(n,o)}}else Object.defineProperty(this,n,{enumerable:!0,configurable:!0,writable:!0,value:o})}}}Object.defineProperties(t.prototype,r)}var Sne,Ine;function Wxe(t){var e;if(t==null)return{value:t};if(Array.isArray(t))return{type:[t[0]],value:null};switch(typeof t){case"object":return(e=t.constructor)!=null&&e.__accessorMetadata__||t instanceof Date?{type:t.constructor,value:t}:t;case"boolean":return{type:Boolean,value:t};case"string":return{type:String,value:t};case"number":return{type:Number,value:t};case"function":return{type:t,value:null};default:return}}const uf=Symbol("Accessor-Handles"),RD=Symbol("Accessor-Initialized");let he=class Tne{static createSubclass(e={}){if(Array.isArray(e))throw new Error("Multi-inheritance unsupported since 4.16");const{properties:i,declaredClass:r,constructor:n}=e;delete e.declaredClass,delete e.properties,delete e.constructor;const s=this;class o extends s{constructor(...l){super(...l),this.inherited=null,n&&n.apply(this,l)}}KT(o.prototype);for(const a in e){const l=e[a];o.prototype[a]=typeof l=="function"?function(...c){const u=this.inherited;let h;this.inherited=function(...f){if(s.prototype[a])return s.prototype[a].apply(this,f)};try{h=l.apply(this,c)}catch(f){throw this.inherited=u,f}return this.inherited=u,h}:e[a]}for(const a in i){const l=Wxe(i[a]);p(l)(o.prototype,a)}return A(r)(o)}constructor(...e){if(this[Sne]=null,this[Ine]=!1,this.constructor===Tne)throw new Error("[accessor] cannot instantiate Accessor. This can be fixed by creating a subclass of Accessor");const i=new F1e(this);Object.defineProperty(this,"__accessor__",{enumerable:!1,value:i}),e.length>0&&this.normalizeCtorArgs&&(i.ctorArgs=this.normalizeCtorArgs.apply(this,e)),NH.register(this,i.propertiesByName,this)}postscript(e){const i=this.__accessor__,r=i.ctorArgs||e;i.initialize(),r&&(this.set(r),i.ctorArgs=null),i.constructed(),this.initialize(),this[RD]=!0}initialize(){}[Vre](){this[uf]=je(this[uf])}destroy(){var e;this.destroyed||(NH.unregister(this),lxe(this),this.__accessor__.destroy(),(e=U1e())==null||e.onInstanceDestroy(this))}get constructed(){return this.__accessor__&&this.__accessor__.initialized||!1}get initialized(){return this[RD]}get destroyed(){return this.__accessor__&&this.__accessor__.destroyed||!1}commitProperty(e){this.get(e)}get(e){return Sk(this,e)}hasOwnProperty(e){return this.__accessor__?this.__accessor__.has(e):Object.prototype.hasOwnProperty.call(this,e)}keys(){return this.__accessor__?this.__accessor__.keys():[]}set(e,i){return Ck(this,e,i),this}watch(e,i,r){return fxe(this,e,i,r)}own(e){this.addHandles(e)}addHandles(e,i){if(this.destroyed){const n=Array.isArray(e)?e:[e];for(const s of n)s.remove();return}let r=this[uf];r==null&&(r=this[uf]=new gs),r.add(e,i)}removeHandles(e){const i=this[uf];i!=null&&i.remove(e)}removeAllHandles(){const e=this[uf];e!=null&&e.removeAll()}hasHandles(e){const i=this[uf];return i!=null&&i.has(e)}_override(e,i){i===void 0?this.__accessor__.clearOverride(e):this.__accessor__.override(e,i)}_clearOverride(e){return this.__accessor__.clearOverride(e)}_overrideIfSome(e,i){i==null?this.__accessor__.clearOverride(e):this.__accessor__.override(e,i)}_isOverridden(e){return this.__accessor__.isOverridden(e)}notifyChange(e){this.__accessor__.notifyChange(e)}_get(e){return this.__accessor__.internalGet(e)}_set(e,i){return this.__accessor__.internalSet(e,i),this}};Sne=uf,Ine=RD;const NH=new FinalizationRegistry(t=>{for(const e of t.values())e.destroy()});let I$=class Cne{constructor(){this._emitter=new Cne.EventEmitter(this)}emit(e,i){return this._emitter.emit(e,i)}on(e,i){return this._emitter.on(e,i)}once(e,i){return this._emitter.once(e,i)}hasEventListener(e){return this._emitter.hasEventListener(e)}};(function(t){class e{constructor(n=null){this._target=n,this._listenersMap=null}clear(){var n;(n=this._listenersMap)==null||n.clear(),this._listenersMap=null}destroy(){this.clear()}emit(n,s){const o=this._listenersMap&&this._listenersMap.get(n);if(!o)return!1;const a=this._target||this;return[...o].forEach(l=>{l.call(a,s)}),o.length>0}on(n,s){if(Array.isArray(n)){const a=n.map(l=>this.on(l,s));return kn(a)}if(n.includes(","))throw new TypeError("Evented.on() with a comma delimited string of event types is not supported");this._listenersMap||(this._listenersMap=new Map);const o=this._listenersMap.get(n)||[];return o.push(s),this._listenersMap.set(n,o),{remove:()=>{const a=this._listenersMap&&this._listenersMap.get(n)||[],l=a.indexOf(s);l>=0&&a.splice(l,1)}}}once(n,s){const o=this.on(n,a=>{o.remove(),s.call(null,a)});return o}hasEventListener(n){const s=this._listenersMap&&this._listenersMap.get(n);return s!=null&&s.length>0}}t.EventEmitter=e,t.EventedMixin=r=>{let n=class extends r{constructor(){super(...arguments),this._emitter=new e}destroy(){this._emitter.clear()}emit(s,o){return this._emitter.emit(s,o)}on(s,o){return this._emitter.on(s,o)}once(s,o){return this._emitter.once(s,o)}hasEventListener(s){return this._emitter.hasEventListener(s)}};return n=d([A("esri.core.Evented")],n),n};let i=class extends he{constructor(){super(...arguments),this._emitter=new I$.EventEmitter(this)}destroy(){this._emitter.clear()}emit(r,n){return this._emitter.emit(r,n)}on(r,n){return this._emitter.on(r,n)}once(r,n){return this._emitter.once(r,n)}hasEventListener(r){return this._emitter.hasEventListener(r)}};i=d([A("esri.core.Evented")],i),t.EventedAccessor=i})(I$||(I$={}));const an=I$;var li;(function(t){t[t.ADD=1]="ADD",t[t.REMOVE=2]="REMOVE",t[t.MOVE=4]="MOVE"})(li||(li={}));function Z6(t){return(e,i)=>{e[i]=t}}let qO=class extends Hre{notify(){const e=this._observers;if(e&&e.length>0){const i=e.slice();for(const r of i)r.onInvalidated(),r.onCommitted()}}};var jh;let Jxe=class{constructor(){this.target=null,this.cancellable=!1,this.defaultPrevented=!1,this.item=void 0,this.type=void 0}preventDefault(){this.cancellable&&(this.defaultPrevented=!0)}reset(e){this.defaultPrevented=!1,this.item=e}};const pl=new yp(Jxe,void 0,t=>{t.item=null,t.target=null,t.defaultPrevented=!1,t.cancellable=!1}),Zxe=()=>{};function c3(t){return t?t instanceof I0?t.toArray():t.length?Array.prototype.slice.apply(t):[]:[]}function u3(t){if(t&&t.length)return t[0]}function Yxe(t,e,i,r){const n=Math.min(t.length-i,e.length-r);let s=0;for(;s<n&&t[i+s]===e[r+s];)s++;return s}function Ene(t,e,i,r){e&&e.forEach((n,s,o)=>{t.push(n),Ene(t,i.call(r,n,s,o),i,r)})}const Bp=new Set,Up=new Set,Gp=new Set,d3=new Map;let Kxe=0,I0=jh=class extends an.EventedAccessor{static isCollection(t){return t!=null&&t instanceof jh}constructor(t){super(t),this._chgListeners=[],this._notifications=null,this._timer=null,this._observable=new qO,this.length=0,this._items=[],Object.defineProperty(this,"uid",{value:Kxe++})}normalizeCtorArgs(t){return t?Array.isArray(t)||t instanceof jh?{items:t}:t:{}}destroy(){this._removeAllRaw()}*[Symbol.iterator](){yield*this.items}get items(){return Ke(this._observable),this._items}set items(t){this._emitBeforeChanges(li.ADD)||(this._splice(0,this.length,c3(t)),this._emitAfterChanges(li.ADD))}hasEventListener(t){return t==="change"?this._chgListeners.length>0:this._emitter.hasEventListener(t)}on(t,e){if(t==="change"){const i=this._chgListeners,r={removed:!1,callback:e};return i.push(r),this._notifications&&this._notifications.push({listeners:i.slice(),items:this._items.slice(),changes:[]}),{remove(){this.remove=Zxe,r.removed=!0,i.splice(i.indexOf(r),1)}}}return this._emitter.on(t,e)}once(t,e){const i=this.on(t,e);return{remove(){i.remove()}}}add(t,e){if(Ke(this._observable),this._emitBeforeChanges(li.ADD))return this;const i=this.getNextIndex(e??null);return this._splice(i,0,[t]),this._emitAfterChanges(li.ADD),this}addMany(t,e=this._items.length){if(Ke(this._observable),!t||!t.length)return this;if(this._emitBeforeChanges(li.ADD))return this;const i=this.getNextIndex(e);return this._splice(i,0,c3(t)),this._emitAfterChanges(li.ADD),this}at(t){if(Ke(this._observable),(t=Math.trunc(t)||0)<0&&(t+=this.length),!(t<0||t>=this.length))return this._items[t]}removeAll(){if(Ke(this._observable),!this.length||this._emitBeforeChanges(li.REMOVE))return[];const t=this._removeAllRaw();return this._emitAfterChanges(li.REMOVE),t}_removeAllRaw(){return this.length===0?[]:this._splice(0,this.length)||[]}clone(){return Ke(this._observable),this._createNewInstance({items:this._items.map(U)})}concat(...t){Ke(this._observable);const e=t.map(c3);return this._createNewInstance({items:this._items.concat(...e)})}drain(t,e){if(Ke(this._observable),!this.length||this._emitBeforeChanges(li.REMOVE))return;const i=this._splice(0,this.length),r=i.length;for(let n=0;n<r;n++)t.call(e,i[n],n,i);this._emitAfterChanges(li.REMOVE)}every(t,e){return Ke(this._observable),this._items.every(t,e)}filter(t,e){let i;return Ke(this._observable),i=arguments.length===2?this._items.filter(t,e):this._items.filter(t),this._createNewInstance({items:i})}find(t,e){return Ke(this._observable),this._items.find(t,e)}findIndex(t,e){return Ke(this._observable),this._items.findIndex(t,e)}flatten(t,e){Ke(this._observable);const i=[];return Ene(i,this,t,e),new jh(i)}forEach(t,e){return Ke(this._observable),this._items.forEach(t,e)}getItemAt(t){return Ke(this._observable),this._items[t]}getNextIndex(t){Ke(this._observable);const e=this.length;return(t=t??e)<0?t=0:t>e&&(t=e),t}includes(t,e=0){return Ke(this._observable),this._items.includes(t,e)}indexOf(t,e=0){return Ke(this._observable),this._items.indexOf(t,e)}join(t=","){return Ke(this._observable),this._items.join(t)}lastIndexOf(t,e=this.length-1){return Ke(this._observable),this._items.lastIndexOf(t,e)}map(t,e){Ke(this._observable);const i=this._items.map(t,e);return new jh({items:i})}reorder(t,e=this.length-1){Ke(this._observable);const i=this.indexOf(t);if(i!==-1){if(e<0?e=0:e>=this.length&&(e=this.length-1),i!==e){if(this._emitBeforeChanges(li.MOVE))return t;this._splice(i,1),this._splice(e,0,[t]),this._emitAfterChanges(li.MOVE)}return t}}pop(){if(Ke(this._observable),!this.length||this._emitBeforeChanges(li.REMOVE))return;const t=u3(this._splice(this.length-1,1));return this._emitAfterChanges(li.REMOVE),t}push(...t){return Ke(this._observable),this._emitBeforeChanges(li.ADD)||(this._splice(this.length,0,t),this._emitAfterChanges(li.ADD)),this.length}reduce(t,e){Ke(this._observable);const i=this._items;return arguments.length===2?i.reduce(t,e):i.reduce(t)}reduceRight(t,e){Ke(this._observable);const i=this._items;return arguments.length===2?i.reduceRight(t,e):i.reduceRight(t)}remove(t){return Ke(this._observable),this.removeAt(this.indexOf(t))}removeAt(t){if(Ke(this._observable),t<0||t>=this.length||this._emitBeforeChanges(li.REMOVE))return;const e=u3(this._splice(t,1));return this._emitAfterChanges(li.REMOVE),e}removeMany(t){if(Ke(this._observable),!t||!t.length||this._emitBeforeChanges(li.REMOVE))return[];const e=t instanceof jh?t.toArray():t,i=this._items,r=[],n=e.length;for(let s=0;s<n;s++){const o=e[s],a=i.indexOf(o);if(a>-1){const l=1+Yxe(e,i,s+1,a+1),c=this._splice(a,l);c&&c.length>0&&r.push.apply(r,c),s+=l-1}}return this._emitAfterChanges(li.REMOVE),r}reverse(){if(Ke(this._observable),this._emitBeforeChanges(li.MOVE))return this;const t=this._splice(0,this.length);return t&&(t.reverse(),this._splice(0,0,t)),this._emitAfterChanges(li.MOVE),this}shift(){if(Ke(this._observable),!this.length||this._emitBeforeChanges(li.REMOVE))return;const t=u3(this._splice(0,1));return this._emitAfterChanges(li.REMOVE),t}slice(t=0,e=this.length){return Ke(this._observable),this._createNewInstance({items:this._items.slice(t,e)})}some(t,e){return Ke(this._observable),this._items.some(t,e)}sort(t){if(Ke(this._observable),!this.length||this._emitBeforeChanges(li.MOVE))return this;const e=this._splice(0,this.length);return arguments.length?e.sort(t):e.sort(),this._splice(0,0,e),this._emitAfterChanges(li.MOVE),this}splice(t,e,...i){Ke(this._observable);const r=(e?li.REMOVE:0)|(i.length?li.ADD:0);if(this._emitBeforeChanges(r))return[];const n=this._splice(t,e,i)||[];return this._emitAfterChanges(r),n}toArray(){return Ke(this._observable),this._items.slice()}toJSON(){return Ke(this._observable),this.toArray()}toLocaleString(){return Ke(this._observable),this._items.toLocaleString()}toString(){return Ke(this._observable),this._items.toString()}unshift(...t){return Ke(this._observable),!t.length||this._emitBeforeChanges(li.ADD)||(this._splice(0,0,t),this._emitAfterChanges(li.ADD)),this.length}_createNewInstance(t){return new this.constructor(t)}_splice(t,e,i){const r=this._items,n=this.itemType;let s,o;if(!this._notifications&&this.hasEventListener("change")&&(this._notifications=[{listeners:this._chgListeners.slice(),items:this._items.slice(),changes:[]}],this._timer&&this._timer.remove(),this._timer=O1(()=>this._dispatchChange())),e){if(o=r.splice(t,e),this.hasEventListener("before-remove")){const a=pl.acquire();a.target=this,a.cancellable=!0;for(let l=0,c=o.length;l<c;l++)s=o[l],a.reset(s),this.emit("before-remove",a),a.defaultPrevented&&(o.splice(l,1),r.splice(t,0,s),t+=1,l-=1,c-=1);pl.release(a)}if(this.length=this._items.length,this.hasEventListener("after-remove")){const a=pl.acquire();a.target=this,a.cancellable=!1;const l=o.length;for(let c=0;c<l;c++)a.reset(o[c]),this.emit("after-remove",a);pl.release(a)}}if(i&&i.length){if(n){const u=[];for(const h of i){const f=n.ensureType(h);f==null&&h!=null||u.push(f)}i=u}const a=this.hasEventListener("before-add"),l=this.hasEventListener("after-add"),c=t===this.length;if(a||l){const u=pl.acquire();u.target=this,u.cancellable=!0;const h=pl.acquire();h.target=this,h.cancellable=!1;for(const f of i)a?(u.reset(f),this.emit("before-add",u),u.defaultPrevented||(c?r.push(f):r.splice(t++,0,f),this._set("length",r.length),l&&(h.reset(f),this.emit("after-add",h)))):(c?r.push(f):r.splice(t++,0,f),this._set("length",r.length),h.reset(f),this.emit("after-add",h));pl.release(h),pl.release(u)}else{if(c)for(const u of i)r.push(u);else r.splice(t,0,...i);this._set("length",r.length)}}return(i&&i.length||o&&o.length)&&this._notifyChangeEvent(i,o),o}_emitBeforeChanges(t){let e=!1;if(this.hasEventListener("before-changes")){const i=pl.acquire();i.target=this,i.cancellable=!0,i.type=t,this.emit("before-changes",i),e=i.defaultPrevented,pl.release(i)}return e}_emitAfterChanges(t){if(this.hasEventListener("after-changes")){const e=pl.acquire();e.target=this,e.cancellable=!1,e.type=t,this.emit("after-changes",e),pl.release(e)}this._observable.notify()}_notifyChangeEvent(t,e){this.hasEventListener("change")&&this._notifications&&this._notifications[this._notifications.length-1].changes.push({added:t,removed:e})}_dispatchChange(){if(this._timer&&(this._timer.remove(),this._timer=null),!this._notifications)return;const t=this._notifications;this._notifications=null;for(const e of t){const i=e.changes;Bp.clear(),Up.clear(),Gp.clear();for(const{added:l,removed:c}of i){if(l)if(Gp.size===0&&Up.size===0)for(const u of l)Bp.add(u);else for(const u of l)Up.has(u)?(Gp.add(u),Up.delete(u)):Gp.has(u)||Bp.add(u);if(c)if(Gp.size===0&&Bp.size===0)for(const u of c)Up.add(u);else for(const u of c)Bp.has(u)?Bp.delete(u):(Gp.delete(u),Up.add(u))}const r=Oo.acquire();Bp.forEach(l=>{r.push(l)});const n=Oo.acquire();Up.forEach(l=>{n.push(l)});const s=this._items,o=e.items,a=Oo.acquire();if(Gp.forEach(l=>{o.indexOf(l)!==s.indexOf(l)&&a.push(l)}),e.listeners&&(r.length||n.length||a.length)){const l={target:this,added:r,removed:n,moved:a},c=e.listeners.length;for(let u=0;u<c;u++){const h=e.listeners[u];h.removed||h.callback.call(this,l)}}Oo.release(r),Oo.release(n),Oo.release(a)}Bp.clear(),Up.clear(),Gp.clear()}};I0.ofType=t=>{if(!t)return jh;if(d3.has(t))return d3.get(t);let e=null;if(typeof t=="function")e=t.prototype.declaredClass;else if(t.base)e=t.base.prototype.declaredClass;else for(const r in t.typeMap){const n=t.typeMap[r].prototype.declaredClass;e?e+=` | ${n}`:e=n}let i=class extends jh{};return d([Z6({Type:t,ensureType:typeof t=="function"?lr(t):Dd(t)})],i.prototype,"itemType",void 0),i=d([A(`esri.core.Collection<${e}>`)],i),d3.set(t,i),i},d([p()],I0.prototype,"length",void 0),d([p()],I0.prototype,"items",null),I0=jh=d([A("esri.core.Collection")],I0);const ye=I0;function rg(t,e,i=ye){return e||(e=new i),e===t||(e.removeAll(),Xxe(t)?e.addMany(t):t&&e.add(t)),e}function Mne(t){return t}function Xxe(t){return t&&(Array.isArray(t)||"items"in t&&Array.isArray(t.items))}const VH=new Set;function Qxe(t,e,i=!1){i&&VH.has(e)||(i&&VH.add(e),t.warn(`🛑 DEPRECATED - ${e}`))}function zH(t,e,i={}){if(ee("esri-deprecation-warnings")){const{moduleName:r}=i;_p(t,`Function: ${(r?r+"::":"")+e+"()"}`,i)}}function el(t,e,i={}){if(ee("esri-deprecation-warnings")){const{moduleName:r}=i;_p(t,`Property: ${(r?r+"::":"")+e}`,i)}}function _p(t,e,i={}){if(ee("esri-deprecation-warnings")){const{replacement:r,version:n,see:s,warnOnce:o}=i;let a=e;r&&(a+=`
	🛠️ Replacement: ${r}`),n&&(a+=`
	⚙️ Version: ${n}`),s&&(a+=`
	🔗 See ${s} for more details.`),Qxe(t,a,o)}}let eSe=class $ne{constructor(){this._values=new Map,this.multipleOriginsSupported=!1}clone(e){const i=new $ne;return this._values.forEach((r,n)=>{e&&e.has(n)||i.set(n,U(r.value),r.origin)}),i}get(e,i){i=this._normalizeOrigin(i);const r=this._values.get(e);return i==null||(r==null?void 0:r.origin)===i?r==null?void 0:r.value:void 0}originOf(e){var i;return((i=this._values.get(e))==null?void 0:i.origin)??Ye.USER}keys(e){e=this._normalizeOrigin(e);const i=[...this._values.keys()];return e==null?i:i.filter(r=>{var n;return((n=this._values.get(r))==null?void 0:n.origin)===e})}set(e,i,r){if((r=this._normalizeOrigin(r))===Ye.DEFAULTS){const n=this._values.get(e);if(n&&n.origin!=null&&n.origin>r)return}this._values.set(e,new tSe(i,r))}delete(e,i){var r;(i=this._normalizeOrigin(i))!=null&&((r=this._values.get(e))==null?void 0:r.origin)!==i||this._values.delete(e)}has(e,i){var r;return(i=this._normalizeOrigin(i))!=null?((r=this._values.get(e))==null?void 0:r.origin)===i:this._values.has(e)}forEach(e){this._values.forEach(({value:i},r)=>e(i,r))}_normalizeOrigin(e){if(e!=null)return e===Ye.DEFAULTS?e:Ye.USER}},tSe=class{constructor(e,i){this.value=e,this.origin=i}};function Ane(t,e,i){e.keys().forEach(n=>{i.set(n,e.get(n),Ye.DEFAULTS)});const r=t.metadatas;Object.keys(r).forEach(n=>{t.internalGet(n)&&i.set(n,t.internalGet(n),Ye.DEFAULTS)})}function iSe(t,e,i){if(!t||!t.read||t.read.enabled===!1||!t.read.source)return!1;const r=t.read.source;if(typeof r=="string"){if(r===e||r.includes(".")&&r.indexOf(e)===0&&bH(r,i))return!0}else for(const n of r)if(n===e||n.includes(".")&&n.indexOf(e)===0&&bH(n,i))return!0;return!1}function rSe(t){return t&&(!t.read||t.read.enabled!==!1&&!t.read.source)}function nSe(t,e,i,r,n){let s=OD(e[i],n);rSe(s)&&(t[i]=!0);for(const o of Object.getOwnPropertyNames(e))s=OD(e[o],n),iSe(s,i,r)&&(t[o]=!0)}function sSe(t,e,i,r){const n=i.metadatas,s=zxe(n[e],r),o=s==null?void 0:s.default;if(o===void 0)return;const a=typeof o=="function"?o.call(t,e,r):o;a!==void 0&&i.set(e,a)}const kne={origin:"service"};function Pne(t,e,i=kne){if(!e||typeof e!="object")return;const r=Vo(t),n=r.metadatas,s={};for(const o of Object.getOwnPropertyNames(e))nSe(s,n,o,e,i);r.setDefaultOrigin(i.origin);for(const o of Object.getOwnPropertyNames(s)){const a=OD(n[o],i).read,l=a&&a.source;let c;c=l&&typeof l=="string"?YT(e,l):e[o],a&&a.reader&&(c=a.reader.call(t,c,e,i)),c!==void 0&&r.set(o,c)}if(!i||!i.ignoreDefaults){r.setDefaultOrigin("defaults");for(const o of Object.getOwnPropertyNames(n))s[o]||sSe(t,o,r,i)}r.setDefaultOrigin("user")}function oSe(t,e,i,r=kne){var s;const n={...r,messages:[]};i(n),(s=n.messages)==null||s.forEach(o=>{o.type!=="warning"||t.loaded?r&&r.messages&&r.messages.push(o):t.loadWarnings.push(o)})}function aSe(t,e,i,r,n){var o,a;const s={};return(a=(o=e.write)==null?void 0:o.writer)==null||a.call(t,r,s,i,n),s}function One(t,e,i,r,n,s){if(!r||!r.write)return!1;const o=t.get(i);if(!n&&r.write.overridePolicy){const a=r.write.overridePolicy.call(t,o,i,s??void 0);a!==void 0&&(n=a)}if(n||(n=r.write),!n||n.enabled===!1)return!1;if((o===null&&!n.allowNull&&!n.writerEnsuresNonNull||o===void 0)&&n.isRequired){const a=new N("web-document-write:property-required",`Missing value for required property '${i}' on '${t.declaredClass}'`,{propertyName:i,target:t});return a&&s&&s.messages?s.messages.push(a):a&&!s&&ie.getLogger("esri.core.accessorSupport.write").error(a.name,a.message),!1}return!(o===void 0||o===null&&!n.allowNull&&!n.writerEnsuresNonNull||!n.alwaysWriteDefaults&&(!e.store.multipleOriginsSupported||e.store.originOf(i)===Ye.DEFAULTS)&&lSe(t,i,s,r,o)||!n.ignoreOrigin&&s&&s.origin&&e.store.multipleOriginsSupported&&e.store.originOf(i)<Cm(s.origin))}function lSe(t,e,i,r,n){const s=r.default;if(s===void 0)return!1;if(r.defaultEquals!=null)return r.defaultEquals(n);if(typeof s=="function"){if(Array.isArray(n)){const o=s.call(t,e,i??void 0);return JT(o,n)}return!1}return s===n}function cSe(t,e,i,r){const n=Vo(t),s=n.metadatas,o=wne(s[e],r);return!!o&&One(t,n,e,o,i,r)}function Lne(t,e,i){var s,o;if(t&&typeof t.toJSON=="function"&&(!t.toJSON.isDefaultToJSON||!t.write))return b$(e,t.toJSON(i));const r=Vo(t),n=r.metadatas;for(const a in n){const l=wne(n[a],i);if(!One(t,r,a,l,void 0,i))continue;const c=t.get(a),u=aSe(t,l,l.write&&typeof l.write.target=="string"?l.write.target:a,c,i);Object.keys(u).length>0&&(e=b$(e,u),(o=(s=i==null?void 0:i.resources)==null?void 0:s.pendingOperations)!=null&&o.length&&i.resources.pendingOperations.push(Promise.all(i.resources.pendingOperations).then(()=>b$(e,u,()=>"replace-arrays"))),i&&i.writtenProperties&&i.writtenProperties.push({target:t,propName:a,oldOrigin:A1e(r.store.originOf(a)),newOrigin:i.origin}))}return e}const R1=t=>{let e=class extends t{constructor(...i){super(...i);const r=Vo(this),n=r.store,s=new eSe;r.store=s,Ane(r,n,s)}read(i,r){Pne(this,i,r)}write(i,r){return Lne(this,i??{},r)}toJSON(i){return this.write({},i)}static fromJSON(i,r){return uSe.call(this,i,r)}};return e=d([A("esri.core.JSONSupport")],e),e.prototype.toJSON.isDefaultToJSON=!0,e};function uSe(t,e){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");const i=new this;return i.read(t,e),i}let te=class extends R1(he){};te=d([A("esri.core.JSONSupport")],te);var lm;(function(t){t[t.PENDING=0]="PENDING",t[t.RESOLVED=1]="RESOLVED",t[t.REJECTED=2]="REJECTED"})(lm||(lm={}));let dSe=class{constructor(){this._resolver=Ta(),this._status=lm.PENDING,this._resolvingPromises=[],this._resolver.promise.then(()=>{this._status=lm.RESOLVED,this._cleanUp()},()=>{this._status=lm.REJECTED,this._cleanUp()}),this.promise=this._resolver.promise}destroy(){this._cleanUp()}addResolvingPromise(e){this._resolvingPromises.push(e),this._tryResolve()}isResolved(){return this._status===lm.RESOLVED}isRejected(){return this._status===lm.REJECTED}isFulfilled(){return this._status!==lm.PENDING}abort(){this._resolver.reject(wi())}_cleanUp(){this._allPromise=null,this._resolvingPromises=null}_tryResolve(){if(this.isFulfilled())return;const e=Ta(),i=[...this._resolvingPromises,e.promise],r=this._allPromise=Promise.all(i);r.then(()=>{this.isFulfilled()||this._allPromise!==r||this._resolver.resolve()},n=>{this.isFulfilled()||this._allPromise!==r||ys(n)||this._resolver.reject(n)}),e.resolve()}};const F1=t=>{let e=class extends t{constructor(...i){super(...i),this._promiseProps=new dSe,this.addResolvingPromise(Promise.resolve())}destroy(){var i;(i=this._promiseProps)==null||i.destroy()}isResolved(){return this._promiseProps.isResolved()}isRejected(){return this._promiseProps.isRejected()}isFulfilled(){return this._promiseProps.isFulfilled()}when(i,r){return this._promiseProps.promise.then(()=>this).then(i,r)}catch(i){return this.when(null,i)}addResolvingPromise(i){i&&!this._promiseProps.isFulfilled()&&this._promiseProps.addResolvingPromise("_promiseProps"in i?i.when():i)}};return e=d([A("esri.core.Promise")],e),e};let Dk=class extends F1(he){};Dk=d([A("esri.core.Promise")],Dk);const hSe="not-loaded",pSe="loading",fSe="failed",jH="loaded",Rne=t=>{let e=class extends t{constructor(...i){super(...i),this._loadController=null,this.loadError=null,this.loadStatus="not-loaded",this._set("loadWarnings",[]),this.addResolvingPromise(new Promise(r=>{const n=this.load.bind(this);this.load=s=>{const o=new Promise((a,l)=>{const c=U6(s,l);this.destroyed&&l(new N("load:instance-destroyed",`Instance of '${this.declaredClass||this.constructor.name}' is already destroyed`,{instance:this})),this.when(a,l).finally(()=>{c&&c.remove()})});if(this.loadStatus===hSe){this._set("loadStatus",pSe);const a=this._loadController=new AbortController;n({signal:a.signal}),Fo(a.signal,()=>{this._promiseProps.abort()})}return r(),o}})),this.when(()=>{this._set("loadStatus",jH),this._loadController=null},r=>{this._set("loadStatus",fSe),this._set("loadError",r),this._loadController=null})}destroy(){this._loadController=Qr(this._loadController),this._set("loadError",null),this._set("loadWarnings",[])}get loaded(){return this.loadStatus===jH}get loadWarnings(){return this._get("loadWarnings")}load(){return null}cancelLoad(){var i;return this.isFulfilled()||(this._set("loadError",new N("load:cancelled","Cancelled")),(i=this._loadController)==null||i.abort()),this}};return d([p({readOnly:!0})],e.prototype,"loaded",null),d([p({readOnly:!0})],e.prototype,"loadError",void 0),d([p({clonable:!1})],e.prototype,"loadStatus",void 0),d([p({type:[ol],readOnly:!0})],e.prototype,"loadWarnings",null),e=d([A("esri.core.Loadable")],e),e};let mS=class extends Rne(Dk){};mS=d([A("esri.core.Loadable")],mS),function(t){function e(i){return!(!i||!i.load)}t.LoadableMixin=Rne,t.isLoadable=e}(mS||(mS={}));const Su=mS;function mSe(t,e,i){return br(t.map((r,n)=>e.apply(i,[r,n])))}async function gSe(t,e,i){return(await br(t.map((r,n)=>e.apply(i,[r,n])))).map(r=>r.value)}function Y6(t){return{ok:!0,value:t}}function K6(t){return{ok:!1,error:t}}function ySe(t){return t!=null&&t.ok===!0?t.value:null}function vSe(t){return t!=null&&t.ok===!1?t.error:null}async function tC(t){if(t==null)return{ok:!1,error:new Error("no promise provided")};try{return Y6(await t)}catch(e){return K6(e)}}async function hgt(t){try{return Y6(await t)}catch(e){return Lo(e),K6(e)}}function Cp(t,e){return new df(t,e)}let df=class extends he{get value(){return ySe(this._result)}get error(){return vSe(this._result)}get finished(){return this._result!=null}constructor(e,i){super({}),this._result=null,this._abortHandle=null,this.abort=()=>{this._abortController=Qr(this._abortController)},this.remove=this.abort,this._abortController=new AbortController;const{signal:r}=this._abortController;this.promise=e(r),this.promise.then(n=>{this._result=Y6(n),this._cleanup()},n=>{this._result=K6(n),this._cleanup()}),this._abortHandle=Fo(i,this.abort)}normalizeCtorArgs(){return{}}destroy(){this.abort()}_cleanup(){this._abortHandle=$i(this._abortHandle),this._abortController=null}};d([p()],df.prototype,"value",null),d([p()],df.prototype,"error",null),d([p()],df.prototype,"finished",null),d([p()],df.prototype,"promise",void 0),d([p()],df.prototype,"_result",void 0),df=d([A("esri.core.asyncUtils.ReactiveTask")],df);async function Fne(t,e){return await t.load(),_Se(t,e)}async function _Se(t,e){const i=[],r=(...s)=>{for(const o of s)o!=null&&(Array.isArray(o)?r(...o):ye.isCollection(o)?o.forEach(a=>r(a)):Su.isLoadable(o)&&i.push(o))};e(r);let n=null;if(await gSe(i,async s=>{const o=await tC(bSe(s)?s.loadAll():s.load());o.ok!==!1||n||(n=o)}),n)throw n.error;return t}function bSe(t){return"loadAll"in t&&typeof t.loadAll=="function"}const wSe=/^https:\/\/([a-z\d-]+)(\.maps([^.]*))?\.arcgis\.com/i,xSe={devext:{customBaseUrl:"mapsdevext.arcgis.com",portalHostname:"devext.arcgis.com"},qaext:{customBaseUrl:"mapsqa.arcgis.com",portalHostname:"qaext.arcgis.com"},www:{customBaseUrl:"maps.arcgis.com",portalHostname:"www.arcgis.com"}};function FD(t){const e=t==null?void 0:t.match(wSe);if(!e)return null;const[,i,r,n]=e;if(!i)return null;let s=null,o=null,a=null;const{devext:l,qaext:c,www:u}=xSe;if(r)if(s=i,n)switch(n.toLowerCase()){case"devext":({customBaseUrl:o,portalHostname:a}=l);break;case"qa":({customBaseUrl:o,portalHostname:a}=c);break;default:return null}else({customBaseUrl:o,portalHostname:a}=u);else switch(i.toLowerCase()){case"devext":({customBaseUrl:o,portalHostname:a}=l);break;case"qaext":({customBaseUrl:o,portalHostname:a}=c);break;case"www":({customBaseUrl:o,portalHostname:a}=u);break;default:return null}return{customBaseUrl:o,isPortal:!1,portalHostname:a,urlKey:s}}function SSe(t){return/\/(sharing|usrsvcs)\/(appservices|servers)\//i.test(t)}function ISe(t){const e=atob(t),i=new Uint8Array(e.length);for(let r=0;r<e.length;r++)i[r]=e.charCodeAt(r);return i.buffer}const TSe=ie.getLogger("esri.core.urlUtils"),D1=Lt.request,BH="esri/config: esriConfig.request.proxyUrl is not set.",Dne=/^\s*[a-z][a-z0-9-+.]*:(?![0-9])/i,Nne=/^\s*http:/i,CSe=/^\s*https:/i,ESe=/^\s*file:/i,MSe=/:\d+$/,$Se=/^https?:\/\/[^/]+\.arcgis.com\/sharing(\/|$)/i,ASe=new RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?$"),kSe=new RegExp("^((([^\\[:]+):)?([^@]+)@)?(\\[([^\\]]+)\\]|([^\\[:]*))(:([0-9]+))?$");let Iw=class{constructor(e=""){this.uri=e,this.scheme=null,this.authority=null,this.path=null,this.query=null,this.fragment=null,this.user=null,this.password=null,this.host=null,this.port=null;let i=this.uri.match(ASe);this.scheme=i[2]||(i[1]?"":null),this.authority=i[4]||(i[3]?"":null),this.path=i[5],this.query=i[7]||(i[6]?"":null),this.fragment=i[9]||(i[8]?"":null),this.authority!=null&&(i=this.authority.match(kSe),this.user=i[3]||null,this.password=i[4]||null,this.host=i[6]||i[7],this.port=i[9]||null)}toString(){return this.uri}};const hE={},PSe=new Iw(Lt.applicationUrl);let io=PSe;const OSe=LSe();let X6=OSe;const Q6=()=>io,mgt=()=>X6;function LSe(){const t=io.path,e=t.substring(0,t.lastIndexOf(t.split("/")[t.split("/").length-1]));return`${`${io.scheme}://${io.host}${io.port!=null?`:${io.port}`:""}`}${e}`}function sn(t){if(!t)return null;const e={path:null,query:null},i=new Iw(t),r=t.indexOf("?");return i.query===null?e.path=t:(e.path=t.substring(0,r),e.query=eB(i.query)),i.fragment&&(e.hash=i.fragment,i.query===null&&(e.path=e.path.substring(0,e.path.length-(i.fragment.length+1)))),e}function eB(t){const e=t.split("&"),i={};for(const r of e){if(!r)continue;const n=r.indexOf("=");let s,o;n<0?(s=decodeURIComponent(r),o=""):(s=decodeURIComponent(r.slice(0,n)),o=decodeURIComponent(r.slice(n+1)));let a=i[s];typeof a=="string"&&(a=i[s]=[a]),Array.isArray(a)?a.push(o):i[s]=o}return i}function UH(t){return t&&typeof t=="object"&&"toJSON"in t&&typeof t.toJSON=="function"}function Zw(t,e){return t?e&&typeof e=="function"?Object.keys(t).map(i=>encodeURIComponent(i)+"="+encodeURIComponent(e(i,t[i]))).join("&"):Object.keys(t).map(i=>{const r=t[i];if(r==null)return"";const n=encodeURIComponent(i)+"=",s=e&&e[i];return s?n+encodeURIComponent(s(r)):Array.isArray(r)?r.map(o=>UH(o)?n+encodeURIComponent(JSON.stringify(o)):n+encodeURIComponent(o)).join("&"):UH(r)?n+encodeURIComponent(JSON.stringify(r)):n+encodeURIComponent(r)}).filter(i=>i).join("&"):""}function RSe(t=!1){let e,i=D1.proxyUrl;if(typeof t=="string"){e=BSe(t);const r=WO(t);r&&(i=r.proxyUrl)}else e=!!t;if(!i)throw TSe.warn(BH),new N("urlutils:proxy-not-set",BH);return e&&DD()&&(i=sB(i)),sn(i)}function ggt(t){const e=WO(t);let i,r;if(e){const n=tB(e.proxyUrl);i=n.path,r=n.query?eB(n.query):null}if(i){const n=sn(t);t=i+"?"+n.path;const s=Zw({...r,...n.query});s&&(t=`${t}?${s}`)}return t}const yx={path:"",query:""};function tB(t){const e=t.indexOf("?");return e!==-1?(yx.path=t.slice(0,e),yx.query=t.slice(e+1)):(yx.path=t,yx.query=null),yx}function Vne(t){return t=(t=Vk(t=WSe(t=tB(t).path),!0)).toLowerCase()}function FSe(t){const e={proxyUrl:t.proxyUrl,urlPrefix:Vne(t.urlPrefix)},i=D1.proxyRules,r=e.urlPrefix;let n=i.length;for(let s=0;s<i.length;s++){const o=i[s].urlPrefix;if(r.indexOf(o)===0){if(r.length===o.length)return-1;n=s;break}o.indexOf(r)===0&&(n=s+1)}return i.splice(n,0,e),n}function WO(t){const e=D1.proxyRules,i=Vne(t);for(let r=0;r<e.length;r++)if(i.indexOf(e[r].urlPrefix)===0)return e[r]}function DSe(t,e){if(!t||!e)return!1;t=Nk(t),e=Nk(e);const i=FD(t),r=FD(e);return i!=null&&r!=null?i.portalHostname===r.portalHostname:i==null&&r==null&&Yw(t,e,!0)}function zne(t,e){return t=Nk(t),e=Nk(e),Vk(t)===Vk(e)}function Nk(t){const e=(t=ic(t)).indexOf("/sharing");return e>0?t.substring(0,e):t.replace(/\/+$/,"")}function jne(t){const e=r=>r==null||r instanceof RegExp&&r.test(t)||typeof r=="string"&&t.startsWith(r),i=D1.interceptors;if(i){for(const r of i)if(Array.isArray(r.urls)){if(r.urls.some(e))return r}else if(e(r.urls))return r}return null}function Yw(t,e,i=!1){if(!t||!e)return!1;const r=VD(t),n=VD(e);return!(!i&&r.scheme!==n.scheme)&&r.host!=null&&n.host!=null&&r.host.toLowerCase()===n.host.toLowerCase()&&r.port===n.port}function iB(t){if(typeof t=="string"){if(!il(t))return!0;t=VD(t)}if(Yw(t,io))return!0;const e=D1.trustedServers||[];for(let i=0;i<e.length;i++){const r=NSe(e[i]);for(let n=0;n<r.length;n++)if(Yw(t,r[n]))return!0}return!1}function NSe(t){return hE[t]||(nB(t)||Nd(t)?hE[t]=[new Iw(Jl(t))]:hE[t]=[new Iw(`http://${t}`),new Iw(`https://${t}`)]),hE[t]}function Jl(t,e=X6,i){return Nd(t)?i&&i.preserveProtocolRelative?t:io.scheme==="http"&&io.authority===yu(t).slice(2)?`http:${t}`:`https:${t}`:nB(t)?t:Kw(t[0]==="/"?qSe(e):e,t)}function rB(t,e=X6,i){if(t==null||!il(t))return t;const r=ic(t),n=r.toLowerCase(),s=ic(e).toLowerCase().replace(/\/+$/,""),o=i?ic(i).toLowerCase().replace(/\/+$/,""):null;if(o&&s.indexOf(o)!==0)return t;const a=(h,f,m)=>(m=h.indexOf(f,m))===-1?h.length:m;let l=a(n,"/",n.indexOf("//")+2),c=-1;for(;n.slice(0,l+1)===s.slice(0,l)+"/"&&(c=l+1,l!==n.length);)l=a(n,"/",l+1);if(c===-1||o&&c<o.length)return t;t=r.slice(c);const u=s.slice(c-1).replaceAll(/[^/]+/g,"").length;if(u>0)for(let h=0;h<u;h++)t=`../${t}`;else t=`./${t}`;return t}function ic(t){return t=YSe(t=ZSe(t=JSe(t=Jl(t=t.trim()))))}function Kw(...t){const e=t.filter(Dt);if(!e||!e.length)return;const i=[];if(il(e[0])){const n=e[0],s=n.indexOf("//");s!==-1&&(i.push(n.slice(0,s+1)),GSe(e[0])&&(i[0]+="/"),e[0]=n.slice(s+2))}else e[0][0]==="/"&&i.push("");const r=e.reduce((n,s)=>s?n.concat(s.split("/")):n,[]);for(let n=0;n<r.length;n++){const s=r[n];s===".."&&i.length>0&&i[i.length-1]!==".."?i.pop():(!s&&n===r.length-1||s&&(s!=="."||i.length===0))&&i.push(s)}return i.join("/")}function yu(t,e=!1){if(t==null||JO(t)||Bv(t))return null;let i=t.indexOf("://");if(i===-1&&Nd(t))i=2;else{if(i===-1)return null;i+=3}const r=t.indexOf("/",i);return r!==-1&&(t=t.slice(0,r)),e&&(t=Vk(t,!0)),t}function il(t){return Nd(t)||nB(t)}function JO(t){return t!=null&&t.slice(0,5)==="blob:"}function Bv(t){return t!=null&&t.slice(0,5)==="data:"}function VSe(t){const e=BI(t);return e&&e.isBase64?ISe(e.data):null}function ygt(t){return btoa(String.fromCharCode.apply(null,t)).replaceAll("+","-").replaceAll("/","_").replace(/=+$/,"")}const zSe=/^data:(.*?)(;base64)?,(.*)$/;function BI(t){const e=t.match(zSe);if(!e)return null;const[,i,r,n]=e;return{mediaType:i,isBase64:!!r,data:n}}function Bne(t){return t.isBase64?`data:${t.mediaType};base64,${t.data}`:`data:${t.mediaType},${t.data}`}function vgt(t){const e=VSe(t);if(!e)return null;const i=BI(t);return new Blob([e],{type:i.mediaType})}function _gt(t,e){jSe(t,e)}function jSe(t,e){if(!t)return!1;const i=document.createElement("a");if(!("download"in i))return!1;const r=URL.createObjectURL(t);return i.download=e,i.href=r,i.style.display="none",document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(r),!0}function Nd(t){return t!=null&&t[0]==="/"&&t[1]==="/"}function nB(t){return t!=null&&Dne.test(t)}function BSe(t){return t!=null&&CSe.test(t)||io.scheme==="https"&&Nd(t)}function USe(t){return t!=null&&Nne.test(t)||io.scheme==="http"&&Nd(t)}function GSe(t){return t!=null&&ESe.test(t)}function sB(t){return Nd(t)?`https:${t}`:t.replace(Nne,"https:")}function HSe(){return io.scheme==="http"}function DD(){return io.scheme==="https"}function Vk(t,e=!1){return Nd(t)?t.slice(2):(t=t.replace(Dne,""),e&&t.length>1&&t[0]==="/"&&t[1]==="/"&&(t=t.slice(2)),t)}function qSe(t){const e=t.indexOf("//"),i=t.indexOf("/",e+2);return i===-1?t:t.slice(0,i)}function oB(t){let e=0;if(il(t)){const r=t.indexOf("//");r!==-1&&(e=r+2)}const i=t.lastIndexOf("/");return i<e?t:t.slice(0,i+1)}function bgt(t,e){if(!t)return"";const i=sn(t).path.replace(/\/+$/,""),r=i.substring(i.lastIndexOf("/")+1);if(!(e!=null&&e.length))return r;const n=new RegExp(`.(${e.join("|")})$`,"ig");return r.replace(n,"")}function WSe(t){return t&&t[t.length-1]==="/"?t:`${t}/`}function Une(t){return t.replace(/\/+$/,"")}function JSe(t){if(/^https?:\/\//i.test(t)){const e=tB(t);t=(t=e.path.replaceAll(/\/{2,}/g,"/")).replace("/","//"),e.query&&(t+=`?${e.query}`)}return t}function ZSe(t){return t.replace(/^(https?:\/\/)(arcgis\.com)/i,"$1www.$2")}function YSe(t){const e=D1.httpsDomains;if(!USe(t))return t;const i=t.indexOf("/",7);let r;if(r=i===-1?t:t.slice(0,i),r=r.toLowerCase().slice(7),MSe.test(r)){if(!r.endsWith(":80"))return t;r=r.slice(0,-3),t=t.replace(":80","")}return HSe()&&r===io.authority&&!$Se.test(t)||(DD()&&r===io.authority||e&&e.some(n=>r===n||r.endsWith(`.${n}`))||DD()&&!WO(t))&&(t=sB(t)),t}function ND(t,e,i){if(!(e&&i&&t&&il(t)))return t;const r=t.indexOf("//"),n=t.indexOf("/",r+2),s=t.indexOf(":",r+2),o=Math.min(n<0?t.length:n,s<0?t.length:s);return t.slice(r+2,o).toLowerCase()!==e.toLowerCase()?t:`${t.slice(0,r+2)}${i}${t.slice(o)}`}function VD(t){return typeof t=="string"?new Iw(Jl(t)):(t.scheme||(t.scheme=io.scheme),t)}function wgt(t){return KSe.test(t)}function Gne(t,e){const i=sn(t),r=Object.keys(i.query||{});return r.length>0&&e&&e.warn("removeQueryParameters()",`Url query parameters are not supported, the following parameters have been removed: ${r.join(", ")}.`),i.path}function Hne(t,e,i){const r=sn(t),n=r.query||{};return n[e]=String(i),`${r.path}?${Zw(n)}`}function T$(t,e){const i=sn(t),r=i.query||{};for(const s in e)r[s]=e[s];const n=Zw(r);return n?`${i.path}?${n}`:i.path}function xgt(t){if(t==null)return null;const e=t.match(qne);return e?e[2]:null}function GH(t){if(t==null)return null;const e=t.match(qne);return e?{path:e[1],extension:e[2]}:{path:t,extension:null}}async function Sgt(t){return typeof t=="string"?BI(t)??{data:t}:new Promise((e,i)=>{const r=new FileReader;r.readAsDataURL(t),r.onload=()=>e(BI(r.result)),r.onerror=n=>i(n)})}const qne=/([^.]*)\.([^\/]*)$/,KSe=/(^data:image\/svg|\.svg$)/i;function ge(t,e,i){let r,n;return e===void 0?(n=t,r=[void 0]):typeof e!="string"?(n=t,r=[void 0],i=e):(n=e,r=Array.isArray(t)?t:[t]),(s,o)=>{const a=s.constructor.prototype;for(const l of r){const c=fne(s,l,n);c.write&&typeof c.write=="object"||(c.write={}),i&&(c.write.target=i),c.write.writer=a[o]}}}let He=class{constructor(e,i={ignoreUnknown:!1,useNumericKeys:!1}){this._jsonToAPI=e,this._options=i,this.apiValues=[],this.jsonValues=[],this._apiToJSON=this._invertMap(e),this.apiValues=this._getKeysSorted(this._apiToJSON),this.jsonValues=this._getKeysSorted(this._jsonToAPI),this.read=r=>this.fromJSON(r),this.write=(r,n,s)=>{const o=this.toJSON(r);o!==void 0&&ho(s,o,n)},this.write.isJSONMapWriter=!0}toJSON(e){if(e==null)return null;if(this._apiToJSON.hasOwnProperty(e)){const i=this._apiToJSON[e];return this._options.useNumericKeys?+i:i}return this._options.ignoreUnknown?void 0:e}fromJSON(e){return e!=null&&this._jsonToAPI.hasOwnProperty(e)?this._jsonToAPI[e]:this._options.ignoreUnknown?void 0:e}_invertMap(e){const i={};for(const r in e)i[e[r]]=r;return i}_getKeysSorted(e){const i=[];for(const r in e)i.push(r);return i.sort(),i}};function ln(){return function(t,e){return new He(t,{ignoreUnknown:!0,...e})}}let aB=class{constructor(e,i,r,n){this.semiMajorAxis=e,this.flattening=i,this.outerAtmosphereRimWidth=r;const s=1-this.flattening;this.semiMinorAxis=this.semiMajorAxis*s,this.halfSemiMajorAxis=this.semiMajorAxis/2,this.halfCircumference=Math.PI*this.semiMajorAxis,this.metersPerDegree=this.halfCircumference/180,this.inverseFlattening=1/(1-this.flattening)-1,this.eccentricitySquared=n||2*this.flattening-this.flattening*this.flattening,this.meanRadiusSemiAxes=(2*this.semiMajorAxis+this.semiMinorAxis)/3}get radius(){return this.semiMajorAxis}};const Ti=new aB(6378137,1/298.257223563,3e5,.006694379990137799),np=new aB(3396190,1/169.8944472236118,23e4),ng=new aB(1737400,0,0);var vv;(function(t){t[t.CGCS2000=4490]="CGCS2000",t[t.GCSMARS2000=104971]="GCSMARS2000",t[t.GCSMARS2000_SPHERE=104905]="GCSMARS2000_SPHERE",t[t.GCSMOON2000=104903]="GCSMOON2000"})(vv||(vv={}));let _;const O={values:[1,.3048,.3048006096012192,.3047972654,.9143917962,.201166195164,.9143984146160287,.3047994715386762,20.11676512155263,20.11678249437587,.9143985307444408,.91439523,.3047997101815088,20.1168,20.116756,5e4,15e4],units:["Meter","Foot","Foot_US","Foot_Clarke","Yard_Clarke","Link_Clarke","Yard_Sears","Foot_Sears","Chain_Sears","Chain_Benoit_1895_B","Yard_Indian","Yard_Indian_1937","Foot_Gold_Coast","Chain","Chain_Sears_1922_Truncated","50_Kilometers","150_Kilometers"],2066:5,2136:12,2155:2,2157:0,2158:0,2159:12,2160:12,2204:2,2219:0,2220:0,2254:2,2255:2,2256:1,2265:1,2266:1,2267:2,2268:2,2269:1,2270:1,2271:2,2272:2,2273:1,2294:0,2295:0,2314:3,2899:2,2900:2,2901:1,2909:1,2910:1,2911:2,2912:2,2913:1,2914:1,2992:1,2993:0,2994:1,3080:1,3089:2,3090:0,3091:2,3102:2,3141:0,3142:0,3167:14,3359:2,3360:0,3361:1,3362:0,3363:2,3364:0,3365:2,3366:3,3404:2,3405:0,3406:0,3407:3,3439:0,3440:0,3479:1,3480:0,3481:1,3482:0,3483:1,3484:0,3485:2,3486:0,3487:2,3488:0,3489:0,3490:2,3491:0,3492:2,3493:0,3494:2,3495:0,3496:2,3497:0,3498:2,3499:0,3500:2,3501:0,3502:2,3503:0,3504:2,3505:0,3506:2,3507:0,3508:2,3509:0,3510:2,3511:0,3512:2,3513:0,3514:0,3515:2,3516:0,3517:2,3518:0,3519:2,3520:0,3521:2,3522:0,3523:2,3524:0,3525:2,3526:0,3527:2,3528:0,3529:2,3530:0,3531:2,3532:0,3533:2,3534:0,3535:2,3536:0,3537:2,3538:0,3539:2,3540:0,3541:2,3542:0,3543:2,3544:0,3545:2,3546:0,3547:2,3548:0,3549:2,3550:0,3551:2,3552:0,3553:2,3582:2,3583:0,3584:2,3585:0,3586:2,3587:0,3588:1,3589:0,3590:1,3591:0,3592:0,3593:1,3598:2,3599:0,3600:2,3605:1,3606:0,3607:0,3608:2,3609:0,3610:2,3611:0,3612:2,3613:0,3614:2,3615:0,3616:2,3617:0,3618:2,3619:0,3620:2,3621:0,3622:2,3623:0,3624:2,3625:0,3626:2,3627:0,3628:2,3629:0,3630:2,3631:0,3632:2,3633:0,3634:1,3635:0,3636:1,3640:2,3641:0,3642:2,3643:0,3644:1,3645:0,3646:1,3647:0,3648:1,3649:0,3650:2,3651:0,3652:2,3653:0,3654:2,3655:0,3656:1,3657:0,3658:2,3659:0,3660:2,3661:0,3662:2,3663:0,3664:2,3668:2,3669:0,3670:2,3671:0,3672:2,3673:0,3674:2,3675:0,3676:1,3677:2,3678:0,3679:1,3680:2,3681:0,3682:1,3683:2,3684:0,3685:0,3686:2,3687:0,3688:2,3689:0,3690:2,3691:0,3692:2,3696:2,3697:0,3698:2,3699:0,3700:2,3793:0,3794:0,3812:0,3854:0,3857:0,3920:0,3978:0,3979:0,3991:2,3992:2,4026:0,4037:0,4038:0,4071:0,4082:0,4083:0,4087:0,4088:0,4217:2,4414:0,4415:0,4417:0,4434:0,4437:0,4438:2,4439:2,4462:0,4467:0,4471:0,4474:0,4559:0,4647:0,4822:0,4826:0,4839:0,5018:0,5041:0,5042:0,5048:0,5167:0,5168:0,5221:0,5223:0,5234:0,5235:0,5243:0,5247:0,5266:0,5316:0,5320:0,5321:0,5325:0,5337:0,5361:0,5362:0,5367:0,5382:0,5383:0,5396:0,5456:0,5457:0,5469:0,5472:4,5490:0,5513:0,5514:0,5523:0,5559:0,5588:1,5589:3,5596:0,5627:0,5629:0,5641:0,5643:0,5644:0,5646:2,5654:2,5655:2,5659:0,5700:0,5825:0,5836:0,5837:0,5839:0,5842:0,5844:0,5858:0,5879:0,5880:0,5887:0,5890:0,6128:1,6129:1,6141:1,6204:0,6210:0,6211:0,6307:0,6312:0,6316:0,6362:0,6391:1,6405:1,6406:0,6407:1,6408:0,6409:1,6410:0,6411:2,6412:0,6413:2,6414:0,6415:0,6416:2,6417:0,6418:2,6419:0,6420:2,6421:0,6422:2,6423:0,6424:2,6425:0,6426:2,6427:0,6428:2,6429:0,6430:2,6431:0,6432:2,6433:0,6434:2,6435:0,6436:2,6437:0,6438:2,6439:0,6440:0,6441:2,6442:0,6443:2,6444:0,6445:2,6446:0,6447:2,6448:0,6449:2,6450:0,6451:2,6452:0,6453:2,6454:0,6455:2,6456:0,6457:2,6458:0,6459:2,6460:0,6461:2,6462:0,6463:2,6464:0,6465:2,6466:0,6467:2,6468:0,6469:2,6470:0,6471:2,6472:0,6473:2,6474:0,6475:2,6476:0,6477:2,6478:0,6479:2,6484:2,6485:0,6486:2,6487:0,6488:2,6489:0,6490:2,6491:0,6492:2,6493:0,6494:1,6495:0,6496:1,6497:0,6498:0,6499:1,6500:0,6501:2,6502:0,6503:2,6504:0,6505:2,6506:0,6507:2,6508:0,6509:0,6510:2,6515:1,6516:0,6518:0,6519:2,6520:0,6521:2,6522:0,6523:2,6524:0,6525:2,6526:0,6527:2,6528:0,6529:2,6530:0,6531:2,6532:0,6533:2,6534:0,6535:2,6536:0,6537:2,6538:0,6539:2,6540:0,6541:2,6542:0,6543:2,6544:0,6545:1,6546:0,6547:1,6548:0,6549:2,6550:0,6551:2,6552:0,6553:2,6554:0,6555:2,6556:0,6557:1,6558:0,6559:1,6560:0,6561:1,6562:0,6563:2,6564:0,6565:2,6566:0,6567:0,6568:2,6569:0,6570:1,6571:0,6572:2,6573:0,6574:2,6575:0,6576:2,6577:0,6578:2,6582:2,6583:0,6584:2,6585:0,6586:2,6587:0,6588:2,6589:0,6590:2,6591:0,6592:0,6593:2,6594:0,6595:2,6596:0,6597:2,6598:0,6599:2,6600:0,6601:2,6602:0,6603:2,6605:2,6606:0,6607:2,6608:0,6609:2,6610:0,6611:0,6612:2,6613:0,6614:2,6615:0,6616:2,6617:0,6618:2,6633:2,6646:0,6703:0,6784:0,6785:1,6786:0,6787:1,6788:0,6789:1,6790:0,6791:1,6792:0,6793:1,6794:0,6795:1,6796:0,6797:1,6798:0,6799:1,6800:0,6801:1,6802:0,6803:1,6804:0,6805:1,6806:0,6807:1,6808:0,6809:1,6810:0,6811:1,6812:0,6813:1,6814:0,6815:1,6816:0,6817:1,6818:0,6819:1,6820:0,6821:1,6822:0,6823:1,6824:0,6825:1,6826:0,6827:1,6828:0,6829:1,6830:0,6831:1,6832:0,6833:1,6834:0,6835:1,6836:0,6837:1,6838:0,6839:1,6840:0,6841:1,6842:0,6843:1,6844:0,6845:1,6846:0,6847:1,6848:0,6849:1,6850:0,6851:1,6852:0,6853:1,6854:0,6855:1,6856:0,6857:1,6858:0,6859:1,6860:0,6861:1,6862:0,6863:1,6867:0,6868:1,6870:0,6875:0,6876:0,6879:0,6880:2,6884:0,6885:1,6886:0,6887:1,6915:0,6922:0,6923:2,6924:0,6925:2,6962:0,6984:0,6991:0,7128:2,7131:0,7132:2,7142:0,7257:0,7258:2,7259:0,7260:2,7261:0,7262:2,7263:0,7264:2,7265:0,7266:2,7267:0,7268:2,7269:0,7270:2,7271:0,7272:2,7273:0,7274:2,7275:0,7276:2,7277:0,7278:2,7279:0,7280:2,7281:0,7282:2,7283:0,7284:2,7285:0,7286:2,7287:0,7288:2,7289:0,7290:2,7291:0,7292:2,7293:0,7294:2,7295:0,7296:2,7297:0,7298:2,7299:0,7300:2,7301:0,7302:2,7303:0,7304:2,7305:0,7306:2,7307:0,7308:2,7309:0,7310:2,7311:0,7312:2,7313:0,7314:2,7315:0,7316:2,7317:0,7318:2,7319:0,7320:2,7321:0,7322:2,7323:0,7324:2,7325:0,7326:2,7327:0,7328:2,7329:0,7330:2,7331:0,7332:2,7333:0,7334:2,7335:0,7336:2,7337:0,7338:2,7339:0,7340:2,7341:0,7342:2,7343:0,7344:2,7345:0,7346:2,7347:0,7348:2,7349:0,7350:2,7351:0,7352:2,7353:0,7354:2,7355:0,7356:2,7357:0,7358:2,7359:0,7360:2,7361:0,7362:2,7363:0,7364:2,7365:0,7366:2,7367:0,7368:2,7369:0,7370:2,7877:0,7878:0,7882:0,7883:0,7887:0,7899:0,7991:0,7992:0,8035:2,8036:2,8058:0,8059:0,8082:0,8083:0,8088:0,8090:0,8091:2,8092:0,8093:2,8095:0,8096:2,8097:0,8098:2,8099:0,8100:2,8101:0,8102:2,8103:0,8104:2,8105:0,8106:2,8107:0,8108:2,8109:0,8110:2,8111:0,8112:2,8113:0,8114:2,8115:0,8116:2,8117:0,8118:2,8119:0,8120:2,8121:0,8122:2,8123:0,8124:2,8125:0,8126:2,8127:0,8128:2,8129:0,8130:2,8131:0,8132:2,8133:0,8134:2,8135:0,8136:2,8137:0,8138:2,8139:0,8140:2,8141:0,8142:2,8143:0,8144:2,8145:0,8146:2,8147:0,8148:2,8149:0,8150:2,8151:0,8152:2,8153:0,8154:2,8155:0,8156:2,8157:0,8158:2,8159:0,8160:2,8161:0,8162:2,8163:0,8164:2,8165:0,8166:2,8167:0,8168:2,8169:0,8170:2,8171:0,8172:2,8173:0,8177:2,8179:0,8180:2,8181:0,8182:2,8184:0,8185:2,8187:0,8189:2,8191:0,8193:2,8196:0,8197:2,8198:0,8200:2,8201:0,8202:2,8203:0,8204:2,8205:0,8206:2,8207:0,8208:2,8209:0,8210:2,8212:0,8213:2,8214:0,8216:2,8218:0,8220:2,8222:0,8224:2,8225:0,8226:2,8311:0,8312:1,8313:0,8314:1,8315:0,8316:1,8317:0,8318:1,8319:0,8320:1,8321:0,8322:1,8323:0,8324:1,8325:0,8326:1,8327:0,8328:1,8329:0,8330:1,8331:0,8332:1,8333:0,8334:1,8335:0,8336:1,8337:0,8338:1,8339:0,8340:1,8341:0,8342:1,8343:0,8344:1,8345:0,8346:1,8347:0,8348:1,8352:0,8353:0,8379:0,8380:2,8381:0,8382:2,8383:0,8384:2,8385:0,8387:2,8391:0,8395:0,8433:0,8441:0,8455:0,8456:0,8531:2,8682:0,8686:0,8687:0,8692:0,8693:0,8826:0,8903:0,8950:0,8951:0,9039:0,9040:0,9141:0,9149:0,9150:0,9191:0,9221:0,9222:0,9249:0,9250:0,9252:0,9254:0,9265:0,9284:0,9285:0,9300:0,9354:0,9367:0,9373:0,9377:0,9387:0,9391:0,9456:0,9473:0,9498:0,9674:0,9678:0,9680:0,9709:0,9712:0,9713:0,9716:0,9741:0,9748:2,9749:2,9761:0,9766:0,9793:0,9794:0,9869:0,9874:0,9875:0,9880:0,9943:0,9945:0,9947:0,9967:0,9972:0,9977:0,20042:0,20050:1,20499:0,20538:0,20539:0,20790:0,20791:0,21291:0,21292:0,21500:0,21817:0,21818:0,22032:0,22033:0,22091:0,22092:0,22239:0,22240:0,22332:0,22337:0,22338:0,22391:0,22392:0,22639:0,22700:0,22739:0,22770:0,22780:0,22832:0,23090:0,23095:0,23239:0,23240:0,23433:0,23700:0,24047:0,24048:0,24100:3,24200:0,24305:0,24306:0,24382:10,24383:0,24500:0,24547:0,24548:0,24571:9,24600:0,25e3:0,25231:0,25884:0,25932:0,26237:0,26331:0,26332:0,26432:0,26591:0,26592:0,26632:0,26692:0,27120:0,27200:0,27291:6,27292:6,27429:0,27492:0,27493:0,27500:0,27700:0,28232:0,28600:0,28991:0,28992:0,29100:0,29101:0,29220:0,29221:0,29333:0,29635:0,29636:0,29701:0,29738:0,29739:0,29849:0,29850:0,29871:8,29872:7,29873:0,29874:0,30200:5,30339:0,30340:0,30591:0,30592:0,30791:0,30792:0,30800:0,31028:0,31121:0,31154:0,31170:0,31171:0,31370:0,31528:0,31529:0,31600:0,31700:0,31838:0,31839:0,31900:0,31901:0,32061:0,32062:0,32098:0,32099:2,32100:0,32104:0,32161:0,32766:0,53048:0,53049:0,54090:0,54091:0,65061:2,65062:2,65161:0,65163:0,102041:2,102064:11,102068:15,102069:16,102118:2,102119:1,102120:2,102121:2,102217:2,102218:0,102219:2,102220:2,102378:1,102379:1,102380:0,102381:1,102589:2,102599:2,102600:2,102604:2,102647:0,102704:2,102705:2,102706:0,102731:0,102732:0,102759:1,102760:1,102761:2,102762:0,102763:2,102764:0,102765:0,102766:2,102970:1,102974:2,102993:0,102994:0,102995:2,102996:2,103015:0,103016:2,103017:0,103018:2,103025:0,103026:0,103027:2,103028:2,103035:0,103036:0,103037:2,103038:2,103039:0,103040:0,103041:2,103042:2,103043:0,103044:0,103045:2,103046:2,103047:0,103048:0,103049:2,103050:2,103051:0,103052:2,103053:0,103054:2,103055:0,103056:2,103057:0,103058:0,103059:2,103060:2,103061:0,103062:0,103063:2,103064:2,103069:2,103070:0,103071:0,103072:2,103073:2,103086:0,103087:0,103088:2,103089:2,103094:1,103095:0,103096:2,103103:0,103104:2,103105:0,103106:2,103121:0,103122:2,103123:0,103124:0,103125:1,103126:1,103127:0,103128:0,103129:2,103130:2,103131:0,103132:0,103133:2,103134:2,103135:0,103136:0,103137:1,103138:1,103139:0,103140:2,103141:0,103142:2,103143:0,103144:2,103145:0,103146:1,103147:0,103148:0,103149:2,103150:2,103151:0,103152:2,103172:0,103173:2,103174:0,103175:0,103176:2,103177:2,103178:0,103179:0,103180:2,103181:2,103182:0,103183:0,103184:2,103185:2,103228:0,103229:0,103230:2,103231:2,103250:0,103251:2,103252:0,103253:2,103260:0,103261:0,103262:2,103263:2,103270:0,103271:0,103272:2,103273:2,103274:0,103275:0,103276:2,103277:2,103278:0,103279:0,103280:2,103281:2,103282:0,103283:0,103284:2,103285:2,103286:0,103287:2,103288:0,103289:2,103290:0,103291:2,103292:0,103293:0,103294:2,103295:2,103296:0,103297:0,103298:2,103299:2,103376:2,103377:0,103378:0,103379:2,103380:2,103393:0,103394:0,103395:2,103396:2,103472:0,103473:1,103474:0,103475:2,103482:0,103483:2,103484:0,103485:2,103500:0,103501:2,103502:0,103503:0,103504:1,103505:1,103506:0,103507:0,103508:2,103509:2,103510:0,103511:0,103512:2,103513:2,103514:0,103515:2,103516:0,103517:2,103518:0,103519:2,103520:0,103521:1,103522:0,103523:0,103524:2,103525:2,103526:0,103527:2,103561:2,103562:2,103563:0,103564:0,103565:2,103566:2,103567:0,103568:0,103569:2,103570:2,103584:0,103585:2,103586:0,103587:2,103588:1,103589:0,103590:2,103591:1,103592:0,103593:2,103594:1,103695:2};for(_=2e3;_<=2045;_++)O[_]=0;for(_=2056;_<=2065;_++)O[_]=0;for(_=2067;_<=2135;_++)O[_]=0;for(_=2137;_<=2154;_++)O[_]=0;for(_=2161;_<=2170;_++)O[_]=0;for(_=2172;_<=2193;_++)O[_]=0;for(_=2195;_<=2198;_++)O[_]=0;for(_=2200;_<=2203;_++)O[_]=0;for(_=2205;_<=2217;_++)O[_]=0;for(_=2222;_<=2224;_++)O[_]=1;for(_=2225;_<=2250;_++)O[_]=2;for(_=2251;_<=2253;_++)O[_]=1;for(_=2257;_<=2264;_++)O[_]=2;for(_=2274;_<=2279;_++)O[_]=2;for(_=2280;_<=2282;_++)O[_]=1;for(_=2283;_<=2289;_++)O[_]=2;for(_=2290;_<=2292;_++)O[_]=0;for(_=2308;_<=2313;_++)O[_]=0;for(_=2315;_<=2491;_++)O[_]=0;for(_=2494;_<=2866;_++)O[_]=0;for(_=2867;_<=2869;_++)O[_]=1;for(_=2870;_<=2888;_++)O[_]=2;for(_=2891;_<=2895;_++)O[_]=2;for(_=2896;_<=2898;_++)O[_]=1;for(_=2902;_<=2908;_++)O[_]=2;for(_=2915;_<=2920;_++)O[_]=2;for(_=2921;_<=2923;_++)O[_]=1;for(_=2924;_<=2930;_++)O[_]=2;for(_=2931;_<=2962;_++)O[_]=0;for(_=2964;_<=2968;_++)O[_]=2;for(_=2969;_<=2973;_++)O[_]=0;for(_=2975;_<=2991;_++)O[_]=0;for(_=2995;_<=3051;_++)O[_]=0;for(_=3054;_<=3079;_++)O[_]=0;for(_=3081;_<=3088;_++)O[_]=0;for(_=3092;_<=3101;_++)O[_]=0;for(_=3106;_<=3138;_++)O[_]=0;for(_=3146;_<=3151;_++)O[_]=0;for(_=3153;_<=3166;_++)O[_]=0;for(_=3168;_<=3172;_++)O[_]=0;for(_=3174;_<=3203;_++)O[_]=0;for(_=3294;_<=3358;_++)O[_]=0;for(_=3367;_<=3403;_++)O[_]=0;for(_=3408;_<=3416;_++)O[_]=0;for(_=3417;_<=3438;_++)O[_]=2;for(_=3441;_<=3446;_++)O[_]=2;for(_=3447;_<=3450;_++)O[_]=0;for(_=3451;_<=3459;_++)O[_]=2;for(_=3460;_<=3478;_++)O[_]=0;for(_=3554;_<=3559;_++)O[_]=0;for(_=3560;_<=3570;_++)O[_]=2;for(_=3571;_<=3581;_++)O[_]=0;for(_=3594;_<=3597;_++)O[_]=0;for(_=3601;_<=3604;_++)O[_]=0;for(_=3637;_<=3639;_++)O[_]=0;for(_=3665;_<=3667;_++)O[_]=0;for(_=3693;_<=3695;_++)O[_]=0;for(_=3701;_<=3727;_++)O[_]=0;for(_=3728;_<=3739;_++)O[_]=2;for(_=3740;_<=3751;_++)O[_]=0;for(_=3753;_<=3760;_++)O[_]=2;for(_=3761;_<=3773;_++)O[_]=0;for(_=3775;_<=3777;_++)O[_]=0;for(_=3779;_<=3781;_++)O[_]=0;for(_=3783;_<=3785;_++)O[_]=0;for(_=3788;_<=3791;_++)O[_]=0;for(_=3797;_<=3802;_++)O[_]=0;for(_=3814;_<=3816;_++)O[_]=0;for(_=3825;_<=3829;_++)O[_]=0;for(_=3832;_<=3841;_++)O[_]=0;for(_=3844;_<=3852;_++)O[_]=0;for(_=3873;_<=3885;_++)O[_]=0;for(_=3890;_<=3893;_++)O[_]=0;for(_=3907;_<=3912;_++)O[_]=0;for(_=3942;_<=3950;_++)O[_]=0;for(_=3968;_<=3970;_++)O[_]=0;for(_=3973;_<=3976;_++)O[_]=0;for(_=3986;_<=3989;_++)O[_]=0;for(_=3994;_<=3997;_++)O[_]=0;for(_=4048;_<=4051;_++)O[_]=0;for(_=4056;_<=4063;_++)O[_]=0;for(_=4093;_<=4096;_++)O[_]=0;for(_=4390;_<=4398;_++)O[_]=0;for(_=4399;_<=4413;_++)O[_]=2;for(_=4418;_<=4433;_++)O[_]=2;for(_=4455;_<=4457;_++)O[_]=2;for(_=4484;_<=4489;_++)O[_]=0;for(_=4491;_<=4554;_++)O[_]=0;for(_=4568;_<=4589;_++)O[_]=0;for(_=4652;_<=4656;_++)O[_]=0;for(_=4766;_<=4800;_++)O[_]=0;for(_=5014;_<=5016;_++)O[_]=0;for(_=5069;_<=5072;_++)O[_]=0;for(_=5105;_<=5130;_++)O[_]=0;for(_=5173;_<=5188;_++)O[_]=0;for(_=5253;_<=5259;_++)O[_]=0;for(_=5269;_<=5275;_++)O[_]=0;for(_=5292;_<=5311;_++)O[_]=0;for(_=5329;_<=5331;_++)O[_]=0;for(_=5343;_<=5349;_++)O[_]=0;for(_=5355;_<=5357;_++)O[_]=0;for(_=5387;_<=5389;_++)O[_]=0;for(_=5459;_<=5463;_++)O[_]=0;for(_=5479;_<=5482;_++)O[_]=0;for(_=5518;_<=5520;_++)O[_]=0;for(_=5530;_<=5539;_++)O[_]=0;for(_=5550;_<=5552;_++)O[_]=0;for(_=5562;_<=5583;_++)O[_]=0;for(_=5623;_<=5625;_++)O[_]=2;for(_=5631;_<=5639;_++)O[_]=0;for(_=5649;_<=5653;_++)O[_]=0;for(_=5663;_<=5680;_++)O[_]=0;for(_=5682;_<=5685;_++)O[_]=0;for(_=5875;_<=5877;_++)O[_]=0;for(_=5896;_<=5899;_++)O[_]=0;for(_=5921;_<=5940;_++)O[_]=0;for(_=6050;_<=6125;_++)O[_]=0;for(_=6244;_<=6275;_++)O[_]=0;for(_=6328;_<=6348;_++)O[_]=0;for(_=6350;_<=6356;_++)O[_]=0;for(_=6366;_<=6372;_++)O[_]=0;for(_=6381;_<=6387;_++)O[_]=0;for(_=6393;_<=6404;_++)O[_]=0;for(_=6480;_<=6483;_++)O[_]=0;for(_=6511;_<=6514;_++)O[_]=0;for(_=6579;_<=6581;_++)O[_]=0;for(_=6619;_<=6624;_++)O[_]=0;for(_=6625;_<=6627;_++)O[_]=2;for(_=6628;_<=6632;_++)O[_]=0;for(_=6634;_<=6637;_++)O[_]=0;for(_=6669;_<=6692;_++)O[_]=0;for(_=6707;_<=6709;_++)O[_]=0;for(_=6720;_<=6723;_++)O[_]=0;for(_=6732;_<=6738;_++)O[_]=0;for(_=6931;_<=6933;_++)O[_]=0;for(_=6956;_<=6959;_++)O[_]=0;for(_=7005;_<=7007;_++)O[_]=0;for(_=7057;_<=7070;_++)O[_]=2;for(_=7074;_<=7082;_++)O[_]=0;for(_=7109;_<=7118;_++)O[_]=0;for(_=7119;_<=7127;_++)O[_]=1;for(_=7374;_<=7376;_++)O[_]=0;for(_=7528;_<=7586;_++)O[_]=0;for(_=7587;_<=7645;_++)O[_]=2;for(_=7692;_<=7696;_++)O[_]=0;for(_=7755;_<=7787;_++)O[_]=0;for(_=7791;_<=7795;_++)O[_]=0;for(_=7799;_<=7801;_++)O[_]=0;for(_=7803;_<=7805;_++)O[_]=0;for(_=7825;_<=7831;_++)O[_]=0;for(_=7845;_<=7859;_++)O[_]=0;for(_=8013;_<=8032;_++)O[_]=0;for(_=8065;_<=8068;_++)O[_]=1;for(_=8518;_<=8529;_++)O[_]=2;for(_=8533;_<=8536;_++)O[_]=2;for(_=8538;_<=8540;_++)O[_]=2;for(_=8677;_<=8679;_++)O[_]=0;for(_=8836;_<=8840;_++)O[_]=0;for(_=8857;_<=8859;_++)O[_]=0;for(_=8908;_<=8910;_++)O[_]=0;for(_=9154;_<=9159;_++)O[_]=0;for(_=9205;_<=9218;_++)O[_]=0;for(_=9271;_<=9273;_++)O[_]=0;for(_=9295;_<=9297;_++)O[_]=0;for(_=9356;_<=9360;_++)O[_]=0;for(_=9404;_<=9407;_++)O[_]=0;for(_=9476;_<=9482;_++)O[_]=0;for(_=9487;_<=9494;_++)O[_]=0;for(_=9697;_<=9699;_++)O[_]=0;for(_=9821;_<=9865;_++)O[_]=0;for(_=20002;_<=20032;_++)O[_]=0;for(_=20047;_<=20049;_++)O[_]=0;for(_=20062;_<=20092;_++)O[_]=0;for(_=20135;_<=20138;_++)O[_]=0;for(_=20248;_<=20258;_++)O[_]=0;for(_=20348;_<=20358;_++)O[_]=0;for(_=20436;_<=20440;_++)O[_]=0;for(_=20822;_<=20824;_++)O[_]=0;for(_=20904;_<=20932;_++)O[_]=0;for(_=20934;_<=20936;_++)O[_]=0;for(_=21004;_<=21032;_++)O[_]=0;for(_=21035;_<=21037;_++)O[_]=0;for(_=21095;_<=21097;_++)O[_]=0;for(_=21148;_<=21150;_++)O[_]=0;for(_=21207;_<=21264;_++)O[_]=0;for(_=21307;_<=21364;_++)O[_]=0;for(_=21413;_<=21423;_++)O[_]=0;for(_=21453;_<=21463;_++)O[_]=0;for(_=21473;_<=21483;_++)O[_]=0;for(_=21780;_<=21782;_++)O[_]=0;for(_=21891;_<=21894;_++)O[_]=0;for(_=21896;_<=21899;_++)O[_]=0;for(_=22171;_<=22177;_++)O[_]=0;for(_=22181;_<=22187;_++)O[_]=0;for(_=22191;_<=22197;_++)O[_]=0;for(_=22207;_<=22222;_++)O[_]=0;for(_=22234;_<=22236;_++)O[_]=0;for(_=22243;_<=22250;_++)O[_]=0;for(_=22262;_<=22265;_++)O[_]=0;for(_=22307;_<=22322;_++)O[_]=0;for(_=22348;_<=22357;_++)O[_]=0;for(_=22407;_<=22422;_++)O[_]=0;for(_=22462;_<=22465;_++)O[_]=0;for(_=22521;_<=22525;_++)O[_]=0;for(_=22607;_<=22622;_++)O[_]=0;for(_=22641;_<=22646;_++)O[_]=0;for(_=22648;_<=22657;_++)O[_]=0;for(_=22707;_<=22722;_++)O[_]=0;for(_=22762;_<=22765;_++)O[_]=0;for(_=22991;_<=22994;_++)O[_]=0;for(_=23028;_<=23038;_++)O[_]=0;for(_=23830;_<=23853;_++)O[_]=0;for(_=23866;_<=23872;_++)O[_]=0;for(_=23877;_<=23884;_++)O[_]=0;for(_=23886;_<=23894;_++)O[_]=0;for(_=23946;_<=23948;_++)O[_]=0;for(_=24311;_<=24313;_++)O[_]=0;for(_=24342;_<=24347;_++)O[_]=0;for(_=24370;_<=24374;_++)O[_]=10;for(_=24375;_<=24381;_++)O[_]=0;for(_=24718;_<=24721;_++)O[_]=0;for(_=24817;_<=24821;_++)O[_]=0;for(_=24877;_<=24882;_++)O[_]=0;for(_=24891;_<=24893;_++)O[_]=0;for(_=25391;_<=25395;_++)O[_]=0;for(_=25828;_<=25838;_++)O[_]=0;for(_=26191;_<=26195;_++)O[_]=0;for(_=26391;_<=26393;_++)O[_]=0;for(_=26701;_<=26722;_++)O[_]=0;for(_=26729;_<=26799;_++)O[_]=2;for(_=26801;_<=26803;_++)O[_]=2;for(_=26811;_<=26813;_++)O[_]=2;for(_=26847;_<=26870;_++)O[_]=2;for(_=26891;_<=26899;_++)O[_]=0;for(_=26901;_<=26923;_++)O[_]=0;for(_=26929;_<=26946;_++)O[_]=0;for(_=26948;_<=26998;_++)O[_]=0;for(_=27037;_<=27040;_++)O[_]=0;for(_=27205;_<=27232;_++)O[_]=0;for(_=27258;_<=27260;_++)O[_]=0;for(_=27391;_<=27398;_++)O[_]=0;for(_=27561;_<=27564;_++)O[_]=0;for(_=27571;_<=27574;_++)O[_]=0;for(_=27581;_<=27584;_++)O[_]=0;for(_=27591;_<=27594;_++)O[_]=0;for(_=28191;_<=28193;_++)O[_]=0;for(_=28348;_<=28358;_++)O[_]=0;for(_=28402;_<=28432;_++)O[_]=0;for(_=28462;_<=28492;_++)O[_]=0;for(_=29118;_<=29122;_++)O[_]=0;for(_=29168;_<=29172;_++)O[_]=0;for(_=29177;_<=29185;_++)O[_]=0;for(_=29187;_<=29195;_++)O[_]=0;for(_=29900;_<=29903;_++)O[_]=0;for(_=30161;_<=30179;_++)O[_]=0;for(_=30491;_<=30494;_++)O[_]=0;for(_=30729;_<=30732;_++)O[_]=0;for(_=31251;_<=31259;_++)O[_]=0;for(_=31265;_<=31268;_++)O[_]=0;for(_=31275;_<=31279;_++)O[_]=0;for(_=31281;_<=31297;_++)O[_]=0;for(_=31461;_<=31469;_++)O[_]=0;for(_=31491;_<=31495;_++)O[_]=0;for(_=31917;_<=31922;_++)O[_]=0;for(_=31965;_<=32e3;_++)O[_]=0;for(_=32001;_<=32003;_++)O[_]=2;for(_=32005;_<=32031;_++)O[_]=2;for(_=32033;_<=32060;_++)O[_]=2;for(_=32064;_<=32067;_++)O[_]=2;for(_=32074;_<=32077;_++)O[_]=2;for(_=32081;_<=32086;_++)O[_]=0;for(_=32107;_<=32130;_++)O[_]=0;for(_=32133;_<=32159;_++)O[_]=0;for(_=32164;_<=32167;_++)O[_]=2;for(_=32180;_<=32199;_++)O[_]=0;for(_=32201;_<=32260;_++)O[_]=0;for(_=32301;_<=32360;_++)O[_]=0;for(_=32601;_<=32662;_++)O[_]=0;for(_=32664;_<=32667;_++)O[_]=2;for(_=32701;_<=32761;_++)O[_]=0;for(_=53001;_<=53004;_++)O[_]=0;for(_=53008;_<=53019;_++)O[_]=0;for(_=53021;_<=53032;_++)O[_]=0;for(_=53034;_<=53037;_++)O[_]=0;for(_=53042;_<=53046;_++)O[_]=0;for(_=53074;_<=53080;_++)O[_]=0;for(_=54001;_<=54004;_++)O[_]=0;for(_=54008;_<=54019;_++)O[_]=0;for(_=54021;_<=54032;_++)O[_]=0;for(_=54034;_<=54037;_++)O[_]=0;for(_=54042;_<=54046;_++)O[_]=0;for(_=54048;_<=54053;_++)O[_]=0;for(_=54074;_<=54080;_++)O[_]=0;for(_=54098;_<=54101;_++)O[_]=0;for(_=102001;_<=102040;_++)O[_]=0;for(_=102042;_<=102063;_++)O[_]=0;for(_=102065;_<=102067;_++)O[_]=0;for(_=102070;_<=102117;_++)O[_]=0;for(_=102122;_<=102216;_++)O[_]=0;for(_=102221;_<=102377;_++)O[_]=0;for(_=102382;_<=102388;_++)O[_]=0;for(_=102389;_<=102398;_++)O[_]=2;for(_=102399;_<=102444;_++)O[_]=0;for(_=102445;_<=102447;_++)O[_]=2;for(_=102448;_<=102458;_++)O[_]=0;for(_=102459;_<=102468;_++)O[_]=2;for(_=102469;_<=102499;_++)O[_]=0;for(_=102500;_<=102519;_++)O[_]=1;for(_=102520;_<=102524;_++)O[_]=0;for(_=102525;_<=102529;_++)O[_]=2;for(_=102530;_<=102588;_++)O[_]=0;for(_=102590;_<=102598;_++)O[_]=0;for(_=102601;_<=102603;_++)O[_]=0;for(_=102605;_<=102628;_++)O[_]=0;for(_=102629;_<=102646;_++)O[_]=2;for(_=102648;_<=102700;_++)O[_]=2;for(_=102701;_<=102703;_++)O[_]=0;for(_=102707;_<=102730;_++)O[_]=2;for(_=102733;_<=102758;_++)O[_]=2;for(_=102767;_<=102900;_++)O[_]=0;for(_=102901;_<=102933;_++)O[_]=2;for(_=102934;_<=102950;_++)O[_]=13;for(_=102951;_<=102955;_++)O[_]=0;for(_=102961;_<=102963;_++)O[_]=0;for(_=102965;_<=102969;_++)O[_]=0;for(_=102971;_<=102973;_++)O[_]=0;for(_=102975;_<=102989;_++)O[_]=0;for(_=102990;_<=102992;_++)O[_]=1;for(_=102997;_<=103002;_++)O[_]=0;for(_=103003;_<=103008;_++)O[_]=2;for(_=103009;_<=103011;_++)O[_]=0;for(_=103012;_<=103014;_++)O[_]=2;for(_=103019;_<=103021;_++)O[_]=0;for(_=103022;_<=103024;_++)O[_]=2;for(_=103029;_<=103031;_++)O[_]=0;for(_=103032;_<=103034;_++)O[_]=2;for(_=103065;_<=103068;_++)O[_]=0;for(_=103074;_<=103076;_++)O[_]=0;for(_=103077;_<=103079;_++)O[_]=1;for(_=103080;_<=103082;_++)O[_]=0;for(_=103083;_<=103085;_++)O[_]=2;for(_=103090;_<=103093;_++)O[_]=0;for(_=103097;_<=103099;_++)O[_]=0;for(_=103100;_<=103102;_++)O[_]=2;for(_=103107;_<=103109;_++)O[_]=0;for(_=103110;_<=103112;_++)O[_]=2;for(_=103113;_<=103116;_++)O[_]=0;for(_=103117;_<=103120;_++)O[_]=2;for(_=103153;_<=103157;_++)O[_]=0;for(_=103158;_<=103162;_++)O[_]=2;for(_=103163;_<=103165;_++)O[_]=0;for(_=103166;_<=103168;_++)O[_]=1;for(_=103169;_<=103171;_++)O[_]=2;for(_=103186;_<=103188;_++)O[_]=0;for(_=103189;_<=103191;_++)O[_]=2;for(_=103192;_<=103195;_++)O[_]=0;for(_=103196;_<=103199;_++)O[_]=2;for(_=103200;_<=103224;_++)O[_]=0;for(_=103225;_<=103227;_++)O[_]=1;for(_=103232;_<=103237;_++)O[_]=0;for(_=103238;_<=103243;_++)O[_]=2;for(_=103244;_<=103246;_++)O[_]=0;for(_=103247;_<=103249;_++)O[_]=2;for(_=103254;_<=103256;_++)O[_]=0;for(_=103257;_<=103259;_++)O[_]=2;for(_=103264;_<=103266;_++)O[_]=0;for(_=103267;_<=103269;_++)O[_]=2;for(_=103300;_<=103375;_++)O[_]=0;for(_=103381;_<=103383;_++)O[_]=0;for(_=103384;_<=103386;_++)O[_]=1;for(_=103387;_<=103389;_++)O[_]=0;for(_=103390;_<=103392;_++)O[_]=2;for(_=103397;_<=103399;_++)O[_]=0;for(_=103400;_<=103471;_++)O[_]=2;for(_=103476;_<=103478;_++)O[_]=0;for(_=103479;_<=103481;_++)O[_]=2;for(_=103486;_<=103488;_++)O[_]=0;for(_=103489;_<=103491;_++)O[_]=2;for(_=103492;_<=103495;_++)O[_]=0;for(_=103496;_<=103499;_++)O[_]=2;for(_=103528;_<=103543;_++)O[_]=0;for(_=103544;_<=103548;_++)O[_]=2;for(_=103549;_<=103551;_++)O[_]=0;for(_=103552;_<=103554;_++)O[_]=1;for(_=103555;_<=103557;_++)O[_]=2;for(_=103558;_<=103560;_++)O[_]=0;for(_=103571;_<=103573;_++)O[_]=0;for(_=103574;_<=103576;_++)O[_]=2;for(_=103577;_<=103580;_++)O[_]=0;for(_=103581;_<=103583;_++)O[_]=2;for(_=103595;_<=103694;_++)O[_]=0;for(_=103696;_<=103699;_++)O[_]=0;for(_=103700;_<=103793;_++)O[_]=2;for(_=103794;_<=103890;_++)O[_]=0;for(_=103891;_<=103896;_++)O[_]=2;for(_=103900;_<=103971;_++)O[_]=2;for(_=103972;_<=103977;_++)O[_]=0;for(_=112e3;_<=112101;_++)O[_]=0;const XSe={102113:!0,102100:!0,3857:!0,3785:!0},QSe={4326:!0,3785:!0,3857:!0,102113:!0,102100:!0,104905:!0,104971:!0},HH='PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]',pE=[-20037508342788905e-9,20037508342788905e-9],fE=[-20037508342787e-6,20037508342787e-6],Wne={102113:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:pE,origin:fE,dx:1e-5},102100:{wkTemplate:HH,valid:pE,origin:fE,dx:1e-5},3785:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:pE,origin:fE,dx:1e-5},3857:{wkTemplate:HH,valid:pE,origin:fE,dx:1e-5},4326:{wkTemplate:'GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",{Central_Meridian}],UNIT["Degree",0.0174532925199433]]',altTemplate:'PROJCS["WGS_1984_Plate_Carree",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Plate_Carree"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],UNIT["Degrees",111319.491]]',valid:[-180,180],origin:[-180,90],dx:1e-5},104971:{wkTemplate:'GEOGCS["Mars_2000_(Sphere)",DATUM["Mars_2000_(Sphere)",SPHEROID["Mars_2000_(Sphere)",3396190.0,0.0]],PRIMEM["Reference_Meridian",0.0],UNIT["Degree",0.0174532925199433]]',valid:[-180,180],origin:[-180,90],dx:1e-5},104905:{wkTemplate:'GEOGCS["GCS_Mars_2000",DATUM["D_Mars_2000",SPHEROID["Mars_2000_IAU_IAG",3396190.0,169.8944472236118]],PRIMEM["Reference_Meridian",0.0],UNIT["Degree",0.0174532925199433]]',valid:[-180,180],origin:[-180,90],dx:1e-5}};function Pr(t,e){return t===e||t!=null&&e!=null&&(t.wkid!=null||e.wkid!=null?t.wkid===e.wkid||_v(t)&&_v(e)||e.latestWkid!=null&&t.wkid===e.latestWkid||t.latestWkid!=null&&e.wkid===t.latestWkid:!(!t.wkt||!e.wkt)&&t.wkt.toUpperCase()===e.wkt.toUpperCase())}function Do(t){return hs(t)&&t.wkid&&Wne[t.wkid]||null}function lB(t){return!!hs(t)&&(t.wkid?O[t.wkid]==null:!!t.wkt&&!!/^\s*GEOGCS/i.test(t.wkt))}function e2e(t){return!(uB(t)||hB(t))}function UI(t){return hs(t)&&t.wkid===4326}function Cgt(t){return hs(t)&&t.wkid===vv.CGCS2000}function _v(t){return hs(t)&&t.wkid!=null&&XSe[t.wkid]===!0}function t2e(t){return hs(t)&&t.wkid===32662}function cB(t){return t===vv.GCSMARS2000||t===vv.GCSMARS2000_SPHERE}function uB(t){return hs(t)&&t.wkid!=null&&cB(t.wkid)}function dB(t){return t===vv.GCSMOON2000}function hB(t){return hs(t)&&t.wkid!=null&&dB(t.wkid)}function i2e(t){return hs(t)&&t.wkid!=null&&QSe[t.wkid]===!0}function hs(t){return t!=null&&(t.wkid!=null&&t.wkid>=2e3||t.wkt!=null)}const r2e={wkid:4326,wkt:oc(Wne[4326].wkTemplate,{Central_Meridian:"0.0"})},n2e={wkid:102100,latestWkid:3857},s2e={wkid:32662};function pB(t){return{wkt:`GEOCCS["Spherical geocentric",
    DATUM["Not specified",
      SPHEROID["Sphere",${t.radius},0]],
    PRIMEM["Greenwich",0.0,
      AUTHORITY["EPSG","8901"]],
    UNIT["m",1.0],
    AXIS["Geocentric X",OTHER],
    AXIS["Geocentric Y",EAST],
    AXIS["Geocentric Z",NORTH]
  ]`}}const o2e=pB(Ti),Jne=pB(np),Zne=pB(ng),a2e={wkt:`GEOCCS["WGS 84",
  DATUM["WGS_1984",
    SPHEROID["WGS 84",${Ti.radius},298.257223563,
      AUTHORITY["EPSG","7030"]],
    AUTHORITY["EPSG","6326"]],
  PRIMEM["Greenwich",0,
    AUTHORITY["EPSG","8901"]],
  UNIT["m",1.0,
    AUTHORITY["EPSG","9001"]],
  AXIS["Geocentric X",OTHER],
  AXIS["Geocentric Y",OTHER],
  AXIS["Geocentric Z",NORTH],
  AUTHORITY["EPSG","4978"]
]`};function ZO(t){return t!=null&&(uB(t)||Pr(t,Jne))?np:t!=null&&(hB(t)||Pr(t,Zne))?ng:Ti}function Egt(t){return cB(t)?np:dB(t)?ng:Ti}const Yne=39.37,l2e=Ti.radius*Math.PI/200,Kne=/UNIT\[([^\]]+)\]\]$/i,Q0=O,Xne=/UNIT\[([^\]]+)\]/i,c2e=new Set([4261,4305,4807,4810,4811,4812,4816,4819,4821,4901,4902,37225,104139,104140]),u2e=ln()({meter:"meters",foot:"feet",foot_us:"us-feet",foot_clarke:"clarke-feet",yard_clarke:"clarke-yards",link_clarke:"clarke-links",yard_sears:"sears-yards",foot_sears:"sears-feet",chain_sears:"sears-chains",chain_benoit_1895_b:"benoit-1895-b-chains",yard_indian:"indian-yards",yard_indian_1937:"indian-1937-yards",foot_gold_coast:"gold-coast-feet",chain_sears_1922_truncated:"sears-1922-truncated-chains","50_kilometers":"50-kilometers","150_kilometers":"150-kilometers"}),Fu=t=>t*t,Hp=t=>t*t*t,GI={length:{baseUnit:"meters",units:{millimeters:{inBaseUnits:.001},centimeters:{inBaseUnits:.01},decimeters:{inBaseUnits:.1},meters:{inBaseUnits:1},kilometers:{inBaseUnits:1e3},inches:{inBaseUnits:.0254},feet:{inBaseUnits:.3048},yards:{inBaseUnits:.9144},miles:{inBaseUnits:1609.344},"nautical-miles":{inBaseUnits:1852},"us-feet":{inBaseUnits:1200/3937}}},area:{baseUnit:"square-meters",units:{"square-millimeters":{inBaseUnits:Fu(.001)},"square-centimeters":{inBaseUnits:Fu(.01)},"square-decimeters":{inBaseUnits:Fu(.1)},"square-meters":{inBaseUnits:1},"square-kilometers":{inBaseUnits:Fu(1e3)},"square-inches":{inBaseUnits:Fu(.0254)},"square-feet":{inBaseUnits:Fu(.3048)},"square-yards":{inBaseUnits:Fu(.9144)},"square-miles":{inBaseUnits:Fu(1609.344)},"square-us-feet":{inBaseUnits:Fu(1200/3937)},acres:{inBaseUnits:.0015625*Fu(1609.344)},ares:{inBaseUnits:100},hectares:{inBaseUnits:1e4}}},volume:{baseUnit:"liters",units:{liters:{inBaseUnits:1},"cubic-millimeters":{inBaseUnits:1e3*Hp(.001)},"cubic-centimeters":{inBaseUnits:1e3*Hp(.01)},"cubic-decimeters":{inBaseUnits:1e3*Hp(.1)},"cubic-meters":{inBaseUnits:1e3},"cubic-kilometers":{inBaseUnits:1e3*Hp(1e3)},"cubic-inches":{inBaseUnits:1e3*Hp(.0254)},"cubic-feet":{inBaseUnits:1e3*Hp(.3048)},"cubic-yards":{inBaseUnits:1e3*Hp(.9144)},"cubic-miles":{inBaseUnits:1e3*Hp(1609.344)}}},angle:{baseUnit:"radians",units:{radians:{inBaseUnits:1},degrees:{inBaseUnits:Math.PI/180}}}},d2e=(()=>{const t={};for(const e in GI)for(const i in GI[e].units)t[i]=e;return t})();function h2e(t,e,i){return t*GI[i].units[e].inBaseUnits}function p2e(t,e,i){return t/GI[i].units[e].inBaseUnits}const zk=["metric","imperial","inches","feet","yards","miles","nautical-miles","us-feet","meters","kilometers"],f2e=new Map([["meters","square-meters"],["feet","square-feet"],["us-feet","square-us-feet"]]);function m2e(t){return t==="imperial"||t==="metric"}function zD(t){const e=d2e[t];if(!e)throw new Error("unknown type");return e}function qH(t,e=null){return e=e||zD(t),GI[e].baseUnit===t}function bt(t,e,i){if(e===i)return t;const r=zD(e);if(r!==zD(i))throw new Error("incompatible units");const n=qH(e,r)?t:h2e(t,e,r);return qH(i,r)?n:p2e(n,i,r)}function g2e(t,e,i){switch(i){case"metric":return fB(t,e);case"imperial":return gB(t,e);default:return i}}function y2e(t,e,i){switch(i){case"metric":return mB(t,e);case"imperial":return yB(t,e);default:return i}}function fB(t,e){const i=bt(t,e,"meters");return Math.abs(i)<3e3?"meters":"kilometers"}function mB(t,e){const i=bt(t,e,"meters");return Math.abs(i)<1e5?"meters":"kilometers"}function gB(t,e){const i=bt(t,e,"feet");return Math.abs(i)<1e3?"feet":"miles"}function yB(t,e){const i=bt(t,e,"feet");return Math.abs(i)<1e5?"feet":"miles"}function v2e(t,e){const i=bt(t,e,"square-meters");return Math.abs(i)<3e6?"square-meters":"square-kilometers"}function _2e(t,e){const i=bt(t,e,"square-feet");return Math.abs(i)<1e6?"square-feet":"square-miles"}function Qne(t,e,i){return bt(t,e,"meters")/(i*Math.PI/180)}function ese(t){return u2e.fromJSON(t.toLowerCase())||null}function Iu(t){if(t!=null&&!e2e(t))return 1;const e=ti(t);return e>1e5?1:e}function tse(t){return ti(t)>=ZO(t).metersPerDegree?"meters":iC(t)}function ti(t,e=Ti.metersPerDegree){return b2e(t,!0)??e}function b2e(t,e=!1){const i=t!=null?t.wkid:null,r=t!=null?t.wkt:null;let n=null;if(i){if(cB(i))return np.metersPerDegree;if(dB(i))return ng.metersPerDegree;n=Q0.values[Q0[i]],!n&&e&&c2e.has(i)&&(n=l2e)}else r&&(nse(r)?n=WH(Kne.exec(r),n):rse(r)&&(n=WH(Xne.exec(r),n)));return n}function Mgt(t){return t.isGeographic?1:ti(t)}function WH(t,e){return t&&t[1]?ise(t[1]):e}function ise(t){return parseFloat(t.split(",")[1])}function iC(t){const e=t!=null?t.wkid:null,i=t!=null?t.wkt:null;let r=null;if(e)r=Q0.units[Q0[e]];else if(i){const n=nse(i)?Kne:rse(i)?Xne:null;if(n){const s=n.exec(i);s&&s[1]&&(r=x2e(s[1]))}}return r!=null?ese(r):null}function $gt(t){const e=iC(t);return e!=null&&zk.includes(e)?e:null}function Agt(t){const e=tse(t);return e!=null&&zk.includes(e)?e:null}function kgt(t){const e=iC(t);return e==null?null:f2e.get(e)}function rse(t){return/^GEOCCS/i.test(t)}function nse(t){return/^PROJCS/i.test(t)}const w2e=1e-7;function x2e(t){const e=/[\\"\\']{1}([^\\"\\']+)/.exec(t);let i=e&&e[1];if(!i||!Q0.units.includes(i)){const r=ise(t);i=null;const n=Q0.values;for(let s=0;s<n.length;++s)if(Math.abs(r-n[s])<w2e){i=Q0.units[s];break}}return i}function S2e(t){const e=iC(t);if(e==null)return null;switch(e){case"feet":case"us-feet":case"clarke-feet":case"clarke-yards":case"clarke-links":case"sears-yards":case"sears-feet":case"sears-chains":case"benoit-1895-b-chains":case"indian-yards":case"indian-1937-yards":case"gold-coast-feet":case"sears-1922-truncated-chains":return"imperial";case"50-kilometers":case"150-kilometers":case"meters":return"metric"}return null}const I2e={esriAcres:"acres",esriAres:"ares",esriHectares:"hectares",esriSquareCentimeters:"square-centimeters",esriSquareDecimeters:"square-decimeters",esriSquareFeet:"square-feet",esriSquareInches:"square-inches",esriSquareKilometers:"square-kilometers",esriSquareMeters:"square-meters",esriSquareMiles:"square-miles",esriSquareMillimeters:"square-millimeters",esriSquareUsFeet:"square-us-feet",esriSquareYards:"square-yards"},T2e={esriCentimeters:"centimeters",esriDecimeters:"decimeters",esriFeet:"feet",esriInches:"inches",esriKilometers:"kilometers",esriMeters:"meters",esriMiles:"miles",esriMillimeters:"millimeters",esriNauticalMiles:"nautical-miles",esriYards:"yards"},C2e={esriDUDecimalDegrees:"degrees",esriDURadians:"radians"},E2e=ln()(I2e),M2e=ln()(T2e),Pgt=ln()(C2e);var Bu;let ri=Bu=class extends te{static fromJSON(t){if(!t)return null;if(t.wkid){if(t.wkid===102100)return Bu.WebMercator;if(t.wkid===4326)return Bu.WGS84}const e=new Bu;return e.read(t),e}constructor(t){super(t),this.latestWkid=null,this.wkid=null,this.wkt=null,this.vcsWkid=null,this.latestVcsWkid=null,this.imageCoordinateSystem=null}normalizeCtorArgs(t){return t&&typeof t=="object"?t:{[typeof t=="string"?"wkt":"wkid"]:t}}get isWGS84(){return UI(this)}get isWebMercator(){return _v(this)}get isGeographic(){return lB(this)}get isWrappable(){return i2e(this)}get metersPerUnit(){return ti(this)}get unit(){return iC(this)||(this.isGeographic?"degrees":null)}writeWkt(t,e){this.wkid||(e.wkt=t)}clone(){if(this===Bu.WGS84)return Bu.WGS84;if(this===Bu.WebMercator)return Bu.WebMercator;const t=new Bu;return this.wkid!=null?(t.wkid=this.wkid,this.latestWkid!=null&&(t.latestWkid=this.latestWkid),this.vcsWkid!=null&&(t.vcsWkid=this.vcsWkid),this.latestVcsWkid!=null&&(t.latestVcsWkid=this.latestVcsWkid)):this.wkt!=null&&(t.wkt=this.wkt),this.imageCoordinateSystem&&(t.imageCoordinateSystem=U(this.imageCoordinateSystem)),t}equals(t){if(t==null)return!1;if(this.imageCoordinateSystem||t.imageCoordinateSystem){if(this.imageCoordinateSystem==null||t.imageCoordinateSystem==null)return!1;const{id:e,referenceServiceName:i}=t.imageCoordinateSystem,{geodataXform:r}=t.imageCoordinateSystem,n=this.imageCoordinateSystem;return e==null||r?JSON.stringify(n)===JSON.stringify(t.imageCoordinateSystem):i?n.id===e&&n.referenceServiceName===i:n.id===e}return Pr(this,t)}toJSON(t){return this.write(void 0,t)}};ri.GCS_NAD_1927=null,ri.WGS84=null,ri.WebMercator=null,ri.PlateCarree=null,d([p({readOnly:!0})],ri.prototype,"isWGS84",null),d([p({readOnly:!0})],ri.prototype,"isWebMercator",null),d([p({readOnly:!0})],ri.prototype,"isGeographic",null),d([p({readOnly:!0})],ri.prototype,"isWrappable",null),d([p({type:wt,json:{write:!0}})],ri.prototype,"latestWkid",void 0),d([p({readOnly:!0})],ri.prototype,"metersPerUnit",null),d([p({readOnly:!0})],ri.prototype,"unit",null),d([p({type:wt,json:{write:!0,origins:{"web-scene":{write:{overridePolicy(){return{isRequired:this.wkt==null}}}}}}})],ri.prototype,"wkid",void 0),d([p({type:String,json:{origins:{"web-scene":{write:{overridePolicy(){return{isRequired:this.wkid==null}}}}}}})],ri.prototype,"wkt",void 0),d([ge("wkt"),ge("web-scene","wkt")],ri.prototype,"writeWkt",null),d([p({type:wt,json:{write:!0}})],ri.prototype,"vcsWkid",void 0),d([p({type:wt,json:{write:!0}})],ri.prototype,"latestVcsWkid",void 0),d([p()],ri.prototype,"imageCoordinateSystem",void 0),ri=Bu=d([A("esri.geometry.SpatialReference")],ri),ri.prototype.toJSON.isDefaultToJSON=!0,ri.GCS_NAD_1927=new ri({wkid:4267,wkt:'GEOGCS["GCS_North_American_1927",DATUM["D_North_American_1927",SPHEROID["Clarke_1866",6378206.4,294.9786982]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]]'}),ri.WGS84=new ri(r2e),ri.WebMercator=new ri(n2e),ri.PlateCarree=new ri(s2e),Object.freeze&&(Object.freeze(ri.GCS_NAD_1927),Object.freeze(ri.WGS84),Object.freeze(ri.WebMercator));const Ee=ri,sse="20230626",ose="b81703b48e0b92e492f4cc6b739af02a9af50038",$2e="4.27";let vB=$2e;vB="4.27.6";const A2e={async request(t,e){var a,l;const{default:i}=await W(()=>Promise.resolve().then(()=>Y2e),void 0,import.meta.url),r=t.options,n=r.responseType;r.signal=e==null?void 0:e.signal,r.responseType=n==="native"||n==="native-request-init"?"native-request-init":n&&["blob","json","text"].includes(n)&&((a=jne(t.url))!=null&&a.after)?n:"array-buffer";const s=await i(t.url,r),o={data:s.data,httpStatus:s.httpStatus,ssl:s.ssl};switch((l=s.requestOptions)==null?void 0:l.responseType){case"native-request-init":return delete o.data.signal,o;case"blob":o.data=await o.data.arrayBuffer();break;case"json":o.data=new TextEncoder().encode(JSON.stringify(o.data)).buffer;break;case"text":o.data=new TextEncoder().encode(o.data).buffer}return{result:o,transferList:[o.data]}}};let vt;function Ogt(t){vt=t}function k2e(t){const e=vt==null?void 0:vt.findCredential(t);return e!=null&&e.token?Hne(t,"token",e.token):t}ee("host-webworker");const P2e=["elevation3d.arcgis.com","js.arcgis.com","jsdev.arcgis.com","jsqa.arcgis.com","static.arcgis.com"];function ase(t){const e=yu(t,!0);return!!e&&e.endsWith(".arcgis.com")&&!P2e.includes(e)&&!t.endsWith("/sharing/rest/generateToken")}function O2e(t,e,i=!1,r){return new Promise((n,s)=>{if(zo(r))return void s(JH());let o=()=>{c(),s(new Error(`Unable to load ${e}`))},a=()=>{const u=t;c(),n(u)},l=()=>{if(!t)return;const u=t;c(),u.src="",s(JH())};const c=()=>{ee("esri-image-decode")||(t.removeEventListener("error",o),t.removeEventListener("load",a)),o=null,a=null,t=null,r!=null&&r.removeEventListener("abort",l),l=null,i&&URL.revokeObjectURL(e)};r!=null&&r.addEventListener("abort",l),ee("esri-image-decode")?t.decode().then(a,o):(t.addEventListener("error",o),t.addEventListener("load",a))})}function JH(){try{return new DOMException("Aborted","AbortError")}catch{const t=new Error;return t.name="AbortError",t}}const L2e="Timeout exceeded";function R2e(){return new Error(L2e)}function F2e(t){Lt.request.crossOriginNoCorsDomains||(Lt.request.crossOriginNoCorsDomains={});const e=Lt.request.crossOriginNoCorsDomains;for(let i of t)i=i.toLowerCase(),/^https?:\/\//.test(i)?e[yu(i)??""]=0:(e[yu("http://"+i)??""]=0,e[yu("https://"+i)??""]=0)}function D2e(t){const e=Lt.request.crossOriginNoCorsDomains;if(e){let i=yu(t);if(i)return i=i.toLowerCase(),!Yw(i,Q6())&&e[i]<Date.now()-36e5}return!1}async function N2e(t){var n;const e=Lt.request.crossOriginNoCorsDomains,i=yu(t);e&&i&&(e[i.toLowerCase()]=Date.now());const r=sn(t);t=r.path,((n=r.query)==null?void 0:n.f)==="json"&&(t+="?f=json");try{await fetch(t,{mode:"no-cors",credentials:"include"})}catch{}}async function at(t,e){var c;t instanceof URL&&(t=t.toString()),(e==null?void 0:e.query)instanceof URLSearchParams&&(e.query=eB(e.query.toString().replaceAll("+"," ")));const i=Bv(t),r=JO(t);r||i||(t=ic(t));const n={url:t,requestOptions:{...e}};let s=jne(t);if(s){const u=await q2e(s,n);if(u!=null)return{data:u,getHeader:_B,httpStatus:200,requestOptions:n.requestOptions,url:n.url};s.after||s.error||(s=null)}if(t=n.url,(e=n.requestOptions).responseType==="image"&&(ee("host-webworker")||ee("host-node")))throw kd("request:invalid-parameters",new Error("responseType 'image' is not supported in Web Workers or Node environment"),n);if(e.method==="head"){if(e.body)throw kd("request:invalid-parameters",new Error("body parameter cannot be set when method is 'head'"),n);if(i||r)throw kd("request:invalid-parameters",new Error("data and blob URLs are not supported for method 'head'"),n)}if(await U2e(),jk)return jk.execute(t,e);const o=new AbortController;Fo(e,()=>o.abort());const a={controller:o,credential:void 0,credentialToken:void 0,fetchOptions:void 0,hasToken:!1,interceptor:s,params:n,redoRequest:!1,useIdentity:iu.useIdentity,useProxy:!1,useSSL:!1,withCredentials:!1},l=await J2e(a);return(c=s==null?void 0:s.after)==null||c.call(s,l),l}let jk;const iu=Lt.request,lse="FormData"in globalThis,V2e=[499,498,403,401],z2e=["COM_0056","COM_0057","SB_0008"],j2e=[/\/arcgis\/tokens/i,/\/sharing(\/rest)?\/generatetoken/i,/\/rest\/info/i],_B=()=>null,Bk=Symbol();function B2e(t){const e=yu(t);e&&!at._corsServers.includes(e)&&at._corsServers.push(e)}function ZH(t){const e=yu(t);return!e||e.endsWith(".arcgis.com")||at._corsServers.includes(e)||iB(e)}function kd(t,e,i,r){let n="Error";const s={url:i.url,requestOptions:i.requestOptions,getHeader:_B,ssl:!1};if(e instanceof N)return e.details?(e.details=U(e.details),e.details.url=i.url,e.details.requestOptions=i.requestOptions):e.details=s,e;if(e){const o=r&&(c=>r.headers.get(c)),a=r==null?void 0:r.status,l=e.message;l&&(n=l),o&&(s.getHeader=o),s.httpStatus=(e.httpCode!=null?e.httpCode:e.code)||a||0,s.subCode=e.subcode,s.messageCode=e.messageCode,typeof e.details=="string"?s.messages=[e.details]:s.messages=e.details,s.raw=Bk in e?e[Bk]:e}return ys(e)?wi():new N(t,n,s)}async function U2e(){ee("host-webworker")?jk||(jk=await W(()=>import("./request-7fa3aa67.js"),[],import.meta.url)):at._abortableFetch||(at._abortableFetch=globalThis.fetch.bind(globalThis))}async function jD(){vt||await W(()=>import("./IdentityManager-493a1560.js"),[],import.meta.url)}async function G2e(t){var a;const e=t.params.url,i=t.params.requestOptions,r=t.controller.signal,n=i.body;let s=null,o=null;if(lse&&"HTMLFormElement"in globalThis&&(n instanceof FormData?s=n:n instanceof HTMLFormElement&&(s=new FormData(n))),typeof n=="string"&&(o=n),t.fetchOptions={cache:i.cacheBust&&!("polyfill"in at._abortableFetch)?"no-cache":"default",credentials:"same-origin",headers:i.headers||{},method:i.method==="head"?"HEAD":"GET",mode:"cors",priority:iu.priority,redirect:"follow",signal:r},(s||o)&&(t.fetchOptions.body=s||o),i.authMode==="anonymous"&&(t.useIdentity=!1),t.hasToken=!!(/token=/i.test(e)||(a=i.query)!=null&&a.token||s!=null&&s.get("token")),!t.hasToken&&Lt.apiKey&&ase(e)&&(i.query||(i.query={}),i.query.token=Lt.apiKey,t.hasToken=!0),t.useIdentity&&!t.hasToken&&!t.credentialToken&&!cse(e)&&!zo(r)){let l;i.authMode==="immediate"?(await jD(),l=await vt.getCredential(e,{signal:r}),t.credential=l):i.authMode==="no-prompt"?(await jD(),l=await vt.getCredential(e,{prompt:!1,signal:r}).catch(()=>{}),t.credential=l):vt&&(l=vt.findCredential(e)),l&&(t.credentialToken=l.token,t.useSSL=!!l.ssl)}}function cse(t){return j2e.some(e=>e.test(t))}async function H2e(t){let e=t.params.url;const i=t.params.requestOptions,r=t.fetchOptions??{},n=JO(e)||Bv(e),s=i.responseType||"json",o=n?0:i.timeout!=null?i.timeout:iu.timeout;let a=!1;if(!n){t.useSSL&&(e=sB(e)),i.cacheBust&&r.cache==="default"&&(e=Hne(e,"request.preventCache",Date.now()));let f={...i.query};t.credentialToken&&(f.token=t.credentialToken);let m=Zw(f);ee("esri-url-encodes-apostrophe")&&(m=m.replaceAll("'","%27"));const g=e.length+1+m.length;let y;a=i.method==="delete"||i.method==="post"||i.method==="put"||!!i.body||g>iu.maxUrlLength;const v=i.useProxy||!!WO(e);if(v){const b=RSe(e);y=b.path,!a&&y.length+1+g>iu.maxUrlLength&&(a=!0),b.query&&(f={...b.query,...f})}if(r.method==="HEAD"&&(a||v)){if(a)throw g>iu.maxUrlLength?kd("request:invalid-parameters",new Error("URL exceeds maximum length"),t.params):kd("request:invalid-parameters",new Error("cannot use POST request when method is 'head'"),t.params);if(v)throw kd("request:invalid-parameters",new Error("cannot use proxy when method is 'head'"),t.params)}if(a?(r.method=i.method==="delete"?"DELETE":i.method==="put"?"PUT":"POST",i.body?e=T$(e,f):(r.body=Zw(f),r.headers||(r.headers={}),r.headers["Content-Type"]="application/x-www-form-urlencoded")):e=T$(e,f),v&&(t.useProxy=!0,e=`${y}?${e}`),f.token&&lse&&r.body instanceof FormData&&!SSe(e)&&r.body.set("token",f.token),i.hasOwnProperty("withCredentials"))t.withCredentials=i.withCredentials;else if(!Yw(e,Q6())){if(iB(e))t.withCredentials=!0;else if(vt){const b=vt.findServerInfo(e);b!=null&&b.webTierAuth&&(t.withCredentials=!0)}}t.withCredentials&&(r.credentials="include",D2e(e)&&await N2e(a?T$(e,f):e))}let l,c,u=0,h=!1;o>0&&(u=setTimeout(()=>{h=!0,t.controller.abort()},o));try{if(i.responseType==="native-request-init")c=r,c.url=e;else if(i.responseType!=="image"||r.cache!=="default"||r.method!=="GET"||a||W2e(i.headers)||!n&&!t.useProxy&&iu.proxyUrl&&!ZH(e)){if(l=await at._abortableFetch(e,r),t.useProxy||B2e(e),i.responseType==="native")c=l;else if(r.method!=="HEAD")if(l.ok){switch(s){case"array-buffer":c=await l.arrayBuffer();break;case"blob":case"image":c=await l.blob();break;default:c=await l.text()}if(u&&(clearTimeout(u),u=0),s==="json"||s==="xml"||s==="document")if(c)switch(s){case"json":c=JSON.parse(c);break;case"xml":c=YH(c,"application/xml");break;case"document":c=YH(c,"text/html")}else c=null;if(c){if(s==="array-buffer"||s==="blob"){const f=l.headers.get("Content-Type");if(f&&/application\/json|text\/plain/i.test(f)&&c[s==="blob"?"size":"byteLength"]<=750)try{const m=await new Response(c).json();m.error&&(c=m)}catch{}}s==="image"&&c instanceof Blob&&(c=await KH(URL.createObjectURL(c),t,!0))}}else{c=await l.text();try{c=JSON.parse(c)}catch{}}}else c=await KH(e,t)}catch(f){if(f.name==="AbortError")throw h?R2e():wi("Request canceled");if(!(!l&&f instanceof TypeError&&iu.proxyUrl)||i.body||i.method==="delete"||i.method==="head"||i.method==="post"||i.method==="put"||t.useProxy||ZH(e))throw f;t.redoRequest=!0,FSe({proxyUrl:iu.proxyUrl,urlPrefix:yu(e)??""})}finally{u&&clearTimeout(u)}return[l,c]}async function q2e(t,e){if(t.responseData!=null)return t.responseData;if(t.headers&&(e.requestOptions.headers={...e.requestOptions.headers,...t.headers}),t.query&&(e.requestOptions.query={...e.requestOptions.query,...t.query}),t.before){let i,r;try{r=await t.before(e)}catch(n){i=kd("request:interceptor",n,e)}if((r instanceof Error||r instanceof N)&&(i=kd("request:interceptor",r,e)),i)throw t.error&&t.error(i),i;return r}}function W2e(t){if(t){for(const e of Object.getOwnPropertyNames(t))if(t[e])return!0}return!1}function YH(t,e){let i;try{i=new DOMParser().parseFromString(t,e)}catch{}if(!i||i.getElementsByTagName("parsererror").length)throw new SyntaxError("XML Parse error");return i}async function J2e(t){var s,o;let e,i;await G2e(t);try{do[e,i]=await H2e(t);while(!await Z2e(t,e,i))}catch(a){const l=kd("request:server",a,t.params,e);throw l.details.ssl=t.useSSL,(s=t.interceptor)!=null&&s.error&&t.interceptor.error(l),l}const r=t.params.url;if(i&&/\/sharing\/rest\/(accounts|portals)\/self/i.test(r)){if(!t.hasToken&&!t.credentialToken&&((o=i.user)!=null&&o.username)&&!iB(r)){const a=yu(r,!0);a&&iu.trustedServers.push(a)}Array.isArray(i.authorizedCrossOriginNoCorsDomains)&&F2e(i.authorizedCrossOriginNoCorsDomains)}const n=t.credential;if(n&&vt){const a=vt.findServerInfo(n.server);let l=a==null?void 0:a.owningSystemUrl;if(l){l=l.replace(/\/?$/,"/sharing");const c=vt.findCredential(l,n.userId);c&&vt._getIdenticalSvcIdx(l,c)===-1&&c.resources.unshift(l)}}return{data:i,getHeader:e?a=>e==null?void 0:e.headers.get(a):_B,httpStatus:(e==null?void 0:e.status)??200,requestOptions:t.params.requestOptions,ssl:t.useSSL,url:t.params.url}}async function Z2e(t,e,i){var c;if(t.redoRequest)return t.redoRequest=!1,!1;const r=t.params.requestOptions;if(!e||r.responseType==="native"||r.responseType==="native-request-init")return!0;let n,s;if(i&&(i.error?n=i.error:i.status==="error"&&Array.isArray(i.messages)&&(n={...i},n[Bk]=i,n.details=i.messages)),!n&&!e.ok)throw n=new Error(`Unable to load ${e.url} status: ${e.status}`),n[Bk]=i,n;let o,a=null;n&&(s=Number(n.code),a=n.hasOwnProperty("subcode")?Number(n.subcode):null,o=n.messageCode,o=o==null?void 0:o.toUpperCase());const l=r.authMode;if(s===403&&(a===4||(c=n.message)!=null&&c.toLowerCase().includes("ssl")&&!n.message.toLowerCase().includes("permission"))){if(!t.useSSL)return t.useSSL=!0,!1}else if(!t.hasToken&&t.useIdentity&&(l!=="no-prompt"||s===498)&&s!==void 0&&V2e.includes(s)&&!cse(t.params.url)&&(s!==403||o&&!z2e.includes(o)&&(a==null||a===2&&t.credentialToken))){await jD();try{const u=await vt.getCredential(t.params.url,{error:kd("request:server",n,t.params),prompt:l!=="no-prompt",signal:t.controller.signal,token:t.credentialToken});return t.credential=u,t.credentialToken=u.token,t.useSSL=t.useSSL||u.ssl,!1}catch(u){if(l==="no-prompt")return t.credential=void 0,t.credentialToken=void 0,!1;n=u}}if(n)throw n;return!0}function KH(t,e,i=!1){const r=e.controller.signal,n=new Image;return e.withCredentials?n.crossOrigin="use-credentials":n.crossOrigin="anonymous",n.alt="",n.fetchPriority=iu.priority,n.src=t,O2e(n,t,i,r)}at._abortableFetch=null,at._corsServers=["https://server.arcgisonline.com","https://services.arcgisonline.com"];const Y2e=Object.freeze(Object.defineProperty({__proto__:null,default:at},Symbol.toStringTag,{value:"Module"}));function ae(t,e,i){let r,n;return e===void 0||Array.isArray(e)?(n=t,i=e,r=[void 0]):(n=e,r=Array.isArray(t)?t:[t]),(s,o)=>{const a=s.constructor.prototype;r.forEach(l=>{const c=fne(s,l,n);c.read&&typeof c.read=="object"||(c.read={}),c.read.reader=a[o],i&&(c.read.source=(c.read.source||[]).concat(i))})}}let Uu=class extends te{constructor(...e){super(...e),this.type=null,this.hasM=!1,this.hasZ=!1,this.spatialReference=Ee.WGS84}get cache(){return this.commitProperty("spatialReference"),{}}get extent(){return null}readSpatialReference(e,i){if(e instanceof Ee)return e;if(e!=null){const r=new Ee;return r.read(e,i),r}return e}clone(){return console.warn(".clone() is not implemented for "+this.declaredClass),null}clearCache(){this.notifyChange("cache")}getCacheValue(e){return this.cache[e]}setCacheValue(e,i){this.cache[e]=i}};d([p()],Uu.prototype,"type",void 0),d([p({readOnly:!0})],Uu.prototype,"cache",null),d([p({readOnly:!0})],Uu.prototype,"extent",null),d([p({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],Uu.prototype,"hasM",void 0),d([p({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],Uu.prototype,"hasZ",void 0),d([p({type:Ee,json:{write:!0},value:Ee.WGS84})],Uu.prototype,"spatialReference",void 0),d([ae("spatialReference")],Uu.prototype,"readSpatialReference",null),Uu=d([A("esri.geometry.Geometry")],Uu);const Ep=Uu,K2e=Object.prototype.toString;function X2e(t){const e="__accessorMetadata__"in t?lr(t):t;return function(...i){if(i.push(e),typeof i[2]=="number")throw new Error("Using @cast has parameter decorator is not supported since 4.16");return Q2e.apply(this,i)}}function Q2e(t,e,i,r){jO(t,e).cast=r}function eIe(t){return(e,i)=>{jO(e,t).cast=e[i]}}function tt(...t){if(t.length!==3||typeof t[1]!="string")return t.length===1&&K2e.call(t[0])==="[object Function]"?X2e(t[0]):t.length===1&&typeof t[0]=="string"?eIe(t[0]):void 0}function tIe(t,e){const i=t.x-e.x,r=t.y-e.y,n=t.hasZ&&e.hasZ?t.z-e.z:0;return Math.sqrt(i*i+r*r+n*n)}const iIe=57.29577951308232,rIe=.017453292519943;function XH(t){return t*iIe}function QH(t){return t*rIe}function Rgt(t){return Math.PI/2-2*Math.atan(Math.exp(-t/Ti.radius))}function BD(t){return t.wkid!=null||t.wkt!=null}const h3=[0,0];function Uk(t,e,i,r,n){const s=t,o=n;if(o.spatialReference=i,"x"in s&&"x"in o)[o.x,o.y]=e(s.x,s.y,h3,r);else if("xmin"in s&&"xmin"in o)[o.xmin,o.ymin]=e(s.xmin,s.ymin,h3,r),[o.xmax,o.ymax]=e(s.xmax,s.ymax,h3,r);else if("paths"in s&&"paths"in o||"rings"in s&&"rings"in o){const a="paths"in s?s.paths:s.rings,l=[];let c;for(let u=0;u<a.length;u++){const h=a[u];c=[],l.push(c);for(let f=0;f<h.length;f++)c.push(e(h[f][0],h[f][1],[0,0],r)),h[f].length>2&&c[f].push(h[f][2]),h[f].length>3&&c[f].push(h[f][3])}"paths"in o?o.paths=l:o.rings=l}else if("points"in s&&"points"in o){const a=s.points,l=[];for(let c=0;c<a.length;c++)l[c]=e(a[c][0],a[c][1],[0,0],r),a[c].length>2&&l[c].push(a[c][2]),a[c].length>3&&l[c].push(a[c][3]);o.points=l}return n}function C$(t,e){const i=t&&(BD(t)?t:t.spatialReference),r=e&&(BD(e)?e:e.spatialReference);return!(t&&"type"in t&&t.type==="mesh"||e&&"type"in e&&e.type==="mesh"||!i||!r)&&(!!Pr(r,i)||_v(r)&&UI(i)||_v(i)&&UI(r))}function rC(t,e){if(t==null)return null;const i=t.spatialReference,r=e&&(BD(e)?e:e.spatialReference);return C$(i,r)?Pr(i,r)?U(t):_v(r)?Uk(t,nw,Ee.WebMercator,!1,U(t)):UI(r)?Uk(t,H2,Ee.WGS84,!1,U(t)):null:null}function nw(t,e,i=[0,0]){e>89.99999?e=89.99999:e<-89.99999&&(e=-89.99999);const r=QH(e);return i[0]=QH(t)*Ti.radius,i[1]=Ti.halfSemiMajorAxis*Math.log((1+Math.sin(r))/(1-Math.sin(r))),i}function H2(t,e,i=[0,0],r=!1){const n=XH(t/Ti.radius);return i[0]=r?n:n-360*Math.floor((n+180)/360),i[1]=XH(Math.PI/2-2*Math.atan(Math.exp(-e/Ti.radius))),i}function sp(t,e=!1,i=U(t)){return Uk(t,nw,Ee.WebMercator,e,i)}function j0(t,e=!1,i=U(t)){return Uk(t,H2,Ee.WGS84,e,i)}var E$;const vx=[0,0];function eq(t){return t&&(t.declaredClass==="esri.geometry.SpatialReference"||t.wkid!=null)}let wo=E$=class extends Ep{static copy(t,e){e._set("x",t._get("x")),e._set("y",t._get("y")),e._set("z",t._get("z")),e._set("m",t._get("m"));const i=t._get("spatialReference");e._set("spatialReference",Object.isFrozen(i)?i:i.clone())}constructor(...t){super(...t),this.x=0,this.y=0,this.z=void 0,this.m=void 0,this.type="point"}normalizeCtorArgs(t,e,i,r,n){let s;if(Array.isArray(t))s=t,n=e,t=s[0],e=s[1],i=s[2],r=s[3];else if(t&&typeof t=="object"){if(s=t,t=s.x!=null?s.x:s.longitude,e=s.y!=null?s.y:s.latitude,i=s.z,r=s.m,(n=s.spatialReference)&&n.declaredClass!=="esri.geometry.SpatialReference"&&(n=new Ee(n)),s.longitude!=null||s.latitude!=null){if(s.longitude==null)ie.getLogger(this).warn(".longitude=","Latitude was defined without longitude");else if(s.latitude==null)ie.getLogger(this).warn(".latitude=","Longitude was defined without latitude");else if(!s.declaredClass&&n&&n.isWebMercator){const a=nw(s.longitude,s.latitude,vx);t=a[0],e=a[1]}}}else eq(i)?(n=i,i=null):eq(r)&&(n=r,r=null);const o={x:t,y:e};return o.x==null&&o.y!=null?ie.getLogger(this).warn(".y=","Y coordinate was defined without an X coordinate"):o.y==null&&o.x!=null&&ie.getLogger(this).warn(".x=","X coordinate was defined without a Y coordinate"),n!=null&&(o.spatialReference=n),i!=null&&(o.z=i),r!=null&&(o.m=r),o}get cache(){return this.commitProperty("x"),this.commitProperty("y"),this.commitProperty("z"),this.commitProperty("m"),this.commitProperty("spatialReference"),{}}get hasM(){return this.m!==void 0}set hasM(t){t!==(this._get("m")!==void 0)&&(this._set("m",t?0:void 0),this._set("hasM",t))}get hasZ(){return this.z!==void 0}set hasZ(t){t!==(this._get("z")!==void 0)&&(this._set("z",t?0:void 0),this._set("hasZ",t))}get latitude(){const{spatialReference:t,x:e,y:i}=this;if(t){if(t.isWebMercator)return H2(e,i,vx)[1];if(t.isGeographic)return i}return null}set latitude(t){const{spatialReference:e,x:i}=this;t!=null&&e&&(e.isWebMercator?this._set("y",nw(i,t,vx)[1]):e.isGeographic&&this._set("y",t),this._set("latitude",t))}get longitude(){const{x:t,y:e,spatialReference:i}=this;if(i){if(i.isWebMercator)return H2(t,e,vx)[0];if(i.isGeographic)return t}return null}set longitude(t){const{y:e,spatialReference:i}=this;t!=null&&i&&(i.isWebMercator?this._set("x",nw(t,e,vx)[0]):i.isGeographic&&this._set("x",t),this._set("longitude",t))}writeX(t,e,i){e[i]=isNaN(t)?"NaN":t}readX(t){return typeof t=="string"?NaN:t}clone(){const t=new E$;return t.x=this.x,t.y=this.y,t.z=this.z,t.m=this.m,t.spatialReference=this.spatialReference,t}copy(t){return E$.copy(t,this),this}equals(t){if(t==null)return!1;const{x:e,y:i,z:r,m:n,spatialReference:s}=this,{z:o,m:a}=t;let{x:l,y:c,spatialReference:u}=t;if(!s.equals(u))if(s.isWebMercator&&u.isWGS84)[l,c]=nw(l,c),u=s;else{if(!s.isWGS84||!u.isWebMercator)return!1;[l,c]=H2(l,c),u=s}return e===l&&i===c&&r===o&&n===a&&s.wkid===u.wkid}offset(t,e,i){return this.x+=t,this.y+=e,i!=null&&(this.z=(this.z??0)+i),this}normalize(){if(!this.spatialReference)return this;const t=Do(this.spatialReference);if(!t)return this;let e=this.x;const[i,r]=t.valid,n=2*r;let s;return e>r?(s=Math.ceil(Math.abs(e-r)/n),e-=s*n):e<i&&(s=Math.ceil(Math.abs(e-i)/n),e+=s*n),this._set("x",e),this}distance(t){return tIe(this,t)}toArray(){const t=this.hasZ,e=this.hasM;return t&&e?[this.x,this.y,this.z,this.m]:t?[this.x,this.y,this.z]:e?[this.x,this.y,this.m]:[this.x,this.y]}toJSON(t){return this.write({},t)}};d([p({readOnly:!0})],wo.prototype,"cache",null),d([p({type:Boolean,json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],wo.prototype,"hasM",null),d([p({type:Boolean,json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],wo.prototype,"hasZ",null),d([p({type:Number})],wo.prototype,"latitude",null),d([p({type:Number})],wo.prototype,"longitude",null),d([p({type:Number,json:{type:[Number,String],write:{isRequired:!0,allowNull:!0}}}),tt(t=>isNaN(t)?t:ql(t))],wo.prototype,"x",void 0),d([ge("x")],wo.prototype,"writeX",null),d([ae("x")],wo.prototype,"readX",null),d([p({type:Number,json:{write:!0}})],wo.prototype,"y",void 0),d([p({type:Number,json:{write:{overridePolicy(){return{enabled:this.hasZ}}}}})],wo.prototype,"z",void 0),d([p({type:Number,json:{write:{overridePolicy(){return{enabled:this.hasM}}}}})],wo.prototype,"m",void 0),wo=E$=d([A("esri.geometry.Point")],wo),wo.prototype.toJSON.isDefaultToJSON=!0;const fe=wo,p3=[0,0];function YO(t,e){return e!=null&&Ao(t,e.x,e.y,e.z)}function Fgt(t,e){if(!e.points||e.points.length)return!1;for(const i of e.points)if(!Xw(t,i))return!1;return!0}function nIe(t,e){const{xmin:i,ymin:r,zmin:n,xmax:s,ymax:o,zmax:a}=e;return t.hasZ&&e.hasZ?Ao(t,i,r,n)&&Ao(t,i,o,n)&&Ao(t,s,o,n)&&Ao(t,s,r,n)&&Ao(t,i,r,a)&&Ao(t,i,o,a)&&Ao(t,s,o,a)&&Ao(t,s,r,a):Ao(t,i,r)&&Ao(t,i,o)&&Ao(t,s,o)&&Ao(t,s,r)}function Xw(t,e){return Ao(t,e[0],e[1])}function sIe(t,e){return Ao(t,e[0],e[1],e[2])}function Ao(t,e,i,r){return e>=t.xmin&&e<=t.xmax&&i>=t.ymin&&i<=t.ymax&&(r==null||!t.hasZ||r>=t.zmin&&r<=t.zmax)}function use(t,e){return p3[1]=e.y,p3[0]=e.x,oIe(t,p3)}function oIe(t,e){return dse(t.rings,e)}function dse(t,e){if(!t)return!1;if(aIe(t))return tq(!1,t,e);let i=!1;for(let r=0,n=t.length;r<n;r++)i=tq(i,t[r],e);return i}function aIe(t){return!Array.isArray(t[0][0])}function tq(t,e,i){const[r,n]=i;let s=t,o=0;for(let a=0,l=e.length;a<l;a++){o++,o===l&&(o=0);const[c,u]=e[a],[h,f]=e[o];(u<n&&f>=n||f<n&&u>=n)&&c+(n-u)/(f-u)*(h-c)<r&&(s=!s)}return s}function lIe(t,e){return YO(t,e)}function cIe(t,e){const i=t.hasZ&&e.hasZ;let r,n,s;if(t.xmin<=e.xmin){if(r=e.xmin,t.xmax<r)return!1}else if(r=t.xmin,e.xmax<r)return!1;if(t.ymin<=e.ymin){if(n=e.ymin,t.ymax<n)return!1}else if(n=t.ymin,e.ymax<n)return!1;if(i&&e.hasZ){if(t.zmin<=e.zmin){if(s=e.zmin,t.zmax<s)return!1}else if(s=t.zmin,e.zmax<s)return!1}return!0}function uIe(t,e){const{points:i,hasZ:r}=e,n=r?sIe:Xw;for(const s of i)if(n(t,s))return!0;return!1}const bv=[0,0],wv=[0,0],xv=[0,0],Sv=[0,0],dIe=[bv,wv,xv,Sv],hse=[[xv,bv],[bv,wv],[wv,Sv],[Sv,xv]];function hIe(t,e){return pIe(t,e.rings)}function pIe(t,e){bv[0]=t.xmin,bv[1]=t.ymax,wv[0]=t.xmax,wv[1]=t.ymax,xv[0]=t.xmin,xv[1]=t.ymin,Sv[0]=t.xmax,Sv[1]=t.ymin;for(const i of dIe)if(dse(e,i))return!0;for(const i of e){if(!i.length)continue;let r=i[0];if(Xw(t,r))return!0;for(let n=1;n<i.length;n++){const s=i[n];if(Xw(t,s)||pse(r,s,hse))return!0;r=s}}return!1}function fIe(t,e){bv[0]=t.xmin,bv[1]=t.ymax,wv[0]=t.xmax,wv[1]=t.ymax,xv[0]=t.xmin,xv[1]=t.ymin,Sv[0]=t.xmax,Sv[1]=t.ymin;const i=e.paths;for(const r of i){if(!i.length)continue;let n=r[0];if(Xw(t,n))return!0;for(let s=1;s<r.length;s++){const o=r[s];if(Xw(t,o)||pse(n,o,hse))return!0;n=o}}return!1}const Qn=[0,0];function mIe(t){for(let e=0;e<t.length;e++){const i=t[e];for(let n=0;n<i.length-1;n++){const s=i[n],o=i[n+1];for(let a=e+1;a<t.length;a++)for(let l=0;l<t[a].length-1;l++){const c=t[a][l],u=t[a][l+1];if(HI(s,o,c,u,Qn)&&!(Qn[0]===s[0]&&Qn[1]===s[1]||Qn[0]===c[0]&&Qn[1]===c[1]||Qn[0]===o[0]&&Qn[1]===o[1]||Qn[0]===u[0]&&Qn[1]===u[1]))return!0}}const r=i.length;if(!(r<=4))for(let n=0;n<r-3;n++){let s=r-1;n===0&&(s=r-2);const o=i[n],a=i[n+1];for(let l=n+2;l<s;l++){const c=i[l],u=i[l+1];if(HI(o,a,c,u,Qn)&&!(Qn[0]===o[0]&&Qn[1]===o[1]||Qn[0]===c[0]&&Qn[1]===c[1]||Qn[0]===a[0]&&Qn[1]===a[1]||Qn[0]===u[0]&&Qn[1]===u[1]))return!0}}}return!1}function pse(t,e,i){for(let r=0;r<i.length;r++)if(HI(t,e,i[r][0],i[r][1]))return!0;return!1}function HI(t,e,i,r,n){const[s,o]=t,[a,l]=e,[c,u]=i,[h,f]=r,m=h-c,g=s-c,y=a-s,v=f-u,b=o-u,w=l-o,x=v*y-m*w;if(x===0)return!1;const S=(m*b-v*g)/x,I=(y*b-w*g)/x;return S>=0&&S<=1&&I>=0&&I<=1&&(n&&(n[0]=s+S*(a-s),n[1]=o+S*(l-o)),!0)}function gIe(t){switch(t){case"esriGeometryEnvelope":case"extent":return cIe;case"esriGeometryMultipoint":case"multipoint":return uIe;case"esriGeometryPoint":case"point":return lIe;case"esriGeometryPolygon":case"polygon":return hIe;case"esriGeometryPolyline":case"polyline":return fIe}}var wl;function yIe(t){return t&&(t.declaredClass==="esri.geometry.SpatialReference"||t.wkid!=null)}function qp(t,e,i){return e==null?i:i==null?e:t(e,i)}let Nn=wl=class extends Ep{constructor(...t){super(...t),this.type="extent",this.xmin=0,this.ymin=0,this.mmin=void 0,this.zmin=void 0,this.xmax=0,this.ymax=0,this.mmax=void 0,this.zmax=void 0}normalizeCtorArgs(t,e,i,r,n){return yIe(t)?{spatialReference:t,xmin:0,ymin:0,xmax:0,ymax:0}:typeof t=="object"?(t.spatialReference=t.spatialReference==null?Ee.WGS84:t.spatialReference,t):{xmin:t,ymin:e,xmax:i,ymax:r,spatialReference:n??Ee.WGS84}}static fromBounds(t,e){return new wl({xmin:t[0],ymin:t[1],xmax:t[2],ymax:t[3],spatialReference:e})}static fromPoint(t){return new wl({xmin:t.x,ymin:t.y,zmin:t.z,xmax:t.x,ymax:t.y,zmax:t.z,spatialReference:t.spatialReference})}get cache(){return this.commitProperty("xmin"),this.commitProperty("ymin"),this.commitProperty("zmin"),this.commitProperty("mmin"),this.commitProperty("xmax"),this.commitProperty("ymax"),this.commitProperty("zmax"),this.commitProperty("mmax"),this.commitProperty("spatialReference"),{}}get center(){const t=new fe({x:.5*(this.xmin+this.xmax),y:.5*(this.ymin+this.ymax),spatialReference:this.spatialReference});return this.hasZ&&(t.z=.5*(this.zmin+this.zmax)),this.hasM&&(t.m=.5*(this.mmin+this.mmax)),t}get extent(){return this.clone()}get hasM(){return this.mmin!=null&&this.mmax!=null}get hasZ(){return this.zmin!=null&&this.zmax!=null}get height(){return Math.abs(this.ymax-this.ymin)}get width(){return Math.abs(this.xmax-this.xmin)}centerAt(t){const e=this.center;return t.z!=null&&this.hasZ?this.offset(t.x-e.x,t.y-e.y,t.z-e.z):this.offset(t.x-e.x,t.y-e.y)}clone(){const t=new wl;return t.xmin=this.xmin,t.ymin=this.ymin,t.xmax=this.xmax,t.ymax=this.ymax,t.spatialReference=this.spatialReference,this.zmin!=null&&(t.zmin=this.zmin,t.zmax=this.zmax),this.mmin!=null&&(t.mmin=this.mmin,t.mmax=this.mmax),t}contains(t){if(!t)return!1;const e=this.spatialReference,i=t.spatialReference;return e&&i&&!e.equals(i)&&C$(e,i)&&(t=e.isWebMercator?sp(t):j0(t,!0)),t.type==="point"?YO(this,t):t.type==="extent"&&nIe(this,t)}equals(t){if(this===t)return!0;if(t==null)return!1;const e=this.spatialReference,i=t.spatialReference;return e&&i&&!e.equals(i)&&C$(e,i)&&(t=e.isWebMercator?sp(t):j0(t,!0)),this.xmin===t.xmin&&this.ymin===t.ymin&&this.zmin===t.zmin&&this.mmin===t.mmin&&this.xmax===t.xmax&&this.ymax===t.ymax&&this.zmax===t.zmax&&this.mmax===t.mmax}expand(t){const e=.5*(1-t),i=this.width*e,r=this.height*e;if(this.xmin+=i,this.ymin+=r,this.xmax-=i,this.ymax-=r,this.hasZ){const n=(this.zmax-this.zmin)*e;this.zmin+=n,this.zmax-=n}if(this.hasM){const n=(this.mmax-this.mmin)*e;this.mmin+=n,this.mmax-=n}return this}intersects(t){if(t==null)return!1;t.type==="mesh"&&(t=t.extent);const e=this.spatialReference,i=t.spatialReference;return e&&i&&!Pr(e,i)&&C$(e,i)&&(t=e.isWebMercator?sp(t):j0(t,!0)),gIe(t.type)(this,t)}normalize(){const t=this._normalize(!1,!0);return Array.isArray(t)?t:[t]}offset(t,e,i){return this.xmin+=t,this.ymin+=e,this.xmax+=t,this.ymax+=e,i!=null&&(this.zmin+=i,this.zmax+=i),this}shiftCentralMeridian(){return this._normalize(!0)}union(t){return this===t||(this.xmin=Math.min(this.xmin,t.xmin),this.ymin=Math.min(this.ymin,t.ymin),this.xmax=Math.max(this.xmax,t.xmax),this.ymax=Math.max(this.ymax,t.ymax),(this.hasZ||t.hasZ)&&(this.zmin=qp(Math.min,this.zmin,t.zmin),this.zmax=qp(Math.max,this.zmax,t.zmax)),(this.hasM||t.hasM)&&(this.mmin=qp(Math.min,this.mmin,t.mmin),this.mmax=qp(Math.max,this.mmax,t.mmax))),this}intersection(t){return this===t?this:t!=null&&this.intersects(t)?(this.xmin=Math.max(this.xmin,t.xmin),this.ymin=Math.max(this.ymin,t.ymin),this.xmax=Math.min(this.xmax,t.xmax),this.ymax=Math.min(this.ymax,t.ymax),(this.hasZ||t.hasZ)&&(this.zmin=qp(Math.max,this.zmin,t.zmin),this.zmax=qp(Math.min,this.zmax,t.zmax)),(this.hasM||t.hasM)&&(this.mmin=qp(Math.max,this.mmin,t.mmin),this.mmax=qp(Math.min,this.mmax,t.mmax)),this):null}toJSON(t){return this.write({},t)}_shiftCM(t=Do(this.spatialReference)){if(!t||!this.spatialReference)return this;const e=this.spatialReference,i=this._getCM(t);if(i){const r=e.isWebMercator?j0(i):i;this.xmin-=i.x,this.xmax-=i.x,e.isWebMercator||(r.x=this._normalizeX(r.x,t).x),this.spatialReference=new Ee(oc((e.isWGS84?t.altTemplate:null)??t.wkTemplate,{Central_Meridian:r.x}))}return this}_getCM(t){let e=null;const[i,r]=t.valid,n=this.xmin,s=this.xmax;return n>=i&&n<=r&&s>=i&&s<=r||(e=this.center),e}_normalize(t,e,i){const r=this.spatialReference;if(!r)return this;const n=i??Do(r);if(n==null)return this;const s=this._getParts(n).map(l=>l.extent);if(s.length<2)return s[0]||this;if(s.length>2)return t?this._shiftCM(n):this.set({xmin:n.valid[0],xmax:n.valid[1]});if(t)return this._shiftCM(n);if(e)return s;let o=!0,a=!0;return s.forEach(l=>{l.hasZ||(o=!1),l.hasM||(a=!1)}),{rings:s.map(l=>{const c=[[l.xmin,l.ymin],[l.xmin,l.ymax],[l.xmax,l.ymax],[l.xmax,l.ymin],[l.xmin,l.ymin]];if(o){const u=(l.zmax-l.zmin)/2;for(let h=0;h<c.length;h++)c[h].push(u)}if(a){const u=(l.mmax-l.mmin)/2;for(let h=0;h<c.length;h++)c[h].push(u)}return c}),hasZ:o,hasM:a,spatialReference:r}}_getParts(t){let e=this.cache._parts;if(!e){e=[];const{ymin:n,ymax:s,spatialReference:o}=this,a=this.width,l=this.xmin,c=this.xmax;let u;t=t||Do(o);const[h,f]=t.valid;u=this._normalizeX(this.xmin,t);const m=u.x,g=u.frameId;u=this._normalizeX(this.xmax,t);const y=u.x,v=u.frameId,b=m===y&&a>0;if(a>2*f){const w=new wl(l<c?m:y,n,f,s,o),x=new wl(h,n,l<c?y:m,s,o),S=new wl(0,n,f,s,o),I=new wl(h,n,0,s,o),T=[],C=[];w.contains(S)&&T.push(g),w.contains(I)&&C.push(g),x.contains(S)&&T.push(v),x.contains(I)&&C.push(v);for(let E=g+1;E<v;E++)T.push(E),C.push(E);e.push({extent:w,frameIds:[g]},{extent:x,frameIds:[v]},{extent:S,frameIds:T},{extent:I,frameIds:C})}else m>y||b?e.push({extent:new wl(m,n,f,s,o),frameIds:[g]},{extent:new wl(h,n,y,s,o),frameIds:[v]}):e.push({extent:new wl(m,n,y,s,o),frameIds:[g]});this.cache._parts=e}const i=this.hasZ,r=this.hasM;if(i||r){const n={};i&&(n.zmin=this.zmin,n.zmax=this.zmax),r&&(n.mmin=this.mmin,n.mmax=this.mmax);for(let s=0;s<e.length;s++)e[s].extent.set(n)}return e}_normalizeX(t,e){const[i,r]=e.valid,n=2*r;let s,o=0;return t>r?(s=Math.ceil(Math.abs(t-r)/n),t-=s*n,o=s):t<i&&(s=Math.ceil(Math.abs(t-i)/n),t+=s*n,o=-s),{x:t,frameId:o}}};d([p({readOnly:!0})],Nn.prototype,"cache",null),d([p({readOnly:!0})],Nn.prototype,"center",null),d([p({readOnly:!0})],Nn.prototype,"extent",null),d([p({readOnly:!0,json:{write:{enabled:!1,overridePolicy:null}}})],Nn.prototype,"hasM",null),d([p({readOnly:!0,json:{write:{enabled:!1,overridePolicy:null}}})],Nn.prototype,"hasZ",null),d([p({readOnly:!0})],Nn.prototype,"height",null),d([p({readOnly:!0})],Nn.prototype,"width",null),d([p({type:Number,json:{type:[Number,String],write:{enabled:!0,allowNull:!0}}})],Nn.prototype,"xmin",void 0),d([p({type:Number,json:{write:!0}})],Nn.prototype,"ymin",void 0),d([p({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasM}}}}})],Nn.prototype,"mmin",void 0),d([p({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasZ}}}}})],Nn.prototype,"zmin",void 0),d([p({type:Number,json:{write:!0}})],Nn.prototype,"xmax",void 0),d([p({type:Number,json:{write:!0}})],Nn.prototype,"ymax",void 0),d([p({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasM}}}}})],Nn.prototype,"mmax",void 0),d([p({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasZ}}}}})],Nn.prototype,"zmax",void 0),Nn=wl=d([A("esri.geometry.Extent")],Nn),Nn.prototype.toJSON.isDefaultToJSON=!0;const Re=Nn;let q2;var _re,bre;const vIe=((_re=globalThis.esriConfig)==null?void 0:_re.locale)??((bre=globalThis.dojoConfig)==null?void 0:bre.locale);function fse(){var t;return vIe??((t=globalThis.navigator)==null?void 0:t.language)??"en"}function Mn(){return q2===void 0&&(q2=fse()),q2}function _Ie(t=Mn()){const e=/^([a-zA-Z]{2,3})(?:[_\-]\w+)*$/.exec(t);return e==null?void 0:e[1].toLowerCase()}const W2=[];function nC(t){return W2.push(t),{remove(){W2.splice(W2.indexOf(t),1)}}}const UD=[];function bB(t){return UD.push(t),{remove(){W2.splice(UD.indexOf(t),1)}}}function bIe(){const t=fse();q2!==t&&(q2=t,[...UD].forEach(e=>{e.call(null,t)}),[...W2].forEach(e=>{e.call(null,t)}))}var wre;(wre=globalThis.addEventListener)==null||wre.call(globalThis,"languagechange",bIe);let mE;function wIe(t){return mE&&!mE.destroyed||(mE=t()),mE}var GD;const xIe=new He({avgRating:"avg-rating",numRatings:"num-ratings",numComments:"num-comments",numViews:"num-views"});let xl=GD=class extends he{constructor(t){super(t),this.categories=null,this.disableExtraQuery=!1,this.extent=null,this.filter=null,this.num=10,this.query=null,this.sortField=null,this.start=1}get sortOrder(){return this._get("sortOrder")||"asc"}set sortOrder(t){t!=="asc"&&t!=="desc"||this._set("sortOrder",t)}clone(){return new GD({categories:this.categories?U(this.categories):null,disableExtraQuery:this.disableExtraQuery,extent:this.extent?this.extent.clone():null,filter:this.filter,num:this.num,query:this.query,sortField:this.sortField,sortOrder:this.sortOrder,start:this.start})}toRequestOptions(t,e){let i=[];this.categories&&(i=this.categories.map(o=>Array.isArray(o)?JSON.stringify(o):o));let r="";if(this.extent){const o=rC(this.extent,Ee.WGS84);o!=null&&(r=`${o.xmin},${o.ymin},${o.xmax},${o.ymax}`)}let n=this.query;!this.disableExtraQuery&&t.extraQuery&&(n="("+n+")"+t.extraQuery);const s={categories:i,bbox:r,q:n,filter:this.filter,num:this.num,sortField:null,sortOrder:null,start:this.start};return this.sortField&&(s.sortField=this.sortField.split(",").map(o=>xIe.toJSON(o.trim())).join(","),s.sortOrder=this.sortOrder),{query:{...e,...s}}}};d([p()],xl.prototype,"categories",void 0),d([p()],xl.prototype,"disableExtraQuery",void 0),d([p({type:Re})],xl.prototype,"extent",void 0),d([p()],xl.prototype,"filter",void 0),d([p()],xl.prototype,"num",void 0),d([p()],xl.prototype,"query",void 0),d([p()],xl.prototype,"sortField",void 0),d([p()],xl.prototype,"sortOrder",null),d([p()],xl.prototype,"start",void 0),xl=GD=d([A("esri.portal.PortalQueryParams")],xl);const xd=xl;let ay=class extends he{constructor(e){super(e),this.nextQueryParams=null,this.queryParams=null,this.results=null,this.total=null}};d([p()],ay.prototype,"nextQueryParams",void 0),d([p()],ay.prototype,"queryParams",void 0),d([p()],ay.prototype,"results",void 0),d([p()],ay.prototype,"total",void 0),ay=d([A("esri.portal.PortalQueryResult")],ay);const SIe=ay;let lh=class extends te{constructor(e){super(e),this.created=null,this.id=null,this.portal=null,this.title=null,this.username=null}get url(){const e=this.get("portal.restUrl");return e?`${e}/content/users/${this.username}/${this.id}`:null}toJSON(){throw new N("internal:not-yet-implemented","PortalFolder.toJSON is not yet implemented")}};d([p({type:Date})],lh.prototype,"created",void 0),d([p()],lh.prototype,"id",void 0),d([p()],lh.prototype,"portal",void 0),d([p()],lh.prototype,"title",void 0),d([p({readOnly:!0})],lh.prototype,"url",null),d([p()],lh.prototype,"username",void 0),lh=d([A("esri.portal.PortalFolder")],lh);const IIe=lh;let Vn=class extends te{constructor(e){super(e),this.access=null,this.created=null,this.description=null,this.id=null,this.isInvitationOnly=!1,this.modified=null,this.owner=null,this.portal=null,this.snippet=null,this.sortField=null,this.sortOrder=null,this.tags=null,this.title=null}get thumbnailUrl(){var r;const e=this.url,i=this.thumbnail;return e&&i&&this.portal?(r=this.portal)==null?void 0:r.normalizeUrl(`${e}/info/${i}?f=json`):null}get url(){const e=this.get("portal.restUrl");return e?e+"/community/groups/"+this.id:null}fetchCategorySchema(e){return us(this.portal).request(this.url+"/categorySchema",e).then(i=>{const r=i.categorySchema||[];return r.some(n=>n.source==="contentCategorySetsGroupQuery.LivingAtlas")?this._fetchCategorySchemaSet("LivingAtlas",e):r})}fetchMembers(e){return us(this.portal).request(this.url+"/users",e)}getThumbnailUrl(e){let i=this.thumbnailUrl;return i&&e&&(i+=`&w=${e}`),i}toJSON(){throw new N("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented")}queryItems(e,i){let r=lr(xd,e);const n=us(this.portal);return parseFloat(n.currentVersion)>5?(r=r||new xd,n.queryPortal(`/content/groups/${this.id}/search`,r,"PortalItem",i)):(r=r?r.clone():new xd,r.query="group:"+this.id+(r.query?" "+r.query:""),n.queryItems(r,i))}_fetchCategorySchemaSet(e,i){const r=us(this.portal);return r.fetchSelf(r.authMode,!0,i).then(n=>{const s=n.contentCategorySetsGroupQuery;if(s){const o=new xd;return o.disableExtraQuery=!0,o.num=1,o.query=s,r.queryGroups(o,i)}throw new N("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery value not found")}).then(n=>{if(n.total){const s=n.results[0],o=new xd;return o.num=1,o.query=`typekeywords:"${e}"`,s.queryItems(o,i)}throw new N("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery group not found")}).then(n=>n.total?n.results[0].fetchData("json",i).then(s=>{const o=s&&s.categorySchema;return o&&o.length?o:[]}):[])}};d([p()],Vn.prototype,"access",void 0),d([p({type:Date})],Vn.prototype,"created",void 0),d([p()],Vn.prototype,"description",void 0),d([p()],Vn.prototype,"id",void 0),d([p()],Vn.prototype,"isInvitationOnly",void 0),d([p({type:Date})],Vn.prototype,"modified",void 0),d([p()],Vn.prototype,"owner",void 0),d([p()],Vn.prototype,"portal",void 0),d([p()],Vn.prototype,"snippet",void 0),d([p()],Vn.prototype,"sortField",void 0),d([p()],Vn.prototype,"sortOrder",void 0),d([p()],Vn.prototype,"tags",void 0),d([p()],Vn.prototype,"thumbnail",void 0),d([p({readOnly:!0})],Vn.prototype,"thumbnailUrl",null),d([p()],Vn.prototype,"title",void 0),d([p({readOnly:!0})],Vn.prototype,"url",null),Vn=d([A("esri.portal.PortalGroup")],Vn);const HD=Vn,TIe=Object.freeze(Object.defineProperty({__proto__:null,default:HD},Symbol.toStringTag,{value:"Module"}));var qD;let qi=qD=class extends te{constructor(...t){super(...t),this.access=null,this.created=null,this.culture=null,this.description=null,this.email=null,this.fullName=null,this.modified=null,this.orgId=null,this.portal=null,this.preferredView=null,this.privileges=null,this.region=null,this.role=null,this.roleId=null,this.sourceJSON=null,this.units=null,this.username=null,this.userType=null}get thumbnailUrl(){const t=this.url,e=this.thumbnail;return t&&e?this.portal.normalizeUrl(`${t}/info/${e}?f=json`):null}get userContentUrl(){const t=this.get("portal.restUrl");return t?`${t}/content/users/${this.username}`:null}get url(){const t=this.get("portal.restUrl");return t?`${t}/community/users/${this.username}`:null}addItem(t){const e=t&&t.item,i=t&&t.data,r=t&&t.folder,n={method:"post"};e&&(n.query=e.createPostQuery(),i!=null&&(typeof i=="string"?n.query.text=i:typeof i=="object"&&(n.query.text=JSON.stringify(i))));let s=this.userContentUrl;return r&&(s+="/"+(typeof r=="string"?r:r.id)),this.portal.request(s+"/addItem",n).then(o=>(e.id=o.id,e.portal=this.portal,e.loaded?e.reload():e.load()))}deleteItem(t){let e=this.userContentUrl;return t.ownerFolder&&(e+="/"+t.ownerFolder),this.portal.request(e+`/items/${t.id}/delete`,{method:"post"}).then(()=>{t.id=null,t.portal=null})}deleteItems(t){const e=this.userContentUrl+"/deleteItems",i=t.map(r=>r.id);if(i.length){const r={method:"post",query:{items:i.join(",")}};return this.portal.request(e,r).then(()=>{t.forEach(n=>{n.id=null,n.portal=null})})}return Promise.resolve(void 0)}fetchFolders(){const t={query:{num:1}};return this.portal.request(this.userContentUrl??"",t).then(e=>{let i;return i=e&&e.folders?e.folders.map(r=>{const n=IIe.fromJSON(r);return n.portal=this.portal,n}):[],i})}fetchGroups(){return this.portal.request(this.url??"").then(t=>{let e;return e=t&&t.groups?t.groups.map(i=>{const r=HD.fromJSON(i);return r.portal=this.portal,r}):[],e})}fetchItems(t){const e=t??{};let i,r=this.userContentUrl??"";return e.folder&&(r+="/"+e.folder.id),W(()=>Promise.resolve().then(()=>mse),void 0,import.meta.url).then(({default:n})=>{i=n;const s={folders:!1,num:e.num||10,start:e.start||1,sortField:e.sortField||"created",sortOrder:e.sortOrder||"asc"};return this.portal.request(r,{query:s})}).then(n=>{let s;return n&&n.items?(s=n.items.map(o=>{const a=i.fromJSON(o);return a.portal=this.portal,a}),Promise.all(s.map(o=>o.load())).catch(o=>o).then(()=>({items:s,nextStart:n.nextStart,total:n.total}))):{items:[],nextStart:-1,total:0}})}fetchTags(){return this.portal.request(this.url+"/tags").then(t=>t.tags)}getThumbnailUrl(t){let e=this.thumbnailUrl;return e&&t&&(e+=`&w=${t}`),e}queryFavorites(t){return this.favGroupId?(this._favGroup||(this._favGroup=new HD({id:this.favGroupId,portal:this.portal})),this._favGroup.queryItems(t)):Promise.reject(new N("internal:unknown","Unknown internal error",{internalError:"Unknown favGroupId"}))}toJSON(){throw new N("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented")}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");const e=new qD;return e.sourceJSON=t,e.read(t),e}};d([p()],qi.prototype,"access",void 0),d([p({type:Date})],qi.prototype,"created",void 0),d([p()],qi.prototype,"culture",void 0),d([p()],qi.prototype,"description",void 0),d([p()],qi.prototype,"email",void 0),d([p()],qi.prototype,"favGroupId",void 0),d([p()],qi.prototype,"fullName",void 0),d([p({type:Date})],qi.prototype,"modified",void 0),d([p()],qi.prototype,"orgId",void 0),d([p()],qi.prototype,"portal",void 0),d([p()],qi.prototype,"preferredView",void 0),d([p()],qi.prototype,"privileges",void 0),d([p()],qi.prototype,"region",void 0),d([p()],qi.prototype,"role",void 0),d([p()],qi.prototype,"roleId",void 0),d([p()],qi.prototype,"sourceJSON",void 0),d([p()],qi.prototype,"thumbnail",void 0),d([p({readOnly:!0})],qi.prototype,"thumbnailUrl",null),d([p()],qi.prototype,"units",void 0),d([p({readOnly:!0})],qi.prototype,"userContentUrl",null),d([p({readOnly:!0})],qi.prototype,"url",null),d([p()],qi.prototype,"username",void 0),d([p()],qi.prototype,"userType",void 0),qi=qD=d([A("esri.portal.PortalUser")],qi);const wB=qi,CIe=Object.freeze(Object.defineProperty({__proto__:null,default:wB},Symbol.toStringTag,{value:"Module"}));var ch;let gE;const iq={PortalGroup:()=>W(()=>Promise.resolve().then(()=>TIe),void 0,import.meta.url),PortalItem:()=>W(()=>Promise.resolve().then(()=>mse),void 0,import.meta.url),PortalUser:()=>W(()=>Promise.resolve().then(()=>CIe),void 0,import.meta.url)};let ve=ch=class extends R1(Su){constructor(t){super(t),this._esriIdCredentialCreateHandle=null,this.access=null,this.allSSL=!1,this.authMode="auto",this.authorizedCrossOriginDomains=null,this.basemapGalleryGroupQuery=null,this.basemapGalleryGroupQuery3D=null,this.bingKey=null,this.canListApps=!1,this.canListData=!1,this.canListPreProvisionedItems=!1,this.canProvisionDirectPurchase=!1,this.canSearchPublic=!0,this.canShareBingPublic=!1,this.canSharePublic=!1,this.canSignInArcGIS=!1,this.canSignInIDP=!1,this.colorSetsGroupQuery=null,this.commentsEnabled=!1,this.created=null,this.culture=null,this.customBaseUrl=null,this.defaultBasemap=null,this.defaultDevBasemap=null,this.defaultExtent=null,this.defaultVectorBasemap=null,this.description=null,this.devBasemapGalleryGroupQuery=null,this.eueiEnabled=null,this.featuredGroups=null,this.featuredItemsGroupQuery=null,this.galleryTemplatesGroupQuery=null,this.livingAtlasGroupQuery=null,this.hasCategorySchema=!1,this.helperServices=null,this.homePageFeaturedContent=null,this.homePageFeaturedContentCount=null,this.httpPort=null,this.httpsPort=null,this.id=null,this.ipCntryCode=null,this.isPortal=!1,this.isReadOnly=!1,this.layerTemplatesGroupQuery=null,this.maxTokenExpirationMinutes=null,this.modified=null,this.name=null,this.portalHostname=null,this.portalMode=null,this.portalProperties=null,this.region=null,this.rotatorPanels=null,this.showHomePageDescription=!1,this.sourceJSON=null,this.supportsHostedServices=!1,this.symbolSetsGroupQuery=null,this.templatesGroupQuery=null,this.units=null,this.url=Lt.portalUrl,this.urlKey=null,this.user=null,this.use3dBasemaps=!0,this.useStandardizedQuery=!1,this.useVectorBasemaps=!1,this.vectorBasemapGalleryGroupQuery=null}normalizeCtorArgs(t){return typeof t=="string"?{url:t}:t}destroy(){rq.unregister(this),this.defaultBasemap=je(this.defaultBasemap),this.defaultDevBasemap=je(this.defaultDevBasemap),this.defaultVectorBasemap=je(this.defaultVectorBasemap),this._esriIdCredentialCreateHandle=$i(this._esriIdCredentialCreateHandle)}readAuthorizedCrossOriginDomains(t){if(t)for(const e of t)Lt.request.trustedServers.includes(e)||Lt.request.trustedServers.push(e);return t}readDefaultBasemap(t){return this._readBasemap(t)}readDefaultDevBasemap(t){return this._readBasemap(t)}readDefaultVectorBasemap(t){return this._readBasemap(t)}get extraQuery(){const t=!(this.user&&this.user.orgId)||this.canSearchPublic;return this.id&&!t?` AND orgid:${this.id}`:null}get isOrganization(){return!!this.access}get itemPageUrl(){return this.url?`${this.url}/home/item.html`:null}get restUrl(){let t=this.url;if(t){const e=t.indexOf("/sharing");t=e>0?t.substring(0,e):this.url.replace(/\/+$/,""),t+="/sharing/rest"}return t}get thumbnailUrl(){const t=this.restUrl,e=this.thumbnail;return t&&e?this._normalizeSSL(t+"/portals/self/resources/"+e):null}readUrlKey(t){return t&&t.toLowerCase()}readUser(t){let e=null;return t&&(e=wB.fromJSON(t),e.portal=this),e}load(t){const e=W(()=>Promise.resolve().then(()=>ZIe),void 0,import.meta.url).then(({default:i})=>{_t(t),gE=i}).then(()=>this.sourceJSON?this.sourceJSON:this.fetchSelf(this.authMode,!1,t)).then(i=>{var r;if(vt){const n=vt;this.credential=n.findCredential(this.restUrl),this.credential||this.authMode!==ch.AUTH_MODE_AUTO||((r=this._esriIdCredentialCreateHandle)==null||r.remove(),this._esriIdCredentialCreateHandle=n.on("credential-create",EIe(new WeakRef(this))),rq.register(this,this._esriIdCredentialCreateHandle,this))}this.sourceJSON=i,this.read(i)});return this.addResolvingPromise(e),Promise.resolve(this)}async createElevationLayers(){await this.load();const t=this._getHelperService("defaultElevationLayers"),e=(await W(()=>import("./ElevationLayer-468d6482.js"),["./ElevationLayer-468d6482.js","./ArcGISCachedService-ecc7eed8.js","./TileInfoTilemapCache-73282a1b.js","./WorkerHandle-51c271c4.js"],import.meta.url)).default;return t?t.map(i=>new e({id:i.id,url:i.url})):[]}async fetchBasemaps(t,e){const i=await this._fetchBasemaps(t,e);if((e==null?void 0:e.include3d)===!0&&this.use3dBasemaps!==!1){const r=await this._fetchBasemaps3D(t,e);i.unshift(...r)}return i}fetchCategorySchema(t){return this.hasCategorySchema?this.request(this.restUrl+"/portals/self/categorySchema",t).then(e=>e.categorySchema):zo(t)?Promise.reject(wi()):Promise.resolve([])}fetchFeaturedGroups(t){const e=this.featuredGroups,i=new xd;if(i.num=100,i.sortField="title",e&&e.length){const r=[];for(const n of e)r.push(`(title:"${n.title}" AND owner:${n.owner})`);return i.query=r.join(" OR "),this.queryGroups(i,t).then(n=>n.results)}return zo(t)?Promise.reject(wi()):Promise.resolve([])}fetchRegions(t){var i;const e=((i=this.user)==null?void 0:i.culture)||this.culture||Mn();return this.request(this.restUrl+"/portals/regions",{...t,query:{culture:e}})}fetchSettings(t){var i;const e=((i=this.user)==null?void 0:i.culture)||this.culture||Mn();return this.request(this.restUrl+"/portals/self/settings",{...t,query:{culture:e}})}static getDefault(){return wIe(()=>new ch)}queryGroups(t,e){return this.queryPortal("/community/groups",t,"PortalGroup",e)}queryItems(t,e){return this.queryPortal("/search",t,"PortalItem",e)}queryUsers(t,e){return t.sortField||(t.sortField="username"),this.queryPortal("/community/users",t,"PortalUser",e)}fetchSelf(t=this.authMode,e=!1,i){const r=this.restUrl+"/portals/self",n={authMode:t,query:{culture:Mn().toLowerCase()},...i};return n.authMode==="auto"&&(n.authMode="no-prompt"),e&&(n.query.default=!0),this.request(r,n)}queryPortal(t,e,i,r){const n=lr(xd,e),s=o=>this.request(this.restUrl+t,{...n.toRequestOptions(this),...r}).then(a=>{const l=n.clone();return l.start=a.nextStart,new SIe({nextQueryParams:l,queryParams:n,total:a.total,results:ch._resultsToTypedArray(o,{portal:this},a,r)})}).then(a=>Promise.all(a.results.map(l=>typeof l.when=="function"?l.when():a)).then(()=>a,l=>(Lo(l),a)));return i&&iq[i]?iq[i]().then(({default:o})=>(_t(r),s(o))):s()}signIn(){if(this.authMode===ch.AUTH_MODE_ANONYMOUS)return Promise.reject(new N("portal:invalid-auth-mode",`Current "authMode"' is "${this.authMode}"`));if(this.loadStatus==="failed")return Promise.reject(this.loadError);const t=e=>Promise.resolve().then(()=>this.loadStatus==="not-loaded"?(e||(this.authMode="immediate"),this.load().then(()=>null)):this.loadStatus==="loading"?this.load().then(()=>this.credential?null:(this.credential=e,this.fetchSelf("immediate"))):this.user&&this.credential===e?null:(this.credential=e,this.fetchSelf("immediate"))).then(i=>{i&&(this.sourceJSON=i,this.read(i))});return vt?vt.getCredential(this.restUrl).then(e=>t(e)):t(this.credential)}normalizeUrl(t){const e=this.credential&&this.credential.token;return this._normalizeSSL(e?t+(t.includes("?")?"&":"?")+"token="+e:t)}requestToTypedArray(t,e,i){return this.request(t,e).then(r=>{const n=ch._resultsToTypedArray(i,{portal:this},r);return Promise.all(n.map(s=>typeof s.when=="function"?s.when():r)).then(()=>n,()=>n)})}request(t,e={}){const i={f:"json",...e.query},{authMode:r=this.authMode===ch.AUTH_MODE_ANONYMOUS?"anonymous":"auto",body:n=null,cacheBust:s=!1,method:o="auto",responseType:a="json",signal:l}=e,c={authMode:r,body:n,cacheBust:s,method:o,query:i,responseType:a,timeout:0,signal:l};return at(this._normalizeSSL(t),c).then(u=>u.data)}toJSON(){throw new N("internal:not-yet-implemented","Portal.toJSON is not yet implemented")}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");return new ch({sourceJSON:t})}_getHelperService(t){const e=this.helperServices&&this.helperServices[t];if(!e)throw new N("portal:service-not-found",`The \`helperServices\` do not include an entry named "${t}"`);return e}async _fetchBasemaps(t,e){const i=new xd;i.query=t||(Lt.apiKey&&ase(this.url)?this.devBasemapGalleryGroupQuery:this.useVectorBasemaps?this.vectorBasemapGalleryGroupQuery:this.basemapGalleryGroupQuery),i.disableExtraQuery=!0;const r=await this.queryGroups(i,e);if(!r.total)return[];const n=r.results[0];i.num=100,i.query='type:"Web Map" -type:"Web Application"',i.sortField=n.sortField||"name",i.sortOrder=n.sortOrder||"desc";const s=await n.queryItems(i,e);return s.total?s.results.filter(o=>o.type==="Web Map").map(o=>new gE({portalItem:o})):[]}async _fetchBasemaps3D(t,e){const i=t||this.basemapGalleryGroupQuery3D;if(!i)return[];const r=new xd({query:i,disableExtraQuery:!0}),n=await this.queryGroups(r,e);if(!n.total)return[];const s=n.results[0];r.num=100,r.query='type:"Web Scene"',r.sortField=s.sortField||"name",r.sortOrder=s.sortOrder||"desc";const o=await s.queryItems(r,e);return o.total?o.results.filter(a=>a.type==="Web Scene").map(a=>new gE({portalItem:a})):[]}_normalizeSSL(t){return t.replace(/^http:/i,"https:").replace(":7080",":7443")}_readBasemap(t){if(t){const e=gE.fromJSON(t);return e.portalItem={portal:this},e}return null}static _resultsToTypedArray(t,e,i,r){let n=[];if(i){const s=r!=null?r.signal:null;n=i.listings||i.notifications||i.userInvitations||i.tags||i.items||i.groups||i.comments||i.provisions||i.results||i.relatedItems||i,(t||e)&&(n=n.map(o=>{const a=Object.assign(t?t.fromJSON(o):o,e);return typeof a.load=="function"&&a.load(s),a}))}else n=[];return n}};ve.AUTH_MODE_ANONYMOUS="anonymous",ve.AUTH_MODE_AUTO="auto",ve.AUTH_MODE_IMMEDIATE="immediate",d([p()],ve.prototype,"access",void 0),d([p()],ve.prototype,"allSSL",void 0),d([p()],ve.prototype,"authMode",void 0),d([p()],ve.prototype,"authorizedCrossOriginDomains",void 0),d([ae("authorizedCrossOriginDomains")],ve.prototype,"readAuthorizedCrossOriginDomains",null),d([p()],ve.prototype,"basemapGalleryGroupQuery",void 0),d([p({json:{name:"3DBasemapGalleryGroupQuery"}})],ve.prototype,"basemapGalleryGroupQuery3D",void 0),d([p()],ve.prototype,"bingKey",void 0),d([p()],ve.prototype,"canListApps",void 0),d([p()],ve.prototype,"canListData",void 0),d([p()],ve.prototype,"canListPreProvisionedItems",void 0),d([p()],ve.prototype,"canProvisionDirectPurchase",void 0),d([p()],ve.prototype,"canSearchPublic",void 0),d([p()],ve.prototype,"canShareBingPublic",void 0),d([p()],ve.prototype,"canSharePublic",void 0),d([p()],ve.prototype,"canSignInArcGIS",void 0),d([p()],ve.prototype,"canSignInIDP",void 0),d([p()],ve.prototype,"colorSetsGroupQuery",void 0),d([p()],ve.prototype,"commentsEnabled",void 0),d([p({type:Date})],ve.prototype,"created",void 0),d([p()],ve.prototype,"credential",void 0),d([p()],ve.prototype,"culture",void 0),d([p()],ve.prototype,"currentVersion",void 0),d([p()],ve.prototype,"customBaseUrl",void 0),d([p()],ve.prototype,"defaultBasemap",void 0),d([ae("defaultBasemap")],ve.prototype,"readDefaultBasemap",null),d([p()],ve.prototype,"defaultDevBasemap",void 0),d([ae("defaultDevBasemap")],ve.prototype,"readDefaultDevBasemap",null),d([p({type:Re})],ve.prototype,"defaultExtent",void 0),d([p()],ve.prototype,"defaultVectorBasemap",void 0),d([ae("defaultVectorBasemap")],ve.prototype,"readDefaultVectorBasemap",null),d([p()],ve.prototype,"description",void 0),d([p()],ve.prototype,"devBasemapGalleryGroupQuery",void 0),d([p()],ve.prototype,"eueiEnabled",void 0),d([p({readOnly:!0})],ve.prototype,"extraQuery",null),d([p()],ve.prototype,"featuredGroups",void 0),d([p()],ve.prototype,"featuredItemsGroupQuery",void 0),d([p()],ve.prototype,"galleryTemplatesGroupQuery",void 0),d([p()],ve.prototype,"livingAtlasGroupQuery",void 0),d([p()],ve.prototype,"hasCategorySchema",void 0),d([p()],ve.prototype,"helpBase",void 0),d([p()],ve.prototype,"helperServices",void 0),d([p()],ve.prototype,"helpMap",void 0),d([p()],ve.prototype,"homePageFeaturedContent",void 0),d([p()],ve.prototype,"homePageFeaturedContentCount",void 0),d([p()],ve.prototype,"httpPort",void 0),d([p()],ve.prototype,"httpsPort",void 0),d([p()],ve.prototype,"id",void 0),d([p()],ve.prototype,"ipCntryCode",void 0),d([p({readOnly:!0})],ve.prototype,"isOrganization",null),d([p()],ve.prototype,"isPortal",void 0),d([p()],ve.prototype,"isReadOnly",void 0),d([p({readOnly:!0})],ve.prototype,"itemPageUrl",null),d([p()],ve.prototype,"layerTemplatesGroupQuery",void 0),d([p()],ve.prototype,"maxTokenExpirationMinutes",void 0),d([p({type:Date})],ve.prototype,"modified",void 0),d([p()],ve.prototype,"name",void 0),d([p()],ve.prototype,"portalHostname",void 0),d([p()],ve.prototype,"portalMode",void 0),d([p()],ve.prototype,"portalProperties",void 0),d([p()],ve.prototype,"region",void 0),d([p({readOnly:!0})],ve.prototype,"restUrl",null),d([p()],ve.prototype,"rotatorPanels",void 0),d([p()],ve.prototype,"showHomePageDescription",void 0),d([p()],ve.prototype,"sourceJSON",void 0),d([p()],ve.prototype,"staticImagesUrl",void 0),d([p({json:{name:"2DStylesGroupQuery"}})],ve.prototype,"stylesGroupQuery2d",void 0),d([p({json:{name:"stylesGroupQuery"}})],ve.prototype,"stylesGroupQuery3d",void 0),d([p()],ve.prototype,"supportsHostedServices",void 0),d([p()],ve.prototype,"symbolSetsGroupQuery",void 0),d([p()],ve.prototype,"templatesGroupQuery",void 0),d([p()],ve.prototype,"thumbnail",void 0),d([p({readOnly:!0})],ve.prototype,"thumbnailUrl",null),d([p()],ve.prototype,"units",void 0),d([p()],ve.prototype,"url",void 0),d([p()],ve.prototype,"urlKey",void 0),d([ae("urlKey")],ve.prototype,"readUrlKey",null),d([p()],ve.prototype,"user",void 0),d([ae("user")],ve.prototype,"readUser",null),d([p()],ve.prototype,"use3dBasemaps",void 0),d([p()],ve.prototype,"useStandardizedQuery",void 0),d([p()],ve.prototype,"useVectorBasemaps",void 0),d([p()],ve.prototype,"vectorBasemapGalleryGroupQuery",void 0),ve=ch=d([A("esri.portal.Portal")],ve);const on=ve,rq=new FinalizationRegistry(t=>{t.remove()});function EIe(t){const e=vt;return()=>{const i=t.deref();i&&e.findCredential(i.restUrl)&&i.signIn().catch(()=>{})}}const MIe=ie.getLogger("esri.assets");function Tt(t){if(!Lt.assetsPath)throw MIe.errorOnce("The API assets location needs to be set using config.assetsPath. More information: https://arcg.is/1OzLe50"),new N("assets:path-not-set","config.assetsPath is not set");return Kw(Lt.assetsPath,t)}let uh=class extends he{constructor(e){super(e),this.portalItem=null}normalizeCtorArgs(e){return e&&e.portalItem&&e.path?{...e,path:this._normalizePath(e.path,e.portalItem)}:e}set path(e){e!=null&&il(e)?ie.getLogger(this).error("portalitemresource:invalid-path","A portal item resource path must be relative"):this._set("path",e)}_castPath(e){return this._normalizePath(e,this.portalItem)}get url(){return this.portalItem&&this.path?`${this.portalItem.itemUrl}/resources/${this.path}`:null}get cdnUrl(){return this.portalItem&&this.path?`${this.portalItem.itemCdnUrl}/resources/${this.path}`:null}get itemRelativeUrl(){return this.portalItem&&this.path?`./resources/${this.path}`:null}fetch(e="json",i){const r=this.cdnUrl;if(r==null)throw new N("portal-item-resource:fetch","Portal item resource does not refer to a valid item or path");return this.portalItem.portal.request(r,{responseType:e,query:{token:this.portalItem.apiKey},signal:i==null?void 0:i.signal})}async update(e,i){const{addOrUpdateResource:r}=await W(()=>import("./resourceUtils-ae8bbc09.js"),[],import.meta.url);return r(this,"update",e,i)}hasPath(){return this.path!=null}_normalizePath(e,i){return e==null?e:(e=e.replace(/^\/+/,""),i!=null&&il(e)&&(e=rB(e,i.itemUrl)),e==null?void 0:e.replace(/^\/+/,"").replace(/^(\.\/)?resources\//,""))}};d([p()],uh.prototype,"portalItem",void 0),d([p({type:String,value:null})],uh.prototype,"path",null),d([tt("path")],uh.prototype,"_castPath",null),d([p({type:String,readOnly:!0})],uh.prototype,"url",null),d([p({type:String,readOnly:!0})],uh.prototype,"cdnUrl",null),d([p({type:String,readOnly:!0})],uh.prototype,"itemRelativeUrl",null),uh=d([A("esri.portal.PortalItemResource")],uh);const $Ie=uh;let gS=class extends he{constructor(e){super(e),this.created=null,this.rating=null}};d([p()],gS.prototype,"created",void 0),d([p()],gS.prototype,"rating",void 0),gS=d([A("esri.portal.PortalRating")],gS);const f3=gS;var ly;const AIe=new Set(["Map Service","Feature Service","Feature Collection","Scene Service","Image Service","Stream Service","Vector Tile Service","GeoJson","CSV","KML","WFS","WMTS","WMS","Feed"]),kIe=new Set(["KML","GeoJson","CSV"]);let nt=ly=class extends R1(Su){static from(t){return jv(ly,t)}constructor(t){super(t),this.access=null,this.accessInformation=null,this.apiKey=null,this.applicationProxies=null,this.avgRating=null,this.categories=null,this.created=null,this.culture=null,this.description=null,this.extent=null,this.groupCategories=null,this.id=null,this.isOrgItem=!1,this.itemControl=null,this.licenseInfo=null,this.modified=null,this.name=null,this.numComments=null,this.numRatings=null,this.numViews=null,this.owner=null,this.ownerFolder=null,this.portal=null,this.screenshots=null,this.size=null,this.snippet=null,this.sourceJSON=null,this.sourceUrl=null,this.spatialReference=null,this.tags=null,this.title=null,this.type=null,this.typeKeywords=null,this.url=null}destroy(){this.portal=null}get displayName(){const t=this.type,e=this.typeKeywords||[];let i=t;return t==="Feature Service"||t==="Feature Collection"?i=e.includes("Table")?"Table":e.includes("Route Layer")?"Route Layer":e.includes("Markup")?"Markup":"Feature Layer":t==="Image Service"?i=e.includes("Elevation 3D Layer")?"Elevation Layer":e.includes("Tiled Imagery")?"Tiled Imagery Layer":"Imagery Layer":t==="Scene Service"?i="Scene Layer":t==="Video Service"?i="Video Layer":t==="Scene Package"?i="Scene Layer Package":t==="Stream Service"?i="Feature Layer":t==="Geoprocessing Service"?i=e.includes("Web Tool")?"Tool":"Geoprocessing Service":t==="Geocoding Service"?i="Locator":t==="Geoenrichment Service"?i="GeoEnrichment Service":t==="Microsoft Powerpoint"?i="Microsoft PowerPoint":t==="GeoJson"?i="GeoJSON":t==="Globe Service"?i="Globe Layer":t==="Vector Tile Service"?i="Tile Layer":t==="netCDF"?i="NetCDF":t==="Map Service"?i=e.includes("Spatiotemporal")||!e.includes("Hosted Service")&&!e.includes("Tiled")||e.includes("Relational")?"Map Image Layer":"Tile Layer":t&&t.toLowerCase().includes("add in")?i=t.replaceAll(/(add in)/gi,"Add-In"):t==="datastore catalog service"?i="Big Data File Share":t==="Compact Tile Package"?i="Tile Package (tpkx)":t==="OGCFeatureServer"?i="OGC Feature Layer":t==="web mapping application"&&e.includes("configurableApp")?i="Instant App":t==="Insights Page"?i="Insights Report":t==="Excalibur Imagery Project"&&(i="Excalibur Project"),i}readExtent(t){return t&&t.length?new Re(t[0][0],t[0][1],t[1][0],t[1][1]):null}get iconUrl(){const t=this.type&&this.type.toLowerCase()||"",e=this.typeKeywords||[],i="esri/images/portal/",r="16";let n,s=!1,o=!1,a=!1,l=!1,c=!1,u=!1;return t.indexOf("service")>0||t==="feature collection"||t==="kml"||t==="wms"||t==="wmts"||t==="wfs"?(s=e.includes("Hosted Service"),t==="feature service"||t==="feature collection"||t==="kml"||t==="wfs"?(o=e.includes("Table"),a=e.includes("Route Layer"),l=e.includes("Markup"),c=e.includes("Spatiotemporal"),u=e.includes("UtilityNetwork"),n=c&&o?"spatiotemporaltable":o?"table":a?"routelayer":l?"markup":c?"spatiotemporal":s?"featureshosted":u?"utilitynetwork":"features"):n=t==="map service"||t==="wms"||t==="wmts"?s||e.includes("Tiled")||t==="wmts"?"maptiles":"mapimages":t==="scene service"?e.includes("Line")?"sceneweblayerline":e.includes("3DObject")?"sceneweblayermultipatch":e.includes("Point")?"sceneweblayerpoint":e.includes("IntegratedMesh")?"sceneweblayermesh":e.includes("PointCloud")?"sceneweblayerpointcloud":e.includes("Polygon")?"sceneweblayerpolygon":e.includes("Building")?"sceneweblayerbuilding":e.includes("Voxel")?"sceneweblayervoxel":"sceneweblayer":t==="image service"?e.includes("Elevation 3D Layer")?"elevationlayer":e.includes("Tiled Imagery")?"tiledimagerylayer":"imagery":t==="stream service"?"streamlayer":t==="video service"?e.includes("Live Stream")?"livestreamvideolayer":"videolayer":t==="vector tile service"?"vectortile":t==="datastore catalog service"?"datastorecollection":t==="geocoding service"?"geocodeservice":t==="geoprocessing service"?e.includes("Web Tool")?"tool":"layers":t==="geodata service"?"geodataservice":"layers"):n=t==="web map"||t==="cityengine web scene"?"maps":t==="web scene"?e.includes("ViewingMode-Local")?"webscenelocal":"websceneglobal":t==="web mapping application"&&e.includes("configurableApp")?"instantapps":t==="web mapping application"||t==="mobile application"||t==="application"||t==="operation view"||t==="desktop application"?"apps":t==="map document"||t==="map package"||t==="published map"||t==="scene document"||t==="globe document"||t==="basemap package"||t==="mobile basemap package"||t==="mobile map package"||t==="project package"||t==="project template"||t==="pro map"||t==="layout"||t==="layer"&&e.includes("ArcGIS Pro")||t==="explorer map"&&e.indexOf("Explorer Document")?"mapsgray":t==="service definition"||t==="csv"||t==="shapefile"||t==="cad drawing"||t==="geojson"||t==="netcdf"||t==="administrative report"?"datafiles":t==="explorer add in"||t==="desktop add in"||t==="windows viewer add in"||t==="windows viewer configuration"?"appsgray":t==="360 vr experience"?"360vr":t==="arcgis pro add in"||t==="arcgis pro configuration"?"addindesktop":t==="rule package"||t==="file geodatabase"||t==="sqlite geodatabase"||t==="csv collection"||t==="kml collection"||t==="windows mobile package"||t==="map template"||t==="desktop application template"||t==="gml"||t==="arcpad package"||t==="code sample"||t==="form"||t==="document link"||t==="earth configuration"||t==="operations dashboard add in"||t==="rules package"||t==="image"||t==="workflow manager package"||t==="explorer map"&&e.includes("Explorer Mapping Application")||e.includes("Document")?"datafilesgray":t==="network analysis service"||t==="geoprocessing service"||t==="geodata service"||t==="geometry service"||t==="geoprocessing package"||t==="locator package"||t==="geoprocessing sample"||t==="workflow manager service"?"toolsgray":t==="layer"||t==="layer package"||t==="explorer layer"?"layersgray":t==="scene package"?"scenepackage":t==="mobile scene package"?"mobilescenepackage":t==="tile package"||t==="compact tile package"?"tilepackage":t==="task file"?"taskfile":t==="report template"?"report-template":t==="statistical data collection"?"statisticaldatacollection":t==="insights workbook"?"workbook":t==="insights model"?"insightsmodel":t==="insights page"?"insightspage":t==="insights theme"?"insightstheme":t==="hub initiative"?"hubinitiative":t==="hubpage"?"hubpage":t==="hub event"?"hubevent":t==="hub site application"?"hubsite":t==="hub project"?"hubproject":t==="relational database connection"?"relationaldatabaseconnection":t==="big data file share"?"datastorecollection":t==="image collection"?"imagecollection":t==="style"?"style":t==="desktop style"?"desktopstyle":t==="dashboard"?"dashboard":t==="raster function template"?"rasterprocessingtemplate":t==="vector tile package"?"vectortilepackage":t==="ortho mapping project"?"orthomappingproject":t==="ortho mapping template"?"orthomappingtemplate":t==="solution"?"solutions":t==="geopackage"?"geopackage":t==="deep learning package"?"deeplearningpackage":t==="real time analytic"?"realtimeanalytics":t==="big data analytic"?"bigdataanalytics":t==="feed"?"feed":t==="excalibur imagery project"?"excaliburimageryproject":t==="notebook"?"notebook":t==="storymap"?"storymap":t==="survey123 add in"?"survey123addin":t==="mission"?"mission":t==="mission report"?"missionreport":t==="quickcapture project"?"quickcaptureproject":t==="pro report"?"proreport":t==="pro report template"?"proreporttemplate":t==="urban model"?"urbanmodel":t==="web experience"?"experiencebuilder":t==="web experience template"?"webexperiencetemplate":t==="experience builder widget"?"experiencebuilderwidget":t==="experience builder widget package"?"experiencebuilderwidgetpackage":t==="workflow"?"workflow":t==="insights script"?"insightsscript":t==="kernel gateway connection"?"kernelgatewayconnection":t==="hub initiative template"?"hubinitiativetemplate":t==="storymap theme"?"storymaptheme":t==="knowledge graph"?"knowledgegraph":t==="native application"?"nativeapp":t==="native application installer"?"nativeappinstaller":t==="link chart"?"linkchart":t==="investigation"?"investigation":t==="ogcfeatureserver"?"features":t==="pro project"?"proproject":t==="insights workbook package"?"insightsworkbookpackage":t==="apache parquet"?"apacheparquet":t==="notebook code snippets"||t==="notebook code snippet library"?"notebookcodesnippets":t==="suitability model"?"suitabilitymodel":t==="esri classifier definition"?"classifierdefinition":t==="esri classification schema"?"classificationschema":t==="insights data engineering workbook"?"dataengineeringworkbook":t==="insights data engineering model"?"dataengineeringmodel":t==="deep learning studio project"?"deeplearningproject":t==="discussion"?"discussion":t==="allsource project"?"allsourceproject":t==="api key"?"apikey":t==="data pipeline"?"datapipelines":"maps",n?Tt(i+n+r+".png"):null}get isLayer(){return this.type!=null&&AIe.has(this.type)}get itemCdnUrl(){let t=this.itemUrl;return t&&vt&&!vt.findCredential(t)&&(t=vt._normalizeAGOLorgDomain(t),t=t.replace(/^https?:\/\/www\.arcgis\.com/,"https://cdn.arcgis.com"),t=t.replace(/^https?:\/\/devext\.arcgis\.com/,"https://cdndev.arcgis.com"),t=t.replace(/^https?:\/\/qaext\.arcgis\.com/,"https://cdnqa.arcgis.com")),t}get itemPageUrl(){var e;const t=(e=this.portal)==null?void 0:e.itemPageUrl;return t&&this.id?`${t}?id=${this.id}`:null}get itemUrl(){var e;const t=(e=this.portal)==null?void 0:e.restUrl;return t&&this.id?`${t}/content/items/${this.id}`:null}get thumbnailUrl(){var i;const t=this.itemUrl,e=this.thumbnail;return t&&e?((i=this.portal)==null?void 0:i.normalizeUrl(`${t}/info/${e}?f=json`))??null:null}get userItemUrl(){const t=this.get("portal.restUrl");if(!t)return null;const e=this.owner||this.get("portal.user.username");return e?`${t}/content/users/${this.ownerFolder?`${e}/${this.ownerFolder}`:e}/items/${this.id}`:null}load(t){const e=this.portal??(this.portal=on.getDefault()),i=e.load(t).then(()=>this.sourceJSON?this.sourceJSON:this.id&&this.itemUrl?e.request(this.itemUrl,{signal:t!=null?t.signal:null,query:{token:this.apiKey}}):{}).then(r=>{this.sourceJSON=r,this.read(r)});return this.addResolvingPromise(i),Promise.resolve(this)}async addRating(t){const e={method:"post",query:{}};return t instanceof f3&&(t=t.rating),t==null||isNaN(t)||typeof t!="number"||(e.query.rating=t),this.portal?(await this.portal.request(this.itemUrl+"/addRating",e),new f3({rating:t,created:new Date})):null}clone(){const t={access:this.access,accessInformation:this.accessInformation,applicationProxies:U(this.applicationProxies),avgRating:this.avgRating,categories:U(this.categories),created:U(this.created),culture:this.culture,description:this.description,extent:U(this.extent),groupCategories:U(this.groupCategories),id:this.id,itemControl:this.itemControl,licenseInfo:this.licenseInfo,modified:U(this.modified),name:this.name,numComments:this.numComments,numRatings:this.numRatings,numViews:this.numViews,owner:this.owner,ownerFolder:this.ownerFolder,portal:this.portal,screenshots:U(this.screenshots),size:this.size,snippet:this.snippet,sourceUrl:this.sourceUrl,spatialReference:this.spatialReference,tags:U(this.tags),thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:U(this.typeKeywords),url:this.url};this.loaded&&(t.loadStatus="loaded");const e=new ly({sourceJSON:this.sourceJSON}).set(t);return e._set("isOrgItem",this.isOrgItem),e}createPostQuery(){var i;const t=this.toJSON();for(const r of["tags","typeKeywords","categories"])t[r]=(i=t[r])==null?void 0:i.join(", ");const{extent:e}=t;return e&&(t.extent=JSON.stringify(e)),t}async deleteRating(){await us(this.portal).request(this.itemUrl+"/deleteRating",{method:"post"})}fetchData(t="json",e){return us(this.portal).request(this.itemUrl+"/data",{responseType:t,...e,query:{token:this.apiKey}})}async fetchRating(t){const e=await us(this.portal).request(this.itemUrl+"/rating",{query:{token:this.apiKey},...t});return e.rating!=null?(e.created=new Date(e.created),new f3(e)):null}fetchRelatedItems(t,e){return us(this.portal).requestToTypedArray(this.itemUrl+"/relatedItems",{query:{...t,token:this.apiKey},...e},ly)}getThumbnailUrl(t){let e=this.thumbnailUrl;return e&&t&&(e+=`&w=${t}`),e}reload(){return us(this.portal).request(this.itemUrl??"",{cacheBust:!0,query:{token:this.apiKey}}).then(t=>(this.sourceJSON=t,this.read(t),this))}update(t){return this.id?this.load().then(()=>us(this.portal).signIn()).then(()=>{const e=t&&t.data,i={method:"post"};i.query=this.createPostQuery();for(const r in i.query)i.query[r]===null&&(i.query[r]="");return i.query.clearEmptyFields=!0,e!=null&&(typeof e=="string"?i.query.text=e:typeof e=="object"&&(i.query.text=JSON.stringify(e))),this.portal.request(`${this.userItemUrl}/update`,i).then(()=>this.reload())}):Promise.reject(new N("portal:item-does-not-exist","The item does not exist yet and cannot be updated"))}async copy(t){if(!this.id)throw new N("portal:item-does-not-exist","The item does not exist yet");await this.load();const{portal:e,itemUrl:i}=this;await us(e).signIn();const{copyResources:r,folder:n,tags:s,title:o}=t||{},a={method:"post",query:{copyPrivateResources:r==="all",folder:typeof n=="string"?n:n==null?void 0:n.id,includeResources:!!r,tags:s==null?void 0:s.join(","),title:o}},{itemId:l}=await e.request(`${i}/copy`,a);return new ly({id:l,portal:e})}updateThumbnail(t){return this.id?this.load().then(()=>this.portal.signIn()).then(()=>{const e=t.thumbnail,i=t.filename,r={method:"post"};if(typeof e=="string")Bv(e)?r.query={data:e}:r.query={url:Jl(e)},i!=null&&(r.query.filename=i);else{const n=new FormData;i!=null?n.append("file",e,i):n.append("file",e),r.body=n}return this.portal.request(`${this.userItemUrl}/updateThumbnail`,r).then(()=>this.reload())}):Promise.reject(new N("portal:item-does-not-exist","The item does not exist yet and cannot be updated"))}async fetchResources(t={},e){const{fetchResources:i}=await W(()=>import("./resourceUtils-ae8bbc09.js"),[],import.meta.url);return i(this,t,e)}async addResource(t,e,i){const{addOrUpdateResource:r}=await W(()=>import("./resourceUtils-ae8bbc09.js"),[],import.meta.url);return t.portalItem=this,r(t,"add",e,i)}async removeResource(t,e){const{removeResource:i}=await W(()=>import("./resourceUtils-ae8bbc09.js"),[],import.meta.url);if(t.portalItem&&t.portalItem.itemUrl!==this.itemUrl)throw new N("removeresource:portal-item-mismatch","The portal item associated with the provided resource does not match the item");return i(this,t,e)}async removeAllResources(t){const{removeAllResources:e}=await W(()=>import("./resourceUtils-ae8bbc09.js"),[],import.meta.url);return e(this,t)}resourceFromPath(t){return new $Ie({portalItem:this,path:t})}toJSON(){const t=this.extent,e={accessInformation:this.accessInformation,categories:U(this.categories),created:this.created&&this.created.getTime(),description:this.description,extent:t&&[[t.xmin,t.ymin],[t.xmax,t.ymax]],id:this.id,isOrgItem:this.isOrgItem,licenseInfo:this.licenseInfo,modified:this.modified&&this.modified.getTime(),name:this.name,owner:this.owner,ownerFolder:this.ownerFolder,snippet:this.snippet,sourceUrl:this.sourceUrl,spatialReference:this.spatialReference,tags:U(this.tags),thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:U(this.typeKeywords),url:this.url};return kre(e)}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");return new ly({sourceJSON:t})}_getPostQuery(){const t=this.toJSON();for(const e in t)e==="tags"&&t[e]!==null&&(t[e]=t[e].join(", ")),e==="typeKeywords"&&t[e]!==null&&(t[e]=t[e].join(", ")),e==="extent"&&t[e]&&(t[e]=JSON.stringify(t[e]));return t}};d([p({type:["private","shared","org","public"]})],nt.prototype,"access",void 0),d([p()],nt.prototype,"accessInformation",void 0),d([p({type:String})],nt.prototype,"apiKey",void 0),d([p({json:{read:{source:"appProxies"}}})],nt.prototype,"applicationProxies",void 0),d([p()],nt.prototype,"avgRating",void 0),d([p()],nt.prototype,"categories",void 0),d([p({type:Date})],nt.prototype,"created",void 0),d([p()],nt.prototype,"culture",void 0),d([p()],nt.prototype,"description",void 0),d([p({readOnly:!0})],nt.prototype,"displayName",null),d([p({type:Re})],nt.prototype,"extent",void 0),d([ae("extent")],nt.prototype,"readExtent",null),d([p()],nt.prototype,"groupCategories",void 0),d([p({readOnly:!0})],nt.prototype,"iconUrl",null),d([p()],nt.prototype,"id",void 0),d([p({readOnly:!0})],nt.prototype,"isLayer",null),d([p({type:Boolean,readOnly:!0})],nt.prototype,"isOrgItem",void 0),d([p()],nt.prototype,"itemControl",void 0),d([p({readOnly:!0})],nt.prototype,"itemPageUrl",null),d([p({readOnly:!0})],nt.prototype,"itemUrl",null),d([p()],nt.prototype,"licenseInfo",void 0),d([p({type:Date})],nt.prototype,"modified",void 0),d([p()],nt.prototype,"name",void 0),d([p()],nt.prototype,"numComments",void 0),d([p()],nt.prototype,"numRatings",void 0),d([p()],nt.prototype,"numViews",void 0),d([p()],nt.prototype,"owner",void 0),d([p()],nt.prototype,"ownerFolder",void 0),d([p({type:on})],nt.prototype,"portal",void 0),d([p()],nt.prototype,"screenshots",void 0),d([p()],nt.prototype,"size",void 0),d([p()],nt.prototype,"snippet",void 0),d([p()],nt.prototype,"sourceJSON",void 0),d([p({type:String})],nt.prototype,"sourceUrl",void 0),d([p({type:String})],nt.prototype,"spatialReference",void 0),d([p()],nt.prototype,"tags",void 0),d([p()],nt.prototype,"thumbnail",void 0),d([p({readOnly:!0})],nt.prototype,"thumbnailUrl",null),d([p()],nt.prototype,"title",void 0),d([p()],nt.prototype,"type",void 0),d([p()],nt.prototype,"typeKeywords",void 0),d([p({type:String,json:{read(t,e){var i;if(kIe.has(e.type)){const r=(i=this.portal)==null?void 0:i.restUrl;t||(t=r&&this.id?`${r}/content/items/${this.id}/data`:null)}return t}}})],nt.prototype,"url",void 0),d([p({readOnly:!0})],nt.prototype,"userItemUrl",null),nt=ly=d([A("esri.portal.PortalItem")],nt);const J2=nt,mse=Object.freeze(Object.defineProperty({__proto__:null,default:J2},Symbol.toStringTag,{value:"Module"})),nq=/^([a-z]{2})(?:[-_]([A-Za-z]{2}))?$/,PIe={ar:!0,bg:!0,bs:!0,ca:!0,cs:!0,da:!0,de:!0,el:!0,en:!0,es:!0,et:!0,fi:!0,fr:!0,he:!0,hr:!0,hu:!0,id:!0,it:!0,ja:!0,ko:!0,lt:!0,lv:!0,nb:!0,nl:!0,pl:!0,"pt-BR":!0,"pt-PT":!0,ro:!0,ru:!0,sk:!0,sl:!0,sr:!0,sv:!0,th:!0,tr:!0,uk:!0,vi:!0,"zh-CN":!0,"zh-HK":!0,"zh-TW":!0};function sq(t){return t in PIe}const yS=[],Tw=new Map;function oq(t){for(const e of Tw.keys())gse(t.pattern,e)&&Tw.delete(e)}function OIe(t){return yS.includes(t)||(oq(t),yS.unshift(t)),{remove(){const e=yS.indexOf(t);e>-1&&(yS.splice(e,1),oq(t))}}}async function ev(t){const e=Mn();Tw.has(t)||Tw.set(t,RIe(t,e));const i=Tw.get(t);return i&&await FIe.add(i),i}function LIe(t){if(!nq.test(t))return null;const e=nq.exec(t);if(e===null)return null;const[,i,r]=e,n=i+(r?"-"+r.toUpperCase():"");return sq(n)?n:sq(i)?i:null}async function RIe(t,e){const i=[];for(const r of yS)if(gse(r.pattern,t))try{return await r.fetchMessageBundle(t,e)}catch(n){i.push(n)}throw i.length?new N("intl:message-bundle-error",`Errors occurred while loading "${t}"`,{errors:i}):new N("intl:no-message-bundle-loader",`No loader found for message bundle "${t}"`)}function gse(t,e){return typeof t=="string"?e.startsWith(t):t.test(e)}bB(()=>{Tw.clear()});const FIe=new class{constructor(){this._numLoading=0,this._dfd=null}async waitForAll(){this._dfd&&await this._dfd.promise}add(t){return this._increase(),t.then(()=>this._decrease(),()=>this._decrease()),this.waitForAll()}_increase(){this._numLoading++,this._dfd||(this._dfd=Ta())}_decrease(){this._numLoading=Math.max(this._numLoading-1,0),this._dfd&&this._numLoading===0&&(this._dfd.resolve(),this._dfd=null)}};async function DIe(t){if(!t)return;const e=t.includes("-vector")?t.slice(0,t.indexOf("-vector")):t,i=await ev("esri/t9n/basemaps");return i[t]||i[e]}const Qw={streets:{id:"streets",classic:!0,deprecated:!0,get thumbnailUrl(){return Tt("esri/images/basemap/streets.jpg")},baseMapLayers:[{id:"streets-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Street Map",showLegend:!1,visibility:!0,opacity:1}]},satellite:{id:"satellite",classic:!0,get thumbnailUrl(){return Tt("esri/images/basemap/satellite.jpg")},baseMapLayers:[{id:"satellite-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1}]},hybrid:{id:"hybrid",classic:!0,get thumbnailUrl(){return Tt("esri/images/basemap/hybrid.jpg")},baseMapLayers:[{id:"hybrid-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1},{id:"hybrid-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/30d6b8271e1849cd9c3042060001f425/resources/styles/root.json",layerType:"VectorTileLayer",title:"Hybrid Reference Layer",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},terrain:{id:"terrain",classic:!0,get thumbnailUrl(){return Tt("esri/images/basemap/terrain.jpg")},baseMapLayers:[{id:"terrain-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Terrain Base",showLegend:!1,visibility:!0,opacity:1},{id:"terrain-reference-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Reference_Overlay/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Reference Overlay",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},topo:{id:"topo",classic:!0,deprecated:!0,get thumbnailUrl(){return Tt("esri/images/basemap/topo.jpg")},baseMapLayers:[{id:"topo-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Topo Map",showLegend:!1,visibility:!0,opacity:1}]},gray:{id:"gray",classic:!0,deprecated:!0,get thumbnailUrl(){return Tt("esri/images/basemap/gray.jpg")},baseMapLayers:[{id:"gray-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Light Gray Base",showLegend:!1,visibility:!0,opacity:1},{id:"gray-reference-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Reference/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Light Gray Reference",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},"dark-gray":{id:"dark-gray",classic:!0,deprecated:!0,get thumbnailUrl(){return Tt("esri/images/basemap/dark-gray.jpg")},baseMapLayers:[{id:"dark-gray-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Dark Gray Base",showLegend:!1,visibility:!0,opacity:1},{id:"dark-gray-reference-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Reference/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Dark Gray Reference",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},oceans:{id:"oceans",classic:!0,get thumbnailUrl(){return Tt("esri/images/basemap/oceans.jpg")},baseMapLayers:[{id:"oceans-base-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Base",showLegend:!1,visibility:!0,opacity:1},{id:"oceans-reference-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Reference/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Reference",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},"national-geographic":{id:"national-geographic",classic:!0,deprecated:!0,get thumbnailUrl(){return Tt("esri/images/basemap/national-geographic.jpg")},baseMapLayers:[{id:"national-geographic-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer",title:"NatGeo World Map",showLegend:!1,layerType:"ArcGISTiledMapServiceLayer",visibility:!0,opacity:1}]},osm:{id:"osm",classic:!0,get thumbnailUrl(){return Tt("esri/images/basemap/osm.jpg")},baseMapLayers:[{id:"osm-base-layer",layerType:"OpenStreetMap",title:"Open Street Map",showLegend:!1,visibility:!0,opacity:1}]},"dark-gray-vector":{id:"dark-gray-vector",classic:!0,get thumbnailUrl(){return Tt("esri/images/basemap/dark-gray-vector.jpg")},baseMapLayers:[{id:"dark-gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/5e9b3685f4c24d8781073dd928ebda50/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Base",visibility:!0,opacity:1},{id:"dark-gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/747cb7a5329c478cbe6981076cc879c5/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Reference",isReference:!0,visibility:!0,opacity:1}]},"gray-vector":{id:"gray-vector",classic:!0,get thumbnailUrl(){return Tt("esri/images/basemap/gray-vector.jpg")},baseMapLayers:[{id:"gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/291da5eab3a0412593b66d384379f89f/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Base",visibility:!0,opacity:1},{id:"gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/1768e8369a214dfab4e2167d5c5f2454/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Reference",isReference:!0,visibility:!0,opacity:1}]},"streets-vector":{id:"streets-vector",classic:!0,get thumbnailUrl(){return Tt("esri/images/basemap/streets-vector.jpg")},baseMapLayers:[{id:"streets-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/de26a3cf4cc9451298ea173c4b324736/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets",visibility:!0,opacity:1}]},"topo-vector":{id:"topo-vector",classic:!0,get thumbnailUrl(){return Tt("esri/images/basemap/topo-vector.jpg")},baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"topo-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/7dc6cea0b1764a1f9af2e679f642f0f5/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Topo",visibility:!0,opacity:1}]},"streets-night-vector":{id:"streets-night-vector",classic:!0,get thumbnailUrl(){return Tt("esri/images/basemap/streets-night.jpg")},baseMapLayers:[{id:"streets-night-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/86f556a2d1fd468181855a35e344567f/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Night",visibility:!0,opacity:1}]},"streets-relief-vector":{id:"streets-relief-vector",classic:!0,get thumbnailUrl(){return Tt("esri/images/basemap/streets-relief.jpg")},baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"streets-relief-vector-base-layer",styleUrl:"//www.arcgis.com/sharing/rest/content/items/b266e6d17fc345b498345613930fbd76/resources/styles/root.json",title:"World Streets Relief",layerType:"VectorTileLayer",visibility:!0,opacity:1}]},"streets-navigation-vector":{id:"streets-navigation-vector",classic:!0,get thumbnailUrl(){return Tt("esri/images/basemap/streets-navigation.jpg")},baseMapLayers:[{id:"streets-navigation-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/63c47b7177f946b49902c24129b87252/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Navigation",visibility:!0,opacity:1}]},"arcgis-imagery":{get thumbnailUrl(){return Tt("esri/images/basemap/hybrid.jpg")},title:"Imagery Hybrid",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Imagery",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/World_Imagery/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Imagery:Labels",title:"Hybrid Reference Layer",isReference:!0}]},"arcgis-imagery-standard":{get thumbnailUrl(){return Tt("esri/images/basemap/satellite.jpg")},title:"Imagery",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Imagery",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/World_Imagery/MapServer"}]},"arcgis-imagery-labels":{title:"Hybrid [Reference]",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Imagery:Labels",title:"Hybrid Reference Layer",isReference:!0}]},"arcgis-light-gray":{get thumbnailUrl(){return Tt("esri/images/basemap/gray-vector.jpg")},title:"Light Gray Canvas",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:LightGray:Base",title:"Light Gray Canvas Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:LightGray:Labels",title:"Light Gray Canvas Labels",isReference:!0}]},"arcgis-dark-gray":{get thumbnailUrl(){return Tt("esri/images/basemap/dark-gray.jpg")},title:"Dark Gray Canvas",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:DarkGray:Base",title:"Dark Gray Canvas Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:DarkGray:Labels",title:"Dark Gray Canvas Labels",isReference:!0}]},"arcgis-navigation":{get thumbnailUrl(){return Tt("esri/images/basemap/streets-navigation.jpg")},title:"Navigation",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Navigation",title:"World Navigation Map"}]},"arcgis-navigation-night":{title:"Navigation (Dark Mode)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:NavigationNight",title:"World Navigation Map (Dark Mode)"}]},"arcgis-streets":{get thumbnailUrl(){return Tt("esri/images/basemap/streets-vector.jpg")},title:"Streets",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Streets",title:"World Street Map"}]},"arcgis-streets-night":{get thumbnailUrl(){return Tt("esri/images/basemap/streets-night.jpg")},title:"Streets (Night)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:StreetsNight",title:"World Street Map (Night)"}]},"arcgis-streets-relief":{get thumbnailUrl(){return Tt("esri/images/basemap/streets-relief.jpg")},title:"Streets (with Relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:StreetsRelief:Base",title:"World Street Map (with Relief)"}]},"arcgis-topographic":{get thumbnailUrl(){return Tt("esri/images/basemap/topo.jpg")},title:"Topographic",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Topographic:Base",title:"World Topographic Map"}]},"arcgis-oceans":{get thumbnailUrl(){return Tt("esri/images/basemap/oceans.jpg")},title:"Oceans",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Ocean Base",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Oceans:Labels",title:"World Ocean Reference",isReference:!0}]},"osm-standard":{title:"OpenStreetMap",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:Standard",title:"OpenStreetMap"}]},"osm-standard-relief":{title:"OpenStreetMap (with relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:StandardRelief:Base",layerType:"VectorTileLayer",title:"OpenStreetMap Relief Base"}]},"osm-streets":{title:"OpenStreetMap (Streets)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:Streets",title:"OpenStreetMap (Streets)"}]},"osm-streets-relief":{title:"OpenStreetMap (Streets with relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:StreetsRelief:Base",layerType:"VectorTileLayer",title:"OpenStreetMap Relief Base"}]},"osm-light-gray":{title:"OpenStreetMap (Light Gray Canvas)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:LightGray:Base",title:"OSM (Light Gray Base)"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:LightGray:Labels",title:"OSM (Light Gray Reference)",isReference:!0}]},"osm-dark-gray":{title:"OpenStreetMap (Dark Gray Canvas)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:DarkGray:Base",title:"OSM (Dark Gray Base)"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:DarkGray:Labels",title:"OSM (Dark Gray Reference)",isReference:!0}]},"arcgis-terrain":{title:"Terrain with Labels",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Terrain:Base",title:"World Terrain Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Terrain:Detail",title:"World Terrain Reference",isReference:!0}]},"arcgis-community":{title:"Community",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Community",title:"Community"}]},"arcgis-charted-territory":{title:"Charted Territory",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ChartedTerritory:Base",title:"Charted Territory"}]},"arcgis-colored-pencil":{title:"Colored Pencil",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ColoredPencil",title:"Colored Pencil"}]},"arcgis-nova":{title:"Nova",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Nova",title:"Nova"}]},"arcgis-modern-antique":{title:"Modern Antique",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ModernAntique:Base",title:"Modern Antique"}]},"arcgis-midcentury":{title:"Mid-Century",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Midcentury",title:"Mid-Century"}]},"arcgis-newspaper":{title:"Newspaper",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Newspaper",title:"Newspaper"}]},"arcgis-hillshade-light":{title:"Hillshade",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"}]},"arcgis-hillshade-dark":{title:"Hillshade (Dark)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade (Dark)",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade_Dark/MapServer"}]},"arcgis-human-geography":{title:"Human Geography",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeography:Base",title:"Human Geography Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeography:Detail",title:"Human Geography Detail",isReference:!0},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeography:Label",title:"Human Geography Label",isReference:!0}]},"arcgis-human-geography-dark":{title:"Human Geography (Dark)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeographyDark:Base",title:"Human Geography Dark Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeographyDark:Detail",title:"Human Geography Dark Detail",isReference:!0},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeographyDark:Label",title:"Human Geography Dark Label",isReference:!0}]}};function xB(t){return t!=null&&typeof t=="object"&&"type"in t&&t.type==="feature"}const Bgt={Point:"SceneLayer","3DObject":"SceneLayer",IntegratedMesh:"IntegratedMeshLayer",PointCloud:"PointCloudLayer",Building:"BuildingSceneLayer"};function yse(t){const e=t==null?void 0:t.type;return e==="building-scene"||e==="integrated-mesh"||e==="point-cloud"||e==="scene"}function SB(t){var e;return(t==null?void 0:t.type)==="feature"&&!t.url&&((e=t.source)==null?void 0:e.type)==="memory"}function Ugt(t){var e;return(t==null?void 0:t.type)==="feature"&&((e=t.source)==null?void 0:e.type)==="feature-layer"}async function IB(t,e){const i=vt==null?void 0:vt.findServerInfo(t);if((i==null?void 0:i.currentVersion)!=null)return i.owningSystemUrl||null;const r=t.toLowerCase().indexOf("/rest/services");if(r===-1)return null;const n=`${t.substring(0,r)}/rest/info`,s=e!=null?e.signal:null,{data:o}=await at(n,{query:{f:"json"},responseType:"json",signal:s});return(o==null?void 0:o.owningSystemUrl)||null}function NIe(t){if(!("capabilities"in t))return!1;switch(t.type){case"csv":case"feature":case"geojson":case"imagery":case"knowledge-graph-sublayer":case"ogc-feature":case"oriented-imagery":case"scene":case"subtype-group":case"subtype-sublayer":case"wfs":return!0;default:return!1}}function e1(t){return t!=null&&typeof t=="object"&&"isTable"in t&&!!t.isTable}function Ro(t){return NIe(t)?"effectiveCapabilities"in t?t.effectiveCapabilities:t.capabilities:null}function VIe(t){if(!("editingEnabled"in t))return!1;switch(t.type){case"csv":case"feature":case"geojson":case"oriented-imagery":case"scene":case"subtype-group":case"subtype-sublayer":return!0;default:return!1}}function KO(t){return!!VIe(t)&&("effectiveEditingEnabled"in t?t.effectiveEditingEnabled:t.editingEnabled)}const zIe=new Set(["bing-maps","imagery","imagery-tile","map-image","open-street-map","tile","unknown","unsupported","vector-tile","web-tile","wms","wmts"]),jIe=new Set(["csv","feature","geo-rss","geojson","group","imagery","imagery-tile","kml","map-image","map-notes","media","ogc-feature","route","stream","subtype-group","tile","unknown","unsupported","vector-tile","web-tile","wfs","wms","wmts"]);function BIe(t){return t.layerContainerType==="basemap"?zIe:t.layerContainerType==="operational-layers"?jIe:null}function UIe(t,e){if(e.restrictedWebMapWriting){const i=BIe(e);return i==null||i.has(t.type)&&!SB(t)}return!0}function GIe(t,e){if(e)if(SB(t)){const i=ZT("featureCollection.layers",e),r=i&&i[0]&&i[0].layerDefinition;r&&aq(t,r)}else t.type!=="group"&&aq(t,e)}function aq(t,e){"maxScale"in t&&(e.maxScale=Fk(t.maxScale)??void 0),"minScale"in t&&(e.minScale=Fk(t.minScale)??void 0)}function HIe(t,e){if(GIe(t,e),e&&("blendMode"in t&&(e.blendMode=t.blendMode,e.blendMode==="normal"&&delete e.blendMode),e.opacity=Fk(t.opacity)??void 0,e.title=t.title||"Layer",e.visibility=t.visible,"legendEnabled"in t&&t.type!=="wmts"))if(SB(t)){const i=e.featureCollection;i&&(i.showLegend=t.legendEnabled)}else e.showLegend=t.legendEnabled}function lq(t,e,i){if(!("write"in t)||!t.write)return i&&i.messages&&i.messages.push(new N("layer:unsupported",`Layers (${t.title}, ${t.id}) of type '${t.declaredClass}' cannot be persisted`,{layer:t})),null;if(UIe(t,i)){const r={};return t.write(r,i)?r:null}return e!=null&&HIe(t,e=U(e)),e}var M$;let qIe=0;const vse="esri.Basemap";let Sl=M$=class extends R1(Su){constructor(t){super(t),this.id=null,this.portalItem=null,this.spatialReference=null,this.thumbnailUrl=null,this.title="Basemap",this.id=Date.now().toString(16)+"-basemap-"+qIe++,this.baseLayers=new ye,this.referenceLayers=new ye;const e=r=>{r.parent&&r.parent!==this&&"remove"in r.parent&&r.parent.remove(r),r.parent=this,r.type==="elevation"&&ie.getLogger(this).error(`Layer '${r.title}, id:${r.id}' of type '${r.type}' is not supported as a basemap layer and will therefore be ignored.`)},i=r=>{r.parent=null};this.addHandles([this.baseLayers.on("after-add",r=>e(r.item)),this.referenceLayers.on("after-add",r=>e(r.item)),this.baseLayers.on("after-remove",r=>i(r.item)),this.referenceLayers.on("after-remove",r=>i(r.item))])}initialize(){this.when().catch(t=>{ie.getLogger(this).error("#load()",`Failed to load basemap (title: '${this.title}', id: '${this.id}')`,t)}),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}destroy(){var i;const t=this.baseLayers.removeAll();for(const r of t)r.destroy();const e=this.referenceLayers.removeAll();for(const r of e)r.destroy();this.baseLayers.destroy(),this.referenceLayers.destroy(),(i=this.portalItem)==null||i.destroy(),this.portalItem=null}normalizeCtorArgs(t){return t&&"resourceInfo"in t&&(this._set("resourceInfo",t.resourceInfo),delete(t={...t}).resourceInfo),t}set baseLayers(t){this._set("baseLayers",rg(t,this._get("baseLayers")))}_writeBaseLayers(t,e,i){const r=[];t&&(i={...i,layerContainerType:"basemap"},this.baseLayers.forEach(n=>{const s=lq(n,i.webmap?i.webmap.getLayerJSONFromResourceInfo(n):null,i);s!=null&&r.push(s)}),this.referenceLayers.forEach(n=>{const s=lq(n,i.webmap?i.webmap.getLayerJSONFromResourceInfo(n):null,i);s!=null&&(n.type!=="scene"&&(s.isReference=!0),r.push(s))})),e.baseMapLayers=r}set referenceLayers(t){this._set("referenceLayers",rg(t,this._get("referenceLayers")))}writeTitle(t,e){e.title=t||"Basemap"}load(t){return this.addResolvingPromise(this._loadFromSource(t)),Promise.resolve(this)}loadAll(){return Fne(this,t=>{t(this.baseLayers,this.referenceLayers)})}clone(){const t={id:this.id,title:this.title,portalItem:this.portalItem,baseLayers:this.baseLayers.map(e=>bk(e)?e.clone():e),referenceLayers:this.referenceLayers.map(e=>bk(e)?e.clone():e)};return this.loaded&&(t.loadStatus="loaded"),new M$({resourceInfo:this.resourceInfo}).set(t)}read(t,e){this.resourceInfo||this._set("resourceInfo",{data:t,context:e}),super.read(t,e)}write(t,e){return t=t||{},e&&e.origin||(e={origin:"web-map",...e}),super.write(t,e),!this.loaded&&this.resourceInfo&&this.resourceInfo.data.baseMapLayers&&(t.baseMapLayers=this.resourceInfo.data.baseMapLayers.map(i=>{const r=U(i);return r.url&&Nd(r.url)&&(r.url=`https:${r.url}`),r.templateUrl&&Nd(r.templateUrl)&&(r.templateUrl=`https:${r.templateUrl}`),r})),t}async _loadFromSource(t){const{resourceInfo:e,portalItem:i}=this;_t(t);const r=[];if(e){const n=e.context?e.context.url:null;if(r.push(this._loadLayersFromJSON(e.data,n,t)),e.data.id&&!e.data.title){const s=e.data.id;r.push(DIe(s).then(o=>{o&&this.read({title:o},e.context)}))}}else i&&r.push(this._loadFromItem(i,t));await Promise.all(r)}async _loadLayersFromJSON(t,e,i){const r=this.resourceInfo&&this.resourceInfo.context,n=this.portalItem&&this.portalItem.portal||r&&r.portal||null,s=JIe[(r==null?void 0:r.origin)||""]??"web-map",{populateOperationalLayers:o}=await W(()=>import("./layersCreator-db5b7a0b.js"),["./layersCreator-db5b7a0b.js","./lazyLayerLoader-31902c6f.js","./portalLayers-c35a0770.js","./layersLoader-58213128.js","./fetchService-7b5fa001.js","./jsonContext-0bf4b056.js"],import.meta.url),a=[];if(_t(i),t.baseMapLayers&&Array.isArray(t.baseMapLayers)){const l={context:{origin:s,url:e,portal:n,layerContainerType:"basemap"},defaultLayerType:"DefaultTileLayer"},c=f=>s==="web-scene"&&f.layerType==="ArcGISSceneServiceLayer"||f.isReference,u=o(this.baseLayers,t.baseMapLayers.filter(f=>!c(f)),l);a.push(u);const h=o(this.referenceLayers,t.baseMapLayers.filter(c),l);a.push(h)}await br(a)}async _loadFromItem(t,e){const i=await t.load(e),r=await i.fetchData("json",e),n=sn(t.itemUrl??"");return this._set("resourceInfo",{data:r.baseMap??{},context:{origin:WIe[t.type||""]??"web-map",portal:t.portal||on.getDefault(),url:n}}),this.read(this.resourceInfo.data,this.resourceInfo.context),this.read({spatialReference:r.spatialReference},this.resourceInfo.context),this.read({title:t.title,thumbnailUrl:t.thumbnailUrl},{origin:"portal-item",portal:t.portal||on.getDefault(),url:n}),this._loadLayersFromJSON(this.resourceInfo.data,n,e)}static fromId(t){const e=Qw[t];if(!e)return null;if(e.deprecated){let i=null;t==="dark-gray"?i="dark-gray-vector":t==="gray"?i="gray-vector":t==="streets"?i="streets-vector":t==="topo"&&(i="topo-vector"),_p(ie.getLogger(vse),`The ${t} basemap has entered mature support and is no longer being updated.`,{replacement:i,see:"https://arcg.is/1iq8aD",warnOnce:!0})}return M$.fromJSON(e)}};d([p({json:{write:{ignoreOrigin:!0,target:"baseMapLayers",writer(t,e,i,r){this._writeBaseLayers(t,e,r)}},origins:{"web-scene":{write:{ignoreOrigin:!0,target:{baseMapLayers:{type:ye}},writer(t,e,i,r){this._writeBaseLayers(t,e,r)}}}}}})],Sl.prototype,"baseLayers",null),d([p({type:String,json:{origins:{"web-scene":{write:!0}}}})],Sl.prototype,"id",void 0),d([p({type:J2})],Sl.prototype,"portalItem",void 0),d([p()],Sl.prototype,"referenceLayers",null),d([p({readOnly:!0})],Sl.prototype,"resourceInfo",void 0),d([p({type:Ee})],Sl.prototype,"spatialReference",void 0),d([p()],Sl.prototype,"thumbnailUrl",void 0),d([p({type:String,json:{origins:{"web-scene":{write:{isRequired:!0}}}}})],Sl.prototype,"title",void 0),d([ge("title")],Sl.prototype,"writeTitle",null),Sl=M$=d([A(vse)],Sl);const WIe={"Web Scene":"web-scene","Web Map":"web-map","Link Chart":"link-chart"},JIe={"web-scene":"web-scene","web-map":"web-map","link-chart":"link-chart"},Gk=Sl,ZIe=Object.freeze(Object.defineProperty({__proto__:null,default:Gk},Symbol.toStringTag,{value:"Module"})),Hk={transparent:[0,0,0,0],black:[0,0,0,1],silver:[192,192,192,1],gray:[128,128,128,1],white:[255,255,255,1],maroon:[128,0,0,1],red:[255,0,0,1],purple:[128,0,128,1],fuchsia:[255,0,255,1],green:[0,128,0,1],lime:[0,255,0,1],olive:[128,128,0,1],yellow:[255,255,0,1],navy:[0,0,128,1],blue:[0,0,255,1],teal:[0,128,128,1],aqua:[0,255,255,1],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],blanchedalmond:[255,235,205,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],oldlace:[253,245,230,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],rebeccapurple:[102,51,153,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],whitesmoke:[245,245,245,1],yellowgreen:[154,205,50,1]};function _se(t){return!!Hk[t]||!!Hk[t.toLowerCase()]}function TB(t){return Hk[t]??Hk[t.toLowerCase()]}function YIe(t){return[...TB(t)]}function m3(t,e,i){i<0&&++i,i>1&&--i;const r=6*i;return r<1?t+(e-t)*r:2*i<1?e:3*i<2?t+(e-t)*(2/3-i)*6:t}function bse(t,e,i,r=1){const n=(t%360+360)%360/360,s=i<=.5?i*(e+1):i+e-i*e,o=2*i-s;return[Math.round(255*m3(o,s,n+1/3)),Math.round(255*m3(o,s,n)),Math.round(255*m3(o,s,n-1/3)),r]}function KIe(t){const e=t.length>5,i=e?8:4,r=(1<<i)-1,n=e?1:17,s=e?t.length===9:t.length===5;let o=+("0x"+t.substr(1));if(isNaN(o))return null;const a=[0,0,0,1];let l;return s&&(l=o&r,o>>=i,a[3]=n*l/255),l=o&r,o>>=i,a[2]=n*l,l=o&r,o>>=i,a[1]=n*l,l=o&r,o>>=i,a[0]=n*l,a}function Me(){return[0,0,0]}function Ls(t){return[t[0],t[1],t[2]]}function en(t,e,i){return[t,e,i]}function XIe(t){const e=Me(),i=Math.min(3,t.length);for(let r=0;r<i;++r)e[r]=t[r];return e}function wse(t,e){return new Float64Array(t,e,3)}function xse(){return Me()}function Sse(){return en(1,1,1)}function Ise(){return en(1,0,0)}function Tse(){return en(0,1,0)}function Cse(){return en(0,0,1)}const QIe=xse(),Ese=Sse(),eTe=Ise(),tTe=Tse(),Mse=Cse();Object.freeze(Object.defineProperty({__proto__:null,ONES:Ese,UNIT_X:eTe,UNIT_Y:tTe,UNIT_Z:Mse,ZEROS:QIe,clone:Ls,create:Me,createView:wse,fromArray:XIe,fromValues:en,ones:Sse,unitX:Ise,unitY:Tse,unitZ:Cse,zeros:xse},Symbol.toStringTag,{value:"Module"}));let CB=1e-6;function Bo(){return CB}function iTe(t){CB=t}const sC=Math.random,rTe=Math.PI/180,nTe=180/Math.PI;function EB(t){return t*rTe}function sTe(t){return t*nTe}function oTe(t,e){return Math.abs(t-e)<=CB*Math.max(1,Math.abs(t),Math.abs(e))}Object.freeze(Object.defineProperty({__proto__:null,RANDOM:sC,equals:oTe,getEpsilon:Bo,setEpsilon:iTe,toDegree:sTe,toRadian:EB},Symbol.toStringTag,{value:"Module"}));function vs(t){const e=t[0],i=t[1],r=t[2];return Math.sqrt(e*e+i*i+r*r)}function bi(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function Bi(t,e,i,r){return t[0]=e,t[1]=i,t[2]=r,t}function Sr(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t}function Ui(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t}function $se(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t[2]=e[2]*i[2],t}function Ase(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t[2]=e[2]/i[2],t}function aTe(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function lTe(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function cTe(t,e){return t[0]=Math.abs(e[0]),t[1]=Math.abs(e[1]),t[2]=Math.abs(e[2]),t}function uTe(t,e){return t[0]=Math.sign(e[0]),t[1]=Math.sign(e[1]),t[2]=Math.sign(e[2]),t}function dTe(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t[2]=Math.min(e[2],i[2]),t}function hTe(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t[2]=Math.max(e[2],i[2]),t}function pTe(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function xr(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t}function Wm(t,e,i,r){return t[0]=e[0]+i[0]*r,t[1]=e[1]+i[1]*r,t[2]=e[2]+i[2]*r,t}function N1(t,e){const i=e[0]-t[0],r=e[1]-t[1],n=e[2]-t[2];return Math.sqrt(i*i+r*r+n*n)}function bp(t,e){const i=e[0]-t[0],r=e[1]-t[1],n=e[2]-t[2];return i*i+r*r+n*n}function t1(t){const e=t[0],i=t[1],r=t[2];return e*e+i*i+r*r}function fTe(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function mTe(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function Rs(t,e){const i=e[0],r=e[1],n=e[2];let s=i*i+r*r+n*n;return s>0&&(s=1/Math.sqrt(s),t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s),t}function Mt(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function No(t,e,i){const r=e[0],n=e[1],s=e[2],o=i[0],a=i[1],l=i[2];return t[0]=n*l-s*a,t[1]=s*o-r*l,t[2]=r*a-n*o,t}function XO(t,e,i,r){const n=e[0],s=e[1],o=e[2];return t[0]=n+r*(i[0]-n),t[1]=s+r*(i[1]-s),t[2]=o+r*(i[2]-o),t}function gTe(t,e,i,r,n,s){const o=s*s,a=o*(2*s-3)+1,l=o*(s-2)+s,c=o*(s-1),u=o*(3-2*s);return t[0]=e[0]*a+i[0]*l+r[0]*c+n[0]*u,t[1]=e[1]*a+i[1]*l+r[1]*c+n[1]*u,t[2]=e[2]*a+i[2]*l+r[2]*c+n[2]*u,t}function yTe(t,e,i,r,n,s){const o=1-s,a=o*o,l=s*s,c=a*o,u=3*s*a,h=3*l*o,f=l*s;return t[0]=e[0]*c+i[0]*u+r[0]*h+n[0]*f,t[1]=e[1]*c+i[1]*u+r[1]*h+n[1]*f,t[2]=e[2]*c+i[2]*u+r[2]*h+n[2]*f,t}function vTe(t,e){e=e||1;const i=sC,r=2*i()*Math.PI,n=2*i()-1,s=Math.sqrt(1-n*n)*e;return t[0]=Math.cos(r)*s,t[1]=Math.sin(r)*s,t[2]=n*e,t}function Td(t,e,i){const r=e[0],n=e[1],s=e[2];return t[0]=i[0]*r+i[4]*n+i[8]*s+i[12],t[1]=i[1]*r+i[5]*n+i[9]*s+i[13],t[2]=i[2]*r+i[6]*n+i[10]*s+i[14],t}function _Te(t,e,i){const r=e[0],n=e[1],s=e[2];return t[0]=r*i[0]+n*i[3]+s*i[6],t[1]=r*i[1]+n*i[4]+s*i[7],t[2]=r*i[2]+n*i[5]+s*i[8],t}function WD(t,e,i){const r=i[0],n=i[1],s=i[2],o=i[3],a=e[0],l=e[1],c=e[2];let u=n*c-s*l,h=s*a-r*c,f=r*l-n*a,m=n*f-s*h,g=s*u-r*f,y=r*h-n*u;const v=2*o;return u*=v,h*=v,f*=v,m*=2,g*=2,y*=2,t[0]=a+u+m,t[1]=l+h+g,t[2]=c+f+y,t}function bTe(t,e,i,r){const n=[],s=[];return n[0]=e[0]-i[0],n[1]=e[1]-i[1],n[2]=e[2]-i[2],s[0]=n[0],s[1]=n[1]*Math.cos(r)-n[2]*Math.sin(r),s[2]=n[1]*Math.sin(r)+n[2]*Math.cos(r),t[0]=s[0]+i[0],t[1]=s[1]+i[1],t[2]=s[2]+i[2],t}function wTe(t,e,i,r){const n=[],s=[];return n[0]=e[0]-i[0],n[1]=e[1]-i[1],n[2]=e[2]-i[2],s[0]=n[2]*Math.sin(r)+n[0]*Math.cos(r),s[1]=n[1],s[2]=n[2]*Math.cos(r)-n[0]*Math.sin(r),t[0]=s[0]+i[0],t[1]=s[1]+i[1],t[2]=s[2]+i[2],t}function xTe(t,e,i,r){const n=[],s=[];return n[0]=e[0]-i[0],n[1]=e[1]-i[1],n[2]=e[2]-i[2],s[0]=n[0]*Math.cos(r)-n[1]*Math.sin(r),s[1]=n[0]*Math.sin(r)+n[1]*Math.cos(r),s[2]=n[2],t[0]=s[0]+i[0],t[1]=s[1]+i[1],t[2]=s[2]+i[2],t}function STe(t,e){bi(yE,t),bi(vE,e),Rs(yE,yE),Rs(vE,vE);const i=Mt(yE,vE);return i>1?0:i<-1?Math.PI:Math.acos(i)}const yE=Me(),vE=Me();function ITe(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function Xi(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function TTe(t,e){if(t===e)return!0;const i=t[0],r=t[1],n=t[2],s=e[0],o=e[1],a=e[2],l=Bo();return Math.abs(i-s)<=l*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(r-o)<=l*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(n-a)<=l*Math.max(1,Math.abs(n),Math.abs(a))}function kse(t,e,i){const r=i[0]-e[0],n=i[1]-e[1],s=i[2]-e[2];let o=r*r+n*n+s*s;return o>0?(o=1/Math.sqrt(o),t[0]=r*o,t[1]=n*o,t[2]=s*o,t):(t[0]=0,t[1]=0,t[2]=0,t)}const Xa=Ui,CTe=$se,ETe=Ase,MTe=N1,$Te=bp,Pse=vs,qk=t1;Object.freeze(Object.defineProperty({__proto__:null,abs:cTe,add:Sr,angle:STe,bezier:yTe,ceil:aTe,copy:bi,cross:No,direction:kse,dist:MTe,distance:N1,div:ETe,divide:Ase,dot:Mt,equals:TTe,exactEquals:Xi,floor:lTe,hermite:gTe,inverse:mTe,len:Pse,length:vs,lerp:XO,max:hTe,min:dTe,mul:CTe,multiply:$se,negate:fTe,normalize:Rs,random:vTe,rotateX:bTe,rotateY:wTe,rotateZ:xTe,round:pTe,scale:xr,scaleAndAdd:Wm,set:Bi,sign:uTe,sqrDist:$Te,sqrLen:qk,squaredDistance:bp,squaredLength:t1,str:ITe,sub:Xa,subtract:Ui,transformMat3:_Te,transformMat4:Td,transformQuat:WD},Symbol.toStringTag,{value:"Module"}));function qI(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function Ose(t,e,i,r,n){return t[0]=e,t[1]=i,t[2]=r,t[3]=n,t}function Lse(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t}function Rse(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t}function Fse(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t[2]=e[2]*i[2],t[3]=e[3]*i[3],t}function Dse(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t[2]=e[2]/i[2],t[3]=e[3]/i[3],t}function ATe(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t}function kTe(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t}function PTe(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t[2]=Math.min(e[2],i[2]),t[3]=Math.min(e[3],i[3]),t}function OTe(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t[2]=Math.max(e[2],i[2]),t[3]=Math.max(e[3],i[3]),t}function LTe(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t}function Nse(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t}function RTe(t,e,i,r){return t[0]=e[0]+i[0]*r,t[1]=e[1]+i[1]*r,t[2]=e[2]+i[2]*r,t[3]=e[3]+i[3]*r,t}function Vse(t,e){const i=e[0]-t[0],r=e[1]-t[1],n=e[2]-t[2],s=e[3]-t[3];return Math.sqrt(i*i+r*r+n*n+s*s)}function zse(t,e){const i=e[0]-t[0],r=e[1]-t[1],n=e[2]-t[2],s=e[3]-t[3];return i*i+r*r+n*n+s*s}function MB(t){const e=t[0],i=t[1],r=t[2],n=t[3];return Math.sqrt(e*e+i*i+r*r+n*n)}function $B(t){const e=t[0],i=t[1],r=t[2],n=t[3];return e*e+i*i+r*r+n*n}function FTe(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function DTe(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t}function jse(t,e){const i=e[0],r=e[1],n=e[2],s=e[3];let o=i*i+r*r+n*n+s*s;return o>0&&(o=1/Math.sqrt(o),t[0]=i*o,t[1]=r*o,t[2]=n*o,t[3]=s*o),t}function Bse(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function AB(t,e,i,r){const n=e[0],s=e[1],o=e[2],a=e[3];return t[0]=n+r*(i[0]-n),t[1]=s+r*(i[1]-s),t[2]=o+r*(i[2]-o),t[3]=a+r*(i[3]-a),t}function NTe(t,e){const i=sC;let r,n,s,o,a,l;e=e||1;do r=2*i()-1,n=2*i()-1,a=r*r+n*n;while(a>=1);do s=2*i()-1,o=2*i()-1,l=s*s+o*o;while(l>=1);const c=Math.sqrt((1-a)/l);return t[0]=e*r,t[1]=e*n,t[2]=e*s*c,t[3]=e*o*c,t}function Use(t,e,i){const r=e[0],n=e[1],s=e[2],o=e[3];return t[0]=i[0]*r+i[4]*n+i[8]*s+i[12]*o,t[1]=i[1]*r+i[5]*n+i[9]*s+i[13]*o,t[2]=i[2]*r+i[6]*n+i[10]*s+i[14]*o,t[3]=i[3]*r+i[7]*n+i[11]*s+i[15]*o,t}function VTe(t,e,i){const r=e[0],n=e[1],s=e[2],o=i[0],a=i[1],l=i[2],c=i[3],u=c*r+a*s-l*n,h=c*n+l*r-o*s,f=c*s+o*n-a*r,m=-o*r-a*n-l*s;return t[0]=u*c+m*-o+h*-l-f*-a,t[1]=h*c+m*-a+f*-o-u*-l,t[2]=f*c+m*-l+u*-a-h*-o,t[3]=e[3],t}function zTe(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function Gse(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function Hse(t,e){const i=t[0],r=t[1],n=t[2],s=t[3],o=e[0],a=e[1],l=e[2],c=e[3],u=Bo();return Math.abs(i-o)<=u*Math.max(1,Math.abs(i),Math.abs(o))&&Math.abs(r-a)<=u*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(n-l)<=u*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(s-c)<=u*Math.max(1,Math.abs(s),Math.abs(c))}const jTe=Rse,BTe=Fse,UTe=Dse,GTe=Vse,HTe=zse,qTe=MB,WTe=$B;Object.freeze(Object.defineProperty({__proto__:null,add:Lse,ceil:ATe,copy:qI,dist:GTe,distance:Vse,div:UTe,divide:Dse,dot:Bse,equals:Hse,exactEquals:Gse,floor:kTe,inverse:DTe,len:qTe,length:MB,lerp:AB,max:OTe,min:PTe,mul:BTe,multiply:Fse,negate:FTe,normalize:jse,random:NTe,round:LTe,scale:Nse,scaleAndAdd:RTe,set:Ose,sqrDist:HTe,sqrLen:WTe,squaredDistance:zse,squaredLength:$B,str:zTe,sub:jTe,subtract:Rse,transformMat4:Use,transformQuat:VTe},Symbol.toStringTag,{value:"Module"}));const cq=new Float32Array(1);function Ggt(t){--t;for(let e=1;e<32;e<<=1)t|=t>>e;return t+1}function Pn(t,e,i){return Math.min(Math.max(t,e),i)}function Hgt(t){return(t&t-1)==0}function qgt(t){return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,++t}function kB(t,e,i){return t+(e-t)*i}function qse(t){return t*Math.PI/180}function Wse(t){return 180*t/Math.PI}function Wgt(t,e=1e-6){return(t<0?-1:1)/Math.max(Math.abs(t),e)}function QO(t){return Math.acos(Pn(t,-1,1))}function Jse(t){return Math.asin(Pn(t,-1,1))}function Cw(t,e,i=1e-6){return t===e?!0:!Number.isFinite(t)||!Number.isFinite(e)?!1:(t>e?t-e:e-t)<=i}const Wk=new DataView(new ArrayBuffer(Float64Array.BYTES_PER_ELEMENT));function JTe(t){return Wk.setFloat64(0,t),Wk.getBigInt64(0)}function ZTe(t){return Wk.setBigInt64(0,t),Wk.getFloat64(0)}const g3=BigInt("1000000");YTe(1);function YTe(t){const e=JTe(t=Math.abs(t)),i=ZTe(e<=g3?g3:e-g3);return Math.abs(t-i)}function Jgt(t){return Zse(Math.max(-Jm,Math.min(t,Jm)))}function Zse(t){return cq[0]=t,cq[0]}function uq(t,e){const i=vs(t),r=Jse(t[2]/i),n=Math.atan2(t[1]/i,t[0]/i);return Bi(e,i,r,n),e}function Zgt(t){const e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],i=t[3]*t[3]+t[4]*t[4]+t[5]*t[5],r=t[6]*t[6]+t[7]*t[7]+t[8]*t[8];return!(Cw(e,1)&&Cw(i,1)&&Cw(r,1))}const Jm=Zse(34028234663852886e22);function _E(t){return Pn(H6(t),0,255)}function bE(t,e,i){return t=Number(t),isNaN(t)?i:t<e?e:t>i?i:t}let $$=class xs{static blendColors(e,i,r,n=new xs){return n.r=Math.round(e.r+(i.r-e.r)*r),n.g=Math.round(e.g+(i.g-e.g)*r),n.b=Math.round(e.b+(i.b-e.b)*r),n.a=e.a+(i.a-e.a)*r,n._sanitize()}static fromRgb(e,i){const r=e.toLowerCase().match(/^(rgba?|hsla?)\(([\s\.\-,%0-9]+)\)/);if(r){const n=r[2].split(/\s*,\s*/),s=r[1];if(s==="rgb"&&n.length===3||s==="rgba"&&n.length===4){const o=n[0];if(o.charAt(o.length-1)==="%"){const a=n.map(l=>2.56*parseFloat(l));return n.length===4&&(a[3]=parseFloat(n[3])),xs.fromArray(a,i)}return xs.fromArray(n.map(a=>parseFloat(a)),i)}if(s==="hsl"&&n.length===3||s==="hsla"&&n.length===4)return xs.fromArray(bse(parseFloat(n[0]),parseFloat(n[1])/100,parseFloat(n[2])/100,parseFloat(n[3])),i)}return null}static fromHex(e,i=new xs){if(e.length!==4&&e.length!==7||e[0]!=="#")return null;const r=e.length===4?4:8,n=(1<<r)-1;let s=+("0x"+e.substr(1));return isNaN(s)?null:(["b","g","r"].forEach(o=>{const a=s&n;s>>=r,i[o]=r===4?17*a:a}),i.a=1,i)}static fromArray(e,i=new xs){return i._set(Number(e[0]),Number(e[1]),Number(e[2]),Number(e[3])),isNaN(i.a)&&(i.a=1),i._sanitize()}static fromString(e,i){const r=_se(e)?TB(e):null;return r&&xs.fromArray(r,i)||xs.fromRgb(e,i)||xs.fromHex(e,i)}static fromJSON(e){return e&&new xs([e[0],e[1],e[2],e[3]/255])}static toUnitRGB(e){return e!=null?[e.r/255,e.g/255,e.b/255]:null}static toUnitRGBA(e){return e!=null?[e.r/255,e.g/255,e.b/255,e.a!=null?e.a:1]:null}constructor(e){this.r=255,this.g=255,this.b=255,this.a=1,e&&this.setColor(e)}get isBright(){return .299*this.r+.587*this.g+.114*this.b>=127}setColor(e){return typeof e=="string"?xs.fromString(e,this):Array.isArray(e)?xs.fromArray(e,this):(this._set(e.r??0,e.g??0,e.b??0,e.a??1),e instanceof xs||this._sanitize()),this}toRgb(){return[this.r,this.g,this.b]}toRgba(){return[this.r,this.g,this.b,this.a]}toHex(){const e=this.r.toString(16),i=this.g.toString(16),r=this.b.toString(16);return`#${e.length<2?"0"+e:e}${i.length<2?"0"+i:i}${r.length<2?"0"+r:r}`}toCss(e=!1){const i=this.r+", "+this.g+", "+this.b;return e?`rgba(${i}, ${this.a})`:`rgb(${i})`}toString(){return this.toCss(!0)}toJSON(){return this.toArray()}toArray(e=xs.AlphaMode.ALWAYS){const i=_E(this.r),r=_E(this.g),n=_E(this.b);return e===xs.AlphaMode.ALWAYS||this.a!==1?[i,r,n,_E(255*this.a)]:[i,r,n]}clone(){return new xs(this.toRgba())}hash(){return this.r<<24|this.g<<16|this.b<<8|255*this.a}equals(e){return e!=null&&e.r===this.r&&e.g===this.g&&e.b===this.b&&e.a===this.a}_sanitize(){return this.r=Math.round(bE(this.r,0,255)),this.g=Math.round(bE(this.g,0,255)),this.b=Math.round(bE(this.b,0,255)),this.a=bE(this.a,0,1),this}_set(e,i,r,n){this.r=e,this.g=i,this.b=r,this.a=n}};$$.prototype.declaredClass="esri.Color",function(t){var e;(e=t.AlphaMode||(t.AlphaMode={}))[e.ALWAYS=0]="ALWAYS",e[e.UNLESS_OPAQUE=1]="UNLESS_OPAQUE"}($$||($$={}));const ce=$$;function Ygt(t){}function JD(t){return()=>t}function xe(t,e={}){const i=t instanceof He?t:new He(t,e),r={type:(e==null?void 0:e.ignoreUnknown)??1?i.apiValues:String,json:{type:i.jsonValues,read:!(e!=null&&e.readOnly)&&{reader:i.read},write:{writer:i.write}}};return(e==null?void 0:e.readOnly)!==void 0&&(r.readOnly=!!e.readOnly),(e==null?void 0:e.default)!==void 0&&(r.json.default=e.default),(e==null?void 0:e.name)!==void 0&&(r.json.name=e.name),(e==null?void 0:e.nonNullable)!==void 0&&(r.nonNullable=e.nonNullable),p(r)}var ZD;let A$=ZD=class extends te{constructor(t){super(t),this.type="none"}clone(){return new ZD({type:this.type})}};d([xe({none:"none",stayAbove:"stay-above"})],A$.prototype,"type",void 0),A$=ZD=d([A("esri.ground.NavigationConstraint")],A$);function eL(t){const e=H6(100*(1-t));return Math.max(0,Math.min(e,100))}function WI(t){const e=1-t/100;return Math.max(0,Math.min(e,1))}var YD;let dh=YD=class extends R1(Su){constructor(t){super(t),this.opacity=1,this.surfaceColor=null,this.navigationConstraint=null,this.layers=new ye;const e=r=>{r.parent&&r.parent!==this&&"remove"in r.parent&&r.parent.remove(r),r.parent=this,r.type!=="elevation"&&r.type!=="base-elevation"&&ie.getLogger(this).error(`Layer '${r.title}, id:${r.id}' of type '${r.type}' is not supported as a ground layer and will therefore be ignored. Only layers of type 'elevation' are supported.`)},i=r=>{r.parent=null};this.addHandles([this.layers.on("after-add",r=>e(r.item)),this.layers.on("after-remove",r=>i(r.item))])}initialize(){this.when().catch(t=>{ys(t)||ie.getLogger(this).error("#load()","Failed to load ground",t)}),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}destroy(){const t=this.layers.removeAll();for(const e of t)e.destroy();this.layers.destroy()}normalizeCtorArgs(t){return t&&"resourceInfo"in t&&(this._set("resourceInfo",t.resourceInfo),delete(t={...t}).resourceInfo),t}set layers(t){this._set("layers",rg(t,this._get("layers")))}writeLayers(t,e,i,r){const n=[];t&&(r={...r,layerContainerType:"ground"},t.forEach(s=>{if("write"in s){const o={};JD(s)().write(o,r)&&n.push(o)}else r&&r.messages&&r.messages.push(new N("layer:unsupported",`Layers (${s.title}, ${s.id}) of type '${s.declaredClass}' cannot be persisted in the ground`,{layer:s}))})),e.layers=n}load(t){return this.addResolvingPromise(this._loadFromSource(t)),Promise.resolve(this)}loadAll(){return Fne(this,t=>{t(this.layers)})}async queryElevation(t,e){await this.load({signal:e==null?void 0:e.signal});const{ElevationQuery:i}=await W(()=>Promise.resolve().then(()=>cee),void 0,import.meta.url);_t(e);const r=new i,n=this.layers.filter(dq).toArray();return r.queryAll(n,t,e)}async createElevationSampler(t,e){await this.load({signal:e==null?void 0:e.signal});const{ElevationQuery:i}=await W(()=>Promise.resolve().then(()=>cee),void 0,import.meta.url);_t(e);const r=new i,n=this.layers.filter(dq).toArray();return r.createSamplerAll(n,t,e)}clone(){const t={opacity:this.opacity,surfaceColor:U(this.surfaceColor),navigationConstraint:U(this.navigationConstraint),layers:this.layers.slice()};return this.loaded&&(t.loadStatus="loaded"),new YD({resourceInfo:this.resourceInfo}).set(t)}read(t,e){this.resourceInfo||this._set("resourceInfo",{data:t,context:e}),super.read(t,e)}_loadFromSource(t){const e=this.resourceInfo;return e?this._loadLayersFromJSON(e.data,e.context,t):Promise.resolve()}_loadLayersFromJSON(t,e,i){const r=e&&e.origin||"web-scene",n=e&&e.portal||null,s=e&&e.url||null;return W(()=>import("./layersCreator-db5b7a0b.js"),["./layersCreator-db5b7a0b.js","./lazyLayerLoader-31902c6f.js","./portalLayers-c35a0770.js","./layersLoader-58213128.js","./fetchService-7b5fa001.js","./jsonContext-0bf4b056.js"],import.meta.url).then(({populateOperationalLayers:o})=>{_t(i);const a=[];if(t.layers&&Array.isArray(t.layers)){const l={context:{origin:r,url:s,portal:n,layerContainerType:"ground"},defaultLayerType:"ArcGISTiledElevationServiceLayer"};a.push(o(this.layers,t.layers,l))}return br(a)}).then(()=>{})}};function KTe(t){return t&&"createElevationSampler"in t}function dq(t){return t.type==="elevation"||KTe(t)}d([p({json:{read:!1}})],dh.prototype,"layers",null),d([ge("layers")],dh.prototype,"writeLayers",null),d([p({readOnly:!0})],dh.prototype,"resourceInfo",void 0),d([p({type:Number,nonNullable:!0,range:{min:0,max:1},json:{type:wt,read:{reader:WI,source:"transparency"},write:{writer:(t,e)=>{e.transparency=eL(t)},target:"transparency"}}})],dh.prototype,"opacity",void 0),d([p({type:ce,json:{type:[wt],write:(t,e)=>{e.surfaceColor=t.toJSON().slice(0,3)}}})],dh.prototype,"surfaceColor",void 0),d([p({type:A$,json:{write:!0}})],dh.prototype,"navigationConstraint",void 0),dh=YD=d([A("esri.Ground")],dh);const JI=dh;let W_=class extends ye{constructor(e){super(e),this.getCollections=null}initialize(){this.own(G6(()=>this._refresh()))}destroy(){this.getCollections=null}_refresh(){const e=this.getCollections!=null?this.getCollections():null;if(e==null)return void this.removeAll();let i=0;for(const r of e)r!=null&&(i=this._processCollection(i,r));this.splice(i,this.length)}_createNewInstance(e){return new ye(e)}_processCollection(e,i){if(!i)return e;const r=this.itemFilterFunction??(n=>!!n);for(const n of i)if(n){if(r(n)){const s=this.indexOf(n,e);s>=0?s!==e&&this.reorder(n,e):this.add(n,e),++e}if(this.getChildrenFunction){const s=this.getChildrenFunction(n);if(Array.isArray(s))for(const o of s)e=this._processCollection(e,o);else e=this._processCollection(e,s)}}return e}};d([p()],W_.prototype,"getCollections",void 0),d([p()],W_.prototype,"getChildrenFunction",void 0),d([p()],W_.prototype,"itemFilterFunction",void 0),W_=d([A("esri.core.CollectionFlattener")],W_);const ZI=W_,XTe=[["binary","application/octet-stream","bin",""]];function Xgt(t){return oC((t==null?void 0:t.supportedFormats)??[]).flatMap(LB).map(e=>`.${e}`)}function Qgt(t){const e={};for(const i of oC((t==null?void 0:t.supportedFormats)??[])){const r=OB(i),n=LB(i).map(s=>`.${s}`);e[r]??(e[r]=[]),e[r].push(...n)}return[{description:"3D Models",accept:e}]}function QTe(t,e){return PB(iCe(t,e))}function eCe(t,e){return PB(rCe(t,e))}function eyt(t,e){return OB(tCe(t,e))}function oC(t){return[...XTe,...t]}function tCe(t,e){return oC(e).find(i=>PB(i)===t)}function iCe(t,e){return oC(e).find(i=>OB(i)===t)}function rCe(t,e){const i=t.toLowerCase();return oC(e).find(r=>LB(r).some(n=>i.endsWith(n)))}function PB(t){return t==null?void 0:t[0]}function OB(t){return t==null?void 0:t[1]}function LB(t){return(t==null?void 0:t[2].split(","))??[]}function tyt(t){var e;return(e=t.tables)==null?void 0:e.find(i=>i.role==="assetMaps")}function aC(t){var e,i;return!(!(t&&typeof t=="object"&&"loaded"in t&&t.loaded&&((i=(e=Ro(t))==null?void 0:e.operations)!=null&&i.supportsEditing)&&"type"in t)||"editingEnabled"in t&&!KO(t)||t.type==="scene"&&!nCe(t))}function nCe(t){const e=t.infoFor3D;if(!e)return!0;const{supportedFormats:i,queryFormats:r}=e,n=QTe("model/gltf-binary",i)??eCe("glb",i);return n!=null&&r.includes(n)}const hq=ie.getLogger("esri.support.basemapUtils");function sCe(){return{}}function Yse(t){for(const e in t){const i=t[e];(i==null?void 0:i.destroyed)===!1&&i.destroy(),delete t[e]}}function k$(t,e){let i;if(typeof t=="string"){if(!(t in Qw)){const r=Object.entries(Qw).filter(([n,s])=>Lt.apiKey&&!s.classic||!Lt.apiKey&&s.classic&&!s.deprecated).map(([n])=>`"${n}"`).join(", ");return hq.warn(`Unable to find basemap definition for: ${t}. Try one of these: ${r}`),null}e&&(i=e[t]),i||(i=Gk.fromId(t),e&&(e[t]=i))}else i=lr(Gk,t);return i!=null&&i.destroyed&&(hq.warn("The provided basemap is already destroyed",{basemap:i}),i=null),i}function iyt(t,e){var i,r,n,s;return((r=(i=t.basemap)==null?void 0:i.referenceLayers)==null?void 0:r.some(o=>o.uid===e))||((s=(n=t.basemap)==null?void 0:n.baseLayers)==null?void 0:s.some(o=>o.uid===e))}function oCe(t){let e=null;const i=lCe(t),r=!(i!=null&&i.baseLayers.length);for(const n in Qw){const s=dCe(i,Kse(Qw[n]),{mustMatchReferences:r});if(s==="equal"){e=n;break}s==="base-layers-equal"&&(e=n)}return e}function aCe(t,e){var s;if(e==null||t==null)return{spatialReference:null,updating:!1};if(e.loadStatus==="not-loaded")return e.load(),{spatialReference:null,updating:!0};if(e.spatialReference)return{spatialReference:e.spatialReference,updating:!1};if(e.baseLayers.length===0)return{spatialReference:null,updating:!1};const i=e.baseLayers.at(0);switch(i.loadStatus){case"not-loaded":i.load();case"loading":return{spatialReference:null,updating:!0};case"failed":return{spatialReference:null,updating:!1}}const r=(("supportedSpatialReferences"in i?i.supportedSpatialReferences:null)||["tileInfo"in i?(s=i.tileInfo)==null?void 0:s.spatialReference:i.spatialReference]).filter(Boolean),n=t.spatialReference;return n?{spatialReference:r.find(o=>n.equals(o))??r[0]??null,updating:!1}:{spatialReference:r[0],updating:!1}}function lCe(t){return t?!t.loaded&&t.resourceInfo?Kse(t.resourceInfo.data):{baseLayers:pq(t.baseLayers),referenceLayers:pq(t.referenceLayers)}:null}function pq(t){return(ye.isCollection(t)?t.toArray():t).map(cCe)}function cCe(t){var e,i;return{type:t.type,url:Xse("urlTemplate"in t&&t.urlTemplate||t.url||"styleUrl"in t&&t.styleUrl||""),minScale:"minScale"in t&&t.minScale!=null?t.minScale:0,maxScale:"maxScale"in t&&t.maxScale!=null?t.maxScale:0,opacity:t.opacity!=null?t.opacity:1,visible:t.visible==null||!!t.visible,sublayers:t.type!=="map-image"&&t.type!=="wms"||t.sublayers==null||(e=t.sublayers)==null?void 0:e.map(r=>({id:r.id,visible:r.visible})),activeLayerId:t.type==="wmts"?(i=t.activeLayer)==null?void 0:i.id:void 0}}function Kse(t){return t?{baseLayers:fq((t.baseMapLayers??[]).filter(e=>!e.isReference)),referenceLayers:fq((t.baseMapLayers??[]).filter(e=>e.isReference))}:null}function fq(t){return t.map(e=>uCe(e))}function uCe(t){let e;switch(t.layerType){case"VectorTileLayer":e="vector-tile";break;case"ArcGISTiledMapServiceLayer":e="tile";break;default:e="unknown"}return{type:e,url:Xse(t.templateUrl||t.urlTemplate||t.styleUrl||t.url),minScale:t.minScale!=null?t.minScale:0,maxScale:t.maxScale!=null?t.maxScale:0,opacity:t.opacity!=null?t.opacity:1,visible:t.visibility==null||!!t.visibility,sublayers:void 0,activeLayerId:void 0}}function dCe(t,e,i){return t!=null!=(e!=null)?"not-equal":!t||!e?"equal":mq(t.baseLayers,e.baseLayers)?mq(t.referenceLayers,e.referenceLayers)?"equal":i.mustMatchReferences?"not-equal":"base-layers-equal":"not-equal"}function mq(t,e){if(t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(!hCe(t[i],e[i]))return!1;return!0}function hCe(t,e){if(t.type!==e.type||t.type==="scene"||t.url!==e.url||t.minScale!==e.minScale||t.maxScale!==e.maxScale||t.visible!==e.visible||t.opacity!==e.opacity)return!1;if(t.activeLayerId!=null||e.activeLayerId!=null)return t.activeLayerId===e.activeLayerId;if(t.sublayers!=null||e.sublayers!=null){if(t.sublayers==null||e.sublayers==null||t.sublayers.length!==e.sublayers.length)return!1;for(let i=0;i<t.sublayers.length;i++){const r=t.sublayers.at(i),n=e.sublayers.at(i);if((r==null?void 0:r.id)!==(n==null?void 0:n.id)||(r==null?void 0:r.visible)!==(n==null?void 0:n.visible))return!1}}return!0}function Xse(t){return t?ic(t).replace(/^\s*https?:/i,"").toLowerCase():""}function pCe(t){return new ZI({getCollections:()=>[t.tables,t.layers],getChildrenFunction:e=>{const i=[];return"tables"in e&&i.push(e.tables),"layers"in e&&i.push(e.layers),i},itemFilterFunction:e=>{const i=e.parent;return!!i&&"tables"in i&&i.tables.includes(e)}})}function y3(t){for(const e of t.values())e==null||e.destroy();t.clear()}const gq={"world-elevation":{id:"worldElevation",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"},"world-topobathymetry":{id:"worldTopoBathymetry",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/TopoBathy3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"}};function fCe(t){let e=null;if(typeof t=="string")if(t in gq){const i=gq[t];e=new JI({resourceInfo:{data:{layers:[i]}}})}else ie.getLogger("esri.support.groundUtils").warn(`Unable to find ground definition for: ${t}. Try "world-elevation"`);else e=lr(JI,t);return e}function i1(t,e,i=!1){let{hasM:r,hasZ:n}=t;Array.isArray(e)?e.length!==4||r||n?e.length===3&&i&&!r?(n=!0,r=!1):e.length===3&&r&&n&&(r=!1,n=!1):(r=!0,n=!0):(n=!n&&e.hasZ&&(!r||e.hasM),r=!r&&e.hasM&&(!n||e.hasZ)),t.hasZ=n,t.hasM=r}var KD;function yq(t){return(e,i)=>e==null?i:i==null?e:t(e,i)}function mCe(t){return t&&(t.declaredClass==="esri.geometry.SpatialReference"||t.wkid!=null)}let hf=KD=class extends Ep{constructor(...t){super(...t),this.points=[],this.type="multipoint"}normalizeCtorArgs(t,e){if(!t&&!e)return{};const i={};Array.isArray(t)?(i.points=t,i.spatialReference=e):mCe(t)?i.spatialReference=t:(t.points&&(i.points=t.points),t.spatialReference&&(i.spatialReference=t.spatialReference),t.hasZ&&(i.hasZ=t.hasZ),t.hasM&&(i.hasM=t.hasM));const r=i.points&&i.points[0];return r&&(i.hasZ===void 0&&i.hasM===void 0?(i.hasZ=r.length>2,i.hasM=!1):i.hasZ===void 0?i.hasZ=r.length>3:i.hasM===void 0&&(i.hasM=r.length>3)),i}get cache(){return this.commitProperty("points"),this.commitProperty("hasZ"),this.commitProperty("hasM"),this.commitProperty("spatialReference"),{}}get extent(){const t=this.points;if(!t.length)return null;const e=new Re,i=this.hasZ,r=this.hasM,n=i?3:2,s=t[0],o=yq(Math.min),a=yq(Math.max);let l,c,u,h,[f,m]=s,[g,y]=s;for(let v=0,b=t.length;v<b;v++){const w=t[v],[x,S]=w;if(f=o(f,x),m=o(m,S),g=a(g,x),y=a(y,S),i&&w.length>2){const I=w[2];l=o(l,I),u=a(u,I)}if(r&&w.length>n){const I=w[n];c=o(c,I),h=a(h,I)}}return e.xmin=f,e.ymin=m,e.xmax=g,e.ymax=y,e.spatialReference=this.spatialReference,i?(e.zmin=l,e.zmax=u):(e.zmin=void 0,e.zmax=void 0),r?(e.mmin=c,e.mmax=h):(e.mmin=void 0,e.mmax=void 0),e}writePoints(t,e){e.points=U(this.points)}addPoint(t){return i1(this,t),Array.isArray(t)?this.points.push(t):this.points.push(t.toArray()),this.notifyChange("points"),this}clone(){const t={points:U(this.points),spatialReference:this.spatialReference};return this.hasZ&&(t.hasZ=!0),this.hasM&&(t.hasM=!0),new KD(t)}getPoint(t){if(!this._validateInputs(t))return null;const e=this.points[t],i={x:e[0],y:e[1],spatialReference:this.spatialReference};let r=2;return this.hasZ&&(i.z=e[2],r=3),this.hasM&&(i.m=e[r]),new fe(i)}removePoint(t){if(!this._validateInputs(t))return null;const e=new fe(this.points.splice(t,1)[0],this.spatialReference);return this.notifyChange("points"),e}setPoint(t,e){return this._validateInputs(t)?(i1(this,e),Array.isArray(e)||(e=e.toArray()),this.points[t]=e,this.notifyChange("points"),this):this}toJSON(t){return this.write({},t)}_validateInputs(t){return t!=null&&t>=0&&t<this.points.length}};d([p({readOnly:!0})],hf.prototype,"cache",null),d([p()],hf.prototype,"extent",null),d([p({type:[[Number]],json:{write:{isRequired:!0}}})],hf.prototype,"points",void 0),d([ge("points")],hf.prototype,"writePoints",null),hf=KD=d([A("esri.geometry.Multipoint")],hf),hf.prototype.toJSON.isDefaultToJSON=!0;const Zm=hf;function ryt(t){const e=[];for(t.reset();t.nextPath();){const i=[];for(;t.nextPoint();)i.push([t.x,t.y]);e.push(i)}return t.reset(),e}function gCe(t){const e=[];for(;t.nextPoint();)e.push([t.x,t.y]);return t.seekPathStart(),e}function vq(t){if(!t)return null;if(Array.isArray(t))return t;const e=t.hasZ,i=t.hasM;if(t.type==="point")return i&&e?[t.x,t.y,t.z,t.m]:e?[t.x,t.y,t.z]:i?[t.x,t.y,t.m]:[t.x,t.y];if(t.type==="polygon")return t.rings.slice(0);if(t.type==="polyline")return t.paths.slice(0);if(t.type==="multipoint")return t.points.slice(0);if(t.type==="extent"){const r=t.clone().normalize();if(!r)return null;let n=!1,s=!1;return r.forEach(o=>{o.hasZ&&(n=!0),o.hasM&&(s=!0)}),r.map(o=>{const a=[[o.xmin,o.ymin],[o.xmin,o.ymax],[o.xmax,o.ymax],[o.xmax,o.ymin],[o.xmin,o.ymin]];if(n&&o.hasZ){const l=.5*(o.zmax-o.zmin);for(let c=0;c<a.length;c++)a[c].push(l)}if(s&&o.hasM){const l=.5*(o.mmax-o.mmin);for(let c=0;c<a.length;c++)a[c].push(l)}return a})}return null}function tL(t,e){const i=e[0]-t[0],r=e[1]-t[1];if(t.length>2&&e.length>2){const n=t[2]-e[2];return Math.sqrt(i*i+r*r+n*n)}return Math.sqrt(i*i+r*r)}function Qse(t,e,i){const r=t[0]+i*(e[0]-t[0]),n=t[1]+i*(e[1]-t[1]);return t.length>2&&e.length>2?[r,n,t[2]+i*(e[2]-t[2])]:[r,n]}function yCe(t,e,i,r){const[n,s]=e,[o,a]=i[r],[l,c]=i[r+1],u=l-o,h=c-a,f=u*u+h*h,m=(n-o)*u+(s-a)*h,g=Math.min(1,Math.max(0,m/f));return t[0]=o+u*g,t[1]=a+h*g,t}function nyt(t,e,i){let r,n,s,o,a=!1,l=1/0;for(i.reset();i.nextPath();)if(i.nextPoint())for(r=i.x,n=i.y;i.nextPoint();)s=i.x,o=i.y,n>e!=o>e&&t<(s-r)*(e-n)/(o-n)+r&&(a=!a),l=Math.min(l,vCe(t,e,r,n,s,o)),r=s,n=o;return l===0?0:(a?1:-1)*Math.sqrt(l)}function vCe(t,e,i,r,n,s){let o=i,a=r,l=n-o,c=s-a;if(l!==0||c!==0){const u=((t-o)*l+(e-a)*c)/(l*l+c*c);u>1?(o=n,a=s):u>0&&(o+=l*u,a+=c*u)}return l=t-o,c=e-a,l*l+c*c}function eoe(t,e){return Qse(t,e,.5)}function syt(t){const e=t.length;let i=0;for(let r=0;r<e-1;++r)i+=tL(t[r],t[r+1]);return i}function oyt(t,e){if(e<=0)return t[0];const i=t.length;let r=0;for(let n=0;n<i-1;++n){const s=tL(t[n],t[n+1]);if(e-r<s){const o=(e-r)/s;return Qse(t[n],t[n+1],o)}r+=s}return t[i-1]}function toe(t,e,i){const r=t.length;let n=0,s=0,o=0;for(let a=0;a<r;a++){const l=t[a],c=t[(a+1)%r];let u=2;n+=l[0]*c[1]-c[0]*l[1],l.length>2&&c.length>2&&i&&(s+=l[0]*c[2]-c[0]*l[2],u=3),l.length>u&&c.length>u&&e&&(o+=l[0]*c[u]-c[0]*l[u])}return n<=0&&s<=0&&o<=0}function _Ce(t){const e=t.length;return e>2&&JT(t[0],t[e-1])}function ayt(t){if("rings"in t&&(bCe(t),t.rings.length>0&&!toe(t.rings[0],t.hasM??!1,t.hasZ??!1)))for(const e of t.rings)e.reverse()}function bCe(t){if("rings"in t)for(const e of t.rings)_Ce(e)||e.push(e[0].slice())}function lyt(t){return t.type!=="polygon"&&t.type!=="polyline"||wCe(t.type==="polygon"?t.rings:t.paths,t.spatialReference),t}function wCe(t,e){const i=Do(e);if(!i)return;const r=i.valid[0],n=i.valid[1],s=n-r;for(const o of t){let a=1/0,l=-1/0;for(const u of o){const h=ioe(u[0],r,n);a=Math.min(a,h),l=Math.max(l,h),u[0]=h}const c=l-a;s-c<c&&o.forEach(u=>{u[0]<0&&(u[0]+=s)})}}function ioe(t,e,i){const r=i-e;return t<e?i-(e-t)%r:t>i?e+(t-e)%r:t}function cyt(t){if(!t||t.length<3)return 0;let e=0;const i=t.length-1;for(let r=0;r<i;r++)e+=(t[r][0]-t[r+1][0])*(t[r][1]+t[r+1][1]);return e+=(t[i][0]-t[0][0])*(t[i][1]+t[0][1]),-.5*e}function roe(t){if(!t||t.numPoints<3)return 0;let e,i,r=0;if(t.seekPathStart(),!t.nextPoint())return 0;e=t.x,i=t.y;const n=e,s=i;for(;t.nextPoint();)r+=(e-t.x)*(i+t.y),e=t.x,i=t.y;return r+=(e-n)*(i+s),-.5*r}function uyt(t,e){if(t===e)return!0;if(t.type!==e.type)return!1;if(t.type==="point"||t.type==="mesh"||t.type==="extent")return!0;if(t.type==="multipoint")return t.points.length===e.points.length;const[i,r]=t.type==="polyline"?[t.paths,e.paths]:[t.rings,e.rings];return i.length===r.length&&i.every((n,s)=>n.length===r[s].length)}function dyt(t){return t?t.hasZ?[t.xmax-t.xmin/2,t.ymax-t.ymin/2,t.zmax-t.zmin/2]:[t.xmax-t.xmin/2,t.ymax-t.ymin/2]:null}function xCe(t){return t?SCe(t.rings,t.hasZ??!1):null}function SCe(t,e){if(!t||!t.length)return null;const i=[],r=[],n=e?[1/0,-1/0,1/0,-1/0,1/0,-1/0]:[1/0,-1/0,1/0,-1/0];for(let s=0,o=t.length;s<o;s++){const a=noe(t[s],e,n);a&&r.push(a)}if(r.sort((s,o)=>{let a=s[2]-o[2];return a===0&&e&&(a=s[4]-o[4]),a}),r.length&&(i[0]=r[0][0],i[1]=r[0][1],e&&(i[2]=r[0][3]),(i[0]<n[0]||i[0]>n[1]||i[1]<n[2]||i[1]>n[3]||e&&(i[2]<n[4]||i[2]>n[5]))&&(i.length=0)),!i.length){const s=t[0]&&t[0].length?ICe(t[0],e):null;if(!s)return null;i[0]=s[0],i[1]=s[1],e&&s.length>2&&(i[2]=s[2])}return i}function noe(t,e,i){let r=0,n=0,s=0,o=0,a=0;const l=t.length?t[0][0]:0,c=t.length?t[0][1]:0,u=t.length&&e?t[0][2]:0;for(let f=0;f<t.length;f++){const m=t[f],g=t[(f+1)%t.length],[y,v,b]=m,w=y-l,x=v-c,[S,I,T]=g,C=S-l,E=I-c,$=w*E-C*x;if(o+=$,r+=(w+C)*$,n+=(x+E)*$,e&&m.length>2&&g.length>2){const P=b-u,k=T-u,L=w*k-C*P;s+=(P+k)*L,a+=L}y<i[0]&&(i[0]=y),y>i[1]&&(i[1]=y),v<i[2]&&(i[2]=v),v>i[3]&&(i[3]=v),e&&(b<i[4]&&(i[4]=b),b>i[5]&&(i[5]=b))}if(o>0&&(o*=-1),a>0&&(a*=-1),!o)return null;o*=.5,a*=.5;const h=[r/(6*o)+l,n/(6*o)+c,o];return e&&(i[4]===i[5]||a===0?(h[3]=(i[4]+i[5])/2,h[4]=0):(h[3]=s/(6*a)+u,h[4]=a)),h}function ICe(t,e){const i=e?[0,0,0]:[0,0],r=e?[0,0,0]:[0,0];let n=0,s=0,o=0,a=0;for(let l=0,c=t.length;l<c-1;l++){const u=t[l],h=t[l+1];if(u&&h){i[0]=u[0],i[1]=u[1],r[0]=h[0],r[1]=h[1],e&&u.length>2&&h.length>2&&(i[2]=u[2],r[2]=h[2]);const f=tL(i,r);if(f){n+=f;const m=eoe(u,h);s+=f*m[0],o+=f*m[1],e&&m.length>2&&(a+=f*m[2])}}}return n>0?e?[s/n,o/n,a/n]:[s/n,o/n]:t.length?t[0]:null}function TCe(t){const{hasZ:e,numPaths:i}=t;if(i===0)return null;const r=[],n=[],s=e?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY];for(t.reset();t.nextPath();){const o=noe(gCe(t),t.hasZ,s);o&&n.push(o)}if(n.sort((o,a)=>{let l=o[2]-a[2];return l===0&&e&&(l=o[4]-a[4]),l}),n.length&&(r[0]=n[0][0],r[1]=n[0][1],e&&(r[2]=n[0][3]),(r[0]<s[0]||r[0]>s[1]||r[1]<s[2]||r[1]>s[3]||e&&(r[2]<s[4]||r[2]>s[5]))&&(r.length=0)),!r.length){t.reset(),t.nextPath();const o=t.numPoints?CCe(t):null;if(!o)return null;r[0]=o[0],r[1]=o[1],e&&o.length>2&&(r[2]=o[2])}return r}function CCe(t){const{hasZ:e}=t,i=e?[0,0,0]:[0,0],r=e?[0,0,0]:[0,0];let n=0,s=0,o=0,a=0;if(t.nextPoint()){let l=t.x,c=t.y,u=t.z;for(;t.nextPoint();){const h=t.x,f=t.y,m=t.z;i[0]=l,i[1]=c,r[0]=h,r[1]=f,e&&(i[2]=u,r[2]=m);const g=tL(i,r);if(g){n+=g;const y=eoe(i,r);s+=g*y[0],o+=g*y[1],e&&y.length>2&&(a+=g*y[2])}l=h,c=f,u=m}}return n>0?e?[s/n,o/n,a/n]:[s/n,o/n]:t.numPoints?(t.seekPathStart(),t.nextPoint(),[t.x,t.y]):null}const ECe=1e-6;function hyt(t){let e=0;for(t.reset();t.nextPath();)e+=roe(t);if(e<ECe){const n=TCe(t);return n?[n[0],n[1]]:null}const i=[0,0];if(t.reset(),!t.nextPath()||!t.nextPoint())return null;const r=[t.x,t.y];for(t.reset();t.nextPath();)$Ce(i,r,t);return i[0]*=1/e,i[1]*=1/e,i[0]+=r[0],i[1]+=r[1],i}const MCe=1/3;function $Ce(t,e,i){if(!t||!i||i.numPoints<3)return null;i.nextPoint();const r=i.x,n=i.y;i.nextPoint();let s,o=i.x-r,a=i.y-n,l=0,c=0;for(;i.nextPoint();)l=i.x-r,c=i.y-n,s=.5*MCe*(l*a-c*o),t[0]+=s*(o+l),t[1]+=s*(a+c),o=l,a=c;const u=roe(i),h=[r,n];return h[0]-=e[0],h[1]-=e[1],h[0]*=u,h[1]*=u,t[0]+=h[0],t[1]+=h[1],t}function al(t=LCe){return[t[0],t[1],t[2],t[3]]}function pyt(t){return[t[0],t[1],t[2],t[3]]}function RB(t,e){return t!==e&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3]),t}function fyt(t,e,i,r,n=al()){return n[0]=t,n[1]=e,n[2]=i,n[3]=r,n}function ACe(t,e=al()){return e[0]=t.xmin,e[1]=t.ymin,e[2]=t.xmax,e[3]=t.ymax,e}function soe(t,e){return new Re({xmin:t[0],ymin:t[1],xmax:t[2],ymax:t[3],spatialReference:e})}function myt(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function gyt(t,e,i){if(e!=null)if("length"in e)QD(e)?(i[0]=Math.min(t[0],e[0]),i[1]=Math.min(t[1],e[1]),i[2]=Math.max(t[2],e[2]),i[3]=Math.max(t[3],e[3])):e.length!==2&&e.length!==3||(i[0]=Math.min(t[0],e[0]),i[1]=Math.min(t[1],e[1]),i[2]=Math.max(t[2],e[0]),i[3]=Math.max(t[3],e[1]));else switch(e.type){case"extent":i[0]=Math.min(t[0],e.xmin),i[1]=Math.min(t[1],e.ymin),i[2]=Math.max(t[2],e.xmax),i[3]=Math.max(t[3],e.ymax);break;case"point":i[0]=Math.min(t[0],e.x),i[1]=Math.min(t[1],e.y),i[2]=Math.max(t[2],e.x),i[3]=Math.max(t[3],e.y)}else RB(i,t)}function v3(t,e,i=t){const r=e.length;let n=t[0],s=t[1],o=t[2],a=t[3];for(let l=0;l<r;l++){const c=e[l];n=Math.min(n,c[0]),s=Math.min(s,c[1]),o=Math.max(o,c[0]),a=Math.max(a,c[1])}return i[0]=n,i[1]=s,i[2]=o,i[3]=a,i}function yyt(t){for(let e=0;e<4;e++)if(!isFinite(t[e]))return!1;return!0}function kCe(t){return t==null||t[0]>=t[2]?0:t[2]-t[0]}function PCe(t){return t[1]>=t[3]?0:t[3]-t[1]}function vyt(t){return kCe(t)*PCe(t)}function _yt(t,e=[0,0]){return e[0]=(t[0]+t[2])/2,e[1]=(t[1]+t[3])/2,e}function byt(t,e){return FB(t,e[0],e[1])}function wyt(t,e){return FB(t,e.x,e.y)}function FB(t,e,i){return e>=t[0]&&i>=t[1]&&e<=t[2]&&i<=t[3]}function xyt(t,e,i){return e[0]>=t[0]-i&&e[1]>=t[1]-i&&e[0]<=t[2]+i&&e[1]<=t[3]+i}function Syt(t,e){return Math.max(e[0],t[0])<=Math.min(e[2],t[2])&&Math.max(e[1],t[1])<=Math.min(e[3],t[3])}function XD(t,e){return e[0]>=t[0]&&e[2]<=t[2]&&e[1]>=t[1]&&e[3]<=t[3]}function Iyt(t,e,i,r=t){return r[0]=t[0]+e,r[1]=t[1]+i,r[2]=t[2]+e,r[3]=t[3]+i,r}function OCe(t){return t?RB(t,_q):al(_q)}function QD(t){return t!=null&&t.length===4}function Tyt(t,e){return QD(t)&&QD(e)?t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]:t===e}const _q=[1/0,1/0,-1/0,-1/0],LCe=[0,0,0,0];function ooe(t){return t.xmin!==void 0&&t.ymin!==void 0&&t.xmax!==void 0&&t.ymax!==void 0}function aoe(t){return t.points!==void 0}function loe(t){return t.x!==void 0&&t.y!==void 0}function coe(t){return t.paths!==void 0}function uoe(t){return t.rings!==void 0}function doe(t){function e(i,r){return i==null?r:r==null?i:t(i,r)}return e}const Em=doe(Math.min),Mm=doe(Math.max);function Cyt(t,e){return coe(e)?r1(t,e.paths,!1,!1):uoe(e)?r1(t,e.rings,!1,!1):aoe(e)?DB(t,e.points,!1,!1,!1,!1):ooe(e)?hoe(t,e):(loe(e)&&(t[0]=e.x,t[1]=e.y,t[2]=e.x,t[3]=e.y),t)}function Eyt(t){let e,i,r,n;for(t.reset(),e=r=1/0,i=n=-1/0;t.nextPath();){const s=RCe(t);e=Math.min(s[0],e),r=Math.min(s[1],r),i=Math.max(s[2],i),n=Math.max(s[3],n)}return al([e,r,i,n])}function RCe(t){let e,i,r,n;for(e=r=1/0,i=n=-1/0;t.nextPoint();)e=Math.min(t.x,e),r=Math.min(t.y,r),i=Math.max(t.x,i),n=Math.max(t.y,n);return al([e,r,i,n])}function Myt(t,e){return coe(e)?r1(t,e.paths,!0,!1):uoe(e)?r1(t,e.rings,!0,!1):aoe(e)?DB(t,e.points,!0,!1,!0,!1):ooe(e)?hoe(t,e,!0,!1,!0,!1):(loe(e)&&(t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.x,t[4]=e.y,t[5]=e.z),t)}function r1(t,e,i,r){const n=i?3:2;if(!e.length||!e[0].length)return null;let s,o,a,l,[c,u]=e[0][0],[h,f]=e[0][0];for(let m=0;m<e.length;m++){const g=e[m];for(let y=0;y<g.length;y++){const v=g[y],[b,w]=v;if(c=Em(c,b),u=Em(u,w),h=Mm(h,b),f=Mm(f,w),i&&v.length>2){const x=v[2];s=Em(s,x),o=Mm(o,x)}if(r&&v.length>n){const x=v[n];a=Em(s,x),l=Mm(o,x)}}}return i?r?(t[0]=c,t[1]=u,t[2]=s,t[3]=a,t[4]=h,t[5]=f,t[6]=o,t[7]=l,t.length=8,t):(t[0]=c,t[1]=u,t[2]=s,t[3]=h,t[4]=f,t[5]=o,t.length=6,t):r?(t[0]=c,t[1]=u,t[2]=a,t[3]=h,t[4]=f,t[5]=l,t.length=6,t):(t[0]=c,t[1]=u,t[2]=h,t[3]=f,t.length=4,t)}function hoe(t,e,i,r,n,s){const o=e.xmin,a=e.xmax,l=e.ymin,c=e.ymax;let u=e.zmin,h=e.zmax,f=e.mmin,m=e.mmax;return n?(u=u||0,h=h||0,s?(f=f||0,m=m||0,t[0]=o,t[1]=l,t[2]=u,t[3]=f,t[4]=a,t[5]=c,t[6]=h,t[7]=m,t):(t[0]=o,t[1]=l,t[2]=u,t[3]=a,t[4]=c,t[5]=h,t)):s?(f=f||0,m=m||0,t[0]=o,t[1]=l,t[2]=f,t[3]=a,t[4]=c,t[5]=m,t):(t[0]=o,t[1]=l,t[2]=a,t[3]=c,t)}function DB(t,e,i,r,n,s){const o=i?3:2,a=r&&s,l=i&&n;if(!e.length||!e[0].length)return null;let c,u,h,f,[m,g]=e[0],[y,v]=e[0];for(let b=0;b<e.length;b++){const w=e[b],[x,S]=w;if(m=Em(m,x),g=Em(g,S),y=Mm(y,x),v=Mm(v,S),l&&w.length>2){const I=w[2];c=Em(c,I),u=Mm(u,I)}if(a&&w.length>o){const I=w[o];h=Em(c,I),f=Mm(u,I)}}return n?(c=c||0,u=u||0,s?(h=h||0,f=f||0,t[0]=m,t[1]=g,t[2]=c,t[3]=h,t[4]=y,t[5]=v,t[6]=u,t[7]=f,t):(t[0]=m,t[1]=g,t[2]=c,t[3]=y,t[4]=v,t[5]=u,t)):s?(h=h||0,f=f||0,t[0]=m,t[1]=g,t[2]=h,t[3]=y,t[4]=v,t[5]=f,t):(t[0]=m,t[1]=g,t[2]=y,t[3]=v,t)}function FCe(t){return t.xmin!==void 0&&t.ymin!==void 0&&t.xmax!==void 0&&t.ymax!==void 0}function DCe(t){return t.points!==void 0}function NCe(t){return t.x!==void 0&&t.y!==void 0}function VCe(t){return t.paths!==void 0}function zCe(t){return t.rings!==void 0}const NB=[];function poe(t,e,i,r){return{xmin:t,ymin:e,xmax:i,ymax:r}}function foe(t,e,i,r,n,s){return{xmin:t,ymin:e,zmin:i,xmax:r,ymax:n,zmax:s}}function moe(t,e,i,r,n,s){return{xmin:t,ymin:e,mmin:i,xmax:r,ymax:n,mmax:s}}function goe(t,e,i,r,n,s,o,a){return{xmin:t,ymin:e,zmin:i,mmin:r,xmax:n,ymax:s,zmax:o,mmax:a}}function VB(t,e=!1,i=!1){return e?i?goe(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]):foe(t[0],t[1],t[2],t[3],t[4],t[5]):i?moe(t[0],t[1],t[2],t[3],t[4],t[5]):poe(t[0],t[1],t[2],t[3])}function $yt(t){return t?FCe(t)?t:NCe(t)?BCe(t):zCe(t)?yoe(t):VCe(t)?voe(t):DCe(t)?jCe(t):null:null}function jCe(t){const{hasZ:e,hasM:i,points:r}=t;return VB(DB(NB,r,e??!1,i??!1),e,i)}function BCe(t){const{x:e,y:i,z:r,m:n}=t,s=n!=null;return r!=null?s?goe(e,i,r,n,e,i,r,n):foe(e,i,r,e,i,r):s?moe(e,i,n,e,i,n):poe(e,i,e,i)}function yoe(t){const{hasZ:e,hasM:i,rings:r}=t,n=r1(NB,r,e??!1,i??!1);return n?VB(n,e,i):null}function voe(t){const{hasZ:e,hasM:i,paths:r}=t,n=r1(NB,r,e??!1,i??!1);return n?VB(n,e,i):null}var P$;function bq(t){return!Array.isArray(t[0])}let Gu=P$=class extends Ep{static fromExtent(t){const e=t.clone().normalize(),i=t.spatialReference;let r=!1,n=!1;for(const o of e)o.hasZ&&(r=!0),o.hasM&&(n=!0);const s={rings:e.map(o=>{const a=[[o.xmin,o.ymin],[o.xmin,o.ymax],[o.xmax,o.ymax],[o.xmax,o.ymin],[o.xmin,o.ymin]];if(r&&o.hasZ){const l=o.zmin+.5*(o.zmax-o.zmin);for(let c=0;c<a.length;c++)a[c].push(l)}if(n&&o.hasM){const l=o.mmin+.5*(o.mmax-o.mmin);for(let c=0;c<a.length;c++)a[c].push(l)}return a}),spatialReference:i};return r&&(s.hasZ=!0),n&&(s.hasM=!0),new P$(s)}constructor(...t){super(...t),this.rings=[],this.type="polygon"}normalizeCtorArgs(t,e){let i,r,n=null,s=null;return t&&!Array.isArray(t)?(n=t.rings??null,e||(t.spatialReference?e=t.spatialReference:t.rings||(e=t)),i=t.hasZ,r=t.hasM):n=t,n=n||[],e=e||Ee.WGS84,n.length&&n[0]&&n[0][0]!=null&&typeof n[0][0]=="number"&&(n=[n]),s=n[0]&&n[0][0],s&&(i===void 0&&r===void 0?(i=s.length>2,r=s.length>3):i===void 0?i=r?s.length>3:s.length>2:r===void 0&&(r=i?s.length>3:s.length>2)),{rings:n,spatialReference:e,hasZ:i,hasM:r}}get cache(){return this.commitProperty("rings"),this.commitProperty("hasZ"),this.commitProperty("hasM"),this.commitProperty("spatialReference"),{}}get centroid(){const t=xCe(this);if(!t||isNaN(t[0])||isNaN(t[1])||this.hasZ&&isNaN(t[2]))return null;const e=new fe;return e.x=t[0],e.y=t[1],e.spatialReference=this.spatialReference,this.hasZ&&(e.z=t[2]),e}get extent(){const{spatialReference:t}=this,e=yoe(this);if(!e)return null;const i=new Re(e);return i.spatialReference=t,i}get isSelfIntersecting(){return mIe(this.rings)}writeRings(t,e){e.rings=U(this.rings)}addRing(t){if(!t)return;const e=this.rings,i=e.length;if(bq(t)){const r=[];for(let n=0,s=t.length;n<s;n++)r[n]=t[n].toArray();e[i]=r}else e[i]=t.concat();return this.notifyChange("rings"),this}clone(){const t=new P$;return t.spatialReference=this.spatialReference,t.rings=U(this.rings),t.hasZ=this.hasZ,t.hasM=this.hasM,t}equals(t){if(this===t)return!0;if(t==null)return!1;const e=this.spatialReference,i=t.spatialReference;if(e!=null!=(i!=null)||e!=null&&i!=null&&!e.equals(i)||this.rings.length!==t.rings.length)return!1;const r=([n,s,o,a],[l,c,u,h])=>n===l&&s===c&&(o==null&&u==null||o===u)&&(a==null&&h==null||a===h);for(let n=0;n<this.rings.length;n++){const s=this.rings[n],o=t.rings[n];if(!JT(s,o,r))return!1}return!0}contains(t){if(!t)return!1;const e=rC(t,this.spatialReference);return use(this,e??t)}isClockwise(t){let e;return e=bq(t)?t.map(i=>this.hasZ?this.hasM?[i.x,i.y,i.z,i.m]:[i.x,i.y,i.z]:[i.x,i.y]):t,toe(e,this.hasM,this.hasZ)}getPoint(t,e){if(!this._validateInputs(t,e))return null;const i=this.rings[t][e],r=this.hasZ,n=this.hasM;return r&&!n?new fe(i[0],i[1],i[2],void 0,this.spatialReference):n&&!r?new fe(i[0],i[1],void 0,i[2],this.spatialReference):r&&n?new fe(i[0],i[1],i[2],i[3],this.spatialReference):new fe(i[0],i[1],this.spatialReference)}insertPoint(t,e,i){return this._validateInputs(t,e,!0)?(i1(this,i),Array.isArray(i)||(i=i.toArray()),this.rings[t].splice(e,0,i),this.notifyChange("rings"),this):this}removePoint(t,e){if(!this._validateInputs(t,e))return null;const i=new fe(this.rings[t].splice(e,1)[0],this.spatialReference);return this.notifyChange("rings"),i}removeRing(t){if(!this._validateInputs(t,null))return null;const e=this.rings.splice(t,1)[0],i=this.spatialReference,r=e.map(n=>new fe(n,i));return this.notifyChange("rings"),r}setPoint(t,e,i){return this._validateInputs(t,e)?(i1(this,i),Array.isArray(i)||(i=i.toArray()),this.rings[t][e]=i,this.notifyChange("rings"),this):this}_validateInputs(t,e,i=!1){if(t==null||t<0||t>=this.rings.length)return!1;if(e!=null){const r=this.rings[t];if(i&&(e<0||e>r.length)||!i&&(e<0||e>=r.length))return!1}return!0}toJSON(t){return this.write({},t)}};d([p({readOnly:!0})],Gu.prototype,"cache",null),d([p({readOnly:!0})],Gu.prototype,"centroid",null),d([p({readOnly:!0})],Gu.prototype,"extent",null),d([p({readOnly:!0})],Gu.prototype,"isSelfIntersecting",null),d([p({type:[[[Number]]],json:{write:{isRequired:!0}}})],Gu.prototype,"rings",void 0),d([ge("rings")],Gu.prototype,"writeRings",null),Gu=P$=d([A("esri.geometry.Polygon")],Gu),Gu.prototype.toJSON.isDefaultToJSON=!0;const Zn=Gu;var eN;function UCe(t){return!Array.isArray(t[0])}let pf=eN=class extends Ep{constructor(...t){super(...t),this.paths=[],this.type="polyline"}normalizeCtorArgs(t,e){let i,r,n=null,s=null;return t&&!Array.isArray(t)?(n=t.paths??null,e||(t.spatialReference?e=t.spatialReference:t.paths||(e=t)),i=t.hasZ,r=t.hasM):n=t,n=n||[],e=e||Ee.WGS84,n.length&&n[0]&&n[0][0]!=null&&typeof n[0][0]=="number"&&(n=[n]),s=n[0]&&n[0][0],s&&(i===void 0&&r===void 0?(i=s.length>2,r=!1):i===void 0?i=!r&&s.length>3:r===void 0&&(r=!i&&s.length>3)),{paths:n,spatialReference:e,hasZ:i,hasM:r}}get cache(){return this.commitProperty("paths"),this.commitProperty("hasZ"),this.commitProperty("hasM"),this.commitProperty("spatialReference"),{}}get extent(){const{spatialReference:t}=this,e=voe(this);if(!e)return null;const i=new Re(e);return i.spatialReference=t,i}writePaths(t,e){e.paths=U(this.paths)}addPath(t){if(!t)return;const e=this.paths,i=e.length;if(UCe(t)){const r=[];for(let n=0,s=t.length;n<s;n++)r[n]=t[n].toArray();e[i]=r}else e[i]=t.concat();return this.notifyChange("paths"),this}clone(){const t=new eN;return t.spatialReference=this.spatialReference,t.paths=U(this.paths),t.hasZ=this.hasZ,t.hasM=this.hasM,t}getPoint(t,e){if(!this._validateInputs(t,e))return null;const i=this.paths[t][e],r=this.hasZ,n=this.hasM;return r&&!n?new fe(i[0],i[1],i[2],void 0,this.spatialReference):n&&!r?new fe(i[0],i[1],void 0,i[2],this.spatialReference):r&&n?new fe(i[0],i[1],i[2],i[3],this.spatialReference):new fe(i[0],i[1],this.spatialReference)}insertPoint(t,e,i){return this._validateInputs(t,e,!0)?(i1(this,i),Array.isArray(i)||(i=i.toArray()),this.paths[t].splice(e,0,i),this.notifyChange("paths"),this):this}removePath(t){if(!this._validateInputs(t,null))return null;const e=this.paths.splice(t,1)[0],i=this.spatialReference,r=e.map(n=>new fe(n,i));return this.notifyChange("paths"),r}removePoint(t,e){if(!this._validateInputs(t,e))return null;const i=new fe(this.paths[t].splice(e,1)[0],this.spatialReference);return this.notifyChange("paths"),i}setPoint(t,e,i){return this._validateInputs(t,e)?(i1(this,i),Array.isArray(i)||(i=i.toArray()),this.paths[t][e]=i,this.notifyChange("paths"),this):this}_validateInputs(t,e,i=!1){if(t==null||t<0||t>=this.paths.length)return!1;if(e!=null){const r=this.paths[t];if(i&&(e<0||e>r.length)||!i&&(e<0||e>=r.length))return!1}return!0}toJSON(t){return this.write({},t)}};d([p({readOnly:!0})],pf.prototype,"cache",null),d([p({readOnly:!0})],pf.prototype,"extent",null),d([p({type:[[[Number]]],json:{write:{isRequired:!0}}})],pf.prototype,"paths",void 0),d([ge("paths")],pf.prototype,"writePaths",null),pf=eN=d([A("esri.geometry.Polyline")],pf),pf.prototype.toJSON.isDefaultToJSON=!0;const no=pf,zB=ln()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon"}),wq=ln()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh"});function _oe(t){return t.xmin!==void 0&&t.ymin!==void 0&&t.xmax!==void 0&&t.ymax!==void 0}function boe(t){return t.points!==void 0}function woe(t){return t.x!==void 0&&t.y!==void 0}function xoe(t){return t.paths!==void 0}function Ew(t){return t.rings!==void 0}function Vd(t){return t==null?null:t instanceof Ep?t:woe(t)?fe.fromJSON(t):xoe(t)?no.fromJSON(t):Ew(t)?Zn.fromJSON(t):boe(t)?Zm.fromJSON(t):_oe(t)?Re.fromJSON(t):null}function V1(t){return t?woe(t)?"esriGeometryPoint":xoe(t)?"esriGeometryPolyline":Ew(t)?"esriGeometryPolygon":_oe(t)?"esriGeometryEnvelope":boe(t)?"esriGeometryMultipoint":null:null}const GCe={esriGeometryPoint:fe,esriGeometryPolyline:no,esriGeometryPolygon:Zn,esriGeometryEnvelope:Re,esriGeometryMultipoint:Zm};function HCe(t){return t&&GCe[t]||null}const _g={base:Ep,key:"type",typeMap:{extent:Re,multipoint:Zm,point:fe,polyline:no,polygon:Zn}};Dd(_g);let Soe=0;const bg=t=>{let e=class extends t{constructor(...i){super(...i),Object.defineProperty(this,"uid",{writable:!1,configurable:!1,value:Date.now().toString(16)+"-object-"+Soe++})}};return e=d([A("esri.core.Identifiable")],e),e},jB=t=>{let e=class extends t{constructor(...i){super(...i),Object.defineProperty(this,"uid",{writable:!1,configurable:!1,value:Soe++})}};return e=d([A("esri.core.NumericIdentifiable")],e),e};let xq=class extends bg(class{}){};xq=d([A("esri.core.Identifiable")],xq);async function qCe(t){const e="portalItem"in t?t:{portalItem:t},{fromItem:i}=await W(()=>import("./portalLayers-c35a0770.js"),["./portalLayers-c35a0770.js","./lazyLayerLoader-31902c6f.js","./layersLoader-58213128.js","./fetchService-7b5fa001.js","./jsonContext-0bf4b056.js"],import.meta.url);try{return await i(e)}catch(r){const n=e&&e.portalItem,s=n&&n.id||"unset",o=n&&n.portal&&n.portal.url||Lt.portalUrl;throw ie.getLogger("esri.layers.support.fromPortalItem").error("#fromPortalItem()","Failed to create layer from portal item (portal: '"+o+"', id: '"+s+"')",r),r}}let WCe=0,zn=class extends an.EventedMixin(bg(Su)){constructor(){super(...arguments),this.attributionDataUrl=null,this.fullExtent=new Re(-180,-90,180,90,Ee.WGS84),this.id=Date.now().toString(16)+"-layer-"+WCe++,this.legendEnabled=!0,this.listMode="show",this.opacity=1,this.parent=null,this.popupEnabled=!0,this.attributionVisible=!0,this.spatialReference=Ee.WGS84,this.title=null,this.type=null,this.url=null,this.visible=!0}static async fromArcGISServerUrl(e){const i=typeof e=="string"?{url:e}:e;return(await W(()=>import("./arcgisLayers-56d42fbf.js"),["./arcgisLayers-56d42fbf.js","./fetchService-7b5fa001.js","./lazyLayerLoader-31902c6f.js"],import.meta.url)).fromUrl(i)}static fromPortalItem(e){return qCe(e)}initialize(){this.when().catch(e=>{ys(e)||ie.getLogger(this).error("#load()",`Failed to load layer (title: '${this.title??"no title"}', id: '${this.id??"no id"}')`,{error:e})})}destroy(){if(this.parent){const e=this,i=this.parent;"layers"in i&&i.layers.includes(e)?i.layers.remove(e):"tables"in i&&i.tables.includes(e)?i.tables.remove(e):"baseLayers"in i&&i.baseLayers.includes(e)?i.baseLayers.remove(e):"baseLayers"in i&&i.referenceLayers.includes(e)&&i.referenceLayers.remove(e)}}get hasAttributionData(){return this.attributionDataUrl!=null}get parsedUrl(){return sn(this.url)}async fetchAttributionData(){const e=this.attributionDataUrl;if(this.hasAttributionData&&e)return(await at(e,{query:{f:"json"},responseType:"json"})).data;throw new N("layer:no-attribution-data","Layer does not have attribution data")}};d([p({type:String})],zn.prototype,"attributionDataUrl",void 0),d([p({type:Re})],zn.prototype,"fullExtent",void 0),d([p({readOnly:!0})],zn.prototype,"hasAttributionData",null),d([p({type:String,clonable:!1})],zn.prototype,"id",void 0),d([p({type:Boolean,nonNullable:!0})],zn.prototype,"legendEnabled",void 0),d([p({type:["show","hide","hide-children"]})],zn.prototype,"listMode",void 0),d([p({type:Number,range:{min:0,max:1},nonNullable:!0})],zn.prototype,"opacity",void 0),d([p({clonable:!1})],zn.prototype,"parent",void 0),d([p({readOnly:!0})],zn.prototype,"parsedUrl",null),d([p({type:Boolean})],zn.prototype,"popupEnabled",void 0),d([p({type:Boolean})],zn.prototype,"attributionVisible",void 0),d([p({type:Ee})],zn.prototype,"spatialReference",void 0),d([p({type:String})],zn.prototype,"title",void 0),d([p({readOnly:!0,json:{read:!1}})],zn.prototype,"type",void 0),d([p()],zn.prototype,"url",void 0),d([p({type:Boolean,nonNullable:!0})],zn.prototype,"visible",void 0),zn=d([A("esri.layers.Layer")],zn);const lC=zn;function tN(t,e,i){let r,n;if(t)for(let s=0,o=t.length;s<o;s++){if(r=t.at(s),(r==null?void 0:r[e])===i)return r;if((r==null?void 0:r.type)==="group"&&(n=tN(r.layers,e,i),n))return n}}const JCe=t=>{let e=class extends t{constructor(...i){super(...i),this.layers=new ye;const r=o=>{o.parent&&"remove"in o.parent&&o.parent.remove(o)},n=o=>{o.parent=this,this.layerAdded(o),o.type!=="elevation"&&o.type!=="base-elevation"||ie.getLogger(this).error(`Layer 'title:${o.title}, id:${o.id}' of type '${o.type}' is not supported as an operational layer and will therefore be ignored.`)},s=o=>{o.parent=null,this.layerRemoved(o)};this.addHandles([this.layers.on("before-add",o=>r(o.item)),this.layers.on("after-add",o=>n(o.item)),this.layers.on("after-remove",o=>s(o.item))])}destroy(){const i=this.layers.toArray();for(const r of i)r.destroy();this.layers.destroy()}set layers(i){this._set("layers",rg(i,this._get("layers")))}add(i,r){const n=this.layers;if(r=n.getNextIndex(r),i instanceof lC){const s=i;s.parent===this?this.reorder(s,r):n.add(s,r)}else Tp(i)?i.then(s=>{this.destroyed||this.add(s,r)}):ie.getLogger(this).error("#add()","The item being added is not a Layer or a Promise that resolves to a Layer.")}addMany(i,r){const n=this.layers;let s=n.getNextIndex(r);i.slice().forEach(o=>{o.parent!==this?(n.add(o,s),s+=1):this.reorder(o,s)})}findLayerById(i){return tN(this.layers,"id",i)}findLayerByUid(i){return tN(this.layers,"uid",i)}remove(i){return this.layers.remove(i)}removeMany(i){return this.layers.removeMany(i)}removeAll(){return this.layers.removeAll()}reorder(i,r){return this.layers.reorder(i,r)}layerAdded(i){}layerRemoved(i){}};return d([p()],e.prototype,"layers",null),e=d([A("esri.support.LayersMixin")],e),e};function iN(t,e,i){if(t)for(let r=0,n=t.length;r<n;r++){const s=t.at(r);if(s[e]===i)return s;if((s==null?void 0:s.type)==="group"){const o=iN(s.tables,e,i);if(o)return o}}}const ZCe=t=>{let e=class extends t{constructor(...i){super(...i),this.tables=new ye,this.addHandles([this.tables.on("after-add",r=>{const n=r.item;n.parent&&n.parent!==this&&"tables"in n.parent&&n.parent.tables.remove(n),n.parent=this,n.type!=="feature"&&ie.getLogger(this).error(`Layer 'title:${n.title}, id:${n.id}' of type '${n.type}' is not supported as a table and will therefore be ignored.`)}),this.tables.on("after-remove",r=>{r.item.parent=null})])}destroy(){const i=this.tables.removeAll();for(const r of i)r.destroy();this.tables.destroy()}set tables(i){this._set("tables",rg(i,this._get("tables")))}findTableById(i){return iN(this.tables,"id",i)}findTableByUid(i){return iN(this.tables,"uid",i)}};return d([p()],e.prototype,"tables",null),e=d([A("esri.support.TablesMixin")],e),e};let Hu=class extends ZCe(JCe(an.EventedMixin(he))){constructor(e){super(e),this.allLayers=new ZI({getCollections:()=>{var i,r,n;return[(i=this.basemap)==null?void 0:i.baseLayers,(r=this.ground)==null?void 0:r.layers,this.layers,(n=this.basemap)==null?void 0:n.referenceLayers]},getChildrenFunction:i=>"layers"in i?i.layers:null}),this.allTables=pCe(this),this.basemap=null,this.editableLayers=new ZI({getCollections:()=>[this.allLayers],itemFilterFunction:aC}),this.ground=new JI,this._basemapCache=sCe()}destroy(){var e,i;this.allLayers.destroy(),this.allTables.destroy(),this.editableLayers.destroy(),(e=this.ground)==null||e.destroy(),(i=this.basemap)==null||i.destroy(),Yse(this._basemapCache),this._basemapCache=null}castBasemap(e){return k$(e,this._basemapCache)}castGround(e){return fCe(e)??this._get("ground")}findLayerById(e){return this.allLayers.find(i=>i.id===e)}findTableById(e){return this.allTables.find(i=>i.id===e)}};d([p({readOnly:!0,dependsOn:[]})],Hu.prototype,"allLayers",void 0),d([p({readOnly:!0})],Hu.prototype,"allTables",void 0),d([p({type:Gk})],Hu.prototype,"basemap",void 0),d([tt("basemap")],Hu.prototype,"castBasemap",null),d([p({readOnly:!0})],Hu.prototype,"editableLayers",void 0),d([p({type:JI,nonNullable:!0})],Hu.prototype,"ground",void 0),d([tt("ground")],Hu.prototype,"castGround",null),Hu=d([A("esri.Map")],Hu);const Ioe=Hu,Li=t=>{let e=class extends t{clone(){var l;const i=us(Vo(this),"unable to clone instance of non-accessor class"),r=i.metadatas,n=i.store,s={},o=new Map;for(const c in r){const u=r[c],h=n==null?void 0:n.originOf(c),f=u.clonable;if(u.readOnly||f===!1||h!==Ye.USER&&h!==Ye.DEFAULTS&&h!==Ye.WEB_MAP&&h!==Ye.WEB_SCENE)continue;const m=this[c];let g=null;g=typeof f=="function"?f(m):f==="reference"?m:vD(m),m!=null&&g==null||(h===Ye.DEFAULTS?o.set(c,g):s[c]=g)}const a=new(Object.getPrototypeOf(this)).constructor(s);if(o.size){const c=(l=Vo(a))==null?void 0:l.store;if(c)for(const[u,h]of o)c.set(u,h,Ye.DEFAULTS)}return a}};return e=d([A("esri.core.Clonable")],e),e};let Sq=class extends Li(he){};Sq=d([A("esri.core.Clonable")],Sq);var sg;function Toe(t,e){switch(t.type){case"range":{const i="range"in t?t.range[0]:t.minValue,r="range"in t?t.range[1]:t.maxValue;if(i!=null&&+e<i||r!=null&&+e>r)return sg.VALUE_OUT_OF_RANGE;break}case"coded-value":case"codedValue":if(t.codedValues==null||t.codedValues.every(i=>i==null||i.code!==e))return sg.INVALID_CODED_VALUE}return null}function BB(t){if(!(!t||t.type!=="range"))return{min:"range"in t?t.range[0]:t.minValue,max:"range"in t?t.range[1]:t.maxValue}}(function(t){t.VALUE_OUT_OF_RANGE="domain-validation-error::value-out-of-range",t.INVALID_CODED_VALUE="domain-validation-error::invalid-coded-value"})(sg||(sg={}));const YCe=ie.getLogger("esri.support.arcadeOnDemand");let _3;function zd(){return _3||(_3=(async()=>{const t=await W(()=>import("./arcadeUtils-33632ce7.js").then(e=>e.au),["./arcadeUtils-33632ce7.js","./number-335d744d.js","./featureConversionUtils-bafaa402.js","./OptimizedFeature-4701473b.js","./OptimizedFeatureSet-1d1ac4b9.js","./OptimizedGeometry-196224d4.js","./arcadeTimeUtils-3a12e3ee.js"],import.meta.url);return{arcade:t.arcade,arcadeUtils:t,Dictionary:t.Dictionary,Feature:t.arcadeFeature}})()),_3}const Lyt=(t,e,i)=>UB.create(t,e,i,null,["$feature"],[]),Ryt=(t,e,i)=>UB.create(t,e,i,null,["$feature","$view"],[]),KCe=(t,e,i,r)=>UB.create(t,e,i,r,["$feature","$view"],[]);let UB=class Coe{constructor(e,i,r,n,s,o,a){this.services=null,this.script=e,this.evaluate=n;const l=Array.isArray(o)?o:o.fields;this.fields=l,this._syntaxTree=r,this._arcade=i,this._arcadeFeature=s,this._spatialReference=a,this._referencesGeometry=i.scriptTouchesGeometry(this._syntaxTree),this._referencesScale=this._arcade.referencesMember(this._syntaxTree,"scale")}static async create(e,i,r,n,s,o){const{arcade:a,Feature:l,Dictionary:c}=await zd(),u=Ee.fromJSON(i);let h;try{h=a.parseScript(e,o)}catch(E){return YCe.error(new N("arcade-bad-expression","Failed to parse arcade script",{script:e,error:E})),null}const f=s.reduce((E,$)=>({...E,[$]:null}),{});let m=null;n!=null&&(m=new c(n),m.immutable=!0,f.$config=null);const g=a.scriptUsesGeometryEngine(h),y=g&&a.enableGeometrySupport(),v=a.scriptUsesFeatureSet(h)&&a.enableFeatureSetSupport(),b=a.scriptIsAsync(h),w=b&&a.enableAsyncSupport(),x={vars:f,spatialReference:u,useAsync:!!w};await Promise.all([y,v,w]);const S=new Set;await a.loadDependentModules(S,h,null,b,g);const I=new c;I.immutable=!1,I.setField("scale",0);const T=a.compileScript(h,x),C=(E,$)=>("$view"in E&&E.$view&&(I.setField("scale",typeof E.$view=="object"&&"scale"in E.$view?E.$view.scale:void 0),E.$view=I),m&&(E.$config=m),T({vars:E,spatialReference:u,services:$}));return new Coe(e,a,h,C,new l,r,u)}repurposeFeature(e){return e.geometry&&!e.geometry.spatialReference&&(e.geometry.spatialReference=this._spatialReference),this._arcadeFeature.repurposeFromGraphicLikeObject(e.geometry,e.attributes,{fields:this.fields}),this._arcadeFeature}referencesGeometry(){return this._referencesGeometry}referencesScale(){return this._referencesScale}};const XCe=/^([0-9_])/,QCe=/[^a-z0-9_\u0080-\uffff]+/gi;function eEe(t){return t==null?null:t.trim().replaceAll(QCe,"_").replace(XCe,"F$1")||null}const tEe=["field","field2","field3","normalizationField","rotationInfo.field","proportionalSymbolInfo.field","proportionalSymbolInfo.normalizationField","colorInfo.field","colorInfo.normalizationField"],iEe=["field","normalizationField"];function Jk(t,e){if(t!=null&&e!=null){for(const i of Array.isArray(t)?t:[t])if(Iq(tEe,i,e),"visualVariables"in i&&i.visualVariables)for(const r of i.visualVariables)Iq(iEe,r,e)}}function Iq(t,e,i){if(t)for(const r of t){const n=ZT(r,e),s=n&&typeof n!="function"&&i.get(n);s&&ho(r,s.name,e)}}function GB(t,e){var i;if(t!=null&&((i=e==null?void 0:e.fields)!=null&&i.length))if("startField"in t){const r=e.get(t.startField),n=e.get(t.endField);t.startField=(r==null?void 0:r.name)??null,t.endField=(n==null?void 0:n.name)??null}else{const r=e.get(t.startTimeField),n=e.get(t.endTimeField);t.startTimeField=(r==null?void 0:r.name)??null,t.endTimeField=(n==null?void 0:n.name)??null}}const b3=new Set;function iL(t,e){return t&&e?(b3.clear(),YI(b3,t,e),Array.from(b3).sort()):[]}function YI(t,e,i){var r;if(i)if((r=e==null?void 0:e.fields)!=null&&r.length)if(i.includes("*"))for(const{name:n}of e.fields)t.add(n);else for(const n of i)rl(t,e,n);else{if(i.includes("*"))return t.clear(),void t.add("*");for(const n of i)n!=null&&t.add(n)}}function rl(t,e,i){if(typeof i=="string")if(e){const r=e.get(i);r&&t.add(r.name)}else t.add(i)}function Fyt(t,e){return e==null||t==null?[]:e.includes("*")?(t.fields??[]).map(i=>i.name):e}async function jo(t,e,i){var s;if(!i)return;const{arcadeUtils:r}=await zd(),n=r.extractFieldNames(i,(s=e==null?void 0:e.fields)==null?void 0:s.map(o=>o.name));for(const o of n)rl(t,e,o)}async function Eoe(t,e,i){if(i&&i!=="1=1"){const{WhereClause:r}=await W(()=>import("./WhereClause-0a50ffa9.js").then(s=>s.W),[],import.meta.url),n=r.create(i,e);if(!n.isStandardized)throw new N("fieldUtils:collectFilterFields","Where clause is not standardized",{where:i});YI(t,e,n.fieldNames)}}function HB({displayField:t,fields:e}){return t||(e&&e.length?w3(e,"name-or-title")||w3(e,"unique-identifier")||w3(e,"type-or-category")||rEe(e):null)}function rEe(t){for(const e of t){if(!e||!e.name)continue;const i=e.name.toLowerCase();if(i.includes("name")||i.includes("title"))return e.name}return null}function w3(t,e){for(const i of t)if(i&&i.valueType&&i.valueType===e)return i.name;return null}async function Dyt(t,e){var r;if(!e)return;const i=(r=e.elevationInfo)==null?void 0:r.featureExpressionInfo;return i?i.collectRequiredFields(t,e.fieldsIndex):void 0}function nEe(t,e,i){i.onStatisticExpression?jo(t,e,i.onStatisticExpression.expression):t.add(i.onStatisticField)}async function Nyt(t,e,i){if(!e||!i||!("fields"in i))return;const r=[],n=i.popupTemplate;r.push(sEe(t,e,n)),i.fields&&r.push(...i.fields.map(async s=>nEe(t,e.fieldsIndex,s))),await Promise.all(r)}async function sEe(t,e,i){const r=[];i!=null&&i.expressionInfos&&r.push(...i.expressionInfos.map(s=>jo(t,e.fieldsIndex,s.expression)));const n=i==null?void 0:i.content;if(Array.isArray(n))for(const s of n)s.type==="expression"&&s.expressionInfo&&r.push(jo(t,e.fieldsIndex,s.expressionInfo.expression));await Promise.all(r)}async function Vyt(t,e,i){e&&(e.timeInfo&&i!=null&&i.timeExtent&&YI(t,e.fieldsIndex,[e.timeInfo.startField,e.timeInfo.endField]),e.floorInfo&&YI(t,e.fieldsIndex,[e.floorInfo.floorField]),i!=null&&i.where!=null&&await Eoe(t,e.fieldsIndex,i.where))}async function zyt(t,e,i){e&&i&&await Promise.all(i.map(r=>oEe(t,e,r)))}async function oEe(t,e,i){e&&i&&(i.valueExpression?await jo(t,e.fieldsIndex,i.valueExpression):i.field&&rl(t,e.fieldsIndex,i.field))}function jyt(t){return t?iL(t.fieldsIndex,$oe(t)):[]}function aEe(t){if(!t)return[];const e=t.geometryFieldsInfo;return e?iL(t.fieldsIndex,[e.shapeAreaField,e.shapeLengthField]):[]}const lEe=["oid","global-id","guid"],cEe=["oid","global-id"],uEe=[/^fnode_$/i,/^tnode_$/i,/^lpoly_$/i,/^rpoly_$/i,/^poly_$/i,/^subclass$/i,/^subclass_$/i,/^rings_ok$/i,/^rings_nok$/i,/shape/i,/perimeter/i,/objectid/i,/_i$/i];function Moe(t){const e=new Set;qB(t).forEach(r=>e.add(r)),aEe(t).forEach(r=>e.add(r.toLowerCase()));const i=t&&"infoFor3D"in t?t.infoFor3D:void 0;return i&&(Object.values(i.assetMapFieldRoles).forEach(r=>e.add(r.toLowerCase())),Object.values(i.transformFieldRoles).forEach(r=>e.add(r.toLowerCase()))),Array.from(e)}function $oe(t){if(!t)return[];const e="editFieldsInfo"in t&&t.editFieldsInfo;if(!e)return[];const{creationDateField:i,creatorField:r,editDateField:n,editorField:s}=e;return[i,r,n,s].filter(Boolean)}function qB(t){return $oe(t).map(e=>e.toLowerCase())}function dEe(t,e){var i;return t.editable&&!lEe.includes(t.type)&&!qB(e).includes(((i=t.name)==null?void 0:i.toLowerCase())??"")}function Aoe(t,e){var r;const i=((r=t.name)==null?void 0:r.toLowerCase())??"";return!((e==null?void 0:e.objectIdField)!=null&&i===e.objectIdField.toLowerCase()||(e==null?void 0:e.globalIdField)!=null&&i===e.globalIdField.toLowerCase()||Moe(e).includes(i)||cEe.includes(t.type)||uEe.some(n=>n.test(i)))}async function Byt(t,e){const{labelingInfo:i,fieldsIndex:r}=e;i&&i.length&&await Promise.all(i.map(n=>hEe(t,r,n)))}async function hEe(t,e,i){if(!i)return;const r=i.getLabelExpression(),n=i.where;if(r.type==="arcade")await jo(t,e,r.expression);else{const s=r.expression.match(/{[^}]*}/g);s&&s.forEach(o=>{rl(t,e,o.slice(1,-1))})}await Eoe(t,e,n)}function pEe(t){const e=t.defaultValue;return e!==void 0&&Ooe(t,e)?e:t.nullable?null:void 0}function koe(t){return typeof t=="number"&&!isNaN(t)&&isFinite(t)}function fEe(t){return t===null||koe(t)}const WB="isInteger"in Number?Number.isInteger:t=>typeof t=="number"&&isFinite(t)&&Math.floor(t)===t;function mEe(t){return t===null||WB(t)}function Poe(t){return t!=null&&typeof t=="string"}function gEe(t){return t===null||Poe(t)}function yEe(){return!0}function Ooe(t,e){let i;switch(t.type){case"date":case"integer":case"long":case"small-integer":case"esriFieldTypeDate":case"esriFieldTypeInteger":case"esriFieldTypeLong":case"esriFieldTypeSmallInteger":i=t.nullable?mEe:WB;break;case"double":case"single":case"esriFieldTypeSingle":case"esriFieldTypeDouble":i=t.nullable?fEe:koe;break;case"string":case"esriFieldTypeString":i=t.nullable?gEe:Poe;break;default:i=yEe}return arguments.length===1?i:i(e)}const vEe=["integer","small-integer","single","double"],_Ee=new Set([...vEe,"esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeSingle","esriFieldTypeDouble"]),bEe=["date","date-only","time-only","timestamp-offset"],wEe=new Set([...bEe,"esriFieldTypeDate","esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset"]);function Cd(t){return t!=null&&_Ee.has(t.type)}function rN(t){return t!=null&&(t.type==="string"||t.type==="esriFieldTypeString")}function Zk(t){return t!=null&&wEe.has(t.type)}var KI,n1;function Uyt(t){return t==null||typeof t=="number"&&isNaN(t)?null:t}function xEe(t,e){return t==null||t.nullable&&e===null?null:Cd(t)&&!SEe(t.type,Number(e))?KI.OUT_OF_RANGE:Ooe(t,e)?t.domain?Toe(t.domain,e):null:n1.INVALID_TYPE}function SEe(t,e){const i=typeof t=="string"?JB(t):t;if(!i)return!1;const r=i.min,n=i.max;return i.isInteger?WB(e)&&e>=r&&e<=n:e>=r&&e<=n}function Loe(t){return BB(t.domain)||(Cd(t)?JB(t.type):void 0)}function JB(t){switch(t){case"esriFieldTypeSmallInteger":case"small-integer":return IEe;case"esriFieldTypeInteger":case"integer":return TEe;case"esriFieldTypeBigInteger":case"big-integer":return CEe;case"esriFieldTypeSingle":case"single":return EEe;case"esriFieldTypeDouble":case"double":return MEe}}(function(t){t.OUT_OF_RANGE="numeric-range-validation-error::out-of-range"})(KI||(KI={})),function(t){t.INVALID_TYPE="type-validation-error::invalid-type"}(n1||(n1={}));const IEe={min:-32768,max:32767,isInteger:!0},TEe={min:-2147483648,max:2147483647,isInteger:!0},CEe={min:-Number.MAX_SAFE_INTEGER,max:Number.MAX_SAFE_INTEGER,isInteger:!0},EEe={min:-34e37,max:12e37,isInteger:!1},MEe={min:-Number.MAX_VALUE,max:Number.MAX_VALUE,isInteger:!1};function Gyt(t,e,i){switch(t){case sg.INVALID_CODED_VALUE:return`Value ${i} is not in the coded domain - field: ${e.name}, domain: ${JSON.stringify(e.domain)}`;case sg.VALUE_OUT_OF_RANGE:return`Value ${i} is out of the range of valid values - field: ${e.name}, domain: ${JSON.stringify(e.domain)}`;case n1.INVALID_TYPE:return`Value ${i} is not a valid value for the field type - field: ${e.name}, type: ${e.type}, nullable: ${e.nullable}`;case KI.OUT_OF_RANGE:{const{min:r,max:n}=JB(e.type);return`Value ${i} is out of range for the number type - field: ${e.name}, type: ${e.type}, value range is ${r} to ${n}`}}}function $Ee(t,e){return!AEe(t,e,null)}function AEe(t,e,i){if(!e||!e.attributes||!t){if(i!=null)for(const s of t??[])i.add(s);return!0}const r=e.attributes;let n=!1;for(const s of t)if(!(s in r)){if(n=!0,i==null)break;i.add(s)}return n}function nN(t){return!!t&&["raster.itempixelvalue","raster.servicepixelvalue"].some(e=>t.toLowerCase().startsWith(e))}let O$=class extends te{constructor(e){super(e),this.type=null}};d([p({type:["attachments","custom","fields","media","text","expression","relationship"],readOnly:!0,json:{read:!1,write:!0}})],O$.prototype,"type",void 0),O$=d([A("esri.popup.content.Content")],O$);const wg=O$;var sN;let cy=sN=class extends wg{constructor(t){super(t),this.description=null,this.displayType="auto",this.title=null,this.type="attachments"}clone(){return new sN({description:this.description,displayType:this.displayType,title:this.title})}};d([p({type:String,json:{write:!0}})],cy.prototype,"description",void 0),d([p({type:["auto","preview","list"],json:{write:!0}})],cy.prototype,"displayType",void 0),d([p({type:String,json:{write:!0}})],cy.prototype,"title",void 0),d([p({type:["attachments"],readOnly:!0,json:{read:!1,write:!0}})],cy.prototype,"type",void 0),cy=sN=d([A("esri.popup.content.AttachmentsContent")],cy);const XI=cy;var oN;let uy=oN=class extends wg{constructor(t){super(t),this.creator=null,this.destroyer=null,this.outFields=null,this.type="custom"}clone(){return new oN({creator:this.creator,destroyer:this.destroyer,outFields:Array.isArray(this.outFields)?U(this.outFields):null})}};d([p()],uy.prototype,"creator",void 0),d([p()],uy.prototype,"destroyer",void 0),d([p()],uy.prototype,"outFields",void 0),d([p({type:["custom"],readOnly:!0})],uy.prototype,"type",void 0),uy=oN=d([A("esri.popup.content.CustomContent")],uy);const kEe=uy;var aN;let J_=aN=class extends te{constructor(t){super(t),this.title=null,this.expression=null,this.returnType="dictionary"}clone(){return new aN({title:this.title,expression:this.expression})}};d([p({type:String,json:{write:!0}})],J_.prototype,"title",void 0),d([p({type:String,json:{write:!0}})],J_.prototype,"expression",void 0),d([p({type:["dictionary"],readOnly:!0,json:{read:!1,write:!0}})],J_.prototype,"returnType",void 0),J_=aN=d([A("esri.popup.ElementExpressionInfo")],J_);const PEe=J_;var lN;let vS=lN=class extends wg{constructor(t){super(t),this.expressionInfo=null,this.type="expression"}clone(){var t;return new lN({expressionInfo:(t=this.expressionInfo)==null?void 0:t.clone()})}};d([p({type:PEe,json:{write:!0}})],vS.prototype,"expressionInfo",void 0),d([p({type:["expression"],readOnly:!0,json:{read:!1,write:!0}})],vS.prototype,"type",void 0),vS=lN=d([A("esri.popup.content.ExpressionContent")],vS);const ZB=vS;class Uv extends Error{}class OEe extends Uv{constructor(e){super(`Invalid DateTime: ${e.toMessage()}`)}}class LEe extends Uv{constructor(e){super(`Invalid Interval: ${e.toMessage()}`)}}class REe extends Uv{constructor(e){super(`Invalid Duration: ${e.toMessage()}`)}}class _S extends Uv{}class Roe extends Uv{constructor(e){super(`Invalid unit ${e}`)}}class Wl extends Uv{}class Wp extends Uv{constructor(){super("Zone is an abstract class")}}const Ie="numeric",Tu="short",nl="long",Yk={year:Ie,month:Ie,day:Ie},Foe={year:Ie,month:Tu,day:Ie},FEe={year:Ie,month:Tu,day:Ie,weekday:Tu},Doe={year:Ie,month:nl,day:Ie},Noe={year:Ie,month:nl,day:Ie,weekday:nl},Voe={hour:Ie,minute:Ie},zoe={hour:Ie,minute:Ie,second:Ie},joe={hour:Ie,minute:Ie,second:Ie,timeZoneName:Tu},Boe={hour:Ie,minute:Ie,second:Ie,timeZoneName:nl},Uoe={hour:Ie,minute:Ie,hourCycle:"h23"},Goe={hour:Ie,minute:Ie,second:Ie,hourCycle:"h23"},Hoe={hour:Ie,minute:Ie,second:Ie,hourCycle:"h23",timeZoneName:Tu},qoe={hour:Ie,minute:Ie,second:Ie,hourCycle:"h23",timeZoneName:nl},Woe={year:Ie,month:Ie,day:Ie,hour:Ie,minute:Ie},Joe={year:Ie,month:Ie,day:Ie,hour:Ie,minute:Ie,second:Ie},Zoe={year:Ie,month:Tu,day:Ie,hour:Ie,minute:Ie},Yoe={year:Ie,month:Tu,day:Ie,hour:Ie,minute:Ie,second:Ie},DEe={year:Ie,month:Tu,day:Ie,weekday:Tu,hour:Ie,minute:Ie},Koe={year:Ie,month:nl,day:Ie,hour:Ie,minute:Ie,timeZoneName:Tu},Xoe={year:Ie,month:nl,day:Ie,hour:Ie,minute:Ie,second:Ie,timeZoneName:Tu},Qoe={year:Ie,month:nl,day:Ie,weekday:nl,hour:Ie,minute:Ie,timeZoneName:nl},eae={year:Ie,month:nl,day:Ie,weekday:nl,hour:Ie,minute:Ie,second:Ie,timeZoneName:nl};class z1{get type(){throw new Wp}get name(){throw new Wp}get ianaName(){return this.name}get isUniversal(){throw new Wp}offsetName(e,i){throw new Wp}formatOffset(e,i){throw new Wp}offset(e){throw new Wp}equals(e){throw new Wp}get isValid(){throw new Wp}}let x3=null;class rL extends z1{static get instance(){return x3===null&&(x3=new rL),x3}get type(){return"system"}get name(){return new Intl.DateTimeFormat().resolvedOptions().timeZone}get isUniversal(){return!1}offsetName(e,{format:i,locale:r}){return iae(e,i,r)}formatOffset(e,i){return Y2(this.offset(e),i)}offset(e){return-new Date(e).getTimezoneOffset()}equals(e){return e.type==="system"}get isValid(){return!0}}let L$={};function NEe(t){return L$[t]||(L$[t]=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:t,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",era:"short"})),L$[t]}const VEe={year:0,month:1,day:2,era:3,hour:4,minute:5,second:6};function zEe(t,e){const i=t.format(e).replace(/\u200E/g,""),r=/(\d+)\/(\d+)\/(\d+) (AD|BC),? (\d+):(\d+):(\d+)/.exec(i),[,n,s,o,a,l,c,u]=r;return[o,n,s,a,l,c,u]}function jEe(t,e){const i=t.formatToParts(e),r=[];for(let n=0;n<i.length;n++){const{type:s,value:o}=i[n],a=VEe[s];s==="era"?r[a]=o:Wt(a)||(r[a]=parseInt(o,10))}return r}let wE={};class Cu extends z1{static create(e){return wE[e]||(wE[e]=new Cu(e)),wE[e]}static resetCache(){wE={},L$={}}static isValidSpecifier(e){return this.isValidZone(e)}static isValidZone(e){if(!e)return!1;try{return new Intl.DateTimeFormat("en-US",{timeZone:e}).format(),!0}catch{return!1}}constructor(e){super(),this.zoneName=e,this.valid=Cu.isValidZone(e)}get type(){return"iana"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(e,{format:i,locale:r}){return iae(e,i,r,this.name)}formatOffset(e,i){return Y2(this.offset(e),i)}offset(e){const i=new Date(e);if(isNaN(i))return NaN;const r=NEe(this.name);let[n,s,o,a,l,c,u]=r.formatToParts?jEe(r,i):zEe(r,i);a==="BC"&&(n=-Math.abs(n)+1);const f=XB({year:n,month:s,day:o,hour:l===24?0:l,minute:c,second:u,millisecond:0});let m=+i;const g=m%1e3;return m-=g>=0?g:1e3+g,(f-m)/(60*1e3)}equals(e){return e.type==="iana"&&e.name===this.name}get isValid(){return this.valid}}let Tq={};function BEe(t,e={}){const i=JSON.stringify([t,e]);let r=Tq[i];return r||(r=new Intl.ListFormat(t,e),Tq[i]=r),r}let cN={};function uN(t,e={}){const i=JSON.stringify([t,e]);let r=cN[i];return r||(r=new Intl.DateTimeFormat(t,e),cN[i]=r),r}let dN={};function UEe(t,e={}){const i=JSON.stringify([t,e]);let r=dN[i];return r||(r=new Intl.NumberFormat(t,e),dN[i]=r),r}let hN={};function GEe(t,e={}){const{base:i,...r}=e,n=JSON.stringify([t,r]);let s=hN[n];return s||(s=new Intl.RelativeTimeFormat(t,e),hN[n]=s),s}let bS=null;function HEe(){return bS||(bS=new Intl.DateTimeFormat().resolvedOptions().locale,bS)}function qEe(t){const e=t.indexOf("-x-");e!==-1&&(t=t.substring(0,e));const i=t.indexOf("-u-");if(i===-1)return[t];{let r,n;try{r=uN(t).resolvedOptions(),n=t}catch{const l=t.substring(0,i);r=uN(l).resolvedOptions(),n=l}const{numberingSystem:s,calendar:o}=r;return[n,s,o]}}function WEe(t,e,i){return(i||e)&&(t.includes("-u-")||(t+="-u"),i&&(t+=`-ca-${i}`),e&&(t+=`-nu-${e}`)),t}function JEe(t){const e=[];for(let i=1;i<=12;i++){const r=Ae.utc(2016,i,1);e.push(t(r))}return e}function ZEe(t){const e=[];for(let i=1;i<=7;i++){const r=Ae.utc(2016,11,13+i);e.push(t(r))}return e}function xE(t,e,i,r,n){const s=t.listingMode(i);return s==="error"?null:s==="en"?r(e):n(e)}function YEe(t){return t.numberingSystem&&t.numberingSystem!=="latn"?!1:t.numberingSystem==="latn"||!t.locale||t.locale.startsWith("en")||new Intl.DateTimeFormat(t.intl).resolvedOptions().numberingSystem==="latn"}class KEe{constructor(e,i,r){this.padTo=r.padTo||0,this.floor=r.floor||!1;const{padTo:n,floor:s,...o}=r;if(!i||Object.keys(o).length>0){const a={useGrouping:!1,...r};r.padTo>0&&(a.minimumIntegerDigits=r.padTo),this.inf=UEe(e,a)}}format(e){if(this.inf){const i=this.floor?Math.floor(e):e;return this.inf.format(i)}else{const i=this.floor?Math.floor(e):KB(e,3);return In(i,this.padTo)}}}class XEe{constructor(e,i,r){this.opts=r,this.originalZone=void 0;let n;if(this.opts.timeZone)this.dt=e;else if(e.zone.type==="fixed"){const o=-1*(e.offset/60),a=o>=0?`Etc/GMT+${o}`:`Etc/GMT${o}`;e.offset!==0&&Cu.create(a).valid?(n=a,this.dt=e):(n="UTC",this.dt=e.offset===0?e:e.setZone("UTC").plus({minutes:e.offset}),this.originalZone=e.zone)}else e.zone.type==="system"?this.dt=e:e.zone.type==="iana"?(this.dt=e,n=e.zone.name):(n="UTC",this.dt=e.setZone("UTC").plus({minutes:e.offset}),this.originalZone=e.zone);const s={...this.opts};s.timeZone=s.timeZone||n,this.dtf=uN(i,s)}format(){return this.originalZone?this.formatToParts().map(({value:e})=>e).join(""):this.dtf.format(this.dt.toJSDate())}formatToParts(){const e=this.dtf.formatToParts(this.dt.toJSDate());return this.originalZone?e.map(i=>{if(i.type==="timeZoneName"){const r=this.originalZone.offsetName(this.dt.ts,{locale:this.dt.locale,format:this.opts.timeZoneName});return{...i,value:r}}else return i}):e}resolvedOptions(){return this.dtf.resolvedOptions()}}class QEe{constructor(e,i,r){this.opts={style:"long",...r},!i&&tae()&&(this.rtf=GEe(e,r))}format(e,i){return this.rtf?this.rtf.format(e,i):gMe(i,e,this.opts.numeric,this.opts.style!=="long")}formatToParts(e,i){return this.rtf?this.rtf.formatToParts(e,i):[]}}class nr{static fromOpts(e){return nr.create(e.locale,e.numberingSystem,e.outputCalendar,e.defaultToEN)}static create(e,i,r,n=!1){const s=e||Sn.defaultLocale,o=s||(n?"en-US":HEe()),a=i||Sn.defaultNumberingSystem,l=r||Sn.defaultOutputCalendar;return new nr(o,a,l,s)}static resetCache(){bS=null,cN={},dN={},hN={}}static fromObject({locale:e,numberingSystem:i,outputCalendar:r}={}){return nr.create(e,i,r)}constructor(e,i,r,n){const[s,o,a]=qEe(e);this.locale=s,this.numberingSystem=i||o||null,this.outputCalendar=r||a||null,this.intl=WEe(this.locale,this.numberingSystem,this.outputCalendar),this.weekdaysCache={format:{},standalone:{}},this.monthsCache={format:{},standalone:{}},this.meridiemCache=null,this.eraCache={},this.specifiedLocale=n,this.fastNumbersCached=null}get fastNumbers(){return this.fastNumbersCached==null&&(this.fastNumbersCached=YEe(this)),this.fastNumbersCached}listingMode(){const e=this.isEnglish(),i=(this.numberingSystem===null||this.numberingSystem==="latn")&&(this.outputCalendar===null||this.outputCalendar==="gregory");return e&&i?"en":"intl"}clone(e){return!e||Object.getOwnPropertyNames(e).length===0?this:nr.create(e.locale||this.specifiedLocale,e.numberingSystem||this.numberingSystem,e.outputCalendar||this.outputCalendar,e.defaultToEN||!1)}redefaultToEN(e={}){return this.clone({...e,defaultToEN:!0})}redefaultToSystem(e={}){return this.clone({...e,defaultToEN:!1})}months(e,i=!1,r=!0){return xE(this,e,r,sae,()=>{const n=i?{month:e,day:"numeric"}:{month:e},s=i?"format":"standalone";return this.monthsCache[s][e]||(this.monthsCache[s][e]=JEe(o=>this.extract(o,n,"month"))),this.monthsCache[s][e]})}weekdays(e,i=!1,r=!0){return xE(this,e,r,lae,()=>{const n=i?{weekday:e,year:"numeric",month:"long",day:"numeric"}:{weekday:e},s=i?"format":"standalone";return this.weekdaysCache[s][e]||(this.weekdaysCache[s][e]=ZEe(o=>this.extract(o,n,"weekday"))),this.weekdaysCache[s][e]})}meridiems(e=!0){return xE(this,void 0,e,()=>cae,()=>{if(!this.meridiemCache){const i={hour:"numeric",hourCycle:"h12"};this.meridiemCache=[Ae.utc(2016,11,13,9),Ae.utc(2016,11,13,19)].map(r=>this.extract(r,i,"dayperiod"))}return this.meridiemCache})}eras(e,i=!0){return xE(this,e,i,uae,()=>{const r={era:e};return this.eraCache[e]||(this.eraCache[e]=[Ae.utc(-40,1,1),Ae.utc(2017,1,1)].map(n=>this.extract(n,r,"era"))),this.eraCache[e]})}extract(e,i,r){const n=this.dtFormatter(e,i),s=n.formatToParts(),o=s.find(a=>a.type.toLowerCase()===r);return o?o.value:null}numberFormatter(e={}){return new KEe(this.intl,e.forceSimple||this.fastNumbers,e)}dtFormatter(e,i={}){return new XEe(e,this.intl,i)}relFormatter(e={}){return new QEe(this.intl,this.isEnglish(),e)}listFormatter(e={}){return BEe(this.intl,e)}isEnglish(){return this.locale==="en"||this.locale.toLowerCase()==="en-us"||new Intl.DateTimeFormat(this.intl).resolvedOptions().locale.startsWith("en-us")}equals(e){return this.locale===e.locale&&this.numberingSystem===e.numberingSystem&&this.outputCalendar===e.outputCalendar}}let S3=null;class Ps extends z1{static get utcInstance(){return S3===null&&(S3=new Ps(0)),S3}static instance(e){return e===0?Ps.utcInstance:new Ps(e)}static parseSpecifier(e){if(e){const i=e.match(/^utc(?:([+-]\d{1,2})(?::(\d{2}))?)?$/i);if(i)return new Ps(sL(i[1],i[2]))}return null}constructor(e){super(),this.fixed=e}get type(){return"fixed"}get name(){return this.fixed===0?"UTC":`UTC${Y2(this.fixed,"narrow")}`}get ianaName(){return this.fixed===0?"Etc/UTC":`Etc/GMT${Y2(-this.fixed,"narrow")}`}offsetName(){return this.name}formatOffset(e,i){return Y2(this.fixed,i)}get isUniversal(){return!0}offset(){return this.fixed}equals(e){return e.type==="fixed"&&e.fixed===this.fixed}get isValid(){return!0}}class eMe extends z1{constructor(e){super(),this.zoneName=e}get type(){return"invalid"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(){return null}formatOffset(){return""}offset(){return NaN}equals(){return!1}get isValid(){return!1}}function vm(t,e){if(Wt(t)||t===null)return e;if(t instanceof z1)return t;if(tMe(t)){const i=t.toLowerCase();return i==="default"?e:i==="local"||i==="system"?rL.instance:i==="utc"||i==="gmt"?Ps.utcInstance:Ps.parseSpecifier(i)||Cu.create(t)}else return tv(t)?Ps.instance(t):typeof t=="object"&&t.offset&&typeof t.offset=="number"?t:new eMe(t)}let Cq=()=>Date.now(),Eq="system",Mq=null,$q=null,Aq=null,kq=60,Pq;class Sn{static get now(){return Cq}static set now(e){Cq=e}static set defaultZone(e){Eq=e}static get defaultZone(){return vm(Eq,rL.instance)}static get defaultLocale(){return Mq}static set defaultLocale(e){Mq=e}static get defaultNumberingSystem(){return $q}static set defaultNumberingSystem(e){$q=e}static get defaultOutputCalendar(){return Aq}static set defaultOutputCalendar(e){Aq=e}static get twoDigitCutoffYear(){return kq}static set twoDigitCutoffYear(e){kq=e%100}static get throwOnInvalid(){return Pq}static set throwOnInvalid(e){Pq=e}static resetCaches(){nr.resetCache(),Cu.resetCache()}}function Wt(t){return typeof t>"u"}function tv(t){return typeof t=="number"}function nL(t){return typeof t=="number"&&t%1===0}function tMe(t){return typeof t=="string"}function iMe(t){return Object.prototype.toString.call(t)==="[object Date]"}function tae(){try{return typeof Intl<"u"&&!!Intl.RelativeTimeFormat}catch{return!1}}function rMe(t){return Array.isArray(t)?t:[t]}function Oq(t,e,i){if(t.length!==0)return t.reduce((r,n)=>{const s=[e(n),n];return r&&i(r[0],s[0])===r[0]?r:s},null)[1]}function nMe(t,e){return e.reduce((i,r)=>(i[r]=t[r],i),{})}function s1(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Jh(t,e,i){return nL(t)&&t>=e&&t<=i}function sMe(t,e){return t-e*Math.floor(t/e)}function In(t,e=2){const i=t<0;let r;return i?r="-"+(""+-t).padStart(e,"0"):r=(""+t).padStart(e,"0"),r}function cm(t){if(!(Wt(t)||t===null||t===""))return parseInt(t,10)}function Lg(t){if(!(Wt(t)||t===null||t===""))return parseFloat(t)}function YB(t){if(!(Wt(t)||t===null||t==="")){const e=parseFloat("0."+t)*1e3;return Math.floor(e)}}function KB(t,e,i=!1){const r=10**e;return(i?Math.trunc:Math.round)(t*r)/r}function cC(t){return t%4===0&&(t%100!==0||t%400===0)}function Z2(t){return cC(t)?366:365}function Kk(t,e){const i=sMe(e-1,12)+1,r=t+(e-i)/12;return i===2?cC(r)?29:28:[31,null,31,30,31,30,31,31,30,31,30,31][i-1]}function XB(t){let e=Date.UTC(t.year,t.month-1,t.day,t.hour,t.minute,t.second,t.millisecond);return t.year<100&&t.year>=0&&(e=new Date(e),e.setUTCFullYear(t.year,t.month-1,t.day)),+e}function Xk(t){const e=(t+Math.floor(t/4)-Math.floor(t/100)+Math.floor(t/400))%7,i=t-1,r=(i+Math.floor(i/4)-Math.floor(i/100)+Math.floor(i/400))%7;return e===4||r===3?53:52}function pN(t){return t>99?t:t>Sn.twoDigitCutoffYear?1900+t:2e3+t}function iae(t,e,i,r=null){const n=new Date(t),s={hourCycle:"h23",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};r&&(s.timeZone=r);const o={timeZoneName:e,...s},a=new Intl.DateTimeFormat(i,o).formatToParts(n).find(l=>l.type.toLowerCase()==="timezonename");return a?a.value:null}function sL(t,e){let i=parseInt(t,10);Number.isNaN(i)&&(i=0);const r=parseInt(e,10)||0,n=i<0||Object.is(i,-0)?-r:r;return i*60+n}function rae(t){const e=Number(t);if(typeof t=="boolean"||t===""||Number.isNaN(e))throw new Wl(`Invalid unit value ${t}`);return e}function Qk(t,e){const i={};for(const r in t)if(s1(t,r)){const n=t[r];if(n==null)continue;i[e(r)]=rae(n)}return i}function Y2(t,e){const i=Math.trunc(Math.abs(t/60)),r=Math.trunc(Math.abs(t%60)),n=t>=0?"+":"-";switch(e){case"short":return`${n}${In(i,2)}:${In(r,2)}`;case"narrow":return`${n}${i}${r>0?`:${r}`:""}`;case"techie":return`${n}${In(i,2)}${In(r,2)}`;default:throw new RangeError(`Value format ${e} is out of range for property format`)}}function oL(t){return nMe(t,["hour","minute","second","millisecond"])}const oMe=["January","February","March","April","May","June","July","August","September","October","November","December"],nae=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],aMe=["J","F","M","A","M","J","J","A","S","O","N","D"];function sae(t){switch(t){case"narrow":return[...aMe];case"short":return[...nae];case"long":return[...oMe];case"numeric":return["1","2","3","4","5","6","7","8","9","10","11","12"];case"2-digit":return["01","02","03","04","05","06","07","08","09","10","11","12"];default:return null}}const oae=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],aae=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],lMe=["M","T","W","T","F","S","S"];function lae(t){switch(t){case"narrow":return[...lMe];case"short":return[...aae];case"long":return[...oae];case"numeric":return["1","2","3","4","5","6","7"];default:return null}}const cae=["AM","PM"],cMe=["Before Christ","Anno Domini"],uMe=["BC","AD"],dMe=["B","A"];function uae(t){switch(t){case"narrow":return[...dMe];case"short":return[...uMe];case"long":return[...cMe];default:return null}}function hMe(t){return cae[t.hour<12?0:1]}function pMe(t,e){return lae(e)[t.weekday-1]}function fMe(t,e){return sae(e)[t.month-1]}function mMe(t,e){return uae(e)[t.year<0?0:1]}function gMe(t,e,i="always",r=!1){const n={years:["year","yr."],quarters:["quarter","qtr."],months:["month","mo."],weeks:["week","wk."],days:["day","day","days"],hours:["hour","hr."],minutes:["minute","min."],seconds:["second","sec."]},s=["hours","minutes","seconds"].indexOf(t)===-1;if(i==="auto"&&s){const h=t==="days";switch(e){case 1:return h?"tomorrow":`next ${n[t][0]}`;case-1:return h?"yesterday":`last ${n[t][0]}`;case 0:return h?"today":`this ${n[t][0]}`}}const o=Object.is(e,-0)||e<0,a=Math.abs(e),l=a===1,c=n[t],u=r?l?c[1]:c[2]||c[1]:l?n[t][0]:t;return o?`${a} ${u} ago`:`in ${a} ${u}`}function Lq(t,e){let i="";for(const r of t)r.literal?i+=r.val:i+=e(r.val);return i}const yMe={D:Yk,DD:Foe,DDD:Doe,DDDD:Noe,t:Voe,tt:zoe,ttt:joe,tttt:Boe,T:Uoe,TT:Goe,TTT:Hoe,TTTT:qoe,f:Woe,ff:Zoe,fff:Koe,ffff:Qoe,F:Joe,FF:Yoe,FFF:Xoe,FFFF:eae};class ro{static create(e,i={}){return new ro(e,i)}static parseFormat(e){let i=null,r="",n=!1;const s=[];for(let o=0;o<e.length;o++){const a=e.charAt(o);a==="'"?(r.length>0&&s.push({literal:n||/^\s+$/.test(r),val:r}),i=null,r="",n=!n):n||a===i?r+=a:(r.length>0&&s.push({literal:/^\s+$/.test(r),val:r}),r=a,i=a)}return r.length>0&&s.push({literal:n||/^\s+$/.test(r),val:r}),s}static macroTokenToFormatOpts(e){return yMe[e]}constructor(e,i){this.opts=i,this.loc=e,this.systemLoc=null}formatWithSystemDefault(e,i){return this.systemLoc===null&&(this.systemLoc=this.loc.redefaultToSystem()),this.systemLoc.dtFormatter(e,{...this.opts,...i}).format()}formatDateTime(e,i={}){return this.loc.dtFormatter(e,{...this.opts,...i}).format()}formatDateTimeParts(e,i={}){return this.loc.dtFormatter(e,{...this.opts,...i}).formatToParts()}formatInterval(e,i={}){return this.loc.dtFormatter(e.start,{...this.opts,...i}).dtf.formatRange(e.start.toJSDate(),e.end.toJSDate())}resolvedOptions(e,i={}){return this.loc.dtFormatter(e,{...this.opts,...i}).resolvedOptions()}num(e,i=0){if(this.opts.forceSimple)return In(e,i);const r={...this.opts};return i>0&&(r.padTo=i),this.loc.numberFormatter(r).format(e)}formatDateTimeFromString(e,i){const r=this.loc.listingMode()==="en",n=this.loc.outputCalendar&&this.loc.outputCalendar!=="gregory",s=(m,g)=>this.loc.extract(e,m,g),o=m=>e.isOffsetFixed&&e.offset===0&&m.allowZ?"Z":e.isValid?e.zone.formatOffset(e.ts,m.format):"",a=()=>r?hMe(e):s({hour:"numeric",hourCycle:"h12"},"dayperiod"),l=(m,g)=>r?fMe(e,m):s(g?{month:m}:{month:m,day:"numeric"},"month"),c=(m,g)=>r?pMe(e,m):s(g?{weekday:m}:{weekday:m,month:"long",day:"numeric"},"weekday"),u=m=>{const g=ro.macroTokenToFormatOpts(m);return g?this.formatWithSystemDefault(e,g):m},h=m=>r?mMe(e,m):s({era:m},"era"),f=m=>{switch(m){case"S":return this.num(e.millisecond);case"u":case"SSS":return this.num(e.millisecond,3);case"s":return this.num(e.second);case"ss":return this.num(e.second,2);case"uu":return this.num(Math.floor(e.millisecond/10),2);case"uuu":return this.num(Math.floor(e.millisecond/100));case"m":return this.num(e.minute);case"mm":return this.num(e.minute,2);case"h":return this.num(e.hour%12===0?12:e.hour%12);case"hh":return this.num(e.hour%12===0?12:e.hour%12,2);case"H":return this.num(e.hour);case"HH":return this.num(e.hour,2);case"Z":return o({format:"narrow",allowZ:this.opts.allowZ});case"ZZ":return o({format:"short",allowZ:this.opts.allowZ});case"ZZZ":return o({format:"techie",allowZ:this.opts.allowZ});case"ZZZZ":return e.zone.offsetName(e.ts,{format:"short",locale:this.loc.locale});case"ZZZZZ":return e.zone.offsetName(e.ts,{format:"long",locale:this.loc.locale});case"z":return e.zoneName;case"a":return a();case"d":return n?s({day:"numeric"},"day"):this.num(e.day);case"dd":return n?s({day:"2-digit"},"day"):this.num(e.day,2);case"c":return this.num(e.weekday);case"ccc":return c("short",!0);case"cccc":return c("long",!0);case"ccccc":return c("narrow",!0);case"E":return this.num(e.weekday);case"EEE":return c("short",!1);case"EEEE":return c("long",!1);case"EEEEE":return c("narrow",!1);case"L":return n?s({month:"numeric",day:"numeric"},"month"):this.num(e.month);case"LL":return n?s({month:"2-digit",day:"numeric"},"month"):this.num(e.month,2);case"LLL":return l("short",!0);case"LLLL":return l("long",!0);case"LLLLL":return l("narrow",!0);case"M":return n?s({month:"numeric"},"month"):this.num(e.month);case"MM":return n?s({month:"2-digit"},"month"):this.num(e.month,2);case"MMM":return l("short",!1);case"MMMM":return l("long",!1);case"MMMMM":return l("narrow",!1);case"y":return n?s({year:"numeric"},"year"):this.num(e.year);case"yy":return n?s({year:"2-digit"},"year"):this.num(e.year.toString().slice(-2),2);case"yyyy":return n?s({year:"numeric"},"year"):this.num(e.year,4);case"yyyyyy":return n?s({year:"numeric"},"year"):this.num(e.year,6);case"G":return h("short");case"GG":return h("long");case"GGGGG":return h("narrow");case"kk":return this.num(e.weekYear.toString().slice(-2),2);case"kkkk":return this.num(e.weekYear,4);case"W":return this.num(e.weekNumber);case"WW":return this.num(e.weekNumber,2);case"o":return this.num(e.ordinal);case"ooo":return this.num(e.ordinal,3);case"q":return this.num(e.quarter);case"qq":return this.num(e.quarter,2);case"X":return this.num(Math.floor(e.ts/1e3));case"x":return this.num(e.ts);default:return u(m)}};return Lq(ro.parseFormat(i),f)}formatDurationFromString(e,i){const r=l=>{switch(l[0]){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":return"hour";case"d":return"day";case"w":return"week";case"M":return"month";case"y":return"year";default:return null}},n=l=>c=>{const u=r(c);return u?this.num(l.get(u),c.length):c},s=ro.parseFormat(i),o=s.reduce((l,{literal:c,val:u})=>c?l:l.concat(u),[]),a=e.shiftTo(...o.map(r).filter(l=>l));return Lq(s,n(a))}}class cu{constructor(e,i){this.reason=e,this.explanation=i}toMessage(){return this.explanation?`${this.reason}: ${this.explanation}`:this.reason}}const dae=/[A-Za-z_+-]{1,256}(?::?\/[A-Za-z0-9_+-]{1,256}(?:\/[A-Za-z0-9_+-]{1,256})?)?/;function j1(...t){const e=t.reduce((i,r)=>i+r.source,"");return RegExp(`^${e}$`)}function B1(...t){return e=>t.reduce(([i,r,n],s)=>{const[o,a,l]=s(e,n);return[{...i,...o},a||r,l]},[{},null,1]).slice(0,2)}function U1(t,...e){if(t==null)return[null,null];for(const[i,r]of e){const n=i.exec(t);if(n)return r(n)}return[null,null]}function hae(...t){return(e,i)=>{const r={};let n;for(n=0;n<t.length;n++)r[t[n]]=cm(e[i+n]);return[r,null,i+n]}}const pae=/(?:(Z)|([+-]\d\d)(?::?(\d\d))?)/,vMe=`(?:${pae.source}?(?:\\[(${dae.source})\\])?)?`,QB=/(\d\d)(?::?(\d\d)(?::?(\d\d)(?:[.,](\d{1,30}))?)?)?/,fae=RegExp(`${QB.source}${vMe}`),eU=RegExp(`(?:T${fae.source})?`),_Me=/([+-]\d{6}|\d{4})(?:-?(\d\d)(?:-?(\d\d))?)?/,bMe=/(\d{4})-?W(\d\d)(?:-?(\d))?/,wMe=/(\d{4})-?(\d{3})/,xMe=hae("weekYear","weekNumber","weekDay"),SMe=hae("year","ordinal"),IMe=/(\d{4})-(\d\d)-(\d\d)/,mae=RegExp(`${QB.source} ?(?:${pae.source}|(${dae.source}))?`),TMe=RegExp(`(?: ${mae.source})?`);function Mw(t,e,i){const r=t[e];return Wt(r)?i:cm(r)}function CMe(t,e){return[{year:Mw(t,e),month:Mw(t,e+1,1),day:Mw(t,e+2,1)},null,e+3]}function G1(t,e){return[{hours:Mw(t,e,0),minutes:Mw(t,e+1,0),seconds:Mw(t,e+2,0),milliseconds:YB(t[e+3])},null,e+4]}function uC(t,e){const i=!t[e]&&!t[e+1],r=sL(t[e+1],t[e+2]),n=i?null:Ps.instance(r);return[{},n,e+3]}function dC(t,e){const i=t[e]?Cu.create(t[e]):null;return[{},i,e+1]}const EMe=RegExp(`^T?${QB.source}$`),MMe=/^-?P(?:(?:(-?\d{1,20}(?:\.\d{1,20})?)Y)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20}(?:\.\d{1,20})?)W)?(?:(-?\d{1,20}(?:\.\d{1,20})?)D)?(?:T(?:(-?\d{1,20}(?:\.\d{1,20})?)H)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20})(?:[.,](-?\d{1,20}))?S)?)?)$/;function $Me(t){const[e,i,r,n,s,o,a,l,c]=t,u=e[0]==="-",h=l&&l[0]==="-",f=(m,g=!1)=>m!==void 0&&(g||m&&u)?-m:m;return[{years:f(Lg(i)),months:f(Lg(r)),weeks:f(Lg(n)),days:f(Lg(s)),hours:f(Lg(o)),minutes:f(Lg(a)),seconds:f(Lg(l),l==="-0"),milliseconds:f(YB(c),h)}]}const AMe={GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function tU(t,e,i,r,n,s,o){const a={year:e.length===2?pN(cm(e)):cm(e),month:nae.indexOf(i)+1,day:cm(r),hour:cm(n),minute:cm(s)};return o&&(a.second=cm(o)),t&&(a.weekday=t.length>3?oae.indexOf(t)+1:aae.indexOf(t)+1),a}const kMe=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|(?:([+-]\d\d)(\d\d)))$/;function PMe(t){const[,e,i,r,n,s,o,a,l,c,u,h]=t,f=tU(e,n,r,i,s,o,a);let m;return l?m=AMe[l]:c?m=0:m=sL(u,h),[f,new Ps(m)]}function OMe(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim()}const LMe=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d\d) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d\d):(\d\d):(\d\d) GMT$/,RMe=/^(Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d\d)-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d\d) (\d\d):(\d\d):(\d\d) GMT$/,FMe=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( \d|\d\d) (\d\d):(\d\d):(\d\d) (\d{4})$/;function Rq(t){const[,e,i,r,n,s,o,a]=t;return[tU(e,n,r,i,s,o,a),Ps.utcInstance]}function DMe(t){const[,e,i,r,n,s,o,a]=t;return[tU(e,a,i,r,n,s,o),Ps.utcInstance]}const NMe=j1(_Me,eU),VMe=j1(bMe,eU),zMe=j1(wMe,eU),jMe=j1(fae),gae=B1(CMe,G1,uC,dC),BMe=B1(xMe,G1,uC,dC),UMe=B1(SMe,G1,uC,dC),GMe=B1(G1,uC,dC);function HMe(t){return U1(t,[NMe,gae],[VMe,BMe],[zMe,UMe],[jMe,GMe])}function qMe(t){return U1(OMe(t),[kMe,PMe])}function WMe(t){return U1(t,[LMe,Rq],[RMe,Rq],[FMe,DMe])}function JMe(t){return U1(t,[MMe,$Me])}const ZMe=B1(G1);function YMe(t){return U1(t,[EMe,ZMe])}const KMe=j1(IMe,TMe),XMe=j1(mae),QMe=B1(G1,uC,dC);function e$e(t){return U1(t,[KMe,gae],[XMe,QMe])}const t$e="Invalid Duration",yae={weeks:{days:7,hours:7*24,minutes:7*24*60,seconds:7*24*60*60,milliseconds:7*24*60*60*1e3},days:{hours:24,minutes:24*60,seconds:24*60*60,milliseconds:24*60*60*1e3},hours:{minutes:60,seconds:60*60,milliseconds:60*60*1e3},minutes:{seconds:60,milliseconds:60*1e3},seconds:{milliseconds:1e3}},i$e={years:{quarters:4,months:12,weeks:52,days:365,hours:365*24,minutes:365*24*60,seconds:365*24*60*60,milliseconds:365*24*60*60*1e3},quarters:{months:3,weeks:13,days:91,hours:91*24,minutes:91*24*60,seconds:91*24*60*60,milliseconds:91*24*60*60*1e3},months:{weeks:4,days:30,hours:30*24,minutes:30*24*60,seconds:30*24*60*60,milliseconds:30*24*60*60*1e3},...yae},fl=146097/400,u_=146097/4800,r$e={years:{quarters:4,months:12,weeks:fl/7,days:fl,hours:fl*24,minutes:fl*24*60,seconds:fl*24*60*60,milliseconds:fl*24*60*60*1e3},quarters:{months:3,weeks:fl/28,days:fl/4,hours:fl*24/4,minutes:fl*24*60/4,seconds:fl*24*60*60/4,milliseconds:fl*24*60*60*1e3/4},months:{weeks:u_/7,days:u_,hours:u_*24,minutes:u_*24*60,seconds:u_*24*60*60,milliseconds:u_*24*60*60*1e3},...yae},dy=["years","quarters","months","weeks","days","hours","minutes","seconds","milliseconds"],n$e=dy.slice(0).reverse();function Jp(t,e,i=!1){const r={values:i?e.values:{...t.values,...e.values||{}},loc:t.loc.clone(e.loc),conversionAccuracy:e.conversionAccuracy||t.conversionAccuracy,matrix:e.matrix||t.matrix};return new Qt(r)}function s$e(t){return t<0?Math.floor(t):Math.ceil(t)}function vae(t,e,i,r,n){const s=t[n][i],o=e[i]/s,a=Math.sign(o)===Math.sign(r[n]),l=!a&&r[n]!==0&&Math.abs(o)<=1?s$e(o):Math.trunc(o);r[n]+=l,e[i]-=l*s}function o$e(t,e){n$e.reduce((i,r)=>Wt(e[r])?i:(i&&vae(t,e,i,e,r),r),null)}function a$e(t){const e={};for(const[i,r]of Object.entries(t))r!==0&&(e[i]=r);return e}class Qt{constructor(e){const i=e.conversionAccuracy==="longterm"||!1;let r=i?r$e:i$e;e.matrix&&(r=e.matrix),this.values=e.values,this.loc=e.loc||nr.create(),this.conversionAccuracy=i?"longterm":"casual",this.invalid=e.invalid||null,this.matrix=r,this.isLuxonDuration=!0}static fromMillis(e,i){return Qt.fromObject({milliseconds:e},i)}static fromObject(e,i={}){if(e==null||typeof e!="object")throw new Wl(`Duration.fromObject: argument expected to be an object, got ${e===null?"null":typeof e}`);return new Qt({values:Qk(e,Qt.normalizeUnit),loc:nr.fromObject(i),conversionAccuracy:i.conversionAccuracy,matrix:i.matrix})}static fromDurationLike(e){if(tv(e))return Qt.fromMillis(e);if(Qt.isDuration(e))return e;if(typeof e=="object")return Qt.fromObject(e);throw new Wl(`Unknown duration argument ${e} of type ${typeof e}`)}static fromISO(e,i){const[r]=JMe(e);return r?Qt.fromObject(r,i):Qt.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static fromISOTime(e,i){const[r]=YMe(e);return r?Qt.fromObject(r,i):Qt.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static invalid(e,i=null){if(!e)throw new Wl("need to specify a reason the Duration is invalid");const r=e instanceof cu?e:new cu(e,i);if(Sn.throwOnInvalid)throw new REe(r);return new Qt({invalid:r})}static normalizeUnit(e){const i={year:"years",years:"years",quarter:"quarters",quarters:"quarters",month:"months",months:"months",week:"weeks",weeks:"weeks",day:"days",days:"days",hour:"hours",hours:"hours",minute:"minutes",minutes:"minutes",second:"seconds",seconds:"seconds",millisecond:"milliseconds",milliseconds:"milliseconds"}[e&&e.toLowerCase()];if(!i)throw new Roe(e);return i}static isDuration(e){return e&&e.isLuxonDuration||!1}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}toFormat(e,i={}){const r={...i,floor:i.round!==!1&&i.floor!==!1};return this.isValid?ro.create(this.loc,r).formatDurationFromString(this,e):t$e}toHuman(e={}){const i=dy.map(r=>{const n=this.values[r];return Wt(n)?null:this.loc.numberFormatter({style:"unit",unitDisplay:"long",...e,unit:r.slice(0,-1)}).format(n)}).filter(r=>r);return this.loc.listFormatter({type:"conjunction",style:e.listStyle||"narrow",...e}).format(i)}toObject(){return this.isValid?{...this.values}:{}}toISO(){if(!this.isValid)return null;let e="P";return this.years!==0&&(e+=this.years+"Y"),(this.months!==0||this.quarters!==0)&&(e+=this.months+this.quarters*3+"M"),this.weeks!==0&&(e+=this.weeks+"W"),this.days!==0&&(e+=this.days+"D"),(this.hours!==0||this.minutes!==0||this.seconds!==0||this.milliseconds!==0)&&(e+="T"),this.hours!==0&&(e+=this.hours+"H"),this.minutes!==0&&(e+=this.minutes+"M"),(this.seconds!==0||this.milliseconds!==0)&&(e+=KB(this.seconds+this.milliseconds/1e3,3)+"S"),e==="P"&&(e+="T0S"),e}toISOTime(e={}){if(!this.isValid)return null;const i=this.toMillis();if(i<0||i>=864e5)return null;e={suppressMilliseconds:!1,suppressSeconds:!1,includePrefix:!1,format:"extended",...e};const r=this.shiftTo("hours","minutes","seconds","milliseconds");let n=e.format==="basic"?"hhmm":"hh:mm";(!e.suppressSeconds||r.seconds!==0||r.milliseconds!==0)&&(n+=e.format==="basic"?"ss":":ss",(!e.suppressMilliseconds||r.milliseconds!==0)&&(n+=".SSS"));let s=r.toFormat(n);return e.includePrefix&&(s="T"+s),s}toJSON(){return this.toISO()}toString(){return this.toISO()}toMillis(){return this.as("milliseconds")}valueOf(){return this.toMillis()}plus(e){if(!this.isValid)return this;const i=Qt.fromDurationLike(e),r={};for(const n of dy)(s1(i.values,n)||s1(this.values,n))&&(r[n]=i.get(n)+this.get(n));return Jp(this,{values:r},!0)}minus(e){if(!this.isValid)return this;const i=Qt.fromDurationLike(e);return this.plus(i.negate())}mapUnits(e){if(!this.isValid)return this;const i={};for(const r of Object.keys(this.values))i[r]=rae(e(this.values[r],r));return Jp(this,{values:i},!0)}get(e){return this[Qt.normalizeUnit(e)]}set(e){if(!this.isValid)return this;const i={...this.values,...Qk(e,Qt.normalizeUnit)};return Jp(this,{values:i})}reconfigure({locale:e,numberingSystem:i,conversionAccuracy:r,matrix:n}={}){const o={loc:this.loc.clone({locale:e,numberingSystem:i}),matrix:n,conversionAccuracy:r};return Jp(this,o)}as(e){return this.isValid?this.shiftTo(e).get(e):NaN}normalize(){if(!this.isValid)return this;const e=this.toObject();return o$e(this.matrix,e),Jp(this,{values:e},!0)}rescale(){if(!this.isValid)return this;const e=a$e(this.normalize().shiftToAll().toObject());return Jp(this,{values:e},!0)}shiftTo(...e){if(!this.isValid)return this;if(e.length===0)return this;e=e.map(o=>Qt.normalizeUnit(o));const i={},r={},n=this.toObject();let s;for(const o of dy)if(e.indexOf(o)>=0){s=o;let a=0;for(const c in r)a+=this.matrix[c][o]*r[c],r[c]=0;tv(n[o])&&(a+=n[o]);const l=Math.trunc(a);i[o]=l,r[o]=(a*1e3-l*1e3)/1e3;for(const c in n)dy.indexOf(c)>dy.indexOf(o)&&vae(this.matrix,n,c,i,o)}else tv(n[o])&&(r[o]=n[o]);for(const o in r)r[o]!==0&&(i[s]+=o===s?r[o]:r[o]/this.matrix[s][o]);return Jp(this,{values:i},!0).normalize()}shiftToAll(){return this.isValid?this.shiftTo("years","months","weeks","days","hours","minutes","seconds","milliseconds"):this}negate(){if(!this.isValid)return this;const e={};for(const i of Object.keys(this.values))e[i]=this.values[i]===0?0:-this.values[i];return Jp(this,{values:e},!0)}get years(){return this.isValid?this.values.years||0:NaN}get quarters(){return this.isValid?this.values.quarters||0:NaN}get months(){return this.isValid?this.values.months||0:NaN}get weeks(){return this.isValid?this.values.weeks||0:NaN}get days(){return this.isValid?this.values.days||0:NaN}get hours(){return this.isValid?this.values.hours||0:NaN}get minutes(){return this.isValid?this.values.minutes||0:NaN}get seconds(){return this.isValid?this.values.seconds||0:NaN}get milliseconds(){return this.isValid?this.values.milliseconds||0:NaN}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}equals(e){if(!this.isValid||!e.isValid||!this.loc.equals(e.loc))return!1;function i(r,n){return r===void 0||r===0?n===void 0||n===0:r===n}for(const r of dy)if(!i(this.values[r],e.values[r]))return!1;return!0}}const d_="Invalid Interval";function l$e(t,e){return!t||!t.isValid?kr.invalid("missing or invalid start"):!e||!e.isValid?kr.invalid("missing or invalid end"):e<t?kr.invalid("end before start",`The end of an interval must be after its start, but you had start=${t.toISO()} and end=${e.toISO()}`):null}class kr{constructor(e){this.s=e.start,this.e=e.end,this.invalid=e.invalid||null,this.isLuxonInterval=!0}static invalid(e,i=null){if(!e)throw new Wl("need to specify a reason the Interval is invalid");const r=e instanceof cu?e:new cu(e,i);if(Sn.throwOnInvalid)throw new LEe(r);return new kr({invalid:r})}static fromDateTimes(e,i){const r=wx(e),n=wx(i),s=l$e(r,n);return s??new kr({start:r,end:n})}static after(e,i){const r=Qt.fromDurationLike(i),n=wx(e);return kr.fromDateTimes(n,n.plus(r))}static before(e,i){const r=Qt.fromDurationLike(i),n=wx(e);return kr.fromDateTimes(n.minus(r),n)}static fromISO(e,i){const[r,n]=(e||"").split("/",2);if(r&&n){let s,o;try{s=Ae.fromISO(r,i),o=s.isValid}catch{o=!1}let a,l;try{a=Ae.fromISO(n,i),l=a.isValid}catch{l=!1}if(o&&l)return kr.fromDateTimes(s,a);if(o){const c=Qt.fromISO(n,i);if(c.isValid)return kr.after(s,c)}else if(l){const c=Qt.fromISO(r,i);if(c.isValid)return kr.before(a,c)}}return kr.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static isInterval(e){return e&&e.isLuxonInterval||!1}get start(){return this.isValid?this.s:null}get end(){return this.isValid?this.e:null}get isValid(){return this.invalidReason===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}length(e="milliseconds"){return this.isValid?this.toDuration(e).get(e):NaN}count(e="milliseconds"){if(!this.isValid)return NaN;const i=this.start.startOf(e),r=this.end.startOf(e);return Math.floor(r.diff(i,e).get(e))+(r.valueOf()!==this.end.valueOf())}hasSame(e){return this.isValid?this.isEmpty()||this.e.minus(1).hasSame(this.s,e):!1}isEmpty(){return this.s.valueOf()===this.e.valueOf()}isAfter(e){return this.isValid?this.s>e:!1}isBefore(e){return this.isValid?this.e<=e:!1}contains(e){return this.isValid?this.s<=e&&this.e>e:!1}set({start:e,end:i}={}){return this.isValid?kr.fromDateTimes(e||this.s,i||this.e):this}splitAt(...e){if(!this.isValid)return[];const i=e.map(wx).filter(o=>this.contains(o)).sort(),r=[];let{s:n}=this,s=0;for(;n<this.e;){const o=i[s]||this.e,a=+o>+this.e?this.e:o;r.push(kr.fromDateTimes(n,a)),n=a,s+=1}return r}splitBy(e){const i=Qt.fromDurationLike(e);if(!this.isValid||!i.isValid||i.as("milliseconds")===0)return[];let{s:r}=this,n=1,s;const o=[];for(;r<this.e;){const a=this.start.plus(i.mapUnits(l=>l*n));s=+a>+this.e?this.e:a,o.push(kr.fromDateTimes(r,s)),r=s,n+=1}return o}divideEqually(e){return this.isValid?this.splitBy(this.length()/e).slice(0,e):[]}overlaps(e){return this.e>e.s&&this.s<e.e}abutsStart(e){return this.isValid?+this.e==+e.s:!1}abutsEnd(e){return this.isValid?+e.e==+this.s:!1}engulfs(e){return this.isValid?this.s<=e.s&&this.e>=e.e:!1}equals(e){return!this.isValid||!e.isValid?!1:this.s.equals(e.s)&&this.e.equals(e.e)}intersection(e){if(!this.isValid)return this;const i=this.s>e.s?this.s:e.s,r=this.e<e.e?this.e:e.e;return i>=r?null:kr.fromDateTimes(i,r)}union(e){if(!this.isValid)return this;const i=this.s<e.s?this.s:e.s,r=this.e>e.e?this.e:e.e;return kr.fromDateTimes(i,r)}static merge(e){const[i,r]=e.sort((n,s)=>n.s-s.s).reduce(([n,s],o)=>s?s.overlaps(o)||s.abutsStart(o)?[n,s.union(o)]:[n.concat([s]),o]:[n,o],[[],null]);return r&&i.push(r),i}static xor(e){let i=null,r=0;const n=[],s=e.map(l=>[{time:l.s,type:"s"},{time:l.e,type:"e"}]),o=Array.prototype.concat(...s),a=o.sort((l,c)=>l.time-c.time);for(const l of a)r+=l.type==="s"?1:-1,r===1?i=l.time:(i&&+i!=+l.time&&n.push(kr.fromDateTimes(i,l.time)),i=null);return kr.merge(n)}difference(...e){return kr.xor([this].concat(e)).map(i=>this.intersection(i)).filter(i=>i&&!i.isEmpty())}toString(){return this.isValid?`[${this.s.toISO()} – ${this.e.toISO()})`:d_}toLocaleString(e=Yk,i={}){return this.isValid?ro.create(this.s.loc.clone(i),e).formatInterval(this):d_}toISO(e){return this.isValid?`${this.s.toISO(e)}/${this.e.toISO(e)}`:d_}toISODate(){return this.isValid?`${this.s.toISODate()}/${this.e.toISODate()}`:d_}toISOTime(e){return this.isValid?`${this.s.toISOTime(e)}/${this.e.toISOTime(e)}`:d_}toFormat(e,{separator:i=" – "}={}){return this.isValid?`${this.s.toFormat(e)}${i}${this.e.toFormat(e)}`:d_}toDuration(e,i){return this.isValid?this.e.diff(this.s,e,i):Qt.invalid(this.invalidReason)}mapEndpoints(e){return kr.fromDateTimes(e(this.s),e(this.e))}}class wS{static hasDST(e=Sn.defaultZone){const i=Ae.now().setZone(e).set({month:12});return!e.isUniversal&&i.offset!==i.set({month:6}).offset}static isValidIANAZone(e){return Cu.isValidZone(e)}static normalizeZone(e){return vm(e,Sn.defaultZone)}static months(e="long",{locale:i=null,numberingSystem:r=null,locObj:n=null,outputCalendar:s="gregory"}={}){return(n||nr.create(i,r,s)).months(e)}static monthsFormat(e="long",{locale:i=null,numberingSystem:r=null,locObj:n=null,outputCalendar:s="gregory"}={}){return(n||nr.create(i,r,s)).months(e,!0)}static weekdays(e="long",{locale:i=null,numberingSystem:r=null,locObj:n=null}={}){return(n||nr.create(i,r,null)).weekdays(e)}static weekdaysFormat(e="long",{locale:i=null,numberingSystem:r=null,locObj:n=null}={}){return(n||nr.create(i,r,null)).weekdays(e,!0)}static meridiems({locale:e=null}={}){return nr.create(e).meridiems()}static eras(e="short",{locale:i=null}={}){return nr.create(i,null,"gregory").eras(e)}static features(){return{relative:tae()}}}function Fq(t,e){const i=n=>n.toUTC(0,{keepLocalTime:!0}).startOf("day").valueOf(),r=i(e)-i(t);return Math.floor(Qt.fromMillis(r).as("days"))}function c$e(t,e,i){const r=[["years",(l,c)=>c.year-l.year],["quarters",(l,c)=>c.quarter-l.quarter+(c.year-l.year)*4],["months",(l,c)=>c.month-l.month+(c.year-l.year)*12],["weeks",(l,c)=>{const u=Fq(l,c);return(u-u%7)/7}],["days",Fq]],n={},s=t;let o,a;for(const[l,c]of r)i.indexOf(l)>=0&&(o=l,n[l]=c(t,e),a=s.plus(n),a>e?(n[l]--,t=s.plus(n)):t=a);return[t,n,a,o]}function u$e(t,e,i,r){let[n,s,o,a]=c$e(t,e,i);const l=e-n,c=i.filter(h=>["hours","minutes","seconds","milliseconds"].indexOf(h)>=0);c.length===0&&(o<e&&(o=n.plus({[a]:1})),o!==n&&(s[a]=(s[a]||0)+l/(o-n)));const u=Qt.fromObject(s,r);return c.length>0?Qt.fromMillis(l,r).shiftTo(...c).plus(u):u}const iU={arab:"[٠-٩]",arabext:"[۰-۹]",bali:"[᭐-᭙]",beng:"[০-৯]",deva:"[०-९]",fullwide:"[０-９]",gujr:"[૦-૯]",hanidec:"[〇|一|二|三|四|五|六|七|八|九]",khmr:"[០-៩]",knda:"[೦-೯]",laoo:"[໐-໙]",limb:"[᥆-᥏]",mlym:"[൦-൯]",mong:"[᠐-᠙]",mymr:"[၀-၉]",orya:"[୦-୯]",tamldec:"[௦-௯]",telu:"[౦-౯]",thai:"[๐-๙]",tibt:"[༠-༩]",latn:"\\d"},Dq={arab:[1632,1641],arabext:[1776,1785],bali:[6992,7001],beng:[2534,2543],deva:[2406,2415],fullwide:[65296,65303],gujr:[2790,2799],khmr:[6112,6121],knda:[3302,3311],laoo:[3792,3801],limb:[6470,6479],mlym:[3430,3439],mong:[6160,6169],mymr:[4160,4169],orya:[2918,2927],tamldec:[3046,3055],telu:[3174,3183],thai:[3664,3673],tibt:[3872,3881]},d$e=iU.hanidec.replace(/[\[|\]]/g,"").split("");function h$e(t){let e=parseInt(t,10);if(isNaN(e)){e="";for(let i=0;i<t.length;i++){const r=t.charCodeAt(i);if(t[i].search(iU.hanidec)!==-1)e+=d$e.indexOf(t[i]);else for(const n in Dq){const[s,o]=Dq[n];r>=s&&r<=o&&(e+=r-s)}}return parseInt(e,10)}else return e}function _c({numberingSystem:t},e=""){return new RegExp(`${iU[t||"latn"]}${e}`)}const p$e="missing Intl.DateTimeFormat.formatToParts support";function pi(t,e=i=>i){return{regex:t,deser:([i])=>e(h$e(i))}}const f$e=String.fromCharCode(160),_ae=`[ ${f$e}]`,bae=new RegExp(_ae,"g");function m$e(t){return t.replace(/\./g,"\\.?").replace(bae,_ae)}function Nq(t){return t.replace(/\./g,"").replace(bae," ").toLowerCase()}function bc(t,e){return t===null?null:{regex:RegExp(t.map(m$e).join("|")),deser:([i])=>t.findIndex(r=>Nq(i)===Nq(r))+e}}function Vq(t,e){return{regex:t,deser:([,i,r])=>sL(i,r),groups:e}}function SE(t){return{regex:t,deser:([e])=>e}}function g$e(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function y$e(t,e){const i=_c(e),r=_c(e,"{2}"),n=_c(e,"{3}"),s=_c(e,"{4}"),o=_c(e,"{6}"),a=_c(e,"{1,2}"),l=_c(e,"{1,3}"),c=_c(e,"{1,6}"),u=_c(e,"{1,9}"),h=_c(e,"{2,4}"),f=_c(e,"{4,6}"),m=v=>({regex:RegExp(g$e(v.val)),deser:([b])=>b,literal:!0}),y=(v=>{if(t.literal)return m(v);switch(v.val){case"G":return bc(e.eras("short",!1),0);case"GG":return bc(e.eras("long",!1),0);case"y":return pi(c);case"yy":return pi(h,pN);case"yyyy":return pi(s);case"yyyyy":return pi(f);case"yyyyyy":return pi(o);case"M":return pi(a);case"MM":return pi(r);case"MMM":return bc(e.months("short",!0,!1),1);case"MMMM":return bc(e.months("long",!0,!1),1);case"L":return pi(a);case"LL":return pi(r);case"LLL":return bc(e.months("short",!1,!1),1);case"LLLL":return bc(e.months("long",!1,!1),1);case"d":return pi(a);case"dd":return pi(r);case"o":return pi(l);case"ooo":return pi(n);case"HH":return pi(r);case"H":return pi(a);case"hh":return pi(r);case"h":return pi(a);case"mm":return pi(r);case"m":return pi(a);case"q":return pi(a);case"qq":return pi(r);case"s":return pi(a);case"ss":return pi(r);case"S":return pi(l);case"SSS":return pi(n);case"u":return SE(u);case"uu":return SE(a);case"uuu":return pi(i);case"a":return bc(e.meridiems(),0);case"kkkk":return pi(s);case"kk":return pi(h,pN);case"W":return pi(a);case"WW":return pi(r);case"E":case"c":return pi(i);case"EEE":return bc(e.weekdays("short",!1,!1),1);case"EEEE":return bc(e.weekdays("long",!1,!1),1);case"ccc":return bc(e.weekdays("short",!0,!1),1);case"cccc":return bc(e.weekdays("long",!0,!1),1);case"Z":case"ZZ":return Vq(new RegExp(`([+-]${a.source})(?::(${r.source}))?`),2);case"ZZZ":return Vq(new RegExp(`([+-]${a.source})(${r.source})?`),2);case"z":return SE(/[a-z_+-/]{1,256}?/i);case" ":return SE(/[^\S\n\r]/);default:return m(v)}})(t)||{invalidReason:p$e};return y.token=t,y}const v$e={year:{"2-digit":"yy",numeric:"yyyyy"},month:{numeric:"M","2-digit":"MM",short:"MMM",long:"MMMM"},day:{numeric:"d","2-digit":"dd"},weekday:{short:"EEE",long:"EEEE"},dayperiod:"a",dayPeriod:"a",hour:{numeric:"h","2-digit":"hh"},minute:{numeric:"m","2-digit":"mm"},second:{numeric:"s","2-digit":"ss"},timeZoneName:{long:"ZZZZZ",short:"ZZZ"}};function _$e(t,e){const{type:i,value:r}=t;if(i==="literal"){const o=/^\s+$/.test(r);return{literal:!o,val:o?" ":r}}const n=e[i];let s=v$e[i];if(typeof s=="object"&&(s=s[n]),s)return{literal:!1,val:s}}function b$e(t){return[`^${t.map(i=>i.regex).reduce((i,r)=>`${i}(${r.source})`,"")}$`,t]}function w$e(t,e,i){const r=t.match(e);if(r){const n={};let s=1;for(const o in i)if(s1(i,o)){const a=i[o],l=a.groups?a.groups+1:1;!a.literal&&a.token&&(n[a.token.val[0]]=a.deser(r.slice(s,s+l))),s+=l}return[r,n]}else return[r,{}]}function x$e(t){const e=s=>{switch(s){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":case"H":return"hour";case"d":return"day";case"o":return"ordinal";case"L":case"M":return"month";case"y":return"year";case"E":case"c":return"weekday";case"W":return"weekNumber";case"k":return"weekYear";case"q":return"quarter";default:return null}};let i=null,r;return Wt(t.z)||(i=Cu.create(t.z)),Wt(t.Z)||(i||(i=new Ps(t.Z)),r=t.Z),Wt(t.q)||(t.M=(t.q-1)*3+1),Wt(t.h)||(t.h<12&&t.a===1?t.h+=12:t.h===12&&t.a===0&&(t.h=0)),t.G===0&&t.y&&(t.y=-t.y),Wt(t.u)||(t.S=YB(t.u)),[Object.keys(t).reduce((s,o)=>{const a=e(o);return a&&(s[a]=t[o]),s},{}),i,r]}let I3=null;function S$e(){return I3||(I3=Ae.fromMillis(1555555555555)),I3}function I$e(t,e){if(t.literal)return t;const i=ro.macroTokenToFormatOpts(t.val),r=Sae(i,e);return r==null||r.includes(void 0)?t:r}function wae(t,e){return Array.prototype.concat(...t.map(i=>I$e(i,e)))}function xae(t,e,i){const r=wae(ro.parseFormat(i),t),n=r.map(o=>y$e(o,t)),s=n.find(o=>o.invalidReason);if(s)return{input:e,tokens:r,invalidReason:s.invalidReason};{const[o,a]=b$e(n),l=RegExp(o,"i"),[c,u]=w$e(e,l,a),[h,f,m]=u?x$e(u):[null,null,void 0];if(s1(u,"a")&&s1(u,"H"))throw new _S("Can't include meridiem when specifying 24-hour format");return{input:e,tokens:r,regex:l,rawMatches:c,matches:u,result:h,zone:f,specificOffset:m}}}function T$e(t,e,i){const{result:r,zone:n,specificOffset:s,invalidReason:o}=xae(t,e,i);return[r,n,s,o]}function Sae(t,e){return t?ro.create(e,t).formatDateTimeParts(S$e()).map(n=>_$e(n,t)):null}const Iae=[0,31,59,90,120,151,181,212,243,273,304,334],Tae=[0,31,60,91,121,152,182,213,244,274,305,335];function Yl(t,e){return new cu("unit out of range",`you specified ${e} (of type ${typeof e}) as a ${t}, which is invalid`)}function Cae(t,e,i){const r=new Date(Date.UTC(t,e-1,i));t<100&&t>=0&&r.setUTCFullYear(r.getUTCFullYear()-1900);const n=r.getUTCDay();return n===0?7:n}function Eae(t,e,i){return i+(cC(t)?Tae:Iae)[e-1]}function Mae(t,e){const i=cC(t)?Tae:Iae,r=i.findIndex(s=>s<e),n=e-i[r];return{month:r+1,day:n}}function fN(t){const{year:e,month:i,day:r}=t,n=Eae(e,i,r),s=Cae(e,i,r);let o=Math.floor((n-s+10)/7),a;return o<1?(a=e-1,o=Xk(a)):o>Xk(e)?(a=e+1,o=1):a=e,{weekYear:a,weekNumber:o,weekday:s,...oL(t)}}function zq(t){const{weekYear:e,weekNumber:i,weekday:r}=t,n=Cae(e,1,4),s=Z2(e);let o=i*7+r-n-3,a;o<1?(a=e-1,o+=Z2(a)):o>s?(a=e+1,o-=Z2(e)):a=e;const{month:l,day:c}=Mae(a,o);return{year:a,month:l,day:c,...oL(t)}}function T3(t){const{year:e,month:i,day:r}=t,n=Eae(e,i,r);return{year:e,ordinal:n,...oL(t)}}function jq(t){const{year:e,ordinal:i}=t,{month:r,day:n}=Mae(e,i);return{year:e,month:r,day:n,...oL(t)}}function C$e(t){const e=nL(t.weekYear),i=Jh(t.weekNumber,1,Xk(t.weekYear)),r=Jh(t.weekday,1,7);return e?i?r?!1:Yl("weekday",t.weekday):Yl("week",t.week):Yl("weekYear",t.weekYear)}function E$e(t){const e=nL(t.year),i=Jh(t.ordinal,1,Z2(t.year));return e?i?!1:Yl("ordinal",t.ordinal):Yl("year",t.year)}function $ae(t){const e=nL(t.year),i=Jh(t.month,1,12),r=Jh(t.day,1,Kk(t.year,t.month));return e?i?r?!1:Yl("day",t.day):Yl("month",t.month):Yl("year",t.year)}function Aae(t){const{hour:e,minute:i,second:r,millisecond:n}=t,s=Jh(e,0,23)||e===24&&i===0&&r===0&&n===0,o=Jh(i,0,59),a=Jh(r,0,59),l=Jh(n,0,999);return s?o?a?l?!1:Yl("millisecond",n):Yl("second",r):Yl("minute",i):Yl("hour",e)}const C3="Invalid DateTime",Bq=864e13;function IE(t){return new cu("unsupported zone",`the zone "${t.name}" is not supported`)}function E3(t){return t.weekData===null&&(t.weekData=fN(t.c)),t.weekData}function _x(t,e){const i={ts:t.ts,zone:t.zone,c:t.c,o:t.o,loc:t.loc,invalid:t.invalid};return new Ae({...i,...e,old:i})}function kae(t,e,i){let r=t-e*60*1e3;const n=i.offset(r);if(e===n)return[r,e];r-=(n-e)*60*1e3;const s=i.offset(r);return n===s?[r,n]:[t-Math.min(n,s)*60*1e3,Math.max(n,s)]}function Uq(t,e){t+=e*60*1e3;const i=new Date(t);return{year:i.getUTCFullYear(),month:i.getUTCMonth()+1,day:i.getUTCDate(),hour:i.getUTCHours(),minute:i.getUTCMinutes(),second:i.getUTCSeconds(),millisecond:i.getUTCMilliseconds()}}function R$(t,e,i){return kae(XB(t),e,i)}function Gq(t,e){const i=t.o,r=t.c.year+Math.trunc(e.years),n=t.c.month+Math.trunc(e.months)+Math.trunc(e.quarters)*3,s={...t.c,year:r,month:n,day:Math.min(t.c.day,Kk(r,n))+Math.trunc(e.days)+Math.trunc(e.weeks)*7},o=Qt.fromObject({years:e.years-Math.trunc(e.years),quarters:e.quarters-Math.trunc(e.quarters),months:e.months-Math.trunc(e.months),weeks:e.weeks-Math.trunc(e.weeks),days:e.days-Math.trunc(e.days),hours:e.hours,minutes:e.minutes,seconds:e.seconds,milliseconds:e.milliseconds}).as("milliseconds"),a=XB(s);let[l,c]=kae(a,i,t.zone);return o!==0&&(l+=o,c=t.zone.offset(l)),{ts:l,o:c}}function bx(t,e,i,r,n,s){const{setZone:o,zone:a}=i;if(t&&Object.keys(t).length!==0||e){const l=e||a,c=Ae.fromObject(t,{...i,zone:l,specificOffset:s});return o?c:c.setZone(a)}else return Ae.invalid(new cu("unparsable",`the input "${n}" can't be parsed as ${r}`))}function TE(t,e,i=!0){return t.isValid?ro.create(nr.create("en-US"),{allowZ:i,forceSimple:!0}).formatDateTimeFromString(t,e):null}function M3(t,e){const i=t.c.year>9999||t.c.year<0;let r="";return i&&t.c.year>=0&&(r+="+"),r+=In(t.c.year,i?6:4),e?(r+="-",r+=In(t.c.month),r+="-",r+=In(t.c.day)):(r+=In(t.c.month),r+=In(t.c.day)),r}function Hq(t,e,i,r,n,s){let o=In(t.c.hour);return e?(o+=":",o+=In(t.c.minute),(t.c.second!==0||!i)&&(o+=":")):o+=In(t.c.minute),(t.c.second!==0||!i)&&(o+=In(t.c.second),(t.c.millisecond!==0||!r)&&(o+=".",o+=In(t.c.millisecond,3))),n&&(t.isOffsetFixed&&t.offset===0&&!s?o+="Z":t.o<0?(o+="-",o+=In(Math.trunc(-t.o/60)),o+=":",o+=In(Math.trunc(-t.o%60))):(o+="+",o+=In(Math.trunc(t.o/60)),o+=":",o+=In(Math.trunc(t.o%60)))),s&&(o+="["+t.zone.ianaName+"]"),o}const Pae={month:1,day:1,hour:0,minute:0,second:0,millisecond:0},M$e={weekNumber:1,weekday:1,hour:0,minute:0,second:0,millisecond:0},$$e={ordinal:1,hour:0,minute:0,second:0,millisecond:0},Oae=["year","month","day","hour","minute","second","millisecond"],A$e=["weekYear","weekNumber","weekday","hour","minute","second","millisecond"],k$e=["year","ordinal","hour","minute","second","millisecond"];function qq(t){const e={year:"year",years:"year",month:"month",months:"month",day:"day",days:"day",hour:"hour",hours:"hour",minute:"minute",minutes:"minute",quarter:"quarter",quarters:"quarter",second:"second",seconds:"second",millisecond:"millisecond",milliseconds:"millisecond",weekday:"weekday",weekdays:"weekday",weeknumber:"weekNumber",weeksnumber:"weekNumber",weeknumbers:"weekNumber",weekyear:"weekYear",weekyears:"weekYear",ordinal:"ordinal"}[t.toLowerCase()];if(!e)throw new Roe(t);return e}function Wq(t,e){const i=vm(e.zone,Sn.defaultZone),r=nr.fromObject(e),n=Sn.now();let s,o;if(Wt(t.year))s=n;else{for(const c of Oae)Wt(t[c])&&(t[c]=Pae[c]);const a=$ae(t)||Aae(t);if(a)return Ae.invalid(a);const l=i.offset(n);[s,o]=R$(t,l,i)}return new Ae({ts:s,zone:i,loc:r,o})}function Jq(t,e,i){const r=Wt(i.round)?!0:i.round,n=(o,a)=>(o=KB(o,r||i.calendary?0:2,!0),e.loc.clone(i).relFormatter(i).format(o,a)),s=o=>i.calendary?e.hasSame(t,o)?0:e.startOf(o).diff(t.startOf(o),o).get(o):e.diff(t,o).get(o);if(i.unit)return n(s(i.unit),i.unit);for(const o of i.units){const a=s(o);if(Math.abs(a)>=1)return n(a,o)}return n(t>e?-0:0,i.units[i.units.length-1])}function Zq(t){let e={},i;return t.length>0&&typeof t[t.length-1]=="object"?(e=t[t.length-1],i=Array.from(t).slice(0,t.length-1)):i=Array.from(t),[e,i]}class Ae{constructor(e){const i=e.zone||Sn.defaultZone;let r=e.invalid||(Number.isNaN(e.ts)?new cu("invalid input"):null)||(i.isValid?null:IE(i));this.ts=Wt(e.ts)?Sn.now():e.ts;let n=null,s=null;if(!r)if(e.old&&e.old.ts===this.ts&&e.old.zone.equals(i))[n,s]=[e.old.c,e.old.o];else{const a=i.offset(this.ts);n=Uq(this.ts,a),r=Number.isNaN(n.year)?new cu("invalid input"):null,n=r?null:n,s=r?null:a}this._zone=i,this.loc=e.loc||nr.create(),this.invalid=r,this.weekData=null,this.c=n,this.o=s,this.isLuxonDateTime=!0}static now(){return new Ae({})}static local(){const[e,i]=Zq(arguments),[r,n,s,o,a,l,c]=i;return Wq({year:r,month:n,day:s,hour:o,minute:a,second:l,millisecond:c},e)}static utc(){const[e,i]=Zq(arguments),[r,n,s,o,a,l,c]=i;return e.zone=Ps.utcInstance,Wq({year:r,month:n,day:s,hour:o,minute:a,second:l,millisecond:c},e)}static fromJSDate(e,i={}){const r=iMe(e)?e.valueOf():NaN;if(Number.isNaN(r))return Ae.invalid("invalid input");const n=vm(i.zone,Sn.defaultZone);return n.isValid?new Ae({ts:r,zone:n,loc:nr.fromObject(i)}):Ae.invalid(IE(n))}static fromMillis(e,i={}){if(tv(e))return e<-Bq||e>Bq?Ae.invalid("Timestamp out of range"):new Ae({ts:e,zone:vm(i.zone,Sn.defaultZone),loc:nr.fromObject(i)});throw new Wl(`fromMillis requires a numerical input, but received a ${typeof e} with value ${e}`)}static fromSeconds(e,i={}){if(tv(e))return new Ae({ts:e*1e3,zone:vm(i.zone,Sn.defaultZone),loc:nr.fromObject(i)});throw new Wl("fromSeconds requires a numerical input")}static fromObject(e,i={}){e=e||{};const r=vm(i.zone,Sn.defaultZone);if(!r.isValid)return Ae.invalid(IE(r));const n=Sn.now(),s=Wt(i.specificOffset)?r.offset(n):i.specificOffset,o=Qk(e,qq),a=!Wt(o.ordinal),l=!Wt(o.year),c=!Wt(o.month)||!Wt(o.day),u=l||c,h=o.weekYear||o.weekNumber,f=nr.fromObject(i);if((u||a)&&h)throw new _S("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(c&&a)throw new _S("Can't mix ordinal dates with month/day");const m=h||o.weekday&&!u;let g,y,v=Uq(n,s);m?(g=A$e,y=M$e,v=fN(v)):a?(g=k$e,y=$$e,v=T3(v)):(g=Oae,y=Pae);let b=!1;for(const E of g){const $=o[E];Wt($)?b?o[E]=y[E]:o[E]=v[E]:b=!0}const w=m?C$e(o):a?E$e(o):$ae(o),x=w||Aae(o);if(x)return Ae.invalid(x);const S=m?zq(o):a?jq(o):o,[I,T]=R$(S,s,r),C=new Ae({ts:I,zone:r,o:T,loc:f});return o.weekday&&u&&e.weekday!==C.weekday?Ae.invalid("mismatched weekday",`you can't specify both a weekday of ${o.weekday} and a date of ${C.toISO()}`):C}static fromISO(e,i={}){const[r,n]=HMe(e);return bx(r,n,i,"ISO 8601",e)}static fromRFC2822(e,i={}){const[r,n]=qMe(e);return bx(r,n,i,"RFC 2822",e)}static fromHTTP(e,i={}){const[r,n]=WMe(e);return bx(r,n,i,"HTTP",i)}static fromFormat(e,i,r={}){if(Wt(e)||Wt(i))throw new Wl("fromFormat requires an input string and a format");const{locale:n=null,numberingSystem:s=null}=r,o=nr.fromOpts({locale:n,numberingSystem:s,defaultToEN:!0}),[a,l,c,u]=T$e(o,e,i);return u?Ae.invalid(u):bx(a,l,r,`format ${i}`,e,c)}static fromString(e,i,r={}){return Ae.fromFormat(e,i,r)}static fromSQL(e,i={}){const[r,n]=e$e(e);return bx(r,n,i,"SQL",e)}static invalid(e,i=null){if(!e)throw new Wl("need to specify a reason the DateTime is invalid");const r=e instanceof cu?e:new cu(e,i);if(Sn.throwOnInvalid)throw new OEe(r);return new Ae({invalid:r})}static isDateTime(e){return e&&e.isLuxonDateTime||!1}static parseFormatForOpts(e,i={}){const r=Sae(e,nr.fromObject(i));return r?r.map(n=>n?n.val:null).join(""):null}static expandFormat(e,i={}){return wae(ro.parseFormat(e),nr.fromObject(i)).map(n=>n.val).join("")}get(e){return this[e]}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}get outputCalendar(){return this.isValid?this.loc.outputCalendar:null}get zone(){return this._zone}get zoneName(){return this.isValid?this.zone.name:null}get year(){return this.isValid?this.c.year:NaN}get quarter(){return this.isValid?Math.ceil(this.c.month/3):NaN}get month(){return this.isValid?this.c.month:NaN}get day(){return this.isValid?this.c.day:NaN}get hour(){return this.isValid?this.c.hour:NaN}get minute(){return this.isValid?this.c.minute:NaN}get second(){return this.isValid?this.c.second:NaN}get millisecond(){return this.isValid?this.c.millisecond:NaN}get weekYear(){return this.isValid?E3(this).weekYear:NaN}get weekNumber(){return this.isValid?E3(this).weekNumber:NaN}get weekday(){return this.isValid?E3(this).weekday:NaN}get ordinal(){return this.isValid?T3(this.c).ordinal:NaN}get monthShort(){return this.isValid?wS.months("short",{locObj:this.loc})[this.month-1]:null}get monthLong(){return this.isValid?wS.months("long",{locObj:this.loc})[this.month-1]:null}get weekdayShort(){return this.isValid?wS.weekdays("short",{locObj:this.loc})[this.weekday-1]:null}get weekdayLong(){return this.isValid?wS.weekdays("long",{locObj:this.loc})[this.weekday-1]:null}get offset(){return this.isValid?+this.o:NaN}get offsetNameShort(){return this.isValid?this.zone.offsetName(this.ts,{format:"short",locale:this.locale}):null}get offsetNameLong(){return this.isValid?this.zone.offsetName(this.ts,{format:"long",locale:this.locale}):null}get isOffsetFixed(){return this.isValid?this.zone.isUniversal:null}get isInDST(){return this.isOffsetFixed?!1:this.offset>this.set({month:1,day:1}).offset||this.offset>this.set({month:5}).offset}get isInLeapYear(){return cC(this.year)}get daysInMonth(){return Kk(this.year,this.month)}get daysInYear(){return this.isValid?Z2(this.year):NaN}get weeksInWeekYear(){return this.isValid?Xk(this.weekYear):NaN}resolvedLocaleOptions(e={}){const{locale:i,numberingSystem:r,calendar:n}=ro.create(this.loc.clone(e),e).resolvedOptions(this);return{locale:i,numberingSystem:r,outputCalendar:n}}toUTC(e=0,i={}){return this.setZone(Ps.instance(e),i)}toLocal(){return this.setZone(Sn.defaultZone)}setZone(e,{keepLocalTime:i=!1,keepCalendarTime:r=!1}={}){if(e=vm(e,Sn.defaultZone),e.equals(this.zone))return this;if(e.isValid){let n=this.ts;if(i||r){const s=e.offset(this.ts),o=this.toObject();[n]=R$(o,s,e)}return _x(this,{ts:n,zone:e})}else return Ae.invalid(IE(e))}reconfigure({locale:e,numberingSystem:i,outputCalendar:r}={}){const n=this.loc.clone({locale:e,numberingSystem:i,outputCalendar:r});return _x(this,{loc:n})}setLocale(e){return this.reconfigure({locale:e})}set(e){if(!this.isValid)return this;const i=Qk(e,qq),r=!Wt(i.weekYear)||!Wt(i.weekNumber)||!Wt(i.weekday),n=!Wt(i.ordinal),s=!Wt(i.year),o=!Wt(i.month)||!Wt(i.day),a=s||o,l=i.weekYear||i.weekNumber;if((a||n)&&l)throw new _S("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(o&&n)throw new _S("Can't mix ordinal dates with month/day");let c;r?c=zq({...fN(this.c),...i}):Wt(i.ordinal)?(c={...this.toObject(),...i},Wt(i.day)&&(c.day=Math.min(Kk(c.year,c.month),c.day))):c=jq({...T3(this.c),...i});const[u,h]=R$(c,this.o,this.zone);return _x(this,{ts:u,o:h})}plus(e){if(!this.isValid)return this;const i=Qt.fromDurationLike(e);return _x(this,Gq(this,i))}minus(e){if(!this.isValid)return this;const i=Qt.fromDurationLike(e).negate();return _x(this,Gq(this,i))}startOf(e){if(!this.isValid)return this;const i={},r=Qt.normalizeUnit(e);switch(r){case"years":i.month=1;case"quarters":case"months":i.day=1;case"weeks":case"days":i.hour=0;case"hours":i.minute=0;case"minutes":i.second=0;case"seconds":i.millisecond=0;break}if(r==="weeks"&&(i.weekday=1),r==="quarters"){const n=Math.ceil(this.month/3);i.month=(n-1)*3+1}return this.set(i)}endOf(e){return this.isValid?this.plus({[e]:1}).startOf(e).minus(1):this}toFormat(e,i={}){return this.isValid?ro.create(this.loc.redefaultToEN(i)).formatDateTimeFromString(this,e):C3}toLocaleString(e=Yk,i={}){return this.isValid?ro.create(this.loc.clone(i),e).formatDateTime(this):C3}toLocaleParts(e={}){return this.isValid?ro.create(this.loc.clone(e),e).formatDateTimeParts(this):[]}toISO({format:e="extended",suppressSeconds:i=!1,suppressMilliseconds:r=!1,includeOffset:n=!0,extendedZone:s=!1}={}){if(!this.isValid)return null;const o=e==="extended";let a=M3(this,o);return a+="T",a+=Hq(this,o,i,r,n,s),a}toISODate({format:e="extended"}={}){return this.isValid?M3(this,e==="extended"):null}toISOWeekDate(){return TE(this,"kkkk-'W'WW-c")}toISOTime({suppressMilliseconds:e=!1,suppressSeconds:i=!1,includeOffset:r=!0,includePrefix:n=!1,extendedZone:s=!1,format:o="extended"}={}){return this.isValid?(n?"T":"")+Hq(this,o==="extended",i,e,r,s):null}toRFC2822(){return TE(this,"EEE, dd LLL yyyy HH:mm:ss ZZZ",!1)}toHTTP(){return TE(this.toUTC(),"EEE, dd LLL yyyy HH:mm:ss 'GMT'")}toSQLDate(){return this.isValid?M3(this,!0):null}toSQLTime({includeOffset:e=!0,includeZone:i=!1,includeOffsetSpace:r=!0}={}){let n="HH:mm:ss.SSS";return(i||e)&&(r&&(n+=" "),i?n+="z":e&&(n+="ZZ")),TE(this,n,!0)}toSQL(e={}){return this.isValid?`${this.toSQLDate()} ${this.toSQLTime(e)}`:null}toString(){return this.isValid?this.toISO():C3}valueOf(){return this.toMillis()}toMillis(){return this.isValid?this.ts:NaN}toSeconds(){return this.isValid?this.ts/1e3:NaN}toUnixInteger(){return this.isValid?Math.floor(this.ts/1e3):NaN}toJSON(){return this.toISO()}toBSON(){return this.toJSDate()}toObject(e={}){if(!this.isValid)return{};const i={...this.c};return e.includeConfig&&(i.outputCalendar=this.outputCalendar,i.numberingSystem=this.loc.numberingSystem,i.locale=this.loc.locale),i}toJSDate(){return new Date(this.isValid?this.ts:NaN)}diff(e,i="milliseconds",r={}){if(!this.isValid||!e.isValid)return Qt.invalid("created by diffing an invalid DateTime");const n={locale:this.locale,numberingSystem:this.numberingSystem,...r},s=rMe(i).map(Qt.normalizeUnit),o=e.valueOf()>this.valueOf(),a=o?this:e,l=o?e:this,c=u$e(a,l,s,n);return o?c.negate():c}diffNow(e="milliseconds",i={}){return this.diff(Ae.now(),e,i)}until(e){return this.isValid?kr.fromDateTimes(this,e):this}hasSame(e,i){if(!this.isValid)return!1;const r=e.valueOf(),n=this.setZone(e.zone,{keepLocalTime:!0});return n.startOf(i)<=r&&r<=n.endOf(i)}equals(e){return this.isValid&&e.isValid&&this.valueOf()===e.valueOf()&&this.zone.equals(e.zone)&&this.loc.equals(e.loc)}toRelative(e={}){if(!this.isValid)return null;const i=e.base||Ae.fromObject({},{zone:this.zone}),r=e.padding?this<i?-e.padding:e.padding:0;let n=["years","months","days","hours","minutes","seconds"],s=e.unit;return Array.isArray(e.unit)&&(n=e.unit,s=void 0),Jq(i,this.plus(r),{...e,numeric:"always",units:n,unit:s})}toRelativeCalendar(e={}){return this.isValid?Jq(e.base||Ae.fromObject({},{zone:this.zone}),this,{...e,numeric:"auto",units:["years","months","days"],calendary:!0}):null}static min(...e){if(!e.every(Ae.isDateTime))throw new Wl("min requires all arguments be DateTimes");return Oq(e,i=>i.valueOf(),Math.min)}static max(...e){if(!e.every(Ae.isDateTime))throw new Wl("max requires all arguments be DateTimes");return Oq(e,i=>i.valueOf(),Math.max)}static fromFormatExplain(e,i,r={}){const{locale:n=null,numberingSystem:s=null}=r,o=nr.fromOpts({locale:n,numberingSystem:s,defaultToEN:!0});return xae(o,e,i)}static fromStringExplain(e,i,r={}){return Ae.fromFormatExplain(e,i,r)}static get DATE_SHORT(){return Yk}static get DATE_MED(){return Foe}static get DATE_MED_WITH_WEEKDAY(){return FEe}static get DATE_FULL(){return Doe}static get DATE_HUGE(){return Noe}static get TIME_SIMPLE(){return Voe}static get TIME_WITH_SECONDS(){return zoe}static get TIME_WITH_SHORT_OFFSET(){return joe}static get TIME_WITH_LONG_OFFSET(){return Boe}static get TIME_24_SIMPLE(){return Uoe}static get TIME_24_WITH_SECONDS(){return Goe}static get TIME_24_WITH_SHORT_OFFSET(){return Hoe}static get TIME_24_WITH_LONG_OFFSET(){return qoe}static get DATETIME_SHORT(){return Woe}static get DATETIME_SHORT_WITH_SECONDS(){return Joe}static get DATETIME_MED(){return Zoe}static get DATETIME_MED_WITH_SECONDS(){return Yoe}static get DATETIME_MED_WITH_WEEKDAY(){return DEe}static get DATETIME_FULL(){return Koe}static get DATETIME_FULL_WITH_SECONDS(){return Xoe}static get DATETIME_HUGE(){return Qoe}static get DATETIME_HUGE_WITH_SECONDS(){return eae}}function wx(t){if(Ae.isDateTime(t))return t;if(t&&t.valueOf&&tv(t.valueOf()))return Ae.fromJSDate(t);if(t&&typeof t=="object")return Ae.fromObject(t);throw new Wl(`Unknown datetime argument: ${t}, of type ${typeof t}`)}const P$e={year:void 0,month:void 0,day:void 0,weekday:void 0},O$e={hour:void 0,minute:void 0,second:void 0},L$e={timeZone:Intl.DateTimeFormat().resolvedOptions().timeZone},rU={timeZone:"Etc/UTC"},Du={year:"numeric",month:"numeric",day:"numeric"},xx={year:"numeric",month:"long",day:"numeric"},Sx={year:"numeric",month:"short",day:"numeric"},Ix={year:"numeric",month:"long",weekday:"long",day:"numeric"},Il={hour:"numeric",minute:"numeric"},wc={...Il,second:"numeric"},H1={"short-date":Du,"short-date-short-time":{...Du,...Il},"short-date-short-time-24":{...Du,...Il,hour12:!1},"short-date-long-time":{...Du,...wc},"short-date-long-time-24":{...Du,...wc,hour12:!1},"short-date-le":Du,"short-date-le-short-time":{...Du,...Il},"short-date-le-short-time-24":{...Du,...Il,hour12:!1},"short-date-le-long-time":{...Du,...wc},"short-date-le-long-time-24":{...Du,...wc,hour12:!1},"long-month-day-year":xx,"long-month-day-year-short-time":{...xx,...Il},"long-month-day-year-short-time-24":{...xx,...Il,hour12:!1},"long-month-day-year-long-time":{...xx,...wc},"long-month-day-year-long-time-24":{...xx,...wc,hour12:!1},"day-short-month-year":Sx,"day-short-month-year-short-time":{...Sx,...Il},"day-short-month-year-short-time-24":{...Sx,...Il,hour12:!1},"day-short-month-year-long-time":{...Sx,...wc},"day-short-month-year-long-time-24":{...Sx,...wc,hour12:!1},"long-date":Ix,"long-date-short-time":{...Ix,...Il},"long-date-short-time-24":{...Ix,...Il,hour12:!1},"long-date-long-time":{...Ix,...wc},"long-date-long-time-24":{...Ix,...wc,hour12:!1},"long-month-year":{month:"long",year:"numeric"},"short-month-year":{month:"short",year:"numeric"},year:{year:"numeric"},"short-time":Il,"long-time":wc},R$e=ln()({shortDate:"short-date",shortDateShortTime:"short-date-short-time",shortDateShortTime24:"short-date-short-time-24",shortDateLongTime:"short-date-long-time",shortDateLongTime24:"short-date-long-time-24",shortDateLE:"short-date-le",shortDateLEShortTime:"short-date-le-short-time",shortDateLEShortTime24:"short-date-le-short-time-24",shortDateLELongTime:"short-date-le-long-time",shortDateLELongTime24:"short-date-le-long-time-24",longMonthDayYear:"long-month-day-year",longMonthDayYearShortTime:"long-month-day-year-short-time",longMonthDayYearShortTime24:"long-month-day-year-short-time-24",longMonthDayYearLongTime:"long-month-day-year-long-time",longMonthDayYearLongTime24:"long-month-day-year-long-time-24",dayShortMonthYear:"day-short-month-year",dayShortMonthYearShortTime:"day-short-month-year-short-time",dayShortMonthYearShortTime24:"day-short-month-year-short-time-24",dayShortMonthYearLongTime:"day-short-month-year-long-time",dayShortMonthYearLongTime24:"day-short-month-year-long-time-24",longDate:"long-date",longDateShortTime:"long-date-short-time",longDateShortTime24:"long-date-short-time-24",longDateLongTime:"long-date-long-time",longDateLongTime24:"long-date-long-time-24",longMonthYear:"long-month-year",shortMonthYear:"short-month-year",year:"year"}),Lae={ar:"ar-u-nu-latn-ca-gregory"};let mN=new WeakMap,Rae=H1["short-date-short-time"];function Fae(t){const e=t||Rae;let i=mN.get(e);if(!i){const r=Mn(),n=Lae[r]||r;i=new Intl.DateTimeFormat(n,e),mN.set(e,i)}return i}function Zh(t){return H1[t]}function Oi(t,e){return Fae(e).format(t)}function nU(t,e=H1["short-date"]){return Oi(new Date(t),{...e,...rU,...O$e})}function sU(t,e=H1["short-time"]){return Oi(new Date(`1970-01-01T${t}Z`),{...e,...rU,...P$e})}function oU(t,e=H1["short-date-short-time"]){const i=Ae.fromISO(t,{setZone:!0}),r=Mn(),n=Lae[r]??r;return i.toLocaleString({...L$e,...e},{locale:n})}bB(()=>{mN=new WeakMap,Rae=H1["short-date-short-time"]});const F$e={ar:"ar-u-nu-latn"};let F$=new WeakMap,Dae={};function D$e(t){const e=t||Dae;if(!F$.has(e)){const i=Mn(),r=F$e[Mn()]||i;F$.set(e,new Intl.NumberFormat(r,t))}return F$.get(e)}function aU(t={}){const e={};return t.digitSeparator!=null&&(e.useGrouping=t.digitSeparator),t.places!=null&&(e.minimumFractionDigits=e.maximumFractionDigits=t.places),e}function po(t,e){return Object.is(t,-0)&&(t=0),D$e(e).format(t)}bB(()=>{F$=new WeakMap,Dae={}});let Z_=class extends Li(te){constructor(e){super(e),this.dateFormat=null,this.digitSeparator=!1,this.places=null}formatNumber(e){return po(e,aU(this))}formatDate(e,i=!1){return this.dateFormat?Oi(e,{...Zh(this.dateFormat),...i&&rU}):this.formatNumber(e)}formatDateOnly(e){const i=(this.dateFormat&&Zh(this.dateFormat))??void 0;return nU(e,i)}formatTimeOnly(e){const i=(this.dateFormat&&Zh(this.dateFormat))??void 0;return sU(e,i)}formatTimestamp(e){const i=(this.dateFormat&&Zh(this.dateFormat))??void 0;return oU(e,i)}formatRasterPixelValue(e){return e.includes("-")?e:e.trim().includes(",")?this._formatDelimitedString(e,",",", "):e.trim().includes(";")?this._formatDelimitedString(e,";","; "):e.trim().includes(" ")?this._formatDelimitedString(e," "," "):this.formatNumber(Number(e))}_formatDelimitedString(e,i,r){return e&&i&&r?e.trim().split(i).map(n=>this.formatNumber(Number(n))).join(r):e}};d([xe(R$e)],Z_.prototype,"dateFormat",void 0),d([p({type:Boolean,json:{write:!0}})],Z_.prototype,"digitSeparator",void 0),d([p({type:wt,json:{write:!0}})],Z_.prototype,"places",void 0),Z_=d([A("esri.popup.support.FieldInfoFormat")],Z_);const sw=Z_;var gN;let Ac=gN=class extends te{constructor(t){super(t),this.fieldName=null,this.format=null,this.isEditable=!0,this.label=null,this.stringFieldOption="text-box",this.statisticType=null,this.tooltip=null,this.visible=!0}clone(){return new gN({fieldName:this.fieldName,format:this.format?U(this.format):null,isEditable:this.isEditable,label:this.label,stringFieldOption:this.stringFieldOption,statisticType:this.statisticType,tooltip:this.tooltip,visible:this.visible})}};d([p({type:String,json:{write:!0}})],Ac.prototype,"fieldName",void 0),d([p({type:sw,json:{write:!0}})],Ac.prototype,"format",void 0),d([p({type:Boolean,json:{write:{alwaysWriteDefaults:!0},default:!0}})],Ac.prototype,"isEditable",void 0),d([p({type:String,json:{write:!0}})],Ac.prototype,"label",void 0),d([xe(new He({richtext:"rich-text",textarea:"text-area",textbox:"text-box"}),{default:"text-box"})],Ac.prototype,"stringFieldOption",void 0),d([p({type:["count","sum","min","max","avg","stddev","var"],json:{write:!0}})],Ac.prototype,"statisticType",void 0),d([p({type:String,json:{write:!0}})],Ac.prototype,"tooltip",void 0),d([p({type:Boolean,json:{write:!0}})],Ac.prototype,"visible",void 0),Ac=gN=d([A("esri.popup.FieldInfo")],Ac);const lU=Ac;var yN;let hh=yN=class extends wg{constructor(t){super(t),this.attributes=null,this.description=null,this.fieldInfos=null,this.title=null,this.type="fields"}writeFieldInfos(t,e){e.fieldInfos=t&&t.map(i=>i.toJSON())}clone(){return new yN(U({attributes:this.attributes,description:this.description,fieldInfos:this.fieldInfos,title:this.title}))}};d([p({type:Object,json:{write:!0}})],hh.prototype,"attributes",void 0),d([p({type:String,json:{write:!0}})],hh.prototype,"description",void 0),d([p({type:[lU]})],hh.prototype,"fieldInfos",void 0),d([ge("fieldInfos")],hh.prototype,"writeFieldInfos",null),d([p({type:String,json:{write:!0}})],hh.prototype,"title",void 0),d([p({type:["fields"],readOnly:!0,json:{read:!1,write:!0}})],hh.prototype,"type",void 0),hh=yN=d([A("esri.popup.content.FieldsContent")],hh);const QI=hh;let hy=class extends te{constructor(e){super(e),this.altText=null,this.caption="",this.title="",this.type=null}};d([p({type:String,json:{write:!0}})],hy.prototype,"altText",void 0),d([p({type:String,json:{write:!0}})],hy.prototype,"caption",void 0),d([p({type:String,json:{write:!0}})],hy.prototype,"title",void 0),d([p({type:["image","bar-chart","column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],hy.prototype,"type",void 0),hy=d([A("esri.popup.content.mixins.MediaInfo")],hy);const cU=hy;var vN;let Y_=vN=class extends he{constructor(t){super(t),this.fieldName=null,this.tooltip=null,this.value=null}clone(){return new vN({fieldName:this.fieldName,tooltip:this.tooltip,value:this.value})}};d([p()],Y_.prototype,"fieldName",void 0),d([p()],Y_.prototype,"tooltip",void 0),d([p()],Y_.prototype,"value",void 0),Y_=vN=d([A("esri.popup.content.support.ChartMediaInfoValueSeries")],Y_);const N$e=Y_;var _N;let py=_N=class extends te{constructor(t){super(t),this.fields=[],this.normalizeField=null,this.series=[],this.tooltipField=null}clone(){return new _N({fields:U(this.fields),normalizeField:this.normalizeField,tooltipField:this.tooltipField})}};d([p({type:[String],json:{write:!0}})],py.prototype,"fields",void 0),d([p({type:String,json:{write:!0}})],py.prototype,"normalizeField",void 0),d([p({type:[N$e],json:{read:!1}})],py.prototype,"series",void 0),d([p({type:String,json:{write:!0}})],py.prototype,"tooltipField",void 0),py=_N=d([A("esri.popup.content.support.ChartMediaInfoValue")],py);const V$e=py;let xS=class extends cU{constructor(e){super(e),this.type=null,this.value=null}};d([p({type:["bar-chart","column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],xS.prototype,"type",void 0),d([p({type:V$e,json:{write:!0}})],xS.prototype,"value",void 0),xS=d([A("esri.popup.content.mixins.ChartMediaInfo")],xS);const aL=xS,lL=ln()({barchart:"bar-chart",columnchart:"column-chart",linechart:"line-chart",piechart:"pie-chart"});var bN;let D$=bN=class extends aL{constructor(t){super(t),this.type="bar-chart"}clone(){return new bN({altText:this.altText,title:this.title,caption:this.caption,value:this.value?this.value.clone():null})}};d([p({type:["bar-chart"],readOnly:!0,json:{type:["barchart"],read:!1,write:lL.write}})],D$.prototype,"type",void 0),D$=bN=d([A("esri.popup.content.BarChartMediaInfo")],D$);const Nae=D$;var wN;let N$=wN=class extends aL{constructor(t){super(t),this.type="column-chart"}clone(){return new wN({altText:this.altText,title:this.title,caption:this.caption,value:this.value?this.value.clone():null})}};d([p({type:["column-chart"],readOnly:!0,json:{type:["columnchart"],read:!1,write:lL.write}})],N$.prototype,"type",void 0),N$=wN=d([A("esri.popup.content.ColumnChartMediaInfo")],N$);const Vae=N$;var xN;let SS=xN=class extends te{constructor(t){super(t),this.linkURL=null,this.sourceURL=null}clone(){return new xN({linkURL:this.linkURL,sourceURL:this.sourceURL})}};d([p({type:String,json:{write:!0}})],SS.prototype,"linkURL",void 0),d([p({type:String,json:{write:!0}})],SS.prototype,"sourceURL",void 0),SS=xN=d([A("esri.popup.content.support.ImageMediaInfoValue")],SS);const z$e=SS;var SN;let K_=SN=class extends cU{constructor(t){super(t),this.refreshInterval=null,this.type="image",this.value=null}clone(){return new SN({altText:this.altText,title:this.title,caption:this.caption,refreshInterval:this.refreshInterval,value:this.value?this.value.clone():null})}};d([p({type:Number,json:{write:!0}})],K_.prototype,"refreshInterval",void 0),d([p({type:["image"],readOnly:!0,json:{read:!1,write:!0}})],K_.prototype,"type",void 0),d([p({type:z$e,json:{write:!0}})],K_.prototype,"value",void 0),K_=SN=d([A("esri.popup.content.ImageMediaInfo")],K_);const zae=K_;var IN;let V$=IN=class extends aL{constructor(t){super(t),this.type="line-chart"}clone(){return new IN({altText:this.altText,title:this.title,caption:this.caption,value:this.value?this.value.clone():null})}};d([p({type:["line-chart"],readOnly:!0,json:{type:["linechart"],read:!1,write:lL.write}})],V$.prototype,"type",void 0),V$=IN=d([A("esri.popup.content.LineChartMediaInfo")],V$);const jae=V$;var TN;let z$=TN=class extends aL{constructor(t){super(t),this.type="pie-chart"}clone(){return new TN({altText:this.altText,title:this.title,caption:this.caption,value:this.value?this.value.clone():null})}};d([p({type:["pie-chart"],readOnly:!0,json:{type:["piechart"],read:!1,write:lL.write}})],z$.prototype,"type",void 0),z$=TN=d([A("esri.popup.content.PieChartMediaInfo")],z$);const Bae=z$,Uae={base:cU,key:"type",defaultKeyValue:"image",typeMap:{"bar-chart":Nae,"column-chart":Vae,"line-chart":jae,"pie-chart":Bae,image:zae}};var CN;let kc=CN=class extends wg{constructor(t){super(t),this.activeMediaInfoIndex=null,this.attributes=null,this.description=null,this.mediaInfos=null,this.title=null,this.type="media"}readMediaInfos(t){return t&&t.map(e=>e.type==="image"?zae.fromJSON(e):e.type==="barchart"?Nae.fromJSON(e):e.type==="columnchart"?Vae.fromJSON(e):e.type==="linechart"?jae.fromJSON(e):e.type==="piechart"?Bae.fromJSON(e):void 0).filter(Boolean)}writeMediaInfos(t,e){e.mediaInfos=t&&t.map(i=>i.toJSON())}clone(){return new CN(U({activeMediaInfoIndex:this.activeMediaInfoIndex,attributes:this.attributes,description:this.description,mediaInfos:this.mediaInfos,title:this.title}))}};d([p()],kc.prototype,"activeMediaInfoIndex",void 0),d([p({type:Object,json:{write:!0}})],kc.prototype,"attributes",void 0),d([p({type:String,json:{write:!0}})],kc.prototype,"description",void 0),d([p({types:[Uae]})],kc.prototype,"mediaInfos",void 0),d([ae("mediaInfos")],kc.prototype,"readMediaInfos",null),d([ge("mediaInfos")],kc.prototype,"writeMediaInfos",null),d([p({type:String,json:{write:!0}})],kc.prototype,"title",void 0),d([p({type:["media"],readOnly:!0,json:{read:!1,write:!0}})],kc.prototype,"type",void 0),kc=CN=d([A("esri.popup.content.MediaContent")],kc);const eP=kc;var EN;let IS=EN=class extends te{constructor(t){super(t),this.field=null,this.order=null}clone(){return new EN({field:this.field,order:this.order})}};d([p({type:String,json:{write:!0}})],IS.prototype,"field",void 0),d([p({type:["asc","desc"],json:{write:!0}})],IS.prototype,"order",void 0),IS=EN=d([A("esri.popup.support.RelatedRecordsInfoFieldOrder")],IS);const uU=IS;let qu=class extends Li(wg){constructor(e){super(e),this.description=null,this.displayCount=null,this.displayType="list",this.orderByFields=null,this.relationshipId=null,this.title=null,this.type="relationship"}};d([p({type:String,json:{write:!0}})],qu.prototype,"description",void 0),d([p({type:Number,json:{type:wt,write:!0}})],qu.prototype,"displayCount",void 0),d([p({type:["list"],json:{write:!0}})],qu.prototype,"displayType",void 0),d([p({type:[uU],json:{write:!0}})],qu.prototype,"orderByFields",void 0),d([p({type:Number,json:{type:wt,write:!0}})],qu.prototype,"relationshipId",void 0),d([p({type:String,json:{write:!0}})],qu.prototype,"title",void 0),d([p({type:["relationship"],readOnly:!0,json:{read:!1,write:!0}})],qu.prototype,"type",void 0),qu=d([A("esri.popup.content.RelationshipContent")],qu);const tP=qu;var MN;let TS=MN=class extends wg{constructor(t){super(t),this.text=null,this.type="text"}clone(){return new MN({text:this.text})}};d([p({type:String,json:{write:!0}})],TS.prototype,"text",void 0),d([p({type:["text"],readOnly:!0,json:{read:!1,write:!0}})],TS.prototype,"type",void 0),TS=MN=d([A("esri.popup.content.TextContent")],TS);const iP=TS,j$e={base:null,key:"type",typeMap:{attachment:XI,media:eP,text:iP,expression:ZB,field:QI,relationship:tP}};var $N;let fy=$N=class extends te{constructor(t){super(t),this.name=null,this.title=null,this.expression=null,this.returnType=null}clone(){return new $N({name:this.name,title:this.title,expression:this.expression,returnType:this.returnType})}};d([p({type:String,json:{write:!0}})],fy.prototype,"name",void 0),d([p({type:String,json:{write:!0}})],fy.prototype,"title",void 0),d([p({type:String,json:{write:!0}})],fy.prototype,"expression",void 0),d([p({type:["string","number"],json:{write:!0}})],fy.prototype,"returnType",void 0),fy=$N=d([A("esri.popup.ExpressionInfo")],fy);const B$e=fy;var AN;let CS=AN=class extends te{constructor(t){super(t),this.returnTopmostRaster=null,this.showNoDataRecords=null}clone(){return new AN({showNoDataRecords:this.showNoDataRecords,returnTopmostRaster:this.returnTopmostRaster})}};d([p({type:Boolean,json:{write:!0}})],CS.prototype,"returnTopmostRaster",void 0),d([p({type:Boolean,json:{write:!0}})],CS.prototype,"showNoDataRecords",void 0),CS=AN=d([A("esri.popup.LayerOptions")],CS);const U$e=CS;var kN;let ES=kN=class extends te{constructor(t){super(t),this.showRelatedRecords=null,this.orderByFields=null}clone(){return new kN({showRelatedRecords:this.showRelatedRecords,orderByFields:this.orderByFields?U(this.orderByFields):null})}};d([p({type:Boolean,json:{write:!0}})],ES.prototype,"showRelatedRecords",void 0),d([p({type:[uU],json:{write:!0}})],ES.prototype,"orderByFields",void 0),ES=kN=d([A("esri.popup.RelatedRecordsInfo")],ES);const G$e=ES;var PN;let Tl=PN=class extends bg(he){constructor(t){super(t),this.active=!1,this.className=null,this.disabled=!1,this.icon=null,this.id=null,this.indicator=!1,this.title=null,this.type=null,this.visible=!0}clone(){return new PN({active:this.active,className:this.className,disabled:this.disabled,icon:this.icon,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible})}};d([p()],Tl.prototype,"active",void 0),d([p()],Tl.prototype,"className",void 0),d([p()],Tl.prototype,"disabled",void 0),d([p()],Tl.prototype,"icon",void 0),d([p()],Tl.prototype,"id",void 0),d([p()],Tl.prototype,"indicator",void 0),d([p()],Tl.prototype,"title",void 0),d([p()],Tl.prototype,"type",void 0),d([p()],Tl.prototype,"visible",void 0),Tl=PN=d([A("esri.support.actions.ActionBase")],Tl);const hC=Tl;var ON;let j$=ON=class extends hC{constructor(t){super(t),this.image=null,this.type="button"}clone(){return new ON({active:this.active,className:this.className,disabled:this.disabled,icon:this.icon,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image})}};d([p()],j$.prototype,"image",void 0),j$=ON=d([A("esri.support.Action.ActionButton")],j$);const Gae=j$;var LN;let MS=LN=class extends hC{constructor(t){super(t),this.image=null,this.type="toggle",this.value=!1}clone(){return new LN({active:this.active,className:this.className,disabled:this.disabled,icon:this.icon,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image,value:this.value})}};d([p()],MS.prototype,"image",void 0),d([p()],MS.prototype,"value",void 0),MS=LN=d([A("esri.support.Action.ActionToggle")],MS);const Hae=MS,H$e="esri.PopupTemplate",q$e=ie.getLogger(H$e),Tx="relationships/",Yq="expression/",W$e=ye.ofType({key:"type",defaultKeyValue:"button",base:hC,typeMap:{button:Gae,toggle:Hae}}),J$e={base:wg,key:"type",typeMap:{media:eP,custom:kEe,text:iP,attachments:XI,fields:QI,expression:ZB,relationship:tP}},Z$e=["attachments","fields","media","text","expression","relationship"];let jn=class extends Li(te){constructor(){super(...arguments),this.actions=null,this.content="",this.expressionInfos=null,this.fieldInfos=null,this.layerOptions=null,this.lastEditInfoEnabled=!0,this.outFields=null,this.overwriteActions=!1,this.returnGeometry=!1,this.title=""}castContent(e){return Array.isArray(e)?e.map(i=>Dd(J$e,i)):typeof e=="string"||typeof e=="function"||e instanceof HTMLElement||Tp(e)?e:(q$e.error("content error","unsupported content value",{value:e}),null)}readContent(e,i){const{popupElements:r}=i;return Array.isArray(r)&&r.length>0?this._readPopupInfoElements(i.description,i.mediaInfos,r):this._readPopupInfo(i)}writeContent(e,i,r,n){typeof e!="string"?Array.isArray(e)&&(i.popupElements=e.filter(s=>Z$e.includes(s.type)).map(s=>s&&s.toJSON(n)),i.popupElements.forEach(s=>{s.type==="attachments"?this._writeAttachmentContent(i):s.type==="media"?this._writeMediaContent(s,i):s.type==="text"?this._writeTextContent(s,i):s.type==="relationship"&&this._writeRelationshipContent(s,i)})):i.description=e}writeFieldInfos(e,i,r,n){const{content:s}=this,o=Array.isArray(s)?s:null;if(e){const a=o?o.filter(c=>c.type==="fields"):[],l=a.length&&a.every(c=>{var u;return(u=c.fieldInfos)==null?void 0:u.length});i.fieldInfos=e.filter(Boolean).map(c=>{const u=c.toJSON(n);return l&&(u.visible=!1),u})}if(o)for(const a of o)a.type==="fields"&&this._writeFieldsContent(a,i)}writeLayerOptions(e,i,r,n){i[r]=!e||e.showNoDataRecords===null&&e.returnTopmostRaster===null?null:e.toJSON(n)}writeTitle(e,i){i.title=e||""}async collectRequiredFields(e,i){const r=this.expressionInfos||[];await this._collectExpressionInfoFields(e,i,[...r,...this._getContentExpressionInfos(this.content,r)]),YI(e,i,[...this.outFields||[],...this._getActionsFields(this.actions),...this._getTitleFields(this.title),...this._getContentFields(this.content)])}async getRequiredFields(e){const i=new Set;return await this.collectRequiredFields(i,e),[...i].sort()}_writeFieldsContent(e,i){if(!Array.isArray(e.fieldInfos)||!e.fieldInfos.length)return;const r=U(e.fieldInfos);Array.isArray(i.fieldInfos)?r.forEach(n=>{const s=i.fieldInfos.find(o=>o.fieldName.toLowerCase()===n.fieldName.toLowerCase());s?s.visible=!0:i.fieldInfos.push(n)}):i.fieldInfos=r}_writeAttachmentContent(e){e.showAttachments||(e.showAttachments=!0)}_writeRelationshipContent(e,i){var s,o;const r=((s=e.orderByFields)==null?void 0:s.map(a=>this._toFieldOrderJSON(a,e.relationshipId)))||[],n=[...((o=i.relatedRecordsInfo)==null?void 0:o.orderByFields)||[],...r];i.relatedRecordsInfo={showRelatedRecords:!0,...(n==null?void 0:n.length)&&{orderByFields:n}}}_writeTextContent(e,i){!i.description&&e.text&&(i.description=e.text)}_writeMediaContent(e,i){if(!Array.isArray(e.mediaInfos)||!e.mediaInfos.length)return;const r=U(e.mediaInfos);Array.isArray(i.mediaInfos)?i.mediaInfos=[...i.mediaInfos,...r]:i.mediaInfos=r}_readPopupInfoElements(e,i,r){const n={description:!1,mediaInfos:!1};return r.map(s=>s.type==="media"?(s.mediaInfos||!i||n.mediaInfos||(s.mediaInfos=i,n.mediaInfos=!0),eP.fromJSON(s)):s.type==="text"?(s.text||!e||n.description||(s.text=e,n.description=!0),iP.fromJSON(s)):s.type==="attachments"?XI.fromJSON(s):s.type==="fields"?QI.fromJSON(s):s.type==="expression"?ZB.fromJSON(s):s.type==="relationship"?tP.fromJSON(s):void 0).filter(Boolean)}_toRelationshipContent(e){const{field:i,order:r}=e;if(!(i!=null&&i.startsWith(Tx)))return null;const n=i.replace(Tx,"").split("/");if(n.length!==2)return null;const s=parseInt(n[0],10),o=n[1];return typeof s=="number"&&o?tP.fromJSON({relationshipId:s,orderByFields:[{field:o,order:r}]}):null}_toFieldOrderJSON(e,i){const{order:r,field:n}=e;return{field:`${Tx}${i}/${n}`,order:r}}_readPopupInfo({description:e,mediaInfos:i,showAttachments:r,relatedRecordsInfo:n={showRelatedRecords:!1}}){const s=[];e?s.push(new iP({text:e})):s.push(new QI),Array.isArray(i)&&i.length&&s.push(eP.fromJSON({mediaInfos:i})),r&&s.push(XI.fromJSON({displayType:"auto"}));const{showRelatedRecords:o,orderByFields:a}=n;return o&&(a!=null&&a.length)&&a.forEach(l=>{const c=this._toRelationshipContent(l);c&&s.push(c)}),s.length?s:e}_getContentElementFields(e){const i=e==null?void 0:e.type;if(i==="attachments")return[...this._extractFieldNames(e.title),...this._extractFieldNames(e.description)];if(i==="custom")return e.outFields||[];if(i==="fields")return[...this._extractFieldNames(e.title),...this._extractFieldNames(e.description),...this._getFieldInfoFields(e.fieldInfos??this.fieldInfos)];if(i==="media"){const r=e.mediaInfos||[];return[...this._extractFieldNames(e.title),...this._extractFieldNames(e.description),...r.reduce((n,s)=>[...n,...this._getMediaInfoFields(s)],[])]}return i==="text"?this._extractFieldNames(e.text):[]}_getMediaInfoFields(e){const{caption:i,title:r,value:n}=e,s=n||{},{fields:o,normalizeField:a,tooltipField:l,sourceURL:c,linkURL:u}=s,h=[...this._extractFieldNames(r),...this._extractFieldNames(i),...this._extractFieldNames(c),...this._extractFieldNames(u),...o??[]];return a&&h.push(a),l&&h.push(l),h}_getContentExpressionInfos(e,i){return Array.isArray(e)?e.reduce((r,n)=>[...r,...n.type==="expression"&&n.expressionInfo?[n.expressionInfo]:[]],i):[]}_getContentFields(e){return typeof e=="string"?this._extractFieldNames(e):Array.isArray(e)?e.reduce((i,r)=>[...i,...this._getContentElementFields(r)],[]):[]}async _collectExpressionInfoFields(e,i,r){r&&await Promise.all(r.map(n=>jo(e,i,n.expression)))}_getFieldInfoFields(e){return e?e.filter(i=>i.visible===void 0||!!i.visible).map(i=>i.fieldName).filter(i=>!i.startsWith(Tx)&&!i.startsWith(Yq)):[]}_getActionsFields(e){return e?e.toArray().reduce((i,r)=>[...i,...this._getActionFields(r)],[]):[]}_getActionFields(e){const{className:i,title:r,type:n}=e,s=n==="button"||n==="toggle"?e.image:"";return[...this._extractFieldNames(r),...this._extractFieldNames(i),...this._extractFieldNames(s)]}_getTitleFields(e){return typeof e=="string"?this._extractFieldNames(e):[]}_extractFieldNames(e){if(!e||typeof e!="string")return[];const i=/{[^}]*}/g,r=e.match(i);if(!r)return[];const n=/\{(\w+):.+\}/,s=r.filter(o=>!(o.indexOf(`{${Tx}`)===0||o.indexOf(`{${Yq}`)===0)).map(o=>o.replace(n,"{$1}"));return s?s.map(o=>o.slice(1,-1)):[]}};d([p({type:W$e})],jn.prototype,"actions",void 0),d([p()],jn.prototype,"content",void 0),d([tt("content")],jn.prototype,"castContent",null),d([ae("content",["description","fieldInfos","popupElements","mediaInfos","showAttachments","relatedRecordsInfo"])],jn.prototype,"readContent",null),d([ge("content",{popupElements:{type:ye.ofType(j$e)},showAttachments:{type:Boolean},mediaInfos:{type:ye.ofType(Uae)},description:{type:String},relatedRecordsInfo:{type:G$e}})],jn.prototype,"writeContent",null),d([p({type:[B$e],json:{write:!0}})],jn.prototype,"expressionInfos",void 0),d([p({type:[lU]})],jn.prototype,"fieldInfos",void 0),d([ge("fieldInfos")],jn.prototype,"writeFieldInfos",null),d([p({type:U$e})],jn.prototype,"layerOptions",void 0),d([ge("layerOptions")],jn.prototype,"writeLayerOptions",null),d([p({type:Boolean,json:{read:{source:"showLastEditInfo"},write:{target:"showLastEditInfo"},default:!0}})],jn.prototype,"lastEditInfoEnabled",void 0),d([p()],jn.prototype,"outFields",void 0),d([p()],jn.prototype,"overwriteActions",void 0),d([p()],jn.prototype,"returnGeometry",void 0),d([p({json:{type:String}})],jn.prototype,"title",void 0),d([ge("title")],jn.prototype,"writeTitle",null),jn=d([A("esri.PopupTemplate")],jn);const Mp=jn,Kq=new He({esriSMS:"simple-marker",esriPMS:"picture-marker",esriSLS:"simple-line",esriSFS:"simple-fill",esriPFS:"picture-fill",esriTS:"text",esriSHD:"shield-label-symbol",PointSymbol3D:"point-3d",LineSymbol3D:"line-3d",PolygonSymbol3D:"polygon-3d",WebStyleSymbol:"web-style",MeshSymbol3D:"mesh-3d",LabelSymbol3D:"label-3d",CIMSymbolReference:"cim"});let Y$e=0,X_=class extends te{constructor(e){super(e),this.id="sym"+Y$e++,this.type=null,this.color=new ce([0,0,0,1])}readColor(e){return e&&e[0]!=null?[e[0],e[1],e[2],e[3]/255]:e}async collectRequiredFields(e,i){}hash(){return JSON.stringify(this.toJSON())}clone(){}};d([p({type:Kq.apiValues,readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0,writer:Kq.write}}})],X_.prototype,"type",void 0),d([p({type:ce,json:{write:{allowNull:!0}}})],X_.prototype,"color",void 0),d([ae("color")],X_.prototype,"readColor",null),X_=d([A("esri.symbols.Symbol")],X_);const Ma=X_;var RN;let ff=RN=class extends Ma{constructor(t){super(t),this.data=null,this.type="cim"}readData(t,e){return e}writeData(t,e){Object.assign(e,t)}async collectRequiredFields(t,e){var i;if(((i=this.data)==null?void 0:i.type)==="CIMSymbolReference"){const r=this.data.primitiveOverrides;if(r){const n=r.map(s=>{const o=s.valueExpressionInfo;return jo(t,e,o.expression)});await Promise.all(n)}}}clone(){return new RN({data:U(this.data)})}hash(){return j6(JSON.stringify(this.data)).toString()}};d([p({json:{write:!1}})],ff.prototype,"color",void 0),d([p({json:{write:!0}})],ff.prototype,"data",void 0),d([ae("data",["symbol"])],ff.prototype,"readData",null),d([ge("data",{})],ff.prototype,"writeData",null),d([xe({CIMSymbolReference:"cim"},{readOnly:!0})],ff.prototype,"type",void 0),ff=RN=d([A("esri.symbols.CIMSymbol")],ff);const q1=ff;let Q_=class extends te{constructor(e){super(e),this.enabled=!0,this.type=null,this.ignoreDrivers=!1}writeEnabled(e,i,r){e||(i[r]=e)}};d([p({type:Boolean,json:{read:{source:"enable"},write:{target:"enable"}}})],Q_.prototype,"enabled",void 0),d([ge("enabled")],Q_.prototype,"writeEnabled",null),d([p({type:["icon","object","line","path","fill","water","extrude","text"],readOnly:!0})],Q_.prototype,"type",void 0),Q_=d([A("esri.symbols.Symbol3DLayer")],Q_);const Jd=Q_,K$e=/^-?(\d+(\.\d+)?)\s*((px)|(pt))?$/i,X$e="screenUtils.toPt: input not recognized!",qae=96;function or(t){return t?t/72*qae:0}function wa(t){return t?72*t/qae:0}function $t(t){if(typeof t=="string"){const e=t.match(K$e);if(e){const i=Number(e[1]),r=e[3]&&e[3].toLowerCase(),n=t.charAt(0)==="-",s=r==="px"?wa(i):i;return n?-s:s}return console.warn(X$e),null}return t}function so(t=0,e=0){return{x:t,y:e}}function Q$e(t=0,e=0){return[t,e]}function Qyt(t=0,e=0,i=0){return[t,e,i]}function e0t(t){return t}function t0t(t){return t}function i0t(t){return t}function r0t(t,e){return e?(e[0]=t.x,e[1]=t.y,e.length>2&&(e[2]=0),e):[t.x,t.y]}function eAe(t,e){const i=e.transparency!=null?WI(e.transparency):1,r=e.color;return r&&Array.isArray(r)?new ce([r[0]||0,r[1]||0,r[2]||0,i]):null}function tAe(t,e){e.color=t.toJSON().slice(0,3);const i=eL(t.a);i!==0&&(e.transparency=i)}const xg={type:ce,json:{type:[wt],default:null,read:{source:["color","transparency"],reader:eAe},write:{target:{color:{type:[wt]},transparency:{type:wt}},writer:tAe}}},jd={type:Number,cast:$t,json:{write:!0}};let my=class extends te{constructor(e){super(e),this.color=new ce([0,0,0,1]),this.extensionLength=0,this.size=wa(1)}clone(){}cloneProperties(){return{color:U(this.color),size:this.size,extensionLength:this.extensionLength}}};d([p({type:["solid","sketch"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],my.prototype,"type",void 0),d([p(xg)],my.prototype,"color",void 0),d([p({...jd,json:{write:{overridePolicy:t=>({enabled:!!t})}}})],my.prototype,"extensionLength",void 0),d([p(jd)],my.prototype,"size",void 0),my=d([A("esri.symbols.edges.Edges3D")],my);const dU=my;var FN;let B$=FN=class extends dU{constructor(t){super(t),this.type="sketch"}clone(){return new FN(this.cloneProperties())}};d([xe({sketch:"sketch"},{readOnly:!0})],B$.prototype,"type",void 0),B$=FN=d([A("esri.symbols.edges.SketchEdges3D")],B$);const iAe=B$;var DN;let U$=DN=class extends dU{constructor(t){super(t),this.type="solid"}clone(){return new DN(this.cloneProperties())}};d([xe({solid:"solid"},{readOnly:!0})],U$.prototype,"type",void 0),U$=DN=d([A("esri.symbols.support.SolidEdges3D")],U$);const rAe=U$,Wae={types:{key:"type",base:dU,typeMap:{solid:rAe,sketch:iAe}},json:{write:!0}};var NN;let sl=NN=class extends te{constructor(t){super(t),this.color=null}clone(){const t={color:this.color!=null?this.color.clone():null};return new NN(t)}};d([p(xg)],sl.prototype,"color",void 0),sl=NN=d([A("esri.symbols.support.Symbol3DMaterial")],sl);var VN;let mf=VN=class extends Jd{constructor(t){super(t),this.type="extrude",this.size=1,this.material=null,this.castShadows=!0,this.edges=null}clone(){return new VN({edges:this.edges&&this.edges.clone(),enabled:this.enabled,material:this.material!=null?this.material.clone():null,castShadows:this.castShadows,size:this.size})}};d([xe({Extrude:"extrude"},{readOnly:!0})],mf.prototype,"type",void 0),d([p({type:Number,json:{write:{enabled:!0,isRequired:!0}},nonNullable:!0})],mf.prototype,"size",void 0),d([p({type:sl,json:{write:!0}})],mf.prototype,"material",void 0),d([p({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],mf.prototype,"castShadows",void 0),d([p(Wae)],mf.prototype,"edges",void 0),mf=VN=d([A("esri.symbols.ExtrudeSymbol3DLayer")],mf);const Jae=mf;let $S=class extends Ma{constructor(e){super(e),this.type="simple-line",this.width=.75}hash(){return`${this.type}.${this.width}`}};d([xe({esriSLS:"simple-line"},{readOnly:!0})],$S.prototype,"type",void 0),d([p({type:Number,cast:$t,json:{write:!0}})],$S.prototype,"width",void 0),$S=d([A("esri.symbols.LineSymbol")],$S);const nAe=$S,sAe=["begin","end","begin-end"],Zae=["arrow","circle","square","diamond","cross","x"];var zN;let Wu=zN=class extends te{constructor(t){super(t),this.placement="begin-end",this.type="line-marker",this.style="arrow"}writeStyle(t,e,i,r){e[i]=(r==null?void 0:r.origin)==="web-map"?"arrow":t}set color(t){this._set("color",t)}readColor(t){return t&&t[0]!=null?[t[0],t[1],t[2],t[3]/255]:t}writeColor(t,e,i,r){(r==null?void 0:r.origin)==="web-map"||(e[i]=t)}clone(){return new zN({color:U(this.color),placement:this.placement,style:this.style})}hash(){var t;return`${this.placement}.${(t=this.color)==null?void 0:t.hash()}.${this.style}`}};d([p({type:["begin","end","begin-end"],json:{write:!0}})],Wu.prototype,"placement",void 0),d([xe({"line-marker":"line-marker"},{readOnly:!0}),p({json:{origins:{"web-map":{write:!1}}}})],Wu.prototype,"type",void 0),d([p({type:Zae})],Wu.prototype,"style",void 0),d([ge("style")],Wu.prototype,"writeStyle",null),d([p({type:ce,value:null,json:{write:{allowNull:!0}}})],Wu.prototype,"color",null),d([ae("color")],Wu.prototype,"readColor",null),d([ge("color")],Wu.prototype,"writeColor",null),Wu=zN=d([A("esri.symbols.LineSymbolMarker")],Wu);const oAe=Wu;var jN;const $3=new He({esriSLSSolid:"solid",esriSLSDash:"dash",esriSLSDot:"dot",esriSLSDashDot:"dash-dot",esriSLSDashDotDot:"long-dash-dot-dot",esriSLSNull:"none",esriSLSInsideFrame:"inside-frame",esriSLSShortDash:"short-dash",esriSLSShortDot:"short-dot",esriSLSShortDashDot:"short-dash-dot",esriSLSShortDashDotDot:"short-dash-dot-dot",esriSLSLongDash:"long-dash",esriSLSLongDashDot:"long-dash-dot"});let ph=jN=class extends nAe{constructor(...t){super(...t),this.type="simple-line",this.style="solid",this.cap="round",this.join="round",this.marker=null,this.miterLimit=2}normalizeCtorArgs(t,e,i,r,n,s){if(t&&typeof t!="string")return t;const o={};return t!=null&&(o.style=t),e!=null&&(o.color=e),i!=null&&(o.width=$t(i)),r!=null&&(o.cap=r),n!=null&&(o.join=n),s!=null&&(o.miterLimit=$t(s)),o}clone(){var t;return new jN({color:U(this.color),style:this.style,width:this.width,cap:this.cap,join:this.join,miterLimit:this.miterLimit,marker:(t=this.marker)==null?void 0:t.clone()})}hash(){var t,e;return`${super.hash()}.${(t=this.color)==null?void 0:t.hash()}.${this.style}.${this.cap}.${this.join}.${this.miterLimit}.${(e=this.marker)==null?void 0:e.hash()}`}};d([xe({esriSLS:"simple-line"},{readOnly:!0})],ph.prototype,"type",void 0),d([p({type:$3.apiValues,json:{read:$3.read,write:$3.write}})],ph.prototype,"style",void 0),d([p({type:["butt","round","square"],json:{write:{overridePolicy:(t,e,i)=>({enabled:t!=="round"&&(i==null||i.origin==null)})}}})],ph.prototype,"cap",void 0),d([p({type:["miter","round","bevel"],json:{write:{overridePolicy:(t,e,i)=>({enabled:t!=="round"&&(i==null||i.origin==null)})}}})],ph.prototype,"join",void 0),d([p({types:{key:"type",base:null,defaultKeyValue:"line-marker",typeMap:{"line-marker":oAe}},json:{write:!0,origins:{"web-scene":{write:!1}}}})],ph.prototype,"marker",void 0),d([p({type:Number,json:{read:!1,write:!1}})],ph.prototype,"miterLimit",void 0),ph=jN=d([A("esri.symbols.SimpleLineSymbol")],ph);const Yn=ph,aAe=Object.freeze(Object.defineProperty({__proto__:null,default:Yn},Symbol.toStringTag,{value:"Module"}));let AS=class extends Ma{constructor(e){super(e),this.outline=null,this.type=null}hash(){return`${this.type}.${this.outline&&this.outline.hash()}`}};d([p({types:{key:"type",base:null,defaultKeyValue:"simple-line",typeMap:{"simple-line":Yn}},json:{default:null,write:!0}})],AS.prototype,"outline",void 0),d([p({type:["simple-fill","picture-fill"],readOnly:!0})],AS.prototype,"type",void 0),AS=d([A("esri.symbols.FillSymbol")],AS);const Yae=AS;let G$=class extends te{constructor(e){super(e)}clone(){}};d([p({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],G$.prototype,"type",void 0),G$=d([A("esri.symbols.patterns.LinePattern3D")],G$);const Kae=G$,lAe=["dash","dash-dot","dot","long-dash","long-dash-dot","long-dash-dot-dot","none","short-dash","short-dash-dot","short-dash-dot-dot","short-dot","solid"];var BN;const cAe=ln()({dash:"dash","dash-dot":"dash-dot","dash-dot-dot":"long-dash-dot-dot",dot:"dot","long-dash":"long-dash","long-dash-dot":"long-dash-dot",null:"none","short-dash":"short-dash","short-dash-dot":"short-dash-dot","short-dash-dot-dot":"short-dash-dot-dot","short-dot":"short-dot",solid:"solid"});let kS=BN=class extends Kae{constructor(t){super(t),this.type="style",this.style="solid"}clone(){const t={style:this.style};return new BN(t)}};d([p({type:["style"]})],kS.prototype,"type",void 0),d([xe(cAe),p({type:lAe})],kS.prototype,"style",void 0),kS=BN=d([A("esri.symbols.patterns.LineStylePattern3D")],kS);const hU=kS;let H$=class extends te{constructor(e){super(e)}clone(){}};d([p({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],H$.prototype,"type",void 0),H$=d([A("esri.symbols.patterns.Pattern3D")],H$);const Xae=H$,uAe=["backward-diagonal","cross","diagonal-cross","forward-diagonal","horizontal","none","solid","vertical"];var UN;let PS=UN=class extends Xae{constructor(t){super(t),this.type="style",this.style="solid"}clone(){const t={style:this.style};return new UN(t)}};d([p({type:["style"]})],PS.prototype,"type",void 0),d([p({type:uAe,json:{read:!0,write:!0}})],PS.prototype,"style",void 0),PS=UN=d([A("esri.symbols.patterns.StylePattern3D")],PS);const Qae=PS,dAe={types:{key:"type",base:Xae,typeMap:{style:Qae}},json:{write:!0}},ele={types:{key:"type",base:Kae,typeMap:{style:hU}},json:{write:!0}},K2=new ce("white");new ce("black");const hAe=new ce([255,255,255,0]);function pAe(t){return t.r===0&&t.g===0&&t.b===0}var GN;let X2=GN=class extends sl{constructor(t){super(t),this.colorMixMode=null}clone(){const t={color:this.color!=null?this.color.clone():null,colorMixMode:this.colorMixMode};return new GN(t)}};d([xe({multiply:"multiply",replace:"replace",tint:"tint"})],X2.prototype,"colorMixMode",void 0),X2=GN=d([A("esri.symbols.support.Symbol3DFillMaterial")],X2);function cL(t=_Ae){return[t[0],t[1],t[2],t[3],t[4],t[5]]}function pU(t,e,i,r,n,s,o=cL()){return o[0]=t,o[1]=e,o[2]=i,o[3]=r,o[4]=n,o[5]=s,o}function c0t(t,e){const i=isFinite(t[2])||isFinite(t[5]);return new Re(i?{xmin:t[0],xmax:t[3],ymin:t[1],ymax:t[4],zmin:t[2],zmax:t[5],spatialReference:e}:{xmin:t[0],xmax:t[3],ymin:t[1],ymax:t[4],spatialReference:e})}function u0t(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.min(t[2],e[2]),t[3]=Math.max(t[3],e[3]),t[4]=Math.max(t[4],e[4]),t[5]=Math.max(t[5],e[5])}function d0t(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[3]=Math.max(t[3],e[2]),t[4]=Math.max(t[4],e[3])}function h0t(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.min(t[2],e[2]),t[3]=Math.max(t[3],e[0]),t[4]=Math.max(t[4],e[1]),t[5]=Math.max(t[5],e[2])}function p0t(t,e,i=0,r=e.length/3){let n=t[0],s=t[1],o=t[2],a=t[3],l=t[4],c=t[5];for(let u=0;u<r;u++)n=Math.min(n,e[i+3*u]),s=Math.min(s,e[i+3*u+1]),o=Math.min(o,e[i+3*u+2]),a=Math.max(a,e[i+3*u]),l=Math.max(l,e[i+3*u+1]),c=Math.max(c,e[i+3*u+2]);t[0]=n,t[1]=s,t[2]=o,t[3]=a,t[4]=l,t[5]=c}function A3(t,e,i){const r=e.length;let n=t[0],s=t[1],o=t[2],a=t[3],l=t[4],c=t[5];if(i)for(let u=0;u<r;u++){const h=e[u];n=Math.min(n,h[0]),s=Math.min(s,h[1]),o=Math.min(o,h[2]),a=Math.max(a,h[0]),l=Math.max(l,h[1]),c=Math.max(c,h[2])}else for(let u=0;u<r;u++){const h=e[u];n=Math.min(n,h[0]),s=Math.min(s,h[1]),a=Math.max(a,h[0]),l=Math.max(l,h[1])}t[0]=n,t[1]=s,t[2]=o,t[3]=a,t[4]=l,t[5]=c}function f0t(t){for(let e=0;e<6;e++)if(!isFinite(t[e]))return!1;return!0}function pC(t){return t[0]>=t[3]?0:t[3]-t[0]}function fC(t){return t[1]>=t[4]?0:t[4]-t[1]}function mC(t){return t[2]>=t[5]?0:t[5]-t[2]}function m0t(t){const e=pC(t),i=mC(t),r=fC(t);return Math.sqrt(e*e+i*i+r*r)}function g0t(t,e=[0,0,0]){return e[0]=t[0]+pC(t)/2,e[1]=t[1]+fC(t)/2,e[2]=t[2]+mC(t)/2,e}function y0t(t,e=[0,0,0]){return e[0]=pC(t),e[1]=fC(t),e[2]=mC(t),e}function v0t(t,e){return e[0]>=t[0]&&e[1]>=t[1]&&e[2]>=t[2]&&e[0]<=t[3]&&e[1]<=t[4]&&e[2]<=t[5]}function fAe(t,e){return Math.max(e[0],t[0])<=Math.min(e[3],t[3])&&Math.max(e[1],t[1])<=Math.min(e[4],t[4])&&Math.max(e[2],t[2])<=Math.min(e[5],t[5])}function _0t(t,e){return e==null||fAe(t,e)}function b0t(t,e,i,r,n=t){return n[0]=t[0]+e,n[1]=t[1]+i,n[2]=t[2]+r,n[3]=t[3]+e,n[4]=t[4]+i,n[5]=t[5]+r,n}function w0t(t,e,i=t){const r=t[0]+pC(t)/2,n=t[1]+fC(t)/2,s=t[2]+mC(t)/2;return i[0]=r+(t[0]-r)*e,i[1]=n+(t[1]-n)*e,i[2]=s+(t[2]-s)*e,i[3]=r+(t[3]-r)*e,i[4]=n+(t[4]-n)*e,i[5]=s+(t[5]-s)*e,i}function x0t(t,e){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function mAe(t,e,i=t){return i[0]=e[0],i[1]=e[1],i[2]=e[2],i!==t&&(i[3]=t[3],i[4]=t[4],i[5]=t[5]),i}function gAe(t,e,i=t){return i[3]=e[0],i[4]=e[1],i[5]=e[2],i!==t&&(i[0]=t[0],i[1]=t[1],i[2]=t[2]),t}function yAe(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function vAe(t){return t?yAe(t,Qq):cL(Qq)}function S0t(t,e){return e||(e=al()),e[0]=t[0],e[1]=t[1],e[2]=t[3],e[3]=t[4],e}function I0t(t,e){return t[0]=e[0],t[1]=e[1],t[2]=Number.NEGATIVE_INFINITY,t[3]=e[2],t[4]=e[3],t[5]=Number.POSITIVE_INFINITY,t}function T0t(t,e,i,r,n){return t[0]=e,t[1]=i,t[2]=Number.NEGATIVE_INFINITY,t[3]=r,t[4]=n,t[5]=Number.POSITIVE_INFINITY,t}function Xq(t){return t.length===6}function C0t(t){return pC(t)===0&&fC(t)===0&&mC(t)===0}function E0t(t,e,i){if(t==null||e==null)return t===e;if(!Xq(t)||!Xq(e))return!1;if(i){for(let r=0;r<t.length;r++)if(!i(t[r],e[r]))return!1}else for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}const Qq=[1/0,1/0,1/0,-1/0,-1/0,-1/0],_Ae=[0,0,0,0,0,0];cL();function M0t(t,{isPrimitive:e,width:i,depth:r,height:n}){const s=e?10:1;if(i==null&&n==null&&r==null)return[s*t[0],s*t[1],s*t[2]];const o=en(i,r,n);let a;for(let l=0;l<3;l++){const c=o[l];if(c!=null){a=c/t[l];break}}for(let l=0;l<3;l++)o[l]==null&&(o[l]=t[l]*a);return o}const bAe=pU(-.5,-.5,-.5,.5,.5,.5),wAe=pU(-.5,-.5,0,.5,.5,1),xAe=pU(-.5,-.5,0,.5,.5,.5);function $0t(t){switch(t){case"sphere":case"cube":case"diamond":return bAe;case"cylinder":case"cone":case"inverted-cone":return wAe;case"tetrahedron":return xAe;default:return}}const fU=["butt","square","round"],SAe=[...fU,"none"],tle=["miter","bevel","round"];var HN;let gy=HN=class extends te{constructor(t){super(t),this.color=new ce([0,0,0,1]),this.size=wa(1),this.pattern=null,this.patternCap="butt"}clone(){const t={color:this.color!=null?this.color.clone():null,size:this.size,pattern:this.pattern!=null?this.pattern.clone():null,patternCap:this.patternCap};return new HN(t)}};d([p(xg)],gy.prototype,"color",void 0),d([p(jd)],gy.prototype,"size",void 0),d([p(ele)],gy.prototype,"pattern",void 0),d([p({type:fU,json:{default:"butt",write:{overridePolicy(){return{enabled:this.pattern!=null}}}}})],gy.prototype,"patternCap",void 0),gy=HN=d([A("esri.symbols.support.Symbol3DOutline")],gy);var q$;let fh=q$=class extends Jd{constructor(t){super(t),this.type="fill",this.material=null,this.pattern=null,this.castShadows=!0,this.outline=null,this.edges=null}clone(){const t={edges:this.edges!=null?this.edges.clone():null,enabled:this.enabled,material:this.material!=null?this.material.clone():null,pattern:this.pattern!=null?this.pattern.clone():null,castShadows:this.castShadows,outline:this.outline!=null?this.outline.clone():null};return new q$(t)}static fromSimpleFillSymbol(t){var r,n,s;const e=t.outline&&t.outline.style&&t.outline.style!=="inside-frame"&&t.outline.style!=="solid"?new hU({style:t.outline.style}):null,i={size:((r=t.outline)==null?void 0:r.width)??0,color:(((n=t.outline)==null?void 0:n.color)??K2).clone(),pattern:e};return e&&((s=t.outline)!=null&&s.cap)&&(i.patternCap=t.outline.cap),new q$({material:new X2({color:(t.color??hAe).clone()}),pattern:t.style&&t.style!=="solid"?new Qae({style:t.style}):null,outline:i})}};d([xe({Fill:"fill"},{readOnly:!0})],fh.prototype,"type",void 0),d([p({type:X2,json:{write:!0}})],fh.prototype,"material",void 0),d([p(dAe)],fh.prototype,"pattern",void 0),d([p({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],fh.prototype,"castShadows",void 0),d([p({type:gy,json:{write:!0}})],fh.prototype,"outline",void 0),d([p(Wae)],fh.prototype,"edges",void 0),fh=q$=d([A("esri.symbols.FillSymbol3DLayer")],fh);const W1=fh,IAe=["none","underline","line-through"],TAe=["normal","italic","oblique"],CAe=["normal","lighter","bold","bolder"],ile={type:Number,cast:t=>{const e=ql(t);return e===0?1:Pn(e,.1,4)},nonNullable:!0},EAe=["left","right","center"],MAe=["baseline","top","middle","bottom"],rle={type:EAe,nonNullable:!0},nle={type:MAe,nonNullable:!0},A0t=8;var qN;let mh=qN=class extends te{constructor(t){super(t),this.decoration="none",this.family="sans-serif",this.size=9,this.style="normal",this.weight="normal"}castSize(t){return $t(t)}clone(){return new qN({decoration:this.decoration,family:this.family,size:this.size,style:this.style,weight:this.weight})}hash(){return`${this.decoration}.${this.family}.${this.size}.${this.style}.${this.weight}`}};d([p({type:IAe,json:{default:"none",write:!0}})],mh.prototype,"decoration",void 0),d([p({type:String,json:{write:!0}})],mh.prototype,"family",void 0),d([p({type:Number,json:{write:{overridePolicy:(t,e,i)=>({enabled:!i||!i.textSymbol3D})}}})],mh.prototype,"size",void 0),d([tt("size")],mh.prototype,"castSize",null),d([p({type:TAe,json:{default:"normal",write:!0}})],mh.prototype,"style",void 0),d([p({type:CAe,json:{default:"normal",write:!0}})],mh.prototype,"weight",void 0),mh=qN=d([A("esri.symbols.Font")],mh);const uL=mh;function og(t,e){const i=e&&e.url&&e.url.path;if(t&&i&&(t=Jl(t,i,{preserveProtocolRelative:!0}),e.portalItem&&e.readResourcePaths)){const r=rB(t,e.portalItem.itemUrl);r!=null&&$Ae.test(r)&&e.readResourcePaths.push(e.portalItem.resourceFromPath(r).path)}return WN(t,e&&e.portal)}function gC(t,e,i=eT.YES){if(t==null)return t;!il(t)&&e&&e.blockedRelativeUrls&&e.blockedRelativeUrls.push(t);let r=Jl(t);if(e){const n=e.verifyItemRelativeUrls&&e.verifyItemRelativeUrls.rootPath||e.url&&e.url.path;if(n){const s=WN(n,e.portal),o=WN(r,e.portal);r=rB(o,s,s),r!=null&&r!==o&&r!==t&&e.verifyItemRelativeUrls&&e.verifyItemRelativeUrls.writtenUrls.push(r)}}return r=ole(r,e==null?void 0:e.portal),il(r)&&(r=ic(r)),e!=null&&e.resources&&(e!=null&&e.portalItem)&&!il(r)&&!Bv(r)&&i===eT.YES&&e.resources.toKeep.push({resource:e.portalItem.resourceFromPath(r),compress:!1}),r}function mU(t,e,i){return og(t,i)}function Iv(t,e,i,r){const n=gC(t,r);n!==void 0&&(e[i]=n)}const sle=/\/items\/([^\/]+)\/resources\/(.*)/,$Ae=/^\.\/resources\//;function AAe(t){const e=(t==null?void 0:t.match(sle))??null;return(e==null?void 0:e[1])??null}function kAe(t){const e=(t==null?void 0:t.match(sle))??null;if(e==null)return null;const i=e[2],r=i.lastIndexOf("/");if(r===-1){const{path:o,extension:a}=GH(i);return{prefix:null,filename:o,extension:a}}const{path:n,extension:s}=GH(i.slice(r+1));return{prefix:i.slice(0,r),filename:n,extension:s}}function ole(t,e){return e&&!e.isPortal&&e.urlKey&&e.customBaseUrl?ND(t,`${e.urlKey}.${e.customBaseUrl}`,e.portalHostname):t}function WN(t,e){if(!e||e.isPortal||!e.urlKey||!e.customBaseUrl)return t;const i=`${e.urlKey}.${e.customBaseUrl}`,r=Q6();return Yw(r,`${r.scheme}://${i}`)?ND(t,e.portalHostname,i):ND(t,i,e.portalHostname)}var eT;(function(t){t[t.YES=0]="YES",t[t.NO=1]="NO"})(eT||(eT={}));const k0t=Object.freeze(Object.defineProperty({__proto__:null,get MarkKeep(){return eT},ensureMainOnlineDomain:ole,fromJSON:og,itemIdFromResourceUrl:AAe,prefixAndFilenameFromResourceUrl:kAe,read:mU,toJSON:gC,write:Iv},Symbol.toStringTag,{value:"Module"}));var JN;const PAe=ln()({circle:"circle",square:"square",cross:"cross",x:"x",kite:"kite",triangle:"triangle"});let yy=JN=class extends te{constructor(t){super(t)}readHref(t,e,i){return t?og(t,i):e.dataURI}writeHref(t,e,i,r){t&&(Bv(t)?e.dataURI=t:(e.href=gC(t,r),il(e.href)&&(e.href=ic(e.href))))}clone(){return new JN({href:this.href,primitive:this.primitive})}};d([p({type:String,json:{write:!0,read:{source:["href","dataURI"]}}})],yy.prototype,"href",void 0),d([ae("href")],yy.prototype,"readHref",null),d([ge("href",{href:{type:String},dataURI:{type:String}})],yy.prototype,"writeHref",null),d([xe(PAe)],yy.prototype,"primitive",void 0),yy=JN=d([A("esri.symbols.support.IconSymbol3DLayerResource")],yy);const OAe="circle";var ZN;let ow=ZN=class extends he{constructor(){super(...arguments),this.x=0,this.y=0}clone(){return new ZN({x:this.x,y:this.y})}};d([p({type:Number})],ow.prototype,"x",void 0),d([p({type:Number})],ow.prototype,"y",void 0),ow=ZN=d([A("esri.symbols.support.Symbol3DAnchorPosition2D")],ow);var YN;let OS=YN=class extends te{constructor(t){super(t),this.color=new ce([0,0,0,1]),this.size=wa(1)}clone(){const t={color:this.color!=null?this.color.clone():null,size:this.size};return new YN(t)}};d([p(xg)],OS.prototype,"color",void 0),d([p(jd)],OS.prototype,"size",void 0),OS=YN=d([A("esri.symbols.support.Symbol3DIconOutline")],OS);var eb;const ale="esri.symbols.IconSymbol3DLayer";let Ju=eb=class extends Jd{constructor(t){super(t),this.material=null,this.resource=null,this.type="icon",this.size=12,this.anchor="center",this.anchorPosition=null,this.outline=null}clone(){return new eb({anchor:this.anchor,anchorPosition:this.anchorPosition&&this.anchorPosition.clone(),enabled:this.enabled,material:this.material!=null?this.material.clone():null,outline:this.outline!=null?this.outline.clone():null,resource:this.resource&&this.resource.clone(),size:this.size})}static fromSimpleMarkerSymbol(t){const e=t.color||K2,i=eW(t),r=t.outline&&t.outline.width>0?{size:t.outline.width,color:(t.outline.color||K2).clone()}:null;return new eb({size:t.size,resource:{primitive:RAe(t.style)},material:{color:e},outline:r,anchor:i?"relative":void 0,anchorPosition:i})}static fromPictureMarkerSymbol(t){const e=!t.color||pAe(t.color)?K2:t.color,i=eW(t);return new eb({size:t.width<=t.height?t.height:t.width,resource:{href:t.url},material:{color:e.clone()},anchor:i?"relative":void 0,anchorPosition:i})}static fromCIMSymbol(t){return new eb({resource:{href:Bne({mediaType:"application/json",data:JSON.stringify(t.data)})}})}};function eW(t){const e="width"in t?t.width:t.size,i="height"in t?t.height:t.size,r=tW(t.xoffset),n=tW(t.yoffset);return(r||n)&&e&&i?{x:-r/e,y:n/i}:null}function tW(t){return isFinite(t)?t:0}d([p({type:sl,json:{write:!0}})],Ju.prototype,"material",void 0),d([p({type:yy,json:{write:!0}})],Ju.prototype,"resource",void 0),d([xe({Icon:"icon"},{readOnly:!0})],Ju.prototype,"type",void 0),d([p(jd)],Ju.prototype,"size",void 0),d([xe({center:"center",left:"left",right:"right",top:"top",bottom:"bottom",topLeft:"top-left",topRight:"top-right",bottomLeft:"bottom-left",bottomRight:"bottom-right",relative:"relative"}),p({json:{default:"center"}})],Ju.prototype,"anchor",void 0),d([p({type:ow,json:{type:[Number],read:{reader:t=>new ow({x:t[0],y:t[1]})},write:{writer:(t,e)=>{e.anchorPosition=[t.x,t.y]},overridePolicy(){return{enabled:this.anchor==="relative"}}}}})],Ju.prototype,"anchorPosition",void 0),d([p({type:OS,json:{write:!0}})],Ju.prototype,"outline",void 0),Ju=eb=d([A(ale)],Ju);const LAe={circle:"circle",cross:"cross",diamond:"kite",square:"square",x:"x",triangle:"triangle",path:null};function RAe(t){return LAe[t]||(ie.getLogger(ale).warn(`${t} cannot be mapped to Icon symbol. Fallback to "circle"`),"circle")}const B0=Ju;let vy=class extends Li(te){constructor(e){super(e),this.type="style",this.placement="begin-end",this.style="arrow",this.color=null}equals(e){return e!=null&&e.placement===this.placement&&e.style===this.style&&(this.color==null&&e.color==null||this.color!=null&&e.color!=null&&this.color.toJSON()===e.color.toJSON())}};d([p({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],vy.prototype,"type",void 0),d([p({type:sAe,json:{default:"begin-end",write:!0}})],vy.prototype,"placement",void 0),d([p({type:Zae,json:{default:"arrow",write:!0}})],vy.prototype,"style",void 0),d([p({type:ce,json:{type:[wt],default:null,write:!0}})],vy.prototype,"color",void 0),vy=d([A("esri.symbols.LineStyleMarker3D")],vy);const KN=vy;var W$;let Zu=W$=class extends Jd{constructor(t){super(t),this.material=null,this.type="line",this.join="miter",this.cap="butt",this.size=wa(1),this.pattern=null,this.marker=null}clone(){const t={enabled:this.enabled,material:this.material!=null?this.material.clone():null,size:this.size,join:this.join,cap:this.cap,pattern:this.pattern!=null?this.pattern.clone():null,marker:this.marker!=null?this.marker.clone():null};return new W$(t)}static fromSimpleLineSymbol(t){var i;const e={enabled:!0,size:t.width??wa(1),cap:t.cap||"butt",join:t.join||"miter",pattern:t.style&&t.style!=="inside-frame"?new hU({style:t.style}):null,material:new sl({color:(t.color||K2).clone()}),marker:t.marker?new KN({placement:t.marker.placement,style:t.marker.style,color:((i=t.marker.color)==null?void 0:i.clone())??null}):null};return new W$(e)}};d([p({type:sl,json:{write:!0}})],Zu.prototype,"material",void 0),d([xe({Line:"line"},{readOnly:!0})],Zu.prototype,"type",void 0),d([p({type:tle,json:{write:!0,default:"miter"}})],Zu.prototype,"join",void 0),d([p({type:fU,json:{write:!0,default:"butt"}})],Zu.prototype,"cap",void 0),d([p(jd)],Zu.prototype,"size",void 0),d([p(ele)],Zu.prototype,"pattern",void 0),d([p({types:{key:"type",base:KN,typeMap:{style:KN}},json:{write:!0}})],Zu.prototype,"marker",void 0),Zu=W$=d([A("esri.symbols.LineSymbol3DLayer")],Zu);const yC=Zu;var XN;const FAe=ln()({sphere:"sphere",cylinder:"cylinder",cube:"cube",cone:"cone",diamond:"diamond",tetrahedron:"tetrahedron",invertedCone:"inverted-cone"});let LS=XN=class extends te{clone(){return new XN({href:this.href,primitive:this.primitive})}};d([p({type:String,json:{read:mU,write:Iv}})],LS.prototype,"href",void 0),d([xe(FAe)],LS.prototype,"primitive",void 0),LS=XN=d([A("esri.symbols.support.ObjectSymbol3DLayerResource")],LS);const DAe="sphere";var QN;let T0=QN=class extends he{constructor(){super(...arguments),this.x=0,this.y=0,this.z=0}clone(){return new QN({x:this.x,y:this.y,z:this.z})}};d([p({type:Number})],T0.prototype,"x",void 0),d([p({type:Number})],T0.prototype,"y",void 0),d([p({type:Number})],T0.prototype,"z",void 0),T0=QN=d([A("esri.symbols.support.Symbol3DAnchorPosition3D")],T0);var e4;let Gs=e4=class extends Jd{constructor(t){super(t),this.material=null,this.castShadows=!0,this.resource=null,this.type="object",this.width=void 0,this.height=void 0,this.depth=void 0,this.anchor=void 0,this.anchorPosition=void 0,this.heading=void 0,this.tilt=void 0,this.roll=void 0}clone(){return new e4({heading:this.heading,tilt:this.tilt,roll:this.roll,anchor:this.anchor,anchorPosition:this.anchorPosition&&this.anchorPosition.clone(),depth:this.depth,enabled:this.enabled,height:this.height,material:this.material!=null?this.material.clone():null,castShadows:this.castShadows,resource:this.resource&&this.resource.clone(),width:this.width})}get isPrimitive(){return!this.resource||typeof this.resource.href!="string"}};d([p({type:sl,json:{write:!0}})],Gs.prototype,"material",void 0),d([p({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],Gs.prototype,"castShadows",void 0),d([p({type:LS,json:{write:!0}})],Gs.prototype,"resource",void 0),d([xe({Object:"object"},{readOnly:!0})],Gs.prototype,"type",void 0),d([p({type:Number,json:{write:!0}})],Gs.prototype,"width",void 0),d([p({type:Number,json:{write:!0}})],Gs.prototype,"height",void 0),d([p({type:Number,json:{write:!0}})],Gs.prototype,"depth",void 0),d([xe({center:"center",top:"top",bottom:"bottom",origin:"origin",relative:"relative"}),p({json:{default:"origin"}})],Gs.prototype,"anchor",void 0),d([p({type:T0,json:{type:[Number],read:{reader:t=>new T0({x:t[0],y:t[1],z:t[2]})},write:{writer:(t,e)=>{e.anchorPosition=[t.x,t.y,t.z]},overridePolicy(){return{enabled:this.anchor==="relative"}}}}})],Gs.prototype,"anchorPosition",void 0),d([p({type:Number,json:{write:!0}})],Gs.prototype,"heading",void 0),d([p({type:Number,json:{write:!0}})],Gs.prototype,"tilt",void 0),d([p({type:Number,json:{write:!0}})],Gs.prototype,"roll",void 0),d([p({readOnly:!0})],Gs.prototype,"isPrimitive",null),Gs=e4=d([A("esri.symbols.ObjectSymbol3DLayer")],Gs);const gU=Gs;var t4;let xo=t4=class extends Jd{constructor(t){super(t),this.material=null,this.castShadows=!0,this.type="path",this.profile="circle",this.join="miter",this.cap="butt",this.width=void 0,this.height=void 0,this.anchor="center",this.profileRotation="all"}readWidth(t,e){return t??(e.height==null&&e.size!=null?e.size:void 0)}readHeight(t,e){return t??(e.width==null&&e.size!=null?e.size:void 0)}clone(){return new t4({enabled:this.enabled,material:this.material!=null?this.material.clone():null,castShadows:this.castShadows,profile:this.profile,join:this.join,cap:this.cap,width:this.width,height:this.height,profileRotation:this.profileRotation,anchor:this.anchor})}};d([p({type:sl,json:{write:!0}})],xo.prototype,"material",void 0),d([p({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],xo.prototype,"castShadows",void 0),d([xe({Path:"path"},{readOnly:!0})],xo.prototype,"type",void 0),d([p({type:["circle","quad"],json:{write:!0,default:"circle"}})],xo.prototype,"profile",void 0),d([p({type:tle,json:{write:!0,default:"miter"}})],xo.prototype,"join",void 0),d([p({type:SAe,json:{write:!0,default:"butt"}})],xo.prototype,"cap",void 0),d([p({type:Number,json:{write:{enabled:!0,target:{width:{type:Number},size:{type:Number}}}}})],xo.prototype,"width",void 0),d([ae("width",["width","size","height"])],xo.prototype,"readWidth",null),d([p({type:Number,json:{write:!0}})],xo.prototype,"height",void 0),d([ae("height",["height","size","width"])],xo.prototype,"readHeight",null),d([p({type:["center","bottom","top"],json:{write:!0,default:"center"}})],xo.prototype,"anchor",void 0),d([p({type:["heading","all"],json:{write:!0,default:"all"}})],xo.prototype,"profileRotation",void 0),xo=t4=d([A("esri.symbols.PathSymbol3DLayer")],xo);const yU=xo;var i4;let aw=i4=class extends te{constructor(){super(...arguments),this.color=new ce([0,0,0,1]),this.size=0}clone(){const t={color:U(this.color),size:this.size};return new i4(t)}};d([p(xg)],aw.prototype,"color",void 0),d([p(jd)],aw.prototype,"size",void 0),aw=i4=d([A("esri.symbols.support.Symbol3DHalo")],aw);let Q2=class extends Li(te){constructor(e){super(e),this.color=null}};d([p(xg)],Q2.prototype,"color",void 0),Q2=d([A("esri.symbols.support.Symbol3DTextBackground")],Q2);var J$;let Qo=J$=class extends Jd{constructor(t){super(t),this._userSize=void 0,this.halo=null,this.horizontalAlignment="center",this.lineHeight=1,this.material=null,this.background=null,this.text=null,this.type="text",this.verticalAlignment="baseline"}get font(){return this._get("font")||null}set font(t){t!=null&&this._userSize!=null&&(t.size=this._userSize),this._set("font",t)}writeFont(t,e,i,r){const n={...r,textSymbol3D:!0};e.font=t.write({},n),delete e.font.size}get size(){return this._userSize!=null?this._userSize:this.font!=null&&this.font.size!=null?this.font.size:9}set size(t){this._userSize=t,this.font!=null&&(this.font.size=this._userSize),this.notifyChange("size")}clone(){const t=new J$({enabled:this.enabled,font:this.font&&U(this.font),halo:this.halo&&U(this.halo),horizontalAlignment:this.horizontalAlignment,lineHeight:this.lineHeight,material:this.material!=null?this.material.clone():null,text:this.text,verticalAlignment:this.verticalAlignment,background:U(this.background)});return t._userSize=this._userSize,t}static fromTextSymbol(t){return new J$({font:t.font!=null?t.font.clone():new uL,halo:NAe(t.haloColor,t.haloSize),horizontalAlignment:t.horizontalAlignment,lineHeight:t.lineHeight,material:t.color?new sl({color:t.color.clone()}):null,text:t.text,verticalAlignment:t.verticalAlignment,background:t.backgroundColor?new Q2({color:t.backgroundColor.clone()}):null})}};function NAe(t,e){return t&&e!=null&&e>0?new aw({color:U(t),size:e}):null}d([p({type:uL,json:{write:!0}})],Qo.prototype,"font",null),d([ge("font")],Qo.prototype,"writeFont",null),d([p({type:aw,json:{write:!0}})],Qo.prototype,"halo",void 0),d([p({...rle,json:{default:"center",write:!0}})],Qo.prototype,"horizontalAlignment",void 0),d([p({...ile,json:{default:1,write:!0}})],Qo.prototype,"lineHeight",void 0),d([p({type:sl,json:{write:!0}})],Qo.prototype,"material",void 0),d([p({type:Q2,json:{write:!0}})],Qo.prototype,"background",void 0),d([p(jd)],Qo.prototype,"size",null),d([p({type:String,json:{write:!0}})],Qo.prototype,"text",void 0),d([xe({Text:"text"},{readOnly:!0})],Qo.prototype,"type",void 0),d([p({...nle,json:{default:"baseline",write:!0}})],Qo.prototype,"verticalAlignment",void 0),Qo=J$=d([A("esri.symbols.TextSymbol3DLayer")],Qo);const J1=Qo;var r4;let gf=r4=class extends Jd{constructor(t){super(t),this.color=n4.clone(),this.type="water",this.waterbodySize="medium",this.waveDirection=null,this.waveStrength="moderate"}clone(){return new r4({color:U(this.color),waterbodySize:this.waterbodySize,waveDirection:this.waveDirection,waveStrength:this.waveStrength})}};d([p({type:ce,nonNullable:!0,json:{type:[wt],write:(t,e,i)=>e[i]=t.toArray(ce.AlphaMode.UNLESS_OPAQUE),default:()=>n4.clone(),defaultEquals:t=>t.toCss(!0)===n4.toCss(!0)}})],gf.prototype,"color",void 0),d([xe({Water:"water"},{readOnly:!0})],gf.prototype,"type",void 0),d([p({type:["small","medium","large"],json:{write:!0,default:"medium"}})],gf.prototype,"waterbodySize",void 0),d([p({type:Number,json:{write:!0,default:null}})],gf.prototype,"waveDirection",void 0),d([p({type:["calm","rippled","slight","moderate"],json:{write:!0,default:"moderate"}})],gf.prototype,"waveStrength",void 0),gf=r4=d([A("esri.symbols.WaterSymbol3DLayer")],gf);const n4=new ce([0,119,190]),lle=gf;var s4;let _y=s4=class extends he{constructor(t){super(t),this.name=null,this.styleUrl=null,this.styleName=null,this.portal=null}clone(){return new s4({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,portal:this.portal})}};d([p({type:String})],_y.prototype,"name",void 0),d([p({type:String})],_y.prototype,"styleUrl",void 0),d([p({type:String})],_y.prototype,"styleName",void 0),d([p({type:on})],_y.prototype,"portal",void 0),_y=s4=d([A("esri.symbols.support.StyleOrigin")],_y);const tT=_y;var o4;let iv=o4=class extends he{constructor(){super(...arguments),this.url=""}clone(){return new o4({url:this.url})}};d([p({type:String})],iv.prototype,"url",void 0),iv=o4=d([A("esri.symbols.support.Thumbnail")],iv);const cle={icon:B0,object:gU,line:yC,path:yU,fill:W1,extrude:Jae,text:J1,water:lle},VAe=ye.ofType({base:Jd,key:"type",typeMap:cle,errorContext:"symbol-layer"});let Yu=class extends Ma{constructor(e){super(e),this.styleOrigin=null,this.thumbnail=null,this.type=null;const i=this.__accessor__&&this.__accessor__.metadatas&&this.__accessor__.metadatas.symbolLayers,r=i&&i.type||ye;this._set("symbolLayers",new r)}get color(){return null}set color(e){this.constructed&&ie.getLogger(this).error("Symbol3D does not support colors on the symbol level. Colors may be set on individual symbol layer materials instead.")}set symbolLayers(e){rg(e,this._get("symbolLayers"))}readStyleOrigin(e,i,r){if(e.styleUrl&&e.name){const n=og(e.styleUrl,r);return new tT({styleUrl:n,name:e.name})}if(e.styleName&&e.name)return new tT({portal:r&&r.portal||on.getDefault(),styleName:e.styleName,name:e.name});r&&r.messages&&r.messages.push(new ol("symbol3d:incomplete-style-origin","Style origin requires either a 'styleUrl' or 'styleName' and a 'name' property",{context:r,definition:e}))}writeStyleOrigin(e,i,r,n){if(e.styleUrl&&e.name){let s=gC(e.styleUrl,n);il(s)&&(s=ic(s)),i.styleOrigin={styleUrl:s,name:e.name}}else e.styleName&&e.name&&(e.portal&&n&&n.portal&&!zne(e.portal.restUrl,n.portal.restUrl)?n&&n.messages&&n.messages.push(new ol("symbol:cross-portal","The symbol style origin cannot be persisted because it refers to an item on a different portal than the one being saved to.",{symbol:this})):i.styleOrigin={styleName:e.styleName,name:e.name})}normalizeCtorArgs(e){return e instanceof Jd||e&&cle[e.type]?{symbolLayers:[e]}:Array.isArray(e)?{symbolLayers:e}:e}};d([p({json:{read:!1,write:!1}})],Yu.prototype,"color",null),d([p({type:VAe,nonNullable:!0,json:{write:!0}}),tt(Mne)],Yu.prototype,"symbolLayers",null),d([p({type:tT})],Yu.prototype,"styleOrigin",void 0),d([ae("styleOrigin")],Yu.prototype,"readStyleOrigin",null),d([ge("styleOrigin",{"styleOrigin.styleUrl":{type:String},"styleOrigin.styleName":{type:String},"styleOrigin.name":{type:String}})],Yu.prototype,"writeStyleOrigin",null),d([p({type:iv,json:{read:!1}})],Yu.prototype,"thumbnail",void 0),d([p({type:["point-3d","line-3d","polygon-3d","mesh-3d","label-3d"],readOnly:!0})],Yu.prototype,"type",void 0),Yu=d([A("esri.symbols.Symbol3D")],Yu);const Z1=Yu;let RS=class extends te{constructor(e){super(e),this.visible=!0}clone(){}};d([p({type:["line"],readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0}}})],RS.prototype,"type",void 0),d([p({readOnly:!0})],RS.prototype,"visible",void 0),RS=d([A("esri.symbols.callouts.Callout3D")],RS);const ule=RS;var a4;let Z$=a4=class extends te{constructor(){super(...arguments),this.color=new ce("white")}clone(){return new a4({color:U(this.color)})}};d([p(xg)],Z$.prototype,"color",void 0),Z$=a4=d([A("esri.symbols.callouts.LineCallout3DBorder")],Z$);const dle=Z$;Object.freeze(Object.defineProperty({__proto__:null,default:dle},Symbol.toStringTag,{value:"Module"}));var l4;let yf=l4=class extends ule{constructor(t){super(t),this.type="line",this.color=new ce([0,0,0,1]),this.size=wa(1),this.border=null}get visible(){return this.size>0&&this.color!=null&&this.color.a>0}clone(){return new l4({color:U(this.color),size:this.size,border:U(this.border)})}};d([xe({line:"line"},{readOnly:!0})],yf.prototype,"type",void 0),d([p(xg)],yf.prototype,"color",void 0),d([p(jd)],yf.prototype,"size",void 0),d([p({type:dle,json:{write:!0}})],yf.prototype,"border",void 0),d([p({readOnly:!0})],yf.prototype,"visible",null),yf=l4=d([A("esri.symbols.callouts.LineCallout3D")],yf);const zAe=yf;function vU(t){if(!t)return!1;const e=t.verticalOffset;return!!e&&!(e.screenLength<=0||e.maxWorldLength!=null&&e.maxWorldLength<=0)}function hle(t){if(!t||!t.supportsCallout||!t.supportsCallout())return!1;const e=t.callout;return!!e&&!!e.visible&&!!vU(t)}function F0t(t){return t.type==="point-3d"||t.type==="label-3d"}function D0t(t){return t.horizontalAlignment==="center"}const ple={types:{key:"type",base:ule,typeMap:{line:zAe}},json:{write:!0}};var c4;let tb=c4=class extends te{constructor(t){super(t),this.screenLength=0,this.minWorldLength=0,this.maxWorldLength=null}clone(){return new c4({screenLength:this.screenLength,minWorldLength:this.minWorldLength,maxWorldLength:this.maxWorldLength})}};d([p(jd)],tb.prototype,"screenLength",void 0),d([p({type:Number,nonNullable:!0,json:{write:!0,default:0}})],tb.prototype,"minWorldLength",void 0),d([p({type:Number,json:{write:!0}})],tb.prototype,"maxWorldLength",void 0),tb=c4=d([A("esri.symbols.support.Symbol3DVerticalOffset")],tb);const fle=tb;var Y$;const mle=ye.ofType({base:null,key:"type",typeMap:{text:J1}});let vf=Y$=class extends Z1{constructor(t){super(t),this.verticalOffset=null,this.callout=null,this.styleOrigin=null,this.symbolLayers=new mle,this.type="label-3d"}supportsCallout(){return!0}hasVisibleCallout(){return hle(this)}hasVisibleVerticalOffset(){return vU(this)}clone(){return new Y$({styleOrigin:U(this.styleOrigin),symbolLayers:U(this.symbolLayers),thumbnail:U(this.thumbnail),callout:U(this.callout),verticalOffset:U(this.verticalOffset)})}static fromTextSymbol(t){return new Y$({symbolLayers:[J1.fromTextSymbol(t)]})}};d([p({type:fle,json:{write:!0}})],vf.prototype,"verticalOffset",void 0),d([p(ple)],vf.prototype,"callout",void 0),d([p({json:{read:!1,write:!1}})],vf.prototype,"styleOrigin",void 0),d([p({type:mle})],vf.prototype,"symbolLayers",void 0),d([xe({LabelSymbol3D:"label-3d"},{readOnly:!0})],vf.prototype,"type",void 0),vf=Y$=d([A("esri.symbols.LabelSymbol3D")],vf);const dL=vf;var K$;const gle=ye.ofType({base:null,key:"type",typeMap:{line:yC,path:yU}}),jAe=ye.ofType({base:null,key:"type",typeMap:{line:yC,path:yU}});let FS=K$=class extends Z1{constructor(t){super(t),this.symbolLayers=new gle,this.type="line-3d"}clone(){return new K$({styleOrigin:U(this.styleOrigin),symbolLayers:U(this.symbolLayers),thumbnail:U(this.thumbnail)})}static fromSimpleLineSymbol(t){return new K$({symbolLayers:[yC.fromSimpleLineSymbol(t)]})}};d([p({type:gle,json:{type:jAe}})],FS.prototype,"symbolLayers",void 0),d([xe({LineSymbol3D:"line-3d"},{readOnly:!0})],FS.prototype,"type",void 0),FS=K$=d([A("esri.symbols.LineSymbol3D")],FS);const hL=FS;let _f=class extends Ma{constructor(e){super(e),this.angle=0,this.type=null,this.xoffset=0,this.yoffset=0,this.size=9}hash(){return`${this.type}.${this.angle}.${this.size}.${this.xoffset}.${this.yoffset}`}};d([p({type:Number,json:{read:t=>t&&-1*t,write:(t,e)=>e.angle=t&&-1*t}})],_f.prototype,"angle",void 0),d([p({type:["simple-marker","picture-marker"],readOnly:!0})],_f.prototype,"type",void 0),d([p({type:Number,cast:$t,json:{write:!0}})],_f.prototype,"xoffset",void 0),d([p({type:Number,cast:$t,json:{write:!0}})],_f.prototype,"yoffset",void 0),d([p({type:Number,cast:t=>t==="auto"?t:$t(t),json:{write:!0}})],_f.prototype,"size",void 0),_f=d([A("esri.symbols.MarkerSymbol")],_f);const yle=_f;var X$;const vle=ye.ofType({base:null,key:"type",typeMap:{fill:W1}});let DS=X$=class extends Z1{constructor(t){super(t),this.symbolLayers=new vle,this.type="mesh-3d"}clone(){return new X$({styleOrigin:U(this.styleOrigin),symbolLayers:U(this.symbolLayers),thumbnail:U(this.thumbnail)})}static fromSimpleFillSymbol(t){return new X$({symbolLayers:[W1.fromSimpleFillSymbol(t)]})}};d([p({type:vle})],DS.prototype,"symbolLayers",void 0),d([xe({MeshSymbol3D:"mesh-3d"},{readOnly:!0})],DS.prototype,"type",void 0),DS=X$=d([A("esri.symbols.MeshSymbol3D")],DS);const vC=DS;function BAe(t,e,i){return e.imageData?Bne({mediaType:e.contentType||"image/png",isBase64:!0,data:e.imageData}):_le(e.url,i)}function _le(t,e){var i;return GAe(e)&&!il(t)&&((i=e==null?void 0:e.layer)!=null&&i.parsedUrl)?Kw(e.layer.parsedUrl.path,"images",t):og(t,e)}function UAe(t,e,i,r){if(Bv(t)){const n=BI(t);if(!n)return;e.contentType=n.mediaType,e.imageData=n.data,i&&i.imageData===e.imageData&&i.url&&Iv(i.url,e,"url",r)}else Iv(t,e,"url",r)}const ble={json:{read:{source:["imageData","url"],reader:BAe},write:{writer(t,e,i,r){UAe(t,e,this.source,r)}}}},wle={readOnly:!0,json:{read:{source:["imageData","url"],reader(t,e,i){const r={};return e.imageData&&(r.imageData=e.imageData),e.contentType&&(r.contentType=e.contentType),e.url&&(r.url=_le(e.url,i)),r}}}};function GAe(t){var e,i;return!(t==null||t.origin!=="service"&&t.origin!=="portal-item"||((e=t.layer)==null?void 0:e.type)!=="feature"&&((i=t.layer)==null?void 0:i.type)!=="stream")}var u4;let Cl=u4=class extends Yae{constructor(...t){super(...t),this.type="picture-fill",this.url=null,this.xscale=1,this.yscale=1,this.width=12,this.height=12,this.xoffset=0,this.yoffset=0,this.source=null}normalizeCtorArgs(t,e,i,r){if(t&&typeof t!="string"&&t.imageData==null)return t;const n={};return t&&(n.url=t),e&&(n.outline=e),i!=null&&(n.width=$t(i)),r!=null&&(n.height=$t(r)),n}clone(){const t=new u4({color:U(this.color),height:this.height,outline:this.outline&&this.outline.clone(),url:this.url,width:this.width,xoffset:this.xoffset,xscale:this.xscale,yoffset:this.yoffset,yscale:this.yscale});return t._set("source",U(this.source)),t}hash(){var t;return`${super.hash()}.${(t=this.color)==null?void 0:t.hash()}.${this.height}.${this.url}.${this.width}.${this.xoffset}.${this.xscale}.${this.yoffset}.${this.yscale}`}};d([xe({esriPFS:"picture-fill"},{readOnly:!0})],Cl.prototype,"type",void 0),d([p(ble)],Cl.prototype,"url",void 0),d([p({type:Number,json:{write:!0}})],Cl.prototype,"xscale",void 0),d([p({type:Number,json:{write:!0}})],Cl.prototype,"yscale",void 0),d([p({type:Number,cast:$t,json:{write:!0}})],Cl.prototype,"width",void 0),d([p({type:Number,cast:$t,json:{write:!0}})],Cl.prototype,"height",void 0),d([p({type:Number,cast:$t,json:{write:!0}})],Cl.prototype,"xoffset",void 0),d([p({type:Number,cast:$t,json:{write:!0}})],Cl.prototype,"yoffset",void 0),d([p(wle)],Cl.prototype,"source",void 0),Cl=u4=d([A("esri.symbols.PictureFillSymbol")],Cl);const xle=Cl;var d4;let Pc=d4=class extends yle{constructor(...t){super(...t),this.color=null,this.type="picture-marker",this.url=null,this.source=null,this.height=12,this.width=12,this.size=null}normalizeCtorArgs(t,e,i){if(t&&typeof t!="string"&&t.imageData==null)return t;const r={};return t&&(r.url=t),e!=null&&(r.width=$t(e)),i!=null&&(r.height=$t(i)),r}readHeight(t,e){return e.size||t}readWidth(t,e){return e.size||t}clone(){const t=new d4({angle:this.angle,height:this.height,url:this.url,width:this.width,xoffset:this.xoffset,yoffset:this.yoffset});return t._set("source",U(this.source)),t}hash(){return`${super.hash()}.${this.height}.${this.url}.${this.width}`}};d([p({json:{write:!1}})],Pc.prototype,"color",void 0),d([xe({esriPMS:"picture-marker"},{readOnly:!0})],Pc.prototype,"type",void 0),d([p(ble)],Pc.prototype,"url",void 0),d([p(wle)],Pc.prototype,"source",void 0),d([p({type:Number,cast:$t,json:{write:!0}})],Pc.prototype,"height",void 0),d([ae("height",["height","size"])],Pc.prototype,"readHeight",null),d([p({type:Number,cast:$t,json:{write:!0}})],Pc.prototype,"width",void 0),d([p({json:{write:!1}})],Pc.prototype,"size",void 0),Pc=d4=d([A("esri.symbols.PictureMarkerSymbol")],Pc);const Ym=Pc;var by;const Sle=ye.ofType({base:null,key:"type",typeMap:{icon:B0,object:gU,text:J1}});let wy=by=class extends Z1{constructor(t){super(t),this.verticalOffset=null,this.callout=null,this.symbolLayers=new Sle,this.type="point-3d"}supportsCallout(){if((this.symbolLayers?this.symbolLayers.length:0)<1)return!1;for(const t of this.symbolLayers.items)switch(t.type){case"icon":case"text":case"object":continue;default:return!1}return!0}hasVisibleCallout(){return hle(this)}hasVisibleVerticalOffset(){return vU(this)}clone(){return new by({verticalOffset:U(this.verticalOffset),callout:U(this.callout),styleOrigin:U(this.styleOrigin),symbolLayers:U(this.symbolLayers),thumbnail:U(this.thumbnail)})}static fromSimpleMarkerSymbol(t){return new by({symbolLayers:[B0.fromSimpleMarkerSymbol(t)]})}static fromPictureMarkerSymbol(t){return new by({symbolLayers:[B0.fromPictureMarkerSymbol(t)]})}static fromCIMSymbol(t){var r,n;if(((n=(r=t.data)==null?void 0:r.symbol)==null?void 0:n.type)!=="CIMPointSymbol")return null;const i=t.data.symbol;return new by(i!=null&&i.callout?{symbolLayers:[B0.fromCIMSymbol(t)],callout:{type:"line",size:.5,color:[0,0,0]},verticalOffset:{screenLength:40}}:{symbolLayers:[B0.fromCIMSymbol(t)]})}static fromTextSymbol(t){return new by({symbolLayers:[J1.fromTextSymbol(t)]})}};d([p({type:fle,json:{write:!0}})],wy.prototype,"verticalOffset",void 0),d([p(ple)],wy.prototype,"callout",void 0),d([p({type:Sle,json:{origins:{"web-scene":{write:!0}}}})],wy.prototype,"symbolLayers",void 0),d([xe({PointSymbol3D:"point-3d"},{readOnly:!0})],wy.prototype,"type",void 0),wy=by=d([A("esri.symbols.PointSymbol3D")],wy);const U0=wy;var NS;const Ile=ye.ofType({base:null,key:"type",typeMap:{extrude:Jae,fill:W1,icon:B0,line:yC,object:gU,text:J1,water:lle}});let VS=NS=class extends Z1{constructor(t){super(t),this.symbolLayers=new Ile,this.type="polygon-3d"}clone(){return new NS({styleOrigin:U(this.styleOrigin),symbolLayers:U(this.symbolLayers),thumbnail:U(this.thumbnail)})}static fromJSON(t){const e=new NS;if(e.read(t),e.symbolLayers.length===2&&e.symbolLayers.at(0).type==="fill"&&e.symbolLayers.at(1).type==="line"){const i=e.symbolLayers.at(0),r=e.symbolLayers.at(1);!r.enabled||t.symbolLayers&&t.symbolLayers[1]&&t.symbolLayers[1].enable===!1||(i.outline={size:r.size,color:r.material!=null?r.material.color:null}),e.symbolLayers.removeAt(1)}return e}static fromSimpleFillSymbol(t){return new NS({symbolLayers:[W1.fromSimpleFillSymbol(t)]})}};d([p({type:Ile,json:{write:!0}})],VS.prototype,"symbolLayers",void 0),d([xe({PolygonSymbol3D:"polygon-3d"},{readOnly:!0})],VS.prototype,"type",void 0),VS=NS=d([A("esri.symbols.PolygonSymbol3D")],VS);const _C=VS;var h4;const k3=new He({esriSFSSolid:"solid",esriSFSNull:"none",esriSFSHorizontal:"horizontal",esriSFSVertical:"vertical",esriSFSForwardDiagonal:"forward-diagonal",esriSFSBackwardDiagonal:"backward-diagonal",esriSFSCross:"cross",esriSFSDiagonalCross:"diagonal-cross"});let xy=h4=class extends Yae{constructor(...t){super(...t),this.color=new ce([0,0,0,.25]),this.outline=new Yn,this.type="simple-fill",this.style="solid"}normalizeCtorArgs(t,e,i){if(t&&typeof t!="string")return t;const r={};return t&&(r.style=t),e&&(r.outline=e),i&&(r.color=i),r}clone(){return new h4({color:U(this.color),outline:this.outline&&this.outline.clone(),style:this.style})}hash(){return`${super.hash()}${this.style}.${this.color&&this.color.hash()}`}};d([p()],xy.prototype,"color",void 0),d([p()],xy.prototype,"outline",void 0),d([xe({esriSFS:"simple-fill"},{readOnly:!0})],xy.prototype,"type",void 0),d([p({type:k3.apiValues,json:{read:k3.read,write:k3.write}})],xy.prototype,"style",void 0),xy=h4=d([A("esri.symbols.SimpleFillSymbol")],xy);const hc=xy,HAe=Object.freeze(Object.defineProperty({__proto__:null,default:hc},Symbol.toStringTag,{value:"Module"}));var p4;const P3=new He({esriSMSCircle:"circle",esriSMSSquare:"square",esriSMSCross:"cross",esriSMSX:"x",esriSMSDiamond:"diamond",esriSMSTriangle:"triangle",esriSMSPath:"path"});let Ku=p4=class extends yle{constructor(...t){super(...t),this.color=new ce([255,255,255,.25]),this.type="simple-marker",this.size=12,this.style="circle",this.outline=new Yn}normalizeCtorArgs(t,e,i,r){if(t&&typeof t!="string")return t;const n={};return t&&(n.style=t),e!=null&&(n.size=$t(e)),i&&(n.outline=i),r&&(n.color=r),n}writeColor(t,e){t&&this.style!=="x"&&this.style!=="cross"&&(e.color=t.toJSON()),t===null&&(e.color=null)}set path(t){this.style="path",this._set("path",t)}clone(){return new p4({angle:this.angle,color:U(this.color),outline:this.outline&&this.outline.clone(),path:this.path,size:this.size,style:this.style,xoffset:this.xoffset,yoffset:this.yoffset})}hash(){var t;return`${super.hash()}.${this.color&&this.color.hash()}.${this.path}.${this.style}.${(t=this.outline)==null?void 0:t.hash()}`}};d([p()],Ku.prototype,"color",void 0),d([ge("color")],Ku.prototype,"writeColor",null),d([xe({esriSMS:"simple-marker"},{readOnly:!0})],Ku.prototype,"type",void 0),d([p()],Ku.prototype,"size",void 0),d([p({type:P3.apiValues,json:{read:P3.read,write:P3.write}})],Ku.prototype,"style",void 0),d([p({type:String,json:{write:!0}})],Ku.prototype,"path",null),d([p({types:{key:"type",base:null,defaultKeyValue:"simple-line",typeMap:{"simple-line":Yn}},json:{default:null,write:!0}})],Ku.prototype,"outline",void 0),Ku=p4=d([A("esri.symbols.SimpleMarkerSymbol")],Ku);const ms=Ku,qAe=Object.freeze(Object.defineProperty({__proto__:null,default:ms},Symbol.toStringTag,{value:"Module"}));var f4;let ir=f4=class extends Ma{constructor(...t){super(...t),this.backgroundColor=null,this.borderLineColor=null,this.borderLineSize=null,this.font=new uL,this.horizontalAlignment="center",this.kerning=!0,this.haloColor=null,this.haloSize=null,this.rightToLeft=null,this.rotated=!1,this.text="",this.type="text",this.verticalAlignment="baseline",this.xoffset=0,this.yoffset=0,this.angle=0,this.width=null,this.lineWidth=192,this.lineHeight=1}normalizeCtorArgs(t,e,i){if(t&&typeof t!="string")return t;const r={};return t&&(r.text=t),e&&(r.font=e),i&&(r.color=i),r}writeLineWidth(t,e,i,r){r&&typeof r!="string"?r.origin:e[i]=t}castLineWidth(t){return $t(t)}writeLineHeight(t,e,i,r){r&&typeof r!="string"?r.origin:e[i]=t}clone(){return new f4({angle:this.angle,backgroundColor:U(this.backgroundColor),borderLineColor:U(this.borderLineColor),borderLineSize:this.borderLineSize,color:U(this.color),font:this.font&&this.font.clone(),haloColor:U(this.haloColor),haloSize:this.haloSize,horizontalAlignment:this.horizontalAlignment,kerning:this.kerning,lineHeight:this.lineHeight,lineWidth:this.lineWidth,rightToLeft:this.rightToLeft,rotated:this.rotated,text:this.text,verticalAlignment:this.verticalAlignment,width:this.width,xoffset:this.xoffset,yoffset:this.yoffset})}hash(){var t;return`${this.backgroundColor&&this.backgroundColor.hash()}.${this.borderLineColor}.${this.borderLineSize}.${(t=this.color)==null?void 0:t.hash()}.${this.font&&this.font.hash()}.${this.haloColor&&this.haloColor.hash()}.${this.haloSize}.${this.horizontalAlignment}.${this.kerning}.${this.rightToLeft}.${this.rotated}.${this.text}.${this.verticalAlignment}.${this.width}.${this.xoffset}.${this.yoffset}.${this.lineHeight}.${this.lineWidth}.${this.angle}`}};d([p({type:ce,json:{write:!0}})],ir.prototype,"backgroundColor",void 0),d([p({type:ce,json:{write:!0}})],ir.prototype,"borderLineColor",void 0),d([p({type:Number,json:{write:!0},cast:$t})],ir.prototype,"borderLineSize",void 0),d([p({type:uL,json:{write:!0}})],ir.prototype,"font",void 0),d([p({...rle,json:{write:!0}})],ir.prototype,"horizontalAlignment",void 0),d([p({type:Boolean,json:{write:!0}})],ir.prototype,"kerning",void 0),d([p({type:ce,json:{write:!0}})],ir.prototype,"haloColor",void 0),d([p({type:Number,cast:$t,json:{write:!0}})],ir.prototype,"haloSize",void 0),d([p({type:Boolean,json:{write:!0}})],ir.prototype,"rightToLeft",void 0),d([p({type:Boolean,json:{write:!0}})],ir.prototype,"rotated",void 0),d([p({type:String,json:{write:!0}})],ir.prototype,"text",void 0),d([xe({esriTS:"text"},{readOnly:!0})],ir.prototype,"type",void 0),d([p({...nle,json:{write:!0}})],ir.prototype,"verticalAlignment",void 0),d([p({type:Number,cast:$t,json:{write:!0}})],ir.prototype,"xoffset",void 0),d([p({type:Number,cast:$t,json:{write:!0}})],ir.prototype,"yoffset",void 0),d([p({type:Number,json:{read:t=>t&&-1*t,write:(t,e)=>e.angle=t&&-1*t}})],ir.prototype,"angle",void 0),d([p({type:Number,json:{write:!0}})],ir.prototype,"width",void 0),d([p({type:Number})],ir.prototype,"lineWidth",void 0),d([ge("lineWidth")],ir.prototype,"writeLineWidth",null),d([tt("lineWidth")],ir.prototype,"castLineWidth",null),d([p(ile)],ir.prototype,"lineHeight",void 0),d([ge("lineHeight")],ir.prototype,"writeLineHeight",null),ir=f4=d([A("esri.symbols.TextSymbol")],ir);const Gv=ir;var m4;let Oc=m4=class extends Ma{constructor(t){super(t),this.styleName=null,this.portal=null,this.styleUrl=null,this.thumbnail=null,this.name=null,this.type="web-style"}get _fetchCacheKey(){const t=this.portal!=null?this.portal:on.getDefault(),e=t.user?t.user.username:null;return`${this.styleName}:${this.styleUrl}:${this.name}:${e}:${t.url}`}read(t,e){this.portal=e==null?void 0:e.portal,super.read(t,e)}clone(){return new m4({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,portal:this.portal})}fetchSymbol(t){return this._fetchSymbol("webRef",t)}fetchCIMSymbol(t){return this._fetchSymbol("cimRef",t)}async _fetchSymbol(t,e){const i=e!=null?e.cache:null,r=i?this._fetchCacheKey:null;if(i!=null){const a=r&&i.get(r);if(a)return a.clone()}const{resolveWebStyleSymbol:n}=await W(()=>Promise.resolve().then(()=>wKe),void 0,import.meta.url);_t(e);const s=n(this,{portal:this.portal},t,e);s.catch(a=>{ie.getLogger(this).error("#fetchSymbol()","Failed to create symbol from style",a)});const o=await s;return t==="webRef"&&o.type==="point-3d"||t==="cimRef"&&o.type==="cim"?(i!=null&&i.set(r,o.clone()),o):null}};d([p({json:{write:!1}})],Oc.prototype,"color",void 0),d([p({type:String,json:{write:!0}})],Oc.prototype,"styleName",void 0),d([p({type:on,json:{write:!1}})],Oc.prototype,"portal",void 0),d([p({type:String,json:{read:mU,write:Iv}})],Oc.prototype,"styleUrl",void 0),d([p({type:iv,json:{read:!1}})],Oc.prototype,"thumbnail",void 0),d([p({type:String,json:{write:!0}})],Oc.prototype,"name",void 0),d([xe({styleSymbolReference:"web-style"},{readOnly:!0})],Oc.prototype,"type",void 0),d([p()],Oc.prototype,"_fetchCacheKey",null),Oc=m4=d([A("esri.symbols.WebStyleSymbol")],Oc);const Hv=Oc;function pL(t){if(!t)return!1;switch(t.type){case"picture-fill":case"picture-marker":case"simple-fill":case"simple-line":case"simple-marker":case"text":case"cim":return!0;default:return!1}}function Bd(t){if(!t)return!1;switch(t.type){case"label-3d":case"line-3d":case"mesh-3d":case"point-3d":case"polygon-3d":return!0;default:return!1}}const uu={base:Ma,key:"type",typeMap:{"simple-fill":hc,"picture-fill":xle,"picture-marker":Ym,"simple-line":Yn,"simple-marker":ms,text:Gv,"label-3d":dL,"line-3d":hL,"mesh-3d":vC,"point-3d":U0,"polygon-3d":_C,"web-style":Hv,cim:q1},errorContext:"symbol"},WAe={base:Ma,key:"type",typeMap:{"picture-marker":Ym,"simple-marker":ms,text:Gv,"web-style":Hv,cim:q1},errorContext:"symbol"},JAe=L1({types:uu}),Tle={base:Ma,key:"type",typeMap:{"simple-fill":hc,"picture-fill":xle,"picture-marker":Ym,"simple-line":Yn,"simple-marker":ms,text:Gv,"line-3d":hL,"mesh-3d":vC,"point-3d":U0,"polygon-3d":_C,"web-style":Hv,cim:q1},errorContext:"symbol"},ZAe={base:Ma,key:"type",typeMap:{text:Gv,"label-3d":dL},errorContext:"symbol"},iW={base:Ma,key:"type",typeMap:{"line-3d":hL,"mesh-3d":vC,"point-3d":U0,"polygon-3d":_C,"web-style":Hv,cim:q1},errorContext:"symbol"},YAe={base:Ma,key:"type",typeMap:{"label-3d":dL},errorContext:"symbol"},Cle=Dd(uu);var g4;function KAe(t){if(!t)return null;const e={};for(const i in t){const r=Vd(t[i]);r&&(e[i]=r)}return Object.keys(e).length!==0?e:null}function XAe(t){if(t==null)return null;const e={};for(const i in t){const r=t[i];r&&(e[i]=r.toJSON())}return Object.keys(e).length!==0?e:null}let ea=g4=class extends Li(te){constructor(...t){super(...t),this.isAggregate=!1,this.layer=null,this.popupTemplate=null,this.sourceLayer=null,Object.defineProperty(this,"uid",{value:X0(),configurable:!0})}normalizeCtorArgs(t,e,i,r){return t&&!t.declaredClass?t:{geometry:t,symbol:e,attributes:i,popupTemplate:r}}set aggregateGeometries(t){const e=this._get("aggregateGeometries");JSON.stringify(e)!==JSON.stringify(t)&&this._set("aggregateGeometries",t)}set attributes(t){const e=this._get("attributes");e!==t&&(this._set("attributes",t),this._notifyLayer("attributes",e,t))}set geometry(t){const e=this._get("geometry");e!==t&&(this._set("geometry",t),this._notifyLayer("geometry",e,t))}set symbol(t){const e=this._get("symbol");e!==t&&(this._set("symbol",t),this._notifyLayer("symbol",e,t))}set visible(t){const e=this._get("visible");e!==t&&(this._set("visible",t),this._notifyLayer("visible",e,t))}cloneShallow(){return new g4({aggregateGeometries:this.aggregateGeometries,attributes:this.attributes,geometry:this.geometry,isAggregate:this.isAggregate,layer:this.layer,popupTemplate:this.popupTemplate,sourceLayer:this.sourceLayer,symbol:this.symbol,visible:this.visible})}getEffectivePopupTemplate(t=!1){if(this.popupTemplate)return this.popupTemplate;for(const e of[this.sourceLayer,this.layer])if(e){if("popupTemplate"in e&&e.popupTemplate)return e.popupTemplate;if(t&&"defaultPopupTemplate"in e&&e.defaultPopupTemplate!=null)return e.defaultPopupTemplate}return null}getAttribute(t){var e;return(e=this.attributes)==null?void 0:e[t]}setAttribute(t,e){if(this.attributes){const i=this.getAttribute(t);this.attributes[t]=e,this._notifyLayer("attributes",i,e,t)}else this.attributes={[t]:e},this._notifyLayer("attributes",void 0,e,t)}getObjectId(){return this.sourceLayer&&"objectIdField"in this.sourceLayer&&this.sourceLayer.objectIdField?this.getAttribute(this.sourceLayer.objectIdField):null}toJSON(){return{aggregateGeometries:XAe(this.aggregateGeometries),geometry:this.geometry!=null?this.geometry.toJSON():null,symbol:this.symbol!=null?this.symbol.toJSON():null,attributes:{...this.attributes},popupTemplate:this.popupTemplate&&this.popupTemplate.toJSON()}}notifyGeometryChanged(){this._notifyLayer("geometry",this.geometry,this.geometry)}notifyMeshTransformChanged(t={}){const{geometry:e}=this;if((e==null?void 0:e.type)==="mesh"){const i={origin:e.origin,transform:e.transform};this._notifyLayer("origin-transform",i,i,t.action)}}_notifyLayer(t,e,i,r){if(!this.layer||!("graphicChanged"in this.layer))return;const n={graphic:this,property:t,oldValue:e,newValue:i};t==="origin-transform"&&(n.action=r),t==="attributes"&&(n.attributeName=r),this.layer.graphicChanged(n)}};d([p({value:null,json:{read:KAe}})],ea.prototype,"aggregateGeometries",null),d([p({value:null})],ea.prototype,"attributes",null),d([p({value:null,types:_g,json:{read:Vd}})],ea.prototype,"geometry",null),d([p({type:Boolean})],ea.prototype,"isAggregate",void 0),d([p({clonable:"reference"})],ea.prototype,"layer",void 0),d([p({type:Mp})],ea.prototype,"popupTemplate",void 0),d([p({clonable:"reference"})],ea.prototype,"sourceLayer",void 0),d([p({value:null,types:uu})],ea.prototype,"symbol",null),d([p({type:Boolean,value:!0})],ea.prototype,"visible",null),ea=g4=d([A("esri.Graphic")],ea),function(t){t.generateUID=X0}(ea||(ea={}));const Or=ea;let _U=class{constructor(e,i){this.min=e,this.max=i,this.range=i-e}ndiff(e,i=0){return Math.ceil((e-i)/this.range)*this.range+i}_normalize(e,i,r,n=0,s=!1){return(r-=n)<e?r+=this.ndiff(e-r):r>i&&(r-=this.ndiff(r-i)),s&&r===i&&(r=e),r+n}normalize(e,i=0,r=!1){return this._normalize(this.min,this.max,e,i,r)}clamp(e,i=0){return Pn(e-i,this.min,this.max)+i}monotonic(e,i,r){return e<i?i:i+this.ndiff(e-i,r)}minimalMonotonic(e,i,r){return this._normalize(e,e+this.range,i,r)}center(e,i,r){return i=this.monotonic(e,i,r),this.normalize((e+i)/2,r)}diff(e,i,r){return this.monotonic(e,i,r)-e}shortestSignedDiff(e,i){e=this.normalize(e);const r=(i=this.normalize(i))-e,n=i<e?this.minimalMonotonic(e,i)-e:i-this.minimalMonotonic(i,e);return Math.abs(r)<Math.abs(n)?r:n}contains(e,i,r){return i=this.minimalMonotonic(e,i),(r=this.minimalMonotonic(e,r))>e&&r<i}};function bU(t){for(const e in t){const i=t[e];i instanceof Function&&(t[e]=i.bind(t))}return t}bU(new _U(0,2*Math.PI));const z0t=bU(new _U(-Math.PI,Math.PI)),Ele=bU(new _U(0,360));let gh=class extends Li(te){constructor(...e){super(...e),this.position=new fe([0,0,0]),this.heading=0,this.tilt=0,this.fov=55}normalizeCtorArgs(e,i,r,n){if(e&&typeof e=="object"&&("x"in e||Array.isArray(e))){const s={position:e};return i!=null&&(s.heading=i),r!=null&&(s.tilt=r),n!=null&&(s.fov=n),s}return e}writePosition(e,i,r,n){const s=e.clone();s.x=ql(e.x||0),s.y=ql(e.y||0),s.z=e.hasZ?ql(e.z||0):e.z,i[r]=s.write({},n)}readPosition(e,i){const r=new fe;return r.read(e,i),r.x=ql(r.x||0),r.y=ql(r.y||0),r.z=r.hasZ?ql(r.z||0):r.z,r}equals(e){return e!=null&&this.tilt===e.tilt&&this.heading===e.heading&&this.fov===e.fov&&this.position.equals(e.position)}};d([p({type:fe,json:{write:{isRequired:!0}}})],gh.prototype,"position",void 0),d([ge("position")],gh.prototype,"writePosition",null),d([ae("position")],gh.prototype,"readPosition",null),d([p({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),tt(t=>Ele.normalize(ql(t)))],gh.prototype,"heading",void 0),d([p({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),tt(t=>Pn(ql(t),-180,180))],gh.prototype,"tilt",void 0),d([p({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],gh.prototype,"fov",void 0),gh=d([A("esri.Camera")],gh);const QAe=gh;var y4;let bf=y4=class extends te{constructor(t){super(t),this.rotation=0,this.scale=0,this.targetGeometry=null,this.camera=null}castRotation(t){return(t%=360)<0&&(t+=360),t}clone(){return new y4({rotation:this.rotation,scale:this.scale,targetGeometry:this.targetGeometry!=null?this.targetGeometry.clone():null,camera:this.camera!=null?this.camera.clone():null})}};function O3(){return{enabled:!this.camera}}d([p({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:O3}}}}})],bf.prototype,"rotation",void 0),d([tt("rotation")],bf.prototype,"castRotation",null),d([p({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:O3}}}}})],bf.prototype,"scale",void 0),d([p({types:_g,json:{read:Vd,write:!0,origins:{"web-scene":{read:Vd,write:{overridePolicy:O3}}}}})],bf.prototype,"targetGeometry",void 0),d([p({type:QAe,json:{write:!0}})],bf.prototype,"camera",void 0),bf=y4=d([A("esri.Viewpoint")],bf);const Pd=bf;function J(t,e,i={}){return wU(t,e,i,$le)}function tn(t,e,i={}){return wU(t,e,i,Ale)}function wU(t,e,i={},r){let n=null;const s=i.once?(o,a)=>{r(o)&&($i(n),e(o,a))}:(o,a)=>{r(o)&&e(o,a)};if(n=yxe(t,s,i.sync,i.equals),i.initial){const o=t();s(o,o)}return n}function ui(t,e,i,r={}){let n=null,s=null,o=null;function a(){var u;n&&s&&(s.remove(),(u=r.onListenerRemove)==null||u.call(r,n),n=null,s=null)}function l(u){r.once&&r.once&&$i(o),i(u)}const c=J(t,(u,h)=>{var f;a(),BO(u)&&(n=u,s=Wh(u,e,l),(f=r.onListenerAdd)==null||f.call(r,u))},{sync:r.sync,initial:!0});return o=Et(()=>{c.remove(),a()}),o}function eke(t,e){return Mle(t,null,e)}function _r(t,e){return Mle(t,Ale,e)}function Mle(t,e,i){if(zo(i))return Promise.reject(wi());const r=t();if(e!=null&&e(r))return Promise.resolve(r);let n=null;function s(){n=$i(n)}return new Promise((o,a)=>{n=kn([Fo(i,()=>{s(),a(wi())}),wU(t,l=>{s(),o(l)},{sync:!1,once:!0},e??$le)])})}function $le(t){return!0}function Ale(t){return!!t}function kle(t,e,i={}){let r=!1;const n=J(t,(s,o)=>{r||e(s,o)},i);return{remove(){n.remove()},pause(){r=!0},resume(){r=!1}}}const Ca={sync:!0},Le={initial:!0},ji={sync:!0,initial:!0},Ple=Object.freeze(Object.defineProperty({__proto__:null,autorun:G6,initial:Le,on:ui,once:eke,pausable:kle,sync:Ca,syncAndInitial:ji,watch:J,when:tn,whenOnce:_r},Symbol.toStringTag,{value:"Module"}));let iT=class{constructor(e=i=>i.values().next().value){this._peeker=e,this._observable=new qO,this._items=new Set}get length(){return Ke(this._observable),this._items.size}clear(){this.length!==0&&(this._items.clear(),this._observable.notify())}last(){if(this.length===0)return;let e;for(e of this._items);return e}peek(){if(this.length!==0)return this._peeker(this._items)}push(e){this.contains(e)||(this._items.add(e),this._observable.notify())}contains(e){return Ke(this._observable),this._items.has(e)}pop(){if(this.length===0)return;const e=this.peek();return this._items.delete(e),this._observable.notify(),e}popLast(){if(this.length===0)return;const e=this.last();return this._items.delete(e),this._observable.notify(),e}remove(e){this.contains(e)&&(this._items.delete(e),this._observable.notify())}filter(e){const i=this.length;return this._items.forEach(r=>{e(r)||this._items.delete(r)}),i!==this._items.size&&this._observable.notify(),this}*[Symbol.iterator](){Ke(this._observable),yield*this._items}};const tke={statsWorker:()=>W(()=>import("./statsWorker-66f0c65a.js"),["./statsWorker-66f0c65a.js","./quantizationUtils-533107d2.js","./utils-fddd1fce.js"],import.meta.url),geometryEngineWorker:()=>W(()=>import("./geometryEngineWorker-5288ae9e.js"),["./geometryEngineWorker-5288ae9e.js","./geometryEngineJSON-2c17178a.js","./geometryEngineBase-eec52f2a.js","./json-48e3ea08.js"],import.meta.url),CSVSourceWorker:()=>W(()=>import("./CSVSourceWorker-aca98034.js"),["./CSVSourceWorker-aca98034.js","./json-48e3ea08.js","./OptimizedFeature-4701473b.js","./OptimizedGeometry-196224d4.js","./FeatureStore-3ba5cfda.js","./featureConversionUtils-bafaa402.js","./OptimizedFeatureSet-1d1ac4b9.js","./BoundsStore-e82b0770.js","./PooledRBush-312cce69.js","./optimizedFeatureQueryEngineAdapter-2fa61fa1.js","./centroid-8e8cfa47.js","./timeSupport-02e20fc8.js","./projectionSupport-66f9e6bd.js","./QueryEngine-85c46ff8.js","./WhereClause-0a50ffa9.js","./quantizationUtils-533107d2.js","./utils-fddd1fce.js","./SnappingCandidate-970faec6.js","./number-335d744d.js"],import.meta.url),EdgeProcessingWorker:()=>W(()=>import("./EdgeProcessingWorker-6f0e8e2c.js"),["./EdgeProcessingWorker-6f0e8e2c.js","./workerHelper-32b5e72c.js","./InterleavedLayout-dee9d785.js","./BufferView-82913510.js","./types-1305598a.js","./edgeProcessing-a6e41f6a.js","./deduplicate-58dc069a.js","./Indices-e7e8209a.js","./glUtil-0b7ee6ea.js","./enums-b14466b3.js","./VertexElementDescriptor-2925c6af.js"],import.meta.url),ElevationSamplerWorker:()=>W(()=>import("./ElevationSamplerWorker-3d9dcd3c.js"),["./ElevationSamplerWorker-3d9dcd3c.js","./PooledRBush-312cce69.js","./georeference-e69a9ce7.js","./spatialReferenceEllipsoidUtils-aadd55de.js","./DoubleArray-2809526b.js","./MeshGeoreferencedRelativeVertexSpace-a1b9aa0f.js","./MeshLocalVertexSpace-37a27546.js","./MeshTransform-392035ba.js","./vec32-304b638d.js","./projection-0dbacb02.js","./BufferView-82913510.js"],import.meta.url),FeatureServiceSnappingSourceWorker:()=>W(()=>import("./FeatureServiceSnappingSourceWorker-905e6154.js"),["./FeatureServiceSnappingSourceWorker-905e6154.js","./FeatureStore-3ba5cfda.js","./featureConversionUtils-bafaa402.js","./OptimizedFeature-4701473b.js","./OptimizedFeatureSet-1d1ac4b9.js","./OptimizedGeometry-196224d4.js","./BoundsStore-e82b0770.js","./PooledRBush-312cce69.js","./optimizedFeatureQueryEngineAdapter-2fa61fa1.js","./centroid-8e8cfa47.js","./timeSupport-02e20fc8.js","./projectionSupport-66f9e6bd.js","./json-48e3ea08.js","./QueryEngine-85c46ff8.js","./WhereClause-0a50ffa9.js","./quantizationUtils-533107d2.js","./utils-fddd1fce.js","./SnappingCandidate-970faec6.js","./symbologySnappingCandidates-02eb0246.js","./pbfQueryUtils-2fe692f0.js","./pbf-beba61b9.js","./query-5ec3ee5e.js","./byteSizeEstimations-7cf1c05d.js"],import.meta.url),GeoJSONSourceWorker:()=>W(()=>import("./GeoJSONSourceWorker-cadb6cd5.js"),["./GeoJSONSourceWorker-cadb6cd5.js","./featureConversionUtils-bafaa402.js","./OptimizedFeature-4701473b.js","./OptimizedFeatureSet-1d1ac4b9.js","./OptimizedGeometry-196224d4.js","./FeatureStore-3ba5cfda.js","./BoundsStore-e82b0770.js","./PooledRBush-312cce69.js","./optimizedFeatureQueryEngineAdapter-2fa61fa1.js","./centroid-8e8cfa47.js","./timeSupport-02e20fc8.js","./projectionSupport-66f9e6bd.js","./json-48e3ea08.js","./QueryEngine-85c46ff8.js","./WhereClause-0a50ffa9.js","./quantizationUtils-533107d2.js","./utils-fddd1fce.js","./SnappingCandidate-970faec6.js","./geojson-a614a3bc.js","./sourceUtils-81f0b337.js"],import.meta.url),LercWorker:()=>W(()=>import("./LercWorker-c19c37f6.js"),[],import.meta.url),MemorySourceWorker:()=>W(()=>import("./MemorySourceWorker-1c737341.js"),["./MemorySourceWorker-1c737341.js","./featureConversionUtils-bafaa402.js","./OptimizedFeature-4701473b.js","./OptimizedFeatureSet-1d1ac4b9.js","./OptimizedGeometry-196224d4.js","./objectIdUtils-789e911a.js","./FeatureStore-3ba5cfda.js","./BoundsStore-e82b0770.js","./PooledRBush-312cce69.js","./optimizedFeatureQueryEngineAdapter-2fa61fa1.js","./centroid-8e8cfa47.js","./timeSupport-02e20fc8.js","./projectionSupport-66f9e6bd.js","./json-48e3ea08.js","./QueryEngine-85c46ff8.js","./WhereClause-0a50ffa9.js","./quantizationUtils-533107d2.js","./utils-fddd1fce.js","./SnappingCandidate-970faec6.js","./sourceUtils-81f0b337.js"],import.meta.url),PBFDecoderWorker:()=>W(()=>import("./PBFDecoderWorker-d14a0398.js"),["./PBFDecoderWorker-d14a0398.js","./featureConversionUtils-bafaa402.js","./OptimizedFeature-4701473b.js","./OptimizedFeatureSet-1d1ac4b9.js","./OptimizedGeometry-196224d4.js","./pbfQueryUtils-2fe692f0.js","./pbf-beba61b9.js"],import.meta.url),Pipeline:()=>W(()=>import("./Pipeline-8b80df80.js"),["./Pipeline-8b80df80.js","./featureConversionUtils-bafaa402.js","./OptimizedFeature-4701473b.js","./OptimizedFeatureSet-1d1ac4b9.js","./OptimizedGeometry-196224d4.js","./QueryEngine-85c46ff8.js","./WhereClause-0a50ffa9.js","./projectionSupport-66f9e6bd.js","./json-48e3ea08.js","./quantizationUtils-533107d2.js","./timeSupport-02e20fc8.js","./utils-fddd1fce.js","./SnappingCandidate-970faec6.js","./FeatureStore2D-b166d545.js","./CircularArray-ef508845.js","./ComputedAttributeStorage-d8e6e2e6.js","./arcadeTimeUtils-3a12e3ee.js","./centroid-8e8cfa47.js","./definitions-8f6c0024.js","./visualVariablesUtils-d4aac532.js","./color-e244539a.js","./enums-f1a6a48a.js","./enums-b14466b3.js","./VertexElementDescriptor-2925c6af.js","./number-e491b09e.js","./ogcFeatureUtils-d6c14400.js","./geojson-a614a3bc.js","./query-5ec3ee5e.js","./pbfQueryUtils-2fe692f0.js","./pbf-beba61b9.js","./createConnection-27f9de9a.js","./geohashUtils-77d8429b.js"],import.meta.url),PointCloudWorker:()=>W(()=>import("./PointCloudWorker-edc37d55.js"),["./PointCloudWorker-edc37d55.js","./I3SBinaryReader-023c980a.js","./PointCloudUniqueValueRenderer-d35b616a.js"],import.meta.url),RasterWorker:()=>W(()=>import("./RasterWorker-1ec8fea8.js"),[],import.meta.url),SceneLayerSnappingSourceWorker:()=>W(()=>import("./SceneLayerSnappingSourceWorker-4ffde5a6.js"),["./SceneLayerSnappingSourceWorker-4ffde5a6.js","./Octree-ae9c8fa1.js","./edgeProcessing-a6e41f6a.js","./deduplicate-58dc069a.js","./Indices-e7e8209a.js","./InterleavedLayout-dee9d785.js","./BufferView-82913510.js","./types-1305598a.js","./glUtil-0b7ee6ea.js","./enums-b14466b3.js","./VertexElementDescriptor-2925c6af.js"],import.meta.url),SceneLayerWorker:()=>W(()=>import("./SceneLayerWorker-ba0dd81b.js"),["./SceneLayerWorker-ba0dd81b.js","./DoubleArray-2809526b.js","./MeshGeoreferencedRelativeVertexSpace-a1b9aa0f.js","./MeshLocalVertexSpace-37a27546.js","./vec32-304b638d.js"],import.meta.url),WFSSourceWorker:()=>W(()=>import("./WFSSourceWorker-2cd76837.js"),["./WFSSourceWorker-2cd76837.js","./featureConversionUtils-bafaa402.js","./OptimizedFeature-4701473b.js","./OptimizedFeatureSet-1d1ac4b9.js","./OptimizedGeometry-196224d4.js","./FeatureStore-3ba5cfda.js","./BoundsStore-e82b0770.js","./PooledRBush-312cce69.js","./optimizedFeatureQueryEngineAdapter-2fa61fa1.js","./centroid-8e8cfa47.js","./timeSupport-02e20fc8.js","./projectionSupport-66f9e6bd.js","./json-48e3ea08.js","./QueryEngine-85c46ff8.js","./WhereClause-0a50ffa9.js","./quantizationUtils-533107d2.js","./utils-fddd1fce.js","./SnappingCandidate-970faec6.js","./geojson-a614a3bc.js","./sourceUtils-81f0b337.js","./wfsUtils-8d6ab0d0.js","./xmlUtils-444cb4c0.js"],import.meta.url),WorkerTileHandler:()=>W(()=>import("./WorkerTileHandler-4c31888e.js"),["./WorkerTileHandler-4c31888e.js","./enums-fb086c25.js","./GeometryUtils-984e8446.js","./Rect-ea14f53a.js","./config-1337d16e.js","./StyleDefinition-29c49b98.js","./enums-f1a6a48a.js","./pbf-beba61b9.js","./TurboLine-2e088fec.js","./definitions-8f6c0024.js","./StyleRepository-f46152cd.js","./enums-b14466b3.js","./VertexElementDescriptor-2925c6af.js","./earcut-6b48af20.js","./BidiEngine-9a40f2f4.js"],import.meta.url)};var ds;(function(t){t[t.HANDSHAKE=0]="HANDSHAKE",t[t.OPEN=1]="OPEN",t[t.OPENED=2]="OPENED",t[t.RESPONSE=3]="RESPONSE",t[t.INVOKE=4]="INVOKE",t[t.ABORT=5]="ABORT",t[t.CLOSE=6]="CLOSE",t[t.OPEN_PORT=7]="OPEN_PORT",t[t.ON=8]="ON"})(ds||(ds={}));let ike=0;function Ole(){return ike++}function rke(t){return t&&typeof t=="object"&&("result"in t||"transferList"in t)}function rT(t){return t?typeof t=="string"?JSON.stringify({name:"message",message:t}):t.toJSON?JSON.stringify(t):JSON.stringify({name:t.name,message:t.message,details:t.details||{stack:t.stack}}):null}function xU(t,e,i,r){if(e.type===ds.OPEN_PORT)return void t.postMessage(e,[e.port]);if(e.type!==ds.INVOKE&&e.type!==ds.RESPONSE)return void t.postMessage(e);let n;if(rke(i)?(n=rW(i.transferList),e.data=i.result):(n=rW(r),e.data=i),n){if(ee("ff")){for(const s of n)if("byteLength"in s&&s.byteLength>267386880){const o="Worker call with large ArrayBuffer would crash Firefox";switch(e.type){case ds.INVOKE:throw o;case ds.RESPONSE:return void xU(t,{type:ds.RESPONSE,jobId:e.jobId,error:rT(o)})}}}t.postMessage(e,n)}else t.postMessage(e)}function nT(t){if(!t)return null;const e=t.data;return e?typeof e=="string"?JSON.parse(e):e:null}function rW(t){if(!t||!t.length)return null;if(ee("esri-workers-arraybuffer-transfer"))return t;const e=t.filter(i=>!nke(i));return e.length?e:null}function nke(t){var e;return t instanceof ArrayBuffer||((e=t==null?void 0:t.constructor)==null?void 0:e.name)==="ArrayBuffer"}const{CLOSE:nW,ABORT:sW,INVOKE:oW,RESPONSE:Cx,OPEN_PORT:aW,ON:ske}=ds,oke=2;let ake=class{constructor(e){this._timer=null,this._cancelledJobIds=new Set,this._invokeMessages=[],this._invoke=e,this._timer=null,this._process=this._process.bind(this)}push(e){e.type===ds.ABORT?this._cancelledJobIds.add(e.jobId):(this._invokeMessages.push(e),this._timer===null&&(this._timer=setTimeout(this._process,0)))}clear(){this._invokeMessages.length=0,this._cancelledJobIds.clear(),this._timer=null}_process(){this._timer=null;for(const e of this._invokeMessages)this._cancelledJobIds.has(e.jobId)||this._invoke(e);this._cancelledJobIds.clear(),this._invokeMessages.length=0}},ag=class ib{static connect(e){const i=new MessageChannel;let r;r=typeof e=="function"?new e:"default"in e&&typeof e.default=="function"?new e.default:e;const n=new ib(i.port1,{channel:i,client:r},()=>null);return typeof r=="object"&&"remoteClient"in r&&(r.remoteClient=n),ib.clients.set(n,r),i.port2}static loadWorker(e){const i=tke[e];return i?i():Promise.resolve(null)}constructor(e,i,r){this._port=e,this._getNextJob=r,this._outJobs=new Map,this._inJobs=new Map,this._invokeQueue=new ake(n=>this._onInvokeMessage(n)),this._client=i.client,this._onMessage=this._onMessage.bind(this),this._channel=i.channel,this._schedule=i.schedule,this._port.addEventListener("message",this._onMessage),this._port.start()}close(){this._post({type:nW}),this._close()}isBusy(){return this._outJobs.size>0}invoke(e,i,r){const n=r==null?void 0:r.signal,s=r==null?void 0:r.transferList;if(!this._port)return Promise.reject(new N("worker:port-closed",`Cannot call invoke('${e}'), port is closed`,{methodName:e,data:i}));const o=Ole();return new Promise((a,l)=>{if(zo(n))return this._processWork(),void l(wi());const c=Fo(n,()=>{const h=this._outJobs.get(o);h&&(this._outJobs.delete(o),this._processWork(),$i(h.abortHandle),this._post({type:sW,jobId:o}),l(wi()))}),u={resolve:a,reject:l,abortHandle:c,debugInfo:e};this._outJobs.set(o,u),this._post({type:oW,jobId:o,methodName:e,abortable:n!=null},i,s)})}on(e,i){const r=new MessageChannel;function n(s){i(s.data)}return this._port.postMessage({type:ds.ON,eventType:e,port:r.port2},[r.port2]),r.port1.addEventListener("message",n),r.port1.start(),{remove(){r.port1.postMessage({type:ds.CLOSE}),r.port1.close(),r.port1.removeEventListener("message",n)}}}jobAdded(){this._processWork()}openPort(){const e=new MessageChannel;return this._post({type:aW,port:e.port2}),e.port1}_processWork(){if(this._outJobs.size>=oke)return;const e=this._getNextJob();if(!e)return;const{methodName:i,data:r,invokeOptions:n,resolver:s}=e;this.invoke(i,r,n).then(o=>s.resolve(o)).catch(o=>s.reject(o))}_close(){this._channel&&(this._channel=void 0),this._port.removeEventListener("message",this._onMessage),this._port.close(),this._outJobs.forEach(e=>{$i(e.abortHandle),e.reject(wi(`Worker closing, aborting job calling '${e.debugInfo}'`))}),this._inJobs.clear(),this._outJobs.clear(),this._invokeQueue.clear(),this._port=null,this._client=null,this._schedule=null}_onMessage(e){this._schedule!=null?this._schedule(()=>this._processMessage(e)):this._processMessage(e)}_processMessage(e){const i=nT(e);if(i)switch(i.type){case Cx:this._onResponseMessage(i);break;case oW:this._invokeQueue.push(i);break;case sW:this._onAbortMessage(i);break;case nW:this._onCloseMessage();break;case aW:this._onOpenPortMessage(i);break;case ske:this._onOnMessage(i)}}_onAbortMessage(e){const i=this._inJobs,r=e.jobId,n=i.get(r);this._invokeQueue.push(e),n&&(n.controller&&n.controller.abort(),i.delete(r))}_onCloseMessage(){const e=this._client;this._close(),e&&"destroy"in e&&ib.clients.get(this)===e&&e.destroy(),ib.clients.delete(this),e!=null&&e.remoteClient&&(e.remoteClient=null)}_onInvokeMessage(e){const{methodName:i,jobId:r,data:n,abortable:s}=e,o=s?new AbortController:null,a=this._inJobs;let l,c=this._client,u=c[i];try{if(!u&&i&&i.includes(".")){const h=i.split(".");for(let f=0;f<h.length-1;f++)c=c[h[f]],u=c[h[f+1]]}if(typeof u!="function")throw new TypeError(`${i} is not a function`);l=u.call(c,n,{client:this,signal:o?o.signal:null})}catch(h){return void this._post({type:Cx,jobId:r,error:rT(h)})}Tp(l)?(a.set(r,{controller:o,promise:l}),l.then(h=>{a.has(r)&&(a.delete(r),this._post({type:Cx,jobId:r},h))},h=>{a.has(r)&&(a.delete(r),ys(h)||this._post({type:Cx,jobId:r,error:rT(h||{message:`Error encountered at method ${i}`})}))})):this._post({type:Cx,jobId:r},l)}_onOpenPortMessage(e){new ib(e.port,{client:this._client},()=>null)}_onOnMessage(e){const{port:i}=e,r=this._client.on(e.eventType,s=>{i.postMessage(s)}),n=Wh(e.port,"message",s=>{const o=nT(s);(o==null?void 0:o.type)===ds.CLOSE&&(n.remove(),r.remove(),i.close())})}_onResponseMessage(e){const{jobId:i,error:r,data:n}=e,s=this._outJobs;if(!s.has(i))return;const o=s.get(i);s.delete(i),this._processWork(),$i(o.abortHandle),r?o.reject(N.fromJSON(JSON.parse(r))):o.resolve(n)}_post(e,i,r){return xU(this._port,e,i,r)}};ag.kernelInfo={buildDate:sse,fullVersion:vB,revision:ose},ag.clients=new Map;let lke=class{constructor(){this._inUseClients=new Array,this._clients=new Array,this._clientPromises=new Array,this._ongoingJobsQueue=new iT}destroy(){this.close()}get closed(){return!this._clients||!this._clients.length}open(e,i){return new Promise((r,n)=>{let s=!0;const o=a=>{_t(i.signal),s&&(s=!1,a())};this._clients.length=e.length,this._clientPromises.length=e.length,this._inUseClients.length=e.length;for(let a=0;a<e.length;++a){const l=e[a];Tp(l)?this._clientPromises[a]=l.then(c=>(this._clients[a]=new ag(c,i,()=>this._ongoingJobsQueue.pop()??null),o(r),this._clients[a]),()=>(o(n),null)):(this._clients[a]=new ag(l,i,()=>this._ongoingJobsQueue.pop()??null),this._clientPromises[a]=Promise.resolve(this._clients[a]),o(r))}})}broadcast(e,i,r){const n=new Array(this._clientPromises.length);for(let s=0;s<this._clientPromises.length;++s){const o=this._clientPromises[s];n[s]=o.then(a=>a==null?void 0:a.invoke(e,i,r))}return n}close(){let e;for(;e=this._ongoingJobsQueue.pop();)e.resolver.reject(wi(`Worker closing, aborting job calling '${e.methodName}'`));for(const i of this._clientPromises)i.then(r=>r==null?void 0:r.close());this._clients.length=0,this._clientPromises.length=0,this._inUseClients.length=0}invoke(e,i,r){let n;Array.isArray(r)?(ie.getLogger("esri.core.workers.Connection").warn("invoke()","The transferList parameter is deprecated, use the options object instead"),n={transferList:r}):n=r;const s=Ta();this._ongoingJobsQueue.push({methodName:e,data:i,invokeOptions:n,resolver:s});for(let o=0;o<this._clientPromises.length;o++){const a=this._clients[o];a?a.jobAdded():this._clientPromises[o].then(l=>l==null?void 0:l.jobAdded())}return s.promise}on(e,i){return Promise.all(this._clientPromises).then(()=>kn(this._clients.map(r=>r.on(e,i))))}openPorts(){return new Promise(e=>{const i=new Array(this._clientPromises.length);let r=i.length;for(let n=0;n<this._clientPromises.length;++n)this._clientPromises[n].then(s=>{s&&(i[n]=s.openPort()),--r==0&&e(i)})})}get test(){return{numClients:this._clients.length}}};const Lle=ie.getLogger("esri.intl.substitute");function Os(t,e,i={}){const{format:r={}}=i;return oc(t,n=>cke(n,e,r))}function cke(t,e,i){let r,n;const s=t.indexOf(":");if(s===-1?r=t.trim():(r=t.slice(0,s).trim(),n=t.slice(s+1).trim()),!r)return"";const o=ZT(r,e);if(o==null)return"";const a=(n?i==null?void 0:i[n]:null)??(i==null?void 0:i[r]);return a?uke(o,a):n?dke(o,n):SU(o)}function uke(t,e){switch(e.type){case"date":return Oi(t,e.intlOptions);case"number":return po(t,e.intlOptions);default:return Lle.warn("missing format descriptor for key {key}"),SU(t)}}function dke(t,e){switch(e.toLowerCase()){case"dateformat":return Oi(t);case"numberformat":return po(t);default:return Lle.warn(`inline format is unsupported since 4.12: ${e}`),/^(dateformat|datestring)/i.test(e)?Oi(t):/^numberformat/i.test(e)?po(t):SU(t)}}function SU(t){switch(typeof t){case"string":return t;case"number":return po(t);case"boolean":return""+t;default:return t instanceof Date?Oi(t):""}}async function hke(t,e,i,r){const n=e.exec(i);if(!n)throw new N("esri-intl:invalid-bundle",`Bundle id "${i}" is not compatible with the pattern "${e}"`);const s=n[1]?`${n[1]}/`:"",o=n[2],a=LIe(r),l=`${s}${o}.json`,c=a?`${s}${o}_${a}.json`:l;let u;try{u=await lW(t(c))}catch(h){if(c===l)throw new N("intl:unknown-bundle",`Bundle "${i}" cannot be loaded`,{error:h});try{u=await lW(t(l))}catch(f){throw new N("intl:unknown-bundle",`Bundle "${i}" cannot be loaded`,{error:f})}}return u}async function lW(t){if(cW.fetchBundleAsset!=null)return cW.fetchBundleAsset(t);const e=await at(t,{responseType:"text"});return JSON.parse(e.data)}let pke=class{constructor({base:e="",pattern:i,location:r=new URL(window.location.href)}){let n;n=typeof r=="string"?s=>new URL(s,new URL(r,window.location.href)).href:r instanceof URL?s=>new URL(s,r).href:r,this.pattern=typeof i=="string"?new RegExp(`^${i}`):i,this.getAssetUrl=n,e=e?e.endsWith("/")?e:e+"/":"",this.matcher=new RegExp(`^${e}(?:(.*)/)?(.*)$`)}fetchMessageBundle(e,i){return hke(this.getAssetUrl,this.matcher,e,i)}};function fke(t){return new pke(t)}const cW={};OIe(fke({pattern:"esri/",location:Tt}));const mke={};function gke(t){const e={async:t.async,isDebug:t.isDebug,locale:t.locale,baseUrl:t.baseUrl,has:{...t.has},map:{...t.map},packages:t.packages&&t.packages.concat()||[],paths:{...t.paths}};return t.hasOwnProperty("async")||(e.async=!0),t.hasOwnProperty("isDebug")||(e.isDebug=!1),t.baseUrl||(e.baseUrl=mke.baseUrl),e}let yke=class{constructor(){const e=document.createDocumentFragment();["addEventListener","dispatchEvent","removeEventListener"].forEach(i=>{this[i]=(...r)=>e[i](...r)})}},Q$=class{constructor(){this._dispatcher=new yke,this._workerPostMessage({type:ds.HANDSHAKE})}terminate(){}get onmessage(){return this._onmessageHandler}set onmessage(e){this._onmessageHandler&&this.removeEventListener("message",this._onmessageHandler),this._onmessageHandler=e,e&&this.addEventListener("message",e)}get onmessageerror(){return this._onmessageerrorHandler}set onmessageerror(e){this._onmessageerrorHandler&&this.removeEventListener("messageerror",this._onmessageerrorHandler),this._onmessageerrorHandler=e,e&&this.addEventListener("messageerror",e)}get onerror(){return this._onerrorHandler}set onerror(e){this._onerrorHandler&&this.removeEventListener("error",this._onerrorHandler),this._onerrorHandler=e,e&&this.addEventListener("error",e)}postMessage(e){Ww(()=>{this._workerMessageHandler(new MessageEvent("message",{data:e}))})}dispatchEvent(e){return this._dispatcher.dispatchEvent(e)}addEventListener(e,i,r){this._dispatcher.addEventListener(e,i,r)}removeEventListener(e,i,r){this._dispatcher.removeEventListener(e,i,r)}_workerPostMessage(e){Ww(()=>{this.dispatchEvent(new MessageEvent("message",{data:e}))})}async _workerMessageHandler(e){const i=nT(e);if(i&&i.type===ds.OPEN){const{modulePath:r,jobId:n}=i;let s=await ag.loadWorker(r);s||(s=await W(()=>import(r),[],import.meta.url));const o=ag.connect(s);this._workerPostMessage({type:ds.OPENED,jobId:n,data:o})}}};const v4=ie.getLogger("esri.core.workers.workerFactory"),{HANDSHAKE:vke}=ds,_ke='let globalId=0;const outgoing=new Map,configuration=JSON.parse("{CONFIGURATION}");self.esriConfig=configuration.esriConfig;const workerPath=self.esriConfig.workers.workerPath,HANDSHAKE=0,OPEN=1,OPENED=2,RESPONSE=3,INVOKE=4,ABORT=5;function createAbortError(){const e=new Error("Aborted");return e.name="AbortError",e}function receiveMessage(e){return e&&e.data?"string"==typeof e.data?JSON.parse(e.data):e.data:null}function invokeStaticMessage(e,o,r){const t=r&&r.signal,n=globalId++;return new Promise(((r,s)=>{if(t){if(t.aborted)return s(createAbortError());t.addEventListener("abort",(()=>{outgoing.get(n)&&(outgoing.delete(n),self.postMessage({type:ABORT,jobId:n}),s(createAbortError()))}))}outgoing.set(n,{resolve:r,reject:s}),self.postMessage({type:INVOKE,jobId:n,methodName:e,abortable:null!=t,data:o})}))}let workerRevisionChecked=!1;function checkWorkerRevision(e){if(!workerRevisionChecked&&e.kernelInfo){workerRevisionChecked=!0;const{revision:o,fullVersion:r}=configuration.kernelInfo,{revision:t,fullVersion:n,version:s}=e.kernelInfo;esriConfig.assetsPath!==esriConfig.defaultAssetsPath&&o!==t&&console.warn(`Version mismatch detected between ArcGIS Maps SDK for JavaScript modules and assets. For more information visit https://bit.ly/3QnsuSo.\\nModules version: ${r}\\nAssets version: ${n??s}\\nAssets path: ${esriConfig.assetsPath}`)}}function messageHandler(e){const o=receiveMessage(e);if(!o)return;const r=o.jobId;switch(o.type){case OPEN:let n;function t(e){const o=n.connect(e);self.postMessage({type:OPENED,jobId:r,data:o},[o])}"function"==typeof define&&define.amd?require([workerPath],(e=>{n=e.default||e,checkWorkerRevision(n),n.loadWorker(o.modulePath).then((e=>e||new Promise((e=>{require([o.modulePath],e)})))).then(t)})):"System"in self&&"function"==typeof System.import?System.import(workerPath).then((e=>(n=e.default,checkWorkerRevision(n),n.loadWorker(o.modulePath)))).then((e=>e||System.import(o.modulePath))).then(t):esriConfig.workers.useDynamicImport?import(workerPath).then((e=>{n=e.default||e,checkWorkerRevision(n),n.loadWorker(o.modulePath).then((e=>e||import(o.modulePath))).then(t)})):(self.RemoteClient||importScripts(workerPath),n=self.RemoteClient.default||self.RemoteClient,checkWorkerRevision(n),n.loadWorker(o.modulePath).then(t));break;case RESPONSE:if(outgoing.has(r)){const s=outgoing.get(r);outgoing.delete(r),o.error?s.reject(JSON.parse(o.error)):s.resolve(o.data)}}}self.dojoConfig=configuration.loaderConfig,esriConfig.workers.loaderUrl&&(self.importScripts(esriConfig.workers.loaderUrl),"function"==typeof require&&"function"==typeof require.config&&require.config(configuration.loaderConfig)),self.addEventListener("message",messageHandler),self.postMessage({type:0});';let CE,EE;const uW="Failed to create Worker. Fallback to execute module in main thread";async function bke(){if(!ee("esri-workers")||(ee("mozilla"),0))return dW(new Q$);if(!CE&&!EE)try{const e=_ke.split('"{CONFIGURATION}"').join(`'${wke()}'`);CE=URL.createObjectURL(new Blob([e],{type:"text/javascript"}))}catch(e){EE=e||{}}let t;if(CE)try{t=new Worker(CE,{name:"esri-worker-"+xke++})}catch{v4.warn(uW,EE),t=new Q$}else v4.warn(uW,EE),t=new Q$;return dW(t)}async function dW(t){return new Promise(e=>{function i(n){const s=nT(n);s&&s.type===vke&&(t.removeEventListener("message",i),t.removeEventListener("error",r),e(t))}function r(n){n.preventDefault(),t.removeEventListener("message",i),t.removeEventListener("error",r),v4.warn("Failed to create Worker. Fallback to execute module in main thread",n),(t=new Q$).addEventListener("message",i),t.addEventListener("error",r)}t.addEventListener("message",i),t.addEventListener("error",r)})}function wke(){let t;if(Lt.default!=null){const n={...Lt};delete n.default,t=JSON.parse(JSON.stringify(n))}else t=JSON.parse(JSON.stringify(Lt));t.assetsPath=Jl(t.assetsPath),t.defaultAssetsPath=t.defaultAssetsPath?Jl(t.defaultAssetsPath):void 0,t.request.interceptors=[],t.log.interceptors=[],t.locale=Mn(),t.has={"esri-csp-restrictions":ee("esri-csp-restrictions"),"esri-2d-debug":!1,"esri-2d-update-debug":ee("esri-2d-update-debug"),"esri-2d-log-updating":ee("esri-2d-log-updating"),"featurelayer-pbf":ee("featurelayer-pbf"),"featurelayer-simplify-thresholds":ee("featurelayer-simplify-thresholds"),"featurelayer-simplify-payload-size-factors":ee("featurelayer-simplify-payload-size-factors"),"featurelayer-simplify-mobile-factor":ee("featurelayer-simplify-mobile-factor"),"esri-atomics":ee("esri-atomics"),"esri-shared-array-buffer":ee("esri-shared-array-buffer"),"esri-tiles-debug":ee("esri-tiles-debug"),"esri-workers-arraybuffer-transfer":ee("esri-workers-arraybuffer-transfer"),"feature-polyline-generalization-factor":ee("feature-polyline-generalization-factor"),"host-webworker":1,"polylabel-placement-enabled":ee("polylabel-placement-enabled")},t.workers.loaderUrl&&(t.workers.loaderUrl=Jl(t.workers.loaderUrl)),t.workers.workerPath?t.workers.workerPath=Jl(t.workers.workerPath):t.workers.workerPath=Jl(Tt("esri/core/workers/RemoteClient.js")),t.workers.useDynamicImport=!1;const e=Lt.workers.loaderConfig,i=gke({baseUrl:e==null?void 0:e.baseUrl,locale:Mn(),has:{"csp-restrictions":1,"dojo-test-sniff":0,"host-webworker":1,...e==null?void 0:e.has},map:{...e==null?void 0:e.map},paths:{...e==null?void 0:e.paths},packages:(e==null?void 0:e.packages)||[]});return JSON.stringify({esriConfig:t,loaderConfig:i,kernelInfo:{buildDate:sse,fullVersion:vB,revision:ose}})}let xke=0;const{ABORT:hW,INVOKE:Ske,OPEN:Ike,OPENED:Tke,RESPONSE:Ex}=ds;let Cke=class Rle{static async create(e){const i=await bke();return new Rle(i,e)}constructor(e,i){this._outJobs=new Map,this._inJobs=new Map,this.worker=e,this.id=i,e.addEventListener("message",this._onMessage.bind(this)),e.addEventListener("error",r=>{r.preventDefault(),ie.getLogger("esri.core.workers.WorkerOwner").error(r)})}terminate(){this.worker.terminate()}async open(e,i={}){const{signal:r}=i,n=Ole();return new Promise((s,o)=>{const a={resolve:s,reject:o,abortHandle:U6(r,()=>{this._outJobs.delete(n),this._post({type:hW,jobId:n})})};this._outJobs.set(n,a),this._post({type:Ike,jobId:n,modulePath:e})})}_onMessage(e){const i=nT(e);if(i)switch(i.type){case Tke:this._onOpenedMessage(i);break;case Ex:this._onResponseMessage(i);break;case hW:this._onAbortMessage(i);break;case Ske:this._onInvokeMessage(i)}}_onAbortMessage(e){const i=this._inJobs,r=e.jobId,n=i.get(r);n&&(n.controller&&n.controller.abort(),i.delete(r))}_onInvokeMessage(e){const{methodName:i,jobId:r,data:n,abortable:s}=e,o=s?new AbortController:null,a=this._inJobs,l=A2e[i];let c;try{if(typeof l!="function")throw new TypeError(`${i} is not a function`);c=l.call(null,n,{signal:o?o.signal:null})}catch(u){return void this._post({type:Ex,jobId:r,error:rT(u)})}Tp(c)?(a.set(r,{controller:o,promise:c}),c.then(u=>{a.has(r)&&(a.delete(r),this._post({type:Ex,jobId:r},u))},u=>{a.has(r)&&(a.delete(r),u||(u={message:"Error encountered at method"+i}),ys(u)||this._post({type:Ex,jobId:r,error:rT(u||{message:`Error encountered at method ${i}`})}))})):this._post({type:Ex,jobId:r},c)}_onOpenedMessage(e){const{jobId:i,data:r}=e,n=this._outJobs.get(i);n&&(this._outJobs.delete(i),$i(n.abortHandle),n.resolve(r))}_onResponseMessage(e){const{jobId:i,error:r,data:n}=e,s=this._outJobs.get(i);s&&(this._outJobs.delete(i),$i(s.abortHandle),r?s.reject(N.fromJSON(JSON.parse(r))):s.resolve(n))}_post(e,i,r){return xU(this.worker,e,i,r)}};const pW=ee("host-browser")?Math.min(navigator.hardwareConcurrency-1,ee("workers-pool-size")):0;let G0=ee("esri-mobile")?Math.min(pW,3):pW;G0||(G0=ee("safari")&&ee("mac")?7:2);let fW=0;const eA=[];function Eke(){Fle()}async function ME(t,e){const i=new lke;return await i.open(t,e),i}async function IU(t,e={}){if(typeof t!="string")throw new N("workers:undefined-module","modulePath is missing");let i=e.strategy||"distributed";if(ee("host-webworker")&&!ee("esri-workers")&&(i="local"),i==="local"){let r=await ag.loadWorker(t);r||(r=await W(()=>import(t),[],import.meta.url)),_t(e.signal);const n=e.client||r;return ME([ag.connect(r)],{...e,client:n})}if(await Fle(),_t(e.signal),i==="dedicated"){const r=fW++%G0;return ME([await eA[r].open(t,e)],e)}if(e.maxNumWorkers&&e.maxNumWorkers>0){const r=Math.min(e.maxNumWorkers,G0);if(r<G0){const n=new Array(r);for(let s=0;s<r;++s){const o=fW++%G0;n[s]=eA[o].open(t,e)}return ME(n,e)}}return ME(eA.map(r=>r.open(t,e)),e)}let $E=null;async function Fle(){if($E)return $E;new AbortController;const t=[];for(let e=0;e<G0;e++){const i=Cke.create(e).then(r=>(eA[e]=r,r));t.push(i)}return $E=Promise.all(t),$E}function sT(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Sg(t,e,i,r,n,s,o,a,l,c,u,h,f,m,g,y,v){return t[0]=e,t[1]=i,t[2]=r,t[3]=n,t[4]=s,t[5]=o,t[6]=a,t[7]=l,t[8]=c,t[9]=u,t[10]=h,t[11]=f,t[12]=m,t[13]=g,t[14]=y,t[15]=v,t}function bC(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ac(t,e){if(t===e){const i=e[1],r=e[2],n=e[3],s=e[6],o=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=i,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=s,t[11]=e[14],t[12]=n,t[13]=o,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function Mke(t,e){return fL(t,e)||bC(t),t}function fL(t,e){const i=e[0],r=e[1],n=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=e[9],f=e[10],m=e[11],g=e[12],y=e[13],v=e[14],b=e[15],w=i*a-r*o,x=i*l-n*o,S=i*c-s*o,I=r*l-n*a,T=r*c-s*a,C=n*c-s*l,E=u*y-h*g,$=u*v-f*g,P=u*b-m*g,k=h*v-f*y,L=h*b-m*y,F=f*b-m*v;let V=w*F-x*L+S*k+I*P-T*$+C*E;return V?(V=1/V,t[0]=(a*F-l*L+c*k)*V,t[1]=(n*L-r*F-s*k)*V,t[2]=(y*C-v*T+b*I)*V,t[3]=(f*T-h*C-m*I)*V,t[4]=(l*P-o*F-c*$)*V,t[5]=(i*F-n*P+s*$)*V,t[6]=(v*S-g*C-b*x)*V,t[7]=(u*C-f*S+m*x)*V,t[8]=(o*L-a*P+c*E)*V,t[9]=(r*P-i*L-s*E)*V,t[10]=(g*T-y*S+b*w)*V,t[11]=(h*S-u*T-m*w)*V,t[12]=(a*$-o*k-l*E)*V,t[13]=(i*k-r*$+n*E)*V,t[14]=(y*x-g*I-v*w)*V,t[15]=(u*I-h*x+f*w)*V,t):null}function $ke(t,e){const i=e[0],r=e[1],n=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=e[9],f=e[10],m=e[11],g=e[12],y=e[13],v=e[14],b=e[15];return t[0]=a*(f*b-m*v)-h*(l*b-c*v)+y*(l*m-c*f),t[1]=-(r*(f*b-m*v)-h*(n*b-s*v)+y*(n*m-s*f)),t[2]=r*(l*b-c*v)-a*(n*b-s*v)+y*(n*c-s*l),t[3]=-(r*(l*m-c*f)-a*(n*m-s*f)+h*(n*c-s*l)),t[4]=-(o*(f*b-m*v)-u*(l*b-c*v)+g*(l*m-c*f)),t[5]=i*(f*b-m*v)-u*(n*b-s*v)+g*(n*m-s*f),t[6]=-(i*(l*b-c*v)-o*(n*b-s*v)+g*(n*c-s*l)),t[7]=i*(l*m-c*f)-o*(n*m-s*f)+u*(n*c-s*l),t[8]=o*(h*b-m*y)-u*(a*b-c*y)+g*(a*m-c*h),t[9]=-(i*(h*b-m*y)-u*(r*b-s*y)+g*(r*m-s*h)),t[10]=i*(a*b-c*y)-o*(r*b-s*y)+g*(r*c-s*a),t[11]=-(i*(a*m-c*h)-o*(r*m-s*h)+u*(r*c-s*a)),t[12]=-(o*(h*v-f*y)-u*(a*v-l*y)+g*(a*f-l*h)),t[13]=i*(h*v-f*y)-u*(r*v-n*y)+g*(r*f-n*h),t[14]=-(i*(a*v-l*y)-o*(r*v-n*y)+g*(r*l-n*a)),t[15]=i*(a*f-l*h)-o*(r*f-n*h)+u*(r*l-n*a),t}function Ake(t){const e=t[0],i=t[1],r=t[2],n=t[3],s=t[4],o=t[5],a=t[6],l=t[7],c=t[8],u=t[9],h=t[10],f=t[11],m=t[12],g=t[13],y=t[14],v=t[15];return(e*o-i*s)*(h*v-f*y)-(e*a-r*s)*(u*v-f*g)+(e*l-n*s)*(u*y-h*g)+(i*a-r*o)*(c*v-f*m)-(i*l-n*o)*(c*y-h*m)+(r*l-n*a)*(c*g-u*m)}function TU(t,e,i){const r=e[0],n=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],f=e[9],m=e[10],g=e[11],y=e[12],v=e[13],b=e[14],w=e[15];let x=i[0],S=i[1],I=i[2],T=i[3];return t[0]=x*r+S*a+I*h+T*y,t[1]=x*n+S*l+I*f+T*v,t[2]=x*s+S*c+I*m+T*b,t[3]=x*o+S*u+I*g+T*w,x=i[4],S=i[5],I=i[6],T=i[7],t[4]=x*r+S*a+I*h+T*y,t[5]=x*n+S*l+I*f+T*v,t[6]=x*s+S*c+I*m+T*b,t[7]=x*o+S*u+I*g+T*w,x=i[8],S=i[9],I=i[10],T=i[11],t[8]=x*r+S*a+I*h+T*y,t[9]=x*n+S*l+I*f+T*v,t[10]=x*s+S*c+I*m+T*b,t[11]=x*o+S*u+I*g+T*w,x=i[12],S=i[13],I=i[14],T=i[15],t[12]=x*r+S*a+I*h+T*y,t[13]=x*n+S*l+I*f+T*v,t[14]=x*s+S*c+I*m+T*b,t[15]=x*o+S*u+I*g+T*w,t}function kke(t,e,i){const r=i[0],n=i[1],s=i[2];if(e===t)t[12]=e[0]*r+e[4]*n+e[8]*s+e[12],t[13]=e[1]*r+e[5]*n+e[9]*s+e[13],t[14]=e[2]*r+e[6]*n+e[10]*s+e[14],t[15]=e[3]*r+e[7]*n+e[11]*s+e[15];else{const o=e[0],a=e[1],l=e[2],c=e[3],u=e[4],h=e[5],f=e[6],m=e[7],g=e[8],y=e[9],v=e[10],b=e[11];t[0]=o,t[1]=a,t[2]=l,t[3]=c,t[4]=u,t[5]=h,t[6]=f,t[7]=m,t[8]=g,t[9]=y,t[10]=v,t[11]=b,t[12]=o*r+u*n+g*s+e[12],t[13]=a*r+h*n+y*s+e[13],t[14]=l*r+f*n+v*s+e[14],t[15]=c*r+m*n+b*s+e[15]}return t}function Pke(t,e,i){const r=i[0],n=i[1],s=i[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*s,t[9]=e[9]*s,t[10]=e[10]*s,t[11]=e[11]*s,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Oke(t,e,i,r){let n,s,o,a,l,c,u,h,f,m,g,y,v,b,w,x,S,I,T,C,E,$,P,k,L=r[0],F=r[1],V=r[2],z=Math.sqrt(L*L+F*F+V*V);return z<Bo()?null:(z=1/z,L*=z,F*=z,V*=z,n=Math.sin(i),s=Math.cos(i),o=1-s,a=e[0],l=e[1],c=e[2],u=e[3],h=e[4],f=e[5],m=e[6],g=e[7],y=e[8],v=e[9],b=e[10],w=e[11],x=L*L*o+s,S=F*L*o+V*n,I=V*L*o-F*n,T=L*F*o-V*n,C=F*F*o+s,E=V*F*o+L*n,$=L*V*o+F*n,P=F*V*o-L*n,k=V*V*o+s,t[0]=a*x+h*S+y*I,t[1]=l*x+f*S+v*I,t[2]=c*x+m*S+b*I,t[3]=u*x+g*S+w*I,t[4]=a*T+h*C+y*E,t[5]=l*T+f*C+v*E,t[6]=c*T+m*C+b*E,t[7]=u*T+g*C+w*E,t[8]=a*$+h*P+y*k,t[9]=l*$+f*P+v*k,t[10]=c*$+m*P+b*k,t[11]=u*$+g*P+w*k,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function Lke(t,e,i){const r=Math.sin(i),n=Math.cos(i),s=e[4],o=e[5],a=e[6],l=e[7],c=e[8],u=e[9],h=e[10],f=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=s*n+c*r,t[5]=o*n+u*r,t[6]=a*n+h*r,t[7]=l*n+f*r,t[8]=c*n-s*r,t[9]=u*n-o*r,t[10]=h*n-a*r,t[11]=f*n-l*r,t}function Rke(t,e,i){const r=Math.sin(i),n=Math.cos(i),s=e[0],o=e[1],a=e[2],l=e[3],c=e[8],u=e[9],h=e[10],f=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*n-c*r,t[1]=o*n-u*r,t[2]=a*n-h*r,t[3]=l*n-f*r,t[8]=s*r+c*n,t[9]=o*r+u*n,t[10]=a*r+h*n,t[11]=l*r+f*n,t}function Fke(t,e,i){const r=Math.sin(i),n=Math.cos(i),s=e[0],o=e[1],a=e[2],l=e[3],c=e[4],u=e[5],h=e[6],f=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*n+c*r,t[1]=o*n+u*r,t[2]=a*n+h*r,t[3]=l*n+f*r,t[4]=c*n-s*r,t[5]=u*n-o*r,t[6]=h*n-a*r,t[7]=f*n-l*r,t}function Dle(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function Dke(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function CU(t,e,i){if(e===0)return bC(t);let r,n,s,o=i[0],a=i[1],l=i[2],c=Math.sqrt(o*o+a*a+l*l);return c<Bo()?null:(c=1/c,o*=c,a*=c,l*=c,r=Math.sin(e),n=Math.cos(e),s=1-n,t[0]=o*o*s+n,t[1]=a*o*s+l*r,t[2]=l*o*s-a*r,t[3]=0,t[4]=o*a*s-l*r,t[5]=a*a*s+n,t[6]=l*a*s+o*r,t[7]=0,t[8]=o*l*s+a*r,t[9]=a*l*s-o*r,t[10]=l*l*s+n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function Nke(t,e){const i=Math.sin(e),r=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=i,t[7]=0,t[8]=0,t[9]=-i,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Vke(t,e){const i=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=0,t[2]=-i,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=i,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function zke(t,e){const i=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=i,t[2]=0,t[3]=0,t[4]=-i,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Nle(t,e,i){const r=e[0],n=e[1],s=e[2],o=e[3],a=r+r,l=n+n,c=s+s,u=r*a,h=r*l,f=r*c,m=n*l,g=n*c,y=s*c,v=o*a,b=o*l,w=o*c;return t[0]=1-(m+y),t[1]=h+w,t[2]=f-b,t[3]=0,t[4]=h-w,t[5]=1-(u+y),t[6]=g+v,t[7]=0,t[8]=f+b,t[9]=g-v,t[10]=1-(u+m),t[11]=0,t[12]=i[0],t[13]=i[1],t[14]=i[2],t[15]=1,t}function jke(t,e){const i=Bke,r=-e[0],n=-e[1],s=-e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=r*r+n*n+s*s+o*o;return h>0?(i[0]=2*(a*o+u*r+l*s-c*n)/h,i[1]=2*(l*o+u*n+c*r-a*s)/h,i[2]=2*(c*o+u*s+a*n-l*r)/h):(i[0]=2*(a*o+u*r+l*s-c*n),i[1]=2*(l*o+u*n+c*r-a*s),i[2]=2*(c*o+u*s+a*n-l*r)),Nle(t,e,i),t}const Bke=Me();function Uke(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function Gke(t,e){const i=e[0],r=e[1],n=e[2],s=e[4],o=e[5],a=e[6],l=e[8],c=e[9],u=e[10];return t[0]=Math.sqrt(i*i+r*r+n*n),t[1]=Math.sqrt(s*s+o*o+a*a),t[2]=Math.sqrt(l*l+c*c+u*u),t}function Hke(t,e){const i=e[0]+e[5]+e[10];let r=0;return i>0?(r=2*Math.sqrt(i+1),t[3]=.25*r,t[0]=(e[6]-e[9])/r,t[1]=(e[8]-e[2])/r,t[2]=(e[1]-e[4])/r):e[0]>e[5]&&e[0]>e[10]?(r=2*Math.sqrt(1+e[0]-e[5]-e[10]),t[3]=(e[6]-e[9])/r,t[0]=.25*r,t[1]=(e[1]+e[4])/r,t[2]=(e[8]+e[2])/r):e[5]>e[10]?(r=2*Math.sqrt(1+e[5]-e[0]-e[10]),t[3]=(e[8]-e[2])/r,t[0]=(e[1]+e[4])/r,t[1]=.25*r,t[2]=(e[6]+e[9])/r):(r=2*Math.sqrt(1+e[10]-e[0]-e[5]),t[3]=(e[1]-e[4])/r,t[0]=(e[8]+e[2])/r,t[1]=(e[6]+e[9])/r,t[2]=.25*r),t}function qke(t,e,i,r){const n=e[0],s=e[1],o=e[2],a=e[3],l=n+n,c=s+s,u=o+o,h=n*l,f=n*c,m=n*u,g=s*c,y=s*u,v=o*u,b=a*l,w=a*c,x=a*u,S=r[0],I=r[1],T=r[2];return t[0]=(1-(g+v))*S,t[1]=(f+x)*S,t[2]=(m-w)*S,t[3]=0,t[4]=(f-x)*I,t[5]=(1-(h+v))*I,t[6]=(y+b)*I,t[7]=0,t[8]=(m+w)*T,t[9]=(y-b)*T,t[10]=(1-(h+g))*T,t[11]=0,t[12]=i[0],t[13]=i[1],t[14]=i[2],t[15]=1,t}function Wke(t,e,i,r,n){const s=e[0],o=e[1],a=e[2],l=e[3],c=s+s,u=o+o,h=a+a,f=s*c,m=s*u,g=s*h,y=o*u,v=o*h,b=a*h,w=l*c,x=l*u,S=l*h,I=r[0],T=r[1],C=r[2],E=n[0],$=n[1],P=n[2],k=(1-(y+b))*I,L=(m+S)*I,F=(g-x)*I,V=(m-S)*T,z=(1-(f+b))*T,G=(v+w)*T,H=(g+x)*C,Z=(v-w)*C,K=(1-(f+y))*C;return t[0]=k,t[1]=L,t[2]=F,t[3]=0,t[4]=V,t[5]=z,t[6]=G,t[7]=0,t[8]=H,t[9]=Z,t[10]=K,t[11]=0,t[12]=i[0]+E-(k*E+V*$+H*P),t[13]=i[1]+$-(L*E+z*$+Z*P),t[14]=i[2]+P-(F*E+G*$+K*P),t[15]=1,t}function Jke(t,e){const i=e[0],r=e[1],n=e[2],s=e[3],o=i+i,a=r+r,l=n+n,c=i*o,u=r*o,h=r*a,f=n*o,m=n*a,g=n*l,y=s*o,v=s*a,b=s*l;return t[0]=1-h-g,t[1]=u+b,t[2]=f-v,t[3]=0,t[4]=u-b,t[5]=1-c-g,t[6]=m+y,t[7]=0,t[8]=f+v,t[9]=m-y,t[10]=1-c-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Zke(t,e,i,r,n,s,o){const a=1/(i-e),l=1/(n-r),c=1/(s-o);return t[0]=2*s*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*s*l,t[6]=0,t[7]=0,t[8]=(i+e)*a,t[9]=(n+r)*l,t[10]=(o+s)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*s*2*c,t[15]=0,t}function Yke(t,e,i,r,n){const s=1/Math.tan(e/2);let o;return t[0]=s/i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,n!=null&&n!==1/0?(o=1/(r-n),t[10]=(n+r)*o,t[14]=2*n*r*o):(t[10]=-1,t[14]=-2*r),t}function Kke(t,e,i,r){const n=Math.tan(e.upDegrees*Math.PI/180),s=Math.tan(e.downDegrees*Math.PI/180),o=Math.tan(e.leftDegrees*Math.PI/180),a=Math.tan(e.rightDegrees*Math.PI/180),l=2/(o+a),c=2/(n+s);return t[0]=l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=-(o-a)*l*.5,t[9]=(n-s)*c*.5,t[10]=r/(i-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*i/(i-r),t[15]=0,t}function Xke(t,e,i,r,n,s,o){const a=1/(e-i),l=1/(r-n),c=1/(s-o);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+i)*a,t[13]=(n+r)*l,t[14]=(o+s)*c,t[15]=1,t}function Qke(t,e,i,r){const n=e[0],s=e[1],o=e[2];let a=n-i[0],l=s-i[1],c=o-i[2];const u=Bo();if(Math.abs(a)<u&&Math.abs(l)<u&&Math.abs(c)<u)return void bC(t);let h=1/Math.sqrt(a*a+l*l+c*c);a*=h,l*=h,c*=h;const f=r[0],m=r[1],g=r[2];let y=m*c-g*l,v=g*a-f*c,b=f*l-m*a;h=Math.sqrt(y*y+v*v+b*b),h?(h=1/h,y*=h,v*=h,b*=h):(y=0,v=0,b=0);let w=l*b-c*v,x=c*y-a*b,S=a*v-l*y;h=Math.sqrt(w*w+x*x+S*S),h?(h=1/h,w*=h,x*=h,S*=h):(w=0,x=0,S=0),t[0]=y,t[1]=w,t[2]=a,t[3]=0,t[4]=v,t[5]=x,t[6]=l,t[7]=0,t[8]=b,t[9]=S,t[10]=c,t[11]=0,t[12]=-(y*n+v*s+b*o),t[13]=-(w*n+x*s+S*o),t[14]=-(a*n+l*s+c*o),t[15]=1}function ePe(t,e,i,r){const n=e[0],s=e[1],o=e[2],a=r[0],l=r[1],c=r[2];let u=n-i[0],h=s-i[1],f=o-i[2],m=u*u+h*h+f*f;m>0&&(m=1/Math.sqrt(m),u*=m,h*=m,f*=m);let g=l*f-c*h,y=c*u-a*f,v=a*h-l*u;return m=g*g+y*y+v*v,m>0&&(m=1/Math.sqrt(m),g*=m,y*=m,v*=m),t[0]=g,t[1]=y,t[2]=v,t[3]=0,t[4]=h*v-f*y,t[5]=f*g-u*v,t[6]=u*y-h*g,t[7]=0,t[8]=u,t[9]=h,t[10]=f,t[11]=0,t[12]=n,t[13]=s,t[14]=o,t[15]=1,t}function tPe(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function iPe(t){return Math.sqrt(t[0]**2+t[1]**2+t[2]**2+t[3]**2+t[4]**2+t[5]**2+t[6]**2+t[7]**2+t[8]**2+t[9]**2+t[10]**2+t[11]**2+t[12]**2+t[13]**2+t[14]**2+t[15]**2)}function rPe(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t[4]=e[4]+i[4],t[5]=e[5]+i[5],t[6]=e[6]+i[6],t[7]=e[7]+i[7],t[8]=e[8]+i[8],t[9]=e[9]+i[9],t[10]=e[10]+i[10],t[11]=e[11]+i[11],t[12]=e[12]+i[12],t[13]=e[13]+i[13],t[14]=e[14]+i[14],t[15]=e[15]+i[15],t}function Vle(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t[4]=e[4]-i[4],t[5]=e[5]-i[5],t[6]=e[6]-i[6],t[7]=e[7]-i[7],t[8]=e[8]-i[8],t[9]=e[9]-i[9],t[10]=e[10]-i[10],t[11]=e[11]-i[11],t[12]=e[12]-i[12],t[13]=e[13]-i[13],t[14]=e[14]-i[14],t[15]=e[15]-i[15],t}function nPe(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*i,t[9]=e[9]*i,t[10]=e[10]*i,t[11]=e[11]*i,t[12]=e[12]*i,t[13]=e[13]*i,t[14]=e[14]*i,t[15]=e[15]*i,t}function sPe(t,e,i,r){return t[0]=e[0]+i[0]*r,t[1]=e[1]+i[1]*r,t[2]=e[2]+i[2]*r,t[3]=e[3]+i[3]*r,t[4]=e[4]+i[4]*r,t[5]=e[5]+i[5]*r,t[6]=e[6]+i[6]*r,t[7]=e[7]+i[7]*r,t[8]=e[8]+i[8]*r,t[9]=e[9]+i[9]*r,t[10]=e[10]+i[10]*r,t[11]=e[11]+i[11]*r,t[12]=e[12]+i[12]*r,t[13]=e[13]+i[13]*r,t[14]=e[14]+i[14]*r,t[15]=e[15]+i[15]*r,t}function oPe(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function aPe(t,e){if(t===e)return!0;const i=t[0],r=t[1],n=t[2],s=t[3],o=t[4],a=t[5],l=t[6],c=t[7],u=t[8],h=t[9],f=t[10],m=t[11],g=t[12],y=t[13],v=t[14],b=t[15],w=e[0],x=e[1],S=e[2],I=e[3],T=e[4],C=e[5],E=e[6],$=e[7],P=e[8],k=e[9],L=e[10],F=e[11],V=e[12],z=e[13],G=e[14],H=e[15],Z=Bo();return Math.abs(i-w)<=Z*Math.max(1,Math.abs(i),Math.abs(w))&&Math.abs(r-x)<=Z*Math.max(1,Math.abs(r),Math.abs(x))&&Math.abs(n-S)<=Z*Math.max(1,Math.abs(n),Math.abs(S))&&Math.abs(s-I)<=Z*Math.max(1,Math.abs(s),Math.abs(I))&&Math.abs(o-T)<=Z*Math.max(1,Math.abs(o),Math.abs(T))&&Math.abs(a-C)<=Z*Math.max(1,Math.abs(a),Math.abs(C))&&Math.abs(l-E)<=Z*Math.max(1,Math.abs(l),Math.abs(E))&&Math.abs(c-$)<=Z*Math.max(1,Math.abs(c),Math.abs($))&&Math.abs(u-P)<=Z*Math.max(1,Math.abs(u),Math.abs(P))&&Math.abs(h-k)<=Z*Math.max(1,Math.abs(h),Math.abs(k))&&Math.abs(f-L)<=Z*Math.max(1,Math.abs(f),Math.abs(L))&&Math.abs(m-F)<=Z*Math.max(1,Math.abs(m),Math.abs(F))&&Math.abs(g-V)<=Z*Math.max(1,Math.abs(g),Math.abs(V))&&Math.abs(y-z)<=Z*Math.max(1,Math.abs(y),Math.abs(z))&&Math.abs(v-G)<=Z*Math.max(1,Math.abs(v),Math.abs(G))&&Math.abs(b-H)<=Z*Math.max(1,Math.abs(b),Math.abs(H))}function lPe(t){const e=Bo(),i=t[0],r=t[1],n=t[2],s=t[4],o=t[5],a=t[6],l=t[8],c=t[9],u=t[10];return Math.abs(1-(i*i+s*s+l*l))<=e&&Math.abs(1-(r*r+o*o+c*c))<=e&&Math.abs(1-(n*n+a*a+u*u))<=e}function cPe(t){return t[0]===1&&t[1]===0&&t[2]===0&&t[4]===0&&t[5]===1&&t[6]===0&&t[8]===0&&t[9]===0&&t[10]===1}const uPe=TU,dPe=Vle;Object.freeze(Object.defineProperty({__proto__:null,add:rPe,adjoint:$ke,copy:sT,determinant:Ake,equals:aPe,exactEquals:oPe,frob:iPe,fromQuat:Jke,fromQuat2:jke,fromRotation:CU,fromRotationTranslation:Nle,fromRotationTranslationScale:qke,fromRotationTranslationScaleOrigin:Wke,fromScaling:Dke,fromTranslation:Dle,fromXRotation:Nke,fromYRotation:Vke,fromZRotation:zke,frustum:Zke,getRotation:Hke,getScaling:Gke,getTranslation:Uke,hasIdentityRotation:cPe,identity:bC,invert:fL,invertOrIdentity:Mke,isOrthoNormal:lPe,lookAt:Qke,mul:uPe,multiply:TU,multiplyScalar:nPe,multiplyScalarAndAdd:sPe,ortho:Xke,perspective:Yke,perspectiveFromFieldOfView:Kke,rotate:Oke,rotateX:Lke,rotateY:Rke,rotateZ:Fke,scale:Pke,set:Sg,str:tPe,sub:dPe,subtract:Vle,targetTo:ePe,translate:kke,transpose:ac},Symbol.toStringTag,{value:"Module"}));let L3,Y=null;function EU(){return!!Y}function hPe(){return!!ee("esri-wasm")}function zle(){return L3||(L3=W(()=>import("./pe-wasm-526695ca.js"),[],import.meta.url).then(t=>t.p).then(({default:t})=>t({locateFile:e=>Tt(`esri/geometry/support/${e}`)})).then(t=>{Ble(t)}),L3)}var oT,Ut,Ka;(function(t){function e(s,o,a){Y.ensureCache.prepare();const l=C0(a),c=a===l,u=Y.ensureFloat64(l),h=Y._pe_geog_to_proj(Y.getPointer(s),o,u);return h&&_m(a,o,u,c),h}function i(s,o,a,l){switch(l){case Ut.PE_TRANSFORM_P_TO_G:return r(s,o,a);case Ut.PE_TRANSFORM_G_TO_P:return e(s,o,a)}return 0}function r(s,o,a){return n(s,o,a,0)}function n(s,o,a,l){Y.ensureCache.prepare();const c=C0(a),u=a===c,h=Y.ensureFloat64(c),f=Y._pe_proj_to_geog_center(Y.getPointer(s),o,h,l);return f&&_m(a,o,h,u),f}t.geogToProj=e,t.projGeog=i,t.projToGeog=r,t.projToGeogCenter=n})(oT||(oT={})),function(t){function e(){t.PE_BUFFER_MAX=Y.PeDefs.prototype.PE_BUFFER_MAX,t.PE_NAME_MAX=Y.PeDefs.prototype.PE_NAME_MAX,t.PE_MGRS_MAX=Y.PeDefs.prototype.PE_MGRS_MAX,t.PE_USNG_MAX=Y.PeDefs.prototype.PE_USNG_MAX,t.PE_DD_MAX=Y.PeDefs.prototype.PE_DD_MAX,t.PE_DDM_MAX=Y.PeDefs.prototype.PE_DDM_MAX,t.PE_DMS_MAX=Y.PeDefs.prototype.PE_DMS_MAX,t.PE_UTM_MAX=Y.PeDefs.prototype.PE_UTM_MAX,t.PE_PARM_MAX=Y.PeDefs.prototype.PE_PARM_MAX,t.PE_TYPE_NONE=Y.PeDefs.prototype.PE_TYPE_NONE,t.PE_TYPE_GEOGCS=Y.PeDefs.prototype.PE_TYPE_GEOGCS,t.PE_TYPE_PROJCS=Y.PeDefs.prototype.PE_TYPE_PROJCS,t.PE_TYPE_GEOGTRAN=Y.PeDefs.prototype.PE_TYPE_GEOGTRAN,t.PE_TYPE_COORDSYS=Y.PeDefs.prototype.PE_TYPE_COORDSYS,t.PE_TYPE_UNIT=Y.PeDefs.prototype.PE_TYPE_UNIT,t.PE_TYPE_LINUNIT=Y.PeDefs.prototype.PE_TYPE_LINUNIT,t.PE_STR_OPTS_NONE=Y.PeDefs.prototype.PE_STR_OPTS_NONE,t.PE_STR_AUTH_NONE=Y.PeDefs.prototype.PE_STR_AUTH_NONE,t.PE_STR_AUTH_TOP=Y.PeDefs.prototype.PE_STR_AUTH_TOP,t.PE_STR_NAME_CANON=Y.PeDefs.prototype.PE_STR_NAME_CANON,t.PE_PARM_X0=Y.PeDefs.prototype.PE_PARM_X0,t.PE_PARM_ND=Y.PeDefs.prototype.PE_PARM_ND,t.PE_TRANSFORM_1_TO_2=Y.PeDefs.prototype.PE_TRANSFORM_1_TO_2,t.PE_TRANSFORM_2_TO_1=Y.PeDefs.prototype.PE_TRANSFORM_2_TO_1,t.PE_TRANSFORM_P_TO_G=Y.PeDefs.prototype.PE_TRANSFORM_P_TO_G,t.PE_TRANSFORM_G_TO_P=Y.PeDefs.prototype.PE_TRANSFORM_G_TO_P,t.PE_HORIZON_RECT=Y.PeDefs.prototype.PE_HORIZON_RECT,t.PE_HORIZON_POLY=Y.PeDefs.prototype.PE_HORIZON_POLY,t.PE_HORIZON_LINE=Y.PeDefs.prototype.PE_HORIZON_LINE,t.PE_HORIZON_DELTA=Y.PeDefs.prototype.PE_HORIZON_DELTA}t.init=e}(Ut||(Ut={})),function(t){const e={},i={},r=m=>{if(m){const g=m.getType();switch(g){case Ut.PE_TYPE_GEOGCS:m=Y.castObject(m,Y.PeGeogcs);break;case Ut.PE_TYPE_PROJCS:m=Y.castObject(m,Y.PeProjcs);break;case Ut.PE_TYPE_GEOGTRAN:m=Y.castObject(m,Y.PeGeogtran);break;default:g&Ut.PE_TYPE_UNIT&&(m=Y.castObject(m,Y.PeUnit))}}return m};function n(){Y.PeFactory.prototype.initialize(null)}function s(m){return o(Ut.PE_TYPE_COORDSYS,m)}function o(m,g){let y=null,v=e[m];if(v||(v={},e[m]=v),v.hasOwnProperty(String(g)))y=v[g];else{const b=Y.PeFactory.prototype.factoryByType(m,g);Y.compare(b,Y.NULL)||(y=b,v[g]=y)}return y=r(y),y}function a(m,g){let y=null,v=i[m];if(v||(v={},i[m]=v),v.hasOwnProperty(g))y=v[g];else{const b=Y.PeFactory.prototype.fromString(m,g);Y.compare(b,Y.NULL)||(y=b,v[g]=y)}return y=r(y),y}function l(m){return o(Ut.PE_TYPE_GEOGCS,m)}function c(m){return o(Ut.PE_TYPE_GEOGTRAN,m)}function u(m){return Y.PeFactory.prototype.getCode(m)}function h(m){return o(Ut.PE_TYPE_PROJCS,m)}function f(m){return o(Ut.PE_TYPE_UNIT,m)}t.initialize=n,t.coordsys=s,t.factoryByType=o,t.fromString=a,t.geogcs=l,t.geogtran=c,t.getCode=u,t.projcs=h,t.unit=f}(Ka||(Ka={}));let jle=null;var rP,_4,nP,b4,sP,w4,oP,aT,x4;function Ble(t){function e(s,o,a){s[o]=a(s[o])}Y=t,Ut.init(),rP.init(),sP.init(),oP.init(),aT.init(),jle=class extends Y.PeGCSExtent{destroy(){Y.destroy(this)}};const i=[Y.PeDatum,Y.PeGeogcs,Y.PeGeogtran,Y.PeObject,Y.PeParameter,Y.PePrimem,Y.PeProjcs,Y.PeSpheroid,Y.PeUnit];for(const s of i)e(s.prototype,"getName",o=>function(){return o.call(this,new Array(Ut.PE_NAME_MAX))});for(const s of[Y.PeGeogtran,Y.PeProjcs])e(s.prototype,"getParameters",o=>function(){const a=new Array(Ut.PE_PARM_MAX);let l=o.call(this);for(let c=0;c<a.length;c++){const u=Y.getValue(l,"*");a[c]=u?Y.wrapPointer(u,Y.PeParameter):null,l+=Int32Array.BYTES_PER_ELEMENT}return a});e(Y.PeHorizon.prototype,"getCoord",s=>function(){const o=this.getSize();if(!o)return null;const a=[];return _m(a,o,s.call(this)),a}),e(Y.PeGTlistExtendedEntry.prototype,"getEntries",s=>{const o=Y._pe_getPeGTlistExtendedGTsSize();return function(){let a=null;const l=s.call(this);if(!Y.compare(l,Y.NULL)){a=[l];const c=this.getSteps();if(c>1){const u=Y.getPointer(l);for(let h=1;h<c;h++)a.push(Y.wrapPointer(u+o*h,Y.PeGTlistExtendedGTs))}}return a}});const r=Y._pe_getPeHorizonSize(),n=s=>function(){let o=this._cache;if(o||(o=new Map,this._cache=o),o.has(s))return o.get(s);let a=null;const l=s.call(this);if(!Y.compare(l,Y.NULL)){a=[l];const c=l.getNump();if(c>1){const u=Y.getPointer(l);for(let h=1;h<c;h++)a.push(Y.wrapPointer(u+r*h,Y.PeHorizon))}}return o.set(s,a),a};e(Y.PeProjcs.prototype,"horizonGcsGenerate",n),e(Y.PeProjcs.prototype,"horizonPcsGenerate",n),Y.PeObject.prototype.toString=function(s=Ut.PE_STR_OPTS_NONE){Y.ensureCache.prepare();const o=Y.getPointer(this),a=Y.ensureInt8(new Array(Ut.PE_BUFFER_MAX));return Y.UTF8ToString(Y._pe_object_to_string_ext(o,s,a))}}function Yd(t){if(!t)return;const e=Y.getClass(t);if(!e)return;const i=Y.getCache(e);if(!i)return;const r=Y.getPointer(t);r&&delete i[r]}function AE(t,e){const i=[],r=new Array(e);for(let n=0;n<t;n++)i.push(Y.ensureInt8(r));return i}function C0(t){let e;return Array.isArray(t[0])?(e=[],t.forEach(i=>{e.push(i[0],i[1])})):e=t,e}function _m(t,e,i,r=!1){if(r)for(let n=0;n<2*e;n++)t[n]=Y.getValue(i+n*Float64Array.BYTES_PER_ELEMENT,"double");else{const n=t.length===0;for(let s=0;s<e;s++)n&&(t[s]=new Array(2)),t[s][0]=Y.getValue(i,"double"),t[s][1]=Y.getValue(i+Float64Array.BYTES_PER_ELEMENT,"double"),i+=2*Float64Array.BYTES_PER_ELEMENT}}(function(t){let e;function i(){t.PE_GTLIST_OPTS_COMMON=Y.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON,e=Y._pe_getPeGTlistExtendedEntrySize()}function r(n,s,o,a,l,c){let u=null;const h=new Y.PeInteger(c);try{const f=Y.PeGTlistExtended.prototype.getGTlist(n,s,o,a,l,h);if((c=h.val)&&(u=[f],c>1)){const m=Y.getPointer(f);for(let g=1;g<c;g++)u.push(Y.wrapPointer(m+e*g,Y.PeGTlistExtendedEntry))}}finally{Y.destroy(h)}return u}t.init=i,t.getGTlist=r})(rP||(rP={})),function(t){function e(i){if(i&&i.length){for(const r of i)Yd(r),r.getEntries().forEach(n=>{Yd(n);const s=n.getGeogtran();Yd(s),s.getParameters().forEach(Yd),[s.getGeogcs1(),s.getGeogcs2()].forEach(o=>{Yd(o);const a=o.getDatum();Yd(a),Yd(a.getSpheroid()),Yd(o.getPrimem()),Yd(o.getUnit())})});Y.PeGTlistExtendedEntry.prototype.Delete(i[0])}}t.destroy=e}(_4||(_4={})),function(t){function e(i,r,n,s,o){Y.ensureCache.prepare();const a=C0(n),l=n===a,c=Y.ensureFloat64(a);let u=0;s&&(u=Y.ensureFloat64(s));const h=Y._pe_geog_to_geog(Y.getPointer(i),r,c,u,o);return h&&_m(n,r,c,l),h}t.geogToGeog=e}(nP||(nP={})),function(t){const e=(c,u,h,f,m,g)=>{let y,v;switch(Y.ensureCache.prepare(),c){case"dd":y=Y._pe_geog_to_dd,v=Ut.PE_DD_MAX;break;case"ddm":y=Y._pe_geog_to_ddm,v=Ut.PE_DDM_MAX;break;case"dms":y=Y._pe_geog_to_dms,v=Ut.PE_DMS_MAX}let b=0;u&&(b=Y.getPointer(u));const w=C0(f),x=Y.ensureFloat64(w),S=AE(h,v),I=y(b,h,x,m,Y.ensureInt32(S));if(I)for(let T=0;T<h;T++)g[T]=Y.UTF8ToString(S[T]);return I},i=(c,u,h,f,m)=>{let g;switch(Y.ensureCache.prepare(),c){case"dd":g=Y._pe_dd_to_geog;break;case"ddm":g=Y._pe_ddm_to_geog;break;case"dms":g=Y._pe_dms_to_geog}let y=0;u&&(y=Y.getPointer(u));const v=f.map(S=>Y.ensureString(S)),b=Y.ensureInt32(v),w=Y.ensureFloat64(new Array(2*h)),x=g(y,h,b,w);return x&&_m(m,h,w),x};function r(c,u,h,f,m){return e("dms",c,u,h,f,m)}function n(c,u,h,f){return i("dms",c,u,h,f)}function s(c,u,h,f,m){return e("ddm",c,u,h,f,m)}function o(c,u,h,f){return i("ddm",c,u,h,f)}function a(c,u,h,f,m){return e("dd",c,u,h,f,m)}function l(c,u,h,f){return i("dd",c,u,h,f)}t.geogToDms=r,t.dmsToGeog=n,t.geogToDdm=s,t.ddmToGeog=o,t.geogToDd=a,t.ddToGeog=l}(b4||(b4={})),function(t){function e(){t.PE_MGRS_STYLE_NEW=Y.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW,t.PE_MGRS_STYLE_OLD=Y.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD,t.PE_MGRS_STYLE_AUTO=Y.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO,t.PE_MGRS_180_ZONE_1_PLUS=Y.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS,t.PE_MGRS_ADD_SPACES=Y.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES}function i(n,s,o,a,l,c,u){Y.ensureCache.prepare();let h=0;n&&(h=Y.getPointer(n));const f=C0(o),m=Y.ensureFloat64(f),g=AE(s,Ut.PE_MGRS_MAX),y=Y.ensureInt32(g),v=Y._pe_geog_to_mgrs_extended(h,s,m,a,l,c,y);if(v)for(let b=0;b<s;b++)u[b]=Y.UTF8ToString(g[b]);return v}function r(n,s,o,a,l){Y.ensureCache.prepare();let c=0;n&&(c=Y.getPointer(n));const u=o.map(g=>Y.ensureString(g)),h=Y.ensureInt32(u),f=Y.ensureFloat64(new Array(2*s)),m=Y._pe_mgrs_to_geog_extended(c,s,h,a,f);return m&&_m(l,s,f),m}t.init=e,t.geogToMgrsExtended=i,t.mgrsToGeogExtended=r}(sP||(sP={})),function(t){function e(r,n,s,o,a,l,c){Y.ensureCache.prepare();let u=0;r&&(u=Y.getPointer(r));const h=C0(s),f=Y.ensureFloat64(h),m=AE(n,Ut.PE_MGRS_MAX),g=Y.ensureInt32(m),y=Y._pe_geog_to_usng(u,n,f,o,a,l,g);if(y)for(let v=0;v<n;v++)c[v]=Y.UTF8ToString(m[v]);return y}function i(r,n,s,o){Y.ensureCache.prepare();let a=0;r&&(a=Y.getPointer(r));const l=s.map(f=>Y.ensureString(f)),c=Y.ensureInt32(l),u=Y.ensureFloat64(new Array(2*n)),h=Y._pe_usng_to_geog(a,n,c,u);return h&&_m(o,n,u),h}t.geogToUsng=e,t.usngToGeog=i}(w4||(w4={})),function(t){function e(){t.PE_UTM_OPTS_NONE=Y.PeNotationUtm.prototype.PE_UTM_OPTS_NONE,t.PE_UTM_OPTS_ADD_SPACES=Y.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES,t.PE_UTM_OPTS_NS=Y.PeNotationUtm.prototype.PE_UTM_OPTS_NS}function i(n,s,o,a,l){Y.ensureCache.prepare();let c=0;n&&(c=Y.getPointer(n));const u=C0(o),h=Y.ensureFloat64(u),f=AE(s,Ut.PE_UTM_MAX),m=Y.ensureInt32(f),g=Y._pe_geog_to_utm(c,s,h,a,m);if(g)for(let y=0;y<s;y++)l[y]=Y.UTF8ToString(f[y]);return g}function r(n,s,o,a,l){Y.ensureCache.prepare();let c=0;n&&(c=Y.getPointer(n));const u=o.map(g=>Y.ensureString(g)),h=Y.ensureInt32(u),f=Y.ensureFloat64(new Array(2*s)),m=Y._pe_utm_to_geog(c,s,h,a,f);return m&&_m(l,s,f),m}t.init=e,t.geogToUtm=i,t.utmToGeog=r}(oP||(oP={})),function(t){const e=new Map;function i(){t.PE_PCSINFO_OPTION_NONE=Y.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE,t.PE_PCSINFO_OPTION_DOMAIN=Y.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN,t.PE_POLE_OUTSIDE_BOUNDARY=Y.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY,t.PE_POLE_POINT=Y.PePCSInfo.prototype.PE_POLE_POINT}function r(n,s=t.PE_PCSINFO_OPTION_DOMAIN){let o=null,a=null;return e.has(n)&&(a=e.get(n),a[s]&&(o=a[s])),o||(o=Y.PePCSInfo.prototype.generate(n,s),a||(a=[],e.set(n,a)),a[s]=o),o}t.init=i,t.generate=r}(aT||(aT={})),function(t){function e(){return Y.PeVersion.prototype.version_string()}t.versionString=e}(x4||(x4={}));const pPe=Object.freeze(Object.defineProperty({__proto__:null,get PeCSTransformations(){return oT},get PeDefs(){return Ut},get PeFactory(){return Ka},get PeGCSExtent(){return jle},get PeGTTransformations(){return nP},get PeGTlistExtended(){return rP},get PeGTlistExtendedEntry(){return _4},get PeNotationDms(){return b4},get PeNotationMgrs(){return sP},get PeNotationUsng(){return w4},get PeNotationUtm(){return oP},get PePCSInfo(){return aT},get PeVersion(){return x4},_init:Ble,get _pe(){return Y},isLoaded:EU,isSupported:hPe,load:zle},Symbol.toStringTag,{value:"Module"})),ma=Math.PI/180,fPe=/SPHEROID\[([^\]]+)]/i,Zp=Ti.radius,xc=Ti.eccentricitySquared,mPe={a1:Zp*xc,a2:Zp*xc*Zp*xc,a3:Zp*xc*xc/2,a4:Zp*xc*Zp*xc*2.5,a5:Zp*xc+Zp*xc*xc/2,a6:1-xc},gPe={4267:{a:63782064e-1,f:1/294.9786982},4269:{a:6378137,f:1/298.257222101},4326:{a:Ti.radius,f:Ti.flattening},104900:{a:2439700,f:0},104901:{a:6051e3,f:0},104902:{a:6051800,f:0},104903:{a:ng.radius,f:ng.flattening},104904:{a:3393400,f:1/192.0430107526882},104905:{a:np.radius,f:np.flattening},104906:{a:6200,f:0},104907:{a:11100,f:0},104908:{a:71492e3,f:.06487439154031222},104909:{a:8200,f:0},104910:{a:83500,f:0},104911:{a:1e4,f:0},104912:{a:2409300,f:0},104913:{a:15e3,f:0},104914:{a:4e4,f:0},104915:{a:1562090,f:0},104916:{a:2632345,f:0},104917:{a:85e3,f:0},104918:{a:1821460,f:0},104919:{a:5e3,f:0},104920:{a:12e3,f:0},104921:{a:3e4,f:3},104922:{a:18e3,f:0},104923:{a:14e3,f:0},104924:{a:49300,f:0},104925:{a:60268e3,f:1/10.2079945799458},104926:{a:16e3,f:0},104927:{a:9500,f:0},104928:{a:56e4,f:0},104929:{a:249400,f:0},104930:{a:59500,f:0},104931:{a:16e3,f:0},104932:{a:133e3,f:0},104933:{a:718e3,f:0},104934:{a:888e3,f:0},104935:{a:1986300,f:0},104936:{a:1e4,f:0},104937:{a:41900,f:0},104938:{a:11e4,f:0},104939:{a:50100,f:0},104940:{a:764e3,f:0},104941:{a:11e3,f:0},104942:{a:529800,f:0},104943:{a:2575e3,f:0},104944:{a:25559e3,f:1/43.61604095563141},104945:{a:578900,f:0},104946:{a:33e3,f:0},104947:{a:21e3,f:0},104948:{a:13e3,f:0},104949:{a:31e3,f:0},104950:{a:27e3,f:0},104951:{a:42e3,f:0},104952:{a:235800,f:0},104953:{a:761400,f:0},104954:{a:15e3,f:0},104955:{a:54e3,f:0},104956:{a:77e3,f:0},104957:{a:27e3,f:0},104958:{a:788900,f:0},104959:{a:584700,f:0},104960:{a:24764e3,f:.01708124697141011},104961:{a:74e3,f:0},104962:{a:79e3,f:0},104963:{a:104e3,f:.14423076923076922},104964:{a:29e3,f:0},104965:{a:17e4,f:0},104966:{a:208e3,f:0},104967:{a:4e4,f:0},104968:{a:1352600,f:0},104969:{a:1195e3,f:0},104970:{a:593e3,f:0},104971:{a:np.radius,f:0},104972:{a:47e4,f:0},104973:{a:255e3,f:0},104974:{a:2439400,f:0}};let kE=0,R3=class S4{static fromGE(e){const i=new S4;return i._wkt=e.wkt,i._wkid=e.wkid,i._isInverse=e.isInverse,i}constructor(e){this.uid=kE++,e?(this._wkt=e.wkt!=null?e.wkt:null,this._wkid=e.wkid!=null?e.wkid:-1,this._isInverse=e.isInverse!=null&&e.isInverse===!0):(this._wkt=null,this._wkid=-1,this._isInverse=!1)}get wkt(){return this._wkt}set wkt(e){this._wkt=e,this.uid=kE++}get wkid(){return this._wkid}set wkid(e){this._wkid=e,this.uid=kE++}get isInverse(){return this._isInverse}set isInverse(e){this._isInverse=e,this.uid=kE++}getInverse(){const e=new S4;return e._wkt=this.wkt,e._wkid=this._wkid,e._isInverse=!this.isInverse,e}},aP=class zS{static cacheKey(e,i){return[e.wkid!==void 0&&e.wkid!==null?e.wkid.toString():"-1",e.wkt!==void 0&&e.wkt!==null?e.wkt.toString():"",i.wkid!==void 0&&i.wkid!==null?i.wkid.toString():"-1",i.wkt!==void 0&&i.wkt!==null?i.wkt.toString():""].join(",")}static fromGE(e){const i=new zS;let r="";for(const n of e.steps){const s=R3.fromGE(n);i.steps.push(s),r+=s.uid.toString()+","}return i._cachedProjection={},i._gtlistentry=null,i._chain=r,i}constructor(e){if(this.steps=[],this._cachedProjection={},this._chain="",this._gtlistentry=null,e&&e.steps)for(const i of e.steps)i instanceof R3?this.steps.push(i):this.steps.push(new R3({wkid:i.wkid,wkt:i.wkt,isInverse:i.isInverse}))}getInverse(){const e=new zS;e.steps=[];for(let i=this.steps.length-1;i>=0;i--){const r=this.steps[i];e.steps.push(r.getInverse())}return e}getGTListEntry(){let e="";for(const i of this.steps)e+=i.uid.toString()+",";return e!==this._chain&&(this._gtlistentry=null,this._cachedProjection={},this._chain=e),this._gtlistentry}assignCachedGe(e,i,r){this._cachedProjection[zS.cacheKey(e,i)]=r}getCachedGeTransformation(e,i){let r="";for(const s of this.steps)r+=s.uid.toString()+",";r!==this._chain&&(this._gtlistentry=null,this._cachedProjection={},this._chain=r);const n=this._cachedProjection[zS.cacheKey(e,i)];return n===void 0?null:n}};function Ule(t,e,i){if(e==null||i==null||i.vcsWkid||Pr(e,i))return null;const r=Iu(e)/Iu(i);if(r===1)return null;switch(t){case"point":case"esriGeometryPoint":return n=>yPe(n,r);case"polyline":case"esriGeometryPolyline":return n=>_Pe(n,r);case"polygon":case"esriGeometryPolygon":return n=>vPe(n,r);case"multipoint":case"esriGeometryMultipoint":return n=>bPe(n,r);case"extent":case"esriGeometryEnvelope":return n=>wPe(n,r);default:return null}}function yPe(t,e){t&&t.z!=null&&(t.z*=e)}function vPe(t,e){if(t)for(const i of t.rings)for(const r of i)r.length>2&&(r[2]*=e)}function _Pe(t,e){if(t)for(const i of t.paths)for(const r of i)r.length>2&&(r[2]*=e)}function bPe(t,e){if(t)for(const i of t.points)i.length>2&&(i[2]*=e)}function wPe(t,e){t&&t.zmin!=null&&t.zmax!=null&&(t.zmin*=e,t.zmax*=e)}let vu=null,lg=null,eI=null,tA={};const Gle=new qO;function pc(){return!!vu&&EU()}function Eu(t){return eI==null&&(eI=Promise.all([zle(),W(()=>import("./geometryEngineBase-eec52f2a.js"),[],import.meta.url).then(e=>e.g),W(()=>import("./hydrated-1be60493.js"),[],import.meta.url)])),eI.then(([,e,{hydratedAdapter:i}])=>{_t(t),lg=i,vu=e.default,vu._enableProjection(pPe),Gle.notify()})}function Ir(t,e,i=null,r=null){return Array.isArray(t)?t.length===0?[]:I4(lg,t,t[0].spatialReference,e,i,r):I4(lg,[t],t.spatialReference,e,i,r)[0]}function I4(t,e,i,r,n=null,s=null){if(i==null||r==null)return e;if(lc(i,r,n))return e.map(o=>Wle(o,i,r));if(n==null){const o=aP.cacheKey(i,r);tA[o]!==void 0?n=tA[o]:((n=lP(i,r,void 0))==null&&(n=new aP),tA[o]=n)}if(vu==null||t==null)throw new mL;return s!=null?vu._project(t,e,i,r,n,s):vu._project(t,e,i,r,n)}function xPe(t,e){const i=Hle([t],e);return i.pending!=null?{pending:i.pending,geometry:null}:i.geometries!=null?{pending:null,geometry:i.geometries[0]}:{pending:null,geometry:null}}function Hle(t,e){if(!pc()){for(const i of t)if(i!=null&&!Pr(i.spatialReference,e)&&hs(i.spatialReference)&&hs(e)&&!lc(i.spatialReference,e))return Ke(Gle),{pending:Eu(),geometries:null}}return{pending:null,geometries:t.map(i=>i==null?null:Pr(i.spatialReference,e)?i:hs(i.spatialReference)&&hs(e)?qle(i,e):null)}}function lP(t,e,i=null){if(t==null||e==null)return null;if(vu==null||lg==null)throw new mL;const r=vu._getTransformation(lg,t,e,i,i==null?void 0:i.spatialReference);return r!==null?aP.fromGE(r):null}function SPe(t,e,i=null){if(vu==null||lg==null)throw new mL;const r=vu._getTransformationBySuitability(lg,t,e,i,i==null?void 0:i.spatialReference);if(r!==null){const n=[];for(const s of r)n.push(aP.fromGE(s));return n}return[]}let mL=class extends N{constructor(){super("projection:not-loaded","projection engine not fully loaded yet, please call load()")}};var B;function IPe(){vu=null,lg=null,eI=null,tA={}}(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.SPHERICAL_ECEF=1]="SPHERICAL_ECEF",t[t.WGS84=2]="WGS84",t[t.WEB_MERCATOR=3]="WEB_MERCATOR",t[t.WGS84_ECEF=4]="WGS84_ECEF",t[t.CGCS2000=5]="CGCS2000",t[t.WGS84_COMPARABLE_LON_LAT=6]="WGS84_COMPARABLE_LON_LAT",t[t.SPHERICAL_MARS_PCPF=7]="SPHERICAL_MARS_PCPF",t[t.GCSMARS2000=8]="GCSMARS2000",t[t.SPHERICAL_MOON_PCPF=9]="SPHERICAL_MOON_PCPF",t[t.GCSMOON2000=10]="GCSMOON2000",t[t.LON_LAT=11]="LON_LAT",t[t.PLATE_CARREE=12]="PLATE_CARREE"})(B||(B={}));const TPe={get loadPromise(){return eI}};function qle(t,e){try{const i=Ir(t,e);if(i==null)return null;"xmin"in t&&"xmin"in i&&(i.zmin=t.zmin,i.zmax=t.zmax);const r=Ule(i.type,t.spatialReference,e);return r!=null&&r(i),i}catch(i){if(!(i instanceof mL))throw i;return null}}function lc(t,e,i){return!i&&(!!Pr(t,e)||hs(t)&&hs(e)&&!!AU(t,e,PU))}async function cg(t,e,i,r){if(pc())return MH(r);if(Array.isArray(t)){for(const{source:n,dest:s,geographicTransformation:o}of t)if(!lc(n,s,o))return Eu(r)}else if(!lc(t,e,i))return Eu(r);return MH(r)}function CPe(t,e){switch(AU(t,e,PU)){case gi:return"copy3";case Am:return"wgs84ToSphericalECEF";case Tv:return"wgs84ToWebMercator";case $m:return"wgs84ToPlateCarree";case Pm:return"wgs84ToWGS84ECEF";case rv:return"webMercatorToWGS84";case ice:return"webMercatorToSphericalECEF";case rce:return"webMercatorToWGS84ECEF";case sce:return"webMercatorToPlateCarree";case Om:return"wgs84ECEFToWGS84";case lce:return"wgs84ECEFToSphericalECEF";case cce:return"wgs84ECEFToWebMercator";case km:return"sphericalECEFToWGS84";case oce:return"sphericalECEFToWebMercator";case A4:return"sphericalMarsPCPFToMars2000";case $4:return"sphericalMoonPCPFToMoon2000";case ace:return"sphericalECEFToWGS84ECEF";case M4:return"mars2000ToSphericalPCPF";case E4:return"moon2000ToSphericalPCPF";default:return null}}function Wle(t,e,i){return t?"x"in t?Jle(t,e,new fe,i,0):"xmin"in t?Xle(t,e,new Re,i,0):"rings"in t?Kle(t,e,new Zn,i,0):"paths"in t?Yle(t,e,new no,i,0):"points"in t?Zle(t,e,new Zm,i,0):null:null}function EPe(t,e,i=e.spatialReference,r=0){return i!=null&&t.spatialReference!=null&&Jle(t,t.spatialReference,e,i,r)!=null}function Jle(t,e,i,r,n){Ct[0]=t.x,Ct[1]=t.y;const s=t.z;return Ct[2]=s!==void 0?s:n,Mu(Ct,e,0,Ct,r,0,1)?(i.x=Ct[0],i.y=Ct[1],i.spatialReference=r,s===void 0?(i.z=void 0,i.hasZ=!1):(i.z=Ct[2],i.hasZ=!0),t.m===void 0?(i.m=void 0,i.hasM=!1):(i.m=t.m,i.hasM=!0),i):null}function MPe(t,e,i=e.spatialReference,r=0){return t.spatialReference!=null&&i!=null&&Zle(t,t.spatialReference,e,i,r)!=null}function Zle(t,e,i,r,n){const{points:s,hasZ:o,hasM:a}=t,l=[],c=s.length,u=[];for(const h of s)u.push(h[0],h[1],o?h[2]:n);if(!Mu(u,e,0,u,r,0,c))return null;for(let h=0;h<c;++h){const f=3*h,m=u[f],g=u[f+1];o&&a?l.push([m,g,u[f+2],s[h][3]]):o?l.push([m,g,u[f+2]]):a?l.push([m,g,s[h][2]]):l.push([m,g])}return i.points=l,i.spatialReference=r,i.hasZ=o,i.hasM=a,i}function $Pe(t,e,i=e.spatialReference,r=0){return t.spatialReference!=null&&i!=null&&Yle(t,t.spatialReference,e,i,r)!=null}function Yle(t,e,i,r,n){const{paths:s,hasZ:o,hasM:a}=t,l=[];return ece(s,o??!1,a??!1,e,l,r,n)?(i.paths=l,i.spatialReference=r,i.hasZ=o,i.hasM=a,i):null}function APe({hasZ:t,spatialReference:e,paths:i},r,n=0){const s=Ud(e,Y1),o=Kl[s][B.WGS84_COMPARABLE_LON_LAT];if(o==null)return!1;const a=t?l=>l:l=>Bi(Ct,l[0],l[1],n);for(const l of i){const c=[];for(const u of l){const h=[0,0,n];o(a(u),0,h,0),c.push(h)}r.push(c)}return!0}function kPe({hasZ:t,spatialReference:e,rings:i},r,n=0){const s=Ud(e,Y1),o=Kl[s][B.WGS84_COMPARABLE_LON_LAT];if(o==null)return!1;const a=t?l=>l:l=>Bi(Ct,l[0],l[1],n);for(const l of i){const c=[];for(const u of l){const h=[0,0,n];o(a(u),0,h,0),c.push(h)}r.push(c)}return!0}function PPe(t,e,i=e.spatialReference,r=0){return t.spatialReference!=null&&i!=null&&Kle(t,t.spatialReference,e,i,r)!=null}function Kle(t,e,i,r,n){const{rings:s,hasZ:o,hasM:a}=t,l=[];return ece(s,o??!1,a??!1,e,l,r,n)?(i.rings=l,i.spatialReference=r,i.hasZ=o,i.hasM=a,i):null}function OPe(t,e,i=e.spatialReference,r=0){return t.spatialReference!=null&&i!=null&&Xle(t,t.spatialReference,e,i,r)!=null}function Xle(t,e,i,r,n){const{xmin:s,ymin:o,xmax:a,ymax:l,hasZ:c,hasM:u}=t;return T4(s,o,c?t.zmin:n,e,Ct,r)?(i.xmin=Ct[0],i.ymin=Ct[1],c&&(i.zmin=Ct[2]),T4(a,l,c?t.zmax:n,e,Ct,r)?(i.xmax=Ct[0],i.ymax=Ct[1],c&&(i.zmax=Ct[2]),u&&(i.mmin=t.mmin,i.mmax=t.mmax),i.spatialReference=r,i):null):null}function LPe(t,e,i){if(e==null||i==null)return null;const r=new fe({spatialReference:i});return Mu(t,e,0,Ct,i,0,1)?(r.x=Ct[0],r.y=Ct[1],r.z=Ct[2],r):null}function RPe(t,e,i){return Mu(t,e,0,Ct,i.spatialReference,0,1)?(i.x=Ct[0],i.y=Ct[1],i.z=Ct[2],i):null}function FPe(t,e,i,r=0){Ct[0]=t.x,Ct[1]=t.y;const n=t.z;return Ct[2]=n!==void 0?n:r,Mu(Ct,t.spatialReference,0,e,i,0,1)}function T4(t,e,i,r,n,s){return zi[0]=t,zi[1]=e,zi[2]=i,Mu(zi,r,0,n,s,0,1)}function C4(t,e,i,r){return!(e==null||r==null||t.length<2)&&(t.length===2&&(zi[0]=t[0],zi[1]=t[1],zi[2]=0,t=zi),Mu(t,e,0,i,r,0,1))}function DPe(t,e){Ct[0]=t.x,Ct[1]=t.y;const i=t.z;return Ct[2]=i!==void 0?i:0,Qle(Ct,t.spatialReference,e)}function Qle(t,e,i){return NPe(t,e,i)}function NPe(t,e,i){if(e==null)return!1;const r=Ud(e,Y1),n=Kl[r][B.WGS84_COMPARABLE_LON_LAT];return n!=null&&(n(t,0,zi,0),i!==zi&&(i[0]=zi[0],i[1]=zi[1],i.length>2&&(i[2]=zi[2])),!0)}function Mu(t,e,i,r,n,s,o=1){const a=AU(e,n,PU);if(a==null)return!1;if(a===gi){if(t===r&&i===s)return!0;const c=i+3*o;for(let u=i,h=s;u<c;u++,h++)r[h]=t[u];return!0}const l=i+3*o;for(let c=i,u=s;c<l;c+=3,u+=3)a(t,c,r,u);return!0}function VPe(t,e,i,r,n){bi(Ct,t),Sr(PE,t,e),C4(Ct,i,Ct,n),C4(PE,i,PE,n),Ui(r,PE,Ct),Rs(r,r)}function ece(t,e,i,r,n,s,o=0){const a=new Array;for(const c of t)for(const u of c)a.push(u[0],u[1],e?u[2]:o);if(!Mu(a,r,0,a,s,0,a.length/3))return!1;let l=0;n.length=0;for(const c of t){const u=new Array;for(const h of c)e&&i?u.push([a[l++],a[l++],a[l++],h[3]]):e?u.push([a[l++],a[l++],a[l++]]):i?(u.push([a[l++],a[l++],h[2]]),l++):(u.push([a[l++],a[l++]]),l++);n.push(u)}return!0}function zPe(t,e,i,r){if(e==null||r==null)return!1;const n=uce(e,r,XPe);if(n.projector===gi)return i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],!0;if(n.projector==null)return!1;const{source:s,dest:o}=n;if(o.spatialReferenceId===B.WEB_MERCATOR){const a=Kl[s.spatialReferenceId][B.WGS84];return a!=null&&(a(t,0,eu,0),Tv(eu,0,i,0),i[3]=mW(eu[1],t[2],t[3],Ti.radius),!0)}if(s.spatialReferenceId!==B.WGS84&&s.spatialReferenceId!==B.CGCS2000||o.spatialReferenceId!==B.PLATE_CARREE){n.projector(t,0,i,0);const a=s.metersPerUnit??1,l=o.metersPerUnit??1;i[3]=t[3]*a/l}else{const a=Kl[s.spatialReferenceId][B.SPHERICAL_ECEF],l=Kl[B.SPHERICAL_ECEF][B.PLATE_CARREE];let c=t[3];a!=null&&l!=null&&(c=mW(t[1],t[2],t[3],Ti.radius)),n.projector(t,0,i,0),i[3]=c}return!0}function mW(t,e,i,r){const n=r+e;if(n<r/2||i>n)return Number.MAX_VALUE;const s=Math.abs(du*t)+Math.asin(i/n);return s>=Math.PI/2?Number.MAX_VALUE:i/Math.cos(s)}function jPe(t,e,i,r){return t!=null&&(Pr(e,r)?(RB(i,t),!0):(zi[0]=t[0],zi[1]=t[1],zi[2]=0,!!Mu(zi,e,0,zi,r,0,1)&&(i[0]=zi[0],i[1]=zi[1],zi[0]=t[2],zi[1]=t[3],zi[2]=0,!!Mu(zi,e,0,zi,r,0,1)&&(i[2]=zi[0],i[3]=zi[1],!0))))}function BPe(t,e,i,r){if(e==null||r==null)return!1;const n=Ud(e,Y1),s=Ud(r,dce);if(n===s&&n!==B.UNKNOWN||Pr(e,r))return i[0]=1,i[1]=1,i[2]=1,!0;if(n===B.SPHERICAL_ECEF){const o=vs(t),a=o/Math.sqrt(t[0]*t[0]+t[1]*t[1]),l=o/Ti.radius;if(s===B.WEB_MERCATOR)return i[0]=a*l,i[1]=a*l,i[2]=1,!0;if(s===B.WGS84||s===B.CGCS2000){const c=tI;return i[0]=c*a*l,i[1]=c*l,i[2]=1,!0}}else if(n===B.PLATE_CARREE){if(s===B.WGS84||s===B.CGCS2000)return i[0]=tI,i[1]=tI,i[2]=1,!0;if(s===B.WEB_MERCATOR){const o=t[1]/Ti.radius;return i[0]=1,i[1]=1/Math.cos(o),i[2]=1,!0}}return!1}function UPe(t,e,i,r){if(t==null||r==null)return!1;const n=Ud(t,Y1),s=Ud(r,dce);if(n===s&&!gW(s)&&(n!==B.UNKNOWN||Pr(t,r)))return Dle(i,e),!0;if(gW(s)){const o=Kl[n][B.LON_LAT],a=Kl[B.LON_LAT][s];return o!=null&&a!=null&&(o(e,0,eu,0),a(eu,0,Yp,0),MU(du*eu[0],du*eu[1],i),i[12]=Yp[0],i[13]=Yp[1],i[14]=Yp[2],!0)}if((s===B.WEB_MERCATOR||s===B.PLATE_CARREE)&&(n===B.WGS84||n===B.CGCS2000&&s===B.PLATE_CARREE||n===B.SPHERICAL_ECEF||n===B.WEB_MERCATOR)){const o=Kl[n][B.LON_LAT],a=Kl[B.LON_LAT][s];return o!=null&&a!=null&&(o(e,0,eu,0),a(eu,0,Yp,0),n===B.SPHERICAL_ECEF?tce(du*eu[0],du*eu[1],i):bC(i),i[12]=Yp[0],i[13]=Yp[1],i[14]=Yp[2],!0)}return!1}function gW(t){return t===B.SPHERICAL_ECEF||t===B.SPHERICAL_MARS_PCPF||t===B.SPHERICAL_MOON_PCPF}function MU(t,e,i){const r=Math.sin(t),n=Math.cos(t),s=Math.sin(e),o=Math.cos(e),a=i;return a[0]=-r,a[4]=-s*n,a[8]=o*n,a[12]=0,a[1]=n,a[5]=-s*r,a[9]=o*r,a[13]=0,a[2]=0,a[6]=o,a[10]=s,a[14]=0,a[3]=0,a[7]=0,a[11]=0,a[15]=1,a}function tce(t,e,i){return MU(t,e,i),ac(i,i),i}function Ud(t,e){return t?e.spatialReference===t?e.spatialReferenceId:(e.spatialReference=t,"metersPerUnit"in e&&(e.metersPerUnit=ti(t,1)),t.wkt===o2e.wkt?e.spatialReferenceId=B.SPHERICAL_ECEF:UI(t)?e.spatialReferenceId=B.WGS84:_v(t)?e.spatialReferenceId=B.WEB_MERCATOR:t2e(t)?e.spatialReferenceId=B.PLATE_CARREE:t.wkt===a2e.wkt?e.spatialReferenceId=B.WGS84_ECEF:t.wkid===vv.CGCS2000?e.spatialReferenceId=B.CGCS2000:t.wkt===Jne.wkt?e.spatialReferenceId=B.SPHERICAL_MARS_PCPF:t.wkt===Zne.wkt?e.spatialReferenceId=B.SPHERICAL_MOON_PCPF:uB(t)?e.spatialReferenceId=B.GCSMARS2000:hB(t)?e.spatialReferenceId=B.GCSMOON2000:e.spatialReferenceId=B.UNKNOWN):B.UNKNOWN}function gi(t,e,i,r){t!==i&&(i[r++]=t[e++],i[r++]=t[e++],i[r]=t[e])}function rv(t,e,i,r){i[r++]=o1*(t[e++]/Ti.radius),i[r++]=o1*(Math.PI/2-2*Math.atan(Math.exp(-t[e++]/Ti.radius))),i[r]=t[e]}function ice(t,e,i,r){rv(t,e,i,r),Am(i,r,i,r)}function rce(t,e,i,r){rv(t,e,i,r),Pm(i,r,i,r)}function nce(t,e,i,r,n){const s=.4999999*Math.PI,o=Pn(du*t[e+1],-s,s),a=Math.sin(o);i[r++]=du*t[e]*n.radius,i[r++]=n.halfSemiMajorAxis*Math.log((1+a)/(1-a)),i[r]=t[e+2]}function Tv(t,e,i,r){nce(t,e,i,r,Ti)}const yW=Ti.radius*Math.PI/180,tI=180/(Ti.radius*Math.PI);function $m(t,e,i,r){i[r]=t[e]*yW,i[r+1]=t[e+1]*yW,i[r+2]=t[e+2]}function H0(t,e,i,r){i[r]=t[e]*tI,i[r+1]=t[e+1]*tI,i[r+2]=t[e+2]}function sce(t,e,i,r){rv(t,e,i,r),$m(i,r,i,r)}function GPe(t,e,i,r){Om(t,e,i,r),$m(i,r,i,r)}function HPe(t,e,i,r){km(t,e,i,r),$m(i,r,i,r)}function qPe(t,e,i,r){H0(t,e,i,r),Am(i,r,i,r)}function WPe(t,e,i,r){H0(t,e,i,r),Tv(i,r,i,r)}function JPe(t,e,i,r){H0(t,e,i,r),Pm(i,r,i,r)}function ZPe(t){if(t==null)return!1;const e=Ud(t,Y1);return!!Kl[e][B.WGS84_COMPARABLE_LON_LAT]}function YPe(t,e,i,r){const n=Math.cos(i);t[0]=Math.cos(e)*n*r,t[1]=Math.sin(e)*n*r,t[2]=Math.sin(i)*r}function $U(t,e,i,r,n){const s=n+t[e+2],o=du*t[e+1],a=du*t[e],l=Math.cos(o);i[r++]=Math.cos(a)*l*s,i[r++]=Math.sin(a)*l*s,i[r]=Math.sin(o)*s}function E4(t,e,i,r){$U(t,e,i,r,ng.radius)}function M4(t,e,i,r){$U(t,e,i,r,np.radius)}function Am(t,e,i,r){$U(t,e,i,r,Ti.radius)}function gL(t,e,i,r,n){const s=t[e],o=t[e+1],a=t[e+2],l=Math.sqrt(s*s+o*o+a*a),c=Jse(a/(l===0?1:l)),u=Math.atan2(o,s);i[r++]=o1*u,i[r++]=o1*c,i[r]=l-n}function $4(t,e,i,r){gL(t,e,i,r,ng.radius)}function A4(t,e,i,r){gL(t,e,i,r,np.radius)}function km(t,e,i,r){gL(t,e,i,r,Ti.radius)}function oce(t,e,i,r){km(t,e,i,r),Tv(i,r,i,r)}function ace(t,e,i,r){km(t,e,i,r),Pm(i,r,i,r)}function KPe(t,e,i,r,n){const s=du*t[e],o=du*t[e+1],a=t[e+2],l=Math.sin(o),c=Math.cos(o),u=n.radius/Math.sqrt(1-n.eccentricitySquared*l*l);i[r++]=(u+a)*c*Math.cos(s),i[r++]=(u+a)*c*Math.sin(s),i[r++]=(u*(1-n.eccentricitySquared)+a)*l}function Pm(t,e,i,r){KPe(t,e,i,r,Ti)}function Om(t,e,i,r){const n=mPe,s=t[e],o=t[e+1],a=t[e+2];let l,c,u,h,f,m,g,y,v,b,w,x,S,I,T,C,E,$,P,k,L;l=Math.abs(a),c=s*s+o*o,u=Math.sqrt(c),h=c+a*a,f=Math.sqrt(h),k=Math.atan2(o,s),m=a*a/h,g=c/h,I=n.a2/f,T=n.a3-n.a4/f,g>.3?(y=l/f*(1+g*(n.a1+I+m*T)/f),P=Math.asin(y),b=y*y,v=Math.sqrt(1-b)):(v=u/f*(1-m*(n.a5-I-g*T)/f),P=Math.acos(v),b=1-v*v,y=Math.sqrt(b)),w=1-Ti.eccentricitySquared*b,x=Ti.radius/Math.sqrt(w),S=n.a6*x,I=u-x*v,T=l-S*y,E=v*I+y*T,C=v*T-y*I,$=C/(S/w+E),P+=$,L=E+C*$/2,a<0&&(P=-P),i[r++]=o1*k,i[r++]=o1*P,i[r]=L}function lce(t,e,i,r){Om(t,e,i,r),Am(i,r,i,r)}function cce(t,e,i,r){Om(t,e,i,r),Tv(i,r,i,r)}const Kl={[B.WGS84]:{[B.CGCS2000]:null,[B.GCSMARS2000]:null,[B.GCSMOON2000]:null,[B.LON_LAT]:gi,[B.WGS84_COMPARABLE_LON_LAT]:gi,[B.SPHERICAL_ECEF]:Am,[B.SPHERICAL_MARS_PCPF]:null,[B.SPHERICAL_MOON_PCPF]:null,[B.UNKNOWN]:null,[B.WEB_MERCATOR]:Tv,[B.PLATE_CARREE]:$m,[B.WGS84]:gi,[B.WGS84_ECEF]:Pm},[B.CGCS2000]:{[B.CGCS2000]:gi,[B.GCSMARS2000]:null,[B.GCSMOON2000]:null,[B.LON_LAT]:gi,[B.WGS84_COMPARABLE_LON_LAT]:gi,[B.SPHERICAL_ECEF]:Am,[B.SPHERICAL_MARS_PCPF]:null,[B.SPHERICAL_MOON_PCPF]:null,[B.UNKNOWN]:null,[B.WEB_MERCATOR]:null,[B.PLATE_CARREE]:$m,[B.WGS84]:null,[B.WGS84_ECEF]:Pm},[B.GCSMARS2000]:{[B.CGCS2000]:null,[B.GCSMARS2000]:gi,[B.GCSMOON2000]:null,[B.LON_LAT]:gi,[B.WGS84_COMPARABLE_LON_LAT]:null,[B.SPHERICAL_ECEF]:null,[B.SPHERICAL_MARS_PCPF]:M4,[B.SPHERICAL_MOON_PCPF]:null,[B.UNKNOWN]:null,[B.WEB_MERCATOR]:null,[B.PLATE_CARREE]:null,[B.WGS84]:null,[B.WGS84_ECEF]:null},[B.GCSMOON2000]:{[B.CGCS2000]:null,[B.GCSMARS2000]:null,[B.GCSMOON2000]:gi,[B.LON_LAT]:gi,[B.WGS84_COMPARABLE_LON_LAT]:null,[B.SPHERICAL_ECEF]:null,[B.SPHERICAL_MARS_PCPF]:null,[B.SPHERICAL_MOON_PCPF]:E4,[B.UNKNOWN]:null,[B.WEB_MERCATOR]:null,[B.PLATE_CARREE]:null,[B.WGS84]:null,[B.WGS84_ECEF]:null},[B.WEB_MERCATOR]:{[B.CGCS2000]:null,[B.GCSMARS2000]:null,[B.GCSMOON2000]:null,[B.LON_LAT]:rv,[B.WGS84_COMPARABLE_LON_LAT]:rv,[B.SPHERICAL_ECEF]:ice,[B.SPHERICAL_MARS_PCPF]:null,[B.SPHERICAL_MOON_PCPF]:null,[B.UNKNOWN]:null,[B.WEB_MERCATOR]:gi,[B.PLATE_CARREE]:sce,[B.WGS84]:rv,[B.WGS84_ECEF]:rce},[B.WGS84_ECEF]:{[B.CGCS2000]:Om,[B.GCSMARS2000]:null,[B.GCSMOON2000]:null,[B.LON_LAT]:Om,[B.WGS84_COMPARABLE_LON_LAT]:Om,[B.SPHERICAL_ECEF]:lce,[B.SPHERICAL_MARS_PCPF]:null,[B.SPHERICAL_MOON_PCPF]:null,[B.UNKNOWN]:null,[B.WEB_MERCATOR]:cce,[B.PLATE_CARREE]:GPe,[B.WGS84]:Om,[B.WGS84_ECEF]:gi},[B.SPHERICAL_ECEF]:{[B.CGCS2000]:km,[B.GCSMARS2000]:null,[B.GCSMOON2000]:null,[B.LON_LAT]:km,[B.WGS84_COMPARABLE_LON_LAT]:km,[B.SPHERICAL_ECEF]:gi,[B.SPHERICAL_MARS_PCPF]:null,[B.SPHERICAL_MOON_PCPF]:null,[B.UNKNOWN]:null,[B.WEB_MERCATOR]:oce,[B.PLATE_CARREE]:HPe,[B.WGS84]:km,[B.WGS84_ECEF]:ace},[B.SPHERICAL_MARS_PCPF]:{[B.CGCS2000]:null,[B.GCSMARS2000]:A4,[B.GCSMOON2000]:null,[B.LON_LAT]:A4,[B.WGS84_COMPARABLE_LON_LAT]:null,[B.SPHERICAL_ECEF]:null,[B.SPHERICAL_MARS_PCPF]:gi,[B.SPHERICAL_MOON_PCPF]:null,[B.UNKNOWN]:null,[B.WEB_MERCATOR]:null,[B.PLATE_CARREE]:null,[B.WGS84]:null,[B.WGS84_ECEF]:null},[B.SPHERICAL_MOON_PCPF]:{[B.CGCS2000]:null,[B.GCSMARS2000]:null,[B.GCSMOON2000]:$4,[B.LON_LAT]:$4,[B.WGS84_COMPARABLE_LON_LAT]:null,[B.SPHERICAL_ECEF]:null,[B.SPHERICAL_MARS_PCPF]:null,[B.SPHERICAL_MOON_PCPF]:gi,[B.UNKNOWN]:null,[B.WEB_MERCATOR]:null,[B.PLATE_CARREE]:null,[B.WGS84]:null,[B.WGS84_ECEF]:null},[B.UNKNOWN]:{[B.CGCS2000]:null,[B.GCSMARS2000]:null,[B.GCSMOON2000]:null,[B.LON_LAT]:null,[B.WGS84_COMPARABLE_LON_LAT]:null,[B.SPHERICAL_ECEF]:null,[B.SPHERICAL_MARS_PCPF]:null,[B.SPHERICAL_MOON_PCPF]:null,[B.UNKNOWN]:gi,[B.WEB_MERCATOR]:null,[B.PLATE_CARREE]:null,[B.WGS84]:null,[B.WGS84_ECEF]:null},[B.LON_LAT]:{[B.CGCS2000]:gi,[B.GCSMARS2000]:gi,[B.GCSMOON2000]:gi,[B.LON_LAT]:gi,[B.WGS84_COMPARABLE_LON_LAT]:gi,[B.SPHERICAL_ECEF]:Am,[B.SPHERICAL_MARS_PCPF]:M4,[B.SPHERICAL_MOON_PCPF]:E4,[B.UNKNOWN]:null,[B.WEB_MERCATOR]:Tv,[B.PLATE_CARREE]:$m,[B.WGS84]:gi,[B.WGS84_ECEF]:Pm},[B.WGS84_COMPARABLE_LON_LAT]:{[B.CGCS2000]:null,[B.GCSMARS2000]:null,[B.GCSMOON2000]:null,[B.LON_LAT]:gi,[B.WGS84_COMPARABLE_LON_LAT]:gi,[B.SPHERICAL_ECEF]:Am,[B.SPHERICAL_MARS_PCPF]:null,[B.SPHERICAL_MOON_PCPF]:null,[B.UNKNOWN]:null,[B.WEB_MERCATOR]:null,[B.PLATE_CARREE]:$m,[B.WGS84]:gi,[B.WGS84_ECEF]:Pm},[B.PLATE_CARREE]:{[B.CGCS2000]:H0,[B.GCSMARS2000]:null,[B.GCSMOON2000]:null,[B.LON_LAT]:H0,[B.WGS84_COMPARABLE_LON_LAT]:H0,[B.SPHERICAL_ECEF]:qPe,[B.SPHERICAL_MARS_PCPF]:null,[B.SPHERICAL_MOON_PCPF]:null,[B.UNKNOWN]:null,[B.WEB_MERCATOR]:WPe,[B.PLATE_CARREE]:gi,[B.WGS84]:H0,[B.WGS84_ECEF]:JPe}};function AU(t,e,i=kU()){return t==null||e==null?null:uce(t,e,i).projector}function uce(t,e,i){if(t==null||e==null||i.source.spatialReference===t&&i.dest.spatialReference===e)return i;const r=Ud(t,i.source),n=Ud(e,i.dest);return r===B.UNKNOWN&&n===B.UNKNOWN?Pr(t,e)?i.projector=gi:i.projector=null:i.projector=Kl[r][n],i}function kU(){return{source:{spatialReference:null,spatialReferenceId:B.UNKNOWN,metersPerUnit:1},dest:{spatialReference:null,spatialReferenceId:B.UNKNOWN,metersPerUnit:1},projector:gi}}const Y1={spatialReference:null,spatialReferenceId:B.UNKNOWN},dce={spatialReference:null,spatialReferenceId:B.UNKNOWN},PU=kU(),XPe=kU(),du=qse(1),o1=Wse(1),zi=Me(),eu=Me(),Yp=Me(),Ct=Me(),PE=Me(),Z0t=Object.freeze(Object.defineProperty({__proto__:null,canProjectToWGS84ComparableLonLat:ZPe,canProjectWithoutEngine:lc,computeENUToSphericalPCPFLocalRotation:MU,computeSphericalPCPFToENULocalRotation:tce,computeTranslationToOriginAndRotation:UPe,getProjectorName:CPe,getTransformation:lP,getTransformations:SPe,initializeProjection:cg,isLoaded:pc,load:Eu,localLinearScaleFactors:BPe,lonLatToSphericalPCPF:YPe,lonLatToWebMercatorComparable:nce,project:Ir,projectBoundingRect:jPe,projectBoundingSphere:zPe,projectBuffer:Mu,projectDirection:VPe,projectExtent:OPe,projectMany:I4,projectMultipoint:MPe,projectOrLoad:xPe,projectOrLoadMany:Hle,projectPoint:EPe,projectPointToVector:FPe,projectPointToWGS84ComparableLonLat:DPe,projectPolygon:PPe,projectPolygonToWGS84ComparableLonLat:kPe,projectPolyline:$Pe,projectPolylineToWGS84ComparableLonLat:APe,projectVectorToDehydratedPoint:RPe,projectVectorToPoint:LPe,projectVectorToVector:C4,projectVectorToWGS84ComparableLonLat:Qle,projectWithoutEngine:Wle,projectXYZToVector:T4,sphericalPCPFtoLonLatElevation:gL,test:TPe,tryProjectWithZConversion:qle,unload:IPe},Symbol.toStringTag,{value:"Module"}));var k4;let Xu=k4=class extends te{constructor(t){super(t),this.cols=null,this.level=0,this.levelValue=null,this.origin=null,this.resolution=0,this.rows=null,this.scale=0}clone(){return new k4({cols:this.cols,level:this.level,levelValue:this.levelValue,resolution:this.resolution,rows:this.rows,scale:this.scale})}};d([p({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],Xu.prototype,"cols",void 0),d([p({type:wt,json:{write:!0}})],Xu.prototype,"level",void 0),d([p({type:String,json:{write:!0}})],Xu.prototype,"levelValue",void 0),d([p({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],Xu.prototype,"origin",void 0),d([p({type:Number,json:{write:!0}})],Xu.prototype,"resolution",void 0),d([p({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],Xu.prototype,"rows",void 0),d([p({type:Number,json:{write:!0}})],Xu.prototype,"scale",void 0),Xu=k4=d([A("esri.layers.support.LOD")],Xu);const vd=Xu;let yL=class{constructor(e,i,r,n,s=void 0){this.id=e,this.level=i,this.row=r,this.col=n,this.extent=s}};var wf;const vW=new He({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc",LERC2D:"lerc2d",RAW:"raw",pbf:"pbf"});let Ss=wf=class extends te{static create(t={}){const{resolutionFactor:e=1,scales:i,size:r=256,spatialReference:n=Ee.WebMercator,numLODs:s=24}=t;if(!hs(n)){const h=[];if(i)for(let f=0;f<i.length;f++){const m=i[f];h.push(new vd({level:f,scale:m,resolution:m}))}else{let f=5e-4;for(let m=s-1;m>=0;m--)h.unshift(new vd({level:m,scale:f,resolution:f})),f*=2}return new wf({dpi:96,lods:h,origin:new fe(0,0,n),size:[r,r],spatialReference:n})}const o=Do(n),a=t.origin?new fe({x:t.origin.x,y:t.origin.y,spatialReference:n}):new fe(o?{x:o.origin[0],y:o.origin[1],spatialReference:n}:{x:0,y:0,spatialReference:n}),l=96,c=1/(ti(n)*39.37*l),u=[];if(i)for(let h=0;h<i.length;h++){const f=i[h],m=f*c;u.push(new vd({level:h,scale:f,resolution:m}))}else{let h=lB(n)?512/r*5916575275917094e-7:256/r*591657527591555e-6;const f=Math.ceil(s/e);u.push(new vd({level:0,scale:h,resolution:h*c}));for(let m=1;m<f;m++){const g=h/2**e,y=g*c;u.push(new vd({level:m,scale:g,resolution:y})),h=g}}return new wf({dpi:l,lods:u,origin:a,size:[r,r],spatialReference:n})}constructor(t){super(t),this.dpi=96,this.format=null,this.origin=null,this.size=null,this.spatialReference=null}get isWrappable(){const{spatialReference:t,origin:e}=this;if(t&&e){const i=Do(t);return t.isWrappable&&!!i&&Math.abs(i.origin[0]-e.x)<=i.dx}return!1}readOrigin(t,e){return fe.fromJSON({spatialReference:e.spatialReference,...t})}set lods(t){let e=0,i=0;const r=[],n=this._levelToLOD={};t&&(e=-1/0,i=1/0,t.forEach(s=>{r.push(s.scale),e=s.scale>e?s.scale:e,i=s.scale<i?s.scale:i,n[s.level]=s})),this._set("scales",r),this._set("lods",t),this._initializeUpsampleLevels()}readSize(t,e){return[e.cols,e.rows]}writeSize(t,e){e.cols=t[0],e.rows=t[1]}zoomToScale(t){const e=this.scales;if(t<=0)return e[0];if(t>=e.length-1)return e[e.length-1];const i=Math.floor(t),r=i+1;return e[i]/(e[i]/e[r])**(t-i)}scaleToZoom(t){const e=this.scales,i=e.length-1;let r=0;for(;r<i;r++){const n=e[r],s=e[r+1];if(n<=t)return r;if(s===t)return r+1;if(n>t&&s<t)return r+Math.log(n/t)/Math.log(n/s)}return r}snapScale(t,e=.95){const i=this.scaleToZoom(t);return i%Math.floor(i)>=e?this.zoomToScale(Math.ceil(i)):this.zoomToScale(Math.floor(i))}tileAt(t,e,i,r){const n=this.lodAt(t);if(!n)return null;let s,o;if(typeof e=="number")s=e,o=i;else if(Pr(e.spatialReference,this.spatialReference))s=e.x,o=e.y,r=i;else{const c=rC(e,this.spatialReference);if(c==null)return null;s=c.x,o=c.y,r=i}const a=n.resolution*this.size[0],l=n.resolution*this.size[1];return r||(r=new yL(null,0,0,0,al())),r.level=t,r.row=Math.floor((this.origin.y-o)/l+.001),r.col=Math.floor((s-this.origin.x)/a+.001),this.updateTileInfo(r),r}updateTileInfo(t,e=wf.ExtrapolateOptions.NONE){let i=this.lodAt(t.level);if(!i&&e===wf.ExtrapolateOptions.POWER_OF_TWO){const o=this.lods[this.lods.length-1];o.level<t.level&&(i=o)}if(!i)return;const r=t.level-i.level,n=i.resolution*this.size[0]/2**r,s=i.resolution*this.size[1]/2**r;t.id=`${t.level}/${t.row}/${t.col}`,t.extent||(t.extent=al()),t.extent[0]=this.origin.x+t.col*n,t.extent[1]=this.origin.y-(t.row+1)*s,t.extent[2]=t.extent[0]+n,t.extent[3]=t.extent[1]+s}upsampleTile(t){const e=this._upsampleLevels[t.level];return!(!e||e.parentLevel===-1)&&(t.level=e.parentLevel,t.row=Math.floor(t.row/e.factor+.001),t.col=Math.floor(t.col/e.factor+.001),this.updateTileInfo(t),!0)}getTileBounds(t,e){const i=this.lodAt(e.level);if(i==null)return null;const{resolution:r}=i,n=r*this.size[0],s=r*this.size[1];return t[0]=this.origin.x+e.col*n,t[1]=this.origin.y-(e.row+1)*s,t[2]=t[0]+n,t[3]=t[1]+s,t}lodAt(t){var e;return((e=this._levelToLOD)==null?void 0:e[t])??null}clone(){return wf.fromJSON(this.write({}))}getOrCreateCompatible(t,e){if(this.size[0]===256&&this.size[1]===256)return t===256?this:null;const i=[],r=this.lods.length;for(let n=0;n<r;n++){const s=this.lods[n],o=s.resolution*e;i.push(new vd({level:s.level,scale:s.scale,resolution:o}))}return new wf({size:[t,t],dpi:this.dpi,format:this.format,compressionQuality:this.compressionQuality,origin:this.origin,spatialReference:this.spatialReference,lods:i})}_initializeUpsampleLevels(){const t=this.lods;this._upsampleLevels=[];let e=null;for(let i=0;i<t.length;i++){const r=t[i];this._upsampleLevels[r.level]={parentLevel:e?e.level:-1,factor:e?e.resolution/r.resolution:0},e=r}}};d([p({type:Number,json:{write:!0}})],Ss.prototype,"compressionQuality",void 0),d([p({type:Number,json:{write:!0}})],Ss.prototype,"dpi",void 0),d([p({type:String,json:{read:vW.read,write:vW.write,origins:{"web-scene":{read:!1,write:!1}}}})],Ss.prototype,"format",void 0),d([p({readOnly:!0})],Ss.prototype,"isWrappable",null),d([p({type:fe,json:{write:!0}})],Ss.prototype,"origin",void 0),d([ae("origin")],Ss.prototype,"readOrigin",null),d([p({type:[vd],value:null,json:{write:!0}})],Ss.prototype,"lods",null),d([p({readOnly:!0})],Ss.prototype,"scales",void 0),d([p({cast:t=>Array.isArray(t)?t:typeof t=="number"?[t,t]:[256,256]})],Ss.prototype,"size",void 0),d([ae("size",["rows","cols"])],Ss.prototype,"readSize",null),d([ge("size",{cols:{type:wt},rows:{type:wt}})],Ss.prototype,"writeSize",null),d([p({type:Ee,json:{write:!0}})],Ss.prototype,"spatialReference",void 0),Ss=wf=d([A("esri.layers.support.TileInfo")],Ss),function(t){var e;(e=t.ExtrapolateOptions||(t.ExtrapolateOptions={}))[e.NONE=0]="NONE",e[e.POWER_OF_TWO=1]="POWER_OF_TWO"}(Ss||(Ss={}));const Od=Ss,iA={widthBreakpoint:{getValue(t){const e=t.viewSize[0],i=t.breakpoints,r=this.values;return e<=i.xsmall?r.xsmall:e<=i.small?r.small:e<=i.medium?r.medium:e<=i.large?r.large:r.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-width-xsmall esri-view-width-less-than-small esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",small:"esri-view-width-small esri-view-width-greater-than-xsmall esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",medium:"esri-view-width-medium esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-less-than-large esri-view-width-less-than-xlarge",large:"esri-view-width-large esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-less-than-xlarge",xlarge:"esri-view-width-xlarge esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-greater-than-large"}},heightBreakpoint:{getValue(t){const e=t.viewSize[1],i=t.breakpoints,r=this.values;return e<=i.xsmall?r.xsmall:e<=i.small?r.small:e<=i.medium?r.medium:e<=i.large?r.large:r.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-height-xsmall esri-view-height-less-than-small esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",small:"esri-view-height-small esri-view-height-greater-than-xsmall esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",medium:"esri-view-height-medium esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-less-than-large esri-view-height-less-than-xlarge",large:"esri-view-height-large esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-less-than-xlarge",xlarge:"esri-view-height-xlarge esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-greater-than-large"}},orientation:{getValue(t){const e=t.viewSize,i=e[0],r=e[1],n=this.values;return r>=i?n.portrait:n.landscape},values:{portrait:"portrait",landscape:"landscape"},valueToClassName:{portrait:"esri-view-orientation-portrait",landscape:"esri-view-orientation-landscape"}}},F3={xsmall:544,small:768,medium:992,large:1200};function QPe(t){const e=t;return e&&e.xsmall<e.small&&e.small<e.medium&&e.medium<e.large}function D3(t,e){return e?iA[t].valueToClassName[e].split(" "):[]}const eOe=t=>{let e=class extends t{constructor(...i){super(...i),this._breakpointsHandles=new gs,this.orientation=null,this.widthBreakpoint=null,this.heightBreakpoint=null,this.breakpoints=F3}initialize(){this._breakpointsHandles.add(J(()=>[this.breakpoints,this.size],()=>this._updateClassNames(),Le))}destroy(){this.destroyed||(this._removeActiveClassNames(),this._breakpointsHandles=je(this._breakpointsHandles))}set breakpoints(i){if(i===this._get("breakpoints"))return;const r=QPe(i);if(!r){const n=JSON.stringify(F3,null,2);console.warn("provided breakpoints are not valid, using defaults:"+n)}i=r?i:F3,this._set("breakpoints",{...i})}_updateClassNames(){if(!this.container)return;const i=Oo.acquire(),r=Oo.acquire();let n,s=!1;for(n in iA){const o=this[n],a=iA[n].getValue({viewSize:this.size,breakpoints:this.breakpoints});o!==a&&(s=!0,this[n]=a,D3(n,o).forEach(l=>r.push(l)),D3(n,a).forEach(l=>i.push(l)))}s&&(this._applyClassNameChanges(i,r),Oo.release(i),Oo.release(r))}_applyClassNameChanges(i,r){const n=this.container;n&&(r.forEach(s=>n.classList.remove(s)),i.forEach(s=>n.classList.add(s)))}_removeActiveClassNames(){const i=this.container;if(!i)return;let r;for(r in iA)D3(r,this[r]).forEach(n=>i.classList.remove(n))}};return d([p()],e.prototype,"breakpoints",null),d([p()],e.prototype,"orientation",void 0),d([p()],e.prototype,"widthBreakpoint",void 0),d([p()],e.prototype,"heightBreakpoint",void 0),e=d([A("esri.views.BreakpointsOwner")],e),e};function vL(t){return typeof t=="string"?document.getElementById(t):t??null}function hce(t){for(;t.hasChildNodes();)t.removeChild(t.firstChild)}function _W(t,e){const i=e.parentNode;i&&i.insertBefore(t,e)}function bW(t,e){for(;;){const i=t.firstChild;if(!i)break;e.appendChild(i)}}function tOe(t){t.parentNode&&t.parentNode.removeChild(t)}let nv=class extends he{constructor(){super(...arguments),this.updating=!1,this._handleId=0,this._handles=new gs,this._scheduleHandleId=0,this._pendingPromises=new Set}destroy(){this.removeAll(),this._handles.destroy()}add(e,i,r={}){return this._installWatch(e,i,r,J)}addWhen(e,i,r={}){return this._installWatch(e,i,r,tn)}addOnCollectionChange(e,i,{initial:r=!1,final:n=!1}={}){const s=++this._handleId;return this._handles.add([ui(e,"after-changes",this._createSyncUpdatingCallback(),Ca),ui(e,"change",i,{onListenerAdd:r?o=>i({added:o.toArray(),removed:[]}):void 0,onListenerRemove:n?o=>i({added:[],removed:o.toArray()}):void 0})],s),Et(()=>this._handles.remove(s))}addPromise(e){if(e==null)return e;const i=++this._handleId;this._handles.add({remove:()=>{this._pendingPromises.delete(e)&&(this._pendingPromises.size!==0||this._handles.has(OE)||this._set("updating",!1))}},i),this._pendingPromises.add(e),this._set("updating",!0);const r=()=>this._handles.remove(i);return e.then(r,r),e}removeAll(){this._pendingPromises.clear(),this._handles.removeAll(),this._set("updating",!1)}_installWatch(e,i,r={},n){const s=++this._handleId;r.sync||this._installSyncUpdatingWatch(e,s);const o=n(e,i,r);return this._handles.add(o,s),Et(()=>this._handles.remove(s))}_installSyncUpdatingWatch(e,i){const r=this._createSyncUpdatingCallback(),n=J(e,r,{sync:!0,equals:()=>!1});return this._handles.add(n,i),n}_createSyncUpdatingCallback(){return()=>{this._handles.remove(OE),++this._scheduleHandleId;const e=this._scheduleHandleId;this._get("updating")||this._set("updating",!0),this._handles.add(O1(()=>{e===this._scheduleHandleId&&(this._set("updating",this._pendingPromises.size>0),this._handles.remove(OE))}),OE)}}};d([p({readOnly:!0})],nv.prototype,"updating",void 0),nv=d([A("esri.core.support.WatchUpdatingTracking")],nv);const OE=-42;/*!
 * @esri/arcgis-html-sanitizer - v3.0.1 - Tue Nov 15 2022 09:46:54 GMT-0800 (Pacific Standard Time)
 * Copyright (c) 2022 - Environmental Systems Research Institute, Inc.
 * Apache-2.0
 * 
 * js-xss
 * Copyright (c) 2012-2018 Zongmin Lei(雷宗民) <leizongmin@gmail.com>
 * http://ucdok.com
 * MIT License, see https://github.com/leizongmin/js-xss/blob/master/LICENSE for details
 */var iOe=function(t){if(typeof t!="object"||t===null||Object.prototype.toString.call(t)!=="[object Object]")return!1;var e=Object.getPrototypeOf(t);if(e===null)return!0;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e},E0={exports:{}},Lr={},lT={exports:{}},qv={};function pce(){var t={};return t["align-content"]=!1,t["align-items"]=!1,t["align-self"]=!1,t["alignment-adjust"]=!1,t["alignment-baseline"]=!1,t.all=!1,t["anchor-point"]=!1,t.animation=!1,t["animation-delay"]=!1,t["animation-direction"]=!1,t["animation-duration"]=!1,t["animation-fill-mode"]=!1,t["animation-iteration-count"]=!1,t["animation-name"]=!1,t["animation-play-state"]=!1,t["animation-timing-function"]=!1,t.azimuth=!1,t["backface-visibility"]=!1,t.background=!0,t["background-attachment"]=!0,t["background-clip"]=!0,t["background-color"]=!0,t["background-image"]=!0,t["background-origin"]=!0,t["background-position"]=!0,t["background-repeat"]=!0,t["background-size"]=!0,t["baseline-shift"]=!1,t.binding=!1,t.bleed=!1,t["bookmark-label"]=!1,t["bookmark-level"]=!1,t["bookmark-state"]=!1,t.border=!0,t["border-bottom"]=!0,t["border-bottom-color"]=!0,t["border-bottom-left-radius"]=!0,t["border-bottom-right-radius"]=!0,t["border-bottom-style"]=!0,t["border-bottom-width"]=!0,t["border-collapse"]=!0,t["border-color"]=!0,t["border-image"]=!0,t["border-image-outset"]=!0,t["border-image-repeat"]=!0,t["border-image-slice"]=!0,t["border-image-source"]=!0,t["border-image-width"]=!0,t["border-left"]=!0,t["border-left-color"]=!0,t["border-left-style"]=!0,t["border-left-width"]=!0,t["border-radius"]=!0,t["border-right"]=!0,t["border-right-color"]=!0,t["border-right-style"]=!0,t["border-right-width"]=!0,t["border-spacing"]=!0,t["border-style"]=!0,t["border-top"]=!0,t["border-top-color"]=!0,t["border-top-left-radius"]=!0,t["border-top-right-radius"]=!0,t["border-top-style"]=!0,t["border-top-width"]=!0,t["border-width"]=!0,t.bottom=!1,t["box-decoration-break"]=!0,t["box-shadow"]=!0,t["box-sizing"]=!0,t["box-snap"]=!0,t["box-suppress"]=!0,t["break-after"]=!0,t["break-before"]=!0,t["break-inside"]=!0,t["caption-side"]=!1,t.chains=!1,t.clear=!0,t.clip=!1,t["clip-path"]=!1,t["clip-rule"]=!1,t.color=!0,t["color-interpolation-filters"]=!0,t["column-count"]=!1,t["column-fill"]=!1,t["column-gap"]=!1,t["column-rule"]=!1,t["column-rule-color"]=!1,t["column-rule-style"]=!1,t["column-rule-width"]=!1,t["column-span"]=!1,t["column-width"]=!1,t.columns=!1,t.contain=!1,t.content=!1,t["counter-increment"]=!1,t["counter-reset"]=!1,t["counter-set"]=!1,t.crop=!1,t.cue=!1,t["cue-after"]=!1,t["cue-before"]=!1,t.cursor=!1,t.direction=!1,t.display=!0,t["display-inside"]=!0,t["display-list"]=!0,t["display-outside"]=!0,t["dominant-baseline"]=!1,t.elevation=!1,t["empty-cells"]=!1,t.filter=!1,t.flex=!1,t["flex-basis"]=!1,t["flex-direction"]=!1,t["flex-flow"]=!1,t["flex-grow"]=!1,t["flex-shrink"]=!1,t["flex-wrap"]=!1,t.float=!1,t["float-offset"]=!1,t["flood-color"]=!1,t["flood-opacity"]=!1,t["flow-from"]=!1,t["flow-into"]=!1,t.font=!0,t["font-family"]=!0,t["font-feature-settings"]=!0,t["font-kerning"]=!0,t["font-language-override"]=!0,t["font-size"]=!0,t["font-size-adjust"]=!0,t["font-stretch"]=!0,t["font-style"]=!0,t["font-synthesis"]=!0,t["font-variant"]=!0,t["font-variant-alternates"]=!0,t["font-variant-caps"]=!0,t["font-variant-east-asian"]=!0,t["font-variant-ligatures"]=!0,t["font-variant-numeric"]=!0,t["font-variant-position"]=!0,t["font-weight"]=!0,t.grid=!1,t["grid-area"]=!1,t["grid-auto-columns"]=!1,t["grid-auto-flow"]=!1,t["grid-auto-rows"]=!1,t["grid-column"]=!1,t["grid-column-end"]=!1,t["grid-column-start"]=!1,t["grid-row"]=!1,t["grid-row-end"]=!1,t["grid-row-start"]=!1,t["grid-template"]=!1,t["grid-template-areas"]=!1,t["grid-template-columns"]=!1,t["grid-template-rows"]=!1,t["hanging-punctuation"]=!1,t.height=!0,t.hyphens=!1,t.icon=!1,t["image-orientation"]=!1,t["image-resolution"]=!1,t["ime-mode"]=!1,t["initial-letters"]=!1,t["inline-box-align"]=!1,t["justify-content"]=!1,t["justify-items"]=!1,t["justify-self"]=!1,t.left=!1,t["letter-spacing"]=!0,t["lighting-color"]=!0,t["line-box-contain"]=!1,t["line-break"]=!1,t["line-grid"]=!1,t["line-height"]=!1,t["line-snap"]=!1,t["line-stacking"]=!1,t["line-stacking-ruby"]=!1,t["line-stacking-shift"]=!1,t["line-stacking-strategy"]=!1,t["list-style"]=!0,t["list-style-image"]=!0,t["list-style-position"]=!0,t["list-style-type"]=!0,t.margin=!0,t["margin-bottom"]=!0,t["margin-left"]=!0,t["margin-right"]=!0,t["margin-top"]=!0,t["marker-offset"]=!1,t["marker-side"]=!1,t.marks=!1,t.mask=!1,t["mask-box"]=!1,t["mask-box-outset"]=!1,t["mask-box-repeat"]=!1,t["mask-box-slice"]=!1,t["mask-box-source"]=!1,t["mask-box-width"]=!1,t["mask-clip"]=!1,t["mask-image"]=!1,t["mask-origin"]=!1,t["mask-position"]=!1,t["mask-repeat"]=!1,t["mask-size"]=!1,t["mask-source-type"]=!1,t["mask-type"]=!1,t["max-height"]=!0,t["max-lines"]=!1,t["max-width"]=!0,t["min-height"]=!0,t["min-width"]=!0,t["move-to"]=!1,t["nav-down"]=!1,t["nav-index"]=!1,t["nav-left"]=!1,t["nav-right"]=!1,t["nav-up"]=!1,t["object-fit"]=!1,t["object-position"]=!1,t.opacity=!1,t.order=!1,t.orphans=!1,t.outline=!1,t["outline-color"]=!1,t["outline-offset"]=!1,t["outline-style"]=!1,t["outline-width"]=!1,t.overflow=!1,t["overflow-wrap"]=!1,t["overflow-x"]=!1,t["overflow-y"]=!1,t.padding=!0,t["padding-bottom"]=!0,t["padding-left"]=!0,t["padding-right"]=!0,t["padding-top"]=!0,t.page=!1,t["page-break-after"]=!1,t["page-break-before"]=!1,t["page-break-inside"]=!1,t["page-policy"]=!1,t.pause=!1,t["pause-after"]=!1,t["pause-before"]=!1,t.perspective=!1,t["perspective-origin"]=!1,t.pitch=!1,t["pitch-range"]=!1,t["play-during"]=!1,t.position=!1,t["presentation-level"]=!1,t.quotes=!1,t["region-fragment"]=!1,t.resize=!1,t.rest=!1,t["rest-after"]=!1,t["rest-before"]=!1,t.richness=!1,t.right=!1,t.rotation=!1,t["rotation-point"]=!1,t["ruby-align"]=!1,t["ruby-merge"]=!1,t["ruby-position"]=!1,t["shape-image-threshold"]=!1,t["shape-outside"]=!1,t["shape-margin"]=!1,t.size=!1,t.speak=!1,t["speak-as"]=!1,t["speak-header"]=!1,t["speak-numeral"]=!1,t["speak-punctuation"]=!1,t["speech-rate"]=!1,t.stress=!1,t["string-set"]=!1,t["tab-size"]=!1,t["table-layout"]=!1,t["text-align"]=!0,t["text-align-last"]=!0,t["text-combine-upright"]=!0,t["text-decoration"]=!0,t["text-decoration-color"]=!0,t["text-decoration-line"]=!0,t["text-decoration-skip"]=!0,t["text-decoration-style"]=!0,t["text-emphasis"]=!0,t["text-emphasis-color"]=!0,t["text-emphasis-position"]=!0,t["text-emphasis-style"]=!0,t["text-height"]=!0,t["text-indent"]=!0,t["text-justify"]=!0,t["text-orientation"]=!0,t["text-overflow"]=!0,t["text-shadow"]=!0,t["text-space-collapse"]=!0,t["text-transform"]=!0,t["text-underline-position"]=!0,t["text-wrap"]=!0,t.top=!1,t.transform=!1,t["transform-origin"]=!1,t["transform-style"]=!1,t.transition=!1,t["transition-delay"]=!1,t["transition-duration"]=!1,t["transition-property"]=!1,t["transition-timing-function"]=!1,t["unicode-bidi"]=!1,t["vertical-align"]=!1,t.visibility=!1,t["voice-balance"]=!1,t["voice-duration"]=!1,t["voice-family"]=!1,t["voice-pitch"]=!1,t["voice-range"]=!1,t["voice-rate"]=!1,t["voice-stress"]=!1,t["voice-volume"]=!1,t.volume=!1,t["white-space"]=!1,t.widows=!1,t.width=!0,t["will-change"]=!1,t["word-break"]=!0,t["word-spacing"]=!0,t["word-wrap"]=!0,t["wrap-flow"]=!1,t["wrap-through"]=!1,t["writing-mode"]=!1,t["z-index"]=!1,t}function rOe(t,e,i){}function nOe(t,e,i){}var sOe=/javascript\s*\:/img;function oOe(t,e){return sOe.test(e)?"":e}qv.whiteList=pce();qv.getDefaultWhiteList=pce;qv.onAttr=rOe;qv.onIgnoreAttr=nOe;qv.safeAttrValue=oOe;var aOe={indexOf:function(t,e){var i,r;if(Array.prototype.indexOf)return t.indexOf(e);for(i=0,r=t.length;i<r;i++)if(t[i]===e)return i;return-1},forEach:function(t,e,i){var r,n;if(Array.prototype.forEach)return t.forEach(e,i);for(r=0,n=t.length;r<n;r++)e.call(i,t[r],r,t)},trim:function(t){return String.prototype.trim?t.trim():t.replace(/(^\s*)|(\s*$)/g,"")},trimRight:function(t){return String.prototype.trimRight?t.trimRight():t.replace(/(\s*$)/g,"")}},Mx=aOe;function lOe(t,e){t=Mx.trimRight(t),t[t.length-1]!==";"&&(t+=";");var i=t.length,r=!1,n=0,s=0,o="";function a(){if(!r){var u=Mx.trim(t.slice(n,s)),h=u.indexOf(":");if(h!==-1){var f=Mx.trim(u.slice(0,h)),m=Mx.trim(u.slice(h+1));if(f){var g=e(n,o.length,f,m,u);g&&(o+=g+"; ")}}}n=s+1}for(;s<i;s++){var l=t[s];if(l==="/"&&t[s+1]==="*"){var c=t.indexOf("*/",s+2);if(c===-1)break;s=c+1,n=s+1,r=!1}else l==="("?r=!0:l===")"?r=!1:l===";"?r||a():l===`
`&&a()}return Mx.trim(o)}var cOe=lOe,LE=qv,uOe=cOe;function wW(t){return t==null}function dOe(t){var e={};for(var i in t)e[i]=t[i];return e}function fce(t){t=dOe(t||{}),t.whiteList=t.whiteList||LE.whiteList,t.onAttr=t.onAttr||LE.onAttr,t.onIgnoreAttr=t.onIgnoreAttr||LE.onIgnoreAttr,t.safeAttrValue=t.safeAttrValue||LE.safeAttrValue,this.options=t}fce.prototype.process=function(t){if(t=t||"",t=t.toString(),!t)return"";var e=this,i=e.options,r=i.whiteList,n=i.onAttr,s=i.onIgnoreAttr,o=i.safeAttrValue,a=uOe(t,function(l,c,u,h,f){var m=r[u],g=!1;if(m===!0?g=m:typeof m=="function"?g=m(h):m instanceof RegExp&&(g=m.test(h)),g!==!0&&(g=!1),h=o(u,h),!!h){var y={position:c,sourcePosition:l,source:f,isWhite:g};if(g){var v=n(u,h,y);return wW(v)?u+":"+h:v}else{var v=s(u,h,y);if(!wW(v))return v}}});return a};var hOe=fce;(function(t,e){var i=qv,r=hOe;function n(o,a){var l=new r(a);return l.process(o)}e=t.exports=n,e.FilterCSS=r;for(var s in i)e[s]=i[s]})(lT,lT.exports);var OU={indexOf:function(t,e){var i,r;if(Array.prototype.indexOf)return t.indexOf(e);for(i=0,r=t.length;i<r;i++)if(t[i]===e)return i;return-1},forEach:function(t,e,i){var r,n;if(Array.prototype.forEach)return t.forEach(e,i);for(r=0,n=t.length;r<n;r++)e.call(i,t[r],r,t)},trim:function(t){return String.prototype.trim?t.trim():t.replace(/(^\s*)|(\s*$)/g,"")},spaceIndex:function(t){var e=/\s|\n|\t/,i=e.exec(t);return i?i.index:-1}},pOe=lT.exports.FilterCSS,fOe=lT.exports.getDefaultWhiteList,cP=OU;function mce(){return{a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","crossorigin","loop","muted","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],figcaption:[],figure:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],strike:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","crossorigin","loop","muted","playsinline","poster","preload","src","height","width"]}}var gce=new pOe;function mOe(t,e,i){}function gOe(t,e,i){}function yOe(t,e,i){}function vOe(t,e,i){}function yce(t){return t.replace(bOe,"&lt;").replace(wOe,"&gt;")}function _Oe(t,e,i,r){if(i=Sce(i),e==="href"||e==="src"){if(i=cP.trim(i),i==="#")return"#";if(!(i.substr(0,7)==="http://"||i.substr(0,8)==="https://"||i.substr(0,7)==="mailto:"||i.substr(0,4)==="tel:"||i.substr(0,11)==="data:image/"||i.substr(0,6)==="ftp://"||i.substr(0,2)==="./"||i.substr(0,3)==="../"||i[0]==="#"||i[0]==="/"))return""}else if(e==="background"){if(RE.lastIndex=0,RE.test(i))return""}else if(e==="style"){if(xW.lastIndex=0,xW.test(i)||(SW.lastIndex=0,SW.test(i)&&(RE.lastIndex=0,RE.test(i))))return"";r!==!1&&(r=r||gce,i=r.process(i))}return i=Ice(i),i}var bOe=/</g,wOe=/>/g,xOe=/"/g,SOe=/&quot;/g,IOe=/&#([a-zA-Z0-9]*);?/gim,TOe=/&colon;?/gim,COe=/&newline;?/gim,RE=/((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a):/gi,xW=/e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n\s*\(.*/gi,SW=/u\s*r\s*l\s*\(.*/gi;function vce(t){return t.replace(xOe,"&quot;")}function _ce(t){return t.replace(SOe,'"')}function bce(t){return t.replace(IOe,function(i,r){return r[0]==="x"||r[0]==="X"?String.fromCharCode(parseInt(r.substr(1),16)):String.fromCharCode(parseInt(r,10))})}function wce(t){return t.replace(TOe,":").replace(COe," ")}function xce(t){for(var e="",i=0,r=t.length;i<r;i++)e+=t.charCodeAt(i)<32?" ":t.charAt(i);return cP.trim(e)}function Sce(t){return t=_ce(t),t=bce(t),t=wce(t),t=xce(t),t}function Ice(t){return t=vce(t),t=yce(t),t}function EOe(){return""}function MOe(t,e){typeof e!="function"&&(e=function(){});var i=!Array.isArray(t);function r(o){return i?!0:cP.indexOf(t,o)!==-1}var n=[],s=!1;return{onIgnoreTag:function(o,a,l){if(r(o))if(l.isClosing){var c="[/removed]",u=l.position+c.length;return n.push([s!==!1?s:l.position,u]),s=!1,c}else return s||(s=l.position),"[removed]";else return e(o,a,l)},remove:function(o){var a="",l=0;return cP.forEach(n,function(c){a+=o.slice(l,c[0]),l=c[1]}),a+=o.slice(l),a}}}function $Oe(t){for(var e="",i=0;i<t.length;){var r=t.indexOf("<!--",i);if(r===-1){e+=t.slice(i);break}e+=t.slice(i,r);var n=t.indexOf("-->",r);if(n===-1)break;i=n+3}return e}function AOe(t){var e=t.split("");return e=e.filter(function(i){var r=i.charCodeAt(0);return r===127?!1:r<=31?r===10||r===13:!0}),e.join("")}Lr.whiteList=mce();Lr.getDefaultWhiteList=mce;Lr.onTag=mOe;Lr.onIgnoreTag=gOe;Lr.onTagAttr=yOe;Lr.onIgnoreTagAttr=vOe;Lr.safeAttrValue=_Oe;Lr.escapeHtml=yce;Lr.escapeQuote=vce;Lr.unescapeQuote=_ce;Lr.escapeHtmlEntities=bce;Lr.escapeDangerHtml5Entities=wce;Lr.clearNonPrintableCharacter=xce;Lr.friendlyAttrValue=Sce;Lr.escapeAttrValue=Ice;Lr.onIgnoreTagStripAll=EOe;Lr.StripTagBody=MOe;Lr.stripCommentTag=$Oe;Lr.stripBlankChar=AOe;Lr.cssFilter=gce;Lr.getDefaultCSSWhiteList=fOe;var _L={},um=OU;function kOe(t){var e=um.spaceIndex(t),i;return e===-1?i=t.slice(1,-1):i=t.slice(1,e+1),i=um.trim(i).toLowerCase(),i.slice(0,1)==="/"&&(i=i.slice(1)),i.slice(-1)==="/"&&(i=i.slice(0,-1)),i}function POe(t){return t.slice(0,2)==="</"}function OOe(t,e,i){var r="",n=0,s=!1,o=!1,a=0,l=t.length,c="",u="";e:for(a=0;a<l;a++){var h=t.charAt(a);if(s===!1){if(h==="<"){s=a;continue}}else if(o===!1){if(h==="<"){r+=i(t.slice(n,a)),s=a,n=a;continue}if(h===">"){r+=i(t.slice(n,s)),u=t.slice(s,a+1),c=kOe(u),r+=e(s,r.length,c,u,POe(u)),n=a+1,s=!1;continue}if(h==='"'||h==="'")for(var f=1,m=t.charAt(a-f);m.trim()===""||m==="=";){if(m==="="){o=h;continue e}m=t.charAt(a-++f)}}else if(h===o){o=!1;continue}}return n<t.length&&(r+=i(t.substr(n))),r}var LOe=/[^a-zA-Z0-9\\_:.-]/gim;function ROe(t,e){var i=0,r=0,n=[],s=!1,o=t.length;function a(f,m){if(f=um.trim(f),f=f.replace(LOe,"").toLowerCase(),!(f.length<1)){var g=e(f,m||"");g&&n.push(g)}}for(var l=0;l<o;l++){var c=t.charAt(l),u,h;if(s===!1&&c==="="){s=t.slice(i,l),i=l+1,r=t.charAt(i)==='"'||t.charAt(i)==="'"?i:DOe(t,l+1);continue}if(s!==!1&&l===r){if(h=t.indexOf(c,l+1),h===-1)break;u=um.trim(t.slice(r+1,h)),a(s,u),s=!1,l=h,i=l+1;continue}if(/\s|\n|\t/.test(c))if(t=t.replace(/\s|\n|\t/g," "),s===!1)if(h=FOe(t,l),h===-1){u=um.trim(t.slice(i,l)),a(u),s=!1,i=l+1;continue}else{l=h-1;continue}else if(h=NOe(t,l-1),h===-1){u=um.trim(t.slice(i,l)),u=IW(u),a(s,u),s=!1,i=l+1;continue}else continue}return i<t.length&&(s===!1?a(t.slice(i)):a(s,IW(um.trim(t.slice(i))))),um.trim(n.join(" "))}function FOe(t,e){for(;e<t.length;e++){var i=t[e];if(i!==" ")return i==="="?e:-1}}function DOe(t,e){for(;e<t.length;e++){var i=t[e];if(i!==" ")return i==="'"||i==='"'?e:-1}}function NOe(t,e){for(;e>0;e--){var i=t[e];if(i!==" ")return i==="="?e:-1}}function VOe(t){return t[0]==='"'&&t[t.length-1]==='"'||t[0]==="'"&&t[t.length-1]==="'"}function IW(t){return VOe(t)?t.substr(1,t.length-2):t}_L.parseTag=OOe;_L.parseAttr=ROe;var zOe=lT.exports.FilterCSS,tu=Lr,Tce=_L,jOe=Tce.parseTag,BOe=Tce.parseAttr,rA=OU;function FE(t){return t==null}function UOe(t){var e=rA.spaceIndex(t);if(e===-1)return{html:"",closing:t[t.length-2]==="/"};t=rA.trim(t.slice(e+1,-1));var i=t[t.length-1]==="/";return i&&(t=rA.trim(t.slice(0,-1))),{html:t,closing:i}}function GOe(t){var e={};for(var i in t)e[i]=t[i];return e}function HOe(t){var e={};for(var i in t)Array.isArray(t[i])?e[i.toLowerCase()]=t[i].map(function(r){return r.toLowerCase()}):e[i.toLowerCase()]=t[i];return e}function Cce(t){t=GOe(t||{}),t.stripIgnoreTag&&(t.onIgnoreTag&&console.error('Notes: cannot use these two options "stripIgnoreTag" and "onIgnoreTag" at the same time'),t.onIgnoreTag=tu.onIgnoreTagStripAll),t.whiteList||t.allowList?t.whiteList=HOe(t.whiteList||t.allowList):t.whiteList=tu.whiteList,t.onTag=t.onTag||tu.onTag,t.onTagAttr=t.onTagAttr||tu.onTagAttr,t.onIgnoreTag=t.onIgnoreTag||tu.onIgnoreTag,t.onIgnoreTagAttr=t.onIgnoreTagAttr||tu.onIgnoreTagAttr,t.safeAttrValue=t.safeAttrValue||tu.safeAttrValue,t.escapeHtml=t.escapeHtml||tu.escapeHtml,this.options=t,t.css===!1?this.cssFilter=!1:(t.css=t.css||{},this.cssFilter=new zOe(t.css))}Cce.prototype.process=function(t){if(t=t||"",t=t.toString(),!t)return"";var e=this,i=e.options,r=i.whiteList,n=i.onTag,s=i.onIgnoreTag,o=i.onTagAttr,a=i.onIgnoreTagAttr,l=i.safeAttrValue,c=i.escapeHtml,u=e.cssFilter;i.stripBlankChar&&(t=tu.stripBlankChar(t)),i.allowCommentTag||(t=tu.stripCommentTag(t));var h=!1;i.stripIgnoreTagBody&&(h=tu.StripTagBody(i.stripIgnoreTagBody,s),s=h.onIgnoreTag);var f=jOe(t,function(m,g,y,v,b){var w={sourcePosition:m,position:g,isClosing:b,isWhite:Object.prototype.hasOwnProperty.call(r,y)},x=n(y,v,w);if(!FE(x))return x;if(w.isWhite){if(w.isClosing)return"</"+y+">";var S=UOe(v),I=r[y],T=BOe(S.html,function(C,E){var $=rA.indexOf(I,C)!==-1,P=o(y,C,E,$);return FE(P)?$?(E=l(y,C,E,u),E?C+'="'+E+'"':C):(P=a(y,C,E,$),FE(P)?void 0:P):P});return v="<"+y,T&&(v+=" "+T),S.closing&&(v+=" /"),v+=">",v}else return x=s(y,v,w),FE(x)?c(v):x},c);return h&&(f=h.remove(f)),f};var qOe=Cce;(function(t,e){var i=Lr,r=_L,n=qOe;function s(a,l){var c=new n(l);return c.process(a)}e=t.exports=s,e.filterXSS=s,e.FilterXSS=n,function(){for(var a in i)e[a]=i[a];for(var l in r)e[l]=r[l]}();function o(){return typeof self<"u"&&typeof DedicatedWorkerGlobalScope<"u"&&self instanceof DedicatedWorkerGlobalScope}o()&&(self.filterXSS=t.exports)})(E0,E0.exports);var WOe=function(){function t(e,i){var r=this;this.arcgisWhiteList={a:["href","style","target"],abbr:["title"],audio:["autoplay","controls","loop","muted","preload"],b:[],br:[],dd:["style"],div:["align","style"],dl:["style"],dt:["style"],em:[],figcaption:["style"],figure:["style"],font:["color","face","size","style"],h1:["style"],h2:["style"],h3:["style"],h4:["style"],h5:["style"],h6:["style"],hr:[],i:[],img:["alt","border","height","src","style","width"],li:[],ol:[],p:["style"],source:["media","src","type"],span:["style"],strong:[],sub:["style"],sup:["style"],table:["border","cellpadding","cellspacing","height","style","width"],tbody:[],tr:["align","height","style","valign"],td:["align","colspan","height","nowrap","rowspan","style","valign","width"],th:["align","colspan","height","nowrap","rowspan","style","valign","width"],u:[],ul:[],video:["autoplay","controls","height","loop","muted","poster","preload","width"]},this.allowedProtocols=["http","https","mailto","iform","tel","flow","lfmobile","arcgis-navigator","arcgis-appstudio-player","arcgis-survey123","arcgis-collector","arcgis-workforce","arcgis-explorer","arcgis-trek2there","arcgis-quickcapture","mspbi","comgooglemaps","pdfefile","pdfehttp","pdfehttps","boxapp","boxemm","awb","awbs","gropen","radarscope"],this.arcgisFilterOptions={allowCommentTag:!0,safeAttrValue:function(s,o,a,l){return s==="a"&&o==="href"||(s==="img"||s==="source")&&o==="src"?r.sanitizeUrl(a):E0.exports.safeAttrValue(s,o,a,l)}},this._entityMap={"&":"&#x38;","<":"&#x3C;",">":"&#x3E;",'"':"&#x22;","'":"&#x27;","/":"&#x2F;"};var n;e&&!i?n=e:e&&i?(n=Object.create(this.arcgisFilterOptions),Object.keys(e).forEach(function(s){s==="whiteList"?n.whiteList=r._extendObjectOfArrays([r.arcgisWhiteList,e.whiteList||{}]):n[s]=e[s]})):(n=Object.create(this.arcgisFilterOptions),n.whiteList=this.arcgisWhiteList),this.xssFilterOptions=n,this._xssFilter=new E0.exports.FilterXSS(n)}return t.prototype.sanitize=function(e,i){switch(i===void 0&&(i={}),typeof e){case"number":return isNaN(e)||!isFinite(e)?null:e;case"boolean":return e;case"string":return this._xssFilter.process(e);case"object":return this._iterateOverObject(e,i);default:return i.allowUndefined&&typeof e>"u"?void 0:null}},t.prototype.sanitizeUrl=function(e,i){var r=(i??{}).isProtocolRequired,n=r===void 0?!0:r,s=this._trim(e.substring(0,e.indexOf(":"))),o=e==="/",a=/^#/.test(e),l=s&&this.allowedProtocols.indexOf(s.toLowerCase())>-1;return o||a||l?E0.exports.escapeAttrValue(e):!s&&!n?E0.exports.escapeAttrValue("https://".concat(e)):""},t.prototype.sanitizeHTMLAttribute=function(e,i,r,n){return typeof this.xssFilterOptions.safeAttrValue=="function"?this.xssFilterOptions.safeAttrValue(e,i,r,n):E0.exports.safeAttrValue(e,i,r,n)},t.prototype.validate=function(e,i){i===void 0&&(i={});var r=this.sanitize(e,i);return{isValid:e===r,sanitized:r}},t.prototype.encodeHTML=function(e){var i=this;return String(e).replace(/[&<>"'\/]/g,function(r){return i._entityMap[r]})},t.prototype.encodeAttrValue=function(e){var i=/^[a-zA-Z0-9]$/;return String(e).replace(/[\x00-\xFF]/g,function(r,n){return i.test(r)?r:"&#x".concat(Number(e.charCodeAt(n)).toString(16),";")})},t.prototype._extendObjectOfArrays=function(e){var i={};return e.forEach(function(r){Object.keys(r).forEach(function(n){Array.isArray(r[n])&&Array.isArray(i[n])?i[n]=i[n].concat(r[n]):i[n]=r[n]})}),i},t.prototype._iterateOverObject=function(e,i){var r=this;i===void 0&&(i={});try{var n=!1,s=void 0;if(Array.isArray(e))s=e.reduce(function(a,l){var c=r.validate(l,i);return c.isValid?a.concat([l]):(n=!0,a.concat([c.sanitized]))},[]);else if(iOe(e)){var o=Object.keys(e);s=o.reduce(function(a,l){var c=e[l],u=r.validate(c,i);return u.isValid?a[l]=c:(n=!0,a[l]=u.sanitized),a},{})}else return i.allowUndefined&&typeof e>"u"?void 0:null;return n?s:e}catch{return null}},t.prototype._trim=function(e){return String.prototype.trim?e.trim():e.replace(/(^\s*)|(\s*$)/g,"")},t}();const bL=new Map;function Ece(){bL.clear()}function JOe(t){return bL.get(t)}function ZOe(t,e){bL.set(t,e)}function N3(t){bL.delete(t)}var Cv,a1,YOe=function(t){if("WebkitTransition"in t.style)Cv="webkitTransitionEnd",a1="webkitAnimationEnd";else{if(!("transition"in t.style))throw new Error("Your browser is not supported!");Cv="transitionend",a1="animationend"}},Mce=function(t){Cv||YOe(t)},KOe=function(t,e){return e===void 0&&(e=t+"-active"),function(i){Mce(i);var r=!1,n=function(s){r||(r=!0,i.removeEventListener(Cv,n),i.removeEventListener(a1,n),i.classList.remove(t),i.classList.remove(e))};i.classList.add(t),i.addEventListener(Cv,n),i.addEventListener(a1,n),requestAnimationFrame(function(){i.classList.add(e)})}},XOe=function(t,e){return e===void 0&&(e=t+"-active"),function(i,r){Mce(i);var n=!1,s=function(o){n||(n=!0,i.removeEventListener(Cv,s),i.removeEventListener(a1,s),r())};i.classList.add(t),i.addEventListener(Cv,s),i.addEventListener(a1,s),requestAnimationFrame(function(){i.classList.add(e)})}};const QOe=ie.getLogger("esri.widgets.support.widgetUtils");function q0(t){const e=Oo.acquire();for(let r=0;r<arguments.length;r++){const n=arguments[r],s=typeof n;if(s==="string")e.push(n);else if(Array.isArray(n))e.push.apply(e,n);else if(s==="object")for(const o in n)n[o]&&e.push(o)}const i=e.join(" ");return Oo.release(e),i}const eLe=(()=>{const t=new Map,e=new ResizeObserver(r=>{var n;Ece();for(const s of r)(n=t.get(s.target))==null||n(s)}),i=(r,n,s)=>(t.has(r)&&QOe.error("Already observing element",r),t.set(r,n),e.observe(r,s),Et(()=>{e.unobserve(r),t.delete(r)}));return(r,n,s)=>{let o=null;return J(()=>typeof r=="function"?r():r,a=>{o==null||o.remove(),a&&(o=i(a,n,s))},ji)}})();function ll(t){const e=t==null?void 0:t.closest("[dir]");return e!==null&&e instanceof HTMLElement&&e.dir==="rtl"||document.dir==="rtl"}function $ce(t){return ll(t)?"rtl":"ltr"}function TW(t){const e="data-node-ref";this[t.getAttribute(e)]=null}function Ed(t){const e="data-node-ref";this[t.getAttribute(e)]=t}function X0t(t,e){return(t==="enter"?KOe:XOe)(e)}const tLe=["dd","dl","dt","h1","h2","h3","h4","h5","h6","sub","sup","animate","animatetransform","circle","clippath","defs","ellipse","g","image","line","lineargradient","marker","mask","path","pattern","polygon","polyline","radialgradient","rect","stop","svg","switch","symbol","text","textpath","tspan","use"],iLe=tLe.reduce((t,e)=>(t[e]=[],t),{}),rLe=["align","alink","alt","bgcolor","border","cellpadding","cellspacing","class","color","cols","colspan","coords","d","dir","face","height","hspace","ismap","lang","marginheight","marginwidth","multiple","nohref","noresize","noshade","nowrap","ref","rel","rev","rows","rowspan","scrolling","shape","span","summary","tabindex","title","usemap","valign","value","vlink","vspace","width"],Km=new WOe({whiteList:iLe,onTagAttr:(t,e,i)=>{const r=`${e}="${i}"`;if(rLe.includes(e))return r},stripIgnoreTag:!0,stripIgnoreTagBody:["script","style"]},!0);function nLe(t,e){const i=t.getBoundingClientRect(),r=e.getBoundingClientRect(),n=i.top+i.height,s=r.top+r.height,o=i.top,a=r.top;(n>s||o<a)&&t.scrollIntoView({block:"end"})}function W0(t){return t==="Enter"||t===" "}const Ace="http://www.w3.org/",wL=`${Ace}2000/svg`,kce=`${Ace}1999/xlink`;let CW=[],LU=(t,e)=>{let i={};return Object.keys(t).forEach(r=>{i[r]=t[r]}),e&&Object.keys(e).forEach(r=>{i[r]=e[r]}),i},RU=(t,e)=>t.vnodeSelector===e.vnodeSelector&&(t.properties&&e.properties?t.properties.key===e.properties.key&&t.properties.bind===e.properties.bind:!t.properties&&!e.properties),Pce=t=>{if(typeof t!="string")throw new Error("Style values must be strings")},sLe=(t,e,i)=>{if(e.vnodeSelector!==""){for(let r=i;r<t.length;r++)if(RU(t[r],e))return r}return-1},V3=(t,e,i,r)=>{let n=t[e];if(n.vnodeSelector==="")return;let s=n.properties;if(!(s&&(s.key===void 0?s.bind:s.key))){for(let o=0;o<t.length;o++)if(o!==e){let a=t[o];if(RU(a,n))throw new Error(`${i.vnodeSelector} had a ${n.vnodeSelector} child ${r==="added"?r:"removed"}, but there is now more than one. You must add unique key properties to make them distinguishable.`)}}},oLe=t=>{if(t.properties){let e=t.properties.enterAnimation;e&&e(t.domNode,t.properties)}},P4=[],O4=!1,Oce=t=>{(t.children||[]).forEach(Oce),t.properties&&t.properties.afterRemoved&&t.properties.afterRemoved.apply(t.properties.bind||t.properties,[t.domNode])},EW=()=>{O4=!1,P4.forEach(Oce),P4.length=0},MW=t=>{P4.push(t),O4||(O4=!0,typeof window<"u"&&"requestIdleCallback"in window?window.requestIdleCallback(EW,{timeout:16}):setTimeout(EW,16))},$W=t=>{let e=t.domNode;if(t.properties){let i=t.properties.exitAnimation;if(i)return e.style.pointerEvents="none",void i(e,()=>{e.parentNode&&(e.parentNode.removeChild(e),MW(t))},t.properties)}e.parentNode&&(e.parentNode.removeChild(e),MW(t))},aLe=(t,e,i)=>{if(!e)return;let r=i.eventHandlerInterceptor,n=Object.keys(e),s=n.length;for(let o=0;o<s;o++){let a=n[o],l=e[a];if(a==="className")throw new Error('Property "className" is not supported, use "class".');if(a==="class")L4(t,l,!0);else if(a==="classes"){let c=Object.keys(l),u=c.length;for(let h=0;h<u;h++){let f=c[h];l[f]&&t.classList.add(f)}}else if(a==="styles"){let c=Object.keys(l),u=c.length;for(let h=0;h<u;h++){let f=c[h],m=l[f];m&&(Pce(m),i.styleApplyer(t,f,m))}}else if(a!=="key"&&l!=null){let c=typeof l;c==="function"?(a.lastIndexOf("on",0)===0&&(r&&(l=r(a,l,t,e)),a==="oninput"&&function(){let u=l;l=function(h){u.apply(this,[h]),h.target["oninput-value"]=h.target.value}}()),t[a]=l):i.namespace===wL?a==="href"?t.setAttributeNS(kce,a,l):t.setAttribute(a,l):c==="string"&&a!=="value"?a==="innerHTML"?t[a]=Km.sanitize(l):Lce(t)&&a in t?t[a]=l:t.setAttribute(a,l):t[a]=l}}};function Lce(t){if(!(t instanceof Element&&t.tagName.includes("-")))return!1;const e=window.customElements.get(t.tagName.toLowerCase());return!!e&&t instanceof e}let uP,lLe=(t,e,i)=>{if(e)for(let r of e)lw(r,t,void 0,i)},Rce=(t,e,i)=>{lLe(t,e.children,i),e.text&&(t.textContent=e.text),aLe(t,e.properties,i),e.properties&&e.properties.afterCreate&&e.properties.afterCreate.apply(e.properties.bind||e.properties,[t,i,e.vnodeSelector,e.properties,e.children])},lw=(t,e,i,r)=>{let n,s=0,o=t.vnodeSelector,a=e.ownerDocument;if(o==="")n=t.domNode=a.createTextNode(t.text),i!==void 0?e.insertBefore(n,i):e.appendChild(n);else{for(let l=0;l<=o.length;++l){let c=o.charAt(l);if(l===o.length||c==="."||c==="#"){let u=o.charAt(s-1),h=o.slice(s,l);u==="."?n.classList.add(h):u==="#"?n.id=h:(h==="svg"&&(r=LU(r,{namespace:wL})),r.namespace!==void 0?n=t.domNode=a.createElementNS(r.namespace,h):(n=t.domNode=t.domNode||a.createElement(h),h==="input"&&t.properties&&t.properties.type!==void 0&&n.setAttribute("type",t.properties.type)),i!==void 0?e.insertBefore(n,i):n.parentNode!==e&&e.appendChild(n)),s=l+1}}Rce(n,t,r)}},L4=(t,e,i)=>{e&&e.split(" ").forEach(r=>{r&&t.classList.toggle(r,i)})},cLe=(t,e,i,r)=>{if(!i)return;let n=!1,s=Object.keys(i),o=s.length;for(let a=0;a<o;a++){let l=s[a],c=i[l],u=e[l];if(l==="class")u!==c&&(L4(t,u,!1),L4(t,c,!0));else if(l==="classes"){let h=t.classList,f=Object.keys(c),m=f.length;for(let g=0;g<m;g++){let y=f[g],v=!!c[y];v!==!!u[y]&&(n=!0,v?h.add(y):h.remove(y))}}else if(l==="styles"){let h=Object.keys(c),f=h.length;for(let m=0;m<f;m++){let g=h[m],y=c[g];y!==u[g]&&(n=!0,y?(Pce(y),r.styleApplyer(t,g,y)):r.styleApplyer(t,g,""))}}else if(c||typeof u!="string"||(c=""),l==="value"){let h=t[l];h!==c&&(t["oninput-value"]?h===t["oninput-value"]:c!==u)&&(t[l]=c,t["oninput-value"]=void 0),c!==u&&(n=!0)}else if(c!==u){let h=typeof c;h==="function"&&r.eventHandlerInterceptor||(r.namespace===wL?l==="href"?t.setAttributeNS(kce,l,c):t.setAttribute(l,c):h==="string"?l==="innerHTML"?t[l]=Km.sanitize(c):l==="role"&&c===""?t.removeAttribute(l):Lce(t)&&l in t?t[l]=c:t.setAttribute(l,c):t[l]!==c&&(t[l]=c),n=!0)}}return n},uLe=(t,e,i,r,n)=>{if(i===r)return!1;r=r||CW;let s,o=(i=i||CW).length,a=r.length,l=0,c=0,u=!1;for(;c<a;){let h=l<o?i[l]:void 0,f=r[c];if(h!==void 0&&RU(h,f))u=uP(h,f,n)||u,l++;else{let m=sLe(i,f,l+1);if(m>=0){for(s=l;s<m;s++)$W(i[s]),V3(i,s,t,"removed");u=uP(i[m],f,n)||u,l=m+1}else lw(f,e,l<o?i[l].domNode:void 0,n),oLe(f),V3(r,c,t,"added")}c++}if(o>l)for(s=l;s<o;s++)$W(i[s]),V3(i,s,t,"removed");return u};uP=(t,e,i)=>{let r=t.domNode,n=!1;if(t===e)return!1;let s=!1;if(e.vnodeSelector===""){if(e.text!==t.text){let o=r.ownerDocument.createTextNode(e.text);return r.parentNode.replaceChild(o,r),e.domNode=o,n=!0,n}e.domNode=r}else e.vnodeSelector.lastIndexOf("svg",0)===0&&(i=LU(i,{namespace:wL})),t.text!==e.text&&(s=!0,e.text===void 0?r.removeChild(r.firstChild):r.textContent=e.text),e.domNode=r,s=uLe(e,r,t.children,e.children,i)||s,s=cLe(r,t.properties,e.properties,i)||s,e.properties&&e.properties.afterUpdate&&e.properties.afterUpdate.apply(e.properties.bind||e.properties,[r,i,e.vnodeSelector,e.properties,e.children]);return s&&e.properties&&e.properties.updateAnimation&&e.properties.updateAnimation(r,e.properties,t.properties),n};let $x=(t,e)=>({getLastRender:()=>t,update:i=>{if(t.vnodeSelector!==i.vnodeSelector)throw new Error("The selector for the root VNode may not be changed. (consider using dom.merge and add one extra level to the virtual DOM)");let r=t;t=i,uP(r,i,e)},domNode:t.domNode});const dLe={namespace:void 0,performanceLogger:()=>{},eventHandlerInterceptor:void 0,styleApplyer:(t,e,i)=>{e.charAt(0)==="-"?t.style.setProperty(e,i):t.style[e]=i}};let rb=t=>LU(dLe,t),Lm={create:(t,e)=>(e=rb(e),lw(t,document.createElement("div"),void 0,e),$x(t,e)),append:(t,e,i)=>(i=rb(i),lw(e,t,void 0,i),$x(e,i)),insertBefore:(t,e,i)=>(i=rb(i),lw(e,t.parentNode,t,i),$x(e,i)),merge:(t,e,i)=>(i=rb(i),e.domNode=t,Rce(t,e,i),$x(e,i)),replace:(t,e,i)=>(i=rb(i),lw(e,t.parentNode,t,i),t.parentNode.removeChild(t),$x(e,i))},Fce,hLe=(t,e)=>{let i=[];for(;t&&t!==e;)i.push(t),t=t.parentNode;return i};Fce=Array.prototype.find?(t,e)=>t.find(e):(t,e)=>t.filter(e)[0];let pLe=(t,e)=>{let i=t;return e.forEach(r=>{i=i&&i.children?Fce(i.children,n=>n.domNode===r):void 0}),i},fLe=(t,e,i)=>{let r=function(n){i("domEvent",n);let s=e(),o=hLe(n.currentTarget,s.domNode);o.reverse();let a,l=pLe(s.getLastRender(),o);return t.scheduleRender(),l&&(a=l.properties[`on${n.type}`].apply(l.properties.bind||this,arguments)),i("domEventProcessed",n),a};return(n,s,o,a)=>r},dP=t=>{let e,i,r=rb(t),n=r.performanceLogger,s=!0,o=!1,a=[],l=[],c=(h,f,m)=>{let g,y=()=>g;r.eventHandlerInterceptor=fLe(e,y,n),g=h(f,m(),r),a.push(g),l.push(m)},u=()=>{if(i=void 0,s){s=!1,n("renderStart",void 0);for(let h=0;h<a.length;h++){let f=l[h]();n("rendered",void 0),a[h].update(f),n("patched",void 0)}n("renderDone",void 0),s=!0}};return e={renderNow:u,scheduleRender:()=>{i||o||(i=requestAnimationFrame(u))},stop:()=>{i&&(cancelAnimationFrame(i),i=void 0),o=!0},resume:()=>{o=!1,s=!0,e.scheduleRender()},append:(h,f)=>{c(Lm.append,h,f)},insertBefore:(h,f)=>{c(Lm.insertBefore,h,f)},merge:(h,f)=>{c(Lm.merge,h,f)},replace:(h,f)=>{c(Lm.replace,h,f)},detach:h=>{for(let f=0;f<l.length;f++)if(l[f]===h)return l.splice(f,1),a.splice(f,1)[0];throw new Error("renderFunction was not found")}},e},xf=class extends he{constructor(){super(...arguments),this.items=new ye,this._watchUpdatingTracking=new nv,this._callbacks=new Map,this._projector=dP(),this._hiddenProjector=dP()}get needsRender(){return this.items.length>0}get updating(){var e;return((e=this._watchUpdatingTracking)==null?void 0:e.updating)??!1}initialize(){const e=document.createElement("div");e.className="esri-overlay-surface",this._set("surface",e),this._hiddenSurface=document.createElement("div"),this._hiddenSurface.setAttribute("style","visibility: hidden;"),e.appendChild(this._hiddenSurface),this._watchUpdatingTracking.addOnCollectionChange(()=>this.items,i=>{for(const r of i.added){const n=()=>r.render();this._callbacks.set(r,n),this._projector.append(this.surface,n)}for(const r of i.removed){const n=this._projector.detach(this._callbacks.get(r));this.surface.removeChild(n.domNode),this._callbacks.delete(r)}})}addItem(e){this.items.add(e)}removeItem(e){this.items.remove(e)}destroy(){this.items.removeAll(),this._callbacks.forEach(e=>this._projector.detach(e)),this._callbacks=null,this._projector=null,this._watchUpdatingTracking.destroy()}render(){this._projector.renderNow()}computeBoundingRect(e){const i=this._hiddenSurface,r=this._hiddenProjector;let n;const s=()=>(n=e.render(),n);r.append(i,s),r.renderNow();const o={left:0,top:0,right:0,bottom:0};if(n&&n.domNode){const a=n.domNode.getBoundingClientRect();o.left=a.left,o.top=a.top,o.right=a.right,o.bottom=a.bottom}for(r.detach(s);i.firstChild;)i.removeChild(i.firstChild);return o}overlaps(e,i){const r=this.computeBoundingRect(e),n=this.computeBoundingRect(i);return Math.max(r.left,n.left)<=Math.min(r.right,n.right)&&Math.max(r.top,n.top)<=Math.min(r.bottom,n.bottom)}get hasVisibleItems(){return this.items.some(e=>e.visible)}async prepare(){await document.fonts.load(this._fontString()).catch(()=>{})}renderCanvas(e){if(!this.items.some(r=>r.visible))return;const i=e.getContext("2d");i.save(),i.font=this._fontString(),this.items.forEach(r=>{i.save(),r.renderCanvas(i),i.restore()}),i.restore()}_fontString(){return`10px ${getComputedStyle(this.surface).fontFamily}`}};d([p({readOnly:!0})],xf.prototype,"surface",void 0),d([p({readOnly:!0})],xf.prototype,"items",void 0),d([p({readOnly:!0})],xf.prototype,"needsRender",null),d([p({readOnly:!0})],xf.prototype,"_watchUpdatingTracking",void 0),d([p({readOnly:!0})],xf.prototype,"updating",null),xf=d([A("esri.views.overlay.ViewOverlay")],xf);const AW=xf,z3=[0,0];function mLe(t){const e=(t.ownerDocument||window.document).defaultView,i=t.getBoundingClientRect();return z3[0]=i.left+((e==null?void 0:e.pageXOffset)??0),z3[1]=i.top+((e==null?void 0:e.pageYOffset)??0),z3}function kW(t){t&&(hce(t),t.parentNode&&t.parentNode.removeChild(t))}function gLe(t){const e=document.createElement("div");return t.appendChild(e),e}const Ax=16,DE=750,yLe=512,vLe=2,_Le=t=>{let e=class extends t{constructor(...i){super(...i),this._freqInfo={freq:Ax,time:DE},this._overlayRenderTaskHandle=null,this.height=0,this.overlay=null,this.position=null,this.resizing=!1,this.root=null,this.surface=null,this.suspended=!0,this.ui=null,this.userContent=null,this.width=0,this.widthBreakpoint=null,this.addHandles([J(()=>this.cursor,r=>{const{surface:n}=this;n&&n.setAttribute("data-cursor",r)}),J(()=>this.navigating,r=>{const{surface:n}=this;n&&n.setAttribute("data-navigating",r.toString())})])}initialize(){this.addHandles([J(()=>this.ui,(i,r)=>this._handleUIChange(i,r),Le),this.on("focus",()=>this.notifyChange("focused")),this.on("blur",()=>this.notifyChange("focused"))])}destroy(){this.destroyed||(this.ui=je(this.ui),this.container=null)}get container(){return this._get("container")??null}set container(i){const r=this._get("container"),n=vL(i);if(n||typeof i!="string"||ie.getLogger(this).error("#container",`element with id '${i}' not found`),r===n)return;if(this._stopMeasuring(),r&&(r.classList.remove("esri-view"),this._overlayRenderTaskHandle&&(this._overlayRenderTaskHandle.remove(),this._overlayRenderTaskHandle=null),this.overlay&&(this.overlay.destroy(),this._set("overlay",null)),this.root&&(kW(this.root),this._set("root",null)),this.userContent&&(bW(this.userContent,r),kW(this.userContent),this._set("userContent",null))),!n)return this._set("width",0),this._set("height",0),this._set("position",null),this._set("suspended",!0),this._set("surface",null),void this._set("container",null);n.classList.add("esri-view");const s=document.createElement("div");s.className="esri-view-user-storage",bW(n,s),n.appendChild(s),this._set("userContent",s);const o=document.createElement("div");o.className="esri-view-root",n.insertBefore(o,n.firstChild),this._set("root",o);const a=document.createElement("div");a.className="esri-view-surface",a.setAttribute("role","application"),a.tabIndex=0,o.appendChild(a),this._set("surface",a);const l=new AW;o.appendChild(l.surface),this._set("overlay",l),this.addHandles(J(()=>l.needsRender,c=>{c&&!this._overlayRenderTaskHandle?this._overlayRenderTaskHandle=Jw({render:()=>{var u;return(u=this.overlay)==null?void 0:u.render()}}):this._overlayRenderTaskHandle=$i(this._overlayRenderTaskHandle)})),this.forceDOMReadyCycle(),this._set("container",n),this._startMeasuring()}get focused(){const i=document.activeElement===this.surface;return document.hasFocus()&&i}get size(){return[this.width,this.height]}blur(){var i;(i=this.surface)==null||i.blur()}focus(){var i;(i=this.surface)==null||i.focus()}pageToContainer(i,r,n){const s=this.position;return i-=s?s[0]:0,r-=s?s[1]:0,n?(n[0]=i,n[1]=r):n=[i,r],n}containerToPage(i,r,n){const s=this.position;return i+=s?s[0]:0,r+=s?s[1]:0,n?(n[0]=i,n[1]=r):n=[i,r],n}_handleUIChange(i,r){this.removeHandles("ui"),r&&r!==i&&r.destroy(),i&&(i.view=this,this.addHandles(J(()=>this.root,n=>{i.container=n?gLe(n):null},Le),"ui")),this._set("ui",i)}_stopMeasuring(){this.removeHandles("measuring"),this._get("resizing")&&this._set("resizing",!1)}_startMeasuring(){const i=this._freqInfo;i.freq=Ax,i.time=DE,this.addHandles([(()=>{const r=()=>{i.freq=Ax,i.time=DE};return window.addEventListener("resize",r),{remove(){window.removeEventListener("resize",r)}}})(),Jw({prepare:r=>{const n=this._measure(),s=this._freqInfo;if(s.time+=r.deltaTime,n&&(s.freq=Ax,this._get("resizing")||this._set("resizing",!0)),s.time<s.freq)return;s.time=0;const o=this._position();s.freq=o||n?Ax:Math.min(DE,s.freq*vLe),!n&&s.freq>=yLe&&this._get("resizing")&&this._set("resizing",!1)}})],"measuring"),this._measure(),this._position()}_measure(){const i=this.container,r=i?i.clientWidth:0,n=i?i.clientHeight:0;if(r===0||n===0)return this.suspended||this._set("suspended",!0),!1;const s=this.width,o=this.height;return r===s&&n===o?(this.suspended&&this._set("suspended",!1),!1):(this._set("width",r),this._set("height",n),this.suspended&&this._set("suspended",!1),this.emit("resize",{oldWidth:s,oldHeight:o,width:r,height:n}),!0)}_position(){const i=this.container,r=this.position,n=i&&mLe(i);return!!n&&(!r||n[0]!==r[0]||n[1]!==r[1])&&(this._set("position",[n[0],n[1]]),!0)}forceDOMReadyCycle(){}};return d([p()],e.prototype,"container",null),d([p({readOnly:!0})],e.prototype,"focused",null),d([p({readOnly:!0})],e.prototype,"height",void 0),d([p({type:AW})],e.prototype,"overlay",void 0),d([p({readOnly:!0})],e.prototype,"position",void 0),d([p({readOnly:!0})],e.prototype,"resizing",void 0),d([p({readOnly:!0})],e.prototype,"root",void 0),d([p({value:null,readOnly:!0})],e.prototype,"size",null),d([p({readOnly:!0})],e.prototype,"surface",void 0),d([p({readOnly:!0})],e.prototype,"suspended",void 0),d([p()],e.prototype,"ui",void 0),d([p({readOnly:!0})],e.prototype,"userContent",void 0),d([p({readOnly:!0})],e.prototype,"width",void 0),d([p()],e.prototype,"widthBreakpoint",void 0),e=d([A("esri.views.DOMContainer")],e),e};let bLe=class{constructor(e,i){this._owner=i,this._properties={},this._afterDispatchHandle=null;for(const r in e){const n=e[r],s=new Qre(n,void 0,void 0,2,2);this._properties[r]={pool:s,acquired:[]}}this._afterDispatchHandle=dxe(()=>this._release())}destroy(){this._afterDispatchHandle&&(this._afterDispatchHandle.remove(),this._afterDispatchHandle=null);for(const e in this._properties){const i=this._properties[e];for(const r of i.acquired)AH(r)||i.pool.release(r);i.pool.destroy(),i.pool=null,i.acquired=null}this._properties=null,this._owner=null}get(e){const i=this._owner._get(e),r=this._properties[e];let n=r.pool.acquire();for(r.acquired.push(n);n===i;)r.acquired.push(n),n=r.pool.acquire();return n}_release(){for(const e in this._properties){const i=this._properties[e];let r=0;for(const n of i.acquired)AH(n)?i.acquired[r++]=n:i.pool.release(n);i.acquired.length=r}}};const wLe=ee("mac")?"Meta":"Ctrl",xL={8:"Backspace",9:"Tab",13:"Enter",27:"Escape",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete"};for(let t=48;t<58;t++)xL[t]=String.fromCharCode(t);for(let t=1;t<25;t++)xL[111+t]=`F${t}`;for(let t=65;t<91;t++)xL[t]=[String.fromCharCode(t+32),String.fromCharCode(t)];function xLe(t){if(t.key!==void 0)return ip(t);const e=xL[t.keyCode];return Array.isArray(e)?t.shiftKey?e[1]:e[0]:e}function SLe(t){switch(t){case"Ctrl":case"Alt":case"Shift":case"Meta":case"Primary":return!0}return!1}let ILe=class{constructor(e,i=[]){this.eventType=e,this.keyModifiers=i}matches(e){if(e.type!==this.eventType)return!1;if(this.keyModifiers.length===0)return!0;const i=e.modifiers;for(const r of this.keyModifiers)if(!i.has(r))return!1;return!0}};const PW=ie.getLogger("esri.views.input.InputHandler");let Kn=class{constructor(e){this._manager=null,this._incoming={},this._outgoing={},this._incomingEventMatches=null,this._incomingEventTypes=null,this._outgoingEventTypes=null,this._hasSideEffects=e}get incomingEventMatches(){if(!this._incomingEventMatches){this._incomingEventMatches=[];for(const e in this._incoming){const i=this._incoming[e];for(const r of i)this._incomingEventMatches.push(r.match)}}return this._incomingEventMatches}get incomingEventTypes(){return this._incomingEventTypes||(this._incomingEventTypes=this.incomingEventMatches.map(e=>e.eventType)),this._incomingEventTypes}get outgoingEventTypes(){return this._outgoingEventTypes||(this._outgoingEventTypes=Object.keys(this._outgoing)),this._outgoingEventTypes}get hasSideEffects(){return this._hasSideEffects}get hasPendingInputs(){return!1}onInstall(e){this._manager?PW.error("This InputHandler has already been registered with an InputManager"):(e.setEventCallback(i=>this._handleEvent(i)),e.setUninstallCallback(()=>this._onUninstall()),this._manager=e)}onUninstall(){}registerIncoming(e,i,r){let n;typeof i=="function"?(r=i,n=[]):n=i||[];const s=typeof e=="string"?new ILe(e,n):e,o=()=>{this._incomingEventTypes=null,this._incomingEventMatches=null},a=u=>{const h=this._incoming[u.match.eventType];if(h){const f=h.indexOf(u);h.splice(f,1),o(),this._manager&&this._manager.updateDependencies()}},l=new TLe(s,r,{onPause:a,onRemove:a,onResume:u=>{const h=this._incoming[u.match.eventType];h&&!h.includes(u)&&(h.push(u),o(),this._manager&&this._manager.updateDependencies())}});let c=this._incoming[s.eventType];return c||(c=[],this._incoming[s.eventType]=c),c.push(l),o(),this._manager&&this._manager.updateDependencies(),l}registerOutgoing(e){if(this._outgoing[e])throw new Error("There is already a callback registered for this outgoing InputEvent: "+e);const i=new CLe(e,{onEmit:(r,n,s,o)=>{var a;(a=this._manager)==null||a.emit(r.eventType,n,s,o)},onRemove:r=>{var n;delete this._outgoing[r.eventType],(n=this._manager)==null||n.updateDependencies()}});return this._outgoing[e]=i,this._outgoingEventTypes=null,this._manager&&this._manager.updateDependencies(),i}startCapturingPointer(e){var i;(i=this._manager)==null||i.setPointerCapture(e,!0)}stopCapturingPointer(e){var i;(i=this._manager)==null||i.setPointerCapture(e,!1)}refreshHasPendingInputs(){var e;(e=this._manager)==null||e.refreshHasPendingInputs()}_onUninstall(){this._manager?(this.onUninstall(),this._manager=null):PW.error("This InputHandler is not registered with an InputManager")}_handleEvent(e){var r;const i=this._incoming[e.type];if(i){for(const n of i)if(n.match.matches(e)&&((r=n.callback)==null||r.call(n,e),e.shouldStopPropagation()))break}}},TLe=class{constructor(e,i,r){this.match=e,this._callback=i,this._handler=r}pause(){this._handler.onPause(this)}resume(){this._handler.onResume(this)}remove(){this._handler.onRemove(this)}get callback(){return this._callback}},CLe=class{constructor(e,i){this.eventType=e,this._removed=!1,this._handler=i}emit(e,i,r){this._removed||this._handler.onEmit(this,e,i,r)}remove(){this._removed=!0,this._handler.onRemove(this)}},ELe=class extends Kn{constructor(e){super(!0),this._onChange=e,this._value="mouse",this._x=null,this._y=null,this.registerIncoming("pointer-move",i=>{this._update(i.data)})}_update(e){const i=e.native.pointerType==="touch"?"touch":"mouse",{x:r,y:n}=e;i===this._value&&this._x===r&&this._y===n||(this._value=i,this._x=r,this._y=n,this._onChange(i,r,n))}},MLe=class{constructor(e,i){this._observable=new qO,this._value=e,this._equalityFunction=i}get value(){return Ke(this._observable),this._value}set value(e){this._equalityFunction(e,this._value)||(this._value=e,this._observable.notify())}mutate(e){e(this._value),this._observable.notify()}};function hP(t,e=Rre){return new MLe(t,e)}let $Le=class extends Kn{get multiTouchActive(){return this._multiTouchActive.value}constructor(){super(!0),this._activeTouchPointerIds=new Set,this._multiTouchActive=hP(!1),this._onPointerAdd=({data:e})=>{e.pointerType==="touch"&&(this._activeTouchPointerIds.add(e.native.pointerId),this._update())},this._onPointerRemove=({data:e})=>{e.pointerType==="touch"&&(this._activeTouchPointerIds.delete(e.native.pointerId),this._update())},this.registerIncoming("pointer-down",this._onPointerAdd),this.registerIncoming("pointer-up",this._onPointerRemove),this.registerIncoming("pointer-capture-lost",this._onPointerRemove),this.registerIncoming("pointer-cancel",this._onPointerRemove)}_update(){this._multiTouchActive.value=this._activeTouchPointerIds.size>1}},El=class extends he{constructor(e){super(e),this._pointerCaptures=new Map,this._nameToGroup={},this._handlers=[],this._handlersPriority=[],this._currentPropagation=null,this._updateDependenciesAfterPropagation=!1,this._sourceEvents=new Set,this._keyModifiers=new Set,this._activeKeyModifiers=new Set,this._stoppedPropagationEventIds=new Set,this.primaryKey=wLe,this._latestPointerType="mouse",this._propertiesPool=new bLe({latestPointerLocation:PLe},this),this.latestPointerLocation=null,this._paused=!1,this.test={timestamp:void 0,hasCurrentPropagation:()=>!!this._currentPropagation}}initialize(){this.eventSource.onEventReceived=this._onEventReceived.bind(this),this._installRecognizers()}destroy(){const e=Object.keys(this._nameToGroup);for(const i of e)this.uninstallHandlers(i);this.eventSource.destroy(),this._currentPropagation=null,this._propertiesPool.destroy()}get hasPendingInputs(){return this._handlers.some(e=>e.handler.hasPendingInputs)}get latestPointerType(){return this._latestPointerType}get multiTouchActive(){return this._multiTouchHandler.multiTouchActive}get updating(){return this.hasPendingInputs||this._paused}installHandlers(e,i,r=Pi.INTERNAL){if(this._nameToGroup[e])return void ie.getLogger(this).error("There is already an InputHandler group registered under the name `"+e+"`");if(i.length===0)return void ie.getLogger(this).error("Can't register a group of zero handlers");const n={name:e,handlers:i.map(s=>({handler:s,active:!0,removed:!1,priorityIndex:0,groupPriority:r,eventCallback:null,uninstallCallback:null}))};this._nameToGroup[e]=n;for(let s=n.handlers.length-1;s>=0;s--){const o=n.handlers[s];this._handlers.push(o),o.handler.onInstall({updateDependencies:()=>{this.updateDependencies()},emit:(a,l,c,u,h)=>{this._emitInputEvent(o.priorityIndex+1,a,l,c,h,u)},setPointerCapture:(a,l)=>{this._setPointerCapture(n,o,a,l)},setEventCallback:a=>{o.eventCallback=a},setUninstallCallback:a=>{o.uninstallCallback=a},refreshHasPendingInputs:()=>{this.notifyChange("hasPendingInputs")}})}this.updateDependencies()}uninstallHandlers(e){const i=this._nameToGroup[e];i?(i.handlers.forEach(r=>{var n;r.removed=!0,(n=r.uninstallCallback)==null||n.call(r)}),delete this._nameToGroup[e],this._currentPropagation?this._currentPropagation.needsHandlerGarbageCollect=!0:this._garbageCollectRemovedHandlers()):ie.getLogger(this).error("There is no InputHandler group registered under the name `"+e+"`")}hasHandlers(e){return this._nameToGroup[e]!==void 0}updateDependencies(){if(this._currentPropagation)return void(this._updateDependenciesAfterPropagation=!0);this._updateDependenciesAfterPropagation=!1;const e=new Set,i=new Set;this._handlersPriority=[];for(let r=this._handlers.length-1;r>=0;r--){const n=this._handlers[r];n.priorityIndex=r,this._handlersPriority.push(n)}this._handlersPriority=this._sortHandlersPriority(this._handlersPriority);for(let r=this._handlersPriority.length-1;r>=0;r--){const n=this._handlersPriority[r];n.priorityIndex=r;let s=n.handler.hasSideEffects;if(!s){for(const o of n.handler.outgoingEventTypes)if(e.has(o)){s=!0;break}}if(s)for(const o of n.handler.incomingEventMatches){e.add(o.eventType);for(const a of o.keyModifiers)SLe(a)||i.add(a)}n.active=s}this._sourceEvents=e,this._keyModifiers=i,this._pointerCaptures.size>0&&this._sourceEvents.add("pointer-capture-lost"),this._keyModifiers.size>0&&(this._sourceEvents.add("key-down"),this._sourceEvents.add("key-up")),this.eventSource&&(this.eventSource.activeEvents=this._sourceEvents)}_setLatestPointer(e,i,r){this._latestPointerType=e;const n=this._get("latestPointerLocation");if(n==null||n.x!==i||n.y!==r){const s=this._propertiesPool.get("latestPointerLocation");s.x=i,s.y=r,this._set("latestPointerLocation",s)}}_onEventReceived(e,i){if(e==="pointer-capture-lost"){const s=i;this._pointerCaptures.delete(s.native.pointerId)}this._updateKeyModifiers(e,i);const r=this.test.timestamp!=null?this.test.timestamp:i.native?i.native.timestamp:void 0,n=i.native?i.native.cancelable:void 0;this._emitInputEventFromSource(e,i,r,n)}_updateKeyModifiers(e,i){if(!i)return;let r=!1;const n=()=>{if(!r){const a=new Set;this._activeKeyModifiers.forEach(l=>{a.add(l)}),this._activeKeyModifiers=a,r=!0}},s=(a,l)=>{l&&!this._activeKeyModifiers.has(a)?(n(),this._activeKeyModifiers.add(a)):!l&&this._activeKeyModifiers.has(a)&&(n(),this._activeKeyModifiers.delete(a))};if(e==="key-down"||e==="key-up"){const a=i.key;this._keyModifiers.has(a)&&s(a,e==="key-down")}const o=i.native;s("Alt",!(!o||!o.altKey)),s("Ctrl",!(!o||!o.ctrlKey)),s("Shift",!(!o||!o.shiftKey)),s("Meta",!(!o||!o.metaKey)),s("Primary",this._activeKeyModifiers.has(this.primaryKey))}_installRecognizers(){this._latestPointerHandler=new ELe((e,i,r)=>this._setLatestPointer(e,i,r)),this._multiTouchHandler=new $Le,this.installHandlers("input-manager-logic",[this._latestPointerHandler,this._multiTouchHandler],Pi.ALWAYS),this.recognizers.length>0&&this.installHandlers("default",this.recognizers,Pi.INTERNAL)}_setPointerCapture(e,i,r,n){const s=e.name+"-"+i.priorityIndex,o=this._pointerCaptures.get(r.pointerId)||new Set;this._pointerCaptures.set(r.pointerId,o),n?(o.add(s),o.size===1&&this.eventSource&&this.eventSource.setPointerCapture(r,!0)):o.has(s)&&(o.delete(s),o.size===0&&(this._pointerCaptures.delete(r.pointerId),this.eventSource&&this.eventSource.setPointerCapture(r,!1)))}_garbageCollectRemovedHandlers(){this._handlers=this._handlers.filter(e=>!e.removed),this.updateDependencies()}_emitInputEventFromSource(e,i,r,n){this._emitInputEvent(0,e,i,r,n)}_emitInputEvent(e,i,r,n,s,o){const a=n!==void 0?n:this._currentPropagation?this._currentPropagation.timestamp:performance.now(),l=s!==void 0&&s,c={event:new ALe(i,r,a,o||this._activeKeyModifiers,l),priorityIndex:e};this._currentPropagation?this._currentPropagation.events.push(c):this._doNewPropagation(c)}_doNewPropagation(e){this._currentPropagation={events:new iT,currentHandler:null,needsHandlerGarbageCollect:!1,timestamp:e.event.timestamp},this._currentPropagation.events.push(e),this._continuePropagation()}_continuePropagation(){var i,r;this._paused=!1;const e=this._currentPropagation;if(e){for(;e.events.length>0;){const{event:n,priorityIndex:s}=e.events.pop(),o=n.data&&n.data.eventId;if(!(o!=null&&this._stoppedPropagationEventIds.has(o)))for(e.currentHandler=this._handlersPriority[s];e.currentHandler;){if(e.currentHandler.removed)e.needsHandlerGarbageCollect=!0;else{if(e.currentHandler.active&&!n.shouldStopPropagation()&&((r=(i=e.currentHandler).eventCallback)==null||r.call(i,n)),n.shouldStopPropagation()){o!=null&&this._stoppedPropagationEventIds.add(o);break}if(n.shouldPausePropagation(()=>this._continuePropagation()))return void this._pausePropagation({event:n,priorityIndex:e.currentHandler.priorityIndex+1})}e.currentHandler=this._handlersPriority[e.currentHandler.priorityIndex+1]}}e.needsHandlerGarbageCollect&&this._garbageCollectRemovedHandlers(),this.hasPendingInputs||this._stoppedPropagationEventIds.clear(),this._currentPropagation=null,this._updateDependenciesAfterPropagation&&this.updateDependencies()}}_pausePropagation(e){const i=new iT;i.push(e);const r=this._currentPropagation;if(r){for(;r.events.length;)i.push(r.events.pop());r.events=i,r.currentHandler=null,this._paused=!0}}_compareHandlerPriority(e,i){if(e.handler.hasSideEffects!==i.handler.hasSideEffects)return e.handler.hasSideEffects?1:-1;if(e.groupPriority!==i.groupPriority)return e.groupPriority>i.groupPriority?-1:1;for(const r of e.handler.incomingEventMatches)for(const n of i.handler.incomingEventMatches){if(r.eventType!==n.eventType)continue;const s=r.keyModifiers.filter(o=>n.keyModifiers.includes(o));if(s.length===r.keyModifiers.length!=(s.length===n.keyModifiers.length))return r.keyModifiers.length>n.keyModifiers.length?-1:1}return e.priorityIndex>i.priorityIndex?-1:1}_sortHandlersPriority(e){const i=[];for(const r of e){let n=0;for(;n<i.length&&this._compareHandlerPriority(r,i[n])>=0;)n++;i.splice(n,0,r)}return i}get debug(){const e=i=>{const r=this._setPointerCapture;this._setPointerCapture=()=>{},i(),this._setPointerCapture=r};return{injectEvent:(i,r)=>{e(()=>{this._onEventReceived(i,r)})},disablePointerCapture:e}}};d([p({readOnly:!0})],El.prototype,"hasPendingInputs",null),d([p({constructOnly:!0})],El.prototype,"eventSource",void 0),d([p({constructOnly:!0})],El.prototype,"recognizers",void 0),d([p()],El.prototype,"_latestPointerType",void 0),d([p()],El.prototype,"latestPointerType",null),d([p()],El.prototype,"multiTouchActive",null),d([p({readOnly:!0})],El.prototype,"latestPointerLocation",void 0),d([p()],El.prototype,"_paused",void 0),d([p({readOnly:!0})],El.prototype,"updating",null),El=d([A("esri.views.input.InputManager")],El);let ALe=class{constructor(e,i,r,n,s){this.type=e,this.data=i,this.timestamp=r,this.modifiers=n,this.cancelable=s,this._propagationState=dm.NONE,this._resumeCallback=null}stopPropagation(){this._propagationState|=dm.STOPPED}shouldStopPropagation(){return(this._propagationState&dm.STOPPED)!=0}async(e){this._propagationState|=dm.PAUSED;const i=(r,n)=>{this._propagationState&=~dm.PAUSED;const s=this._resumeCallback;if(this._resumeCallback=null,s&&s(),n)throw r;return r};return(typeof e=="function"?e():e).then(r=>i(r,!1),r=>i(r,!0))}shouldPausePropagation(e){return!!(this._propagationState&dm.PAUSED)&&(this._resumeCallback=e,!0)}preventDefault(){this.data.native.preventDefault()}};var dm;(function(t){t[t.NONE=0]="NONE",t[t.STOPPED=1]="STOPPED",t[t.PAUSED=2]="PAUSED"})(dm||(dm={}));const Pi={ALWAYS:1,DEFAULT:0,TOOL:-1,WIDGET:-2,INTERNAL:-3};let kLe=class{};const PLe=kLe;function Nu(t){return t!=null&&"open"in t&&"declaredClass"in t}function OW(t){return t!=null&&"declaredClass"in t&&"dockOptions"in t}const OLe=t=>{let e=class extends t{constructor(){super(...arguments),this._popupSetupTask=null,this.popup={},this.popupEnabled=!0}initialize(){this.addHandles([J(()=>[this.ui,this.popup],([i,r],n)=>{const s="popup",o="manual";if(n){const[a,l]=n;a&&Nu(l)&&(l.view=null,OW(l)&&a.remove(l,s))}i&&Nu(r)&&(r.view=this,OW(r)&&i.add(r,{key:s,position:o,internal:!0}))},Le),this.on("click",i=>{this.popup&&this.popupEnabled&&(i.pointerType!=="mouse"||i.button===0)&&(!Nu(this.popup)&&"autoOpenEnabled"in this.popup&&this.popup.autoOpenEnabled===!1||(Nu(this.popup)?this.popup.viewModel.handleViewClick(i):i.async(async()=>{await this.setupPopup(),Nu(this.popup)&&!this.destroyed&&this.ready&&this.popupEnabled&&this.popup.viewModel.handleViewClick(i)})))},Pi.WIDGET)]),_r(()=>this.ready&&this.popupEnabled&&!this.updating).then(()=>{W(()=>import("./Popup-ab90f0f3.js").then(i=>i.a0),["./Popup-ab90f0f3.js","./executeQueryJSON-5ab1910a.js","./query-5ec3ee5e.js","./pbfQueryUtils-2fe692f0.js","./pbf-beba61b9.js","./OptimizedGeometry-196224d4.js","./OptimizedFeature-4701473b.js","./OptimizedFeatureSet-1d1ac4b9.js","./featureConversionUtils-bafaa402.js"],import.meta.url)})}destroy(){this.destroyed||this.closePopup()}async openPopup(i){Nu(this.popup)&&this.popup.open(i);try{if(await this.setupPopup(),!this.popup)return void ie.getLogger(this).error(new N("view:null-popup","Popup is null and can't be opened"));this.popup.open(i)}catch{}}closePopup(){var i;(i=this._popupSetupTask)==null||i.abort(),Nu(this.popup)&&this.popup.close()}async fetchPopupFeatures(i,r){await this.when();const{location:n,queryArea:s,layerViewsAndGraphics:o,clientOnlyGraphics:a}=await this._prepareFetchPopupFeatures(i,r),l=Promise.resolve(a),c=this._queryLayerPopupFeatures(s,o,r),u=c.map(h=>h.promise);return{location:n,clientOnlyGraphics:a,allGraphicsPromise:tne([l,...u]).then(h=>Array.from(new Set(h.flat()))),promisesPerLayerView:c}}async setupPopup(){var i;if((i=this._popupSetupTask)==null||i.abort(),this.popup&&!Nu(this.popup))return this._popupSetupTask=Cp(async r=>{const{default:n}=await W(()=>import("./Popup-ab90f0f3.js").then(o=>o.a0),["./Popup-ab90f0f3.js","./executeQueryJSON-5ab1910a.js","./query-5ec3ee5e.js","./pbfQueryUtils-2fe692f0.js","./pbf-beba61b9.js","./OptimizedGeometry-196224d4.js","./OptimizedFeature-4701473b.js","./OptimizedFeatureSet-1d1ac4b9.js","./featureConversionUtils-bafaa402.js"],import.meta.url);if(_t(r),!this.popup||Nu(this.popup))return;const s=this.popup;delete s.open,delete s.close,this.popup=new n(s)}),this._popupSetupTask.promise}_queryLayerPopupFeatures(i,r,n){return r.map(({layerView:s,graphics:o})=>{const a={clientGraphics:o,event:n!=null?n.event:void 0,signal:n!=null?n.signal:void 0,defaultPopupTemplateEnabled:n!=null&&!!n.defaultPopupTemplateEnabled},l=s.fetchPopupFeatures(i,a);return{layerView:s,promise:l}})}_isValidPopupGraphic(i,r){return i&&!!i.getEffectivePopupTemplate(r!=null&&r.defaultPopupTemplateEnabled)}async _prepareFetchPopupFeatures(i,r){const{clientGraphics:n,queryArea:s,location:o}=await this._popupHitTestGraphics(i,r),a=this._getFetchPopupLayerViews(),{layerViewsAndGraphics:l,clientOnlyGraphics:c}=this._graphicsPerFetchPopupLayerView(n,a);return{clientOnlyGraphics:c,layerViewsAndGraphics:l,queryArea:s,location:o}}async _popupHitTestGraphics(i,r){const n=await this.popupHitTest(i),s=n.results,o=n.mapPoint,a=s.filter(c=>c.type==="graphic"&&this._isValidPopupGraphic(c.graphic,r)),l=a.length?a[0].mapPoint:null;return{clientGraphics:a.map(c=>c.graphic),queryArea:o,location:o||l}}_getFetchPopupLayerViews(){const i=[];return this.allLayerViews.forEach(r=>{this._isValidPopupLayerView(r)&&i.push(r)}),this.graphicsView!=null&&this._isValidPopupLayerView(this.graphicsView)&&i.push(this.graphicsView),i.reverse()}_isValidPopupLayerView(i){return i!=null&&(!("layer"in i)||!i.suspended)&&"fetchPopupFeatures"in i}_graphicsPerFetchPopupLayerView(i,r){const n=[],s=new Map,o=r.map(a=>{const l=[];return"layer"in a?s.set(a.layer,l):s.set(a.graphics,l),{layerView:a,graphics:l}});for(const a of i){const l=s.get(a.layer)||s.get(a.sourceLayer)||null;l?l.push(a):n.push(a)}return{layerViewsAndGraphics:o,clientOnlyGraphics:n}}};return d([p({cast(i){return!i||Nu(i)||typeof i=="object"&&(i.open=r=>(_p(ie.getLogger(this),"view.popup is no longer created by default. view.popup.open() will stop working when the popup isn't created",{replacement:"Use view.openPopup() instead.",version:"4.27"}),this.openPopup(r)),i.close=()=>(_p(ie.getLogger(this),"view.popup is no longer created by default. view.popup.close() will stop working when the popup isn't created",{replacement:"Use view.closePopup() instead.",version:"4.27"}),this.closePopup())),i}})],e.prototype,"popup",void 0),d([p()],e.prototype,"popupEnabled",void 0),e=d([A("esri.views.PopupView")],e),e},LW={milliseconds:1,seconds:1e3,minutes:6e4,hours:36e5,days:864e5,weeks:6048e5,months:26784e5,years:31536e6,decades:31536e7,centuries:31536e8},LLe={milliseconds:{getter:"getMilliseconds",setter:"setMilliseconds",multiplier:1},seconds:{getter:"getSeconds",setter:"setSeconds",multiplier:1},minutes:{getter:"getMinutes",setter:"setMinutes",multiplier:1},hours:{getter:"getHours",setter:"setHours",multiplier:1},days:{getter:"getDate",setter:"setDate",multiplier:1},weeks:{getter:"getDate",setter:"setDate",multiplier:7},months:{getter:"getMonth",setter:"setMonth",multiplier:1},years:{getter:"getFullYear",setter:"setFullYear",multiplier:1},decades:{getter:"getFullYear",setter:"setFullYear",multiplier:10},centuries:{getter:"getFullYear",setter:"setFullYear",multiplier:100}};function RLe(t,e){const i=new Date(t,e+1,1);return i.setDate(0),i.getDate()}function sv(t,e,i){const r=new Date(t.getTime());if(e&&i){const n=LLe[i],{getter:s,setter:o,multiplier:a}=n;if(i==="months"){const l=RLe(r.getFullYear(),r.getMonth()+e);r.getDate()>l&&r.setDate(l)}r[o](r[s]()+e*a)}return r}function RW(t,e){switch(e){case"milliseconds":return new Date(t.getTime());case"seconds":return new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds());case"minutes":return new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes());case"hours":return new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours());case"days":return new Date(t.getFullYear(),t.getMonth(),t.getDate());case"weeks":return new Date(t.getFullYear(),t.getMonth(),t.getDate()-t.getDay());case"months":return new Date(t.getFullYear(),t.getMonth(),1);case"years":return new Date(t.getFullYear(),0,1);case"decades":return new Date(t.getFullYear()-t.getFullYear()%10,0,1);case"centuries":return new Date(t.getFullYear()-t.getFullYear()%100,0,1);default:return new Date}}function FLe(t,e,i){return t===0?0:t*LW[e]/LW[i]}var Lc;let qa=Lc=class extends te{static get allTime(){return FW}static get empty(){return DLe}constructor(t){super(t),this.end=null,this.start=null}readEnd(t,e){return e.end!=null?new Date(e.end):null}writeEnd(t,e){e.end=t?t.getTime():null}get isAllTime(){return this.equals(Lc.allTime)}get isEmpty(){return this.equals(Lc.empty)}readStart(t,e){return e.start!=null?new Date(e.start):null}writeStart(t,e){e.start=t?t.getTime():null}clone(){return new Lc({end:this.end,start:this.start})}equals(t){if(!t)return!1;const e=this.start!=null?this.start.getTime():this.start,i=this.end!=null?this.end.getTime():this.end,r=t.start!=null?t.start.getTime():t.start,n=t.end!=null?t.end.getTime():t.end;return e===r&&i===n}expandTo(t){if(this.isEmpty||this.isAllTime)return this.clone();const e=lt(this.start,r=>RW(r,t)),i=lt(this.end,r=>{const n=RW(r,t);return r.getTime()===n.getTime()?n:sv(n,1,t)});return new Lc({start:e,end:i})}intersection(t){var a,l,c,u;if(!t)return this.clone();if(this.isEmpty||t.isEmpty)return Lc.empty;if(this.isAllTime)return t.clone();if(t.isAllTime)return this.clone();const e=((a=this.start)==null?void 0:a.getTime())??-1/0,i=((l=this.end)==null?void 0:l.getTime())??1/0,r=((c=t.start)==null?void 0:c.getTime())??-1/0,n=((u=t.end)==null?void 0:u.getTime())??1/0;let s,o;if(r>=e&&r<=i?s=r:e>=r&&e<=n&&(s=e),i>=r&&i<=n?o=i:n>=e&&n<=i&&(o=n),s!=null&&o!=null&&!isNaN(s)&&!isNaN(o)){const h=new Lc;return h.start=s===-1/0?null:new Date(s),h.end=o===1/0?null:new Date(o),h}return Lc.empty}offset(t,e){if(this.isEmpty||this.isAllTime)return this.clone();const i=new Lc,{start:r,end:n}=this;return r!=null&&(i.start=sv(r,t,e)),n!=null&&(i.end=sv(n,t,e)),i}union(t){if(!t||t.isEmpty)return this.clone();if(this.isEmpty)return t.clone();if(this.isAllTime||t.isAllTime)return FW.clone();const e=this.start!=null&&t.start!=null?new Date(Math.min(this.start.getTime(),t.start.getTime())):null,i=this.end!=null&&t.end!=null?new Date(Math.max(this.end.getTime(),t.end.getTime())):null;return new Lc({start:e,end:i})}};d([p({type:Date,json:{write:{allowNull:!0}}})],qa.prototype,"end",void 0),d([ae("end")],qa.prototype,"readEnd",null),d([ge("end")],qa.prototype,"writeEnd",null),d([p({readOnly:!0,json:{read:!1}})],qa.prototype,"isAllTime",null),d([p({readOnly:!0,json:{read:!1}})],qa.prototype,"isEmpty",null),d([p({type:Date,json:{write:{allowNull:!0}}})],qa.prototype,"start",void 0),d([ae("start")],qa.prototype,"readStart",null),d([ge("start")],qa.prototype,"writeStart",null),qa=Lc=d([A("esri.TimeExtent")],qa);const FW=new qa,DLe=new qa({start:void 0,end:void 0}),ku=qa,cn=t=>{let e=class extends t{constructor(){super(...arguments),this._handles=new gs,this._updatingHandles=new nv}destroy(){this.destroyed||(this._handles.destroy(),this._updatingHandles.destroy())}get handles(){return this._handles}get updatingHandles(){return this._updatingHandles}};return d([p({readOnly:!0})],e.prototype,"handles",null),d([p({readOnly:!0})],e.prototype,"updatingHandles",null),e=d([A("esri.core.HandleOwner")],e),e};let l1=class extends cn(he){};l1=d([A("esri.core.HandleOwner")],l1);let iI=class extends cn(ye){constructor(e){super(e),this.handles.add([this.on("before-add",i=>{i.item==null&&i.preventDefault()}),this.on("after-add",i=>this._own(i.item)),this.on("after-remove",i=>this._release(i.item))])}get owner(){return this._get("owner")}set owner(e){e!==this._get("owner")&&(this._releaseAll(),this._set("owner",e),this._ownAll())}_ownAll(){for(const e of this.items)this._own(e)}_releaseAll(){for(const e of this.items)this._release(e)}_createNewInstance(e){return this.itemType?new(ye.ofType(this.itemType.Type))(e):new ye(e)}};function R4(t,e){return{type:t,cast:Mne,set(i){const r=rg(i,this._get(e),t);r.owner=this,this._set(e,r)}}}d([p()],iI.prototype,"owner",null),iI=d([A("esri.core.support.OwningCollection")],iI);var jS;const pP=ln()({orthometric:"gravity-related-height",gravity_related_height:"gravity-related-height",ellipsoidal:"ellipsoidal"}),Dce=pP.jsonValues.slice();i1e(Dce,"orthometric");const rI=ln()({meter:"meters",foot:"feet","us-foot":"us-feet","clarke-foot":"clarke-feet","clarke-yard":"clarke-yards","clarke-link":"clarke-links","sears-yard":"sears-yards","sears-foot":"sears-feet","sears-chain":"sears-chains","benoit-1895-b-chain":"benoit-1895-b-chains","indian-yard":"indian-yards","indian-1937-yard":"indian-1937-yards","gold-coast-foot":"gold-coast-feet","sears-1922-truncated-chain":"sears-1922-truncated-chains","50-kilometers":"50-kilometers","150-kilometers":"150-kilometers"});let Rc=jS=class extends te{constructor(t){super(t),this.heightModel="gravity-related-height",this.heightUnit="meters",this.vertCRS=null}writeHeightModel(t,e,i){return pP.write(t,e,i)}readHeightModel(t,e,i){return pP.read(t)||(i&&i.messages&&i.messages.push(NLe(t,{context:i})),null)}readHeightUnit(t,e,i){return rI.read(t)||(i&&i.messages&&i.messages.push(DW(t,{context:i})),null)}readHeightUnitService(t,e,i){return ese(t)||rI.read(t)||(i&&i.messages&&i.messages.push(DW(t,{context:i})),null)}readVertCRS(t,e){return e.vertCRS||e.ellipsoid||e.geoid}clone(){return new jS({heightModel:this.heightModel,heightUnit:this.heightUnit,vertCRS:this.vertCRS})}equals(t){return!!t&&(this===t||this.heightModel===t.heightModel&&this.heightUnit===t.heightUnit&&this.vertCRS===t.vertCRS)}static deriveUnitFromSR(t,e){const i=tse(e);return new jS({heightModel:t.heightModel,heightUnit:i,vertCRS:t.vertCRS})}write(t,e){return e={origin:"web-scene",...e},super.write(t,e)}static fromJSON(t){if(!t)return null;const e=new jS;return e.read(t,{origin:"web-scene"}),e}};function DW(t,e){return new ol("height-unit:unsupported",`Height unit of value '${t}' is not supported`,e)}function NLe(t,e){return new ol("height-model:unsupported",`Height model of value '${t}' is not supported`,e)}d([p({type:pP.apiValues,constructOnly:!0,json:{origins:{"web-scene":{type:Dce,default:"ellipsoidal"}}}})],Rc.prototype,"heightModel",void 0),d([ge("web-scene","heightModel")],Rc.prototype,"writeHeightModel",null),d([ae(["web-scene","service"],"heightModel")],Rc.prototype,"readHeightModel",null),d([p({type:rI.apiValues,constructOnly:!0,json:{origins:{"web-scene":{type:rI.jsonValues,write:rI.write}}}})],Rc.prototype,"heightUnit",void 0),d([ae("web-scene","heightUnit")],Rc.prototype,"readHeightUnit",null),d([ae("service","heightUnit")],Rc.prototype,"readHeightUnitService",null),d([p({type:String,constructOnly:!0,json:{origins:{"web-scene":{write:!0}}}})],Rc.prototype,"vertCRS",void 0),d([ae("service","vertCRS",["vertCRS","ellipsoid","geoid"])],Rc.prototype,"readVertCRS",null),Rc=jS=d([A("esri.geometry.HeightModelInfo")],Rc);const wC=Rc;let fP=class extends iI{constructor(e){super(e),this.handles.add(this.on("before-add",i=>{i.item!=null&&i.item.parent===this.owner&&(ie.getLogger(this).warn("Analysis inside the collection must be unique. Not adding this element again."),i.preventDefault())}))}_own(e){e.parent=this.owner}_release(e){e.parent=null}};fP=d([A("esri.support.AnalysesCollection")],fP);let ov=class extends iI{_own(e){e.layer&&"remove"in e.layer&&e.layer!==this.owner&&e.layer.remove(e),e.layer=this.owner}_release(e){e.layer===this.owner&&(e.layer=null)}};d([Z6({Type:Or,ensureType:lr(Or)})],ov.prototype,"itemType",void 0),ov=d([A("esri.support.GraphicsCollection")],ov);const NW=new Map([["AUS Central Standard Time","Australia/Darwin"],["AUS Eastern Standard Time","Australia/Sydney"],["Afghanistan Standard Time","Asia/Kabul"],["Alaskan Standard Time","America/Anchorage"],["Aleutian Standard Time","America/Adak"],["Altai Standard Time","Asia/Barnaul"],["Arab Standard Time","Asia/Riyadh"],["Arabian Standard Time","Asia/Dubai"],["Arabic Standard Time","Asia/Baghdad"],["Argentina Standard Time","America/Buenos_Aires"],["Astrakhan Standard Time","Europe/Astrakhan"],["Atlantic Standard Time","America/Halifax"],["Aus Central W. Standard Time","Australia/Eucla"],["Azerbaijan Standard Time","Asia/Baku"],["Azores Standard Time","Atlantic/Azores"],["Bahia Standard Time","America/Bahia"],["Bangladesh Standard Time","Asia/Dhaka"],["Belarus Standard Time","Europe/Minsk"],["Bougainville Standard Time","Pacific/Bougainville"],["Canada Central Standard Time","America/Regina"],["Cape Verde Standard Time","Atlantic/Cape_Verde"],["Caucasus Standard Time","Asia/Yerevan"],["Cen. Australia Standard Time","Australia/Adelaide"],["Central America Standard Time","America/Guatemala"],["Central Asia Standard Time","Asia/Almaty"],["Central Brazilian Standard Time","America/Cuiaba"],["Central Europe Standard Time","Europe/Budapest"],["Central European Standard Time","Europe/Warsaw"],["Central Pacific Standard Time","Pacific/Guadalcanal"],["Central Standard Time","America/Chicago"],["Central Standard Time (Mexico)","America/Mexico_City"],["Chatham Islands Standard Time","Pacific/Chatham"],["China Standard Time","Asia/Shanghai"],["Cuba Standard Time","America/Havana"],["Dateline Standard Time","Etc/GMT+12"],["E. Africa Standard Time","Africa/Nairobi"],["E. Australia Standard Time","Australia/Brisbane"],["E. Europe Standard Time","Europe/Chisinau"],["E. South America Standard Time","America/Sao_Paulo"],["Easter Island Standard Time","Pacific/Easter"],["Eastern Standard Time","America/New_York"],["Eastern Standard Time (Mexico)","America/Cancun"],["Egypt Standard Time","Africa/Cairo"],["Ekaterinburg Standard Time","Asia/Yekaterinburg"],["FLE Standard Time","Europe/Kiev"],["Fiji Standard Time","Pacific/Fiji"],["GMT Standard Time","Europe/London"],["GTB Standard Time","Europe/Bucharest"],["Georgian Standard Time","Asia/Tbilisi"],["Greenland Standard Time","America/Godthab"],["Greenwich Standard Time","Atlantic/Reykjavik"],["Haiti Standard Time","America/Port-au-Prince"],["Hawaiian Standard Time","Pacific/Honolulu"],["India Standard Time","Asia/Calcutta"],["Iran Standard Time","Asia/Tehran"],["Israel Standard Time","Asia/Jerusalem"],["Jordan Standard Time","Asia/Amman"],["Kaliningrad Standard Time","Europe/Kaliningrad"],["Korea Standard Time","Asia/Seoul"],["Libya Standard Time","Africa/Tripoli"],["Line Islands Standard Time","Pacific/Kiritimati"],["Lord Howe Standard Time","Australia/Lord_Howe"],["Magadan Standard Time","Asia/Magadan"],["Magallanes Standard Time","America/Punta_Arenas"],["Marquesas Standard Time","Pacific/Marquesas"],["Mauritius Standard Time","Indian/Mauritius"],["Middle East Standard Time","Asia/Beirut"],["Montevideo Standard Time","America/Montevideo"],["Morocco Standard Time","Africa/Casablanca"],["Mountain Standard Time","America/Denver"],["Mountain Standard Time (Mexico)","America/Mazatlan"],["Myanmar Standard Time","Asia/Rangoon"],["N. Central Asia Standard Time","Asia/Novosibirsk"],["Namibia Standard Time","Africa/Windhoek"],["Nepal Standard Time","Asia/Katmandu"],["New Zealand Standard Time","Pacific/Auckland"],["Newfoundland Standard Time","America/St_Johns"],["Norfolk Standard Time","Pacific/Norfolk"],["North Asia East Standard Time","Asia/Irkutsk"],["North Asia Standard Time","Asia/Krasnoyarsk"],["North Korea Standard Time","Asia/Pyongyang"],["Omsk Standard Time","Asia/Omsk"],["Pacific SA Standard Time","America/Santiago"],["Pacific Standard Time","America/Los_Angeles"],["Pacific Standard Time (Mexico)","America/Tijuana"],["Pakistan Standard Time","Asia/Karachi"],["Paraguay Standard Time","America/Asuncion"],["Qyzylorda Standard Time","Asia/Qyzylorda"],["Romance Standard Time","Europe/Paris"],["Russia Time Zone 10","Asia/Srednekolymsk"],["Russia Time Zone 11","Asia/Kamchatka"],["Russia Time Zone 3","Europe/Samara"],["Russian Standard Time","Europe/Moscow"],["SA Eastern Standard Time","America/Cayenne"],["SA Pacific Standard Time","America/Bogota"],["SA Western Standard Time","America/La_Paz"],["SE Asia Standard Time","Asia/Bangkok"],["Saint Pierre Standard Time","America/Miquelon"],["Sakhalin Standard Time","Asia/Sakhalin"],["Samoa Standard Time","Pacific/Apia"],["Sao Tome Standard Time","Africa/Sao_Tome"],["Saratov Standard Time","Europe/Saratov"],["Singapore Standard Time","Asia/Singapore"],["South Africa Standard Time","Africa/Johannesburg"],["South Sudan Standard Time","Africa/Juba"],["Sri Lanka Standard Time","Asia/Colombo"],["Sudan Standard Time","Africa/Khartoum"],["Syria Standard Time","Asia/Damascus"],["Taipei Standard Time","Asia/Taipei"],["Tasmania Standard Time","Australia/Hobart"],["Tocantins Standard Time","America/Araguaina"],["Tokyo Standard Time","Asia/Tokyo"],["Tomsk Standard Time","Asia/Tomsk"],["Tonga Standard Time","Pacific/Tongatapu"],["Transbaikal Standard Time","Asia/Chita"],["Turkey Standard Time","Europe/Istanbul"],["Turks And Caicos Standard Time","America/Grand_Turk"],["US Eastern Standard Time","America/Indianapolis"],["US Mountain Standard Time","America/Phoenix"],["UTC","Etc/GMT"],["UTC+01","Etc/GMT-1"],["UTC+02","Etc/GMT-2"],["UTC+03","Etc/GMT-3"],["UTC+04","Etc/GMT-4"],["UTC+05","Etc/GMT-5"],["UTC+06","Etc/GMT-6"],["UTC+07","Etc/GMT-7"],["UTC+08","Etc/GMT-8"],["UTC+09","Etc/GMT-9"],["UTC+10","Etc/GMT-10"],["UTC+11","Etc/GMT-11"],["UTC+12","Etc/GMT-12"],["UTC+13","Etc/GMT-13"],["UTC+14","Etc/GMT-14"],["UTC-01","Etc/GMT+1"],["UTC-02","Etc/GMT+2"],["UTC-03","Etc/GMT+3"],["UTC-04","Etc/GMT+4"],["UTC-05","Etc/GMT+5"],["UTC-06","Etc/GMT+6"],["UTC-07","Etc/GMT+7"],["UTC-08","Etc/GMT+8"],["UTC-09","Etc/GMT+9"],["UTC-10","Etc/GMT+10"],["UTC-11","Etc/GMT+11"],["UTC-12","Etc/GMT+12"],["Ulaanbaatar Standard Time","Asia/Ulaanbaatar"],["Venezuela Standard Time","America/Caracas"],["Vladivostok Standard Time","Asia/Vladivostok"],["Volgograd Standard Time","Europe/Volgograd"],["W. Australia Standard Time","Australia/Perth"],["W. Central Africa Standard Time","Africa/Lagos"],["W. Europe Standard Time","Europe/Berlin"],["W. Mongolia Standard Time","Asia/Hovd"],["West Asia Standard Time","Asia/Tashkent"],["West Bank Standard Time","Asia/Hebron"],["West Pacific Standard Time","Pacific/Port_Moresby"],["Yakutsk Standard Time","Asia/Yakutsk"],["Yukon Standard Time","America/Whitehorse"]]);function VLe(t,e="system"){if(!t||!NW.has(t.timeZone))return e;const i=NW.get(t.timeZone);return jLe(t.timeZone)||t.respectsDaylightSaving?i:zLe(i)}function zLe(t){const e=Ae.local().setZone(t),i=Math.min(e.set({month:1,day:1}).offset,e.set({month:5}).offset);return i===0?"Etc/UTC":`Etc/GMT${Ps.instance(-i).formatOffset(0,"narrow")}`}function jLe(t){return t.startsWith("UTC")}let Sf=class extends Li(te){constructor(e){super(e),this.legacy=null,this.timeZone="system"}readLegacy(e,i){const{timeZone:r,respectsDaylightSaving:n}=i;return{timeZone:r,respectsDaylightSaving:n}}readTimeZone(e,i){return"timeZoneIANA"in i?i.timeZoneIANA:VLe(i)}writeTimeZone(e,i){i.timeZoneIANA=e}equals(e){return e!=null&&this.timeZone!=null&&e.timeZone!=null&&this.timeZone===e.timeZone}};d([p()],Sf.prototype,"legacy",void 0),d([ae("legacy",["timeZone"])],Sf.prototype,"readLegacy",null),d([p({type:String,nonNullable:!0})],Sf.prototype,"timeZone",void 0),d([ae("timeZone",["timeZone","timeZoneIANA","respectsDaylightSaving"])],Sf.prototype,"readTimeZone",null),d([ge("timeZone")],Sf.prototype,"writeTimeZone",null),Sf=d([A("esri.time.TimeReference")],Sf);const c1=Sf;let If=class extends he{constructor(e){super(e),this.view=null,this.baseLayerViews=new ye,this.referenceLayerViews=new ye,this._loadingHandle=J(()=>{var i,r;return(r=(i=this.view)==null?void 0:i.map)==null?void 0:r.basemap},i=>{i&&i.load().catch(()=>{})},Le)}destroy(){this._set("view",null),this._loadingHandle&&(this._loadingHandle.remove(),this._loadingHandle=null);for(const e of this.baseLayerViews)e.destroy();this.baseLayerViews.length=0;for(const e of this.referenceLayerViews)e.destroy();this.referenceLayerViews.length=0}get suspended(){return!this.view||this.view.suspended}get updating(){var i,r;if(this.view&&this.view.suspended)return!1;const e=(r=(i=this.view)==null?void 0:i.map)==null?void 0:r.basemap;return!!e&&!!e.loaded&&(this.baseLayerViews.some(n=>n.updating)||this.referenceLayerViews.some(n=>n.updating))}};d([p({constructOnly:!0})],If.prototype,"view",void 0),d([p({readOnly:!0})],If.prototype,"baseLayerViews",void 0),d([p({readOnly:!0})],If.prototype,"referenceLayerViews",void 0),d([p({readOnly:!0})],If.prototype,"suspended",null),d([p({type:Boolean,readOnly:!0})],If.prototype,"updating",null),If=d([A("esri.views.BasemapView")],If);function BLe(t){return"tryRecycleWith"in t}let ULe=class{constructor(e,i,r){this.layer=e,this.view=i,this.layerViewImporter=r,this._controller=new AbortController,this._deferred=Ta(),this._started=!1,this.done=!1,this.promise=this._deferred.promise,Fo(this._controller.signal,()=>{const n=new N("cancelled:layerview-create","layerview creation cancelled",{layer:e});this._deferred.reject(n)})}tryRecycle(e){if(!this.done||!this.layerView||!BLe(this.layerView))return null;const i=this.layer.type,r=this._controller.signal;for(let n=0;n<e.length;n++){const s=e[n];if(s.type!==i)continue;const o=this.layerView.tryRecycleWith(s,{signal:r});if(o){e.splice(n,1),this.layer=s;const a=this.layerView,l=a.view;return this.promise=Promise.race([o.then(()=>(_t(this._controller.signal),s.emit("layerview-destroy",{view:l,layerView:a}),l.emit("layerview-destroy",{view:l,layerView:a}),s.emit("layerview-create",{view:l,layerView:a}),l.emit("layerview-create",{view:l,layerView:a}),a)),new Promise((c,u)=>Fo(this._controller.signal,()=>u(wi())))]),this.promise}}return null}destroy(){this._controller.abort();const{layerView:e}=this;if(e){const{layer:i,view:r}=this;i.emit("layerview-destroy",{view:r,layerView:e}),r.emit("layerview-destroy",{layer:i,layerView:e})}this.done=!0,this.layer=null,this.layerView=null,this.view=null,this.layerViewImporter=null,this._map=null}async start(){var n,s,o;if(this._started)return;this._started=!0;const{_controller:{signal:e},layer:i,view:r}=this;this._map=r.map;try{let a,l;if(await i.load({signal:e}),"prefetchResources"in i&&await((n=i.prefetchResources)==null?void 0:n.call(i,{signal:e})),HLe(i))a=await i.createLayerView(r,{signal:e});else{if(!this.layerViewImporter.hasLayerViewModule(i))throw new N("layer:view-not-supported","No layerview implementation was found");const h=await this.layerViewImporter.importLayerView(i);_t(e),a="default"in h?new h.default({layer:i,view:r}):new h({layer:i,view:r})}const c=()=>{l=$i(l),a.destroyed||a.destroy(),a.layer=null,a.parent=null,a.view=null,this.done=!0};l=Fo(e,c),_t(e);try{await a.when()}catch(h){throw c(),h}if(!((o=(s=this._map)==null?void 0:s.allLayers)==null?void 0:o.includes(i)))return c(),void this._deferred.reject(new N("view:no-layerview-for-layer","The layer has been removed from the map",{layer:i}));this.layerView=a,i.emit("layerview-create",{view:r,layerView:a}),r.emit("layerview-create",{layer:i,layerView:a}),this.done=!0,this._deferred.resolve(a)}catch(a){i.emit("layerview-create-error",{view:r,error:a}),r.emit("layerview-create-error",{layer:i,error:a}),this.done=!0,this._deferred.reject(new N("layerview:create-error","layerview creation failed",{layer:i,error:a}))}}},Ml=class extends he{constructor(e){super(e),this._layerLayerViewInfoMap=new Map,this._recyclingInfoMap=new Map,this._watchUpdatingTracking=new nv,this.supportsGround=!0,this._preloadLayerViewModules=()=>{var r;const i=(r=this.view.map)==null?void 0:r.allLayers;if(i)for(const n of i)this.layerViewImporter.hasLayerViewModule(n)&&this.layerViewImporter.importLayerView(n)},this._reschedule=()=>this.destroyed?Promise.reject():(this._workPromise==null&&(this._workPromise=Ta(),this._workPromise.promise.catch(()=>{})),this.removeHandles("reschedule"),this.addHandles(O1(this._doWork),"reschedule"),this._workPromise.promise),this._doWork=()=>{var l,c,u;if(this.destroyed)return;const i=this.view.map;if(this._map!==i&&(this.clear(),this._map=i),this._workPromise==null)return void this.notifyChange("updating");this.removeHandles("reschedule"),this.removeHandles("collection-change");const r=new Set,n=[],s=this.view.ready,o=h=>{if(h!=null){for(const f of h)if(f){r.add(f);const m=this._layerLayerViewInfoMap.get(f);m&&s?m.start():m||this._recyclingInfoMap.has(f)||n.push(f),"layers"in f&&f.layers&&o(f.layers)}}};for(const h of this._rootCollectionNames)o(this.get(h));for(const[h,f]of this._layerLayerViewInfoMap)if(!r.has(h)){this._layerLayerViewInfoMap.delete(f.layer);const m=f.tryRecycle(n);m?(this.notifyChange("updating"),this._recyclingInfoMap.set(f.layer,f),m.then(()=>{this.notifyChange("updating"),this._recyclingInfoMap.delete(f.layer),this._layerLayerViewInfoMap.set(f.layer,f),this._reschedule()}).catch(()=>{this.notifyChange("updating"),this._recyclingInfoMap.delete(f.layer),f.destroy(),this._reschedule()})):f.destroy()}for(const[h,f]of this._recyclingInfoMap)r.has(h)||(this.notifyChange("updating"),this._recyclingInfoMap.delete(f.layer),f.destroy());for(const h of n)this._createLayerView(h);this._refreshCollections();const a=[(l=i==null?void 0:i.ground)==null?void 0:l.layers,(c=i==null?void 0:i.basemap)==null?void 0:c.baseLayers,(u=i==null?void 0:i.basemap)==null?void 0:u.referenceLayers,i==null?void 0:i.layers].filter(h=>!!h);r.forEach(h=>"layers"in h&&a.push(h.layers)),this.addHandles(a.map(h=>this._watchUpdatingTracking.addOnCollectionChange(()=>h,this._reschedule)),"collection-change"),this._workPromise.resolve(),this._workPromise=null}}initialize(){this.own([ui(()=>{var e,i;return(i=(e=this.view)==null?void 0:e.map)==null?void 0:i.allLayers},"change",this._preloadLayerViewModules,{onListenerAdd:this._preloadLayerViewModules}),J(()=>{const e=this.view,i=e==null?void 0:e.map;return[i==null?void 0:i.basemap,i==null?void 0:i.ground,i==null?void 0:i.layers,e==null?void 0:e.ready]},()=>this._reschedule(),ji)]),this._preloadLayerViewModules(),this._reschedule()}destroy(){this.clear(),y3(this._recyclingInfoMap),y3(this._layerLayerViewInfoMap),this._watchUpdatingTracking.destroy(),this._map=null,this._workPromise!=null&&(this._workPromise.reject(wi()),this._workPromise=null)}get _layersToLayerViews(){const e=[["view.map.basemap.baseLayers","view.basemapView.baseLayerViews"],["view.map.layers","view.layerViews"],["view.map.basemap.referenceLayers","view.basemapView.referenceLayerViews"]];return this.supportsGround&&e.push(["view.map.ground.layers","view.groundView.layerViews"]),new Map(e)}get _rootCollectionNames(){return Array.from(this._layersToLayerViews.keys())}get updating(){return this._workPromise!=null||this._watchUpdatingTracking.updating||QT(this._layerLayerViewInfoMap,e=>!e.done)||this._recyclingInfoMap.size>0}get updatingRemaining(){let e=0;for(const i of this._layerLayerViewInfoMap.values())i.done||++e;return e}clear(){this.destroyed||(y3(this._layerLayerViewInfoMap),this._refreshCollections())}async whenLayerView(e){if(await this._reschedule(),!this._layerLayerViewInfoMap.has(e)){if(this._recyclingInfoMap.has(e))return this._recyclingInfoMap.get(e).promise;throw new N("view:no-layerview-for-layer","No layerview has been found for the layer",{layer:e})}return this._layerLayerViewInfoMap.get(e).promise}_refreshCollections(){for(const[e,i]of this._layersToLayerViews)this._populateLayerViewsOwners(this.get(e),this.get(i),this.view);this.notifyChange("updating"),this.notifyChange("updatingRemaining")}_populateLayerViewsOwners(e,i,r){if(!e||!i)return void(i&&i.removeAll());let n=0;for(const s of e){const o=this._layerLayerViewInfoMap.get(s);if(!o||!o.layerView)continue;const a=o.layerView;a.layer=s,a.parent=r,i.at(n)!==a&&i.splice(n,0,a),s.layers&&this._populateLayerViewsOwners(s.layers,a.layerViews,a),n+=1}n<i.length&&i.splice(n,i.length)}_createLayerView(e){e.load().catch(()=>{}),this.layerViewImporter.hasLayerViewModule(e)&&this.layerViewImporter.importLayerView(e);const i=new ULe(e,this.view,this.layerViewImporter);i.promise.then(()=>this._refreshCollections(),r=>{r&&(ys(r)||r.name==="cancelled:layerview-create")||ie.getLogger(this).error(`Failed to create layerview for layer title:'${e.title??"no title"}', id:'${e.id??"no id"}' of type '${e.type}'.`,{layer:e,error:r}),this._refreshCollections()}),this._layerLayerViewInfoMap.set(e,i),this.view.ready&&i.start(),this.notifyChange("updating"),this.notifyChange("updatingRemaining")}};d([p()],Ml.prototype,"_workPromise",void 0),d([p({readOnly:!0})],Ml.prototype,"_watchUpdatingTracking",void 0),d([p({readOnly:!0})],Ml.prototype,"_layersToLayerViews",null),d([p({readOnly:!0})],Ml.prototype,"_rootCollectionNames",null),d([p()],Ml.prototype,"layerViewImporter",void 0),d([p()],Ml.prototype,"supportsGround",void 0),d([p({readOnly:!0})],Ml.prototype,"updating",null),d([p({readOnly:!0})],Ml.prototype,"updatingRemaining",null),d([p({constructOnly:!0})],Ml.prototype,"view",void 0),Ml=d([A("esri.views.LayerViewManager")],Ml);const GLe=Ml;function HLe(t){return"createLayerView"in t&&t.createLayerView!=null}let Oa=class extends he{constructor(e){super(e),this.factor=1.5,this.offset=so(0,0),this.position=null,this.size=120,this.maskUrl=null,this.maskEnabled=!0,this.overlayUrl=null,this.overlayEnabled=!0,this.visible=!0}get version(){return this.commitProperty("factor"),this.commitProperty("offset"),this.commitProperty("position"),this.commitProperty("visible"),this.commitProperty("size"),this.commitProperty("maskUrl"),this.commitProperty("maskEnabled"),this.commitProperty("overlayUrl"),this.commitProperty("overlayEnabled"),(this._get("version")||0)+1}};d([p({type:Number})],Oa.prototype,"factor",void 0),d([p({nonNullable:!0})],Oa.prototype,"offset",void 0),d([p()],Oa.prototype,"position",void 0),d([p({type:Number,range:{min:0}})],Oa.prototype,"size",void 0),d([p()],Oa.prototype,"maskUrl",void 0),d([p()],Oa.prototype,"maskEnabled",void 0),d([p()],Oa.prototype,"overlayUrl",void 0),d([p()],Oa.prototype,"overlayEnabled",void 0),d([p({readOnly:!0})],Oa.prototype,"version",null),d([p({type:Boolean})],Oa.prototype,"visible",void 0),Oa=d([A("esri.views.Magnifier")],Oa);const Nce=Oa;let qLe=class{constructor(){this._tasks=new Array,this._running=hP(!1)}get length(){return this._tasks.length}get running(){return this._running.value}destroy(){this.cancelAll()}runTask(e){for(;!e.done&&this._process(e);)e.madeProgress()}push(e,i,r){return this._running.value=!0,new Promise((n,s)=>this._tasks.push(new VW(n,s,e,i,r)))}unshift(e,i,r){return this._running.value=!0,new Promise((n,s)=>this._tasks.unshift(new VW(n,s,e,i,r)))}_process(e){var r;if(this._tasks.length===0)return!1;const i=this._tasks.shift();try{const n=zo(i.signal);if(n&&!i.abortCallback)i.reject(wi());else{const s=n?(r=i.abortCallback)==null?void 0:r.call(i,wi()):i.callback(e);Tp(s)?s.then(i.resolve,i.reject):i.resolve(s)}}catch(n){i.reject(n)}return this._running.value=this._tasks.length>0,!0}cancelAll(){const e=wi();for(const i of this._tasks)if(i.abortCallback){const r=i.abortCallback(e);i.resolve(r)}else i.reject(e);this._tasks.length=0,this._running.value=!1}},VW=class{constructor(e,i,r,n=void 0,s=void 0){this.resolve=e,this.reject=i,this.callback=r,this.signal=n,this.abortCallback=s}},BS=class extends he{constructor(){super(...arguments),this.SCHEDULER_LOG_SLOW_TASKS=!1,this.FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES=!1}};d([p()],BS.prototype,"SCHEDULER_LOG_SLOW_TASKS",void 0),d([p()],BS.prototype,"FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES",void 0),BS=d([A("esri.views.support.DebugFlags")],BS);const WLe=new BS;var Ua;(function(t){t[t.ANIMATING=0]="ANIMATING",t[t.INTERACTING=1]="INTERACTING",t[t.IDLE=2]="IDLE"})(Ua||(Ua={}));var F4,mt;(function(t){t[t.YIELD=1]="YIELD"})(F4||(F4={})),function(t){t.RESOURCE_CONTROLLER_IMMEDIATE="immediate",t.RESOURCE_CONTROLLER="schedule",t.SLIDE="slide",t.STREAM_DATA_LOADER="stream loader",t.ELEVATION_QUERY="elevation query",t.TERRAIN_SURFACE="terrain",t.SURFACE_GEOMETRY_UPDATES="surface geometry updates",t.LOD_RENDERER="LoD renderer",t.GRAPHICS_CORE="Graphics3D",t.I3S_CONTROLLER="I3S",t.POINT_CLOUD_LAYER="point cloud",t.FEATURE_TILE_FETCHER="feature fetcher",t.OVERLAY="overlay",t.STAGE="stage",t.GRAPHICS_DECONFLICTOR="graphics deconflictor",t.FILTER_VISIBILITY="Graphics3D filter visibility",t.SCALE_VISIBILITY="Graphics3D scale visibility",t.FRUSTUM_VISIBILITY="Graphics3D frustum visibility",t.POINT_OF_INTEREST_FREQUENT="POI frequent",t.POINT_OF_INTEREST_INFREQUENT="POI infrequent",t.LABELER="labeler",t.FEATURE_QUERY_ENGINE="feature query",t.FEATURE_TILE_TREE="feature tile tree",t.FEATURE_TILE_TREE_ACTIVE="fast feature tile tree",t.ELEVATION_ALIGNMENT="elevation alignment",t.TEXT_TEXTURE_ATLAS="text texture atlas",t.TEXTURE_UNLOAD="texture unload",t.LINE_OF_SIGHT_TOOL="line of sight tool",t.LINE_OF_SIGHT_TOOL_INTERACTIVE="interactive line of sight tool",t.ELEVATION_PROFILE="elevation profile",t.SNAPPING="snapping",t.SHADOW_ACCUMULATOR="shadow accumulator",t.CLOUDS_GENERATOR="clouds generator",t[t.NONE=0]="NONE",t[t.TEST_PRIO=1]="TEST_PRIO"}(mt||(mt={}));const gd=0,zW=new Map([[mt.RESOURCE_CONTROLLER_IMMEDIATE,gd],[mt.RESOURCE_CONTROLLER,4],[mt.SLIDE,gd],[mt.STREAM_DATA_LOADER,gd],[mt.ELEVATION_QUERY,gd],[mt.TERRAIN_SURFACE,1],[mt.SURFACE_GEOMETRY_UPDATES,1],[mt.LOD_RENDERER,2],[mt.GRAPHICS_CORE,2],[mt.I3S_CONTROLLER,2],[mt.POINT_CLOUD_LAYER,2],[mt.FEATURE_TILE_FETCHER,2],[mt.OVERLAY,4],[mt.STAGE,4],[mt.GRAPHICS_DECONFLICTOR,4],[mt.FILTER_VISIBILITY,4],[mt.SCALE_VISIBILITY,4],[mt.FRUSTUM_VISIBILITY,4],[mt.CLOUDS_GENERATOR,4],[mt.POINT_OF_INTEREST_FREQUENT,6],[mt.POINT_OF_INTEREST_INFREQUENT,30],[mt.LABELER,8],[mt.FEATURE_QUERY_ENGINE,8],[mt.FEATURE_TILE_TREE,16],[mt.FEATURE_TILE_TREE_ACTIVE,gd],[mt.ELEVATION_ALIGNMENT,12],[mt.TEXT_TEXTURE_ATLAS,12],[mt.TEXTURE_UNLOAD,12],[mt.LINE_OF_SIGHT_TOOL,16],[mt.LINE_OF_SIGHT_TOOL_INTERACTIVE,gd],[mt.SNAPPING,gd],[mt.SHADOW_ACCUMULATOR,30]]);function jW(t){return zW.has(t)?zW.get(t):typeof t=="number"?t:1}const BW=6.5,UW=1,JLe=30,GW=1e3/30,HW=100,qW=.9;var D4,Rg;(function(t){class e{get updating(){return this._updating.value}_updatingChanged(){this._updating.value=this._tasks.some(s=>s.needsUpdate)}constructor(){this._updating=hP(!0),this._microTaskQueued=!1,this._frameNumber=0,this.performanceInfo={total:new U2("total"),tasks:new Map},this._frameTaskTimes=new Map,this._budget=new r,this._state=Ua.INTERACTING,this._tasks=new qm,this._runQueue=new qm,this._load=0,this._idleStateCallbacks=new qm,this._idleUpdatesStartFired=!1,this._forceTask=!1,this._debug=!1,this._debugHandle=J(()=>WLe.SCHEDULER_LOG_SLOW_TASKS,o=>this._debug=o,Le);for(const o of Object.keys(mt))this.performanceInfo.tasks.set(mt[o],new U2(mt[o]));const s=this;this._test={FRAME_SAFETY_BUDGET:BW,INTERACTING_BUDGET:GW,IDLE_BUDGET:HW,get availableBudget(){return s._budget.budget},usedBudget:0,getBudget:()=>s._budget,setBudget:o=>s._budget=o,updateTask:o=>this._updateTask(o),getState:o=>this._getState(o),getRuntime:o=>this._getRuntime(o),frameTaskTimes:this._frameTaskTimes,resetRuntimes:()=>this._resetRuntimes(),getRunning:()=>this._getRunning()}}destroy(){this._tasks.toArray().forEach(s=>s.remove()),this._tasks.clear(),$i(this._debugHandle),this._microTaskQueued=!1,this._updatingChanged()}taskRunningChanged(s){this._updatingChanged(),s&&this._budget.remaining>0&&!this._microTaskQueued&&(this._microTaskQueued=!0,queueMicrotask(()=>{this._microTaskQueued&&(this._microTaskQueued=!1,this._budget.remaining>0&&this._schedule()&&this.frame())}))}registerTask(s,o){const a=jW(s),l=new i(this,s,o,a);return this._tasks.push(l),this._updatingChanged(),this.performanceInfo.tasks.has(s)||this.performanceInfo.tasks.set(s,new U2(s)),l}registerIdleStateCallbacks(s,o){const a={idleBegin:s,idleEnd:o};this._idleStateCallbacks.push(a),this.state===Ua.IDLE&&this._idleUpdatesStartFired&&a.idleBegin();const l=this;return{remove:()=>this._removeIdleStateCallbacks(a),set idleBegin(c){l._idleUpdatesStartFired&&(a.idleEnd(),l._state===Ua.IDLE&&c()),a.idleBegin=c},set idleEnd(c){a.idleEnd=c}}}get load(){return this._load}set state(s){this._state!==s&&(this._state=s,this.state!==Ua.IDLE&&this._idleUpdatesStartFired&&(this._idleUpdatesStartFired=!1,this._idleStateCallbacks.forAll(o=>o.idleEnd())))}get state(){return this._state}updateBudget(s){this._test.usedBudget=0,++this._frameNumber;let o=BW,a=s.frameDuration,l=UW;switch(this.state){case Ua.IDLE:o=0,a=Math.max(HW,s.frameDuration),l=JLe;break;case Ua.INTERACTING:a=Math.max(GW,s.frameDuration);case Ua.ANIMATING:}return a=a-s.elapsedFrameTime-o,this.state!==Ua.IDLE&&a<UW&&!this._forceTask?(this._forceTask=!0,!1):(a=Math.max(a,l),this._budget.reset(a,this.state),this._updateLoad(),this._schedule())}frame(){switch(this._forceTask=!1,this._microTaskQueued=!1,this.state){case Ua.IDLE:this._idleUpdatesStartFired||(this._idleUpdatesStartFired=!0,this._idleStateCallbacks.forAll(s=>s.idleBegin())),this._runIdle();break;case Ua.INTERACTING:this._runInteracting();break;default:this._runAnimating()}this._test.usedBudget=this._budget.elapsed}stopFrame(){this._budget.reset(0,this._state),this._budget.madeProgress()}_removeIdleStateCallbacks(s){this._idleUpdatesStartFired&&s.idleEnd(),this._idleStateCallbacks.removeUnordered(s)}removeTask(s){this._tasks.removeUnordered(s),this._runQueue.removeUnordered(s),this._updatingChanged()}_updateTask(s){this._tasks.forAll(o=>{o.name===s&&o.setPriority(s)})}_getState(s){if(this._runQueue.some(a=>a.name===s))return Rg.SCHEDULED;let o=Rg.IDLE;return this._tasks.forAll(a=>{a.name===s&&a.needsUpdate&&(a.schedulePriority<=1?o=Rg.READY:o!==Rg.READY&&(o=Rg.WAITING))}),o}_getRuntime(s){let o=0;return this._tasks.forAll(a=>{a.name===s&&(o+=a.runtime)}),o}_resetRuntimes(){this._tasks.forAll(s=>s.runtime=0)}_getRunning(){const s=new Map;if(this._tasks.forAll(a=>{a.needsUpdate&&s.set(a.name,(s.get(a.name)||0)+1)}),s.size===0)return null;let o="";return s.forEach((a,l)=>{o+=a>1?` ${a}x ${l}`:` ${l}`}),o}_runIdle(){this._run()}_runInteracting(){this._run()}_runAnimating(){this._run()}_updateLoad(){const s=this._tasks.reduce((o,a)=>a.needsUpdate?++o:o,0);this._load=this._load*qW+s*(1-qW)}_schedule(){for(this._runQueue.filterInPlace(s=>!!s.needsUpdate||(s.schedulePriority=s.basePriority,!1)),this._tasks.forAll(s=>{s.basePriority===gd&&s.needsUpdate&&!this._runQueue.includes(s)&&s.blockFrame!==this._frameNumber&&this._runQueue.unshift(s)});this._runQueue.length===0;){let s=!1,o=0;if(this._tasks.forAll(a=>{a.needsUpdate&&a.schedulePriority!==0&&a.basePriority!==gd&&a.blockFrame!==this._frameNumber&&(s=!0,o=Math.max(o,a.basePriority),a.schedulePriority===1?(a.schedulePriority=0,this._runQueue.push(a)):--a.schedulePriority)}),!s)return this._updatingChanged(),!1}return this._updatingChanged(),!0}_run(){const s=this._budget.now();this._startFrameTaskTimes();do for(;this._runQueue.length>0;){const o=this._budget.now(),a=this._runQueue.pop();this._budget.resetProgress();try{a.task.runTask(this._budget)===F4.YIELD&&(a.blockFrame=this._frameNumber)}catch(c){ie.getLogger("esri.views.support.Scheduler").error(`Exception in task "${a.name}"`,c)}!this._budget.hasProgressed&&a.blockFrame!==this._frameNumber&&a.needsUpdate&&(a.name,mt.I3S_CONTROLLER,a.blockFrame=this._frameNumber),a.schedulePriority=a.basePriority;const l=this._budget.now()-o;if(a.runtime+=l,this._frameTaskTimes.set(a.priority,this._frameTaskTimes.get(a.priority)+l),this._debug&&l>2*this._budget.budget&&console.log("Task",a.name,"used",l,"of max",this._budget.budget,"ms"),this._budget.remaining<=0)return this._updatingChanged(),void this._recordFrameTaskTimes(this._budget.now()-s)}while(this._schedule());this._updatingChanged(),this._recordFrameTaskTimes(this._budget.now()-s)}_startFrameTaskTimes(){for(const s of Object.keys(mt))this._frameTaskTimes.set(mt[s],0)}_recordFrameTaskTimes(s){this._frameTaskTimes.forEach((o,a)=>this.performanceInfo.tasks.get(a).record(o)),this.performanceInfo.total.record(s)}get test(){return this._test}}t.Scheduler=e;class i{get task(){return this._task.value}get updating(){return this._queue.running}constructor(s,o,a,l){this._scheduler=s,this.name=o,this._basePriority=l,this.blockFrame=0,this.runtime=0,this._queue=new qLe,this._handles=new gs,this.schedulePriority=this._basePriority,this._task=hP(a??this._queue),this._handles.add(tn(()=>this.task.running,c=>s.taskRunningChanged(c)))}remove(){this.processQueue(Vce),this._scheduler.removeTask(this),this.schedule=N4.schedule,this.reschedule=N4.reschedule,this._handles.destroy()}get basePriority(){return this._basePriority}setPriority(s){this.name=s;const o=jW(s);this._basePriority!==gd&&this.schedulePriority===0||(this.schedulePriority=o),this._basePriority=o}get priority(){return this.name}set priority(s){this.setPriority(s)}get needsUpdate(){return this.updating||this.task.running}schedule(s,o,a){return this._queue.push(s,o,a)}reschedule(s,o,a){return this._queue.unshift(s,o,a)}processQueue(s){this._queue.runTask(s)}}class r{constructor(){this._begin=typeof performance<"u"?performance.now():0,this._budget=0,this._state=Ua.IDLE,this._done=!1,this._progressed=!1,this._enabled=!0}run(s){return!this.done&&(s()===!0&&this.madeProgress(),!0)}get done(){return this._done}get budget(){return this._budget}madeProgress(){return this._progressed=!0,this._done=this.elapsed>=this._budget&&this._enabled,this._done}get state(){return this._state}get enabled(){return this._enabled}set enabled(s){this._enabled=s}reset(s,o){this._begin=this.now(),this._budget=s,this._state=o,this.resetProgress()}get remaining(){return Math.max(this._budget-this.elapsed,0)}now(){return performance.now()}get elapsed(){return performance.now()-this._begin}resetProgress(){this._progressed=!1,this._done=!1}get hasProgressed(){return this._progressed}}t.Budget=r})(D4||(D4={})),function(t){t.SCHEDULED="s",t.READY="r",t.WAITING="w",t.IDLE="i"}(Rg||(Rg={}));const Vce=(()=>{const t=new D4.Budget;return t.enabled=!1,t})();let ZLe=class{remove(){}processQueue(){}schedule(e,i,r){try{if(zo(i)){const n=wi();return r?Promise.resolve(r(n)):Promise.reject(n)}return SD(e(Vce))}catch(n){return Promise.reject(n)}}reschedule(e,i,r){return this.schedule(e,i,r)}};const N4=new ZLe;let US=class extends he{constructor(e,i){super({}),this._stage=e,this._textureRequests=new Map,this._frameTask=(i==null?void 0:i.registerTask(mt.TEXTURE_UNLOAD))??N4}normalizeCtorArgs(){return{}}destroy(){var e,i,r;super.destroy(),(e=this._frameTask)==null||e.remove(),(i=this._textureRequests)==null||i.forEach(n=>this._releaseTextureRequest(n)),(r=this._textureRequests)==null||r.clear()}get updating(){return this._frameTask.updating}fromData(e,i,r){var o,a;const n=this.makeUid(e);let s=this._textureRequests.get(n);if(!s){const l=new YLe(r);l.texture=i(),(o=this._stage)==null||o.add(l.texture),(a=this._stage)==null||a.loadImmediate(l.texture),this._textureRequests.set(n,l),s=l}return s.referenceCount++,{uid:n,texture:s.texture,release:()=>this._release(n)}}_release(e){const i=this._textureRequests.get(e);i?(i.referenceCount<1&&console.warn("TextureCollection: reference count is < 1 for "+e),i.referenceCount--,i.referenceCount<1&&this._frameTask.schedule(()=>this._releaseNow(e))):console.warn(`TextureCollection: texture doesn't exist: '${e}'`)}get test(){return{textureRequests:this._textureRequests}}_releaseNow(e){if(!this._textureRequests)return;const i=this._textureRequests.get(e);!i||i.referenceCount>0||(this._releaseTextureRequest(i),this._textureRequests.delete(e))}_releaseTextureRequest(e){var i;e.onRemove&&e.onRemove(),e.texture?(i=this._stage)==null||i.remove(e.texture):e.abortController&&(e.abortController.abort(),e.abortController=null)}makeUid(e,i=null){return i!=null?`${e}.${i}px`:e}};d([p()],US.prototype,"_frameTask",void 0),d([p()],US.prototype,"updating",null),US=d([A("esri.views.3d.support.TextureCollection")],US);let YLe=class{constructor(e){this.onRemove=e,this.referenceCount=0}};var WW;(function(t){t[t.Left=0]="Left",t[t.Middle=1]="Middle",t[t.Right=2]="Right"})(WW||(WW={}));const zce=["click","double-click","immediate-click","immediate-double-click","hold","drag","key-down","key-up","pointer-down","pointer-move","pointer-up","pointer-drag","mouse-wheel","pointer-enter","pointer-leave","gamepad","focus","blur"],jce={};function Bce(t){return!!jce[t]}function KLe(t){for(const e of t)if(!Bce(e))return!1;return!0}zce.forEach(t=>{jce[t]=!0});let XLe=class{constructor(e){this._handlers=new Map,this._counter=0,this._handlerCounts=new Map,this.view=e,this.inputManager=null}connect(e){e&&this.disconnect(),this.inputManager=e,this._handlers.forEach(({handler:i,priority:r},n)=>{var s;return(s=this.inputManager)==null?void 0:s.installHandlers(n,[i],r)})}disconnect(){this.inputManager&&this._handlers.forEach((e,i)=>{var r;return(r=this.inputManager)==null?void 0:r.uninstallHandlers(i)}),this.inputManager=null}destroy(){this.disconnect(),this._handlers.clear(),this.view=null}on(e,i,r,n){const s=Array.isArray(e)?e:e.split(",");if(!KLe(s))return s.some(Bce)&&console.error("Error: registering input events and other events on the view at the same time is not supported."),null;let o,a;Array.isArray(i)?a=i:(o=i,a=[]),typeof r=="function"?o=r:n=r,n=n??Pi.DEFAULT;const l=this._createUniqueGroupName(),c=new QLe(this.view,s,a,o);this._handlers.set(l,{handler:c,priority:n});for(const u of s){const h=this._handlerCounts.get(u)||0;this._handlerCounts.set(u,h+1)}return this.inputManager&&this.inputManager.installHandlers(l,[c],n),{remove:()=>this._removeHandler(l,s)}}hasHandler(e){return!!this._handlerCounts.get(e)}_removeHandler(e,i){if(this._handlers.has(e)){this._handlers.delete(e);for(const r of i){const n=this._handlerCounts.get(r);n===void 0?console.error("Trying to remove handler for event that has no handlers registered: ",r):n===1?this._handlerCounts.delete(r):this._handlerCounts.set(r,n-1)}}this.inputManager&&this.inputManager.uninstallHandlers(e)}_createUniqueGroupName(){return this._counter+=1,`viewEvents_${this._counter}`}},QLe=class extends Kn{constructor(e,i,r,n){super(!0),this._latestDragStart=void 0,this.view=e;for(const s of i)switch(s){case"click":this.registerIncoming("click",r,o=>n(this._wrapClick(o)));break;case"double-click":this.registerIncoming("double-click",r,o=>n(this._wrapDoubleClick(o)));break;case"immediate-click":this.registerIncoming("immediate-click",r,o=>n(this._wrapImmediateClick(o)));break;case"immediate-double-click":this.registerIncoming("immediate-double-click",r,o=>n(this._wrapImmediateDoubleClick(o)));break;case"hold":this.registerIncoming("hold",r,o=>n(this._wrapHold(o)));break;case"drag":this.registerIncoming("drag",r,o=>{const a=this._wrapDrag(o);a&&n(a)});break;case"key-down":this.registerIncoming("key-down",r,o=>n(this._wrapKeyDown(o)));break;case"key-up":this.registerIncoming("key-up",r,o=>n(this._wrapKeyUp(o)));break;case"pointer-down":this.registerIncoming("pointer-down",r,o=>n(this._wrapPointer(o,"pointer-down")));break;case"pointer-move":this.registerIncoming("pointer-move",r,o=>n(this._wrapPointer(o,"pointer-move")));break;case"pointer-up":this.registerIncoming("pointer-up",r,o=>n(this._wrapPointer(o,"pointer-up")));break;case"pointer-drag":this.registerIncoming("pointer-drag",r,o=>n(this._wrapPointerDrag(o)));break;case"mouse-wheel":this.registerIncoming("mouse-wheel",r,o=>n(this._wrapMouseWheel(o)));break;case"pointer-enter":this.registerIncoming("pointer-enter",r,o=>n(this._wrapPointer(o,"pointer-enter")));break;case"pointer-leave":this.registerIncoming("pointer-leave",r,o=>n(this._wrapPointer(o,"pointer-leave")));break;case"gamepad":this.registerIncoming("gamepad",r,o=>{n(this._wrapGamepad(o))});break;case"focus":this.registerIncoming("focus",r,o=>{n(this._wrapFocus(o))});break;case"blur":this.registerIncoming("blur",r,o=>{n(this._wrapBlur(o))})}}_wrapFocus(e){return{type:"focus",timestamp:e.timestamp,native:e.data.native,cancelable:e.cancelable,stopPropagation:()=>e.stopPropagation(),async:i=>e.async(i),preventDefault:()=>e.preventDefault()}}_wrapBlur(e){return{type:"blur",timestamp:e.timestamp,native:e.data.native,cancelable:e.cancelable,stopPropagation:()=>e.stopPropagation(),async:i=>e.async(i),preventDefault:()=>e.preventDefault()}}_wrapClick(e){const{pointerType:i,button:r,buttons:n,x:s,y:o,native:a,eventId:l}=e.data,{cancelable:c,timestamp:u}=e;return{type:"click",pointerType:i,button:r,buttons:n,x:s,y:o,native:a,timestamp:u,screenPoint:so(s,o),mapPoint:this._getMapPoint(s,o),eventId:l,cancelable:c,stopPropagation:()=>e.stopPropagation(),async:h=>e.async(h),preventDefault:()=>e.preventDefault()}}_wrapDoubleClick(e){const{pointerType:i,button:r,buttons:n,x:s,y:o,native:a,eventId:l}=e.data,{cancelable:c,timestamp:u}=e;return{type:"double-click",pointerType:i,button:r,buttons:n,x:s,y:o,native:a,timestamp:u,mapPoint:this._getMapPoint(s,o),eventId:l,cancelable:c,stopPropagation:()=>e.stopPropagation(),async:h=>e.async(h),preventDefault:()=>e.preventDefault()}}_wrapImmediateClick(e){const{pointerType:i,button:r,buttons:n,x:s,y:o,native:a,eventId:l}=e.data,c=a.pointerId,{cancelable:u,timestamp:h}=e;return{type:"immediate-click",pointerId:c,pointerType:i,button:r,buttons:n,x:s,y:o,native:a,timestamp:h,mapPoint:this._getMapPoint(s,o),eventId:l,cancelable:u,stopPropagation:()=>e.stopPropagation(),async:f=>e.async(f),preventDefault:()=>e.preventDefault()}}_wrapImmediateDoubleClick(e){const{pointerType:i,button:r,buttons:n,x:s,y:o,native:a,eventId:l}=e.data,c=a.pointerId,{cancelable:u,timestamp:h}=e;return{type:"immediate-double-click",pointerId:c,pointerType:i,button:r,buttons:n,x:s,y:o,native:a,timestamp:h,mapPoint:this._getMapPoint(s,o),eventId:l,cancelable:u,stopPropagation:()=>e.stopPropagation(),async:f=>e.async(f),preventDefault:()=>e.preventDefault()}}_wrapHold(e){const{pointerType:i,button:r,buttons:n,x:s,y:o,native:a}=e.data,{cancelable:l,timestamp:c}=e;return{type:"hold",pointerType:i,button:r,buttons:n,x:s,y:o,native:a,timestamp:c,mapPoint:this._getMapPoint(s,o),cancelable:l,stopPropagation:()=>e.stopPropagation(),async:u=>e.async(u),preventDefault:()=>e.preventDefault()}}_getMapPoint(e,i){return this.view.toMap(so(e,i),{exclude:[]})}_wrapDrag(e){const i=e.data,{x:r,y:n}=i.center,{action:s,pointerType:o,button:a}=i;if(s==="start"&&(this._latestDragStart=i),!this._latestDragStart)return;const l=i.pointer.native,c=i.buttons,{cancelable:u,timestamp:h}=e,f={x:this._latestDragStart.center.x,y:this._latestDragStart.center.y};return s==="end"&&(this._latestDragStart=void 0),{type:"drag",action:s,x:r,y:n,origin:f,pointerType:o,button:a,buttons:c,radius:i.radius,angle:Wse(i.angle),native:l,timestamp:h,cancelable:u,stopPropagation:()=>e.stopPropagation(),async:m=>e.async(m),preventDefault:()=>e.preventDefault()}}_wrapKeyDown(e){const{key:i,repeat:r,native:n}=e.data,{cancelable:s,timestamp:o}=e;return{type:"key-down",key:i,repeat:r,native:n,timestamp:o,cancelable:s,stopPropagation:()=>e.stopPropagation(),async:a=>e.async(a),preventDefault:()=>e.preventDefault()}}_wrapKeyUp(e){const{key:i,native:r}=e.data,{cancelable:n,timestamp:s}=e;return{type:"key-up",key:i,native:r,timestamp:s,cancelable:n,stopPropagation:()=>e.stopPropagation(),async:o=>e.async(o),preventDefault:()=>e.preventDefault()}}_wrapPointer(e,i){const{x:r,y:n,button:s,buttons:o,native:a,eventId:l}=e.data,c=a.pointerId,u=a.pointerType,{cancelable:h,timestamp:f}=e;return{type:i,x:r,y:n,pointerId:c,pointerType:u,button:s,buttons:o,native:a,timestamp:f,eventId:l,cancelable:h,stopPropagation:()=>e.stopPropagation(),async:m=>e.async(m),preventDefault:()=>e.preventDefault()}}_wrapPointerDrag(e){const{x:i,y:r,buttons:n,native:s,eventId:o}=e.data.currentEvent,{button:a}=e.data.startEvent,l=e.data.startEvent.native.pointerId,c=e.data.startEvent.native.pointerType,u=e.data.action,h={x:e.data.startEvent.x,y:e.data.startEvent.y},{cancelable:f,timestamp:m}=e;return{type:"pointer-drag",x:i,y:r,pointerId:l,pointerType:c,button:a,buttons:n,action:u,origin:h,native:s,timestamp:m,eventId:o,cancelable:f,stopPropagation:()=>e.stopPropagation(),async:g=>e.async(g),preventDefault:()=>e.preventDefault()}}_wrapMouseWheel(e){const{cancelable:i,data:r,timestamp:n}=e,{x:s,y:o,deltaY:a,native:l}=r;return{type:"mouse-wheel",x:s,y:o,deltaY:a,native:l,timestamp:n,cancelable:i,stopPropagation:()=>e.stopPropagation(),async:c=>e.async(c),preventDefault:()=>e.preventDefault()}}_wrapGamepad(e){const{action:i,state:r,device:n}=e.data,{cancelable:s,timestamp:o}=e,{buttons:a,axes:l}=r;return{type:"gamepad",device:n,timestamp:o,action:i,buttons:a,axes:l,cancelable:s,stopPropagation:()=>e.stopPropagation(),async:c=>e.async(c),preventDefault:()=>e.preventDefault()}}};var cT,JW,ZW;(function(t){t[t.USER=0]="USER",t[t.MANAGER=1]="MANAGER"})(cT||(cT={})),function(t){t[t.None=0]="None",t[t.Unfocused=1]="Unfocused",t[t.Focused=2]="Focused",t[t.Unselected=4]="Unselected",t[t.Selected=8]="Selected",t[t.All=15]="All"}(JW||(JW={})),function(t){t[t.None=0]="None",t[t.Custom1=16]="Custom1",t[t.Custom2=32]="Custom2",t[t.Custom3=64]="Custom3",t[t.Custom4=128]="Custom4",t[t.Custom5=256]="Custom5",t[t.Custom6=512]="Custom6",t[t.Custom7=1024]="Custom7",t[t.Custom8=2048]="Custom8",t[t.Custom9=4096]="Custom9",t[t.Custom10=8192]="Custom10",t[t.Custom11=16384]="Custom11",t[t.Custom12=32768]="Custom12",t[t.All=65520]="All"}(ZW||(ZW={}));function eRe(t){return[t.on("before-add",e=>{const i=e.item;if(i==null||t.includes(i))return ie.getLogger("esri.views.interactive.interactiveToolUtils").warn("Tool is either already in the list of tools or tool is `null`. Not adding tool."),void e.preventDefault();i.onAdd()}),t.on("after-remove",e=>{const i=e.item;i.active&&(i.view.activeTool=null),i.destroy()})]}function V4(t){return t.visible&&t.getEditableFlag!=null&&t.getEditableFlag(cT.USER)&&t.getEditableFlag(cT.MANAGER)}function jl(t){return so(t.x,t.y)}function Uce(t,e){var r;const i=(r=t instanceof HTMLElement?t:t.surface)==null?void 0:r.getBoundingClientRect();return i?so(e.clientX-i.left,e.clientY-i.top):so(0,0)}function YW(t,e){return e instanceof Event?Uce(t,e):jl(e)}function KW(t){if(t instanceof Event)return!0;if(typeof t=="object"&&"type"in t)switch(t.type){case"click":case"double-click":case"pointer-down":case"pointer-drag":case"pointer-enter":case"pointer-leave":case"pointer-up":case"pointer-move":case"immediate-click":case"immediate-double-click":case"hold":case"drag":case"mouse-wheel":return!0;default:return!1}return!1}let tRe=class{constructor(){this._pointerLocations=new Map,this._hoveredManipulators=new Map,this._grabbedManipulators=new Map,this._draggedManipulators=new Map,this._stopDrag=!1,this._revertToNullActiveTool=!1,this._cursor=null}get cursor(){return this._cursor}hasFocusedManipulators(){return this._grabbedManipulators.size>0||this._draggedManipulators.size>0}handleInputEvent(e,i){const r=()=>e.stopPropagation();switch(e.type){case"pointer-move":XW(e.pointerType)&&this._pointerLocations.set(e.pointerId,{x:e.x,y:e.y,pointerType:e.pointerType});break;case"drag":this._grabbedManipulators.size>0&&(this._stopDrag=!0),this._stopDrag&&(r(),e.action==="end"&&(this._stopDrag=!1));break;case"pointer-down":{if(!QW(e))break;const n=jl(e),s=this._intersect(n,e.pointerType,i.forEachTool);if(s==null)break;const o=s.manipulator,a=s.tool;o==null||a==null||!o.interactive||o.grabbable&&o.grabbableForEvent(e)||!o.grabbing||o.dragging||this._ungrabManipulatorBeforeDragging(o,e,i),o!=null&&a!=null&&o.interactive&&o.grabbable&&o.grabbableForEvent(e)&&!o.grabbing&&(this._grabbedManipulators.set(e.pointerId,{manipulator:o,tool:a,start:n,pointerType:e.pointerType}),this._grabbedManipulators.size===1&&i.activeTool==null&&(this._revertToNullActiveTool=!0,i.setActiveTool(s.tool)),o.grabbing=!0,o.events.emit("grab-changed",{action:"start",pointerType:e.pointerType,screenPoint:n}),r());break}case"pointer-up":this._draggedManipulators.has(e.pointerId)||this._handlePointerEnd(e,i);break;case"pointer-drag":{if(!QW(e))break;const n=this._grabbedManipulators.get(e.pointerId),s=lt(n,({manipulator:u})=>u),o=lt(n,({tool:u})=>u);if(s==null||o==null)break;const a=jl(e);a.x=Pn(a.x,0,i.view.width),a.y=Pn(a.y,0,i.view.height);const l=n.start,c=this._draggedManipulators.get(e.pointerId);switch(e.action){case"start":case"update":e.action!=="update"&&this._grabbedManipulators.size!==1||(s.dragging=!0,c?s.events.emit("drag",{action:"update",start:l,screenPoint:a}):s.events.emit("drag",{action:"start",start:l,screenPoint:a,pointerType:e.pointerType}),this._draggedManipulators.set(e.pointerId,{tool:o,manipulator:s,start:l}));break;case"end":s.dragging=!1,c&&s.events.emit("drag",{action:"end",start:l,screenPoint:a}),this._draggedManipulators.delete(e.pointerId),this._handlePointerEnd(e,i)}r();break}case"immediate-click":{const n=jl(e),s=this._intersect(n,e.pointerType,i.forEachTool);if(iRe(e)||i.forEachTool(c=>{if((s==null||s.tool!==c||c.automaticManipulatorSelection)&&c.manipulators){let u=!1;c.manipulators.forEach(({manipulator:h})=>{h.selected&&(h.selected=!1,u=!0)}),u&&c.onManipulatorSelectionChanged&&c.onManipulatorSelectionChanged()}}),s==null)break;const{manipulator:o,tool:a}=s;if(!o.interactive)break;o.selectable&&a.automaticManipulatorSelection&&(o.selected=!o.selected,a.onManipulatorSelectionChanged&&a.onManipulatorSelectionChanged());const l=e.native.shiftKey;o.events.emit("immediate-click",{screenPoint:n,button:e.button,pointerType:e.pointerType,shiftKey:l,stopPropagation:r});break}case"click":{const n=jl(e),s=this._intersect(n,e.pointerType,i.forEachTool),o=s!=null?s.manipulator:null;if(o==null||!o.interactive)break;const a=e.native.shiftKey;o.events.emit(e.type,{screenPoint:n,button:e.button,pointerType:e.pointerType,shiftKey:a}),r();break}case"double-click":{const n=jl(e),s=this._intersect(n,e.pointerType,i.forEachTool),o=s!=null?s.manipulator:null;if(o==null||!o.interactive)break;const a=e.native.shiftKey;o.events.emit("double-click",{screenPoint:n,button:e.button,pointerType:e.pointerType,shiftKey:a,stopPropagation:r});break}case"immediate-double-click":{const n=jl(e),s=this._intersect(n,e.pointerType,i.forEachTool),o=s!=null?s.manipulator:null;if(o==null||!o.interactive)break;const a=e.native.shiftKey;o.events.emit("immediate-double-click",{screenPoint:n,button:e.button,pointerType:e.pointerType,shiftKey:a,stopPropagation:r});break}}this._onFocusChange(i.forEachTool)}_ungrabManipulatorBeforeDragging(e,i,r){e.grabbing=!1,e.events.emit("grab-changed",{action:"end",pointerType:i.pointerType,screenPoint:jl(i)}),this._grabbedManipulators.forEach(({manipulator:n},s)=>{n===e&&this._grabbedManipulators.delete(s)}),this._afterManipulatorUngrab(r.setActiveTool)}_handlePointerEnd(e,i){const r=lt(this._grabbedManipulators.get(e.pointerId),({manipulator:n})=>n);r!=null&&r.grabbing&&(r.grabbing=!1,r.events.emit("grab-changed",{action:"end",pointerType:e.pointerType,screenPoint:jl(e)}),this._grabbedManipulators.delete(e.pointerId),this._afterManipulatorUngrab(i.setActiveTool))}_cursorFromMap(e){let i=null;return QT(e,({manipulator:r})=>!(r==null||!r.interactive)&&(r.grabbing&&r.grabCursor?(i=r.grabCursor,!0):!!r.cursor&&(i=r.cursor,!0))),i}_onFocusChange(e){this._updateCursor(),this._updateFocusedManipulatorTools(e)}_updateCursor(){this._grabbedManipulators.size>0?this._cursor=this._cursorFromMap(this._grabbedManipulators)||"grabbing":this._hoveredManipulators.size>0?this._cursor=this._cursorFromMap(this._hoveredManipulators)||"pointer":this._cursor=null}_updateFocusedManipulatorTools(e){const i=new Set,r=new Set;this._grabbedManipulators.forEach(({tool:n})=>{i.add(n)}),this._hoveredManipulators.forEach(({tool:n})=>{r.add(n)}),e(n=>{n.hasGrabbedManipulators=i.has(n),n.hasHoveredManipulators=r.has(n);const s=this._grabbedManipulators.values(),o=g1e(s,({tool:a})=>a===n);n.firstGrabbedManipulator=o!=null?o.manipulator:null})}clearPointers(e,{forEachTool:i,setActiveTool:r},n=!0,s){const o=(a,l)=>a===e&&(s==null||s===l);this._grabbedManipulators.forEach(({tool:a,manipulator:l,pointerType:c},u)=>{o(a,l)&&(this._grabbedManipulators.delete(u),l.grabbing=!1,l.events.emit("grab-changed",{action:"end",screenPoint:null,pointerType:c}))}),this._draggedManipulators.forEach(({tool:a,manipulator:l},c)=>{o(a,l)&&(this._draggedManipulators.delete(c),l.dragging=!1,l.events.emit("drag",{action:"cancel"}))}),n&&this._hoveredManipulators.forEach(({tool:a,manipulator:l},c)=>{o(a,l)&&(this._hoveredManipulators.delete(c),l.hovering=!1)}),this._afterManipulatorUngrab(r),this._onFocusChange(i)}_intersect(e,i,r){let n=null;return r(s=>{if(s.manipulators==null||!V4(s))return!1;const o=s.manipulators.intersect(e,i);return o!=null&&(n={tool:s,manipulator:o},!0)}),n}updateHoveredStateFromKnownPointers(e){this._pointerLocations.forEach((i,r)=>{this._updateHoveredStateForPointerAtScreenPosition(so(i.x,i.y),r,i.pointerType,e)})}handleHoverEvent(e,i){e.type!=="pointer-up"&&e.type!=="immediate-click"&&e.type!=="pointer-move"||!XW(e.pointerType)||this._updateHoveredStateForPointerAtScreenPosition(jl(e),e.pointerId,e.pointerType,i)}_updateHoveredStateForPointerAtScreenPosition(e,i,r,n){let s=this._intersect(e,r,n);const o=lt(this._hoveredManipulators.get(i),({manipulator:a})=>a);s==null||s.manipulator.interactive||(s=null),s!=null&&o===s.manipulator||(o!=null&&(o.hovering=!1),s!=null?(s.manipulator.hovering=!0,this._hoveredManipulators.set(i,s)):this._hoveredManipulators.delete(i),this._onFocusChange(n))}_afterManipulatorUngrab(e){this._grabbedManipulators.size===0&&this._revertToNullActiveTool&&(e(null),this._revertToNullActiveTool=!1)}};function XW(t){return t==="mouse"}function QW(t){return t.pointerType!=="mouse"||t.button===0}function iRe(t){return!!t.native.shiftKey}const eJ="attached",j3="tools",rRe=1e3;let Fc=class extends l1{constructor(e){super(e),this._clock=P1,this._manipulatorState=new tRe,this.tools=new ye,this.cursor=null,this._interacting=!1,this._interactingTimeout=null,this._forEachTool=i=>{for(const r of this.tools.items)if(i(r))return}}initialize(){this.handles.add([this.view.on(zce,e=>{this._handleInputEvent(e)},Pi.TOOL),...eRe(this.tools),this.tools.on("before-add",({item:e})=>{this._updateToolEditableFlag(e)}),this.tools.on("before-remove",({item:e})=>{this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs),this._updateCursor()}),this.tools.on("change",()=>{this._refreshToolWatchers()})])}destroy(){this.detach(),this.handles.removeAll()}get _manipulatorStateEventArgs(){return{forEachTool:this._forEachTool,activeTool:this.activeTool,setActiveTool:e=>{this.activeTool=e},view:this.view}}set activeTool(e){if(e!=null&&!this.view.ready)return void ie.getLogger(this).error("Cannot set active tool while view is not ready.");if(e===this.activeTool)return;const i=this.activeTool;this._set("activeTool",e),i!=null&&i.deactivate(),e!=null&&e.activate(),this._removeIncompleteTools(e);for(const r of this.tools){this._updateToolEditableFlag(r);const n=V4(r);this.activeTool!=null&&n||this._manipulatorState.clearPointers(r,this._manipulatorStateEventArgs,!n)}this._updateCursor()}get updating(){var e;return this.updatingHandles.updating||this.tools.some(i=>i.updating)||(((e=this.textures)==null?void 0:e.updating)??!1)}get interacting(){return this._interacting}_clearInteractingTimeout(){this._interactingTimeout=$i(this._interactingTimeout)}_startInteractingTimeout(){this._clearInteractingTimeout(),this._interactingTimeout=this._clock.setTimeout(()=>this._interacting=!1,rRe)}attach(){var e;this.view.type==="3d"?(this._set("textures",new US(this.view._stage,this.view.resourceController.scheduler)),this.handles.add([J(()=>{const{state:i}=this.view;return"camera"in i&&i.camera},()=>this._forEachManipulator(i=>i.onViewChange())),(e=this.view.elevationProvider)==null?void 0:e.on("elevation-change",i=>this._forEachManipulator(r=>r.onElevationChange(i))),Et(()=>this._set("textures",je(this.textures)))],eJ)):this.handles.add(J(()=>this.view.extent,()=>this._forEachManipulator(i=>i.onViewChange())))}detach(){this.activeTool=null,this.tools.removeAll(),this.handles.remove(eJ),this._clearInteractingTimeout(),this._interacting=!1}_forEachManipulator(e){this._forEachTool(i=>{i.manipulators&&i.manipulators.forEach(({manipulator:r})=>e(r,i))})}_handleInputEvent(e){let i=!1;const r={...e,stopPropagation:()=>{i=!0,e.stopPropagation()}};this.activeTool!=null?this.activeTool.handleInputEvent&&this.activeTool.handleInputEvent(r):this._forEachTool(n=>{!i&&n.visible&&n.handleInputEvent(r)}),!i&&e.type==="key-down"&&e.key==="Escape"&&this.activeTool&&(e.stopPropagation(),this.activeTool=null),this._manipulatorState.handleInputEvent(r,this._manipulatorStateEventArgs),i||this.activeTool==null||this.activeTool.handleInputEventAfter(r),this._manipulatorState.handleHoverEvent(r,this._forEachTool),this._updateCursor(),e.type==="pointer-move"&&(this._manipulatorState.hasFocusedManipulators()||this.activeTool)&&(this._interacting=!0,this._startInteractingTimeout())}_refreshToolWatchers(){this.handles.remove(j3),this._forEachTool(e=>{if(e instanceof he){const i=J(()=>[e.cursor,e.visible,e.editable],()=>{V4(e)||this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs),this._updateCursor()});this.handles.add(i,j3)}e.manipulators&&this.handles.add([e.manipulators.on("after-remove",i=>{this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs,!0,i.item.manipulator)}),e.manipulators.on("change",()=>{this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor()})],j3)}),this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor()}_updateToolEditableFlag(e){var i;(i=e.setEditableFlag)==null||i.call(e,cT.MANAGER,this.activeTool==null||e===this.activeTool)}_updateCursor(){let e=this._manipulatorState.cursor;e==null&&this._forEachTool(i=>!(i.cursor==null||!i.visible)&&(e=i.cursor,!0)),this._get("cursor")!==e&&this._set("cursor",e)}_removeIncompleteTools(e){this.tools.filter(i=>(e==null||i!==e)&&!i.created&&i.removeIncompleteOnCancel).forEach(i=>{this.tools.remove(i)})}get test(){return{setClock:e=>this._clock=e}}};d([p({constructOnly:!0,nonNullable:!0})],Fc.prototype,"view",void 0),d([p({readOnly:!0,nonNullable:!0})],Fc.prototype,"textures",void 0),d([p({value:null})],Fc.prototype,"activeTool",null),d([p({readOnly:!0,type:ye})],Fc.prototype,"tools",void 0),d([p({readOnly:!0})],Fc.prototype,"cursor",void 0),d([p({readOnly:!0})],Fc.prototype,"updating",null),d([p()],Fc.prototype,"_interacting",void 0),d([p({readOnly:!0})],Fc.prototype,"interacting",null),Fc=d([A("esri.views.ToolViewManager")],Fc);let nb=class extends he{constructor(e){super(),this.nativeIndex=null,this._detectedDeviceType="unknown",e.mapping==="standard"?this._detectedDeviceType="standard":nRe.test(e.id)?this._detectedDeviceType="spacemouse":this._detectedDeviceType="unknown",this.nativeIndex=e.index}get native(){const e=navigator.getGamepads?navigator.getGamepads():[];return this.nativeIndex!=null&&this.nativeIndex<e.length?e[this.nativeIndex]:null}get deviceType(){return this._detectedDeviceType}get axisThreshold(){return sRe[this.deviceType]}};d([p({nonNullable:!0,readOnly:!0})],nb.prototype,"nativeIndex",void 0),d([p({type:String,readOnly:!0})],nb.prototype,"deviceType",null),d([p({type:Number,readOnly:!0})],nb.prototype,"axisThreshold",null),nb=d([A("esri.views.input.gamepad.GamepadInputDevice")],nb);const nRe=new RegExp("^(3dconnexion|space(mouse|navigator|pilot|explorer))","i"),sRe={standard:.15,spacemouse:.025,unknown:0},FU=nb;let GS=class extends he{constructor(...e){super(...e),this.devices=new ye,this.enabledFocusMode="document"}};d([p({type:ye.ofType(FU),readOnly:!0})],GS.prototype,"devices",void 0),d([p({type:["document","view","none"]})],GS.prototype,"enabledFocusMode",void 0),GS=d([A("esri.views.input.gamepad.GamepadSettings")],GS);const oRe=GS;let nA=class extends he{constructor(){super(...arguments),this.gamepad=new oRe}};d([p({readOnly:!0})],nA.prototype,"gamepad",void 0),nA=d([A("esri.views.input.Input")],nA);const aRe=nA;let Tf=class extends he{constructor(e){super(e),this.enabled=!0,this.device=null,this.mode="pan",this.tiltDirection="forward-down",this.velocityFactor=1}};d([p({type:Boolean,nonNullable:!0})],Tf.prototype,"enabled",void 0),d([p({type:FU})],Tf.prototype,"device",void 0),d([p({type:["pan","zoom"],nonNullable:!0})],Tf.prototype,"mode",void 0),d([p({type:["forward-down","forward-up"],nonNullable:!0})],Tf.prototype,"tiltDirection",void 0),d([p({type:Number,nonNullable:!0})],Tf.prototype,"velocityFactor",void 0),Tf=d([A("esri.views.navigation.gamepad.GamepadSettings")],Tf);const Gce=Tf;let Sy=class extends he{constructor(e){super(e),this.browserTouchPanEnabled=!0,this.gamepad=new Gce,this.momentumEnabled=!0,this.mouseWheelZoomEnabled=!0}};d([p({type:Boolean})],Sy.prototype,"browserTouchPanEnabled",void 0),d([p({type:Gce,nonNullable:!0})],Sy.prototype,"gamepad",void 0),d([p({type:Boolean})],Sy.prototype,"momentumEnabled",void 0),d([p({type:Boolean})],Sy.prototype,"mouseWheelZoomEnabled",void 0),Sy=d([A("esri.views.navigation.Navigation")],Sy);const Hce=Sy,qce={mapserver:"MapServer",imageserver:"ImageServer",featureserver:"FeatureServer",sceneserver:"SceneServer",streamserver:"StreamServer",vectortileserver:"VectorTileServer"},Wce=Object.values(qce),Jce=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/rest\\/services\\/(.+?)\\/(${Wce.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),lRe=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/([^\\/\\n]+)\\/(${Wce.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),cRe=/(.*?)\/(?:layers\/)?(\d+)\/?$/i;function Rvt(t){return!!Jce.test(t)}function op(t){if(t==null)return null;const e=sn(t),i=e.path.match(Jce)||e.path.match(lRe);if(!i)return null;const[,r,n,s,o]=i,a=n.indexOf("/");return{title:DU(a!==-1?n.slice(a+1):n),serverType:qce[s.toLowerCase()],sublayer:o!=null&&o!==""?parseInt(o,10):null,url:{path:r}}}function uRe(t){const e=sn(t).path.match(cRe);return e?{serviceUrl:e[1],sublayerId:Number(e[2])}:null}function DU(t){return(t=t.replaceAll(/\s*[/_]+\s*/g," "))[0].toUpperCase()+t.slice(1)}function dRe(t,e){const i=[];if(t){const r=op(t);r!=null&&r.title&&i.push(r.title)}if(e){const r=DU(e);i.push(r)}if(i.length===2){if(i[0].toLowerCase().includes(i[1].toLowerCase()))return i[0];if(i[1].toLowerCase().includes(i[0].toLowerCase()))return i[1]}return i.join(" - ")}function Zce(t){if(!t)return!1;const e=".arcgis.com/",i="//services",r="//tiles",n="//features",s=(t=t.toLowerCase()).includes(e),o=t.includes(i)||t.includes(r)||t.includes(n);return s&&o}function NU(t,e){return t&&Une(Gne(t,e))}function hRe(t){let{url:e}=t;if(!e)return{url:e};e=Gne(e,t.logger);const i=sn(e),r=op(i.path);let n;if(r!=null)r.sublayer!=null&&t.layer.layerId==null&&(n=r.sublayer),e=r.url.path;else if(t.nonStandardUrlAllowed){const s=uRe(i.path);s!=null&&(e=s.serviceUrl,n=s.sublayerId)}return{url:Une(e),layerId:n}}function pRe(t,e,i,r,n){Iv(e,r,"url",n),r.url&&t.layerId!=null&&(r.url=Kw(r.url,i,t.layerId.toString()))}function Fvt(t){if(!t)return!1;const e=t.toLowerCase(),i=e.includes("/services/"),r=e.includes("/mapserver/wmsserver"),n=e.includes("/imageserver/wmsserver"),s=e.includes("/wmsserver");return i&&(r||n||s)}function Dvt(t,e,i){const r=Yce(t),n=e,s=fRe(r,n,i);if(r){const o=wC.deriveUnitFromSR(r,t.spatialReference).heightUnit;if(!i&&o!==r.heightUnit){const a=new N("layerview:unmatched-height-unit",`The vertical units of the layer must match the horizontal units (${o})`,{horizontalUnit:o});return new N("layerview:unsupported-height-model-info","The vertical coordinate system of the layer is not supported",{heightModelInfo:r,error:a})}}if(!mRe(t)||s===pa.Unsupported)return new N("layerview:unsupported-height-model-info","The vertical coordinate system of the layer is not supported",{heightModelInfo:r});switch(s){case pa.Units:{const o=(r==null?void 0:r.heightUnit)||"unknown",a=(n==null?void 0:n.heightUnit)||"unknown",l=new N("layerview:incompatible-height-unit",`The vertical units of the layer (${o}) must match the vertical units of the scene (${a})`,{layerUnit:o,sceneUnit:a});return new N("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:r,sceneHeightModelInfo:n,error:l})}case pa.HeightModel:{const o=(r==null?void 0:r.heightModel)||"unknown",a=(n==null?void 0:n.heightModel)||"unknown",l=new N("layerview:incompatible-height-model",`The height model of the layer (${o}) must match the height model of the scene (${a})`,{layerHeightModel:o,sceneHeightModel:a});return new N("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:r,sceneHeightModelInfo:n,error:l})}case pa.CRS:{const o=(r==null?void 0:r.vertCRS)||"unknown",a=(n==null?void 0:n.vertCRS)||"unknown",l=new N("layerview:incompatible-vertical-datum",`The vertical datum of the layer (${o}) must match the vertical datum of the scene (${a})`,{layerDatum:o,sceneDatum:a});return new N("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:r,sceneHeightModelInfo:n,error:l})}}return null}function fRe(t,e,i){if(!tJ(t)||!tJ(e))return pa.Unsupported;if(t==null||e==null)return pa.Ok;if(!i&&t.heightUnit!==e.heightUnit)return pa.Units;if(t.heightModel!==e.heightModel)return pa.HeightModel;switch(t.heightModel){case"gravity-related-height":return pa.Ok;case"ellipsoidal":return t.vertCRS===e.vertCRS?pa.Ok:pa.CRS;default:return pa.Unsupported}}var pa;function tJ(t){return t==null||t.heightModel!=null&&t.heightUnit!=null}function mRe(t){return"heightModelInfo"in t&&t.heightModelInfo!=null||t.spatialReference!=null||!Qce(t)}function Yce(t){var r;const e=t.url?op(t.url):void 0;return!(((r=t.spatialReference)==null?void 0:r.vcsWkid)==null&&e!=null&&e.serverType==="ImageServer")&&Kce(t)&&t.heightModelInfo?t.heightModelInfo:Qce(t)?wC.deriveUnitFromSR(yRe,t.spatialReference):null}function Kce(t){return"heightModelInfo"in t}function Xce(t){if(t.type==="unknown"||!("capabilities"in t))return!1;switch(t.type){case"csv":case"feature":case"geojson":case"subtype-group":case"ogc-feature":case"oriented-imagery":case"wfs":case"knowledge-graph-sublayer":return!0;default:return!1}}function Qce(t){return Xce(t)?!!(t.capabilities&&t.capabilities.data&&t.capabilities.data.supportsZ):eue(t)}function gRe(t){return t.layers!=null||eue(t)||Xce(t)||Kce(t)}function eue(t){switch(t.type){case"building-scene":case"elevation":case"integrated-mesh":case"point-cloud":case"scene":case"voxel":return!0;case"base-dynamic":case"base-elevation":case"base-tile":case"bing-maps":case"csv":case"dimension":case"geojson":case"feature":case"subtype-group":case"geo-rss":case"graphics":case"group":case"imagery":case"imagery-tile":case"kml":case"knowledge-graph":case"link-chart":case"knowledge-graph-sublayer":case"line-of-sight":case"map-image":case"map-notes":case"media":case"ogc-feature":case"open-street-map":case"oriented-imagery":case"route":case"stream":case"tile":case"unknown":case"unsupported":case"vector-tile":case"video":case"wcs":case"web-tile":case"wfs":case"wms":case"wmts":case null:return!1}return!1}(function(t){t[t.Ok=0]="Ok",t[t.Units=1]="Units",t[t.HeightModel=2]="HeightModel",t[t.CRS=3]="CRS",t[t.Unsupported=4]="Unsupported"})(pa||(pa={}));const yRe=new wC({heightModel:"gravity-related-height"});var u1;(function(t){t[t.Global=1]="Global",t[t.Local=2]="Local"})(u1||(u1={}));let z4,B3=null;async function vRe(t){B3||(B3=W(()=>import("./geometryServiceUtils-c40372cf.js"),[],import.meta.url).then(e=>z4=e)),await B3,_t(t)}async function tue(t,e,i,r){if(!t)return null;const n=t.spatialReference;return pc()||lc(n,e)?Ir(t,e):z4?z4.projectGeometry(t,e,i,r):(await Promise.race([vRe(r),Eu(r)]),tue(t,e,i,r))}let Ci=class extends he{constructor(e){super(e),this.required={tileInfo:!1,heightModelInfo:!1,extent:!1},this.defaultSpatialReference=null,this.userSpatialReference=null,this.sourcePreloadCount=10,this.priorityCollection=null,this.requiresExtentInSpatialReference=!0,this.suspended=!1,this._projectExtentTask={task:null,input:null,output:null,spatialReference:null}}destroy(){this._projectExtentTask.task&&(this._projectExtentTask.task=Qr(this._projectExtentTask.task)),this._set("map",null)}get ready(){return!this._spatialReferenceTask.updating&&!this._tileInfoTask.updating&&!this._extentTask.updating}get heightModelInfoReady(){return!this._heightModelInfoTask.updating}get spatialReference(){return this.userSpatialReference!=null?this.userSpatialReference:this._spatialReferenceTask.spatialReference}get extent(){return this._extentTask.extent}get heightModelInfo(){return this._heightModelInfoTask.heightModelInfo}get vcsWkid(){return this._heightModelInfoTask.vcsWkid}get latestVcsWkid(){return this._heightModelInfoTask.latestVcsWkid}get viewingMode(){return this.userSpatialReference==null||this.userSpatialReference.equals(this._spatialReferenceTask.spatialReference)?this._spatialReferenceTask.viewingMode:null}get tileInfo(){return this._tileInfoTask.tileInfo}get mapCollections(){var r,n,s,o;const e=(r=this.map)==null?void 0:r.call(this),i=[];return this.priorityCollection!=null&&i.push(this.priorityCollection),i.push({parent:e==null?void 0:e.basemap,layers:(n=e==null?void 0:e.basemap)==null?void 0:n.baseLayers},{layers:e==null?void 0:e.layers},{parent:e==null?void 0:e.ground,layers:(s=e==null?void 0:e.ground)==null?void 0:s.layers},{parent:e==null?void 0:e.basemap,layers:(o=e==null?void 0:e.basemap)==null?void 0:o.referenceLayers}),i}get _allLayers(){return this._collectLayers(this.mapCollections)}get _spatialReferenceTask(){if(this.suspended)return this._get("_spatialReferenceTask")??{updating:!1};const{layers:e,updating:i}=this._allLayers;let r=null;for(const s of e){const o=this._getSupportedSpatialReferences(s);if(o.length>0){const a=this._narrowDownSpatialReferenceCandidates(r,o);a!=null&&(r=a)}if(r!=null&&r.length===1)break}if(i&&(r==null||r.length!==1))return{updating:!0};const n=this._pickSpatialReferenceCandidate(r);return{spatialReference:n!=null?n.spatialReference:null,viewingMode:n!=null?n.viewingMode:null,updating:!1}}get _tileInfoTask(){var r,n,s,o,a,l,c;if(!this.required.tileInfo)return this._get("_tileInfoTask")??{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const{layers:e,updating:i}=this._collectLayers([{parent:(n=(r=this.map)==null?void 0:r.call(this))==null?void 0:n.basemap,layers:(a=(o=(s=this.map)==null?void 0:s.call(this))==null?void 0:o.basemap)==null?void 0:a.baseLayers},{layers:(c=(l=this.map)==null?void 0:l.call(this))==null?void 0:c.layers}]);if(e&&e.length>0&&"tileInfo"in e[0]){const u=e[0].tileInfo;return{tileInfo:u&&u.spatialReference.equals(this.spatialReference)?u:null,updating:!1}}return{updating:i}}get _heightModelInfoTask(){var r,n,s;if(!this.required.heightModelInfo||this.suspended&&((r=this._get("_heightModelInfoTask"))!=null&&r.heightModelInfo))return this._get("_heightModelInfoTask")??{updating:!1};const{layers:e,updating:i}=this._allLayers;for(const o of e)if(gRe(o)){const a=Yce(o);if(a)return{heightModelInfo:a,vcsWkid:(n=o.spatialReference)==null?void 0:n.vcsWkid,latestVcsWkid:(s=o.spatialReference)==null?void 0:s.latestVcsWkid,updating:!1}}return{updating:i}}get _extentCandidatesTask(){if(this.suspended||!this.required.extent)return this._get("_extentCandidatesTask")??{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const e=this._allLayers,i=e.updating,r=[];for(const n of e.layers){const s="fullExtents"in n&&n.fullExtents||(n.fullExtent!=null?[n.fullExtent]:[]),o=this.requiresExtentInSpatialReference?null:s[0],a=s.find(l=>l.spatialReference.equals(this.spatialReference))??o;if(a)return{candidates:[{extent:a,layer:n}],updating:!1};if(this._getSupportedSpatialReferences(n).length>0)for(const l of s)r.push({extent:l,layer:n})}return{candidates:r,updating:i}}get _extentTask(){const{candidates:e,updating:i}=this._extentCandidatesTask;if(i)return{updating:i};if(e==null||e.length===0)return{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const r=this._pickExtentCandidate(e),n=this.spatialReference;return r.extent.equals(this._projectExtentTask.input)&&n.equals(this._projectExtentTask.spatialReference)?{extent:this._projectExtentTask.output,updating:this._projectExtentTask.task!=null&&!this._projectExtentTask.task.finished}:(this._projectExtentTask.task!=null&&(this._projectExtentTask.task=Qr(this._projectExtentTask.task)),this._projectExtentTask={input:r.extent.clone(),output:null,spatialReference:n.clone(),task:Cp(async s=>{try{const o=await tue(r.extent,n,"portalItem"in r.layer?r.layer.portalItem:void 0,s);this._projectExtentTask={...this._projectExtentTask,task:null,output:o}}catch{if(zo(s))return;this._projectExtentTask={...this._projectExtentTask,task:null}}})},{updating:!0})}_narrowDownSpatialReferenceCandidates(e,i){if(e==null)return i;const r=[],n=(s,o)=>s!=null?o!=null?s===o&&s:s:o;for(const s of e)for(const o of i){if(!s.spatialReference.equals(o.spatialReference))continue;const a=n(s.viewingMode,o.viewingMode);if(a!==!1){r.push({spatialReference:s.spatialReference,viewingMode:a});break}}return r.length>0?r:null}_pickSpatialReferenceCandidate(e){const i=this.defaultSpatialReference;return e==null||e.length<1?i!=null?{spatialReference:i,viewingMode:null}:null:(i!=null&&e.length>1&&e.some(({spatialReference:r})=>r.equals(i))&&(e=e.filter(({spatialReference:r})=>r.equals(i))),e.length>1&&e.some(({viewingMode:r})=>r!==u1.Local)&&(e=e.filter(({viewingMode:r})=>r!==u1.Local)),e[0])}_getSupportedSpatialReferences(e){const i="supportedSpatialReferences"in e&&e.supportedSpatialReferences||(e.spatialReference?[e.spatialReference]:[]);if(i.length===0)return[];const r=[];for(const n of i){const s=this.getSpatialReferenceSupport({spatialReference:n,layer:e});if(s!=null){const o=s.constraints!=null?s.constraints:[{spatialReference:n,viewingMode:null}];for(const{spatialReference:a,viewingMode:l}of o)this.requiresExtentInSpatialReference&&this.userSpatialReference!=null&&!a.equals(this.userSpatialReference)||r.push({spatialReference:a,viewingMode:l})}}return r}_pickExtentCandidate(e){const i=this.spatialReference;return e.find(({extent:r})=>i.equals(r.spatialReference))||e[0]}_collectLayers(e){var r;if(this._loadMaybe((r=this.map)==null?void 0:r.call(this))!=="loaded")return{layers:[],updating:!0};const i=new _Re;for(const n of e)if(this._collectCollection(n,i),i.preloading===this.sourcePreloadCount)break;return{layers:i.layers,updating:i.updating}}_collectCollection(e,i){if(e.layers){switch(this._loadMaybe(e.parent)){case"loading":return i.updating=!0,void++i.preloading;case"failed":return}for(const r of e.layers){switch(this._loadMaybe(r)){case"failed":continue;case"loading":i.updating=!0,++i.preloading;break;case"loaded":i.updating||i.layers.push(r),"layers"in r&&this._collectCollection({layers:r.layers},i)}if(i.preloading===this.sourcePreloadCount)break}}}_loadMaybe(e){return e&&"loadStatus"in e&&e.loadStatus!=null?e.loadStatus==="not-loaded"?(e.load().catch(i=>{ys(i)||console.log(i)}),"loading"):e.loadStatus:"loaded"}};d([p()],Ci.prototype,"required",void 0),d([p({constructOnly:!0})],Ci.prototype,"map",void 0),d([p({constructOnly:!0})],Ci.prototype,"getSpatialReferenceSupport",void 0),d([p()],Ci.prototype,"defaultSpatialReference",void 0),d([p()],Ci.prototype,"userSpatialReference",void 0),d([p()],Ci.prototype,"sourcePreloadCount",void 0),d([p()],Ci.prototype,"priorityCollection",void 0),d([p()],Ci.prototype,"requiresExtentInSpatialReference",void 0),d([p()],Ci.prototype,"suspended",void 0),d([p({readOnly:!0})],Ci.prototype,"ready",null),d([p({readOnly:!0})],Ci.prototype,"heightModelInfoReady",null),d([p({readOnly:!0})],Ci.prototype,"spatialReference",null),d([p({readOnly:!0})],Ci.prototype,"extent",null),d([p({readOnly:!0})],Ci.prototype,"heightModelInfo",null),d([p({readOnly:!0})],Ci.prototype,"vcsWkid",null),d([p({readOnly:!0})],Ci.prototype,"latestVcsWkid",null),d([p({readOnly:!0})],Ci.prototype,"viewingMode",null),d([p({readOnly:!0})],Ci.prototype,"tileInfo",null),d([p({readOnly:!0})],Ci.prototype,"mapCollections",null),d([p({readOnly:!0})],Ci.prototype,"_allLayers",null),d([p({readOnly:!0})],Ci.prototype,"_spatialReferenceTask",null),d([p({readOnly:!0})],Ci.prototype,"_tileInfoTask",null),d([p({readOnly:!0})],Ci.prototype,"_heightModelInfoTask",null),d([p({readOnly:!0})],Ci.prototype,"_extentCandidatesTask",null),d([p()],Ci.prototype,"_extentTask",null),d([p()],Ci.prototype,"_projectExtentTask",void 0),Ci=d([A("esri.views.support.DefaultsFromMap")],Ci);let _Re=class{constructor(){this.layers=new Array,this.preloading=-1,this.updating=!1}};var HS;let ze=HS=class extends cn(an.EventedMixin(F1(he))){constructor(t){super(t),this._userSpatialReference=null,this._cursor=null,this.allLayerViews=new ZI({getCollections:()=>{var e,i,r;return[(e=this.basemapView)==null?void 0:e.baseLayerViews,(i=this.groundView)==null?void 0:i.layerViews,this.layerViews,(r=this.basemapView)==null?void 0:r.referenceLayerViews]},getChildrenFunction:wRe}),this.groundView=null,this.basemapView=null,this.fatalError=null,this.graphics=new ov,this.analyses=new fP,this.typeSpecificPreconditionsReady=!0,this.layerViews=new ye,this.magnifier=new Nce,this.padding={left:0,top:0,right:0,bottom:0},this.ready=!1,this.spatialReferenceWarningDelay=1e3,this.supportsGround=!0,this.timeExtent=null,this.timeReference=new c1,this.type=null,this.scale=null,this.updating=!1,this.initialExtentRequired=!0,this.input=new aRe,this.navigation=new Hce,this.layerViewManager=null,this.analysisViewManager=null,this.isHeightModelInfoRequired=!1,this.width=null,this.height=null,this.resizing=!1,this.suspended=!1,this.viewEvents=new XLe(this),this.persistableViewModels=new ye,this._isValid=!1,this._readyCycleForced=!1,this._currentSpatialReference=null,this.handles.add(J(()=>this.preconditionsReady,e=>{var i,r;e?(this._currentSpatialReference=this.spatialReference,HS.views.add(this)):(this._currentSpatialReference=null,HS.views.remove(this)),this.notifyChange("spatialReference"),!e&&this.ready?((i=this.toolViewManager)==null||i.detach(),this.analysisViewManager!=null&&this.analysisViewManager.detach(),(r=this.layerViewManager)==null||r.clear(),this._teardown()):e&&!this.ready&&(this._startup(),this.analysisViewManager!=null&&this.analysisViewManager.attach(),this.toolViewManager.attach())},Ca))}initialize(){this.addResolvingPromise(this.validate().then(()=>(this._isValid=!0,_r(()=>this.ready)))),this.basemapView=new If({view:this}),this.layerViewManager=new GLe({view:this,layerViewImporter:{importLayerView:t=>this.importLayerView(t),hasLayerViewModule:t=>this.hasLayerViewModule(t)},supportsGround:this.supportsGround}),this.toolViewManager=new Fc({view:this}),this._setupSpatialReferenceLogger(),this.handles.add([J(()=>this.initialExtentRequired,t=>this.defaultsFromMap.required={...this.defaultsFromMap.required,extent:t},{sync:!0,initial:!0}),J(()=>this.ready,t=>{this.defaultsFromMap&&(this.defaultsFromMap.suspended=t,this.defaultsFromMap.userSpatialReference=t?this.spatialReference:this._userSpatialReference)},{sync:!0}),J(()=>this._userSpatialReference,t=>{this.defaultsFromMap&&(this.defaultsFromMap.userSpatialReference=t)},{sync:!0,initial:!0})])}_setupSpatialReferenceLogger(){let t=null;this.handles.add([J(()=>{var e;return(e=this.defaultsFromMap)==null?void 0:e.ready},e=>{var r;const i=((r=this.map)==null?void 0:r.allLayers.length)>0;if(e&&!this.spatialReference&&i){if(t!=null)return;const n=Et(()=>t=Qr(t));t=Cp(async s=>{try{await XT(this.spatialReferenceWarningDelay,null,s)}catch{return}finally{t=null}ie.getLogger(this).warn("#spatialReference","no spatial reference could be derived from the currently added map layers")}),this.handles.add(n,"spatial-reference-logger-task")}else this.handles.remove("spatial-reference-logger-task")},{sync:!0})])}destroy(){var t,e;this.destroyed||(HS.views.remove(this),this.viewEvents.destroy(),this.allLayerViews.destroy(),this.navigation&&(this.navigation.destroy(),this._set("navigation",null)),this.graphics=je(this.graphics),this.analyses=je(this.analyses),this.handles.remove("defaultsFromMap"),this.defaultsFromMap.destroy(),this._set("defaultsFromMap",null),je(this.analysisViewManager),this.toolViewManager=je(this.toolViewManager),this.layerViewManager=je(this.layerViewManager),this.basemapView=je(this.basemapView),(t=this.groundView)==null||t.destroy(),(e=this.layerViews)==null||e.forEach(i=>i.destroy()),this.layerViews.length=0,this.invalidate(),this._emitter.clear(),this.handles.removeAll(),this.map=je(this.map))}_startup(){this._set("ready",!0)}_teardown(){this._set("ready",!1)}whenReady(){return Promise.resolve(this)}toMap(){return ie.getLogger(this).error("#toMap()","Not implemented on this instance of View"),null}get activeTool(){var t;return(t=this.toolViewManager)==null?void 0:t.activeTool}set activeTool(t){this.toolViewManager&&(this.toolViewManager.activeTool=t)}get animation(){return this._get("animation")}set animation(t){this._set("animation",t)}get center(){return null}get _defaultsFromMapSettings(){return{}}get defaultsFromMap(){return new Ci({required:{tileInfo:!1,heightModelInfo:!1,extent:!1},map:()=>this.map,getSpatialReferenceSupport:t=>this.getSpatialReferenceSupport(t),...this._defaultsFromMapSettings})}get extent(){return this._get("extent")}set extent(t){this._set("extent",t)}get heightModelInfo(){return this.getDefaultHeightModelInfo()}get interacting(){return this.navigating}get navigating(){return!1}get preconditionsReady(){var t;return!(this.fatalError||!this._isValid||this._readyCycleForced||!this.map||Su.isLoadable(this.map)&&!this.map.loaded||this.width===0||this.height===0||!this.spatialReference||!this._validateSpatialReference(this.spatialReference)||!this._currentSpatialReference&&!((t=this.defaultsFromMap)!=null&&t.ready)||!this.typeSpecificPreconditionsReady)}get resolution(){return 0}set map(t){t!==this._get("map")&&(t!=null&&t.destroyed&&(ie.getLogger(this).warn("#map","The provided map is already destroyed",{map:t}),t=null),Su.isLoadable(t)&&t.load().catch(()=>{}),this.constructed&&!this.destroyed&&(this.forceReadyCycle(),this._currentSpatialReference=null),this._set("map",t))}get spatialReference(){var e,i;let t=this._userSpatialReference||this._currentSpatialReference||this.getDefaultSpatialReference()||null;return t&&((i=(e=this.defaultsFromMap)==null?void 0:e.required)!=null&&i.heightModelInfo)&&(t=t.clone(),t.vcsWkid=this.defaultsFromMap.vcsWkid,t.latestVcsWkid=this.defaultsFromMap.latestVcsWkid),t}set spatialReference(t){const e=!Pr(t,this._get("spatialReference"));this._set("_userSpatialReference",t),e&&(this._set("spatialReference",t),this._spatialReferenceChanged(t))}_spatialReferenceChanged(t){}get stationary(){return!this.animation&&!this.navigating&&!this.resizing}get tools(){var t;return(t=this.toolViewManager)==null?void 0:t.tools}get initialExtent(){var t;return(t=this.defaultsFromMap)==null?void 0:t.extent}get cursor(){const t=this.toolViewManager?this.toolViewManager.cursor:null;return t??(this._cursor||"default")}set cursor(t){this._cursor=t,this.notifyChange("cursor")}get size(){return[this.width,this.height]}whenLayerView(t){var e;return((e=this.layerViewManager)==null?void 0:e.whenLayerView(t))??Promise.reject()}getDefaultSpatialReference(){var t;return(t=this.defaultsFromMap)==null?void 0:t.spatialReference}getDefaultHeightModelInfo(){var t;return(this.map&&"heightModelInfo"in this.map?this.map.heightModelInfo:void 0)??((t=this.defaultsFromMap)==null?void 0:t.heightModelInfo)??null}importLayerView(t){throw new N("importLayerView() not implemented")}hasLayerViewModule(t){return!1}async validate(){}invalidate(){this._isValid=!1}getSpatialReferenceSupport(){return{constraints:null}}_validateSpatialReference(t){return this.getSpatialReferenceSupport({spatialReference:t})!=null}when(t,e){return this.isResolved()&&!this.ready&&ie.getLogger(this).warn("#when()","Calling view.when() while the view is no longer ready but was already resolved once will resolve immediately. Use reactiveUtils.whenOnce(() => view.ready).then(...) instead."),super.when(t,e)}forceReadyCycle(){this.ready&&(tn(()=>this.destroyed||this.preconditionsReady===!1,()=>this._readyCycleForced=!1,{once:!0}),this._readyCycleForced=!0)}addAndActivateTool(t){this.toolViewManager.tools.add(t),this.activeTool=t}tryFatalErrorRecovery(){this.fatalError=null}};ze.views=new ye,d([p()],ze.prototype,"_userSpatialReference",void 0),d([p()],ze.prototype,"activeTool",null),d([p({readOnly:!0})],ze.prototype,"allLayerViews",void 0),d([p()],ze.prototype,"groundView",void 0),d([p()],ze.prototype,"animation",null),d([p()],ze.prototype,"basemapView",void 0),d([p()],ze.prototype,"center",null),d([p({readOnly:!0})],ze.prototype,"_defaultsFromMapSettings",null),d([p()],ze.prototype,"defaultsFromMap",null),d([p()],ze.prototype,"fatalError",void 0),d([p({type:Re})],ze.prototype,"extent",null),d([p(R4(ov,"graphics"))],ze.prototype,"graphics",void 0),d([p(R4(fP,"analyses"))],ze.prototype,"analyses",void 0),d([p({readOnly:!0,type:wC})],ze.prototype,"heightModelInfo",null),d([p({readOnly:!0})],ze.prototype,"interacting",null),d([p({readOnly:!0})],ze.prototype,"navigating",null),d([p({readOnly:!0,dependsOn:["fatalError","_isValid","_readyCycleForced","map","map.loaded?","width","height","spatialReference","_currentSpatialReference","defaultsFromMap.ready","typeSpecificPreconditionsReady"]})],ze.prototype,"preconditionsReady",null),d([p({readOnly:!0})],ze.prototype,"typeSpecificPreconditionsReady",void 0),d([p({type:ye,readOnly:!0})],ze.prototype,"layerViews",void 0),d([p()],ze.prototype,"resolution",null),d([p({type:Nce})],ze.prototype,"magnifier",void 0),d([p({value:null,type:Ioe})],ze.prototype,"map",null),d([p()],ze.prototype,"padding",void 0),d([p({readOnly:!0})],ze.prototype,"ready",void 0),d([p({type:Ee})],ze.prototype,"spatialReference",null),d([p()],ze.prototype,"spatialReferenceWarningDelay",void 0),d([p()],ze.prototype,"stationary",null),d([p({readOnly:!0})],ze.prototype,"supportsGround",void 0),d([p({type:ku})],ze.prototype,"timeExtent",void 0),d([p({type:c1,nonNullable:!0})],ze.prototype,"timeReference",void 0),d([p()],ze.prototype,"tools",null),d([p()],ze.prototype,"toolViewManager",void 0),d([p({readOnly:!0})],ze.prototype,"type",void 0),d([p({type:Number})],ze.prototype,"scale",void 0),d([p({readOnly:!0})],ze.prototype,"updating",void 0),d([p({readOnly:!0})],ze.prototype,"initialExtentRequired",void 0),d([p({readOnly:!0})],ze.prototype,"initialExtent",null),d([p()],ze.prototype,"cursor",null),d([p({readOnly:!0})],ze.prototype,"input",void 0),d([p({type:Hce,nonNullable:!0})],ze.prototype,"navigation",void 0),d([p()],ze.prototype,"layerViewManager",void 0),d([p()],ze.prototype,"analysisViewManager",void 0),d([p()],ze.prototype,"width",void 0),d([p()],ze.prototype,"height",void 0),d([p({readOnly:!0})],ze.prototype,"resizing",void 0),d([p({value:null,readOnly:!0})],ze.prototype,"size",null),d([p({readOnly:!0})],ze.prototype,"suspended",void 0),d([p({readOnly:!0})],ze.prototype,"viewEvents",void 0),d([p({readOnly:!0})],ze.prototype,"persistableViewModels",void 0),d([p()],ze.prototype,"_isValid",void 0),d([p()],ze.prototype,"_readyCycleForced",void 0),d([p()],ze.prototype,"_currentSpatialReference",void 0),ze=HS=d([A("esri.views.View")],ze);const bRe=ze;function wRe(t){return t.layerViews}let Cf=class extends Dk{constructor(e){super(e),this.state="running",this.target=null,this._resolver=null}initialize(){this._resolver=Ta(),this.addResolvingPromise(this._resolver.promise)}get done(){return this.state==="finished"||this.state==="stopped"}stop(){var e;this.state!=="stopped"&&this.state!=="finished"&&(this._set("state","stopped"),(e=this._resolver)==null||e.reject(new N("ViewAnimation stopped")))}finish(){var e;this.state!=="stopped"&&this.state!=="finished"&&(this._set("state","finished"),(e=this._resolver)==null||e.resolve())}update(e,i){i||(i=Tp(e)?"waiting-for-target":"running"),this._set("target",e),this._set("state",i)}};d([p({readOnly:!0})],Cf.prototype,"done",null),d([p({readOnly:!0,type:String})],Cf.prototype,"state",void 0),d([p()],Cf.prototype,"target",void 0),Cf=d([A("esri.views.ViewAnimation")],Cf),function(t){t.State={RUNNING:"running",STOPPED:"stopped",FINISHED:"finished",WAITING_FOR_TARGET:"waiting-for-target"}}(Cf||(Cf={}));const j4=Cf;function M0(t,e,i,r){const n=3*t,s=3*(i-t)-n,o=1-n-s,a=3*e,l=3*(r-e)-a,c=1-a-l;function u(g){return((o*g+s)*g+n)*g}function h(g){return((c*g+l)*g+a)*g}function f(g){return(3*o*g+2*s)*g+n}function m(g,y){let v,b,w,x,S,I;for(w=g,I=0;I<8;I++){if(x=u(w)-g,Math.abs(x)<y)return w;if(S=f(w),Math.abs(S)<1e-6)break;w-=x/S}if(v=0,b=1,w=g,w<v)return v;if(w>b)return b;for(;v<b;){if(x=u(w),Math.abs(x-g)<y)return w;g>x?v=w:b=w,w=.5*(b-v)+v}return w}return function(g,y=1e-6){return h(m(g,y))}}const xRe=/^cubic-bezier\((.*)\)/,Gl={};function SRe(t){let e=Gl[t]||null;if(!e){const i=xRe.exec(t);if(i){const r=i[1].split(",").map(n=>parseFloat(n.trim()));r.length!==4||r.some(n=>isNaN(n))||(e=M0.apply(M0,r))}}return e}Gl.ease=M0(.25,.1,.25,1),Gl.linear=M0(0,0,1,1),Gl.easeIn=Gl["ease-in"]=M0(.42,0,1,1),Gl.easeOut=Gl["ease-out"]=M0(0,0,.58,1),Gl.easeInOut=Gl["ease-in-out"]=M0(.42,0,.58,1);function IRe(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function SL(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}function TRe(t,e,i,r,n,s,o){return t[0]=e,t[1]=i,t[2]=r,t[3]=n,t[4]=s,t[5]=o,t}function VU(t,e){const i=e[0],r=e[1],n=e[2],s=e[3],o=e[4],a=e[5];let l=i*s-r*n;return l?(l=1/l,t[0]=s*l,t[1]=-r*l,t[2]=-n*l,t[3]=i*l,t[4]=(n*a-s*o)*l,t[5]=(r*o-i*a)*l,t):null}function CRe(t){return t[0]*t[3]-t[1]*t[2]}function $0(t,e,i){const r=e[0],n=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=i[0],u=i[1],h=i[2],f=i[3],m=i[4],g=i[5];return t[0]=r*c+s*u,t[1]=n*c+o*u,t[2]=r*h+s*f,t[3]=n*h+o*f,t[4]=r*m+s*g+a,t[5]=n*m+o*g+l,t}function xC(t,e,i){const r=e[0],n=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=Math.sin(i),u=Math.cos(i);return t[0]=r*u+s*c,t[1]=n*u+o*c,t[2]=r*-c+s*u,t[3]=n*-c+o*u,t[4]=a,t[5]=l,t}function IL(t,e,i){const r=e[0],n=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=i[0],u=i[1];return t[0]=r*c,t[1]=n*c,t[2]=s*u,t[3]=o*u,t[4]=a,t[5]=l,t}function d1(t,e,i){const r=e[0],n=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=i[0],u=i[1];return t[0]=r,t[1]=n,t[2]=s,t[3]=o,t[4]=r*c+s*u+a,t[5]=n*c+o*u+l,t}function iue(t,e){const i=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=i,t[2]=-i,t[3]=r,t[4]=0,t[5]=0,t}function rue(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t}function zU(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t}function ERe(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"}function MRe(t){return Math.sqrt(t[0]**2+t[1]**2+t[2]**2+t[3]**2+t[4]**2+t[5]**2+1)}function $Re(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t[4]=e[4]+i[4],t[5]=e[5]+i[5],t}function nue(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t[4]=e[4]-i[4],t[5]=e[5]-i[5],t}function ARe(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*i,t[5]=e[5]*i,t}function kRe(t,e,i,r){return t[0]=e[0]+i[0]*r,t[1]=e[1]+i[1]*r,t[2]=e[2]+i[2]*r,t[3]=e[3]+i[3]*r,t[4]=e[4]+i[4]*r,t[5]=e[5]+i[5]*r,t}function PRe(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]}function ORe(t,e){const i=t[0],r=t[1],n=t[2],s=t[3],o=t[4],a=t[5],l=e[0],c=e[1],u=e[2],h=e[3],f=e[4],m=e[5],g=Bo();return Math.abs(i-l)<=g*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(r-c)<=g*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(n-u)<=g*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(s-h)<=g*Math.max(1,Math.abs(s),Math.abs(h))&&Math.abs(o-f)<=g*Math.max(1,Math.abs(o),Math.abs(f))&&Math.abs(a-m)<=g*Math.max(1,Math.abs(a),Math.abs(m))}const LRe=$0,RRe=nue;Object.freeze(Object.defineProperty({__proto__:null,add:$Re,copy:IRe,determinant:CRe,equals:ORe,exactEquals:PRe,frob:MRe,fromRotation:iue,fromScaling:rue,fromTranslation:zU,identity:SL,invert:VU,mul:LRe,multiply:$0,multiplyScalar:ARe,multiplyScalarAndAdd:kRe,rotate:xC,scale:IL,set:TRe,str:ERe,sub:RRe,subtract:nue,translate:d1},Symbol.toStringTag,{value:"Module"}));function Xm(){return[1,0,0,1,0,0]}function FRe(t){return[t[0],t[1],t[2],t[3],t[4],t[5]]}function DRe(t,e,i,r,n,s){return[t,e,i,r,n,s]}function NRe(t,e){return new Float64Array(t,e,6)}Object.freeze(Object.defineProperty({__proto__:null,clone:FRe,create:Xm,createView:NRe,fromValues:DRe},Symbol.toStringTag,{value:"Module"}));function uT(t,e){return t[0]=e[0],t[1]=e[1],t}function cs(t,e,i){return t[0]=e,t[1]=i,t}function jU(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t}function $n(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t}function sue(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t}function oue(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t}function VRe(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t}function zRe(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t}function jRe(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t}function BRe(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t}function URe(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t}function K1(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t}function ap(t,e,i,r){return t[0]=e[0]+i[0]*r,t[1]=e[1]+i[1]*r,t}function Ig(t,e){const i=e[0]-t[0],r=e[1]-t[1];return Math.sqrt(i*i+r*r)}function $u(t,e){const i=e[0]-t[0],r=e[1]-t[1];return i*i+r*r}function h1(t){const e=t[0],i=t[1];return Math.sqrt(e*e+i*i)}function ug(t){const e=t[0],i=t[1];return e*e+i*i}function aue(t,e){return t[0]=-e[0],t[1]=-e[1],t}function GRe(t,e){return t[0]=1/e[0],t[1]=1/e[1],t}function B4(t,e){const i=e[0],r=e[1];let n=i*i+r*r;return n>0&&(n=1/Math.sqrt(n),t[0]=e[0]*n,t[1]=e[1]*n),t}function Tg(t,e){return t[0]*e[0]+t[1]*e[1]}function lue(t,e,i){const r=e[0]*i[1]-e[1]*i[0];return t[0]=t[1]=0,t[2]=r,t}function BU(t,e,i,r){const n=e[0],s=e[1];return t[0]=n+r*(i[0]-n),t[1]=s+r*(i[1]-s),t}function HRe(t,e){e=e||1;const i=2*sC()*Math.PI;return t[0]=Math.cos(i)*e,t[1]=Math.sin(i)*e,t}function qRe(t,e,i){const r=e[0],n=e[1];return t[0]=i[0]*r+i[2]*n,t[1]=i[1]*r+i[3]*n,t}function _d(t,e,i){const r=e[0],n=e[1];return t[0]=i[0]*r+i[2]*n+i[4],t[1]=i[1]*r+i[3]*n+i[5],t}function WRe(t,e,i){const r=e[0],n=e[1];return t[0]=i[0]*r+i[3]*n+i[6],t[1]=i[1]*r+i[4]*n+i[7],t}function JRe(t,e,i){const r=e[0],n=e[1];return t[0]=i[0]*r+i[4]*n+i[12],t[1]=i[1]*r+i[5]*n+i[13],t}function ZRe(t,e,i,r){const n=e[0]-i[0],s=e[1]-i[1],o=Math.sin(r),a=Math.cos(r);return t[0]=n*a-s*o+i[0],t[1]=n*o+s*a+i[1],t}function YRe(t,e){const i=t[0],r=t[1],n=e[0],s=e[1];let o=i*i+r*r;o>0&&(o=1/Math.sqrt(o));let a=n*n+s*s;a>0&&(a=1/Math.sqrt(a));const l=(i*n+r*s)*o*a;return l>1?0:l<-1?Math.PI:Math.acos(l)}function KRe(t){return"vec2("+t[0]+", "+t[1]+")"}function XRe(t,e){return t[0]===e[0]&&t[1]===e[1]}function QRe(t,e){const i=t[0],r=t[1],n=e[0],s=e[1],o=Bo();return Math.abs(i-n)<=o*Math.max(1,Math.abs(i),Math.abs(n))&&Math.abs(r-s)<=o*Math.max(1,Math.abs(r),Math.abs(s))}function e3e(t,e,i,r,n){let s=e[0]-i[0],o=e[1]-i[1];const a=(r[0]*s+r[1]*o)*(n-1);return s=r[0]*a,o=r[1]*a,t[0]=e[0]+s,t[1]=e[1]+o,t}const t3e=h1,TL=$n,i3e=sue,r3e=oue,n3e=Ig,s3e=$u,o3e=ug;Object.freeze(Object.defineProperty({__proto__:null,add:jU,angle:YRe,ceil:VRe,copy:uT,cross:lue,dist:n3e,distance:Ig,div:r3e,divide:oue,dot:Tg,equals:QRe,exactEquals:XRe,floor:zRe,inverse:GRe,len:t3e,length:h1,lerp:BU,max:BRe,min:jRe,mul:i3e,multiply:sue,negate:aue,normalize:B4,projectAndScale:e3e,random:HRe,rotate:ZRe,round:URe,scale:K1,scaleAndAdd:ap,set:cs,sqrDist:s3e,sqrLen:o3e,squaredDistance:$u,squaredLength:ug,str:KRe,sub:TL,subtract:$n,transformMat2:qRe,transformMat2d:_d,transformMat3:WRe,transformMat4:JRe},Symbol.toStringTag,{value:"Module"}));function Gt(){return[0,0]}function cue(t){return[t[0],t[1]]}function SC(t,e){return[t,e]}function a3e(t){const e=Gt(),i=Math.min(2,t.length);for(let r=0;r<i;++r)e[r]=t[r];return e}function uue(t,e){return new Float64Array(t,e,2)}function due(){return Gt()}function hue(){return SC(1,1)}function pue(){return SC(1,0)}function fue(){return SC(0,1)}const l3e=due(),c3e=hue(),u3e=pue(),d3e=fue();Object.freeze(Object.defineProperty({__proto__:null,ONES:c3e,UNIT_X:u3e,UNIT_Y:d3e,ZEROS:l3e,clone:cue,create:Gt,createView:uue,fromArray:a3e,fromValues:SC,ones:hue,unitX:pue,unitY:fue,zeros:due},Symbol.toStringTag,{value:"Module"}));const mue=96,gue=39.37,h3e=180/Math.PI;function yue(t){return t.wkid?t:t.spatialReference||Ee.WGS84}function UU(t,e){return e.type?cs(t,e.x,e.y):uT(t,e)}function vue(t){return ti(t)}function $w(t,e){const i=Math.max(1,e[0]),r=Math.max(1,e[1]);return Math.max(t.width/i,t.height/r)*w3e(t.spatialReference)}async function qS(t,e,i,r){var a,l;let n,s;if(!t||Array.isArray(t)&&!t.length)return null;if(ye.isCollection(t)&&(t=t.toArray()),Array.isArray(t)&&t.length&&typeof t[0]=="object"){const c=t.every(f=>"attributes"in f),u=t.some(f=>!f.geometry);let h=t;if(c&&u&&e&&e.allLayerViews){const f=new Map;for(const v of t){const b=v.layer,w=f.get(b)||[],x=v.attributes[b.objectIdField];x!=null&&w.push(x),f.set(b,w)}const m=[];f.forEach((v,b)=>{const w=e.allLayerViews.find(x=>x.layer.id===b.id);if(w&&"queryFeatures"in w){const x=b.createQuery();x.objectIds=v,x.returnGeometry=!0,m.push(w.queryFeatures(x))}});const g=await Promise.all(m),y=[];for(const v of g)if(v&&v.features&&v.features.length)for(const b of v.features)b.geometry!=null&&y.push(b.geometry);h=y}for(const f of h)r=await qS(f,e,i,r);return r}if(Array.isArray(t)&&t.length===2&&typeof t[0]=="number"&&typeof t[1]=="number")n=new fe(t);else if(t instanceof Ep)n=t;else if("geometry"in t){if(t.geometry)n=t.geometry;else if(t.layer){const c=t.layer,u=e.allLayerViews.find(h=>h.layer.id===c.id);if(u&&"queryFeatures"in u){const h=c.createQuery();h.objectIds=[t.attributes[c.objectIdField]],h.returnGeometry=!0;const f=await u.queryFeatures(h);n=(l=(a=f==null?void 0:f.features)==null?void 0:a[0])==null?void 0:l.geometry}}}if(n==null||(s=n.type==="point"?new Re({xmin:n.x,ymin:n.y,xmax:n.x,ymax:n.y,spatialReference:n.spatialReference}):n.extent,!s))return null;pc()||lc(s.spatialReference,i)||await Eu();const o=Ir(s,i);return o?r=r?r.union(o):o:null}function p3e(t){if(t&&(!Array.isArray(t)||typeof t[0]!="number")&&(typeof t=="object"||Array.isArray(t)&&typeof t[0]=="object")){if("layer"in t&&t.layer&&t.layer.minScale&&t.layer.maxScale){const e=t.layer;return{min:e.minScale,max:e.maxScale}}if(Array.isArray(t)&&t.length&&t.every(e=>"layer"in e)){let e=0,i=0;for(const r of t){const n=r.layer;n&&n.minScale&&n.maxScale&&(e=n.minScale<e?n.minScale:e,i=n.maxScale>i?n.maxScale:i)}return e&&i?{min:e,max:i}:null}}}function U3(t,e){return Pr(yue(t),e)?t:Ir(t,e)}async function f3e(t,e){if(!t||!e)return new Pd({targetGeometry:new fe,scale:0,rotation:0});let i=e.spatialReference;const{constraints:r,padding:n,viewpoint:s,size:o}=e,a=[n?o[0]-n.left-n.right:o[0],n?o[1]-n.top-n.bottom:o[1]];let l=null;t instanceof Pd?l=t:t.viewpoint?l=t.viewpoint:t.target&&t.target.declaredClass==="esri.Viewpoint"&&(l=t.target);let c=null;l&&l.targetGeometry?c=l.targetGeometry:t instanceof Re?c=t:(t||t&&("center"in t||"extent"in t||"target"in t))&&(c=await qS(t.center,e,i)||await qS(t.extent,e,i)||await qS(t.target,e,i)||await qS(t,e,i)),!c&&s&&s.targetGeometry?c=s.targetGeometry:!c&&e.extent&&(c=e.extent),i||(i=yue(e.spatialReference||e.extent||c)),pc()||Pr(c.spatialReference,i)||lc(c,i)||await Eu();const u=U3(c.center??c,i);let h=0;if(l&&l.targetGeometry!=null&&l.targetGeometry.type==="point")h=l.scale;else if("scale"in t&&t.scale)h=t.scale;else if("zoom"in t&&t.zoom!==-1&&r&&r.effectiveLODs)h=r.zoomToScale(t.zoom);else if(Array.isArray(c)||c.type==="point"||c.type==="extent"&&c.width===0&&c.height===0){const y=U3(e.extent,i);h=y!=null?$w(y,a):e.extent?$w(e.extent,a):s.scale}else h=$w(U3(c.extent,i),a);const f=p3e(t);f&&(f.min&&f.min>h?h=f.min:f.max&&f.max<h&&(h=f.max));let m=0;l?m=l.rotation:t.hasOwnProperty("rotation")?m=t.rotation:s&&(m=s.rotation);let g=new Pd({targetGeometry:u,scale:h,rotation:m});return r&&(g=r.fit(g),r.constrainByGeometry(g),r.rotationEnabled||(g.rotation=m)),g}function Pu(t,e){const i=t.targetGeometry,r=e.targetGeometry;return i.x=r.x,i.y=r.y,i.spatialReference=r.spatialReference,t.scale=e.scale,t.rotation=e.rotation,t}function m3e(t,e,i){return i?cs(t,.5*(e[0]-i.right+i.left),.5*(e[1]-i.bottom+i.top)):K1(t,e,.5)}const g3e=function(){const t=Gt();return function(e,i,r){const n=i.targetGeometry;UU(t,n);const s=.5*X1(i);return e.xmin=t[0]-s*r[0],e.ymin=t[1]-s*r[1],e.xmax=t[0]+s*r[0],e.ymax=t[1]+s*r[1],e.spatialReference=n.spatialReference,e}}();function y3e(t,e,i,r,n){var s;return U4(t,e,i.center),t.scale=$w(i,r),(s=n==null?void 0:n.constraints)==null||s.constrain(t),t}function v3e(t,e,i,r){return qU(t,e,i,r),VU(t,t)}const _ue=function(){const t=Gt();return function(e,i,r){return TL(e,x3e(e,i),m3e(t,i,r))}}(),_3e=function(){const t=Xm(),e=Gt();return function(i,r,n,s){const o=X1(r),a=GU(r);return cs(e,o,o),rue(t,e),xC(t,t,a),d1(t,t,_ue(e,n,s)),d1(t,t,[0,s.top-s.bottom]),cs(i,t[4],t[5])}}();function X1(t){return t.scale*b3e(t.targetGeometry)}function b3e(t){return t!=null&&hs(t.spatialReference)?1/(vue(t.spatialReference)*gue*mue):1}function GU(t){return EB(t.rotation)||0}function w3e(t){return hs(t)?vue(t)*gue*mue:1}function x3e(t,e){return K1(t,e,.5)}const HU=function(){const t=Gt(),e=Gt(),i=Gt();return function(r,n,s,o,a,l){return aue(t,n),K1(e,s,.5*l),cs(i,1/o*l,-1/o*l),zU(r,e),a&&xC(r,r,a),IL(r,r,i),d1(r,r,t),r}}(),qU=function(){const t=Gt();return function(e,i,r,n){const s=X1(i),o=GU(i);return UU(t,i.targetGeometry),HU(e,t,r,s,o,n)}}(),S3e=function(){const t=Gt();return function(e,i,r,n){const s=X1(i);return UU(t,i.targetGeometry),HU(e,t,r,s,0,n)}}();function I3e(t){const e=Do(t);return e?e.valid[1]-e.valid[0]:0}function T3e(t,e){return Math.round(I3e(t)/e)}const C3e=function(){const t=Gt(),e=Gt(),i=[0,0,0];return function(r,n,s){$n(t,r,n),B4(t,t),$n(e,r,s),B4(e,e),lue(i,t,e);let o=Math.acos(Tg(t,e)/(h1(t)*h1(e)))*h3e;return i[2]<0&&(o=-o),isNaN(o)&&(o=0),o}}(),E3e=function(){const t=Gt();return function(e,i,r,n){const s=e.targetGeometry;return Pu(e,i),_3e(t,i,r,n),s.x+=t[0],s.y+=t[1],e}}(),U4=function(t,e,i){Pu(t,e);const r=t.targetGeometry;return r.x=i.x,r.y=i.y,r.spatialReference=i.spatialReference,t},M3e=function(){const t=Gt();return function(e,i,r,n,s){s||(s="center"),TL(t,r,n),K1(t,t,.5);const o=t[0],a=t[1];switch(s){case"center":cs(t,0,0);break;case"left":cs(t,-o,0);break;case"top":cs(t,0,a);break;case"right":cs(t,o,0);break;case"bottom":cs(t,0,-a);break;case"top-left":cs(t,-o,a);break;case"bottom-left":cs(t,-o,-a);break;case"top-right":cs(t,o,a);break;case"bottom-right":cs(t,o,-a)}return CL(e,i,t),e}}();function jvt(t,e,i){return Pu(t,e),t.rotation+=i,t}function $3e(t,e,i){return Pu(t,e),t.rotation=i,t}const A3e=function(){const t=Gt();return function(e,i,r,n,s){return Pu(e,i),isNaN(r)||r===0||(wue(t,n,i,s),e.scale=i.scale*r,xue(t,t,e,s),CL(e,e,cs(t,t[0]-n[0],n[1]-t[1]))),e}}();function iJ(t,e,i){return Pu(t,e),t.scale=i,t}const bue=function(){const t=Gt();return function(e,i,r,n,s,o){return Pu(e,i),isNaN(r)||r===0||(wue(t,s,i,o),e.scale=i.scale*r,e.rotation+=n,xue(t,t,e,o),CL(e,e,cs(t,t[0]-s[0],s[1]-t[1]))),e}}(),Bvt=function(){const t=Gt(),e=Gt();return function(i,r,n,s,o,a,l){return _ue(e,a,l),jU(t,o,e),s?bue(i,r,n,s,t,a):A3e(i,r,n,t,a)}}(),wue=function(){const t=Xm();return function(e,i,r,n){return _d(e,i,v3e(t,r,n,1))}}(),xue=function(){const t=Xm();return function(e,i,r,n){return _d(e,i,qU(t,r,n,1))}}(),CL=function(){const t=Gt(),e=Xm();return function(i,r,n){Pu(i,r);const s=X1(r),o=i.targetGeometry;return iue(e,GU(r)),IL(e,e,SC(s,s)),_d(t,n,e),o.x+=t[0],o.y+=t[1],i}}();let k3e=class{constructor(e,i,r,n){const s=e.targetGeometry,o=i.targetGeometry;n?typeof n=="string"&&(n=SRe(n)||Gl.ease):n=Gl.ease,this.easing=n,this.duration=r,this.sCenterX=s.x,this.sCenterY=s.y,this.sScale=e.scale,this.sRotation=e.rotation,this.tCenterX=o.x,this.tCenterY=o.y,this.tScale=i.scale,this.tRotation=i.rotation,this.dCenterX=this.tCenterX-this.sCenterX,this.dCenterY=this.tCenterY-this.sCenterY,this.dScale=this.tScale-this.sScale,this.dRotation=this.tRotation-this.sRotation,this.dRotation>180?this.dRotation-=360:this.dRotation<-180&&(this.dRotation+=360)}applyRatio(e,i){const r=this.easing(i);let n,s,o,a;i>=1?(n=this.tCenterX,s=this.tCenterY,o=this.tRotation,a=this.tScale):(n=this.sCenterX+r*this.dCenterX,s=this.sCenterY+r*this.dCenterY,o=this.sRotation+r*this.dRotation,a=this.sScale+r*this.dScale),e.targetGeometry.x=n,e.targetGeometry.y=s,e.scale=a,e.rotation=o}},yh=class extends he{constructor(e){super(e),this.updateFunction=null,this.animation=null,this.duration=200,this.transition=null,this.easing=Gl.ease,this.view=null,this.viewpoint=new Pd({targetGeometry:new fe,scale:0,rotation:0}),this._updateTask=Jw({postRender:this._postRender.bind(this)}),this._updateTask.pause()}destroy(){this._updateTask=$i(this._updateTask)}animate(e,i,r){this.stop();const n=this.viewpoint;Pu(n,i),this.transition=new k3e(this.viewpoint,e.target,r&&r.duration||this.duration,r&&r.easing||this.easing);const s=()=>{var o,a;this.animation===e&&this._updateTask&&(e.state==="finished"&&((o=this.transition)==null||o.applyRatio(this.viewpoint,1),(a=this.view)!=null&&a.state&&(this.view.state.viewpoint=this.viewpoint.clone())),this.animation=null,this.updateFunction=null)};return e.when(s,s),this._startTime=performance.now(),this._updateTask.resume(),this.animation=e,e}animateContinous(e,i){this.stop(),this.updateFunction=i,this.viewpoint=e;const r=new j4({target:e.clone()}),n=()=>{this.animation===r&&this._updateTask&&(this.animation=null,this.updateFunction=null)};return r.when(n,n),this._startTime=performance.now(),this._updateTask.resume(),this.animation=r,r}stop(){this.animation&&(this.animation.stop(),this.animation=null,this.updateFunction=null)}_postRender(e){var r,n;const i=this.animation;if(i&&i.state!==j4.State.STOPPED){if(this.updateFunction)this.updateFunction(this.viewpoint,e.deltaTime);else{const s=this.transition,o=(performance.now()-this._startTime)/s.duration,a=o>=1;s.applyRatio(this.viewpoint,o),a&&((r=this.animation)==null||r.finish())}(n=this.view)!=null&&n.state&&(this.view.state.viewpoint=this.viewpoint.clone())}else this._updateTask.pause()}};d([p()],yh.prototype,"animation",void 0),d([p()],yh.prototype,"duration",void 0),d([p()],yh.prototype,"transition",void 0),d([p()],yh.prototype,"easing",void 0),d([p()],yh.prototype,"view",void 0),d([p()],yh.prototype,"viewpoint",void 0),yh=d([A("esri.views.2d.AnimationManager")],yh);const P3e=yh;let O3e=class{constructor(e){this.view=e,this._stationaryHandle=null,this._frameTaskHandle=null,this._updateParameters=null,this._updateRequested=!1,this.stationary=!0,this.animationInProgress=!1,this.prepare=()=>{this._updateParameters&&(this._updateParameters.state=this.view.state,this._updateParameters.stationary=this.view.stationary,this._updateParameters.pixelRatio=window.devicePixelRatio,this._updateParameters.renderingOptions=this.view.renderingOptions)},this.update=()=>{var o,a;if(this._updateRequested=!1,(o=this.view)==null?void 0:o.destroyed)return;const{allLayerViews:i,graphicsView:r,labelManager:n,state:{id:s}}=this.view;i.forEach(this._updateLayerView,this),n!=null&&(n.lastUpdateId!==s&&(n.viewChange(),n.lastUpdateId=s),n.updateRequested&&n.processUpdate(this._updateParameters)),r!=null&&(r.lastUpdateId!==s&&(r.viewChange(),r.lastUpdateId=s),r.updateRequested&&r.processUpdate(this._updateParameters)),this.view.graphicsTileStore.setViewState(this._updateParameters.state),this.animationInProgress||this._updateRequested||((a=this._frameTaskHandle)==null||a.pause())}}destroy(){this.stop()}start(){if(this._frameTaskHandle)return;const e=this.view;this.stationary=e.stationary,this._updateParameters={state:e.state,pixelRatio:window.devicePixelRatio,stationary:this.stationary,renderingOptions:e.renderingOptions},this._stationaryHandle=J(()=>e.stationary,i=>{this.stationary=i,this.requestFrame()}),this._frameTaskHandle=Jw(this),this.requestUpdate()}stop(){var e;this._frameTaskHandle&&(this._updateRequested=!1,(e=this._stationaryHandle)==null||e.remove(),this._frameTaskHandle.remove(),this._updateParameters=this._stationaryHandle=this._frameTaskHandle=null,this.stationary=!0,this.animationInProgress=!1)}requestUpdate(){this._updateRequested||(this._updateRequested=!0,this.requestFrame())}requestFrame(){this._frameTaskHandle&&this._frameTaskHandle.resume()}_updateLayerView(e){var n;if(!e.attached)return void this.requestUpdate();const i=this.view.state,r=e.lastUpdateId;r!=null&&(this.stationary||e.moving)||(e.moving=!0,e.moveStart()),r!==i.id&&e.viewChange(),this.stationary&&e.moving&&(e.moving=!1,e.moveEnd()),e.lastUpdateId=i.id,e.updateRequested&&e.processUpdate(this._updateParameters),"layerViews"in e&&((n=e.layerViews)==null||n.forEach(this._updateLayerView,this))}};function $r(){return Promise.all([W(()=>import("./webglDeps-b65b97bf.js"),["./webglDeps-b65b97bf.js","./VertexArrayObject-08f516fe.js","./Texture-eb8cd14a.js","./enums-b14466b3.js","./ProgramTemplate-292cf23e.js","./programUtils-ed4b136e.js","./NestedMap-1b5db22e.js"],import.meta.url),W(()=>import("./mapViewDeps-af9d80a9.js"),["./mapViewDeps-af9d80a9.js","./CIMResourceManager-b8fa14d9.js","./fontUtils-d28127a5.js","./Rasterizer-453ee95d.js","./cimAnalyzer-97b03e25.js","./BidiEngine-9a40f2f4.js","./OptimizedGeometry-196224d4.js","./GeometryUtils-984e8446.js","./enums-f1a6a48a.js","./alignmentUtils-ae955d28.js","./definitions-8f6c0024.js","./number-e491b09e.js","./Rect-ea14f53a.js","./callExpressionWithFeature-06ba3d44.js","./quantizationUtils-533107d2.js","./floatRGBA-de0614b2.js","./rasterizingUtils-8fc9ca0c.js","./imageutils-260173a2.js","./Container-de185a32.js","./enums-b14466b3.js","./Texture-eb8cd14a.js","./BufferPool-85f6109f.js","./AttributeStoreView-a3f655f7.js","./TiledDisplayObject-d497910d.js","./color-e244539a.js","./VertexElementDescriptor-2925c6af.js","./WGLContainer-037578f3.js","./VertexArrayObject-08f516fe.js","./vec4f32-0d1b2306.js","./ProgramTemplate-292cf23e.js","./GeometryUtils-f86d11a2.js","./StyleDefinition-29c49b98.js","./config-1337d16e.js","./earcut-6b48af20.js","./featureConversionUtils-bafaa402.js","./OptimizedFeature-4701473b.js","./OptimizedFeatureSet-1d1ac4b9.js","./visualVariablesUtils-d4aac532.js","./ExpandedCIM-2df9bc7d.js","./util-ac05cbea.js","./enums-fb086c25.js","./programUtils-ed4b136e.js","./NestedMap-1b5db22e.js","./MagnifierPrograms-ce3afbc8.js","./pbf-beba61b9.js","./Matcher-dfb79dbc.js","./tileUtils-c2f19f52.js","./TurboLine-2e088fec.js","./CircularArray-ef508845.js","./testSVGPremultipliedAlpha-8b254d7f.js","./ComputedAttributeStorage-d8e6e2e6.js","./arcadeTimeUtils-3a12e3ee.js","./centroid-8e8cfa47.js","./RenderingContext-15eee32d.js","./OrderIndependentTransparency-b8ef1857.js","./basicInterfaces-bb952591.js","./doublePrecisionUtils-e3c3d0d8.js","./imageUtils-c2d0d1ae.js","./GraphicsView2D-4e889ec5.js","./normalizeUtilsSync-fc897fcb.js","./projectionSupport-66f9e6bd.js","./json-48e3ea08.js","./GraphicContainer-47ea8398.js","./BaseGraphicContainer-34505465.js","./FeatureContainer-afbe339d.js","./TileContainer-0946d38f.js","./requestImageUtils-89ae2d39.js"],import.meta.url)])}const kx=()=>$r().then(()=>W(()=>import("./TileLayerView2D-9e7a4fc3.js"),["./TileLayerView2D-9e7a4fc3.js","./Rasterizer-453ee95d.js","./cimAnalyzer-97b03e25.js","./fontUtils-d28127a5.js","./BidiEngine-9a40f2f4.js","./OptimizedGeometry-196224d4.js","./GeometryUtils-984e8446.js","./enums-f1a6a48a.js","./alignmentUtils-ae955d28.js","./definitions-8f6c0024.js","./number-e491b09e.js","./Rect-ea14f53a.js","./callExpressionWithFeature-06ba3d44.js","./quantizationUtils-533107d2.js","./floatRGBA-de0614b2.js","./rasterizingUtils-8fc9ca0c.js","./Container-de185a32.js","./enums-b14466b3.js","./Texture-eb8cd14a.js","./BufferPool-85f6109f.js","./AttributeStoreView-a3f655f7.js","./TiledDisplayObject-d497910d.js","./color-e244539a.js","./VertexElementDescriptor-2925c6af.js","./WGLContainer-037578f3.js","./VertexArrayObject-08f516fe.js","./vec4f32-0d1b2306.js","./ProgramTemplate-292cf23e.js","./GeometryUtils-f86d11a2.js","./StyleDefinition-29c49b98.js","./config-1337d16e.js","./earcut-6b48af20.js","./featureConversionUtils-bafaa402.js","./OptimizedFeature-4701473b.js","./OptimizedFeatureSet-1d1ac4b9.js","./visualVariablesUtils-d4aac532.js","./ExpandedCIM-2df9bc7d.js","./util-ac05cbea.js","./enums-fb086c25.js","./MagnifierPrograms-ce3afbc8.js","./pbf-beba61b9.js","./imageutils-260173a2.js","./Matcher-dfb79dbc.js","./tileUtils-c2f19f52.js","./TurboLine-2e088fec.js","./CircularArray-ef508845.js","./testSVGPremultipliedAlpha-8b254d7f.js","./ComputedAttributeStorage-d8e6e2e6.js","./arcadeTimeUtils-3a12e3ee.js","./centroid-8e8cfa47.js","./OrderIndependentTransparency-b8ef1857.js","./basicInterfaces-bb952591.js","./GraphicsView2D-4e889ec5.js","./normalizeUtilsSync-fc897fcb.js","./projectionSupport-66f9e6bd.js","./json-48e3ea08.js","./imageUtils-e631479c.js","./BitmapTileContainer-eadd1b87.js","./Bitmap-fcefeaec.js","./TileContainer-0946d38f.js","./LayerView2D-de2fd686.js","./HighlightGraphicContainer-13de1e97.js","./BaseGraphicContainer-34505465.js","./FeatureContainer-afbe339d.js","./LayerView-6c752c5d.js","./RefreshableLayerView-0da84bd0.js","./MapServiceLayerViewHelper-7607407d.js","./popupUtils-ef750880.js"],import.meta.url)),h_=()=>$r().then(()=>W(()=>import("./FeatureLayerView2D-7a9bf807.js"),["./FeatureLayerView2D-7a9bf807.js","./definitions-8f6c0024.js","./LayerView2D-de2fd686.js","./Container-de185a32.js","./enums-b14466b3.js","./Texture-eb8cd14a.js","./AttributeStoreView-a3f655f7.js","./TiledDisplayObject-d497910d.js","./color-e244539a.js","./enums-f1a6a48a.js","./VertexElementDescriptor-2925c6af.js","./number-e491b09e.js","./WGLContainer-037578f3.js","./VertexArrayObject-08f516fe.js","./vec4f32-0d1b2306.js","./ProgramTemplate-292cf23e.js","./GeometryUtils-f86d11a2.js","./alignmentUtils-ae955d28.js","./StyleDefinition-29c49b98.js","./config-1337d16e.js","./earcut-6b48af20.js","./featureConversionUtils-bafaa402.js","./OptimizedFeature-4701473b.js","./OptimizedFeatureSet-1d1ac4b9.js","./OptimizedGeometry-196224d4.js","./visualVariablesUtils-d4aac532.js","./cimAnalyzer-97b03e25.js","./fontUtils-d28127a5.js","./BidiEngine-9a40f2f4.js","./GeometryUtils-984e8446.js","./Rect-ea14f53a.js","./callExpressionWithFeature-06ba3d44.js","./quantizationUtils-533107d2.js","./floatRGBA-de0614b2.js","./ExpandedCIM-2df9bc7d.js","./util-ac05cbea.js","./BitmapTileContainer-eadd1b87.js","./Bitmap-fcefeaec.js","./TileContainer-0946d38f.js","./CircularArray-ef508845.js","./BufferPool-85f6109f.js","./FeatureContainer-afbe339d.js","./popupUtils-ef750880.js","./LayerView-6c752c5d.js","./RefreshableLayerView-0da84bd0.js"],import.meta.url)),rJ={"base-dynamic":()=>$r().then(()=>W(()=>import("./BaseDynamicLayerView2D-89db996b.js"),["./BaseDynamicLayerView2D-89db996b.js","./BitmapContainer-2102bac1.js","./WGLContainer-037578f3.js","./definitions-8f6c0024.js","./VertexArrayObject-08f516fe.js","./Texture-eb8cd14a.js","./enums-b14466b3.js","./VertexElementDescriptor-2925c6af.js","./vec4f32-0d1b2306.js","./color-e244539a.js","./enums-f1a6a48a.js","./number-e491b09e.js","./ProgramTemplate-292cf23e.js","./GeometryUtils-f86d11a2.js","./alignmentUtils-ae955d28.js","./StyleDefinition-29c49b98.js","./config-1337d16e.js","./Container-de185a32.js","./earcut-6b48af20.js","./featureConversionUtils-bafaa402.js","./OptimizedFeature-4701473b.js","./OptimizedFeatureSet-1d1ac4b9.js","./OptimizedGeometry-196224d4.js","./LayerView2D-de2fd686.js","./ExportStrategy-ea2cdb45.js","./Bitmap-fcefeaec.js","./LayerView-6c752c5d.js","./RefreshableLayerView-0da84bd0.js"],import.meta.url)),"base-tile":kx,"bing-maps":kx,csv:h_,"geo-rss":()=>$r().then(()=>W(()=>import("./GeoRSSLayerView2D-0df987ea.js"),["./GeoRSSLayerView2D-0df987ea.js","./LayerView2D-de2fd686.js","./Container-de185a32.js","./definitions-8f6c0024.js","./enums-b14466b3.js","./Texture-eb8cd14a.js","./GraphicContainer-47ea8398.js","./color-e244539a.js","./enums-f1a6a48a.js","./VertexElementDescriptor-2925c6af.js","./number-e491b09e.js","./BaseGraphicContainer-34505465.js","./FeatureContainer-afbe339d.js","./AttributeStoreView-a3f655f7.js","./TiledDisplayObject-d497910d.js","./WGLContainer-037578f3.js","./VertexArrayObject-08f516fe.js","./vec4f32-0d1b2306.js","./ProgramTemplate-292cf23e.js","./GeometryUtils-f86d11a2.js","./alignmentUtils-ae955d28.js","./StyleDefinition-29c49b98.js","./config-1337d16e.js","./earcut-6b48af20.js","./featureConversionUtils-bafaa402.js","./OptimizedFeature-4701473b.js","./OptimizedFeatureSet-1d1ac4b9.js","./OptimizedGeometry-196224d4.js","./visualVariablesUtils-d4aac532.js","./cimAnalyzer-97b03e25.js","./fontUtils-d28127a5.js","./BidiEngine-9a40f2f4.js","./GeometryUtils-984e8446.js","./Rect-ea14f53a.js","./callExpressionWithFeature-06ba3d44.js","./quantizationUtils-533107d2.js","./floatRGBA-de0614b2.js","./ExpandedCIM-2df9bc7d.js","./util-ac05cbea.js","./TileContainer-0946d38f.js","./GraphicsView2D-4e889ec5.js","./normalizeUtilsSync-fc897fcb.js","./projectionSupport-66f9e6bd.js","./json-48e3ea08.js","./Matcher-dfb79dbc.js","./tileUtils-c2f19f52.js","./TurboLine-2e088fec.js","./ComputedAttributeStorage-d8e6e2e6.js","./arcadeTimeUtils-3a12e3ee.js","./centroid-8e8cfa47.js","./LayerView-6c752c5d.js"],import.meta.url)),feature:h_,geojson:h_,graphics:()=>$r().then(()=>W(()=>import("./GraphicsLayerView2D-e06b714d.js"),["./GraphicsLayerView2D-e06b714d.js","./LayerView2D-de2fd686.js","./Container-de185a32.js","./definitions-8f6c0024.js","./enums-b14466b3.js","./Texture-eb8cd14a.js","./GraphicContainer-47ea8398.js","./color-e244539a.js","./enums-f1a6a48a.js","./VertexElementDescriptor-2925c6af.js","./number-e491b09e.js","./BaseGraphicContainer-34505465.js","./FeatureContainer-afbe339d.js","./AttributeStoreView-a3f655f7.js","./TiledDisplayObject-d497910d.js","./WGLContainer-037578f3.js","./VertexArrayObject-08f516fe.js","./vec4f32-0d1b2306.js","./ProgramTemplate-292cf23e.js","./GeometryUtils-f86d11a2.js","./alignmentUtils-ae955d28.js","./StyleDefinition-29c49b98.js","./config-1337d16e.js","./earcut-6b48af20.js","./featureConversionUtils-bafaa402.js","./OptimizedFeature-4701473b.js","./OptimizedFeatureSet-1d1ac4b9.js","./OptimizedGeometry-196224d4.js","./visualVariablesUtils-d4aac532.js","./cimAnalyzer-97b03e25.js","./fontUtils-d28127a5.js","./BidiEngine-9a40f2f4.js","./GeometryUtils-984e8446.js","./Rect-ea14f53a.js","./callExpressionWithFeature-06ba3d44.js","./quantizationUtils-533107d2.js","./floatRGBA-de0614b2.js","./ExpandedCIM-2df9bc7d.js","./util-ac05cbea.js","./TileContainer-0946d38f.js","./GraphicsView2D-4e889ec5.js","./normalizeUtilsSync-fc897fcb.js","./projectionSupport-66f9e6bd.js","./json-48e3ea08.js","./Matcher-dfb79dbc.js","./tileUtils-c2f19f52.js","./TurboLine-2e088fec.js","./ComputedAttributeStorage-d8e6e2e6.js","./arcadeTimeUtils-3a12e3ee.js","./centroid-8e8cfa47.js","./LayerView-6c752c5d.js"],import.meta.url)),group:()=>$r().then(()=>W(()=>import("./GroupLayerView2D-6b9a095f.js"),["./GroupLayerView2D-6b9a095f.js","./GroupContainer-cbdecfb0.js","./WGLContainer-037578f3.js","./definitions-8f6c0024.js","./VertexArrayObject-08f516fe.js","./Texture-eb8cd14a.js","./enums-b14466b3.js","./VertexElementDescriptor-2925c6af.js","./vec4f32-0d1b2306.js","./color-e244539a.js","./enums-f1a6a48a.js","./number-e491b09e.js","./ProgramTemplate-292cf23e.js","./GeometryUtils-f86d11a2.js","./alignmentUtils-ae955d28.js","./StyleDefinition-29c49b98.js","./config-1337d16e.js","./Container-de185a32.js","./earcut-6b48af20.js","./featureConversionUtils-bafaa402.js","./OptimizedFeature-4701473b.js","./OptimizedFeatureSet-1d1ac4b9.js","./OptimizedGeometry-196224d4.js","./LayerView2D-de2fd686.js","./LayerView-6c752c5d.js"],import.meta.url)),imagery:()=>$r().then(()=>W(()=>import("./ImageryLayerView2D-170a1dd4.js"),["./ImageryLayerView2D-170a1dd4.js","./RasterVFDisplayObject-d6882b92.js","./VertexArrayObject-08f516fe.js","./Texture-eb8cd14a.js","./enums-b14466b3.js","./VertexElementDescriptor-2925c6af.js","./WGLContainer-037578f3.js","./definitions-8f6c0024.js","./vec4f32-0d1b2306.js","./color-e244539a.js","./enums-f1a6a48a.js","./number-e491b09e.js","./ProgramTemplate-292cf23e.js","./GeometryUtils-f86d11a2.js","./alignmentUtils-ae955d28.js","./StyleDefinition-29c49b98.js","./config-1337d16e.js","./Container-de185a32.js","./earcut-6b48af20.js","./featureConversionUtils-bafaa402.js","./OptimizedFeature-4701473b.js","./OptimizedFeatureSet-1d1ac4b9.js","./OptimizedGeometry-196224d4.js","./LayerView2D-de2fd686.js","./GraphicsView2D-4e889ec5.js","./cimAnalyzer-97b03e25.js","./fontUtils-d28127a5.js","./BidiEngine-9a40f2f4.js","./GeometryUtils-984e8446.js","./Rect-ea14f53a.js","./callExpressionWithFeature-06ba3d44.js","./quantizationUtils-533107d2.js","./floatRGBA-de0614b2.js","./normalizeUtilsSync-fc897fcb.js","./projectionSupport-66f9e6bd.js","./json-48e3ea08.js","./AttributeStoreView-a3f655f7.js","./TiledDisplayObject-d497910d.js","./visualVariablesUtils-d4aac532.js","./ExpandedCIM-2df9bc7d.js","./util-ac05cbea.js","./Matcher-dfb79dbc.js","./tileUtils-c2f19f52.js","./TurboLine-2e088fec.js","./ComputedAttributeStorage-d8e6e2e6.js","./arcadeTimeUtils-3a12e3ee.js","./centroid-8e8cfa47.js","./HighlightGraphicContainer-13de1e97.js","./BaseGraphicContainer-34505465.js","./FeatureContainer-afbe339d.js","./TileContainer-0946d38f.js","./BitmapContainer-2102bac1.js","./Bitmap-fcefeaec.js","./ExportStrategy-ea2cdb45.js","./popupUtils-ef750880.js","./LayerView-6c752c5d.js","./RefreshableLayerView-0da84bd0.js"],import.meta.url)),"imagery-tile":()=>$r().then(()=>W(()=>import("./ImageryTileLayerView2D-bb6d1cc7.js"),["./ImageryTileLayerView2D-bb6d1cc7.js","./RasterVFDisplayObject-d6882b92.js","./VertexArrayObject-08f516fe.js","./Texture-eb8cd14a.js","./enums-b14466b3.js","./VertexElementDescriptor-2925c6af.js","./WGLContainer-037578f3.js","./definitions-8f6c0024.js","./vec4f32-0d1b2306.js","./color-e244539a.js","./enums-f1a6a48a.js","./number-e491b09e.js","./ProgramTemplate-292cf23e.js","./GeometryUtils-f86d11a2.js","./alignmentUtils-ae955d28.js","./StyleDefinition-29c49b98.js","./config-1337d16e.js","./Container-de185a32.js","./earcut-6b48af20.js","./featureConversionUtils-bafaa402.js","./OptimizedFeature-4701473b.js","./OptimizedFeatureSet-1d1ac4b9.js","./OptimizedGeometry-196224d4.js","./LayerView2D-de2fd686.js","./rasterUtils-470d12dc.js","./TiledDisplayObject-d497910d.js","./TileContainer-0946d38f.js","./util-ac05cbea.js","./popupUtils-ef750880.js","./LayerView-6c752c5d.js","./RefreshableLayerView-0da84bd0.js"],import.meta.url)),kml:()=>$r().then(()=>W(()=>import("./KMLLayerView2D-758b9571.js"),["./KMLLayerView2D-758b9571.js","./kmlUtils-6e562808.js","./Bitmap-fcefeaec.js","./Container-de185a32.js","./definitions-8f6c0024.js","./enums-b14466b3.js","./Texture-eb8cd14a.js","./BitmapContainer-2102bac1.js","./WGLContainer-037578f3.js","./VertexArrayObject-08f516fe.js","./VertexElementDescriptor-2925c6af.js","./vec4f32-0d1b2306.js","./color-e244539a.js","./enums-f1a6a48a.js","./number-e491b09e.js","./ProgramTemplate-292cf23e.js","./GeometryUtils-f86d11a2.js","./alignmentUtils-ae955d28.js","./StyleDefinition-29c49b98.js","./config-1337d16e.js","./earcut-6b48af20.js","./featureConversionUtils-bafaa402.js","./OptimizedFeature-4701473b.js","./OptimizedFeatureSet-1d1ac4b9.js","./OptimizedGeometry-196224d4.js","./LayerView2D-de2fd686.js","./GraphicContainer-47ea8398.js","./BaseGraphicContainer-34505465.js","./FeatureContainer-afbe339d.js","./AttributeStoreView-a3f655f7.js","./TiledDisplayObject-d497910d.js","./visualVariablesUtils-d4aac532.js","./cimAnalyzer-97b03e25.js","./fontUtils-d28127a5.js","./BidiEngine-9a40f2f4.js","./GeometryUtils-984e8446.js","./Rect-ea14f53a.js","./callExpressionWithFeature-06ba3d44.js","./quantizationUtils-533107d2.js","./floatRGBA-de0614b2.js","./ExpandedCIM-2df9bc7d.js","./util-ac05cbea.js","./TileContainer-0946d38f.js","./GraphicsView2D-4e889ec5.js","./normalizeUtilsSync-fc897fcb.js","./projectionSupport-66f9e6bd.js","./json-48e3ea08.js","./Matcher-dfb79dbc.js","./tileUtils-c2f19f52.js","./TurboLine-2e088fec.js","./ComputedAttributeStorage-d8e6e2e6.js","./arcadeTimeUtils-3a12e3ee.js","./centroid-8e8cfa47.js","./LayerView-6c752c5d.js","./RenderingContext-15eee32d.js","./programUtils-ed4b136e.js","./NestedMap-1b5db22e.js","./OrderIndependentTransparency-b8ef1857.js","./basicInterfaces-bb952591.js","./testSVGPremultipliedAlpha-8b254d7f.js","./doublePrecisionUtils-e3c3d0d8.js","./rasterUtils-470d12dc.js"],import.meta.url)),"knowledge-graph":()=>$r().then(()=>W(()=>import("./KnowledgeGraphLayerView2D-6ac1f359.js"),["./KnowledgeGraphLayerView2D-6ac1f359.js","./LayerView2D-de2fd686.js","./Container-de185a32.js","./definitions-8f6c0024.js","./enums-b14466b3.js","./Texture-eb8cd14a.js","./LayerView-6c752c5d.js"],import.meta.url)),"link-chart":()=>$r().then(()=>W(()=>import("./KnowledgeGraphLayerView2D-6ac1f359.js"),["./KnowledgeGraphLayerView2D-6ac1f359.js","./LayerView2D-de2fd686.js","./Container-de185a32.js","./definitions-8f6c0024.js","./enums-b14466b3.js","./Texture-eb8cd14a.js","./LayerView-6c752c5d.js"],import.meta.url)),"knowledge-graph-sublayer":h_,"map-image":()=>$r().then(()=>W(()=>import("./MapImageLayerView2D-2dc4f2e8.js"),["./MapImageLayerView2D-2dc4f2e8.js","./BitmapContainer-2102bac1.js","./WGLContainer-037578f3.js","./definitions-8f6c0024.js","./VertexArrayObject-08f516fe.js","./Texture-eb8cd14a.js","./enums-b14466b3.js","./VertexElementDescriptor-2925c6af.js","./vec4f32-0d1b2306.js","./color-e244539a.js","./enums-f1a6a48a.js","./number-e491b09e.js","./ProgramTemplate-292cf23e.js","./GeometryUtils-f86d11a2.js","./alignmentUtils-ae955d28.js","./StyleDefinition-29c49b98.js","./config-1337d16e.js","./Container-de185a32.js","./earcut-6b48af20.js","./featureConversionUtils-bafaa402.js","./OptimizedFeature-4701473b.js","./OptimizedFeatureSet-1d1ac4b9.js","./OptimizedGeometry-196224d4.js","./LayerView2D-de2fd686.js","./GraphicsView2D-4e889ec5.js","./cimAnalyzer-97b03e25.js","./fontUtils-d28127a5.js","./BidiEngine-9a40f2f4.js","./GeometryUtils-984e8446.js","./Rect-ea14f53a.js","./callExpressionWithFeature-06ba3d44.js","./quantizationUtils-533107d2.js","./floatRGBA-de0614b2.js","./normalizeUtilsSync-fc897fcb.js","./projectionSupport-66f9e6bd.js","./json-48e3ea08.js","./AttributeStoreView-a3f655f7.js","./TiledDisplayObject-d497910d.js","./visualVariablesUtils-d4aac532.js","./ExpandedCIM-2df9bc7d.js","./util-ac05cbea.js","./Matcher-dfb79dbc.js","./tileUtils-c2f19f52.js","./TurboLine-2e088fec.js","./ComputedAttributeStorage-d8e6e2e6.js","./arcadeTimeUtils-3a12e3ee.js","./centroid-8e8cfa47.js","./HighlightGraphicContainer-13de1e97.js","./BaseGraphicContainer-34505465.js","./FeatureContainer-afbe339d.js","./TileContainer-0946d38f.js","./ExportStrategy-ea2cdb45.js","./Bitmap-fcefeaec.js","./LayerView-6c752c5d.js","./RefreshableLayerView-0da84bd0.js","./MapServiceLayerViewHelper-7607407d.js","./popupUtils-ef750880.js"],import.meta.url)),"map-notes":()=>$r().then(()=>W(()=>import("./MapNotesLayerView2D-a0afc13d.js"),["./MapNotesLayerView2D-a0afc13d.js","./Container-de185a32.js","./definitions-8f6c0024.js","./enums-b14466b3.js","./Texture-eb8cd14a.js","./GroupContainer-cbdecfb0.js","./WGLContainer-037578f3.js","./VertexArrayObject-08f516fe.js","./VertexElementDescriptor-2925c6af.js","./vec4f32-0d1b2306.js","./color-e244539a.js","./enums-f1a6a48a.js","./number-e491b09e.js","./ProgramTemplate-292cf23e.js","./GeometryUtils-f86d11a2.js","./alignmentUtils-ae955d28.js","./StyleDefinition-29c49b98.js","./config-1337d16e.js","./earcut-6b48af20.js","./featureConversionUtils-bafaa402.js","./OptimizedFeature-4701473b.js","./OptimizedFeatureSet-1d1ac4b9.js","./OptimizedGeometry-196224d4.js","./LayerView2D-de2fd686.js","./GraphicContainer-47ea8398.js","./BaseGraphicContainer-34505465.js","./FeatureContainer-afbe339d.js","./AttributeStoreView-a3f655f7.js","./TiledDisplayObject-d497910d.js","./visualVariablesUtils-d4aac532.js","./cimAnalyzer-97b03e25.js","./fontUtils-d28127a5.js","./BidiEngine-9a40f2f4.js","./GeometryUtils-984e8446.js","./Rect-ea14f53a.js","./callExpressionWithFeature-06ba3d44.js","./quantizationUtils-533107d2.js","./floatRGBA-de0614b2.js","./ExpandedCIM-2df9bc7d.js","./util-ac05cbea.js","./TileContainer-0946d38f.js","./GraphicsView2D-4e889ec5.js","./normalizeUtilsSync-fc897fcb.js","./projectionSupport-66f9e6bd.js","./json-48e3ea08.js","./Matcher-dfb79dbc.js","./tileUtils-c2f19f52.js","./TurboLine-2e088fec.js","./ComputedAttributeStorage-d8e6e2e6.js","./arcadeTimeUtils-3a12e3ee.js","./centroid-8e8cfa47.js","./LayerView-6c752c5d.js"],import.meta.url)),media:()=>$r().then(()=>W(()=>import("./MediaLayerView2D-c61f8f10.js"),["./MediaLayerView2D-c61f8f10.js","./perspectiveUtils-2b308953.js","./normalizeUtilsSync-fc897fcb.js","./Rasterizer-453ee95d.js","./cimAnalyzer-97b03e25.js","./fontUtils-d28127a5.js","./BidiEngine-9a40f2f4.js","./OptimizedGeometry-196224d4.js","./GeometryUtils-984e8446.js","./enums-f1a6a48a.js","./alignmentUtils-ae955d28.js","./definitions-8f6c0024.js","./number-e491b09e.js","./Rect-ea14f53a.js","./callExpressionWithFeature-06ba3d44.js","./quantizationUtils-533107d2.js","./floatRGBA-de0614b2.js","./rasterizingUtils-8fc9ca0c.js","./Container-de185a32.js","./enums-b14466b3.js","./Texture-eb8cd14a.js","./BufferPool-85f6109f.js","./AttributeStoreView-a3f655f7.js","./TiledDisplayObject-d497910d.js","./color-e244539a.js","./VertexElementDescriptor-2925c6af.js","./WGLContainer-037578f3.js","./VertexArrayObject-08f516fe.js","./vec4f32-0d1b2306.js","./ProgramTemplate-292cf23e.js","./GeometryUtils-f86d11a2.js","./StyleDefinition-29c49b98.js","./config-1337d16e.js","./earcut-6b48af20.js","./featureConversionUtils-bafaa402.js","./OptimizedFeature-4701473b.js","./OptimizedFeatureSet-1d1ac4b9.js","./visualVariablesUtils-d4aac532.js","./ExpandedCIM-2df9bc7d.js","./util-ac05cbea.js","./enums-fb086c25.js","./MagnifierPrograms-ce3afbc8.js","./pbf-beba61b9.js","./imageutils-260173a2.js","./Matcher-dfb79dbc.js","./tileUtils-c2f19f52.js","./TurboLine-2e088fec.js","./CircularArray-ef508845.js","./testSVGPremultipliedAlpha-8b254d7f.js","./ComputedAttributeStorage-d8e6e2e6.js","./arcadeTimeUtils-3a12e3ee.js","./centroid-8e8cfa47.js","./OrderIndependentTransparency-b8ef1857.js","./basicInterfaces-bb952591.js","./GraphicsView2D-4e889ec5.js","./projectionSupport-66f9e6bd.js","./json-48e3ea08.js","./LayerView2D-de2fd686.js","./LayerView-6c752c5d.js"],import.meta.url)),"ogc-feature":()=>$r().then(()=>W(()=>import("./OGCFeatureLayerView2D-9967eebc.js"),["./OGCFeatureLayerView2D-9967eebc.js","./FeatureLayerView2D-7a9bf807.js","./definitions-8f6c0024.js","./LayerView2D-de2fd686.js","./Container-de185a32.js","./enums-b14466b3.js","./Texture-eb8cd14a.js","./AttributeStoreView-a3f655f7.js","./TiledDisplayObject-d497910d.js","./color-e244539a.js","./enums-f1a6a48a.js","./VertexElementDescriptor-2925c6af.js","./number-e491b09e.js","./WGLContainer-037578f3.js","./VertexArrayObject-08f516fe.js","./vec4f32-0d1b2306.js","./ProgramTemplate-292cf23e.js","./GeometryUtils-f86d11a2.js","./alignmentUtils-ae955d28.js","./StyleDefinition-29c49b98.js","./config-1337d16e.js","./earcut-6b48af20.js","./featureConversionUtils-bafaa402.js","./OptimizedFeature-4701473b.js","./OptimizedFeatureSet-1d1ac4b9.js","./OptimizedGeometry-196224d4.js","./visualVariablesUtils-d4aac532.js","./cimAnalyzer-97b03e25.js","./fontUtils-d28127a5.js","./BidiEngine-9a40f2f4.js","./GeometryUtils-984e8446.js","./Rect-ea14f53a.js","./callExpressionWithFeature-06ba3d44.js","./quantizationUtils-533107d2.js","./floatRGBA-de0614b2.js","./ExpandedCIM-2df9bc7d.js","./util-ac05cbea.js","./BitmapTileContainer-eadd1b87.js","./Bitmap-fcefeaec.js","./TileContainer-0946d38f.js","./CircularArray-ef508845.js","./BufferPool-85f6109f.js","./FeatureContainer-afbe339d.js","./popupUtils-ef750880.js","./LayerView-6c752c5d.js","./RefreshableLayerView-0da84bd0.js"],import.meta.url)),"open-street-map":kx,"oriented-imagery":h_,route:()=>$r().then(()=>W(()=>import("./RouteLayerView2D-99a13f48.js"),["./RouteLayerView2D-99a13f48.js","./Stop-b27cea7e.js","./LayerView2D-de2fd686.js","./Container-de185a32.js","./definitions-8f6c0024.js","./enums-b14466b3.js","./Texture-eb8cd14a.js","./GraphicContainer-47ea8398.js","./color-e244539a.js","./enums-f1a6a48a.js","./VertexElementDescriptor-2925c6af.js","./number-e491b09e.js","./BaseGraphicContainer-34505465.js","./FeatureContainer-afbe339d.js","./AttributeStoreView-a3f655f7.js","./TiledDisplayObject-d497910d.js","./WGLContainer-037578f3.js","./VertexArrayObject-08f516fe.js","./vec4f32-0d1b2306.js","./ProgramTemplate-292cf23e.js","./GeometryUtils-f86d11a2.js","./alignmentUtils-ae955d28.js","./StyleDefinition-29c49b98.js","./config-1337d16e.js","./earcut-6b48af20.js","./featureConversionUtils-bafaa402.js","./OptimizedFeature-4701473b.js","./OptimizedFeatureSet-1d1ac4b9.js","./OptimizedGeometry-196224d4.js","./visualVariablesUtils-d4aac532.js","./cimAnalyzer-97b03e25.js","./fontUtils-d28127a5.js","./BidiEngine-9a40f2f4.js","./GeometryUtils-984e8446.js","./Rect-ea14f53a.js","./callExpressionWithFeature-06ba3d44.js","./quantizationUtils-533107d2.js","./floatRGBA-de0614b2.js","./ExpandedCIM-2df9bc7d.js","./util-ac05cbea.js","./TileContainer-0946d38f.js","./GraphicsView2D-4e889ec5.js","./normalizeUtilsSync-fc897fcb.js","./projectionSupport-66f9e6bd.js","./json-48e3ea08.js","./Matcher-dfb79dbc.js","./tileUtils-c2f19f52.js","./TurboLine-2e088fec.js","./ComputedAttributeStorage-d8e6e2e6.js","./arcadeTimeUtils-3a12e3ee.js","./centroid-8e8cfa47.js","./LayerView-6c752c5d.js"],import.meta.url)),stream:()=>$r().then(()=>W(()=>import("./StreamLayerView2D-7caf51a1.js"),["./StreamLayerView2D-7caf51a1.js","./FeatureLayerView2D-7a9bf807.js","./definitions-8f6c0024.js","./LayerView2D-de2fd686.js","./Container-de185a32.js","./enums-b14466b3.js","./Texture-eb8cd14a.js","./AttributeStoreView-a3f655f7.js","./TiledDisplayObject-d497910d.js","./color-e244539a.js","./enums-f1a6a48a.js","./VertexElementDescriptor-2925c6af.js","./number-e491b09e.js","./WGLContainer-037578f3.js","./VertexArrayObject-08f516fe.js","./vec4f32-0d1b2306.js","./ProgramTemplate-292cf23e.js","./GeometryUtils-f86d11a2.js","./alignmentUtils-ae955d28.js","./StyleDefinition-29c49b98.js","./config-1337d16e.js","./earcut-6b48af20.js","./featureConversionUtils-bafaa402.js","./OptimizedFeature-4701473b.js","./OptimizedFeatureSet-1d1ac4b9.js","./OptimizedGeometry-196224d4.js","./visualVariablesUtils-d4aac532.js","./cimAnalyzer-97b03e25.js","./fontUtils-d28127a5.js","./BidiEngine-9a40f2f4.js","./GeometryUtils-984e8446.js","./Rect-ea14f53a.js","./callExpressionWithFeature-06ba3d44.js","./quantizationUtils-533107d2.js","./floatRGBA-de0614b2.js","./ExpandedCIM-2df9bc7d.js","./util-ac05cbea.js","./BitmapTileContainer-eadd1b87.js","./Bitmap-fcefeaec.js","./TileContainer-0946d38f.js","./CircularArray-ef508845.js","./BufferPool-85f6109f.js","./FeatureContainer-afbe339d.js","./popupUtils-ef750880.js","./LayerView-6c752c5d.js","./RefreshableLayerView-0da84bd0.js"],import.meta.url)),"subtype-group":()=>$r().then(()=>W(()=>import("./SubtypeGroupLayerView2D-5a705627.js"),["./SubtypeGroupLayerView2D-5a705627.js","./FeatureLayerView2D-7a9bf807.js","./definitions-8f6c0024.js","./LayerView2D-de2fd686.js","./Container-de185a32.js","./enums-b14466b3.js","./Texture-eb8cd14a.js","./AttributeStoreView-a3f655f7.js","./TiledDisplayObject-d497910d.js","./color-e244539a.js","./enums-f1a6a48a.js","./VertexElementDescriptor-2925c6af.js","./number-e491b09e.js","./WGLContainer-037578f3.js","./VertexArrayObject-08f516fe.js","./vec4f32-0d1b2306.js","./ProgramTemplate-292cf23e.js","./GeometryUtils-f86d11a2.js","./alignmentUtils-ae955d28.js","./StyleDefinition-29c49b98.js","./config-1337d16e.js","./earcut-6b48af20.js","./featureConversionUtils-bafaa402.js","./OptimizedFeature-4701473b.js","./OptimizedFeatureSet-1d1ac4b9.js","./OptimizedGeometry-196224d4.js","./visualVariablesUtils-d4aac532.js","./cimAnalyzer-97b03e25.js","./fontUtils-d28127a5.js","./BidiEngine-9a40f2f4.js","./GeometryUtils-984e8446.js","./Rect-ea14f53a.js","./callExpressionWithFeature-06ba3d44.js","./quantizationUtils-533107d2.js","./floatRGBA-de0614b2.js","./ExpandedCIM-2df9bc7d.js","./util-ac05cbea.js","./BitmapTileContainer-eadd1b87.js","./Bitmap-fcefeaec.js","./TileContainer-0946d38f.js","./CircularArray-ef508845.js","./BufferPool-85f6109f.js","./FeatureContainer-afbe339d.js","./popupUtils-ef750880.js","./LayerView-6c752c5d.js","./RefreshableLayerView-0da84bd0.js"],import.meta.url)),tile:kx,"vector-tile":()=>$r().then(()=>W(()=>import("./VectorTileLayerView2D-f208a0bc.js"),["./VectorTileLayerView2D-f208a0bc.js","./enums-fb086c25.js","./Rect-ea14f53a.js","./enums-b14466b3.js","./Texture-eb8cd14a.js","./pbf-beba61b9.js","./rasterizingUtils-8fc9ca0c.js","./floatRGBA-de0614b2.js","./VertexArrayObject-08f516fe.js","./config-1337d16e.js","./TiledDisplayObject-d497910d.js","./Container-de185a32.js","./definitions-8f6c0024.js","./StyleDefinition-29c49b98.js","./enums-f1a6a48a.js","./color-e244539a.js","./VertexElementDescriptor-2925c6af.js","./number-e491b09e.js","./TileContainer-0946d38f.js","./WGLContainer-037578f3.js","./vec4f32-0d1b2306.js","./ProgramTemplate-292cf23e.js","./GeometryUtils-f86d11a2.js","./alignmentUtils-ae955d28.js","./earcut-6b48af20.js","./featureConversionUtils-bafaa402.js","./OptimizedFeature-4701473b.js","./OptimizedFeatureSet-1d1ac4b9.js","./OptimizedGeometry-196224d4.js","./StyleRepository-f46152cd.js","./GeometryUtils-984e8446.js","./LayerView2D-de2fd686.js","./LayerView-6c752c5d.js"],import.meta.url)),video:()=>$r().then(()=>W(()=>import("./VideoLayerView2D-59fb44c0.js"),["./VideoLayerView2D-59fb44c0.js","./LayerView2D-de2fd686.js","./Container-de185a32.js","./definitions-8f6c0024.js","./enums-b14466b3.js","./Texture-eb8cd14a.js","./LayerView-6c752c5d.js"],import.meta.url)),wcs:()=>$r().then(()=>W(()=>import("./ImageryTileLayerView2D-bb6d1cc7.js"),["./ImageryTileLayerView2D-bb6d1cc7.js","./RasterVFDisplayObject-d6882b92.js","./VertexArrayObject-08f516fe.js","./Texture-eb8cd14a.js","./enums-b14466b3.js","./VertexElementDescriptor-2925c6af.js","./WGLContainer-037578f3.js","./definitions-8f6c0024.js","./vec4f32-0d1b2306.js","./color-e244539a.js","./enums-f1a6a48a.js","./number-e491b09e.js","./ProgramTemplate-292cf23e.js","./GeometryUtils-f86d11a2.js","./alignmentUtils-ae955d28.js","./StyleDefinition-29c49b98.js","./config-1337d16e.js","./Container-de185a32.js","./earcut-6b48af20.js","./featureConversionUtils-bafaa402.js","./OptimizedFeature-4701473b.js","./OptimizedFeatureSet-1d1ac4b9.js","./OptimizedGeometry-196224d4.js","./LayerView2D-de2fd686.js","./rasterUtils-470d12dc.js","./TiledDisplayObject-d497910d.js","./TileContainer-0946d38f.js","./util-ac05cbea.js","./popupUtils-ef750880.js","./LayerView-6c752c5d.js","./RefreshableLayerView-0da84bd0.js"],import.meta.url)),"web-tile":kx,wfs:h_,wms:()=>$r().then(()=>W(()=>import("./WMSLayerView2D-a692bca4.js"),["./WMSLayerView2D-a692bca4.js","./BitmapContainer-2102bac1.js","./WGLContainer-037578f3.js","./definitions-8f6c0024.js","./VertexArrayObject-08f516fe.js","./Texture-eb8cd14a.js","./enums-b14466b3.js","./VertexElementDescriptor-2925c6af.js","./vec4f32-0d1b2306.js","./color-e244539a.js","./enums-f1a6a48a.js","./number-e491b09e.js","./ProgramTemplate-292cf23e.js","./GeometryUtils-f86d11a2.js","./alignmentUtils-ae955d28.js","./StyleDefinition-29c49b98.js","./config-1337d16e.js","./Container-de185a32.js","./earcut-6b48af20.js","./featureConversionUtils-bafaa402.js","./OptimizedFeature-4701473b.js","./OptimizedFeatureSet-1d1ac4b9.js","./OptimizedGeometry-196224d4.js","./LayerView2D-de2fd686.js","./ExportStrategy-ea2cdb45.js","./Bitmap-fcefeaec.js","./LayerView-6c752c5d.js","./RefreshableLayerView-0da84bd0.js","./ExportWMSImageParameters-de61a1bf.js"],import.meta.url)),wmts:()=>$r().then(()=>W(()=>import("./WMTSLayerView2D-c842c10c.js"),["./WMTSLayerView2D-c842c10c.js","./imageUtils-e631479c.js","./BitmapTileContainer-eadd1b87.js","./Bitmap-fcefeaec.js","./Container-de185a32.js","./definitions-8f6c0024.js","./enums-b14466b3.js","./Texture-eb8cd14a.js","./TiledDisplayObject-d497910d.js","./WGLContainer-037578f3.js","./VertexArrayObject-08f516fe.js","./VertexElementDescriptor-2925c6af.js","./vec4f32-0d1b2306.js","./color-e244539a.js","./enums-f1a6a48a.js","./number-e491b09e.js","./ProgramTemplate-292cf23e.js","./GeometryUtils-f86d11a2.js","./alignmentUtils-ae955d28.js","./StyleDefinition-29c49b98.js","./config-1337d16e.js","./earcut-6b48af20.js","./featureConversionUtils-bafaa402.js","./OptimizedFeature-4701473b.js","./OptimizedFeatureSet-1d1ac4b9.js","./OptimizedGeometry-196224d4.js","./TileContainer-0946d38f.js","./LayerView2D-de2fd686.js","./LayerView-6c752c5d.js","./RefreshableLayerView-0da84bd0.js"],import.meta.url)),"line-of-sight":null,"base-elevation":null,"building-scene":null,dimension:null,elevation:null,"integrated-mesh":null,"point-cloud":null,voxel:null,scene:null,unknown:null,unsupported:null};function L3e(t){const e=t.declaredClass?t.declaredClass.slice(t.declaredClass.lastIndexOf(".")+1):"Unknown",i=e.replaceAll(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();return new N(`${i}:view-not-supported`,`${e} is not supported in 2D`)}const nJ={hasLayerViewModule:t=>rJ[t.type]!=null,importLayerView:t=>{const e=rJ[t.type];if(e==null)throw L3e(t);return e(t)}};function R3e(t,e){const{spatialReference:i}=e,r=[e.x,e.y];let n=Number.POSITIVE_INFINITY,s=0,o=0;const a=[0,0],l=t.type==="extent"?[[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]]:t.rings;for(const c of l)for(let u=0;u<c.length-1;u++){yCe(a,r,c,u);const h=Ig(r,a);h<n&&(n=h,s=a[0],o=a[1])}return{coordinate:new fe({x:s,y:o,spatialReference:i}),distance:n}}var G4;let A0=G4=class extends jB(he){constructor(t){super(t),this.geometry=null,this.spatialReference=null}get normalizedGeometry(){if(this.geometry==null||!this.spatialReference)return null;if(!this.spatialReference.equals(this.geometry.spatialReference))try{return Ir(this.geometry,this.spatialReference)}catch(t){return ie.getLogger(this).error("#constraints.geometry","could not project the geometry to the view's spatial reference",{geometry:this.geometry,spatialReference:this.spatialReference,error:t}),null}return this.geometry}constrain(t,e){if(this.normalizedGeometry==null)return t;const i=t.targetGeometry;if(this.normalizedGeometry.type==="extent"?YO(this.normalizedGeometry,i):use(this.normalizedGeometry,i))return t;const{coordinate:r}=R3e(this.normalizedGeometry,i);return r&&(t.targetGeometry=r),t}clone(){var t,e;return new G4({geometry:(t=this.geometry)==null?void 0:t.clone(),spatialReference:(e=this.spatialReference)==null?void 0:e.clone()})}};d([p({constructOnly:!0})],A0.prototype,"geometry",void 0),d([p({readOnly:!0})],A0.prototype,"normalizedGeometry",null),d([p({constructOnly:!0})],A0.prototype,"spatialReference",void 0),A0=G4=d([A("esri.views.2d.constraints.GeometryConstraint")],A0);var H4;let WS=H4=class extends jB(he){constructor(){super(...arguments),this.enabled=!0,this.rotationEnabled=!0}constrain(t,e){return this.enabled&&e&&(this.rotationEnabled||(t.rotation=e.rotation)),t}clone(){return new H4({enabled:this.enabled,rotationEnabled:this.rotationEnabled})}};d([p()],WS.prototype,"enabled",void 0),d([p()],WS.prototype,"rotationEnabled",void 0),WS=H4=d([A("esri.views.2d.constraints.RotationConstraint")],WS);const Sue=WS;var q4;let ta=q4=class extends jB(he){constructor(t){super(t),this._lodByScale={},this._scales=[],this.effectiveLODs=null,this.effectiveMinZoom=-1,this.effectiveMaxZoom=-1,this.effectiveMinScale=0,this.effectiveMaxScale=0,this.lods=null,this.minZoom=-1,this.maxZoom=-1,this.minScale=0,this.maxScale=0,this.snapToZoom=!0}initialize(){let t,{lods:e,minScale:i,maxScale:r,minZoom:n,maxZoom:s}=this,o=-1,a=-1,l=!1,c=!1;if(i!==0&&r!==0&&i<r&&([i,r]=[r,i]),!e||!e.length)return this._set("effectiveMinScale",i),void this._set("effectiveMaxScale",r);e=e.map(u=>u.clone()),e.sort((u,h)=>h.scale-u.scale),e.forEach((u,h)=>u.level=h);for(const u of e)!l&&i>0&&i>=u.scale&&(o=u.level,l=!0),!c&&r>0&&r>=u.scale&&(a=t?t.level:-1,c=!0),t=u;n===-1&&(n=i===0?0:o),s===-1&&(s=r===0?e.length-1:a),n=Math.max(n,0),n=Math.min(n,e.length-1),s=Math.max(s,0),s=Math.min(s,e.length-1),n>s&&([n,s]=[s,n]),i=e[n].scale,r=e[s].scale,e.splice(0,n),e.splice(s-n+1,e.length),e.forEach((u,h)=>{this._lodByScale[u.scale]=u,this._scales[h]=u.scale}),this._set("effectiveLODs",e),this._set("effectiveMinZoom",n),this._set("effectiveMaxZoom",s),this._set("effectiveMinScale",i),this._set("effectiveMaxScale",r)}constrain(t,e){if(e&&t.scale===e.scale)return t;const i=this.effectiveMinScale,r=this.effectiveMaxScale,n=t.targetGeometry,s=e&&e.targetGeometry,o=r!==0&&t.scale<r,a=i!==0&&t.scale>i;if(o||a){const l=a?i:r;if(e&&s){const c=(l-e.scale)/(t.scale-e.scale);n.x=s.x+(n.x-s.x)*c,n.y=s.y+(n.y-s.y)*c}t.scale=l}return this.snapToZoom&&this.effectiveLODs&&(t.scale=this._getClosestScale(t.scale)),t}fit(t){if(!this.effectiveLODs||!this.snapToZoom)return this.constrain(t,null);const e=this.scaleToZoom(t.scale),i=Math.abs(e-Math.floor(e));return t.scale=this.zoomToScale(i>.99?Math.round(e):Math.floor(e)),t}zoomToScale(t){if(!this.effectiveLODs)return 0;t-=this.effectiveMinZoom,t=Math.max(0,t);const e=this._scales;if(t<=0)return e[0];if(t>=e.length)return e[e.length-1];const i=Math.round(t-.5),r=Math.round(t);return e[r]+(r-t)*(e[i]-e[r])}scaleToZoom(t){if(!this.effectiveLODs)return-1;const e=this._scales;let i,r;if(t>=e[0])return this.effectiveMinZoom;if(t<=e[e.length-1])return this.effectiveMaxZoom;for(let n=0;n<e.length-1;n++){if(i=e[n],r=e[n+1],r===t)return n+this.effectiveMinZoom+1;if(i>t&&r<t)return n+this.effectiveMinZoom+1-(t-r)/(i-r)}return-1}snapToClosestScale(t){if(!this.effectiveLODs)return t;const e=this.scaleToZoom(t);return this.zoomToScale(Math.round(e))}snapToNextScale(t,e=.5){if(!this.effectiveLODs)return t*e;const i=Math.round(this.scaleToZoom(t));return this.zoomToScale(i+1)}snapToPreviousScale(t,e=2){if(!this.effectiveLODs)return t*e;const i=Math.round(this.scaleToZoom(t));return this.zoomToScale(i-1)}clone(){return new q4({lods:this.lods,minZoom:this.minZoom,maxZoom:this.maxZoom,minScale:this.minScale,maxScale:this.maxScale})}_getClosestScale(t){return this._lodByScale[t]||(t=this._scales.reduce((e,i)=>Math.abs(i-t)<=Math.abs(e-t)?i:e,this._scales[0])),this._lodByScale[t].scale}};d([p({readOnly:!0})],ta.prototype,"effectiveLODs",void 0),d([p({readOnly:!0})],ta.prototype,"effectiveMinZoom",void 0),d([p({readOnly:!0})],ta.prototype,"effectiveMaxZoom",void 0),d([p({readOnly:!0})],ta.prototype,"effectiveMinScale",void 0),d([p({readOnly:!0})],ta.prototype,"effectiveMaxScale",void 0),d([p()],ta.prototype,"lods",void 0),d([p()],ta.prototype,"minZoom",void 0),d([p()],ta.prototype,"maxZoom",void 0),d([p()],ta.prototype,"minScale",void 0),d([p()],ta.prototype,"maxScale",void 0),d([p()],ta.prototype,"snapToZoom",void 0),ta=q4=d([A("esri.views.2d.constraints.ZoomConstraint")],ta);const Iue=ta,F3e={base:null,key:"type",typeMap:{extent:Re,polygon:Zn}};let Dr=class extends he{constructor(e){super(e),this.lods=null,this.minScale=0,this.maxScale=0,this.minZoom=-1,this.maxZoom=-1,this.rotationEnabled=!0,this.snapToZoom=!0,this.customConstraints=new ye}destroy(){this.view=null}get effectiveLODs(){return this._zoom.effectiveLODs}get effectiveMinScale(){return this._zoom.effectiveMinScale}get effectiveMaxScale(){return this._zoom.effectiveMaxScale}get effectiveMinZoom(){return this._zoom.effectiveMinZoom}get effectiveMaxZoom(){return this._zoom.effectiveMaxZoom}set geometry(e){e?this._set("geometry",e):this._set("geometry",null)}get version(){var e,i,r;return`${(e=this._zoom)==null?void 0:e.uid}/${(i=this._rotation)==null?void 0:i.uid}/${(r=this._geometry)==null?void 0:r.uid}`}get _geometry(){var i,r;const e=this._get("_geometry");return e&&this.geometry===e.geometry&&((i=this.view)==null?void 0:i.constraintsInfo.spatialReference)===e.spatialReference?e:new A0({geometry:this.geometry,spatialReference:(r=this.view)==null?void 0:r.constraintsInfo.spatialReference})}get _rotation(){return new Sue({rotationEnabled:this.rotationEnabled})}get _zoom(){var l;const e=this._get("_zoom"),i=this.lods||((l=this.view)==null?void 0:l.constraintsInfo.lods),r=this.minZoom,n=this.maxZoom,s=this.minScale,o=this.maxScale,a=this.snapToZoom;return e&&e.lods===i&&e.minZoom===r&&e.maxZoom===n&&e.minScale===s&&e.maxScale===o&&e.snapToZoom===a?e:new Iue({lods:i,minZoom:r,maxZoom:n,minScale:s,maxScale:o,snapToZoom:a})}canZoomInTo(e){const i=this.effectiveMaxScale;return i===0||e>=i}canZoomOutTo(e){const i=this.effectiveMinScale;return i===0||e<=i}constrain(e,i){return this._zoom.constrain(e,i),this._rotation.constrain(e,i),this._geometry.constrain(e,i),this.customConstraints.forEach(r=>r.constrain(e,i)),e}constrainByGeometry(e){return this._geometry.constrain(e)}fit(e){return this._zoom.fit(e)}zoomToScale(e){return this._zoom.zoomToScale(e)}scaleToZoom(e){return this._zoom.scaleToZoom(e)}snapScale(e){return this._zoom.snapToClosestScale(e)}snapToNextScale(e){return this._zoom.snapToNextScale(e)}snapToPreviousScale(e){return this._zoom.snapToPreviousScale(e)}};d([p({readOnly:!0})],Dr.prototype,"effectiveLODs",null),d([p({readOnly:!0})],Dr.prototype,"effectiveMinScale",null),d([p({readOnly:!0})],Dr.prototype,"effectiveMaxScale",null),d([p({readOnly:!0})],Dr.prototype,"effectiveMinZoom",null),d([p({readOnly:!0})],Dr.prototype,"effectiveMaxZoom",null),d([p({types:F3e,value:null})],Dr.prototype,"geometry",null),d([p({type:[vd]})],Dr.prototype,"lods",void 0),d([p()],Dr.prototype,"minScale",void 0),d([p()],Dr.prototype,"maxScale",void 0),d([p()],Dr.prototype,"minZoom",void 0),d([p()],Dr.prototype,"maxZoom",void 0),d([p()],Dr.prototype,"rotationEnabled",void 0),d([p()],Dr.prototype,"snapToZoom",void 0),d([p({type:ye})],Dr.prototype,"customConstraints",void 0),d([p()],Dr.prototype,"view",void 0),d([p({readOnly:!0})],Dr.prototype,"version",null),d([p({type:A0,readOnly:!0})],Dr.prototype,"_geometry",null),d([p({type:Sue})],Dr.prototype,"_rotation",null),d([p({readOnly:!0,type:Iue})],Dr.prototype,"_zoom",null),Dr=d([A("esri.views.2d.MapViewConstraints")],Dr);const Tue=Dr;let D3e=class{constructor(e,i){this.item=e,this.controller=i,this.promise=null}},WU=class{constructor(e){this._deferreds=new Map,this._controllers=new Map,this._processingItems=new Map,this._isPaused=!1,this._schedule=null,this._task=null,this.concurrency=1,e.concurrency&&(this.concurrency=e.concurrency),this._queue=new iT(e.peeker),this.process=e.process;const i=e.scheduler;e.priority&&i&&(this._task=i.registerTask(e.priority,this))}destroy(){this.clear(),this._schedule=$i(this._schedule),this._task=$i(this._task)}get length(){return this._processingItems.size+this._queue.length}abort(e){const i=this._controllers.get(e);i&&i.abort()}clear(){this._queue.clear();const e=[];this._controllers.forEach(i=>e.push(i)),this._controllers.clear(),e.forEach(i=>i.abort()),this._processingItems.clear(),this._cancelNext()}forEach(e){this._deferreds.forEach((i,r)=>e(r))}get(e){const i=this._deferreds.get(e);return i?i.promise:void 0}isOngoing(e){return this._processingItems.has(e)}has(e){return this._deferreds.has(e)}pause(){this._isPaused||(this._isPaused=!0,this._cancelNext())}push(e,i){const r=this.get(e);if(r)return r;const n=new AbortController;let s=null;i&&(s=Fo(i,()=>n.abort()));const o=()=>{const u=this._processingItems.get(e);u&&u.controller.abort(),a(),c.reject(wi())},a=()=>{l.remove(),s!=null&&s.remove(),this._deferreds.delete(e),this._controllers.delete(e),this._queue.remove(e),this._processingItems.delete(e),this._scheduleNext()},l=U6(n.signal,o),c=Ta();return this._deferreds.set(e,c),this._controllers.set(e,n),c.promise.then(a,a),this._queue.push(e),this._scheduleNext(),c.promise}last(){return this._queue.last()}peek(){return this._queue.peek()}popLast(){return this._queue.popLast()}reset(){const e=[];this._processingItems.forEach(i=>e.push(i)),this._processingItems.clear();for(const i of e)this._queue.push(i.item),i.controller.abort();this._scheduleNext()}resume(){this._isPaused&&(this._isPaused=!1,this._scheduleNext())}takeAll(){const e=[];for(;this._queue.length;)e.push(this._queue.pop());return this.clear(),e}get running(){return!this._isPaused&&this._queue.length>0&&this._processingItems.size<this.concurrency}runTask(e){for(;!e.done&&this._queue.length>0&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop()),e.madeProgress()}_scheduleNext(){this._task||this._isPaused||this._schedule||(this._schedule=O1(()=>{this._schedule=null,this._next()}))}_next(){for(;this._queue.length>0&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop())}_cancelNext(){this._schedule&&(this._schedule.remove(),this._schedule=null)}_processResult(e,i){this._canProcessFulfillment(e)&&(this._scheduleNext(),this._deferreds.get(e.item).resolve(i))}_processError(e,i){this._canProcessFulfillment(e)&&(this._scheduleNext(),this._deferreds.get(e.item).reject(i))}_canProcessFulfillment(e){return!!this._deferreds.get(e.item)&&this._processingItems.get(e.item)===e}_process(e){if(e==null)return;let i;const r=new AbortController,n=new D3e(e,r);this._processingItems.set(e,n);try{i=this.process(e,r.signal)}catch(s){this._processError(n,s)}Tp(i)?(n.promise=i,i.then(s=>this._processResult(n,s),s=>this._processError(n,s))):this._processResult(n,i)}get test(){return{update:e=>this.runTask(e)}}};function N3e(t,e){return t.length=0,e.forEach(i=>t.push(i)),t}const G3=new Set,NE=[],p_=new Map,sJ=[0,0];let Kp=class extends he{constructor(e){super(e),this._keyToItem=new Map,this.concurrency=6,this.strategy="scale-first",this.tileInfoView=null}initialize(){const{concurrency:e,process:i}=this;this._queue=new WU({concurrency:e,process:(r,n)=>{const s=this._keyToItem.get(r);return i(s,{signal:n})},peeker:r=>r.values().next().value})}destroy(){this.clear(),this._queue=je(this._queue)}get length(){return this._queue?this._queue.length:0}get onGoingCount(){return this._keyToItem.size}get updating(){return this.length>0||this.onGoingCount>0}abort(e){const i=typeof e=="string"?e:e.id;this._queue.abort(i)}clear(){this._queue.clear(),this._keyToItem.clear(),this.notifyChange("updating")}has(e){return typeof e=="string"?this._keyToItem.has(e):this._keyToItem.has(e.id)}isOngoing(e){const i=typeof e=="string"?e:e.id;return this.has(i)&&this._queue.isOngoing(i)}pause(){this._queue.pause()}push(e,i){const r=e.key.id+"-"+i;if(this.has(r))return this.get(r);const n=this._queue.push(r),s=()=>{this._keyToItem.delete(r),this.notifyChange("updating")};return this._keyToItem.set(r,e),n.then(s,s),this.notifyChange("updating"),n}reset(){this._queue.reset(),this.notifyChange("updating")}resume(){this._queue.resume()}_peekByScaleFirst(e){if(!this.state)return e.values().next().value;const i=this.tileInfoView;let r=Number.NEGATIVE_INFINITY,n=Number.POSITIVE_INFINITY;e.forEach(u=>{const h=this._keyToItem.get(u),f=this.tileInfoView.getTileScale(h.key);p_.has(f)||(p_.set(f,[]),r=Math.max(f,r),n=Math.min(f,n)),p_.get(f).push(h.key),G3.add(f)});let s=this.state.scale;p_.has(s)||(N3e(NE,G3),NE.sort((u,h)=>u-h),s=NE.reduce((u,h)=>Math.abs(h-s)<Math.abs(u-s)?h:u,NE[0])),s=Math.min(s,r),s=Math.max(s,n);const o=p_.get(s),a=i.getClosestInfoForScale(s),l=a.getColumnForX(this.state.center[0]),c=a.getRowForY(this.state.center[1]);return o.sort((u,h)=>{const f=a.denormalizeCol(u.col,u.world),m=a.denormalizeCol(h.col,h.world);return Math.sqrt((l-f)*(l-f)+(c-u.row)*(c-u.row))-Math.sqrt((l-m)*(l-m)+(c-h.row)*(c-h.row))}),G3.clear(),p_.clear(),o[0].id}_peekByCenterFirst(e){if(!this.state)return e.values().next().value;const i=this.tileInfoView,r=this.state.center;let n,s=Number.POSITIVE_INFINITY;return e.forEach(o=>{const a=this._keyToItem.get(o);i.getTileCoords(sJ,a.key);const l=Ig(sJ,r);l<s&&(s=l,n=a.key)}),n.id}};d([p({constructOnly:!0})],Kp.prototype,"concurrency",void 0),d([p({constructOnly:!0})],Kp.prototype,"process",void 0),d([p()],Kp.prototype,"state",void 0),d([p({constructOnly:!0})],Kp.prototype,"strategy",void 0),d([p({constructOnly:!0})],Kp.prototype,"tileInfoView",void 0),d([p({readOnly:!0})],Kp.prototype,"updating",null),Kp=d([A("esri.views.2d.tiling.PagedTileQueue")],Kp);let Ev=class Iy{static getId(e,i,r,n){return typeof e=="object"?`${e.level}/${e.row}/${e.col}/${e.world}`:`${e}/${i}/${r}/${n}`}constructor(e,i,r,n){this.set(e,i,r,n)}get key(){return this}get id(){return this.toString()}set id(e){this.set(e)}get hash(){const e=4095&this.row,i=4095&this.col,r=63&this.level;return(3&this.world)<<30|i<<22|e<<8|r}acquire(e,i,r,n){this.set(e,i,r,n)}contains(e){const i=e.level-this.level;return i>=0&&this.row===e.row>>i&&this.col===e.col>>i&&this.world===e.world}equals(e){return this.level===e.level&&this.row===e.row&&this.col===e.col&&this.world===e.world}clone(){return new Iy(this)}release(){this.level=0,this.row=0,this.col=0,this.world=0}set(e,i,r,n){if(e==null)this.level=0,this.row=0,this.col=0,this.world=0;else if(typeof e=="object")this.level=e.level||0,this.row=e.row||0,this.col=e.col||0,this.world=e.world||0;else if(typeof e=="string"){const[s,o,a,l]=e.split("/");this.level=parseFloat(s),this.row=parseFloat(o),this.col=parseFloat(a),this.world=parseFloat(l)}else this.level=+e,this.row=+i,this.col=+r,this.world=+n||0;return this}toString(){return`${this.level}/${this.row}/${this.col}/${this.world}`}getParentKey(){return this.level<=0?null:new Iy(this.level-1,this.row>>1,this.col>>1,this.world)}getChildKeys(){const e=this.level+1,i=this.row<<1,r=this.col<<1,n=this.world;return[new Iy(e,i,r,n),new Iy(e,i,r+1,n),new Iy(e,i+1,r,n),new Iy(e,i+1,r+1,n)]}compareRowMajor(e){return this.row<e.row?-1:this.row>e.row?1:this.col<e.col?-1:this.col>e.col?1:0}};Ev.pool=new yp(Ev,null,null,25,50);function Xp(t,e){return[t,e]}function Fg(t,e,i){return t[0]=e,t[1]=i,t}function V3e(t,e,i,r,n){return t[0]=e,t[1]=i,t[2]=r,t[3]=n,t}const Sc=new Ev("0/0/0/0");let z3e=class Cue{static create(e,i,r=null){const n=Do(e.spatialReference),s=i.origin||Xp(e.origin.x,e.origin.y),o=Xp(e.size[0]*i.resolution,e.size[1]*i.resolution),a=Xp(-1/0,-1/0),l=Xp(1/0,1/0),c=Xp(1/0,1/0);r!=null&&(Fg(a,Math.max(0,Math.floor((r.xmin-s[0])/o[0])),Math.max(0,Math.floor((s[1]-r.ymax)/o[1]))),Fg(l,Math.max(0,Math.floor((r.xmax-s[0])/o[0])),Math.max(0,Math.floor((s[1]-r.ymin)/o[1]))),Fg(c,l[0]-a[0]+1,l[1]-a[1]+1));const{cols:u,rows:h}=i;let f,m,g,y;return!r&&u&&h&&(Fg(a,u[0],h[0]),Fg(l,u[1],h[1]),Fg(c,u[1]-u[0]+1,h[1]-h[0]+1)),e.isWrappable?(f=Xp(Math.ceil(Math.round((n.valid[1]-n.valid[0])/i.resolution)/e.size[0]),c[1]),m=Xp(Math.floor((n.origin[0]-s[0])/o[0]),a[1]),g=Xp(f[0]+m[0]-1,l[1]),y=!0):(m=a,g=l,f=c,y=!1),new Cue(i.level,i.resolution,i.scale,s,a,l,c,o,m,g,f,y)}constructor(e,i,r,n,s,o,a,l,c,u,h,f){this.level=e,this.resolution=i,this.scale=r,this.origin=n,this.first=s,this.last=o,this.size=a,this.norm=l,this.worldStart=c,this.worldEnd=u,this.worldSize=h,this.wrap=f}normalizeCol(e){if(!this.wrap)return e;const i=this.worldSize[0];return e<0?i-1-Math.abs((e+1)%i):e%i}denormalizeCol(e,i){return this.wrap?this.worldSize[0]*i+e:e}getWorldForColumn(e){return this.wrap?Math.floor(e/this.worldSize[0]):0}getFirstColumnForWorld(e){return e*this.worldSize[0]+this.first[0]}getLastColumnForWorld(e){return e*this.worldSize[0]+this.first[0]+this.size[0]-1}getColumnForX(e){return(e-this.origin[0])/this.norm[0]}getXForColumn(e){return this.origin[0]+e*this.norm[0]}getRowForY(e){return(this.origin[1]-e)/this.norm[1]}getYForRow(e){return this.origin[1]-e*this.norm[1]}getTileBounds(e,i,r=!1){Sc.set(i);const n=r?Sc.col:this.denormalizeCol(Sc.col,Sc.world),s=Sc.row;return V3e(e,this.getXForColumn(n),this.getYForRow(s+1),this.getXForColumn(n+1),this.getYForRow(s)),e}getTileCoords(e,i,r=!1){Sc.set(i);const n=r?Sc.col:this.denormalizeCol(Sc.col,Sc.world);return Array.isArray(e)?Fg(e,this.getXForColumn(n),this.getYForRow(Sc.row)):(e.x=this.getXForColumn(n),e.y=this.getYForRow(Sc.row)),e}},dT=class{constructor(){this.spans=[]}acquire(e){this.lodInfo=e}release(){this.lodInfo=null,this.spans.length=0}forEach(e,i){const{spans:r,lodInfo:n}=this,{level:s}=n;if(r.length!==0)for(const{row:o,colFrom:a,colTo:l}of r)for(let c=a;c<=l;c++)e.call(i,s,o,n.normalizeCol(c),n.getWorldForColumn(c))}};dT.pool=new yp(dT);let H3=class{constructor(e,i,r){this.row=e,this.colFrom=i,this.colTo=r}};const er=new Ev("0/0/0/0");let j3e=class Eue{static create(e,i){e[1]>i[1]&&([e,i]=[i,e]);const[r,n]=e,[s,o]=i,a=s-r,l=o-n,c=l!==0?a/l:0,u=(Math.ceil(n)-n)*c,h=(Math.floor(n)-n)*c;return new Eue(r,Math.floor(n),Math.ceil(o),c,a<0?u:h,a<0?h:u,a<0?s:r,a<0?r:s)}constructor(e,i,r,n,s,o,a,l){this.x=e,this.ymin=i,this.ymax=r,this.invM=n,this.leftAdjust=s,this.rightAdjust=o,this.leftBound=a,this.rightBound=l}incrRow(){this.x+=this.invM}getLeftCol(){return Math.max(this.x+this.leftAdjust,this.leftBound)}getRightCol(){return Math.min(this.x+this.rightAdjust,this.rightBound)}};const Aa=[[0,0],[0,0],[0,0],[0,0]],B3e=1e-6;let U3e=class{constructor(e,i=null,r=e.lods[0].level,n=e.lods[e.lods.length-1].level){this.tileInfo=e,this.fullExtent=i,this.scales=[],this._infoByScale={},this._infoByLevel={};const s=e.lods.filter(a=>a.level>=r&&a.level<=n);this.minScale=s[0].scale,this.maxScale=s[s.length-1].scale;const o=this._lodInfos=s.map(a=>z3e.create(e,a,i));s.forEach((a,l)=>{this._infoByLevel[a.level]=o[l],this._infoByScale[a.scale]=o[l],this.scales[l]=a.scale},this),this._wrap=e.isWrappable}get spatialReference(){return this.tileInfo.spatialReference}getLODInfoAt(e){return this._infoByLevel[typeof e=="number"?e:e.level]}getTileBounds(e,i,r=!1){er.set(i);const n=this._infoByLevel[er.level];return n?n.getTileBounds(e,er,r):e}getTileCoords(e,i,r=!1){er.set(i);const n=this._infoByLevel[er.level];return n?n.getTileCoords(e,er,r):e}getTileCoverage(e,i=192,r=!0,n="closest"){if(!r&&(e.scale>this.minScale||e.scale<this.maxScale))return null;const s=n==="closest"?this.getClosestInfoForScale(e.scale):this.getSmallestInfoForScale(e.scale),o=dT.pool.acquire(s),a=this._wrap;let l,c,u,h=1/0,f=-1/0;const m=o.spans;Aa[0][0]=Aa[0][1]=Aa[1][1]=Aa[3][0]=-i,Aa[1][0]=Aa[2][0]=e.size[0]+i,Aa[2][1]=Aa[3][1]=e.size[1]+i;for(const b of Aa)e.toMap(b,b),b[0]=s.getColumnForX(b[0]),b[1]=s.getRowForY(b[1]);const g=[];let y=3;for(let b=0;b<4;b++){if(Aa[b][1]===Aa[y][1]){y=b;continue}const w=j3e.create(Aa[b],Aa[y]);h=Math.min(w.ymin,h),f=Math.max(w.ymax,f),g[w.ymin]===void 0&&(g[w.ymin]=[]),g[w.ymin].push(w),y=b}if(h==null||f==null||f-h>100)return null;let v=[];for(l=h;l<f;){g[l]!=null&&(v=v.concat(g[l])),c=1/0,u=-1/0;for(let b=v.length-1;b>=0;b--){const w=v[b];c=Math.min(c,w.getLeftCol()),u=Math.max(u,w.getRightCol())}if(c=Math.floor(c),u=Math.floor(u),l>=s.first[1]&&l<=s.last[1])if(a)if(s.size[0]<s.worldSize[0]){const b=Math.floor(u/s.worldSize[0]);for(let w=Math.floor(c/s.worldSize[0]);w<=b;w++)m.push(new H3(l,Math.max(s.getFirstColumnForWorld(w),c),Math.min(s.getLastColumnForWorld(w),u)))}else m.push(new H3(l,c,u));else c>s.last[0]||u<s.first[0]||(c=Math.max(c,s.first[0]),u=Math.min(u,s.last[0]),m.push(new H3(l,c,u)));l+=1;for(let b=v.length-1;b>=0;b--){const w=v[b];w.ymax>=l?w.incrRow():v.splice(b,1)}}return o}getTileParentId(e){er.set(e);const i=this._infoByLevel[er.level],r=this._lodInfos.indexOf(i)-1;return r<0?null:(this._getTileIdAtLOD(er,this._lodInfos[r],er),er.id)}getTileResolution(e){const i=this._infoByLevel[typeof e=="object"?e.level:e];return i?i.resolution:-1}getTileScale(e){const i=this._infoByLevel[e.level];return i?i.scale:-1}intersects(e,i){er.set(i);const r=this._infoByLevel[er.level],n=e.lodInfo;if(n.resolution>r.resolution){this._getTileIdAtLOD(er,n,er);const o=n.denormalizeCol(er.col,er.world);for(const a of e.spans)if(a.row===er.row&&a.colFrom<=o&&a.colTo>=o)return!0}if(n.resolution<r.resolution){const[o,a,l,c]=e.spans.reduce((y,v)=>(y[0]=Math.min(y[0],v.row),y[1]=Math.max(y[1],v.row),y[2]=Math.min(y[2],v.colFrom),y[3]=Math.max(y[3],v.colTo),y),[1/0,-1/0,1/0,-1/0]),u=r.denormalizeCol(er.col,er.world),h=n.getColumnForX(r.getXForColumn(u)),f=n.getRowForY(r.getYForRow(er.row)),m=n.getColumnForX(r.getXForColumn(u+1))-1,g=n.getRowForY(r.getYForRow(er.row+1))-1;return!(h>c||m<l||f>a||g<o)}const s=n.denormalizeCol(er.col,er.world);return e.spans.some(o=>o.row===er.row&&o.colFrom<=s&&o.colTo>=s)}normalizeBounds(e,i,r){if(e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],this._wrap){const n=Do(this.tileInfo.spatialReference),s=-r*(n.valid[1]-n.valid[0]);e[0]+=s,e[2]+=s}return e}getSmallestInfoForScale(e){const i=this.scales;if(this._infoByScale[e])return this._infoByScale[e];if(e>i[0])return this._infoByScale[i[0]];for(let r=1;r<i.length-1;r++)if(e>i[r]+B3e)return this._infoByScale[i[r-1]];return this._infoByScale[i[i.length-1]]}getClosestInfoForScale(e){const i=this.scales;return this._infoByScale[e]||(e=i.reduce((r,n)=>Math.abs(n-e)<Math.abs(r-e)?n:r,i[0])),this._infoByScale[e]}scaleToLevel(e){const i=this.scales;if(this._infoByScale[e])return this._infoByScale[e].level;for(let r=i.length-1;r>=0;r--)if(e<i[r])return r===i.length-1?this._infoByScale[i[i.length-1]].level:this._infoByScale[i[r]].level+(i[r]-e)/(i[r]-i[r+1]);return this._infoByScale[i[0]].level}scaleToZoom(e){return this.tileInfo.scaleToZoom(e)}_getTileIdAtLOD(e,i,r){const n=this._infoByLevel[r.level];return e.set(r),i.resolution<n.resolution?null:(i.resolution===n.resolution||(e.level=i.level,e.col=Math.floor(r.col*n.resolution/i.resolution+.01),e.row=Math.floor(r.row*n.resolution/i.resolution+.01)),e)}};function G3e(t,e){return t.length=0,e.forEach(i=>t.push(i)),t}const q3=new Set,VE=[],f_=new Map,oJ=[0,0];let vh=class extends he{constructor(e){super(e),this._keyToItem=new Map,this.concurrency=6,this.strategy="scale-first",this.tileInfoView=null}initialize(){const{concurrency:e,process:i,strategy:r}=this;this._queue=new WU({concurrency:e,process:(n,s)=>{const o=this._keyToItem.get(n);return i(o,{signal:s})},peeker:r==="scale-first"?n=>this._peekByScaleFirst(n):n=>this._peekByCenterFirst(n)})}destroy(){this.clear(),this._queue=je(this._queue)}get length(){return this._queue?this._queue.length:0}get onGoingCount(){return this._keyToItem.size}get updating(){return this.length>0||this.onGoingCount>0}abort(e){const i=typeof e=="string"?e:e.id;this._queue.abort(i)}clear(){this._queue.clear(),this._keyToItem.clear(),this.notifyChange("updating")}has(e){return typeof e=="string"?this._keyToItem.has(e):this._keyToItem.has(e.id)}isOngoing(e){const i=typeof e=="string"?e:e.id;return this.has(i)&&this._queue.isOngoing(i)}pause(){this._queue.pause()}push(e){const i=e.key.id;if(this._queue.has(i))return this._queue.get(i);const r=this._queue.push(i),n=()=>{this._keyToItem.delete(i),this.notifyChange("updating")};return this._keyToItem.set(i,e),r.then(n,n),this.notifyChange("updating"),r}reset(){this._queue.reset()}resume(){this._queue.resume()}_peekByScaleFirst(e){if(!this.state)return e.values().next().value;const i=this.tileInfoView;let r=Number.NEGATIVE_INFINITY,n=Number.POSITIVE_INFINITY;e.forEach(u=>{const h=this._keyToItem.get(u),f=this.tileInfoView.getTileScale(h.key);f_.has(f)||(f_.set(f,[]),r=Math.max(f,r),n=Math.min(f,n)),f_.get(f).push(h.key),q3.add(f)});let s=this.state.scale;f_.has(s)||(G3e(VE,q3),VE.sort((u,h)=>u-h),s=VE.reduce((u,h)=>Math.abs(h-s)<Math.abs(u-s)?h:u,VE[0])),s=Math.min(s,r),s=Math.max(s,n);const o=f_.get(s),a=i.getClosestInfoForScale(s),l=a.getColumnForX(this.state.center[0]),c=a.getRowForY(this.state.center[1]);return o.sort((u,h)=>{const f=a.denormalizeCol(u.col,u.world),m=a.denormalizeCol(h.col,h.world);return Math.sqrt((l-f)*(l-f)+(c-u.row)*(c-u.row))-Math.sqrt((l-m)*(l-m)+(c-h.row)*(c-h.row))}),q3.clear(),f_.clear(),o[0].id}_peekByCenterFirst(e){if(!this.state)return e.values().next().value;const i=this.tileInfoView,r=this.state.center;let n,s=Number.POSITIVE_INFINITY;return e.forEach(o=>{const a=this._keyToItem.get(o);i.getTileCoords(oJ,a.key);const l=Ig(oJ,r);l<s&&(s=l,n=a.key)}),n.id}};d([p({constructOnly:!0})],vh.prototype,"concurrency",void 0),d([p({constructOnly:!0})],vh.prototype,"process",void 0),d([p()],vh.prototype,"state",void 0),d([p({constructOnly:!0})],vh.prototype,"strategy",void 0),d([p({constructOnly:!0})],vh.prototype,"tileInfoView",void 0),d([p({readOnly:!0})],vh.prototype,"updating",null),vh=d([A("esri.views.2d.tiling.TileQueue")],vh);const e_t=vh;let H3e=class{constructor(e,i,r){this.maxSize=e,this._tileInfoView=i,this._removedFunc=r,this._tilePerId=new Map,this._tileKeysPerLevel=[]}clear(){this._tilePerId.clear(),this._tileKeysPerLevel=[]}has(e){return this._tilePerId.has(e)}get(e){return this._tilePerId.get(e)}pop(e){const i=this._tilePerId.get(e);if(!i)return;const r=i.key.level,n=this._tileKeysPerLevel[r];aJ(this._tilePerId,e);for(let s=0;s<n.length;s++)if(n[s].id===e){n.splice(s,1);break}return i.visible=!0,i}add(e){e.visible=!1;const i=e.key,r=i.id;if(this._tilePerId.has(r))return;this._tilePerId.set(r,e);const n=i.level;this._tileKeysPerLevel[n]||(this._tileKeysPerLevel[n]=[]),this._tileKeysPerLevel[n].push(i)}prune(e,i,r){let n=this._tilePerId.size;if(n<=this.maxSize)return;let s=this._tileKeysPerLevel.length-1;for(;n>this.maxSize&&s>=0;)s!==e&&(n=this._pruneAroundCenterTile(n,i,r,s)),s--;n>this.maxSize&&(n=this._pruneAroundCenterTile(n,i,r,e))}_pruneAroundCenterTile(e,i,r,n){const s=this._tileKeysPerLevel[n];if(!s||s.length===0)return e;const{size:o,origin:a}=this._tileInfoView.tileInfo,l=r*o[0],c=r*o[1],u=[0,0],h=[0,0];for(s.sort((f,m)=>(u[0]=a.x+l*(f.col+.5),u[1]=a.y-c*(f.row+.5),h[0]=a.x+l*(m.col+.5),h[1]=a.y-c*(m.row+.5),$u(u,i)-$u(h,i)));s.length>0;){const f=s.pop();if(this._removeTile(f.id),--e===this.maxSize)break}return e}_removeTile(e){const i=this._tilePerId.get(e);this._removedFunc&&i&&this._removedFunc(i),aJ(this._tilePerId,e)}};function aJ(t,e){t.delete(e)}const Dg=new Ev(0,0,0,0),Kd=new Map,Ng=[],W3=[];let i_t=class{constructor(e){this._previousScale=Number.POSITIVE_INFINITY,this.cachePolicy="keep",this.coveragePolicy="closest",this.resampling=!0,this.tileIndex=new Map,this.tiles=[],this.buffer=192,this.acquireTile=e.acquireTile,this.releaseTile=e.releaseTile,this.tileInfoView=e.tileInfoView,e.resampling!=null&&(this.resampling=e.resampling),e.cachePolicy&&(this.cachePolicy=e.cachePolicy),e.coveragePolicy&&(this.coveragePolicy=e.coveragePolicy),e.buffer!=null&&(this.buffer=e.buffer),e.cacheSize&&(this._tileCache=new H3e(e.cacheSize,this.tileInfoView,i=>{this.releaseTile(i)}))}destroy(){this.tileIndex.clear()}update(e){var b,w;const{resampling:i,tileIndex:r}=this,{scale:n,center:s,resolution:o}=e.state,{minScale:a,maxScale:l}=this.tileInfoView,c=!e.stationary&&n>this._previousScale;if(this._previousScale=n,!i&&(n>a||n<l))return this.tiles.length=0,void this.clear();const u=this.tileInfoView.getTileCoverage(e.state,this.buffer,this.resampling,this.coveragePolicy);if(!u)return this.tiles.length=0,void this.clear();const{spans:h,lodInfo:f}=u,{level:m}=f;this.tiles.length=0,r.forEach(x=>x.visible=!0);let g=0,y=0;if(h.length>0)for(const{row:x,colFrom:S,colTo:I}of h)for(let T=S;T<=I;T++){g++;const C=Dg.set(m,x,f.normalizeCol(T),f.getWorldForColumn(T)).id;let E=r.get(C);if(E)E.isReady?(Kd.set(C,E),y++):c||this._addParentTile(C,Kd);else{if((b=this._tileCache)!=null&&b.has(C)){if(E=this._tileCache.pop(C),this.tileIndex.set(C,E),E.isReady){Kd.set(C,E),y++;continue}}else E=this.acquireTile(Dg),this.tileIndex.set(C,E);c||this._addParentTile(C,Kd)}}const v=y===g;for(const[x,S]of r){if(Kd.has(x))continue;Dg.set(x);const I=this.tileInfoView.intersects(u,Dg),T=this.cachePolicy==="purge"?Dg.level!==m:Dg.level>m;!I||!c&&v?!T&&I||Ng.push(S):S.isReady?T&&this.cachePolicy==="purge"&&this._hasReadyAncestor(Dg,m)?Ng.push(S):W3.push(S):T&&Ng.push(S)}for(const x of W3)x.isReady&&Kd.set(x.key.id,x);for(const x of Ng)this._tileCache?this._tileCache.add(x):this.releaseTile(x),r.delete(x.key.id);for(const x of Kd.values())this.tiles.push(x);for(const x of r.values())Kd.has(x.key.id)||(x.visible=!1);(w=this._tileCache)==null||w.prune(m,s,o),dT.pool.release(u),W3.length=0,Ng.length=0,Kd.clear()}clear(){const{tileIndex:e}=this;for(const i of e.values())this.releaseTile(i);e.clear()}refresh(e){var i;for(const r of this.tileIndex.values())this.tiles.includes(r)?e(r):Ng.push(r);for(const r of Ng)this.releaseTile(r),this.tileIndex.delete(r.key.id);(i=this._tileCache)==null||i.clear()}updateCacheSize(e){this._tileCache&&(this._tileCache.maxSize=e)}_addParentTile(e,i){var s;let r=e,n=null;for(;r=this.tileInfoView.getTileParentId(r),r;)if(this.tileIndex.has(r)){if(n=this.tileIndex.get(r),n==null?void 0:n.isReady){i.has(n.key.id)||i.set(n.key.id,n);break}}else if((s=this._tileCache)!=null&&s.has(r)&&(n=this._tileCache.pop(r),this.tileIndex.set(r,n),n==null?void 0:n.isReady)){i.has(n.key.id)||i.set(n.key.id,n);break}}_hasReadyAncestor(e,i){const r=al();this.tileInfoView.getTileBounds(r,e,!0);for(const n of this.tileIndex.values())if(n.isReady&&n.key.level>=i&&n.key.level<e.level){const s=al();if(this.tileInfoView.getTileBounds(s,n.key,!0),XD(s,r))return!0}return!1}};function mP(){const t=new Float32Array(6);return t[0]=1,t[3]=1,t}function q3e(t){const e=new Float32Array(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function W3e(t,e,i,r,n,s){const o=new Float32Array(6);return o[0]=t,o[1]=e,o[2]=i,o[3]=r,o[4]=n,o[5]=s,o}function J3e(t,e){return new Float32Array(t,e,6)}function Mue(t,e,i,r){const n=e[r],s=e[r+1];t[r]=i[0]*n+i[2]*s+i[4],t[r+1]=i[1]*n+i[3]*s+i[5]}function Z3e(t,e,i,r=0,n=0,s=2){const o=n||e.length/s;for(let a=r;a<o;a++)Mue(t,e,i,a*s)}Object.freeze(Object.defineProperty({__proto__:null,clone:q3e,create:mP,createView:J3e,fromValues:W3e,transform:Mue,transformMany:Z3e},Symbol.toStringTag,{value:"Module"}));function Y3e(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function K3e(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function $ue(t,e,i,r,n,s,o,a,l,c){return t[0]=e,t[1]=i,t[2]=r,t[3]=n,t[4]=s,t[5]=o,t[6]=a,t[7]=l,t[8]=c,t}function Aue(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function X3e(t,e){if(t===e){const i=e[1],r=e[2],n=e[5];t[1]=e[3],t[2]=e[6],t[3]=i,t[5]=e[7],t[6]=r,t[7]=n}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function Q3e(t,e){const i=e[0],r=e[1],n=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=u*o-a*c,f=-u*s+a*l,m=c*s-o*l;let g=i*h+r*f+n*m;return g?(g=1/g,t[0]=h*g,t[1]=(-u*r+n*c)*g,t[2]=(a*r-n*o)*g,t[3]=f*g,t[4]=(u*i-n*l)*g,t[5]=(-a*i+n*s)*g,t[6]=m*g,t[7]=(-c*i+r*l)*g,t[8]=(o*i-r*s)*g,t):null}function e5e(t,e){const i=e[0],r=e[1],n=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8];return t[0]=o*u-a*c,t[1]=n*c-r*u,t[2]=r*a-n*o,t[3]=a*l-s*u,t[4]=i*u-n*l,t[5]=n*s-i*a,t[6]=s*c-o*l,t[7]=r*l-i*c,t[8]=i*o-r*s,t}function t5e(t){const e=t[0],i=t[1],r=t[2],n=t[3],s=t[4],o=t[5],a=t[6],l=t[7],c=t[8];return e*(c*s-o*l)+i*(-c*n+o*a)+r*(l*n-s*a)}function JU(t,e,i){const r=e[0],n=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],f=i[0],m=i[1],g=i[2],y=i[3],v=i[4],b=i[5],w=i[6],x=i[7],S=i[8];return t[0]=f*r+m*o+g*c,t[1]=f*n+m*a+g*u,t[2]=f*s+m*l+g*h,t[3]=y*r+v*o+b*c,t[4]=y*n+v*a+b*u,t[5]=y*s+v*l+b*h,t[6]=w*r+x*o+S*c,t[7]=w*n+x*a+S*u,t[8]=w*s+x*l+S*h,t}function W4(t,e,i){const r=e[0],n=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],f=i[0],m=i[1];return t[0]=r,t[1]=n,t[2]=s,t[3]=o,t[4]=a,t[5]=l,t[6]=f*r+m*o+c,t[7]=f*n+m*a+u,t[8]=f*s+m*l+h,t}function kue(t,e,i){const r=e[0],n=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],f=Math.sin(i),m=Math.cos(i);return t[0]=m*r+f*o,t[1]=m*n+f*a,t[2]=m*s+f*l,t[3]=m*o-f*r,t[4]=m*a-f*n,t[5]=m*l-f*s,t[6]=c,t[7]=u,t[8]=h,t}function i5e(t,e,i){const r=i[0],n=i[1],s=i[2];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=n*e[3],t[4]=n*e[4],t[5]=n*e[5],t[6]=s*e[6],t[7]=s*e[7],t[8]=s*e[8],t}function r5e(t,e,i){const r=i[0],n=i[1];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=n*e[3],t[4]=n*e[4],t[5]=n*e[5],t}function n5e(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t}function s5e(t,e){const i=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=i,t[2]=0,t[3]=-i,t[4]=r,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function o5e(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function a5e(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t}function l5e(t,e){const i=e[0],r=e[1],n=e[2],s=e[3],o=i+i,a=r+r,l=n+n,c=i*o,u=r*o,h=r*a,f=n*o,m=n*a,g=n*l,y=s*o,v=s*a,b=s*l;return t[0]=1-h-g,t[3]=u-b,t[6]=f+v,t[1]=u+b,t[4]=1-c-g,t[7]=m-y,t[2]=f-v,t[5]=m+y,t[8]=1-c-h,t}function Pue(t,e){const i=e[0],r=e[1],n=e[2],s=e[4],o=e[5],a=e[6],l=e[8],c=e[9],u=e[10],h=u*o-a*c,f=-u*s+a*l,m=c*s-o*l,g=i*h+r*f+n*m;if(!g)return null;const y=1/g;return t[0]=h*y,t[1]=(-u*r+n*c)*y,t[2]=(a*r-n*o)*y,t[3]=f*y,t[4]=(u*i-n*l)*y,t[5]=(-a*i+n*s)*y,t[6]=m*y,t[7]=(-c*i+r*l)*y,t[8]=(o*i-r*s)*y,t}function c5e(t,e){const i=e[0],r=e[1],n=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=e[9],f=e[10],m=e[11],g=e[12],y=e[13],v=e[14],b=e[15],w=i*a-r*o,x=i*l-n*o,S=i*c-s*o,I=r*l-n*a,T=r*c-s*a,C=n*c-s*l,E=u*y-h*g,$=u*v-f*g,P=u*b-m*g,k=h*v-f*y,L=h*b-m*y,F=f*b-m*v;let V=w*F-x*L+S*k+I*P-T*$+C*E;return V?(V=1/V,t[0]=(a*F-l*L+c*k)*V,t[1]=(l*P-o*F-c*$)*V,t[2]=(o*L-a*P+c*E)*V,t[3]=(n*L-r*F-s*k)*V,t[4]=(i*F-n*P+s*$)*V,t[5]=(r*P-i*L-s*E)*V,t[6]=(y*C-v*T+b*I)*V,t[7]=(v*S-g*C-b*x)*V,t[8]=(g*T-y*S+b*w)*V,t):null}function u5e(t,e,i){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/i,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function d5e(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function h5e(t){return Math.sqrt(t[0]**2+t[1]**2+t[2]**2+t[3]**2+t[4]**2+t[5]**2+t[6]**2+t[7]**2+t[8]**2)}function p5e(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t[4]=e[4]+i[4],t[5]=e[5]+i[5],t[6]=e[6]+i[6],t[7]=e[7]+i[7],t[8]=e[8]+i[8],t}function Oue(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t[4]=e[4]-i[4],t[5]=e[5]-i[5],t[6]=e[6]-i[6],t[7]=e[7]-i[7],t[8]=e[8]-i[8],t}function f5e(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*i,t}function m5e(t,e,i,r){return t[0]=e[0]+i[0]*r,t[1]=e[1]+i[1]*r,t[2]=e[2]+i[2]*r,t[3]=e[3]+i[3]*r,t[4]=e[4]+i[4]*r,t[5]=e[5]+i[5]*r,t[6]=e[6]+i[6]*r,t[7]=e[7]+i[7]*r,t[8]=e[8]+i[8]*r,t}function g5e(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]}function y5e(t,e){const i=t[0],r=t[1],n=t[2],s=t[3],o=t[4],a=t[5],l=t[6],c=t[7],u=t[8],h=e[0],f=e[1],m=e[2],g=e[3],y=e[4],v=e[5],b=e[6],w=e[7],x=e[8],S=Bo();return Math.abs(i-h)<=S*Math.max(1,Math.abs(i),Math.abs(h))&&Math.abs(r-f)<=S*Math.max(1,Math.abs(r),Math.abs(f))&&Math.abs(n-m)<=S*Math.max(1,Math.abs(n),Math.abs(m))&&Math.abs(s-g)<=S*Math.max(1,Math.abs(s),Math.abs(g))&&Math.abs(o-y)<=S*Math.max(1,Math.abs(o),Math.abs(y))&&Math.abs(a-v)<=S*Math.max(1,Math.abs(a),Math.abs(v))&&Math.abs(l-b)<=S*Math.max(1,Math.abs(l),Math.abs(b))&&Math.abs(c-w)<=S*Math.max(1,Math.abs(c),Math.abs(w))&&Math.abs(u-x)<=S*Math.max(1,Math.abs(u),Math.abs(x))}function v5e(t){const e=Bo(),i=t[0],r=t[1],n=t[2],s=t[3],o=t[4],a=t[5],l=t[6],c=t[7],u=t[8];return Math.abs(1-(i*i+s*s+l*l))<=e&&Math.abs(1-(r*r+o*o+c*c))<=e&&Math.abs(1-(n*n+a*a+u*u))<=e}const _5e=JU,b5e=Oue;Object.freeze(Object.defineProperty({__proto__:null,add:p5e,adjoint:e5e,copy:K3e,determinant:t5e,equals:y5e,exactEquals:g5e,frob:h5e,fromMat2d:a5e,fromMat4:Y3e,fromQuat:l5e,fromRotation:s5e,fromScaling:o5e,fromTranslation:n5e,identity:Aue,invert:Q3e,isOrthoNormal:v5e,mul:_5e,multiply:JU,multiplyScalar:f5e,multiplyScalarAndAdd:m5e,normalFromMat4:c5e,normalFromMat4Legacy:Pue,projection:u5e,rotate:kue,scale:i5e,scaleByVec2:r5e,set:$ue,str:d5e,sub:b5e,subtract:Oue,translate:W4,transpose:X3e},Symbol.toStringTag,{value:"Module"}));function sA(){const t=new Float32Array(9);return t[0]=1,t[4]=1,t[8]=1,t}function w5e(t){const e=new Float32Array(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function x5e(t,e,i,r,n,s,o,a,l){const c=new Float32Array(9);return c[0]=t,c[1]=e,c[2]=i,c[3]=r,c[4]=n,c[5]=s,c[6]=o,c[7]=a,c[8]=l,c}function S5e(t,e){return new Float32Array(t,e,9)}Object.freeze(Object.defineProperty({__proto__:null,clone:w5e,create:sA,createView:S5e,fromValues:x5e},Symbol.toStringTag,{value:"Module"}));function Lue(){return new Float32Array(2)}function I5e(t){const e=new Float32Array(2);return e[0]=t[0],e[1]=t[1],e}function p1(t,e){const i=new Float32Array(2);return i[0]=t,i[1]=e,i}function T5e(t,e){return new Float32Array(t,e,2)}function Rue(){return Lue()}function Fue(){return p1(1,1)}function Due(){return p1(1,0)}function Nue(){return p1(0,1)}const C5e=Rue(),E5e=Fue(),M5e=Due(),$5e=Nue();Object.freeze(Object.defineProperty({__proto__:null,ONES:E5e,UNIT_X:M5e,UNIT_Y:$5e,ZEROS:C5e,clone:I5e,create:Lue,createView:T5e,fromValues:p1,ones:Fue,unitX:Due,unitY:Nue,zeros:Rue},Symbol.toStringTag,{value:"Module"}));function A5e(t){return t instanceof Float32Array&&t.length>=2}function k5e(t){return Array.isArray(t)&&t.length>=2}function J3(t){return A5e(t)||k5e(t)}var J4;const Xd=[0,0];let Ef=J4=class extends te{constructor(t){super(t),this._viewpoint2D={center:Gt(),rotation:0,scale:0,spatialReference:void 0},this.center=[0,0],this.extent=new Re,this.id=0,this.inverseTransform=Xm(),this.resolution=0,this.rotation=0,this.scale=0,this.transform=Xm(),this.transformNoRotation=Xm(),this.displayMat3=sA(),this.displayViewMat3=sA(),this.viewMat3=sA(),this.viewMat2d=mP(),this.worldScreenWidth=0,this.size=[0,0]}set pixelRatio(t){this._set("pixelRatio",t),this._update()}set size(t){this._set("size",t),this._update()}set viewpoint(t){if(t){const e=this._viewpoint2D,i=t.targetGeometry;e.center[0]=i.x,e.center[1]=i.y,e.rotation=t.rotation,e.scale=t.scale,e.spatialReference=i.spatialReference}this._update()}copy(t){const e=this.size,i=this.viewpoint;return i&&e?(this.viewpoint=Pu(i,t.viewpoint),this._set("size",uT(e,t.size))):(this.viewpoint=t.viewpoint.clone(),this._set("size",[t.size[0],t.size[1]])),this._set("pixelRatio",t.pixelRatio),this}clone(){return new J4({size:this.size,viewpoint:this.viewpoint.clone(),pixelRatio:this.pixelRatio})}toMap(t,e,i){return J3(e)?_d(t,e,this.inverseTransform):(Xd[0]=e,Xd[1]=i,_d(t,Xd,this.inverseTransform))}toScreen(t,e,i){return J3(e)?_d(t,e,this.transform):(Xd[0]=e,Xd[1]=i,_d(t,Xd,this.transform))}toScreenNoRotation(t,e,i){return J3(e)?_d(t,e,this.transformNoRotation):(Xd[0]=e,Xd[1]=i,_d(t,Xd,this.transformNoRotation))}getScreenTransform(t,e){const{center:i}=this._viewpoint2D,r=this._get("pixelRatio")||1,n=this._get("size");return HU(t,i,n,e,0,r),t}_update(){const{center:t,spatialReference:e,scale:i,rotation:r}=this._viewpoint2D,n=this._get("pixelRatio")||1,s=this._get("size"),o=new Pd({targetGeometry:new fe(t[0],t[1],e),scale:i,rotation:r});if(this._set("viewpoint",o),!s||!e||!i)return;this.resolution=X1(o),this.rotation=r,this.scale=i,this.spatialReference=e,uT(this.center,t);const a=s[0]!==0?2/s[0]:0,l=s[1]!==0?-2/s[1]:0;$ue(this.displayMat3,a,0,0,0,l,0,-1,1,1);const c=Aue(this.viewMat3),u=p1(s[0]/2,s[1]/2),h=p1(-s[0]/2,-s[1]/2),f=EB(r);W4(c,c,u),kue(c,c,f),W4(c,c,h),JU(this.displayViewMat3,this.displayMat3,c);const m=zU(this.viewMat2d,u);return xC(m,m,f),d1(m,m,h),g3e(this.extent,o,s),qU(this.transform,o,s,n),VU(this.inverseTransform,this.transform),S3e(this.transformNoRotation,o,s,n),this.worldScreenWidth=T3e(this.spatialReference,this.resolution),this._set("id",this.id+1),this}};d([p({readOnly:!0})],Ef.prototype,"id",void 0),d([p({value:1,json:{write:!0}})],Ef.prototype,"pixelRatio",null),d([p({json:{write:!0}})],Ef.prototype,"size",null),d([p()],Ef.prototype,"spatialReference",void 0),d([p({type:Pd,json:{write:!0}})],Ef.prototype,"viewpoint",null),Ef=J4=d([A("esri.views.2d.ViewState")],Ef);const lJ=Ef;var Z4,Y4;let Bh=Z4=class extends he{constructor(){super(...arguments),this.left=0,this.top=0,this.right=0,this.bottom=0}clone(){return new Z4({left:this.left,top:this.top,right:this.right,bottom:this.bottom})}};d([p()],Bh.prototype,"left",void 0),d([p()],Bh.prototype,"top",void 0),d([p()],Bh.prototype,"right",void 0),d([p()],Bh.prototype,"bottom",void 0),Bh=Z4=d([A("esri.views.2d.PaddedViewState.Padding")],Bh);let sb=Y4=class extends lJ{constructor(...t){super(...t),this.paddedViewState=new lJ,this._updateContent=(()=>{const e=Gt();return()=>{const i=this._get("size"),r=this._get("padding");if(!i||!r)return;const n=this.paddedViewState;cs(e,r.left+r.right,r.top+r.bottom),$n(e,i,e),uT(n.size,e);const s=n.viewpoint;s&&(this.viewpoint=s)}})(),this.addHandles(J(()=>[this.size,this.padding],()=>this._updateContent(),Ca)),this.padding=new Bh,this.size=[0,0]}set padding(t){this._set("padding",t||new Bh)}set viewpoint(t){if(t){const e=t.clone();this.paddedViewState.viewpoint=t,E3e(e,t,this._get("size"),this._get("padding"));const i=this._viewpoint2D,r=e.targetGeometry;i.center[0]=r.x,i.center[1]=r.y,i.rotation=e.rotation,i.scale=e.scale,i.spatialReference=r.spatialReference,this._update()}}clone(){return new Y4({padding:this.padding.clone(),size:this.size.slice(),viewpoint:this.paddedViewState.viewpoint.clone(),pixelRatio:this.pixelRatio})}};d([p()],sb.prototype,"paddedViewState",void 0),d([p({type:Bh})],sb.prototype,"padding",null),d([p()],sb.prototype,"viewpoint",null),sb=Y4=d([A("esri.views.2d.PaddedViewState")],sb);const P5e=sb;let So=class extends he{constructor(e){super(e),this.constraints=null,this.ready=!1,this.resizeAlign="center",this.addHandles([J(()=>{var i;return(i=this.constraints)==null?void 0:i.version},i=>{this.constraints&&i&&this.ready&&(this.state.viewpoint=this.constraints.fit(this.state.paddedViewState.viewpoint))},Ca)])}get center(){if(!this.ready)return this._get("center");const{center:e,spatialReference:i}=this.state.paddedViewState;return this.state.commitProperty("id"),new fe({x:e[0],y:e[1],spatialReference:i})}set center(e){if(e==null)return;if(!this.ready)return void this._set("center",e);let i;try{i=this._project(e,this.state.spatialReference)}catch(n){return void ie.getLogger(this).error(new N("mapview:invalid-center","could not project the value in the view's spatial reference",{input:e,error:n}))}const r=this.viewpoint;U4(r,r,i),this.viewpoint=r}get extent(){return this.ready?(this.state.commitProperty("id"),this.state.paddedViewState.extent.clone()):this._get("extent")}set extent(e){if(e==null)return;if(!e.width||!e.height)return void ie.getLogger(this).error(new N("mapview:invalid-extent","invalid extent size"));if(!this.ready)return this._set("extent",e),this._set("center",void 0),this._set("viewpoint",void 0),this._set("scale",void 0),void this._set("zoom",void 0);let i;try{i=this._project(e,this.state.spatialReference)}catch(n){return void ie.getLogger(this).error(new N("mapview:invalid-extent","could not project the value in the view's spatial reference",{error:n}))}const r=this.viewpoint;y3e(r,r,i,this.state.size,{constraints:this.constraints}),this.viewpoint=r}get padding(){return this.ready?this.state.padding:this._get("padding")}set padding(e){this.ready?(this.state.padding=e,this._set("padding",this.state.padding)):this._set("padding",e)}get resolution(){return this.ready?(this.state.commitProperty("id"),this.state.resolution):0}get rotation(){return this.ready?(this.state.commitProperty("id"),this.state.rotation):this._get("rotation")}set rotation(e){if(isNaN(e))return;if(!this.ready)return void this._set("rotation",e);const i=this.viewpoint;$3e(i,i,e),this.viewpoint=i}get scale(){return this.ready?(this.state.commitProperty("id"),this.state.scale):this._get("scale")}set scale(e){if(!e||isNaN(e))return;if(!this.ready){this._set("scale",e),this._set("zoom",void 0);const r=this._get("extent");return void(r&&(this._set("extent",void 0),this._set("center",r.center)))}const i=this.viewpoint;iJ(i,i,e),this.viewpoint=i}get viewpoint(){return this.ready?this.state.paddedViewState.viewpoint.clone():this._get("viewpoint")}set viewpoint(e){var s;if(e==null)return;if(!this.ready)return this._set("viewpoint",e),this._set("extent",void 0),this._set("center",void 0),this._set("zoom",void 0),void this._set("scale",void 0);let i,r;try{i=this._project(e,this.state.spatialReference),!e.scale||isNaN(e.scale)?r=new N("mapview:invalid-viewpoint",`invalid scale value of ${e.scale}`):e.targetGeometry==null&&(r=new N("mapview:invalid-viewpoint","geometry not defined"))}catch(o){r=new N("mapview:invalid-viewpoint","could not project the value in the view's spatial reference",{error:o})}if(r)return void ie.getLogger(this).error(r);this._scaleBeforeChangingSpatialReference=null;const n=new Pd({targetGeometry:new fe,scale:0,rotation:0});Pu(n,i),(s=this.constraints)==null||s.constrain(n,this.state.paddedViewState.viewpoint),this.state.viewpoint=n,this._set("viewpoint",n)}get zoom(){var e;return this.ready?((e=this.constraints)==null?void 0:e.scaleToZoom(this.scale))??-1:this._get("zoom")}set zoom(e){var n,s;if(!(e>=0))return;if(!this.ready){this._set("zoom",e),this._set("scale",void 0);const o=this._get("extent");return void(o&&(this._set("extent",void 0),this._set("center",o.center)))}const i=((n=this.constraints)==null?void 0:n.zoomToScale(e))??0;if(!i)return void this._set("zoom",-1);const r=this.viewpoint;iJ(r,r,i),this.viewpoint=r,this._set("zoom",((s=this.constraints)==null?void 0:s.scaleToZoom(this.scale))??-1)}getUserStartupOptions(e){if(!e[0]&&!e[1])return{center:void 0,rotation:void 0,scale:void 0};const{padding:i,constraints:r}=this,n=this._get("center"),s=this._get("extent"),o=this._get("scale"),a=this._get("rotation"),l=this._get("viewpoint"),c=this._get("zoom"),u=c!=null&&r!=null&&r.zoomToScale(c)||void 0;let h,f,m;const g=l==null?void 0:l.rotation,y=l==null?void 0:l.targetGeometry;(y==null?void 0:y.type)==="extent"?h=y:(y==null?void 0:y.type)==="point"&&(f=y,m=l==null?void 0:l.scale);const v=s??h;return{center:n??f??(v==null?void 0:v.center),rotation:a??g,scale:(o??u??m??(v&&$w(v,[e[0]-i.left-i.right,e[1]-i.top-i.bottom])))||void 0}}startup(e,i,r,n){var o;const s=e.targetGeometry;try{this._project(e,r)}catch(a){ie.getLogger(this).warn(new ol("mapview:startup-projection-error","projection of initial viewpoint to the view's spatial reference, defaulting to the initial viewpoint.",{center:s.toJSON(),spatialReference:r,error:a})),e.targetGeometry=n||new fe({x:0,y:0,spatialReference:r})}(o=this.constraints)==null||o.fit(e),this._set("state",new P5e({padding:this.padding,size:i,viewpoint:e})),this._set("ready",!0)}teardown(){this._set("ready",!1);const{center:[e,i],spatialReference:r,rotation:n,scale:s}=this.state.paddedViewState,o=new fe({x:e,y:i,spatialReference:r});this._set("viewpoint",null),this._set("extent",null),this._set("center",o),this._set("zoom",-1),this._set("rotation",n),this._set("scale",s),this._set("state",null)}changeSpatialReference(e){var l;const i=this.state.paddedViewState.clone();if(this._scaleBeforeChangingSpatialReference==null)this._scaleBeforeChangingSpatialReference=i.scale;else{const c=i.viewpoint.clone();c.scale=this._scaleBeforeChangingSpatialReference,i.viewpoint=c}const r=i.clone(),[n,s]=i.center;let o=null;try{o=this._project(new fe({x:n,y:s,spatialReference:i.spatialReference}),e)}catch(c){EU()||ie.getLogger(this).warn(new ol("mapview:spatial-reference-change","could not project the view's center to the new spatial reference",{center:o==null?void 0:o.toJSON(),spatialReference:e,error:c}))}o||(o=new fe({x:0,y:0,spatialReference:e}));const a=U4(new Pd({targetGeometry:new fe,scale:0,rotation:0}),i.viewpoint,o);r.viewpoint=a;try{const u=[i.size[0]/2,i.size[1]/2],h=[u[0]+20,u[1]],f=i.toMap([0,0],h),{x:m,y:g}=this._project(new fe({x:f[0],y:f[1],spatialReference:i.spatialReference}),e);f[0]=m,f[1]=g,r.toScreen(f,f);const y=C3e(u,f,h),v=Math.hypot(f[0]-u[0],f[1]-u[1])/20;!Number.isFinite(v)||Math.abs(v)>4?(a.rotation=0,a.targetGeometry=new fe({x:0,y:0,spatialReference:e})):(a.scale*=v,a.scale>ee("mapview-srswitch-adjust-rotation-scale-threshold")?a.rotation=0:a.rotation+=Number.isFinite(y)?y:0)}catch{}(l=this._get("constraints"))==null||l.constrain(a,void 0),this._get("state").viewpoint=a}resize(e,i){var o;if(!this.ready)return;const r=this.state;let n=this.state.paddedViewState.viewpoint;const s=this.state.paddedViewState.size.concat();r.size=[e,i],M3e(n,n,s,this.state.paddedViewState.size,this.resizeAlign),n=((o=this.constraints)==null?void 0:o.constrain(n,void 0))??n,this.state.viewpoint=n}toMap(e){if(!this.ready)return null;const i=[0,0],[r,n]=this.state.toMap(i,[e.x,e.y]),s=this.state.spatialReference;return new fe({x:r,y:n,spatialReference:s})}toScreen(e){if(!this.ready)return null;const i=this._project(e,this.state.spatialReference),r=[i.x,i.y];return this.state.toScreen(r,r),so(r[0],r[1])}_project(e,i){var s;const r=e&&e.targetGeometry||e;if(!i)return e;if(!r)return null;if(i.imageCoordinateSystem||(s=r.spatialReference)!=null&&s.imageCoordinateSystem||Pr(i,r.spatialReference))return e;const n=Ir(r,i);if(!n)throw new N("mapview:projection-not-possible","projecting input geometry to target spatial reference returned a null value",{geometry:r,spatialReference:i});return O5e(e)?(e.targetGeometry=n,e):n}};function O5e(t){return(t==null?void 0:t.declaredClass)==="esri.Viewpoint"}d([p({type:fe})],So.prototype,"center",null),d([p()],So.prototype,"constraints",void 0),d([p({type:Re})],So.prototype,"extent",null),d([p({value:{top:0,right:0,bottom:0,left:0},cast:t=>({top:0,right:0,bottom:0,left:0,...t})})],So.prototype,"padding",null),d([p()],So.prototype,"ready",void 0),d([p()],So.prototype,"resizeAlign",void 0),d([p({readOnly:!0})],So.prototype,"resolution",null),d([p({type:Number})],So.prototype,"rotation",null),d([p({type:Number})],So.prototype,"scale",null),d([p({readOnly:!0})],So.prototype,"state",void 0),d([p({type:Pd})],So.prototype,"viewpoint",null),d([p()],So.prototype,"zoom",null),So=d([A("esri.views.2d.ViewStateManager")],So);function ZU(t,e){switch(e){case"primary":return t.pointerType==="touch"||t.button===0;case"secondary":return t.pointerType!=="touch"&&t.button===2;case"tertiary":return t.pointerType!=="touch"&&t.button===1}}let cJ=class extends Kn{constructor(e,i){super(!0),this._view=e,this.registerIncoming("double-click",i,r=>this._handleDoubleClick(r,i))}_handleDoubleClick(e,i){ZU(e.data,"primary")&&(e.stopPropagation(),i?this._view.mapViewNavigation.zoomOut([e.data.x,e.data.y]):this._view.mapViewNavigation.zoomIn([e.data.x,e.data.y]))}},L5e=class extends Kn{constructor(e,i,r){super(!0),this.view=e,this.pointerType=i,this.registerIncoming("double-tap-drag",r,n=>this._handleDoubleTapDrag(n))}_handleDoubleTapDrag(e){const{data:i}=e,{pointerType:r}=i;if(r!==this.pointerType)return;e.stopPropagation();const{action:n,delta:s}=i,{view:o}=this,{mapViewNavigation:a}=o;switch(n){case"begin":{const{scale:l}=o;this._startScale=l,this._currentScale=l,this._previousDelta=s,a.begin();break}case"update":{if(this._previousDelta.y===s.y)return;this._previousDelta=s;const l=1.015**s.y,c=this._startScale*l,u=c/this._currentScale;a.setViewpointImmediate(u),this._currentScale=c;break}case"end":{const{constraints:l}=o,{effectiveLODs:c,snapToZoom:u}=l;if(!u||!c)return void a.end();const h=l.snapScale(this._currentScale),f=(s.y>0?Math.max(h,l.snapToPreviousScale(this._startScale)):Math.min(h,l.snapToNextScale(this._startScale)))/this._currentScale;a.zoom(f);break}}}},EL=class{constructor(e){this._callbacks=e,this._currentCount=0,this._callbacks.condition||(this._callbacks.condition=()=>!0)}handle(e){const i=e.data,r=i.pointers.size;switch(i.action){case"start":this._currentCount=r,this._emitStart(e);break;case"added":this._emitEnd(this._previousEvent),this._currentCount=r,this._emitStart(e);break;case"update":this._emitUpdate(e);break;case"removed":this._startEvent&&this._emitEnd(this._previousEvent),this._currentCount=r,this._emitStart(e);break;case"end":this._emitEnd(e),this._currentCount=0}this._previousEvent=e}_emitStart(e){var i,r;this._startEvent=e,(r=(i=this._callbacks).condition)!=null&&r.call(i,this._currentCount,e)&&this._callbacks.start(this._currentCount,e,this._startEvent)}_emitUpdate(e){var i,r;(r=(i=this._callbacks).condition)!=null&&r.call(i,this._currentCount,e)&&this._callbacks.update(this._currentCount,e,this._startEvent)}_emitEnd(e){var i,r;(r=(i=this._callbacks).condition)!=null&&r.call(i,this._currentCount,e)&&this._callbacks.end(this._currentCount,e,this._startEvent),this._startEvent=null}},R5e=class extends Kn{constructor(e,i,r){super(!0),this.view=e,this.pointerAction=i,this.registerIncoming("drag",r,n=>this._handleDrag(n)),this.registerIncoming("pointer-down",()=>this.stopMomentumNavigation())}onInstall(e){super.onInstall(e),this._dragEventSeparator=new EL({start:(i,r)=>{this.view.mapViewNavigation.pan.begin(this.view,r.data),r.stopPropagation()},update:(i,r)=>{this.view.mapViewNavigation.pan.update(this.view,r.data),r.stopPropagation()},end:(i,r)=>{this.view.mapViewNavigation.pan.end(this.view,r.data),r.stopPropagation()},condition:(i,r)=>i===1&&ZU(r.data,this.pointerAction)})}_handleDrag(e){const i=this.view.mapViewNavigation;i.pinch.zoomMomentum||i.pinch.rotateMomentum?this.stopMomentumNavigation():this._dragEventSeparator.handle(e)}stopMomentumNavigation(){this.view.mapViewNavigation.pan.stopMomentumNavigation()}},F5e=class extends Kn{constructor(e,i,r){super(!0),this._view=e,this.pointerAction=i;const n=this._view.mapViewNavigation;this._dragEventSeparator=new EL({start:(s,o)=>{n.rotate.begin(this._view,o.data),o.stopPropagation()},update:(s,o)=>{n.rotate.update(this._view,o.data),o.stopPropagation()},end:(s,o)=>{n.rotate.end(),o.stopPropagation()},condition:(s,o)=>s===1&&ZU(o.data,this.pointerAction)}),this.registerIncoming("drag",r,s=>this._dragEventSeparator.handle(s))}};function Ic(t){let e=t*t;return t<0&&(e*=-1),e}function D5e(t){return t.translation[0]=0,t.translation[1]=0,t.translation[2]=0,t.heading=0,t.tilt=0,t}function N5e(t,e,i){const r=i,n=t.state,s=t.device,o=e.tiltDirection==="forward-down"?1:-1,a=1;return s.deviceType==="standard"?(r.translation[0]=Ic(n.axes[0]),r.translation[1]=Ic(n.axes[1]),r.translation[2]=Ic(n.buttons[7])-Ic(n.buttons[6]),r.heading=Ic(n.axes[2]),r.tilt=Ic(n.axes[3])):s.deviceType==="spacemouse"&&(r.translation[0]=1.2*Ic(n.axes[0]),r.translation[1]=1.2*Ic(n.axes[1]),r.translation[2]=2*-Ic(n.axes[2]),r.heading=1.2*Ic(n.axes[5]),r.tilt=1.2*Ic(n.axes[3])),r.tilt*=o,xr(r.translation,r.translation,a),r}function V5e(t){return t.translation[0]===0&&t.translation[1]===0&&t.translation[2]===0&&t.heading===0&&t.tilt===0&&t.zoom===0}let z5e=class extends Kn{constructor(e){super(!0),this._view=e,this._frameTask=null,this._watchHandles=new gs,this._currentDevice=null,this._transformation={translation:[0,0,0],heading:0,tilt:0,zoom:0},this._handle=this.registerIncoming("gamepad",i=>this._handleGamePadEvent(i)),this._handle.pause()}onInstall(e){super.onInstall(e),this._watchHandles.add([J(()=>{var i;return(i=this._view.navigation.gamepad)==null?void 0:i.enabled},i=>{i?(this._handle.resume(),this._frameTask||(this._frameTask=Jw({update:r=>this._frameUpdate(r.deltaTime)}))):(this._handle.pause(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null))},Le)])}onUninstall(){this._watchHandles.removeAll(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null),super.onUninstall()}_handleGamePadEvent(e){const i=this._view.navigation.gamepad.device;i&&e.data.device!==i||this._currentDevice&&this._currentDevice!==e.data.device||(e.data.action==="end"?(this._currentDevice=null,D5e(this._transformation)):(this._currentDevice=e.data.device,N5e(e.data,this._view.navigation.gamepad,this._transformation)))}_frameUpdate(e){const i=this._transformation;if(V5e(i))return;const r=this._view.viewpoint.clone(),n=this._view.navigation.gamepad.velocityFactor,s=B5e*n*e;CL(r,r,[i.translation[0]*s,-i.translation[1]*s]);const o=1+i.translation[2]*U5e*e,a=this._view.constraints.rotationEnabled?-i.heading*j5e*e:0,l=this._view.size,c=[l[0]/2,l[1]];bue(r,r,o,a,c,l);const u=this._view.constraints.constrain(r,this._view.viewpoint);this._view.viewpoint=u}};const j5e=.06,B5e=.7,U5e=6e-4;let G5e=class extends Kn{constructor(e,i,r){super(!0),this.view=e,this.keys=i,this._pressed=!1,this._keyMap={[i.left]:"left",[i.right]:"right",[i.up]:"up",[i.down]:"down"},this.registerIncoming("key-down",r,n=>this._handleKeyDown(n)),this.registerIncoming("key-up",r,n=>this._handleKeyUp(n)),this.registerIncoming("blur",r,()=>this._handleBlur())}_handleKeyDown(e){e.data.repeat||this._handleKey(e,!0)}_handleKeyUp(e){this._handleKey(e,!1)}_handleBlur(){this._pressed&&(this._pressed=!1,this.view.mapViewNavigation.stop())}_handleKey(e,i){const r=this._keyMap[e.data.key];if(this._pressed=r!=null,this._pressed){if(i)switch(this.view.mapViewNavigation.begin(),r){case"left":this.view.mapViewNavigation.continousPanLeft();break;case"right":this.view.mapViewNavigation.continousPanRight();break;case"up":this.view.mapViewNavigation.continousPanUp();break;case"down":this.view.mapViewNavigation.continousPanDown()}else this._pressed=!1,this.view.mapViewNavigation.stop();e.stopPropagation()}}},H5e=class extends Kn{constructor(e,i,r){super(!0),this.view=e,this.keys=i,this._pressed=!1,this._keyToDirection={[i.clockwiseOption1]:"clockwise",[i.clockwiseOption2]:"clockwise",[i.counterClockwiseOption1]:"counterClockwise",[i.counterClockwiseOption2]:"counterClockwise",[i.resetOption1]:"reset",[i.resetOption2]:"reset"},this.registerIncoming("key-down",r,n=>this._handleKeyDown(n)),this.registerIncoming("key-up",r,n=>this._handleKeyUp(n)),this.registerIncoming("blur",r,()=>this._handleBlur())}_handleKeyDown(e){e.data.repeat||this._handleKey(e,!0)}_handleKeyUp(e){this._handleKey(e,!1)}_handleBlur(){this._pressed&&(this._pressed=!1,this.view.mapViewNavigation.stop())}_handleKey(e,i){const r=e.modifiers;if(r.size>0&&!r.has("Shift")||!this.view.constraints.rotationEnabled)return;const n=this._keyToDirection[e.data.key];if(this._pressed=n!=null,this._pressed){if(i)switch(this.view.mapViewNavigation.begin(),n){case"clockwise":this.view.mapViewNavigation.continousRotateClockwise();break;case"counterClockwise":this.view.mapViewNavigation.continousRotateCounterclockwise();break;case"reset":this.view.mapViewNavigation.resetRotation()}else this._pressed=!1,this.view.mapViewNavigation.stop();e.stopPropagation()}}};var cw;(function(t){t[t.IN=0]="IN",t[t.OUT=1]="OUT"})(cw||(cw={}));let q5e=class extends Kn{constructor(e,i,r){super(!0),this.view=e,this.keys=i,this._keysToZoomAction={},this.registerIncoming("key-down",r,n=>this._handleKeyDown(n)),i.zoomIn.forEach(n=>this._keysToZoomAction[n]=cw.IN),i.zoomOut.forEach(n=>this._keysToZoomAction[n]=cw.OUT)}_handleKeyDown(e){this._handleKey(e)}_handleKey(e){const i=e.modifiers;if(i.size>0&&!i.has("Shift"))return;const{key:r}=e.data;if(!(r in this._keysToZoomAction))return;const n=this._keysToZoomAction[r],{mapViewNavigation:s}=this.view;let o=null;switch(n){case cw.IN:o=s.zoomIn();break;case cw.OUT:o=s.zoomOut();break;default:return}s.begin(),o.then(()=>s.end()),e.stopPropagation()}};const W5e=.6;let J5e=class extends Kn{constructor(e,i){super(!0),this._view=e,this._canZoom=!0,this.registerIncoming("mouse-wheel",i,r=>this._handleMouseWheel(r))}_handleMouseWheel(e){if(!this._view.navigation.mouseWheelZoomEnabled||(e.preventDefault(),e.stopPropagation(),!this._canZoom))return;const i=this._view.mapViewNavigation,{x:r,y:n,deltaY:s}=e.data,o=1/W5e**(1/60*s),a=i.zoom(o,[r,n]);a&&(this._canZoom=!1,a.catch(()=>{}).then(()=>{this._canZoom=!0,i.end()}))}},Z5e=class extends Kn{constructor(e){super(!0),this.view=e,this.registerIncoming("drag",r=>this._handleDrag(r)),this.registerIncoming("pointer-down",()=>this._stopMomentumNavigation());const i=this.view.mapViewNavigation;this._dragEventSeparator=new EL({start:(r,n)=>{i.pinch.begin(this.view,n.data),n.stopPropagation()},update:(r,n)=>{i.pinch.update(this.view,n.data),n.stopPropagation()},end:(r,n)=>{i.pinch.end(this.view),n.stopPropagation()},condition:r=>r>=2})}_handleDrag(e){this._dragEventSeparator.handle(e)}_stopMomentumNavigation(){this.view.mapViewNavigation.pinch.stopMomentumNavigation()}};function uJ(t){const e=t.native;return e?{buttons:e.buttons.map(i=>i.pressed?i.value||1:0),axes:e.axes.map(i=>X5e(i,t.axisThreshold))}:{buttons:[],axes:[]}}function Y5e(t,e){if(t.axes.length!==e.axes.length||t.buttons.length!==e.buttons.length)return!1;for(let i=0;i<t.axes.length;i++)if(t.axes[i]!==e.axes[i])return!1;for(let i=0;i<t.buttons.length;i++)if(t.buttons[i]!==e.buttons[i])return!1;return!0}function K5e(t){for(let e=0;e<t.axes.length;e++)if(t.axes[e]!==0)return!1;for(let e=0;e<t.buttons.length;e++)if(t.buttons[e]!==0)return!1;return!0}function X5e(t,e){const i=Math.abs(t);return i<e?0:Math.sign(t)*(i-e)/(1-e)}let Q5e=class{constructor(e,i){this._element=e,this._input=i,this._hasEventListeners=!1,this._onConnectGamepad=s=>{this._connectGamepad(s.gamepad)},this._onDisconnectGamepad=s=>{const o=s.gamepad,a=o.index,l=this._inputDevices[a];l&&(this._emitGamepadEvent(o,uJ(l),!1),this._inputDevices.splice(a,1),this._latestUpdate.splice(a,1),this._input.gamepad.devices.remove(l),this.ensurePollingState())},this._frameTask=null,this._latestUpdate=new Array,this._inputDevices=new Array,this._callback=null;const r="getGamepads"in window.navigator,n=window.isSecureContext;this.supported=r&&n,this.supported&&(this._forEachGamepad(s=>this._connectGamepad(s)),window.addEventListener("gamepadconnected",this._onConnectGamepad),window.addEventListener("gamepaddisconnected",this._onDisconnectGamepad),this.ensurePollingState())}destroy(){this.hasEventListeners=!1,this.supported&&(window.removeEventListener("gamepadconnected",this._onConnectGamepad),window.removeEventListener("gamepaddisconnected",this._onDisconnectGamepad))}set hasEventListeners(e){this._hasEventListeners!==e&&(this._hasEventListeners=e,this.ensurePollingState())}get _eventsEnabled(){return this.supported&&this._inputDevices.length>0&&this._hasEventListeners}set onEvent(e){this._callback=e}_connectGamepad(e){const i=new FU(e);i.deviceType!=="unknown"&&(this._inputDevices[e.index]=i,this._input.gamepad.devices.add(i)),this.ensurePollingState()}ensurePollingState(){this._eventsEnabled?this._startPolling():this._stopPolling()}_startPolling(){this._frameTask==null&&(this._frameTask=Jw({update:()=>this._readGamepadState()}))}_stopPolling(){this._frameTask!=null&&(this._frameTask.remove(),this._frameTask=null,this._latestUpdate=new Array)}_readGamepadState(){const e=document.hasFocus(),i=this._element.contains(document.activeElement),r=this._input.gamepad.enabledFocusMode==="document"&&!e||this._input.gamepad.enabledFocusMode==="view"&&!i;this._forEachGamepad(n=>{const s=this._inputDevices[n.index];if(!s)return;const o=this._latestUpdate[n.index],a=uJ(s),l=r||K5e(a);o&&(o.timestamp===n.timestamp||!o.active&&l||Y5e(o.state,a))||this._emitGamepadEvent(n,a,!l)})}_forEachGamepad(e){const i=window.navigator.getGamepads();for(let r=0;r<i.length;r++){const n=i[r];this._validate(n)&&e(n)}}_emitGamepadEvent(e,i,r){const n=this._latestUpdate[e.index],s=n&&n.active;if(!s&&!r)return;const o=!s&&r?"start":s&&r?"update":"end";this._latestUpdate[e.index]={timestamp:e.timestamp,state:i,active:r},this._callback&&this._callback({device:this._inputDevices[e.index],state:i,action:o})}_validate(e){if(!e||!e.connected)return!1;for(let i=0;i<e.axes.length;i++)if(isNaN(e.axes[i]))return!1;return!0}};const dJ=ee("edge"),eFe=ee("chrome"),tFe=ee("ff"),iFe=ee("safari"),hJ="esri-view-surface",m_={touchNone:`${hJ}--touch-none`,touchPan:`${hJ}--touch-pan`};let Vue=class zue{constructor(e,i){this._input=i,this._active={},this._callback=()=>{},this._activePointerCaptures=new Set,this._keyDownState=new Set,this._eventId=1,this._browserTouchPanningEnabled=!1,this._element=e,e.getAttribute("tabindex")||e.setAttribute("tabindex","0"),this._eventHandlers={"key-down":this._handleKey,"key-up":this._handleKey,"pointer-down":this._handlePointer,"pointer-move":this._handlePointerPreventDefault,"pointer-up":this._handlePointerPreventDefault,"pointer-enter":this._handlePointer,"pointer-leave":this._handlePointer,"pointer-cancel":this._handlePointer,"mouse-wheel":this._handleMouseWheel,"pointer-capture-lost":this._handlePointerCaptureLost},this._updateTouchAction(),this._element.addEventListener("keydown",this._preventAltKeyDefault),this._gamepadSource=new Q5e(e,this._input),this._gamepadSource.onEvent=r=>this._callback("gamepad",r)}destroy(){this._callback=()=>{},this.activeEvents=null,this._activePointerCaptures.forEach(e=>{this._releasePointerCaptureSafe(e)}),this._gamepadSource=je(this._gamepadSource),this._activePointerCaptures=null,this._removeTouchAction(),this._element.removeEventListener("keydown",this._preventAltKeyDefault)}get browserTouchPanningEnabled(){return this._browserTouchPanningEnabled}set browserTouchPanningEnabled(e){this._browserTouchPanningEnabled=e,this._updateTouchAction(),this._updateTouchEventHandling()}set onEventReceived(e){this._callback=e}set activeEvents(e){for(const i in this._active)if(!e||!e.has(i)){const r=this._active[i];this._element.removeEventListener(Z3[i],r),delete this._active[i]}e&&e.forEach(i=>{if(!this._active[i]&&Z3[i]){const r=(this._eventHandlers[i]||this._handleDefault).bind(this,i);this._element.addEventListener(Z3[i],r),this._active[i]=r}}),this._gamepadSource.hasEventListeners=(e==null?void 0:e.has("gamepad"))??!1}setPointerCapture(e,i){i?this._setPointerCatpureSafe(e.pointerId):(this._releasePointerCaptureSafe(e.pointerId),this._activePointerCaptures.delete(e.pointerId))}_updateTouchAction(){this._element.classList.remove(this._browserTouchPanningEnabled?m_.touchNone:m_.touchPan),this._element.classList.add(this._browserTouchPanningEnabled?m_.touchPan:m_.touchNone)}_updateTouchEventHandling(){this._browserTouchPanningEnabled?this._element.addEventListener("touchmove",this._preventMultiTouchPanning):this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_removeTouchAction(){this._element.classList.remove(m_.touchNone),this._element.classList.remove(m_.touchPan),this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_setPointerCatpureSafe(e){try{this._element.setPointerCapture(e),this._activePointerCaptures.add(e)}catch{}}_releasePointerCaptureSafe(e){try{if(this._element.hasPointerCapture&&!this._element.hasPointerCapture(e))return;this._element.releasePointerCapture(e)}catch{}}_updateNormalizedPointerLikeEvent(e,i){const r=Uce(this._element,e);return zue.test.disableSubpixelCoordinates&&(r.x=Math.round(r.x),r.y=Math.round(r.y)),i.x=r.x,i.y=r.y,i}_handleKey(e,i){const r=xLe(i);r&&e==="key-up"&&this._keyDownState.delete(r);const n={native:i,key:r,repeat:!!r&&this._keyDownState.has(r)};r&&e==="key-down"&&this._keyDownState.add(n.key),this._callback(e,n)}_handlePointer(e,i){const r=this._updateNormalizedPointerLikeEvent(i,{native:i,x:0,y:0,pointerType:i.pointerType,button:i.button,buttons:i.buttons,eventId:this._eventId++});this._callback(e,r)}_handlePointerPreventDefault(e,i){const r=this._updateNormalizedPointerLikeEvent(i,{native:i,x:0,y:0,pointerType:i.pointerType,button:i.button,buttons:i.buttons,eventId:this._eventId++});i.preventDefault(),this._callback(e,r)}_handleMouseWheel(e,i){let r=i.deltaY;switch(i.deltaMode){case 0:dJ&&(r=r/document.documentElement.clientHeight*600);break;case 1:r*=30;break;case 2:r*=900}dJ?r*=.7:eFe||iFe?r*=.6:tFe&&(r*=1.375);const n=100,s=Math.abs(r);s>n&&(r=r/s*200/(1+Math.exp(-.02*(s-n))));const o=this._updateNormalizedPointerLikeEvent(i,{native:i,x:0,y:0,deltaY:r});this._callback(e,o)}_handlePointerCaptureLost(e,i){this._activePointerCaptures.delete(i.pointerId),this._handleDefault(e,i)}_handleDefault(e,i){const r={native:i};i.preventDefault(),this._callback(e,r)}_preventAltKeyDefault(e){e.key==="Alt"&&e.preventDefault()}_preventMultiTouchPanning(e){e.touches.length>1&&e.preventDefault()}};Vue.test={disableSubpixelCoordinates:!1};const Z3={"key-down":"keydown","key-up":"keyup","pointer-down":"pointerdown","pointer-up":"pointerup","pointer-move":"pointermove","mouse-wheel":"wheel","pointer-capture-got":"gotpointercapture","pointer-capture-lost":"lostpointercapture","context-menu":"contextmenu","pointer-enter":"pointerenter","pointer-leave":"pointerleave","pointer-cancel":"pointercancel",focus:"focus",blur:"blur"};let rFe=class extends Kn{constructor(){super(!0),this.registerIncoming("context-menu",e=>{e.data.native.preventDefault()})}};function YU(t,e){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)}function nFe(t,e){const i=e.x-t.x,r=e.y-t.y;return Math.sqrt(i*i+r*r)}function sFe(t,e){if(e?(e.radius=0,e.center.x=0,e.center.y=0):e={radius:0,center:so()},t.length===0)return e;if(t.length===1)return e.center.x=t[0].x,e.center.y=t[0].y,e;if(t.length===2){const[x,S]=t,[I,T]=[S.x-x.x,S.y-x.y];return e.radius=Math.sqrt(I*I+T*T)/2,e.center.x=(x.x+S.x)/2,e.center.y=(x.y+S.y)/2,e}let i=0,r=0;for(let x=0;x<t.length;x++)i+=t[x].x,r+=t[x].y;i/=t.length,r/=t.length;const n=t.map(x=>x.x-i),s=t.map(x=>x.y-r);let o=0,a=0,l=0,c=0,u=0,h=0,f=0;for(let x=0;x<n.length;x++){const S=n[x],I=s[x],T=S*S,C=I*I;o+=T,a+=C,l+=S*I,c+=T*S,u+=C*I,h+=S*C,f+=I*T}const m=.5*(c+h),g=.5*(u+f),y=o*a-l*l,v=(m*a-g*l)/y,b=(o*g-l*m)/y,w=so(v+i,b+r);return{radius:Math.sqrt(v*v+b*b+(o+a)/t.length),center:w}}function av(t){const{native:e}=t,{pointerId:i,button:r,pointerType:n}=e;return n==="mouse"?`${i}:${r}`:`${n}`}const Xl={maximumDoubleClickDelay:250,maximumDoubleClickDistance:10,maximumDoubleTouchDelay:350,maximumDoubleTouchDistance:35};let oFe=class extends Kn{constructor(e=Xl.maximumDoubleClickDelay,i=Xl.maximumDoubleClickDistance,r=Xl.maximumDoubleTouchDelay,n=Xl.maximumDoubleTouchDistance,s=P1){super(!1),this._maximumDoubleClickDelay=e,this._maximumDoubleClickDistance=i,this._maximumDoubleTouchDelay=r,this._maximumDoubleTouchDistance=n,this._clock=s,this._pointerState=new Map,this._click=this.registerOutgoing("click"),this._doubleClick=this.registerOutgoing("double-click"),this.registerIncoming("immediate-click",this._handleImmediateClick.bind(this)),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this))}onUninstall(){this._pointerState.forEach(e=>e.doubleClickTimer=$i(e.doubleClickTimer))}get hasPendingInputs(){return QT(this._pointerState,e=>e.doubleClickTimer!=null)}_clearDoubleClickTimer(e,i){const r=this._pointerState.get(e);r&&(r.doubleClickTimer=$i(r.doubleClickTimer),i&&this._click.emit(r.event.data,void 0,r.event.modifiers),this._pointerState.delete(e),this.refreshHasPendingInputs())}_doubleClickTimeoutExceeded(e){const i=this._pointerState.get(e);i.pointerDownCount===1&&this._click.emit(i.event.data,void 0,i.event.modifiers),i.doubleClickTimer=null,this._pointerState.delete(e),this.refreshHasPendingInputs()}_getPointerId(e){const{pointerId:i,pointerType:r,button:n}=e.native;return r==="mouse"?`${i}:${n}`:`${r}`}_handleImmediateClick(e){const i=e.data,{pointerType:r}=i.native,n=this._getPointerId(i);if(!this._pointerState.has(n))return void this._startClick(e);const s=this._pointerState.get(n),{data:o,modifiers:a}=s.event,l=r==="touch"?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;YU(o,i)>l?(this._clearDoubleClickTimer(n,!0),this._startClick(e)):(this._clearDoubleClickTimer(n,!1),s.pointerDownCount===2&&this._doubleClick.emit(o,void 0,a))}_handlePointerDown(e){const i=av(e.data),r=this._pointerState.get(i);r&&(r.pointerDownCount+=1)}_startClick(e){const{data:i}=e,{native:{pointerType:r}}=i,n=av(i),s=r==="touch"?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay,o=this._clock.setTimeout(()=>this._doubleClickTimeoutExceeded(n),s),a=1;this._pointerState.set(n,{event:e,doubleClickTimer:o,pointerDownCount:a}),this.refreshHasPendingInputs()}},aFe=class extends Kn{constructor(e=Xl.maximumDoubleClickDelay,i=Xl.maximumDoubleClickDistance,r=Xl.maximumDoubleTouchDelay,n=Xl.maximumDoubleTouchDistance,s=P1){super(!1),this._maximumDoubleClickDelay=e,this._maximumDoubleClickDistance=i,this._maximumDoubleTouchDelay=r,this._maximumDoubleTouchDistance=n,this._clock=s,this._doubleTapDragReady=!1,this._doubleTapDragActive=!1,this._dragStartCenter=so(0,0),this._pointerState=new Map,this._doubleTapDrag=this.registerOutgoing("double-tap-drag"),this._dragEventSeparator=new EL({start:(o,a)=>this._dragStart(o,a),update:(o,a)=>this._dragUpdate(a),end:(o,a)=>this._dragEnd(a)}),this.registerIncoming("drag",o=>this._dragEventSeparator.handle(o)),this.registerIncoming("pointer-down",o=>this._handlePointerDown(o)),this.registerIncoming("pointer-up",()=>this._handlePointerUp())}onUninstall(){this._pointerState.forEach(e=>{e.doubleTapTimeout=$i(e.doubleTapTimeout)})}get hasPendingInputs(){return QT(this._pointerState,e=>e.doubleTapTimeout!=null)}_clearPointerDown(e){const i=this._pointerState.get(e);i&&(i.doubleTapTimeout=$i(i.doubleTapTimeout),this._pointerState.delete(e),this.refreshHasPendingInputs())}_createDoubleTapDragData(e,i,r){const{button:n,buttons:s,pointer:o,pointers:a,pointerType:l,timestamp:c}=r;return{action:e,delta:i,button:n,buttons:s,pointer:o,pointers:a,pointerType:l,timestamp:c}}_dragStart(e,i){if(!this._doubleTapDragReady||e!==1)return;this._doubleTapDragReady=!1,this._doubleTapDragActive=!0;const{data:r,modifiers:n}=i,{center:s}=r;this._dragStartCenter=s;const o=this._createDoubleTapDragData("begin",so(0,0),r);this._doubleTapDrag.emit(o,void 0,n),i.stopPropagation()}_dragUpdate(e){if(!this._doubleTapDragActive)return;const{data:i,modifiers:r}=e,{center:n}=i,s=so(n.x-this._dragStartCenter.x,n.y-this._dragStartCenter.y),o=this._createDoubleTapDragData("update",s,i);this._doubleTapDrag.emit(o,void 0,r),e.stopPropagation()}_dragEnd(e){if(!this._doubleTapDragActive)return;const{data:i,modifiers:r}=e,{center:n}=i,s=so(n.x-this._dragStartCenter.x,n.y-this._dragStartCenter.y),o=this._createDoubleTapDragData("end",s,i);this._doubleTapDrag.emit(o,void 0,r),this._doubleTapDragActive=!1,e.stopPropagation()}_handlePointerDown(e){const{data:i}=e,r=av(i),n=this._pointerState.get(r),{pointerType:s}=i.native;if(n){const o=s==="touch"?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;this._clearPointerDown(r),YU(n.event.data,i)>o?this._storePointerDown(e):this._doubleTapDragReady=!0}else this._storePointerDown(e)}_handlePointerUp(){this._doubleTapDragReady=!1}_storePointerDown(e){const{data:i}=e,{pointerType:r}=i.native,n=av(i),s=r==="touch"?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay,o=this._clock.setTimeout(()=>this._clearPointerDown(n),s);this._pointerState.set(n,{event:e,doubleTapTimeout:o}),this.refreshHasPendingInputs()}},lFe=class extends Kn{constructor(e){super(!1),this._navigationTouch=e,this._startStateModifiers=new Set,this._activePointerMap=new Map,this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._drag=this.registerOutgoing("drag"),this.registerIncoming("pointer-drag",this._handlePointerDrag.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-capture-lost",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-cancel",this._handlePointerUpAndPointerLost.bind(this))}_createPayload(e,i,r,n){return{action:e,pointerType:this._pointerType,button:this._mouseButton,buttons:i.buttons,timestamp:n,pointers:cFe(this._activePointerMap),pointer:i,angle:r.angle,radius:r.radius,center:r.center}}_addPointer(e){const i=e.native.pointerId,r=zE(this._activePointerMap).angle,n={event:e,initialAngle:0,lastAngle:0};this._activePointerMap.set(i,n);const s=oA(n,jue(this._activePointerMap));n.initialAngle=s,n.lastAngle=s,this._updatePointerAngles(r)}_updatePointer(e){if(e&&e.x==null&&e.y==null)return;const i=e.native.pointerId,r=this._activePointerMap.get(i);r?r.event=e:this._addPointer(e)}_removePointer(e){const i=zE(this._activePointerMap).angle;this._activePointerMap.delete(e),this._updatePointerAngles(i)}_updatePointerAngles(e){const i=zE(this._activePointerMap);this._activePointerMap.forEach(r=>{r.initialAngle=oA(r,i)-e,r.lastAngle=oA(r,i)-e})}_emitEvent(e,i,r){const n=zE(this._activePointerMap);this._drag.emit(this._createPayload(e,i,n,r),void 0,this._startStateModifiers)}_handlePointerUpAndPointerLost(e){const i=e.data.native.pointerId,r=e.timestamp;this._activePointerMap.get(i)&&(this._activePointerMap.size===1?(this._updatePointer(e.data),!this._isCurrentDragSuppressed&&this._emitEvent("end",e.data,r),this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._removePointer(i)):(this._removePointer(i),this._emitEvent("removed",e.data,e.timestamp)))}_handlePointerDrag(e){const i=e.data,r=i.currentEvent,n=e.timestamp;switch(i.action){case"start":case"update":this._isDragging?this._activePointerMap.has(r.native.pointerId)?(this._updatePointer(r),!this._isCurrentDragSuppressed&&this._emitEvent("update",r,n)):(this._addPointer(r),this._emitEvent("added",r,n),this._isCurrentDragSuppressed=this._isSuppressed):(this._updatePointer(r),this._pointerType=e.data.startEvent.pointerType,this._mouseButton=e.data.startEvent.button,this._startStateModifiers=e.modifiers,this._isDragging=!0,this._isCurrentDragSuppressed=this._isSuppressed,!this._isCurrentDragSuppressed&&this._emitEvent("start",r,n))}}get _isSuppressed(){return!!this._navigationTouch&&!this._navigationTouch.browserTouchPanEnabled&&this._pointerType==="touch"&&this._activePointerMap.size===1}};function jue(t){const e=[];return t.forEach(i=>{e.push(so(i.event.x,i.event.y))}),sFe(e)}function zE(t){const e=jue(t);let i=0;return t.forEach(r=>{let n=oA(r,e),s=n-r.lastAngle;for(;s>Math.PI;)s-=2*Math.PI;for(;s<-Math.PI;)s+=2*Math.PI;n=r.lastAngle+s,r.lastAngle=n;const o=n-r.initialAngle;i+=o}),i/=t.size||1,{angle:i,radius:e.radius,center:e.center}}function cFe(t){const e=new Map;return t.forEach((i,r)=>e.set(r,i.event)),e}function oA(t,e){const i=t.event,r=i.x-e.center.x,n=i.y-e.center.y;return Math.atan2(n,r)}var pJ;(function(t){t[t.Left=0]="Left",t[t.Middle=1]="Middle",t[t.Right=2]="Right",t[t.Back=3]="Back",t[t.Forward=4]="Forward",t[t.Undefined=-1]="Undefined"})(pJ||(pJ={}));let uFe=class extends Kn{constructor(e=Xl.maximumDoubleClickDelay,i=Xl.maximumDoubleClickDistance,r=Xl.maximumDoubleTouchDelay,n=Xl.maximumDoubleTouchDistance,s=P1){super(!1),this._maximumDoubleClickDelay=e,this._maximumDoubleClickDistance=i,this._maximumDoubleTouchDelay=r,this._maximumDoubleTouchDistance=n,this._clock=s,this._pointerState=new Map,this._immediateDoubleClick=this.registerOutgoing("immediate-double-click"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUp.bind(this))}onUninstall(){this._pointerState.forEach(e=>{e.immediateDoubleClick&&e.immediateDoubleClick.timeoutHandle.remove()}),super.onUninstall()}_handlePointerDown(e){const i=e.data,r=av(i);if(!this._pointerState.has(r)){const n={downButton:i.native.button,immediateDoubleClick:null};this._pointerState.set(r,n),this.startCapturingPointer(i.native)}}_handlePointerUp(e){const i=e.data,r=av(i),n=this._pointerState.get(r);if(n&&n.downButton===i.native.button){const s=n.immediateDoubleClick;if(s){s.timeoutHandle.remove();const o=e.data.native.pointerType==="touch"?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;YU(s,e.data)>o?this._startImmediateDoubleClick(e,n):(this._immediateDoubleClick.emit(e.data,void 0,s.modifiers),this._removeState(i))}else this._startImmediateDoubleClick(e,n)}}_startImmediateDoubleClick(e,i){const r=e.data.native.pointerType==="touch"?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay;i.immediateDoubleClick={x:e.data.x,y:e.data.y,modifiers:e.modifiers,timeoutHandle:this._clock.setTimeout(()=>this._removeState(e.data),r)}}_removeState(e){const i=av(e);this._pointerState.delete(i),this.stopCapturingPointer(e.native),this.refreshHasPendingInputs()}};const Px={maximumClickDelay:300,movementUntilMouseDrag:1.5,movementUntilPenDrag:6,movementUntilTouchDrag:6,holdDelay:500};let dFe=class extends Kn{constructor(e=Px.maximumClickDelay,i=Px.movementUntilMouseDrag,r=Px.movementUntilPenDrag,n=Px.movementUntilTouchDrag,s=Px.holdDelay,o=P1){super(!1),this._maximumClickDelay=e,this._movementUntilMouseDrag=i,this._movementUntilPenDrag=r,this._movementUntilTouchDrag=n,this._holdDelay=s,this._clock=o,this._pointerState=new Map,this._pointerDrag=this.registerOutgoing("pointer-drag"),this._immediateClick=this.registerOutgoing("immediate-click"),this._pointerHold=this.registerOutgoing("hold"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",a=>{this._handlePointerLoss(a,"pointer-up")}),this.registerIncoming("pointer-capture-lost",a=>{this._handlePointerLoss(a,"pointer-capture-lost")}),this.registerIncoming("pointer-cancel",a=>{this._handlePointerLoss(a,"pointer-cancel")}),this._moveHandle=this.registerIncoming("pointer-move",this._handlePointerMove.bind(this)),this._moveHandle.pause()}onUninstall(){this._pointerState.forEach(e=>{e.holdTimeout=$i(e.holdTimeout)}),super.onUninstall()}_handlePointerDown(e){const i=e.data,r=i.native.pointerId;let n=null;this._pointerState.size===0&&(n=this._clock.setTimeout(()=>{const o=this._pointerState.get(r);if(o){if(!o.isDragging){const a=o.previousEvent;this._pointerHold.emit(a,void 0,e.modifiers),o.holdEmitted=!0}o.holdTimeout=null}},this._holdDelay));const s={startEvent:i,previousEvent:i,startTimestamp:e.timestamp,isDragging:!1,downButton:i.native.button,holdTimeout:n,modifiers:new Set};this._pointerState.set(r,s),this.startCapturingPointer(i.native),this._moveHandle.resume(),this._pointerState.size>1&&this._startDragging(e)}_createPointerDragData(e,i,r){return{action:e,startEvent:i.startEvent,previousEvent:i.previousEvent,currentEvent:r}}_handlePointerMove(e){const i=e.data,r=i.native.pointerId,n=this._pointerState.get(r);n&&(n.isDragging?this._pointerDrag.emit(this._createPointerDragData("update",n,i),void 0,n.modifiers):nFe(i,n.startEvent)>this._getDragThreshold(i.native.pointerType)&&this._startDragging(e),n.previousEvent=i)}_getDragThreshold(e){switch(e){case"touch":return this._movementUntilTouchDrag;case"pen":return this._movementUntilPenDrag;default:return this._movementUntilMouseDrag}}_startDragging(e){const i=e.data,r=i.native.pointerId;this._pointerState.forEach(n=>{n.holdTimeout!=null&&(n.holdTimeout.remove(),n.holdTimeout=null),n.isDragging||(n.modifiers=e.modifiers,n.isDragging=!0,r===n.startEvent.native.pointerId?this._pointerDrag.emit(this._createPointerDragData("start",n,i)):this._pointerDrag.emit(this._createPointerDragData("start",n,n.previousEvent),e.timestamp))})}_handlePointerLoss(e,i){const r=e.data,n=r.native.pointerId,s=this._pointerState.get(n);s&&(s.holdTimeout!=null&&(s.holdTimeout.remove(),s.holdTimeout=null),s.isDragging?this._pointerDrag.emit(this._createPointerDragData("end",s,i==="pointer-up"?r:s.previousEvent),void 0,s.modifiers):i==="pointer-up"&&s.downButton===r.native.button&&e.timestamp-s.startTimestamp<=this._maximumClickDelay&&!s.holdEmitted&&this._immediateClick.emit(r),this._pointerState.delete(n),this.stopCapturingPointer(r.native),this._pointerState.size===0&&this._moveHandle.pause())}};const jE={counter:"Ctrl",pan:{left:"ArrowLeft",right:"ArrowRight",up:"ArrowUp",down:"ArrowDown"},zoom:{zoomIn:["=","+"],zoomOut:["-","_"]},rotate:{clockwiseOption1:"a",clockwiseOption2:"A",counterClockwiseOption1:"d",counterClockwiseOption2:"D",resetOption1:"n",resetOption2:"N"}};let Ty=class extends he{constructor(){super(...arguments),this._handles=new gs}initialize(){const e=()=>{var i;return(i=this.view)==null?void 0:i.ready};this._handles.add([tn(()=>!e(),()=>this._disconnect()),tn(e,()=>this._connect())])}destroy(){this._handles=je(this._handles),this._disconnect()}get latestPointerType(){var e;return(e=this._inputManager)==null?void 0:e.latestPointerType}get latestPointerLocation(){var e;return(e=this._inputManager)==null?void 0:e.latestPointerLocation}get multiTouchActive(){var e;return((e=this._inputManager)==null?void 0:e.multiTouchActive)??!1}_disconnect(){this.view.viewEvents.disconnect(),this._inputManager=je(this._inputManager)}_connect(){const e=this.view.surface,i=new Vue(e,this.view.input),r=[new uFe,new dFe,new oFe,new lFe(this.view.navigation),new aFe],n=new El({eventSource:i,recognizers:r});n.installHandlers("prevent-context-menu",[new rFe],Pi.INTERNAL),n.installHandlers("navigation",[new Z5e(this.view),new z5e(this.view),new J5e(this.view),new cJ(this.view),new cJ(this.view,[jE.counter]),new R5e(this.view,"primary"),new G5e(this.view,jE.pan),new q5e(this.view,jE.zoom),new H5e(this.view,jE.rotate),new F5e(this.view,"secondary"),new L5e(this.view,"touch")],Pi.INTERNAL),this.view.viewEvents.connect(n),this._source=i,this._inputManager=n,J(()=>{var s,o;return(o=(s=this.view)==null?void 0:s.navigation)==null?void 0:o.browserTouchPanEnabled},s=>{this._source&&(this._source.browserTouchPanningEnabled=!s)},Le)}get test(){return{inputManager:this._inputManager}}};d([p()],Ty.prototype,"view",void 0),d([p()],Ty.prototype,"latestPointerType",null),d([p()],Ty.prototype,"latestPointerLocation",null),d([p()],Ty.prototype,"multiTouchActive",null),Ty=d([A("esri.views.2d.input.MapViewInputManager")],Ty);const hFe=Ty;var I_t=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function KU(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var fJ,mJ,gJ,K4={exports:{}};K4.exports,fJ=K4,mJ=function(){function t(n,s,o,a,l){e(n,s,o||0,a||n.length-1,l||r)}function e(n,s,o,a,l){for(;a>o;){if(a-o>600){var c=a-o+1,u=s-o+1,h=Math.log(c),f=.5*Math.exp(2*h/3),m=.5*Math.sqrt(h*f*(c-f)/c)*(u-c/2<0?-1:1);e(n,s,Math.max(o,Math.floor(s-u*f/c+m)),Math.min(a,Math.floor(s+(c-u)*f/c+m)),l)}var g=n[s],y=o,v=a;for(i(n,o,s),l(n[a],g)>0&&i(n,o,a);y<v;){for(i(n,y,v),y++,v--;l(n[y],g)<0;)y++;for(;l(n[v],g)>0;)v--}l(n[o],g)===0?i(n,o,v):i(n,++v,a),v<=s&&(o=v+1),s<=v&&(a=v-1)}}function i(n,s,o){var a=n[s];n[s]=n[o],n[o]=a}function r(n,s){return n<s?-1:n>s?1:0}return t},(gJ=mJ())!==void 0&&(fJ.exports=gJ);const pFe=KU(K4.exports);function gP(t,e){if(!(this instanceof gP))return new gP(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&(typeof e=="function"?this.toBBox=e:this._initFormat(e)),this.clear()}function fFe(t,e,i){if(!i)return e.indexOf(t);for(var r=0;r<e.length;r++)if(i(t,e[r]))return r;return-1}function g_(t,e){JS(t,0,t.children.length,e,t)}function JS(t,e,i,r,n){n||(n=ob(null)),n.minX=1/0,n.minY=1/0,n.maxX=-1/0,n.maxY=-1/0;for(var s,o=e;o<i;o++)s=t.children[o],ZS(n,t.leaf?r(s):s);return n}function ZS(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function yJ(t,e){return t.minX-e.minX}function vJ(t,e){return t.minY-e.minY}function Y3(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function BE(t){return t.maxX-t.minX+(t.maxY-t.minY)}function mFe(t,e){return(Math.max(e.maxX,t.maxX)-Math.min(e.minX,t.minX))*(Math.max(e.maxY,t.maxY)-Math.min(e.minY,t.minY))}function gFe(t,e){var i=Math.max(t.minX,e.minX),r=Math.max(t.minY,e.minY),n=Math.min(t.maxX,e.maxX),s=Math.min(t.maxY,e.maxY);return Math.max(0,n-i)*Math.max(0,s-r)}function K3(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function UE(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function ob(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function _J(t,e,i,r,n){for(var s,o=[e,i];o.length;)(i=o.pop())-(e=o.pop())<=r||(s=e+Math.ceil((i-e)/r/2)*r,pFe(t,s,e,i,n),o.push(e,s,s,i))}gP.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,i=[],r=this.toBBox;if(!UE(t,e))return i;for(var n,s,o,a,l=[];e;){for(n=0,s=e.children.length;n<s;n++)o=e.children[n],UE(t,a=e.leaf?r(o):o)&&(e.leaf?i.push(o):K3(t,a)?this._all(o,i):l.push(o));e=l.pop()}return i},collides:function(t){var e=this.data,i=this.toBBox;if(!UE(t,e))return!1;for(var r,n,s,o,a=[];e;){for(r=0,n=e.children.length;r<n;r++)if(s=e.children[r],UE(t,o=e.leaf?i(s):s)){if(e.leaf||K3(t,o))return!0;a.push(s)}e=a.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,i=t.length;e<i;e++)this.insert(t[e]);return this}var r=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===r.height)this._splitRoot(this.data,r);else{if(this.data.height<r.height){var n=this.data;this.data=r,r=n}this._insert(r,this.data.height-r.height-1,!0)}else this.data=r;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=ob([]),this},remove:function(t,e){if(!t)return this;for(var i,r,n,s,o=this.data,a=this.toBBox(t),l=[],c=[];o||l.length;){if(o||(o=l.pop(),r=l[l.length-1],i=c.pop(),s=!0),o.leaf&&(n=fFe(t,o.children,e))!==-1)return o.children.splice(n,1),l.push(o),this._condense(l),this;s||o.leaf||!K3(o,a)?r?(i++,o=r.children[i],s=!1):o=null:(l.push(o),c.push(i),i=0,r=o,o=o.children[0])}return this},toBBox:function(t){return t},compareMinX:yJ,compareMinY:vJ,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var i=[];t;)t.leaf?e.push.apply(e,t.children):i.push.apply(i,t.children),t=i.pop();return e},_build:function(t,e,i,r){var n,s=i-e+1,o=this._maxEntries;if(s<=o)return g_(n=ob(t.slice(e,i+1)),this.toBBox),n;r||(r=Math.ceil(Math.log(s)/Math.log(o)),o=Math.ceil(s/Math.pow(o,r-1))),(n=ob([])).leaf=!1,n.height=r;var a,l,c,u,h=Math.ceil(s/o),f=h*Math.ceil(Math.sqrt(o));for(_J(t,e,i,f,this.compareMinX),a=e;a<=i;a+=f)for(_J(t,a,c=Math.min(a+f-1,i),h,this.compareMinY),l=a;l<=c;l+=h)u=Math.min(l+h-1,c),n.children.push(this._build(t,l,u,r-1));return g_(n,this.toBBox),n},_chooseSubtree:function(t,e,i,r){for(var n,s,o,a,l,c,u,h;r.push(e),!e.leaf&&r.length-1!==i;){for(u=h=1/0,n=0,s=e.children.length;n<s;n++)l=Y3(o=e.children[n]),(c=mFe(t,o)-l)<h?(h=c,u=l<u?l:u,a=o):c===h&&l<u&&(u=l,a=o);e=a||e.children[0]}return e},_insert:function(t,e,i){var r=this.toBBox,n=i?t:r(t),s=[],o=this._chooseSubtree(n,this.data,e,s);for(o.children.push(t),ZS(o,n);e>=0&&s[e].children.length>this._maxEntries;)this._split(s,e),e--;this._adjustParentBBoxes(n,s,e)},_split:function(t,e){var i=t[e],r=i.children.length,n=this._minEntries;this._chooseSplitAxis(i,n,r);var s=this._chooseSplitIndex(i,n,r),o=ob(i.children.splice(s,i.children.length-s));o.height=i.height,o.leaf=i.leaf,g_(i,this.toBBox),g_(o,this.toBBox),e?t[e-1].children.push(o):this._splitRoot(i,o)},_splitRoot:function(t,e){this.data=ob([t,e]),this.data.height=t.height+1,this.data.leaf=!1,g_(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,i){var r,n,s,o,a,l,c,u;for(l=c=1/0,r=e;r<=i-e;r++)o=gFe(n=JS(t,0,r,this.toBBox),s=JS(t,r,i,this.toBBox)),a=Y3(n)+Y3(s),o<l?(l=o,u=r,c=a<c?a:c):o===l&&a<c&&(c=a,u=r);return u},_chooseSplitAxis:function(t,e,i){var r=t.leaf?this.compareMinX:yJ,n=t.leaf?this.compareMinY:vJ;this._allDistMargin(t,e,i,r)<this._allDistMargin(t,e,i,n)&&t.children.sort(r)},_allDistMargin:function(t,e,i,r){t.children.sort(r);var n,s,o=this.toBBox,a=JS(t,0,e,o),l=JS(t,i-e,i,o),c=BE(a)+BE(l);for(n=e;n<i-e;n++)s=t.children[n],ZS(a,t.leaf?o(s):s),c+=BE(a);for(n=i-e-1;n>=e;n--)s=t.children[n],ZS(l,t.leaf?o(s):s),c+=BE(l);return c},_adjustParentBBoxes:function(t,e,i){for(var r=i;r>=0;r--)ZS(e[r],t)},_condense:function(t){for(var e,i=t.length-1;i>=0;i--)t[i].children.length===0?i>0?(e=t[i-1].children).splice(e.indexOf(t[i]),1):this.clear():g_(t[i],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}};var X4;const bJ=new He({upperLeft:"upper-left",lowerLeft:"lower-left"});let Cy=X4=class extends te{constructor(t){super(t),this.extent=null,this.mode="view",this.originPosition="upper-left",this.tolerance=1}clone(){return new X4(U({extent:this.extent,mode:this.mode,originPosition:this.originPosition,tolerance:this.tolerance}))}};d([p({type:Re,json:{write:{overridePolicy(){return{enabled:this.mode==="view"}}}}})],Cy.prototype,"extent",void 0),d([p({type:["view","edit"],json:{write:!0}})],Cy.prototype,"mode",void 0),d([p({type:String,json:{read:bJ.read,write:bJ.write}})],Cy.prototype,"originPosition",void 0),d([p({type:Number,json:{write:{overridePolicy(){return{enabled:this.mode==="view"}}}}})],Cy.prototype,"tolerance",void 0),Cy=X4=d([A("esri.rest.support.QuantizationParameters")],Cy);const Bue=Cy;let wJ=class Uue{constructor(e,i){this.key=new Ev(0,0,0,0),this.bounds=al(),this.objectIds=new Set,this.key.set(i);const r=e.getLODInfoAt(this.key);this.tileInfoView=e,this.tileInfoView.getTileBounds(this.bounds,this.key,!0),this.resolution=r.resolution,this.scale=r.scale,this.level=r.level}get id(){return this.key.id}get extent(){return Re.fromBounds(this.bounds,this.tileInfoView.tileInfo.spatialReference)}get transform(){return{originPosition:"upperLeft",scale:[this.resolution,this.resolution],translate:[this.bounds[0],this.bounds[3]]}}createChildTiles(){const e=this.key.getChildKeys(),i=Oo.acquire();for(let r=0;r<e.length;r++)i[r]=new Uue(this.tileInfoView,e[r]);return i}getQuantizationParameters(){return Bue.fromJSON({mode:"view",originPosition:"upperLeft",tolerance:this.resolution,extent:{xmin:this.bounds[0],ymin:this.bounds[1],xmax:this.bounds[2],ymax:this.bounds[3],spatialReference:this.tileInfoView.tileInfo.spatialReference}})}};const Vg={added:[],removed:[]},X3=new Set,yFe=new Ev(0,0,0,0);let vFe=class extends an{constructor(e){super(),this._tiles=new Map,this._index=gP(9,ee("esri-csp-restrictions")?i=>({minX:i.bounds[0],minY:i.bounds[1],maxX:i.bounds[2],maxY:i.bounds[3]}):[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]),this.tiles=[],this.tileScheme=e}destroy(){this.clear()}clear(){this.tiles.length=0,this._tiles.clear(),this._index.clear()}has(e){return this._tiles.has(e)}get(e){return this._tiles.get(e)}boundsIntersections(e){return this._index.search({minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]})}updateTiles(e){const i={added:[],removed:[]};for(const r of e.added)if(!this.has(r)){const n=new wJ(this.tileScheme,r);this._tiles.set(r,n),this._index.insert(n),i.added.push(n)}for(const r of e.removed)if(this.has(r)){const n=this.get(r);this._tiles.delete(r),this._index.remove(n),i.removed.push(n)}this.tiles.length=0,this._tiles.forEach(r=>this.tiles.push(r)),(i.added.length||i.removed.length)&&this.emit("update",i)}setViewState(e){const i=this.tileScheme.getTileCoverage(e,0);if(!i)return;const{spans:r,lodInfo:n}=i,{level:s}=n;if(r.length>0)for(const{row:o,colFrom:a,colTo:l}of r)for(let c=a;c<=l;c++){const u=yFe.set(s,o,n.normalizeCol(c),n.getWorldForColumn(c)).id;if(X3.add(u),!this.has(u)){const h=new wJ(this.tileScheme,u);this._tiles.set(u,h),this._index.insert(h),this.tiles.push(h),Vg.added.push(h)}}for(let o=this.tiles.length-1;o>=0;o--){const a=this.tiles[o];X3.has(a.id)||(this._tiles.delete(a.id),this.tiles.splice(o,1),this._index.remove(a),Vg.removed.push(a))}(Vg.added.length||Vg.removed.length)&&this.emit("update",Vg),dT.pool.release(i),X3.clear(),Vg.added.length=0,Vg.removed.length=0}},Ey=class extends he{constructor(){super(...arguments),this.color=new ce([0,255,255]),this.haloOpacity=1,this.fillOpacity=.25}equals(e){return this.color.equals(e.color)&&(this.haloColor||this.color).equals(e.haloColor||e.color)&&this.haloOpacity===e.haloOpacity&&this.fillOpacity===e.fillOpacity}};d([p({type:ce})],Ey.prototype,"color",void 0),d([p({type:ce})],Ey.prototype,"haloColor",void 0),d([p()],Ey.prototype,"haloOpacity",void 0),d([p()],Ey.prototype,"fillOpacity",void 0),Ey=d([A("esri.views.2d.support.HighlightOptions")],Ey);const Gue=Ey,_Fe=t=>t.includes("Brush");let Hue=class{constructor(){this._names=new Map}begin(e){this._names.has(e)||(this._names.set(e,!1),_Fe(e)&&this.record("Esri.FirstDraw"),performance.mark(`Esri.${e}.Start`))}end(e){this._names.has(e)&&!this._names.get(e)&&(this._names.set(e,!0),performance.mark(`Esri.${e}.End`))}record(e){this._names.has(e)||(this._names.set(e,!0),performance.mark(`Esri.${e}`))}};function bFe(t,e,i,r,n,s,o,a){t.ignorePadding&&(r={left:0,right:0,top:0,bottom:0});let l=null;t.width!=null&&t.height!=null?l=[t.width,t.height]:t.width==null&&t.height!=null?l=[t.height,t.height]:t.width!=null&&t.height==null?l=[t.width,t.width]:t.width==null&&t.height==null&&(l=null);const c=i[0]-(r.left+r.right),u=i[1]-(r.top+r.bottom);let h,f,m=t.area||{x:0,y:0,width:c,height:u};if(l){const g=c/u,y=l[0]/l[1];if(y>g){const v=m.width/y;m={x:m.x,y:Math.round(m.y+(m.height-v)/2),width:m.width,height:Math.round(v)}}else{const v=m.height*y;m={x:Math.round(m.x+(m.width-v)/2),y:m.y,width:Math.round(v),height:m.height}}}else l=[m.width,m.height];return l[0]>m.width?(h=Math.min(l[0]/m.width,e),f=l[0]/m.width/h):(h=1,f=l[0]/m.width),{resolutionScale:h,cropArea:{x:Math.round((m.x+r.left)*h),y:Math.round((m.y+r.top)*h),width:Math.round(m.width*h),height:Math.round(m.height*h)},outputScale:f,format:n,quality:s,children:o,rotation:a}}function wFe(t,e,i){const{ctx:r,canvas:n}=que(t,i),s=r.getImageData(0,0,t.width,t.height),o=IFe(n,e);return Wue(n),{dataUrl:o,data:s}}function xFe(t,e){const{ctx:i,canvas:r}=que(t,e),n=i.getImageData(0,0,t.width,t.height);return Wue(r),n}function que(t,e){const i=SFe();e.premultipliedAlpha&&$Fe(t),i.width=t.width,i.height=t.height;const r=i.getContext("2d",{willReadFrequently:!0});return r.putImageData(t,0,0),e.flipY&&MFe(r),{ctx:r,canvas:i}}function Wue(t){t.width=0,t.height=0}function SFe(){return Q3==null&&(Q3=document.createElement("canvas")),Q3}let Q3=null;function IFe(t,e){const i=AFe[e.format],r=e.quality/100;return t.toDataURL(i,r)}function TFe(t,e){const i=EFe(t),r=PFe[i];return{format:i,quality:Pn(e??r,0,100)}}function CFe(t,e){return e/Math.max(t[0],t[1])}function M_t(t,e,i,r=0,n=0,s=t.width-r,o=t.height-n,a=!1){const{data:l}=t,{width:c,height:u,data:h}=e,f=s/c,m=o/u,g=Math.ceil(f/2),y=Math.ceil(m/2),v=t.width;for(let b=0;b<u;b++)for(let w=0;w<c;w++){const x=4*(w+(a?u-b-1:b)*c);let S=0,I=0,T=0,C=0,E=0,$=0;const P=(b+.5)*m;for(let k=Math.floor(b*m);k<(b+1)*m;k++){const L=Math.abs(P-(k+.5))/y,F=(w+.5)*f,V=L*L;for(let z=Math.floor(w*f);z<(w+1)*f;z++){const G=Math.abs(F-(z+.5))/g,H=Math.sqrt(V+G*G);if(H>=1)continue;let Z=2*H*H*H-3*H*H+1;const K=4*(r+z+(n+k)*v);$+=Z*l[K+3],I+=Z,!i&&l[K+3]<255&&(Z=Z*l[K+3]/255),T+=Z*l[K],C+=Z*l[K+1],E+=Z*l[K+2],S+=Z}}h[x]=T/S,h[x+1]=C/S,h[x+2]=E/S,h[x+3]=$/I}return e}function EFe(t){switch(t){case"png":case"jpg":case"jpeg":return t;default:return kFe}}function MFe(t){t.save(),t.globalCompositeOperation="copy",t.scale(1,-1),t.translate(0,-t.canvas.height),t.drawImage(t.canvas,0,0),t.restore()}function $Fe(t){const e=t.data,i=e.length;for(let r=0;r<i;r+=4){const n=e[r+3];if(n!==255&&n>0){const s=255/n;e[r]=e[r]*s,e[r+1]=e[r+1]*s,e[r+2]=e[r+2]*s}}}const AFe={png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg"},xJ=98,kFe="png",PFe={png:100,jpg:xJ,jpeg:xJ};var En;function Q4(t,e,i={}){const r=e===En.WEBGL1?["webgl","experimental-webgl","webkit-3d","moz-webgl"]:["webgl2"];for(const n of r){const s=t.getContext(n,i);if(s)return s}return null}function $_t(t,e,i={}){const r=Jue(t);for(const n of r){const s=Q4(e,n,i);if(s)return s}return null}function Jue(t){if(t==="3d")return[En.WEBGL2];const e=ee("esri-force-webgl");return e===En.WEBGL1||e===En.WEBGL2?[e]:ee("mac")&&ee("chrome")?[En.WEBGL1,En.WEBGL2]:[En.WEBGL2,En.WEBGL1]}(function(t){t[t.WEBGL1=1]="WEBGL1",t[t.WEBGL2=2]="WEBGL2"})(En||(En={}));let e5,t5;function OFe(t){const e=Jue(t);for(;e.length>1;){const i=SJ(e.shift());if(i.available)return i}return SJ(e.shift())}function SJ(t){switch(t){case En.WEBGL1:return LFe();case En.WEBGL2:return RFe()}}function LFe(){return e5||(e5=NFe()),e5}function RFe(){return t5||(t5=VFe()),t5}let Zue=class{constructor(){this.available=!1,this.majorPerformanceCaveat=!1,this.maxTextureSize=0,this.supportsVertexShaderSamplers=!1,this.supportsHighPrecisionFragment=!1,this.supportsElementIndexUint=!1,this.supportsStandardDerivatives=!1,this.supportsInstancedArrays=!1,this.supportsTextureFloat=!1,this.supportsTextureHalfFloat=!1,this.supportsColorBufferFloat=!1,this.supportsColorBufferFloatBlend=!1,this.supportsColorBufferHalfFloat=!1}},FFe=class extends Zue{constructor(){super(...arguments),this.type=En.WEBGL1}},DFe=class extends Zue{constructor(){super(...arguments),this.type=En.WEBGL2,this.supportsElementIndexUint=!0,this.supportsStandardDerivatives=!0,this.supportsInstancedArrays=!0,this.supportsTextureFloat=!0,this.supportsTextureHalfFloat=!0}};function Yue(t,e){if(t===En.WEBGL1&&typeof WebGLRenderingContext>"u"||t===En.WEBGL2&&typeof WebGL2RenderingContext>"u")return null;const i=document.createElement("canvas");if(!i)return null;let r=Q4(i,t,{failIfMajorPerformanceCaveat:!0});if(r==null&&(r=Q4(i,t),r!=null&&(e.majorPerformanceCaveat=!0)),r==null)return r;if(t===En.WEBGL1){const s=r.getParameter(r.VERSION),o=s==null?void 0:s.match(/^WebGL\s+([\d.]*)/);if(o){const a=parseFloat(o[1]);e.available=a>=.94}}else e.available=!0;e.maxTextureSize=r.getParameter(r.MAX_TEXTURE_SIZE),e.supportsVertexShaderSamplers=r.getParameter(r.MAX_VERTEX_TEXTURE_IMAGE_UNITS)>0;const n=r.getShaderPrecisionFormat(r.FRAGMENT_SHADER,r.HIGH_FLOAT);return n&&(e.supportsHighPrecisionFragment=n.precision>0),r}function NFe(){const t=new FFe,e=Yue(En.WEBGL1,t);return e==null||(t.supportsElementIndexUint=e.getExtension("OES_element_index_uint")!==null,t.supportsStandardDerivatives=e.getExtension("OES_standard_derivatives")!==null,t.supportsInstancedArrays=e.getExtension("ANGLE_instanced_arrays")!==null,t.supportsTextureFloat=e.getExtension("OES_texture_float")!==null,t.supportsTextureHalfFloat=e.getExtension("OES_texture_half_float")!==null,t.supportsColorBufferFloat=e.getExtension("WEBGL_color_buffer_float")!==null,t.supportsColorBufferFloatBlend=e.getExtension("EXT_float_blend")!==null,t.supportsColorBufferHalfFloat=e.getExtension("EXT_color_buffer_half_float")!==null),t}function VFe(){const t=new DFe,e=Yue(En.WEBGL2,t);return e==null||(t.supportsColorBufferFloat=e.getExtension("EXT_color_buffer_float")!==null,t.supportsColorBufferFloatBlend=e.getExtension("EXT_float_blend")!==null,t.supportsColorBufferHalfFloat=t.supportsColorBufferFloat||e.getExtension("EXT_color_buffer_half_float")!==null),t}function zFe(t){const e=OFe(t);if(!e.available)return new N("webgl:required",t==="3d"?"WebGL2 is required but not supported.":"WebGL is required but not supported.",new Error().stack);if(t==="3d"&&e.majorPerformanceCaveat)return new N("webgl:major-performance-caveat-detected","Your WebGL implementation doesn't seem to support hardware accelerated rendering. Check your browser settings or if your GPU is in a blocklist.");if(!e.supportsHighPrecisionFragment)return new N("webgl:high-precision-fragment-required","WebGL support for high precision fragment shaders is required but not supported.");if(!e.supportsVertexShaderSamplers)return new N("webgl:vertex-shader-samplers-required","WebGL support for vertex shader samplers is required but not supported.");if(e.type===En.WEBGL1){if(!e.supportsElementIndexUint)return new N("webgl:element-index-uint-required","WebGL support for uint vertex indices is required but not supported.");if(!e.supportsStandardDerivatives)return new N("webgl:standard-derivatives-required","WebGL support for standard derivatives is required but not supported.");if(!e.supportsInstancedArrays)return new N("webgl:instanced-arrays-required","WebGL support for instanced rendering is required but not supported.")}return null}function jFe(t){return t&&"nodeType"in t}function BFe(t){return t&&typeof t.render=="function"}const IJ={component:"esri-component"};let My=class extends he{constructor(){super(...arguments),this.widget=null}destroy(){var e;this.node=null,(e=this.widget)==null||e.destroy()}get id(){return this.get("widget.id")||this.get("node.id")}set node(e){const i=this._get("node");e!==i&&(e&&e.classList.add(IJ.component),i&&i.classList.remove(IJ.component),this._set("node",e))}castNode(e){var i;return(i=this.widget)==null||i.destroy(),e?typeof e=="string"||jFe(e)?(this._set("widget",null),vL(e)):(BFe(e)&&!e.domNode&&(e.domNode=document.createElement("div")),this._set("widget",e),e.domNode):(this._set("widget",null),null)}};d([p({dependsOn:[]})],My.prototype,"id",null),d([p()],My.prototype,"node",null),d([tt("node")],My.prototype,"castNode",null),d([p({readOnly:!0})],My.prototype,"widget",void 0),My=d([A("esri.views.ui.Component")],My);const aA=My,Kue="calcite-mode-";function UFe(){return getComputedStyle(document.body).getPropertyValue("--esri-calcite-mode-name").replaceAll(/\s|'|"/g,"")}function XU(){return UFe().startsWith("dark")}function GFe(){return`${Kue}${XU()?"dark":"light"}`}function HFe(t){qFe(t),t.classList.add(GFe())}function qFe(t){Array.from(t.classList).forEach(e=>{e.startsWith(Kue)&&t.classList.remove(e)})}const WFe={left:0,top:0,bottom:0,right:0},Xue={bottom:30,top:15,right:15,left:15},Qd="esri-ui",Wo={ui:Qd,corner:`${Qd}-corner`,innerContainer:`${Qd}-inner-container`,manualContainer:`${Qd}-manual-container`,cornerContainer:`${Qd}-corner-container`,topLeft:`${Qd}-top-left`,topRight:`${Qd}-top-right`,bottomLeft:`${Qd}-bottom-left`,bottomRight:`${Qd}-bottom-right`};function JFe(t){return t&&!t._started&&typeof t.postMixInProperties=="function"&&typeof t.buildRendering=="function"&&typeof t.postCreate=="function"&&typeof t.startup=="function"}function GE(t){return t===0?"0":`${t}px`}function i5(t){const e=typeof t=="object"&&t!==null&&Object.getPrototypeOf(t);return(e===null||e===Object.prototype)&&("component"in t||"index"in t||"position"in t)?t:null}function r5(t,{top:e,bottom:i,left:r,right:n}){t.style.top=e,t.style.bottom=i,t.style.left=r,t.style.right=n}let Qu=class extends an.EventedAccessor{constructor(e){super(e),this._cornerNameToContainerLookup={},this._positionNameToContainerLookup={},this._components=new Array,this._componentMap=new Map,this._locale=Mn(),this.view=null,this._applyViewPadding=()=>{const i=this.container;i&&r5(i,this._toPixelPosition(this._getViewPadding()))},this._applyUIPadding=()=>{const i=this._innerContainer;i&&r5(i,this._toPixelPosition(this.padding))},this._initContainers()}initialize(){this.addHandles([J(()=>{var e;return[(e=this.view)==null?void 0:e.padding,this.container]},this._applyViewPadding,Le),J(()=>this.padding,this._applyUIPadding,Le),J(()=>[this.container,this._locale],([e,i])=>{e&&e.setAttribute("lang",i)},Le),nC(e=>{this._locale=e})])}destroy(){this.container=null;for(const e of this._components)e.destroy();this._components.length=0,this._componentMap.clear()}set container(e){const i=this._get("container");e!==i&&(e&&(e.classList.add(Wo.ui),HFe(e),this._attachContainers(e)),i&&(i.classList.remove(Wo.ui),r5(i,{top:"",bottom:"",left:"",right:""}),hce(i)),this._set("container",e))}get height(){var s;const e=((s=this.view)==null?void 0:s.height)??0;if(e===0)return e;const i=this._getViewPadding(),{top:r,bottom:n}=i;return Math.max(e-r-n,0)}get padding(){return this._get("padding")}set padding(e){this._overrideIfSome("padding",e)}castPadding(e){return typeof e=="number"?{bottom:e,top:e,right:e,left:e}:{...Xue,...e}}get width(){var s;const e=((s=this.view)==null?void 0:s.width)??0;if(e===0)return e;const i=this._getViewPadding(),{left:r,right:n}=i;return Math.max(e-r-n,0)}add(e,i){let r,n,s;if(Array.isArray(e))return void e.forEach(a=>this.add(a,i));const o=i5(e);o&&({index:r,position:i,component:e,key:n}=o),i&&typeof i=="object"&&({index:r,key:n,position:i,internal:s}=i),!e||i&&!this._isValidPosition(i)||this._add(e,i,r,n,s)}remove(e,i){var n;if(!e)return;if(Array.isArray(e))return e.map(s=>this.remove(s,i));const r=this._find(e);if(r){if(this._componentMap.has(e)&&((n=this._componentMap.get(e))==null?void 0:n.key)!==i)return;const s=this._components.indexOf(r),o=r.node.parentNode;return o==null||o.removeChild(r.node),this._componentMap.delete(e),this._components.splice(s,1)[0]}}empty(e,i={removeInternal:!1}){if(Array.isArray(e)){for(const s of e)this.empty(s,i);return}const r=this._positionNameToContainerLookup[e??"manual"],n=Array.prototype.slice.call(r.children).map(s=>this._findByNode(s)).filter(s=>{var o;return s==null?!1:!(((o=this._componentMap.get(s))==null?void 0:o.internal)??!1)||i.removeInternal});for(const s of n)this.remove(s)}move(e,i){if(Array.isArray(e)&&e.forEach(o=>this.move(o,i)),!e)return;let r;const n=i5(e)||i5(i);if(n&&(r=n.index,i=n.position,e=n.component||e),i&&!this._isValidPosition(i))return;const s=this.remove(e);s&&this.add(s,{position:i,index:r})}find(e){if(!e)return null;const i=this._findById(e);return i&&(i.widget||i.node)}getComponents(e,i={includeInternal:!1}){return e?Array.isArray(e)?e.map(r=>this._getComponentsAtPosition(r,i)).flat():this._getComponentsAtPosition(e,i):this._components.filter(r=>{var n;return i.includeInternal||!((n=this._componentMap.get(r))!=null&&n.internal)}).map(({widget:r,node:n})=>r??n)}getPosition(e){for(const i in this._positionNameToContainerLookup)if(this._positionNameToContainerLookup[i].contains(e))return i;return null}_add(e,i,r,n,s){e instanceof aA||(e=new aA({node:e})),this._place({component:e,position:i,index:r}),this._components.push(e),this._componentMap.set(e,{key:n,internal:s})}_find(e){return e?e instanceof aA?this._findByComponent(e):typeof e=="string"?this._findById(e):this._findByNode(e.domNode||e):null}_getViewPadding(){var e;return((e=this.view)==null?void 0:e.padding)??WFe}_attachContainers(e){e.appendChild(this._innerContainer),e.appendChild(this._manualContainer)}_initContainers(){const e=document.createElement("div");e.classList.add(Wo.innerContainer,Wo.cornerContainer);const i=document.createElement("div");i.classList.add(Wo.innerContainer,Wo.manualContainer);const r=document.createElement("div");r.classList.add(Wo.topLeft,Wo.corner),e.appendChild(r);const n=document.createElement("div");n.classList.add(Wo.topRight,Wo.corner),e.appendChild(n);const s=document.createElement("div");s.classList.add(Wo.bottomLeft,Wo.corner),e.appendChild(s);const o=document.createElement("div");o.classList.add(Wo.bottomRight,Wo.corner),e.appendChild(o),this._innerContainer=e,this._manualContainer=i;const a=ll();this._cornerNameToContainerLookup={"top-left":r,"top-right":n,"bottom-left":s,"bottom-right":o,"top-leading":a?n:r,"top-trailing":a?r:n,"bottom-leading":a?o:s,"bottom-trailing":a?s:o},this._positionNameToContainerLookup={manual:i,...this._cornerNameToContainerLookup}}_isValidPosition(e){return!!this._positionNameToContainerLookup[e]}_place(e){const i=e.position??"manual",{component:r,index:n}=e,s=this._positionNameToContainerLookup[i],o=n!=null&&n>-1;if(JFe(r.widget)&&r.widget.startup(),!o)return void s.appendChild(r.node);const a=Array.from(s.children);if(n===0)return void(s.firstChild?_W(r.node,s.firstChild):s.appendChild(r.node));n>=a.length?s.appendChild(r.node):_W(r.node,a[n])}_toPixelPosition(e){return{top:GE(e.top),left:GE(e.left),right:GE(e.right),bottom:GE(e.bottom)}}_findByComponent(e){return this._components.find(i=>i===e)??null}_findById(e){return this._components.find(({id:i})=>i===e)??null}_findByNode(e){return this._components.find(({node:i})=>i===e)??null}_getComponentsAtPosition(e,i){const r=this._positionNameToContainerLookup[e];return Array.prototype.slice.call(r.children).map(n=>this._findByNode(n)).filter(Dt).filter(n=>{var s;return i.includeInternal||!((s=this._componentMap.get(n))!=null&&s.internal)}).map(({widget:n,node:s})=>n??s)}};d([p()],Qu.prototype,"_locale",void 0),d([p()],Qu.prototype,"container",null),d([p()],Qu.prototype,"height",null),d([p({value:Xue})],Qu.prototype,"padding",null),d([tt("padding")],Qu.prototype,"castPadding",null),d([p()],Qu.prototype,"view",void 0),d([p()],Qu.prototype,"width",null),Qu=d([A("esri.views.ui.UI")],Qu);const ZFe=Qu,YFe="randomUUID"in crypto;function QU(){if(YFe)return crypto.randomUUID();const t=crypto.getRandomValues(new Uint16Array(8));t[3]=4095&t[3]|16384,t[4]=16383&t[4]|32768;const e=i=>t[i].toString(16).padStart(4,"0");return e(0)+e(1)+"-"+e(2)+"-"+e(3)+"-"+e(4)+"-"+e(5)+e(6)+e(7)}function TJ(){return`{${QU()}}`}const KFe={handleInterceptedEvent:(t,e,i,r)=>(t.scheduleRender(),e.properties[`on${r.type}`].apply(e.properties.bind||i,[r]))},XFe={namespace:void 0,performanceLogger:()=>{},eventHandlerInterceptor:void 0,styleApplyer:(t,e,i)=>{t.style[e]=i}},QFe=t=>({...XFe,...t}),eDe=(t,e)=>{const i=[];for(;t&&t!==e;)i.push(t),t=t.parentNode;return i},tDe=(t,e)=>t.find(e),CJ=(t,e,i=!1)=>{let r=t;return e.forEach((n,s)=>{const o=r!=null&&r.children?tDe(r.children,a=>a.domNode===n):void 0;i&&!o&&s!==e.length-1||(r=o)}),r},iDe=t=>{let e;const i={...KFe,...t},r=QFe(i),n=r.performanceLogger;let s,o=!0,a=!1;const l=[],c=[],u=(f,m,g)=>{var b;let y;r.eventHandlerInterceptor=(w,x,S,I)=>function(T){let C;n("domEvent",T);const E=eDe(T.currentTarget,y.domNode),$=E.some(k=>{var L;return customElements.get((L=k==null?void 0:k.tagName)==null?void 0:L.toLowerCase())});if(T.eventPhase===Event.CAPTURING_PHASE||!$)E.reverse(),C=CJ(y.getLastRender(),E);else{const k=T.composedPath(),L=k.slice(k.indexOf(T.currentTarget),k.indexOf(y.domNode)).filter(F=>F.getRootNode()===F.ownerDocument).reverse();C=CJ(y.getLastRender(),L,!0)}let P;return C&&(P=i.handleInterceptedEvent(e,C,this,T)),n("domEventProcessed",T),P},(b=i.postProcessProjectionOptions)==null||b.call(i,r);const v=g();y=f(m,v,r),l.push(y),c.push(g),i.afterFirstVNodeRendered&&i.afterFirstVNodeRendered(y,v)};let h=()=>{if(s=void 0,o){o=!1,n("renderStart",void 0);for(let f=0;f<l.length;f++){const m=c[f]();n("rendered",void 0),l[f].update(m),n("patched",void 0)}n("renderDone",void 0),o=!0}};return i.modifyDoRenderImplementation&&(h=i.modifyDoRenderImplementation(h,l,c)),e={renderNow:h,scheduleRender:()=>{s||a||(s=requestAnimationFrame(h))},stop:()=>{s&&(cancelAnimationFrame(s),s=void 0),a=!0},resume:()=>{a=!1,o=!0,e.scheduleRender()},append:(f,m)=>{u(Lm.append,f,m)},insertBefore:(f,m)=>{u(Lm.insertBefore,f,m)},merge:(f,m)=>{u(Lm.merge,f,m)},replace:(f,m)=>{u(Lm.replace,f,m)},detach:f=>{for(let m=0;m<c.length;m++)if(c[m]===f)return c.splice(m,1),l.splice(m,1)[0];throw new Error("renderFunction was not found")}},e},ab={allRenderFn:!1,cmpDidLoad:!0,cmpDidUnload:!1,cmpDidUpdate:!0,cmpDidRender:!0,cmpWillLoad:!0,cmpWillUpdate:!0,cmpWillRender:!0,connectedCallback:!0,disconnectedCallback:!0,element:!0,event:!0,hasRenderFn:!0,lifecycle:!0,hostListener:!0,hostListenerTargetWindow:!0,hostListenerTargetDocument:!0,hostListenerTargetBody:!0,hostListenerTargetParent:!1,hostListenerTarget:!0,member:!0,method:!0,mode:!0,observeAttribute:!0,prop:!0,propMutable:!0,reflect:!0,scoped:!0,shadowDom:!0,slot:!0,cssAnnotations:!0,state:!0,style:!0,svg:!0,updatable:!0,vdomAttribute:!0,vdomXlink:!0,vdomClass:!0,vdomFunctional:!0,vdomKey:!0,vdomListener:!0,vdomRef:!0,vdomPropOrAttr:!0,vdomRender:!0,vdomStyle:!0,vdomText:!0,watchCallback:!0,taskQueue:!0,hotModuleReplacement:!1,isDebug:!1,isDev:!1,isTesting:!1,hydrateServerSide:!1,hydrateClientSide:!1,lifecycleDOMEvents:!1,lazyLoad:!1,profile:!1,slotRelocation:!0,appendChildSlotFix:!1,cloneNodeFix:!1,hydratedAttribute:!1,hydratedClass:!0,safari10:!1,scriptDataOpts:!1,scopedSlotTextContentFix:!1,shadowDomShim:!1,slotChildNodesFix:!1,invisiblePrehydration:!0,propBoolean:!0,propNumber:!0,propString:!0,cssVarShim:!1,constructableCSS:!0,cmpShouldUpdate:!0,devTools:!1,dynamicImportShim:!1,shadowDelegatesFocus:!0,initializeNextTick:!1,asyncLoading:!1,asyncQueue:!1,transformTagName:!1,attachStyles:!0};let lb,Que,ML,ede=!1,yP=!1,e9=!1,Ja=!1,EJ=null,eV=!1;const rDe=t=>{const e=new URL(t,_s.$resourcesUrl$);return e.origin!==CC.location.origin?e.href:e.pathname},nDe=t=>_s.$resourcesUrl$=t,Mv=(t,e="")=>()=>{},MJ="http://www.w3.org/1999/xlink",$J={},sDe="http://www.w3.org/2000/svg",oDe="http://www.w3.org/1999/xhtml",aDe=t=>t!=null,t9=t=>(t=typeof t,t==="object"||t==="function");function lDe(t){var e,i,r;return(r=(i=(e=t.head)===null||e===void 0?void 0:e.querySelector('meta[name="csp-nonce"]'))===null||i===void 0?void 0:i.getAttribute("content"))!==null&&r!==void 0?r:void 0}const tde=(t,e,...i)=>{let r=null,n=null,s=null,o=!1,a=!1;const l=[],c=h=>{for(let f=0;f<h.length;f++)r=h[f],Array.isArray(r)?c(r):r!=null&&typeof r!="boolean"&&((o=typeof t!="function"&&!t9(r))&&(r=String(r)),o&&a?l[l.length-1].$text$+=r:l.push(o?vP(null,r):r),a=o)};if(c(i),e){e.key&&(n=e.key),e.name&&(s=e.name);{const h=e.className||e.class;h&&(e.class=typeof h!="object"?h:Object.keys(h).filter(f=>h[f]).join(" "))}}if(typeof t=="function")return t(e===null?{}:e,l,dDe);const u=vP(t,null);return u.$attrs$=e,l.length>0&&(u.$children$=l),u.$key$=n,u.$name$=s,u},vP=(t,e)=>{const i={$flags$:0,$tag$:t,$text$:e,$elm$:null,$children$:null};return i.$attrs$=null,i.$key$=null,i.$name$=null,i},cDe={},uDe=t=>t&&t.$tag$===cDe,dDe={forEach:(t,e)=>t.map(AJ).forEach(e),map:(t,e)=>t.map(AJ).map(e).map(hDe)},AJ=t=>({vattrs:t.$attrs$,vchildren:t.$children$,vkey:t.$key$,vname:t.$name$,vtag:t.$tag$,vtext:t.$text$}),hDe=t=>{if(typeof t.vtag=="function"){const i=Object.assign({},t.vattrs);return t.vkey&&(i.key=t.vkey),t.vname&&(i.name=t.vname),tde(t.vtag,i,...t.vchildren||[])}const e=vP(t.vtag,t.vtext);return e.$attrs$=t.vattrs,e.$children$=t.vchildren,e.$key$=t.vkey,e.$name$=t.vname,e},pDe=t=>zDe.map(e=>e(t)).find(e=>!!e),fDe=(t,e)=>t!=null&&!t9(t)?e&4?t==="false"?!1:t===""||!!t:e&2?parseFloat(t):e&1?String(t):t:t,mDe=t=>t,R_t=(t,e,i)=>{const r=mDe(t);return{emit:n=>gDe(r,e,{bubbles:!!(i&4),composed:!!(i&2),cancelable:!!(i&1),detail:n})}},gDe=(t,e,i)=>{const r=_s.ce(e,i);return t.dispatchEvent(r),r},kJ=new WeakMap,yDe=(t,e,i)=>{let r=bP.get(t);UDe&&i?(r=r||new CSSStyleSheet,typeof r=="string"?r=e:r.replaceSync(e)):r=e,bP.set(t,r)},vDe=(t,e,i,r)=>{var n;let s=ide(e,i);const o=bP.get(s);if(t=t.nodeType===11?t:_u,o)if(typeof o=="string"){t=t.head||t;let a=kJ.get(t),l;if(a||kJ.set(t,a=new Set),!a.has(s)){{l=_u.createElement("style"),l.innerHTML=o;const c=(n=_s.$nonce$)!==null&&n!==void 0?n:lDe(_u);c!=null&&l.setAttribute("nonce",c),t.insertBefore(l,t.querySelector("link"))}a&&a.add(s)}}else t.adoptedStyleSheets.includes(o)||(t.adoptedStyleSheets=[...t.adoptedStyleSheets,o]);return s},_De=t=>{const e=t.$cmpMeta$,i=t.$hostElement$,r=e.$flags$,n=Mv("attachStyles",e.$tagName$),s=vDe(i.shadowRoot?i.shadowRoot:i.getRootNode(),e,t.$modeName$);r&10&&(i["s-sc"]=s,i.classList.add(s+"-h"),r&2&&i.classList.add(s+"-s")),n()},ide=(t,e)=>"sc-"+(e&&t.$flags$&32?t.$tagName$+"-"+e:t.$tagName$),PJ=(t,e,i,r,n,s)=>{if(i!==r){let o=FJ(t,e),a=e.toLowerCase();if(e==="class"){const l=t.classList,c=OJ(i),u=OJ(r);l.remove(...c.filter(h=>h&&!u.includes(h))),l.add(...u.filter(h=>h&&!c.includes(h)))}else if(e==="style"){for(const l in i)(!r||r[l]==null)&&(l.includes("-")?t.style.removeProperty(l):t.style[l]="");for(const l in r)(!i||r[l]!==i[l])&&(l.includes("-")?t.style.setProperty(l,r[l]):t.style[l]=r[l])}else if(e!=="key")if(e==="ref")r&&r(t);else if(!t.__lookupSetter__(e)&&e[0]==="o"&&e[1]==="n")e[2]==="-"?e=e.slice(3):FJ(CC,a)?e=a.slice(2):e=a[2]+e.slice(3),i&&_s.rel(t,e,i,!1),r&&_s.ael(t,e,r,!1);else{const l=t9(r);if((o||l&&r!==null)&&!n)try{if(t.tagName.includes("-"))t[e]=r;else{const u=r??"";e==="list"?o=!1:(i==null||t[e]!=u)&&(t[e]=u)}}catch{}let c=!1;a!==(a=a.replace(/^xlink\:?/,""))&&(e=a,c=!0),r==null||r===!1?(r!==!1||t.getAttribute(e)==="")&&(c?t.removeAttributeNS(MJ,e):t.removeAttribute(e)):(!o||s&4||n)&&!l&&(r=r===!0?"":r,c?t.setAttributeNS(MJ,e,r):t.setAttribute(e,r))}}},bDe=/\s/,OJ=t=>t?t.split(bDe):[],rde=(t,e,i,r)=>{const n=e.$elm$.nodeType===11&&e.$elm$.host?e.$elm$.host:e.$elm$,s=t&&t.$attrs$||$J,o=e.$attrs$||$J;for(r in s)r in o||PJ(n,r,s[r],void 0,i,e.$flags$);for(r in o)PJ(n,r,s[r],o[r],i,e.$flags$)},_P=(t,e,i,r)=>{const n=e.$children$[i];let s=0,o,a,l;if(ede||(e9=!0,n.$tag$==="slot"&&(lb&&r.classList.add(lb+"-s"),n.$flags$|=n.$children$?2:1)),n.$text$!==null)o=n.$elm$=_u.createTextNode(n.$text$);else if(n.$flags$&1)o=n.$elm$=_u.createTextNode("");else{if(Ja||(Ja=n.$tag$==="svg"),o=n.$elm$=_u.createElementNS(Ja?sDe:oDe,n.$flags$&2?"slot-fb":n.$tag$),Ja&&n.$tag$==="foreignObject"&&(Ja=!1),rde(null,n,Ja),aDe(lb)&&o["s-si"]!==lb&&o.classList.add(o["s-si"]=lb),n.$children$)for(s=0;s<n.$children$.length;++s)a=_P(t,n,s,o),a&&o.appendChild(a);n.$tag$==="svg"?Ja=!1:o.tagName==="foreignObject"&&(Ja=!0)}return o["s-hn"]=ML,n.$flags$&3&&(o["s-sr"]=!0,o["s-cr"]=Que,o["s-sn"]=n.$name$||"",l=t&&t.$children$&&t.$children$[i],l&&l.$tag$===n.$tag$&&t.$elm$&&hT(t.$elm$,!1)),o},hT=(t,e)=>{_s.$flags$|=1;const i=t.childNodes;for(let r=i.length-1;r>=0;r--){const n=i[r];n["s-hn"]!==ML&&n["s-ol"]&&(ode(n).insertBefore(n,i9(n)),n["s-ol"].remove(),n["s-ol"]=void 0,e9=!0),e&&hT(n,e)}_s.$flags$&=-2},nde=(t,e,i,r,n,s)=>{let o=t["s-cr"]&&t["s-cr"].parentNode||t,a;for(o.shadowRoot&&o.tagName===ML&&(o=o.shadowRoot);n<=s;++n)r[n]&&(a=_P(null,i,n,t),a&&(r[n].$elm$=a,o.insertBefore(a,i9(e))))},sde=(t,e,i,r,n)=>{for(;e<=i;++e)(r=t[e])&&(n=r.$elm$,cde(r),yP=!0,n["s-ol"]?n["s-ol"].remove():hT(n,!0),n.remove())},wDe=(t,e,i,r)=>{let n=0,s=0,o=0,a=0,l=e.length-1,c=e[0],u=e[l],h=r.length-1,f=r[0],m=r[h],g,y;for(;n<=l&&s<=h;)if(c==null)c=e[++n];else if(u==null)u=e[--l];else if(f==null)f=r[++s];else if(m==null)m=r[--h];else if(HE(c,f))cb(c,f),c=e[++n],f=r[++s];else if(HE(u,m))cb(u,m),u=e[--l],m=r[--h];else if(HE(c,m))(c.$tag$==="slot"||m.$tag$==="slot")&&hT(c.$elm$.parentNode,!1),cb(c,m),t.insertBefore(c.$elm$,u.$elm$.nextSibling),c=e[++n],m=r[--h];else if(HE(u,f))(c.$tag$==="slot"||m.$tag$==="slot")&&hT(u.$elm$.parentNode,!1),cb(u,f),t.insertBefore(u.$elm$,c.$elm$),u=e[--l],f=r[++s];else{for(o=-1,a=n;a<=l;++a)if(e[a]&&e[a].$key$!==null&&e[a].$key$===f.$key$){o=a;break}o>=0?(y=e[o],y.$tag$!==f.$tag$?g=_P(e&&e[s],i,o,t):(cb(y,f),e[o]=void 0,g=y.$elm$),f=r[++s]):(g=_P(e&&e[s],i,s,t),f=r[++s]),g&&ode(c.$elm$).insertBefore(g,i9(c.$elm$))}n>l?nde(t,r[h+1]==null?null:r[h+1].$elm$,i,r,s,h):s>h&&sde(e,n,l)},HE=(t,e)=>t.$tag$===e.$tag$?t.$tag$==="slot"?t.$name$===e.$name$:t.$key$===e.$key$:!1,i9=t=>t&&t["s-ol"]||t,ode=t=>(t["s-ol"]?t["s-ol"]:t).parentNode,cb=(t,e)=>{const i=e.$elm$=t.$elm$,r=t.$children$,n=e.$children$,s=e.$tag$,o=e.$text$;let a;o===null?(Ja=s==="svg"?!0:s==="foreignObject"?!1:Ja,s==="slot"||rde(t,e,Ja),r!==null&&n!==null?wDe(i,r,e,n):n!==null?(t.$text$!==null&&(i.textContent=""),nde(i,null,e,n,0,n.length-1)):r!==null&&sde(r,0,r.length-1),Ja&&s==="svg"&&(Ja=!1)):(a=i["s-cr"])?a.parentNode.textContent=o:t.$text$!==o&&(i.data=o)},ade=t=>{const e=t.childNodes;let i,r,n,s,o,a;for(r=0,n=e.length;r<n;r++)if(i=e[r],i.nodeType===1){if(i["s-sr"]){for(o=i["s-sn"],i.hidden=!1,s=0;s<n;s++)if(a=e[s].nodeType,e[s]["s-hn"]!==i["s-hn"]||o!==""){if(a===1&&o===e[s].getAttribute("slot")){i.hidden=!0;break}}else if(a===1||a===3&&e[s].textContent.trim()!==""){i.hidden=!0;break}}ade(i)}},su=[],lde=t=>{let e,i,r,n,s,o,a=0;const l=t.childNodes,c=l.length;for(;a<c;a++){if(e=l[a],e["s-sr"]&&(i=e["s-cr"])&&i.parentNode)for(r=i.parentNode.childNodes,n=e["s-sn"],o=r.length-1;o>=0;o--)i=r[o],!i["s-cn"]&&!i["s-nr"]&&i["s-hn"]!==e["s-hn"]&&(LJ(i,n)?(s=su.find(u=>u.$nodeToRelocate$===i),yP=!0,i["s-sn"]=i["s-sn"]||n,s?s.$slotRefNode$=e:su.push({$slotRefNode$:e,$nodeToRelocate$:i}),i["s-sr"]&&su.map(u=>{LJ(u.$nodeToRelocate$,i["s-sn"])&&(s=su.find(h=>h.$nodeToRelocate$===i),s&&!u.$slotRefNode$&&(u.$slotRefNode$=s.$slotRefNode$))})):su.some(u=>u.$nodeToRelocate$===i)||su.push({$nodeToRelocate$:i}));e.nodeType===1&&lde(e)}},LJ=(t,e)=>t.nodeType===1?t.getAttribute("slot")===null&&e===""||t.getAttribute("slot")===e:t["s-sn"]===e?!0:e==="",cde=t=>{t.$attrs$&&t.$attrs$.ref&&t.$attrs$.ref(null),t.$children$&&t.$children$.map(cde)},xDe=(t,e)=>{const i=t.$hostElement$,r=t.$cmpMeta$,n=t.$vnode$||vP(null,null),s=uDe(e)?e:tde(null,null,e);ML=i.tagName,r.$attrsToReflect$&&(s.$attrs$=s.$attrs$||{},r.$attrsToReflect$.map(([o,a])=>s.$attrs$[a]=i[o])),s.$tag$=null,s.$flags$|=4,t.$vnode$=s,s.$elm$=n.$elm$=i.shadowRoot||i,lb=i["s-sc"],Que=i["s-cr"],ede=(r.$flags$&1)!==0,yP=!1,cb(n,s);{if(_s.$flags$|=1,e9){lde(s.$elm$);let o,a,l,c,u,h,f=0;for(;f<su.length;f++)o=su[f],a=o.$nodeToRelocate$,a["s-ol"]||(l=_u.createTextNode(""),l["s-nr"]=a,a.parentNode.insertBefore(a["s-ol"]=l,a));for(f=0;f<su.length;f++)if(o=su[f],a=o.$nodeToRelocate$,o.$slotRefNode$){for(c=o.$slotRefNode$.parentNode,u=o.$slotRefNode$.nextSibling,l=a["s-ol"];l=l.previousSibling;)if(h=l["s-nr"],h&&h["s-sn"]===a["s-sn"]&&c===h.parentNode&&(h=h.nextSibling,!h||!h["s-nr"])){u=h;break}(!u&&c!==a.parentNode||a.nextSibling!==u)&&a!==u&&(!a["s-hn"]&&a["s-ol"]&&(a["s-hn"]=a["s-ol"].parentNode.nodeName),c.insertBefore(a,u))}else a.nodeType===1&&(a.hidden=!0)}yP&&ade(s.$elm$),_s.$flags$&=-2,su.length=0}},SDe=(t,e)=>{},r9=(t,e)=>(t.$flags$|=16,SDe(t,t.$ancestorComponent$),qDe(()=>IDe(t,e))),IDe=(t,e)=>{const i=t.$hostElement$,r=Mv("scheduleUpdate",t.$cmpMeta$.$tagName$),n=i;let s;return e?s=Aw(n,"componentWillLoad"):s=Aw(n,"componentWillUpdate"),s=RJ(s,()=>Aw(n,"componentWillRender")),r(),RJ(s,()=>TDe(t,n,e))},TDe=async(t,e,i)=>{const r=t.$hostElement$,n=Mv("update",t.$cmpMeta$.$tagName$);r["s-rc"],i&&_De(t);const s=Mv("render",t.$cmpMeta$.$tagName$);CDe(t,e,r),s(),n(),EDe(t)},CDe=(t,e,i)=>{try{EJ=e,e=e.render&&e.render(),t.$flags$&=-17,t.$flags$|=2,(ab.hasRenderFn||ab.reflect)&&(ab.vdomRender||ab.reflect)&&(ab.hydrateServerSide||xDe(t,e))}catch(a){TC(a,t.$hostElement$)}return EJ=null,null},EDe=t=>{const e=t.$cmpMeta$.$tagName$,i=t.$hostElement$,r=Mv("postUpdate",e),n=i;t.$ancestorComponent$,Aw(n,"componentDidRender"),t.$flags$&64?(Aw(n,"componentDidUpdate"),r()):(t.$flags$|=64,Aw(n,"componentDidLoad"),r())},F_t=t=>{{const e=IC(t),i=e.$hostElement$.isConnected;return i&&(e.$flags$&18)===2&&r9(e,!1),i}},Aw=(t,e,i)=>{if(t&&t[e])try{return t[e](i)}catch(r){TC(r)}},RJ=(t,e)=>t&&t.then?t.then(e):e(),MDe=(t,e)=>IC(t).$instanceValues$.get(e),$De=(t,e,i,r)=>{const n=IC(t),s=t,o=n.$instanceValues$.get(e),a=n.$flags$,l=s;i=fDe(i,r.$members$[e][0]);const c=Number.isNaN(o)&&Number.isNaN(i);if(i!==o&&!c){n.$instanceValues$.set(e,i);{if(r.$watchers$&&a&128){const h=r.$watchers$[e];h&&h.map(f=>{try{l[f](i,o,e)}catch(m){TC(m,s)}})}if((a&18)===2){if(l.componentShouldUpdate&&l.componentShouldUpdate(i,o,e)===!1)return;r9(n,!1)}}}},ADe=(t,e,i)=>{if(e.$members$){t.watchers&&(e.$watchers$=t.watchers);const r=Object.entries(e.$members$),n=t.prototype;r.map(([s,[o]])=>{(o&31||o&32)&&Object.defineProperty(n,s,{get(){return MDe(this,s)},set(a){$De(this,s,a,e)},configurable:!0,enumerable:!0})});{const s=new Map;n.attributeChangedCallback=function(o,a,l){_s.jmp(()=>{const c=s.get(o);if(this.hasOwnProperty(c))l=this[c],delete this[c];else if(n.hasOwnProperty(c)&&typeof this[c]=="number"&&this[c]==l)return;this[c]=l===null&&typeof this[c]=="boolean"?!1:l})},t.observedAttributes=r.filter(([o,a])=>a[0]&15).map(([o,a])=>{const l=a[1]||o;return s.set(l,o),a[0]&512&&e.$attrsToReflect$.push([o,l]),l})}}return t},kDe=async(t,e,i,r,n)=>{if(!(e.$flags$&32)&&(n=t.constructor,e.$flags$|=32,customElements.whenDefined(i.$tagName$).then(()=>e.$flags$|=128),n.style)){let o=n.style;typeof o!="string"&&(o=o[e.$modeName$=pDe(t)]);const a=ide(i,e.$modeName$);if(!bP.has(a)){const l=Mv("registerStyles",i.$tagName$);yDe(a,o,!!(i.$flags$&1)),l()}}e.$ancestorComponent$,(()=>r9(e,!0))()},PDe=t=>{},ODe=t=>{if(!(_s.$flags$&1)){const e=IC(t),i=e.$cmpMeta$,r=Mv("connectedCallback",i.$tagName$);e.$flags$&1?(ude(t,e,i.$listeners$),PDe(e.$lazyInstance$)):(e.$flags$|=1,i.$flags$&12&&LDe(t),i.$members$&&Object.entries(i.$members$).map(([n,[s]])=>{if(s&31&&t.hasOwnProperty(n)){const o=t[n];delete t[n],t[n]=o}}),kDe(t,e,i)),r()}},LDe=t=>{const e=t["s-cr"]=_u.createComment("");e["s-cn"]=!0,t.insertBefore(e,t.firstChild)},RDe=t=>{if(!(_s.$flags$&1)){const e=IC(t);e.$rmListeners$&&(e.$rmListeners$.map(i=>i()),e.$rmListeners$=void 0)}},D_t=(t,e)=>{const i={$flags$:e[0],$tagName$:e[1]};i.$members$=e[2],i.$listeners$=e[3],i.$watchers$=t.$watchers$,i.$attrsToReflect$=[];const r=t.prototype.connectedCallback,n=t.prototype.disconnectedCallback;return Object.assign(t.prototype,{__registerHost(){VDe(this,i)},connectedCallback(){ODe(this),r&&r.call(this)},disconnectedCallback(){RDe(this),n&&n.call(this)},__attachShadow(){this.attachShadow({mode:"open",delegatesFocus:!!(i.$flags$&16)})}}),t.is=i.$tagName$,ADe(t,i)},N_t=(t,e)=>e,ude=(t,e,i,r)=>{i&&i.map(([n,s,o])=>{const a=DDe(t,n),l=FDe(e,o),c=NDe(n);_s.ael(a,s,l,c),(e.$rmListeners$=e.$rmListeners$||[]).push(()=>_s.rel(a,s,l,c))})},FDe=(t,e)=>i=>{try{ab.lazyLoad||t.$hostElement$[e](i)}catch(r){TC(r)}},DDe=(t,e)=>e&4?_u:e&8?CC:e&16?_u.body:t,NDe=t=>jDe?{passive:(t&1)!==0,capture:(t&2)!==0}:(t&2)!==0,dde=new WeakMap,IC=t=>dde.get(t),VDe=(t,e)=>{const i={$flags$:0,$hostElement$:t,$cmpMeta$:e,$instanceValues$:new Map};return ude(t,i,e.$listeners$),dde.set(t,i)},FJ=(t,e)=>e in t,TC=(t,e)=>(0,console.error)(t,e),bP=new Map,zDe=[],CC=typeof window<"u"?window:{},_u=CC.document||{head:{}},V_t=CC.HTMLElement||class{},_s={$flags$:0,$resourcesUrl$:"",jmp:t=>t(),raf:t=>requestAnimationFrame(t),ael:(t,e,i,r)=>t.addEventListener(e,i,r),rel:(t,e,i,r)=>t.removeEventListener(e,i,r),ce:(t,e)=>new CustomEvent(t,e)},jDe=(()=>{let t=!1;try{_u.addEventListener("e",null,Object.defineProperty({},"passive",{get(){t=!0}}))}catch{}return t})(),BDe=t=>Promise.resolve(t),UDe=(()=>{try{return new CSSStyleSheet,typeof new CSSStyleSheet().replaceSync=="function"}catch{}return!1})(),DJ=[],hde=[],GDe=(t,e)=>i=>{t.push(i),eV||(eV=!0,e&&_s.$flags$&4?HDe(tV):_s.raf(tV))},NJ=t=>{for(let e=0;e<t.length;e++)try{t[e](performance.now())}catch(i){TC(i)}t.length=0},tV=()=>{NJ(DJ),NJ(hde),(eV=DJ.length>0)&&_s.raf(tV)},HDe=t=>BDe().then(t),qDe=GDe(hde,!0);/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.4.3
 */const pde="calcite-mode-auto",fde="calcite-mode-dark",WDe="calcite-mode-light",z_t={autoMode:pde,darkMode:fde,lightMode:WDe,rtl:"calcite--rtl",calciteAnimate:"calcite-animate",calciteAnimateIn:"calcite-animate__in",calciteAnimateInUp:"calcite-animate__in-up",calciteAnimateInDown:"calcite-animate__in-down",calciteAnimateInRight:"calcite-animate__in-right",calciteAnimateInLeft:"calcite-animate__in-left",calciteAnimateInScale:"calcite-animate__in-scale"};/*!
* tabbable 6.1.2
* @license MIT, https://github.com/focus-trap/tabbable/blob/master/LICENSE
*/var mde=["input:not([inert])","select:not([inert])","textarea:not([inert])","a[href]:not([inert])","button:not([inert])","[tabindex]:not(slot):not([inert])","audio[controls]:not([inert])","video[controls]:not([inert])",'[contenteditable]:not([contenteditable="false"]):not([inert])',"details>summary:first-of-type:not([inert])","details:not([inert])"],wP=mde.join(","),gde=typeof Element>"u",$v=gde?function(){}:Element.prototype.matches||Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector,xP=!gde&&Element.prototype.getRootNode?function(t){var e;return t==null||(e=t.getRootNode)===null||e===void 0?void 0:e.call(t)}:function(t){return t==null?void 0:t.ownerDocument},SP=function t(e,i){var r;i===void 0&&(i=!0);var n=e==null||(r=e.getAttribute)===null||r===void 0?void 0:r.call(e,"inert"),s=n===""||n==="true",o=s||i&&e&&t(e.parentNode);return o},JDe=function(e){var i,r=e==null||(i=e.getAttribute)===null||i===void 0?void 0:i.call(e,"contenteditable");return r===""||r==="true"},yde=function(e,i,r){if(SP(e))return[];var n=Array.prototype.slice.apply(e.querySelectorAll(wP));return i&&$v.call(e,wP)&&n.unshift(e),n=n.filter(r),n},vde=function t(e,i,r){for(var n=[],s=Array.from(e);s.length;){var o=s.shift();if(!SP(o,!1))if(o.tagName==="SLOT"){var a=o.assignedElements(),l=a.length?a:o.children,c=t(l,!0,r);r.flatten?n.push.apply(n,c):n.push({scopeParent:o,candidates:c})}else{var u=$v.call(o,wP);u&&r.filter(o)&&(i||!e.includes(o))&&n.push(o);var h=o.shadowRoot||typeof r.getShadowRoot=="function"&&r.getShadowRoot(o),f=!SP(h,!1)&&(!r.shadowRootFilter||r.shadowRootFilter(o));if(h&&f){var m=t(h===!0?o.children:h.children,!0,r);r.flatten?n.push.apply(n,m):n.push({scopeParent:o,candidates:m})}else s.unshift.apply(s,o.children)}}return n},_de=function(e,i){return e.tabIndex<0&&(i||/^(AUDIO|VIDEO|DETAILS)$/.test(e.tagName)||JDe(e))&&isNaN(parseInt(e.getAttribute("tabindex"),10))?0:e.tabIndex},ZDe=function(e,i){return e.tabIndex===i.tabIndex?e.documentOrder-i.documentOrder:e.tabIndex-i.tabIndex},bde=function(e){return e.tagName==="INPUT"},YDe=function(e){return bde(e)&&e.type==="hidden"},KDe=function(e){var i=e.tagName==="DETAILS"&&Array.prototype.slice.apply(e.children).some(function(r){return r.tagName==="SUMMARY"});return i},XDe=function(e,i){for(var r=0;r<e.length;r++)if(e[r].checked&&e[r].form===i)return e[r]},QDe=function(e){if(!e.name)return!0;var i=e.form||xP(e),r=function(a){return i.querySelectorAll('input[type="radio"][name="'+a+'"]')},n;if(typeof window<"u"&&typeof window.CSS<"u"&&typeof window.CSS.escape=="function")n=r(window.CSS.escape(e.name));else try{n=r(e.name)}catch(o){return console.error("Looks like you have a radio button with a name attribute containing invalid CSS selector characters and need the CSS.escape polyfill: %s",o.message),!1}var s=XDe(n,e.form);return!s||s===e},eNe=function(e){return bde(e)&&e.type==="radio"},tNe=function(e){return eNe(e)&&!QDe(e)},iNe=function(e){var i,r=e&&xP(e),n=(i=r)===null||i===void 0?void 0:i.host,s=!1;if(r&&r!==e){var o,a,l;for(s=!!((o=n)!==null&&o!==void 0&&(a=o.ownerDocument)!==null&&a!==void 0&&a.contains(n)||e!=null&&(l=e.ownerDocument)!==null&&l!==void 0&&l.contains(e));!s&&n;){var c,u,h;r=xP(n),n=(c=r)===null||c===void 0?void 0:c.host,s=!!((u=n)!==null&&u!==void 0&&(h=u.ownerDocument)!==null&&h!==void 0&&h.contains(n))}}return s},VJ=function(e){var i=e.getBoundingClientRect(),r=i.width,n=i.height;return r===0&&n===0},rNe=function(e,i){var r=i.displayCheck,n=i.getShadowRoot;if(getComputedStyle(e).visibility==="hidden")return!0;var s=$v.call(e,"details>summary:first-of-type"),o=s?e.parentElement:e;if($v.call(o,"details:not([open]) *"))return!0;if(!r||r==="full"||r==="legacy-full"){if(typeof n=="function"){for(var a=e;e;){var l=e.parentElement,c=xP(e);if(l&&!l.shadowRoot&&n(l)===!0)return VJ(e);e.assignedSlot?e=e.assignedSlot:!l&&c!==e.ownerDocument?e=c.host:e=l}e=a}if(iNe(e))return!e.getClientRects().length;if(r!=="legacy-full")return!0}else if(r==="non-zero-area")return VJ(e);return!1},nNe=function(e){if(/^(INPUT|BUTTON|SELECT|TEXTAREA)$/.test(e.tagName))for(var i=e.parentElement;i;){if(i.tagName==="FIELDSET"&&i.disabled){for(var r=0;r<i.children.length;r++){var n=i.children.item(r);if(n.tagName==="LEGEND")return $v.call(i,"fieldset[disabled] *")?!0:!n.contains(e)}return!0}i=i.parentElement}return!1},IP=function(e,i){return!(i.disabled||SP(i)||YDe(i)||rNe(i,e)||KDe(i)||nNe(i))},iV=function(e,i){return!(tNe(i)||_de(i)<0||!IP(e,i))},sNe=function(e){var i=parseInt(e.getAttribute("tabindex"),10);return!!(isNaN(i)||i>=0)},oNe=function t(e){var i=[],r=[];return e.forEach(function(n,s){var o=!!n.scopeParent,a=o?n.scopeParent:n,l=_de(a,o),c=o?t(n.candidates):a;l===0?o?i.push.apply(i,c):i.push(a):r.push({documentOrder:s,tabIndex:l,item:n,isScope:o,content:c})}),r.sort(ZDe).reduce(function(n,s){return s.isScope?n.push.apply(n,s.content):n.push(s.content),n},[]).concat(i)},aNe=function(e,i){i=i||{};var r;return i.getShadowRoot?r=vde([e],i.includeContainer,{filter:iV.bind(null,i),flatten:!1,getShadowRoot:i.getShadowRoot,shadowRootFilter:sNe}):r=yde(e,i.includeContainer,iV.bind(null,i)),oNe(r)},j_t=function(e,i){i=i||{};var r;return i.getShadowRoot?r=vde([e],i.includeContainer,{filter:IP.bind(null,i),flatten:!0,getShadowRoot:i.getShadowRoot}):r=yde(e,i.includeContainer,IP.bind(null,i)),r},B_t=function(e,i){if(i=i||{},!e)throw new Error("No node provided");return $v.call(e,wP)===!1?!1:iV(i,e)},lNe=mde.concat("iframe").join(","),U_t=function(e,i){if(i=i||{},!e)throw new Error("No node provided");return $v.call(e,lNe)===!1?!1:IP(i,e)};const cNe={getShadowRoot:!0};function G_t(t){return Array.isArray(t)?t:Array.from(t)}function H_t(t){const e="dir",i=`[${e}]`,r=uNe(t,i);return r?r.getAttribute(e):"ltr"}function q_t(t,e,i){const r=`[${e}]`,n=t.closest(r);return n?n.getAttribute(e):i}function n9(t){return t.getRootNode()}function W_t(t){const e=n9(t);return"host"in e?e:null}function wde(t){return t.host||null}function J_t(t,{selector:e,id:i}){function r(n){if(!n)return null;n.assignedSlot&&(n=n.assignedSlot);const s=n9(n),o=i?"getElementById"in s?s.getElementById(i):null:e?s.querySelector(e):null,a=wde(s);return o||(a?r(a):null)}return r(t)}function uNe(t,e){function i(r){return r?r.closest(e)||i(wde(n9(r))):null}return i(t)}function dNe(t,e){return xde(t,e)}function xde(t,e){if(!t)return;const i=e(t);if(i!==void 0)return i;const{parentNode:r}=t;return xde(r instanceof ShadowRoot?r.host:r,e)}function Z_t(t,e){return!!dNe(e,i=>i===t?!0:void 0)}function hNe(t){return typeof(t==null?void 0:t.setFocus)=="function"}async function Y_t(t){if(t)return hNe(t)?t.setFocus():t.focus()}function K_t(t){t&&(aNe(t,cNe)[0]||t).focus()}const pT=":not([slot])";function X_t(t,e,i){e&&!Array.isArray(e)&&typeof e!="string"&&(i=e,e=null);const r=e?Array.isArray(e)?e.map(n=>`[slot="${n}"]`).join(","):`[slot="${e}"]`:pT;return i!=null&&i.all?pNe(t,r,i):fNe(t,r,i)}function Sde(t,e){return t?Array.from(t.children||[]).filter(i=>i==null?void 0:i.matches(e)):[]}function pNe(t,e,i){let r=e===pT?Sde(t,pT):Array.from(t.querySelectorAll(e));r=i&&i.direct===!1?r:r.filter(s=>s.parentElement===t),r=i!=null&&i.matches?r.filter(s=>s==null?void 0:s.matches(i.matches)):r;const n=i==null?void 0:i.selector;return n?r.map(s=>Array.from(s.querySelectorAll(n))).reduce((s,o)=>[...s,...o],[]).filter(s=>!!s):r}function fNe(t,e,i){let r=e===pT?Sde(t,pT)[0]||null:t.querySelector(e);r=i&&i.direct===!1||(r==null?void 0:r.parentElement)===t?r:null,r=i!=null&&i.matches?r!=null&&r.matches(i.matches)?r:null:r;const n=i==null?void 0:i.selector;return n?r==null?void 0:r.querySelector(n):r}function Q_t(t,e,i){if(typeof e=="string"&&e!=="")return e;if(e==="")return t[i]}function ebt(t){return(!!t).toString()}function tbt(t){return!!mNe(t).length}function mNe(t){return t.target.assignedElements({flatten:!0})}function ibt(t){return!!(t.isPrimary&&t.button===0)}/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.4.3
 */function zJ(){const{classList:t}=document.body,e=window.matchMedia("(prefers-color-scheme: dark)").matches,i=()=>t.contains(fde)||t.contains(pde)&&e?"dark":"light",r=o=>document.body.dispatchEvent(new CustomEvent("calciteModeChange",{bubbles:!0,detail:{mode:o}})),n=o=>{s!==o&&r(o),s=o};let s=i();r(s),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",o=>n(o.matches?"dark":"light")),new MutationObserver(()=>n(i())).observe(document.body,{attributes:!0,attributeFilter:["class"]})}function gNe(){typeof window<"u"&&typeof location<"u"&&typeof document<"u"&&window.location===location&&window.document===document&&(document.readyState==="interactive"?zJ():document.addEventListener("DOMContentLoaded",()=>zJ(),{once:!0}))}const yNe=gNe;yNe();let Ide;function vNe(){try{rDe(".")}catch{nDe(Jl(Tt(Ide)))}}function Zd(t){var i;const e=[];for(const r of Object.keys(t))customElements.get(`calcite-${r}`)||e.push((i=t[r])==null?void 0:i.call(t));return Promise.all(e)}Ide="components/assets";const Tde=Symbol("widget"),_Ne=Symbol("widget-test-data"),bNe=[],wNe={},TP=new WeakMap;function Cde(t,e){let i=e.children;if(i&&i.length)for(let n=0;n<i.length;++n)i[n]=Cde(t,i[n]);else i=bNe;const r=e.vnodeSelector;if(s9(r)){const n=e.properties||wNe,s=n.key||r;return{vnodeSelector:"div",properties:{key:s,afterCreate:xNe,afterUpdate:SNe,afterRemoved:Ede,parentWidget:t,widgetConstructor:r,widgetProperties:{...n,key:s,children:i}},children:void 0,text:void 0,domNode:null}}return e}function xNe(t,e,i,{parentWidget:r,widgetConstructor:n,widgetProperties:s}){var a;const o=new n(s);o.container=t,TP.set(t,o),(a=o.afterCreate)==null||a.call(o,o,t),r._internalHandles.add(Et(()=>Ede(t)))}function SNe(t,e,i,{widgetProperties:r}){var s;const n=TP.get(t);n&&(n.set(r),(s=n.afterUpdate)==null||s.call(n,n,t))}function Ede(t){var i;const e=TP.get(t);e&&((i=e.afterRemoved)==null||i.call(e,e,t),e.destroy(),TP.delete(t))}function s9(t){return typeof t=="function"&&t[Tde]}const jJ=new Set;function INe(t){jJ.add(t),t.finally(()=>jJ.delete(t))}var Mde;const TNe="esri.widgets.Widget";let CNe=0;const ENe={widgetIcon:"esri-icon-checkbox-unchecked"};function $de(t,e){for(const i in e)t[i]!=null&&(typeof t[i]=="object"&&typeof e[i]=="object"?$de(t[i],e==null?void 0:e[i]):t[i]=e[i]);return t}const MNe=iDe({postProcessProjectionOptions(t){const e=t.eventHandlerInterceptor,i=/capture$/i;t.eventHandlerInterceptor=(r,n,s,o)=>{const a=e==null?void 0:e(r,n,s,o),l=i.test(r);if(!((r=r.replace(i,"")).toLowerCase()in s)||l){const c=r[2].toLowerCase()+r.slice(3),u=m=>a==null?void 0:a.call(s,m);s.addEventListener(c,u,l);const h=()=>s.removeEventListener(c,u,l),f=o.afterRemoved;o.afterRemoved=m=>{f==null||f(m),h()}}return a}},handleInterceptedEvent(t,e,i,r){const{eventPhase:n,type:s}=r,o=n===Event.CAPTURING_PHASE;let a=`on${s}${o?"capture":""}`;const l=e.properties;(l&&a in l||(a=`on${s[0].toUpperCase()}${s.slice(1)}${o?"Capture":""}`,l&&a in l))&&(Ece(),t.scheduleRender(),l[a].call(l.bind||i,r))}});let n5=!1,mn=class extends F1(an.EventedAccessor){constructor(e,i){super(e,i),this._attached=!1,this._internalHandles=new gs,this._projector=MNe,this._readyForTrueRender=!1,this.iconClass=ENe.widgetIcon,this.icon=null,this.key=this,this._loadLocale=Ad(async()=>{if(this._messageBundleProps&&this._messageBundleProps.length){const o=await br(this._messageBundleProps.map(async({bundlePath:a,propertyName:l})=>{if(this.destroyed)return;let c=await ev(a);this.uiStrings&&Object.keys(this.uiStrings)&&(c=$de(U(c),this.uiStrings)),this[l]=c}));if(this.destroyed)return;for(const a of o)a.error&&ie.getLogger(this).error("widget-intl:locale-error",this.declaredClass,a.error)}await this.loadLocale()}),vNe();const r="esri-widget-uid-"+QU(),n=this.render.bind(this);this._trackingTarget=new GO(()=>this.scheduleRender());const s=()=>{var u;if(!this._readyForTrueRender||this.destroyed)return null;const o=n();let{properties:a}=o;a||(o.properties=a={});const{key:l}=a;l||(a.key=r),this.visible?a.styles||(a.styles={}):(a.class="",a.styles={display:"none"}),a.styles.display||(a.styles.display="");let c=0;return(u=o.children)==null||u.forEach(h=>{if(s9(h.vnodeSelector))return;let{properties:f}=h;f||(h.properties=f={}),f.key||(f.key=`${this.id}--${c++}`)}),Cde(this,o)};this.render=()=>{if(n5)return s();let o=JOe(this)??null;if(o)return o;this._trackingTarget.clear(),n5=!0;try{o=vp(this._trackingTarget,s)}catch(a){throw console.error(a),a}finally{n5=!1}return o&&ZOe(this,o),o},this.addResolvingPromise(this._resourcesFetch=this.beforeFirstRender().then(()=>{this._readyForTrueRender=!0,this._postInitialize()})),INe(this._resourcesFetch)}normalizeCtorArgs(e,i){const r={...e};return i&&(r.container=i),r}postInitialize(){}beforeFirstRender(){return Promise.all([this.loadDependencies(),this._loadLocale()]).then(()=>{}).catch(Ek)}async loadDependencies(){}async loadLocale(){}destroy(){this.destroyed||(je(this._trackingTarget),je(this.viewModel),this._detach(this.container),this._set("container",null),this._internalHandles.destroy(),this._emitter.clear(),this.render=()=>null,this._projector=null,N3(this))}set container(e){this._get("container")||this._set("container",e)}castContainer(e){return vL(e)}get domNode(){return this.container}set domNode(e){this.container=e}get id(){return this._get("id")||this.get("container.id")||Date.now().toString(16)+"-widget-"+CNe++}set id(e){e&&this._set("id",e)}get label(){return this.declaredClass.split(".").pop()}set label(e){this._overrideIfSome("label",e)}get renderable(){return this._resourcesFetch}get visible(){return this._get("visible")}set visible(e){this._set("visible",e)}get[(Mde=Tde,_Ne)](){return{projector:this._projector}}render(){throw new Error("not implemented")}scheduleRender(){this.destroyed||(N3(this),this._projector.scheduleRender())}classes(...e){return q0.apply(this,e)}renderNow(){N3(this),this._projector.renderNow()}_postInitialize(){var i;if(this.destroyed)return;this.scheduleRender(),(i=this._delegatedEventNames)!=null&&i.length&&this._internalHandles.add(J(()=>this.viewModel,(r,n)=>{n&&this._internalHandles.remove("delegated-events"),r&&BO(r)&&this._internalHandles.add(this._delegatedEventNames.map(s=>Wh(r,s,o=>{this.emit(s,o)})),"delegated-events")},Le)),this.postInitialize();const e=async()=>{await this._loadLocale().catch(Ek),this.scheduleRender()};this._internalHandles.add([nC(e),J(()=>this.uiStrings,e),tn(()=>this.container,r=>{this.destroyed||this._attach(r)},{initial:!0,once:!0})])}_attach(e){e&&(this._projector.merge(e,this.render),this._attached=!0)}_detach(e){var i;this._attached&&(this._projector.detach(this.render),this._attached=!1),(i=e==null?void 0:e.parentNode)==null||i.removeChild(e)}};mn[Mde]=!0,d([p()],mn.prototype,"_readyForTrueRender",void 0),d([p({value:null})],mn.prototype,"container",null),d([tt("container")],mn.prototype,"castContainer",null),d([p()],mn.prototype,"iconClass",void 0),d([p()],mn.prototype,"icon",void 0),d([p()],mn.prototype,"id",null),d([p()],mn.prototype,"label",null),d([p()],mn.prototype,"renderable",null),d([p()],mn.prototype,"uiStrings",void 0),d([p()],mn.prototype,"viewModel",void 0),d([p({value:!0})],mn.prototype,"visible",null),d([p()],mn.prototype,"key",void 0),d([p()],mn.prototype,"children",void 0),d([p()],mn.prototype,"afterCreate",void 0),d([p()],mn.prototype,"afterUpdate",void 0),d([p()],mn.prototype,"afterRemoved",void 0),mn=d([A(TNe)],mn);const di=mn;function BJ(t,e){return t&&"copyright"in t&&(!e||typeof t.originOf=="function"&&t.originOf("copyright")==="user")}function $Ne(t,e){return t.length!==e.length||t.some((i,r)=>i.text!==e[r].text)}function qE(t,e,i){!i||!e||t.find(r=>r.layerView===e&&r.text===i)||t.push({text:i,layerView:e})}function ANe(t){return t.type==="bing-maps"}const Qp=[];let ub=class extends l1{constructor(e){super(e),this._clear=()=>{this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.handles.remove("suspension"),this.notifyChange("state")},this._pendingAttributions=new Set,this._fetchedAttributionData=new Map,this.items=new ye,this.view=null,this._allLayerViewsChange=i=>{this.handles.remove("suspension");const r=this.get("view.allLayerViews");r&&this.handles.add(r.map(n=>J(()=>{var s;return[n.suspended,(s=n.layer)==null?void 0:s.attributionVisible]},()=>this._updateAttributionItems())),"suspension"),i&&i.removed&&i.removed.forEach(n=>{this._pendingAttributions.delete(n),this._fetchedAttributionData.delete(n)}),this._updateAttributionItems()},this.handles.add([ui(()=>{var i;return(i=this.view)==null?void 0:i.allLayerViews},"change",i=>this._allLayerViewsChange(i),{onListenerAdd:()=>this._allLayerViewsChange(),onListenerRemove:this._clear}),tn(()=>{var i;return((i=this.view)==null?void 0:i.stationary)===!0},()=>this._updateAttributionItems())])}destroy(){this.view=null,this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.items.removeAll()}get state(){return this.get("view.ready")?this._pendingAttributions.size>0?"loading":"ready":"disabled"}_updateAttributionItems(){const e=this.view,i=e==null?void 0:e.allLayerViews;Qp.length=0,e&&i?(i.forEach(r=>{var o;if(r.suspended||!((o=r.layer)!=null&&o.attributionVisible))return;const n=r.layer;if(BJ(n,"user"))return void qE(Qp,r,n.copyright);if(n.hasAttributionData){if(this._fetchedAttributionData.has(r)){const a=this._fetchedAttributionData.get(r);return void(a?qE(Qp,r,this._getDynamicAttribution(a,e,n)):BJ(n)&&qE(Qp,r,n.copyright))}return void this._fetchAttributionData(r)}const s=n.get("portalItem.accessInformation");qE(Qp,r,s||n.copyright)}),$Ne(this.items,Qp)&&(this.items.removeAll(),this.items.addMany(Qp)),Qp.length=0,this.notifyChange("state")):this._clear()}async _fetchAttributionData(e){if(this._pendingAttributions.has(e))return;this._pendingAttributions.add(e);const i=await tC(e.layer.fetchAttributionData());if(this._pendingAttributions.has(e)){const r=i.ok?this._createContributionIndex(i.value,ANe(e.layer)):null;this._pendingAttributions.delete(e),this._fetchedAttributionData.set(e,r)}this._updateAttributionItems()}_createContributionIndex(e,i){const r=e.contributors,n={};if(!r)return n;for(let s=0;s<r.length;s++){const o=r[s],a=o.coverageAreas;if(!a)return;for(const l of a){const c=l.bbox,u=l.zoomMin-(i&&l.zoomMin?1:0),h=l.zoomMax-(i&&l.zoomMax?1:0),f=new Re({xmin:c[1],ymin:c[0],xmax:c[3],ymax:c[2],spatialReference:Ee.WGS84}),m={extent:sp(f),attribution:o.attribution||"",score:l.score!=null?l.score:100,id:s};for(let g=u;g<=h;g++)n[g]??(n[g]=[]),n[g].push(m)}}return n.maxKey=Math.max.apply(null,Object.keys(n)),n}_getDynamicAttribution(e,i,r){var u;const{extent:n,scale:s}=i;let o=((u=r.tileInfo)==null?void 0:u.scaleToZoom(s))??0;if(o=Math.min(e.maxKey??0,Math.round(o)),!n||o==null||o<=-1)return"";const a=e[o],l=rC(n.center.clone().normalize(),i.spatialReference),c=new Set;return a?a.filter(h=>{const f=h.id,m=!c.has(f)&&l&&h.extent&&YO(h.extent,l);return m&&c.add(f),m}).sort((h,f)=>f.score-h.score||h.objectId-f.objectId).map(h=>h.attribution).join(", "):""}};d([p({readOnly:!0,type:ye})],ub.prototype,"items",void 0),d([p({readOnly:!0})],ub.prototype,"state",null),d([p()],ub.prototype,"view",void 0),ub=d([A("esri.widgets.Attribution.AttributionViewModel")],ub);const Ade=ub;function wr(){return function(t,e){if(!t[e])throw new TypeError(`Cannot auto bind undefined function '${String(e)}'`);return{value:PNe(t[e])}}}function kNe(t){const e=t==null?void 0:t.type;return t instanceof KeyboardEvent||e==="keyup"||e==="keydown"||e==="keypress"}function PNe(t){return function(e,...i){kNe(e)?W0(e.key)&&(e.preventDefault(),e.stopPropagation(),e.target.click()):t.call(this,e,...i)}}function ut(t){return(e,i)=>{e.hasOwnProperty("_messageBundleProps")||(e._messageBundleProps=e._messageBundleProps?e._messageBundleProps.slice():[]),e._messageBundleProps.push({bundlePath:t,propertyName:i})}}var ONe=function(t){return{vnodeSelector:"",properties:void 0,children:void 0,text:t.toString(),domNode:null}},kde=function(t,e){for(var i=0,r=t.length;i<r;i++){var n=t[i];Array.isArray(n)?kde(n,e):n!=null&&n!==!1&&(n.hasOwnProperty("vnodeSelector")||(n=ONe(n)),e.push(n))}},LNe=function(t,e){for(var i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];if(i.length===1&&typeof i[0]=="string")return{vnodeSelector:t,properties:e||void 0,children:void 0,text:i[0],domNode:null};var n=[];return kde(i,n),{vnodeSelector:t,properties:e||void 0,children:n,text:void 0,domNode:null}};function M(t,e,...i){return typeof t!="function"||s9(t)?LNe(t,e,...i):t(e,...i)}const y_="esri-attribution",ef={base:`${y_} esri-widget`,poweredBy:`${y_}__powered-by`,sources:`${y_}__sources`,open:`${y_}--open`,sourcesOpen:`${y_}__sources--open`,link:`${y_}__link`,widgetIcon:"esri-icon-description",interactive:"esri-interactive"};let Hs=class extends di{constructor(e,i){super(e,i),this._isOpen=!1,this._attributionTextOverflowed=!1,this._prevSourceNodeHeight=0,this._resizeObserver=new ResizeObserver(r=>r.forEach(({target:n})=>this._checkSourceTextOverflow(n))),this.iconClass=ef.widgetIcon,this.icon=null,this.itemDelimiter=" | ",this.messages=null,this.viewModel=new Ade}initialize(){this.addHandles(ui(()=>{var e;return(e=this.viewModel)==null?void 0:e.items},"change",()=>this.scheduleRender()))}destroy(){var e;(e=this._resizeObserver)==null||e.disconnect()}get _isInteractive(){return this._isOpen||this._attributionTextOverflowed}get attributionText(){return this.viewModel.items.reduce((e,i)=>(e.includes(i.text)||e.push(i.text),e),[]).join(this.itemDelimiter)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){const e={[ef.open]:this._isOpen};return M("div",{bind:this,class:this.classes(ef.base,e),dir:"ltr",onclick:this._toggleState,onkeydown:this._toggleState},this.renderSourcesNode(),this.renderPoweredBy())}renderPoweredBy(){return M("div",{class:ef.poweredBy},"Powered by"," ",M("a",{class:ef.link,href:"http://www.esri.com/",target:"_blank",rel:"noreferrer"},"Esri"))}renderSourcesNode(){const e=this._isOpen,i=this._isInteractive,r=i?"0":"",{attributionText:n}=this,s={[ef.sourcesOpen]:e,[ef.interactive]:i};return M("div",{afterCreate:this._afterSourcesNodeCreate,bind:this,class:this.classes(ef.sources,s),innerHTML:n,tabindex:r})}_afterSourcesNodeCreate(e){this._prevSourceNodeHeight=e.clientWidth,this._resizeObserver.observe(e)}_checkSourceTextOverflow(e){let i=!1;const{clientHeight:r,clientWidth:n,scrollWidth:s}=e,o=s>n,a=this._attributionTextOverflowed!==o;if(this._attributionTextOverflowed=o,a&&(i=!0),this._isOpen){const l=r<this._prevSourceNodeHeight;this._prevSourceNodeHeight=r,l&&(this._isOpen=!1,i=!0)}i&&this.scheduleRender()}_toggleState(){this._isInteractive&&(this._isOpen=!this._isOpen)}};d([p()],Hs.prototype,"_isOpen",void 0),d([p()],Hs.prototype,"_isInteractive",null),d([p()],Hs.prototype,"_attributionTextOverflowed",void 0),d([p()],Hs.prototype,"_prevSourceNodeHeight",void 0),d([p({readOnly:!0,dependsOn:["viewModel.items.length","itemDelimiter"]})],Hs.prototype,"attributionText",null),d([p()],Hs.prototype,"iconClass",void 0),d([p()],Hs.prototype,"icon",void 0),d([p()],Hs.prototype,"itemDelimiter",void 0),d([p()],Hs.prototype,"label",null),d([p(),ut("esri/widgets/Attribution/t9n/Attribution")],Hs.prototype,"messages",void 0),d([p()],Hs.prototype,"view",null),d([p({type:Ade})],Hs.prototype,"viewModel",void 0),d([wr()],Hs.prototype,"_toggleState",null),Hs=d([A("esri.widgets.Attribution")],Hs);const RNe=Hs,Pde=t=>{let e=class extends t{constructor(...i){super(...i),this.goToOverride=null,this.view=null}callGoTo(i){const{view:r}=this;return lo(r),this.goToOverride?this.goToOverride(r,i):r.goTo(i.target,i.options)}};return d([p()],e.prototype,"goToOverride",void 0),d([p()],e.prototype,"view",void 0),e=d([A("esri.widgets.support.GoTo")],e),e},FNe="esri.widgets.CompassViewModel";let $y=class extends Pde(he){constructor(e){super(e),this._handles=new gs,this.orientation={x:0,y:0,z:0},this.view=null,this._updateForCamera=this._updateForCamera.bind(this),this._updateForRotation=this._updateForRotation.bind(this),this._updateRotationWatcher=this._updateRotationWatcher.bind(this)}initialize(){this._handles.add(J(()=>this.view,this._updateRotationWatcher,Le))}destroy(){$i(this._handles),this.view=null}get canShowNorth(){const e=this.get("view.spatialReference");return!(!e||!e.isWebMercator&&!e.isGeographic)}get state(){return this.get("view.ready")?this.canShowNorth?"compass":"rotation":"disabled"}reset(){var i;if(!this.get("view.ready"))return;const e={};((i=this.view)==null?void 0:i.type)==="2d"?e.rotation=0:e.heading=0,this.callGoTo({target:e})}_updateForRotation(e){e!=null&&(this.orientation={z:e})}_updateForCamera(e){if(!e)return;const i=-e.heading;this.orientation={x:0,y:0,z:i}}_updateRotationWatcher(e){this._handles.removeAll(),e&&this._handles.add(e.type==="2d"?J(()=>e==null?void 0:e.rotation,this._updateForRotation,Le):J(()=>e==null?void 0:e.camera,this._updateForCamera,Le))}};d([p({readOnly:!0})],$y.prototype,"canShowNorth",null),d([p()],$y.prototype,"orientation",void 0),d([p({readOnly:!0})],$y.prototype,"state",null),d([p()],$y.prototype,"view",void 0),$y=d([A(FNe)],$y);const Ode=$y,tf={base:"esri-compass esri-widget--button esri-widget",text:"esri-icon-font-fallback-text",icon:"esri-compass__icon",rotationIcon:"esri-icon-dial",northIcon:"esri-icon-compass",widgetIcon:"esri-icon-locate-circled",interactive:"esri-interactive",disabled:"esri-disabled"};let Dc=class extends di{constructor(e,i){super(e,i),this.iconClass=tf.widgetIcon,this.icon=null,this.messages=null,this.viewModel=new Ode}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}reset(){return this.viewModel.reset()}render(){const{orientation:e,state:i}=this.viewModel,r=i==="disabled",n=(i==="rotation"?"rotation":"compass")=="compass",s=r?-1:0,o={[tf.disabled]:r,[tf.interactive]:!r},a={[tf.northIcon]:n,[tf.rotationIcon]:!n},{messages:l}=this;return M("div",{bind:this,class:this.classes(tf.base,o),onclick:this._reset,onkeydown:this._reset,role:"button",tabIndex:s,"aria-label":l.reset,title:l.reset},M("span",{"aria-hidden":"true",class:this.classes(tf.icon,a),styles:this._toRotationTransform(e)}),M("span",{class:tf.text},l.reset))}_reset(){this.viewModel.reset()}_toRotationTransform(e){return{transform:`rotateZ(${e.z}deg)`}}};d([p()],Dc.prototype,"goToOverride",null),d([p()],Dc.prototype,"iconClass",void 0),d([p()],Dc.prototype,"icon",void 0),d([p()],Dc.prototype,"label",null),d([p(),ut("esri/widgets/Compass/t9n/Compass")],Dc.prototype,"messages",void 0),d([p()],Dc.prototype,"view",null),d([p({type:Ode})],Dc.prototype,"viewModel",void 0),d([wr()],Dc.prototype,"_reset",null),Dc=d([A("esri.widgets.Compass")],Dc);const DNe=Dc,v_="esri-navigation-toggle",ml={base:`${v_} esri-widget`,button:`${v_}__button esri-widget--button`,activeButton:`${v_}__button--active`,panButton:`${v_}__button--pan`,rotateButton:`${v_}__button--rotate`,isLayoutHorizontal:`${v_}--horizontal`,rotationIcon:"esri-icon-rotate",panIcon:"esri-icon-pan",widgetIcon:"esri-icon-pan2",disabled:"esri-disabled"};let db=class extends he{constructor(e){super(e),this.navigationMode="pan",this.view=null}initialize(){this.own(tn(()=>{var e;return(e=this.view)==null?void 0:e.inputManager},()=>this._setNavigationMode()))}destroy(){this.view=null}get state(){var e;return this.get("view.ready")&&((e=this.view)==null?void 0:e.type)==="3d"?"ready":"disabled"}toggle(){this.state!=="disabled"&&(this.navigationMode=this.navigationMode!=="pan"?"pan":"rotate",this._setNavigationMode())}_setNavigationMode(){this.get("view.inputManager").primaryDragAction=this.navigationMode==="pan"?"pan":"rotate"}};d([p({readOnly:!0})],db.prototype,"state",null),d([p()],db.prototype,"navigationMode",void 0),d([p()],db.prototype,"view",void 0),db=d([A("esri.widgets.NavigationToggleViewModel")],db);const Lde=db;let Nc=class extends di{constructor(e,i){super(e,i),this.iconClass=ml.widgetIcon,this.icon=null,this.messages=null,this.viewModel=new Lde}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}set layout(e){e!=="horizontal"&&(e="vertical"),this._set("layout",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}toggle(){return this.viewModel.toggle()}render(){const e=this.get("viewModel.state")==="disabled",i=this.get("viewModel.navigationMode")==="pan",r={[ml.disabled]:e,[ml.isLayoutHorizontal]:this.layout==="horizontal"},n={[ml.activeButton]:i},s={[ml.activeButton]:!i},o=e?-1:0,a=this.messages.toggle;return M("div",{bind:this,class:this.classes(ml.base,r),onclick:this._toggle,onkeydown:this._toggle,tabIndex:o,"aria-label":a,title:a},M("div",{class:this.classes(ml.button,ml.panButton,n)},M("span",{class:ml.panIcon})),M("div",{class:this.classes(ml.button,ml.rotateButton,s)},M("span",{class:ml.rotationIcon})))}_toggle(){this.toggle()}};d([p()],Nc.prototype,"iconClass",void 0),d([p()],Nc.prototype,"icon",void 0),d([p()],Nc.prototype,"label",null),d([p({value:"vertical"})],Nc.prototype,"layout",null),d([p(),ut("esri/widgets/NavigationToggle/t9n/NavigationToggle")],Nc.prototype,"messages",void 0),d([p()],Nc.prototype,"view",null),d([p({type:Lde})],Nc.prototype,"viewModel",void 0),d([wr()],Nc.prototype,"_toggle",null),Nc=d([A("esri.widgets.NavigationToggle")],Nc);const NNe=Nc,Ox={button:"esri-widget--button esri-widget",disabled:"esri-disabled",interactive:"esri-interactive",iconText:"esri-icon-font-fallback-text",icon:"esri-icon"};let _h=class extends di{constructor(){super(...arguments),this.enabled=!0,this.iconClass=null,this.icon=null,this.title=""}render(){const e=this.enabled?0:-1,i={[Ox.disabled]:!this.enabled,[Ox.interactive]:this.enabled};return M("div",{bind:this,class:this.classes(Ox.button,i),onclick:this._triggerAction,onkeydown:this._triggerAction,role:"button",tabIndex:e,title:this.title},M("span",{"aria-hidden":"true",role:"presentation",class:this.classes(Ox.icon,this.iconClass??"")}),M("span",{class:Ox.iconText},this.title))}_triggerAction(){this.action.call(this)}};d([p()],_h.prototype,"action",void 0),d([p()],_h.prototype,"enabled",void 0),d([p()],_h.prototype,"iconClass",void 0),d([p()],_h.prototype,"icon",void 0),d([p()],_h.prototype,"title",void 0),d([wr()],_h.prototype,"_triggerAction",null),_h=d([A("esri.widgets.IconButton")],_h);const UJ=_h;let hb=class extends he{get canZoomIn(){if(!this.get("view.ready"))return!1;const e=this.get("view.animation.target.scale")||this.get("view.scale"),i=this.get("view.constraints.effectiveMaxScale");return i===0||e>i}get canZoomOut(){if(!this.get("view.ready"))return!1;const e=this.get("view.animation.target.scale")||this.get("view.scale"),i=this.get("view.constraints.effectiveMinScale");return i===0||e<i}};d([p({readOnly:!0})],hb.prototype,"canZoomIn",null),d([p({readOnly:!0})],hb.prototype,"canZoomOut",null),d([p()],hb.prototype,"view",void 0),hb=d([A("esri.widgets.Zoom.ZoomConditions2D")],hb);const VNe=hb;let pb=class extends he{get canZoomIn(){return!!this.view.ready}get canZoomOut(){return!!this.view.ready}};d([p({readOnly:!0})],pb.prototype,"canZoomIn",null),d([p({readOnly:!0})],pb.prototype,"canZoomOut",null),d([p()],pb.prototype,"view",void 0),pb=d([A("esri.widgets.Zoom.ZoomConditions3D")],pb);const zNe=pb;let Mf=class extends he{constructor(e){super(e)}destroy(){this.view=null}get canZoomIn(){return this._zoomConditions!=null&&this._zoomConditions.canZoomIn}get canZoomOut(){var e;return this._zoomConditions!=null&&((e=this._zoomConditions)==null?void 0:e.canZoomOut)}get state(){var e;return(e=this.view)!=null&&e.ready?"ready":"disabled"}set view(e){e?e.type==="2d"?this._zoomConditions=new VNe({view:e}):e.type==="3d"&&(this._zoomConditions=new zNe({view:e})):this._zoomConditions=null,this._set("view",e)}zoomIn(){if(!this.canZoomIn)return;const e=this.view;e.type==="2d"?e.mapViewNavigation.zoomIn():$d(e.goTo({zoomFactor:2}))}zoomOut(){if(!this.canZoomOut)return;const e=this.view;e.type==="2d"?e.mapViewNavigation.zoomOut():$d(e.goTo({zoomFactor:.5}))}};d([p()],Mf.prototype,"_zoomConditions",void 0),d([p()],Mf.prototype,"canZoomIn",null),d([p()],Mf.prototype,"canZoomOut",null),d([p({readOnly:!0})],Mf.prototype,"state",null),d([p()],Mf.prototype,"view",null),Mf=d([A("esri.widgets.Zoom.ZoomViewModel")],Mf);const Rde=Mf,Lx={base:"esri-zoom esri-widget",horizontalLayout:"esri-zoom--horizontal",zoomInIcon:"esri-icon-plus",zoomOutIcon:"esri-icon-minus",widgetIcon:"esri-icon-zoom-in-magnifying-glass"};let ed=class extends di{constructor(e,i){super(e,i),this.iconClass=Lx.widgetIcon,this.icon=null,this.messages=null,this.viewModel=new Rde}initialize(){this._zoomInButton=new UJ({action:this.zoomIn.bind(this),iconClass:Lx.zoomInIcon}),this._zoomOutButton=new UJ({action:this.zoomOut.bind(this),iconClass:Lx.zoomOutIcon})}destroy(){this._zoomInButton=je(this._zoomInButton),this._zoomOutButton=je(this._zoomOutButton)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}set layout(e){e!=="horizontal"&&(e="vertical"),this._set("layout",e)}set view(e){this.viewModel.view=e}get view(){return this.viewModel.view}render(){const e=this.viewModel,i={[Lx.horizontalLayout]:this.layout==="horizontal"},{canZoomIn:r,canZoomOut:n}=e;this._zoomInButton.enabled=r,this._zoomOutButton.enabled=n;const{zoomIn:s,zoomOut:o}=this.messages;return this._zoomInButton.title=s,this._zoomOutButton.title=o,M("div",{class:this.classes(Lx.base,i)},this._zoomInButton.render(),this._zoomOutButton.render())}zoomIn(){return this.viewModel.zoomIn()}zoomOut(){return this.viewModel.zoomOut()}};d([p()],ed.prototype,"iconClass",void 0),d([p()],ed.prototype,"icon",void 0),d([p()],ed.prototype,"label",null),d([p({value:"vertical"})],ed.prototype,"layout",null),d([p(),ut("esri/widgets/Zoom/t9n/Zoom")],ed.prototype,"messages",void 0),d([p()],ed.prototype,"view",null),d([p({type:Rde})],ed.prototype,"viewModel",void 0),ed=d([A("esri.widgets.Zoom")],ed);const jNe=ed;function BNe(t){return(t==null?void 0:t.view)!==void 0}let lA=class extends ZFe{constructor(e){super(e),this._defaultPositionLookup={attribution:"manual",compass:"top-left","navigation-toggle":"top-left",zoom:"top-left"},this.components=[],this._updateViewAwareWidgets=i=>{this.components.forEach(r=>{const n=this._find(r),s=n==null?void 0:n.widget;BNe(s)&&(s.view=i)})},this._componentsWatcher=(i,r)=>{this._removeComponents(r),this._addComponents(i),this._adjustPadding(i)}}initialize(){this.addHandles([J(()=>this.components,this._componentsWatcher,Le),J(()=>this.view,this._updateViewAwareWidgets,Le)])}_add(e,i,r,n,s){let o=e;if(typeof e=="string"&&this._defaultPositionLookup[e]){if(this._find(e))return;o=this._createComponent(e)}super._add(o,i,r,n,s)}_removeComponents(e){e.forEach(i=>{const r=this._find(i);r&&(this.remove(r),r.destroy())})}_adjustPadding(e){if(!e.includes("attribution")&&!this._isOverridden("padding")){const{top:i}=this.padding;this.padding=i}}_addComponents(e){this.constructed&&e.forEach(i=>this.add(this._createComponent(i),this._defaultPositionLookup[i]))}_createComponent(e){const i=this._createWidget(e);return new aA({id:e,node:i})}_createWidget(e){const{view:i}=this;switch(e){case"attribution":return new RNe({view:i});case"compass":return new DNe({view:i});case"navigation-toggle":return new NNe({view:i});case"zoom":return new jNe({view:i})}}};d([p()],lA.prototype,"components",void 0),lA=d([A("esri.views.ui.DefaultUI")],lA);const Fde=lA;let cA=class extends Fde{constructor(e){super(e),this.components=["attribution","zoom"]}};d([p()],cA.prototype,"components",void 0),cA=d([A("esri.views.ui.2d.DefaultUI2D")],cA);const Dde=cA;var rV;let uA=rV=class extends te{constructor(t){super(t),this.color=new ce([0,0,0,1])}clone(){return new rV(U({color:this.color}))}};d([p({type:ce,json:{write:!0}})],uA.prototype,"color",void 0),uA=rV=d([A("esri.webmap.background.ColorBackground")],uA);const UNe=uA;let Nde,Vde,zde,jde,Bde,Ude;async function GNe(){const[,{GraphicsView2D:t,GraphicContainer:e,LabelManager:i,MapViewNavigation:r,MagnifierView2D:n,Stage:s}]=await Promise.all([W(()=>import("./webglDeps-b65b97bf.js"),["./webglDeps-b65b97bf.js","./VertexArrayObject-08f516fe.js","./Texture-eb8cd14a.js","./enums-b14466b3.js","./ProgramTemplate-292cf23e.js","./programUtils-ed4b136e.js","./NestedMap-1b5db22e.js"],import.meta.url),W(()=>import("./mapViewDeps-af9d80a9.js"),["./mapViewDeps-af9d80a9.js","./CIMResourceManager-b8fa14d9.js","./fontUtils-d28127a5.js","./Rasterizer-453ee95d.js","./cimAnalyzer-97b03e25.js","./BidiEngine-9a40f2f4.js","./OptimizedGeometry-196224d4.js","./GeometryUtils-984e8446.js","./enums-f1a6a48a.js","./alignmentUtils-ae955d28.js","./definitions-8f6c0024.js","./number-e491b09e.js","./Rect-ea14f53a.js","./callExpressionWithFeature-06ba3d44.js","./quantizationUtils-533107d2.js","./floatRGBA-de0614b2.js","./rasterizingUtils-8fc9ca0c.js","./imageutils-260173a2.js","./Container-de185a32.js","./enums-b14466b3.js","./Texture-eb8cd14a.js","./BufferPool-85f6109f.js","./AttributeStoreView-a3f655f7.js","./TiledDisplayObject-d497910d.js","./color-e244539a.js","./VertexElementDescriptor-2925c6af.js","./WGLContainer-037578f3.js","./VertexArrayObject-08f516fe.js","./vec4f32-0d1b2306.js","./ProgramTemplate-292cf23e.js","./GeometryUtils-f86d11a2.js","./StyleDefinition-29c49b98.js","./config-1337d16e.js","./earcut-6b48af20.js","./featureConversionUtils-bafaa402.js","./OptimizedFeature-4701473b.js","./OptimizedFeatureSet-1d1ac4b9.js","./visualVariablesUtils-d4aac532.js","./ExpandedCIM-2df9bc7d.js","./util-ac05cbea.js","./enums-fb086c25.js","./programUtils-ed4b136e.js","./NestedMap-1b5db22e.js","./MagnifierPrograms-ce3afbc8.js","./pbf-beba61b9.js","./Matcher-dfb79dbc.js","./tileUtils-c2f19f52.js","./TurboLine-2e088fec.js","./CircularArray-ef508845.js","./testSVGPremultipliedAlpha-8b254d7f.js","./ComputedAttributeStorage-d8e6e2e6.js","./arcadeTimeUtils-3a12e3ee.js","./centroid-8e8cfa47.js","./RenderingContext-15eee32d.js","./OrderIndependentTransparency-b8ef1857.js","./basicInterfaces-bb952591.js","./doublePrecisionUtils-e3c3d0d8.js","./imageUtils-c2d0d1ae.js","./GraphicsView2D-4e889ec5.js","./normalizeUtilsSync-fc897fcb.js","./projectionSupport-66f9e6bd.js","./json-48e3ea08.js","./GraphicContainer-47ea8398.js","./BaseGraphicContainer-34505465.js","./FeatureContainer-afbe339d.js","./TileContainer-0946d38f.js","./requestImageUtils-89ae2d39.js"],import.meta.url)]);Vde=t,zde=e,jde=i,Bde=r,Ude=n,Nde=s}const GJ=160,HJ={flipY:!0,premultipliedAlpha:!0};let Ze=class extends eOe(OLe(_Le(bRe))){constructor(e){super(e),this._magnifierView=null,this._stage=null,this._resolveWhenReady=[],this.rootLayerViews=new ZI({getCollections:()=>{var i,r;return[(i=this.basemapView)==null?void 0:i.baseLayerViews,this.layerViews,(r=this.basemapView)==null?void 0:r.referenceLayerViews]},getChildrenFunction:()=>null}),this.featuresTilingScheme=null,this.fullOpacity=1,this.graphicsView=null,this.stateManager=new So({constraints:new Tue({view:this})}),this.labelManager=null,this.mapViewNavigation=null,this.renderingOptions={samplingMode:"dynamic",edgeLabelsVisible:!0,labelsAnimationTime:125,labelCollisionsEnabled:!0},this.rendering=!1,this.supersampleScreenshotsEnabled=!0,this.supportsGround=!1,this._stationaryTimer=null,this._gotoTask=null,this.frameTask=new O3e(this),this._pePromise=null,this.floors=new ye,this.highlightOptions=new Gue,this.inputManager=new hFe({view:this}),this.map=null,this.spatialReferenceLocked=!1,this.timeline=new Hue,this.type="2d",this.ui=new Dde,this.padding={top:0,right:0,bottom:0,left:0},this.addHandles([J(()=>this.viewpoint,()=>{this._lastStationaryEventTimestamp=performance.now(),this._flipStationary(GJ)},Ca),this.on("resize",i=>this.stateManager.resize(i.width,i.height)),J(()=>{var i;return(i=this.animationManager)==null?void 0:i.animation},i=>{this.animation=i})]),Eke()}destroy(){this._set("preconditionsReady",!1),this.frameTask=je(this.frameTask),this._gotoTask=null,this.rootLayerViews.destroy(),this.inputManager.destroy(),this._set("inputManager",null)}get graphicsTileStore(){return new vFe(this.featuresTilingScheme)}get constraintsInfo(){var r,n;const e=(r=this.defaultsFromMap)==null?void 0:r.tileInfo,i=this.spatialReference;return{lods:(n=e==null?void 0:e.spatialReference)!=null&&n.equals(i)?e.lods:null,spatialReference:i}}get state(){return this.stateManager.state}get initialExtentRequired(){var a;if(!this.stateManager)return!1;const{scale:e,constraints:i,center:r,viewpoint:n,extent:s}=this;let o=this.zoom;return!(this.map&&"initialViewProperties"in this.map&&((a=this.map.initialViewProperties)!=null&&a.viewpoint))&&!s&&(i!=null&&i.effectiveLODs||(o=-1),(!r||e===0&&o===-1)&&(!n||n.targetGeometry==null||n.targetGeometry.type!=="extent"&&!n.scale))}get resourceManager(){return this._stage.resourceManager}get textureManager(){return this._stage.painter.textureManager}get _defaultsFromMapSettings(){return{required:{tileInfo:!0,heightModelInfo:!1,extent:!1},requiresExtentInSpatialReference:this.spatialReferenceLocked}}get _projectionEngineLoaded(){return!!pc()||(this._pePromise||(this._pePromise=Eu().finally(()=>{this._pePromise=null})),!1)}get typeSpecificPreconditionsReady(){const e=this._getDefaultViewpoint();if(!e)return!1;const i=this.spatialReference,r=e.targetGeometry;return!!lc(r.spatialReference,i)||this._projectionEngineLoaded}set animation(e){const i=this._get("animation");if(e===i)return;if(i&&i.stop(),!e||e.isFulfilled())return void this._set("animation",null);this._set("animation",e),this.frameTask.animationInProgress=!0;const r=()=>{var n;e===this._get("animation")&&(this._set("animation",null),(n=this.frameTask)==null||n.requestFrame()),this.frameTask.animationInProgress=!1};e.when(r,r)}get background(){return qNe(this.map)?this.map.initialViewProperties.background:null}set background(e){this._override("background",e)}get center(){var e;return((e=this.stateManager)==null?void 0:e.center)??null}set center(e){this.stateManager.center=e}get constraints(){var e;return(e=this.stateManager)==null?void 0:e.constraints}set constraints(e){e.view=this;const i=this.stateManager.constraints;this.stateManager.constraints=e,i==null||i.destroy()}get extent(){var e;return((e=this.stateManager)==null?void 0:e.extent)??null}set extent(e){this.stateManager.extent=e}get padding(){var e;return(e=this.stateManager)==null?void 0:e.padding}set padding(e){this.stateManager&&(this.stateManager.padding=e)}get resizeAlign(){return this.stateManager.resizeAlign}set resizeAlign(e){this.stateManager.resizeAlign=e}get resolution(){return this.stateManager.resolution??0}get rotation(){return this.stateManager.rotation??0}set rotation(e){this.stateManager.rotation=e}get scale(){var e;return((e=this.stateManager)==null?void 0:e.scale)??0}set scale(e){this.stateManager&&(this.stateManager.scale=e)}get stationary(){return!(this.animation||this.navigating||this.resizing||this._stationaryTimer)}get updating(){var i,r,n;const e=!this.destroyed&&(!this.layerViewManager||!this.labelManager||!this.graphicsView||this.layerViewManager.updating===!0||this.labelManager.updating===!0||this.graphicsView.updating===!0||this.allLayerViews.some(s=>!s.destroyed&&!("layerViews"in s)&&s.updating===!0));if(ee("esri-2d-log-updating")){const s=this.allLayerViews.reduce((o,a)=>({...o,[a.layer.id]:!a.destroyed&&!("layerViews"in a)&&a.updating}),{});console.log(`Updating MapView: ${e}
-> Null LayerViewManager: ${!this.layerViewManager}
-> Null LabelManager: ${!this.labelManager}
-> Null GraphicsView: ${!this.graphicsView}
-> layerViewManager.updating: ${(i=this.layerViewManager)==null?void 0:i.updating}
-> labelManager.updating: ${(r=this.labelManager)==null?void 0:r.updating}
-> graphicsView.updating: ${(n=this.graphicsView)==null?void 0:n.updating}
-> allLayerViews: ${JSON.stringify(s)}
`)}return e}get viewpoint(){return this.stateManager.viewpoint??null}set viewpoint(e){this.stateManager.viewpoint=e,this.frameTask.requestFrame()}get zoom(){return this.stateManager.zoom??-1}set zoom(e){this.stateManager.zoom=e}get navigating(){return!(!this.mapViewNavigation||!this.mapViewNavigation.interacting)}goTo(e,i){if(e)return this.animation&&(this.animation=null),this._createAnimation(),_r(()=>this.ready,i).then(()=>{var s;const r={animate:!0,...i},n=f3e(e,this);return(s=this.animation)==null||s.update(n),this._gotoTask={},r.animate?this._gotoAnimated(n,r):this._gotoImmediate(n,r)});ie.getLogger(this).error("#goTo()","target cannot be null or undefined")}async hitTest(e,i){const r=KW(e)?YW(this,e):e;if(!this.ready||isNaN(r.x)||isNaN(r.y))return{screenPoint:r,results:[]};let n=new Set,s=!1,o=null,a=null;i!=null&&i.include?WJ(i.include,qJ(this,h=>n.add(h),h=>{o||(o=new Set),o.add(h)},h=>n.add(h),()=>s=!0)):(s=!0,n=new Set(this.allLayerViews)),i!=null&&i.exclude&&WJ(i.exclude,qJ(this,h=>n.delete(h),h=>{a||(a=new Set),a.add(h)}));const l=this.allLayerViews.filter(h=>!h.suspended&&n.has(h)).reverse(),c=this.toMap(r);let u=[...s?this.graphicsView.hitTest(c).map(h=>({type:"graphic",graphic:h,layer:null,mapPoint:c})):[],...await Promise.all(l.map(h=>h.hitTest(c,r)).toArray())].filter(Dt).flat().filter(Dt);return o&&(u=u.filter(h=>!("graphic"in h)||!h.graphic||(o==null?void 0:o.has(nV(h.graphic))))),a&&(u=u.filter(h=>!("graphic"in h)||!h.graphic||!(a!=null&&a.has(nV(h.graphic))))),{screenPoint:r,results:u}}async takeScreenshot(e){const i=this._createScreenshotPlan(e),r=await this._stage.takeScreenshot(i);return wFe(r,{format:i.format,quality:i.quality,rotation:0,disableDecorations:!1},HJ)}async _takeScreenshot(e){const i=this._createScreenshotPlan(e),r=await this._stage.takeScreenshot(i);return xFe(r,HJ)}_createScreenshotPlan(e){e=e??{};const i=this.supersampleScreenshotsEnabled?Math.min(4,CFe(this.size,Math.min(4096,this._stage.context.parameters.maxTextureSize))):1;let r;e.layers?(r=[],e.layers.forEach(o=>{const a=this.allLayerViews.find(l=>l.layer.id===o.id);a&&"container"in a&&a.container&&r.push(a.container)})):r=this._stage.children;const{format:n,quality:s}=TFe(e.format,e.quality);return bFe(e,i,this.size,this.padding,n,s,r,e.rotation)}get test(){return{takeScreenshot:e=>this._takeScreenshot(e)}}toMap(e){if(!this.ready)return null;const i=KW(e)?YW(this,e):e;return this.stateManager.toMap(i)}toScreen(e){return this.stateManager.toScreen(e)}on(e,i,r,n){return this.inputManager&&this.viewEvents.on(e,i,r,n)||super.on(e,i)}hasEventListener(e){return super.hasEventListener(e)||this.viewEvents.hasHandler(e)}whenLayerView(e){return super.whenLayerView(e)}graphicChanged(e){this.graphicsView&&this.graphicsView.graphicUpdateHandler(e)}whenReady(){return new Promise(e=>{this.ready?e(this):this._resolveWhenReady.push(e)})}forceDOMReadyCycle(){this.forceReadyCycle()}getDefaultSpatialReference(){var e,i,r;return this.map&&"initialViewProperties"in this.map&&((i=(e=this.map)==null?void 0:e.initialViewProperties)==null?void 0:i.spatialReference)||((r=this.defaultsFromMap)==null?void 0:r.spatialReference)||null}hasLayerViewModule(e){return nJ.hasLayerViewModule(e)}importLayerView(e){return nJ.importLayerView(e)}pixelSizeAt(){return this.ready?this.resolution:(ie.getLogger(this).error("#pixelSizeAt()","Map view cannot be used before it is ready"),null)}popupHitTest(e){return this.hitTest(e).then(i=>({...i,mapPoint:this.toMap(e)}))}requestUpdate(){this.ready&&this.frameTask.requestUpdate()}validate(){let e=zFe(this.type);return ee("safari")&&ee("safari")<9&&(e=new N("mapview:browser-not-supported","This browser is not supported by MapView (Safari < 9)",{type:"safari",requiredVersion:9,detectedVersion:ee("safari")})),e!=null?(ie.getLogger(this).warn("#validate()",e.message),Promise.reject(e)):GNe()}_createAnimation(){return this.animation&&!this.animation.done||(this.animation=new j4),this.animation}_cancellableGoTo(e,i,r){const n=()=>e===this._gotoTask,s=r.then(()=>{n()&&(this.animation=null)}).catch(a=>{throw n()&&(i&&!i.done&&(i.stop(),this.frameTask.animationInProgress=!1),this.animation=null),a}),o=new Promise(a=>a(s));return i.when().catch(()=>{n()&&o.cancel&&o.cancel()}),o}_gotoImmediate(e,i){const r=this._gotoTask,n=this.animation,s=e.then(o=>{if(_t(i),r!==this._gotoTask)throw new N("view:goto-interrupted","Goto was interrupted");this.viewpoint=n.target=o,n.finish()});return this._cancellableGoTo(r,n,s)}_flipStationary(e){return this._stationaryTimer!==null||(this._stationaryTimer=setTimeout(()=>{this._stationaryTimer=null;const i=performance.now()-this._lastStationaryEventTimestamp;i<GJ&&(this._stationaryTimer=this._flipStationary(i))},e)),this._stationaryTimer}_getDefaultViewpoint(){var v;const{constraints:e,initialExtent:i,map:r,padding:n,size:s}=this;if(!e)return null;const o=r&&"initialViewProperties"in r?r.initialViewProperties:void 0,a=this.stateManager.getUserStartupOptions(this.size),l=o==null?void 0:o.viewpoint,c=((v=l==null?void 0:l.targetGeometry)==null?void 0:v.extent)??i,u=c==null?void 0:c.center,h=(l==null?void 0:l.rotation)??0,f=(l==null?void 0:l.scale)||c&&$w(c,[s[0]-n.left-n.right,s[1]-n.top-n.bottom]),m=a.center??u,g=a.rotation??h,y=a.scale??f;return m&&y?new Pd({targetGeometry:m,scale:y,rotation:g}):null}_gotoAnimated(e,i){const r=this._gotoTask,n=this.animation;if(!n)return Promise.resolve();const s=e.then(o=>{if(_t(i),r!==this._gotoTask)throw new N("view:goto-interrupted","Goto was interrupted");return n.update(o),this.animationManager.animate(n,this.viewpoint,i),n.when().then(()=>{},()=>{})});return this._cancellableGoTo(r,n,s)}_startup(){var a;this.timeline.begin("MapView Startup");const e=this._getDefaultViewpoint();this.stateManager.startup(e,this.size,this.spatialReference,(a=this.defaultsFromMap.extent)==null?void 0:a.center),this.graphics.owner=this;const i=new Nde(this.surface,{canvas:this.renderCanvas,supersampleScreenshots:this.supersampleScreenshotsEnabled,contextOptions:{disabledExtensions:this.deactivatedWebGLExtensions,debugWebGLExtensions:this.debugWebGLExtensions},renderingOptions:this.renderingOptions,timeline:this.timeline});this._stage=i,this._magnifierView=new Ude,this._magnifierView.magnifier=this.magnifier;const r=new jde({view:this});this._set("labelManager",r);const n=new P3e({view:this});this._set("animationManager",n);const s=new Bde({view:this,animationManager:n});this._set("mapViewNavigation",s),this._setupSpatialReferenceDependentProperties(),this.handles.add([this.rootLayerViews.on("change",()=>this._updateStageChildren()),i.on("post-render",()=>this._set("rendering",i.renderRequested)),i.on("will-render",()=>this._set("rendering",i.renderRequested)),i.on("webgl-error",l=>this.fatalError=l.error),J(()=>this.stationary,l=>i.stationary=l,ji),J(()=>this.background,l=>{i.backgroundColor=l==null?void 0:l.color,this._magnifierView.backgroundColor=l==null?void 0:l.color},ji),J(()=>this.magnifier,l=>this._magnifierView.magnifier=l,ji),J(()=>this.renderingOptions,l=>i.renderingOptions=l,ji),J(()=>this.highlightOptions,l=>i.highlightOptions=l,ji),J(()=>this.state.id,()=>i.state=this.state,ji)],"map-view"),this._updateStageChildren();const o=this._resolveWhenReady;this._resolveWhenReady=[],o.forEach(l=>l(this)),this.timeline.end("MapView Startup"),this.frameTask.start(),this._set("ready",!0)}_teardown(){this._destroySpatialReferenceDependentProperties(),this.handles.remove("map-view"),this.mapViewNavigation.destroy(),this._set("mapViewNavigation",null),this.animationManager.destroy(),this._set("animationManager",null),this.layerViewManager.clear(),this.labelManager.destroy(),this._magnifierView.destroy(),this._stage.destroy(),this._stage=null,this._set("graphicsView",null),this._magnifierView=null,this._set("labelManager",null),this._set("mapViewNavigation",null),this.graphics.owner=null,this.frameTask.stop(),this._stationaryTimer&&(clearTimeout(this._stationaryTimer),this._stationaryTimer=null),this._set("ready",!1),this.stateManager.teardown(),this.animation=null}_updateStageChildren(){this._stage.removeAllChildren(),this.rootLayerViews.forEach(i=>{this._stage.addChild(i.container)});const e=this.graphicsView;this._stage.addChild(e.container),this._stage.addChild(this._magnifierView)}_setupSpatialReferenceDependentProperties(){const e=new U3e(Od.create({spatialReference:this.spatialReference,size:512,numLODs:36}));this._set("featuresTilingScheme",e);const i=new Vde({view:this,graphics:this.graphics,requestUpdateCallback:()=>this.requestUpdate(),container:new zde(e)});this._set("graphicsView",i)}_destroySpatialReferenceDependentProperties(){const e=this.graphicsView;this._set("graphicsView",null),e.destroy(),this._set("featuresTilingScheme",null)}_spatialReferenceChanged(e){if(this.ready){this.frameTask.stop();for(const i of this.allLayerViews)i.processDetach();this._destroySpatialReferenceDependentProperties(),this.stateManager.changeSpatialReference(e),this._stage.state=this.state,this._setupSpatialReferenceDependentProperties();for(const i of this.allLayerViews)i.processAttach();this.frameTask.requestFrame(),this.frameTask.start(),this._updateStageChildren()}}};Ze.type="2d",d([p({readOnly:!0})],Ze.prototype,"animationManager",void 0),d([p({constructOnly:!0})],Ze.prototype,"deactivatedWebGLExtensions",void 0),d([p({constructOnly:!0})],Ze.prototype,"debugWebGLExtensions",void 0),d([p({readOnly:!0})],Ze.prototype,"featuresTilingScheme",void 0),d([p({readOnly:!0})],Ze.prototype,"fullOpacity",void 0),d([p({readOnly:!0})],Ze.prototype,"graphicsTileStore",null),d([p()],Ze.prototype,"graphicsView",void 0),d([p()],Ze.prototype,"stateManager",void 0),d([p()],Ze.prototype,"constraintsInfo",null),d([p({readOnly:!0})],Ze.prototype,"state",null),d([p()],Ze.prototype,"initialExtentRequired",null),d([p()],Ze.prototype,"labelManager",void 0),d([p({readOnly:!0})],Ze.prototype,"resourceManager",null),d([p({readOnly:!0})],Ze.prototype,"textureManager",null),d([p({readOnly:!0})],Ze.prototype,"mapViewNavigation",void 0),d([p({constructOnly:!0})],Ze.prototype,"renderCanvas",void 0),d([p()],Ze.prototype,"renderingOptions",void 0),d([p({readOnly:!0})],Ze.prototype,"rendering",void 0),d([p({constructOnly:!0})],Ze.prototype,"supersampleScreenshotsEnabled",void 0),d([p({readOnly:!0})],Ze.prototype,"supportsGround",void 0),d([p()],Ze.prototype,"_stationaryTimer",void 0),d([p()],Ze.prototype,"_defaultsFromMapSettings",null),d([p()],Ze.prototype,"_pePromise",void 0),d([p({readOnly:!0})],Ze.prototype,"typeSpecificPreconditionsReady",null),d([p()],Ze.prototype,"animation",null),d([p({type:UNe})],Ze.prototype,"background",null),d([p()],Ze.prototype,"center",null),d([p({type:Tue})],Ze.prototype,"constraints",null),d([p()],Ze.prototype,"extent",null),d([p()],Ze.prototype,"floors",void 0),d([p({type:Gue})],Ze.prototype,"highlightOptions",void 0),d([p({readOnly:!0})],Ze.prototype,"inputManager",void 0),d([p()],Ze.prototype,"map",void 0),d([p()],Ze.prototype,"padding",null),d([p()],Ze.prototype,"resizeAlign",null),d([p({readOnly:!0})],Ze.prototype,"resolution",null),d([p()],Ze.prototype,"rotation",null),d([p()],Ze.prototype,"scale",null),d([p({constructOnly:!0})],Ze.prototype,"spatialReferenceLocked",void 0),d([p()],Ze.prototype,"stationary",null),d([p({type:Hue,readOnly:!0})],Ze.prototype,"timeline",void 0),d([p({readOnly:!0})],Ze.prototype,"type",void 0),d([p({readOnly:!0})],Ze.prototype,"updating",null),d([p()],Ze.prototype,"viewpoint",null),d([p()],Ze.prototype,"zoom",null),d([p({readOnly:!0})],Ze.prototype,"navigating",null),d([p(),tt(t=>t instanceof Fde?t:jv(Dde,t))],Ze.prototype,"ui",void 0),Ze=d([A("esri.views.MapView")],Ze);const HNe=Ze;function nV(t){var i,r;const e=t.getObjectId();return e?`${((i=t.layer)==null?void 0:i.uid)??((r=t.sourceLayer)==null?void 0:r.uid)??"MapView"}/${e}`:`"MapView/${t.uid}`}function qJ(t,e,i,r,n){return s=>{if(s instanceof Or){if(s.layer===t)n==null||n();else{const o=t.allLayerViews.find(a=>a.layer===s.layer);o&&(r==null||r(o))}i(nV(s))}else{const o=t.allLayerViews.find(a=>a.layer===s);o&&e(o)}}}function WJ(t,e){if(t)if(wk(t))for(const i of t)if(wk(i))for(const r of i)e(r);else e(i);else e(t)}function qNe(t){return(t==null?void 0:t.declaredClass)==="esri.WebMap"}var sV;let YS=sV=class extends te{constructor(t){super(t),this.minValue=0,this.maxValue=0}clone(){return new sV({minValue:this.minValue,maxValue:this.maxValue})}};d([p({type:Number,json:{write:!0}})],YS.prototype,"minValue",void 0),d([p({type:Number,json:{write:!0}})],YS.prototype,"maxValue",void 0),YS=sV=d([A("esri.renderer.support.AuthoringInfoClassBreakInfo")],YS);var oV;let hm=oV=class extends te{constructor(t){super(t),this.field="",this.normalizationField="",this.label="",this.classBreakInfos=[]}clone(){return new oV({field:this.field,normalizationField:this.normalizationField,label:this.label,classBreakInfos:U(this.classBreakInfos)})}};d([p({type:String,json:{write:!0}})],hm.prototype,"field",void 0),d([p({type:String,json:{write:!0}})],hm.prototype,"normalizationField",void 0),d([p({type:String,json:{write:!0}})],hm.prototype,"label",void 0),d([p({type:[YS],json:{write:!0}})],hm.prototype,"classBreakInfos",void 0),hm=oV=d([A("esri.renderers.support.AuthoringInfoFieldInfo")],hm);var aV;const WE=new He({percentTotal:"percent-of-total",ratio:"ratio",percent:"percent"}),JE=new He({sizeInfo:"size",colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation"}),JJ={key:t=>typeof t=="number"?"number":"string",typeMap:{number:Number,string:String},base:null},ZJ=["high-to-low","above-and-below","centered-on","extremes"],YJ=[...new Set(["high-to-low","above-and-below","centered-on","extremes","90-10","above","below","high-to-low","above-and-below","90-10","above","below"])],KJ=["seconds","minutes","hours","days","months","years"];let ia=aV=class extends te{constructor(t){super(t),this.endTime=null,this.field=null,this.maxSliderValue=null,this.minSliderValue=null,this.startTime=null,this.type=null,this.units=null}castEndTime(t){return typeof t=="string"||typeof t=="number"?t:null}castStartTime(t){return typeof t=="string"||typeof t=="number"?t:null}get style(){return this.type==="color"?this._get("style"):null}set style(t){this._set("style",t)}get theme(){return this.type==="color"||this.type==="size"?this._get("theme")||"high-to-low":null}set theme(t){this._set("theme",t)}clone(){return new aV({endTime:this.endTime,field:this.field,maxSliderValue:this.maxSliderValue,minSliderValue:this.minSliderValue,startTime:this.startTime,style:this.style,theme:this.theme,type:this.type,units:this.units})}};d([p({types:JJ,json:{write:!0}})],ia.prototype,"endTime",void 0),d([tt("endTime")],ia.prototype,"castEndTime",null),d([p({type:String,json:{write:!0}})],ia.prototype,"field",void 0),d([p({type:Number,json:{write:!0}})],ia.prototype,"maxSliderValue",void 0),d([p({type:Number,json:{write:!0}})],ia.prototype,"minSliderValue",void 0),d([p({types:JJ,json:{write:!0}})],ia.prototype,"startTime",void 0),d([tt("startTime")],ia.prototype,"castStartTime",null),d([p({type:WE.apiValues,value:null,json:{type:WE.jsonValues,read:WE.read,write:WE.write}})],ia.prototype,"style",null),d([p({type:YJ,value:null,json:{type:YJ,origins:{"web-scene":{type:ZJ,write:{writer:(t,e)=>{ZJ.includes(t)&&(e.theme=t)}}}},write:!0}})],ia.prototype,"theme",null),d([p({type:JE.apiValues,json:{type:JE.jsonValues,read:JE.read,write:JE.write}})],ia.prototype,"type",void 0),d([p({type:KJ,json:{type:KJ,write:!0}})],ia.prototype,"units",void 0),ia=aV=d([A("esri.renderers.support.AuthoringInfoVisualVariable")],ia);const WNe=ia;let dA=class extends te{constructor(e){super(e),this.type=null}};d([p({readOnly:!0,json:{read:!1,write:!0}})],dA.prototype,"type",void 0),dA=d([A("esri.rest.support.ColorRamp")],dA);const o9=dA;var lV;let Ay=lV=class extends o9{constructor(t){super(t),this.algorithm=null,this.fromColor=null,this.toColor=null,this.type="algorithmic"}clone(){return new lV({fromColor:U(this.fromColor),toColor:U(this.toColor),algorithm:this.algorithm})}};d([xe({esriCIELabAlgorithm:"cie-lab",esriHSVAlgorithm:"hsv",esriLabLChAlgorithm:"lab-lch"})],Ay.prototype,"algorithm",void 0),d([p({type:ce,json:{type:[wt],write:!0}})],Ay.prototype,"fromColor",void 0),d([p({type:ce,json:{type:[wt],write:!0}})],Ay.prototype,"toColor",void 0),d([p({type:["algorithmic"]})],Ay.prototype,"type",void 0),Ay=lV=d([A("esri.rest.support.AlgorithmicColorRamp")],Ay);const a9=Ay;var cV;let KS=cV=class extends o9{constructor(t){super(t),this.colorRamps=null,this.type="multipart"}clone(){return new cV({colorRamps:U(this.colorRamps)})}};d([p({type:[a9],json:{write:!0}})],KS.prototype,"colorRamps",void 0),d([p({type:["multipart"]})],KS.prototype,"type",void 0),KS=cV=d([A("esri.rest.support.MultipartColorRamp")],KS);const $L=KS,AL={key:"type",base:o9,typeMap:{algorithmic:a9,multipart:$L}};function kL(t){return t&&t.type?t.type==="algorithmic"?a9.fromJSON(t):t.type==="multipart"?$L.fromJSON(t):null:null}var uV;const zg=new He({esriClassifyDefinedInterval:"defined-interval",esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation"}),ZE=new He({pieChart:"pie-chart",classedSize:"class-breaks-size",classedColor:"class-breaks-color",univariateColorSize:"univariate-color-size",relationship:"relationship",predominance:"predominance",dotDensity:"dot-density",flow:"flow"}),XJ=new He({classedSize:"class-breaks-size",classedColor:"class-breaks-color",univariateColorSize:"univariate-color-size",relationship:"relationship",predominance:"predominance",dotDensity:"dot-density"}),QJ=["inches","feet","yards","miles","nautical-miles","millimeters","centimeters","decimeters","meters","kilometers","decimal-degrees"],JNe=["high-to-low","above-and-below","above","below","90-10"],ZNe=["flow-line","wave-front"],YNe=["caret","circle-caret","arrow","circle-arrow","plus-minus","circle-plus-minus","square","circle","triangle","happy-sad","thumb","custom"];let Cr=uV=class extends te{constructor(t){super(t),this.colorRamp=null,this.fadeRatio=null,this.isAutoGenerated=!1,this.lengthUnit=null,this.maxSliderValue=null,this.minSliderValue=null,this.visualVariables=null}get classificationMethod(){const t=this._get("classificationMethod"),e=this.type;return e&&e!=="relationship"?e==="class-breaks-size"||e==="class-breaks-color"?t||"manual":null:t}set classificationMethod(t){this._set("classificationMethod",t)}readColorRamp(t){return t?kL(t):void 0}get fields(){return this.type&&this.type!=="predominance"?null:this._get("fields")}set fields(t){this._set("fields",t)}get field1(){return this.type&&this.type!=="relationship"?null:this._get("field1")}set field1(t){this._set("field1",t)}get field2(){return this.type&&this.type!=="relationship"?null:this._get("field2")}set field2(t){this._set("field2",t)}get flowTheme(){return this.type==="flow"?this._get("flowTheme"):null}set flowTheme(t){this._set("flowTheme",t)}get focus(){return this.type&&this.type!=="relationship"?null:this._get("focus")}set focus(t){this._set("focus",t)}get numClasses(){return this.type&&this.type!=="relationship"?null:this._get("numClasses")}set numClasses(t){this._set("numClasses",t)}get statistics(){return this.type==="univariate-color-size"&&this.univariateTheme==="above-and-below"?this._get("statistics"):null}set statistics(t){this._set("statistics",t)}get standardDeviationInterval(){const t=this.type;return t&&t!=="relationship"&&t!=="class-breaks-size"&&t!=="class-breaks-color"||this.classificationMethod&&this.classificationMethod!=="standard-deviation"?null:this._get("standardDeviationInterval")}set standardDeviationInterval(t){this._set("standardDeviationInterval",t)}get type(){return this._get("type")}set type(t){let e=t;t==="classed-size"?e="class-breaks-size":t==="classed-color"&&(e="class-breaks-color"),this._set("type",e)}get univariateSymbolStyle(){return this.type==="univariate-color-size"&&this.univariateTheme==="above-and-below"?this._get("univariateSymbolStyle"):null}set univariateSymbolStyle(t){this._set("univariateSymbolStyle",t)}get univariateTheme(){return this.type==="univariate-color-size"?this._get("univariateTheme"):null}set univariateTheme(t){this._set("univariateTheme",t)}clone(){return new uV({classificationMethod:this.classificationMethod,colorRamp:U(this.colorRamp),fadeRatio:U(this.fadeRatio),fields:this.fields&&this.fields.slice(0),field1:U(this.field1),field2:U(this.field2),isAutoGenerated:this.isAutoGenerated,focus:this.focus,numClasses:this.numClasses,maxSliderValue:this.maxSliderValue,minSliderValue:this.minSliderValue,lengthUnit:this.lengthUnit,statistics:this.statistics,standardDeviationInterval:this.standardDeviationInterval,type:this.type,visualVariables:this.visualVariables&&this.visualVariables.map(t=>t.clone()),univariateSymbolStyle:this.univariateSymbolStyle,univariateTheme:this.univariateTheme,flowTheme:this.flowTheme})}};d([p({type:zg.apiValues,value:null,json:{type:zg.jsonValues,read:zg.read,write:zg.write,origins:{"web-document":{default:"manual",type:zg.jsonValues,read:zg.read,write:zg.write}}}})],Cr.prototype,"classificationMethod",null),d([p({types:AL,json:{write:!0}})],Cr.prototype,"colorRamp",void 0),d([ae("colorRamp")],Cr.prototype,"readColorRamp",null),d([p({json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],Cr.prototype,"fadeRatio",void 0),d([p({type:[String],value:null,json:{write:!0}})],Cr.prototype,"fields",null),d([p({type:hm,value:null,json:{write:!0}})],Cr.prototype,"field1",null),d([p({type:hm,value:null,json:{write:!0}})],Cr.prototype,"field2",null),d([p({type:ZNe,value:null,json:{write:!0,origins:{"web-scene":{write:!1}}}})],Cr.prototype,"flowTheme",null),d([p({type:["HH","HL","LH","LL"],value:null,json:{write:!0}})],Cr.prototype,"focus",null),d([p({type:Boolean,json:{write:!0,default:!1,origins:{"web-scene":{write:!1}}}})],Cr.prototype,"isAutoGenerated",void 0),d([p({type:Number,value:null,json:{type:wt,write:!0}})],Cr.prototype,"numClasses",null),d([p({type:QJ,json:{type:QJ,read:!1,write:!1,origins:{"web-scene":{read:!0,write:!0}}}})],Cr.prototype,"lengthUnit",void 0),d([p({type:Number,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],Cr.prototype,"maxSliderValue",void 0),d([p({type:Number,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],Cr.prototype,"minSliderValue",void 0),d([p({type:Object,value:null,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],Cr.prototype,"statistics",null),d([p({type:[.25,.33,.5,1],value:null,json:{type:[.25,.33,.5,1],write:!0}})],Cr.prototype,"standardDeviationInterval",null),d([p({type:ZE.apiValues,value:null,json:{type:ZE.jsonValues,read:ZE.read,write:ZE.write,origins:{"web-scene":{type:XJ.jsonValues,write:{writer:XJ.write,overridePolicy:t=>({enabled:t!=="flow"})}}}}})],Cr.prototype,"type",null),d([p({type:[WNe],json:{write:!0}})],Cr.prototype,"visualVariables",void 0),d([p({type:YNe,value:null,json:{write:!0,origins:{"web-scene":{write:!1}}}})],Cr.prototype,"univariateSymbolStyle",null),d([p({type:JNe,value:null,json:{write:!0,origins:{"web-scene":{write:!1}}}})],Cr.prototype,"univariateTheme",null),Cr=uV=d([A("esri.renderers.support.AuthoringInfo")],Cr);const EC=Cr,s5=new He({simple:"simple",uniqueValue:"unique-value",classBreaks:"class-breaks",heatmap:"heatmap",dotDensity:"dot-density",dictionary:"dictionary",pieChart:"pie-chart"},{ignoreUnknown:!0});let XS=class extends te{constructor(e){super(e),this.authoringInfo=null,this.type=null}async getRequiredFields(e){if(!this.collectRequiredFields)return[];const i=new Set;return await this.collectRequiredFields(i,e),Array.from(i).sort()}getSymbol(e,i){}async getSymbolAsync(e,i){}getSymbols(){return[]}getAttributeHash(){return JSON.stringify(this)}getMeshHash(){return JSON.stringify(this)}};d([p({type:EC,json:{write:!0}})],XS.prototype,"authoringInfo",void 0),d([p({type:s5.apiValues,readOnly:!0,json:{type:s5.jsonValues,read:!1,write:{writer:s5.write,ignoreOrigin:!0}}})],XS.prototype,"type",void 0),XS=d([A("esri.renderers.Renderer")],XS);const $p=XS;function KNe(t){var e,i;return((i=(e=t.match(XNe))==null?void 0:e[1])==null?void 0:i.replace(/\\'/g,"'"))??null}const XNe=/^hash\(\$feature\['((\\'|[^'])+)'\]\) \* 8\.381e-8$/;var dV;let lv=dV=class extends te{constructor(){super(...arguments),this.title=null}clone(){return new dV({title:this.title})}};d([p({type:String,json:{write:!0}})],lv.prototype,"title",void 0),lv=dV=d([A("esri.renderers.support.LegendOptions")],lv);var hV;let hA=hV=class extends lv{constructor(){super(...arguments),this.showLegend=null}clone(){return new hV({title:this.title,showLegend:this.showLegend})}};d([p({type:Boolean,json:{write:!0}})],hA.prototype,"showLegend",void 0),hA=hV=d([A("esri.renderers.visualVariables.support.VisualVariableLegendOptions")],hA);const Gde=hA,o5=new He({colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation",sizeInfo:"size"});let Vc=class extends te{constructor(e){super(e),this.index=null,this.type=null,this.field=null,this.valueExpression=null,this.valueExpressionTitle=null,this.legendOptions=null}castField(e){return e==null?e:typeof e=="function"?(ie.getLogger(this).error(".field: field must be a string value"),null):eC(e)}get arcadeRequired(){return!!this.valueExpression}clone(){}getAttributeHash(){return`${this.type}-${this.field}-${this.valueExpression}`}};d([p()],Vc.prototype,"index",void 0),d([p({type:o5.apiValues,readOnly:!0,json:{read:o5.read,write:o5.write}})],Vc.prototype,"type",void 0),d([p({type:String,json:{write:!0}})],Vc.prototype,"field",void 0),d([tt("field")],Vc.prototype,"castField",null),d([p({type:String,json:{write:!0}})],Vc.prototype,"valueExpression",void 0),d([p({type:String,json:{write:!0}})],Vc.prototype,"valueExpressionTitle",void 0),d([p({readOnly:!0})],Vc.prototype,"arcadeRequired",null),d([p({type:Gde,json:{write:!0}})],Vc.prototype,"legendOptions",void 0),Vc=d([A("esri.renderers.visualVariables.VisualVariable")],Vc);const MC=Vc;var pV;let ky=pV=class extends te{constructor(t){super(t),this.color=null,this.label=null,this.value=null}writeValue(t,e,i){e[i]=t??0}clone(){return new pV({color:this.color&&this.color.clone(),label:this.label,value:this.value})}};d([p({type:ce,json:{type:[wt],write:!0}})],ky.prototype,"color",void 0),d([p({type:String,json:{write:!0}})],ky.prototype,"label",void 0),d([p({type:Number,json:{write:{writerEnsuresNonNull:!0}}})],ky.prototype,"value",void 0),d([ge("value")],ky.prototype,"writeValue",null),ky=pV=d([A("esri.renderers.visualVariables.support.ColorStop")],ky);const QNe=ky;var fV;let Py=fV=class extends MC{constructor(t){super(t),this.type="color",this.normalizationField=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null}}set stops(t){t&&Array.isArray(t)&&(t=t.filter(e=>!!e)).sort((e,i)=>e.value-i.value),this._set("stops",t)}clone(){return new fV({field:this.field,normalizationField:this.normalizationField,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,stops:this.stops&&this.stops.map(t=>t.clone()),legendOptions:this.legendOptions&&this.legendOptions.clone()})}getAttributeHash(){return`${super.getAttributeHash()}-${this.normalizationField}`}_interpolateData(){return this.stops&&this.stops.map(t=>t.value||0)}};d([p({readOnly:!0})],Py.prototype,"cache",null),d([p({type:["color"],json:{type:["colorInfo"]}})],Py.prototype,"type",void 0),d([p({type:String,json:{write:!0}})],Py.prototype,"normalizationField",void 0),d([p({type:[QNe],json:{write:!0}})],Py.prototype,"stops",null),Py=fV=d([A("esri.renderers.visualVariables.ColorVariable")],Py);const Hde=Py;var mV;let $f=mV=class extends te{constructor(t){super(t),this.label=null,this.opacity=null,this.value=null}readOpacity(t,e){return WI(e.transparency)}writeOpacity(t,e,i){e[i]=eL(t)}clone(){return new mV({label:this.label,opacity:this.opacity,value:this.value})}};d([p({type:String,json:{write:!0}})],$f.prototype,"label",void 0),d([p({type:Number,json:{type:wt,write:{target:"transparency"}}})],$f.prototype,"opacity",void 0),d([ae("opacity",["transparency"])],$f.prototype,"readOpacity",null),d([ge("opacity")],$f.prototype,"writeOpacity",null),d([p({type:Number,json:{write:!0}})],$f.prototype,"value",void 0),$f=mV=d([A("esri.renderers.visualVariables.support.OpacityStop")],$f);const e4e=$f;var gV;let Oy=gV=class extends MC{constructor(t){super(t),this.type="opacity",this.normalizationField=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null}}set stops(t){t&&Array.isArray(t)&&(t=t.filter(e=>!!e)).sort((e,i)=>e.value-i.value),this._set("stops",t)}clone(){return new gV({field:this.field,normalizationField:this.normalizationField,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,stops:this.stops&&this.stops.map(t=>t.clone()),legendOptions:this.legendOptions&&this.legendOptions.clone()})}getAttributeHash(){return`${super.getAttributeHash()}-${this.normalizationField}`}_interpolateData(){return this.stops&&this.stops.map(t=>t.value||0)}};d([p({readOnly:!0})],Oy.prototype,"cache",null),d([p({type:["opacity"],json:{type:["transparencyInfo"]}})],Oy.prototype,"type",void 0),d([p({type:String,json:{write:!0}})],Oy.prototype,"normalizationField",void 0),d([p({type:[e4e],json:{write:!0}})],Oy.prototype,"stops",null),Oy=gV=d([A("esri.renderers.visualVariables.OpacityVariable")],Oy);const qde=Oy;var yV;let bh=yV=class extends MC{constructor(t){super(t),this.axis=null,this.type="rotation",this.rotationType="geographic",this.valueExpressionTitle=null}get cache(){return{hasExpression:!!this.valueExpression,compiledFunc:null}}writeValueExpressionTitleWebScene(t,e,i,r){if(r&&r.messages){const n=`visualVariables[${this.index}]`;r.messages.push(new N("property:unsupported",this.type+"VisualVariable.valueExpressionTitle is not supported in Web Scene. Please remove this property to save the Web Scene.",{instance:this,propertyName:n+".valueExpressionTitle",context:r}))}}clone(){return new yV({axis:this.axis,rotationType:this.rotationType,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,legendOptions:this.legendOptions&&this.legendOptions.clone()})}};d([p({readOnly:!0})],bh.prototype,"cache",null),d([p({type:["heading","tilt","roll"],json:{origins:{"web-scene":{default:"heading",write:!0}}}})],bh.prototype,"axis",void 0),d([p({type:["rotation"],json:{type:["rotationInfo"]}})],bh.prototype,"type",void 0),d([p({type:["geographic","arithmetic"],json:{write:!0,origins:{"web-document":{write:!0,default:"geographic"}}}})],bh.prototype,"rotationType",void 0),d([p({type:String,json:{write:!0}})],bh.prototype,"valueExpressionTitle",void 0),d([ge("web-scene","valueExpressionTitle")],bh.prototype,"writeValueExpressionTitleWebScene",null),bh=yV=d([A("esri.renderers.visualVariables.RotationVariable")],bh);const PL=bh;var vV;let fb=vV=class extends te{constructor(t){super(t),this.label=null,this.size=null,this.value=null}clone(){return new vV({label:this.label,size:this.size,value:this.value})}};d([p({type:String,json:{write:!0}})],fb.prototype,"label",void 0),d([p({type:Number,cast:$t,json:{write:!0}})],fb.prototype,"size",void 0),d([p({type:Number,json:{write:!0}})],fb.prototype,"value",void 0),fb=vV=d([A("esri.renderers.visualVariables.support.SizeStop")],fb);const mb=fb;var _V;let pA=_V=class extends Gde{constructor(){super(...arguments),this.customValues=null}clone(){return new _V({title:this.title,showLegend:this.showLegend,customValues:this.customValues&&this.customValues.slice(0)})}};d([p({type:[Number],json:{write:!0}})],pA.prototype,"customValues",void 0),pA=_V=d([A("esri.renderers.visualVariables.support.SizeVariableLegendOptions")],pA);const Wde=pA;var lp,Cn;function Rm(t){return t&&t.declaredClass==="esri.renderers.visualVariables.SizeVariable"}function fT(t){return t!=null&&!isNaN(t)&&isFinite(t)}function Jde(t){return t.valueExpression?lp.Expression:t.field&&typeof t.field=="string"?lp.Field:lp.Unknown}function Zde(t,e){const i=e||Jde(t),r=t.valueUnit||"unknown";return i===lp.Unknown?Cn.Constant:t.stops?Cn.Stops:t.minSize!=null&&t.maxSize!=null&&t.minDataValue!=null&&t.maxDataValue!=null?Cn.ClampedLinear:r==="unknown"?t.minSize!=null&&t.minDataValue!=null?t.minSize&&t.minDataValue?Cn.Proportional:Cn.Additive:Cn.Identity:Cn.RealWorldSize}(function(t){t.Unknown="unknown",t.Expression="expression",t.Field="field"})(lp||(lp={})),function(t){t.Unknown="unknown",t.Stops="stops",t.ClampedLinear="clamped-linear",t.Proportional="proportional",t.Additive="additive",t.Constant="constant",t.Identity="identity",t.RealWorldSize="real-world-size"}(Cn||(Cn={}));const $C={unknown:1,inches:bt(1,"meters","inches"),feet:bt(1,"meters","feet"),"us-feet":bt(1,"meters","us-feet"),yards:bt(1,"meters","yards"),miles:bt(1,"meters","miles"),"nautical-miles":bt(1,"meters","nautical-miles"),millimeters:bt(1,"meters","millimeters"),centimeters:bt(1,"meters","centimeters"),decimeters:bt(1,"meters","decimeters"),meters:bt(1,"meters","meters"),kilometers:bt(1,"meters","kilometers"),"decimal-degrees":1/Qne(1,"meters",Ti.radius)},dg=ie.getLogger("esri.renderers.visualVariables.support.visualVariableUtils"),eZ=new Or,fA=Math.PI,Yde=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i;function Kde(t,e,i){const r="visualVariables"in t&&t.visualVariables?t.visualVariables.find(g=>g.type==="color"):t;if(!r)return;if(r.declaredClass!=="esri.renderers.visualVariables.ColorVariable")return void dg.warn("The visualVariable should be an instance of esri.renderers.visualVariables.ColorVariable");const n=typeof e=="number",s=n?null:e,o=s&&s.attributes;let a=n?e:null;const l=r.field,{ipData:c,hasExpression:u}=r.cache;let h=r.cache.compiledFunc;if(!l&&!u){const g=r.stops;return g&&g[0]&&g[0].color}if(typeof a!="number")if(u){if(i==null||i.arcade==null)return void dg.error("Use of arcade expressions requires an arcade context");const g={viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference},y=i.arcade.arcadeUtils,v=y.getViewInfo(g),b=y.createExecContext(s,v);if(!h){const w=y.createSyntaxTree(r.valueExpression);h=y.createFunction(w),r.cache.compiledFunc=h}a=y.executeFunction(h,b)}else o&&(a=o[l]);const f=r.normalizationField,m=o!=null&&f!=null?parseFloat(o[f]):void 0;if(a!=null&&(!f||n||!isNaN(m)&&m!==0)){isNaN(m)||n||(a/=m);const g=l9(a,c);if(g){const y=g[0],v=g[1],b=y===v?r.stops[y].color:ce.blendColors(r.stops[y].color,r.stops[v].color,g[2],i!=null?i.color:void 0);return new ce(b)}}}function Xde(t,e,i){const r="visualVariables"in t&&t.visualVariables?t.visualVariables.find(g=>g.type==="opacity"):t;if(!r)return;if(r.declaredClass!=="esri.renderers.visualVariables.OpacityVariable")return void dg.warn("The visualVariable should be an instance of esri.renderers.visualVariables.OpacityVariable");const n=typeof e=="number",s=n?null:e,o=s&&s.attributes;let a=n?e:null;const l=r.field,{ipData:c,hasExpression:u}=r.cache;let h=r.cache.compiledFunc;if(!l&&!u){const g=r.stops;return g&&g[0]&&g[0].opacity}if(typeof a!="number")if(u){if(i==null||i.arcade==null)return void dg.error("Use of arcade expressions requires an arcade context");const g={viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference},y=i.arcade.arcadeUtils,v=y.getViewInfo(g),b=y.createExecContext(s,v);if(!h){const w=y.createSyntaxTree(r.valueExpression);h=y.createFunction(w),r.cache.compiledFunc=h}a=y.executeFunction(h,b)}else o&&(a=o[l]);const f=r.normalizationField,m=o!=null&&f!=null?parseFloat(o[f]):void 0;if(a!=null&&(!f||n||!isNaN(m)&&m!==0)){isNaN(m)||n||(a/=m);const g=l9(a,c);if(g){const y=g[0],v=g[1];if(y===v)return r.stops[y].opacity;{const b=r.stops[y].opacity;return b+(r.stops[v].opacity-b)*g[2]}}}}function OL(t,e,i){const r="visualVariables"in t&&t.visualVariables?t.visualVariables.find(m=>m.type==="rotation"):t;if(!r)return;if(r.declaredClass!=="esri.renderers.visualVariables.RotationVariable")return void dg.warn("The visualVariable should be an instance of esri.renderers.visualVariables.RotationVariable");const n=r.axis||"heading",s=n==="heading"&&r.rotationType==="arithmetic"?90:0,o=n==="heading"&&r.rotationType==="arithmetic"?-1:1,a=typeof e=="number"?null:e,l=a&&a.attributes,c=r.field,{hasExpression:u}=r.cache;let h=r.cache.compiledFunc,f=0;if(!c&&!u)return f;if(u){if(i==null||i.arcade==null)return void dg.error("Use of arcade expressions requires an arcade context");const m={viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference},g=i.arcade.arcadeUtils,y=g.getViewInfo(m),v=g.createExecContext(a,y);if(!h){const b=g.createSyntaxTree(r.valueExpression);h=g.createFunction(b),r.cache.compiledFunc=h}f=g.executeFunction(h,v)}else l&&(f=l[c]||0);return f=typeof f!="number"||isNaN(f)?null:s+o*f,f}function t4e(t,e,i){const r=typeof e=="number",n=r?null:e,s=n&&n.attributes;let o=r?e:null;const{isScaleDriven:a}=t.cache;let l=t.cache.compiledFunc;if(a){const u=i!=null?i.scale:void 0,h=i!=null?i.view:void 0;o=u==null||h==="3d"?i4e(t):u}else if(!r)switch(t.inputValueType){case lp.Expression:{if(i==null||i.arcade==null)return void dg.error("Use of arcade expressions requires an arcade context");const u={viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference},h=i.arcade.arcadeUtils,f=h.getViewInfo(u),m=h.createExecContext(n,f);if(!l){const g=h.createSyntaxTree(t.valueExpression);l=h.createFunction(g),t.cache.compiledFunc=l}o=h.executeFunction(l,m);break}case lp.Field:s&&(o=s[t.field]);break;case lp.Unknown:o=null}if(!fT(o))return null;if(r||!t.normalizationField)return o;const c=s?parseFloat(s[t.normalizationField]):null;return fT(c)&&c!==0?o/c:null}function i4e(t){let e=null,i=null;const r=t.stops;return r?(e=r[0].value,i=r[r.length-1].value):(e=t.minDataValue||0,i=t.maxDataValue||0),(e+i)/2}function AC(t,e,i){const r="visualVariables"in t&&t.visualVariables?t.visualVariables.find(s=>s.type==="size"):t;if(!r)return;if(r.declaredClass!=="esri.renderers.visualVariables.SizeVariable")return void dg.warn("The visualVariable should be an instance of esri.renderers.visualVariables.SizeVariable");const n=ehe(t4e(r,e,i),r,e,i,r.cache.ipData);return n==null||isNaN(n)?0:n}function xa(t,e,i){return t==null?null:Rm(t)?AC(t,e,i):fT(t)?t:null}function Qde(t,e,i){return fT(i)&&t>i?i:fT(e)&&t<e?e:t}function r4e(t,e,i,r){return t+((xa(e.minSize,i,r)||e.minDataValue)??0)}function n4e(t,e,i){const r=t.stops;let n=r&&r.length&&r[0].size;return n==null&&(n=t.minSize),xa(n,e,i)}function s4e(t,e,i,r){const n=(t-e.minDataValue)/(e.maxDataValue-e.minDataValue),s=xa(e.minSize,i,r),o=xa(e.maxSize,i,r),a=r!=null?r.shape:void 0;if(t<=e.minDataValue)return s;if(t>=e.maxDataValue)return o;if(s==null||o==null)return null;if(e.scaleBy==="area"&&a){const l=a==="circle",c=l?fA*(s/2)**2:s*s,u=c+n*((l?fA*(o/2)**2:o*o)-c);return l?2*Math.sqrt(u/fA):Math.sqrt(u)}return s+n*(o-s)}function o4e(t,e,i,r){const n=r!=null?r.shape:void 0,s=t/e.minDataValue,o=xa(e.minSize,i,r),a=xa(e.maxSize,i,r);let l=null;return l=n==="circle"?2*Math.sqrt(s*(o/2)**2):n==="square"||n==="diamond"||n==="image"?Math.sqrt(s*o**2):s*o,Qde(l,o,a)}function a4e(t,e,i,r,n){var l,c,u;const[s,o,a]=l9(t,n);if(s===o)return xa((l=e.stops)==null?void 0:l[s].size,i,r);{const h=xa((c=e.stops)==null?void 0:c[s].size,i,r);return h+(xa((u=e.stops)==null?void 0:u[o].size,i,r)-h)*a}}function l4e(t,e,i,r){const n=(r!=null&&r.resolution?r.resolution:1)*$C[e.valueUnit],s=xa(e.minSize,i,r),o=xa(e.maxSize,i,r),{valueRepresentation:a}=e;let l=null;return l=a==="area"?2*Math.sqrt(t/fA)/n:a==="radius"||a==="distance"?2*t/n:t/n,Qde(l,s,o)}function ehe(t,e,i,r,n){switch(e.transformationType){case Cn.Additive:return r4e(t,e,i,r);case Cn.Constant:return n4e(e,i,r);case Cn.ClampedLinear:return s4e(t,e,i,r);case Cn.Proportional:return o4e(t,e,i,r);case Cn.Stops:return a4e(t,e,i,r,n);case Cn.RealWorldSize:return l4e(t,e,i,r);case Cn.Identity:return t;case Cn.Unknown:return null}}function c4e(t,e,i){const{isScaleDriven:r}=t.cache;if(!(r&&i==="3d"||e))return null;const n={scale:e,view:i};let s=xa(t.minSize,eZ,n),o=xa(t.maxSize,eZ,n);if(s!=null||o!=null){if(s>o){const a=o;o=s,s=a}return{minSize:s,maxSize:o}}}function u4e(t,e,i){if(!t.visualVariables)return;const r=[],n=[],s=[],o=[],a=[];for(const l of t.visualVariables)switch(l.type){case"color":n.push(l);break;case"opacity":s.push(l);break;case"rotation":a.push(l);break;case"size":o.push(l)}return n.forEach(l=>{const c=Kde(l,e,i);r.push({variable:l,value:c})}),s.forEach(l=>{const c=Xde(l,e,i);r.push({variable:l,value:c})}),a.forEach(l=>{const c=OL(l,e,i);r.push({variable:l,value:c})}),o.forEach(l=>{const c=AC(l,e,i);r.push({variable:l,value:c})}),r.filter(l=>l.value!=null)}function l9(t,e){if(!e)return;let i=0,r=e.length-1;return e.some((n,s)=>t<n?(r=s,!0):(i=s,!1)),[i,r,(t-e[i])/(e[r]-e[i])]}function the(t,e,i){const r=["proportional","proportional","proportional"];for(const n of t){const s=n.useSymbolValue?"symbol-value":AC(n,e,i);switch(n.axis){case"width":r[0]=s;break;case"depth":r[1]=s;break;case"height":r[2]=s;break;case"width-and-depth":r[0]=s,r[1]=s;break;case"all":case void 0:case null:r[0]=s,r[1]=s,r[2]=s;break;default:n.axis}}return r}const Wv=Object.freeze(Object.defineProperty({__proto__:null,getAllSizes:the,getColor:Kde,getOpacity:Xde,getRotationAngle:OL,getSize:AC,getSizeForValue:ehe,getSizeFromNumberOrVariable:xa,getSizeRangeAtScale:c4e,getVisualVariableValues:u4e,viewScaleRE:Yde},Symbol.toStringTag,{value:"Module"}));var bV;const YE=new He({width:"width",depth:"depth",height:"height",widthAndDepth:"width-and-depth",all:"all"}),wV=new He({unknown:"unknown",inch:"inches",foot:"feet",yard:"yards",mile:"miles","nautical-mile":"nautical-miles",millimeter:"millimeters",centimeter:"centimeters",decimeter:"decimeters",meter:"meters",kilometer:"kilometers","decimal-degree":"decimal-degrees"});function tZ(t){if(t!=null)return typeof t=="string"||typeof t=="number"?$t(t):t.type==="size"?Rm(t)?t:(delete(t={...t}).type,new Yt(t)):void 0}function iZ(t,e,i){if(typeof t!="object")return t;const r=new Yt;return r.read(t,i),r}let Yt=bV=class extends MC{constructor(t){super(t),this.axis=null,this.legendOptions=null,this.normalizationField=null,this.scaleBy=null,this.target=null,this.type="size",this.useSymbolValue=null,this.valueExpression=null,this.valueRepresentation=null,this.valueUnit=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null,isScaleDriven:this.valueExpression!=null&&Yde.test(this.valueExpression)}}set expression(t){ie.getLogger(this).warn("'expression' is deprecated since version 4.2. Use 'valueExpression' instead. The only supported expression is 'view.scale'."),t==="view.scale"?(this.valueExpression="$view.scale",this._set("expression",t)):this._set("expression",null)}set index(t){Rm(this.maxSize)&&(this.maxSize.index=`visualVariables[${t}].maxSize`),Rm(this.minSize)&&(this.minSize.index=`visualVariables[${t}].minSize`),this._set("index",t)}get inputValueType(){return Jde(this)}set maxDataValue(t){t&&this.stops&&(ie.getLogger(this).warn("cannot set maxDataValue when stops is not null."),t=null),this._set("maxDataValue",t)}set maxSize(t){t&&this.stops&&(ie.getLogger(this).warn("cannot set maxSize when stops is not null."),t=null),this._set("maxSize",t)}castMaxSize(t){return tZ(t)}readMaxSize(t,e,i){return iZ(t,e,i)}set minDataValue(t){t&&this.stops&&(ie.getLogger(this).warn("cannot set minDataValue when stops is not null."),t=null),this._set("minDataValue",t)}set minSize(t){t&&this.stops&&(ie.getLogger(this).warn("cannot set minSize when stops is not null."),t=null),this._set("minSize",t)}castMinSize(t){return tZ(t)}readMinSize(t,e,i){return iZ(t,e,i)}get arcadeRequired(){return!!this.valueExpression||this.minSize!=null&&typeof this.minSize=="object"&&this.minSize.arcadeRequired||this.maxSize!=null&&typeof this.maxSize=="object"&&this.maxSize.arcadeRequired}set stops(t){this.minDataValue==null&&this.maxDataValue==null&&this.minSize==null&&this.maxSize==null?t&&Array.isArray(t)&&(t=t.filter(e=>!!e)).sort((e,i)=>e.value-i.value):t&&(ie.getLogger(this).warn("cannot set stops when one of minDataValue, maxDataValue, minSize or maxSize is not null."),t=null),this._set("stops",t)}get transformationType(){return Zde(this,this.inputValueType)}readValueExpression(t,e){return t||e.expression&&"$view.scale"}writeValueExpressionWebScene(t,e,i,r){if(t==="$view.scale"){if(r&&r.messages){const n=this.index,s=typeof n=="string"?n:`visualVariables[${n}]`;r.messages.push(new N("property:unsupported",this.type+"VisualVariable.valueExpression = '$view.scale' is not supported in Web Scene. Please remove this property to save the Web Scene.",{instance:this,propertyName:s+".valueExpression",context:r}))}}else e[i]=t}readValueUnit(t){return t?wV.read(t):null}clone(){return new bV({axis:this.axis,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,maxDataValue:this.maxDataValue,maxSize:Rm(this.maxSize)?this.maxSize.clone():this.maxSize,minDataValue:this.minDataValue,minSize:Rm(this.minSize)?this.minSize.clone():this.minSize,normalizationField:this.normalizationField,stops:this.stops&&this.stops.map(t=>t.clone()),target:this.target,useSymbolValue:this.useSymbolValue,valueRepresentation:this.valueRepresentation,valueUnit:this.valueUnit,legendOptions:this.legendOptions&&this.legendOptions.clone()})}flipSizes(){if(this.transformationType===Cn.ClampedLinear){const{minSize:t,maxSize:e}=this;return this.minSize=e,this.maxSize=t,this}if(this.transformationType===Cn.Stops){const t=this.stops;if(!t)return this;const e=t.map(r=>r.size).reverse(),i=t.length;for(let r=0;r<i;r++)t[r].size=e[r];return this}return this}getAttributeHash(){return`${super.getAttributeHash()}-${this.target}-${this.normalizationField}`}_interpolateData(){return this.stops&&this.stops.map(t=>t.value||0)}};d([p({readOnly:!0})],Yt.prototype,"cache",null),d([p({type:YE.apiValues,json:{type:YE.jsonValues,origins:{"web-map":{read:!1}},read:YE.read,write:YE.write}})],Yt.prototype,"axis",void 0),d([p({type:String,value:null,json:{read:!1}})],Yt.prototype,"expression",null),d([p()],Yt.prototype,"index",null),d([p({type:String,readOnly:!0})],Yt.prototype,"inputValueType",null),d([p({type:Wde,json:{write:!0}})],Yt.prototype,"legendOptions",void 0),d([p({type:Number,value:null,json:{write:!0}})],Yt.prototype,"maxDataValue",null),d([p({type:Number,value:null,json:{write:!0}})],Yt.prototype,"maxSize",null),d([tt("maxSize")],Yt.prototype,"castMaxSize",null),d([ae("maxSize")],Yt.prototype,"readMaxSize",null),d([p({type:Number,value:null,json:{write:!0}})],Yt.prototype,"minDataValue",null),d([p({type:Number,value:null,json:{write:!0}})],Yt.prototype,"minSize",null),d([tt("minSize")],Yt.prototype,"castMinSize",null),d([ae("minSize")],Yt.prototype,"readMinSize",null),d([p({type:String,json:{write:!0}})],Yt.prototype,"normalizationField",void 0),d([p({readOnly:!0})],Yt.prototype,"arcadeRequired",null),d([p({type:String})],Yt.prototype,"scaleBy",void 0),d([p({type:[mb],value:null,json:{write:!0}})],Yt.prototype,"stops",null),d([p({type:["outline"],json:{write:!0}})],Yt.prototype,"target",void 0),d([p({type:String,readOnly:!0})],Yt.prototype,"transformationType",null),d([p({type:["size"],json:{type:["sizeInfo"]}})],Yt.prototype,"type",void 0),d([p({type:Boolean,json:{write:!0,origins:{"web-map":{read:!1}}}})],Yt.prototype,"useSymbolValue",void 0),d([p({type:String,json:{write:!0}})],Yt.prototype,"valueExpression",void 0),d([ae("valueExpression",["valueExpression","expression"])],Yt.prototype,"readValueExpression",null),d([ge("web-scene","valueExpression")],Yt.prototype,"writeValueExpressionWebScene",null),d([p({type:["radius","diameter","area","width","distance"],json:{write:!0}})],Yt.prototype,"valueRepresentation",void 0),d([p({type:wV.apiValues,json:{write:wV.write,origins:{"web-map":{read:!1},"web-scene":{write:!0},"portal-item":{write:!0}}}})],Yt.prototype,"valueUnit",void 0),d([ae("valueUnit")],Yt.prototype,"readValueUnit",null),Yt=bV=d([A("esri.renderers.visualVariables.SizeVariable")],Yt);const Jv=Yt,d4e={color:Hde,size:Jv,opacity:qde,rotation:PL},h4e=new He({colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation",sizeInfo:"size"}),p4e=/^\[([^\]]+)\]$/i;let mA=class extends he{constructor(){super(...arguments),this.colorVariables=null,this.opacityVariables=null,this.rotationVariables=null,this.sizeVariables=null}set visualVariables(e){if(this._resetVariables(),(e=e&&e.filter(i=>!!i))&&e.length){for(const i of e)switch(i.type){case"color":this.colorVariables.push(i);break;case"opacity":this.opacityVariables.push(i);break;case"rotation":this.rotationVariables.push(i);break;case"size":this.sizeVariables.push(i)}this.sizeVariables.length&&this.sizeVariables.some(i=>!!i.target)&&e.sort((i,r)=>{let n=null;return n=i.target===r.target?0:i.target?1:-1,n});for(let i=0;i<e.length;i++)e[i].index=i;this._set("visualVariables",e)}else this._set("visualVariables",e)}readVariables(e,i,r){const{rotationExpression:n,rotationType:s}=i,o=n&&n.match(p4e),a=o&&o[1];if(a&&(e||(e=[]),e.push({type:"rotationInfo",rotationType:s,field:a})),e)return e.map(l=>{const c=h4e.read(l.type),u=d4e[c];u||(ie.getLogger(this).warn(`Unknown variable type: ${c}`),r&&r.messages&&r.messages.push(new ol("visual-variable:unsupported",`visualVariable of type '${c}' is not supported`,{definition:l,context:r})));const h=new u;return h.read(l,r),h})}writeVariables(e,i){const r=[];for(const n of e){const s=n.toJSON(i);s&&r.push(s)}return r}_resetVariables(){this.colorVariables=[],this.opacityVariables=[],this.rotationVariables=[],this.sizeVariables=[]}};d([p()],mA.prototype,"visualVariables",null),mA=d([A("esri.renderers.visualVariables.VisualVariableFactory")],mA);const f4e=mA,m4e={base:MC,key:"type",typeMap:{opacity:qde,color:Hde,rotation:PL,size:Jv}},Cg=t=>{let e=class extends t{constructor(){super(...arguments),this._vvFactory=new f4e}set visualVariables(i){this._vvFactory.visualVariables=i,this._set("visualVariables",this._vvFactory.visualVariables)}readVisualVariables(i,r,n){return this._vvFactory.readVariables(i,r,n)}writeVisualVariables(i,r,n,s){r[n]=this._vvFactory.writeVariables(i,s)}get arcadeRequiredForVisualVariables(){if(!this.visualVariables)return!1;for(const i of this.visualVariables)if(i.arcadeRequired)return!0;return!1}hasVisualVariables(i,r){return i?this.getVisualVariablesForType(i,r).length>0:this.getVisualVariablesForType("size",r).length>0||this.getVisualVariablesForType("color",r).length>0||this.getVisualVariablesForType("opacity",r).length>0||this.getVisualVariablesForType("rotation",r).length>0}getVisualVariablesForType(i,r){const n=this.visualVariables;return n?n.filter(s=>s.type===i&&(typeof r=="string"?s.target===r:r!==!1||!s.target)):[]}async collectVVRequiredFields(i,r){let n=[];this.visualVariables&&(n=n.concat(this.visualVariables));for(const s of n)s&&(s.field&&rl(i,r,s.field),s.normalizationField&&rl(i,r,s.normalizationField),s.valueExpression&&(g4e(s.valueExpression,i,r)||await jo(i,r,s.valueExpression)))}};return d([p({types:[m4e],value:null,json:{write:!0}})],e.prototype,"visualVariables",null),d([ae("visualVariables",["visualVariables","rotationType","rotationExpression"])],e.prototype,"readVisualVariables",null),d([ge("visualVariables")],e.prototype,"writeVisualVariables",null),e=d([A("esri.renderers.mixins.VisualVariablesMixin")],e),e};function g4e(t,e,i){const r=KNe(t);return r!=null&&(rl(e,i,r),!0)}const gb={retainId:!1,ignoreDrivers:!1,hasLabelingContext:!0};function Av(t,e=gb){var a,l;if(!t)return{symbol:null};const{retainId:i=gb.retainId,ignoreDrivers:r=gb.ignoreDrivers,hasLabelingContext:n=gb.hasLabelingContext,retainCIM:s=gb.retainCIM}=e;let o=null;if(Bd(t)||t instanceof Hv)o=t.clone();else if(t.type==="cim"){const c=(l=(a=t.data)==null?void 0:a.symbol)==null?void 0:l.type;if(c!=="CIMPointSymbol")return{error:new N("symbol-conversion:unsupported-cim-symbol",`CIM symbol of type '${c||"unknown"}' is unsupported in 3D`,{symbol:t})};o=s?t.clone():U0.fromCIMSymbol(t)}else if(t instanceof Yn)o=hL.fromSimpleLineSymbol(t);else if(t instanceof ms)o=U0.fromSimpleMarkerSymbol(t);else if(t instanceof Ym)o=U0.fromPictureMarkerSymbol(t);else if(t instanceof hc)o=e.geometryType&&e.geometryType==="mesh"?vC.fromSimpleFillSymbol(t):_C.fromSimpleFillSymbol(t);else{if(!(t instanceof Gv))return{error:new N("symbol-conversion:unsupported-2d-symbol",`2D symbol of type '${t.type||t.declaredClass}' is unsupported in 3D`,{symbol:t})};o=n?dL.fromTextSymbol(t):U0.fromTextSymbol(t)}return i&&o&&o.type!=="cim"&&(o.id=t.id),r&&Bd(o)&&o.symbolLayers.forEach(c=>c.ignoreDrivers=!0),{symbol:o}}function CP(t,e,i,r){const n=ihe(t,{},{context:r,isLabelSymbol:!1});n!=null&&(e[i]=n)}function rZ(t,e,i,r){const n=ihe(t,{},{context:r,isLabelSymbol:!0});n!=null&&(e[i]=n)}function nZ(t){return t instanceof Z1||t instanceof Hv}function ihe(t,e,i){if(t==null)return null;const{context:r,isLabelSymbol:n}=i,s=r==null?void 0:r.origin,o=r==null?void 0:r.messages;if(s==="web-scene"&&!nZ(t)){const a=Av(t,{retainCIM:!0,hasLabelingContext:n});return a.symbol!=null?a.symbol.write(e,r):(o==null||o.push(new N("symbol:unsupported",`Symbols of type '${t.declaredClass}' are not supported in scenes. Use 3D symbology instead when working with WebScene and SceneView`,{symbol:t,context:r,error:a.error})),null)}return(s==="web-map"||s==="portal-item"&&!yse(r==null?void 0:r.layer))&&nZ(t)?(o==null||o.push(new N("symbol:unsupported",`Symbols of type '${t.declaredClass}' are not supported in web maps and portal items. Use 2D symbology and CIMSymbol instead when working with MapView`,{symbol:t,context:r})),null):t.write(e,r)}function rhe(t,e){return JAe(t,null,e)}const Q1={types:Tle,json:{write:{writer:CP},origins:{"web-scene":{types:iW,write:{writer:CP},read:{reader:L1({types:iW})}}}}},nhe={types:{base:Ma,key:"type",typeMap:{"simple-fill":uu.typeMap["simple-fill"],"picture-fill":uu.typeMap["picture-fill"],"polygon-3d":uu.typeMap["polygon-3d"]}},json:{write:{writer:CP},origins:{"web-scene":{type:_C,write:{writer:CP}}}}},gA={cast:t=>t==null||typeof t=="string"||typeof t=="number"?t:`${t}`,json:{type:String,write:{writer:(t,e)=>{e.value=t==null?void 0:t.toString()}}}};var xV;let Af=xV=class extends te{constructor(t){super(t),this.description=null,this.label=null,this.minValue=null,this.maxValue=0,this.symbol=null}clone(){return new xV({description:this.description,label:this.label,minValue:this.minValue,maxValue:this.maxValue,symbol:this.symbol?this.symbol.clone():null})}getMeshHash(){const t=JSON.stringify(this.symbol);return`${this.minValue}.${this.maxValue}.${t}`}};d([p({type:String,json:{write:!0}})],Af.prototype,"description",void 0),d([p({type:String,json:{write:!0}})],Af.prototype,"label",void 0),d([p({type:Number,json:{read:{source:"classMinValue"},write:{target:"classMinValue"}}})],Af.prototype,"minValue",void 0),d([p({type:Number,json:{read:{source:"classMaxValue"},write:{target:"classMaxValue"}}})],Af.prototype,"maxValue",void 0),d([p(Q1)],Af.prototype,"symbol",void 0),Af=xV=d([A("esri.renderers.support.ClassBreakInfo")],Af);const f1=Af;var SV;const she="log",yA="percent-of-total",vA="field",KE=new He({esriNormalizeByLog:she,esriNormalizeByPercentOfTotal:yA,esriNormalizeByField:vA}),y4e=lr(f1);let gn=SV=class extends Cg($p){constructor(t){super(t),this._compiledValueExpression={valueExpression:null,compiledFunction:null},this.backgroundFillSymbol=null,this.classBreakInfos=null,this.defaultLabel=null,this.defaultSymbol=null,this.field=null,this.isMaxInclusive=!0,this.legendOptions=null,this.normalizationField=null,this.normalizationTotal=null,this.type="class-breaks",this.valueExpression=null,this.valueExpressionTitle=null,this._set("classBreakInfos",[])}readClassBreakInfos(t,e,i){if(!Array.isArray(t))return;let r=e.minValue;return t.map(n=>{const s=new f1;return s.read(n,i),s.minValue==null&&(s.minValue=r),s.maxValue==null&&(s.maxValue=s.minValue),r=s.maxValue,s})}writeClassBreakInfos(t,e,i,r){const n=t.map(s=>s.write({},r));this._areClassBreaksConsecutive()&&n.forEach(s=>delete s.classMinValue),e[i]=n}castField(t){return t==null?t:typeof t=="function"?(ie.getLogger(this).error(".field: field must be a string value"),null):eC(t)}get minValue(){return this.classBreakInfos&&this.classBreakInfos[0]&&this.classBreakInfos[0].minValue||0}get normalizationType(){let t=this._get("normalizationType");const e=!!this.normalizationField,i=this.normalizationTotal!=null;return e||i?(t=e&&vA||i&&yA||null,e&&i&&ie.getLogger(this).warn("warning: both normalizationField and normalizationTotal are set!")):t!==vA&&t!==yA||(t=null),t}set normalizationType(t){this._set("normalizationType",t)}addClassBreakInfo(t,e,i){let r=null;r=typeof t=="number"?new f1({minValue:t,maxValue:e,symbol:Cle(i)}):y4e(U(t)),this.classBreakInfos.push(r),this.classBreakInfos.length===1&&this.notifyChange("minValue")}removeClassBreakInfo(t,e){const i=this.classBreakInfos.length;for(let r=0;r<i;r++){const n=[this.classBreakInfos[r].minValue,this.classBreakInfos[r].maxValue];if(n[0]===t&&n[1]===e){this.classBreakInfos.splice(r,1);break}}}getBreakIndex(t,e){return!this.valueExpression||e!=null&&e.arcade!=null||ie.getLogger(this).warn(""),this.valueExpression?this._getBreakIndexForExpression(t,e):this._getBreakIndexForField(t)}async getClassBreakInfo(t,e){let i=e;!this.valueExpression||e!=null&&e.arcade!=null||(i={...i,arcade:await zd()});const r=this.getBreakIndex(t,i);return r!==-1?this.classBreakInfos[r]:null}getSymbol(t,e){if(this.valueExpression&&(e==null||e.arcade==null))return void ie.getLogger(this).error("#getSymbol()","Please use getSymbolAsync if valueExpression is used");const i=this.getBreakIndex(t,e);return i>-1?this.classBreakInfos[i].symbol:this.defaultSymbol}async getSymbolAsync(t,e){let i=e;if(this.valueExpression&&(e==null||e.arcade==null)){const n=await zd(),{arcadeUtils:s}=n;s.hasGeometryOperations(this.valueExpression)&&await s.enableGeometryOperations(),i={...i,arcade:n}}const r=this.getBreakIndex(t,i);return r>-1?this.classBreakInfos[r].symbol:this.defaultSymbol}getSymbols(){const t=[];return this.classBreakInfos.forEach(e=>{e.symbol&&t.push(e.symbol)}),this.defaultSymbol&&t.push(this.defaultSymbol),t}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce((t,e)=>t+e.getAttributeHash(),"")}getMeshHash(){const t=JSON.stringify(this.backgroundFillSymbol),e=JSON.stringify(this.defaultSymbol),i=`${this.normalizationField}.${this.normalizationType}.${this.normalizationTotal}`;return`${t}.${e}.${this.classBreakInfos.reduce((r,n)=>r+n.getMeshHash(),"")}.${i}.${this.field}.${this.valueExpression}`}get arcadeRequired(){return this.arcadeRequiredForVisualVariables||!!this.valueExpression}clone(){return new SV({field:this.field,backgroundFillSymbol:this.backgroundFillSymbol&&this.backgroundFillSymbol.clone(),defaultLabel:this.defaultLabel,defaultSymbol:this.defaultSymbol&&this.defaultSymbol.clone(),valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,classBreakInfos:U(this.classBreakInfos),isMaxInclusive:this.isMaxInclusive,normalizationField:this.normalizationField,normalizationTotal:this.normalizationTotal,normalizationType:this.normalizationType,visualVariables:U(this.visualVariables),legendOptions:U(this.legendOptions),authoringInfo:this.authoringInfo&&this.authoringInfo.clone()})}async collectRequiredFields(t,e){const i=[this.collectVVRequiredFields(t,e),this.collectSymbolFields(t,e)];await Promise.all(i)}async collectSymbolFields(t,e){const i=[...this.getSymbols().map(r=>r.collectRequiredFields(t,e)),jo(t,e,this.valueExpression)];rl(t,e,this.field),rl(t,e,this.normalizationField),await Promise.all(i)}_getBreakIndexForExpression(t,e){const{viewingMode:i,scale:r,spatialReference:n,arcade:s}=e??{},{valueExpression:o}=this;let a=this._compiledValueExpression.valueExpression===o?this._compiledValueExpression.compiledFunction:null;const l=s.arcadeUtils;if(!a){const u=l.createSyntaxTree(o);a=l.createFunction(u),this._compiledValueExpression.compiledFunction=a}this._compiledValueExpression.valueExpression=o;const c=l.executeFunction(a,l.createExecContext(t,l.getViewInfo({viewingMode:i,scale:r,spatialReference:n})));return this._getBreakIndexfromInfos(c)}_getBreakIndexForField(t){const e=this.field,i=t.attributes,r=this.normalizationType;let n=parseFloat(i[e]);if(r){const s=this.normalizationTotal,o=parseFloat(this.normalizationField?i[this.normalizationField]:void 0);if(r===she)n=Math.log(n)*Math.LOG10E;else if(r!==yA||s==null||isNaN(s)){if(r===vA&&!isNaN(o)){if(isNaN(n)||isNaN(o))return-1;n/=o}}else n=n/s*100}return this._getBreakIndexfromInfos(n)}_getBreakIndexfromInfos(t){const e=this.isMaxInclusive;if(t!=null&&typeof t=="number"&&!isNaN(t))for(let i=0;i<this.classBreakInfos.length;i++){const r=[this.classBreakInfos[i].minValue,this.classBreakInfos[i].maxValue];if(r[0]<=t&&(e?t<=r[1]:t<r[1]))return i}return-1}_areClassBreaksConsecutive(){const t=this.classBreakInfos,e=t.length;for(let i=1;i<e;i++)if(t[i-1].maxValue!==t[i].minValue)return!1;return!0}};d([p(nhe)],gn.prototype,"backgroundFillSymbol",void 0),d([p({type:[f1]})],gn.prototype,"classBreakInfos",void 0),d([ae("classBreakInfos")],gn.prototype,"readClassBreakInfos",null),d([ge("classBreakInfos")],gn.prototype,"writeClassBreakInfos",null),d([p({type:String,json:{write:!0}})],gn.prototype,"defaultLabel",void 0),d([p(Q1)],gn.prototype,"defaultSymbol",void 0),d([p({type:String,json:{write:!0}})],gn.prototype,"field",void 0),d([tt("field")],gn.prototype,"castField",null),d([p({type:Boolean})],gn.prototype,"isMaxInclusive",void 0),d([p({type:lv,json:{write:!0}})],gn.prototype,"legendOptions",void 0),d([p({type:Number,readOnly:!0,value:null,json:{read:!1,write:{overridePolicy(){return this.classBreakInfos.length!==0&&this._areClassBreaksConsecutive()?{enabled:!0}:{enabled:!1}}}}})],gn.prototype,"minValue",null),d([p({type:String,json:{write:!0}})],gn.prototype,"normalizationField",void 0),d([p({type:Number,cast:t=>ql(t),json:{write:!0}})],gn.prototype,"normalizationTotal",void 0),d([p({type:KE.apiValues,value:null,json:{type:KE.jsonValues,read:KE.read,write:KE.write}})],gn.prototype,"normalizationType",null),d([xe({classBreaks:"class-breaks"})],gn.prototype,"type",void 0),d([p({type:String,json:{write:!0}})],gn.prototype,"valueExpression",void 0),d([p({type:String,json:{write:!0}})],gn.prototype,"valueExpressionTitle",void 0),gn=SV=d([A("esri.renderers.ClassBreaksRenderer")],gn);const ex=gn,a5=-3;var pm;(function(t){t[t.ALL=0]="ALL",t[t.SOME=1]="SOME"})(pm||(pm={}));let xbt=class{constructor(e,i,r){this.name=e,this._storage=i,this.id=_4e+++":",this.size=0,this.maxSize=0,this._removeFunc=!1,this._hit=0,this._miss=0,this._storage.register(this),r&&(this._storage.registerRemoveFunc(this.id,r),this._removeFunc=!0)}destroy(){this._storage.clear(this),this._removeFunc&&this._storage.deregisterRemoveFunc(this.id),this._storage.deregister(this),this._storage=null}get hitRate(){return this._hit/(this._hit+this._miss)}get sizeAll(){return this._storage.size}resetHitRate(){this._hit=this._miss=0}put(e,i,r,n=0){this._storage.put(this,e,i,r,n)}get(e){const i=this._storage.get(this,e);return i===void 0?++this._miss:++this._hit,i}pop(e){const i=this._storage.pop(this,e);return i===void 0?++this._miss:++this._hit,i}updateSize(e,i,r){this._storage.updateSize(this,e,i,r)}clear(){this._storage.clear(this)}clearAll(){this._storage.clearAll()}get performanceInfo(){return this._storage.performanceInfo}resetStats(){this._storage.resetStats()}},v4e=class{get size(){return this._size}constructor(e=10485760){this._maxSize=e,this._db=new Map,this._size=0,this._hit=0,this._miss=0,this._removeFuncs=new qm,this._users=new qm}destroy(){this.clearAll(),this._removeFuncs.clear(),this._users.clear(),this._db=null}register(e){this._users.push(e)}deregister(e){this._users.removeUnordered(e)}registerRemoveFunc(e,i){this._removeFuncs.push([e,i])}deregisterRemoveFunc(e){this._removeFuncs.filterInPlace(i=>i[0]!==e)}get maxSize(){return this._maxSize}set maxSize(e){this._maxSize=Math.max(e,0),this._checkSizeLimits()}put(e,i,r,n,s){i=e.id+i;const o=this._db.get(i);if(o&&(this._size-=o.size,e.size-=o.size,this._db.delete(i),o.entry!==r&&this._notifyRemove(i,o.entry,pm.ALL)),n>this._maxSize)return void this._notifyRemove(i,r,pm.ALL);if(r===void 0)return void console.warn("Refusing to cache undefined entry ");if(!n||n<0)return void console.warn("Refusing to cache entry with invalid size "+n);const a=1+Math.max(s,a5)-a5;this._db.set(i,{entry:r,size:n,lifetime:a,lives:a}),this._size+=n,e.size+=n,this._checkSizeLimits()}updateSize(e,i,r,n){i=e.id+i;const s=this._db.get(i);if(s&&s.entry===r){for(this._size-=s.size,e.size-=s.size;n>this._maxSize;){const o=this._notifyRemove(i,r,pm.SOME);if(!(o!=null&&o>0))return void this._db.delete(i);n=o}s.size=n,this._size+=n,e.size+=n,this._checkSizeLimits()}}pop(e,i){i=e.id+i;const r=this._db.get(i);if(r)return this._size-=r.size,e.size-=r.size,this._db.delete(i),++this._hit,r.entry;++this._miss}get(e,i){i=e.id+i;const r=this._db.get(i);if(r!==void 0)return this._db.delete(i),r.lives=r.lifetime,this._db.set(i,r),++this._hit,r.entry;++this._miss}get performanceInfo(){const e={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},i={},r=new Array;this._db.forEach((o,a)=>{const l=o.lifetime;r[l]=(r[l]||0)+o.size,this._users.forAll(c=>{const{id:u,name:h}=c;if(a.startsWith(u)){const f=i[h]||0;i[h]=f+o.size}})});const n={};this._users.forAll(o=>{const a=o.name;if("hitRate"in o&&typeof o.hitRate=="number"&&!isNaN(o.hitRate)&&o.hitRate>0){const l=i[a]||0;i[a]=l,n[a]=Math.round(100*o.hitRate)+"%"}else n[a]="0%"});const s=Object.keys(i);s.sort((o,a)=>i[a]-i[o]),s.forEach(o=>e[o]=Math.round(i[o]/2**20)+"MB / "+n[o]);for(let o=r.length-1;o>=0;--o){const a=r[o];a&&(e["Priority "+(o+a5-1)]=Math.round(a/this._size*100)+"%")}return e}resetStats(){this._hit=this._miss=0,this._users.forAll(e=>e.resetHitRate())}clear(e){const i=e.id;this._db.forEach((r,n)=>{n.startsWith(i)&&(this._size-=r.size,this._db.delete(n),this._notifyRemove(n,r.entry,pm.ALL))}),e.size=0}clearAll(){this._db.forEach((e,i)=>this._notifyRemove(i,e.entry,pm.ALL)),this._users.forEach(e=>e.size=0),this._size=0,this._db.clear()}_getHitRate(){return this._hit/(this._hit+this._miss)}_notifyRemove(e,i,r){let n;return this._removeFuncs.some(s=>{if(e.startsWith(s[0])){const o=s[1](i,r);return typeof o=="number"&&(n=o),!0}return!1}),n}_checkSizeLimits(){if(this._size>this._maxSize){for(const[e,i]of this._db)if(this._purgeItem(e,i),this._size<=.9*this.maxSize)return}this._users.forEach(e=>{if(e.maxSize>0&&e.size>e.maxSize){for(const[i,r]of this._db)if(i.startsWith(e.id)&&(this._purgeItem(i,r,e),e.size<=.9*e.maxSize))return}})}_purgeItem(e,i,r=this._users.find(n=>e.startsWith(n.id))){if(this._db.delete(e),i.lives<=1){this._size-=i.size,r&&(r.size-=i.size);const n=this._notifyRemove(e,i.entry,pm.SOME);n!=null&&n>0&&(this._size+=n,r&&(r.size+=n),i.lives=i.lifetime,i.size=n,this._db.set(e,i))}else--i.lives,this._db.set(e,i)}},_4e=0,LL=class{constructor(e,i){this._storage=new v4e,this.id="",this.name="",this.size=0,this._storage.maxSize=e,this._storage.register(this),i&&this._storage.registerRemoveFunc("",i)}destroy(){this._storage.deregister(this),this._storage.destroy()}put(e,i,r=1){this._storage.put(this,e,i,r,1)}pop(e){return this._storage.pop(this,e)}get(e){return this._storage.get(this,e)}clear(){this._storage.clearAll()}get maxSize(){return this._storage.maxSize}set maxSize(e){this._storage.maxSize=e}resetHitRate(){}},IV=class{constructor(e,i,r=""){this.major=e,this.minor=i,this._context=r}lessThan(e,i){return this.major<e||e===this.major&&this.minor<i}since(e,i){return!this.lessThan(e,i)}validate(e){if(this.major!==e.major){const i=this._context&&this._context+":",r=this._context&&this._context+" ";throw new N(i+"unsupported-version",`Required major ${r}version is '${this.major}', but got '\${version.major}.\${version.minor}'`,{version:e})}}clone(){return new IV(this.major,this.minor,this._context)}static parse(e,i=""){const[r,n]=e.split("."),s=/^\s*\d+\s*$/;if(!r||!r.match||!s.test(r))throw new N((i&&i+":")+"invalid-version","Expected major version to be a number, but got '${version}'",{version:e});if(!n||!n.match||!s.test(n))throw new N((i&&i+":")+"invalid-version","Expected minor version to be a number, but got '${version}'",{version:e});const o=parseInt(r,10),a=parseInt(n,10);return new IV(o,a,i)}};function b4e(t){return t.type==="date"||t.type==="esriFieldTypeDate"||t.type==="date-only"||t.type==="esriFieldTypeDateOnly"||t.type==="timestamp-offset"||t.type==="esriFieldTypeTimestampOffset"}function sZ(t){return t.type==="oid"||t.type==="esriFieldTypeOID"}function oZ(t){return t.type==="global-id"||t.type==="esriFieldTypeGlobalID"}let ohe=class{constructor(e=[]){if(this.fields=[],this._fieldsMap=new Map,this._normalizedFieldsMap=new Map,this._dateFieldsSet=new Set,this._numericFieldsSet=new Set,this.dateFields=[],this.numericFields=[],this._requiredFields=null,!e)return;this.fields=e;const i=[];for(const r of e){const n=r==null?void 0:r.name,s=lZ(r==null?void 0:r.name);if(n&&s){const o=aZ(n);this._fieldsMap.set(n,r),this._fieldsMap.set(o,r),this._normalizedFieldsMap.set(s,r),i.push(o),b4e(r)?(this.dateFields.push(r),this._dateFieldsSet.add(r)):Cd(r)&&(this._numericFieldsSet.add(r),this.numericFields.push(r)),sZ(r)||oZ(r)||(r.editable=r.editable==null||!!r.editable,r.nullable=r.nullable==null||!!r.nullable)}}i.sort(),this.uid=i.join(",")}destroy(){this._fieldsMap.clear()}get requiredFields(){if(!this._requiredFields){this._requiredFields=[];for(const e of this.fields)sZ(e)||oZ(e)||e.nullable||pEe(e)!==void 0||this._requiredFields.push(e)}return this._requiredFields}has(e){return this.get(e)!=null}get(e){if(!e)return;let i=this._fieldsMap.get(e);return i||(i=this._fieldsMap.get(aZ(e))??this._normalizedFieldsMap.get(lZ(e)),i&&this._fieldsMap.set(e,i),i)}isDateField(e){return this._dateFieldsSet.has(this.get(e))}isNumericField(e){return this._numericFieldsSet.has(this.get(e))}normalizeFieldName(e){const i=this.get(e);if(i)return i.name??void 0}};function aZ(t){return t.trim().toLowerCase()}function lZ(t){var e;return((e=eEe(t))==null?void 0:e.toLowerCase())??""}const cZ="esri.renderers.support.DictionaryLoader",w4e={type:"CIMSimpleLineCallout",lineSymbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",width:.5,color:[0,0,0,255]}]}};let c9=class{constructor(e,i,r){this.config=null,this.fieldMap=null,this.url=null,this._ongoingRequests=new Map,this._symbolCache=new LL(100),this._dictionaryVersion=null,this._fieldIndex=null,this._dictionaryPromise=null,this.url=e,this.config=i,this.fieldMap=r}getSymbolFields(){return this._symbolFields}async getSymbolAsync(e,i){let r;this._dictionaryPromise||(this._dictionaryPromise=this.fetchResources(i));try{r=await this._dictionaryPromise}catch(g){if(ys(g))return this._dictionaryPromise=null,null}const n=this._dictionaryVersion&&this._dictionaryVersion.since(4,0),s={};if(this.fieldMap)for(const g of this._symbolFields){const y=this._getFieldName(this.fieldMap[g]);s[g]=y?n?e.attributes[y]:""+e.attributes[y]:""}let o=null;try{o=r==null?void 0:r(s,i)}catch{return null}if(!o||typeof o!="string")return null;const a=j6(o).toString(),l=this._symbolCache.get(a);if(l)return l.catch(()=>{this._symbolCache.pop(a)}),l;const c=o.split(";"),u=[],h=[];for(const g of c)if(g)if(g.includes("po:")){const y=g.substr(3).split("|");if(y.length===3){const v=y[0],b=y[1];let w=y[2];if(b==="DashTemplate")w=w.split(" ").map(x=>Number(x));else if(b==="Color"){const x=new ce(w).toRgba();w=[x[0],x[1],x[2],255*x[3]]}else w=Number(w);h.push({primitiveName:v,propertyName:b,value:w})}}else if(g.includes("|")){for(const y of g.split("|"))if(this._itemNames.has(y)){u.push(y);break}}else this._itemNames.has(g)&&u.push(g);const f=e.geometry==null||!e.geometry.hasZ&&e.geometry.type==="point",m=this._cimPartsToCIMSymbol(u,h,f,i);return this._symbolCache.put(a,m,1),m}async fetchResources(e){if(this._dictionaryPromise)return this._dictionaryPromise;if(!this.url)return void ie.getLogger(cZ).error("no valid URL!");const i=at(this.url+"/resources/styles/dictionary-info.json",{responseType:"json",query:{f:"json"},signal:e!=null?e.signal:null}),[{data:r}]=await Promise.all([i,zd()]);if(!r)throw this._dictionaryPromise=null,new N("esri.renderers.DictionaryRenderer","Bad dictionary data!");const{authoringInfo:n,dictionary_version:s,expression:o,itemsNames:a}=r,l=o;let c=!1;s&&(this._dictionaryVersion=IV.parse(s),c=this._dictionaryVersion.since(4,0)),this._refSymbolUrlTemplate=this.url+"/"+r.cimRefTemplateUrl,this._itemNames=new Set(a),this._symbolFields=n.symbol;const u={};if(this.config){const m=this.config;for(const g in m)u[g]=m[g]}if(n.configuration)for(const m of n.configuration)u.hasOwnProperty(m.name)||(u[m.name]=m.value);const h=[];if(e!=null&&e.fields&&this.fieldMap)for(const m of this._symbolFields){const g=this.fieldMap[m],y=e.fields.filter(v=>v.name.toLowerCase()===(g==null?void 0:g.toLowerCase()));y.length>0&&h.push({...y[0],type:c?y[0].type:"esriFieldTypeString"})}h.length>0&&(this._fieldIndex=new ohe(h));const f=KCe(l,e!=null?e.spatialReference:null,h,u).then(m=>{const g={scale:0};return(y,v)=>{if(m==null)return null;const b=m.repurposeFeature({geometry:null,attributes:y});return g.scale=v!=null?v.scale??void 0:void 0,m.evaluate({$feature:b,$view:g},m.services)}}).catch(m=>(ie.getLogger(cZ).error("Creating dictinoary expression failed:",m),null));return this._dictionaryPromise=f,f}async _cimPartsToCIMSymbol(e,i,r,n){const s=new Array(e.length);for(let l=0;l<e.length;l++)s[l]=this._getSymbolPart(e[l],n);const o=await Promise.all(s),a=this.fieldMap;if(a)for(const l of o)ahe(l,a);return new q1({data:this._combineSymbolParts(o,i,r)})}async _getSymbolPart(e,i){if(this._ongoingRequests.has(e))return this._ongoingRequests.get(e).then(s=>s.data);const r=this._refSymbolUrlTemplate.replaceAll(/\{itemName\}/gi,e),n=at(r,{responseType:"json",query:{f:"json"},...i});this._ongoingRequests.set(e,n);try{return(await n).data}catch(s){throw this._ongoingRequests.delete(e),s}}_combineSymbolParts(e,i,r){if(!e||e.length===0)return null;const n={...e[0]};if(e.length>1){n.symbolLayers=[];for(const s of e){const o=s;n.symbolLayers.unshift(...o.symbolLayers)}}return r&&(n.callout=w4e),{type:"CIMSymbolReference",symbol:n,primitiveOverrides:i}}_getFieldName(e){if(this._fieldIndex!==null){const i=this._fieldIndex.get(e);return i?i.name:e}return e}};function ahe(t,e){if(!t)return;const i=t.symbolLayers;if(!i)return;let r=i.length;for(;r--;){const n=i[r];n&&n.enable!==!1&&n.type==="CIMVectorMarker"&&x4e(n,e)}}function x4e(t,e){const i=t.markerGraphics;if(i)for(const r of i){if(!r)continue;const n=r.symbol;if(n)switch(n.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":ahe(n,e);break;case"CIMTextSymbol":n.fieldMap=e}}}const $bt=Object.freeze(Object.defineProperty({__proto__:null,DictionaryLoader:c9},Symbol.toStringTag,{value:"Module"}));var TV;let zc=TV=class extends Cg($p){constructor(t){super(t),this.config=null,this.fieldMap=null,this.scaleExpression=null,this.scaleExpressionTitle=null,this.url=null,this.type="dictionary"}get _loader(){return new c9(this.url,this.config,this.fieldMap)}writeData(t,e){t&&(e.scalingExpressionInfo={expression:t,returnType:"number"})}writeVisualVariables(t,e,i,r){r!=null&&r.origin||super.writeVisualVariables(t,e,i,r)}clone(){return new TV({config:U(this.config),scaleExpression:this.scaleExpression,scaleExpressionTitle:this.scaleExpressionTitle,fieldMap:U(this.fieldMap),url:U(this.url),visualVariables:U(this.visualVariables)})}async getSymbolAsync(t,e){return this._loader.getSymbolAsync(t,e)}async collectRequiredFields(t,e){await this.collectVVRequiredFields(t,e),this.scaleExpression&&await jo(t,e,this.scaleExpression);for(const i in this.fieldMap){const r=this.fieldMap[i];e.has(r)&&t.add(r)}}get arcadeRequired(){return!0}getSymbol(){return null}getSymbols(){return[]}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce((t,e)=>t+e.getAttributeHash(),"")}getMeshHash(){return`${this.url}-${JSON.stringify(this.fieldMap)}`}getSymbolFields(){return this._loader.getSymbolFields()}};d([p({type:c9})],zc.prototype,"_loader",null),d([p({type:Object,json:{read:{source:"configuration"},write:{target:"configuration"}}})],zc.prototype,"config",void 0),d([p({type:Object,json:{write:!0}})],zc.prototype,"fieldMap",void 0),d([p({type:String,json:{read:{source:"scalingExpressionInfo.expression"},write:!0}})],zc.prototype,"scaleExpression",void 0),d([ge("scaleExpression")],zc.prototype,"writeData",null),d([p({type:String,json:{read:{source:"scalingExpressionInfo.title"},write:{target:"scalingExpressionInfo.title",overridePolicy(t){return{enabled:!!t&&!!this.scaleExpression}}}}})],zc.prototype,"scaleExpressionTitle",void 0),d([p({type:String,json:{write:!0}})],zc.prototype,"url",void 0),d([ge("visualVariables")],zc.prototype,"writeVisualVariables",null),zc=TV=d([A("esri.renderers.DictionaryRenderer")],zc);const S4e=zc;var CV;let wh=CV=class extends te{constructor(t){super(t),this.color=null,this.field=null,this.label=null,this.valueExpression=null,this.valueExpressionTitle=null}castField(t){return t==null?t:typeof t=="function"?(ie.getLogger(this).error(".field: field must be a string value"),null):eC(t)}getAttributeHash(){return`${this.field}-${this.valueExpression}`}clone(){return new CV({color:this.color&&this.color.clone(),field:this.field,label:this.label,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle})}};d([p({type:ce,json:{type:[Number],write:!0}})],wh.prototype,"color",void 0),d([p({type:String,json:{write:!0}})],wh.prototype,"field",void 0),d([tt("field")],wh.prototype,"castField",null),d([p({type:String,json:{write:!0}})],wh.prototype,"label",void 0),d([p({type:String,json:{write:!0}})],wh.prototype,"valueExpression",void 0),d([p({type:String,json:{write:!0}})],wh.prototype,"valueExpressionTitle",void 0),wh=CV=d([A("esri.renderers.support.AttributeColorInfo")],wh);const lhe=wh;var EV;let _A=EV=class extends te{constructor(){super(...arguments),this.unit=null}clone(){return new EV({unit:this.unit})}};d([p({type:String,json:{write:!0}})],_A.prototype,"unit",void 0),_A=EV=d([A("esri.renderers.support.DotDensityLegendOptions")],_A);const I4e=_A;var MV;let ra=MV=class extends Cg($p){constructor(t){super(t),this.attributes=null,this.backgroundColor=new ce([0,0,0,0]),this.dotBlendingEnabled=!0,this.dotShape="square",this.dotSize=1,this.legendOptions=null,this.outline=new Yn,this.dotValue=null,this.referenceScale=null,this.seed=1,this.type="dot-density"}calculateDotValue(t){if(this.referenceScale==null)return this.dotValue;const e=t/this.referenceScale*this.dotValue;return e<1?1:e}getSymbol(){return new hc({outline:this.outline})}async getSymbolAsync(){return this.getSymbol()}getSymbols(){return[this.getSymbol()]}getAttributeHash(){var t;return((t=this.attributes)==null?void 0:t.reduce((e,i)=>e+i.getAttributeHash(),""))??""}getMeshHash(){return JSON.stringify(this.outline)}clone(){return new MV({attributes:U(this.attributes),backgroundColor:U(this.backgroundColor),dotBlendingEnabled:U(this.dotBlendingEnabled),dotShape:U(this.dotShape),dotSize:U(this.dotSize),dotValue:U(this.dotValue),legendOptions:U(this.legendOptions),outline:U(this.outline),referenceScale:U(this.referenceScale),visualVariables:U(this.visualVariables),authoringInfo:this.authoringInfo&&this.authoringInfo.clone()})}getControllerHash(){var e;return`${(e=this.attributes)==null?void 0:e.map(i=>i.field||i.valueExpression||"")}-${this.outline&&JSON.stringify(this.outline.toJSON())||""}`}async collectRequiredFields(t,e){await this.collectVVRequiredFields(t,e);for(const i of this.attributes??[])i.valueExpression&&await jo(t,e,i.valueExpression),i.field&&t.add(i.field)}};d([p({type:[lhe],json:{write:!0}})],ra.prototype,"attributes",void 0),d([p({type:ce,json:{write:!0}})],ra.prototype,"backgroundColor",void 0),d([p({type:Boolean,json:{write:!0}})],ra.prototype,"dotBlendingEnabled",void 0),d([p({type:String,json:{write:!1}})],ra.prototype,"dotShape",void 0),d([p({type:Number,json:{write:!0}})],ra.prototype,"dotSize",void 0),d([p({type:I4e,json:{write:!0}})],ra.prototype,"legendOptions",void 0),d([p({type:Yn,json:{default:null,write:!0}})],ra.prototype,"outline",void 0),d([p({type:Number,json:{write:!0}})],ra.prototype,"dotValue",void 0),d([p({type:Number,json:{write:!0}})],ra.prototype,"referenceScale",void 0),d([p({type:Number,json:{write:!0}})],ra.prototype,"seed",void 0),d([xe({dotDensity:"dot-density"})],ra.prototype,"type",void 0),ra=MV=d([A("esri.renderers.DotDensityRenderer")],ra);const T4e=ra;var $V;let QS=$V=class extends te{constructor(t){super(t),this.color=null,this.ratio=null}clone(){return new $V({color:this.color,ratio:this.ratio})}};d([p({type:ce,json:{type:[wt],default:null,write:!0}})],QS.prototype,"color",void 0),d([p({type:Number,json:{write:!0}})],QS.prototype,"ratio",void 0),QS=$V=d([A("esri.renderers.support.HeatmapColorStop")],QS);const nI=QS;let yb=class extends Li(te){constructor(){super(...arguments),this.minLabel=null,this.maxLabel=null,this.title=null}};d([p({type:String,json:{write:!0}})],yb.prototype,"minLabel",void 0),d([p({type:String,json:{write:!0}})],yb.prototype,"maxLabel",void 0),d([p({type:String,json:{write:!0}})],yb.prototype,"title",void 0),yb=d([A("esri.renderers.support.HeatmapLegendOptions")],yb);function hg(){return[0,0,0,0]}function C4e(t){return[t[0],t[1],t[2],t[3]]}function Eg(t,e,i,r){return[t,e,i,r]}function che(t){const e=hg(),i=Math.min(4,t.length);for(let r=0;r<i;++r)e[r]=t[r];return e}function uhe(t,e){return new Float64Array(t,e,4)}function dhe(){return hg()}function hhe(){return Eg(1,1,1,1)}function phe(){return Eg(1,0,0,0)}function fhe(){return Eg(0,1,0,0)}function mhe(){return Eg(0,0,1,0)}function ghe(){return Eg(0,0,0,1)}const E4e=dhe(),M4e=hhe(),$4e=phe(),A4e=fhe(),k4e=mhe(),P4e=ghe();Object.freeze(Object.defineProperty({__proto__:null,ONES:M4e,UNIT_W:P4e,UNIT_X:$4e,UNIT_Y:A4e,UNIT_Z:k4e,ZEROS:E4e,clone:C4e,create:hg,createView:uhe,fromArray:che,fromValues:Eg,ones:hhe,unitW:ghe,unitX:phe,unitY:fhe,unitZ:mhe,zeros:dhe},Symbol.toStringTag,{value:"Module"}));const u9=2.4;function O4e(t){return wa(t*u9)}function L4e(t){return or(t)/u9}function R4e(t,e,i,r){let{color:n,ratio:s}=e,{color:o,ratio:a}=i;a===s&&(a===1?s-=1e-6:a+=1e-6);const l=Pn((r-s)/(a-s),0,1);AB(t,n.toArray(),o.toArray(),l)}function kbt(t){const i=new Uint8ClampedArray(2048);if(t=t.filter(({ratio:a})=>a>=0&&a<=1).sort((a,l)=>a.ratio-l.ratio).map(({color:a,ratio:l})=>({color:a,ratio:Math.max(l,.001)})),t.length<1)return i;let r=t[0],n=t[0],s=1;const o=hg();for(let a=0;a<512;a++){const l=(a+.5)/512;for(;l>n.ratio&&s<t.length;)r=n,n=t[s++];R4e(o,r,n,l),i.set(o,4*a)}return i}function Pbt(t,e,i,r){const{radius:n,fieldOffset:s,field:o}=e,a=Math.round(or(n)),l=new Float64Array(i*r);let c,u=Number.NEGATIVE_INFINITY;const h=N4e(o,s),f=new Set;for(const m of t){const g=m.getCursor();for(;g.next();){const y=g.getObjectId();if(f.has(y))continue;f.add(y);const v=g.readLegacyPointGeometry(),b=128;if(v.x<-b||v.x>=i+b||v.y<-b||v.y>r+b)continue;const w=+h(g),x=Math.max(0,Math.round(v.x)-a),S=Math.max(0,Math.round(v.y)-a),I=Math.min(r,Math.round(v.y)+a),T=Math.min(i,Math.round(v.x)+a);for(let C=S;C<I;C++)for(let E=x;E<T;E++){const $=C*i+E,P=D4e(v.x-E,v.y-C,a);c=l[$]+=P*w,c>u&&(u=c)}}}return{matrix:l.buffer,max:u}}function Obt(t,e,i,r,n,s){t.canvas.width=t.canvas.height=e,t.clearRect(0,0,e,e);const o=t.getImageData(0,0,e,e);i&&r&&o.data.set(new Uint8ClampedArray(F4e(e,i,r,n,s))),t.putImageData(o,0,0)}function F4e(t,e,i,r,n){const s=new Uint32Array(t*t),o="buffer"in e?e:new Float64Array(e),a="buffer"in i?new Uint32Array(i.buffer):new Uint32Array(new Uint8Array(i).buffer),l=a.length/(n-r);for(let c=0;c<o.length;c++){const u=o[c],h=Math.floor((u-r)*l);s[c]=a[Pn(h,0,a.length-1)]}return s.buffer}function D4e(t,e,i){const r=Math.sqrt(t**2+e**2)/i;return r>1?0:3/(Math.PI*i**2)*(1-r**2)**2}function Lbt(t,e){return typeof t=="function"?t:t?typeof e=="string"?i=>-1*+i[t]:i=>+i[t]+e:()=>1}function N4e(t,e){return t!=null?typeof e=="string"?i=>-1*+i.readAttribute(t):i=>+i.readAttribute(t)+e:i=>1}var AV;const yhe="esri.renderers.HeatmapRenderer",V4e=ie.getLogger(yhe);function uZ(t){if(t!=null){const{maxDensity:e,minDensity:i,radius:r}=t;if(e!=null||i!=null||r!=null){const{blurRadius:n,maxPixelIntensity:s,minPixelIntensity:o,...a}=t;return a}}return t}let Bn=AV=class extends $p{constructor(t){super(t),this.authoringInfo=null,this.colorStops=[new nI({ratio:0,color:new ce("rgba(255, 140, 0, 0)")}),new nI({ratio:.75,color:new ce("rgba(255, 140, 0, 1)")}),new nI({ratio:.9,color:new ce("rgba(255, 0,   0, 1)")})],this.field=null,this.fieldOffset=0,this.legendOptions=null,this.maxDensity=.04,this.minDensity=0,this.radius=18,this.referenceScale=0,this.type="heatmap",this.valueExpression=null,this.valueExpressionTitle=null,this._warnedProps={blurRadius:!1,maxPixelIntensity:!1,minPixelIntensity:!1}}normalizeCtorArgs(t){return uZ(t)}get blurRadius(){return L4e(this.radius)}set blurRadius(t){const e=this.maxPixelIntensity,i=this.minPixelIntensity;this._set("radius",O4e(t)),this._warnAboutDeprecatedGaussianBlurProp("blurRadius","radius"),this._set("maxDensity",e*this._pixelIntensityToDensity),this._set("minDensity",i*this._pixelIntensityToDensity)}get maxPixelIntensity(){return this.maxDensity/this._pixelIntensityToDensity}set maxPixelIntensity(t){this._set("maxDensity",t*this._pixelIntensityToDensity),this._warnAboutDeprecatedGaussianBlurProp("maxPixelIntensity","maxDensity")}get minPixelIntensity(){return this.minDensity/this._pixelIntensityToDensity}set minPixelIntensity(t){this._set("minDensity",t*this._pixelIntensityToDensity),this._warnAboutDeprecatedGaussianBlurProp("minPixelIntensity","minDensity")}get _pixelIntensityToDensity(){return 24/(u9**2*this.blurRadius**4)}_warnAboutDeprecatedGaussianBlurProp(t,e){this._warnedProps[t]||Vo(this).getDefaultOrigin()==="user"&&(this._warnedProps[t]=!0,O1(()=>{el(V4e,t,{replacement:`${String(e)} (suggested value: ${this._get(e)})`,version:"4.24"})}))}read(t,e){t=uZ(t),super.read(t,e)}getSymbol(){return new ms}async getSymbolAsync(){return this.getSymbol()}getSymbols(){return[this.getSymbol()]}async collectRequiredFields(t,e){const i=this.field,r=this.valueExpression;i&&typeof i=="string"&&await rl(t,e,i),r&&typeof r=="string"&&await jo(t,e,r)}getAttributeHash(){return null}getMeshHash(){return`${JSON.stringify(this.colorStops)}.${this.blurRadius}.${this.field}`}clone(){return new AV({authoringInfo:this.authoringInfo&&this.authoringInfo.clone(),colorStops:U(this.colorStops),field:this.field,legendOptions:U(this.legendOptions),maxDensity:this.maxDensity,minDensity:this.minDensity,radius:this.radius,referenceScale:this.referenceScale,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle})}};d([p({type:EC,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],Bn.prototype,"authoringInfo",void 0),d([p({type:Number,json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],Bn.prototype,"blurRadius",null),d([p({type:[nI],json:{write:!0}})],Bn.prototype,"colorStops",void 0),d([p({type:String,json:{write:!0}})],Bn.prototype,"field",void 0),d([p({type:Number,json:{write:{overridePolicy:(t,e,i)=>({enabled:i==null})},origins:{"web-scene":{write:!1}}}})],Bn.prototype,"fieldOffset",void 0),d([p({type:yb,json:{write:!0}})],Bn.prototype,"legendOptions",void 0),d([p({type:Number,json:{write:!0}})],Bn.prototype,"maxDensity",void 0),d([p({type:Number,json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],Bn.prototype,"maxPixelIntensity",null),d([p({type:Number,json:{write:!0}})],Bn.prototype,"minDensity",void 0),d([p({type:Number,json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],Bn.prototype,"minPixelIntensity",null),d([p({type:Number,cast:$t,json:{write:!0}})],Bn.prototype,"radius",void 0),d([p({type:Number,range:{min:0},json:{default:0,write:!0}})],Bn.prototype,"referenceScale",void 0),d([xe({heatmap:"heatmap"})],Bn.prototype,"type",void 0),d([p({type:String,json:{write:!0,origins:{"web-document":{write:!1},"portal-item":{write:!1}}}})],Bn.prototype,"valueExpression",void 0),d([p({type:String})],Bn.prototype,"valueExpressionTitle",void 0),d([p({readOnly:!0})],Bn.prototype,"_pixelIntensityToDensity",null),Bn=AV=d([A(yhe)],Bn);const vhe=Bn;let k0=class extends Li(te){constructor(){super(...arguments),this.color=new ce([0,0,0,0]),this.label=null,this.threshold=0}};d([p({type:ce,json:{write:!0}})],k0.prototype,"color",void 0),d([p({type:String,json:{write:!0}})],k0.prototype,"label",void 0),d([p({type:Number,range:{min:0,max:1},json:{write:!0}})],k0.prototype,"threshold",void 0),k0=d([A("esri.renderers.support.OthersCategory")],k0);let bA=class extends Li(te){constructor(){super(...arguments),this.title=null}};d([p({type:String,json:{write:!0}})],bA.prototype,"title",void 0),bA=d([A("esri.renderers.support.PieChartLegendOptions")],bA);let La=class extends Cg(Li($p)){constructor(e){super(e),this.attributes=null,this.backgroundFillSymbol=null,this.defaultColor=new ce([0,0,0,0]),this.defaultLabel=null,this.holePercentage=0,this.othersCategory=new k0,this.legendOptions=null,this.outline=null,this.size=12,this.type="pie-chart"}getSymbol(){var e;return new ms({size:this.size?this.size/2+(((e=this.outline)==null?void 0:e.width)||0):0})}async getSymbolAsync(){return this.getSymbol()}getSymbols(){return[this.getSymbol(),this.backgroundFillSymbol].filter(Dt)}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce((e,i)=>e+i.getAttributeHash(),"")}getMeshHash(){return this.getSymbols().reduce((e,i)=>e+JSON.stringify(i),"")}async collectRequiredFields(e,i){await this.collectVVRequiredFields(e,i);for(const r of this.attributes)r.valueExpression&&await jo(e,i,r.valueExpression),r.field&&e.add(r.field)}};d([p({type:[lhe],json:{write:!0}})],La.prototype,"attributes",void 0),d([p({type:hc,json:{default:null,write:!0}})],La.prototype,"backgroundFillSymbol",void 0),d([p({type:ce,json:{write:!0}})],La.prototype,"defaultColor",void 0),d([p({type:String,json:{write:!0}})],La.prototype,"defaultLabel",void 0),d([p({type:Number,range:{min:0,max:1},json:{write:!0}})],La.prototype,"holePercentage",void 0),d([p({type:k0,json:{write:!0}})],La.prototype,"othersCategory",void 0),d([p({type:bA,json:{write:!0}})],La.prototype,"legendOptions",void 0),d([p({type:Yn,json:{default:null,write:!0}})],La.prototype,"outline",void 0),d([p({type:Number,cast:$t,json:{write:!0}})],La.prototype,"size",void 0),d([xe({pieChart:"pie-chart"})],La.prototype,"type",void 0),La=d([A("esri.renderers.PieChartRenderer")],La);const z4e=La;var kV;let Ly=kV=class extends Cg($p){constructor(t){super(t),this.description=null,this.label=null,this.symbol=null,this.type="simple"}async collectRequiredFields(t,e){await Promise.all([this.collectSymbolFields(t,e),this.collectVVRequiredFields(t,e)])}async collectSymbolFields(t,e){await Promise.all(this.getSymbols().map(i=>i.collectRequiredFields(t,e)))}getSymbol(t,e){return this.symbol}async getSymbolAsync(t,e){return this.symbol}getSymbols(){return this.symbol?[this.symbol]:[]}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce((t,e)=>t+e.getAttributeHash(),"")}getMeshHash(){return this.getSymbols().reduce((t,e)=>t+JSON.stringify(e),"")}get arcadeRequired(){return this.arcadeRequiredForVisualVariables}clone(){return new kV({description:this.description,label:this.label,symbol:this.symbol&&this.symbol.clone(),visualVariables:U(this.visualVariables),authoringInfo:this.authoringInfo&&this.authoringInfo.clone()})}};d([p({type:String,json:{write:!0}})],Ly.prototype,"description",void 0),d([p({type:String,json:{write:!0}})],Ly.prototype,"label",void 0),d([p(Q1)],Ly.prototype,"symbol",void 0),d([xe({simple:"simple"})],Ly.prototype,"type",void 0),Ly=kV=d([A("esri.renderers.SimpleRenderer")],Ly);const RL=Ly,j4e=["esri.Color","esri.portal.Portal","esri.symbols.support.Symbol3DAnchorPosition2D","esri.symbols.support.Symbol3DAnchorPosition3D"];function PV(t){return t instanceof he}function dZ(t){return t instanceof ye?Object.keys(t.items):PV(t)?Vo(t).keys():t?Object.keys(t):[]}function XE(t,e){return t instanceof ye?t.items[e]:t[e]}function B4e(t,e){return!(!Array.isArray(t)||!Array.isArray(e))&&t.length!==e.length}function sI(t){return t?t.declaredClass:null}function _he(t,e){var h;const i=t.diff;if(i&&typeof i=="function")return i(t,e);const r=dZ(t),n=dZ(e);if(r.length===0&&n.length===0)return;if(!r.length||!n.length||B4e(t,e))return{type:"complete",oldValue:t,newValue:e};const s=n.filter(f=>!r.includes(f)),o=r.filter(f=>!n.includes(f)),a=r.filter(f=>n.includes(f)&&XE(t,f)!==XE(e,f)).concat(s,o).sort(),l=sI(t);if(l&&j4e.includes(l)&&a.length)return{type:"complete",oldValue:t,newValue:e};let c;const u=PV(t)&&PV(e);for(const f of a){const m=XE(t,f),g=XE(e,f);let y;if((u||typeof m!="function"&&typeof g!="function")&&m!==g&&(m!=null||g!=null)){if(i&&i[f]&&typeof i[f]=="function")y=(h=i[f])==null?void 0:h.call(i,m,g);else if(m instanceof Date&&g instanceof Date){if(m.getTime()===g.getTime())continue;y={type:"complete",oldValue:m,newValue:g}}else y=typeof m=="object"&&typeof g=="object"&&sI(m)===sI(g)?_he(m,g):{type:"complete",oldValue:m,newValue:g};y!=null&&(c!=null?c.diff[f]=y:c={type:"partial",diff:{[f]:y}})}}return c}function U4e(t,e){if(t==null)return!1;const i=e.split(".");let r=t;for(const n of i){if(r.type==="complete")return!0;if(r.type!=="partial")return!1;{const s=r.diff[n];if(!s)return!1;r=s}}return!0}function Nbt(t,e){for(const i of e)if(U4e(t,i))return!0;return!1}function bhe(t,e){if(typeof t!="function"&&typeof e!="function"&&(t!=null||e!=null))return t==null||e==null||typeof t=="object"&&typeof e=="object"&&sI(t)!==sI(e)?{type:"complete",oldValue:t,newValue:e}:_he(t,e)}function QE(t){if(t==null)return!0;switch(t.type){case"complete":return!1;case"collection":{const e=t;for(const i of e.added)if(!QE(i))return!1;for(const i of e.removed)if(!QE(i))return!1;for(const i of e.changed)if(!QE(i))return!1;return!0}case"partial":for(const e in t.diff)if(!QE(t.diff[e]))return!1;return!0}}let vb=class extends Li(te){constructor(e){super(e),this.value=null,this.value2=null,this.value3=null}};d([p(gA)],vb.prototype,"value",void 0),d([p(gA)],vb.prototype,"value2",void 0),d([p(gA)],vb.prototype,"value3",void 0),vb=d([A("esri.renderers.support.UniqueValue")],vb);const kw=vb;let kf=class extends Li(te){constructor(e){super(e),this.description=null,this.label=null,this.symbol=null,this.values=null}castValues(e){if(e==null)return null;const i=typeof(e=Array.isArray(e)?e:[e])[0];return i==="string"||i==="number"?e.map(r=>new kw({value:r})):i==="object"?e[0]instanceof kw?e:e.map(r=>new kw(r)):null}};d([p({type:String,json:{write:!0}})],kf.prototype,"description",void 0),d([p({type:String,json:{write:!0}})],kf.prototype,"label",void 0),d([p(Q1)],kf.prototype,"symbol",void 0),d([p({type:[kw],json:{type:[[String]],read:{reader:t=>t?t.map(e=>new kw({value:e[0],value2:e[1],value3:e[2]})):null},write:{writer:(t,e)=>{const i=[];for(const r of t){const n=[r.value,r.value2,r.value3].filter(Dt).map(s=>s.toString());i.push(n)}e.values=i}}}})],kf.prototype,"values",void 0),d([tt("values")],kf.prototype,"castValues",null),kf=d([A("esri.renderers.support.UniqueValueClass")],kf);const whe=kf;let e2=class extends Li(te){constructor(e){super(e),this.heading=null,this.classes=null}};d([p({type:String,json:{write:!0}})],e2.prototype,"heading",void 0),d([p({type:[whe],json:{write:!0}})],e2.prototype,"classes",void 0),e2=d([A("esri.renderers.support.UniqueValueGroup")],e2);const OV=e2;var LV;let Ry=LV=class extends te{constructor(t){super(t),this.description=null,this.label=null,this.symbol=null,this.value=null}clone(){return new LV({value:this.value,description:this.description,label:this.label,symbol:this.symbol?this.symbol.clone():null})}getMeshHash(){const t=JSON.stringify(this.symbol&&this.symbol.toJSON());return`${this.value}.${t}`}};d([p({type:String,json:{write:!0}})],Ry.prototype,"description",void 0),d([p({type:String,json:{write:!0}})],Ry.prototype,"label",void 0),d([p(Q1)],Ry.prototype,"symbol",void 0),d([p(gA)],Ry.prototype,"value",void 0),Ry=LV=d([A("esri.renderers.support.UniqueValueInfo")],Ry);const cv=Ry,G4e=()=>!!ee("enable-feature:force-wosr"),H4e=()=>ee.add("enable-feature:direct-3d-object-feature-layer-display",!0,!0,!0),q4e=()=>ee.add("enable-feature:direct-3d-object-feature-layer-display",!1,!0,!0),d9=()=>!!ee("enable-i3s-patching"),W4e=()=>ee.add("enable-i3s-patching",!0,!0,!0),J4e=()=>ee.add("enable-i3s-patching",!1,!0,!0),h9=()=>!!ee("enable-feature:SceneLayer-editing"),Z4e=(t="i3s-patching")=>{switch(J4e(),q4e(),ee.add("enable-feature:SceneLayer-editing",!0,!0,!0),t){case"feature-layer-view":H4e();break;case"i3s-patching":W4e()}};Z4e("i3s-patching");let l5={};async function Y4e(t,e){try{return{data:(await p9(t,e)).data,baseUrl:oB(t),styleUrl:t}}catch(i){return Lo(i),null}}function K4e(t,e,i){const r=e.portal!=null?e.portal:on.getDefault();let n;const s=`${r.url} - ${r.user&&r.user.username} - ${t}`;return l5[s]||(l5[s]=X4e(t,r,i).then(o=>(n=o,o.fetchData())).then(o=>({data:o,baseUrl:n.itemUrl??"",styleName:t}))),l5[s]}function X4e(t,e,i){return e.load(i).then(()=>{const r=new xd({disableExtraQuery:!0,query:`owner:${hZ} AND type:${pZ} AND typekeywords:"${t}"`});return e.queryItems(r,i)}).then(({results:r})=>{var o;let n=null;const s=t.toLowerCase();if(r&&Array.isArray(r)){for(const a of r)if(((o=a.typeKeywords)==null?void 0:o.some(c=>c.toLowerCase()===s))&&a.type===pZ&&a.owner===hZ){n=a;break}}if(!n)throw new N("symbolstyleutils:style-not-found",`The style '${t}' could not be found`,{styleName:t});return n.load(i)})}function xhe(t,e,i){return t&&t.styleUrl!=null?Y4e(t.styleUrl,i):t&&t.styleName!=null?K4e(t.styleName,e,i):Promise.reject(new N("symbolstyleutils:style-url-and-name-missing","Either styleUrl or styleName is required to resolve a style"))}function She(t){return t===null||t.type==="CIMSymbolReference"?t:{type:"CIMSymbolReference",symbol:t}}function Q4e(t,e,i=["gltf"]){if(e==="cimRef")return t.cimRef;if(t.formatInfos&&!G4e())for(const r of i){const n=t.formatInfos.find(s=>s.type===r);if(n)return n.href}return t.webRef}function p9(t,e){const i={responseType:"json",query:{f:"json"},...e};return at(ic(t),i)}const hZ="esri_en",pZ="Style",eVe="https://cdn.arcgis.com/sharing/rest/content/items/220936cc6ed342c9937abd8f180e7d1e/resources/styles/cim/{SymbolName}.json?f=json";var t2;const Ihe="esri.renderers.UniqueValueRenderer",rf=ie.getLogger(Ihe),fZ="uvInfos-watcher",mZ="uvGroups-watcher",tVe=",",iVe=lr(cv);function rVe(t){const{field1:e,field2:i,field3:r,fieldDelimiter:n,uniqueValueInfos:s,valueExpression:o}=t,a=!(!e||!i);return[{classes:(s??[]).map(l=>{var b;const{symbol:c,label:u,value:h,description:f}=l,[m,g,y]=a?((b=h==null?void 0:h.toString())==null?void 0:b.split(n||""))||[]:[h],v=[];return(e||o)&&v.push(m),i&&v.push(g),r&&v.push(y),{symbol:c,label:u,values:[v],description:f}})}]}let rr=t2=class extends Cg($p){constructor(t){super(t),this._valueInfoMap={},this._isDefaultSymbolDerived=!1,this._isInfosSource=null,this.type="unique-value",this.backgroundFillSymbol=null,this.orderByClassesEnabled=!1,this.valueExpressionTitle=null,this.legendOptions=null,this.defaultLabel=null,this.portal=null,this.styleOrigin=null,this.diff={uniqueValueInfos(e,i){if(!e&&!i)return;if(!e||!i)return{type:"complete",oldValue:e,newValue:i};let r=!1;const n={type:"collection",added:[],removed:[],changed:[],unchanged:[]};for(let s=0;s<i.length;s++){const o=e.find(a=>a.value===i[s].value);o?bhe(o,i[s])?(n.changed.push({type:"complete",oldValue:o,newValue:i[s]}),r=!0):n.unchanged.push({oldValue:o,newValue:i[s]}):(n.added.push(i[s]),r=!0)}for(let s=0;s<e.length;s++)i.find(o=>o.value===e[s].value)||(n.removed.push(e[s]),r=!0);return r?n:void 0}},this._set("uniqueValueInfos",[]),this._set("uniqueValueGroups",[])}get _cache(){return{compiledFunc:null}}set field(t){this._set("field",t),this._updateFieldDelimiter(),this._updateUniqueValues()}castField(t){return t==null||typeof t=="function"?t:eC(t)}writeField(t,e,i,r){typeof t=="string"?e[i]=t:r&&r.messages?r.messages.push(new N("property:unsupported","UniqueValueRenderer.field set to a function cannot be written to JSON")):rf.error(".field: cannot write field to JSON since it's not a string value")}set field2(t){this._set("field2",t),this._updateFieldDelimiter(),this._updateUniqueValues()}set field3(t){this._set("field3",t),this._updateUniqueValues()}set valueExpression(t){this._set("valueExpression",t),this._updateUniqueValues()}set defaultSymbol(t){this._isDefaultSymbolDerived=!1,this._set("defaultSymbol",t)}set fieldDelimiter(t){this._set("fieldDelimiter",t),this._updateUniqueValues()}readPortal(t,e,i){return i.portal||on.getDefault()}readStyleOrigin(t,e,i){if(e.styleName)return Object.freeze({styleName:e.styleName});if(e.styleUrl){const r=og(e.styleUrl,i);return Object.freeze({styleUrl:r})}}writeStyleOrigin(t,e,i,r){t.styleName?e.styleName=t.styleName:t.styleUrl&&(e.styleUrl=gC(t.styleUrl,r))}set uniqueValueGroups(t){this.styleOrigin?rf.error("#uniqueValueGroups=","Cannot modify unique value groups of a UniqueValueRenderer created from a web style"):(this._set("uniqueValueGroups",t),this._updateInfosFromGroups(),this._isInfosSource=!1,this._watchUniqueValueGroups())}set uniqueValueInfos(t){this.styleOrigin?rf.error("#uniqueValueInfos=","Cannot modify unique value infos of a UniqueValueRenderer created from a web style"):(this._set("uniqueValueInfos",t),this._updateValueInfoMap(),this._updateGroupsFromInfos(),this._isInfosSource=!0,this._watchUniqueValueInfos())}addUniqueValueInfo(t,e){var r;if(this.styleOrigin)return void rf.error("#addUniqueValueInfo()","Cannot modify unique value infos of a UniqueValueRenderer created from a web style");let i;i=typeof t=="object"?iVe(t):new cv({value:t,symbol:Cle(e)}),(r=this.uniqueValueInfos)==null||r.push(i),this._valueInfoMap[i.value]=i,this._updateGroupsFromInfos(),this._isInfosSource=!0,this._watchUniqueValueInfos()}removeUniqueValueInfo(t){if(this.styleOrigin)return void rf.error("#removeUniqueValueInfo()","Cannot modify unique value infos of a UniqueValueRenderer created from a web style");const e=this.uniqueValueInfos;if(e){for(let i=0;i<e.length;i++)if(e[i].value===t+""){delete this._valueInfoMap[t],e.splice(i,1);break}}this._updateGroupsFromInfos(),this._isInfosSource=!0,this._watchUniqueValueInfos()}async getUniqueValueInfo(t,e){let i=e;return!this.valueExpression||e!=null&&e.arcade!=null||(i={...i,arcade:await zd()}),this._getUniqueValueInfo(t,i)}getSymbol(t,e){if(this.valueExpression&&(e==null||e.arcade==null))return void rf.error("#getSymbol()","Please use getSymbolAsync if valueExpression is used");const i=this._getUniqueValueInfo(t,e);return i&&i.symbol||this.defaultSymbol}async getSymbolAsync(t,e){let i=e;if(this.valueExpression&&(i==null||i.arcade==null)){const n=await zd(),{arcadeUtils:s}=n;s.hasGeometryOperations(this.valueExpression)&&await s.enableGeometryOperations(),i={...i,arcade:n}}const r=this._getUniqueValueInfo(t,i);return r&&r.symbol||this.defaultSymbol}getSymbols(){const t=[];for(const e of this.uniqueValueInfos??[])e.symbol&&t.push(e.symbol);return this.defaultSymbol&&t.push(this.defaultSymbol),t}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce((t,e)=>t+e.getAttributeHash(),"")}getMeshHash(){var r;const t=JSON.stringify(this.backgroundFillSymbol),e=JSON.stringify(this.defaultSymbol),i=(r=this.uniqueValueInfos)==null?void 0:r.reduce((n,s)=>n+s.getMeshHash(),"");return`${t}.${e}.${i}.${`${this.field}.${this.field2}.${this.field3}.${this.fieldDelimiter}`}.${this.valueExpression}`}clone(){const t=new t2({field:this.field,field2:this.field2,field3:this.field3,defaultLabel:this.defaultLabel,defaultSymbol:U(this.defaultSymbol),orderByClassesEnabled:this.orderByClassesEnabled,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,fieldDelimiter:this.fieldDelimiter,visualVariables:U(this.visualVariables),legendOptions:U(this.legendOptions),authoringInfo:this.authoringInfo&&this.authoringInfo.clone(),backgroundFillSymbol:U(this.backgroundFillSymbol)});this._isDefaultSymbolDerived&&(t._isDefaultSymbolDerived=!0),t._set("portal",this.portal);const e=U(this.uniqueValueInfos),i=U(this.uniqueValueGroups);return this.styleOrigin&&(t._set("styleOrigin",Object.freeze(U(this.styleOrigin))),Object.freeze(e),Object.freeze(i)),t._set("uniqueValueInfos",e),t._updateValueInfoMap(),t._set("uniqueValueGroups",i),t._isInfosSource=this._isInfosSource,t._watchUniqueValueInfosAndGroups(),t}get arcadeRequired(){return this.arcadeRequiredForVisualVariables||!!this.valueExpression}async collectRequiredFields(t,e){const i=[this.collectVVRequiredFields(t,e),this.collectSymbolFields(t,e)];await Promise.all(i)}async collectSymbolFields(t,e){const i=[...this.getSymbols().map(r=>r.collectRequiredFields(t,e)),jo(t,e,this.valueExpression)];rl(t,e,this.field),rl(t,e,this.field2),rl(t,e,this.field3),await Promise.all(i)}populateFromStyle(){return xhe(this.styleOrigin,{portal:this.portal}).then(t=>{var i;const e=[];return this._valueInfoMap={},t&&t.data&&Array.isArray(t.data.items)&&t.data.items.forEach(r=>{const n=new Hv({styleUrl:t.styleUrl,styleName:t.styleName,portal:this.portal,name:r.name});this.defaultSymbol||r.name!==t.data.defaultItem||(this.defaultSymbol=n,this._isDefaultSymbolDerived=!0);const s=new cv({value:r.name,symbol:n});e.push(s),this._valueInfoMap[r.name]=s}),this._set("uniqueValueInfos",Object.freeze(e)),this._updateGroupsFromInfos(!0),this._isInfosSource=null,this._watchUniqueValueInfos(),!this.defaultSymbol&&((i=this.uniqueValueInfos)!=null&&i.length)&&(this.defaultSymbol=this.uniqueValueInfos[0].symbol,this._isDefaultSymbolDerived=!0),this})}_updateFieldDelimiter(){this.field&&this.field2&&!this.fieldDelimiter&&this._set("fieldDelimiter",tVe)}_updateUniqueValues(){this._isInfosSource!=null&&(this._isInfosSource?this._updateGroupsFromInfos():this._updateInfosFromGroups())}_updateValueInfoMap(){this._valueInfoMap={};const{uniqueValueInfos:t}=this;if(t)for(const e of t)this._valueInfoMap[e.value+""]=e}_watchUniqueValueInfosAndGroups(){this._watchUniqueValueInfos(),this._watchUniqueValueGroups()}_watchUniqueValueInfos(){this.removeHandles(fZ);const{uniqueValueInfos:t}=this;if(t){const e=[];for(const i of t)e.push(J(()=>({symbol:i.symbol,value:i.value,label:i.label,description:i.description}),(r,n)=>{r!==n&&(this._updateGroupsFromInfos(),this._isInfosSource=!0)},{sync:!0}));this.addHandles(e,fZ)}}_watchUniqueValueGroups(){this.removeHandles(mZ);const{uniqueValueGroups:t}=this;if(t){const e=[];for(const i of t){e.push(J(()=>({classes:i.classes}),(r,n)=>{r!==n&&(this._updateInfosFromGroups(),this._isInfosSource=!1)},{sync:!0}));for(const r of i.classes??[])e.push(J(()=>({symbol:r.symbol,values:r.values,label:r.label,description:r.description}),(n,s)=>{n!==s&&(this._updateInfosFromGroups(),this._isInfosSource=!1)},{sync:!0}))}this.addHandles(e,mZ)}}_updateInfosFromGroups(){if(!this.uniqueValueGroups)return this._set("uniqueValueInfos",null),this._updateValueInfoMap(),void this._watchUniqueValueInfos();const t=[],{field:e,field2:i,field3:r,fieldDelimiter:n,uniqueValueGroups:s,valueExpression:o}=this;if(!e&&!o)return this._set("uniqueValueInfos",t),this._updateValueInfoMap(),void this._watchUniqueValueInfos();const a=!(!e||!i);for(const l of s)for(const c of l.classes??[]){const{symbol:u,label:h,values:f,description:m}=c;for(const g of f??[]){const{value:y,value2:v,value3:b}=g,w=[y];i&&w.push(v),r&&w.push(b);const x=a?w.join(n||""):w[0];t.push(new cv({symbol:u,label:h,value:x,description:m}))}}this._set("uniqueValueInfos",t),this._updateValueInfoMap(),this._watchUniqueValueInfos()}_updateGroupsFromInfos(t=!1){if(!this.uniqueValueInfos)return this._set("uniqueValueGroups",null),void this._watchUniqueValueGroups();const{field:e,field2:i,valueExpression:r,fieldDelimiter:n,uniqueValueInfos:s}=this;if(!e&&!r||!s.length)return this._set("uniqueValueGroups",[]),void this._watchUniqueValueGroups();const o=!(!e||!i),a=s.map(c=>{var b;const{symbol:u,label:h,value:f,description:m}=c,[g,y,v]=o?((b=f==null?void 0:f.toString())==null?void 0:b.split(n||""))||[]:[f];return new whe({symbol:u,label:h,description:m,values:[new kw({value:g,value2:y,value3:v})]})}),l=[new OV({classes:a})];t&&Object.freeze(l),this._set("uniqueValueGroups",l),this._watchUniqueValueGroups()}_getUniqueValueInfo(t,e){return this.valueExpression?this._getUnqiueValueInfoForExpression(t,e):this._getUnqiueValueInfoForFields(t)}_getUnqiueValueInfoForExpression(t,e){const{viewingMode:i,scale:r,spatialReference:n,arcade:s}=e??{};let o=this._cache.compiledFunc;const a=s.arcadeUtils;if(!o){const c=a.createSyntaxTree(this.valueExpression);o=a.createFunction(c),this._cache.compiledFunc=o}const l=a.executeFunction(o,a.createExecContext(t,a.getViewInfo({viewingMode:i,scale:r,spatialReference:n})));return this._valueInfoMap[l+""]}_getUnqiueValueInfoForFields(t){const e=this.field,i=t.attributes;let r;if(typeof e!="function"&&this.field2){const n=this.field2,s=this.field3,o=[];e&&o.push(i[e]),n&&o.push(i[n]),s&&o.push(i[s]),r=o.join(this.fieldDelimiter||"")}else typeof e=="function"?r=e(t):e&&(r=i[e]);return this._valueInfoMap[r+""]}static fromPortalStyle(t,e){const i=new t2(e&&e.properties);i._set("styleOrigin",Object.freeze({styleName:t})),i._set("portal",e&&e.portal||on.getDefault());const r=i.populateFromStyle();return r.catch(n=>{rf.error(`#fromPortalStyle('${t}'[, ...])`,"Failed to create unique value renderer from style name",n)}),r}static fromStyleUrl(t,e){const i=new t2(e&&e.properties);i._set("styleOrigin",Object.freeze({styleUrl:t}));const r=i.populateFromStyle();return r.catch(n=>{rf.error(`#fromStyleUrl('${t}'[, ...])`,"Failed to create unique value renderer from style URL",n)}),r}};d([p({readOnly:!0})],rr.prototype,"_cache",null),d([xe({uniqueValue:"unique-value"})],rr.prototype,"type",void 0),d([p(nhe)],rr.prototype,"backgroundFillSymbol",void 0),d([p({value:null,json:{type:String,read:{source:"field1"},write:{target:"field1"}}})],rr.prototype,"field",null),d([tt("field")],rr.prototype,"castField",null),d([ge("field")],rr.prototype,"writeField",null),d([p({type:String,value:null,json:{write:!0}})],rr.prototype,"field2",null),d([p({type:String,value:null,json:{write:!0}})],rr.prototype,"field3",null),d([p({type:Boolean,json:{name:"drawInClassOrder",default:!1,write:!0,origins:{"web-scene":{write:!1}}}})],rr.prototype,"orderByClassesEnabled",void 0),d([p({type:String,value:null,json:{write:!0}})],rr.prototype,"valueExpression",null),d([p({type:String,json:{write:!0}})],rr.prototype,"valueExpressionTitle",void 0),d([p({type:lv,json:{write:!0}})],rr.prototype,"legendOptions",void 0),d([p({type:String,json:{write:!0}})],rr.prototype,"defaultLabel",void 0),d([p(Fre({...Q1},{json:{write:{overridePolicy(){return{enabled:!this._isDefaultSymbolDerived}}},origins:{"web-scene":{write:{overridePolicy(){return{enabled:!this._isDefaultSymbolDerived}}}}}}}))],rr.prototype,"defaultSymbol",null),d([p({type:String,value:null,json:{write:!0}})],rr.prototype,"fieldDelimiter",null),d([p({type:on,readOnly:!0})],rr.prototype,"portal",void 0),d([ae("portal",["styleName"])],rr.prototype,"readPortal",null),d([p({readOnly:!0,json:{write:{enabled:!1,overridePolicy:()=>({enabled:!0})}}})],rr.prototype,"styleOrigin",void 0),d([ae("styleOrigin",["styleName","styleUrl"])],rr.prototype,"readStyleOrigin",null),d([ge("styleOrigin",{styleName:{type:String},styleUrl:{type:String}})],rr.prototype,"writeStyleOrigin",null),d([p({type:[OV],json:{read:{source:["uniqueValueGroups","uniqueValueInfos"],reader:(t,e,i)=>(e.uniqueValueGroups||rVe(e)).map(r=>OV.fromJSON(r,i))},write:{overridePolicy(){return this.styleOrigin?{enabled:!1}:{enabled:!0}}}}})],rr.prototype,"uniqueValueGroups",null),d([p({type:[cv],json:{read:!1,write:{overridePolicy(){return this.styleOrigin?{enabled:!1}:{enabled:!0}}}}})],rr.prototype,"uniqueValueInfos",null),rr=t2=d([A(Ihe)],rr);const tx=rr,kC={key:"type",base:$p,typeMap:{heatmap:vhe,simple:RL,"unique-value":tx,"class-breaks":ex,"dot-density":T4e,dictionary:S4e,"pie-chart":z4e},errorContext:"renderer"},The={key:"type",base:$p,typeMap:{simple:RL,"unique-value":tx,"class-breaks":ex,heatmap:vhe},errorContext:"renderer"};function nVe(t,e){return mT(t,null,e)}const sVe=L1({types:kC});function mT(t,e,i){return t?t&&(t.styleName||t.styleUrl)&&t.type!=="uniqueValue"?(i&&i.messages&&i.messages.push(new ol("renderer:unsupported","Only UniqueValueRenderer can be referenced from a web style, but found '"+t.type+"'",{definition:t,context:i})),null):sVe(t,e,i):null}let oVe=class Che{constructor(){this._propertyOriginMap=new Map,this._originStores=new Array(wD),this._values=new Map,this.multipleOriginsSupported=!0}clone(e){const i=new Che,r=this._originStores[Ye.DEFAULTS];r&&r.forEach((n,s)=>{i.set(s,U(n),Ye.DEFAULTS)});for(let n=Ye.SERVICE;n<wD;n++){const s=this._originStores[n];s&&s.forEach((o,a)=>{e&&e.has(a)||i.set(a,U(o),n)})}return i}get(e,i){const r=i===void 0?this._values:this._originStores[i];return r?r.get(e):void 0}keys(e){const i=e==null?this._values:this._originStores[e];return i?[...i.keys()]:[]}set(e,i,r=Ye.USER){let n=this._originStores[r];if(n||(n=new Map,this._originStores[r]=n),n.set(e,i),!this._values.has(e)||this._propertyOriginMap.get(e)<=r){const s=this._values.get(e);return this._values.set(e,i),this._propertyOriginMap.set(e,r),s!==i}return!1}delete(e,i=Ye.USER){const r=this._originStores[i];if(!r)return;const n=r.get(e);if(r.delete(e),this._values.has(e)&&this._propertyOriginMap.get(e)===i){this._values.delete(e);for(let s=i-1;s>=0;s--){const o=this._originStores[s];if(o&&o.has(e)){this._values.set(e,o.get(e)),this._propertyOriginMap.set(e,s);break}}}return n}has(e,i){const r=i===void 0?this._values:this._originStores[i];return!!r&&r.has(e)}revert(e,i){for(;i>0&&!this.has(e,i);)--i;const r=this._originStores[i],n=r&&r.get(e),s=this._values.get(e);return this._values.set(e,n),this._propertyOriginMap.set(e,i),s!==n}originOf(e){return this._propertyOriginMap.get(e)||Ye.DEFAULTS}forEach(e){this._values.forEach(e)}};const Ehe=t=>{let e=class extends t{constructor(...i){super(...i);const r=Vo(this),n=r.store,s=new oVe;r.store=s,Ane(r,n,s)}read(i,r){Pne(this,i,r)}getAtOrigin(i,r){const n=c5(this),s=Cm(r);if(typeof i=="string")return n.get(i,s);const o={};return i.forEach(a=>{o[a]=n.get(a,s)}),o}originOf(i){return Ik(this.originIdOf(i))}originIdOf(i){return c5(this).originOf(i)}revert(i,r){const n=c5(this),s=Cm(r),o=Vo(this);let a;a=typeof i=="string"?i==="*"?n.keys(s):[i]:i,a.forEach(l=>{o.invalidate(l),n.revert(l,s),o.commit(l)})}};return e=d([A("esri.core.ReadOnlyMultiOriginJSONSupport")],e),e};function c5(t){return Vo(t).store}let gZ=class extends Ehe(he){};gZ=d([A("esri.core.ReadOnlyMultiOriginJSONSupport")],gZ);const aVe=t=>{let e=class extends t{constructor(...i){super(...i)}clear(i,r="user"){return u5(this).delete(i,Cm(r))}write(i,r){return Lne(this,i=i||{},r),i}setAtOrigin(i,r,n){Vo(this).setAtOrigin(i,r,Cm(n))}removeOrigin(i){const r=u5(this),n=Cm(i),s=r.keys(n);for(const o of s)r.originOf(o)===n&&r.set(o,r.get(o,n),Ye.USER)}updateOrigin(i,r){const n=u5(this),s=Cm(r),o=this.get(i);for(let a=s+1;a<wD;++a)n.delete(i,a);n.set(i,o,s)}toJSON(i){return this.write({},i)}};return e=d([A("esri.core.WriteableMultiOriginJSONSupport")],e),e.prototype.toJSON.isDefaultToJSON=!0,e};function u5(t){return Vo(t).store}const FL=t=>{let e=class extends aVe(Ehe(t)){constructor(...i){super(...i)}};return e=d([A("esri.core.MultiOriginJSONSupport")],e),e};let yZ=class extends FL(he){};yZ=d([A("esri.core.MultiOriginJSONSupport")],yZ);const lVe={supportsStatistics:!0,supportsPercentileStatistics:!0,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsTopFeaturesQuery:!1,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,supportsDefaultSpatialReference:!1,supportsFullTextSearch:!1,supportsCompactGeometry:!1,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0},Mhe=[252,146,31,255],Gbt=[153,153,153,255],$he={type:"esriSMS",style:"esriSMSCircle",size:6,color:Mhe,outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[153,153,153,255]}},Ahe={type:"esriSLS",style:"esriSLSSolid",width:.75,color:Mhe},khe={type:"esriSFS",style:"esriSFSSolid",color:[252,146,31,196],outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[255,255,255,191]}},cVe={type:"esriTS",color:[255,255,255,255],font:{family:"arial-unicode-ms",size:10,weight:"bold"},horizontalAlignment:"center",kerning:!0,haloColor:[0,0,0,255],haloSize:1,rotated:!1,text:"",xoffset:0,yoffset:0,angle:0},uVe={type:"esriSMS",style:"esriSMSCircle",color:[0,0,0,255],outline:null,size:10.5},dVe={type:"esriSLS",style:"esriSLSSolid",color:[0,0,0,255],width:1.5},hVe={type:"esriSFS",style:"esriSFSSolid",color:[0,0,0,255],outline:null};function Hbt(t){return{renderer:{type:"simple",symbol:t==="esriGeometryPoint"||t==="esriGeometryMultipoint"?$he:t==="esriGeometryPolyline"?Ahe:khe}}}const pVe=/^[_$a-zA-Z][_$a-zA-Z0-9]*$/;let fVe=1;function qbt(t,e){if(ee("esri-csp-restrictions"))return()=>({[e]:null,...t});try{let i=`this.${e} = null;`;for(const n in t)i+=`this${pVe.test(n)?`.${n}`:`["${n}"]`} = ${JSON.stringify(t[n])};`;const r=new Function(`
      return class AttributesClass$${fVe++} {
        constructor() {
          ${i};
        }
      }
    `)();return()=>new r}catch{return()=>({[e]:null,...t})}}function Wbt(t={}){return[{name:"New Feature",description:"",prototype:{attributes:U(t)}}]}function mVe(t,e){return{analytics:{supportsCacheHint:!1},attachment:null,data:{isVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:t},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:e,supportsDelete:e,supportsEditing:e,supportsChangeTracking:!1,supportsQuery:!0,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:e,supportsExceedsLimitStatistics:!0,supportsAsyncConvert3D:!1},query:lVe,queryRelated:{supportsCount:!0,supportsOrderBy:!0,supportsPagination:!0,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},editing:{supportsGeometryUpdate:e,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1,supportsAsyncApplyEdits:!1}}}var RV;let uw=RV=class extends te{constructor(t){super(t),this.name=null,this.code=null}clone(){return new RV({name:this.name,code:this.code})}};d([p({type:String,json:{write:!0}})],uw.prototype,"name",void 0),d([p({type:[String,Number],json:{write:!0}})],uw.prototype,"code",void 0),uw=RV=d([A("esri.layers.support.CodedValue")],uw);const gVe=new He({inherited:"inherited",codedValue:"coded-value",range:"range"});let i2=class extends te{constructor(e){super(e),this.name=null,this.type=null}};d([p({type:String,json:{write:!0}})],i2.prototype,"name",void 0),d([xe(gVe)],i2.prototype,"type",void 0),i2=d([A("esri.layers.support.Domain")],i2);const DL=i2;var FV;let r2=FV=class extends DL{constructor(t){super(t),this.codedValues=null,this.type="coded-value"}getName(t){let e=null;if(this.codedValues){const i=String(t);this.codedValues.some(r=>(String(r.code)===i&&(e=r.name),!!e))}return e}clone(){return new FV({codedValues:U(this.codedValues),name:this.name})}};d([p({type:[uw],json:{write:!0}})],r2.prototype,"codedValues",void 0),d([xe({codedValue:"coded-value"})],r2.prototype,"type",void 0),r2=FV=d([A("esri.layers.support.CodedValueDomain")],r2);const NL=r2;var DV;let wA=DV=class extends DL{constructor(t){super(t),this.type="inherited"}clone(){return new DV}};d([xe({inherited:"inherited"})],wA.prototype,"type",void 0),wA=DV=d([A("esri.layers.support.InheritedDomain")],wA);const Phe=wA;var NV;let _b=NV=class extends DL{constructor(t){super(t),this.maxValue=null,this.minValue=null,this.type="range"}clone(){return new NV({maxValue:this.maxValue,minValue:this.minValue,name:this.name})}};d([p({type:Number,json:{type:[Number],read:{source:"range",reader:(t,e)=>e.range&&e.range[1]},write:{enabled:!1,overridePolicy(){return{enabled:this.maxValue!=null&&this.minValue==null}},target:"range",writer(t,e,i){e[i]=[this.minValue||0,t]}}}})],_b.prototype,"maxValue",void 0),d([p({type:Number,json:{type:[Number],read:{source:"range",reader:(t,e)=>e.range&&e.range[0]},write:{target:"range",writer(t,e,i){e[i]=[t,this.maxValue||0]}}}})],_b.prototype,"minValue",void 0),d([xe({range:"range"})],_b.prototype,"type",void 0),_b=NV=d([A("esri.layers.support.RangeDomain")],_b);const Ohe=_b,Lhe={key:"type",base:DL,typeMap:{range:Ohe,"coded-value":NL,inherited:Phe}};function VL(t){if(!t||!t.type)return null;switch(t.type){case"range":return Ohe.fromJSON(t);case"codedValue":return NL.fromJSON(t);case"inherited":return Phe.fromJSON(t)}return null}const yVe=new He({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml",esriFieldTypeBigInteger:"big-integer",esriFieldTypeDateOnly:"date-only",esriFieldTypeTimeOnly:"time-only",esriFieldTypeTimestampOffset:"timestamp-offset"});var VV;const vVe=new He({binary:"binary",coordinate:"coordinate",countOrAmount:"count-or-amount",dateAndTime:"date-and-time",description:"description",locationOrPlaceName:"location-or-place-name",measurement:"measurement",nameOrTitle:"name-or-title",none:"none",orderedOrRanked:"ordered-or-ranked",percentageOrRatio:"percentage-or-ratio",typeOrCategory:"type-or-category",uniqueIdentifier:"unique-identifier"});let qs=VV=class extends te{constructor(t){super(t),this.alias=null,this.defaultValue=void 0,this.description=null,this.domain=null,this.editable=!0,this.length=-1,this.name=null,this.nullable=!0,this.type=null,this.valueType=null,this.visible=!0}readDescription(t,{description:e}){let i=null;try{i=e?JSON.parse(e):null}catch{}return(i==null?void 0:i.value)??null}readValueType(t,{description:e}){let i=null;try{i=e?JSON.parse(e):null}catch{}return i?vVe.fromJSON(i.fieldValueType):null}clone(){return new VV({alias:this.alias,defaultValue:this.defaultValue,description:this.description,domain:this.domain&&this.domain.clone()||null,editable:this.editable,length:this.length,name:this.name,nullable:this.nullable,type:this.type,valueType:this.valueType,visible:this.visible})}};d([p({type:String,json:{write:!0}})],qs.prototype,"alias",void 0),d([p({type:[String,Number],json:{write:{allowNull:!0}}})],qs.prototype,"defaultValue",void 0),d([p()],qs.prototype,"description",void 0),d([ae("description")],qs.prototype,"readDescription",null),d([p({types:Lhe,json:{read:{reader:VL},write:!0}})],qs.prototype,"domain",void 0),d([p({type:Boolean,json:{write:!0}})],qs.prototype,"editable",void 0),d([p({type:wt,json:{write:!0}})],qs.prototype,"length",void 0),d([p({type:String,json:{write:!0}})],qs.prototype,"name",void 0),d([p({type:Boolean,json:{write:!0}})],qs.prototype,"nullable",void 0),d([xe(yVe)],qs.prototype,"type",void 0),d([p()],qs.prototype,"valueType",void 0),d([ae("valueType",["description"])],qs.prototype,"readValueType",null),d([p({type:Boolean,json:{read:!1}})],qs.prototype,"visible",void 0),qs=VV=d([A("esri.layers.support.Field")],qs);const hu=qs;var zV;const jV=new He({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh","":null});let is=zV=class extends te{constructor(t){super(t),this.displayFieldName=null,this.exceededTransferLimit=!1,this.features=[],this.fields=null,this.geometryType=null,this.hasM=!1,this.hasZ=!1,this.queryGeometry=null,this.spatialReference=null}readFeatures(t,e){const i=Ee.fromJSON(e.spatialReference),r=[];for(let n=0;n<t.length;n++){const s=t[n],o=Or.fromJSON(s),a=s.geometry&&s.geometry.spatialReference;o.geometry==null||a||(o.geometry.spatialReference=i);const l=s.aggregateGeometries,c=o.aggregateGeometries;if(l&&c!=null)for(const u in c){const h=c[u],f=l[u],m=f==null?void 0:f.spatialReference;h==null||m||(h.spatialReference=i)}r.push(o)}return r}writeGeometryType(t,e,i,r){if(t)return void jV.write(t,e,i,r);const{features:n}=this;if(n){for(const s of n)if(s&&s.geometry!=null)return void jV.write(s.geometry.type,e,i,r)}}readQueryGeometry(t,e){if(!t)return null;const i=!!t.spatialReference,r=Vd(t);return r&&!i&&e.spatialReference&&(r.spatialReference=Ee.fromJSON(e.spatialReference)),r}writeSpatialReference(t,e){if(t)return void(e.spatialReference=t.toJSON());const{features:i}=this;if(i){for(const r of i)if(r&&r.geometry!=null&&r.geometry.spatialReference)return void(e.spatialReference=r.geometry.spatialReference.toJSON())}}clone(){return new zV(this.cloneProperties())}cloneProperties(){return U({displayFieldName:this.displayFieldName,exceededTransferLimit:this.exceededTransferLimit,features:this.features,fields:this.fields,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,queryGeometry:this.queryGeometry,spatialReference:this.spatialReference,transform:this.transform})}toJSON(t){const e=this.write();if(e.features&&Array.isArray(t)&&t.length>0)for(let i=0;i<e.features.length;i++){const r=e.features[i];if(r.geometry){const n=t&&t[i];r.geometry=n&&n.toJSON()||r.geometry}}return e}quantize(t){const{scale:[e,i],translate:[r,n]}=t,s=c=>Math.round((c-r)/e),o=c=>Math.round((n-c)/i),a=this.features,l=this._getQuantizationFunction(this.geometryType,s,o);for(let c=0,u=a.length;c<u;c++)l!=null&&l(a[c].geometry)||(a.splice(c,1),c--,u--);return this.transform=t,this}unquantize(){var f,m;const{geometryType:t,features:e,transform:i}=this;if(!i)return this;const{translate:[r,n],scale:[s,o]}=i,a=g=>g*s+r,l=g=>n-g*o;let c=null,u=null;if(this.hasZ&&((f=i==null?void 0:i.scale)==null?void 0:f[2])!=null){const{translate:[,,g],scale:[,,y]}=i;c=v=>v*y+g}if(this.hasM&&((m=i==null?void 0:i.scale)==null?void 0:m[3])!=null){const{translate:[,,,g],scale:[,,,y]}=i;u=v=>v==null?v:v*y+g}const h=this._getHydrationFunction(t,a,l,c,u);for(const{geometry:g}of e)g!=null&&h&&h(g);return this.transform=null,this}_quantizePoints(t,e,i){let r,n;const s=[];for(let o=0,a=t.length;o<a;o++){const l=t[o];if(o>0){const c=e(l[0]),u=i(l[1]);c===r&&u===n||(s.push([c-r,u-n]),r=c,n=u)}else r=e(l[0]),n=i(l[1]),s.push([r,n])}return s.length>0?s:null}_getQuantizationFunction(t,e,i){return t==="point"?r=>(r.x=e(r.x),r.y=i(r.y),r):t==="polyline"||t==="polygon"?r=>{const n=Ew(r)?r.rings:r.paths,s=[];for(let o=0,a=n.length;o<a;o++){const l=n[o],c=this._quantizePoints(l,e,i);c&&s.push(c)}return s.length>0?(Ew(r)?r.rings=s:r.paths=s,r):null}:t==="multipoint"?r=>{const n=this._quantizePoints(r.points,e,i);return n&&n.length>0?(r.points=n,r):null}:t==="extent"?r=>r:null}_getHydrationFunction(t,e,i,r,n){return t==="point"?s=>{s.x=e(s.x),s.y=i(s.y),r&&(s.z=r(s.z))}:t==="polyline"||t==="polygon"?s=>{const o=Ew(s)?s.rings:s.paths;let a,l;for(let c=0,u=o.length;c<u;c++){const h=o[c];for(let f=0,m=h.length;f<m;f++){const g=h[f];f>0?(a+=g[0],l+=g[1]):(a=g[0],l=g[1]),g[0]=e(a),g[1]=i(l)}}if(r&&n)for(let c=0,u=o.length;c<u;c++){const h=o[c];for(let f=0,m=h.length;f<m;f++){const g=h[f];g[2]=r(g[2]),g[3]=n(g[3])}}else if(r)for(let c=0,u=o.length;c<u;c++){const h=o[c];for(let f=0,m=h.length;f<m;f++){const g=h[f];g[2]=r(g[2])}}else if(n)for(let c=0,u=o.length;c<u;c++){const h=o[c];for(let f=0,m=h.length;f<m;f++){const g=h[f];g[2]=n(g[2])}}}:t==="extent"?s=>{s.xmin=e(s.xmin),s.ymin=i(s.ymin),s.xmax=e(s.xmax),s.ymax=i(s.ymax),r&&s.zmax!=null&&s.zmin!=null&&(s.zmax=r(s.zmax),s.zmin=r(s.zmin)),n&&s.mmax!=null&&s.mmin!=null&&(s.mmax=n(s.mmax),s.mmin=n(s.mmin))}:t==="multipoint"?s=>{const o=s.points;let a,l;for(let c=0,u=o.length;c<u;c++){const h=o[c];c>0?(a+=h[0],l+=h[1]):(a=h[0],l=h[1]),h[0]=e(a),h[1]=i(l)}if(r&&n)for(let c=0,u=o.length;c<u;c++){const h=o[c];h[2]=r(h[2]),h[3]=n(h[3])}else if(r)for(let c=0,u=o.length;c<u;c++){const h=o[c];h[2]=r(h[2])}else if(n)for(let c=0,u=o.length;c<u;c++){const h=o[c];h[2]=n(h[2])}}:null}};d([p({type:String,json:{write:!0}})],is.prototype,"displayFieldName",void 0),d([p({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],is.prototype,"exceededTransferLimit",void 0),d([p({type:[Or],json:{write:!0}})],is.prototype,"features",void 0),d([ae("features")],is.prototype,"readFeatures",null),d([p({type:[hu],json:{write:!0}})],is.prototype,"fields",void 0),d([p({type:["point","multipoint","polyline","polygon","extent","mesh"],json:{read:{reader:jV.read}}})],is.prototype,"geometryType",void 0),d([ge("geometryType")],is.prototype,"writeGeometryType",null),d([p({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],is.prototype,"hasM",void 0),d([p({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],is.prototype,"hasZ",void 0),d([p({types:_g,json:{write:!0}})],is.prototype,"queryGeometry",void 0),d([ae("queryGeometry")],is.prototype,"readQueryGeometry",null),d([p({type:Ee,json:{write:!0}})],is.prototype,"spatialReference",void 0),d([ge("spatialReference")],is.prototype,"writeSpatialReference",null),d([p({json:{write:!0}})],is.prototype,"transform",void 0),is=zV=d([A("esri.rest.support.FeatureSet")],is),is.prototype.toJSON.isDefaultToJSON=!0;const Mg=is,Rhe="esri.layers.graphics.sources.GeoJSONSource",vZ=ie.getLogger(Rhe);let Fy=class extends Su{constructor(){super(...arguments),this.type="geojson",this.refresh=Ad(async e=>{await this.load();const{extent:i,timeExtent:r}=await this._connection.invoke("refresh",e);return this.sourceJSON.extent=i,r&&(this.sourceJSON.timeInfo.timeExtent=[r.start,r.end]),{dataChanged:!0,updates:{extent:this.sourceJSON.extent,timeInfo:this.sourceJSON.timeInfo}}})}load(e){const i=e!=null?e.signal:null;return this.addResolvingPromise(this._startWorker(i)),Promise.resolve(this)}destroy(){var e;(e=this._connection)==null||e.close(),this._connection=null}applyEdits(e){return this.load().then(()=>this._applyEdits(e))}openPorts(){return this.load().then(()=>this._connection.openPorts())}queryFeatures(e,i={}){return this.load(i).then(()=>this._connection.invoke("queryFeatures",e?e.toJSON():null,i)).then(r=>Mg.fromJSON(r))}queryFeaturesJSON(e,i={}){return this.load(i).then(()=>this._connection.invoke("queryFeatures",e?e.toJSON():null,i))}queryFeatureCount(e,i={}){return this.load(i).then(()=>this._connection.invoke("queryFeatureCount",e?e.toJSON():null,i))}queryObjectIds(e,i={}){return this.load(i).then(()=>this._connection.invoke("queryObjectIds",e?e.toJSON():null,i))}queryExtent(e,i={}){return this.load(i).then(()=>this._connection.invoke("queryExtent",e?e.toJSON():null,i)).then(r=>({count:r.count,extent:Re.fromJSON(r.extent)}))}querySnapping(e,i={}){return this.load(i).then(()=>this._connection.invoke("querySnapping",e,i))}_applyEdits(e){if(!this._connection)throw new N("geojson-layer-source:edit-failure","Memory source not loaded");const i=this.layer.objectIdField,r=[],n=[],s=[];if(e.addFeatures)for(const o of e.addFeatures)r.push(this._serializeFeature(o));if(e.deleteFeatures)for(const o of e.deleteFeatures)"objectId"in o&&o.objectId!=null?n.push(o.objectId):"attributes"in o&&o.attributes[i]!=null&&n.push(o.attributes[i]);if(e.updateFeatures)for(const o of e.updateFeatures)s.push(this._serializeFeature(o));return this._connection.invoke("applyEdits",{adds:r,updates:s,deletes:n}).then(({extent:o,timeExtent:a,featureEditResults:l})=>(this.sourceJSON.extent=o,a&&(this.sourceJSON.timeInfo.timeExtent=[a.start,a.end]),this._createEditsResult(l)))}_createEditsResult(e){return{addFeatureResults:e.addResults?e.addResults.map(this._createFeatureEditResult,this):[],updateFeatureResults:e.updateResults?e.updateResults.map(this._createFeatureEditResult,this):[],deleteFeatureResults:e.deleteResults?e.deleteResults.map(this._createFeatureEditResult,this):[],addAttachmentResults:[],updateAttachmentResults:[],deleteAttachmentResults:[]}}_createFeatureEditResult(e){const i=e.success===!0?null:e.error||{code:void 0,description:void 0};return{objectId:e.objectId,globalId:e.globalId,error:i?new N("geojson-layer-source:edit-failure",i.description,{code:i.code}):null}}_serializeFeature(e){const{attributes:i}=e,r=this._geometryForSerialization(e);return r?{geometry:r.toJSON(),attributes:i}:{attributes:i}}_geometryForSerialization(e){const{geometry:i}=e;return i==null?null:i.type==="mesh"||i.type==="extent"?Zn.fromExtent(i.extent):i}async _startWorker(e){this._connection=await IU("GeoJSONSourceWorker",{strategy:ee("feature-layers-workers")?"dedicated":"local",signal:e});const{fields:i,spatialReference:r,hasZ:n,geometryType:s,objectIdField:o,url:a,timeInfo:l,customParameters:c}=this.layer,u=this.layer.originOf("spatialReference")==="defaults",h={url:a,customParameters:c,fields:i&&i.map(m=>m.toJSON()),geometryType:zB.toJSON(s),hasZ:n,objectIdField:o,timeInfo:l?l.toJSON():null,spatialReference:u?null:r&&r.toJSON()},f=await this._connection.invoke("load",h,{signal:e});for(const m of f.warnings)vZ.warn(m.message,{layer:this.layer,warning:m});f.featureErrors.length&&vZ.warn(`Encountered ${f.featureErrors.length} validation errors while loading features`,f.featureErrors),this.sourceJSON=f.layerDefinition,this.capabilities=mVe(this.sourceJSON.hasZ,!0)}};d([p()],Fy.prototype,"capabilities",void 0),d([p()],Fy.prototype,"type",void 0),d([p({constructOnly:!0})],Fy.prototype,"layer",void 0),d([p()],Fy.prototype,"sourceJSON",void 0),Fy=d([A(Rhe)],Fy);function zL(){const t=new Float32Array(16);return t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function _Ve(t){const e=new Float32Array(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function bVe(t,e,i,r,n,s,o,a,l,c,u,h,f,m,g,y){const v=new Float32Array(16);return v[0]=t,v[1]=e,v[2]=i,v[3]=r,v[4]=n,v[5]=s,v[6]=o,v[7]=a,v[8]=l,v[9]=c,v[10]=u,v[11]=h,v[12]=f,v[13]=m,v[14]=g,v[15]=y,v}function wVe(t,e){return new Float32Array(t,e,16)}const xVe=zL();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:xVe,clone:_Ve,create:zL,createView:wVe,fromValues:bVe},Symbol.toStringTag,{value:"Module"}));const SVe=(t,e)=>{const i=Sg(t,e,0,0,0,0,e,0,0,0,0,e,0,0,0,0,1);return ac(i,i)},IVe=(t,e)=>{const i=Sg(t,e,0,0,.5-.5*e,0,e,0,.5-.5*e,0,0,e,.5-.5*e,0,0,0,1);return ac(i,i)},TVe=(t,e)=>{const i=1-e,r=Sg(t,.2126+.7874*i,.7152-.7152*i,.0722-.0722*i,0,.2126-.2126*i,.7152+.2848*i,.0722-.0722*i,0,.2126-.2126*i,.7152-.7152*i,.0722+.9278*i,0,0,0,0,1);return ac(r,r)},CVe=(t,e)=>{const i=Math.sin(e*Math.PI/180),r=Math.cos(e*Math.PI/180),n=Sg(t,.213+.787*r-.213*i,.715-.715*r-.715*i,.072-.072*r+.928*i,0,.213-.213*r+.143*i,.715+.285*r+.14*i,.072-.072*r-.283*i,0,.213-.213*r-.787*i,.715-.715*r+.715*i,.072+.928*r+.072*i,0,0,0,0,1);return ac(n,n)},EVe=(t,e)=>{const i=1-2*e,r=Sg(t,i,0,0,e,0,i,0,e,0,0,i,e,0,0,0,1);return ac(r,r)},MVe=(t,e)=>{const i=Sg(t,.213+.787*e,.715-.715*e,.072-.072*e,0,.213-.213*e,.715+.285*e,.072-.072*e,0,.213-.213*e,.715-.715*e,.072+.928*e,0,0,0,0,1);return ac(i,i)},$Ve=(t,e)=>{const i=1-e,r=Sg(t,.393+.607*i,.769-.769*i,.189-.189*i,0,.349-.349*i,.686+.314*i,.168-.168*i,0,.272-.272*i,.534-.534*i,.131+.869*i,0,0,0,0,1);return ac(r,r)};let Fhe=class Dhe{constructor(e,i,r){this.strength=e,this.radius=i,this.threshold=r,this.type="bloom"}interpolate(e,i,r){this.strength=ga(e.strength,i.strength,r),this.radius=ga(e.radius,i.radius,r),this.threshold=ga(e.threshold,i.threshold,r)}clone(){return new Dhe(this.strength,this.radius,this.threshold)}toJSON(){return{type:"bloom",radius:oI(this.radius),strength:this.strength,threshold:this.threshold}}},Nhe=class Vhe{constructor(e){this.radius=e,this.type="blur"}interpolate(e,i,r){this.radius=Math.round(ga(e.radius,i.radius,r))}clone(){return new Vhe(this.radius)}toJSON(){return{type:"blur",radius:oI(this.radius)}}},BV=class zhe{constructor(e,i){this.type=e,this.amount=i,this.type!=="invert"&&this.type!=="grayscale"&&this.type!=="sepia"||(this.amount=Math.min(this.amount,1))}get colorMatrix(){return this._colorMatrix||this._updateMatrix(),this._colorMatrix}interpolate(e,i,r){this.amount=ga(e.amount,i.amount,r),this._updateMatrix()}clone(){return new zhe(this.type,this.amount)}toJSON(){return{type:this.type,amount:this.amount}}_updateMatrix(){const e=this._colorMatrix||zL();switch(this.type){case"brightness":this._colorMatrix=SVe(e,this.amount);break;case"contrast":this._colorMatrix=IVe(e,this.amount);break;case"grayscale":this._colorMatrix=TVe(e,this.amount);break;case"invert":this._colorMatrix=EVe(e,this.amount);break;case"saturate":this._colorMatrix=MVe(e,this.amount);break;case"sepia":this._colorMatrix=$Ve(e,this.amount)}}},jhe=class Bhe{constructor(e,i,r,n){this.offsetX=e,this.offsetY=i,this.blurRadius=r,this.color=n,this.type="drop-shadow"}interpolate(e,i,r){this.offsetX=ga(e.offsetX,i.offsetX,r),this.offsetY=ga(e.offsetY,i.offsetY,r),this.blurRadius=ga(e.blurRadius,i.blurRadius,r),this.color[0]=Math.round(ga(e.color[0],i.color[0],r)),this.color[1]=Math.round(ga(e.color[1],i.color[1],r)),this.color[2]=Math.round(ga(e.color[2],i.color[2],r)),this.color[3]=ga(e.color[3],i.color[3],r)}clone(){return new Bhe(this.offsetX,this.offsetY,this.blurRadius,[...this.color])}toJSON(){const e=[...this.color];return e[3]*=255,{type:"drop-shadow",xoffset:oI(this.offsetX),yoffset:oI(this.offsetY),blurRadius:oI(this.blurRadius),color:e}}},Uhe=class Ghe{constructor(e){this.angle=e,this.type="hue-rotate"}get colorMatrix(){return this._colorMatrix||this._updateMatrix(),this._colorMatrix}interpolate(e,i,r){this.angle=ga(e.angle,i.angle,r),this._updateMatrix()}clone(){return new Ghe(this.angle)}toJSON(){return{type:"hue-rotate",angle:this.angle}}_updateMatrix(){const e=this._colorMatrix||zL();this._colorMatrix=CVe(e,this.angle)}},Hhe=class qhe{constructor(e){this.amount=e,this.type="opacity",this.amount=Math.min(this.amount,1)}interpolate(e,i,r){this.amount=ga(e.amount,i.amount,r)}clone(){return new qhe(this.amount)}toJSON(){return{type:"opacity",amount:this.amount}}};function ga(t,e,i){return t+(e-t)*i}function oI(t){return Math.round(1e3*wa(t))/1e3}function AVe(t){switch(t.type){case"grayscale":case"sepia":case"invert":return new BV(t.type,0);case"saturate":case"brightness":case"contrast":return new BV(t.type,1);case"opacity":return new Hhe(1);case"hue-rotate":return new Uhe(0);case"blur":return new Nhe(0);case"drop-shadow":return new jhe(0,0,0,[...TB("transparent")]);case"bloom":return new Fhe(0,0,1)}}function Whe(t,e){const i=t.length>e.length?t:e;return(t.length>e.length?e:t).every((r,n)=>r.type===i[n].type)}function Jhe(t,e){const i=t.length>e.length?t:e,r=t.length>e.length?e:t;for(let n=r.length;n<i.length;n++)r.push(AVe(i[n]))}function kVe(t){const e=t[0];return!!e&&"type"in e}var _Z,bZ,UV={exports:{}};UV.exports,bZ=function(){function t(n,s){function o(){this.constructor=n}o.prototype=s.prototype,n.prototype=new o}function e(n,s,o,a){var l=Error.call(this,n);return Object.setPrototypeOf&&Object.setPrototypeOf(l,e.prototype),l.expected=s,l.found=o,l.location=a,l.name="SyntaxError",l}function i(n,s,o){return o=o||" ",n.length>s?n:(s-=n.length,n+(o+=o.repeat(s)).slice(0,s))}function r(n,s){var o,a={},l=(s=s!==void 0?s:{}).grammarSource,c={start:a_},u=a_,h="none",f=")",m=",",g="(",y="%",v="px",b="cm",w="mm",x="in",S="pt",I="pc",T="deg",C="rad",E="grad",$="turn",P="#",k=".",L="e",F=/^[ \t\n\r]/,V=/^[a-z\-]/,z=/^[0-9a-fA-F]/,G=/^[+\-]/,H=/^[0-9]/,Z=$a("none"),K=Wr("none",!1),X=Wr(")",!1),oe=Wr(",",!1),se=$a("whitespace"),le=Dp([" ","	",`
`,"\r"],!1,!1),me=$a("function"),Se=Wr("(",!1),Ge=$a("identifier"),Be=Dp([["a","z"],"-"],!1,!1),gt=$a("percentage"),Pe=Wr("%",!1),De=$a("length"),ii=Wr("px",!1),Rr=Wr("cm",!1),At=Wr("mm",!1),mo=Wr("in",!1),bs=Wr("pt",!1),Ai=Wr("pc",!1),un=$a("angle"),fc=Wr("deg",!1),mc=Wr("rad",!1),cr=Wr("grad",!1),ur=Wr("turn",!1),Ho=$a("number"),Ce=$a("color"),Xe=Wr("#",!1),Rt=Dp([["0","9"],["a","f"],["A","F"]],!1,!1),Qi=Dp(["+","-"],!1,!1),xi=Dp([["0","9"]],!1,!1),Ln=Wr(".",!1),Fr=Wr("e",!1),Rn=function(){return[]},Rp=function(j,ne){return{type:"function",name:j,parameters:ne||[]}},hx=function(j,ne){return ne.length>0?fx(j,ne,3):[j]},UR=function(j){return{type:"quantity",value:j.value,unit:j.unit}},GR=function(j){return{type:"color",colorType:j.type,value:j.value}},HR=function(j){return j},qR=function(){return Og()},WR=function(j){return{value:j,unit:"%"}},r_=function(j){return{value:j,unit:"px"}},JR=function(j){return{value:j,unit:"cm"}},ZR=function(j){return{value:j,unit:"mm"}},rE=function(j){return{value:j,unit:"in"}},nE=function(j){return{value:j,unit:"pt"}},px=function(j){return{value:j,unit:"pc"}},YR=function(j){return{value:j,unit:"deg"}},KR=function(j){return{value:j,unit:"rad"}},XR=function(j){return{value:j,unit:"grad"}},sE=function(j){return{value:j,unit:"turn"}},QR=function(j){return{value:j,unit:null}},e3=function(){return{type:"hex",value:Og()}},t3=function(j){return{type:"function",value:j}},n_=function(){return{type:"named",value:Og()}},i3=function(){return parseFloat(Og())},Q=0,Ri=0,Fp=[{line:1,column:1}],dl=0,s_=[],Oe=0;if("startRule"in s){if(!(s.startRule in c))throw new Error(`Can't start parsing from rule "`+s.startRule+'".');u=c[s.startRule]}function Og(){return n.substring(Ri,Q)}function Wr(j,ne){return{type:"literal",text:j,ignoreCase:ne}}function Dp(j,ne,ue){return{type:"class",parts:j,inverted:ne,ignoreCase:ue}}function oE(){return{type:"end"}}function $a(j){return{type:"other",description:j}}function Ou(j){var ne,ue=Fp[j];if(ue)return ue;for(ne=j-1;!Fp[ne];)ne--;for(ue={line:(ue=Fp[ne]).line,column:ue.column};ne<j;)n.charCodeAt(ne)===10?(ue.line++,ue.column=1):ue.column++,ne++;return Fp[j]=ue,ue}function Np(j,ne,ue){var rt=Ou(j),Si=Ou(ne),hi={source:l,start:{offset:j,line:rt.line,column:rt.column},end:{offset:ne,line:Si.line,column:Si.column}};return ue&&l&&typeof l.offset=="function"&&(hi.start=l.offset(hi.start),hi.end=l.offset(hi.end)),hi}function We(j){Q<dl||(Q>dl&&(dl=Q,s_=[]),s_.push(j))}function o_(j,ne,ue){return new e(e.buildMessage(j,ne),j,ne,ue)}function a_(){var j;return(j=r3())===a&&(j=n3()),j}function r3(){var j,ne;return Oe++,j=Q,Fi(),n.substr(Q,4)===h?(ne=h,Q+=4):(ne=a,Oe===0&&We(K)),ne!==a?(Fi(),Ri=j,j=Rn()):(Q=j,j=a),Oe--,j===a&&Oe===0&&We(Z),j}function n3(){var j,ne;if(j=[],(ne=Vp())!==a)for(;ne!==a;)j.push(ne),ne=Vp();else j=a;return j}function Vp(){var j,ne,ue,rt;return j=Q,Fi(),(ne=gc())!==a?(Fi(),(ue=qo())===a&&(ue=null),Fi(),n.charCodeAt(Q)===41?(rt=f,Q++):(rt=a,Oe===0&&We(X)),rt!==a?(Fi(),Ri=j,j=Rp(ne,ue)):(Q=j,j=a)):(Q=j,j=a),j}function qo(){var j,ne,ue,rt,Si,hi,go,jp;if(j=Q,(ne=Lu())!==a){for(ue=[],rt=Q,Si=Fi(),n.charCodeAt(Q)===44?(hi=m,Q++):(hi=a,Oe===0&&We(oe)),hi===a&&(hi=null),go=Fi(),(jp=Lu())!==a?rt=Si=[Si,hi,go,jp]:(Q=rt,rt=a);rt!==a;)ue.push(rt),rt=Q,Si=Fi(),n.charCodeAt(Q)===44?(hi=m,Q++):(hi=a,Oe===0&&We(oe)),hi===a&&(hi=null),go=Fi(),(jp=Lu())!==a?rt=Si=[Si,hi,go,jp]:(Q=rt,rt=a);Ri=j,j=hx(ne,ue)}else Q=j,j=a;return j}function Lu(){var j,ne;return j=Q,(ne=hl())===a&&(ne=yc())===a&&(ne=aE())===a&&(ne=lE()),ne!==a&&(Ri=j,ne=UR(ne)),(j=ne)===a&&(j=Q,(ne=l_())!==a&&(Ri=j,ne=GR(ne)),j=ne),j}function Fi(){var j,ne;for(Oe++,j=[],F.test(n.charAt(Q))?(ne=n.charAt(Q),Q++):(ne=a,Oe===0&&We(le));ne!==a;)j.push(ne),F.test(n.charAt(Q))?(ne=n.charAt(Q),Q++):(ne=a,Oe===0&&We(le));return Oe--,ne=a,Oe===0&&We(se),j}function gc(){var j,ne,ue;return Oe++,j=Q,(ne=zp())!==a?(n.charCodeAt(Q)===40?(ue=g,Q++):(ue=a,Oe===0&&We(Se)),ue!==a?(Ri=j,j=HR(ne)):(Q=j,j=a)):(Q=j,j=a),Oe--,j===a&&(ne=a,Oe===0&&We(me)),j}function zp(){var j,ne,ue;if(Oe++,j=Q,ne=[],V.test(n.charAt(Q))?(ue=n.charAt(Q),Q++):(ue=a,Oe===0&&We(Be)),ue!==a)for(;ue!==a;)ne.push(ue),V.test(n.charAt(Q))?(ue=n.charAt(Q),Q++):(ue=a,Oe===0&&We(Be));else ne=a;return ne!==a&&(Ri=j,ne=qR()),Oe--,(j=ne)===a&&(ne=a,Oe===0&&We(Ge)),j}function hl(){var j,ne,ue;return Oe++,j=Q,Fi(),(ne=dr())!==a?(n.charCodeAt(Q)===37?(ue=y,Q++):(ue=a,Oe===0&&We(Pe)),ue!==a?(Ri=j,j=WR(ne)):(Q=j,j=a)):(Q=j,j=a),Oe--,j===a&&Oe===0&&We(gt),j}function yc(){var j,ne,ue;return Oe++,j=Q,Fi(),(ne=dr())!==a?(n.substr(Q,2)===v?(ue=v,Q+=2):(ue=a,Oe===0&&We(ii)),ue!==a?(Ri=j,j=r_(ne)):(Q=j,j=a)):(Q=j,j=a),j===a&&(j=Q,Fi(),(ne=dr())!==a?(n.substr(Q,2)===b?(ue=b,Q+=2):(ue=a,Oe===0&&We(Rr)),ue!==a?(Ri=j,j=JR(ne)):(Q=j,j=a)):(Q=j,j=a),j===a&&(j=Q,Fi(),(ne=dr())!==a?(n.substr(Q,2)===w?(ue=w,Q+=2):(ue=a,Oe===0&&We(At)),ue!==a?(Ri=j,j=ZR(ne)):(Q=j,j=a)):(Q=j,j=a),j===a&&(j=Q,Fi(),(ne=dr())!==a?(n.substr(Q,2)===x?(ue=x,Q+=2):(ue=a,Oe===0&&We(mo)),ue!==a?(Ri=j,j=rE(ne)):(Q=j,j=a)):(Q=j,j=a),j===a&&(j=Q,Fi(),(ne=dr())!==a?(n.substr(Q,2)===S?(ue=S,Q+=2):(ue=a,Oe===0&&We(bs)),ue!==a?(Ri=j,j=nE(ne)):(Q=j,j=a)):(Q=j,j=a),j===a&&(j=Q,Fi(),(ne=dr())!==a?(n.substr(Q,2)===I?(ue=I,Q+=2):(ue=a,Oe===0&&We(Ai)),ue!==a?(Ri=j,j=px(ne)):(Q=j,j=a)):(Q=j,j=a)))))),Oe--,j===a&&Oe===0&&We(De),j}function aE(){var j,ne,ue;return Oe++,j=Q,(ne=dr())!==a?(n.substr(Q,3)===T?(ue=T,Q+=3):(ue=a,Oe===0&&We(fc)),ue!==a?(Ri=j,j=YR(ne)):(Q=j,j=a)):(Q=j,j=a),j===a&&(j=Q,(ne=dr())!==a?(n.substr(Q,3)===C?(ue=C,Q+=3):(ue=a,Oe===0&&We(mc)),ue!==a?(Ri=j,j=KR(ne)):(Q=j,j=a)):(Q=j,j=a),j===a&&(j=Q,(ne=dr())!==a?(n.substr(Q,4)===E?(ue=E,Q+=4):(ue=a,Oe===0&&We(cr)),ue!==a?(Ri=j,j=XR(ne)):(Q=j,j=a)):(Q=j,j=a),j===a&&(j=Q,(ne=dr())!==a?(n.substr(Q,4)===$?(ue=$,Q+=4):(ue=a,Oe===0&&We(ur)),ue!==a?(Ri=j,j=sE(ne)):(Q=j,j=a)):(Q=j,j=a)))),Oe--,j===a&&(ne=a,Oe===0&&We(un)),j}function lE(){var j,ne;return Oe++,j=Q,Fi(),(ne=dr())!==a?(Ri=j,j=QR(ne)):(Q=j,j=a),Oe--,j===a&&Oe===0&&We(Ho),j}function l_(){var j,ne,ue,rt;if(Oe++,j=Q,n.charCodeAt(Q)===35?(ne=P,Q++):(ne=a,Oe===0&&We(Xe)),ne!==a){if(ue=[],z.test(n.charAt(Q))?(rt=n.charAt(Q),Q++):(rt=a,Oe===0&&We(Rt)),rt!==a)for(;rt!==a;)ue.push(rt),z.test(n.charAt(Q))?(rt=n.charAt(Q),Q++):(rt=a,Oe===0&&We(Rt));else ue=a;ue!==a?(Ri=j,j=e3()):(Q=j,j=a)}else Q=j,j=a;return j===a&&(j=Q,(ne=Vp())!==a&&(Ri=j,ne=t3(ne)),(j=ne)===a&&(j=Q,(ne=zp())!==a&&(Ri=j,ne=n_()),j=ne)),Oe--,j===a&&(ne=a,Oe===0&&We(Ce)),j}function dr(){var j,ne,ue,rt,Si,hi,go;for(j=Q,G.test(n.charAt(Q))?(n.charAt(Q),Q++):Oe===0&&We(Qi),ne=Q,ue=[],H.test(n.charAt(Q))?(rt=n.charAt(Q),Q++):(rt=a,Oe===0&&We(xi));rt!==a;)ue.push(rt),H.test(n.charAt(Q))?(rt=n.charAt(Q),Q++):(rt=a,Oe===0&&We(xi));if(n.charCodeAt(Q)===46?(rt=k,Q++):(rt=a,Oe===0&&We(Ln)),rt!==a){if(Si=[],H.test(n.charAt(Q))?(hi=n.charAt(Q),Q++):(hi=a,Oe===0&&We(xi)),hi!==a)for(;hi!==a;)Si.push(hi),H.test(n.charAt(Q))?(hi=n.charAt(Q),Q++):(hi=a,Oe===0&&We(xi));else Si=a;Si!==a?ne=ue=[ue,rt,Si]:(Q=ne,ne=a)}else Q=ne,ne=a;if(ne===a)if(ne=[],H.test(n.charAt(Q))?(ue=n.charAt(Q),Q++):(ue=a,Oe===0&&We(xi)),ue!==a)for(;ue!==a;)ne.push(ue),H.test(n.charAt(Q))?(ue=n.charAt(Q),Q++):(ue=a,Oe===0&&We(xi));else ne=a;if(ne!==a){if(ue=Q,n.charCodeAt(Q)===101?(rt=L,Q++):(rt=a,Oe===0&&We(Fr)),rt!==a){if(G.test(n.charAt(Q))?(Si=n.charAt(Q),Q++):(Si=a,Oe===0&&We(Qi)),Si===a&&(Si=null),hi=[],H.test(n.charAt(Q))?(go=n.charAt(Q),Q++):(go=a,Oe===0&&We(xi)),go!==a)for(;go!==a;)hi.push(go),H.test(n.charAt(Q))?(go=n.charAt(Q),Q++):(go=a,Oe===0&&We(xi));else hi=a;hi!==a?ue=rt=[rt,Si,hi]:(Q=ue,ue=a)}else Q=ue,ue=a;ue===a&&(ue=null),Ri=j,j=i3()}else Q=j,j=a;return j}function c_(j,ne){return j.map(function(ue){return ue[ne]})}function fx(j,ne,ue){return[j].concat(c_(ne,ue))}if((o=u())!==a&&Q===n.length)return o;throw o!==a&&Q<n.length&&We(oE()),o_(s_,dl<n.length?n.charAt(dl):null,dl<n.length?Np(dl,dl+1):Np(dl,dl))}return t(e,Error),e.prototype.format=function(n){var s="Error: "+this.message;if(this.location){var o,a=null;for(o=0;o<n.length;o++)if(n[o].source===this.location.source){a=n[o].text.split(/\r\n|\n|\r/g);break}var l=this.location.start,c=this.location.source&&typeof this.location.source.offset=="function"?this.location.source.offset(l):l,u=this.location.source+":"+c.line+":"+c.column;if(a){var h=this.location.end,f=i("",c.line.toString().length," "),m=a[l.line-1],g=(l.line===h.line?h.column:m.length+1)-l.column||1;s+=`
 --> `+u+`
`+f+` |
`+c.line+" | "+m+`
`+f+" | "+i("",l.column-1," ")+i("",g,"^")}else s+=`
 at `+u}return s},e.buildMessage=function(n,s){var o={literal:function(m){return'"'+l(m.text)+'"'},class:function(m){var g=m.parts.map(function(y){return Array.isArray(y)?c(y[0])+"-"+c(y[1]):c(y)});return"["+(m.inverted?"^":"")+g.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(m){return m.description}};function a(m){return m.charCodeAt(0).toString(16).toUpperCase()}function l(m){return m.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(g){return"\\x0"+a(g)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(g){return"\\x"+a(g)})}function c(m){return m.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(g){return"\\x0"+a(g)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(g){return"\\x"+a(g)})}function u(m){return o[m.type](m)}function h(m){var g,y,v=m.map(u);if(v.sort(),v.length>0){for(g=1,y=1;g<v.length;g++)v[g-1]!==v[g]&&(v[y]=v[g],y++);v.length=y}switch(v.length){case 1:return v[0];case 2:return v[0]+" or "+v[1];default:return v.slice(0,-1).join(", ")+", or "+v[v.length-1]}}function f(m){return m?'"'+l(m)+'"':"end of input"}return"Expected "+h(n)+" but "+f(s)+" found."},{SyntaxError:e,parse:r}},(_Z=UV).exports&&(_Z.exports=bZ());var PVe=UV.exports;function f9(t){if(!t||t.length===0)return null;if(typeof t=="string"){const i=wZ(t);return i&&i.length!==0?i:null}const e=t.map(i=>{if(!Number.isFinite(i.scale)||i.scale<=0)throw new N("effect:invalid-scale","scale must be finite and greater than 0",{stop:i});return{scale:i.scale,effects:wZ(i.value)}});e.sort((i,r)=>r.effects.length-i.effects.length);for(let i=0;i<e.length-1;i++){if(!Whe(e[i].effects,e[i+1].effects))throw new N("effect:interpolation-impossible","Cannot interpolate by scale between 2 lists of mixed effects",{a:e[i].effects,b:e[i+1].effects});Jhe(e[i].effects,e[i+1].effects)}return e.sort((i,r)=>r.scale-i.scale),e}function wZ(t){let e;if(!t)return[];try{e=PVe.parse(t)}catch(i){throw new N("effect:invalid-syntax","Invalid effect syntax",{value:t,error:i})}return e.map(i=>OVe(i))}function OVe(t){try{switch(t.name){case"grayscale":case"sepia":case"saturate":case"invert":case"brightness":case"contrast":return LVe(t);case"opacity":return RVe(t);case"hue-rotate":return FVe(t);case"blur":return DVe(t);case"drop-shadow":return NVe(t);case"bloom":return VVe(t)}}catch(e){throw e.details.filter=t,e}throw new N("effect:unknown-effect",`Effect '${t.name}' is not supported`,{effect:t})}function LVe(t){let e=1;return ix(t.parameters,1),t.parameters.length===1&&(e=ru(t.parameters[0])),new BV(t.name,e)}function RVe(t){let e=1;return ix(t.parameters,1),t.parameters.length===1&&(e=ru(t.parameters[0])),new Hhe(e)}function FVe(t){let e=0;return ix(t.parameters,1),t.parameters.length===1&&(e=HVe(t.parameters[0])),new Uhe(e)}function DVe(t){let e=0;return ix(t.parameters,1),t.parameters.length===1&&(e=y9(t.parameters[0]),PC(e,t.parameters[0])),new Nhe(e)}function NVe(t){const e=[];let i=null;for(const r of t.parameters)if(r.type==="color"){if(e.length&&Object.freeze(e),i)throw new N("effect:type-error","Accepts only one color",{});i=qVe(r)}else{const n=y9(r);if(Object.isFrozen(e))throw new N("effect:type-error","<length> parameters not consecutive",{lengths:e});e.push(n),e.length===3&&PC(n,r)}if(e.length<2||e.length>3)throw new N("effect:type-error",`Expected <length>{2,3}, Actual: <length>{${e.length}}`,{lengths:e});return new jhe(e[0],e[1],e[2]||0,i||Zhe("black"))}function VVe(t){let e=1,i=0,r=0;return ix(t.parameters,3),t.parameters[0]&&(e=ru(t.parameters[0])),t.parameters[1]&&(i=y9(t.parameters[1]),PC(i,t.parameters[1])),t.parameters[2]&&(r=ru(t.parameters[2])),new Fhe(e,i,r)}function ix(t,e){if(t.length>e)throw new N("effect:type-error",`Function supports up to ${e} parameters, Actual: ${t.length}`,{parameters:t})}function jL(t){if(t.type==="color")return"<color>";if(t.unit){if(t.unit in g9)return"<length>";if(t.unit in m9)return"<angle>";if(t.unit==="%")return"<percentage>"}return"<double>"}function PC(t,e){if(t<0)throw new N("effect:type-error",`Negative values are not allowed, Actual: ${t}`,{term:e})}function zVe(t){if(t.type!=="quantity"||t.unit!==null)throw new N("effect:type-error",`Expected <double>, Actual: ${jL(t)}`,{term:t})}function jVe(t){if(t.type!=="quantity"||t.unit!==null&&t.unit!=="%")throw new N("effect:type-error",`Expected <double> or <percentage>, Actual: ${jL(t)}`,{term:t})}const m9={deg:1,grad:.9,rad:180/Math.PI,turn:360};function BVe(t){if(t.type!=="quantity"||!(t.value===0&&t.unit===null||t.unit&&m9[t.unit]!=null))throw new N("effect:type-error",`Expected <angle>, Actual: ${jL(t)}`,{term:t})}const g9={px:1,cm:96/2.54,mm:96/2.54/10,in:96,pc:16,pt:96/72};function UVe(t){if(t.type!=="quantity"||!(t.value===0&&t.unit===null||t.unit&&g9[t.unit]!=null))throw new N("effect:type-error",`Expected <length>, Actual: ${jL(t)}`,{term:t})}function ru(t){jVe(t);const e=t.value;return PC(e,t),t.unit==="%"?.01*e:e}function GVe(t){return zVe(t),PC(t.value,t),t.value}function HVe(t){return BVe(t),t.value*m9[t.unit]||0}function y9(t){return UVe(t),t.value*g9[t.unit]||0}function qVe(t){switch(t.colorType){case"hex":return KIe(t.value);case"named":return Zhe(t.value);case"function":return ZVe(t.value)}}function Zhe(t){if(!_se(t))throw new N("effect:unknown-color",`color '${t}' isn't valid`,{namedColor:t});return YIe(t)}const WVe=/^rgba?/i,JVe=/^hsla?/i;function ZVe(t){if(ix(t.parameters,4),WVe.test(t.name))return[ru(t.parameters[0]),ru(t.parameters[1]),ru(t.parameters[2]),t.parameters[3]?ru(t.parameters[3]):1];if(JVe.test(t.name))return bse(GVe(t.parameters[0]),ru(t.parameters[1]),ru(t.parameters[2]),t.parameters[3]?ru(t.parameters[3]):1);throw new N("effect:syntax-error",`Invalid color function '${t.name}'`,{colorFunction:t})}function v9(t,e,i){var r;try{return KVe(t)}catch(n){(r=i==null?void 0:i.messages)==null||r.push(n)}return null}function _9(t,e,i,r){try{const n=YVe(t);ho(i,n,e)}catch(n){r.messages&&r.messages.push(n)}}function YVe(t){const e=f9(t);return e?kVe(e)?e.map(i=>i.toJSON()):e.map(({scale:i,effects:r})=>({scale:i,value:r.map(n=>n.toJSON())})):null}function KVe(t){if(!t||t.length===0)return null;if(XVe(t)){const e=[];for(const i of t)e.push({scale:i.scale,value:EP(i.value)});return e}return EP(t)}function XVe(t){const e=t[0];return!!e&&"scale"in e}function EP(t){if(!t||!t.length)return"";const e=[];for(const i of t){let r=[];switch(i.type){case"grayscale":case"sepia":case"saturate":case"invert":case"brightness":case"contrast":case"opacity":r=[eh(i,"amount")];break;case"blur":r=[eh(i,"radius","pt")];break;case"hue-rotate":r=[eh(i,"angle","deg")];break;case"drop-shadow":r=[eh(i,"xoffset","pt"),eh(i,"yoffset","pt"),eh(i,"blurRadius","pt"),QVe(i,"color")];break;case"bloom":r=[eh(i,"strength"),eh(i,"radius","pt"),eh(i,"threshold")]}const n=`${i.type}(${r.filter(Boolean).join(" ")})`;f9(n),e.push(n)}return e.join(" ")}function eh(t,e,i){if(t[e]==null)throw new N("effect:missing-parameter",`Missing parameter '${e}' in ${t.type} effect`,{effect:t});return i?t[e]+i:""+t[e]}function QVe(t,e){if(t[e]==null)throw new N("effect:missing-parameter",`Missing parameter '${e}' in ${t.type} effect`,{effect:t});const i=t[e];return`rgba(${i[0]||0}, ${i[1]||0}, ${i[2]||0}, ${i[3]/255||0})`}const xZ={read:{reader:v9},write:{allowNull:!0,writer:_9}},BL=t=>{let e=class extends t{constructor(){super(...arguments),this.blendMode="normal",this.effect=null}};return d([p({type:["average","color-burn","color-dodge","color","darken","destination-atop","destination-in","destination-out","destination-over","difference","exclusion","hard-light","hue","invert","lighten","lighter","luminosity","minus","multiply","normal","overlay","plus","reflect","saturation","screen","soft-light","source-atop","source-in","source-out","vivid-light","xor"],nonNullable:!0,json:{read:!1,write:!1,origins:{"web-map":{read:!0,write:!0},"portal-item":{read:!0,write:!0}}}})],e.prototype,"blendMode",void 0),d([p({json:{read:!1,write:!1,origins:{"web-map":xZ,"portal-item":xZ}}})],e.prototype,"effect",void 0),e=d([A("esri.layers.mixins.BlendLayer")],e),e},b9=t=>{let e=class extends t{constructor(){super(...arguments),this.customParameters=null}};return d([p({type:Object,json:{write:{overridePolicy:i=>({enabled:!!(i&&Object.keys(i).length>0)})}}})],e.prototype,"customParameters",void 0),e=d([A("esri.layers.mixins.CustomParametersMixin")],e),e};var GV;let bb=GV=class extends te{constructor(t){super(t),this.type="map-layer"}clone(){const{mapLayerId:t,gdbVersion:e}=this;return new GV({mapLayerId:t,gdbVersion:e})}};d([xe({mapLayer:"map-layer"})],bb.prototype,"type",void 0),d([p({type:wt,json:{write:!0}})],bb.prototype,"mapLayerId",void 0),d([p({type:String,json:{write:!0}})],bb.prototype,"gdbVersion",void 0),bb=GV=d([A("esri.layers.support.source.MapLayerSource")],bb);var HV;let xh=HV=class extends te{constructor(t){super(t),this.type="query-table"}clone(){const{workspaceId:t,query:e,oidFields:i,spatialReference:r,geometryType:n}=this,s={workspaceId:t,query:e,oidFields:i,spatialReference:(r==null?void 0:r.clone())??void 0,geometryType:n};return new HV(s)}};d([xe({queryTable:"query-table"})],xh.prototype,"type",void 0),d([p({type:String,json:{write:!0}})],xh.prototype,"workspaceId",void 0),d([p({type:String,json:{write:!0}})],xh.prototype,"query",void 0),d([p({type:String,json:{write:!0}})],xh.prototype,"oidFields",void 0),d([p({type:Ee,json:{write:!0}})],xh.prototype,"spatialReference",void 0),d([xe(zB)],xh.prototype,"geometryType",void 0),xh=HV=d([A("esri.layers.support.source.QueryTableDataSource")],xh);var qV;let wb=qV=class extends te{constructor(t){super(t),this.type="raster"}clone(){const{workspaceId:t,dataSourceName:e}=this;return new qV({workspaceId:t,dataSourceName:e})}};d([xe({raster:"raster"})],wb.prototype,"type",void 0),d([p({type:String,json:{write:!0}})],wb.prototype,"dataSourceName",void 0),d([p({type:String,json:{write:!0}})],wb.prototype,"workspaceId",void 0),wb=qV=d([A("esri.layers.support.source.RasterDataSource")],wb);var WV;let Dy=WV=class extends te{constructor(t){super(t),this.type="table"}clone(){const{workspaceId:t,gdbVersion:e,dataSourceName:i}=this;return new WV({workspaceId:t,gdbVersion:e,dataSourceName:i})}};d([xe({table:"table"})],Dy.prototype,"type",void 0),d([p({type:String,json:{write:!0}})],Dy.prototype,"workspaceId",void 0),d([p({type:String,json:{write:!0}})],Dy.prototype,"gdbVersion",void 0),d([p({type:String,json:{write:!0}})],Dy.prototype,"dataSourceName",void 0),Dy=WV=d([A("esri.layers.support.source.TableDataSource")],Dy);var JV,ZV;const eze=ln()({esriLeftInnerJoin:"left-inner-join",esriLeftOuterJoin:"left-outer-join"});let Ra=JV=class extends te{constructor(t){super(t),this.type="join-table"}readLeftTableSource(t,e,i){return SZ()(t,e,i)}castLeftTableSource(t){return Dd(YV(),t)}readRightTableSource(t,e,i){return SZ()(t,e,i)}castRightTableSource(t){return Dd(YV(),t)}clone(){const{leftTableKey:t,rightTableKey:e,leftTableSource:i,rightTableSource:r,joinType:n}=this,s={leftTableKey:t,rightTableKey:e,leftTableSource:(i==null?void 0:i.clone())??void 0,rightTableSource:(r==null?void 0:r.clone())??void 0,joinType:n};return new JV(s)}};d([xe({joinTable:"join-table"})],Ra.prototype,"type",void 0),d([p({type:String,json:{write:!0}})],Ra.prototype,"leftTableKey",void 0),d([p({type:String,json:{write:!0}})],Ra.prototype,"rightTableKey",void 0),d([p({json:{write:!0}})],Ra.prototype,"leftTableSource",void 0),d([ae("leftTableSource")],Ra.prototype,"readLeftTableSource",null),d([tt("leftTableSource")],Ra.prototype,"castLeftTableSource",null),d([p({json:{write:!0}})],Ra.prototype,"rightTableSource",void 0),d([ae("rightTableSource")],Ra.prototype,"readRightTableSource",null),d([tt("rightTableSource")],Ra.prototype,"castRightTableSource",null),d([xe(eze)],Ra.prototype,"joinType",void 0),Ra=JV=d([A("esri.layers.support.source.JoinTableDataSource")],Ra);let d5=null;function SZ(){return d5||(d5=L1({types:YV()})),d5}let h5=null;function YV(){return h5||(h5={key:"type",base:null,typeMap:{"data-layer":nu,"map-layer":bb}}),h5}const tze={key:"type",base:null,typeMap:{"join-table":Ra,"query-table":xh,raster:wb,table:Dy}};let nu=ZV=class extends te{constructor(t){super(t),this.type="data-layer"}clone(){const{fields:t,dataSource:e}=this;return new ZV({fields:t,dataSource:e})}};d([xe({dataLayer:"data-layer"})],nu.prototype,"type",void 0),d([p({type:[hu],json:{write:!0}})],nu.prototype,"fields",void 0),d([p({types:tze,json:{write:!0}})],nu.prototype,"dataSource",void 0),nu=ZV=d([A("esri.layers.support.source.DataLayerSource")],nu),nu.from=lr(nu);let Ny=class extends Li(te){constructor(e){super(e),this.onFields=null,this.operator=null,this.searchTerm=null,this.searchType=null}};d([p({type:[String],json:{write:{enabled:!0,overridePolicy(){return{enabled:this.onFields!=null&&this.onFields.length>0}}}}})],Ny.prototype,"onFields",void 0),d([p({type:String,json:{write:!0}})],Ny.prototype,"operator",void 0),d([p({type:String,json:{write:!0}})],Ny.prototype,"searchTerm",void 0),d([p({type:String,json:{write:!0}})],Ny.prototype,"searchType",void 0),Ny=d([A("esri.rest.support.FullTextSearch")],Ny);const Yhe=Ny;var KV;const IZ=new He({count:"count",sum:"sum",min:"min",max:"max",avg:"avg",stddev:"stddev",var:"var",exceedslimit:"exceedslimit",percentile_cont:"percentile-continuous",percentile_disc:"percentile-discrete",EnvelopeAggregate:"envelope-aggregate",CentroidAggregate:"centroid-aggregate",ConvexHullAggregate:"convex-hull-aggregate"});let jc=KV=class extends te{constructor(t){super(t),this.maxPointCount=void 0,this.maxRecordCount=void 0,this.maxVertexCount=void 0,this.onStatisticField=null,this.outStatisticFieldName=null,this.statisticType=null,this.statisticParameters=null}writeStatisticParameters(t,e){this.statisticType!=="percentile-continuous"&&this.statisticType!=="percentile-discrete"||(e.statisticParameters=U(t))}clone(){return new KV({maxPointCount:this.maxPointCount,maxRecordCount:this.maxRecordCount,maxVertexCount:this.maxVertexCount,onStatisticField:this.onStatisticField,outStatisticFieldName:this.outStatisticFieldName,statisticType:this.statisticType,statisticParameters:U(this.statisticParameters)})}};d([p({type:Number,json:{write:!0}})],jc.prototype,"maxPointCount",void 0),d([p({type:Number,json:{write:!0}})],jc.prototype,"maxRecordCount",void 0),d([p({type:Number,json:{write:!0}})],jc.prototype,"maxVertexCount",void 0),d([p({type:String,json:{write:!0}})],jc.prototype,"onStatisticField",void 0),d([p({type:String,json:{write:!0}})],jc.prototype,"outStatisticFieldName",void 0),d([p({type:String,json:{read:{source:"statisticType",reader:IZ.read},write:{target:"statisticType",writer:IZ.write}}})],jc.prototype,"statisticType",void 0),d([p({type:Object})],jc.prototype,"statisticParameters",void 0),d([ge("statisticParameters")],jc.prototype,"writeStatisticParameters",null),jc=KV=d([A("esri.rest.support.StatisticDefinition")],jc);const ize=jc;var Pw;const rze=new He({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"}),nze=new He({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});let Ue=Pw=class extends te{static from(t){return jv(Pw,t)}constructor(t){super(t),this.aggregateIds=null,this.cacheHint=void 0,this.compactGeometryEnabled=!1,this.datumTransformation=null,this.defaultSpatialReferenceEnabled=!1,this.distance=void 0,this.dynamicDataSource=void 0,this.formatOf3DObjects=null,this.fullText=null,this.gdbVersion=null,this.geometry=null,this.geometryPrecision=void 0,this.groupByFieldsForStatistics=null,this.having=null,this.historicMoment=null,this.maxAllowableOffset=void 0,this.maxRecordCountFactor=1,this.multipatchOption=null,this.num=void 0,this.objectIds=null,this.orderByFields=null,this.outFields=null,this.outSpatialReference=null,this.outStatistics=null,this.parameterValues=null,this.pixelSize=null,this.quantizationParameters=null,this.rangeValues=null,this.relationParameter=null,this.resultType=null,this.returnCentroid=!1,this.returnDistinctValues=!1,this.returnExceededLimitFeatures=!0,this.returnGeometry=!1,this.returnQueryGeometry=!1,this.returnM=void 0,this.returnZ=void 0,this.sourceSpatialReference=null,this.spatialRelationship="intersects",this.start=void 0,this.sqlFormat=null,this.text=null,this.timeExtent=null,this.timeReferenceUnknownClient=!1,this.units=null,this.where=null}castDatumTransformation(t){return typeof t=="number"||typeof t=="object"?t:null}writeHistoricMoment(t,e){e.historicMoment=t&&t.getTime()}writeParameterValues(t,e){if(t){const i={};for(const r in t){const n=t[r];Array.isArray(n)?i[r]=n.map(s=>s instanceof Date?s.getTime():s):n instanceof Date?i[r]=n.getTime():i[r]=n}e.parameterValues=i}}writeStart(t,e){e.resultOffset=this.start,e.resultRecordCount=this.num||10,e.where="1=1"}writeWhere(t,e){e.where=t||"1=1"}clone(){return new Pw(U({aggregateIds:this.aggregateIds,cacheHint:this.cacheHint,compactGeometryEnabled:this.compactGeometryEnabled,datumTransformation:this.datumTransformation,defaultSpatialReferenceEnabled:this.defaultSpatialReferenceEnabled,distance:this.distance,fullText:this.fullText,formatOf3DObjects:this.formatOf3DObjects,gdbVersion:this.gdbVersion,geometry:this.geometry,geometryPrecision:this.geometryPrecision,groupByFieldsForStatistics:this.groupByFieldsForStatistics,having:this.having,historicMoment:this.historicMoment!=null?new Date(this.historicMoment.getTime()):null,maxAllowableOffset:this.maxAllowableOffset,maxRecordCountFactor:this.maxRecordCountFactor,multipatchOption:this.multipatchOption,num:this.num,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,outStatistics:this.outStatistics,parameterValues:this.parameterValues,pixelSize:this.pixelSize,quantizationParameters:this.quantizationParameters,rangeValues:this.rangeValues,relationParameter:this.relationParameter,resultType:this.resultType,returnDistinctValues:this.returnDistinctValues,returnGeometry:this.returnGeometry,returnCentroid:this.returnCentroid,returnExceededLimitFeatures:this.returnExceededLimitFeatures,returnQueryGeometry:this.returnQueryGeometry,returnM:this.returnM,returnZ:this.returnZ,dynamicDataSource:this.dynamicDataSource,sourceSpatialReference:this.sourceSpatialReference,spatialRelationship:this.spatialRelationship,start:this.start,sqlFormat:this.sqlFormat,text:this.text,timeExtent:this.timeExtent,timeReferenceUnknownClient:this.timeReferenceUnknownClient,units:this.units,where:this.where}))}};Ue.MAX_MAX_RECORD_COUNT_FACTOR=5,d([p({json:{write:!0}})],Ue.prototype,"aggregateIds",void 0),d([p({type:Boolean,json:{write:!0}})],Ue.prototype,"cacheHint",void 0),d([p({type:Boolean,json:{default:!1,write:!0}})],Ue.prototype,"compactGeometryEnabled",void 0),d([p({json:{write:!0}})],Ue.prototype,"datumTransformation",void 0),d([tt("datumTransformation")],Ue.prototype,"castDatumTransformation",null),d([p({type:Boolean,json:{default:!1,write:!0}})],Ue.prototype,"defaultSpatialReferenceEnabled",void 0),d([p({type:Number,json:{write:{overridePolicy:t=>({enabled:t>0})}}})],Ue.prototype,"distance",void 0),d([p({type:nu,json:{write:!0}})],Ue.prototype,"dynamicDataSource",void 0),d([p({type:String,json:{write:!0}})],Ue.prototype,"formatOf3DObjects",void 0),d([p({type:[Yhe],json:{write:{enabled:!0,overridePolicy(){return{enabled:this.fullText!=null&&this.fullText.length>0}}}}})],Ue.prototype,"fullText",void 0),d([p({type:String,json:{write:!0}})],Ue.prototype,"gdbVersion",void 0),d([p({types:_g,json:{read:Vd,write:!0}})],Ue.prototype,"geometry",void 0),d([p({type:Number,json:{write:!0}})],Ue.prototype,"geometryPrecision",void 0),d([p({type:[String],json:{write:!0}})],Ue.prototype,"groupByFieldsForStatistics",void 0),d([p({type:String,json:{write:!0}})],Ue.prototype,"having",void 0),d([p({type:Date})],Ue.prototype,"historicMoment",void 0),d([ge("historicMoment")],Ue.prototype,"writeHistoricMoment",null),d([p({type:Number,json:{write:!0}})],Ue.prototype,"maxAllowableOffset",void 0),d([p({type:Number,cast:t=>t<1?1:t>Pw.MAX_MAX_RECORD_COUNT_FACTOR?Pw.MAX_MAX_RECORD_COUNT_FACTOR:t,json:{write:{overridePolicy:t=>({enabled:t>1})}}})],Ue.prototype,"maxRecordCountFactor",void 0),d([p({type:["xyFootprint"],json:{write:!0}})],Ue.prototype,"multipatchOption",void 0),d([p({type:Number,json:{read:{source:"resultRecordCount"}}})],Ue.prototype,"num",void 0),d([p({json:{write:!0}})],Ue.prototype,"objectIds",void 0),d([p({type:[String],json:{write:!0}})],Ue.prototype,"orderByFields",void 0),d([p({type:[String],json:{write:!0}})],Ue.prototype,"outFields",void 0),d([p({type:Ee,json:{name:"outSR",write:!0}})],Ue.prototype,"outSpatialReference",void 0),d([p({type:[ize],json:{write:{enabled:!0,overridePolicy(){return{enabled:this.outStatistics!=null&&this.outStatistics.length>0}}}}})],Ue.prototype,"outStatistics",void 0),d([p({json:{write:!0}})],Ue.prototype,"parameterValues",void 0),d([ge("parameterValues")],Ue.prototype,"writeParameterValues",null),d([p({type:fe,json:{write:!0}})],Ue.prototype,"pixelSize",void 0),d([p({type:Bue,json:{write:!0}})],Ue.prototype,"quantizationParameters",void 0),d([p({type:[Object],json:{write:!0}})],Ue.prototype,"rangeValues",void 0),d([p({type:String,json:{read:{source:"relationParam"},write:{target:"relationParam",overridePolicy(){return{enabled:this.spatialRelationship==="relation"}}}}})],Ue.prototype,"relationParameter",void 0),d([p({type:String,json:{write:!0}})],Ue.prototype,"resultType",void 0),d([p({type:Boolean,json:{default:!1,write:!0}})],Ue.prototype,"returnCentroid",void 0),d([p({type:Boolean,json:{default:!1,write:!0}})],Ue.prototype,"returnDistinctValues",void 0),d([p({type:Boolean,json:{default:!0,write:!0}})],Ue.prototype,"returnExceededLimitFeatures",void 0),d([p({type:Boolean,json:{write:!0}})],Ue.prototype,"returnGeometry",void 0),d([p({type:Boolean,json:{default:!1,write:!0}})],Ue.prototype,"returnQueryGeometry",void 0),d([p({type:Boolean,json:{default:!1,write:!0}})],Ue.prototype,"returnM",void 0),d([p({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],Ue.prototype,"returnZ",void 0),d([p({type:Ee,json:{write:!0}})],Ue.prototype,"sourceSpatialReference",void 0),d([xe(rze,{ignoreUnknown:!1,name:"spatialRel"})],Ue.prototype,"spatialRelationship",void 0),d([p({type:Number,json:{read:{source:"resultOffset"}}})],Ue.prototype,"start",void 0),d([ge("start"),ge("num")],Ue.prototype,"writeStart",null),d([p({type:String,json:{write:!0}})],Ue.prototype,"sqlFormat",void 0),d([p({type:String,json:{write:!0}})],Ue.prototype,"text",void 0),d([p({type:ku,json:{write:!0}})],Ue.prototype,"timeExtent",void 0),d([p({type:Boolean,json:{default:!1,write:!0}})],Ue.prototype,"timeReferenceUnknownClient",void 0),d([xe(nze,{ignoreUnknown:!1}),p({json:{write:{overridePolicy(t){return{enabled:!!t&&this.distance!=null&&this.distance>0}}}}})],Ue.prototype,"units",void 0),d([p({type:String,json:{write:{overridePolicy(t){return{enabled:t!=null||this.start!=null&&this.start>0}}}}})],Ue.prototype,"where",void 0),d([ge("where")],Ue.prototype,"writeWhere",null),Ue=Pw=d([A("esri.rest.support.Query")],Ue);const au=Ue;var XV;const p5=new He({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"}),f5=new He({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});let td=XV=class extends te{constructor(t){super(t),this.where=null,this.geometry=null,this.spatialRelationship="intersects",this.distance=void 0,this.objectIds=null,this.units=null,this.timeExtent=null}createQuery(t={}){const{where:e,geometry:i,spatialRelationship:r,timeExtent:n,objectIds:s,units:o,distance:a}=this;return new au({geometry:U(i),objectIds:U(s),spatialRelationship:r,timeExtent:U(n),where:e,units:o,distance:a,...t})}clone(){const{where:t,geometry:e,spatialRelationship:i,timeExtent:r,objectIds:n,units:s,distance:o}=this;return new XV({geometry:U(e),objectIds:U(n),spatialRelationship:i,timeExtent:U(r),where:t,units:s,distance:o})}};d([p({type:String,json:{write:!0}})],td.prototype,"where",void 0),d([p({types:_g,json:{write:!0}})],td.prototype,"geometry",void 0),d([p({type:p5.apiValues,json:{name:"spatialRel",read:{reader:p5.read},write:{allowNull:!1,writer:p5.write,overridePolicy(){return{enabled:this.geometry!=null}}}}})],td.prototype,"spatialRelationship",void 0),d([p({type:Number,json:{write:{overridePolicy(t){return{enabled:t!=null&&this.geometry!=null}}}}})],td.prototype,"distance",void 0),d([p({type:[Number],json:{write:!0}})],td.prototype,"objectIds",void 0),d([p({type:f5.apiValues,json:{read:f5.read,write:{writer:f5.write,overridePolicy(t){return{enabled:t!=null&&this.geometry!=null}}}}})],td.prototype,"units",void 0),d([p({type:ku,json:{write:!0}})],td.prototype,"timeExtent",void 0),td=XV=d([A("esri.layers.support.FeatureFilter")],td);const sze=td;var QV;const TZ={read:{reader:v9},write:{writer:_9,overridePolicy(){return{allowNull:this.excludedEffect!=null,isRequired:this.excludedEffect==null}}}},CZ={read:{reader:v9},write:{writer:_9,overridePolicy(){return{allowNull:this.includedEffect!=null,isRequired:this.includedEffect==null}}}},EZ={name:"showExcludedLabels",default:!0};let Vy=QV=class extends te{constructor(t){super(t),this.filter=null,this.includedEffect=null,this.excludedEffect=null,this.excludedLabelsVisible=!1}write(t,e){var r,n;const i=super.write(t,e);if(e!=null&&e.origin){if(i.filter){const s=Object.keys(i.filter);if(s.length>1||s[0]!=="where")return(r=e.messages)==null||r.push(new N("web-document-write:unsupported-feature-effect","Invalid feature effect 'filter'. A filter can only contain a 'where' property",{layer:e.layer,effect:this})),null}if("showExcludedLabels"in i)return(n=e.messages)==null||n.push(new N("web-document-write:unsupported-feature-effect","Invalid value for property 'excludedLabelsVisible' which should always be 'true'",{layer:e.layer,effect:this})),null}return i}clone(){return new QV({filter:this.filter!=null?this.filter.clone():null,includedEffect:this.includedEffect,excludedEffect:this.excludedEffect,excludedLabelsVisible:this.excludedLabelsVisible})}};d([p({type:sze,json:{write:{allowNull:!0,writer(t,e,i,r){const n=t==null?void 0:t.write({},r);n&&Object.keys(n).length!==0?ho(i,n,e):ho(i,null,e)}}}})],Vy.prototype,"filter",void 0),d([p({json:{write:!0,origins:{"web-map":TZ,"portal-item":TZ}}})],Vy.prototype,"includedEffect",void 0),d([p({json:{write:!0,origins:{"web-map":CZ,"portal-item":CZ}}})],Vy.prototype,"excludedEffect",void 0),d([p({type:Boolean,json:{write:!0,name:"showExcludedLabels",origins:{"web-map":EZ,"portal-item":EZ}}})],Vy.prototype,"excludedLabelsVisible",void 0),Vy=QV=d([A("esri.layers.support.FeatureEffect")],Vy);const oze=Vy,MZ={write:{allowNull:!0}},Khe=t=>{let e=class extends t{constructor(){super(...arguments),this.featureEffect=null}};return d([p({type:oze,json:{origins:{"web-map":MZ,"portal-item":MZ}}})],e.prototype,"featureEffect",void 0),e=d([A("esri.layers.mixins.FeatureEffectLayer")],e),e};let xb=class extends Li(te){constructor(e){super(e),this.expression=null,this.title=null,this.returnType=null}};d([p({type:String,json:{write:!0}})],xb.prototype,"expression",void 0),d([p({type:String,json:{write:!0}})],xb.prototype,"title",void 0),d([p({type:String,json:{write:!0}})],xb.prototype,"returnType",void 0),xb=d([A("esri.layers.support.ExpressionInfo")],xb);const w9=xb;var ez;let Sh=ez=class extends te{constructor(t){super(t),this.isAutoGenerated=!1,this.name=null,this.alias=null,this.onStatisticField=null,this.onStatisticExpression=null,this.statisticType=null}clone(){return new ez({name:this.name,alias:this.alias,isAutoGenerated:this.isAutoGenerated,onStatisticExpression:U(this.onStatisticExpression),onStatisticField:this.onStatisticField,statisticType:this.statisticType})}};d([p({type:Boolean,json:{write:!0}})],Sh.prototype,"isAutoGenerated",void 0),d([p({type:String,json:{write:!0}})],Sh.prototype,"name",void 0),d([p({type:String,json:{write:!0}})],Sh.prototype,"alias",void 0),d([p({type:String,json:{write:!0}})],Sh.prototype,"onStatisticField",void 0),d([p({type:w9,json:{write:!0}})],Sh.prototype,"onStatisticExpression",void 0),d([p({type:String,json:{write:!0}})],Sh.prototype,"statisticType",void 0),Sh=ez=d([A("esri.layers.support.AggregateField")],Sh);const kv=Sh;let Qm=class extends te{constructor(){super(...arguments),this.type=null}};d([p({type:["selection","cluster","binning"],readOnly:!0,json:{read:!1,write:!0}})],Qm.prototype,"type",void 0),Qm=d([A("esri.layers.support.FeatureReduction")],Qm);function aze(t){if(!t)return t;const{start:e,end:i}=t;return new ku({start:e!=null?sv(e,-e.getTimezoneOffset(),"minutes"):e,end:i!=null?sv(i,-i.getTimezoneOffset(),"minutes"):i})}function lze(t){if(!t)return t;const{start:e,end:i}=t;return new ku({start:e!=null?sv(e,e.getTimezoneOffset(),"minutes"):e,end:i!=null?sv(i,i.getTimezoneOffset(),"minutes"):i})}var tz;let n2=tz=class extends te{constructor(t){super(t)}async collectRequiredFields(t,e){return jo(t,e,this.expression)}clone(){return new tz({expression:this.expression,title:this.title})}equals(t){return this.expression===t.expression&&this.title===t.title}};d([p({type:String,json:{write:!0}})],n2.prototype,"expression",void 0),d([p({type:String,json:{write:!0}})],n2.prototype,"title",void 0),n2=tz=d([A("esri.layers.support.FeatureExpressionInfo")],n2);const $Z=n2;function Qbt(t){return!!t&&$C[t]!=null}function cze(t){return 1/($C[t]||1)}function uze(){const t=Object.keys($C);return t.sort(),t}const dze=uze();var iz;const eM=ln()({onTheGround:"on-the-ground",relativeToGround:"relative-to-ground",relativeToScene:"relative-to-scene",absoluteHeight:"absolute-height"}),AZ=new He({foot:"feet",kilometer:"kilometers",meter:"meters",mile:"miles","us-foot":"us-feet",yard:"yards"});let Ih=iz=class extends te{constructor(t){super(t),this.offset=null}readFeatureExpressionInfo(t,e){return t??(e.featureExpression&&e.featureExpression.value===0?{expression:"0"}:void 0)}writeFeatureExpressionInfo(t,e,i,r){e[i]=t.write({},r),t.expression==="0"&&(e.featureExpression={value:0})}get mode(){const{offset:t,featureExpressionInfo:e}=this;return this._isOverridden("mode")?this._get("mode"):t!=null||e?"relative-to-ground":"on-the-ground"}set mode(t){this._override("mode",t)}set unit(t){this._set("unit",t)}write(t,e){return this.offset||this.mode||this.featureExpressionInfo||this.unit?super.write(t,e):null}clone(){return new iz({mode:this.mode,offset:this.offset,featureExpressionInfo:this.featureExpressionInfo?this.featureExpressionInfo.clone():void 0,unit:this.unit})}equals(t){return this.mode===t.mode&&this.offset===t.offset&&this.unit===t.unit&&y1e(this.featureExpressionInfo,t.featureExpressionInfo)}};d([p({type:$Z,json:{write:!0}})],Ih.prototype,"featureExpressionInfo",void 0),d([ae("featureExpressionInfo",["featureExpressionInfo","featureExpression"])],Ih.prototype,"readFeatureExpressionInfo",null),d([ge("featureExpressionInfo",{featureExpressionInfo:{type:$Z},"featureExpression.value":{type:[0]}})],Ih.prototype,"writeFeatureExpressionInfo",null),d([p({type:eM.apiValues,nonNullable:!0,json:{type:eM.jsonValues,read:eM.read,write:{writer:eM.write,isRequired:!0}}})],Ih.prototype,"mode",null),d([p({type:Number,json:{write:!0}})],Ih.prototype,"offset",void 0),d([p({type:dze,json:{type:String,read:AZ.read,write:AZ.write}})],Ih.prototype,"unit",null),Ih=iz=d([A("esri.layers.support.ElevationInfo")],Ih);const Xhe=Ih,Qhe={type:Boolean,value:!0,json:{origins:{service:{read:!1,write:!1},"web-map":{read:!1,write:!1}},name:"screenSizePerspective",write:!0}},UL={type:Boolean,value:!0,json:{name:"disablePopup",read:{reader:(t,e)=>!e.disablePopup},write:{enabled:!0,writer(t,e,i){e[i]=!t}}}},GL={type:Boolean,value:!0,nonNullable:!0,json:{name:"showLabels",write:!0}},HL={type:String,json:{origins:{"portal-item":{write:!1}},write:{isRequired:!0,ignoreOrigin:!0,writer:Iv}}},x9={type:Boolean,value:!0,nonNullable:!0,json:{origins:{service:{read:{enabled:!1}}},name:"showLegend",write:!0}},epe={value:null,type:Xhe,json:{origins:{service:{name:"elevationInfo",write:!0}},name:"layerDefinition.elevationInfo",write:!0}};function ewt(t){return{type:t,readOnly:!0,json:{origins:{service:{read:!0}},read:!1}}}const tpe={write:!0,read:!0},MP={type:Number,json:{origins:{"web-document":tpe,"portal-item":{write:!0}}}},hze={...MP,json:{...MP.json,origins:{"web-document":{...tpe,write:{enabled:!0,target:{opacity:{type:Number},"layerDefinition.drawingInfo.transparency":{type:Number}}}}},read:{source:["layerDefinition.drawingInfo.transparency","drawingInfo.transparency"],reader:(t,e,i)=>i&&i.origin!=="service"||!e.drawingInfo||e.drawingInfo.transparency===void 0?e.layerDefinition&&e.layerDefinition.drawingInfo&&e.layerDefinition.drawingInfo.transparency!==void 0?WI(e.layerDefinition.drawingInfo.transparency):void 0:WI(e.drawingInfo.transparency)}}},pze={type:ku,readOnly:!0,get(){var a,l;if(!((a=this.layer)!=null&&a.timeInfo))return null;const{datesInUnknownTimezone:t,timeOffset:e,useViewTime:i}=this.layer,r=(l=this.view)==null?void 0:l.timeExtent;let n=this.layer.timeExtent;t&&(n=lze(n));let s=i?r&&n?r.intersection(n):r||n:n;if(!s||s.isEmpty||s.isAllTime)return s;e&&(s=s.offset(-e.value,e.unit)),t&&(s=aze(s));const o=this._get("timeExtent");return s.equals(o)?o:s}},twt={type:Re,readOnly:!0,json:{origins:{service:{read:{source:["fullExtent","spatialReference"],reader:(t,e)=>{const i=Re.fromJSON(t);return e.spatialReference!=null&&typeof e.spatialReference=="object"&&(i.spatialReference=Ee.fromJSON(e.spatialReference)),i}}}},read:!1}},ipe={type:String,json:{origins:{service:{read:!1},"portal-item":{read:!1}}}},fze={type:Number,json:{origins:{service:{write:{enabled:!1}}},read:{source:"layerDefinition.minScale"},write:{target:"layerDefinition.minScale"}}},mze={type:Number,json:{origins:{service:{write:{enabled:!1}}},read:{source:"layerDefinition.maxScale"},write:{target:"layerDefinition.maxScale"}}},rpe={json:{write:{ignoreOrigin:!0},origins:{"web-map":{read:!1,write:!1}}}};async function gze(t,e){const{WhereClause:i}=await W(()=>import("./WhereClause-0a50ffa9.js").then(r=>r.W),[],import.meta.url);return i.create(t,e)}function npe(t,e){return t!=null?e!=null?`(${t}) AND (${e})`:t:e}var rz;let rs=rz=class extends te{constructor(t){super(t),this.attachmentTypes=null,this.attachmentsWhere=null,this.cacheHint=void 0,this.keywords=null,this.globalIds=null,this.name=null,this.num=null,this.objectIds=null,this.returnMetadata=!1,this.size=null,this.start=null,this.where=null}writeStart(t,e){e.resultOffset=this.start,e.resultRecordCount=this.num||10}clone(){return new rz(U({attachmentTypes:this.attachmentTypes,attachmentsWhere:this.attachmentsWhere,cacheHint:this.cacheHint,keywords:this.keywords,where:this.where,globalIds:this.globalIds,name:this.name,num:this.num,objectIds:this.objectIds,returnMetadata:this.returnMetadata,size:this.size,start:this.start}))}};d([p({type:[String],json:{write:!0}})],rs.prototype,"attachmentTypes",void 0),d([p({type:String,json:{read:{source:"attachmentsDefinitionExpression"},write:{target:"attachmentsDefinitionExpression"}}})],rs.prototype,"attachmentsWhere",void 0),d([p({type:Boolean,json:{write:!0}})],rs.prototype,"cacheHint",void 0),d([p({type:[String],json:{write:!0}})],rs.prototype,"keywords",void 0),d([p({type:[Number],json:{write:!0}})],rs.prototype,"globalIds",void 0),d([p({json:{write:!0}})],rs.prototype,"name",void 0),d([p({type:Number,json:{read:{source:"resultRecordCount"}}})],rs.prototype,"num",void 0),d([p({type:[Number],json:{write:!0}})],rs.prototype,"objectIds",void 0),d([p({type:Boolean,json:{default:!1,write:!0}})],rs.prototype,"returnMetadata",void 0),d([p({type:[Number],json:{write:!0}})],rs.prototype,"size",void 0),d([p({type:Number,json:{read:{source:"resultOffset"}}})],rs.prototype,"start",void 0),d([ge("start"),ge("num")],rs.prototype,"writeStart",null),d([p({type:String,json:{read:{source:"definitionExpression"},write:{target:"definitionExpression"}}})],rs.prototype,"where",void 0),rs=rz=d([A("esri.rest.support.AttachmentQuery")],rs),rs.from=lr(rs);const $P=rs;var nz;let pr=nz=class extends te{constructor(t){super(t),this.cacheHint=void 0,this.dynamicDataSource=void 0,this.gdbVersion=null,this.geometryPrecision=void 0,this.historicMoment=null,this.maxAllowableOffset=void 0,this.objectIds=null,this.orderByFields=null,this.outFields=null,this.outSpatialReference=null,this.relationshipId=void 0,this.start=void 0,this.num=void 0,this.returnGeometry=!1,this.returnM=void 0,this.returnZ=void 0,this.where=null}_writeHistoricMoment(t,e){e.historicMoment=t&&t.getTime()}writeStart(t,e){e.resultOffset=this.start,e.resultRecordCount=this.num||10,this.start>0&&this.where==null&&(e.definitionExpression="1=1")}clone(){return new nz(U({cacheHint:this.cacheHint,dynamicDataSource:this.dynamicDataSource,gdbVersion:this.gdbVersion,geometryPrecision:this.geometryPrecision,historicMoment:this.historicMoment&&new Date(this.historicMoment.getTime()),maxAllowableOffset:this.maxAllowableOffset,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,relationshipId:this.relationshipId,start:this.start,num:this.num,returnGeometry:this.returnGeometry,where:this.where,returnZ:this.returnZ,returnM:this.returnM}))}};d([p({type:Boolean,json:{write:!0}})],pr.prototype,"cacheHint",void 0),d([p({type:nu,json:{write:!0}})],pr.prototype,"dynamicDataSource",void 0),d([p({type:String,json:{write:!0}})],pr.prototype,"gdbVersion",void 0),d([p({type:Number,json:{write:!0}})],pr.prototype,"geometryPrecision",void 0),d([p({type:Date})],pr.prototype,"historicMoment",void 0),d([ge("historicMoment")],pr.prototype,"_writeHistoricMoment",null),d([p({type:Number,json:{write:!0}})],pr.prototype,"maxAllowableOffset",void 0),d([p({type:[Number],json:{write:!0}})],pr.prototype,"objectIds",void 0),d([p({type:[String],json:{write:!0}})],pr.prototype,"orderByFields",void 0),d([p({type:[String],json:{write:!0}})],pr.prototype,"outFields",void 0),d([p({type:Ee,json:{read:{source:"outSR"},write:{target:"outSR"}}})],pr.prototype,"outSpatialReference",void 0),d([p({json:{write:!0}})],pr.prototype,"relationshipId",void 0),d([p({type:Number,json:{read:{source:"resultOffset"}}})],pr.prototype,"start",void 0),d([ge("start"),ge("num")],pr.prototype,"writeStart",null),d([p({type:Number,json:{read:{source:"resultRecordCount"}}})],pr.prototype,"num",void 0),d([p({json:{write:!0}})],pr.prototype,"returnGeometry",void 0),d([p({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],pr.prototype,"returnM",void 0),d([p({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],pr.prototype,"returnZ",void 0),d([p({type:String,json:{read:{source:"definitionExpression"},write:{target:"definitionExpression"}}})],pr.prototype,"where",void 0),pr=nz=d([A("esri.rest.support.RelationshipQuery")],pr),pr.from=lr(pr);const gT=pr,iwt=Object.freeze(Object.defineProperty({__proto__:null,default:gT},Symbol.toStringTag,{value:"Module"})),sz=new He({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"});async function yze(t,e,i,r){const n=await $g(t);if(await S9(t,e,r),!n.addAttachment)throw new N(r,"Layer source does not support addAttachment capability");return n.addAttachment(e,i)}function S9(t,e,i){const{attributes:r}=e,{objectIdField:n}=t;return t.get("capabilities.data.supportsAttachment")?e?r?n&&r[n]?Promise.resolve():Promise.reject(new N(i,`feature is missing the identifying attribute ${n}`)):Promise.reject(new N(i,"'attributes' are required on a feature to query attachments")):Promise.reject(new N(i,"A feature is required to add/delete/update attachments")):Promise.reject(new N(i,"this layer doesn't support attachments"))}async function vze(t,e,i,r,n){const s=await $g(t);if(await S9(t,e,n),!s.updateAttachment)throw new N(n,"Layer source does not support updateAttachment capability");return s.updateAttachment(e,i,r)}async function _ze(t,e,i){const{applyEdits:r}=await W(()=>import("./editingSupport-5d352845.js"),[],import.meta.url),n=await t.load();return r(n,n.source,e,i)}async function bze(t,e,i){const{uploadAssets:r}=await W(()=>import("./editingSupport-5d352845.js"),[],import.meta.url),n=await t.load();return r(n,n.source,e,i)}async function wze(t,e,i,r){const n=await $g(t);if(await S9(t,e,r),!n.deleteAttachments)throw new N(r,"Layer source does not support deleteAttachments capability");return n.deleteAttachments(e,i)}async function xze(t,e,i){const r=(await t.load({signal:e==null?void 0:e.signal})).source;if(!r.fetchRecomputedExtents)throw new N(i,"Layer source does not support fetchUpdates capability");return r.fetchRecomputedExtents(e)}async function Sze(t,e,i,r){var m,g;e=$P.from(e),await t.load();const n=t.source,s=t.capabilities;if(!((m=s==null?void 0:s.data)!=null&&m.supportsAttachment))throw new N(r,"this layer doesn't support attachments");const{attachmentTypes:o,objectIds:a,globalIds:l,num:c,size:u,start:h,where:f}=e;if(!((g=s==null?void 0:s.operations)!=null&&g.supportsQueryAttachments)&&((o==null?void 0:o.length)>0||(l==null?void 0:l.length)>0||(u==null?void 0:u.length)>0||c||h||f))throw new N(r,"when 'capabilities.operations.supportsQueryAttachments' is false, only objectIds is supported",e);if(!(a!=null&&a.length||l!=null&&l.length||f))throw new N(r,"'objectIds', 'globalIds', or 'where' are required to perform attachment query",e);if(!n.queryAttachments)throw new N(r,"Layer source does not support queryAttachments capability",e);return n.queryAttachments(e)}async function Ize(t,e,i,r){const n=await $g(t);if(!n.queryObjectIds)throw new N(r,"Layer source does not support queryObjectIds capability");return n.queryObjectIds(au.from(e)??t.createQuery(),i)}async function Tze(t,e,i,r){const n=await $g(t);if(!n.queryFeatureCount)throw new N(r,"Layer source does not support queryFeatureCount capability");return n.queryFeatureCount(au.from(e)??t.createQuery(),i)}async function Cze(t,e,i,r){const n=await $g(t);if(!n.queryExtent)throw new N(r,"Layer source does not support queryExtent capability");return n.queryExtent(au.from(e)??t.createQuery(),i)}async function Eze(t,e,i,r){const n=await $g(t);if(!n.queryRelatedFeatures)throw new N(r,"Layer source does not support queryRelatedFeatures capability");return n.queryRelatedFeatures(gT.from(e),i)}async function Mze(t,e,i,r){const n=await $g(t);if(!n.queryRelatedFeaturesCount)throw new N(r,"Layer source does not support queryRelatedFeaturesCount capability");return n.queryRelatedFeaturesCount(gT.from(e),i)}async function $ze(t){const e=t.source;if(e!=null&&e.refresh)try{const{dataChanged:i,updates:r}=await e.refresh();if(r!=null&&(t.sourceJSON={...t.sourceJSON,...r},t.read(r,{origin:"service",url:t.parsedUrl})),i)return!0}catch{}if(t.definitionExpression)try{return(await gze(t.definitionExpression,t.fieldsIndex)).hasDateFunctions}catch{}return!1}function Aze(t){const e=new au,i=t.get("capabilities.data"),r=t.get("capabilities.query");e.historicMoment=t.historicMoment,e.gdbVersion=t.gdbVersion,e.returnGeometry=!0,r&&(e.compactGeometryEnabled=r.supportsCompactGeometry,e.defaultSpatialReferenceEnabled=r.supportsDefaultSpatialReference),i&&(i.supportsZ&&t.returnZ!=null&&(e.returnZ=t.returnZ),i.supportsM&&t.returnM!=null&&(e.returnM=t.returnM)),e.outFields=["*"];const{timeOffset:n,timeExtent:s}=t;return e.timeExtent=n!=null&&s!=null?s.offset(-n.value,n.unit):s||null,e.multipatchOption=t.geometryType==="multipatch"?"xyFootprint":null,e}function spe(t){const{globalIdField:e,fields:i}=t;if(e)return e;if(i){for(const r of i)if(r.type==="esriFieldTypeGlobalID")return r.name}}function ope(t){const{objectIdField:e,fields:i}=t;if(e)return e;if(i){for(const r of i)if(r.type==="esriFieldTypeOID")return r.name}}function kze(t){return t.currentVersion?t.currentVersion:t.hasOwnProperty("capabilities")||t.hasOwnProperty("drawingInfo")||t.hasOwnProperty("hasAttachments")||t.hasOwnProperty("htmlPopupType")||t.hasOwnProperty("relationships")||t.hasOwnProperty("timeInfo")||t.hasOwnProperty("typeIdField")||t.hasOwnProperty("types")?10:9.3}async function $g(t){return(await t.load()).source}async function Pze(t,e){if(!vt||vt.findCredential(t))return;let i;try{const r=await IB(t,e);r&&(i=await vt.checkSignInStatus(`${r}/sharing`))}catch{}if(i)try{const r=e!=null?e.signal:null;await vt.getCredential(t,{signal:r})}catch{}}async function Oze(t,e){var r;const i=(r=t.parsedUrl)==null?void 0:r.path;i&&Lze(t)&&await Pze(i,e)}function Lze(t){const e=t.editFieldsInfo;return!(!(e!=null&&e.creatorField)&&!(e!=null&&e.editorField))||(t.userHasUpdateItemPrivileges?t.hasUpdateItemRestrictions:!!t.userHasFullEditingPrivileges&&t.hasFullEditingRestrictions)}function Rze(t){var e;return!((e=t.sourceJSON)!=null&&e.isMultiServicesView)&&(t.userHasUpdateItemPrivileges||t.editingEnabled)}const m5=L1({types:Tle});function I9(t,e){if(t.defaultSymbol)return t.types&&t.types.length?new tx({defaultSymbol:m5(t.defaultSymbol,t,e),field:t.typeIdField,uniqueValueInfos:t.types.map(i=>({id:i.id,symbol:m5(i.symbol,i,e)}))}):new RL({symbol:m5(t.defaultSymbol,t,e)})}const T9="__begin__",C9="__end__",Fze=new RegExp(T9,"ig"),Dze=new RegExp(C9,"ig"),kZ=new RegExp("^"+T9,"i"),PZ=new RegExp(C9+"$","i"),AP='"',Nze=AP+" + ",Vze=" + "+AP;function zze(t){return t.replaceAll(new RegExp("\\[","g"),"{").replaceAll(new RegExp("\\]","g"),"}")}function jze(t){return t.replaceAll(new RegExp("\\{","g"),"[").replaceAll(new RegExp("\\}","g"),"]")}function E9(t){const e={expression:"",type:"none"};return t.labelExpressionInfo?t.labelExpressionInfo.value?(e.expression=t.labelExpressionInfo.value,e.type="conventional"):t.labelExpressionInfo.expression&&(e.expression=t.labelExpressionInfo.expression,e.type="arcade"):t.labelExpression!=null&&(e.expression=zze(t.labelExpression),e.type="conventional"),e}function Bze(t){const e=E9(t);if(!e)return null;switch(e.type){case"conventional":return oz(e.expression);case"arcade":return e.expression}return null}function Uze(t){const e=E9(t);if(!e)return null;switch(e.type){case"conventional":return Hze(e.expression);case"arcade":return ape(e.expression)}return null}function oz(t){let e;return t?(e=oc(t,i=>T9+'$feature["'+i+'"]'+C9),e=kZ.test(e)?e.replace(kZ,""):AP+e,e=PZ.test(e)?e.replace(PZ,""):e+AP,e=e.replaceAll(Fze,Nze).replaceAll(Dze,Vze)):e='""',e}const Gze=/^\s*\{([^}]+)\}\s*$/i;function Hze(t){const e=t==null?void 0:t.match(Gze);return e&&e[1].trim()||null}const qze=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])([\w\s]+)(\2)\]));?\s*$/i,Wze=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])([\w\s]+)(\2)\]));?\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(\1|\3)(\5)\s*\));?\s*$/i,Jze=/^\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])([\w\s]+)(\1)\s*\));?\s*$/i;function ape(t){if(!t)return null;let e=qze.exec(t)||Wze.exec(t);return e?e[1]||e[3]:(e=Jze.exec(t),e?e[2]:null)}var az;let Pf=az=class extends te{constructor(){super(...arguments),this.expression=null,this.title=null,this.value=null}readExpression(t,e){return e.value?oz(e.value):t}writeExpression(t,e,i){this.value!=null&&(t=oz(this.value)),t!=null&&(e[i]=t)}clone(){return new az({expression:this.expression,title:this.title,value:this.value})}};d([p({type:String,json:{write:{writerEnsuresNonNull:!0}}})],Pf.prototype,"expression",void 0),d([ae("expression",["expression","value"])],Pf.prototype,"readExpression",null),d([ge("expression")],Pf.prototype,"writeExpression",null),d([p({type:String,json:{write:!0,origins:{"web-scene":{write:!1}}}})],Pf.prototype,"title",void 0),d([p({json:{read:!1,write:!1}})],Pf.prototype,"value",void 0),Pf=az=d([A("esri.layers.support.LabelExpressionInfo")],Pf);const lpe=Pf,Zze=ms.fromJSON($he),Yze=Yn.fromJSON(Ahe),Kze=hc.fromJSON(khe),Xze=Gv.fromJSON(cVe);function rwt(t){if(t==null)return null;switch(t.type){case"mesh":return null;case"point":case"multipoint":return Zze;case"polyline":return Yze;case"polygon":case"extent":return Kze}return null}const nwt=ms.fromJSON(uVe),swt=Yn.fromJSON(dVe),owt=hc.fromJSON(hVe);var lz;const tM=new He({esriServerPointLabelPlacementAboveCenter:"above-center",esriServerPointLabelPlacementAboveLeft:"above-left",esriServerPointLabelPlacementAboveRight:"above-right",esriServerPointLabelPlacementBelowCenter:"below-center",esriServerPointLabelPlacementBelowLeft:"below-left",esriServerPointLabelPlacementBelowRight:"below-right",esriServerPointLabelPlacementCenterCenter:"center-center",esriServerPointLabelPlacementCenterLeft:"center-left",esriServerPointLabelPlacementCenterRight:"center-right",esriServerLinePlacementAboveAfter:"above-after",esriServerLinePlacementAboveAlong:"above-along",esriServerLinePlacementAboveBefore:"above-before",esriServerLinePlacementAboveStart:"above-start",esriServerLinePlacementAboveEnd:"above-end",esriServerLinePlacementBelowAfter:"below-after",esriServerLinePlacementBelowAlong:"below-along",esriServerLinePlacementBelowBefore:"below-before",esriServerLinePlacementBelowStart:"below-start",esriServerLinePlacementBelowEnd:"below-end",esriServerLinePlacementCenterAfter:"center-after",esriServerLinePlacementCenterAlong:"center-along",esriServerLinePlacementCenterBefore:"center-before",esriServerLinePlacementCenterStart:"center-start",esriServerLinePlacementCenterEnd:"center-end",esriServerPolygonPlacementAlwaysHorizontal:"always-horizontal"},{ignoreUnknown:!0});function iM(t,e,i){return{enabled:!yse(i==null?void 0:i.layer)}}function cpe(t){var e;return!t||t.origin!=="service"&&((e=t.layer)==null?void 0:e.type)!=="map-image"}function Qze(t){return(t==null?void 0:t.type)==="map-image"}function upe(t){var e,i;return!!Qze(t)&&!!((i=(e=t.capabilities)==null?void 0:e.exportMap)!=null&&i.supportsArcadeExpressionForLabeling)}function eje(t){return cpe(t)||upe(t==null?void 0:t.layer)}let Nr=lz=class extends te{static evaluateWhere(t,e){const i=(r,n,s)=>{switch(n){case"=":return r==s;case"<>":return r!=s;case">":return r>s;case">=":return r>=s;case"<":return r<s;case"<=":return r<=s}return!1};try{if(t==null)return!0;const r=t.split(" ");if(r.length===3)return i(e[r[0]],r[1],r[2]);if(r.length===7){const n=i(e[r[0]],r[1],r[2]),s=r[3],o=i(e[r[4]],r[5],r[6]);switch(s){case"AND":return n&&o;case"OR":return n||o}}return!1}catch{console.log("Error.: can't parse = "+t)}}constructor(t){super(t),this.type="label",this.name=null,this.allowOverrun=!1,this.deconflictionStrategy="static",this.labelExpression=null,this.labelExpressionInfo=null,this.labelPlacement=null,this.labelPosition="curved",this.maxScale=0,this.minScale=0,this.repeatLabel=!0,this.repeatLabelDistance=null,this.symbol=Xze,this.useCodedValues=void 0,this.where=null}readLabelExpression(t,e){const i=e.labelExpressionInfo;if(!i||!i.value&&!i.expression)return t}writeLabelExpression(t,e,i){if(this.labelExpressionInfo){if(this.labelExpressionInfo.value!=null)t=jze(this.labelExpressionInfo.value);else if(this.labelExpressionInfo.expression!=null){const r=ape(this.labelExpressionInfo.expression);r&&(t="["+r+"]")}}t!=null&&(e[i]=t)}writeLabelExpressionInfo(t,e,i,r){if(t==null&&this.labelExpression!=null&&cpe(r))t=new lpe({expression:this.getLabelExpressionArcade()});else if(!t)return;const n=t.toJSON(r);n.expression&&(e[i]=n)}writeMaxScale(t,e){(t||this.minScale)&&(e.maxScale=t)}writeMinScale(t,e){(t||this.maxScale)&&(e.minScale=t)}getLabelExpression(){return E9(this)}getLabelExpressionArcade(){return Bze(this)}getLabelExpressionSingleField(){return Uze(this)}hash(){return JSON.stringify(this)}clone(){return new lz({allowOverrun:this.allowOverrun,deconflictionStrategy:this.deconflictionStrategy,labelExpression:this.labelExpression,labelExpressionInfo:U(this.labelExpressionInfo),labelPosition:this.labelPosition,labelPlacement:this.labelPlacement,maxScale:this.maxScale,minScale:this.minScale,name:this.name,repeatLabel:this.repeatLabel,repeatLabelDistance:this.repeatLabelDistance,symbol:U(this.symbol),where:this.where,useCodedValues:this.useCodedValues})}};d([p({type:String,json:{write:!0}})],Nr.prototype,"name",void 0),d([p({type:Boolean,json:{write:!0,default:!1,origins:{"web-scene":{write:!1},"portal-item":{default:!1,write:{overridePolicy:iM}}}}})],Nr.prototype,"allowOverrun",void 0),d([p({type:String,json:{write:!0,default:"static",origins:{"web-scene":{write:!1},"portal-item":{default:"static",write:{overridePolicy:iM}}}}})],Nr.prototype,"deconflictionStrategy",void 0),d([p({type:String,json:{write:{overridePolicy(t,e,i){return this.labelExpressionInfo&&(i==null?void 0:i.origin)==="service"&&upe(i.layer)?{enabled:!1}:{allowNull:!0}}}}})],Nr.prototype,"labelExpression",void 0),d([ae("labelExpression")],Nr.prototype,"readLabelExpression",null),d([ge("labelExpression")],Nr.prototype,"writeLabelExpression",null),d([p({type:lpe,json:{write:{overridePolicy:(t,e,i)=>eje(i)?{allowNull:!0}:{enabled:!1}}}})],Nr.prototype,"labelExpressionInfo",void 0),d([ge("labelExpressionInfo")],Nr.prototype,"writeLabelExpressionInfo",null),d([p({type:tM.apiValues,json:{type:tM.jsonValues,read:tM.read,write:tM.write}})],Nr.prototype,"labelPlacement",void 0),d([p({type:["curved","parallel"],json:{write:!0,origins:{"web-map":{write:!1},"web-scene":{write:!1},"portal-item":{write:!1}}}})],Nr.prototype,"labelPosition",void 0),d([p({type:Number})],Nr.prototype,"maxScale",void 0),d([ge("maxScale")],Nr.prototype,"writeMaxScale",null),d([p({type:Number})],Nr.prototype,"minScale",void 0),d([ge("minScale")],Nr.prototype,"writeMinScale",null),d([p({type:Boolean,json:{write:!0,origins:{"web-scene":{write:!1},"portal-item":{write:{overridePolicy:iM}}}}})],Nr.prototype,"repeatLabel",void 0),d([p({type:Number,cast:$t,json:{write:!0,origins:{"web-scene":{write:!1},"portal-item":{write:{overridePolicy:iM}}}}})],Nr.prototype,"repeatLabelDistance",void 0),d([p({types:ZAe,json:{origins:{"web-scene":{types:YAe,write:rZ,default:null}},write:rZ,default:null}})],Nr.prototype,"symbol",void 0),d([p({type:Boolean,json:{write:!0}})],Nr.prototype,"useCodedValues",void 0),d([p({type:String,json:{write:!0}})],Nr.prototype,"where",void 0),Nr=lz=d([A("esri.layers.support.LabelClass")],Nr);const Zv=Nr;var cz;const tje="esri.layers.support.FeatureReductionBinning";let Io=cz=class extends Qm{constructor(t){super(t),this.type="binning",this.binType="geohash",this.fixedBinLevel=3,this.labelingInfo=null,this.labelsVisible=!0,this.maxScale=0,this.popupEnabled=!0,this.popupTemplate=null,this.fields=[],this.renderer=null}writeFields(t,e,i){const r=t.filter(n=>n.statisticType!=="avg_angle").map(n=>n.toJSON());ho(i,r,e)}readRenderer(t,e,i){var n;const r=(n=e.drawingInfo)==null?void 0:n.renderer;return r?mT(r,e,i)??void 0:I9(e,i)}clone(){return new cz({fields:U(this.fields),fixedBinLevel:this.fixedBinLevel,labelingInfo:U(this.labelingInfo),labelsVisible:this.labelsVisible,maxScale:this.maxScale,popupEnabled:this.popupEnabled,popupTemplate:U(this.popupTemplate),renderer:U(this.renderer)})}};d([xe({binning:"binning"})],Io.prototype,"type",void 0),d([xe({geohash:"geohash"})],Io.prototype,"binType",void 0),d([p({type:Number,range:{min:1,max:9},json:{write:!0}})],Io.prototype,"fixedBinLevel",void 0),d([p({type:[Zv],json:{read:{source:"drawingInfo.labelingInfo"},write:{target:"drawingInfo.labelingInfo"}}})],Io.prototype,"labelingInfo",void 0),d([p(GL)],Io.prototype,"labelsVisible",void 0),d([p({type:Number,json:{default:0,name:"visibilityInfo.maxScale"}})],Io.prototype,"maxScale",void 0),d([p(UL)],Io.prototype,"popupEnabled",void 0),d([p({type:Mp,json:{name:"popupInfo",write:!0}})],Io.prototype,"popupTemplate",void 0),d([p({type:[kv],json:{write:!0}})],Io.prototype,"fields",void 0),d([ge("fields")],Io.prototype,"writeFields",null),d([p({types:kC,json:{write:{target:"drawingInfo.renderer"}}})],Io.prototype,"renderer",void 0),d([ae("renderer",["drawingInfo.renderer"])],Io.prototype,"readRenderer",null),Io=cz=d([A(tje)],Io);const dpe=Io;var uz;const ije="esri.layers.support.FeatureReductionCluster";function OZ(t){var e;return t.type==="simple"&&!((e=t.visualVariables)!=null&&e.length)}let yn=uz=class extends te{constructor(t){super(t),this.type="cluster",this.clusterRadius=$t("80px"),this.clusterMinSize=$t("12px"),this.clusterMaxSize=$t("50px"),this.maxScale=0,this.popupEnabled=!0,this.popupTemplate=null,this.renderer=null,this.symbol=null,this.labelingInfo=null,this.labelsVisible=!0,this.fields=null}readRenderer(t,e,i){var n,s;const r=(n=e.drawingInfo)==null?void 0:n.renderer;return(s=r==null?void 0:r.authoringInfo)!=null&&s.isAutoGenerated?null:r?OZ(r)?null:mT(r,e,i)??void 0:I9(e,i)}readSymbol(t,e,i){var n,s;const r=(n=e.drawingInfo)==null?void 0:n.renderer;if((s=r==null?void 0:r.authoringInfo)!=null&&s.isAutoGenerated)return null;if(r&&OZ(r)){const o=mT(r,e,i);return o==null?void 0:o.symbol}return null}writeSymbol(t,e,i,r){var s,o;const n=(o=(s=this.renderer)==null?void 0:s.authoringInfo)==null?void 0:o.isAutoGenerated;if(!this.renderer||n){const a=new RL({symbol:t});e.drawingInfo={renderer:a.write({},r)}}}writeFields(t,e,i){const r=t.filter(n=>n.statisticType!=="avg_angle").map(n=>n.toJSON());ho(i,r,e)}readFields(t,e,i){return t.filter(r=>!r.isAutoGenerated).map(r=>kv.fromJSON(r))}clone(){return new uz({clusterRadius:this.clusterRadius,clusterMinSize:this.clusterMinSize,clusterMaxSize:this.clusterMaxSize,labelingInfo:U(this.labelingInfo),labelsVisible:this.labelsVisible,fields:U(this.fields),maxScale:this.maxScale,renderer:U(this.renderer),symbol:U(this.symbol),popupEnabled:this.popupEnabled,popupTemplate:U(this.popupTemplate)})}};d([p({type:["cluster"],readOnly:!0,json:{write:!0}})],yn.prototype,"type",void 0),d([p({type:Number,cast:t=>t==="auto"?t:$t(t),json:{write:!0}})],yn.prototype,"clusterRadius",void 0),d([p({type:Number,cast:$t,json:{write:!0}})],yn.prototype,"clusterMinSize",void 0),d([p({type:Number,cast:$t,json:{write:!0}})],yn.prototype,"clusterMaxSize",void 0),d([p({type:Number,json:{default:0,name:"visibilityInfo.maxScale"}})],yn.prototype,"maxScale",void 0),d([p(UL)],yn.prototype,"popupEnabled",void 0),d([p({type:Mp,json:{read:{source:"popupInfo"},write:{target:"popupInfo"}}})],yn.prototype,"popupTemplate",void 0),d([p({types:kC,json:{write:{target:"drawingInfo.renderer"}}})],yn.prototype,"renderer",void 0),d([ae("renderer",["drawingInfo.renderer"])],yn.prototype,"readRenderer",null),d([p({types:WAe})],yn.prototype,"symbol",void 0),d([ae("symbol",["drawingInfo.renderer"])],yn.prototype,"readSymbol",null),d([ge("symbol")],yn.prototype,"writeSymbol",null),d([p({type:[Zv],json:{read:{source:"drawingInfo.labelingInfo"},write:{target:"drawingInfo.labelingInfo"}}})],yn.prototype,"labelingInfo",void 0),d([p(GL)],yn.prototype,"labelsVisible",void 0),d([p({type:[kv],json:{write:!0}})],yn.prototype,"fields",void 0),d([ge("fields")],yn.prototype,"writeFields",null),d([ae("fields")],yn.prototype,"readFields",null),yn=uz=d([A(ije)],yn);const hpe=yn;var dz;let xA=dz=class extends Qm{constructor(t){super(t),this.type="selection"}clone(){return new dz}};d([p({type:["selection"]})],xA.prototype,"type",void 0),xA=dz=d([A("esri.layers.support.FeatureReductionSelection")],xA);const LZ=xA,RZ={key:"type",base:Qm,typeMap:{cluster:hpe,binning:dpe}},rje={types:{key:"type",base:Qm,typeMap:{selection:LZ,cluster:hpe,binning:dpe}},json:{name:"layerDefinition.featureReduction",write:{allowNull:!0},origins:{"web-map":{types:RZ},"portal-item":{types:RZ},"web-scene":{types:{key:"type",base:Qm,typeMap:{selection:LZ}}}}}},__={Base64:0,Hex:1,String:2,Raw:3},Ow=8,ppe=(1<<Ow)-1;function Fm(t,e){const i=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(i>>16)<<16|65535&i}function nje(t){const e=[];for(let i=0,r=t.length*Ow;i<r;i+=Ow)e[i>>5]|=(t.charCodeAt(i/Ow)&ppe)<<i%32;return e}function sje(t){const e=[];for(let i=0,r=32*t.length;i<r;i+=Ow)e.push(String.fromCharCode(t[i>>5]>>>i%32&ppe));return e.join("")}function oje(t){const e="0123456789abcdef",i=[];for(let r=0,n=4*t.length;r<n;r++)i.push(e.charAt(t[r>>2]>>r%4*8+4&15)+e.charAt(t[r>>2]>>r%4*8&15));return i.join("")}function aje(t){const e="=",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=[];for(let n=0,s=4*t.length;n<s;n+=3){const o=(t[n>>2]>>n%4*8&255)<<16|(t[n+1>>2]>>(n+1)%4*8&255)<<8|t[n+2>>2]>>(n+2)%4*8&255;for(let a=0;a<4;a++)8*n+6*a>32*t.length?r.push(e):r.push(i.charAt(o>>6*(3-a)&63))}return r.join("")}function lje(t,e){return t<<e|t>>>32-e}function qL(t,e,i,r,n,s){return Fm(lje(Fm(Fm(e,t),Fm(r,s)),n),i)}function Fs(t,e,i,r,n,s,o){return qL(e&i|~e&r,t,e,n,s,o)}function Ds(t,e,i,r,n,s,o){return qL(e&r|i&~r,t,e,n,s,o)}function Ns(t,e,i,r,n,s,o){return qL(e^i^r,t,e,n,s,o)}function Vs(t,e,i,r,n,s,o){return qL(i^(e|~r),t,e,n,s,o)}function cje(t,e){t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;let i=1732584193,r=-271733879,n=-1732584194,s=271733878;for(let o=0;o<t.length;o+=16){const a=i,l=r,c=n,u=s;i=Fs(i,r,n,s,t[o],7,-680876936),s=Fs(s,i,r,n,t[o+1],12,-389564586),n=Fs(n,s,i,r,t[o+2],17,606105819),r=Fs(r,n,s,i,t[o+3],22,-1044525330),i=Fs(i,r,n,s,t[o+4],7,-176418897),s=Fs(s,i,r,n,t[o+5],12,1200080426),n=Fs(n,s,i,r,t[o+6],17,-1473231341),r=Fs(r,n,s,i,t[o+7],22,-45705983),i=Fs(i,r,n,s,t[o+8],7,1770035416),s=Fs(s,i,r,n,t[o+9],12,-1958414417),n=Fs(n,s,i,r,t[o+10],17,-42063),r=Fs(r,n,s,i,t[o+11],22,-1990404162),i=Fs(i,r,n,s,t[o+12],7,1804603682),s=Fs(s,i,r,n,t[o+13],12,-40341101),n=Fs(n,s,i,r,t[o+14],17,-1502002290),r=Fs(r,n,s,i,t[o+15],22,1236535329),i=Ds(i,r,n,s,t[o+1],5,-165796510),s=Ds(s,i,r,n,t[o+6],9,-1069501632),n=Ds(n,s,i,r,t[o+11],14,643717713),r=Ds(r,n,s,i,t[o],20,-373897302),i=Ds(i,r,n,s,t[o+5],5,-701558691),s=Ds(s,i,r,n,t[o+10],9,38016083),n=Ds(n,s,i,r,t[o+15],14,-660478335),r=Ds(r,n,s,i,t[o+4],20,-405537848),i=Ds(i,r,n,s,t[o+9],5,568446438),s=Ds(s,i,r,n,t[o+14],9,-1019803690),n=Ds(n,s,i,r,t[o+3],14,-187363961),r=Ds(r,n,s,i,t[o+8],20,1163531501),i=Ds(i,r,n,s,t[o+13],5,-1444681467),s=Ds(s,i,r,n,t[o+2],9,-51403784),n=Ds(n,s,i,r,t[o+7],14,1735328473),r=Ds(r,n,s,i,t[o+12],20,-1926607734),i=Ns(i,r,n,s,t[o+5],4,-378558),s=Ns(s,i,r,n,t[o+8],11,-2022574463),n=Ns(n,s,i,r,t[o+11],16,1839030562),r=Ns(r,n,s,i,t[o+14],23,-35309556),i=Ns(i,r,n,s,t[o+1],4,-1530992060),s=Ns(s,i,r,n,t[o+4],11,1272893353),n=Ns(n,s,i,r,t[o+7],16,-155497632),r=Ns(r,n,s,i,t[o+10],23,-1094730640),i=Ns(i,r,n,s,t[o+13],4,681279174),s=Ns(s,i,r,n,t[o],11,-358537222),n=Ns(n,s,i,r,t[o+3],16,-722521979),r=Ns(r,n,s,i,t[o+6],23,76029189),i=Ns(i,r,n,s,t[o+9],4,-640364487),s=Ns(s,i,r,n,t[o+12],11,-421815835),n=Ns(n,s,i,r,t[o+15],16,530742520),r=Ns(r,n,s,i,t[o+2],23,-995338651),i=Vs(i,r,n,s,t[o],6,-198630844),s=Vs(s,i,r,n,t[o+7],10,1126891415),n=Vs(n,s,i,r,t[o+14],15,-1416354905),r=Vs(r,n,s,i,t[o+5],21,-57434055),i=Vs(i,r,n,s,t[o+12],6,1700485571),s=Vs(s,i,r,n,t[o+3],10,-1894986606),n=Vs(n,s,i,r,t[o+10],15,-1051523),r=Vs(r,n,s,i,t[o+1],21,-2054922799),i=Vs(i,r,n,s,t[o+8],6,1873313359),s=Vs(s,i,r,n,t[o+15],10,-30611744),n=Vs(n,s,i,r,t[o+6],15,-1560198380),r=Vs(r,n,s,i,t[o+13],21,1309151649),i=Vs(i,r,n,s,t[o+4],6,-145523070),s=Vs(s,i,r,n,t[o+11],10,-1120210379),n=Vs(n,s,i,r,t[o+2],15,718787259),r=Vs(r,n,s,i,t[o+9],21,-343485551),i=Fm(i,a),r=Fm(r,l),n=Fm(n,c),s=Fm(s,u)}return[i,r,n,s]}function fpe(t,e=__.Hex){const i=e||__.Base64,r=cje(nje(t),t.length*Ow);switch(i){case __.Raw:return r;case __.Hex:return oje(r);case __.String:return sje(r);case __.Base64:return aje(r)}}var hz;let s2=hz=class extends Jv{writeLevels(t,e,i){for(const r in t){const n=this.levels[r];return void(e.stops=n)}}clone(){return new hz({axis:this.axis,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,maxDataValue:this.maxDataValue,maxSize:Rm(this.maxSize)?this.maxSize.clone():this.maxSize,minDataValue:this.minDataValue,minSize:Rm(this.minSize)?this.minSize.clone():this.minSize,normalizationField:this.normalizationField,stops:this.stops&&this.stops.map(t=>t.clone()),target:this.target,useSymbolValue:this.useSymbolValue,valueRepresentation:this.valueRepresentation,valueUnit:this.valueUnit,legendOptions:this.legendOptions&&this.legendOptions.clone(),levels:U(this.levels)})}};d([p()],s2.prototype,"levels",void 0),d([ge("levels")],s2.prototype,"writeLevels",null),s2=hz=d([A("esri.views.2d.engine.LevelDependentSizeVariable")],s2);const uje=ie.getLogger("esri.views.2d.layers.support.clusterUtils");ee.add("esri-cluster-arcade-enabled",!0);const dje=ee("esri-cluster-arcade-enabled"),hje=(t,e,i,r,n)=>{const s=e.clone();if(!fje(s))return s;if(s.authoringInfo||(s.authoringInfo=new EC),s.authoringInfo.isAutoGenerated=!0,"visualVariables"in s){const o=(s.visualVariables||[]).filter(l=>l.valueExpression!=="$view.scale"),a=mpe(o);o.forEach(l=>{l.type==="rotation"?l.field?l.field=jg(t,l.field,"avg_angle","number"):l.valueExpression&&(l.field=Rx(t,l.valueExpression,"avg_angle","number"),l.valueExpression=null):l.normalizationField?(l.field=jg(t,l.field,"avg_norm","number",l.normalizationField),l.normalizationField=null):l.field?l.field=jg(t,l.field,"avg","number"):l.valueExpression&&(l.field=Rx(t,l.valueExpression,"avg","number"),l.valueExpression=null)}),a==null&&!pje(o)&&n&&(o.push(gpe(i,r)),s.dynamicClusterSize=!0),s.visualVariables=o}switch(s.type){case"simple":break;case"pie-chart":for(const o of s.attributes)o.field?o.field=jg(t,o.field,"sum","number"):o.valueExpression&&(o.field=Rx(t,o.valueExpression,"sum","number"),o.valueExpression=null);break;case"unique-value":s.field?s.field=jg(t,s.field,"mode","string"):s.valueExpression&&(s.field=Rx(t,s.valueExpression,"mode","string"),s.valueExpression=null);break;case"class-breaks":s.normalizationField?(s.field=jg(t,s.field,"avg_norm","number",s.normalizationField),s.normalizationField=null):s.field?s.field=jg(t,s.field,"avg","number"):s.valueExpression&&(s.field=Rx(t,s.valueExpression,"avg","number"),s.valueExpression=null)}return s},mpe=t=>{for(const e of t)if(e.type==="size")return e;return null};function awt(t,e,i){const r=t.clone();let n=!1;if("visualVariables"in r){const s=(r.visualVariables||[]).filter(o=>o.valueExpression!=="$view.scale");mpe(s)==null&&(r.visualVariables||(r.visualVariables=[]),r.visualVariables.push(gpe(e,i)),r.dynamicClusterSize=!0,n=!0)}return{renderer:r,didInject:n}}const pje=t=>{for(const e of t)if(e.field==="cluster_count")return!0;return!1},gpe=(t,e)=>{const i=[new mb({value:0,size:0}),new mb({value:1})];if(e==null)return new Jv({field:"cluster_count",stops:[...i,new mb({value:2,size:0})]});const r=Object.keys(e).reduce((n,s)=>({...n,[s]:[...i,new mb({value:Math.max(2,e[s].minValue),size:t.clusterMinSize}),new mb({value:Math.max(3,e[s].maxValue),size:t.clusterMaxSize})]}),{});return new s2({field:"cluster_count",levels:r})},fje=t=>{const e=i=>uje.error(new N("Unsupported-renderer",i,{renderer:t}));if(!t)return!1;switch(t.type){case"unique-value":if(t.field2||t.field3)return e("FeatureReductionCluster does not support multi-field UniqueValueRenderers"),!1;break;case"class-breaks":if(t.normalizationField){const i=t.normalizationType;if(i!=="field")return e(`FeatureReductionCluster does not support a normalizationType of ${i}`),!1}break;case"simple":case"pie-chart":break;default:return e(`FeatureReductionCluster does not support renderers of type ${t.type}`),!1}if(!dje){if("valueExpression"in t&&t.valueExpression)return e("FeatureReductionCluster does not currently support renderer.valueExpression. Support will be added in a future release"),!1;if(("visualVariables"in t&&t.visualVariables||[]).some(i=>!(!("valueExpression"in i)||!i.valueExpression)))return e("FeatureReductionCluster does not currently support visualVariables with a valueExpression. Support will be added in a future release"),!1}return!0};function mje(t,e,i){switch(t){case"sum":return`cluster_sum_${e}`;case"avg":case"avg_angle":return`cluster_avg_${e}`;case"mode":return`cluster_type_${e}`;case"avg_norm":{const r=i,n="field",s=e.toLowerCase()+",norm:"+n+","+r.toLowerCase();return"cluster_avg_"+fpe(s)}}}function Rx(t,e,i,r){const n=fpe(e),s=i==="mode"?`cluster_type_${n}`:i==="sum"?`cluster_sum_${n}`:`cluster_avg_${n}`;return t.some(o=>o.name===s)||t.push(new kv({name:s,isAutoGenerated:!0,onStatisticExpression:new w9({expression:e,returnType:r}),statisticType:i})),s}function jg(t,e,i,r,n){if(e==="cluster_count"||t.some(o=>o.name===e))return e;const s=mje(i,e,n);return t.some(o=>o.name===s)||(i==="avg_norm"?t.push(new kv({name:s,isAutoGenerated:!0,onStatisticExpression:new w9({expression:`$feature.${e} / $feature.${n}`,returnType:r}),statisticType:"avg"})):t.push(new kv({name:s,isAutoGenerated:!0,onStatisticField:e,statisticType:i}))),s}const ype=t=>{let e=class extends t{constructor(...i){super(...i),this.own(this.watch("renderer",()=>{if(this.featureReduction){const r=this._normalizeFeatureReduction(this.featureReduction);this._set("featureReduction",r)}},!0))}set featureReduction(i){const r=this._normalizeFeatureReduction(i);this._set("featureReduction",r)}set renderer(i){}_normalizeFeatureReduction(i){var a;if((i==null?void 0:i.type)!=="cluster")return i;const r=i.clone(),n=[new kv({name:"cluster_count",isAutoGenerated:!0,statisticType:"count"})],s=(r.fields??[]).filter(l=>!l.isAutoGenerated);if(i.renderer&&!((a=i.renderer.authoringInfo)!=null&&a.isAutoGenerated))return r.fields=[...n,...s],r;if(i.symbol)return r.fields=[...n,...s],r.renderer=null,r;if(!this.renderer)return i;const o=hje(n,this.renderer,i,null,!1);return r.fields=[...n,...s],r.renderer=o,r}};return d([p(rje)],e.prototype,"featureReduction",null),e=d([A("esri.layers.mixins.FeatureReductionLayer")],e),e},FZ={ArcGISAnnotationLayer:!0,ArcGISDimensionLayer:!0,ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISImageServiceVectorLayer:!0,ArcGISMapServiceLayer:!0,ArcGISStreamLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BingMapsAerial:!0,BingMapsHybrid:!0,BingMapsRoad:!0,CSV:!0,GeoRSS:!0,GeoJSON:!0,GroupLayer:!0,KML:!0,MediaLayer:!0,OGCFeatureLayer:!0,OrientedImageryLayer:!0,SubtypeGroupLayer:!0,VectorTileLayer:!0,WFS:!0,WMS:!0,WebTiledLayer:!0},DZ={ArcGISImageServiceLayer:!0,ArcGISImageServiceVectorLayer:!0,ArcGISMapServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,OpenStreetMap:!0,VectorTileLayer:!0,WMS:!0,WebTiledLayer:!0,BingMapsAerial:!0,BingMapsRoad:!0,BingMapsHybrid:!0},NZ={ArcGISFeatureLayer:!0},gje={"web-scene/operational-layers":{ArcGISDimensionLayer:!0,ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISMapServiceLayer:!0,ArcGISSceneServiceLayer:!0,ArcGISTiledElevationServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BuildingSceneLayer:!0,GroupLayer:!0,IntegratedMeshLayer:!0,OGCFeatureLayer:!0,PointCloudLayer:!0,WebTiledLayer:!0,CSV:!0,GeoJSON:!0,VectorTileLayer:!0,WFS:!0,WMS:!0,KML:!0,RasterDataLayer:!0,Voxel:!0,LineOfSightLayer:!0},"web-scene/basemap":{ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,WebTiledLayer:!0,OpenStreetMap:!0,VectorTileLayer:!0,ArcGISImageServiceLayer:!0,WMS:!0,ArcGISMapServiceLayer:!0,ArcGISSceneServiceLayer:!0},"web-scene/ground":{ArcGISTiledElevationServiceLayer:!0,RasterDataElevationLayer:!0},"web-map/operational-layers":FZ,"web-map/basemap":DZ,"web-map/tables":NZ,"link-chart/operational-layers":{...FZ,LinkChartLayer:!0},"link-chart/basemap":DZ,"link-chart/tables":NZ,"portal-item/operational-layers":{ArcGISFeatureLayer:!0,ArcGISSceneServiceLayer:!0,PointCloudLayer:!0,BuildingSceneLayer:!0,IntegratedMeshLayer:!0,OrientedImageryLayer:!0}},M9=t=>{let e=class extends t{constructor(){super(...arguments),this.title=null}writeListMode(i,r,n,s){(s&&s.layerContainerType==="ground"||i&&cSe(this,n,{},s))&&(r[n]=i)}writeOperationalLayerType(i,r,n,s){!i||s&&s.layerContainerType==="tables"||(r.layerType=i)}writeTitle(i,r){r.title=i??"Layer"}read(i,r){r&&(r.layer=this),oSe(this,i,n=>super.read(i,n),r)}write(i,r){var o,a;if(r!=null&&r.origin){const l=`${r.origin}/${r.layerContainerType||"operational-layers"}`,c=gje[l];let u=!!(c!=null&&c[this.operationalLayerType]);if(this.operationalLayerType==="ArcGISTiledElevationServiceLayer"&&l==="web-scene/operational-layers"&&(u=!1),this.operationalLayerType==="ArcGISDimensionLayer"&&l==="web-map/operational-layers"&&(u=!1),!u)return(o=r.messages)==null||o.push(new N("layer:unsupported",`Layers (${this.title}, ${this.id}) of type '${this.declaredClass}' are not supported in the context of '${l}'`,{layer:this})),null}const n=super.write(i,{...r,layer:this}),s=!!r&&!!r.messages&&!!r.messages.filter(l=>l instanceof N&&l.name==="web-document-write:property-required").length;return JO(n==null?void 0:n.url)?((a=r==null?void 0:r.messages)==null||a.push(new N("layer:invalid-url",`Layer (${this.title}, ${this.id}) of type '${this.declaredClass}' using a Blob URL cannot be written to web scenes and web maps`,{layer:this})),null):!this.url&&s?null:n}beforeSave(){}};return d([p({type:String,json:{write:{ignoreOrigin:!0},origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0}},"portal-item":{write:!1}}}})],e.prototype,"id",void 0),d([p(rpe)],e.prototype,"listMode",void 0),d([ge("listMode")],e.prototype,"writeListMode",null),d([p({type:String,readOnly:!0,json:{read:!1,write:{target:"layerType",ignoreOrigin:!0},origins:{"portal-item":{write:!1}}}})],e.prototype,"operationalLayerType",void 0),d([ge("operationalLayerType")],e.prototype,"writeOperationalLayerType",null),d([p(MP)],e.prototype,"opacity",void 0),d([p({type:String,json:{write:{ignoreOrigin:!0,writerEnsuresNonNull:!0},origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0,writerEnsuresNonNull:!0}},"portal-item":{write:!1}}},value:"Layer"})],e.prototype,"title",void 0),d([ge("title"),ge(["web-scene"],"title")],e.prototype,"writeTitle",null),d([p({type:Boolean,json:{name:"visibility"}})],e.prototype,"visible",void 0),e=d([A("esri.layers.mixins.OperationalLayer")],e),e};var pz;const g5=new He({asc:"ascending",desc:"descending"});let Sb=pz=class extends te{constructor(t){super(t),this.field=null,this.valueExpression=null,this.order="ascending"}clone(){return new pz({field:this.field,valueExpression:this.valueExpression,order:this.order})}};d([p({type:String,json:{write:!0}})],Sb.prototype,"field",void 0),d([p({type:String,json:{write:!0}})],Sb.prototype,"valueExpression",void 0),d([p({type:g5.apiValues,json:{read:g5.read,write:g5.write}})],Sb.prototype,"order",void 0),Sb=pz=d([A("esri.layers.support.OrderByInfo")],Sb);const vpe=Sb;function yje(t,e,i){if(!t)return null;const r=t.find(s=>!!s.field);if(!r)return null;const n=new vpe;return n.read(r,i),[n]}function vje(t,e,i,r){const n=t.find(s=>!!s.field);n&&ho(i,[n.toJSON()],e)}const _pe=t=>{let e=class extends t{constructor(){super(...arguments),this.orderBy=null}};return d([p({type:[vpe],json:{origins:{"web-scene":{write:!1,read:!1}},read:{source:"layerDefinition.orderBy",reader:yje},write:{target:"layerDefinition.orderBy",writer:vje}}})],e.prototype,"orderBy",void 0),e=d([A("esri.layers.mixins.OrderedLayer")],e),e};async function _je(t){const e=t.spatialReference;if(e.isWGS84)return t.clone();if(e.isWebMercator)return j0(t);const i=Ee.WGS84;return await cg(e,i),Ir(t,i)}function lwt(t,e){if(!bpe(t,e)){const i=t.typeKeywords;i?i.push(e):t.typeKeywords=[e]}}function bpe(t,e){var i;return!!((i=t.typeKeywords)!=null&&i.includes(e))}function cwt(t){return bpe(t,bje.HOSTED_SERVICE)}function uwt(t,e){const i=t.typeKeywords;if(i){const r=i.indexOf(e);r>-1&&i.splice(r,1)}}async function dwt(t){const e=t.clone().normalize();let i;if(e.length>1)for(const r of e)i?r.width>i.width&&(i=r):i=r;else i=e[0];return _je(i)}const bje={DEVELOPER_BASEMAP:"DeveloperBasemap",JSAPI:"ArcGIS API for JavaScript",METADATA:"Metadata",MULTI_LAYER:"Multilayer",SINGLE_LAYER:"Singlelayer",TABLE:"Table",HOSTED_SERVICE:"Hosted Service"};function VZ(t){var l;const{portal:e,isOrgItem:i,itemControl:r}=t,n=(l=e.user)==null?void 0:l.privileges;let s=!n||n.includes("features:user:edit"),o=!!i&&!!(n!=null&&n.includes("features:user:fullEdit"));const a=r==="update"||r==="admin";return a?o=s=!0:o&&(s=!0),{features:{edit:s,fullEdit:o},content:{updateItem:a}}}const $9=t=>{let e=class extends t{constructor(){super(...arguments),this.resourceReferences={portalItem:null,paths:[]},this.userHasEditingPrivileges=!0,this.userHasFullEditingPrivileges=!1,this.userHasUpdateItemPrivileges=!1}destroy(){this.portalItem=je(this.portalItem),this.resourceReferences.portalItem=null,this.resourceReferences.paths.length=0}set portalItem(i){i!==this._get("portalItem")&&(this.removeOrigin("portal-item"),this._set("portalItem",i))}readPortalItem(i,r,n){if(r.itemId)return new J2({id:r.itemId,portal:n&&n.portal})}writePortalItem(i,r){i&&i.id&&(r.itemId=i.id)}async loadFromPortal(i,r){if(this.portalItem&&this.portalItem.id)try{const{load:n}=await W(()=>import("./layersLoader-58213128.js"),["./layersLoader-58213128.js","./fetchService-7b5fa001.js","./jsonContext-0bf4b056.js"],import.meta.url);return _t(r),await n({instance:this,supportedTypes:i.supportedTypes,validateItem:i.validateItem,supportsData:i.supportsData,layerModuleTypeMap:i.layerModuleTypeMap},r)}catch(n){throw ys(n)||ie.getLogger(this).warn(`Failed to load layer (${this.title}, ${this.id}) portal item (${this.portalItem.id})
  ${n}`),n}}async finishLoadEditablePortalLayer(i){this._set("userHasEditingPrivileges",await this._fetchUserHasEditingPrivileges(i).catch(r=>(Lo(r),!0)))}async _setUserPrivileges(i,r){if(!Lt.userPrivilegesApplied)return this.finishLoadEditablePortalLayer(r);if(this.url)try{const{features:{edit:n,fullEdit:s},content:{updateItem:o}}=await this._fetchUserPrivileges(i,r);this._set("userHasEditingPrivileges",n),this._set("userHasFullEditingPrivileges",s),this._set("userHasUpdateItemPrivileges",o)}catch(n){Lo(n)}}async _fetchUserPrivileges(i,r){let n=this.portalItem;if(!i||!n||!n.loaded||n.sourceUrl)return this._fetchFallbackUserPrivileges(r);const s=i===n.id;if(s&&n.portal.user)return VZ(n);let o,a;if(s)o=n.portal.url;else try{o=await IB(this.url,r)}catch(h){Lo(h)}if(!o||!DSe(o,n.portal.url))return this._fetchFallbackUserPrivileges(r);try{const h=r!=null?r.signal:null;a=await(vt==null?void 0:vt.getCredential(`${o}/sharing`,{prompt:!1,signal:h}))}catch(h){Lo(h)}const l=!0,c=!1,u=!1;if(!a)return{features:{edit:l,fullEdit:c},content:{updateItem:u}};try{if(s?await n.reload():(n=new J2({id:i,portal:{url:o}}),await n.load(r)),n.portal.user)return VZ(n)}catch(h){Lo(h)}return{features:{edit:l,fullEdit:c},content:{updateItem:u}}}async _fetchFallbackUserPrivileges(i){let r=!0;try{r=await this._fetchUserHasEditingPrivileges(i)}catch(n){Lo(n)}return{features:{edit:r,fullEdit:!1},content:{updateItem:!1}}}async _fetchUserHasEditingPrivileges(i){const r=this.url?vt==null?void 0:vt.findCredential(this.url):null;if(!r)return!0;const n=rM.credential===r?rM.user:await this._fetchEditingUser(i);return rM.credential=r,rM.user=n,n==null||n.privileges==null||n.privileges.includes("features:user:edit")}async _fetchEditingUser(i){var u,h;const r=(h=(u=this.portalItem)==null?void 0:u.portal)==null?void 0:h.user;if(r)return r;const n=vt.findServerInfo(this.url??"");if(!(n!=null&&n.owningSystemUrl))return null;const s=`${n.owningSystemUrl}/sharing/rest`,o=on.getDefault();if(o&&o.loaded&&ic(o.restUrl)===ic(s))return o.user;const a=`${s}/community/self`,l=i!=null?i.signal:null,c=await tC(at(a,{authMode:"no-prompt",query:{f:"json"},signal:l}));return c.ok?wB.fromJSON(c.value.data):null}read(i,r){r&&(r.layer=this),super.read(i,r)}write(i,r){const n=r&&r.portal,s=this.portalItem&&this.portalItem.id&&(this.portalItem.portal||on.getDefault());return n&&s&&!zne(s.restUrl,n.restUrl)?(r.messages&&r.messages.push(new N("layer:cross-portal",`The layer '${this.title} (${this.id})' cannot be persisted because it refers to an item on a different portal than the one being saved to. To save, set layer.portalItem to null or save to the same portal as the item associated with the layer`,{layer:this})),null):super.write(i,{...r,layer:this})}};return d([p({type:J2})],e.prototype,"portalItem",null),d([ae("web-document","portalItem",["itemId"])],e.prototype,"readPortalItem",null),d([ge("web-document","portalItem",{itemId:{type:String}})],e.prototype,"writePortalItem",null),d([p({clonable:!1})],e.prototype,"resourceReferences",void 0),d([p({type:Boolean,readOnly:!0})],e.prototype,"userHasEditingPrivileges",void 0),d([p({type:Boolean,readOnly:!0})],e.prototype,"userHasFullEditingPrivileges",void 0),d([p({type:Boolean,readOnly:!0})],e.prototype,"userHasUpdateItemPrivileges",void 0),e=d([A("esri.layers.mixins.PortalLayer")],e),e},rM={credential:null,user:null},yT=new ye,aI=new WeakMap;function wje(t){wpe(t)&&yT.push(t)}function xje(t){wpe(t)&&yT.includes(t)&&yT.remove(t)}function wpe(t){return t!=null&&typeof t=="object"&&"refreshInterval"in t&&"refresh"in t}function xpe(t,e){return Number.isFinite(t)&&Number.isFinite(e)?e<=0?t:xpe(e,t%e):0}let y5=0,nM=0;function Sje(){const t=Date.now();for(const e of yT)e.refreshInterval&&t-(aI.get(e)??0)+5>=6e4*e.refreshInterval&&(aI.set(e,t),e.refresh(t))}G6(()=>{const t=Date.now();let e=0;for(const i of yT)e=xpe(Math.round(6e4*i.refreshInterval),e),i.refreshInterval?aI.get(i)||aI.set(i,t):aI.delete(i);if(e!==nM){if(nM=e,clearInterval(y5),nM===0)return void(y5=0);y5=setInterval(Sje,nM)}});const A9=t=>{let e=class extends t{constructor(...i){super(...i),this.refreshInterval=0,this.refreshTimestamp=0,this._debounceHasDataChanged=Ad(()=>this.hasDataChanged()),this.when().then(()=>{this.destroyed||wje(this)},()=>{})}destroy(){xje(this)}get refreshParameters(){return{_ts:this.refreshTimestamp||null}}refresh(i=Date.now()){$d(this._debounceHasDataChanged()).then(r=>{r&&this._set("refreshTimestamp",i),this.emit("refresh",{dataChanged:r})},r=>{ie.getLogger(this).error(r),this.emit("refresh",{dataChanged:!1,error:r})})}async hasDataChanged(){return!0}};return d([p({type:Number,cast:i=>i>=.1?i:i<=0?0:.1,json:{write:!0}})],e.prototype,"refreshInterval",void 0),d([p({readOnly:!0})],e.prototype,"refreshTimestamp",void 0),d([p()],e.prototype,"refreshParameters",null),e=d([A("esri.layers.mixins.RefreshableLayer")],e),e},WL=t=>{let e=class extends t{constructor(){super(...arguments),this.minScale=0,this.maxScale=0}get effectiveScaleRange(){const i={minScale:this.minScale,maxScale:this.maxScale},r=this.parent;r&&"effectiveScaleRange"in r&&Ije(i,r.effectiveScaleRange);const n=this._get("effectiveScaleRange");return n&&n.minScale===i.minScale&&n.maxScale===i.maxScale?n:i}};return d([p({type:Number,nonNullable:!0,json:{write:!0}})],e.prototype,"minScale",void 0),d([p({type:Number,nonNullable:!0,json:{write:!0}})],e.prototype,"maxScale",void 0),d([p({readOnly:!0})],e.prototype,"effectiveScaleRange",null),e=d([A("esri.layers.mixins.ScaleRangeLayer")],e),e};function Ije(t,e){return t.minScale=t.minScale>0?e.minScale>0?Math.min(t.minScale,e.minScale):t.minScale:e.minScale,t.maxScale=t.maxScale>0?e.maxScale>0?Math.max(t.maxScale,e.maxScale):t.maxScale:e.maxScale,t}const Spe=ln()({esriTimeUnitsMilliseconds:"milliseconds",esriTimeUnitsSeconds:"seconds",esriTimeUnitsMinutes:"minutes",esriTimeUnitsHours:"hours",esriTimeUnitsDays:"days",esriTimeUnitsWeeks:"weeks",esriTimeUnitsMonths:"months",esriTimeUnitsYears:"years",esriTimeUnitsDecades:"decades",esriTimeUnitsCenturies:"centuries",esriTimeUnitsUnknown:void 0});let o2=class extends Li(te){constructor(e){super(e),this.unit="milliseconds",this.value=0}toMilliseconds(){return FLe(this.value,this.unit,"milliseconds")}};d([xe(Spe,{nonNullable:!0})],o2.prototype,"unit",void 0),d([p({type:Number,json:{write:!0},nonNullable:!0})],o2.prototype,"value",void 0),o2=d([A("esri.TimeInterval")],o2);const kP=o2;function zZ(t,e){return kP.fromJSON({value:t,unit:e})}let Ws=class extends Li(te){constructor(e){super(e),this.cumulative=!1,this.endField=null,this.fullTimeExtent=null,this.hasLiveData=!1,this.interval=null,this.startField=null,this.timeReference=null,this.trackIdField=null,this.useTime=!0}readFullTimeExtent(e,i){if(!i.timeExtent||!Array.isArray(i.timeExtent)||i.timeExtent.length!==2)return null;const r=new Date(i.timeExtent[0]),n=new Date(i.timeExtent[1]);return new ku({start:r,end:n})}writeFullTimeExtent(e,i){e&&e.start!=null&&e.end!=null?i.timeExtent=[e.start.getTime(),e.end.getTime()]:i.timeExtent=null}readInterval(e,i){return i.timeInterval&&i.timeIntervalUnits?zZ(i.timeInterval,i.timeIntervalUnits):i.defaultTimeInterval&&i.defaultTimeIntervalUnits?zZ(i.defaultTimeInterval,i.defaultTimeIntervalUnits):null}writeInterval(e,i){i.timeInterval=(e==null?void 0:e.toJSON().value)??null,i.timeIntervalUnits=(e==null?void 0:e.toJSON().unit)??null}};d([p({type:Boolean,json:{name:"exportOptions.timeDataCumulative",write:!0}})],Ws.prototype,"cumulative",void 0),d([p({type:String,json:{name:"endTimeField",write:{enabled:!0,allowNull:!0}}})],Ws.prototype,"endField",void 0),d([p({type:ku,json:{write:{enabled:!0,allowNull:!0}}})],Ws.prototype,"fullTimeExtent",void 0),d([ae("fullTimeExtent",["timeExtent"])],Ws.prototype,"readFullTimeExtent",null),d([ge("fullTimeExtent")],Ws.prototype,"writeFullTimeExtent",null),d([p({type:Boolean,json:{write:!0}})],Ws.prototype,"hasLiveData",void 0),d([p({type:kP,json:{write:{enabled:!0,allowNull:!0}}})],Ws.prototype,"interval",void 0),d([ae("interval",["timeInterval","timeIntervalUnits","defaultTimeInterval","defaultTimeIntervalUnits"])],Ws.prototype,"readInterval",null),d([ge("interval")],Ws.prototype,"writeInterval",null),d([p({type:String,json:{name:"startTimeField",write:{enabled:!0,allowNull:!0}}})],Ws.prototype,"startField",void 0),d([p({type:c1,json:{write:{enabled:!0,allowNull:!0}}})],Ws.prototype,"timeReference",void 0),d([p({type:String,json:{write:{enabled:!0,allowNull:!0}}})],Ws.prototype,"trackIdField",void 0),d([p({type:Boolean,json:{name:"exportOptions.useTime",write:!0}})],Ws.prototype,"useTime",void 0),Ws=d([A("esri.layers.support.TimeInfo")],Ws);const Ipe=Ws,k9=t=>{let e=class extends t{constructor(){super(...arguments),this.timeExtent=null,this.timeOffset=null,this.useViewTime=!0}readOffset(i,r){const n=r.timeInfo.exportOptions;if(!n)return null;const s=n.timeOffset,o=Spe.fromJSON(n.timeOffsetUnits);return s&&o?new kP({value:s,unit:o}):null}set timeInfo(i){GB(i,this.fieldsIndex),this._set("timeInfo",i)}};return d([p({type:ku,json:{write:!1}})],e.prototype,"timeExtent",void 0),d([p({type:kP})],e.prototype,"timeOffset",void 0),d([ae("service","timeOffset",["timeInfo.exportOptions"])],e.prototype,"readOffset",null),d([p({value:null,type:Ipe,json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],e.prototype,"timeInfo",null),d([p({type:Boolean,json:{read:{source:"timeAnimation"},write:{target:"timeAnimation"},origins:{"web-scene":{read:!1,write:!1}}}})],e.prototype,"useViewTime",void 0),e=d([A("esri.layers.mixins.TemporalLayer")],e),e},jZ=new He({esriFeatureEditToolAutoCompletePolygon:"auto-complete-polygon",esriFeatureEditToolCircle:"circle",esriFeatureEditToolEllipse:"ellipse",esriFeatureEditToolFreehand:"freehand",esriFeatureEditToolLine:"line",esriFeatureEditToolNone:"none",esriFeatureEditToolPoint:"point",esriFeatureEditToolPolygon:"polygon",esriFeatureEditToolRectangle:"rectangle",esriFeatureEditToolArrow:"arrow",esriFeatureEditToolTriangle:"triangle",esriFeatureEditToolLeftArrow:"left-arrow",esriFeatureEditToolRightArrow:"right-arrow",esriFeatureEditToolUpArrow:"up-arrow",esriFeatureEditToolDownArrow:"down-arrow"});let Of=class extends Li(te){constructor(e){super(e),this.name=null,this.description=null,this.drawingTool=null,this.prototype=null,this.thumbnail=null}};d([p({json:{write:!0}})],Of.prototype,"name",void 0),d([p({json:{write:!0}})],Of.prototype,"description",void 0),d([p({json:{read:jZ.read,write:jZ.write}})],Of.prototype,"drawingTool",void 0),d([p({json:{write:!0}})],Of.prototype,"prototype",void 0),d([p({json:{write:!0}})],Of.prototype,"thumbnail",void 0),Of=d([A("esri.layers.support.FeatureTemplate")],Of);const JL=Of;let Th=class extends Li(te){constructor(e){super(e),this.id=null,this.name=null,this.domains=null,this.templates=null}readDomains(e){const i={};for(const r of Object.keys(e))i[r]=VL(e[r]);return i}writeDomains(e,i){var n;const r={};for(const s of Object.keys(e))e[s]&&(r[s]=(n=e[s])==null?void 0:n.toJSON());i.domains=r}};d([p({json:{write:!0}})],Th.prototype,"id",void 0),d([p({json:{write:!0}})],Th.prototype,"name",void 0),d([p({json:{write:!0}})],Th.prototype,"domains",void 0),d([ae("domains")],Th.prototype,"readDomains",null),d([ge("domains")],Th.prototype,"writeDomains",null),d([p({type:[JL],json:{write:!0}})],Th.prototype,"templates",void 0),Th=d([A("esri.layers.support.FeatureType")],Th);const P9=Th;function Tpe(){return{fields:{type:[hu],value:null},fieldsIndex:{readOnly:!0,get(){return new ohe(this.fields||[])}},outFields:{type:[String],json:{read:!1},set:function(t){this._userOutFields=t,this.notifyChange("outFields")},get:function(){var e;const t=this._userOutFields;if(!t||!t.length)return null;if(t.includes("*"))return["*"];if(!this.fields)return t;for(const i of t)((e=this.fieldsIndex)==null?void 0:e.has(i))||ie.getLogger("esri.layers.support.fieldProperties").error("field-attributes-layer:invalid-field",`Invalid field ${i} found in outFields`,{layer:this,outFields:t});return iL(this.fieldsIndex,t)}}}}const v5=ie.getLogger("esri.layers.support.labelingInfo"),Tje=/\[([^\[\]]+)\]/gi;function fz(t,e,i){return t?t.map(r=>{const n=new Zv;if(n.read(r,i),n.labelExpression){const s=e.fields||e.layerDefinition&&e.layerDefinition.fields||this.fields;n.labelExpression=n.labelExpression.replaceAll(Tje,(o,a)=>`[${Cje(a,s)}]`)}return n}):null}function Cje(t,e){if(!e)return t;const i=t.toLowerCase();for(let r=0;r<e.length;r++){const n=e[r].name;if(n.toLowerCase()===i)return n}return t}const Eje={esriGeometryPoint:["above-right","above-center","above-left","center-center","center-left","center-right","below-center","below-left","below-right"],esriGeometryPolygon:["always-horizontal"],esriGeometryPolyline:["center-along"],esriGeometryMultipoint:null};function gwt(t,e){const i=U(t);return i.some(r=>Mje(r,e))?[]:i}function Mje(t,e){const i=t.labelPlacement,r=Eje[e];if(!t.symbol)return v5.warn("No ILabelClass symbol specified."),!0;if(!r)return v5.error(new N("labeling:unsupported-geometry-type",`Unable to create labels for layer, geometry type '${e}' is not supported`)),!0;if(!r.includes(i)){const n=r[0];i&&v5.warn(`Found invalid label placement type ${i} for ${e}. Defaulting to ${n}`),t.labelPlacement=n}return!1}function O9({displayField:t,editFieldsInfo:e,fields:i,objectIdField:r,title:n},s){if(!i)return null;const o=Pje({editFieldsInfo:e,fields:i,objectIdField:r},s);if(!o.length)return null;const a=Rje({titleBase:n,fields:i,displayField:t}),l=Lje();return new Mp({title:a,content:l,fieldInfos:o})}const $je=(t,e)=>e.visibleFieldNames?e.visibleFieldNames.has(t.name):Aoe(t,e);function Aje(t,e){const i=t;return e&&(t=t.filter(r=>!e.includes(r.type))),t===i&&(t=t.slice()),t.sort(kje),t}function kje(t,e){return t.type==="oid"?-1:e.type==="oid"?1:BZ(t)?-1:BZ(e)?1:(t.alias||t.name).toLocaleLowerCase().localeCompare((e.alias||e.name).toLocaleLowerCase())}function Pje(t,e){const i=e==null?void 0:e.visibleFieldNames;return Aje(t.fields??[],(e==null?void 0:e.ignoreFieldTypes)||Fje).map(r=>new lU({fieldName:r.name,isEditable:dEe(r,t),label:r.alias,format:Oje(r),visible:$je(r,{...t,visibleFieldNames:i})}))}function Oje(t){switch(t.type){case"small-integer":case"integer":case"single":return new sw({digitSeparator:!0,places:0});case"double":return new sw({digitSeparator:!0,places:2});case"date":return new sw({dateFormat:"long-month-day-year"});default:return t.type==="string"&&nN(t.name)?new sw({digitSeparator:!0,places:0}):null}}function Lje(){return[new QI,new XI]}function Rje(t){const e=HB(t),{titleBase:i}=t;return e?`${i}: {${e.trim()}}`:i??""}function BZ(t){return(t.name&&t.name.toLowerCase())==="name"?!0:(t.alias&&t.alias.toLowerCase())==="name"}const Fje=["geometry","blob","raster","guid","xml"],Dje=Tpe();let xt=class extends _pe(b9(ype(Khe(BL(k9(WL(A9(M9($9(FL(lC))))))))))){constructor(e){super(e),this.copyright=null,this.definitionExpression=null,this.displayField=null,this.editingEnabled=!1,this.elevationInfo=null,this.fields=null,this.fieldsIndex=null,this.fullExtent=null,this.geometryType=null,this.hasZ=void 0,this.labelsVisible=!0,this.labelingInfo=null,this.legendEnabled=!0,this.objectIdField=null,this.operationalLayerType="GeoJSON",this.popupEnabled=!0,this.popupTemplate=null,this.screenSizePerspectiveEnabled=!0,this.source=new Fy({layer:this}),this.spatialReference=Ee.WGS84,this.templates=null,this.title="GeoJSON",this.type="geojson",this.typeIdField=null,this.types=null}destroy(){var e;(e=this.source)==null||e.destroy()}load(e){const i=this.loadFromPortal({supportedTypes:["GeoJson"],supportsData:!1},e).catch(Lo).then(()=>this.source.load(e)).then(()=>{this.read(this.source.sourceJSON,{origin:"service",url:this.parsedUrl}),this.revert(["objectIdField","fields","timeInfo"],"service"),Jk(this.renderer,this.fieldsIndex),GB(this.timeInfo,this.fieldsIndex)});return this.addResolvingPromise(i),Promise.resolve(this)}get capabilities(){return this.source?this.source.capabilities:null}get createQueryVersion(){return this.commitProperty("definitionExpression"),this.commitProperty("timeExtent"),this.commitProperty("timeOffset"),this.commitProperty("geometryType"),this.commitProperty("capabilities"),(this._get("createQueryVersion")||0)+1}get defaultPopupTemplate(){return this.createPopupTemplate()}get isTable(){return this.loaded&&this.geometryType==null}get parsedUrl(){return this.url?sn(this.url):null}set renderer(e){Jk(e,this.fieldsIndex),this._set("renderer",e)}set url(e){if(!e)return void this._set("url",e);const i=sn(e);this._set("url",i.path),i.query&&(this.customParameters={...this.customParameters,...i.query})}async applyEdits(e,i){const{applyEdits:r}=await W(()=>import("./editingSupport-5d352845.js"),[],import.meta.url);await this.load();const n=await r(this,this.source,e,i);return this.read({extent:this.source.sourceJSON.extent,timeInfo:this.source.sourceJSON.timeInfo},{origin:"service",ignoreDefaults:!0}),n}on(e,i){return super.on(e,i)}createPopupTemplate(e){return O9(this,e)}createQuery(){const e=new au,i=this.get("capabilities.data");e.returnGeometry=!0,i&&i.supportsZ&&(e.returnZ=!0),e.outFields=["*"],e.where=this.definitionExpression||"1=1";const{timeOffset:r,timeExtent:n}=this;return e.timeExtent=r!=null&&n!=null?n.offset(-r.value,r.unit):n||null,e}getFieldDomain(e,i){let r,n=!1;const s=i&&i.feature,o=s&&s.attributes,a=this.typeIdField&&o&&o[this.typeIdField];return a!=null&&this.types&&(n=this.types.some(l=>l.id==a&&(r=l.domains&&l.domains[e],r&&r.type==="inherited"&&(r=this._getLayerDomain(e)),!0))),n||r||(r=this._getLayerDomain(e)),r}getField(e){return this.fieldsIndex.get(e)}queryFeatures(e,i){return this.load().then(()=>this.source.queryFeatures(au.from(e)||this.createQuery(),i)).then(r=>{if(r!=null&&r.features)for(const n of r.features)n.layer=n.sourceLayer=this;return r})}queryObjectIds(e,i){return this.load().then(()=>this.source.queryObjectIds(au.from(e)||this.createQuery(),i))}queryFeatureCount(e,i){return this.load().then(()=>this.source.queryFeatureCount(au.from(e)||this.createQuery(),i))}queryExtent(e,i){return this.load().then(()=>this.source.queryExtent(au.from(e)||this.createQuery(),i))}async hasDataChanged(){try{const{dataChanged:e,updates:i}=await this.source.refresh(this.customParameters);return i!=null&&this.read(i,{origin:"service",url:this.parsedUrl,ignoreDefaults:!0}),e}catch{}return!1}_getLayerDomain(e){if(!this.fields)return null;let i=null;return this.fields.some(r=>(r.name===e&&(i=r.domain),!!i)),i}};d([p({readOnly:!0,json:{read:!1,write:!1}})],xt.prototype,"capabilities",null),d([p({type:String})],xt.prototype,"copyright",void 0),d([p({readOnly:!0})],xt.prototype,"createQueryVersion",null),d([p({readOnly:!0})],xt.prototype,"defaultPopupTemplate",null),d([p({type:String,json:{name:"layerDefinition.definitionExpression",write:{enabled:!0,allowNull:!0}}})],xt.prototype,"definitionExpression",void 0),d([p({type:String})],xt.prototype,"displayField",void 0),d([p({type:Boolean})],xt.prototype,"editingEnabled",void 0),d([p(epe)],xt.prototype,"elevationInfo",void 0),d([p({type:[hu],json:{name:"layerDefinition.fields",write:{ignoreOrigin:!0,isRequired:!0},origins:{service:{name:"fields"}}}})],xt.prototype,"fields",void 0),d([p(Dje.fieldsIndex)],xt.prototype,"fieldsIndex",void 0),d([p({type:Re,json:{name:"extent"}})],xt.prototype,"fullExtent",void 0),d([p({type:["point","polygon","polyline","multipoint"],json:{read:{reader:zB.read}}})],xt.prototype,"geometryType",void 0),d([p({type:Boolean})],xt.prototype,"hasZ",void 0),d([p(ipe)],xt.prototype,"id",void 0),d([p({type:Boolean,readOnly:!0})],xt.prototype,"isTable",null),d([p(GL)],xt.prototype,"labelsVisible",void 0),d([p({type:[Zv],json:{name:"layerDefinition.drawingInfo.labelingInfo",read:{reader:fz},write:!0}})],xt.prototype,"labelingInfo",void 0),d([p(x9)],xt.prototype,"legendEnabled",void 0),d([p({type:["show","hide"]})],xt.prototype,"listMode",void 0),d([p({type:String,json:{name:"layerDefinition.objectIdField",write:{ignoreOrigin:!0,isRequired:!0},origins:{service:{name:"objectIdField"}}}})],xt.prototype,"objectIdField",void 0),d([p(MP)],xt.prototype,"opacity",void 0),d([p({type:["GeoJSON"]})],xt.prototype,"operationalLayerType",void 0),d([p({readOnly:!0})],xt.prototype,"parsedUrl",null),d([p(UL)],xt.prototype,"popupEnabled",void 0),d([p({type:Mp,json:{name:"popupInfo",write:!0}})],xt.prototype,"popupTemplate",void 0),d([p({types:kC,json:{name:"layerDefinition.drawingInfo.renderer",write:!0,origins:{service:{name:"drawingInfo.renderer"},"web-scene":{types:The}}}})],xt.prototype,"renderer",null),d([p(Qhe)],xt.prototype,"screenSizePerspectiveEnabled",void 0),d([p({readOnly:!0})],xt.prototype,"source",void 0),d([p({type:Ee})],xt.prototype,"spatialReference",void 0),d([p({type:[JL]})],xt.prototype,"templates",void 0),d([p()],xt.prototype,"title",void 0),d([p({json:{read:!1},readOnly:!0})],xt.prototype,"type",void 0),d([p({type:String,readOnly:!0})],xt.prototype,"typeIdField",void 0),d([p({type:[P9]})],xt.prototype,"types",void 0),d([p(HL)],xt.prototype,"url",null),xt=d([A("esri.layers.GeoJSONLayer")],xt);const L9=xt,vwt=Object.freeze(Object.defineProperty({__proto__:null,default:L9},Symbol.toStringTag,{value:"Module"})),Cpe=t=>{let e=class extends t{get title(){if(this._get("title")&&this.originOf("title")!=="defaults")return this._get("title");if(this.url){const i=op(this.url);if(i!=null&&i.title)return i.title}return this._get("title")||""}set title(i){this._set("title",i)}set url(i){this._set("url",NU(i,ie.getLogger(this)))}};return d([p()],e.prototype,"title",null),d([p({type:String})],e.prototype,"url",null),e=d([A("esri.layers.mixins.ArcGISService")],e),e};var mz;const sM=new He({flow_from:"flow-from",flow_to:"flow-to"});let Js=mz=class extends Cg(te){constructor(t){super(t),this.density=.8,this.color=new ce([255,255,255,1]),this.maxPathLength=200,this.trailWidth=1.5,this.flowSpeed=10,this.trailLength=100,this.smoothing=0,this.flowRepresentation="flow-from",this.type="flow",this.authoringInfo=null,this.legendOptions=null,this.trailCap="butt",this.background="none"}clone(){var m,g;const{density:t,maxPathLength:e,trailWidth:i,flowSpeed:r,trailLength:n,smoothing:s,flowRepresentation:o,trailCap:a,background:l}=this,c=this.color.clone(),u=(this.visualVariables||[]).map(y=>y.clone()),h=(m=this.authoringInfo)==null?void 0:m.clone(),f=(g=this.legendOptions)==null?void 0:g.clone();return new mz({density:t,color:c,maxPathLength:e,trailWidth:i,flowSpeed:r,trailLength:n,trailCap:a,background:l,smoothing:s,flowRepresentation:o,visualVariables:u,authoringInfo:h,legendOptions:f})}getSymbol(t,e){}async getSymbolAsync(t,e){}getSymbols(){return[]}};d([p({type:Number,json:{write:!0}})],Js.prototype,"density",void 0),d([p({type:ce,json:{write:{allowNull:!0}}})],Js.prototype,"color",void 0),d([p({type:Number,cast:$t,json:{write:!0}})],Js.prototype,"maxPathLength",void 0),d([p({type:Number,cast:$t,json:{write:!0}})],Js.prototype,"trailWidth",void 0),d([p({type:Number,json:{write:!0}})],Js.prototype,"flowSpeed",void 0),d([p({type:Number,json:{write:!0}})],Js.prototype,"trailLength",void 0),d([p({type:Number,cast:$t,json:{write:!1}})],Js.prototype,"smoothing",void 0),d([p({type:sM.apiValues,json:{type:sM.jsonValues,read:{reader:sM.read},write:{writer:sM.write}}})],Js.prototype,"flowRepresentation",void 0),d([xe({flowRenderer:"flow"})],Js.prototype,"type",void 0),d([p({type:EC,json:{write:!0}})],Js.prototype,"authoringInfo",void 0),d([p({type:lv,json:{write:!0}})],Js.prototype,"legendOptions",void 0),d([p({type:String,json:{write:!0}})],Js.prototype,"trailCap",void 0),d([p({type:String,json:{write:!0}})],Js.prototype,"background",void 0),Js=mz=d([A("esri.renderers.FlowRenderer")],Js);const Epe=Js;let Ib=class extends te{constructor(){super(...arguments),this.value=null,this.label=null,this.color=null}};d([p({type:Number,json:{write:!0}})],Ib.prototype,"value",void 0),d([p({type:String,json:{write:!0}})],Ib.prototype,"label",void 0),d([p({type:ce,json:{type:[wt],write:!0}})],Ib.prototype,"color",void 0),Ib=d([A("esri.renderers.support.ColormapInfo")],Ib);const Mpe=Ib;function Nje(t){return"r"in t&&"g"in t&&"b"in t}function $pe(t){return"h"in t&&"s"in t&&"v"in t}function Ape(t){return"l"in t&&"a"in t&&"b"in t}function kpe(t){return"l"in t&&"c"in t&&"h"in t}function Vje(t){return"x"in t&&"y"in t&&"z"in t}const zje=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],jje=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];function Ppe(t,e){const i=[];let r,n;if(t[0].length!==e.length)throw new Error("dimensions do not match");const s=t.length,o=t[0].length;let a=0;for(r=0;r<s;r++){for(a=0,n=0;n<o;n++)a+=t[r][n]*e[n];i.push(a)}return i}function Ope(t){const e=[t.r/255,t.g/255,t.b/255].map(r=>r<=.04045?r/12.92:((r+.055)/1.055)**2.4),i=Ppe(zje,e);return{x:100*i[0],y:100*i[1],z:100*i[2]}}function R9(t){const e=Ppe(jje,[t.x/100,t.y/100,t.z/100]).map(i=>{const r=i<=.0031308?12.92*i:1.055*i**.4166666666666667-.055;return Math.min(1,Math.max(r,0))});return{r:Math.round(255*e[0]),g:Math.round(255*e[1]),b:Math.round(255*e[2])}}function Lpe(t){const e=[t.x/95.047,t.y/100,t.z/108.883].map(i=>i>.008856451679035631?i**.3333333333333333:7.787037037037035*i+.13793103448275862);return{l:116*e[1]-16,a:500*(e[0]-e[1]),b:200*(e[1]-e[2])}}function Rpe(t){const e=t.l,i=[(e+16)/116+t.a/500,(e+16)/116,(e+16)/116-t.b/200].map(r=>r>6/29?r**3:3*(6/29)**2*(r-4/29));return{x:95.047*i[0],y:100*i[1],z:108.883*i[2]}}function Bje(t){const e=t.l,i=t.a,r=t.b,n=Math.sqrt(i*i+r*r);let s=Math.atan2(r,i);return s=s>0?s:s+2*Math.PI,{l:e,c:n,h:s}}function Uje(t){const e=t.l,i=t.c,r=t.h;return{l:e,a:i*Math.cos(r),b:i*Math.sin(r)}}function Gje(t){return Lpe(Ope(t))}function Hje(t){return R9(Rpe(t))}function qje(t){return Bje(Lpe(Ope(t)))}function Wje(t){return R9(Rpe(Uje(t)))}function Jje(t){const e=t.r,i=t.g,r=t.b,n=Math.max(e,i,r),s=n-Math.min(e,i,r);let o=n,a=s===0?0:n===e?(i-r)/s%6:n===i?(r-e)/s+2:(e-i)/s+4,l=s===0?0:s/o;return a<0&&(a+=6),a*=60,l*=100,o*=100/255,{h:a,s:l,v:o}}function Zje(t){const e=(t.h+360)%360/60,i=t.s/100,r=t.v/100*255,n=r*i,s=n*(1-Math.abs(e%2-1));let o;switch(Math.floor(e)){case 0:o={r:n,g:s,b:0};break;case 1:o={r:s,g:n,b:0};break;case 2:o={r:0,g:n,b:s};break;case 3:o={r:0,g:s,b:n};break;case 4:o={r:s,g:0,b:n};break;case 5:case 6:o={r:n,g:0,b:s};break;default:o={r:0,g:0,b:0}}return o.r=Math.round(o.r+r-n),o.g=Math.round(o.g+r-n),o.b=Math.round(o.b+r-n),o}function pg(t){return Nje(t)?t:kpe(t)?Wje(t):Ape(t)?Hje(t):Vje(t)?R9(t):$pe(t)?Zje(t):t}function Pv(t){return $pe(t)?t:Jje(pg(t))}function UZ(t){return Ape(t)?t:Gje(pg(t))}function GZ(t){return kpe(t)?t:qje(pg(t))}const Yje=["random","ndvi","ndvi2","ndvi3","elevation","gray","hillshade"],F9=[{id:"aspect",type:"multipart",colorRamps:[{fromColor:[190,190,190],toColor:[255,45,8]},{fromColor:[255,45,8],toColor:[255,181,61]},{fromColor:[255,181,61],toColor:[255,254,52]},{fromColor:[255,254,52],toColor:[0,251,50]},{fromColor:[0,251,50],toColor:[255,254,52]},{fromColor:[0,253,255],toColor:[0,181,255]},{fromColor:[0,181,255],toColor:[26,35,253]},{fromColor:[26,35,253],toColor:[255,57,251]},{fromColor:[255,57,251],toColor:[255,45,8]}]},{id:"black-to-white",fromColor:[0,0,0],toColor:[255,255,255]},{id:"blue-bright",fromColor:[204,204,255],toColor:[0,0,224]},{id:"blue-light-to-dark",fromColor:[211,229,232],toColor:[46,100,140]},{id:"blue-green-bright",fromColor:[203,245,234],toColor:[48,207,146]},{id:"blue-green-light-to-dark",fromColor:[216,242,237],toColor:[21,79,74]},{id:"brown-light-to-dark",fromColor:[240,236,170],toColor:[102,72,48]},{id:"brown-to-blue-green-diverging-right",type:"multipart",colorRamps:[{fromColor:[156,85,31],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[33,130,145]}]},{id:"brown-to-blue-green-diverging-dark",type:"multipart",colorRamps:[{fromColor:[110,70,45],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[48,100,102]}]},{id:"coefficient-bias",fromColor:[214,214,255],toColor:[0,57,148]},{id:"cold-to-hot-diverging",type:"multipart",colorRamps:[{fromColor:[69,117,181],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[214,47,39]}]},{id:"condition-number",type:"multipart",colorRamps:[{fromColor:[0,97,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,34,0]}]},{id:"cyan-to-purple",type:"multipart",colorRamps:[{fromColor:[0,245,245],toColor:[0,0,245]},{fromColor:[0,0,245],toColor:[245,0,245]}]},{id:"cyan-light-to-blue-dark",type:"multipart",colorRamps:[{fromColor:[182,237,240],toColor:[31,131,224]},{fromColor:[31,131,224],toColor:[9,9,145]}]},{id:"distance",fromColor:[255,200,0],toColor:[0,0,255]},{id:"elevation1",type:"multipart",colorRamps:[{fromColor:[175,240,233],toColor:[255,255,179]},{fromColor:[255,255,179],toColor:[0,128,64]},{fromColor:[0,128,64],toColor:[252,186,3]},{fromColor:[252,186,3],toColor:[128,0,0]},{fromColor:[120,0,0],toColor:[105,48,13]},{fromColor:[105,48,13],toColor:[171,171,171]},{fromColor:[171,171,171],toColor:[255,252,255]}]},{id:"elevation2",type:"multipart",colorRamps:[{fromColor:[118,219,211],toColor:[255,255,199]},{fromColor:[255,255,199],toColor:[255,255,128]},{fromColor:[255,255,128],toColor:[217,194,121]},{fromColor:[217,194,121],toColor:[135,96,38]},{fromColor:[135,96,38],toColor:[150,150,181]},{fromColor:[150,150,181],toColor:[181,150,181]},{fromColor:[181,150,181],toColor:[255,252,255]}]},{id:"errors",fromColor:[255,235,214],toColor:[196,10,10]},{id:"gray-light-to-dark",fromColor:[219,219,219],toColor:[69,69,69]},{id:"green-bright",fromColor:[204,255,204],toColor:[14,204,14]},{id:"green-light-to-dark",fromColor:[220,245,233],toColor:[34,102,51]},{id:"green-to-blue",type:"multipart",colorRamps:[{fromColor:[32,204,16],toColor:[0,242,242]},{fromColor:[0,242,242],toColor:[2,33,227]}]},{id:"orange-bright",fromColor:[255,235,204],toColor:[240,118,5]},{id:"orange-light-to-dark",fromColor:[250,233,212],toColor:[171,65,36]},{id:"partial-spectrum",type:"multipart",colorRamps:[{fromColor:[242,241,162],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,0,0]},{fromColor:[252,3,69],toColor:[176,7,237]},{fromColor:[176,7,237],toColor:[2,29,173]}]},{id:"partial-spectrum-1-diverging",type:"multipart",colorRamps:[{fromColor:[135,38,38],toColor:[240,149,12]},{fromColor:[240,149,12],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[74,80,181]},{fromColor:[74,80,181],toColor:[39,32,122]}]},{id:"partial-spectrum-2-diverging",type:"multipart",colorRamps:[{fromColor:[115,77,42],toColor:[201,137,52]},{fromColor:[201,137,52],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[91,63,176]},{fromColor:[91,63,176],toColor:[81,13,97]}]},{id:"pink-to-yellow-green-diverging-bright",type:"multipart",colorRamps:[{fromColor:[158,30,113],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[99,110,45]}]},{id:"pink-to-yellow-green-diverging-dark",type:"multipart",colorRamps:[{fromColor:[97,47,73],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[22,59,15]}]},{id:"precipitation",type:"multipart",colorRamps:[{fromColor:[194,82,60],toColor:[237,161,19]},{fromColor:[237,161,19],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[0,219,0]},{fromColor:[0,219,0],toColor:[32,153,143]},{fromColor:[32,153,143],toColor:[11,44,122]}]},{id:"prediction",type:"multipart",colorRamps:[{fromColor:[40,146,199],toColor:[250,250,100]},{fromColor:[250,250,100],toColor:[232,16,20]}]},{id:"purple-bright",fromColor:[255,204,255],toColor:[199,0,199]},{id:"purple-to-green-diverging-bright",type:"multipart",colorRamps:[{fromColor:[77,32,150],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[20,122,11]}]},{id:"purple-to-green-diverging-dark",type:"multipart",colorRamps:[{fromColor:[67,14,89],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[24,79,15]}]},{id:"purple-blue-bright",fromColor:[223,184,230],toColor:[112,12,242]},{id:"purple-blue-light-to-dark",fromColor:[229,213,242],toColor:[93,44,112]},{id:"purple-red-bright",fromColor:[255,204,225],toColor:[199,0,99]},{id:"purple-red-light-to-dark",fromColor:[250,215,246],toColor:[143,17,57]},{id:"red-bright",fromColor:[255,204,204],toColor:[219,0,0]},{id:"red-light-to-dark",fromColor:[255,224,224],toColor:[143,10,10]},{id:"red-to-blue-diverging-bright",type:"multipart",colorRamps:[{fromColor:[196,69,57],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[48,95,207]}]},{id:"red-to-blue-diverging-dark",type:"multipart",colorRamps:[{fromColor:[107,13,13],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[13,53,97]}]},{id:"red-to-green",type:"multipart",colorRamps:[{fromColor:[245,0,0],toColor:[245,245,0]},{fromColor:[245,245,0],toColor:[0,245,0]}]},{id:"red-to-green-diverging-bright",type:"multipart",colorRamps:[{fromColor:[186,20,20],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[54,145,33]}]},{id:"red-to-green-diverging-dark",type:"multipart",colorRamps:[{fromColor:[97,21,13],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[16,69,16]}]},{id:"slope",type:"multipart",colorRamps:[{fromColor:[56,168,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,0,0]}]},{id:"spectrum-full-bright",type:"multipart",colorRamps:[{fromColor:[255,0,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[0,255,255]},{fromColor:[0,255,255],toColor:[0,0,255]}]},{id:"spectrum-full-dark",type:"multipart",colorRamps:[{fromColor:[153,0,0],toColor:[153,153,0]},{fromColor:[153,153,0],toColor:[0,153,153]},{fromColor:[0,153,153],toColor:[0,0,153]}]},{id:"spectrum-full-light",type:"multipart",colorRamps:[{fromColor:[255,153,153],toColor:[255,255,153]},{fromColor:[255,255,153],toColor:[153,255,255]},{fromColor:[153,255,255],toColor:[153,153,255]}]},{id:"surface",type:"multipart",colorRamps:[{fromColor:[112,153,89],toColor:[242,238,162]},{fromColor:[242,238,162],toColor:[242,206,133]},{fromColor:[242,206,133],toColor:[194,140,124]},{fromColor:[194,140,124],toColor:[255,242,255]}]},{id:"temperature",type:"multipart",colorRamps:[{fromColor:[255,252,255],toColor:[255,0,255]},{fromColor:[255,0,255],toColor:[0,0,255]},{fromColor:[0,0,255],toColor:[0,255,255]},{fromColor:[0,255,255],toColor:[0,255,0]},{fromColor:[0,255,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,128,0]},{fromColor:[255,128,0],toColor:[128,0,0]}]},{id:"white-to-black",fromColor:[255,255,255],toColor:[0,0,0]},{id:"yellow-to-dark-red",type:"multipart",colorRamps:[{fromColor:[255,255,128],toColor:[242,167,46]},{fromColor:[242,167,46],toColor:[107,0,0]}]},{id:"yellow-to-green-to-dark-blue",type:"multipart",colorRamps:[{fromColor:[255,255,128],toColor:[56,224,9]},{fromColor:[56,224,9],toColor:[26,147,171]},{fromColor:[26,147,171],toColor:[12,16,120]}]},{id:"yellow-to-red",fromColor:[245,245,0],toColor:[255,0,0]},{id:"yellow-green-bright",fromColor:[236,252,204],toColor:[157,204,16]},{id:"yellow-green-light-to-dark",fromColor:[215,240,175],toColor:[96,107,45]}],Lw=new He({Aspect:"aspect","Black to White":"black-to-white","Blue Bright":"blue-bright","Blue Light to Dark":"blue-light-to-dark","Blue-Green Bright":"blue-green-bright","Blue-Green Light to Dark":"blue-green-light-to-dark","Brown Light to Dark":"brown-light-to-dark","Brown to Blue Green Diverging, Bright":"brown-to-blue-green-diverging-right","Brown to Blue Green Diverging, Dark":"brown-to-blue-green-diverging-dark","Coefficient Bias":"coefficient-bias","Cold to Hot Diverging":"cold-to-hot-diverging","Condition Number":"condition-number","Cyan to Purple":"cyan-to-purple","Cyan-Light to Blue-Dark":"cyan-light-to-blue-dark",Distance:"distance","Elevation #1":"elevation1","Elevation #2":"elevation2",Errors:"errors","Gray Light to Dark":"gray-light-to-dark","Green Bright":"green-bright","Green Light to Dark":"green-light-to-dark","Green to Blue":"green-to-blue","Orange Bright":"orange-bright","Orange Light to Dark":"orange-light-to-dark","Partial Spectrum":"partial-spectrum","Partial Spectrum 1 Diverging":"partial-spectrum-1-diverging","Partial Spectrum 2 Diverging":"partial-spectrum-2-diverging","Pink to YellowGreen Diverging, Bright":"pink-to-yellow-green-diverging-bright","Pink to YellowGreen Diverging, Dark":"pink-to-yellow-green-diverging-dark",Precipitation:"precipitation",Prediction:"prediction","Purple Bright":"purple-bright","Purple to Green Diverging, Bright":"purple-to-green-diverging-bright","Purple to Green Diverging, Dark":"purple-to-green-diverging-dark","Purple-Blue Bright":"purple-blue-bright","Purple-Blue Light to Dark":"purple-blue-light-to-dark","Purple-Red Bright":"purple-red-bright","Purple-Red Light to Dark":"purple-red-light-to-dark","Red Bright":"red-bright","Red Light to Dark":"red-light-to-dark","Red to Blue Diverging, Bright":"red-to-blue-diverging-bright","Red to Blue Diverging, Dark":"red-to-blue-diverging-dark","Red to Green":"red-to-green","Red to Green Diverging, Bright":"red-to-green-diverging-bright","Red to Green Diverging, Dark":"red-to-green-diverging-dark",Slope:"slope","Spectrum-Full Bright":"spectrum-full-bright","Spectrum-Full Dark":"spectrum-full-dark","Spectrum-Full Light":"spectrum-full-light",Surface:"surface",Temperature:"temperature","White to Black":"white-to-black","Yellow to Dark Red":"yellow-to-dark-red","Yellow to Green to Dark Blue":"yellow-to-green-to-dark-blue","Yellow to Red":"yellow-to-red","Yellow-Green Bright":"yellow-green-bright","Yellow-Green Light to Dark":"yellow-green-light-to-dark"});function oM(t,e){if(!t||!e||t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(t[i]>e[i]+2||t[i]<e[i]-2)return!1;return!0}function HZ(t){const e=t.clone();return e.fromColor=t.toColor,e.toColor=t.fromColor,e.algorithm=t.algorithm,e}function Kje(t){var e;if(t.type==="multipart"){const i=t.clone();return(e=i.colorRamps)!=null&&e.length&&(i.colorRamps=i.colorRamps.reverse().map(r=>HZ(r))),i}return HZ(t)}function qZ(t,e){if(!t)return;const i=e??F9;let r=null;return t.type==="algorithmic"?i.some(n=>{if(oM(t.fromColor.toRgb(),n.fromColor)&&oM(t.toColor.toRgb(),n.toColor))return r=n.id,!0}):t.type==="multipart"&&i.some(n=>{const s=t.colorRamps,o=n.colorRamps;if(s&&o&&s.length===o.length&&!o.some((a,l)=>{if(!oM(s[l].fromColor.toRgb(),new ce(a.fromColor).toRgb())||!oM(s[l].toColor.toRgb(),new ce(a.toColor).toRgb()))return!0})){if(r)return!0;r=n.id}}),r}function Xje(t,e,i=!1){if(!t)return;let r=qZ(t,e);return r!=null||i||(r=qZ(t=Kje(t),e)),r}function Qje(t,e=!1){const i=typeof t=="string"?t:Xje(t,void 0,e);return i?Lw.toJSON(i):null}function e8e(t,e="esriCIELabAlgorithm"){const i=F9.find(({id:r})=>r===t);return i?i.colorRamps?{type:"multipart",colorRamps:i.colorRamps.map(r=>({type:"algorithmic",algorithm:e,fromColor:[...r.fromColor],toColor:[...r.toColor]}))}:{type:"algorithmic",algorithm:e,fromColor:[...i.fromColor],toColor:[...i.toColor]}:null}function Fpe(t){const e=(t=t||{}).numColors||256,i=t.distanceOffset||0,r=t.isCustomInterval!=null?t.isCustomInterval:t.distanceInterval!==null&&t.distanceInterval!==1/(e-1),n=t.distanceInterval||1/(e-1);return{...t,numColors:e,distanceOffset:i,interpolateAlpha:!!t.interpolateAlpha,distanceInterval:n,isCustomInterval:r,weights:t.weights}}function t8e(t,e,i){const{numColors:r,distanceOffset:n,distanceInterval:s,isCustomInterval:o}=i,a=t.s===0,l=e.s===0;let c=t.h,u=e.h;a&&!l?c=u:l&&!a&&(e={...e,h:c},u=c);let h,f=Math.abs(u-c);const m=360;f<m/2?h=(u-c)*s:(f=m-f,h=c>u?f*s:-f*s);const g=(e.s-t.s)*s,y=(e.v-t.v)*s;let{s:v,v:b}=t,w=c;if(n){const S=n/s;w=(w+S*h+m)%m,v+=S*g,b+=S*y}const x=[];for(let S=0;S<r-1;S++)x.push({h:w,s:v,v:b}),w=(w+h+m)%m,v+=g,b+=y;return x.push(o?{h:w,s:v,v:b}:e),x}function i8e(t,e,i){const{numColors:r,distanceOffset:n,distanceInterval:s,isCustomInterval:o}=i;let{l:a,a:l,b:c}=t;const u=(e.l-a)*s,h=(e.a-l)*s,f=(e.b-c)*s,m=[];if(n){const g=n/s;a+=g*u,l+=g*h,c+=g*f}for(let g=0;g<r-1;g++)m.push({l:a,a:l,b:c}),a+=u,l+=h,c+=f;return m.push(o?{l:a,a:l,b:c}:e),m}function r8e(t,e,i){const{numColors:r,distanceOffset:n,distanceInterval:s,isCustomInterval:o}=i,a=t.h,l=e.h,c=2*Math.PI;let u;if(a<=l){const w=l-a,x=l-a-c;u=Math.abs(x)<Math.abs(w)?x:w}else{const w=l+c-a,x=l-a;u=Math.abs(x)<Math.abs(w)?x:w}const h=u*s,f=(e.l-t.l)*s,m=(e.c-t.c)*s;let{l:g,c:y,h:v}=t;if(n){const w=n/s;g+=w*f,y+=w*m,v=(v+w*h+c)%c}const b=[];for(let w=0;w<r-1;w++)b.push({l:g,c:y,h:v}),g+=f,y+=m,v=(v+h+c)%c;return b.push(o?{l:g,c:y,h:v}:e),b}function Dpe(t,e){let{fromColor:i,toColor:r}=t;i=[...i],r=[...r],i.length===3&&(i=i.concat([255])),r.length===3&&(r=r.concat([255]));const n=t.algorithm||"esriCIELabAlgorithm",s=Fpe(e),{numColors:o,distanceOffset:a,isCustomInterval:l,interpolateAlpha:c}=s;if(o===1&&a===0)return[i];if(o===2&&a===0&&!l)return[i,r];const u={r:i[0],g:i[1],b:i[2]},h={r:r[0],g:r[1],b:r[2]},f=n==="esriCIELabAlgorithm"?i8e(UZ(u),UZ(h),s):n==="esriHSVAlgorithm"?t8e(Pv(u),Pv(h),s):r8e(GZ(u),GZ(h),s),m=[],g=i[3]??255,y=((r[3]??255)-g)/(o-1);for(let v=0;v<o;v++){const{r:b,g:w,b:x}=pg(f[v]),S=c?Math.round(g+y*v):255;m.push([b,w,x,S])}return m}function n8e(t,e){const{numColors:i,interpolateAlpha:r}=Fpe(e);let n=e==null?void 0:e.weights;const{colorRamps:s}=t;if(n){const f=n.reduce((m,g)=>m+g);n=n.map(m=>m/f)}else{n=[];for(let f=0;f<s.length;f++)n[f]=1/s.length}const o=[];let a=0,l=0;const c=1/(i-1);let u=!1;for(let f=0;f<s.length;f++){let m=u?0:a*c-l,g=f===s.length-1?i-1-a:(n[f]-m)/c;if(u=Math.ceil(g)===g,g=Math.ceil(g),g===0)continue;m/=n[f];const y=Dpe(s[f],{numColors:g,interpolateAlpha:r,distanceOffset:m,distanceInterval:c/n[f]});a+=y.length,o.push(...y),l+=n[f]}const h=[...s[s.length-1].toColor];return h.length===3&&h.push(255),o.push(h),o}function D9(t,e){const i="toJSON"in t?t.toJSON():t;return i.type==="multipart"?n8e(i,e):Dpe(i,e)}function Ov(t,e){const i=D9(t,e),r=e==null?void 0:e.interpolateAlpha;return i.forEach((n,s)=>{n.unshift(s),r||n.pop()}),i}function WZ(t){const e=Pv(t);return{type:"HsvColor",Hue:e.h,Saturation:e.s,Value:e.v,AlphaValue:255}}function JZ(t){const e=t.toJSON();return{Algorithm:(e==null?void 0:e.Algorithm)||"esriHSVAlgorithm",type:"AlgorithmicColorRamp",FromColor:WZ(t.fromColor),ToColor:WZ(t.toColor)}}function bwt(t){const e=Qje(t);if(!e)return null;if(t.type==="algorithmic")return{...JZ(t),Name:e};if(t.colorRamps){const i=t.colorRamps.map(JZ);return{type:"MultiPartColorRamp",NumColorRamps:i.length,ArrayOfColorRamp:i,Name:e}}return null}function wwt(t){const e=t.reverse().map(i=>{const r=i.toString(16);return r.length<2?"0"+r:r});return 4294967295&Number.parseInt(e.join(""),16)}var a2;let l2=a2=class extends te{constructor(t){super(t),this.colormapInfos=null,this.type="raster-colormap"}static createFromColormap(t,e){if(!t)return null;const i=t[0].length===5,r=[...t].sort((n,s)=>n[0]-s[0]).map(n=>Mpe.fromJSON({value:n[0],color:i?n.slice(1,5):n.slice(1,4).concat([255]),label:e?e[n[0]]??"":n[0]}));return new a2({colormapInfos:r})}static createFromColorramp(t){const e=Ov(t);return a2.createFromColormap(e)}clone(){return new a2({colormapInfos:this.colormapInfos.map(t=>t.toJSON())})}extractColormap(){return this.colormapInfos.map(({value:t,color:e})=>[t,e.r,e.g,e.b,e.a>1?e.a:255*e.a&255]).sort((t,e)=>t[0]-e[0])}};d([p({type:[Mpe],json:{write:!0}})],l2.prototype,"colormapInfos",void 0),d([xe({rasterColormap:"raster-colormap"})],l2.prototype,"type",void 0),l2=a2=d([A("esri.renderers.RasterColormapRenderer")],l2);const N9=l2;var gz;let Fa=gz=class extends te{constructor(t){super(t),this.altitude=45,this.azimuth=315,this.colorRamp=null,this.hillshadeType="traditional",this.pixelSizePower=.664,this.pixelSizeFactor=.024,this.scalingType="none",this.type="raster-shaded-relief",this.zFactor=1}readColorRamp(t){return kL(t)}clone(){return new gz({hillshadeType:this.hillshadeType,altitude:this.altitude,azimuth:this.azimuth,zFactor:this.zFactor,scalingType:this.scalingType,pixelSizeFactor:this.pixelSizeFactor,pixelSizePower:this.pixelSizePower,colorRamp:U(this.colorRamp)})}};d([p({type:Number,json:{write:!0}})],Fa.prototype,"altitude",void 0),d([p({type:Number,json:{write:!0}})],Fa.prototype,"azimuth",void 0),d([p({types:AL,json:{write:!0}})],Fa.prototype,"colorRamp",void 0),d([ae("colorRamp")],Fa.prototype,"readColorRamp",null),d([p({type:["traditional","multi-directional"],json:{write:!0}})],Fa.prototype,"hillshadeType",void 0),d([p({type:Number,json:{write:!0}})],Fa.prototype,"pixelSizePower",void 0),d([p({type:Number,json:{write:!0}})],Fa.prototype,"pixelSizeFactor",void 0),d([p({type:["none","adjusted"],json:{write:!0}})],Fa.prototype,"scalingType",void 0),d([xe({rasterShadedRelief:"raster-shaded-relief"})],Fa.prototype,"type",void 0),d([p({type:Number,json:{write:!0}})],Fa.prototype,"zFactor",void 0),Fa=gz=d([A("esri.renderers.RasterShadedReliefRenderer")],Fa);const Npe=Fa,SA=new He({none:"none",standardDeviation:"standard-deviation",histogramEqualization:"histogram-equalization",minMax:"min-max",percentClip:"percent-clip",sigmoid:"sigmoid"}),Vpe={0:"none",3:"standardDeviation",4:"histogramEqualization",5:"minMax",6:"percentClip",9:"sigmoid"};var yz;let Jr=yz=class extends te{constructor(t){super(t),this.colorRamp=null,this.computeGamma=!1,this.dynamicRangeAdjustment=!1,this.gamma=[],this.maxPercent=null,this.minPercent=null,this.numberOfStandardDeviations=null,this.outputMax=null,this.outputMin=null,this.sigmoidStrengthLevel=null,this.statistics=[],this.histograms=null,this.useGamma=!1,this.stretchType="none",this.type="raster-stretch"}readColorRamp(t){if(t)return kL(t)}writeStatistics(t,e,i){t!=null&&t.length&&(Array.isArray(t[0])||(t=t.map(r=>[r.min,r.max,r.avg,r.stddev])),e[i]=t)}readStretchType(t,e){let i=e.stretchType;return typeof i=="number"&&(i=Vpe[i]),SA.read(i)}clone(){return new yz({stretchType:this.stretchType,outputMin:this.outputMin,outputMax:this.outputMax,useGamma:this.useGamma,computeGamma:this.computeGamma,statistics:U(this.statistics),gamma:U(this.gamma),sigmoidStrengthLevel:this.sigmoidStrengthLevel,numberOfStandardDeviations:this.numberOfStandardDeviations,minPercent:this.minPercent,maxPercent:this.maxPercent,colorRamp:U(this.colorRamp),histograms:U(this.histograms),dynamicRangeAdjustment:this.dynamicRangeAdjustment})}};d([p({types:AL,json:{write:!0}})],Jr.prototype,"colorRamp",void 0),d([ae("colorRamp")],Jr.prototype,"readColorRamp",null),d([p({type:Boolean,json:{write:!0}})],Jr.prototype,"computeGamma",void 0),d([p({type:Boolean,json:{write:{target:"dra"},read:{source:"dra"}}})],Jr.prototype,"dynamicRangeAdjustment",void 0),d([p({type:[Number],json:{write:!0}})],Jr.prototype,"gamma",void 0),d([p({type:Number,json:{write:!0}})],Jr.prototype,"maxPercent",void 0),d([p({type:Number,json:{write:!0}})],Jr.prototype,"minPercent",void 0),d([p({type:Number,json:{write:!0}})],Jr.prototype,"numberOfStandardDeviations",void 0),d([p({type:Number,json:{read:{source:"max"},write:{target:"max"}}})],Jr.prototype,"outputMax",void 0),d([p({type:Number,json:{read:{source:"min"},write:{target:"min"}}})],Jr.prototype,"outputMin",void 0),d([p({type:Number,json:{write:!0}})],Jr.prototype,"sigmoidStrengthLevel",void 0),d([p({json:{type:[[Number]],write:!0}})],Jr.prototype,"statistics",void 0),d([p()],Jr.prototype,"histograms",void 0),d([ge("statistics")],Jr.prototype,"writeStatistics",null),d([p({type:Boolean,json:{write:!0}})],Jr.prototype,"useGamma",void 0),d([p({type:SA.apiValues,json:{type:SA.jsonValues,write:SA.write}})],Jr.prototype,"stretchType",void 0),d([ae("stretchType",["stretchType"])],Jr.prototype,"readStretchType",null),d([xe({rasterStretch:"raster-stretch"})],Jr.prototype,"type",void 0),Jr=yz=d([A("esri.renderers.RasterStretchRenderer")],Jr);const V9=Jr,aM={102100:{maxX:20037508342788905e-9,minX:-20037508342788905e-9,plus180Line:new no({paths:[[[20037508342788905e-9,-20037508342788905e-9],[20037508342788905e-9,20037508342788905e-9]]],spatialReference:Ee.WebMercator}),minus180Line:new no({paths:[[[-20037508342788905e-9,-20037508342788905e-9],[-20037508342788905e-9,20037508342788905e-9]]],spatialReference:Ee.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new no({paths:[[[180,-180],[180,180]]],spatialReference:Ee.WGS84}),minus180Line:new no({paths:[[[-180,-180],[-180,180]]],spatialReference:Ee.WGS84})}};function J0(t,e){return Math.ceil((t-e)/(2*e))}function zpe(t,e){const i=lI(t);for(const r of i)for(const n of r)n[0]+=e;return t}function lI(t){return Ew(t)?t.rings:t.paths}function OC(t,e){return e?{...e,query:{...t??{},...e.query}}:{query:t}}function rx(t){return typeof t=="string"?sn(t):U(t)}function LC(t,e,i){const r={};for(const n in t){if(n==="declaredClass")continue;const s=t[n];if(s!=null&&typeof s!="function")if(Array.isArray(s)){r[n]=[];for(let o=0;o<s.length;o++)r[n][o]=LC(s[o])}else if(typeof s=="object")if(s.toJSON){const o=s.toJSON(i&&i[n]);r[n]=e?o:JSON.stringify(o)}else r[n]=e?s:JSON.stringify(s);else r[n]=s}return r}async function s8e(t,e,i,r){const n=rx(t),s=e[0].spatialReference,o={...r,query:{...n.query,f:"json",sr:JSON.stringify(s),target:JSON.stringify({geometryType:V1(e[0]),geometries:e}),cutter:JSON.stringify(i)}},a=await at(n.path+"/cut",o),{cutIndexes:l,geometries:c=[]}=a.data;return{cutIndexes:l,geometries:c.map(u=>{const h=Vd(u);return h.spatialReference=s,h})}}function o8e(t){return{geometryType:V1(t[0]),geometries:t.map(e=>e.toJSON())}}function jpe(t,e,i){const r=HCe(e);return t.map(n=>{const s=r.fromJSON(n);return s.spatialReference=i,s})}async function a8e(t,e,i){const r=typeof t=="string"?sn(t):t,n=e[0].spatialReference,s=V1(e[0]),o={...i,query:{...r.query,f:"json",sr:n.wkid??JSON.stringify(n),geometries:JSON.stringify(o8e(e))}},{data:a}=await at(r.path+"/simplify",o);return jpe(a.geometries,s,n)}const Bpe=ie.getLogger("esri.geometry.support.normalizeUtils");function l8e(t){return t.type==="polygon"}function c8e(t){return t[0].type==="polygon"}function u8e(t){return t[0].type==="polyline"}function d8e(t,e){if(!(t instanceof no||t instanceof Zn)){const n="straightLineDensify: the input geometry is neither polyline nor polygon";throw Bpe.error(n),new N(n)}const i=lI(t),r=[];for(const n of i){const s=[];r.push(s),s.push([n[0][0],n[0][1]]);for(let o=0;o<n.length-1;o++){const a=n[o][0],l=n[o][1],c=n[o+1][0],u=n[o+1][1],h=Math.sqrt((c-a)*(c-a)+(u-l)*(u-l)),f=(u-l)/h,m=(c-a)/h,g=h/e;if(g>1){for(let w=1;w<=g-1;w++){const x=w*e,S=m*x+a,I=f*x+l;s.push([S,I])}const y=(h+Math.floor(g-1)*e)/2,v=m*y+a,b=f*y+l;s.push([v,b])}s.push([c,u])}}return l8e(t)?new Zn({rings:r,spatialReference:t.spatialReference}):new no({paths:r,spatialReference:t.spatialReference})}function ZZ(t,e,i){if(e){const r=d8e(t,1e6);t=j0(r,!0)}return i&&(t=zpe(t,i)),t}function YZ(t,e,i){if(Array.isArray(t)){const r=t[0];if(r>e){const n=J0(r,e);t[0]=r+n*(-2*e)}else if(r<i){const n=J0(r,i);t[0]=r+n*(-2*i)}}else{const r=t.x;if(r>e){const n=J0(r,e);t=t.clone().offset(n*(-2*e),0)}else if(r<i){const n=J0(r,i);t=t.clone().offset(n*(-2*i),0)}}return t}function h8e(t,e){let i=-1;for(let r=0;r<e.cutIndexes.length;r++){const n=e.cutIndexes[r],s=e.geometries[r],o=lI(s);for(let a=0;a<o.length;a++){const l=o[a];l.some(c=>{if(c[0]<180)return!0;{let u=0;for(let f=0;f<l.length;f++){const m=l[f][0];u=m>u?m:u}u=Number(u.toFixed(9));const h=-360*J0(u,180);for(let f=0;f<l.length;f++){const m=s.getPoint(a,f);s.setPoint(a,f,m.clone().offset(h,0))}return!0}})}if(n===i){if(c8e(t))for(const a of lI(s))t[n]=t[n].addRing(a);else if(u8e(t))for(const a of lI(s))t[n]=t[n].addPath(a)}else i=n,t[n]=s}return t}async function Upe(t,e,i){if(!Array.isArray(t))return Upe([t],e);e&&typeof e!="string"&&Bpe.warn("normalizeCentralMeridian()","The url object is deprecated, use the url string instead");const r=typeof e=="string"?e:(e==null?void 0:e.url)??Lt.geometryServiceUrl;let n,s,o,a,l,c,u,h,f=0;const m=[],g=[];for(const S of t)if(S!=null)if(n||(n=S.spatialReference,s=Do(n),o=n.isWebMercator,c=o?102100:4326,a=aM[c].maxX,l=aM[c].minX,u=aM[c].plus180Line,h=aM[c].minus180Line),s)if(S.type==="mesh")g.push(S);else if(S.type==="point")g.push(YZ(S.clone(),a,l));else if(S.type==="multipoint"){const I=S.clone();I.points=I.points.map(T=>YZ(T,a,l)),g.push(I)}else if(S.type==="extent"){const I=S.clone()._normalize(!1,!1,s);g.push(I.rings?new Zn(I):I)}else if(S.extent){const I=S.extent,T=J0(I.xmin,l)*(2*a);let C=T===0?S.clone():zpe(S.clone(),T);I.offset(T,0),I.intersects(u)&&I.xmax!==a?(f=I.xmax>f?I.xmax:f,C=ZZ(C,o),m.push(C),g.push("cut")):I.intersects(h)&&I.xmin!==l?(f=I.xmax*(2*a)>f?I.xmax*(2*a):f,C=ZZ(C,o,360),m.push(C),g.push("cut")):g.push(C)}else g.push(S.clone());else g.push(S);else g.push(S);let y=J0(f,a),v=-90;const b=y,w=new no;for(;y>0;){const S=360*y-180;w.addPath([[S,v],[S,-1*v]]),v*=-1,y--}if(m.length>0&&b>0){const S=h8e(m,await s8e(r,m,w,i)),I=[],T=[];for(let $=0;$<g.length;$++){const P=g[$];if(P!=="cut")T.push(P);else{const k=S.shift(),L=t[$];L!=null&&L.type==="polygon"&&L.rings&&L.rings.length>1&&k.rings.length>=L.rings.length?(I.push(k),T.push("simplify")):T.push(o?sp(k):k)}}if(!I.length)return T;const C=await a8e(r,I,i),E=[];for(let $=0;$<T.length;$++){const P=T[$];P!=="simplify"?E.push(P):E.push(o?sp(C.shift()):C.shift())}return E}const x=[];for(let S=0;S<g.length;S++){const I=g[S];if(I!=="cut")x.push(I);else{const T=m.shift();x.push(o===!0?sp(T):T)}}return x}function xwt(t,e){const i=Do(e);if(i){const[r,n]=i.valid,s=n-r;if(t<r)for(;t<r;)t+=s;if(t>n)for(;t>n;)t-=s}return t}let KZ=class{constructor(e=null,i=null,r=null){this.minValue=e,this.maxValue=i,this.noDataValue=r}};const p8e=9999999e31,f8e=2e-7,m8e={u1:[0,1],u2:[0,3],u4:[0,15],u8:[0,255],s8:[-128,127],u16:[0,65535],s16:[-32768,32767],u32:[0,4294967295],s32:[-2147483648,2147483647],f32:[-34028234663852886e22,34028234663852886e22],f64:[-Number.MAX_VALUE,Number.MAX_VALUE],unknown:void 0,c64:void 0,c128:void 0};function Au(t){return m8e[t]??[-34028234663852886e22,34028234663852886e22]}function ZL(t,e,i){if(t.depthCount&&t.depthCount>1)return;const{pixels:r,statistics:n,pixelType:s}=t,o=r[0].length,a=t.bandMasks??[],l=t.mask??new Uint8Array(o).fill(255),c=s==="f32"||s==="f64",u=Au(s);let h=!1;for(let f=0;f<r.length;f++){const m=typeof e=="number"?e:e[f];if(m==null)continue;const g=(n==null?void 0:n[f].minValue)??u[0],y=(n==null?void 0:n[f].maxValue)??u[1];if(g>m+Number.EPSILON||y<m-Number.EPSILON)continue;const v=a[f]||new Uint8Array(o).fill(255),b=r[f],w=i==null?void 0:i.customFloatTolerance;if(c&&w!==0){let x=w;x||(x=Math.abs(m)>=p8e?f8e*Math.abs(m):s==="f32"?2**-23:Number.EPSILON);for(let S=0;S<b.length;S++)v[S]&&Math.abs(b[S]-m)<x&&(b[S]=0,v[S]=0,l[S]=0,h=!0)}else for(let x=0;x<b.length;x++)v[x]&&b[x]===m&&(b[x]=0,v[x]=0,l[x]=0,h=!0);a[f]=v}h&&(t.bandMasks=a,t.mask=l),h&&"updateStatistics"in t&&t.updateStatistics()}var zy;let Zs=zy=class extends te{static createEmptyBand(t,e){return new(zy.getPixelArrayConstructor(t))(e)}static getPixelArrayConstructor(t){let e;switch(t){case"u1":case"u2":case"u4":case"u8":e=Uint8Array;break;case"u16":e=Uint16Array;break;case"u32":e=Uint32Array;break;case"s8":e=Int8Array;break;case"s16":e=Int16Array;break;case"s32":e=Int32Array;break;case"f32":case"c64":case"c128":case"unknown":e=Float32Array;break;case"f64":e=Float64Array}return e}constructor(t){super(t),this.width=null,this.height=null,this.pixelType="f32",this.validPixelCount=null,this.mask=null,this.maskIsAlpha=!1,this.premultiplyAlpha=!1,this.statistics=null,this.depthCount=1}castPixelType(t){if(!t)return"f32";let e=t.toLowerCase();return["u1","u2","u4"].includes(e)?e="u8":["unknown","u8","s8","u16","s16","u32","s32","f32","f64"].includes(e)||(e="f32"),e}getPlaneCount(){var t;return(t=this.pixels)==null?void 0:t.length}addData(t){if(!t.pixels||t.pixels.length!==this.width*this.height)throw new N("pixelblock:invalid-or-missing-pixels","add data requires valid pixels array that has same length defined by pixel block width * height");this.pixels||(this.pixels=[]),this.statistics||(this.statistics=[]),this.pixels.push(t.pixels),this.statistics.push(t.statistics??new KZ)}getAsRGBA(){const t=new ArrayBuffer(this.width*this.height*4);switch(this.pixelType){case"s8":case"s16":case"u16":case"s32":case"u32":case"f32":case"f64":this._fillFromNon8Bit(t);break;default:this._fillFrom8Bit(t)}return new Uint8ClampedArray(t)}getAsRGBAFloat(){const t=new Float32Array(this.width*this.height*4);return this._fillFrom32Bit(t),t}updateStatistics(){if(!this.pixels)return;this.statistics=this.pixels.map(i=>this._calculateBandStatistics(i,this.mask));const t=this.mask;let e=0;if(t!=null)for(let i=0;i<t.length;i++)t[i]&&e++;else e=this.width*this.height;this.validPixelCount=e}clamp(t){if(!t||t==="f64"||t==="f32"||!this.pixels)return;const[e,i]=Au(t),r=this.pixels,n=this.width*this.height,s=r.length;let o,a,l;const c=[];for(let u=0;u<s;u++){l=zy.createEmptyBand(t,n),o=r[u];for(let h=0;h<n;h++)a=o[h],l[h]=a>i?i:a<e?e:a;c.push(l)}this.pixels=c,this.pixelType=t}extractBands(t){var h;const{pixels:e,statistics:i}=this;if(t==null||t.length===0||!e||e.length===0)return this;const r=e.length,n=t.some(f=>f>=e.length),s=r===t.length&&!t.some((f,m)=>f!==m);if(n||s)return this;const o=((h=this.bandMasks)==null?void 0:h.length)===r?t.map(f=>this.bandMasks[f]):void 0;let{mask:a,validPixelCount:l}=this;const{width:c,height:u}=this;if(o){if(o.length===1)a=o[0];else{const f=c*u;a=new Uint8Array(f).fill(255);for(let m=0;m<o.length;m++){const g=o[m];for(let y=0;y<f;y++)g[y]||(a[y]=0)}}l=a.filter(f=>!!f).length}return new zy({pixelType:this.pixelType,width:c,height:u,mask:a,bandMasks:o,validPixelCount:l,maskIsAlpha:this.maskIsAlpha,pixels:t.map(f=>e[f]),statistics:i&&t.map(f=>i[f])})}clone(){const t=new zy({width:this.width,height:this.height,pixelType:this.pixelType,maskIsAlpha:this.maskIsAlpha,validPixelCount:this.validPixelCount});let e;this.mask!=null&&(this.mask instanceof Uint8Array?t.mask=new Uint8Array(this.mask):t.mask=this.mask.slice(0)),this.bandMasks&&(t.bandMasks=this.bandMasks.map(r=>new Uint8Array(r)));const i=zy.getPixelArrayConstructor(this.pixelType);if(this.pixels&&this.pixels.length>0){t.pixels=[];const r=!!this.pixels[0].slice;for(e=0;e<this.pixels.length;e++)t.pixels[e]=r?this.pixels[e].slice(0,this.pixels[e].length):new i(this.pixels[e])}if(this.statistics)for(t.statistics=[],e=0;e<this.statistics.length;e++)t.statistics[e]=U(this.statistics[e]);return t.premultiplyAlpha=this.premultiplyAlpha,t}_fillFrom8Bit(t){const{mask:e,maskIsAlpha:i,premultiplyAlpha:r,pixels:n}=this;if(!t||!n||!n.length)return void ie.getLogger(this).error("getAsRGBA()","Unable to convert to RGBA. The input pixel block is empty.");let s,o,a,l;s=o=a=n[0],n.length>=3?(o=n[1],a=n[2]):n.length===2&&(o=n[1]);const c=new Uint32Array(t),u=this.width*this.height;if(s.length===u)if(e!=null&&e.length===u)if(i)for(l=0;l<u;l++){const h=e[l];if(h){const f=h/255;c[l]=r?h<<24|a[l]*f<<16|o[l]*f<<8|s[l]*f:h<<24|a[l]<<16|o[l]<<8|s[l]}}else for(l=0;l<u;l++)e[l]&&(c[l]=255<<24|a[l]<<16|o[l]<<8|s[l]);else for(l=0;l<u;l++)c[l]=255<<24|a[l]<<16|o[l]<<8|s[l];else ie.getLogger(this).error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.")}_fillFromNon8Bit(t){const{pixels:e,mask:i,statistics:r}=this;if(!t||!e||!e.length)return void ie.getLogger(this).error("getAsRGBA()","Unable to convert to RGBA. The input pixel block is empty.");const n=this.pixelType;let s=1,o=0,a=1;if(r&&r.length>0){for(const y of r)if(y.minValue!=null&&(o=Math.min(o,y.minValue)),y.maxValue!=null&&y.minValue!=null){const v=y.maxValue-y.minValue;a=Math.max(a,v)}s=255/a}else{let y=255;n==="s8"?(o=-128,y=127):n==="u16"?y=65535:n==="s16"?(o=-32768,y=32767):n==="u32"?y=4294967295:n==="s32"?(o=-2147483648,y=2147483647):n==="f32"?(o=-34e38,y=34e38):n==="f64"&&(o=-Number.MAX_VALUE,y=Number.MAX_VALUE),s=255/(y-o)}const l=new Uint32Array(t),c=this.width*this.height;let u,h,f,m,g;if(u=h=f=e[0],u.length!==c)return ie.getLogger(this).error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.");if(e.length>=2)if(h=e[1],e.length>=3&&(f=e[2]),i!=null&&i.length===c)for(m=0;m<c;m++)i[m]&&(l[m]=255<<24|(f[m]-o)*s<<16|(h[m]-o)*s<<8|(u[m]-o)*s);else for(m=0;m<c;m++)l[m]=255<<24|(f[m]-o)*s<<16|(h[m]-o)*s<<8|(u[m]-o)*s;else if(i!=null&&i.length===c)for(m=0;m<c;m++)g=(u[m]-o)*s,i[m]&&(l[m]=255<<24|g<<16|g<<8|g);else for(m=0;m<c;m++)g=(u[m]-o)*s,l[m]=255<<24|g<<16|g<<8|g}_fillFrom32Bit(t){const{pixels:e,mask:i}=this;if(!t||!e||!e.length)return ie.getLogger(this).error("getAsRGBAFloat()","Unable to convert to RGBA. The input pixel block is empty.");let r,n,s,o;r=n=s=e[0],e.length>=3?(n=e[1],s=e[2]):e.length===2&&(n=e[1]);const a=this.width*this.height;if(r.length!==a)return ie.getLogger(this).error("getAsRGBAFloat()","Unable to convert to RGBA. The pixelblock is invalid.");let l=0;if(i!=null&&i.length===a)for(o=0;o<a;o++)t[l++]=r[o],t[l++]=n[o],t[l++]=s[o],t[l++]=1&i[o];else for(o=0;o<a;o++)t[l++]=r[o],t[l++]=n[o],t[l++]=s[o],t[l++]=1}_calculateBandStatistics(t,e){let i=1/0,r=-1/0;const n=t.length;let s,o=0;if(e!=null)for(s=0;s<n;s++)e[s]&&(o=t[s],i=o<i?o:i,r=o>r?o:r);else for(s=0;s<n;s++)o=t[s],i=o<i?o:i,r=o>r?o:r;return new KZ(i,r)}};d([p({json:{write:!0}})],Zs.prototype,"width",void 0),d([p({json:{write:!0}})],Zs.prototype,"height",void 0),d([p({json:{write:!0}})],Zs.prototype,"pixelType",void 0),d([tt("pixelType")],Zs.prototype,"castPixelType",null),d([p({json:{write:!0}})],Zs.prototype,"validPixelCount",void 0),d([p({json:{write:!0}})],Zs.prototype,"mask",void 0),d([p({json:{write:!0}})],Zs.prototype,"maskIsAlpha",void 0),d([p({json:{write:!0}})],Zs.prototype,"pixels",void 0),d([p()],Zs.prototype,"premultiplyAlpha",void 0),d([p({json:{write:!0}})],Zs.prototype,"statistics",void 0),d([p({json:{write:!0}})],Zs.prototype,"depthCount",void 0),d([p({json:{write:!0}})],Zs.prototype,"noDataValues",void 0),d([p({json:{write:!0}})],Zs.prototype,"bandMasks",void 0),Zs=zy=d([A("esri.layers.support.PixelBlock")],Zs);const de=Zs;var PP,OP;(function(t){t[t.matchAny=0]="matchAny",t[t.matchAll=1]="matchAll"})(PP||(PP={})),function(t){t[t.bestMatch=0]="bestMatch",t[t.fail=1]="fail"}(OP||(OP={}));const qh=6;function Gi(t){return t!=null&&t.declaredClass==="esri.layers.support.PixelBlock"&&t.pixels&&t.pixels.length>0}function g8e(t){var u;if(!(t!=null&&t.length)||t.some(h=>!Gi(h)))return null;if(t.length===1)return((u=t[0])==null?void 0:u.clone())??null;const e=t,{width:i,height:r,pixelType:n}=e[0];if(e.some(h=>h.width!==i||h.height!==r))return null;const s=e.map(({mask:h})=>h).filter(h=>h!=null);let o=null;s.length&&(o=new Uint8Array(i*r),o.set(s[0]),s.length>1&&Gpe(s.slice(1),o));const a=[];e.forEach(({pixels:h})=>a.push(...h));const l=e.map(({statistics:h})=>h).filter(h=>h==null?void 0:h.length),c=[];return l.forEach(h=>c.push(...h)),new de({pixelType:n,width:i,height:r,mask:o,pixels:a,statistics:c.length?c:null})}function Fx(t){if(!t)return;const e=t.colormap;if(!e||e.length===0)return;const i=e.sort((h,f)=>h[0]-f[0]);let r=0;i[0][0]<0&&(r=i[0][0]);const n=Math.max(256,i[i.length-1][0]-r+1),s=new Uint8Array(4*n),o=[];let a,l=0,c=0;const u=i[0].length===5;if(n>65536)return i.forEach(h=>{o[h[0]-r]=u?h.slice(1):h.slice(1).concat([255])}),{indexed2DColormap:o,offset:r,alphaSpecified:u};if(t.fillUnspecified)for(a=i[c],l=a[0]-r;l<n;l++)s[4*l]=a[1],s[4*l+1]=a[2],s[4*l+2]=a[3],s[4*l+3]=u?a[4]:255,l===a[0]-r&&(a=c===i.length-1?a:i[++c]);else for(l=0;l<i.length;l++)a=i[l],c=4*(a[0]-r),s[c]=a[1],s[c+1]=a[2],s[c+2]=a[3],s[c+3]=u?a[4]:255;return{indexedColormap:s,offset:r,alphaSpecified:u}}function _5(t,e){if(!Gi(t)||!e||!e.indexedColormap&&!e.indexed2DColormap)return t;const i=t.clone(),r=i.pixels;let n=i.mask;const s=i.width*i.height;if(r.length!==1)return t;const{indexedColormap:o,indexed2DColormap:a,offset:l,alphaSpecified:c}=e;let u=0;const h=r[0],f=new Uint8Array(h.length),m=new Uint8Array(h.length),g=new Uint8Array(h.length);let y,v=0;if(o){const b=o.length-1;if(n!=null)for(u=0;u<s;u++)n[u]&&(v=4*(h[u]-l),v<l||v>b?n[u]=0:(f[u]=o[v],m[u]=o[v+1],g[u]=o[v+2],n[u]=o[v+3]));else{for(n=new Uint8Array(s),u=0;u<s;u++)v=4*(h[u]-l),v<l||v>b?n[u]=0:(f[u]=o[v],m[u]=o[v+1],g[u]=o[v+2],n[u]=o[v+3]);i.mask=n}}else if(a)if(n!=null)for(u=0;u<s;u++)n[u]&&(y=a[h[u]],f[u]=y[0],m[u]=y[1],g[u]=y[2],n[u]=y[3]);else{for(n=new Uint8Array(s),u=0;u<s;u++)y=a[h[u]],f[u]=y[0],m[u]=y[1],g[u]=y[2],n[u]=y[3];i.mask=n}return i.pixels=[f,m,g],i.statistics=null,i.pixelType="u8",i.maskIsAlpha=c,i}function LP(t,e){if(!Gi(t))return null;const{pixels:i,mask:r}=t,n=i.length;let s=e.lut;const{offset:o}=e;s&&s[0].length===1&&(s=i.map(()=>s));const a=[],l=e.outputPixelType||"u8";for(let u=0;u<n;u++){const h=z9(i[u],r,s[u],o||0,l);a.push(h)}const c=new de({width:t.width,height:t.height,pixels:a,mask:r,pixelType:l});return c.updateStatistics(),c}function z9(t,e,i,r,n){const s=t.length,o=de.createEmptyBand(n,s);if(e)for(let a=0;a<s;a++)e[a]&&(o[a]=i[t[a]-r]);else for(let a=0;a<s;a++)o[a]=i[t[a]-r];return o}function y8e(t,e){if(!Gi(t))return null;const i=t.clone(),{pixels:r}=i,n=i.width*i.height,s=e.length,o=Math.floor(s/2),a=e[Math.floor(o)],l=r[0];let c,u,h,f,m,g,y=!1;const v=new Uint8Array(n),b=new Uint8Array(n),w=new Uint8Array(n);let x=i.mask;const S=e[0].mappedColor.length===4;for(x||(x=new Uint8Array(n),x.fill(S?255:1),i.mask=x),m=0;m<n;m++)if(x[m]){for(c=l[m],y=!1,g=o,u=a,h=0,f=s-1;f-h>1;){if(c===u.value){y=!0;break}c>u.value?h=g:f=g,g=Math.floor((h+f)/2),u=e[Math.floor(g)]}y||(c===e[h].value?(u=e[h],y=!0):c===e[f].value?(u=e[f],y=!0):c<e[h].value?(y=!1,u=null):c>e[h].value&&(c<e[f].value?(u=e[h],y=!0):f===s-1?(y=!1,u=null):(u=e[f],y=!0))),y?(v[m]=u.mappedColor[0],b[m]=u.mappedColor[1],w[m]=u.mappedColor[2],x[m]=u.mappedColor[3]):v[m]=b[m]=w[m]=x[m]=0}return i.pixels=[v,b,w],i.mask=x,i.pixelType="u8",i.maskIsAlpha=S,i}function v8e(t,e){if(!Gi(t))return null;const{width:i,height:r}=t,{inputRanges:n,outputValues:s,outputPixelType:o,noDataRanges:a,allowUnmatched:l,isLastInputRangeInclusive:c}=e,u=t.pixels[0],h=de.createEmptyBand(o,u.length),f=t.mask,m=new Uint8Array(i*r);f?m.set(f):m.fill(255);const g=t.pixelType.startsWith("f")?1e-6:0,y=n.map(S=>S-g);y[0]=n[0],y[y.length-1]=n[n.length-1]+(c?1e-6:0);const v=n.length/2,[b,w]=Au(o);for(let S=0;S<r;S++)for(let I=0;I<i;I++){const T=S*i+I;if(m[T]){const C=u[T];let E=!1;for(let $=v-1;$>=0;$--)if(C===y[2*$]||C>y[2*$]&&C<y[2*$+1]){h[T]=s[$],E=!0;break}E||(l?h[T]=C>w?w:C<b?b:C:m[T]=0)}}const x=a==null?void 0:a.length;if(x)for(let S=0;S<r;S++)for(let I=0;I<i;I++){const T=S*i+I;if(!f||f[T]){const C=u[T];for(let E=0;E<x;E+=2)if(C>=a[E]&&C<=a[E+1]){h[T]=0,m[T]=0;break}}}return new de({width:i,height:r,pixelType:o,pixels:[h],mask:m})}function XZ(t,e,i,r){const n=i!=null&&i.length>=2?new Set(i):null,s=(i==null?void 0:i.length)===1?i[0]:null,o=!!(e!=null&&e.length);for(let a=0;a<t.length;a++)if(r[a]){const l=t[a];if(o){let c=!1;for(let u=0;u<e.length;u+=2)if(l>=e[u]&&l<=e[u+1]){c=!0;break}c||(r[a]=0)}r[a]&&(l===s||n!=null&&n.has(l))&&(r[a]=0)}}function QZ(t,e){const i=t[0].length;for(let r=0;r<i;r++)if(e[r]){let n=!1;for(let s=0;s<t.length;s++)if(t[s][r]){n=!0;break}n||(e[r]=0)}}function Gpe(t,e){const i=t[0].length;for(let r=0;r<i;r++)if(e[r]){let n=!1;for(let s=0;s<t.length;s++)if(t[s][r]===0){n=!0;break}n&&(e[r]=0)}}function _8e(t,e){if(!Gi(t))return null;const{width:i,height:r,pixels:n}=t,s=i*r,o=new Uint8Array(s);t.mask?o.set(t.mask):o.fill(255);const a=n.length,{includedRanges:l,noDataValues:c,outputPixelType:u,matchAll:h,lookups:f}=e;if(f){const m=[];for(let g=0;g<a;g++){const y=f[g],v=z9(n[g],o,y.lut,y.offset||0,"u8");m.push(v)}m.length===1?o.set(m[0]):h?QZ(m,o):Gpe(m,o)}else if(h){const m=[];for(let g=0;g<a;g++){const y=new Uint8Array(s);y.set(o),XZ(n[g],l==null?void 0:l.slice(2*g,2*g+2),c==null?void 0:c[g],y),m.push(y)}m.length===1?o.set(m[0]):QZ(m,o)}else for(let m=0;m<a;m++)XZ(n[m],l==null?void 0:l.slice(2*m,2*m+2),c==null?void 0:c[m],o);return new de({width:i,height:r,pixelType:u,pixels:n,mask:o})}function b8e(t){const{srcPixelType:e,inputRanges:i,outputValues:r,allowUnmatched:n,noDataRanges:s,isLastInputRangeInclusive:o,outputPixelType:a}=t;if(e!=="u8"&&e!=="s8"&&e!=="u16"&&e!=="s16")return null;const l=e.includes("16")?65536:256,c=e.includes("s")?-l/2:0,u=de.createEmptyBand(a,l),h=new Uint8Array(l);n&&h.fill(255);const[f,m]=Au(a);if(i!=null&&i.length&&(r!=null&&r.length)){const y=i.map(v=>v-1e-6);y[0]=i[0],o&&(y[y.length-1]=i[i.length-1]);for(let v=0;v<y.length;v++){const b=r[v]>m?m:r[v]<f?f:r[v],w=Math.ceil(y[2*v]-c),x=Math.floor(y[2*v+1]-c);for(let S=w;S<=x;S++)u[S]=b,h[S]=255}}if(s!=null&&s.length)for(let g=0;g<s.length;g++){const y=Math.ceil(s[2*g]-c),v=Math.floor(s[2*g+1]-c);for(let b=y;b<=v;b++)h[b]=0}return{lut:u,offset:c,mask:h}}function w8e(t,e,i){if(t!=="u8"&&t!=="s8"&&t!=="u16"&&t!=="s16")return null;const r=t.includes("16")?65536:256,n=t.includes("s")?-r/2:0,s=new Uint8Array(r);if(e)for(let o=0;o<e.length;o++){const a=Math.ceil(e[2*o]-n),l=Math.floor(e[2*o+1]-n);for(let c=a;c<=l;c++)s[c]=255}else s.fill(255);if(i)for(let o=0;o<i.length;o++)s[i[o]-n]=0;return{lut:s,offset:n}}function x8e(t,e,i,r,n,s,o,a){return{xmin:n<=i*t?0:n<i*t+t?n-i*t:t,ymin:s<=r*e?0:s<r*e+e?s-r*e:e,xmax:n+o<=i*t?0:n+o<i*t+t?n+o-i*t:t,ymax:s+a<=r*e?0:s+a<r*e+e?s+a-r*e:e}}function Iwt(t,e){if(!t||t.length===0)return null;const i=t.find(g=>g.pixelBlock);if(!i||i.pixelBlock==null)return null;const r=(i.extent.xmax-i.extent.xmin)/i.pixelBlock.width,n=(i.extent.ymax-i.extent.ymin)/i.pixelBlock.height,s=.01*Math.min(r,n),o=t.sort((g,y)=>Math.abs(g.extent.ymax-y.extent.ymax)>s?y.extent.ymax-g.extent.ymax:Math.abs(g.extent.xmin-y.extent.xmin)>s?g.extent.xmin-y.extent.xmin:0),a=Math.min.apply(null,o.map(g=>g.extent.xmin)),l=Math.min.apply(null,o.map(g=>g.extent.ymin)),c=Math.max.apply(null,o.map(g=>g.extent.xmax)),u=Math.max.apply(null,o.map(g=>g.extent.ymax)),h={x:Math.round((e.xmin-a)/r),y:Math.round((u-e.ymax)/n)},f={width:Math.round((c-a)/r),height:Math.round((u-l)/n)},m={width:Math.round((e.xmax-e.xmin)/r),height:Math.round((e.ymax-e.ymin)/n)};return Math.round(f.width/i.pixelBlock.width)*Math.round(f.height/i.pixelBlock.height)!==o.length||h.x<0||h.y<0||f.width<m.width||f.height<m.height?null:{extent:e,pixelBlock:IA(o.map(g=>g.pixelBlock),f,{clipOffset:h,clipSize:m})}}function b5(t,e,i,r,n,s){const{width:o,height:a}=i.block,{x:l,y:c}=i.offset,{width:u,height:h}=i.mosaic,f=x8e(o,a,r,n,l,c,u,h);let m=0,g=0;if(s){const y=s.hasGCSSShiftTransform?360:s.halfWorldWidth??0,v=o*s.resolutionX,b=s.startX+r*v;b<y&&b+v>y?g=s.rightPadding:b>=y&&(m=s.leftMargin-s.rightPadding,g=0)}if(f.xmax-=g,typeof e!="number")for(let y=f.ymin;y<f.ymax;y++){const v=(n*a+y-c)*u+(r*o-l)+m,b=y*o;for(let w=f.xmin;w<f.xmax;w++)t[v+w]=e[b+w]}else for(let y=f.ymin;y<f.ymax;y++){const v=(n*a+y-c)*u+(r*o-l)+m;for(let b=f.xmin;b<f.xmax;b++)t[v+b]=e}}function IA(t,e,i={}){var P;const{clipOffset:r,clipSize:n,alignmentInfo:s,blockWidths:o}=i;if(o)return S8e(t,e,{blockWidths:o});const a=t.find(k=>Gi(k));if(a==null)return null;const l=n?n.width:e.width,c=n?n.height:e.height,u=a.width,h=a.height,f=e.width/u,m=e.height/h,g={offset:r||{x:0,y:0},mosaic:n||e,block:{width:u,height:h}},y=a.pixelType,v=de.getPixelArrayConstructor(y),b=a.pixels.length,w=[];let x,S;for(let k=0;k<b;k++){S=new v(l*c);for(let L=0;L<m;L++)for(let F=0;F<f;F++){const V=t[L*f+F];Gi(V)&&(x=V.pixels[k],b5(S,x,g,F,L,s))}w.push(S)}const I=t.some(k=>k==null||k.mask!=null&&k.mask.length>0),T=t.some(k=>k!=null&&k.bandMasks&&k.bandMasks.length>1),C=I?new Uint8Array(l*c):void 0,E=T?[]:void 0;if(C){for(let k=0;k<m;k++)for(let L=0;L<f;L++){const F=t[k*f+L],V=F!=null?F.mask:null;b5(C,V??(F?255:0),g,L,k,s)}if(E)for(let k=0;k<b;k++){const L=new Uint8Array(l*c);for(let F=0;F<m;F++)for(let V=0;V<f;V++){const z=t[F*f+V],G=((P=z==null?void 0:z.bandMasks)==null?void 0:P[k])??(z==null?void 0:z.mask);b5(L,G??(z?255:0),g,V,F,s)}E.push(L)}}const $=new de({width:l,height:c,pixels:w,pixelType:y,bandMasks:E,mask:C});return $.updateStatistics(),$}function S8e(t,e,i){var v;const r=t.find(b=>b!=null);if(r==null)return null;const n=t.some(b=>b==null||!!b.mask),{width:s,height:o}=e,a=n?new Uint8Array(s*o):null,{blockWidths:l}=i,c=[],u=r.getPlaneCount(),h=de.getPixelArrayConstructor(r.pixelType);if(n)for(let b=0,w=0;b<t.length;w+=l[b],b++){const x=t[b];if(!Gi(x))continue;const S=x.mask;for(let I=0;I<o;I++)for(let T=0;T<l[b];T++)a[I*s+T+w]=S==null?255:S[I*x.width+T]}const f=t.some(b=>b!=null&&b.bandMasks&&b.bandMasks.length>1),m=f?[]:void 0,g=s*o;for(let b=0;b<u;b++){const w=new h(g),x=f?new Uint8Array(g):void 0;for(let S=0,I=0;S<t.length;I+=l[S],S++){const T=t[S];if(!Gi(T))continue;const C=T.pixels[b];if(C!=null){for(let E=0;E<o;E++)for(let $=0;$<l[S];$++)w[E*s+$+I]=C[E*T.width+$];if(x){const E=((v=T.bandMasks)==null?void 0:v[b])??T.mask;for(let $=0;$<o;$++)for(let P=0;P<l[S];P++)x[$*s+P+I]=E?E[$*T.width+P]:255}}}c.push(w),m&&x&&m.push(x)}const y=new de({width:s,height:o,mask:a,bandMasks:m,pixels:c,pixelType:r.pixelType});return y.updateStatistics(),y}function I8e(t,e,i){if(!Gi(t))return null;const{width:r,height:n}=t,s=e.x,o=e.y,a=i.width+s,l=i.height+o;if(s<0||o<0||a>r||l>n||s===0&&o===0&&a===r&&l===n)return t;t.mask||(t.mask=new Uint8Array(r*n));const c=t.mask;for(let u=0;u<n;u++){const h=u*r;for(let f=0;f<r;f++)c[h+f]=u<o||u>=l||f<s||f>=a?0:1}return t.updateStatistics(),t}function T8e(t){if(!Gi(t))return null;const e=t.clone(),{width:i,height:r,pixels:n}=t,s=n[0],o=e.pixels[0],a=t.mask;for(let l=2;l<r-1;l++){const c=new Map;for(let h=l-2;h<l+2;h++)for(let f=0;f<4;f++){const m=h*i+f;Dx(c,s[m],a?a[m]:1)}o[l*i]=eY(c),o[l*i+1]=o[l*i+2]=o[l*i];let u=3;for(;u<i-1;u++){let h=(l-2)*i+u+1;Dx(c,s[h],a?a[h]:1),h=(l-1)*i+u+1,Dx(c,s[h],a?a[h]:1),h=l*i+u+1,Dx(c,s[h],a?a[h]:1),h=(l+1)*i+u+1,Dx(c,s[h],a?a[h]:1),h=(l-2)*i+u-3,lM(c,s[h],a?a[h]:1),h=(l-1)*i+u-3,lM(c,s[h],a?a[h]:1),h=l*i+u-3,lM(c,s[h],a?a[h]:1),h=(l+1)*i+u-3,lM(c,s[h],a?a[h]:1),o[l*i+u]=eY(c)}o[l*i+u+1]=o[l*i+u]}for(let l=0;l<i;l++)o[l]=o[i+l]=o[2*i+l],o[(r-1)*i+l]=o[(r-2)*i+l];return e.updateStatistics(),e}function eY(t){if(t.size===0)return 0;let e=0,i=-1,r=0;const n=t.keys();let s=n.next();for(;!s.done;)r=t.get(s.value),r>e&&(i=s.value,e=r),s=n.next();return i}function lM(t,e,i){if(i===0)return;const r=t.get(e);r===1?t.delete(e):t.set(e,r-1)}function Dx(t,e,i){i!==0&&t.set(e,t.has(e)?t.get(e)+1:1)}function C8e(t,e,i){let{x:r,y:n}=e;const{width:s,height:o}=i;if(r===0&&n===0&&o===t.height&&s===t.width)return t;const{width:a,height:l}=t,c=Math.max(0,n),u=Math.max(0,r),h=Math.min(r+s,a),f=Math.min(n+o,l);if(h<0||f<0||!Gi(t))return null;r=Math.max(0,-r),n=Math.max(0,-n);const{pixels:m}=t,g=s*o,y=m.length,v=[];for(let S=0;S<y;S++){const I=m[S],T=de.createEmptyBand(t.pixelType,g);for(let C=c;C<f;C++){const E=C*a;let $=(C+n-c)*s+r;for(let P=u;P<h;P++)T[$++]=I[E+P]}v.push(T)}const b=new Uint8Array(g),w=t.mask;for(let S=c;S<f;S++){const I=S*a;let T=(S+n-c)*s+r;for(let C=u;C<h;C++)b[T++]=w?w[I+C]:1}const x=new de({width:i.width,height:i.height,pixelType:t.pixelType,pixels:v,mask:b});return x.updateStatistics(),x}function E8e(t,e=!0){if(!Gi(t))return null;const{pixels:i,width:r,height:n,mask:s,pixelType:o}=t,a=[],l=Math.round(r/2),c=Math.round(n/2),u=n-1,h=r-1;for(let m=0;m<i.length;m++){const g=i[m],y=de.createEmptyBand(o,l*c);let v=0;for(let b=0;b<n;b+=2)for(let w=0;w<r;w+=2){const x=g[b*r+w];if(e){const S=w===h?x:g[b*r+w+1],I=b===u?x:g[b*r+w+r],T=w===h?I:b===u?S:g[b*r+w+r+1];y[v++]=(x+S+I+T)/4}else y[v++]=x}a.push(y)}let f=null;if(s!=null){f=new Uint8Array(l*c);let m=0;for(let g=0;g<n;g+=2)for(let y=0;y<r;y+=2){const v=s[g*r+y];if(e){const b=y===h?v:s[g*r+y+1],w=g===u?v:s[g*r+y+r],x=y===h?w:g===u?b:s[g*r+y+r+1];f[m++]=v*b*w*x?1:0}else f[m++]=v}}return new de({width:l,height:c,pixelType:o,pixels:a,mask:f})}function M8e(t,e,i){if(!Gi(t))return null;const{width:r,height:n}=e;let{width:s,height:o}=t;const a=new Map,l={x:0,y:0},c=i==null?1:1+i;let u=t;for(let h=0;h<c;h++){const f=Math.ceil(s/r),m=Math.ceil(o/n);for(let g=0;g<m;g++){l.y=g*n;for(let y=0;y<f;y++){l.x=y*r;const v=C8e(u,l,e);a.set(`${h}/${g}/${y}`,v)}}h<c-1&&(u=E8e(u)),s=Math.round(s/2),o=Math.round(o/2)}return a}function Hpe(t,e,i,r,n=0){const{width:s,height:o}=t,{width:a,height:l}=e,c=r.cols,u=r.rows,h=Math.ceil(a/c-.1/c),f=Math.ceil(l/u-.1/u);let m,g,y,v,b,w,x;const S=h*c,I=S*f*u,T=new Float32Array(I),C=new Float32Array(I),E=new Uint32Array(I),$=new Uint32Array(I);let P,k,L=0;for(let F=0;F<f;F++)for(let V=0;V<h;V++){m=12*(F*h+V),g=i[m],y=i[m+1],v=i[m+2],b=i[m+3],w=i[m+4],x=i[m+5];for(let z=0;z<u;z++){L=(F*u+z)*S+V*c,k=(z+.5)/u;for(let G=0;G<z;G++)P=(G+.5)/c,T[L+G]=(g*P+y*k+v)*s+n,C[L+G]=(b*P+w*k+x)*o+n,E[L+G]=Math.floor(T[L+G]),$[L+G]=Math.floor(C[L+G])}m+=6,g=i[m],y=i[m+1],v=i[m+2],b=i[m+3],w=i[m+4],x=i[m+5];for(let z=0;z<u;z++){L=(F*u+z)*S+V*c,k=(z+.5)/u;for(let G=z;G<c;G++)P=(G+.5)/c,T[L+G]=(g*P+y*k+v)*s+n,C[L+G]=(b*P+w*k+x)*o+n,E[L+G]=Math.floor(T[L+G]),$[L+G]=Math.floor(C[L+G])}}return{offsets_x:T,offsets_y:C,offsets_xi:E,offsets_yi:$,gridWidth:S}}function $8e(t,e){const{coefficients:i,spacing:r}=e,{offsets_x:n,offsets_y:s,gridWidth:o}=Hpe(t,t,i,{rows:r[0],cols:r[1]}),{width:a,height:l}=t,c=new Float32Array(a*l),u=180/Math.PI;for(let h=0;h<l;h++)for(let f=0;f<a;f++){const m=h*o+f,g=h===0?m:m-o,y=h===l-1?m:m+o,v=n[g]-n[y],b=s[y]-s[g];if(isNaN(v)||isNaN(b))c[h*a+f]=90;else{let w=Math.atan2(b,v)*u;w=(360+w)%360,c[h*a+f]=w}}return c}function qpe(t,e,i,r,n="nearest"){if(!Gi(t))return null;n==="majority"&&(t=T8e(t));const{pixels:s,mask:o,bandMasks:a,pixelType:l}=t,c=t.width,u=t.height,h=de.getPixelArrayConstructor(l),f=s.length,{width:m,height:g}=e;let y=!1;for(let L=0;L<i.length;L+=3)i[L]===-1&&i[L+1]===-1&&i[L+2]===-1&&(y=!0);const{offsets_x:v,offsets_y:b,offsets_xi:w,offsets_yi:x,gridWidth:S}=Hpe({width:c,height:u},e,i,r,n==="majority"?.5:0);let I;const T=(L,F,V,z)=>{const G=L instanceof Float32Array||L instanceof Float64Array?0:.5;for(let H=0;H<g;H++){I=H*S;for(let Z=0;Z<m;Z++){if(v[I]<0||b[I]<0)L[H*m+Z]=0;else if(z)L[H*m+Z]=F[w[I]+x[I]*c];else{const K=Math.floor(v[I]),X=Math.floor(b[I]),oe=Math.ceil(v[I]),se=Math.ceil(b[I]),le=v[I]-K,me=b[I]-X;if(!V||V[K+X*c]&&V[oe+X*c]&&V[K+se*c]&&V[oe+se*c]){const Se=(1-le)*F[K+X*c]+le*F[oe+X*c],Ge=(1-le)*F[K+se*c]+le*F[oe+se*c];L[H*m+Z]=(1-me)*Se+me*Ge+G}else L[H*m+Z]=F[w[I]+x[I]*c]}I++}}},C=[];let E;const $=(a==null?void 0:a.length)===f,P=[];for(let L=0;L<f;L++){if($){const F=new Uint8Array(m*g);T(F,a[L],a[L],!0),P.push(F)}E=new h(m*g),T(E,s[L],$?a[L]:o,n==="nearest"||n==="majority"),C.push(E)}const k=new de({width:m,height:g,pixelType:l,pixels:C,bandMasks:$?P:void 0});if(o!=null)k.mask=new Uint8Array(m*g),T(k.mask,o,o,!0);else if(y){k.mask=new Uint8Array(m*g);for(let L=0;L<m*g;L++)k.mask[L]=v[L]<0||b[L]<0?0:1}return k.updateStatistics(),k}const P0=new Map;P0.set("meter-per-second",1),P0.set("kilometer-per-hour",.277778),P0.set("knots",.514444),P0.set("feet-per-second",.3048),P0.set("mile-per-hour",.44704);const vz=180/Math.PI,j9=5,Za=new He({esriMetersPerSecond:"meter-per-second",esriKilometersPerHour:"kilometer-per-hour",esriKnots:"knots",esriFeetPerSecond:"feet-per-second",esriMilesPerHour:"mile-per-hour"});function YL(t,e){return P0.get(t)/P0.get(e)||1}function Wpe(t){return(450-t)%360}function B9(t,e="geographic"){const[i,r]=t,n=Math.sqrt(i*i+r*r);let s=Math.atan2(r,i)*vz;return s=(360+s)%360,e==="geographic"&&(s=Wpe(s)),[n,s]}function Jpe(t,e="geographic"){let i=t[1];e==="geographic"&&(i=Wpe(i)),i%=360;const r=t[0];return[r*Math.cos(i/vz),r*Math.sin(i/vz)]}function A8e(t,e,i,r="geographic"){if(!Gi(t)||i==null)return t;const n=e==="vector-magdir"?t.clone():RP(t,e),s=n.pixels[1];for(let o=0;o<s.length;o++)s[o]=r==="geographic"?(s[o]+i[o]+270)%360:(s[o]+360-i[o])%360;return e==="vector-magdir"?n:RP(n,"vector-magdir")}function RP(t,e,i="geographic",r=1){if(!Gi(t))return t;const{pixels:n,width:s,height:o}=t,a=s*o,l=n[0],c=n[1],u=t.pixelType.startsWith("f")?t.pixelType:"f32",h=de.createEmptyBand(u,a),f=de.createEmptyBand(u,a);let m=0;for(let y=0;y<o;y++)for(let v=0;v<s;v++)e==="vector-uv"?([h[m],f[m]]=B9([l[m],c[m]],i),h[m]*=r):([h[m],f[m]]=Jpe([l[m],c[m]],i),h[m]*=r,f[m]*=r),m++;const g=new de({pixelType:u,width:t.width,height:t.height,mask:t.mask,validPixelCount:t.validPixelCount,maskIsAlpha:t.maskIsAlpha,pixels:[h,f]});return g.updateStatistics(),g}function k8e(t,e,i=1){if(i===1||!Gi(t))return t;const r=t.clone(),{pixels:n,width:s,height:o}=r,a=n[0],l=n[1];let c=0;for(let u=0;u<o;u++)for(let h=0;h<s;h++)e==="vector-uv"?(a[c]*=i,l[c]*=i):a[c]*=i,c++;return r.updateStatistics(),r}function Twt(t,e,i,r,n){if(n==null||!n.spatialReference.equals(t.spatialReference))return{extent:t,width:Math.round(e/r),height:Math.round(i/r),resolution:t.width/e};const s=n.xmin,o=n.ymax,a=(t.xmax-t.xmin)/e*r,l=(t.ymax-t.ymin)/i*r,c=(a+l)/2;return t.xmin=s+Math.floor((t.xmin-s)/a)*a,t.xmax=s+Math.ceil((t.xmax-s)/a)*a,t.ymin=o+Math.floor((t.ymin-o)/l)*l,t.ymax=o+Math.ceil((t.ymax-o)/l)*l,{extent:t,width:Math.round(t.width/a),height:Math.round(t.height/l),resolution:c}}const P8e=Zpe(0,0,0);function Zpe(t=0,e=0,i=Math.PI,r=!0){r&&(i=(2*Math.PI-i)%(2*Math.PI));const n=r?-1:1,s=13*n,o=-7*n,a=-2*n,l=-16*n,c=21.75,[u,h]=ks(0,e+s,i,c),[f,m]=ks(t-5.5,e+o,i,c),[g,y]=ks(t+5.5,e+o,i,c),[v,b]=ks(t-1.5,e+a,i,c),[w,x]=ks(t+1.5,e+a,i,c),[S,I]=ks(t-1.5,e+l,i,c),[T,C]=ks(t+1.5,e+l,i,c);return[u,h,f,m,v,b,w,x,g,y,S,I,T,C]}function O8e(t=0,e=Math.PI,i=!0){i&&(e=(2*Math.PI-e)%(2*Math.PI));const r=10,n=i?-1:1,s=5*n,o=20*n,a=25*n,l=45,c=0,u=0,h=2,f=0,m=h*n,g=i?1:-1,y=r/2*g;let[v,b]=[c+y,u-o],[w,x]=[v+h*g,b],[S,I]=[w-f*g,x+m],[T,C]=[c-y,u-a],[E,$]=[T+f*g,C-m],P=Math.ceil(t/j9),k=Math.floor(P/10);P-=8*k;const L=[],F=[];for(let le=0;le<P/2;le++,k--){k<=0&&P%2==1&&le===(P-1)/2&&(T=c,E=T+f*g,C=(C+b)/2,$=C-m);const[me,Se]=ks(T,C,e,l);if(k>0){const[Ge,Be]=ks(w,C,e,l),[gt,Pe]=ks(v,b,e,l);L.push(Ge),L.push(Be),L.push(me),L.push(Se),L.push(gt),L.push(Pe)}else{const[Ge,Be]=ks(w,x,e,l),[gt,Pe]=ks(S,I,e,l),[De,ii]=ks(E,$,e,l);F.push(me),F.push(Se),F.push(De),F.push(ii),F.push(gt),F.push(Pe),F.push(Ge),F.push(Be)}C+=s,b+=s,x+=s,I+=s,$+=s}const[V,z]=ks(c+y,u+o,e,l),G=(r/2+h)*g,[H,Z]=ks(c+G,u+o,e,l),[K,X]=ks(c+y,u-a,e,l),[oe,se]=ks(c+G,u-a,e,l);return{pennants:L,barbs:F,shaft:[V,z,H,Z,K,X,oe,se]}}function ks(t,e,i,r=1){const n=Math.sqrt(t*t+e*e)/r,s=(2*Math.PI+Math.atan2(e,t))%(2*Math.PI);return[n,(2*Math.PI+s-i)%(2*Math.PI)]}const cM=[0,1,3,6,10,16,21,27,33,40,47,55,63],L8e=[0,.5,1,1.5,2],R8e=[0,.25,.5,1,1.5,2,2.5,3,3.5,4];function Bg(t,e,i,r){const n=YL(r||"knots",i);let s;for(s=1;s<e.length;s++)if(s===e.length-1){if(t<e[s]*n)break}else if(t<=e[s]*n)break;return Math.min(s-1,e.length-2)}function F8e(t,e,i,r,n){let s=0;switch(e){case"beaufort_kn":s=Bg(t,cM,"knots",i);break;case"beaufort_km":s=Bg(t,cM,"kilometer-per-hour",i);break;case"beaufort_ft":s=Bg(t,cM,"feet-per-second",i);break;case"beaufort_m":s=Bg(t,cM,"meter-per-second",i);break;case"classified_arrow":s=Bg(t,n??[],r,i);break;case"ocean_current_m":s=Bg(t,L8e,"meter-per-second",i);break;case"ocean_current_kn":s=Bg(t,R8e,"knots",i)}return s}function D8e(t,e){const{style:i,inputUnit:r,outputUnit:n,breakValues:s}=e,o=Za.fromJSON(r),a=Za.fromJSON(n),l=7*6,c=15;let u=0,h=0;const{width:f,height:m,mask:g}=t,y=t.pixels[0],v=t.pixels[1],b=g!=null?g.filter(I=>I>0).length:f*m,w=new Float32Array(b*l),x=new Uint32Array(c*b),S=e.invertDirection?Zpe(0,0,0,!1):P8e;for(let I=0;I<m;I++)for(let T=0;T<f;T++){const C=I*f+T;if(!g||g[I*f+T]){const E=(v[C]+360)%360/180*Math.PI,$=F8e(y[C],i,o,a,s);for(let k=0;k<S.length;k+=2)w[u++]=(T+.5)/f,w[u++]=(I+.5)/m,w[u++]=S[k],w[u++]=S[k+1]+E,w[u++]=$,w[u++]=y[C];const P=7*(u/l-1);x[h++]=P,x[h++]=P+1,x[h++]=P+2,x[h++]=P+0,x[h++]=P+4,x[h++]=P+3,x[h++]=P+0,x[h++]=P+2,x[h++]=P+3,x[h++]=P+2,x[h++]=P+5,x[h++]=P+3,x[h++]=P+5,x[h++]=P+6,x[h++]=P+3}}return{vertexData:w,indexData:x}}const w5=[];function N8e(t,e){if(w5.length===0)for(let m=0;m<30;m++)w5.push(O8e(5*m,0,!e.invertDirection));const i=YL(Za.fromJSON(e.inputUnit),"knots"),{width:r,height:n,mask:s}=t,o=t.pixels[0],a=t.pixels[1],l=6,c=[],u=[];let h=0,f=0;for(let m=0;m<n;m++)for(let g=0;g<r;g++){const y=m*r+g,v=o[y]*i;if((!s||s[m*r+g])&&v>=j9){const b=(a[y]+360)%360/180*Math.PI,{pennants:w,barbs:x,shaft:S}=w5[Math.min(Math.floor(v/5),29)];if(w.length+x.length===0)continue;let I=c.length/l;const T=(g+.5)/r,C=(m+.5)/n;for(let E=0;E<w.length;E+=2)c[h++]=T,c[h++]=C,c[h++]=w[E],c[h++]=w[E+1]+b,c[h++]=0,c[h++]=v;for(let E=0;E<x.length;E+=2)c[h++]=T,c[h++]=C,c[h++]=x[E],c[h++]=x[E+1]+b,c[h++]=0,c[h++]=v;for(let E=0;E<S.length;E+=2)c[h++]=T,c[h++]=C,c[h++]=S[E],c[h++]=S[E+1]+b,c[h++]=0,c[h++]=v;for(let E=0;E<w.length/6;E++)u[f++]=I,u[f++]=I+1,u[f++]=I+2,I+=3;for(let E=0;E<x.length/8;E++)u[f++]=I,u[f++]=I+1,u[f++]=I+2,u[f++]=I+1,u[f++]=I+2,u[f++]=I+3,I+=4;u[f++]=I+0,u[f++]=I+1,u[f++]=I+2,u[f++]=I+1,u[f++]=I+3,u[f++]=I+2,I+=4}}return{vertexData:new Float32Array(c),indexData:new Uint32Array(u)}}function V8e(t,e){let r=0,n=0;const{width:s,height:o,mask:a}=t,l=t.pixels[0],c=[],u=[],h=YL(Za.fromJSON(e.inputUnit),"knots"),f=e.style==="wind_speed"?j9:Number.MAX_VALUE;for(let m=0;m<o;m++)for(let g=0;g<s;g++){const y=l[m*s+g]*h;if((!a||a[m*s+g])&&y<f){for(let b=0;b<4;b++)c[r++]=(g+.5)/s,c[r++]=(m+.5)/o,c[r++]=b<2?-.5:.5,c[r++]=b%2==0?-.5:.5,c[r++]=0,c[r++]=y;const v=4*(r/24-1);u[n++]=v,u[n++]=v+1,u[n++]=v+2,u[n++]=v+1,u[n++]=v+2,u[n++]=v+3}}return{vertexData:new Float32Array(c),indexData:new Uint32Array(u)}}function Cwt(t,e){return e.style==="simple_scalar"?V8e(t,e):e.style==="wind_speed"?N8e(t,e):D8e(t,e)}function Ewt(t,e,i,r=[0,0],n=.5){const{width:s,height:o,mask:a}=t,[l,c]=t.pixels,[u,h]=r,f=Math.round((s-u)/i),m=Math.round((o-h)/i),g=f*m,y=new Float32Array(g),v=new Float32Array(g),b=new Uint8Array(g),w=e==="vector-uv";for(let S=0;S<m;S++)for(let I=0;I<f;I++){let T=0;const C=S*f+I,E=Math.max(0,S*i+h),$=Math.max(0,I*i+u),P=Math.min(o,E+i),k=Math.min(s,$+i);for(let L=E;L<P;L++)for(let F=$;F<k;F++){const V=L*s+F;if(!a||a[V]){T++;const z=w?[l[V],c[V]]:[l[V],(360+c[V])%360],[G,H]=w?z:Jpe(z);y[C]+=G,v[C]+=H}}if(T>=(P-E)*(k-$)*(1-n)){b[C]=1;const[L,F]=B9([y[C]/T,v[C]/T]);y[C]=L,v[C]=F}else b[C]=0,y[C]=0,v[C]=0}const x=new de({width:f,height:m,pixels:[y,v],mask:b});return x.updateStatistics(),x}function z8e(t){return typeof t=="function"}function Mwt(t,e,i,r){return z8e(t)?t(e,i,r):t}function $wt(t){return[t.r,t.g,t.b,t.a]}const j8e=` /-,
`;function tY(t){let e=t.length;for(;e--;)if(!j8e.includes(t.charAt(e)))return!1;return!0}function B8e(t,e){const i=[];let r=0,n=-1;do if(n=t.indexOf("[",r),n>=r){if(n>r){const s=t.substr(r,n-r);i.push([s,null,tY(s)])}if(r=n+1,n=t.indexOf("]",r),n>=r){if(n>r){const s=e[t.substr(r,n-r)];s&&i.push([null,s,!1])}r=n+1}}while(n!==-1);if(r<t.length-1){const s=t.substr(r);i.push([s,null,tY(s)])}return i}function U8e(t,e,i){let r="",n=null;for(const s of e){const[o,a,l]=s;if(o)l?n=o:(n&&(r+=n,n=null),r+=o);else{const c=t.attributes[a];c&&(n&&(r+=n,n=null),r+=c)}}return G8e(r,i)}function Awt(t,e,i){const r=B8e(e,t);return n=>U8e(n,r,i)}function G8e(t,e){switch(typeof t!="string"&&(t=String(t)),e){case"LowerCase":return t.toLowerCase();case"Allcaps":return t.toUpperCase();default:return t}}function kwt(t,e,i,r,n,s,o=!0){const a=e/n,l=i/s,c=Math.ceil(a/2),u=Math.ceil(l/2);for(let h=0;h<s;h++)for(let f=0;f<n;f++){const m=4*(f+(o?s-h-1:h)*n);let g=0,y=0,v=0,b=0,w=0,x=0,S=0;const I=(h+.5)*l;for(let T=Math.floor(h*l);T<(h+1)*l;T++){const C=Math.abs(I-(T+.5))/u,E=(f+.5)*a,$=C*C;for(let P=Math.floor(f*a);P<(f+1)*a;P++){let k=Math.abs(E-(P+.5))/c;const L=Math.sqrt($+k*k);L>=-1&&L<=1&&(g=2*L*L*L-3*L*L+1,g>0&&(k=4*(P+T*e),S+=g*t[k+3],v+=g,t[k+3]<255&&(g=g*t[k+3]/250),b+=g*t[k],w+=g*t[k+1],x+=g*t[k+2],y+=g))}}r[m]=b/y,r[m+1]=w/y,r[m+2]=x/y,r[m+3]=S/v}}function Ype(t){return t?{r:t[0],g:t[1],b:t[2],a:t[3]/255}:{r:0,g:0,b:0,a:0}}function Kpe(t){var e;return((e=t.data)==null?void 0:e.symbol)??null}function _z(t){return t.type==="CIMVectorMarker"||t.type==="CIMPictureMarker"||t.type==="CIMBarChartMarker"||t.type==="CIMCharacterMarker"||t.type==="CIMPieChartMarker"||t.type==="CIMStackedBarChartMarker"}function bz(t){return t.type==="CIMGradientStroke"||t.type==="CIMPictureStroke"||t.type==="CIMSolidStroke"}function H8e(t){return t!=null&&(t.type==="CIMGradientFill"||t.type==="CIMHatchFill"||t.type==="CIMPictureFill"||t.type==="CIMSolidFill"||t.type==="CIMWaterFill")}function FP(t){return t!=null&&(t.type==="CIMMarkerPlacementAlongLineRandomSize"||t.type==="CIMMarkerPlacementAlongLineSameSize"||t.type==="CIMMarkerPlacementAlongLineVariableSize"||t.type==="CIMMarkerPlacementAtExtremities"||t.type==="CIMMarkerPlacementAtMeasuredUnits"||t.type==="CIMMarkerPlacementAtRatioPositions"||t.type==="CIMMarkerPlacementOnLine"||t.type==="CIMMarkerPlacementOnVertices")}const Pwt=(t,e=0)=>t==null||isNaN(t)?e:t,Owt=t=>t.tintColor?Ype(t.tintColor):{r:255,g:255,b:255,a:1},Lwt=t=>{if(!t)return!1;for(const e of t)switch(e.type){case"CIMGeometricEffectBuffer":case"CIMGeometricEffectOffset":case"CIMGeometricEffectDonut":return!0}return!1};function Rwt(){return W(()=>import("./geometryEngineJSON-22683569.js"),["./geometryEngineJSON-22683569.js","./geometryEngineBase-eec52f2a.js","./geometryEngineJSON-2c17178a.js","./json-48e3ea08.js"],import.meta.url)}function Fwt(t){if(!t)return"normal";switch(t.toLowerCase()){case"italic":return"italic";case"oblique":return"oblique";default:return"normal"}}function Dwt(t){if(!t)return"normal";switch(t.toLowerCase()){case"bold":return"bold";case"bolder":return"bolder";case"lighter":return"lighter";default:return"normal"}}function Nwt(t){let e="normal",i="normal";if(t){const r=t.toLowerCase();r.includes("italic")?e="italic":r.includes("oblique")&&(e="oblique"),r.includes("bold")?i="bold":r.includes("light")&&(i="lighter")}return{style:e,weight:i}}function Vwt(t){return t.underline?"underline":t.strikethrough?"line-through":"none"}function iY(t){if(!t)return null;switch(t.type){case"CIMPolygonSymbol":if(t.symbolLayers)for(const e of t.symbolLayers){const i=iY(e);if(i!=null)return i}break;case"CIMTextSymbol":return iY(t.symbol);case"CIMSolidFill":return t.color}}function rY(t){if(t)switch(t.type){case"CIMPolygonSymbol":case"CIMLineSymbol":{const e=t.symbolLayers;if(e)for(const i of e){const r=rY(i);if(r!=null)return r}break}case"CIMTextSymbol":return rY(t.symbol);case"CIMSolidStroke":return t.color}}function nY(t){if(t)switch(t.type){case"CIMPolygonSymbol":case"CIMLineSymbol":if(t.symbolLayers)for(const e of t.symbolLayers){const i=nY(e);if(i!==void 0)return i}break;case"CIMTextSymbol":return nY(t.symbol);case"CIMSolidStroke":case"CIMGradientStroke":case"CIMPictureStroke":return t.width}}function zwt(t){switch(t){case"Left":default:return"left";case"Right":return"right";case"Center":case"Justify":return"center"}}function jwt(t){switch(t){case"Top":default:return"top";case"Center":return"middle";case"Baseline":return"baseline";case"Bottom":return"bottom"}}function Bwt(t){return(t?Object.keys(t):[]).map(e=>({name:e,alias:e,type:typeof t[e]=="string"?"esriFieldTypeString":"esriFieldTypeDouble"}))}const Uwt=t=>t.includes("data:image/svg+xml");function Gwt(t){if(!t)return null;switch(t.type){case"CIMPointSymbol":case"CIMTextSymbol":return"esriGeometryPoint";case"CIMLineSymbol":return"esriGeometryPolyline";case"CIMPolygonSymbol":return"esriGeometryPolygon";default:return null}}function Xpe(t,e,i,r){if(t)if(t.type!=="CIMTextSymbol"){if(i&&t.effects)for(const n of t.effects)J8e(n,e);if(t.symbolLayers)for(const n of t.symbolLayers)switch(n.type){case"CIMPictureMarker":case"CIMVectorMarker":q8e(n,e,r);break;case"CIMPictureStroke":case"CIMSolidStroke":!(r!=null&&r.preserveOutlineWidth)&&n.width&&(n.width*=e);break;case"CIMPictureFill":n.height&&(n.height*=e),n.offsetX&&(n.offsetX*=e),n.offsetY&&(n.offsetY*=e);break;case"CIMHatchFill":Xpe(n.lineSymbol,e,!0,{...r,preserveOutlineWidth:!1}),n.offsetX&&(n.offsetX*=e),n.offsetY&&(n.offsetY*=e),n.separation&&(n.separation*=e)}}else t.height!=null&&(t.height*=e)}function q8e(t,e,i){if(t&&(t.markerPlacement&&W8e(t.markerPlacement,e),t.offsetX&&(t.offsetX*=e),t.offsetY&&(t.offsetY*=e),t.anchorPoint&&t.anchorPointUnits==="Absolute"&&(t.anchorPoint={x:t.anchorPoint.x*e,y:t.anchorPoint.y*e}),t.size=t.size!=null?t.size*e:0,t.type==="CIMVectorMarker"&&t.markerGraphics))for(const r of t.markerGraphics)t.scaleSymbolsProportionally||Xpe(r.symbol,e,!0,i)}function W8e(t,e){switch(FP(t)&&t.offset&&(t.offset*=e),t.type){case"CIMMarkerPlacementAlongLineRandomSize":case"CIMMarkerPlacementAlongLineSameSize":if(t.customEndingOffset&&(t.customEndingOffset*=e),t.offsetAlongLine&&(t.offsetAlongLine*=e),t.placementTemplate&&t.placementTemplate.length){const i=t.placementTemplate.map(r=>r*e);t.placementTemplate=i}break;case"CIMMarkerPlacementAlongLineVariableSize":if(t.maxRandomOffset&&(t.maxRandomOffset*=e),t.placementTemplate&&t.placementTemplate.length){const i=t.placementTemplate.map(r=>r*e);t.placementTemplate=i}break;case"CIMMarkerPlacementOnLine":t.startPointOffset&&(t.startPointOffset*=e);break;case"CIMMarkerPlacementAtExtremities":t.offsetAlongLine&&(t.offsetAlongLine*=e);break;case"CIMMarkerPlacementAtMeasuredUnits":case"CIMMarkerPlacementOnVertices":break;case"CIMMarkerPlacementAtRatioPositions":t.beginPosition&&(t.beginPosition*=e),t.endPosition&&(t.endPosition*=e);break;case"CIMMarkerPlacementPolygonCenter":t.offsetX&&(t.offsetX*=e),t.offsetY&&(t.offsetY*=e);break;case"CIMMarkerPlacementInsidePolygon":t.offsetX&&(t.offsetX*=e),t.offsetY&&(t.offsetY*=e),t.stepX&&(t.stepX*=e),t.stepY&&(t.stepY*=e)}}function J8e(t,e){switch(t.type){case"CIMGeometricEffectArrow":case"CIMGeometricEffectDonut":t.width&&(t.width*=e);break;case"CIMGeometricEffectBuffer":t.size&&(t.size*=e);break;case"CIMGeometricEffectCut":t.beginCut&&(t.beginCut*=e),t.endCut&&(t.endCut*=e),t.middleCut&&(t.middleCut*=e);break;case"CIMGeometricEffectDashes":if(t.customEndingOffset&&(t.customEndingOffset*=e),t.offsetAlongLine&&(t.offsetAlongLine*=e),t.dashTemplate&&t.dashTemplate.length){const i=t.dashTemplate.map(r=>r*e);t.dashTemplate=i}break;case"CIMGeometricEffectExtension":case"CIMGeometricEffectJog":case"CIMGeometricEffectRadial":t.length&&(t.length*=e);break;case"CIMGeometricEffectMove":t.offsetX&&(t.offsetX*=e),t.offsetY&&(t.offsetY*=e);break;case"CIMGeometricEffectOffset":case"CIMGeometricEffectOffsetTangent":t.offset&&(t.offset*=e);break;case"CIMGeometricEffectRegularPolygon":t.radius&&(t.radius*=e);break;case"CIMGeometricEffectTaperedPolygon":t.fromWidth&&(t.fromWidth*=e),t.length&&(t.length*=e),t.toWidth&&(t.toWidth*=e);break;case"CIMGeometricEffectWave":t.amplitude&&(t.amplitude*=e),t.period&&(t.period*=e)}}function Qpe(t){const e=[];return wz(Kpe(t),e),e.length?new ce(Ype(e[0])):null}function wz(t,e){var n;if(!t)return;let i;i=t.type==="CIMTextSymbol"?t.symbol:t;const r=t.type==="CIMPolygonSymbol";if(i!=null&&i.symbolLayers){for(const s of i.symbolLayers)if(!(s.colorLocked||r&&(bz(s)||_z(s)&&s.markerPlacement&&FP(s.markerPlacement))))switch(s.type){case"CIMPictureMarker":case"CIMPictureStroke":case"CIMPictureFill":s.tintColor&&sY(e,s.tintColor);break;case"CIMVectorMarker":(n=s.markerGraphics)==null||n.forEach(o=>{wz(o.symbol,e)});break;case"CIMSolidStroke":case"CIMSolidFill":sY(e,s.color);break;case"CIMHatchFill":wz(s.lineSymbol,e)}}}function sY(t,e){for(const i of t)if(i.join(".")===e.join("."))return;t.push(e)}function efe(t,e,i){e instanceof ce||(e=new ce(e));const r=Kpe(t);r&&xz(r,e,i)}function xz(t,e,i){var s;if(!t)return;let r;r=t.type==="CIMTextSymbol"?t.symbol:t;const n=(r==null?void 0:r.type)==="CIMPolygonSymbol";if(r!=null&&r.symbolLayers)for(const o of r.symbolLayers){if(o.colorLocked)continue;if(n){if(i){const{layersToColor:l}=i;if((bz(o)||_z(o)&&o.markerPlacement&&FP(o.markerPlacement))&&l==="fill"||H8e(o)&&l==="outline")continue}else if(bz(o)||_z(o)&&o.markerPlacement&&FP(o.markerPlacement))continue}const a=e.toArray();switch(o.type){case"CIMPictureMarker":case"CIMPictureStroke":case"CIMPictureFill":o.tintColor=a;break;case"CIMVectorMarker":(s=o.markerGraphics)==null||s.forEach(l=>{xz(l.symbol,e,i)});break;case"CIMSolidStroke":case"CIMSolidFill":o.color=a;break;case"CIMHatchFill":xz(o.lineSymbol,e,i)}}}const tfe="picture-fill",ife="simple-fill",Z8e="simple-line",rfe="simple-marker",Y8e="text",K8e="cim",x5=new LL(1e3);function X8e(t){const e=t.style;let i=null;if(t)switch(t.type){case rfe:e!=="cross"&&e!=="x"&&(i=t.color);break;case ife:e==="solid"?i=t.color:e!=="none"&&(i={type:"pattern",x:0,y:0,src:Tt(`esri/symbols/patterns/${e}.png`),width:5,height:5});break;case tfe:i={type:"pattern",src:t.url,width:or(t.width)*t.xscale,height:or(t.height)*t.yscale,x:or(t.xoffset),y:or(t.yoffset)};break;case Y8e:i=t.color;break;case K8e:i=Qpe(t)}return i}function Q8e(t,e){const i=t+"-"+e;return x5.get(i)!==void 0?Promise.resolve(x5.get(i)):at(t,{responseType:"image"}).then(r=>{const n=r.data,s=n.naturalWidth,o=n.naturalHeight,a=document.createElement("canvas");a.width=s,a.height=o;const l=a.getContext("2d");l.fillStyle=e,l.fillRect(0,0,s,o),l.globalCompositeOperation="destination-in",l.drawImage(n,0,0);const c=a.toDataURL();return x5.put(i,c),c})}function vT(t){if(!t)return null;let e=null;switch(t.type){case ife:case tfe:case rfe:e=vT(t.outline);break;case Z8e:{const i=or(t.width);t.style!=null&&t.style!=="none"&&i!==0&&(e={color:t.color,style:U9(t.style),width:i,cap:t.cap,join:t.join==="miter"?or(t.miterLimit):t.join});break}default:e=null}return e}const U9=(()=>{const t={};return e=>{if(t[e])return t[e];const i=e.replaceAll("-","");return t[e]=i,i}})(),e6e=new ce([128,128,128]),t6e=new ce("white");function i6e(t){var i,r;const e=(i=t.symbolLayers)==null?void 0:i.at(-1);if(e&&"outline"in e)return(r=e==null?void 0:e.outline)==null?void 0:r.size}function r6e(t){var e;if(!t)return 0;if(Bd(t)){const i=i6e(t);return i??0}return wa((e=vT(t))==null?void 0:e.width)}function KL(t){if(t==null||!("symbolLayers"in t)||t.symbolLayers==null)return!1;switch(t.type){case"point-3d":return t.symbolLayers.some(e=>e.type==="object");case"line-3d":return t.symbolLayers.some(e=>e.type==="path");case"polygon-3d":return t.symbolLayers.some(e=>e.type==="object"||e.type==="extrude");default:return!1}}function n6e(t){return us(t.resource).href}function b_(t,e){if(!t)return null;let i=null;return Bd(t)?i=s6e(t):pL(t)&&(i=t.type==="cim"?Qpe(t):t.color?new ce(t.color):null),i?_T(i,e):null}function s6e(t){const e=t.symbolLayers;if(!e)return null;let i=null;return e.forEach(r=>{var n;r.type==="object"&&((n=r.resource)!=null&&n.href)||(i=r.type==="water"?r.color:r.material?r.material.color:null)}),i?new ce(i):null}function _T(t,e){if(e==null||t==null)return t;const i=t.toRgba();return i[3]=i[3]*e,new ce(i)}function o6e(t,e,i){const r=t.symbolLayers;if(!r)return;const n=s=>_T(e=e??s??(i!=null?t6e:null),i);r.forEach(s=>{var o;if(s.type!=="object"||!((o=s.resource)!=null&&o.href)||e)if(s.type==="water")s.color=n(s.color);else{const a=s.material!=null?s.material.color:null,l=n(a);s.material==null?s.material=new sl({color:l}):s.material.color=l,i!=null&&"outline"in s&&s.outline!=null&&s.outline.color!=null&&(s.outline.color=_T(s.outline.color,i))}})}function a6e(t,e,i){(e=e??t.color)&&(t.color=_T(e,i)),i!=null&&"outline"in t&&t.outline&&t.outline.color&&(t.outline.color=_T(t.outline.color,i))}function S5(t,e,i){t&&(e||i!=null)&&(e&&(e=new ce(e)),Bd(t)?o6e(t,e,i):pL(t)&&a6e(t,e,i))}async function l6e(t,e){const i=t.symbolLayers;i&&await mSe(i,async r=>c6e(r,e))}async function c6e(t,e){switch(t.type){case"extrude":d6e(t,e);break;case"icon":case"line":case"text":u6e(t,e);break;case"path":p6e(t,e);break;case"object":await h6e(t,e)}}function u6e(t,e){const i=nfe(e);i!=null&&(t.size=i)}function nfe(t){for(const e of t)if(typeof e=="number")return e;return null}function d6e(t,e){t.size=typeof e[2]=="number"?e[2]:0}async function h6e(t,e){const{resourceSize:i,symbolSize:r}=await f6e(t),n=sfe(e,i,r);t.width=cI(e[0],r[0],i[0],n),t.depth=cI(e[1],r[1],i[1],n),t.height=cI(e[2],r[2],i[2],n)}function p6e(t,e){const i=sfe(e,Ese,[t.width,void 0,t.height]);t.width=cI(e[0],t.width,1,i),t.height=cI(e[2],t.height,1,i)}function sfe(t,e,i){for(let r=0;r<3;r++){const n=t[r];switch(n){case"symbol-value":{const s=i[r];return s!=null?s/e[r]:1}case"proportional":break;default:if(n&&e[r])return n/e[r]}}return 1}async function f6e(t){const{computeObjectLayerResourceSize:e}=await W(()=>import("./symbolLayerUtils-442cc767.js"),[],import.meta.url),i=await e(t,10),{width:r,height:n,depth:s}=t,o=[r,s,n];let a=1;for(let l=0;l<3;l++){const c=o[l];if(c!=null){a=c/i[l];break}}for(let l=0;l<3;l++)o[l]==null&&(o[l]=i[l]*a);return{resourceSize:i,symbolSize:o}}function cI(t,e,i,r){switch(t){case"proportional":return i*r;case"symbol-value":return e??i;default:return t}}function m6e(t,e){const i=nfe(e);if(i!=null)switch(t.type){case"simple-marker":t.size=i;break;case"picture-marker":{const r=t.width/t.height;r>1?(t.width=i,t.height=i*r):(t.width=i*r,t.height=i);break}case"simple-line":t.width=i;break;case"text":t.font.size=i}}async function ofe(t,e){if(t&&e)return Bd(t)?l6e(t,e):void(pL(t)&&m6e(t,e))}function afe(t,e,i){if(t&&e!=null)if(Bd(t)){const r=t.symbolLayers;r&&r.forEach(n=>{if(n&&n.type==="object")switch(i){case"tilt":n.tilt=e;break;case"roll":n.roll=e;break;default:n.heading=e}})}else pL(t)&&(t.type!=="simple-marker"&&t.type!=="picture-marker"&&t.type!=="text"||(t.angle=e))}function bT(t){if(!t)return null;const e=t.effects.filter(i=>i.type!=="bloom").map(i=>i.toJSON());return EP(e)}function Hwt(t){return t!=null&&t.type==="polygon-3d"&&t.symbolLayers.some(e=>e.type==="extrude")}async function g6e(t,e){return await t.fetchSymbol(e)||t.fetchCIMSymbol(e)}var Sz;const oY=new Set(["esriMetersPerSecond","esriKilometersPerHour","esriKnots","esriFeetPerSecond","esriMilesPerHour"]),uM=new He({beaufort_ft:"beaufort-ft",beaufort_km:"beaufort-km",beaufort_kn:"beaufort-kn",beaufort_m:"beaufort-m",beaufort_mi:"beaufort-mi",classified_arrow:"classified-arrow",ocean_current_kn:"ocean-current-kn",ocean_current_m:"ocean-current-m",simple_scalar:"simple-scalar",single_arrow:"single-arrow",wind_speed:"wind-barb"}),dM=new He({flow_from:"flow-from",flow_to:"flow-to"});let Ys=Sz=class extends Cg(te){constructor(t){super(t),this.attributeField="Magnitude",this.flowRepresentation="flow-from",this.rotationType="arithmetic",this.style="single-arrow",this.symbolTileSize=50,this.type="vector-field"}readInputUnit(t,e){return oY.has(t)?Za.fromJSON(t):null}readOutputUnit(t,e){return oY.has(t)?Za.fromJSON(t):null}get styleRenderer(){const t=this.style,e=this.attributeField,i=this._createStyleRenderer(t);return i.field=e,i}get sizeVariables(){const t=[];if(this.visualVariables)for(const e of this.visualVariables)e.type==="size"&&t.push(e);if(t.length===0){const e=new Jv({field:"Magnitude",minSize:.2*this.symbolTileSize,maxSize:.8*this.symbolTileSize});this.visualVariables?this.visualVariables.push(e):this._set("visualVariables",[e]),t.push(e)}return t}get rotationVariables(){const t=[];if(this.visualVariables)for(const e of this.visualVariables)e.type==="rotation"&&t.push(e);if(t.length===0){const e=new PL({field:"Direction",rotationType:this.rotationType});this.visualVariables?this.visualVariables.push(e):this._set("visualVariables",[e]),t.push(e)}return t}clone(){return new Sz({attributeField:this.attributeField,flowRepresentation:this.flowRepresentation,rotationType:this.rotationType,symbolTileSize:this.symbolTileSize,style:this.style,visualVariables:U(this.visualVariables),inputUnit:this.inputUnit,outputUnit:this.outputUnit})}async getGraphicsFromPixelData(t,e=!1,i=[]){var f;const r=new Array,n=YL(this.inputUnit,this.outputUnit),s=((f=this.rotationVariables[0])==null?void 0:f.rotationType)||this.rotationType,o=e?RP(t.pixelBlock,"vector-uv",s,n):k8e(t.pixelBlock,"vector-magdir",n);if(o==null)return r;const a=t.extent,l=o.mask!=null&&o.mask.length>0;let c=0;const u=(a.xmax-a.xmin)/o.width,h=(a.ymax-a.ymin)/o.height;for(let m=0;m<o.height;m++)for(let g=0;g<o.width;g++,c++){let y=new fe({x:a.xmin+g*u+u/2,y:a.ymax-m*h-h/2,spatialReference:a.spatialReference});y=(await Upe(y))[0];const v=i.some(b=>b.intersects(y));if((!l||o.mask[c])&&!v){const b={Magnitude:o.pixels[0][c],Direction:o.pixels[1][c]},w=new Or({geometry:{type:"point",x:y.x,y:y.y,spatialReference:a.spatialReference},attributes:b});w.symbol=this._getVisualVariablesAppliedSymbol(w),r.push(w)}}return r}getSymbol(t,e){}async getSymbolAsync(t,e){}getSymbols(){return[]}getClassBreakInfos(){var t;return(t=this.styleRenderer)==null?void 0:t.classBreakInfos}getDefaultSymbol(){var t;return(t=this.styleRenderer)==null?void 0:t.defaultSymbol}_getDefaultSymbol(t){return new ms({path:"M14,32 14,18 9,23 16,3 22,23 17,18 17,32 z",outline:new Yn({width:0}),size:20,color:t||new ce([0,92,230])})}_getVisualVariablesAppliedSymbol(t){var n,s;if(!t)return;const e=(s=(n=this.styleRenderer)==null?void 0:n.getSymbol(t))==null?void 0:s.clone(),i=this.sizeVariables,r=this.rotationVariables;if(i&&i.length&&this.sizeVariables.forEach(o=>ofe(e,the([o],t))),r&&r.length){const o=this.flowRepresentation==="flow-to"==(this.style==="ocean-current-kn"||this.style==="ocean-current-m")?0:180;t.attributes.Direction=t.attributes.Direction+o,this.rotationVariables.forEach(a=>afe(e,OL(a,t),a.axis))}return e}_createStyleRenderer(t){let e={defaultSymbol:this._getDefaultSymbol(),classBreakInfos:[]};switch(t){case"single-arrow":e=this._createSingleArrowRenderer();break;case"beaufort-kn":e=this._createBeaufortKnotsRenderer();break;case"beaufort-m":e=this._createBeaufortMeterRenderer();break;case"beaufort-ft":e=this._createBeaufortFeetRenderer();break;case"beaufort-mi":e=this._createBeaufortMilesRenderer();break;case"beaufort-km":e=this._createBeaufortKilometersRenderer();break;case"ocean-current-m":e=this._createCurrentMeterRenderer();break;case"ocean-current-kn":e=this._createCurrentKnotsRenderer();break;case"simple-scalar":e=this._createSimpleScalarRenderer();break;case"wind-barb":e=this._createWindBarbsRenderer();break;case"classified-arrow":e=this._createClassifiedArrowRenderer()}return new ex(e)}_createSingleArrowRenderer(){return{defaultSymbol:this._getDefaultSymbol()}}_createBeaufortKnotsRenderer(){const t=[0,1,3,6,10,16,21,27,33,40,47,55,63],e=[[40,146,199],[89,162,186],[129,179,171],[160,194,155],[191,212,138],[218,230,119],[250,250,100],[252,213,83],[252,179,102],[250,141,52],[247,110,42],[240,71,29]];return{defaultSymbol:this._getDefaultSymbol(new ce([214,47,39])),classBreakInfos:this._getClassBreaks(t,e)}}_createBeaufortMeterRenderer(){const t=[0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7],e=[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]];return{defaultSymbol:this._getDefaultSymbol(new ce([214,47,39])),classBreakInfos:this._getClassBreaks(t,e)}}_createBeaufortFeetRenderer(){const t=this._getDefaultSymbol(new ce([214,47,39]));let e=[0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7];const i=[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]],r=3.28084;return e=e.map(n=>n*r),{defaultSymbol:t,classBreakInfos:this._getClassBreaks(e,i)}}_createBeaufortMilesRenderer(){const t=this._getDefaultSymbol(new ce([214,47,39]));let e=[0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7];const i=[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]],r=2.23694;return e=e.map(n=>n*r),{defaultSymbol:t,classBreakInfos:this._getClassBreaks(e,i)}}_createBeaufortKilometersRenderer(){const t=this._getDefaultSymbol(new ce([214,47,39]));let e=[0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7];const i=[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]],r=3.6;return e=e.map(n=>n*r),{defaultSymbol:t,classBreakInfos:this._getClassBreaks(e,i)}}_createCurrentMeterRenderer(){const t=[0,.5,1,1.5,2],e=[[78,26,153],[179,27,26],[202,128,26],[177,177,177]];return{defaultSymbol:this._getDefaultSymbol(new ce([177,177,177])),classBreakInfos:this._getClassBreaks(t,e)}}_createCurrentKnotsRenderer(){const t=[0,.25,.5,1,1.5,2,2.5,3,3.5,4],e=[[0,0,0],[0,37,100],[78,26,153],[151,0,100],[179,27,26],[177,78,26],[202,128,26],[177,179,52],[177,177,177]];return{defaultSymbol:this._getDefaultSymbol(new ce([177,177,177])),classBreakInfos:this._getClassBreaks(t,e)}}_createClassifiedArrowRenderer(){var r;const t=this._getDefaultSymbol(new ce([56,168,0]));let e=[0,1e-6,3.5,7,10.5,14];if((r=this.sizeVariables)!=null&&r.length){const n=this.sizeVariables[0].minDataValue,s=this.sizeVariables[0].maxDataValue;if(n&&s){const o=(s-n)/5;e=Array.from(Array(6).keys()).map(a=>n+o*a)}}const i=[[56,168,0],[139,309,0],[255,255,0],[255,128,0],[255,0,0]];return{defaultSymbol:t,classBreakInfos:this._getClassBreaks(e,i)}}_createSimpleScalarRenderer(){return{defaultSymbol:Ym.fromJSON({imageData:"iVBORw0KGgoAAAANSUhEUgAAACsAAAArCAQAAABLVLlLAAAABGdBTUEAAYagMeiWXwAAAAJiS0dEAACqjSMyAAAACXBIWXMAAABIAAAASABGyWs+AAAC3ElEQVRIx9XXvW4cVRQH8N982btpsIREJECyiCXsxX4DKh6AliqGKCBBE2SlwlHgAbBD/AKmyEYUeQ1KahPZSZQvBCkQLTHZ7KGY8Xodz4w3a1NwbzVzz/znfJ//zbStVC5q3icKak9GAs2QIdDx3PtW/S011NW3p+M5Eomh11ipTIKe6+4LQzHaQ+G+63pIZNJJQXMpljwTwj1brpgx5w1zZlyx5Z4QnllEIm2xeeSUHBf0hV0bejo1Uh09G3aFvgXk7cCJFBc9EdaRVuHJJaOdKyTV2TVhYLMduNR0Q9gxL5GaaTDw8GzejrDRBpxWoGsySRW0dttKuattwNkIlFw2YXgzOdYq4Ox49PlM+JrKd5OusjTWhBuVxUfMX/KXXZ3WEmkuqa67wspR4BTbwtKr/5u4fFgStse/T7EifFPnnYl9zPq4vmUOPrRndgoHjDti1gOPqlyXoifcRNGQzUd31lDyfHmob1Gp35vSr+P6vilcQ5Egtyd8YF/ySg9NhPM+9M/IOaHwp5+PSZayXTvCogEUwlatC3J8LLwYtcWB8EuDXQVuCkV5/B4eNHb7wGBs87LBDS+xjdVSn09wq1G8dFM+9tSUhIGneLvUdniKxKpTYljCpu3j7rVWlHj/P23v4NPGUEyeCQnexe9lJjzEQqMjJs+EzNAX6B98dBZVRmroJx95x/A/6gln18EyfCUsl+qdXb/tjvfbw+mwforpUOBz4XLVoBwAn3aWnfeH246NyBXhrq7TTN5lNSP9RkU+puUJm3W2Tsdq0nZWM07srk7MwQrZSRysjjGWBLRJNsNbfj2JMR4AbxpU1XLAb9Mxfpsq5EjMuuiR8L0JiHOOBX3hiUvOmavN0nMueSzcceFk0BK4pMqLo7vDD1Z0qrtDx7Itt4Xwm9UqbMmk8S0Dtuzb2pvOU99Z1nLTOfleNmvfZfP2pYZmPfajwosKdDBNpacNpVGGsWX9CyDI8Xq/Sj6QAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE0LTExLTEwVDAzOjE3OjU4LTA1OjAwF+tHyQAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxNC0xMS0xMFQwMzoxNzo1OC0wNTowMGa2/3UAAAAASUVORK5CYII=",height:20,width:20,type:"esriPMS",angle:0})}}_createWindBarbsRenderer(){const t=Array.from(Array(31).keys()).map(n=>5*n),e=[{range:"0-5",path:"M20 20 M5 20 A15 15 0 1 0 35 20 A15 15 0 1 0 5 20 M20 20 M10 20 A10 10 0 1 0 30 20 A10 10 0 1 0 10 20",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTIwIDIwIE01IDIwIEExNSAxNSAwIDEgMCAzNSAyMCBBMTUgMTUgMCAxIDAgNSAyMCBNMjAgMjAgTTEwIDIwIEExMCAxMCAwIDEgMCAzMCAyMCBBMTAgMTAgMCAxIDAgMTAgMjAiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="},{range:"5-10",path:"M25 0 L25 40 M25 35 L17.5 37.5",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjkgMCAyNyA0NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cGF0aCBkPSJNMjUgMCBMMjUgNDAgTTI1IDM1IEwxNy41IDM3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="},{range:"10-15",path:"M25 0 L25 40 L10 45 L25 40",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjkgMCAyNyA0NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cGF0aCBkPSJNMjUgMCBMMjUgNDAgTDEwIDQ1IEwyNSA0MCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"15-20",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L17.5 37.5",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjEyIDAgMTUgNDUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxNy41IDM3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="},{range:"20-25",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjkgMCAyNiA0NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cGF0aCBkPSJNMjUgMCBMMjUgNDAgTDEwIDQ1IEwyNSA0MCBNMjUgMzUgTDEwIDQwIiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},{range:"25-30",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L17.5 32.5",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjkgMCAyNiA0NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cGF0aCBkPSJNMjUgMCBMMjUgNDAgTDEwIDQ1IEwyNSA0MCBNMjUgMzUgTDEwIDQwIEwyNSAzNSBNMjUgMzAgTDE3LjUgMzIuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"30-35",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0NiI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"35-40",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L17.5 27.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0NiI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxNy41IDI3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="},{range:"40-45",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0NiI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"45-50",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L17.5 22.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0NiI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxNy41IDIyLjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="},{range:"50-55",path:"M25 0 L25 40 L10 40 L25 35",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="},{range:"55-60",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L17.5 32.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxNy41IDMyLjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="},{range:"60-65",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"65-70",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L17.5 27.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxNy41IDI3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="},{range:"70-75",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"75-80",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L17.5 22.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxNy41IDIyLjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="},{range:"80-85",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxMCAyNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"85-90",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L17.5 17.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxMCAyNSBMMjUgMjAgTTI1IDE1IEwxNy41IDE3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="},{range:"90-95",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L10 20",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxMCAyNSBMMjUgMjAgTTI1IDE1IEwxMCAyMCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"95-100",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L10 20 L25 15 M25 10 L17.5 12.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxMCAyNSBMMjUgMjAgTTI1IDE1IEwxMCAyMCBMMjUgMTUgTTI1IDEwIEwxNy41IDEyLjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="},{range:"100-105",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"105-110",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L17.5 27.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDE3LjUgMjcuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"110-115",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},{range:"115-120",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L17.5 22.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDE3LjUgMjIuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"120-125",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},{range:"125-130",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L17.5 17.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDE3LjUgMTcuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"130-135",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDEwIDIwIiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},{range:"135-140",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L17.5 12.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDEwIDIwIE0yNSAxNSBNMjUgMTAgTDE3LjUgMTIuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"140-145",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L17.5 12.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDEwIDIwIE0yNSAxNSBNMjUgMTAgTDEwIDE1IiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},{range:"145-150",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L17.5 12.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDEwIDIwIE0yNSAxNSBNMjUgMTAgTDEwIDE1IE0yNSAxMCBNMjUgNSBMMTcuNSA3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="}],i=Ym.fromJSON({imageData:"iVBORw0KGgoAAAANSUhEUgAAACgAAAApCAQAAADtq6NDAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJiS0dEAP+Hj8y/AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAEY0lEQVRIx5XXWWxWRRQH8N+d+31tUdGAVjGglYJABFEBY91jfDAg7piYaFTccA++uMQEFRcSXlATtxiXqMQt4G4iisYl0ai4sIQYtVFZ1KIFKdTS0l4f7vRCS5fPebozc+bM/2z/Mzcx0AgSiUxXnKfIdMn875FIhX53U2n/B/s+kKM4UINTjTBZImixxnrv+9a2iL6zEoUBXcoudrWj/OtHm3wt02lfU9Qao9OnHvIhgmww84MEl1qnxfNmGrqHxAizLdPpC6chGcAxKGGcL+30gOERf1BSpUqVslQSV8d5ReZFe8VQ9avufJn31cWwlJV7iafKStGOE/1qvfH9qUxxu8ydUdmuSKbGO8YUdT2inKLG69pM70tliktl5qIkCAJGmusDG7Vqsc0WjZa4UBlBiA5YZIcjYzB7qDtH5kaUJFLs7RGZTZ42W4PRRmtwvbdt1+wGiaS4drEtDttdZYIDNVuAclR3vA3+dI3qHqmVSy7U6Tv1MScCPvPR7nIpFlsdCy3FdTLPGhK92e2CUITjMJ9ocwKxnsZqc3O3JwMma3d6UVLnyVxB4aXemZqvPqLdpJhW3KVVbY4yYImPo6M5Urv50fj+0z/FG9YaEiENs8UtMfXUaTeTePNHlhXfA1UU+2lyD1Il3Gtt9+adfpNG7dNlpg2U/T3KYLZ2dUWFdTgp3/rQ4sK973qnInV5TIf40x3dhvrJPBiqyWUo4wAtLqhQYS71qK+QKOFRywmGK/kpikzV6WMKhh58vGWs4TIJNjiEYLIuP8Tt4/zmLyqk+AyrJSbF+Qq1DgqRUPMxyl+9q3IQhX/rMCJ6tEunriDs1oSyQZKlr9AkhT2ZIARbJfaJS1vtVbHB+Rgi0RK/y1q1BWsEEyLoz40xtGKcARPVWB1BTPO7f4LNtpkUl1aoMbViLyZo0GRjPD3BxnxjqXeLYlvhqYrzMMG3HoyJXa3JjfnGlbYYFlP7Jh3qKsKY4hQ7TY0nG+xwRL61n63mxHtqNHosigyMLmClNwvuecFnOZB88nNBDzNkzhxEZaKMBVoKapggMzvHHXBEpNSSFAvtcFRsVn0bW8LlMmcXs+c0Kne3gRR32+zg4uXwjC6zit6Wt4a8LXVfcp/MtQXHn2ynGbuCmb8GvvFeJLEE82ReU9/n6+dkq2x3buG9Wn94smcgAw631RPR7BTH+kbmHReZoEpOdEe7zWqZl40s0JWs9Hmv7hjBHqPDwsjGKVJnWWqjbdZp1KhJi0aPmxYZsIRhlttgeF+Jlke41QcOQKoqilSb6HJzSvNG3G/UoWnxwsmt+sVaYwd63dRbqdnMyCPVeyRPvpYgdavM22oGKoMUVRbJfOWMwidJ8Zzb1UvmWK/VVUXzHaTjjrVYh1897HT7xxYEVUaa5SWb/WO+YUWa9SrwvigzM8YlzlYv2GSdVCYxxlBtVnnFq5olwp5/BEk/OLsf5LUmG2+inRJdVvjZ97ZH9/zP34ug1O91pf4p+D+JYBpvrKxfbwAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNC0xMS0xMFQwMzoxMjowOS0wNTowMB9ViV0AAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTQtMTEtMTBUMDM6MTI6MDktMDU6MDBuCDHhAAAAAElFTkSuQmCC",height:20,width:20,type:"esriPMS",angle:0}),r=t.map((n,s)=>{let o;if(s!==t.length-1)if(s===0)o={minValue:n,maxValue:t[s+1],symbol:i};else{const a=Ym.fromJSON({type:"esriPMS",imageData:e[s].imageData,contentType:"image/svg+xml",height:32,width:32,angle:0});o={minValue:n,maxValue:t[s+1],symbol:a}}return new f1(o)});return{defaultSymbol:i,classBreakInfos:r}}_getClassBreaks(t,e){return e.map((i,r)=>new f1({minValue:t[r],maxValue:t[r+1],symbol:this._getDefaultSymbol(new ce(i))}))}};d([p({type:String,json:{write:!0}})],Ys.prototype,"attributeField",void 0),d([p({type:dM.apiValues,json:{type:dM.jsonValues,read:{reader:dM.read},write:{writer:dM.write}}})],Ys.prototype,"flowRepresentation",void 0),d([p({type:["geographic","arithmetic"],json:{write:!0}})],Ys.prototype,"rotationType",void 0),d([p({type:uM.apiValues,json:{type:uM.jsonValues,read:{reader:uM.read},write:{writer:uM.write}}})],Ys.prototype,"style",void 0),d([p({json:{write:!0}})],Ys.prototype,"symbolTileSize",void 0),d([p({type:Za.apiValues,json:{type:Za.jsonValues,write:{writer:Za.write}}})],Ys.prototype,"inputUnit",void 0),d([ae("inputUnit")],Ys.prototype,"readInputUnit",null),d([p({type:Za.apiValues,json:{type:Za.jsonValues,read:{reader:Za.read},write:{writer:Za.write}}})],Ys.prototype,"outputUnit",void 0),d([ae("outputUnit")],Ys.prototype,"readOutputUnit",null),d([xe({vectorField:"vector-field"})],Ys.prototype,"type",void 0),d([p({type:ex})],Ys.prototype,"styleRenderer",null),d([p({type:Jv})],Ys.prototype,"sizeVariables",null),d([p({type:PL})],Ys.prototype,"rotationVariables",null),Ys=Sz=d([A("esri.renderers.VectorFieldRenderer")],Ys);const G9=Ys,Iz={key:"type",base:null,typeMap:{"unique-value":tx,"class-breaks":ex,"raster-colormap":N9,"raster-stretch":V9,"vector-field":G9,"raster-shaded-relief":Npe,flow:Epe}},Tz={...Iz,typeMap:{...Iz.typeMap}};delete Tz.typeMap["vector-field"],delete Tz.typeMap.flow;const y6e={uniqueValue:tx,classBreaks:ex,rasterStretch:V9,rasterColormap:N9,vectorField:G9,rasterShadedRelief:Npe,flowRenderer:Epe};function v6e(t){return t&&y6e[t.type]||null}function _6e(t,e){if(!t)return null;if(t.type==="classBreaks"&&t.classificationMethod){const r=t.authoringInfo||{classificationMethod:""};r.classificationMethod=t.classificationMethod,t.authoringInfo=r}t.type==="vectorField"&&t.visualVariables&&!Array.isArray(t.visualVariables)&&(t.visualVariables=[t.visualVariables]);const i=v6e(t);if(i){const r=new i;return r.read(t,e),r}return e&&e.messages&&t&&e.messages.push(new ol("renderer:unsupported","Renderers of type '"+(t.type||"unknown")+"' are not supported",{definition:t,context:e})),null}var Cz;let jy=Cz=class extends te{constructor(t){super(t),this.variableName=null,this.dimensionName=null,this.values=[],this.isSlice=!1}clone(){return new Cz({variableName:this.variableName,dimensionName:this.dimensionName,values:U(this.values),isSlice:this.isSlice})}};d([p({type:String,json:{write:!0}})],jy.prototype,"variableName",void 0),d([p({type:String,json:{write:!0}})],jy.prototype,"dimensionName",void 0),d([p({type:gx.array(gx.oneOf([gx.native(Number),gx.array(gx.native(Number))])),json:{write:!0}})],jy.prototype,"values",void 0),d([p({type:Boolean,json:{write:!0}})],jy.prototype,"isSlice",void 0),jy=Cz=d([A("esri.layers.support.DimensionalDefinition")],jy);const Lv=jy;var Ez;const b6e={base:Ep,key:"type",typeMap:{extent:Re,polygon:Zn}};let By=Ez=class extends te{constructor(t){super(t),this.areaOfInterest=null,this.subsetDefinitions=null}get dimensions(){const{subsetDefinitions:t}=this;if(t==null||t.length===0)return[];const e=new Map;t.forEach(r=>{if(!r.dimensionName)return;let n,s;if(Array.isArray(r.values[0])){const o=r.values;n=o[0][0],s=o[r.values.length-1][1]}else{const o=r.values;n=o[0],s=o[r.values.length-1]}if(e.has(r.dimensionName)){const o=e.get(r.dimensionName);o[0]=Math.min(n,o[0]),o[1]=Math.max(s,o[1])}else e.set(r.dimensionName,[n,s])});const i=[];for(const r of e)i.push({name:r[0],extent:r[1]});return i}get variables(){const{subsetDefinitions:t}=this;if(t==null||t.length===0)return[];const e=new Set;return t.forEach(i=>{i.variableName&&e.add(i.variableName)}),[...e]}clone(){var i;const t=(i=this.subsetDefinitions)==null?void 0:i.map(r=>r.clone()),e=this.areaOfInterest?this.areaOfInterest.clone():this.areaOfInterest;return new Ez({areaOfInterest:e,subsetDefinitions:t})}};d([p({types:b6e,json:{read:Vd,write:!0}})],By.prototype,"areaOfInterest",void 0),d([p({readOnly:!0})],By.prototype,"dimensions",null),d([p({readOnly:!0})],By.prototype,"variables",null),d([p({type:[Lv],json:{write:!0}})],By.prototype,"subsetDefinitions",void 0),By=Ez=d([A("esri.layers.support.MultidimensionalSubset")],By);const w6e=By,x6e=ln()({RSP_NearestNeighbor:"nearest",RSP_BilinearInterpolation:"bilinear",RSP_CubicConvolution:"cubic",RSP_Majority:"majority"}),qwt=ln()({esriNoDataMatchAny:"any",esriNoDataMatchAll:"all"}),I5=ln()({U1:"u1",U2:"u2",U4:"u4",U8:"u8",S8:"s8",U16:"u16",S16:"s16",U32:"u32",S32:"s32",F32:"f32",F64:"f64",C64:"c64",C128:"c128",UNKNOWN:"unknown"});let Lf=class extends te{constructor(){super(...arguments),this.pixelType="unknown"}};d([p({type:String,json:{write:!0}})],Lf.prototype,"name",void 0),d([p({type:String,json:{write:!0}})],Lf.prototype,"description",void 0),d([p({type:wt,json:{type:wt,write:!0,name:"_object_id"}})],Lf.prototype,"id",void 0),d([p({type:String,json:{type:I5.jsonValues,read:I5.read,write:I5.write}})],Lf.prototype,"pixelType",void 0),d([p({type:String,json:{write:!0}})],Lf.prototype,"type",void 0),Lf=d([A("esri.layers.support.RasterFunctionInfo")],Lf);const S6e=Lf;let Ch=class extends te{constructor(){super(...arguments),this.isDataset=!1,this.isPublic=!1,this.type="RasterFunctionVariable"}};d([p({type:String,json:{write:!0}})],Ch.prototype,"name",void 0),d([p({type:Number,json:{type:wt,write:!0,name:"_object_id"}})],Ch.prototype,"id",void 0),d([p({type:Boolean,json:{write:!0}})],Ch.prototype,"isDataset",void 0),d([p({type:Boolean,json:{write:!0}})],Ch.prototype,"isPublic",void 0),d([p({json:{write:!0}})],Ch.prototype,"value",void 0),d([p({type:String,json:{write:!0}})],Ch.prototype,"type",void 0),Ch=d([A("esri.layers.support.RasterFunctionVariable")],Ch);const I6e=Ch,hM={key:"type",base:null,typeMap:{RasterFunctionVariable:I6e}};let Uy=class extends te{};d([p({types:hM,json:{types:hM,name:"MatchVariable"}})],Uy.prototype,"matchVariable",void 0),d([p({types:hM,json:{types:hM,name:"UnionDimension"}})],Uy.prototype,"unionDimension",void 0),d([p({type:Number,json:{type:wt,write:!0,name:"_object_id"}})],Uy.prototype,"id",void 0),d([p({type:String,json:{write:!0}})],Uy.prototype,"type",void 0),Uy=d([A("esri.layers.support.RasterFunctionProperties")],Uy);const T6e=Uy,T5=new He({0:"mosaic",1:"item",2:"item-group"},{useNumericKeys:!0});let ns=class extends te{constructor(){super(...arguments),this.functionType="mosaic",this.type="RasterFunctionTemplate"}};d([p({type:[String],json:{write:!0}})],ns.prototype,"aliases",void 0),d([p({type:Object,json:{write:!0}})],ns.prototype,"arguments",void 0),d([p({type:String,json:{write:!0}})],ns.prototype,"description",void 0),d([p({type:S6e,json:{write:!0,name:"function"}})],ns.prototype,"functionInfo",void 0),d([p({type:T5.apiValues,json:{type:[0,1,2],read:T5.read,write:T5.write}})],ns.prototype,"functionType",void 0),d([p({type:String,json:{write:!0}})],ns.prototype,"group",void 0),d([p({type:String,json:{write:!0}})],ns.prototype,"help",void 0),d([p({type:Number,json:{type:wt,write:!0,name:"_object_id"}})],ns.prototype,"id",void 0),d([p({type:String,json:{write:!0}})],ns.prototype,"name",void 0),d([p({type:String,json:{write:!0,name:"definition"}})],ns.prototype,"queryDefinition",void 0),d([p({type:String,json:{write:!0}})],ns.prototype,"tag",void 0),d([p({type:T6e,json:{write:!0}})],ns.prototype,"properties",void 0),d([p({type:String,json:{write:!0}})],ns.prototype,"thumbnail",void 0),d([p({type:String,json:{write:!0}})],ns.prototype,"thumbnailEx",void 0),d([p({json:{type:["RasterFunctionTemplate"],write:!0}})],ns.prototype,"type",void 0),ns=d([A("esri.layers.support.RasterFunctionTemplate")],ns);const lfe=ns;var Mz;const TA=new Set(["raster","raster2","dem","fillraster"]),CA=new Set(["rasters"]),aY=t=>t&&t.rasterFunction?Po.fromJSON(t):t,C5=t=>t&&t instanceof Po?t.toJSON():t,$z=t=>(t==null?void 0:t.functionName)&&!t.declaredClass,lY=t=>$z(t)?new Po(t):t,C6e=t=>{if(t==null)return null;t=U(t);const e={};for(const i of Object.keys(t))TA.has(i.toLowerCase())?e[i]=aY(t[i]):CA.has(i.toLowerCase())&&Array.isArray(t[i])?e[i]=t[i].map(aY):e[i]=t[i];return e},E6e={types:{key:"type",base:null,typeMap:{RasterFunctionTemplate:lfe}},json:{write:!0,name:"rasterFunctionDefinition"}};let Po=Mz=class extends te{constructor(t){super(t),this.functionName=null,this.outputPixelType="unknown",this.variableName=null,this.functionDefinition=null}set functionArguments(t){if(t){const e=Object.keys(t);if(e.some(i=>TA.has(i.toLowerCase())&&$z(t[i]))||e.some(i=>CA.has(i.toLowerCase())&&Array.isArray(t[i])&&t[i].some(r=>$z(r)))){t=U(t);for(const i of e)TA.has(i.toLowerCase())?t[i]=lY(t[i]):CA.has(i.toLowerCase())&&Array.isArray(t[i])&&(t[i]=t[i].map(r=>lY(r)))}}this._set("functionArguments",t)}readFunctionArguments(t){return C6e(t)}writeFunctionArguments(t,e,i){const r={};for(const n of Object.keys(t))TA.has(n.toLowerCase())?r[n]=C5(t[n]):CA.has(n.toLowerCase())&&Array.isArray(t[n])?r[n]=t[n].map(C5):r[n]=C5(t[n]);e[i]=r}readFunctionName(t,e){const i=e.rasterFunctionInfos;return e.name||(i&&i.length&&i[0].name!=="None"?i[0].name:e.rasterFunctionDefinition?e.rasterFunctionDefinition.name:e.rasterFunction)}get rasterFunctionDefinition(){var t;return(t=this.functionDefinition)==null?void 0:t.toJSON()}set rasterFunctionDefinition(t){this.functionDefinition=t?lfe.fromJSON(t):null}clone(){return new Mz({functionName:this.functionName,functionArguments:U(this.functionArguments),outputPixelType:this.outputPixelType,variableName:this.variableName,rasterFunctionDefinition:U(this.rasterFunctionDefinition)})}};d([p({json:{type:Object,name:"rasterFunctionArguments"}})],Po.prototype,"functionArguments",null),d([ae("functionArguments")],Po.prototype,"readFunctionArguments",null),d([ge("functionArguments")],Po.prototype,"writeFunctionArguments",null),d([p({json:{type:String,write:{target:"rasterFunction"}}})],Po.prototype,"functionName",void 0),d([ae("functionName",["rasterFunction","rasterFunctionInfos","rasterFunctionDefinition"])],Po.prototype,"readFunctionName",null),d([xe({C128:"c128",C64:"c64",F32:"f32",F64:"f64",S16:"s16",S32:"s32",S8:"s8",U1:"u1",U16:"u16",U2:"u2",U32:"u32",U4:"u4",U8:"u8",UNKNOWN:"unknown"},{ignoreUnknown:!1}),p({json:{default:"unknown"}})],Po.prototype,"outputPixelType",void 0),d([p({type:String,json:{read:!0,write:!0}})],Po.prototype,"variableName",void 0),d([p()],Po.prototype,"rasterFunctionDefinition",null),d([p(E6e)],Po.prototype,"functionDefinition",void 0),Po=Mz=d([A("esri.layers.support.RasterFunction")],Po);const Rv=Po;let M6e=class{constructor(){this._workerThread=null,this._destroyed=!1}async initialize(){const e=await IU("RasterWorker");this._destroyed?e.close():this._workerThread=e}destroy(){this._destroyed=!0,this._workerThread&&(this._workerThread.close(),this._workerThread=null)}async convertVectorFieldData(e,i){if(!this._workerThread)throw new N("raster-jobhandler:no-connection","no available worker connection");const r=await this._workerThread.invoke("convertVectorFieldData",{pixelBlock:e.pixelBlock.toJSON(),type:e.dataType},i);return r?new de(r):null}computeStatisticsHistograms(e,i){if(!this._workerThread)throw new N("raster-jobhandler:no-connection","no available worker connection");return this._workerThread.invoke("computeStatisticsHistograms",{pixelBlock:e.pixelBlock.toJSON()},i)}async decode(e,i){if(!this._workerThread)throw new N("raster-jobhandler:no-connection","no available worker connection");const r=await this._workerThread.invoke("decode",e,i);return r?new de(r):null}async symbolize(e,i){if(!this._workerThread)throw new N("raster-jobhandler:no-connection","no available worker connection");const r={extent:e.extent&&e.extent.toJSON(),pixelBlock:e.pixelBlock!=null&&e.pixelBlock.toJSON(),simpleStretchParams:e.simpleStretchParams,bandIds:e.bandIds},n=await this._workerThread.invoke("symbolize",r,i);return n?new de(n):null}async updateSymbolizer(e,i){var n;if(!this._workerThread)throw new N("raster-jobhandler:no-connection","no available worker connection");const r=(n=e==null?void 0:e.rendererJSON)==null?void 0:n.histograms;await Promise.all(this._workerThread.broadcast("updateSymbolizer",{symbolizerJSON:e.toJSON(),histograms:r},i))}async updateRasterFunction(e,i){if(!this._workerThread)throw new N("raster-jobhandler:no-connection","no available worker connection");await Promise.all(this._workerThread.broadcast("updateRasterFunction",{rasterFunctionJSON:e.toJSON()},i))}async process(e,i){var n,s;if(!this._workerThread)throw new N("raster-jobhandler:no-connection","no available worker connection");const r=await this._workerThread.invoke("process",{extent:(n=e.extent)==null?void 0:n.toJSON(),primaryPixelSizes:(s=e.primaryPixelSizes)==null?void 0:s.map(o=>o!=null?o.toJSON():null),primaryPixelBlocks:e.primaryPixelBlocks.map(o=>o!=null?o.toJSON():null),primaryRasterIds:e.primaryRasterIds},i);return r?new de(r):null}async stretch(e,i){if(!this._workerThread)throw new N("raster-jobhandler:no-connection","no available worker connection");if(!(e!=null&&e.pixelBlock))return null;const r={srcPixelBlock:e.pixelBlock.toJSON(),stretchParams:e.stretchParams},n=await this._workerThread.invoke("stretch",r,i);return n?new de(n):null}async split(e,i){if(!this._workerThread)throw new N("raster-jobhandler:no-connection","no available worker connection");if(!(e!=null&&e.pixelBlock))return null;const r={srcPixelBlock:e.pixelBlock.toJSON(),tileSize:e.tileSize,maximumPyramidLevel:e.maximumPyramidLevel},n=await this._workerThread.invoke("split",r,i);return n&&n.forEach((s,o)=>{n.set(o,s?de.fromJSON(s):null)}),n}async estimateStatisticsHistograms(e,i){if(!this._workerThread)throw new N("raster-jobhandler:no-connection","no available worker connection");if(!(e!=null&&e.pixelBlock))return null;const r={srcPixelBlock:e.pixelBlock.toJSON()};return await this._workerThread.invoke("estimateStatisticsHistograms",r,i)}async mosaicAndTransform(e,i){var s;if(!this._workerThread)throw new N("raster-jobhandler:no-connection","no available worker connection");if(!((s=e==null?void 0:e.srcPixelBlocks)!=null&&s.length))return{pixelBlock:null};const r={...e,srcPixelBlocks:e.srcPixelBlocks.map(o=>o!=null?o.toJSON():null)},n=await this._workerThread.invoke("mosaicAndTransform",r,i);return{pixelBlock:n.pixelBlock?new de(n.pixelBlock):null,localNorthDirections:n.localNorthDirections}}async createFlowMesh(e,i){if(!this._workerThread)throw new N("raster-jobhandler:no-connection","no available worker connection");const r={buffer:e.flowData.data.buffer,maskBuffer:e.flowData.mask.buffer,width:e.flowData.width,height:e.flowData.height},{meshType:n,simulationSettings:s}=e,o=await this._workerThread.invoke("createFlowMesh",{meshType:n,flowData:r,simulationSettings:s},{...i,transferList:[r.buffer,r.maskBuffer]});return{vertexData:new Float32Array(o.vertexBuffer),indexData:new Uint32Array(o.indexBuffer)}}getProjectionOffsetGrid(e,i){if(!this._workerThread)throw new N("raster-jobhandler:no-connection","no available worker connection");const r=e.datumTransformation!=null?e.datumTransformation.steps.map(o=>({wkid:o.wkid,wkt:o.wkt,isInverse:o.isInverse})):null,n=e.rasterTransform!=null?e.rasterTransform.toJSON():null,s={projectedExtent:e.projectedExtent.toJSON(),srcBufferExtent:e.srcBufferExtent.toJSON(),pixelSize:e.pixelSize,hasWrapAround:e.hasWrapAround,spacing:e.spacing,datumTransformationSteps:r,rasterTransform:n,isAdaptive:e.isAdaptive,includeGCSGrid:e.includeGCSGrid};return this._workerThread.invoke("getProjectionOffsetGrid",s,i)}};var Az;let Is=Az=class extends te{constructor(){super(...arguments),this.blockWidth=void 0,this.blockHeight=void 0,this.compression=null,this.origin=null,this.firstPyramidLevel=null,this.maximumPyramidLevel=null,this.pyramidScalingFactor=2,this.pyramidBlockWidth=null,this.pyramidBlockHeight=null,this.isVirtualTileInfo=!1,this.tileInfo=null,this.transposeInfo=null,this.blockBoundary=null}clone(){return new Az({blockWidth:this.blockWidth,blockHeight:this.blockHeight,compression:this.compression,origin:U(this.origin),firstPyramidLevel:this.firstPyramidLevel,maximumPyramidLevel:this.maximumPyramidLevel,pyramidResolutions:U(this.pyramidResolutions),pyramidScalingFactor:this.pyramidScalingFactor,pyramidBlockWidth:this.pyramidBlockWidth,pyramidBlockHeight:this.pyramidBlockHeight,isVirtualTileInfo:this.isVirtualTileInfo,tileInfo:U(this.tileInfo),transposeInfo:U(this.transposeInfo),blockBoundary:U(this.blockBoundary)})}};d([p({type:Number,json:{write:!0}})],Is.prototype,"blockWidth",void 0),d([p({type:Number,json:{write:!0}})],Is.prototype,"blockHeight",void 0),d([p({type:String,json:{write:!0}})],Is.prototype,"compression",void 0),d([p({type:fe,json:{write:!0}})],Is.prototype,"origin",void 0),d([p({type:Number,json:{write:!0}})],Is.prototype,"firstPyramidLevel",void 0),d([p({type:Number,json:{write:!0}})],Is.prototype,"maximumPyramidLevel",void 0),d([p({json:{write:!0}})],Is.prototype,"pyramidResolutions",void 0),d([p({type:Number,json:{write:!0}})],Is.prototype,"pyramidScalingFactor",void 0),d([p({type:Number,json:{write:!0}})],Is.prototype,"pyramidBlockWidth",void 0),d([p({type:Number,json:{write:!0}})],Is.prototype,"pyramidBlockHeight",void 0),d([p({type:Boolean,json:{write:!0}})],Is.prototype,"isVirtualTileInfo",void 0),d([p({json:{write:!0}})],Is.prototype,"tileInfo",void 0),d([p()],Is.prototype,"transposeInfo",void 0),d([p()],Is.prototype,"blockBoundary",void 0),Is=Az=d([A("esri.layers.support.RasterStorageInfo")],Is);const nx=Is;function cfe(t,e,i){var s;const r=e.shift();if(i.length===0){const o=[];i.push({sliceId:-1,multidimensionalDefinition:o})}const n=i.length;for(let o=0;o<n;o++){const a=i.shift().multidimensionalDefinition;(s=r.values)==null||s.forEach(l=>{i.push({sliceId:-1,multidimensionalDefinition:[...a,{variableName:t,dimensionName:r.name,values:[l]}]})})}e.length&&cfe(t,e,i)}function $6e(t,e){const i=[];let r=0;return(e?t.variables.filter(n=>n.name.toLowerCase()===e.toLowerCase()):[...t.variables].sort((n,s)=>n.name>s.name?1:-1)).forEach(n=>{const s=[],o=[...n.dimensions].sort((a,l)=>a.name>l.name?-1:1);cfe(n.name,o,s),s.forEach(a=>{i.push({...a,sliceId:r++})})}),i}function A6e(t,e,i){let r=t;if(e&&(e=[...e].sort((n,s)=>n.dimensionName<s.dimensionName?-1:1)).forEach(({dimensionName:n,values:s,isSlice:o})=>{s.length&&(r=r.filter(a=>{const l=a.multidimensionalDefinition.find(u=>u.dimensionName===n);if(l==null)return!1;const c=l.values[0];return typeof c=="number"?typeof s[0]=="number"?s.includes(c):s.some(u=>u[0]<=c&&u[1]>=c):typeof s[0]=="number"?s.some(u=>c[0]<=u&&c[1]>=u):o?s.some(u=>u[0]===c[0]&&u[0]===c[1]):s.some(u=>u[0]>=c[0]&&u[0]<=c[1]||u[1]>=c[0]&&u[1]<=c[1]||u[0]<c[0]&&u[1]>c[1])}))}),r.length&&i&&i.start!=null&&i.end!=null){const n=i.start.getTime(),s=i.end.getTime(),o=r[0].multidimensionalDefinition.findIndex(a=>a.dimensionName==="StdTime");o>-1&&(r=r.filter(a=>{const l=a.multidimensionalDefinition[o].values[0];return n<=l&&s>=l}))}return r.map(n=>n.sliceId)}function ufe(t,e){return Array.isArray(t)?e[0]===e[1]?t[0]===e[0]||t[1]===e[0]:t[0]>=e[0]&&t[0]<=e[1]&&t[1]>=e[0]&&t[1]<=e[1]:t>=e[0]&&t<=e[1]}function k6e(t,e){return t[0]<=e[0]&&t[1]>=e[0]||t[0]<=e[1]&&t[1]>=e[1]||t[0]>=e[0]&&t[1]<=e[1]}function dfe(t){return t.length===1?[t[0],t[0]]:[t[0],t[t.length-1]]}function hfe(t,e,i){var o,a;if(!((o=e==null?void 0:e.subsetDefinitions)!=null&&o.length))return t;let r;if(i){const{variables:l}=e;if(l.length&&!l.includes(i))return null;const c=e.subsetDefinitions.find(u=>u.dimensionName===t.name&&u.variableName===i);if(!((a=c==null?void 0:c.values)!=null&&a.length))return t;r=dfe(c.values)}else{const l=e.dimensions.find(({name:c})=>c===t.name);r=l==null?void 0:l.extent}const n=r;if(!n||!(n!=null&&n.length))return t;const s=t.values.filter(l=>ufe(l,n));return{...t,extent:[...n],values:s}}function H9(t,e,i){var n;if(!((n=e==null?void 0:e.subsetDefinitions)!=null&&n.length))return!1;const{variables:r}=e;if(r.length&&t.some(({variableName:s})=>s&&!r.includes(s)))return!0;for(let s=0;s<t.length;s++){const o=t[s],a=e.subsetDefinitions.find(l=>(o.variableName===""||l.variableName===o.variableName)&&l.dimensionName===o.dimensionName);if(a!=null&&a.values.length){const l=dfe(a.values);if(!o.isSlice&&o.values.length===2&&!Array.isArray(o.values[0])&&o.values[0]!==o.values[1]&&i){if(!k6e(o.values,l))return!0}else if(o.values.some(c=>!ufe(c,l)))return!0}}return!1}function Xwt(t,e){if(t==null)return{isOutside:!1};const{geometry:i,timeExtent:r,multidimensionalDefinition:n}=e;let s=null;if(r!=null&&(s=P6e(t,r),s==null))return{isOutside:!0};const{areaOfInterest:o}=t;if(o&&i){const a=i.type==="point"?i:i.type==="extent"?i.center:i.type==="polygon"?i.centroid:null;if(a&&!o.contains(a))return{isOutside:!0}}return n!=null&&n.length&&H9(n,t,!0)?{isOutside:!0}:{isOutside:!1,intersection:{geometry:i,timeExtent:s,multidimensionalDefinition:n}}}function P6e(t,e){const i=t.dimensions.find(({name:o})=>o==="StdTime");if(i==null||e.start==null&&e.end==null)return e;e=e.clone();const{start:r,end:n}=e.toJSON(),s=r===n?[r]:r!=null&&n!=null?[r,n]:[r??n];return s.length===2&&(i!=null&&i.extent.length)&&(s[0]=Math.max(s[0],i.extent[0]),s[1]=Math.min(s[1],i.extent[1]??i.extent[0]),s[1]<s[0])||H9([new Lv({variableName:"",dimensionName:"StdTime",isSlice:s.length===1,values:s})],t,!0)?null:(e.start=new Date(s[0]),e.end=new Date(s[1]??s[0]),e)}function kz(t,e={}){var u,h;const{multidimensionalInfo:i,keyProperties:r}=t;if(i==null)return null;const{variableName:n,multidimensionalSubset:s,multidimensionalDefinition:o}=e,a=o!=null?(u=o[0])==null?void 0:u.variableName:null,l=n||a||(r==null?void 0:r.DefaultVariable);let{variables:c}=i;return(h=s==null?void 0:s.variables)!=null&&h.length&&(c=c.filter(({name:f})=>s.variables.includes(f))),l?c.find(({name:f})=>f===l)??c[0]:c[0]}function cY(t,e={}){const i=kz(t,e);if(!i)return null;const r=[],{dimensions:n,name:s}=i;if(n.length===0)return[new Lv({variableName:s,dimensionName:"",values:[],isSlice:!0})];for(let o=0;o<n.length;o++){const a=hfe(n[o],e.multidimensionalSubset,s);if(!a)return null;const{values:l,extent:c}=a;let u=(l==null?void 0:l[0])??c[0];a.name.toLowerCase()==="stdz"&&!a.hasRanges&&Math.abs(c[1])<=Math.abs(c[0])&&(u=l!=null&&l.length?l[l.length-1]:c[1]),r.push(new Lv({variableName:s,dimensionName:a.name,values:[u],isSlice:!e.useRangeForRangedDimensionInfo||!!a.hasRanges}))}return r}function pfe(t){return!(t==null||!t.length)&&t.some(e=>{if(e.values==null)return!0;const i=e.values.length;return i===0||i>1||!e.isSlice&&Array.isArray(e.values[0])})}function O6e(t,e){var r;if(e==null||t==null)return null;let i=e.variables.map(n=>({...n}));return(r=t==null?void 0:t.variables)!=null&&r.length&&(i=i.filter(({name:n})=>t.variables.includes(n)),i.forEach(n=>{n.dimensions=n.dimensions.map(s=>hfe(s,t,n.name)).filter(Dt)})),i}function L6e(t,e){var a;const{values:i}=e;if(i!=null&&i.length){const l=Array.isArray(i[0]),c=Array.isArray(t);return l!==c?-1:l&&c?i.findIndex(u=>u[0]===t[0]&&u[1]===t[1]):i.indexOf(t)}const{extent:r}=e;if(Array.isArray(t)||t<r[0]||t>r[1])return-1;const n=e.interval||1;if(e.unit!=="ISO8601")return Math.round((t-r[0])/n);const s=r[0];let o=-1;switch(((a=e.intervalUnit)==null?void 0:a.toLowerCase())||"seconds"){case"seconds":o=Math.round((t-s)/1e3/n);break;case"minutes":o=Math.round((t-s)/6e4/n);break;case"hours":o=Math.round((t-s)/36e5/n);break;case"days":o=Math.round((t-s)/864e5/n);break;case"months":{const l=new Date(t).getUTCFullYear()-new Date(s).getUTCFullYear(),c=new Date(s).getUTCMonth(),u=new Date(t).getUTCMonth();o=l===0?u-c:u+11-c+12*(l-1)}break;case"years":o=Math.round((new Date(t).getUTCFullYear()-new Date(s).getUTCFullYear())/n);break;case"decades":o=Math.round((new Date(t).getUTCFullYear()-new Date(s).getUTCFullYear())/10/n)}return o}function uY(t){var o,a;let e=(o=t.values)==null?void 0:o.length;if(e)return e;const{extent:i,unit:r}=t,n=t.interval||1,s=i?i[1]-i[0]:0;if(r!=="ISO8601")return Math.round(s/n);switch(((a=t.intervalUnit)==null?void 0:a.toLowerCase())??"seconds"){case"seconds":e=Math.round(s/1e3/n);break;case"minutes":e=Math.round(s/6e4/n);break;case"hours":e=Math.round(s/36e5/n);break;case"days":e=Math.round(s/864e5/n);break;case"months":{const l=new Date(i[1]).getUTCFullYear()-new Date(i[0]).getUTCFullYear(),c=new Date(i[0]).getUTCMonth(),u=new Date(i[1]).getUTCMonth();e=l===0?u-c+1:u+11-c+12*(l-1)+1}break;case"years":e=Math.round((new Date(i[1]).getUTCFullYear()-new Date(i[0]).getUTCFullYear())/n);break;case"decades":e=Math.round((new Date(i[1]).getUTCFullYear()-new Date(i[0]).getUTCFullYear())/10/n);break;default:e=0}return e}function R6e(t,e){let i=0;const r=t[0].variableName,n=[...e.variables].sort((s,o)=>s.name>o.name?1:-1);for(let s=0;s<n.length;s++){const o=n[s],a=[...o.dimensions].sort((u,h)=>u.name>h.name?-1:1);if(o.name!==r){i+=a.map(u=>uY(u)).reduce((u,h)=>u*h);continue}const l=a.map(u=>uY(u)),c=a.length;for(let u=0;u<c;u++){const h=t.find(m=>m.dimensionName===a[u].name);if(h==null)return null;const f=L6e(h.values[0],a[u]);if(f===-1)return null;l.shift(),i+=u===c-1?f:f*l.reduce((m,g)=>m*g)}break}return i}let F6e=class{constructor(e=15e3,i=5e3){this._timer=null,this._cachedBlocks=new Map,this._size=-1,this._duration=e,this._interval=Math.min(e,i)}decreaseRefCount(e,i){const r=e+"/"+i,n=this._cachedBlocks;if(n.has(r)){const s=n.get(r);return s.refCount--,s.refCount<=0&&(n.delete(r),s.controller&&s.controller.abort()),s.refCount}return 0}getBlock(e,i){const r=e+"/"+i,n=this._cachedBlocks;if(n.has(r)){const s=n.get(r);return s.ts=Date.now(),s.refCount++,n.delete(r),n.set(r,s),s.block}return null}putBlock(e,i,r,n){const s=this._cachedBlocks,o=e+"/"+i;if(s.has(o)){const a=s.get(o);a.ts=Date.now(),a.refCount++}else s.set(o,{block:r,ts:Date.now(),refCount:1,controller:n});this._trim(),this._updateTimer()}deleteBlock(e,i){const r=this._cachedBlocks,n=e+"/"+i;r.has(n)&&r.delete(n)}updateMaxSize(e){this._size=e,this._trim()}empty(){this._cachedBlocks.clear(),this._clearTimer()}getCurrentSize(){return this._cachedBlocks.size}_updateTimer(){if(this._timer!=null)return;const e=this._cachedBlocks;this._timer=setInterval(()=>{const i=Array.from(e),r=Date.now();for(let n=0;n<i.length&&i[n][1].ts<=r-this._duration;n++)e.delete(i[n][0]);e.size===0&&this._clearTimer()},this._interval)}_trim(){const e=this._cachedBlocks;if(this._size===-1||this._size>=e.size)return;const i=Array.from(e);for(let r=0;r<i.length-this._size;r++)e.delete(i[r][0])}_clearTimer(){this._timer!=null&&(clearInterval(this._timer),this._timer=null)}};var Pz;function ffe(t,e,i){return!lc(t,e,i)}function Yv(t,e,i){const r=ffe(t,e,i);if(r&&!pc())throw new N("rasterprojectionhelper-project","projection engine is not loaded");return r}(function(t){t[t.None=0]="None",t[t.North=1]="North",t[t.South=2]="South",t[t.Both=3]="Both"})(Pz||(Pz={}));const dY=(t,e,i,r=0)=>{if(i[0]===1)return[0,0];let n=1,s=-1,o=1,a=-1;for(let v=0;v<t.length;v+=2)isNaN(t[v])||(n=n>t[v]?t[v]:n,s=s>t[v]?s:t[v],o=o>t[v+1]?t[v+1]:o,a=a>t[v+1]?a:t[v+1]);const{cols:l,rows:c}=e,u=(s-n)/l/i[0],h=(a-o)/c/i[1],f=2*r;let m=0,g=!1,y=[0,0];for(let v=0;v<l-3;v++){for(let b=0;b<c-3;b++){const w=v*c*2+2*b,x=(t[w]+t[w+4]+t[w+4*c]+t[w+4*c+4])/4,S=(t[w+1]+t[w+5]+t[w+4*c+1]+t[w+4*c+5])/4,I=Math.abs((x-t[w+2*c+2])/u),T=Math.abs((S-t[w+2*c+3])/h);if(I+T>m&&(m=I+T,y=[I,T]),f&&m>f){g=!0;break}}if(g)break}return y},D6e={3395:20037508342789244e-9,3410:17334193943686873e-9,3857:20037508342788905e-9,3975:17367530445161372e-9,4087:20037508342789244e-9,4088:20015108787169147e-9,6933:17367530445161372e-9,32662:20037508342789244e-9,53001:2001508679602057e-8,53002:1000754339801029e-8,53003:2001508679602057e-8,53004:2001508679602057e-8,53016:14152803599503474e-9,53017:17333573624304302e-9,53034:2001508679602057e-8,53079:20015114352186374e-9,53080:20015114352186374e-9,54001:20037508342789244e-9,54002:10018754171394624e-9,54003:20037508342789244e-9,54004:20037508342789244e-9,54016:14168658027268292e-9,54017:1736753044516137e-8,54034:20037508342789244e-9,54079:20037508342789244e-9,54080:20037508342789244e-9,54100:20037508342789244e-9,54101:20037508342789244e-9},DP=32,NP=4,E5=NP,M5=new Map,$5=new Map,VP=500;async function Oz(){pc()||await Eu()}function e1t(t,e,i){return Yv(t.spatialReference,e),i?lP(e,t.spatialReference,t):lP(t.spatialReference,e,t)}function zP(t,e,i,r=null){const n=t.spatialReference;if(n.equals(e))return t;Yv(n,e,r);const s=i.center,o=new Re({xmin:s.x-t.x/2,xmax:s.x+t.x/2,ymin:s.y-t.y/2,ymax:s.y+t.y/2,spatialReference:n}),a=Ir(o,e,r),l=ba(e);let c;if(a==null||l!=null&&a.width>=l){const u=ti(n)/ti(e);c={x:t.x*u,y:t.y*u}}else c={x:a.width,y:a.height};return c}function tl(t,e=.01){return ti(t)?e/ti(t):0}function jP(t,e,i=null,r=!0){const n=t.spatialReference;if(n.equals(e))return t;Yv(n,e,i);const s=Ir(t,e,i);return r&&s&&mfe([t],[s],n,e),s}function mfe(t,e,i,r){const n=BP(i,!0),s=BP(r,!0),o=tl(i,VP),a=tl(r,VP);if(o&&n!=null&&s!=null)for(let l=0;l<t.length;l++){const c=e[l];if(!c)continue;const{x:u}=t[l],{x:h}=c;h>=s[1]-a&&Math.abs(u-n[0])<o?c.x-=s[1]-s[0]:h<=s[0]+a&&Math.abs(u-n[1])<o&&(c.x+=s[1]-s[0])}}function N6e(t){const{inSR:e,outSR:i,datumTransformation:r,preferPE:n}=t;if(e.equals(i)){const{points:s}=q9(t,null);return s}return e.isWebMercator&&i.isWGS84||e.isWGS84&&i.isWebMercator?z6e(t):Yv(e,i,r)&&n&&(e.isGeographic||Fv(e)!=null)?hY(t):V6e(t)}function V6e(t){const{points:e}=q9(t,null),{inSR:i,outSR:r,datumTransformation:n}=t,s=e.map(a=>new fe(a[0],a[1],i)),o=Ir(s,r,n);return n&&mfe(s,o,i,r),o.map(a=>a?[a.x,a.y]:[NaN,NaN])}function hY(t){const{inSR:e,outSR:i,datumTransformation:r}=t,n=Fv(e),{points:s,mask:o}=q9(t,n);if(!e.isGeographic){const l=e.wkid?Ka.coordsys(e.wkid):Ka.fromString(e.isGeographic?Ut.PE_TYPE_GEOGCS:Ut.PE_TYPE_PROJCS,e.wkt);oT.projToGeog(l,s.length,s)}if(r!=null&&r.steps.length){let l;if(i.isGeographic&&(l=s.map(([u])=>u>179.9955?1:u<-179.9955?-1:0)),r.steps.forEach(u=>{const h=u.wkid?Ka.geogtran(u.wkid):Ka.fromString(Ut.PE_TYPE_GEOGTRAN,u.wkt);nP.geogToGeog(h,s.length,s,null,u.isInverse?Ut.PE_TRANSFORM_2_TO_1:Ut.PE_TRANSFORM_1_TO_2)}),l)for(let u=0;u<s.length;u++){const h=l[u],f=s[u][0],m=f>179.9955?1:f<-179.9955?-1:0;h&&m&&h!==m&&(s[u][0]=h>0?f+360:f-360)}}if(!i.isGeographic){const l=Fv(i,!0),c=l!=null&&l.isEnvelope?[l.bbox[1],l.bbox[3]]:[-90,90];j6e(s,c);const u=i.wkid?Ka.coordsys(i.wkid):Ka.fromString(i.isGeographic?Ut.PE_TYPE_GEOGCS:Ut.PE_TYPE_PROJCS,i.wkt);oT.geogToProj(u,s.length,s)}let a=s;if(o&&s.length!==o.length){a=[];for(let l=0,c=0;l<o.length;l++)o[l]?a.push(s[c++]):a.push([NaN,NaN])}return a}function z6e(t){const{cols:e,rows:i,xres:r,yres:n,usePixelCenter:s,inSR:o,outSR:a}=t;let{xmin:l,ymax:c}=t;s&&(l+=r/2,c-=n/2);const u=[],h=[],f=Math.max(e,i);for(let g=0;g<f;g++){const y=l+r*Math.min(e,g),v=c-n*Math.min(i,g),b=Ir(new fe({x:y,y:v,spatialReference:o}),a);g<=e&&u.push(b.x),g<=i&&h.push(b.y)}const m=[];for(let g=0;g<e;g++)for(let y=0;y<i;y++)m.push([u[g],h[y]]);return m}function Fv(t,e=!1){let i=t.wkid||t.wkt;if(!i||t.isGeographic)return null;if(i=String(i),M5.has(i)){const o=M5.get(i);return e?o==null?void 0:o.gcs:o==null?void 0:o.pcs}const r=t.wkid?Ka.coordsys(t.wkid):Ka.fromString(t.isGeographic?Ut.PE_TYPE_GEOGCS:Ut.PE_TYPE_PROJCS,t.wkt),n=pY(r,tl(t,1e-4)),s=pY(r,0,!0);return M5.set(i,{pcs:n,gcs:s}),e?s:n}function pY(t,e=0,i=!1){const r=aT.generate(t),n=i?t.horizonGcsGenerate():t.horizonPcsGenerate();if(!r||!(n!=null&&n.length))return null;let s=!1,o=n.find(v=>v.getInclusive()===1&&v.getKind()===1);if(!o){if(o=n.find(v=>v.getInclusive()===1&&v.getKind()===0),!o)return null;s=!0}const a=i?0:(r.getNorthPoleLocation()===2?1:0)|(r.getSouthPoleLocation()===2?2:0),l=r.isPannableRectangle(),c=o.getCoord();if(s)return{isEnvelope:s,isPannable:l,vertices:c,coef:null,bbox:[c[0][0]-e,c[0][1]-e,c[1][0]+e,c[1][1]+e],poleLocation:a};let u=0;const h=[];let[f,m]=c[0],[g,y]=c[0];for(let v=0,b=c.length;v<b;v++){u++,u===b&&(u=0);const[w,x]=c[v],[S,I]=c[u];if(I===x)h.push([w,S,x,I,2]);else{const T=(S-w)/(I-x||1e-4),C=w-T*x;x<I?h.push([T,C,x,I,0]):h.push([T,C,I,x,1])}f=f<w?f:w,m=m<x?m:x,g=g>w?g:w,y=y>x?y:x}return{isEnvelope:!1,isPannable:l,vertices:c,coef:h,bbox:[f,m,g,y],poleLocation:a}}function q9(t,e){const i=[],{cols:r,rows:n,xres:s,yres:o,usePixelCenter:a}=t;let{xmin:l,ymax:c}=t;if(a&&(l+=s/2,c-=o/2),e==null){for(let m=0;m<r;m++)for(let g=0;g<n;g++)i.push([l+s*m,c-o*g]);return{points:i}}const u=new Uint8Array(r*n);if(e.isEnvelope){const{bbox:[m,g,y,v]}=e;for(let b=0,w=0;b<r;b++){const x=l+s*b,S=e.isPannable||x>=m&&x<=y;for(let I=0;I<n;I++,w++){const T=c-o*I;S&&T>=g&&T<=v&&(i.push([x,T]),u[w]=1)}}return{points:i,mask:u}}const h=e.coef,f=[];for(let m=0;m<n;m++){const g=c-o*m,y=[],v=[];for(let w=0;w<h.length;w++){const[x,S,I,T,C]=h[w];if(g===I&&I===T)y.push(x),y.push(S),v.push(2),v.push(2);else if(g>=I&&g<=T){const E=x*g+S;y.push(E),v.push(C)}}let b=y;if(y.length>2){let w=v[0]===2?0:v[0],x=y[0];b=[];for(let S=1;S<v.length;S++)v[S]===2&&S!==v.length-1||(v[S]!==w&&(b.push(w===0?Math.min(x,y[S-1]):Math.max(x,y[S-1])),w=v[S],x=y[S]),S===v.length-1&&b.push(v[S]===0?Math.min(x,y[S]):Math.max(x,y[S])));b.sort((S,I)=>S-I)}else y[0]>y[1]&&(b=[y[1],y[0]]);f.push(b)}for(let m=0,g=0;m<r;m++){const y=l+s*m;for(let v=0;v<n;v++,g++){const b=c-o*v,w=f[v];if(w.length===2)y>=w[0]&&y<=w[1]&&(i.push([y,b]),u[g]=1);else if(w.length>2){let x=!1;for(let S=0;S<w.length;S+=2)if(y>=w[S]&&y<=w[S+1]){x=!0;break}x&&(i.push([y,b]),u[g]=1)}}}return{points:i,mask:u}}function j6e(t,e){const[i,r]=e;for(let n=0;n<t.length;n++){const s=t[n][1];(s<i||s>r)&&(t[n]=[NaN,NaN])}}function gfe(t){const e=ba(t[0].spatialReference);if(t.length<2||e==null)return t[0];const i=tl(t[0].spatialReference);if((t=t.filter(a=>a.width>i)).length===1)return t[0];let{xmin:r,xmax:n,ymin:s,ymax:o}=t[0];for(let a=1;a<t.length;a++){const l=t[a];n=l.xmax+e*a,s=Math.min(s,l.ymin),o=Math.max(o,l.ymax)}return new Re({xmin:r,xmax:n,ymin:s,ymax:o,spatialReference:t[0].spatialReference})}function uv(t,e,i=null,r=!0){const n=t.spatialReference;if(n.equals(e))return t;const s=EA(t),o=ba(n,!0),a=ba(e);if(s===0||o==null||a==null){const c=fY(t,e,i,r);if(o==null&&a!=null&&Math.abs(c.width-a)<tl(e)&&pc()){const u=Fv(n);if(u!=null&&u.poleLocation===Pz.None&&t.width<(u.bbox[2]-u.bbox[0])/2)return U6e(t,e)||c}return c}const l=t.clone().normalize();if(l.length===1&&t.xmax<o&&t.xmax-o/2>tl(n)){const{xmin:c,xmax:u}=t;for(let h=0;h<=s;h++){const f=h===0?c:-o/2,m=h===s?u-o*h:o/2;l[h]=new Re({xmin:f,xmax:m,ymin:t.ymin,ymax:t.ymax,spatialReference:n})}}return gfe(l.map(c=>fY(c,e,i,r)).filter(Dt))}function B6e(t,e,i){if(t.type==="extent"){const{xmin:r,ymin:n,xmax:s,ymax:o,spatialReference:a}=t;t=new Zn({rings:[[[r,o],[s,o],[s,n],[r,n],[r,o]]],spatialReference:a})}return t.spatialReference.equals(e)?t:(Yv(t.spatialReference,e,i),Ir(t,e,i))}function U6e(t,e){const i=ba(e);if(i==null)return null;let{xmin:r,ymin:n,xmax:s,ymax:o}=t;const a=t.spatialReference,l=new Zn({spatialReference:a,rings:[[[r,n],[s,n],[s,o],[r,o],[r,n]]]}),c=Ir(l,e);if(c.rings.length!==2||!c.rings[0].length||!c.rings[1].length)return null;const{rings:u}=c,h=tl(a),f=new Re({spatialReference:e});for(let m=0;m<2;m++){r=s=u[m][0][0],n=o=u[m][0][1];for(let g=0;g<u[m].length;g++)r=r>u[m][g][0]?u[m][g][0]:r,s=s<u[m][g][0]?u[m][g][0]:s,n=n>u[m][g][1]?u[m][g][1]:n,o=o<u[m][g][1]?u[m][g][1]:o;if(m===0)f.ymin=n,f.ymax=o,f.xmin=r,f.xmax=s;else if(f.ymin=Math.min(f.ymin,n),f.ymax=Math.max(f.ymax,o),Math.abs(s-i/2)<h)f.xmin=r,f.xmax=f.xmax+i;else{if(!(Math.abs(r+i/2)<h))return null;f.xmax=s+i}}return f}function fY(t,e,i=null,r=!0,n=!0){const s=t.spatialReference;if(s.equals(e)||!e)return t;Yv(s,e,i);const o=Ir(t,e,i);if(n&&e.isWebMercator&&o&&(o.ymax=Math.min(20037508342787e-6,o.ymax),o.ymin=Math.max(-20037508342787e-6,o.ymin),o.ymin>=o.ymax))return null;if(!r||!o)return o;const a=BP(s,!0),l=BP(e,!0);if(a==null||l==null)return o;const c=tl(s,.001),u=tl(s,VP),h=tl(e,.001);if(Math.abs(o.xmin-l[0])<h&&Math.abs(o.xmax-l[1])<h){const f=Math.abs(t.xmin-a[0]),m=Math.abs(a[1]-t.xmax);if(f<c&&m>u){o.xmin=l[0];const g=[];g.push(new fe(t.xmax,t.ymin,s)),g.push(new fe(t.xmax,(t.ymin+t.ymax)/2,s)),g.push(new fe(t.xmax,t.ymax,s));const y=g.map(v=>jP(v,e,i)).filter(v=>!isNaN(v==null?void 0:v.x)).map(v=>v.x);o.xmax=Math.max.apply(null,y)}if(m<c&&f>u){o.xmax=l[1];const g=[];g.push(new fe(t.xmin,t.ymin,s)),g.push(new fe(t.xmin,(t.ymin+t.ymax)/2,s)),g.push(new fe(t.xmin,t.ymax,s));const y=g.map(v=>jP(v,e,i)).filter(v=>!isNaN(v==null?void 0:v.x)).map(v=>v.x);o.xmin=Math.min.apply(null,y)}}else{const f=tl(e,.001);Math.abs(o.xmin-l[0])<f&&(o.xmin=l[0]),Math.abs(o.xmax-l[1])<f&&(o.xmax=l[1])}return o}function ba(t,e=!1){if(!t)return null;const i=e?20037508342787e-6:20037508342788905e-9;return t.isWebMercator?2*i:t.wkid&&t.isGeographic?360:2*D6e[t.wkid]||null}function BP(t,e=!1){if(t.isGeographic)return[-180,180];const i=ba(t,e);return i!=null?[-i/2,i/2]:null}function mY(t,e,i,r){let n=(t-e)/i;return n-Math.floor(n)!=0?n=Math.floor(n):r&&(n-=1),n}function EA(t,e=!1){const i=ba(t.spatialReference);if(i==null)return 0;const r=e?0:-(i/2),n=tl(t.spatialReference),s=!e&&Math.abs(t.xmax-i/2)<n?i/2:t.xmax,o=!e&&Math.abs(t.xmin+i/2)<n?-i/2:t.xmin;return mY(s,r,i,!0)-mY(o,r,i,!1)}function G6e(t){const e=t.storageInfo.origin.x,i=ba(t.spatialReference,!0);if(i==null)return{originX:e,halfWorldWidth:null,pyramidsInfo:null};const r=i/2,{nativePixelSize:n,storageInfo:s,extent:o}=t,{maximumPyramidLevel:a,blockWidth:l,pyramidScalingFactor:c}=s;let u=n.x;const h=[],f=t.transform!=null&&t.transform.type==="gcs-shift",m=e+(f?0:r),g=f?i-e:r-e;for(let y=0;y<=a;y++){const v=(o.xmax-e)/u/l,b=v-Math.floor(v)==0?v:Math.ceil(v),w=g/u/l,x=w-Math.floor(w)==0?w:Math.ceil(w),S=Math.floor(m/u/l),I=Math.round(m/u)%l,T=(l-Math.round(g/u)%l)%l;h.push({resolutionX:u,blockWidth:l,datsetColumnCount:b,worldColumnCountFromOrigin:x,leftMargin:I,rightPadding:T,originColumnOffset:S}),u*=c}return{originX:e,halfWorldWidth:r,pyramidsInfo:h,hasGCSSShiftTransform:f}}function H6e(t){if(!t||t.isGeographic)return t;const e=String(t.wkid||t.wkt);let i;return $5.has(e)?i=$5.get(e):(i=(t.wkid?Ka.coordsys(t.wkid):Ka.fromString(Ut.PE_TYPE_PROJCS,t.wkt)).getGeogcs().getCode(),$5.set(e,i)),new Ee({wkid:i})}function q6e(t){const e=t.isAdaptive&&t.spacing==null;let i=t.spacing||[DP,DP],r=A5(t),n={cols:r.size[0]+1,rows:r.size[1]+1};const s=r.outofBoundPointCount>0&&r.outofBoundPointCount<r.offsets.length/2;let o=r.outofBoundPointCount===r.offsets.length/2||e&&s?[0,0]:dY(r.offsets,n,i,E5);const a=(o[0]+o[1])/2,l=t.projectedExtent.spatialReference,c=t.srcBufferExtent.spatialReference;if(e&&(s||a>E5)&&(ffe(l,c,t.datumTransformation)&&(l.isGeographic||Fv(l)),i=[NP,NP],r=A5({...t,spacing:i}),n={cols:r.size[0]+1,rows:r.size[1]+1},o=dY(r.offsets,n,i,E5)),r.error=o,i[0]>1&&(r.coefficients=gY(r.offsets,n,s)),t.includeGCSGrid&&!l.isGeographic&&!l.isWebMercator)if(c.isGeographic)r.gcsGrid={offsets:r.offsets,coefficients:r.coefficients,spacing:i};else{const u=Fv(l);if(u!=null&&!u.isEnvelope){const h=H6e(l),f=uv(t.projectedExtent,h),{offsets:m}=A5({...t,srcBufferExtent:f,spacing:i}),g=gY(m,n,s);r.gcsGrid={offsets:m,coefficients:g,spacing:i}}}return r}function A5(t){const{projectedExtent:e,srcBufferExtent:i,pixelSize:r,datumTransformation:n,rasterTransform:s}=t,o=e.spatialReference,a=i.spatialReference,l=Yv(o,a),{xmin:c,ymin:u,xmax:h,ymax:f}=e,m=ba(a),g=m!=null&&(t.hasWrapAround||(s==null?void 0:s.type)==="gcs-shift"),y=t.spacing||[DP,DP],v=y[0]*r.x,b=y[1]*r.y,w=y[0]===1,x=Math.ceil((h-c)/v-.1/y[0])+(w?0:1),S=Math.ceil((f-u)/b-.1/y[1])+(w?0:1),I=N6e({cols:x,rows:S,xmin:c,ymax:f,xres:v,yres:b,inSR:o,outSR:a,datumTransformation:n,preferPE:y[0]<=NP,usePixelCenter:w}),T=[];let C,E=0;const $=w?-1:NaN,{xmin:P,xmax:k,ymax:L,width:F,height:V}=i,z=tl(a,VP),G=m!=null&&P>0&&k>m/2;let H=!1;if(l){const Z=Fv(o);H=Z!=null&&Z.poleLocation>0}for(let Z=0;Z<x;Z++){const K=[];for(let X=0;X<S;X++){let oe=I[Z*S+X];if(g&&oe[0]>k&&oe[0]>m/2-z?oe[0]-=m:g&&Z===0&&oe[0]<0&&G&&!s&&(oe[0]+=m),!oe||isNaN(oe[0])||isNaN(oe[1]))T.push($),T.push($),K.push(null),E++;else{if(s){const se=s.inverseTransform(new fe({x:oe[0],y:oe[1],spatialReference:a}));oe=[se.x,se.y]}K.push(oe),Z>0&&g&&C[X]&&oe[0]<C[X][0]&&(oe[0]+=m,H&&oe[0]>k&&oe[0]>m&&(oe[0]-=m)),T.push((oe[0]-P)/F),T.push((L-oe[1])/V)}}C=K}return{offsets:T,error:null,coefficients:null,outofBoundPointCount:E,spacing:y,size:w?[x,S]:[x-1,S-1]}}function gY(t,e,i){const{cols:r,rows:n}=e,s=new Float32Array((r-1)*(n-1)*2*6),o=new Float32Array([-0,-1,1,-1,1,-0,1,-0,-0]),a=new Float32Array([-1,1,0,0,-1,1,1,0,0]);for(let l=0;l<r-1;l++){for(let c=0;c<n-1;c++){let u=l*n*2+2*c;const h=t[u],f=t[u+1],m=t[u+2],g=t[u+3];u+=2*n;const y=t[u],v=t[u+1],b=t[u+2],w=t[u+3];let x=0,S=12*(c*(r-1)+l);for(let I=0;I<3;I++)s[S++]=o[x++]*h+o[x++]*m+o[x++]*b;x=0;for(let I=0;I<3;I++)s[S++]=o[x++]*f+o[x++]*g+o[x++]*w;x=0;for(let I=0;I<3;I++)s[S++]=a[x++]*h+a[x++]*y+a[x++]*b;x=0;for(let I=0;I<3;I++)s[S++]=a[x++]*f+a[x++]*v+a[x++]*w}if(i)for(let c=0;c<s.length;c++)isNaN(s[c])&&(s[c]=-1)}return s}function W6e(t){const e=t.clone().normalize();return e.length===1?e[0]:gfe(e)}function Lz(t,e,i){var g;const{storageInfo:r,pixelSize:n}=e;let s=0,o=!1;const{pyramidResolutions:a}=r,l=((g=r.tileInfo.format)==null?void 0:g.toLowerCase())==="mixed"?Math.max(1,Math.min(3,r.tileInfo.dpi/96)):1,c=(t.x+t.y)/2/l;if(a!=null&&a.length){const y=a[a.length-1],v=(y.x+y.y)/2,b=(n.x+n.y)/2;if(c<=b)s=0;else if(c>=v)s=a.length,o=c/v>8;else{let x,S=b;for(let I=1;I<=a.length;I++){if(x=(a[I-1].x+a[I-1].y)/2,c<=x){c===x?s=I:i==="down"?(s=I-1,o=c/S>8):s=i==="up"||c-S>x-c||c/S>2?I:I-1;break}S=x}}const w=s===0?n:a[s-1];return o&&Math.min(w.x,w.y)*ti(e.spatialReference)>19567&&(o=!1),{pyramidLevel:s,pyramidResolution:new fe({x:w.x,y:w.y,spatialReference:e.spatialReference}),excessiveReading:o}}const u=Math.log(t.x/n.x)/Math.LN2,h=Math.log(t.y/n.y)/Math.LN2,f=e.storageInfo.maximumPyramidLevel||0;s=i==="down"?Math.floor(Math.min(u,h)):i==="up"?Math.ceil(Math.max(u,h)):Math.round((u+h)/2),s<0?s=0:s>f&&(o=s>f+3,s=f);const m=2**s;return{pyramidLevel:s,pyramidResolution:new fe({x:m*e.nativePixelSize.x,y:m*e.nativePixelSize.y,spatialReference:e.spatialReference}),excessiveReading:o}}function t1t(t,e,i){var $;const r=(i==null?void 0:i.tileSize)??512,n=(i==null?void 0:i.alignGlobalDatasetWithAGOL)??!0,s=!!(i!=null&&i.limitToSrcResolution),{extent:o,spatialReference:a,pixelSize:l}=t,c=zP(new fe({x:l.x,y:l.y,spatialReference:a}),e,o);if(c==null)return{projectedPixelSize:null,scales:null,srcResolutions:null,isCustomTilingScheme:!1};const u=(c.x+c.y)/2,h=ti(e),f=u*h*96*39.37,m=e.isGeographic?256/r*2958287637958547e-7:256/r*591657527591555e-6;let g=t.dataType==="vector-magdir"||t.dataType==="vector-uv";const y=uv(o,e),v=Math.min(Math.ceil(Math.log(Math.min(t.width,t.height)/32)/Math.LN2),Math.ceil(Math.log(m/2/f)/Math.LN2));if(!g&&n&&(e.isGeographic||e.isWebMercator)&&(g=y.xmin*y.xmax<0,!g&&v<3)){const P=ba(e);if(P!=null){const k=2**v*u*r,L=Math.ceil(P/k);g=L===1||L===2&&P/2-y.xmax<k}}let b,w=f;const x=1.001,S=Math.min(2,Math.max(1.414,(($=t.storageInfo)==null?void 0:$.pyramidScalingFactor)||2));if(g){w=m;const P=e.isGeographic?1341104507446289e-21:.29858214164761665,k=P*(96*h*39.37),L=e.isGeographic?4326:3857;b=zP(new fe({x:P,y:P,spatialReference:{wkid:L}}),a,y),b.x*=w/k,b.y*=w/k}else{b={x:l.x,y:l.y};let P=0;for(;w<m*(x/2)&&P<v;)P++,w*=S,b.x*=S,b.y*=S;Math.max(w,m)/Math.min(w,m)<=x&&(w=m)}const I=[w],T=[{x:b.x,y:b.y}],C=70.5310735,E=Math.min(C,f)/x;for(;w>=E;)w/=S,b.x/=S,b.y/=S,I.push(w),T.push({x:b.x,y:b.y});if(s){const P=.001*l.x;let k=T.findIndex(L=>L.x>=l.x-P&&L.x<=l.x+P);k>-1?(T.length=k+1,I.length=k+1):(k=T.findIndex(L=>L.x<=l.x+P),k>0&&(T.length=k,I.length=k))}return{projectedPixelSize:c,scales:I,srcResolutions:T,isCustomTilingScheme:!g}}const wp=new Map,fg=new F6e;function yY(t,e){return e==null?t:`${t}?sliceId=${e}`}function i1t(t,e){const i={extent:null,rasterInfo:e,cache:new Map},r=wp.get(t);return r?(r.push(i),r.length-1):(wp.set(t,[i]),0)}function r1t(t,e){const i=wp.get(t);i&&(i[e]=null,i.some(r=>r!=null)||wp.delete(t))}function J6e(t,e,i){var o,a;const r=wp.get(t);if(!r)return e==null?fg.decreaseRefCount(t,i):0;if(e==null||r[e]==null)return fg.decreaseRefCount(t,i);const n=(o=r[e])==null?void 0:o.cache,s=n==null?void 0:n.get(i);if(n&&s){if(s.refCount--,s.refCount===0){n.delete(i);for(let l=0;l<r.length;l++)(a=r[l])==null||a.cache.delete(i);s.controller&&s.controller.abort()}return s.refCount}return 0}function vY(t,e,i){var s,o,a;const r=wp.get(t);if(!r)return e==null?fg.getBlock(t,i):null;if(e==null||r[e]==null){for(let l=0;l<r.length;l++){const c=(s=r[l])==null?void 0:s.cache.get(i);if(c)return c.refCount++,c.block}return fg.getBlock(t,i)}const n=(o=r[e])==null?void 0:o.cache.get(i);if(n)return n.refCount++,n.block;for(let l=0;l<r.length;l++){if(l===e||!r[l])continue;const c=(a=r[l])==null?void 0:a.cache,u=c==null?void 0:c.get(i);if(c&&u)return u.refCount++,c.set(i,u),u.block}return null}function _Y(t,e,i,r,n=null){var a;const s=wp.get(t);if(!s)return void(e==null&&fg.putBlock(t,i,r,n));if(e==null||s[e]==null)return void fg.putBlock(t,i,r,n);const o={refCount:1,block:r,isResolved:!1,isRejected:!1,controller:n};r.then(()=>o.isResolved=!0).catch(()=>o.isRejected=!0),(a=s[e])==null||a.cache.set(i,o)}function Z6e(t,e,i){var n;const r=wp.get(t);r?e!=null&&r[e]!=null?(n=r[e])==null||n.cache.delete(i):fg.deleteBlock(t,i):e==null&&fg.deleteBlock(t,i)}function Y6e(t,e){const i=wp.get(t);return i?i[e]??null:null}function n1t(t,e,i,r,n,s,o=null){const a=Y6e(t,e);if(!a)return;const l=a.extent,{cache:c,rasterInfo:u}=a;if(l&&l.xmin===i.xmin&&l.xmax===i.xmax&&l.ymin===i.ymin&&l.ymax===i.ymax)return;r=r??0;const h=i.clone().normalize(),{spatialReference:f,transform:m}=u,g=new Set;for(let y=0;y<h.length;y++){const v=h[y];if(v.xmax-v.xmin<=r||v.ymax-v.ymin<=r)continue;let b=uv(v,f,o);m!=null&&(b=m.inverseTransform(b));const w=new fe({x:r,y:r,spatialReference:v.spatialReference});if(n==null&&!(n=zP(w,f,v,o)))return;const{pyramidLevel:x,pyramidResolution:S,excessiveReading:I}=Lz(n,u,s||"closest");if(I)return;const{storageInfo:T}=u,{origin:C}=T,E={x:Math.max(0,Math.floor((b.xmin-C.x)/S.x)),y:Math.max(0,Math.floor((C.y-b.ymax)/S.y))},$=Math.ceil((b.xmax-b.xmin)/S.x-.1),P=Math.ceil((b.ymax-b.ymin)/S.y-.1),k=x>0?T.pyramidBlockWidth:T.blockWidth,L=x>0?T.pyramidBlockHeight:T.blockHeight,F=1,V=Math.max(0,Math.floor(E.x/k)-F),z=Math.max(0,Math.floor(E.y/L)-F),G=Math.floor((E.x+$-1)/k)+F,H=Math.floor((E.y+P-1)/L)+F;for(let Z=z;Z<=H;Z++)for(let K=V;K<=G;K++)g.add(`${x}/${Z}/${K}`)}c.forEach((y,v)=>{if(!g.has(v)){const b=c.get(v);(b==null||b.isResolved||b.isRejected)&&c.delete(v)}}),a.extent={xmin:i.xmin,ymin:i.ymin,xmax:i.xmax,ymax:i.ymax}}var k5,bY,wY,Rz={exports:{}};Rz.exports,bY=Rz,k5=function(){function t(){this.pos=0,this.bufferLength=0,this.eof=!1,this.buffer=null}return t.prototype={ensureBuffer:function(e){var i=this.buffer,r=i?i.byteLength:0;if(e<r)return i;for(var n=512;n<e;)n<<=1;for(var s=new Uint8Array(n),o=0;o<r;++o)s[o]=i[o];return this.buffer=s},getByte:function(){for(var e=this.pos;this.bufferLength<=e;){if(this.eof)return null;this.readBlock()}return this.buffer[this.pos++]},getBytes:function(e){var i=this.pos;if(e){this.ensureBuffer(i+e);for(var r=i+e;!this.eof&&this.bufferLength<r;)this.readBlock();var n=this.bufferLength;r>n&&(r=n)}else{for(;!this.eof;)this.readBlock();r=this.bufferLength}return this.pos=r,this.buffer.subarray(i,r)},lookChar:function(){for(var e=this.pos;this.bufferLength<=e;){if(this.eof)return null;this.readBlock()}return String.fromCharCode(this.buffer[this.pos])},getChar:function(){for(var e=this.pos;this.bufferLength<=e;){if(this.eof)return null;this.readBlock()}return String.fromCharCode(this.buffer[this.pos++])},makeSubStream:function(e,i,r){for(var n=e+i;this.bufferLength<=n&&!this.eof;)this.readBlock();return new Stream(this.buffer,e,i,r)},skip:function(e){e||(e=1),this.pos+=e},reset:function(){this.pos=0}},t}(),(wY=function(){if(!self||!self.Uint32Array)return null;var t=new Uint32Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),e=new Uint32Array([3,4,5,6,7,8,9,10,65547,65549,65551,65553,131091,131095,131099,131103,196643,196651,196659,196667,262211,262227,262243,262259,327811,327843,327875,327907,258,258,258]),i=new Uint32Array([1,2,3,4,65541,65543,131081,131085,196625,196633,262177,262193,327745,327777,393345,393409,459009,459137,524801,525057,590849,591361,657409,658433,724993,727041,794625,798721,868353,876545]),r=[new Uint32Array([459008,524368,524304,524568,459024,524400,524336,590016,459016,524384,524320,589984,524288,524416,524352,590048,459012,524376,524312,589968,459028,524408,524344,590032,459020,524392,524328,59e4,524296,524424,524360,590064,459010,524372,524308,524572,459026,524404,524340,590024,459018,524388,524324,589992,524292,524420,524356,590056,459014,524380,524316,589976,459030,524412,524348,590040,459022,524396,524332,590008,524300,524428,524364,590072,459009,524370,524306,524570,459025,524402,524338,590020,459017,524386,524322,589988,524290,524418,524354,590052,459013,524378,524314,589972,459029,524410,524346,590036,459021,524394,524330,590004,524298,524426,524362,590068,459011,524374,524310,524574,459027,524406,524342,590028,459019,524390,524326,589996,524294,524422,524358,590060,459015,524382,524318,589980,459031,524414,524350,590044,459023,524398,524334,590012,524302,524430,524366,590076,459008,524369,524305,524569,459024,524401,524337,590018,459016,524385,524321,589986,524289,524417,524353,590050,459012,524377,524313,589970,459028,524409,524345,590034,459020,524393,524329,590002,524297,524425,524361,590066,459010,524373,524309,524573,459026,524405,524341,590026,459018,524389,524325,589994,524293,524421,524357,590058,459014,524381,524317,589978,459030,524413,524349,590042,459022,524397,524333,590010,524301,524429,524365,590074,459009,524371,524307,524571,459025,524403,524339,590022,459017,524387,524323,589990,524291,524419,524355,590054,459013,524379,524315,589974,459029,524411,524347,590038,459021,524395,524331,590006,524299,524427,524363,590070,459011,524375,524311,524575,459027,524407,524343,590030,459019,524391,524327,589998,524295,524423,524359,590062,459015,524383,524319,589982,459031,524415,524351,590046,459023,524399,524335,590014,524303,524431,524367,590078,459008,524368,524304,524568,459024,524400,524336,590017,459016,524384,524320,589985,524288,524416,524352,590049,459012,524376,524312,589969,459028,524408,524344,590033,459020,524392,524328,590001,524296,524424,524360,590065,459010,524372,524308,524572,459026,524404,524340,590025,459018,524388,524324,589993,524292,524420,524356,590057,459014,524380,524316,589977,459030,524412,524348,590041,459022,524396,524332,590009,524300,524428,524364,590073,459009,524370,524306,524570,459025,524402,524338,590021,459017,524386,524322,589989,524290,524418,524354,590053,459013,524378,524314,589973,459029,524410,524346,590037,459021,524394,524330,590005,524298,524426,524362,590069,459011,524374,524310,524574,459027,524406,524342,590029,459019,524390,524326,589997,524294,524422,524358,590061,459015,524382,524318,589981,459031,524414,524350,590045,459023,524398,524334,590013,524302,524430,524366,590077,459008,524369,524305,524569,459024,524401,524337,590019,459016,524385,524321,589987,524289,524417,524353,590051,459012,524377,524313,589971,459028,524409,524345,590035,459020,524393,524329,590003,524297,524425,524361,590067,459010,524373,524309,524573,459026,524405,524341,590027,459018,524389,524325,589995,524293,524421,524357,590059,459014,524381,524317,589979,459030,524413,524349,590043,459022,524397,524333,590011,524301,524429,524365,590075,459009,524371,524307,524571,459025,524403,524339,590023,459017,524387,524323,589991,524291,524419,524355,590055,459013,524379,524315,589975,459029,524411,524347,590039,459021,524395,524331,590007,524299,524427,524363,590071,459011,524375,524311,524575,459027,524407,524343,590031,459019,524391,524327,589999,524295,524423,524359,590063,459015,524383,524319,589983,459031,524415,524351,590047,459023,524399,524335,590015,524303,524431,524367,590079]),9],n=[new Uint32Array([327680,327696,327688,327704,327684,327700,327692,327708,327682,327698,327690,327706,327686,327702,327694,0,327681,327697,327689,327705,327685,327701,327693,327709,327683,327699,327691,327707,327687,327703,327695,0]),5];function s(a){throw new Error(a)}function o(a){var l=0,c=a[l++],u=a[l++];c!=-1&&u!=-1||s("Invalid header in flate stream"),(15&c)!=8&&s("Unknown compression method in flate stream"),((c<<8)+u)%31!=0&&s("Bad FCHECK in flate stream"),32&u&&s("FDICT bit set in flate stream"),this.bytes=a,this.bytesPos=l,this.codeSize=0,this.codeBuf=0,k5.call(this)}return o.prototype=Object.create(k5.prototype),o.prototype.getBits=function(a){for(var l,c=this.codeSize,u=this.codeBuf,h=this.bytes,f=this.bytesPos;c<a;)(l=h[f++])===void 0&&s("Bad encoding in flate stream"),u|=l<<c,c+=8;return l=u&(1<<a)-1,this.codeBuf=u>>a,this.codeSize=c-=a,this.bytesPos=f,l},o.prototype.getCode=function(a){for(var l=a[0],c=a[1],u=this.codeSize,h=this.codeBuf,f=this.bytes,m=this.bytesPos;u<c;){var g;(g=f[m++])===void 0&&s("Bad encoding in flate stream"),h|=g<<u,u+=8}var y=l[h&(1<<c)-1],v=y>>16,b=65535&y;return(u==0||u<v||v==0)&&s("Bad encoding in flate stream"),this.codeBuf=h>>v,this.codeSize=u-v,this.bytesPos=m,b},o.prototype.generateHuffmanTable=function(a){for(var l=a.length,c=0,u=0;u<l;++u)a[u]>c&&(c=a[u]);for(var h=1<<c,f=new Uint32Array(h),m=1,g=0,y=2;m<=c;++m,g<<=1,y<<=1)for(var v=0;v<l;++v)if(a[v]==m){var b=0,w=g;for(u=0;u<m;++u)b=b<<1|1&w,w>>=1;for(u=b;u<h;u+=y)f[u]=m<<16|v;++g}return[f,c]},o.prototype.readBlock=function(){function a(X,oe,se,le,me){for(var Se=X.getBits(se)+le;Se-- >0;)oe[y++]=me}var l=this.getBits(3);if(1&l&&(this.eof=!0),(l>>=1)!=0){var c,u;if(l==1)c=r,u=n;else if(l==2){for(var h=this.getBits(5)+257,f=this.getBits(5)+1,m=this.getBits(4)+4,g=Array(t.length),y=0;y<m;)g[t[y++]]=this.getBits(3);for(var v=this.generateHuffmanTable(g),b=0,w=(y=0,h+f),x=new Array(w);y<w;){var S=this.getCode(v);S==16?a(this,x,2,3,b):S==17?a(this,x,3,3,b=0):S==18?a(this,x,7,11,b=0):x[y++]=b=S}c=this.generateHuffmanTable(x.slice(0,h)),u=this.generateHuffmanTable(x.slice(h,w))}else s("Unknown block type in flate stream");for(var I=(H=this.buffer)?H.length:0,T=this.bufferLength;;){var C=this.getCode(c);if(C<256)T+1>=I&&(I=(H=this.ensureBuffer(T+1)).length),H[T++]=C;else{if(C==256)return void(this.bufferLength=T);var E=(C=e[C-=257])>>16;E>0&&(E=this.getBits(E)),b=(65535&C)+E,C=this.getCode(u),(E=(C=i[C])>>16)>0&&(E=this.getBits(E));var $=(65535&C)+E;T+b>=I&&(I=(H=this.ensureBuffer(T+b)).length);for(var P=0;P<b;++P,++T)H[T]=H[T-$]}}}else{var k,L=this.bytes,F=this.bytesPos;(k=L[F++])===void 0&&s("Bad block header in flate stream");var V=k;(k=L[F++])===void 0&&s("Bad block header in flate stream"),V|=k<<8,(k=L[F++])===void 0&&s("Bad block header in flate stream");var z=k;(k=L[F++])===void 0&&s("Bad block header in flate stream"),(z|=k<<8)!=(65535&~V)&&s("Bad uncompressed block length in flate stream"),this.codeBuf=0,this.codeSize=0;var G=this.bufferLength,H=this.ensureBuffer(G+V),Z=G+V;this.bufferLength=Z;for(var K=G;K<Z;++K){if((k=L[F++])===void 0){this.eof=!0;break}H[K]=k}this.bytesPos=F}},o}())!==void 0&&(bY.exports=wY);const RC=KU(Rz.exports);let K6e=class yfe{constructor(e){this._canvas=null,this._ctx=null,e&&(this._canvas=e.canvas,this._ctx=e.ctx||e.canvas&&e.canvas.getContext("2d"))}decode(e,i,r){if(!e||e.byteLength<10)throw new N("imagecanvasdecoder: decode","required a valid encoded data as input.");let{width:n=0,height:s=0,format:o}=i;const{applyJpegMask:a}=i;if(a&&(!n||!s))throw new N("imagecanvasdecoder: decode","image width and height are needed to apply jpeg mask directly to canvas");return new Promise((l,c)=>{let u=null;o==="jpg"&&a&&(u=yfe._getMask(e,{width:n,height:s}));const h=new Blob([new Uint8Array(e)],{type:"image/"+o=="jpg"?"jpeg":o}),f=URL.createObjectURL(h),m=new Image;let g;m.src=f,m.onload=()=>{if(URL.revokeObjectURL(f),zo(r))return void c(wi());n=m.width,s=m.height,this._canvas&&this._ctx?(this._canvas.width===n&&this._canvas.height===s||(this._canvas.width=n,this._canvas.height=s),this._ctx.clearRect(0,0,n,s)):(this._canvas=document.createElement("canvas"),this._canvas.width=n,this._canvas.height=s,this._ctx=this._canvas.getContext("2d")),this._ctx.drawImage(m,0,0);const y=this._ctx.getImageData(0,0,n,s);let v;if(g=y.data,i.renderOnCanvas){if(u)for(v=0;v<u.length;v++)u[v]?g[4*v+3]=255:g[4*v+3]=0;return this._ctx.putImageData(y,0,0),void l(null)}const b=n*s,w=new Uint8Array(b),x=new Uint8Array(b),S=new Uint8Array(b);if(u)for(v=0;v<b;v++)w[v]=g[4*v],x[v]=g[4*v+1],S[v]=g[4*v+2];else for(u=new Uint8Array(b),v=0;v<b;v++)w[v]=g[4*v],x[v]=g[4*v+1],S[v]=g[4*v+2],u[v]=g[4*v+3];l({width:n,height:s,pixels:[w,x,S],mask:u,pixelType:"u8"})},m.onerror=()=>{URL.revokeObjectURL(f),c("cannot load image")}})}static _getMask(e,i){let r=null;try{const n=new Uint8Array(e),s=Math.ceil(n.length/2);let o=0;const a=n.length-2;for(o=s;o<a&&(n[o]!==255||n[o+1]!==217);o++);if(o+=2,o<n.length-1){const l=new RC(n.subarray(o)).getBytes();r=new Uint8Array(i.width*i.height);let c=0;for(let u=0;u<l.length;u++)for(let h=7;h>=0;h--)r[c++]=l[u]>>h&1}}catch{}return r}};var xY,SY,IY,Fz={exports:{}};Fz.exports,xY=Fz,SY=function(){var t=function(){function e(i){this.message="JPEG error: "+i}return e.prototype=new Error,e.prototype.name="JpegError",e.constructor=e,e}();return function(){if(!self||!self.Uint8ClampedArray)return null;var e=new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),i=4017,r=799,n=3406,s=2276,o=1567,a=3784,l=5793,c=2896;function u(){this.decodeTransform=null,this.colorTransform=-1}function h(b,w){for(var x,S,I=0,T=[],C=16;C>0&&!b[C-1];)C--;T.push({children:[],index:0});var E,$=T[0];for(x=0;x<C;x++){for(S=0;S<b[x];S++){for(($=T.pop()).children[$.index]=w[I];$.index>0;)$=T.pop();for($.index++,T.push($);T.length<=x;)T.push(E={children:[],index:0}),$.children[$.index]=E.children,$=E;I++}x+1<C&&(T.push(E={children:[],index:0}),$.children[$.index]=E.children,$=E)}return T[0].children}function f(b,w,x){return 64*((b.blocksPerLine+1)*w+x)}function m(b,w,x,S,I,T,C,E,$){var P=x.mcusPerLine,k=x.progressive,L=w,F=0,V=0;function z(){if(V>0)return V--,F>>V&1;if((F=b[w++])===255){var Ce=b[w++];if(Ce)throw new t("unexpected marker "+(F<<8|Ce).toString(16))}return V=7,F>>>7}function G(Ce){for(var Xe=Ce;;){if(typeof(Xe=Xe[z()])=="number")return Xe;if(typeof Xe!="object")throw new t("invalid huffman sequence")}}function H(Ce){for(var Xe=0;Ce>0;)Xe=Xe<<1|z(),Ce--;return Xe}function Z(Ce){if(Ce===1)return z()===1?1:-1;var Xe=H(Ce);return Xe>=1<<Ce-1?Xe:Xe+(-1<<Ce)+1}function K(Ce,Xe){var Rt=G(Ce.huffmanTableDC),Qi=Rt===0?0:Z(Rt);Ce.blockData[Xe]=Ce.pred+=Qi;for(var xi=1;xi<64;){var Ln=G(Ce.huffmanTableAC),Fr=15&Ln,Rn=Ln>>4;if(Fr!==0){var Rp=e[xi+=Rn];Ce.blockData[Xe+Rp]=Z(Fr),xi++}else{if(Rn<15)break;xi+=16}}}function X(Ce,Xe){var Rt=G(Ce.huffmanTableDC),Qi=Rt===0?0:Z(Rt)<<$;Ce.blockData[Xe]=Ce.pred+=Qi}function oe(Ce,Xe){Ce.blockData[Xe]|=z()<<$}var se=0;function le(Ce,Xe){if(se>0)se--;else for(var Rt=T,Qi=C;Rt<=Qi;){var xi=G(Ce.huffmanTableAC),Ln=15&xi,Fr=xi>>4;if(Ln!==0){var Rn=e[Rt+=Fr];Ce.blockData[Xe+Rn]=Z(Ln)*(1<<$),Rt++}else{if(Fr<15){se=H(Fr)+(1<<Fr)-1;break}Rt+=16}}}var me,Se=0;function Ge(Ce,Xe){for(var Rt,Qi,xi=T,Ln=C,Fr=0;xi<=Ln;){var Rn=e[xi];switch(Se){case 0:if(Fr=(Qi=G(Ce.huffmanTableAC))>>4,(Rt=15&Qi)==0)Fr<15?(se=H(Fr)+(1<<Fr),Se=4):(Fr=16,Se=1);else{if(Rt!==1)throw new t("invalid ACn encoding");me=Z(Rt),Se=Fr?2:3}continue;case 1:case 2:Ce.blockData[Xe+Rn]?Ce.blockData[Xe+Rn]+=z()<<$:--Fr==0&&(Se=Se===2?3:0);break;case 3:Ce.blockData[Xe+Rn]?Ce.blockData[Xe+Rn]+=z()<<$:(Ce.blockData[Xe+Rn]=me<<$,Se=0);break;case 4:Ce.blockData[Xe+Rn]&&(Ce.blockData[Xe+Rn]+=z()<<$)}xi++}Se===4&&--se==0&&(Se=0)}function Be(Ce,Xe,Rt,Qi,xi){var Ln=Rt%P;Xe(Ce,f(Ce,(Rt/P|0)*Ce.v+Qi,Ln*Ce.h+xi))}function gt(Ce,Xe,Rt){Xe(Ce,f(Ce,Rt/Ce.blocksPerLine|0,Rt%Ce.blocksPerLine))}var Pe,De,ii,Rr,At,mo,bs=S.length;mo=k?T===0?E===0?X:oe:E===0?le:Ge:K;var Ai,un,fc,mc,cr=0;for(un=bs===1?S[0].blocksPerLine*S[0].blocksPerColumn:P*x.mcusPerColumn;cr<un;){var ur=I?Math.min(un-cr,I):un;for(De=0;De<bs;De++)S[De].pred=0;if(se=0,bs===1)for(Pe=S[0],At=0;At<ur;At++)gt(Pe,mo,cr),cr++;else for(At=0;At<ur;At++){for(De=0;De<bs;De++)for(fc=(Pe=S[De]).h,mc=Pe.v,ii=0;ii<mc;ii++)for(Rr=0;Rr<fc;Rr++)Be(Pe,mo,cr,ii,Rr);cr++}V=0,(Ai=v(b,w))&&Ai.invalid&&(console.log("decodeScan - unexpected MCU data, next marker is: "+Ai.invalid),w=Ai.offset);var Ho=Ai&&Ai.marker;if(!Ho||Ho<=65280)throw new t("marker was not found");if(!(Ho>=65488&&Ho<=65495))break;w+=2}return(Ai=v(b,w))&&Ai.invalid&&(console.log("decodeScan - unexpected Scan data, next marker is: "+Ai.invalid),w=Ai.offset),w-L}function g(b,w,x){var S,I,T,C,E,$,P,k,L,F,V,z,G,H,Z,K,X,oe=b.quantizationTable,se=b.blockData;if(!oe)throw new t("missing required Quantization Table.");for(var le=0;le<64;le+=8)L=se[w+le],F=se[w+le+1],V=se[w+le+2],z=se[w+le+3],G=se[w+le+4],H=se[w+le+5],Z=se[w+le+6],K=se[w+le+7],L*=oe[le],F|V|z|G|H|Z|K?(F*=oe[le+1],V*=oe[le+2],z*=oe[le+3],G*=oe[le+4],H*=oe[le+5],Z*=oe[le+6],K*=oe[le+7],I=(S=(S=l*L+128>>8)+(I=l*G+128>>8)+1>>1)-I,X=(T=V)*a+(C=Z)*o+128>>8,T=T*o-C*a+128>>8,P=(E=(E=c*(F-K)+128>>8)+(P=H<<4)+1>>1)-P,$=(k=(k=c*(F+K)+128>>8)+($=z<<4)+1>>1)-$,C=(S=S+(C=X)+1>>1)-C,T=(I=I+T+1>>1)-T,X=E*s+k*n+2048>>12,E=E*n-k*s+2048>>12,k=X,X=$*r+P*i+2048>>12,$=$*i-P*r+2048>>12,P=X,x[le]=S+k,x[le+7]=S-k,x[le+1]=I+P,x[le+6]=I-P,x[le+2]=T+$,x[le+5]=T-$,x[le+3]=C+E,x[le+4]=C-E):(X=l*L+512>>10,x[le]=X,x[le+1]=X,x[le+2]=X,x[le+3]=X,x[le+4]=X,x[le+5]=X,x[le+6]=X,x[le+7]=X);for(var me=0;me<8;++me)L=x[me],(F=x[me+8])|(V=x[me+16])|(z=x[me+24])|(G=x[me+32])|(H=x[me+40])|(Z=x[me+48])|(K=x[me+56])?(I=(S=4112+((S=l*L+2048>>12)+(I=l*G+2048>>12)+1>>1))-I,X=(T=V)*a+(C=Z)*o+2048>>12,T=T*o-C*a+2048>>12,C=X,P=(E=(E=c*(F-K)+2048>>12)+(P=H)+1>>1)-P,$=(k=(k=c*(F+K)+2048>>12)+($=z)+1>>1)-$,X=E*s+k*n+2048>>12,E=E*n-k*s+2048>>12,k=X,X=$*r+P*i+2048>>12,$=$*i-P*r+2048>>12,L=(L=(S=S+C+1>>1)+k)<16?0:L>=4080?255:L>>4,F=(F=(I=I+T+1>>1)+(P=X))<16?0:F>=4080?255:F>>4,V=(V=(T=I-T)+$)<16?0:V>=4080?255:V>>4,z=(z=(C=S-C)+E)<16?0:z>=4080?255:z>>4,G=(G=C-E)<16?0:G>=4080?255:G>>4,H=(H=T-$)<16?0:H>=4080?255:H>>4,Z=(Z=I-P)<16?0:Z>=4080?255:Z>>4,K=(K=S-k)<16?0:K>=4080?255:K>>4,se[w+me]=L,se[w+me+8]=F,se[w+me+16]=V,se[w+me+24]=z,se[w+me+32]=G,se[w+me+40]=H,se[w+me+48]=Z,se[w+me+56]=K):(X=(X=l*L+8192>>14)<-2040?0:X>=2024?255:X+2056>>4,se[w+me]=X,se[w+me+8]=X,se[w+me+16]=X,se[w+me+24]=X,se[w+me+32]=X,se[w+me+40]=X,se[w+me+48]=X,se[w+me+56]=X)}function y(b,w){for(var x=w.blocksPerLine,S=w.blocksPerColumn,I=new Int16Array(64),T=0;T<S;T++)for(var C=0;C<x;C++)g(w,f(w,T,C),I);return w.blockData}function v(b,w,x){function S($){return b[$]<<8|b[$+1]}var I=b.length-1,T=x<w?x:w;if(w>=I)return null;var C=S(w);if(C>=65472&&C<=65534)return{invalid:null,marker:C,offset:w};for(var E=S(T);!(E>=65472&&E<=65534);){if(++T>=I)return null;E=S(T)}return{invalid:C.toString(16),marker:E,offset:T}}return u.prototype={parse:function(b){function w(){var Ce=b[C]<<8|b[C+1];return C+=2,Ce}function x(){var Ce=w(),Xe=C+Ce-2,Rt=v(b,Xe,C);Rt&&Rt.invalid&&(console.log("readDataBlock - incorrect length, next marker is: "+Rt.invalid),Xe=Rt.offset);var Qi=b.subarray(C,Xe);return C+=Qi.length,Qi}function S(Ce){for(var Xe=Math.ceil(Ce.samplesPerLine/8/Ce.maxH),Rt=Math.ceil(Ce.scanLines/8/Ce.maxV),Qi=0;Qi<Ce.components.length;Qi++){At=Ce.components[Qi];var xi=Math.ceil(Math.ceil(Ce.samplesPerLine/8)*At.h/Ce.maxH),Ln=Math.ceil(Math.ceil(Ce.scanLines/8)*At.v/Ce.maxV),Fr=Xe*At.h,Rn=Rt*At.v*64*(Fr+1);At.blockData=new Int16Array(Rn),At.blocksPerLine=xi,At.blocksPerColumn=Ln}Ce.mcusPerLine=Xe,Ce.mcusPerColumn=Rt}var I,T,C=0,E=null,$=null,P=[],k=[],L=[],F=w();if(F!==65496)throw new t("SOI not found");for(F=w();F!==65497;){var V,z,G;switch(F){case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var H=x();F===65504&&H[0]===74&&H[1]===70&&H[2]===73&&H[3]===70&&H[4]===0&&(E={version:{major:H[5],minor:H[6]},densityUnits:H[7],xDensity:H[8]<<8|H[9],yDensity:H[10]<<8|H[11],thumbWidth:H[12],thumbHeight:H[13],thumbData:H.subarray(14,14+3*H[12]*H[13])}),F===65518&&H[0]===65&&H[1]===100&&H[2]===111&&H[3]===98&&H[4]===101&&($={version:H[5]<<8|H[6],flags0:H[7]<<8|H[8],flags1:H[9]<<8|H[10],transformCode:H[11]});break;case 65499:for(var Z=w()+C-2;C<Z;){var K=b[C++],X=new Uint16Array(64);if(K>>4){if(K>>4!=1)throw new t("DQT - invalid table spec");for(z=0;z<64;z++)X[e[z]]=w()}else for(z=0;z<64;z++)X[e[z]]=b[C++];P[15&K]=X}break;case 65472:case 65473:case 65474:if(I)throw new t("Only single frame JPEGs supported");w(),(I={}).extended=F===65473,I.progressive=F===65474,I.precision=b[C++],I.scanLines=w(),I.samplesPerLine=w(),I.components=[],I.componentIds={};var oe,se=b[C++],le=0,me=0;for(V=0;V<se;V++){oe=b[C];var Se=b[C+1]>>4,Ge=15&b[C+1];le<Se&&(le=Se),me<Ge&&(me=Ge);var Be=b[C+2];G=I.components.push({h:Se,v:Ge,quantizationId:Be,quantizationTable:null}),I.componentIds[oe]=G-1,C+=3}I.maxH=le,I.maxV=me,S(I);break;case 65476:var gt=w();for(V=2;V<gt;){var Pe=b[C++],De=new Uint8Array(16),ii=0;for(z=0;z<16;z++,C++)ii+=De[z]=b[C];var Rr=new Uint8Array(ii);for(z=0;z<ii;z++,C++)Rr[z]=b[C];V+=17+ii,(Pe>>4?k:L)[15&Pe]=h(De,Rr)}break;case 65501:w(),T=w();break;case 65498:w();var At,mo=b[C++],bs=[];for(V=0;V<mo;V++){var Ai=I.componentIds[b[C++]];At=I.components[Ai];var un=b[C++];At.huffmanTableDC=L[un>>4],At.huffmanTableAC=k[15&un],bs.push(At)}var fc=b[C++],mc=b[C++],cr=b[C++],ur=m(b,C,I,bs,T,fc,mc,cr>>4,15&cr);C+=ur;break;case 65535:b[C]!==255&&C--;break;default:if(b[C-3]===255&&b[C-2]>=192&&b[C-2]<=254){C-=3;break}throw new t("unknown marker "+F.toString(16))}F=w()}for(this.width=I.samplesPerLine,this.height=I.scanLines,this.jfif=E,this.eof=C,this.adobe=$,this.components=[],V=0;V<I.components.length;V++){var Ho=P[(At=I.components[V]).quantizationId];Ho&&(At.quantizationTable=Ho),this.components.push({output:y(I,At),scaleX:At.h/I.maxH,scaleY:At.v/I.maxV,blocksPerLine:At.blocksPerLine,blocksPerColumn:At.blocksPerColumn})}this.numComponents=this.components.length},_getLinearizedBlockData:function(b,w){var x,S,I,T,C,E,$,P,k,L,F,V=this.width/b,z=this.height/w,G=0,H=this.components.length,Z=b*w*H,K=new Uint8ClampedArray(Z),X=new Uint32Array(b),oe=4294967288;for($=0;$<H;$++){for(S=(x=this.components[$]).scaleX*V,I=x.scaleY*z,G=$,F=x.output,T=x.blocksPerLine+1<<3,C=0;C<b;C++)P=0|C*S,X[C]=(P&oe)<<3|7&P;for(E=0;E<w;E++)for(L=T*((P=0|E*I)&oe)|(7&P)<<3,C=0;C<b;C++)K[G]=F[L+X[C]],G+=H}var se=this.decodeTransform;if(se)for($=0;$<Z;)for(P=0,k=0;P<H;P++,$++,k+=2)K[$]=(K[$]*se[k]>>8)+se[k+1];return K},_isColorConversionNeeded:function(){return this.adobe?!!this.adobe.transformCode:this.numComponents===3?this.colorTransform!==0:this.colorTransform===1},_convertYccToRgb:function(b){for(var w,x,S,I=0,T=b.length;I<T;I+=3)w=b[I],x=b[I+1],S=b[I+2],b[I]=w-179.456+1.402*S,b[I+1]=w+135.459-.344*x-.714*S,b[I+2]=w-226.816+1.772*x;return b},_convertYcckToRgb:function(b){for(var w,x,S,I,T=0,C=0,E=b.length;C<E;C+=4)w=b[C],x=b[C+1],S=b[C+2],I=b[C+3],b[T++]=x*(-660635669420364e-19*x+.000437130475926232*S-54080610064599e-18*w+.00048449797120281*I-.154362151871126)-122.67195406894+S*(-.000957964378445773*S+.000817076911346625*w-.00477271405408747*I+1.53380253221734)+w*(.000961250184130688*w-.00266257332283933*I+.48357088451265)+I*(-.000336197177618394*I+.484791561490776),b[T++]=107.268039397724+x*(219927104525741e-19*x-.000640992018297945*S+.000659397001245577*w+.000426105652938837*I-.176491792462875)+S*(-.000778269941513683*S+.00130872261408275*w+.000770482631801132*I-.151051492775562)+w*(.00126935368114843*w-.00265090189010898*I+.25802910206845)+I*(-.000318913117588328*I-.213742400323665),b[T++]=x*(-.000570115196973677*x-263409051004589e-19*S+.0020741088115012*w-.00288260236853442*I+.814272968359295)-20.810012546947+S*(-153496057440975e-19*S-.000132689043961446*w+.000560833691242812*I-.195152027534049)+w*(.00174418132927582*w-.00255243321439347*I+.116935020465145)+I*(-.000343531996510555*I+.24165260232407);return b},_convertYcckToCmyk:function(b){for(var w,x,S,I=0,T=b.length;I<T;I+=4)w=b[I],x=b[I+1],S=b[I+2],b[I]=434.456-w-1.402*S,b[I+1]=119.541-w+.344*x+.714*S,b[I+2]=481.816-w-1.772*x;return b},_convertCmykToRgb:function(b){for(var w,x,S,I,T=0,C=1/255,E=0,$=b.length;E<$;E+=4)w=b[E]*C,x=b[E+1]*C,S=b[E+2]*C,I=b[E+3]*C,b[T++]=255+w*(-4.387332384609988*w+54.48615194189176*x+18.82290502165302*S+212.25662451639585*I-285.2331026137004)+x*(1.7149763477362134*x-5.6096736904047315*S-17.873870861415444*I-5.497006427196366)+S*(-2.5217340131683033*S-21.248923337353073*I+17.5119270841813)-I*(21.86122147463605*I+189.48180835922747),b[T++]=255+w*(8.841041422036149*w+60.118027045597366*x+6.871425592049007*S+31.159100130055922*I-79.2970844816548)+x*(-15.310361306967817*x+17.575251261109482*S+131.35250912493976*I-190.9453302588951)+S*(4.444339102852739*S+9.8632861493405*I-24.86741582555878)-I*(20.737325471181034*I+187.80453709719578),b[T++]=255+w*(.8842522430003296*w+8.078677503112928*x+30.89978309703729*S-.23883238689178934*I-14.183576799673286)+x*(10.49593273432072*x+63.02378494754052*S+50.606957656360734*I-112.23884253719248)+S*(.03296041114873217*S+115.60384449646641*I-193.58209356861505)-I*(22.33816807309886*I+180.12613974708367);return b},getData:function(b,w,x){if(this.numComponents>4)throw new t("Unsupported color mode");var S=this._getLinearizedBlockData(b,w);if(this.numComponents===1&&x){for(var I=S.length,T=new Uint8ClampedArray(3*I),C=0,E=0;E<I;E++){var $=S[E];T[C++]=$,T[C++]=$,T[C++]=$}return T}if(this.numComponents===3&&this._isColorConversionNeeded())return this._convertYccToRgb(S);if(this.numComponents===4){if(this._isColorConversionNeeded())return x?this._convertYcckToRgb(S):this._convertYcckToCmyk(S);if(x)return this._convertCmykToRgb(S)}return S}},u}()},(IY=SY())!==void 0&&(xY.exports=IY);const vfe=KU(Fz.exports);let X6e=class{static decode(e,i=!1){const r=new Uint8Array(e),n=new vfe;n.parse(r);const{width:s,height:o,numComponents:a,eof:l}=n,c=n.getData(s,o,!0),u=s*o;let h,f=null,m=0,g=0,y=0;if(!i&&l<r.length-1)try{const v=new RC(r.subarray(l)).getBytes();f=new Uint8Array(u);let b=0;for(m=0;m<v.length;m++)for(y=7;y>=0;y--)f[b++]=v[m]>>y&1}catch{}if(a===1&&c.length===s*o){const v=new Uint8Array(c.buffer);h=[v,v,v]}else{for(h=[],m=0;m<3;m++)h.push(new Uint8Array(u));for(y=0,g=0;g<u;g++)for(m=0;m<3;m++)h[m][g]=c[y++]}return{width:s,height:o,pixels:h,mask:f}}};const _fe=[{pixelType:"S8",size:1,ctor:Int8Array,range:[-128,127]},{pixelType:"U8",size:1,ctor:Uint8Array,range:[0,255]},{pixelType:"S16",size:2,ctor:Int16Array,range:[-32768,32767]},{pixelType:"U16",size:2,ctor:Uint16Array,range:[0,65536]},{pixelType:"S32",size:4,ctor:Int32Array,range:[-2147483648,2147483647]},{pixelType:"U32",size:4,ctor:Uint32Array,range:[0,4294967296]},{pixelType:"F32",size:4,ctor:Float32Array,range:[-34027999387901484e22,34027999387901484e22]},{pixelType:"F64",size:8,ctor:Float64Array,range:[-17976931348623157e292,17976931348623157e292]}];let P5=null;function bfe(){return P5||(P5=W(()=>import("./lerc-wasm-9e8daeb2.js"),[],import.meta.url).then(t=>t.l).then(({default:t})=>t({locateFile:e=>Tt(`esri/layers/support/rasterFormats/${e}`)})).then(t=>{eBe(t)}),P5)}const UP={getBlobInfo:null,decode:null};function Q6e(t){return 16+(t>>3<<3)}function nf(t,e,i){i.set(t.slice(e,e+i.length))}function eBe(t){const{_malloc:e,_free:i,_lerc_getBlobInfo:r,_lerc_getDataRanges:n,_lerc_decode_4D:s,asm:o}=t;let a;const l=Object.values(o).find(u=>u&&"buffer"in u&&u.buffer===t.HEAPU8.buffer),c=u=>{const h=u.map(y=>Q6e(y)),f=h.reduce((y,v)=>y+v),m=e(f);a=new Uint8Array(l.buffer);let g=h[0];h[0]=m;for(let y=1;y<h.length;y++){const v=h[y];h[y]=h[y-1]+g,g=v}return h};UP.getBlobInfo=u=>{const m=new Uint8Array(48),g=new Uint8Array(8*3),[y,v,b]=c([u.length,m.length,g.length]);a.set(u,y),a.set(m,v),a.set(g,b);let w=r(y,u.length,v,b,12,3);if(w)throw i(y),new Error(`lerc-getBlobInfo: error code is ${w}`);a=new Uint8Array(l.buffer),nf(a,v,m),nf(a,b,g);const x=new Uint32Array(m.buffer),S=new Float64Array(g.buffer),[I,T,,C,E,$,P,k,L,F,V]=x,z={version:I,depthCount:F,width:C,height:E,validPixelCount:P,bandCount:$,blobSize:k,maskCount:L,dataType:T,minValue:S[0],maxValue:S[1],maxZerror:S[2],statistics:[],bandCountWithNoData:V};if(V)return z;if(F===1&&$===1)return i(y),z.statistics.push({minValue:S[0],maxValue:S[1]}),z;const G=F*$*8,H=new Uint8Array(G),Z=new Uint8Array(G);let K=y,X=0,oe=0,se=!1;if(a.byteLength<y+2*G?(i(y),se=!0,[K,X,oe]=c([u.length,G,G]),a.set(u,K)):[X,oe]=c([G,G]),a.set(H,X),a.set(Z,oe),w=n(K,u.length,F,$,X,oe),w)throw i(K),se||i(X),new Error(`lerc-getDataRanges: error code is ${w}`);a=new Uint8Array(l.buffer),nf(a,X,H),nf(a,oe,Z);const le=new Float64Array(H.buffer),me=new Float64Array(Z.buffer),Se=z.statistics;for(let Ge=0;Ge<$;Ge++)if(F>1){const Be=le.slice(Ge*F,(Ge+1)*F),gt=me.slice(Ge*F,(Ge+1)*F),Pe=Math.min.apply(null,Be),De=Math.max.apply(null,gt);Se.push({minValue:Pe,maxValue:De,depthStats:{minValues:Be,maxValues:gt}})}else Se.push({minValue:le[Ge],maxValue:me[Ge]});return i(K),se||i(X),z},UP.decode=(u,h)=>{const{maskCount:f,depthCount:m,bandCount:g,width:y,height:v,dataType:b,bandCountWithNoData:w}=h,x=_fe[b],S=y*v,I=new Uint8Array(S*g),T=S*m*g*x.size,C=new Uint8Array(T),E=new Uint8Array(g),$=new Uint8Array(8*g),[P,k,L,F,V]=c([u.length,I.length,C.length,E.length,$.length]);a.set(u,P),a.set(I,k),a.set(C,L),a.set(E,F),a.set($,V);const z=s(P,u.length,f,k,m,y,v,g,b,L,F,V);if(z)throw i(P),new Error(`lerc-decode: error code is ${z}`);a=new Uint8Array(l.buffer),nf(a,L,C),nf(a,k,I);let G=null;if(w){nf(a,F,E),nf(a,V,$),G=[];const H=new Float64Array($.buffer);for(let Z=0;Z<E.length;Z++)G.push(E[Z]?H[Z]:null)}return i(P),{data:C,maskData:I,noDataValues:G}}}function tBe(t,e,i,r,n){if(i<2)return t;const s=new r(e*i);if(n)for(let o=0,a=0;o<e;o++)for(let l=0,c=o;l<i;l++,c+=e)s[c]=t[a++];else for(let o=0,a=0;o<e;o++)for(let l=0,c=o;l<i;l++,c+=e)s[a++]=t[c];return s}function wfe(t,e={}){const i=e.inputOffset??0,r=t instanceof Uint8Array?t.subarray(i):new Uint8Array(t,i),n=UP.getBlobInfo(r),{data:s,maskData:o,noDataValues:a}=UP.decode(r,n),{width:l,height:c,bandCount:u,depthCount:h,dataType:f,maskCount:m,statistics:g}=n,y=_fe[f],v=new y.ctor(s.buffer),b=[],w=[],x=l*c,S=x*h;for(let P=0;P<u;P++){const k=v.subarray(P*S,(P+1)*S);if(e.returnInterleaved)b.push(k);else{const L=tBe(k,x,h,y.ctor,!0);b.push(L)}w.push(o.subarray(P*S,(P+1)*S))}const I=m===0?null:m===1?w[0]:new Uint8Array(x);if(m>1){I.set(w[0]);for(let P=1;P<w.length;P++){const k=w[P];for(let L=0;L<x;L++)I[L]=I[L]&k[L]}}const{noDataValue:T}=e,C=T!=null&&y.range[0]<=T&&y.range[1]>=T;if(m>0&&C)for(let P=0;P<u;P++){const k=b[P],L=w[P]||I;for(let F=0;F<x;F++)L[F]===0&&(k[F]=T)}const E=m===u&&u>1?w:null,{pixelType:$}=y;return{width:l,height:c,bandCount:u,pixelType:$,depthCount:h,statistics:g,pixels:b,mask:I,bandMasks:E,noDataValues:a}}function iBe(t,e,i,r=!0){if(e%4!=0||i%4!=0){const n=new ArrayBuffer(4*Math.ceil(i/4)),s=new Uint8Array(n),o=new Uint8Array(t,e,i);if(r)for(let a=0;a<s.length;a+=4)s[a]=o[a+3],s[a+1]=o[a+2],s[a+2]=o[a+1],s[a+3]=o[a];else s.set(o);return new Uint32Array(s.buffer)}if(r){const n=new Uint8Array(t,e,i),s=new Uint8Array(n.length);for(let o=0;o<s.length;o+=4)s[o]=n[o+3],s[o+1]=n[o+2],s[o+2]=n[o+1],s[o+3]=n[o];return new Uint32Array(s.buffer)}return new Uint32Array(t,e,i/4)}function TY(){const t=[];for(let e=0;e<=257;e++)t[e]=[e];return t}function CY(t,e){for(let i=0;i<e.length;i++)t.push(e[i])}const Tb=new Set;function W9(t,e,i,r=!0){const n=iBe(t,e,i,r);let s=9,o=TY(),a=32,l=o.length,c=[],u=1,h=n[0],f=0;const m=n.length,g=8*(4*m-i),y=[];for(;h!=null;){if(a>=s)a-=s,f=h>>>32-s,h<<=s;else{f=h>>>32-a,h=n[u++];const b=s-a;a=32-b,f=(f<<b)+(h>>>a),h<<=b}if(f===257)break;if(f===256){s=9,o=TY(),l=o.length,c=[];continue}const v=o[f];if(v==null){if(f>o.length)throw new Error("data integrity issue: code does not exist on code page");c.push(c[0]),o[l++]=c.slice(),CY(y,c)}else CY(y,v),c.push(v[0]),c.length>1&&(o[l++]=c.slice()),c=v.slice();if(Tb.has(l)&&s++,a===0&&(h=n[u++],a=32),u>m||u===m&&a<=g)break}return new Uint8Array(y)}Tb.add(511),Tb.add(1023),Tb.add(2047),Tb.add(4095),Tb.add(8191);const EY=(t,e)=>{const i=e.width*e.height,r=e.pixelType;return Math.floor(t.byteLength/(i*xfe(r)))},xfe=t=>{let e=1;switch(t){case Uint8Array:case Int8Array:e=1;break;case Uint16Array:case Int16Array:e=2;break;case Uint32Array:case Int32Array:case Float32Array:e=4;break;case Float64Array:e=8}return e},rBe=(t,e)=>{if(8*t.byteLength<e)return null;const i=new Uint8Array(t,0,Math.ceil(e/8)),r=new Uint8Array(e);let n=0,s=0,o=0,a=0;for(o=0;o<i.length-1;o++)for(s=i[o],a=7;a>=0;a--)r[n++]=s>>a&1;for(a=7;n<e-1;)s=i[i.length-1],r[n++]=s>>a&1,a--;return r};let nBe=class{static decode(e,i){const r=i.pixelType,n=[],s=i.width*i.height,o=EY(e,i),{bandIds:a,format:l}=i,c=a&&a.length||EY(e,i),u=e.byteLength-e.byteLength%(s*xfe(r)),h=new r(e,0,s*o);let f,m,g,y,v=null;if(l==="bip")for(f=0;f<c;f++){for(g=new r(s),y=a?a[f]:f,m=0;m<s;m++)g[m]=h[m*o+y];n.push(g)}else if(l==="bsq")for(f=0;f<c;f++)y=a?a[f]:f,n.push(h.subarray(y*s,(y+1)*s));return u<e.byteLength-1&&(v=rBe(e.slice(u),s)),{pixels:n,mask:v}}};function Dz(t,e){let i=0,r="",n=0,s=0;const o=t.length;for(;i<o;)s=t[i++],n=s>>4,n<8?n=1:n===15?(n=4,s=(7&s)<<18|(63&t[i++])<<12|(63&t[i++])<<6|63&t[i++]):n===14?(n=3,s=(15&s)<<12|(63&t[i++])<<6|63&t[i++]):(n=2,s=(31&s)<<6|63&t[i++]),(s!==0||e)&&(r+=String.fromCharCode(s));return r}const J9=(()=>{const t=[];return t[254]="NEWSUBFILETYPE",t[255]="SUBFILETYPE",t[256]="IMAGEWIDTH",t[257]="IMAGELENGTH",t[258]="BITSPERSAMPLE",t[259]="COMPRESSION",t[262]="PHOTOMETRICINTERPRETATION",t[263]="THRESHHOLDING",t[264]="CELLWIDTH",t[265]="CELLLENGTH",t[266]="FILLORDER",t[269]="DOCUMENTNAME",t[270]="IMAGEDESCRIPTION",t[271]="MAKE",t[272]="MODEL",t[273]="STRIPOFFSETS",t[274]="ORIENTATION",t[277]="SAMPLESPERPIXEL",t[278]="ROWSPERSTRIP",t[279]="STRIPBYTECOUNTS",t[280]="MINSAMPLEVALUE",t[281]="MAXSAMPLEVALUE",t[282]="XRESOLUTION",t[283]="YRESOLUTION",t[284]="PLANARCONFIGURATION",t[285]="PAGENAME",t[286]="XPOSITION",t[287]="YPOSITION",t[288]="FREEOFFSETS",t[289]="FREEBYTECOUNTS",t[290]="GRAYRESPONSEUNIT",t[291]="GRAYRESPONSECURVE",t[292]="T4OPTIONS",t[293]="T6OPTIONS",t[296]="RESOLUTIONUNIT",t[297]="PAGENUMBER",t[300]="COLORRESPONSEUNIT",t[301]="TRANSFERFUNCTION",t[305]="SOFTWARE",t[306]="DATETIME",t[315]="ARTIST",t[316]="HOSTCOMPUTER",t[317]="PREDICTOR",t[318]="WHITEPOINT",t[319]="PRIMARYCHROMATICITIES",t[320]="COLORMAP",t[321]="HALFTONEHINTS",t[322]="TILEWIDTH",t[323]="TILELENGTH",t[324]="TILEOFFSETS",t[325]="TILEBYTECOUNTS",t[326]="BADFAXLINES",t[327]="CLEANFAXDATA",t[328]="CONSECUTIVEBADFAXLINES",t[330]="SUBIFD",t[332]="INKSET",t[333]="INKNAMES",t[334]="NUMBEROFINKS",t[336]="DOTRANGE",t[337]="TARGETPRINTER",t[338]="EXTRASAMPLES",t[339]="SAMPLEFORMAT",t[340]="SMINSAMPLEVALUE",t[341]="SMAXSAMPLEVALUE",t[342]="TRANSFERRANGE",t[347]="JPEGTABLES",t[512]="JPEGPROC",t[513]="JPEGIFOFFSET",t[514]="JPEGIFBYTECOUNT",t[515]="JPEGRESTARTINTERVAL",t[517]="JPEGLOSSLESSPREDICTORS",t[518]="JPEGPOINTTRANSFORM",t[519]="JPEGQTABLES",t[520]="JPEGDCTABLES",t[521]="JPEGACTABLES",t[529]="YCBCRCOEFFICIENTS",t[530]="YCBCRSUBSAMPLING",t[531]="YCBCRPOSITIONING",t[532]="REFERENCEBLACKWHITE",t[700]="XMP",t[33550]="GEOPIXELSCALE",t[33922]="GEOTIEPOINTS",t[33432]="COPYRIGHT",t[42112]="GDAL_METADATA",t[42113]="GDAL_NODATA",t[50844]="RPCCOEFFICIENT",t[34264]="GEOTRANSMATRIX",t[34735]="GEOKEYDIRECTORY",t[34736]="GEODOUBLEPARAMS",t[34737]="GEOASCIIPARAMS",t[34665]="EXIFIFD",t[34853]="GPSIFD",t[40965]="INTEROPERABILITYIFD",t})(),sBe=(()=>{const t=J9.slice();return t[36864]="ExifVersion",t[40960]="FlashpixVersion",t[40961]="ColorSpace",t[42240]="Gamma",t[37121]="ComponentsConfiguration",t[37122]="CompressedBitsPerPixel",t[40962]="PixelXDimension",t[40963]="PixelYDimension",t[37500]="MakerNote",t[37510]="UserComment",t[40964]="RelatedSoundFile",t[36867]="DateTimeOriginal",t[36868]="DateTimeDigitized",t[36880]="OffsetTime",t[36881]="OffsetTimeOriginal",t[36882]="OffsetTimeDigitized",t[37520]="SubSecTime",t[37521]="SubSecTimeOriginal",t[37522]="SubSecTimeDigitized",t[37888]="Temperature",t[37889]="Humidity",t[37890]="Pressure",t[37891]="WaterDepth",t[37892]="Acceleration",t[37893]="CameraElevationAngle",t[42016]="ImageUniqueID",t[42032]="CameraOwnerName",t[42033]="BodySerialNumber",t[42034]="LensSpecification",t[42035]="LensMake",t[42036]="LensModel",t[42037]="LensSerialNumber",t[33434]="ExposureTime",t[33437]="FNumber",t[34850]="ExposureProgram",t[34852]="SpectralSensitivity",t[34855]="PhotographicSensitivity",t[34856]="OECF",t[34864]="SensitivityType",t[34865]="StandardOutputSensitivity",t[34866]="RecommendedExposureIndex",t[34867]="ISOSpeed",t[34868]="ISOSpeedLatitudeyyy",t[34869]="ISOSpeedLatitudezzz",t[37377]="ShutterSpeedValue",t[37378]="ApertureValue",t[37379]="BrightnessValue",t[37380]="ExposureBiasValue",t[37381]="MaxApertureValue",t[37382]="SubjectDistance",t[37383]="MeteringMode",t[37384]="LightSource",t[37385]="Flash",t[37386]="FocalLength",t[37396]="SubjectArea",t[41483]="FlashEnergy",t[41484]="SpatialFrequencyResponse",t[41486]="FocalPlaneXResolution",t[41487]="FocalPlaneYResolution",t[41488]="FocalPlaneResolutionUnit",t[41492]="SubjectLocation",t[41493]="ExposureIndex",t[41495]="SensingMethod",t[41728]="FileSource",t[41729]="SceneType",t[41730]="CFAPattern",t[41985]="CustomRendered",t[41986]="ExposureMode",t[41987]="WhiteBalance",t[41988]="DigitalZoomRatio",t[41989]="FocalLengthIn35mmFilm",t[41990]="SceneCaptureType",t[41991]="GainControl",t[41992]="Contrast",t[41993]="Saturation",t[41994]="Sharpness",t[41995]="DeviceSettingDescription",t[41996]="SubjectDistanceRange",t})(),oBe=["GPSVersionID","GPSLatitudeRef","GPSLatitude","GPSLongitudeRef","GPSLongitude","GPSAltitudeRef","GPSAltitude","GPSTimeStamp","GPSSatellites","GPSStatus","GPSMeasureMode","GPSDOP","GPSSpeedRef","GPSSpeed","GPSTrackRef","GPSTrack","GPSImgDirectionRef","GPSImgDirection","GPSMapDatum","GPSDestLatitudeRef","GPSDestLatitude","GPSDestLongitudeRef","GPSDestLongitude","GPSDestBearingRef","GPSDestBearing","GPSDestDistanceRef","GPSDestDistance","GPSProcessingMethod","GPSAreaInformation","GPSDateStamp","GPSDifferential","GPSHPositioningError"],aBe=(()=>{const t=[];return t[1024]="GTModelTypeGeoKey",t[1025]="GTRasterTypeGeoKey",t[1026]="GTCitationGeoKey",t[2048]="GeographicTypeGeoKey",t[2049]="GeogCitationGeoKey",t[2050]="GeogGeodeticDatumGeoKey",t[2051]="GeogPrimeMeridianGeoKey",t[2052]="GeogLinearUnitsGeoKey",t[2053]="GeogLinearUnitSizeGeoKey",t[2054]="GeogAngularUnitsGeoKey",t[2055]="GeogAngularUnitSizeGeoKey",t[2056]="GeogEllipsoidGeoKey",t[2057]="GeogSemiMajorAxisGeoKey",t[2058]="GeogSemiMinorAxisGeoKey",t[2059]="GeogInvFlatteningGeoKey",t[2061]="GeogPrimeMeridianLongGeoKey",t[2060]="GeogAzimuthUnitsGeoKey",t[3072]="ProjectedCSTypeGeoKey",t[3073]="PCSCitationGeoKey",t[3074]="ProjectionGeoKey",t[3075]="ProjCoordTransGeoKey",t[3076]="ProjLinearUnitsGeoKey",t[3077]="ProjLinearUnitSizeGeoKey",t[3078]="ProjStdParallel1GeoKey",t[3079]="ProjStdParallel2GeoKey",t[3080]="ProjNatOriginLongGeoKey",t[3081]="ProjNatOriginLatGeoKey",t[3082]="ProjFalseEastingGeoKey",t[3083]="ProjFalseNorthingGeoKey",t[3084]="ProjFalseOriginLongGeoKey",t[3085]="ProjFalseOriginLatGeoKey",t[3086]="ProjFalseOriginEastingGeoKey",t[3087]="ProjFalseOriginNorthingGeoKey",t[3088]="ProjCenterLongGeoKey",t[3090]="ProjCenterEastingGeoKey",t[3091]="ProjCenterNorthingGeoKey",t[3092]="ProjScaleAtNatOriginGeoKey",t[3093]="ProjScaleAtCenterGeoKey",t[3094]="ProjAzimuthAngleGeoKey",t[3095]="ProjStraightVertPoleLongGeoKey",t[4096]="VerticalCSTypeGeoKey",t[4097]="VerticalCitationGeoKey",t[4098]="VerticalDatumGeoKey",t[4099]="VerticalUnitsGeoKey",t})(),lBe=(t,e)=>{let i=(e||J9)[t];return i===void 0&&(i="unknown"+String(t)),i},Nz=new Map;Nz.set("EXIFIFD",sBe),Nz.set("GPSIFD",oBe);const Md={TIFF_TAGS:J9,ifdTags:Nz,GEO_KEYS:aBe,getTagName:lBe},XL=(()=>{const t=new ArrayBuffer(4),e=new Uint8Array(t);return new Uint32Array(t)[0]=1,e[0]===1})(),MY=[0,1,1,2,4,8,1,1,2,4,8,4,8,-1,-1,-1,8,8,8],m1=4294967296,cBe=new Set([1,5,6,7,8,34712,34887]);function Z9(t,e){let i="unknown";return t===3?i=e===64?"f64":"f32":t===1?e===1?i="u1":e===2?i="u2":e===4?i="u4":e<=8?i="u8":e<=16?i="u16":e<=32&&(i="u32"):t===2&&(e<=8?i="s8":e<=16?i="s16":e<=32&&(i="s32")),i}function QL(t){let e=null;switch(t?t.toLowerCase():"f32"){case"u1":case"u2":case"u4":case"u8":e=Uint8Array;break;case"u16":e=Uint16Array;break;case"u32":e=Uint32Array;break;case"s8":e=Int8Array;break;case"s16":e=Int16Array;break;case"s32":e=Int32Array;break;case"f64":e=Float64Array;break;default:e=Float32Array}return e}function uBe(t,e){return{x:e[0]*t.x+e[1]*t.y+e[2],y:e[3]*t.x+e[4]*t.y+e[5]}}function Sfe(t,e){var i;return(i=t.get(e))==null?void 0:i.values}function dv(t,e){var i;return(i=t.get(e))==null?void 0:i.values}function $Y(t,e){var i,r;return(r=(i=t.get(e))==null?void 0:i.values)==null?void 0:r[0]}function st(t,e){var i,r;return(r=(i=t.get(e))==null?void 0:i.values)==null?void 0:r[0]}function O5(t,e,i,r=0,n=Md.TIFF_TAGS,s=4){const o=s===8,a=o?X9(new DataView(t,i,8),0,e):new DataView(t,i,2).getUint16(0,e),l=4+2*s,c=o?8:2,u=c+a*l;if(i+u>t.byteLength)return{success:!1,ifd:null,nextIFD:null,requiredBufferSize:u};const h=i+u+4<=t.byteLength?MA(new DataView(t,i+u,s===8?8:4),0,e,s===8):null,f=i+c,m=new Map;let g,y,v,b,w,x=0,S=0;for(let I=0;I<a;I++){y=new DataView(t,f+l*I,l),v=y.getUint16(0,e),w=y.getUint16(2,e),b=Md.getTagName(v,n);const T=[];s===2?(x=y.getUint16(4,e),S=y.getUint16(6,e)):s===4?(x=y.getUint32(4,e),S=y.getUint32(8,e)):s===8&&(x=MA(y,4,e,!0),S=MA(y,12,e,!0),T.push(y.getUint32(12,e)),T.push(y.getUint32(16,e))),g={id:v,type:w,valueCount:x,valueOffset:S,valueOffsets:T,values:null},Ife(t,e,g,r,!1,s),m.set(b,g)}return{success:!0,ifd:m,nextIFD:h,requiredBufferSize:u}}const dBe=(t,e)=>wfe(t,{inputOffset:e}).pixels[0];function Vz(t,e){if(e!==1&&e!==2&&e!==4)return t;const i=new Uint8Array(t),r=8/e,n=new Uint8Array(t.byteLength*r);let s=0;const o=2**e-1;for(let a=0;a<i.length;a++){const l=i[a];for(let c=0;c<r;c++)n[s++]=l<<e*c>>>8-e&o}return n.buffer}function zz(t,e,i){const r=new vfe;r.parse(t),r.colorTransform=i===6?-1:0;const n=r.getData(r.width,r.height,e!==1);return new Uint8Array(n.buffer)}function jz(t){const e=new RC(t).getBytes(),i=new ArrayBuffer(e.length),r=new Uint8Array(i);return r.set(e),r}async function Bz(t,e,i,r,n){const s=XL===e,o=st(i,"BITSPERSAMPLE"),a=st(i,"SAMPLESPERPIXEL")??1,l=st(i,"PHOTOMETRICINTERPRETATION"),c=st(i,"SAMPLEFORMAT")??1,u=Z9(c,o),h=st(i,"COMPRESSION")??1,f=QL(u);let m,g,y;if(h===34887)return await bfe(),dBe(t,r);if(h===1)m=t.slice(r,r+n),g=new Uint8Array(m);else if(h===8||h===32946)g=new Uint8Array(t,r,n),g=jz(g),m=g.buffer;else if(h===6)g=new Uint8Array(t,r,n),g=zz(g,a,l),m=g.buffer;else if(h===7){const x=i.get("JPEGTABLES").values,S=x.length-2;g=new Uint8Array(S+n-2);for(let T=0;T<S;T++)g[T]=x[T];const I=new Uint8Array(t,r+2,n-2);for(let T=0;T<I.length;T++)g[S+T]=I[T];g=zz(g,a,l),m=g.buffer}else{if(h!==5)throw new Error("tiff-decode: unsupport compression "+h);g=W9(t,r,n,e),m=g.buffer}if(m=Vz(m,o),u==="u8"||u==="s8"||s)y=new f(m);else{m=new ArrayBuffer(g.length);const x=new Uint8Array(m);switch(u){case"u16":case"s16":for(let S=0;S<g.length;S+=2)x[S]=g[S+1],x[S+1]=g[S];break;case"u32":case"s32":case"f32":for(let S=0;S<g.length;S+=4)x[S]=g[S+3],x[S+1]=g[S+2],x[S+2]=g[S+1],x[S+3]=g[S]}y=new f(m)}const v=st(i,"PREDICTOR")??1,b=st(i,"TILEWIDTH"),w=st(i,"TILELENGTH");if(v>1&&(h===5||h===8||h===32946)&&b&&w){const x=FC(i),S=new f(y.length);S.set(y),y=vBe(S,w,b,c===3&&v===3,x?1:a)}return y}async function hBe(t,e,i){const r=dv(i,"TILEOFFSETS");if(r===void 0)return null;const n=dv(i,"TILEBYTECOUNTS"),{width:s,height:o,pixelType:a,tileWidth:l,tileHeight:c}=eR([i]),u=FC(i,e),h=st(i,"SAMPLESPERPIXEL")||e.planes,f=s*o,m=st(i,"BITSPERSAMPLE"),g=(st(i,"COMPRESSION")??1)===34887,y=QL(a),v=[];for(let z=0;z<h;z++)v.push(new y(f));let b,w,x,S,I,T,C,E,$,P,k,L,F;const V=Math.ceil(s/l);if(m%8==0){if(g&&u&&h>1){const z=Math.round(r.length/h);for(b=0;b<z;b++){T=Math.floor(b/V)*c,C=b%V*l,E=T*s+C;for(let G=0;G<h;G++){const H=b*h+G;if(n[H]!==0)for(x=await Bz(t,e.littleEndian,i,r[H],n[H]),P=0,$=E,L=Math.min(l,s-C),k=Math.min(c,o-T),F=v[G],S=0;S<k;S++)for($=E+S*s,P=S*l,I=0;I<L;I++,$++,P++)F[$]=x[P]}}}else for(b=0;b<r.length;b++)if(n[b]!==0)for(T=Math.floor(b/V)*c,C=b%V*l,E=T*s+C,x=await Bz(t,e.littleEndian,i,r[b],n[b]),P=0,$=E,L=Math.min(l,s-C),k=Math.min(c,o-T),w=0;w<h;w++)if(F=v[w],u||g)for(S=0;S<k;S++)for($=E+S*s,P=l*c*w+S*l,I=0;I<L;I++,$++,P++)F[$]=x[P];else for(S=0;S<k;S++)for($=E+S*s,P=S*l*h+w,I=0;I<L;I++,$++,P+=h)F[$]=x[P]}return{width:s,height:o,pixelType:a,pixels:v}}const pBe=(t,e,i)=>{const r=XL===e.littleEndian,n=dv(i,"STRIPOFFSETS");if(n===void 0)return null;const{width:s,height:o,pixelType:a}=eR([i]),l=st(i,"SAMPLESPERPIXEL")||e.planes,c=st(i,"PHOTOMETRICINTERPRETATION"),u=s*o,h=st(i,"BITSPERSAMPLE"),f=QL(a),m=new f(u*l),g=dv(i,"STRIPBYTECOUNTS"),y=st(i,"ROWSPERSTRIP"),v=st(i,"COMPRESSION")??1;let b,w,x,S,I,T,C,E,$,P=y;if(h%8==0)for(b=0;b<n.length;b++){if(I=b*(y*s)*l,P=(b+1)*y>o?o-b*y:y,a==="u8"||a==="s8"||r)v===8||v===32946?(C=new Uint8Array(t,n[b],g[b]),C=jz(C),T=C.buffer):v===6?(C=new Uint8Array(t,n[b],g[b]),C=zz(C,l,c),T=C.buffer):v===5?(C=W9(t,n[b],g[b],e.littleEndian),T=C.buffer):(g[b]!==P*s*l*h/8&&console.log("strip byte counts is different than expected"),T=t.slice(n[b],n[b]+g[b])),T=Vz(T,h),S=new f(T);else{switch(v===6||v===8||v===32946?(C=new Uint8Array(t,n[b],g[b]),E=jz(C),T=E.buffer):(g[b]!==P*s*l*h/8&&console.log("strip byte counts is different than expected"),T=new ArrayBuffer(g[b]),C=new Uint8Array(t,n[b],g[b]),E=new Uint8Array(T)),a){case"u16":case"s16":for(x=0;x<C.length;x+=2)E[x]=C[x+1],E[x+1]=C[x];break;case"u32":case"s32":case"f32":for(x=0;x<C.length;x+=4)E[x]=C[x+3],E[x+1]=C[x+2],E[x+2]=C[x+1],E[x+3]=C[x]}T=Vz(T,h),S=new f(T)}m.set(S,I)}const k=[];if(l===1)k.push(m);else for(b=0;b<l;b++){for($=new f(u),w=0;w<u;w++)$[w]=m[w*l+b];k.push($)}return{width:s,height:o,pixelType:a,pixels:k}},fBe=(t,e,i)=>{if(!(t&&t.length>0&&e&&i))return null;let r,n,s;const o=t[0].length,a=t.length,l=new Uint8Array(o);for(let c=0;c<a;c++)if(r=t[c],n=e[c],s=i[c],c===0)for(let u=0;u<o;u++)l[u]=r[u]<n||r[u]>s?0:1;else for(let u=0;u<o;u++)l[u]&&(l[u]=r[u]<n||r[u]>s?0:1);return l},mBe=t=>{if(!t)return null;const e=t.match(/<Item(.*?)Item>/gi);if(!e||e.length===0)return null;const i=new Map;let r,n,s,o,a;for(let b=0;b<e.length;b++)r=e[b],n=r.slice(6,r.indexOf(">")),o=r.indexOf("sample="),o>-1&&(a=r.slice(o+8,r.indexOf('"',o+8))),o=r.indexOf("name="),o>-1&&(n=r.slice(o+6,r.indexOf('"',o+6))),n&&(s=r.slice(r.indexOf(">")+1,r.indexOf("</Item>")).trim(),a!=null?i.has(n)?i.get(n)[a]=s:i.set(n,[s]):i.set(n,s)),a=null;const l=i.get("STATISTICS_MINIMUM"),c=i.get("STATISTICS_MAXIMUM"),u=i.get("STATISTICS_MEAN"),h=i.get("STATISTICS_STDDEV");let f=null;if(l&&c){f=[];for(let b=0;b<l.length;b++)f.push({min:parseFloat(l[b]),max:parseFloat(c[b]),avg:u&&parseFloat(u[b]),stddev:h&&parseFloat(h[b])})}const m=i.get("BandName"),g=i.get("WavelengthMin"),y=i.get("WavelengthMax");let v=null;if(m){v=[];for(let b=0;b<m.length;b++)v.push({BandName:m[b],WavelengthMin:g&&parseFloat(g[b]),WavelengthMax:y&&parseFloat(y[b])})}return{statistics:f,bandProperties:v,dataType:i.get("DataType"),rawMetadata:i}};function Ife(t,e,i,r=0,n=!1,s=4){if(i.values)return!0;const o=i.type,a=i.valueCount;let l=i.valueOffset,c=[];const u=MY[o],h=8*u,f=a*u,m=a*MY[o]*8;let g,y;const v=s===8?64:32,b=i.valueOffsets;if(m>v&&f>(n?t.byteLength:t?t.byteLength-l+r:0))return i.offlineOffsetSize=[l,f],i.values=null,!1;if(m<=v){if(!e)if(v<=32)l>>>=32-m;else{const w=b!=null&&b.length?b[0]:l>>>0,x=b!=null&&b.length?b[1]:Math.round((l-w)/m1);m<=32?(l=w>>>32-m,b[0]=l):(l=w*2**(32-m)+(x>>>32-m),b[0]=w,b[1]=x>>>32-m)}if(a===1&&h===v)c=[l];else if(v===64){const w=b!=null&&b.length?b[0]:l>>>0,x=b!=null&&b.length?b[1]:Math.round((l-w)/m1);let S=w,I=32;for(y=1;y<=a;y++){const T=32-h*y%32;if(I<h){const C=S<<T>>>32-I,E=x<<32-I>>>32-I;S=x,c.push(C+E*2**(h-I)),I-=32-(h-I)}else c.push(S<<T>>>32-h),I-=h;I===0&&(I=32,S=x)}}else for(y=1;y<=a;y++){const w=32-h*y;c.push(l<<w>>>32-h)}}else{l-=r,n&&(l=0);for(let w=l;w<l+f;w+=u){switch(o){case 1:case 2:case 7:g=new DataView(t,w,1).getUint8(0);break;case 3:g=new DataView(t,w,2).getUint16(0,e);break;case 4:case 13:g=new DataView(t,w,4).getUint32(0,e);break;case 5:g=new DataView(t,w,4).getUint32(0,e)/new DataView(t,w+4,4).getUint32(0,e);break;case 6:g=new DataView(t,w,1).getInt8(0);break;case 8:g=new DataView(t,w,2).getInt16(0,e);break;case 9:g=new DataView(t,w,4).getInt32(0,e);break;case 10:g=new DataView(t,w,4).getInt32(0,e)/new DataView(t,w+4,4).getInt32(0,e);break;case 11:g=new DataView(t,w,4).getFloat32(0,e);break;case 12:g=new DataView(t,w,8).getFloat64(0,e);break;case 16:case 18:g=X9(new DataView(t,w,8),0,e);break;case 17:g=yBe(new DataView(t,w,8),0,e);break;default:g=null}c.push(g)}}if(o===2){let w="";const x=c;for(c=[],y=0;y<x.length;y++)x[y]===0&&w!==""?(c.push(w),w=""):w+=String.fromCharCode(x[y]);w===""&&c.length!==0||c.push(w)}return i.values=c,!0}function eR(t){const e=t[0],i=st(e,"TILEWIDTH"),r=st(e,"TILELENGTH"),n=st(e,"IMAGEWIDTH"),s=st(e,"IMAGELENGTH"),o=st(e,"BITSPERSAMPLE"),a=st(e,"SAMPLESPERPIXEL"),l=st(e,"SAMPLEFORMAT")??1,c=Z9(l,o),u=FC(e),h=Sfe(e,"GDAL_NODATA");let f=null;h!=null&&h.length&&(f=h.map(K=>parseFloat(K)),f.some(K=>isNaN(K))&&(f=null));const m=st(e,"COMPRESSION")??1;let g;switch(m){case 1:g="NONE";break;case 2:case 3:case 4:case 32771:g="CCITT";break;case 5:g="LZW";break;case 6:case 7:g="JPEG";break;case 32773:g="PACKBITS";break;case 8:case 32946:g="DEFLATE";break;case 34712:g="JPEG2000";break;case 34887:g="LERC";break;default:g=String(m)}let y=!0,v="";cBe.has(m)||(y=!1,v+="unsupported tag compression "+m),l>3&&(y=!1,v+="unsupported tag sampleFormat "+l),o!==1&&o!==2&&o!==4&&o%8!=0&&(y=!1,v+="unsupported tag bitsPerSample "+o);const b=$Y(e,"GEOASCIIPARAMS");let w;if(b){const K=b.split("|").find(oe=>oe.includes("ESRI PE String = ")),X=K?K.replace("ESRI PE String = ",""):"";w=X.startsWith("COMPD_CS")||X.startsWith("PROJCS")||X.startsWith("GEOGCS")?{wkid:null,wkt:X}:null}const x=dv(e,"GEOTIEPOINTS"),S=dv(e,"GEOPIXELSCALE"),I=dv(e,"GEOTRANSMATRIX"),T=e.has("GEOKEYDIRECTORY")?e.get("GEOKEYDIRECTORY").data:null;let C,E,$=!1,P=!1;if(T){$=st(T,"GTRasterTypeGeoKey")===2;const K=st(T,"GTModelTypeGeoKey");if(K===2){const X=st(T,"GeographicTypeGeoKey");X>=1024&&X<=32766&&(w={wkid:X}),w||X!==32767||(P=!0,w={wkid:4326})}else if(K===1){const X=st(T,"ProjectedCSTypeGeoKey");X>=1024&&X<=32766&&(w={wkid:X})}}if(S&&x&&x.length>=6?(C=[S[0],0,x[3]-x[0]*S[0],0,-Math.abs(S[1]),x[4]-x[1]*S[1]],$&&(C[2]-=.5*C[0]+.5*C[1],C[5]-=.5*C[3]+.5*C[4])):I&&I.length===16&&(C=$?[I[0],I[1],I[3]-.5*I[0],I[4],I[5],I[7]-.5*I[5]]:[I[0],I[1],I[3],I[4],I[5],I[7]]),C){const K=[{x:0,y:s},{x:0,y:0},{x:n,y:s},{x:n,y:0}];let X,oe=Number.POSITIVE_INFINITY,se=Number.POSITIVE_INFINITY,le=Number.NEGATIVE_INFINITY,me=Number.NEGATIVE_INFINITY;for(let Se=0;Se<K.length;Se++)X=uBe(K[Se],C),oe=X.x>oe?oe:X.x,le=X.x<le?le:X.x,se=X.y>se?se:X.y,me=X.y<me?me:X.y;E={xmin:oe,xmax:le,ymin:se,ymax:me,spatialReference:w}}else E={xmin:-.5,ymin:.5-s,xmax:n-.5,ymax:.5,spatialReference:w};P&&(E.xmax-E.xmin>400||Math.max(Math.abs(E.xmin),Math.abs(E.xmax))>361)&&(w=null,E.spatialReference=null);const k=Y9(t);let L,F,V,z,G;if(k.length>0){V=Math.round(Math.log(n/st(k[0],"IMAGEWIDTH"))/Math.LN2);const K=k[k.length-1];z=Math.round(Math.log(n/st(K,"IMAGEWIDTH"))/Math.LN2),L=st(K,"TILEWIDTH"),F=st(K,"TILELENGTH")}L=z!=null&&z>0?L||i:null,F=z!=null&&z>0?F||r:null,i&&(G=[{maxCol:Math.ceil(n/i)-1,maxRow:Math.ceil(s/r)-1,minRow:0,minCol:0}],k.forEach(K=>{G.push({maxCol:Math.ceil(st(K,"IMAGEWIDTH")/st(K,"TILEWIDTH"))-1,maxRow:Math.ceil(st(K,"IMAGELENGTH")/st(K,"TILELENGTH"))-1,minRow:0,minCol:0})}));const H=$Y(t[0],"GDAL_METADATA"),Z=mBe(H);return v+=" "+Efe({width:n,height:s,tileWidth:i,tileHeight:r,planes:a,ifds:t}),{width:n,height:s,tileWidth:i,tileHeight:r,planes:a,isBSQ:u,pixelType:c,compression:g,noData:f,hasMaskBand:K9(t).length===k.length+1,isSupported:y,message:v,extent:E,isPseudoGeographic:P,affine:S?null:C,firstPyramidLevel:V,maximumPyramidLevel:z,pyramidBlockWidth:L,pyramidBlockHeight:F,tileBoundary:G,metadata:Z}}function FC(t,e){const i=Sfe(t,"PLANARCONFIGURATION");return i?i[0]===2:!!e&&e.isBSQ}function Y9(t){return t.filter(e=>st(e,"NEWSUBFILETYPE")===1)}function K9(t){return t.filter(e=>{const i=(4&(st(e,"NEWSUBFILETYPE")??0))==4,r=st(e,"PHOTOMETRICINTERPRETATION")===4;return i&&r})}function gBe(t){const{littleEndian:e,isBigTiff:i,firstIFDPos:r}=Tfe(t);let n=r;const s=[];do{const o=Cfe(t,e,n,0,Md.TIFF_TAGS,i?8:4);if(!o.success)break;s.push(o.ifd),n=o.nextIFD}while(n>0);return{...eR(s),littleEndian:e,isBigTiff:i,ifds:s,pyramidIFDs:Y9(s),maskIFDs:K9(s)}}function X9(t,e,i){const r=t.getUint32(e,i),n=t.getUint32(e+4,i);return i?n*m1+r:r*m1+n}function yBe(t,e,i){let r=i?t.getInt32(e,i):t.getUint32(e,i),n=i?t.getUint32(e+4,i):t.getInt32(e+4,i);const s=(i?r:n)>=0?1:-1;return i?r*=s:n*=s,s*(i?n*m1+r:r*m1+n)}function MA(t,e,i,r){return r?X9(t,e,i):t.getUint32(e,i)}function Tfe(t){const e=new DataView(t,0,16),i=e.getUint16(0,!1);let r=null;if(i===18761)r=!0;else{if(i!==19789)throw new Error("unexpected endianess byte");r=!1}const n=e.getUint16(2,r);if(n!==42&&n!==43)throw new Error("unexpected tiff identifier");let s=4;const o=n===43;if(o){const a=e.getUint16(s,r);if(s+=2,a!==8)throw new Error("unsupported bigtiff version");if(e.getUint16(s,r)!==0)throw new Error("unsupported bigtiff version");s+=2}return{littleEndian:r,isBigTiff:o,firstIFDPos:MA(e,s,r,o)}}function Cfe(t,e,i,r=0,n=Md.TIFF_TAGS,s=4){const o=O5(t,e,i,r,n,s);let a;const l=o.ifd;if(l){if(Md.ifdTags.forEach((c,u)=>{l.has(u)&&(a=l.get(u),a.data=O5(t,e,a.valueOffset-r,r,c).ifd)}),l.has("GEOKEYDIRECTORY")){a=l.get("GEOKEYDIRECTORY");const c=a.values;if(c&&c.length>4){const u=c[0]+"."+c[1]+"."+c[2];a.data=O5(t,e,a.valueOffset+6-r,r,Md.GEO_KEYS,2).ifd,a.data&&a.data.set("GEOTIFFVersion",{id:0,type:2,valueCount:1,valueOffset:null,values:[u]})}}if(l.has("XMP")){a=l.get("XMP");const c=a.values;typeof c[0]=="number"&&a.type===7&&(a.values=[Dz(new Uint8Array(c))])}}return o}function Efe(t){const{width:e,height:i,tileHeight:r,tileWidth:n}=t,s=t.planes,o=n?n*r:e*i,a=st(t.ifds[0],"BITSPERSAMPLE");let l="";return o*s>2**30/(a>8?a/8:1)&&(l=n?"tiled tiff exceeding 1 gigabits per tile is not supported":"scanline tiff exceeding 1 gigabits is not supported"),l}function vBe(t,e,i,r,n){const s=r?4:1,o=i*s*n;r&&(t=new Uint8Array(t.buffer));for(let c=0;c<e;c++){const u=c*o;for(let h=n;h<o;h++)t[u+h]+=t[u+h-n]}if(!r)return t;const a=new Uint8Array(t.length),l=i*n;for(let c=0;c<e;c++){const u=c*o;for(let h=0;h<l;h++)for(let f=0;f<s;f++)a[u+h*s+f]=t[u+h+(s-f-1)*l]}return new Float32Array(a.buffer)}async function _Be(t,e){const{headerInfo:i,ifd:r,offsets:n,sizes:s}=e,o=[];for(let $=0;$<n.length;$++){const P=await Bz(t,i.littleEndian,r,n[$],s[$]||t.byteLength);o.push(P)}const a=FC(r,i),l=st(r,"BITSPERSAMPLE"),c=Z9(st(r,"SAMPLEFORMAT")??1,l),u=st(r,"SAMPLESPERPIXEL")||i.planes,h=QL(c),f=st(r,"TILEWIDTH"),m=st(r,"TILELENGTH"),g=st(r,"COMPRESSION")??1,y=f*m;let v;const b=[];let w=o[0];const x=g===34887;for(let $=0;$<u;$++){if(v=new h(y),o.length===u)w=o[$],w.length===y&&(v=w);else if(w.length)if(a||x)v=w.length===y?w:w.slice(y*$,y*($+1));else for(let P=0;P<y;P++)v[P]=w[P*u+$];b.push(v)}const S=i.noData?i.noData[0]:e.noDataValue,I=i.metadata?i.metadata.statistics:null,T=I?I.map($=>$.min):null,C=I?I.map($=>$.max):null,E={pixelType:c,width:f,height:m,pixels:b,noDataValue:S};return S!=null?ZL(E,S):T&&C&&e.applyMinMaxConstraint&&(E.mask=fBe(b,T,C)),E}async function bBe(t,e={}){const i=e.pyramidLevel||0,r=e.headerInfo||gBe(t),{ifds:n,noData:s}=r;if(n.length===0)throw new Error("no valid image file directory");const o=Efe(r);if(o)throw o;let a=null;const l=i===-1?n[n.length-1]:n[i],c=s??e.noDataValue;return a=r.tileWidth?await hBe(t,r,l):await pBe(t,r,l),a&&(c!=null&&ZL(a,c),a)}var wBe=function(t){var e,i,r,n,s,o;function a(l){var c,u,h,f,m,g,y,v,b,w,x,S,I;for(this.data=l,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},m=null;;){switch(c=this.readUInt32(),v=(function(){var T,C;for(C=[],T=0;T<4;++T)C.push(String.fromCharCode(this.data[this.pos++]));return C}).call(this).join(""),v){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(c);break;case"fcTL":m&&this.animation.frames.push(m),this.pos+=4,m={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},f=this.readUInt16(),h=this.readUInt16()||100,m.delay=1e3*f/h,m.disposeOp=this.data[this.pos++],m.blendOp=this.data[this.pos++],m.data=[];break;case"IDAT":case"fdAT":for(v==="fdAT"&&(this.pos+=4,c-=4),l=(m!=null?m.data:void 0)||this.imgData,x=0;0<=c?x<c:x>c;0<=c?++x:--x)l.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(this.transparency.indexed=this.read(c),(b=255-this.transparency.indexed.length)>0)for(S=0;0<=b?S<b:S>b;0<=b?++S:--S)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(c)[0];break;case 2:this.transparency.rgb=this.read(c)}break;case"tEXt":g=(w=this.read(c)).indexOf(0),y=String.fromCharCode.apply(String,w.slice(0,g)),this.text[y]=String.fromCharCode.apply(String,w.slice(g+1));break;case"IEND":return m&&this.animation.frames.push(m),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(I=this.colorType)===4||I===6,u=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*u,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=c}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}return a.load=function(l,c,u){var h;return typeof c=="function"&&(u=c),(h=new XMLHttpRequest).open("GET",l,!0),h.responseType="arraybuffer",h.onload=function(){var f;return f=new a(new Uint8Array(h.response||h.mozResponseArrayBuffer)),typeof(c!=null?c.getContext:void 0)=="function"&&f.render(c),typeof u=="function"?u(f):void 0},h.send(null)},i=1,r=2,e=0,a.prototype.read=function(l){var c,u;for(u=[],c=0;0<=l?c<l:c>l;0<=l?++c:--c)u.push(this.data[this.pos++]);return u},a.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},a.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},a.prototype.decodePixels=function(l){var c,u,h,f,m,g,y,v,b,w,x,S,I,T,C,E,$,P,k,L,F,V,z;if(l==null&&(l=this.imgData),l.length===0)return new Uint8Array(0);for(l=(l=new RC(l)).getBytes(),E=(S=this.pixelBitlength/8)*this.width,I=new Uint8Array(E*this.height),g=l.length,C=0,T=0,u=0;T<g;){switch(l[T++]){case 0:for(f=k=0;k<E;f=k+=1)I[u++]=l[T++];break;case 1:for(f=L=0;L<E;f=L+=1)c=l[T++],m=f<S?0:I[u-S],I[u++]=(c+m)%256;break;case 2:for(f=F=0;F<E;f=F+=1)c=l[T++],h=(f-f%S)/S,$=C&&I[(C-1)*E+h*S+f%S],I[u++]=($+c)%256;break;case 3:for(f=V=0;V<E;f=V+=1)c=l[T++],h=(f-f%S)/S,m=f<S?0:I[u-S],$=C&&I[(C-1)*E+h*S+f%S],I[u++]=(c+Math.floor((m+$)/2))%256;break;case 4:for(f=z=0;z<E;f=z+=1)c=l[T++],h=(f-f%S)/S,m=f<S?0:I[u-S],C===0?$=P=0:($=I[(C-1)*E+h*S+f%S],P=h&&I[(C-1)*E+(h-1)*S+f%S]),y=m+$-P,v=Math.abs(y-m),w=Math.abs(y-$),x=Math.abs(y-P),b=v<=w&&v<=x?m:w<=x?$:P,I[u++]=(c+b)%256;break;default:throw new Error("Invalid filter algorithm: "+l[T-1])}C++}return I},a.prototype.decodePalette=function(){var l,c,u,h,f,m,g,y,v;for(u=this.palette,m=this.transparency.indexed||[],f=new Uint8Array((m.length||0)+u.length),h=0,u.length,l=0,c=g=0,y=u.length;g<y;c=g+=3)f[h++]=u[c],f[h++]=u[c+1],f[h++]=u[c+2],f[h++]=(v=m[l++])!=null?v:255;return f},a.prototype.copyToImageData=function(l,c){var u,h,f,m,g,y,v,b,w,x,S;if(h=this.colors,w=null,u=this.hasAlphaChannel,this.palette.length&&(w=(S=this._decodedPalette)!=null?S:this._decodedPalette=this.decodePalette(),h=4,u=!0),b=(f=l.data||l).length,g=w||c,m=y=0,h===1)for(;m<b;)v=w?4*c[m/4]:y,x=g[v++],f[m++]=x,f[m++]=x,f[m++]=x,f[m++]=u?g[v++]:this.transparency.grayscale&&this.transparency.grayscale===x?0:255,y=v;else for(;m<b;)v=w?4*c[m/4]:y,f[m++]=g[v++],f[m++]=g[v++],f[m++]=g[v++],f[m++]=u?g[v++]:this.transparency.rgb&&this.transparency.rgb[1]===g[v-3]&&this.transparency.rgb[3]===g[v-2]&&this.transparency.rgb[5]===g[v-1]?0:255,y=v},a.prototype.decode=function(){var l;return l=new Uint8Array(this.width*this.height*4),this.copyToImageData(l,this.decodePixels()),l},s=t.document&&t.document.createElement("canvas"),o=s&&s.getContext("2d"),n=function(l){var c;return o.width=l.width,o.height=l.height,o.clearRect(0,0,l.width,l.height),o.putImageData(l,0,0),(c=new Image).src=s.toDataURL(),c},a.prototype.decodeFrames=function(l){var c,u,h,f,m,g,y,v;if(this.animation){for(v=[],u=m=0,g=(y=this.animation.frames).length;m<g;u=++m)c=y[u],h=l.createImageData(c.width,c.height),f=this.decodePixels(new Uint8Array(c.data)),this.copyToImageData(h,f),c.imageData=h,v.push(c.image=n(h));return v}},a.prototype.renderFrame=function(l,c){var u,h,f;return u=(h=this.animation.frames)[c],f=h[c-1],c===0&&l.clearRect(0,0,this.width,this.height),(f!=null?f.disposeOp:void 0)===i?l.clearRect(f.xOffset,f.yOffset,f.width,f.height):(f!=null?f.disposeOp:void 0)===r&&l.putImageData(f.imageData,f.xOffset,f.yOffset),u.blendOp===e&&l.clearRect(u.xOffset,u.yOffset,u.width,u.height),l.drawImage(u.image,u.xOffset,u.yOffset)},a.prototype.animate=function(l){var c,u,h,f,m,g,y=this;return u=0,g=this.animation,f=g.numFrames,h=g.frames,m=g.numPlays,(c=function(){var v,b;if(v=u++%f,b=h[v],y.renderFrame(l,v),f>1&&u/f<m)return y.animation._timeout=setTimeout(c,b.delay)})()},a.prototype.stopAnimation=function(){var l;return clearTimeout((l=this.animation)!=null?l._timeout:void 0)},a.prototype.render=function(l){var c,u;return l._png&&l._png.stopAnimation(),l._png=this,l.width=this.width,l.height=this.height,c=l.getContext("2d"),this.animation?(this.decodeFrames(c),this.animate(c)):(u=c.createImageData(this.width,this.height),this.copyToImageData(u,this.decodePixels()),c.putImageData(u,0,0))},a}(self);const xBe=new Set(["jpg","png","bmp","gif"]);async function SBe(t,e){if(!XL)throw new N("rasterCoded:decode","lerc decoder is not supported on big endian platform");await bfe();const{offset:i}=e,{width:r,height:n,pixelType:s,statistics:o,depthCount:a,noDataValues:l,bandMasks:c,pixels:u,mask:h}=wfe(t,{inputOffset:i,returnInterleaved:e.returnInterleaved});return new de({width:r,height:n,pixelType:s.toLowerCase(),pixels:u,mask:h,statistics:o,bandMasks:c,depthCount:a,noDataValues:l})}async function IBe(t,e){const i=await bBe(t,{...e,noDataValue:null});lo(i);const r=new de({width:i.width,height:i.height,pixels:i.pixels,pixelType:i.pixelType.toLowerCase(),mask:i.mask,statistics:null});return r.updateStatistics(),r}async function TBe(t,e){const i=await _Be(t,e.customOptions),r=new de({width:i.width,height:i.height,pixels:i.pixels,pixelType:i.pixelType.toLowerCase(),mask:i.mask,statistics:null});return r.updateStatistics(),r}function Mfe(t,e){const i=e.pixelType||"u8",r=de.getPixelArrayConstructor(i),n=i==="u8"?t:new r(t.buffer),s=[],o=e.planes||1;if(o===1)s.push(n);else for(let l=0;l<o;l++){const c=(e.width||1)*(e.height||t.length),u=new r(c);for(let h=0;h<c;h++)u[h]=n[h*o+l];s.push(u)}const a=new de({width:e.width||1,height:e.height||t.length,pixels:s,pixelType:i,statistics:null});return a.updateStatistics(),a}function CBe(t,e){return Mfe(new RC(new Uint8Array(t)).getBytes(),e)}function EBe(t,e){return Mfe(W9(t,e.offset,e.eof,!e.isInputBigEndian),e)}function MBe(t,e,i){const{pixelTypeCtor:r}=OBe(e.pixelType),n=(0,nBe.decode)(t,{width:e.width,height:e.height,pixelType:r,format:i}),s=new de({width:e.width,height:e.height,pixels:n.pixels,pixelType:e.pixelType,mask:n.mask,statistics:null});return s.updateStatistics(),s}function $Be(t,e){const i=X6e.decode(t,e.hasNoZlibMask??void 0),r=new de({width:i.width,height:i.height,pixels:i.pixels,pixelType:"U8",mask:i.mask,statistics:null});return r.updateStatistics(),r}function ABe(t,e){const i=new Uint8Array(t),r=new wBe(i),{width:n,height:s}=e,o=n*s,a=r.decode();let l,c=0,u=0;const h=new Uint8Array(o);for(c=0;c<o;c++)h[c]=a[4*c+3];const f=new de({width:n,height:s,pixels:[],pixelType:"U8",mask:h,statistics:[]});for(c=0;c<3;c++){for(l=new Uint8Array(o),u=0;u<o;u++)l[u]=a[4*u+c];f.addData({pixels:l})}return f.updateStatistics(),f}async function kBe(t,e,i,r){const n=new K6e,s={applyJpegMask:!1,format:e,...i},o=await n.decode(t,s,r),a=new de(o);return a.updateStatistics(),a}function $fe(t){if(t==null)throw new N("rasterCodec:decode","parameter encodeddata is required.");const e=new Uint8Array(t,0,10);let i="";return e[0]===255&&e[1]===216?i="jpg":e[0]===137&&e[1]===80&&e[2]===78&&e[3]===71?i="png":e[0]===67&&e[1]===110&&e[2]===116&&e[3]===90&&e[4]===73&&e[5]===109&&e[6]===97&&e[7]===103&&e[8]===101&&e[9]===32?i="lerc":e[0]===76&&e[1]===101&&e[2]===114&&e[3]===99&&e[4]===50&&e[5]===32?i="lerc2":e[0]===73&&e[1]===73&&e[2]===42&&e[3]===0||e[0]===77&&e[1]===77&&e[2]===0&&e[3]===42||e[0]===73&&e[1]===73&&e[2]===43&&e[3]===0||e[0]===77&&e[1]===77&&e[2]===0&&e[3]===43?i="tiff":e[0]===71&&e[1]===73&&e[2]===70?i="gif":e[0]===66&&e[1]===77?i="bmp":String.fromCharCode.apply(null,e).toLowerCase().includes("error")&&(i="error"),i}function PBe(t){let e=null;switch(t){case"lerc":case"lerc2":e=SBe;break;case"jpg":e=$Be;break;case"png":e=ABe;break;case"bsq":case"bip":e=(i,r)=>MBe(i,r,t);break;case"tiff":e=IBe;break;case"deflate":e=CBe;break;case"lzw":e=EBe;break;case"error":e=()=>{throw new N("rasterCodec:decode","input data contains error")};break;default:e=()=>{throw new N("rasterCodec:decode","unsupported raster format")}}return e}function OBe(t){let e=null,i=null;switch(t?t.toLowerCase():"f32"){case"u1":case"u2":case"u4":case"u8":i=255,e=Uint8Array;break;case"u16":i=i||65535,e=Uint16Array;break;case"u32":i=i||2**32-1,e=Uint32Array;break;case"s8":i=i||-128,e=Int8Array;break;case"s16":i=i||-32768,e=Int16Array;break;case"s32":i=i||0-2**31,e=Int32Array;break;default:e=Float32Array}return{pixelTypeCtor:e,noDataValue:i}}function LBe(t,e=1){if(!t)return;const{pixels:i,width:r,height:n,mask:s}=t;if(!i||i.length===0)return;const o=i.length,a=r-1,l=n-1,c=[];let u,h,f,m,g,y,v=null;const b=de.getPixelArrayConstructor(t.pixelType);if(e===0){for(u=0;u<o;u++){for(g=i[u],y=new b(a*l),h=0;h<l;h++)for(m=h*r,f=0;f<a;f++)y[h*a+f]=g[m+f];c.push(y)}if(s!=null)for(v=new Uint8Array(a*l),h=0;h<l;h++)for(m=h*r,f=0;f<a;f++)v[h*a+f]=s[m+f]}else{for(u=0;u<o;u++){for(g=i[u],y=new b(a*l),h=0;h<l;h++)for(m=h*r,f=0;f<a;f++)y[h*a+f]=(g[m+f]+g[m+f+1]+g[m+r+f]+g[m+r+f+1])/4;c.push(y)}if(s)for(v=new Uint8Array(a*l),h=0;h<l;h++)for(m=h*r,f=0;f<a;f++)v[h*a+f]=Math.min.apply(null,[s[m+f],s[m+f+1],s[m+r+f],s[m+r+f+1]])}t.width=a,t.height=l,t.mask=v,t.pixels=c}function RBe(t){let e=$fe(t);return e==="lerc2"?e="lerc":e==="error"&&(e=""),e}async function FBe(t,e={},i){if(t==null)throw new N("rasterCodec:decode","missing encodeddata parameter.");let r=e.format&&e.format.toLowerCase();if(!(r!=="bsq"&&r!=="bip"||e.width!=null&&e.height!=null))throw new N("rasterCodec:decode","requires width and height in options parameter.");if(r==="tiff"&&e.customOptions)return TBe(t,e);if((!r||r!=="bsq"&&r!=="bip"&&r!=="deflate"&&r!=="lzw")&&(r=$fe(t)),e.useCanvas&&xBe.has(r))return kBe(t,r,e,i);const n=PBe(r);e.isPoint&&((e={...e}).width!=null&&e.width++,e.height!=null&&e.height++);const s=await n(t,e);return s&&(r!=="jpg"&&e.noDataValue!=null&&s.depthCount===1&&ZL(s,e.noDataValue,{customFloatTolerance:e.tolerance}),e.isPoint&&LBe(s),s)}const AY=8,DBe=256;let na=class extends F1(te){constructor(){super(...arguments),this.datasetName=null,this.datasetFormat=null,this.hasUniqueSourceStorageInfo=!0,this.rasterInfo=null,this.ioConfig={sampling:"closest"}}async init(){const e=Oz();this.addResolvingPromise(e),await this.when()}normalizeCtorArgs(e){return e&&e.ioConfig&&(e={...e,ioConfig:{resolution:null,bandIds:null,sampling:"closest",tileInfo:Od.create(),...e.ioConfig}}),e}get _isGlobalWrappableSource(){const{rasterInfo:e}=this,i=ba(e.spatialReference);return i!=null&&e.extent.width>=i/2}get _hasNoneOrGCSShiftTransform(){const{transform:e}=this.rasterInfo;return e==null||e.type==="gcs-shift"}set rasterJobHandler(e){var i,r;this._set("rasterJobHandler",e),this.datasetFormat==="Function"&&((r=(i=this.primaryRasters)==null?void 0:i.rasters)==null||r.forEach(n=>n.rasterJobHandler=e))}set url(e){this._set("url",NU(e,ie.getLogger(this)))}async open(e){throw new N("BaseRaster:open-not-implemented","open() is not implemented")}async fetchTile(e,i,r,n={}){const s=n.tileInfo||this.rasterInfo.storageInfo.tileInfo,o=this.getTileExtentFromTileInfo(e,i,r,s);return this.fetchPixels(o,s.size[0],s.size[1],n)}async identify(e,i={}){var L;e=jv(fe,e).clone().normalize();const{multidimensionalDefinition:r,timeExtent:n}=i,{rasterInfo:s}=this,{hasMultidimensionalTranspose:o,multidimensionalInfo:a}=s;let{transposedVariableName:l}=i;const c=a!=null&&o&&(n!=null||pfe(r));c&&!l&&(l=r!=null&&r.length>0?r[0].variableName??void 0:a.variables[0].name,i={...i,transposedVariableName:l}),i=this._getRequestOptionsWithSliceId(i);const{spatialReference:u,extent:h}=s,{datumTransformation:f}=i;let m=jP(e,u,f);if(!h.intersects(m))return{location:m,value:null};if(s.transform!=null){const F=s.transform.inverseTransform(m);if(!s.nativeExtent.intersects(F))return{location:F,value:null};m=F}let g=0;const y=l!=null&&a!=null&&s.hasMultidimensionalTranspose;if(this.datasetFormat==="Function"){const F=this.primaryRasters.rasters[0];if(y)return F.identify(m,i);const{pixelSize:V}=s,z=3,G=V.x*z/2,H=V.y*z/2,Z=new Re({xmin:m.x-G,xmax:m.x+G,ymin:m.y-H,ymax:m.y+H,spatialReference:u}),K={interpolation:"nearest"},{pixelBlock:X}=await F.fetchPixels(Z,z,z,K),{pixelBlock:oe}=await this.fetchPixels(Z,z,z,K);if(X==null)return{location:m,value:null};const se=Math.floor(z*z*.5),le=!X.mask||X.mask[se]?X.pixels.map(Se=>Se[se]):null;let me;return oe!=null&&(me=!oe.mask||oe.mask[se]?oe.pixels.map(Se=>Se[se]):void 0),{location:m,value:le,processedValue:me,pyramidLevel:0}}if(!y){if(i.srcResolution)g=Lz(i.srcResolution,s,this.ioConfig.sampling).pyramidLevel;else if(g=await this.computeBestPyramidLevelForLocation(e,i),g==null)return{location:m,value:null}}const v=this.identifyPixelLocation(m,g,null,y);if(v===null)return{location:m,value:null};const{row:b,col:w,rowOffset:x,colOffset:S,blockWidth:I}=v,T=l??i.sliceId,C=yY(this.url,T),E=`${g}/${b}/${w}`;let $=vY(C,null,E);$==null&&($=this.fetchRawTile(g,b,w,i),_Y(C,null,E,$));const P=await $;if(P==null||!((L=P.pixels)!=null&&L.length))return{location:m,value:null};const k=x*I+S;return this._processIdentifyResult(P,{srcLocation:m,position:k,pyramidLevel:g,useTransposedTile:!!y,requestSomeSlices:c,identifyOptions:i})}async fetchPixels(e,i,r,n={}){e=W6e(e),n=this._getRequestOptionsWithSliceId(n);const{_hasNoneOrGCSShiftTransform:s}=this;if(n.requestRawData&&s)return this._fetchPixels(e,i,r,n);const o=ba(e.spatialReference),a=EA(e);if(o==null||a===0||a===1&&this._isGlobalWrappableSource&&s)return this._fetchPixels(e,i,r,n);if(a>=3)return{extent:e,pixelBlock:null};const l=[],{xmin:c,xmax:u}=e,h=Math.round(o/(u-c)*i),f=h-Math.round((o/2-c)/(u-c)*i);let m=0;const g=[];for(let w=0;w<=a;w++){const x=new Re({xmin:w===0?c:-o/2,xmax:w===a?u-o*w:o/2,ymin:e.ymin,ymax:e.ymax,spatialReference:e.spatialReference}),S=w===0?h-f:w===a?i-m:h;m+=S,g.push(S);const I=n.disableWrapAround&&w>0?null:this._fetchPixels(x,S,r,n);l.push(I)}const y=(await Promise.all(l)).map(w=>w==null?void 0:w.pixelBlock);let v=null;const b={width:i,height:r};return this.rasterJobHandler?v=(await this.rasterJobHandler.mosaicAndTransform({srcPixelBlocks:y,srcMosaicSize:b,destDimension:null,coefs:null,sampleSpacing:null,interpolation:"nearest",alignmentInfo:null,blockWidths:g},n)).pixelBlock:v=IA(y,b,{blockWidths:g}),{extent:e,srcExtent:uv(e,this.rasterInfo.spatialReference,n.datumTransformation),pixelBlock:v}}async fetchRawPixels(e,i,r,n={}){i={x:Math.floor(i.x),y:Math.floor(i.y)};const s=await this._fetchRawTiles(e,i,r,n),{nativeExtent:o,nativePixelSize:a,storageInfo:l}=this.rasterInfo,c=2**e,u=a.x*c,h=a.y*c,f=new Re({xmin:o.xmin+u*i.x,xmax:o.xmin+u*(i.x+r.width-1),ymin:o.ymax-h*(i.y+r.height-1),ymax:o.ymax-h*i.y,spatialReference:o.spatialReference});if(!s)return{extent:f,srcExtent:f,pixelBlock:null};const{pixelBlocks:m,mosaicSize:g}=s;if(m.length===1&&m[0]!=null&&m[0].width===r.width&&m[0].height===r.height)return{extent:f,srcExtent:f,pixelBlock:s.pixelBlocks[0]};const y=e>0?l.pyramidBlockWidth:l.blockWidth,v=e>0?l.pyramidBlockHeight:l.blockHeight,b={x:i.x%y,y:i.y%v};let w;return this.rasterJobHandler?w=(await this.rasterJobHandler.mosaicAndTransform({srcPixelBlocks:m,srcMosaicSize:g,destDimension:r,clipOffset:b,clipSize:r,coefs:null,sampleSpacing:null,interpolation:n.interpolation,alignmentInfo:null,blockWidths:null},n)).pixelBlock:w=IA(m,g,{clipOffset:b,clipSize:r}),{extent:f,srcExtent:f,pixelBlock:w}}fetchRawTile(e,i,r,n){throw new N("BaseRaster:read-not-implemented","fetchRawTile() is not implemented")}computeExtent(e){return uv(this.rasterInfo.extent,e)}decodePixelBlock(e,i){return!this.rasterJobHandler||i.useCanvas?FBe(e,i):this.rasterJobHandler.decode({data:e,options:i})}async request(e,i,r=0){const{customFetchParameters:n}=this.ioConfig,{range:s,query:o,headers:a}=i;r=r??i.retryCount??this.ioConfig.retryCount;const l=s?{Range:`bytes=${s.from}-${s.to}`}:null;try{return await at(e,{...i,query:{...o,...n},headers:{...a,...l}})}catch(c){if(r>0)return r--,this.request(e,i,r);throw c}}getSliceIndex(e){const{multidimensionalInfo:i}=this.rasterInfo;return i==null||e==null||e.length===0?null:R6e(e,i)}getTileExtentFromTileInfo(e,i,r,n){const s=us(n.lodAt(e));return this.getTileExtent({x:s.resolution,y:s.resolution},i,r,n.origin,n.spatialReference,n.size)}updateTileInfo(){const{storageInfo:e,spatialReference:i,extent:r,pixelSize:n}=this.rasterInfo;if(!e.tileInfo){const s=[],o=e.maximumPyramidLevel||0;let a=Math.max(n.x,n.y),l=1/.0254*96*a;for(let u=0;u<=o;u++)s.push(new vd({level:o-u,resolution:a,scale:l})),a*=2,l*=2;const c=new fe({x:r.xmin,y:r.ymax,spatialReference:i});e.tileInfo=new Od({origin:c,size:[e.blockWidth,e.blockHeight],spatialReference:i,lods:s}),e.isVirtualTileInfo=!0}}createRemoteDatasetStorageInfo(e,i=512,r=512,n){const{width:s,height:o,nativeExtent:a,pixelSize:l,spatialReference:c}=e,u=new fe({x:a.xmin,y:a.ymax,spatialReference:c});n==null&&(n=Math.max(0,Math.round(Math.log(Math.max(s,o))/Math.LN2-8)));const h=this.computeBlockBoundary(a,512,512,{x:a.xmin,y:a.ymax},[l],n);e.storageInfo=new nx({blockWidth:i,blockHeight:r,pyramidBlockWidth:i,pyramidBlockHeight:r,origin:u,firstPyramidLevel:1,maximumPyramidLevel:n,blockBoundary:h})}async computeBestPyramidLevelForLocation(e,i={}){return 0}computeBlockBoundary(e,i,r,n,s,o=0,a=2){if(s.length===1&&o>0){s=[...s];let{x:h,y:f}=s[0];for(let m=0;m<o;m++)h*=a,f*=a,s.push({x:h,y:f})}const l=[],{x:c,y:u}=n;for(let h=0;h<s.length;h++){const{x:f,y:m}=s[h];l.push({minCol:Math.floor((e.xmin-c+.1*f)/i/f),maxCol:Math.floor((e.xmax-c-.1*f)/i/f),minRow:Math.floor((u-e.ymax+.1*m)/r/m),maxRow:Math.floor((u-e.ymin-.1*m)/r/m)})}return l}getPyramidPixelSize(e){const{nativePixelSize:i}=this.rasterInfo,{pyramidResolutions:r,pyramidScalingFactor:n}=this.rasterInfo.storageInfo;if(e===0)return i;if(r!=null&&r.length)return r[e-1];const s=n**e;return{x:i.x*s,y:i.y*s}}identifyPixelLocation(e,i,r,n){const{spatialReference:s,nativeExtent:o,storageInfo:a}=this.rasterInfo,{maximumPyramidLevel:l,origin:c,transposeInfo:u}=a,h=n&&u!=null?u.tileSize[0]:a.blockWidth,f=n&&u!=null?u.tileSize[1]:a.blockHeight,m=jP(e,s,r);if(!o.intersects(m)||i<0||i>l)return null;const g=this.getPyramidPixelSize(i),{x:y,y:v}=g,b=(c.y-m.y)/v/f,w=(m.x-c.x)/y/h,x=Math.min(f-1,Math.floor((b-Math.floor(b))*f)),S=Math.min(h-1,Math.floor((w-Math.floor(w))*h));return{pyramidLevel:i,row:Math.floor(b),col:Math.floor(w),rowOffset:x,colOffset:S,blockWidth:h,srcLocation:m}}getTileExtent(e,i,r,n,s,o){const[a,l]=o,c=n.x+r*a*e.x,u=c+a*e.x,h=n.y-i*l*e.y,f=h-l*e.y;return new Re({xmin:c,xmax:u,ymin:f,ymax:h,spatialReference:s})}getBlockWidthHeight(e){return{blockWidth:e>0?this.rasterInfo.storageInfo.pyramidBlockWidth:this.rasterInfo.storageInfo.blockWidth,blockHeight:e>0?this.rasterInfo.storageInfo.pyramidBlockHeight:this.rasterInfo.storageInfo.blockHeight}}isBlockOutside(e,i,r){const n=this.rasterInfo.storageInfo.blockBoundary[e];return!n||n.maxRow<i||n.maxCol<r||n.minRow>i||n.minCol>r}async _fetchPixels(e,i,r,n={}){let s=EA(e);if(s>=2)return{extent:e,pixelBlock:null};const o=this._getSourceDataInfo(e,i,r,n),{pyramidLevel:a,srcResolution:l,srcExtent:c,srcWidth:u,srcHeight:h,ul:f}=o;if(u===0||h===0)return{extent:e,srcExtent:c,pixelBlock:null};const{rasterInfo:m}=this,g=m.transform,y=(g==null?void 0:g.type)==="gcs-shift",v=ba(e.spatialReference)!=null;!y&&v||(s=EA(o.srcExtent,y));const b=await this._fetchRawTiles(a,f,{width:u,height:h,wrapCount:s},n);if(!b)return{extent:e,srcExtent:c,pixelBlock:null};const w=m.storageInfo,x=a>0?w.pyramidBlockWidth:w.blockWidth,S=a>0?w.pyramidBlockHeight:w.blockHeight;let{x:I,y:T}=m.pixelSize;if(a>0){const{pyramidResolutions:Se,pyramidScalingFactor:Ge}=w;if(Se!=null&&Se[a-1])({x:I,y:T}=Se[a-1]);else{const Be=Ge**a;I*=Be,T*=Be}}const C=m.spatialReference,E=new fe({x:I,y:T,spatialReference:C}),$=x===u&&S===h&&f.x%x==0&&f.y%S==0,P=new fe({x:(e.xmax-e.xmin)/i,y:(e.ymax-e.ymin)/r,spatialReference:e.spatialReference}),k=!e.spatialReference.equals(C),L=C.isGeographic?1e-9:1e-4,{datumTransformation:F}=n;if(!k&&$&&b.pixelBlocks.length===1&&x===i&&S===r&&this._isSameResolution(l,P,L))return{extent:e,srcExtent:c,srcTilePixelSize:E,pixelBlock:b.pixelBlocks[0]};const V=v&&ba(c.spatialReference)!=null&&this._hasNoneOrGCSShiftTransform,z=n.requestProjectedLocalDirections&&this.rasterInfo.dataType.startsWith("vector");z&&!this.rasterJobHandler&&await Oz();const G=this.rasterJobHandler?await this.rasterJobHandler.getProjectionOffsetGrid({projectedExtent:e,srcBufferExtent:b.extent,pixelSize:P.toJSON(),datumTransformation:F,rasterTransform:g,hasWrapAround:s>0||V,isAdaptive:this.ioConfig.optimizeProjectionAccuracy!==!1,includeGCSGrid:z},n):q6e({projectedExtent:e,srcBufferExtent:b.extent,pixelSize:P,datumTransformation:F,rasterTransform:g,hasWrapAround:s>0||V,isAdaptive:!1,includeGCSGrid:z});let H;const Z=!n.requestRawData,K={rows:G.spacing[0],cols:G.spacing[1]},X=this._hasNoneOrGCSShiftTransform?this._getRasterTileAlignmentInfo(a,b.extent.xmin):void 0,{pixelBlocks:oe,mosaicSize:se,isPartiallyFilled:le}=b;let me=null;if(this.rasterJobHandler)({pixelBlock:H,localNorthDirections:me}=await this.rasterJobHandler.mosaicAndTransform({srcPixelBlocks:oe,srcMosaicSize:se,destDimension:Z?{width:i,height:r}:null,coefs:Z?G.coefficients:null,sampleSpacing:Z?K:null,projectDirections:z,gcsGrid:z?G.gcsGrid:null,isUV:this.rasterInfo.dataType==="vector-uv",interpolation:n.interpolation,alignmentInfo:X,blockWidths:null},n));else{const Se=IA(oe,se,{alignmentInfo:X});H=Z?qpe(Se,{width:i,height:r},G.coefficients,K,n.interpolation):Se,z&&G.gcsGrid&&(me=$8e({width:i,height:r},G.gcsGrid),H=A8e(H,this.rasterInfo.dataType,me))}return n.requestRawData||z?{extent:e,srcExtent:c,srcTilePixelSize:E,pixelBlock:H,transformGrid:G,localNorthDirections:me,isPartiallyFilled:le}:{extent:e,srcExtent:c,srcTilePixelSize:E,pixelBlock:H}}async _fetchRawTiles(e,i,r,n){const{origin:s,blockBoundary:o}=this.rasterInfo.storageInfo,{blockWidth:a,blockHeight:l}=this.getBlockWidthHeight(e);let{x:c,y:u}=i,{width:h,height:f,wrapCount:m}=r;const g=this._getRasterTileAlignmentInfo(e,0);n.buffer&&(c-=n.buffer.cols,u-=n.buffer.rows,h+=2*n.buffer.cols,f+=2*n.buffer.rows);let y=0,v=0,b=0;m&&g!=null&&({worldColumnCountFromOrigin:v,originColumnOffset:b,rightPadding:y}=g,v*g.blockWidth-y>=c+h&&(y=0));const w=Math.floor(c/a),x=Math.floor(u/l),S=Math.floor((c+h+y-1)/a),I=Math.floor((u+f+y-1)/l),T=o[e];if(!T)return null;const{minRow:C,minCol:E,maxCol:$,maxRow:P}=T;if(m===0&&(I<C||S<E||x>P||w>$))return null;const k=new Array;let L=!1;const F=this.ioConfig.allowPartialFill==null?n.allowPartialFill:this.ioConfig.allowPartialFill;for(let X=x;X<=I;X++)for(let oe=w;oe<=S;oe++){let se=oe;if(!n.disableWrapAround&&m&&g!=null&&v<=oe&&(se=oe-v-b),X>=C&&se>=E&&P>=X&&$>=se){const le=this._fetchRawTile(e,X,se,n);F?k.push(new Promise(me=>{le.then(Se=>me(Se)).catch(()=>{L=!0,me(null)})})):k.push(le)}else k.push(Promise.resolve(null))}if(k.length===0)return null;const V=await Promise.all(k),z={height:(I-x+1)*l,width:(S-w+1)*a},{spatialReference:G}=this.rasterInfo,H=this.getPyramidPixelSize(e),{x:Z,y:K}=H;return{extent:new Re({xmin:s.x+w*a*Z,xmax:s.x+(S+1)*a*Z,ymin:s.y-(I+1)*l*K,ymax:s.y-x*l*K,spatialReference:G}),pixelBlocks:V,mosaicSize:z,isPartiallyFilled:L}}_isSameResolution(e,i,r){return Math.abs(e.x-i.x)<r&&Math.abs(e.y-i.y)<r}_fetchRawTile(e,i,r,n){const s=this.rasterInfo.storageInfo.blockBoundary[e];if(!s)return Promise.resolve(null);const{minRow:o,minCol:a,maxCol:l,maxRow:c}=s;if(i<o||r<a||i>c||r>l)return Promise.resolve(null);const u=yY(this.url,n.sliceId),h=`${e}/${i}/${r}`;let f=vY(u,n.registryId,h);if(f==null){const m=new AbortController;f=this.fetchRawTile(e,i,r,{...n,signal:m.signal}),_Y(u,n.registryId,h,f,m),f.catch(()=>Z6e(u,n.registryId,h))}return n.signal&&Fo(n,()=>{J6e(u,n.registryId,h)}),f}_computeMagDirValues(e){var c;const{bandCount:i,dataType:r}=this.rasterInfo;if(!(i===2&&r==="vector-magdir"||r==="vector-uv")||(e==null?void 0:e.length)!==2||!((c=e[0])!=null&&c.length))return null;const n=e[0].length;if(r==="vector-magdir"){const u=e[1].map(h=>(h+360)%360);return[e[0],u]}const[s,o]=e,a=[],l=[];for(let u=0;u<n;u++){const[h,f]=B9([s[u],o[u]]);a.push(h),l.push(f)}return[a,l]}_getRasterTileAlignmentInfo(e,i){return this._rasterTileAlighmentInfo==null&&(this._rasterTileAlighmentInfo=G6e(this.rasterInfo)),this._rasterTileAlighmentInfo.pyramidsInfo==null?null:{startX:i,halfWorldWidth:this._rasterTileAlighmentInfo.halfWorldWidth,hasGCSSShiftTransform:this._rasterTileAlighmentInfo.hasGCSSShiftTransform,...this._rasterTileAlighmentInfo.pyramidsInfo[e]}}_getSourceDataInfo(e,i,r,n={}){const s={datumTransformation:n.datumTransformation,pyramidLevel:0,pyramidResolution:null,srcExtent:null,srcHeight:0,srcResolution:null,srcWidth:0,ul:{x:0,y:0}};n.srcResolution&&(s.srcResolution=n.srcResolution,this._updateSourceDataInfo(e,s));const o=this.rasterInfo.storageInfo.maximumPyramidLevel||0,{srcWidth:a,srcHeight:l,pyramidLevel:c}=s,u=a/i,h=l/r,f=c<o&&u*h>=16,m=c===o&&this._requireTooManySrcTiles(a,l,i,r);if(f||m||a===0||l===0){const g=new fe({x:(e.xmax-e.xmin)/i,y:(e.ymax-e.ymin)/r,spatialReference:e.spatialReference});let y=zP(g,this.rasterInfo.spatialReference,e,s.datumTransformation);const v=!y||n.srcResolution&&y.x+y.y<n.srcResolution.x+n.srcResolution.y;if(f&&n.srcResolution&&v){const b=Math.round(Math.log(Math.max(u,h))/Math.LN2)-1;if(o-c+3>=b){const w=2**b;y={x:n.srcResolution.x*w,y:n.srcResolution.y*w}}}y&&(s.srcResolution=y,this._updateSourceDataInfo(e,s))}return this._requireTooManySrcTiles(s.srcWidth,s.srcHeight,i,r)&&(s.srcWidth=0,s.srcHeight=0),s}_requireTooManySrcTiles(e,i,r,n){const{tileInfo:s}=this.rasterInfo.storageInfo;return Math.ceil(e/s.size[0])*Math.ceil(i/s.size[1])>=DBe||e/r>AY||i/n>AY}_updateSourceDataInfo(e,i){i.srcWidth=0,i.srcHeight=0;const{rasterInfo:r}=this,n=r.spatialReference,{srcResolution:s,datumTransformation:o}=i,{pyramidLevel:a,pyramidResolution:l,excessiveReading:c}=Lz(s,r,this.ioConfig.sampling);if(c)return;let u=i.srcExtent||uv(e,n,o);if(u==null)return;const h=r.transform;h&&(u=h.inverseTransform(u)),i.srcExtent=u;const{x:f,y:m}=r.storageInfo.origin,g=Math.floor((u.xmin-f)/l.x+.1),y=Math.floor((m-u.ymax)/l.y+.1),v=Math.floor((u.xmax-f)/l.x-.1),b=Math.floor((m-u.ymin)/l.y-.1),w=u.width<.1*l.x?0:v-g+1,x=u.height<.1*l.y?0:b-y+1;i.pyramidLevel=a,i.pyramidResolution=l,i.srcWidth=w,i.srcHeight=x,i.ul={x:g,y}}_getRequestOptionsWithSliceId(e){return this.rasterInfo.multidimensionalInfo!=null&&e.sliceId==null&&(e={...e,sliceId:this.getSliceIndex(e.multidimensionalDefinition)}),e}_processIdentifyResult(e,i){const{srcLocation:r,position:n,pyramidLevel:s,useTransposedTile:o}=i,a=e.pixels[0].length/e.width/e.height;if(!(!e.mask||e.mask[n]))return{location:r,value:null};const{multidimensionalInfo:l}=this.rasterInfo;if(l==null||!o){const b=e.pixels.map(S=>S[n]),w={location:r,value:b,pyramidLevel:s},x=this._computeMagDirValues(b.map(S=>[S]));return x!=null&&x.length&&(w.magdirValue=x.map(S=>S[0])),w}let c=e.pixels.map(b=>b.slice(n*a,n*a+a)),u=this._computeMagDirValues(c);const{requestSomeSlices:h,identifyOptions:f}=i;let m=$6e(l,f.transposedVariableName);if(h){const b=A6e(m,f.multidimensionalDefinition,f.timeExtent);c=c.map(w=>b.map(x=>w[x])),u=u==null?void 0:u.map(w=>b.map(x=>w[x])),m=b.map(w=>m[w])}const g=e.noDataValues||this.rasterInfo.noDataValue,y={pixels:c,pixelType:e.pixelType};let v;return g!=null&&(ZL(y,g),v=y.mask),{location:r,value:null,dataSeries:m.map((b,w)=>{const x={value:(v==null?void 0:v[w])===0?null:c.map(S=>S[w]),multidimensionalDefinition:b.multidimensionalDefinition.map(S=>new Lv({...S,isSlice:!0}))};return u!=null&&u.length&&(x.magdirValue=[u[0][w],u[1][w]]),x}),pyramidLevel:s}}};d([p()],na.prototype,"_rasterTileAlighmentInfo",void 0),d([p({readOnly:!0})],na.prototype,"_isGlobalWrappableSource",null),d([p({readOnly:!0})],na.prototype,"_hasNoneOrGCSShiftTransform",null),d([p()],na.prototype,"rasterJobHandler",null),d([p(HL)],na.prototype,"url",null),d([p({type:String,json:{write:!0}})],na.prototype,"datasetName",void 0),d([p({type:String,json:{write:!0}})],na.prototype,"datasetFormat",void 0),d([p()],na.prototype,"hasUniqueSourceStorageInfo",void 0),d([p()],na.prototype,"rasterInfo",void 0),d([p()],na.prototype,"ioConfig",void 0),d([p()],na.prototype,"sourceJSON",void 0),na=d([A("esri.layers.support.rasterDatasets.BaseRaster")],na);const Kv=na;let Gy=class extends Kv{constructor(){super(...arguments),this.datasetFormat="Function",this.tileType="Raster",this.rasterFunction=null}async open(e){var u,h,f,m;await this.init();const{rasterFunction:i}=this;(h=(u=this.primaryRasters)==null?void 0:u.rasters)!=null&&h.length?i.sourceRasters=this.primaryRasters.rasters:(this.primaryRasters=i.getPrimaryRasters(),this.rasterJobHandler&&((f=this.primaryRasters.rasters)==null||f.forEach(g=>g.rasterJobHandler=this.rasterJobHandler)));const{rasters:r,rasterIds:n}=this.primaryRasters,s=r.map(g=>g.rasterInfo?void 0:g.open(e));await Promise.all(s);const o=r.map(({rasterInfo:g})=>g),a=i.bind({rasterInfos:o,rasterIds:n});if(!a.success||o.length===0)throw new N("raster-function:open",`cannot bind the function: ${a.error??""}`);const l=i.functionName==="Table"?i:(m=i.functionArguments)==null?void 0:m.raster;(l==null?void 0:l.functionName)==="Table"&&(i.rasterInfo.attributeTable=Mg.fromJSON(l.functionArguments.attributeTableAsRecordSet)),await this.syncJobHandler();const c=o[0];this.hasUniqueSourceStorageInfo=o.length===1||o.slice(1).every(g=>this._hasSameStorageInfo(g,c)),this.set("sourceJSON",r[0].sourceJSON),this.set("rasterInfo",i.rasterInfo)}async syncJobHandler(){var e;return(e=this.rasterJobHandler)==null?void 0:e.updateRasterFunction(this.rasterFunction)}async fetchPixels(e,i,r,n={}){var x,S;const{rasters:s,rasterIds:o}=this.primaryRasters;let a=!1;const{interpolation:l}=n,c=(x=this.rasterFunction.flatWebGLFunctionChain)==null?void 0:x.hasSurfaceFunction;!n.requestRawData&&l!=="bilinear"&&c&&(a=s.length===1&&!n.skipRasterFunction,n={...n,interpolation:"bilinear",requestRawData:a});const u=s.map(I=>I.fetchPixels(e,i,r,n)),h=await Promise.all(u),f=h.map(I=>I.pixelBlock),m=a||n.requestRawData?h.map(I=>I.srcTilePixelSize):null;if(n.skipRasterFunction||f.every(I=>I==null))return h[0];const g=((S=h.find(I=>I.pixelBlock!=null))==null?void 0:S.extent)??e,y=this.rasterJobHandler?await this.rasterJobHandler.process({extent:g,primaryPixelBlocks:f,primaryPixelSizes:m,primaryRasterIds:o}):this.rasterFunction.process({extent:g,primaryPixelBlocks:f,primaryPixelSizes:m,primaryRasterIds:o}),{transformGrid:v}=h[0];if(!a||y==null||v==null)return{...h[0],pixelBlock:y};const b={rows:v.spacing[0],cols:v.spacing[1]};let w;return this.rasterJobHandler?w=(await this.rasterJobHandler.mosaicAndTransform({srcPixelBlocks:[y],srcMosaicSize:{width:y.width,height:y.height},destDimension:{width:i,height:r},coefs:v.coefficients,sampleSpacing:b,projectDirections:!1,gcsGrid:null,isUV:!1,interpolation:l,alignmentInfo:void 0,blockWidths:null},n)).pixelBlock:w=qpe(y,{width:i,height:r},v.coefficients,b,l),{extent:e,srcExtent:h[0].srcExtent,pixelBlock:w}}_hasSameStorageInfo(e,i){const{storageInfo:r,pixelSize:n,spatialReference:s,extent:o}=e,{storageInfo:a,pixelSize:l,spatialReference:c,extent:u}=i;return n.x===l.x&&n.y===l.y&&s.equals(c)&&o.equals(u)&&r.blockHeight===a.blockHeight&&r.blockWidth===a.blockWidth&&r.maximumPyramidLevel===a.maximumPyramidLevel}};d([p({type:String,json:{write:!0}})],Gy.prototype,"datasetFormat",void 0),d([p()],Gy.prototype,"tileType",void 0),d([p()],Gy.prototype,"rasterFunction",void 0),d([p()],Gy.prototype,"primaryRasters",void 0),Gy=d([A("esri.layers.support.rasterDatasets.FunctionRaster")],Gy);const Uz=Gy;function NBe(t,e){if(t.spatialReference.equals(e))return t;const i=ti(t.spatialReference),r=ti(e);if(i===r)return t;const n=i/r;return{x:t.x*n,y:t.y*n}}async function VBe(t,e,i){if(i.type==="extent")return jBe(t,e,i);const{width:r,height:n}=t,s=new Uint8Array(r*n),{contains:o,intersects:a}=await W(()=>import("./geometryEngine-40d862d7.js"),["./geometryEngine-40d862d7.js","./geometryEngineBase-eec52f2a.js","./hydrated-1be60493.js"],import.meta.url);return a(e,i)?i.type==="polyline"?BBe(t,e,i):o(i,e)?t:zBe(t,e,i):new de({pixelType:t.pixelType,width:r,height:n,mask:s,maskIsAlpha:!1,pixels:[...t.pixels]})}function zBe(t,e,i){if(!t)return t;const{width:r,height:n}=t,s=e.width/r,o=e.height/n,{xmin:a,ymax:l}=e;let c;if(i.type==="extent"){const v=(i.xmin-a)/s,b=(i.xmax-a)/s,w=(l-i.ymax)/o,x=(l-i.ymin)/o;c=[[[v,w],[v,x],[b,x],[b,w],[v,w]]]}else c=i.rings.map(v=>v.map(([b,w])=>[(b-a)/s,(l-w)/o]));const u=document.createElement("canvas");u.width=r,u.height=n;const h=u.getContext("2d");h.fillStyle="#f00",c.forEach(v=>{h.beginPath(),h.moveTo(v[0][0],v[0][1]);for(let b=0;b<v.length;b++)h.lineTo(v[b][0],v[b][1]);h.closePath(),h.fill()});const f=h.getImageData(0,0,r,n).data,m=t.mask,g=r*n,y=new Uint8Array(g);for(let v=0;v<g;v++)m&&!m[v]||(y[v]=f[4*v+3]>127?255:0);return new de({pixelType:t.pixelType,width:r,height:n,mask:y,maskIsAlpha:!1,pixels:[...t.pixels]})}function jBe(t,e,i){const{width:r,height:n}=t,s=new Uint8Array(r*n),o=e.width/r,a=e.height/n;if(i.width/o<.5||i.height/a<.5)return new de({pixelType:t.pixelType,width:r,height:n,mask:s,pixels:[...t.pixels]});const{xmin:l,xmax:c,ymin:u,ymax:h}=e,{xmin:f,xmax:m,ymin:g,ymax:y}=i,v=Math.max(l,f),b=Math.min(c,m),w=Math.max(u,g),x=Math.min(h,y),S=.5*o,I=.5*a;if(b-v<S||x-w<I||b<l+S||v>c-S||w>h-I||x<u+I)return new de({pixelType:t.pixelType,width:r,height:n,mask:s,pixels:[...t.pixels]});const T=Math.max(0,(v-l)/o),C=Math.min(r,Math.max(0,(b-l)/o)),E=Math.max(0,(h-x)/a),$=Math.min(n,Math.max(0,(h-w)/a)),P=Math.round(T),k=Math.round(C)-1,L=Math.round(E),F=Math.round($)-1;if(P===k&&T%1>.5&&C%1<.5||L===F&&E%1>.5&&$%1<.5)return new de({pixelType:t.pixelType,width:r,height:n,mask:s,pixels:[...t.pixels]});if(P===0&&L===0&&k===r&&F===n)return t;const V=t.mask;for(let z=L;z<=F;z++)for(let G=P;G<=k;G++){const H=z*r+G;s[H]=V?V[H]:255}return new de({pixelType:t.pixelType,width:r,height:n,mask:s,pixels:[...t.pixels]})}function BBe(t,e,i){const{width:r,height:n}=t,s=new Uint8Array(r*n),o=e.width/r,a=e.height/n,{xmin:l,ymax:c}=e,{paths:u}=i,h=t.mask;for(let f=0;f<u.length;f++){const m=u[f];for(let g=0;g<m.length-1;g++){const[y,v]=m[g],[b,w]=m[g+1];let x=Math.floor((c-v)/a),S=Math.floor((c-w)/a);if(S<x){const T=x;x=S,S=T}x=Math.max(0,x),S=Math.min(n-1,S);const I=(b-y)/(w-v);for(let T=x;T<=S;T++){const C=T===x?Math.max(v,w):(n+1-T)*a,E=T===S?Math.min(v,w):C-a;let $=Math.floor(w===v?(y-l)/o:(I*(C-v)+y-l)/o),P=Math.floor(w===v?(b-l)/o:(I*(E-v)+y-l)/o);if(P<$){const L=$;$=P,P=L}const k=T*r;$=Math.max(0,$),P=Math.min(r-1,P);for(let L=k+$;L<=k+P;L++)s[L]=h?h[L]:255}}}return new de({pixelType:t.pixelType,width:r,height:n,mask:s,pixels:[...t.pixels]})}function UBe(t,e,i,r=!0){const{spatialReference:n}=t,{x:s,y:o}=NBe(i,n);let a,l,c;const u=e.type==="extent"?e:e.extent;let{xmin:h,xmax:f,ymax:m,ymin:g}=u;const{xmin:y,ymax:v}=t.extent;return r?(h=y+(h>y?s*Math.round((h-y)/s):0),m=v-(m<v?o*Math.round((v-m)/o):0),f=y+(f>y?s*Math.round((f-y)/s):0),g=v-(g<v?o*Math.round((v-g)/o):0),a=new Re({xmin:h,ymax:m,xmax:f,ymin:g,spatialReference:n}),l=Math.round(a.width/s),c=Math.round(a.height/o)):(l=Math.floor((f-h)/s+.8),c=Math.floor((m-g)/o+.8),h=y+(h>y?s*Math.floor((h-y)/s+.1):0),m=v-(m<v?o*Math.floor((v-m)/o+.1):0),f=h+l*s,g=m-c*o,a=new Re({xmin:h,ymax:m,xmax:f,ymin:g,spatialReference:n})),{extent:a,width:l,height:c}}let $A=class extends te{constructor(){super(...arguments),this.raster=void 0}};d([p({json:{write:!0}})],$A.prototype,"raster",void 0),$A=d([A("esri.layers.support.rasterFunctions.AspectFunctionArguments")],$A);const Uo=$A;var Gz;let Hz=Gz=class extends Uo{clone(){return new Gz({raster:this.raster})}};Hz=Gz=d([A("esri.layers.support.rasterFunctions.AspectFunctionArguments")],Hz);const GBe=Hz;var qz;function Ug(t){return t=Number(t),isNaN(t)?void 0:t}let Bc=qz=class extends te{constructor(){super(...arguments),this.name=null,this.minWavelength=void 0,this.maxWavelength=void 0,this.radianceBias=void 0,this.radianceGain=void 0,this.reflectanceBias=void 0,this.reflectanceGain=void 0,this.solarIrradiance=void 0}clone(){return new qz({name:this.name,minWavelength:this.minWavelength,maxWavelength:this.maxWavelength,radianceBias:this.radianceBias,radianceGain:this.radianceGain,reflectanceBias:this.reflectanceBias,reflectanceGain:this.reflectanceGain,solarIrradiance:this.solarIrradiance})}};d([p({json:{name:"BandName",write:!0}})],Bc.prototype,"name",void 0),d([p({json:{name:"WavelengthMin",read:{reader:Ug},write:!0}})],Bc.prototype,"minWavelength",void 0),d([p({json:{name:"WavelengthMax",read:{reader:Ug},write:!0}})],Bc.prototype,"maxWavelength",void 0),d([p({json:{name:"RadianceBias",read:{reader:Ug},write:!0}})],Bc.prototype,"radianceBias",void 0),d([p({json:{name:"RadianceGain",read:{reader:Ug},write:!0}})],Bc.prototype,"radianceGain",void 0),d([p({json:{name:"ReflectanceBias",read:{reader:Ug},write:!0}})],Bc.prototype,"reflectanceBias",void 0),d([p({json:{name:"ReflectanceGain",read:{reader:Ug},write:!0}})],Bc.prototype,"reflectanceGain",void 0),d([p({json:{name:"SolarIrradiance",read:{reader:Ug},write:!0}})],Bc.prototype,"solarIrradiance",void 0),Bc=qz=d([A("esri.layers.support.RasterBandInfo")],Bc);const kY=Bc;var Wz;function Nx(t){return t=Number(t),isNaN(t)?void 0:t}let Da=Wz=class extends te{constructor(){super(...arguments),this.acquisitionDate=void 0,this.cloudCover=void 0,this.productName=void 0,this.sensorName=null,this.sensorAzimuth=void 0,this.sensorElevation=void 0,this.sunAzimuth=void 0,this.sunElevation=void 0}readAcquisitionDate(t){return new Date(t)}writeAcquisitionDate(t,e){e.AcquisitionDate=t.getTime()}clone(){return new Wz({acquisitionDate:this.acquisitionDate,cloudCover:this.cloudCover,productName:this.productName,sensorName:this.sensorName,sensorAzimuth:this.sensorAzimuth,sensorElevation:this.sensorElevation,sunAzimuth:this.sunAzimuth,sunElevation:this.sunElevation})}};d([p({json:{name:"AcquisitionDate",write:!0}})],Da.prototype,"acquisitionDate",void 0),d([ae("acquisitionDate")],Da.prototype,"readAcquisitionDate",null),d([ge("acquisitionDate")],Da.prototype,"writeAcquisitionDate",null),d([p({json:{name:"CloudCover",read:{reader:Nx},write:!0}})],Da.prototype,"cloudCover",void 0),d([p({json:{name:"ProductName",write:!0}})],Da.prototype,"productName",void 0),d([p({json:{name:"SensorName",write:!0}})],Da.prototype,"sensorName",void 0),d([p({json:{name:"SensorAzimuth",read:{reader:Nx},write:!0}})],Da.prototype,"sensorAzimuth",void 0),d([p({json:{name:"SensorElevation",read:{reader:Nx},write:!0}})],Da.prototype,"sensorElevation",void 0),d([p({json:{name:"SunAzimuth",read:{reader:Nx},write:!0}})],Da.prototype,"sunAzimuth",void 0),d([p({json:{name:"SunElevation",read:{reader:Nx},write:!0}})],Da.prototype,"sunElevation",void 0),Da=Wz=d([A("esri.layers.support.RasterSensorInfo")],Da);const HBe=Da;var Jz;let Di=Jz=class extends te{constructor(t){super(t),this.attributeTable=null,this.bandCount=null,this.colormap=null,this.extent=null,this.format=void 0,this.height=null,this.width=null,this.histograms=null,this.keyProperties={},this.multidimensionalInfo=null,this.noDataValue=null,this.pixelSize=null,this.pixelType=null,this.isPseudoSpatialReference=!1,this.spatialReference=null,this.statistics=null,this.storageInfo=null,this.transform=null}get bandInfos(){const t=this.keyProperties.BandProperties;if(!(t!=null&&t.length)){const i=[];for(let r=1;r<=this.bandCount;r++)i.push(new kY({name:"band_"+r}));return i}const e=t.map(i=>kY.fromJSON(i));for(let i=0;i<e.length;i++)e[i].name=e[i].name??"band_"+(i+1);return e}get dataType(){var e,i;const t=((i=(e=this.keyProperties)==null?void 0:e.DataType)==null?void 0:i.toLowerCase())??"generic";return t==="stdtime"?"standard-time":t}get nativeExtent(){return this._get("nativeExtent")||this.extent}set nativeExtent(t){t&&this._set("nativeExtent",t)}get nativePixelSize(){if(this.transform==null||!this.transform.affectsPixelSize)return this.pixelSize;const t=this.nativeExtent;return{x:t.width/this.width,y:t.height/this.height}}get hasMultidimensionalTranspose(){var t;return!!((t=this.storageInfo)!=null&&t.transposeInfo)}get sensorInfo(){var t;if((t=this.keyProperties)!=null&&t.SensorName)return HBe.fromJSON(this.keyProperties)}clone(){return new Jz({attributeTable:U(this.attributeTable),bandCount:this.bandCount,colormap:U(this.colormap),extent:U(this.extent),nativePixelSize:U(this.nativePixelSize),format:this.format,height:this.height,width:this.width,histograms:U(this.histograms),keyProperties:U(this.keyProperties),multidimensionalInfo:U(this.multidimensionalInfo),noDataValue:this.noDataValue,pixelSize:U(this.pixelSize),pixelType:this.pixelType,isPseudoSpatialReference:this.isPseudoSpatialReference,spatialReference:U(this.spatialReference),statistics:U(this.statistics),storageInfo:U(this.storageInfo),transform:U(this.transform)})}};d([p({json:{write:!0}})],Di.prototype,"attributeTable",void 0),d([p({json:{write:!0}})],Di.prototype,"bandCount",void 0),d([p({readOnly:!0})],Di.prototype,"bandInfos",null),d([p({json:{write:!0}})],Di.prototype,"colormap",void 0),d([p({type:String,readOnly:!0})],Di.prototype,"dataType",null),d([p({type:Re,json:{write:!0}})],Di.prototype,"extent",void 0),d([p({type:Re,json:{write:!0}})],Di.prototype,"nativeExtent",null),d([p({json:{write:!0}})],Di.prototype,"nativePixelSize",null),d([p({json:{write:!0}})],Di.prototype,"format",void 0),d([p({json:{write:!0}})],Di.prototype,"height",void 0),d([p({json:{write:!0}})],Di.prototype,"width",void 0),d([p({json:{write:!0}})],Di.prototype,"hasMultidimensionalTranspose",null),d([p({json:{write:!0}})],Di.prototype,"histograms",void 0),d([p({json:{write:!0}})],Di.prototype,"keyProperties",void 0),d([p({json:{write:!0}})],Di.prototype,"multidimensionalInfo",void 0),d([p({json:{write:!0}})],Di.prototype,"noDataValue",void 0),d([p({json:{write:!0}})],Di.prototype,"pixelSize",void 0),d([p({json:{write:!0}})],Di.prototype,"pixelType",void 0),d([p()],Di.prototype,"isPseudoSpatialReference",void 0),d([p({readOnly:!0})],Di.prototype,"sensorInfo",null),d([p({type:Ee,json:{write:!0}})],Di.prototype,"spatialReference",void 0),d([p({json:{write:!0}})],Di.prototype,"statistics",void 0),d([p({type:nx,json:{write:!0}})],Di.prototype,"storageInfo",void 0),d([p({json:{write:!0}})],Di.prototype,"transform",void 0),Di=Jz=d([A("esri.layers.support.RasterInfo")],Di);const Ap=Di,qBe=new Set(["slope","aspect","curvature","hillshade","shadedrelief"]);let Zr=class extends te{constructor(){super(...arguments),this.functionArguments=null,this.readingBufferSize=0,this.id=-1,this.isNoopProcess=!1,this.rawInputBandIds=[],this.isInputBandIdsSwizzled=!1,this.swizzledBandSelection=[],this.isBranch=!1,this._bindingResult=null}get supportsGPU(){return this._bindingResult.supportsGPU}get flatWebGLFunctionChain(){const e=this.getWebGLProcessorDefinition();if(!e)return null;const i=[e],{parameters:r}=e;let n=r.rasters||r.raster&&[r.raster];for(;n!=null&&n.length;){i.unshift(...n);const a=[];for(let l=0;l<n.length;l++){const{parameters:c}=n[l],u=c.rasters||c.raster&&[c.raster];u!=null&&u.length&&a.push(...u)}n=a}for(let a=i.length-1;a>=0;a--)i[a].isNoopProcess&&i.splice(a,1);let s=!1;for(let a=0;a<i.length;a++){const l=i[a];l.id=i.length-a-1;const{rasters:c}=l.parameters;s=s||c!=null&&c.length>1}const o=i.some(({name:a})=>qBe.has(a.toLowerCase()));return{functions:i,hasBranches:s,hasSurfaceFunction:o}}bind(e,i=!1,r=-1){this.id=r+1;const n=this._getRasterValues();let s=!0;for(let o=0;o<n.length;o++){const a=n[o];if(a!=null&&this._isRasterFunctionValue(a)){const l=a.bind(e,i,this.id+o);if(!l.success)return this._bindingResult=l,l;s=s&&l.supportsGPU}}return!this.rasterInfo||i?(this.sourceRasterInfos=this._getSourceRasterInfos(e),this._bindingResult=this._bindSourceRasters(),this._bindingResult.success&&this._patchRasterInfo(),this._bindingResult.supportsGPU=s&&this._bindingResult.supportsGPU,this.processInputBandIds(),this._bindingResult):(this._bindingResult={success:!0,supportsGPU:!0},this.processInputBandIds(),this._bindingResult)}process(e){const i=this._getRasterValues(),r=i.length===0?e.pixelBlocks??e.primaryPixelBlocks:i.map(n=>this._readRasterValue(n,e));return this._processPixels({...e,pixelBlocks:r})}processInputBandIds(){const e=this._getRasterValues().filter(this._isRasterFunctionValue);let i;if(e.length>1){const s=e.map(a=>a.processInputBandIds()[0]);this.rawInputBandIds=s,this.isInputBandIdsSwizzled=this.rawInputBandIds.some((a,l)=>a!==l);const o=e.filter(a=>a.functionName==="ExtractBand");return o.length&&o.forEach((a,l)=>{a.isInputBandIdsSwizzled=!0,a.swizzledBandSelection=[l,l,l]}),this.rawInputBandIds}const r=e[0];if(r){if(i=r.processInputBandIds(),r.isInputBandIdsSwizzled)return this.rawInputBandIds=i,i}else{i=[];const{bandCount:s}=this.sourceRasterInfos[0];for(let o=0;o<s;o++)i.push(o)}const n=this._getInputBandIds(i);return this.isInputBandIdsSwizzled=n.some((s,o)=>s!==o),this.rawInputBandIds=n,this.rawInputBandIds}getPrimaryRasters(){const e=[],i=[];return this._getPrimaryRasters(this,e,i),{rasters:e,rasterIds:i}}getWebGLProcessorDefinition(){const e=this._getWebGLParameters(),{raster:i,rasters:r}=this.functionArguments;return r&&Array.isArray(r)&&r.length?(e.rasters=r.map(n=>this._isRasterFunctionValue(n)?n.getWebGLProcessorDefinition():typeof n=="number"?{name:"Constant",parameters:{value:n},pixelType:"f32",id:-1,isNoopProcess:!1}:{name:"Identity",parameters:{value:n},pixelType:"f32",id:-1,isNoopProcess:!1}),e.rasters.some(n=>n!=null)||(e.rasters=null)):this._isRasterFunctionValue(i)&&(e.raster=i.getWebGLProcessorDefinition()),{name:this.functionName,parameters:e,pixelType:this.outputPixelType,id:this.id,isNoopProcess:this.isNoopProcess}}_getOutputPixelType(e){return this.outputPixelType==="unknown"?e:this.outputPixelType??e}_getWebGLParameters(){return{}}_getInputBandIds(e){return e}_isOutputRoundingNeeded(){const{outputPixelType:e}=this;return((e==null?void 0:e.startsWith("u"))||(e==null?void 0:e.startsWith("s")))??!1}_getRasterValues(){const{rasterArgumentNames:e}=this;return e[0]==="rasters"?this.functionArguments.rasters??[]:e.map(i=>this.functionArguments[i]).flat()}_getSourceRasterInfos(e){const i=this._getRasterValues(),{rasterInfos:r,rasterIds:n}=e;if(i.length===0)return r;const s=i.map(a=>a&&typeof a=="object"&&"bind"in a&&a.rasterInfo?a.rasterInfo:typeof a=="string"&&n.includes(a)?r[n.indexOf(a)]:typeof a!="number"?r[0]:void 0),o=s.find(a=>a)??r[0];return s.forEach((a,l)=>{a===void 0&&(s[l]=o)}),s}_getPrimaryRasterId(e){return e==null?void 0:e.url}_getPrimaryRasters(e,i=[],r=[]){for(let n=0;n<e.sourceRasters.length;n++){const s=e.sourceRasters[n];if(typeof s!="number")if("bind"in s)this._getPrimaryRasters(s,i,r);else{const o=s,a=this._getPrimaryRasterId(o);if(a==null)continue;r.includes(a)||(this.mainPrimaryRasterId===a?(i.unshift(o),r.unshift(a)):(i.push(o),r.push(a)))}}}_isRasterFunctionValue(e){return e!=null&&typeof e=="object"&&"getWebGLProcessorDefinition"in e}_readRasterValue(e,i){const{primaryPixelBlocks:r}=i;if(e==null||e==="$$"){const n=r[0];return n==null?null:n.clone()}if(typeof e=="string"){const n=i.primaryRasterIds.indexOf(e);return n===-1?null:r[n]}if(typeof e=="number"){const n=r[0];if(n==null)return null;const{width:s,height:o,pixelType:a,mask:l}=n,c=l?new Uint8Array(l):null,u=new Float32Array(s*o);u.fill(e);const h=this.sourceRasterInfos[0].bandCount,f=new Array(h).fill(u);return new de({width:s,height:o,pixelType:a,pixels:f,mask:c})}return e.process(i)}_patchRasterInfo(){const{rasterInfo:e}=this;if(!(e!=null&&e.keyProperties))return;const{bandCount:i,keyProperties:r,statistics:n,histograms:s}=e,o=r.BandProperties;o&&o.length!==i&&(e.keyProperties={...r,BandProperties:void 0}),n&&n.length!==i&&(e.statistics=n.length>i?n.slice(0,i):null),s&&s.length!==i&&(e.histograms=s.length>i?s.slice(0,i):null),r.BAND_COUNT&&Number(r.BAND_COUNT)!==i&&(e.keyProperties={...r,BAND_COUNT:typeof r.BAND_COUNT=="string"?String(i):i})}};d([p({json:{write:!0}})],Zr.prototype,"functionName",void 0),d([p({json:{write:!0}})],Zr.prototype,"functionArguments",void 0),d([p()],Zr.prototype,"rasterArgumentNames",void 0),d([p({json:{write:!0}}),tt(t=>t==null?void 0:t.toLowerCase())],Zr.prototype,"outputPixelType",void 0),d([p({json:{write:!0}})],Zr.prototype,"mainPrimaryRasterId",void 0),d([p()],Zr.prototype,"sourceRasters",void 0),d([p({type:[Ap],json:{write:!0}})],Zr.prototype,"sourceRasterInfos",void 0),d([p({json:{write:!0}})],Zr.prototype,"rasterInfo",void 0),d([p({json:{write:!0}})],Zr.prototype,"readingBufferSize",void 0),d([p({json:{write:!0}})],Zr.prototype,"id",void 0),d([p()],Zr.prototype,"isNoopProcess",void 0),d([p()],Zr.prototype,"supportsGPU",null),d([p()],Zr.prototype,"rawInputBandIds",void 0),d([p()],Zr.prototype,"isInputBandIdsSwizzled",void 0),d([p()],Zr.prototype,"swizzledBandSelection",void 0),d([p()],Zr.prototype,"isBranch",void 0),d([p()],Zr.prototype,"flatWebGLFunctionChain",null),d([p()],Zr.prototype,"_bindingResult",void 0),Zr=d([A("esri.layers.support.rasterFunctions.BaseRasterFunction")],Zr);const Go=Zr,oo=1,Yh=1/111e3;function Afe(t){let{altitude:e,azimuth:i}=t;const{hillshadeType:r,pixelSizePower:n=1,pixelSizeFactor:s=1,scalingType:o,isGCS:a,resolution:l}=t,c=r==="multi-directional"?2*t.zFactor:t.zFactor,{x:u,y:h}=l;let f=c/(8*u),m=c/(8*h);if(a&&c>.001&&(f/=Yh,m/=Yh),o==="adjusted")if(a){const L=u*Yh,F=h*Yh;f=(c+L**n*s)/(8*L),m=(c+F**n*s)/(8*F)}else f=(c+u**n*s)/(8*u),m=(c+h**n*s)/(8*h);let g=(90-e)*Math.PI/180,y=Math.cos(g),v=(360-i+90)*Math.PI/180,b=Math.sin(g)*Math.cos(v),w=Math.sin(g)*Math.sin(v);const x=[315,270,225,360,180,0],S=[60,60,60,60,60,90],I=new Float32Array([3,5,3,2,1,4]),T=I.reduce((L,F)=>L+F),C=I.map(L=>L/T),E=r==="multi-directional"?x.length:1,$=new Float32Array(6),P=new Float32Array(6),k=new Float32Array(6);if(r==="multi-directional")for(let L=0;L<E;L++)e=S[L],i=x[L],g=(90-e)*Math.PI/180,y=Math.cos(g),v=(360-i+90)*Math.PI/180,b=Math.sin(g)*Math.cos(v),w=Math.sin(g)*Math.sin(v),$[L]=y,P[L]=b,k[L]=w;else $.fill(y),P.fill(b),k.fill(w);return{resolution:l,factor:[f,m],sinZcosA:b,sinZsinA:w,cosZ:y,sinZcosAs:P,sinZsinAs:k,cosZs:$,weights:C,hillshadeType:["traditional","multi-directional"].indexOf(r)}}function tR(t,e){const{width:i,height:r}=t,n=i*r,s=new Uint8Array(n),o=t.mask!=null;let a;if(o){a=new Uint8Array(t.mask);for(let T=0;T<a.length;T++)a[T]&&(s[T]=1,a[T]=1)}const l=t.pixels[0],c=new Float32Array(n),u=new Float32Array(n);let h,f=0;if(e){const{resolution:T}=e,C=T?(T.x+T.y)/2:1;f=200*e.zFactor/(C*C),h=new Float32Array(n)}const m=e==null?void 0:e.curvatureType;let g,y,v,b,w,x,S,I;for(let T=oo;T<r-oo;T++){const C=T*i;for(let E=oo;E<i-oo;E++){const $=C+E;if(!a||a[$]!==0){if(a){if(a[$-i-1]+a[$-i]+a[$-i+1]+a[$-1]+a[$+1]+a[$+i-1]+a[$+i]+a[$+i+1]<7){s[$]=0;continue}g=a[$-i-1]?l[$-i-1]:l[$],y=a[$-i]?l[$-i]:l[$],v=a[$-i+1]?l[$-i+1]:l[$],b=a[$-1]?l[$-1]:l[$],w=a[$+1]?l[$+1]:l[$],x=a[$+i-1]?l[$+i-1]:l[$],S=a[$+i]?l[$+i]:l[$],I=a[$+i+1]?l[$+i+1]:l[$]}else g=l[$-i-1],y=l[$-i],v=l[$-i+1],b=l[$-1],w=l[$+1],x=l[$+i-1],S=l[$+i],I=l[$+i+1];if(c[$]=v+w+w+I-(g+b+b+x),u[$]=x+S+S+I-(g+y+y+v),h!=null){const P=l[$],k=.5*(b+w)-P,L=.5*(y+S)-P;if(m==="standard")h[$]=-f*(k+L);else{const F=(-g+v+x-I)/4,V=(-b+w)/2,z=(y-S)/2,G=V*V,H=z*z,Z=G+H;Z&&(h[$]=m==="profile"?f*(k*G+L*H+F*V*z)/Z:-f*(k*H+L*G-F*V*z)/Z)}}}}}return{outMask:o?s:null,dzxs:c,dzys:u,curvatures:h}}function iR(t,e,i){for(let r=0;r<i;r++)t[r*e]=t[r*e+1],t[(r+1)*e-1]=t[(r+1)*e-2];for(let r=1;r<e-1;r++)t[r]=t[r+e],t[r+(i-1)*e]=t[r+(i-2)*e]}function WBe(t,e){if(!Gi(t))return t;const{factor:i,sinZcosA:r,sinZsinA:n,cosZ:s,sinZcosAs:o,sinZsinAs:a,cosZs:l,weights:c}=Afe(e),[u,h]=i,f=e.hillshadeType==="traditional",{width:m,height:g}=t,y=new Uint8Array(m*g),{dzxs:v,dzys:b,outMask:w}=tR(t);for(let x=oo;x<g-oo;x++){const S=x*m;for(let I=oo;I<m-oo;I++){const T=S+I;if(!w||w[T]){const C=v[T]*u,E=b[T]*h,$=Math.sqrt(1+C*C+E*E);let P=0;if(f){let k=255*(s+n*E-r*C)/$;k<0&&(k=0),P=k}else{const k=a.length;for(let L=0;L<k;L++){let F=255*(l[L]+a[L]*E-o[L]*C)/$;F<0&&(F=0),P+=F*c[L]}}y[T]=255&P}}}return iR(y,m,g),new de({width:m,height:g,pixels:[y],mask:w,pixelType:"u8",validPixelCount:t.validPixelCount,statistics:[{minValue:0,maxValue:255}]})}function JBe(t,e,i,r){if(!Gi(t)||!Gi(e))return;const{min:n,max:s}=r,o=t.pixels[0],{pixels:a,mask:l}=e,c=a[0],u=255.00001/(s-n),h=new Uint8ClampedArray(c.length),f=new Uint8ClampedArray(c.length),m=new Uint8ClampedArray(c.length),g=i.length-1;for(let y=0;y<c.length;y++){if(l&&l[y]===0)continue;const v=Math.floor((c[y]-n)*u),[b,w]=i[v<0?0:v>g?g:v],x=o[y],S=x*w,I=S*(1-Math.abs(b%2-1)),T=x-S;switch(Math.floor(b)){case 0:h[y]=S+T,f[y]=I+T,m[y]=T;break;case 1:h[y]=I+T,f[y]=S+T,m[y]=T;break;case 2:h[y]=T,f[y]=S+T,m[y]=I+T;break;case 3:h[y]=T,f[y]=I+T,m[y]=S+T;break;case 4:h[y]=I+T,f[y]=T,m[y]=S+T;break;case 5:case 6:h[y]=S+T,f[y]=T,m[y]=I+T}}t.pixels=[h,f,m],t.updateStatistics()}function ZBe(t,e){if(!Gi(t))return t;const i=e.zFactor,r=e.pixelSizePower??1,n=e.pixelSizeFactor??1,s=e.slopeType,o=e.isGCS,{x:a,y:l}=e.resolution;let c=i/(8*a),u=i/(8*l);o&&Math.abs(i-1)<1e-4&&(c/=Yh,u/=Yh),s==="adjusted"&&(c=(i+a**r*n)/(8*a),u=(i+l**r*n)/(8*l));const{dzxs:h,dzys:f,outMask:m}=tR(t),{width:g,height:y}=t,v=new Float32Array(g*y);for(let w=oo;w<y-oo;w++){const x=w*g;for(let S=oo;S<g-oo;S++){const I=x+S;if(!m||m[I]){const T=h[I]*c,C=f[I]*u,E=Math.sqrt(T*T+C*C);v[x+S]=s==="percent-rise"?100*E:57.2957795*Math.atan(E)}}}iR(v,g,y);const b=new de({width:g,height:y,pixels:[v],mask:m,pixelType:"f32",validPixelCount:t.validPixelCount});return b.updateStatistics(),b}function YBe(t,e={}){if(!Gi(t))return t;const{resolution:i}=e,r=i?1/i.x:1,n=i?1/i.y:1,{dzxs:s,dzys:o,outMask:a}=tR(t),{width:l,height:c}=t,u=new Float32Array(l*c);for(let h=oo;h<c-oo;h++){const f=h*l;for(let m=oo;m<l-oo;m++){const g=f+m;if(!a||a[g]){const y=s[g]*r,v=o[g]*n;let b=-1;y===0&&v===0||(b=90-57.29578*Math.atan2(v,-y),b<0&&(b+=360),b===360?b=0:b>360&&(b%=360)),u[f+m]=b}}}return iR(u,l,c),new de({width:l,height:c,pixels:[u],mask:a,pixelType:"f32",validPixelCount:t.validPixelCount,statistics:[{minValue:-1,maxValue:360}]})}function KBe(t,e){if(!Gi(t))return t;const{curvatures:i,outMask:r}=tR(t,e),{width:n,height:s}=t;iR(i,n,s);const o=new de({width:n,height:s,pixels:[i],mask:r,pixelType:"f32",validPixelCount:t.validPixelCount});return o.updateStatistics(),o}let Hy=class extends Go{constructor(){super(...arguments),this.functionName="Aspect",this.functionArguments=null,this.rasterArgumentNames=["raster"],this.isGCS=!1}_bindSourceRasters(){var r;const e=this.sourceRasterInfos[0];this.isGCS=((r=e.spatialReference)==null?void 0:r.isGeographic)??!1,this.outputPixelType=this._getOutputPixelType("f32");const i=e.clone();return i.pixelType=this.outputPixelType,i.statistics=[{min:-1,max:360,avg:180,stddev:30}],i.histograms=null,i.colormap=null,i.attributeTable=null,i.bandCount=1,this.rasterInfo=i,{success:!0,supportsGPU:!0}}_processPixels(e){var a;const i=(a=e.pixelBlocks)==null?void 0:a[0];if(i==null)return null;const{extent:r,primaryPixelSizes:n}=e,s=n==null?void 0:n[0],o=s??(r?{x:r.width/i.width,y:r.height/i.height}:{x:1,y:1});return YBe(i,{resolution:o})}};d([p({json:{write:!0,name:"rasterFunction"}})],Hy.prototype,"functionName",void 0),d([p({type:GBe,json:{write:!0,name:"rasterFunctionArguments"}})],Hy.prototype,"functionArguments",void 0),d([p()],Hy.prototype,"rasterArgumentNames",void 0),d([p({json:{write:!0}})],Hy.prototype,"isGCS",void 0),Hy=d([A("esri.layers.support.rasterFunctions.AspectFunction")],Hy);const XBe=Hy,QBe=new Set(["+","-","*","/","(",")"]);function eUe(t,e){(t=t.replaceAll(" ","")).startsWith("-")&&(t="0"+t),t.startsWith("+")&&(t=t.slice(1,t.length));const i=t.split(""),r=[],n=[];let s="";for(let o=0;o<i.length;o++){const a=i[o];if(QBe.has(a))s!==""&&n.push(parseFloat(s)),r.push(a),s="";else{if(a.toLowerCase()==="b"){o++,s=a.concat(i[o]),n.push(e[parseInt(s[1],10)-1]),s="";continue}s=s.concat(a),o===i.length-1&&n.push(parseFloat(s))}}return{ops:r,nums:n}}function tUe(t,e,i,r){if(typeof i=="number"&&typeof r=="number")return i+r;let n,s,o;typeof i=="number"?(o=r,n=o.length,s=new Float32Array(n),s.fill(i)):(n=i.length,s=i,r.constructor===Number?(o=new Float32Array(n),o.fill(r)):o=r);const a=new Float32Array(n);switch(e){case"+":for(let l=0;l<n;l++)(t==null||t[l])&&(a[l]=s[l]+o[l]);break;case"-":for(let l=0;l<n;l++)(t==null||t[l])&&(a[l]=s[l]-o[l]);break;case"*":for(let l=0;l<n;l++)(t==null||t[l])&&(a[l]=s[l]*o[l]);break;case"/":for(let l=0;l<n;l++)(t==null||t[l])&&o[l]&&(a[l]=s[l]/o[l]);break;case"(":case")":throw new Error("encountered error with custom band index equation")}return a}function iUe(t,e){t.splice(e,1);let i=0,r=0;do{i=0,r=0;for(let n=0;n<t.length;n++)if(t[n]==="(")i=n;else if(t[n]===")"){r=n;break}r===i+1&&t.splice(i,2)}while(r===i+1);return t}function rUe(t){if(t.length===1)return{opIndex:0,numIndex:0};let e=0,i=0;for(let o=0;o<t.length;o++)if(t[o]==="(")e=o;else if(t[o]===")"){i=o;break}const r=i===0?t:t.slice(e+1,i);let n=-1;for(let o=0;o<r.length;o++)if(r[o]==="*"||r[o]==="/"){n=o;break}if(n>-1)i>0&&(n+=e+1);else{for(let o=0;o<r.length;o++)if(r[o]==="+"||r[o]==="-"){n=o;break}i>0&&(n+=e+1)}let s=0;for(let o=0;o<n;o++)t[o]==="("&&s++;return{opIndex:n,numIndex:n-s}}function nUe(t,e,i){let r,{ops:n,nums:s}=eUe(i,e);if(n.length===0){const o=s.length===1?s[0]:e[0];if(o instanceof Float32Array)return[o];const a=new Float32Array(e[0].length);return typeof o=="number"?a.fill(o):a.set(o),[a]}for(;n.length>0;){const{numIndex:o,opIndex:a}=rUe(n);if(r=tUe(t,n[a],s[o],s[o+1]),n.length===1)break;n=iUe(n,a),s.splice(o,2,r)}return[r]}const sUe=new He({0:"custom",1:"ndvi",2:"savi",3:"tsavi",4:"msavi",5:"gemi",6:"pvi",7:"gvitm",8:"sultan",9:"vari",10:"gndvi",11:"sr",12:"ndvi-re",13:"sr-re",14:"mtvi2",15:"rtvi-core",16:"ci-re",17:"ci-g",18:"ndwi",19:"evi",20:"iron-oxide",21:"ferrous-minerals",22:"clay-minerals",23:"wndwi",24:"bai",25:"nbr",26:"ndbi",27:"ndmi",28:"ndsi",29:"mndwi"},{useNumericKeys:!0});function oUe(t,e){if(!Gi(t))return t;const{equation:i,method:r}=e,n=e.bandIndexes.map(u=>u-1),{pixels:s,mask:o}=t;let a;switch(r){case"gndvi":case"nbr":case"ndbi":case"ndvi":case"ndvi-re":case"ndsi":case"ndmi":case"mndwi":a=PY(o,s[n[0]],s[n[1]]);break;case"ndwi":a=PY(o,s[n[1]],s[n[0]]);break;case"sr":case"sr-re":case"iron-oxide":case"ferrous-minerals":case"clay-minerals":a=lUe(o,s[n[0]],s[n[1]]);break;case"ci-g":case"ci-re":a=cUe(o,s[n[0]],s[n[1]]);break;case"savi":a=uUe(o,s[n[0]],s[n[1]],n[2]+1);break;case"tsavi":a=dUe(o,s[n[0]],s[n[1]],n[2]+1,n[3]+1,n[4]+1);break;case"msavi":a=hUe(o,s[n[0]],s[n[1]]);break;case"gemi":a=pUe(o,s[n[0]],s[n[1]]);break;case"pvi":a=fUe(o,s[n[0]],s[n[1]],n[2]+1,n[3]+1);break;case"gvitm":a=mUe(o,[s[n[0]],s[n[1]],s[n[2]],s[n[3]],s[n[4]],s[n[5]]]);break;case"sultan":a=gUe(o,[s[n[0]],s[n[1]],s[n[2]],s[n[3]],s[n[4]],s[n[5]]]);break;case"vari":a=yUe(o,[s[n[0]],s[n[1]],s[n[2]]]);break;case"mtvi2":a=vUe(o,[s[n[0]],s[n[1]],s[n[2]]]);break;case"rtvi-core":a=_Ue(o,[s[n[0]],s[n[1]],s[n[2]]]);break;case"evi":a=bUe(o,[s[n[0]],s[n[1]],s[n[2]]]);break;case"wndwi":a=wUe(o,[s[n[0]],s[n[1]],s[n[2]]],n[3]?n[3]+1:.5);break;case"bai":a=xUe(o,s[n[0]],s[n[1]]);break;case"custom":a=nUe(o,s,i);break;default:return t}const l=o!=null?new Uint8Array(o.length):null;o!=null&&l!=null&&l.set(o);const c=new de({width:t.width,height:t.height,pixelType:"f32",pixels:a,mask:l});return c.updateStatistics(),c}function aUe(t,e,i,r){const{mask:n,pixels:s,width:o,height:a}=t,l=s[i],c=s[e],u=c.length,h=r?new Uint8Array(u):new Float32Array(u),f=r?100:1,m=r?100.5:0;for(let y=0;y<u;y++)if(n==null||n[y]){const v=l[y],b=c[y],w=v+b;w&&(h[y]=(v-b)/w*f+m)}const g=new de({width:o,height:a,mask:n,pixelType:r?"u8":"f32",pixels:[h]});return g.updateStatistics(),g}function os(t){const e=new Float32Array(9);return e[3*t[0]]=1,e[3*t[1]+1]=1,e[3*t[2]+2]=1,e}function PY(t,e,i){const r=i.length,n=new Float32Array(r);for(let s=0;s<r;s++)if(t==null||t[s]){const o=e[s],a=i[s],l=o+a;l&&(n[s]=(o-a)/l)}return[n]}function lUe(t,e,i){const r=i.length,n=new Float32Array(r);for(let s=0;s<r;s++)if(t==null||t[s]){const o=e[s],a=i[s];a&&(n[s]=o/a)}return[n]}function cUe(t,e,i){const r=e.length,n=new Float32Array(r);for(let s=0;s<r;s++)if(t==null||t[s]){const o=e[s],a=i[s];a&&(n[s]=o/a-1)}return[n]}function uUe(t,e,i,r){const n=i.length,s=new Float32Array(n);for(let o=0;o<n;o++)if(t==null||t[o]){const a=i[o],l=e[o],c=l+a+r;c&&(s[o]=(l-a)/c*(1+r))}return[s]}function dUe(t,e,i,r,n,s){const o=i.length,a=new Float32Array(o),l=-n*r+s*(1+r*r);for(let c=0;c<o;c++)if(t==null||t[c]){const u=i[c],h=e[c],f=n*h+u+l;f&&(a[c]=r*(h-r*u-n)/f)}return[a]}function hUe(t,e,i){const r=i.length,n=new Float32Array(r);for(let s=0;s<r;s++)if(t==null||t[s]){const o=i[s],a=e[s];n[s]=.5*(2*(a+1)-Math.sqrt((2*a+1)**2-8*(a-o)))}return[n]}function pUe(t,e,i){const r=i.length,n=new Float32Array(r);for(let s=0;s<r;s++)if(t==null||t[s]){const o=i[s],a=e[s];if(o!==1){const l=(2*(a*a-o*o)+1.5*a+.5*o)/(a+o+.5);n[s]=l*(1-.25*l)-(o-.125)/(1-o)}}return[n]}function fUe(t,e,i,r,n){const s=i.length,o=new Float32Array(s),a=Math.sqrt(1+r*r);for(let l=0;l<s;l++)if(t==null||t[l]){const c=i[l],u=e[l];o[l]=(u-r*c-n)/a}return[o]}function mUe(t,e){const[i,r,n,s,o,a]=e,l=i.length,c=new Float32Array(l);for(let u=0;u<l;u++)(t==null||t[u])&&(c[u]=-.2848*i[u]-.2435*r[u]-.5436*n[u]+.7243*s[u]+.084*o[u]-1.18*a[u]);return[c]}function gUe(t,e){const[i,,r,n,s,o]=e,a=i.length,l=new Float32Array(a),c=new Float32Array(a),u=new Float32Array(a);for(let h=0;h<a;h++)(t==null||t[h])&&(l[h]=o[h]?s[h]/o[h]*100:0,c[h]=i[h]?s[h]/i[h]*100:0,u[h]=n[h]?r[h]/n[h]*(s[h]/n[h])*100:0);return[l,c,u]}function yUe(t,e){const[i,r,n]=e,s=i.length,o=new Float32Array(s);for(let a=0;a<s;a++)if(t==null||t[a])for(a=0;a<s;a++){const l=i[a],c=r[a],u=c+l-n[a];u&&(o[a]=(c-l)/u)}return[o]}function vUe(t,e){const[i,r,n]=e,s=i.length,o=new Float32Array(s);for(let a=0;a<s;a++)if(t==null||t[a])for(a=0;a<s;a++){const l=i[a],c=r[a],u=n[a],h=Math.sqrt((2*l+1)**2-6*l-5*Math.sqrt(c)-.5);o[a]=1.5*(1.2*(l-u)-2.5*(c-u))*h}return[o]}function _Ue(t,e){const[i,r,n]=e,s=i.length,o=new Float32Array(s);for(let a=0;a<s;a++)if(t==null||t[a])for(a=0;a<s;a++){const l=i[a],c=r[a],u=n[a];o[a]=100*(l-c)-10*(l-u)}return[o]}function bUe(t,e){const[i,r,n]=e,s=i.length,o=new Float32Array(s);for(let a=0;a<s;a++)if(t==null||t[a])for(a=0;a<s;a++){const l=i[a],c=r[a],u=l+6*c-7.5*n[a]+1;u&&(o[a]=2.5*(l-c)/u)}return[o]}function wUe(t,e,i=.5){const[r,n,s]=e,o=n.length,a=new Float32Array(o);for(let l=0;l<o;l++)if(t==null||t[l])for(l=0;l<o;l++){const c=r[l],u=n[l],h=s[l],f=c+i*u+(1-i)*h;f&&(a[l]=(c-i*u-(1-i)*h)/f)}return[a]}function xUe(t,e,i){const r=i.length,n=new Float32Array(r);for(let s=0;s<r;s++)if(t==null||t[s])for(s=0;s<r;s++){const o=(.1-e[s])**2+(.06-i[s])**2;o&&(n[s]=1/o)}return[n]}var Zz;let c2=Zz=class extends Uo{constructor(){super(...arguments),this.method="custom"}clone(){return new Zz({method:this.method,bandIndexes:this.bandIndexes,raster:U(this.raster)})}};d([p({json:{type:String,write:!0}})],c2.prototype,"bandIndexes",void 0),d([xe(sUe)],c2.prototype,"method",void 0),c2=Zz=d([A("esri.layers.support.rasterFunctions.BandArithmeticFunctionArguments")],c2);const SUe=c2,IUe=new Set(["vari","mtvi2","rtvi-core","evi"]);let Cb=class extends Go{constructor(){super(...arguments),this.functionName="BandArithmetic",this.functionArguments=null,this.rasterArgumentNames=["raster"]}_bindSourceRasters(){this.outputPixelType=this._getOutputPixelType("f32");const e=this.sourceRasterInfos[0];if(e.bandCount<2)return{success:!1,supportsGPU:!1,error:"band-arithmetic-function: source raster has insufficient amount of raster bands"};const i=e.clone();return i.pixelType=this.outputPixelType,i.statistics=null,i.histograms=null,i.bandCount=this.functionArguments.method==="sultan"?3:1,i.keyProperties={...i.keyProperties,BandProperties:void 0},this.rasterInfo=i,{success:!0,supportsGPU:!["custom","gvitm","sultan"].includes(this.functionArguments.method)}}_processPixels(e){var o;const i=(o=e.pixelBlocks)==null?void 0:o[0];if(i==null)return i;const{method:r,bandIndexes:n}=this.functionArguments,s=n.split(" ").map(a=>parseFloat(a));return oUe(i,{method:r,bandIndexes:s,equation:n})}_getWebGLParameters(){const e=this.functionArguments.bandIndexes.split(" ").map(a=>parseFloat(a)-1);e.length===2&&e.push(0);const i=this.isInputBandIdsSwizzled?[0,1,2]:e;let r,n;const s=new Float32Array(3),{method:o}=this.functionArguments;switch(o){case"gndvi":case"nbr":case"ndbi":case"ndvi":case"ndvi-re":case"ndsi":case"ndmi":case"mndwi":r=os([i[0],i[1],0]),n="ndxi";break;case"ndwi":r=os([i[1],i[0],0]),n="ndxi";break;case"sr":case"sr-re":case"iron-oxide":case"ferrous-minerals":case"clay-minerals":r=os([i[0],i[1],0]),n="sr";break;case"ci-g":case"ci-re":r=os([i[0],i[1],0]),n="ci";break;case"savi":r=os([i[0],i[1],0]),n="savi",s[0]=e[2]+1;break;case"tsavi":r=os([i[0],i[1],0]),n="tsavi",s[0]=e[2]+1,s[1]=e[3]+1,s[2]=e[4]+1;break;case"msavi":r=os([i[0],i[1],0]),n="msavi";break;case"gemi":r=os([i[0],i[1],0]),n="gemi";break;case"pvi":r=os([i[0],i[1],0]),n="tsavi",s[0]=e[2]+1,s[1]=e[3]+1;break;case"vari":r=os([i[0],i[1],i[2]]),n="vari";break;case"mtvi2":r=os([i[0],i[1],i[2]]),n="mtvi2";break;case"rtvi-core":r=os([i[0],i[1],i[2]]),n="rtvicore";break;case"evi":r=os([i[0],i[1],i[2]]),n="evi";break;case"wndwi":r=os([i[0],i[1],0]),n="wndwi",s[0]=e[3]?e[3]+1:.5;break;case"bai":r=os([i[1],i[0],0]),n="bai";break;default:r=os([0,1,2]),n="custom"}return{bandIndexMat3:r,indexType:n,adjustments:s}}_getInputBandIds(e){if(this.functionArguments.method==="custom")return e;const i=this.functionArguments.bandIndexes.split(" ").map(a=>parseFloat(a)-1),r=e.length,n=i.map(a=>a>=r?r-1:a),s=IUe.has(this.functionArguments.method)?3:2,o=n.slice(0,s).map(a=>e[a]);return o.length===2&&o.push(0),o}};d([p({json:{write:!0,name:"rasterFunction"}})],Cb.prototype,"functionName",void 0),d([p({type:SUe,json:{write:!0,name:"rasterFunctionArguments"}})],Cb.prototype,"functionArguments",void 0),d([p()],Cb.prototype,"rasterArgumentNames",void 0),Cb=d([A("esri.layers.support.rasterFunctions.BandArithmeticFunction")],Cb);const TUe=Cb;var Yz;let id=Yz=class extends Uo{castColormapName(t){if(!t)return null;const e=t.toLowerCase();return Yje.includes(e)?e:null}readColorRamp(t){return kL(t)}readColorRampName(t,e){if(!t)return null;const i=Lw.jsonValues.find(r=>r.toLowerCase()===t.toLowerCase());return i?Lw.fromJSON(i):null}clone(){var t;return new Yz({colormap:U(this.colormap),colormapName:this.colormapName,colorRamp:(t=this.colorRamp)==null?void 0:t.clone(),colorRampName:this.colorRampName})}};d([p({type:[[Number]],json:{write:!0}})],id.prototype,"colormap",void 0),d([p({type:String,json:{write:!0}})],id.prototype,"colormapName",void 0),d([tt("colormapName")],id.prototype,"castColormapName",null),d([p({types:AL,json:{write:!0}})],id.prototype,"colorRamp",void 0),d([ae("colorRamp")],id.prototype,"readColorRamp",null),d([p({type:Lw.apiValues,json:{type:Lw.jsonValues,write:Lw.write}})],id.prototype,"colorRampName",void 0),d([ae("colorRampName")],id.prototype,"readColorRampName",null),id=Yz=d([A("esri.layers.support.rasterFunctions.ColormapFunctionArguments")],id);const CUe=id,EUe=[[36,0,255],[36,0,255],[36,0,255],[36,0,255],[112,75,3],[113,76,3],[114,77,3],[115,77,3],[116,78,3],[117,79,3],[118,79,3],[119,80,3],[121,81,4],[122,82,4],[123,82,4],[124,83,4],[125,84,4],[126,84,4],[127,85,4],[128,86,4],[129,86,4],[130,87,4],[131,88,4],[132,89,4],[133,89,4],[134,90,4],[135,91,4],[136,91,4],[137,92,4],[138,93,4],[139,94,4],[140,94,4],[142,95,5],[143,96,5],[144,96,5],[145,97,5],[146,98,5],[147,99,5],[148,99,5],[149,100,5],[150,101,5],[151,101,5],[152,102,5],[153,103,5],[154,104,5],[155,104,5],[156,105,5],[157,106,5],[158,106,5],[159,107,5],[160,108,5],[161,108,5],[162,109,5],[164,110,6],[165,111,6],[166,111,6],[167,112,6],[168,113,6],[169,113,6],[170,114,6],[171,115,6],[172,116,6],[173,116,6],[174,117,6],[245,0,0],[245,5,0],[245,10,0],[246,15,0],[246,20,0],[246,25,0],[246,30,0],[247,35,0],[247,40,0],[247,45,0],[247,50,0],[247,55,0],[248,60,0],[248,65,0],[248,70,0],[248,75,0],[249,81,0],[249,86,0],[249,91,0],[249,96,0],[250,101,0],[250,106,0],[250,111,0],[250,116,0],[250,121,0],[251,126,0],[251,131,0],[251,136,0],[251,141,0],[252,146,0],[252,151,0],[252,156,0],[252,156,0],[251,159,0],[250,162,0],[249,165,0],[248,168,0],[247,171,0],[246,174,0],[245,177,0],[245,179,0],[244,182,0],[243,185,0],[242,188,0],[241,191,0],[240,194,0],[239,197,0],[238,200,0],[237,203,0],[236,206,0],[235,209,0],[234,212,0],[233,215,0],[232,218,0],[231,221,0],[230,224,0],[230,226,0],[229,229,0],[228,232,0],[227,235,0],[226,238,0],[225,241,0],[224,244,0],[223,247,0],[165,247,0],[163,244,0],[161,240,0],[158,237,0],[156,233,1],[154,230,1],[152,227,1],[149,223,1],[147,220,1],[145,216,1],[143,213,1],[140,210,2],[138,206,2],[136,203,2],[134,200,2],[132,196,2],[129,193,2],[127,189,2],[125,186,3],[123,183,3],[120,179,3],[118,176,3],[116,172,3],[114,169,3],[111,166,3],[109,162,4],[107,159,4],[105,155,4],[103,152,4],[100,149,4],[98,145,4],[96,142,4],[94,138,5],[91,135,5],[89,132,5],[87,128,5],[85,125,5],[82,121,5],[80,118,5],[78,115,6],[76,111,6],[73,108,6],[71,105,6],[69,101,6],[67,98,6],[65,94,6],[62,91,7],[60,88,7],[58,84,7],[56,81,7],[53,77,7],[51,74,7],[49,71,7],[47,67,8],[44,64,8],[42,60,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8]],MUe=[[36,0,255],[36,0,255],[36,0,255],[36,0,255],[245,20,0],[245,24,0],[245,29,0],[245,31,0],[247,33,0],[247,33,0],[247,37,0],[247,41,0],[247,41,0],[247,41,0],[247,45,0],[247,45,0],[247,47,0],[247,49,0],[247,49,0],[247,54,0],[247,54,0],[247,56,0],[247,58,0],[247,58,0],[250,62,0],[250,62,0],[250,62,0],[250,67,0],[250,67,0],[250,67,0],[250,69,0],[250,71,0],[250,71,0],[250,75,0],[250,75,0],[250,78,0],[250,79,0],[250,79,0],[250,79,0],[250,81,0],[250,83,0],[250,83,0],[250,87,0],[250,87,0],[250,90,0],[250,92,0],[252,93,0],[252,93,0],[252,97,0],[252,97,0],[252,97,0],[252,97,0],[252,101,0],[252,101,0],[252,101,0],[252,101,0],[252,105,0],[252,105,0],[252,107,0],[252,109,0],[252,109,0],[252,113,13],[255,118,20],[255,119,23],[255,121,25],[255,126,33],[255,132,38],[255,133,40],[255,135,43],[255,141,48],[255,144,54],[255,150,59],[255,152,61],[255,153,64],[255,159,69],[255,163,77],[255,165,79],[255,168,82],[255,174,87],[255,176,92],[255,181,97],[255,183,99],[255,186,102],[255,191,107],[255,197,115],[255,201,120],[255,203,123],[255,205,125],[255,209,130],[255,214,138],[255,216,141],[255,218,143],[255,224,150],[255,228,156],[255,234,163],[255,236,165],[255,238,168],[255,243,173],[255,248,181],[255,252,186],[253,252,186],[250,252,187],[244,250,180],[238,247,176],[234,246,173],[231,245,169],[223,240,163],[217,237,157],[211,235,150],[205,233,146],[200,230,142],[195,227,136],[189,224,132],[184,222,126],[180,220,123],[174,217,119],[169,214,114],[163,212,108],[160,210,105],[154,207,101],[148,204,96],[143,201,93],[138,199,88],[134,197,84],[130,194,81],[126,191,77],[117,189,70],[115,186,68],[112,184,64],[106,181,60],[100,179,55],[94,176,49],[92,174,47],[90,173,45],[81,168,37],[75,166,33],[71,163,28],[66,160,24],[62,158,21],[56,156,14],[51,153,0],[51,153,0],[51,153,0],[50,150,0],[50,150,0],[50,150,0],[50,150,0],[49,148,0],[49,148,0],[49,148,0],[48,145,0],[48,145,0],[48,145,0],[48,145,0],[48,143,0],[48,143,0],[48,143,0],[48,143,0],[47,140,0],[47,140,0],[47,140,0],[47,140,0],[46,138,0],[46,138,0],[46,138,0],[46,138,0],[45,135,0],[45,135,0],[45,135,0],[45,135,0],[44,133,0],[44,133,0],[44,133,0],[43,130,0],[43,130,0],[43,130,0],[43,130,0],[43,130,0],[43,130,0],[42,128,0],[42,128,0],[42,128,0],[42,125,0],[42,125,0],[42,125,0],[42,125,0],[41,122,0],[41,122,0],[41,122,0],[41,122,0],[40,120,0],[40,120,0],[40,120,0],[40,120,0],[40,120,0],[39,117,0],[39,117,0],[39,117,0],[39,117,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0]];function Q9(t,e){const i=[],r=[];for(let s=0;s<t.length-1;s++)i.push({type:"algorithmic",algorithm:"esriHSVAlgorithm",fromColor:t[s].slice(1),toColor:t[s+1].slice(1)}),r.push(t[s+1][0]-t[s][0]);const n=t[t.length-1][0];return D9({type:"multipart",colorRamps:i},{numColors:n,weights:e=e??r})}function $Ue(){return Q9([[0,0,191,191],[51,0,0,255],[102,255,0,255],[153,255,0,127],[204,191,63,127],[256,20,20,20]])}function AUe(){const t=Q9([[0,255,255,255],[70,0,255,0],[80,205,173,193],[100,150,150,150],[110,120,51,100],[130,120,100,200],[140,28,3,144],[160,6,0,55],[180,10,25,30],[201,6,7,27]]);for(let e=t.length;e<256;e++)t.push([6,27,7]);return t}function kUe(){return D9({type:"algorithmic",algorithm:"esriHSVAlgorithm",fromColor:[0,0,0],toColor:[255,255,255]})}function PUe(){const t=[];for(let e=0;e<256;e++){const i=[];for(let r=0;r<3;r++)i.push(Math.round(255*Math.random()));t.push(i)}return t}function OUe(){return Q9([[0,38,41,54],[69,79,82,90],[131,156,156,156],[256,253,253,241]],[.268,.238,.495])}function LUe(t){let e;switch(t){case"elevation":e=$Ue();break;case"gray":e=kUe();break;case"hillshade":e=OUe();break;case"ndvi":e=EUe;break;case"ndvi2":e=AUe();break;case"ndvi3":e=MUe;break;case"random":e=PUe()}return e?(e=e.map((i,r)=>[r,...i]),e):null}let Rf=class extends Go{constructor(){super(...arguments),this.functionName="Colormap",this.functionArguments=null,this.rasterArgumentNames=["raster"],this.isNoopProcess=!0}_bindSourceRasters(){const e=this.sourceRasterInfos[0];if(e.bandCount>1)return{success:!1,supportsGPU:!1,error:"colormap-function: source data must be single band"};let{colormap:i,colormapName:r,colorRamp:n,colorRampName:s}=this.functionArguments;if(!(i!=null&&i.length))if(n)i=Ov(n,{interpolateAlpha:!0});else if(s){const a=e8e(s);a&&(i=Ov(a))}else r&&(i=LUe(r));if(!(i!=null&&i.length))return{success:!1,supportsGPU:!1,error:"colormap-function: missing colormap argument"};this.outputPixelType=this._getOutputPixelType("u8");const o=e.clone();return o.pixelType=this.outputPixelType,o.colormap=i,o.bandCount=1,this.rasterInfo=o,{success:!0,supportsGPU:!0}}_processPixels(e){var i;return(i=e.pixelBlocks)==null?void 0:i[0]}};d([p({json:{write:!0,name:"rasterFunction"}})],Rf.prototype,"functionName",void 0),d([p({type:CUe,json:{write:!0,name:"rasterFunctionArguments"}})],Rf.prototype,"functionArguments",void 0),d([p()],Rf.prototype,"rasterArgumentNames",void 0),d([p()],Rf.prototype,"isNoopProcess",void 0),d([p({json:{write:!0}})],Rf.prototype,"indexedColormap",void 0),Rf=d([A("esri.layers.support.rasterFunctions.ColormapFunction")],Rf);const RUe=Rf;var Kz;let u2=Kz=class extends Uo{constructor(){super(...arguments),this.rasters=[]}writeRasters(t,e){e.rasters=t.map(i=>typeof i=="number"||typeof i=="string"?i:i.toJSON())}clone(){return new Kz({rasters:U(this.rasters)})}};d([p({json:{write:!0}})],u2.prototype,"rasters",void 0),d([ge("rasters")],u2.prototype,"writeRasters",null),u2=Kz=d([A("esri.layers.support.rasterFunctions.CompositeBandFunctionArguments")],u2);const FUe=u2;let Eb=class extends Go{constructor(){super(...arguments),this.functionName="CompositeBand",this.functionArguments=null,this.rasterArgumentNames=["rasters"]}_bindSourceRasters(){const{sourceRasterInfos:e}=this,i=e[0];this.outputPixelType=this._getOutputPixelType(i.pixelType);const r=i.clone();if(r.attributeTable=null,r.colormap=null,r.pixelType=this.outputPixelType,r.bandCount=e.map(({bandCount:s})=>s).reduce((s,o)=>s+o),e.every(({statistics:s})=>s!=null&&s.length)){const s=[];e.forEach(({statistics:o})=>o!=null&&s.push(...o)),r.statistics=s}if(e.every(({histograms:s})=>s!=null&&s.length)){const s=[];e.forEach(({histograms:o})=>o!=null&&s.push(...o)),r.histograms=s}r.bandCount>1&&(r.colormap=null,r.attributeTable=null);const n=e.every(s=>{var o;return(o=s.keyProperties.BandProperties)==null?void 0:o.length})?e.flatMap(s=>s.keyProperties.BandProperties):void 0;return r.keyProperties={...r.keyProperties,BandProperties:n},this.rasterInfo=r,{success:!0,supportsGPU:r.bandCount<=3}}_processPixels(e){const{pixelBlocks:i}=e;return i?(i==null?void 0:i[0])==null?null:g8e(i):null}_getWebGLParameters(){return{bandCount:this.rasterInfo.bandCount}}};d([p({json:{write:!0,name:"rasterFunction"}})],Eb.prototype,"functionName",void 0),d([p({type:FUe,json:{write:!0,name:"rasterFunctionArguments"}})],Eb.prototype,"functionArguments",void 0),d([p()],Eb.prototype,"rasterArgumentNames",void 0),Eb=d([A("esri.layers.support.rasterFunctions.CompositeBandFunction")],Eb);const DUe=Eb,Xt={userDefined:-1,lineDetectionHorizontal:0,lineDetectionVertical:1,lineDetectionLeftDiagonal:2,lineDetectionRightDiagonal:3,gradientNorth:4,gradientWest:5,gradientEast:6,gradientSouth:7,gradientNorthEast:8,gradientNorthWest:9,smoothArithmeticMean:10,smoothing3x3:11,smoothing5x5:12,sharpening3x3:13,sharpening5x5:14,laplacian3x3:15,laplacian5x5:16,sobelHorizontal:17,sobelVertical:18,sharpen:19,sharpen2:20,pointSpread:21,none:255},NUe={plus:1,minus:2,times:3,sqrt:4,power:5,abs:10,divide:23,exp:25,exp10:26,exp2:27,int:30,float:32,ln:35,log10:36,log2:37,mod:44,negate:45,roundDown:48,roundUp:49,square:53,floatDivide:64,floorDivide:65},da={bitwiseAnd:11,bitwiseLeftShift:12,bitwiseNot:13,bitwiseOr:14,bitwiseRightShift:15,bitwiseXOr:16,booleanAnd:17,booleanNot:18,booleanOr:19,booleanXOr:20,equalTo:24,greaterThan:28,greaterThanEqual:29,lessThan:33,lessThanEqual:34,isNull:31,notEqual:46},lu={acos:6,asin:7,atan:8,atanh:9,cos:21,cosh:22,sin:51,sinh:52,tan:56,tanh:57,acosh:59,asinh:60,atan2:61},VUe={majority:38,max:39,mean:40,med:41,min:42,minority:43,range:47,stddev:54,sum:55,variety:58,majorityIgnoreNoData:66,maxIgnoreNoData:67,meanIgnoreNoData:68,medIgnoreNoData:69,minIgnoreNoData:70,minorityIgnoreNoData:71,rangeIgnoreNoData:72,stddevIgnoreNoData:73,sumIgnoreNoData:74,varietyIgnoreNoData:75},kfe={setNull:50,conditional:78},OY={...NUe,...da,...lu,...VUe,...kfe},fr=new Map;function zUe(t){const e=Math.sqrt(t.length),i=t.slice(0,e),r=[1];for(let n=1;n<e;n++){let s=null;for(let o=0;o<e;o++){const a=t[o+n*e],l=t[o];if(s==null)if(l===0){if(a)return{separable:!1,row:null,col:null}}else s=a/l;else if(a/l!==s)return{separable:!1,row:null,col:null}}if(s==null)return{separable:!1,row:null,col:null};r.push(s)}return{separable:!0,row:i,col:r}}function LY(t,e,i,r,n,s,o){const a=new Float32Array(e*i),l=s.length,c=o?0:r,u=o?r:0,h=o?1:e;for(let f=c;f<i-c;f++){const m=f*e;for(let g=u;g<e-u;g++){if(n&&!n[m+g])continue;let y=0;for(let v=0;v<l;v++)y+=t[m+g+(v-r)*h]*s[v];a[m+g]=y}}return a}function jUe(t,e,i,r,n,s,o){const a=new Float32Array(e*i),l=Math.floor(r/2),c=Math.floor(n/2);for(let u=l;u<i-l;u++){const h=u*e;for(let f=c;f<e-c;f++){if(s&&!s[h+f])continue;let m=0;for(let g=0;g<r;g++)for(let y=0;y<n;y++)m+=t[h+f+(g-l)*e+y-c]*o[g*n+y];a[h+f]=m}}return a}function BUe(t,e,i=!0){const{pixels:r,width:n,height:s,pixelType:o,mask:a}=t,l=r.length,c=[],{kernel:u,rows:h,cols:f}=e;for(let m=0;m<l;m++){const g=jUe(r[m],n,s,h,f,a,u);i&&Pfe(g,n,s,h,f),c.push(g)}return new de({width:n,height:s,pixelType:o,pixels:c,mask:a})}function Pfe(t,e,i,r,n){const s=Math.floor(r/2);for(let a=0;a<s;a++)for(let l=0;l<e;l++)t[a*e+l]=t[(n-1-a)*e+l],t[(i-1-a)*e+l]=t[(i-n+a)*e+l];const o=Math.floor(n/2);for(let a=0;a<i;a++){const l=a*e;for(let c=0;c<o;c++)t[l+c]=t[l+n-1-c],t[l+e-c-1]=t[l+e+c-n]}}function UUe(t,e,i,r=!0){const{pixels:n,width:s,height:o,pixelType:a,mask:l}=t,c=n.length,u=[],h=e.length,f=i.length,m=Math.floor(h/2),g=Math.floor(f/2);for(let y=0;y<c;y++){let v=LY(n[y],s,o,m,l,e,!0);v=LY(v,s,o,g,l,i,!1),r&&Pfe(v,s,o,h,f),u.push(v)}return new de({width:s,height:o,pixelType:a,pixels:u,mask:l})}function GUe(t,e){const i=zUe(e.kernel),r=e.mirrorEdges!==!1,n=i.separable?UUe(t,i.row,i.col,r):BUe(t,e,r),{outputPixelType:s}=e;return s&&n.clamp(s),n}fr.set(Xt.none,[0,0,0,0,1,0,0,0,0]),fr.set(Xt.lineDetectionHorizontal,[-1,-1,-1,2,2,2,-1,-1,-1]),fr.set(Xt.lineDetectionVertical,[-1,2,-1,-1,2,-1,-1,2,-1]),fr.set(Xt.lineDetectionLeftDiagonal,[2,-1,-1,-1,2,-1,-1,-1,2]),fr.set(Xt.lineDetectionRightDiagonal,[-1,-1,2,-1,2,-1,2,-1,-1]),fr.set(Xt.gradientNorth,[-1,-2,-1,0,0,0,1,2,1]),fr.set(Xt.gradientWest,[-1,0,1,-2,0,2,-1,0,1]),fr.set(Xt.gradientEast,[1,0,-1,2,0,-2,1,0,-1]),fr.set(Xt.gradientSouth,[1,2,1,0,0,0,-1,-2,-1]),fr.set(Xt.gradientNorthEast,[0,-1,-2,1,0,-1,2,1,0]),fr.set(Xt.gradientNorthWest,[-2,-1,0,-1,0,1,0,1,2]),fr.set(Xt.smoothArithmeticMean,[.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111]),fr.set(Xt.smoothing3x3,[.0625,.125,.0625,.125,.25,.125,.0625,.125,.0625]),fr.set(Xt.smoothing5x5,[1,1,1,1,1,1,4,4,4,1,1,4,12,4,1,1,4,4,4,1,1,1,1,1,1]),fr.set(Xt.sharpening3x3,[-1,-1,-1,-1,9,-1,-1,-1,-1]),fr.set(Xt.sharpening5x5,[-1,-3,-4,-3,-1,-3,0,6,0,-3,-4,6,21,6,-4,-3,0,6,0,-3,-1,-3,-4,-3,-1]),fr.set(Xt.laplacian3x3,[0,-1,0,-1,4,-1,0,-1,0]),fr.set(Xt.laplacian5x5,[0,0,-1,0,0,0,-1,-2,-1,0,-1,-2,17,-2,-1,0,-1,-2,-1,0,0,0,-1,0,0]),fr.set(Xt.sobelHorizontal,[-1,-2,-1,0,0,0,1,2,1]),fr.set(Xt.sobelVertical,[-1,0,1,-2,0,2,-1,0,1]),fr.set(Xt.sharpen,[0,-.25,0,-.25,2,-.25,0,-.25,0]),fr.set(Xt.sharpen2,[-.25,-.25,-.25,-.25,3,-.25,-.25,-.25,-.25]),fr.set(Xt.pointSpread,[-.627,.352,-.627,.352,2.923,.352,-.627,.352,-.627]);var Xz;let qy=Xz=class extends Uo{constructor(){super(...arguments),this.rows=3,this.cols=3,this.kernel=[0,0,0,0,1,0,0,0,0]}set convolutionType(t){this._set("convolutionType",t);const e=fr.get(t);if(!e||t===Xt.userDefined||t===Xt.none)return;const i=Math.sqrt(e.length);this._set("kernel",e),this._set("cols",i),this._set("rows",i)}clone(){return new Xz({cols:this.cols,rows:this.rows,kernel:[...this.kernel],convolutionType:this.convolutionType,raster:U(this.raster)})}};d([p({json:{type:Number,write:!0}})],qy.prototype,"rows",void 0),d([p({json:{type:Number,write:!0}})],qy.prototype,"cols",void 0),d([p({json:{name:"type",type:Number,write:!0}})],qy.prototype,"convolutionType",null),d([p({json:{type:[Number],write:!0}})],qy.prototype,"kernel",void 0),qy=Xz=d([A("esri.layers.support.rasterFunctions.ConvolutionFunctionArguments")],qy);const HUe=qy,RY=25;let Mb=class extends Go{constructor(){super(...arguments),this.functionName="Convolution",this.rasterArgumentNames=["raster"]}_bindSourceRasters(){const{convolutionType:e,rows:i,cols:r,kernel:n}=this.functionArguments;if(!Object.values(Xt).includes(e))return{success:!1,supportsGPU:!1,error:`convolution-function: the specified kernel type is not supported ${e}`};if(e!==Xt.none&&i*r!==n.length)return{success:!1,supportsGPU:!1,error:"convolution-function: the specified rows and cols do not match the length of the kernel"};const s=this.sourceRasterInfos[0];this.outputPixelType=this._getOutputPixelType(s.pixelType);const o=s.clone();o.pixelType=this.outputPixelType;const a=[Xt.none,Xt.sharpen,Xt.sharpen2,Xt.sharpening3x3,Xt.sharpening5x5];return this.outputPixelType==="u8"||a.includes(e)||(o.statistics=null,o.histograms=null),o.colormap=null,o.attributeTable=null,this.rasterInfo=o,{success:!0,supportsGPU:n.length<=RY}}_processPixels(e){var a;const i=(a=e.pixelBlocks)==null?void 0:a[0];if(i==null||this.functionArguments.convolutionType===Xt.none)return i;let{kernel:r,rows:n,cols:s}=this.functionArguments;const o=r.reduce((l,c)=>l+c);return o!==0&&o!==1&&(r=r.map(l=>l/o)),GUe(i,{kernel:r,rows:n,cols:s,outputPixelType:this.outputPixelType})}_getWebGLParameters(){let{kernel:e}=this.functionArguments;const i=e.reduce((n,s)=>n+s);i!==0&&i!==1&&(e=e.map(n=>n/i));const r=new Float32Array(RY);return r.set(e),{kernelRows:this.functionArguments.rows,kernelCols:this.functionArguments.cols,kernel:r,clampRange:Au(this.outputPixelType)}}};d([p({json:{write:!0,name:"rasterFunction"}})],Mb.prototype,"functionName",void 0),d([p({type:HUe,json:{write:!0,name:"rasterFunctionArguments"}})],Mb.prototype,"functionArguments",void 0),d([p()],Mb.prototype,"rasterArgumentNames",void 0),Mb=d([A("esri.layers.support.rasterFunctions.ConvolutionFunction")],Mb);const qUe=Mb;var Qz;const Ofe=new He({0:"standard",1:"platform",2:"profile"},{useNumericKeys:!0});let $b=Qz=class extends Uo{constructor(){super(...arguments),this.curvatureType="standard",this.zFactor=1}readCurvatureType(t,e){return Ofe.fromJSON(e.type??e.curvatureType??0)}clone(){return new Qz({curvatureType:this.curvatureType,zFactor:this.zFactor,raster:this.raster})}};d([p({json:{write:{target:"type"}}}),xe(Ofe)],$b.prototype,"curvatureType",void 0),d([ae("curvatureType",["type","curvatureType"])],$b.prototype,"readCurvatureType",null),d([p({type:Number,json:{write:!0}})],$b.prototype,"zFactor",void 0),$b=Qz=d([A("esri.layers.support.rasterFunctions.CurvatureFunctionArguments")],$b);const WUe=$b;let Wy=class extends Go{constructor(){super(...arguments),this.functionName="Curvature",this.functionArguments=null,this.rasterArgumentNames=["raster"],this.isGCS=!1}_bindSourceRasters(){var i;this.outputPixelType=this._getOutputPixelType("f32");const e=this.sourceRasterInfos[0].clone();return e.pixelType=this.outputPixelType,e.statistics=null,e.histograms=null,e.colormap=null,e.attributeTable=null,e.bandCount=1,this.rasterInfo=e,this.isGCS=((i=e.spatialReference)==null?void 0:i.isGeographic)??!1,{success:!0,supportsGPU:!0}}_processPixels(e){var u;const i=(u=e.pixelBlocks)==null?void 0:u[0];if(i==null)return null;const{zFactor:r,curvatureType:n}=this.functionArguments,{extent:s,primaryPixelSizes:o}=e,a=o==null?void 0:o[0],l=a??(s?{x:s.width/i.width,y:s.height/i.height}:{x:1,y:1}),c=this.isGCS&&r>=1?r*Yh:r;return KBe(i,{zFactor:c,curvatureType:n,resolution:l})}_getWebGLParameters(){const{zFactor:e,curvatureType:i}=this.functionArguments;return{curvatureType:i,zFactor:this.isGCS&&e>=1?e*Yh:e}}};d([p({json:{write:!0,name:"rasterFunction"}})],Wy.prototype,"functionName",void 0),d([p({type:WUe,json:{write:!0,name:"rasterFunctionArguments"}})],Wy.prototype,"functionArguments",void 0),d([p()],Wy.prototype,"rasterArgumentNames",void 0),d([p({json:{write:!0}})],Wy.prototype,"isGCS",void 0),Wy=d([A("esri.layers.support.rasterFunctions.CurvatureFunction")],Wy);const JUe=Wy;var ej;let Eh=ej=class extends Uo{constructor(){super(...arguments),this.bandIds=[],this.bandNames=[],this.bandWavelengths=[],this.missingBandAction=OP.bestMatch}clone(){return new ej({bandIds:[...this.bandIds],bandNames:[...this.bandNames],missingBandAction:this.missingBandAction,method:this.method,wavelengthMatchTolerance:this.wavelengthMatchTolerance})}};d([p({json:{write:!0}})],Eh.prototype,"bandIds",void 0),d([p({json:{write:!0}})],Eh.prototype,"bandNames",void 0),d([p({json:{write:!0}})],Eh.prototype,"bandWavelengths",void 0),d([xe({0:"name",1:"wavelength",2:"id"})],Eh.prototype,"method",void 0),d([p({json:{write:!0}})],Eh.prototype,"missingBandAction",void 0),d([p({json:{write:!0}})],Eh.prototype,"wavelengthMatchTolerance",void 0),Eh=ej=d([A("esri.layers.support.rasterFunctions.ExtractBandFunctionArguments")],Eh);const ZUe=Eh;let Ab=class extends Go{constructor(){super(...arguments),this.functionName="ExtractBand",this.functionArguments=null,this.rasterArgumentNames=["raster"]}_bindSourceRasters(){var b;const{functionArguments:e,sourceRasterInfos:i}=this,r=i[0],{method:n,bandNames:s,bandWavelengths:o,bandIds:a,missingBandAction:l}=e,c=(s==null?void 0:s.length)&&(n==="name"||n!=="id"&&!(a!=null&&a.length)),u=(o==null?void 0:o.length)&&(n==="wavelength"||n!=="id"&&!(a!=null&&a.length)),h=l===OP.fail,f=c?this._matchBandNames(r,s):u?this._matchBandWavelengths(r,o,h):this._matchBandIds(r,a,h);if(f==null)return{success:!1,supportsGPU:!1,error:`extract-band-function: Invalid ${c?"band names":u?"band wavelengths":"band ids"} for the imagery data source`};this.functionArguments.bandIds=f,this.functionArguments.method="id",this.outputPixelType=this._getOutputPixelType("f32");const m=r.clone();m.pixelType=this.outputPixelType,m.bandCount=f.length;const{statistics:g,histograms:y}=m;g!=null&&g.length&&(m.statistics=f.map(w=>g[w]||g[g.length-1])),y!=null&&y.length&&(m.histograms=f.map(w=>y[w]||y[y.length-1]));let v=(b=m.keyProperties)==null?void 0:b.BandProperties;return v!=null&&v.length&&(v=f.map(w=>w>=v.length?v[v.length-1]:v[w]),m.keyProperties={...m.keyProperties,BandProperties:v}),this.rasterInfo=m,{success:!0,supportsGPU:m.bandCount<=3}}_processPixels(e){var s;const i=(s=e.pixelBlocks)==null?void 0:s[0];if(i==null)return null;const r=i.pixels.length,n=this.functionArguments.bandIds.map(o=>o>=r?r-1:o);return i.extractBands(n)}_getWebGLParameters(){let e;if(this.isInputBandIdsSwizzled)e=this.swizzledBandSelection.length?this.swizzledBandSelection:[0,1,2];else{e=[...this.functionArguments.bandIds],e.length===0?e=[0,1,2]:e.length<3&&(e[1]=e[1]??e[0],e[2]=e[2]??e[1]);for(let i=0;i<3;i++)e[i]=Math.min(e[i],2)}return{bandIndexMat3:os(e)}}_getInputBandIds(e){const i=e.length;return this.functionArguments.bandIds.map(r=>r>=i?i-1:r).map(r=>e[r])}_matchBandNames(e,i){const r=e.bandInfos.map(({name:s})=>s.toLowerCase()),n=[];for(let s=0;s<i.length;s++){const o=i[s].toLowerCase();let a=r.indexOf(o);if(a===-1&&o==="nearinfrared"&&(a=r.findIndex(l=>l.startsWith("nearinfrared_1")),a===-1&&(a=r.findIndex(l=>l.startsWith("nearinfrared")))),a===-1)return null;n.push(a)}return n}_matchBandIds(e,i,r){const{bandCount:n}=e;return!(i!=null&&i.length)||r&&i.some(s=>s<0||s>=n)?null:i}_matchBandWavelengths(e,i,r){const{bandInfos:n}=e,s=[];for(let l=0;l<n.length;l++){const{minWavelength:c,maxWavelength:u}=n[l];if(!c||!u)return null;s.push({minWavelength:c,maxWavelength:u})}const{wavelengthMatchTolerance:o}=this.functionArguments,a=[];for(let l=0;l<i.length;l++){const c=i[l];let u=!1,h=-1,f=Number.MAX_VALUE;for(let m=0;m<s.length;m++){const g=s[m],y=c>=g.minWavelength&&c<=g.maxWavelength,v=Math.abs(c-(g.minWavelength+g.maxWavelength)/2);y?v<f&&(u=!0,h=m,f=v):!u&&v<f&&(h=m,f=v)}if(!u&&o&&f<o&&(u=!0),!u&&r)return null;a.push(h)}return a}};d([p({json:{write:!0,name:"rasterFunction"}})],Ab.prototype,"functionName",void 0),d([p({type:ZUe,json:{write:!0,name:"rasterFunctionArguments"}})],Ab.prototype,"functionArguments",void 0),d([p()],Ab.prototype,"rasterArgumentNames",void 0),Ab=d([A("esri.layers.support.rasterFunctions.ExtractBandFunction")],Ab);const YUe=Ab;var tj;let Jy=tj=class extends Uo{constructor(){super(...arguments),this.rasters=[],this.processAsMultiband=!0}writeRasters(t,e){e.rasters=t.map(i=>typeof i=="number"||typeof i=="string"?i:i.toJSON())}clone(){return new tj({operation:this.operation,processAsMultiband:this.processAsMultiband,rasters:U(this.rasters)})}};d([p({json:{write:!0}})],Jy.prototype,"operation",void 0),d([p({json:{write:!0}})],Jy.prototype,"rasters",void 0),d([ge("rasters")],Jy.prototype,"writeRasters",null),d([p({json:{write:!0}})],Jy.prototype,"processAsMultiband",void 0),Jy=tj=d([A("esri.layers.support.rasterFunctions.LocalFunctionArguments")],Jy);const KUe=Jy,as=new Map;function XUe(t){return as.get(t)}as.set(lu.acos,[0,Math.PI]),as.set(lu.asin,[-Math.PI/2,Math.PI/2]),as.set(lu.atan,[-Math.PI/2,Math.PI/2]),as.set(lu.cos,[-1,1]),as.set(lu.sin,[-1,1]),as.set(da.booleanAnd,[0,1]),as.set(da.booleanNot,[0,1]),as.set(da.booleanOr,[0,1]),as.set(da.booleanXOr,[0,1]),as.set(da.equalTo,[0,1]),as.set(da.notEqual,[0,1]),as.set(da.greaterThan,[0,1]),as.set(da.greaterThanEqual,[0,1]),as.set(da.lessThan,[0,1]),as.set(da.lessThanEqual,[0,1]),as.set(da.isNull,[0,1]);const FY=[0,2,2,2,1,2,1,1,1,1,1,2,2,1,2,2,2,2,1,2,2,1,1,2,2,1,1,1,2,2,1,1,1,2,2,1,1,1,999,999,999,999,999,999,2,1,2,999,1,1,2,1,1,1,999,999,1,1,999,1,1,2,999,999,2,2,999,999,999,999,999,999,999,999,999,999,3,999,3];function QUe(t,e=!1){const i=t.map(a=>a.mask),r=i.filter(a=>a!=null),n=t[0].pixels[0].length;if(r.length===0)return new Uint8Array(n).fill(255);const s=r[0],o=new Uint8Array(s);if(r.length===1)return o;if(!e){for(let a=1;a<r.length;a++){const l=r[a];for(let c=0;c<o.length;c++)o[c]&&(o[c]=l[c]?255:0)}return o}if(r.length!==i.length)return new Uint8Array(n).fill(255);for(let a=1;a<r.length;a++){const l=r[a];for(let c=0;c<o.length;c++)o[c]===0&&(o[c]=l[c]?255:0)}return o}function e9e(t,e,i){const[r,n]=t,s=r.length,o=de.createEmptyBand(i,s);for(let a=0;a<s;a++)e&&!e[a]||(o[a]=r[a]+n[a]);return o}function t9e(t,e,i){const[r]=t,n=r.length,s=de.createEmptyBand("f32",n);return s.set(r),s}function i9e(t,e,i){const[r,n]=t,s=r.length,o=de.createEmptyBand(i,s);for(let a=0;a<s;a++)e&&!e[a]||(o[a]=r[a]-n[a]);return o}function r9e(t,e,i){const[r,n]=t,s=r.length,o=de.createEmptyBand(i,s);for(let a=0;a<s;a++)e&&!e[a]||(o[a]=r[a]*n[a]);return o}function n9e(t,e,i){const[r]=t,n=r.length,s=de.createEmptyBand(i,n);for(let o=0;o<n;o++)e&&!e[o]||(s[o]=Math.sign(r[o])*Math.floor(Math.abs(r[o])));return s}function Lfe(t,e,i){const[r,n]=t,s=r.length,o=de.createEmptyBand(i,s);for(let a=0;a<s;a++)e&&!e[a]||(o[a]=r[a]/n[a]);return o}function s9e(t,e,i){return Lfe(t,e,"f32")}function o9e(t,e,i){const[r,n]=t,s=r.length,o=de.createEmptyBand(i,s);for(let a=0;a<s;a++)e&&!e[a]||(o[a]=Math.floor(r[a]/n[a]));return o}function a9e(t,e,i,r){const n=t[0],s=n.length,o=de.createEmptyBand(i,s);if(r===lu.atanh){for(let l=0;l<s;l++)if(e[l]){const c=n[l];Math.abs(c)>=1?e[l]=0:o[l]=Math.atanh(c)}return o}const a=r===lu.asin?Math.asin:Math.acos;for(let l=0;l<s;l++)if(e[l]){const c=n[l];Math.abs(c)>1?e[l]=0:o[l]=a(c)}return o}function l9e(t,e,i,r){const[n]=t,s=n.length,o=de.createEmptyBand(i,s);for(let a=0;a<s;a++)e&&!e[a]||(o[a]=r(n[a]));return o}function c9e(t,e,i,r){const[n,s]=t,o=n.length,a=de.createEmptyBand(i,o);for(let l=0;l<o;l++)e&&!e[l]||(a[l]=r(n[l],s[l]));return a}function u9e(t,e,i){const[r,n]=t,s=r.length,o=de.createEmptyBand(i,s);for(let a=0;a<s;a++)e&&!e[a]||(o[a]=r[a]&n[a]);return o}function DY(t,e,i){const[r,n]=t,s=r.length,o=de.createEmptyBand(i,s);for(let a=0;a<s;a++)e&&!e[a]||(o[a]=r[a]<<n[a]);return o}function d9e(t,e,i){const[r]=t,n=r.length,s=de.createEmptyBand(i,n);for(let o=0;o<n;o++)e&&!e[o]||(s[o]=~r[o]);return s}function h9e(t,e,i){const[r,n]=t,s=r.length,o=de.createEmptyBand(i,s);for(let a=0;a<s;a++)e&&!e[a]||(o[a]=r[a]|n[a]);return o}function p9e(t,e,i){const[r,n]=t,s=r.length,o=de.createEmptyBand(i,s);for(let a=0;a<s;a++)e&&!e[a]||(o[a]=r[a]>>n[a]);return o}function f9e(t,e,i){const[r,n]=t,s=r.length,o=de.createEmptyBand(i,s);for(let a=0;a<s;a++)e&&!e[a]||(o[a]=r[a]^n[a]);return o}function m9e(t,e,i){const[r,n]=t,s=r.length,o=de.createEmptyBand(i,s);for(let a=0;a<s;a++)e&&!e[a]||(o[a]=r[a]&&n[a]?1:0);return o}function g9e(t,e,i){const[r]=t,n=r.length,s=de.createEmptyBand(i,n);for(let o=0;o<n;o++)e&&!e[o]||(s[o]=r[o]?0:1);return s}function y9e(t,e,i){const[r,n]=t,s=r.length,o=de.createEmptyBand(i,s);for(let a=0;a<s;a++)e&&!e[a]||(o[a]=r[a]||n[a]?1:0);return o}function v9e(t,e,i){const[r,n]=t,s=r.length,o=de.createEmptyBand(i,s);for(let a=0;a<s;a++)e&&!e[a]||(o[a]=(r[a]?1:0)^(n[a]?1:0));return o}function _9e(t,e,i){const[r,n]=t,s=r.length,o=de.createEmptyBand(i,s);for(let a=0;a<s;a++)e&&!e[a]||(o[a]=r[a]===n[a]?1:0);return o}function eG(t,e,i,r){const[n]=t,s=n.length,o=de.createEmptyBand(i,s),a=r===Math.E;for(let l=0;l<s;l++)e&&!e[l]||(o[l]=a?Math.exp(n[l]):r**n[l]);return o}function b9e(t,e,i){return eG(t,e,i,10)}function w9e(t,e,i){return eG(t,e,i,2)}function x9e(t,e,i){return eG(t,e,i,Math.E)}function tG(t,e,i,r){const[n]=t,s=n.length,o=de.createEmptyBand(i,s);for(let a=0;a<s;a++)e&&!e[a]||(n[a]<=0?e[a]=0:o[a]=r(n[a]));return o}function S9e(t,e,i){return tG(t,e,i,Math.log10)}function I9e(t,e,i){return tG(t,e,i,Math.log2)}function T9e(t,e,i){return tG(t,e,i,Math.log)}function C9e(t,e,i){const[r,n]=t,s=r.length,o=de.createEmptyBand(i,s);for(let a=0;a<s;a++)e&&!e[a]||(o[a]=r[a]>n[a]?1:0);return o}function E9e(t,e,i){const[r,n]=t,s=r.length,o=de.createEmptyBand(i,s);for(let a=0;a<s;a++)e&&!e[a]||(o[a]=r[a]>=n[a]?1:0);return o}function M9e(t,e,i){const[r,n]=t,s=r.length,o=de.createEmptyBand(i,s);for(let a=0;a<s;a++)e&&!e[a]||(o[a]=r[a]<n[a]?1:0);return o}function $9e(t,e,i){const[r,n]=t,s=r.length,o=de.createEmptyBand(i,s);for(let a=0;a<s;a++)e&&!e[a]||(o[a]=r[a]<=n[a]?1:0);return o}function A9e(t,e,i){const[r]=t,n=r.length,s=de.createEmptyBand(i,n);if(!e)return s;for(let o=0;o<n;o++)s[o]=e[o]?0:1;return s}function k9e(t,e,i){const[r,n]=t,s=r.length,o=de.createEmptyBand(i,s);for(let a=0;a<s;a++)e&&!e[a]||(o[a]=r[a]%n[a]);return o}function P9e(t,e,i){const[r]=t,n=r.length,s=de.createEmptyBand(i,n);for(let o=0;o<n;o++)e&&!e[o]||(s[o]=-r[o]);return s}function O9e(t,e,i){const[r,n]=t,s=r.length,o=de.createEmptyBand(i,s);for(let a=0;a<s;a++)e&&!e[a]||(o[a]=r[a]===n[a]?0:1);return o}function L9e(t,e,i){const[r,n]=t,s=r.length,o=de.createEmptyBand(i,s),a=new Uint8Array(s);for(let l=0;l<s;l++)e!=null&&!e[l]||r[l]!==0||(o[l]=n[l],a[l]=255);return{band:o,mask:a}}function NY(t,e,i){const[r,n,s]=t,o=r.length,a=de.createEmptyBand(i,o);for(let l=0;l<o;l++)e&&!e[l]||(a[l]=r[l]?n[l]:s[l]);return a}function VY(t,e,i){const r=t.length;if(r<2)return t[0];const[n]=t,s=n.length,o=de.createEmptyBand(i,s);for(let a=0;a<s;a++)if(!e||e[a]){let l=n[a];for(let c=1;c<r;c++){const u=t[c][a];l<u&&(l=u)}o[a]=l}return o}function zY(t,e,i){const r=t.length;if(r<2)return t[0];const[n]=t,s=n.length,o=de.createEmptyBand(i,s);for(let a=0;a<s;a++)if(!e||e[a]){let l=n[a];for(let c=1;c<r;c++){const u=t[c][a];l>u&&(l=u)}o[a]=l}return o}function jY(t,e,i){const r=t.length;if(r<2)return t[0];const[n]=t,s=n.length,o=de.createEmptyBand(i,s);for(let a=0;a<s;a++)if(!e||e[a]){let l=n[a],c=l;for(let u=1;u<r;u++){const h=t[u][a];c<h?c=h:l>h&&(l=h)}o[a]=c-l}return o}function BY(t,e,i){const r=t.length;if(r<2)return t[0];const[n]=t,s=n.length,o=de.createEmptyBand(i,s);for(let a=0;a<s;a++)if(!e||e[a]){let l=0;for(let c=0;c<r;c++)l+=t[c][a];o[a]=l/r}return o}function UY(t,e,i){const r=t.length;if(r<2)return t[0];const[n]=t,s=n.length,o=de.createEmptyBand(i,s);for(let a=0;a<s;a++)if(!e||e[a])for(let l=0;l<r;l++){const c=t[l];o[a]+=c[a]}return o}function GY(t,e,i){const r=t.length;if(r<2)return t[0];const[n]=t,s=n.length,o=de.createEmptyBand(i,s);for(let a=0;a<s;a++)if(!e||e[a]){const l=new Float32Array(r);let c=0;for(let h=0;h<r;h++){const f=t[h];c+=f[a],l[h]=f[a]}c/=r;let u=0;for(let h=0;h<r;h++)u+=(l[h]-c)**2;o[a]=Math.sqrt(u/r)}return o}function HY(t,e,i){const r=t.length;if(r<2)return t[0];const n=Math.floor(r/2),[s]=t,o=s.length,a=de.createEmptyBand(i,o),l=new Float32Array(r),c=r%2==1;for(let u=0;u<o;u++)if(!e||e[u]){for(let h=0;h<r;h++)l[h]=t[h][u];l.sort(),a[u]=c?l[n]:(l[n]+l[n-1])/2}return a}function Rfe(t,e,i){const[r,n]=t;if(n==null)return r;const s=r.length,o=de.createEmptyBand(i,s);for(let a=0;a<s;a++)e[a]&&(r[a]===n[a]?o[a]=r[a]:e[a]=0);return o}function qY(t,e,i){const r=t.length;if(r<=2)return Rfe(t,e,i);const n=t[0].length,s=de.createEmptyBand(i,n),o=new Map;for(let a=0;a<n;a++)if(!e||e[a]){let l;o.clear();for(let h=0;h<r;h++)l=t[h][a],o.set(l,o.has(l)?o.get(l)+1:1);let c=0,u=0;for(const h of o.keys())c=o.get(h),c>u&&(u=c,l=h);s[a]=l}return s}function WY(t,e,i){const r=t.length;if(r<=2)return Rfe(t,e,i);const n=t[0].length,s=de.createEmptyBand(i,n),o=new Map;for(let a=0;a<n;a++)if(!e||e[a]){let l;o.clear();for(let h=0;h<r;h++)l=t[h][a],o.set(l,o.has(l)?o.get(l)+1:1);let c=0,u=t.length;for(const h of o.keys())c=o.get(h),c<u&&(u=c,l=h);s[a]=l}return s}function JY(t,e,i){const r=t.length;if(r<2)return t[0];const[n]=t,s=n.length,o=de.createEmptyBand(i,s),a=new Set;for(let l=0;l<s;l++)if(!e||e[l]){let c;a.clear();for(let u=0;u<r;u++)c=t[u][l],a.add(c);o[l]=a.size}return o}const wn=new Map,GP=new Map,It=new Map,gr=new Map;function R9e(){wn.size||(wn.set(4,Math.sqrt),wn.set(6,Math.acos),wn.set(7,Math.asin),wn.set(8,Math.atan),wn.set(9,Math.atanh),wn.set(10,Math.abs),wn.set(21,Math.cos),wn.set(22,Math.cosh),wn.set(48,Math.floor),wn.set(49,Math.ceil),wn.set(51,Math.sin),wn.set(52,Math.sinh),wn.set(56,Math.tan),wn.set(57,Math.tanh),wn.set(59,Math.acosh),wn.set(60,Math.asinh),wn.set(65,Math.floor),GP.set(5,Math.pow),GP.set(61,Math.atan2),It.set(1,e9e),It.set(2,i9e),It.set(3,r9e),It.set(11,u9e),It.set(12,DY),It.set(12,DY),It.set(13,d9e),It.set(14,h9e),It.set(15,p9e),It.set(16,f9e),It.set(17,m9e),It.set(18,g9e),It.set(19,y9e),It.set(20,v9e),It.set(23,Lfe),It.set(24,_9e),It.set(25,x9e),It.set(26,b9e),It.set(27,w9e),It.set(28,C9e),It.set(29,E9e),It.set(30,n9e),It.set(31,A9e),It.set(32,t9e),It.set(33,M9e),It.set(34,$9e),It.set(35,T9e),It.set(36,S9e),It.set(37,I9e),It.set(44,k9e),It.set(45,P9e),It.set(46,O9e),It.set(64,s9e),It.set(65,o9e),It.set(76,NY),It.set(78,NY),gr.set(38,qY),gr.set(39,VY),gr.set(40,BY),gr.set(41,HY),gr.set(42,zY),gr.set(43,WY),gr.set(47,jY),gr.set(54,GY),gr.set(55,UY),gr.set(58,JY),gr.set(66,qY),gr.set(67,VY),gr.set(68,BY),gr.set(69,HY),gr.set(70,zY),gr.set(71,WY),gr.set(72,jY),gr.set(73,GY),gr.set(74,UY),gr.set(75,JY))}function F9e(t,e,i,r){let[n,s]=Au(i);const o=i.startsWith("u")||i.startsWith("s");o&&(n-=1e-5,s+=1e-5);for(let a=0;a<e.length;a++)if(e[a]){const l=t[a];isNaN(l)||l<n||l>s?e[a]=0:r[a]=o?Math.round(l):l}}function D9e(t,e,i={}){R9e();let r=QUe(t,e>=66&&e<=75);const{outputPixelType:n="f32"}=i,s=!gr.has(e)||i.processAsMultiband,o=s?t[0].pixels.length:1,a=[];for(let c=0;c<o;c++){const u=gr.has(e)&&!s?t.flatMap(m=>m.pixels):t.map(m=>m.pixels[c]);let h,f=!0;if(e===kfe.setNull){const m=L9e(u,r,n);h=m.band,r=m.mask,f=!1}else It.has(e)?h=It.get(e)(u,r,"f64"):wn.has(e)?h=e===lu.asin||e===lu.acos||e===lu.atanh?a9e(u,r,"f64",e):l9e(u,r,"f64",wn.get(e)):GP.has(e)?h=c9e(u,r,"f64",GP.get(e)):gr.has(e)?h=gr.get(e)(u,r,"f64"):(h=u[0],f=!1);if(f&&e!==da.isNull&&!as.has(e)){const m=de.createEmptyBand(n,h.length);r||(r=new Uint8Array(h.length).fill(255)),F9e(h,r,n,m),h=m}a.push(h)}const l=t[0];return new de({width:l.width,height:l.height,pixelType:n,mask:e===da.isNull?null:r,pixels:a})}let kb=class extends Go{constructor(){super(...arguments),this.functionName="Local",this.functionArguments=null,this.rasterArgumentNames=["rasters"]}_bindSourceRasters(){const{sourceRasterInfos:e}=this,i=e[0],{bandCount:r}=i,{processAsMultiband:n}=this.functionArguments;if(e.some(u=>u.bandCount!==r))return{success:!1,supportsGPU:!1,error:"local-function: input rasters do not have same band count"};const{operation:s,rasters:o}=this.functionArguments,a=FY[s];if(!(a===999||o.length===a||o.length<=1&&a===1))return{success:!1,supportsGPU:!1,error:`local-function: the length of functionArguments.rasters does not match operation's requirement: ${a}`};this.outputPixelType=this._getOutputPixelType("f32");const l=i.clone();l.pixelType=this.outputPixelType,l.statistics=null,l.histograms=null,l.colormap=null,l.attributeTable=null,l.bandCount=a!==999||n?r:1;const c=XUe(s);if(c){l.statistics=[];for(let u=0;u<l.bandCount;u++)l.statistics[u]={min:c[0],max:c[1],avg:(c[0]+c[1])/2,stddev:(c[0]+c[1])/10}}return this.rasterInfo=l,{success:!0,supportsGPU:l.bandCount===1&&a<=3&&(s<11||s>16)}}_processPixels(e){const{pixelBlocks:i}=e;return i==null||i.some(r=>r==null)?null:D9e(i,this.functionArguments.operation,{processAsMultiband:this.functionArguments.processAsMultiband,outputPixelType:this.outputPixelType??void 0})}_getWebGLParameters(){var l;const{operation:e}=this.functionArguments,i=FY[e],r=((l=Object.keys(OY).find(c=>OY[c]===e))==null?void 0:l.toLowerCase())??"undefined",n=this.outputPixelType??"f32";let[s,o]=Au(n);const a=n.startsWith("u")||n.startsWith("s");return a&&(s-=1e-4,o+=1e-4),{imageCount:i,operationName:r,domainRange:[s,o],isOutputRounded:a}}};d([p({json:{write:!0,name:"rasterFunction"}})],kb.prototype,"functionName",void 0),d([p({type:KUe,json:{write:!0,name:"rasterFunctionArguments"}})],kb.prototype,"functionArguments",void 0),d([p()],kb.prototype,"rasterArgumentNames",void 0),kb=d([A("esri.layers.support.rasterFunctions.LocalFunction")],kb);const N9e=kb;var ij;let Zy=ij=class extends Uo{constructor(){super(...arguments),this.includedRanges=null,this.noDataValues=null,this.noDataInterpretation=PP.matchAny}get normalizedNoDataValues(){const{noDataValues:t}=this;if(!(t!=null&&t.length))return null;let e=!1;const i=t.map(r=>{if(typeof r=="number")return e=!0,[r];if(typeof r=="string"){const n=r.trim().split(" ").filter(s=>s.trim()!=="").map(s=>Number(s));return e=e||n.length>0,n.length===0?null:n}return null});return e?i:null}clone(){var t,e;return new ij({includedRanges:((t=this.includedRanges)==null?void 0:t.slice())??[],noDataValues:((e=this.noDataValues)==null?void 0:e.slice())??[],noDataInterpretation:this.noDataInterpretation})}};d([p({json:{write:!0}})],Zy.prototype,"includedRanges",void 0),d([p({json:{write:!0}})],Zy.prototype,"noDataValues",void 0),d([p()],Zy.prototype,"normalizedNoDataValues",null),d([p({json:{write:!0}})],Zy.prototype,"noDataInterpretation",void 0),Zy=ij=d([A("esri.layers.support.rasterFunctions.MaskFunctionArguments")],Zy);const V9e=Zy;let Yy=class extends Go{constructor(){super(...arguments),this.functionName="Mask",this.functionArguments=null,this.rasterArgumentNames=["raster"]}_bindSourceRasters(){const e=this.sourceRasterInfos[0].clone(),{pixelType:i}=e;this.outputPixelType=this._getOutputPixelType(i),e.pixelType=this.outputPixelType,this.rasterInfo=e;const{includedRanges:r,normalizedNoDataValues:n}=this.functionArguments;if(!(r!=null&&r.length)&&!(n!=null&&n.length))return{success:!1,supportsGPU:!1,error:"missing includedRanges or noDataValues argument"};let s=[];for(let a=0;a<e.bandCount;a++){const l=w8e(i,r==null?void 0:r.slice(2*a,2*a+2),n==null?void 0:n[a]);if(l==null){s=null;break}s.push(l)}this.lookups=s;const o=n!=null&&n.every(a=>{var l;return(a==null?void 0:a.length)===((l=n[0])==null?void 0:l.length)});return{success:!0,supportsGPU:(!r||r.length<=2*qh)&&(!n||o&&n[0].length<=qh)}}_processPixels(e){var c;const i=(c=e.pixelBlocks)==null?void 0:c[0];if(i==null)return null;const{outputPixelType:r,lookups:n}=this,{includedRanges:s,noDataInterpretation:o,normalizedNoDataValues:a}=this.functionArguments,l=o===PP.matchAll;return _8e(i,{includedRanges:s,noDataValues:a,outputPixelType:r,matchAll:l,lookups:n})}_getWebGLParameters(){var s;const{includedRanges:e,normalizedNoDataValues:i}=this.functionArguments,r=new Float32Array(qh);r.fill(Jm),(s=i==null?void 0:i[0])!=null&&s.length&&r.set(i[0]);const n=new Float32Array(qh);for(let o=0;o<n.length;o+=2)n[o]=(e==null?void 0:e[o])??-Jm,n[o+1]=(e==null?void 0:e[o+1])??Jm;return e&&e.length&&n.set(e),{bandCount:this.sourceRasterInfos[0].bandCount,noDataValues:r,includedRanges:n}}};d([p({json:{write:!0,name:"rasterFunction"}})],Yy.prototype,"functionName",void 0),d([p({type:V9e,json:{write:!0,name:"rasterFunctionArguments"}})],Yy.prototype,"functionArguments",void 0),d([p()],Yy.prototype,"rasterArgumentNames",void 0),d([p({json:{write:!0}})],Yy.prototype,"lookups",void 0),Yy=d([A("esri.layers.support.rasterFunctions.MaskFunction")],Yy);const z9e=Yy;var rj;let Pb=rj=class extends Uo{constructor(){super(...arguments),this.visibleBandID=0,this.infraredBandID=1,this.scientificOutput=!1}clone(){const{visibleBandID:t,infraredBandID:e,scientificOutput:i}=this;return new rj({visibleBandID:t,infraredBandID:e,scientificOutput:i})}};d([p({json:{write:!0}})],Pb.prototype,"visibleBandID",void 0),d([p({json:{write:!0}})],Pb.prototype,"infraredBandID",void 0),d([p({json:{write:!0}})],Pb.prototype,"scientificOutput",void 0),Pb=rj=d([A("esri.layers.support.rasterFunctions.NDVIFunctionArguments")],Pb);const j9e=Pb;let Ob=class extends Go{constructor(){super(...arguments),this.functionName="NDVI",this.functionArguments=null,this.rasterArgumentNames=["raster"]}_bindSourceRasters(){const{scientificOutput:e,visibleBandID:i,infraredBandID:r}=this.functionArguments;this.outputPixelType=this._getOutputPixelType(e?"f32":"u8");const n=this.sourceRasterInfos[0],s=Math.max(i,r);if(n.bandCount<2||s>=n.bandCount)return{success:!1,supportsGPU:!1,error:"ndvi-function: source raster has insufficient amount of raster bands"};const o=n.clone();o.pixelType=this.outputPixelType,o.colormap=null,o.histograms=null,o.bandCount=1,o.keyProperties={...o.keyProperties,BandProperties:void 0};const[a,l,c,u]=e?[-1,1,0,.1]:[0,200,100,10];return o.statistics=[{min:a,max:l,avg:c,stddev:u}],this.rasterInfo=o,{success:!0,supportsGPU:!0}}_processPixels(e){var o;const i=(o=e.pixelBlocks)==null?void 0:o[0];if(i==null)return null;const{visibleBandID:r,infraredBandID:n,scientificOutput:s}=this.functionArguments;return aUe(i,r,n,!s)}_getWebGLParameters(){const{visibleBandID:e,infraredBandID:i,scientificOutput:r}=this.functionArguments,n=this.isInputBandIdsSwizzled?[0,1,2]:[i,e,0];return{bandIndexMat3:os(n),scaled:!r}}_getInputBandIds(e){const{visibleBandID:i,infraredBandID:r}=this.functionArguments;return[r,i,0].map(n=>e[n])}};d([p({json:{write:!0,name:"rasterFunction"}})],Ob.prototype,"functionName",void 0),d([p({type:j9e,json:{write:!0,name:"rasterFunctionArguments"}})],Ob.prototype,"functionArguments",void 0),d([p()],Ob.prototype,"rasterArgumentNames",void 0),Ob=d([A("esri.layers.support.rasterFunctions.NDVIFunction")],Ob);const B9e=Ob;var nj;let Ff=nj=class extends Uo{constructor(){super(...arguments),this.inputRanges=null,this.outputValues=null,this.noDataRanges=null,this.allowUnmatched=!1,this.isLastInputRangeInclusive=!1}clone(){return new nj({inputRanges:[...this.inputRanges],outputValues:[...this.outputValues],noDataRanges:[...this.noDataRanges],allowUnmatched:this.allowUnmatched,isLastInputRangeInclusive:this.isLastInputRangeInclusive})}};d([p({json:{write:!0}})],Ff.prototype,"inputRanges",void 0),d([p({json:{write:!0}})],Ff.prototype,"outputValues",void 0),d([p({json:{write:!0}})],Ff.prototype,"noDataRanges",void 0),d([p({json:{write:!0}})],Ff.prototype,"allowUnmatched",void 0),d([p({json:{write:!0}})],Ff.prototype,"isLastInputRangeInclusive",void 0),Ff=nj=d([A("esri.layers.support.rasterFunctions.RemapFunctionArguments")],Ff);const U9e=Ff;let Ky=class extends Go{constructor(){super(...arguments),this.functionName="Remap",this.functionArguments=null,this.rasterArgumentNames=["raster"],this.lookup=null}_bindSourceRasters(){const e=this.sourceRasterInfos[0].clone(),{pixelType:i}=e;this.outputPixelType=this._getOutputPixelType(i),e.pixelType=this.outputPixelType,e.colormap=null,e.histograms=null,e.bandCount=1,e.attributeTable=null;const{statistics:r}=e,{allowUnmatched:n,outputValues:s,inputRanges:o,noDataRanges:a,isLastInputRangeInclusive:l}=this.functionArguments;if(r!=null&&r.length&&(s!=null&&s.length))if(n){const c=Math.min.apply(null,[...s,r[0].min]),u=Math.max.apply(null,[...s,r[0].max]);e.statistics=[{...r[0],min:c,max:u}]}else{let c=s[0],u=c;for(let h=0;h<s.length;h++)c=c>s[h]?s[h]:c,u=u>s[h]?u:s[h];e.statistics=[{...r[0],min:c,max:u}]}return this.rasterInfo=e,this.lookup=n?null:b8e({srcPixelType:i,inputRanges:o,outputValues:s,noDataRanges:a,allowUnmatched:n,isLastInputRangeInclusive:l,outputPixelType:this.outputPixelType}),{success:!0,supportsGPU:(!s||s.length<=qh)&&(!a||a.length<=qh)}}_processPixels(e){var u;const i=(u=e.pixelBlocks)==null?void 0:u[0];if(i==null)return null;const{lookup:r,outputPixelType:n}=this;if(r){const h=LP(i,{lut:[r.lut],offset:r.offset,outputPixelType:n});return h!=null&&r.mask&&(h.mask=z9(i.pixels[0],i.mask,r.mask,r.offset,"u8")),h}const{inputRanges:s,outputValues:o,noDataRanges:a,allowUnmatched:l,isLastInputRangeInclusive:c}=this.functionArguments;return v8e(i,{inputRanges:s,outputValues:o,noDataRanges:a,outputPixelType:n,allowUnmatched:l,isLastInputRangeInclusive:c})}_getWebGLParameters(){const{allowUnmatched:e,noDataRanges:i,isLastInputRangeInclusive:r}=this.functionArguments,n=new Float32Array(3*qh),s=1e-5,o=this.functionArguments.inputRanges??[],a=this.functionArguments.outputValues??[],l=a.length;for(let u=0;u<qh;u++)n[3*u]=o[2*u]??Jm-1,n[3*u+1]=o[2*u+1]??Jm,n[3*u+2]=a[u]??0,u<l&&(u>0&&(n[3*u]-=s),(u<l-1||!r)&&(n[3*u+1]-=s));const c=new Float32Array(2*qh);return c.fill(Jm),i!=null&&i.length&&c.set(i),{allowUnmatched:e,rangeMaps:n,noDataRanges:c,clampRange:Au(this.outputPixelType)}}};d([p({json:{write:!0,name:"rasterFunction"}})],Ky.prototype,"functionName",void 0),d([p({type:U9e,json:{write:!0,name:"rasterFunctionArguments"}})],Ky.prototype,"functionArguments",void 0),d([p()],Ky.prototype,"rasterArgumentNames",void 0),d([p({json:{write:!0}})],Ky.prototype,"lookup",void 0),Ky=d([A("esri.layers.support.rasterFunctions.RemapFunction")],Ky);const G9e=Ky;var sj;const H9e=new He({1:"degree",2:"percent-rise",3:"adjusted"},{useNumericKeys:!0});let Df=sj=class extends Uo{constructor(){super(...arguments),this.slopeType="degree",this.zFactor=1,this.pixelSizePower=.664,this.pixelSizeFactor=.024,this.removeEdgeEffect=!1}clone(){return new sj({slopeType:this.slopeType,zFactor:this.zFactor,pixelSizePower:this.pixelSizePower,pixelSizeFactor:this.pixelSizeFactor,removeEdgeEffect:this.removeEdgeEffect,raster:this.raster})}};d([xe(H9e)],Df.prototype,"slopeType",void 0),d([p({type:Number,json:{write:!0}})],Df.prototype,"zFactor",void 0),d([p({type:Number,json:{name:"psPower",write:!0}})],Df.prototype,"pixelSizePower",void 0),d([p({type:Number,json:{name:"psZFactor",write:!0}})],Df.prototype,"pixelSizeFactor",void 0),d([p({type:Boolean,json:{write:!0}})],Df.prototype,"removeEdgeEffect",void 0),Df=sj=d([A("esri.layers.support.rasterFunctions.SlopeFunctionArguments")],Df);const q9e=Df;let Xy=class extends Go{constructor(){super(...arguments),this.functionName="Slope",this.functionArguments=null,this.rasterArgumentNames=["raster"],this.isGCS=!1}_bindSourceRasters(){var i;this.outputPixelType=this._getOutputPixelType("f32");const e=this.sourceRasterInfos[0].clone();return e.pixelType=this.outputPixelType,e.statistics=this.functionArguments.slopeType!=="percent-rise"?[{min:0,max:90,avg:1,stddev:1}]:null,e.histograms=null,e.colormap=null,e.attributeTable=null,e.bandCount=1,this.rasterInfo=e,this.isGCS=((i=e.spatialReference)==null?void 0:i.isGeographic)??!1,{success:!0,supportsGPU:!0}}_processPixels(e){var f;const i=(f=e.pixelBlocks)==null?void 0:f[0];if(i==null)return null;const{zFactor:r,slopeType:n,pixelSizePower:s,pixelSizeFactor:o}=this.functionArguments,{isGCS:a}=this,{extent:l,primaryPixelSizes:c}=e,u=c==null?void 0:c[0],h=u??(l?{x:l.width/i.width,y:l.height/i.height}:{x:1,y:1});return ZBe(i,{zFactor:r,slopeType:n,pixelSizePower:s,pixelSizeFactor:o,isGCS:a,resolution:h})}_getWebGLParameters(){const{zFactor:e,slopeType:i,pixelSizeFactor:r,pixelSizePower:n}=this.functionArguments;return{zFactor:this.isGCS&&e>=1?e*Yh:e,slopeType:i,pixelSizeFactor:r??0,pixelSizePower:n??0}}};d([p({json:{write:!0,name:"rasterFunction"}})],Xy.prototype,"functionName",void 0),d([p({type:q9e,json:{write:!0,name:"rasterFunctionArguments"}})],Xy.prototype,"functionArguments",void 0),d([p()],Xy.prototype,"rasterArgumentNames",void 0),d([p({json:{write:!0}})],Xy.prototype,"isGCS",void 0),Xy=d([A("esri.layers.support.rasterFunctions.SlopeFunction")],Xy);const W9e=Xy;var oj;let Qy=oj=class extends Uo{constructor(){super(...arguments),this.statistics=null,this.histograms=null}readStatistics(t,e){if(!(t!=null&&t.length))return null;const i=[];return t.forEach(r=>{const n={min:r.min,max:r.max,avg:r.avg??r.mean,stddev:r.stddev??r.standardDeviation};i.push(n)}),i}writeStatistics(t,e,i){if(!(t!=null&&t.length))return;const r=[];t.forEach(n=>{const s={...n,mean:n.avg,standardDeviation:n.stddev};delete s.avg,delete s.stddev,r.push(s)}),e[i]=r}clone(){return new oj({statistics:U(this.statistics),histograms:U(this.histograms)})}};d([p({json:{write:!0}})],Qy.prototype,"statistics",void 0),d([ae("statistics")],Qy.prototype,"readStatistics",null),d([ge("statistics")],Qy.prototype,"writeStatistics",null),d([p({json:{write:!0}})],Qy.prototype,"histograms",void 0),Qy=oj=d([A("esri.layers.support.rasterFunctions.StatisticsHistogramFunctionArguments")],Qy);const J9e=Qy;let Nf=class extends Go{constructor(){super(...arguments),this.functionName="StatisticsHistogram",this.functionArguments=null,this.rasterArgumentNames=["raster"],this.isNoopProcess=!0}_bindSourceRasters(){const e=this.sourceRasterInfos[0];this.outputPixelType=this._getOutputPixelType("u8");const i=e.clone(),{statistics:r,histograms:n}=this.functionArguments;return n&&(i.histograms=n),r&&(i.statistics=r),this.rasterInfo=i,{success:!0,supportsGPU:!0}}_processPixels(e){var i;return(i=e.pixelBlocks)==null?void 0:i[0]}};d([p({json:{write:!0,name:"rasterFunction"}})],Nf.prototype,"functionName",void 0),d([p({type:J9e,json:{write:!0,name:"rasterFunctionArguments"}})],Nf.prototype,"functionArguments",void 0),d([p()],Nf.prototype,"rasterArgumentNames",void 0),d([p({json:{write:!0}})],Nf.prototype,"indexedColormap",void 0),d([p()],Nf.prototype,"isNoopProcess",void 0),Nf=d([A("esri.layers.support.rasterFunctions.StatisticsHistogramFunction")],Nf);const Z9e=Nf;var aj;const Y9e=new He({0:"none",3:"standard-deviation",4:"histogram-equalization",5:"min-max",6:"percent-clip",9:"sigmoid"},{useNumericKeys:!0});let Ts=aj=class extends Uo{constructor(){super(...arguments),this.computeGamma=!1,this.dynamicRangeAdjustment=!1,this.gamma=[],this.histograms=null,this.statistics=null,this.stretchType="none",this.useGamma=!1}writeStatistics(t,e,i){t!=null&&t.length&&(Array.isArray(t[0])||(t=t.map(r=>[r.min,r.max,r.avg,r.stddev])),e[i]=t)}clone(){return new aj({stretchType:this.stretchType,outputMin:this.outputMin,outputMax:this.outputMax,useGamma:this.useGamma,computeGamma:this.computeGamma,statistics:U(this.statistics),gamma:U(this.gamma),sigmoidStrengthLevel:this.sigmoidStrengthLevel,numberOfStandardDeviations:this.numberOfStandardDeviations,minPercent:this.minPercent,maxPercent:this.maxPercent,histograms:U(this.histograms),dynamicRangeAdjustment:this.dynamicRangeAdjustment,raster:this.raster})}};d([p({type:Boolean,json:{write:!0}})],Ts.prototype,"computeGamma",void 0),d([p({type:Boolean,json:{name:"dra",write:!0}})],Ts.prototype,"dynamicRangeAdjustment",void 0),d([p({type:[Number],json:{write:!0}})],Ts.prototype,"gamma",void 0),d([p()],Ts.prototype,"histograms",void 0),d([p({type:Number,json:{write:!0}})],Ts.prototype,"maxPercent",void 0),d([p({type:Number,json:{write:!0}})],Ts.prototype,"minPercent",void 0),d([p({type:Number,json:{write:!0}})],Ts.prototype,"numberOfStandardDeviations",void 0),d([p({type:Number,json:{name:"max",write:!0}})],Ts.prototype,"outputMax",void 0),d([p({type:Number,json:{name:"min",write:!0}})],Ts.prototype,"outputMin",void 0),d([p({type:Number,json:{write:!0}})],Ts.prototype,"sigmoidStrengthLevel",void 0),d([p({json:{type:[[Number]],write:!0}})],Ts.prototype,"statistics",void 0),d([ge("statistics")],Ts.prototype,"writeStatistics",null),d([xe(Y9e)],Ts.prototype,"stretchType",void 0),d([p({type:Boolean,json:{write:!0}})],Ts.prototype,"useGamma",void 0),Ts=aj=d([A("esri.layers.support.rasterFunctions.StretchFunctionArguments")],Ts);const K9e=Ts,L5=1,X9e=[.299,.587,.114];function Ffe(t,e=256){e=Math.min(e,256);const{size:i,counts:r}=t,n=new Uint8Array(i),s=r.reduce((u,h)=>u+h/e,0);let o=0,a=0,l=0,c=s;for(let u=0;u<i;u++)if(l+=r[u],!(u<i-1&&l+r[u+1]<c)){for(;o<e-1&&c<l;)o++,c+=s;for(let h=a;h<=u;h++)n[h]=o;a=u+1}for(let u=a;u<i;u++)n[u]=e-1;return n}function lj(t){const{minCutOff:e,maxCutOff:i,gamma:r,pixelType:n,rounding:s}=t,o=t.outMin||0,a=t.outMax||255;if(!["u8","u16","s8","s16"].includes(n))return null;const l=e.length;let c,u,h=0;n==="s8"?h=-127:n==="s16"&&(h=-32767);let f=256;["u16","s16"].includes(n)&&(f=65536);const m=[],g=[],y=a-o;for(c=0;c<l;c++)g[c]=i[c]-e[c],m[c]=g[c]===0?0:y/g[c];let v;const b=[];let w,x,S;if(r&&r.length>=l){const I=rG(l,r);for(c=0;c<l;c++){for(S=[],u=0;u<f;u++)if(g[c]!==0)if(w=u+h,v=(w-e[c])/g[c],x=1,r[c]>1&&(x-=(1/y)**(v*I[c])),w<i[c]&&w>e[c]){const T=x*y*v**(1/r[c])+o;S[u]=s==="floor"?Math.floor(T):s==="round"?Math.round(T):T}else w>=i[c]?S[u]=a:S[u]=o;else S[u]=o;b[c]=S}}else for(c=0;c<l;c++){for(S=[],u=0;u<f;u++)if(w=u+h,w<=e[c])S[u]=o;else if(w>=i[c])S[u]=a;else{const I=(w-e[c])*m[c]+o;S[u]=s==="floor"?Math.floor(I):s==="round"?Math.round(I):I}b[c]=S}if(t.contrastOffset!=null){const I=Q9e(t.contrastOffset,t.brightnessOffset);for(c=0;c<l;c++)for(S=b[c],u=0;u<f;u++)S[u]=I[S[u]]}return{lut:b,offset:h}}function Q9e(t,e){const i=Math.min(Math.max(t,-100),100),r=Math.min(Math.max(e??0,-100),100),n=255,s=128;let o=0,a=0;const l=new Uint8Array(256);for(o=0;o<256;o++)i>0&&i<100?a=(200*o-100*n+2*n*r)/(2*(100-i))+s:i<=0&&i>-100?a=(200*o-100*n+2*n*r)*(100+i)/2e4+s:i===100?(a=200*o-100*n+(n+1)*(100-i)+2*n*r,a=a>0?n:0):i===-100&&(a=s),l[o]=a>n?n:a<0?0:a;return l}function eGe(t,e,i){const r=[];for(let n=0;n<e.length;n++){let s=0,o=0,a=0;"min"in e[n]?{min:s,max:o,avg:a}=e[n]:[s,o,a]=e[n];let l=a??0;t!=="u8"&&(l=255*(l-s)/(o-s)),i&&(l*=X9e[n]),r.push(tGe(l))}return r}function tGe(t){if(t<=0||t>=255)return L5;let e=0;t!==150&&(e=t<=150?45*Math.cos(.01047*t):17*Math.sin(.021*t));const i=255,r=t+e,n=Math.log(t/i),s=Math.log(r/i);if(s===0)return L5;const o=n/s;return isNaN(o)?L5:Math.min(9.9,Math.max(.01,o))}function iGe(t,e,i,r){let n=1/0,s=-1/0,o=0,a=0;const l=t.length;for(let b=0;b<l;b++){const w=t[b];e&&!e[b]||(n=w<n?w:n,s=w>s?w:s,o+=w,a++)}if(a===0)return{statistics:{min:0,max:0,avg:0,stddev:0},histogram:null};const c=o/a;let u=0;for(let b=0;b<l;b++)e&&!e[b]||(u+=(t[b]-c)**2);const h=e?e.filter(b=>b).length:l,f={min:n,max:s,avg:c,stddev:h<=1?0:Math.sqrt(u/(h-1))};if(!r)return{statistics:f,histogram:null};if(["u8","s8","u4","u2","u1"].includes(i)){const b=s-n+1,w=new Uint32Array(b);for(let x=0;x<l;x++)e&&!e[x]||w[t[x]-n]++;return{statistics:f,histogram:{min:n-.5,max:s+.5,size:b,counts:w}}}const m=256,g=new Uint32Array(m),y=(s-n)/m;if(y===0)return{statistics:f,histogram:{min:n,max:s,size:1,counts:new Uint32Array(1).fill(a)}};const v=new Uint32Array(m+1);for(let b=0;b<l;b++)e&&!e[b]||v[Math.floor((t[b]-n)/y)]++;for(let b=0;b<m-1;b++)g[b]=v[b];return g[m-1]=v[m-1]+v[m],{statistics:f,histogram:{min:n,max:s,size:m,counts:g}}}function rGe(t){const{pixels:e,mask:i,pixelType:r,bandMasks:n}=t,s=e.map((o,a)=>iGe(o,(n==null?void 0:n[a])??i,r,!0));return{statistics:s.map(({statistics:o})=>o),histograms:s.map(({histogram:o})=>o)}}function Dfe(t){var $;if(t==null||!(($=t.pixels)!=null&&$.length))return null;const{pixels:e,mask:i,bandMasks:r,pixelType:n}=t,s=t.width*t.height,o=e.length;let a,l,c,u,h;const f=[],m=[];let g,y,v,b,w,x,S,I,T,C;const E=256;for(u=0;u<o;u++){g=new Uint32Array(E),v=e[u];const P=(r==null?void 0:r[u])??i;if(n==="u8")if(a=-.5,l=255.5,P)for(h=0;h<s;h++)P[h]&&g[v[h]]++;else for(h=0;h<s;h++)g[v[h]]++;else{let k=!1;t.statistics||(t.updateStatistics(),k=!0);const L=t.statistics;if(a=L[u].minValue,l=L[u].maxValue,c=(l-a)/E,c===0){!L||t.validPixelCount||k||t.updateStatistics();const F=(t.validPixelCount||t.width*t.height)/E;for(let V=0;V<E;V++)g[V]=Math.round(F*(V+1))-Math.round(F*V)}else{for(y=new Uint32Array(E+1),h=0;h<s;h++)P&&!P[h]||y[Math.floor((v[h]-a)/c)]++;for(h=0;h<E-1;h++)g[h]=y[h];g[E-1]=y[E-1]+y[E]}}for(f.push({min:a,max:l,size:E,counts:g}),b=0,w=0,I=0,h=0;h<E;h++)b+=g[h],w+=h*g[h];for(T=w/b,h=0;h<E;h++)I+=g[h]*(h-T)**2;C=Math.sqrt(I/(b-1)),c=(l-a)/E,x=(T+.5)*c+a,S=C*c,m.push({min:a,max:l,avg:x,stddev:S})}return{statistics:m,histograms:f}}function iG(t){const e=[];for(let i=0;i<t.length;i++){const{min:r,max:n,size:s,counts:o}=t[i];let a=0,l=0;for(let g=0;g<s;g++)a+=o[g],l+=g*o[g];const c=l/a;let u=0;for(let g=0;g<s;g++)u+=o[g]*(g-c)**2;const h=(n-r)/s,f=(c+.5)*h+r,m=Math.sqrt(u/(a-1))*h;e.push({min:r,max:n,avg:f,stddev:m})}return e}function bm(t,e){var P;const{pixelBlock:i,bandIds:r,returnHistogramLut:n,rasterInfo:s}=e;let o=null,a=null,l=t.stretchType;if(typeof l=="number"&&(l=Vpe[l]),t.dra)if(l==="minMax"&&i!=null&&i.statistics)o=i.statistics.map(k=>[k.minValue,k.maxValue,0,0]);else{const k=Dfe(i);o=k!=null?k.statistics:null,a=k!=null?k.histograms:null}else o=((P=t.statistics)==null?void 0:P.length)>0?t.statistics:s.statistics,a="histograms"in t?t.histograms:void 0,a||(a=s.histograms);l!=="percentClip"&&l!=="histogramEqualization"||a!=null&&a.length||(l="minMax");const c=(o==null?void 0:o.length)||(a==null?void 0:a.length)||s.bandCount,u=[],h=[];let f,m,g,y,v,b,w,x,S;o&&!Array.isArray(o[0])&&(o=o.map(k=>[k.min,k.max,k.avg,k.stddev]));const[I,T]=Au(s.pixelType);if(!(o!=null&&o.length)){for(o=[],x=0;x<c;x++)o.push([I,T,1,1]);l==="standardDeviation"&&(l="minMax")}switch(l){case"none":for(x=0;x<c;x++)u[x]=I,h[x]=T;break;case"minMax":for(x=0;x<c;x++){const k=o[x];u[x]=k[0],h[x]=k[1]}break;case"standardDeviation":for(x=0;x<c;x++){const k=o[x];u[x]=k[2]-t.numberOfStandardDeviations*k[3],h[x]=k[2]+t.numberOfStandardDeviations*k[3],u[x]<k[0]&&(u[x]=k[0]),h[x]>k[1]&&(h[x]=k[1])}break;case"histogramEqualization":for(lo(a),x=0;x<c;x++)u[x]=a[x].min,h[x]=a[x].max;break;case"percentClip":for(lo(a),x=0;x<a.length;x++){for(f=a[x],v=new Uint32Array(f.size),y=[...f.counts],y.length>=20&&(y[0]=y[1]=y[2]=y[y.length-1]=y[y.length-2]=0),g=0,m=(f.max-f.min)/f.size,w=f.min===-.5&&m===1?.5:0,S=0;S<f.size;S++)g+=y[S],v[S]=g;for(b=(t.minPercent||0)*g/100,u[x]=f.min+w,S=0;S<f.size;S++)if(v[S]>b){u[x]=f.min+m*(S+w);break}for(b=(1-(t.maxPercent||0)/100)*g,h[x]=f.max+w,S=f.size-2;S>=0;S--)if(v[S]<b){h[x]=f.min+m*(S+2-w);break}if(h[x]<u[x]){const k=u[x];u[x]=h[x],h[x]=k}}break;default:for(x=0;x<c;x++){const k=o[x];u[x]=k[0],h[x]=k[1]}}let C,E,$;return l==="histogramEqualization"?(lo(a),E=a[0].size||256,C=0,n&&($=a.map(k=>Ffe(k)))):(E=t.max||255,C=t.min||0),nGe({minCutOff:u,maxCutOff:h,outMax:E,outMin:C,histogramLut:$},r)}function nGe(t,e){if(e==null||e.length===0)return t;const i=Math.max.apply(null,e),{minCutOff:r,maxCutOff:n,outMin:s,outMax:o,histogramLut:a}=t;return r.length===e.length||r.length<=i?t:{minCutOff:e.map(l=>r[l]),maxCutOff:e.map(l=>n[l]),histogramLut:a?e.map(l=>a[l]):null,outMin:s,outMax:o}}function rG(t,e){const i=new Float32Array(t);for(let r=0;r<t;r++)e[r]>1?e[r]>2?i[r]=6.5+(e[r]-2)**2.5:i[r]=6.5+100*(2-e[r])**4:i[r]=1;return i}function AA(t,e){var C;if(t==null||!((C=t.pixels)!=null&&C.length))return t;const{mask:i,bandMasks:r,width:n,height:s,pixels:o}=t,{minCutOff:a,maxCutOff:l,gamma:c}=e,u=e.outMin||0,h=e.outMax||255,f=n*s,m=e.outputPixelType||"u8",g=t.pixels.map(()=>de.createEmptyBand(m,f)),y=g.length,v=h-u,b=[],w=[];for(let E=0;E<y;E++)w[E]=l[E]-a[E],b[E]=w[E]===0?0:v/w[E];const x=m.startsWith("u")||m.startsWith("s"),S=c&&c.length>=y,I=!!e.isRenderer;if(S){const E=rG(y,c);for(let $=0;$<y;$++){const P=(r==null?void 0:r[$])??i;for(let k=0;k<f;k++)if(P==null||P[k]){if(w[$]===0){g[$][k]=u;continue}const L=o[$][k],F=(L-a[$])/w[$];let V=1;if(c[$]>1&&(V-=(1/v)**(F*E[$])),L<l[$]&&L>a[$]){const z=V*v*F**(1/c[$])+u;g[$][k]=I?Math.floor(z):x?Math.round(z):z}else L>=l[$]?g[$][k]=h:g[$][k]=u}}}else for(let E=0;E<y;E++){const $=(r==null?void 0:r[E])??i;for(let P=0;P<f;P++)if($==null||$[P]){const k=o[E][P];if(k<l[E]&&k>a[E]){const L=(k-a[E])*b[E]+u;g[E][P]=I?Math.floor(L):x?Math.round(L):L}else k>=l[E]?g[E][P]=h:g[E][P]=u}}const T=new de({width:n,height:s,mask:i,bandMasks:r,pixels:g,pixelType:m});return T.updateStatistics(),T}let Vf=class extends Go{constructor(){super(...arguments),this.functionName="Stretch",this.functionArguments=null,this.rasterArgumentNames=["raster"],this.lookup=null,this.cutOffs=null}_bindSourceRasters(){this.lookup=null,this.cutOffs=null;const e=this.sourceRasterInfos[0],{pixelType:i}=e,{functionArguments:r}=this,{dynamicRangeAdjustment:n,gamma:s,useGamma:o}=r;if(!n&&["u8","u16","s8","s16"].includes(i)){const l=bm(r.toJSON(),{rasterInfo:e}),c=this._isOutputRoundingNeeded()?"round":"float";this.lookup=lj({pixelType:i,...l,gamma:o?s:null,rounding:c}),this.cutOffs=l}else n||(this.cutOffs=bm(r.toJSON(),{rasterInfo:e}));this.outputPixelType=this._getOutputPixelType(i);const a=e.clone();return a.pixelType=this.outputPixelType,a.statistics=null,a.histograms=null,a.colormap=null,a.attributeTable=null,this.outputPixelType==="u8"&&(a.keyProperties.DataType="processed"),this.rasterInfo=a,{success:!0,supportsGPU:!n}}_processPixels(e){var a;const i=(a=e.pixelBlocks)==null?void 0:a[0];if(i==null)return i;const{lookup:r}=this;if(r)return LP(i,{...r,outputPixelType:this.rasterInfo.pixelType});const{functionArguments:n}=this,s=this.cutOffs||bm(n.toJSON(),{rasterInfo:this.sourceRasterInfos[0],pixelBlock:i}),o=n.useGamma?n.gamma:null;return AA(i,{...s,gamma:o,outputPixelType:this.outputPixelType})}_getWebGLParameters(){const{outputMin:e=0,outputMax:i=255,gamma:r,useGamma:n}=this.functionArguments,s=this.rasterInfo.bandCount>=2?3:1,o=n&&r&&r.length?rG(s,r):[1,1,1],{minCutOff:a,maxCutOff:l}=this.cutOffs??{minCutOff:[0,0,0],maxCutOff:[255,255,255]};a.length===1&&(a[1]=a[2]=a[0],l[1]=l[2]=l[0]);const c=new Float32Array(s);let u;for(u=0;u<s;u++)c[u]=(i-e)/(l[u]-a[u]);const h=this._isOutputRoundingNeeded();return{bandCount:s,outMin:e,outMax:i,minCutOff:a,maxCutOff:l,factor:c,useGamma:n,gamma:n&&r?r:[1,1,1],gammaCorrection:n&&o?o:[1,1,1],stretchType:this.functionArguments.stretchType,isOutputRounded:h,type:"stretch"}}};d([p({json:{write:!0,name:"rasterFunction"}})],Vf.prototype,"functionName",void 0),d([p({type:K9e,json:{write:!0,name:"rasterFunctionArguments"}})],Vf.prototype,"functionArguments",void 0),d([p()],Vf.prototype,"rasterArgumentNames",void 0),d([p({json:{write:!0}})],Vf.prototype,"lookup",void 0),d([p({json:{write:!0}})],Vf.prototype,"cutOffs",void 0),Vf=d([A("esri.layers.support.rasterFunctions.StretchFunction")],Vf);const sGe=Vf;var cj;let kA=cj=class extends Uo{constructor(){super(...arguments),this.attributeTableAsRecordSet=null}clone(){return new cj({attributeTableAsRecordSet:U(this.attributeTableAsRecordSet)})}};d([p({json:{write:!0}})],kA.prototype,"attributeTableAsRecordSet",void 0),kA=cj=d([A("esri.layers.support.rasterFunctions.TableFunctionArguments")],kA);const oGe=kA;let e0=class extends Go{constructor(){super(...arguments),this.functionName="Table",this.functionArguments=null,this.rasterArgumentNames=["raster"],this.isNoopProcess=!0}_bindSourceRasters(){const e=this.sourceRasterInfos[0];if(e.bandCount>1||e.pixelType.startsWith("f"))return{success:!1,supportsGPU:!1,error:"table-function: Source data must be single band and integer pixel type."};const{attributeTableAsRecordSet:i}=this.functionArguments;if(!i)return{success:!1,supportsGPU:!1,error:"table-function: Missing attributeTableAsRecordSet argument."};this.outputPixelType=this._getOutputPixelType(e.pixelType);const r=e.clone();return r.pixelType=this.outputPixelType,r.bandCount=1,r.dataType!=="thematic"&&(r.keyProperties=r.keyProperties?{...r.keyProperties,DataType:"thematic"}:{DataType:"thematic"}),this.rasterInfo=r,{success:!0,supportsGPU:!0}}_processPixels(e){var i;return(i=e.pixelBlocks)==null?void 0:i[0]}};d([p({json:{write:!0,name:"rasterFunction"}})],e0.prototype,"functionName",void 0),d([p({type:oGe,json:{write:!0,name:"rasterFunctionArguments"}})],e0.prototype,"functionArguments",void 0),d([p()],e0.prototype,"rasterArgumentNames",void 0),d([p()],e0.prototype,"isNoopProcess",void 0),e0=d([A("esri.layers.support.rasterFunctions.TableFunction")],e0);const aGe=e0,Ms=new Map;function Nfe(t,e){const{rasterFunctionArguments:i}=t;i&&(i.rasters||[i.raster]).forEach(r=>{r&&typeof r!="number"&&(typeof r=="string"?r.startsWith("http")&&(e.includes(r)||e.push(r)):"rasterFunctionArguments"in r&&Nfe(r,e))})}function uj(t,e){if(e=e??{},"function"in(t=U(t))&&"arguments"in t&&t.arguments){const i=jfe(t,new Map,e);if(pj(i),!i.renderingRule)throw new N("raster-function-helper","Unsupported raster function json.");t=i.renderingRule}if("rasterFunction"in t)return Vfe(t=dj(t),e);throw new N("raster-function-helper","unsupported raster function json.")}function lGe(t,e){return e[0]==="rasters"&&Array.isArray(t.rasters)?t.rasters:e.map(i=>t[i])}function ZY(t){return!!(t&&typeof t=="object"&&t.rasterFunction&&t.rasterFunctionArguments)}function dj(t){var n;const{rasterFunction:e,rasterFunctionArguments:i}=t,r={};for(const s in i){let o=i[s];const a=s.toLowerCase();if(a==="rasters"&&Array.isArray(o))r.rasters=o.map(l=>ZY(l)?dj(l):l);else switch(ZY(o)&&(o=dj(o)),a){case"dra":r.dra=o;break;case"pspower":r.psPower=o;break;case"pszfactor":r.psZFactor=o;break;case"bandids":r.bandIds=o;break;default:r[s[0].toLowerCase()+s.slice(1)]=o}}return e!=="Local"||(n=r.rasters)!=null&&n.length||(r.rasters=["$$"]),{...t,rasterFunctionArguments:r}}function Vfe(t,e){var f,m;const{rasterFunction:i,rasterFunctionArguments:r}=t,n=(f=t.outputPixelType)==null?void 0:f.toLowerCase();if(i==null||!Ms.has(i))throw new N("raster-function-helper",`unsupported raster function: ${i}`);const s=Ms.get(i),o=(typeof s.ctor=="function"?s.ctor:s.ctor.default).fromJSON({...t,outputPixelType:n}),{rasterArgumentNames:a}=o,l=[],c=lGe(r,a),u=a[0]==="rasters",h=[];for(let g=0;g<c.length;g++){const y=c[g];let v;y==null||typeof y=="string"&&y.startsWith("$")?l.push(e==null?void 0:e.raster):typeof y=="string"?e[y]&&l.push(e[y]):typeof y!="number"&&"rasterFunction"in y&&(v=Vfe(y,e),u||(o.functionArguments[a[g]]=v),l.push(v)),u&&h.push(v??y)}if(u&&(o.functionArguments.rasters=h),e){o.sourceRasters=l;const g=(m=e.raster)==null?void 0:m.url;g&&(o.mainPrimaryRasterId=g)}return o}function zfe(t,e){if(t&&e)for(const i in t){const r=t[i];r&&typeof r=="object"&&"type"in r&&(r.type==="RasterFunctionTemplate"?zfe(r.arguments,e):r.type==="RasterFunctionVariable"&&e[r.name]!=null&&(r.value=e[r.name]))}}function hj(t,e){var n;if(!t||typeof t!="object")return t;const{value:i}=t;if(!i||typeof i!="object")return t.isDataset?"$$":i;if(Array.isArray(i))return i.length===0?[]:i.map(s=>typeof s=="object"&&s.type==="RasterFunctionVariable"?hj(s,e):s);if("value"in i&&["number","string","boolean"].includes(typeof i.value))return i.value;if(t.isDataset&&i.type!=="Scalar")return"$$";if(!("type"in i))return i;let r=i;switch(i.type){case"Scalar":r=i.value;break;case"AlgorithmicColorRamp":r=YY(i);break;case"MultiPartColorRamp":r={type:"multipart",colorRamps:i.ArrayOfColorRamp.map(YY)};break;case"ArgumentArray":if((n=i.elements)!=null&&n.length&&i.elements[0].type!=="RasterStatistics"){const s=[];for(let o=0;o<i.elements.length;o++){const a=i.elements[o],{type:l}=a;if(l)if(l==="RasterFunctionTemplate"){const{renderingRule:c}=jfe(a,e);s.push(c),a._object_id!=null&&e.set(a._object_id,c)}else{if(l!=="RasterFunctionVariable")throw new N("raster-function-helper","unsupported raster function json.");{const c=hj(a,e);s.push(c),a._object_id!=null&&e.set(a._object_id,c)}}else s.push(a)}r=s}else r=i.elements}return i._object_id!=null&&e.set(i._object_id,r),r}function YY(t){const e=t.algorithm??"esriHSVAlgorithm";let{FromColor:i,ToColor:r}=t;if(!Array.isArray(i)){const{r:n,g:s,b:o}=pg({h:i.Hue,s:i.Saturation,v:i.Value});i=[n,s,o,i.AlphaValue]}if(!Array.isArray(r)){const{r:n,g:s,b:o}=pg({h:r.Hue,s:r.Saturation,v:r.Value});r=[n,s,o,r.AlphaValue]}return{type:"algorithmic",algorithm:e,fromColor:i,toColor:r}}function jfe(t,e,i){i&&zfe(t,i);const r={renderingRule:{},templates:e};return Bfe(t,r),r}function Bfe(t,e){if(!t||!e.renderingRule)return;const{renderingRule:i,templates:r}=e,{function:n,arguments:s,_object_id:o}=t;if(!n||!s)return;o!=null&&r.set(o,i),i.rasterFunction=n.type.replace("Function",""),i.outputPixelType=n.pixelType;const a={};i.rasterFunctionArguments=a;for(const l in s){if(l==="type"||l==="object_id"||l==="_object_ref_id")continue;const c=s[l];c&&typeof c=="object"&&"type"in c&&(c.type==="RasterFunctionTemplate"||c.type==="RasterFunctionVariable")?(c.type==="RasterFunctionVariable"?a[l]=hj(c,r):(i.rasterFunctionArguments[l]={},Bfe(c,{renderingRule:i.rasterFunctionArguments[l],templates:r})),c._object_id!=null&&r.set(c._object_id,a[l])):a[l]=c}switch(a.DEM&&!a.Raster&&(a.Raster=a.DEM,delete a.DEM),i.rasterFunction){case"Stretch":cGe(a);break;case"Colormap":uGe(a);break;case"Convolution":dGe(a);break;case"Mask":hGe(a)}}function pj(t){const{renderingRule:e,templates:i}=t;if(typeof e!="object"||!(e!=null&&e.rasterFunctionArguments)||!i.size)return;const{rasterFunctionArguments:r}=e;for(const n in r){const s=r[n],o=n==="_object_ref_id"?s:s&&typeof s=="object"&&"_object_ref_id"in s?s._object_ref_id:null;if(o==null)s&&typeof s=="object"&&(s.rasterFunctionArguments&&pj({renderingRule:s,templates:i}),Array.isArray(s)&&s.forEach((a,l)=>{if(typeof a=="object")if(a._object_ref_id!=null){if(!i.has(a._object_ref_id))throw new N("raster-function-helper",`unsupported raster function json. _object_ref_id: ${s} does not exist`);const c=i.get(o);c&&typeof c=="object"?Object.assign(a,c):s[l]=c}else pj({renderingRule:a,templates:i})}));else{if(!i.has(o))throw new N("raster-function-helper",`unsupported raster function json. _object_ref_id: ${o} does not exist`);const a=i.get(o);n!=="_object_ref_id"?r[n]=a:a&&typeof a=="object"&&Object.assign(r,a)}}}function cGe(t){var e;(e=t.Statistics)!=null&&e.length&&typeof t.Statistics=="object"&&(t.Statistics=t.Statistics.map(i=>[i.min,i.max,i.mean,i.standardDeviation])),t.NumberOfStandardDeviation!=null&&(t.NumberOfStandardDeviations=t.NumberOfStandardDeviation,delete t.NumberOfStandardDeviation)}function uGe(t){var e,i;((i=(e=t.ColorRamp)==null?void 0:e.type)==null?void 0:i.toLowerCase())==="randomcolorramp"&&(delete t.ColorRamp,t.ColormapName="Random"),t.ColorSchemeType===0&&delete t.ColorRamp}function dGe(t){t.ConvolutionType!=null&&(t.Type=t.ConvolutionType,delete t.ConvolutionType)}function hGe(t){var e;(e=t.NoDataValues)!=null&&e.length&&typeof t.NoDataValues[0]=="string"&&(t.NoDataValues=t.NoDataValues.filter(i=>i!=="").map(i=>Number(i)))}Ms.set("Aspect",{desc:"Aspect Function",ctor:XBe,rasterArgumentNames:["raster"]}),Ms.set("BandArithmetic",{desc:"Band Arithmetic Function",ctor:TUe,rasterArgumentNames:["raster"]}),Ms.set("Colormap",{desc:"Colormap Function",ctor:RUe,rasterArgumentNames:["raster"]}),Ms.set("CompositeBand",{desc:"CompositeBand Function",ctor:DUe,rasterArgumentNames:["rasters"]}),Ms.set("Convolution",{desc:"Convolution Function",ctor:qUe,rasterArgumentNames:["raster"]}),Ms.set("ExtractBand",{desc:"ExtractBand Function",ctor:YUe,rasterArgumentNames:["raster"]}),Ms.set("Curvature",{desc:"Curvature Function",ctor:JUe,rasterArgumentNames:["raster"]}),Ms.set("Local",{desc:"Local Function",ctor:N9e,rasterArgumentNames:["rasters"]}),Ms.set("Mask",{desc:"Mask Function",ctor:z9e,rasterArgumentNames:["raster"]}),Ms.set("NDVI",{desc:"NDVI Function",ctor:B9e,rasterArgumentNames:["raster"]}),Ms.set("Remap",{desc:"Remap Function",ctor:G9e,rasterArgumentNames:["raster"]}),Ms.set("Slope",{desc:"Slope Function",ctor:W9e,rasterArgumentNames:["raster"]}),Ms.set("StatisticsHistogram",{desc:"Statistics Histogram Function",ctor:Z9e,rasterArgumentNames:["raster"]}),Ms.set("Stretch",{desc:"Stretch Function",ctor:sGe,rasterArgumentNames:["raster"]}),Ms.set("Table",{desc:"Attribute Table Function",ctor:aGe,rasterArgumentNames:["raster"]});function pGe(t){var e,i,r;return["u8","s8"].includes(t.pixelType)&&((i=(e=t.statistics)==null?void 0:e[0])==null?void 0:i.min)!=null&&((r=t.statistics[0])==null?void 0:r.max)!=null&&t.bandCount===1}function nG(t,e){const{attributeTable:i,bandCount:r}=t;return i==null&&pGe(t)?!0:!(i==null||r>1||e&&i.fields.find(n=>n.name.toLowerCase()===e.toLowerCase())==null)}function Ufe(t){const{bandCount:e,dataType:i,pixelType:r}=t;return i==="elevation"||i==="generic"&&e===1&&(r==="s16"||r==="s32"||r==="f32"||r==="f64")}function sG(t,e=!1){const{bandCount:i,colormap:r,pixelType:n}=t;return i===1&&(!!(r!=null&&r.length)||!e&&n==="u8")}function fGe(t,e=!1){const{attributeTable:i,bandCount:r}=t;return r===1&&(!e||i!=null||t.histograms!=null)}function oG(t){const{dataType:e}=t;return e==="vector-uv"||e==="vector-magdir"}function mGe(t){const{dataType:e}=t;return e==="vector-uv"||e==="vector-magdir"}const KY=new He({esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation",esriClassifyDefinedInterval:"defined-interval"}),XY=new He({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:"percent-of-total",esriNormalizeByField:"field"});let Uc=class extends te{constructor(e){super(e),this.type="class-breaks-definition",this.breakCount=null,this.classificationField=null,this.classificationMethod=null,this.normalizationField=null,this.normalizationType=null}set standardDeviationInterval(e){this.classificationMethod==="standard-deviation"&&this._set("standardDeviationInterval",e)}set definedInterval(e){this.classificationMethod==="defined-interval"&&this._set("definedInterval",e)}};d([xe({classBreaksDef:"class-breaks-definition"})],Uc.prototype,"type",void 0),d([p({json:{write:!0}})],Uc.prototype,"breakCount",void 0),d([p({json:{write:!0}})],Uc.prototype,"classificationField",void 0),d([p({type:String,json:{read:KY.read,write:KY.write}})],Uc.prototype,"classificationMethod",void 0),d([p({json:{write:!0}})],Uc.prototype,"normalizationField",void 0),d([p({json:{read:XY.read,write:XY.write}})],Uc.prototype,"normalizationType",void 0),d([p({value:null,json:{write:!0}})],Uc.prototype,"standardDeviationInterval",null),d([p({value:null,json:{write:!0}})],Uc.prototype,"definedInterval",null),Uc=d([A("esri.rest.support.ClassBreaksDefinition")],Uc);const E1t=Uc,gGe=ie.getLogger("esri.rest.support.generateRendererUtils");function w_(t,e){return Number(t.toFixed(e))}function M1t(t){const{normalizationTotal:e}=t;return{classBreaks:yGe(t),normalizationTotal:e}}function yGe(t){const e=t.definition,{classificationMethod:i,normalizationType:r,definedInterval:n}=e,s=e.breakCount??1,o=[];let a=t.values;if(a.length===0)return[];a=a.sort((u,h)=>u-h);const l=a[0],c=a[a.length-1];if(i==="equal-interval")if(a.length>=s){const u=(c-l)/s;let h=l;for(let f=1;f<s;f++){const m=w_(l+f*u,6);o.push({minValue:h,maxValue:m,label:Jo(h,m,r)}),h=m}o.push({minValue:h,maxValue:c,label:Jo(h,c,r)})}else a.forEach(u=>{o.push({minValue:u,maxValue:u,label:Jo(u,u,r)})});else if(i==="natural-breaks"){const u=vGe(a),h=t.valueFrequency||u.valueFrequency,f=_Ge(u.uniqueValues,h,s);let m=l;for(let g=1;g<s;g++)if(u.uniqueValues.length>g){const y=w_(u.uniqueValues[f[g]],6);o.push({minValue:m,maxValue:y,label:Jo(m,y,r)}),m=y}o.push({minValue:m,maxValue:c,label:Jo(m,c,r)})}else if(i==="quantile")if(a.length>=s&&l!==c){let u=l,h=Math.ceil(a.length/s),f=0;for(let m=1;m<s;m++){let g=h+f-1;g>a.length&&(g=a.length-1),g<0&&(g=0),o.push({minValue:u,maxValue:a[g],label:Jo(u,a[g],r)}),u=a[g],f+=h,h=Math.ceil((a.length-f)/(s-m))}o.push({minValue:u,maxValue:c,label:Jo(u,c,r)})}else{let u=-1;for(let h=0;h<a.length;h++){const f=a[h];f!==u&&(u=f,o.push({minValue:u,maxValue:f,label:Jo(u,f,r)}),u=f)}}else if(i==="standard-deviation"){const u=xGe(a),h=SGe(a,u);if(h===0)o.push({minValue:a[0],maxValue:a[0],label:Jo(a[0],a[0],r)});else{const f=wGe(l,c,s,u,h)*h;let m=0,g=l;for(let v=s;v>=1;v--){const b=w_(u-(v-.5)*f,6);o.push({minValue:g,maxValue:b,label:Jo(g,b,r)}),g=b,m++}let y=w_(u+.5*f,6);o.push({minValue:g,maxValue:y,label:Jo(g,y,r)}),g=y,m++;for(let v=1;v<=s;v++)y=m===2*s?c:w_(u+(v+.5)*f,6),o.push({minValue:g,maxValue:y,label:Jo(g,y,r)}),g=y,m++}}else if(i==="defined-interval"){if(!n)return o;const u=a[0],h=a[a.length-1],f=Math.ceil((h-u)/n);let m=u;for(let g=1;g<f;g++){const y=w_(u+g*n,6);o.push({minValue:m,maxValue:y,label:Jo(m,y,r)}),m=y}o.push({minValue:m,maxValue:h,label:Jo(m,h,r)})}return o}function Jo(t,e,i){let r=null;return r=t===e?i&&i==="percent-of-total"?t+"%":t.toString():i&&i==="percent-of-total"?t+"% - "+e+"%":t+" - "+e,r}function vGe(t){const e=[],i=[];let r=Number.MIN_VALUE,n=1,s=-1;for(let o=0;o<t.length;o++){const a=t[o];a===r?(n++,i[s]=n):a!==null&&(e.push(a),r=a,n=1,i.push(n),s++)}return{uniqueValues:e,valueFrequency:i}}function _Ge(t,e,i){const r=t.length,n=[];i>r&&(i=r);for(let o=0;o<i;o++)n.push(Math.round(o*r/i-1));n.push(r-1);let s=QY(n,t,e,i);return bGe(s.mean,s.sdcm,n,t,e,i)&&(s=QY(n,t,e,i)),n}function QY(t,e,i,r){let n=[],s=[],o=[],a=0;const l=[],c=[];for(let m=0;m<r;m++){const g=dw(m,t,e,i);l.push(g.sbMean),c.push(g.sbSdcm),a+=c[m]}let u,h=a,f=!0;for(;f||a<h;){f=!1,n=[];for(let m=0;m<r;m++)n.push(t[m]);for(let m=0;m<r;m++)for(let g=t[m]+1;g<=t[m+1];g++)if(u=e[g],m>0&&g!==t[m+1]&&Math.abs(u-l[m])>Math.abs(u-l[m-1]))t[m]=g;else if(m<r-1&&t[m]!==g-1&&Math.abs(u-l[m])>Math.abs(u-l[m+1])){t[m+1]=g-1;break}h=a,a=0,s=[],o=[];for(let m=0;m<r;m++){s.push(l[m]),o.push(c[m]);const g=dw(m,t,e,i);l[m]=g.sbMean,c[m]=g.sbSdcm,a+=c[m]}}if(a>h){for(let m=0;m<r;m++)t[m]=n[m],l[m]=s[m],c[m]=o[m];a=h}return{mean:l,sdcm:c}}function bGe(t,e,i,r,n,s){let o=0,a=0,l=0,c=0,u=!0;for(let h=0;h<2&&u;h++){h===0&&(u=!1);for(let f=0;f<s-1;f++)for(;i[f+1]+1!==i[f+2];){i[f+1]=i[f+1]+1;const m=dw(f,i,r,n);l=m.sbMean,o=m.sbSdcm;const g=dw(f+1,i,r,n);if(c=g.sbMean,a=g.sbSdcm,!(o+a<e[f]+e[f+1])){i[f+1]=i[f+1]-1;break}e[f]=o,e[f+1]=a,t[f]=l,t[f+1]=c,u=!0}for(let f=s-1;f>0;f--)for(;i[f]!==i[f-1]+1;){i[f]=i[f]-1;const m=dw(f-1,i,r,n);l=m.sbMean,o=m.sbSdcm;const g=dw(f,i,r,n);if(c=g.sbMean,a=g.sbSdcm,!(o+a<e[f-1]+e[f])){i[f]=i[f]+1;break}e[f-1]=o,e[f]=a,t[f-1]=l,t[f]=c,u=!0}}return u}function wGe(t,e,i,r,n){let s=Math.max(r-t,e-r)/n/i;return s=s>=1?1:s>=.5?.5:.25,s}function xGe(t){let e=0;for(let i=0;i<t.length;i++)e+=t[i];return e/=t.length,e}function SGe(t,e){let i=0;for(let r=0;r<t.length;r++){const n=t[r];i+=(n-e)*(n-e)}return i/=t.length,Math.sqrt(i)}function dw(t,e,i,r){let n=0,s=0;for(let l=e[t]+1;l<=e[t+1];l++){const c=r[l];n+=i[l]*c,s+=c}s<=0&&gGe.warn("Exception in Natural Breaks calculation");const o=n/s;let a=0;for(let l=e[t]+1;l<=e[t+1];l++)a+=r[l]*(i[l]-o)**2;return{sbMean:o,sbSdcm:a}}const IGe=.25,TGe=$L.fromJSON({type:"multipart",colorRamps:[{fromColor:[0,0,255],toColor:[0,255,255]},{fromColor:[0,255,255],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,0,0]}]}),eK=$L.fromJSON(F9[0]),Gfe=new Set(["scientific","standard-time","vector-uv","vector-magdir","vector-u","vector-v","vector-magnitude","vector-direction"]);function tK(t,e){const{attributeTable:i,colormap:r}=t;if(oG(t)){const n=LGe(t);if(n!=null)return n}if(r!=null){const n=PGe(t);if(n!=null)return n}if(i!=null){const n=AGe(t);if(n!=null)return n}return EGe(t,e)}function $1t(t,e=!1){const i=["raster-stretch"];return sG(t,e)&&i.push("raster-colormap"),nG(t)&&i.push("unique-value"),fGe(t,e)&&i.push("class-breaks"),Ufe(t)&&i.push("raster-shaded-relief"),oG(t)&&i.push("vector-field"),mGe(t)&&i.push("flow"),i}function CGe(t,e,i){const r=["nearest","bilinear","cubic","majority"].find(n=>n===(i==null?void 0:i.toLowerCase()));return e==="Map"?r??"bilinear":t.dataType==="standard-time"?r??"nearest":t.dataType==="thematic"||t.attributeTable||t.colormap?r==="nearest"||r==="majority"?r:"nearest":r??"bilinear"}function EGe(t,e){t=fj(t,e==null?void 0:e.variableName);const{bandCount:i}=t;let{bandIds:r,stretchType:n}=e||{};r!=null&&r.some(h=>h>=i)&&(r=null);let s=t.statistics,o=t.histograms;i>1?(r=r!=null&&r.length?r:Hfe(t),s=s==null?null:r==null?void 0:r.map(h=>s[h]),o=o==null?null:r==null?void 0:r.map(h=>o[h])):r=[0],n==null&&(n=$Ge(t));let a=!1;switch(n){case"none":a=!1;break;case"percent-clip":a=!(o!=null&&o.length);break;default:a=!(s!=null&&s.length)}const{dataType:l}=t,c=(r==null?void 0:r.length)===1&&Gfe.has(l)?TGe:null,u=new V9({stretchType:n,dynamicRangeAdjustment:a,colorRamp:c,outputMin:0,outputMax:255,gamma:(r==null?void 0:r.length)===1?[1]:[1,1,1],useGamma:!1});return n==="percent-clip"?u.maxPercent=u.minPercent=IGe:n==="standard-deviation"&&(u.numberOfStandardDeviations=2),a||t.multidimensionalInfo==null&&!(e!=null&&e.includeStatisticsInStretch)||(n==="percent-clip"?u.histograms=o:n!=="min-max"&&n!=="standard-deviation"||(u.statistics=s)),u}function fj(t,e){if(!e)return t;let i=t.statistics,r=t.histograms;const{multidimensionalInfo:n}=t;if(e&&n!=null){const s=n.variables.find(o=>o.name===e);if(s){const{statistics:o,histograms:a}=s;o!=null&&o.length&&(i=o),a!=null&&a.length&&(r=a)}}return Ap.fromJSON({...t.toJSON(),statistics:i,histograms:r})}function Hfe(t){const e=t.bandCount;if(e===1)return null;if(e===2)return[0];const{bandInfos:i}=t;let r;if(i.length===e){const{red:n,green:s,blue:o,nir:a}=MGe(i);n!=null&&s!=null&&o!=null?r=[n,s,o]:a!=null&&n!=null&&s!=null&&(r=[a,n,s])}return!r&&e>=3&&(r=[0,1,2]),r}function MGe(t){const e={};for(let i=0;i<t.length;i++){const r=t[i],n=r.name.toLowerCase();if(n==="red")e.red=i;else if(n==="green")e.green=i;else if(n==="blue")e.blue=i;else if(n==="nearinfrared"||n==="nearinfrared_1"||n==="nir")e.nir=i;else if(r.maxWavelength&&r.minWavelength){const s=r.minWavelength,o=r.maxWavelength;e.blue==null&&s>=410&&s<=480&&o>=480&&o<=540?e.blue=i:e.green==null&&s>=490&&s<=560&&o>=560&&o<=610?e.green=i:e.red==null&&s>=595&&s<=670&&o>=660&&o<=730?e.red=i:e.nir==null&&s>=700&&s<=860&&o>=800&&o<=950&&(e.nir=i)}}return e}function $Ge(t){let e="percent-clip";const{pixelType:i,dataType:r,histograms:n,statistics:s,multidimensionalInfo:o}=t,a=Gfe.has(r)||r==="generic"&&o!=null;return i!=="u8"||r!=="processed"&&n!=null&&s!=null?i==="u8"||r==="elevation"||a?e="min-max":n!=null?e="percent-clip":s!=null&&(e="min-max"):e="none",e}function AGe(t,e,i,r){if(!nG(t,e))return null;const{attributeTable:n,statistics:s}=t,o=qfe(n,e),a=uI(n,"red"),l=uI(n,"green"),c=uI(n,"blue"),u=new EC,h=[],f=new Set,m=!!(a&&l&&c);if(n!=null)n.features.forEach(g=>{const y=g.attributes[o.name];if(!f.has(g.attributes[o.name])&&y!=null){f.add(y);const v=m&&(a.type==="single"||a.type==="double")&&(l.type==="single"||l.type==="double")&&(c.type==="single"||c.type==="double")&&!n.features.some(w=>w.attributes[a.name]>1||w.attributes[l.name]>1||w.attributes[c.name]>1),b=v?255:1;h.push(new cv({value:g.attributes[o.name],label:g.attributes[o.name]+"",symbol:{type:"simple-fill",style:"solid",outline:null,color:new ce(m?[g.attributes[a.name]*b,g.attributes[l.name]*b,g.attributes[c.name]*b,1]:[0,0,0,0])}}))}});else if(s!=null&&s[0])for(let g=s[0].min;g<=s[0].max;g++)h.push(new cv({value:g,label:g.toString(),symbol:{type:"simple-fill",style:"solid",outline:null,color:new ce([0,0,0,0])}}));if(h.sort((g,y)=>g.value&&typeof g.value.valueOf()=="string"?0:g.value>y.value?1:-1),!m){const g=Ov(eK,{numColors:h.length});h.forEach((y,v)=>y.symbol.color=new ce(g[v].slice(1,4))),u.colorRamp=eK}if(i||r){const g=i||Ov(r,{numColors:h.length}).map(y=>y.slice(1));h.forEach((y,v)=>y.symbol.color=new ce(g[v])),u.colorRamp=r}return new tx({field:o.name,uniqueValueInfos:h,authoringInfo:u})}function qfe(t,e,i){let r;return t!=null?(r=e?t.fields.find(n=>e.toLowerCase()===n.name.toLowerCase()):kGe(t.fields),r||(i||(r=t.fields.find(n=>n.type==="string")),r||(r=uI(t,"value")))):r=new hu({name:"value"}),r}function kGe(t){let e;for(let i=0;i<t.length;i++){const r=t[i].name.toLowerCase();if(t[i].type==="string"){if(r.startsWith("class")){e=t[i];break}e==null&&(r.endsWith("name")||r.endsWith("type"))&&(e=t[i])}}return e}function uI(t,e){return t==null?null:t.fields.find(i=>i.name.toLowerCase()===e)}function PGe(t){if(!sG(t))return null;let e;const{attributeTable:i,colormap:r}=t;if(i!=null){const n=uI(i,"value"),s=qfe(i,null,!0);s.type==="string"&&(e={},i.features.forEach(o=>{const a=o.attributes;e[a[n.name]]=s?a[s.name]:a[n.name]}))}return N9.createFromColormap(r,e)}const OGe=new Map([["m/s","meter-per-second"],["km/h","kilometer-per-hour"],["knots","knots"],["ft/s","feet-per-second"],["mph","mile-per-hour"]]);function LGe(t){if(!oG(t))return null;let e;if(t.statistics!=null&&t.statistics.length&&(t.dataType==="vector-magdir"||t.dataType==="vector-uv")){const{minMagnitude:n,maxMagnitude:s}=RGe(t.dataType,t.statistics);e=[{type:"size",field:"Magnitude",minSize:10,maxSize:40,minDataValue:n,maxDataValue:s}]}const i=t.multidimensionalInfo!=null?OGe.get(t.multidimensionalInfo.variables[0].unit):null,r=new G9({visualVariables:e,inputUnit:i,rotationType:"geographic"});return r.visualVariables=[...r.sizeVariables,...r.rotationVariables],r}function iK(t){var e;return{color:(e=t.symbolLayers[0].material)==null?void 0:e.color,type:"esriSFS",style:"esriSFSSolid"}}function rK(t){var e,i;if(t.type==="uniqueValue"){const r=t.uniqueValueInfos,n=r==null?void 0:r[0].symbol;return(e=n==null?void 0:n.symbolLayers)!=null&&e.length&&(t.uniqueValueInfos=r==null?void 0:r.map(s=>({value:s.value,label:s.label,symbol:s.symbol?iK(s.symbol):null}))),t}if(t.type==="classBreaks"){const r=t.classBreakInfos,n=r[0].symbol;return(i=n==null?void 0:n.symbolLayers)!=null&&i.length&&(t.classBreakInfos=r.map(s=>({classMinValue:s.classMinValue,classMaxValue:s.classMaxValue,label:s.label,symbol:s.symbol?iK(s.symbol):null}))),t}return t}function RGe(t,e){let i,r;if(t==="vector-magdir")i=e[0].min,r=e[0].max;else{const n=e[0].min,s=e[0].max,o=e[1].min,a=e[1].max;i=0,r=Math.max(Math.abs(n),Math.abs(o),Math.abs(s),Math.abs(a))}return{minMagnitude:i,maxMagnitude:r}}let t0=class extends te{constructor(e){super(e)}bind(){const{rendererJSON:e}=this;if(!e)return{success:!1};let i;switch(this.lookup={rendererJSON:{}},e.type){case"uniqueValue":i=this._updateUVRenderer(e);break;case"rasterColormap":i=this._updateColormapRenderer(e);break;case"rasterStretch":i=this._updateStretchRenderer(e);break;case"classBreaks":i=this._updateClassBreaksRenderer(e);break;case"rasterShadedRelief":i=this._updateShadedReliefRenderer(e);break;case"vectorField":i=this._updateVectorFieldRenderer();break;case"flowRenderer":i=this._updateFlowRenderer()}return i}symbolize(e){let i=e&&e.pixelBlock;if(!nK(i))return i;if(e.simpleStretchParams&&this.rendererJSON.type==="rasterStretch")return this.simpleStretch(i,e.simpleStretchParams);try{let r;switch(i.pixels.length>3&&(i=i.extractBands([0,1,2])),this.rendererJSON.type){case"uniqueValue":case"rasterColormap":r=this._symbolizeColormap(i);break;case"classBreaks":r=this._symbolizeClassBreaks(i);break;case"rasterStretch":r=this._symbolizeStretch(i,e.bandIds);break;case"rasterShadedRelief":{const n=e.extent,s=n.spatialReference.isGeographic,o={x:(n.xmax-n.xmin)/i.width,y:(n.ymax-n.ymin)/i.height};r=this._symbolizeShadedRelief(i,{isGCS:s,resolution:o});break}}return r}catch(r){return ie.getLogger(this).error("symbolize",r.message),i}}simpleStretch(e,i){if(!nK(e))return e;try{return e.pixels.length>3&&(e=e.extractBands([0,1,2])),AA(e,{...i,isRenderer:!0})}catch(r){return ie.getLogger(this).error("symbolize",r.message),e}}generateWebGLParameters(e){if(["uniqueValue","rasterColormap","classBreaks"].includes(this.rendererJSON.type)){const{indexedColormap:a,offset:l}=this.lookup.colormapLut||{};return{colormap:a,colormapOffset:l,type:"lut"}}const{pixelBlock:i,isGCS:r,resolution:n,bandIds:s}=e,{rendererJSON:o}=this;return o.type==="rasterStretch"?this._generateStretchWebGLParams(i,o,s):o.type==="rasterShadedRelief"?this._generateShadedReliefWebGLParams(o,r,n??void 0):o.type==="vectorField"?this._generateVectorFieldWebGLParams(o):null}_isLUTChanged(e){if(!this.lookup||!this.lookup.rendererJSON)return!0;if("colorRamp"in this.rendererJSON){const i=this.rendererJSON.colorRamp;return e?JSON.stringify(i)!==JSON.stringify(this.lookup.rendererJSON.colorRamp):(this.rendererJSON,this.lookup.rendererJSON,JSON.stringify(this.rendererJSON)!==JSON.stringify(this.lookup.rendererJSON))}return JSON.stringify(this.rendererJSON)!==JSON.stringify(this.lookup.rendererJSON)}_symbolizeColormap(e){return this._isLUTChanged()&&!this.bind().success?e:_5(e,this.lookup.colormapLut)}_symbolizeClassBreaks(e){const{canUseIndexedLUT:i}=this._analyzeClassBreaks(this.rendererJSON);return this._isLUTChanged()&&!this.bind().success?e:i?_5(e,this.lookup.colormapLut):y8e(e,this.lookup.remapLut??[])}_symbolizeStretch(e,i){var f,m;const{rasterInfo:r}=this,{pixelType:n,bandCount:s}=r,o=this.rendererJSON,a=["u8","u16","s8","s16"].includes(n);let l,c;const{dra:u}=o,{gamma:h}=this.lookup;if(o.stretchType==="histogramEqualization"){const g=u?null:(f=this.lookup)==null?void 0:f.histogramLut,y=bm(o,{rasterInfo:r,pixelBlock:e,bandIds:i,returnHistogramLut:!g}),v=AA(e,{...y,gamma:h,isRenderer:!0});c=LP(v,{lut:u?y.histogramLut:g,offset:0})}else if(a){if(u){const g=bm(o,{rasterInfo:r,pixelBlock:e,bandIds:i});l=lj({pixelType:n,...g,gamma:h,rounding:"floor"})}else if(this._isLUTChanged()){if(!this.bind().success)return e;l=this.lookup?this.lookup.stretchLut:null}else l=this.lookup?this.lookup.stretchLut:null;if(!l)return e;s>1&&i!=null&&i.length===(e==null?void 0:e.pixels.length)&&(l==null?void 0:l.lut.length)===s&&(l={lut:i.map(g=>l.lut[g]),offset:l.offset}),c=LP(e,l)}else{const g=bm(o,{rasterInfo:r,pixelBlock:e,bandIds:i});c=AA(e,{...g,gamma:h,isRenderer:!0})}if(o.colorRamp){if(this._isLUTChanged(!0)&&!this.bind().success)return e;c=_5(c,(m=this.lookup)==null?void 0:m.colormapLut)}return c}_symbolizeShadedRelief(e,i){var l;const r=this.rendererJSON,n={...r,...i},s=WBe(e,n);if(!r.colorRamp)return s;let o;if(this._isLUTChanged(!0)){if(!this.bind().success)return s;o=this.lookup?this.lookup.hsvMap:null}else o=this.lookup?this.lookup.hsvMap:null;if(!o)return s;const a=((l=this.rasterInfo.statistics)==null?void 0:l[0])??{min:0,max:8e3};return JBe(s,e,o,a),s}_isVectorFieldData(){const{bandCount:e,dataType:i}=this.rasterInfo;return e===2&&(i==="vector-magdir"||i==="vector-uv")}_updateVectorFieldRenderer(){return this._isVectorFieldData()?{success:!0}:{success:!1,error:`Unsupported data type "${this.rasterInfo.dataType}"; VectorFieldRenderer only supports "vector-magdir" and "vector-uv".`}}_updateFlowRenderer(){return this._isVectorFieldData()?{success:!0}:{success:!1,error:`Unsupported data type "${this.rasterInfo.dataType}"; FlowRenderer only supports "vector-magdir" and "vector-uv".`}}_updateUVRenderer(e){var u;const{bandCount:i,attributeTable:r,pixelType:n}=this.rasterInfo,s=e.field1;if(!s)return{success:!1,error:"Unsupported renderer; missing UniqueValueRenderer.field."};const o=e.defaultSymbol,a=i===1&&["u8","s8"].includes(n);if(!nG(this.rasterInfo,s)&&!a)return{success:!1,error:"Unsupported data; UniqueValueRenderer is only supported on single band data with a valid raster attribute table."};const l=[];if(r!=null){const h=r.fields.find(f=>f.name.toLowerCase()==="value");if(!h)return{success:!1,error:"Unsupported data; the data's raster attribute table does not have a value field."};r.features.forEach(f=>{var y,v;const m=(y=e.uniqueValueInfos)==null?void 0:y.find(b=>String(b.value)===String(f.attributes[s])),g=(v=m==null?void 0:m.symbol)==null?void 0:v.color;g?l.push([f.attributes[h.name]].concat(g)):o&&l.push([f.attributes[h.name]].concat(o.color))})}else{if(s.toLowerCase()!=="value")return{success:!1,error:'Unsupported renderer; UniqueValueRenderer.field must be "Value" when raster attribute table is not availalbe.'};(u=e.uniqueValueInfos)==null||u.forEach(h=>{var m;const f=(m=h==null?void 0:h.symbol)==null?void 0:m.color;f?l.push([parseInt(""+h.value,10)].concat(f)):o&&l.push([parseInt(""+h.value,10)].concat(o==null?void 0:o.color))})}if(l.length===0)return{success:!1,error:"Invalid UniqueValueRenderer. Cannot find matching records in the raster attribute table."};const c=Fx({colormap:l});return this.lookup={rendererJSON:e,colormapLut:c},this.canRenderInWebGL=!0,{success:!0}}_updateColormapRenderer(e){if(!sG(this.rasterInfo))return{success:!1,error:"Unsupported data; the data source does not have a colormap."};const i=e.colormapInfos.map(n=>[n.value].concat(n.color)).sort((n,s)=>n[0]-s[0]);if(!i||i.length===0)return{success:!1,error:"Unsupported renderer; ColormapRenderer must have meaningful colormapInfos."};const r=Fx({colormap:i});return this.lookup={rendererJSON:e,colormapLut:r},this.canRenderInWebGL=!0,{success:!0}}_updateShadedReliefRenderer(e){if(!Ufe(this.rasterInfo))return{success:!1,error:`Unsupported data type "${this.rasterInfo.dataType}"; ShadedReliefRenderer only supports "elevation", or single band float/s16 data.`};if(e.colorRamp){const i=Ov(e.colorRamp,{interpolateAlpha:!0}),r=Fx({colormap:i}),n=[],s=r.indexedColormap;for(let o=0;o<s.length;o+=4){const a=Pv({r:s[o],g:s[o+1],b:s[o+2]});n.push([a.h/60,a.s/100,255*a.v/100])}this.lookup={rendererJSON:e,colormapLut:r,hsvMap:n}}else this.lookup=null;return this.canRenderInWebGL=!0,{success:!0}}_analyzeClassBreaks(e){const{attributeTable:i,pixelType:r}=this.rasterInfo,n=i!=null?i.fields.find(a=>a.name.toLowerCase()==="value"):null,s=i!=null?i.fields.find(a=>a.name.toLowerCase()===e.field.toLowerCase()):null,o=n!=null&&s!==null;return{canUseIndexedLUT:["u8","u16","s8","s16"].includes(r)||o,tableValueField:n,tableBreakField:s}}_updateClassBreaksRenderer(e){const{attributeTable:i}=this.rasterInfo,{canUseIndexedLUT:r,tableValueField:n,tableBreakField:s}=this._analyzeClassBreaks(e),o=e.classBreakInfos;if(!(o!=null&&o.length))return{success:!1,error:"Unsupported renderer; missing or invalid ClassBreaksRenderer.classBreakInfos."};const a=o.sort((f,m)=>f.classMaxValue-m.classMaxValue),l=a[a.length-1];let c=e.minValue;if(!r){const f=[];for(let m=0;m<a.length;m++)f.push({value:a[m].classMinValue??c,mappedColor:a[m].symbol.color}),c=a[m].classMaxValue;return f.push({value:l.classMaxValue,mappedColor:l.symbol.color}),this.lookup={rendererJSON:e,remapLut:f},this.canRenderInWebGL=!1,{success:!0}}const u=[];if(i!=null&&n!=null&&s!==null&&n!==s){const f=n.name,m=s.name,g=a[a.length-1],{classMaxValue:y}=g;c=e.minValue;for(const v of i.features){const b=v.attributes[f],w=v.attributes[m],x=w===y?g:w<c?null:a.find(({classMaxValue:S})=>S>w);x&&u.push([b].concat(x.symbol.color))}}else{c=Math.floor(e.minValue);for(let f=0;f<a.length;f++){const m=a[f];for(let g=c;g<m.classMaxValue;g++)u.push([g].concat(m.symbol.color));c=Math.ceil(m.classMaxValue)}l.classMaxValue===c&&u.push([l.classMaxValue].concat(l.symbol.color))}const h=Fx({colormap:u,fillUnspecified:!1});return this.lookup={rendererJSON:e,colormapLut:h},this.canRenderInWebGL=!0,{success:!0}}_isHistogramRequired(e){return e==="percentClip"||e==="histogramEqualization"}_isValidRasterStatistics(e){return e!=null&&e.length>0&&e[0].min!=null&&e[0].max!=null}_updateStretchRenderer(e){var h,f;let{stretchType:i,dra:r}=e;if(!(i==="none"||(h=e.statistics)!=null&&h.length||this._isValidRasterStatistics(this.rasterInfo.statistics)||r))return{success:!1,error:"Unsupported renderer; StretchRenderer.statistics is required when dynamic range adjustment is not used."};const n=e.histograms||this.rasterInfo.histograms;!this._isHistogramRequired(e.stretchType)||n!=null&&n.length||r||(i="minMax");const{computeGamma:s,useGamma:o,colorRamp:a}=e;let{gamma:l}=e;if(o&&s&&!(l!=null&&l.length)){const m=(f=e.statistics)!=null&&f.length?e.statistics:this.rasterInfo.statistics;l=eGe(this.rasterInfo.pixelType,m)}const c=this.rasterInfo.pixelType,u=!r&&["u8","u16","s8","s16"].includes(c);if(i==="histogramEqualization"){const m=n.map(g=>Ffe(g));this.lookup={rendererJSON:e,histogramLut:m}}else if(u){const m=bm(e,{rasterInfo:this.rasterInfo}),g=lj({pixelType:c,...m,gamma:o?l:null,rounding:"floor"});this.lookup={rendererJSON:e,stretchLut:g}}if(a){const m=Ov(a,{interpolateAlpha:!0});this.lookup||(this.lookup={rendererJSON:e}),this.lookup.colormapLut=Fx({colormap:m}),this.lookup.rendererJSON=e}return this.lookup.gamma=o&&(l!=null&&l.length)?l:null,this.canRenderInWebGL=!0,{success:!0}}_generateStretchWebGLParams(e,i,r){let n=null,s=null;const o=this.lookup&&this.lookup.colormapLut;i.colorRamp&&o&&(n=o.indexedColormap,s=o.offset),i.stretchType==="histogramEqualization"&&(i={...i,stretchType:"minMax"});const{gamma:a}=this.lookup,l=!!(i.useGamma&&a&&a.some(S=>S!==1)),{minCutOff:c,maxCutOff:u,outMin:h,outMax:f}=bm(i,{rasterInfo:this.rasterInfo,pixelBlock:e,bandIds:r});let m=0;e!=null&&(m=e.getPlaneCount(),m===2&&((e=e.clone()).statistics=[e.statistics[0]],e.pixels=[e.pixels[0]]));const{bandCount:g}=this.rasterInfo,y=Math.min(3,(r==null?void 0:r.length)||m||g,g),v=new Float32Array(y),b=n||l?1:255;let w;for(w=0;w<c.length;w++)v[w]=u[w]===c[w]?0:(f-h)/(u[w]-c[w])/b;const x=new Float32Array(y);if(l&&a)for(w=0;w<y;w++)a[w]>1?a[w]>2?x[w]=6.5+(a[w]-2)**2.5:x[w]=6.5+100*(2-a[w])**4:x[w]=1;return{bandCount:y,outMin:h/b,outMax:f/b,minCutOff:c,maxCutOff:u,factor:v,useGamma:l,gamma:l?a:[1,1,1],gammaCorrection:l?x:[1,1,1],colormap:n,colormapOffset:s,stretchType:i.stretchType,type:"stretch"}}_generateShadedReliefWebGLParams(e,i=!1,r={x:0,y:0}){var u;let n=null,s=null;const o=this.lookup&&this.lookup.colormapLut;e.colorRamp&&o&&(n=o.indexedColormap,s=o.offset);const a={...e,isGCS:i,resolution:r},l=Afe(a),c=(u=this.rasterInfo.statistics)==null?void 0:u[0];return{...l,minValue:(c==null?void 0:c.min)??0,maxValue:(c==null?void 0:c.max)??8e3,hillshadeType:e.hillshadeType==="traditional"?0:1,type:"hillshade",colormap:n,colormapOffset:s}}_generateVectorFieldWebGLParams(e){var w,x,S;const{style:i,inputUnit:r,outputUnit:n,visualVariables:s,symbolTileSize:o,flowRepresentation:a}=e;let l;const c=((w=this.rasterInfo.statistics)==null?void 0:w[0].min)??0,u=((x=this.rasterInfo.statistics)==null?void 0:x[0].max)??50,h=(s==null?void 0:s.find(I=>I.type==="sizeInfo"))??{type:"sizeInfo",field:"Magnitude",maxDataValue:u,maxSize:.8*o,minDataValue:c,minSize:.2*o},f=h.minDataValue??c,m=h.maxDataValue??u,g=h.maxSize!=null&&h.minSize!=null?[h.minSize/o,h.maxSize/o]:[.2,.8];if(i==="wind_speed"){const I=(g[0]+g[1])/2;g[0]=g[1]=I}const y=f!=null&&m!=null?[f,m]:null;if(i==="classified_arrow")if(f!=null&&m!=null&&h!=null){l=[];const I=(h.maxDataValue-h.minDataValue)/5;for(let T=0;T<6;T++)l.push(h.minDataValue+I*T)}else l=[0,1e-6,3.5,7,10.5,14];const v=a==="flow_to"==(i==="ocean_current_kn"||i==="ocean_current_m")?0:Math.PI,b=s==null?void 0:s.find(I=>I.type==="rotationInfo");return{breakValues:l,dataRange:y,inputUnit:r,outputUnit:n,symbolTileSize:o,symbolPercentRange:g,style:i||"single_arrow",rotation:v,rotationType:(S=this.rasterInfo.storageInfo)!=null&&S.tileInfo&&this.rasterInfo.dataType==="vector-uv"?"geographic":(b==null?void 0:b.rotationType)||e.rotationType,type:"vectorField"}}};function nK(t){return Gi(t)&&t.validPixelCount!==0}d([p({json:{write:!0}})],t0.prototype,"rendererJSON",void 0),d([p({type:Ap,json:{write:!0}})],t0.prototype,"rasterInfo",void 0),d([p({json:{write:!0}})],t0.prototype,"lookup",void 0),d([p()],t0.prototype,"canRenderInWebGL",void 0),t0=d([A("esri.renderers.support.RasterSymbolizer")],t0);const FGe=t0;var mj;const dI=ln()({MT_FIRST:"first",MT_LAST:"last",MT_MIN:"min",MT_MAX:"max",MT_MEAN:"mean",MT_BLEND:"blend",MT_SUM:"sum"}),gj=ln()({esriMosaicNone:"none",esriMosaicCenter:"center",esriMosaicNadir:"nadir",esriMosaicViewpoint:"viewpoint",esriMosaicAttribute:"attribute",esriMosaicLockRaster:"lock-raster",esriMosaicNorthwest:"northwest",esriMosaicSeamline:"seamline"});function DGe(t){let e;switch(t?t.toLowerCase().replace("esrimosaic",""):""){case"byattribute":case"attribute":e="esriMosaicAttribute";break;case"lockraster":e="esriMosaicLockRaster";break;case"center":e="esriMosaicCenter";break;case"northwest":e="esriMosaicNorthwest";break;case"nadir":e="esriMosaicNadir";break;case"viewpoint":e="esriMosaicViewpoint";break;case"seamline":e="esriMosaicSeamline";break;default:e="esriMosaicNone"}return gj.fromJSON(e)}let vn=mj=class extends te{constructor(t){super(t),this.ascending=!0,this.itemRasterFunction=null,this.lockRasterIds=null,this.method=null,this.multidimensionalDefinition=null,this.objectIds=null,this.operation=null,this.sortField=null,this.sortValue=null,this.viewpoint=null,this.where=null}readAscending(t,e){return e.ascending!=null?e.ascending:e.sortAscending==null||e.sortAscending}get itemRenderingRule(){return el(ie.getLogger(this),"itemRenderingRule",{replacement:"itemRasterFunction",version:"4.27",warnOnce:!0}),this._get("itemRasterFunction")}set itemRenderingRule(t){el(ie.getLogger(this),"itemRenderingRule",{replacement:"itemRasterFunction",version:"4.27",warnOnce:!0}),this._set("itemRasterFunction",t)}readMethod(t,e){return DGe(e.mosaicMethod||e.defaultMosaicMethod)}writeMultidimensionalDefinition(t,e,i){t!=null&&(t=t.filter(({variableName:r,dimensionName:n})=>r&&r!=="*"||n)).length&&(e[i]=t.map(r=>r.toJSON()))}readOperation(t,e){const i=e.mosaicOperation,r=e.mosaicOperator&&e.mosaicOperator.toLowerCase(),n=i||(r?dI.toJSON(r):null);return dI.fromJSON(n)||"first"}castSortValue(t){return t==null||typeof t=="string"||typeof t=="number"?t:`${t}`}clone(){return new mj({ascending:this.ascending,itemRasterFunction:U(this.itemRasterFunction),lockRasterIds:U(this.lockRasterIds),method:this.method,multidimensionalDefinition:U(this.multidimensionalDefinition),objectIds:U(this.objectIds),operation:this.operation,sortField:this.sortField,sortValue:this.sortValue,viewpoint:U(this.viewpoint),where:this.where})}};d([p({type:Boolean,json:{write:!0}})],vn.prototype,"ascending",void 0),d([ae("ascending",["ascending","sortAscending"])],vn.prototype,"readAscending",null),d([p({type:Rv,json:{name:"itemRenderingRule",write:!0}})],vn.prototype,"itemRasterFunction",void 0),d([p({type:Rv})],vn.prototype,"itemRenderingRule",null),d([p({type:[wt],json:{write:{overridePolicy(){return{enabled:this.method==="lock-raster"}}}}})],vn.prototype,"lockRasterIds",void 0),d([p({type:String,json:{type:gj.jsonValues,write:{target:"mosaicMethod",writer:gj.write}}})],vn.prototype,"method",void 0),d([ae("method",["mosaicMethod","defaultMosaicMethod"])],vn.prototype,"readMethod",null),d([p({type:[Lv],json:{write:!0}})],vn.prototype,"multidimensionalDefinition",void 0),d([ge("multidimensionalDefinition")],vn.prototype,"writeMultidimensionalDefinition",null),d([p({type:[wt],json:{name:"fids",write:!0}})],vn.prototype,"objectIds",void 0),d([p({json:{type:dI.jsonValues,read:{reader:dI.read},write:{target:"mosaicOperation",writer:dI.write}}})],vn.prototype,"operation",void 0),d([ae("operation",["mosaicOperation","mosaicOperator"])],vn.prototype,"readOperation",null),d([p({type:String,json:{write:{overridePolicy(){return{enabled:this.method==="attribute"}}}}})],vn.prototype,"sortField",void 0),d([p({type:[String,Number],json:{write:{allowNull:!0,overridePolicy(){return{enabled:this.method==="attribute",allowNull:!0}}}}})],vn.prototype,"sortValue",void 0),d([tt("sortValue")],vn.prototype,"castSortValue",null),d([p({type:fe,json:{write:!0}})],vn.prototype,"viewpoint",void 0),d([p({type:String,json:{write:!0}})],vn.prototype,"where",void 0),vn=mj=d([A("esri.layers.support.MosaicRule")],vn);const NGe=vn;var yj;let Gc=yj=class extends te{constructor(){super(...arguments),this.geometry=null,this.mosaicRule=null,this.rasterFunction=null,this.pixelSize=null,this.raster=void 0,this.timeExtent=null}writeGeometry(t,e,i){t!=null&&(e.geometryType=V1(t),e[i]=t.toJSON())}get renderingRule(){return el(ie.getLogger(this),"renderingRule",{replacement:"rasterFunction",version:"4.27",warnOnce:!0}),this._get("rasterFunction")}set renderingRule(t){el(ie.getLogger(this),"renderingRule",{replacement:"rasterFunction",version:"4.27",warnOnce:!0}),this._set("rasterFunction",t)}clone(){return new yj(U({geometry:this.geometry,mosaicRule:this.mosaicRule,rasterFunction:this.rasterFunction,pixelSize:this.pixelSize,raster:this.raster,timeExtent:this.timeExtent}))}};d([p({types:_g,json:{read:Vd}})],Gc.prototype,"geometry",void 0),d([ge("geometry")],Gc.prototype,"writeGeometry",null),d([p({type:NGe,json:{write:!0}})],Gc.prototype,"mosaicRule",void 0),d([p({type:Rv})],Gc.prototype,"renderingRule",null),d([p({type:Rv,json:{write:!0,name:"renderingRule"}})],Gc.prototype,"rasterFunction",void 0),d([p({type:fe,json:{write:!0}})],Gc.prototype,"pixelSize",void 0),d([p({json:{write:!0}})],Gc.prototype,"raster",void 0),d([p({type:ku,json:{read:{source:"time"},write:{target:"time"}}})],Gc.prototype,"timeExtent",void 0),Gc=yj=d([A("esri.rest.support.ImageHistogramParameters")],Gc);const VGe=Gc,ou=ie.getLogger("esri.views.2d.engine.flow.dataUtils"),zGe=10;async function jGe(t,e,i,r){const n=performance.now(),s=BGe(e,i),o=performance.now(),a=GGe(e,s,i.width,i.height),l=performance.now(),c=qGe(a,!0),u=performance.now(),h=t==="Streamlines"?WGe(c,zGe):JGe(c),f=performance.now();return ee("esri-2d-profiler")&&(ou.info("I.1","_createFlowFieldFromData (ms)",Math.round(o-n)),ou.info("I.2","_getStreamlines (ms)",Math.round(l-o)),ou.info("I.3","createAnimatedLinesData (ms)",Math.round(u-l)),ou.info("I.4","create{Streamlines|Particles}Mesh (ms)",Math.round(f-u)),ou.info("I.5","createFlowMesh (ms)",Math.round(f-n)),ou.info("I.6","Mesh size (bytes)",h.vertexData.buffer.byteLength+h.indexData.buffer.byteLength)),await Promise.resolve(),_t(r),h}function BGe(t,e){const i=HGe(e.data,e.width,e.height,t.smoothing);return t.interpolate?(r,n)=>{const s=Math.floor(r),o=Math.floor(n);if(s<0||s>=e.width)return[0,0];if(o<0||o>=e.height)return[0,0];const a=r-s,l=n-o,c=s,u=o,h=s<e.width-1?s+1:s,f=o<e.height-1?o+1:o,m=i[2*(u*e.width+c)],g=i[2*(u*e.width+h)],y=i[2*(f*e.width+c)],v=i[2*(f*e.width+h)],b=i[2*(u*e.width+c)+1],w=i[2*(u*e.width+h)+1];return[(m*(1-l)+y*l)*(1-a)+(g*(1-l)+v*l)*a,(b*(1-l)+i[2*(f*e.width+c)+1]*l)*(1-a)+(w*(1-l)+i[2*(f*e.width+h)+1]*l)*a]}:(r,n)=>{const s=Math.round(r),o=Math.round(n);return s<0||s>=e.width||o<0||o>=e.height?[0,0]:[i[2*(o*e.width+s)],i[2*(o*e.width+s)+1]]}}function UGe(t,e,i,r,n,s,o,a,l){const c=[];let u=i,h=r,f=0,[m,g]=e(u,h);m*=t.velocityScale,g*=t.velocityScale;const y=Math.sqrt(m*m+g*g);let v,b;c.push({x:u,y:h,t:f,speed:y});for(let w=0;w<t.verticesPerLine;w++){let[x,S]=e(u,h);x*=t.velocityScale,S*=t.velocityScale;const I=Math.sqrt(x*x+S*S);if(I<t.minSpeedThreshold)return c;const T=x/I,C=S/I;if(u+=T*t.segmentLength,h+=C*t.segmentLength,f+=t.segmentLength/I,Math.acos(T*v+C*b)>t.maxTurnAngle)return c;if(t.collisions){const E=Math.round(u*l),$=Math.round(h*l);if(E<0||E>o-1||$<0||$>a-1)return c;const P=s[$*o+E];if(P!==-1&&P!==n)return c;s[$*o+E]=n}c.push({x:u,y:h,t:f,speed:I}),v=T,b=C}return c}function GGe(t,e,i,r){const n=[],s=new j2,o=1/Math.max(t.lineCollisionWidth,1),a=Math.round(i*o),l=Math.round(r*o),c=new Int32Array(a*l);for(let h=0;h<c.length;h++)c[h]=-1;const u=[];for(let h=0;h<r;h+=t.lineSpacing)for(let f=0;f<i;f+=t.lineSpacing)u.push({x:f,y:h,sort:s.getFloat()});u.sort((h,f)=>h.sort-f.sort);for(const{x:h,y:f}of u)if(s.getFloat()<t.density){const m=UGe(t,e,h,f,n.length,c,a,l,o);if(m.length<2)continue;n.push(m)}return n}function HGe(t,e,i,r){if(r===0)return t;const n=Math.round(3*r),s=new Array(2*n+1);let o=0;for(let c=-n;c<=n;c++){const u=Math.exp(-c*c/(r*r));s[c+n]=u,o+=u}for(let c=-n;c<=n;c++)s[c+n]/=o;const a=new Float32Array(t.length);for(let c=0;c<i;c++)for(let u=0;u<e;u++){let h=0,f=0;for(let m=-n;m<=n;m++){if(u+m<0||u+m>=e)continue;const g=s[m+n];h+=g*t[2*(c*e+(u+m))],f+=g*t[2*(c*e+(u+m))+1]}a[2*(c*e+u)]=h,a[2*(c*e+u)+1]=f}const l=new Float32Array(t.length);for(let c=0;c<e;c++)for(let u=0;u<i;u++){let h=0,f=0;for(let m=-n;m<=n;m++){if(u+m<0||u+m>=i)continue;const g=s[m+n];h+=g*a[2*((u+m)*e+c)],f+=g*a[2*((u+m)*e+c)+1]}l[2*(u*e+c)]=h,l[2*(u*e+c)+1]=f}return l}function qGe(t,e){const i=new j2,r=t.reduce((l,c)=>l+c.length,0),n=new Float32Array(4*r),s=new Array(t.length);let o=0,a=0;for(const l of t){const c=o;for(const u of l)n[4*o]=u.x,n[4*o+1]=u.y,n[4*o+2]=u.t,n[4*o+3]=u.speed,o++;s[a++]={startVertex:c,numberOfVertices:l.length,totalTime:l[l.length-1].t,timeSeed:e?i.getFloat():0}}return{lineVertices:n,lineDescriptors:s}}function WGe(t,e){const{lineVertices:r,lineDescriptors:n}=t;let s=0,o=0;for(const m of n)s+=2*m.numberOfVertices,o+=6*(m.numberOfVertices-1);const a=new Float32Array(s*9),l=new Uint32Array(o);let c=0,u=0;function h(){l[u++]=c-2,l[u++]=c,l[u++]=c-1,l[u++]=c,l[u++]=c+1,l[u++]=c-1}function f(m,g,y,v,b,w,x,S){const I=c*9;let T=0;a[I+T++]=m,a[I+T++]=g,a[I+T++]=1,a[I+T++]=y,a[I+T++]=w,a[I+T++]=x,a[I+T++]=v/2,a[I+T++]=b/2,a[I+T++]=S,c++,a[I+T++]=m,a[I+T++]=g,a[I+T++]=-1,a[I+T++]=y,a[I+T++]=w,a[I+T++]=x,a[I+T++]=-v/2,a[I+T++]=-b/2,a[I+T++]=S,c++}for(const m of n){const{totalTime:g,timeSeed:y}=m;let v=null,b=null,w=null,x=null,S=null,I=null;for(let T=0;T<m.numberOfVertices;T++){const C=r[4*(m.startVertex+T)],E=r[4*(m.startVertex+T)+1],$=r[4*(m.startVertex+T)+2],P=r[4*(m.startVertex+T)+3];let k=null,L=null,F=null,V=null;if(T>0){k=C-v,L=E-b;const z=Math.sqrt(k*k+L*L);if(k/=z,L/=z,T>1){let G=k+S,H=L+I;const Z=Math.sqrt(G*G+H*H);G/=Z,H/=Z;const K=Math.min(1/(G*k+H*L),e);G*=K,H*=K,F=-H,V=G}else F=-L,V=k;F!==null&&V!==null&&(f(v,b,w,F,V,g,y,P),h())}v=C,b=E,w=$,S=k,I=L,x=P}f(v,b,w,-I,S,g,y,x)}return{vertexData:a,indexData:l}}function JGe(t){const{lineVertices:n,lineDescriptors:s}=t;let o=0,a=0;for(const z of s){const G=z.numberOfVertices-1;o+=4*G*2,a+=6*G*2}const l=new Float32Array(o*16),c=new Uint32Array(a);let u,h,f,m,g,y,v,b,w,x,S,I,T,C,E=0,$=0;function P(){c[$++]=E-8,c[$++]=E-7,c[$++]=E-6,c[$++]=E-7,c[$++]=E-5,c[$++]=E-6,c[$++]=E-4,c[$++]=E-3,c[$++]=E-2,c[$++]=E-3,c[$++]=E-1,c[$++]=E-2}function k(z,G,H,Z,K,X,oe,se,le,me,Se,Ge,Be,gt){const Pe=E*16;let De=0;for(const ii of[1,2])for(const Rr of[1,2,3,4])l[Pe+De++]=z,l[Pe+De++]=G,l[Pe+De++]=H,l[Pe+De++]=Z,l[Pe+De++]=oe,l[Pe+De++]=se,l[Pe+De++]=le,l[Pe+De++]=me,l[Pe+De++]=ii,l[Pe+De++]=Rr,l[Pe+De++]=Be,l[Pe+De++]=gt,l[Pe+De++]=K/2,l[Pe+De++]=X/2,l[Pe+De++]=Se/2,l[Pe+De++]=Ge/2,E++}function L(z,G){let H=w+S,Z=x+I;const K=Math.sqrt(H*H+Z*Z);H/=K,Z/=K;const X=w*H+x*Z;H/=X,Z/=X;let oe=S+T,se=I+C;const le=Math.sqrt(oe*oe+se*se);oe/=le,se/=le;const me=S*oe+I*se;oe/=me,se/=me,k(u,h,f,m,-Z,H,g,y,v,b,-se,oe,z,G),P()}function F(z,G,H,Z,K,X){if(w=S,x=I,S=T,I=C,w==null&&x==null&&(w=S,x=I),g!=null&&y!=null){T=z-g,C=G-y;const oe=Math.sqrt(T*T+C*C);T/=oe,C/=oe}w!=null&&x!=null&&L(K,X),u=g,h=y,f=v,m=b,g=z,y=G,v=H,b=Z}function V(z,G){w=S,x=I,S=T,I=C,w==null&&x==null&&(w=S,x=I),w!=null&&x!=null&&L(z,G)}for(const z of s){u=null,h=null,f=null,m=null,g=null,y=null,v=null,b=null,w=null,x=null,S=null,I=null,T=null,C=null;const{totalTime:G,timeSeed:H}=z;for(let Z=0;Z<z.numberOfVertices;Z++)F(n[4*(z.startVertex+Z)],n[4*(z.startVertex+Z)+1],n[4*(z.startVertex+Z)+2],n[4*(z.startVertex+Z)+3],G,H);V(G,H)}return{vertexData:l,indexData:c}}function sK(t,e){const i=e.pixels,{width:r,height:n}=e,s=new Float32Array(r*n*2),o=e.mask||new Uint8Array(r*n*2);if(e.mask||o.fill(255),t==="vector-uv")for(let a=0;a<r*n;a++)s[2*a]=i[0][a],s[2*a+1]=-i[1][a];else if(t==="vector-magdir")for(let a=0;a<r*n;a++){const l=i[0][a],c=qse(i[1][a]),u=Math.cos(c-Math.PI/2),h=Math.sin(c-Math.PI/2);s[2*a]=u*l,s[2*a+1]=h*l}return{data:s,mask:o,width:r,height:n}}async function k1t(t,e,i,r,n,s){const o=performance.now(),a=Do(e.spatialReference);if(!a){const S=await oK(t,e,i,r,n,s);return ee("esri-2d-profiler")&&ou.info("I.7","loadImagery, early exit (ms)",Math.round(performance.now()-o)),ee("esri-2d-profiler")&&ou.info("I.9","Number of parts",1),S}const[l,c]=a.valid,u=c-l,h=Math.ceil(e.width/u),f=e.width/h,m=Math.round(i/h);let g=e.xmin;const y=[],v=performance.now();for(let S=0;S<h;S++){const I=new Re({xmin:g,xmax:g+f,ymin:e.ymin,ymax:e.ymax,spatialReference:e.spatialReference});y.push(oK(t,I,m,r,n,s)),g+=f}const b=await Promise.all(y);ee("esri-2d-profiler")&&ou.info("I.8","All calls to _fetchPart (ms)",Math.round(performance.now()-v)),ee("esri-2d-profiler")&&ou.info("I.9","Number of parts",b.length);const w={data:new Float32Array(i*r*2),mask:new Uint8Array(i*r),width:i,height:r};let x=0;for(const S of b){for(let I=0;I<S.height;I++)for(let T=0;T<S.width;T++)x+T>=i||(w.data[2*(I*i+x+T)]=S.data[2*(I*S.width+T)],w.data[2*(I*i+x+T)+1]=S.data[2*(I*S.width+T)+1],w.mask[I*i+x+T]=S.mask[I*S.width+T]);x+=S.width}return ee("esri-2d-profiler")&&ou.info("I.10","loadImagery, general exit (ms)",Math.round(performance.now()-o)),w}async function oK(t,e,i,r,n,s){const o={requestProjectedLocalDirections:!0,signal:s};if(n!=null&&(o.timeExtent=n),t.type==="imagery"){await t.load({signal:s});const c=t.rasterInfo.dataType,u=await t.fetchImage(e,i,r,o);return u&&u.pixelData!=null&&u.pixelData.pixelBlock!=null?sK(c,u.pixelData.pixelBlock):{data:new Float32Array(i*r*2),mask:new Uint8Array(i*r),width:i,height:r}}await t.load({signal:s});const a=t.rasterInfo.dataType,l=await t.fetchPixels(e,i,r,o);return l&&l.pixelBlock!=null?sK(a,l.pixelBlock):{data:new Float32Array(i*r*2),mask:new Uint8Array(i*r),width:i,height:r}}const aK=ie.getLogger("esri.layers.mixins.ImageryTileMixin"),ZGe=t=>{let e=class extends t{constructor(...r){var n,s;super(...r),this._isConstructedFromFunctionRaster=!1,this._rasterJobHandler={instance:null,refCount:0,connectionPromise:null},this.bandIds=null,this.copyright=null,this.interpolation="nearest",this.multidimensionalSubset=null,this.raster=null,this.rasterInfo=null,this.sourceJSON=null,this.spatialReference=null,this.symbolizer=null,this._isConstructedFromFunctionRaster=((s=(n=r[0])==null?void 0:n.raster)==null?void 0:s.datasetFormat)==="Function"}get fullExtent(){var r;return(r=this.rasterInfo)==null?void 0:r.extent}set multidimensionalDefinition(r){this._set("multidimensionalDefinition",r),this.updateRenderer()}set rasterFunction(r){var n;((n=r==null?void 0:r.functionName)==null?void 0:n.toLowerCase())==="none"&&(r=void 0),this._set("rasterFunction",r),this.updateRasterFunction()}set url(r){this._set("url",NU(r,aK))}set renderer(r){r==null&&this.rasterFunction==null?this._configDefaultRenderer("override"):(this._set("renderer",r),this.updateRenderer())}readRenderer(r,n,s){var a,l;const o=(l=(a=n==null?void 0:n.layerDefinition)==null?void 0:a.drawingInfo)==null?void 0:l.renderer;return _6e(o,s)||void 0}async convertVectorFieldData(r,n){if(r==null||!this.rasterInfo)return null;const s=this._rasterJobHandler.instance,o=this.rasterInfo.dataType;return s?s.convertVectorFieldData({pixelBlock:r,dataType:o},n):RP(r,o)}async computeStatisticsHistograms(r,n){r=jv(VGe,r).clone();const{rasterInfo:s}=this,{geometry:o}=r;if(o==null)throw new N("imagery-tile-mixin:compute-statistics-histograms","geometry must be specified");let a=o;const{spatialReference:l}=s;o.spatialReference.equals(l)||(await Oz(),a=o.type==="extent"?uv(o,l):B6e(o,l));const c=r.pixelSize??new fe({x:s.pixelSize.x,y:s.pixelSize.y,spatialReference:l}),{extent:u,width:h,height:f}=UBe(s,a,c),m=await this.fetchPixels(u,h,f,{...n,interpolation:"nearest"});if(m.pixelBlock==null)throw new N("imagery-tile-mixin:compute-statistics-histograms","failed to fetch pixels");const g=await VBe(m.pixelBlock,u,a),y=this._rasterJobHandler.instance;return y?y.computeStatisticsHistograms({pixelBlock:g},n):rGe(g)}async createFlowMesh(r,n){const s=this._rasterJobHandler.instance;return s?s.createFlowMesh(r,n):jGe(r.meshType,r.simulationSettings,r.flowData,n.signal!=null?n.signal:new AbortController().signal)}normalizeRasterFetchOptions(r){var a,l;const{multidimensionalInfo:n}=this.rasterInfo??{};if(n==null)return r;let s=r.multidimensionalDefinition||this.multidimensionalDefinition;s!=null&&s.length||(s=cY(this.raster.rasterInfo,{multidimensionalSubset:this.multidimensionalSubset}));const o=r.timeExtent||this.timeExtent;if(s!=null&&o!=null&&(o.start!=null||o.end!=null)){s=s.map(b=>b.clone());const c=(l=(a=n.variables.find(({name:b})=>b===s[0].variableName))==null?void 0:a.dimensions)==null?void 0:l.find(({name:b})=>b==="StdTime"),u=s.find(({dimensionName:b})=>b==="StdTime");if(!c||!u)return{...r,multidimensionalDefinition:null};const{start:h,end:f}=o,m=h==null?null:h.getTime(),g=f==null?null:f.getTime(),y=m??g,v=g??m;if(c.values!=null){const b=c.values.filter(w=>{if(Array.isArray(w)){if(y===v)return w[0]<=y&&w[1]>=y;const x=w[0]<=y&&w[1]>y||w[0]<v&&w[1]>=v,S=w[0]>=y&&w[1]<=v||w[0]<y&&w[1]>v;return x||S}return y===v?w===y:w>=y&&w<=v});if(b.length){const w=b.sort((x,S)=>{const I=Array.isArray(x)?x[0]:x,T=Array.isArray(x)?x[1]:x,C=Array.isArray(S)?S[0]:S,E=Array.isArray(S)?S[1]:S;return y===v?I-C:Math.abs(T-v)-Math.abs(E-v)})[0];u.values=[w]}else s=null}else if(c.hasRegularIntervals&&c.extent){const[b,w]=c.extent;y>w||v<b?s=null:u.values=y===v?[y]:[Math.max(b,y),Math.min(w,v)]}}return s!=null&&H9(s,this.multidimensionalSubset)?{...r,multidimensionalDefinition:null}:{...r,multidimensionalDefinition:s}}async updateRasterFunction(){var u,h,f;if(!this.loaded||this.type!=="imagery-tile"||!this.rasterFunction&&!this._cachedRasterFunctionJson||JSON.stringify(this.rasterFunction)===JSON.stringify(this._cachedRasterFunctionJson))return;if(this._isConstructedFromFunctionRaster&&this.raster.datasetFormat==="Function"){const m=this.raster.rasterFunction.toJSON();return!this.rasterFunction&&m&&this._set("rasterFunction",Rv.fromJSON(m)),void(this._cachedRasterFunctionJson=(u=this.rasterFunction)==null?void 0:u.toJSON())}let r,n=this.raster,s=!1;n.datasetFormat==="Function"?(r=n.primaryRasters.rasters,n=r[0],s=!0):r=[n];const{rasterFunction:o}=this;if(o){const m={raster:n};r.length>1&&r.forEach(v=>m[v.url]=v);const g=uj(((h=o.functionDefinition)==null?void 0:h.toJSON())??o.toJSON(),m),y=new Uz({rasterFunction:g});y.rasterJobHandler=this._rasterJobHandler.instance,await y.open(),this._cachedRasterFunctionJson=(f=this.rasterFunction)==null?void 0:f.toJSON(),this.raster=y}else this.raster=n,this._cachedRasterFunctionJson=null,await n.when();if(this._cachedRendererJson=null,!s&&!o)return;const{bandIds:a}=this,{bandCount:l}=this.raster.rasterInfo,c=a!=null&&a.length?a.some(m=>m>=l):l>=3;a&&(c||this.renderer&&this.renderer.type!=="raster-stretch")&&this._set("bandIds",null),this._configDefaultRenderer("auto")}async updateRenderer(){const{loaded:r,symbolizer:n}=this;if(!r||!n||!this.renderer)return;const{rasterInfo:s}=this.raster,o=kz(s,{multidimensionalDefinition:this.multidimensionalDefinition,multidimensionalSubset:this.multidimensionalSubset}),a=o==null?void 0:o.name,l=rK({...this.renderer.toJSON(),variableName:a});if(JSON.stringify(this._cachedRendererJson)===JSON.stringify(l))return;const c=this._rasterJobHandler.instance;c&&(n.rasterInfo=fj(s,a),n.rendererJSON=l,n.bind(),await c.updateSymbolizer(n),this._cachedRendererJson=l)}async applyRenderer(r,n){const s=r&&r.pixelBlock;if(!(s!=null&&s.pixels&&s.pixels.length>0))return null;let o;await this.updateRenderer();const a=this._rasterJobHandler.instance,l=this.bandIds??[];return o=a?await a.symbolize({...r,simpleStretchParams:n,bandIds:l}):this.symbolizer.symbolize({...r,simpleStretchParams:n,bandIds:l}),o}getTileUrl(r,n,s){return this.raster.datasetFormat==="RasterTileServer"?`${this.url}/tile/${r}/${n}/${s}`:""}getCompatibleTileInfo(r,n,s=!1){if(!this.loaded||n==null)return null;if(s&&r.equals(this.spatialReference))return this.tileInfo;const o=Do(r);return Od.create({size:256,spatialReference:r,origin:o?{x:o.origin[0],y:o.origin[1]}:{x:n.xmin,y:n.ymax}})}getCompatibleFullExtent(r){return this.loaded?(this._compatibleFullExtent&&this._compatibleFullExtent.spatialReference.equals(r)||(this._compatibleFullExtent=this.raster.computeExtent(r)),this._compatibleFullExtent):null}async fetchTile(r,n,s,o={}){var l;if(i(this),o.requestAsImageElement){const c=this.getTileUrl(r,n,s);return at(c,{responseType:"image",query:{...this.refreshParameters,...this.raster.ioConfig.customFetchParameters},signal:o.signal}).then(u=>u.data)}const{rasterInfo:a}=this;if(a.multidimensionalInfo!=null&&(o=this.normalizeRasterFetchOptions(o)).multidimensionalDefinition==null){const c=o.tileInfo||a.storageInfo.tileInfo;return{extent:this.raster.getTileExtentFromTileInfo(r,n,s,c),pixelBlock:null}}return await this._initJobHandler(),await this.updateRasterFunction(),((l=this.renderer)==null?void 0:l.type)==="raster-shaded-relief"&&(o={...o,buffer:{cols:1,rows:1}}),this.raster.fetchTile(r,n,s,o)}async fetchPixels(r,n,s,o={}){return this.rasterInfo.multidimensionalInfo!=null&&(o=this.normalizeRasterFetchOptions(o)).multidimensionalDefinition==null?{extent:r,pixelBlock:null}:(await this._initJobHandler(),await this.updateRasterFunction(),n=Math.round(n),s=Math.round(s),this.raster.fetchPixels(r,n,s,o))}async identify(r,n={}){var l;const{raster:s,rasterInfo:o}=this;if(o.multidimensionalInfo!=null&&!(o.hasMultidimensionalTranspose&&(pfe(n.multidimensionalDefinition)||n.transposedVariableName||n.timeExtent))&&(n=this.normalizeRasterFetchOptions(n)).multidimensionalDefinition==null)return{location:r,value:null};const a=(l=this.multidimensionalSubset)==null?void 0:l.areaOfInterest;if(a&&!a.contains(r))throw new N("imagery-tile-mixin:identify","the request cannot be fulfilled when falling outside of the multidimensional subset");return s.identify(r,n)}increaseRasterJobHandlerUsage(){this._rasterJobHandler.refCount++}decreaseRasterJobHandlerUsage(){this._rasterJobHandler.refCount--,this._rasterJobHandler.refCount<=0&&this._shutdownJobHandler()}hasStandardTime(){var o,a,l;const r=(o=this.rasterInfo)==null?void 0:o.multidimensionalInfo;if(r==null||((a=this.rasterInfo)==null?void 0:a.dataType)!=="standard-time")return!1;const n=this.multidimensionalDefinition,s=(l=n==null?void 0:n[0])==null?void 0:l.variableName;return r.variables.some(c=>c.name===s&&(!(n!=null&&n[0].dimensionName)||c.dimensions.some(u=>u.name==="StdTime")))}getStandardTimeValue(r){return new Date(24*(r-25569)*3600*1e3).toString()}getMultidimensionalSubsetVariables(r){var s;const n=r??((s=this.rasterInfo)==null?void 0:s.multidimensionalInfo);return O6e(this.multidimensionalSubset,n)}_configDefaultSettings(){this._configDefaultInterpolation(),this.multidimensionalDefinition||(this.multidimensionalDefinition=cY(this.raster.rasterInfo,{multidimensionalSubset:this.multidimensionalSubset})),this.rasterFunction&&this.raster.datasetFormat==="Function"&&(this._cachedRasterFunctionJson=this.rasterFunction.toJSON()),this._configDefaultRenderer()}_initJobHandler(){if(this._rasterJobHandler.connectionPromise!=null)return this._rasterJobHandler.connectionPromise;const r=new M6e;return this._rasterJobHandler.connectionPromise=r.initialize().then(async()=>{i(this),this._rasterJobHandler.instance=r,this.raster.rasterJobHandler=r,this.raster.datasetFormat==="Function"&&this.raster.syncJobHandler(),this.rasterFunction&&await this.updateRasterFunction().catch(()=>{}),this.renderer&&this.updateRenderer()}).catch(()=>{}),this._rasterJobHandler.connectionPromise}_shutdownJobHandler(){this._rasterJobHandler.instance&&this._rasterJobHandler.instance.destroy(),this._rasterJobHandler.instance=null,this._rasterJobHandler.connectionPromise=null,this._rasterJobHandler.refCount=0,this._cachedRendererJson=null,this.raster&&(this.raster.rasterJobHandler=null)}_configDefaultInterpolation(){var r;if(this.interpolation==null){i(this);const{raster:n}=this,s=CGe(n.rasterInfo,n.tileType,(r=this.sourceJSON)==null?void 0:r.defaultResamplingMethod);this._set("interpolation",s)}}_configDefaultRenderer(r="no"){var u,h;i(this);const{rasterInfo:n}=this.raster;!this.bandIds&&n.bandCount>1&&(this.bandIds=Hfe(n));const s=kz(n,{multidimensionalDefinition:this.multidimensionalDefinition,multidimensionalSubset:this.multidimensionalSubset}),o=s==null?void 0:s.name;if(!this.renderer||r==="override"){const f=tK(n,{bandIds:this.bandIds,variableName:o}),m=n.statistics,g=m&&m.length>0?m[0]:null,y=(g==null?void 0:g.max)??0,v=(g==null?void 0:g.min)??0;this.raster.datasetFormat==="WCSServer"&&f.type==="raster-stretch"&&(y>1e24||v<-1e24)&&(f.dynamicRangeAdjustment=!0,f.statistics=null,f.stretchType==="none"&&(f.stretchType="min-max")),this.renderer=f}const a=rK({...this.renderer.toJSON(),variableName:o}),l=fj(n,o);this.symbolizer?(this.symbolizer.rendererJSON=a,this.symbolizer.rasterInfo=l):this.symbolizer=new FGe({rendererJSON:a,rasterInfo:l});const c=this.symbolizer.bind();if(c.success){if(r==="auto"){const{colormap:f}=this.raster.rasterInfo,m=this.renderer;if(f!=null&&m.type==="raster-colormap"){const g=tK(this.raster.rasterInfo);JSON.stringify(g)!==JSON.stringify(m)&&this._configDefaultRenderer("override")}else if(m.type==="raster-stretch"){const g=(u=this.bandIds)==null?void 0:u.length,y=(h=m.statistics)==null?void 0:h.length;!m.dynamicRangeAdjustment&&y&&g&&y!==g&&this._configDefaultRenderer("override")}}}else aK.warn("imagery-tile-mixin",c.error||"The given renderer is not supported by the layer."),r==="auto"&&this._configDefaultRenderer("override")}};function i(r){if(!r.raster||!r.rasterInfo)throw new N("imagery-tile","no raster")}return d([p()],e.prototype,"_cachedRendererJson",void 0),d([p()],e.prototype,"_cachedRasterFunctionJson",void 0),d([p()],e.prototype,"_compatibleFullExtent",void 0),d([p()],e.prototype,"_isConstructedFromFunctionRaster",void 0),d([p()],e.prototype,"_rasterJobHandler",void 0),d([p()],e.prototype,"bandIds",void 0),d([p({json:{origins:{service:{read:{source:"copyrightText"}}}}})],e.prototype,"copyright",void 0),d([p({json:{read:!1}})],e.prototype,"fullExtent",null),d([p()],e.prototype,"interpolation",void 0),d([p()],e.prototype,"ioConfig",void 0),d([p({type:[Lv],json:{write:!0}})],e.prototype,"multidimensionalDefinition",null),d([p({type:w6e,json:{write:!0}})],e.prototype,"multidimensionalSubset",void 0),d([p()],e.prototype,"raster",void 0),d([p({type:Rv,json:{name:"renderingRule",write:!0}})],e.prototype,"rasterFunction",null),d([p()],e.prototype,"rasterInfo",void 0),d([p()],e.prototype,"sourceJSON",void 0),d([p({readOnly:!0,type:Ee,json:{read:!1}})],e.prototype,"spatialReference",void 0),d([p({type:Od})],e.prototype,"tileInfo",void 0),d([p(HL)],e.prototype,"url",null),d([p({types:Iz,json:{name:"layerDefinition.drawingInfo.renderer",write:{overridePolicy(){var n;const r=((n=this.renderer)==null?void 0:n.type)==="raster-stretch"&&this.renderer.stretchType==="none"&&!this.renderer.useGamma;return{enabled:!this.loaded||this.raster.tileType==="Raster"||!r}}},origins:{"web-scene":{types:Tz,name:"layerDefinition.drawingInfo.renderer",write:{overridePolicy:r=>({enabled:r&&r.type!=="vector-field"&&r.type!=="flow"})}}}}})],e.prototype,"renderer",null),d([ae("renderer")],e.prototype,"readRenderer",null),d([p()],e.prototype,"symbolizer",void 0),e=d([A("esri.layers.ImageryTileMixin")],e),e};function YGe(t){const e=t.fields,i=t.records,r=e.some(c=>c.name.toLowerCase()==="oid")?"OBJECTID":"OID",n=[{name:r,type:"esriFieldTypeOID",alias:"OID"}].concat(e.map(c=>({name:c.name,type:"esriFieldType"+c.typeName,alias:c.name}))),s=n.map(c=>c.name),o=[];let a=0,l=0;return i.forEach(c=>{const u={};for(u[r]=a++,l=1;l<s.length;l++)u[s[l]]=c[l-1];o.push({attributes:u})}),{displayFieldName:"",fields:n,features:o}}let Wfe=class{static get supportedVersions(){return[5]}static parse(e){const i=new DataView(e),r=3&i.getUint8(0);if(r!==3)return{header:{version:r},recordSet:null};const n=i.getUint32(4,!0),s=i.getUint16(8,!0),o=i.getUint16(10,!0),a={version:r,recordCount:n,headerByteCount:s,recordByteCount:o};let l=32;const c=[],u=[];let h;if(r===3){for(;i.getUint8(l)!==13;)h=String.fromCharCode(i.getUint8(l+11)).trim(),c.push({name:Dz(new Uint8Array(e,l,11)),type:h,typeName:["String","Date","Double","Boolean","String","Integer"][["C","D","F","L","M","N"].indexOf(h)],length:i.getUint8(l+16)}),l+=32;if(l+=1,c.length>0)for(;u.length<n&&e.byteLength-l>o;){const f=[];i.getUint8(l)===32?(l+=1,c.forEach(m=>{if(m.type==="C")f.push(Dz(new Uint8Array(e,l,m.length)).trim());else if(m.type==="N")f.push(parseInt(String.fromCharCode.apply(null,new Uint8Array(e,l,m.length)).trim(),10));else if(m.type==="F")f.push(parseFloat(String.fromCharCode.apply(null,new Uint8Array(e,l,m.length)).trim()));else if(m.type==="D"){const g=String.fromCharCode.apply(null,new Uint8Array(e,l,m.length)).trim();f.push(new Date(parseInt(g.substring(0,4),10),parseInt(g.substring(4,6),10)-1,parseInt(g.substring(6,8),10)))}l+=m.length}),u.push(f)):l+=o}}return{header:a,fields:c,records:u,recordSet:YGe({fields:c,records:u})}}},d2=class extends te{get affectsPixelSize(){return!1}forwardTransform(e){return e}inverseTransform(e){return e}};d([p()],d2.prototype,"affectsPixelSize",null),d([p({json:{write:!0}})],d2.prototype,"spatialReference",void 0),d2=d([A("esri.layers.support.rasterTransforms.BaseRasterTransform")],d2);const aG=d2;var vj;let h2=vj=class extends aG{constructor(){super(...arguments),this.type="gcs-shift",this.tolerance=1e-8}forwardTransform(t){return(t=t.clone()).type==="point"?(t.x>180+this.tolerance&&(t.x-=360),t):(t.xmin>=180-this.tolerance?(t.xmax-=360,t.xmin-=360):t.xmax>180+this.tolerance&&(t.xmin=-180,t.xmax=180),t)}inverseTransform(t){return(t=t.clone()).type==="point"?(t.x<-this.tolerance&&(t.x+=360),t):(t.xmin<-this.tolerance&&(t.xmin+=360,t.xmax+=360),t)}clone(){return new vj({tolerance:this.tolerance})}};d([xe({GCSShiftXform:"gcs-shift"})],h2.prototype,"type",void 0),d([p()],h2.prototype,"tolerance",void 0),h2=vj=d([A("esri.layers.support.rasterTransforms.GCSShiftTransform")],h2);const Jfe=h2;var _j;let PA=_j=class extends aG{constructor(){super(...arguments),this.type="identity"}clone(){return new _j}};d([xe({IdentityXform:"identity"})],PA.prototype,"type",void 0),PA=_j=d([A("esri.layers.support.rasterTransforms.IdentityTransform")],PA);const KGe=PA;var bj;function wj(t,e,i){const{x:r,y:n}=e;if(i<2)return{x:t[0]+r*t[2]+n*t[4],y:t[1]+r*t[3]+n*t[5]};if(i===2){const f=r*r,m=n*n,g=r*n;return{x:t[0]+r*t[2]+n*t[4]+f*t[6]+g*t[8]+m*t[10],y:t[1]+r*t[3]+n*t[5]+f*t[7]+g*t[9]+m*t[11]}}const s=r*r,o=n*n,a=r*n,l=s*r,c=s*n,u=r*o,h=n*o;return{x:t[0]+r*t[2]+n*t[4]+s*t[6]+a*t[8]+o*t[10]+l*t[12]+c*t[14]+u*t[16]+h*t[18],y:t[1]+r*t[3]+n*t[5]+s*t[7]+a*t[9]+o*t[11]+l*t[13]+c*t[15]+u*t[17]+h*t[19]}}function lK(t,e,i){const{xmin:r,ymin:n,xmax:s,ymax:o,spatialReference:a}=e;let l=[];if(i<2)l.push({x:r,y:o}),l.push({x:s,y:o}),l.push({x:r,y:n}),l.push({x:s,y:n});else{let h=10;for(let f=0;f<h;f++)l.push({x:r,y:n+(o-n)*f/(h-1)}),l.push({x:s,y:n+(o-n)*f/(h-1)});h=8;for(let f=1;f<=h;f++)l.push({x:r+(s-r)*f/h,y:n}),l.push({x:r+(s-r)*f/h,y:o})}l=l.map(h=>wj(t,h,i));const c=l.map(h=>h.x),u=l.map(h=>h.y);return new Re({xmin:Math.min.apply(null,c),xmax:Math.max.apply(null,c),ymin:Math.min.apply(null,u),ymax:Math.max.apply(null,u),spatialReference:a})}function XGe(t){const[e,i,r,n,s,o]=t,a=r*o-s*n,l=s*n-r*o;return[(s*i-e*o)/a,(r*i-e*n)/l,o/a,n/l,-s/a,-r/l]}let $l=bj=class extends aG{constructor(){super(...arguments),this.polynomialOrder=1,this.type="polynomial"}readForwardCoefficients(t,e){const{coeffX:i,coeffY:r}=e;if(!(i!=null&&i.length)||!(r!=null&&r.length)||i.length!==r.length)return null;const n=[];for(let s=0;s<i.length;s++)n.push(i[s]),n.push(r[s]);return n}writeForwardCoefficients(t,e,i){const r=[],n=[];for(let s=0;s<(t==null?void 0:t.length);s++)s%2==0?r.push(t[s]):n.push(t[s]);e.coeffX=r,e.coeffY=n}get inverseCoefficients(){let t=this._get("inverseCoefficients");const e=this._get("forwardCoefficients");return!t&&e&&this.polynomialOrder<2&&(t=XGe(e)),t}set inverseCoefficients(t){this._set("inverseCoefficients",t)}readInverseCoefficients(t,e){const{inverseCoeffX:i,inverseCoeffY:r}=e;if(!(i!=null&&i.length)||!(r!=null&&r.length)||i.length!==r.length)return null;const n=[];for(let s=0;s<i.length;s++)n.push(i[s]),n.push(r[s]);return n}writeInverseCoefficients(t,e,i){const r=[],n=[];for(let s=0;s<(t==null?void 0:t.length);s++)s%2==0?r.push(t[s]):n.push(t[s]);e.inverseCoeffX=r,e.inverseCoeffY=n}get affectsPixelSize(){return this.polynomialOrder>0}forwardTransform(t){if(t.type==="point"){const e=wj(this.forwardCoefficients,t,this.polynomialOrder);return new fe({x:e.x,y:e.y,spatialReference:t.spatialReference})}return lK(this.forwardCoefficients,t,this.polynomialOrder)}inverseTransform(t){if(t.type==="point"){const e=wj(this.inverseCoefficients,t,this.polynomialOrder);return new fe({x:e.x,y:e.y,spatialReference:t.spatialReference})}return lK(this.inverseCoefficients,t,this.polynomialOrder)}clone(){return new bj({polynomialOrder:this.polynomialOrder,forwardCoefficients:this.forwardCoefficients?[...this.forwardCoefficients]:null,inverseCoefficients:this.inverseCoefficients?[...this.inverseCoefficients]:null})}};d([p({json:{write:!0}})],$l.prototype,"polynomialOrder",void 0),d([p()],$l.prototype,"forwardCoefficients",void 0),d([ae("forwardCoefficients",["coeffX","coeffY"])],$l.prototype,"readForwardCoefficients",null),d([ge("forwardCoefficients")],$l.prototype,"writeForwardCoefficients",null),d([p({json:{write:!0}})],$l.prototype,"inverseCoefficients",null),d([ae("inverseCoefficients",["inverseCoeffX","inverseCoeffY"])],$l.prototype,"readInverseCoefficients",null),d([ge("inverseCoefficients")],$l.prototype,"writeInverseCoefficients",null),d([p()],$l.prototype,"affectsPixelSize",null),d([xe({PolynomialXform:"polynomial"})],$l.prototype,"type",void 0),$l=bj=d([A("esri.layers.support.rasterTransforms.PolynomialTransform")],$l);const rR=$l,Zfe={GCSShiftXform:Jfe,IdentityXform:KGe,PolynomialXform:rR},QGe=Object.keys(Zfe);function e7e(t){const e=t==null?void 0:t.type;return!t||QGe.includes(e)}function t7e(t){if(!(t==null?void 0:t.type))return null;const i=Zfe[t==null?void 0:t.type];if(i){const r=new i;return r.read(t),r}return null}const i0=new Map;i0.set("int16","esriFieldTypeSmallInteger"),i0.set("int32","esriFieldTypeInteger"),i0.set("int64","esriFieldTypeInteger"),i0.set("float32","esriFieldTypeSingle"),i0.set("float64","esriFieldTypeDouble"),i0.set("text","esriFieldTypeString");const cK=8;let p2=class extends Kv{constructor(){super(...arguments),this.storageInfo=null,this.datasetFormat="CRF"}async open(e){await this.init();const{data:i}=await this.request(this.url+"/conf.json",{signal:e==null?void 0:e.signal});if(!this._validateHeader(i))throw new N("cloudraster:open","Invalid or unsupported conf.json.");this.datasetName=this.url.slice(this.url.lastIndexOf("/")+1);const{storageInfo:r,rasterInfo:n}=this._parseHeader(i);if(n.dataType==="thematic"){const s=await this._fetchAuxiliaryInformation();n.attributeTable=s}this._set("storageInfo",r),this._set("rasterInfo",n),this.ioConfig.retryCount=this.ioConfig.retryCount||0}async fetchRawTile(e,i,r,n={}){const{transposeInfo:s}=this.rasterInfo.storageInfo,{transposedVariableName:o}=n,a=!(!s||!o),l=a?0:this.rasterInfo.storageInfo.maximumPyramidLevel-e;if(l<0)return null;const c=this._buildCacheFilePath(l,i,r,n.multidimensionalDefinition,o),u=this._getIndexRecordFromBundle(i,r,a),h=await this.request(c,{range:{from:0,to:this.storageInfo.headerSize-1},responseType:"array-buffer",signal:n.signal});if(!h)return null;const f=new Uint8Array(h.data),m=this._getTileEndAndContentType(f,u);if(m.recordSize===0)return null;const g=await this.request(c,{range:{from:m.position,to:m.position+m.recordSize},responseType:"array-buffer",signal:n.signal});if(!g)return null;const[y,v]=this._getTileSize(a);return this.decodePixelBlock(g.data,{width:y,height:v,planes:null,pixelType:null,returnInterleaved:a})}_validateHeader(e){const i=["origin","extent","geodataXform","LODInfos","blockWidth","blockHeight","bandCount","pixelType","pixelSizeX","pixelSizeY","format","packetSize"];return e&&e.type==="RasterInfo"&&!i.some(r=>!e[r])}_parseHeader(e){var K;const i=["u1","u2","u4","u8","s8","u16","s16","u32","s32","f32","f64"][e.pixelType],{bandCount:r,histograms:n,colormap:s,blockWidth:o,blockHeight:a,firstPyramidLevel:l,maximumPyramidLevel:c}=e,u=e.statistics&&e.statistics.map(X=>({min:X.min,max:X.max,avg:X.mean,stddev:X.standardDeviation,median:X.median,mode:X.mode})),h=e.extent.spatialReference,f=(K=e.geodataXform)==null?void 0:K.spatialReference,m=new Ee(h!=null&&h.wkid||h!=null&&h.wkt?h:f);let g=new Re({xmin:e.extent.xmin,ymin:e.extent.ymin,xmax:e.extent.xmax,ymax:e.extent.ymax,spatialReference:m});const y=new fe({x:e.pixelSizeX,y:e.pixelSizeY,spatialReference:m}),v=Math.round((g.xmax-g.xmin)/y.x),b=Math.round((g.ymax-g.ymin)/y.y),w=this._parseTransform(e.geodataXform),x=w?g:null;w&&(g=w.forwardTransform(g),y.x=(g.xmax-g.xmin)/v,y.y=(g.ymax-g.ymin)/b);const S=e.properties??{},I=e.format.toLowerCase().replace("cache/",""),T=new fe(e.origin.x,e.origin.y,m);let C,E,$,P;if(s&&s.colors)for(C=[],E=0;E<s.colors.length;E++)$=s.colors[E],P=s.values?s.values[E]:E,C.push([P,255&$,$<<16>>>24,$<<8>>>24,$>>>24]);const k=e.LODInfos,L=[];for(E=0;E<k.levels.length;E++)L.push(new vd({level:k.levels[E],resolution:k.resolutions[E],scale:96/.0254*k.resolutions[E]}));const F=new Od({dpi:96,lods:L,format:I,origin:T,size:[o,a],spatialReference:m}),V={recordSize:cK,packetSize:e.packetSize,headerSize:e.packetSize*e.packetSize*cK+64},z=[{maxCol:Math.ceil(v/o)-1,maxRow:Math.ceil(b/a)-1,minCol:0,minRow:0}];let G=2;if(c>0)for(E=0;E<c;E++)z.push({maxCol:Math.ceil(v/G/o)-1,maxRow:Math.ceil(b/G/a)-1,minCol:0,minRow:0}),G*=2;const H=e.mdInfo;let Z=null;if(H&&S._yxs){const X=S._yxs;Z={packetSize:X.PacketSize,tileSize:[X.TileXSize,X.TileYSize]}}return{storageInfo:V,rasterInfo:new Ap({width:v,height:b,pixelType:i,bandCount:r,extent:g,nativeExtent:x,transform:w,spatialReference:m,pixelSize:y,keyProperties:S,statistics:u,histograms:n,multidimensionalInfo:H,colormap:C,storageInfo:new nx({blockWidth:o,blockHeight:a,pyramidBlockWidth:o,pyramidBlockHeight:a,origin:T,tileInfo:F,transposeInfo:Z,firstPyramidLevel:l,maximumPyramidLevel:c,blockBoundary:z})})}}_parseTransform(e){var r,n;if(!e7e(e))throw new N("cloudraster:open","the data contains unsupported geodata transform types");const i=t7e(e);if(i.type==="identity")return null;if(i.type!=="polynomial"||!((r=i.forwardCoefficients)!=null&&r.length)||!((n=i.inverseCoefficients)!=null&&n.length))throw new N("cloudraster:open","the data contains unsupported geodata transforms - both forward and inverse coefficients are required currently");return i}async _fetchAuxiliaryInformation(e){const i=this.request(this.url+"/conf.vat.json",{signal:e}).then(o=>o.data).catch(()=>null),r=this.request(this.url+"/conf.vat.dbf",{responseType:"array-buffer",signal:e}).then(o=>o.data).catch(()=>null),n=await Promise.all([i,r]);let s;if(n[0]){let o=n[0].fields;const a=n[0].values;if(o&&a){o=o.map(c=>({type:c.name==="OID"?"esriFieldTypeOID":i0.get(c.type),name:c.name,alias:c.alias||c.name}));const l=a.map(c=>({attributes:c}));o&&a&&(s={fields:o,features:l})}}return!s&&n[1]&&(s=Wfe.parse(n[1]).recordSet),Mg.fromJSON(s)}_buildCacheFilePath(e,i,r,n,s){const o=this._getPackageSize(!!s),a=Math.floor(i/o)*o,l=Math.floor(r/o)*o,c="R"+this._toHexString4(a)+"C"+this._toHexString4(l);let u="L";u+=e>=10?e.toString():"0"+e.toString();const{multidimensionalInfo:h}=this.rasterInfo,f=n==null?void 0:n[0];if(h==null||!f)return`${this.url}/_alllayers/${u}/${c}.bundle`;let m="_yxs";if(!s){m=h.variables.find(v=>v.name===f.variableName).dimensions[0].values.indexOf(f.values[0]).toString(16);const y=4-m.length;for(let v=0;v<y;v++)m="0"+m;m="S"+m}const g=this._getVariableFolderName(s||f.variableName);return`${this.url}/_alllayers/${g}/${m}/${u}/${c}.bundle`}_getPackageSize(e=!1){const{transposeInfo:i}=this.rasterInfo.storageInfo;return e&&i!=null?i.packetSize??0:this.storageInfo.packetSize}_getTileSize(e=!1){const{storageInfo:i}=this.rasterInfo,{transposeInfo:r}=i;return e&&r!=null?r.tileSize:i.tileInfo.size}_getVariableFolderName(e){return(e=e.trim())===""?"_v":e.replaceAll(/[\{|\}\-]/g,"_").replace("\\*","_v")}_getIndexRecordFromBundle(e,i,r=!1){const n=this._getPackageSize(r),s=n*(e%n)+i%n;if(s<0)throw new Error("Invalid level / row / col");return 20+s*this.storageInfo.recordSize+44}_getTileEndAndContentType(e,i){const r=e.subarray(i,i+8);let n,s=0;for(n=0;n<5;n++)s|=(255&r[n])<<8*n;const o=0xffffffffff&s;for(s=0,n=5;n<8;n++)s|=(255&r[n])<<8*(n-5);return{position:o,recordSize:0xffffffffff&s}}_toHexString4(e){let i=e.toString(16);if(i.length!==4){let r=4-i.length;for(;r-- >0;)i="0"+i}return i}};d([p({readOnly:!0})],p2.prototype,"storageInfo",void 0),d([p({type:String,json:{write:!0}})],p2.prototype,"datasetFormat",void 0),p2=d([A("esri.layers.support.rasterDatasets.CloudRaster")],p2);const i7e=p2;let f2=class extends Kv{constructor(){super(...arguments),this.datasetFormat="MEMORY",this.data=null}async open(e){await this.init();const i=this.data,{pixelBlock:r,statistics:n,histograms:s,name:o,keyProperties:a,nativeExtent:l,transform:c}=this.data,{width:u,height:h,pixelType:f}=r,m=i.extent??new Re({xmin:-.5,ymin:.5,xmax:u-.5,ymax:h-.5,spatialReference:new Ee({wkid:3857})}),g=i.isPseudoSpatialReference??!i.extent,y={x:m.width/u,y:m.height/h},v=new Ap({width:u,height:h,pixelType:f,extent:m,nativeExtent:l,transform:c,pixelSize:y,spatialReference:m.spatialReference,bandCount:r.pixels.length,keyProperties:a||{},statistics:n,isPseudoSpatialReference:g,histograms:s});this.createRemoteDatasetStorageInfo(v,512,512),this._set("rasterInfo",v),this.updateTileInfo(),await this._buildInMemoryRaster(r,{width:512,height:512},e),this.datasetName=o,this.url="/InMemory/"+o}fetchRawTile(e,i,r,n={}){const s=this._pixelBlockTiles.get(`${e}/${i}/${r}`);return Promise.resolve(s)}async _buildInMemoryRaster(e,i,r){var u,h;const n=this.rasterInfo.storageInfo.maximumPyramidLevel,s=this.rasterJobHandler?this.rasterJobHandler.split({pixelBlock:e,tileSize:i,maximumPyramidLevel:n},r):Promise.resolve(M8e(e,i,n)),o=this.rasterInfo.statistics!=null,a=this.rasterInfo.histograms!=null,l=o?Promise.resolve({statistics:null,histograms:null}):this.rasterJobHandler?this.rasterJobHandler.estimateStatisticsHistograms({pixelBlock:e},r):Promise.resolve(Dfe(e)),c=await br([s,l]);if(!c[0].value&&c[1].value)throw new N("inmemory-raster:open","failed to build in memory raster");this._pixelBlockTiles=c[0].value,o||(this.rasterInfo.statistics=(u=c[1].value)==null?void 0:u.statistics),a||(this.rasterInfo.histograms=(h=c[1].value)==null?void 0:h.histograms)}};d([p({type:String,json:{write:!0}})],f2.prototype,"datasetFormat",void 0),d([p()],f2.prototype,"data",void 0),f2=d([A("esri.layers.support.rasterDatasets.InMemoryRaster")],f2);const r7e=f2;function g1(t,e){if(!t||!e)return[];let i=e;e.includes("/")?(i=e.slice(0,e.indexOf("/")),e=e.slice(e.indexOf("/")+1)):e="";const r=[];if(e){const s=g1(t,i);for(let o=0;o<s.length;o++)g1(s[o],e).forEach(a=>r.push(a));return r}const n=t.getElementsByTagNameNS("*",i);if(!n||n.length===0)return[];for(let s=0;s<n.length;s++)r.push(n[s]||n.item(s));return r}function Hl(t,e){if(!t||!e)return null;let i=e;e.includes("/")?(i=e.slice(0,e.indexOf("/")),e=e.slice(e.indexOf("/")+1)):e="";const r=g1(t,i);return r.length>0?e?Hl(r[0],e):r[0]:null}function Sd(t,e=null){const i=e?Hl(t,e):t;let r;return i?(r=i.textContent||i.nodeValue,r?r.trim():null):null}function n7e(t,e){const i=g1(t,e),r=[];let n;for(let s=0;s<i.length;s++)n=i[s].textContent||i[s].nodeValue,n&&(n=n.trim(),n!==""&&r.push(n));return r}function pM(t,e){return n7e(t,e).map(i=>Number(i))}function O0(t,e){const i=Sd(t,e);return Number(i)}function R5(t,e){var n;const i=(n=t==null?void 0:t.nodeName)==null?void 0:n.toLowerCase(),r=e.toLowerCase();return i.slice(i.lastIndexOf(":")+1)===r}function uK(t,e){if(!t||!e)return null;const i=[];for(let r=0;r<t.length;r++)i.push(t[r]),i.push(e[r]);return i}function s7e(t){const e=Hl(t,"GeodataXform"),i=nR(O0(e,"SpatialReference/WKID")||Sd(e,"SpatialReference/WKT"));if(e.getAttribute("xsi:type")!=="typens:PolynomialXform")return{spatialReference:i,transform:null};const r=O0(e,"PolynomialOrder")??1,n=pM(e,"CoeffX/Double"),s=pM(e,"CoeffY/Double"),o=pM(e,"InverseCoeffX/Double"),a=pM(e,"InverseCoeffY/Double"),l=uK(n,s),c=uK(o,a);return{spatialReference:i,transform:l&&c&&l.length&&c.length?new rR({spatialReference:i,polynomialOrder:r,forwardCoefficients:l,inverseCoefficients:c}):null}}function o7e(t){var f;const e=O0(t,"NoDataValue"),i=Hl(t,"Histograms/HistItem"),r=O0(i,"HistMin"),n=O0(i,"HistMax"),s=O0(i,"BucketCount"),o=(f=Sd(i,"HistCounts"))==null?void 0:f.split("|").map(m=>Number(m));let a,l,c,u;g1(t,"Metadata/MDI").forEach(m=>{const g=Number(m.textContent??m.nodeValue);switch(m.getAttribute("key").toUpperCase()){case"STATISTICS_MINIMUM":a=g;break;case"STATISTICS_MAXIMUM":l=g;break;case"STATISTICS_MEAN":c=g;break;case"STATISTICS_STDDEV":u=g}});const h=O0(t,"Metadata/SourceBandIndex");return{noDataValue:e,histogram:o!=null&&o.length&&r!=null&&n!=null?{min:r,max:n,size:s||o.length,counts:o}:null,sourceBandIndex:h,statistics:a!=null&&l!=null?{min:a,max:l,avg:c,stddev:u}:null}}function nR(t){if(!t)return null;let e=Number(t);if(!isNaN(e)&&e!==0)return new Ee({wkid:e});if((t=String(t)).startsWith("COMPD_CS")){if(!t.includes("VERTCS")||!t.includes("GEOGCS")&&!t.startsWith("PROJCS"))return null;const i=t.indexOf("VERTCS"),r=t.indexOf("PROJCS"),n=r>-1?r:t.indexOf("GEOGCS");if(n===-1)return null;const s=t.slice(n,t.lastIndexOf("]",i)+1).trim(),o=t.slice(i,t.lastIndexOf("]")).trim();e=F5(s);const a=new Ee(e?{wkid:e}:{wkt:s}),l=F5(o);return l&&(a.vcsWkid=l),a}return t.startsWith("GEOGCS")||t.startsWith("PROJCS")?(e=F5(t),new Ee(e!==0?{wkid:e}:{wkt:t})):null}function F5(t){var n;const e=t.replaceAll("]","[").replaceAll('"',"").split("[").map(s=>s.trim()).filter(s=>s!==""),i=e[e.length-1].split(","),r=(n=i[0])==null?void 0:n.toLowerCase();if((r==="epsg"||r==="esri")&&t.endsWith('"]]')){const s=Number(i[1]);if(!isNaN(s)&&s!==0)return s}return 0}function lG(t){var r;if(((r=t==null?void 0:t.documentElement.tagName)==null?void 0:r.toLowerCase())!=="pamdataset")return{};const e={spatialReference:null,transform:null,metadata:{},rasterBands:[],statistics:null,histograms:null};t.documentElement.childNodes.forEach(n=>{if(n.nodeType===1){if(R5(n,"SRS")){if(!e.spatialReference){const s=Sd(n);e.spatialReference=nR(s)}}else if(R5(n,"Metadata"))if(n.getAttribute("domain")==="xml:ESRI"){const{spatialReference:s,transform:o}=s7e(n);e.transform=o,e.spatialReference||(e.spatialReference=s)}else g1(n,"MDI").forEach(s=>e.metadata[s.getAttribute("key")]=Sd(s));else if(R5(n,"PAMRasterBand")){const s=o7e(n);s.sourceBandIndex!=null&&e.rasterBands[s.sourceBandIndex]==null?e.rasterBands[s.sourceBandIndex]=s:e.rasterBands.push(s)}}});const i=e.rasterBands;if(i.length){const n=!!i[0].statistics;e.statistics=n?i.map(o=>o.statistics).filter(Dt):null;const s=!!i[0].histogram;e.histograms=s?i.map(o=>o.histogram).filter(Dt):null}return e}let OA=class extends Kv{async open(e){await this.init();const i=await this._fetchData(e);let{spatialReference:r,statistics:n,histograms:s,transform:o}=await this._fetchAuxiliaryData(e);const a=!r;a&&(r=new Ee({wkid:3857})),s!=null&&s.length&&n==null&&(n=iG(s));const{width:l,height:c}=i;let u=new Re({xmin:-.5,ymin:.5-c,xmax:l-.5,ymax:.5,spatialReference:r});const h=o?o.forwardTransform(u):u;let f=!0;if(o){const g=o.forwardCoefficients;f=g&&g[1]===0&&g[2]===0,f&&(o=null,u=h)}const m=new r7e({data:{extent:h,nativeExtent:u,transform:o,pixelBlock:i,statistics:n,histograms:s,keyProperties:{DateType:"Processed"},isPseudoSpatialReference:a}});await m.open(),m.data=null,this._set("rasterInfo",m.rasterInfo),this._inMemoryRaster=m}fetchRawTile(e,i,r,n={}){return this._inMemoryRaster.fetchRawTile(e,i,r,n)}async _fetchData(e){const{data:i}=await this.request(this.url,{responseType:"array-buffer",signal:e==null?void 0:e.signal}),r=RBe(i).toUpperCase();if(r!=="JPG"&&r!=="PNG"&&r!=="GIF"&&r!=="BMP")throw new N("image-aux-raster:open","the data is not a supported format");this._set("datasetFormat",r);const n=r.toLowerCase(),s=n==="gif"||n==="bmp"||!ee("ios"),o=await this.decodePixelBlock(i,{format:n,useCanvas:s,hasNoZlibMask:!0});if(o==null)throw new N("image-aux-raster:open","the data cannot be decoded");return o}async _fetchAuxiliaryData(e){var u;const i=e==null?void 0:e.signal,r=this.ioConfig.skipExtensions??[],n=r.includes("aux.xml")?null:this.request(this.url+".aux.xml",{responseType:"xml",signal:i}),s=this.datasetFormat,o=s==="JPG"?"jgw":s==="PNG"?"pgw":s==="BMP"?"bpw":null,a=o&&r.includes(o)?null:this.request(this.url.slice(0,this.url.lastIndexOf("."))+"."+o,{responseType:"text",signal:i}),l=await br([n,a]);if(i!=null&&i.aborted)throw wi();const c=lG((u=l[0].value)==null?void 0:u.data);if(!c.transform){const h=l[1].value?l[1].value.data.split(`
`).slice(0,6).map(f=>Number(f)):null;c.transform=(h==null?void 0:h.length)===6?new rR({forwardCoefficients:[h[4],h[5],h[0],-h[1],h[2],-h[3]]}):null}return c}};d([p({type:String,json:{write:!0}})],OA.prototype,"datasetFormat",void 0),OA=d([A("esri.layers.support.rasterDatasets.ImageAuxRaster")],OA);const fM=OA;var Dv;(function(t){t[t.KILOBYTES=1024]="KILOBYTES",t[t.MEGABYTES=1048576]="MEGABYTES",t[t.GIGABYTES=1073741824]="GIGABYTES"})(Dv||(Dv={}));function a7e(t,e=!1){return t<=a1e?e?new Array(t).fill(0):new Array(t):new Uint32Array(t)}let dK=class xj{constructor(e){this._validateJSON(e);const{location:i,data:r}=e;this.location=Object.freeze(U(i));const n=this.location.width,s=this.location.height;let o=!0,a=!0;const l=Math.ceil(n*s/32),c=a7e(l);let u=0;for(let h=0;h<r.length;h++){const f=h%32;r[h]?(a=!1,c[u]|=1<<f):o=!1,f===31&&++u}a?(this._availability="unavailable",this.byteSize=40):o?(this._availability="available",this.byteSize=40):(this._availability=c,this.byteSize=40+s1e(c))}getAvailability(e,i){if(this._availability==="unavailable"||this._availability==="available")return this._availability;const r=(e-this.location.top)*this.location.width+(i-this.location.left),n=r%32,s=r>>5,o=this._availability;return s<0||s>o.length?"unknown":o[s]&1<<n?"available":"unavailable"}static fromDefinition(e,i){const r=e.service.request||at,{row:n,col:s,width:o,height:a}=e,l={query:{f:"json"}};return i=i?{...l,...i}:l,r(l7e(e),i).then(c=>c.data).catch(c=>{if(c&&c.details&&c.details.httpStatus===422)return{location:{top:n,left:s,width:o,height:a},valid:!0,data:t1e(o*a,0)};throw c}).then(c=>{if(c.location&&(c.location.top!==n||c.location.left!==s||c.location.width!==o||c.location.height!==a))throw new N("tilemap:location-mismatch","Tilemap response for different location than requested",{response:c,definition:{top:n,left:s,width:o,height:a}});return xj.fromJSON(c)})}static fromJSON(e){return Object.freeze(new xj(e))}_validateJSON(e){if(!e||!e.location)throw new N("tilemap:missing-location","Location missing from tilemap response");if(e.valid===!1)throw new N("tilemap:invalid","Tilemap response was marked as invalid");if(!e.data)throw new N("tilemap:missing-data","Data missing from tilemap response");if(!Array.isArray(e.data))throw new N("tilemap:data-mismatch","Data must be an array of numbers");if(e.data.length!==e.location.width*e.location.height)throw new N("tilemap:data-mismatch","Number of data items does not match width/height of tilemap")}};function hK(t){return`${t.level}/${t.row}/${t.col}/${t.width}/${t.height}`}function l7e(t){var r;let e;if((r=t.service.tileServers)!=null&&r.length){const n=t.service.tileServers;e=`${n&&n.length?n[t.row%n.length]:t.service.url}/tilemap/${t.level}/${t.row}/${t.col}/${t.width}/${t.height}`}else e=`${t.service.url}/tilemap/${t.level}/${t.row}/${t.col}/${t.width}/${t.height}`;const i=t.service.query;return i&&(e=`${e}?${i}`),e}var L0;let rd=L0=class extends he{constructor(t){super(t),this._pendingTilemapRequests={},this.request=at,this.size=32,this._prefetchingEnabled=!0}initialize(){this._tilemapCache=new LL(2*Dv.MEGABYTES),this.addHandles([J(()=>{const{layer:t}=this;return[t==null?void 0:t.parsedUrl,t==null?void 0:t.tileServers,t==null?void 0:t.apiKey,t==null?void 0:t.customParameters]},()=>this._initializeTilemapDefinition(),Le)])}get effectiveMinLOD(){return this.minLOD??this.layer.tileInfo.lods[0].level}get effectiveMaxLOD(){return this.maxLOD??this.layer.tileInfo.lods[this.layer.tileInfo.lods.length-1].level}fetchTilemap(t,e,i,r){if(!this.layer.tileInfo.lodAt(t)||t<this.effectiveMinLOD||t>this.effectiveMaxLOD)return Promise.reject(new N("tilemap-cache:level-unavailable",`Level ${t} is unavailable in the service`));const n=this._tmpTilemapDefinition,s=this._tilemapFromCache(t,e,i,n);if(s)return Promise.resolve(s);const o=r&&r.signal;return r={...r,signal:null},new Promise((a,l)=>{Fo(o,()=>l(wi()));const c=hK(n);let u=this._pendingTilemapRequests[c];if(!u){u=dK.fromDefinition(n,r).then(f=>(this._tilemapCache.put(c,f,f.byteSize),f));const h=()=>delete this._pendingTilemapRequests[c];this._pendingTilemapRequests[c]=u,u.then(h,h)}u.then(a,l)})}getAvailability(t,e,i){if(!this.layer.tileInfo.lodAt(t)||t<this.effectiveMinLOD||t>this.effectiveMaxLOD)return"unavailable";const r=this._tilemapFromCache(t,e,i,this._tmpTilemapDefinition);return r?r.getAvailability(e,i):"unknown"}fetchAvailability(t,e,i,r){return!this.layer.tileInfo.lodAt(t)||t<this.effectiveMinLOD||t>this.effectiveMaxLOD?Promise.reject(new N("tile-map:tile-unavailable","Tile is not available",{level:t,row:e,col:i})):this.fetchTilemap(t,e,i,r).catch(n=>n).then(n=>{if(n instanceof dK){const s=n.getAvailability(e,i);if(s==="unavailable")throw new N("tile-map:tile-unavailable","Tile is not available",{level:t,row:e,col:i});return s}if(ys(n))throw n;return"unknown"})}fetchAvailabilityUpsample(t,e,i,r,n){r.level=t,r.row=e,r.col=i;const s=this.layer.tileInfo;s.updateTileInfo(r);const o=this.fetchAvailability(t,e,i,n).catch(a=>{if(ys(a))throw a;if(s.upsampleTile(r))return this.fetchAvailabilityUpsample(r.level,r.row,r.col,r,n);throw a});return this._fetchAvailabilityUpsamplePrefetch(r.id,t,e,i,n,o),o}async _fetchAvailabilityUpsamplePrefetch(t,e,i,r,n,s){if(!this._prefetchingEnabled||t==null)return;const o=`prefetch-${t}`;if(this.hasHandles(o))return;const a=new AbortController;s.then(()=>a.abort(),()=>a.abort());let l=!1;const c=Et(()=>{l||(l=!0,a.abort())});if(this.addHandles(c,o),await Q1e(10,a.signal).catch(()=>{}),l||(l=!0,this.removeHandles(o)),zo(a))return;const u=new yL(t,e,i,r),h={...n,signal:a.signal},f=this.layer.tileInfo;for(let m=0;L0._prefetches.length<L0._maxPrefetch&&f.upsampleTile(u);++m){const g=this.fetchAvailability(u.level,u.row,u.col,h);L0._prefetches.push(g);const y=()=>{L0._prefetches.removeUnordered(g)};g.then(y,y)}}_initializeTilemapDefinition(){var r;if(!this.layer.parsedUrl)return;const{parsedUrl:t,apiKey:e,customParameters:i}=this.layer;this._tilemapCache.clear(),this._tmpTilemapDefinition={service:{url:t.path,query:Zw({...t.query,...i,token:e??((r=t.query)==null?void 0:r.token)}),tileServers:this.layer.tileServers,request:this.request},width:this.size,height:this.size,level:0,row:0,col:0}}_tilemapFromCache(t,e,i,r){r.level=t,r.row=e-e%this.size,r.col=i-i%this.size;const n=hK(r);return this._tilemapCache.get(n)}get test(){const t=this;return{get prefetchingEnabled(){return t._prefetchingEnabled},set prefetchingEnabled(e){t._prefetchingEnabled=e},hasTilemap:(e,i,r)=>!!t._tilemapFromCache(e,i,r,t._tmpTilemapDefinition)}}};rd._maxPrefetch=4,rd._prefetches=new qm({initialSize:L0._maxPrefetch}),d([p({constructOnly:!0})],rd.prototype,"layer",void 0),d([p({constructOnly:!0})],rd.prototype,"minLOD",void 0),d([p({constructOnly:!0})],rd.prototype,"maxLOD",void 0),d([p({constructOnly:!0})],rd.prototype,"request",void 0),d([p({constructOnly:!0})],rd.prototype,"size",void 0),rd=L0=d([A("esri.layers.support.TilemapCache")],rd);async function Yfe(t,e,i){var F,V,z,G,H,Z;const r=rx(t),{rasterFunction:n,sourceJSON:s}=e||{},o=n?JSON.stringify(n.rasterFunctionDefinition||n):null,a=LC({...r.query,renderingRule:o,f:"json"}),l=OC(a,i);t=r.path;const c=s||await at(t,l).then(K=>K.data),u=c.hasRasterAttributeTable?at(`${t}/rasterAttributeTable`,l):null,h=c.hasColormap?at(`${t}/colormap`,l):null,f=c.hasHistograms?at(`${t}/histograms`,l):null,m=c.currentVersion>=10.3?at(`${t}/keyProperties`,l):null,g=c.hasMultidimensions?at(`${t}/multidimensionalInfo`,l):null,y=await Promise.allSettled([u,h,f,m,g]);let v=null;if(c.minValues&&c.minValues.length===c.bandCount){v=[];for(let K=0;K<c.minValues.length;K++)v.push({min:c.minValues[K],max:c.maxValues[K],avg:c.meanValues[K],stddev:c.stdvValues[K]})}const b=Re.fromJSON(c.extent),w=Math.ceil(b.width/c.pixelSizeX-.1),x=Math.ceil(b.height/c.pixelSizeY-.1),S=Ee.fromJSON(c.spatialReference||c.extent.spatialReference),I=y[0].status==="fulfilled"&&y[0].value?Mg.fromJSON(y[0].value.data):null,T=y[1].status==="fulfilled"?(F=y[1].value)==null?void 0:F.data.colormap:null,C=y[2].status==="fulfilled"?(V=y[2].value)==null?void 0:V.data.histograms:null,E=y[3].status==="fulfilled"?((z=y[3].value)==null?void 0:z.data)??{}:{},$=y[4].status==="fulfilled"?(G=y[4].value)==null?void 0:G.data.multidimensionalInfo:null;(H=$==null?void 0:$.variables)!=null&&H.length&&$.variables.forEach(K=>{var X;(X=K.statistics)!=null&&X.length&&K.statistics.forEach(oe=>{oe.avg=oe.mean,oe.stddev=oe.standardDeviation})});const{defaultVariable:P,serviceDataType:k}=c;P&&P!==E.DefaultVariable&&(E.DefaultVariable=P),k&&k.includes("esriImageServiceDataTypeVector")&&!k.includes(E.DataType)&&(E.DataType=k.replace("esriImageServiceDataType",""));let L=c.noDataValue;return(Z=c.noDataValues)!=null&&Z.length&&c.noDataValues.some(K=>K!==L)&&(L=c.noDataValues),new Ap({width:w,height:x,bandCount:c.bandCount,extent:Re.fromJSON(c.extent),spatialReference:S,pixelSize:new fe({x:c.pixelSizeX,y:c.pixelSizeY,spatialReference:S}),pixelType:c.pixelType.toLowerCase(),statistics:v,attributeTable:I,colormap:T,histograms:C,keyProperties:E,noDataValue:L,multidimensionalInfo:$})}function c7e(t,e,i){return Yfe(t,{sourceJSON:e},i)}function D1t(t,e,i){return Yfe(t,{rasterFunction:e},i)}let m2=class extends Kv{constructor(){super(...arguments),this._levelOffset=0,this._tilemapCache=null,this._slices=null,this.datasetFormat="RasterTileServer",this.tileType=null}async open(e){var E,$;await this.init();const i=e&&e.signal,r=this.sourceJSON?{data:this.sourceJSON}:await this.request(this.url,{query:{f:"json"},signal:i});r.ssl&&(this.url=this.url.replace(/^http:/i,"https:"));const n=r.data;if(this.sourceJSON=n,!n)throw new N("imageserverraster:open","cannot initialize tiled image service, missing service info");if(!n.tileInfo)throw new N("imageserverraster:open","use ImageryLayer to open non-tiled image services");this._fixScaleInServiceInfo();const s=["jpg","jpeg","png","png8","png24","png32","mixed"];this.tileType=n.cacheType,this.tileType==null&&(s.includes(n.tileInfo.format.toLowerCase())?this.tileType="Map":n.tileInfo.format.toLowerCase()==="lerc"?this.tileType="Elevation":this.tileType="Raster"),this.datasetName=((E=n.name)==null?void 0:E.slice(n.name.indexOf("/")+1))??"";const o=await this._fetchRasterInfo({signal:i});if(o==null)throw new N("image-server-raster:open","cannot initialize image service");const a=this.tileType==="Map"?u7e(n.tileInfo,n):Od.fromJSON(n.tileInfo);lo(a);const[l,c]=this._computeMinMaxLOD(o,a),{extent:u,pixelSize:h}=o,f=.5/o.width*h.x,m=Math.max(h.x,h.y),{lods:g}=a;(this.tileType!=="Map"&&n.maxScale!==0||Math.abs(h.x-h.y)>f||!g.some(P=>Math.abs(P.resolution-m)<f))&&(h.x=h.y=l.resolution,o.width=Math.ceil((u.xmax-u.xmin)/h.x-.1),o.height=Math.ceil((u.ymax-u.ymin)/h.y-.1));const y=l.level-c.level,[v,b]=a.size,w=[],x=[];g.forEach((P,k)=>{P.level>=c.level&&P.level<=l.level&&w.push({x:P.resolution,y:P.resolution}),k<g.length-1&&x.push(Math.round(10*P.resolution/g[k+1].resolution)/10)}),w.sort((P,k)=>P.x-k.x);const S=this.computeBlockBoundary(u,v,b,a.origin,w,y),I=w.length>1?w.slice(1):null;let T;n.transposeInfo&&(T={tileSize:[n.transposeInfo.rows,n.transposeInfo.cols],packetSize:(($=o.keyProperties)==null?void 0:$._yxs.PacketSize)??0});const C=x.length<=1||x.length>=3&&x.slice(0,x.length-1).every(P=>P===x[0])?x[0]??2:Math.round(10/(c.resolution/l.resolution)**(-1/y))/10;if(o.storageInfo=new nx({blockWidth:a.size[0],blockHeight:a.size[1],pyramidBlockWidth:a.size[0],pyramidBlockHeight:a.size[1],pyramidResolutions:I,pyramidScalingFactor:C,compression:a.format,origin:a.origin,firstPyramidLevel:1,maximumPyramidLevel:y,tileInfo:a,transposeInfo:T,blockBoundary:S}),this._fixGCSShift(o),this._set("rasterInfo",o),n.capabilities.toLowerCase().includes("tilemap")){const P={tileInfo:o.storageInfo.tileInfo,parsedUrl:sn(this.url),url:this.url,tileServers:[]};this._tilemapCache=new rd({layer:P})}}async fetchRawTile(e,i,r,n={}){const{storageInfo:s,extent:o}=this.rasterInfo,{transposeInfo:a}=s,l=a!=null&&!!n.transposedVariableName;if(this._slices&&!l&&n.sliceId==null)return null;const c=l?0:s.maximumPyramidLevel-e+this._levelOffset,u=`${this.url}/tile/${c}/${i}/${r}`,h=this._slices?l?{variable:n.transposedVariableName}:{sliceId:n.sliceId||0}:null,{data:f}=await this.request(u,{query:h,responseType:"array-buffer",signal:n.signal});if(!f)return null;const m=l?a.tileSize:s.tileInfo.size,g=await this.decodePixelBlock(f,{width:m[0],height:m[1],planes:null,pixelType:null,isPoint:this.tileType==="Elevation",returnInterleaved:l,noDataValue:this.rasterInfo.noDataValue});if(g==null)return null;const y=s.blockBoundary[e];if(s.compression!=="jpg"||r>y.minCol&&r<y.maxCol&&i>y.minRow&&i<y.maxRow)return g;const{origin:v,blockWidth:b,blockHeight:w}=s,{x,y:S}=this.getPyramidPixelSize(e),I=Math.round((o.xmin-v.x)/x)%b,T=Math.round((o.xmax-v.x)/x)%b||b,C=Math.round((v.y-o.ymax)/S)%w,E=Math.round((v.y-o.ymin)/S)%w||w,$=r===y.minCol?I:0,P=i===y.minRow?C:0,k=r===y.maxCol?T:b,L=i===y.maxRow?E:w;return I8e(g,{x:$,y:P},{width:k-$,height:L-P}),g}getSliceIndex(e){if(!this._slices||e==null||e.length===0)return null;const i=e;for(let r=0;r<this._slices.length;r++){const n=this._slices[r].multidimensionalDefinition;if(n.length===i.length&&!n.some(s=>{const o=i.find(a=>s.variableName===a.variableName&&a.dimensionName===s.dimensionName);return o?(Array.isArray(s.values[0])?`${s.values[0][0]}-${s.values[0][1]}`:s.values[0])!==(Array.isArray(o.values[0])?`${o.values[0][0]}-${o.values[0][1]}`:o.values[0]):!0}))return r}return null}async fetchVariableStatisticsHistograms(e,i){const r=this.request(this.url+"/statistics",{query:{variable:e,f:"json"},signal:i}).then(o=>{var a;return(a=o.data)==null?void 0:a.statistics}),n=this.request(this.url+"/histograms",{query:{variable:e,f:"json"},signal:i}).then(o=>{var a;return(a=o.data)==null?void 0:a.histograms}),s=await Promise.all([r,n]);return s[0]&&s[0].forEach(o=>{o.avg=o.mean,o.stddev=o.standardDeviation}),{statistics:s[0]||null,histograms:s[1]||null}}async computeBestPyramidLevelForLocation(e,i={}){if(!this._tilemapCache)return 0;let r=this.identifyPixelLocation(e,0,i.datumTransformation);if(r===null)return null;let n=0;const{maximumPyramidLevel:s}=this.rasterInfo.storageInfo;let o=s-n+this._levelOffset;const a=r.srcLocation;for(;o>=0;){try{if(await this._tilemapCache.fetchAvailability(o,r.row,r.col,i)==="available")break}catch{}if(o--,n++,r=this.identifyPixelLocation(a,n,i.datumTransformation),r===null)return null}return o===-1||r==null?null:n}async _fetchRasterInfo(e){const i=this.sourceJSON;if(this.tileType==="Map"){const a=i.fullExtent||i.extent,l=Math.ceil((a.xmax-a.xmin)/i.pixelSizeX-.1),c=Math.ceil((a.ymax-a.ymin)/i.pixelSizeY-.1),u=Ee.fromJSON(i.spatialReference||a.spatialReference),h=new fe({x:i.pixelSizeX,y:i.pixelSizeY,spatialReference:u});return new Ap({width:l,height:c,bandCount:3,extent:Re.fromJSON(a),spatialReference:u,pixelSize:h,pixelType:"u8",statistics:null,keyProperties:{DataType:"processed"}})}const{signal:r}=e,n=c7e(this.url,this.sourceJSON,{signal:r,query:this.ioConfig.customFetchParameters}),s=i.hasMultidimensions?this.request(`${this.url}/slices`,{query:{f:"json"},signal:r}).then(a=>a.data&&a.data.slices).catch(()=>null):null,o=await Promise.all([n,s]);return this._slices=o[1],o[0]}_fixScaleInServiceInfo(){const{sourceJSON:e}=this;e.minScale&&e.minScale<0&&(e.minScale=0),e.maxScale&&e.maxScale<0&&(e.maxScale=0)}_fixGCSShift(e){const{extent:i,spatialReference:r}=e;i.xmin>-1&&i.xmax>181&&(r!=null&&r.wkid)&&r.isGeographic&&(e.nativeExtent=e.extent,e.transform=new Jfe,e.extent=e.transform.forwardTransform(i))}_computeMinMaxLOD(e,i){const{pixelSize:r}=e,n=.5/e.width*r.x,{lods:s}=i,o=i.lodAt(Math.max.apply(null,s.map(m=>m.level))),a=i.lodAt(Math.min.apply(null,s.map(m=>m.level))),{tileType:l}=this;if(l==="Map")return this._levelOffset=s[0].level,[o,a];if(l==="Raster")return[s.find(m=>m.resolution===r.x)??o,a];const{minScale:c,maxScale:u}=this.sourceJSON;let h=o;u>0&&(h=s.find(m=>Math.abs(m.scale-u)<n),h||(h=s.filter(m=>m.scale>u).sort((m,g)=>m.scale>g.scale?1:-1)[0]??o));let f=a;return c>0&&(f=s.find(m=>Math.abs(m.scale-c)<n)??a,this._levelOffset=f.level-a.level),[h,f]}};function u7e(t,e){if(!t)return null;const{minScale:i,maxScale:r,minLOD:n,maxLOD:s}=e;if(n!=null&&s!=null)return Od.fromJSON({...t,lods:t.lods.filter(({level:o})=>o!=null&&o>=n&&o<=s)});if(i!==0&&r!==0){const o=c=>Math.round(1e4*c)/1e4,a=i?o(i):1/0,l=r?o(r):-1/0;return Od.fromJSON({...t,lods:t.lods.filter(c=>{const u=o(c.scale);return u<=a&&u>=l})})}return Od.fromJSON(t)}d([p({type:String,json:{write:!0}})],m2.prototype,"datasetFormat",void 0),d([p()],m2.prototype,"tileType",void 0),m2=d([A("esri.layers.support.rasterDatasets.ImageServerRaster")],m2);const d7e=m2,nd=new Map;nd.set("Int8","s8"),nd.set("UInt8","u8"),nd.set("Int16","s16"),nd.set("UInt16","u16"),nd.set("Int32","s32"),nd.set("UInt32","u32"),nd.set("Float32","f32"),nd.set("Float64","f32"),nd.set("Double64","f32");const Dm=new Map;Dm.set("none",{blobExtension:".til",isOneSegment:!0,decoderFormat:"bip"}),Dm.set("lerc",{blobExtension:".lrc",isOneSegment:!1,decoderFormat:"lerc"}),Dm.set("deflate",{blobExtension:".pzp",isOneSegment:!0,decoderFormat:"deflate"}),Dm.set("jpeg",{blobExtension:".pjg",isOneSegment:!0,decoderFormat:"jpg"});let Lb=class extends Kv{constructor(){super(...arguments),this._files=null,this._storageIndex=null,this.datasetFormat="MRF"}async open(e){var v;await this.init(),this.datasetName=this.url.slice(this.url.lastIndexOf("/")+1);const i=e?e.signal:null,r=await this.request(this.url,{responseType:"xml",signal:i}),{rasterInfo:n,files:s}=this._parseHeader(r.data);if(((v=this.ioConfig.skipExtensions)==null?void 0:v.indexOf("aux.xml"))===-1){const b=await this._fetchAuxiliaryData(e);b!=null&&(n.statistics=b.statistics??n.statistics,n.histograms=b.histograms,b.histograms&&n.statistics==null&&(n.statistics=iG(b.histograms)))}this._set("rasterInfo",n),this._files=s;const o=await this.request(s.index,{responseType:"array-buffer",signal:i});this._storageIndex=this._parseIndex(o.data);const{blockWidth:a,blockHeight:l}=this.rasterInfo.storageInfo,c=this.rasterInfo.storageInfo.pyramidScalingFactor,{width:u,height:h}=this.rasterInfo,f=[],m=this._getBandSegmentCount();let g=0,y=-1;for(;g<this._storageIndex.length;){y++;const b=Math.ceil(u/a/c**y)-1,w=Math.ceil(h/l/c**y)-1;g+=(b+1)*(w+1)*m*4,f.push({maxRow:w,maxCol:b,minCol:0,minRow:0})}this.rasterInfo.storageInfo.blockBoundary=f,y>0&&(this.rasterInfo.storageInfo.firstPyramidLevel=1,this.rasterInfo.storageInfo.maximumPyramidLevel=y),this.updateTileInfo()}async fetchRawTile(e,i,r,n={}){const{blockWidth:s,blockHeight:o,blockBoundary:a}=this.rasterInfo.storageInfo,l=a[e];if(!l||l.maxRow<i||l.maxCol<r||l.minRow>i||l.minCol>r)return null;const{bandCount:c,pixelType:u}=this.rasterInfo,{ranges:h,actualTileWidth:f,actualTileHeight:m}=this._getTileLocation(e,i,r);if(!h||h.length===0)return null;if(h[0].from===0&&h[0].to===0){const k=new Uint8Array(s*o);return new de({width:s,height:o,pixels:null,mask:k,validPixelCount:0})}const{bandIds:g}=this.ioConfig,y=this._getBandSegmentCount(),v=[];let b=0;for(b=0;b<y;b++)g&&!g.includes(b)||v.push(this.request(this._files.data,{range:{from:h[b].from,to:h[b].to},responseType:"array-buffer",signal:n.signal}));const w=await Promise.all(v),x=w.map(k=>k.data.byteLength).reduce((k,L)=>k+L),S=new Uint8Array(x);let I=0;for(b=0;b<y;b++)S.set(new Uint8Array(w[b].data),I),I+=w[b].data.byteLength;const T=Dm.get(this.rasterInfo.storageInfo.compression).decoderFormat,C=await this.decodePixelBlock(S.buffer,{width:s,height:o,format:T,planes:(g==null?void 0:g.length)||c,pixelType:u});if(C==null)return null;let{noDataValue:E}=this.rasterInfo;if(E!=null&&T!=="lerc"&&!C.mask&&(E=E[0],E!=null)){const k=C.width*C.height,L=new Uint8Array(k);if(Math.abs(E)>1e24)for(b=0;b<k;b++)Math.abs((C.pixels[0][b]-E)/E)>1e-6&&(L[b]=1);else for(b=0;b<k;b++)C.pixels[0][b]!==E&&(L[b]=1);C.mask=L}let $=0,P=0;if(f!==s||m!==o){let k=C.mask;if(k)for(b=0;b<o;b++)if(P=b*s,b<m)for($=f;$<s;$++)k[P+$]=0;else for($=0;$<s;$++)k[P+$]=0;else for(k=new Uint8Array(s*o),C.mask=k,b=0;b<m;b++)for(P=b*s,$=0;$<f;$++)k[P+$]=1}return C}_parseIndex(e){if(e.byteLength%16>0)throw new Error("invalid array buffer must be multiples of 16");let i,r,n,s,o,a;if(XL){for(r=new Uint8Array(e),s=new ArrayBuffer(e.byteLength),n=new Uint8Array(s),o=0;o<e.byteLength/4;o++)for(a=0;a<4;a++)n[4*o+a]=r[4*o+3-a];i=new Uint32Array(s)}else i=new Uint32Array(e);return i}_getBandSegmentCount(){return Dm.get(this.rasterInfo.storageInfo.compression).isOneSegment?1:this.rasterInfo.bandCount}_getTileLocation(e,i,r){const{blockWidth:n,blockHeight:s,pyramidScalingFactor:o}=this.rasterInfo.storageInfo,{width:a,height:l}=this.rasterInfo,c=this._getBandSegmentCount();let u,h,f,m=0,g=0;for(f=0;f<e;f++)g=o**f,u=Math.ceil(a/n/g),h=Math.ceil(l/s/g),m+=u*h;g=o**e,u=Math.ceil(a/n/g),h=Math.ceil(l/s/g),m+=i*u+r,m*=4*c;const y=this._storageIndex.subarray(m,m+4*c);let v=0,b=0;const w=[];for(let x=0;x<c;x++)v=y[4*x]*2**32+y[4*x+1],b=v+y[4*x+2]*2**32+y[4*x+3],w.push({from:v,to:b});return{ranges:w,actualTileWidth:r<u-1?n:Math.ceil(a/g)-n*(u-1),actualTileHeight:i<h-1?s:Math.ceil(l/g)-s*(h-1)}}_parseHeader(e){const i=Hl(e,"MRF_META/Raster");if(!i)throw new N("mrf:open","not a valid MRF format");const r=Hl(i,"Size"),n=parseInt(r.getAttribute("x"),10),s=parseInt(r.getAttribute("y"),10),o=parseInt(r.getAttribute("c"),10),a=(Sd(i,"Compression")||"none").toLowerCase();if(!Dm.has(a))throw new N("mrf:open","currently does not support compression "+a);const l=Sd(i,"DataType")||"UInt8",c=nd.get(l);if(c==null)throw new N("mrf:open","currently does not support pixel type "+l);const u=Hl(i,"PageSize"),h=parseInt(u.getAttribute("x"),10),f=parseInt(u.getAttribute("y"),10),m=Hl(i,"DataValues");let g,y;if(m&&(y=m.getAttribute("NoData"),y!=null&&(g=y.trim().split(" ").map(L=>parseFloat(L)))),Hl(e,"MRF_META/CachedSource"))throw new N("mrf:open","currently does not support MRF referencing other data files");const v=Hl(e,"MRF_META/GeoTags"),b=Hl(v,"BoundingBox");let w,x=!1;if(b!=null){const L=parseFloat(b.getAttribute("minx")),F=parseFloat(b.getAttribute("miny")),V=parseFloat(b.getAttribute("maxx")),z=parseFloat(b.getAttribute("maxy")),G=Sd(v,"Projection")||"";let H=Ee.WGS84;if(G!=="LOCAL_CS[]")if(G.toLowerCase().startsWith("epsg:")){const Z=Number(G.slice(5));isNaN(Z)||Z===0||(H=new Ee({wkid:Z}))}else H=nR(G)??Ee.WGS84;else x=!0,H=new Ee({wkid:3857});w=new Re(L,F,V,z),w.spatialReference=H}else x=!0,w=new Re({xmin:-.5,ymin:.5-s,xmax:n-.5,ymax:.5,spatialReference:new Ee({wkid:3857})});const S=Hl(e,"MRF_META/Rsets"),I=parseInt(S&&S.getAttribute("scale")||"2",10),T=w.spatialReference,C=new nx({origin:new fe({x:w.xmin,y:w.ymax,spatialReference:T}),blockWidth:h,blockHeight:f,pyramidBlockWidth:h,pyramidBlockHeight:f,compression:a,pyramidScalingFactor:I}),E=new fe({x:w.width/n,y:w.height/s,spatialReference:T}),$=new Ap({width:n,height:s,extent:w,isPseudoSpatialReference:x,spatialReference:T,bandCount:o,pixelType:c,pixelSize:E,noDataValue:g,storageInfo:C}),P=Sd(e,"datafile"),k=Sd(e,"IndexFile");return{rasterInfo:$,files:{mrf:this.url,index:k||this.url.replace(".mrf",".idx"),data:P||this.url.replace(".mrf",Dm.get(a).blobExtension)}}}async _fetchAuxiliaryData(e){try{const{data:i}=await this.request(this.url+".aux.xml",{responseType:"xml",signal:e==null?void 0:e.signal});return lG(i)}catch{return null}}};d([p()],Lb.prototype,"_files",void 0),d([p()],Lb.prototype,"_storageIndex",void 0),d([p({type:String,json:{write:!0}})],Lb.prototype,"datasetFormat",void 0),Lb=d([A("esri.layers.support.rasterIO.MRFRaster")],Lb);const h7e=Lb,D5=(t,e)=>{var i;return(i=t.get(e))==null?void 0:i.values},Vx=(t,e)=>{var i,r;return(r=(i=t.get(e))==null?void 0:i.values)==null?void 0:r[0]};let r0=class extends Kv{constructor(){super(...arguments),this._files=null,this._headerInfo=null,this._bufferSize=1048576,this.datasetFormat="TIFF"}async open(e){var y,v,b,w;await this.init();const i=e?e.signal:null,{data:r}=await this.request(this.url,{range:{from:0,to:this._bufferSize},responseType:"array-buffer",signal:i});if(!r)throw new N("tiffraster:open","failed to open url "+this.url);this.datasetName=this.url.slice(this.url.lastIndexOf("/")+1,this.url.lastIndexOf("."));const{littleEndian:n,firstIFDPos:s,isBigTiff:o}=Tfe(r),a=[];await this._readIFDs(a,r,n,s,0,o?8:4,i);const{imageInfo:l,rasterInfo:c}=this._parseIFDs(a),u=Y9(a),h=K9(a);if(this._headerInfo={littleEndian:n,isBigTiff:o,ifds:a,pyramidIFDs:u,maskIFDs:h,...l},this._set("rasterInfo",c),!l.isSupported)throw new N("tiffraster:open","this tiff is not supported: "+l.message);if(!l.tileWidth)throw new N("tiffraster:open","none-tiled tiff is not optimized for access, convert to COG and retry.");const f=(v=(y=a[0].get("PREDICTOR"))==null?void 0:y.values)==null?void 0:v[0];if(((w=(b=a[0].get("SAMPLEFORMAT"))==null?void 0:b.values)==null?void 0:w[0])===3&&f===2)throw new N("tiffraster:open","unsupported horizontal difference encoding. Predictor=3 is supported for floatting point data");const{skipExtensions:g=[]}=this.ioConfig;if(!g.includes("aux.xml")){const x=await this._fetchAuxiliaryMetaData(e);x!=null&&this._processPAMInfo(x,c)}g.includes("vat.dbf")||c.bandCount!==1||c.pixelType!=="u8"||(c.attributeTable=await this._fetchAuxiliaryTable(e),c.attributeTable!=null&&(c.keyProperties.DataType="thematic")),this.updateTileInfo()}async fetchRawTile(e,i,r,n={}){var o;if(!((o=this._headerInfo)!=null&&o.isSupported)||this.isBlockOutside(e,i,r))return null;const s=await this._fetchRawTiffTile(e,i,r,!1,n);if(s!=null&&this._headerInfo.hasMaskBand){const a=await this._fetchRawTiffTile(e,i,r,!0,n);a!=null&&a.pixels[0]instanceof Uint8Array&&(s.mask=a.pixels[0])}return s}_parseIFDs(e){var F,V;const i=eR(e),{width:r,height:n,tileWidth:s,tileHeight:o,planes:a,pixelType:l,compression:c,firstPyramidLevel:u,maximumPyramidLevel:h,pyramidBlockWidth:f,pyramidBlockHeight:m,tileBoundary:g,affine:y,metadata:v}=i,b=((F=i.extent.spatialReference)==null?void 0:F.wkt)||((V=i.extent.spatialReference)==null?void 0:V.wkid);let w=nR(b),x=!!i.isPseudoGeographic;w==null&&(x=!0,w=new Ee({wkid:3857}));const S=new Re({...i.extent,spatialReference:w}),I=new fe(S?{x:S.xmin,y:S.ymax,spatialReference:w}:{x:0,y:0}),T=new nx({blockWidth:s,blockHeight:o,pyramidBlockWidth:f,pyramidBlockHeight:m,compression:c,origin:I,firstPyramidLevel:u,maximumPyramidLevel:h,blockBoundary:g}),C=new fe({x:(S.xmax-S.xmin)/r,y:(S.ymax-S.ymin)/n,spatialReference:w}),E=v?{BandProperties:v.bandProperties,DataType:v.dataType}:{};let $=null;const P=Vx(e[0],"PHOTOMETRICINTERPRETATION"),k=D5(e[0],"COLORMAP");if(P<=3&&(k==null?void 0:k.length)>3&&k.length%3==0){$=[];const z=k.length/3;for(let G=0;G<z;G++)$.push([G,k[G]>>>8,k[G+z]>>>8,k[G+2*z]>>>8])}const L=new Ap({width:r,height:n,bandCount:a,pixelType:l,pixelSize:C,storageInfo:T,spatialReference:w,isPseudoSpatialReference:x,keyProperties:E,extent:S,colormap:$,statistics:v?v.statistics:null});return y!=null&&y.length&&(L.nativeExtent=new Re({xmin:-.5,ymin:.5-n,xmax:r-.5,ymax:.5,spatialReference:w}),L.transform=new rR({polynomialOrder:1,forwardCoefficients:[y[2]+y[0]/2,y[5]-y[3]/2,y[0],y[3],-y[1],-y[4]]}),L.extent=L.transform.forwardTransform(L.nativeExtent),L.pixelSize=new fe({x:(S.xmax-S.xmin)/r,y:(S.ymax-S.ymin)/n,spatialReference:w}),T.origin.x=-.5,T.origin.y=.5),{imageInfo:i,rasterInfo:L}}_processPAMInfo(e,i){if(i.statistics=e.statistics??i.statistics,i.histograms=e.histograms,e.histograms&&i.statistics==null&&(i.statistics=iG(e.histograms)),e.transform&&i.transform==null){i.transform=e.transform,i.nativeExtent=i.extent;const r=i.transform.forwardTransform(i.nativeExtent);i.pixelSize=new fe({x:(r.xmax-r.xmin)/i.width,y:(r.ymax-r.ymin)/i.height,spatialReference:i.spatialReference}),i.extent=r}i.isPseudoSpatialReference&&e.spatialReference&&(i.spatialReference=e.spatialReference,i.extent.spatialReference=i.nativeExtent.spatialReference=i.storageInfo.origin.spatialReference=i.spatialReference)}async _readIFDs(e,i,r,n,s,o=4,a){if(!n)return null;(n>=i.byteLength||n<0)&&(i=(await this.request(this.url,{range:{from:n+s,to:n+s+this._bufferSize},responseType:"array-buffer",signal:a})).data,s=n+s,n=0);const l=await this._readIFD(i,r,n,s,Md.TIFF_TAGS,o,a);if(e.push(l.ifd),!l.nextIFD)return null;await this._readIFDs(e,i,r,l.nextIFD-s,s,o,a)}async _readIFD(e,i,r,n,s=Md.TIFF_TAGS,o=4,a){var c,u;if(!e)return null;const l=Cfe(e,i,r,n,s,o);if(l.success){const h=[];if((c=l.ifd)==null||c.forEach(f=>{f.values||h.push(f)}),h.length>0){const f=h.map(g=>g.offlineOffsetSize).filter(Dt),m=Math.min.apply(null,f.map(g=>g[0]));if(Math.min.apply(null,f.map(g=>g[0]+g[1]))-m<=this._bufferSize){const{data:g}=await this.request(this.url,{range:{from:m,to:m+this._bufferSize},responseType:"array-buffer",signal:a});e=g,n=m,h.forEach(y=>Ife(e,i,y,n))}}if((u=l.ifd)!=null&&u.has("GEOKEYDIRECTORY")){const f=l.ifd.get("GEOKEYDIRECTORY"),m=f==null?void 0:f.values;if(m&&m.length>4){const g=m[0]+"."+m[1]+"."+m[2],y=await this._readIFD(e,i,f.valueOffset+6-n,n,Md.GEO_KEYS,2,a);f.data=y.ifd,f.data&&f.data.set("GEOTIFFVersion",{id:0,type:2,valueCount:1,valueOffset:null,values:[g]})}}return l}if(l.requiredBufferSize&&l.requiredBufferSize!==e.byteLength)return(e=(await this.request(this.url,{range:{from:n,to:n+l.requiredBufferSize+4},responseType:"array-buffer",signal:a})).data).byteLength<l.requiredBufferSize?null:this._readIFD(e,i,0,n,Md.TIFF_TAGS,4,a)}async _fetchRawTiffTile(e,i,r,n,s={}){const o=this._getTileLocation(e,i,r,n);if(!o)return null;const{ranges:a,actualTileWidth:l,actualTileHeight:c,ifd:u}=o,h=a.map(C=>this.request(this.url,{range:C,responseType:"array-buffer",signal:s.signal})),f=await Promise.all(h),m=f.map(C=>C.data.byteLength).reduce((C,E)=>C+E),g=f.length===1?f[0].data:new ArrayBuffer(m),y=[0],v=[0];if(f.length>1){const C=new Uint8Array(g);for(let E=0,$=0;E<f.length;E++){const P=f[E].data;C.set(new Uint8Array(P),$),y[E]=$,$+=P.byteLength,v[E]=P.byteLength}}const{blockWidth:b,blockHeight:w}=this.getBlockWidthHeight(e),x=await this.decodePixelBlock(g,{format:"tiff",customOptions:{headerInfo:this._headerInfo,ifd:u,offsets:y,sizes:v},width:b,height:w,planes:null,pixelType:null});if(x==null)return null;let S,I,T;if(l!==b||c!==w){let C=x.mask;if(C)for(S=0;S<w;S++)if(T=S*b,S<c)for(I=l;I<b;I++)C[T+I]=0;else for(I=0;I<b;I++)C[T+I]=0;else for(C=new Uint8Array(b*w),x.mask=C,S=0;S<c;S++)for(T=S*b,I=0;I<l;I++)C[T+I]=1}return x}_getTileLocation(e,i,r,n=!1){const{firstPyramidLevel:s,blockBoundary:o}=this.rasterInfo.storageInfo,a=e===0?0:e-(s-1),{_headerInfo:l}=this;if(!l)return null;const c=n?l.maskIFDs[a]:a===0?l==null?void 0:l.ifds[0]:l==null?void 0:l.pyramidIFDs[a-1];if(!c)return null;const u=FC(c,l),h=D5(c,"TILEOFFSETS");if(h===void 0)return null;const f=D5(c,"TILEBYTECOUNTS"),{minRow:m,minCol:g,maxRow:y,maxCol:v}=o[a];if(i>y||r>v||i<m||r<g)return null;const b=Vx(c,"IMAGEWIDTH"),w=Vx(c,"IMAGELENGTH"),x=Vx(c,"TILEWIDTH"),S=Vx(c,"TILELENGTH"),I=[];if(u){const{bandCount:T}=this.rasterInfo;for(let C=0;C<T;C++){const E=C*(y+1)*(v+1)+i*(v+1)+r;I[C]={from:h[E],to:h[E]+f[E]-1}}}else{const T=i*(v+1)+r;I.push({from:h[T],to:h[T]+f[T]-1})}for(let T=0;T<I.length;T++)if(I[T].from==null||!I[T].to)return null;return{ranges:I,ifd:c,actualTileWidth:r===v&&b%x||x,actualTileHeight:i===y&&w%S||S}}async _fetchAuxiliaryMetaData(e){try{const{data:i}=await this.request(this.url+".aux.xml",{responseType:"xml",signal:e==null?void 0:e.signal});return lG(i)}catch{return null}}async _fetchAuxiliaryTable(e){try{const{data:i}=await this.request(this.url+".vat.dbf",{responseType:"array-buffer",signal:e==null?void 0:e.signal}),r=Wfe.parse(i);return r!=null&&r.recordSet?Mg.fromJSON(r.recordSet):null}catch{return null}}};d([p()],r0.prototype,"_files",void 0),d([p()],r0.prototype,"_headerInfo",void 0),d([p()],r0.prototype,"_bufferSize",void 0),d([p({type:String,json:{write:!0}})],r0.prototype,"datasetFormat",void 0),r0=d([A("esri.layers.support.rasterDatasets.TIFFRaster")],r0);const p7e=r0,fa=new Map;fa.set("CRF",{desc:"Cloud Raster Format",constructor:i7e}),fa.set("MRF",{desc:"Meta Raster Format",constructor:h7e}),fa.set("TIFF",{desc:"GeoTIFF",constructor:p7e}),fa.set("RasterTileServer",{desc:"Raster Tile Server",constructor:d7e}),fa.set("JPG",{desc:"JPG Raster Format",constructor:fM}),fa.set("PNG",{desc:"PNG Raster Format",constructor:fM}),fa.set("GIF",{desc:"GIF Raster Format",constructor:fM}),fa.set("BMP",{desc:"BMP Raster Format",constructor:fM});let f7e=class{static get supportedFormats(){const e=new Set;return fa.forEach((i,r)=>e.add(r)),e}static async open(e){const{url:i,ioConfig:r,sourceJSON:n}=e;let s=e.datasetFormat;s==null&&i.lastIndexOf(".")&&(s=i.slice(i.lastIndexOf(".")+1).toUpperCase()),s==="OVR"||s==="TIF"?s="TIFF":s!=="JPG"&&s!=="JPEG"&&s!=="JFIF"||(s="JPG"),i.toLowerCase().includes("/imageserver")&&!i.toLowerCase().includes("/wcsserver")&&(s="RasterTileServer");const o={url:i,sourceJSON:n,datasetFormat:s,ioConfig:r??{bandIds:null,sampling:null}};let a,l;if(s&&this.supportedFormats.has(s)){if(s==="CRF"&&!(r!=null&&r.enableCRF))throw new N("rasterfactory:open",`cannot open raster: ${i}`);return a=fa.get(s).constructor,l=new a(o),await l.open({signal:e.signal}),l}if(s)throw new N("rasterfactory:open","not a supported format "+s);const c=Array.from(fa.keys());let u=0;const h=()=>(s=c[u++],s&&(s!=="CRF"||r!=null&&r.enableCRF)?(a=fa.get(s).constructor,l=new a(o),l.open({signal:e.signal}).then(()=>l).catch(()=>h())):null);return h()}static register(e,i,r){fa.has(e.toUpperCase())||fa.set(e.toUpperCase(),{desc:i,constructor:r})}},Un=class extends BL(WL(M9($9(b9(ZGe(k9(Cpe(A9(FL(lC)))))))))){constructor(...e){super(...e),this._primaryRasters=[],this.bandIds=null,this.interpolation=null,this.legendEnabled=!0,this.isReference=null,this.listMode="show",this.sourceJSON=null,this.version=null,this.type="imagery-tile",this.operationalLayerType="ArcGISTiledImageServiceLayer",this.popupEnabled=!0,this.popupTemplate=null,this.fields=null}normalizeCtorArgs(e,i){return typeof e=="string"?{url:e,...i}:e}load(e){const i=e!=null?e.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Image Service"]},e).catch(Lo).then(()=>this._openRaster(i))),Promise.resolve(this)}get defaultPopupTemplate(){return this.createPopupTemplate()}get rasterFields(){var l;const e=[new hu({name:"Raster.ServicePixelValue",alias:"Pixel Value",domain:null,editable:!1,length:50,type:"string"}),new hu({name:"Raster.ServicePixelValue.Raw",alias:"Raw Pixel Value",domain:null,editable:!1,length:50,type:"string"})],{rasterInfo:i}=this,r=i==null?void 0:i.attributeTable,n=r!=null?r.fields:null,s="Raster.";if(n){const c=n.filter(u=>u.type!=="oid"&&u.name.toLowerCase()!=="value").map(u=>{const h=u.clone();return h.name=s+u.name,h});e.push(...c)}const o=i==null?void 0:i.dataType,a=i==null?void 0:i.multidimensionalInfo;if((o==="vector-magdir"||o==="vector-uv")&&a!=null){const c=(l=a.variables[0].unit)==null?void 0:l.trim(),u="Magnitude"+(c?` (${c})`:"");e.push(new hu({name:"Raster.Magnitude",alias:u,domain:null,editable:!1,type:"double"})),e.push(new hu({name:"Raster.Direction",alias:"Direction (°)",domain:null,editable:!1,type:"double"}))}return e}createPopupTemplate(e){const{rasterFields:i}=this,r=new Set(i.map(({name:n})=>n).filter(n=>n.toLowerCase()!=="raster.servicepixelvalue.raw"));return O9({fields:i,title:this.title},{...e,visibleFieldNames:r})}async generateRasterInfo(e,i){var r;if(!(e=jv(Rv,e)))return this.rasterInfo;try{const n={raster:this._primaryRasters[0]};this._primaryRasters.length>1&&this._primaryRasters.forEach(a=>n[a.url]=a);const s=uj(((r=e.functionDefinition)==null?void 0:r.toJSON())??e.toJSON(),n),o=new Uz({rasterFunction:s});return await o.open(i),o.rasterInfo}catch(n){throw n instanceof N?n:new N("imagery-tile-layer","the given raster function is not supported")}}write(e,i){const r=this._primaryRasters[0]??this.raster;if(this.loaded?r.datasetFormat==="RasterTileServer"&&(r.tileType==="Raster"||r.tileType==="Map"):this.url&&/\/ImageServer(\/|\/?$)/i.test(this.url))return super.write(e,i);if(i&&i.messages){const n=`${i.origin}/${i.layerContainerType||"operational-layers"}`;i.messages.push(new N("layer:unsupported",`Layers (${this.title}, ${this.id}) of type '${this.declaredClass}' are not supported in the context of '${n}'`,{layer:this}))}return null}async _openRaster(e){var n;let i=!1;if(this.raster)this.raster.rasterInfo||await this.raster.open(),this.raster.datasetFormat==="Function"?(i=!0,this._primaryRasters=this.raster.primaryRasters.rasters):this._primaryRasters=[this.raster],this.url=this.raster.url;else{const{rasterFunction:s}=this,o=[this.url];s&&Nfe(s.toJSON(),o);const a=await Promise.all(o.map(c=>f7e.open({url:c,sourceJSON:this.sourceJSON,ioConfig:{sampling:"closest",...this.ioConfig,customFetchParameters:this.customParameters},signal:e}))),l=a.findIndex(c=>c==null);if(l>-1)throw new N("imagery-tile-layer:open",`cannot open raster: ${o[l]}`);if(this._primaryRasters=a,s){const c={raster:this._primaryRasters[0]};this._primaryRasters.length>1&&this._primaryRasters.forEach(f=>c[f.url]=f);const u=uj(((n=s.functionDefinition)==null?void 0:n.toJSON())??s.toJSON(),c),h=new Uz({rasterFunction:u});try{await h.open(),this.raster=h}catch(f){const m=ie.getLogger(this);f instanceof N&&m.error("imagery-tile-layer:open",f.message),m.warn("imagery-tile-layer:open","the raster function cannot be applied and is removed"),this._set("rasterFunction",null),this.raster=a[0]}}else this.raster=a[0]}const r=this.raster.rasterInfo;if(!r)throw new N("imagery-tile-layer:load","cannot load resources on "+this.url);if(this._set("rasterInfo",i?r:this._primaryRasters[0].rasterInfo),this._set("spatialReference",r.spatialReference),this.sourceJSON=this.sourceJSON||this.raster.sourceJSON,this.sourceJSON!=null){const s=this.raster.tileType==="Map"&&this.sourceJSON.minLOD!=null&&this.sourceJSON.maxLOD!=null?this.sourceJSON:{...this.sourceJSON,minScale:0,maxScale:0};this.read(s,{origin:"service"})}else this.read({tileInfo:this.rasterInfo.storageInfo.tileInfo.toJSON()},{origin:"service"});this.title||(this.title=this.raster.datasetName),this.raster.tileType==="Map"&&(this.popupEnabled=!1),this._configDefaultSettings(),this.addHandles(J(()=>this.customParameters,s=>{this.raster&&(this.raster.ioConfig.customFetchParameters=s)}))}};d([p()],Un.prototype,"_primaryRasters",void 0),d([p({type:[wt],json:{write:{overridePolicy(){var t;return{enabled:!this.loaded||this.raster.tileType==="Raster"||((t=this.bandIds)==null?void 0:t.join(","))!=="0,1,2"}}}}})],Un.prototype,"bandIds",void 0),d([p({json:{write:{overridePolicy(){return{enabled:!this.loaded||this.raster.tileType==="Raster"||this.interpolation!=="bilinear"}}}}}),xe(x6e)],Un.prototype,"interpolation",void 0),d([p(x9)],Un.prototype,"legendEnabled",void 0),d([p({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],Un.prototype,"isReference",void 0),d([p({type:["show","hide"]})],Un.prototype,"listMode",void 0),d([p({json:{read:!0,write:!0}})],Un.prototype,"blendMode",void 0),d([p()],Un.prototype,"sourceJSON",void 0),d([p({readOnly:!0,json:{origins:{service:{read:{source:"currentVersion"}}}}})],Un.prototype,"version",void 0),d([p({readOnly:!0,json:{read:!1}})],Un.prototype,"type",void 0),d([p({type:["ArcGISTiledImageServiceLayer"]})],Un.prototype,"operationalLayerType",void 0),d([p({type:Boolean,value:!0,json:{read:{source:"disablePopup",reader:(t,e)=>!e.disablePopup},write:{target:"disablePopup",overridePolicy(){return{enabled:!this.loaded||this.raster.tileType==="Raster"}},writer(t,e,i){e[i]=!t}}}})],Un.prototype,"popupEnabled",void 0),d([p({type:Mp,json:{read:{source:"popupInfo"},write:{target:"popupInfo",overridePolicy(){return{enabled:!this.loaded||this.raster.tileType==="Raster"}}}}})],Un.prototype,"popupTemplate",void 0),d([p({readOnly:!0})],Un.prototype,"defaultPopupTemplate",null),d([p({readOnly:!0,type:[hu]})],Un.prototype,"fields",void 0),d([p({readOnly:!0,type:[hu]})],Un.prototype,"rasterFields",null),Un=d([A("esri.layers.ImageryTileLayer")],Un);const Kfe=Un,U1t=Object.freeze(Object.defineProperty({__proto__:null,default:Kfe},Symbol.toStringTag,{value:"Module"}));let Al=class extends he{constructor(e){super(e),this._basemapCache={},this._loadingProjectionEngine=!1,this.nextBasemap=k$("hybrid",this._basemapCache),this.view=null}initialize(){J(()=>this.nextBasemap,e=>{e&&!e.loaded&&e.load().catch(()=>{})},Le)}destroy(){this.view=null,Yse(this._basemapCache),this._basemapCache=null}get _nextBasemapSpatialReferenceTask(){return aCe(this.view,this.nextBasemap)}get _viewSpatialReferenceLocked(){const{view:e}=this;return!e||!("spatialReferenceLocked"in e)||e.spatialReferenceLocked}get activeBasemap(){var e,i;return k$(((i=(e=this.view)==null?void 0:e.map)==null?void 0:i.basemap)??"topo-vector",this._basemapCache)}castNextBasemap(e){return k$(e,this._basemapCache)}get state(){const{view:e}=this;if(!(e!=null&&e.ready)||this._nextBasemapSpatialReferenceTask.updating)return"disabled";const{spatialReference:i}=this._nextBasemapSpatialReferenceTask;return this._viewSpatialReferenceLocked&&i!=null&&!e.spatialReference.equals(i)?"incompatible-next-basemap":this._loadingProjectionEngine?"loading":"ready"}async toggle(){const{activeBasemap:e,nextBasemap:i,state:r,view:n}=this;if(!n||r==="disabled"||r==="incompatible-next-basemap")return;const s=this._viewSpatialReferenceLocked;if(!s){if(await _r(()=>!this._nextBasemapSpatialReferenceTask.updating),i!==this.nextBasemap||e!==this.activeBasemap)return;const{spatialReference:o}=this._nextBasemapSpatialReferenceTask;if(o==null||Pr(n.spatialReference,o)||pc()||lc(n.spatialReference,o)||(this._loadingProjectionEngine=!0,await Eu(),this._loadingProjectionEngine=!1),i!==this.nextBasemap||e!==this.activeBasemap)return}n.map.basemap=i,s||this._nextBasemapSpatialReferenceTask.spatialReference==null||Pr(n.spatialReference,this._nextBasemapSpatialReferenceTask.spatialReference)||(n.spatialReference=this._nextBasemapSpatialReferenceTask.spatialReference),this.nextBasemap=e}static getThumbnailUrl(e){if(!e)return null;const{thumbnailUrl:i}=e;if(i)return i;const r=oCe(e);if(r)return Qw[r].thumbnailUrl;const n=e.baseLayers.find(s=>!!JD(s)().get("portalItem.thumbnailUrl"));return n?JD(n)().get("portalItem.thumbnailUrl"):null}};d([p()],Al.prototype,"_loadingProjectionEngine",void 0),d([p({readOnly:!0})],Al.prototype,"_nextBasemapSpatialReferenceTask",null),d([p({readOnly:!0})],Al.prototype,"_viewSpatialReferenceLocked",null),d([p({readOnly:!0})],Al.prototype,"activeBasemap",null),d([p()],Al.prototype,"nextBasemap",void 0),d([tt("nextBasemap")],Al.prototype,"castNextBasemap",null),d([p({readOnly:!0})],Al.prototype,"state",null),d([p()],Al.prototype,"view",void 0),d([p()],Al.prototype,"toggle",null),Al=d([A("esri.widgets.BasemapToggle.BasemapToggleViewModel")],Al);const cG=Al,gl={base:"esri-basemap-toggle esri-widget",secondaryBasemapImage:"esri-basemap-toggle__image--secondary",container:"esri-basemap-thumbnail esri-basemap-toggle__container",image:"esri-basemap-thumbnail__image esri-basemap-toggle__image",imageLoading:"esri-basemap-toggle__image--loading",overlay:"esri-basemap-thumbnail__overlay esri-basemap-toggle__image-overlay",title:"esri-basemap-thumbnail__title esri-basemap-toggle__title",overlayScrim:"esri-basemap-thumbnail__overlay-scrim",disabled:"esri-disabled",loaderAnimation:"esri-widget__loader-animation"};function pK(t){const e=cG.getThumbnailUrl(t);return e?{backgroundImage:"url("+e+")"}:{backgroundImage:""}}const fK={title:!1};let kl=class extends di{constructor(e,i){super(e,i),this.messages=null,this.viewModel=new cG,this.visibleElements={...fK}}loadDependencies(){return Zd({icon:()=>W(()=>import("./calcite-icon-dc1254b1.js"),["./calcite-icon-dc1254b1.js","./icon-55c3c703.js","./observers-c8819292.js"],import.meta.url),scrim:()=>W(()=>import("./calcite-scrim-97dac5b5.js"),["./calcite-scrim-97dac5b5.js","./scrim-61cfb0a8.js","./t9n-5488ec48.js","./key-a512d618.js","./observers-c8819292.js","./loader-ea07f4e7.js","./guid-40d04074.js"],import.meta.url)})}get activeBasemap(){return this.viewModel.activeBasemap}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get nextBasemap(){return this.viewModel.nextBasemap}set nextBasemap(e){this.viewModel.nextBasemap=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}castVisibleElements(e){return{...fK,...e}}toggle(){return this.viewModel.toggle()}render(){const e=this.viewModel,i=e.state==="disabled"?null:e.activeBasemap,r=e.state==="disabled"?null:e.nextBasemap,n=e.state==="loading",s=e.state==="incompatible-next-basemap",o=r?r.title:"",a=r&&r.loadStatus!=="loaded";let l;const c=this.visibleElements.title&&o,u=s;return(c||u)&&(l=M("div",{class:gl.overlay,key:"overlay"},c?M("span",{class:gl.title,title:o},o):null,u?M("calcite-scrim",{class:gl.overlayScrim,title:this.messages.incompatibleSpatialReference},M("calcite-icon",{icon:"exclamation-mark-triangle"})):null)),M("div",{class:this.classes(gl.base,s?gl.disabled:null),role:"button","data-basemap-id":r?r.id:"",bind:this,onclick:this._toggle,onkeydown:this._toggle,tabIndex:s?-1:0,title:this.label},M("div",{class:this.classes(gl.container,gl.secondaryBasemapImage)},M("div",{class:gl.image,styles:pK(i)})),M("div",{class:gl.container},M("div",{class:this.classes(gl.image,a?gl.imageLoading:null),styles:pK(r)},a||n?M("calcite-scrim",null,M("span",{"aria-hidden":"true",role:"presentation",class:gl.loaderAnimation})):null),l))}_toggle(){this.toggle()}};d([p({readOnly:!0})],kl.prototype,"activeBasemap",null),d([p()],kl.prototype,"label",null),d([p(),ut("esri/widgets/BasemapToggle/t9n/BasemapToggle")],kl.prototype,"messages",void 0),d([p()],kl.prototype,"nextBasemap",null),d([p()],kl.prototype,"view",null),d([p({type:cG})],kl.prototype,"viewModel",void 0),d([p()],kl.prototype,"visibleElements",void 0),d([tt("visibleElements")],kl.prototype,"castVisibleElements",null),d([wr()],kl.prototype,"_toggle",null),kl=d([A("esri.widgets.BasemapToggle")],kl);const m7e=kl;function sR(t){return t&&typeof t.highlight=="function"}function q1t(t,e,i){return t==null||t>i&&(e===0||t<e)}var LA;let Pl=LA=class extends he{constructor(t){super(t),this.autoCloseMenu=!1,this.iconClass=null,this.items=null,this.label=null,this.open=!1,this.selected=!1,this.selectionEnabled=!1,this.clickFunction=null}castItems(t){return t?t.map(e=>e instanceof LA?e:new LA(e)):null}};d([p()],Pl.prototype,"autoCloseMenu",void 0),d([p()],Pl.prototype,"iconClass",void 0),d([p()],Pl.prototype,"items",void 0),d([tt("items")],Pl.prototype,"castItems",null),d([p()],Pl.prototype,"label",void 0),d([p()],Pl.prototype,"open",void 0),d([p()],Pl.prototype,"selected",void 0),d([p()],Pl.prototype,"selectionEnabled",void 0),d([p()],Pl.prototype,"clickFunction",void 0),Pl=LA=d([A("esri.widgets.FeatureTable.Grid.support.ButtonMenuItem")],Pl);const hd=Pl;let Rb=class extends he{constructor(e){super(e),this.items=null,this.open=!1}castItems(e){return e?e.map(i=>i instanceof hd?i:new hd(i)):null}};d([p()],Rb.prototype,"items",void 0),d([tt("items")],Rb.prototype,"castItems",null),d([p()],Rb.prototype,"open",void 0),Rb=d([A("esri.widgets.FeatureTable.Grid.support.ButtonMenuViewModel")],Rb);const g7e=Rb;function cl(t){if(t==null)return window;if(t.toString()!=="[object Window]"){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function Nv(t){var e=cl(t).Element;return t instanceof e||t instanceof Element}function rc(t){var e=cl(t).HTMLElement;return t instanceof e||t instanceof HTMLElement}function uG(t){if(typeof ShadowRoot>"u")return!1;var e=cl(t).ShadowRoot;return t instanceof e||t instanceof ShadowRoot}var hv=Math.max,HP=Math.min,y1=Math.round;function Sj(){var t=navigator.userAgentData;return t!=null&&t.brands&&Array.isArray(t.brands)?t.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function Xfe(){return!/^((?!chrome|android).)*safari/i.test(Sj())}function v1(t,e,i){e===void 0&&(e=!1),i===void 0&&(i=!1);var r=t.getBoundingClientRect(),n=1,s=1;e&&rc(t)&&(n=t.offsetWidth>0&&y1(r.width)/t.offsetWidth||1,s=t.offsetHeight>0&&y1(r.height)/t.offsetHeight||1);var o=Nv(t)?cl(t):window,a=o.visualViewport,l=!Xfe()&&i,c=(r.left+(l&&a?a.offsetLeft:0))/n,u=(r.top+(l&&a?a.offsetTop:0))/s,h=r.width/n,f=r.height/s;return{width:h,height:f,top:u,right:c+h,bottom:u+f,left:c,x:c,y:u}}function dG(t){var e=cl(t),i=e.pageXOffset,r=e.pageYOffset;return{scrollLeft:i,scrollTop:r}}function y7e(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}function v7e(t){return t===cl(t)||!rc(t)?dG(t):y7e(t)}function Gd(t){return t?(t.nodeName||"").toLowerCase():null}function Ag(t){return((Nv(t)?t.ownerDocument:t.document)||window.document).documentElement}function hG(t){return v1(Ag(t)).left+dG(t).scrollLeft}function xp(t){return cl(t).getComputedStyle(t)}function pG(t){var e=xp(t),i=e.overflow,r=e.overflowX,n=e.overflowY;return/auto|scroll|overlay|hidden/.test(i+n+r)}function _7e(t){var e=t.getBoundingClientRect(),i=y1(e.width)/t.offsetWidth||1,r=y1(e.height)/t.offsetHeight||1;return i!==1||r!==1}function b7e(t,e,i){i===void 0&&(i=!1);var r=rc(e),n=rc(e)&&_7e(e),s=Ag(e),o=v1(t,n,i),a={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(r||!r&&!i)&&((Gd(e)!=="body"||pG(s))&&(a=v7e(e)),rc(e)?(l=v1(e,!0),l.x+=e.clientLeft,l.y+=e.clientTop):s&&(l.x=hG(s))),{x:o.left+a.scrollLeft-l.x,y:o.top+a.scrollTop-l.y,width:o.width,height:o.height}}function fG(t){var e=v1(t),i=t.offsetWidth,r=t.offsetHeight;return Math.abs(e.width-i)<=1&&(i=e.width),Math.abs(e.height-r)<=1&&(r=e.height),{x:t.offsetLeft,y:t.offsetTop,width:i,height:r}}function oR(t){return Gd(t)==="html"?t:t.assignedSlot||t.parentNode||(uG(t)?t.host:null)||Ag(t)}function Qfe(t){return["html","body","#document"].indexOf(Gd(t))>=0?t.ownerDocument.body:rc(t)&&pG(t)?t:Qfe(oR(t))}function hI(t,e){var i;e===void 0&&(e=[]);var r=Qfe(t),n=r===((i=t.ownerDocument)==null?void 0:i.body),s=cl(r),o=n?[s].concat(s.visualViewport||[],pG(r)?r:[]):r,a=e.concat(o);return n?a:a.concat(hI(oR(o)))}function w7e(t){return["table","td","th"].indexOf(Gd(t))>=0}function mK(t){return!rc(t)||xp(t).position==="fixed"?null:t.offsetParent}function x7e(t){var e=/firefox/i.test(Sj()),i=/Trident/i.test(Sj());if(i&&rc(t)){var r=xp(t);if(r.position==="fixed")return null}var n=oR(t);for(uG(n)&&(n=n.host);rc(n)&&["html","body"].indexOf(Gd(n))<0;){var s=xp(n);if(s.transform!=="none"||s.perspective!=="none"||s.contain==="paint"||["transform","perspective"].indexOf(s.willChange)!==-1||e&&s.willChange==="filter"||e&&s.filter&&s.filter!=="none")return n;n=n.parentNode}return null}function DC(t){for(var e=cl(t),i=mK(t);i&&w7e(i)&&xp(i).position==="static";)i=mK(i);return i&&(Gd(i)==="html"||Gd(i)==="body"&&xp(i).position==="static")?e:i||x7e(t)||e}var Sa="top",cc="bottom",uc="right",Ia="left",mG="auto",NC=[Sa,cc,uc,Ia],_1="start",wT="end",S7e="clippingParents",eme="viewport",zx="popper",I7e="reference",gK=NC.reduce(function(t,e){return t.concat([e+"-"+_1,e+"-"+wT])},[]),tme=[].concat(NC,[mG]).reduce(function(t,e){return t.concat([e,e+"-"+_1,e+"-"+wT])},[]),T7e="beforeRead",C7e="read",E7e="afterRead",M7e="beforeMain",$7e="main",A7e="afterMain",k7e="beforeWrite",P7e="write",O7e="afterWrite",L7e=[T7e,C7e,E7e,M7e,$7e,A7e,k7e,P7e,O7e];function R7e(t){var e=new Map,i=new Set,r=[];t.forEach(function(s){e.set(s.name,s)});function n(s){i.add(s.name);var o=[].concat(s.requires||[],s.requiresIfExists||[]);o.forEach(function(a){if(!i.has(a)){var l=e.get(a);l&&n(l)}}),r.push(s)}return t.forEach(function(s){i.has(s.name)||n(s)}),r}function F7e(t){var e=R7e(t);return L7e.reduce(function(i,r){return i.concat(e.filter(function(n){return n.phase===r}))},[])}function D7e(t){var e;return function(){return e||(e=new Promise(function(i){Promise.resolve().then(function(){e=void 0,i(t())})})),e}}function N7e(t){var e=t.reduce(function(i,r){var n=i[r.name];return i[r.name]=n?Object.assign({},n,r,{options:Object.assign({},n.options,r.options),data:Object.assign({},n.data,r.data)}):r,i},{});return Object.keys(e).map(function(i){return e[i]})}function V7e(t,e){var i=cl(t),r=Ag(t),n=i.visualViewport,s=r.clientWidth,o=r.clientHeight,a=0,l=0;if(n){s=n.width,o=n.height;var c=Xfe();(c||!c&&e==="fixed")&&(a=n.offsetLeft,l=n.offsetTop)}return{width:s,height:o,x:a+hG(t),y:l}}function z7e(t){var e,i=Ag(t),r=dG(t),n=(e=t.ownerDocument)==null?void 0:e.body,s=hv(i.scrollWidth,i.clientWidth,n?n.scrollWidth:0,n?n.clientWidth:0),o=hv(i.scrollHeight,i.clientHeight,n?n.scrollHeight:0,n?n.clientHeight:0),a=-r.scrollLeft+hG(t),l=-r.scrollTop;return xp(n||i).direction==="rtl"&&(a+=hv(i.clientWidth,n?n.clientWidth:0)-s),{width:s,height:o,x:a,y:l}}function ime(t,e){var i=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(i&&uG(i)){var r=e;do{if(r&&t.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function Ij(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function j7e(t,e){var i=v1(t,!1,e==="fixed");return i.top=i.top+t.clientTop,i.left=i.left+t.clientLeft,i.bottom=i.top+t.clientHeight,i.right=i.left+t.clientWidth,i.width=t.clientWidth,i.height=t.clientHeight,i.x=i.left,i.y=i.top,i}function yK(t,e,i){return e===eme?Ij(V7e(t,i)):Nv(e)?j7e(e,i):Ij(z7e(Ag(t)))}function B7e(t){var e=hI(oR(t)),i=["absolute","fixed"].indexOf(xp(t).position)>=0,r=i&&rc(t)?DC(t):t;return Nv(r)?e.filter(function(n){return Nv(n)&&ime(n,r)&&Gd(n)!=="body"}):[]}function U7e(t,e,i,r){var n=e==="clippingParents"?B7e(t):[].concat(e),s=[].concat(n,[i]),o=s[0],a=s.reduce(function(l,c){var u=yK(t,c,r);return l.top=hv(u.top,l.top),l.right=HP(u.right,l.right),l.bottom=HP(u.bottom,l.bottom),l.left=hv(u.left,l.left),l},yK(t,o,r));return a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,a}function Ld(t){return t.split("-")[0]}function b1(t){return t.split("-")[1]}function gG(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function rme(t){var e=t.reference,i=t.element,r=t.placement,n=r?Ld(r):null,s=r?b1(r):null,o=e.x+e.width/2-i.width/2,a=e.y+e.height/2-i.height/2,l;switch(n){case Sa:l={x:o,y:e.y-i.height};break;case cc:l={x:o,y:e.y+e.height};break;case uc:l={x:e.x+e.width,y:a};break;case Ia:l={x:e.x-i.width,y:a};break;default:l={x:e.x,y:e.y}}var c=n?gG(n):null;if(c!=null){var u=c==="y"?"height":"width";switch(s){case _1:l[c]=l[c]-(e[u]/2-i[u]/2);break;case wT:l[c]=l[c]+(e[u]/2-i[u]/2);break}}return l}function nme(){return{top:0,right:0,bottom:0,left:0}}function sme(t){return Object.assign({},nme(),t)}function ome(t,e){return e.reduce(function(i,r){return i[r]=t,i},{})}function xT(t,e){e===void 0&&(e={});var i=e,r=i.placement,n=r===void 0?t.placement:r,s=i.strategy,o=s===void 0?t.strategy:s,a=i.boundary,l=a===void 0?S7e:a,c=i.rootBoundary,u=c===void 0?eme:c,h=i.elementContext,f=h===void 0?zx:h,m=i.altBoundary,g=m===void 0?!1:m,y=i.padding,v=y===void 0?0:y,b=sme(typeof v!="number"?v:ome(v,NC)),w=f===zx?I7e:zx,x=t.rects.popper,S=t.elements[g?w:f],I=U7e(Nv(S)?S:S.contextElement||Ag(t.elements.popper),l,u,o),T=v1(t.elements.reference),C=rme({reference:T,element:x,strategy:"absolute",placement:n}),E=Ij(Object.assign({},x,C)),$=f===zx?E:T,P={top:I.top-$.top+b.top,bottom:$.bottom-I.bottom+b.bottom,left:I.left-$.left+b.left,right:$.right-I.right+b.right},k=t.modifiersData.offset;if(f===zx&&k){var L=k[n];Object.keys(P).forEach(function(F){var V=[uc,cc].indexOf(F)>=0?1:-1,z=[Sa,cc].indexOf(F)>=0?"y":"x";P[F]+=L[z]*V})}return P}var vK={placement:"bottom",modifiers:[],strategy:"absolute"};function _K(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return!e.some(function(r){return!(r&&typeof r.getBoundingClientRect=="function")})}function G7e(t){t===void 0&&(t={});var e=t,i=e.defaultModifiers,r=i===void 0?[]:i,n=e.defaultOptions,s=n===void 0?vK:n;return function(a,l,c){c===void 0&&(c=s);var u={placement:"bottom",orderedModifiers:[],options:Object.assign({},vK,s),modifiersData:{},elements:{reference:a,popper:l},attributes:{},styles:{}},h=[],f=!1,m={state:u,setOptions:function(b){var w=typeof b=="function"?b(u.options):b;y(),u.options=Object.assign({},s,u.options,w),u.scrollParents={reference:Nv(a)?hI(a):a.contextElement?hI(a.contextElement):[],popper:hI(l)};var x=F7e(N7e([].concat(r,u.options.modifiers)));return u.orderedModifiers=x.filter(function(S){return S.enabled}),g(),m.update()},forceUpdate:function(){if(!f){var b=u.elements,w=b.reference,x=b.popper;if(_K(w,x)){u.rects={reference:b7e(w,DC(x),u.options.strategy==="fixed"),popper:fG(x)},u.reset=!1,u.placement=u.options.placement,u.orderedModifiers.forEach(function(P){return u.modifiersData[P.name]=Object.assign({},P.data)});for(var S=0;S<u.orderedModifiers.length;S++){if(u.reset===!0){u.reset=!1,S=-1;continue}var I=u.orderedModifiers[S],T=I.fn,C=I.options,E=C===void 0?{}:C,$=I.name;typeof T=="function"&&(u=T({state:u,options:E,name:$,instance:m})||u)}}}},update:D7e(function(){return new Promise(function(v){m.forceUpdate(),v(u)})}),destroy:function(){y(),f=!0}};if(!_K(a,l))return m;m.setOptions(c).then(function(v){!f&&c.onFirstUpdate&&c.onFirstUpdate(v)});function g(){u.orderedModifiers.forEach(function(v){var b=v.name,w=v.options,x=w===void 0?{}:w,S=v.effect;if(typeof S=="function"){var I=S({state:u,name:b,instance:m,options:x}),T=function(){};h.push(I||T)}})}function y(){h.forEach(function(v){return v()}),h=[]}return m}}var mM={passive:!0};function H7e(t){var e=t.state,i=t.instance,r=t.options,n=r.scroll,s=n===void 0?!0:n,o=r.resize,a=o===void 0?!0:o,l=cl(e.elements.popper),c=[].concat(e.scrollParents.reference,e.scrollParents.popper);return s&&c.forEach(function(u){u.addEventListener("scroll",i.update,mM)}),a&&l.addEventListener("resize",i.update,mM),function(){s&&c.forEach(function(u){u.removeEventListener("scroll",i.update,mM)}),a&&l.removeEventListener("resize",i.update,mM)}}const q7e={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:H7e,data:{}};function W7e(t){var e=t.state,i=t.name;e.modifiersData[i]=rme({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})}const J7e={name:"popperOffsets",enabled:!0,phase:"read",fn:W7e,data:{}};var Z7e={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Y7e(t,e){var i=t.x,r=t.y,n=e.devicePixelRatio||1;return{x:y1(i*n)/n||0,y:y1(r*n)/n||0}}function bK(t){var e,i=t.popper,r=t.popperRect,n=t.placement,s=t.variation,o=t.offsets,a=t.position,l=t.gpuAcceleration,c=t.adaptive,u=t.roundOffsets,h=t.isFixed,f=o.x,m=f===void 0?0:f,g=o.y,y=g===void 0?0:g,v=typeof u=="function"?u({x:m,y}):{x:m,y};m=v.x,y=v.y;var b=o.hasOwnProperty("x"),w=o.hasOwnProperty("y"),x=Ia,S=Sa,I=window;if(c){var T=DC(i),C="clientHeight",E="clientWidth";if(T===cl(i)&&(T=Ag(i),xp(T).position!=="static"&&a==="absolute"&&(C="scrollHeight",E="scrollWidth")),T=T,n===Sa||(n===Ia||n===uc)&&s===wT){S=cc;var $=h&&T===I&&I.visualViewport?I.visualViewport.height:T[C];y-=$-r.height,y*=l?1:-1}if(n===Ia||(n===Sa||n===cc)&&s===wT){x=uc;var P=h&&T===I&&I.visualViewport?I.visualViewport.width:T[E];m-=P-r.width,m*=l?1:-1}}var k=Object.assign({position:a},c&&Z7e),L=u===!0?Y7e({x:m,y},cl(i)):{x:m,y};if(m=L.x,y=L.y,l){var F;return Object.assign({},k,(F={},F[S]=w?"0":"",F[x]=b?"0":"",F.transform=(I.devicePixelRatio||1)<=1?"translate("+m+"px, "+y+"px)":"translate3d("+m+"px, "+y+"px, 0)",F))}return Object.assign({},k,(e={},e[S]=w?y+"px":"",e[x]=b?m+"px":"",e.transform="",e))}function K7e(t){var e=t.state,i=t.options,r=i.gpuAcceleration,n=r===void 0?!0:r,s=i.adaptive,o=s===void 0?!0:s,a=i.roundOffsets,l=a===void 0?!0:a,c={placement:Ld(e.placement),variation:b1(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:n,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,bK(Object.assign({},c,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:o,roundOffsets:l})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,bK(Object.assign({},c,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const X7e={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:K7e,data:{}};function Q7e(t){var e=t.state;Object.keys(e.elements).forEach(function(i){var r=e.styles[i]||{},n=e.attributes[i]||{},s=e.elements[i];!rc(s)||!Gd(s)||(Object.assign(s.style,r),Object.keys(n).forEach(function(o){var a=n[o];a===!1?s.removeAttribute(o):s.setAttribute(o,a===!0?"":a)}))})}function eHe(t){var e=t.state,i={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,i.popper),e.styles=i,e.elements.arrow&&Object.assign(e.elements.arrow.style,i.arrow),function(){Object.keys(e.elements).forEach(function(r){var n=e.elements[r],s=e.attributes[r]||{},o=Object.keys(e.styles.hasOwnProperty(r)?e.styles[r]:i[r]),a=o.reduce(function(l,c){return l[c]="",l},{});!rc(n)||!Gd(n)||(Object.assign(n.style,a),Object.keys(s).forEach(function(l){n.removeAttribute(l)}))})}}const tHe={name:"applyStyles",enabled:!0,phase:"write",fn:Q7e,effect:eHe,requires:["computeStyles"]};function iHe(t,e,i){var r=Ld(t),n=[Ia,Sa].indexOf(r)>=0?-1:1,s=typeof i=="function"?i(Object.assign({},e,{placement:t})):i,o=s[0],a=s[1];return o=o||0,a=(a||0)*n,[Ia,uc].indexOf(r)>=0?{x:a,y:o}:{x:o,y:a}}function rHe(t){var e=t.state,i=t.options,r=t.name,n=i.offset,s=n===void 0?[0,0]:n,o=tme.reduce(function(u,h){return u[h]=iHe(h,e.rects,s),u},{}),a=o[e.placement],l=a.x,c=a.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=l,e.modifiersData.popperOffsets.y+=c),e.modifiersData[r]=o}const nHe={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:rHe};var sHe={left:"right",right:"left",bottom:"top",top:"bottom"};function RA(t){return t.replace(/left|right|bottom|top/g,function(e){return sHe[e]})}var oHe={start:"end",end:"start"};function wK(t){return t.replace(/start|end/g,function(e){return oHe[e]})}function aHe(t,e){e===void 0&&(e={});var i=e,r=i.placement,n=i.boundary,s=i.rootBoundary,o=i.padding,a=i.flipVariations,l=i.allowedAutoPlacements,c=l===void 0?tme:l,u=b1(r),h=u?a?gK:gK.filter(function(g){return b1(g)===u}):NC,f=h.filter(function(g){return c.indexOf(g)>=0});f.length===0&&(f=h);var m=f.reduce(function(g,y){return g[y]=xT(t,{placement:y,boundary:n,rootBoundary:s,padding:o})[Ld(y)],g},{});return Object.keys(m).sort(function(g,y){return m[g]-m[y]})}function lHe(t){if(Ld(t)===mG)return[];var e=RA(t);return[wK(t),e,wK(e)]}function cHe(t){var e=t.state,i=t.options,r=t.name;if(!e.modifiersData[r]._skip){for(var n=i.mainAxis,s=n===void 0?!0:n,o=i.altAxis,a=o===void 0?!0:o,l=i.fallbackPlacements,c=i.padding,u=i.boundary,h=i.rootBoundary,f=i.altBoundary,m=i.flipVariations,g=m===void 0?!0:m,y=i.allowedAutoPlacements,v=e.options.placement,b=Ld(v),w=b===v,x=l||(w||!g?[RA(v)]:lHe(v)),S=[v].concat(x).reduce(function(me,Se){return me.concat(Ld(Se)===mG?aHe(e,{placement:Se,boundary:u,rootBoundary:h,padding:c,flipVariations:g,allowedAutoPlacements:y}):Se)},[]),I=e.rects.reference,T=e.rects.popper,C=new Map,E=!0,$=S[0],P=0;P<S.length;P++){var k=S[P],L=Ld(k),F=b1(k)===_1,V=[Sa,cc].indexOf(L)>=0,z=V?"width":"height",G=xT(e,{placement:k,boundary:u,rootBoundary:h,altBoundary:f,padding:c}),H=V?F?uc:Ia:F?cc:Sa;I[z]>T[z]&&(H=RA(H));var Z=RA(H),K=[];if(s&&K.push(G[L]<=0),a&&K.push(G[H]<=0,G[Z]<=0),K.every(function(me){return me})){$=k,E=!1;break}C.set(k,K)}if(E)for(var X=g?3:1,oe=function(Se){var Ge=S.find(function(Be){var gt=C.get(Be);if(gt)return gt.slice(0,Se).every(function(Pe){return Pe})});if(Ge)return $=Ge,"break"},se=X;se>0;se--){var le=oe(se);if(le==="break")break}e.placement!==$&&(e.modifiersData[r]._skip=!0,e.placement=$,e.reset=!0)}}const uHe={name:"flip",enabled:!0,phase:"main",fn:cHe,requiresIfExists:["offset"],data:{_skip:!1}};function dHe(t){return t==="x"?"y":"x"}function pI(t,e,i){return hv(t,HP(e,i))}function hHe(t,e,i){var r=pI(t,e,i);return r>i?i:r}function pHe(t){var e=t.state,i=t.options,r=t.name,n=i.mainAxis,s=n===void 0?!0:n,o=i.altAxis,a=o===void 0?!1:o,l=i.boundary,c=i.rootBoundary,u=i.altBoundary,h=i.padding,f=i.tether,m=f===void 0?!0:f,g=i.tetherOffset,y=g===void 0?0:g,v=xT(e,{boundary:l,rootBoundary:c,padding:h,altBoundary:u}),b=Ld(e.placement),w=b1(e.placement),x=!w,S=gG(b),I=dHe(S),T=e.modifiersData.popperOffsets,C=e.rects.reference,E=e.rects.popper,$=typeof y=="function"?y(Object.assign({},e.rects,{placement:e.placement})):y,P=typeof $=="number"?{mainAxis:$,altAxis:$}:Object.assign({mainAxis:0,altAxis:0},$),k=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,L={x:0,y:0};if(T){if(s){var F,V=S==="y"?Sa:Ia,z=S==="y"?cc:uc,G=S==="y"?"height":"width",H=T[S],Z=H+v[V],K=H-v[z],X=m?-E[G]/2:0,oe=w===_1?C[G]:E[G],se=w===_1?-E[G]:-C[G],le=e.elements.arrow,me=m&&le?fG(le):{width:0,height:0},Se=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:nme(),Ge=Se[V],Be=Se[z],gt=pI(0,C[G],me[G]),Pe=x?C[G]/2-X-gt-Ge-P.mainAxis:oe-gt-Ge-P.mainAxis,De=x?-C[G]/2+X+gt+Be+P.mainAxis:se+gt+Be+P.mainAxis,ii=e.elements.arrow&&DC(e.elements.arrow),Rr=ii?S==="y"?ii.clientTop||0:ii.clientLeft||0:0,At=(F=k==null?void 0:k[S])!=null?F:0,mo=H+Pe-At-Rr,bs=H+De-At,Ai=pI(m?HP(Z,mo):Z,H,m?hv(K,bs):K);T[S]=Ai,L[S]=Ai-H}if(a){var un,fc=S==="x"?Sa:Ia,mc=S==="x"?cc:uc,cr=T[I],ur=I==="y"?"height":"width",Ho=cr+v[fc],Ce=cr-v[mc],Xe=[Sa,Ia].indexOf(b)!==-1,Rt=(un=k==null?void 0:k[I])!=null?un:0,Qi=Xe?Ho:cr-C[ur]-E[ur]-Rt+P.altAxis,xi=Xe?cr+C[ur]+E[ur]-Rt-P.altAxis:Ce,Ln=m&&Xe?hHe(Qi,cr,xi):pI(m?Qi:Ho,cr,m?xi:Ce);T[I]=Ln,L[I]=Ln-cr}e.modifiersData[r]=L}}const fHe={name:"preventOverflow",enabled:!0,phase:"main",fn:pHe,requiresIfExists:["offset"]};var mHe=function(e,i){return e=typeof e=="function"?e(Object.assign({},i.rects,{placement:i.placement})):e,sme(typeof e!="number"?e:ome(e,NC))};function gHe(t){var e,i=t.state,r=t.name,n=t.options,s=i.elements.arrow,o=i.modifiersData.popperOffsets,a=Ld(i.placement),l=gG(a),c=[Ia,uc].indexOf(a)>=0,u=c?"height":"width";if(!(!s||!o)){var h=mHe(n.padding,i),f=fG(s),m=l==="y"?Sa:Ia,g=l==="y"?cc:uc,y=i.rects.reference[u]+i.rects.reference[l]-o[l]-i.rects.popper[u],v=o[l]-i.rects.reference[l],b=DC(s),w=b?l==="y"?b.clientHeight||0:b.clientWidth||0:0,x=y/2-v/2,S=h[m],I=w-f[u]-h[g],T=w/2-f[u]/2+x,C=pI(S,T,I),E=l;i.modifiersData[r]=(e={},e[E]=C,e.centerOffset=C-T,e)}}function yHe(t){var e=t.state,i=t.options,r=i.element,n=r===void 0?"[data-popper-arrow]":r;n!=null&&(typeof n=="string"&&(n=e.elements.popper.querySelector(n),!n)||ime(e.elements.popper,n)&&(e.elements.arrow=n))}const vHe={name:"arrow",enabled:!0,phase:"main",fn:gHe,effect:yHe,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function xK(t,e,i){return i===void 0&&(i={x:0,y:0}),{top:t.top-e.height-i.y,right:t.right-e.width+i.x,bottom:t.bottom-e.height+i.y,left:t.left-e.width-i.x}}function SK(t){return[Sa,uc,cc,Ia].some(function(e){return t[e]>=0})}function _He(t){var e=t.state,i=t.name,r=e.rects.reference,n=e.rects.popper,s=e.modifiersData.preventOverflow,o=xT(e,{elementContext:"reference"}),a=xT(e,{altBoundary:!0}),l=xK(o,r),c=xK(a,n,s),u=SK(l),h=SK(c);e.modifiersData[i]={referenceClippingOffsets:l,popperEscapeOffsets:c,isReferenceHidden:u,hasPopperEscaped:h},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":h})}const bHe={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:_He};var wHe=[q7e,J7e,X7e,tHe,nHe,uHe,fHe,vHe,bHe],xHe=G7e({defaultModifiers:wHe});const SHe=["bottom","bottom-start","bottom-end","left","left-start","left-end","right","right-start","right-end","top","top-start","top-end"],IK={base:"esri-popover",open:"esri-popover--open"},IHe={position:"fixed","z-index":"1000"};let sd=class extends di{constructor(e,i){super(e,i),this._popper=null,this._contentNode=null,this._renderAttached=!1,this._rootNode=null,this.anchorElement=null,this.offset=[0,0],this.open=!1,this.renderContentFunction=null,this._afterRootCreate=r=>{this._rootNode=r},this._afterContentCreate=r=>{this._contentNode=r},this._updatePosition=()=>{this._popper!=null&&this._popper.update()}}initialize(){this.when(()=>{this.destroyed||(this._projector.append(document.body,this.render),this._renderAttached=!0)}),this.addHandles([J(()=>[this.open,this.anchorElement],()=>this._buildPopper(),Le),J(()=>[this.placement,this.offset],()=>this._setPopperOptions(),Le)])}destroy(){this.owner=null,this.anchorElement=null,this.renderContentFunction=null,this._renderAttached&&(this._projector.detach(this.render),this._renderAttached=!1),this._rootNode!=null&&(tOe(this._rootNode),this._rootNode=null),this._contentNode=null,this._popper!=null&&(this._popper.destroy(),this._popper=null)}set container(e){}set owner(e){this._set("owner",e)}get placement(){return"top"}set placement(e){SHe.includes(e)?this._override("placement",e):this._clearOverride("placement")}get test(){return{rootNode:this._rootNode}}render(){var n;const{open:e,owner:i,renderContentFunction:r}=this;return M("div",{afterCreate:this._afterRootCreate,class:this.classes(IK.base,e?IK.open:null),styles:IHe,lang:Mn()},M("div",{dir:$ce((n=this.owner)==null?void 0:n.container),afterCreate:this._afterContentCreate,afterUpdate:this._updatePosition},e&&(r==null?void 0:r.call(i))))}_buildPopper(){this._popper!=null&&(this._popper.destroy(),this._popper=null);const e=this._contentNode;if(e==null||!this.open||!this.renderContentFunction)return;const i=this._getAnchor();i&&(this._popper=xHe(i,e),this._setPopperOptions())}_setPopperOptions(){const{placement:e,offset:i,_popper:r}=this;r!=null&&(r.setOptions({placement:e,modifiers:[{name:"offset",options:{offset:i}}]}),r.forceUpdate())}_getAnchor(){const{anchorElement:e}=this;return vL(typeof e=="function"?e():e)}};d([p()],sd.prototype,"anchorElement",void 0),d([p()],sd.prototype,"container",null),d([p()],sd.prototype,"offset",void 0),d([p()],sd.prototype,"open",void 0),d([p()],sd.prototype,"owner",null),d([p()],sd.prototype,"placement",null),d([p()],sd.prototype,"renderContentFunction",void 0),sd=d([A("esri.widgets.support.Popover")],sd);const yG=sd,vo="esri-button-menu",zs={base:vo,content:`${vo}__content`,contentWrapper:`${vo}__content-wrapper`,itemWrapper:`${vo}__item-wrapper`,label:`${vo}__label`,icon:`${vo}__icon`,item:`${vo}__item`,itemLabel:`${vo}__item-label`,itemLabelContent:`${vo}__item-label-content`,selectableMenuItem:`${vo}__item--selectable`,selectedMenuItem:`${vo}__item--selected`,checkbox:`${vo}__checkbox`,embeddedContentWrapper:`${vo}__embedded-content-wrapper`,button:`${vo}__button`,buttonSelected:`${vo}__button--selected`,defaultIconClass:"esri-icon-menu",widget:"esri-widget"};let zf=class extends cn(di){constructor(e,i){super(e,i),this._menuContentNode=null,this._popover=null,this._rootNode=null,this.disabled=!1,this.iconClass="",this.viewModel=new g7e,this._handleOutsideClick=this._handleOutsideClick.bind(this)}postInitialize(){this._popover=new yG({owner:this,open:!!this.open,placement:ll(this.container)?"bottom-start":"bottom-end",renderContentFunction:this.renderMenuContent,anchorElement:this._rootNode}),this.handles.add(J(()=>this.open,e=>{var i;return(i=this._popover)==null?void 0:i.set("open",e)})),document.addEventListener("click",this._handleOutsideClick)}destroy(){var e;(e=this._popover)==null||e.destroy(),this._popover=null,document.removeEventListener("click",this._handleOutsideClick)}_handleOutsideClick(e){var r,n;if(!this.open||!this._rootNode||!this._menuContentNode)return;const i=e.target;(r=this._menuContentNode)!=null&&r.contains(i)||(n=this._rootNode)!=null&&n.contains(i)||(this.open=!1)}get items(){return this.viewModel.items}set items(e){this.viewModel.items=e}get open(){return this.viewModel.open}set open(e){this.viewModel.open=e}render(){return M("div",{afterCreate:this._afterRootNodeCreate,bind:this,"data-node-ref":"_rootNode",class:this.classes(zs.base,zs.widget),key:"menu"},this.renderMenuButton())}renderMenuButton(){const{iconClass:e,id:i,label:r,open:n}=this,s=this.classes(zs.button,e??zs.defaultIconClass,n?zs.buttonSelected:null);return M("button",{"aria-pressed":n.toString(),"aria-controls":`${i}-menu`,"aria-expanded":n.toString(),"aria-haspopup":"true","aria-label":r,bind:this,class:s,disabled:this.disabled,id:`${i}-button`,title:r??"",selected:n,onclick:this._toggleOpen,tabindex:this.disabled?-1:0,type:"button"})}renderMenuContent(){var r;const{id:e,open:i}=this;return M("div",{afterCreate:this._afterMenuContentNodeCreate,bind:this,class:zs.content,"data-node-ref":"_menuContentNode",key:"esri-button-menu-content",hidden:!i},M("ul",{"aria-labelledby":`${e}-button`,bind:this,class:zs.itemWrapper,id:`${e}-menu`,role:"menu"},((r=this.items)==null?void 0:r.length)&&this.renderItems()))}renderItems(){var e;return(e=this.items)==null?void 0:e.map((i,r)=>this.renderItem(i,r))}renderItem(e,i,r){var a;const n=r!=null?`${this.id}-menu-item-${i}-${r}`:`${this.id}-menu-item-${i}`,s=`${n}-label`,o=this.classes(zs.item,e.selectionEnabled?zs.selectableMenuItem:null,e.selectionEnabled&&e.selected?zs.selectedMenuItem:null);return M("li",{afterCreate:this._afterMenuItemCreate,bind:this,class:o,"data-item-index":i,"data-item-subIndex":r,for:n,key:n,onkeydown:l=>this._handleMenuItemKeydown(l,e),onclick:l=>this._handleMenuItemInteraction(l,e),role:"menuitem",tabindex:this.disabled?-1:0},M("input",{disabled:!0,checked:e.selected,class:zs.checkbox,id:n,name:n,tabindex:"-1",type:"checkbox"}),M("label",{bind:this,class:this.classes(zs.button,zs.itemLabel),for:n,id:s},M("span",{class:this.classes(zs.icon,e.iconClass),"aria-hidden":"true"}),M("span",{class:zs.itemLabelContent},Km.sanitize(e.label))),M("ul",{"aria-labelledby":s,class:zs.embeddedContentWrapper,id:`${this.id}-submenu`,role:"menu"},(a=e==null?void 0:e.items)==null?void 0:a.map((l,c)=>this.renderItem(l,i,c))))}_afterRootNodeCreate(e){var i;this._rootNode=e,(i=this._popover)==null||i.set("anchorElement",()=>e)}_handleMenuItemInteraction(e,i){i.selected=!i.selected,i.open=!(!i.selected||!i.items),i.autoCloseMenu&&this.set("open",!1),i.clickFunction&&i.clickFunction({event:e,item:i}),e.stopPropagation()}_handleMenuItemKeydown(e,i){const r=ip(e);W0(r)&&this._handleMenuItemInteraction(e,i),r==="Escape"&&(this.open=!1,e.preventDefault(),e.stopPropagation())}_afterMenuContentNodeCreate(e){this._menuContentNode=e,e.focus()}_toggleOpen(){this.open=!this.open}_afterMenuItemCreate(e){e["data-item-index"]===0&&e.focus()}};d([p()],zf.prototype,"disabled",void 0),d([p()],zf.prototype,"iconClass",void 0),d([p()],zf.prototype,"items",null),d([p()],zf.prototype,"open",null),d([p()],zf.prototype,"viewModel",void 0),zf=d([A("esri.widgets.FeatureTable.Grid.support.ButtonMenu")],zf);const ame=zf,gM="esri-column",Gg={sortAscIcon:"esri-icon-arrow-up",sortDescIcon:"esri-icon-arrow-down",menuContainer:`${gM}__menu-container`,menuIcon:"esri-icon-handle-horizontal",sorter:`${gM}__sorter`,headerContent:`${gM}__header-content`,headerLabel:`${gM}__header-label`},TK={keyboardSort1:"Enter",keyboardSort2:"Spacebar"};let fi=class extends cn(an.EventedAccessor){constructor(e){super(e),this._menuContainer=document.createElement("div"),this.activeRowIndex=null,this.autoWidth=!1,this.cellValueFormatFunction=({value:i})=>Km.sanitize(i),this.flexGrow=1,this.footerRenderFunction=null,this.frozen=!1,this.grid=null,this.header=null,this.headerRenderFunction=i=>{const{root:r}=i;if(this.removeCellContent(r),r.classList.add(Gg.headerContent),this.sortable)this.headerSorterRenderFunction(i);else{const n=document.createElement("div");n.classList.add(Gg.headerLabel),n.textContent=this.label,r.appendChild(n)}this.headerMenuEnabled&&this.headerMenuRenderFunction(i)},this.headerMenuRenderFunction=({root:i})=>{var r,n;(n=(r=this.menu)==null?void 0:r.items)!=null&&n.length&&i.appendChild(this._menuContainer)},this.headerSorterRenderFunction=({root:i})=>{var a;const{label:r,sortElement:n}=this;if(!n)return void(i.textContent=r);n.textContent!==r&&n.setAttribute("textContent",r),i.appendChild(n);const s=(a=this.grid)==null?void 0:a.getSlotElementByName(i.slot),o=s==null?void 0:s.parentElement;o&&!o.onkeydown&&(o.onkeydown=({key:l})=>{l!==TK.keyboardSort1&&l!==TK.keyboardSort2||n.click()})},this.hidden=!1,this.headerMenuEnabled=!0,this.initialSortPriority=null,this.menu=null,this.menuConfig=null,this.messages=null,this.messagesCommon=null,this.messagesURIUtils=null,this.path=null,this.renderFunction=({root:i,column:r,rowData:n})=>{const s=this.getCellValue(r,n),o=this.cellValueFormatFunction({column:r,rowData:n,value:s});i.innerHTML!==o&&(i.innerHTML=o)},this.resizable=!0,this.sortable=!0,this.textAlign="start",this.width=200}initialize(){const{messages:e,path:i}=this;this._set("sortElement",this.createSortElement()),this.sortElement.setAttribute("path",i??""),this._menuContainer.classList.add(Gg.menuContainer),this.menu=new ame({label:e==null?void 0:e.options,iconClass:Gg.menuIcon,...this.menuConfig}),this.menu.container=this._menuContainer,this.menu.set("items",this.getMenuItems()),this.handles.add(J(()=>this.hidden,()=>{var r;return(r=this.menu)==null?void 0:r.set("open",!1)}),J(()=>this.path,r=>{this.sortElement&&this.sortElement.path!==r&&this.sortElement.setAttribute("path",r??"")}))}destroy(){var e;(e=this.menu)==null||e.destroy()}set direction(e){this.sortable&&(this.sortElement&&(e?this.sortElement.direction!==e&&this.sortElement.setAttribute("direction",e):this.sortElement.removeAttribute("direction")),this._set("direction",e))}get direction(){return this._get("direction")||null}get label(){return Km.sanitize(this.header??this.path??"")}getMenuItems(){const{menuConfig:e,sortable:i}=this,r=e==null?void 0:e.items,n=this.getSortMenuItems(),s=[];return i&&s.push(...n),r!=null&&r.length&&s.push(...r),s.length?s:null}getSortMenuItems(){const{messages:e}=this;return[{selected:this.direction==="asc",iconClass:Gg.sortAscIcon,label:e==null?void 0:e.sortAsc,autoCloseMenu:!0,clickFunction:()=>this.set("direction",this.direction!=="asc"?"asc":null)},{selected:this.direction==="desc",iconClass:Gg.sortDescIcon,label:e==null?void 0:e.sortDesc,autoCloseMenu:!0,clickFunction:()=>this.set("direction",this.direction!=="desc"?"desc":null)}]}getCellValue(e,i){return(i==null?void 0:i.item[e==null?void 0:e.path])??""}createSortElement(){const{direction:e,label:i,path:r,initialSortPriority:n}=this,s=document.createElement("vaadin-grid-sorter");return s.classList.add(Gg.sorter),s.setAttribute("path",r??""),s.setAttribute("title",i),s.textContent=i,e&&s.setAttribute("direction",e),n!=null&&(s._initialOrder=n),s.addEventListener("direction-changed",()=>{this.direction!==s.direction&&this._set("direction",s.direction)}),s}removeCellContent(e){if(e)for(;e.firstChild;)try{e.removeChild(e.firstChild)}catch{}}};d([p()],fi.prototype,"activeRowIndex",void 0),d([p()],fi.prototype,"autoWidth",void 0),d([p()],fi.prototype,"cellValueFormatFunction",void 0),d([p()],fi.prototype,"direction",null),d([p()],fi.prototype,"flexGrow",void 0),d([p()],fi.prototype,"footerRenderFunction",void 0),d([p()],fi.prototype,"frozen",void 0),d([p()],fi.prototype,"grid",void 0),d([p()],fi.prototype,"header",void 0),d([p()],fi.prototype,"headerRenderFunction",void 0),d([p()],fi.prototype,"headerMenuRenderFunction",void 0),d([p()],fi.prototype,"headerSorterRenderFunction",void 0),d([p()],fi.prototype,"hidden",void 0),d([p()],fi.prototype,"headerMenuEnabled",void 0),d([p({constructOnly:!0})],fi.prototype,"initialSortPriority",void 0),d([p({readOnly:!0})],fi.prototype,"label",null),d([p()],fi.prototype,"menu",void 0),d([p()],fi.prototype,"menuConfig",void 0),d([p()],fi.prototype,"messages",void 0),d([p()],fi.prototype,"messagesCommon",void 0),d([p()],fi.prototype,"messagesURIUtils",void 0),d([p()],fi.prototype,"path",void 0),d([p()],fi.prototype,"renderFunction",void 0),d([p()],fi.prototype,"resizable",void 0),d([p()],fi.prototype,"sortable",void 0),d([p({readOnly:!0})],fi.prototype,"sortElement",void 0),d([p()],fi.prototype,"textAlign",void 0),d([p()],fi.prototype,"width",void 0),fi=d([A("esri.widgets.FeatureTable.Grid.Column")],fi);const aR=fi,THe={attachmentsColumn:"esri-feature-table__column--attachments"};let jf=class extends aR{constructor(e){super(e),this.header="",this.path="EsriFeatureTableAttachmentsColumn",this.renderFunction=({root:i,rowData:r})=>{const n=this._countFromItem(r==null?void 0:r.item).toString();i.innerHTML=`<div class="${THe.attachmentsColumn}">${n}</div>`},this.sortable=!1,this.textAlign="center"}_countFromItem(e){return(e==null?void 0:e.attachments)&&e.attachments.length||0}};d([p({constructOnly:!0})],jf.prototype,"header",void 0),d([p({readOnly:!0})],jf.prototype,"path",void 0),d([p()],jf.prototype,"renderFunction",void 0),d([p({readOnly:!0})],jf.prototype,"sortable",void 0),d([p({readOnly:!0})],jf.prototype,"textAlign",void 0),jf=d([A("esri.widgets.FeatureTable.AttachmentsColumn")],jf);const CHe=jf,wm=t=>(t==null?void 0:t.type)==="field",eg=t=>(t==null?void 0:t.type)==="group",Rw=t=>(t==null?void 0:t.type)==="relationship",N5=t=>!eg(t)&&t.group!=null,lme=t=>t.type==="field",V5=t=>t.type==="group",CK=t=>t.type==="relationship",cme=t=>t.reduce((e,i)=>eg(i)?[...e,...i.inputs]:[...e,i],[]),EK=t=>cme(t).filter(wm),EHe=t=>cme(t).filter(Rw),R0=(t,e)=>{var i;return t!=null&&((i=t.input)==null?void 0:i.type)===e},MK=t=>t!=null&&(R0(t,"text-box")||R0(t,"text-area")),$K=({domain:t,inputType:e="text-box",dataType:i})=>i==="number"&&e==="text-box"&&(!t||t.type!=="coded-value"),ume=t=>"items"in t,AK={typeFieldName:null,types:[]};function Tj(t,e,i){const r=Object.keys(e).filter(o=>NI(t,o)),n=r.map(o=>e[o]),s=r.map(o=>i.get(o)).filter(Dt);return MHe(t,dme(n,s))}function dme(t,e){const i=e.map((r,n)=>{let s=t[n];if(r.domain&&r.domain.type==="coded-value"){const o=r.domain.codedValues.find(a=>a.code===s);o!=null&&o.name&&(s=o.name)}return Zk(r)&&(s=vG(r,s)),[r.name,s]});return Object.fromEntries(i)}function vG(t,e){if(!t||e==null)return null;switch(t.type){case"date":return Oi(e);case"date-only":return nU(e);case"time-only":return sU(e);case"timestamp-offset":return oU(e);default:return null}}const Cj=new Set(["date-only","time-only","timestamp-offset"]);function MHe(t,e){return oc(oc(t,i=>`{${i.toLowerCase()}}`),Object.fromEntries(Object.entries(e).map(([i,r])=>[i.toLowerCase(),r])))}const Ej=t=>{var e,i;return t?t.type==="subtype-sublayer"?{typeFieldName:(e=t.parent)==null?void 0:e.subtypeField,types:((i=t.parent)==null?void 0:i.subtypes)??[]}:"types"in t&&t.types?{typeFieldName:t.typeIdField,types:t.types.map(({id:r,name:n,domains:s})=>({code:r,name:n,domains:s}))}:AK:AK},$He=(t,e)=>{if(!t)return!0;const{operations:i}=t;switch(e){case"INSERT":return i.supportsAdd;case"UPDATE":case"DELETE":return i.supportsUpdate;default:return!0}};var qP;(function(t){t.TOO_SHORT="length-validation-error::too-short"})(qP||(qP={}));const kK={type:"number"},PK={type:"number",intlOptions:{notation:"scientific"}},OK={type:"date",intlOptions:{day:"2-digit",month:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",second:"numeric"}};function LK(t){return t>=1e7||t<=-1e7}const AHe=(t,e)=>{const{dataType:i,domain:r,error:n,field:s,minLength:o,value:a,required:l}=t;if(!e||!n)return null;if(l&&a===null)return e.validationErrors.cannotBeNull;if(n===sg.VALUE_OUT_OF_RANGE||n===KI.OUT_OF_RANGE){const c=BB(r)||Loe(s);return Os(e.validationErrors.outsideRange,c,{format:{max:i==="date"?OK:LK(c.max)?PK:kK,min:i==="date"?OK:LK(c.min)?PK:kK}})}return n===sg.INVALID_CODED_VALUE?e.validationErrors.invalidCodedValue:n===n1.INVALID_TYPE?e.validationErrors.invalidType:n===qP.TOO_SHORT?Os(e.validationErrors.tooShort,{min:o}):null},kHe=t=>{var n;if(!t)return;const e=t.layer,i=e&&"geometryType"in e?e.geometryType:void 0,r=(n=t.geometry)==null?void 0:n.type;return r==="polyline"||i==="polyline"?"line":r||i||"table"},PHe=t=>{var i;const e=[];if(t.formTemplate){const{description:r,title:n}=t.formTemplate;(i=t.fields)==null||i.forEach(s=>{const o=n&&NI(n,s.name),a=r&&NI(r,s.name);(o||a)&&e.push(s.name)})}return e};function OHe(t){var e;return"formTemplate"in t&&t.formTemplate?(((e=t.formTemplate.elements)==null?void 0:e.filter(lme))??[]).some(({fieldName:i})=>!t.fieldsIndex.get(i)):!1}const LHe="esri.widgets.Feature.support.featureUtils",RK=ie.getLogger(LHe),RHe=/href=(""|'')/gi,FHe=/(\{([^\{\r\n]+)\})/g,DHe=/\'/g,hme=/^\s*expression\//i,NHe=/(\n)/gi,VHe=/[\u00A0-\u9999<>\&]/gim,zHe=/href\s*=\s*(?:\"([^\"]+)\"|\'([^\']+)\')/gi,jHe=/^(?:mailto:|tel:)/,pme="relationships/",FK=Zh("short-date-short-time");function BHe(t){if(t!=null)return t.get("sourceLayer")||t.get("layer")}async function X1t(t,e){return typeof t=="function"?t(e):t}function Q1t(t=""){if(t)return!jHe.test(t.trim().toLowerCase())}function UHe(t){return!!t&&hme.test(t)}function GHe(t,e){if(!UHe(e)||!t)return null;const i=e.replace(hme,"").toLowerCase();let r=null;return t.some(n=>n.name.toLowerCase()===i&&(r=n,!0)),r}function ext(t,e){const i=GHe(e,t==null?void 0:t.fieldName);return i?i.title||null:t?t.label||t.fieldName:null}function HHe(t,e){const i=e.get(t.toLowerCase());return`{${i&&i.fieldName||t}}`}function qHe(t){return t.replaceAll(RHe,"")}function _G(t,e){const i=bG(e,t);return i?i.name:t}function txt(t,e){return t&&t.map(i=>_G(i,e))}function bG(t,e){return t&&typeof t.getField=="function"&&e?t.getField(e)??null:null}function fme(t){return`${t}`.trim()}function ixt({attributes:t,globalAttributes:e,layer:i,text:r,expressionAttributes:n,fieldInfoMap:s}){return r?WHe({formattedAttributes:e,template:XHe(r,{...e,...n,...t},i),fieldInfoMap:s}):""}function WHe({formattedAttributes:t,template:e,fieldInfoMap:i}){return fme(qHe(oc(oc(e,r=>HHe(r,i)),t)))}function JHe(t,e,i=!1){const r=e[t];if(typeof r=="string"){const n="%27",s=(i?encodeURIComponent(r):r).replaceAll(DHe,n);e[t]=s}}function ZHe(t,e=!1){const i={...t};return Object.keys(i).forEach(r=>JHe(r,i,e)),i}function YHe(t,e,i){const r=(e=fme(e))&&e[0]!=="{";return oc(t,ZHe(i,r||!1))}function KHe(t,e){return t.replaceAll(FHe,(i,r,n)=>{const s=bG(e,n);return s?`{${s.name}}`:r})}function XHe(t,e,i){const r=KHe(t,i);return r&&r.replaceAll(zHe,(n,s,o)=>YHe(n,s||o,e))}function QHe(t,e){if(typeof t=="string"&&e&&e.dateFormat==null&&(e.places!=null||e.digitSeparator!=null)){const i=Number(t);if(!isNaN(i))return i}return t}function DK(t){return t!=null&&typeof t=="object"&&"layer"in t&&!!t.layer}function eqe(t){return t!=null&&typeof t=="object"&&"type"in t&&t.type==="map-image"}function tqe(t){return t!=null&&typeof t=="object"&&"fieldsIndex"in t&&"geometryType"in t&&"getField"in t&&"load"in t&&"loaded"in t&&"objectIdField"in t&&"spatialReference"in t&&"type"in t&&t.type==="feature"&&"when"in t}function iqe(t){return t!=null&&typeof t=="object"&&"createQuery"in t&&"queryFeatureCount"in t&&"queryObjectIds"in t&&"queryRelatedFeatures"in t&&"queryRelatedFeaturesCount"in t&&"relationships"in t}function lR(t){return tqe(t)&&iqe(t)}function rqe(t){return!!t&&typeof t=="object"&&"sourceLayer"in t&&lR(t.sourceLayer)}function nqe(t,e){var u;const{fieldInfos:i,fieldName:r,preventPlacesFormatting:n,layer:s}=e,o=sqe(i,r),a=o==null?void 0:o.clone(),l=bG(s,r);if(a&&!nN(r)){const h=l==null?void 0:l.type;if(h==="date"||h==="date-only"||h==="time-only"||h==="timestamp-offset"||(u=a.format)!=null&&u.dateFormat){const f=a.format??new sw;if(f.dateFormat??(f.dateFormat=h==="date-only"?"short-date":"short-date-short-time"),typeof t=="number"){const m=!DK(s)&&xB(s)&&s.datesInUnknownTimezone||DK(s)&&eqe(s.layer)&&s.layer.datesInUnknownTimezone;return f.formatDate(t,m)}switch(h){case"date-only":return f.formatDateOnly(t);case"time-only":return f.formatTimeOnly(t);case"timestamp-offset":return f.formatTimestamp(t)}}}const c=a==null?void 0:a.format;return typeof t=="string"&&nN(r)&&c?c.formatRasterPixelValue(t):typeof(t=QHe(t,c))=="string"||t==null||c==null?mme(t):n?po(t,{...aU(c),minimumFractionDigits:0,maximumFractionDigits:20}):c.formatNumber(t)}function sqe(t,e){if(t&&t.length&&e)return t.find(i=>{var r;return((r=i.fieldName)==null?void 0:r.toLowerCase())===e.toLowerCase()})}function oqe({fieldName:t,graphic:e,layer:i}){if(yme(t)||!i||typeof i.getFeatureType!="function")return null;const{typeIdField:r}=i;if(!r||t!==r)return null;const n=i.getFeatureType(e);return n?n.name:null}function aqe({fieldName:t,value:e,graphic:i,layer:r}){if(yme(t)||!r||typeof r.getFieldDomain!="function")return null;const n=i&&r.getFieldDomain(t,{feature:i});return n&&n.type==="coded-value"?n.getName(e):null}function rxt(t,e){const{creatorField:i,creationDateField:r,editorField:n,editDateField:s}=t;if(!e)return;const o=e[s];if(typeof o=="number"){const l=e[n];return{type:"edit",date:Oi(o,FK),user:l}}const a=e[r];if(typeof a=="number"){const l=e[i];return{type:"create",date:Oi(a,FK),user:l}}return null}function nxt(t,e){const i=new Map;return t&&t.forEach(r=>{const n=_G(r.fieldName,e);r.fieldName=n,i.set(n.toLowerCase(),r)}),i}function sxt(t){const e=[];if(!t)return e;const{fieldInfos:i,content:r}=t;return i&&e.push(...i),r&&Array.isArray(r)&&r.forEach(n=>{if(n.type==="fields"){const s=n&&n.fieldInfos;s&&e.push(...s)}}),e}function oxt(t){return t.replaceAll(VHe,e=>`&#${e.charCodeAt(0)};`)}function mme(t){return typeof t=="string"?t.replaceAll(NHe,'<br class="esri-text-new-line" />'):t}function gme(t){var c,u;const{value:e,fieldName:i,fieldInfos:r,fieldInfoMap:n,layer:s,graphic:o}=t;if(e==null)return"";const a=aqe({fieldName:i,value:e,graphic:o,layer:s});if(a)return a;const l=oqe({fieldName:i,graphic:o,layer:s});if(l)return l;if(n.get(i.toLowerCase()))return nqe(e,{fieldInfos:r||Array.from(n.values()),fieldName:i,layer:s});switch((u=(c=s==null?void 0:s.fieldsIndex)==null?void 0:c.get(i))==null?void 0:u.type){case"date":return Oi(e);case"date-only":return nU(e);case"time-only":return sU(e);case"timestamp-offset":return oU(e)}return mme(e)}function axt({fieldInfos:t,attributes:e,layer:i,graphic:r,fieldInfoMap:n,relatedInfos:s}){const o={};return s==null||s.forEach(a=>dqe({attributes:o,relatedInfo:a,fieldInfoMap:n,fieldInfos:t,layer:i})),e&&Object.keys(e).forEach(a=>{const l=e[a];o[a]=gme({fieldName:a,fieldInfos:t,fieldInfoMap:n,layer:i,value:l,graphic:r})}),o}async function lqe(t,e){var u,h;const{layer:i,graphic:r,outFields:n,objectIds:s,returnGeometry:o,spatialReference:a}=t,l=s[0];if(typeof l!="number"&&typeof l!="string"){const f="Could not query required fields for the specified feature. The feature's ID is invalid.",m={layer:i,graphic:r,objectId:l,requiredFields:n};return RK.warn(f,m),null}if(!((h=(u=Ro(i))==null?void 0:u.operations)!=null&&h.supportsQuery)){const f="The specified layer cannot be queried. The following fields will not be available.",m={layer:i,graphic:r,requiredFields:n,returnGeometry:o};return RK.warn(f,m),null}const c=i.createQuery();return c.objectIds=s,c.outFields=n!=null&&n.length?n:[i.objectIdField],c.returnGeometry=!!o,c.returnZ=!!o,c.returnM=!!o,c.outSpatialReference=a,(await i.queryFeatures(c,e)).features[0]}async function cqe(t){var r;if(!((r=t.expressionInfos)!=null&&r.length))return!1;const e=await zd(),{arcadeUtils:{hasGeometryFunctions:i}}=e;return i(t)}async function lxt({graphic:t,popupTemplate:e,layer:i,spatialReference:r},n){if(!i||!e||(typeof i.load=="function"&&await i.load(n),!t.attributes))return;const s=t.attributes[i.objectIdField];if(s==null)return;const o=[s],a=await e.getRequiredFields(i.fieldsIndex),l=$Ee(a,t),c=l?[]:a,u=e.returnGeometry||await cqe(e);if(l&&!u)return;const h=await lqe({layer:i,graphic:t,outFields:c,objectIds:o,returnGeometry:u,spatialReference:r},n);h&&(h.geometry&&(t.geometry=h.geometry),h.attributes&&(t.attributes={...t.attributes,...h.attributes}))}function yme(t=""){return!!t&&t.includes(pme)}function uqe(t){return t?`${pme}${t.layerId}/${t.fieldName}`:""}function NK({attributes:t,graphic:e,relatedInfo:i,fieldInfos:r,fieldInfoMap:n,layer:s}){t&&e&&i&&Object.keys(e.attributes).forEach(o=>{const a=uqe({layerId:i.relation.id.toString(),fieldName:o}),l=e.attributes[o];t[a]=gme({fieldName:a,fieldInfos:r,fieldInfoMap:n,layer:s,value:l,graphic:e})})}function dqe({attributes:t,relatedInfo:e,fieldInfoMap:i,fieldInfos:r,layer:n}){t&&e&&(e.relatedFeatures&&e.relatedFeatures&&e.relatedFeatures.forEach(s=>NK({attributes:t,graphic:s,relatedInfo:e,fieldInfoMap:i,fieldInfos:r,layer:n})),e.relatedStatsFeatures&&e.relatedStatsFeatures&&e.relatedStatsFeatures.forEach(s=>NK({attributes:t,graphic:s,relatedInfo:e,fieldInfoMap:i,fieldInfos:r,layer:n})))}const VK=t=>{if(!t)return!1;const e=t.toUpperCase();return e.includes("CURRENT_TIMESTAMP")||e.includes("CURRENT_DATE")||e.includes("CURRENT_TIME")},vme=({layer:t,method:e,query:i,definitionExpression:r})=>{var o,a;if(!((a=(o=t.capabilities)==null?void 0:o.query)!=null&&a.supportsCacheHint)||e==="attachments")return;const n=i.where!=null?i.where:null,s=i.geometry!=null?i.geometry:null;VK(r)||VK(n)||(s==null?void 0:s.type)==="extent"||i.resultType==="tile"||(i.cacheHint=!0)},cxt=({query:t,layer:e,method:i})=>{vme({layer:e,method:i,query:t,definitionExpression:`${e.definitionExpression} ${e.serviceDefinitionExpression}`})},uxt=({queryPayload:t,layer:e,method:i})=>{vme({layer:e,method:i,query:t,definitionExpression:`${e.definitionExpression} ${e.serviceDefinitionExpression}`})};function hqe(t,e,i){return t&&e&&i?zK(t.allLayers,e,i)||zK(t.allTables,e,i):null}function zK(t,e,i){return t.filter(lR).find(r=>r!==e&&r.url===e.url&&r.layerId===i.relatedTableId)}let Ol=class extends cn(he){constructor(e){super(e),this.element=null,this.feature=null,this.layer=null,this.type=null,this.visibilityExpressionExecutor=null}get description(){var e;return(e=this.element)==null?void 0:e.description}get evaluatedVisibilityExpression(){const{visibilityExpressionExecutor:e}=this;return e!=null?!!e.lastEvaluatedValue:null}get label(){var e;return(e=this.element)==null?void 0:e.label}get visible(){return this.evaluatedVisibilityExpression!=null?this.evaluatedVisibilityExpression:this.element!=null}};d([p({readOnly:!0})],Ol.prototype,"description",null),d([p({constructOnly:!0})],Ol.prototype,"element",void 0),d([p()],Ol.prototype,"evaluatedVisibilityExpression",null),d([p()],Ol.prototype,"feature",void 0),d([p()],Ol.prototype,"label",null),d([p()],Ol.prototype,"layer",void 0),d([p()],Ol.prototype,"type",void 0),d([p()],Ol.prototype,"visible",null),d([p()],Ol.prototype,"visibilityExpressionExecutor",void 0),Ol=d([A("esri.widgets.FeatureForm.InputBase")],Ol);const _me=Ol;let Bf=class extends _me{constructor(e){super(e),this.arcadeEditType="NA",this.editableExpressionExecutor=null}get editable(){return!!this.layerAllowsEdits&&(this.evaluatedEditableExpression??!1)}get evaluatedEditableExpression(){const{editableExpressionExecutor:e}=this;return e!=null?!!e.lastEvaluatedValue:null}get layerAllowsEdits(){const{layer:e}=this;if(!e)return!1;const i=Ro(e),r=i==null?void 0:i.operations.supportsEditing,n=$He(i,this.arcadeEditType);return!(!r||!n)}};d([p()],Bf.prototype,"arcadeEditType",void 0),d([p()],Bf.prototype,"editable",null),d([p()],Bf.prototype,"editableExpressionExecutor",void 0),d([p()],Bf.prototype,"evaluatedEditableExpression",null),d([p()],Bf.prototype,"layerAllowsEdits",null),Bf=d([A("esri.widgets.FeatureForm.EditableInput")],Bf);const bme=Bf;var Nl;(function(t){t.Text="text",t.Number="number",t.Date="date",t.Unsupported="unsupported"})(Nl||(Nl={}));const pqe="__internal-type-based-coded-value-domain__";let St=class extends bme{constructor(e){super(e),this._storedValue=null,this.error=null,this.field=null,this.group=null,this.requiredExpressionExecutor=null,this.type="field",this.valueExpressionExecutor=null}get _dateRange(){var i;const{element:e}=this;if(((i=e==null?void 0:e.input)==null?void 0:i.type)==="datetime-picker"){const{max:r,min:n}=e.input;return{max:r,min:n}}return{min:null,max:null}}get _configAllowsEdits(){var s,o;const{element:e,layer:i,name:r}=this;if(e!=null)return e.editableExpression?!!this.evaluatedEditableExpression:e.editable!==!1;if(i!=null&&i.userHasUpdateItemPrivileges)return!0;const n=i&&"popupTemplate"in i?(o=(s=i==null?void 0:i.popupTemplate)==null?void 0:s.fieldInfos)==null?void 0:o.find(({fieldName:a})=>a===r):null;return(n==null?void 0:n.isEditable)??!0}get _layerAndFieldAllowEdits(){var e;return this.layerAllowsEdits&&((e=this.field)==null?void 0:e.editable)}get _isVisibleByDefault(){const{field:e,layer:i}=this;return!!(e!=null&&e.visible)&&Aoe(e,i)}get _isEditTrackingField(){var e;return qB(this.layer).includes((e=this.name)==null?void 0:e.toLowerCase())}get _shouldUseValueExpression(){return this._layerAndFieldAllowEdits&&!this._configAllowsEdits&&this.valueExpressionExecutor!=null}get dataType(){const{field:e}=this;return Cd(e)?Nl.Number:rN(e)?Nl.Text:Zk(e)?Nl.Date:Nl.Unsupported}get dateDataType(){if(this.dataType===Nl.Date)return this.field.type!=="date"?"string":"number"}get domain(){var a;const{layer:e}=this,{typeFieldName:i,types:r}=Ej(e);if(i===this.name&&this.field.domain==null)return new NL({name:pqe,codedValues:r.map(({code:l,name:c})=>new uw({code:l,name:c}))});const{feature:n}=this,s=e==null?void 0:e.getFieldDomain(this.name,{feature:n}),o=(a=this.element)==null?void 0:a.domain;return o!=null&&this._isDomainCompatible(o)?o:s}get editable(){return!!this._layerAndFieldAllowEdits&&(this.evaluatedEditableExpression??this._configAllowsEdits)}get evaluatedRequiredExpression(){const{requiredExpressionExecutor:e}=this;return e!=null?!!e.lastEvaluatedValue:null}get evaluatedValueExpression(){const{valueExpressionExecutor:e}=this;return e!=null?e.lastEvaluatedValue:null}get hint(){var e;return(e=this.element)==null?void 0:e.hint}get includeDate(){return!(this.dataType!==Nl.Date||this.field.type==="time-only")}get includeTime(){var n;const{element:e,field:i}=this;if(this.dataType!==Nl.Date)return!1;if(i.type==="time-only")return!0;if(i.type==="date-only")return!1;const r=((n=e==null?void 0:e.input)==null?void 0:n.type)==="datetime-picker"?e.input.includeTime:void 0;return r===void 0||r}get includeTimestamp(){return this.field.type==="timestamp-offset"}set initialFeature(e){this._set("initialFeature",e),this.notifyChange("valid")}get inputType(){var e,i;return(i=(e=this.element)==null?void 0:e.input)==null?void 0:i.type}get isRelationshipKeyField(){var r;const{field:e,layer:i}=this;return lR(i)&&!!((r=i.relationships)!=null&&r.some(n=>n.keyField===e.name))}get label(){var e;return((e=this.element)==null?void 0:e.label)||this.field.alias||this.field.name}get maxLength(){if(this.dataType===Nl.Date)return-1;const{field:i,element:r}=this,n=i==null?void 0:i.length,s=MK(r)?r.input.maxLength:NaN;return s!=null&&!isNaN(s)&&s>=-1&&(n===-1||s<=n)?s:n}get minLength(){if(this.dataType===Nl.Date)return-1;const{field:i,element:r}=this,n=i==null?void 0:i.length,s=MK(r)?r.input.minLength:NaN;return s!=null&&!isNaN(s)&&s>=-1&&(n===-1||s<=n)?s:-1}get name(){var e;return(e=this.field)==null?void 0:e.name}get range(){const{_dateRange:e,domain:i,field:r}=this,{max:n,min:s}=e,o=n!=null&&jK(n)?n.getTime():null,a=s!=null&&jK(s)?s.getTime():null,l=BB(i)||Loe(r);if(!l)return{max:o,min:a};const c=l.max===Number.MAX_VALUE?null:l.max,u=l.min===Number.MIN_VALUE?null:l.min;return{max:o!=null&&(c===null||c!=null&&o<c)?o:c,min:a!=null&&(u===null||u!=null&&a>u)?a:u}}get required(){const{editable:e,evaluatedRequiredExpression:i,field:r,visible:n}=this;return!!e&&((r==null?void 0:r.nullable)===!1||!(!n||i==null)&&i)}set required(e){this._overrideIfSome("required",e)}get submittable(){const{field:e,required:i,valid:r,value:n}=this;return(!i||n!=null)&&(!!r||this.initialFeature.getAttribute(e.name)===n)}get updating(){const{editableExpressionExecutor:e,valueExpressionExecutor:i}=this;return i!=null&&i.updating||e!=null&&e.updating}get valid(){const e=this.editable?this._validate():null;return this._set("error",e),e===null}get value(){if(this._shouldUseValueExpression){const e=this.evaluatedValueExpression;if(this.dataType===Nl.Date){if(e instanceof Date)return e.getTime();if(typeof e!="number")return parseInt(e,10)}return e!=null&&typeof e=="object"?e.toString():e}return this.get("_storedValue")}set value(e){this.notifyChange("evaluatedVisibilityExpression"),this.set("_storedValue",e)}get visible(){return!this._isEditTrackingField&&(this.evaluatedVisibilityExpression!=null?this.evaluatedVisibilityExpression:this.element!=null||this._isVisibleByDefault)}_isDomainCompatible(e){const{field:i}=this;if((e==null?void 0:e.type)==="coded-value"){const r=typeof e.codedValues[0].code;if(r==="string"&&rN(i)||r==="number"&&Cd(i))return!0}return!!((e==null?void 0:e.type)==="range"&&Cd(i)||Zk(i))}_validate(){const{dataType:e,domain:i,field:r,initialFeature:n,minLength:s,required:o,valid:a,value:l}=this,c=o&&l==null,u=a!==void 0;return!c&&n.getAttribute(r.name)===l&&u?null:c?n1.INVALID_TYPE:e==="text"&&s>-1&&typeof l=="string"&&l.length<s?qP.TOO_SHORT:i?l!==null||o?Toe(i,l):null:xEe(r,l)}};d([p()],St.prototype,"_storedValue",void 0),d([p()],St.prototype,"_configAllowsEdits",null),d([p()],St.prototype,"_layerAndFieldAllowEdits",null),d([p()],St.prototype,"_isVisibleByDefault",null),d([p()],St.prototype,"_isEditTrackingField",null),d([p()],St.prototype,"_shouldUseValueExpression",null),d([p()],St.prototype,"dataType",null),d([p()],St.prototype,"dateDataType",null),d([p()],St.prototype,"domain",null),d([p()],St.prototype,"editable",null),d([p({readOnly:!0})],St.prototype,"error",void 0),d([p()],St.prototype,"evaluatedRequiredExpression",null),d([p()],St.prototype,"evaluatedValueExpression",null),d([p()],St.prototype,"field",void 0),d([p()],St.prototype,"group",void 0),d([p({readOnly:!0})],St.prototype,"hint",null),d([p()],St.prototype,"includeDate",null),d([p()],St.prototype,"includeTime",null),d([p()],St.prototype,"includeTimestamp",null),d([p()],St.prototype,"initialFeature",null),d([p({readOnly:!0})],St.prototype,"inputType",null),d([p()],St.prototype,"label",null),d([p()],St.prototype,"maxLength",null),d([p()],St.prototype,"minLength",null),d([p({readOnly:!0})],St.prototype,"name",null),d([p()],St.prototype,"range",null),d([p()],St.prototype,"required",null),d([p()],St.prototype,"requiredExpressionExecutor",void 0),d([p()],St.prototype,"submittable",null),d([p({readOnly:!0})],St.prototype,"type",void 0),d([p()],St.prototype,"updating",null),d([p()],St.prototype,"valid",null),d([p({value:null})],St.prototype,"value",null),d([p()],St.prototype,"valueExpressionExecutor",void 0),d([p()],St.prototype,"visible",null),St=d([A("esri.widgets.FeatureForm.FieldInput")],St);const jK=t=>t&&!Number.isNaN(t.valueOf()),Mj=St,fqe=[{pattern:/^\s*(https?:\/\/([^\s]+))\s*$/i,target:"_blank",label:"{messages.view}"},{pattern:/^\s*(tel:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(mailto:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(arcgis-appstudio-player:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"App Studio Player"},{pattern:/^\s*(arcgis-collector:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Collector"},{pattern:/^\s*(arcgis-explorer:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Explorer"},{pattern:/^\s*(arcgis-navigator:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Navigator"},{pattern:/^\s*(arcgis-survey123:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Survey123"},{pattern:/^\s*(arcgis-trek2there:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Trek2There"},{pattern:/^\s*(arcgis-workforce:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Workforce"},{pattern:/^\s*(iform:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"iForm"},{pattern:/^\s*(flow:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"FlowFinity"},{pattern:/^\s*(lfmobile:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Laserfische"},{pattern:/^\s*(mspbi:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Microsoft Power Bi"}];function mqe(t){let e=null;return fqe.some(i=>(i.pattern.test(t)&&(e=i),!!e)),e}function z5(t,e){if(typeof e!="string"||!e)return e;const i=mqe(e);if(!i)return e;const r=e.match(i.pattern),n=r&&r[2],s=oc(oc(i.label,{messages:t,hierPart:n}),{appName:i.appName}),o=i.target?` target="${i.target}"`:"",a=i.target==="_blank"?' rel="noreferrer"':"";return e.replace(i.pattern,`<a${o} href="$1"${a}>${s}</a>`)}const BK="esri-editor-column__cell-input",UK={input:BK,inputContainer:`${BK}--container`},GK={showInput:"Enter",hideInput:"Escape"};let Ks=class extends aR{constructor(e){super(e),this.activeEditInfo=null,this.cellValueValidatorFunction=({oldValue:i,value:r})=>i!==r,this.editable=!1,this.inputRenderFunction=({root:i,column:r,rowData:n})=>{var l,c;if((l=this.activeEditInfo)!=null&&l.updating||!this.editable)return;const s=this.getCellValue(r,n),o=this.createInputElement({root:i,column:r,rowData:n,value:s});this._set("activeEditInfo",{column:r,input:o,root:i,rowData:n,updating:!0,oldValue:s});const a=this.createInputContainer();a.appendChild(o),this.removeCellContent(i),i.appendChild(a),o.focus(),o instanceof HTMLInputElement&&o.select(),(c=this.grid)==null||c.notifyResize()},this.loadingMessage="",this.inputType="text",this.maxLength=null,this.parseInputValueFunction=({input:i})=>i.value,this.renderFunction=i=>{var f;const{root:r,column:n,rowData:s}=i,{activeEditInfo:o}=this;if(o&&o.updating)return;const a=this.getCellValue(n,s),l=this.cellValueFormatFunction({column:n,rowData:s,value:a});r.onclick=()=>r.focus(),r.ondblclick=()=>this.inputRenderFunction(i),r.ontouchend=()=>this.inputRenderFunction(i);const c=(f=this.grid)==null?void 0:f.getSlotElementByName(r.slot),u=c==null?void 0:c.parentElement;u&&!u.onkeydown&&(u.onkeydown=m=>{m.key!==GK.showInput||this.activeEditInfo||this.inputRenderFunction(i),m.key===GK.hideInput&&this.activeEditInfo&&this.cancel()}),a!=null&&l!=null?r.title=l.toString():r.title&&r.removeAttribute("title");const h=z5(this.messagesURIUtils,l);(l==null?void 0:l.toString())!==r.innerHTML&&h!==r.innerHTML&&(r.innerHTML=h)},this.required=!1,this.store=null,this.updateRowItemFunction=({rowData:i,column:r,value:n})=>{lo(i),i.item[r.path]=n},this.updateStoreItemFunction=async({rowData:i,column:r,value:n})=>{var s;lo(i),await((s=this.store)==null?void 0:s.updateItem({index:i.index,name:r.path,value:n}))}}cancel(){var l;const{activeEditInfo:e}=this;if(!e)return;const{column:i,root:r,rowData:n,oldValue:s}=e;this._set("activeEditInfo",null);const o=this.cellValueFormatFunction({column:i,rowData:n,value:s}),a=z5(this.messagesURIUtils,o);r.innerHTML=a,(l=this.grid)==null||l.notifyResize()}createInputContainer(){const e=document.createElement("div");return e.classList.add(UK.inputContainer),e}createInputElement({value:e}){const i=document.createElement("input");return i.classList.add(UK.input),this.maxLength!=null&&(i.maxLength=this.maxLength),i.type=this.inputType,i.value=e,i.onblur=()=>{i.onblur=null,this.submit()},i}async submit(){var l,c;const{activeEditInfo:e}=this;if(!e)return;const{column:i,input:r,root:n,rowData:s,oldValue:o}=e,a=this.parseInputValueFunction({input:r,column:i,rowData:s});if(!this.cellValueValidatorFunction({value:a,oldValue:o,column:i,rowData:s}))this.cancel();else{n.innerHTML=this.loadingMessage,(l=this.grid)==null||l.notifyResize();try{await this.updateStoreItemFunction({rowData:s,column:i,value:a}),this.updateRowItemFunction({rowData:s,column:i,value:a});const u=this.getCellValue(i,s),h=this.cellValueFormatFunction({column:i,rowData:s,value:u});u!=null&&h!=null?n.title=h.toString():n.title&&n.removeAttribute("title");const f=z5(this.messagesURIUtils,h);n.innerHTML=f,this.emit("value-change",{column:i,rowData:s,value:u}),this._set("activeEditInfo",null),(c=this.grid)==null||c.notifyResize()}catch{this.cancel()}}}};d([p({readOnly:!0})],Ks.prototype,"activeEditInfo",void 0),d([p()],Ks.prototype,"cellValueValidatorFunction",void 0),d([p()],Ks.prototype,"editable",void 0),d([p()],Ks.prototype,"inputRenderFunction",void 0),d([p({constructOnly:!0})],Ks.prototype,"loadingMessage",void 0),d([p()],Ks.prototype,"inputType",void 0),d([p()],Ks.prototype,"maxLength",void 0),d([p()],Ks.prototype,"parseInputValueFunction",void 0),d([p()],Ks.prototype,"renderFunction",void 0),d([p()],Ks.prototype,"required",void 0),d([p()],Ks.prototype,"store",void 0),d([p()],Ks.prototype,"updateRowItemFunction",void 0),d([p()],Ks.prototype,"updateStoreItemFunction",void 0),Ks=d([A("esri.widgets.FeatureTable.Grid.EditorColumn")],Ks);const gqe=Ks;function yqe(t,e){const i=Fae(e),r=Date.now(),n=i.formatToParts(r),s=new Set;n.filter(({type:c})=>c==="literal").forEach(({value:c})=>s.add(c));let o=0;const a={};for(;n.length>0;){const{type:c,value:u}=n.shift();for(let h=0;h<u.length;h++,o++){const f=t.charAt(o);if(s.has(f)){o++;break}if(c==="literal")break;a[c]||(a[c]=[]),a[c].push(f)}}const l={};try{l.day=j5(a.day.join("")),l.month=j5(a.month.join("")),l.year=j5((a.year||a.relatedYear).join(""))}catch{throw HK(e)}if(isNaN(l.day)||isNaN(l.month)||isNaN(l.year))throw HK(e);return l}function j5(t){const e=[/٠/g,/١/g,/٢/g,/٣/g,/٤/g,/٥/g,/٦/g,/٧/g,/٨/g,/٩/g];for(let i=0;i<10;i++)t=t.replace(e[i],i.toString());return Number(t)}function HK(t){return new N(`could not parse date input, expecting the following format: ${Oi(Date.now(),t)}`)}const jx={ar:6,"ar-dz":6,"ar-kw":6,"ar-ly":6,"ar-ma":1,"ar-sa":7,"ar-tn":1,bg:1,bs:1,ca:1,cs:1,da:1,de:1,"de-at":1,"de-ch":1,el:1,"en-au":1,"en-ca":7,"en-gb":1,"en-ie":1,"en-il":7,"en-in":7,"en-nz":1,"en-sg":7,es:1,"es-do":7,"es-mx":7,"es-us":7,et:1,fi:1,fr:1,"fr-ca":7,"fr-ch":1,he:7,hr:1,hu:1,id:7,it:1,"it-ch":1,ja:7,ko:7,lt:1,lv:1,nb:1,nl:1,"nl-be":1,pl:1,pt:7,"pt-br":7,ro:1,ru:1,sk:1,sl:1,sr:1,"sr-cyrl":1,sv:1,th:7,tr:1,uk:1,vi:1,"zh-cn":1,"zh-hk":7,"zh-mo":7,"zh-tw":7},vqe="Locale"in Intl&&"weekInfo"in Intl.Locale.prototype;function wme(t){if(t=t.toLowerCase(),jx[t])return jx[t];if(vqe)try{const i=new Intl.Locale(t).weekInfo.firstDay;return jx[t]=i,i}catch{}const e=_Ie(t);return jx[e]?jx[e]:7}function _qe(t,e){return(e+7-wme(t))%7}let g2=class extends he{constructor(){super(...arguments),this.state="ready",this.value=new Date}};d([p()],g2.prototype,"state",void 0),d([p()],g2.prototype,"value",void 0),g2=d([A("esri.widgets.support.DateTimeElementViewModel")],g2);const xme=g2;let $j=class extends xme{constructor(e){super(e)}};$j=d([A("esri.widgets.support.DatePickerViewModel")],$j);const Sme=$j,dn="esri-date-picker",Pt={base:dn,datePicker:`${dn}__calendar`,monthPicker:`${dn}__month-picker`,dayPicker:`${dn}__day-picker`,week:`${dn}__week-item`,nearbyMonth:`${dn}__day-item--nearby-month`,activeDay:`${dn}__day-item--active`,today:`${dn}__day-item--today`,selectedDay:`${dn}__day-item--selected`,day:`${dn}__day-item`,dayHeader:`${dn}__day-item--header`,yearPicker:`${dn}__year-picker`,selectedYear:`${dn}__year-picker-item--selected`,year:`${dn}__year-picker-item`,monthDropdown:`${dn}__month-dropdown`,date:`${dn}__date`,datePickerToggle:`${dn}__calendar-toggle`,dateInput:`${dn}__input`,dateTextInput:`${dn}__text-input`,leadingIcon:`${dn}__icon--leading`,previousIcon:"esri-icon-left",nextIcon:"esri-icon-right",calendarIcon:"esri-icon-calendar",widget:"esri-widget",button:"esri-widget--button",input:"esri-input",select:"esri-select"},x_={year:"numeric",month:"2-digit",day:"2-digit"},bqe=[" ","ArrowDown","ArrowLeft","ArrowRight","ArrowUp","End","Enter","Home","PageDown","PageUp"];let Cs=class extends di{constructor(e,i){super(e,i),this._calendarNode=null,this._inputOrButtonNode=null,this._rootNode=null,this._requestDayPickerFocusOnCreate=!1,this._activeDate=null,this._calendarPopover=new yG({owner:this,placement:"bottom-start",anchorElement:()=>this._rootNode,renderContentFunction:this._renderCalendar}),this._isOpen=!1,this.dateInputEnabled=!1,this.messages=null,this.commitOnMonthChange=!1,this.viewModel=new Sme,this.disabled=!1,this.toggle=this.toggle.bind(this)}initialize(){this.addHandles(J(()=>{var e;return{viewModel:this.viewModel,value:(e=this.viewModel)==null?void 0:e.value}},({viewModel:e,value:i})=>{!this.destroyed&&e&&this.onChange!=null&&this.onChange(i)},Ca))}destroy(){this._calendarPopover.destroy()}get value(){return this.viewModel.value}set value(e){this.viewModel.value=e}get isOpen(){return this._isOpen}render(){return M("div",{afterCreate:Ed,bind:this,class:this.classes(Pt.base,Pt.widget),"data-node-ref":"_rootNode"},this.dateInputEnabled?this._renderInputAndButtonMode():this._renderButtonOnlyMode())}toggle(){this._isOpen?this.close():this.open()}open(e=!0){this._activeDate=Ae.fromJSDate(this.viewModel.value),this._isOpen=!0,this._calendarPopover.open=!0,this._requestDayPickerFocusOnCreate=e}close(e=!0){var i;this._activeDate=null,this._isOpen=!1,this._calendarPopover.open=!1,e&&((i=this._inputOrButtonNode)==null||i.focus())}_renderButtonOnlyMode(){const e=Oi(this.viewModel.value,x_),{disabled:i,_isOpen:r,messages:n}=this;return M("div",{key:`date-button-${i}`,afterCreate:Ed,"aria-controls":r?this._getCalendarId():null,"aria-expanded":r.toString(),"aria-haspopup":"true","aria-label":n.setDate,"aria-pressed":r.toString(),bind:this,class:this.classes(Pt.button,Pt.select,Pt.datePickerToggle),"data-node-ref":"_inputOrButtonNode",onclick:this.toggle,onkeydown:this._handleDateButtonKeyDown,role:"button",tabIndex:i?void 0:0},M("span",{class:Pt.date},e))}_renderInputAndButtonMode(){const e=Oi(this.viewModel.value,x_),{_isOpen:i,messages:r}=this;return M("div",{class:this.classes(Pt.dateInput)},M("input",{afterCreate:Ed,"data-node-ref":"_inputOrButtonNode","aria-controls":i?this._getCalendarId():null,"aria-haspopup":"true","aria-label":r.setDate,bind:this,class:this.classes(Pt.dateTextInput,Pt.input),key:"date-input",onblur:this._handleDateInputBlur,onclick:this._handleDateInputClick,onkeydown:this._handleDateInputKeyDown,type:"text",value:e}),M("span",{"aria-hidden":"true",class:this.classes(Pt.leadingIcon,Pt.calendarIcon)}))}_handleDateInputClick(){this.open(!1)}_handleDateInputKeyDown(e){const{key:i}=e;this._isOpen?i==="Enter"?this._handleDateText(e):i==="Escape"&&this.close():i==="ArrowDown"&&(this.open(),e.preventDefault())}_handleDateButtonKeyDown(e){const{key:i,shiftKey:r}=e;this._isOpen&&i==="Tab"&&r?this.close():W0(i)&&this.toggle()}_handleDateInputBlur(e){this._isOpen||this._handleDateText(e)}_handleDateText(e){const i=e.currentTarget;let r;try{r=yqe(i.value,x_)}catch(s){return ie.getLogger(this).warn(s),void(i.value=Oi(this.viewModel.value,x_))}const n=Ae.fromObject(r);n.isValid?(this.viewModel.value=n.toJSDate(),this._activeDate=n):i.value=Oi(this.viewModel.value,x_)}_handleDatePickerKeydown(e){ip(e)==="Escape"&&(this.close(),e.preventDefault(),e.stopPropagation())}_renderCalendar(){const e=this._activeDate;if(!e)return null;const i=Ae.fromJSDate(this.viewModel.value);return M("div",{afterCreate:Ed,bind:this,class:this.classes(Pt.datePicker,Pt.widget),"data-node-ref":"_calendarNode",id:this._getCalendarId(),key:"esri-date-picker__calendar",tabIndex:-1,onfocusout:this._onCalendarFocusOut,onkeydown:this._handleDatePickerKeydown},this._renderMonthPicker(e),this._renderDayPicker(e,i),this._renderYearPicker(e))}_getCalendarId(){return`date-picker__calendar--${this.id}`}_onCalendarFocusOut(e){var r,n;const i=e.relatedTarget;i&&i instanceof Node&&((r=this._calendarNode)!=null&&r.contains(i)||(n=this._rootNode)!=null&&n.contains(i))||this.close(!1)}_renderMonthPicker(e){const i=ll(this.container),r=i?Pt.nextIcon:Pt.previousIcon,n=i?Pt.previousIcon:Pt.nextIcon,s=wS.months("long",{locale:Mn()}).map((l,c)=>{const u=e.month-1===c;return M("option",{selected:u,value:c.toString()},l)}),{disabled:o,messages:a}=this;return M("div",{class:Pt.monthPicker},M("div",{key:`previous-month-${o}`,"aria-label":a.goToPreviousMonth,bind:this,class:Pt.button,onclick:this._setPreviousMonth,onkeydown:this._handlePreviousMonthKeyDown,role:"button",tabIndex:o?void 0:0,title:a.goToPreviousMonth},M("span",{"aria-hidden":"true",class:r})),M("select",{"aria-live":"assertive","aria-label":a.selectMonth,bind:this,class:this.classes(Pt.monthDropdown,Pt.select),disabled:o,id:`${this.id}__month-picker`,onchange:this._setMonth,onkeydown:this._setMonth,title:a.selectMonth},s),M("div",{key:`next-month-${o}`,"aria-label":a.goToNextMonth,bind:this,class:Pt.button,onclick:this._setNextMonth,onkeydown:this._setNextMonth,role:"button",tabIndex:o?void 0:0,title:a.goToNextMonth},M("span",{"aria-hidden":"true",class:n})))}_renderDayPicker(e,i){const r=this._getWeekLabels(),n=this._getDayId(e),s=this._renderMonth(e,i),{id:o,disabled:a}=this;return M("div",{key:`day-picker-${a}`,afterCreate:this._handleDayPickerCreate,"aria-activedescendant":n,"aria-labelledby":`${o}__month-picker ${o}__selected-year`,bind:this,class:Pt.dayPicker,id:`${o}__day-picker`,onkeydown:this._handleDayPickerKeydown,role:"grid",tabIndex:a?void 0:0},M("div",{class:Pt.week,role:"row"},r.map(l=>M("div",{"aria-label":l.name,class:this.classes(Pt.day,Pt.dayHeader),role:"columnheader",title:l.name},l.abbr))),s)}_getDayId(e){return`${this.id}__${Oi(e.valueOf(),x_)}`}_handleDayPickerCreate(e){this._requestDayPickerFocusOnCreate&&(this._requestDayPickerFocusOnCreate=!1,e.focus())}_getWeekLabels(){const e=[],i={weekday:"long"},r={weekday:"narrow"};let n=Ae.now().set({weekday:wme(Mn())});for(let s=0;s<7;s++)e.push({name:Oi(n.valueOf(),i),abbr:Oi(n.valueOf(),r)}),n=n.plus({day:1});return e}_handleDayPickerKeydown(e){const{ctrlKey:i,shiftKey:r}=e,n=ip(e);if(!bqe.includes(n))return;let s=this._activeDate;if(s){if(n==="ArrowLeft")s=s.minus({day:1});else if(n==="ArrowRight")s=s.plus({day:1});else if(n==="ArrowUp")s=s.minus({week:1});else if(n==="ArrowDown")s=s.plus({week:1});else if(n==="PageUp"){const o=r?"year":"month";s=s.minus({[o]:1})}else if(n==="PageDown"){const o=r?"year":"month";s=s.plus({[o]:1})}else if(n==="Home"){const o=i?"year":"month";s=s.startOf(o)}else if(n==="End"){const o=i?"year":"month";s=s.endOf(o)}else W0(n)&&(this.viewModel.value=s.toJSDate(),this.close());this._activeDate=s,e.preventDefault(),e.stopPropagation()}}_renderMonth(e,i){const r=Ae.now(),n=e.startOf("month"),s=e.endOf("month"),o=6,a=7;let l=n.minus({day:_qe(Mn(),n.weekday)});const c=[];for(let u=0;u<o;u++){const h=[];for(let f=0;f<a;f++){const m=l.day,g=l.hasSame(e,"day"),y=l.hasSame(i,"day"),v=this._getDayId(l),b=kr.fromDateTimes(n,s),w={[Pt.nearbyMonth]:!b.contains(l),[Pt.today]:l.hasSame(r,"day"),[Pt.activeDay]:g,[Pt.selectedDay]:y};h.push(M("div",{"aria-label":m.toString(),"aria-selected":g.toString(),bind:this,class:this.classes(Pt.day,w),"data-iso-date":l.toISO(),id:v,onclick:this._handleSelectedDate,onkeydown:this._handleSelectedDate,role:"gridcell"},m)),l=l.plus({day:1})}c.push(M("div",{class:Pt.week,role:"row"},h))}return c}_renderYearPicker(e){const i={year:"numeric"},r=e,n=Oi(r.valueOf(),i),s=Oi(r.plus({year:1}).valueOf(),i),o=Oi(r.minus({year:1}).valueOf(),i),{disabled:a,messages:l}=this;return M("div",{class:Pt.yearPicker},M("div",{key:`previous-year-${a}`,"aria-label":l.goToPreviousYear,bind:this,class:Pt.year,onclick:this._setPreviousYear,onkeydown:this._setPreviousYear,tabIndex:a?void 0:0,title:l.goToPreviousYear},o),M("div",{class:this.classes(Pt.year,Pt.selectedYear),id:`${this.id}__selected-year`},n),M("div",{key:`next-year-${a}`,"aria-label":l.goToNextYear,bind:this,class:Pt.year,onclick:this._setNextYear,onkeydown:this._handleNextYearKeyDown,tabIndex:a?void 0:0,title:l.goToNextYear},s))}_setMonth(e){const i=e.target,r=Number(i.value)+1;this._activeDate&&(this._activeDate=this._activeDate.set({month:r}),this.commitOnMonthChange&&(this.viewModel.value=this._activeDate.toJSDate()))}_setPreviousMonth(){this._activeDate&&(this._activeDate=this._activeDate.minus({month:1}),this.commitOnMonthChange&&(this.viewModel.value=this._activeDate.toJSDate()))}_handlePreviousMonthKeyDown(e){if(e.key==="Tab"&&e.shiftKey)return e.preventDefault(),void this.close();W0(e.key)&&this._setPreviousMonth()}_setNextMonth(){this._activeDate&&(this._activeDate=this._activeDate.plus({month:1}),this.commitOnMonthChange&&(this.viewModel.value=this._activeDate.toJSDate()))}_setPreviousYear(){var e;this._activeDate=((e=this._activeDate)==null?void 0:e.minus({year:1}))??null}_setNextYear(){var e;this._activeDate=((e=this._activeDate)==null?void 0:e.plus({year:1}))??null}_handleNextYearKeyDown(e){if(e.key==="Tab"&&!e.shiftKey)return e.preventDefault(),void this.close();W0(e.key)&&this._setNextYear()}_handleSelectedDate(e){const i=e.target;this.viewModel.value=Ae.fromISO(i.getAttribute("data-iso-date")).toJSDate(),this.close()}};d([p()],Cs.prototype,"_activeDate",void 0),d([p()],Cs.prototype,"_calendarPopover",void 0),d([p()],Cs.prototype,"_isOpen",void 0),d([p()],Cs.prototype,"dateInputEnabled",void 0),d([p(),ut("esri/widgets/support/t9n/DatePicker")],Cs.prototype,"messages",void 0),d([p()],Cs.prototype,"value",null),d([p()],Cs.prototype,"commitOnMonthChange",void 0),d([p({type:Sme})],Cs.prototype,"viewModel",void 0),d([p()],Cs.prototype,"onChange",void 0),d([p()],Cs.prototype,"disabled",void 0),d([p()],Cs.prototype,"isOpen",null),d([wr()],Cs.prototype,"_setNextMonth",null),d([wr()],Cs.prototype,"_setPreviousYear",null),d([wr()],Cs.prototype,"_handleSelectedDate",null),Cs=d([A("esri.widgets.support.DatePicker")],Cs);const wqe=Cs;let Aj=class extends xme{constructor(e){super(e)}};Aj=d([A("esri.widgets.support.TimePickerViewModel")],Aj);const Ime=Aj,B5="esri-time-picker",U5={base:`${B5} esri-widget`,timePicker:`${B5}__date-picker`,timePickerInput:`${B5}__input`,input:"esri-input",button:"esri-widget--button"},kj={hour:"numeric",minute:"numeric"},qK="t",xqe=["ArrowDown","ArrowLeft","ArrowRight","ArrowUp","Tab"];function WK(t){return t!=null&&Oi(t.valueOf(),kj).includes(" ")}let Fb=class extends di{constructor(e,i){super(e,i),this._activePart=null,this._activeTime=null,this.messages=null,this.viewModel=new Ime}get value(){return this.viewModel.value}set value(e){this.viewModel.value=e}render(){const e=this._activeTime||this.viewModel.value;return M("div",{class:U5.base},M("input",{afterUpdate:this._handleInputUpdate,"aria-label":this.messages.inputTitle,bind:this,class:this.classes(U5.timePickerInput,U5.input),onblur:this._handleInputBlur,onfocus:this._handleInputFocus,onkeydown:this._handleInputKeydown,oninput:this._handleInputKeydown,onclick:this._handleInputClick,onpaste:this._handleInputPaste,onwheel:this._handleInputWheel,value:Oi(e.valueOf(),kj)}))}_handleInputBlur(){var e;(e=this._activeTime)!=null&&e.isValid&&(this.viewModel.value=this._activeTime.toJSDate()),this._activeTime=null,this._activePart=null}_handleInputUpdate(e){this._selectPart(e,this._activePart)}_selectPart(e,i){const r=this._activeTime;if(!r||!e)return;const n=Oi(r.valueOf(),kj),s=0,o=n.indexOf(":");if(i==="hours")return void e.setSelectionRange(s,o);const a=o+1,l=a+2;if(i==="minutes")return void e.setSelectionRange(a,l);const c=l+1,u=n.length;i!=="meridiem"||e.setSelectionRange(c,u)}_handleInputFocus(e){this._activePart="hours",this._activeTime=Ae.fromJSDate(this.viewModel.value).startOf("minute"),this._selectPart(e.target,"hours")}_caretIndexToPartName(e){var s;const i=(s=this._activeTime)==null?void 0:s.toFormat(qK,{locale:Mn(),numberingSystem:"latn"});if(!i)return null;const r=i.indexOf(":"),n=i.indexOf(" ");return e<=r?"hours":e>r&&e<=n?"minutes":"meridiem"}_handleInputKeydown(e){const{ctrlKey:i,metaKey:r,shiftKey:n}=e,s=ip(e),o=this._activeTime,a=this._activePart,l=/\d/.test(s),c=/^a|p$/i.test(s),u=r||i;if((xqe.includes(s)||l||a==="meridiem"&&c&&!u)&&o!=null){if(s==="ArrowLeft")this._activePart=this._prevPart();else if(s==="ArrowRight")this._activePart=this._nextPart();else if(s==="Tab"){const h=n?this._prevPart():this._nextPart();if(h===this._activePart)return;this._activePart=h}else if(s==="ArrowUp")this._shift("up",a);else if(s==="ArrowDown")this._shift("down",a);else if(l)this._setTime(o,a,Number(s));else if(c){const h=s.toLowerCase(),f=o.hour;(h==="a"&&f>=12||h==="p"&&f<12)&&this._shift("up",a)}e.preventDefault(),e.stopImmediatePropagation()}else u||(e.preventDefault(),e.stopImmediatePropagation())}_handleInputClick(e){const i=e.target;this._activePart=null,this.renderNow(),this._activePart=this._caretIndexToPartName(i.selectionStart??0)}_getOrderedParts(){return WK(this._activeTime)?["hours","minutes","meridiem"]:["hours","minutes"]}_prevPart(){const e=this._getOrderedParts(),i=this._activePart?e.indexOf(this._activePart)-1:0;return e[Math.max(i,0)]}_nextPart(){const e=this._getOrderedParts(),i=this._activePart?e.indexOf(this._activePart)+1:0;return e[Math.min(i,e.length-1)]}_setTime(e,i,r){if(i==="hours"){const n=WK(e)?12:24,s=""+e.hour%n,o=r,a=+`${s}${r}`;s.length===2||a>n?this._activeTime=e.set({hour:o}):a<=n&&(this._activeTime=e.set({hour:a}))}else if(i==="minutes"){const s=`${e.minute}`,o=r,a=+`${s}${r}`;s.length===2||a>59?this._activeTime=e.set({minute:o}):a<59&&(this._activeTime=e.set({minute:a}))}}_parseTime(e){if(!e)return null;const i={locale:Mn(),numberingSystem:"latn"};let r=Ae.fromFormat(e,qK,i);return r.isValid?r:(r=Ae.fromISO(e,i),r.isValid?r:(r=Ae.fromRFC2822(e,i),r.isValid?r:(r=Ae.fromJSDate(new Date(e)),r.isValid?r:null)))}_handleInputPaste(e){var n;const i=(n=e.clipboardData)==null?void 0:n.getData("text/plain"),r=this._parseTime(i);r&&(this._activeTime=r),e.preventDefault(),e.stopImmediatePropagation()}_handleInputWheel(e){const i=e.deltaY<0?"up":"down";this._shift(i,this._activePart)}_shift(e,i){var o;if(!i)return;const r=e==="up"?"plus":"minus",n=i==="meridiem"?12:1,s=i==="hours"?"hour":i==="minutes"?"minute":"hours";this._activeTime=((o=this._activeTime)==null?void 0:o[r]({[s]:n}))??null}};d([p(),ut("esri/widgets/support/t9n/TimePicker")],Fb.prototype,"messages",void 0),d([p()],Fb.prototype,"value",null),d([p({type:Ime})],Fb.prototype,"viewModel",void 0),Fb=d([A("esri.widgets.support.TimePicker")],Fb);const Sqe=Fb,Iqe={cancelEdit:"Escape"},Hg="esri-field-column",Tc={headerContent:`${Hg}__header-content`,headerLabel:`${Hg}__header-label`,input:`${Hg}__cell-input`,inputContainer:`${Hg}__cell__input-container`,dateInputContainer:`${Hg}__cell__date-input-container`,dateInputWrapper:`${Hg}__cell__date-input-wrapper`,button:`${Hg}__button`,saveIcon:"esri-icon-save",trashIcon:"esri-icon-trash",locked:"esri-icon-locked"},Tqe=Zh("short-date-short-time"),Cqe=Zh("short-date"),Eqe={useGrouping:!0,maximumFractionDigits:20};let ni=class extends gqe{constructor(e){super(e),this._inputField=null,this.cellValueFormatFunction=({rowData:i,value:r})=>{var l,c;if(this.formatFunction){const{config:u,field:h}=this;return this.formatFunction({config:u,field:h,value:Km.sanitize(r)})}if(r===null)return"&nbsp;";const{config:n,field:s}=this,o=(l=i==null?void 0:i.item)==null?void 0:l.feature,a=this._getDomainForFeature(o);if(a)return this._getComputedDomain(r,a);if(s.type==="date"){const u=this._getDateFormatOptions(),h=((c=this.layer)==null?void 0:c.type)==="feature"&&this.layer.datesInUnknownTimezone?{timeZone:"UTC"}:null;return r?Oi(r,{...u,...h}):null}if(Cj.has(s.type)&&r){const u=vG(s,r);return Km.sanitize(u)}if(Cd(s)){const u=n!=null&&n.format?aU(n.format):Eqe;return po(parseFloat(r),u)}return Km.sanitize(r)},this.cellValueValidatorFunction=({oldValue:i,value:r})=>!(this._inputField&&!this._inputField.valid)&&(!this.required||r!=null&&r!=="")&&i!==r,this.config=null,this.editingEnabled=!1,this.expressionInfos=null,this.field=null,this.formatFunction=null,this.headerRenderFunction=i=>{const{root:r}=i,{editable:n,editingEnabled:s,headerMenuEnabled:o,sortable:a}=this;if(this.removeCellContent(r),r.classList.add(Tc.headerContent),s&&!n&&r.appendChild(this.createLockedElement()),a)this.headerSorterRenderFunction(i);else{const l=document.createElement("div");l.classList.add(Tc.headerLabel),l.textContent=this.label,r.appendChild(l)}o&&this.headerMenuRenderFunction(i)},this.inputRenderFunction=({root:i,column:r,rowData:n})=>{var l,c;if((l=this.activeEditInfo)!=null&&l.updating||!this.editable)return;const s=this.getCellValue(r,n),o=this.createInputElement({root:i,column:r,rowData:n,value:s});if(this._set("activeEditInfo",{column:r,input:o,root:i,rowData:n,updating:!0,oldValue:s}),this.field.type==="date")return void this._renderDateEditors(s,i,o);const a=this.createInputContainer();a.appendChild(o),this.removeCellContent(i),i.appendChild(a),o.focus(),o instanceof HTMLInputElement&&o.select(),(c=this.grid)==null||c.notifyResize()},this.layer=null,this.parseInputValueFunction=({input:i})=>{const r=this._inputField;if(!r)return null;const n=i.value,{dataType:s,required:o}=r;return o||n!==""?s==="number"||s==="date"?parseFloat(n):s==="text"?n.trim():n:null},this.store=null,this.template=null,this.updateRowItemFunction=({rowData:i,column:r,value:n})=>{i&&(i.item.feature.attributes[r.path]=n)},this.updateStoreItemFunction=async({rowData:i,column:r,value:n})=>{if(!i||!this.store)return;const s=i.item.objectId,o=this.store.getObjectIdIndex(s)??i.index;await this.store.updateItem({index:o,name:r.path,value:n})}}get alias(){var e;return(e=this.field)==null?void 0:e.alias}get defaultValue(){var e;return(e=this.field)==null?void 0:e.defaultValue}get description(){var e,i,r;return((e=this.template)==null?void 0:e.description)??((i=this.config)==null?void 0:i.description)??((r=this.field)==null?void 0:r.description)??null}get editable(){const{config:e,editingEnabled:i,field:r,layer:n,template:s}=this;if(r==null||n==null)return!1;const o=aC(n),a=Ro(n),l=a==null?void 0:a.operations.supportsUpdate;return!!(r.editable&&o&&l)&&!Cj.has(r.type)&&(i?!((s==null?void 0:s.editable)===!1||(e==null?void 0:e.editable)===!1):!(!(s!=null&&s.editable)&&!(e!=null&&e.editable)))}get header(){var e,i;return((e=this.template)==null?void 0:e.label)||((i=this.config)==null?void 0:i.label)||this.alias||this.path||null}get hidden(){const{config:e}=this;return(e==null?void 0:e.visible)===!1||this._get("hidden")||!1}set hidden(e){this._set("hidden",e)}get loadingMessage(){var e;return((e=this.messages)==null?void 0:e.loading)||"..."}get maxLength(){const{field:e,config:i,template:r}=this,n=e==null?void 0:e.length,s=r!=null&&r.input&&"maxLength"in r.input?r.input.maxLength:i==null?void 0:i.maxLength;return s!=null&&!isNaN(s)&&s>=-1&&(n===-1||s<=n)?s:n}get minLength(){const{config:e,template:i,maxLength:r}=this,n=i!=null&&i.input&&"minLength"in i.input?i.input.minLength:(e==null?void 0:e.minLength)||null;return r&&n<=r?n:null}get name(){var e;return(e=this.field)==null?void 0:e.name}get nullable(){var e;return((e=this.field)==null?void 0:e.nullable)??!1}get path(){var e;return(e=this.field)==null?void 0:e.name}get required(){const{config:e,field:i,template:r}=this,n=i==null?void 0:i.nullable,s=e==null?void 0:e.required,o=r==null?void 0:r.required;return this.editable&&(!n||s===!0||o===!0)}get sortable(){var e,i;return this.template?((e=this.template)==null?void 0:e.sortable)!==!1:((i=this.config)==null?void 0:i.sortable)!==!1}createInputElement({rowData:e,value:i}){const r=e==null?void 0:e.item;if(!r||!r.feature)return null;this._inputField=this._setUpInputField(r.feature,i);const{field:n,maxLength:s,minLength:o,required:a}=this,{domain:l}=this._inputField;let c;(l==null?void 0:l.type)==="coded-value"?(c=this._createSelectElement(i,l.codedValues.map(({code:f,name:m})=>({value:f,name:m})),this._inputField),c.onchange=()=>{c.onblur=null,h()}):(c=document.createElement("input"),c.type=Cd(n)?"number":"text",s>-1&&(c.maxLength=s),o>0&&(c.minLength=o)),c.classList.add(Tc.input),c.value=i,c.required=a;let u=!1;c.onkeydown=f=>{u=f.key===Iqe.cancelEdit},c.onblur=()=>{c.onblur=null,h()};const h=()=>{u?this.cancel():this.submit(),this._inputField=null};return c}createInputContainer(){const e=document.createElement("div");return e.classList.add(Tc.inputContainer),e}createLockedElement(){const e=document.createElement("div");return e.classList.add(Tc.locked),e}getCellValue({path:e},i){var r,n,s;return((s=(n=(r=i==null?void 0:i.item)==null?void 0:r.feature)==null?void 0:n.attributes)==null?void 0:s[e])??null}_renderDateEditors(e,i,r){var S;const{config:n,messagesCommon:s,template:o}=this,a=e?new Date(e):new Date(Date.now()),l=new wqe({dateInputEnabled:!0,value:a}),c=new Sqe({value:a});r.value=a.getTime().toString();let u=!e;const h=()=>{u=!0;const I=this._getCombinedDateTime(l.value,c.value);r.value=I.getTime().toString()},f=()=>{u?this.submit():this.cancel()},m=()=>{r.value=null,this.submit()};J(()=>[l.value,c.value],()=>h());const g=document.createElement("div"),y=document.createElement("div");l.container=g,c.container=y;const v=document.createElement("button");v.classList.add(Tc.button,Tc.saveIcon),v.onclick=()=>f(),v.title=s==null?void 0:s.save;const b=document.createElement("button");b.classList.add(Tc.button,Tc.trashIcon),b.onclick=()=>m(),b.title=s==null?void 0:s.clear;const w=document.createElement("div");w.classList.add(Tc.dateInputWrapper),w.appendChild(g),(o&&o.input&&o.input.type==="datetime-picker"&&o.input.includeTime!==!1||n&&n.includeTime!==!1)&&w.appendChild(y);const x=document.createElement("div");x.classList.add(Tc.dateInputContainer),x.appendChild(w),x.appendChild(v),x.appendChild(b),l.when(()=>{var T;const I=l._inputOrButtonNode;I&&(I.onblur=C=>{const E=C.relatedTarget;E&&E.className.includes("esri-date-picker")||l.close(!1)}),(T=this.grid)==null||T.notifyResize()}),c.when(()=>{var I;return(I=this.grid)==null?void 0:I.notifyResize()}),this.removeCellContent(i),i.appendChild(x),(S=this.grid)==null||S.notifyResize()}_createSelectElement(e,i,r){let n=!1;const s=i.map(a=>{a.value===e&&(n=!0);const l=document.createElement("option");return l.text=a.name,l.value=a.value,l});if(e!=null&&e!==""&&!n){const a=document.createElement("option");a.text=e,a.value=e,s.unshift(a)}if(!r.required&&r.value==null){const a=document.createElement("option");a.value="",s.unshift(a)}const o=document.createElement("select");return s.forEach(a=>o.add(a)),o.value=e,o}_setUpInputField(e,i){const{field:r,layer:n}=this,s=new Mj({feature:e,initialFeature:e.clone(),field:r,layer:n});return s.set("value",i),s}_isDomainCompatible(e){const{field:i}=this;if(e&&e.type==="coded-value"){const r=typeof e.codedValues[0].code;if(r==="string"&&rN(i)||r==="number"&&Cd(i))return!0}return!(!e||e.type!=="range"||!Cd(i))}_getDomainForFeature(e){var h;const{config:i,layer:r,name:n,template:s}=this;if(!r||r.type==="wfs"||r.type==="geojson"||r.type==="csv")return null;if(s!=null&&s.domain&&this._isDomainCompatible(s.domain))return s.domain;const{typeIdField:o}=r,a=o===n,l=this.field.domain;if(a&&!l)return new NL({name:"__internal-type-based-coded-value-domain__",codedValues:(h=r.types)==null?void 0:h.map(({id:f,name:m})=>({code:f,name:m}))});const c=o&&n!=null&&r.getFieldDomain(n,{feature:e})||l,u=i==null?void 0:i.domain;return this._isDomainCompatible(u)?u:c}_getComputedDomain(e,i){if(!i)return null;if(i.type==="range")return e;if(i.type==="coded-value"){const r=i.codedValues.filter(n=>n.hasOwnProperty("code")&&n.code===e);return r&&r.length?r[0].name:e}return null}_getCombinedDateTime(e,i){return new Date(e.getFullYear(),e.getMonth(),e.getDate(),i.getHours(),i.getMinutes(),i.getSeconds())}_getDateFormatOptions(){var n,s;const{config:e,template:i}=this,r=((n=i==null?void 0:i.format)==null?void 0:n.dateFormat)||((s=e==null?void 0:e.format)==null?void 0:s.dateFormat);return r?Zh(r):i&&i.input&&!("includeTime"in i.input)||(e==null?void 0:e.includeTime)===!1?Cqe:Tqe}};d([p({readOnly:!0})],ni.prototype,"alias",null),d([p()],ni.prototype,"cellValueFormatFunction",void 0),d([p()],ni.prototype,"cellValueValidatorFunction",void 0),d([p()],ni.prototype,"config",void 0),d([p({readOnly:!0})],ni.prototype,"defaultValue",null),d([p({readOnly:!0})],ni.prototype,"description",null),d([p({readOnly:!0})],ni.prototype,"editable",null),d([p()],ni.prototype,"editingEnabled",void 0),d([p()],ni.prototype,"expressionInfos",void 0),d([p()],ni.prototype,"field",void 0),d([p()],ni.prototype,"formatFunction",void 0),d([p({readOnly:!0})],ni.prototype,"header",null),d([p()],ni.prototype,"hidden",null),d([p()],ni.prototype,"headerRenderFunction",void 0),d([p()],ni.prototype,"inputRenderFunction",void 0),d([p()],ni.prototype,"layer",void 0),d([p({readOnly:!0})],ni.prototype,"loadingMessage",null),d([p()],ni.prototype,"maxLength",null),d([p()],ni.prototype,"minLength",null),d([p({readOnly:!0})],ni.prototype,"name",null),d([p({readOnly:!0})],ni.prototype,"nullable",null),d([p()],ni.prototype,"parseInputValueFunction",void 0),d([p({readOnly:!0})],ni.prototype,"path",null),d([p({readOnly:!0})],ni.prototype,"required",null),d([p()],ni.prototype,"sortable",null),d([p()],ni.prototype,"store",void 0),d([p()],ni.prototype,"template",void 0),d([p()],ni.prototype,"updateRowItemFunction",void 0),d([p()],ni.prototype,"updateStoreItemFunction",void 0),ni=d([A("esri.widgets.FeatureTable.FieldColumn")],ni);const G5=ni;let sa=class extends he{constructor(e){super(e),this.cellClassNameGenerator=null,this.columnReorderingEnabled=!0,this.columns=new ye,this.dataProvider=async({page:i,pageSize:r},n)=>{const{store:s}=this;n&&(s?n(await s.fetchItems({page:i,pageSize:r})):n&&n([]))},this.multiSortEnabled=!1,this.pageSize=50,this.rowDetailsRenderer=null,this.store=null}get highlightIds(){return this._get("highlightIds")||new ye}set highlightIds(e){Array.isArray(e)?this._set("highlightIds",new ye(e)):this._set("highlightIds",e)}get size(){return this.store&&this.store.count||0}get state(){const{store:e}=this;return e&&e.state!=="disabled"?e.state==="loading"?"loading":e.state==="loaded"?"loaded":"ready":"disabled"}closeColumnMenus(){var e;(e=this.columns)==null||e.forEach(i=>{i.menu&&i.menu.open&&i.menu.set("open",!1)})}sortColumn(e,i){const r=this.findColumn(e);r&&(r.direction=i)}hideColumn(e){const i=this.findColumn(e);(i==null?void 0:i.hidden)===!1&&(i.hidden=!0)}showColumn(e){const i=this.findColumn(e);i!=null&&i.hidden&&(i.hidden=!1)}showAllColumns(){var e;(e=this.columns)==null||e.forEach(i=>{i.hidden&&(i.hidden=!1)})}findColumn(e){const i=[];return this.columns.forEach(r=>{var n;i.push(r),"columns"in r&&((n=r.columns)==null||n.forEach(s=>i.push(s)))}),i.find(r=>r.path===e)}getRowItemAt(e){var i;return(i=this.store)==null?void 0:i.getLocalItemAt(e)}refresh(){this.store&&(this.store.reset(),this.store.load())}};d([p()],sa.prototype,"cellClassNameGenerator",void 0),d([p()],sa.prototype,"columnReorderingEnabled",void 0),d([p()],sa.prototype,"columns",void 0),d([p()],sa.prototype,"dataProvider",void 0),d([p()],sa.prototype,"highlightIds",null),d([p()],sa.prototype,"multiSortEnabled",void 0),d([p()],sa.prototype,"pageSize",void 0),d([p()],sa.prototype,"rowDetailsRenderer",void 0),d([p({readOnly:!0})],sa.prototype,"size",null),d([p()],sa.prototype,"store",void 0),d([p({readOnly:!0})],sa.prototype,"state",null),sa=d([A("esri.widgets.FeatureTable.Grid.GridViewModel")],sa);const Tme=sa;let Mqe=class extends HTMLElement{static get version(){return"1.6.1"}};customElements.define("vaadin-lumo-styles",Mqe);let H5,q5=null,JK=window.HTMLImports&&window.HTMLImports.whenReady||null;function ZK(t){requestAnimationFrame(function(){JK?JK(t):(q5||(q5=new Promise(e=>{H5=e}),document.readyState==="complete"?H5():document.addEventListener("readystatechange",()=>{document.readyState==="complete"&&H5()})),q5.then(function(){t&&t()}))})}const YK="__seenByShadyCSS",yM="__shadyCSSCachedStyle";let WP=null,fI=null,Uf=class{constructor(){this.customStyles=[],this.enqueued=!1,ZK(()=>{window.ShadyCSS.flushCustomStyles&&window.ShadyCSS.flushCustomStyles()})}enqueueDocumentValidation(){!this.enqueued&&fI&&(this.enqueued=!0,ZK(fI))}addCustomStyle(e){e[YK]||(e[YK]=!0,this.customStyles.push(e),this.enqueueDocumentValidation())}getStyleForCustomStyle(e){if(e[yM])return e[yM];let i;return i=e.getStyle?e.getStyle():e,i}processStyles(){const e=this.customStyles;for(let i=0;i<e.length;i++){const r=e[i];if(r[yM])continue;const n=this.getStyleForCustomStyle(r);if(n){const s=n.__appliedElement||n;WP&&WP(s),r[yM]=s}}return e}};Uf.prototype.addCustomStyle=Uf.prototype.addCustomStyle,Uf.prototype.getStyleForCustomStyle=Uf.prototype.getStyleForCustomStyle,Uf.prototype.processStyles=Uf.prototype.processStyles,Object.defineProperties(Uf.prototype,{transformCallback:{get:()=>WP,set(t){WP=t}},validateCallback:{get:()=>fI,set(t){let e=!1;fI||(e=!0),fI=t,e&&this.enqueueDocumentValidation()}}});const Pj=/(?:^|[;\s{]\s*)(--[\w-]*?)\s*:\s*(?:((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};{])+)|\{([^}]*)\}(?:(?=[;\s}])|$))/gi,JP=/(?:^|\W+)@apply\s*\(?([^);\n]*)\)?/gi,$qe=/@media\s(.*)/;function Oj(t,e){for(let i in e)i===null?t.style.removeProperty(i):t.style.setProperty(i,e[i])}function Cme(t,e){const i=window.getComputedStyle(t).getPropertyValue(e);return i?i.trim():""}function Aqe(t){const e=JP.test(t)||Pj.test(t);return JP.lastIndex=0,Pj.lastIndex=0,e}const cR=!(window.ShadyDOM&&window.ShadyDOM.inUse);let wG,ST;function KK(t){wG=(!t||!t.shimcssproperties)&&(cR||!!(!navigator.userAgent.match(/AppleWebKit\/601|Edge\/15/)&&window.CSS&&CSS.supports&&CSS.supports("box-shadow","0 0 0 var(--foo)")))}window.ShadyCSS&&window.ShadyCSS.cssBuild!==void 0&&(ST=window.ShadyCSS.cssBuild);const Eme=!!(window.ShadyCSS&&window.ShadyCSS.disableRuntime);window.ShadyCSS&&window.ShadyCSS.nativeCss!==void 0?wG=window.ShadyCSS.nativeCss:window.ShadyCSS?(KK(window.ShadyCSS),window.ShadyCSS=void 0):KK(window.WebComponents&&window.WebComponents.flags);const xG=wG,vM=new Uf;window.ShadyCSS||(window.ShadyCSS={prepareTemplate(t,e,i){},prepareTemplateDom(t,e){},prepareTemplateStyles(t,e,i){},styleSubtree(t,e){vM.processStyles(),Oj(t,e)},styleElement(t){vM.processStyles()},styleDocument(t){vM.processStyles(),Oj(document.body,t)},getComputedStyleValue:(t,e)=>Cme(t,e),flushCustomStyles(){},nativeCss:xG,nativeShadow:cR,cssBuild:ST,disableRuntime:Eme}),window.ShadyCSS.CustomStyleInterface=vM,window.JSCompiler_renameProperty=function(t,e){return t};let _M,ka,kqe=/(url\()([^)]*)(\))/g,Pqe=/(^\/[^\/])|(^#)|(^[\w-\d]*:)/;function mI(t,e){if(t&&Pqe.test(t)||t==="//")return t;if(_M===void 0){_M=!1;try{const i=new URL("b","http://a");i.pathname="c%20d",_M=i.href==="http://a/c%20d"}catch{}}if(e||(e=document.baseURI||window.location.href),_M)try{return new URL(t,e).href}catch{return t}return ka||(ka=document.implementation.createHTMLDocument("temp"),ka.base=ka.createElement("base"),ka.head.appendChild(ka.base),ka.anchor=ka.createElement("a"),ka.body.appendChild(ka.anchor)),ka.base.href=e,ka.anchor.href=t,ka.anchor.href||t}function SG(t,e){return t.replace(kqe,function(i,r,n,s){return r+"'"+mI(n.replace(/["']/g,""),e)+"'"+s})}function IG(t){return t.substring(0,t.lastIndexOf("/")+1)}const TG=!window.ShadyDOM||!window.ShadyDOM.inUse;!window.ShadyCSS||window.ShadyCSS.nativeCss;const Oqe=TG&&"adoptedStyleSheets"in Document.prototype&&"replaceSync"in CSSStyleSheet.prototype&&(()=>{try{const t=new CSSStyleSheet;t.replaceSync("");const e=document.createElement("div");return e.attachShadow({mode:"open"}),e.shadowRoot.adoptedStyleSheets=[t],e.shadowRoot.adoptedStyleSheets[0]===t}catch{return!1}})();let Lqe=window.Polymer&&window.Polymer.rootPath||IG(document.baseURI||window.location.href),ZP=window.Polymer&&window.Polymer.sanitizeDOMValue||void 0,Rqe=window.Polymer&&window.Polymer.setPassiveTouchGestures||!1,w1=window.Polymer&&window.Polymer.strictTemplatePolicy||!1,Fqe=window.Polymer&&window.Polymer.allowTemplateFromDomModule||!1,IT=window.Polymer&&window.Polymer.legacyOptimizations||!1,Mme=window.Polymer&&window.Polymer.legacyWarnings||!1,Dqe=window.Polymer&&window.Polymer.syncInitialRender||!1,Lj=window.Polymer&&window.Polymer.legacyUndefined||!1,Nqe=window.Polymer&&window.Polymer.orderedComputed||!1,XK=window.Polymer&&window.Polymer.removeNestedTemplates||!1,$me=window.Polymer&&window.Polymer.fastDomIf||!1,Rj=window.Polymer&&window.Polymer.suppressTemplateNotifications||!1,bM=window.Polymer&&window.Polymer.legacyNoObservedAttributes||!1,Vqe=window.Polymer&&window.Polymer.useAdoptedStyleSheetsWithBuiltCSS||!1,CG={},Ame={};function QK(t,e){CG[t]=Ame[t.toLowerCase()]=e}function eX(t){return CG[t]||Ame[t.toLowerCase()]}function zqe(t){t.querySelector("style")&&console.warn("dom-module %s has style outside template",t.id)}let x1=class extends HTMLElement{static get observedAttributes(){return["id"]}static import(e,i){if(e){let r=eX(e);return r&&i?r.querySelector(i):r}return null}attributeChangedCallback(e,i,r,n){i!==r&&this.register()}get assetpath(){if(!this.__assetpath){const e=window.HTMLImports&&HTMLImports.importForElement?HTMLImports.importForElement(this)||document:this.ownerDocument,i=mI(this.getAttribute("assetpath")||"",e.baseURI);this.__assetpath=IG(i)}return this.__assetpath}register(e){if(e=e||this.id){if(w1&&eX(e)!==void 0)throw QK(e,null),new Error(`strictTemplatePolicy: dom-module ${e} re-registered`);this.id=e,QK(e,this),zqe(this)}}};x1.prototype.modules=CG,customElements.define("dom-module",x1);const jqe="link[rel=import][type~=css]",Bqe="include",tX="shady-unscoped";function EG(t){return x1.import(t)}function iX(t){const e=SG((t.body?t.body:t).textContent,t.baseURI),i=document.createElement("style");return i.textContent=e,i}function Uqe(t){const e=t.trim().split(/\s+/),i=[];for(let r=0;r<e.length;r++)i.push(...Gqe(e[r]));return i}function Gqe(t){const e=EG(t);if(!e)return console.warn("Could not find style data in module named",t),[];if(e._styles===void 0){const i=[];i.push(...$G(e));const r=e.querySelector("template");r&&i.push(...MG(r,e.assetpath)),e._styles=i}return e._styles}function MG(t,e){if(!t._styles){const i=[],r=t.content.querySelectorAll("style");for(let n=0;n<r.length;n++){let s=r[n],o=s.getAttribute(Bqe);o&&i.push(...Uqe(o).filter(function(a,l,c){return c.indexOf(a)===l})),e&&(s.textContent=SG(s.textContent,e)),i.push(s)}t._styles=i}return t._styles}function Hqe(t){let e=EG(t);return e?$G(e):[]}function $G(t){const e=[],i=t.querySelectorAll(jqe);for(let r=0;r<i.length;r++){let n=i[r];if(n.import){const s=n.import,o=n.hasAttribute(tX);if(o&&!s._unscopedStyle){const a=iX(s);a.setAttribute(tX,""),s._unscopedStyle=a}else s._style||(s._style=iX(s));e.push(o?s._unscopedStyle:s._style)}}return e}function qqe(t){let e=t.trim().split(/\s+/),i="";for(let r=0;r<e.length;r++)i+=Wqe(e[r]);return i}function Wqe(t){let e=EG(t);if(e&&e._cssText===void 0){let i=Zqe(e),r=e.querySelector("template");r&&(i+=Jqe(r,e.assetpath)),e._cssText=i||null}return e||console.warn("Could not find style data in module named",t),e&&e._cssText||""}function Jqe(t,e){let i="";const r=MG(t,e);for(let n=0;n<r.length;n++){let s=r[n];s.parentNode&&s.parentNode.removeChild(s),i+=s.textContent}return i}function Zqe(t){let e="",i=$G(t);for(let r=0;r<i.length;r++)e+=i[r].textContent;return e}const rX="include",Yqe=window.ShadyCSS.CustomStyleInterface;let Kqe=class extends HTMLElement{constructor(){super(),this._style=null,Yqe.addCustomStyle(this)}getStyle(){if(this._style)return this._style;const e=this.querySelector("style");if(!e)return null;this._style=e;const i=e.getAttribute(rX);return i&&(e.removeAttribute(rX),e.textContent=qqe(i)+e.textContent),this.ownerDocument!==window.document&&window.document.head.appendChild(this),this._style}};window.customElements.define("custom-style",Kqe);const nX=document.createElement("template");nX.innerHTML=`<custom-style>
  <style>
    html {
      /* Base (background) */
      --lumo-base-color: #FFF;

      /* Tint */
      --lumo-tint-5pct: hsla(0, 0%, 100%, 0.3);
      --lumo-tint-10pct: hsla(0, 0%, 100%, 0.37);
      --lumo-tint-20pct: hsla(0, 0%, 100%, 0.44);
      --lumo-tint-30pct: hsla(0, 0%, 100%, 0.5);
      --lumo-tint-40pct: hsla(0, 0%, 100%, 0.57);
      --lumo-tint-50pct: hsla(0, 0%, 100%, 0.64);
      --lumo-tint-60pct: hsla(0, 0%, 100%, 0.7);
      --lumo-tint-70pct: hsla(0, 0%, 100%, 0.77);
      --lumo-tint-80pct: hsla(0, 0%, 100%, 0.84);
      --lumo-tint-90pct: hsla(0, 0%, 100%, 0.9);
      --lumo-tint: #FFF;

      /* Shade */
      --lumo-shade-5pct: hsla(214, 61%, 25%, 0.05);
      --lumo-shade-10pct: hsla(214, 57%, 24%, 0.1);
      --lumo-shade-20pct: hsla(214, 53%, 23%, 0.16);
      --lumo-shade-30pct: hsla(214, 50%, 22%, 0.26);
      --lumo-shade-40pct: hsla(214, 47%, 21%, 0.38);
      --lumo-shade-50pct: hsla(214, 45%, 20%, 0.5);
      --lumo-shade-60pct: hsla(214, 43%, 19%, 0.61);
      --lumo-shade-70pct: hsla(214, 42%, 18%, 0.72);
      --lumo-shade-80pct: hsla(214, 41%, 17%, 0.83);
      --lumo-shade-90pct: hsla(214, 40%, 16%, 0.94);
      --lumo-shade: hsl(214, 35%, 15%);

      /* Contrast */
      --lumo-contrast-5pct: var(--lumo-shade-5pct);
      --lumo-contrast-10pct: var(--lumo-shade-10pct);
      --lumo-contrast-20pct: var(--lumo-shade-20pct);
      --lumo-contrast-30pct: var(--lumo-shade-30pct);
      --lumo-contrast-40pct: var(--lumo-shade-40pct);
      --lumo-contrast-50pct: var(--lumo-shade-50pct);
      --lumo-contrast-60pct: var(--lumo-shade-60pct);
      --lumo-contrast-70pct: var(--lumo-shade-70pct);
      --lumo-contrast-80pct: var(--lumo-shade-80pct);
      --lumo-contrast-90pct: var(--lumo-shade-90pct);
      --lumo-contrast: var(--lumo-shade);

      /* Text */
      --lumo-header-text-color: var(--lumo-contrast);
      --lumo-body-text-color: var(--lumo-contrast-90pct);
      --lumo-secondary-text-color: var(--lumo-contrast-70pct);
      --lumo-tertiary-text-color: var(--lumo-contrast-50pct);
      --lumo-disabled-text-color: var(--lumo-contrast-30pct);

      /* Primary */
      --lumo-primary-color: hsl(214, 90%, 52%);
      --lumo-primary-color-50pct: hsla(214, 90%, 52%, 0.5);
      --lumo-primary-color-10pct: hsla(214, 90%, 52%, 0.1);
      --lumo-primary-text-color: var(--lumo-primary-color);
      --lumo-primary-contrast-color: #FFF;

      /* Error */
      --lumo-error-color: hsl(3, 100%, 61%);
      --lumo-error-color-50pct: hsla(3, 100%, 60%, 0.5);
      --lumo-error-color-10pct: hsla(3, 100%, 60%, 0.1);
      --lumo-error-text-color: hsl(3, 92%, 53%);
      --lumo-error-contrast-color: #FFF;

      /* Success */
      --lumo-success-color: hsl(145, 80%, 42%); /* hsl(144,82%,37%); */
      --lumo-success-color-50pct: hsla(145, 76%, 44%, 0.55);
      --lumo-success-color-10pct: hsla(145, 76%, 44%, 0.12);
      --lumo-success-text-color: hsl(145, 100%, 32%);
      --lumo-success-contrast-color: #FFF;
    }
  </style>
</custom-style><dom-module id="lumo-color">
  <template>
    <style>
      [theme~="dark"] {
        /* Base (background) */
        --lumo-base-color: hsl(214, 35%, 21%);

        /* Tint */
        --lumo-tint-5pct: hsla(214, 65%, 85%, 0.06);
        --lumo-tint-10pct: hsla(214, 60%, 80%, 0.14);
        --lumo-tint-20pct: hsla(214, 64%, 82%, 0.23);
        --lumo-tint-30pct: hsla(214, 69%, 84%, 0.32);
        --lumo-tint-40pct: hsla(214, 73%, 86%, 0.41);
        --lumo-tint-50pct: hsla(214, 78%, 88%, 0.5);
        --lumo-tint-60pct: hsla(214, 82%, 90%, 0.6);
        --lumo-tint-70pct: hsla(214, 87%, 92%, 0.7);
        --lumo-tint-80pct: hsla(214, 91%, 94%, 0.8);
        --lumo-tint-90pct: hsla(214, 96%, 96%, 0.9);
        --lumo-tint: hsl(214, 100%, 98%);

        /* Shade */
        --lumo-shade-5pct: hsla(214, 0%, 0%, 0.07);
        --lumo-shade-10pct: hsla(214, 4%, 2%, 0.15);
        --lumo-shade-20pct: hsla(214, 8%, 4%, 0.23);
        --lumo-shade-30pct: hsla(214, 12%, 6%, 0.32);
        --lumo-shade-40pct: hsla(214, 16%, 8%, 0.41);
        --lumo-shade-50pct: hsla(214, 20%, 10%, 0.5);
        --lumo-shade-60pct: hsla(214, 24%, 12%, 0.6);
        --lumo-shade-70pct: hsla(214, 28%, 13%, 0.7);
        --lumo-shade-80pct: hsla(214, 32%, 13%, 0.8);
        --lumo-shade-90pct: hsla(214, 33%, 13%, 0.9);
        --lumo-shade: hsl(214, 33%, 13%);

        /* Contrast */
        --lumo-contrast-5pct: var(--lumo-tint-5pct);
        --lumo-contrast-10pct: var(--lumo-tint-10pct);
        --lumo-contrast-20pct: var(--lumo-tint-20pct);
        --lumo-contrast-30pct: var(--lumo-tint-30pct);
        --lumo-contrast-40pct: var(--lumo-tint-40pct);
        --lumo-contrast-50pct: var(--lumo-tint-50pct);
        --lumo-contrast-60pct: var(--lumo-tint-60pct);
        --lumo-contrast-70pct: var(--lumo-tint-70pct);
        --lumo-contrast-80pct: var(--lumo-tint-80pct);
        --lumo-contrast-90pct: var(--lumo-tint-90pct);
        --lumo-contrast: var(--lumo-tint);

        /* Text */
        --lumo-header-text-color: var(--lumo-contrast);
        --lumo-body-text-color: var(--lumo-contrast-90pct);
        --lumo-secondary-text-color: var(--lumo-contrast-70pct);
        --lumo-tertiary-text-color: var(--lumo-contrast-50pct);
        --lumo-disabled-text-color: var(--lumo-contrast-30pct);

        /* Primary */
        --lumo-primary-color: hsl(214, 86%, 55%);
        --lumo-primary-color-50pct: hsla(214, 86%, 55%, 0.5);
        --lumo-primary-color-10pct: hsla(214, 90%, 63%, 0.1);
        --lumo-primary-text-color: hsl(214, 100%, 70%);
        --lumo-primary-contrast-color: #FFF;

        /* Error */
        --lumo-error-color: hsl(3, 90%, 63%);
        --lumo-error-color-50pct: hsla(3, 90%, 63%, 0.5);
        --lumo-error-color-10pct: hsla(3, 90%, 63%, 0.1);
        --lumo-error-text-color: hsl(3, 100%, 67%);

        /* Success */
        --lumo-success-color: hsl(145, 65%, 42%);
        --lumo-success-color-50pct: hsla(145, 65%, 42%, 0.5);
        --lumo-success-color-10pct: hsla(145, 65%, 42%, 0.1);
        --lumo-success-text-color: hsl(145, 85%, 47%);
      }

      html {
        color: var(--lumo-body-text-color);
        background-color: var(--lumo-base-color);
      }

      [theme~="dark"] {
        color: var(--lumo-body-text-color);
        background-color: var(--lumo-base-color);
      }

      h1,
      h2,
      h3,
      h4,
      h5,
      h6 {
        color: var(--lumo-header-text-color);
      }

      a {
        color: var(--lumo-primary-text-color);
      }

      blockquote {
        color: var(--lumo-secondary-text-color);
      }

      code,
      pre {
        background-color: var(--lumo-contrast-10pct);
        border-radius: var(--lumo-border-radius-m);
      }
    </style>
  </template>
</dom-module><dom-module id="lumo-color-legacy">
  <template>
    <style include="lumo-color">
      :host {
        color: var(--lumo-body-text-color) !important;
        background-color: var(--lumo-base-color) !important;
      }
    </style>
  </template>
</dom-module>`,document.head.appendChild(nX.content);const sX=document.createElement("template");sX.innerHTML=`<custom-style>
  <style>
    @font-face {
      font-family: 'lumo-icons';
      src: url(data:application/font-woff;charset=utf-8;base64,d09GRgABAAAAABEcAAsAAAAAIiwAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABHU1VCAAABCAAAADsAAABUIIslek9TLzIAAAFEAAAAQwAAAFZAIUuKY21hcAAAAYgAAAD4AAADrsCU8d5nbHlmAAACgAAAC2MAABd4h9To2WhlYWQAAA3kAAAAMAAAADZa/6SsaGhlYQAADhQAAAAdAAAAJAbpA35obXR4AAAONAAAABAAAACspBAAAGxvY2EAAA5EAAAAWAAAAFh55IAsbWF4cAAADpwAAAAfAAAAIAFKAXBuYW1lAAAOvAAAATEAAAIuUUJZCHBvc3QAAA/wAAABKwAAAelm8SzVeJxjYGRgYOBiMGCwY2BycfMJYeDLSSzJY5BiYGGAAJA8MpsxJzM9kYEDxgPKsYBpDiBmg4gCACY7BUgAeJxjYGS+yDiBgZWBgamKaQ8DA0MPhGZ8wGDIyAQUZWBlZsAKAtJcUxgcXjG+0mIO+p/FEMUcxDANKMwIkgMABn8MLQB4nO3SWW6DMABF0UtwCEnIPM/zhLK8LqhfXRybSP14XUYtHV9hGYQwQBNIo3cUIPkhQeM7rib1ekqnXg981XuC1qvy84lzojleh3puxL0hPjGjRU473teloEefAUNGjJkwZcacBUtWrNmwZceeA0dOnLlw5cadB09elPGhGf+j0NTI/65KfXerT6JhqKnpRKtgOpuqaTrtKjPUlqHmhto21I7pL6i6hlqY3q7qGWrfUAeGOjTUkaGODXViqFNDnRnq3FAXhro01JWhrg11Y6hbQ90Z6t5QD4Z6NNSToZ4N9WKoV0O9GerdUB+G+jTUl6GWRvkL24BkEXictVh9bFvVFb/nxvbz+7Rf/N6zHcd2bCfP+Wgc1Z9N0jpNnEL6kbRVS6HA2hQYGh9TGR1CbCqa2rXrWOkQE/sHNJgmtZvoVNZqE1B1DNHxzTQxCehUTYiJTQyENui0qSLezr3PduyQfgmRWOfde8+9551z7rnn/O4jLoJ/bRP0UaKQMLFJjpBAvphLZC3Dk0ok7WBzR2/upJs7Ryw/nfFbln/uuN/apCvwrKLrSvUqRufbm5pn0fs0w4gYxnGVP6qHnO4bWiDQGQgwtS6lm3lB3QoX1M2vwEmuzirF39y+Es2+DJ8d1pkyqBIqoze3D1+Zz4DrFoazxI8dWwMrDlZ2DMqQAR9AROsJU+2cmlTPazTco52F1xTa2a2+K8vvq92dVHmtLoPeQX/AZPRYGthDYOeZjBjKoFsVGulR3lWU95WeCK44qHU7MhWUGUKZDT3oKUcG2GWuh+EDDfUYA/jhAhl0TOsJNYSEu7mQmi3UzfXwZKA4BsVsHLXQYGgRW95uEtpJ1Vfn9XiLriRBlFEqxsDjA09yCNUoQxxwd7KWSTt2y3GTKiflqHRSoWZc3m11Wa/fJdFgXD4sSYfleJBKd8GMz7J8dZn/cGRCcKGDnA2Ge3fKzcvlnTDNthGWLXzX/WaXtUAmRgeLlHSr30r0G9UTXMb0AtmwzOoy73fkSlHZkduw/TYuU9cAD4YutPoxTTsA3797wVr4Z/1NC5zARHr4vtxJjxIfiZMhMkbWk+14BnJZKwqGZwDfswLyxWDSg11rFLJF7Nopxjd1h1/QOT+oezgfu3Yq+Hk+duf5x+40o1GTkaIgikK/IEnC6aYxCUBaZJSN4XTYFjU/YMNIKqJwhDGOCCI8FDXnXmXjtGhGJyShqjAOnBOkW2JG9S7GgYeMWAU5JzhnWmBOaOM+CKEPoqSfFDC2Unq+DLlUgUVUFFLZGJg6jtlojsdsa8kPObPuJdi5dnBdBsLJMGTWDa4t2JvtwuPo9s+Y86suv/W33QG1rAaOAUV+vx4K6f2D04PVKlC7WLSrZzAi45ZV6lIC7WoXqmRyvUqoVwrzUoVsIjeTXWQv+RH5GTlBXiB/In8ln0IbBCAFOajAJrgZYyOHWqOfUe/aHjI12R6OQo1jCgt215l+4f6XPb+0MNou0V+43n2F77tSfRb24d7zitgnKmvYHs69zugaPvBwv6ioXkb2LdL65Atw51uLkXlu1bhMMRcXSPcYoqKIRlh34lQP8/5JbuUFye4vxD6/6MxFF11C0uVLr9Ulgw44tS3pMViNLUExbycFgLIct+QDMibRimx1ydUz8FXZiuOIDBOMVX2nUZc+huNE5XUJ81uiJoiabwqaVF0uacKbau/pl4R2VW0XXlJra6boVrYG646TF5NYzwy4vjENVrDlcNpZPl8DH6XX8XWCx0mvWVZY6KFLrvsY66/zPict5FnxaNUR/juvZCM3TvD60E2W1tZizbXTPDuabcm0nbbzpWKpmA1ayBQ8giedLUM+A0kNjBjQjmuYz7YrgIXYvmF63ZLBwSXrpn9Tb9wwdd/U1H0PMQK3XcO8ul3WT7PyPPdpy0TemKxNRcJNauiXJnnUDpUppQWs4SnUIy0EESGYqJYQLGHxzaGWwVIaS6Y7mQFM8ZjYDQ3axjf61SWjU33JwOZA1pwaG1L9mzf71aHRdX1JHw6Fp0aXhNwbqyeGNg4NbdzGCBxoz4ZXjy4Nu69Zr6sDY6vMrLU5nA1P8JkbdWXJ6ERfMryvNh1JfQ9+T4dIhGvK9w3dxjBBzatsQ/MlOHVIDnYpDz6odAXlQ01t2Pa5Iafd8MMpxAeDKP0C6CjgVLT5osB6icUx01lWjXxzT/GyRF2welEM5Z/7jG3VjQ1SrNn5IbyzOG5dobB3/QHxyZvsXcoz8IoEwS7plCg+zxHQk424q9BfEpkESJbFHQusDBSWFkuBkoPO0kLKwRVYjxGXlHTcTDQMJ/H6TX9afkO7mnraTO1feTnZAXLu4cp7HAXMmNG1yeFk9TgS/NHhZR/4QoBTr/ZB+6hCgyl15Nq1UbN6nE1/ZnP1U2cizCBpvs8cJQZJ4LkYx5N/yZPAUZNQQ0V4f3BQllWrK3YRzl30dOT6RVn2upNur6woSa8CqpdT/aKnBM4o3jNur9d9xqtUT6veBEt9Ca9at+ERzEEhUkR8sa5mQ4aVvJoVeEA8zI4ei5mULXFGyU7z/6TAeYLVcpzSWZY8PYYF5yrTV60sT0+XV141vX++Wf16V2bFeGVPZXxFpkvyeKTWLlzfW0mnKxsY6Y3294/0998SCfX1blm5pbcvFGlq/r07MRAMhYIDiW5JFKWW3vdrEpCsZSJG+om7Zu/PSScZJhNkLbmW5Wsr12pWqW5zKtlwRS4bFOxUw17mCzy6lskCDl1WYOGWDYrADrMA7BDDweWWNd5koiJnR1dz+ytLP2q0SqPB1lnK2ccB7RYe4FSoPks3iB3t4txTSHctb2sy1ivk0pvHuCNm6w1f6wxv3+OCgN78LqdQnUVh7R0oTAp0zOf2rbW770Vu5C2dIyGdTnHo8zSji7dppj0USoVCz+lhRMTh53Teq9VbGfbjuSbAooSdXayY4PYHg374C6f7gl1B/DXuJ4/QXxOBdJFJspFsI3egpoWUUCjlTIFnNYNl+ZyZKmBeYKGHkD1QyDlhaKbKwKcIJqJ4TLJ2OmdY/JWXae4DdGBw8HZ7eXcgFF2zr2SoalDry5iKqoa0Puhe3hPQ2s3elTYM+MI+n3rK0KgL7/La3GeMLt6m7u912vGnvtORiIa0qBmhqVi+XW9XNBmqb8eVgKzIHfGI5bNoG7X0UCzeISmqIcO/nY8FH7U8avX9fx/ST+hx0sezPw9Qy8Mum3GWf2N4Uy/yIYGVBXbJHWIZp7dfTcptdMTr9Qmq7DaiK/ukqCL4kt4RUfS5XPnMtmT22/mQFqF7emSqtrlu8SVElxDRJrZODkpuwe0VfTfjdEp1f7A7v+fozNBXUJ/6WTuK2TtFlpFVZAZ3LcFvUi1Z2p2YT+EMAkGJVStOzLTAPg4IqWIAlzRSjOBkl2zxj3TKycpzT/MnvX3uaSMWM+gU0rkXjohhefVRMaps3/kLMSKv23lT23uxQrkQjyOJleMDsdhAnD6ZGElWZ5MjCXzCE/hkWX+WF4knzGhVOyK2eQZekV3eyo0zL8kuYWCnDCvjjhAkcTPOBDXVdoav3HVcFnQjLvtV9S2p0zA6JegPwMQxt+yFb3ll9zGlq/5dRKb3cEyQYoaNYpharJ7xCB7AWxsLY3jjZXY0XsZj0Wjwc9I6PP/dKABnCZaqHpaZEACxk4ZeLZSKNgZABl+lYQX1sJQOSX3n6r410evcoud5JeAGUXVP9H1tZOKejTq4Ono0z0erro1FrnOpohva1d/hTdtVsQdKN5W9RlT3NjD0nznyKNTgKAMfWNWcyodV0IGLPIHOF0o4JyqufaK4z6WIIzuGh3d8c8cwQg8ER+OVxyrjdm8vNuhts4LoOihGxIMuUdgzwiYN7xhh1+oZnJNuTG7gQZvu4XWZ9GAZZjGEubwePqYhtKDTH+9VQkl17/iGybsnJ+8+sKtyPrcll9ty65Zsdst/9iqpEKh7M5VdBxh3csOdNc6tW3I1uyM1PzOXegSOrLFsFNI2O27M+TF2ApnN9MUv5ud6LjxIvEQnHRzxIu4IsA9MLFkJn2tcZoZ7ON7dXe7ujrc8HrusPKamlqXwd77lQUuLpilau4PUMapueBb7irU4RoUXEYXuVuIGlRGmOp+2lNkaRPVziOqmlaZvaqG4dFgSj0jxEJWrv12IUWntmw+rfQarRE0Aph4ocI6nlUlGqs+u3/+T/ethW62PpHp2eHbZstnh/wOO95yDAHicY2BkYGAA4pmJ6QHx/DZfGbiZXwBFGGpUNzQi6P+vmacy3QJyORiYQKIANoULVXicY2BkYGAO+p8FJF8wAAHzVAZGBlSgDQBW9gNvAAAAeJxjYGBgYH4xNDAAzwQmjwAAAAAATgCaAOgBCgEsAU4BcAGaAcQB7gIaApwC6ASaBLwE1gTyBQ4FKgV6BdAF/gZEBmYGtgcYB5AIGAhSCGoI/glGCb4J2goECjwKggq4CvALUAuWC7x4nGNgZGBg0GZMYRBlAAEmIOYCQgaG/2A+AwAYlAG8AHicbZE9TsMwGIbf9A/RSggEYmHxAgtq+jN2ZGj3Dt3T1GlTOXHkuBW9AyfgEByCgTNwCA7BW/NJlVBtyd/jx+8XKwmAa3whwnFE6Ib1OBq44O6Pm6Qb4Rb5QbiNHh6FO/RD4S6eMRHu4RaaT4halzR3eBVu4Apvwk36d+EW+UO4jXt8Cnfov4W7WOBHuIen6MXsCtvPU1vWc73emcSdxIkW2tW5LdUoHp7kTJfaJV6v1PKg6v167H2mMmcLNbWl18ZYVTm71amPN95Xk8EgEx+ntoDBDgUs+siRspaoMef7rukNEriziXNuwS7Hmoe9wggxv+e55IzJMqQTeNYV00scuNbY8+YxrUfGfcaMZb/CNPQe04bT0lThbEuT0sfYhK6K/23Amf3Lx+H24hcj4GScAAAAeJxtjtlugzAQRbkJUEJIuu/7vqR8lGNPAcWx0YAb5e/LklR96EgenSufGY038PqKvf9rhgGG8BEgxA4ijBBjjAQTTLGLPezjAIc4wjFOcIoznOMCl7jCNW5wizvc4wGPeMIzXvCKN7zjAzN8eonQRWZSSaYmjvug6ase98hFltexMJmmVNmV2WBvdNgZUc+ujAWzXW3UDnu1w43asStHc8GpzAXX/py0jqTQZJTgkcxJLpaCF0lD32xNt+43tAsn29Dft02uDKS2cjGUNgsk26qK2lFthYoU27INPqmiDqg5goe0pqR5qSoqMdek/CUZFywL46rEsiImleqiqoMyt4baXlu/1GLdNFf5zbcNmdr1YUWCZe47o+zUmb/DoStbw3cVsef9ALjjiPQA) format('woff');
      font-weight: normal;
      font-style: normal;
    }

    html {
      --lumo-icons-align-center: "\\ea01";
      --lumo-icons-align-left: "\\ea02";
      --lumo-icons-align-right: "\\ea03";
      --lumo-icons-angle-down: "\\ea04";
      --lumo-icons-angle-left: "\\ea05";
      --lumo-icons-angle-right: "\\ea06";
      --lumo-icons-angle-up: "\\ea07";
      --lumo-icons-arrow-down: "\\ea08";
      --lumo-icons-arrow-left: "\\ea09";
      --lumo-icons-arrow-right: "\\ea0a";
      --lumo-icons-arrow-up: "\\ea0b";
      --lumo-icons-bar-chart: "\\ea0c";
      --lumo-icons-bell: "\\ea0d";
      --lumo-icons-calendar: "\\ea0e";
      --lumo-icons-checkmark: "\\ea0f";
      --lumo-icons-chevron-down: "\\ea10";
      --lumo-icons-chevron-left: "\\ea11";
      --lumo-icons-chevron-right: "\\ea12";
      --lumo-icons-chevron-up: "\\ea13";
      --lumo-icons-clock: "\\ea14";
      --lumo-icons-cog: "\\ea15";
      --lumo-icons-cross: "\\ea16";
      --lumo-icons-download: "\\ea17";
      --lumo-icons-dropdown: "\\ea18";
      --lumo-icons-edit: "\\ea19";
      --lumo-icons-error: "\\ea1a";
      --lumo-icons-eye: "\\ea1b";
      --lumo-icons-eye-disabled: "\\ea1c";
      --lumo-icons-menu: "\\ea1d";
      --lumo-icons-minus: "\\ea1e";
      --lumo-icons-ordered-list: "\\ea1f";
      --lumo-icons-phone: "\\ea20";
      --lumo-icons-photo: "\\ea21";
      --lumo-icons-play: "\\ea22";
      --lumo-icons-plus: "\\ea23";
      --lumo-icons-redo: "\\ea24";
      --lumo-icons-reload: "\\ea25";
      --lumo-icons-search: "\\ea26";
      --lumo-icons-undo: "\\ea27";
      --lumo-icons-unordered-list: "\\ea28";
      --lumo-icons-upload: "\\ea29";
      --lumo-icons-user: "\\ea2a";
    }
  </style>
</custom-style>`,document.head.appendChild(sX.content);const oX=document.createElement("template");oX.innerHTML=`<custom-style>
  <style>
    html {
      --lumo-size-xs: 1.625rem;
      --lumo-size-s: 1.875rem;
      --lumo-size-m: 2.25rem;
      --lumo-size-l: 2.75rem;
      --lumo-size-xl: 3.5rem;

      /* Icons */
      --lumo-icon-size-s: 1.25em;
      --lumo-icon-size-m: 1.5em;
      --lumo-icon-size-l: 2.25em;
      /* For backwards compatibility */
      --lumo-icon-size: var(--lumo-icon-size-m);
    }
  </style>
</custom-style>`,document.head.appendChild(oX.content);const aX=document.createElement("template");aX.innerHTML=`<custom-style>
  <style>
    html {
      /* Square */
      --lumo-space-xs: 0.25rem;
      --lumo-space-s: 0.5rem;
      --lumo-space-m: 1rem;
      --lumo-space-l: 1.5rem;
      --lumo-space-xl: 2.5rem;

      /* Wide */
      --lumo-space-wide-xs: calc(var(--lumo-space-xs) / 2) var(--lumo-space-xs);
      --lumo-space-wide-s: calc(var(--lumo-space-s) / 2) var(--lumo-space-s);
      --lumo-space-wide-m: calc(var(--lumo-space-m) / 2) var(--lumo-space-m);
      --lumo-space-wide-l: calc(var(--lumo-space-l) / 2) var(--lumo-space-l);
      --lumo-space-wide-xl: calc(var(--lumo-space-xl) / 2) var(--lumo-space-xl);

      /* Tall */
      --lumo-space-tall-xs: var(--lumo-space-xs) calc(var(--lumo-space-xs) / 2);
      --lumo-space-tall-s: var(--lumo-space-s) calc(var(--lumo-space-s) / 2);
      --lumo-space-tall-m: var(--lumo-space-m) calc(var(--lumo-space-m) / 2);
      --lumo-space-tall-l: var(--lumo-space-l) calc(var(--lumo-space-l) / 2);
      --lumo-space-tall-xl: var(--lumo-space-xl) calc(var(--lumo-space-xl) / 2);
    }
  </style>
</custom-style>`,document.head.appendChild(aX.content);const lX=document.createElement("template");lX.innerHTML=`<custom-style>
  <style>
    html {
      /* Border radius */
      --lumo-border-radius-s: 0.25em; /* Checkbox, badge, date-picker year indicator, etc */
      --lumo-border-radius-m: var(--lumo-border-radius, 0.25em); /* Button, text field, menu overlay, etc */
      --lumo-border-radius-l: 0.5em; /* Dialog, notification, etc */
      --lumo-border-radius: 0.25em; /* Deprecated */

      /* Shadow */
      --lumo-box-shadow-xs: 0 1px 4px -1px var(--lumo-shade-50pct);
      --lumo-box-shadow-s: 0 2px 4px -1px var(--lumo-shade-20pct), 0 3px 12px -1px var(--lumo-shade-30pct);
      --lumo-box-shadow-m: 0 2px 6px -1px var(--lumo-shade-20pct), 0 8px 24px -4px var(--lumo-shade-40pct);
      --lumo-box-shadow-l: 0 3px 18px -2px var(--lumo-shade-20pct), 0 12px 48px -6px var(--lumo-shade-40pct);
      --lumo-box-shadow-xl: 0 4px 24px -3px var(--lumo-shade-20pct), 0 18px 64px -8px var(--lumo-shade-40pct);

      /* Clickable element cursor */
      --lumo-clickable-cursor: default;
    }
  </style>
</custom-style>`,document.head.appendChild(lX.content);const cX=document.createElement("template");cX.innerHTML=`<custom-style>
  <style>
    html {
      /* Font families */
      --lumo-font-family: -apple-system, BlinkMacSystemFont, "Roboto", "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";

      /* Font sizes */
      --lumo-font-size-xxs: .75rem;
      --lumo-font-size-xs: .8125rem;
      --lumo-font-size-s: .875rem;
      --lumo-font-size-m: 1rem;
      --lumo-font-size-l: 1.125rem;
      --lumo-font-size-xl: 1.375rem;
      --lumo-font-size-xxl: 1.75rem;
      --lumo-font-size-xxxl: 2.5rem;

      /* Line heights */
      --lumo-line-height-xs: 1.25;
      --lumo-line-height-s: 1.375;
      --lumo-line-height-m: 1.625;
    }

  </style>
</custom-style><dom-module id="lumo-typography">
  <template>
    <style>
      html {
        font-family: var(--lumo-font-family);
        font-size: var(--lumo-font-size, var(--lumo-font-size-m));
        line-height: var(--lumo-line-height-m);
        -webkit-text-size-adjust: 100%;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
      }

      /* Can’t combine with the above selector because that doesn’t work in browsers without native shadow dom */
      :host {
        font-family: var(--lumo-font-family);
        font-size: var(--lumo-font-size, var(--lumo-font-size-m));
        line-height: var(--lumo-line-height-m);
        -webkit-text-size-adjust: 100%;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
      }

      small,
      [theme~="font-size-s"] {
        font-size: var(--lumo-font-size-s);
        line-height: var(--lumo-line-height-s);
      }

      [theme~="font-size-xs"] {
        font-size: var(--lumo-font-size-xs);
        line-height: var(--lumo-line-height-xs);
      }

      h1,
      h2,
      h3,
      h4,
      h5,
      h6 {
        font-weight: 600;
        line-height: var(--lumo-line-height-xs);
        margin-top: 1.25em;
      }

      h1 {
        font-size: var(--lumo-font-size-xxxl);
        margin-bottom: 0.75em;
      }

      h2 {
        font-size: var(--lumo-font-size-xxl);
        margin-bottom: 0.5em;
      }

      h3 {
        font-size: var(--lumo-font-size-xl);
        margin-bottom: 0.5em;
      }

      h4 {
        font-size: var(--lumo-font-size-l);
        margin-bottom: 0.5em;
      }

      h5 {
        font-size: var(--lumo-font-size-m);
        margin-bottom: 0.25em;
      }

      h6 {
        font-size: var(--lumo-font-size-xs);
        margin-bottom: 0;
        text-transform: uppercase;
        letter-spacing: 0.03em;
      }

      p,
      blockquote {
        margin-top: 0.5em;
        margin-bottom: 0.75em;
      }

      a {
        text-decoration: none;
      }

      a:hover {
        text-decoration: underline;
      }

      hr {
        display: block;
        align-self: stretch;
        height: 1px;
        border: 0;
        padding: 0;
        margin: var(--lumo-space-s) calc(var(--lumo-border-radius-m) / 2);
        background-color: var(--lumo-contrast-10pct);
      }

      blockquote {
        border-left: 2px solid var(--lumo-contrast-30pct);
      }

      b,
      strong {
        font-weight: 600;
      }

      /* RTL specific styles */

      blockquote[dir="rtl"] {
        border-left: none;
        border-right: 2px solid var(--lumo-contrast-30pct);
      }

    </style>
  </template>
</dom-module>`,document.head.appendChild(cX.content);const uX=typeof window<"u"&&window.customElements!=null&&window.customElements.polyfillWrapFlushCallback!==void 0,AG=(t,e,i=null)=>{for(;e!==i;){const r=e.nextSibling;t.removeChild(e),e=r}},cp=`{{lit-${String(Math.random()).slice(2)}}}`,kme=`<!--${cp}-->`,dX=new RegExp(`${cp}|${kme}`),y2="$lit$";let Pme=class{constructor(e,i){this.parts=[],this.element=i;const r=[],n=[],s=document.createTreeWalker(i.content,133,null,!1);let o=0,a=-1,l=0;const{strings:c,values:{length:u}}=e;for(;l<u;){const h=s.nextNode();if(h!==null){if(a++,h.nodeType===1){if(h.hasAttributes()){const f=h.attributes,{length:m}=f;let g=0;for(let y=0;y<m;y++)hX(f[y].name,y2)&&g++;for(;g-- >0;){const y=c[l],v=Fj.exec(y)[2],b=v.toLowerCase()+y2,w=h.getAttribute(b);h.removeAttribute(b);const x=w.split(dX);this.parts.push({type:"attribute",index:a,name:v,strings:x}),l+=x.length-1}}h.tagName==="TEMPLATE"&&(n.push(h),s.currentNode=h.content)}else if(h.nodeType===3){const f=h.data;if(f.indexOf(cp)>=0){const m=h.parentNode,g=f.split(dX),y=g.length-1;for(let v=0;v<y;v++){let b,w=g[v];if(w==="")b=xm();else{const x=Fj.exec(w);x!==null&&hX(x[2],y2)&&(w=w.slice(0,x.index)+x[1]+x[2].slice(0,-y2.length)+x[3]),b=document.createTextNode(w)}m.insertBefore(b,h),this.parts.push({type:"node",index:++a})}g[y]===""?(m.insertBefore(xm(),h),r.push(h)):h.data=g[y],l+=y}}else if(h.nodeType===8)if(h.data===cp){const f=h.parentNode;h.previousSibling!==null&&a!==o||(a++,f.insertBefore(xm(),h)),o=a,this.parts.push({type:"node",index:a}),h.nextSibling===null?h.data="":(r.push(h),a--),l++}else{let f=-1;for(;(f=h.data.indexOf(cp,f+1))!==-1;)this.parts.push({type:"node",index:-1}),l++}}else s.currentNode=n.pop()}for(const h of r)h.parentNode.removeChild(h)}};const hX=(t,e)=>{const i=t.length-e.length;return i>=0&&t.slice(i)===e},Ome=t=>t.index!==-1,xm=()=>document.createComment(""),Fj=/([ \x09\x0a\x0c\x0d])([^\0-\x1F\x7F-\x9F "'>=/]+)([ \x09\x0a\x0c\x0d]*=[ \x09\x0a\x0c\x0d]*(?:[^ \x09\x0a\x0c\x0d"'`<>=]*|"[^"]*|'[^']*))$/,kG=133;function Lme(t,e){const{element:{content:i},parts:r}=t,n=document.createTreeWalker(i,kG,null,!1);let s=gI(r),o=r[s],a=-1,l=0;const c=[];let u=null;for(;n.nextNode();){a++;const h=n.currentNode;for(h.previousSibling===u&&(u=null),e.has(h)&&(c.push(h),u===null&&(u=h)),u!==null&&l++;o!==void 0&&o.index===a;)o.index=u!==null?-1:o.index-l,s=gI(r,s),o=r[s]}c.forEach(h=>h.parentNode.removeChild(h))}const Xqe=t=>{let e=t.nodeType===11?0:1;const i=document.createTreeWalker(t,kG,null,!1);for(;i.nextNode();)e++;return e},gI=(t,e=-1)=>{for(let i=e+1;i<t.length;i++){const r=t[i];if(Ome(r))return i}return-1};function Qqe(t,e,i=null){const{element:{content:r},parts:n}=t;if(i==null)return void r.appendChild(e);const s=document.createTreeWalker(r,kG,null,!1);let o=gI(n),a=0,l=-1;for(;s.nextNode();)for(l++,s.currentNode===i&&(a=Xqe(e),i.parentNode.insertBefore(e,i));o!==-1&&n[o].index===l;){if(a>0){for(;o!==-1;)n[o].index+=a,o=gI(n,o);return}o=gI(n,o)}}const eWe=new WeakMap,tWe=t=>typeof t=="function"&&eWe.has(t),pX={},fX={};let Dj=class{constructor(e,i,r){this.__parts=[],this.template=e,this.processor=i,this.options=r}update(e){let i=0;for(const r of this.__parts)r!==void 0&&r.setValue(e[i]),i++;for(const r of this.__parts)r!==void 0&&r.commit()}_clone(){const e=uX?this.template.element.content.cloneNode(!0):document.importNode(this.template.element.content,!0),i=[],r=this.template.parts,n=document.createTreeWalker(e,133,null,!1);let s,o=0,a=0,l=n.nextNode();for(;o<r.length;)if(s=r[o],Ome(s)){for(;a<s.index;)a++,l.nodeName==="TEMPLATE"&&(i.push(l),n.currentNode=l.content),(l=n.nextNode())===null&&(n.currentNode=i.pop(),l=n.nextNode());if(s.type==="node"){const c=this.processor.handleTextExpression(this.options);c.insertAfterNode(l.previousSibling),this.__parts.push(c)}else this.__parts.push(...this.processor.handleAttributeExpressions(l,s.name,s.strings,this.options));o++}else this.__parts.push(void 0),o++;return uX&&(document.adoptNode(e),customElements.upgrade(e)),e}};const mX=window.trustedTypes&&trustedTypes.createPolicy("lit-html",{createHTML:t=>t}),iWe=` ${cp} `;let rWe=class{constructor(e,i,r,n){this.strings=e,this.values=i,this.type=r,this.processor=n}getHTML(){const e=this.strings.length-1;let i="",r=!1;for(let n=0;n<e;n++){const s=this.strings[n],o=s.lastIndexOf("<!--");r=(o>-1||r)&&s.indexOf("-->",o+1)===-1;const a=Fj.exec(s);i+=a===null?s+(r?iWe:kme):s.substr(0,a.index)+a[1]+a[2]+y2+a[3]+cp}return i+=this.strings[e],i}getTemplateElement(){const e=document.createElement("template");let i=this.getHTML();return mX!==void 0&&(i=mX.createHTML(i)),e.innerHTML=i,e}};const nWe=t=>t===null||!(typeof t=="object"||typeof t=="function"),sWe=t=>Array.isArray(t)||!(!t||!t[Symbol.iterator]);class PG{constructor(e){this.value=void 0,this.__pendingValue=void 0,this.options=e}appendInto(e){this.startNode=e.appendChild(xm()),this.endNode=e.appendChild(xm())}insertAfterNode(e){this.startNode=e,this.endNode=e.nextSibling}appendIntoPart(e){e.__insert(this.startNode=xm()),e.__insert(this.endNode=xm())}insertAfterPart(e){e.__insert(this.startNode=xm()),this.endNode=e.endNode,e.endNode=this.startNode}setValue(e){this.__pendingValue=e}commit(){if(this.startNode.parentNode===null)return;for(;tWe(this.__pendingValue);){const i=this.__pendingValue;this.__pendingValue=pX,i(this)}const e=this.__pendingValue;e!==pX&&(nWe(e)?e!==this.value&&this.__commitText(e):e instanceof rWe?this.__commitTemplateResult(e):e instanceof Node?this.__commitNode(e):sWe(e)?this.__commitIterable(e):e===fX?(this.value=fX,this.clear()):this.__commitText(e))}__insert(e){this.endNode.parentNode.insertBefore(e,this.endNode)}__commitNode(e){this.value!==e&&(this.clear(),this.__insert(e),this.value=e)}__commitText(e){const i=this.startNode.nextSibling,r=typeof(e=e??"")=="string"?e:String(e);i===this.endNode.previousSibling&&i.nodeType===3?i.data=r:this.__commitNode(document.createTextNode(r)),this.value=e}__commitTemplateResult(e){const i=this.options.templateFactory(e);if(this.value instanceof Dj&&this.value.template===i)this.value.update(e.values);else{const r=new Dj(i,e.processor,this.options),n=r._clone();r.update(e.values),this.__commitNode(n),this.value=r}}__commitIterable(e){Array.isArray(this.value)||(this.value=[],this.clear());const i=this.value;let r,n=0;for(const s of e)r=i[n],r===void 0&&(r=new PG(this.options),i.push(r),n===0?r.appendIntoPart(this):r.insertAfterPart(i[n-1])),r.setValue(s),r.commit(),n++;n<i.length&&(i.length=n,this.clear(r&&r.endNode))}clear(e=this.startNode){AG(this.startNode.parentNode,e.nextSibling,this.endNode)}}let oWe=!1;function aWe(t){let e=TT.get(t.type);e===void 0&&(e={stringsArray:new WeakMap,keyString:new Map},TT.set(t.type,e));let i=e.stringsArray.get(t.strings);if(i!==void 0)return i;const r=t.strings.join(cp);return i=e.keyString.get(r),i===void 0&&(i=new Pme(t,t.getTemplateElement()),e.keyString.set(r,i)),e.stringsArray.set(t.strings,i),i}(()=>{try{const t={get capture(){return oWe=!0,!1}};window.addEventListener("test",t,t),window.removeEventListener("test",t,t)}catch{}})();const TT=new Map,hw=new WeakMap,lWe=(t,e,i)=>{let r=hw.get(e);r===void 0&&(AG(e,e.firstChild),hw.set(e,r=new PG(Object.assign({templateFactory:aWe},i))),r.appendInto(e)),r.setValue(t),r.commit()};typeof window<"u"&&(window.litHtmlVersions||(window.litHtmlVersions=[])).push("1.4.1");const Rme=(t,e)=>`${t}--${e}`;let YP=!0;window.ShadyCSS===void 0?YP=!1:window.ShadyCSS.prepareTemplateDom===void 0&&(console.warn("Incompatible ShadyCSS version detected. Please update to at least @webcomponents/webcomponentsjs@2.0.2 and @webcomponents/shadycss@1.3.1."),YP=!1);const cWe=t=>e=>{const i=Rme(e.type,t);let r=TT.get(i);r===void 0&&(r={stringsArray:new WeakMap,keyString:new Map},TT.set(i,r));let n=r.stringsArray.get(e.strings);if(n!==void 0)return n;const s=e.strings.join(cp);if(n=r.keyString.get(s),n===void 0){const o=e.getTemplateElement();YP&&window.ShadyCSS.prepareTemplateDom(o,t),n=new Pme(e,o),r.keyString.set(s,n)}return r.stringsArray.set(e.strings,n),n},uWe=["html","svg"],dWe=t=>{uWe.forEach(e=>{const i=TT.get(Rme(e,t));i!==void 0&&i.keyString.forEach(r=>{const{element:{content:n}}=r,s=new Set;Array.from(n.querySelectorAll("style")).forEach(o=>{s.add(o)}),Lme(r,s)})})},Fme=new Set,hWe=(t,e,i)=>{Fme.add(t);const r=i?i.element:document.createElement("template"),n=e.querySelectorAll("style"),{length:s}=n;if(s===0)return void window.ShadyCSS.prepareTemplateStyles(r,t);const o=document.createElement("style");for(let c=0;c<s;c++){const u=n[c];u.parentNode.removeChild(u),o.textContent+=u.textContent}dWe(t);const a=r.content;i?Qqe(i,o,a.firstChild):a.insertBefore(o,a.firstChild),window.ShadyCSS.prepareTemplateStyles(r,t);const l=a.querySelector("style");if(window.ShadyCSS.nativeShadow&&l!==null)e.insertBefore(l.cloneNode(!0),e.firstChild);else if(i){a.insertBefore(o,a.firstChild);const c=new Set;c.add(o),Lme(i,c)}},pWe=(t,e,i)=>{if(!i||typeof i!="object"||!i.scopeName)throw new Error("The `scopeName` option is required.");const r=i.scopeName,n=hw.has(e),s=YP&&e.nodeType===11&&!!e.host,o=s&&!Fme.has(r),a=o?document.createDocumentFragment():e;if(lWe(t,a,Object.assign({templateFactory:cWe(r)},i)),o){const l=hw.get(a);hw.delete(a);const c=l.value instanceof Dj?l.value.template:void 0;hWe(r,a,c),AG(e,e.firstChild),e.appendChild(a),hw.set(e,l)}!n&&s&&window.ShadyCSS.styleElement(e.host)};window.JSCompiler_renameProperty=(t,e)=>t;const Nj={toAttribute(t,e){switch(e){case Boolean:return t?"":null;case Object:case Array:return t==null?t:JSON.stringify(t)}return t},fromAttribute(t,e){switch(e){case Boolean:return t!==null;case Number:return t===null?null:Number(t);case Object:case Array:return JSON.parse(t)}return t}},Dme=(t,e)=>e!==t&&(e==e||t==t),W5={attribute:!0,type:String,converter:Nj,reflect:!1,hasChanged:Dme},J5=1,Z5=4,Y5=8,K5=16,Vj="finalized";class Nme extends HTMLElement{constructor(){super(),this.initialize()}static get observedAttributes(){this.finalize();const e=[];return this._classProperties.forEach((i,r)=>{const n=this._attributeNameForProperty(r,i);n!==void 0&&(this._attributeToPropertyMap.set(n,r),e.push(n))}),e}static _ensureClassProperties(){if(!this.hasOwnProperty(JSCompiler_renameProperty("_classProperties",this))){this._classProperties=new Map;const e=Object.getPrototypeOf(this)._classProperties;e!==void 0&&e.forEach((i,r)=>this._classProperties.set(r,i))}}static createProperty(e,i=W5){if(this._ensureClassProperties(),this._classProperties.set(e,i),i.noAccessor||this.prototype.hasOwnProperty(e))return;const r=typeof e=="symbol"?Symbol():`__${e}`,n=this.getPropertyDescriptor(e,r,i);n!==void 0&&Object.defineProperty(this.prototype,e,n)}static getPropertyDescriptor(e,i,r){return{get(){return this[i]},set(n){const s=this[e];this[i]=n,this.requestUpdateInternal(e,s,r)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this._classProperties&&this._classProperties.get(e)||W5}static finalize(){const e=Object.getPrototypeOf(this);if(e.hasOwnProperty(Vj)||e.finalize(),this[Vj]=!0,this._ensureClassProperties(),this._attributeToPropertyMap=new Map,this.hasOwnProperty(JSCompiler_renameProperty("properties",this))){const i=this.properties,r=[...Object.getOwnPropertyNames(i),...typeof Object.getOwnPropertySymbols=="function"?Object.getOwnPropertySymbols(i):[]];for(const n of r)this.createProperty(n,i[n])}}static _attributeNameForProperty(e,i){const r=i.attribute;return r===!1?void 0:typeof r=="string"?r:typeof e=="string"?e.toLowerCase():void 0}static _valueHasChanged(e,i,r=Dme){return r(e,i)}static _propertyValueFromAttribute(e,i){const r=i.type,n=i.converter||Nj,s=typeof n=="function"?n:n.fromAttribute;return s?s(e,r):e}static _propertyValueToAttribute(e,i){if(i.reflect===void 0)return;const r=i.type,n=i.converter;return(n&&n.toAttribute||Nj.toAttribute)(e,r)}initialize(){this._updateState=0,this._updatePromise=new Promise(e=>this._enableUpdatingResolver=e),this._changedProperties=new Map,this._saveInstanceProperties(),this.requestUpdateInternal()}_saveInstanceProperties(){this.constructor._classProperties.forEach((e,i)=>{if(this.hasOwnProperty(i)){const r=this[i];delete this[i],this._instanceProperties||(this._instanceProperties=new Map),this._instanceProperties.set(i,r)}})}_applyInstanceProperties(){this._instanceProperties.forEach((e,i)=>this[i]=e),this._instanceProperties=void 0}connectedCallback(){this.enableUpdating()}enableUpdating(){this._enableUpdatingResolver!==void 0&&(this._enableUpdatingResolver(),this._enableUpdatingResolver=void 0)}disconnectedCallback(){}attributeChangedCallback(e,i,r){i!==r&&this._attributeToProperty(e,r)}_propertyToAttribute(e,i,r=W5){const n=this.constructor,s=n._attributeNameForProperty(e,r);if(s!==void 0){const o=n._propertyValueToAttribute(i,r);if(o===void 0)return;this._updateState=this._updateState|Y5,o==null?this.removeAttribute(s):this.setAttribute(s,o),this._updateState=this._updateState&~Y5}}_attributeToProperty(e,i){if(this._updateState&Y5)return;const r=this.constructor,n=r._attributeToPropertyMap.get(e);if(n!==void 0){const s=r.getPropertyOptions(n);this._updateState=this._updateState|K5,this[n]=r._propertyValueFromAttribute(i,s),this._updateState=this._updateState&~K5}}requestUpdateInternal(e,i,r){let n=!0;if(e!==void 0){const s=this.constructor;r=r||s.getPropertyOptions(e),s._valueHasChanged(this[e],i,r.hasChanged)?(this._changedProperties.has(e)||this._changedProperties.set(e,i),r.reflect!==!0||this._updateState&K5||(this._reflectingProperties===void 0&&(this._reflectingProperties=new Map),this._reflectingProperties.set(e,r))):n=!1}!this._hasRequestedUpdate&&n&&(this._updatePromise=this._enqueueUpdate())}requestUpdate(e,i){return this.requestUpdateInternal(e,i),this.updateComplete}async _enqueueUpdate(){this._updateState=this._updateState|Z5;try{await this._updatePromise}catch{}const e=this.performUpdate();return e!=null&&await e,!this._hasRequestedUpdate}get _hasRequestedUpdate(){return this._updateState&Z5}get hasUpdated(){return this._updateState&J5}performUpdate(){if(!this._hasRequestedUpdate)return;this._instanceProperties&&this._applyInstanceProperties();let e=!1;const i=this._changedProperties;try{e=this.shouldUpdate(i),e?this.update(i):this._markUpdated()}catch(r){throw e=!1,this._markUpdated(),r}e&&(this._updateState&J5||(this._updateState=this._updateState|J5,this.firstUpdated(i)),this.updated(i))}_markUpdated(){this._changedProperties=new Map,this._updateState=this._updateState&~Z5}get updateComplete(){return this._getUpdateComplete()}_getUpdateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._updatePromise}shouldUpdate(e){return!0}update(e){this._reflectingProperties!==void 0&&this._reflectingProperties.size>0&&(this._reflectingProperties.forEach((i,r)=>this._propertyToAttribute(r,this[r],i)),this._reflectingProperties=void 0),this._markUpdated()}updated(e){}firstUpdated(e){}}Nme[Vj]=!0;const zj=window.ShadowRoot&&(window.ShadyCSS===void 0||window.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,OG=Symbol();class uR{constructor(e,i){if(i!==OG)throw new Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e}get styleSheet(){return this._styleSheet===void 0&&(zj?(this._styleSheet=new CSSStyleSheet,this._styleSheet.replaceSync(this.cssText)):this._styleSheet=null),this._styleSheet}toString(){return this.cssText}}const fWe=t=>new uR(String(t),OG),mWe=t=>{if(t instanceof uR)return t.cssText;if(typeof t=="number")return t;throw new Error(`Value passed to 'css' function must be a 'css' function result: ${t}. Use 'unsafeCSS' to pass non-literal values, but
            take care to ensure page security.`)},CT=(t,...e)=>{const i=e.reduce((r,n,s)=>r+mWe(n)+t[s+1],t[0]);return new uR(i,OG)};(window.litElementVersions||(window.litElementVersions=[])).push("2.5.1");const gX={};class X5 extends Nme{static getStyles(){return this.styles}static _getUniqueStyles(){if(this.hasOwnProperty(JSCompiler_renameProperty("_styles",this)))return;const e=this.getStyles();if(Array.isArray(e)){const i=(s,o)=>s.reduceRight((a,l)=>Array.isArray(l)?i(l,a):(a.add(l),a),o),r=i(e,new Set),n=[];r.forEach(s=>n.unshift(s)),this._styles=n}else this._styles=e===void 0?[]:[e];this._styles=this._styles.map(i=>{if(i instanceof CSSStyleSheet&&!zj){const r=Array.prototype.slice.call(i.cssRules).reduce((n,s)=>n+s.cssText,"");return fWe(r)}return i})}initialize(){super.initialize(),this.constructor._getUniqueStyles(),this.renderRoot=this.createRenderRoot(),window.ShadowRoot&&this.renderRoot instanceof window.ShadowRoot&&this.adoptStyles()}createRenderRoot(){return this.attachShadow(this.constructor.shadowRootOptions)}adoptStyles(){const e=this.constructor._styles;e.length!==0&&(window.ShadyCSS===void 0||window.ShadyCSS.nativeShadow?zj?this.renderRoot.adoptedStyleSheets=e.map(i=>i instanceof CSSStyleSheet?i:i.styleSheet):this._needsShimAdoptedStyleSheets=!0:window.ShadyCSS.ScopingShim.prepareAdoptedCssText(e.map(i=>i.cssText),this.localName))}connectedCallback(){super.connectedCallback(),this.hasUpdated&&window.ShadyCSS!==void 0&&window.ShadyCSS.styleElement(this)}update(e){const i=this.render();super.update(e),i!==gX&&this.constructor.render(i,this.renderRoot,{scopeName:this.localName,eventContext:this}),this._needsShimAdoptedStyleSheets&&(this._needsShimAdoptedStyleSheets=!1,this.constructor._styles.forEach(r=>{const n=document.createElement("style");n.textContent=r.cssText,this.renderRoot.appendChild(n)}))}render(){return gX}}X5.finalized=!0,X5.render=pWe,X5.shadowRootOptions={mode:"open"};let yX=0;const Q5={},ET=(t,e,i)=>{const r=i&&i.moduleId||"custom-style-module-"+yX++;Array.isArray(e)||(e=e?[e]:[]),e.forEach(o=>{if(!(o instanceof uR))throw new Error("An item in styles is not of type CSSResult. Use `unsafeCSS` or `css`.");if(!Q5[o]){const a=document.createElement("dom-module");a.innerHTML=`
        <template>
          <style>${o.toString()}</style>
        </template>
      `;const l="custom-style-module-"+yX++;a.register(l),Q5[o]=l}});const n=document.createElement("dom-module");if(t){const o=window.customElements&&window.customElements.get(t);o&&o.hasOwnProperty("__finalized")&&console.warn(`The custom element definition for "${t}"
      was finalized before a style module was registered.
      Make sure to add component specific style modules before
      importing the corresponding custom element.`),n.setAttribute("theme-for",t)}const s=i&&i.include||[];n.innerHTML=`
    <template>
      ${s.map(o=>`<style include=${o}></style>`)}
      ${e.map(o=>`<style include=${Q5[o]}></style>`)}
    </template>
  `,n.register(r)};ET("vaadin-checkbox",CT`
    :host {
      -webkit-tap-highlight-color: transparent;
      -webkit-user-select: none;
      -moz-user-select: none;
      user-select: none;
      cursor: default;
      outline: none;
    }

    [part='label']:not([empty]) {
      margin: 0.1875em 0.875em 0.1875em 0.375em;
    }

    [part='checkbox'] {
      width: calc(1em + 2px);
      height: calc(1em + 2px);
      margin: 0.1875em;
      position: relative;
      border-radius: var(--lumo-border-radius-s);
      background-color: var(--lumo-contrast-20pct);
      transition: transform 0.2s cubic-bezier(0.12, 0.32, 0.54, 2), background-color 0.15s;
      pointer-events: none;
      line-height: 1.2;
    }

    :host([indeterminate]) [part='checkbox'],
    :host([checked]) [part='checkbox'] {
      background-color: var(--lumo-primary-color);
    }

    /* Needed to align the checkbox nicely on the baseline */
    [part='checkbox']::before {
      content: '\\2003';
    }

    /* Checkmark */
    [part='checkbox']::after {
      content: '';
      display: inline-block;
      width: 0;
      height: 0;
      border: 0 solid var(--lumo-primary-contrast-color);
      border-width: 0.1875em 0 0 0.1875em;
      box-sizing: border-box;
      transform-origin: 0 0;
      position: absolute;
      top: 0.8125em;
      left: 0.5em;
      transform: scale(0.55) rotate(-135deg);
      opacity: 0;
    }

    :host([checked]) [part='checkbox']::after {
      opacity: 1;
      width: 0.625em;
      height: 1.0625em;
    }

    /* Indeterminate checkmark */
    :host([indeterminate]) [part='checkbox']::after {
      transform: none;
      opacity: 1;
      top: 45%;
      height: 10%;
      left: 22%;
      right: 22%;
      width: auto;
      border: 0;
      background-color: var(--lumo-primary-contrast-color);
      transition: opacity 0.25s;
    }

    /* Focus ring */
    :host([focus-ring]) [part='checkbox'] {
      box-shadow: 0 0 0 3px var(--lumo-primary-color-50pct);
    }

    /* Disabled */
    :host([disabled]) {
      pointer-events: none;
      color: var(--lumo-disabled-text-color);
    }

    :host([disabled]) [part='label'] ::slotted(*) {
      color: inherit;
    }

    :host([disabled]) [part='checkbox'] {
      background-color: var(--lumo-contrast-10pct);
    }

    :host([disabled]) [part='checkbox']::after {
      border-color: var(--lumo-contrast-30pct);
    }

    :host([indeterminate][disabled]) [part='checkbox']::after {
      background-color: var(--lumo-contrast-30pct);
    }

    /* RTL specific styles */
    :host([dir='rtl']) [part='label']:not([empty]) {
      margin: 0.1875em 0.375em 0.1875em 0.875em;
    }

    /* Transition the checkmark if activated with the mouse (disabled for grid select-all this way) */
    :host(:hover) [part='checkbox']::after {
      transition: width 0.1s, height 0.25s;
    }

    /* Used for activation "halo" */
    [part='checkbox']::before {
      color: transparent;
      display: inline-block;
      width: 100%;
      height: 100%;
      border-radius: inherit;
      background-color: inherit;
      transform: scale(1.4);
      opacity: 0;
      transition: transform 0.1s, opacity 0.8s;
    }

    /* Hover */
    :host(:not([checked]):not([indeterminate]):not([disabled]):hover) [part='checkbox'] {
      background-color: var(--lumo-contrast-30pct);
    }

    /* Disable hover for touch devices */
    @media (pointer: coarse) {
      :host(:not([checked]):not([indeterminate]):not([disabled]):hover) [part='checkbox'] {
        background-color: var(--lumo-contrast-20pct);
      }
    }

    /* Active */
    :host([active]) [part='checkbox'] {
      transform: scale(0.9);
      transition-duration: 0.05s;
    }

    :host([active][checked]) [part='checkbox'] {
      transform: scale(1.1);
    }

    :host([active]:not([checked])) [part='checkbox']::before {
      transition-duration: 0.01s, 0.01s;
      transform: scale(0);
      opacity: 0.4;
    }
  `,{moduleId:"lumo-checkbox"});let gWe=0;const ul=function(t){let e=t.__mixinApplications;e||(e=new WeakMap,t.__mixinApplications=e);let i=gWe++;function r(n){let s=n.__mixinSet;if(s&&s[i])return n;let o=e,a=o.get(n);if(!a){a=t(n),o.set(n,a);let l=Object.create(a.__mixinSet||s||null);l[i]=!0,a.__mixinSet=l}return a}return r},Ve=window.ShadyDOM&&window.ShadyDOM.noPatch&&window.ShadyDOM.wrap?window.ShadyDOM.wrap:window.ShadyDOM?t=>ShadyDOM.patch(t):t=>t;function jj(t){return t.indexOf(".")>=0}function kp(t){let e=t.indexOf(".");return e===-1?t:t.slice(0,e)}function Vme(t,e){return t.indexOf(e+".")===0}function MT(t,e){return e.indexOf(t+".")===0}function $T(t,e,i){return e+i.slice(t.length)}function yWe(t,e){return t===e||Vme(t,e)||MT(t,e)}function v2(t){if(Array.isArray(t)){let e=[];for(let i=0;i<t.length;i++){let r=t[i].toString().split(".");for(let n=0;n<r.length;n++)e.push(r[n])}return e.join(".")}return t}function zme(t){return Array.isArray(t)?v2(t).split("."):t.toString().split(".")}function ko(t,e,i){let r=t,n=zme(e);for(let s=0;s<n.length;s++){if(!r)return;r=r[n[s]]}return i&&(i.path=n.join(".")),r}function vX(t,e,i){let r=t,n=zme(e),s=n[n.length-1];if(n.length>1){for(let o=0;o<n.length-1;o++)if(r=r[n[o]],!r)return;r[s]=i}else r[e]=i;return n.join(".")}const KP={},vWe=/-[a-z]/g,_We=/([A-Z])/g;function jme(t){return KP[t]||(KP[t]=t.indexOf("-")<0?t:t.replace(vWe,e=>e[1].toUpperCase()))}function dR(t){return KP[t]||(KP[t]=t.replace(_We,"-$1").toLowerCase())}let bWe=0,Bme=0,Fw=[],wWe=0,Bj=!1,Ume=document.createTextNode("");function xWe(){Bj=!1;const t=Fw.length;for(let e=0;e<t;e++){let i=Fw[e];if(i)try{i()}catch(r){setTimeout(()=>{throw r})}}Fw.splice(0,t),Bme+=t}new window.MutationObserver(xWe).observe(Ume,{characterData:!0});const bu={after:t=>({run:e=>window.setTimeout(e,t),cancel(e){window.clearTimeout(e)}}),run:(t,e)=>window.setTimeout(t,e),cancel(t){window.clearTimeout(t)}},up={run:t=>window.requestAnimationFrame(t),cancel(t){window.cancelAnimationFrame(t)}},Gme={run:t=>window.requestIdleCallback?window.requestIdleCallback(t):window.setTimeout(t,16),cancel(t){window.cancelIdleCallback?window.cancelIdleCallback(t):window.clearTimeout(t)}},nc={run:t=>(Bj||(Bj=!0,Ume.textContent=wWe++),Fw.push(t),bWe++),cancel(t){const e=t-Bme;if(e>=0){if(!Fw[e])throw new Error("invalid async handle: "+t);Fw[e]=null}}},SWe=nc,Hme=ul(t=>{class e extends t{static createProperties(r){const n=this.prototype;for(let s in r)s in n||n._createPropertyAccessor(s)}static attributeNameForProperty(r){return r.toLowerCase()}static typeForProperty(r){}_createPropertyAccessor(r,n){this._addPropertyToAttributeMap(r),this.hasOwnProperty(JSCompiler_renameProperty("__dataHasAccessor",this))||(this.__dataHasAccessor=Object.assign({},this.__dataHasAccessor)),this.__dataHasAccessor[r]||(this.__dataHasAccessor[r]=!0,this._definePropertyAccessor(r,n))}_addPropertyToAttributeMap(r){this.hasOwnProperty(JSCompiler_renameProperty("__dataAttributes",this))||(this.__dataAttributes=Object.assign({},this.__dataAttributes));let n=this.__dataAttributes[r];return n||(n=this.constructor.attributeNameForProperty(r),this.__dataAttributes[n]=r),n}_definePropertyAccessor(r,n){Object.defineProperty(this,r,{get(){return this.__data[r]},set:n?function(){}:function(s){this._setPendingProperty(r,s,!0)&&this._invalidateProperties()}})}constructor(){super(),this.__dataEnabled=!1,this.__dataReady=!1,this.__dataInvalid=!1,this.__data={},this.__dataPending=null,this.__dataOld=null,this.__dataInstanceProps=null,this.__dataCounter=0,this.__serializing=!1,this._initializeProperties()}ready(){this.__dataReady=!0,this._flushProperties()}_initializeProperties(){for(let r in this.__dataHasAccessor)this.hasOwnProperty(r)&&(this.__dataInstanceProps=this.__dataInstanceProps||{},this.__dataInstanceProps[r]=this[r],delete this[r])}_initializeInstanceProperties(r){Object.assign(this,r)}_setProperty(r,n){this._setPendingProperty(r,n)&&this._invalidateProperties()}_getProperty(r){return this.__data[r]}_setPendingProperty(r,n,s){let o=this.__data[r],a=this._shouldPropertyChange(r,n,o);return a&&(this.__dataPending||(this.__dataPending={},this.__dataOld={}),this.__dataOld&&!(r in this.__dataOld)&&(this.__dataOld[r]=o),this.__data[r]=n,this.__dataPending[r]=n),a}_isPropertyPending(r){return!(!this.__dataPending||!this.__dataPending.hasOwnProperty(r))}_invalidateProperties(){!this.__dataInvalid&&this.__dataReady&&(this.__dataInvalid=!0,SWe.run(()=>{this.__dataInvalid&&(this.__dataInvalid=!1,this._flushProperties())}))}_enableProperties(){this.__dataEnabled||(this.__dataEnabled=!0,this.__dataInstanceProps&&(this._initializeInstanceProperties(this.__dataInstanceProps),this.__dataInstanceProps=null),this.ready())}_flushProperties(){this.__dataCounter++;const r=this.__data,n=this.__dataPending,s=this.__dataOld;this._shouldPropertiesChange(r,n,s)&&(this.__dataPending=null,this.__dataOld=null,this._propertiesChanged(r,n,s)),this.__dataCounter--}_shouldPropertiesChange(r,n,s){return!!n}_propertiesChanged(r,n,s){}_shouldPropertyChange(r,n,s){return s!==n&&(s==s||n==n)}attributeChangedCallback(r,n,s,o){n!==s&&this._attributeToProperty(r,s),super.attributeChangedCallback&&super.attributeChangedCallback(r,n,s,o)}_attributeToProperty(r,n,s){if(!this.__serializing){const o=this.__dataAttributes,a=o&&o[r]||r;this[a]=this._deserializeValue(n,s||this.constructor.typeForProperty(a))}}_propertyToAttribute(r,n,s){this.__serializing=!0,s=arguments.length<3?this[r]:s,this._valueToNodeAttribute(this,s,n||this.constructor.attributeNameForProperty(r)),this.__serializing=!1}_valueToNodeAttribute(r,n,s){const o=this._serializeValue(n);s!=="class"&&s!=="name"&&s!=="slot"||(r=Ve(r)),o===void 0?r.removeAttribute(s):r.setAttribute(s,o)}_serializeValue(r){return typeof r=="boolean"?r?"":void 0:r!=null?r.toString():void 0}_deserializeValue(r,n){switch(n){case Boolean:return r!==null;case Number:return Number(r);default:return r}}}return e}),qme={};let wM=HTMLElement.prototype;for(;wM;){let t=Object.getOwnPropertyNames(wM);for(let e=0;e<t.length;e++)qme[t[e]]=!0;wM=Object.getPrototypeOf(wM)}function IWe(t,e){if(!qme[e]){let i=t[e];i!==void 0&&(t.__data?t._setPendingProperty(e,i):(t.__dataProto?t.hasOwnProperty(JSCompiler_renameProperty("__dataProto",t))||(t.__dataProto=Object.create(t.__dataProto)):t.__dataProto={},t.__dataProto[e]=i))}}const Wme=ul(t=>{const e=Hme(t);class i extends e{static createPropertiesForAttributes(){let n=this.observedAttributes;for(let s=0;s<n.length;s++)this.prototype._createPropertyAccessor(jme(n[s]))}static attributeNameForProperty(n){return dR(n)}_initializeProperties(){this.__dataProto&&(this._initializeProtoProperties(this.__dataProto),this.__dataProto=null),super._initializeProperties()}_initializeProtoProperties(n){for(let s in n)this._setProperty(s,n[s])}_ensureAttribute(n,s){const o=this;o.hasAttribute(n)||this._valueToNodeAttribute(o,s,n)}_serializeValue(n){if(typeof n=="object"){if(n instanceof Date)return n.toString();if(n)try{return JSON.stringify(n)}catch{return""}}return super._serializeValue(n)}_deserializeValue(n,s){let o;switch(s){case Object:try{o=JSON.parse(n)}catch{o=n}break;case Array:try{o=JSON.parse(n)}catch{o=null,console.warn(`Polymer::Attributes: couldn't decode Array as JSON: ${n}`)}break;case Date:o=isNaN(n)?String(n):Number(n),o=new Date(o);break;default:o=super._deserializeValue(n,s)}return o}_definePropertyAccessor(n,s){IWe(this,n),super._definePropertyAccessor(n,s)}_hasAccessor(n){return this.__dataHasAccessor&&this.__dataHasAccessor[n]}_isPropertyPending(n){return!!(this.__dataPending&&n in this.__dataPending)}}return i}),TWe={"dom-if":!0,"dom-repeat":!0};let _X=!1,bX=!1;function CWe(){if(!_X){_X=!0;const t=document.createElement("textarea");t.placeholder="a",bX=t.placeholder===t.textContent}return bX}function EWe(t){CWe()&&t.localName==="textarea"&&t.placeholder&&t.placeholder===t.textContent&&(t.textContent=null)}function MWe(t){let e=t.getAttribute("is");if(e&&TWe[e]){let i=t;for(i.removeAttribute("is"),t=i.ownerDocument.createElement(e),i.parentNode.replaceChild(t,i),t.appendChild(i);i.attributes.length;)t.setAttribute(i.attributes[0].name,i.attributes[0].value),i.removeAttribute(i.attributes[0].name)}return t}function Jme(t,e){let i=e.parentInfo&&Jme(t,e.parentInfo);if(!i)return t;for(let r=i.firstChild,n=0;r;r=r.nextSibling)if(e.parentIndex===n++)return r}function $We(t,e,i,r){r.id&&(e[r.id]=i)}function AWe(t,e,i){if(i.events&&i.events.length)for(let r,n=0,s=i.events;n<s.length&&(r=s[n]);n++)t._addMethodEventListenerToNode(e,r.name,r.value,t)}function kWe(t,e,i,r){i.templateInfo&&(e._templateInfo=i.templateInfo,e._parentTemplateInfo=r)}function PWe(t,e,i){return t=t._methodHost||t,function(r){t[i]?t[i](r,r.detail):console.warn("listener method `"+i+"` not defined")}}const OWe=ul(t=>{class e extends t{static _parseTemplate(r,n){if(!r._templateInfo){let s=r._templateInfo={};s.nodeInfoList=[],s.nestedTemplate=!!n,s.stripWhiteSpace=n&&n.stripWhiteSpace||r.hasAttribute("strip-whitespace"),this._parseTemplateContent(r,s,{parent:null})}return r._templateInfo}static _parseTemplateContent(r,n,s){return this._parseTemplateNode(r.content,n,s)}static _parseTemplateNode(r,n,s){let o=!1,a=r;return a.localName!="template"||a.hasAttribute("preserve-content")?a.localName==="slot"&&(n.hasInsertionPoint=!0):o=this._parseTemplateNestedTemplate(a,n,s)||o,EWe(a),a.firstChild&&this._parseTemplateChildNodes(a,n,s),a.hasAttributes&&a.hasAttributes()&&(o=this._parseTemplateNodeAttributes(a,n,s)||o),o||s.noted}static _parseTemplateChildNodes(r,n,s){if(r.localName!=="script"&&r.localName!=="style")for(let o,a=r.firstChild,l=0;a;a=o){if(a.localName=="template"&&(a=MWe(a)),o=a.nextSibling,a.nodeType===Node.TEXT_NODE){let u=o;for(;u&&u.nodeType===Node.TEXT_NODE;)a.textContent+=u.textContent,o=u.nextSibling,r.removeChild(u),u=o;if(n.stripWhiteSpace&&!a.textContent.trim()){r.removeChild(a);continue}}let c={parentIndex:l,parentInfo:s};this._parseTemplateNode(a,n,c)&&(c.infoIndex=n.nodeInfoList.push(c)-1),a.parentNode&&l++}}static _parseTemplateNestedTemplate(r,n,s){let o=r,a=this._parseTemplate(o,n);return(a.content=o.content.ownerDocument.createDocumentFragment()).appendChild(o.content),s.templateInfo=a,!0}static _parseTemplateNodeAttributes(r,n,s){let o=!1,a=Array.from(r.attributes);for(let l,c=a.length-1;l=a[c];c--)o=this._parseTemplateNodeAttribute(r,n,s,l.name,l.value)||o;return o}static _parseTemplateNodeAttribute(r,n,s,o,a){return o.slice(0,3)==="on-"?(r.removeAttribute(o),s.events=s.events||[],s.events.push({name:o.slice(3),value:a}),!0):o==="id"&&(s.id=a,!0)}static _contentForTemplate(r){let n=r._templateInfo;return n&&n.content||r.content}_stampTemplate(r,n){r&&!r.content&&window.HTMLTemplateElement&&HTMLTemplateElement.decorate&&HTMLTemplateElement.decorate(r);let s=(n=n||this.constructor._parseTemplate(r)).nodeInfoList,o=n.content||r.content,a=document.importNode(o,!0);a.__noInsertionPoint=!n.hasInsertionPoint;let l=a.nodeList=new Array(s.length);a.$={};for(let c,u=0,h=s.length;u<h&&(c=s[u]);u++){let f=l[u]=Jme(a,c);$We(this,a.$,f,c),kWe(this,f,c,n),AWe(this,f,c)}return a}_addMethodEventListenerToNode(r,n,s,o){let a=PWe(o=o||r,n,s);return this._addEventListenerToNode(r,n,a),a}_addEventListenerToNode(r,n,s){r.addEventListener(n,s)}_removeEventListenerFromNode(r,n,s){r.removeEventListener(n,s)}}return e});let AT=0;const kT=[],ci={COMPUTE:"__computeEffects",REFLECT:"__reflectEffects",NOTIFY:"__notifyEffects",PROPAGATE:"__propagateEffects",OBSERVE:"__observeEffects",READ_ONLY:"__readOnly"},Zme="__computeInfo",LWe=/[A-Z]/;function eF(t,e,i){let r=t[e];if(r){if(!t.hasOwnProperty(e)&&(r=t[e]=Object.create(t[e]),i))for(let n in r){let s=r[n],o=r[n]=Array(s.length);for(let a=0;a<s.length;a++)o[a]=s[a]}}else r=t[e]={};return r}function _2(t,e,i,r,n,s){if(e){let o=!1;const a=AT++;for(let l in i){let c=e[n?kp(l):l];if(c)for(let u,h=0,f=c.length;h<f&&(u=c[h]);h++)u.info&&u.info.lastRun===a||n&&!LG(l,u.trigger)||(u.info&&(u.info.lastRun=a),u.fn(t,l,i,r,u.info,n,s),o=!0)}return o}return!1}function RWe(t,e,i,r,n,s,o,a){let l=!1,c=e[o?kp(r):r];if(c)for(let u,h=0,f=c.length;h<f&&(u=c[h]);h++)u.info&&u.info.lastRun===i||o&&!LG(r,u.trigger)||(u.info&&(u.info.lastRun=i),u.fn(t,r,n,s,u.info,o,a),l=!0);return l}function LG(t,e){if(e){let i=e.name;return i==t||!(!e.structured||!Vme(i,t))||!(!e.wildcard||!MT(i,t))}return!0}function wX(t,e,i,r,n){let s=typeof n.method=="string"?t[n.method]:n.method,o=n.property;s?s.call(t,t.__data[o],r[o]):n.dynamicFn||console.warn("observer method `"+n.method+"` not defined")}function FWe(t,e,i,r,n){let s,o,a=t[ci.NOTIFY],l=AT++;for(let c in e)e[c]&&(a&&RWe(t,a,l,c,i,r,n)||n&&DWe(t,c,i))&&(s=!0);s&&(o=t.__dataHost)&&o._invalidateProperties&&o._invalidateProperties()}function DWe(t,e,i){let r=kp(e);return r!==e?(Yme(t,dR(r)+"-changed",i[e],e),!0):!1}function Yme(t,e,i,r){let n={value:i,queueProperty:!0};r&&(n.path=r),Ve(t).dispatchEvent(new CustomEvent(e,{detail:n}))}function NWe(t,e,i,r,n,s){let o=(s?kp(e):e)!=e?e:null,a=o?ko(t,o):t.__data[e];o&&a===void 0&&(a=i[e]),Yme(t,n.eventName,a,o)}function VWe(t,e,i,r,n){let s,o=t.detail,a=o&&o.path;a?(r=$T(i,r,a),s=o&&o.value):s=t.currentTarget[i],s=n?!s:s,e[ci.READ_ONLY]&&e[ci.READ_ONLY][r]||!e._setPendingPropertyOrPath(r,s,!0,!!a)||o&&o.queueProperty||e._invalidateProperties()}function zWe(t,e,i,r,n){let s=t.__data[e];ZP&&(s=ZP(s,n.attrName,"attribute",t)),t._propertyToAttribute(e,n.attrName,s)}function jWe(t,e,i,r){let n=t[ci.COMPUTE];if(n)if(Nqe){AT++;const s=UWe(t),o=[];for(let l in e)xX(l,n,o,s,r);let a;for(;a=o.shift();)Kme(t,"",e,i,a)&&xX(a.methodInfo,n,o,s,r);Object.assign(i,t.__dataOld),Object.assign(e,t.__dataPending),t.__dataPending=null}else{let s=e;for(;_2(t,n,s,i,r);)Object.assign(i,t.__dataOld),Object.assign(e,t.__dataPending),s=t.__dataPending,t.__dataPending=null}}const BWe=(t,e,i)=>{let r=0,n=e.length-1,s=-1;for(;r<=n;){const o=r+n>>1,a=i.get(e[o].methodInfo)-i.get(t.methodInfo);if(a<0)r=o+1;else{if(!(a>0)){s=o;break}n=o-1}}s<0&&(s=n+1),e.splice(s,0,t)},xX=(t,e,i,r,n)=>{const s=e[n?kp(t):t];if(s)for(let o=0;o<s.length;o++){const a=s[o];a.info.lastRun===AT||n&&!LG(t,a.trigger)||(a.info.lastRun=AT,BWe(a.info,i,r))}};function UWe(t){let e=t.constructor.__orderedComputedDeps;if(!e){e=new Map;const i=t[ci.COMPUTE];let r,{counts:n,ready:s,total:o}=GWe(t);for(;r=s.shift();){e.set(r,e.size);const a=i[r];a&&a.forEach(l=>{const c=l.info.methodInfo;--o,--n[c]==0&&s.push(c)})}o!==0&&console.warn(`Computed graph for ${t.localName} incomplete; circular?`),t.constructor.__orderedComputedDeps=e}return e}function GWe(t){const e=t[Zme],i={},r=t[ci.COMPUTE],n=[];let s=0;for(let o in e){const a=e[o];s+=i[o]=a.args.filter(l=>!l.literal).length+(a.dynamicFn?1:0)}for(let o in r)e[o]||n.push(o);return{counts:i,ready:n,total:s}}function Kme(t,e,i,r,n){let s=Uj(t,e,i,r,n);if(s===kT)return!1;let o=n.methodInfo;return t.__dataHasAccessor&&t.__dataHasAccessor[o]?t._setPendingProperty(o,s,!0):(t[o]=s,!1)}function HWe(t,e,i){let r=t.__dataLinkedPaths;if(r){let n;for(let s in r){let o=r[s];MT(s,e)?(n=$T(s,o,e),t._setPendingPropertyOrPath(n,i,!0,!0)):MT(o,e)&&(n=$T(o,s,e),t._setPendingPropertyOrPath(n,i,!0,!0))}}}function tF(t,e,i,r,n,s,o){i.bindings=i.bindings||[];let a={kind:r,target:n,parts:s,literal:o,isCompound:s.length!==1};if(i.bindings.push(a),YWe(a)){let{event:c,negate:u}=a.parts[0];a.listenerEvent=c||dR(n)+"-changed",a.listenerNegate=u}let l=e.nodeInfoList.length;for(let c=0;c<a.parts.length;c++){let u=a.parts[c];u.compoundIndex=c,qWe(t,e,a,u,l)}}function qWe(t,e,i,r,n){if(!r.literal)if(i.kind==="attribute"&&i.target[0]==="-")console.warn("Cannot set attribute "+i.target+' because "-" is not a valid attribute starting character');else{let s=r.dependencies,o={index:n,binding:i,part:r,evaluator:t};for(let a=0;a<s.length;a++){let l=s[a];typeof l=="string"&&(l=Qme(l),l.wildcard=!0),t._addTemplatePropertyEffect(e,l.rootProperty,{fn:WWe,info:o,trigger:l})}}}function WWe(t,e,i,r,n,s,o){let a=o[n.index],l=n.binding,c=n.part;if(s&&c.source&&e.length>c.source.length&&l.kind=="property"&&!l.isCompound&&a.__isPropertyEffectsClient&&a.__dataHasAccessor&&a.__dataHasAccessor[l.target]){let u=i[e];e=$T(c.source,l.target,e),a._setPendingPropertyOrPath(e,u,!1,!0)&&t._enqueueClient(a)}else{let u=n.evaluator._evaluateBinding(t,c,e,i,r,s);u!==kT&&JWe(t,a,l,c,u)}}function JWe(t,e,i,r,n){if(n=ZWe(e,n,i,r),ZP&&(n=ZP(n,i.target,i.kind,e)),i.kind=="attribute")t._valueToNodeAttribute(e,n,i.target);else{let s=i.target;e.__isPropertyEffectsClient&&e.__dataHasAccessor&&e.__dataHasAccessor[s]?e[ci.READ_ONLY]&&e[ci.READ_ONLY][s]||e._setPendingProperty(s,n)&&t._enqueueClient(e):t._setUnmanagedPropertyToNode(e,s,n)}}function ZWe(t,e,i,r){if(i.isCompound){let n=t.__dataCompoundStorage[i.target];n[r.compoundIndex]=e,e=n.join("")}return i.kind!=="attribute"&&(i.target!=="textContent"&&(i.target!=="value"||t.localName!=="input"&&t.localName!=="textarea")||(e=e??"")),e}function YWe(t){return!!t.target&&t.kind!="attribute"&&t.kind!="text"&&!t.isCompound&&t.parts[0].mode==="{"}function KWe(t,e){let{nodeList:i,nodeInfoList:r}=e;if(r.length)for(let n=0;n<r.length;n++){let s=r[n],o=i[n],a=s.bindings;if(a)for(let l=0;l<a.length;l++){let c=a[l];XWe(o,c),QWe(o,t,c)}o.__dataHost=t}}function XWe(t,e){if(e.isCompound){let i=t.__dataCompoundStorage||(t.__dataCompoundStorage={}),r=e.parts,n=new Array(r.length);for(let o=0;o<r.length;o++)n[o]=r[o].literal;let s=e.target;i[s]=n,e.literal&&e.kind=="property"&&(s==="className"&&(t=Ve(t)),t[s]=e.literal)}}function QWe(t,e,i){if(i.listenerEvent){let r=i.parts[0];t.addEventListener(i.listenerEvent,function(n){VWe(n,e,i.target,r.source,r.negate)})}}function SX(t,e,i,r,n,s){s=e.static||s&&(typeof s!="object"||s[e.methodName]);let o={methodName:e.methodName,args:e.args,methodInfo:n,dynamicFn:s};for(let a,l=0;l<e.args.length&&(a=e.args[l]);l++)a.literal||t._addPropertyEffect(a.rootProperty,i,{fn:r,info:o,trigger:a});return s&&t._addPropertyEffect(e.methodName,i,{fn:r,info:o}),o}function Uj(t,e,i,r,n){let s=t._methodHost||t,o=s[n.methodName];if(o){let a=t._marshalArgs(n.args,e,i);return a===kT?kT:o.apply(s,a)}n.dynamicFn||console.warn("method `"+n.methodName+"` not defined")}const eJe=[],Xme="(?:[a-zA-Z_$][\\w.:$\\-*]*)",IX="(?:("+Xme+`|(?:[-+]?[0-9]*\\.?[0-9]+(?:[eE][-+]?[0-9]+)?)|(?:(?:'(?:[^'\\\\]|\\\\.)*')|(?:"(?:[^"\\\\]|\\\\.)*")))\\s*)`,TX=new RegExp("(\\[\\[|{{)\\s*(?:(!)\\s*)?"+("("+Xme+"\\s*"+("(?:\\(\\s*(?:"+("(?:"+IX+"(?:,\\s*"+IX+")*)")+"?)\\)\\s*)")+"?)")+"(?:]]|}})","g");function CX(t){let e="";for(let i=0;i<t.length;i++)e+=t[i].literal||"";return e}function iF(t){let e=t.match(/([^\s]+?)\(([\s\S]*)\)/);if(e){let i={methodName:e[1],static:!0,args:eJe};return e[2].trim()?tJe(e[2].replace(/\\,/g,"&comma;").split(","),i):i}return null}function tJe(t,e){return e.args=t.map(function(i){let r=Qme(i);return r.literal||(e.static=!1),r},this),e}function Qme(t){let e=t.trim().replace(/&comma;/g,",").replace(/\\(.)/g,"$1"),i={name:e,value:"",literal:!1},r=e[0];switch(r==="-"&&(r=e[1]),r>="0"&&r<="9"&&(r="#"),r){case"'":case'"':i.value=e.slice(1,-1),i.literal=!0;break;case"#":i.value=Number(e),i.literal=!0}return i.literal||(i.rootProperty=kp(e),i.structured=jj(e),i.structured&&(i.wildcard=e.slice(-2)==".*",i.wildcard&&(i.name=e.slice(0,-2)))),i}function EX(t,e,i){let r=ko(t,i);return r===void 0&&(r=e[i]),r}function ege(t,e,i,r){const n={indexSplices:r};Lj&&!t._overrideLegacyUndefined&&(e.splices=n),t.notifyPath(i+".splices",n),t.notifyPath(i+".length",e.length),Lj&&!t._overrideLegacyUndefined&&(n.indexSplices=[])}function Bx(t,e,i,r,n,s){ege(t,e,i,[{index:r,addedCount:n,removed:s,object:e,type:"splice"}])}function iJe(t){return t[0].toUpperCase()+t.substring(1)}const hR=ul(t=>{const e=OWe(Wme(t));class i extends e{constructor(){super(),this.__isPropertyEffectsClient=!0,this.__dataClientsReady,this.__dataPendingClients,this.__dataToNotify,this.__dataLinkedPaths,this.__dataHasPaths,this.__dataCompoundStorage,this.__dataHost,this.__dataTemp,this.__dataClientsInitialized,this.__data,this.__dataPending,this.__dataOld,this.__computeEffects,this.__computeInfo,this.__reflectEffects,this.__notifyEffects,this.__propagateEffects,this.__observeEffects,this.__readOnly,this.__templateInfo,this._overrideLegacyUndefined}get PROPERTY_EFFECT_TYPES(){return ci}_initializeProperties(){super._initializeProperties(),this._registerHost(),this.__dataClientsReady=!1,this.__dataPendingClients=null,this.__dataToNotify=null,this.__dataLinkedPaths=null,this.__dataHasPaths=!1,this.__dataCompoundStorage=this.__dataCompoundStorage||null,this.__dataHost=this.__dataHost||null,this.__dataTemp={},this.__dataClientsInitialized=!1}_registerHost(){if(Ux.length){let n=Ux[Ux.length-1];n._enqueueClient(this),this.__dataHost=n}}_initializeProtoProperties(n){this.__data=Object.create(n),this.__dataPending=Object.create(n),this.__dataOld={}}_initializeInstanceProperties(n){let s=this[ci.READ_ONLY];for(let o in n)s&&s[o]||(this.__dataPending=this.__dataPending||{},this.__dataOld=this.__dataOld||{},this.__data[o]=this.__dataPending[o]=n[o])}_addPropertyEffect(n,s,o){this._createPropertyAccessor(n,s==ci.READ_ONLY);let a=eF(this,s,!0)[n];a||(a=this[s][n]=[]),a.push(o)}_removePropertyEffect(n,s,o){let a=eF(this,s,!0)[n],l=a.indexOf(o);l>=0&&a.splice(l,1)}_hasPropertyEffect(n,s){let o=this[s];return!!(o&&o[n])}_hasReadOnlyEffect(n){return this._hasPropertyEffect(n,ci.READ_ONLY)}_hasNotifyEffect(n){return this._hasPropertyEffect(n,ci.NOTIFY)}_hasReflectEffect(n){return this._hasPropertyEffect(n,ci.REFLECT)}_hasComputedEffect(n){return this._hasPropertyEffect(n,ci.COMPUTE)}_setPendingPropertyOrPath(n,s,o,a){if(a||kp(Array.isArray(n)?n[0]:n)!==n){if(!a){let l=ko(this,n);if(!(n=vX(this,n,s))||!super._shouldPropertyChange(n,s,l))return!1}if(this.__dataHasPaths=!0,this._setPendingProperty(n,s,o))return HWe(this,n,s),!0}else{if(this.__dataHasAccessor&&this.__dataHasAccessor[n])return this._setPendingProperty(n,s,o);this[n]=s}return!1}_setUnmanagedPropertyToNode(n,s,o){o===n[s]&&typeof o!="object"||(s==="className"&&(n=Ve(n)),n[s]=o)}_setPendingProperty(n,s,o){let a=this.__dataHasPaths&&jj(n),l=a?this.__dataTemp:this.__data;return!!this._shouldPropertyChange(n,s,l[n])&&(this.__dataPending||(this.__dataPending={},this.__dataOld={}),n in this.__dataOld||(this.__dataOld[n]=this.__data[n]),a?this.__dataTemp[n]=s:this.__data[n]=s,this.__dataPending[n]=s,(a||this[ci.NOTIFY]&&this[ci.NOTIFY][n])&&(this.__dataToNotify=this.__dataToNotify||{},this.__dataToNotify[n]=o),!0)}_setProperty(n,s){this._setPendingProperty(n,s,!0)&&this._invalidateProperties()}_invalidateProperties(){this.__dataReady&&this._flushProperties()}_enqueueClient(n){this.__dataPendingClients=this.__dataPendingClients||[],n!==this&&this.__dataPendingClients.push(n)}_flushClients(){this.__dataClientsReady?this.__enableOrFlushClients():(this.__dataClientsReady=!0,this._readyClients(),this.__dataReady=!0)}__enableOrFlushClients(){let n=this.__dataPendingClients;if(n){this.__dataPendingClients=null;for(let s=0;s<n.length;s++){let o=n[s];o.__dataEnabled?o.__dataPending&&o._flushProperties():o._enableProperties()}}}_readyClients(){this.__enableOrFlushClients()}setProperties(n,s){for(let o in n)!s&&this[ci.READ_ONLY]&&this[ci.READ_ONLY][o]||this._setPendingPropertyOrPath(o,n[o],!0);this._invalidateProperties()}ready(){this._flushProperties(),this.__dataClientsReady||this._flushClients(),this.__dataPending&&this._flushProperties()}_propertiesChanged(n,s,o){let a,l=this.__dataHasPaths;this.__dataHasPaths=!1,jWe(this,s,o,l),a=this.__dataToNotify,this.__dataToNotify=null,this._propagatePropertyChanges(s,o,l),this._flushClients(),_2(this,this[ci.REFLECT],s,o,l),_2(this,this[ci.OBSERVE],s,o,l),a&&FWe(this,a,s,o,l),this.__dataCounter==1&&(this.__dataTemp={})}_propagatePropertyChanges(n,s,o){this[ci.PROPAGATE]&&_2(this,this[ci.PROPAGATE],n,s,o),this.__templateInfo&&this._runEffectsForTemplate(this.__templateInfo,n,s,o)}_runEffectsForTemplate(n,s,o,a){const l=(c,u)=>{_2(this,n.propertyEffects,c,o,u,n.nodeList);for(let h=n.firstChild;h;h=h.nextSibling)this._runEffectsForTemplate(h,c,o,u)};n.runEffects?n.runEffects(l,s,a):l(s,a)}linkPaths(n,s){n=v2(n),s=v2(s),this.__dataLinkedPaths=this.__dataLinkedPaths||{},this.__dataLinkedPaths[n]=s}unlinkPaths(n){n=v2(n),this.__dataLinkedPaths&&delete this.__dataLinkedPaths[n]}notifySplices(n,s){let o={path:""};ege(this,ko(this,n,o),o.path,s)}get(n,s){return ko(s||this,n)}set(n,s,o){o?vX(o,n,s):this[ci.READ_ONLY]&&this[ci.READ_ONLY][n]||this._setPendingPropertyOrPath(n,s,!0)&&this._invalidateProperties()}push(n,...s){let o={path:""},a=ko(this,n,o),l=a.length,c=a.push(...s);return s.length&&Bx(this,a,o.path,l,s.length,[]),c}pop(n){let s={path:""},o=ko(this,n,s),a=!!o.length,l=o.pop();return a&&Bx(this,o,s.path,o.length,0,[l]),l}splice(n,s,o,...a){let l,c={path:""},u=ko(this,n,c);return s<0?s=u.length-Math.floor(-s):s&&(s=Math.floor(s)),l=arguments.length===2?u.splice(s):u.splice(s,o,...a),(a.length||l.length)&&Bx(this,u,c.path,s,a.length,l),l}shift(n){let s={path:""},o=ko(this,n,s),a=!!o.length,l=o.shift();return a&&Bx(this,o,s.path,0,0,[l]),l}unshift(n,...s){let o={path:""},a=ko(this,n,o),l=a.unshift(...s);return s.length&&Bx(this,a,o.path,0,s.length,[]),l}notifyPath(n,s){let o;if(arguments.length==1){let a={path:""};s=ko(this,n,a),o=a.path}else o=Array.isArray(n)?v2(n):n;this._setPendingPropertyOrPath(o,s,!0,!0)&&this._invalidateProperties()}_createReadOnlyProperty(n,s){this._addPropertyEffect(n,ci.READ_ONLY),s&&(this["_set"+iJe(n)]=function(o){this._setProperty(n,o)})}_createPropertyObserver(n,s,o){let a={property:n,method:s,dynamicFn:!!o};this._addPropertyEffect(n,ci.OBSERVE,{fn:wX,info:a,trigger:{name:n}}),o&&this._addPropertyEffect(s,ci.OBSERVE,{fn:wX,info:a,trigger:{name:s}})}_createMethodObserver(n,s){let o=iF(n);if(!o)throw new Error("Malformed observer expression '"+n+"'");SX(this,o,ci.OBSERVE,Uj,null,s)}_createNotifyingProperty(n){this._addPropertyEffect(n,ci.NOTIFY,{fn:NWe,info:{eventName:dR(n)+"-changed",property:n}})}_createReflectedProperty(n){let s=this.constructor.attributeNameForProperty(n);s[0]==="-"?console.warn("Property "+n+" cannot be reflected to attribute "+s+' because "-" is not a valid starting attribute name. Use a lowercase first letter for the property instead.'):this._addPropertyEffect(n,ci.REFLECT,{fn:zWe,info:{attrName:s}})}_createComputedProperty(n,s,o){let a=iF(s);if(!a)throw new Error("Malformed computed expression '"+s+"'");const l=SX(this,a,ci.COMPUTE,Kme,n,o);eF(this,Zme)[n]=l}_marshalArgs(n,s,o){const a=this.__data,l=[];for(let c=0,u=n.length;c<u;c++){let{name:h,structured:f,wildcard:m,value:g,literal:y}=n[c];if(!y)if(m){const v=MT(h,s),b=EX(a,o,v?s:h);g={path:v?s:h,value:b,base:v?ko(a,h):b}}else g=f?EX(a,o,h):a[h];if(Lj&&!this._overrideLegacyUndefined&&g===void 0&&n.length>1)return kT;l[c]=g}return l}static addPropertyEffect(n,s,o){this.prototype._addPropertyEffect(n,s,o)}static createPropertyObserver(n,s,o){this.prototype._createPropertyObserver(n,s,o)}static createMethodObserver(n,s){this.prototype._createMethodObserver(n,s)}static createNotifyingProperty(n){this.prototype._createNotifyingProperty(n)}static createReadOnlyProperty(n,s){this.prototype._createReadOnlyProperty(n,s)}static createReflectedProperty(n){this.prototype._createReflectedProperty(n)}static createComputedProperty(n,s,o){this.prototype._createComputedProperty(n,s,o)}static bindTemplate(n){return this.prototype._bindTemplate(n)}_bindTemplate(n,s){let o=this.constructor._parseTemplate(n),a=this.__preBoundTemplateInfo==o;if(!a)for(let l in o.propertyEffects)this._createPropertyAccessor(l);if(s)if(o=Object.create(o),o.wasPreBound=a,this.__templateInfo){const l=n._parentTemplateInfo||this.__templateInfo,c=l.lastChild;o.parent=l,l.lastChild=o,o.previousSibling=c,c?c.nextSibling=o:l.firstChild=o}else this.__templateInfo=o;else this.__preBoundTemplateInfo=o;return o}static _addTemplatePropertyEffect(n,s,o){(n.hostProps=n.hostProps||{})[s]=!0;let a=n.propertyEffects=n.propertyEffects||{};(a[s]=a[s]||[]).push(o)}_stampTemplate(n,s){s=s||this._bindTemplate(n,!0),Ux.push(this);let o=super._stampTemplate(n,s);if(Ux.pop(),s.nodeList=o.nodeList,!s.wasPreBound){let a=s.childNodes=[];for(let l=o.firstChild;l;l=l.nextSibling)a.push(l)}return o.templateInfo=s,KWe(this,s),this.__dataClientsReady&&(this._runEffectsForTemplate(s,this.__data,null,!1),this._flushClients()),o}_removeBoundDom(n){const s=n.templateInfo,{previousSibling:o,nextSibling:a,parent:l}=s;o?o.nextSibling=a:l&&(l.firstChild=a),a?a.previousSibling=o:l&&(l.lastChild=o),s.nextSibling=s.previousSibling=null;let c=s.childNodes;for(let u=0;u<c.length;u++){let h=c[u];Ve(Ve(h).parentNode).removeChild(h)}}static _parseTemplateNode(n,s,o){let a=e._parseTemplateNode.call(this,n,s,o);if(n.nodeType===Node.TEXT_NODE){let l=this._parseBindings(n.textContent,s);l&&(n.textContent=CX(l)||" ",tF(this,s,o,"text","textContent",l),a=!0)}return a}static _parseTemplateNodeAttribute(n,s,o,a,l){let c=this._parseBindings(l,s);if(c){let u=a,h="property";LWe.test(a)?h="attribute":a[a.length-1]=="$"&&(a=a.slice(0,-1),h="attribute");let f=CX(c);return f&&h=="attribute"&&(a=="class"&&n.hasAttribute("class")&&(f+=" "+n.getAttribute(a)),n.setAttribute(a,f)),h=="attribute"&&u=="disable-upgrade$"&&n.setAttribute(a,""),n.localName==="input"&&u==="value"&&n.setAttribute(u,""),n.removeAttribute(u),h==="property"&&(a=jme(a)),tF(this,s,o,h,a,c,f),!0}return e._parseTemplateNodeAttribute.call(this,n,s,o,a,l)}static _parseTemplateNestedTemplate(n,s,o){let a=e._parseTemplateNestedTemplate.call(this,n,s,o);const l=n.parentNode,c=o.templateInfo,u=l.localName==="dom-if",h=l.localName==="dom-repeat";XK&&(u||h)&&(l.removeChild(n),(o=o.parentInfo).templateInfo=c,o.noted=!0,a=!1);let f=c.hostProps;if($me&&u)f&&(s.hostProps=Object.assign(s.hostProps||{},f),XK||(o.parentInfo.noted=!0));else{let m="{";for(let g in f)tF(this,s,o,"property","_host_"+g,[{mode:m,source:g,dependencies:[g],hostProp:!0}])}return a}static _parseBindings(n,s){let o,a=[],l=0;for(;(o=TX.exec(n))!==null;){o.index>l&&a.push({literal:n.slice(l,o.index)});let c=o[1][0],u=!!o[2],h=o[3].trim(),f=!1,m="",g=-1;c=="{"&&(g=h.indexOf("::"))>0&&(m=h.substring(g+2),h=h.substring(0,g),f=!0);let y=iF(h),v=[];if(y){let{args:b,methodName:w}=y;for(let S=0;S<b.length;S++){let I=b[S];I.literal||v.push(I)}let x=s.dynamicFns;(x&&x[w]||y.static)&&(v.push(w),y.dynamicFn=!0)}else v.push(h);a.push({source:h,mode:c,negate:u,customEvent:f,signature:y,dependencies:v,event:m}),l=TX.lastIndex}if(l&&l<n.length){let c=n.substring(l);c&&a.push({literal:c})}return a.length?a:null}static _evaluateBinding(n,s,o,a,l,c){let u;return u=s.signature?Uj(n,o,a,l,s.signature):o!=s.source?ko(n,s.source):c&&jj(o)?ko(n,o):n.__data[o],s.negate&&(u=!u),u}}return i}),Ux=[];function rJe(t){const e={};for(let i in t){const r=t[i];e[i]=typeof r=="function"?{type:r}:r}return e}const nJe=ul(t=>{const e=Hme(t);function i(s){const o=Object.getPrototypeOf(s);return o.prototype instanceof n?o:null}function r(s){if(!s.hasOwnProperty(JSCompiler_renameProperty("__ownProperties",s))){let o=null;if(s.hasOwnProperty(JSCompiler_renameProperty("properties",s))){const a=s.properties;a&&(o=rJe(a))}s.__ownProperties=o}return s.__ownProperties}class n extends e{static get observedAttributes(){if(!this.hasOwnProperty(JSCompiler_renameProperty("__observedAttributes",this))){this.prototype;const o=this._properties;this.__observedAttributes=o?Object.keys(o).map(a=>this.prototype._addPropertyToAttributeMap(a)):[]}return this.__observedAttributes}static finalize(){if(!this.hasOwnProperty(JSCompiler_renameProperty("__finalized",this))){const o=i(this);o&&o.finalize(),this.__finalized=!0,this._finalizeClass()}}static _finalizeClass(){const o=r(this);o&&this.createProperties(o)}static get _properties(){if(!this.hasOwnProperty(JSCompiler_renameProperty("__properties",this))){const o=i(this);this.__properties=Object.assign({},o&&o._properties,r(this))}return this.__properties}static typeForProperty(o){const a=this._properties[o];return a&&a.type}_initializeProperties(){this.constructor.finalize(),super._initializeProperties()}connectedCallback(){super.connectedCallback&&super.connectedCallback(),this._enableProperties()}disconnectedCallback(){super.disconnectedCallback&&super.disconnectedCallback()}}return n}),sJe="3.4.1",Gj=window.ShadyCSS&&window.ShadyCSS.cssBuild,pR=ul(t=>{const e=nJe(hR(t));function i(l){if(!l.hasOwnProperty(JSCompiler_renameProperty("__propertyDefaults",l))){l.__propertyDefaults=null;let c=l._properties;for(let u in c){let h=c[u];"value"in h&&(l.__propertyDefaults=l.__propertyDefaults||{},l.__propertyDefaults[u]=h)}}return l.__propertyDefaults}function r(l){return l.hasOwnProperty(JSCompiler_renameProperty("__ownObservers",l))||(l.__ownObservers=l.hasOwnProperty(JSCompiler_renameProperty("observers",l))?l.observers:null),l.__ownObservers}function n(l,c,u,h){u.computed&&(u.readOnly=!0),u.computed&&(l._hasReadOnlyEffect(c)?console.warn(`Cannot redefine computed property '${c}'.`):l._createComputedProperty(c,u.computed,h)),u.readOnly&&!l._hasReadOnlyEffect(c)?l._createReadOnlyProperty(c,!u.computed):u.readOnly===!1&&l._hasReadOnlyEffect(c)&&console.warn(`Cannot make readOnly property '${c}' non-readOnly.`),u.reflectToAttribute&&!l._hasReflectEffect(c)?l._createReflectedProperty(c):u.reflectToAttribute===!1&&l._hasReflectEffect(c)&&console.warn(`Cannot make reflected property '${c}' non-reflected.`),u.notify&&!l._hasNotifyEffect(c)?l._createNotifyingProperty(c):u.notify===!1&&l._hasNotifyEffect(c)&&console.warn(`Cannot make notify property '${c}' non-notify.`),u.observer&&l._createPropertyObserver(c,u.observer,h[u.observer]),l._addPropertyToAttributeMap(c)}function s(l,c,u,h){if(!Gj){const f=c.content.querySelectorAll("style"),m=MG(c),g=Hqe(u),y=c.content.firstElementChild;for(let b=0;b<g.length;b++){let w=g[b];w.textContent=l._processStyleText(w.textContent,h),c.content.insertBefore(w,y)}let v=0;for(let b=0;b<m.length;b++){let w=m[b],x=f[v];x!==w?(w=w.cloneNode(!0),x.parentNode.insertBefore(w,x)):v++,w.textContent=l._processStyleText(w.textContent,h)}}if(window.ShadyCSS&&window.ShadyCSS.prepareTemplate(c,u),Vqe&&Gj&&Oqe){const f=c.content.querySelectorAll("style");if(f){let m="";Array.from(f).forEach(g=>{m+=g.textContent,g.parentNode.removeChild(g)}),l._styleSheet=new CSSStyleSheet,l._styleSheet.replaceSync(m)}}}function o(l){let c=null;if(l&&(!w1||Fqe)&&(c=x1.import(l,"template"),w1&&!c))throw new Error(`strictTemplatePolicy: expecting dom-module or null template for ${l}`);return c}class a extends e{static get polymerElementVersion(){return sJe}static _finalizeClass(){e._finalizeClass.call(this);const c=r(this);c&&this.createObservers(c,this._properties),this._prepareTemplate()}static _prepareTemplate(){let c=this.template;c&&(typeof c=="string"?(console.error("template getter must return HTMLTemplateElement"),c=null):IT||(c=c.cloneNode(!0))),this.prototype._template=c}static createProperties(c){for(let u in c)n(this.prototype,u,c[u],c)}static createObservers(c,u){const h=this.prototype;for(let f=0;f<c.length;f++)h._createMethodObserver(c[f],u)}static get template(){if(!this.hasOwnProperty(JSCompiler_renameProperty("_template",this))){const c=this.prototype.hasOwnProperty(JSCompiler_renameProperty("_template",this.prototype))?this.prototype._template:void 0;this._template=c!==void 0?c:this.hasOwnProperty(JSCompiler_renameProperty("is",this))&&o(this.is)||Object.getPrototypeOf(this.prototype).constructor.template}return this._template}static set template(c){this._template=c}static get importPath(){if(!this.hasOwnProperty(JSCompiler_renameProperty("_importPath",this))){const c=this.importMeta;if(c)this._importPath=IG(c.url);else{const u=x1.import(this.is);this._importPath=u&&u.assetpath||Object.getPrototypeOf(this.prototype).constructor.importPath}}return this._importPath}constructor(){super(),this._template,this._importPath,this.rootPath,this.importPath,this.root,this.$}_initializeProperties(){this.constructor.finalize(),this.constructor._finalizeTemplate(this.localName),super._initializeProperties(),this.rootPath=Lqe,this.importPath=this.constructor.importPath;let c=i(this.constructor);if(c)for(let u in c){let h=c[u];if(this._canApplyPropertyDefault(u)){let f=typeof h.value=="function"?h.value.call(this):h.value;this._hasAccessor(u)?this._setPendingProperty(u,f,!0):this[u]=f}}}_canApplyPropertyDefault(c){return!this.hasOwnProperty(c)}static _processStyleText(c,u){return SG(c,u)}static _finalizeTemplate(c){const u=this.prototype._template;if(u&&!u.__polymerFinalized){u.__polymerFinalized=!0;const h=this.importPath;s(this,u,c,h?mI(h):""),this.prototype._bindTemplate(u)}}connectedCallback(){window.ShadyCSS&&this._template&&window.ShadyCSS.styleElement(this),super.connectedCallback()}ready(){this._template&&(this.root=this._stampTemplate(this._template),this.$=this.root.$),super.ready()}_readyClients(){this._template&&(this.root=this._attachDom(this.root)),super._readyClients()}_attachDom(c){const u=Ve(this);if(u.attachShadow)return c?(u.shadowRoot||(u.attachShadow({mode:"open",shadyUpgradeFragment:c}),u.shadowRoot.appendChild(c),this.constructor._styleSheet&&(u.shadowRoot.adoptedStyleSheets=[this.constructor._styleSheet])),Dqe&&window.ShadyDOM&&window.ShadyDOM.flushInitial(u.shadowRoot),u.shadowRoot):null;throw new Error("ShadowDOM not available. PolymerElement can create dom as children instead of in ShadowDOM by setting `this.root = this;` before `ready`.")}updateStyles(c){window.ShadyCSS&&window.ShadyCSS.styleSubtree(this,c)}resolveUrl(c,u){return!u&&this.importPath&&(u=mI(this.importPath)),mI(c,u)}static _parseTemplateContent(c,u,h){return u.dynamicFns=u.dynamicFns||this._properties,e._parseTemplateContent.call(this,c,u,h)}static _addTemplatePropertyEffect(c,u,h){return!Mme||u in this._properties||h.info.part.signature&&h.info.part.signature.static||h.info.part.hostProp||c.nestedTemplate||console.warn(`Property '${u}' used in template but not declared in 'properties'; attribute will not be observed.`),e._addTemplatePropertyEffect.call(this,c,u,h)}}return a});class tge{constructor(e){this.value=e.toString()}toString(){return this.value}}function oJe(t){if(t instanceof tge)return t.value;throw new Error(`non-literal value passed to Polymer's htmlLiteral function: ${t}`)}function aJe(t){if(t instanceof HTMLTemplateElement)return t.innerHTML;if(t instanceof tge)return oJe(t);throw new Error(`non-template value passed to Polymer's html function: ${t}`)}const VC=function(t,...e){const i=document.createElement("template");return i.innerHTML=e.reduce((r,n,s)=>r+aJe(n)+t[s+1],t[0]),i},Pp=pR(HTMLElement);class Ur{constructor(){this._asyncModule=null,this._callback=null,this._timer=null}setConfig(e,i){this._asyncModule=e,this._callback=i,this._timer=this._asyncModule.run(()=>{this._timer=null,PT.delete(this),this._callback()})}cancel(){this.isActive()&&(this._cancelAsync(),PT.delete(this))}_cancelAsync(){this.isActive()&&(this._asyncModule.cancel(this._timer),this._timer=null)}flush(){this.isActive()&&(this.cancel(),this._callback())}isActive(){return this._timer!=null}static debounce(e,i,r){return e instanceof Ur?e._cancelAsync():e=new Ur,e.setConfig(i,r),e}}let PT=new Set;const fR=function(t){PT.add(t)},lJe=function(){const t=!!PT.size;return PT.forEach(e=>{try{e.flush()}catch(i){setTimeout(()=>{throw i})}}),t};let RG=typeof document.head.style.touchAction=="string",XP="__polymerGestures",FA="__polymerGesturesHandled",Hj="__polymerGesturesTouchAction",MX=25,$X=5,cJe=2,uJe=2500,ige=["mousedown","mousemove","mouseup","click"],dJe=[0,1,4,2],hJe=function(){try{return new MouseEvent("test",{buttons:1}).buttons===1}catch{return!1}}();function FG(t){return ige.indexOf(t)>-1}let DG=!1;function rge(t){if(!FG(t)&&t!=="touchend")return RG&&DG&&Rqe?{passive:!0}:void 0}(function(){try{let t=Object.defineProperty({},"passive",{get(){DG=!0}});window.addEventListener("test",null,t),window.removeEventListener("test",null,t)}catch{}})();let nge=navigator.userAgent.match(/iP(?:[oa]d|hone)|Android/);const qj=[],pJe={button:!0,input:!0,keygen:!0,meter:!0,output:!0,textarea:!0,progress:!0,select:!0},fJe={button:!0,command:!0,fieldset:!0,input:!0,keygen:!0,optgroup:!0,option:!0,select:!0,textarea:!0};function mJe(t){return pJe[t.localName]||!1}function gJe(t){let e=Array.prototype.slice.call(t.labels||[]);if(!e.length){e=[];let i=t.getRootNode();if(t.id){let r=i.querySelectorAll(`label[for = ${t.id}]`);for(let n=0;n<r.length;n++)e.push(r[n])}}return e}let AX=function(t){let e=t.sourceCapabilities;if((!e||e.firesTouchEvents)&&(t[FA]={skip:!0},t.type==="click")){let i=!1,r=mR(t);for(let n=0;n<r.length;n++){if(r[n].nodeType===Node.ELEMENT_NODE){if(r[n].localName==="label")qj.push(r[n]);else if(mJe(r[n])){let s=gJe(r[n]);for(let o=0;o<s.length;o++)i=i||qj.indexOf(s[o])>-1}}if(r[n]===to.mouse.target)return}if(i)return;t.preventDefault(),t.stopPropagation()}};function kX(t){let e=nge?["click"]:ige;for(let i,r=0;r<e.length;r++)i=e[r],t?(qj.length=0,document.addEventListener(i,AX,!0)):document.removeEventListener(i,AX,!0)}function yJe(t){to.mouse.mouseIgnoreJob||kX(!0);let e=function(){kX(),to.mouse.target=null,to.mouse.mouseIgnoreJob=null};to.mouse.target=mR(t)[0],to.mouse.mouseIgnoreJob=Ur.debounce(to.mouse.mouseIgnoreJob,bu.after(uJe),e)}function qg(t){let e=t.type;if(!FG(e))return!1;if(e==="mousemove"){let i=t.buttons===void 0?1:t.buttons;return t instanceof window.MouseEvent&&!hJe&&(i=dJe[t.which]||0),!!(1&i)}return(t.button===void 0?0:t.button)===0}function vJe(t){if(t.type==="click"){if(t.detail===0)return!0;let e=fm(t);if(!e.nodeType||e.nodeType!==Node.ELEMENT_NODE)return!0;let i=e.getBoundingClientRect(),r=t.pageX,n=t.pageY;return!(r>=i.left&&r<=i.right&&n>=i.top&&n<=i.bottom)}return!1}let to={mouse:{target:null,mouseIgnoreJob:null},touch:{x:0,y:0,id:-1,scrollDecided:!1}};function _Je(t){let e="auto",i=mR(t);for(let r,n=0;n<i.length;n++)if(r=i[n],r[Hj]){e=r[Hj];break}return e}function PX(t,e,i){t.movefn=e,t.upfn=i,document.addEventListener("mousemove",e),document.addEventListener("mouseup",i)}function S_(t){document.removeEventListener("mousemove",t.movefn),document.removeEventListener("mouseup",t.upfn),t.movefn=null,t.upfn=null}document.addEventListener("touchend",yJe,!!DG&&{passive:!0});const mR=window.ShadyDOM&&window.ShadyDOM.noPatch?window.ShadyDOM.composedPath:t=>t.composedPath&&t.composedPath()||[],zC={},Z0=[];function bJe(t,e){let i=document.elementFromPoint(t,e),r=i;for(;r&&r.shadowRoot&&!window.ShadyDOM;){let n=r;if(r=r.shadowRoot.elementFromPoint(t,e),n===r)break;r&&(i=r)}return i}function fm(t){const e=mR(t);return e.length>0?e[0]:t.target}function sge(t){let e,i=t.type,r=t.currentTarget[XP];if(!r)return;let n=r[i];if(n){if(!t[FA]&&(t[FA]={},i.slice(0,5)==="touch")){let s=t.changedTouches[0];if(i==="touchstart"&&t.touches.length===1&&(to.touch.id=s.identifier),to.touch.id!==s.identifier)return;RG||i!=="touchstart"&&i!=="touchmove"||wJe(t)}if(e=t[FA],!e.skip){for(let s,o=0;o<Z0.length;o++)s=Z0[o],n[s.name]&&!e[s.name]&&s.flow&&s.flow.start.indexOf(t.type)>-1&&s.reset&&s.reset();for(let s,o=0;o<Z0.length;o++)s=Z0[o],n[s.name]&&!e[s.name]&&(e[s.name]=!0,s[i](t))}}}function wJe(t){let e=t.changedTouches[0],i=t.type;if(i==="touchstart")to.touch.x=e.clientX,to.touch.y=e.clientY,to.touch.scrollDecided=!1;else if(i==="touchmove"){if(to.touch.scrollDecided)return;to.touch.scrollDecided=!0;let r=_Je(t),n=!1,s=Math.abs(to.touch.x-e.clientX),o=Math.abs(to.touch.y-e.clientY);t.cancelable&&(r==="none"?n=!0:r==="pan-x"?n=o>s:r==="pan-y"&&(n=s>o)),n?t.preventDefault():QP("track")}}function NG(t,e,i){return!!zC[e]&&(SJe(t,e,i),!0)}function xJe(t,e,i){return!!zC[e]&&(IJe(t,e,i),!0)}function SJe(t,e,i){let r=zC[e],n=r.deps,s=r.name,o=t[XP];o||(t[XP]=o={});for(let a,l,c=0;c<n.length;c++)a=n[c],nge&&FG(a)&&a!=="click"||(l=o[a],l||(o[a]=l={_count:0}),l._count===0&&t.addEventListener(a,sge,rge(a)),l[s]=(l[s]||0)+1,l._count=(l._count||0)+1);t.addEventListener(e,i),r.touchAction&&oge(t,r.touchAction)}function IJe(t,e,i){let r=zC[e],n=r.deps,s=r.name,o=t[XP];if(o)for(let a,l,c=0;c<n.length;c++)a=n[c],l=o[a],l&&l[s]&&(l[s]=(l[s]||1)-1,l._count=(l._count||1)-1,l._count===0&&t.removeEventListener(a,sge,rge(a)));t.removeEventListener(e,i)}function rF(t){Z0.push(t);for(let e=0;e<t.emits.length;e++)zC[t.emits[e]]=t}function TJe(t){for(let e,i=0;i<Z0.length;i++){e=Z0[i];for(let r,n=0;n<e.emits.length;n++)if(r=e.emits[n],r===t)return e}return null}function oge(t,e){RG&&t instanceof HTMLElement&&nc.run(()=>{t.style.touchAction=e}),t[Hj]=e}function VG(t,e,i){let r=new Event(e,{bubbles:!0,cancelable:!0,composed:!0});if(r.detail=i,Ve(t).dispatchEvent(r),r.defaultPrevented){let n=i.preventer||i.sourceEvent;n&&n.preventDefault&&n.preventDefault()}}function QP(t){let e=TJe(t);e.info&&(e.info.prevent=!0)}function Gx(t,e,i,r){e&&VG(e,t,{x:i.clientX,y:i.clientY,sourceEvent:i,preventer:r,prevent:function(n){return QP(n)}})}function OX(t,e,i){if(t.prevent)return!1;if(t.started)return!0;let r=Math.abs(t.x-e),n=Math.abs(t.y-i);return r>=$X||n>=$X}function nF(t,e,i){if(!e)return;let r,n=t.moves[t.moves.length-2],s=t.moves[t.moves.length-1],o=s.x-t.x,a=s.y-t.y,l=0;n&&(r=s.x-n.x,l=s.y-n.y),VG(e,"track",{state:t.state,x:i.clientX,y:i.clientY,dx:o,dy:a,ddx:r,ddy:l,sourceEvent:i,hover:function(){return bJe(i.clientX,i.clientY)}})}function LX(t,e,i){let r=Math.abs(e.clientX-t.x),n=Math.abs(e.clientY-t.y),s=fm(i||e);!s||fJe[s.localName]&&s.hasAttribute("disabled")||(isNaN(r)||isNaN(n)||r<=MX&&n<=MX||vJe(e))&&(t.prevent||VG(s,"tap",{x:e.clientX,y:e.clientY,sourceEvent:e,preventer:i}))}rF({name:"downup",deps:["mousedown","touchstart","touchend"],flow:{start:["mousedown","touchstart"],end:["mouseup","touchend"]},emits:["down","up"],info:{movefn:null,upfn:null},reset:function(){S_(this.info)},mousedown:function(t){if(!qg(t))return;let e=fm(t),i=this,r=function(s){qg(s)||(Gx("up",e,s),S_(i.info))},n=function(s){qg(s)&&Gx("up",e,s),S_(i.info)};PX(this.info,r,n),Gx("down",e,t)},touchstart:function(t){Gx("down",fm(t),t.changedTouches[0],t)},touchend:function(t){Gx("up",fm(t),t.changedTouches[0],t)}}),rF({name:"track",touchAction:"none",deps:["mousedown","touchstart","touchmove","touchend"],flow:{start:["mousedown","touchstart"],end:["mouseup","touchend"]},emits:["track"],info:{x:0,y:0,state:"start",started:!1,moves:[],addMove:function(t){this.moves.length>cJe&&this.moves.shift(),this.moves.push(t)},movefn:null,upfn:null,prevent:!1},reset:function(){this.info.state="start",this.info.started=!1,this.info.moves=[],this.info.x=0,this.info.y=0,this.info.prevent=!1,S_(this.info)},mousedown:function(t){if(!qg(t))return;let e=fm(t),i=this,r=function(s){let o=s.clientX,a=s.clientY;OX(i.info,o,a)&&(i.info.state=i.info.started?s.type==="mouseup"?"end":"track":"start",i.info.state==="start"&&QP("tap"),i.info.addMove({x:o,y:a}),qg(s)||(i.info.state="end",S_(i.info)),e&&nF(i.info,e,s),i.info.started=!0)},n=function(s){i.info.started&&r(s),S_(i.info)};PX(this.info,r,n),this.info.x=t.clientX,this.info.y=t.clientY},touchstart:function(t){let e=t.changedTouches[0];this.info.x=e.clientX,this.info.y=e.clientY},touchmove:function(t){let e=fm(t),i=t.changedTouches[0],r=i.clientX,n=i.clientY;OX(this.info,r,n)&&(this.info.state==="start"&&QP("tap"),this.info.addMove({x:r,y:n}),nF(this.info,e,i),this.info.state="track",this.info.started=!0)},touchend:function(t){let e=fm(t),i=t.changedTouches[0];this.info.started&&(this.info.state="end",this.info.addMove({x:i.clientX,y:i.clientY}),nF(this.info,e,i))}}),rF({name:"tap",deps:["mousedown","click","touchstart","touchend"],flow:{start:["mousedown","touchstart"],end:["click","touchend"]},emits:["tap"],info:{x:NaN,y:NaN,prevent:!1},reset:function(){this.info.x=NaN,this.info.y=NaN,this.info.prevent=!1},mousedown:function(t){qg(t)&&(this.info.x=t.clientX,this.info.y=t.clientY)},click:function(t){qg(t)&&LX(this.info,t)},touchstart:function(t){const e=t.changedTouches[0];this.info.x=e.clientX,this.info.y=e.clientY},touchend:function(t){LX(this.info,t.changedTouches[0],t)}});const jC=ul(t=>{class e extends t{_addEventListenerToNode(r,n,s){NG(r,n,s)||super._addEventListenerToNode(r,n,s)}_removeEventListenerFromNode(r,n,s){xJe(r,n,s)||super._removeEventListenerFromNode(r,n,s)}}return e}),CJe=t=>class extends t{static get properties(){return{theme:{type:String,readOnly:!0}}}attributeChangedCallback(e,i,r){super.attributeChangedCallback(e,i,r),e==="theme"&&this._setTheme(r)}},zG=t=>class extends CJe(t){static finalize(){super.finalize();const e=this.prototype._template,i=this.template&&this.template.parentElement&&this.template.parentElement.id===this.is,r=Object.getPrototypeOf(this.prototype)._template;r&&!i&&Array.from(r.content.querySelectorAll("style[include]")).forEach(n=>{this._includeStyle(n.getAttribute("include"),e)}),this._includeMatchingThemes(e)}static _includeMatchingThemes(e){const i=x1.prototype.modules;let r=!1;const n=this.is+"-default-theme";Object.keys(i).sort((s,o)=>{const a=s.indexOf("vaadin-")===0,l=o.indexOf("vaadin-")===0,c=["lumo-","material-"],u=c.filter(f=>s.indexOf(f)===0).length>0,h=c.filter(f=>o.indexOf(f)===0).length>0;return a!==l?a?-1:1:u!==h?u?-1:1:0}).forEach(s=>{if(s!==n){const o=i[s].getAttribute("theme-for");o&&o.split(" ").forEach(a=>{new RegExp("^"+a.split("*").join(".*")+"$").test(this.is)&&(r=!0,this._includeStyle(s,e))})}}),!r&&i[n]&&this._includeStyle(n,e)}static _includeStyle(e,i){if(i&&!i.content.querySelector(`style[include="${e}"]`)){const r=document.createElement("style");r.setAttribute("include",e),i.content.appendChild(r)}}};let eO=!1;window.addEventListener("keydown",()=>{eO=!0},{capture:!0}),window.addEventListener("mousedown",()=>{eO=!1},{capture:!0});const EJe=t=>class extends t{static get properties(){var e={tabindex:{type:Number,value:0,reflectToAttribute:!0,observer:"_tabindexChanged"}};return window.ShadyDOM&&(e.tabIndex=e.tabindex),e}},MJe=t=>class extends EJe(t){static get properties(){return{autofocus:{type:Boolean},_previousTabIndex:{type:Number},disabled:{type:Boolean,observer:"_disabledChanged",reflectToAttribute:!0},_isShiftTabbing:{type:Boolean}}}get _keyboardActive(){return eO}ready(){this.addEventListener("focusin",i=>{i.composedPath()[0]===this?this.contains(i.relatedTarget)||this._focus():i.composedPath().indexOf(this.focusElement)===-1||this.disabled||this._setFocused(!0)}),this.addEventListener("focusout",i=>this._setFocused(!1)),super.ready();const e=i=>{i.composed||i.target.dispatchEvent(new CustomEvent(i.type,{bubbles:!0,composed:!0,cancelable:!1}))};this.shadowRoot.addEventListener("focusin",e),this.shadowRoot.addEventListener("focusout",e),this.addEventListener("keydown",i=>{if(!i.defaultPrevented&&i.keyCode===9)if(i.shiftKey)this._isShiftTabbing=!0,HTMLElement.prototype.focus.apply(this),this._setFocused(!1),setTimeout(()=>this._isShiftTabbing=!1,0);else{const r=window.navigator.userAgent.match(/Firefox\/(\d\d\.\d)/);if(r&&parseFloat(r[1])>=63&&parseFloat(r[1])<66&&this.parentNode&&this.nextSibling){const n=document.createElement("input");n.style.position="absolute",n.style.opacity="0",n.tabIndex=this.tabIndex,this.parentNode.insertBefore(n,this.nextSibling),n.focus(),n.addEventListener("focusout",()=>this.parentNode.removeChild(n))}}}),this.autofocus&&!this.disabled&&window.requestAnimationFrame(()=>{this._focus(),this._setFocused(!0),this.setAttribute("focus-ring","")})}disconnectedCallback(){super.disconnectedCallback(),this.hasAttribute("focused")&&this._setFocused(!1)}_setFocused(e){e?this.setAttribute("focused",""):this.removeAttribute("focused"),e&&eO?this.setAttribute("focus-ring",""):this.removeAttribute("focus-ring")}get focusElement(){return window.console.warn(`Please implement the 'focusElement' property in <${this.localName}>`),this}_focus(){this.focusElement&&!this._isShiftTabbing&&(this.focusElement.focus(),this._setFocused(!0))}focus(){this.focusElement&&!this.disabled&&(this.focusElement.focus(),this._setFocused(!0))}blur(){this.focusElement&&(this.focusElement.blur(),this._setFocused(!1))}_disabledChanged(e){this.focusElement.disabled=e,e?(this.blur(),this._previousTabIndex=this.tabindex,this.tabindex=-1,this.setAttribute("aria-disabled","true")):(this._previousTabIndex!==void 0&&(this.tabindex=this._previousTabIndex),this.removeAttribute("aria-disabled"))}_tabindexChanged(e){e!==void 0&&(this.focusElement.tabIndex=e),this.disabled&&this.tabindex&&(this.tabindex!==-1&&(this._previousTabIndex=this.tabindex),this.tabindex=e=void 0),window.ShadyDOM&&this.setProperties({tabIndex:e,tabindex:e})}click(){this.disabled||super.click()}},S1=function(){let t,e;do t=window.ShadyDOM&&ShadyDOM.flush(),window.ShadyCSS&&window.ShadyCSS.ScopingShim&&window.ShadyCSS.ScopingShim.flush(),e=lJe();while(t||e)};class sF{static detectScrollType(){const e=document.createElement("div");e.textContent="ABCD",e.dir="rtl",e.style.fontSize="14px",e.style.width="4px",e.style.height="1px",e.style.position="absolute",e.style.top="-1000px",e.style.overflow="scroll",document.body.appendChild(e);let i="reverse";return e.scrollLeft>0?i="default":(e.scrollLeft=2,e.scrollLeft<2&&(i="negative")),document.body.removeChild(e),i}static getNormalizedScrollLeft(e,i,r){const{scrollLeft:n}=r;if(i!=="rtl"||!e)return n;switch(e){case"negative":return r.scrollWidth-r.clientWidth+n;case"reverse":return r.scrollWidth-r.clientWidth-n}return n}static setNormalizedScrollLeft(e,i,r,n){if(i==="rtl"&&e)switch(e){case"negative":r.scrollLeft=r.clientWidth-r.scrollWidth+n;break;case"reverse":r.scrollLeft=r.scrollWidth-r.clientWidth-n;break;default:r.scrollLeft=n}else r.scrollLeft=n}}const Gf=[],$Je=function(){const t=Db();Gf.forEach(e=>{Wj(e,t)})};let xM;new MutationObserver($Je).observe(document.documentElement,{attributes:!0,attributeFilter:["dir"]});const Wj=function(t,e){e?t.setAttribute("dir",e):t.removeAttribute("dir")},Db=function(){return document.documentElement.getAttribute("dir")},jG=t=>class extends t{static get properties(){return{dir:{type:String,readOnly:!0}}}static finalize(){super.finalize(),xM||(xM=sF.detectScrollType())}connectedCallback(){super.connectedCallback(),this.hasAttribute("dir")||(this.__subscribe(),Wj(this,Db()))}attributeChangedCallback(e,i,r){if(super.attributeChangedCallback(e,i,r),e!=="dir")return;const n=r===Db()&&Gf.indexOf(this)===-1,s=!r&&i&&Gf.indexOf(this)===-1,o=r!==Db()&&i===Db();n||s?(this.__subscribe(),Wj(this,Db())):o&&this.__subscribe(!1)}disconnectedCallback(){super.disconnectedCallback(),this.__subscribe(!1),this.removeAttribute("dir")}__subscribe(e=!0){e?Gf.indexOf(this)===-1&&Gf.push(this):Gf.indexOf(this)>-1&&Gf.splice(Gf.indexOf(this),1)}__getNormalizedScrollLeft(e){return sF.getNormalizedScrollLeft(xM,this.getAttribute("dir")||"ltr",e)}__setNormalizedScrollLeft(e,i){return sF.setNormalizedScrollLeft(xM,this.getAttribute("dir")||"ltr",e,i)}},AJe=/\/\*\*\s+vaadin-dev-mode:start([\s\S]*)vaadin-dev-mode:end\s+\*\*\//i,DA=window.Vaadin&&window.Vaadin.Flow&&window.Vaadin.Flow.clients;function kJe(){function t(){return!0}return age(t)}function PJe(){try{return!!OJe()||!!LJe()&&(DA?!RJe():!kJe())}catch{return!1}}function OJe(){return localStorage.getItem("vaadin.developmentmode.force")}function LJe(){return["localhost","127.0.0.1"].indexOf(window.location.hostname)>=0}function RJe(){return!!(DA&&Object.keys(DA).map(t=>DA[t]).filter(t=>t.productionMode).length>0)}function age(t,e){if(typeof t!="function")return;const i=AJe.exec(t.toString());if(i)try{t=new Function(i[1])}catch(r){console.log("vaadin-development-mode-detector: uncommentAndRun() failed",r)}return t(e)}window.Vaadin=window.Vaadin||{};const RX=function(t,e){if(window.Vaadin.developmentMode)return age(t,e)};function FJe(){}window.Vaadin.developmentMode===void 0&&(window.Vaadin.developmentMode=PJe());const FX=function(){if(typeof RX=="function")return RX(FJe)};let oF;window.Vaadin||(window.Vaadin={}),window.Vaadin.registrations=window.Vaadin.registrations||[],window.Vaadin.developmentModeCallback=window.Vaadin.developmentModeCallback||{},window.Vaadin.developmentModeCallback["vaadin-usage-statistics"]=function(){FX&&FX()};const DX=new Set,lge=t=>class extends jG(t){static finalize(){super.finalize();const{is:e}=this;e&&!DX.has(e)&&(window.Vaadin.registrations.push(this),DX.add(e),window.Vaadin.developmentModeCallback&&(oF=Ur.debounce(oF,Gme,()=>{window.Vaadin.developmentModeCallback["vaadin-usage-statistics"]()}),fR(oF)))}constructor(){super(),document.doctype===null&&console.warn('Vaadin components require the "standards mode" declaration. Please add <!DOCTYPE html> to the HTML document.')}};class NX extends lge(MJe(zG(jC(Pp)))){static get template(){return VC`
      <style>
        :host {
          display: inline-block;
        }

        :host([hidden]) {
          display: none !important;
        }

        label {
          display: inline-flex;
          align-items: baseline;
          outline: none;
        }

        [part='checkbox'] {
          position: relative;
          display: inline-block;
          flex: none;
        }

        input[type='checkbox'] {
          position: absolute;
          top: 0;
          left: 0;
          right: 0;
          width: 100%;
          height: 100%;
          opacity: 0;
          cursor: inherit;
          margin: 0;
        }

        :host([disabled]) {
          -webkit-tap-highlight-color: transparent;
        }
      </style>

      <label>
        <span part="checkbox">
          <input
            type="checkbox"
            checked="{{checked::change}}"
            disabled$="[[disabled]]"
            indeterminate="{{indeterminate::change}}"
            role="presentation"
            tabindex="-1"
          />
        </span>

        <span part="label">
          <slot></slot>
        </span>
      </label>
    `}static get is(){return"vaadin-checkbox"}static get version(){return"3.0.0"}static get properties(){return{checked:{type:Boolean,value:!1,notify:!0,observer:"_checkedChanged",reflectToAttribute:!0},indeterminate:{type:Boolean,notify:!0,observer:"_indeterminateChanged",reflectToAttribute:!0,value:!1},value:{type:String,value:"on"},_nativeCheckbox:{type:Object}}}constructor(){super(),this.name}get name(){return this.checked?this._storedName:""}set name(e){this._storedName=e}ready(){super.ready(),this.setAttribute("role","checkbox"),this._nativeCheckbox=this.shadowRoot.querySelector('input[type="checkbox"]'),this.addEventListener("click",this._handleClick.bind(this)),this._addActiveListeners();const e=this.getAttribute("name");e&&(this.name=e),this.shadowRoot.querySelector('[part~="label"]').querySelector("slot").addEventListener("slotchange",this._updateLabelAttribute.bind(this)),this._updateLabelAttribute()}_updateLabelAttribute(){const e=this.shadowRoot.querySelector('[part~="label"]'),i=e.firstElementChild.assignedNodes();this._isAssignedNodesEmpty(i)?e.setAttribute("empty",""):e.removeAttribute("empty")}_isAssignedNodesEmpty(e){return e.length===0||e.length==1&&e[0].nodeType==Node.TEXT_NODE&&e[0].textContent.trim()===""}_checkedChanged(e){this.indeterminate?this.setAttribute("aria-checked","mixed"):this.setAttribute("aria-checked",!!e)}_indeterminateChanged(e){e?this.setAttribute("aria-checked","mixed"):this.setAttribute("aria-checked",this.checked)}_addActiveListeners(){this._addEventListenerToNode(this,"down",e=>{this.__interactionsAllowed(e)&&this.setAttribute("active","")}),this._addEventListenerToNode(this,"up",()=>this.removeAttribute("active")),this.addEventListener("keydown",e=>{this.__interactionsAllowed(e)&&e.keyCode===32&&(e.preventDefault(),this.setAttribute("active",""))}),this.addEventListener("keyup",e=>{this.__interactionsAllowed(e)&&e.keyCode===32&&(e.preventDefault(),this._toggleChecked(),this.removeAttribute("active"),this.indeterminate&&(this.indeterminate=!1))})}get focusElement(){return this.shadowRoot.querySelector("input")}__interactionsAllowed(e){return!this.disabled&&e.target.localName!=="a"}_handleClick(e){this.__interactionsAllowed(e)&&(this.indeterminate?(this.indeterminate=!1,e.preventDefault(),this._toggleChecked()):e.composedPath()[0]!==this._nativeCheckbox&&(e.preventDefault(),this._toggleChecked()))}_toggleChecked(){this.checked=!this.checked,this.dispatchEvent(new CustomEvent("change",{composed:!1,bubbles:!0}))}}customElements.define(NX.is,NX),ET("vaadin-grid",CT`
    :host {
      font-family: var(--lumo-font-family);
      font-size: var(--lumo-font-size-m);
      line-height: var(--lumo-line-height-s);
      color: var(--lumo-body-text-color);
      background-color: var(--lumo-base-color);
      box-sizing: border-box;
      -webkit-text-size-adjust: 100%;
      -webkit-tap-highlight-color: transparent;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;

      /* For internal use only */
      --_lumo-grid-border-color: var(--lumo-contrast-20pct);
      --_lumo-grid-secondary-border-color: var(--lumo-contrast-10pct);
      --_lumo-grid-border-width: 1px;
      --_lumo-grid-selected-row-color: var(--lumo-primary-color-10pct);
    }

    /* No (outer) border */

    :host(:not([theme~='no-border'])) {
      border: var(--_lumo-grid-border-width) solid var(--_lumo-grid-border-color);
    }

    /* Cell styles */

    [part~='cell'] {
      min-height: var(--lumo-size-m);
      background-color: var(--lumo-base-color);
    }

    [part~='cell'] ::slotted(vaadin-grid-cell-content) {
      cursor: default;
      padding: var(--lumo-space-xs) var(--lumo-space-m);
    }

    /* Apply row borders by default and introduce the "no-row-borders" variant */
    :host(:not([theme~='no-row-borders'])) [part~='cell']:not([part~='details-cell']) {
      border-top: var(--_lumo-grid-border-width) solid var(--_lumo-grid-secondary-border-color);
    }

    /* Hide first body row top border */
    :host(:not([theme~='no-row-borders'])) [part='row'][first] [part~='cell']:not([part~='details-cell']) {
      border-top: 0;
      min-height: calc(var(--lumo-size-m) - var(--_lumo-grid-border-width));
    }

    /* Focus-ring */

    [part~='cell']:focus {
      outline: none;
    }

    :host([navigating]) [part~='cell']:focus::before {
      content: '';
      position: absolute;
      top: 0;
      right: 0;
      bottom: 0;
      left: 0;
      pointer-events: none;
      box-shadow: inset 0 0 0 2px var(--lumo-primary-color-50pct);
    }

    /* Drag and Drop styles */
    :host([dragover])::after {
      content: '';
      position: absolute;
      z-index: 100;
      top: 0;
      right: 0;
      bottom: 0;
      left: 0;
      pointer-events: none;
      box-shadow: inset 0 0 0 2px var(--lumo-primary-color-50pct);
    }

    [part~='row'][dragover] {
      z-index: 100 !important;
    }

    [part~='row'][dragover] [part~='cell'] {
      overflow: visible;
    }

    [part~='row'][dragover] [part~='cell']::after {
      content: '';
      position: absolute;
      top: 0;
      right: 0;
      bottom: 0;
      left: 0;
      height: calc(var(--_lumo-grid-border-width) + 2px);
      pointer-events: none;
      background: var(--lumo-primary-color-50pct);
    }

    :host([theme~='no-row-borders']) [dragover] [part~='cell']::after {
      height: 2px;
    }

    [part~='row'][dragover='below'] [part~='cell']::after {
      top: 100%;
      bottom: auto;
      margin-top: -1px;
    }

    [part~='row'][dragover='above'] [part~='cell']::after {
      top: auto;
      bottom: 100%;
      margin-bottom: -1px;
    }

    [part~='row'][details-opened][dragover='below'] [part~='cell']:not([part~='details-cell'])::after,
    [part~='row'][details-opened][dragover='above'] [part~='details-cell']::after {
      display: none;
    }

    [part~='row'][dragover][dragover='on-top'] [part~='cell']::after {
      height: 100%;
    }

    [part~='row'][dragstart] {
      /* Add bottom-space to the row so the drag number doesn't get clipped. Needed for IE/Edge */
      border-bottom: 100px solid transparent;
      z-index: 100 !important;
      opacity: 0.9;
    }

    [part~='row'][dragstart] [part~='cell'] {
      border: none !important;
      box-shadow: none !important;
    }

    [part~='row'][dragstart] [part~='cell'][last-column] {
      border-radius: 0 var(--lumo-border-radius-s) var(--lumo-border-radius-s) 0;
    }

    [part~='row'][dragstart] [part~='cell'][first-column] {
      border-radius: var(--lumo-border-radius-s) 0 0 var(--lumo-border-radius-s);
    }

    [ios] [part~='row'][dragstart] [part~='cell'] {
      background: var(--lumo-primary-color-50pct);
    }

    #scroller:not([ios]) [part~='row'][dragstart]:not([dragstart=''])::after {
      display: block;
      position: absolute;
      left: var(--_grid-drag-start-x);
      top: var(--_grid-drag-start-y);
      z-index: 100;
      content: attr(dragstart);
      align-items: center;
      justify-content: center;
      box-sizing: border-box;
      padding: calc(var(--lumo-space-xs) * 0.8);
      color: var(--lumo-error-contrast-color);
      background-color: var(--lumo-error-color);
      border-radius: var(--lumo-border-radius-m);
      font-family: var(--lumo-font-family);
      font-size: var(--lumo-font-size-xxs);
      line-height: 1;
      font-weight: 500;
      text-transform: initial;
      letter-spacing: initial;
      min-width: calc(var(--lumo-size-s) * 0.7);
      text-align: center;
    }

    /* Headers and footers */

    [part~='header-cell'] ::slotted(vaadin-grid-cell-content),
    [part~='footer-cell'] ::slotted(vaadin-grid-cell-content),
    [part~='reorder-ghost'] {
      font-size: var(--lumo-font-size-s);
      font-weight: 500;
    }

    [part~='footer-cell'] ::slotted(vaadin-grid-cell-content) {
      font-weight: 400;
    }

    [part='row']:only-child [part~='header-cell'] {
      min-height: var(--lumo-size-xl);
    }

    /* Header borders */

    /* Hide first header row top border */
    :host(:not([theme~='no-row-borders'])) [part='row']:first-child [part~='header-cell'] {
      border-top: 0;
    }

    [part='row']:last-child [part~='header-cell'] {
      border-bottom: var(--_lumo-grid-border-width) solid transparent;
    }

    :host(:not([theme~='no-row-borders'])) [part='row']:last-child [part~='header-cell'] {
      border-bottom-color: var(--_lumo-grid-secondary-border-color);
    }

    /* Overflow uses a stronger border color */
    :host([overflow~='top']) [part='row']:last-child [part~='header-cell'] {
      border-bottom-color: var(--_lumo-grid-border-color);
    }

    /* Footer borders */

    [part='row']:first-child [part~='footer-cell'] {
      border-top: var(--_lumo-grid-border-width) solid transparent;
    }

    :host(:not([theme~='no-row-borders'])) [part='row']:first-child [part~='footer-cell'] {
      border-top-color: var(--_lumo-grid-secondary-border-color);
    }

    /* Overflow uses a stronger border color */
    :host([overflow~='bottom']) [part='row']:first-child [part~='footer-cell'] {
      border-top-color: var(--_lumo-grid-border-color);
    }

    /* Column reordering */

    :host([reordering]) [part~='cell'] {
      background: linear-gradient(var(--lumo-shade-20pct), var(--lumo-shade-20pct)) var(--lumo-base-color);
    }

    :host([reordering]) [part~='cell'][reorder-status='allowed'] {
      background: var(--lumo-base-color);
    }

    :host([reordering]) [part~='cell'][reorder-status='dragging'] {
      background: linear-gradient(var(--lumo-contrast-5pct), var(--lumo-contrast-5pct)) var(--lumo-base-color);
    }

    [part~='reorder-ghost'] {
      opacity: 0.85;
      box-shadow: var(--lumo-box-shadow-s);
      /* TODO Use the same styles as for the cell element (reorder-ghost copies styles from the cell element) */
      padding: var(--lumo-space-s) var(--lumo-space-m) !important;
    }

    /* Column resizing */

    [part='resize-handle'] {
      width: 3px;
      background-color: var(--lumo-primary-color-50pct);
      opacity: 0;
      transition: opacity 0.2s;
    }

    :host(:not([reordering])) *:not([column-resizing]) [part~='cell']:hover [part='resize-handle'],
    [part='resize-handle']:active {
      opacity: 1;
      transition-delay: 0.15s;
    }

    /* Column borders */

    :host([theme~='column-borders']) [part~='cell']:not([last-column]):not([part~='details-cell']) {
      border-right: var(--_lumo-grid-border-width) solid var(--_lumo-grid-secondary-border-color);
    }

    /* Frozen columns */

    [last-frozen] {
      border-right: var(--_lumo-grid-border-width) solid transparent;
      overflow: hidden;
    }

    :host([overflow~='left']) [part~='cell'][last-frozen]:not([part~='details-cell']) {
      border-right-color: var(--_lumo-grid-border-color);
    }

    /* Row stripes */

    :host([theme~='row-stripes']) [part~='row']:not([odd]) [part~='body-cell'],
    :host([theme~='row-stripes']) [part~='row']:not([odd]) [part~='details-cell'] {
      background-image: linear-gradient(var(--lumo-contrast-5pct), var(--lumo-contrast-5pct));
      background-repeat: repeat-x;
    }

    /* Selected row */

    /* Raise the selected rows above unselected rows (so that box-shadow can cover unselected rows) */
    :host(:not([reordering])) [part~='row'][selected] {
      z-index: 1;
    }

    :host(:not([reordering])) [part~='row'][selected] [part~='body-cell']:not([part~='details-cell']) {
      background-image: linear-gradient(var(--_lumo-grid-selected-row-color), var(--_lumo-grid-selected-row-color));
      background-repeat: repeat;
    }

    /* Cover the border of an unselected row */
    :host(:not([theme~='no-row-borders'])) [part~='row'][selected] [part~='cell']:not([part~='details-cell']) {
      box-shadow: 0 var(--_lumo-grid-border-width) 0 0 var(--_lumo-grid-selected-row-color);
    }

    /* Compact */

    :host([theme~='compact']) [part='row']:only-child [part~='header-cell'] {
      min-height: var(--lumo-size-m);
    }

    :host([theme~='compact']) [part~='cell'] {
      min-height: var(--lumo-size-s);
    }

    :host([theme~='compact']) [part='row'][first] [part~='cell']:not([part~='details-cell']) {
      min-height: calc(var(--lumo-size-s) - var(--_lumo-grid-border-width));
    }

    :host([theme~='compact']) [part~='cell'] ::slotted(vaadin-grid-cell-content) {
      padding: var(--lumo-space-xs) var(--lumo-space-s);
    }

    /* Wrap cell contents */

    :host([theme~='wrap-cell-content']) [part~='cell'] ::slotted(vaadin-grid-cell-content) {
      white-space: normal;
    }

    /* RTL specific styles */

    :host([dir='rtl']) [part~='row'][dragstart] [part~='cell'][last-column] {
      border-radius: var(--lumo-border-radius-s) 0 0 var(--lumo-border-radius-s);
    }

    :host([dir='rtl']) [part~='row'][dragstart] [part~='cell'][first-column] {
      border-radius: 0 var(--lumo-border-radius-s) var(--lumo-border-radius-s) 0;
    }

    :host([dir='rtl'][theme~='column-borders']) [part~='cell']:not([last-column]):not([part~='details-cell']) {
      border-right: none;
      border-left: var(--_lumo-grid-border-width) solid var(--_lumo-grid-secondary-border-color);
    }

    :host([dir='rtl']) [last-frozen] {
      border-right: none;
      border-left: var(--_lumo-grid-border-width) solid transparent;
    }

    :host([dir='rtl'][overflow~='right']) [part~='cell'][last-frozen]:not([part~='details-cell']) {
      border-left-color: var(--_lumo-grid-border-color);
    }
  `,{moduleId:"lumo-grid"}),ET("vaadin-checkbox",CT`
    :host(.vaadin-grid-select-all-checkbox) {
      font-size: var(--lumo-font-size-m);
    }
  `,{moduleId:"vaadin-grid-select-all-checkbox-lumo"});let tO=!1,cge=[],uge=[];function dge(){tO=!0,requestAnimationFrame(function(){tO=!1,DJe(cge),setTimeout(function(){NJe(uge)})})}function DJe(t){for(;t.length;)hge(t.shift())}function NJe(t){for(let e=0,i=t.length;e<i;e++)hge(t.shift())}function hge(t){const e=t[0],i=t[1],r=t[2];try{i.apply(e,r)}catch(n){setTimeout(()=>{throw n})}}function VJe(t,e,i){tO||dge(),cge.push([t,e,i])}function zJe(t,e,i){tO||dge(),uge.push([t,e,i])}class VX{constructor(){this.start=0,this.end=0,this.previous=null,this.parent=null,this.rules=null,this.parsedCssText="",this.cssText="",this.atRule=!1,this.type=0,this.keyframesName="",this.selector="",this.parsedSelector=""}}function pge(t){return fge(BJe(t=jJe(t)),t)}function jJe(t){return t.replace(dp.comments,"").replace(dp.port,"")}function BJe(t){let e=new VX;e.start=0,e.end=t.length;let i=e;for(let r=0,n=t.length;r<n;r++)if(t[r]===gge){i.rules||(i.rules=[]);let s=i,o=s.rules[s.rules.length-1]||null;i=new VX,i.start=r+1,i.parent=s,i.previous=o,s.rules.push(i)}else t[r]===yge&&(i.end=r+1,i=i.parent||e);return e}function fge(t,e){let i=e.substring(t.start,t.end-1);if(t.parsedCssText=t.cssText=i.trim(),t.parent){let n=t.previous?t.previous.end:t.parent.start;i=e.substring(n,t.start-1),i=UJe(i),i=i.replace(dp.multipleSpaces," "),i=i.substring(i.lastIndexOf(";")+1);let s=t.parsedSelector=t.selector=i.trim();t.atRule=s.indexOf(ZJe)===0,t.atRule?s.indexOf(JJe)===0?t.type=Nm.MEDIA_RULE:s.match(dp.keyframesRule)&&(t.type=Nm.KEYFRAMES_RULE,t.keyframesName=t.selector.split(dp.multipleSpaces).pop()):s.indexOf(vge)===0?t.type=Nm.MIXIN_RULE:t.type=Nm.STYLE_RULE}let r=t.rules;if(r)for(let n,s=0,o=r.length;s<o&&(n=r[s]);s++)fge(n,e);return t}function UJe(t){return t.replace(/\\([0-9a-f]{1,6})\s/gi,function(){let e=arguments[1],i=6-e.length;for(;i--;)e="0"+e;return"\\"+e})}function mge(t,e,i=""){let r="";if(t.cssText||t.rules){let n=t.rules;if(n&&!GJe(n))for(let s,o=0,a=n.length;o<a&&(s=n[o]);o++)r=mge(s,e,r);else r=e?t.cssText:HJe(t.cssText),r=r.trim(),r&&(r="  "+r+`
`)}return r&&(t.selector&&(i+=t.selector+" "+gge+`
`),i+=r,t.selector&&(i+=yge+`

`)),i}function GJe(t){let e=t[0];return!!e&&!!e.selector&&e.selector.indexOf(vge)===0}function HJe(t){return WJe(t=qJe(t))}function qJe(t){return t.replace(dp.customProp,"").replace(dp.mixinProp,"")}function WJe(t){return t.replace(dp.mixinApply,"").replace(dp.varApply,"")}const Nm={STYLE_RULE:1,KEYFRAMES_RULE:7,MEDIA_RULE:4,MIXIN_RULE:1e3},gge="{",yge="}",dp={comments:/\/\*[^*]*\*+([^/*][^*]*\*+)*\//gim,port:/@import[^;]*;/gim,customProp:/(?:^[^;\-\s}]+)?--[^;{}]*?:[^{};]*?(?:[;\n]|$)/gim,mixinProp:/(?:^[^;\-\s}]+)?--[^;{}]*?:[^{};]*?{[^}]*?}(?:[;\n]|$)?/gim,mixinApply:/@apply\s*\(?[^);]*\)?\s*(?:[;\n]|$)?/gim,varApply:/[^;:]*?:[^;]*?var\([^;]*\)(?:[;\n]|$)?/gim,keyframesRule:/^@[^\s]*keyframes/,multipleSpaces:/\s+/g},vge="--",JJe="@media",ZJe="@",zX=new Set,YJe="shady-unscoped";function KJe(t){const e=t.textContent;if(!zX.has(e)){zX.add(e);const i=document.createElement("style");i.setAttribute("shady-unscoped",""),i.textContent=e,document.head.appendChild(i)}}function XJe(t){return t.hasAttribute(YJe)}function Jj(t,e){return t?(typeof t=="string"&&(t=pge(t)),e&&yI(t,e),mge(t,xG)):""}function jX(t){return!t.__cssRules&&t.textContent&&(t.__cssRules=pge(t.textContent)),t.__cssRules||null}function yI(t,e,i,r){if(!t)return;let n=!1,s=t.type;if(r&&s===Nm.MEDIA_RULE){let a=t.selector.match($qe);a&&(window.matchMedia(a[1]).matches||(n=!0))}s===Nm.STYLE_RULE?e(t):i&&s===Nm.KEYFRAMES_RULE?i(t):s===Nm.MIXIN_RULE&&(n=!0);let o=t.rules;if(o&&!n)for(let a,l=0,c=o.length;l<c&&(a=o[l]);l++)yI(a,e,i,r)}function QJe(t,e){let i=0;for(let r=e,n=t.length;r<n;r++)if(t[r]==="(")i++;else if(t[r]===")"&&--i==0)return r;return-1}function _ge(t,e){let i=t.indexOf("var(");if(i===-1)return e(t,"","","");let r=QJe(t,i+3),n=t.substring(i+4,r),s=t.substring(0,i),o=_ge(t.substring(r+1),e),a=n.indexOf(",");return a===-1?e(s,n.trim(),"",o):e(s,n.substring(0,a).trim(),n.substring(a+1).trim(),o)}function eZe(t){let e=t.localName,i="",r="";return e?e.indexOf("-")>-1?i=e:(r=e,i=t.getAttribute&&t.getAttribute("is")||""):(i=t.is,r=t.extends),{is:i,typeExtension:r}}function tZe(t){const e=[],i=t.querySelectorAll("style");for(let r=0;r<i.length;r++){const n=i[r];XJe(n)?cR||(KJe(n),n.parentNode.removeChild(n)):(e.push(n.textContent),n.parentNode.removeChild(n))}return e.join("").trim()}window.ShadyDOM&&window.ShadyDOM.wrap;const bge="css-build";function iZe(t){if(ST!==void 0)return ST;if(t.__cssBuild===void 0){const e=t.getAttribute(bge);if(e)t.__cssBuild=e;else{const i=rZe(t);i!==""&&nZe(t),t.__cssBuild=i}}return t.__cssBuild||""}function BX(t){return iZe(t)!==""}function rZe(t){const e=t.localName==="template"?t.content.firstChild:t.firstChild;if(e instanceof Comment){const i=e.textContent.trim().split(":");if(i[0]===bge)return i[1]}return""}function nZe(t){const e=t.localName==="template"?t.content.firstChild:t.firstChild;e.parentNode.removeChild(e)}const sZe=/;\s*/m,oZe=/^\s*(initial)|(inherit)\s*$/,UX=/\s*!important/,Zj="_-_";class aZe{constructor(){this._map={}}set(e,i){e=e.trim(),this._map[e]={properties:i,dependants:{}}}get(e){return e=e.trim(),this._map[e]||null}}let iO=null;class To{constructor(){this._currentElement=null,this._measureElement=null,this._map=new aZe}detectMixin(e){return Aqe(e)}gatherStyles(e){const i=tZe(e.content);if(i){const r=document.createElement("style");return r.textContent=i,e.content.insertBefore(r,e.content.firstChild),r}return null}transformTemplate(e,i){e._gatheredStyle===void 0&&(e._gatheredStyle=this.gatherStyles(e));const r=e._gatheredStyle;return r?this.transformStyle(r,i):null}transformStyle(e,i=""){let r=jX(e);return this.transformRules(r,i),e.textContent=Jj(r),r}transformCustomStyle(e){let i=jX(e);return yI(i,r=>{r.selector===":root"&&(r.selector="html"),this.transformRule(r)}),e.textContent=Jj(i),i}transformRules(e,i){this._currentElement=i,yI(e,r=>{this.transformRule(r)}),this._currentElement=null}transformRule(e){e.cssText=this.transformCssText(e.parsedCssText,e),e.selector===":root"&&(e.selector=":host > *")}transformCssText(e,i){return e=e.replace(Pj,(r,n,s,o)=>this._produceCssProperties(r,n,s,o,i)),this._consumeCssProperties(e,i)}_getInitialValueForProperty(e){return this._measureElement||(this._measureElement=document.createElement("meta"),this._measureElement.setAttribute("apply-shim-measure",""),this._measureElement.style.all="initial",document.head.appendChild(this._measureElement)),window.getComputedStyle(this._measureElement).getPropertyValue(e)}_fallbacksFromPreviousRules(e){let i=e;for(;i.parent;)i=i.parent;const r={};let n=!1;return yI(i,s=>{n=n||s===e,n||s.selector===e.selector&&Object.assign(r,this._cssTextToMap(s.parsedCssText))}),r}_consumeCssProperties(e,i){let r=null;for(;r=JP.exec(e);){let n=r[0],s=r[1],o=r.index,a=o+n.indexOf("@apply"),l=o+n.length,c=e.slice(0,a),u=e.slice(l),h=i?this._fallbacksFromPreviousRules(i):{};Object.assign(h,this._cssTextToMap(c));let f=this._atApplyToCssProperties(s,h);e=`${c}${f}${u}`,JP.lastIndex=o+f.length}return e}_atApplyToCssProperties(e,i){e=e.replace(sZe,"");let r=[],n=this._map.get(e);if(n||(this._map.set(e,{}),n=this._map.get(e)),n){let s,o,a;this._currentElement&&(n.dependants[this._currentElement]=!0);const l=n.properties;for(s in l)a=i&&i[s],o=[s,": var(",e,Zj,s],a&&o.push(",",a.replace(UX,"")),o.push(")"),UX.test(l[s])&&o.push(" !important"),r.push(o.join(""))}return r.join("; ")}_replaceInitialOrInherit(e,i){let r=oZe.exec(i);return r&&(i=r[1]?this._getInitialValueForProperty(e):"apply-shim-inherit"),i}_cssTextToMap(e,i=!1){let r,n,s=e.split(";"),o={};for(let a,l,c=0;c<s.length;c++)a=s[c],a&&(l=a.split(":"),l.length>1&&(r=l[0].trim(),n=l.slice(1).join(":"),i&&(n=this._replaceInitialOrInherit(r,n)),o[r]=n));return o}_invalidateMixinEntry(e){if(iO)for(let i in e.dependants)i!==this._currentElement&&iO(i)}_produceCssProperties(e,i,r,n,s){if(r&&_ge(r,(v,b)=>{b&&this._map.get(b)&&(n=`@apply ${b};`)}),!n)return e;let o=this._consumeCssProperties(""+n,s),a=e.slice(0,e.indexOf("--")),l=this._cssTextToMap(o,!0),c=l,u=this._map.get(i),h=u&&u.properties;h?c=Object.assign(Object.create(h),l):this._map.set(i,c);let f,m,g=[],y=!1;for(f in c)m=l[f],m===void 0&&(m="initial"),h&&!(f in h)&&(y=!0),g.push(`${i}${Zj}${f}: ${m}`);return y&&this._invalidateMixinEntry(u),u&&(u.properties=c),r&&(a=`${e};${a}`),`${a}${g.join("; ")};`}}To.prototype.detectMixin=To.prototype.detectMixin,To.prototype.transformStyle=To.prototype.transformStyle,To.prototype.transformCustomStyle=To.prototype.transformCustomStyle,To.prototype.transformRules=To.prototype.transformRules,To.prototype.transformRule=To.prototype.transformRule,To.prototype.transformTemplate=To.prototype.transformTemplate,To.prototype._separator=Zj,Object.defineProperty(To.prototype,"invalidCallback",{get:()=>iO,set(t){iO=t}});const Yj={},rO="_applyShimCurrentVersion",I1="_applyShimNextVersion",nO="_applyShimValidatingVersion",lZe=Promise.resolve();function cZe(t){let e=Yj[t];e&&uZe(e)}function uZe(t){t[rO]=t[rO]||0,t[nO]=t[nO]||0,t[I1]=(t[I1]||0)+1}function wge(t){return t[rO]===t[I1]}function dZe(t){return!wge(t)&&t[nO]===t[I1]}function hZe(t){t[nO]=t[I1],t._validating||(t._validating=!0,lZe.then(function(){t[rO]=t[I1],t._validating=!1}))}const b2=new To;class pZe{constructor(){this.customStyleInterface=null,b2.invalidCallback=cZe}ensure(){this.customStyleInterface||window.ShadyCSS.CustomStyleInterface&&(this.customStyleInterface=window.ShadyCSS.CustomStyleInterface,this.customStyleInterface.transformCallback=e=>{b2.transformCustomStyle(e)},this.customStyleInterface.validateCallback=()=>{requestAnimationFrame(()=>{this.customStyleInterface.enqueued&&this.flushCustomStyles()})})}prepareTemplate(e,i){if(this.ensure(),BX(e))return;Yj[i]=e;let r=b2.transformTemplate(e,i);e._styleAst=r}flushCustomStyles(){if(this.ensure(),!this.customStyleInterface)return;let e=this.customStyleInterface.processStyles();if(this.customStyleInterface.enqueued){for(let i=0;i<e.length;i++){let r=e[i],n=this.customStyleInterface.getStyleForCustomStyle(r);n&&b2.transformCustomStyle(n)}this.customStyleInterface.enqueued=!1}}styleSubtree(e,i){if(this.ensure(),i&&Oj(e,i),e.shadowRoot){this.styleElement(e);let r=e.shadowRoot.children||e.shadowRoot.childNodes;for(let n=0;n<r.length;n++)this.styleSubtree(r[n])}else{let r=e.children||e.childNodes;for(let n=0;n<r.length;n++)this.styleSubtree(r[n])}}styleElement(e){this.ensure();let{is:i}=eZe(e),r=Yj[i];if((!r||!BX(r))&&r&&!wge(r)){dZe(r)||(this.prepareTemplate(r,i),hZe(r));let n=e.shadowRoot;if(n){let s=n.querySelector("style");s&&(s.__cssRules=r._styleAst,s.textContent=Jj(r._styleAst))}}}styleDocument(e){this.ensure(),this.styleSubtree(document.body,e)}}if(!window.ShadyCSS||!window.ShadyCSS.ScopingShim){const t=new pZe;let e=window.ShadyCSS&&window.ShadyCSS.CustomStyleInterface;window.ShadyCSS={prepareTemplate(i,r,n){t.flushCustomStyles(),t.prepareTemplate(i,r)},prepareTemplateStyles(i,r,n){window.ShadyCSS.prepareTemplate(i,r,n)},prepareTemplateDom(i,r){},styleSubtree(i,r){t.flushCustomStyles(),t.styleSubtree(i,r)},styleElement(i){t.flushCustomStyles(),t.styleElement(i)},styleDocument(i){t.flushCustomStyles(),t.styleDocument(i)},getComputedStyleValue:(i,r)=>Cme(i,r),flushCustomStyles(){t.flushCustomStyles()},nativeCss:xG,nativeShadow:cR,cssBuild:ST,disableRuntime:Eme},e&&(window.ShadyCSS.CustomStyleInterface=e)}window.ShadyCSS.ApplyShim=b2;const fZe=/:host\(:dir\((ltr|rtl)\)\)/g,mZe=':host([dir="$1"])',gZe=/([\s\w-#\.\[\]\*]*):dir\((ltr|rtl)\)/g,yZe=':host([dir="$2"]) $1',vZe=/:dir\((?:ltr|rtl)\)/,GX=!!(window.ShadyDOM&&window.ShadyDOM.inUse),vI=[];let _I=null,BG="";function xge(){BG=document.documentElement.getAttribute("dir")}function Sge(t){t.__autoDirOptOut||t.setAttribute("dir",BG)}function Ige(){xge(),BG=document.documentElement.getAttribute("dir");for(let t=0;t<vI.length;t++)Sge(vI[t])}function _Ze(){_I&&_I.takeRecords().length&&Ige()}const bZe=ul(t=>{GX||_I||(xge(),_I=new MutationObserver(Ige),_I.observe(document.documentElement,{attributes:!0,attributeFilter:["dir"]}));const e=Wme(t);class i extends e{static _processStyleText(n,s){return n=e._processStyleText.call(this,n,s),!GX&&vZe.test(n)&&(n=this._replaceDirInCssText(n),this.__activateDir=!0),n}static _replaceDirInCssText(n){let s=n;return s=s.replace(fZe,mZe),s=s.replace(gZe,yZe),s}constructor(){super(),this.__autoDirOptOut=!1}ready(){super.ready(),this.__autoDirOptOut=this.hasAttribute("dir")}connectedCallback(){e.prototype.connectedCallback&&super.connectedCallback(),this.constructor.__activateDir&&(_Ze(),vI.push(this),Sge(this))}disconnectedCallback(){if(e.prototype.disconnectedCallback&&super.disconnectedCallback(),this.constructor.__activateDir){const n=vI.indexOf(this);n>-1&&vI.splice(n,1)}}}return i.__activateDir=!1,i});function HX(){document.body.removeAttribute("unresolved")}function Hx(t,e,i){return{index:t,removed:e,addedCount:i}}document.readyState==="interactive"||document.readyState==="complete"?HX():window.addEventListener("DOMContentLoaded",HX);const Tge=0,Cge=1,Kj=2,Xj=3;function wZe(t,e,i,r,n,s){let o=s-n+1,a=i-e+1,l=new Array(o);for(let c=0;c<o;c++)l[c]=new Array(a),l[c][0]=c;for(let c=0;c<a;c++)l[0][c]=c;for(let c=1;c<o;c++)for(let u=1;u<a;u++)if(UG(t[e+u-1],r[n+c-1]))l[c][u]=l[c-1][u-1];else{let h=l[c-1][u]+1,f=l[c][u-1]+1;l[c][u]=h<f?h:f}return l}function xZe(t){let e=t.length-1,i=t[0].length-1,r=t[e][i],n=[];for(;e>0||i>0;){if(e==0){n.push(Kj),i--;continue}if(i==0){n.push(Xj),e--;continue}let s,o=t[e-1][i-1],a=t[e-1][i],l=t[e][i-1];s=a<l?a<o?a:o:l<o?l:o,s==o?(o==r?n.push(Tge):(n.push(Cge),r=o),e--,i--):s==a?(n.push(Xj),e--,r=a):(n.push(Kj),i--,r=l)}return n.reverse(),n}function SZe(t,e,i,r,n,s){let o,a=0,l=0,c=Math.min(i-e,s-n);if(e==0&&n==0&&(a=IZe(t,r,c)),i==t.length&&s==r.length&&(l=TZe(t,r,c-a)),n+=a,s-=l,(i-=l)-(e+=a)==0&&s-n==0)return[];if(e==i){for(o=Hx(e,[],0);n<s;)o.removed.push(r[n++]);return[o]}if(n==s)return[Hx(e,[],i-e)];let u=xZe(wZe(t,e,i,r,n,s));o=void 0;let h=[],f=e,m=n;for(let g=0;g<u.length;g++)switch(u[g]){case Tge:o&&(h.push(o),o=void 0),f++,m++;break;case Cge:o||(o=Hx(f,[],0)),o.addedCount++,f++,o.removed.push(r[m]),m++;break;case Kj:o||(o=Hx(f,[],0)),o.addedCount++,f++;break;case Xj:o||(o=Hx(f,[],0)),o.removed.push(r[m]),m++}return o&&h.push(o),h}function IZe(t,e,i){for(let r=0;r<i;r++)if(!UG(t[r],e[r]))return r;return i}function TZe(t,e,i){let r=t.length,n=e.length,s=0;for(;s<i&&UG(t[--r],e[--n]);)s++;return s}function Ege(t,e){return SZe(t,0,t.length,e,0,e.length)}function UG(t,e){return t===e}function I_(t){return t.localName==="slot"}let hp=class{static getFlattenedNodes(t){const e=Ve(t);return I_(t)?e.assignedNodes({flatten:!0}):Array.from(e.childNodes).map(i=>I_(i)?Ve(i).assignedNodes({flatten:!0}):[i]).reduce((i,r)=>i.concat(r),[])}constructor(t,e){this._shadyChildrenObserver=null,this._nativeChildrenObserver=null,this._connected=!1,this._target=t,this.callback=e,this._effectiveNodes=[],this._observer=null,this._scheduled=!1,this._boundSchedule=()=>{this._schedule()},this.connect(),this._schedule()}connect(){I_(this._target)?this._listenSlots([this._target]):Ve(this._target).children&&(this._listenSlots(Ve(this._target).children),window.ShadyDOM?this._shadyChildrenObserver=window.ShadyDOM.observeChildren(this._target,t=>{this._processMutations(t)}):(this._nativeChildrenObserver=new MutationObserver(t=>{this._processMutations(t)}),this._nativeChildrenObserver.observe(this._target,{childList:!0}))),this._connected=!0}disconnect(){I_(this._target)?this._unlistenSlots([this._target]):Ve(this._target).children&&(this._unlistenSlots(Ve(this._target).children),window.ShadyDOM&&this._shadyChildrenObserver?(window.ShadyDOM.unobserveChildren(this._shadyChildrenObserver),this._shadyChildrenObserver=null):this._nativeChildrenObserver&&(this._nativeChildrenObserver.disconnect(),this._nativeChildrenObserver=null)),this._connected=!1}_schedule(){this._scheduled||(this._scheduled=!0,nc.run(()=>this.flush()))}_processMutations(t){this._processSlotMutations(t),this.flush()}_processSlotMutations(t){if(t)for(let e=0;e<t.length;e++){let i=t[e];i.addedNodes&&this._listenSlots(i.addedNodes),i.removedNodes&&this._unlistenSlots(i.removedNodes)}}flush(){if(!this._connected)return!1;window.ShadyDOM&&ShadyDOM.flush(),this._nativeChildrenObserver?this._processSlotMutations(this._nativeChildrenObserver.takeRecords()):this._shadyChildrenObserver&&this._processSlotMutations(this._shadyChildrenObserver.takeRecords()),this._scheduled=!1;let t={target:this._target,addedNodes:[],removedNodes:[]},e=this.constructor.getFlattenedNodes(this._target),i=Ege(e,this._effectiveNodes);for(let n,s=0;s<i.length&&(n=i[s]);s++)for(let o,a=0;a<n.removed.length&&(o=n.removed[a]);a++)t.removedNodes.push(o);for(let n,s=0;s<i.length&&(n=i[s]);s++)for(let o=n.index;o<n.index+n.addedCount;o++)t.addedNodes.push(e[o]);this._effectiveNodes=e;let r=!1;return(t.addedNodes.length||t.removedNodes.length)&&(r=!0,this.callback.call(this._target,t)),r}_listenSlots(t){for(let e=0;e<t.length;e++){let i=t[e];I_(i)&&i.addEventListener("slotchange",this._boundSchedule)}}_unlistenSlots(t){for(let e=0;e<t.length;e++){let i=t[e];I_(i)&&i.removeEventListener("slotchange",this._boundSchedule)}}};const T_=Element.prototype,CZe=T_.matches||T_.matchesSelector||T_.mozMatchesSelector||T_.msMatchesSelector||T_.oMatchesSelector||T_.webkitMatchesSelector,Mge=function(t,e){return CZe.call(t,e)};class Ei{constructor(e){window.ShadyDOM&&window.ShadyDOM.inUse&&window.ShadyDOM.patch(e),this.node=e}observeNodes(e){return new hp(this.node,e)}unobserveNodes(e){e.disconnect()}notifyObserver(){}deepContains(e){if(Ve(this.node).contains(e))return!0;let i=e,r=e.ownerDocument;for(;i&&i!==r&&i!==this.node;)i=Ve(i).parentNode||Ve(i).host;return i===this.node}getOwnerRoot(){return Ve(this.node).getRootNode()}getDistributedNodes(){return this.node.localName==="slot"?Ve(this.node).assignedNodes({flatten:!0}):[]}getDestinationInsertionPoints(){let e=[],i=Ve(this.node).assignedSlot;for(;i;)e.push(i),i=Ve(i).assignedSlot;return e}importNode(e,i){let r=this.node instanceof Document?this.node:this.node.ownerDocument;return Ve(r).importNode(e,i)}getEffectiveChildNodes(){return hp.getFlattenedNodes(this.node)}queryDistributedElements(e){let i=this.getEffectiveChildNodes(),r=[];for(let n,s=0,o=i.length;s<o&&(n=i[s]);s++)n.nodeType===Node.ELEMENT_NODE&&Mge(n,e)&&r.push(n);return r}get activeElement(){let e=this.node;return e._activeElement!==void 0?e._activeElement:e.activeElement}}function EZe(t,e){for(let i=0;i<e.length;i++){let r=e[i];t[r]=function(){return this.node[r].apply(this.node,arguments)}}}function qX(t,e){for(let i=0;i<e.length;i++){let r=e[i];Object.defineProperty(t,r,{get:function(){return this.node[r]},configurable:!0})}}function MZe(t,e){for(let i=0;i<e.length;i++){let r=e[i];Object.defineProperty(t,r,{get:function(){return this.node[r]},set:function(n){this.node[r]=n},configurable:!0})}}class Qj{constructor(e){this.event=e}get rootTarget(){return this.path[0]}get localTarget(){return this.event.target}get path(){return this.event.composedPath()}}Ei.prototype.cloneNode,Ei.prototype.appendChild,Ei.prototype.insertBefore,Ei.prototype.removeChild,Ei.prototype.replaceChild,Ei.prototype.setAttribute,Ei.prototype.removeAttribute,Ei.prototype.querySelector,Ei.prototype.querySelectorAll,Ei.prototype.parentNode,Ei.prototype.firstChild,Ei.prototype.lastChild,Ei.prototype.nextSibling,Ei.prototype.previousSibling,Ei.prototype.firstElementChild,Ei.prototype.lastElementChild,Ei.prototype.nextElementSibling,Ei.prototype.previousElementSibling,Ei.prototype.childNodes,Ei.prototype.children,Ei.prototype.classList,Ei.prototype.textContent,Ei.prototype.innerHTML;let e8=Ei;if(window.ShadyDOM&&window.ShadyDOM.inUse&&window.ShadyDOM.noPatch&&window.ShadyDOM.Wrapper){class t extends window.ShadyDOM.Wrapper{}Object.getOwnPropertyNames(Ei.prototype).forEach(e=>{e!="activeElement"&&(t.prototype[e]=Ei.prototype[e])}),qX(t.prototype,["classList"]),e8=t,Object.defineProperties(Qj.prototype,{localTarget:{get(){const e=this.event.currentTarget,i=e&&Vm(e).getOwnerRoot(),r=this.path;for(let n=0;n<r.length;n++){const s=r[n];if(Vm(s).getOwnerRoot()===i)return s}},configurable:!0},path:{get(){return window.ShadyDOM.composedPath(this.event)},configurable:!0}})}else EZe(Ei.prototype,["cloneNode","appendChild","insertBefore","removeChild","replaceChild","setAttribute","removeAttribute","querySelector","querySelectorAll"]),qX(Ei.prototype,["parentNode","firstChild","lastChild","nextSibling","previousSibling","firstElementChild","lastElementChild","nextElementSibling","previousElementSibling","childNodes","children","classList"]),MZe(Ei.prototype,["textContent","innerHTML","className"]);const Vm=function(t){if((t=t||document)instanceof e8||t instanceof Qj)return t;let e=t.__domApi;return e||(e=t instanceof Event?new Qj(t):new e8(t),t.__domApi=e),e},aF=window.ShadyDOM,WX=window.ShadyCSS;function JX(t,e){return Ve(t).getRootNode()===e}function $Ze(t,e=!1){if(!aF||!WX||!aF.handlesDynamicScoping)return null;const i=WX.ScopingShim;if(!i)return null;const r=i.scopeForNode(t),n=Ve(t).getRootNode(),s=o=>{if(!JX(o,n))return;const a=Array.from(aF.nativeMethods.querySelectorAll.call(o,"*"));a.push(o);for(let l=0;l<a.length;l++){const c=a[l];if(!JX(c,n))continue;const u=i.currentScopeForNode(c);u!==r&&(u!==""&&i.unscopeNode(c,u),i.scopeNode(c,r))}};if(s(t),e){const o=new MutationObserver(a=>{for(let l=0;l<a.length;l++){const c=a[l];for(let u=0;u<c.addedNodes.length;u++){const h=c.addedNodes[u];h.nodeType===Node.ELEMENT_NODE&&s(h)}}});return o.observe(t,{childList:!0,subtree:!0}),o}return null}const lF="disable-upgrade",$ge=t=>{for(;t;){const e=Object.getOwnPropertyDescriptor(t,"observedAttributes");if(e)return e.get;t=Object.getPrototypeOf(t.prototype).constructor}return()=>[]};ul(t=>{const e=pR(t);let i=$ge(e);class r extends e{constructor(){super(),this.__isUpgradeDisabled}static get observedAttributes(){return i.call(this).concat(lF)}_initializeProperties(){this.hasAttribute(lF)?this.__isUpgradeDisabled=!0:super._initializeProperties()}_enableProperties(){this.__isUpgradeDisabled||super._enableProperties()}_canApplyPropertyDefault(s){return super._canApplyPropertyDefault(s)&&!(this.__isUpgradeDisabled&&this._isPropertyPending(s))}attributeChangedCallback(s,o,a,l){s==lF?this.__isUpgradeDisabled&&a==null&&(super._initializeProperties(),this.__isUpgradeDisabled=!1,Ve(this).isConnected&&super.connectedCallback()):super.attributeChangedCallback(s,o,a,l)}connectedCallback(){this.__isUpgradeDisabled||super.connectedCallback()}disconnectedCallback(){this.__isUpgradeDisabled||super.disconnectedCallback()}}return r});const SM="disable-upgrade";let AZe=window.ShadyCSS;const Age=ul(t=>{const e=jC(pR(t)),i=Gj?e:bZe(e),r=$ge(i),n={x:"pan-x",y:"pan-y",none:"none",all:"auto"};class s extends i{constructor(){super(),this.isAttached,this.__boundListeners,this._debouncers,this.__isUpgradeDisabled,this.__needsAttributesAtConnected,this._legacyForceObservedAttributes}static get importMeta(){return this.prototype.importMeta}created(){}__attributeReaction(a,l,c){(this.__dataAttributes&&this.__dataAttributes[a]||a===SM)&&this.attributeChangedCallback(a,l,c,null)}setAttribute(a,l){if(bM&&!this._legacyForceObservedAttributes){const c=this.getAttribute(a);super.setAttribute(a,l),this.__attributeReaction(a,c,String(l))}else super.setAttribute(a,l)}removeAttribute(a){if(bM&&!this._legacyForceObservedAttributes){const l=this.getAttribute(a);super.removeAttribute(a),this.__attributeReaction(a,l,null)}else super.removeAttribute(a)}static get observedAttributes(){return bM&&!this.prototype._legacyForceObservedAttributes?(this.hasOwnProperty(JSCompiler_renameProperty("__observedAttributes",this))||(this.__observedAttributes=[],this.prototype,void 0),this.__observedAttributes):r.call(this).concat(SM)}_enableProperties(){this.__isUpgradeDisabled||super._enableProperties()}_canApplyPropertyDefault(a){return super._canApplyPropertyDefault(a)&&!(this.__isUpgradeDisabled&&this._isPropertyPending(a))}connectedCallback(){this.__needsAttributesAtConnected&&this._takeAttributes(),this.__isUpgradeDisabled||(super.connectedCallback(),this.isAttached=!0,this.attached())}attached(){}disconnectedCallback(){this.__isUpgradeDisabled||(super.disconnectedCallback(),this.isAttached=!1,this.detached())}detached(){}attributeChangedCallback(a,l,c,u){l!==c&&(a==SM?this.__isUpgradeDisabled&&c==null&&(this._initializeProperties(),this.__isUpgradeDisabled=!1,Ve(this).isConnected&&this.connectedCallback()):(super.attributeChangedCallback(a,l,c,u),this.attributeChanged(a,l,c)))}attributeChanged(a,l,c){}_initializeProperties(){if(IT&&this.hasAttribute(SM))this.__isUpgradeDisabled=!0;else{let a=Object.getPrototypeOf(this);a.hasOwnProperty(JSCompiler_renameProperty("__hasRegisterFinished",a))||(this._registered(),a.__hasRegisterFinished=!0),super._initializeProperties(),this.root=this,this.created(),bM&&!this._legacyForceObservedAttributes&&(this.hasAttributes()?this._takeAttributes():this.parentNode||(this.__needsAttributesAtConnected=!0)),this._applyListeners()}}_takeAttributes(){const a=this.attributes;for(let l=0,c=a.length;l<c;l++){const u=a[l];this.__attributeReaction(u.name,null,u.value)}}_registered(){}ready(){this._ensureAttributes(),super.ready()}_ensureAttributes(){}_applyListeners(){}serialize(a){return this._serializeValue(a)}deserialize(a,l){return this._deserializeValue(a,l)}reflectPropertyToAttribute(a,l,c){this._propertyToAttribute(a,l,c)}serializeValueToAttribute(a,l,c){this._valueToNodeAttribute(c||this,a,l)}extend(a,l){if(!a||!l)return a||l;let c=Object.getOwnPropertyNames(l);for(let u,h=0;h<c.length&&(u=c[h]);h++){let f=Object.getOwnPropertyDescriptor(l,u);f&&Object.defineProperty(a,u,f)}return a}mixin(a,l){for(let c in l)a[c]=l[c];return a}chainObject(a,l){return a&&l&&a!==l&&(a.__proto__=l),a}instanceTemplate(a){let l=this.constructor._contentForTemplate(a);return document.importNode(l,!0)}fire(a,l,c){c=c||{},l=l??{};let u=new Event(a,{bubbles:c.bubbles===void 0||c.bubbles,cancelable:!!c.cancelable,composed:c.composed===void 0||c.composed});u.detail=l;let h=c.node||this;return Ve(h).dispatchEvent(u),u}listen(a,l,c){a=a||this;let u=this.__boundListeners||(this.__boundListeners=new WeakMap),h=u.get(a);h||(h={},u.set(a,h));let f=l+c;h[f]||(h[f]=this._addMethodEventListenerToNode(a,l,c,this))}unlisten(a,l,c){a=a||this;let u=this.__boundListeners&&this.__boundListeners.get(a),h=l+c,f=u&&u[h];f&&(this._removeEventListenerFromNode(a,l,f),u[h]=null)}setScrollDirection(a,l){oge(l||this,n[a]||"auto")}$$(a){return this.root.querySelector(a)}get domHost(){let a=Ve(this).getRootNode();return a instanceof DocumentFragment?a.host:a}distributeContent(){const a=Vm(this);window.ShadyDOM&&a.shadowRoot&&ShadyDOM.flush()}getEffectiveChildNodes(){return Vm(this).getEffectiveChildNodes()}queryDistributedElements(a){return Vm(this).queryDistributedElements(a)}getEffectiveChildren(){return this.getEffectiveChildNodes().filter(function(a){return a.nodeType===Node.ELEMENT_NODE})}getEffectiveTextContent(){let a=this.getEffectiveChildNodes(),l=[];for(let c,u=0;c=a[u];u++)c.nodeType!==Node.COMMENT_NODE&&l.push(c.textContent);return l.join("")}queryEffectiveChildren(a){let l=this.queryDistributedElements(a);return l&&l[0]}queryAllEffectiveChildren(a){return this.queryDistributedElements(a)}getContentChildNodes(a){let l=this.root.querySelector(a||"slot");return l?Vm(l).getDistributedNodes():[]}getContentChildren(a){return this.getContentChildNodes(a).filter(function(l){return l.nodeType===Node.ELEMENT_NODE})}isLightDescendant(a){const l=this;return l!==a&&Ve(l).contains(a)&&Ve(l).getRootNode()===Ve(a).getRootNode()}isLocalDescendant(a){return this.root===Ve(a).getRootNode()}scopeSubtree(a,l=!1){return $Ze(a,l)}getComputedStyleValue(a){return AZe.getComputedStyleValue(this,a)}debounce(a,l,c){return this._debouncers=this._debouncers||{},this._debouncers[a]=Ur.debounce(this._debouncers[a],c>0?bu.after(c):nc,l.bind(this))}isDebouncerActive(a){this._debouncers=this._debouncers||{};let l=this._debouncers[a];return!(!l||!l.isActive())}flushDebouncer(a){this._debouncers=this._debouncers||{};let l=this._debouncers[a];l&&l.flush()}cancelDebouncer(a){this._debouncers=this._debouncers||{};let l=this._debouncers[a];l&&l.cancel()}async(a,l){return l>0?bu.run(a.bind(this),l):~nc.run(a.bind(this))}cancelAsync(a){a<0?nc.cancel(~a):bu.cancel(a)}create(a,l){let c=document.createElement(a);if(l)if(c.setProperties)c.setProperties(l);else for(let u in l)c[u]=l[u];return c}elementMatches(a,l){return Mge(l||this,a)}toggleAttribute(a,l){let c=this;return arguments.length===3&&(c=arguments[2]),arguments.length==1&&(l=!c.hasAttribute(a)),l?(Ve(c).setAttribute(a,""),!0):(Ve(c).removeAttribute(a),!1)}toggleClass(a,l,c){c=c||this,arguments.length==1&&(l=!c.classList.contains(a)),l?c.classList.add(a):c.classList.remove(a)}transform(a,l){(l=l||this).style.webkitTransform=a,l.style.transform=a}translate3d(a,l,c,u){u=u||this,this.transform("translate3d("+a+","+l+","+c+")",u)}arrayDelete(a,l){let c;if(Array.isArray(a)){if(c=a.indexOf(l),c>=0)return a.splice(c,1)}else if(c=ko(this,a).indexOf(l),c>=0)return this.splice(a,c,1);return null}_logger(a,l){switch(Array.isArray(l)&&l.length===1&&Array.isArray(l[0])&&(l=l[0]),a){case"log":case"warn":case"error":console[a](...l)}}_log(...a){this._logger("log",a)}_warn(...a){this._logger("warn",a)}_error(...a){this._logger("error",a)}_logf(a,...l){return["[%s::%s]",this.is,a,...l]}}return s.prototype.is="",s}),kZe={attached:!0,detached:!0,ready:!0,created:!0,beforeRegister:!0,registered:!0,attributeChanged:!0,listeners:!0,hostAttributes:!0},kge={attached:!0,detached:!0,ready:!0,created:!0,beforeRegister:!0,registered:!0,attributeChanged:!0,behaviors:!0,_noAccessors:!0},PZe=Object.assign({listeners:!0,hostAttributes:!0,properties:!0,observers:!0},kge);function OZe(t,e,i){const r=t._noAccessors,n=Object.getOwnPropertyNames(t);for(let s=0;s<n.length;s++){let o=n[s];if(!(o in i))if(r)e[o]=t[o];else{let a=Object.getOwnPropertyDescriptor(t,o);a&&(a.configurable=!0,Object.defineProperty(e,o,a))}}}function LZe(t,e,i){for(let r=0;r<e.length;r++)Pge(t,e[r],i,PZe)}function Pge(t,e,i,r){OZe(e,t,r);for(let n in kZe)e[n]&&(i[n]=i[n]||[],i[n].push(e[n]))}function Oge(t,e,i){e=e||[];for(let r=t.length-1;r>=0;r--){let n=t[r];n?Array.isArray(n)?Oge(n,e):e.indexOf(n)<0&&(!i||i.indexOf(n)<0)&&e.unshift(n):console.warn("behavior is null, check for missing or 404 import")}return e}function ZX(t,e){for(const i in e){const r=t[i],n=e[i];t[i]=!("value"in n)&&r&&"value"in r?Object.assign({value:r.value},n):n}}const YX=Age(HTMLElement);function RZe(t,e,i){let r;const n={};class s extends e{static _finalizeClass(){if(this.hasOwnProperty(JSCompiler_renameProperty("generatedFrom",this))){if(r)for(let l,c=0;c<r.length;c++)l=r[c],l.properties&&this.createProperties(l.properties),l.observers&&this.createObservers(l.observers,l.properties);t.properties&&this.createProperties(t.properties),t.observers&&this.createObservers(t.observers,t.properties),this._prepareTemplate()}else e._finalizeClass.call(this)}static get properties(){const l={};if(r)for(let c=0;c<r.length;c++)ZX(l,r[c].properties);return ZX(l,t.properties),l}static get observers(){let l=[];if(r)for(let c,u=0;u<r.length;u++)c=r[u],c.observers&&(l=l.concat(c.observers));return t.observers&&(l=l.concat(t.observers)),l}created(){super.created();const l=n.created;if(l)for(let c=0;c<l.length;c++)l[c].call(this)}_registered(){const l=s.prototype;if(!l.hasOwnProperty(JSCompiler_renameProperty("__hasRegisterFinished",l))){l.__hasRegisterFinished=!0,super._registered(),IT&&o(l);const c=Object.getPrototypeOf(this);let u=n.beforeRegister;if(u)for(let h=0;h<u.length;h++)u[h].call(c);if(u=n.registered,u)for(let h=0;h<u.length;h++)u[h].call(c)}}_applyListeners(){super._applyListeners();const l=n.listeners;if(l)for(let c=0;c<l.length;c++){const u=l[c];if(u)for(let h in u)this._addMethodEventListenerToNode(this,h,u[h])}}_ensureAttributes(){const l=n.hostAttributes;if(l)for(let c=l.length-1;c>=0;c--){const u=l[c];for(let h in u)this._ensureAttribute(h,u[h])}super._ensureAttributes()}ready(){super.ready();let l=n.ready;if(l)for(let c=0;c<l.length;c++)l[c].call(this)}attached(){super.attached();let l=n.attached;if(l)for(let c=0;c<l.length;c++)l[c].call(this)}detached(){super.detached();let l=n.detached;if(l)for(let c=0;c<l.length;c++)l[c].call(this)}attributeChanged(l,c,u){super.attributeChanged();let h=n.attributeChanged;if(h)for(let f=0;f<h.length;f++)h[f].call(this,l,c,u)}}if(i){Array.isArray(i)||(i=[i]);let a=e.prototype.behaviors;r=Oge(i,null,a),s.prototype.behaviors=a?a.concat(i):r}const o=a=>{r&&LZe(a,r,n),Pge(a,t,n,kge)};return IT||o(s.prototype),s.generatedFrom=t,s}const FZe=function(t,e){t||console.warn("Polymer.Class requires `info` argument");let i=e?e(YX):YX;return i=RZe(t,i,t.behaviors),i.is=i.prototype.is=t.is,i};function GG(t,e,i,r,n){let s;n&&(s=typeof i=="object"&&i!==null,s&&(r=t.__dataTemp[e]));let o=r!==i&&(r==r||i==i);return s&&o&&(t.__dataTemp[e]=i),o}const HG=ul(t=>{class e extends t{_shouldPropertyChange(r,n,s){return GG(this,r,n,s,!0)}}return e}),Lge=ul(t=>{class e extends t{static get properties(){return{mutableData:Boolean}}_shouldPropertyChange(r,n,s){return GG(this,r,n,s,this.mutableData)}}return e});HG._mutablePropertyChange=GG;let t8=null;function i8(){return t8}i8.prototype=Object.create(HTMLTemplateElement.prototype,{constructor:{value:i8,writable:!0}});const Rge=hR(i8),DZe=HG(Rge);function NZe(t,e){t8=t,Object.setPrototypeOf(t,e.prototype),new e,t8=null}const VZe=hR(class{});function Fge(t,e){for(let i=0;i<e.length;i++){let r=e[i];if(!!t!=!!r.__hideTemplateChildren__)if(r.nodeType===Node.TEXT_NODE)t?(r.__polymerTextContent__=r.textContent,r.textContent=""):r.textContent=r.__polymerTextContent__;else if(r.localName==="slot")if(t)r.__polymerReplaced__=document.createComment("hidden-slot"),Ve(Ve(r).parentNode).replaceChild(r.__polymerReplaced__,r);else{const n=r.__polymerReplaced__;n&&Ve(Ve(n).parentNode).replaceChild(r,n)}else r.style&&(t?(r.__polymerDisplay__=r.style.display,r.style.display="none"):r.style.display=r.__polymerDisplay__);r.__hideTemplateChildren__=t,r._showHideChildren&&r._showHideChildren(t)}}class Sm extends VZe{constructor(e){super(),this._configureProperties(e),this.root=this._stampTemplate(this.__dataHost);let i=[];this.children=i;for(let n=this.root.firstChild;n;n=n.nextSibling)i.push(n),n.__templatizeInstance=this;this.__templatizeOwner&&this.__templatizeOwner.__hideTemplateChildren__&&this._showHideChildren(!0);let r=this.__templatizeOptions;(e&&r.instanceProps||!r.instanceProps)&&this._enableProperties()}_configureProperties(e){if(this.__templatizeOptions.forwardHostProp)for(let i in this.__hostProps)this._setPendingProperty(i,this.__dataHost["_host_"+i]);for(let i in e)this._setPendingProperty(i,e[i])}forwardHostProp(e,i){this._setPendingPropertyOrPath(e,i,!1,!0)&&this.__dataHost._enqueueClient(this)}_addEventListenerToNode(e,i,r){if(this._methodHost&&this.__templatizeOptions.parentModel)this._methodHost._addEventListenerToNode(e,i,n=>{n.model=this,r(n)});else{let n=this.__dataHost.__dataHost;n&&n._addEventListenerToNode(e,i,r)}}_showHideChildren(e){Fge(e,this.children)}_setUnmanagedPropertyToNode(e,i,r){e.__hideTemplateChildren__&&e.nodeType==Node.TEXT_NODE&&i=="textContent"?e.__polymerTextContent__=r:super._setUnmanagedPropertyToNode(e,i,r)}get parentModel(){let e=this.__parentModel;if(!e){let i;e=this;do e=e.__dataHost.__dataHost;while((i=e.__templatizeOptions)&&!i.parentModel);this.__parentModel=e}return e}dispatchEvent(e){return!0}}Sm.prototype.__dataHost,Sm.prototype.__templatizeOptions,Sm.prototype._methodHost,Sm.prototype.__templatizeOwner,Sm.prototype.__hostProps;const zZe=HG(Sm);function KX(t){let e=t.__dataHost;return e&&e._methodHost||e}function jZe(t,e,i){let r=i.mutableData?zZe:Sm;OT.mixin&&(r=OT.mixin(r));let n=class extends r{};return n.prototype.__templatizeOptions=i,n.prototype._bindTemplate(t),GZe(n,t,e,i),n}function BZe(t,e,i,r){let n=i.forwardHostProp;if(n&&e.hasHostProps){const s=t.localName=="template";let o=e.templatizeTemplateClass;if(!o){if(s){let l=i.mutableData?DZe:Rge;class c extends l{}o=e.templatizeTemplateClass=c}else{const l=t.constructor;class c extends l{}o=e.templatizeTemplateClass=c}let a=e.hostProps;for(let l in a)o.prototype._addPropertyEffect("_host_"+l,o.prototype.PROPERTY_EFFECT_TYPES.PROPAGATE,{fn:UZe(l,n)}),o.prototype._createNotifyingProperty("_host_"+l);Mme&&r&&WZe(e,i,r)}if(t.__dataProto&&Object.assign(t.__data,t.__dataProto),s)NZe(t,o),t.__dataTemp={},t.__dataPending=null,t.__dataOld=null,t._enableProperties();else{Object.setPrototypeOf(t,o.prototype);const a=e.hostProps;for(let l in a)if(l="_host_"+l,l in t){const c=t[l];delete t[l],t.__data[l]=c}}}}function UZe(t,e){return function(i,r,n){e.call(i.__templatizeOwner,r.substring(6),n[r])}}function GZe(t,e,i,r){let n=i.hostProps||{};for(let s in r.instanceProps){delete n[s];let o=r.notifyInstanceProp;o&&t.prototype._addPropertyEffect(s,t.prototype.PROPERTY_EFFECT_TYPES.NOTIFY,{fn:HZe(s,o)})}if(r.forwardHostProp&&e.__dataHost)for(let s in n)i.hasHostProps||(i.hasHostProps=!0),t.prototype._addPropertyEffect(s,t.prototype.PROPERTY_EFFECT_TYPES.NOTIFY,{fn:qZe()})}function HZe(t,e){return function(i,r,n){e.call(i.__templatizeOwner,i,r,n[r])}}function qZe(){return function(t,e,i){t.__dataHost._setPendingPropertyOrPath("_host_"+e,i[e],!0,!0)}}function OT(t,e,i){if(w1&&!KX(t))throw new Error("strictTemplatePolicy: template owner not trusted");if(i=i||{},t.__templatizeOwner)throw new Error("A <template> can only be templatized once");t.__templatizeOwner=e;let r=(e?e.constructor:Sm)._parseTemplate(t),n=r.templatizeInstanceClass;n||(n=jZe(t,r,i),r.templatizeInstanceClass=n);const s=KX(t);BZe(t,r,i,s);let o=class extends n{};return o.prototype._methodHost=s,o.prototype.__dataHost=t,o.prototype.__templatizeOwner=e,o.prototype.__hostProps=r.hostProps,o}function WZe(t,e,i){const r=i.constructor._properties,{propertyEffects:n}=t,{instanceProps:s}=e;for(let o in n)if(!(r[o]||s&&s[o])){const a=n[o];for(let l=0;l<a.length;l++){const{part:c}=a[l].info;if(!c.signature||!c.signature.static){console.warn(`Property '${o}' used in template but not declared in 'properties'; attribute will not be observed.`);break}}}}function JZe(t,e){let i;for(;e;)if(i=e.__dataHost?e:e.__templatizeInstance){if(i.__dataHost==t)return i;e=i.__dataHost}else e=Ve(e).parentNode;return null}let XX=!1;function qG(){if(IT&&!TG){if(!XX){XX=!0;const t=document.createElement("style");t.textContent="dom-bind,dom-if,dom-repeat{display:none;}",document.head.appendChild(t)}return!0}return!1}const ZZe=jC(Lge(hR(HTMLElement)));class YZe extends ZZe{static get observedAttributes(){return["mutable-data"]}constructor(){if(super(),w1)throw new Error("strictTemplatePolicy: dom-bind not allowed");this.root=null,this.$=null,this.__children=null}attributeChangedCallback(e,i,r,n){this.mutableData=!0}connectedCallback(){qG()||(this.style.display="none"),this.render()}disconnectedCallback(){this.__removeChildren()}__insertChildren(){Ve(Ve(this).parentNode).insertBefore(this.root,this)}__removeChildren(){if(this.__children)for(let e=0;e<this.__children.length;e++)this.root.appendChild(this.__children[e])}render(){let e;if(!this.__children){if(e=e||this.querySelector("template"),!e){let i=new MutationObserver(()=>{if(e=this.querySelector("template"),!e)throw new Error("dom-bind requires a <template> child");i.disconnect(),this.render()});return void i.observe(this,{childList:!0})}this.root=this._stampTemplate(e),this.$=this.root.$,this.__children=[];for(let i=this.root.firstChild;i;i=i.nextSibling)this.__children[this.__children.length]=i;this._enableProperties()}this.__insertChildren(),this.dispatchEvent(new CustomEvent("dom-change",{bubbles:!0,composed:!0}))}}customElements.define("dom-bind",YZe);const KZe=Lge(Pp);class QX extends KZe{static get is(){return"dom-repeat"}static get template(){return null}static get properties(){return{items:{type:Array},as:{type:String,value:"item"},indexAs:{type:String,value:"index"},itemsIndexAs:{type:String,value:"itemsIndex"},sort:{type:Function,observer:"__sortChanged"},filter:{type:Function,observer:"__filterChanged"},observe:{type:String,observer:"__observeChanged"},delay:Number,renderedItemCount:{type:Number,notify:!Rj,readOnly:!0},initialCount:{type:Number},targetFramerate:{type:Number,value:20},_targetFrameTime:{type:Number,computed:"__computeFrameTime(targetFramerate)"},notifyDomChange:{type:Boolean},reuseChunkedInstances:{type:Boolean}}}static get observers(){return["__itemsChanged(items.*)"]}constructor(){super(),this.__instances=[],this.__renderDebouncer=null,this.__itemsIdxToInstIdx={},this.__chunkCount=null,this.__renderStartTime=null,this.__itemsArrayChanged=!1,this.__shouldMeasureChunk=!1,this.__shouldContinueChunking=!1,this.__chunkingId=0,this.__sortFn=null,this.__filterFn=null,this.__observePaths=null,this.__ctor=null,this.__isDetached=!0,this.template=null,this._templateInfo}disconnectedCallback(){super.disconnectedCallback(),this.__isDetached=!0;for(let e=0;e<this.__instances.length;e++)this.__detachInstance(e)}connectedCallback(){if(super.connectedCallback(),qG()||(this.style.display="none"),this.__isDetached){this.__isDetached=!1;let e=Ve(Ve(this).parentNode);for(let i=0;i<this.__instances.length;i++)this.__attachInstance(i,e)}}__ensureTemplatized(){if(!this.__ctor){const e=this;let i=this.template=e._templateInfo?e:this.querySelector("template");if(!i){let n=new MutationObserver(()=>{if(!this.querySelector("template"))throw new Error("dom-repeat requires a <template> child");n.disconnect(),this.__render()});return n.observe(this,{childList:!0}),!1}let r={};r[this.as]=!0,r[this.indexAs]=!0,r[this.itemsIndexAs]=!0,this.__ctor=OT(i,this,{mutableData:this.mutableData,parentModel:!0,instanceProps:r,forwardHostProp:function(n,s){let o=this.__instances;for(let a,l=0;l<o.length&&(a=o[l]);l++)a.forwardHostProp(n,s)},notifyInstanceProp:function(n,s,o){if(yWe(this.as,s)){let a=n[this.itemsIndexAs];s==this.as&&(this.items[a]=o);let l=$T(this.as,`${JSCompiler_renameProperty("items",this)}.${a}`,s);this.notifyPath(l,o)}}})}return!0}__getMethodHost(){return this.__dataHost._methodHost||this.__dataHost}__functionFromPropertyValue(e){if(typeof e=="string"){let i=e,r=this.__getMethodHost();return function(){return r[i].apply(r,arguments)}}return e}__sortChanged(e){this.__sortFn=this.__functionFromPropertyValue(e),this.items&&this.__debounceRender(this.__render)}__filterChanged(e){this.__filterFn=this.__functionFromPropertyValue(e),this.items&&this.__debounceRender(this.__render)}__computeFrameTime(e){return Math.ceil(1e3/e)}__observeChanged(){this.__observePaths=this.observe&&this.observe.replace(".*",".").split(" ")}__handleObservedPaths(e){if(this.__sortFn||this.__filterFn)if(e){if(this.__observePaths){let i=this.__observePaths;for(let r=0;r<i.length;r++)e.indexOf(i[r])===0&&this.__debounceRender(this.__render,this.delay)}}else this.__debounceRender(this.__render,this.delay)}__itemsChanged(e){this.items&&!Array.isArray(this.items)&&console.warn("dom-repeat expected array for `items`, found",this.items),this.__handleItemPath(e.path,e.value)||(e.path==="items"&&(this.__itemsArrayChanged=!0),this.__debounceRender(this.__render))}__debounceRender(e,i=0){this.__renderDebouncer=Ur.debounce(this.__renderDebouncer,i>0?bu.after(i):nc,e.bind(this)),fR(this.__renderDebouncer)}render(){this.__debounceRender(this.__render),S1()}__render(){if(!this.__ensureTemplatized())return;let e=this.items||[];const i=this.__sortAndFilterItems(e),r=this.__calculateLimit(i.length);this.__updateInstances(e,r,i),this.initialCount&&(this.__shouldMeasureChunk||this.__shouldContinueChunking)&&(cancelAnimationFrame(this.__chunkingId),this.__chunkingId=requestAnimationFrame(()=>this.__continueChunking())),this._setRenderedItemCount(this.__instances.length),Rj&&!this.notifyDomChange||this.dispatchEvent(new CustomEvent("dom-change",{bubbles:!0,composed:!0}))}__sortAndFilterItems(e){let i=new Array(e.length);for(let r=0;r<e.length;r++)i[r]=r;return this.__filterFn&&(i=i.filter((r,n,s)=>this.__filterFn(e[r],n,s))),this.__sortFn&&i.sort((r,n)=>this.__sortFn(e[r],e[n])),i}__calculateLimit(e){let i=e;const r=this.__instances.length;if(this.initialCount){let n;!this.__chunkCount||this.__itemsArrayChanged&&!this.reuseChunkedInstances?(i=Math.min(e,this.initialCount),n=Math.max(i-r,0),this.__chunkCount=n||1):(n=Math.min(Math.max(e-r,0),this.__chunkCount),i=Math.min(r+n,e)),this.__shouldMeasureChunk=n===this.__chunkCount,this.__shouldContinueChunking=i<e,this.__renderStartTime=performance.now()}return this.__itemsArrayChanged=!1,i}__continueChunking(){if(this.__shouldMeasureChunk){const e=performance.now()-this.__renderStartTime,i=this._targetFrameTime/e;this.__chunkCount=Math.round(this.__chunkCount*i)||1}this.__shouldContinueChunking&&this.__debounceRender(this.__render)}__updateInstances(e,i,r){const n=this.__itemsIdxToInstIdx={};let s;for(s=0;s<i;s++){let o=this.__instances[s],a=r[s],l=e[a];n[a]=s,o?(o._setPendingProperty(this.as,l),o._setPendingProperty(this.indexAs,s),o._setPendingProperty(this.itemsIndexAs,a),o._flushProperties()):this.__insertInstance(l,s,a)}for(let o=this.__instances.length-1;o>=s;o--)this.__detachAndRemoveInstance(o)}__detachInstance(e){let i=this.__instances[e];const r=Ve(i.root);for(let n=0;n<i.children.length;n++){let s=i.children[n];r.appendChild(s)}return i}__attachInstance(e,i){let r=this.__instances[e];i.insertBefore(r.root,this)}__detachAndRemoveInstance(e){this.__detachInstance(e),this.__instances.splice(e,1)}__stampInstance(e,i,r){let n={};return n[this.as]=e,n[this.indexAs]=i,n[this.itemsIndexAs]=r,new this.__ctor(n)}__insertInstance(e,i,r){const n=this.__stampInstance(e,i,r);let s=this.__instances[i+1],o=s?s.children[0]:this;return Ve(Ve(this).parentNode).insertBefore(n.root,o),this.__instances[i]=n,n}_showHideChildren(e){for(let i=0;i<this.__instances.length;i++)this.__instances[i]._showHideChildren(e)}__handleItemPath(e,i){let r=e.slice(6),n=r.indexOf("."),s=n<0?r:r.substring(0,n);if(s==parseInt(s,10)){let o=n<0?"":r.substring(n+1);this.__handleObservedPaths(o);let a=this.__itemsIdxToInstIdx[s],l=this.__instances[a];if(l){let c=this.as+(o?"."+o:"");l._setPendingPropertyOrPath(c,i,!1,!0),l._flushProperties()}return!0}}itemForElement(e){let i=this.modelForElement(e);return i&&i[this.as]}indexForElement(e){let i=this.modelForElement(e);return i&&i[this.indexAs]}modelForElement(e){return JZe(this.template,e)}}customElements.define(QX.is,QX);class Dge extends Pp{static get is(){return"dom-if"}static get template(){return null}static get properties(){return{if:{type:Boolean,observer:"__debounceRender"},restamp:{type:Boolean,observer:"__debounceRender"},notifyDomChange:{type:Boolean}}}constructor(){super(),this.__renderDebouncer=null,this._lastIf=!1,this.__hideTemplateChildren__=!1,this.__template,this._templateInfo}__debounceRender(){this.__renderDebouncer=Ur.debounce(this.__renderDebouncer,nc,()=>this.__render()),fR(this.__renderDebouncer)}disconnectedCallback(){super.disconnectedCallback();const e=Ve(this).parentNode;e&&(e.nodeType!=Node.DOCUMENT_FRAGMENT_NODE||Ve(e).host)||this.__teardownInstance()}connectedCallback(){super.connectedCallback(),qG()||(this.style.display="none"),this.if&&this.__debounceRender()}__ensureTemplate(){if(!this.__template){const e=this;let i=e._templateInfo?e:Ve(e).querySelector("template");if(!i){let r=new MutationObserver(()=>{if(!Ve(this).querySelector("template"))throw new Error("dom-if requires a <template> child");r.disconnect(),this.__render()});return r.observe(this,{childList:!0}),!1}this.__template=i}return!0}__ensureInstance(){let e=Ve(this).parentNode;if(this.__hasInstance()){let i=this.__getInstanceNodes();if(i&&i.length&&Ve(this).previousSibling!==i[i.length-1])for(let r,n=0;n<i.length&&(r=i[n]);n++)Ve(e).insertBefore(r,this)}else{if(!e||!this.__ensureTemplate())return!1;this.__createAndInsertInstance(e)}return!0}render(){S1()}__render(){if(this.if){if(!this.__ensureInstance())return}else this.restamp&&this.__teardownInstance();this._showHideChildren(),Rj&&!this.notifyDomChange||this.if==this._lastIf||(this.dispatchEvent(new CustomEvent("dom-change",{bubbles:!0,composed:!0})),this._lastIf=this.if)}__hasInstance(){}__getInstanceNodes(){}__createAndInsertInstance(e){}__teardownInstance(){}_showHideChildren(){}}class XZe extends Dge{constructor(){super(),this.__instance=null,this.__syncInfo=null}__hasInstance(){return!!this.__instance}__getInstanceNodes(){return this.__instance.templateInfo.childNodes}__createAndInsertInstance(e){const i=this.__dataHost||this;if(w1&&!this.__dataHost)throw new Error("strictTemplatePolicy: template owner not trusted");const r=i._bindTemplate(this.__template,!0);r.runEffects=(n,s,o)=>{let a=this.__syncInfo;if(this.if)a&&(this.__syncInfo=null,this._showHideChildren(),s=Object.assign(a.changedProps,s)),n(s,o);else if(this.__instance)if(a||(a=this.__syncInfo={runEffects:n,changedProps:{}}),o)for(const l in s){const c=kp(l);a.changedProps[c]=this.__dataHost[c]}else Object.assign(a.changedProps,s)},this.__instance=i._stampTemplate(this.__template,r),Ve(e).insertBefore(this.__instance,this)}__syncHostProperties(){const e=this.__syncInfo;e&&(this.__syncInfo=null,e.runEffects(e.changedProps,!1))}__teardownInstance(){const e=this.__dataHost||this;this.__instance&&(e._removeBoundDom(this.__instance),this.__instance=null,this.__syncInfo=null)}_showHideChildren(){const e=this.__hideTemplateChildren__||!this.if;this.__instance&&!!this.__instance.__hidden!==e&&(this.__instance.__hidden=e,Fge(e,this.__instance.templateInfo.childNodes)),e||this.__syncHostProperties()}}class QZe extends Dge{constructor(){super(),this.__ctor=null,this.__instance=null,this.__invalidProps=null}__hasInstance(){return!!this.__instance}__getInstanceNodes(){return this.__instance.children}__createAndInsertInstance(e){this.__ctor||(this.__ctor=OT(this.__template,this,{mutableData:!0,forwardHostProp:function(i,r){this.__instance&&(this.if?this.__instance.forwardHostProp(i,r):(this.__invalidProps=this.__invalidProps||Object.create(null),this.__invalidProps[kp(i)]=!0))}})),this.__instance=new this.__ctor,Ve(e).insertBefore(this.__instance.root,this)}__teardownInstance(){if(this.__instance){let e=this.__instance.children;if(e&&e.length){let i=Ve(e[0]).parentNode;if(i){i=Ve(i);for(let r,n=0;n<e.length&&(r=e[n]);n++)i.removeChild(r)}}this.__invalidProps=null,this.__instance=null}}__syncHostProperties(){let e=this.__invalidProps;if(e){this.__invalidProps=null;for(let i in e)this.__instance._setPendingProperty(i,this.__dataHost[i]);this.__instance._flushProperties()}}_showHideChildren(){const e=this.__hideTemplateChildren__||!this.if;this.__instance&&!!this.__instance.__hidden!==e&&(this.__instance.__hidden=e,this.__instance._showHideChildren(e)),e||this.__syncHostProperties()}}const eQ=$me?XZe:QZe;customElements.define(eQ.is,eQ);let eYe=ul(t=>{let e=pR(t);class i extends e{static get properties(){return{items:{type:Array},multi:{type:Boolean,value:!1},selected:{type:Object,notify:!0},selectedItem:{type:Object,notify:!0},toggle:{type:Boolean,value:!1}}}static get observers(){return["__updateSelection(multi, items.*)"]}constructor(){super(),this.__lastItems=null,this.__lastMulti=null,this.__selectedMap=null}__updateSelection(n,s){let o=s.path;if(o==JSCompiler_renameProperty("items",this)){let a=s.base||[],l=this.__lastItems;if(n!==this.__lastMulti&&this.clearSelection(),l){let c=Ege(a,l);this.__applySplices(c)}this.__lastItems=a,this.__lastMulti=n}else if(s.path==`${JSCompiler_renameProperty("items",this)}.splices`)this.__applySplices(s.value.indexSplices);else{let a=o.slice(`${JSCompiler_renameProperty("items",this)}.`.length),l=parseInt(a,10);a.indexOf(".")<0&&a==l&&this.__deselectChangedIdx(l)}}__applySplices(n){let s=this.__selectedMap;for(let a=0;a<n.length;a++){let l=n[a];s.forEach((c,u)=>{c<l.index||(c>=l.index+l.removed.length?s.set(u,c+l.addedCount-l.removed.length):s.set(u,-1))});for(let c=0;c<l.addedCount;c++){let u=l.index+c;s.has(this.items[u])&&s.set(this.items[u],u)}}this.__updateLinks();let o=0;s.forEach((a,l)=>{a<0?(this.multi?this.splice(JSCompiler_renameProperty("selected",this),o,1):this.selected=this.selectedItem=null,s.delete(l)):o++})}__updateLinks(){if(this.__dataLinkedPaths={},this.multi){let n=0;this.__selectedMap.forEach(s=>{s>=0&&this.linkPaths(`${JSCompiler_renameProperty("items",this)}.${s}`,`${JSCompiler_renameProperty("selected",this)}.${n++}`)})}else this.__selectedMap.forEach(n=>{this.linkPaths(JSCompiler_renameProperty("selected",this),`${JSCompiler_renameProperty("items",this)}.${n}`),this.linkPaths(JSCompiler_renameProperty("selectedItem",this),`${JSCompiler_renameProperty("items",this)}.${n}`)})}clearSelection(){this.__dataLinkedPaths={},this.__selectedMap=new Map,this.selected=this.multi?[]:null,this.selectedItem=null}isSelected(n){return this.__selectedMap.has(n)}isIndexSelected(n){return this.isSelected(this.items[n])}__deselectChangedIdx(n){let s=this.__selectedIndexForItemIndex(n);if(s>=0){let o=0;this.__selectedMap.forEach((a,l)=>{s==o++&&this.deselect(l)})}}__selectedIndexForItemIndex(n){let s=this.__dataLinkedPaths[`${JSCompiler_renameProperty("items",this)}.${n}`];if(s)return parseInt(s.slice(`${JSCompiler_renameProperty("selected",this)}.`.length),10)}deselect(n){let s=this.__selectedMap.get(n);if(s>=0){let o;this.__selectedMap.delete(n),this.multi&&(o=this.__selectedIndexForItemIndex(s)),this.__updateLinks(),this.multi?this.splice(JSCompiler_renameProperty("selected",this),o,1):this.selected=this.selectedItem=null}}deselectIndex(n){this.deselect(this.items[n])}select(n){this.selectIndex(this.items.indexOf(n))}selectIndex(n){let s=this.items[n];this.isSelected(s)?this.toggle&&this.deselectIndex(n):(this.multi||this.__selectedMap.clear(),this.__selectedMap.set(s,n),this.__updateLinks(),this.multi?this.push(JSCompiler_renameProperty("selected",this),s):this.selected=this.selectedItem=s)}}return i})(Pp);class tQ extends eYe{static get is(){return"array-selector"}static get template(){return null}}customElements.define(tQ.is,tQ);const C_=Age(HTMLElement).prototype;var IM=new Set;const tYe={properties:{_parentResizable:{type:Object,observer:"_parentResizableChanged"},_notifyingDescendant:{type:Boolean,value:!1}},listeners:{"iron-request-resize-notifications":"_onIronRequestResizeNotifications"},created:function(){this._interestedResizables=[],this._boundNotifyResize=this.notifyResize.bind(this),this._boundOnDescendantIronResize=this._onDescendantIronResize.bind(this)},attached:function(){this._requestResizeNotifications()},detached:function(){this._parentResizable?this._parentResizable.stopResizeNotificationsFor(this):(IM.delete(this),window.removeEventListener("resize",this._boundNotifyResize)),this._parentResizable=null},notifyResize:function(){this.isAttached&&(this._interestedResizables.forEach(function(t){this.resizerShouldNotify(t)&&this._notifyDescendant(t)},this),this._fireResize())},assignParentResizable:function(t){this._parentResizable&&this._parentResizable.stopResizeNotificationsFor(this),this._parentResizable=t,t&&t._interestedResizables.indexOf(this)===-1&&(t._interestedResizables.push(this),t._subscribeIronResize(this))},stopResizeNotificationsFor:function(t){var e=this._interestedResizables.indexOf(t);e>-1&&(this._interestedResizables.splice(e,1),this._unsubscribeIronResize(t))},_subscribeIronResize:function(t){t.addEventListener("iron-resize",this._boundOnDescendantIronResize)},_unsubscribeIronResize:function(t){t.removeEventListener("iron-resize",this._boundOnDescendantIronResize)},resizerShouldNotify:function(t){return!0},_onDescendantIronResize:function(t){this._notifyingDescendant?t.stopPropagation():TG||this._fireResize()},_fireResize:function(){this.fire("iron-resize",null,{node:this,bubbles:!1})},_onIronRequestResizeNotifications:function(t){var e=Vm(t).rootTarget;e!==this&&(e.assignParentResizable(this),this._notifyDescendant(e),t.stopPropagation())},_parentResizableChanged:function(t){t&&window.removeEventListener("resize",this._boundNotifyResize)},_notifyDescendant:function(t){this.isAttached&&(this._notifyingDescendant=!0,t.notifyResize(),this._notifyingDescendant=!1)},_requestResizeNotifications:function(){if(this.isAttached)if(document.readyState==="loading"){var t=this._requestResizeNotifications.bind(this);document.addEventListener("readystatechange",function e(){document.removeEventListener("readystatechange",e),t()})}else this._findParent(),this._parentResizable?this._parentResizable._interestedResizables.forEach(function(e){e!==this&&e._findParent()},this):(IM.forEach(function(e){e!==this&&e._findParent()},this),window.addEventListener("resize",this._boundNotifyResize),this.notifyResize())},_findParent:function(){this.assignParentResizable(null),this.fire("iron-request-resize-notifications",null,{node:this,bubbles:!0,cancelable:!0}),this._parentResizable?IM.delete(this):IM.add(this)}},iYe={properties:{scrollTarget:{type:HTMLElement,value:function(){return this._defaultScrollTarget}}},observers:["_scrollTargetChanged(scrollTarget, isAttached)"],_shouldHaveListener:!0,_scrollTargetChanged:function(t,e){if(this._oldScrollTarget&&(this._toggleScrollListener(!1,this._oldScrollTarget),this._oldScrollTarget=null),e)if(t==="document")this.scrollTarget=this._doc;else if(typeof t=="string"){var i=this.domHost;this.scrollTarget=i&&i.$?i.$[t]:Vm(this.ownerDocument).querySelector("#"+t)}else this._isValidScrollTarget()&&(this._oldScrollTarget=t,this._toggleScrollListener(this._shouldHaveListener,t))},_scrollHandler:function(){},get _defaultScrollTarget(){return this._doc},get _doc(){return this.ownerDocument.documentElement},get _scrollTop(){return this._isValidScrollTarget()?this.scrollTarget===this._doc?window.pageYOffset:this.scrollTarget.scrollTop:0},get _scrollLeft(){return this._isValidScrollTarget()?this.scrollTarget===this._doc?window.pageXOffset:this.scrollTarget.scrollLeft:0},set _scrollTop(t){this.scrollTarget===this._doc?window.scrollTo(window.pageXOffset,t):this._isValidScrollTarget()&&(this.scrollTarget.scrollTop=t)},set _scrollLeft(t){this.scrollTarget===this._doc?window.scrollTo(t,window.pageYOffset):this._isValidScrollTarget()&&(this.scrollTarget.scrollLeft=t)},scroll:function(t,e){var i;typeof t=="object"?(i=t.left,e=t.top):i=t,i=i||0,e=e||0,this.scrollTarget===this._doc?window.scrollTo(i,e):this._isValidScrollTarget()&&(this.scrollTarget.scrollLeft=i,this.scrollTarget.scrollTop=e)},get _scrollTargetWidth(){return this._isValidScrollTarget()?this.scrollTarget===this._doc?window.innerWidth:this.scrollTarget.offsetWidth:0},get _scrollTargetHeight(){return this._isValidScrollTarget()?this.scrollTarget===this._doc?window.innerHeight:this.scrollTarget.offsetHeight:0},_isValidScrollTarget:function(){return this.scrollTarget instanceof HTMLElement},_toggleScrollListener:function(t,e){var i=e===this._doc?window:e;t?this._boundScrollHandler||(this._boundScrollHandler=this._scrollHandler.bind(this),i.addEventListener("scroll",this._boundScrollHandler)):this._boundScrollHandler&&(i.removeEventListener("scroll",this._boundScrollHandler),this._boundScrollHandler=null)},toggleScrollListener:function(t){this._shouldHaveListener=t,this._toggleScrollListener(t,this.scrollTarget)}},iQ=navigator.userAgent.match(/iP(?:hone|ad;(?: U;)? CPU) OS (\d+)/),rYe=iQ&&iQ[1]>=8,rQ=3,nYe=FZe({behaviors:[tYe,iYe],_ratio:.5,_scrollerPaddingTop:0,_scrollPosition:0,_physicalSize:0,_physicalAverage:0,_physicalAverageCount:0,_physicalTop:0,_virtualCount:0,_estScrollHeight:0,_scrollHeight:0,_viewportHeight:0,_viewportWidth:0,_physicalItems:null,_physicalSizes:null,_firstVisibleIndexVal:null,_lastVisibleIndexVal:null,_maxPages:2,_focusedVirtualIndex:-1,_templateCost:0,get _physicalBottom(){return this._physicalTop+this._physicalSize},get _scrollBottom(){return this._scrollPosition+this._viewportHeight},get _virtualEnd(){return this._virtualStart+this._physicalCount-1},get _hiddenContentSize(){return this._physicalSize-this._viewportHeight},get _maxScrollTop(){return this._estScrollHeight-this._viewportHeight+this._scrollOffset},get _maxVirtualStart(){return Math.max(0,this._virtualCount-this._physicalCount)},set _virtualStart(t){t=this._clamp(t,0,this._maxVirtualStart),this._virtualStartVal=t},get _virtualStart(){return this._virtualStartVal||0},set _physicalStart(t){(t%=this._physicalCount)<0&&(t=this._physicalCount+t),this._physicalStartVal=t},get _physicalStart(){return this._physicalStartVal||0},get _physicalEnd(){return(this._physicalStart+this._physicalCount-1)%this._physicalCount},set _physicalCount(t){this._physicalCountVal=t},get _physicalCount(){return this._physicalCountVal||0},get _optPhysicalSize(){return this._viewportHeight===0?1/0:this._viewportHeight*this._maxPages},get _isVisible(){return!!(this.offsetWidth||this.offsetHeight)},get firstVisibleIndex(){let t=this._firstVisibleIndexVal;if(t==null){let e=this._physicalTop+this._scrollOffset;t=this._iterateItems(function(i,r){if(e+=this._physicalSizes[i],e>this._scrollPosition)return r})||0,this._firstVisibleIndexVal=t}return t},get lastVisibleIndex(){let t=this._lastVisibleIndexVal;if(t==null){let e=this._physicalTop+this._scrollOffset;this._iterateItems(function(i,r){e<this._scrollBottom&&(t=r),e+=this._physicalSizes[i]}),this._lastVisibleIndexVal=t}return t},get _scrollOffset(){return this._scrollerPaddingTop},attached:function(){this._debounce("_render",this._render,up),this.listen(this,"iron-resize","_resizeHandler")},detached:function(){this.unlisten(this,"iron-resize","_resizeHandler")},updateViewportBoundaries:function(){const t=window.getComputedStyle(this);this._scrollerPaddingTop=this.scrollTarget===this?0:parseInt(t["padding-top"],10),this._isRTL=t.direction==="rtl",this._viewportWidth=this.$.items.offsetWidth,this._viewportHeight=this._scrollTargetHeight},_scrollHandler:function(){const t=Math.max(0,Math.min(this._maxScrollTop,this._scrollTop));let e=t-this._scrollPosition;const i=e>=0;if(this._scrollPosition=t,this._firstVisibleIndexVal=null,this._lastVisibleIndexVal=null,Math.abs(e)>this._physicalSize&&this._physicalSize>0){e-=this._scrollOffset;const r=Math.round(e/this._physicalAverage);this._virtualStart=this._virtualStart+r,this._physicalStart=this._physicalStart+r,this._physicalTop=Math.floor(this._virtualStart)*this._physicalAverage,this._update()}else if(this._physicalCount>0){const{physicalTop:r,indexes:n}=this._getReusables(i);i?(this._physicalTop=r,this._virtualStart=this._virtualStart+n.length,this._physicalStart=this._physicalStart+n.length):(this._virtualStart=this._virtualStart-n.length,this._physicalStart=this._physicalStart-n.length),this._update(n,i?null:n),this._debounce("_increasePoolIfNeeded",this._increasePoolIfNeeded.bind(this,0),nc)}},_getReusables:function(t){let e,i,r;const n=[],s=this._hiddenContentSize*this._ratio,o=this._virtualStart,a=this._virtualEnd,l=this._physicalCount;let c=this._physicalTop+this._scrollOffset;const u=this._physicalBottom+this._scrollOffset,h=this._scrollTop,f=this._scrollBottom;for(t?(e=this._physicalStart,i=h-c):(e=this._physicalEnd,i=u-f);r=this._physicalSizes[e],i-=r,!(n.length>=l||i<=s);)if(t){if(a+n.length+1>=this._virtualCount||c+r>=h-this._scrollOffset)break;n.push(e),c+=r,e=(e+1)%l}else{if(o-n.length<=0||c+this._physicalSize-r<=f)break;n.push(e),c-=r,e=e===0?l-1:e-1}return{indexes:n,physicalTop:c-this._scrollOffset}},_update:function(t,e){if(!(t&&t.length===0||this._physicalCount===0)){if(this._assignModels(t),this._updateMetrics(t),e)for(;e.length;){const i=e.pop();this._physicalTop-=this._physicalSizes[i]}this._positionItems(),this._updateScrollerSize()}},_isClientFull:function(){return this._scrollBottom!=0&&this._physicalBottom-1>=this._scrollBottom&&this._physicalTop<=this._scrollPosition},_increasePoolIfNeeded:function(t){const e=this._clamp(this._physicalCount+t,rQ,this._virtualCount-this._virtualStart)-this._physicalCount;let i=Math.round(.5*this._physicalCount);if(!(e<0)){if(e>0){const r=window.performance.now();[].push.apply(this._physicalItems,this._createPool(e));for(let n=0;n<e;n++)this._physicalSizes.push(0);this._physicalCount=this._physicalCount+e,this._physicalStart>this._physicalEnd&&this._isIndexRendered(this._focusedVirtualIndex)&&this._getPhysicalIndex(this._focusedVirtualIndex)<this._physicalEnd&&(this._physicalStart=this._physicalStart+e),this._update(),this._templateCost=(window.performance.now()-r)/e,i=Math.round(.5*this._physicalCount)}this._virtualEnd>=this._virtualCount-1||i===0||(this._isClientFull()?this._physicalSize<this._optPhysicalSize&&this._debounce("_increasePoolIfNeeded",this._increasePoolIfNeeded.bind(this,this._clamp(Math.round(50/this._templateCost),1,i)),Gme):this._debounce("_increasePoolIfNeeded",this._increasePoolIfNeeded.bind(this,i),nc))}},_render:function(){if(this.isAttached&&this._isVisible)if(this._physicalCount!==0){const{physicalTop:t,indexes:e}=this._getReusables(!0);this._physicalTop=t,this._virtualStart=this._virtualStart+e.length,this._physicalStart=this._physicalStart+e.length,this._update(e),this._update(),this._increasePoolIfNeeded(0)}else this._virtualCount>0&&(this.updateViewportBoundaries(),this._increasePoolIfNeeded(rQ))},_itemsChanged:function(t){t.path==="items"&&(this._virtualStart=0,this._physicalTop=0,this._virtualCount=this.items?this.items.length:0,this._physicalIndexForKey={},this._firstVisibleIndexVal=null,this._lastVisibleIndexVal=null,this._physicalCount=this._physicalCount||0,this._physicalItems=this._physicalItems||[],this._physicalSizes=this._physicalSizes||[],this._physicalStart=0,this._scrollTop>this._scrollOffset&&this._resetScrollPosition(0),this._debounce("_render",this._render,up))},_iterateItems:function(t,e){let i,r,n,s;if(arguments.length===2&&e){for(s=0;s<e.length;s++)if(i=e[s],r=this._computeVidx(i),(n=t.call(this,i,r))!=null)return n}else{for(i=this._physicalStart,r=this._virtualStart;i<this._physicalCount;i++,r++)if((n=t.call(this,i,r))!=null)return n;for(i=0;i<this._physicalStart;i++,r++)if((n=t.call(this,i,r))!=null)return n}},_computeVidx:function(t){return t>=this._physicalStart?this._virtualStart+(t-this._physicalStart):this._virtualStart+(this._physicalCount-this._physicalStart)+t},_updateMetrics:function(t){S1();let e=0,i=0;const r=this._physicalAverageCount,n=this._physicalAverage;this._iterateItems(function(s){i+=this._physicalSizes[s],this._physicalSizes[s]=this._physicalItems[s].offsetHeight,e+=this._physicalSizes[s],this._physicalAverageCount+=this._physicalSizes[s]?1:0},t),this._physicalSize=this._physicalSize+e-i,this._physicalAverageCount!==r&&(this._physicalAverage=Math.round((n*r+e)/this._physicalAverageCount))},_positionItems:function(){this._adjustScrollPosition();let t=this._physicalTop;this._iterateItems(function(e){this.translate3d(0,t+"px",0,this._physicalItems[e]),t+=this._physicalSizes[e]})},_adjustScrollPosition:function(){const t=this._virtualStart===0?this._physicalTop:Math.min(this._scrollPosition+this._physicalTop,0);if(t!==0){this._physicalTop=this._physicalTop-t;const e=this._scrollTop;!rYe&&e>0&&this._resetScrollPosition(e-t)}},_resetScrollPosition:function(t){this.scrollTarget&&t>=0&&(this._scrollTop=t,this._scrollPosition=this._scrollTop)},_updateScrollerSize:function(t){this._estScrollHeight=this._physicalBottom+Math.max(this._virtualCount-this._physicalCount-this._virtualStart,0)*this._physicalAverage,((t=(t=t||this._scrollHeight===0)||this._scrollPosition>=this._estScrollHeight-this._physicalSize)||Math.abs(this._estScrollHeight-this._scrollHeight)>=this._viewportHeight)&&(this.$.items.style.height=this._estScrollHeight+"px",this._scrollHeight=this._estScrollHeight)},scrollToIndex:function(t){if(typeof t!="number"||t<0||t>this.items.length-1||(S1(),this._physicalCount===0))return;t=this._clamp(t,0,this._virtualCount-1),(!this._isIndexRendered(t)||t>=this._maxVirtualStart)&&(this._virtualStart=t-1),this._assignModels(),this._updateMetrics(),this._physicalTop=Math.floor(this._virtualStart)*this._physicalAverage;let e=this._physicalStart,i=this._virtualStart,r=0;const n=this._hiddenContentSize;for(;i<t&&r<=n;)r+=this._physicalSizes[e],e=(e+1)%this._physicalCount,i++;this._updateScrollerSize(!0),this._positionItems(),this._resetScrollPosition(this._physicalTop+this._scrollOffset+r),this._increasePoolIfNeeded(0),this._firstVisibleIndexVal=null,this._lastVisibleIndexVal=null},_resetAverage:function(){this._physicalAverage=0,this._physicalAverageCount=0},_resizeHandler:function(){this._debounce("_render",function(){this._firstVisibleIndexVal=null,this._lastVisibleIndexVal=null,this.updateViewportBoundaries(),this._isVisible?(this.toggleScrollListener(!0),this._resetAverage(),this._render()):this.toggleScrollListener(!1)},up)},_isIndexRendered:function(t){return t>=this._virtualStart&&t<=this._virtualEnd},_getPhysicalIndex:function(t){return(this._physicalStart+(t-this._virtualStart))%this._physicalCount},_clamp:function(t,e,i){return Math.min(i,Math.max(e,t))},_debounce:function(t,e,i){this._debouncers=this._debouncers||{},this._debouncers[t]=Ur.debounce(this._debouncers[t],i,e.bind(this)),fR(this._debouncers[t])}});class sYe extends nYe{static get properties(){return{size:{type:Number,notify:!0},_vidxOffset:{type:Number,value:0}}}static get observers(){return["_effectiveSizeChanged(_effectiveSize)"]}connectedCallback(){super.connectedCallback(),this._scrollHandler()}_updateScrollerItem(){}_afterScroll(){}_getRowTarget(){}_createScrollerRows(){}_canPopulate(){}scrollToIndex(e){this._warnPrivateAPIAccess("scrollToIndex"),this._scrollingToIndex=!0,e=Math.min(Math.max(e,0),this._effectiveSize-1),this.$.table.scrollTop=e/this._effectiveSize*(this.$.table.scrollHeight-this.$.table.offsetHeight),this._scrollHandler(),this._accessIronListAPI(()=>this._maxScrollTop)&&this._virtualCount<this._effectiveSize&&this._adjustVirtualIndexOffset(1e6),this._accessIronListAPI(()=>super.scrollToIndex(e-this._vidxOffset)),this._scrollHandler();const i=Array.from(this.$.items.children).filter(r=>r.index===e)[0];if(i){const r=i.getBoundingClientRect().top-this.$.header.getBoundingClientRect().bottom;Math.abs(r)>1&&(this.$.table.scrollTop+=r,this._scrollHandler())}this._scrollingToIndex=!1}_effectiveSizeChanged(e){let i,r=0;this._iterateItems((n,s)=>{if(s===this._firstVisibleIndex){const o=this._physicalItems[n];i=o.index,r=o.getBoundingClientRect().top}}),this.items&&e<this.items.length&&(this._scrollTop=0),!Array.isArray(this.items)&&(this.items={length:Math.min(e,1e5)}),this._accessIronListAPI(()=>super._itemsChanged({path:"items"})),this._virtualCount=Math.min(this.items.length,e)||0,this._scrollTop===0&&(this._accessIronListAPI(()=>this._scrollToIndex(Math.min(e-1,i))),this._iterateItems(n=>{const s=this._physicalItems[n];if(s.index===i&&(this.$.table.scrollTop+=Math.round(s.getBoundingClientRect().top-r)),s.index===this._focusedItemIndex&&this._itemsFocusable&&this.$.items.contains(this.shadowRoot.activeElement)){const o=Array.from(this._itemsFocusable.parentElement.children).indexOf(this._itemsFocusable);s.children[o].focus()}})),this._assignModels(),requestAnimationFrame(()=>this._update()),this.__updateFooterPositioning()}_positionItems(){let e;this._adjustScrollPosition(),isNaN(this._physicalTop)&&(e=!0,this._physicalTop=0);let i=this._physicalTop;this._iterateItems(r=>{this._physicalItems[r].style.transform=`translateY(${i}px)`,i+=this._physicalSizes[r]}),e&&this._scrollToIndex(0)}_increasePoolIfNeeded(e){e===0&&this._scrollingToIndex||!this._canPopulate()||!this._effectiveSize||(this._initialPoolCreated?this._optPhysicalSize!==1/0&&(this._debounceIncreasePool=Ur.debounce(this._debounceIncreasePool,up,()=>{this._updateMetrics();const i=this._optPhysicalSize-this._physicalSize;let r=Math.ceil(i/this._physicalAverage);this._physicalCount+r>this._effectiveSize&&(r=Math.max(0,this._effectiveSize-this._physicalCount)),this._physicalSize&&r>0&&this._optPhysicalSize!==1/0&&(super._increasePoolIfNeeded(r),this.__reorderChildNodes())})):(this._initialPoolCreated=!0,super._increasePoolIfNeeded(25)))}__reorderChildNodes(){const e=Array.from(this.$.items.childNodes);e.reduce((i,r,n,s)=>{if(n===0||s[n-1].index===r.index-1)return i},!0)||e.sort((i,r)=>i.index-r.index).forEach(i=>this.$.items.appendChild(i))}_createPool(e){const i=document.createDocumentFragment(),r=this._createScrollerRows(e);r.forEach(s=>i.appendChild(s)),this._getRowTarget().appendChild(i);const n=this.querySelector("[slot]");if(n){const s=n.getAttribute("slot");n.setAttribute("slot","foo-bar"),n.setAttribute("slot",s)}return zJe(this,()=>this.notifyResize()),r}_assignModels(e){this._iterateItems((i,r)=>{const n=this._physicalItems[i];this._toggleAttribute("hidden",r>=this._effectiveSize,n),this._updateScrollerItem(n,r+(this._vidxOffset||0))},e)}_scrollHandler(){const e=this.$.table.scrollTop-this._scrollPosition;this._accessIronListAPI(super._scrollHandler);const i=this._vidxOffset;this._accessIronListAPI(()=>this._maxScrollTop)&&this._virtualCount<this._effectiveSize?this._adjustVirtualIndexOffset(e):this._vidxOffset=0,this._vidxOffset!==i&&this._update(),this._afterScroll()}_adjustVirtualIndexOffset(e){if(Math.abs(e)>1e4){if(this._noScale)return void(this._noScale=!1);const i=this.$.table.scrollTop/(this.$.table.scrollHeight-this.$.table.offsetHeight),r=i*this._effectiveSize;this._vidxOffset=Math.round(r-i*this._virtualCount)}else{const i=this._vidxOffset||0,r=1e3,n=100;this._scrollTop===0?(this._vidxOffset=0,i!==this._vidxOffset&&super.scrollToIndex(0)):this.firstVisibleIndex<r&&this._vidxOffset>0&&(this._vidxOffset-=Math.min(this._vidxOffset,n),i!==this._vidxOffset&&super.scrollToIndex(this.firstVisibleIndex+(i-this._vidxOffset)),this._noScale=!0);const s=this._effectiveSize-this._virtualCount;this._scrollTop>=this._maxScrollTop&&this._maxScrollTop>0?(this._vidxOffset=s,i!==this._vidxOffset&&super.scrollToIndex(this._virtualCount)):this.firstVisibleIndex>this._virtualCount-r&&this._vidxOffset<s&&(this._vidxOffset+=Math.min(s-this._vidxOffset,n),i!==this._vidxOffset&&super.scrollToIndex(this.firstVisibleIndex-(this._vidxOffset-i)),this._noScale=!0)}}_accessIronListAPI(e){this._warnPrivateAPIAccessAsyncEnabled=!1;const i=e.apply(this);return this._debouncerWarnPrivateAPIAccess=Ur.debounce(this._debouncerWarnPrivateAPIAccess,up,()=>this._warnPrivateAPIAccessAsyncEnabled=!0),i}_debounceRender(e,i){super._debounceRender(()=>this._accessIronListAPI(e),i)}_warnPrivateAPIAccess(e){this._warnPrivateAPIAccessAsyncEnabled&&console.warn(`Accessing private API (${e})!`)}_render(){this._accessIronListAPI(super._render)}_itemsChanged(){}get _firstVisibleIndex(){return this._accessIronListAPI(()=>super.firstVisibleIndex)}get _lastVisibleIndex(){return this._accessIronListAPI(()=>super.lastVisibleIndex)}_scrollToIndex(e){this._accessIronListAPI(()=>this.scrollToIndex(e))}get firstVisibleIndex(){return this._warnPrivateAPIAccess("firstVisibleIndex"),super.firstVisibleIndex}set firstVisibleIndex(e){this._warnPrivateAPIAccess("firstVisibleIndex"),super.firstVisibleIndex=e}get lastVisibleIndex(){return this._warnPrivateAPIAccess("lastVisibleIndex"),super.lastVisibleIndex}set lastVisibleIndex(e){this._warnPrivateAPIAccess("lastVisibleIndex"),super.lastVisibleIndex=e}updateViewportBoundaries(){this._warnPrivateAPIAccess("updateViewportBoundaries"),super.updateViewportBoundaries.apply(this,arguments)}_resizeHandler(){super._resizeHandler(),S1()}}const oYe=t=>class extends t{static get observers(){return["_a11yUpdateGridSize(size, _columnTree, _columnTree.*)"]}_a11yGetHeaderRowCount(e){return e.filter(i=>i.some(r=>r._headerTemplate||r.headerRenderer||r.path||r.header)).length}_a11yGetFooterRowCount(e){return e.filter(i=>i.some(r=>r._headerTemplate||r.headerRenderer)).length}_a11yUpdateGridSize(e,i){if(e===void 0||i===void 0)return;const r=i[i.length-1];this.$.table.setAttribute("aria-rowcount",e+this._a11yGetHeaderRowCount(i)+this._a11yGetFooterRowCount(i)),this.$.table.setAttribute("aria-colcount",r&&r.length||0),this._a11yUpdateHeaderRows(),this._a11yUpdateFooterRows()}_a11yUpdateHeaderRows(){Array.from(this.$.header.children).forEach((e,i)=>e.setAttribute("aria-rowindex",i+1))}_a11yUpdateFooterRows(){Array.from(this.$.footer.children).forEach((e,i)=>e.setAttribute("aria-rowindex",this._a11yGetHeaderRowCount(this._columnTree)+this.size+i+1))}_a11yUpdateRowRowindex(e,i){e.setAttribute("aria-rowindex",i+this._a11yGetHeaderRowCount(this._columnTree)+1)}_a11yUpdateRowSelected(e,i){e.setAttribute("aria-selected",!!i),Array.from(e.children).forEach(r=>r.setAttribute("aria-selected",!!i))}_a11yUpdateRowLevel(e,i){e.setAttribute("aria-level",i+1)}_a11yUpdateRowDetailsOpened(e,i){Array.from(e.children).forEach(r=>{typeof i=="boolean"?r.setAttribute("aria-expanded",i):r.hasAttribute("aria-expanded")&&r.removeAttribute("aria-expanded")})}_a11ySetRowDetailsCell(e,i){Array.from(e.children).forEach(r=>{r!==i&&r.setAttribute("aria-controls",i.id)})}_a11yUpdateCellColspan(e,i){e.setAttribute("aria-colspan",Number(i))}_a11yUpdateSorters(){Array.from(this.querySelectorAll("vaadin-grid-sorter")).forEach(e=>{let i=e.parentNode;for(;i&&i.localName!=="vaadin-grid-cell-content";)i=i.parentNode;i&&i.assignedSlot&&i.assignedSlot.parentNode.setAttribute("aria-sort",{asc:"ascending",desc:"descending"}[String(e.direction)]||"none")})}},aYe=t=>class extends t{static get properties(){return{activeItem:{type:Object,notify:!0,value:null}}}ready(){super.ready(),this.$.scroller.addEventListener("click",this._onClick.bind(this)),this.addEventListener("cell-activate",this._activateItem.bind(this))}_activateItem(e){const i=e.detail.model,r=i?i.item:null;r&&(this.activeItem=this._itemsEqual(this.activeItem,r)?null:r)}_onClick(e){if(e.defaultPrevented)return;const i=e.composedPath(),r=i[i.indexOf(this.$.table)-3];if(!r||r.getAttribute("part").indexOf("details-cell")>-1)return;const n=r._content,s=this.getRootNode().activeElement;n.contains(s)||this._isFocusable(e.target)||this.dispatchEvent(new CustomEvent("cell-activate",{detail:{model:this.__getRowModel(r.parentElement)}}))}_isFocusable(e){return lYe(e)}},lYe=t=>{if(!t.parentNode)return!1;const e=Array.from(t.parentNode.querySelectorAll("[tabindex], button, input, select, textarea, object, iframe, label, a[href], area[href]")).filter(i=>i.getAttribute("part")!=="cell body-cell").indexOf(t)!==-1;return!t.disabled&&e},cYe=t=>class extends t{static get properties(){return{items:Array}}static get observers(){return["_itemsChanged(items, items.*, isAttached)"]}_itemsChanged(e,i,r){if(r){if(!Array.isArray(e))return e==null&&(this.size=0),void(this.dataProvider===this._arrayDataProvider&&(this.dataProvider=void 0));this.size=e.length,this.dataProvider=this.dataProvider||this._arrayDataProvider,this.clearCache(),this._ensureFirstPageLoaded()}}_arrayDataProvider(e,i){let r=(Array.isArray(this.items)?this.items:[]).slice(0);this._filters&&this._checkPaths(this._filters,"filtering",r)&&(r=this._filter(r)),this.size=r.length,e.sortOrders.length&&this._checkPaths(this._sorters,"sorting",r)&&(r=r.sort(this._multiSort.bind(this)));const n=e.page*e.pageSize,s=n+e.pageSize;i(r.slice(n,s),r.length)}_checkPaths(e,i,r){if(!r.length)return!1;let n=!0;for(let s in e){const o=e[s].path;if(!o||o.indexOf(".")===-1)continue;const a=o.replace(/\.[^.]*$/,"");C_.get(a,r[0])===void 0&&(console.warn(`Path "${o}" used for ${i} does not exist in all of the items, ${i} is disabled.`),n=!1)}return n}_multiSort(e,i){return this._sorters.map(r=>r.direction==="asc"?this._compare(C_.get(r.path,e),C_.get(r.path,i)):r.direction==="desc"?this._compare(C_.get(r.path,i),C_.get(r.path,e)):0).reduce((r,n)=>r||n,0)}_normalizeEmptyValue(e){return[void 0,null].indexOf(e)>=0?"":isNaN(e)?e.toString():e}_compare(e,i){return(e=this._normalizeEmptyValue(e))<(i=this._normalizeEmptyValue(i))?-1:e>i?1:0}_filter(e){return e.filter(i=>this._filters.filter(r=>{const n=this._normalizeEmptyValue(C_.get(r.path,i)),s=this._normalizeEmptyValue(r.value).toString().toLowerCase();return n.toString().toLowerCase().indexOf(s)===-1}).length===0)}},uYe=t=>class extends jC(t){ready(){super.ready();const e=this.$.scroller;NG(e,"track",this._onHeaderTrack.bind(this)),e.addEventListener("touchmove",i=>e.hasAttribute("column-resizing")&&i.preventDefault()),e.addEventListener("contextmenu",i=>i.target.getAttribute("part")=="resize-handle"&&i.preventDefault()),e.addEventListener("mousedown",i=>i.target.getAttribute("part")==="resize-handle"&&i.preventDefault())}_onHeaderTrack(e){const i=e.target;if(i.getAttribute("part")==="resize-handle"){let r=i.parentElement._column;for(this._toggleAttribute("column-resizing",!0,this.$.scroller);r.localName==="vaadin-grid-column-group";)r=Array.prototype.slice.call(r._childColumns,0).sort(function(o,a){return o._order-a._order}).filter(function(o){return!o.hidden}).pop();const n=Array.from(this.$.header.querySelectorAll('[part~="row"]:last-child [part~="cell"]')),s=n.filter(o=>o._column===r)[0];if(s.offsetWidth){const o=window.getComputedStyle(s),a=10+parseInt(o.paddingLeft)+parseInt(o.paddingRight)+parseInt(o.borderLeftWidth)+parseInt(o.borderRightWidth)+parseInt(o.marginLeft)+parseInt(o.marginRight),l=s.offsetWidth+(this.__isRTL?s.getBoundingClientRect().left-e.detail.x:e.detail.x-s.getBoundingClientRect().right);r.width=Math.max(a,l)+"px",r.flexGrow=0}n.sort(function(o,a){return o._column._order-a._column._order}).forEach(function(o,a,l){a<l.indexOf(s)&&(o._column.width=o.offsetWidth+"px",o._column.flexGrow=0)}),e.detail.state==="end"&&(this._toggleAttribute("column-resizing",!1,this.$.scroller),this.dispatchEvent(new CustomEvent("column-resize",{detail:{resizedColumn:r}}))),this._resizeHandler()}}},nQ=class Nge{constructor(e,i,r){this.grid=e,this.parentCache=i,this.parentItem=r,this.itemCaches={},this.items={},this.effectiveSize=0,this.size=0,this.pendingRequests={}}isLoading(){return!!(Object.keys(this.pendingRequests).length||Object.keys(this.itemCaches).filter(e=>this.itemCaches[e].isLoading())[0])}getItemForIndex(e){const{cache:i,scaledIndex:r}=this.getCacheAndIndex(e);return i.items[r]}updateSize(){this.effectiveSize=!this.parentItem||this.grid._isExpanded(this.parentItem)?this.size+Object.keys(this.itemCaches).reduce((e,i)=>{const r=this.itemCaches[i];return r.updateSize(),e+r.effectiveSize},0):0}ensureSubCacheForScaledIndex(e){if(!this.itemCaches[e]){const i=new Nge(this.grid,this,this.items[e]);this.itemCaches[e]=i,this.grid._loadPage(0,i)}}getCacheAndIndex(e){let i=e;const r=Object.keys(this.itemCaches);for(let n=0;n<r.length;n++){const s=Number(r[n]),o=this.itemCaches[s];if(i<=s)return{cache:this,scaledIndex:i};if(i<=s+o.effectiveSize)return o.getCacheAndIndex(i-s-1);i-=o.effectiveSize}return{cache:this,scaledIndex:i}}},dYe=t=>class extends t{static get properties(){return{pageSize:{type:Number,value:50,observer:"_pageSizeChanged"},dataProvider:{type:Object,notify:!0,observer:"_dataProviderChanged"},loading:{type:Boolean,notify:!0,readOnly:!0,reflectToAttribute:!0},_cache:{type:Object,value:function(){return new nQ(this)}},itemIdPath:{type:String,value:null},expandedItems:{type:Object,notify:!0,value:()=>[]}}}static get observers(){return["_sizeChanged(size)","_itemIdPathChanged(itemIdPath)","_expandedItemsChanged(expandedItems.*)"]}_sizeChanged(e){const i=e-this._cache.size;this._cache.size+=i,this._cache.effectiveSize+=i,this._effectiveSize=this._cache.effectiveSize,this._increasePoolIfNeeded(0),this._debounceIncreasePool&&this._debounceIncreasePool.flush()}_getItem(e,i){if(e>=this._effectiveSize)return;i.index=e;const{cache:r,scaledIndex:n}=this._cache.getCacheAndIndex(e),s=r.items[n];s?(this._toggleAttribute("loading",!1,i),this._updateItem(i,s),this._isExpanded(s)&&r.ensureSubCacheForScaledIndex(n)):(this._toggleAttribute("loading",!0,i),this._loadPage(this._getPageForIndex(n),r))}_expandedInstanceChangedCallback(e,i){e.item!==void 0&&(i?this.expandItem(e.item):this.collapseItem(e.item))}getItemId(e){return this.itemIdPath?this.get(this.itemIdPath,e):e}_isExpanded(e){return this.__expandedKeys.has(this.getItemId(e))}_expandedItemsChanged(){this.__cacheExpandedKeys(),this._cache.updateSize(),this._effectiveSize=this._cache.effectiveSize,this._assignModels()}_itemIdPathChanged(){this.__cacheExpandedKeys()}__cacheExpandedKeys(){this.expandedItems&&(this.__expandedKeys=new Set,this.expandedItems.forEach(e=>{this.__expandedKeys.add(this.getItemId(e))}))}expandItem(e){this._isExpanded(e)||this.push("expandedItems",e)}collapseItem(e){this._isExpanded(e)&&this.splice("expandedItems",this._getItemIndexInArray(e,this.expandedItems),1)}_getIndexLevel(e){let{cache:i}=this._cache.getCacheAndIndex(e),r=0;for(;i.parentCache;)i=i.parentCache,r++;return r}_canPopulate(){return!!(this._hasData&&this._columnTree)}_loadPage(e,i){if(!i.pendingRequests[e]&&this.dataProvider){this._setLoading(!0),i.pendingRequests[e]=!0;const r={page:e,pageSize:this.pageSize,sortOrders:this._mapSorters(),filters:this._mapFilters(),parentItem:i.parentItem};this._debounceIncreasePool&&this._debounceIncreasePool.flush(),this.dataProvider(r,(n,s)=>{s!==void 0?i.size=s:r.parentItem&&(i.size=n.length);const o=Array.from(this.$.items.children).map(a=>a._item);n.forEach((a,l)=>{const c=e*this.pageSize+l;i.items[c]=a,this._isExpanded(a)&&o.indexOf(a)>-1&&i.ensureSubCacheForScaledIndex(c)}),this._hasData=!0,delete i.pendingRequests[e],this._debouncerApplyCachedData=Ur.debounce(this._debouncerApplyCachedData,bu.after(0),()=>{this._setLoading(!1),this._cache.updateSize(),this._effectiveSize=this._cache.effectiveSize,Array.from(this.$.items.children).filter(a=>!a.hidden).forEach(a=>{this._cache.getItemForIndex(a.index)&&this._getItem(a.index,a)}),this._increasePoolIfNeeded(0),this.__scrollToPendingIndex()}),this._cache.isLoading()||this._debouncerApplyCachedData.flush(),this.__itemsReceived()})}}_getPageForIndex(e){return Math.floor(e/this.pageSize)}clearCache(){this._cache=new nQ(this),Array.from(this.$.items.children).forEach(e=>{Array.from(e.children).forEach(i=>{i._instance&&i._instance._setPendingProperty("item",{},!1)})}),this._cache.size=this.size||0,this._cache.updateSize(),this._hasData=!1,this._assignModels(),this._effectiveSize&&this._initialPoolCreated||this._loadPage(0,this._cache)}_pageSizeChanged(e,i){i!==void 0&&e!==i&&this.clearCache()}_checkSize(){this.size===void 0&&this._effectiveSize===0&&console.warn("The <vaadin-grid> needs the total number of items in order to display rows. Set the total number of items to the `size` property, or provide the total number of items in the second argument of the `dataProvider`’s `callback` call.")}_dataProviderChanged(e,i){i!==void 0&&this.clearCache(),e&&this.items&&this.items.length&&this._scrollToIndex(this._firstVisibleIndex),this._ensureFirstPageLoaded(),this._debouncerCheckSize=Ur.debounce(this._debouncerCheckSize,bu.after(2e3),this._checkSize.bind(this)),this._scrollHandler()}_ensureFirstPageLoaded(){this._hasData||this._loadPage(0,this._cache)}_itemsEqual(e,i){return this.getItemId(e)===this.getItemId(i)}_getItemIndexInArray(e,i){let r=-1;return i.forEach((n,s)=>{this._itemsEqual(n,e)&&(r=s)}),r}scrollToIndex(e){super.scrollToIndex(e),isNaN(e)||!this._cache.isLoading()&&this.clientHeight||(this.__pendingScrollToIndex=e)}__scrollToPendingIndex(){if(this.__pendingScrollToIndex&&this.$.items.children.length){const e=this.__pendingScrollToIndex;delete this.__pendingScrollToIndex,this._debounceIncreasePool&&this._debounceIncreasePool.flush(),this.scrollToIndex(e)}}},hYe=t=>class extends t{ready(){super.ready(),this._addNodeObserver()}_hasColumnGroups(e){for(let i=0;i<e.length;i++)if(e[i].localName==="vaadin-grid-column-group")return!0;return!1}_getChildColumns(e){return hp.getFlattenedNodes(e).filter(this._isColumnElement)}_flattenColumnGroups(e){return e.map(i=>i.localName==="vaadin-grid-column-group"?this._getChildColumns(i):[i]).reduce((i,r)=>i.concat(r),[])}_getColumnTree(){const e=[];for(let i=hp.getFlattenedNodes(this).filter(this._isColumnElement);e.push(i),this._hasColumnGroups(i);)i=this._flattenColumnGroups(i);return e}_updateColumnTree(){const e=this._getColumnTree();this._arrayEquals(e,this._columnTree)||(this._columnTree=e)}_addNodeObserver(){this._observer=new hp(this,e=>{const i=e.addedNodes.filter(n=>n.localName==="template"&&n.classList.contains("row-details"))[0];i&&this._rowDetailsTemplate!==i&&(this._rowDetailsTemplate=i);const r=n=>n.filter(this._isColumnElement).length>0;if(r(e.addedNodes)||r(e.removedNodes)){const n=e.removedNodes.flatMap(o=>o._allCells),s=o=>n.filter(a=>a._content.contains(o)).length;this.__removeSorters(this._sorters.filter(s)),this.__removeFilters(this._filters.filter(s)),this._updateColumnTree()}this._debouncerCheckImports=Ur.debounce(this._debouncerCheckImports,bu.after(2e3),this._checkImports.bind(this)),this._ensureFirstPageLoaded()})}_arrayEquals(e,i){if(!e||!i||e.length!=i.length)return!1;for(let r=0,n=e.length;r<n;r++)if(e[r]instanceof Array&&i[r]instanceof Array){if(!this._arrayEquals(e[r],i[r]))return!1}else if(e[r]!=i[r])return!1;return!0}_checkImports(){["vaadin-grid-column-group","vaadin-grid-filter","vaadin-grid-filter-column","vaadin-grid-tree-toggle","vaadin-grid-selection-column","vaadin-grid-sort-column","vaadin-grid-sorter"].forEach(e=>{const i=this.querySelector(e);!i||i instanceof Pp||console.warn(`Make sure you have imported the required module for <${e}> element.`)})}_updateFirstAndLastColumn(){Array.from(this.shadowRoot.querySelectorAll("tr")).forEach(e=>this._updateFirstAndLastColumnForRow(e))}_updateFirstAndLastColumnForRow(e){Array.from(e.querySelectorAll('[part~="cell"]:not([part~="details-cell"])')).sort((i,r)=>i._column._order-r._column._order).forEach((i,r,n)=>{this._toggleAttribute("first-column",r===0,i),this._toggleAttribute("last-column",r===n.length-1,i)})}_isColumnElement(e){return e.nodeType===Node.ELEMENT_NODE&&/\bcolumn\b/.test(e.localName)}},pYe=t=>class extends t{getEventContext(e){const i={},r=e.composedPath(),n=r[r.indexOf(this.$.table)-3];return n&&(i.section=["body","header","footer","details"].filter(s=>n.getAttribute("part").indexOf(s)>-1)[0],n._column&&(i.column=n._column),i.section!=="body"&&i.section!=="details"||Object.assign(i,this.__getRowModel(n.parentElement))),i}},fYe=t=>class extends t{static get properties(){return{_filters:{type:Array,value:function(){return[]}}}}ready(){super.ready(),this.addEventListener("filter-changed",this._filterChanged.bind(this))}_filterChanged(e){e.stopPropagation(),this.__addFilter(e.target),this.__applyFilters()}__removeFilters(e){e.length!=0&&(this._filters=this._filters.filter(i=>e.indexOf(i)<0),this.__applyFilters())}__addFilter(e){this._filters.indexOf(e)===-1&&this._filters.push(e)}__applyFilters(){this.dataProvider&&this.isAttached&&this.clearCache()}_mapFilters(){return this._filters.map(e=>({path:e.path,value:e.value}))}};class sO extends Pp{static get is(){return"vaadin-grid-templatizer"}static get properties(){return{dataHost:Object,template:Object,_templateInstances:{type:Array,value:function(){return[]}},_parentPathValues:{value:function(){return{}}},_grid:Object}}static get observers(){return["_templateInstancesChanged(_templateInstances.*, _parentPathValues.*)"]}constructor(){super(),this._instanceProps={detailsOpened:!0,index:!0,item:!0,selected:!0,expanded:!0,level:!0}}createInstance(){this._ensureTemplatized();const e=new this._TemplateClass({});return this.addInstance(e),e}addInstance(e){this._templateInstances.indexOf(e)===-1&&(this._templateInstances.push(e),requestAnimationFrame(()=>this.notifyPath("_templateInstances.*",this._templateInstances)))}removeInstance(e){const i=this._templateInstances.indexOf(e);this.splice("_templateInstances",i,1)}_ensureTemplatized(){this._TemplateClass||(this._TemplateClass=OT(this.template,this,{instanceProps:this._instanceProps,parentModel:!0,forwardHostProp:function(e,i){this._forwardParentProp(e,i),this._templateInstances&&this._templateInstances.forEach(r=>r.notifyPath(e,i))},notifyInstanceProp:function(e,i,r){if(i==="index"||i==="item")return;const n=`__${i}__`;if(e[n]===r)return;e[n]=r;const s=Array.from(this._grid.$.items.children).filter(l=>this._grid._itemsEqual(l._item,e.item))[0];s&&Array.from(s.children).forEach(l=>{l._instance&&(l._instance[n]=r,l._instance.notifyPath(i,r))});const o="item.";if(Array.isArray(this._grid.items)&&i.indexOf(o)===0){const l=this._grid.items.indexOf(e.item),c=i.slice(o.length);this._grid.notifyPath(`items.${l}.${c}`,r)}const a=`_${i}InstanceChangedCallback`;this._grid&&this._grid[a]&&this._grid[a](e,r)}}))}_forwardParentProp(e,i){this._parentPathValues[e]=i,this._templateInstances.forEach(r=>r.notifyPath(e,i))}_templateInstancesChanged(e){let i,r;if(e.path==="_templateInstances")i=0,r=this._templateInstances.length;else{if(e.path!=="_templateInstances.splices")return;i=e.value.index,r=e.value.addedCount}Object.keys(this._parentPathValues||{}).forEach(n=>{for(let s=i;s<i+r;s++)this._templateInstances[s].set(n,this._parentPathValues[n])})}}customElements.define(sO.is,sO);const mYe=t=>class extends t{static get properties(){return{detailsOpenedItems:{type:Array,value:function(){return[]}},_rowDetailsTemplate:Object,rowDetailsRenderer:Function,_detailsCells:{type:Array}}}static get observers(){return["_detailsOpenedItemsChanged(detailsOpenedItems.*, _rowDetailsTemplate, rowDetailsRenderer)","_rowDetailsTemplateOrRendererChanged(_rowDetailsTemplate, rowDetailsRenderer)"]}_rowDetailsTemplateOrRendererChanged(e,i){if(e&&i)throw new Error("You should only use either a renderer or a template for row details");if(e||i){if(e&&!e.templatizer){const r=new sO;r._grid=this,r.dataHost=this.dataHost,r.template=e,e.templatizer=r}this._columnTree&&Array.from(this.$.items.children).forEach(r=>{r.querySelector("[part~=details-cell]")||(this._updateRow(r,this._columnTree[this._columnTree.length-1]),this._a11yUpdateRowDetailsOpened(r,!1)),delete r.querySelector("[part~=details-cell]")._instance}),this.detailsOpenedItems.length&&(Array.from(this.$.items.children).forEach(this._toggleDetailsCell,this),this._update())}}_detailsOpenedItemsChanged(e){e.path!=="detailsOpenedItems.length"&&e.value&&Array.from(this.$.items.children).forEach(i=>{this._toggleDetailsCell(i,i._item),this._a11yUpdateRowDetailsOpened(i,this._isDetailsOpened(i._item)),this._toggleAttribute("details-opened",this._isDetailsOpened(i._item),i)})}_configureDetailsCell(e){e.setAttribute("part","cell details-cell"),this._toggleAttribute("frozen",!0,e)}_toggleDetailsCell(e,i){const r=e.querySelector('[part~="details-cell"]');if(!r)return;const n=!this._isDetailsOpened(i),s=!!r.hidden!==n;(r._instance||r._renderer)&&r.hidden===n||(r.hidden=n,n?e.style.removeProperty("padding-bottom"):(this.rowDetailsRenderer?(r._renderer=this.rowDetailsRenderer,r._renderer.call(this,r._content,this,{index:e.index,item:i})):this._rowDetailsTemplate&&!r._instance&&(r._instance=this._rowDetailsTemplate.templatizer.createInstance(),r._content.innerHTML="",r._content.appendChild(r._instance.root),this._updateItem(e,i)),S1(),e.style.setProperty("padding-bottom",`${r.offsetHeight}px`),requestAnimationFrame(()=>this.notifyResize()))),s&&(this._updateMetrics(),this._positionItems())}_updateDetailsCellHeights(){Array.from(this.$.items.querySelectorAll('[part~="details-cell"]:not([hidden])')).forEach(e=>{e.parentElement.style.setProperty("padding-bottom",`${e.offsetHeight}px`)})}_isDetailsOpened(e){return this.detailsOpenedItems&&this._getItemIndexInArray(e,this.detailsOpenedItems)!==-1}openItemDetails(e){this._isDetailsOpened(e)||this.push("detailsOpenedItems",e)}closeItemDetails(e){this._isDetailsOpened(e)&&this.splice("detailsOpenedItems",this._getItemIndexInArray(e,this.detailsOpenedItems),1)}_detailsOpenedInstanceChangedCallback(e,i){i?this.openItemDetails(e.item):this.closeItemDetails(e.item)}},cF={SCROLLING:500,IGNORE_WHEEL:500},gYe=t=>class extends t{static get properties(){return{_frozenCells:{type:Array,value:()=>[]},_rowWithFocusedElement:Element,_deltaYAcc:{type:Number,value:0},_useSticky:{type:Boolean,value:window.CSS&&window.CSS.supports&&(window.CSS.supports("position","sticky")||window.CSS.supports("position","-webkit-sticky"))}}}static get observers(){return["_scrollViewportHeightUpdated(_viewportHeight)"]}set _scrollTop(e){this.$.table.scrollTop=e}get _scrollTop(){return this.$.table.scrollTop}constructor(){super(),this._scrollLineHeight=this._getScrollLineHeight()}_getScrollLineHeight(){const e=document.createElement("div");e.style.fontSize="initial",e.style.display="none",document.body.appendChild(e);const i=window.getComputedStyle(e).fontSize;return document.body.removeChild(e),i?window.parseInt(i):void 0}_scrollViewportHeightUpdated(e){this._scrollPageHeight=e-this.$.header.clientHeight-this.$.footer.clientHeight-this._scrollLineHeight}ready(){super.ready(),this.$.outerscroller=document.createElement("div"),this.scrollTarget=this.$.table,this.addEventListener("wheel",this._onWheel),this.$.items.addEventListener("focusin",e=>{const i=e.composedPath().indexOf(this.$.items);this._rowWithFocusedElement=e.composedPath()[i-1]}),this.$.items.addEventListener("focusout",()=>this._rowWithFocusedElement=void 0),this.scrollTarget.addEventListener("mousedown",()=>this.__mouseDown=!0),this.scrollTarget.addEventListener("mouseup",()=>{this.__mouseDown=!1,this.__pendingReorder&&(this.__pendingReorder=!1,setTimeout(()=>this._reorderRows(),cF.SCROLLING))})}scrollToIndex(e){this._accessIronListAPI(()=>super.scrollToIndex(e))}_onWheel(e){if(e.ctrlKey||this._hasScrolledAncestor(e.target,e.deltaX,e.deltaY))return;const i=this.$.table;let r=e.deltaY;if(e.deltaMode===WheelEvent.DOM_DELTA_LINE?r*=this._scrollLineHeight:e.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(r*=this._scrollPageHeight),this._wheelAnimationFrame)return this._deltaYAcc+=r,void e.preventDefault();r+=this._deltaYAcc,this._deltaYAcc=0,this._wheelAnimationFrame=!0,this._debouncerWheelAnimationFrame=Ur.debounce(this._debouncerWheelAnimationFrame,up,()=>this._wheelAnimationFrame=!1);const n=Math.abs(e.deltaX)+Math.abs(r);this._canScroll(i,e.deltaX,r)?(e.preventDefault(),i.scrollTop+=r,i.scrollLeft+=e.deltaX,this._scrollHandler(),this._hasResidualMomentum=!0,this._ignoreNewWheel=!0,this._debouncerIgnoreNewWheel=Ur.debounce(this._debouncerIgnoreNewWheel,bu.after(cF.IGNORE_WHEEL),()=>this._ignoreNewWheel=!1)):this._hasResidualMomentum&&n<=this._previousMomentum||this._ignoreNewWheel?e.preventDefault():n>this._previousMomentum&&(this._hasResidualMomentum=!1),this._previousMomentum=n}_hasScrolledAncestor(e,i,r){return e.localName!=="vaadin-grid-cell-content"&&(!(!this._canScroll(e,i,r)||["auto","scroll"].indexOf(getComputedStyle(e).overflow)===-1)||(e!==this&&e.parentElement?this._hasScrolledAncestor(e.parentElement,i,r):void 0))}_canScroll(e,i,r){return r>0&&e.scrollTop<e.scrollHeight-e.offsetHeight||r<0&&e.scrollTop>0||i>0&&e.scrollLeft<e.scrollWidth-e.offsetWidth||i<0&&e.scrollLeft>0}_scheduleScrolling(){this._scrollingFrame||(this._scrollingFrame=requestAnimationFrame(()=>this._toggleAttribute("scrolling",!0,this.$.scroller))),this._debounceScrolling=Ur.debounce(this._debounceScrolling,bu.after(cF.SCROLLING),()=>{cancelAnimationFrame(this._scrollingFrame),delete this._scrollingFrame,this._toggleAttribute("scrolling",!1,this.$.scroller),this._reorderRows()})}_afterScroll(){this._translateStationaryElements(),this.hasAttribute("reordering")||this._scheduleScrolling(),this._updateOverflow()}_updateOverflow(){let e="";const i=this.$.table;i.scrollTop<i.scrollHeight-i.clientHeight&&(e+=" bottom"),i.scrollTop>0&&(e+=" top"),i.scrollLeft<i.scrollWidth-i.clientWidth&&(e+=" right"),i.scrollLeft>0&&(e+=" left"),this._debounceOverflow=Ur.debounce(this._debounceOverflow,up,()=>{const r=e.trim();r.length>0&&this.getAttribute("overflow")!==r?this.setAttribute("overflow",r):r.length==0&&this.hasAttribute("overflow")&&this.removeAttribute("overflow")})}_reorderRows(){if(this.__mouseDown)return void(this.__pendingReorder=!0);const e=this.$.items,i=e.querySelectorAll("tr");if(!i.length)return;const r=this._virtualStart+this._vidxOffset,n=this._rowWithFocusedElement||Array.from(i).filter(a=>!a.hidden)[0];if(!n)return;const s=n.index-r,o=Array.from(i).indexOf(n)-s;if(o>0)for(let a=0;a<o;a++)e.appendChild(i[a]);else if(o<0)for(let a=i.length+o;a<i.length;a++)e.insertBefore(i[a],i[0]);if(this._safari){const{transform:a}=this.$.header.style;this.$.header.style.transform="",setTimeout(()=>this.$.header.style.transform=a)}}_frozenCellsChanged(){this._debouncerCacheElements=Ur.debounce(this._debouncerCacheElements,nc,()=>{Array.from(this.shadowRoot.querySelectorAll('[part~="cell"]')).forEach(function(e){e.style.transform=""}),this._frozenCells=Array.prototype.slice.call(this.$.table.querySelectorAll("[frozen]")),this._updateScrollerMeasurements(),this._translateStationaryElements()}),this._updateLastFrozen()}_updateScrollerMeasurements(){this._frozenCells.length>0&&this.__isRTL&&(this.__scrollerMetrics={scrollWidth:this.$.table.scrollWidth,clientWidth:this.$.table.clientWidth})}_updateLastFrozen(){if(!this._columnTree)return;const e=this._columnTree[this._columnTree.length-1].slice(0);e.sort((r,n)=>r._order-n._order);const i=e.reduce((r,n,s)=>(n._lastFrozen=!1,n.frozen&&!n.hidden?s:r),void 0);i!==void 0&&(e[i]._lastFrozen=!0)}_translateStationaryElements(){const e=Math.max(0,this._scrollLeft),i=Math.max(0,this._scrollTop);let r=0,n=0,s=0;if(this._useSticky||(r=e,n=i,s=this.$.table.clientHeight-this.$.footer.offsetHeight-this.$.footer.offsetTop),this.$.header.style.transform=this._getTranslate(-e+r,n),this.$.footer.style.transform=this._getTranslate(-e+r,n+s),this.$.items.style.transform=this._getTranslate(-e+r,0),this._frozenCells.length>0){const o=this.__isRTL?this.__getNormalizedScrollLeft(this.$.table)+this.__scrollerMetrics.clientWidth-this.__scrollerMetrics.scrollWidth:this._scrollLeft,a=this._getTranslate(o,0);for(let l=0;l<this._frozenCells.length;l++)this._frozenCells[l].style.transform=a}}_getTranslate(e,i){return`translate(${e}px, ${i}px)`}},yYe=t=>class extends t{static get properties(){return{selectedItems:{type:Object,notify:!0,value:()=>[]}}}static get observers(){return["_selectedItemsChanged(selectedItems.*)"]}_isSelected(e){return this.selectedItems&&this._getItemIndexInArray(e,this.selectedItems)>-1}selectItem(e){this._isSelected(e)||this.push("selectedItems",e)}deselectItem(e){const i=this._getItemIndexInArray(e,this.selectedItems);i>-1&&this.splice("selectedItems",i,1)}_toggleItem(e){this._getItemIndexInArray(e,this.selectedItems)===-1?this.selectItem(e):this.deselectItem(e)}_selectedItemsChanged(e){!this.$.items.children.length||e.path!=="selectedItems"&&e.path!=="selectedItems.splices"||Array.from(this.$.items.children).forEach(i=>{this._updateItem(i,i._item)})}_selectedInstanceChangedCallback(e,i){i?this.selectItem(e.item):this.deselectItem(e.item)}},vYe=t=>class extends t{static get properties(){return{multiSort:{type:Boolean,value:!1},_sorters:{type:Array,value:function(){return[]}},_previousSorters:{type:Array,value:function(){return[]}}}}ready(){super.ready(),this.addEventListener("sorter-changed",this._onSorterChanged)}_onSorterChanged(e){const i=e.target;e.stopPropagation(),this.__updateSorter(i),this.__applySorters()}__removeSorters(e){e.length!=0&&(this._sorters=this._sorters.filter(i=>e.indexOf(i)<0),this.multiSort&&this.__updateSortOrders(),this.__applySorters())}__updateSortOrders(){this._sorters.forEach((e,i)=>e._order=this._sorters.length>1?i:null,this)}__updateSorter(e){if(e.direction||this._sorters.indexOf(e)!==-1){if(e._order=null,this.multiSort)this._removeArrayItem(this._sorters,e),e.direction&&this._sorters.unshift(e),this.__updateSortOrders();else if(e.direction){const i=this._sorters.filter(r=>r!=e);this._sorters=[e],i.forEach(r=>{r._order=null,r.direction=null})}}}__applySorters(){this.dataProvider&&this.isAttached&&JSON.stringify(this._previousSorters)!==JSON.stringify(this._mapSorters())&&this.clearCache(),this._a11yUpdateSorters(),this._previousSorters=this._mapSorters()}_mapSorters(){return this._sorters.map(e=>({path:e.path,direction:e.direction}))}_removeArrayItem(e,i){const r=e.indexOf(i);r>-1&&e.splice(r,1)}},_Ye=t=>class extends t{static get properties(){return{cellClassNameGenerator:Function}}static get observers(){return["__cellClassNameGeneratorChanged(cellClassNameGenerator)"]}__cellClassNameGeneratorChanged(){this.generateCellClassNames()}generateCellClassNames(){Array.from(this.$.items.children).filter(e=>!e.hidden).forEach(e=>this._generateCellClassNames(e,this.__getRowModel(e)))}_generateCellClassNames(e,i){Array.from(e.children).forEach(r=>{if(r.__generatedClasses&&r.__generatedClasses.forEach(n=>r.classList.remove(n)),this.cellClassNameGenerator){const n=this.cellClassNameGenerator(r._column,i);r.__generatedClasses=n&&n.split(" ").filter(s=>s.length>0),r.__generatedClasses&&r.__generatedClasses.forEach(s=>r.classList.add(s))}})}},qx={BETWEEN:"between",ON_TOP:"on-top",ON_TOP_OR_BETWEEN:"on-top-or-between",ON_GRID:"on-grid"},sf={ON_TOP:"on-top",ABOVE:"above",BELOW:"below",EMPTY:"empty"},bYe=t=>class extends t{static get properties(){return{dropMode:String,rowsDraggable:Boolean,dragFilter:Function,dropFilter:Function,__dndAutoScrollThreshold:{value:50}}}static get observers(){return["_dragDropAccessChanged(rowsDraggable, dropMode, dragFilter, dropFilter)"]}ready(){super.ready(),this.$.table.addEventListener("dragstart",this._onDragStart.bind(this)),this.$.table.addEventListener("dragend",this._onDragEnd.bind(this)),this.$.table.addEventListener("dragover",this._onDragOver.bind(this)),this.$.table.addEventListener("dragleave",this._onDragLeave.bind(this)),this.$.table.addEventListener("drop",this._onDrop.bind(this)),this.$.table.addEventListener("dragenter",e=>{this.dropMode&&(e.preventDefault(),e.stopPropagation())})}_onDragStart(e){if(this.rowsDraggable){let i=e.target;if(i.localName==="vaadin-grid-cell-content"&&(i=i.assignedSlot.parentNode.parentNode),i.parentNode!==this.$.items)return;if(e.stopPropagation(),this._toggleAttribute("dragging-rows",!0,this),this._safari){const o=i.style.transform;i.style.top=/translateY\((.*)\)/.exec(o)[1],i.style.transform="none",requestAnimationFrame(()=>{i.style.top="",i.style.transform=o})}const r=i.getBoundingClientRect();this._ios?e.dataTransfer.setDragImage(i):e.dataTransfer.setDragImage(i,e.clientX-r.left,e.clientY-r.top);let n=[i];this._isSelected(i._item)&&(n=this.__getViewportRows().filter(o=>this._isSelected(o._item)).filter(o=>!this.dragFilter||this.dragFilter(this.__getRowModel(o)))),e.dataTransfer.setData("text",this.__formatDefaultTransferData(n)),i.setAttribute("dragstart",n.length>1?n.length:""),this.updateStyles({"--_grid-drag-start-x":e.clientX-r.left+20+"px","--_grid-drag-start-y":e.clientY-r.top+10+"px"}),requestAnimationFrame(()=>{i.removeAttribute("dragstart"),this.updateStyles({"--_grid-drag-start-x":"","--_grid-drag-start-y":""})});const s=new CustomEvent("grid-dragstart",{detail:{draggedItems:n.map(o=>o._item),setDragData:(o,a)=>e.dataTransfer.setData(o,a),setDraggedItemsCount:o=>i.setAttribute("dragstart",o)}});s.originalEvent=e,this.dispatchEvent(s)}}_onDragEnd(e){this._toggleAttribute("dragging-rows",!1,this),e.stopPropagation();const i=new CustomEvent("grid-dragend");i.originalEvent=e,this.dispatchEvent(i)}_onDragLeave(e){e.stopPropagation(),this._clearDragStyles()}_onDragOver(e){if(this.dropMode){if(this._dropLocation=void 0,this._dragOverItem=void 0,this.__dndAutoScroll(e.clientY))return void this._clearDragStyles();let i=e.composedPath().filter(r=>r.localName==="tr")[0];if(this._effectiveSize&&this.dropMode!==qx.ON_GRID)if(i&&i.parentNode===this.$.items){const r=i.getBoundingClientRect();if(this._dropLocation=sf.ON_TOP,this.dropMode===qx.BETWEEN){const n=e.clientY-r.top<r.bottom-e.clientY;this._dropLocation=n?sf.ABOVE:sf.BELOW}else this.dropMode===qx.ON_TOP_OR_BETWEEN&&(e.clientY-r.top<r.height/3?this._dropLocation=sf.ABOVE:e.clientY-r.top>r.height/3*2&&(this._dropLocation=sf.BELOW))}else{if(i||this.dropMode!==qx.BETWEEN&&this.dropMode!==qx.ON_TOP_OR_BETWEEN)return;i=Array.from(this.$.items.children).filter(r=>!r.hidden).pop(),this._dropLocation=sf.BELOW}else this._dropLocation=sf.EMPTY;if(i&&i.hasAttribute("drop-disabled"))return void(this._dropLocation=void 0);e.stopPropagation(),e.preventDefault(),this._dropLocation===sf.EMPTY?this._toggleAttribute("dragover",!0,this):i?(this._dragOverItem=i._item,i.getAttribute("dragover")!==this._dropLocation&&i.setAttribute("dragover",this._dropLocation)):this._clearDragStyles()}}__dndAutoScroll(e){if(this.__dndAutoScrolling)return!0;const i=this.$.header.getBoundingClientRect().bottom,r=this.$.footer.getBoundingClientRect().top,n=i-e+this.__dndAutoScrollThreshold,s=e-r+this.__dndAutoScrollThreshold;let o=0;if(s>0?o=2*s:n>0&&(o=2*-n),o){const a=this.$.table.scrollTop;if(this.$.table.scrollTop+=o,a!==this.$.table.scrollTop)return this.__dndAutoScrolling=!0,setTimeout(()=>this.__dndAutoScrolling=!1,20),this._scrollHandler(),!0}}__getViewportRows(){const e=this.$.header.getBoundingClientRect().bottom,i=this.$.footer.getBoundingClientRect().top;return Array.from(this.$.items.children).filter(r=>{const n=r.getBoundingClientRect();return n.bottom>e&&n.top<i})}_clearDragStyles(){this.removeAttribute("dragover"),Array.from(this.$.items.children).forEach(e=>e.removeAttribute("dragover"))}_onDrop(e){if(this.dropMode){e.stopPropagation(),e.preventDefault();const i=e.dataTransfer.types&&Array.from(e.dataTransfer.types).map(n=>({type:n,data:e.dataTransfer.getData(n)}));this._clearDragStyles();const r=new CustomEvent("grid-drop",{bubbles:e.bubbles,cancelable:e.cancelable,detail:{dropTargetItem:this._dragOverItem,dropLocation:this._dropLocation,dragData:i}});r.originalEvent=e,this.dispatchEvent(r)}}__formatDefaultTransferData(e){return e.map(i=>Array.from(i.children).filter(r=>!r.hidden&&r.getAttribute("part").indexOf("details-cell")===-1).sort((r,n)=>r._column._order>n._column._order?1:-1).map(r=>r._content.textContent.trim()).filter(r=>r).join("	")).join(`
`)}_dragDropAccessChanged(){this.filterDragAndDrop()}filterDragAndDrop(){Array.from(this.$.items.children).filter(e=>!e.hidden).forEach(e=>{this._filterDragAndDrop(e,this.__getRowModel(e))})}_filterDragAndDrop(e,i){const r=!this.rowsDraggable||this.dragFilter&&!this.dragFilter(i),n=!this.dropMode||this.dropFilter&&!this.dropFilter(i);Array.from(e.children).map(s=>s._content).forEach(s=>{r?s.removeAttribute("draggable"):s.setAttribute("draggable",!0)}),this._toggleAttribute("drag-disabled",r,e),this._toggleAttribute("drop-disabled",n,e)}},wYe=t=>class extends t{static get properties(){return{_headerFocusable:{type:Object,observer:"_focusableChanged"},_itemsFocusable:{type:Object,observer:"_focusableChanged"},_footerFocusable:{type:Object,observer:"_focusableChanged"},_navigatingIsHidden:Boolean,_focusedItemIndex:{type:Number,value:0},_focusedColumnOrder:Number}}ready(){super.ready(),this._ios||this._android||(this.addEventListener("keydown",this._onKeyDown),this.addEventListener("keyup",this._onKeyUp),this.addEventListener("focusin",this._onFocusIn),this.addEventListener("focusout",this._onFocusOut),this.$.table.addEventListener("focusin",this._onCellFocusIn.bind(this)),this.$.table.addEventListener("focusout",this._onCellFocusOut.bind(this)),this.addEventListener("mousedown",()=>{this._toggleAttribute("navigating",!1,this),this._isMousedown=!0}),this.addEventListener("mouseup",()=>this._isMousedown=!1))}_focusableChanged(e,i){i&&i.setAttribute("tabindex","-1"),e&&e.setAttribute("tabindex","0")}_onKeyDown(e){const i=e.key;let r;switch(i){case"ArrowUp":case"ArrowDown":case"ArrowLeft":case"ArrowRight":case"PageUp":case"PageDown":case"Home":case"End":r="Navigation";break;case"Enter":case"Escape":case"F2":r="Interaction";break;case"Tab":r="Tab";break;case" ":r="Space"}this._detectInteracting(e),this.hasAttribute("interacting")&&r!=="Interaction"&&(r=void 0),r&&this[`_on${r}KeyDown`](e,i)}_ensureScrolledToIndex(e){Array.from(this.$.items.children).filter(i=>i.index===e)[0]||this._scrollToIndex(e)}_onNavigationKeyDown(e,i){function r(E){return Array.prototype.indexOf.call(E.parentNode.children,E)}this._scrollHandler(),e.preventDefault();const n=this._lastVisibleIndex-this._firstVisibleIndex-1;let s=0,o=0;switch(i){case"ArrowRight":s=this.__isRTL?-1:1;break;case"ArrowLeft":s=this.__isRTL?1:-1;break;case"Home":s=-1/0,e.ctrlKey&&(o=-1/0);break;case"End":s=1/0,e.ctrlKey&&(o=1/0);break;case"ArrowDown":o=1;break;case"ArrowUp":o=-1;break;case"PageDown":o=n;break;case"PageUp":o=-n}const a=e.composedPath()[0],l=r(a),c=this._elementMatches(a,'[part~="details-cell"]'),u=a.parentNode,h=u.parentNode,f=(h===this.$.items?this._effectiveSize:h.children.length)-1,m=h===this.$.items?this._focusedItemIndex!==void 0?this._focusedItemIndex:u.index:r(u);let g=Math.max(0,Math.min(m+o,f)),y=!1;if(h===this.$.items){const E=u._item,$=this._cache.getItemForIndex(g);y=c?o===0:o===1&&this._isDetailsOpened(E)||o===-1&&g!==m&&this._isDetailsOpened($),y!==c&&(o===1&&y||o===-1&&!y)&&(g=m)}if(h!==this.$.items){if(g>m)for(;g<f&&h.children[g].hidden;)g++;else if(g<m)for(;g>0&&h.children[g].hidden;)g--}this._focusedColumnOrder===void 0&&(this._focusedColumnOrder=c?0:this._getColumns(h,m).filter(E=>!E.hidden)[l]._order);const v=this._getColumns(h,g).filter(E=>!E.hidden),b=v.map(E=>E._order).sort((E,$)=>E-$),w=b.length-1,x=b.indexOf(b.slice(0).sort((E,$)=>Math.abs(E-this._focusedColumnOrder)-Math.abs($-this._focusedColumnOrder))[0]),S=o===0&&c?x:Math.max(0,Math.min(x+s,w));S!==x&&(this._focusedColumnOrder=void 0),h===this.$.items&&this._ensureScrolledToIndex(g),this._toggleAttribute("navigating",!0,this);const I=v.reduce((E,$,P)=>(E[$._order]=P,E),{})[b[S]],T=h===this.$.items?Array.from(h.children).filter(E=>E.index===g)[0]:h.children[g];if(!T)return;const C=y?Array.from(T.children).filter(E=>this._elementMatches(E,'[part~="details-cell"]'))[0]:T.children[I];if(this._scrollHorizontallyToCell(C),h===this.$.items&&(this._focusedItemIndex=g),h===this.$.items){const E=C.getBoundingClientRect(),$=this.$.footer.getBoundingClientRect().top,P=this.$.header.getBoundingClientRect().bottom;E.bottom>$?(this.$.table.scrollTop+=E.bottom-$,this._scrollHandler()):E.top<P&&(this.$.table.scrollTop-=P-E.top,this._scrollHandler())}C.focus()}_parseEventPath(e){const i=e.indexOf(this.$.table);return{rowGroup:e[i-1],row:e[i-2],cell:e[i-3]}}_onInteractionKeyDown(e,i){const r=e.composedPath()[0],n=r.localName==="input"&&!/^(button|checkbox|color|file|image|radio|range|reset|submit)$/i.test(r.type);let s;switch(i){case"Enter":s=!this.hasAttribute("interacting")||!n;break;case"Escape":s=!1;break;case"F2":s=!this.hasAttribute("interacting")}const{cell:o}=this._parseEventPath(e.composedPath());if(this.hasAttribute("interacting")!==s)if(s){const a=o._content.querySelector("[focus-target]")||o._content.firstElementChild;a&&(e.preventDefault(),a.focus(),this._toggleAttribute("interacting",!0,this),this._toggleAttribute("navigating",!1,this))}else e.preventDefault(),this._focusedColumnOrder=void 0,o.focus(),this._toggleAttribute("interacting",!1,this),this._toggleAttribute("navigating",!0,this)}_predictFocusStepTarget(e,i){const r=[this.$.table,this._headerFocusable,this._itemsFocusable,this._footerFocusable,this.$.focusexit];let n=r.indexOf(e);for(n+=i;n>=0&&n<=r.length-1&&(!r[n]||r[n].parentNode.hidden);)n+=i;return r[n]}_onTabKeyDown(e){const i=this._predictFocusStepTarget(e.composedPath()[0],e.shiftKey?-1:1);if(i===this.$.table)this.$.table.focus();else if(i===this.$.focusexit)this.$.focusexit.focus();else if(i===this._itemsFocusable){let r=i;const n=this._itemsFocusable.parentNode;if(this._ensureScrolledToIndex(this._focusedItemIndex),n.index!==this._focusedItemIndex){const s=Array.from(n.children).indexOf(this._itemsFocusable),o=Array.from(this.$.items.children).filter(a=>a.index===this._focusedItemIndex)[0];o&&(r=o.children[s])}e.preventDefault(),r.focus()}else e.preventDefault(),i.focus();this._toggleAttribute("navigating",!0,this)}_onSpaceKeyDown(e){e.preventDefault();const i=e.composedPath()[0];i._content&&i._content.firstElementChild||this.dispatchEvent(new CustomEvent("cell-activate",{detail:{model:this.__getRowModel(i.parentElement)}}))}_onKeyUp(e){if(!/^( |SpaceBar)$/.test(e.key))return;e.preventDefault();const i=e.composedPath()[0];if(i._content&&i._content.firstElementChild){const r=this.hasAttribute("navigating");i._content.firstElementChild.click(),this._toggleAttribute("navigating",r,this)}}_onFocusIn(e){this._isMousedown||this._toggleAttribute("navigating",!0,this);const i=e.composedPath()[0];i===this.$.table||i===this.$.focusexit?(this._predictFocusStepTarget(i,i===this.$.table?1:-1).focus(),this._toggleAttribute("interacting",!1,this)):this._detectInteracting(e)}_onFocusOut(e){this._toggleAttribute("navigating",!1,this),this._detectInteracting(e)}_onCellFocusIn(e){if(this._detectInteracting(e),e.composedPath().indexOf(this.$.table)===3){const i=e.composedPath()[0];this._activeRowGroup=i.parentNode.parentNode,this._activeRowGroup===this.$.header?this._headerFocusable=i:this._activeRowGroup===this.$.items?this._itemsFocusable=i:this._activeRowGroup===this.$.footer&&(this._footerFocusable=i),i._content.dispatchEvent(new CustomEvent("cell-focusin",{bubbles:!1}))}this._detectFocusedItemIndex(e)}_onCellFocusOut(e){e.composedPath().indexOf(this.$.table)===3&&e.composedPath()[0]._content.dispatchEvent(new CustomEvent("cell-focusout",{bubbles:!1}))}_detectInteracting(e){this._toggleAttribute("interacting",e.composedPath().some(i=>i.localName==="vaadin-grid-cell-content"),this)}_detectFocusedItemIndex(e){const{rowGroup:i,row:r}=this._parseEventPath(e.composedPath());i===this.$.items&&(this._focusedItemIndex=r.index)}_preventScrollerRotatingCellFocus(e,i){e.index===this._focusedItemIndex&&this.hasAttribute("navigating")&&this._activeRowGroup===this.$.items&&(this._navigatingIsHidden=!0,this._toggleAttribute("navigating",!1,this)),i===this._focusedItemIndex&&this._navigatingIsHidden&&(this._navigatingIsHidden=!1,this._toggleAttribute("navigating",!0,this))}_getColumns(e,i){let r=this._columnTree.length-1;return e===this.$.header?r=i:e===this.$.footer&&(r=this._columnTree.length-1-i),this._columnTree[r]}_resetKeyboardNavigation(){if(this.$.header.firstElementChild&&(this._headerFocusable=Array.from(this.$.header.firstElementChild.children).filter(e=>!e.hidden)[0]),this.$.items.firstElementChild){const e=this._iterateItems((i,r)=>{if(this._firstVisibleIndex===r)return this.$.items.children[i]});e&&(this._itemsFocusable=Array.from(e.children).filter(i=>!i.hidden)[0])}this.$.footer.firstElementChild&&(this._footerFocusable=Array.from(this.$.footer.firstElementChild.children).filter(e=>!e.hidden)[0])}_scrollHorizontallyToCell(e){if(e.hasAttribute("frozen")||this._elementMatches(e,'[part~="details-cell"]'))return;const i=e.getBoundingClientRect(),r=e.parentNode,n=Array.from(r.children).indexOf(e),s=this.$.table.getBoundingClientRect();let o=s.left,a=s.right;for(let l=n-1;l>=0;l--){const c=r.children[l];if(!c.hasAttribute("hidden")&&!this._elementMatches(c,'[part~="details-cell"]')&&c.hasAttribute("frozen")){o=c.getBoundingClientRect().right;break}}for(let l=n+1;l<r.children.length;l++){const c=r.children[l];if(!c.hasAttribute("hidden")&&!this._elementMatches(c,'[part~="details-cell"]')&&c.hasAttribute("frozen")){a=c.getBoundingClientRect().left;break}}i.left<o&&(this.$.table.scrollLeft+=Math.round(i.left-o)),i.right>a&&(this.$.table.scrollLeft+=Math.round(i.right-a))}_elementMatches(e,i){return e.matches?e.matches(i):Array.from(e.parentNode.querySelectorAll(i)).indexOf(e)!==-1}},xYe=t=>class extends jC(t){static get properties(){return{columnReorderingAllowed:{type:Boolean,value:!1},_orderBaseScope:{type:Number,value:1e7}}}static get observers(){return["_updateOrders(_columnTree, _columnTree.*)"]}ready(){super.ready(),NG(this,"track",this._onTrackEvent),this._reorderGhost=this.shadowRoot.querySelector('[part="reorder-ghost"]'),this.addEventListener("touchstart",this._onTouchStart.bind(this)),this.addEventListener("touchmove",this._onTouchMove.bind(this)),this.addEventListener("touchend",this._onTouchEnd.bind(this)),this.addEventListener("contextmenu",this._onContextMenu.bind(this))}_onContextMenu(e){this.hasAttribute("reordering")&&e.preventDefault()}_onTouchStart(e){this._startTouchReorderTimeout=setTimeout(()=>{this._onTrackStart({detail:{x:e.touches[0].clientX,y:e.touches[0].clientY}})},100)}_onTouchMove(e){this._draggedColumn&&e.preventDefault(),clearTimeout(this._startTouchReorderTimeout)}_onTouchEnd(){clearTimeout(this._startTouchReorderTimeout),this._onTrackEnd()}_onTrackEvent(e){if(e.detail.state==="start"){const i=e.composedPath(),r=i[i.indexOf(this.$.header)-2];if(!r||!r._content||r._content.contains(this.getRootNode().activeElement)||this.$.scroller.hasAttribute("column-resizing"))return;this._touchDevice||this._onTrackStart(e)}else e.detail.state==="track"?this._onTrack(e):e.detail.state==="end"&&this._onTrackEnd(e)}_onTrackStart(e){if(!this.columnReorderingAllowed)return;const i=e.composedPath&&e.composedPath();if(i&&i.filter(n=>n.hasAttribute&&n.hasAttribute("draggable"))[0])return;const r=this._cellFromPoint(e.detail.x,e.detail.y);if(r&&r.getAttribute("part").indexOf("header-cell")!==-1){for(this._toggleAttribute("reordering",!0,this),this._draggedColumn=r._column;this._draggedColumn.parentElement.childElementCount===1;)this._draggedColumn=this._draggedColumn.parentElement;this._setSiblingsReorderStatus(this._draggedColumn,"allowed"),this._draggedColumn._reorderStatus="dragging",this._updateGhost(r),this._reorderGhost.style.visibility="visible",this._updateGhostPosition(e.detail.x,this._touchDevice?e.detail.y-50:e.detail.y),this._autoScroller()}}_onTrack(e){if(!this._draggedColumn)return;const i=this._cellFromPoint(e.detail.x,e.detail.y);if(!i)return;const r=this._getTargetColumn(i,this._draggedColumn);this._isSwapAllowed(this._draggedColumn,r)&&this._isSwappableByPosition(r,e.detail.x)&&this._swapColumnOrders(this._draggedColumn,r),this._updateGhostPosition(e.detail.x,this._touchDevice?e.detail.y-50:e.detail.y),this._lastDragClientX=e.detail.x}_onTrackEnd(){this._draggedColumn&&(this._toggleAttribute("reordering",!1,this),this._draggedColumn._reorderStatus="",this._setSiblingsReorderStatus(this._draggedColumn,""),this._draggedColumn=null,this._lastDragClientX=null,this._reorderGhost.style.visibility="hidden",this.dispatchEvent(new CustomEvent("column-reorder",{detail:{columns:this._getColumnsInOrder()}})))}_getColumnsInOrder(){return this._columnTree.slice(0).pop().filter(e=>!e.hidden).sort((e,i)=>e._order-i._order)}_cellFromPoint(e,i){e=e||0,i=i||0,this._draggedColumn||this._toggleAttribute("no-content-pointer-events",!0,this.$.scroller);const r=this.shadowRoot.elementFromPoint(e,i);if(this._toggleAttribute("no-content-pointer-events",!1,this.$.scroller),r&&r._column)return r}_updateGhostPosition(e,i){const r=this._reorderGhost.getBoundingClientRect(),n=e-r.width/2,s=i-r.height/2,o=parseInt(this._reorderGhost._left||0),a=parseInt(this._reorderGhost._top||0);this._reorderGhost._left=o-(r.left-n),this._reorderGhost._top=a-(r.top-s),this._reorderGhost.style.transform=`translate(${this._reorderGhost._left}px, ${this._reorderGhost._top}px)`}_updateGhost(e){const i=this._reorderGhost;i.textContent=e._content.innerText;const r=window.getComputedStyle(e);return["boxSizing","display","width","height","background","alignItems","padding","border","flex-direction","overflow"].forEach(n=>i.style[n]=r[n]),i}_updateOrders(e,i){e!==void 0&&i!==void 0&&(e[0].forEach(r=>r._order=0),e[0].forEach((r,n)=>r._order=(n+1)*this._orderBaseScope))}_setSiblingsReorderStatus(e,i){Array.from(e.parentNode.children).filter(r=>/column/.test(r.localName)&&this._isSwapAllowed(r,e)).forEach(r=>r._reorderStatus=i)}_autoScroller(){if(this._lastDragClientX){const e=this._lastDragClientX-this.getBoundingClientRect().right+50,i=this.getBoundingClientRect().left-this._lastDragClientX+50;e>0?this.$.table.scrollLeft+=e/10:i>0&&(this.$.table.scrollLeft-=i/10),this._scrollHandler()}this._draggedColumn&&this.async(this._autoScroller,10)}_isSwapAllowed(e,i){if(e&&i){const r=e!==i,n=e.parentElement===i.parentElement,s=e.frozen===i.frozen;return r&&n&&s}}_isSwappableByPosition(e,i){const r=Array.from(this.$.header.querySelectorAll('tr:not([hidden]) [part~="cell"]')).filter(o=>e.contains(o._column))[0],n=this.$.header.querySelector("tr:not([hidden]) [reorder-status=dragging]").getBoundingClientRect(),s=r.getBoundingClientRect();return s.left>n.left?i>s.right-n.width:i<s.left+n.width}_swapColumnOrders(e,i){const r=e._order;e._order=i._order,i._order=r,this._updateLastFrozen(),this._updateFirstAndLastColumn()}_getTargetColumn(e,i){if(e&&i){let r=e._column;for(;r.parentElement!==i.parentElement&&r!==this;)r=r.parentElement;return r.parentElement===i.parentElement?r:e._column}}},Vge=t=>class extends t{static get properties(){return{resizable:{type:Boolean,value:function(){if(this.localName==="vaadin-grid-column-group")return;const e=this.parentNode;return e&&e.localName==="vaadin-grid-column-group"&&e.resizable||!1}},_headerTemplate:{type:Object},_footerTemplate:{type:Object},frozen:{type:Boolean,value:!1},hidden:{type:Boolean},header:{type:String},textAlign:{type:String},_lastFrozen:{type:Boolean,value:!1},_order:Number,_reorderStatus:Boolean,_emptyCells:Array,_headerCell:Object,_footerCell:Object,_grid:Object,headerRenderer:Function,footerRenderer:Function}}static get observers(){return["_widthChanged(width, _headerCell, _footerCell, _cells.*)","_frozenChanged(frozen, _headerCell, _footerCell, _cells.*)","_flexGrowChanged(flexGrow, _headerCell, _footerCell, _cells.*)","_pathOrHeaderChanged(path, header, _headerCell, _footerCell, _cells.*, renderer, headerRenderer, _bodyTemplate, _headerTemplate)","_textAlignChanged(textAlign, _cells.*, _headerCell, _footerCell)","_orderChanged(_order, _headerCell, _footerCell, _cells.*)","_lastFrozenChanged(_lastFrozen)","_setBodyTemplateOrRenderer(_bodyTemplate, renderer, _cells, _cells.*)","_setHeaderTemplateOrRenderer(_headerTemplate, headerRenderer, _headerCell)","_setFooterTemplateOrRenderer(_footerTemplate, footerRenderer, _footerCell)","_resizableChanged(resizable, _headerCell)","_reorderStatusChanged(_reorderStatus, _headerCell, _footerCell, _cells.*)","_hiddenChanged(hidden, _headerCell, _footerCell, _cells.*)"]}connectedCallback(){super.connectedCallback(),this._bodyTemplate&&(this._bodyTemplate.templatizer._grid=this._grid),this._headerTemplate&&(this._headerTemplate.templatizer._grid=this._grid),this._footerTemplate&&(this._footerTemplate.templatizer._grid=this._grid),this._templateObserver.flush(),this._bodyTemplate||this._templateObserver.callback(),requestAnimationFrame(()=>{this._allCells.forEach(e=>{e._content.parentNode||this._grid&&this._grid.appendChild(e._content)})})}disconnectedCallback(){super.disconnectedCallback(),requestAnimationFrame(()=>{this._findHostGrid()||this._allCells.forEach(e=>{e._content.parentNode&&e._content.parentNode.removeChild(e._content)})}),this._gridValue=void 0}_findHostGrid(){let e=this;for(;e&&!/^vaadin.*grid(-pro)?$/.test(e.localName);)e=e.assignedSlot?e.assignedSlot.parentNode:e.parentNode;return e||void 0}get _grid(){return this._gridValue||(this._gridValue=this._findHostGrid()),this._gridValue}get _allCells(){return[].concat(this._cells||[]).concat(this._emptyCells||[]).concat(this._headerCell).concat(this._footerCell).filter(e=>e)}constructor(){super(),this._templateObserver=new hp(this,()=>{this._headerTemplate=this._prepareHeaderTemplate(),this._footerTemplate=this._prepareFooterTemplate(),this._bodyTemplate=this._prepareBodyTemplate()})}_prepareHeaderTemplate(){return this._prepareTemplatizer(this._findTemplate(!0)||null,{})}_prepareFooterTemplate(){return this._prepareTemplatizer(this._findTemplate(!1,!0)||null,{})}_prepareBodyTemplate(){return this._prepareTemplatizer(this._findTemplate()||null)}_prepareTemplatizer(e,i){if(e&&!e.templatizer){const r=new sO;r._grid=this._grid,r.dataHost=this.dataHost,r._instanceProps=i||r._instanceProps,r.template=e,e.templatizer=r}return e}_renderHeaderAndFooter(){this.headerRenderer&&this._headerCell&&this.__runRenderer(this.headerRenderer,this._headerCell),this.footerRenderer&&this._footerCell&&this.__runRenderer(this.footerRenderer,this._footerCell)}__runRenderer(e,i,r){const n=[i._content,this];r&&r.item&&n.push(r),e.apply(this,n)}__setColumnTemplateOrRenderer(e,i,r){if(!this.hidden){if(e&&i)throw new Error("You should only use either a renderer or a template");r.forEach(n=>{const s=this._grid.__getRowModel(n.parentElement);if(i)n._renderer=i,(s.item||i===this.headerRenderer||i===this.footerRenderer)&&this.__runRenderer(i,n,s);else if(n._template!==e){n._template=e,n._content.innerHTML="",e.templatizer._grid=e.templatizer._grid||this._grid;const o=e.templatizer.createInstance();n._content.appendChild(o.root),n._instance=o,s.item&&n._instance.setProperties(s)}})}}_setBodyTemplateOrRenderer(e,i,r){(e||i)&&r&&this.__setColumnTemplateOrRenderer(e,i,r)}_setHeaderTemplateOrRenderer(e,i,r){(e||i)&&r&&this.__setColumnTemplateOrRenderer(e,i,[r])}_setFooterTemplateOrRenderer(e,i,r){(e||i)&&r&&(this.__setColumnTemplateOrRenderer(e,i,[r]),this._grid.__updateHeaderFooterRowVisibility(r.parentElement))}_selectFirstTemplate(e=!1,i=!1){return hp.getFlattenedNodes(this).filter(r=>r.localName==="template"&&r.classList.contains("header")===e&&r.classList.contains("footer")===i)[0]}_findTemplate(e,i){const r=this._selectFirstTemplate(e,i);return r&&this.dataHost&&(r._rootDataHost=this.dataHost._rootDataHost||this.dataHost),r}_flexGrowChanged(e){this.parentElement&&this.parentElement._columnPropChanged&&this.parentElement._columnPropChanged("flexGrow"),this._allCells.forEach(i=>i.style.flexGrow=e)}_orderChanged(e){this._allCells.forEach(i=>i.style.order=e)}_widthChanged(e){this.parentElement&&this.parentElement._columnPropChanged&&this.parentElement._columnPropChanged("width"),this._allCells.forEach(i=>i.style.width=e),this._grid&&this._grid.__forceReflow&&this._grid.__forceReflow()}_frozenChanged(e){this.parentElement&&this.parentElement._columnPropChanged&&this.parentElement._columnPropChanged("frozen",e),this._allCells.forEach(i=>this._toggleAttribute("frozen",e,i)),this._grid&&this._grid._frozenCellsChanged&&this._grid._frozenCellsChanged()}_lastFrozenChanged(e){this._allCells.forEach(i=>this._toggleAttribute("last-frozen",e,i)),this.parentElement&&this.parentElement._columnPropChanged&&(this.parentElement._lastFrozen=e)}_pathOrHeaderChanged(e,i,r,n,s,o,a,l,c){const u=i!==void 0;if(!a&&!c&&u&&r&&this.__setTextContent(r._content,i),e&&s.value){if(!o&&!l){const h=(f,m,{item:g})=>this.__setTextContent(f,this.get(e,g));this.__setColumnTemplateOrRenderer(void 0,h,s.value)}a||c||u||!r||i===null||this.__setTextContent(r._content,this._generateHeader(e))}r&&this._grid.__updateHeaderFooterRowVisibility(r.parentElement)}__setTextContent(e,i){e.textContent!==i&&(e.textContent=i)}_generateHeader(e){return e.substr(e.lastIndexOf(".")+1).replace(/([A-Z])/g,"-$1").toLowerCase().replace(/-/g," ").replace(/^./,i=>i.toUpperCase())}_toggleAttribute(e,i,r){r.hasAttribute(e)===!i&&(i?r.setAttribute(e,""):r.removeAttribute(e))}_reorderStatusChanged(e){this._allCells.forEach(i=>i.setAttribute("reorder-status",e))}_resizableChanged(e,i){e!==void 0&&i!==void 0&&i&&[i].concat(this._emptyCells).forEach(r=>{if(r){const n=r.querySelector('[part~="resize-handle"]');if(n&&r.removeChild(n),e){const s=document.createElement("div");s.setAttribute("part","resize-handle"),r.appendChild(s)}}})}_textAlignChanged(e){if(e===void 0)return;if(["start","end","center"].indexOf(e)===-1)return void console.warn('textAlign can only be set as "start", "end" or "center"');let i;getComputedStyle(this._grid).direction==="ltr"?e==="start"?i="left":e==="end"&&(i="right"):e==="start"?i="right":e==="end"&&(i="left"),this._allCells.forEach(r=>{r._content.style.textAlign=e,getComputedStyle(r._content).textAlign!==e&&(r._content.style.textAlign=i)})}_hiddenChanged(e){this.parentElement&&this.parentElement._columnPropChanged&&this.parentElement._columnPropChanged("hidden",e),!!e!=!!this._previousHidden&&this._grid&&(e===!0&&this._allCells.forEach(i=>{i._content.parentNode&&i._content.parentNode.removeChild(i._content)}),this._grid._debouncerHiddenChanged=Ur.debounce(this._grid._debouncerHiddenChanged,up,()=>{this._grid&&this._grid._renderColumnTree&&this._grid._renderColumnTree(this._grid._columnTree)}),this._grid._updateLastFrozen&&this._grid._updateLastFrozen(),this._grid.notifyResize&&this._grid.notifyResize(),this._grid._resetKeyboardNavigation&&this._grid._resetKeyboardNavigation()),this._previousHidden=e}};class oO extends Vge(jG(Pp)){static get is(){return"vaadin-grid-column"}static get properties(){return{width:{type:String,value:"100px"},flexGrow:{type:Number,value:1},renderer:Function,path:{type:String},autoWidth:{type:Boolean,value:!1},_bodyTemplate:{type:Object},_cells:Array}}}customElements.define(oO.is,oO),ET("vaadin-grid",CT`
    @keyframes vaadin-grid-appear {
      to {
        opacity: 1;
      }
    }

    :host {
      display: block;
      animation: 1ms vaadin-grid-appear;
      height: 400px;
      flex: 1 1 auto;
      align-self: stretch;
      position: relative;
    }

    :host([hidden]) {
      display: none !important;
    }

    #scroller {
      display: block;
      transform: translateY(0);
      width: auto;
      height: auto;
      position: absolute;
      top: 0;
      right: 0;
      bottom: 0;
      left: 0;
    }

    :host([height-by-rows]) {
      height: auto;
      align-self: flex-start;
      flex-grow: 0;
      width: 100%;
    }

    :host([height-by-rows]) #scroller {
      width: 100%;
      height: 100%;
      position: relative;
    }

    #table {
      display: flex;
      flex-direction: column;
      width: 100%;
      height: 100%;
      overflow: auto;
      position: relative;
      outline: none;
      /* Workaround for a Desktop Safari bug: new stacking context here prevents the scrollbar from getting hidden */
      z-index: 0;
    }

    #header,
    #footer {
      display: block;
      position: -webkit-sticky;
      position: sticky;
      left: 0;
      overflow: visible;
      width: 100%;
      z-index: 1;
    }

    #header {
      top: 0;
    }

    th {
      text-align: inherit;
    }

    /* Safari doesn't work with "inherit" */
    [safari] th {
      text-align: initial;
    }

    #footer {
      bottom: 0;
    }

    #items {
      flex-grow: 1;
      flex-shrink: 0;
      display: block;
      position: -webkit-sticky;
      position: sticky;
      width: 100%;
      left: 0;
      overflow: visible;
    }

    [part~='row'] {
      display: flex;
      width: 100%;
      box-sizing: border-box;
      margin: 0;
    }

    [part~='row'][loading] [part~='body-cell'] ::slotted(vaadin-grid-cell-content) {
      opacity: 0;
    }

    #items [part~='row'] {
      position: absolute;
    }

    #items [part~='row']:empty {
      height: 1em;
    }

    [part~='cell']:not([part~='details-cell']) {
      flex-shrink: 0;
      flex-grow: 1;
      box-sizing: border-box;
      display: flex;
      width: 100%;
      position: relative;
      align-items: center;
      padding: 0;
      white-space: nowrap;
    }

    [part~='details-cell'] {
      position: absolute;
      bottom: 0;
      width: 100%;
      box-sizing: border-box;
      padding: 0;
    }

    [part~='cell'] ::slotted(vaadin-grid-cell-content) {
      display: block;
      width: 100%;
      box-sizing: border-box;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    [hidden] {
      display: none !important;
    }

    [frozen] {
      z-index: 2;
      will-change: transform;
    }

    [no-scrollbars][safari] #table,
    [no-scrollbars][firefox] #table {
      overflow: hidden;
    }

    /* Reordering styles */
    :host([reordering]) [part~='cell'] ::slotted(vaadin-grid-cell-content),
    :host([reordering]) [part~='resize-handle'],
    #scroller[no-content-pointer-events] [part~='cell'] ::slotted(vaadin-grid-cell-content) {
      pointer-events: none;
    }

    [part~='reorder-ghost'] {
      visibility: hidden;
      position: fixed;
      pointer-events: none;
      opacity: 0.5;

      /* Prevent overflowing the grid in Firefox */
      top: 0;
      left: 0;
    }

    :host([reordering]) {
      -moz-user-select: none;
      -webkit-user-select: none;
      user-select: none;
    }

    /* Resizing styles */
    [part~='resize-handle'] {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
      cursor: col-resize;
      z-index: 1;
    }

    [part~='resize-handle']::before {
      position: absolute;
      content: '';
      height: 100%;
      width: 35px;
      transform: translateX(-50%);
    }

    [last-column] [part~='resize-handle']::before,
    [last-frozen] [part~='resize-handle']::before {
      width: 18px;
      transform: none;
      right: 0;
    }

    #scroller[column-resizing] {
      -ms-user-select: none;
      -moz-user-select: none;
      -webkit-user-select: none;
      user-select: none;
    }

    /* Sizer styles */
    #sizer {
      display: flex;
      position: absolute;
      visibility: hidden;
    }

    #sizer [part~='details-cell'] {
      display: none !important;
    }

    #sizer [part~='cell'][hidden] {
      display: none !important;
    }

    #sizer [part~='cell'] {
      display: block;
      flex-shrink: 0;
      line-height: 0;
      height: 0 !important;
      min-height: 0 !important;
      max-height: 0 !important;
      padding: 0 !important;
      border: none !important;
    }

    #sizer [part~='cell']::before {
      content: '-';
    }

    #sizer [part~='cell'] ::slotted(vaadin-grid-cell-content) {
      display: none !important;
    }

    /* RTL specific styles */

    :host([dir='rtl']) #items,
    :host([dir='rtl']) #header,
    :host([dir='rtl']) #footer {
      left: auto;
    }

    :host([dir='rtl']) [part~='reorder-ghost'] {
      left: auto;
      right: 0;
    }

    :host([dir='rtl']) [part~='resize-handle'] {
      left: 0;
      right: auto;
    }

    :host([dir='rtl']) [part~='resize-handle']::before {
      transform: translateX(50%);
    }

    :host([dir='rtl']) [last-column] [part~='resize-handle']::before,
    :host([dir='rtl']) [last-frozen] [part~='resize-handle']::before {
      left: 0;
      right: auto;
    }
  `,{moduleId:"vaadin-grid-styles"});const SYe=(()=>{try{return document.createEvent("TouchEvent"),!0}catch{return!1}})();class sQ extends lge(zG(dYe(cYe(hYe(aYe(gYe(yYe(vYe(mYe(wYe(oYe(fYe(xYe(uYe(pYe(bYe(_Ye(sYe)))))))))))))))))){static get template(){return VC`
      <div
        id="scroller"
        safari$="[[_safari]]"
        ios$="[[_ios]]"
        loading$="[[loading]]"
        column-reordering-allowed$="[[columnReorderingAllowed]]"
      >
        <table id="table" role="grid" aria-multiselectable="true" tabindex="0">
          <caption id="sizer" part="row"></caption>
          <thead id="header" role="rowgroup"></thead>
          <tbody id="items" role="rowgroup"></tbody>
          <tfoot id="footer" role="rowgroup"></tfoot>
        </table>

        <div part="reorder-ghost"></div>
      </div>

      <div id="focusexit" tabindex="0"></div>
    `}static get is(){return"vaadin-grid"}static get version(){return"6.0.2"}static get observers(){return["_columnTreeChanged(_columnTree, _columnTree.*)"]}static get properties(){return{_safari:{type:Boolean,value:/^((?!chrome|android).)*safari/i.test(navigator.userAgent)},_ios:{type:Boolean,value:/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1},_firefox:{type:Boolean,value:navigator.userAgent.toLowerCase().indexOf("firefox")>-1},_android:{type:Boolean,value:/android/i.test(navigator.userAgent)},_touchDevice:{type:Boolean,value:SYe},heightByRows:{type:Boolean,value:!1,reflectToAttribute:!0,observer:"_heightByRowsChanged"},_recalculateColumnWidthOnceLoadingFinished:{type:Boolean,value:!0}}}constructor(){super(),this.addEventListener("animationend",this._onAnimationEnd)}connectedCallback(){super.connectedCallback(),this.recalculateColumnWidths()}attributeChangedCallback(e,i,r){super.attributeChangedCallback(e,i,r),e==="dir"&&(this.__isRTL=r==="rtl",this._updateScrollerMeasurements())}__hasRowsWithClientHeight(){return!!Array.from(this.$.items.children).filter(e=>e.clientHeight).length}__itemsReceived(){this._recalculateColumnWidthOnceLoadingFinished&&!this._cache.isLoading()&&this.__hasRowsWithClientHeight()&&(this._recalculateColumnWidthOnceLoadingFinished=!1,this.recalculateColumnWidths())}_recalculateColumnWidths(e){e.forEach(i=>{i.width="auto",i._origFlexGrow=i.flexGrow,i.flexGrow=0}),e.forEach(i=>{i._currentWidth=0,i._allCells.forEach(r=>{const n=r.offsetWidth+1;i._currentWidth=Math.max(i._currentWidth,n)})}),e.forEach(i=>{i.width=`${i._currentWidth}px`,i.flexGrow=i._origFlexGrow,i._currentWidth=void 0,i._origFlexGrow=void 0})}recalculateColumnWidths(){if(this._columnTree)if(this._cache.isLoading())this._recalculateColumnWidthOnceLoadingFinished=!0;else{const e=this._getColumns().filter(i=>!i.hidden&&i.autoWidth);this._recalculateColumnWidths(e)}}_createScrollerRows(e){const i=[];for(let r=0;r<e;r++){const n=document.createElement("tr");n.setAttribute("part","row"),n.setAttribute("role","row"),this._columnTree&&this._updateRow(n,this._columnTree[this._columnTree.length-1],"body",!1,!0),i.push(n)}return this._columnTree&&this._columnTree[this._columnTree.length-1].forEach(r=>r.isConnected&&r.notifyPath&&r.notifyPath("_cells.*",r._cells)),VJe(this,()=>{this._updateFirstAndLastColumn(),this._resetKeyboardNavigation()}),i}_getRowTarget(){return this.$.items}_createCell(e){const i="vaadin-grid-cell-content-"+(this._contentIndex=this._contentIndex+1||0),r=document.createElement("vaadin-grid-cell-content");r.setAttribute("slot",i);const n=document.createElement(e);n.id=i.replace("-content-","-"),n.setAttribute("tabindex","-1"),n.setAttribute("role",e==="td"?"gridcell":"columnheader");const s=document.createElement("slot");return s.setAttribute("name",i),n.appendChild(s),n._content=r,r.addEventListener("mousedown",()=>{if(window.chrome){const o=()=>{r.contains(this.getRootNode().activeElement)||n.focus(),document.removeEventListener("mouseup",o,!0)};document.addEventListener("mouseup",o,!0)}else setTimeout(()=>{r.contains(this.getRootNode().activeElement)||n.focus()})}),n}_updateRow(e,i,r,n,s){r=r||"body";const o=document.createDocumentFragment();Array.from(e.children).forEach(a=>a._vacant=!0),e.innerHTML="",e.id!=="sizer"&&(e.hidden=!0),i.filter(a=>!a.hidden).forEach((a,l,c)=>{let u;if(r==="body"){if(a._cells=a._cells||[],u=a._cells.filter(h=>h._vacant)[0],u||(u=this._createCell("td"),a._cells.push(u)),u.setAttribute("part","cell body-cell"),e.appendChild(u),l===c.length-1&&(this._rowDetailsTemplate||this.rowDetailsRenderer)){this._detailsCells=this._detailsCells||[];const h=this._detailsCells.filter(f=>f._vacant)[0]||this._createCell("td");this._detailsCells.indexOf(h)===-1&&this._detailsCells.push(h),h._content.parentElement||o.appendChild(h._content),this._configureDetailsCell(h),e.appendChild(h),this._a11ySetRowDetailsCell(e,h),h._vacant=!1}a.notifyPath&&!s&&a.notifyPath("_cells.*",a._cells)}else{const h=r==="header"?"th":"td";n||a.localName==="vaadin-grid-column-group"?(u=a[`_${r}Cell`]||this._createCell(h),u._column=a,e.appendChild(u),a[`_${r}Cell`]=u):(a._emptyCells=a._emptyCells||[],u=a._emptyCells.filter(f=>f._vacant)[0]||this._createCell(h),u._column=a,e.appendChild(u),a._emptyCells.indexOf(u)===-1&&a._emptyCells.push(u)),u.setAttribute("part",`cell ${r}-cell`),this.__updateHeaderFooterRowVisibility(e)}u._content.parentElement||o.appendChild(u._content),u._vacant=!1,u._column=a}),this.appendChild(o),this._frozenCellsChanged(),this._updateFirstAndLastColumnForRow(e)}__updateHeaderFooterRowVisibility(e){if(!e)return;const i=Array.from(e.children).filter(r=>{const n=r._column;if(n._emptyCells&&n._emptyCells.indexOf(r)>-1)return!1;if(e.parentElement===this.$.header){if(n.headerRenderer||n._headerTemplate)return!0;if(n.header===null)return!1;if(n.path||n.header!==void 0)return!0}else if(n.footerRenderer||n._footerTemplate)return!0});e.hidden!==!i.length&&(e.hidden=!i.length,this.notifyResize())}_updateScrollerItem(e,i){this._preventScrollerRotatingCellFocus(e,i),this._columnTree&&(this._toggleAttribute("first",i===0,e),this._toggleAttribute("odd",i%2,e),this._a11yUpdateRowRowindex(e,i),this._getItem(i,e))}_columnTreeChanged(e){this._renderColumnTree(e),this.recalculateColumnWidths()}_renderColumnTree(e){for(Array.from(this.$.items.children).forEach(i=>this._updateRow(i,e[e.length-1],null,!1,!0));this.$.header.children.length<e.length;){const i=document.createElement("tr");i.setAttribute("part","row"),i.setAttribute("role","row"),this.$.header.appendChild(i);const r=document.createElement("tr");r.setAttribute("part","row"),r.setAttribute("role","row"),this.$.footer.appendChild(r)}for(;this.$.header.children.length>e.length;)this.$.header.removeChild(this.$.header.firstElementChild),this.$.footer.removeChild(this.$.footer.firstElementChild);Array.from(this.$.header.children).forEach((i,r)=>this._updateRow(i,e[r],"header",r===e.length-1)),Array.from(this.$.footer.children).forEach((i,r)=>this._updateRow(i,e[e.length-1-r],"footer",r===0)),this._updateRow(this.$.sizer,e[e.length-1]),this._resizeHandler(),this._frozenCellsChanged(),this._updateFirstAndLastColumn(),this._resetKeyboardNavigation(),this._a11yUpdateHeaderRows(),this._a11yUpdateFooterRows(),this.__updateFooterPositioning()}__updateFooterPositioning(){this._firefox&&(this.$.items.style.paddingBottom=0,this.heightByRows||(this.$.items.style.paddingBottom=`${this.$.footer.offsetHeight}px`)),this._ios&&!window.CSS.supports("position","sticky")&&(this.$.table.style.height="",this.$.table.style.minHeight="100%",this.$.table.style.maxHeight="100%",setTimeout(()=>this.$.table.style.height=`${this.$.scroller.offsetHeight}px`))}_updateItem(e,i){e._item=i;const r=this.__getRowModel(e);this._toggleAttribute("selected",r.selected,e),this._a11yUpdateRowSelected(e,r.selected),this._a11yUpdateRowLevel(e,r.level),this._toggleAttribute("expanded",r.expanded,e),this._toggleAttribute("details-opened",this._isDetailsOpened(i),e),(this._rowDetailsTemplate||this.rowDetailsRenderer)&&this._toggleDetailsCell(e,i),this._generateCellClassNames(e,r),this._filterDragAndDrop(e,r),Array.from(e.children).forEach(n=>{if(n._renderer){const s=n._column||this;n._renderer.call(s,n._content,s,r)}else n._instance&&(n._instance.__detailsOpened__=r.detailsOpened,n._instance.__selected__=r.selected,n._instance.__level__=r.level,n._instance.__expanded__=r.expanded,n._instance.setProperties(r))}),this._debouncerUpdateHeights=Ur.debounce(this._debouncerUpdateHeights,bu.after(1),()=>{this._updateMetrics(),this._positionItems(),this._updateScrollerSize()})}_resizeHandler(){this._updateDetailsCellHeights(),this._accessIronListAPI(super._resizeHandler,!0),this._updateScrollerMeasurements(),this.__updateFooterPositioning()}_onAnimationEnd(e){e.animationName.indexOf("vaadin-grid-appear")===0&&(this._render(),e.stopPropagation(),this.notifyResize(),this.__itemsReceived(),requestAnimationFrame(()=>{this.__scrollToPendingIndex(),this.$.table.style.webkitOverflowScrolling="touch"}))}_toggleAttribute(e,i,r){r.hasAttribute(e)===!i&&(i?r.setAttribute(e,""):r.removeAttribute(e))}__getRowModel(e){return{index:e.index,item:e._item,level:this._getIndexLevel(e.index),expanded:this._isExpanded(e._item),selected:this._isSelected(e._item),detailsOpened:!(!this._rowDetailsTemplate&&!this.rowDetailsRenderer)&&this._isDetailsOpened(e._item)}}render(){this._columnTree&&(this._columnTree.forEach(e=>{e.forEach(i=>i._renderHeaderAndFooter())}),this._update())}notifyResize(){super.notifyResize()}_heightByRowsChanged(e,i){(e||i)&&this.notifyResize()}__forceReflow(){this._debouncerForceReflow=Ur.debounce(this._debouncerForceReflow,up,()=>{this.$.scroller.style.overflow="hidden",setTimeout(()=>this.$.scroller.style.overflow="")})}}customElements.define(sQ.is,sQ);class oQ extends Vge(Pp){static get is(){return"vaadin-grid-column-group"}static get properties(){return{_childColumns:{value:function(){return this._getChildColumns(this)}},flexGrow:{type:Number,readOnly:!0},width:{type:String,readOnly:!0},_visibleChildColumns:Array,_colSpan:Number,_rootColumns:Array}}static get observers(){return["_updateVisibleChildColumns(_childColumns)","_childColumnsChanged(_childColumns)","_groupFrozenChanged(frozen, _rootColumns)","_groupHiddenChanged(hidden, _rootColumns)","_visibleChildColumnsChanged(_visibleChildColumns)","_colSpanChanged(_colSpan, _headerCell, _footerCell)","_groupOrderChanged(_order, _rootColumns)","_groupReorderStatusChanged(_reorderStatus, _rootColumns)","_groupResizableChanged(resizable, _rootColumns)"]}connectedCallback(){super.connectedCallback(),this._addNodeObserver(),this._updateFlexAndWidth()}disconnectedCallback(){super.disconnectedCallback(),this._observer&&this._observer.disconnect()}_columnPropChanged(e,i){e==="hidden"&&(this._preventHiddenCascade=!0,this._updateVisibleChildColumns(this._childColumns),this._preventHiddenCascade=!1),/flexGrow|width|hidden|_childColumns/.test(e)&&this._updateFlexAndWidth(),e==="frozen"&&(this.frozen=this.frozen||i),e==="lastFrozen"&&(this._lastFrozen=this._lastFrozen||i)}_groupOrderChanged(e,i){if(i){const r=i.slice(0);if(!e)return void r.forEach(a=>a._order=0);const n=/(0+)$/.exec(e).pop().length,s=1+~~(Math.log(i.length)/Math.log(Math.LN10)),o=Math.pow(10,n-s);r[0]&&r[0]._order&&r.sort((a,l)=>a._order-l._order),r.forEach((a,l)=>a._order=e+(l+1)*o)}}_groupReorderStatusChanged(e,i){e!==void 0&&i!==void 0&&i.forEach(r=>r._reorderStatus=e)}_groupResizableChanged(e,i){e!==void 0&&i!==void 0&&i.forEach(r=>r.resizable=e)}_updateVisibleChildColumns(e){this._visibleChildColumns=Array.prototype.filter.call(e,i=>!i.hidden)}_childColumnsChanged(e){!this._autoHidden&&this.hidden&&(Array.prototype.forEach.call(e,i=>i.hidden=!0),this._updateVisibleChildColumns(e))}_updateFlexAndWidth(){this._visibleChildColumns&&(this._visibleChildColumns.length?this._setWidth("calc("+Array.prototype.reduce.call(this._visibleChildColumns,(e,i)=>e+" + "+(i.width||"0px").replace("calc",""),"").substring(3)+")"):this._setWidth("0px"),this._setFlexGrow(Array.prototype.reduce.call(this._visibleChildColumns,(e,i)=>e+i.flexGrow,0)))}_groupFrozenChanged(e,i){i!==void 0&&e!==void 0&&e!==!1&&Array.from(i).forEach(r=>r.frozen=e)}_groupHiddenChanged(e,i){i&&!this._preventHiddenCascade&&(this._ignoreVisibleChildColumns=!0,i.forEach(r=>r.hidden=e),this._ignoreVisibleChildColumns=!1),this._columnPropChanged("hidden")}_visibleChildColumnsChanged(e){this._colSpan=e.length,this._ignoreVisibleChildColumns||(e.length===0?this._autoHidden=this.hidden=!0:this.hidden&&this._autoHidden&&(this._autoHidden=this.hidden=!1))}_colSpanChanged(e,i,r){i&&(i.setAttribute("colspan",e),this._grid&&this._grid._a11yUpdateCellColspan(i,e)),r&&(r.setAttribute("colspan",e),this._grid&&this._grid._a11yUpdateCellColspan(r,e))}_getChildColumns(e){return hp.getFlattenedNodes(e).filter(this._isColumnElement)}_addNodeObserver(){this._observer=new hp(this,e=>{(e.addedNodes.filter(this._isColumnElement).length>0||e.removedNodes.filter(this._isColumnElement).length>0)&&(this._preventHiddenCascade=!0,this._rootColumns=this._getChildColumns(this),this._childColumns=this._rootColumns,this._preventHiddenCascade=!1,nc.run(()=>{this._grid&&this._grid._updateColumnTree&&this._grid._updateColumnTree()}))}),this._observer.flush()}_isColumnElement(e){return e.nodeType===Node.ELEMENT_NODE&&/\bcolumn\b/.test(e.localName)}}customElements.define(oQ.is,oQ);class aQ extends oO{static get template(){return VC`
      <template class="header" id="defaultHeaderTemplate">
        <vaadin-checkbox
          class="vaadin-grid-select-all-checkbox"
          aria-label="Select All"
          hidden$="[[_selectAllHidden]]"
          on-checked-changed="_onSelectAllCheckedChanged"
          checked="[[_isChecked(selectAll, _indeterminate)]]"
          indeterminate="[[_indeterminate]]"
        ></vaadin-checkbox>
      </template>
      <template id="defaultBodyTemplate">
        <vaadin-checkbox aria-label="Select Row" checked="{{selected}}"></vaadin-checkbox>
      </template>
    `}static get is(){return"vaadin-grid-selection-column"}static get properties(){return{width:{type:String,value:"58px"},flexGrow:{type:Number,value:0},selectAll:{type:Boolean,value:!1,notify:!0},autoSelect:{type:Boolean,value:!1},_indeterminate:Boolean,_previousActiveItem:Object,_selectAllHidden:Boolean}}static get observers(){return["_onSelectAllChanged(selectAll)"]}_pathOrHeaderChanged(e,i,r,n,s,o,a,l,c){!s.value||e===void 0&&o===void 0||(this._bodyTemplate=l=void 0,this.__cleanCellsOfTemplateProperties(s.value)),!r||i===void 0&&a===void 0||(this._headerTemplate=c=void 0,this.__cleanCellsOfTemplateProperties([r])),super._pathOrHeaderChanged(e,i,r,n,s,o,a,l,c)}__cleanCellsOfTemplateProperties(e){e.forEach(i=>{i._content.innerHTML="",delete i._instance,delete i._template})}_prepareHeaderTemplate(){const e=this._prepareTemplatizer(this._findTemplate(!0)||this.$.defaultHeaderTemplate);return e.templatizer.dataHost=e===this.$.defaultHeaderTemplate?this:this.dataHost,e}_prepareBodyTemplate(){const e=this._prepareTemplatizer(this._findTemplate()||this.$.defaultBodyTemplate);return e.templatizer.dataHost=e===this.$.defaultBodyTemplate?this:this.dataHost,e}constructor(){super(),this._boundOnActiveItemChanged=this._onActiveItemChanged.bind(this),this._boundOnDataProviderChanged=this._onDataProviderChanged.bind(this),this._boundOnSelectedItemsChanged=this._onSelectedItemsChanged.bind(this)}disconnectedCallback(){this._grid.removeEventListener("active-item-changed",this._boundOnActiveItemChanged),this._grid.removeEventListener("data-provider-changed",this._boundOnDataProviderChanged),this._grid.removeEventListener("filter-changed",this._boundOnSelectedItemsChanged),this._grid.removeEventListener("selected-items-changed",this._boundOnSelectedItemsChanged),super.disconnectedCallback()}connectedCallback(){super.connectedCallback(),this._grid&&(this._grid.addEventListener("active-item-changed",this._boundOnActiveItemChanged),this._grid.addEventListener("data-provider-changed",this._boundOnDataProviderChanged),this._grid.addEventListener("filter-changed",this._boundOnSelectedItemsChanged),this._grid.addEventListener("selected-items-changed",this._boundOnSelectedItemsChanged))}_onSelectAllChanged(e){e!==void 0&&this._grid&&(this._selectAllChangeLock||(this._grid.selectedItems=e&&Array.isArray(this._grid.items)?this._grid._filter(this._grid.items):[]))}_arrayContains(e,i){for(var r=0;e&&i&&i[r]&&e.indexOf(i[r])>=0;r++);return r==i.length}_onSelectAllCheckedChanged(e){this.selectAll=this._indeterminate||e.target.checked}_isChecked(e,i){return i||e}_onActiveItemChanged(e){const i=e.detail.value;if(this.autoSelect){const r=i||this._previousActiveItem;r&&this._grid._toggleItem(r)}this._previousActiveItem=i}_onSelectedItemsChanged(){this._selectAllChangeLock=!0,Array.isArray(this._grid.items)&&(this._grid.selectedItems.length?this._arrayContains(this._grid.selectedItems,this._grid._filter(this._grid.items))?(this.selectAll=!0,this._indeterminate=!1):(this.selectAll=!1,this._indeterminate=!0):(this.selectAll=!1,this._indeterminate=!1)),this._selectAllChangeLock=!1}_onDataProviderChanged(){this._selectAllHidden=!Array.isArray(this._grid.items)}}customElements.define(aQ.is,aQ),ET("vaadin-grid-sorter",CT`
    :host {
      justify-content: flex-start;
      align-items: baseline;
      -webkit-user-select: none;
      -moz-user-select: none;
      user-select: none;
    }

    [part='content'] {
      display: inline-block;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    [part='indicators'] {
      margin-left: var(--lumo-space-s);
    }

    :host(:not([direction])) [part='indicators']::before {
      opacity: 0.2;
    }

    :host([direction]) {
      color: var(--lumo-primary-text-color);
    }

    [part='order'] {
      font-size: var(--lumo-font-size-xxs);
      line-height: 1;
    }

    /* RTL specific styles */

    :host([dir='rtl']) [part='indicators'] {
      margin-right: var(--lumo-space-s);
      margin-left: 0;
    }
  `,{moduleId:"lumo-grid-sorter"});const lQ=document.createElement("template");lQ.innerHTML=`
  <style>
    @font-face {
      font-family: 'vaadin-grid-sorter-icons';
      src: url(data:application/font-woff;charset=utf-8;base64,d09GRgABAAAAAAQwAA0AAAAABuwAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABGRlRNAAAEFAAAABkAAAAcfep+mUdERUYAAAP4AAAAHAAAAB4AJwAOT1MvMgAAAZgAAAA/AAAAYA8TBPpjbWFwAAAB7AAAAFUAAAFeF1fZ4mdhc3AAAAPwAAAACAAAAAgAAAAQZ2x5ZgAAAlgAAABcAAAAnMvguMloZWFkAAABMAAAAC8AAAA2C5Ap72hoZWEAAAFgAAAAHQAAACQGbQPHaG10eAAAAdgAAAAUAAAAHAoAAABsb2NhAAACRAAAABIAAAASAIwAYG1heHAAAAGAAAAAFgAAACAACwAKbmFtZQAAArQAAAECAAACZxWCgKhwb3N0AAADuAAAADUAAABZCrApUXicY2BkYGAA4rDECVrx/DZfGbhZGEDgyqNPOxH0/wNMq5kPALkcDEwgUQBWRA0dAHicY2BkYGA+8P8AAwMLAwgwrWZgZEAFbABY4QM8AAAAeJxjYGRgYOAAQiYGEICQSAAAAi8AFgAAeJxjYGY6yziBgZWBgWkm0xkGBoZ+CM34msGYkZMBFTAKoAkwODAwvmRiPvD/AIMDMxCD1CDJKjAwAgBktQsXAHicY2GAAMZQCM0EwqshbAALxAEKeJxjYGBgZoBgGQZGBhCIAPIYwXwWBhsgzcXAwcAEhIwMCi+Z/v/9/x+sSuElA4T9/4k4K1gHFwMMMILMY2QDYmaoABOQYGJABUA7WBiGNwAAJd4NIQAAAAAAAAAACAAIABAAGAAmAEAATgAAeJyNjLENgDAMBP9tIURJwQCMQccSZgk2i5fIYBDAidJjycXr7x5EPwE2wY8si7jmyBNXGo/bNBerxJNrpxhbO3/fEFpx8ZICpV+ghxJ74fAMe+h7Ox14AbrsHB14nK2QQWrDMBRER4mTkhQK3ZRQKOgCNk7oGQqhhEIX2WSlWEI1BAlkJ5CDdNsj5Ey9Rncdi38ES+jzNJo/HwTgATcoDEthhY3wBHc4CE+pfwsX5F/hGe7Vo/AcK/UhvMSz+mGXKhZU6pww8ISz3oWn1BvhgnwTnuEJf8Jz1OpFeIlX9YULDLdFi4ASHolkSR0iuYdjLak1vAequBhj21D61Nqyi6l3qWybGPjySbPHGScGJl6dP58MYcQRI0bts7mjebBqrFENH7t3qWtj0OuqHnXcW7b0HOTZFnKryRGW2hFX1m0O2vEM3opNMfTau+CS6Z3Vx6veNnEXY6jwDxhsc2gAAHicY2BiwA84GBgYmRiYGJkZmBlZGFkZ2djScyoLMgzZS/MyDQwMwLSrpYEBlIbxjQDrzgsuAAAAAAEAAf//AA94nGNgZGBg4AFiMSBmYmAEQnYgZgHzGAAD6wA2eJxjYGBgZACCKyoz1cD0o087YTQATOcIewAAAA==) format('woff');
      font-weight: normal;
      font-style: normal;
    }
  </style>
`,document.head.appendChild(lQ.content);class cQ extends zG(jG(Pp)){static get template(){return VC`
      <style>
        :host {
          display: inline-flex;
          cursor: pointer;
          max-width: 100%;
        }

        [part='content'] {
          flex: 1 1 auto;
        }

        [part='indicators'] {
          position: relative;
          align-self: center;
          flex: none;
        }

        [part='order'] {
          display: inline;
          vertical-align: super;
        }

        [part='indicators']::before {
          font-family: 'vaadin-grid-sorter-icons';
          display: inline-block;
        }

        :host(:not([direction])) [part='indicators']::before {
          content: '\\e901';
        }

        :host([direction='asc']) [part='indicators']::before {
          content: '\\e900';
        }

        :host([direction='desc']) [part='indicators']::before {
          content: '\\e902';
        }
      </style>

      <div part="content">
        <slot></slot>
      </div>
      <div part="indicators">
        <span part="order">[[_getDisplayOrder(_order)]]</span>
      </div>
    `}static get is(){return"vaadin-grid-sorter"}static get properties(){return{path:String,direction:{type:String,reflectToAttribute:!0,notify:!0,value:null},_order:{type:Number,value:null},_isConnected:{type:Boolean,observer:"__isConnectedChanged"}}}static get observers(){return["_pathOrDirectionChanged(path, direction)"]}ready(){super.ready(),this.addEventListener("click",this._onClick.bind(this))}connectedCallback(){super.connectedCallback(),this._isConnected=!0}disconnectedCallback(){super.disconnectedCallback(),this._isConnected=!1}_pathOrDirectionChanged(){this.__dispatchSorterChangedEvenIfPossible()}__isConnectedChanged(e,i){i!==!1&&this.__dispatchSorterChangedEvenIfPossible()}__dispatchSorterChangedEvenIfPossible(){this.path!==void 0&&this.direction!==void 0&&this._isConnected&&this.dispatchEvent(new CustomEvent("sorter-changed",{bubbles:!0,composed:!0}))}_getDisplayOrder(e){return e===null?"":e+1}_onClick(e){const i=this.getRootNode().activeElement;this!==i&&this.contains(i)||(e.preventDefault(),this.direction==="asc"?this.direction="desc":this.direction==="desc"?this.direction=null:this.direction="asc")}}customElements.define(cQ.is,cQ);class uQ extends oO{static get template(){return VC`
      <template class="header" id="headerTemplate">
        <vaadin-grid-sorter path="[[path]]" direction="{{direction}}">[[_getHeader(header, path)]]</vaadin-grid-sorter>
      </template>
    `}static get is(){return"vaadin-grid-sort-column"}static get properties(){return{path:String,direction:{type:String,notify:!0}}}_prepareHeaderTemplate(){const e=this._prepareTemplatizer(this.$.headerTemplate);return e.templatizer.dataHost=this,e}_getHeader(e,i){return e||this._generateHeader(i)}}customElements.define(uQ.is,uQ);const dQ={selectionColumn:!0,columnMenus:!0},TM="esri-grid",IYe="compact column-borders",Wx={base:TM,content:`${TM}__content`,grid:`${TM}__grid`,noColumnMenu:`${TM}--no-column-menu`,widget:"esri-widget"};let Vr=class extends cn(di){constructor(t,e){super(t,e),this._grid=null,this._columnElements=[],this._isDataLoaded=!1,this.itemIdPath=null,this.messages=null,this.viewModel=new Tme,this.visibleElements={...dQ}}initialize(){this.handles.add([this.columns.on("change",()=>this.onColumnChange()),J(()=>{var t;return(t=this.viewModel)==null?void 0:t.size},()=>this._updateGridSize()),J(()=>{var t;return(t=this.store)==null?void 0:t.state},(t,e)=>{t!=="ready"||e!=="loaded"&&e!=="error"||this.refreshPageCache()}),ui(()=>this.highlightIds,"change",t=>{const{added:e,removed:i}=t,r=e.map(s=>{var o;return((o=this.store)==null?void 0:o.getLocalItemByKey(s))||{objectId:s}}),n=i.map(s=>{var o;return((o=this.store)==null?void 0:o.getLocalItemByKey(s))||{objectId:s}});this._deselectRows(n),this._selectRows(r)}),ui(()=>{var t,e;return(e=(t=this._grid)==null?void 0:t.$)==null?void 0:e.table},"scroll",()=>{var t;return(t=this.viewModel)==null?void 0:t.closeColumnMenus()})])}destroy(){var t;this.handles.removeAll(),this.resetColumns(),(t=this.columns)==null||t.destroy()}resetColumns(){this.columns.items.forEach(t=>t.destroy()),this.columns.removeAll()}get cellClassNameGenerator(){return this.viewModel.cellClassNameGenerator}set cellClassNameGenerator(t){this.viewModel.cellClassNameGenerator=t}get columns(){return this.viewModel.columns}set columns(t){this.viewModel.columns=t}get columnReorderingEnabled(){return this.viewModel.columnReorderingEnabled}set columnReorderingEnabled(t){this.viewModel.columnReorderingEnabled=t}get dataProvider(){return this.viewModel.dataProvider}set dataProvider(t){this.viewModel.dataProvider=t}get highlightIds(){return this.viewModel.highlightIds}set highlightIds(t){this.viewModel.highlightIds=t}get label(){var t;return((t=this.messages)==null?void 0:t.widgetLabel)??""}set label(t){this._overrideIfSome("label",t)}get multiSortEnabled(){return this.viewModel.multiSortEnabled}set multiSortEnabled(t){this.viewModel.multiSortEnabled=t}get pageSize(){return this.viewModel.pageSize}set pageSize(t){this.viewModel.pageSize=t}get rowDetailsRenderer(){return this.viewModel.rowDetailsRenderer}set rowDetailsRenderer(t){this.viewModel.rowDetailsRenderer=t}get size(){return this.viewModel.size}get sortOrders(){var t;return(t=this._grid)!=null&&t._sorters?this._grid._sorters.filter(e=>!!e).map(({direction:e,path:i})=>({direction:e,path:i})):[]}get store(){return this.viewModel.store}set store(t){this.viewModel.store=t}castVisibleElements(t){return{...dQ,...t}}render(){const{columnMenus:t}=this.visibleElements;return M("div",{bind:this,class:this.classes(Wx.base,Wx.widget,{[Wx.noColumnMenu]:!t})},M("div",{bind:this,class:Wx.content},this.renderGrid()))}renderGrid(){return M("vaadin-grid",{_safari:!1,afterCreate:this._afterGridCreate,afterUpdate:this._afterGridUpdate,bind:this,cellClassNameGenerator:this.cellClassNameGenerator,class:Wx.grid,columnReorderingAllowed:this.columnReorderingEnabled,dataProvider:this.dataProvider,id:`${this.id}_grid`,itemIdPath:this.itemIdPath,multiSort:this.multiSortEnabled,pageSize:this.pageSize,ref:"grid",rowDetailsRenderer:this.rowDetailsRenderer,size:this.size},this.renderAllColumns())}renderAllColumns(){var t;return this.viewModel.state!=="disabled"&&((t=this.columns)!=null&&t.length)?[this.renderSelectionColumn(),this.renderColumns()]:null}renderSelectionColumn(){return M("vaadin-grid-selection-column",{_selectAllHidden:!0,selectAll:!1,bind:this,hidden:!this.visibleElements.selectionColumn,sortable:!1,frozen:!ll(this.container)})}renderColumns(){return this.columns.items.map((t,e)=>"columns"in t?this.renderGroupColumn(t,e):M("vaadin-grid-column",{...this.getColumnProps(t,e)})).filter(Dt)}renderGroupColumn(t,e){const i=this.getColumnProps(t,e);if(i.hidden||!t.columns)return null;const r=t.columns.filter(({hidden:n})=>!n);return r.length?M("vaadin-grid-column-group",{...i},r.map(n=>M("vaadin-grid-column",{...this.getColumnProps(n,e)}))):null}getColumnProps(t,e){const{id:i}=this,{autoWidth:r,direction:n,flexGrow:s,frozen:o,header:a,hidden:l,path:c,resizable:u,textAlign:h,width:f}=t;return{autoWidth:r,direction:n,flexGrow:s,frozen:o,header:a,hidden:l,key:`${i}_${a}_${e??c}`,path:c,resizable:u,"text-align":h,width:typeof f=="number"?`${f}px`:f,bind:this,afterCreate:this._afterColumnCreate,afterRemoved:this._afterColumnRemoved}}clearSelection(){this._clearSelection(),this.scheduleRender()}clearSort(){var e,i;let t=!1;this._grid&&((e=this._grid._sorters)!=null&&e.length&&(this._grid._sorters.forEach(r=>{r._order=null,r.direction=null}),t=!0),(i=this.columns)!=null&&i.length&&this.columns.some(r=>!!r.direction)&&(this.columns.forEach(r=>r.direction=null),t=!0),t&&(this.notifyChange("sortOrders"),this.scheduleRender()))}findColumn(t){this.viewModel.findColumn(t)}generateCellClassNames(){var t;(t=this._grid)==null||t.generateCellClassNames()}getSlotElementByName(t){var e,i;return((i=(e=this._grid)==null?void 0:e.shadowRoot)==null?void 0:i.querySelector(`slot[name='${t}']`))??null}hideColumn(t){var e;(e=this.viewModel)==null||e.hideColumn(t),this.scheduleRender()}notifyResize(){var t;(t=this._grid)==null||t.notifyResize()}recalculateColumnWidths(){var t;(t=this._grid)==null||t.recalculateColumnWidths()}async reset(){var t;this._isDataLoaded=!1,this._clearSelection(),await((t=this.store)==null?void 0:t.reset()),this.scrollToTop()}refreshPageCache(){var t;(t=this._grid)==null||t.clearCache()}selectRows(t){const e=t==null?void 0:t.filter(r=>!this.highlightIds.includes(r.objectId)),i=e.map(r=>r.objectId);i.length&&(this.highlightIds.addMany(i),this._selectRows(e))}deselectRows(t){const e=(t==null?void 0:t.map(i=>i.objectId))||[];e.length&&(this.highlightIds.removeMany(e),this._deselectRows(t))}showColumn(t){var e;(e=this.viewModel)==null||e.showColumn(t),this.scheduleRender()}sort({path:t,direction:e}){var i;(i=this.viewModel)==null||i.sortColumn(t,e),this.notifyChange("sortOrders")}scrollToIndex(t){var e;(e=this._grid)==null||e.scrollToIndex(t)}scrollToTop(){var t;(t=this._grid)==null||t.scrollToIndex(0)}isEditingActive(){return!!this._getActiveEditInfo().length}onColumnChange(){this._syncColumnRenderers()}_afterGridCreate(t){const e=this._grid=t;e.setAttribute("theme",IYe),customElements.whenDefined("vaadin-grid").then(()=>this._addGridEventListeners()),e.__updateSorter=i=>{const r=e._sorters,n=!r.includes(i);if(i.direction||!n){if(i._order=null,e.multiSort)e._removeArrayItem(r,i),i.direction&&(i._initialOrder!=null?(n?r[i._initialOrder]=i:r.splice(i._initialOrder,0,i),i._initialOrder=null):r.unshift(i)),e.__updateSortOrders();else if(i.direction){const s=r.filter(o=>o!==i);e._sorters=[i],s.forEach(o=>{o._order=null,o.direction=null})}}}}_afterGridUpdate(t){this._grid||(this._grid=t)}_afterColumnCreate(t){this._applyRenderersToColumnElement(t),this._columnElements.push(t)}_afterColumnRemoved(t){const e=this._columnElements.indexOf(t,0);e>-1&&this._columnElements.splice(e,1)}_syncColumnRenderers(){this._columnElements.forEach(t=>{this._applyRenderersToColumnElement(t)})}_updateGridSize(){this._grid&&(this._grid.size=this.size||0,this.scheduleRender())}_getActiveEditInfo(){return!this.columns||this.columns.length?[]:this.columns.filter(t=>"activeEditInfo"in t).map(t=>t.activeEditInfo).items}_addGridEventListeners(){const t=this._grid;lo(t),this.handles.add([Wh(t,"click",e=>this._onRowClick(e)),Wh(t,"selected-items-changed",e=>this._onSelectionChange(e)),Wh(t,"sorter-changed",()=>this.notifyChange("sortOrders")),Wh(t,"loading-changed",e=>{this._isDataLoaded||e.detail.value===!1&&(this._isDataLoaded=!0,this._selectRowsOnLoad())})])}_onRowClick(t){const e=this._grid;lo(e);const i=e.getEventContext(t),{item:r,section:n}=i;r&&n&&n!=="details"&&n!=="header"&&this.emit("row-click",{context:i,native:t})}_clearSelection(){this._grid&&(this.highlightIds.removeAll(),this._grid.selectedItems=[],this._grid.render())}_selectRowsOnLoad(){var r;const t=this._grid;if(!t)return;const e=t.selectedItems.slice();((r=this.highlightIds)==null?void 0:r.filter(n=>e.findIndex(s=>s.objectId===n)<0)).forEach(n=>{var s;return t.selectedItems.push(((s=this.store)==null?void 0:s.getLocalItemByKey(n))||{objectId:n})}),t.render()}_selectRows(t){const e=this._grid;if(!e)return;const i=e.selectedItems.slice();t.filter(r=>i.findIndex(n=>n.objectId===r.objectId)<0).forEach(r=>e.selectedItems.push(r)),e.render()}_deselectRows(t){const e=this._grid;if(!e)return;const i=e.selectedItems.slice();t.forEach(r=>{const n=i.findIndex(s=>s.objectId===r.objectId);n>-1&&i.splice(n,1)}),e.selectedItems=i,e.render()}_onSelectionChange(t){const e=t;if(e.detail.path==="selectedItems.splices"){const{removed:i,object:r}=e.detail.value.indexSplices[0],n=r.filter(o=>!this.highlightIds.includes(o.objectId)).map(o=>o.objectId),s=i.filter(o=>this.highlightIds.includes(o.objectId)).map(o=>o.objectId);this.highlightIds.removeMany(s),this.highlightIds.addMany(n)}}_applyRenderersToColumnElement(t){const e=t==null?void 0:t.path,i=e!=null?this.viewModel.findColumn(e):void 0;if(i)try{const{renderFunction:r,footerRenderFunction:n,headerRenderFunction:s}=i;r&&"renderer"in t&&(t.renderer=(o,a,l)=>r({root:o,column:a,rowData:l})),n&&(t.footerRenderer=(o,a)=>n({root:o,column:a})),s&&(t.headerRenderer=(o,a)=>s({root:o,column:a}))}catch{}}};d([p()],Vr.prototype,"_grid",void 0),d([p()],Vr.prototype,"_isDataLoaded",void 0),d([p()],Vr.prototype,"cellClassNameGenerator",null),d([p()],Vr.prototype,"columns",null),d([p()],Vr.prototype,"columnReorderingEnabled",null),d([p()],Vr.prototype,"dataProvider",null),d([p()],Vr.prototype,"highlightIds",null),d([p()],Vr.prototype,"itemIdPath",void 0),d([p()],Vr.prototype,"label",null),d([p(),ut("esri/widgets/FeatureTable/t9n/FeatureTable")],Vr.prototype,"messages",void 0),d([p()],Vr.prototype,"multiSortEnabled",null),d([p()],Vr.prototype,"pageSize",null),d([p()],Vr.prototype,"rowDetailsRenderer",null),d([p()],Vr.prototype,"size",null),d([p({readOnly:!0})],Vr.prototype,"sortOrders",null),d([p()],Vr.prototype,"store",null),d([p()],Vr.prototype,"viewModel",void 0),d([p()],Vr.prototype,"visibleElements",void 0),d([tt("visibleElements")],Vr.prototype,"castVisibleElements",null),Vr=d([A("esri.widgets.FeatureTable.Grid.Grid")],Vr);const TYe=Vr;let Nb=class extends aR{constructor(e){super(e),this.columns=null,this.sortable=!1}get path(){return this.header}set path(e){this.header=e}};d([p()],Nb.prototype,"columns",void 0),d([p()],Nb.prototype,"path",null),d([p({readOnly:!0})],Nb.prototype,"sortable",void 0),Nb=d([A("esri.widgets.FeatureTable.Grid.GroupColumn")],Nb);const CYe=Nb,zge="esri.widgets.FeatureTable.support.FeatureStore",EYe=ie.getLogger(zge);function uF(t,e,i){EYe.error(new N(t,e,i))}let ss=class extends he{constructor(e){super(e),this._loaded=!1,this._loadError=!1,this._loading=!1,this._editOperationQueue=[],this._queryOperationQueue=[],this._objectIdCache=new ye,this._hasStaleCache=!1,this.count=0,this.failures=new ye,this.itemCache=new ye,this.relatedRecordsEnabled=!1}destroy(){var e,i;this.layer=null,(e=this.itemCache)==null||e.destroy(),(i=this.failures)==null||i.destroy(),this._set("itemCache",null)}set attachmentsEnabled(e){this._reset(),this._set("attachmentsEnabled",e),this.notifyChange("state")}set filterGeometry(e){this._reset(),this._set("filterGeometry",e),this.notifyChange("state")}set layer(e){this._reset(),this._set("layer",e),this.notifyChange("state")}set objectIds(e){this._reset(),this._set("objectIds",e||null),this.notifyChange("state")}get orderByFields(){return this._get("orderByFields")||[]}set orderByFields(e){const i=this.orderByFields;JT(e,i)||(this.itemCache.removeAll(),this._hasStaleCache=!0,this._set("orderByFields",e))}get querying(){return this._queryOperationQueue.length>0}set returnGeometry(e){this._reset(),this._set("returnGeometry",e),this.notifyChange("state")}get state(){const{layer:e,_loaded:i,_loadError:r,_loading:n}=this;return r?"error":!e||this.get("layer.loadError")?"disabled":n?"loading":this.get("layer.loadStatus")==="loaded"&&i?"loaded":"ready"}get syncing(){return this._editOperationQueue.length>0}set timeExtent(e){this._reset(),this._set("timeExtent",e),this.notifyChange("state")}get where(){return this._get("where")||null}set where(e){this._reset(),this._set("where",e),this.notifyChange("state")}async load(){this._reset();const{layer:e}=this;if(e){this._loading=!0,this.notifyChange("state");try{await e.when(),await this._syncLayerInfo(),this._loading=!1,this._loaded=!0,this.notifyChange("state")}catch(i){throw this._reset(),this._loadError=!0,this.notifyChange("state"),uF("store:load-error","An error ocurred.",{error:i}),i}}}async refreshLayerInfo(){return this._syncLayerInfo()}async addItems(e){}async fetchItems(e){const{page:i,pageSize:r}=e,n=i*r,s=n+r,{layer:o,state:a}=this;if(!o||a!=="loaded")return[];this.notifyChange("querying");const l=await this._query({start:n,num:s,page:i,pageSize:r});return this.notifyChange("state"),l}async verifyFeaturesByObjectId(e){const{layer:i,state:r}=this;if(!i||r!=="loaded")return[];const{features:n}=await this._verifyFeaturesByObjectId(e);return e.map(s=>n.some(o=>(o==null?void 0:o.getObjectId())===s))}async query(e){const{layer:i,state:r}=this;if(!i||r!=="loaded")return[];this.notifyChange("querying");const n=await this._query(e);return this.notifyChange("state"),n}async removeItemAt(e){}async reset(){this._reset()}async updateItem(e){return this._update(e).then(()=>{})}async deleteRowsByObjectId(e){return this._delete({objectIds:e})}getLocalItemByKey(e){return this.getItemByObjectId(e)}getItemByObjectId(e){const{itemCache:i,layer:{objectIdField:r}}=this;return i.find(n=>{var s;return((s=n.feature)==null?void 0:s.attributes[r])===e})}getLocalItemAt(e){return this.itemCache.at(e)}at(e){return Promise.resolve(this.itemCache.at(e))}getObjectIdIndex(e){const{itemCache:i,layer:{objectIdField:r}}=this;return i.findIndex(n=>{var s;return((s=n.feature)==null?void 0:s.attributes[r])===e})}_reset(){this.itemCache.removeAll(),this.failures.removeAll(),this._editOperationQueue=[],this._queryOperationQueue=[],this._hasStaleCache=!1,this._loading=!1,this._loaded=!1,this._loadError=!1,this._set("count",0),this._objectIdCache.removeAll(),this.notifyChange("querying"),this.notifyChange("syncing"),this.notifyChange("state")}_getIdsFromFeatures(e){return e.map(i=>i.attributes[this.layer.objectIdField])}_toFeatureData(e,i){const{layer:{objectIdField:r}}=this;return e.map(n=>{const{attributes:s}=n,o=s[r];return{objectId:o,feature:n,attachments:i?i[o]:null,relatedRecords:null}})}async _update(e){const{layer:i}=this,{operations:r}=Ro(i);if(!r.supportsUpdate||!("applyEdits"in i))throw new N("store:update-error","Update is not supported.");const{index:n,name:s,value:o}=e,a=await this.at(n);if(!a||!a.feature)throw new N("store:update-error","Feature with provided 'objectId' not found.");const{feature:l}=a,c=U(l.attributes);c[s]=o;const u=new Or({attributes:c}),h=i.applyEdits({updateFeatures:[u]}).then(f=>{const{updateFeatureResults:m}=f,g=m.find(y=>!!y.error);if(g)throw g.error;return m.length&&(l.attributes=c),f});return this._queueEditOperation(()=>h)}async _delete(e){const{layer:i}=this,{operations:r}=Ro(i);if(!r.supportsDelete||!("applyEdits"in i))throw new N("store:delete-error","Delete is not supported.");const{objectIds:n}=e,s=n.map(o=>{var a;return(a=this.getItemByObjectId(o))==null?void 0:a.feature}).filter(Dt);return this._queueEditOperation(()=>i.applyEdits({deleteFeatures:s}))}async _query(e){const{refresh:i}=e;return i===!0?(this.itemCache.removeAll(),this._syncLayerInfo().then(()=>this._queryFeatureData(e))):(this._hasStaleCache&&(await this._updateIds(),this._hasStaleCache=!1),this._queryFeatureData(e))}async _queryFeatureData(e){return this._queueQueryOperation(async()=>{const{features:i}=await this._queryFeatures(e),r=this._getIdsFromFeatures(i),n=await this._queryAttachments(r);return this._toFeatureData(i,n)||[]})}async _syncLayerInfo(){await this._updateCount(),await this._updateIds()}async _updateCount(){await this._queryCount().then(e=>this._set("count",e))}async _updateIds(){var e,i,r;(r=(i=(e=this.layer)==null?void 0:e.capabilities)==null?void 0:i.query)!=null&&r.supportsPagination||(this._objectIdCache.removeAll(),await this._queryForObjectIds().then(n=>this._objectIdCache.addMany(n)))}_queryCount(){var s,o;const{filterGeometry:e,layer:i}=this,r=(o=(s=i.capabilities)==null?void 0:s.query)==null?void 0:o.supportsCacheHint,n=i.createQuery();return n.geometry=e,n.returnGeometry=!1,n.where=this._getWhere(),n.timeExtent=this._getTimeExtent(),n.objectIds=this.objectIds,r&&(n.cacheHint=!0),i.queryFeatureCount(n)}_queryForObjectIds(){var l;const{filterGeometry:e,layer:i,orderByFields:r}=this,n=(l=i.capabilities)==null?void 0:l.query,s=n==null?void 0:n.supportsCacheHint,o=n==null?void 0:n.supportsOrderBy,a=i.createQuery();return a.geometry=e,a.outFields=[i.objectIdField],a.returnGeometry=!1,a.where=this._getWhere(),a.timeExtent=this._getTimeExtent(),a.objectIds=this.objectIds,o&&(a.orderByFields=r),s&&(a.cacheHint=!0),i.queryObjectIds(a)}async _queryFeatures(e){var u,h,f;const{layer:i}=this;if(!((u=Ro(i))!=null&&u.operations.supportsQuery))throw new N("store:query-error","Layer does not support query operation.");const{filterGeometry:r,orderByFields:n,returnGeometry:s}=this,o=(f=(h=this.layer)==null?void 0:h.capabilities)==null?void 0:f.query,{start:a,pageSize:l}=e,c=i.createQuery();return c.returnGeometry=s,o!=null&&o.supportsPagination?(c.start=a,c.num=l,c.where=this._getWhere(),c.timeExtent=this._getTimeExtent(),c.objectIds=this.objectIds):c.objectIds=this.objectIds||this._getObjectIdsForPage(a,l??0),o!=null&&o.supportsOrderBy&&(c.orderByFields=n),r&&(c.geometry=r),o!=null&&o.supportsCacheHint&&(c.cacheHint=!0),i.queryFeatures(c)}async _verifyFeaturesByObjectId(e){var a,l,c;const{layer:i}=this;if(!((a=Ro(i))!=null&&a.operations.supportsQuery))throw new N("store:query-error","Layer does not support query operation.");const{filterGeometry:r,orderByFields:n}=this,s=(c=(l=this.layer)==null?void 0:l.capabilities)==null?void 0:c.query,o=i.createQuery();return o.where=this._getWhere(),o.timeExtent=this._getTimeExtent(),o.returnGeometry=!1,o.objectIds=e,o.outFields=[i.objectIdField],s!=null&&s.supportsOrderBy&&(o.orderByFields=n),r&&(o.geometry=r),s!=null&&s.supportsCacheHint&&(o.cacheHint=!0),i.queryFeatures(o)}_getObjectIdsForPage(e,i){const r=this._objectIdCache.toArray();return r.length>=e+i?r.slice(e,e+i):r.slice(e)}_queryAttachments(e){var a;const{attachmentsEnabled:i,layer:r}=this,{capabilities:n}=r,s=n==null?void 0:n.data.supportsAttachment,o=(a=n==null?void 0:n.operations)==null?void 0:a.supportsQueryAttachments;return i&&s&&o&&"queryAttachments"in r?r.queryAttachments(new $P({objectIds:e,where:this._getWhere()})):Promise.resolve(null)}_syncLocalCache(e){e.forEach(i=>{if(i.feature){const r=i.feature.getObjectId();if(r!=null){const n=this.getObjectIdIndex(r);n===-1?this.itemCache.add(i):this.itemCache.splice(n,1,i)}}})}_queueQueryOperation(e){return this._queryOperationQueue.push(e),this.notifyChange("querying"),e().then(i=>this._queryOperationQueue.includes(e)?(this._syncLocalCache(i),i):[]).catch(i=>{uF("store:query-error","An error ocurred.",{error:i});const r={error:i,retry:()=>{this.failures.remove(r),this._queueQueryOperation(e)},cancel:()=>this.failures.remove(r)};return this.failures.add(r),[]}).then(i=>(ww(this._queryOperationQueue,e),this.notifyChange("querying"),i))}_queueEditOperation(e){return this._editOperationQueue.push(e),this.notifyChange("syncing"),e().then(i=>(ww(this._editOperationQueue,e),this.notifyChange("syncing"),i)).catch(i=>{uF("store:edit-error","An error ocurred.",{error:i});const r={error:i,retry:()=>{this.failures.remove(r),this._queueEditOperation(e)},cancel:()=>this.failures.remove(r)};throw this.failures.add(r),ww(this._editOperationQueue,e),this.notifyChange("syncing"),i})}_getWhere(){var e;return this.where||((e=this.layer)==null?void 0:e.definitionExpression)||"1=1"}_getTimeExtent(){const e=this.layer;return this.timeExtent||e&&"timeExtent"in e&&e.timeExtent||null}};d([p()],ss.prototype,"attachmentsEnabled",null),d([p({readOnly:!0})],ss.prototype,"count",void 0),d([p({readOnly:!0})],ss.prototype,"failures",void 0),d([p()],ss.prototype,"filterGeometry",null),d([p({readOnly:!0})],ss.prototype,"itemCache",void 0),d([p({value:null})],ss.prototype,"layer",null),d([p({value:null})],ss.prototype,"objectIds",null),d([p()],ss.prototype,"orderByFields",null),d([p({readOnly:!0})],ss.prototype,"querying",null),d([p()],ss.prototype,"relatedRecordsEnabled",void 0),d([p({value:!1})],ss.prototype,"returnGeometry",null),d([p({readOnly:!0})],ss.prototype,"state",null),d([p({readOnly:!0})],ss.prototype,"syncing",null),d([p()],ss.prototype,"timeExtent",null),d([p()],ss.prototype,"where",null),ss=d([A(zge)],ss);const jge=ss;let si=class extends cn(Tme){constructor(e){super(e),this._debounceRefresh=Ad(()=>this._refresh()),this._highlights=new gs,this.activeFilters=new ye,this.autoRefreshEnabled=!0,this.cellClassNameGenerator=(i,r)=>i.path||null,this.columns=new ye,this.dataProvider=async(i,r)=>{const{store:n}=this,{page:s,pageSize:o,sortOrders:a}=i,l=this._sortOrdersToLayerOrderByFields(a);r&&(n?(await n.set({orderByFields:l}),n.state!=="loaded"&&n.state!=="loading"&&await n.load(),r&&r(await n.fetchItems({page:s,pageSize:o}))):r&&r([]))},this.editingEnabled=!1,this.fieldConfigs=null,this.grid=null,this.highlightEnabled=!0,this.itemIdPath="objectId",this.messagesCommon=null,this.messagesURIUtils=null,this.relatedRecordsEnabled=!1,this.returnGeometryEnabled=!1,this.store=null,this.tableTemplate=null,this.view=null,this._onLayerRefresh=this._onLayerRefresh.bind(this),this._set("store",new jge),this._set("grid",new TYe({itemIdPath:this.itemIdPath,viewModel:this}))}initialize(){const e=async()=>{this.messages=await ev("esri/widgets/FeatureTable/t9n/FeatureTable"),this.messagesCommon=await ev("esri/t9n/common"),this.messagesURIUtils=await ev("esri/widgets/support/t9n/uriUtils")};e(),this.handles.add([nC(()=>{e(),this._generateColumns()}),ui(()=>this.highlightIds,"change",i=>this._onHighlightIdsChange(i),{onListenerAdd:()=>{this.highlightIds.forEach(i=>this._highlight(i))},onListenerRemove:()=>{this.highlightIds.forEach(i=>this._unhighlight(i))}}),J(()=>this.layerView,()=>{var i;this._highlights.removeAll(),this.layerView&&this.highlightEnabled&&((i=this.highlightIds)==null||i.forEach(r=>this._highlight(r)))}),J(()=>this.highlightEnabled,()=>{var i;this._highlights.removeAll(),this.highlightEnabled&&((i=this.highlightIds)==null||i.forEach(r=>this._highlight(r)))}),J(()=>this.relatedRecordsEnabled,i=>this.store.relatedRecordsEnabled=i),J(()=>this.returnGeometryEnabled,i=>this.store.returnGeometry=i),J(()=>{var i;return(i=this.layer)==null?void 0:i.loaded},i=>i&&this._onLayerLoad()),J(()=>this.store.state,i=>{var r;i==="loaded"&&((r=this.grid)==null||r.scrollToTop())}),J(()=>[this.messages,this.tableTemplate,this.fieldConfigs],()=>{var i;return((i=this.layer)==null?void 0:i.loaded)&&this._generateColumns()}),J(()=>this.editingEnabled,i=>{var r;this.columns.forEach(n=>{"editingEnabled"in n&&(n.editingEnabled=i)}),(r=this.grid)==null||r.onColumnChange()}),J(()=>{var i;return(i=this.layer)==null?void 0:i.definitionExpression},(i,r)=>(i||r)&&this.store.state==="loaded"&&this.reset()),J(()=>this.layer&&"timeExtent"in this.layer&&this.layer.timeExtent,(i,r)=>(i||r)&&!this.timeExtent&&this.store.state==="loaded"&&this.reset()),ui(()=>this.layer,"refresh",i=>this._onLayerRefresh(i))])}destroy(){var e,i;this._resetColumns(),this.handles.removeAll(),this._highlights.removeAll(),this._highlights.destroy(),(e=this.grid)==null||e.destroy(),(i=this.columns)==null||i.destroy(),this.layer=null,this.view=null}get _defaultHiddenFields(){return Moe(this.layer)}get activeSortOrders(){var e;return(e=this.grid)!=null&&e.sortOrders?this.grid.sortOrders.map(({path:i,direction:r})=>({fieldName:i,direction:r})):[]}set attachmentsEnabled(e){this.attachmentsEnabled!==e&&(this._set("attachmentsEnabled",e),this._generateColumns(),this.store.attachmentsEnabled=e)}set filterGeometry(e){if(!this.filterGeometry&&!e)return;const i=this.activeFilters.find(r=>r.type==="geometry");i&&this.activeFilters.remove(i),this._set("filterGeometry",e),this.store.filterGeometry=e,e&&this.activeFilters.add({type:"geometry",geometry:e})}get hiddenFields(){return this._get("hiddenFields")??new ye}set hiddenFields(e){Array.isArray(e)?this._set("hiddenFields",new ye(e)):this._set("hiddenFields",e)}get highlightOnRowSelectEnabled(){return this.highlightEnabled}set highlightOnRowSelectEnabled(e){this.highlightEnabled=e}set layer(e){var i;this._set("layer",e),(i=this.grid)==null||i.clearSort(),this._resetColumns(),this.store.layer=e,e&&(e.loaded?this._onLayerLoad():e.load()),this.notifyChange("state")}get layerView(){var e;return((e=this.view)==null?void 0:e.allLayerViews.find(i=>i.layer===this.layer))||null}set messages(e){var i;(i=this.grid)==null||i.set("messages",e),this._set("messages",e)}get state(){const{store:e}=this;return e&&e.state!=="disabled"?e.state==="loading"?"loading":e.state==="loaded"?"loaded":"ready":"disabled"}set timeExtent(e){this._set("timeExtent",e),this.store.timeExtent=e}clearHighlights(){this._highlights.removeAll()}clearSelection(){var e;(e=this.grid)==null||e.clearSelection()}async deleteSelection(){const e=this.highlightIds.toArray();if(!(e!=null&&e.length))return;const{deleteFeatureResults:i}=await this.store.deleteRowsByObjectId(e),r=i.filter(n=>!n.error).map(n=>n.objectId);r.length&&(this.deselectRows(r),await this.refresh())}deselectRows(e){var r;const i=this._getStoreItemsFromSelectionParams(e);(r=this.grid)==null||r.deselectRows(i)}filterBySelection(){const e=this.highlightIds.toArray();e.length&&(this.clearSelectionFilter(),this.store.objectIds=e,this.activeFilters.add({type:"selection",objectIds:e}))}getObjectIdIndex(e){var i;return(i=this.store)==null?void 0:i.getObjectIdIndex(e)}getValue(e,i){var n;const r=this.store.getItemByObjectId(e);return(n=r==null?void 0:r.feature)==null?void 0:n.attributes[i]}get highlightIds(){return this._get("highlightIds")||new ye}set highlightIds(e){Array.isArray(e)?this._set("highlightIds",new ye(e)):this._set("highlightIds",e)}async refresh(){return $d(this._debounceRefresh())}reset(){var e;(e=this.grid)==null||e.reset()}selectRows(e){var r;const i=this._getStoreItemsFromSelectionParams(e);return(r=this.grid)==null?void 0:r.selectRows(i)}scrollToIndex(e){var i;(i=this.grid)==null||i.scrollToIndex(e)}clearSelectionFilter(){this.store.objectIds=null;const e=this.activeFilters.find(i=>i.type==="selection");e&&this.activeFilters.remove(e)}zoomToSelection(){const{layer:e,view:i}=this,r=this.highlightIds.toArray();if(!e||!i||!r.length)return;const n=e.createQuery();n.objectIds=r,n.returnGeometry=!0,e.queryFeatures(n).then(s=>{i.goTo(s.features).catch(o=>{o.name!=="AbortError"&&console.error(o)})})}async _refresh(){var i;await this.store.refreshLayerInfo();const e=this.highlightIds.toArray();e.length&&(await this.store.verifyFeaturesByObjectId(e)).forEach((r,n)=>{r||this.deselectRows(e[n])}),(i=this.grid)==null||i.refreshPageCache()}_onLayerLoad(){var i;const e=(i=this.layer.capabilities)==null?void 0:i.query.maxRecordCount;e&&e<this.pageSize&&this.grid&&(this.grid.pageSize=e),this._generateColumns()}_onLayerRefresh(e){this.autoRefreshEnabled&&e.dataChanged&&this.refresh()}_generateColumns(){var r,n;this._resetColumns();const e=[],i=(r=this.tableTemplate)!=null&&r.columnTemplates?this._generateColumnsFromTemplates(this.tableTemplate.columnTemplates):(n=this.fieldConfigs)!=null&&n.length?this._generateColumnsFromConfigs():this._generateDefaultFieldColumns();e.push(...i),e.length&&this.attachmentsEnabled&&e.push(this._generateDefaultAttachmentColumn()),this.columns.addMany([...e])}_generateColumnsFromTemplates(e){var f;const{editingEnabled:i,grid:r,layer:n,messages:s,messagesCommon:o,messagesURIUtils:a,store:l,tableTemplate:c}=this,u=((f=this.layer)==null?void 0:f.fields)??[],h=m=>{var y;const g="fieldName"in m&&((y=m.fieldName)==null?void 0:y.toLowerCase());return u.find(v=>{var b;return g===((b=v.name)==null?void 0:b.toLowerCase())})};return e.filter(m=>h(m)!=null||m.type==="group"&&"columnTemplates"in m).map(m=>{if("fieldName"in m){const g=h(m),y=m.visible===!1||m.visible!==!0&&this._isFieldHidden(g==null?void 0:g.name),{direction:v,formatFunction:b,initialSortPriority:w,menuConfig:x,textAlign:S}=m;return new G5({direction:v,editingEnabled:i,expressionInfos:(c==null?void 0:c.expressionInfos)||null,field:g,formatFunction:b,grid:r,hidden:y,initialSortPriority:w,layer:n,messages:s,messagesCommon:o,messagesURIUtils:a,menuConfig:x,store:l,template:m,textAlign:S})}if(m.type==="group"&&"columnTemplates"in m){const g=this._generateColumnsFromTemplates(m.columnTemplates),y=m.visible===!1||m.visible!==!0&&this._isFieldHidden(m.label),{label:v}=m;return new CYe({header:v,columns:g,hidden:y})}return new aR({...m})})}_generateColumnsFromConfigs(){var h;const{editingEnabled:e,fieldConfigs:i,grid:r,layer:n,messages:s,messagesCommon:o,messagesURIUtils:a,store:l}=this;if(!i)return[];const c=((h=this.layer)==null?void 0:h.fields)??[],u=f=>{var g;const m=(g=f.name)==null?void 0:g.toLocaleLowerCase();return c.find(y=>{var v;return m===((v=y.name)==null?void 0:v.toLowerCase())})};return i.filter(u).map(f=>{const m=f.direction||null,g=f.formatFunction||null,y=f.textAlign||null,v=f.initialSortPriority!=null?f.initialSortPriority:null,b=u(f),w=f.visible===!1||f.visible!==!0&&this._isFieldHidden(b==null?void 0:b.name),x=f.menuConfig||null;return new G5({config:f,direction:m,editingEnabled:e,field:b,formatFunction:g,grid:r,hidden:w,layer:n,store:l,messages:s,messagesCommon:o,messagesURIUtils:a,menuConfig:x,textAlign:y,initialSortPriority:v})})}_generateDefaultFieldColumns(){var l;const{editingEnabled:e,grid:i,layer:r,messages:n,messagesCommon:s,messagesURIUtils:o,store:a}=this;return(((l=this.layer)==null?void 0:l.fields)??[]).map(c=>new G5({editingEnabled:e,field:c,grid:i,hidden:this._isFieldHidden(c.name),layer:r,store:a,messages:n,messagesCommon:s,messagesURIUtils:o}))}_generateDefaultAttachmentColumn(){var e;return new CHe({header:(e=this.messages)==null?void 0:e.attachments})}_sortOrdersToLayerOrderByFields(e){return e&&e.length?e.filter((i,r,n)=>n.map(s=>s.path).indexOf(i.path)===r).filter(({direction:i})=>!!i).map(({direction:i,path:r})=>r+" "+(i==null?void 0:i.toUpperCase())):[]}_isFieldHidden(e){const i=e==null?void 0:e.toLowerCase();return(this.hiddenFields??this._defaultHiddenFields).some(r=>r.toLowerCase()===i)}_highlight(e){this.layerView&&sR(this.layerView)&&this._highlights.add(this.layerView.highlight(e),e)}_unhighlight(e){this._highlights.remove(e)}_getStoreItemsFromSelectionParams(e){const i=[];return(e=e instanceof Array?e:[e]).forEach(r=>{let n=r instanceof Or?r:null;const s=n?n.getObjectId():r;if(typeof s=="number"||typeof s=="string"){if(!n){const o=this.store.getItemByObjectId(s);o&&(n=o.feature)}i.push({objectId:s,feature:n})}}),i}_onHighlightIdsChange(e){const{highlightEnabled:i}=this,{added:r,removed:n}=e;i&&(r.forEach(s=>this._highlight(s)),n.forEach(s=>this._unhighlight(s)))}_resetColumns(){this.columns.items.forEach(e=>e.destroy()),this.columns.removeAll()}};d([p()],si.prototype,"_defaultHiddenFields",null),d([p({readOnly:!0})],si.prototype,"activeFilters",void 0),d([p({readOnly:!0})],si.prototype,"activeSortOrders",null),d([p()],si.prototype,"attachmentsEnabled",null),d([p()],si.prototype,"autoRefreshEnabled",void 0),d([p()],si.prototype,"cellClassNameGenerator",void 0),d([p({readOnly:!0})],si.prototype,"columns",void 0),d([p()],si.prototype,"dataProvider",void 0),d([p()],si.prototype,"editingEnabled",void 0),d([p()],si.prototype,"fieldConfigs",void 0),d([p()],si.prototype,"filterGeometry",null),d([p({readOnly:!0})],si.prototype,"grid",void 0),d([p()],si.prototype,"hiddenFields",null),d([p()],si.prototype,"highlightEnabled",void 0),d([p()],si.prototype,"highlightOnRowSelectEnabled",null),d([p({readOnly:!0})],si.prototype,"itemIdPath",void 0),d([p()],si.prototype,"layer",null),d([p()],si.prototype,"layerView",null),d([p()],si.prototype,"messages",null),d([p(),ut("esri/t9n/common")],si.prototype,"messagesCommon",void 0),d([p(),ut("esri/widgets/support/t9n/uriUtils")],si.prototype,"messagesURIUtils",void 0),d([p()],si.prototype,"relatedRecordsEnabled",void 0),d([p()],si.prototype,"returnGeometryEnabled",void 0),d([p({readOnly:!0})],si.prototype,"state",null),d([p({readOnly:!0,type:jge})],si.prototype,"store",void 0),d([p()],si.prototype,"tableTemplate",void 0),d([p()],si.prototype,"timeExtent",null),d([p()],si.prototype,"view",void 0),d([p()],si.prototype,"highlightIds",null),si=d([A("esri.widgets.FeatureTable.FeatureTableViewModel")],si);const MYe=si,$Ye={heading:"esri-widget__heading"};function Ql({level:t,class:e,...i},r){const n=Bge(t);return M(`h${n}`,{...i,class:q0($Ye.heading,e),role:"heading","aria-level":String(n)},r)}function Bge(t){return Pn(Math.ceil(t),1,6)}function pw(t,e=1){return Bge(t+e)}const hQ={header:!0,menu:!0,menuItems:{clearSelection:!0,refreshData:!0,toggleColumns:!0,selectedRecordsShowAllToggle:!0,selectedRecordsShowSelectedToggle:!0,zoomToSelection:!0,deleteSelection:!0},selectionColumn:!0,columnMenus:!0},Hf="esri-feature-table",E_=`${Hf}__prompt`,Fn={base:Hf,header:`${Hf}__header`,title:`${Hf}__title`,content:`${Hf}__content`,loader:`${Hf}__loader`,loaderContainer:`${Hf}__loader-container`,menuContainer:`${Hf}__menu`,menuIcon:"esri-icon-handle-horizontal",menuItemGroupOpenedIcon:"esri-icon-down",menuItemGroupClosedIcon:"esri-icon-right",checkmarkIcon:"esri-icon-check-mark",promptContainer:E_,promptHeader:`${E_}__header`,promptHeading:`${E_}__header__heading`,promptMessage:`${E_}__message`,promptDivider:`${E_}__divider`,promptActions:`${E_}__actions`,widget:"esri-widget"},pQ=ie.getLogger("esri.widgets.FeatureTable");let zt=class extends cn(di){constructor(e,i){super(e,i),this._prompt=null,this.menu=null,this.menuConfig=null,this.viewModel=new MYe,this.visibleElements={...hQ},this._showDeletePrompt=this._showDeletePrompt.bind(this),this._onDeleteSelectionClick=this._onDeleteSelectionClick.bind(this)}initialize(){var r,n,s;this.handles.add([ui(()=>this.viewModel.columns,"change",()=>this._syncMenuConfig()),ui(()=>this.viewModel.activeFilters,"change",()=>this._syncMenuConfig()),ui(()=>this.highlightIds,"change",o=>{this._syncMenuConfig(),this._onSelectionChange(o)}),J(()=>[this.viewModel.store.querying,this.viewModel.store.syncing,this.editingEnabled],()=>this.scheduleRender()),J(()=>[this.menuConfig,this.editingEnabled],()=>this._syncMenuConfig()),J(()=>this.messages,()=>{var o;this.menu&&(this.menu.label=(o=this.messages)==null?void 0:o.options),this._syncMenuConfig()})]),this._set("menu",new ame({label:(r=this.messages)==null?void 0:r.options,iconClass:Fn.menuIcon,...this.menuConfig}));const{attachmentsEnabled:e,relatedRecordsEnabled:i}=this;(s=(n=this.viewModel)==null?void 0:n.store)==null||s.set({attachmentsEnabled:e,relatedRecordsEnabled:i})}loadDependencies(){return Zd({button:()=>W(()=>import("./calcite-button-63d3e2be.js"),["./calcite-button-63d3e2be.js","./form-5109e7da.js","./interactive-3cbb41b8.js","./browser-14ab28bd.js","./label2-c76d0cf4.js","./loadable-800481cb.js","./t9n-5488ec48.js","./key-a512d618.js","./observers-c8819292.js","./icon-55c3c703.js","./loader-ea07f4e7.js","./guid-40d04074.js"],import.meta.url),icon:()=>W(()=>import("./calcite-icon-dc1254b1.js"),["./calcite-icon-dc1254b1.js","./icon-55c3c703.js","./observers-c8819292.js"],import.meta.url),scrim:()=>W(()=>import("./calcite-scrim-97dac5b5.js"),["./calcite-scrim-97dac5b5.js","./scrim-61cfb0a8.js","./t9n-5488ec48.js","./key-a512d618.js","./observers-c8819292.js","./loader-ea07f4e7.js","./guid-40d04074.js"],import.meta.url)})}destroy(){var e;this._prompt=null,this.handles.removeAll(),(e=this.menu)==null||e.destroy()}get activeFilters(){return this.viewModel.activeFilters}get activeSortOrders(){return this.viewModel.activeSortOrders}get attachmentsEnabled(){return this.viewModel.attachmentsEnabled}set attachmentsEnabled(e){this.viewModel.attachmentsEnabled=e}get autoRefreshEnabled(){return this.viewModel.autoRefreshEnabled}set autoRefreshEnabled(e){this.viewModel.autoRefreshEnabled=e}get columnReorderingEnabled(){return this.viewModel.columnReorderingEnabled}set columnReorderingEnabled(e){this.viewModel.columnReorderingEnabled=e}get columns(){return this.viewModel.columns}get editingEnabled(){return this.viewModel.editingEnabled}set editingEnabled(e){this.viewModel.editingEnabled=e}get fieldConfigs(){return this.viewModel.fieldConfigs??[]}set fieldConfigs(e){this.viewModel.fieldConfigs=e}get filterGeometry(){return this.viewModel.filterGeometry}set filterGeometry(e){this.viewModel.filterGeometry=e}get grid(){return this.viewModel.grid}get hiddenFields(){return this.viewModel.hiddenFields}set hiddenFields(e){this.viewModel.hiddenFields=e}get highlightEnabled(){return this.viewModel.highlightEnabled}set highlightEnabled(e){this.viewModel.highlightEnabled=e}get highlightIds(){return this.viewModel.highlightIds}set highlightIds(e){this.viewModel.highlightIds=e}get highlightOnRowSelectEnabled(){return this.viewModel.highlightEnabled}set highlightOnRowSelectEnabled(e){this.viewModel.highlightEnabled=e}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get layer(){return this.viewModel.layer}set layer(e){this.viewModel.layer=e}get messages(){return this.viewModel.messages}set messages(e){this.viewModel.messages=e}get messagesCommon(){return this.viewModel.messagesCommon}set messagesCommon(e){this.viewModel.messagesCommon=e}get messagesURIUtils(){return this.viewModel.messagesURIUtils}set messagesURIUtils(e){this.viewModel.messagesURIUtils=e}get multiSortEnabled(){return this.viewModel.multiSortEnabled}set multiSortEnabled(e){this.viewModel.multiSortEnabled=e}get pageSize(){return this.viewModel.pageSize}set pageSize(e){this.viewModel.pageSize=e}get relatedRecordsEnabled(){return this.viewModel.relatedRecordsEnabled}set relatedRecordsEnabled(e){this.viewModel.relatedRecordsEnabled=e}get state(){return this.viewModel.state}get tableTemplate(){return this.viewModel.tableTemplate}set tableTemplate(e){this.viewModel.tableTemplate=e}get timeExtent(){return this.viewModel.timeExtent}set timeExtent(e){this.viewModel.timeExtent=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}castVisibleElements(e){var r;const i={...hQ,...e};return(r=this.grid)==null||r.set("visibleElements",{...this.grid.visibleElements,selectionColumn:i.selectionColumn,columnMenus:i.columnMenus}),i}clearHighlights(){return zH(pQ,"`FeatureTable.clearHighlights` is deprecated in favor of FeatureTable.highlightIds'",{replacement:"FeatureTable.highlightIds",version:"4.25",see:"https://developers.arcgis.com/javascript/latest/api-reference/esri-widgets-FeatureTable.html#highlightIds"}),this.viewModel.clearHighlights()}clearSelection(){return zH(pQ,"`FeatureTable.clearSelection` is deprecated in favor of FeatureTable.highlightIds'",{replacement:"FeatureTable.highlightIds",version:"4.25",see:"https://developers.arcgis.com/javascript/latest/api-reference/esri-widgets-FeatureTable.html#highlightIds"}),this.viewModel.clearSelection()}clearSelectionFilter(){return this.viewModel.clearSelectionFilter()}deleteSelection(e){return this.highlightIds.length?e?(this._showDeletePrompt(),this.scheduleRender(),Promise.resolve()):this.viewModel.deleteSelection():Promise.resolve()}deselectRows(e){return this.viewModel.deselectRows(e)}filterBySelection(){return this.viewModel.filterBySelection()}findColumn(e){return this.viewModel.findColumn(e)}hideColumn(e){var i;(i=this.grid)==null||i.hideColumn(e),this._syncMenuConfig()}refresh(){return this.viewModel.refresh()}get returnGeometryEnabled(){return this.viewModel.returnGeometryEnabled}set returnGeometryEnabled(e){this.viewModel.returnGeometryEnabled=e}showAllColumns(){return this.viewModel.showAllColumns()}showColumn(e){var i;(i=this.grid)==null||i.showColumn(e),this._syncMenuConfig()}sortColumn(e,i){return this.viewModel.sortColumn(e,i)}selectRows(e){return this.viewModel.selectRows(e)}scrollToIndex(e){return this.viewModel.scrollToIndex(e)}zoomToSelection(){return this.viewModel.zoomToSelection()}render(){var r;const{_prompt:e}=this,i=e!=null?M("calcite-scrim",null,this.renderPrompt(e)):null;return M("div",{bind:this,class:this.classes(Fn.base,Fn.widget)},this.visibleElements.header?this._renderHeader():null,M("div",{class:Fn.content},this.state!=="disabled"&&((r=this.grid)==null?void 0:r.render())),i)}renderPrompt({title:e,message:i,context:r,actions:n}){const s=M("calcite-button",{appearance:"solid",kind:r==="danger"?"danger":"brand",width:n.secondary?"half":"full",onclick:n.primary.action,key:"prompt-primary-button"},n.primary.label),o=n.secondary?M("calcite-button",{appearance:"outline",kind:r==="danger"?"danger":"brand",width:"half",onclick:n.secondary.action,key:"prompt-secondary-button"},n.secondary.label):null;return M("div",{class:`${Fn.promptContainer}--${r}`},M("div",{class:Fn.promptHeader},M("calcite-icon",{icon:"exclamation-mark-triangle"}),M(Ql,{class:Fn.promptHeading,level:2},e)),M("div",{class:Fn.promptMessage},i),M("div",{class:Fn.promptDivider}),M("div",{class:Fn.promptActions},o,s))}_renderHeader(){return M("div",{key:"header",class:Fn.header},this._renderLoader(),this._renderTitle(),this.visibleElements.menu?this._renderMenu():null)}_renderTitle(){return M("div",{class:Fn.title,key:"title"},this._getTitle())}_getTitle(){const{grid:e,highlightIds:i,layer:r,messages:n,viewModel:{size:s}}=this;return e&&r?Os(n.header,{title:r.title,count:s,selected:i.length||0}):""}_renderLoader(){const{state:e,store:i}=this.viewModel,r=e==="loading"||i.syncing||i.querying;return M("div",{class:Fn.loaderContainer},r?M("div",{class:Fn.loader,key:"loader"}):null)}_renderMenu(){var e;return M("div",{class:Fn.menuContainer},(e=this.menu)==null?void 0:e.render())}_onSelectionChange(e){const{added:i,removed:r}=e,n=i.map(o=>this.viewModel.store.getLocalItemByKey(o)||{objectId:o,feature:null,attachments:null,relatedRecords:null}),s=r.map(o=>this.viewModel.store.getLocalItemByKey(o)||{objectId:o,feature:null,attachments:null,relatedRecords:null});this.emit("selection-change",{added:n,removed:s})}_syncMenuConfig(){var e;(e=this.menu)==null||e.set({...this.menuConfig,items:this._getMenuItems()})}_getMenuItems(){var n;const e=(n=this.menuConfig)==null?void 0:n.items,i=this._getDefaultMenuItems(),r=[];return i!=null&&i.length&&r.push(...i),e!=null&&e.length&&r.push(...e),r}_getDefaultMenuItems(){var a,l,c,u;const{highlightIds:e,messages:i,viewModel:r,visibleElements:n}=this,{menuItems:s}=n,o=[];if(s!=null&&s.refreshData&&o.push(new hd({selectionEnabled:!1,label:i==null?void 0:i.refreshData,clickFunction:()=>this.refresh()})),e.length){const h=this._getSelectionFilter();if(s!=null&&s.clearSelection&&o.push(new hd({selectionEnabled:!1,label:i==null?void 0:i.clearSelection,clickFunction:()=>{var f;return(f=this.highlightIds)==null?void 0:f.removeAll()}})),s!=null&&s.zoomToSelection&&this.view&&o.push(new hd({selectionEnabled:!1,label:i==null?void 0:i.zoomToSelection,clickFunction:()=>this.viewModel.zoomToSelection()})),(s==null?void 0:s.selectedRecordsShowSelectedToggle)&&(!h||e.length!==h.objectIds.length)){const f=i.showSelected,m=new hd({selectionEnabled:!1,label:f,clickFunction:()=>{this.filterBySelection(),m.set("label",f)}});o.push(m)}s!=null&&s.deleteSelection&&this.editingEnabled&&((c=(l=(a=this.layer)==null?void 0:a.capabilities)==null?void 0:l.operations)!=null&&c.supportsDelete)&&o.push(new hd({selectionEnabled:!1,label:i.deleteSelection,clickFunction:this._showDeletePrompt}))}if(s!=null&&s.selectedRecordsShowAllToggle&&this._hasSelectionFilter()){const h=i.showAllRecords,f=new hd({selectionEnabled:!1,label:h,clickFunction:()=>{this.clearSelectionFilter(),f.set("label",h)}});o.push(f)}return s!=null&&s.toggleColumns&&o.push(new hd({iconClass:Fn.menuItemGroupClosedIcon,label:i==null?void 0:i.toggleColumns,clickFunction:this._toggleMenuItemSelectedIcon,items:(u=r==null?void 0:r.columns)==null?void 0:u.items.map(({header:h,hidden:f,path:m})=>new hd({label:h||m,selected:!f,selectionEnabled:!0,iconClass:Fn.checkmarkIcon,clickFunction:()=>this._toggleColumnFromMenuItem(m)}))})),o.length?o:null}_toggleMenuItemSelectedIcon({item:e}){e==null||e.set("iconClass",e!=null&&e.selected?Fn.menuItemGroupOpenedIcon:Fn.menuItemGroupClosedIcon)}_toggleColumnFromMenuItem(e){const{grid:i,viewModel:r}=this,n=r.findColumn(e);n!=null&&n.hidden?i==null||i.showColumn(e):i==null||i.hideColumn(e)}_showDeletePrompt(){const{messages:e,messagesCommon:i}=this,r=this.highlightIds.length||0,n=Os(e.deleteSelectionCount,{count:r});this.menu&&(this.menu.open=!1),this._prompt={title:n,message:e.deleteRecordsRemoved,context:"danger",actions:{primary:{label:i.delete,action:this._onDeleteSelectionClick},secondary:{label:e.keepRecords,action:()=>this._prompt=null}}}}async _onDeleteSelectionClick(){await this.viewModel.deleteSelection(),this._prompt=null}_getSelectionFilter(){var e;return(e=this.viewModel.activeFilters)==null?void 0:e.find(i=>i.type==="selection")}_hasSelectionFilter(){return!!this._getSelectionFilter()}};d([p({readOnly:!0})],zt.prototype,"activeFilters",null),d([p({readOnly:!0})],zt.prototype,"activeSortOrders",null),d([p()],zt.prototype,"attachmentsEnabled",null),d([p()],zt.prototype,"autoRefreshEnabled",null),d([p()],zt.prototype,"columnReorderingEnabled",null),d([p({readOnly:!0})],zt.prototype,"columns",null),d([p()],zt.prototype,"editingEnabled",null),d([p()],zt.prototype,"fieldConfigs",null),d([p()],zt.prototype,"filterGeometry",null),d([p({readOnly:!0})],zt.prototype,"grid",null),d([p()],zt.prototype,"hiddenFields",null),d([p()],zt.prototype,"highlightEnabled",null),d([p()],zt.prototype,"highlightIds",null),d([p()],zt.prototype,"highlightOnRowSelectEnabled",null),d([p()],zt.prototype,"label",null),d([p()],zt.prototype,"layer",null),d([p(),ut("esri/widgets/FeatureTable/t9n/FeatureTable")],zt.prototype,"messages",null),d([p(),ut("esri/t9n/common")],zt.prototype,"messagesCommon",null),d([p(),ut("esri/widgets/support/t9n/uriUtils")],zt.prototype,"messagesURIUtils",null),d([p({readOnly:!0})],zt.prototype,"menu",void 0),d([p()],zt.prototype,"menuConfig",void 0),d([p()],zt.prototype,"multiSortEnabled",null),d([p()],zt.prototype,"pageSize",null),d([p()],zt.prototype,"relatedRecordsEnabled",null),d([p({readOnly:!0})],zt.prototype,"state",null),d([p()],zt.prototype,"tableTemplate",null),d([p()],zt.prototype,"timeExtent",null),d([p()],zt.prototype,"view",null),d([p()],zt.prototype,"viewModel",void 0),d([p()],zt.prototype,"visibleElements",void 0),d([tt("visibleElements")],zt.prototype,"castVisibleElements",null),d([p()],zt.prototype,"returnGeometryEnabled",null),zt=d([A("esri.widgets.FeatureTable")],zt);const AYe=zt;var r8;let n0=r8=class extends te{constructor(t){super(t),this.expression=null,this.name=null,this.returnType="boolean",this.title=null}clone(){return new r8({name:this.name,title:this.title,expression:this.expression,returnType:this.returnType})}};d([p({type:String,json:{write:!0}})],n0.prototype,"expression",void 0),d([p({type:String,json:{write:!0}})],n0.prototype,"name",void 0),d([p({type:["boolean","date","number","string"],json:{write:!0}})],n0.prototype,"returnType",void 0),d([p({type:String,json:{write:!0}})],n0.prototype,"title",void 0),n0=r8=d([A("esri.form.ExpressionInfo")],n0);const Uge=n0;var n8;let w2=n8=class extends te{constructor(t){super(t),this.columnTemplates=[],this.expressionInfos=null}clone(){return new n8({columnTemplates:U(this.columnTemplates),expressionInfos:U(this.expressionInfos)})}};d([p()],w2.prototype,"columnTemplates",void 0),d([p({type:[Uge],json:{write:!0}})],w2.prototype,"expressionInfos",void 0),w2=n8=d([A("esri.widgets.FeatureTable.support.TableTemplate")],w2);const kYe=w2;let qf=class extends he{constructor(e){super(e),this._viewpointHandle=null,this.group=null}initialize(){this.addHandles(ui(()=>{var e;return(e=this.view)==null?void 0:e.ui},"expand",e=>{const{target:i}=e;i&&i!==this&&i.expanded&&i.group&&i.group===this.group&&this._collapse()}))}destroy(){this.removeAllHandles(),this._viewpointHandle=null,this.view=null}set autoCollapse(e){this._set("autoCollapse",e),this._watchViewpoint()}set expanded(e){const i=!!e;this._set("expanded",i);const r=this.get("view.ui");r&&r.emit("expand",{target:this}),this._viewpointHandleChange(i)}get state(){return this.get("view.ready")?"ready":"disabled"}set view(e){this._get("view")!==e&&(this._set("view",e),e&&tn(()=>e.ready,()=>{this.view===e&&this._watchViewpoint()},{once:!0,initial:!0}))}_viewpointHandleChange(e){this._viewpointHandle&&(e?tn(()=>{var i;return(i=this.view)==null?void 0:i.stationary},()=>{var i;return(i=this._viewpointHandle)==null?void 0:i.resume()},{once:!0,initial:!0}):this._viewpointHandle.pause())}_watchViewpoint(){const e="viewpoint";this.removeHandles(e),this._viewpointHandle=null;const{autoCollapse:i,view:r}=this;if(!r||!i)return;const n=kle(()=>r.type==="3d"?r.camera:r.viewpoint,()=>this._collapse());this.addHandles(n,e),this._viewpointHandle=n}_collapse(){this.expanded=!1}};d([p({value:!1})],qf.prototype,"autoCollapse",null),d([p({value:!1})],qf.prototype,"expanded",null),d([p()],qf.prototype,"group",void 0),d([p({readOnly:!0})],qf.prototype,"state",null),d([p({value:null})],qf.prototype,"view",null),qf=d([A("esri.widgets.Expand.ExpandViewModel")],qf);const Gge=qf;function BC(t){return e=>{e.hasOwnProperty("_delegatedEventNames")||(e._delegatedEventNames=e._delegatedEventNames?e._delegatedEventNames.slice():[]);const i=e._delegatedEventNames,r=Array.isArray(t)?t:PYe(t);i.push(...r)}}function PYe(t){return t.split(",").map(e=>e.trim())}function bI(t){return t&&typeof t.render=="function"}function OYe(t){return t&&typeof t.postMixInProperties=="function"&&typeof t.buildRendering=="function"&&typeof t.postCreate=="function"&&typeof t.startup=="function"}const Zo="esri-expand",hn={base:`${Zo} esri-widget`,modeAuto:`${Zo}--auto`,modeDrawer:`${Zo}--drawer`,modeFloating:`${Zo}--floating`,container:`${Zo}__container`,containerExpanded:`${Zo}__container--expanded`,panel:`${Zo}__panel`,button:"esri-widget--button",text:"esri-icon-font-fallback-text",icon:"esri-collapse__icon",iconExpanded:`${Zo}__icon--expanded`,iconNumber:`${Zo}__icon-number`,iconNumberExpanded:`${Zo}__icon-number--expanded`,expandIcon:"esri-icon-expand",collapseIcon:"esri-icon-collapse",content:`${Zo}__content`,contentExpanded:`${Zo}__content--expanded`,expandMask:`${Zo}__mask`,expandMaskExpanded:`${Zo}__mask--expanded`};let Wi=class extends di{constructor(e,i){super(e,i),this.closeOnEsc=!0,this.collapseIcon=null,this.collapseTooltip="",this.content="",this.expandTooltip="",this.iconClass=null,this.icon=null,this.iconNumber=0,this.messages=null,this.messagesCommon=null,this.mode="auto",this.viewModel=new Gge,this._handleKeyDown=r=>{const{closeOnEsc:n,_toggleButtonEl:s,expanded:o}=this;!o||!n||r.target===s||r.key!=="Escape"||(typeof n=="function"?n(r):n)&&(this.expanded=!1,s==null||s.focus())}}loadDependencies(){return Zd({icon:()=>W(()=>import("./calcite-icon-dc1254b1.js"),["./calcite-icon-dc1254b1.js","./icon-55c3c703.js","./observers-c8819292.js"],import.meta.url)})}get contentId(){return`${this.id}_controls_content`}get expandTitle(){const{expanded:e,messagesCommon:i,collapseTooltip:r,expandTooltip:n}=this;return(e?r||(i==null?void 0:i.collapse):n||(i==null?void 0:i.expand))??""}get autoCollapse(){return this.viewModel.autoCollapse}set autoCollapse(e){this.viewModel.autoCollapse=e}get collapseIconClass(){return hn.collapseIcon}set collapseIconClass(e){this._overrideIfSome("collapseIconClass",e)}get expanded(){return this.viewModel.expanded}set expanded(e){this.viewModel.expanded=e}get expandIconClass(){return bI(this.content)?this.content.iconClass:hn.expandIcon}set expandIconClass(e){this._overrideIfSome("expandIconClass",e)}get expandIcon(){return bI(this.content)?this.content.icon:void 0}set expandIcon(e){this._overrideIfSome("expandIcon",e)}get group(){return this.viewModel.group}set group(e){this.viewModel.group=e}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}expand(){this.viewModel.expanded=!0}collapse(){this.viewModel.expanded=!1}toggle(){this.viewModel.expanded=!this.viewModel.expanded}render(){const{mode:e}=this,i={[hn.modeAuto]:e==="auto",[hn.modeDrawer]:e==="drawer",[hn.modeFloating]:e==="floating"};return M("div",{class:this.classes(hn.base,i),onkeydown:this._handleKeyDown},this._renderMask(),this._renderContainer())}_renderContainer(){const{expanded:e}=this,i={[hn.containerExpanded]:e};return M("div",{class:this.classes(hn.container,i)},this._renderPanel(),this._renderContent())}_renderMask(){const{expanded:e}=this,i={[hn.expandMaskExpanded]:e};return M("div",{bind:this,onclick:this._toggle,class:this.classes(hn.expandMask,i)})}_renderBadgeNumber(){const{expanded:e,iconNumber:i}=this;return i&&!e?M("span",{key:"expand__icon-number",class:hn.iconNumber},i):null}_renderPanelNumber(){const{iconNumber:e,expanded:i}=this;return e&&i?M("span",{key:"expand__expand-icon-number",class:this.classes(hn.iconNumber,hn.iconNumberExpanded)},e):null}_renderIcon(){const e=(this.expanded?this.collapseIcon:this.expandIcon)??"";return M("calcite-icon",{key:"icon",icon:e,scale:"s"})}_renderLegacyIcon(){const{collapseIconClass:e,expandIconClass:i,expanded:r}=this,n={[hn.iconExpanded]:r};return i!=null&&(n[i]=!r),e!=null&&(n[e]=e===i||r),M("span",{key:"legacy-icon","aria-hidden":"true",class:this.classes(hn.icon,n)})}_renderTitle(){return M("span",{class:hn.text},this.expandTitle)}_renderExpandButton(){const{expanded:e,expandTitle:i,expandIcon:r,collapseIcon:n,contentId:s}=this;return M("div",{afterCreate:this._storeToggleButtonEl,"aria-controls":s,"aria-expanded":e?"true":"false",bind:this,class:hn.button,onclick:this._toggle,onkeydown:this._toggle,role:"button",tabindex:"0",title:i},this._renderBadgeNumber(),!e&&r!=null||e&&n!=null?this._renderIcon():this._renderLegacyIcon(),this._renderTitle())}_renderPanel(){return M("div",{class:hn.panel},this._renderExpandButton(),this._renderPanelNumber())}_renderContent(){const{expanded:e,contentId:i,content:r}=this,n={[hn.contentExpanded]:e},s={id:i,role:"region",class:this.classes(hn.content,n)};return typeof r=="string"?M("div",{key:"content__string",innerHTML:r,...s}):bI(r)?M("div",{key:"content__widget",...s},r.render()):r instanceof HTMLElement?M("div",{key:"content__html-element",bind:r,afterCreate:this._attachToNode,...s}):OYe(r)?M("div",{key:"content__node",bind:r.domNode,afterCreate:this._attachToNode,...s}):null}_toggle(){this.toggle()}_attachToNode(e){const i=this;e.appendChild(i)}_storeToggleButtonEl(e){this._toggleButtonEl=e}};d([p({readOnly:!0})],Wi.prototype,"contentId",null),d([p({readOnly:!0})],Wi.prototype,"expandTitle",null),d([p()],Wi.prototype,"autoCollapse",null),d([p()],Wi.prototype,"closeOnEsc",void 0),d([p()],Wi.prototype,"collapseIconClass",null),d([p()],Wi.prototype,"collapseIcon",void 0),d([p()],Wi.prototype,"collapseTooltip",void 0),d([p()],Wi.prototype,"content",void 0),d([p()],Wi.prototype,"expanded",null),d([p()],Wi.prototype,"expandIconClass",null),d([p()],Wi.prototype,"expandIcon",null),d([p()],Wi.prototype,"expandTooltip",void 0),d([p()],Wi.prototype,"group",null),d([p()],Wi.prototype,"iconClass",void 0),d([p()],Wi.prototype,"icon",void 0),d([p()],Wi.prototype,"iconNumber",void 0),d([p()],Wi.prototype,"label",null),d([p(),ut("esri/widgets/Expand/t9n/Expand")],Wi.prototype,"messages",void 0),d([p(),ut("esri/t9n/common")],Wi.prototype,"messagesCommon",void 0),d([p()],Wi.prototype,"mode",void 0),d([p()],Wi.prototype,"view",null),d([p({type:Gge})],Wi.prototype,"viewModel",void 0),d([wr()],Wi.prototype,"_toggle",null),Wi=d([A("esri.widgets.Expand")],Wi);const LYe=Wi,LT=-1;let od=class extends he{constructor(e){super(e),this._from=null,this._to=null,this._final=null,this._current=[],this._time=0,this.duration=ee("mapview-transitions-duration"),this.effects=[]}set effect(e){if(this._get("effect")!==(e=e||"")){this._set("effect",e);try{this._transitionTo(fQ(e))}catch(i){this._transitionTo([]),ie.getLogger(this).warn("Invalid Effect",{effect:e,error:i})}}}get hasEffects(){return this.transitioning||!!this.effects.length}set scale(e){this._updateForScale(e)}get transitioning(){return this._to!==null}canTransitionTo(e){try{return this.scale>0&&mQ(this._current,fQ(e),this.scale)}catch{return!1}}transitionStep(e,i){this._applyTimeTransition(e),this._updateForScale(i)}endTransitions(){this._applyTimeTransition(this.duration)}_transitionTo(e){this.scale>0&&mQ(this._current,e,this.scale)?(this._final=e,this._to=U(e),RYe(this._current,this._to,this.scale),this._from=U(this._current),this._time=0):(this._from=this._to=this._final=null,this._current=e),this._set("effects",this._current[0]?U(this._current[0].effects):[])}_applyTimeTransition(e){if(!(this._to&&this._from&&this._current&&this._final))return;this._time+=e;const i=Math.min(1,this._time/this.duration);for(let r=0;r<this._current.length;r++){const n=this._current[r],s=this._from[r],o=this._to[r];n.scale=FYe(s.scale,o.scale,i);for(let a=0;a<n.effects.length;a++){const l=n.effects[a],c=s.effects[a],u=o.effects[a];l.interpolate(c,u,i)}}i===1&&(this._current=this._final,this._set("effects",this._current[0]?U(this._current[0].effects):[]),this._from=this._to=this._final=null)}_updateForScale(e){if(this._set("scale",e),this._current.length===0)return;const i=this._current,r=this._current.length-1;let n,s,o=1;if(i.length===1||e>=i[0].scale)s=n=i[0].effects;else if(e<=i[r].scale)s=n=i[r].effects;else for(let a=0;a<r;a++){const l=i[a],c=i[a+1];if(l.scale>=e&&c.scale<=e){o=(e-l.scale)/(c.scale-l.scale),n=l.effects,s=c.effects;break}}for(let a=0;a<this.effects.length;a++)this.effects[a].interpolate(n[a],s[a],o)}};function fQ(t){const e=f9(t)||[];return DYe(e)?[{scale:LT,effects:e}]:e}function mQ(t,e,i){var r,n,s,o;return!((r=t[0])!=null&&r.effects)||!((n=e[0])!=null&&n.effects)?!0:!((((s=t[0])==null?void 0:s.scale)===LT||((o=e[0])==null?void 0:o.scale)===LT)&&(t.length>1||e.length>1)&&i<=0)&&Whe(t[0].effects,e[0].effects)}function RYe(t,e,i){const r=t.length>e.length?t:e,n=t.length>e.length?e:t,s=n[n.length-1],o=(s==null?void 0:s.scale)??i,a=(s==null?void 0:s.effects)??[];for(let l=n.length;l<r.length;l++)n.push({scale:o,effects:[...a]});for(let l=0;l<r.length;l++)n[l].scale=n[l].scale===LT?i:n[l].scale,r[l].scale=r[l].scale===LT?i:r[l].scale,Jhe(n[l].effects,r[l].effects)}function FYe(t,e,i){return t+(e-t)*i}function DYe(t){const e=t[0];return!!e&&"type"in e}d([p()],od.prototype,"_to",void 0),d([p()],od.prototype,"duration",void 0),d([p({value:""})],od.prototype,"effect",null),d([p({readOnly:!0})],od.prototype,"effects",void 0),d([p({readOnly:!0})],od.prototype,"hasEffects",null),d([p({value:0})],od.prototype,"scale",null),d([p({readOnly:!0})],od.prototype,"transitioning",null),od=d([A("esri.layers.effects.EffectView")],od);function Fxt(t){var i;const e=t.layer;return"floorInfo"in e&&((i=e.floorInfo)!=null&&i.floorField)&&"floors"in t.view?Hge(t.view.floors,e.floorInfo.floorField):null}function gQ(t,e){var i;return"floorInfo"in e&&((i=e.floorInfo)!=null&&i.floorField)?Hge(t,e.floorInfo.floorField):null}function Hge(t,e){if(!(t!=null&&t.length))return null;const i=t.filter(r=>r!=="").map(r=>`'${r}'`);return i.push("''"),`${e} IN (${i.join(",")}) OR ${e} IS NULL`}function Dxt(t,e,i){return e.flatten(({sublayers:n})=>n).length!==t.length?!0:!!t.some(n=>n.originIdOf("minScale")>i||n.originIdOf("maxScale")>i||n.originIdOf("renderer")>i||n.originIdOf("labelingInfo")>i||n.originIdOf("opacity")>i||n.originIdOf("labelsVisible")>i||n.originIdOf("source")>i)||!qge(t,e)}function NYe(t,e,i){return!!t.some(r=>{const n=r.source;return!(!n||n.type==="map-layer"&&n.mapLayerId===r.id&&(n.gdbVersion==null||n.gdbVersion===i))||r.originIdOf("renderer")>Ye.SERVICE||r.originIdOf("labelingInfo")>Ye.SERVICE||r.originIdOf("opacity")>Ye.SERVICE||r.originIdOf("labelsVisible")>Ye.SERVICE})||!qge(t,e)}function qge(t,e){if(!t||!t.length||e==null)return!0;const i=e.slice().reverse().flatten(({sublayers:s})=>s&&s.toArray().reverse()).map(s=>s.id).toArray();if(t.length>i.length)return!1;let r=0;const n=i.length;for(const{id:s}of t){for(;r<n&&i[r]!==s;)r++;if(r>=n)return!1}return!0}function Nxt(t){return!!t&&t.some(e=>e.minScale!=null||e.layerDefinition&&e.layerDefinition.minScale!=null)}const VYe={visible:"visibleSublayers",definitionExpression:"layerDefs",labelingInfo:"hasDynamicLayers",labelsVisible:"hasDynamicLayers",opacity:"hasDynamicLayers",minScale:"visibleSublayers",maxScale:"visibleSublayers",renderer:"hasDynamicLayers",source:"hasDynamicLayers"};let Na=class extends cn(he){constructor(e){super(e),this.floors=null,this.scale=0}destroy(){this.layer=null}get dynamicLayers(){if(!this.hasDynamicLayers)return null;const e=this.visibleSublayers.map(i=>{const r=gQ(this.floors,i);return i.toExportImageJSON(r)});return e.length?JSON.stringify(e):null}get hasDynamicLayers(){return this.layer&&NYe(this.visibleSublayers,this.layer.serviceSublayers,this.layer.gdbVersion)}set layer(e){this._get("layer")!==e&&(this._set("layer",e),this.handles.remove("layer"),e&&this.handles.add([e.allSublayers.on("change",()=>this.notifyChange("visibleSublayers")),e.on("sublayer-update",i=>this.notifyChange(VYe[i.propertyName]))],"layer"))}get layers(){const e=this.visibleSublayers;return e?e.length?"show:"+e.map(i=>i.id).join(","):"show:-1":null}get layerDefs(){var r;const e=!!((r=this.floors)!=null&&r.length),i=this.visibleSublayers.filter(n=>n.definitionExpression!=null||e&&n.floorInfo!=null);return i.length?JSON.stringify(i.reduce((n,s)=>{const o=gQ(this.floors,s),a=npe(o,s.definitionExpression);return a!=null&&(n[s.id]=a),n},{})):null}get version(){this.commitProperty("layers"),this.commitProperty("layerDefs"),this.commitProperty("dynamicLayers"),this.commitProperty("timeExtent");const e=this.layer;return e&&(e.commitProperty("dpi"),e.commitProperty("imageFormat"),e.commitProperty("imageTransparency"),e.commitProperty("gdbVersion")),(this._get("version")||0)+1}get visibleSublayers(){const e=[];if(!this.layer)return e;const i=this.layer.sublayers,r=s=>{const o=this.scale,a=o===0,l=s.minScale===0||o<=s.minScale,c=s.maxScale===0||o>=s.maxScale;s.visible&&(a||l&&c)&&(s.sublayers?s.sublayers.forEach(r):e.unshift(s))};i&&i.forEach(r);const n=this._get("visibleSublayers");return!n||n.length!==e.length||n.some((s,o)=>e[o]!==s)?e:n}toJSON(){const e=this.layer;let i={dpi:e.dpi,format:e.imageFormat,transparent:e.imageTransparency,gdbVersion:e.gdbVersion||null};return this.hasDynamicLayers&&this.dynamicLayers?i.dynamicLayers=this.dynamicLayers:i={...i,layers:this.layers,layerDefs:this.layerDefs},i}};d([p({readOnly:!0})],Na.prototype,"dynamicLayers",null),d([p()],Na.prototype,"floors",void 0),d([p({readOnly:!0})],Na.prototype,"hasDynamicLayers",null),d([p()],Na.prototype,"layer",null),d([p({readOnly:!0})],Na.prototype,"layers",null),d([p({readOnly:!0})],Na.prototype,"layerDefs",null),d([p({type:Number})],Na.prototype,"scale",void 0),d([p(pze)],Na.prototype,"timeExtent",void 0),d([p({readOnly:!0})],Na.prototype,"version",null),d([p({readOnly:!0})],Na.prototype,"visibleSublayers",null),Na=d([A("esri.layers.mixins.ExportImageParameters")],Na);function Wge(t){return t==null||t.type==="simple"||t.type==="unique-value"||t.type==="class-breaks"||t.type==="dictionary"||t.type==="heatmap"}function zxt(t,e){if(t==null)return null;if(!Wge(t))return new N("renderer-conversion-3d:unsupported-renderer",`Unsupported renderer of type '${t.type||t.declaredClass}'`,{renderer:t});switch(t.type){case"simple":return zYe(t);case"unique-value":return jYe(t,e);case"class-breaks":return BYe(t);case"dictionary":case"heatmap":return null}return null}function WG(t,e){if(!e)return null;let i;if(i=Array.isArray(e)?e:[e],i.length>0){const r=i.map(s=>s.details.symbol.type||s.details.symbol.declaredClass).filter(s=>!!s);r.sort();const n=[];return r.forEach((s,o)=>{o!==0&&s===r[o-1]||n.push(s)}),new N("renderer-conversion-3d:unsupported-symbols",`Renderer contains symbols (${n.join(", ")}) which are not supported in 3D`,{renderer:t,symbolErrors:i})}return null}function zYe(t){return WG(t,Av(t.symbol).error)}function jYe(t,e){var s;const i={...gb,...e},r=(s=t.uniqueValueInfos)==null?void 0:s.map(o=>Av(o.symbol,i).error).filter(Dt),n=Av(t.defaultSymbol,i);return n.error&&(r==null||r.unshift(n.error)),WG(t,r)}function BYe(t){const e=t.classBreakInfos.map(r=>Av(r.symbol).error).filter(Dt),i=Av(t.defaultSymbol);return i.error&&e.unshift(i.error),WG(t,e)}var On;(function(t){t[t.size=22]="size",t[t.lineWidth=50]="lineWidth",t[t.maxSize=120]="maxSize",t[t.maxOutlineSize=80]="maxOutlineSize",t[t.tallSymbolWidth=20]="tallSymbolWidth"})(On||(On={}));const s8={fill:[{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 Z"}],squareFill:[{type:"path",path:"M -10,-10 L 10,-10 L 10,10 L -10,10 L -10,-10 Z"}],pathSymbol3DLayer:[{type:"path",path:"M 3,12 L 12,0 L 11,-2 L -4,5 L -1,5 L 1,7 L 3,10 L 3,12 Z"},{type:"circle",cx:-2,cy:10,r:5}],extrudeSymbol3DLayer:[{type:"path",path:"M -7,-5 L -2,0 L -2,7 L -7,3 L -7,-5 Z"},{type:"path",path:"M -2,0 L -2,7 L 10,-3 L 10,-10 L -2,0 Z"},{type:"path",path:"M -7,-5 L -2,0 L 10,-10 L -2,-10 L -7,-5 Z"}],cone:[{type:"path",path:"M 0,-10 L -8,5 L -4,6.5 L 0,7 L 4,6.5 L 8,5 Z"}],tallCone:[{type:"path",path:"M 0,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 0,-9 Z"}],invertedCone:[{type:"path",path:"M 0,7 L -8,-8 L 8,-8 Z"},{type:"path",path:"M -8,-8 L -4,-9.5 L 0,-10 L 4,-9.5 L 8,-8 L 4,-6.5 L 0,-6 L -4,-6.5 Z"}],cube:[{type:"path",path:"M -10,-7 L 0,-12 L 10,-7 L 0,-2 L -10,-7 Z"},{type:"path",path:"M -10,-7 L 0,-2 L 0,12 L -10,7 L -10,-7 Z"},{type:"path",path:"M 0,-2 L 10,-7 L 10,7 L 0,12 L 0,-2 Z"}],tallCube:[{type:"path",path:"M -3.5,-8.5 L 0,-9.5 L 3.5,-8.5 L 0,-7.5 L -3.5,-8.5 Z"},{type:"path",path:"M -3.5,-8.5 L 0,-7.5 L 0,9 L -3.5,8 L -3.5,-8.5 Z"},{type:"path",path:"M 0,-7.5 L 3.5,-8.5 L 3.5,8 L 0,9 L 0,-7.5 Z"}],cylinder:[{type:"path",path:"M -8,-9 L -8,7 L -4,8.5 L 0,9 L 4,8.5 L 8,7 L 8,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:8,ry:2}],tallCylinder:[{type:"path",path:"M -3.5,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 3.5,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:3.5,ry:1}],diamond:[{type:"path",path:"M 0,-10 L 10,-1 L -1,1 L 0,-10 Z"},{type:"path",path:"M 0,-10 L -1,1 L -8,-1 L 0,-10 Z"},{type:"path",path:"M -1,1 L 0,10 L -8,-1 L -1,1 Z"},{type:"path",path:"M -1,0 L 0,10 L 10,-1 L -1,1 Z"}],tetrahedron:[{type:"path",path:"M 0,-10 L 10,7 L 0,0 L 0,-10 Z"},{type:"path",path:"M 0,-10 L 0,0 L -8,7 L 0,-10 Z"},{type:"path",path:"M 10,7 L 0,0 L -8,7 L 10,7 Z"}]};function UYe(t,e,i){const r=On.size;let n=r,s=r;t<1?n*=.75:t>1&&(s*=1.25);const o=0,a=0;let l=r,c=r;return e&&i&&(n=s=l=c=0),[{type:"path",path:[{command:"M",values:[l,o]},{command:"L",values:[i?l:.875*l,o]},{command:"L",values:[i?n-.5*l:a,s-.5*c]},{command:"L",values:[n-.5*l,s-.5*c]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[l,o]},{command:"L",values:[l,e?o:.125*c]},{command:"L",values:[n-.5*l,e?s-.5*c:c]},{command:"L",values:[n-.5*l,s-.5*c]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[n-.5*l,s-.5*c]},{command:"L",values:[i?n-.5*l:a,s-.5*c]},{command:"L",values:[i?n-.5*l:a,e?s-.5*c:c]},{command:"L",values:[n-.5*l,e?s-.5*c:c]},{command:"Z",values:[]}]}]}function GYe(t){const e=On.size,i=.5*t,r=0,n=0;return[{type:"path",path:[{command:"M",values:[n,.7*e*.5]},{command:"L",values:[.3*e,.7*e]},{command:"L",values:[.3*e,.7*e+i]},{command:"L",values:[n,.7*e+i-.7*e*.5]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.3*e,.7*e]},{command:"L",values:[.3*e,.7*e+i]},{command:"L",values:[e,i]},{command:"L",values:[e,r]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.3*e,r]},{command:"L",values:[e,r]},{command:"L",values:[.3*e,.7*e]},{command:"L",values:[n,.7*e*.5]},{command:"Z",values:[]}]}]}function HYe(){return[{type:"path",path:"M80,80.2v-27c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4C8.3,59.3,5.7,58,3.9,56c-1.1-1.2-2.4-2.1-3.9-2.8v27"},{type:"path",path:"M11,59.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8v-24c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-1.1-1.2-2.4-2.1-3.9-2.8v24c1.5,0.7,2.8,1.6,3.9,2.8C5.7,58,8.3,59.3,11,59.4z"},{type:"path",path:"M11,35.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8V3.6c-1.5,0.7-2.8,1.6-3.9,2.8c-2.2,2.1-4.6,3.4-7.1,3.4s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6S42.5,9.9,40,9.9s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.5,0-5-1.3-7.1-3.4C2.8,5.3,1.4,4.3,0,3.6v25.6c1.5,0.7,2.8,1.6,3.9,2.8C5.7,34.1,8.3,35.3,11,35.4z"}]}function qYe(t,e){let i=e?On.tallSymbolWidth:t;const r=t,n=e?4:6;i<=On.size?i-=.5*n:i-=n;const s=0,o=0,a=e?.35*i:.5*i;return[{type:"path",path:[{command:"M",values:[.5*i,s]},{command:"L",values:[i,.5*a]},{command:"L",values:[.5*i,a]},{command:"L",values:[o,.5*a]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[s,.5*a]},{command:"L",values:[.5*i,a]},{command:"L",values:[.5*i,r]},{command:"L",values:[o,r-.5*a]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.5*i,a]},{command:"L",values:[.5*i,r]},{command:"L",values:[i,r-.5*a]},{command:"L",values:[i,.5*a]},{command:"Z",values:[]}]}]}function WYe(t,e){let i=e?On.tallSymbolWidth:t;const r=t,n=e?4:6;i<=On.size?i-=.5*n:i-=n;const s=.5*i,o=.15*i,a=0,l=r-o;return[{type:"ellipse",cx:.5*i,cy:l,rx:s,ry:o},{type:"path",path:[{command:"M",values:[a,o]},{command:"L",values:[a,l]},{command:"L",values:[i,l]},{command:"L",values:[i,o]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*i,cy:o,rx:s,ry:o}]}function JYe(t,e){let i=e?On.tallSymbolWidth:t;const r=t,n=e?4:6;i<=On.size?i-=.5*n:i-=n;const s=.15*i,o=r-s;return[{type:"ellipse",cx:.5*i,cy:o,rx:.5*i,ry:s},{type:"path",path:[{command:"M",values:[.5*i,0]},{command:"L",values:[i,o]},{command:"L",values:[0,o]},{command:"Z",values:[]}]}]}function ZYe(t){let e=t;const i=t,r=6;e<On.size?e-=.5*r:e-=r;const n=.15*e,s=0;return[{type:"path",path:[{command:"M",values:[0,s]},{command:"L",values:[e,s]},{command:"L",values:[.5*e,i-n]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*e,cy:s,rx:.5*e,ry:n}]}function YYe(t){let e=t;const i=t,r=4;e<On.size?e-=.5*r:e-=r;const n=0,s=0,o=e,a=i,l=Math.floor(t/10)-1||1;return[{type:"path",path:[{command:"M",values:[.45*o,n]},{command:"L",values:[o,.5*a-l]},{command:"L",values:[.45*o-l,.5*a+l]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*o,n]},{command:"L",values:[.45*o-l,.5*a+l]},{command:"L",values:[s,.5*a-l]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[s,.5*a-l]},{command:"L",values:[.45*o-l,.5*a+l]},{command:"L",values:[.45*o,i]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*o,i]},{command:"L",values:[o,.5*a-l]},{command:"L",values:[.45*o-l,.5*a+l]},{command:"Z",values:[]}]}]}function KYe(t){const e=t,i=2;let r=t;r<On.size?r-=.5*i:r-=i;const n=0,s=0;return[{type:"path",path:[{command:"M",values:[.45*e,n]},{command:"L",values:[e,r]},{command:"L",values:[.45*e,.6*r]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*e,n]},{command:"L",values:[.45*e,.6*r]},{command:"L",values:[s,r]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[s,r]},{command:"L",values:[.45*e,.6*r]},{command:"L",values:[e,r]},{command:"Z",values:[]}]}]}function tg(t,e){return Math.round(Math.min(Math.max(t+255*e*.75,0),255))}function jxt(t,e){if(t==null)return new ce;if("type"in t&&(t.type==="linear"||t.type==="pattern"))return t;const i=new ce(t);return new ce([tg(i.r,e),tg(i.g,e),tg(i.b,e),i.a])}const XYe="http://www.w3.org/2000/svg";let QYe=0,eKe=0;const yQ=ee("android"),tKe=ee("chrome")||yQ&&yQ>=4?"auto":"optimizeLegibility",iKe={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},rKe=/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g;let vr={},oi={};const vQ={solid:"none",shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]},nKe=Math.PI;let sKe=1;function fw(t,e){const i=t*(nKe/180);return Math.abs(e*Math.sin(i))+Math.abs(e*Math.cos(i))}function Jge(t){return t.map(e=>`${e.command} ${e.values.join(" ")}`).join(" ").trim()}function JG(t,e,i,r){if(t){if(t.type==="circle")return M("circle",{fill:e,"fill-rule":"evenodd",stroke:i.color,"stroke-width":i.width,"stroke-linecap":i.cap,"stroke-linejoin":i.join,"stroke-dasharray":i.dashArray,"stroke-dashoffset":i.dashOffset,"stroke-miterlimit":"4",cx:t.cx,cy:t.cy,r:t.r});if(t.type==="ellipse")return M("ellipse",{fill:e,"fill-rule":"evenodd",stroke:i.color,"stroke-width":i.width,"stroke-linecap":i.cap,"stroke-linejoin":i.join,"stroke-dasharray":i.dashArray,"stroke-miterlimit":"4",cx:t.cx,cy:t.cy,rx:t.rx,ry:t.ry});if(t.type==="rect")return M("rect",{fill:e,"fill-rule":"evenodd",stroke:i.color,"stroke-width":i.width,"stroke-linecap":i.cap,"stroke-linejoin":i.join,"stroke-dasharray":i.dashArray,"stroke-miterlimit":"4",x:t.x,y:t.y,width:t.width,height:t.height});if(t.type==="image")return M("image",{href:t.src,x:t.x,y:t.y,width:t.width,height:t.height,preserveAspectRatio:"none"});if(t.type==="path"){const n=typeof t.path!="string"?Jge(t.path):t.path;return M("path",{fill:e,"fill-rule":"evenodd",stroke:i.color,"stroke-width":i.width,"stroke-linecap":i.cap,"stroke-linejoin":i.join,"stroke-dasharray":i.dashArray,"stroke-miterlimit":"4",d:n})}if(t.type==="text")return lo(r),M("text",{"dominant-baseline":r.dominantBaseline,fill:e,"fill-rule":"evenodd",stroke:i.color,"stroke-width":i.width,"stroke-linecap":i.cap,"stroke-linejoin":i.join,"stroke-dasharray":i.dashArray,"stroke-miterlimit":"4","text-anchor":r.align,"text-decoration":r.decoration,kerning:r.kerning,rotate:r.rotate,"text-rendering":tKe,"font-style":r.font.style,"font-variant":r.font.variant,"font-weight":r.font.weight,"font-size":r.font.size,"font-family":r.font.family,x:t.x,y:t.y},t.text)}return null}function ZG(t){const e={fill:"none",pattern:null,linearGradient:null};if(t){if("type"in t&&t.type==="pattern"){const i="patternId-"+ ++QYe;e.fill=`url(#${i})`,e.pattern={id:i,x:t.x,y:t.y,width:t.width,height:t.height,image:{x:0,y:0,width:t.width,height:t.height,href:t.src}}}else if("type"in t&&t.type==="linear"){const i="linearGradientId-"+ ++eKe;e.fill=`url(#${i})`,e.linearGradient={id:i,x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2,stops:t.colors.map(r=>({offset:r.offset,color:r.color&&new ce(r.color).toString()}))}}else if(t){const i=new ce(t);e.fill=i.toString()}}return e}function YG(t){const e={color:"none",width:1,cap:"butt",join:"4",dashArray:"none",dashOffset:"0"};if(t&&(t.width!=null&&(e.width=t.width),t.cap&&(e.cap=t.cap),t.join&&(e.join=t.join.toString()),t.color&&(e.color=new ce(t.color).toString()),t.dashArray&&(e.dashArray=t.dashArray),t.dashArray&&(e.dashOffset=t.dashoffset),t.style)){let i=null;if(t.style in vQ&&(i=vQ[t.style]),Array.isArray(i)){i=i.slice(0);const r=t.width??0;for(let n=0;n<i.length;++n)i[n]*=r;if(t.cap!=="butt"){for(let n=0;n<i.length;n+=2)i[n]-=r,i[n]<1&&(i[n]=1);for(let n=1;n<i.length;n+=2)i[n]+=r}i=i.join(",")}e.dashArray=i}return e}function Zge(t,e){const i={align:null,decoration:null,kerning:null,rotate:null,font:{style:null,variant:null,weight:null,size:null,family:null}};if(t){const r=t.alignBaseline,n=r==="baseline"?"auto":r==="top"?"text-top":r==="bottom"?"hanging":r;i.align=t.align,i.dominantBaseline=n,i.decoration=t.decoration,i.kerning=t.kerning?"auto":"0",i.rotate=t.rotated?"90":"0",lo(e),i.font.style=e.style||"normal",i.font.variant=e.variant||"normal",i.font.weight=e.weight||"normal",i.font.size=e.size&&e.size.toString()||"10pt",i.font.family=e.family||"serif"}return i}function Yge(t){const{pattern:e,linearGradient:i}=t;if(e)return M("pattern",{id:e.id,patternUnits:"userSpaceOnUse",x:e.x,y:e.y,width:e.width,height:e.height},M("image",{x:e.image.x,y:e.image.y,width:e.image.width,height:e.image.height,href:e.image.href}));if(i){const r=i.stops.map((n,s)=>M("stop",{key:`${s}-stop`,offset:n.offset,"stop-color":n.color}));return M("linearGradient",{id:i.id,gradientUnits:"userSpaceOnUse",x1:i.x1,y1:i.y1,x2:i.x2,y2:i.y2},r)}return null}function oKe(t,e){if(!t||t.length===0)return null;const i=[];for(const r of t){const{shape:n,fill:s,stroke:o,font:a}=r,l=ZG(s),c=YG(o),u=n.type==="text"?Zge(n,a):null,h=JG(n,l.fill,c,u);h&&i.push(h)}return M("mask",{id:e,maskUnits:"userSpaceOnUse"},M("g",null,i))}function _Q(t,e,i){return d1(t,SL(t),[e,i])}function bQ(t,e,i,r,n){return IL(t,SL(t),[e,i]),t[4]=t[4]*e-r*e+r,t[5]=t[5]*i-n*i+n,t}function aKe(t,e,i,r){const n=e%360*Math.PI/180;xC(t,SL(t),n);const s=Math.cos(n),o=Math.sin(n),a=t[4],l=t[5];return t[4]=a*s-l*o+r*o-i*s+i,t[5]=l*s+a*o-i*o-r*s+r,t}function _o(t,e){vr&&"left"in vr?(vr.left!=null&&vr.left>t&&(vr.left=t),(vr.right==null||vr.right<t)&&(vr.right=t),(vr.top==null||vr.top>e)&&(vr.top=e),(vr.bottom==null||vr.bottom<e)&&(vr.bottom=e)):vr={left:t,bottom:e,right:t,top:e}}function wQ(t){const e=t.args,i=e.length;let r;switch(t.action){case"M":case"L":case"C":case"S":case"Q":case"T":for(r=0;r<i;r+=2)_o(e[r],e[r+1]);oi.x=e[i-2],oi.y=e[i-1];break;case"H":for(r=0;r<i;++r)_o(e[r],oi.y);oi.x=e[i-1];break;case"V":for(r=0;r<i;++r)_o(oi.x,e[r]);oi.y=e[i-1];break;case"m":{let n=0;for(("x"in oi)||(_o(oi.x=e[0],oi.y=e[1]),n=2),r=n;r<i;r+=2)_o(oi.x+=e[r],oi.y+=e[r+1]);break}case"l":case"t":for(r=0;r<i;r+=2)_o(oi.x+=e[r],oi.y+=e[r+1]);break;case"h":for(r=0;r<i;++r)_o(oi.x+=e[r],oi.y);break;case"v":for(r=0;r<i;++r)_o(oi.x,oi.y+=e[r]);break;case"c":for(r=0;r<i;r+=6)_o(oi.x+e[r],oi.y+e[r+1]),_o(oi.x+e[r+2],oi.y+e[r+3]),_o(oi.x+=e[r+4],oi.y+=e[r+5]);break;case"s":case"q":for(r=0;r<i;r+=4)_o(oi.x+e[r],oi.y+e[r+1]),_o(oi.x+=e[r+2],oi.y+=e[r+3]);break;case"A":for(r=0;r<i;r+=7)_o(e[r+5],e[r+6]);oi.x=e[i-2],oi.y=e[i-1];break;case"a":for(r=0;r<i;r+=7)_o(oi.x+=e[r+5],oi.y+=e[r+6])}}function xQ(t,e,i){const r=iKe[t.toLowerCase()];let n;typeof r=="number"&&(r?e.length>=r&&(n={action:t,args:e.slice(0,e.length-e.length%r)},i.push(n),wQ(n)):(n={action:t,args:[]},i.push(n),wQ(n)))}function lKe(t){const e=(typeof t.path!="string"?Jge(t.path):t.path).match(rKe),i=[];if(vr={},oi={},!e)return null;let r="",n=[];const s=e.length;for(let a=0;a<s;++a){const l=e[a],c=parseFloat(l);isNaN(c)?(r&&xQ(r,n,i),n=[],r=l):n.push(c)}xQ(r,n,i);const o={x:0,y:0,width:0,height:0};return vr&&"left"in vr&&(o.x=vr.left,o.y=vr.top,o.width=vr.right-vr.left,o.height=vr.bottom-vr.top),o}function Kge(t){const e={x:0,y:0,width:0,height:0};if(t.type==="circle")e.x=t.cx-t.r,e.y=t.cy-t.r,e.width=2*t.r,e.height=2*t.r;else if(t.type==="ellipse")e.x=t.cx-t.rx,e.y=t.cy-t.ry,e.width=2*t.rx,e.height=2*t.ry;else if(t.type==="image"||t.type==="rect")e.x=t.x,e.y=t.y,e.width=t.width,e.height=t.height;else if(t.type==="path"){const i=us(lKe(t));e.x=i.x,e.y=i.y,e.width=i.width,e.height=i.height}return e}function Xge(t){const e={x:0,y:0,width:0,height:0};let i=null,r=Number.NEGATIVE_INFINITY,n=Number.NEGATIVE_INFINITY;for(const s of t)i?(i.x=Math.min(i.x,s.x),i.y=Math.min(i.y,s.y),r=Math.max(r,s.x+s.width),n=Math.max(n,s.y+s.height)):(i=e,i.x=s.x,i.y=s.y,r=s.x+s.width,n=s.y+s.height);return i&&(i.width=r-i.x,i.height=n-i.y),i}function o8(t,e,i,r,n,s,o,a,l){let c=(o&&s?fw(s,e):e)/2,u=(o&&s?fw(s,i):i)/2;if(l){const w=l[0],x=l[1];c=(o&&s?fw(s,w):w)/2,u=(o&&s?fw(s,x):x)/2}const h=t.width+r,f=t.height+r,m=mP(),g=mP();let y=!1;if(n&&h!==0&&f!==0){const w=e!==i?e/i:h/f,x=e>i?e:i;let S=1,I=1;isNaN(x)||(w>1?(S=x/h,I=x/w/f):(I=x/f,S=x*w/h)),$0(g,g,bQ(m,S,I,c,u)),y=!0}const v=t.x+(h-r)/2,b=t.y+(f-r)/2;if($0(g,g,_Q(m,c-v,u-b)),!y&&(h>e||f>i)){const w=h/e>f/i,x=(w?e:i)/(w?h:f);$0(g,g,bQ(m,x,x,v,b))}return s&&$0(g,g,aKe(m,s,v,b)),a&&$0(g,g,_Q(m,a[0],a[1])),`matrix(${g[0]},${g[1]},${g[2]},${g[3]},${g[4]},${g[5]})`}function cKe(t,e,i){const r=t==null?void 0:t.effects.find(c=>c.type==="bloom");if(!r)return null;const{strength:n,radius:s}=r,o=n>0?s:0,a=(n+o)*e,l=4*n+1;return M("filter",{id:`bloom${i}`,x:"-100%",y:"-100%",width:"300%",height:"300%",filterUnits:"userSpaceOnUse"},M("feMorphology",{operator:"dilate",radius:(n+.5*o)*(5**(e/100)*(.4+e/100)),in:"SourceGraphic",result:"dilate"}),M("feGaussianBlur",{in:"dilate",stdDeviation:a/25,result:"blur"}),M("feGaussianBlur",{in:"blur",stdDeviation:a/50,result:"intensityBlur"}),M("feComponentTransfer",{in:"SourceGraphic",result:"intensityBrightness"},M("feFuncR",{type:"linear",slope:l}),M("feFuncG",{type:"linear",slope:l}),M("feFuncB",{type:"linear",slope:l})),M("feMerge",null,M("feMergeNode",{in:"intensityBlur"}),M("feMergeNode",{in:"intensityBrightness"}),M("feGaussianBlur",{stdDeviation:n/10})))}function Qge(t,e,i,r={}){var c;const n=[],s=[],o=++sKe,a=cKe(r.effectView,e,o);let l=null;if(a){const u=(c=r.effectView)==null?void 0:c.effects.find(g=>g.type==="bloom"),h=(u.strength?u.strength+u.radius/2:0)/3,f=e+e*h,m=i+i*h;l=[Math.max(f,10),Math.max(m,10)]}for(let u=0;u<t.length;u++){const h=t[u],f=[],m=[];let g=0,y=0,v=0;for(const x of h){const{shape:S,fill:I,stroke:T,font:C,offset:E}=x;r.ignoreStrokeWidth||S.type==="text"||(g+=T&&T.width||0);const $=ZG(I),P=YG(T),k=S.type==="text"?Zge(S,C):null;n.push(Yge($)),f.push(JG(S,$.fill,P,k)),m.push(Kge(S)),E&&(y+=E[0],v+=E[1])}const b=o8(us(Xge(m)),e,i,g,r.scale??!1,r.rotation,r.useRotationSize??!1,[y,v],l);let w=null;if(r.masking){const x=`mask-${u}`,S=r.masking[u];n.push(oKe(S,x)),w=`url(#${x})`}s.push(w?M("g",{mask:w},M("g",{transform:b},f)):M("g",{transform:b},f))}return r.useRotationSize&&r.rotation&&(e=fw(r.rotation,e),i=fw(r.rotation,i)),a&&(lo(l),e=l[0],i=l[1]),M("svg",{xmlns:XYe,width:e,height:i,style:"display: block;","aria-labelledby":r.ariaLabel,role:"img",focusable:!1},a,M("defs",null,n),a?M("g",{filter:`url(#bloom${o})`},s):s)}const SQ=dP();function uKe(t,e){SQ.append(t,e),SQ.detach(e)}function UC(t,e,i){const r=Math.ceil(e[0]),n=Math.ceil(e[1]);if(!t.some(o=>!!o.length))return null;const s=i&&i.node||document.createElement("div");return i.opacity!=null&&(s.style.opacity=i.opacity.toString()),i.effectView!=null&&(s.style.filter=bT(i.effectView)),uKe(s,()=>Qge(t,r,n,i)),s}function dKe(t,e){t=Math.ceil(t),e=Math.ceil(e);const i=document.createElement("canvas");i.width=t,i.height=e,i.style.width=t+"px",i.style.height=e+"px";const r=i.getContext("2d");return r.clearRect(0,0,t,e),r}function hKe(t,e,i){return t?at(t,{responseType:"image"}).then(r=>{const n=r.data,s=n.width,o=n.height,a=s/o;let l=e;if(i){const c=Math.max(s,o);l=Math.min(l,c)}return{image:n,width:a<=1?Math.ceil(l*a):l,height:a<=1?l:Math.ceil(l/a)}}):Promise.reject(new N("renderUtils: imageDataSize","href not provided."))}function pKe(t,e){return!(!t||e==="ignore")&&(e!=="multiply"||t.r!==255||t.g!==255||t.b!==255||t.a!==1)}function fKe(t,e,i,r,n){switch(n){case"multiply":t[e]*=i[0],t[e+1]*=i[1],t[e+2]*=i[2],t[e+3]*=i[3];break;default:{const s=Pv({r:t[e],g:t[e+1],b:t[e+2]});s.h=r.h,s.s=r.s,s.v=s.v/100*r.v;const o=pg(s);t[e]=o.r,t[e+1]=o.g,t[e+2]=o.b,t[e+3]*=i[3];break}}}function mKe(t,e,i,r,n){return hKe(t,e,n).then(s=>{const o=s.width??e,a=s.height??e;if(s.image&&pKe(i,r)){let l=s.image.width,c=s.image.height;ee("edge")&&/\.svg$/i.test(t)&&(l-=1,c-=1);const u=dKe(o,a);u.drawImage(s.image,0,0,l,c,0,0,o,a);const h=u.getImageData(0,0,o,a),f=[i.r/255,i.g/255,i.b/255,i.a],m=Pv(i);for(let g=0;g<h.data.length;g+=4)fKe(h.data,g,f,m,r);u.putImageData(h,0,0),t=u.canvas.toDataURL("image/png")}else{const l=vt&&vt.findCredential(t);if(l&&l.token){const c=t.includes("?")?"&":"?";t=`${t}${c}token=${l.token}`}}return{url:t,width:o,height:a}}).catch(()=>({url:t,width:e,height:e}))}const eye="esri-relationship-ramp",M_=`${eye}--diamond`,of=`${eye}--square`,gKe="http://www.w3.org/2000/svg",ki={diamondContainer:`${M_}__container`,diamondLeftCol:`${M_}__left-column`,diamondRightCol:`${M_}__right-column`,diamondMidCol:`${M_}__middle-column`,diamondMidColLabel:`${M_}__middle-column--label`,diamondMidColRamp:`${M_}__middle-column--ramp`,squareTable:`${of}__table`,squareTableRow:`${of}__table-row`,squareTableCell:`${of}__table-cell`,squareTableLabel:`${of}__table-label`,squareTableLabelLeftBottom:`${of}__table-label--left-bottom`,squareTableLabelRightBottom:`${of}__table-label--right-bottom`,squareTableLabelLeftTop:`${of}__table-label--left-top`,squareTableLabelRightTop:`${of}__table-label--right-top`};function tye(t,e,i={}){const{focus:r,labels:n}=t,s=!!r,o=yKe(t,e,i),a={justifyContent:"center"},l=ll();return s?M("div",{class:ki.diamondContainer,styles:a},M("div",{class:ki.diamondLeftCol},l?n.right:n.left),M("div",{class:ki.diamondMidCol},M("div",{class:ki.diamondMidColLabel},n.top),o,M("div",{class:ki.diamondMidColLabel},n.bottom)),M("div",{class:ki.diamondRightCol},l?n.left:n.right)):M("div",{class:ki.squareTable},M("div",{class:ki.squareTableRow},M("div",{class:q0(ki.squareTableCell,ki.squareTableLabel,ki.squareTableLabelRightBottom)},l?n.top:n.left),M("div",{class:ki.squareTableCell}),M("div",{class:q0(ki.squareTableCell,ki.squareTableLabel,ki.squareTableLabelLeftBottom)},l?n.left:n.top)),M("div",{class:ki.squareTableRow},M("div",{class:ki.squareTableCell}),o,M("div",{class:ki.squareTableCell})),M("div",{class:ki.squareTableRow},M("div",{class:q0(ki.squareTableCell,ki.squareTableLabel,ki.squareTableLabelRightTop)},l?n.right:n.bottom),M("div",{class:ki.squareTableCell}),M("div",{class:q0(ki.squareTableCell,ki.squareTableLabel,ki.squareTableLabelLeftTop)},l?n.bottom:n.right)))}function IQ(t,e,i){const r=`${i}_arrowStart`,n=`${i}_arrowEnd`,s=t==="left",o={markerStart:null,markerEnd:null};switch(e){case"HL":s?o.markerStart=`url(#${n})`:o.markerEnd=`url(#${r})`;break;case"LL":o.markerStart=`url(#${n})`;break;case"LH":s?o.markerEnd=`url(#${r})`:o.markerStart=`url(#${n})`;break;default:o.markerEnd=`url(#${r})`}return o}function yKe(t,e,i={}){const{focus:r,numClasses:n,colors:s,rotation:o}=t,{opacity:a,effectList:l,ariaLabel:c}=i,u=i.size??60,h=!!r,f=Math.sqrt(u**2+u**2)+(h?0:5),m=[],g=[],y=[],v=(u||75)/n;for(let L=0;L<n;L++){const F=L*v;for(let V=0;V<n;V++){const z=V*v,G=ZG(s[L][V]),H=YG(null),Z={type:"rect",x:z,y:F,width:v,height:v},K=Yge(G);K&&m.push(K);const X=JG(Z,G.fill,H,null);X&&g.push(X),y.push(Kge(Z))}}const b=10,w=15,x=15,S=10;let I=null;h||(I="margin: -15px -15px -18px -15px");const T=IQ("left",r,e),C=IQ("right",r,e),E=Xge(y),$=o8(E,f,f,0,!1,o,!1),P=o8(E,f,f,0,!1,h?-45:null,!1),k={filter:bT(l)??void 0,opacity:a==null?"":`${a}`};return M("div",{styles:k,class:h?ki.diamondMidColRamp:ki.squareTableCell},M("svg",{xmlns:gKe,width:f,height:f,style:I,"aria-labelledBy":c,role:"image",focusable:!1},M("defs",null,M("marker",{id:`${e}_arrowStart`,markerWidth:"10",markerHeight:"10",refX:"5",refY:"5",markerUnits:"strokeWidth",orient:"auto"},M("polyline",{points:"0,0 5,5 0,10",fill:"none",stroke:"#555555","stroke-width":"1"})),M("marker",{id:`${e}_arrowEnd`,markerWidth:"10",markerHeight:"10",refX:"0",refY:"5",markerUnits:"strokeWidth",orient:"auto"},M("polyline",{points:"5,0 0,5 5,10",fill:"none",stroke:"#555555","stroke-width":"1"})),m),M("g",{transform:$},g),M("g",{transform:P},M("line",{fill:"none",stroke:"#555555","stroke-width":"1","marker-start":T.markerStart,"marker-end":T.markerEnd,x1:-b,y1:u-w,x2:-b,y2:w}),M("line",{fill:"none",stroke:"#555555","stroke-width":"1","marker-start":C.markerStart,"marker-end":C.markerEnd,x1:x,y1:u+S,x2:u-x,y2:u+S}))))}function vKe(t){return t=t||globalThis.location.hostname,_Ke.some(e=>(t==null?void 0:t.match(e))!=null)}function TQ(t,e){return t&&(e=e||globalThis.location.hostname)?e.match(iye)!=null||e.match(nye)!=null?t.replace("static.arcgis.com","staticdev.arcgis.com"):e.match(rye)!=null||e.match(sye)!=null?t.replace("static.arcgis.com","staticqa.arcgis.com"):t:t}const iye=/^devext.arcgis.com$/,rye=/^qaext.arcgis.com$/,nye=/^[\w-]*\.mapsdevext.arcgis.com$/,sye=/^[\w-]*\.mapsqa.arcgis.com$/,_Ke=[/^([\w-]*\.)?[\w-]*\.zrh-dev-local.esri.com$/,iye,rye,/^jsapps.esri.com$/,nye,sye];function oye(t,e,i,r){const n=t.name;return n==null?Promise.reject(new N("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference")):t.styleName&&t.styleName==="Esri2DPointSymbolsStyle"?bKe(n,e,r):xhe(t,e,r).then(s=>lye(us(s),n,e,i,Q4e,r))}function aye(t,e){return e.items.find(i=>i.name===t)}function lye(t,e,i,r,n,s){var m;const o=i&&i.portal!=null?i.portal:on.getDefault(),a={portal:o,url:sn(t.baseUrl),origin:"portal-item"},l=aye(e,t.data);if(!l){const g=`The symbol name '${e}' could not be found`;return Promise.reject(new N("symbolstyleutils:symbol-name-not-found",g,{symbolName:e}))}let c=og(n(l,r),a),u=((m=l.thumbnail)==null?void 0:m.href)??null;const h=l.thumbnail&&l.thumbnail.imageData;vKe()&&(c=TQ(c)??"",u=TQ(u));const f={portal:o,url:sn(oB(c)),origin:"portal-item"};return p9(c,s).then(g=>{const y=r==="cimRef"?She(g.data):g.data,v=rhe(y,f);if(v&&Bd(v)){if(u){const b=og(u,a);v.thumbnail=new iv({url:b})}else h&&(v.thumbnail=new iv({url:`data:image/png;base64,${h}`}));t.styleUrl?v.styleOrigin=new tT({portal:i.portal,styleUrl:t.styleUrl,name:e}):t.styleName&&(v.styleOrigin=new tT({portal:i.portal,styleName:t.styleName,name:e}))}return v})}function bKe(t,e,i){const r=eVe.replaceAll(/\{SymbolName\}/gi,t),n=e.portal!=null?e.portal:on.getDefault();return p9(r,i).then(s=>{const o=She(s.data);return rhe(o,{portal:n,url:sn(oB(r)),origin:"portal-item"})})}const wKe=Object.freeze(Object.defineProperty({__proto__:null,fetchSymbolFromStyle:lye,getStyleItemFromStyle:aye,resolveWebStyleSymbol:oye},Symbol.toStringTag,{value:"Module"})),F0=On.size,NA=On.maxSize,KG=On.maxOutlineSize,CQ=On.lineWidth,a8=On.tallSymbolWidth;function mw(t){const e=t.outline,i=t.material!=null?t.material.color:null,r=i!=null?i.toHex():null;if(e==null||"pattern"in e&&e.pattern!=null&&e.pattern.type==="style"&&e.pattern.style==="none")return t.type==="fill"&&r==="#ffffff"?{color:"#bdc3c7",width:.75}:null;const n=or(e.size)||0;return{color:"rgba("+(e.color!=null?e.color.toRgba():"255,255,255,1")+")",width:Math.min(n,KG),style:"pattern"in e&&e.pattern!=null&&e.pattern.type==="style"?U9(e.pattern.style):null,join:"butt",cap:"patternCap"in e?e.patternCap:"butt"}}async function xKe(t,e){var r,n,s;if((r=t.thumbnail)!=null&&r.url)return t.thumbnail.url;if(e.type==="icon"&&((n=e==null?void 0:e.resource)==null?void 0:n.href))return n6e(e);const i=Tt("esri/images/Legend/legend3dsymboldefault.png");if(t.styleOrigin&&(t.styleOrigin.styleName||t.styleOrigin.styleUrl)){const o=await oye(t.styleOrigin,{portal:t.styleOrigin.portal},"webRef").catch(()=>null);if(o&&"thumbnail"in o&&((s=o.thumbnail)!=null&&s.url))return o.thumbnail.url}return i}function dF(t,e=1){const i=t.a,r=Pv(t),n=r.h,s=r.s/e,o=100-(100-r.v)/e,{r:a,g:l,b:c}=pg({h:n,s,v:o});return[a,l,c,i]}function aO(t){return t.type==="water"?t.color==null?null:t.color:t.material==null||t.material.color==null?null:t.material.color}function Ii(t,e=0){const i=aO(t);if(!i){if(t.type==="fill")return null;const n=e6e.r,s=tg(n,e);return[s,s,s,100]}const r=i.toRgba();for(let n=0;n<3;n++)r[n]=tg(r[n],e);return r}async function cye(t,e){const i=t.style;return i==="none"?null:{type:"pattern",x:0,y:0,src:await Q8e(Tt(`esri/symbols/patterns/${i}.png`),e.toCss(!0)),width:5,height:5}}function EQ(t){return t.outline?mw(t):{color:"rgba(0, 0, 0, 1)",width:1.5}}function uye(t,e){const i=aO(t);if(!i)return null;let r="rgba(";return r+=tg(i.r,e)+",",r+=tg(i.g,e)+",",r+=tg(i.b,e)+",",r+i.a+");"}function l8(t,e){const i=uye(t,e);return i?"pattern"in t&&t.pattern!=null&&t.pattern.type==="style"&&t.pattern.style==="none"?null:{color:i,width:Math.min(t.size?or(t.size):.75,KG),style:"pattern"in t&&t.pattern!=null&&t.pattern.type==="style"?U9(t.pattern.style):null,cap:"cap"in t?t.cap:null,join:"join"in t?t.join==="miter"?or(2):t.join:null}:{}}function CM(t,e,i){const r=i!=null?.75*i:0;return{type:"linear",x1:r?.25*r:0,y1:r?.5*r:0,x2:r||4,y2:r?.5*r:4,colors:[{color:t,offset:0},{color:e,offset:1}]}}function SKe(t){const e=t.depth,i=t.height,r=t.width;return r!==0&&e!==0&&i!==0&&r===e&&r!=null&&i!=null&&r<i}function IKe(t,e,i){const r=[];if(!t)return r;switch(t.type){case"icon":{const o=e,a=e;switch(t.resource&&t.resource.primitive||OAe){case"circle":r.push({shape:{type:"circle",cx:0,cy:0,r:.5*e},fill:Ii(t,0),stroke:mw(t)});break;case"square":r.push({shape:{type:"path",path:[{command:"M",values:[0,a]},{command:"L",values:[0,0]},{command:"L",values:[o,0]},{command:"L",values:[o,a]},{command:"Z",values:[]}]},fill:Ii(t,0),stroke:mw(t)});break;case"triangle":r.push({shape:{type:"path",path:[{command:"M",values:[0,a]},{command:"L",values:[.5*o,0]},{command:"L",values:[o,a]},{command:"Z",values:[]}]},fill:Ii(t,0),stroke:mw(t)});break;case"cross":r.push({shape:{type:"path",path:[{command:"M",values:[.5*o,0]},{command:"L",values:[.5*o,a]},{command:"M",values:[0,.5*a]},{command:"L",values:[o,.5*a]}]},stroke:EQ(t)});break;case"x":r.push({shape:{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[o,a]},{command:"M",values:[o,0]},{command:"L",values:[0,a]}]},stroke:EQ(t)});break;case"kite":r.push({shape:{type:"path",path:[{command:"M",values:[0,.5*a]},{command:"L",values:[.5*o,0]},{command:"L",values:[o,.5*a]},{command:"L",values:[.5*o,a]},{command:"Z",values:[]}]},fill:Ii(t,0),stroke:mw(t)})}break}case"object":switch(t.resource&&t.resource.primitive||DAe){case"cone":{const n=CM(Ii(t,0),Ii(t,-.6),i?a8:e),s=JYe(e,i);r.push({shape:s[0],fill:n}),r.push({shape:s[1],fill:n});break}case"inverted-cone":{const n=Ii(t,0),s=CM(n,Ii(t,-.6),e),o=ZYe(e);r.push({shape:o[0],fill:s}),r.push({shape:o[1],fill:n});break}case"cube":{const n=qYe(e,i);r.push({shape:n[0],fill:Ii(t,0)}),r.push({shape:n[1],fill:Ii(t,-.3)}),r.push({shape:n[2],fill:Ii(t,-.5)});break}case"cylinder":{const n=CM(Ii(t,0),Ii(t,-.6),i?a8:e),s=WYe(e,i);r.push({shape:s[0],fill:n}),r.push({shape:s[1],fill:n}),r.push({shape:s[2],fill:Ii(t,0)});break}case"diamond":{const n=YYe(e);r.push({shape:n[0],fill:Ii(t,-.3)}),r.push({shape:n[1],fill:Ii(t,0)}),r.push({shape:n[2],fill:Ii(t,-.3)}),r.push({shape:n[3],fill:Ii(t,-.7)});break}case"sphere":{const n=CM(Ii(t,0),Ii(t,-.6));n.x1=0,n.y1=0,n.x2=.25*e,n.y2=.25*e,r.push({shape:{type:"circle",cx:0,cy:0,r:.5*e},fill:n});break}case"tetrahedron":{const n=KYe(e);r.push({shape:n[0],fill:Ii(t,-.3)}),r.push({shape:n[1],fill:Ii(t,0)}),r.push({shape:n[2],fill:Ii(t,-.6)});break}}break}return r}function gR(t){const e=typeof(t==null?void 0:t.size)=="number"?t==null?void 0:t.size:null;return e?or(e):null}function TKe(t){return t.type==="icon"?"multiply":"tint"}function CKe(t,e){const i=gR(e),r=e!=null&&e.maxSize?or(e.maxSize):null,n=(e==null?void 0:e.disableUpsampling)??!1,s=t.symbolLayers,o=[];let a=0,l=0;const c=s.at(-1);let u;return c&&c.type==="icon"&&(u=c.size&&or(c.size)),s.forEach(h=>{var g;if(h.type!=="icon"&&h.type!=="object")return;const f=h.type==="icon"?h.size&&or(h.size):0,m=i||f?Math.ceil(Math.min(i||f,r||NA)):F0;if(h&&h.resource&&h.resource.href){const y=xKe(t,h).then(v=>{const b=h.get("material.color"),w=TKe(h);return mKe(v,m,b,w,n)}).then(v=>{const b=v.width,w=v.height;return a=Math.max(a,b),l=Math.max(l,w),[{shape:{type:"image",x:0,y:0,width:b,height:w,src:v.url},fill:null,stroke:null}]});o.push(y)}else{let y=m;h.type==="icon"&&u&&i&&(y=m*(f/u));const v=(e==null?void 0:e.symbolConfig)==="tall"||((g=e==null?void 0:e.symbolConfig)==null?void 0:g.isTall)||h.type==="object"&&SKe(h);a=Math.max(a,v?a8:y),l=Math.max(l,y),o.push(Promise.resolve(IKe(h,y,v)))}}),br(o).then(h=>{const f=[];return h.forEach(m=>{m.value?f.push(m.value):m.error&&ie.getLogger("esri.symbols.support.previewSymbol3D").warn("error while building swatchInfo!",m.error)}),UC(f,[a,l],{node:e&&e.node,scale:!1,opacity:e&&e.opacity,ariaLabel:e==null?void 0:e.ariaLabel})})}function EKe(t,e){const i=t.symbolLayers,r=[],n=KL(t),s=gR(e),o=(e&&e.maxSize?or(e.maxSize):null)||KG;let a,l=0,c=0;return i.forEach((u,h)=>{if(!u||u.type!=="line"&&u.type!=="path")return;const f=[];switch(u.type){case"line":{const m=l8(u,0);if(m==null)break;const g=m&&m.width||0;h===0&&(a=g);const y=Math.min(s||g,o),v=h===0?y:s?y*(g/a):y,b=v>CQ/2?2*v:CQ;c=Math.max(c,v),l=Math.max(l,b),m.width=v,f.push({shape:{type:"path",path:[{command:"M",values:[0,.5*c]},{command:"L",values:[l,.5*c]}]},stroke:m});break}case"path":{const m=Math.min(s||F0,o),g=Ii(u,0),y=Ii(u,-.2),v=uye(u,-.4),b=v?{color:v,width:1}:{};if(u.profile==="quad"){const w=u.width,x=u.height,S=UYe(w&&x?w/x:1,x===0,w===0),I={...b,join:"bevel"};f.push({shape:S[0],fill:y,stroke:I}),f.push({shape:S[1],fill:y,stroke:I}),f.push({shape:S[2],fill:g,stroke:I})}else f.push({shape:s8.pathSymbol3DLayer[0],fill:y,stroke:b}),f.push({shape:s8.pathSymbol3DLayer[1],fill:g,stroke:b});c=Math.max(c,m),l=c}}r.push(f)}),Promise.resolve(UC(r,[l,c],{node:e&&e.node,scale:n,opacity:e&&e.opacity,ariaLabel:e==null?void 0:e.ariaLabel}))}async function MKe(t,e){const i=t.type==="mesh-3d",r=t.symbolLayers,n=gR(e),s=e&&e.maxSize?or(e.maxSize):null,o=n||F0,a=[];let l=0,c=0,u=!1;for(let h=0;h<r.length;h++){const f=r.at(h),m=[];if(i&&f.type!=="fill")continue;const g=s8.fill[0];switch(f.type){case"fill":{const y=mw(f),v=Math.min(o,s||NA);l=Math.max(l,v),c=Math.max(c,v),u=!0;let b=Ii(f,0);const w="pattern"in f?f.pattern:null,x=aO(f);!i&&w!=null&&w.type==="style"&&w.style!=="solid"&&x&&(b=await cye(w,x)),m.push({shape:g,fill:b,stroke:y});break}case"line":{const y=l8(f,0);if(y==null)break;const v={stroke:y,shape:g};l=Math.max(l,F0),c=Math.max(c,F0),m.push(v);break}case"extrude":{const y={join:"round",width:1,...l8(f,-.4)},v=Ii(f,0),b=Ii(f,-.2),w=Math.min(o,s||NA),x=GYe(w);y.width=1,m.push({shape:x[0],fill:b,stroke:y}),m.push({shape:x[1],fill:b,stroke:y}),m.push({shape:x[2],fill:v,stroke:y});const S=F0,I=.7*F0+.5*w;l=Math.max(l,S),c=Math.max(c,I);break}case"water":{const y=us(aO(f)),v=dF(y),b=dF(y,2),w=dF(y,3),x=HYe();u=!0,m.push({shape:x[0],fill:v}),m.push({shape:x[1],fill:b}),m.push({shape:x[2],fill:w});const S=Math.min(o,s||NA);l=Math.max(l,S),c=Math.max(c,S);break}}a.push(m)}return UC(a,[l,c],{node:e&&e.node,scale:u,opacity:e&&e.opacity,ariaLabel:e==null?void 0:e.ariaLabel})}function $Ke(t,e){if(t.symbolLayers.length===0)return Promise.reject(new N("symbolPreview: renderPreviewHTML3D","No symbolLayers in the symbol."));switch(t.type){case"point-3d":return CKe(t,e);case"line-3d":return EKe(t,e);case"polygon-3d":case"mesh-3d":return MKe(t,e)}return Promise.reject(new N("symbolPreview: swatchInfo3D","symbol not supported."))}const AKe=Object.freeze(Object.defineProperty({__proto__:null,getPatternDescriptor:cye,getSizeFromOptions:gR,getSymbolLayerFill:Ii,previewSymbol3D:$Ke},Symbol.toStringTag,{value:"Module"})),MQ={HH:315,HL:45,LL:135,LH:225},kKe={2:[["HL","HH"],["LL","LH"]],3:[["HL","HM","HH"],["ML","MM","MH"],["LL","LM","LH"]],4:[["HL","HM1","HM2","HH"],["M2L","M2M1","M2M2","M2H"],["M1L","M1M1","M1M2","M1H"],["LL","LM1","LM2","LH"]]};function PKe(t){if(!t)return;const{type:e}=t;if(e.includes("3d"))return Ii(t.symbolLayers.at(0));if(e==="simple-line"){const i=vT(t);return i&&i.color}if(t.type==="simple-marker"&&(t.style==="x"||t.style==="cross")){const i=vT(t);return i&&i.color}return X8e(t)}function OKe(t,e){const i=e.HH.label,r=e.LL.label,n=e.HL.label,s=e.LH.label;switch(t){case"HH":default:return{top:i,bottom:r,left:n,right:s};case"HL":return{top:n,bottom:s,left:r,right:i};case"LL":return{top:r,bottom:i,left:s,right:n};case"LH":return{top:s,bottom:n,left:i,right:r}}}function LKe(t){const{focus:e,infos:i,numClasses:r}=t,n=kKe[r],s={};i.forEach(a=>{s[a.value]={label:a.label,fill:PKe(a.symbol)}});const o=[];for(let a=0;a<r;a++){const l=[];for(let c=0;c<r;c++){const u=s[n[a][c]];l.push(u.fill)}o.push(l)}return{type:"relationship-ramp",numClasses:r,focus:e,colors:o,labels:OKe(e,s),rotation:dye(e)}}function dye(t){let e=MQ[t];return t&&e==null&&(e=MQ.HH),e||0}let $_=null;const $Q=[255,255,255];function AQ(t,e){return Math.floor(Math.random()*(e-t+1)+t)}function RKe(t,e,i){const{backgroundColor:r,outline:n,dotSize:s}=t,o=i&&i.swatchSize||On.size,a=.8,l=Math.round(o*o/s**2*a),c=window.devicePixelRatio,u=document.createElement("canvas"),h=o*c;u.width=h,u.height=h,u.style.width=u.width/c+"px",u.style.height=u.height/c+"px";const f=u.getContext("2d");if(r&&(f.fillStyle=r.toCss(!0),f.fillRect(0,0,h,h),f.fill()),f.fillStyle=(e==null?void 0:e.toCss(!0))??"",$_&&$_.length/2===l)for(let g=0;g<2*l;g+=2){const y=$_[g],v=$_[g+1];f.fillRect(y,v,s*c,s*c),f.fill()}else{$_=[];for(let g=0;g<2*l;g+=2){const y=AQ(0,h),v=AQ(0,h);$_.push(y,v),f.fillRect(y,v,s*c,s*c),f.fill()}}n&&(n.color&&(f.strokeStyle=n.color.toCss(!0)),f.lineWidth=n.width,f.strokeRect(0,0,h,h));const m=new Image(o,o);return m.src=u.toDataURL(),m.ariaLabel=(i==null?void 0:i.ariaLabel)??null,m.alt=(i==null?void 0:i.ariaLabel)??"",m}function FKe(t,e={}){const i=e.radius||40,r=2*Math.PI*i,n=t.length,s=r/n,o=[],a=vT(e.outline);(a==null?void 0:a.width)!=null&&(a.width*=2),(a||e.backgroundColor)&&o.push({shape:{type:"circle",cx:i,cy:i,r:i},fill:e.backgroundColor,stroke:a,offset:[0,0]});const l=e.values,c=l&&l.length===n&&l.reduce((g,y)=>g+y,0)===100,u=[0];for(let g=0;g<n;g++){let y=null;c&&(y=l[g]*r/100,u.push(y+u[g])),o.push({shape:{type:"circle",cx:i,cy:i,r:i/2},fill:[0,0,0,0],stroke:{width:i,dashArray:`${(y??s)/2} ${r}`,dashoffset:"-"+(c?u[g]/2:g*(s/2)),color:t[g]},offset:[0,0]})}let h=null;const f=2*i+((a==null?void 0:a.width)||0),m=e.holePercentage;if(m){a&&o.push({shape:{type:"circle",cx:i,cy:i,r:i*m},fill:null,stroke:a,offset:[0,0]});const g=f/2;h=[[{shape:{type:"circle",cx:g,cy:g,r:g},fill:$Q,stroke:a?{...a,color:$Q}:null,offset:[0,0]},{shape:{type:"circle",cx:g,cy:g,r:i*m},fill:[0,0,0],stroke:null,offset:[0,0]}]]}return UC([o],[f,f],{effectView:e.effectList,ignoreStrokeWidth:!0,masking:h,rotation:-90,ariaLabel:e.ariaLabel})}function s0(t,e={}){const n=e.align==="horizontal",s=n?75:24,o=n?24:75,a=e.width??s,l=e.height??o,c=e.gradient??!0,u=window.devicePixelRatio,h=a*u,f=l*u,m=document.createElement("canvas");m.width=h,m.height=f,m.ariaLabel=e.ariaLabel??null,m.style.width=`${a}px`,m.style.height=`${l}px`;const g=m.getContext("2d"),y=n?h:0,v=n?0:f;if(c){const w=g.createLinearGradient(0,0,y,v),x=t.length,S=x===1?0:1/(x-1);t.forEach((I,T)=>w.addColorStop(T*S,I.toString())),g.fillStyle=w,g.fillRect(0,0,h,f)}else{const w=n?h/t.length:h,x=n?f:f/t.length;let S=0,I=0;for(const T of t)g.fillStyle=T.toString(),g.fillRect(S,I,w,x),S=n?S+w:0,I=n?0:I+x}const b=document.createElement("div");return b.style.width=`${a}px`,b.style.height=`${l}px`,DKe(b,e==null?void 0:e.effectList),b.appendChild(m),b}function DKe(t,e){if(!e)return;t.style.filter=bT(e);const i=e.effects;if(i){for(const r of i)if((r==null?void 0:r.type)==="drop-shadow"){r.offsetX<0?t.style.marginLeft=`${Math.abs(r.offsetX)}px`:t.style.marginRight=`${r.offsetX}px`;break}}}async function XG(t,e){switch(t.type){case"web-style":{const{previewWebStyleSymbol:i}=await W(()=>import("./previewWebStyleSymbol-51bfeb87.js"),[],import.meta.url);return i(t,XG,e)}case"label-3d":case"line-3d":case"mesh-3d":case"point-3d":case"polygon-3d":{const{previewSymbol3D:i}=await W(()=>Promise.resolve().then(()=>AKe),void 0,import.meta.url);return i(t,e)}case"simple-marker":case"simple-line":case"simple-fill":case"picture-marker":case"picture-fill":case"text":{const{previewSymbol2D:i}=await W(()=>import("./previewSymbol2D-65e8e33b.js"),["./previewSymbol2D-65e8e33b.js","./fontUtils-d28127a5.js","./colorUtils-25efbfd5.js"],import.meta.url);return i(t,e)}case"cim":{const{previewCIMSymbol:i}=await W(()=>import("./previewCIMSymbol-055ce870.js"),["./previewCIMSymbol-055ce870.js","./cimAnalyzer-97b03e25.js","./fontUtils-d28127a5.js","./BidiEngine-9a40f2f4.js","./OptimizedGeometry-196224d4.js","./GeometryUtils-984e8446.js","./enums-f1a6a48a.js","./alignmentUtils-ae955d28.js","./definitions-8f6c0024.js","./number-e491b09e.js","./Rect-ea14f53a.js","./callExpressionWithFeature-06ba3d44.js","./quantizationUtils-533107d2.js","./floatRGBA-de0614b2.js","./CIMSymbolRasterizer-f0cfdbf7.js","./CIMResourceManager-b8fa14d9.js","./Rasterizer-453ee95d.js","./rasterizingUtils-8fc9ca0c.js","./imageutils-260173a2.js"],import.meta.url);return i(t,e)}default:return}}function hye(t){return t&&"opacity"in t?t.opacity*hye(t.parent):1}async function c8(t,e){if(!t)return;const i=t.sourceLayer,r=(e!=null&&e.useSourceLayer?i:t.layer)??i,n=hye(r);if(t.symbol!=null&&(e==null||e.ignoreGraphicSymbol!==!0)){const x=t.symbol.type==="web-style"?await g6e(t.symbol,{...e,cache:e!=null?e.webStyleCache:null}):t.symbol.clone();return S5(x,null,n),x}const s=(e!=null?e.renderer:null)??(r&&"renderer"in r?r.renderer:null);let o=s&&"getSymbolAsync"in s?await s.getSymbolAsync(t,e):null;if(!o)return;if(o=o.type==="web-style"?await o.fetchSymbol({...e,cache:e!=null?e.webStyleCache:null}):o.clone(),!(s&&"visualVariables"in s&&s.visualVariables&&s.visualVariables.length))return S5(o,null,n),o;if("arcadeRequiredForVisualVariables"in s&&s.arcadeRequiredForVisualVariables&&(e==null||e.arcade==null)){const x={...e};x.arcade=await zd(),e=x}const{getColor:a,getOpacity:l,getAllSizes:c,getRotationAngle:u}=await W(()=>Promise.resolve().then(()=>Wv),void 0,import.meta.url),h=[],f=[],m=[],g=[];for(const x of s.visualVariables)switch(x.type){case"color":h.push(x);break;case"opacity":f.push(x);break;case"rotation":g.push(x);break;case"size":x.target||m.push(x)}const y=!!h.length&&h[h.length-1],v=y?a(y,t,e):null,b=!!f.length&&f[f.length-1];let w=b?l(b,t,e):null;if(n!=null&&(w=w!=null?w*n:n),S5(o,v,w),m.length){const x=c(m,t,e);await ofe(o,x)}for(const x of g)afe(o,u(x,t,e),x.axis);return o}const NKe=(t,e)=>{const i=t.featuresTilingScheme.getClosestInfoForScale(t.scale).level;return e!=null&&e.levels?e.levels[i]:null};function VKe(t,e){if(!t||!("visualVariables"in t)||!t.visualVariables)return null;const i=t.visualVariables.find(n=>n.type==="size"),r=NKe(e,i);return r?new Jv({field:i.field,minSize:r[2].size,minDataValue:r[2].value,maxSize:r[3].size,maxDataValue:r[3].value}):null}const zKe=/^-?(\d+)(\.(\d+))?$/i;function jKe(t,e){return t-e}function BKe(t,e){let i,r;return i=Number(t.toFixed(e)),i<t?r=i+1/10**e:(r=i,i-=1/10**e),i=Number(i.toFixed(e)),r=Number(r.toFixed(e)),[i,r]}function UKe(t,e,i,r,n){const s=VA(t,e,i,r),o=s.previous==null||s.previous<=n,a=s.next==null||s.next<=n;return o&&a||s.previous+s.next<=2*n}function lO(t){const e=String(t),i=e.match(zKe);if(i&&i[1])return{integer:i[1].split("").length,fractional:i[3]?i[3].split("").length:0};if(e.toLowerCase().includes("e")){const r=e.split("e"),n=r[0],s=r[1];if(n&&s){const o=Number(n);let a=Number(s);const l=a>0;l||(a=Math.abs(a));const c=lO(o);return l?(c.integer+=a,a>c.fractional?c.fractional=0:c.fractional-=a):(c.fractional+=a,a>c.integer?c.integer=1:c.integer-=a),c}}return{integer:0,fractional:0}}function VA(t,e,i,r){const n={previous:null,next:null};if(i!=null){const s=t-i,o=e-i-s;n.previous=Math.floor(Math.abs(100*o/s))}if(r!=null){const s=r-t,o=r-e-s;n.next=Math.floor(Math.abs(100*o/s))}return n}function cO(t,e={}){const i=t.slice(0),{tolerance:r=2,strictBounds:n=!1,indexes:s=i.map((o,a)=>a)}=e;s.sort(jKe);for(let o=0;o<s.length;o++){const a=s[o],l=i[a],c=a===0?null:i[a-1],u=a===i.length-1?null:i[a+1],h=lO(l).fractional;if(h){let f,m=0,g=!1;for(;m<=h&&!g;){const y=BKe(l,m);f=n&&o===0?y[1]:y[0],g=UKe(l,f,c,u,r),m++}g&&(i[a]=f)}}return i}const GKe={maximumFractionDigits:20};function HKe(t){return po(t,GKe)}const pye="<",fye=">",qKe=Zh("short-date");function mye(t,e,i,r){let n="";e===0?n=`${pye} `:e===i&&(n=`${fye} `);let s=null;return s=r?Oi(t,qKe):HKe(t),n+s}const WKe=["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwcdIkqhiWn5fHwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6JrzFUAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwaeIkqhiWl5/HwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6sKxboAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwadJEqhiWl5fPwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu75+IUcAAAAASUVORK5CYII="];async function u8(t){if(!("visualVariables"in t)||!t.visualVariables)return null;const e=t.visualVariables.find(o=>o.type==="color");if(!e)return null;let i=null,r=null;if(e.stops){if(e.stops.length===1)return e.stops[0].color;i=e.stops[0].value,r=e.stops[e.stops.length-1].value}const n=i!=null&&r!=null?i+(r-i)/2:0,{getColor:s}=await W(()=>Promise.resolve().then(()=>Wv),void 0,import.meta.url);return s(e,n)??null}async function gye(t,e){const i=t.trailCap,r=t.trailWidth||1,n=e||await u8(t)||t.color;return new Yn({cap:i,color:n,width:r})}function kQ(t){return t!=null&&typeof t=="object"&&"min"in t&&"max"in t}const JKe=new ce([64,64,64]);function yye(t,e){const i=[],r=t.length-1;return t.length===5?i.push(0,2,4):i.push(0,r),t.map((n,s)=>i.includes(s)?mye(n,s,r,e):null)}async function d8(t,e,i){let r=!1,n=[],s=[];if(t.stops){const c=t.stops;n=c.map(u=>u.value),r=c.some(u=>!!u.label),r&&(s=c.map(u=>u.label))}const o=n[0],a=n[n.length-1];if(o==null&&a==null)return null;const l=r?null:yye(n,i??!1);return(await Promise.all(n.map(async(c,u)=>({value:c,color:t.type==="opacity"?await ZKe(c,t,e):(await W(()=>Promise.resolve().then(()=>Wv),void 0,import.meta.url)).getColor(t,c),label:r?s[u]:(l==null?void 0:l[u])??""})))).reverse()}async function ZKe(t,e,i){const r=new ce(i??JKe),n=(await W(()=>Promise.resolve().then(()=>Wv),void 0,import.meta.url)).getOpacity(e,t);return n!=null&&(r.a=n),r}function YKe(t){let e=!1,i=[],r=[];i=t.map(a=>a.value),e=t.some(a=>!!a.label),e&&(r=t.map(a=>a.label??""));const n=i[0],s=i[i.length-1];if(n==null&&s==null)return null;const o=e?null:yye(i,!1);return i.map((a,l)=>({value:a,color:vye(a,t),label:e?r[l]:(o==null?void 0:o[l])??""})).reverse()}function vye(t,e){const{startIndex:i,endIndex:r,weight:n}=KKe(t,e);if(i===r)return e[i].color;const s=ce.blendColors(e[i].color,e[r].color,n);return new ce(s)}function KKe(t,e){let i=0,r=e.length-1;return e.some((n,s)=>t<n.value?(r=s,!0):(i=s,!1)),{startIndex:i,endIndex:r,weight:(t-e[i].value)/(e[r].value-e[i].value)}}function XKe(t,e){let i=[];if(t&&t.type==="multipart")t.colorRamps.reverse().forEach((r,n)=>{n===0?i.push({value:e.max,color:new ce(r.toColor),label:"high"}):i.push({value:null,color:new ce(r.toColor),label:""}),n===t.colorRamps.length-1?i.push({value:e.min,color:new ce(r.fromColor),label:"low"}):i.push({value:null,color:new ce(r.fromColor),label:""})});else{let r,n;t&&t.type==="algorithmic"?(r=t.fromColor,n=t.toColor):(r=[0,0,0,1],n=[255,255,255,1]),i=[{value:e.max,color:new ce(n),label:"high"},{value:e.min,color:new ce(r),label:"low"}]}return i}function _ye(t){if(!t.colorStops)return[];const e=[...t.colorStops].filter(r=>{var n;return((n=r.color)==null?void 0:n.a)>0});let i=e.length-1;if(e&&e[0]){const r=e[i];r&&r.ratio!==1&&(e.push(new nI({ratio:1,color:r.color})),i++)}return e.map((r,n)=>{var o,a;let s="";return n===0?s=((o=t.legendOptions)==null?void 0:o.minLabel)||"low":n===i&&(s=((a=t.legendOptions)==null?void 0:a.maxLabel)||"high"),{color:r.color,label:s,ratio:r.ratio}}).reverse()}const h8=30,p8=12,bye=[255,255,255],wye=[200,200,200],gw=[128,128,128],QKe=20,eXe=5;function tXe(t){return t.declaredClass==="esri.symbols.SimpleMarkerSymbol"}function iXe(t){return t.declaredClass==="esri.symbols.PictureMarkerSymbol"}function rXe(t){return t.declaredClass==="esri.symbols.SimpleLineSymbol"}function nXe(t){return t.declaredClass==="esri.symbols.TextSymbol"}function sXe(t,e){const i=t.length-1;return t.map((r,n)=>mye(r,n,i,e))}async function oXe(t,e,i,r,n,s,o){const a=e.legendOptions,l=a&&a.customValues,c=o||await cXe(t,i),u=e.stops,h=!!c,f=!!l,m=e.minSize!=null&&e.maxSize!=null,g=u&&u.length>1,y=!!e.target;if(!h||!f&&!(m||g&&!y))return;const v=KL(c);let b=!1,w=null,x=null;w=v&&!g?cO([e.minDataValue,e.maxDataValue]):l??await dXe(e,c,r,n);const S=t==null?void 0:t.authoringInfo,I=(S==null?void 0:S.type)==="univariate-color-size",T=I&&(S==null?void 0:S.univariateTheme)==="above-and-below";if(!w&&g&&(w=u.map(P=>P.value),b=u.some(P=>!!P.label),t.type==="flow"&&(w=cO(w)),b&&(x=u.map(P=>P.label))),v&&w!=null&&(w==null?void 0:w.length)>2&&!T&&(w=[w[0],w[w.length-1]]),!w)return null;I&&(w==null?void 0:w.length)!==5&&(w=Iye({minSize:w[0],maxSize:w[w.length-1]}));const C=v?aXe(t,w):null,E=r6e(c),$=b?null:sXe(w,s);return(await Promise.all(w.map(async(P,k)=>{const L=v?C[k]:await Vb(e,c,P,r,n);return{value:P,symbol:fXe(T&&t.type==="class-breaks"?lXe(t,k):c,L),label:b?x[k]:$[k],size:L,outlineSize:E}}))).reverse()}function aXe(t,e){const i=t==null?void 0:t.authoringInfo,r=(i==null?void 0:i.type)==="univariate-color-size";let n=[p8,h8];if(r){const s=e[0],o=e[e.length-1],a=p8,l=h8;n=e.map(c=>a+(c-s)/(o-s)*(l-a))}return r&&(i==null?void 0:i.univariateTheme)==="below"&&n.reverse(),n}function lXe(t,e){const i=t.classBreakInfos,r=i.length,n=r<2||!(e>=2)?i[0].symbol.clone():i[r-1].symbol.clone();return t.visualVariables.some(s=>s.type==="color")&&(n.type.includes("3d")?xye(n):Sye(n)),n}async function cXe(t,e){var n,s;if(t.type==="flow")return gye(t,e);if(t.type==="pie-chart")return new ms({color:null,outline:(n=t.outline)!=null&&n.width?t.outline:new Yn});let i=null,r=null;if(t.type==="simple")i=t.symbol;else if(t.type==="class-breaks"){const o=t.classBreakInfos;i=o&&o[0]&&o[0].symbol,r=o.length>1}else if(t.type==="unique-value"){const o=t.uniqueValueInfos;i=(s=o==null?void 0:o[0])==null?void 0:s.symbol,r=o!=null&&o.length>1}return!i||uXe(i)?null:(i=i.clone(),(e||r)&&(i.type.includes("3d")?xye(i):Sye(i)),i)}function uXe(t){return t?Bd(t)?!!t.symbolLayers&&t.symbolLayers.some(e=>e&&e.type==="fill"):t.type.includes("fill"):!1}function xye(t){t.type==="line-3d"?t.symbolLayers.forEach(e=>{e.material={color:gw}}):t.symbolLayers.forEach(e=>{e.type!=="icon"||e.resource&&e.resource.href?e.material={color:wye}:(e.material={color:bye},e.outline={color:gw,size:1.5})})}function Sye(t){var i,r;const e=XU();t.type==="cim"?efe(t,new ce(wye)):t.type.includes("line")?t.color=gw:(t.color=e?gw:bye,t.type==="simple-marker"&&(t.outline?((r=(i=t.outline)==null?void 0:i.color)==null?void 0:r.toHex())==="#ffffff"&&(t.outline.color=gw):t.outline={color:gw,width:1.5}))}async function dXe(t,e,i,r){const n=(await W(()=>Promise.resolve().then(()=>Wv),void 0,import.meta.url)).getSizeRangeAtScale(t,i,r),s=n&&Iye(n);if(!n||!s)return;let o=s.map(a=>hXe(a,t,n));o=cO(o);for(let a=1;a<o.length-1;a++){const l=await pXe(t,e,o[a],o[a-1],i,r);l&&(o[a]=l[0],s[a]=l[1])}return o}function Iye(t){const e=t.minSize,i=t.maxSize,r=eXe,n=(i-e)/(r-1),s=[];for(let o=0;o<r;o++)s.push(e+n*o);return s}function hXe(t,e,i){const r=i.minSize,n=i.maxSize,s=e.minDataValue,o=e.maxDataValue;let a;return t<=r?a=s:t>=n?a=o:a=(t-r)/(n-r)*(o-s)+s,a}async function pXe(t,e,i,r,n,s){const o=await Vb(t,e,i,n,s),a=await Vb(t,e,r,n,s),l=lO(i),c=l.fractional,u=QKe;let h=l.integer,f=null,m=null;i>0&&i<1&&(f=10**c,h=lO(i*=f).integer);for(let g=h-1;g>=0;g--){const y=10**g;let v=Math.floor(i/y)*y,b=Math.ceil(i/y)*y;f!=null&&(v/=f,b/=f);let w=(v+b)/2;[,w]=cO([v,w,b],{indexes:[1]});const x=await Vb(t,e,v,n,s),S=await Vb(t,e,b,n,s),I=await Vb(t,e,w,n,s),T=VA(o,x,a,null),C=VA(o,S,a,null),E=VA(o,I,a,null);let $=T.previous<=u,P=C.previous<=u;if($&&P&&(T.previous<=C.previous?($=!0,P=!1):(P=!0,$=!1)),$?m=[v,x]:P?m=[b,S]:E.previous<=u&&(m=[w,I]),m)break}return m}async function Vb(t,e,i,r,n){const{getSize:s}=await W(()=>Promise.resolve().then(()=>Wv),void 0,import.meta.url);return s(t,i,{scale:r,view:n,shape:e.type==="simple-marker"?e.style:null})}function fXe(t,e){const i=t.clone();if(Bd(i))KL(i)||i.symbolLayers.forEach(r=>{r.type!=="fill"&&(r.size=e)});else if(tXe(i))i.size=e;else if(iXe(i)){const r=i.width,n=i.height;i.height=e,i.width=e*(r/n)}else rXe(i)?i.width=e:nXe(i)&&i.font&&(i.font.size=e);return i}ie.getLogger("esri.renderers.support.utils");async function Pa(t,e,i){rw(t,e,()=>[]).push(...i)}async function Bxt(t){var i,r;const e=new Map;if(!t)return e;if("visualVariables"in t&&t.visualVariables){const n=t.visualVariables.filter(s=>s.type==="color");for(const s of n){const o=(await d8(s)??[]).map(a=>a.color);await Pa(e,s.field||s.valueExpression,o)}}if(t.type==="heatmap"){const n=_ye(t).map(s=>s.color);await Pa(e,t.field||t.valueExpression,n)}else if(t.type==="pie-chart"){for(const n of t.attributes)await Pa(e,n.field||n.valueExpression,[n.color]);await Pa(e,"default",[(i=t==null?void 0:t.othersCategory)==null?void 0:i.color,b_(t.backgroundFillSymbol,null)])}else if(t.type==="dot-density"){for(const n of t.attributes)await Pa(e,n.field||n.valueExpression,[n.color]);await Pa(e,"default",[t.backgroundColor])}else if(t.type==="unique-value")if(((r=t.authoringInfo)==null?void 0:r.type)==="predominance")for(const n of t.uniqueValueInfos??[])await Pa(e,n.value.toString(),[b_(n.symbol,null)]);else{const n=(t.uniqueValueInfos??[]).map(c=>b_(c.symbol,null)),{field:s,field2:o,field3:a,valueExpression:l}=t;(s||l)&&await Pa(e,s||l,n),o&&await Pa(e,o,n),a&&await Pa(e,a,n)}else if(t.type==="class-breaks"){const n=t.classBreakInfos.map(a=>b_(a.symbol,null)),{field:s,valueExpression:o}=t;await Pa(e,s??o,n)}else t.type==="simple"&&await Pa(e,"default",[b_(t.symbol,null)]);return"defaultSymbol"in t&&t.defaultSymbol&&await Pa(e,"default",[b_(t.defaultSymbol,null)]),e.forEach((n,s)=>{const o=Kwe(n.filter(Boolean),(a,l)=>JSON.stringify(a)===JSON.stringify(l));e.set(s,o)}),e}function mXe(t){const i=Math.floor(Math.log10(Math.abs(t)))+1,r=i<4||i>6?4:i,n=1e6,s=Math.abs(t)>=n?"compact":"standard";return po(t,{notation:s,minimumSignificantDigits:2,maximumSignificantDigits:r})}const gXe="https://utility.arcgis.com/sharing/tools/legend",yXe="esri.layers.ImageryLayer",vXe="esri.layers.ImageryTileLayer",_Xe="esri.layers.WCSLayer",EM=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i,bXe=new He({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"}),MM=new ms({size:6,outline:{color:[128,128,128,.5],width:.5}}),wXe=new hc({style:"solid"});function f8(t){return t.type==="flow"}function Tye(t){return t.type==="vector-field"}function Cye(t){return t.type==="raster-colormap"}function Eye(t){return t.type==="raster-stretch"}function Mye(t){return t.type==="raster-shaded-relief"}function zb(t){return t.declaredClass==="esri.renderers.SimpleRenderer"}function jb(t){return t.declaredClass==="esri.renderers.ClassBreaksRenderer"}function zA(t){return t.declaredClass==="esri.renderers.UniqueValueRenderer"}function $ye(t){return t.declaredClass==="esri.renderers.HeatmapRenderer"}function xXe(t){return QG(t)||e7(t)||t7(t)||SXe(t)}function SXe(t){return t.declaredClass==="esri.renderers.PointCloudRGBRenderer"}function QG(t){return t.declaredClass==="esri.renderers.PointCloudClassBreaksRenderer"}function e7(t){return t.declaredClass==="esri.renderers.PointCloudStretchRenderer"}function t7(t){return t.declaredClass==="esri.renderers.PointCloudUniqueValueRenderer"}function Aye(t){return t.declaredClass==="esri.renderers.DotDensityRenderer"}function kye(t){return t.declaredClass==="esri.renderers.PieChartRenderer"}function IXe(t,e){return zb(t)||jb(t)||zA(t)||$ye(t)||Aye(t)||kye(t)?e.type==="2d"||Wge(t):Eye(t)||Cye(t)||Mye(t)||QG(t)||e7(t)||t7(t)||Tye(t)||f8(t)}function TXe(t){return t.declaredClass==="esri.layers.BuildingSceneLayer"}function hF(t){return t.declaredClass==="esri.layers.SubtypeGroupLayer"}function CXe(t){return t.declaredClass==="esri.layers.VoxelLayer"}function EXe(t){return t.declaredClass==="esri.layers.WMSLayer"}function MXe(t){return t.declaredClass==="esri.layers.WMTSLayer"}function pF(t){return t.declaredClass==="esri.layers.MapImageLayer"}function PQ(t){return t.declaredClass==="esri.layers.TileLayer"}function A_(t){return t.declaredClass===yXe}function $M(t){return t.declaredClass===vXe}function $Xe(t){return t.declaredClass===_Xe}function AXe(t){return t.type==="stretch-ramp"}function kXe(t){const e="authoringInfo"in t?t==null?void 0:t.authoringInfo:null;return(e==null?void 0:e.type)==="univariate-color-size"}function PXe(t){const e="authoringInfo"in t?t==null?void 0:t.authoringInfo:null;return(e==null?void 0:e.type)==="univariate-color-size"&&(e==null?void 0:e.univariateTheme)==="above-and-below"}function OQ(t){return"sublayers"in t}async function th(t,e){const i=await ev("esri/widgets/Legend/t9n/Legend");return t!=="previewTemplateAriaLabel"||e||(t="previewAriaLabel"),Os(i[t],{label:e})}const OXe=new ms({style:"path",path:"M10,5 L5,0 0,5 M5,0 L5,15",size:15,outline:{width:1,color:[85,85,85,1]}});let k_={},_n=class extends he{constructor(e){super(e),this._hasColorRamp=!1,this._hasOpacityRamp=!1,this._hasSizeRamp=!1,this._webStyleSymbolCache=new Map,this._dotDensityUrlCache=new Map,this._scaleDrivenSizeVariable=null,this._hasClusterSizeVariable=!1,this.children=new ye,this.layerView=null,this.layer=null,this.legendElements=[],this.parent=null,this.hideLayersNotInCurrentView=!1,this.keepCacheOnDestroy=!1,this.respectLayerVisibility=!0,this.sublayerIds=[],this.title=null,this.view=null}initialize(){const e=()=>this.notifyChange("ready");this.addHandles([ui(()=>this.children,"change",i=>{const{added:r,removed:n}=i;r.forEach(s=>{const o=`activeLayerInfo-ready-watcher-${s.layer.uid}`;this.addHandles(J(()=>s.ready,e,Le),o)}),n.forEach(s=>this.removeHandles(s.layer.uid)),e()})]),this.keepCacheOnDestroy||(k_={})}destroy(){this._webStyleSymbolCache=null,this._dotDensityUrlCache=null,this._scaleDrivenSizeVariable=null,this.keepCacheOnDestroy||(k_=null)}get effectList(){const e=this.layer;let i=null;return"effect"in e&&e.effect&&(i=new od,i.effect=e.effect,i.endTransitions(),i.scale=this.scale),i}get opacity(){var s;const e=this.layer.opacity,i=(s=this.parent)==null?void 0:s.opacity,r=this.layer.parent,n=r&&"uid"in r?this._getParentLayerOpacity(r):null;return i!=null?i*e:n!=null?n*e:e}get ready(){return this.layer===null||(this.children.length>0?this._isGroupActive():this.legendElements.length>0)}get scale(){var e;return((e=this.view)==null?void 0:e.scale)??0}get isScaleDriven(){const e=this.layer;if(e===null)return!1;if("effect"in e&&e.effect&&Array.isArray(e.effect))return!0;if("featureReduction"in e&&e.featureReduction){if(e.featureReduction.type==="cluster")return!0;if(e.featureReduction.type==="binning"&&"renderer"in e.featureReduction&&e.featureReduction.renderer)return this._isRendererScaleDriven(e.featureReduction.renderer)}return"renderer"in e&&e.renderer?this._isRendererScaleDriven(e.renderer):this._isLayerScaleDriven(this.layer)}get version(){return this._get("version")+1}async buildLegendElementsForFeatureCollections(e){if(!(!this.hideLayersNotInCurrentView||await this._isLayerInCurrentView()))return this.legendElements=[],void this.notifyChange("ready");const i=Array.from(e,r=>{if(xB(r))return this._getRendererLegendElements(r.renderer,{title:r.title});if(r.featureSet&&r.featureSet.features.length){const n=r.layerDefinition,s=n&&n.drawingInfo,o=s&&nVe(s.renderer),a=bXe.read(n.geometryType);return o?this._getRendererLegendElements(o,{title:r.name,geometryType:a}):(ie.getLogger(this).warn("drawingInfo not available!"),null)}return null});try{const r=[];await br(i).then(n=>{n.forEach(({value:s})=>s&&r.push(...s))}),this.legendElements=r,this.notifyChange("ready")}catch(r){ie.getLogger(this).warn("error while building legend for layer!",r)}}async buildLegendElementsForRenderer(e){try{const i=!this.hideLayersNotInCurrentView||await this._isLayerInCurrentView();this.legendElements=i?await this._getRendererLegendElements(e):[],this.notifyChange("ready")}catch(i){ie.getLogger(this).warn("error while building legend for layer!",i)}}async buildLegendElementsForFeatureReduction(e){try{const i=!this.hideLayersNotInCurrentView||await this._isLayerInCurrentView();this.legendElements=i?await this._getLegendElementsForFeatureReduction(e):[],this.notifyChange("ready")}catch(i){ie.getLogger(this).warn("error while building legend for layer!",i)}}async buildLegendElementsForTools(){var i,r;const e=this.layer;if(CXe(e))this._constructLegendElementsForVoxellayer();else if(MXe(e))this._constructLegendElementsForWMTSlayer();else if(EXe(e))await this._constructLegendElementsForWMSSublayers();else if(TXe(e))await this._constructLegendElementsForBuildingSceneLayer();else if(pF(e)||PQ(e)||hF(e))await this._constructLegendElementsForSublayers();else{this.removeHandles("imageryLayers-watcher");let n="default";if(A_(e)){const s=e;n=(((i=s==null?void 0:s.rasterFunction)==null?void 0:i.functionName)||"default")+"_"+((r=e.bandIds)!=null&&r.length?e.bandIds.join(""):"###")}await this._getLegendLayers(`${e.uid}-${n}`).then(async s=>{this.legendElements=[],this.notifyChange("ready");const o=s.map(async a=>{if(A_(e)||$M(e)){const c=J(()=>["renderingRule"in e&&e.rasterFunction,e.bandIds],()=>Ad(async()=>{k_.default=null,e.renderer?await this.buildLegendElementsForRenderer(e.renderer):await this.buildLegendElementsForTools()})());this.addHandles(c,"imageryLayers-watcher")}const l=this._generateSymbolTableElementForLegendLayer(a);l&&l.infos.length&&(A_(e)&&(l.title=e.title),this.legendElements.push(l)),this.notifyChange("ready")});await br(o)}).catch(s=>{ie.getLogger(this).warn("Request to server for legend has failed!",s)})}}async _isLayerInCurrentView(){const e=this.layer,i=this.layerView,r=i&&"createQuery"in i&&"queryFeatureCount"in i;if(!r&&!(i&&"createQuery"in e&&"queryFeatureCount"in e))return!0;await _r(()=>!i.updating);const n=r?"createQuery"in i&&i.createQuery():"createQuery"in e&&e.createQuery();return n?(n.geometry=this.view.extent,(r?"queryFeatureCount"in i&&await i.queryFeatureCount(n):"queryFeatureCount"in e&&await e.queryFeatureCount(n))!==0):!0}_getParentLayerOpacity(e){let i=1;const r=e.parent;return r&&"uid"in r&&(i=this._getParentLayerOpacity(r)),e.opacity*i}_isGroupActive(){const e=this.children;return!!e.length&&e.some(i=>i.ready)}_isRendererScaleDriven(e){if(e.type==="dot-density")return!0;const i="valueExpression"in e?e.valueExpression:null;if(EM.test(i))return!0;const r="visualVariables"in e?e.visualVariables:null;return!!r&&r.some(n=>this._isScaleDrivenSizeVariable(n))}_isScaleDrivenSizeVariable(e){if(e&&e.type!=="size")return!1;const i=e,r=i.minSize,n=i.maxSize;return typeof r=="object"&&r?this._isScaleDrivenSizeVariable(r):typeof n=="object"&&n?this._isScaleDrivenSizeVariable(n):!!i.expression||EM.test(i.valueExpression)}_isLayerScaleDriven(e){if("minScale"in e&&e.minScale>0||"maxScale"in e&&e.maxScale>0)return!0;if("sublayers"in e&&e.sublayers)return e.sublayers.some(r=>this._isLayerScaleDriven(r));const i=e.parent;if(e.loaded===!1&&i&&pF(i)&&"source"in e&&e.source&&e.source.type==="map-layer"){for(const r of i.sourceJSON.layers??[])if(r.id===e.source.mapLayerId&&(r.minScale>0||r.maxScale>0))return!0}return!1}async _constructLegendElementsForVoxellayer(){var o;this.legendElements=[],this.removeHandles("voxel-style-watcher"),this.removeHandles("voxel-current-variable");const e=this.layer;this.addHandles(J(()=>e.currentVariableId,()=>this._constructLegendElementsForVoxellayer()),"voxel-current-variable"),this.addHandles(J(()=>e.getVariableStyles(),()=>this._constructLegendElementsForVoxellayer()),"voxel-style-watcher");const i=e.getVariableStyle(null),r=[];if(i){if((o=i.uniqueValues)!=null&&o.length){const a=[];i.uniqueValues.forEach(l=>{l.enabled&&a.push({label:l.label||`${l.value}`,value:l.value,symbol:new hc({color:l.color,outline:null})})}),a.length&&r.push({type:"symbol-table",title:i.label,infos:a})}else if(i.transferFunction){const{colorStops:a,stretchRange:l}=i.transferFunction,c=a.toArray().reverse(),u=l.map((f,m)=>`${m===0?pye:fye} ${mXe(f)}`).reverse(),h=c.map(f=>({color:f.color,value:null,label:null}));h[0].label=u[0],h[h.length-1].label=u[1],r.push({type:"color-ramp",title:i.label,infos:h,preview:s0(c.map(f=>f.color),{ariaLabel:await th("previewColorRampAriaLabel")})})}}const n=e.opacity,s=r.reduce((a,l)=>[...a,...this._getAllInfos(l)],[]).filter(a=>!!(a!=null&&a.symbol)).map(a=>this._getSymbolPreview(a,n));await br(s),this.legendElements=r,this.notifyChange("ready")}_constructLegendElementsForWMTSlayer(){this.legendElements=[],this.removeHandles("wmts-activeLayer-watcher");const e=this.layer.activeLayer;if(this.addHandles(J(()=>{const{layer:i}=this;return i&&"activeLayer"in i&&i.activeLayer},()=>this._constructLegendElementsForWMTSlayer()),"wmts-activeLayer-watcher"),e.styleId&&e.styles){let i=null;e.styles.some(r=>e.styleId===r.id&&(i=r.legendUrl,!0)),i&&(this.legendElements=[{type:"symbol-table",title:e.title,infos:[{src:i,opacity:this.opacity}]}])}this.notifyChange("ready")}async _constructLegendElementsForWMSSublayers(){this.legendElements=[],this.removeHandles("wms-sublayers-watcher");const e=this.layer;let i=null;(e.customParameters||e.customLayerParameters)&&(i={...e.customParameters,...e.customLayerParameters}),this.addHandles(J(()=>{const{layer:r}=this;return r&&"sublayers"in r&&r.sublayers},()=>this._constructLegendElementsForWMSSublayers()),"wms-sublayers-watcher"),this.legendElements=await this._generateLegendElementsForWMSSublayers(e.sublayers,i),this.notifyChange("ready")}async _generateLegendElementsForWMSSublayers(e,i){const r=[];this.addHandles(e.on("change",()=>this._constructLegendElementsForWMSSublayers()),"wms-sublayers-watcher");const n=e.toArray();for(const s of n){const o=J(()=>[s.title,s.visible,s.legendEnabled],()=>this._constructLegendElementsForWMSSublayers());if(this.addHandles(o,"wms-sublayers-watcher"),!this.respectLayerVisibility||s.visible&&s.legendEnabled){const a=await this._generateSymbolTableElementForWMSSublayer(s,i);a&&a.infos.length&&r.unshift(a)}}return r}async _generateSymbolTableElementForWMSSublayer(e,i){if(!e.legendUrl&&e.sublayers){const r=(await this._generateLegendElementsForWMSSublayers(e.sublayers,i)).filter(n=>n);return{type:"symbol-table",title:e.title,infos:r}}return this._generateSymbolTableElementForLegendUrl(e,i)}async _generateSymbolTableElementForLegendUrl(e,i){var a;let r=e.legendUrl;if(!r)return;const n={type:"symbol-table",title:e.title||e.name||String(e.id??""),infos:[]};i&&(r=T$(r,i));let s=null;const o=(a=e.layer)==null?void 0:a.opacity;try{s=(await at(r,{responseType:"image"})).data,s&&(s.style.opacity=o)}catch{}return n.infos.push({src:r,preview:s,opacity:o}),n}_getLegendLayers(e,i){const r=k_&&k_[e];return r?Promise.resolve(r):this._legendRequest(i).then(n=>{const s=n.layers;return k_[e]=s,s})}_legendRequest(e){var s;const i=this.layer;let r={f:"json",dynamicLayers:e};if(A_(i)){const o=i.exportImageServiceParameters.rasterFunction;if(o&&(r.renderingRule=JSON.stringify(((s=o.functionDefinition)==null?void 0:s.toJSON())||o.toJSON())),i.bandIds&&(r.bandIds=i.bandIds.join()),i.raster||i.viewId||i.customParameters){const{raster:a,viewId:l,customParameters:c}=i;r={raster:a,viewId:l,...r,...c}}}let n=i.url.replace(/(\/)+$/,"");if("version"in i&&+i.version>=10.01){const o=n.indexOf("?");o>-1?n=n.substring(0,o)+"/legend"+n.substring(o):n+="/legend"}else{const o=n.toLowerCase().indexOf("/rest/"),a=n.substring(0,o)+n.substring(o+5,n.length);n=gXe+"?soapUrl="+encodeURI(a)+"&returnbytes=true"}return at(n,{query:r}).then(o=>o.data)}async _constructLegendElementsForBuildingSceneLayer(){this.legendElements=[],this.removeHandles("sublayers-watcher");const e=this.layer;this.addHandles(J(()=>e.sublayers,()=>this._constructLegendElementsForBuildingSceneLayer()),"sublayers-watcher");try{this.legendElements=await this._generateLegendElementsForBuildingSublayers(e.sublayers,this.opacity),this.notifyChange("ready")}catch(i){ie.getLogger(this).warn("Request to server for legend has failed!",i)}}async _generateLegendElementsForBuildingSublayers(e,i){let r=[];this.addHandles(e.on("change",()=>this._constructLegendElementsForBuildingSceneLayer()),"sublayers-watcher");const n=e.toArray();for(const s of n){const o=J(()=>["renderer"in s&&s.renderer,s.opacity,s.title,s.visible],()=>this._constructLegendElementsForBuildingSceneLayer());if(this.addHandles(o,"sublayers-watcher"),!this.respectLayerVisibility||s.visible){const a=s&&s.opacity!=null?s.opacity:null,l=a!=null?a*i:i;if(s.type==="building-group"){const c={type:"symbol-table",title:s.title,infos:[]},u=await this._generateLegendElementsForBuildingSublayers(s.sublayers,l);c.infos.push(...u),r=[c,...r]}else s.renderer&&(r=[...await this._getRendererLegendElements(s.renderer,{title:s.title,opacity:l,sublayer:s}),...r])}}return r.filter(s=>!!s&&(!("infos"in s)||!s.infos||s.infos.length>0))}async _constructLegendElementsForSublayers(){this.legendElements=[],this.removeHandles("sublayers-watcher");const e=this.layer;if(pF(e)||PQ(e)||hF(e)){this.addHandles(J(()=>e.sublayers,()=>this._constructLegendElementsForSublayers),"sublayers-watcher");try{this.legendElements=await this._generateLegendElementsForSublayers(e.sublayers,this.opacity),this.notifyChange("ready")}catch(i){ie.getLogger(this).warn("Request to server for legend has failed!",i)}}}async _generateLegendElementsForSublayers(e,i,r){const n=this.layer;let s=[];this.addHandles(e.on("change",()=>this._constructLegendElementsForSublayers()),"sublayers-watcher");let o=e.toArray();!r&&this.sublayerIds&&this.sublayerIds.length&&(o=hF(n)?this.sublayerIds.map(a=>n.findSublayerForSubtypeCode(a)).filter(Dt):this.sublayerIds.map(a=>n.findSublayerById(a)).filter(Dt));for(const a of o){const l=J(()=>[a.renderer,a.opacity,a.title,a.visible,a.legendEnabled],()=>this._constructLegendElementsForSublayers());if(this.addHandles(l,"sublayers-watcher"),!this.respectLayerVisibility||a.visible&&a.legendEnabled&&this._isSublayerInScale(a)){const c=a&&a.opacity!=null?a.opacity:null,u=c!=null?c*i:i,h=!OQ(a)||a.originIdOf("renderer")>Ye.SERVICE&&!a.sublayers;if(a.renderer&&h)await a.load(),s=[...await this._getRendererLegendElements(a.renderer,{title:a.title,opacity:u,sublayer:a}),...s];else if(OQ(a)){const f=await this._generateSymbolTableElementForSublayer(a,u,r);f&&s.unshift(f)}}}return s.filter(a=>!!a&&(!("infos"in a)||!a.infos||a.infos.length>0))}async _generateSymbolTableElementForSublayer(e,i,r){if(!r){r=new Map;const s=this.layer,o=e.source;let a=null;if(!(!o||o.type==="map-layer"&&o.mapLayerId===e.id&&(!o.gdbVersion||o.gdbVersion===("gdbVersion"in s&&s.gdbVersion)))||e.originIdOf("renderer")>Ye.SERVICE||e.originIdOf("labelingInfo")>Ye.SERVICE||e.originIdOf("labelsVisible")>Ye.SERVICE){const c=new Na({layer:this.layer});a=c.hasDynamicLayers?c.dynamicLayers:null,c.destroy()}const l=a||`${s.uid}-default`;(await this._getLegendLayers(l,a)).forEach(c=>r.set(c.layerId,c))}const n=r.get(e.id);if((!n||n!=null&&n.subLayerIds&&n.defaultVisibility)&&e.sublayers){const s=await this._generateLegendElementsForSublayers(e.sublayers,i,r);return{type:"symbol-table",title:e.title,infos:s}}return this._generateSymbolTableElementForLegendLayer(n,e,i)}_generateSymbolTableElementForLegendLayer(e,i,r){if(!e||!e.legend||this.respectLayerVisibility&&!this._isLegendLayerInScale(e,i))return null;const n=i==null?void 0:i.renderer;let s=(i==null?void 0:i.title)||e.layerName;if(n&&(!i||(i==null?void 0:i.originIdOf("renderer"))>Ye.SERVICE)){const l=(i==null?void 0:i.title)||this._getRendererTitle(n,i);l&&(s&&typeof l!="string"&&"title"in l&&(l.title=s),s=l)}const o={type:"symbol-table",title:s,legendType:e.legendType||null,infos:[]},a=i?this._sanitizeLegendForSublayer(e.legend.slice(),i):e.legend;return e.legendGroups&&e.legendGroups.length>0?e.legendGroups.forEach(l=>{var u;const c={type:"symbol-table",title:l.heading,legendType:e.legendType||null,infos:this._generateSymbolTableElementInfosForLegendLayer(a.filter(h=>h.groupId===l.id),e.layerId,r)};((u=c.infos)==null?void 0:u.length)>0&&o.infos.push(c)}):o.infos=this._generateSymbolTableElementInfosForLegendLayer(a,e.layerId,r),o.infos.length>0?o:null}_generateSymbolTableElementInfosForLegendLayer(e,i,r){return e.map(n=>{let s=n.url;if(n.imageData&&n.imageData.length>0)s=`data:image/png;base64,${n.imageData}`;else{if(s.indexOf("http")===0)return null;s=k2e(`${this.layer.url}/${i}/images/${s}`)}return{label:n.label,src:s,opacity:r??this.opacity,width:n.width,height:n.height}}).filter(Dt)}_isSublayerInScale(e){const i=e.minScale||0,r=e.maxScale||0;return!(i>0&&i<this.scale||r>this.scale)}_isLegendLayerInScale(e,i){const r=i||this.layer;let n=null,s=null,o=!0;return!r.minScale&&r.minScale!==0||!r.maxScale&&r.maxScale!==0?(e.minScale===0&&r.tileInfo&&(n=r.tileInfo.lods[0].scale),e.maxScale===0&&r.tileInfo&&(s=r.tileInfo.lods[r.tileInfo.lods.length-1].scale)):(n=Math.min(r.minScale,e.minScale)||r.minScale||e.minScale,s=Math.max(r.maxScale,e.maxScale)),(n>0&&n<this.scale||s>this.scale)&&(o=!1),o}_sanitizeLegendForSublayer(e,i){if("version"in this.layer&&+this.layer.version<10.1||e.length===0)return e;const r=i.renderer,n=e.some(a=>a.values);let s=0,o=null;return n&&e.some((a,l)=>(a.values||(s=l,o=a,o.label||(o.label="others")),o!=null)),r?r.type==="unique-value"?o&&(e.splice(s,1),e.push(o)):r.type==="class-breaks"&&(o&&e.splice(s,1),e.reverse(),o&&e.push(o)):o&&(e.splice(s,1),e.push(o)),e}async _getRendererLegendElements(e,i={}){if(!IXe(e,this.view))return ie.getLogger(this).warn(`Renderer of type '${e.type}' not supported!`),[];if(xXe(e))return this._constructPointCloudRendererLegendElements(e,i);if(Aye(e))return this._constructDotDensityRendererLegendElements(e);const r=await this._loadRenderer(e);return kye(r)?this._constructPieChartRendererLegendElements(r):this._constructRendererLegendElements(r,i)}async _getLegendElementsForFeatureReduction(e){let i=null;return e.type==="binning"?i=e.renderer:e.type==="cluster"&&(i=this._getClusterRenderer(e)),i?this._getRendererLegendElements(i):[]}_getPointCloudRendererTitle(e){var i;return(((i=e.legendOptions)==null?void 0:i.title)||e.field)??""}async _constructPointCloudRendererLegendElements(e,i={}){var l;const r=i.title,n=[];let s=null,o=null;if(QG(e))s={type:"symbol-table",title:r||this._getPointCloudRendererTitle(e),infos:[]},e.colorClassBreakInfos.forEach(c=>{s.infos.unshift({label:c.label||c.minValue+" - "+c.maxValue,value:[c.minValue,c.maxValue],symbol:this._getAppliedCloneSymbol(MM,c.color)})});else if(e7(e)){const c=e.stops;let u=null;if(c!=null&&c.length&&(c.length===1&&(u=c[0].color),!u)){const f=c[0].value,m=c[c.length-1].value;f!=null&&m!=null&&(u=vye(f+(m-f)/2,c))}s={type:"symbol-table",title:null,infos:[{label:null,value:null,symbol:this._getAppliedCloneSymbol(MM,u||MM.color)}]};const h=YKe(e.stops??[])??[];o={type:"color-ramp",title:r||this._getPointCloudRendererTitle(e),infos:h,preview:s0(h.map(f=>f.color),{ariaLabel:await th("previewColorRampAriaLabel")})}}else t7(e)&&(s={type:"symbol-table",title:r||this._getPointCloudRendererTitle(e),infos:[]},(l=e.colorUniqueValueInfos)==null||l.forEach(c=>{s.infos.push({label:c.label||c.values.join(", "),value:c.values.join(", "),symbol:this._getAppliedCloneSymbol(MM,c.color)})}));s&&s.infos.length&&n.push(s),o&&o.infos.length&&n.push(o);const a=n.reduce((c,u)=>[...c,...u.infos??[]],[]).filter(c=>!!c.symbol).map(c=>this._getSymbolPreview(c,this.opacity,{symbolConfig:{applyColorModulation:!!e.colorModulation}}));return br(a).then(()=>n)}async _getElementInfoForDotDensity(e,i){const{color:r,label:n,valueExpressionTitle:s}=i,{backgroundColor:o,outline:a,dotSize:l}=e,c=this.effectList,u=c==null?void 0:c.effects.map(w=>w.toJSON()),h=EP(u),f=await th("previewTemplateAriaLabel",n||s),m=l+"-"+r+"-"+o+"-"+(a&&JSON.stringify(a.toJSON()))+"-"+h,g=this._dotDensityUrlCache,y=g.has(m)?g.get(m):RKe(e,r,{ariaLabel:f});g.set(m,y);const v={shape:{type:"image",x:0,y:0,width:y.width,height:y.height,src:y.src},fill:null,stroke:null,offset:[0,0]},b=UC([[v]],[y.width,y.height],{effectView:this.effectList,ariaLabel:f});return{opacity:1,src:y.src,preview:b,width:y.width,height:y.height}}async _constructDotDensityRendererLegendElements(e){const i=e.calculateDotValue(this.view.scale),r=e.legendOptions&&e.legendOptions.unit,n={type:"symbol-table",title:{value:i&&Math.round(i),unit:r||""},infos:[]};for(const s of e.attributes){const o=await this._getElementInfoForDotDensity(e,s);o.label=s.label||s.valueExpressionTitle||s.field,n.infos.push(o)}return[n]}async _constructPieChartRendererLegendElements(e){var c,u,h,f;const i=this.layer.opacity,r=[];let n=null;const s=e.outline;e.attributes.forEach(m=>{const g=new ms({color:m.color,outline:s}),y=m.label||m.valueExpressionTitle||m.field;r.push({label:y,symbol:g})});const o=r.length?[...r]:[];if((c=e.othersCategory)!=null&&c.color&&((u=e.othersCategory)==null?void 0:u.threshold)!==0){const m=new ms({color:e.othersCategory.color,outline:s});n=e.othersCategory.label||"Other",r.push({label:n,symbol:m})}if((h=e.defaultColor)!=null&&h.a){const m=new ms({color:e.defaultColor,outline:s});r.push({label:e.defaultLabel,symbol:m})}const a=await this._getVisualVariableLegendElements(e,this.layer)||[];if(r.length){a.unshift({type:"symbol-table",title:null,infos:r});const m=o.filter(y=>y.label!==n).map(y=>y.symbol.color).filter(Boolean),g=FKe(m,{holePercentage:e.holePercentage,backgroundColor:(f=e.backgroundFillSymbol)==null?void 0:f.color,effectList:this.effectList,outline:s,ariaLabel:await th("previewPieChartAriaLabel")});a.unshift({type:"pie-chart-ramp",title:this._getRendererTitle(e,this.layer),infos:r,preview:g})}const l=a.reduce((m,g)=>[...m,...this._getAllInfos(g)],[]).filter(m=>!!(m!=null&&m.symbol)&&!(m!=null&&m.preview)).map(m=>this._getSymbolPreview(m,i,{effectList:this.effectList}));return await br(l),a}async _constructRendererLegendElements(e,i={}){var v,b,w,x;const{title:r,sublayer:n}=i,s=n||this.layer;this._hasColorRamp=!1,this._hasOpacityRamp=!1,this._hasSizeRamp=!1,this._scaleDrivenSizeVariable=null;const o=await this._getVisualVariableLegendElements(e,s)||[],a={type:"symbol-table",title:r||this._getRendererTitle(e,s),infos:[]};let l=null,c=!1;const u=new Set;if(f8(e)&&!this._hasSizeRamp){const S=await gye(e);a.infos.push({label:null,symbol:S})}else if(kXe(e)){let S=r;const I=PXe(e)?"univariate-above-and-below-ramp":"univariate-color-size-ramp",T=o.findIndex(k=>k.type==="color-ramp"),C=T!==-1?o.splice(T,1)[0]:null,E=o.findIndex(k=>k.type==="size-ramp"),$=E!==-1?o.splice(E,1)[0]:null,P=[];C&&(S=C.title,P.push(C)),$&&(S=$.title,P.push($)),P.length>0&&o.push({type:I,title:S,infos:P})}else if($ye(e)){const S=_ye(e);o.push({type:"heatmap-ramp",title:r||this._getRendererTitle(e,s),infos:S,preview:s0(S.map(I=>I.color),{effectList:this.effectList,ariaLabel:await th("previewColorRampAriaLabel")})})}else if(zA(e)){const S=e&&e.authoringInfo;if(S&&S.type==="relationship"){const{numClasses:I,field1:T,field2:C}=S,E=S.focus;if(I&&T&&C){const $=[T,C];let P=dye(E)||0;for(const L of $){const{field:F,normalizationField:V,label:z}=L,G=z||{field:this._getFieldAlias(F,s),normField:V&&this._getFieldAlias(V,s)},H=OXe.clone();H.angle=P,a.infos.push({label:G,symbol:H}),u.add(H),P+=90}const k=LKe({focus:E,numClasses:I,infos:e.uniqueValueInfos??[]});o.unshift(k)}}else if(A_(this.layer)||$M(this.layer))(v=e.uniqueValueInfos)==null||v.forEach(I=>{I.symbol&&a.infos.push({label:I.label||I.value,value:I.value,symbol:I.symbol})});else{const{field:I,field2:T,field3:C,fieldDelimiter:E,valueExpression:$,defaultSymbol:P}=e,k=!(!I&&!$||!T&&!C),L=[];if((b=e.uniqueValueGroups)==null||b.forEach(F=>{var z;const V={type:"symbol-table",title:F.heading,infos:[]};(z=F.classes)==null||z.forEach(G=>{const{symbol:H,values:Z}=G;if(H){const K=[],X=[];for(const le of Z??[]){const{value:me,value2:Se,value3:Ge}=le,Be=[],gt=[];(I||$)&&(Be.push(me),gt.push(this._getDomainName(I,me,s))),T&&(Be.push(Se),gt.push(this._getDomainName(T,Se,s))),C&&(Be.push(Ge),gt.push(this._getDomainName(C,Ge,s))),K.push(k?Be.join(E||""):Be[0]),X.push(gt.join(" - "))}const oe=K.join(", ");let se=G.label;if(!se){const le=X.filter(Boolean);se=le.length?le.join(", "):oe}V.infos.push({label:se,value:oe,symbol:H})}}),V.infos.length&&L.push(V)}),L.length){const F=L[0];L.length===1&&"title"in F&&!F.title?a.infos.push(...F.infos??[]):(P&&(L.push({type:"symbol-table",infos:[{label:e.defaultLabel||"others",symbol:P}]}),c=!0),a.infos.push(...L)),r||e.legendOptions&&e.legendOptions.title||e.valueExpressionTitle||(a.title=null)}}e.defaultSymbol&&!c&&(a.infos.push({label:e.defaultLabel||"others",symbol:e.defaultSymbol}),c=!0)}else if(jb(e))l=this._isUnclassedRenderer(e),(!l||!this._hasSizeRamp)&&(e.classBreakInfos.forEach(S=>{S.symbol&&a.infos.unshift({label:S.label||(l?null:S.minValue+" - "+S.maxValue),value:[S.minValue,S.maxValue],symbol:S.symbol})}),l&&(a.title=null),this._updateInfosforClassedSizeRenderer(e,a.infos)),e.defaultSymbol&&!l&&(a.infos.push({label:e.defaultLabel||"others",symbol:e.defaultSymbol}),c=!0);else if(Eye(e))if($M(this.layer)||$Xe(this.layer)){const S=await this._constructTileImageryStretchRendererElements(e);AXe(S)?o.push(S):a.infos=S}else{const S=this.layer;let I,T;if((w=e.statistics)!=null&&w.length){const k=e.statistics[0];kQ(k)?(I=k.min,T=k.max):[I,T]=k}let C=[],E=S.serviceRasterInfo;if(S.rasterFunction)try{E=await S.generateRasterInfo(S.rasterFunction)}catch{}const $=E.keyProperties.BandProperties,P=Au(E.pixelType);if(E.bandCount===1){const k=((x=S.bandIds)==null?void 0:x[0])||0;I=I??(E.statistics?E.statistics[k].min:P[0]),T=T??(E.statistics?E.statistics[k].max:P[1]),I||T?o.push(await this._getStretchLegendElements(e,{min:I,max:T})):this._getServerSideLegend()}else S.bandIds&&S.bandIds.length===1?(I=I??(E.statistics?E.statistics[S.bandIds[0]].min:P[0]),T=T??(E.statistics?E.statistics[S.bandIds[0]].max:P[1]),I||T?o.push(await this._getStretchLegendElements(e,{min:I,max:T})):this._getServerSideLegend()):E.bandCount>=3?$&&$.length>=E.bandCount?S.bandIds&&S.bandIds.length===3?(C=S.bandIds.map(k=>$[k].BandName),a.infos=this._createSymbolTableElementMultiBand(C)):S.format==="lerc"?(C=[0,1,2].map(k=>$[k].BandName),a.infos=this._createSymbolTableElementMultiBand(C)):this._getServerSideLegend():S.format==="lerc"?(C=["band1","band2","band3"],a.infos=this._createSymbolTableElementMultiBand(C)):this._getServerSideLegend():this._getServerSideLegend()}else if(Cye(e))e.colormapInfos.forEach(S=>{a.infos.push({label:S.label,value:S.value,symbol:this._getAppliedCloneSymbol(wXe,S.color)})});else if(zb(e)){let S=e.symbol;switch(i.geometryType){case"point":S="pointSymbol"in s?s.pointSymbol:null;break;case"polyline":S="lineSymbol"in s?s.lineSymbol:null;break;case"polygon":S="polygonSymbol"in s?s.polygonSymbol:null}const I=this._hasClusterSizeVariable&&this._getClusterSymbol()||!this._hasSizeRamp;e.symbol&&I&&a.infos.push({label:e.label,symbol:S})}else if(Tye(e)){e.outputUnit&&(this.title="("+e.toJSON().outputUnit+")"),a.title=e.attributeField;const S=e.getClassBreakInfos();S!=null&&S.length?S.forEach(I=>{a.infos.push({label:I.minValue+" - "+I.maxValue,symbol:I.symbol})}):a.infos.push({label:e.attributeField,symbol:e.getDefaultSymbol()})}else Mye(e)&&o.push(await this._getStretchLegendElements(e,{min:0,max:255}));const h=e.defaultSymbol;!h||c||zb(e)||l&&!this._hasColorRamp&&!this._hasSizeRamp&&!this._hasOpacityRamp||o.push({type:"symbol-table",infos:[{label:e.defaultLabel||"others",symbol:h}]}),a.infos.length&&o.unshift(a);const f=i.opacity==null?this.opacity:i.opacity,m=this._isTallSymbol("visualVariables"in e?e.visualVariables:null),g=A_(this.layer)||$M(this.layer),y=o.reduce((S,I)=>[...S,...this._getAllInfos(I)],[]).filter(S=>!!(S!=null&&S.symbol)).map(S=>this._getSymbolPreview(S,f,{isDefault:S.symbol===h,applyScaleDrivenSize:!u.has(S.symbol),symbolConfig:{isTall:m,isSquareFill:g},effectList:u.has(S.symbol)?null:this.effectList}));return e=null,await br(y),o}_getServerSideLegend(){setTimeout(()=>this.buildLegendElementsForTools(),0)}_getAllInfos(e){const i=e==null?void 0:e.infos;return i?i.reduce((r,n)=>r.concat(this._getAllInfos(n)),[]):[e]}async _constructTileImageryStretchRendererElements(e){var h,f;const i=this.layer,{rasterInfo:r}=i.raster,n=r.bandCount||e.statistics.length;let s,o,a=[];const l=r.keyProperties&&r.keyProperties.BandProperties,c=(h=e==null?void 0:e.statistics)!=null&&h.length?e.statistics:r==null?void 0:r.statistics;if(c){const m=c[0];kQ(m)?(s=m.min,o=m.max):[s,o]=m}else{const m=Au(r.pixelType);s=m[0],o=m[1]}if(i.hasStandardTime()&&(s=i.getStandardTimeValue(s),o=i.getStandardTimeValue(o)),r.bandCount===1||((f=i.bandIds)==null?void 0:f.length)===1)return this._getStretchLegendElements(e,{min:s,max:o});function u(m){var y;const g=((y=i==null?void 0:i.bandIds)!=null&&y.length?i.bandIds:Array.from(Array(Math.min(r.bandCount,3)).keys())).map(v=>m&&m[v]&&m[v].BandName||"band"+(v+1));return g.length<3?g.push(g[1]):g.length>3&&g.splice(3),g}return a=l&&l.length>=n?u(l):u(),this._createSymbolTableElementMultiBand(a)}async _getStretchLegendElements(e,i){const r=e.colorRamp,n=XKe(r,i);return{type:"stretch-ramp",title:"",infos:n,preview:s0(n.map(s=>s.color),{ariaLabel:await th("previewColorRampAriaLabel")})}}_getClusterSymbol(){var n;const e=this.layer,i="featureReduction"in e&&e.featureReduction,r=i&&"symbol"in i&&i.renderer;return r&&((n=r==null?void 0:r.authoringInfo)==null?void 0:n.isAutoGenerated)!==!0?null:i&&"symbol"in i?i.symbol:null}async _getSizeLegendElement(e,i,r,n){return{type:"size-ramp",title:this._hasClusterSizeVariable?this._getClusterTitle(i):e,infos:await oXe(r,i,await u8(r),this.scale,this.view.type,!!n,this._hasClusterSizeVariable?this._getClusterSymbol():null)}}_createSymbolTableElementMultiBand(e){const i=[],r=["red","green","blue"];return e.forEach((n,s)=>{i.push({label:{colorName:r[s],bandName:n},src:WKe[s],opacity:this.opacity??1})}),i}_updateInfosforClassedSizeRenderer(e,i){const r=e.authoringInfo&&e.authoringInfo.type==="class-breaks-size",n=e.classBreakInfos.some(s=>KL(s.symbol));if(r&&n){const s=h8,o=p8,a=e.classBreakInfos.length,l=(s-o)/(a>1?a-1:a);i.forEach((c,u)=>{c.size=s-l*u})}}_isTallSymbol(e){let i=!1,r=!1;if(e)for(let n=0;n<e.length&&(!i||!r);n++){const s=e[n];s.type==="size"&&(s.axis==="height"&&(i=!0),s.axis==="width-and-depth"&&(r=!0))}return i&&r}async _getSymbolPreview(e,i,r){let n=!(r!=null&&r.isDefault)&&e.size==null&&this._hasSizeRamp?wa(On.size):e.size;if(this._scaleDrivenSizeVariable&&(r!=null&&r.applyScaleDrivenSize)){const{getSize:s}=await W(()=>Promise.resolve().then(()=>Wv),void 0,import.meta.url);n=s(this._scaleDrivenSizeVariable,null,{view:this.view.type,scale:this.scale,shape:e.symbol.type==="simple-marker"?e.symbol.style:null})}return XG(e.symbol,{size:n,opacity:i,scale:!1,symbolConfig:r==null?void 0:r.symbolConfig,effectView:r==null?void 0:r.effectList,ariaLabel:e.label&&typeof e.label!="string"?null:await th("previewTemplateAriaLabel",e.label)}).then(s=>(e.preview=s,e)).catch(()=>(e.preview=null,e))}_getClusterRenderer(e){var s,o;this._hasClusterSizeVariable=!1;const i="renderer"in this.layer?this.layer.renderer:null,r=((s=e.renderer)==null?void 0:s.clone())||(i==null?void 0:i.clone()),n=VKe(this.layerView._effectiveRenderer,this.view);if(n&&r!=null&&"visualVariables"in r&&!((o=r.visualVariables)==null?void 0:o.some(l=>l.type==="size"&&l.target!=="outline"&&!EM.test(l.valueExpression)))){if("clusterMinSize"in e&&"clusterMaxSize"in e){const{clusterMinSize:c,clusterMaxSize:u}=e;n.legendOptions=new Wde({showLegend:c!==u})}const l=r.visualVariables||[];r.visualVariables=l.concat([n]),this._hasClusterSizeVariable=!0}return r}async _loadRenderer(e){const i=[],r=e.clone(),n=await u8(r);if(jb(r)||zA(r)){const s=(r.classBreakInfos||r.uniqueValueInfos).map(o=>this._fetchSymbol(o.symbol,n).then(a=>{o.symbol=a}).catch(()=>{o.symbol=null}));Array.prototype.push.apply(i,s)}return i.push(this._fetchSymbol(r.symbol||r.defaultSymbol,r.defaultSymbol?null:n).then(s=>{this._applySymbolToRenderer(r,s,zb(r))}).catch(()=>{this._applySymbolToRenderer(r,null,zb(r))})),br(i).then(()=>r)}_applySymbolToRenderer(e,i,r){r?e.symbol=i:e.defaultSymbol=i}async _fetchSymbol(e,i){if(!e)throw new Error;if(e.type==="web-style"){const r=this._webStyleSymbolCache;try{const n=await(this.view.type==="2d"?e.fetchCIMSymbol({cache:r}):e.fetchSymbol({cache:r}));return this._getAppliedCloneSymbol(n,i)}catch{throw ie.getLogger(this).warn("Fetching web-style failed!"),new Error}}return this._getAppliedCloneSymbol(e,i)}_getAppliedCloneSymbol(e,i){if(!e||!i)return e;const r=e.clone(),n=i&&i.toRgba();return r.type.includes("3d")?this._applyColorTo3dSymbol(r,n):r.type==="cim"?efe(r,i):r.color&&(r.color=new ce(n||r.color)),r}_applyColorTo3dSymbol(e,i){i&&e.symbolLayers.forEach(r=>{r&&(r.material||(r.material={}),r.material.color=new ce(i))})}async _getVisualVariableLegendElements(e,i){if(!("visualVariables"in e)||!e.visualVariables||e.type==="vector-field")return null;const r=e.visualVariables,n=[],s=[],o=[];for(const h of r)h.type==="color"?n.push(h):h.type==="size"?s.push(h):h.type==="opacity"&&o.push(h);const a=[...n,...s,...o];let l,c;if(n.length===0&&jb(e)&&e.classBreakInfos&&e.classBreakInfos.length===1){const h=e.classBreakInfos[0];l=h&&h.symbol}if(n.length===0&&zb(e)&&(l=e.symbol),l)if(l.type.includes("3d")){const h=l.symbolLayers.at(0);h.type==="water"?h.color!=null&&(c=h.color):h.material!=null&&h.material.color!=null&&(c=h.material.color)}else l.url||(c=l.color);const u=this.effectList;return(await Promise.all(a.map(async h=>{var f;if(!h.legendOptions||h.legendOptions.showLegend!==!1){const m=f8(e)?h.field:this._getRampTitle(h,i);let g=null;const y="getField"in i?(f=i.getField)==null?void 0:f.call(i,h.field):null,v=y&&Zk(y);if(h.type==="color"){const b=await d8(h,null,v)??[];g={type:"color-ramp",title:m,infos:b,preview:s0(b.map(w=>w.color),{effectList:u,ariaLabel:await th("previewColorRampAriaLabel")})},this._hasColorRamp||(this._hasColorRamp=b.length>0)}else if(h.type==="size"&&h.target!=="outline")EM.test(h.valueExpression)?this._hasClusterSizeVariable||(this._scaleDrivenSizeVariable=h):(g=await this._getSizeLegendElement(m,h,e,v),this._hasSizeRamp||(this._hasSizeRamp=!(g.infos==null||!g.infos.length)));else if(h.type==="opacity"){const b=await d8(h,c,v)??[];g={type:"opacity-ramp",title:m,infos:b,preview:s0(b.map(w=>w.color),{effectList:u,ariaLabel:await th("previewColorRampAriaLabel")})},this._hasOpacityRamp||(this._hasOpacityRamp=b.length>0)}return g&&g.infos?g:null}}))).filter(Dt)}_getDomainName(e,i,r){if(e&&typeof e!="function"){const n="getField"in r&&r.getField&&r.getField(e),s=n&&"getFieldDomain"in r&&r.getFieldDomain?r.getFieldDomain(n.name):null;return(s==null?void 0:s.type)==="coded-value"?s.getName(i):null}return null}_getClusterTitle(e){const i=this.layer,r=e.field;if("featureReduction"in i&&i.featureReduction&&i.featureReduction.type==="cluster"){const n=i.featureReduction,s="popupTemplate"in n&&n.popupTemplate,o=s&&s.fieldInfos;if(o){for(const a of o)if(a.fieldName===r)return r==="cluster_count"?a.label||{showCount:!0}:a.label}}return{showCount:!0}}_getRampTitle(e,i){let r=e.field,n=e.normalizationField,s=!1,o=!1,a=!1,l=null;r=typeof r=="function"?null:r,n=typeof n=="function"?null:n;const c=e.legendOptions&&e.legendOptions.title;if(c!=null)l=c;else if(e.valueExpressionTitle)l=e.valueExpressionTitle;else{if("renderer"in i&&i.renderer&&"authoringInfo"in i.renderer&&i.renderer.authoringInfo&&i.renderer.authoringInfo.visualVariables){const u=i.renderer.authoringInfo.visualVariables;for(let h=0;h<u.length;h++){const f=u[h];if(f.type==="color"){if(f.style==="ratio"){s=!0;break}if(f.style==="percent"){o=!0;break}if(f.style==="percent-of-total"){a=!0;break}}}}l={field:r&&this._getFieldAlias(r,i),normField:n&&this._getFieldAlias(n,i),ratio:s,ratioPercent:o,ratioPercentTotal:a}}return l}_getRendererTitle(e,i){const r=e;if(r.legendOptions&&r.legendOptions.title)return r.legendOptions.title;if(r.valueExpressionTitle)return r.valueExpressionTitle;let n=r.field,s=null,o=null;if(jb(r)&&(s=r.normalizationField,o=r.normalizationType==="percent-of-total"),n=typeof n=="function"?null:n,s=typeof s=="function"?null:s,zA(r)){const{field2:l,field3:c,fieldDelimiter:u}=r;let h=n&&this._getFieldAlias(n,i);return l&&(h=`<${h}>${u}<${this._getFieldAlias(l,i)}>`,c&&(h=`${h}${u}<${this._getFieldAlias(c,i)}>`)),h}let a=null;return(n||s)&&(a={field:n&&this._getFieldAlias(n,i),normField:s&&this._getFieldAlias(s,i),normByPct:o}),a}_getFieldAlias(e,i){const r="popupTemplate"in i?i.popupTemplate:null,n=r==null?void 0:r.fieldInfos;let s;n&&n.some(h=>e===h.fieldName&&(s=h,!0));let o=null;"getField"in i&&i.getField?o=i.getField(e):"fieldsIndex"in i&&i.fieldsIndex&&(o=i.fieldsIndex.get(e));let a=null;const l="featureReduction"in i&&i.featureReduction;l&&(!s&&"popupTemplate"in l&&l.popupTemplate&&l.popupTemplate.fieldInfos&&l.popupTemplate.fieldInfos.some(h=>{var f;return(e==null?void 0:e.toLowerCase())===((f=h.fieldName)==null?void 0:f.toLowerCase())&&(s=h,!0)}),"fields"in l&&l.fields&&(a=l.fields.find(h=>{var f;return((f=h.name)==null?void 0:f.toLowerCase())===(e==null?void 0:e.toLowerCase())})));const c=s||o||a;let u=null;return c&&(u=(s==null?void 0:s.label)||(o==null?void 0:o.alias)||(a==null?void 0:a.alias)||"name"in c&&c.name||"fieldName"in c&&c.fieldName||null),u}_isUnclassedRenderer(e){const i=e.visualVariables;let r=!1;return jb(e)&&e.classBreakInfos&&e.classBreakInfos.length===1&&i&&(r=e.field?i.some(n=>!(!n||e.field!==n.field||(e.normalizationField||n.normalizationField)&&e.normalizationField!==n.normalizationField)):!!i.length),r}};d([p()],_n.prototype,"children",void 0),d([p({readOnly:!0})],_n.prototype,"effectList",null),d([p()],_n.prototype,"layerView",void 0),d([p()],_n.prototype,"layer",void 0),d([p()],_n.prototype,"legendElements",void 0),d([p({readOnly:!0})],_n.prototype,"opacity",null),d([p()],_n.prototype,"parent",void 0),d([p({readOnly:!0,dependsOn:[]})],_n.prototype,"ready",null),d([p()],_n.prototype,"hideLayersNotInCurrentView",void 0),d([p()],_n.prototype,"keepCacheOnDestroy",void 0),d([p()],_n.prototype,"respectLayerVisibility",void 0),d([p({readOnly:!0})],_n.prototype,"scale",null),d([p()],_n.prototype,"sublayerIds",void 0),d([p({readOnly:!0})],_n.prototype,"isScaleDriven",null),d([p()],_n.prototype,"title",void 0),d([p({readOnly:!0,dependsOn:["ready"],value:0})],_n.prototype,"version",null),d([p()],_n.prototype,"view",void 0),_n=d([A("esri.widgets.Legend.support.ActiveLayerInfo")],_n);const Pye=_n,Wg={state:"state",view:"view",allLayerViews:"all-layer-views",legendProperties:"legend-properties"},Oye=ye.ofType(Pye),LXe=["esri.layers.BuildingSceneLayer","esri.layers.CSVLayer","esri.layers.FeatureLayer","esri.layers.GeoJSONLayer","esri.layers.GeoRSSLayer","esri.layers.GroupLayer","esri.layers.HeatmapLayer","esri.layers.ImageryLayer","esri.layers.ImageryTileLayer","esri.layers.MapImageLayer","esri.layers.OGCFeatureLayer","esri.layers.PointCloudLayer","esri.layers.StreamLayer","esri.layers.SceneLayer","esri.layers.SubtypeGroupLayer","esri.layers.TileLayer","esri.layers.VoxelLayer","esri.layers.WFSLayer","esri.layers.WMSLayer","esri.layers.WMTSLayer","esri.layers.WCSLayer","esri.layers.LinkChartLayer","esri.layers.knowledgeGraph.KnowledgeGraphSublayer"],Lye="view.basemapView.baseLayerViews",Rye="view.groundView.layerViews",Fye="view.basemapView.referenceLayerViews",RXe=[Lye,Rye,"view.layerViews",Fye];let Ll=class extends he{constructor(e){super(e),this._layerViewByLayerId={},this._layerInfosByLayerViewId={},this._activeLayerInfosByLayerViewId={},this._activeLayerInfosWithNoParent=new ye,this.activeLayerInfos=new Oye,this.basemapLegendVisible=!1,this.groundLegendVisible=!1,this.hideLayersNotInCurrentView=!1,this.keepCacheOnDestroy=!1,this.respectLayerVisibility=!0,this.layerInfos=[],this.view=null}initialize(){this.addHandles(J(()=>this.view,()=>this._viewHandles(),Le),Wg.view),this.addHandles(nC(()=>this._refresh()))}destroy(){this._destroyViewActiveLayerInfos(),this.view=null}get state(){return this.get("view.ready")?"ready":"disabled"}_viewHandles(){this.removeHandles(Wg.state),this.view&&this.addHandles(J(()=>this.state,()=>this._stateHandles(),Le),Wg.state)}_stateHandles(){this._resetAll(),this.state==="ready"&&this._watchPropertiesAndAllLayerViews()}_resetAll(){this.removeHandles([Wg.allLayerViews,Wg.legendProperties]),this._destroyViewActiveLayerInfos(),this.activeLayerInfos.removeAll()}_destroyViewActiveLayerInfos(){Object.keys(this._activeLayerInfosByLayerViewId).forEach(this._destroyViewActiveLayerInfo,this)}_destroyViewActiveLayerInfo(e){this.removeHandles(e);const i=this._activeLayerInfosByLayerViewId[e];delete this._activeLayerInfosByLayerViewId[e],i&&i.parent&&i.parent.children.remove(i)}_watchPropertiesAndAllLayerViews(){const{view:e}=this;if(!e)return;const{allLayerViews:i}=e;i.length&&this._refresh(),this.addHandles(i.on("change",r=>this._allLayerViewsChangeHandle(r)),Wg.allLayerViews),this.addHandles(J(()=>[this.layerInfos,this.basemapLegendVisible,this.groundLegendVisible],()=>this._propertiesChangeHandle()),Wg.legendProperties)}_allLayerViewsChangeHandle(e){e.removed.forEach(i=>this._destroyViewActiveLayerInfo(i.uid)),this._refresh()}_propertiesChangeHandle(){this._destroyViewActiveLayerInfos(),this._refresh()}_refresh(){this._layerInfosByLayerViewId={},this.activeLayerInfos.removeAll(),this._generateLayerViews().filter(this._filterLayerViewsByLayerInfos,this).filter(this._isLayerViewSupported,this).forEach(this._generateActiveLayerInfo,this),this._sortActiveLayerInfos(this.activeLayerInfos)}_sortActiveLayerInfos(e){const i=this.view;if(e.length<2||!i)return;const r=[];e.forEach(s=>{if(!s.parent){const o=s.layer.parent,a=o&&"uid"in o&&this._layerViewByLayerId[o.uid],l=a&&this._activeLayerInfosByLayerViewId[a.uid];l&&e.includes(l)&&(r.push(s),s.parent=l,l.children.add(s),this._sortActiveLayerInfos(l.children))}}),e.removeMany(r);const n={};i.allLayerViews.forEach((s,o)=>n[s.layer.uid]=o),e.sort((s,o)=>{const a=n[s.layer.uid]||0;return(n[o.layer.uid]||0)-a})}_generateLayerViews(){const e=[];return RXe.filter(this._filterLayerViews,this).map(this.get,this).filter(i=>i!=null).forEach(this._collectLayerViews("layerViews",e)),e}_filterLayerViews(e){const i=!this.basemapLegendVisible&&(e===Lye||e===Fye),r=!this.groundLegendVisible&&e===Rye;return!i&&!r}_collectLayerViews(e,i){const r=n=>(n&&n.forEach(s=>{i.push(s),r(s[e])}),i);return r}_filterLayerViewsByLayerInfos(e){const i=this.layerInfos;return!i||!i.length||i.some(r=>this._hasLayerInfo(r,e))}_hasLayerInfo(e,i){const r=this._isLayerUIDMatching(e.layer,i.layer.uid);return r&&(this._layerInfosByLayerViewId[i.uid]=e),r}_isLayerUIDMatching(e,i){return e&&(e.uid===i||this._hasLayerUID(e.layers,i))}_hasLayerUID(e,i){return e&&e.some(r=>this._isLayerUIDMatching(r,i))}_isLayerViewSupported(e){return!!LXe.includes(e.layer.declaredClass)&&(this._layerViewByLayerId[e.layer.uid]=e,!0)}_generateActiveLayerInfo(e){this._isLayerActive(e)?this._buildActiveLayerInfo(e):(this.removeHandles(e.uid),this.addHandles(J(()=>{var i;return[e.legendEnabled,(i=e.layer)==null?void 0:i.legendEnabled]},()=>this._layerActiveHandle(e)),e.uid))}_layerActiveHandle(e){this._isLayerActive(e)&&(this.removeHandles(e.uid),this._buildActiveLayerInfo(e))}_isLayerActive(e){return!this.respectLayerVisibility||e.legendEnabled&&e.get("layer.legendEnabled")}_buildActiveLayerInfo(e){var a;const i=e.layer,r=e.uid,n=this._layerInfosByLayerViewId[r];let s=this._activeLayerInfosByLayerViewId[r];if(!s){const l=n&&n.title!==void 0&&n.layer.uid===i.uid;s=new Pye({layer:i,layerView:e,title:l?n.title:i.title,view:this.view,respectLayerVisibility:this.respectLayerVisibility,hideLayersNotInCurrentView:this.hideLayersNotInCurrentView,keepCacheOnDestroy:this.keepCacheOnDestroy,sublayerIds:n&&n.sublayerIds||[]}),this._activeLayerInfosByLayerViewId[r]=s}const o=i.parent&&"uid"in i.parent?this._layerViewByLayerId[(a=i.parent)==null?void 0:a.uid]:null;if(s.parent=this._activeLayerInfosByLayerViewId[o==null?void 0:o.uid],!this.hasHandles(r)){const l=[J(()=>i.title,c=>this._titleHandle(c,s)),J(()=>[i.opacity,"renderer"in i&&i.renderer,"pointSymbol"in i&&i.pointSymbol,"lineSymbol"in i&&i.lineSymbol,"polygonSymbol"in i&&i.polygonSymbol],()=>this._constructLegendElements(s)),tn(()=>{var c;return((c=this.view)==null?void 0:c.stationary)===!0},()=>this._scaleHandle(s),Le),J(()=>e._effectiveRenderer,()=>this._constructLegendElements(s)),J(()=>"effect"in i&&i.effect,()=>this._constructLegendElements(s))];if(this.respectLayerVisibility){const c=J(()=>e.legendEnabled,h=>this._legendEnabledHandle(h,s)),u=J(()=>i.legendEnabled,h=>this._legendEnabledHandle(h,s));l.push(c,u)}this.addHandles(l,r)}s.isScaleDriven||this._constructLegendElements(s),this._addActiveLayerInfo(s)}_titleHandle(e,i){i.title=e,this._constructLegendElements(i)}_legendEnabledHandle(e,i){e?this._addActiveLayerInfo(i):this._removeActiveLayerInfo(i)}_scaleHandle(e){(e.isScaleDriven||e.hideLayersNotInCurrentView)&&this._constructLegendElements(e)}_addActiveLayerInfo(e){var n;const{layerView:i,layer:r}=e;if(this._isLayerActive(i)&&!this.activeLayerInfos.includes(e)){const s=e.parent;if(s)s.children.includes(e)||s.children.push(e),this._sortActiveLayerInfos(s.children);else{const o=(n=this.layerInfos)==null?void 0:n.some(a=>a.layer.uid===r.uid);r.parent&&"uid"in r.parent&&!o?this._activeLayerInfosWithNoParent.add(e):(this.activeLayerInfos.add(e),this._sortActiveLayerInfos(this.activeLayerInfos))}if(this._activeLayerInfosWithNoParent.length){const o=[];this._activeLayerInfosWithNoParent.forEach(a=>{const l=a.layer.parent,c=l&&"uid"in l?this._layerViewByLayerId[l==null?void 0:l.uid]:null,u=this._activeLayerInfosByLayerViewId[c==null?void 0:c.uid];u&&(o.push(a),a.parent=u)}),o.length&&(this._activeLayerInfosWithNoParent.removeMany(o),o.forEach(a=>this._addActiveLayerInfo(a)))}}}_removeActiveLayerInfo(e){const i=e.parent;i?i.children.remove(e):this.activeLayerInfos.remove(e)}_constructLegendElements(e){const i=e.layer;"featureCollections"in i&&i.featureCollections?e.buildLegendElementsForFeatureCollections(i.featureCollections):"featureReduction"in i&&i.featureReduction&&"renderer"in i.featureReduction&&(i.featureReduction.type==="binning"||i.featureReduction.type==="cluster")?e.buildLegendElementsForFeatureReduction(i.featureReduction):"renderer"in i&&i.renderer&&!("sublayers"in i)?e.buildLegendElementsForRenderer(i.renderer):"url"in i&&i.url?e.buildLegendElementsForTools():e.children.forEach(r=>this._constructLegendElements(r))}};d([p({type:Oye})],Ll.prototype,"activeLayerInfos",void 0),d([p()],Ll.prototype,"basemapLegendVisible",void 0),d([p()],Ll.prototype,"groundLegendVisible",void 0),d([p()],Ll.prototype,"hideLayersNotInCurrentView",void 0),d([p()],Ll.prototype,"keepCacheOnDestroy",void 0),d([p()],Ll.prototype,"respectLayerVisibility",void 0),d([p()],Ll.prototype,"layerInfos",void 0),d([p({readOnly:!0})],Ll.prototype,"state",null),d([p()],Ll.prototype,"view",void 0),Ll=d([A("esri.widgets.Legend.LegendViewModel")],Ll);const FXe=Ll,Jt="esri-legend--card",P_="esri-legend",Fe={activated:`${Jt}__carousel-indicator--activated`,base:Jt,stacked:`${P_}--stacked`,carouselTitle:`${Jt}__carousel-title`,indicator:`${Jt}__carousel-indicator`,intervalSeparator:`${Jt}__interval-separator`,imageryLayerStretchedImage:`${Jt}__imagery-layer-image--stretched`,imageLabel:`${Jt}__image-label`,layerCaption:`${Jt}__layer-caption`,labelElement:`${Jt}__label-element`,layerRow:`${Jt}__layer-row`,labelCell:`${Jt}__label-cell`,message:`${Jt}__message`,rampLabel:`${Jt}__ramp-label`,section:`${Jt}__section`,relationshipSection:`${Jt}__relationship-section`,serviceCaptionText:`${Jt}__service-caption-text`,serviceContent:`${Jt}__service-content`,service:`${Jt}__service`,groupLayer:`${Jt}__group-layer`,groupLayerChild:`${Jt}__group-layer-child`,symbol:`${Jt}__symbol`,sizeRampRow:`${Jt}__size-ramp-row`,symbolRow:`${Jt}__symbol-row`,symbolCell:`${Jt}__symbol-cell`,indicatorContainer:`${Jt}__carousel-indicator-container`,intervalSeparatorsContainer:`${Jt}__interval-separators-container`,relationshipLabelContainer:`${Jt}__relationship-label-container`,labelContainer:`${Jt}__label-container`,serviceCaptionContainer:`${Jt}__service-caption-container`,symbolContainer:`${Jt}__symbol-container`,sizeRampContainer:`${Jt}__size-ramp-container`,sizeRampPreview:`${Jt}__size-ramp-preview`,pieChartRampPreview:`${Jt}__pie-chart-ramp-preview`,rampContainer:`${P_}__ramps`,sizeRampHorizontal:`${P_}__size-ramp--horizontal`,rampLabelsContainer:`${P_}__ramp-labels`,layerInfo:`${P_}__layer-cell ${P_}__layer-cell--info`,univariateAboveAndBelowColorRamp:"esri-univariate-above-and-below-ramp__color--card",hidden:"esri-hidden"},DXe=dP(),Dye=10,i7=20,yR=10,r7=20,n7={univariateAboveAndBelowSymbol:"esri-univariate-above-and-below-ramp__symbol",colorRamp:"esri-legend__color-ramp"};function NXe(t="vertical"){const e="stroke:rgb(200, 200, 200);stroke-width:1";return t==="vertical"?M("svg",{height:"4",width:"10"},M("line",{x1:"0",y1:"2",x2:"10",y2:"2",style:e})):M("svg",{height:"10",width:"10"},M("line",{x1:"5",y1:"0",x2:"5",y2:"10",style:e}))}function VXe(t,e="vertical"){const i=document.createElement("div");return i.style.height=`${i7}px`,i.className=n7.univariateAboveAndBelowSymbol,t!=null&&(i.style.opacity=t.toString()),DXe.append(i,NXe.bind(null,e)),i}function Nye(t,e,i="vertical",r){t.infos.forEach((n,s)=>{if(r&&s===2)n.preview=VXe(e,i);else{const o=or(n.size)+(i==="horizontal"?r7:yR),a=n.preview,l=(a==null?void 0:a.tagName.toLowerCase())==="div",c=l?a:document.createElement("div");c.className=n7.univariateAboveAndBelowSymbol,i==="horizontal"?c.style.width=`${o}px`:c.style.height=`${o}px`,!l&&a&&c.appendChild(a),n.preview=c}})}function uO(t,e="classic"){const i=t.infos;return e==="classic"?(or(i[0].size)+yR)/2:(or(i[0].size)-or(i[i.length-1].size))/2}function Dw(t,e){if(!t)return null;const i=t.infos.map(n=>n.color),r=s0(e.type==="full"?i:e.type==="above"?i.slice(0,3):i.slice(2,5),{width:e.width,height:e.height,align:e.rampAlignment,effectList:e.effectList,ariaLabel:e.ariaLabel});return r.className=n7.colorRamp,e.opacity!=null&&(r.style.opacity=e.opacity.toString()),r}function m8(t,e,i,r="vertical"){let n=0;const s=t.infos,o=Math.floor(s.length/2),a=e==="full"||e==="above"?0:o,l=e==="full"||e==="below"?s.length-1:o;for(let c=a;c<=l;c++)i&&c===o?n+=r==="horizontal"?Dye:i7:n+=or(s[c].size)+(r==="horizontal"?r7:yR);return Math.round(n)}function Nw(t,e,i,r="vertical"){const n=m8(t,e,i,r),s=t.infos,o=Math.floor(s.length/2),a=e==="full"||e==="above"?0:o,l=e==="full"||e==="below"?s.length-1:o,c=e==="full"?s[a].size+s[l].size:e==="above"?s[a].size:s[l].size,u=i?r==="vertical"?i7:Dye:0,h=r==="vertical"?yR*(e==="full"?2:1):r7*(e==="full"?2:1);return Math.round(n-(or(c)/2+u/2+h/2))}function Vye(t,e,i="vertical"){const r=t.infos;let n=r.find(({type:o})=>o==="size-ramp"),s=r.find(({type:o})=>o==="color-ramp");return n&&(n={...n},n.infos=[...n.infos],Nye(n,e,i,!0)),s&&(s={...s},s.infos=[...s.infos]),i==="horizontal"&&(n==null||n.infos.reverse(),s==null||s.infos.reverse()),{sizeRampElement:n,colorRampElement:s}}function zye(t,e="vertical"){const i=t.infos;let r=i.find(({type:s})=>s==="size-ramp"),n=i.find(({type:s})=>s==="color-ramp");return r&&(r={...r},r.infos=[...r.infos],Nye(r,null,e,!1)),n&&(n={...n},n.infos=[...n.infos]),e==="horizontal"&&(r==null||r.infos.reverse(),n==null||n.infos.reverse()),{sizeRampElement:r,colorRampElement:n}}function zXe(t,e){return e}function qn(t){const e=this;t.appendChild(e)}function zm(t,e,i){if(!e)return;if(typeof e=="string"||typeof e=="number")return e;if("value"in e||"unit"in e)return Os(t.dotValue,e);if("colorName"in e&&"bandName"in e)return t[e.colorName]+": "+(t[e.bandName]||e.bandName);if("showCount"in e)return e.showCount?t.clusterCountTitle:void 0;let r=null;return zXe(e,i)?r=e.ratioPercentTotal?"showRatioPercentTotal":e.ratioPercent?"showRatioPercent":e.ratio?"showRatio":e.normField?"showNormField":e.field?"showField":null:jye(e,i)&&(r=e.normField?"showNormField":e.normByPct?"showNormPct":e.field?"showField":null),r?Os(r==="showField"?"{field}":t[r],{field:e.field,normField:e.normField}):void 0}function jye(t,e){return!e}function Bye(t,e){return!!(e&&e==="Stretched"&&t.version>=10.3&&t.declaredClass==="esri.layers.ImageryLayer")}const jXe=25,BXe=25,UXe=768,GXe=100;var wI;(function(t){t.Auto="auto",t.Stack="stack",t.SideBySide="side-by-side"})(wI||(wI={}));const HXe="#ddd",O_=window.devicePixelRatio;function qXe(t){if(t){if(t.type.includes("3d")){const e=t.symbolLayers&&t.symbolLayers.length;if(!e)return;const i=t.symbolLayers.at(e-1),r=i.resource&&i.resource.primitive;return r==="circle"||r==="cross"||r==="kite"||r==="sphere"||r==="cube"||r==="diamond"}{const e=t.style;return e==="circle"||e==="diamond"||e==="cross"}}}function WXe(t){if(t){if(t.type.includes("3d")){const e=t.symbolLayers&&t.symbolLayers.length;if(!e)return;const i=t.symbolLayers.at(e-1).get("resource.primitive");return i==="triangle"||i==="cone"||i==="tetrahedron"}return t.style==="triangle"}}let Hc=class extends di{constructor(e,i){super(e,i),this._hasIndicators=!1,this._selectedSectionName=null,this._sectionNames=[],this._sectionMap=new Map,this.activeLayerInfos=null,this.headingLevel=3,this.layout=wI.Stack,this.messages=null,this.messagesCommon=null,this.type="card",this.view=null}initialize(){this.addHandles(J(()=>this.activeLayerInfos,e=>{this.removeAllHandles(),this._watchForSectionChanges(e)}))}render(){const{view:e}=this;this._hasIndicators=this.layout===wI.Auto&&e&&e.container.clientWidth<=UXe||this.layout===wI.Stack;const i=this.activeLayerInfos,r=i&&i.toArray().map(c=>this._renderLegendForLayer(c)).filter(c=>!!c);this._hasIndicators?this._selectedSectionName&&this._sectionNames.includes(this._selectedSectionName)||(this._selectedSectionName=this._sectionNames&&this._sectionNames[0]):this._selectedSectionName=null;const n=this._sectionNames.length,s=this._sectionNames.map((c,u)=>{const h=Os(this.messagesCommon.pagination.pageText,{index:u+1,total:n});return M("div",{key:c,role:"tab",id:c,"aria-label":h,"aria-controls":`${c}-panel`,"aria-selected":(this._selectedSectionName===c).toString(),tabIndex:this._selectedSectionName===c?0:-1,title:h,onclick:this._selectSection,onkeydown:this._focusSection,bind:this,class:this.classes(Fe.indicator,{[Fe.activated]:this._selectedSectionName===c}),"data-section-name":c})}),o=this._hasIndicators&&n>1?M("div",{class:Fe.indicatorContainer,key:"carousel-navigation",role:"tablist"},s):null,a=this._hasIndicators?this._sectionMap.get(this._selectedSectionName):r&&r.length?r:null,l={[Fe.stacked]:this._hasIndicators};return M("div",{class:this.classes(Fe.base,l)},a||M("div",{class:Fe.message},this.messages.noLegend),o)}_selectSection(e){const i=e.target.getAttribute("data-section-name");i&&(this._selectedSectionName=i)}_focusSection(e){switch(e.key){case"ArrowLeft":case"ArrowRight":this._switchSectionOnArrowPress(e);break;case"Enter":case" ":this._selectSection(e)}}_switchSectionOnArrowPress(e){const i=e.key,r=i==="ArrowLeft"?-1:1,n=e.target.getAttribute("data-section-name"),s=this._sectionNames.indexOf(n),o=this._sectionNames;let a=null;s!==-1&&(o[s+r]?a=document.getElementById(o[s+r]):i==="ArrowLeft"?a=document.getElementById(o[o.length-1]):i==="ArrowRight"&&(a=document.getElementById(o[0])),a==null||a.focus())}_watchForSectionChanges(e){if(this._generateSectionNames(),e){e.forEach(r=>{const n=`activeLayerInfo-${r.layer.uid}-version-change`;this.removeHandles(n),this._watchForSectionChanges(r.children),this.addHandles(J(()=>r.version,()=>this._generateSectionNames()),n)});const i="activeLayerInfos-collection-change";this.removeHandles(i),this.addHandles(e.on("change",()=>this._watchForSectionChanges(e)),i)}}_generateSectionNames(){this._sectionNames.length=0,this._selectedSectionName=null,this.activeLayerInfos&&this.activeLayerInfos.forEach(this._generateSectionNamesForActiveLayerInfo,this)}_getSectionName(e,i,r){return`${this.id}${e.uid}-type-${i.type}-${r}`}_generateSectionNamesForActiveLayerInfo(e){e.children.forEach(this._generateSectionNamesForActiveLayerInfo,this),e.legendElements&&e.legendElements.forEach((i,r)=>{this._sectionNames.push(this._getSectionName(e.layer,i,r))})}_renderLegendForLayer(e){if(!e.ready)return null;if(e.children.length){const i=e.children.map(r=>this._renderLegendForLayer(r)).toArray();return M("div",{key:e.layer.uid,class:this.classes(Fe.service,Fe.groupLayer)},M("div",{class:Fe.serviceCaptionContainer},e.title),i)}{const i=e.legendElements;if(i&&!i.length)return null;const r=i.some(o=>o.type==="relationship-ramp"),n=i.map((o,a)=>this._renderLegendForElement(o,e,a,r)).filter(o=>!!o);if(!n.length)return null;const s={[Fe.groupLayerChild]:!!e.parent};return M("div",{key:e.layer.uid,class:this.classes(Fe.service,s)},M("div",{class:Fe.serviceCaptionContainer},M("div",{class:Fe.serviceCaptionText},e.title)),M("div",{class:Fe.serviceContent},n))}}_renderLegendForElement(e,i,r,n=!1,s=!1){const o=e.type==="color-ramp",a=e.type==="opacity-ramp",l=e.type==="size-ramp",c=i.layer;let u=null;if(typeof e.title=="string")u=e.title;else if(e.title){const v=e.title,b=zm(this.messages,v,o||a);u=v.title?`${v.title} (${b})`:b}const h=this._getSectionName(c,e,r),f=this._hasIndicators&&!s?M("div",null,M(Ql,{level:this.headingLevel,class:Fe.carouselTitle},i.title),M(Ql,{level:pw(this.headingLevel),class:Fe.layerCaption},u)):u?M(Ql,{level:this.headingLevel,class:Fe.layerCaption},u):null,m=i.effectList;let g=null;if(e.type==="symbol-table"){const v=e.infos.map((b,w)=>this._renderLegendForElementInfo(b,i,e.legendType,w)).filter(b=>!!b);if(v.length){const b=v[0].properties.classes&&v[0].properties.classes[Fe.symbolRow],w={[Fe.labelContainer]:!b&&!n,[Fe.relationshipLabelContainer]:n};g=M("div",{class:this.classes(w)},v)}}else e.type==="color-ramp"||e.type==="opacity-ramp"||e.type==="heatmap-ramp"?g=this._renderLegendForRamp(e,c.opacity,m):l?g=this._renderSizeRamp(e,c.opacity):e.type==="pie-chart-ramp"?g=this._renderPieChartRamp(e):e.type==="relationship-ramp"?g=tye(e,this.id,{opacity:c.opacity,effectList:m,ariaLabel:this.messages.previewRelationshipRampAriaLabel}):e.type==="univariate-above-and-below-ramp"?g=this._renderUnivariateAboveAndBelowRamp(e,c.opacity,m):e.type==="univariate-color-size-ramp"&&(g=this._renderUnivariateColorSizeRamp(e,c.opacity,m));if(!g)return null;const y=M("div",{key:h,class:Fe.section,id:`${h}-panel`,role:"tabpanel","aria-labelledby":h,tabIndex:0},[f,g]);return s||this._sectionMap.set(h,y),y}_renderPieChartRamp(e){return M("div",{class:Fe.pieChartRampPreview,bind:e.preview,afterCreate:qn})}_renderUnivariateAboveAndBelowRamp(e,i,r){var I;const{sizeRampElement:n,colorRampElement:s}=Vye(e,i,"horizontal");if(!n)return null;const o=m8(n,"full",!0,"horizontal"),a=Nw(n,"above",!0,"horizontal"),l=Nw(n,"below",!0,"horizontal"),c=12,u=(I=this.messages)==null?void 0:I.previewColorRampAriaLabel,h=Dw(s,{width:a,height:c,rampAlignment:"horizontal",opacity:i,type:"above",effectList:r,ariaLabel:u}),f=Dw(s,{width:l,height:c,rampAlignment:"horizontal",opacity:i,type:"below",effectList:r,ariaLabel:u}),m=uO(n,"card"),g=n.infos.map(T=>T.label),y=g.length-1,v=g.map((T,C)=>C===0||C===y?M("div",{key:C},T):null),b={display:"flex",flexDirection:"column"},w={display:"flex",flexDirection:"row"},x={marginTop:"3px",display:"flex"};ll(this.container)?x.marginRight=`${m}px`:x.marginLeft=`${m}px`;const S={width:`${o}px`,display:"flex",flexDirection:"row",justifyContent:"space-between"};return M("div",{class:Fe.layerRow,key:"size-ramp-preview",styles:b},M("div",{class:this.classes(Fe.symbolContainer,Fe.sizeRampHorizontal),styles:w},n.infos.map((T,C)=>M("div",{key:C,class:Fe.symbol,bind:T.preview,afterCreate:qn}))),h?M("div",{class:Fe.univariateAboveAndBelowColorRamp,styles:x,key:"color-ramp-preview"},M("div",{bind:h,afterCreate:qn}),M("div",{bind:f,afterCreate:qn})):null,M("div",{class:Fe.layerInfo},M("div",{class:Fe.rampLabelsContainer,styles:S},v)))}_renderUnivariateColorSizeRamp(e,i,r){var v;const{sizeRampElement:n,colorRampElement:s}=zye(e,"horizontal");if(!n)return null;const o=m8(n,"full",!1,"horizontal"),a=Nw(n,"full",!1,"horizontal"),l=Dw(s,{width:a,height:12,rampAlignment:"horizontal",opacity:i,type:"full",effectList:r,ariaLabel:(v=this.messages)==null?void 0:v.previewColorRampAriaLabel}),c=uO(n,"card"),u=n.infos.length-1,h=n.infos.map((b,w)=>w===0||w===u?M("div",{key:w},b.label):null),f={display:"flex",flexDirection:"column"},m={display:"flex",flexDirection:"row"},g={marginTop:"3px",display:"flex"};ll(this.container)?g.marginRight=`${c}px`:g.marginLeft=`${c}px`;const y={width:`${o}px`,display:"flex",flexDirection:"row",justifyContent:"space-between"};return M("div",{class:Fe.layerRow,key:"size-ramp-preview",styles:f},M("div",{class:this.classes(Fe.symbolContainer,Fe.sizeRampHorizontal),styles:m},n.infos.map((b,w)=>M("div",{key:w,class:Fe.symbol,bind:b.preview,afterCreate:qn}))),M("div",{class:Fe.univariateAboveAndBelowColorRamp,styles:g,key:"color-ramp-preview"},M("div",{bind:l,afterCreate:qn})),M("div",{class:Fe.layerInfo},M("div",{class:Fe.rampLabelsContainer,styles:y},h)))}_renderLegendForElementInfo(e,i,r,n){var a;const s=i.layer;if(e.type)return this._renderLegendForElement(e,i,n,!1,!0);const o=Bye(s,r);if(e.preview){if(!e.symbol||!e.symbol.type.includes("simple-fill")){if(!e.label)return M("div",{key:n,bind:e.preview,afterCreate:qn});const I={[Fe.symbolCell]:this._hasIndicators};return M("div",{key:n,class:this.classes(Fe.layerRow,{[Fe.symbolRow]:this._hasIndicators})},M("div",{class:this.classes(I),bind:e.preview,afterCreate:qn}),M("div",{class:this.classes(Fe.imageLabel,{[Fe.labelCell]:this._hasIndicators})},zm(this.messages,e.label,!1)||""))}let l=255,c=255,u=255,h=0,f=255,m=255,g=255,y=0;const v=e.symbol.color&&e.symbol.color.a,b=e.symbol.outline&&e.symbol.outline.color&&e.symbol.outline.color.a;v&&(l=e.symbol.color.r,c=e.symbol.color.g,u=e.symbol.color.b,h=e.symbol.color.a*s.opacity),b&&(f=e.symbol.outline.color.r,m=e.symbol.outline.color.g,g=e.symbol.outline.color.b,y=e.symbol.outline.color.a*s.opacity);const w=((a=e.symbol.color)==null?void 0:a.isBright)??!0,x=w?"rgba(255, 255, 255, .6)":"rgba(0, 0, 0, .6)",S={background:v?`rgba(${l}, ${c}, ${u}, ${h})`:"none",color:w?"black":"white",textShadow:`-1px -1px 0 ${x},
                                              1px -1px 0 ${x},
                                              -1px 1px 0 ${x},
                                              1px 1px 0 ${x}`,border:b?`1px solid rgba(${f}, ${m}, ${g}, ${y})`:"none",filter:bT(i.effectList)??void 0};return M("div",{key:n,class:Fe.layerRow},M("div",{class:Fe.labelElement,styles:S}," ",e.label," "))}if(e.src){const l=this._renderImage(e,s,o);return M("div",{key:n,class:Fe.layerRow},l,M("div",{class:Fe.imageLabel},e.label||""))}}_renderImage(e,i,r){const{label:n,src:s,opacity:o}=e,a={[Fe.imageryLayerStretchedImage]:r,[Fe.symbol]:!r},l={opacity:`${o??i.opacity}`};return M("img",{alt:zm(this.messages,n,!1),"aria-label":zm(this.messages,n,!1),src:s,border:0,width:e.width,height:e.height,class:this.classes(a),styles:l})}_renderSizeRampLines(e){const i=e.infos,r=i[0],n=i[i.length-1],s=r.symbol,o=this._hasIndicators,a=or(r.size+r.outlineSize)*O_,l=or(n.size+n.outlineSize)*O_,c=o?a:a+50*O_,u=o?a/2+50*O_:a,h=WXe(s),f=qXe(s),m=document.createElement("canvas");m.width=c,m.height=u,m.style.width=m.width/O_+"px",m.style.height=m.height/O_+"px";const g=m.getContext("2d");if(o){g.beginPath();const y=0,v=0,b=c/2-l/2,w=u;g.moveTo(y,v),g.lineTo(b,w);const x=c,S=0,I=c/2+l/2,T=u;g.moveTo(x,S),g.lineTo(I,T)}else{g.beginPath();const y=0,v=u/2-l/2,b=c,w=0;g.moveTo(y,v),g.lineTo(b,w);const x=0,S=u/2+l/2,I=c,T=u;g.moveTo(x,S),g.lineTo(I,T)}return g.strokeStyle=HXe,g.stroke(),M("div",{bind:m,afterCreate:qn,styles:o?{display:"flex",marginTop:`-${h?0:f?a/2:0}px`,marginBottom:`-${h?l:f?l/2:0}px`}:{display:"flex",marginRight:`-${h?0:f?a/2:0}px`,marginLeft:`-${h?0:f?l/2:0}px`}})}_renderSizeRamp(e,i){const r=e.infos,n=r[0].label,s=r[r.length-1].label;let o=r[0].preview,a=r[r.length-1].preview;const l=this._hasIndicators,c={"flex-direction":l?"column":"row-reverse"};o&&(o=o.cloneNode(!0),o.style.display="flex"),a&&(a=a.cloneNode(!0),a.style.display="flex");const u={opacity:i!=null?`${i}`:""};return M("div",{class:this.classes(Fe.layerRow,{[Fe.sizeRampRow]:l})},M("div",{class:Fe.rampLabel},l?n:s),M("div",{class:Fe.sizeRampContainer,styles:c},M("div",{bind:o,afterCreate:qn,class:Fe.sizeRampPreview,styles:u}),this._renderSizeRampLines(e),M("div",{bind:a,afterCreate:qn,class:Fe.sizeRampContainer,styles:u})),M("div",{class:Fe.rampLabel},l?s:n))}_renderLegendForRamp(e,i,r){const n=e.infos,s=e.type==="heatmap-ramp",o=n.length-1,a=BXe,l=o>2&&!s?jXe*o:GXe,c=l+20,u=10,h=n.slice(0).reverse();h.forEach((T,C)=>{T.offset=s?T.ratio:C/o});const f=h.length-1,m=h.length%2!=0&&h[h.length/2|0],g=m&&M("div",{class:Fe.intervalSeparatorsContainer},M("div",{class:Fe.intervalSeparator},"|"),M("div",{class:Fe.rampLabel},m.label)),y=n[n.length-1].label,v=n[0].label,b=[[{shape:{type:"path",path:`M0 ${a/2} L${u} 0 L${u} ${a} Z`},fill:h[0].color,stroke:{width:0}},{shape:{type:"rect",x:u,y:0,width:l,height:a},fill:{type:"linear",x1:u,y1:0,x2:l+u,y2:0,colors:h},stroke:{width:0}},{shape:{type:"path",path:`M${l+u} 0 L${c} ${a/2} L${l+u} ${a} Z`},fill:h[f].color,stroke:{width:0}}]],w=Qge(b,c,a),{messages:x}=this,S={filter:bT(r)??void 0,opacity:i==null?void 0:`${i}`},I={justifyContent:"center"};return M("div",{class:Fe.layerRow,styles:I},M("div",{class:Fe.rampLabel},s?x[y]:y),M("div",{class:Fe.symbolContainer},M("div",{styles:S},w),g),M("div",{class:Fe.rampLabel},s?x[v]:v))}};d([p()],Hc.prototype,"activeLayerInfos",void 0),d([p()],Hc.prototype,"headingLevel",void 0),d([p()],Hc.prototype,"layout",void 0),d([p(),ut("esri/widgets/Legend/t9n/Legend")],Hc.prototype,"messages",void 0),d([p(),ut("esri/t9n/common")],Hc.prototype,"messagesCommon",void 0),d([p({readOnly:!0})],Hc.prototype,"type",void 0),d([p()],Hc.prototype,"view",void 0),d([wr()],Hc.prototype,"_selectSection",null),Hc=d([A("esri.widgets.Legend.styles.Card")],Hc);const fF=Hc,mi="esri-legend",Je={service:`${mi}__service`,label:`${mi}__service-label`,layer:`${mi}__layer`,groupLayer:`${mi}__group-layer`,groupLayerChild:`${mi}__group-layer-child`,layerTable:`${mi}__layer-table`,layerTableSizeRamp:`${mi}__layer-table--size-ramp`,layerChildTable:`${mi}__layer-child-table`,layerCaption:`${mi}__layer-caption`,layerBody:`${mi}__layer-body`,layerRow:`${mi}__layer-row`,layerCell:`${mi}__layer-cell`,layerInfo:`${mi}__layer-cell ${mi}__layer-cell--info`,imageryLayerStretchedImage:`${mi}__imagery-layer-image--stretched`,imageryLayerCellStretched:`${mi}__imagery-layer-cell--stretched`,imageryLayerInfoStretched:`${mi}__imagery-layer-info--stretched`,symbolContainer:`${mi}__layer-cell esri-legend__layer-cell--symbols`,symbol:`${mi}__symbol`,rampContainer:`${mi}__ramps`,sizeRamp:`${mi}__size-ramp`,colorRamp:`${mi}__color-ramp`,opacityRamp:`${mi}__opacity-ramp`,borderlessRamp:`${mi}__borderless-ramp`,rampTick:`${mi}__ramp-tick`,rampFirstTick:`${mi}__ramp-tick-first`,rampLastTick:`${mi}__ramp-tick-last`,rampLabelsContainer:`${mi}__ramp-labels`,rampLabel:`${mi}__ramp-label`,univariateAboveAndBelowSymbol:"esri-univariate-above-and-below-ramp__symbol",univariateAboveAndBelowLabel:"esri-univariate-above-and-below-ramp__label",message:`${mi}__message`,header:"esri-widget__heading",hidden:"esri-hidden"},JXe=`${mi}__`,ZXe=24,LQ={display:"flex",alignItems:"flex-start"},mF={marginLeft:"3px"},L_={display:"table-cell",verticalAlign:"middle"};let o0=class extends di{constructor(e,i){super(e,i),this.activeLayerInfos=null,this.headingLevel=3,this.messages=null,this.type="classic"}render(){const e=this.activeLayerInfos,i=e&&e.toArray().map(r=>this._renderLegendForLayer(r)).filter(r=>!!r);return M("div",null,i&&i.length?i:M("div",{class:Je.message},this.messages.noLegend))}_renderLegendForLayer(e){if(!e.ready)return null;const i=!!e.children.length,r=`${JXe}${e.layer.uid}-version-${e.version}`,n=e.title?Ql({level:this.headingLevel,class:this.classes(Je.header,Je.label)},e.title):null;if(i){const s=e.children.map(o=>this._renderLegendForLayer(o)).toArray();return M("div",{key:r,class:this.classes(Je.service,Je.groupLayer)},n,s)}{const s=e.legendElements;if(s&&!s.length)return null;const o=s.map(l=>this._renderLegendForElement(l,e.layer,e.effectList)).filter(l=>!!l);if(!o.length)return null;const a={[Je.groupLayerChild]:!!e.parent};return M("div",{key:r,class:this.classes(Je.service,a),tabIndex:0},n,M("div",{class:Je.layer},o))}}_renderLegendForElement(e,i,r,n){const s=e.type==="color-ramp",o=e.type==="opacity-ramp",a=e.type==="size-ramp";let l=null;if(e.type==="symbol-table"||a){const g=e.infos.map(y=>this._renderLegendForElementInfo(y,i,r,a,e.legendType)).filter(y=>!!y);g.length&&(l=M("div",{class:Je.layerBody},g))}else e.type==="color-ramp"||e.type==="opacity-ramp"||e.type==="heatmap-ramp"||e.type==="stretch-ramp"?l=this._renderLegendForRamp(e,i.opacity):e.type==="relationship-ramp"?l=tye(e,this.id,{opacity:i.opacity,effectList:r,ariaLabel:this.messages.previewRelationshipRampAriaLabel}):e.type==="pie-chart-ramp"?l=this._renderPieChartRamp(e):e.type==="univariate-above-and-below-ramp"?l=this._renderUnivariateAboveAndBelowRamp(e,i.opacity,r):e.type==="univariate-color-size-ramp"&&(l=this._renderUnivariateColorSizeRamp(e,i.opacity,r));if(!l)return null;const c=e.title;let u=null;if(typeof c=="string")u=c;else if(c){const g=zm(this.messages,c,s||o);u=jye(c,s||o)&&c.title?`${c.title} (${g})`:g}const h=n?Je.layerChildTable:Je.layerTable,f=u?M("div",{class:Je.layerCaption},u):null,m={[Je.layerTableSizeRamp]:a||!n};return M("div",{class:this.classes(h,m)},f,l)}_renderPieChartRamp(e){return M("div",{bind:e.preview,afterCreate:qn})}_renderUnivariateAboveAndBelowRamp(e,i,r){var T;const{sizeRampElement:n,colorRampElement:s}=Vye(e,i);if(!n)return null;const o=(T=this.messages)==null?void 0:T.previewColorRampAriaLabel,a=Nw(n,"above",!0),l=Nw(n,"below",!0),c=12,u=Dw(s,{width:c,height:a,rampAlignment:"vertical",opacity:i,type:"above",effectList:r,ariaLabel:o}),h=Dw(s,{width:c,height:l,rampAlignment:"vertical",opacity:i,type:"below",effectList:r,ariaLabel:o}),f=uO(n),m=n.infos.map(C=>C.label),g=m.map((C,E)=>E===0?M("div",{key:E,class:C?u?Je.univariateAboveAndBelowLabel:Je.rampLabel:void 0},C):E===2?M("div",null):null),y=m.length-1,v=Math.floor(m.length/2),b=m.map((C,E)=>E===v||E===y?M("div",{key:E,class:C?u?Je.univariateAboveAndBelowLabel:Je.rampLabel:void 0},C):null),w={display:"table-cell",verticalAlign:"middle"},x={marginTop:`${f}px`},S={height:`${a}px`},I={height:`${l}px`};return M("div",{key:"univariate-above-and-below-ramp-preview",styles:LQ},M("div",{class:Je.layerBody},n.infos.map((C,E)=>M("div",{class:this.classes(Je.layerRow,Je.sizeRamp)},M("div",{class:Je.symbol,styles:w,bind:C.preview,afterCreate:qn}),u||E%2!=0?null:M("div",{class:Je.layerInfo},m[E])))),u?M("div",{styles:x,key:"color-ramp-preview"},M("div",{styles:mF},M("div",{styles:L_},M("div",{class:Je.rampContainer,bind:u,afterCreate:qn})),M("div",{styles:L_},M("div",{class:Je.rampLabelsContainer,styles:S},g))),M("div",{styles:mF},M("div",{styles:L_},M("div",{class:Je.rampContainer,bind:h,afterCreate:qn})),M("div",{styles:L_},M("div",{class:Je.rampLabelsContainer,styles:I},b)))):null)}_renderUnivariateColorSizeRamp(e,i,r){var y;const{sizeRampElement:n,colorRampElement:s}=zye(e);if(!n)return null;const o=uO(n),a=12,l=Nw(n,"full",!1),c=Dw(s,{width:a,height:l,rampAlignment:"vertical",opacity:i,type:"full",effectList:r,ariaLabel:(y=this.messages)==null?void 0:y.previewColorRampAriaLabel}),u=n.infos.length-1,h=n.infos.map((v,b)=>b===0||b===u?M("div",{key:b,class:v.label?s?Je.univariateAboveAndBelowLabel:Je.rampLabel:void 0},v.label):null),f={display:"table-cell",verticalAlign:"middle"},m={marginTop:`${o}px`},g={height:`${l}px`};return M("div",{key:"univariate-above-and-below-ramp-preview",styles:LQ},M("div",{class:Je.layerBody},n.infos.map(v=>M("div",{class:this.classes(Je.layerRow,Je.sizeRamp)},M("div",{class:Je.symbol,styles:f,bind:v.preview,afterCreate:qn})))),M("div",{styles:m,key:"color-ramp-preview"},M("div",{styles:mF},M("div",{styles:L_},M("div",{class:Je.rampContainer,bind:c,afterCreate:qn})),M("div",{styles:L_},M("div",{class:Je.rampLabelsContainer,styles:g},h)))))}_renderLegendForRamp(e,i){const r=e.infos,n=e.type==="opacity-ramp",s=e.type==="heatmap-ramp",o=e.type==="stretch-ramp",a=e.preview,l=n?Je.opacityRamp:"";a.className=`${Je.colorRamp} ${l}`,i!=null&&(a.style.opacity=i.toString());const c=r.map(f=>M("div",{class:f.label?Je.rampLabel:void 0},s?this.messages[f.label]||f.label:o?this._getStretchStopLabel(f):f.label)),u={width:`${ZXe}px`},h={height:a.style.height};return M("div",{class:Je.layerRow},M("div",{class:Je.symbolContainer,styles:u},M("div",{class:Je.rampContainer,bind:a,afterCreate:qn})),M("div",{class:Je.layerInfo},M("div",{class:Je.rampLabelsContainer,styles:h},c)))}_getStretchStopLabel(e){return e.label?this.messages[e.label]+": "+(typeof e.value=="string"?e.value:po(e.value,{style:"decimal",notation:e.value.toString().includes("e")?"scientific":"standard"})):""}_renderLegendForElementInfo(e,i,r,n,s){if(e.type)return this._renderLegendForElement(e,i,r,!0);let o=null;const a=Bye(i,s);if(e.preview?o=M("div",{class:Je.symbol,bind:e.preview,afterCreate:qn}):e.src&&(o=this._renderImage(e,i,a)),!o)return null;const l={[Je.imageryLayerInfoStretched]:a},c={[Je.imageryLayerInfoStretched]:a,[Je.sizeRamp]:!a&&n};return M("div",{class:Je.layerRow},M("div",{class:this.classes(Je.symbolContainer,c)},o),M("div",{class:this.classes(Je.layerInfo,l)},zm(this.messages,e.label,!1)||""))}_renderImage(e,i,r){const{label:n,src:s,opacity:o}=e,a={[Je.imageryLayerStretchedImage]:r,[Je.symbol]:!r},l={opacity:`${o??i.opacity}`};return M("img",{alt:zm(this.messages,n,!1),"aria-label":zm(this.messages,n,!1),src:s,border:0,width:e.width,height:e.height,class:this.classes(a),styles:l})}};d([p()],o0.prototype,"activeLayerInfos",void 0),d([p()],o0.prototype,"headingLevel",void 0),d([p(),ut("esri/widgets/Legend/t9n/Legend")],o0.prototype,"messages",void 0),d([p({readOnly:!0})],o0.prototype,"type",void 0),o0=d([A("esri.widgets.Legend.styles.Classic")],o0);const R_=o0,AM={base:"esri-legend",widget:"esri-widget",panel:"esri-widget--panel",widgetIcon:"esri-icon-layer-list"};let Gn=class extends di{constructor(e,i){super(e,i),this.headingLevel=3,this.iconClass=AM.widgetIcon,this.icon=null,this.messages=null,this.style=new R_,this.viewModel=new FXe}initialize(){this.addHandles([ui(()=>this.view,"resize",()=>this.scheduleRender()),ui(()=>this.activeLayerInfos,"change",()=>this._refreshActiveLayerInfos(this.activeLayerInfos)),J(()=>this.headingLevel,e=>{const{style:i}=this;i&&(i.headingLevel=e)}),J(()=>this.style,(e,i)=>{i&&e!==i&&i.destroy(),e&&(e.activeLayerInfos=this.activeLayerInfos,e.type==="card"&&(e.view=this.view),e.headingLevel=this.headingLevel)},Le)])}get activeLayerInfos(){return this.viewModel.activeLayerInfos}set activeLayerInfos(e){this.viewModel.activeLayerInfos=e}get basemapLegendVisible(){return this.viewModel.basemapLegendVisible}set basemapLegendVisible(e){this.viewModel.basemapLegendVisible=e}get groundLegendVisible(){return this.viewModel.groundLegendVisible}set groundLegendVisible(e){this.viewModel.groundLegendVisible=e}get hideLayersNotInCurrentView(){return this.viewModel.hideLayersNotInCurrentView}set hideLayersNotInCurrentView(e){this.viewModel.hideLayersNotInCurrentView=e}get keepCacheOnDestroy(){return this.viewModel.keepCacheOnDestroy}set keepCacheOnDestroy(e){this.viewModel.keepCacheOnDestroy=e}get respectLayerVisibility(){return this.viewModel.respectLayerVisibility}set respectLayerVisibility(e){this.viewModel.respectLayerVisibility=e}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get layerInfos(){return this.viewModel.layerInfos}set layerInfos(e){this.viewModel.layerInfos=e}castStyle(e){if(e instanceof fF||e instanceof R_)return e;if(typeof e=="string")return e==="card"?new fF:new R_;if(e&&typeof e.type=="string"){const i={...e};return delete i.type,new(e.type==="card"?fF:R_)(i)}return new R_}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){return M("div",{class:this.classes(AM.base,AM.widget,this.style instanceof R_?AM.panel:null)},this.style.render())}_refreshActiveLayerInfos(e){e.forEach(i=>{this.removeHandles(`version_${i.layer.uid}`),this._renderOnActiveLayerInfoChange(i)}),this.scheduleRender()}_renderOnActiveLayerInfoChange(e){const i=J(()=>e.version,()=>this.scheduleRender());this.addHandles(i,`version_${e.layer.uid}`);const r=ui(()=>e.children,"change",()=>e.children.forEach(n=>this._renderOnActiveLayerInfoChange(n)),Le);this.addHandles(r,`version_${e.layer.uid}`),e.children.forEach(n=>this._renderOnActiveLayerInfoChange(n))}};d([p()],Gn.prototype,"activeLayerInfos",null),d([p()],Gn.prototype,"basemapLegendVisible",null),d([p()],Gn.prototype,"groundLegendVisible",null),d([p()],Gn.prototype,"headingLevel",void 0),d([p()],Gn.prototype,"hideLayersNotInCurrentView",null),d([p()],Gn.prototype,"keepCacheOnDestroy",null),d([p()],Gn.prototype,"respectLayerVisibility",null),d([p()],Gn.prototype,"iconClass",void 0),d([p()],Gn.prototype,"icon",void 0),d([p()],Gn.prototype,"label",null),d([p()],Gn.prototype,"layerInfos",null),d([p(),ut("esri/widgets/Legend/t9n/Legend")],Gn.prototype,"messages",void 0),d([p()],Gn.prototype,"style",void 0),d([tt("style")],Gn.prototype,"castStyle",null),d([p()],Gn.prototype,"view",null),d([p()],Gn.prototype,"viewModel",void 0),Gn=d([A("esri.widgets.Legend")],Gn);const Uye=Gn,YXe=Object.freeze(Object.defineProperty({__proto__:null,default:Uye},Symbol.toStringTag,{value:"Module"}));var g8;let Wf=g8=class extends hC{constructor(t){super(t),this.displayValueEnabled=!1,this.max=1,this.min=0,this.step=.1,this.type="slider",this.value=null}clone(){return new g8({active:this.active,className:this.className,disabled:this.disabled,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,displayValueEnabled:this.displayValueEnabled,max:this.max,min:this.min,step:this.step,value:this.value})}};d([p()],Wf.prototype,"displayValueEnabled",void 0),d([p()],Wf.prototype,"max",void 0),d([p()],Wf.prototype,"min",void 0),d([p()],Wf.prototype,"step",void 0),d([p()],Wf.prototype,"value",void 0),Wf=g8=d([A("esri.support.Action.ActionSlider")],Wf);const KXe=Wf,Gye={hide:"hide",hideChildren:"hide-children"};function dO(t){if(t)return t.listMode!=null?t.listMode:void 0}function XXe(t){if(t)return t.minScale!=null?t.minScale:void 0}function QXe(t){if(t)return t.maxScale!=null?t.maxScale:void 0}function eQe(t){if(!t)return"inherited";const e=t.get("layer.capabilities.exportMap.supportsSublayerVisibility");if(typeof e=="boolean")return e?"independent":"inherited";const i=t.get("capabilities.exportMap.supportsSublayerVisibility");return typeof i=="boolean"?i?"independent":"inherited":t.visibilityMode!=null?t.visibilityMode:"independent"}function s7(t){if(t&&(!("type"in t)||t.type!=="wmts")&&t.listMode!==Gye.hideChildren)return"sublayers"in t?"sublayers":"layers"in t?"layers":void 0}function tQe(t){const e=t&&(t.get("layer.layer")||t.layer);if(!e)return!1;const i=e.get("capabilities.exportMap.supportsDynamicLayers");return typeof i!="boolean"||i}function o7(t){return dO(t)!==Gye.hide}function iQe(t,e){if(!t||isNaN(e))return!1;const i=XXe(t),r=QXe(t),n=i!=null&&!isNaN(i)&&i>0&&e>i,s=r!=null&&!isNaN(r)&&r>0&&e<r;return n||s}function Hye(t,e){t&&t.sort((i,r)=>{const n=e.indexOf(i.uid),s=e.indexOf(r.uid);return n>s?-1:n<s?1:0})}function rQe(t,e){const i=t==null?void 0:t.layer;if(!i)return;const r=s7(i);r&&Hye(i.get(r),e)}function RQ(t){const e=t==null?void 0:t.layer;return e&&"layers"in e?e.layers:null}function gF(t,e){var r;const i=(r=t.layer)==null?void 0:r.uid;return i!=null?e.find(n=>{var s;return((s=n.layer)==null?void 0:s.uid)===i}):null}function nQe(t){const e=sQe(t)?t:null,i=t==null?void 0:t.parent,r=(i==null?void 0:i.type)==="map-image"?e==null?void 0:e.source:null,n="";return r&&i?{layer:i,title:n,sublayerIds:[r.mapLayerId]}:{layer:t,title:n}}function sQe(t){return!!(t!=null&&t.layer)}const qye="esri-layer-list-panel",Jx=`${qye}__content`,ih={base:qye,content:Jx,contentLegend:`${Jx}--legend`,contentString:`${Jx}--string`,contentElement:`${Jx}--html-element`,contentWidget:`${Jx}--widget`},oQe="legends";let Rl=class extends bg(di){constructor(e,i){super(e,i),this._legend=null,this.content=null,this.image=null,this.listItem=null,this.open=!1,this.visible=!0}initialize(){this.addHandles(J(()=>this.content,e=>this._createLegend(e),Le))}destroy(){this._legend=je(this._legend)}get className(){const{image:e}=this,i=this._getFirstWidget();return this._get("className")||(!e&&i?i.iconClass??"":"")}set className(e){this._override("className",e)}get disabled(){var n;const{listItem:e,_legend:i,content:r}=this;return!e||!(Array.isArray(r)&&r.length>1)&&!!i&&(!((n=i.activeLayerInfos)!=null&&n.length)||!e.visibleAtCurrentScale||!e.visible)}set disabled(e){this._overrideIfSome("disabled",e)}get title(){const e=this._getFirstWidget();return this._get("title")||((e==null?void 0:e.label)??"")}set title(e){this._override("title",e)}render(){return M("div",{class:ih.base},this._renderContents())}_renderContent(e){const{_legend:i,disabled:r}=this;return!e||r?null:e==="legend"&&i?M("div",{class:this.classes(ih.content,ih.contentLegend),key:i},i.render()):typeof e=="string"?M("div",{class:this.classes(ih.content,ih.contentString),key:e,innerHTML:e}):bI(e)?M("div",{class:this.classes(ih.content,ih.contentWidget),key:e},e.render()):e instanceof HTMLElement?M("div",{class:this.classes(ih.content,ih.contentElement),key:e,bind:e,afterCreate:this._attachToNode}):null}_renderContents(){const{content:e}=this;return Array.isArray(e)?e.map(i=>this._renderContent(i)):this._renderContent(e)}_getLegendOptions(){const{listItem:e}=this;if(!e)return{};const{layer:i,view:r}=e;return i&&r?{view:r,layerInfos:[nQe(i)]}:{}}async _createLegend(e){if(!this._hasLegend(e)||this._legend)return;const{default:i}=await W(()=>Promise.resolve().then(()=>YXe),void 0,import.meta.url),{listItem:r}=this,n=new i(this._getLegendOptions());this._legend=n,this.notifyChange("className"),this.notifyChange("title");const s=J(()=>{var o,a;return[r==null?void 0:r.view,r==null?void 0:r.layer,(o=r==null?void 0:r.layer)==null?void 0:o.source,(a=r==null?void 0:r.layer)==null?void 0:a.parent]},()=>this._updateLegend(n),Le);this.addHandles(s,oQe),this.scheduleRender()}_hasLegend(e){const i="legend";return e===i||e!=null&&!!Array.isArray(e)&&e.includes(i)}_attachToNode(e){e.appendChild(this)}_updateLegend(e){e.set(this._getLegendOptions()),this.scheduleRender()}_getWidget(e){return e==="legend"?this._legend:bI(e)?e:null}_getFirstWidget(){const{content:e}=this;if(Array.isArray(e)){let i=null;return e.some(r=>{const n=this._getWidget(r);return n&&(i=n),!!n}),i}return this._getWidget(e)}};d([p()],Rl.prototype,"_legend",void 0),d([p()],Rl.prototype,"className",null),d([p()],Rl.prototype,"content",void 0),d([p()],Rl.prototype,"disabled",null),d([p()],Rl.prototype,"image",void 0),d([p()],Rl.prototype,"listItem",void 0),d([p()],Rl.prototype,"title",null),d([p()],Rl.prototype,"open",void 0),d([p()],Rl.prototype,"visible",void 0),Rl=d([A("esri.widgets.LayerList.ListItemPanel")],Rl);const Wye=Rl;var x2;const aQe=ye.ofType({key:"type",defaultKeyValue:"button",base:hC,typeMap:{button:Gae,toggle:Hae,slider:KXe}}),Jye=ye.ofType(aQe),kM="layer",yF="child-list-mode",lQe="hide",cQe="esri.widgets.LayerList.ListItem";let Ni=x2=class extends bg(cn(he)){constructor(t){super(t),this.actionsSections=new Jye,this.actionsOpen=!1,this.checkPublishStatusEnabled=!1,this.children=new(ye.ofType(x2)),this.childrenSortable=!0,this.hidden=!1,this.layer=null,this.layerView=null,this.listItemCreatedFunction=null,this.open=!1,this.panel=null,this.parent=null,this.sortable=!0,this.view=null}initialize(){if(this.handles.add([J(()=>this.layer,t=>this._watchLayerProperties(t),Le),J(()=>this.checkPublishStatusEnabled,t=>this._updateChildrenPublishing(t),Le),J(()=>this.view,t=>this._updateChildrenView(t),Le),J(()=>this.panel,t=>this._setListItemOnPanel(t),Le),J(()=>[this.layer,this.view],()=>this._getLayerView(),Le)]),typeof this.listItemCreatedFunction=="function"){const t={item:this};this.listItemCreatedFunction.call(null,t)}}destroy(){this.view=null}get connectionStatus(){const{layerView:t,publishing:e}=this;if(!e&&t&&"connectionStatus"in t)return t.connectionStatus}get error(){var t;return(t=this.layer)==null?void 0:t.loadError}get incompatible(){const{layerView:t}=this;return!(!t||!("spatialReferenceSupported"in t))&&!t.spatialReferenceSupported}castPanel(t){return this.get("panel.open")&&!t.hasOwnProperty("open")&&(t.open=!0),t?new Wye(t):null}get title(){const t=this.get("layer.layer");return(!t||t&&this.get("layer.layer.loaded"))&&this.get("layer.title")||this.get("layer.attributes.title")||""}set title(t){this._override("title",t)}get publishing(){var i;const{layer:t,checkPublishStatusEnabled:e}=this;return e&&t&&"publishingInfo"in t&&((i=t.publishingInfo)==null?void 0:i.status)==="publishing"}get updating(){const{layerView:t,connectionStatus:e,layer:i,publishing:r}=this;return!r&&!e&&(t?t.updating:(i==null?void 0:i.loadStatus)==="loading"||!1)}get visible(){var t;return(t=this.layer)==null?void 0:t.visible}set visible(t){const e=this.layer;e&&(e.visible=t)}get visibleAtCurrentScale(){return!iQe(this.layer,this.get("view.scale"))}get visibilityMode(){return eQe(this.layer)}clone(){return new x2({actionsSections:this.actionsSections.clone(),actionsOpen:this.actionsOpen,checkPublishStatusEnabled:this.checkPublishStatusEnabled,children:this.children.clone(),layer:this.layer,listItemCreatedFunction:this.listItemCreatedFunction,open:this.open,panel:this.panel,title:this.title,view:this.view,visible:this.visible})}_setListItemOnPanel(t){t&&(t.listItem=this)}_updateChildrenPublishing(t){const e=this.children;e&&e.forEach(i=>i.checkPublishStatusEnabled=t)}_updateChildrenView(t){const e=this.children;e&&e.forEach(i=>i.view=t)}_addChildren(t){if(this.handles.remove(yF),this.children.removeAll(),!t)return;t.forEach(i=>{this.handles.add(J(()=>i.listMode,()=>this._addChildren(t)),yF)});const e=t.filter(i=>dO(i)!==lQe);this.children.addMany(this._makeChildren(e))}_watchSublayerChanges(t){t&&this.handles.add(t.on("change",()=>{this._addChildren(t)}),kM)}_initializeChildLayers(t){this._addChildren(t),this._watchSublayerChanges(t)}_makeChildren(t){return t.map(e=>o7(e)?new x2({layer:e,checkPublishStatusEnabled:this.checkPublishStatusEnabled,listItemCreatedFunction:this.listItemCreatedFunction,parent:this,view:this.view}):null).filter(Dt).reverse()}_watchLayerProperties(t){if(!this.handles||(this.handles.remove(kM),this.handles.remove(yF),!t))return;if(this.handles.add(J(()=>t.listMode,()=>this._watchLayerProperties(t)),kM),dO(t)==="hide-children")return void this.children.removeAll();const e=s7(t);e&&this.handles.add(J(()=>t[e],i=>{t.hasOwnProperty(e)&&this._initializeChildLayers(i)},Le),kM)}async _getLayerView(){const{layer:t,view:e}=this;if(t&&e)try{const i=await e.whenLayerView(t);if(i.layer!==this.layer)return;this._set("layerView",i)}catch{}}};d([p({type:Jye})],Ni.prototype,"actionsSections",void 0),d([p()],Ni.prototype,"actionsOpen",void 0),d([p()],Ni.prototype,"checkPublishStatusEnabled",void 0),d([p({type:ye})],Ni.prototype,"children",void 0),d([p()],Ni.prototype,"childrenSortable",void 0),d([p({readOnly:!0})],Ni.prototype,"connectionStatus",null),d([p({readOnly:!0})],Ni.prototype,"error",null),d([p()],Ni.prototype,"hidden",void 0),d([p({readOnly:!0})],Ni.prototype,"incompatible",null),d([p()],Ni.prototype,"layer",void 0),d([p({readOnly:!0})],Ni.prototype,"layerView",void 0),d([p()],Ni.prototype,"listItemCreatedFunction",void 0),d([p()],Ni.prototype,"open",void 0),d([p({type:Wye})],Ni.prototype,"panel",void 0),d([tt("panel")],Ni.prototype,"castPanel",null),d([p()],Ni.prototype,"parent",void 0),d([p()],Ni.prototype,"sortable",void 0),d([p()],Ni.prototype,"title",null),d([p({readOnly:!0})],Ni.prototype,"publishing",null),d([p({readOnly:!0})],Ni.prototype,"updating",null),d([p()],Ni.prototype,"view",void 0),d([p()],Ni.prototype,"visible",null),d([p({readOnly:!0})],Ni.prototype,"visibleAtCurrentScale",null),d([p({readOnly:!0})],Ni.prototype,"visibilityMode",null),Ni=x2=d([A(cQe)],Ni);const vR=Ni,Cc={view:"view",viewLayers:"view-layers",mapLayers:"map-layers",layerViews:"layer-views",layerListMode:"layer-list-mode"},uQe="hide",Zye=ye.ofType(vR);let Jf=class extends an.EventedAccessor{constructor(e){super(e),this.checkPublishStatusEnabled=!1,this.listItemCreatedFunction=null,this.operationalItems=new Zye,this.view=null}initialize(){this.addHandles([J(()=>{var e;return[this.view,(e=this.view)==null?void 0:e.ready]},()=>this._viewHandles(),Le),J(()=>[this.listItemCreatedFunction,this.checkPublishStatusEnabled],()=>this._recompileList())],Cc.view)}destroy(){this.removeAllHandles(),this.view=null,this.operationalItems.removeAll()}get state(){const e=this.get("view");return this.get("view.ready")?"ready":e?"loading":"disabled"}triggerAction(e,i){e&&!e.disabled&&this.emit("trigger-action",{action:e,item:i})}moveListItem(e,i,r,n){var m,g;const s=e==null?void 0:e.layer;if(!s)return;const o=(g=(m=this.view)==null?void 0:m.map)==null?void 0:g.layers,a=i?RQ(i):o,l=r?RQ(r):o;if(!a||!l)return;const{operationalItems:c}=this,u=(i==null?void 0:i.children)||c,h=(r==null?void 0:r.children)||c,f=l.length-n;e.parent=r||null,u.includes(e)&&u.remove(e),a.includes(s)&&a.remove(s),h.includes(e)||h.add(e,f),l.includes(s)||l.add(s,f)}_createLayerViewHandles(e){this.removeHandles(Cc.layerViews),this._compileList(),e&&this.addHandles(e.on("change",()=>this._compileList()),Cc.layerViews)}_createMapLayerHandles(e){this.removeHandles(Cc.mapLayers),this._compileList(),e&&this.addHandles(e.on("change",()=>this._compileList()),Cc.mapLayers)}_createListItem(e){const{view:i,listItemCreatedFunction:r,checkPublishStatusEnabled:n}=this;return new vR({checkPublishStatusEnabled:n,layer:e,listItemCreatedFunction:r,view:i})}_removeAllItems(){this.operationalItems.removeAll()}_getViewableLayers(e){if(e)return e.filter(i=>dO(i)!==uQe)}_watchLayersListMode(e){this.removeHandles(Cc.layerListMode),e&&e.forEach(i=>{"listMode"in i&&this.addHandles(J(()=>i.listMode,()=>this._compileList()),Cc.layerListMode)})}_compileList(){const e=this.get("view.map.layers");this._watchLayersListMode(e);const i=this._getViewableLayers(e);i&&i.length?(this._createNewItems(i),this._removeItems(i),this._sortItems(i)):this._removeAllItems()}_createNewItems(e){const{operationalItems:i}=this;e.forEach(r=>{i.find(n=>n.layer===r)||i.add(this._createListItem(r))})}_removeItems(e){const{operationalItems:i}=this,r=[];i.forEach(n=>{n&&e&&e.includes(n.layer)||r.push(n)}),i.removeMany(r)}_sortItems(e){const{operationalItems:i}=this;i.sort((r,n)=>{const s=e.indexOf(r.layer),o=e.indexOf(n.layer);return s>o?-1:s<o?1:0})}_recompileList(){this._removeAllItems(),this._compileList()}_viewHandles(){const{view:e}=this;this.removeHandles([Cc.mapLayers,Cc.layerViews,Cc.viewLayers]),this._recompileList(),e&&e.ready&&this.addHandles([J(()=>{var i,r;return(r=(i=this.view)==null?void 0:i.map)==null?void 0:r.allLayers},i=>this._createMapLayerHandles(i),Le),J(()=>{var i;return(i=this.view)==null?void 0:i.allLayerViews},i=>this._createLayerViewHandles(i),Le)],Cc.viewLayers)}};d([p()],Jf.prototype,"checkPublishStatusEnabled",void 0),d([p()],Jf.prototype,"listItemCreatedFunction",void 0),d([p({type:Zye})],Jf.prototype,"operationalItems",void 0),d([p({readOnly:!0})],Jf.prototype,"state",null),d([p()],Jf.prototype,"view",void 0),Jf=d([A("esri.widgets.LayerList.LayerListViewModel")],Jf);const a7=Jf;/**!
 * Sortable 1.15.0
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function FQ(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),i.push.apply(i,r)}return i}function Hd(t){for(var e=1;e<arguments.length;e++){var i=arguments[e]!=null?arguments[e]:{};e%2?FQ(Object(i),!0).forEach(function(r){dQe(t,r,i[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):FQ(Object(i)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(i,r))})}return t}function jA(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?jA=function(e){return typeof e}:jA=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},jA(t)}function dQe(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Sp(){return Sp=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t},Sp.apply(this,arguments)}function hQe(t,e){if(t==null)return{};var i={},r=Object.keys(t),n,s;for(s=0;s<r.length;s++)n=r[s],!(e.indexOf(n)>=0)&&(i[n]=t[n]);return i}function pQe(t,e){if(t==null)return{};var i=hQe(t,e),r,n;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}var fQe="1.15.0";function pp(t){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(t)}var Op=pp(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),GC=pp(/Edge/i),DQ=pp(/firefox/i),xI=pp(/safari/i)&&!pp(/chrome/i)&&!pp(/android/i),Yye=pp(/iP(ad|od|hone)/i),Kye=pp(/chrome/i)&&pp(/android/i),Xye={capture:!1,passive:!1};function yi(t,e,i){t.addEventListener(e,i,!Op&&Xye)}function Kt(t,e,i){t.removeEventListener(e,i,!Op&&Xye)}function hO(t,e){if(e){if(e[0]===">"&&(e=e.substring(1)),t)try{if(t.matches)return t.matches(e);if(t.msMatchesSelector)return t.msMatchesSelector(e);if(t.webkitMatchesSelector)return t.webkitMatchesSelector(e)}catch{return!1}return!1}}function mQe(t){return t.host&&t!==document&&t.host.nodeType?t.host:t.parentNode}function yd(t,e,i,r){if(t){i=i||document;do{if(e!=null&&(e[0]===">"?t.parentNode===i&&hO(t,e):hO(t,e))||r&&t===i)return t;if(t===i)break}while(t=mQe(t))}return null}var NQ=/\s+/g;function Va(t,e,i){if(t&&e)if(t.classList)t.classList[i?"add":"remove"](e);else{var r=(" "+t.className+" ").replace(NQ," ").replace(" "+e+" "," ");t.className=(r+(i?" "+e:"")).replace(NQ," ")}}function Qe(t,e,i){var r=t&&t.style;if(r){if(i===void 0)return document.defaultView&&document.defaultView.getComputedStyle?i=document.defaultView.getComputedStyle(t,""):t.currentStyle&&(i=t.currentStyle),e===void 0?i:i[e];!(e in r)&&e.indexOf("webkit")===-1&&(e="-webkit-"+e),r[e]=i+(typeof i=="string"?"":"px")}}function Vw(t,e){var i="";if(typeof t=="string")i=t;else do{var r=Qe(t,"transform");r&&r!=="none"&&(i=r+" "+i)}while(!e&&(t=t.parentNode));var n=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return n&&new n(i)}function Qye(t,e,i){if(t){var r=t.getElementsByTagName(e),n=0,s=r.length;if(i)for(;n<s;n++)i(r[n],n);return r}return[]}function Rd(){var t=document.scrollingElement;return t||document.documentElement}function Wn(t,e,i,r,n){if(!(!t.getBoundingClientRect&&t!==window)){var s,o,a,l,c,u,h;if(t!==window&&t.parentNode&&t!==Rd()?(s=t.getBoundingClientRect(),o=s.top,a=s.left,l=s.bottom,c=s.right,u=s.height,h=s.width):(o=0,a=0,l=window.innerHeight,c=window.innerWidth,u=window.innerHeight,h=window.innerWidth),(e||i)&&t!==window&&(n=n||t.parentNode,!Op))do if(n&&n.getBoundingClientRect&&(Qe(n,"transform")!=="none"||i&&Qe(n,"position")!=="static")){var f=n.getBoundingClientRect();o-=f.top+parseInt(Qe(n,"border-top-width")),a-=f.left+parseInt(Qe(n,"border-left-width")),l=o+s.height,c=a+s.width;break}while(n=n.parentNode);if(r&&t!==window){var m=Vw(n||t),g=m&&m.a,y=m&&m.d;m&&(o/=y,a/=g,h/=g,u/=y,l=o+u,c=a+h)}return{top:o,left:a,bottom:l,right:c,width:h,height:u}}}function VQ(t,e,i){for(var r=jm(t,!0),n=Wn(t)[e];r;){var s=Wn(r)[i],o=void 0;if(i==="top"||i==="left"?o=n>=s:o=n<=s,!o)return r;if(r===Rd())break;r=jm(r,!1)}return!1}function T1(t,e,i,r){for(var n=0,s=0,o=t.children;s<o.length;){if(o[s].style.display!=="none"&&o[s]!==et.ghost&&(r||o[s]!==et.dragged)&&yd(o[s],i.draggable,t,!1)){if(n===e)return o[s];n++}s++}return null}function l7(t,e){for(var i=t.lastElementChild;i&&(i===et.ghost||Qe(i,"display")==="none"||e&&!hO(i,e));)i=i.previousElementSibling;return i||null}function Bl(t,e){var i=0;if(!t||!t.parentNode)return-1;for(;t=t.previousElementSibling;)t.nodeName.toUpperCase()!=="TEMPLATE"&&t!==et.clone&&(!e||hO(t,e))&&i++;return i}function zQ(t){var e=0,i=0,r=Rd();if(t)do{var n=Vw(t),s=n.a,o=n.d;e+=t.scrollLeft*s,i+=t.scrollTop*o}while(t!==r&&(t=t.parentNode));return[e,i]}function gQe(t,e){for(var i in t)if(t.hasOwnProperty(i)){for(var r in e)if(e.hasOwnProperty(r)&&e[r]===t[i][r])return Number(i)}return-1}function jm(t,e){if(!t||!t.getBoundingClientRect)return Rd();var i=t,r=!1;do if(i.clientWidth<i.scrollWidth||i.clientHeight<i.scrollHeight){var n=Qe(i);if(i.clientWidth<i.scrollWidth&&(n.overflowX=="auto"||n.overflowX=="scroll")||i.clientHeight<i.scrollHeight&&(n.overflowY=="auto"||n.overflowY=="scroll")){if(!i.getBoundingClientRect||i===document.body)return Rd();if(r||e)return i;r=!0}}while(i=i.parentNode);return Rd()}function yQe(t,e){if(t&&e)for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t}function vF(t,e){return Math.round(t.top)===Math.round(e.top)&&Math.round(t.left)===Math.round(e.left)&&Math.round(t.height)===Math.round(e.height)&&Math.round(t.width)===Math.round(e.width)}var SI;function e0e(t,e){return function(){if(!SI){var i=arguments,r=this;i.length===1?t.call(r,i[0]):t.apply(r,i),SI=setTimeout(function(){SI=void 0},e)}}}function vQe(){clearTimeout(SI),SI=void 0}function t0e(t,e,i){t.scrollLeft+=e,t.scrollTop+=i}function i0e(t){var e=window.Polymer,i=window.jQuery||window.Zepto;return e&&e.dom?e.dom(t).cloneNode(!0):i?i(t).clone(!0)[0]:t.cloneNode(!0)}var Qa="Sortable"+new Date().getTime();function _Qe(){var t=[],e;return{captureAnimationState:function(){if(t=[],!!this.options.animation){var r=[].slice.call(this.el.children);r.forEach(function(n){if(!(Qe(n,"display")==="none"||n===et.ghost)){t.push({target:n,rect:Wn(n)});var s=Hd({},t[t.length-1].rect);if(n.thisAnimationDuration){var o=Vw(n,!0);o&&(s.top-=o.f,s.left-=o.e)}n.fromRect=s}})}},addAnimationState:function(r){t.push(r)},removeAnimationState:function(r){t.splice(gQe(t,{target:r}),1)},animateAll:function(r){var n=this;if(!this.options.animation){clearTimeout(e),typeof r=="function"&&r();return}var s=!1,o=0;t.forEach(function(a){var l=0,c=a.target,u=c.fromRect,h=Wn(c),f=c.prevFromRect,m=c.prevToRect,g=a.rect,y=Vw(c,!0);y&&(h.top-=y.f,h.left-=y.e),c.toRect=h,c.thisAnimationDuration&&vF(f,h)&&!vF(u,h)&&(g.top-h.top)/(g.left-h.left)===(u.top-h.top)/(u.left-h.left)&&(l=wQe(g,f,m,n.options)),vF(h,u)||(c.prevFromRect=u,c.prevToRect=h,l||(l=n.options.animation),n.animate(c,g,h,l)),l&&(s=!0,o=Math.max(o,l),clearTimeout(c.animationResetTimer),c.animationResetTimer=setTimeout(function(){c.animationTime=0,c.prevFromRect=null,c.fromRect=null,c.prevToRect=null,c.thisAnimationDuration=null},l),c.thisAnimationDuration=l)}),clearTimeout(e),s?e=setTimeout(function(){typeof r=="function"&&r()},o):typeof r=="function"&&r(),t=[]},animate:function(r,n,s,o){if(o){Qe(r,"transition",""),Qe(r,"transform","");var a=Vw(this.el),l=a&&a.a,c=a&&a.d,u=(n.left-s.left)/(l||1),h=(n.top-s.top)/(c||1);r.animatingX=!!u,r.animatingY=!!h,Qe(r,"transform","translate3d("+u+"px,"+h+"px,0)"),this.forRepaintDummy=bQe(r),Qe(r,"transition","transform "+o+"ms"+(this.options.easing?" "+this.options.easing:"")),Qe(r,"transform","translate3d(0,0,0)"),typeof r.animated=="number"&&clearTimeout(r.animated),r.animated=setTimeout(function(){Qe(r,"transition",""),Qe(r,"transform",""),r.animated=!1,r.animatingX=!1,r.animatingY=!1},o)}}}}function bQe(t){return t.offsetWidth}function wQe(t,e,i,r){return Math.sqrt(Math.pow(e.top-t.top,2)+Math.pow(e.left-t.left,2))/Math.sqrt(Math.pow(e.top-i.top,2)+Math.pow(e.left-i.left,2))*r.animation}var F_=[],_F={initializeByDefault:!0},HC={mount:function(e){for(var i in _F)_F.hasOwnProperty(i)&&!(i in e)&&(e[i]=_F[i]);F_.forEach(function(r){if(r.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")}),F_.push(e)},pluginEvent:function(e,i,r){var n=this;this.eventCanceled=!1,r.cancel=function(){n.eventCanceled=!0};var s=e+"Global";F_.forEach(function(o){i[o.pluginName]&&(i[o.pluginName][s]&&i[o.pluginName][s](Hd({sortable:i},r)),i.options[o.pluginName]&&i[o.pluginName][e]&&i[o.pluginName][e](Hd({sortable:i},r)))})},initializePlugins:function(e,i,r,n){F_.forEach(function(a){var l=a.pluginName;if(!(!e.options[l]&&!a.initializeByDefault)){var c=new a(e,i,e.options);c.sortable=e,c.options=e.options,e[l]=c,Sp(r,c.defaults)}});for(var s in e.options)if(e.options.hasOwnProperty(s)){var o=this.modifyOption(e,s,e.options[s]);typeof o<"u"&&(e.options[s]=o)}},getEventProperties:function(e,i){var r={};return F_.forEach(function(n){typeof n.eventProperties=="function"&&Sp(r,n.eventProperties.call(i[n.pluginName],e))}),r},modifyOption:function(e,i,r){var n;return F_.forEach(function(s){e[s.pluginName]&&s.optionListeners&&typeof s.optionListeners[i]=="function"&&(n=s.optionListeners[i].call(e[s.pluginName],r))}),n}};function xQe(t){var e=t.sortable,i=t.rootEl,r=t.name,n=t.targetEl,s=t.cloneEl,o=t.toEl,a=t.fromEl,l=t.oldIndex,c=t.newIndex,u=t.oldDraggableIndex,h=t.newDraggableIndex,f=t.originalEvent,m=t.putSortable,g=t.extraEventProperties;if(e=e||i&&i[Qa],!!e){var y,v=e.options,b="on"+r.charAt(0).toUpperCase()+r.substr(1);window.CustomEvent&&!Op&&!GC?y=new CustomEvent(r,{bubbles:!0,cancelable:!0}):(y=document.createEvent("Event"),y.initEvent(r,!0,!0)),y.to=o||i,y.from=a||i,y.item=n||i,y.clone=s,y.oldIndex=l,y.newIndex=c,y.oldDraggableIndex=u,y.newDraggableIndex=h,y.originalEvent=f,y.pullMode=m?m.lastPutMode:void 0;var w=Hd(Hd({},g),HC.getEventProperties(r,e));for(var x in w)y[x]=w[x];i&&i.dispatchEvent(y),v[b]&&v[b].call(e,y)}}var SQe=["evt"],Yo=function(e,i){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=r.evt,s=pQe(r,SQe);HC.pluginEvent.bind(et)(e,i,Hd({dragEl:be,parentEl:zr,ghostEl:ft,rootEl:mr,nextEl:a0,lastDownEl:BA,cloneEl:Ar,cloneHidden:Im,dragStarted:S2,putSortable:$s,activeSortable:et.active,originalEvent:n,oldIndex:yw,oldDraggableIndex:II,newIndex:Ga,newDraggableIndex:mm,hideGhostForTarget:o0e,unhideGhostForTarget:a0e,cloneNowHidden:function(){Im=!0},cloneNowShown:function(){Im=!1},dispatchSortableEvent:function(a){Co({sortable:i,name:a,originalEvent:n})}},s))};function Co(t){xQe(Hd({putSortable:$s,cloneEl:Ar,targetEl:be,rootEl:mr,oldIndex:yw,oldDraggableIndex:II,newIndex:Ga,newDraggableIndex:mm},t))}var be,zr,ft,mr,a0,BA,Ar,Im,yw,Ga,II,mm,PM,$s,Bb=!1,pO=!1,fO=[],Jg,Ec,bF,wF,jQ,BQ,S2,D_,TI,CI=!1,OM=!1,UA,js,xF=[],y8=!1,mO=[],_R=typeof document<"u",LM=Yye,UQ=GC||Op?"cssFloat":"float",IQe=_R&&!Kye&&!Yye&&"draggable"in document.createElement("div"),r0e=function(){if(_R){if(Op)return!1;var t=document.createElement("x");return t.style.cssText="pointer-events:auto",t.style.pointerEvents==="auto"}}(),n0e=function(e,i){var r=Qe(e),n=parseInt(r.width)-parseInt(r.paddingLeft)-parseInt(r.paddingRight)-parseInt(r.borderLeftWidth)-parseInt(r.borderRightWidth),s=T1(e,0,i),o=T1(e,1,i),a=s&&Qe(s),l=o&&Qe(o),c=a&&parseInt(a.marginLeft)+parseInt(a.marginRight)+Wn(s).width,u=l&&parseInt(l.marginLeft)+parseInt(l.marginRight)+Wn(o).width;if(r.display==="flex")return r.flexDirection==="column"||r.flexDirection==="column-reverse"?"vertical":"horizontal";if(r.display==="grid")return r.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(s&&a.float&&a.float!=="none"){var h=a.float==="left"?"left":"right";return o&&(l.clear==="both"||l.clear===h)?"vertical":"horizontal"}return s&&(a.display==="block"||a.display==="flex"||a.display==="table"||a.display==="grid"||c>=n&&r[UQ]==="none"||o&&r[UQ]==="none"&&c+u>n)?"vertical":"horizontal"},TQe=function(e,i,r){var n=r?e.left:e.top,s=r?e.right:e.bottom,o=r?e.width:e.height,a=r?i.left:i.top,l=r?i.right:i.bottom,c=r?i.width:i.height;return n===a||s===l||n+o/2===a+c/2},CQe=function(e,i){var r;return fO.some(function(n){var s=n[Qa].options.emptyInsertThreshold;if(!(!s||l7(n))){var o=Wn(n),a=e>=o.left-s&&e<=o.right+s,l=i>=o.top-s&&i<=o.bottom+s;if(a&&l)return r=n}}),r},s0e=function(e){function i(s,o){return function(a,l,c,u){var h=a.options.group.name&&l.options.group.name&&a.options.group.name===l.options.group.name;if(s==null&&(o||h))return!0;if(s==null||s===!1)return!1;if(o&&s==="clone")return s;if(typeof s=="function")return i(s(a,l,c,u),o)(a,l,c,u);var f=(o?a:l).options.group.name;return s===!0||typeof s=="string"&&s===f||s.join&&s.indexOf(f)>-1}}var r={},n=e.group;(!n||jA(n)!="object")&&(n={name:n}),r.name=n.name,r.checkPull=i(n.pull,!0),r.checkPut=i(n.put),r.revertClone=n.revertClone,e.group=r},o0e=function(){!r0e&&ft&&Qe(ft,"display","none")},a0e=function(){!r0e&&ft&&Qe(ft,"display","")};_R&&!Kye&&document.addEventListener("click",function(t){if(pO)return t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.stopImmediatePropagation&&t.stopImmediatePropagation(),pO=!1,!1},!0);var Zg=function(e){if(be){e=e.touches?e.touches[0]:e;var i=CQe(e.clientX,e.clientY);if(i){var r={};for(var n in e)e.hasOwnProperty(n)&&(r[n]=e[n]);r.target=r.rootEl=i,r.preventDefault=void 0,r.stopPropagation=void 0,i[Qa]._onDragOver(r)}}},EQe=function(e){be&&be.parentNode[Qa]._isOutsideThisEl(e.target)};function et(t,e){if(!(t&&t.nodeType&&t.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(t));this.el=t,this.options=e=Sp({},e),t[Qa]=this;var i={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(t.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return n0e(t,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(o,a){o.setData("Text",a.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:et.supportPointer!==!1&&"PointerEvent"in window&&!xI,emptyInsertThreshold:5};HC.initializePlugins(this,t,i);for(var r in i)!(r in e)&&(e[r]=i[r]);s0e(e);for(var n in this)n.charAt(0)==="_"&&typeof this[n]=="function"&&(this[n]=this[n].bind(this));this.nativeDraggable=e.forceFallback?!1:IQe,this.nativeDraggable&&(this.options.touchStartThreshold=1),e.supportPointer?yi(t,"pointerdown",this._onTapStart):(yi(t,"mousedown",this._onTapStart),yi(t,"touchstart",this._onTapStart)),this.nativeDraggable&&(yi(t,"dragover",this),yi(t,"dragenter",this)),fO.push(this.el),e.store&&e.store.get&&this.sort(e.store.get(this)||[]),Sp(this,_Qe())}et.prototype={constructor:et,_isOutsideThisEl:function(e){!this.el.contains(e)&&e!==this.el&&(D_=null)},_getDirection:function(e,i){return typeof this.options.direction=="function"?this.options.direction.call(this,e,i,be):this.options.direction},_onTapStart:function(e){if(e.cancelable){var i=this,r=this.el,n=this.options,s=n.preventOnFilter,o=e.type,a=e.touches&&e.touches[0]||e.pointerType&&e.pointerType==="touch"&&e,l=(a||e).target,c=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||l,u=n.filter;if(RQe(r),!be&&!(/mousedown|pointerdown/.test(o)&&e.button!==0||n.disabled)&&!c.isContentEditable&&!(!this.nativeDraggable&&xI&&l&&l.tagName.toUpperCase()==="SELECT")&&(l=yd(l,n.draggable,r,!1),!(l&&l.animated)&&BA!==l)){if(yw=Bl(l),II=Bl(l,n.draggable),typeof u=="function"){if(u.call(this,e,l,this)){Co({sortable:i,rootEl:c,name:"filter",targetEl:l,toEl:r,fromEl:r}),Yo("filter",i,{evt:e}),s&&e.cancelable&&e.preventDefault();return}}else if(u&&(u=u.split(",").some(function(h){if(h=yd(c,h.trim(),r,!1),h)return Co({sortable:i,rootEl:h,name:"filter",targetEl:l,fromEl:r,toEl:r}),Yo("filter",i,{evt:e}),!0}),u)){s&&e.cancelable&&e.preventDefault();return}n.handle&&!yd(c,n.handle,r,!1)||this._prepareDragStart(e,a,l)}}},_prepareDragStart:function(e,i,r){var n=this,s=n.el,o=n.options,a=s.ownerDocument,l;if(r&&!be&&r.parentNode===s){var c=Wn(r);if(mr=s,be=r,zr=be.parentNode,a0=be.nextSibling,BA=r,PM=o.group,et.dragged=be,Jg={target:be,clientX:(i||e).clientX,clientY:(i||e).clientY},jQ=Jg.clientX-c.left,BQ=Jg.clientY-c.top,this._lastX=(i||e).clientX,this._lastY=(i||e).clientY,be.style["will-change"]="all",l=function(){if(Yo("delayEnded",n,{evt:e}),et.eventCanceled){n._onDrop();return}n._disableDelayedDragEvents(),!DQ&&n.nativeDraggable&&(be.draggable=!0),n._triggerDragStart(e,i),Co({sortable:n,name:"choose",originalEvent:e}),Va(be,o.chosenClass,!0)},o.ignore.split(",").forEach(function(u){Qye(be,u.trim(),SF)}),yi(a,"dragover",Zg),yi(a,"mousemove",Zg),yi(a,"touchmove",Zg),yi(a,"mouseup",n._onDrop),yi(a,"touchend",n._onDrop),yi(a,"touchcancel",n._onDrop),DQ&&this.nativeDraggable&&(this.options.touchStartThreshold=4,be.draggable=!0),Yo("delayStart",this,{evt:e}),o.delay&&(!o.delayOnTouchOnly||i)&&(!this.nativeDraggable||!(GC||Op))){if(et.eventCanceled){this._onDrop();return}yi(a,"mouseup",n._disableDelayedDrag),yi(a,"touchend",n._disableDelayedDrag),yi(a,"touchcancel",n._disableDelayedDrag),yi(a,"mousemove",n._delayedDragTouchMoveHandler),yi(a,"touchmove",n._delayedDragTouchMoveHandler),o.supportPointer&&yi(a,"pointermove",n._delayedDragTouchMoveHandler),n._dragStartTimer=setTimeout(l,o.delay)}else l()}},_delayedDragTouchMoveHandler:function(e){var i=e.touches?e.touches[0]:e;Math.max(Math.abs(i.clientX-this._lastX),Math.abs(i.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){be&&SF(be),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;Kt(e,"mouseup",this._disableDelayedDrag),Kt(e,"touchend",this._disableDelayedDrag),Kt(e,"touchcancel",this._disableDelayedDrag),Kt(e,"mousemove",this._delayedDragTouchMoveHandler),Kt(e,"touchmove",this._delayedDragTouchMoveHandler),Kt(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,i){i=i||e.pointerType=="touch"&&e,!this.nativeDraggable||i?this.options.supportPointer?yi(document,"pointermove",this._onTouchMove):i?yi(document,"touchmove",this._onTouchMove):yi(document,"mousemove",this._onTouchMove):(yi(be,"dragend",this),yi(mr,"dragstart",this._onDragStart));try{document.selection?GA(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(e,i){if(Bb=!1,mr&&be){Yo("dragStarted",this,{evt:i}),this.nativeDraggable&&yi(document,"dragover",EQe);var r=this.options;!e&&Va(be,r.dragClass,!1),Va(be,r.ghostClass,!0),et.active=this,e&&this._appendGhost(),Co({sortable:this,name:"start",originalEvent:i})}else this._nulling()},_emulateDragOver:function(){if(Ec){this._lastX=Ec.clientX,this._lastY=Ec.clientY,o0e();for(var e=document.elementFromPoint(Ec.clientX,Ec.clientY),i=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(Ec.clientX,Ec.clientY),e!==i);)i=e;if(be.parentNode[Qa]._isOutsideThisEl(e),i)do{if(i[Qa]){var r=void 0;if(r=i[Qa]._onDragOver({clientX:Ec.clientX,clientY:Ec.clientY,target:e,rootEl:i}),r&&!this.options.dragoverBubble)break}e=i}while(i=i.parentNode);a0e()}},_onTouchMove:function(e){if(Jg){var i=this.options,r=i.fallbackTolerance,n=i.fallbackOffset,s=e.touches?e.touches[0]:e,o=ft&&Vw(ft,!0),a=ft&&o&&o.a,l=ft&&o&&o.d,c=LM&&js&&zQ(js),u=(s.clientX-Jg.clientX+n.x)/(a||1)+(c?c[0]-xF[0]:0)/(a||1),h=(s.clientY-Jg.clientY+n.y)/(l||1)+(c?c[1]-xF[1]:0)/(l||1);if(!et.active&&!Bb){if(r&&Math.max(Math.abs(s.clientX-this._lastX),Math.abs(s.clientY-this._lastY))<r)return;this._onDragStart(e,!0)}if(ft){o?(o.e+=u-(bF||0),o.f+=h-(wF||0)):o={a:1,b:0,c:0,d:1,e:u,f:h};var f="matrix(".concat(o.a,",").concat(o.b,",").concat(o.c,",").concat(o.d,",").concat(o.e,",").concat(o.f,")");Qe(ft,"webkitTransform",f),Qe(ft,"mozTransform",f),Qe(ft,"msTransform",f),Qe(ft,"transform",f),bF=u,wF=h,Ec=s}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!ft){var e=this.options.fallbackOnBody?document.body:mr,i=Wn(be,!0,LM,!0,e),r=this.options;if(LM){for(js=e;Qe(js,"position")==="static"&&Qe(js,"transform")==="none"&&js!==document;)js=js.parentNode;js!==document.body&&js!==document.documentElement?(js===document&&(js=Rd()),i.top+=js.scrollTop,i.left+=js.scrollLeft):js=Rd(),xF=zQ(js)}ft=be.cloneNode(!0),Va(ft,r.ghostClass,!1),Va(ft,r.fallbackClass,!0),Va(ft,r.dragClass,!0),Qe(ft,"transition",""),Qe(ft,"transform",""),Qe(ft,"box-sizing","border-box"),Qe(ft,"margin",0),Qe(ft,"top",i.top),Qe(ft,"left",i.left),Qe(ft,"width",i.width),Qe(ft,"height",i.height),Qe(ft,"opacity","0.8"),Qe(ft,"position",LM?"absolute":"fixed"),Qe(ft,"zIndex","100000"),Qe(ft,"pointerEvents","none"),et.ghost=ft,e.appendChild(ft),Qe(ft,"transform-origin",jQ/parseInt(ft.style.width)*100+"% "+BQ/parseInt(ft.style.height)*100+"%")}},_onDragStart:function(e,i){var r=this,n=e.dataTransfer,s=r.options;if(Yo("dragStart",this,{evt:e}),et.eventCanceled){this._onDrop();return}Yo("setupClone",this),et.eventCanceled||(Ar=i0e(be),Ar.removeAttribute("id"),Ar.draggable=!1,Ar.style["will-change"]="",this._hideClone(),Va(Ar,this.options.chosenClass,!1),et.clone=Ar),r.cloneId=GA(function(){Yo("clone",r),!et.eventCanceled&&(r.options.removeCloneOnHide||mr.insertBefore(Ar,be),r._hideClone(),Co({sortable:r,name:"clone"}))}),!i&&Va(be,s.dragClass,!0),i?(pO=!0,r._loopId=setInterval(r._emulateDragOver,50)):(Kt(document,"mouseup",r._onDrop),Kt(document,"touchend",r._onDrop),Kt(document,"touchcancel",r._onDrop),n&&(n.effectAllowed="move",s.setData&&s.setData.call(r,n,be)),yi(document,"drop",r),Qe(be,"transform","translateZ(0)")),Bb=!0,r._dragStartId=GA(r._dragStarted.bind(r,i,e)),yi(document,"selectstart",r),S2=!0,xI&&Qe(document.body,"user-select","none")},_onDragOver:function(e){var i=this.el,r=e.target,n,s,o,a=this.options,l=a.group,c=et.active,u=PM===l,h=a.sort,f=$s||c,m,g=this,y=!1;if(y8)return;function v(Z,K){Yo(Z,g,Hd({evt:e,isOwner:u,axis:m?"vertical":"horizontal",revert:o,dragRect:n,targetRect:s,canSort:h,fromSortable:f,target:r,completed:w,onMove:function(oe,se){return RM(mr,i,be,n,oe,Wn(oe),e,se)},changed:x},K))}function b(){v("dragOverAnimationCapture"),g.captureAnimationState(),g!==f&&f.captureAnimationState()}function w(Z){return v("dragOverCompleted",{insertion:Z}),Z&&(u?c._hideClone():c._showClone(g),g!==f&&(Va(be,$s?$s.options.ghostClass:c.options.ghostClass,!1),Va(be,a.ghostClass,!0)),$s!==g&&g!==et.active?$s=g:g===et.active&&$s&&($s=null),f===g&&(g._ignoreWhileAnimating=r),g.animateAll(function(){v("dragOverAnimationComplete"),g._ignoreWhileAnimating=null}),g!==f&&(f.animateAll(),f._ignoreWhileAnimating=null)),(r===be&&!be.animated||r===i&&!r.animated)&&(D_=null),!a.dragoverBubble&&!e.rootEl&&r!==document&&(be.parentNode[Qa]._isOutsideThisEl(e.target),!Z&&Zg(e)),!a.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),y=!0}function x(){Ga=Bl(be),mm=Bl(be,a.draggable),Co({sortable:g,name:"change",toEl:i,newIndex:Ga,newDraggableIndex:mm,originalEvent:e})}if(e.preventDefault!==void 0&&e.cancelable&&e.preventDefault(),r=yd(r,a.draggable,i,!0),v("dragOver"),et.eventCanceled)return y;if(be.contains(e.target)||r.animated&&r.animatingX&&r.animatingY||g._ignoreWhileAnimating===r)return w(!1);if(pO=!1,c&&!a.disabled&&(u?h||(o=zr!==mr):$s===this||(this.lastPutMode=PM.checkPull(this,c,be,e))&&l.checkPut(this,c,be,e))){if(m=this._getDirection(e,r)==="vertical",n=Wn(be),v("dragOverValid"),et.eventCanceled)return y;if(o)return zr=mr,b(),this._hideClone(),v("revert"),et.eventCanceled||(a0?mr.insertBefore(be,a0):mr.appendChild(be)),w(!0);var S=l7(i,a.draggable);if(!S||kQe(e,m,this)&&!S.animated){if(S===be)return w(!1);if(S&&i===e.target&&(r=S),r&&(s=Wn(r)),RM(mr,i,be,n,r,s,e,!!r)!==!1)return b(),S&&S.nextSibling?i.insertBefore(be,S.nextSibling):i.appendChild(be),zr=i,x(),w(!0)}else if(S&&AQe(e,m,this)){var I=T1(i,0,a,!0);if(I===be)return w(!1);if(r=I,s=Wn(r),RM(mr,i,be,n,r,s,e,!1)!==!1)return b(),i.insertBefore(be,I),zr=i,x(),w(!0)}else if(r.parentNode===i){s=Wn(r);var T=0,C,E=be.parentNode!==i,$=!TQe(be.animated&&be.toRect||n,r.animated&&r.toRect||s,m),P=m?"top":"left",k=VQ(r,"top","top")||VQ(be,"top","top"),L=k?k.scrollTop:void 0;D_!==r&&(C=s[P],CI=!1,OM=!$&&a.invertSwap||E),T=PQe(e,r,s,m,$?1:a.swapThreshold,a.invertedSwapThreshold==null?a.swapThreshold:a.invertedSwapThreshold,OM,D_===r);var F;if(T!==0){var V=Bl(be);do V-=T,F=zr.children[V];while(F&&(Qe(F,"display")==="none"||F===ft))}if(T===0||F===r)return w(!1);D_=r,TI=T;var z=r.nextElementSibling,G=!1;G=T===1;var H=RM(mr,i,be,n,r,s,e,G);if(H!==!1)return(H===1||H===-1)&&(G=H===1),y8=!0,setTimeout($Qe,30),b(),G&&!z?i.appendChild(be):r.parentNode.insertBefore(be,G?z:r),k&&t0e(k,0,L-k.scrollTop),zr=be.parentNode,C!==void 0&&!OM&&(UA=Math.abs(C-Wn(r)[P])),x(),w(!0)}if(i.contains(be))return w(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){Kt(document,"mousemove",this._onTouchMove),Kt(document,"touchmove",this._onTouchMove),Kt(document,"pointermove",this._onTouchMove),Kt(document,"dragover",Zg),Kt(document,"mousemove",Zg),Kt(document,"touchmove",Zg)},_offUpEvents:function(){var e=this.el.ownerDocument;Kt(e,"mouseup",this._onDrop),Kt(e,"touchend",this._onDrop),Kt(e,"pointerup",this._onDrop),Kt(e,"touchcancel",this._onDrop),Kt(document,"selectstart",this)},_onDrop:function(e){var i=this.el,r=this.options;if(Ga=Bl(be),mm=Bl(be,r.draggable),Yo("drop",this,{evt:e}),zr=be&&be.parentNode,Ga=Bl(be),mm=Bl(be,r.draggable),et.eventCanceled){this._nulling();return}Bb=!1,OM=!1,CI=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),v8(this.cloneId),v8(this._dragStartId),this.nativeDraggable&&(Kt(document,"drop",this),Kt(i,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),xI&&Qe(document.body,"user-select",""),Qe(be,"transform",""),e&&(S2&&(e.cancelable&&e.preventDefault(),!r.dropBubble&&e.stopPropagation()),ft&&ft.parentNode&&ft.parentNode.removeChild(ft),(mr===zr||$s&&$s.lastPutMode!=="clone")&&Ar&&Ar.parentNode&&Ar.parentNode.removeChild(Ar),be&&(this.nativeDraggable&&Kt(be,"dragend",this),SF(be),be.style["will-change"]="",S2&&!Bb&&Va(be,$s?$s.options.ghostClass:this.options.ghostClass,!1),Va(be,this.options.chosenClass,!1),Co({sortable:this,name:"unchoose",toEl:zr,newIndex:null,newDraggableIndex:null,originalEvent:e}),mr!==zr?(Ga>=0&&(Co({rootEl:zr,name:"add",toEl:zr,fromEl:mr,originalEvent:e}),Co({sortable:this,name:"remove",toEl:zr,originalEvent:e}),Co({rootEl:zr,name:"sort",toEl:zr,fromEl:mr,originalEvent:e}),Co({sortable:this,name:"sort",toEl:zr,originalEvent:e})),$s&&$s.save()):Ga!==yw&&Ga>=0&&(Co({sortable:this,name:"update",toEl:zr,originalEvent:e}),Co({sortable:this,name:"sort",toEl:zr,originalEvent:e})),et.active&&((Ga==null||Ga===-1)&&(Ga=yw,mm=II),Co({sortable:this,name:"end",toEl:zr,originalEvent:e}),this.save()))),this._nulling()},_nulling:function(){Yo("nulling",this),mr=be=zr=ft=a0=Ar=BA=Im=Jg=Ec=S2=Ga=mm=yw=II=D_=TI=$s=PM=et.dragged=et.ghost=et.clone=et.active=null,mO.forEach(function(e){e.checked=!0}),mO.length=bF=wF=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":be&&(this._onDragOver(e),MQe(e));break;case"selectstart":e.preventDefault();break}},toArray:function(){for(var e=[],i,r=this.el.children,n=0,s=r.length,o=this.options;n<s;n++)i=r[n],yd(i,o.draggable,this.el,!1)&&e.push(i.getAttribute(o.dataIdAttr)||LQe(i));return e},sort:function(e,i){var r={},n=this.el;this.toArray().forEach(function(s,o){var a=n.children[o];yd(a,this.options.draggable,n,!1)&&(r[s]=a)},this),i&&this.captureAnimationState(),e.forEach(function(s){r[s]&&(n.removeChild(r[s]),n.appendChild(r[s]))}),i&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,i){return yd(e,i||this.options.draggable,this.el,!1)},option:function(e,i){var r=this.options;if(i===void 0)return r[e];var n=HC.modifyOption(this,e,i);typeof n<"u"?r[e]=n:r[e]=i,e==="group"&&s0e(r)},destroy:function(){Yo("destroy",this);var e=this.el;e[Qa]=null,Kt(e,"mousedown",this._onTapStart),Kt(e,"touchstart",this._onTapStart),Kt(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(Kt(e,"dragover",this),Kt(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),function(i){i.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),fO.splice(fO.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!Im){if(Yo("hideClone",this),et.eventCanceled)return;Qe(Ar,"display","none"),this.options.removeCloneOnHide&&Ar.parentNode&&Ar.parentNode.removeChild(Ar),Im=!0}},_showClone:function(e){if(e.lastPutMode!=="clone"){this._hideClone();return}if(Im){if(Yo("showClone",this),et.eventCanceled)return;be.parentNode==mr&&!this.options.group.revertClone?mr.insertBefore(Ar,be):a0?mr.insertBefore(Ar,a0):mr.appendChild(Ar),this.options.group.revertClone&&this.animate(be,Ar),Qe(Ar,"display",""),Im=!1}}};function MQe(t){t.dataTransfer&&(t.dataTransfer.dropEffect="move"),t.cancelable&&t.preventDefault()}function RM(t,e,i,r,n,s,o,a){var l,c=t[Qa],u=c.options.onMove,h;return window.CustomEvent&&!Op&&!GC?l=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(l=document.createEvent("Event"),l.initEvent("move",!0,!0)),l.to=e,l.from=t,l.dragged=i,l.draggedRect=r,l.related=n||e,l.relatedRect=s||Wn(e),l.willInsertAfter=a,l.originalEvent=o,t.dispatchEvent(l),u&&(h=u.call(c,l,o)),h}function SF(t){t.draggable=!1}function $Qe(){y8=!1}function AQe(t,e,i){var r=Wn(T1(i.el,0,i.options,!0)),n=10;return e?t.clientX<r.left-n||t.clientY<r.top&&t.clientX<r.right:t.clientY<r.top-n||t.clientY<r.bottom&&t.clientX<r.left}function kQe(t,e,i){var r=Wn(l7(i.el,i.options.draggable)),n=10;return e?t.clientX>r.right+n||t.clientX<=r.right&&t.clientY>r.bottom&&t.clientX>=r.left:t.clientX>r.right&&t.clientY>r.top||t.clientX<=r.right&&t.clientY>r.bottom+n}function PQe(t,e,i,r,n,s,o,a){var l=r?t.clientY:t.clientX,c=r?i.height:i.width,u=r?i.top:i.left,h=r?i.bottom:i.right,f=!1;if(!o){if(a&&UA<c*n){if(!CI&&(TI===1?l>u+c*s/2:l<h-c*s/2)&&(CI=!0),CI)f=!0;else if(TI===1?l<u+UA:l>h-UA)return-TI}else if(l>u+c*(1-n)/2&&l<h-c*(1-n)/2)return OQe(e)}return f=f||o,f&&(l<u+c*s/2||l>h-c*s/2)?l>u+c/2?1:-1:0}function OQe(t){return Bl(be)<Bl(t)?1:-1}function LQe(t){for(var e=t.tagName+t.className+t.src+t.href+t.textContent,i=e.length,r=0;i--;)r+=e.charCodeAt(i);return r.toString(36)}function RQe(t){mO.length=0;for(var e=t.getElementsByTagName("input"),i=e.length;i--;){var r=e[i];r.checked&&mO.push(r)}}function GA(t){return setTimeout(t,0)}function v8(t){return clearTimeout(t)}_R&&yi(document,"touchmove",function(t){(et.active||Bb)&&t.cancelable&&t.preventDefault()});et.utils={on:yi,off:Kt,css:Qe,find:Qye,is:function(e,i){return!!yd(e,i,e,!1)},extend:yQe,throttle:e0e,closest:yd,toggleClass:Va,clone:i0e,index:Bl,nextTick:GA,cancelNextTick:v8,detectDirection:n0e,getChild:T1};et.get=function(t){return t[Qa]};et.mount=function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];e[0].constructor===Array&&(e=e[0]),e.forEach(function(r){if(!r.prototype||!r.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(r));r.utils&&(et.utils=Hd(Hd({},et.utils),r.utils)),HC.mount(r)})};et.create=function(t,e){return new et(t,e)};et.version=fQe;var xn=[],I2,_8,b8=!1,IF,TF,gO,T2;function FQe(){function t(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var e in this)e.charAt(0)==="_"&&typeof this[e]=="function"&&(this[e]=this[e].bind(this))}return t.prototype={dragStarted:function(i){var r=i.originalEvent;this.sortable.nativeDraggable?yi(document,"dragover",this._handleAutoScroll):this.options.supportPointer?yi(document,"pointermove",this._handleFallbackAutoScroll):r.touches?yi(document,"touchmove",this._handleFallbackAutoScroll):yi(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(i){var r=i.originalEvent;!this.options.dragOverBubble&&!r.rootEl&&this._handleAutoScroll(r)},drop:function(){this.sortable.nativeDraggable?Kt(document,"dragover",this._handleAutoScroll):(Kt(document,"pointermove",this._handleFallbackAutoScroll),Kt(document,"touchmove",this._handleFallbackAutoScroll),Kt(document,"mousemove",this._handleFallbackAutoScroll)),GQ(),HA(),vQe()},nulling:function(){gO=_8=I2=b8=T2=IF=TF=null,xn.length=0},_handleFallbackAutoScroll:function(i){this._handleAutoScroll(i,!0)},_handleAutoScroll:function(i,r){var n=this,s=(i.touches?i.touches[0]:i).clientX,o=(i.touches?i.touches[0]:i).clientY,a=document.elementFromPoint(s,o);if(gO=i,r||this.options.forceAutoScrollFallback||GC||Op||xI){CF(i,this.options,a,r);var l=jm(a,!0);b8&&(!T2||s!==IF||o!==TF)&&(T2&&GQ(),T2=setInterval(function(){var c=jm(document.elementFromPoint(s,o),!0);c!==l&&(l=c,HA()),CF(i,n.options,c,r)},10),IF=s,TF=o)}else{if(!this.options.bubbleScroll||jm(a,!0)===Rd()){HA();return}CF(i,this.options,jm(a,!1),!1)}}},Sp(t,{pluginName:"scroll",initializeByDefault:!0})}function HA(){xn.forEach(function(t){clearInterval(t.pid)}),xn=[]}function GQ(){clearInterval(T2)}var CF=e0e(function(t,e,i,r){if(e.scroll){var n=(t.touches?t.touches[0]:t).clientX,s=(t.touches?t.touches[0]:t).clientY,o=e.scrollSensitivity,a=e.scrollSpeed,l=Rd(),c=!1,u;_8!==i&&(_8=i,HA(),I2=e.scroll,u=e.scrollFn,I2===!0&&(I2=jm(i,!0)));var h=0,f=I2;do{var m=f,g=Wn(m),y=g.top,v=g.bottom,b=g.left,w=g.right,x=g.width,S=g.height,I=void 0,T=void 0,C=m.scrollWidth,E=m.scrollHeight,$=Qe(m),P=m.scrollLeft,k=m.scrollTop;m===l?(I=x<C&&($.overflowX==="auto"||$.overflowX==="scroll"||$.overflowX==="visible"),T=S<E&&($.overflowY==="auto"||$.overflowY==="scroll"||$.overflowY==="visible")):(I=x<C&&($.overflowX==="auto"||$.overflowX==="scroll"),T=S<E&&($.overflowY==="auto"||$.overflowY==="scroll"));var L=I&&(Math.abs(w-n)<=o&&P+x<C)-(Math.abs(b-n)<=o&&!!P),F=T&&(Math.abs(v-s)<=o&&k+S<E)-(Math.abs(y-s)<=o&&!!k);if(!xn[h])for(var V=0;V<=h;V++)xn[V]||(xn[V]={});(xn[h].vx!=L||xn[h].vy!=F||xn[h].el!==m)&&(xn[h].el=m,xn[h].vx=L,xn[h].vy=F,clearInterval(xn[h].pid),(L!=0||F!=0)&&(c=!0,xn[h].pid=setInterval((function(){r&&this.layer===0&&et.active._onTouchMove(gO);var z=xn[this.layer].vy?xn[this.layer].vy*a:0,G=xn[this.layer].vx?xn[this.layer].vx*a:0;typeof u=="function"&&u.call(et.dragged.parentNode[Qa],G,z,t,gO,xn[this.layer].el)!=="continue"||t0e(xn[this.layer].el,G,z)}).bind({layer:h}),24))),h++}while(e.bubbleScroll&&f!==l&&(f=jm(f,!1)));b8=c}},30),l0e=function(e){var i=e.originalEvent,r=e.putSortable,n=e.dragEl,s=e.activeSortable,o=e.dispatchSortableEvent,a=e.hideGhostForTarget,l=e.unhideGhostForTarget;if(i){var c=r||s;a();var u=i.changedTouches&&i.changedTouches.length?i.changedTouches[0]:i,h=document.elementFromPoint(u.clientX,u.clientY);l(),c&&!c.el.contains(h)&&(o("spill"),this.onSpill({dragEl:n,putSortable:r}))}};function c7(){}c7.prototype={startIndex:null,dragStart:function(e){var i=e.oldDraggableIndex;this.startIndex=i},onSpill:function(e){var i=e.dragEl,r=e.putSortable;this.sortable.captureAnimationState(),r&&r.captureAnimationState();var n=T1(this.sortable.el,this.startIndex,this.options);n?this.sortable.el.insertBefore(i,n):this.sortable.el.appendChild(i),this.sortable.animateAll(),r&&r.animateAll()},drop:l0e};Sp(c7,{pluginName:"revertOnSpill"});function u7(){}u7.prototype={onSpill:function(e){var i=e.dragEl,r=e.putSortable,n=r||this.sortable;n.captureAnimationState(),i.parentNode&&i.parentNode.removeChild(i),n.animateAll()},drop:l0e};Sp(u7,{pluginName:"removeOnSpill"});et.mount(new FQe);et.mount(u7,c7);function HQ(t,e,i){t.splice(i,0,t.splice(e,1)[0])}const DQe="esri-layerlist-new-ui",NQe=ye.ofType(vR),qQ="data-sort-filter",WQ="data-layer-uid",VQe="layerUid",jr="esri-layer-list",hr=`${jr}__item`,Te={base:`${jr} esri-widget esri-widget--panel`,newUI:`${jr}--new-ui`,noItems:`${jr}__no-items`,list:`${jr}__list`,listRoot:`${jr}__list--root`,listExclusive:`${jr}__list--exclusive`,listInherited:`${jr}__list--inherited`,listIndependent:`${jr}__list--independent`,item:hr,itemContent:`${hr}-content`,itemMessage:`${hr}--has-message`,itemInvisible:`${hr}--invisible`,itemInvisibleAtScale:`${hr}--invisible-at-scale`,itemChildren:`${hr}--has-children`,itemSelectable:`${hr}--selectable`,itemContainer:`${hr}-container`,actionsMenu:`${hr}-actions-menu`,actionsMenuItem:`${hr}-actions-menu-item`,actionsMenuItemActive:`${hr}-actions-menu-item--active`,actions:`${hr}-actions`,actionsList:`${hr}-actions-list`,action:`${hr}-action`,actionIcon:`${hr}-action-icon`,actionImage:`${hr}-action-image`,actionTitle:`${hr}-action-title`,actionToggle:`${jr}__action-toggle`,actionToggleOn:`${jr}__action-toggle--on`,label:`${hr}-label`,message:`${hr}-message`,title:`${hr}-title`,statusIndicator:`${jr}__status-indicator`,publishing:`${jr}__publishing`,updating:`${jr}__updating`,connectionStatus:`${jr}__connection-status`,connectionStatusConnected:`${jr}__connection-status--connected`,toggleVisible:`${hr}-toggle`,toggleVisibleIcon:`${hr}-toggle-icon`,toggleIcon:`${hr}-toggle-icon`,radioIcon:`${hr}-radio-icon`,childToggle:`${jr}__child-toggle`,childToggleOpen:`${jr}__child-toggle--open`,childOpened:`${jr}__child-toggle-icon--opened`,childClosed:`${jr}__child-toggle-icon--closed`,childClosed_RTL:`${jr}__child-toggle-icon--closed-rtl`,sortableChosen:`${jr}--chosen`,disabled:"esri-disabled",disabledElement:"esri-disabled-element",hidden:"esri-hidden",rotating:"esri-rotating",iconEllipses:"esri-icon-handle-horizontal",iconVisible:"esri-icon-visible",iconInvisible:"esri-icon-non-visible",iconRadioSelected:"esri-icon-radio-checked",iconRadioUnselected:"esri-icon-radio-unchecked",iconNoticeTriangle:"esri-icon-notice-triangle",iconChildrenOpen:"esri-icon-down-arrow",iconDownArrow:"esri-icon-down-arrow",iconRightArrow:"esri-icon-right-triangle-arrow",iconLeftArrow:"esri-icon-left-triangle-arrow",iconLoading:"esri-icon-loading-indicator",iconDefaultAction:"esri-icon-default-action",widgetIcon:"esri-icon-layers"},af={actions:"actions",actionSection:"action-section",items:"items"},Zx={exclusive:"exclusive",inherited:"inherited",independent:"independent"};function c0e(t){const{actionsOpen:e,children:i}=t;e&&(t.actionsOpen=!1),i.forEach(r=>c0e(r))}const EF="root",JQ={statusIndicators:!0,errors:!1};let Ji=class extends di{constructor(e,i){super(e,i),this._sortableNodes=new Map,this._sortableMap=new Map,this._focusSortUid=null,this._newUI=ee(DQe),this._tooltipReferenceMap=new Map,this.visibleItems=null,this.iconClass=Te.widgetIcon,this.icon=null,this.listItemCanGiveFunction=null,this.listItemCanReceiveFunction=null,this.messages=null,this.messagesCommon=null,this.multipleSelectionEnabled=!1,this.selectionEnabled=!1,this.selectedItems=new NQe,this.viewModel=new a7,this.visibleElements={...JQ},this._onSortableSort=({to:r,from:n,item:s,newIndex:o})=>{n&&r&&(n===r?this._sortLayers(this._sortableMap.get(n.dataset.group)):this._moveLayerFromChildList({to:r,from:n,item:s,newIndex:o}))},this._sortableCanSort=(r,n)=>!(!r.el.dataset.group||!n.el.dataset.group),this._sortableCanPull=(r,n,s)=>{const{listItemCanGiveFunction:o}=this,a={selected:es(s),from:es(n.el),to:es(r.el)};return!this._sortableCanSort(r,n)||typeof o!="function"||o.call(null,a)},this._sortableCanPut=(r,n,s)=>{const{listItemCanReceiveFunction:o}=this,a={selected:es(s),from:es(n.el),to:es(r.el)};return!this._sortableCanSort(r,n)||typeof o!="function"||o.call(null,a)},this._onSortableEnd=({oldIndex:r,from:n,to:s,item:o})=>{n!==s&&n.insertBefore(o,n.children[r])}}initialize(){const e=this.operationalItems;this._setVisibleItems(e),this.addHandles([ui(()=>this.operationalItems,"change",()=>this._itemsChanged(e)),J(()=>this.visibleElements,()=>this._itemsChanged(e)),J(()=>this.selectionEnabled,()=>this._toggleAllSorting(),Le)])}loadDependencies(){return Zd({icon:()=>W(()=>import("./calcite-icon-dc1254b1.js"),["./calcite-icon-dc1254b1.js","./icon-55c3c703.js","./observers-c8819292.js"],import.meta.url),tooltip:()=>W(()=>import("./calcite-tooltip-ebb4f778.js"),["./calcite-tooltip-ebb4f778.js","./tooltip-1f202987.js","./openCloseComponent-c78eaefa.js","./browser-14ab28bd.js","./debounce-9700caea.js","./guid-40d04074.js","./FloatingArrow-ab842880.js"],import.meta.url)})}destroy(){this.removeAllHandles(),this._destroySortables(),this._tooltipReferenceMap.clear()}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get listItemCreatedFunction(){return this.viewModel.listItemCreatedFunction}set listItemCreatedFunction(e){this.viewModel.listItemCreatedFunction=e}get operationalItems(){return this.viewModel.operationalItems}set operationalItems(e){this.viewModel.operationalItems=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}castVisibleElements(e){return{...JQ,...e}}triggerAction(e,i){return this.viewModel.triggerAction(e,i)}render(){var a;const{visibleItems:e,_newUI:i}=this,r=(a=this.viewModel)==null?void 0:a.state,n={[Te.newUI]:i,[Te.hidden]:r==="loading",[Te.disabled]:r==="disabled"},s=this.renderItemTooltips(),o=this.renderItems();return M("div",{class:this.classes(Te.base,n)},e.length?[s,o]:this.renderNoItems())}renderItemTooltip(e){const{_tooltipReferenceMap:i,messages:r}=this;return e?M("calcite-tooltip",{label:r.layerIncompatible,referenceElement:i.get(e.uid)},r.layerIncompatibleTooltip):null}renderItemTooltipNodes(e){const{incompatible:i,children:r}=e;return[i?this.renderItemTooltip(e):null,...!i&&r?r.toArray().map(n=>this.renderItemTooltipNodes(n)):[]]}renderItemTooltips(){return this.visibleItems.toArray().map(e=>this.renderItemTooltipNodes(e))??[]}renderNoItems(){return M("div",{class:Te.noItems},this.messages.noItemsToDisplay)}renderItems(){const{visibleItems:e,selectionEnabled:i,messages:r}=this;return M("ul",{"aria-label":r.widgetLabel,role:i?"listbox":void 0,afterCreate:this._sortNodeCreated,afterUpdate:this._sortNodeCreated,afterRemoved:this._sortNodeRemoved,"data-group":EF,bind:this,class:this.classes(Te.list,Te.listRoot,Te.listIndependent)},e.map(n=>this.renderItem(n,null)).toArray())}renderActionsMenuIcon(e,i){const{messagesCommon:r}=this,n={[Te.actionsMenuItemActive]:e.actionsOpen};return M("div",{key:"actions-menu-toggle","data-item":e,bind:this,onclick:this._toggleActionsOpen,onkeydown:this._toggleActionsOpen,class:this.classes(Te.actionsMenuItem,n),tabindex:"0",role:"button","aria-controls":i,"aria-label":r.options,title:r.options},M("span",{"aria-hidden":"true",class:Te.iconEllipses}))}renderActionsMenu(e,i,r,n){const{panel:s}=e,o=s&&s.visible?this.renderPanelButton(s):null,a=r===1&&this._getSingleActionButton(i),l=a?this.renderAction({item:e,action:a,singleAction:!0}):null,c=!a&&r?this.renderActionsMenuIcon(e,n):null;return c||o||a?M("div",{key:"actions-menu",class:Te.actionsMenu},o,l,c):null}renderChildList(e,i){var h;const{selectionEnabled:r}=this,{visibilityMode:n,children:s}=e,o=this._hasChildren(e),a=!o&&r&&((h=e.layer)==null?void 0:h.type)==="group",{exclusive:l,inherited:c}=Zx,u={[Te.listExclusive]:n===l,[Te.listInherited]:n===c,[Te.listIndependent]:n!==c&&n!==l};return o||a?M("ul",{bind:this,key:"list-items",id:i,"data-group":e.uid,"data-item":e,afterCreate:this._sortNodeCreated,afterUpdate:this._sortNodeCreated,afterRemoved:this._sortNodeRemoved,class:this.classes(Te.list,u),"aria-expanded":e.open?"true":"false",role:r?"listbox":n===l?"radiogroup":"group",hidden:!e.open&&!a||null},s==null?void 0:s.map(f=>this.renderItem(f,e)).toArray()):null}renderChildrenToggle(e,i){const{messagesCommon:r}=this,n=this._hasChildren(e),s={[Te.childToggleOpen]:e.open},o=e.open?r.collapse:r.expand;return n?M("span",{onclick:this._toggleChildrenClick,onkeydown:this._toggleChildrenClick,"data-item":e,key:"toggle-children",class:this.classes(Te.childToggle,s),tabindex:"0",role:"button","aria-controls":i,"aria-label":o,title:o},M("span",{"aria-hidden":"true",class:this.classes(Te.childClosed,Te.iconRightArrow)}),M("span",{"aria-hidden":"true",class:this.classes(Te.childOpened,Te.iconDownArrow)}),M("span",{"aria-hidden":"true",class:this.classes(Te.childClosed_RTL,Te.iconLeftArrow)})):null}renderItemMessage(e){return e.error?M("div",{key:"esri-layer-list__error",class:Te.message,role:"alert"},M("span",{"aria-hidden":"true",class:Te.iconNoticeTriangle}),this.messages.layerError):e.incompatible?M("div",{key:"esri-layer-list__incompatible",class:Te.message,role:"alert"},M("span",{bind:this,tabIndex:0,"aria-hidden":"true",class:Te.iconNoticeTriangle,afterCreate:i=>this._setTooltipReference(i,e)}),this.messages.layerIncompatible):null}renderItemContent(e,i,r){const{id:n}=this,s=`${n}_${e.uid}`,o=`${s}_actions`,a=`${s}__list`,{panel:l}=e,c=this._filterActions(e.actionsSections),u=this._countActions(c);return[M("div",{key:"list-item-container",class:Te.itemContainer},this.renderChildrenToggle(e,a),this.renderLabel(e,i,r),this.renderActionsMenu(e,c,u,o)),this.renderItemMessage(e),u?this.renderActionsSections(e,c,o):null,l&&l.open&&!l.disabled?l.render():null,this.renderChildList(e,a)]}renderItem(e,i){var h;const{_newUI:r,id:n,selectionEnabled:s,selectedItems:o}=this,a=`${`${n}_${e.uid}`}__title`,l=this._hasMessage(e),c=this._hasChildren(e),u={[Te.itemChildren]:c,[Te.itemMessage]:!!l,[Te.itemInvisible]:r&&!e.visible,[Te.itemInvisibleAtScale]:!e.visibleAtCurrentScale,[Te.itemSelectable]:s};if(s){const f={[WQ]:(h=e.layer)==null?void 0:h.uid,[qQ]:(!e.sortable).toString()};return M("li",{key:`item-with-selection-${e.uid}`,bind:this,afterCreate:this._focusListItem,afterUpdate:this._focusListItem,class:this.classes(Te.item,u),"aria-labelledby":a,onclick:this._toggleSelection,onkeydown:this._selectionKeydown,"data-item":e,"data-group":i?i.uid:EF,tabIndex:0,"aria-selected":gF(e,o)?"true":"false",role:"option",...f},this.renderItemContent(e,i,a))}return M("li",{key:`item-no-selection-${e.uid}`,bind:this,afterCreate:this._focusListItem,afterUpdate:this._focusListItem,class:this.classes(Te.item,u),"aria-labelledby":a},this.renderItemContent(e,i,a))}renderConnectionIcon(e){const{connectionStatus:i}=e;return i!=null?M("calcite-icon",{icon:i==="connected"?"beacon":"offline",scale:"s"}):null}renderItemStatus(e,i){const{visibleElements:r}=this;if(!r.statusIndicators)return null;const{connectionStatus:n,publishing:s,updating:o}=e,a=o&&!i,l=!!n;return M("span",{class:this.classes({[Te.statusIndicator]:!0,[Te.publishing]:s,[Te.updating]:a,[Te.connectionStatus]:l,[Te.connectionStatusConnected]:l&&n==="connected"}),key:"layer-item-status"},this.renderConnectionIcon(e))}renderItemTitle(e,i){const{messages:r}=this;if(!e)return null;const n=e.title||r.untitledLayer,s=e.visibleAtCurrentScale?n:`${n} (${r.layerInvisibleAtScale})`;return M("span",{key:"layer-title-container",id:i,title:s,"aria-label":s,class:Te.title},n)}renderItemToggleIcon(e,i){const{_newUI:r}=this,{exclusive:n}=Zx,s=i==null?void 0:i.visibilityMode,o={[Te.toggleVisibleIcon]:r,[Te.toggleIcon]:r&&s!==n,[Te.radioIcon]:r&&s===n,[Te.iconRadioSelected]:s===n&&e.visible,[Te.iconRadioUnselected]:s===n&&!e.visible,[Te.iconVisible]:s!==n&&e.visible,[Te.iconInvisible]:s!==n&&!e.visible};return M("span",{key:"item-toggle-icon",class:this.classes(o),"aria-hidden":"true"})}renderItemToggle(e,i,r){const{selectionEnabled:n,messages:s}=this,{exclusive:o}=Zx,a=i==null?void 0:i.visibilityMode,l=a===o?"radio":"switch";return M("span",n?{key:"item-toggle-selection-enabled",class:Te.toggleVisible,bind:this,onclick:this._toggleVisibility,onkeydown:this._toggleVisibility,"data-item":e,"data-parent-visibility":a,tabIndex:0,title:s.layerVisibility,"aria-checked":e.visible?"true":"false",role:l,"aria-labelledby":r}:{key:"item-toggle",class:Te.toggleVisible},this.renderItemToggleIcon(e,i))}renderLabel(e,i,r){const{selectionEnabled:n,_newUI:s,messages:o}=this,{inherited:a,exclusive:l}=Zx,c=i==null?void 0:i.visibilityMode,u=c===l?"radio":"switch",h=s?[this.renderItemTitle(e,r),this.renderItemStatus(e,i),this.renderItemToggle(e,i,r)]:[this.renderItemToggle(e,i,r),this.renderItemTitle(e,r),this.renderItemStatus(e,i)],f=M("div",n?{key:`item-label-no-selection-${e.uid}`,class:Te.label}:{key:`item-label-with-selection-${e.uid}`,class:Te.label,bind:this,onclick:this._toggleVisibility,onkeydown:this._toggleVisibility,"data-item":e,"data-parent-visibility":c,tabIndex:0,"aria-checked":e.visible?"true":"false",title:o.layerVisibility,role:u,"aria-labelledby":r},h);return c===a||e.error?M("div",{key:`item-label-container-${e.uid}`,class:Te.label},this.renderItemTitle(e,r),this.renderItemStatus(e,i)):f}renderPanelButton(e){const{className:i,open:r,title:n,image:s,disabled:o}=e,a=s||i?i:Te.iconDefaultAction,l=this._getIconImageStyles(e),c={[Te.actionsMenuItemActive]:r&&!o},u={[Te.actionImage]:!!l["background-image"],[Te.disabledElement]:e.disabled};return a&&(u[a]=!!a),M("div",{"aria-disabled":e.disabled.toString(),key:`panel-${e.uid}`,bind:this,"data-panel":e,onclick:this._triggerPanel,onkeydown:this._triggerPanel,class:this.classes(Te.actionsMenuItem,c),role:"button",tabindex:e.disabled?null:0,title:n,"aria-label":n},M("span",{class:this.classes(u),styles:l}))}renderActionsSections(e,i,r){const n=i.toArray().map((s,o)=>M("ul",{key:`${e}-action-section-${o}`,class:Te.actionsList},this.renderActionSection(e,s)));return M("div",{role:"group","aria-expanded":e.actionsOpen?"true":"false",key:"actions-section",id:r,class:Te.actions,hidden:!e.actionsOpen||null},n)}renderActionSection(e,i){return(i&&i.toArray()).map(r=>this.renderAction({item:e,action:r}))}renderActionIcon(e){const{active:i,className:r}=e,n=this._getIconImageStyles(e),s=e.type!=="button"||e.image||r?r:Te.iconDefaultAction,o={[Te.actionImage]:!i&&!!n["background-image"],[Te.iconLoading]:i,[Te.rotating]:i};return s&&!i&&(o[s]=!0),M("span",{key:"action-icon","aria-hidden":"true",class:this.classes(Te.actionIcon,o),styles:n})}renderActionTitle(e,i){return i?null:M("span",{key:"action-title",class:Te.actionTitle},e)}renderAction(e){const{item:i,action:r,singleAction:n}=e,{active:s,disabled:o,title:a}=r,l={[Te.actionsMenuItem]:n&&r.type==="button",[Te.action]:s||!n&&r.type!=="toggle",[Te.actionToggle]:!s&&r.type==="toggle",[Te.actionToggleOn]:!s&&r.type==="toggle"&&r.value,[Te.disabledElement]:o},c=[this.renderActionIcon(r),this.renderActionTitle(a,n)];return n?M("div",{bind:this,"data-item":i,"data-action":r,role:"button",key:`single-action-${r.uid}`,onclick:this._triggerAction,onkeydown:this._triggerAction,classes:l,tabindex:"0",title:a??void 0,"aria-label":a??void 0},c):M("li",{bind:this,"data-item":i,"data-action":r,key:`action-${r.uid}`,onclick:this._triggerAction,onkeydown:this._triggerAction,classes:l,tabindex:"0",role:"button",title:a??void 0,"aria-label":a??void 0},c)}_setTooltipReference(e,i){this._tooltipReferenceMap.set(i.uid,e),this.scheduleRender()}_hasMessage(e){return!!e.error||e.incompatible}_hasChildren(e){return!!e.children.length&&!this._hasMessage(e)}_sortNodeRemoved(e){const{_sortableMap:i}=this,r=e.dataset.group,n=i.get(r);n&&n.destroy(),i.delete(r)}_destroySortables(){const{_sortableMap:e,_sortableNodes:i}=this;e.forEach(r=>r&&r.destroy()),e.clear(),i.clear()}_moveLayerFromChildList({to:e,from:i,item:r,newIndex:n}){const s=es(r),o=es(e),a=es(i);this.viewModel.moveListItem(s,a,o,n)}_sortLayers(e){var n,s;if(!e)return;const i=es(e.el),r=e.toArray();i?rQe(i,r):Hye((s=(n=this.view)==null?void 0:n.map)==null?void 0:s.layers,r)}_toggleSorting(e,i){const{_sortableMap:r,selectionEnabled:n}=this,s=r.get(i),o=es(e),a=(i===EF||(o==null?void 0:o.childrenSortable)&&tQe(o))&&n;if(s)s.option("disabled",!a);else if(a){const l=et.create(e,{dataIdAttr:WQ,group:{name:i,pull:this._sortableCanPull,put:this._sortableCanPut},filter:`[${qQ}="true"]`,fallbackTolerance:4,onSort:this._onSortableSort,onEnd:this._onSortableEnd,disabled:!a,chosenClass:Te.sortableChosen});r.set(i,l)}}_toggleAllSorting(){this._sortableNodes.forEach((e,i)=>this._toggleSorting(e,i))}_sortNodeCreated(e){const i=e.dataset.group;i&&(this._sortableNodes.set(i,e),this._toggleSorting(e,i))}_setVisibleItems(e){this.visibleItems=e.filter(i=>!i.hidden&&(this.visibleElements.errors||!i.error))}_getSingleActionButton(e){return e.reduce(i=>i).filter(i=>i&&i.type==="button").at(0)}_focusListItem(e){var n;const{_focusSortUid:i}=this;if(!e||!i)return;const r=es(e);((n=r==null?void 0:r.layer)==null?void 0:n.uid)===i&&(e.focus(),this._focusSortUid=null)}_watchActionSectionChanges(e){this.addHandles(e.on("change",this.scheduleRender.bind(this)),af.actionSection),e.forEach(i=>this._renderOnActionChanges(i))}_renderOnActionChanges(e){e.type!=="toggle"?e.type!=="slider"?this.addHandles(J(()=>[e==null?void 0:e.className,e==null?void 0:e.image,e==null?void 0:e.id,e==null?void 0:e.title,e==null?void 0:e.visible],()=>this.scheduleRender(),Le),af.actions):this.addHandles(J(()=>[e==null?void 0:e.className,e==null?void 0:e.id,e==null?void 0:e.title,e==null?void 0:e.visible,e==null?void 0:e.value,e==null?void 0:e.displayValueEnabled,e==null?void 0:e.max,e==null?void 0:e.min,e==null?void 0:e.step],()=>this.scheduleRender(),Le),af.actions):this.addHandles(J(()=>[e==null?void 0:e.className,e==null?void 0:e.image,e==null?void 0:e.id,e==null?void 0:e.title,e==null?void 0:e.visible,e==null?void 0:e.value],()=>this.scheduleRender(),Le),af.actions)}_renderOnItemChanges(e){this.addHandles([J(()=>{var i,r,n;return[e==null?void 0:e.actionsOpen,e==null?void 0:e.visible,e==null?void 0:e.open,e==null?void 0:e.updating,e==null?void 0:e.connectionStatus,e==null?void 0:e.publishing,e==null?void 0:e.title,e==null?void 0:e.visibleAtCurrentScale,e==null?void 0:e.error,e==null?void 0:e.visibilityMode,e==null?void 0:e.panel,(i=e==null?void 0:e.panel)==null?void 0:i.title,(r=e==null?void 0:e.panel)==null?void 0:r.content,(n=e==null?void 0:e.panel)==null?void 0:n.className,e==null?void 0:e.sortable,e==null?void 0:e.childrenSortable]},()=>this.scheduleRender(),ji),J(()=>[e==null?void 0:e.hidden,e==null?void 0:e.error],()=>this._setVisibleItems(this.operationalItems)),e.actionsSections.on("change",()=>this.scheduleRender()),e.children.on("change",()=>this.scheduleRender())],af.items),e.children.forEach(i=>this._renderOnItemChanges(i)),e.actionsSections.forEach(i=>this._watchActionSectionChanges(i))}_itemsChanged(e){this.removeHandles(af.items),this.removeHandles(af.actions),this.removeHandles(af.actionSection),e.forEach(i=>this._renderOnItemChanges(i)),this._tooltipReferenceMap.clear(),this._setVisibleItems(e),this.scheduleRender()}_filterActions(e){return e.map(i=>i.filter(r=>r.visible))}_countActions(e){return e.reduce((i,r)=>i+r.length,0)}_getIconImageStyles(e){const i=e.declaredClass==="esri.widgets.LayerList.ListItemPanel"||e.declaredClass==="esri.support.Action.ActionButton"||e.declaredClass==="esri.support.Action.ActionToggle"?e.image:null;return{"background-image":i?`url("${i}")`:void 0}}_selectionKeydown(e){var g,y,v,b;const i=["ArrowDown","ArrowUp"],r=ip(e);if(!i.includes(r))return void this._toggleSelection(e);e.stopPropagation();const n=e.currentTarget,s=es(n),{_sortableMap:o,selectedItems:a}=this,l=n.dataset.group,c=o.get(l);if(!c||!s)return;const u=gF(s,a),h=c.toArray(),f=e.target,m=h.indexOf(f.dataset[VQe]);if(m!==-1){if(r==="ArrowDown"){const w=m+1;if(w>=h.length)return;u?(HQ(h,m,w),c.sort(h),this._sortLayers(c),this._focusSortUid=(g=s.layer)==null?void 0:g.uid):(this._focusSortUid=(y=s.layer)==null?void 0:y.uid,this.scheduleRender())}if(r==="ArrowUp"){const w=m-1;if(w<=-1)return;u?(HQ(h,m,w),c.sort(h),this._sortLayers(c),this._focusSortUid=(v=s.layer)==null?void 0:v.uid):(this._focusSortUid=(b=s.layer)==null?void 0:b.uid,this.scheduleRender())}}}_toggleActionsOpen(e){const i=es(e.currentTarget);if(!i)return;const{actionsOpen:r}=i,n=!r;n&&this.operationalItems.forEach(s=>c0e(s)),i.actionsOpen=n,e.stopPropagation()}_triggerPanel(e){const i=zQe(e.currentTarget);e.stopPropagation(),i&&!i.disabled&&(i.open=!i.open)}_triggerAction(e){const i=e.currentTarget,r=jQe(i),n=es(i);r&&n&&(r.type==="toggle"&&(r.value=!r.value),this.triggerAction(r,n),e.stopPropagation())}_toggleVisibility(e){const i=e.currentTarget,r=i.getAttribute("data-parent-visibility"),n=es(i);n&&(r===Zx.exclusive&&n.visible||(n.visible=!n.visible),e.stopPropagation())}_toggleChildrenClick(e){const i=es(e.currentTarget);i&&(i.open=!i.open,e.stopPropagation())}_toggleSelection(e){var a,l;e.stopPropagation();const{multipleSelectionEnabled:i,selectedItems:r}=this,n=es(e.currentTarget);if(!n)return;const s=gF(n,r),{length:o}=r;if(!i)return o&&!(s&&o===1)?(r.removeAll(),void r.add(n)):void(s?(a=r.remove)==null?void 0:a.call(r,s):r.add(n));s?(l=r.remove)==null||l.call(r,s):r.add(n)}get test(){return{visibleItems:this.visibleItems}}};function es(t){return t==null?void 0:t["data-item"]}function zQe(t){return t==null?void 0:t["data-panel"]}function jQe(t){return t==null?void 0:t["data-action"]}d([p()],Ji.prototype,"visibleItems",void 0),d([p()],Ji.prototype,"iconClass",void 0),d([p()],Ji.prototype,"icon",void 0),d([p()],Ji.prototype,"label",null),d([p()],Ji.prototype,"listItemCanGiveFunction",void 0),d([p()],Ji.prototype,"listItemCanReceiveFunction",void 0),d([p()],Ji.prototype,"listItemCreatedFunction",null),d([p(),ut("esri/widgets/LayerList/t9n/LayerList")],Ji.prototype,"messages",void 0),d([p(),ut("esri/t9n/common")],Ji.prototype,"messagesCommon",void 0),d([p()],Ji.prototype,"multipleSelectionEnabled",void 0),d([p()],Ji.prototype,"operationalItems",null),d([p()],Ji.prototype,"selectionEnabled",void 0),d([p()],Ji.prototype,"selectedItems",void 0),d([p()],Ji.prototype,"view",null),d([BC("trigger-action"),p({type:a7})],Ji.prototype,"viewModel",void 0),d([p()],Ji.prototype,"visibleElements",void 0),d([tt("visibleElements")],Ji.prototype,"castVisibleElements",null),d([wr()],Ji.prototype,"_toggleActionsOpen",null),d([wr()],Ji.prototype,"_triggerPanel",null),d([wr()],Ji.prototype,"_triggerAction",null),d([wr()],Ji.prototype,"_toggleVisibility",null),d([wr()],Ji.prototype,"_toggleChildrenClick",null),d([wr()],Ji.prototype,"_toggleSelection",null),Ji=d([A("esri.widgets.LayerList")],Ji);const BQe=Ji;function ec(t){let e,i,r=[],n=!1;function s(...o){return n&&e===this&&UQe(o,r)||(i=t.apply(this,o),e=this,r=o,n=!0),i}return s}function UQe(t,e){if(t.length!==e.length)return!1;for(let i=0;i<t.length;++i)if(t[i]!==e[i])return!1;return!0}const Dn="esri-elevation-profile",Hi={esriWidget:"esri-widget--panel esri-widget",esriWidgetDisabled:"esri-widget--disabled",buttonDisabled:"esri-button--disabled",widgetIcon:"esri-icon-elevation-profile",base:`${Dn}`,portrait:`${Dn}--portrait`,refined:`${Dn}--refined`,mainContainer:`${Dn}__main-container`,promptContainer:`${Dn}__prompt-container`,header:`${Dn}__header`,zoomOutButton:`${Dn}__zoom-out-button esri-icon-zoom-out-magnifying-glass`,clearButton:`${Dn}__clear-button esri-icon-trash`,actionButton:`${Dn}__action-button esri-button`,sketchButton:`${Dn}__sketch-button esri-button--primary`,sketchCancelButton:`${Dn}__sketch-cancel-button esri-button--secondary`,sketchDoneButton:`${Dn}__sketch-done-button esri-button--primary`,selectButton:`${Dn}__select-button esri-button--secondary`,selectCancelButton:`${Dn}__select-cancel-button esri-button--secondary`,chartContainer:`${Dn}__chart-container`,chartSpinner:`${Dn}__chart-spinner esri-icon-loading-indicator esri-rotating`,chartSpinnerVisible:`${Dn}__chart-spinner--visible`,chartSpinnerSmall:`${Dn}__chart-spinner--small`,footer:`${Dn}__footer`},GQe={line:"amcharts-LineSeries",cursorEnabled:"amcharts-cursor--enabled",axisTooltip:"amcharts-axis-tooltip",seriesTooltip:"amcharts-series-tooltip"},HQe={base:"esri-elevation-profile-legend"},Mc="esri-elevation-profile-legend-item",yl={base:Mc,disabled:`${Mc}--disabled`,expanded:`${Mc}--expanded`,colorIndicator:`${Mc}__color-indicator`,header:`${Mc}__header`,content:`${Mc}__content`,collapseToggle:`${Mc}__collapse-toggle esri-button esri-button--tertiary`,collapseToggleIcon:`${Mc}__collapse-toggle__icon esri-icon-down`,label:`${Mc}__label`,labelDisabled:`${Mc}__label--disabled`,checkbox:`${Mc}__checkbox`},Yx="esri-elevation-profile-statistics",Yg={base:Yx,statistic:`${Yx}__statistic`,statisticLabel:`${Yx}__statistic__label`,statisticValue:`${Yx}__statistic__value`,slopeValue:`${Yx}__slope-value`,slopeUpIcon:"esri-icon-arrow-up",slopeDownIcon:"esri-icon-arrow-down"},Kg="esri-elevation-profile-settings",Xg={base:`${Kg} esri-icon-handle-vertical`,popoverContent:`${Kg}__popover-content`,select:`${Kg}__select esri-select`,selectLabel:`${Kg}__select-label`,checkboxLabel:`${Kg}__checkbox-label`,checkbox:`${Kg}__checkbox`,uniformChartScalingCheckbox:`${Kg}__uniform-chart-scaling-checkbox`};let qQe=class{constructor(e){this._store=e}destroy(){this._store.destroy()}get(e){return this._store.get(e)}put(e,i){this._store.put(e,i,i.values.byteLength+256)}};function WQe(t){var n,s;const e="metric";if(t==null)return e;const i=t.map,r=(i&&"portalItem"in i?(n=i.portalItem)==null?void 0:n.portal:null)??on.getDefault();switch(((s=r.user)==null?void 0:s.units)??r.units){case e:return e;case"english":return"imperial"}return S2e(t.spatialReference)??e}const JQe={readOnly:!0,get(){return WQe(this.view)}};function u0e(t,e,i,r){let n=null,s=1e3;typeof e=="number"?(s=e,r=i):(n=e??null,s=i);let o,a=0;const l=()=>{a=0,t.apply(r,o)},c=(...u)=>{n&&n.apply(r,u),o=u,s?a||(a=setTimeout(l,s)):l()};return c.remove=()=>{a&&(clearTimeout(a),a=0)},c.forceUpdate=()=>{a&&(clearTimeout(a),l())},c.hasPendingUpdates=()=>!!a,c}function d0e(t){return t?rn:eet}function ZQe(t,e){return e!=null&&e.mode?e.mode:d0e(t).mode}function YQe(t,e){return e??d0e(t)}function h0e(t,e){return ZQe(t!=null&&t.hasZ,e)}function Xxt(t,e){return YQe(t!=null&&!!t.hasZ,e)}function bR(t){const e=d7(t);return h0e(t.geometry,e)}function p0e(t){const e=d7(t),i=h0e(t.geometry,e);return{mode:i,offset:e!=null&&i!=="on-the-ground"?(e.offset??0)*cze(e.unit??"meters"):0}}function wR(t){if(bR(t)==="on-the-ground")return!1;const e=d7(t),i=e!=null&&e.featureExpressionInfo?e.featureExpressionInfo.expression:null;return!(!i||i==="0")}function d7(t){return t.layer&&"elevationInfo"in t.layer?t.layer.elevationInfo:null}function Qxt(t,e,i){if(i==null||!i.mode)return;const r=t.hasZ?t.z:0,n=i.offset!=null?i.offset:0;switch(i.mode){case"absolute-height":return r-n;case"on-the-ground":return 0;case"relative-to-ground":return r-((e.elevationProvider.getElevation(t.x,t.y,r,t.spatialReference,"ground")??0)+n);case"relative-to-scene":return r-((e.elevationProvider.getElevation(t.x,t.y,r,t.spatialReference,"scene")??0)+n)}}function KQe(t,e,i,r=null){return m0e(t,e.x,e.y,e.hasZ?e.z:0,e.spatialReference,i,r)}function f0e(t,e,i,r,n=null){return m0e(t,e[0],e[1],e.length>2?e[2]:0,i,r,n)}function m0e(t,e,i,r,n,s,o=null){if(s==null)return;const a=o!=null?o.mode:"absolute-height";if(a==="on-the-ground")return 0;const{absoluteZ:l}=XQe(e,i,r,n,t,s);return QQe(l,e,i,r,n,t,o,a)}function XQe(t,e,i,r,n,s){const o=s.offset!=null?s.offset:0;switch(s.mode){case"absolute-height":return{absoluteZ:i+o,elevation:0};case"on-the-ground":{const a=n.elevationProvider.getElevation(t,e,0,r,"ground")??0;return{absoluteZ:a,elevation:a}}case"relative-to-ground":{const a=n.elevationProvider.getElevation(t,e,i,r,"ground")??0;return{absoluteZ:i+a+o,elevation:a}}case"relative-to-scene":{const a=n.elevationProvider.getElevation(t,e,i,r,"scene")??0;return{absoluteZ:i+a+o,elevation:a}}}}function QQe(t,e,i,r,n,s,o,a){const l=o!=null&&o.offset!=null?o.offset:0;switch(a){case"absolute-height":return t-l;case"relative-to-ground":return t-((s.elevationProvider.getElevation(e,i,r,n,"ground")??0)+l);case"relative-to-scene":return t-((s.elevationProvider.getElevation(e,i,r,n,"scene")??0)+l)}}function eSt(t,e){if(e==null)return!1;const{mode:i}=e;return i!=null&&(t==="scene"&&i==="relative-to-scene"||t==="ground"&&i!=="absolute-height")}const rn={mode:"absolute-height",offset:0},eet={mode:"on-the-ground",offset:null};let tet=class{};const iet=tet;function ZQ(t,...e){let i="";for(let r=0;r<e.length;r++)i+=t[r]+e[r];return i+=t[t.length-1],i}(function(t){function e(r){return Math.round(r).toString()}function i(r){return r.toPrecision(8)}t.int=e,t.float=i})(ZQ||(ZQ={}));let ret=class{constructor(){this.id=X0()}unload(){}};var yO;(function(t){t[t.Layer=0]="Layer",t[t.Object=1]="Object",t[t.Mesh=2]="Mesh",t[t.Line=3]="Line",t[t.Point=4]="Point",t[t.Material=5]="Material",t[t.Texture=6]="Texture",t[t.COUNT=7]="COUNT"})(yO||(yO={}));var yr;(function(t){t.POSITION="position",t.NORMAL="normal",t.NORMALCOMPRESSED="normalCompressed",t.UV0="uv0",t.AUXPOS1="auxpos1",t.AUXPOS2="auxpos2",t.COLOR="color",t.SYMBOLCOLOR="symbolColor",t.SIZE="size",t.TANGENT="tangent",t.OFFSET="offset",t.SUBDIVISIONFACTOR="subdivisionFactor",t.COLORFEATUREATTRIBUTE="colorFeatureAttribute",t.SIZEFEATUREATTRIBUTE="sizeFeatureAttribute",t.OPACITYFEATUREATTRIBUTE="opacityFeatureAttribute",t.DISTANCETOSTART="distanceToStart",t.UVMAPSPACE="uvMapSpace",t.BOUNDINGRECT="boundingRect",t.UVREGION="uvRegion",t.PROFILERIGHT="profileRight",t.PROFILEUP="profileUp",t.PROFILEVERTEXANDNORMAL="profileVertexAndNormal",t.FEATUREVALUE="featureValue",t.MODELORIGINHI="modelOriginHi",t.MODELORIGINLO="modelOriginLo",t.MODEL="model",t.MODELNORMAL="modelNormal",t.INSTANCECOLOR="instanceColor",t.INSTANCEFEATUREATTRIBUTE="instanceFeatureAttribute",t.LOCALTRANSFORM="localTransform",t.GLOBALTRANSFORM="globalTransform",t.BOUNDINGSPHERE="boundingSphere",t.MODELORIGIN="modelOrigin",t.MODELSCALEFACTORS="modelScaleFactors",t.FEATUREATTRIBUTE="featureAttribute",t.STATE="state",t.LODLEVEL="lodLevel",t.POSITION0="position0",t.POSITION1="position1",t.NORMALA="normalA",t.NORMALB="normalB",t.COMPONENTINDEX="componentIndex",t.VARIANTOFFSET="variantOffset",t.VARIANTSTROKE="variantStroke",t.VARIANTEXTENSION="variantExtension",t.U8PADDING="u8padding",t.U16PADDING="u16padding",t.SIDENESS="sideness",t.START="start",t.END="end",t.UP="up",t.EXTRUDE="extrude",t.OBJECTANDLAYERIDCOLOR="objectAndLayerIdColor",t.INSTANCEOBJECTANDLAYERIDCOLOR="instanceObjectAndLayerIdColor"})(yr||(yr={}));const net=new Map([[yr.POSITION,0],[yr.NORMAL,1],[yr.NORMALCOMPRESSED,1],[yr.UV0,2],[yr.COLOR,3],[yr.COLORFEATUREATTRIBUTE,3],[yr.SIZE,4],[yr.TANGENT,4],[yr.AUXPOS1,5],[yr.SYMBOLCOLOR,5],[yr.AUXPOS2,6],[yr.FEATUREATTRIBUTE,6],[yr.INSTANCEFEATUREATTRIBUTE,6],[yr.INSTANCECOLOR,7],[yr.OBJECTANDLAYERIDCOLOR,7],[yr.INSTANCEOBJECTANDLAYERIDCOLOR,7],[yr.MODEL,8],[yr.MODELNORMAL,12],[yr.MODELORIGINHI,11],[yr.MODELORIGINLO,15]]);function set(t){return Math.abs(t*t*t)}function g0e(t,e,i){const r=i.parameters,n=i.paddingPixelsOverride;return Kx.scale=Math.min(r.divisor/(e-r.offset),1),Kx.factor=set(t),Kx.minPixelSize=r.minPixelSize,Kx.paddingPixels=n,Kx}function y0e(t,e){return t===0?e.minPixelSize:e.minPixelSize*(1+2*e.paddingPixels/t)}function v0e(t,e){return Math.max(kB(t*e.scale,t,e.factor),y0e(t,e))}function oet(t,e,i){const r=g0e(t,e,i);return r.minPixelSize=0,r.paddingPixels=0,v0e(1,r)}function rSt(t,e,i,r){r.scale=oet(t,e,i),r.factor=0,r.minPixelSize=i.parameters.minPixelSize,r.paddingPixels=i.paddingPixelsOverride}function nSt(t,e,i=[0,0]){const r=Math.min(Math.max(e.scale,y0e(t[1],e)/Math.max(1e-5,t[1])),1);return i[0]=t[0]*r,i[1]=t[1]*r,i}function aet(t,e,i,r){return v0e(t,g0e(e,i,r))}const Kx={scale:0,factor:0,minPixelSize:0,paddingPixels:0};let cet=class{constructor(e){this.message=e}toString(){return`AssertException: ${this.message}`}};function uet(t,e){if(!t){e=e||"Assertion";const i=new Error(e).stack;throw new cet(`${e} at ${i}`)}}function oSt(t,e){t||(e=e||"",console.warn("Verify failed: "+e+`
`+new Error("verify").stack))}function aSt(t,e,i,r){let n,s=(i[0]-t[0])/e[0],o=(r[0]-t[0])/e[0];s>o&&(n=s,s=o,o=n);let a=(i[1]-t[1])/e[1],l=(r[1]-t[1])/e[1];if(a>l&&(n=a,a=l,l=n),s>l||a>o)return!1;a>s&&(s=a),l<o&&(o=l);let c=(i[2]-t[2])/e[2],u=(r[2]-t[2])/e[2];return c>u&&(n=c,c=u,u=n),!(s>u||c>o)&&(u<o&&(o=u),!(o<0))}function lSt(t,e,i,r,n,s=Gt()){const o=(r[n]-i[n])*(e[0]-t[0])-(r[0]-i[0])*(e[n]-t[n]),a=(r[0]-i[0])*(t[n]-i[n])-(r[n]-i[n])*(t[0]-i[0]);if(o===0)return!1;const l=a/o;return s[0]=t[0]+l*(e[0]-t[0]),s[1]=t[n]+l*(e[n]-t[n]),!0}function cSt(t,e){return Math.log(t)/Math.log(e)}function uSt(t,e,i,r){t[12]=e,t[13]=i,t[14]=r}function dSt(t){return t[0]===1&&t[1]===0&&t[2]===0&&t[3]===0&&t[4]===0&&t[5]===1&&t[6]===0&&t[7]===0&&t[8]===0&&t[9]===0&&t[10]===1&&t[11]===0&&t[15]===1}const FM=cL();function hSt(t,e,i,r,n,s){if(t.visible)if(t.boundingInfo){uet(t.type===yO.Mesh);const o=e.tolerance;_0e(t.boundingInfo,i,r,o,n,s)}else{const o=t.indices.get(yr.POSITION),a=t.vertexAttributes.get(yr.POSITION);w0e(i,r,0,o.length/3,o,a,void 0,n,s)}}const det=Me();function _0e(t,e,i,r,n,s){if(t==null)return;const o=pet(e,i,det);if(mAe(FM,t.bbMin),gAe(FM,t.bbMax),n!=null&&n.applyToAabb(FM),fet(FM,e,o,r)){const{primitiveIndices:a,indices:l,position:c}=t,u=a?a.length:l.length/3;if(u>vet){const h=t.getChildren();if(h!==void 0){for(const f of h)_0e(f,e,i,r,n,s);return}}w0e(e,i,0,u,l,c,a,n,s)}}const b0e=Me();function w0e(t,e,i,r,n,s,o,a,l){if(o)return het(t,e,i,r,n,s,o,a,l);const{data:c,stride:u}=s,h=t[0],f=t[1],m=t[2],g=e[0]-h,y=e[1]-f,v=e[2]-m;for(let b=i,w=3*i;b<r;++b){let x=u*n[w++],S=c[x++],I=c[x++],T=c[x];x=u*n[w++];let C=c[x++],E=c[x++],$=c[x];x=u*n[w++];let P=c[x++],k=c[x++],L=c[x];a!=null&&([S,I,T]=a.applyToVertex(S,I,T,b),[C,E,$]=a.applyToVertex(C,E,$,b),[P,k,L]=a.applyToVertex(P,k,L,b));const F=C-S,V=E-I,z=$-T,G=P-S,H=k-I,Z=L-T,K=y*Z-H*v,X=v*G-Z*g,oe=g*H-G*y,se=F*K+V*X+z*oe;if(Math.abs(se)<=Number.EPSILON)continue;const le=h-S,me=f-I,Se=m-T,Ge=le*K+me*X+Se*oe;if(se>0){if(Ge<0||Ge>se)continue}else if(Ge>0||Ge<se)continue;const Be=me*z-V*Se,gt=Se*F-z*le,Pe=le*V-F*me,De=g*Be+y*gt+v*Pe;if(se>0){if(De<0||Ge+De>se)continue}else if(De>0||Ge+De<se)continue;const ii=(G*Be+H*gt+Z*Pe)/se;ii>=0&&l(ii,x0e(F,V,z,G,H,Z,b0e),b,!1)}}function het(t,e,i,r,n,s,o,a,l){const{data:c,stride:u}=s,h=t[0],f=t[1],m=t[2],g=e[0]-h,y=e[1]-f,v=e[2]-m;for(let b=i;b<r;++b){const w=o[b];let x=3*w,S=u*n[x++],I=c[S++],T=c[S++],C=c[S];S=u*n[x++];let E=c[S++],$=c[S++],P=c[S];S=u*n[x];let k=c[S++],L=c[S++],F=c[S];a!=null&&([I,T,C]=a.applyToVertex(I,T,C,b),[E,$,P]=a.applyToVertex(E,$,P,b),[k,L,F]=a.applyToVertex(k,L,F,b));const V=E-I,z=$-T,G=P-C,H=k-I,Z=L-T,K=F-C,X=y*K-Z*v,oe=v*H-K*g,se=g*Z-H*y,le=V*X+z*oe+G*se;if(Math.abs(le)<=Number.EPSILON)continue;const me=h-I,Se=f-T,Ge=m-C,Be=me*X+Se*oe+Ge*se;if(le>0){if(Be<0||Be>le)continue}else if(Be>0||Be<le)continue;const gt=Se*G-z*Ge,Pe=Ge*V-G*me,De=me*z-V*Se,ii=g*gt+y*Pe+v*De;if(le>0){if(ii<0||Be+ii>le)continue}else if(ii>0||Be+ii<le)continue;const Rr=(H*gt+Z*Pe+K*De)/le;Rr>=0&&l(Rr,x0e(V,z,G,H,Z,K,b0e),w,!1)}}const YQ=Me(),KQ=Me();function x0e(t,e,i,r,n,s,o){return Bi(YQ,t,e,i),Bi(KQ,r,n,s),No(o,YQ,KQ),Rs(o,o),o}function pet(t,e,i){return Bi(i,1/(e[0]-t[0]),1/(e[1]-t[1]),1/(e[2]-t[2]))}function fet(t,e,i,r){return met(t,e,i,r,1/0)}function met(t,e,i,r,n){const s=(t[0]-r-e[0])*i[0],o=(t[3]+r-e[0])*i[0];let a=Math.min(s,o),l=Math.max(s,o);const c=(t[1]-r-e[1])*i[1],u=(t[4]+r-e[1])*i[1];if(l=Math.min(l,Math.max(c,u)),l<0||(a=Math.max(a,Math.min(c,u)),a>l))return!1;const h=(t[2]-r-e[2])*i[2],f=(t[5]+r-e[2])*i[2];return l=Math.min(l,Math.max(h,f)),!(l<0)&&(a=Math.max(a,Math.min(h,f)),!(a>l)&&a<n)}function pSt(t,e,i,r,n){let s=(i.screenLength||0)*t.pixelRatio;n!=null&&(s=aet(s,r,e,n));const o=s*Math.tan(.5*t.fovY)/(.5*t.fullHeight);return Pn(o*e,i.minWorldLength||0,i.maxWorldLength!=null?i.maxWorldLength:1/0)}function S0e(t,e){const i=e?S0e(e):{};for(const r in t){let n=t[r];n&&n.forEach&&(n=yet(n)),n==null&&r in i||(i[r]=n)}return i}function get(t,e){let i=!1;for(const r in e){const n=e[r];n!==void 0&&(Array.isArray(n)?t[r]===null?(t[r]=n.slice(),i=!0):Xwe(t[r],n)&&(i=!0):t[r]!==n&&(i=!0,t[r]=n))}return i}function yet(t){const e=[];return t.forEach(i=>e.push(i)),e}const fSt={multiply:1,ignore:2,replace:3,tint:4},vet=1e3;let mSt=class extends ret{constructor(e,i){super(),this.type=yO.Material,this.supportsEdges=!1,this._visible=!0,this._renderPriority=0,this._insertOrder=0,this._vertexAttributeLocations=net,this._pp0=en(0,0,1),this._pp1=en(0,0,0),this._parameters=S0e(e,i),this.validateParameters(this._parameters)}dispose(){}get parameters(){return this._parameters}update(e){return!1}setParameters(e,i=!0){get(this._parameters,e)&&(this.validateParameters(this._parameters),i&&this.parametersChanged())}validateParameters(e){}get visible(){return this._visible}set visible(e){e!==this._visible&&(this._visible=e,this.parametersChanged())}shouldRender(e){return this.isVisible()&&this.isVisibleForOutput(e.output)&&(this.renderOccluded&e.renderOccludedMask)!=0}isVisibleForOutput(e){return!0}get renderOccluded(){return this.parameters.renderOccluded}get renderPriority(){return this._renderPriority}set renderPriority(e){e!==this._renderPriority&&(this._renderPriority=e,this.parametersChanged())}get insertOrder(){return this._insertOrder}set insertOrder(e){e!==this._insertOrder&&(this._insertOrder=e,this.parametersChanged())}get vertexAttributeLocations(){return this._vertexAttributeLocations}isVisible(){return this._visible}parametersChanged(){this.repository!=null&&this.repository.materialChanged(this)}intersectDraped(e,i,r,n,s,o){return this._pp0[0]=this._pp1[0]=n[0],this._pp0[1]=this._pp1[1]=n[1],this.intersect(e,i,r,this._pp0,this._pp1,s)}};var vO;(function(t){t[t.None=0]="None",t[t.Occlude=1]="Occlude",t[t.Transparent=2]="Transparent",t[t.OccludeAndTransparent=4]="OccludeAndTransparent",t[t.OccludeAndTransparentStencil=8]="OccludeAndTransparentStencil",t[t.Opaque=16]="Opaque"})(vO||(vO={}));let ySt=class extends iet{constructor(){super(...arguments),this.renderOccluded=vO.Occlude}};var ya,Tn;(function(t){t.Disabled="disabled",t.Ready="ready",t.Creating="creating",t.Created="created",t.Selecting="selecting",t.Selected="selected"})(ya||(ya={})),function(t){t.NoValidInput="no-valid-input",t.NoVisibleProfiles="no-visible-profiles",t.InvalidGeometry="invalid-geometry",t.TooComplex="too-complex",t.InvalidElevationInfo="invalid-elevation-info",t.UnknownError="unknown-error",t.RefinedButNoChartData="refined-but-no-chart-data",t.None="none"}(Tn||(Tn={}));let I0e={noDataValue:-5e5,defaultQueryOptions:()=>({noDataValue:I0e.noDataValue,demResolution:"auto",maximumAutoTileRequests:150,ignoreInvisibleLayers:!0}),updateThrottleMillis:100,delayAfterPreviewMillis:500,defaultDemResolution:bt(10,"centimeters","meters"),densificationMaxSamples:3e3,largeChartSamples:1e4,maxTotalSamples:1e5,maxChartRatio:300,minSlopeSampleDistance:10,formatPrecision:1,portraitModePixelBreakpoint:400,profileLinesStyle3D:{width:3,outlineSize:0,falloff:0,outlineColor:che([1,1,1,0]),renderOccluded:vO.Opaque},hoveredPointsStyle:{size:14,borderStyle:"solid",borderWidth:3,borderColor:"#ffffff",boxShadow:"0px 0px 0px 5px rgba(255,255,255,0.2)"}};function co(){return I0e}const T0e=" ― ",_et={progress:1,hasZ:!1,samples:[],statistics:null,spatialReference:null};function C0e(t){if(!t)return null;if(lB(t)&&t.wkid){const e=gPe[t.wkid];if(e)return e}if(t.wkt){const e=bet(t.wkt);if(e)return e}return null}function bet(t){const e=fPe.exec(t);if(!e||e.length!==2)return null;const i=e[1].split(",");if(!i||i.length<3)return null;const r=parseFloat(i[1]),n=parseFloat(i[2]);return isNaN(r)||isNaN(n)?null:{a:r,f:n===0?0:1/n}}function xR(t){const e=C0e(t??Ee.WGS84);if(wet(e))return e;const i=e.a*(1-e.f);return Object.assign(e,{b:i,eSq:1-(i/e.a)**2,radius:(2*e.a+i)/3,densificationRatio:1e4/((2*e.a+i)/3)})}function wet(t){return t!=null&&"b"in t&&"eSq"in t&&"radius"in t}function DM(t,e,i){const{a:r,eSq:n}=xR(i),s=Math.sqrt(n),o=Math.sin(e[1]*ma),a=r*e[0]*ma;let l;return n>0?l=r*((1-n)*(o/(1-n*(o*o))-1/(2*s)*Math.log((1-s*o)/(1+s*o))))*.5:l=r*o,t[0]=a,t[1]=l,t}function SR(t){return C0e(t)!==null}function _St(t,e="square-meters"){if(t.some(o=>!SR(o.spatialReference)))throw new N("geodesic-areas:invalid-spatial-reference","the input geometries spatial reference is not supported");const i=[];for(let o=0;o<t.length;o++){const a=t[o],l=a.spatialReference,{radius:c,densificationRatio:u}=xR(l),h=c*u;i.push(Iet(a,h))}const r=[],n=[0,0],s=[0,0];for(let o=0;o<i.length;o++){const{rings:a,spatialReference:l}=i[o];let c=0;for(let u=0;u<a.length;u++){const h=a[u];DM(n,h[0],l),DM(s,h[h.length-1],l);let f=s[0]*n[1]-n[0]*s[1];for(let m=0;m<h.length-1;m++)DM(n,h[m+1],l),DM(s,h[m],l),f+=s[0]*n[1]-n[0]*s[1];c+=f}c=bt(c,"square-meters",e),r.push(c/-2)}return r}function xet(t,e="meters"){if(!t)throw new N("geodesic-lengths:invalid-geometries","the input geometries type is not supported");if(t.some(r=>!SR(r.spatialReference)))throw new N("geodesic-lengths:invalid-spatial-reference","the input geometries spatial reference is not supported");const i=[];for(let r=0;r<t.length;r++){const n=t[r],{spatialReference:s}=n,o=n.type==="polyline"?n.paths:n.rings;let a=0;for(let l=0;l<o.length;l++){const c=o[l];let u=0;for(let h=1;h<c.length;h++){const f=c[h-1][0],m=c[h][0],g=c[h-1][1],y=c[h][1];if(g!==y||f!==m){const v=new E0e;h7(v,[f,g],[m,y],s),u+=v.distance}}a+=u}a=bt(a,"meters",e),i.push(a)}return i}function Iet(t,e){if(t.type!=="polyline"&&t.type!=="polygon")throw new N("geodesic-densify:invalid-geometry","the input geometry is neither polyline nor polygon");const{spatialReference:i}=t;if(!SR(i))throw new N("geodesic-densify:invalid-spatial-reference","the input geometry spatial reference is not supported");const r=t.type==="polyline"?t.paths:t.rings,n=[],s=[0,0],o=new E0e;for(const a of r){const l=[];n.push(l),l.push([a[0][0],a[0][1]]);let c,u,h=a[0][0],f=a[0][1];for(let m=0;m<a.length-1;m++){if(c=a[m+1][0],u=a[m+1][1],h===c&&f===u)continue;const g=[h,f];h7(o,[h,f],[c,u],i);const{azimuth:y,distance:v}=o,b=v/e;if(b>1){for(let w=1;w<=b-1;w++)zw(s,g,y,w*e,i),l.push(s.slice(0));zw(s,g,y,(v+Math.floor(b-1)*e)/2,i),l.push(s.slice(0))}zw(s,g,y,v,i),l.push(s.slice(0)),h=s[0],f=s[1]}}return t.type==="polyline"?new no({paths:n,spatialReference:i}):new Zn({rings:n,spatialReference:i})}let E0e=class{constructor(e=0,i=void 0,r=void 0){this.distance=e,this.azimuth=i,this.reverseAzimuth=r}};function zw(t,e,i,r,n){const s=e[0],o=e[1],a=s*ma,l=o*ma,c=(i??0)*ma,{a:u,b:h,f}=xR(n),m=Math.sin(c),g=Math.cos(c),y=(1-f)*Math.tan(l),v=1/Math.sqrt(1+y*y),b=y*v,w=Math.atan2(y,g),x=v*m,S=x*x,I=1-S,T=I*(u*u-h*h)/(h*h),C=1+T/16384*(4096+T*(T*(320-175*T)-768)),E=T/1024*(256+T*(T*(74-47*T)-128));let $,P,k,L,F=r/(h*C),V=2*Math.PI;for(;Math.abs(F-V)>1e-12;)k=Math.cos(2*w+F),$=Math.sin(F),P=Math.cos(F),L=E*$*(k+E/4*(P*(2*k*k-1)-E/6*k*(4*$*$-3)*(4*k*k-3))),V=F,F=r/(h*C)+L;const z=b*$-v*P*g,G=Math.atan2(b*P+v*$*g,(1-f)*Math.sqrt(S+z*z)),H=Math.atan2($*m,v*P-b*$*g),Z=f/16*I*(4+f*(4-3*I)),K=G/ma,X=(a+(H-(1-Z)*f*x*(F+Z*$*(k+Z*P*(2*k*k-1)))))/ma;return t[0]=X,t[1]=K,t}function h7(t,e,i,r){const n=e[0]*ma,s=e[1]*ma,o=i[0]*ma,a=i[1]*ma,{a:l,b:c,f:u,radius:h}=xR(r),f=o-n,m=Math.atan((1-u)*Math.tan(s)),g=Math.atan((1-u)*Math.tan(a)),y=Math.sin(m),v=Math.cos(m),b=Math.sin(g),w=Math.cos(g);let x,S,I,T,C,E,$,P,k,L,F=1e3,V=f;do{if($=Math.sin(V),P=Math.cos(V),I=Math.sqrt(w*$*(w*$)+(v*b-y*w*P)*(v*b-y*w*P)),I===0)return t.distance=0,t.azimuth=void 0,t.reverseAzimuth=void 0,t;C=y*b+v*w*P,E=Math.atan2(I,C),k=v*w*$/I,S=1-k*k,T=C-2*y*b/S,isNaN(T)&&(T=0),L=u/16*S*(4+u*(4-3*S)),x=V,V=f+(1-L)*u*k*(E+L*I*(T+L*C*(2*T*T-1)))}while(Math.abs(V-x)>1e-12&&--F>0);if(F===0){const X=h,oe=Math.acos(Math.sin(s)*Math.sin(a)+Math.cos(s)*Math.cos(a)*Math.cos(o-n))*X,se=o-n,le=Math.sin(se)*Math.cos(a),me=Math.cos(s)*Math.sin(a)-Math.sin(s)*Math.cos(a)*Math.cos(se),Se=Math.atan2(le,me);return t.azimuth=Se/ma,t.distance=oe,t.reverseAzimuth=void 0,t}const z=S*(l*l-c*c)/(c*c),G=z/1024*(256+z*(z*(74-47*z)-128)),H=c*(1+z/16384*(4096+z*(z*(320-175*z)-768)))*(E-G*I*(T+G/4*(C*(2*T*T-1)-G/6*T*(4*I*I-3)*(4*T*T-3)))),Z=Math.atan2(w*Math.sin(V),v*b-y*w*Math.cos(V)),K=Math.atan2(v*Math.sin(V),v*b*Math.cos(V)-y*w);return t.azimuth=Z/ma,t.distance=H,t.reverseAzimuth=K/ma,t}const M0e="ProfileGenerationError";var tc;(function(t){t.TooComplex="too-complex",t.InvalidGeometry="invalid-geometry",t.InvalidElevationInfo="invalid-elevation-info",t.ElevationQueryError="elevation-query-error"})(tc||(tc={}));let jw=class extends Error{constructor(e){super("profile could not be generated"),this.cause=e,this.type=M0e}};function Tet(t){return t.type===M0e}async function Cet(t,e,i,r,n,s,o){let a,l,c;const u=t.spatialReference,h=u.isGeographic||u.isWebMercator;let f=0;if(!h){const{planarLength:g}=await W(()=>import("./geometryEngineAsync-24313d0a.js"),[],import.meta.url);_t(o),f=await g(t,"meters"),_t(o)}const m=1/ti(r);if(h||f>=n.geodesicDistanceThreshold){await cg([{source:u,dest:r},{source:u,dest:Ee.WGS84}],o);const g=Det(t);a=xet([g],"meters")[0];const y=XQ(a,n);if(tee(t,a,y)>s)throw new jw(tc.TooComplex);const v=QQ(g,e,i);({densifiedPath:l,distances:c}=Aet(v,y,m)),l=Ir(l,r)}else{await cg([{source:u,dest:r}],o),a=f;const g=XQ(a,n);if(tee(t,a,g)>s)throw new jw(tc.TooComplex);const y=QQ(t,e,i);({densifiedPath:l,distances:c}=$et(y,g,m)),_t(o),l=Ir(l,r)}return{densifiedPath:l,pathLength:a*m,distances:c}}function XQ(t,e){const i=t/e.densificationMaxSamples;return Math.max(e.samplingDistance,i)}function QQ(t,e,i){if(e==null)return eee(t);const r=t.spatialReference,n=e.mode,s=e.offset??0;let o=null;switch(i.type){case"2d":o=Eet(t,n,s);break;case"3d":o=Met(t,n,s,i)}return o==null?eee(t):new no({hasZ:!0,hasM:!1,spatialReference:r,paths:$0e(t.paths,o)})}function Eet({hasZ:t},e,i){return e==="absolute-height"?t?([r,n,s])=>[r,n,s+i]:([r,n])=>[r,n,i]:null}function Met({spatialReference:t,hasZ:e},i,r,{elevationProvider:n}){const s=(o,a,l,c)=>(n==null?void 0:n.getElevation(o,a,l,t,c))??0;switch(i){case"on-the-ground":return([o,a])=>[o,a,s(o,a,0,"ground")];case"absolute-height":return e?([o,a,l])=>[o,a,l+r]:([o,a])=>[o,a,r];case"relative-to-ground":return e?([o,a,l])=>[o,a,l+s(o,a,l,"ground")+r]:([o,a])=>[o,a,s(o,a,0,"ground")+r];case"relative-to-scene":return e?([o,a,l])=>[o,a,l+s(o,a,l,"scene")+r]:([o,a])=>[o,a,s(o,a,0,"scene")+r];default:return null}}function eee(t){return t.hasZ?new no({hasZ:!1,hasM:!1,spatialReference:t.spatialReference,paths:$0e(t.paths,([e,i])=>[e,i])}):t}function $0e(t,e){const i=t.length,r=new Array(i);for(let n=0;n<i;++n){const s=t[n],o=s.length,a=new Array(s.length);r[n]=a;for(let l=0;l<o;++l)a[l]=e(s[l])}return r}function p7(t){return qC(t)&&t.paths.length>0&&t.paths.every(e=>e.length>=2)}function qC(t){return t!=null&&t.type==="polyline"}function A0e(t,e,i,r,n){const{spatialReference:s,hasZ:o}=t,a={from:null,to:null,distance:0,azimuth:0,reverseAzimuth:0,spatialReference:s,metersPerSR:ti(s)},l=[],c=[];let u=0;for(let h=0;h<t.paths.length;++h){const f=t.paths[h],m=new Array,g=new Array;let y=0;for(let v=1;v<f.length;++v){const b=f[v-1],w=f[v],x=r(a,b,w);let S;for(S=y;S<x.distance;S+=e)m.push(n(x,S)),g.push((u+S)*i);y=S-x.distance,u+=x.distance,m.push(w),g.push(u*i)}l[h]=m,c[h]=g}return{densifiedPath:new no({spatialReference:s,hasZ:o,paths:l}),distances:c}}function $et(t,e,i){const{hasZ:r}=t;return A0e(t,e,i,Pet,r?Fet:Ret)}function Aet(t,e,i){const{hasZ:r}=t;return A0e(t,e,i,ket,r?Let:Oet)}function ket(t,e,i){return t.distance=0,h7(t,e,i,t.spatialReference),t.from=e,t.to=i,t}function Pet(t,e,i){return t.from=e,t.to=i,t.distance=Ig(i,e)*t.metersPerSR,t}function Oet({from:t,azimuth:e,spatialReference:i},r){return zw([0,0],t,e,r,i)}function Let({from:t,to:e,azimuth:i,distance:r,spatialReference:n},s){const o=s/r,a=[0,0,kB(t[2],e[2],o)];return zw(a,t,i,s,n),a}function Ret({from:t,to:e,distance:i},r){return BU([0,0],t,e,r/i)}function Fet({from:t,to:e,distance:i},r){return XO([0,0,0],t,e,r/i)}function Det(t){return SR(t.spatialReference)?t:Ir(t,Ee.WGS84)}function k0e(t){return t.paths.reduce((e,i)=>e+i.length,0)}function tee(t,e,i){return k0e(t)+Math.floor(e/i)+Math.max(0,t.paths.reduce(r=>1+r,0)-1)}function Net(t,e){const i=t.length;if(i===0)return null;const r=t[0],n=r.sampledZ;let s=n,o=n,a=0,l=0,c=null,u=null,h=n??0,f=0,m=0,g=n!=null?1:0,y=0,v=0;const b=ti(e),w=Iu(e),x=co().minSlopeSampleDistance/b,S=2*x,I=new iee,T=new iee,C=()=>{$(),I.copy(T),T.reset()},E=(P,k)=>{C(),P>0&&P-I.start<=S&&(P=I.start+x),T.restart(P,k)},$=()=>{if(I.isHole||T.isHole)return;const P=T.avgElevation-I.avgElevation,k=T.start-I.start,L=P*w,F=k*b,V=bt(Math.atan2(L,F),"radians","degrees");V>0?(f+=V,c=Kh(c,V),y++):V<0&&(m-=V,u=Kh(u,-V),v++)};r.sampledZ!=null&&E(r.distance,r.sampledZ);for(let P=1;P<i;++P){const k=t[P-1],L=t[P],F=L.sampledZ;if(F==null){T.isHole||C();continue}g++,h+=F,s=f7(s,F),o=Kh(o,F),T.isHole||L.distance-T.start>=x?E(L.distance,F):T.insert(F);const V=k.sampledZ;if(V!=null){const z=F-V;z>0?a+=z:z<0&&(l-=z)}}return C(),g===0?null:{maxDistance:t[i-1].distance,minElevation:s,maxElevation:o,avgElevation:g===0?null:h/g,elevationGain:a,elevationLoss:l,maxPositiveSlope:c,maxNegativeSlope:u,avgPositiveSlope:y===0?null:f/y,avgNegativeSlope:v===0?null:m/v}}function Vet(t){const e=t.filter(Dt),i=e.length;if(i===0)return null;const r=e[0];if(i===1)return r;let n=r.maxDistance,s=r.minElevation,o=r.maxElevation,a=r.maxPositiveSlope,l=r.maxNegativeSlope;for(let c=1;c<e.length;++c){const u=e[c];n=Kh(n,u.maxDistance),s=f7(s,u.minElevation),o=Kh(o,u.maxElevation),a=Kh(a,u.maxPositiveSlope),l=Kh(l,u.maxNegativeSlope)}return{maxDistance:n,minElevation:s,maxElevation:o,avgElevation:null,elevationGain:null,elevationLoss:null,maxPositiveSlope:a,maxNegativeSlope:l,avgPositiveSlope:null,avgNegativeSlope:null}}function zet(t){let e=null,i=null,r=null;for(const n of t){if(n==null)continue;const{statistics:s,spatialReference:o}=n;if(s==null)continue;const a=ti(o);e=Kh(e,MF(s.maxDistance,a));const l=Iu(o);r=f7(r,MF(s.minElevation,l)),i=Kh(i,MF(s.maxElevation,l))}return{minDistance:0,maxDistance:e??0,minElevation:r??0,maxElevation:i??0}}function f7(t,e){return e==null?t:t!=null?Math.min(t,e):e}function Kh(t,e){return e==null?t:t!=null?Math.max(t,e):e}function MF(t,e){return t!=null&&e!=null?t*e:null}let iee=class{constructor(){this._start=0,this._totalElevation=0,this._sampleCount=0}get avgElevation(){return this._totalElevation/this._sampleCount}get isHole(){return this._sampleCount===0}get start(){return this._start}copy(e){this._start=e._start,this._sampleCount=e._sampleCount,this._totalElevation=e._totalElevation}reset(){this._start=0,this._sampleCount=0,this._totalElevation=0}restart(e,i){this._start=e,this._sampleCount=1,this._totalElevation=i}insert(e){++this._sampleCount,this._totalElevation+=e}};function jet(t,e,i=[]){if(t>=e||(i.push(t),e-t<2))return i;const r=e-1;i.push(r);const n=w8(t+1,r);for(;;){const s=n.next();if(s.done)break;i.push(s.value)}return i}function*w8(t,e){if(t>=e)return;const i=t+Math.floor((e-t)/2);yield i;const r=w8(t,i),n=w8(i+1,e);for(;;){const s=r.next(),o=n.next();if(s.done&&o.done)break;s.done||(yield s.value),o.done||(yield o.value)}}async function*Bet(t,e){const{view:i,geometry:r,elevationInfo:n,providers:s,options:o}=t,a=i.spatialReference;if(!a||r==null||!p7(r))throw new jw(tc.InvalidGeometry);const l=s.length;if(l===0)return null;const c=Math.round(o.maxTotalSamples/l);if(k0e(r)>c)throw new jw(tc.TooComplex);const u=await Cet(r,n,i,a,o,c,e);let h=0;const f=new Array(l),m=new Array(l);for(let v=0;v<l;v++){const b=Jet(u);f[v]=b,h+=b.samples.length;const w={...t,provider:s[v],result:b,densificationResult:u};m[v]=Uet(w,e)[Symbol.iterator]()}if(h>o.maxTotalSamples)throw new jw(tc.TooComplex);const g=await Promise.all(m.map(v=>{const b=v.next();return b.done===!0?Promise.resolve(null):b.value}));_t(e);for(let v=0;v<l;v++)f[v]=g[v];yield f,await XT(t.delayAfterPreview??co().delayAfterPreviewMillis,null,e.signal);const y=[];try{let v;do{v=!1;for(let b=0;b<l;b++){const w=m[b].next();w.done===!1&&(y.push({resultPromise:w.value,index:b}),v=!0)}}while(v)}finally{m.forEach(v=>{var b;return(b=v.return)==null?void 0:b.call(v)})}for(const{resultPromise:v,index:b}of y)f[b]=await v,_t(e),yield f;_1e(f,v=>{v.progress=1}),yield f}function*Uet(t,e){const{densificationResult:i}=t,r={...t,abortOptions:e,densificationResult:i},n=jet(0,r.result.samples.length),s=n.slice(0,r.provider.numSamplesForPreview);yield ree(r,s,!0);const o=Qwe(n,r.provider.numSamplesPerChunk);for(const a of o)yield ree(r,a,!1)}async function ree({densificationResult:t,result:e,provider:i,queue:r,abortOptions:n,cache:s},o,a){const{densifiedPath:l,pathLength:c}=t,u=e.spatialReference,{samples:h}=e,f=[];for(let m=0;m<o.length;m++){const g=h[o[m]];f[m]=g.coordinate}try{return await r.push({geometry:new Zm({spatialReference:u,points:f,hasZ:l.hasZ}),provider:i,indices:o,preview:a,result:e,queryOptions:{...co().defaultQueryOptions(),minDemResolution:Math.round(a?c/i.numSamplesForPreview:c/h.length),cache:s}},n),{...e}}catch(m){return ys(m)?null:_et}}function Get(t){return new WU({priority:mt.ELEVATION_PROFILE,concurrency:1,scheduler:t,process:async e=>{_t(e.queryOptions);try{await Het(e)}catch(i){Ek(i)}}})}async function Het({geometry:t,provider:e,indices:i,preview:r,result:n,queryOptions:s}){if(i.length===0)return;const o=(await Ket(e,t,s)).geometry,{hasZ:a,points:l}=o,c=s.noDataValue,{samples:u}=n;for(let h=0;h<i.length;h++){const f=u[i[h]];if(f.isHole)continue;const m=a?l[h][2]:null;m===null||m===c?f.sampledZ=null:(n.hasZ=!0,f.sampledZ=m),f.sampled=!0}qet(u),n.progress=r?0:n.progress+i.length/u.length,n.statistics=Net(n.samples,n.spatialReference)}function qet(t){const e=t.length-1;let i=0;for(let r=1;r<=e;r++)(t[r].sampled||r===e)&&(Wet(t,i,r),i=r)}function Wet(t,e,i){if(i-e==1)return;const r=t[e],n=r.sampledZ,s=t[i],o=s.sampledZ;if(n==null||o==null){for(let c=e+1;c<i;c++)t[c].sampledZ=null;return}const a=r.distance,l=s.distance-a;for(let c=e+1;c<i;c++){const u=t[c],h=(u.distance-a)/l;u.sampledZ=kB(n,o,h)}}function Jet({densifiedPath:t,distances:e}){const i=t.spatialReference,r=Do(i),n=t.paths,s=n.length,o=[];let a=null,l=0;for(let c=0;c<s;c++){const u=n[c],h=u.length,f=e[c];for(let m=0;m<h;m++){const g=u[m],y=f[m];r&&(g[0]=ioe(g[0],r.valid[0],r.valid[1])),a&&m===0&&Zet(o,a,g,l,y),o.push(Yet(g,y)),a=g,l=y}}return{progress:0,samples:o,hasZ:!1,statistics:null,spatialReference:i}}function Zet(t,e,i,r,n){t.push(nee(e,r)),t.push(nee(i,n))}function Yet(t,e){return{coordinate:t,distance:e,sampledZ:null,sampled:!1,isHole:!1}}function nee(t,e){return{coordinate:t,distance:e,sampledZ:null,sampled:!0,isHole:!0}}async function Ket(t,e,i){try{return await t.queryElevation(e,i)}catch{throw new jw(tc.ElevationQueryError)}}const see="line-change";let Zf=class extends he{constructor(e){super(e),this._handles=new gs,this._updateTask=null,this._paramsPerProfile=new Map,this._getUpdateParametersMemoized=ec((i,r,n)=>({stationary:i,visibleProfiles:r,generationParameters:n})),this._getGenerationParametersMemoized=ec((i,r,n,s,o,a,l)=>qC(r)&&p7(r)&&s!=null?{view:i,geometry:r,elevationInfo:n,options:a,queue:s,cache:o,slicePlane:l}:null),this._getElevationInfoMemoized=ec((i,r)=>({mode:i,offset:r})),this._getOptionsMemoized=ec((i,r,n)=>{const{densificationMaxSamples:s,maxTotalSamples:o}=co();return{geodesicDistanceThreshold:i,samplingDistance:r,densificationMaxSamples:Math.round(s/n),maxTotalSamples:o}}),this._updateThrottled=u0e(i=>$d(this._update(i)),co().updateThrottleMillis)}initialize(){const e=this.viewModel;this._handles.add([J(()=>e.profiles.toArray(),i=>{this._abortUpdate(),this._paramsPerProfile.clear(),this._handles.remove(see),this._handles.add(i.map(r=>kn([r.attach(this.viewModel),r.on("change",()=>{this._invalidateProfile(r)})])),see)},ji),this._updateThrottled,J(()=>this._updateParameters,this._updateThrottled,ji)])}destroy(){this._handles.destroy(),this._paramsPerProfile.clear()}get _updateParameters(){const{viewModel:e}=this,i=e.view;return this._getUpdateParametersMemoized(i==null||i.stationary,this.viewModel.visibleProfiles,this._generationParameters)}get _generationParameters(){const{view:e,input:i,queue:r,tileCache:n}=this.viewModel;return e!=null&&e.ready?this._getGenerationParametersMemoized(e,lt(i,s=>s.geometry),this._elevationInfo,r,n,this._options,e.type==="3d"?e.slicePlane:null):null}get _elevationInfo(){const e=lt(this.viewModel.input,i=>wR(i)?null:p0e(i));return e!=null?this._getElevationInfoMemoized(e.mode,e.offset):null}get _options(){const e=this.viewModel,i=e.visibleProfiles.length;let r=e.minDemResolution??co().defaultDemResolution;return r=parseFloat(r.toFixed(2)),this._getOptionsMemoized(e.geodesicDistanceThreshold,r,i)}async _update({stationary:e,visibleProfiles:i,generationParameters:r}){this._abortUpdate(),e&&(r!=null?this._updateTask=Cp(async n=>{this.viewModel.error=null;const s=i.filter(a=>!this._isProfileValid(a,r)),o=Bet({...r,providers:s},{signal:n});try{for await(const a of o){_t(n),this._clearInvalidResults(r);for(let l=0;l<s.length;l++)s[l].result=a[l]}for(const a of s)this._paramsPerProfile.set(a,r)}catch(a){Lo(a),this._abortUpdate(),this.viewModel.error=a,s.forEach(l=>{l.result=null})}}):this._clearResults())}_abortUpdate(){this._updateTask=Qr(this._updateTask)}_isProfileValid(e,i){return this._paramsPerProfile.has(e)&&this._paramsPerProfile.get(e)===i}_invalidateProfile(e){this._paramsPerProfile.delete(e),this._updateThrottled(this._updateParameters)}_clearInvalidResults(e){for(const i of this.viewModel.profiles.items)this._isProfileValid(i,e)||(i.result=null,this._paramsPerProfile.delete(i))}_clearResults(){for(const e of this.viewModel.profiles.items)e.result=null,this._paramsPerProfile.delete(e)}};d([p({nonNullable:!0})],Zf.prototype,"viewModel",void 0),d([p()],Zf.prototype,"_updateParameters",null),d([p()],Zf.prototype,"_generationParameters",null),d([p()],Zf.prototype,"_elevationInfo",null),d([p()],Zf.prototype,"_options",null),Zf=d([A("esri.widgets.ElevationProfile.ElevationProfileController")],Zf);function Xet(t,e){if(t==null||e==null)return null;const{samples:i,spatialReference:r}=t,{distance:n,elevation:s}=e,o=ti(r),a=Iu(r),l=i.length,c=new Array(l);for(let u=0;u<l;++u){const h=i[u],f=h.sampledZ,m=h.coordinate;c[u]={x:m[0],y:m[1],z:f,distance:P0e(h.distance,o,n),elevation:Ub(f,a,s)}}return c}function Qet(t,e){if(t==null||e==null||t.statistics==null||t.spatialReference==null)return null;const{distance:i,elevation:r}=e,{statistics:n,spatialReference:s}=t,o=ti(s),a=Iu(s);return{maxDistance:P0e(n.maxDistance,o,i),minElevation:Ub(n.minElevation,a,r),maxElevation:Ub(n.maxElevation,a,r),avgElevation:Ub(n.avgElevation,a,r),elevationGain:Ub(n.elevationGain,a,r),elevationLoss:Ub(n.elevationLoss,a,r),maxPositiveSlope:n.maxPositiveSlope,maxNegativeSlope:n.maxNegativeSlope,avgPositiveSlope:n.avgPositiveSlope,avgNegativeSlope:n.avgNegativeSlope}}function P0e(t,e,i){return t==null?null:bt(t*e,"meters",i)}function Ub(t,e,i){return t==null?null:bt(t*e,"meters",i)}let Er=class extends an.EventedAccessor{constructor(e){super(e),this.type=null,this.id=QU(),this.title=null,this.color=new ce("#000000"),this.visible=!0,this._getSamplesMemoized=ec((i,r)=>Xet(i,r)),this._getStatisticsMemoized=ec((i,r)=>Qet(i,r)),this.viewVisualizationEnabled=!0,this.result=null,this.effectiveUnits=null,this.numSamplesForPreview=30,this.numSamplesPerChunk=200,this.chartFillEnabled=!0,this.chartStrokeWidth=1.5,this.chartStrokeOffsetY=0,this._viewModel=null}get progress(){return this.result!=null&&this.visible?this.result.progress:0}get samples(){return this._getSamplesMemoized(this.result,this.effectiveUnits)}get statistics(){return this._getStatisticsMemoized(this.result,this.effectiveUnits)}get hoveredPoint(){var e;return lt((e=this._viewModel)==null?void 0:e.hoveredChartPosition,i=>this._getPoint(i))}get available(){return!0}get hasZ(){const e=this.result;return e!=null&&e.hasZ}get minDemResolution(){return co().defaultDemResolution}queryElevation(){throw new Error("not implemented")}attach(e){return this._viewModel=e,kn([J(()=>e.effectiveUnits,i=>{this.effectiveUnits=i},ji),J(()=>[e.input],()=>this._onChange(),Ca)])}toggleVisibility(e){this.visible=e===void 0?!this.visible:e}_onChange(){this.emit("change")}_getPoint(e){const{samples:i,result:r}=this;if(i==null||r==null)return null;const n=i.length;if(n===0)return null;const s=i[n-1].distance,o=Ire(i,e*s,u=>u.distance);if(o==null)return null;const{x:a,y:l,z:c}=o;return c==null?null:new fe({x:a,y:l,z:c,spatialReference:r.spatialReference})}};d([p({nonNullable:!0})],Er.prototype,"id",void 0),d([p({nonNullable:!0})],Er.prototype,"title",void 0),d([p({type:ce,nonNullable:!0})],Er.prototype,"color",void 0),d([p({nonNullable:!0})],Er.prototype,"visible",void 0),d([p({readOnly:!0})],Er.prototype,"progress",null),d([p({readOnly:!0})],Er.prototype,"samples",null),d([p({readOnly:!0})],Er.prototype,"statistics",null),d([p()],Er.prototype,"hoveredPoint",null),d([p()],Er.prototype,"viewVisualizationEnabled",void 0),d([p()],Er.prototype,"available",null),d([p()],Er.prototype,"result",void 0),d([p()],Er.prototype,"effectiveUnits",void 0),d([p()],Er.prototype,"numSamplesForPreview",void 0),d([p()],Er.prototype,"numSamplesPerChunk",void 0),d([p()],Er.prototype,"chartFillEnabled",void 0),d([p()],Er.prototype,"chartStrokeWidth",void 0),d([p()],Er.prototype,"chartStrokeOffsetY",void 0),d([p({readOnly:!0})],Er.prototype,"hasZ",null),d([p({readOnly:!0})],Er.prototype,"minDemResolution",null),d([p()],Er.prototype,"_viewModel",void 0),Er=d([A("esri.widgets.ElevationProfile.ElevationProfileLine")],Er);const WC=Er;function O0e(t){if(t==null)return null;if(t instanceof JI)return L0e(t);const e=t.tileInfo;if(e==null)return null;const i=Zwe(e.lods);return i==null?null:i.resolution*ti(e.spatialReference)}function L0e(t){if(t==null)return null;const e=t.layers.items.map(ett).filter(Dt);return Sre(e)??null}function ett(t){return t&&"tileInfo"in t?O0e(t):null}let ad=class extends WC{constructor(e){super(e),this.type="ground",this.color=new ce("#ff7f00"),this.viewVisualizationEnabled=!0,this.numSamplesForPreview=50,this.numSamplesPerChunk=1e3,this._getQueryElevationDependencies=ec((i,r)=>({ground:i,groundLayers:r}))}get available(){const e=this._ground;return e!=null&&e.layers.some(i=>i.visible)}get minDemResolution(){return L0e(this._ground)}get _queryElevationDependencies(){return this._getQueryElevationDependencies(this._ground,this._groundLayers)}get _ground(){var e;return lt((e=this._viewModel)==null?void 0:e.view,i=>{var r;return(r=i.map)==null?void 0:r.ground})}get _groundLayers(){const e=this._ground;return lt(e,i=>{var r;return(r=i.layers)==null?void 0:r.toArray()})??[]}async queryElevation(e,i){const r=this._queryElevationDependencies;if(r==null)throw new Error("ElevationProfileLineGround: no dependencies");const{ground:n}=r;if(n==null)throw new Error("No ground configured in the view");const s=await n.queryElevation(e,i),o=Iu(e.spatialReference),a=Iu(n.layers.at(0).spatialReference);if(o!==a){const l=s.geometry;l.points=l.points.map(([c,u,h])=>[c,u,h===i.noDataValue?h:h*a/o])}return s}attach(e){return kn([super.attach(e),J(()=>this._queryElevationDependencies,()=>this._onChange())])}};d([p({type:ce,nonNullable:!0})],ad.prototype,"color",void 0),d([p()],ad.prototype,"viewVisualizationEnabled",void 0),d([p()],ad.prototype,"available",null),d([p({readOnly:!0})],ad.prototype,"minDemResolution",null),d([p()],ad.prototype,"_queryElevationDependencies",null),d([p()],ad.prototype,"_ground",null),d([p()],ad.prototype,"_groundLayers",null),ad=d([A("esri.widgets.ElevationProfile.ElevationProfileLineGround")],ad);const R0e=ad,m7=ie.getLogger("esri.layers.support.ElevationSampler");let F0e=class{queryElevation(e){return itt(e.clone(),this)}on(){return ott}projectIfRequired(e,i){return D0e(e,i)}},ttt=class extends F0e{get spatialReference(){return this.extent.spatialReference}constructor(e,i,r){super(),this.tile=e,this.noDataValue=r;const n=e.tile.extent;this.extent=soe(n,i.spatialReference),this.extent.zmin=e.zmin,this.extent.zmax=e.zmax,this._aaExtent=n;const s=ti(i.spatialReference),o=i.lodAt(e.tile.level).resolution*s;this.demResolution={min:o,max:o}}contains(e){const i=this.projectIfRequired(e,this.spatialReference);return i!=null&&this.containsAt(i.x,i.y)}containsAt(e,i){return FB(this._aaExtent,e,i)}elevationAt(e,i){if(!this.containsAt(e,i)){const r=this.extent,n=`${r.xmin}, ${r.ymin}, ${r.xmax}, ${r.ymax}`;return m7.warn("#elevationAt()",`Point used to sample elevation (${e}, ${i}) is outside of the sampler extent (${n})`),this.noDataValue}return this.tile.sample(e,i)??this.noDataValue}},oee=class extends F0e{get spatialReference(){return this.extent.spatialReference}constructor(e,i,r){let n;super(),typeof i=="number"?(this.noDataValue=i,n=null):(n=i,this.noDataValue=r),this.samplers=n?e.map(o=>new ttt(o,n,this.noDataValue)):e;const s=this.samplers[0];if(s){this.extent=s.extent.clone();const{min:o,max:a}=s.demResolution;this.demResolution={min:o,max:a};for(let l=1;l<this.samplers.length;l++){const c=this.samplers[l];this.extent.union(c.extent),this.demResolution.min=Math.min(this.demResolution.min,c.demResolution.min),this.demResolution.max=Math.max(this.demResolution.max,c.demResolution.max)}}else this.extent=soe(al(),n.spatialReference),this.demResolution={min:0,max:0}}elevationAt(e,i){for(const r of this.samplers)if(r.containsAt(e,i))return r.elevationAt(e,i);return m7.warn("#elevationAt()",`Point used to sample elevation (${e}, ${i}) is outside of the sampler`),this.noDataValue}};function itt(t,e){const i=D0e(t,e.spatialReference);if(!i)return null;switch(t.type){case"point":rtt(t,i,e);break;case"polyline":ntt(t,i,e);break;case"multipoint":stt(t,i,e)}return t}function D0e(t,e){if(t==null)return null;const i=t.spatialReference;if(i.equals(e))return t;const r=rC(t,e);return r||m7.error(`Cannot project geometry spatial reference (wkid:${i.wkid}) to elevation sampler spatial reference (wkid:${e.wkid})`),r}function rtt(t,e,i){t.z=i.elevationAt(e.x,e.y)}function ntt(t,e,i){Id.spatialReference=e.spatialReference;const r=t.hasM&&!t.hasZ;for(let n=0;n<t.paths.length;n++){const s=t.paths[n],o=e.paths[n];for(let a=0;a<s.length;a++){const l=s[a],c=o[a];Id.x=c[0],Id.y=c[1],r&&(l[3]=l[2]),l[2]=i.elevationAt(Id.x,Id.y)}}t.hasZ=!0}function stt(t,e,i){Id.spatialReference=e.spatialReference;const r=t.hasM&&!t.hasZ;for(let n=0;n<t.points.length;n++){const s=t.points[n],o=e.points[n];Id.x=o[0],Id.y=o[1],r&&(s[3]=s[2]),s[2]=i.elevationAt(Id.x,Id.y)}t.hasZ=!0}const Id=new fe,ott={remove(){}};let att=class{constructor(e,i){this.data=e,this.safeWidth=.99999999*(e.width-1),this.dx=(e.width-1)/(i[2]-i[0]),this.dy=(e.width-1)/(i[3]-i[1]),this.x0=i[0],this.y1=i[3]}},aee=class{constructor(e,i=null){if(this.tile=e,i!=null&&e!=null){const r=e.extent;this._samplerData=new att(i,r)}}get zmin(){return this._samplerData!=null?this._samplerData.data.minValue:0}get zmax(){return this._samplerData!=null?this._samplerData.data.maxValue:0}sample(e,i){if(this._samplerData==null)return;const{safeWidth:r,data:n,dx:s,dy:o,y1:a,x0:l}=this._samplerData,{width:c,values:u,noDataValue:h}=n,f=lee(o*(a-i),0,r),m=lee(s*(e-l),0,r),g=Math.floor(f),y=Math.floor(m),v=g*c+y,b=v+c,w=u[v],x=u[b],S=u[v+1],I=u[b+1];if(w!==h&&x!==h&&S!==h&&I!==h){const T=m-y,C=w+(S-w)*T;return C+(x+(I-x)*T-C)*(f-g)}}};function lee(t,e,i){return t<e?e:t>i?i:t}let ltt=class{async queryAll(e,i,r){if(!(e=r&&r.ignoreInvisibleLayers?e.filter(c=>c.visible):e.slice()).length)throw new N("elevation-query:invalid-layer","Elevation queries require at least one elevation layer to fetch tiles from");const n=Y0.fromGeometry(i);let s=!1;r&&r.returnSampleInfo||(s=!0);const o={...NM,...r,returnSampleInfo:!0},a=await this.query(e[e.length-1],n,o),l=await this._queryAllContinue(e,a,o);return l.geometry=l.geometry.export(),s&&delete l.sampleInfo,l}async query(e,i,r){if(!e)throw new N("elevation-query:invalid-layer","Elevation queries require an elevation layer to fetch tiles from");if(!i||!(i instanceof Y0)&&i.type!=="point"&&i.type!=="multipoint"&&i.type!=="polyline")throw new N("elevation-query:invalid-geometry","Only point, polyline and multipoint geometries can be used to query elevation");const n={...NM,...r},s=new ctt(e,i.spatialReference,n),o=n.signal;return await e.load({signal:o}),await this._createGeometryDescriptor(s,i,o),await this._selectTiles(s,o),await this._populateElevationTiles(s,o),this._sampleGeometryWithElevation(s),this._createQueryResult(s,o)}async createSampler(e,i,r){if(!e)throw new N("elevation-query:invalid-layer","Elevation queries require an elevation layer to fetch tiles from");if(!i||i.type!=="extent")throw new N("elevation-query:invalid-extent","Invalid or undefined extent");const n={...NM,...r};return this._createSampler(e,i,n)}async createSamplerAll(e,i,r){if(!(e=r&&r.ignoreInvisibleLayers?e.filter(o=>o.visible):e.slice()).length)throw new N("elevation-query:invalid-layer","Elevation queries require at least one elevation layer to fetch tiles from");if(!i||i.type!=="extent")throw new N("elevation-query:invalid-extent","Invalid or undefined extent");const n={...NM,...r,returnSampleInfo:!0},s=await this._createSampler(e[e.length-1],i,n);return this._createSamplerAllContinue(e,i,s,n)}async _createSampler(e,i,r,n){const s=r.signal;await e.load({signal:s});const o=i.spatialReference,a=e.tileInfo.spatialReference;o.equals(a)||(await cg([{source:o,dest:a}],{signal:s}),i=Ir(i,a));const l=new utt(e,i,r,n);return await this._selectTiles(l,s),await this._populateElevationTiles(l,s),new oee(l.elevationTiles,l.layer.tileInfo,l.options.noDataValue)}async _createSamplerAllContinue(e,i,r,n){if(e.pop(),!e.length)return r;const s=r.samplers.map(c=>ACe(c.extent)),o=await this._createSampler(e[e.length-1],i,n,s);if(o.samplers.length===0)return r;const a=r.samplers.concat(o.samplers),l=new oee(a,n.noDataValue);return this._createSamplerAllContinue(e,i,l,n)}async _queryAllContinue(e,i,r){const n=e.pop(),s=i.geometry.coordinates,o=i.sampleInfo;lo(o);const a=[],l=[];for(let f=0;f<s.length;f++){const m=o[f];m.demResolution>=0?m.source||(m.source=n):e.length&&(a.push(s[f]),l.push(f))}if(!e.length||a.length===0)return i;const c=i.geometry.clone(a),u=await this.query(e[e.length-1],c,r),h=u.sampleInfo;if(!h)throw new Error("no sampleInfo");return l.forEach((f,m)=>{s[f].z=u.geometry.coordinates[m].z,o[f].demResolution=h[m].demResolution}),this._queryAllContinue(e,i,r)}async _createQueryResult(e,i){const r=await e.geometry.project(e.outSpatialReference,i);lo(r);const n={geometry:r.export(),noDataValue:e.options.noDataValue};return e.options.returnSampleInfo&&(n.sampleInfo=this._extractSampleInfo(e)),e.geometry.coordinates.forEach(s=>{s.tile=null,s.elevationTile=null}),n}async _createGeometryDescriptor(e,i,r){let n;const s=e.layer.tileInfo.spatialReference;if(i instanceof Y0?n=await i.project(s,r):(await cg([{source:i.spatialReference,dest:s}],{signal:r}),n=Ir(i,s)),!n)throw new N("elevation-query:spatial-reference-mismatch",`Cannot query elevation in '${i.spatialReference.wkid}' on an elevation service in '${s.wkid}'`);e.geometry=Y0.fromGeometry(n)}async _selectTiles(e,i){e.type==="geometry"&&this._preselectOutsideLayerExtent(e);const r=e.options.demResolution;if(typeof r=="number")this._selectTilesClosestResolution(e,r);else if(r==="finest-contiguous")await this._selectTilesFinestContiguous(e,i);else{if(r!=="auto")throw new N("elevation-query:invalid-dem-resolution",`Invalid dem resolution value '${r}', expected a number, "finest-contiguous" or "auto"`);await this._selectTilesAuto(e,i)}}_preselectOutsideLayerExtent(e){if(e.layer.fullExtent==null)return;const i=new aee(null);i.sample=()=>e.options.noDataValue,e.outsideExtentTile=i;const r=e.layer.fullExtent;e.geometry.coordinates.forEach(n=>{const s=n.x,o=n.y;(s<r.xmin||s>r.xmax||o<r.ymin||o>r.ymax)&&(n.elevationTile=i)})}_selectTilesClosestResolution(e,i){const r=this._findNearestDemResolutionLODIndex(e,i);e.selectTilesAtLOD(r)}_findNearestDemResolutionLODIndex(e,i){const{tileInfo:r,tilemapCache:n}=e.layer,s=i/ti(r.spatialReference),o=RT(r,n);let a=o[0],l=0;for(let c=1;c<o.length;c++){const u=o[c];Math.abs(u.resolution-s)<Math.abs(a.resolution-s)&&(a=u,l=c)}return l}async _selectTilesFinestContiguous(e,i){const{tileInfo:r,tilemapCache:n}=e.layer,s=x8(r,n,e.options.minDemResolution);await this._selectTilesFinestContiguousAt(e,s,i)}async _selectTilesFinestContiguousAt(e,i,r){const n=e.layer;if(e.selectTilesAtLOD(i),i<0)return;const s=n.tilemapCache,o=e.getTilesToFetch();try{if(s&&!S8(s))await gu(Promise.all(o.map(a=>s.fetchAvailability(a.level,a.row,a.col,{signal:r}))),r);else if(await this._populateElevationTiles(e,r),!e.allElevationTilesFetched())throw e.clearElevationTiles(),new N("elevation-query:has-unavailable-tiles")}catch(a){Lo(a),await this._selectTilesFinestContiguousAt(e,i-1,r)}}async _populateElevationTiles(e,i){const r=e.getTilesToFetch(),n={},s=e.options.cache,o=e.options.noDataValue,a=r.map(async l=>{if(l.id==null)return;const c=`${e.layer.uid}:${l.id}:${o}`,u=s!=null?s.get(c):null,h=u??await e.layer.fetchTile(l.level,l.row,l.col,{noDataValue:o,signal:i});s!=null&&s.put(c,h),n[l.id]=new aee(l,h)});await gu(br(a),i),e.populateElevationTiles(n)}async _selectTilesAuto(e,i){this._selectTilesAutoFinest(e),this._reduceTilesForMaximumRequests(e);const r=e.layer.tilemapCache;if(!r||S8(r))return this._selectTilesAutoPrefetchUpsample(e,i);const n=e.getTilesToFetch(),s={},o=n.map(async a=>{const l=new yL(null,0,0,0,al()),c=await tC(r.fetchAvailabilityUpsample(a.level,a.row,a.col,l,{signal:i}));c.ok!==!1?a.id!=null&&(s[a.id]=l):Lo(c.error)});await gu(Promise.all(o),i),e.remapTiles(s)}_reduceTilesForMaximumRequests(e){const i=e.layer.tileInfo;let r=0;const n={},s=l=>{l.id!=null&&(l.id in n?n[l.id]++:(n[l.id]=1,r++))},o=l=>{if(l.id==null)return;const c=n[l.id];c===1?(delete n[l.id],r--):n[l.id]=c-1};e.forEachTileToFetch(s,o);let a=!0;for(;a&&(a=!1,e.forEachTileToFetch(l=>{r<=e.options.maximumAutoTileRequests||(o(l),i.upsampleTile(l)&&(a=!0),s(l))},o),a););}_selectTilesAutoFinest(e){const{tileInfo:i,tilemapCache:r}=e.layer,n=x8(i,r,e.options.minDemResolution);e.selectTilesAtLOD(n,e.options.maximumAutoTileRequests)}async _selectTilesAutoPrefetchUpsample(e,i){const r=e.layer.tileInfo;await this._populateElevationTiles(e,i);let n=!1;e.forEachTileToFetch((s,o)=>{r.upsampleTile(s)?n=!0:o()}),n&&await this._selectTilesAutoPrefetchUpsample(e,i)}_sampleGeometryWithElevation(e){e.geometry.coordinates.forEach(i=>{const r=i.elevationTile;let n=e.options.noDataValue;if(r){const s=r.sample(i.x,i.y);s!=null?n=s:i.elevationTile=null}i.z=n})}_extractSampleInfo(e){const i=e.layer.tileInfo,r=ti(i.spatialReference);return e.geometry.coordinates.map(n=>{let s=-1;return n.elevationTile&&n.elevationTile!==e.outsideExtentTile&&(s=i.lodAt(n.elevationTile.tile.level).resolution*r),{demResolution:s}})}},Y0=class qA{export(){return this._exporter(this.coordinates,this.spatialReference)}clone(e){const i=new qA;return i.geometry=this.geometry,i.spatialReference=this.spatialReference,i.coordinates=e||this.coordinates.map(r=>r.clone()),i._exporter=this._exporter,i}async project(e,i){if(this.spatialReference.equals(e))return this.clone();await cg([{source:this.spatialReference,dest:e}],{signal:i});const r=new Zm({spatialReference:this.spatialReference,points:this.coordinates.map(a=>[a.x,a.y])}),n=Ir(r,e);if(!n)return null;const s=this.coordinates.map((a,l)=>{const c=a.clone(),u=n.points[l];return c.x=u[0],c.y=u[1],c}),o=this.clone(s);return o.spatialReference=e,o}static fromGeometry(e){const i=new qA;if(i.geometry=e,i.spatialReference=e.spatialReference,e instanceof qA)i.coordinates=e.coordinates.map(r=>r.clone()),i._exporter=(r,n)=>{const s=e.clone(r);return s.spatialReference=n,s};else switch(e.type){case"point":{const r=e,{hasZ:n,hasM:s}=r;i.coordinates=n&&s?[new vl(r.x,r.y,r.z,r.m)]:n?[new vl(r.x,r.y,r.z)]:s?[new vl(r.x,r.y,null,r.m)]:[new vl(r.x,r.y)],i._exporter=(o,a)=>e.hasM?new fe(o[0].x,o[0].y,o[0].z,o[0].m,a):new fe(o[0].x,o[0].y,o[0].z,a);break}case"multipoint":{const r=e,{hasZ:n,hasM:s}=r;i.coordinates=n&&s?r.points.map(o=>new vl(o[0],o[1],o[2],o[3])):n?r.points.map(o=>new vl(o[0],o[1],o[2])):s?r.points.map(o=>new vl(o[0],o[1],null,o[2])):r.points.map(o=>new vl(o[0],o[1])),i._exporter=(o,a)=>e.hasM?new Zm({points:o.map(l=>[l.x,l.y,l.z,l.m]),hasZ:!0,hasM:!0,spatiaReference:a}):new Zm(o.map(l=>[l.x,l.y,l.z]),a);break}case"polyline":{const r=e,n=[],s=[],{hasZ:o,hasM:a}=e;let l=0;for(const c of r.paths)if(s.push([l,l+c.length]),l+=c.length,o&&a)for(const u of c)n.push(new vl(u[0],u[1],u[2],u[3]));else if(o)for(const u of c)n.push(new vl(u[0],u[1],u[2]));else if(a)for(const u of c)n.push(new vl(u[0],u[1],null,u[2]));else for(const u of c)n.push(new vl(u[0],u[1]));i.coordinates=n,i._exporter=(c,u)=>{const h=e.hasM?c.map(m=>[m.x,m.y,m.z,m.m]):c.map(m=>[m.x,m.y,m.z]),f=s.map(m=>h.slice(m[0],m[1]));return new no({paths:f,hasM:e.hasM,hasZ:!0,spatialReference:u})};break}}return i}},vl=class N0e{constructor(e,i,r=null,n=null,s=null,o=null){this.x=e,this.y=i,this.z=r,this.m=n,this.tile=s,this.elevationTile=o}clone(){return new N0e(this.x,this.y,this.z,this.m)}},V0e=class{constructor(e,i){this.layer=e,this.options=i}},ctt=class extends V0e{constructor(e,i,r){super(e,r),this.outSpatialReference=i,this.type="geometry"}selectTilesAtLOD(e){if(e<0)this.geometry.coordinates.forEach(i=>i.tile=null);else{const{tileInfo:i,tilemapCache:r}=this.layer,n=RT(i,r)[e].level;this.geometry.coordinates.forEach(s=>s.tile=i.tileAt(n,s.x,s.y))}}allElevationTilesFetched(){return!this.geometry.coordinates.some(e=>!e.elevationTile)}clearElevationTiles(){for(const e of this.geometry.coordinates)e.elevationTile!==this.outsideExtentTile&&(e.elevationTile=null)}populateElevationTiles(e){var i;for(const r of this.geometry.coordinates)!r.elevationTile&&((i=r.tile)!=null&&i.id)&&(r.elevationTile=e[r.tile.id])}remapTiles(e){var i;for(const r of this.geometry.coordinates){const n=(i=r.tile)==null?void 0:i.id;r.tile=n?e[n]:null}}getTilesToFetch(){var r;const e={},i=[];for(const n of this.geometry.coordinates){const s=n.tile;if(!s)continue;const o=(r=n.tile)==null?void 0:r.id;n.elevationTile||!o||e[o]||(e[o]=s,i.push(s))}return i}forEachTileToFetch(e){for(const i of this.geometry.coordinates)i.tile&&!i.elevationTile&&e(i.tile,()=>{i.tile=null})}},utt=class extends V0e{constructor(e,i,r,n){super(e,r),this.type="extent",this.elevationTiles=[],this._candidateTiles=[],this._fetchedCandidates=new Set,this.extent=i.intersection(e.fullExtent),this.maskExtents=n}selectTilesAtLOD(e,i){const r=this._maximumLodForRequests(i),n=Math.min(r,e);n<0?this._candidateTiles.length=0:this._selectCandidateTilesCoveringExtentAt(n)}_maximumLodForRequests(e){const{tileInfo:i,tilemapCache:r}=this.layer,n=RT(i,r);if(!e)return n.length-1;const s=this.extent;if(s==null)return-1;for(let o=n.length-1;o>=0;o--){const a=n[o],l=a.resolution*i.size[0],c=a.resolution*i.size[1];if(Math.ceil(s.width/l)*Math.ceil(s.height/c)<=e)return o}return-1}allElevationTilesFetched(){return this._candidateTiles.length===this.elevationTiles.length}clearElevationTiles(){this.elevationTiles.length=0,this._fetchedCandidates.clear()}populateElevationTiles(e){for(const i of this._candidateTiles){const r=i.id&&e[i.id];r&&(this._fetchedCandidates.add(i),this.elevationTiles.push(r))}}remapTiles(e){this._candidateTiles=this._uniqueNonOverlappingTiles(this._candidateTiles.map(i=>e[i.id]))}getTilesToFetch(){return this._candidateTiles}forEachTileToFetch(e,i){const r=this._candidateTiles;this._candidateTiles=[],r.forEach(n=>{if(this._fetchedCandidates.has(n))return void(i&&i(n));let s=!1;e(n,()=>s=!0),s?i&&i(n):this._candidateTiles.push(n)}),this._candidateTiles=this._uniqueNonOverlappingTiles(this._candidateTiles,i)}_uniqueNonOverlappingTiles(e,i){const r={},n=[];for(const o of e){const a=o.id;a&&!r[a]?(r[a]=o,n.push(o)):i&&i(o)}const s=n.sort((o,a)=>o.level-a.level);return s.filter((o,a)=>{for(let l=0;l<a;l++){const c=s[l].extent;if(c&&o.extent&&XD(c,o.extent))return i&&i(o),!1}return!0})}_selectCandidateTilesCoveringExtentAt(e){this._candidateTiles.length=0;const i=this.extent;if(i==null)return;const{tileInfo:r,tilemapCache:n}=this.layer,s=RT(r,n)[e],o=r.tileAt(s.level,i.xmin,i.ymin),a=o.extent;if(a==null)return;const l=s.resolution*r.size[0],c=s.resolution*r.size[1],u=Math.ceil((i.xmax-a[0])/l),h=Math.ceil((i.ymax-a[1])/c);for(let f=0;f<h;f++)for(let m=0;m<u;m++){const g=new yL(null,o.level,o.row-f,o.col+m);r.updateTileInfo(g),this._tileIsMasked(g)||this._candidateTiles.push(g)}}_tileIsMasked(e){return!!this.maskExtents&&this.maskExtents.some(i=>e.extent&&XD(i,e.extent))}};function x8(t,e,i=0){const r=RT(t,e);let n=r.length-1;if(i>0){const s=i/ti(t.spatialReference),o=r.findIndex(a=>a.resolution<s);o===0?n=0:o>0&&(n=o-1)}return n}const NM={maximumAutoTileRequests:20,noDataValue:0,returnSampleInfo:!1,demResolution:"auto",minDemResolution:0};function RT(t,e){const i=t.lods;if(S8(e)){const{effectiveMinLOD:r,effectiveMaxLOD:n}=e;return i.filter(s=>s.level>=r&&s.level<=n)}return i}function S8(t){return(t==null?void 0:t.tileInfo)!=null}const cee=Object.freeze(Object.defineProperty({__proto__:null,ElevationQuery:ltt,GeometryDescriptor:Y0,getFinestLodIndex:x8},Symbol.toStringTag,{value:"Module"}));let Mh=class extends WC{constructor(e){super(e),this.type="input",this.color=new ce("#00c8c8"),this.viewVisualizationEnabled=!1,this.numSamplesForPreview=50,this.numSamplesPerChunk=500,this.chartFillEnabled=!1,this.chartStrokeOffsetY=-1,this._getQueryElevationDependencies=ec((i,r,n,s,o)=>lt(i,a=>({elevationInfo:a,visibleLayers:r,view:n,stationary:s,spatialReference:o})))}get queryElevationDependencies(){var i;const e=(i=this._viewModel)==null?void 0:i.view;return e==null?null:this._getQueryElevationDependencies(this._elevationInfo,this._visibleLayers,e,e.stationary,e.spatialReference)}get available(){var e;return!((e=this._viewModel)!=null&&e.inputIsSketched)}get _elevationInfo(){var e;return lt((e=this._viewModel)==null?void 0:e.input,p0e)}get _visibleLayers(){var i;const e=(i=this._viewModel)==null?void 0:i.view;return lt(e,r=>{var n,s;return(s=(n=r.map)==null?void 0:n.allLayers)==null?void 0:s.filter(o=>o.visible).toArray()})??[]}async queryElevation(e,{noDataValue:i,signal:r}){const n=this.queryElevationDependencies;if(n==null)throw new Error("ElevationProfileLineInput: no dependencies");const{view:s,elevationInfo:o,spatialReference:a}=n;if(o.mode==="on-the-ground"&&s.type==="3d"&&a){const l=await Y0.fromGeometry(e).project(a,r);if(!l)return{geometry:e,noDataValue:i};const c=s.elevationProvider;return l.coordinates.forEach(u=>{u.z=c.getElevation(u.x,u.y,0,a,"ground")??0}),{geometry:l.export(),noDataValue:i}}return{geometry:e,noDataValue:i}}attach(e){const i=()=>this._onChange();return kn([super.attach(e),J(()=>this.queryElevationDependencies,i),ui(()=>e.elevationProvider,"elevation-change",i,{onListenerAdd:i,onListenerRemove:i})])}};d([p({type:ce,nonNullable:!0})],Mh.prototype,"color",void 0),d([p()],Mh.prototype,"viewVisualizationEnabled",void 0),d([p()],Mh.prototype,"queryElevationDependencies",null),d([p()],Mh.prototype,"available",null),d([p()],Mh.prototype,"_elevationInfo",null),d([p()],Mh.prototype,"_visibleLayers",null),Mh=d([A("esri.widgets.ElevationProfile.ElevationProfileLineInput")],Mh);const dtt=Mh;let Yf=class extends WC{constructor(e){super(e),this.type="query",this.color=new ce("#db334a"),this.viewVisualizationEnabled=!0,this.source=null,this.numSamplesForPreview=50,this.numSamplesPerChunk=500}get minDemResolution(){return O0e(this.source)}get available(){const e=this.source;return!!e&&(e.visible==null||e.visible)&&(e.layers==null||e.layers.some(i=>i.visible))}queryElevation(e,i){if(!this.source)throw new Error("No source configured for the elevation profile line");return this.source.queryElevation(e,i)}attach(e){return kn([super.attach(e),J(()=>this.source,()=>this._onChange(),Ca)])}};d([p({type:ce,nonNullable:!0})],Yf.prototype,"color",void 0),d([p()],Yf.prototype,"viewVisualizationEnabled",void 0),d([p()],Yf.prototype,"source",void 0),d([p({readOnly:!0})],Yf.prototype,"minDemResolution",null),d([p()],Yf.prototype,"available",null),Yf=d([A("esri.widgets.ElevationProfile.ElevationProfileLineQuery")],Yf);const htt=Yf;let JC=class{constructor(e){this._allocator=e,this._items=[],this._itemsPtr=0,this._grow()}get(){return this._itemsPtr===0&&Ww(()=>this._reset()),this._itemsPtr===this._items.length&&this._grow(),this._items[this._itemsPtr++]}_reset(){const e=Math.min(3*Math.max(8,this._itemsPtr),this._itemsPtr+3*uee);this._items.length=Math.min(e,this._items.length),this._itemsPtr=0}_grow(){for(let e=0;e<Math.max(8,Math.min(this._items.length,uee));e++)this._items.push(this._allocator())}};const uee=1024;function g7(){return[1,0,0,0,1,0,0,0,1]}function ptt(t){return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8]]}function ftt(t,e,i,r,n,s,o,a,l){return[t,e,i,r,n,s,o,a,l]}function z0e(t,e){return new Float64Array(t,e,9)}Object.freeze(Object.defineProperty({__proto__:null,clone:ptt,create:g7,createView:z0e,fromValues:ftt},Symbol.toStringTag,{value:"Module"}));function Xh(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function mtt(t){return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15]]}function gtt(t,e,i,r,n,s,o,a,l,c,u,h,f,m,g,y){return[t,e,i,r,n,s,o,a,l,c,u,h,f,m,g,y]}function j0e(t,e){return new Float64Array(t,e,16)}const y7=Xh();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:y7,clone:mtt,create:Xh,createView:j0e,fromValues:gtt},Symbol.toStringTag,{value:"Module"}));function ZC(){return[0,0,0,1]}function ytt(t){return[t[0],t[1],t[2],t[3]]}function vtt(t,e,i,r){return[t,e,i,r]}function B0e(t,e){return new Float64Array(t,e,4)}const _tt=ZC();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:_tt,clone:ytt,create:ZC,createView:B0e,fromValues:vtt},Symbol.toStringTag,{value:"Module"}));let sx=class l0{constructor(e,i,r){this._itemByteSize=e,this._itemCreate=i,this._buffers=new Array,this._items=new Array,this._itemsPtr=0,this._itemsPerBuffer=Math.ceil(r/this._itemByteSize)}get(){this._itemsPtr===0&&Ww(()=>this._reset());const e=Math.floor(this._itemsPtr/this._itemsPerBuffer);for(;this._buffers.length<=e;){const i=new ArrayBuffer(this._itemsPerBuffer*this._itemByteSize);for(let r=0;r<this._itemsPerBuffer;++r)this._items.push(this._itemCreate(i,r*this._itemByteSize));this._buffers.push(i)}return this._items[this._itemsPtr++]}_reset(){const e=2*(Math.floor(this._itemsPtr/this._itemsPerBuffer)+1);for(;this._buffers.length>e;)this._buffers.pop(),this._items.length=this._buffers.length*this._itemsPerBuffer;this._itemsPtr=0}static createVec2f64(e=N_){return new l0(16,uue,e)}static createVec3f64(e=N_){return new l0(24,wse,e)}static createVec4f64(e=N_){return new l0(32,uhe,e)}static createMat3f64(e=N_){return new l0(72,z0e,e)}static createMat4f64(e=N_){return new l0(128,j0e,e)}static createQuatf64(e=N_){return new l0(32,B0e,e)}get test(){return{size:this._buffers.length*this._itemsPerBuffer*this._itemByteSize}}};const N_=4*Dv.KILOBYTES,NSt=sx.createVec2f64(),it=sx.createVec3f64(),btt=sx.createVec4f64();sx.createMat3f64();const wtt=sx.createMat4f64(),VSt=sx.createQuatf64();function Zl(t){return t?dee(Ls(t.origin),Ls(t.direction)):dee(Me(),Me())}function dee(t,e){return{origin:t,direction:e}}function zSt(t,e){const i=Ttt.get();return i.origin=t,i.direction=e,i}function I8(t,e=Zl()){return xtt(t.origin,t.direction,e)}function U0e(t,e,i=Zl()){return bi(i.origin,t),Ui(i.direction,e,t),i}function xtt(t,e,i=Zl()){return bi(i.origin,t),bi(i.direction,e),i}function Stt(t,e){const i=No(it.get(),Rs(it.get(),t.direction),Ui(it.get(),e,t.origin));return Mt(i,i)}function Itt(t,e,i){const r=Mt(t.direction,Ui(i,e,t.origin));return Sr(i,t.origin,xr(i,t.direction,r)),i}const Ttt=new JC(()=>Zl());var Ea,C1;(function(t){t[t.OBJECT=0]="OBJECT",t[t.HUD=1]="HUD",t[t.TERRAIN=2]="TERRAIN",t[t.OVERLAY=3]="OVERLAY",t[t.I3S=4]="I3S",t[t.PCL=5]="PCL",t[t.LOD=6]="LOD",t[t.VOXEL=7]="VOXEL"})(Ea||(Ea={}));let Ctt=class{constructor(){this.verticalOffset=0,this.selectionMode=!1,this.hud=!0,this.selectOpaqueTerrainOnly=!0,this.invisibleTerrain=!1,this.backfacesTerrain=!0,this.isFiltered=!1,this.filteredLayerUids=[],this.store=C1.ALL}};(function(t){t[t.MIN=0]="MIN",t[t.MINMAX=1]="MINMAX",t[t.ALL=2]="ALL"})(C1||(C1={}));let Ett=class{constructor(e,i,r){this.object=e,this.geometryId=i,this.triangleNr=r}},Mtt=class extends Ett{constructor(e,i,r,n){super(e,i,r),this.center=n!=null?Ls(n):null}},$tt=class{constructor(e){this.layerUid=e}},G0e=class extends $tt{constructor(e,i){super(e),this.graphicUid=i}};var fp;(function(t){t[t.X=0]="X",t[t.Y=1]="Y",t[t.Z=2]="Z"})(fp||(fp={}));function YC(t){return t?{origin:Ls(t.origin),vector:Ls(t.vector)}:{origin:Me(),vector:Me()}}function Att(t,e){const i=Ott.get();return i.origin=t,i.vector=e,i}function qSt(t,e=YC()){return ktt(t.origin,t.vector,e)}function ktt(t,e,i=YC()){return bi(i.origin,t),bi(i.vector,e),i}function WSt(t,e,i=YC()){return bi(i.origin,t),Ui(i.vector,e,t),i}function Ptt(t,e){const i=Ui(it.get(),e,t.origin),r=Mt(t.vector,i),n=Mt(t.vector,t.vector),s=Pn(r/n,0,1),o=Ui(it.get(),xr(it.get(),t.vector,s),i);return Mt(o,o)}function JSt(t,e,i){return T8(t,e,0,1,i)}function ZSt(t,e,i){return Sr(i,t.origin,xr(i,t.vector,e))}function T8(t,e,i,r,n){const{vector:s,origin:o}=t,a=Ui(it.get(),e,o),l=Mt(s,a)/t1(s);return xr(n,s,Pn(l,i,r)),Sr(n,n,t.origin)}function YSt(t,e){if(H0e(t,Att(e.origin,e.direction),!1,_O)){const{tA:i,pB:r,distance2:n}=_O;if(i>=0&&i<=1)return n;if(i<0)return bp(t.origin,r);if(i>1)return bp(Sr(it.get(),t.origin,t.vector),r)}return null}function KSt(t,e,i){return!!H0e(t,e,!0,_O)&&(bi(i,_O.pA),!0)}function H0e(t,e,i,r){const s=t.origin,o=Sr(it.get(),s,t.vector),a=e.origin,l=Sr(it.get(),a,e.vector),c=it.get(),u=it.get();if(c[0]=s[0]-a[0],c[1]=s[1]-a[1],c[2]=s[2]-a[2],u[0]=l[0]-a[0],u[1]=l[1]-a[1],u[2]=l[2]-a[2],Math.abs(u[0])<1e-6&&Math.abs(u[1])<1e-6&&Math.abs(u[2])<1e-6)return!1;const h=it.get();if(h[0]=o[0]-s[0],h[1]=o[1]-s[1],h[2]=o[2]-s[2],Math.abs(h[0])<1e-6&&Math.abs(h[1])<1e-6&&Math.abs(h[2])<1e-6)return!1;const f=c[0]*u[0]+c[1]*u[1]+c[2]*u[2],m=u[0]*h[0]+u[1]*h[1]+u[2]*h[2],g=c[0]*h[0]+c[1]*h[1]+c[2]*h[2],y=u[0]*u[0]+u[1]*u[1]+u[2]*u[2],v=(h[0]*h[0]+h[1]*h[1]+h[2]*h[2])*y-m*m;if(Math.abs(v)<1e-6)return!1;let b=(f*m-g*y)/v,w=(f+m*b)/y;i&&(b=Pn(b,0,1),w=Pn(w,0,1));const x=it.get(),S=it.get();return x[0]=s[0]+b*h[0],x[1]=s[1]+b*h[1],x[2]=s[2]+b*h[2],S[0]=a[0]+w*u[0],S[1]=a[1]+w*u[1],S[2]=a[2]+w*u[2],r.tA=b,r.tB=w,r.pA=x,r.pB=S,r.distance2=bp(x,S),!0}const _O={tA:0,tB:0,pA:Me(),pB:Me(),distance2:0},Ott=new JC(()=>YC());function XSt(t,e,i){const r=Mt(t,e)/Mt(t,t);return xr(i,t,r)}function pv(t,e){return Mt(t,e)/vs(t)}function Ltt(t,e){const i=Mt(t,e)/(vs(t)*vs(e));return-QO(i)}function QSt(t,e,i){Rs(VM,t),Rs($F,e);const r=Mt(VM,$F),n=QO(r),s=No(VM,VM,$F);return Mt(s,i)<0?2*Math.PI-n:n}const VM=Me(),$F=Me(),Rtt=Xv();function Xv(){return hg()}function q0e(t,e=Xv()){return qI(e,t)}function Ftt(t,e){return Eg(t[0],t[1],t[2],e)}function Dtt(t){return t}function Ntt(t){t[0]=t[1]=t[2]=t[3]=0}function Vtt(t,e){return t[0]=t[1]=t[2]=0,t[3]=e,t}function IR(t){return t[3]}function ztt(t){return t}function jtt(t,e,i,r){return Eg(t,e,i,r)}function Btt(t,e,i){return t!==i&&bi(i,t),i[3]=t[3]+e,i}function Utt(t,e,i){return ie.getLogger("esri.geometry.support.sphere").error("sphere.setExtent is not yet supported"),t===i?i:q0e(t,i)}function TR(t,e,i){if(e==null)return!1;const{origin:r,direction:n}=e,s=Gtt;s[0]=r[0]-t[0],s[1]=r[1]-t[1],s[2]=r[2]-t[2];const o=n[0]*n[0]+n[1]*n[1]+n[2]*n[2];if(o===0)return!1;const a=2*(n[0]*s[0]+n[1]*s[1]+n[2]*s[2]),l=a*a-4*o*(s[0]*s[0]+s[1]*s[1]+s[2]*s[2]-t[3]*t[3]);if(l<0)return!1;const c=Math.sqrt(l);let u=(-a-c)/(2*o);const h=(-a+c)/(2*o);return(u<0||h<u&&h>0)&&(u=h),!(u<0)&&(i&&(i[0]=r[0]+n[0]*u,i[1]=r[1]+n[1]*u,i[2]=r[2]+n[2]*u),!0)}const Gtt=Me();function Htt(t,e){return TR(t,e,null)}function qtt(t,e,i){if(TR(t,e,i))return i;const r=W0e(t,e,it.get());return Sr(i,e.origin,xr(it.get(),e.direction,N1(e.origin,r)/vs(e.direction))),i}function W0e(t,e,i){const r=it.get(),n=wtt.get();No(r,e.origin,e.direction);const s=IR(t);No(i,r,e.origin),xr(i,i,1/vs(i)*s);const o=Z0e(t,e.origin),a=Ltt(e.origin,i);return CU(n,a+o,r),Td(i,i,n),i}function Wtt(t,e,i){return TR(t,e,i)?i:(Itt(e,t,i),J0e(t,i,i))}function J0e(t,e,i){const r=Ui(it.get(),e,t),n=xr(it.get(),r,t[3]/vs(r));return Sr(i,n,t)}function Jtt(t,e){const i=Ui(it.get(),e,t),r=t1(i),n=t[3]*t[3];return Math.sqrt(Math.abs(r-n))}function Z0e(t,e){const i=Ui(it.get(),e,t),r=vs(i),n=IR(t),s=n+Math.abs(n-r);return QO(n/s)}const AF=Me();function Y0e(t,e,i,r){const n=Ui(AF,e,t);switch(i){case fp.X:{const s=uq(n,AF)[2];return Bi(r,-Math.sin(s),Math.cos(s),0)}case fp.Y:{const s=uq(n,AF),o=s[1],a=s[2],l=Math.sin(o);return Bi(r,-l*Math.cos(a),-l*Math.sin(a),Math.cos(o))}case fp.Z:return Rs(r,n);default:return}}function K0e(t,e){const i=Ui(C8,e,t);return vs(i)-t[3]}function Ztt(t,e,i,r){const n=K0e(t,e),s=Y0e(t,e,fp.Z,C8),o=xr(C8,s,i-n);return Sr(r,e,o)}function Ytt(t,e){const i=bp(t,e),r=IR(t);return i<=r*r}function Ktt(t,e,i=Xv()){const r=N1(t,e),n=t[3],s=e[3];return r+s<n?(qI(i,t),i):r+n<s?(qI(i,e),i):(XO(i,t,e,(r+s-n)/(2*r)),i[3]=(r+n+s)/2,i)}const C8=Me(),Xtt=Xv();Object.freeze(Object.defineProperty({__proto__:null,NullSphere:Rtt,altitudeAt:K0e,angleToSilhouette:Z0e,axisAt:Y0e,clear:Ntt,closestPoint:Wtt,closestPointOnSilhouette:W0e,containsPoint:Ytt,copy:q0e,create:Xv,distanceToSilhouette:Jtt,elevate:Btt,fromCenterAndRadius:Ftt,fromRadius:Vtt,fromValues:jtt,getCenter:ztt,getRadius:IR,intersectRay:TR,intersectRayClosestSilhouette:qtt,intersectsRay:Htt,projectPoint:J0e,setAltitudeAt:Ztt,setExtent:Utt,tmpSphere:Xtt,union:Ktt,wrap:Dtt},Symbol.toStringTag,{value:"Module"}));function e2t(t){const e=t[0]*t[0]+t[4]*t[4]+t[8]*t[8],i=t[1]*t[1]+t[5]*t[5]+t[9]*t[9],r=t[2]*t[2]+t[6]*t[6]+t[10]*t[10];return Math.sqrt(Math.max(e,i,r))}function t2t(t,e){const i=Math.sqrt(e[0]*e[0]+e[4]*e[4]+e[8]*e[8]),r=Math.sqrt(e[1]*e[1]+e[5]*e[5]+e[9]*e[9]),n=Math.sqrt(e[2]*e[2]+e[6]*e[6]+e[10]*e[10]);return Bi(t,i,r,n),t}function Qtt(t,e,i){Math.abs(t[0])>Math.abs(t[1])?Bi(e,0,1,0):Bi(e,1,0,0),No(i,t,e),Rs(e,e),No(e,i,t),Rs(i,i)}function ox(t=C2){return[t[0],t[1],t[2],t[3]]}function eit(t=C2[0],e=C2[1],i=C2[2],r=C2[3]){return v7(t,e,i,r,btt.get())}function X0e(t,e){return v7(e[0],e[1],e[2],e[3],t)}function v7(t,e,i,r,n=ox()){return n[0]=t,n[1]=e,n[2]=i,n[3]=r,n}function tit(t,e,i){const r=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=Math.abs(r-1)>1e-5&&r>1e-12?1/Math.sqrt(r):1;return i[0]=e[0]*n,i[1]=e[1]*n,i[2]=e[2]*n,i[3]=-(i[0]*t[0]+i[1]*t[1]+i[2]*t[2]),i}function iit(t,e,i,r=ox()){const n=i[0]-e[0],s=i[1]-e[1],o=i[2]-e[2],a=t[0]-e[0],l=t[1]-e[1],c=t[2]-e[2],u=s*c-o*l,h=o*a-n*c,f=n*l-s*a,m=u*u+h*h+f*f,g=Math.abs(m-1)>1e-5&&m>1e-12?1/Math.sqrt(m):1;return r[0]=u*g,r[1]=h*g,r[2]=f*g,r[3]=-(r[0]*t[0]+r[1]*t[1]+r[2]*t[2]),r}function rit(t,e,i,r,n){const s=t.length/3;if(s<3)return!1;Bi(Xx,t[3*i],t[3*i+1],t[3*i+2]);let o=r,a=!1;for(;o<s-1&&!a;){const l=3*o;Bi(V_,t[l],t[l+1],t[l+2]),o++,a=!Xi(Xx,V_)}if(!a)return!1;for(o=Math.max(o,n),a=!1;o<s&&!a;){const l=3*o;Bi(D0,t[l],t[l+1],t[l+2]),o++,Ui(zM,Xx,V_),Rs(zM,zM),Ui(jM,V_,D0),Rs(jM,jM),a=!Xi(Xx,D0)&&!Xi(V_,D0)&&Math.abs(Mt(zM,jM))<nit}return a?(iit(Xx,V_,D0,e),!0):(i!==0||r!==1||n!==2)&&rit(t,e,0,1,2)}const nit=.99619469809,Xx=Me(),V_=Me(),D0=Me(),zM=Me(),jM=Me();function sit(t,e,i){return e!==t&&X0e(t,e),t[3]=-Mt(t,i),t}function i2t(t,e){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e}function E8(t,e,i,r){return No(D0,e,t),tit(i,D0,r)}function r2t(t,e,i,r){return CR(t,e,Ui(it.get(),i,e),dit,r)}function oit(t,e,i){return e!=null&&CR(t,e.origin,e.direction,hit,i)}function ait(t,e,i){return CR(t,e.origin,e.vector,Fd.NONE,i)}function lit(t,e,i){return CR(t,e.origin,e.vector,Fd.CLAMP,i)}function Q0e(t,e){return eve(t,e)>=0}function n2t(t,e){const i=Mt(t,e.ray.direction),r=-eve(t,e.ray.origin);if(i>-1e-6&&i<1e-6)return r>0;const n=r/i;return i>0?n<e.c1&&(e.c1=n):n>e.c0&&(e.c0=n),e.c0<=e.c1}function cit(t,e,i){const r=xr(it.get(),t,-t[3]),n=uit(t,Ui(it.get(),e,r),it.get());return Sr(i,n,r),i}function s2t(t,e,i,r){const n=t,s=it.get(),o=it.get();Qtt(n,s,o);const a=Ui(it.get(),i,e),l=pv(s,a),c=pv(o,a),u=pv(n,a);return Bi(r,l,c,u)}function uit(t,e,i){const r=xr(it.get(),t,Mt(t,e));return Ui(i,e,r),i}function eve(t,e){return Mt(t,e)+t[3]}function CR(t,e,i,r,n){const s=Mt(t,i);if(s===0)return!1;let o=-(Mt(t,e)+t[3])/s;return r&Fd.CLAMP&&(o=Pn(o,0,1)),!(!(r&Fd.INFINITE_MIN)&&o<0||!(r&Fd.INFINITE_MAX)&&o>1)&&(Sr(n,e,xr(n,i,o)),!0)}function o2t(t){return t}const C2=[0,0,1,0];var Fd;(function(t){t[t.NONE=0]="NONE",t[t.CLAMP=1]="CLAMP",t[t.INFINITE_MIN=4]="INFINITE_MIN",t[t.INFINITE_MAX=8]="INFINITE_MAX"})(Fd||(Fd={}));const dit=Fd.INFINITE_MIN|Fd.INFINITE_MAX,hit=Fd.INFINITE_MAX,kF=ie.getLogger("esri.views.3d.support.geometryUtils.boundedPlane");let pit=class{constructor(){this.plane=ox(),this.origin=Me(),this.basis1=Me(),this.basis2=Me()}};const fit=pit;function KC(t=uve){return{plane:ox(t.plane),origin:Ls(t.origin),basis1:Ls(t.basis1),basis2:Ls(t.basis2)}}function mit(t,e,i){const r=Ait.get();return r.origin=t,r.basis1=e,r.basis2=i,r.plane=eit(0,0,0,0),MR(r),r}function ER(t,e=KC()){return tve(t.origin,t.basis1,t.basis2,e)}function git(t,e){bi(e.origin,t.origin),bi(e.basis1,t.basis1),bi(e.basis2,t.basis2),X0e(e.plane,t.plane)}function tve(t,e,i,r=KC()){return bi(r.origin,t),bi(r.basis1,e),bi(r.basis2,i),MR(r),Mit(r,"fromValues()"),r}function MR(t){E8(t.basis2,t.basis1,t.origin,t.plane)}function ive(t,e,i){t!==i&&ER(t,i);const r=xr(it.get(),Ip(t),e);return Sr(i.origin,i.origin,r),i.plane[3]-=e,i}function yit(t,e,i){return rve(e,i),ive(i,w7(t,t.origin),i),i}function rve(t,e=KC()){const i=(t[2]-t[0])/2,r=(t[3]-t[1])/2;return Bi(e.origin,t[0]+i,t[1]+r,0),Bi(e.basis1,i,0,0),Bi(e.basis2,0,r,0),v7(0,0,1,0,e.plane),e}function _7(t,e,i){return!!oit(t.plane,e,i)&&lve(t,i)}function vit(t,e,i){if(_7(t,e,i))return i;const r=nve(t,e,it.get());return Sr(i,e.origin,xr(it.get(),e.direction,N1(e.origin,r)/vs(e.direction))),i}function nve(t,e,i){const r=bO.get();cve(t,e,r,bO.get());let n=Number.POSITIVE_INFINITY;for(const s of S7){const o=x7(t,s,$R.get()),a=it.get();if(ait(r,o,a)){const l=kse(it.get(),e.origin,a),c=Math.abs(QO(Mt(e.direction,l)));c<n&&(n=c,bi(i,a))}}return n===Number.POSITIVE_INFINITY?sve(t,e,i):i}function sve(t,e,i){if(_7(t,e,i))return i;const r=bO.get(),n=bO.get();cve(t,e,r,n);let s=Number.POSITIVE_INFINITY;for(const o of S7){const a=x7(t,o,$R.get()),l=it.get();if(lit(r,a,l)){const c=Stt(e,l);if(!Q0e(n,l))continue;c<s&&(s=c,bi(i,l))}}return b7(t,e.origin)<s&&ove(t,e.origin,i),i}function ove(t,e,i){const r=cit(t.plane,e,it.get()),n=T8(hee(t,t.basis1),r,-1,1,it.get()),s=T8(hee(t,t.basis2),r,-1,1,it.get());return Ui(i,Sr(it.get(),n,s),t.origin),i}function ave(t,e,i){const{origin:r,basis1:n,basis2:s}=t,o=Ui(it.get(),e,r),a=pv(n,o),l=pv(s,o),c=pv(Ip(t),o);return Bi(i,a,l,c)}function b7(t,e){const i=ave(t,e,it.get()),{basis1:r,basis2:n}=t,s=vs(r),o=vs(n),a=Math.max(Math.abs(i[0])-s,0),l=Math.max(Math.abs(i[1])-o,0),c=i[2];return a*a+l*l+c*c}function _it(t,e){return Math.sqrt(b7(t,e))}function bit(t,e){let i=Number.NEGATIVE_INFINITY;for(const r of S7){const n=x7(t,r,$R.get()),s=Ptt(n,e);s>i&&(i=s)}return Math.sqrt(i)}function wit(t,e){return Q0e(t.plane,e)&&lve(t,e)}function xit(t,e,i,r){return Eit(t,i,r)}function w7(t,e){const i=-t.plane[3];return pv(Ip(t),e)-i}function Sit(t,e,i,r){const n=w7(t,e),s=xr($it,Ip(t),i-n);return Sr(r,e,s),r}function Iit(t,e){return Xi(t.basis1,e.basis1)&&Xi(t.basis2,e.basis2)&&Xi(t.origin,e.origin)}function Tit(t,e,i){return t!==i&&ER(t,i),fL(z_,e),ac(z_,z_),Td(i.basis1,t.basis1,z_),Td(i.basis2,t.basis2,z_),Td(i.plane,t.plane,z_),Td(i.origin,t.origin,e),sit(i.plane,i.plane,i.origin),i}function Cit(t,e,i,r){return t!==r&&ER(t,r),CU(PF,e,i),Td(r.basis1,t.basis1,PF),Td(r.basis2,t.basis2,PF),MR(r),r}function Ip(t){return t.plane}function Eit(t,e,i){switch(e){case fp.X:bi(i,t.basis1),Rs(i,i);break;case fp.Y:bi(i,t.basis2),Rs(i,i);break;case fp.Z:bi(i,Ip(t))}return i}function lve(t,e){const i=Ui(it.get(),e,t.origin),r=t1(t.basis1),n=t1(t.basis2),s=Mt(t.basis1,i),o=Mt(t.basis2,i);return-s-r<0&&s-r<0&&-o-n<0&&o-n<0}function hee(t,e){const i=$R.get();return bi(i.origin,t.origin),bi(i.vector,e),i}function x7(t,e,i){const{basis1:r,basis2:n,origin:s}=t,o=xr(it.get(),r,e.origin[0]),a=xr(it.get(),n,e.origin[1]);Sr(i.origin,o,a),Sr(i.origin,i.origin,s);const l=xr(it.get(),r,e.direction[0]),c=xr(it.get(),n,e.direction[1]);return xr(i.vector,Sr(l,l,c),2),i}function Mit(t,e){Math.abs(Mt(t.basis1,t.basis2)/(vs(t.basis1)*vs(t.basis2)))>1e-6&&kF.warn(e,"Provided basis vectors are not perpendicular"),Math.abs(Mt(t.basis1,Ip(t)))>1e-6&&kF.warn(e,"Basis vectors and plane normal are not perpendicular"),Math.abs(-Mt(Ip(t),t.origin)-t.plane[3])>1e-6&&kF.warn(e,"Plane offset is not consistent with plane origin")}function cve(t,e,i,r){const n=Ip(t);E8(n,e.direction,e.origin,i),E8(i,n,e.origin,r)}const uve={plane:ox(),origin:en(0,0,0),basis1:en(1,0,0),basis2:en(0,1,0)},bO=new JC(ox),$R=new JC(YC),$it=Me(),Ait=new JC(()=>KC()),S7=[{origin:[-1,-1],direction:[1,0]},{origin:[1,-1],direction:[0,1]},{origin:[1,1],direction:[-1,0]},{origin:[-1,1],direction:[0,-1]}],z_=Xh(),PF=Xh();Object.freeze(Object.defineProperty({__proto__:null,BoundedPlaneClass:fit,UP:uve,altitudeAt:w7,axisAt:xit,closestPoint:sve,closestPointOnSilhouette:nve,copy:ER,copyWithoutVerify:git,create:KC,distance:_it,distance2:b7,distanceToSilhouette:bit,elevate:ive,equals:Iit,extrusionContainsPoint:wit,fromAABoundingRect:rve,fromValues:tve,intersectRay:_7,intersectRayClosestSilhouette:vit,normal:Ip,projectPoint:ove,projectPointLocal:ave,rotate:Cit,setAltitudeAt:Sit,setExtent:yit,transform:Tit,updateUnboundedPlane:MR,wrap:mit},Symbol.toStringTag,{value:"Module"}));function kg(t){return t!=null&&t.dist!=null}function kit(t){return kg(t)&&t.intersector===Ea.OBJECT&&!!t.target}function Pit(t){return kg(t)&&t.intersector===Ea.HUD&&!!t.target&&"center"in t.target&&t.target.center!=null}function Oit(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function dve(t,e,i){i*=.5;const r=Math.sin(i);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(i),t}function Lit(t,e){const i=2*Math.acos(e[3]),r=Math.sin(i/2);return r>Bo()?(t[0]=e[0]/r,t[1]=e[1]/r,t[2]=e[2]/r):(t[0]=1,t[1]=0,t[2]=0),i}function hve(t,e,i){const r=e[0],n=e[1],s=e[2],o=e[3],a=i[0],l=i[1],c=i[2],u=i[3];return t[0]=r*u+o*a+n*c-s*l,t[1]=n*u+o*l+s*a-r*c,t[2]=s*u+o*c+r*l-n*a,t[3]=o*u-r*a-n*l-s*c,t}function Rit(t,e,i){i*=.5;const r=e[0],n=e[1],s=e[2],o=e[3],a=Math.sin(i),l=Math.cos(i);return t[0]=r*l+o*a,t[1]=n*l+s*a,t[2]=s*l-n*a,t[3]=o*l-r*a,t}function Fit(t,e,i){i*=.5;const r=e[0],n=e[1],s=e[2],o=e[3],a=Math.sin(i),l=Math.cos(i);return t[0]=r*l-s*a,t[1]=n*l+o*a,t[2]=s*l+r*a,t[3]=o*l-n*a,t}function Dit(t,e,i){i*=.5;const r=e[0],n=e[1],s=e[2],o=e[3],a=Math.sin(i),l=Math.cos(i);return t[0]=r*l+n*a,t[1]=n*l-r*a,t[2]=s*l+o*a,t[3]=o*l-s*a,t}function Nit(t,e){const i=e[0],r=e[1],n=e[2];return t[0]=i,t[1]=r,t[2]=n,t[3]=Math.sqrt(Math.abs(1-i*i-r*r-n*n)),t}function WA(t,e,i,r){const n=e[0],s=e[1],o=e[2],a=e[3];let l,c,u,h,f,m=i[0],g=i[1],y=i[2],v=i[3];return c=n*m+s*g+o*y+a*v,c<0&&(c=-c,m=-m,g=-g,y=-y,v=-v),1-c>Bo()?(l=Math.acos(c),u=Math.sin(l),h=Math.sin((1-r)*l)/u,f=Math.sin(r*l)/u):(h=1-r,f=r),t[0]=h*n+f*m,t[1]=h*s+f*g,t[2]=h*o+f*y,t[3]=h*a+f*v,t}function Vit(t){const e=sC,i=e(),r=e(),n=e(),s=Math.sqrt(1-i),o=Math.sqrt(i);return t[0]=s*Math.sin(2*Math.PI*r),t[1]=s*Math.cos(2*Math.PI*r),t[2]=o*Math.sin(2*Math.PI*n),t[3]=o*Math.cos(2*Math.PI*n),t}function zit(t,e){const i=e[0],r=e[1],n=e[2],s=e[3],o=i*i+r*r+n*n+s*s,a=o?1/o:0;return t[0]=-i*a,t[1]=-r*a,t[2]=-n*a,t[3]=s*a,t}function pve(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function fve(t,e){const i=e[0]+e[4]+e[8];let r;if(i>0)r=Math.sqrt(i+1),t[3]=.5*r,r=.5/r,t[0]=(e[5]-e[7])*r,t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{let n=0;e[4]>e[0]&&(n=1),e[8]>e[3*n+n]&&(n=2);const s=(n+1)%3,o=(n+2)%3;r=Math.sqrt(e[3*n+n]-e[3*s+s]-e[3*o+o]+1),t[n]=.5*r,r=.5/r,t[3]=(e[3*s+o]-e[3*o+s])*r,t[s]=(e[3*s+n]+e[3*n+s])*r,t[o]=(e[3*o+n]+e[3*n+o])*r}return t}function jit(t,e,i,r){const n=.5*Math.PI/180;e*=n,i*=n,r*=n;const s=Math.sin(e),o=Math.cos(e),a=Math.sin(i),l=Math.cos(i),c=Math.sin(r),u=Math.cos(r);return t[0]=s*l*u-o*a*c,t[1]=o*a*u+s*l*c,t[2]=o*l*c-s*a*u,t[3]=o*l*u+s*a*c,t}function Bit(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}const Uit=qI,Git=Ose,Hit=Lse,qit=hve,Wit=Nse,Jit=Bse,Zit=AB,mve=MB,Yit=mve,gve=$B,Kit=gve,I7=jse,Xit=Gse,Qit=Hse;function ert(t,e,i){const r=Mt(e,i);return r<-.999999?(No(Vu,trt,e),Pse(Vu)<1e-6&&No(Vu,irt,e),Rs(Vu,Vu),dve(t,Vu,Math.PI),t):r>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(No(Vu,e,i),t[0]=Vu[0],t[1]=Vu[1],t[2]=Vu[2],t[3]=1+r,I7(t,t))}const Vu=Me(),trt=en(1,0,0),irt=en(0,1,0);function rrt(t,e,i,r,n,s){return WA(pee,e,n,s),WA(fee,i,r,s),WA(t,pee,fee,2*s*(1-s)),t}const pee=ZC(),fee=ZC();function nrt(t,e,i,r){const n=srt;return n[0]=i[0],n[3]=i[1],n[6]=i[2],n[1]=r[0],n[4]=r[1],n[7]=r[2],n[2]=-e[0],n[5]=-e[1],n[8]=-e[2],I7(t,fve(t,n))}const srt=g7();Object.freeze(Object.defineProperty({__proto__:null,add:Hit,calculateW:Nit,conjugate:pve,copy:Uit,dot:Jit,equals:Qit,exactEquals:Xit,fromEuler:jit,fromMat3:fve,getAxisAngle:Lit,identity:Oit,invert:zit,len:Yit,length:mve,lerp:Zit,mul:qit,multiply:hve,normalize:I7,random:Vit,rotateX:Rit,rotateY:Fit,rotateZ:Dit,rotationTo:ert,scale:Wit,set:Git,setAxes:nrt,setAxisAngle:dve,slerp:WA,sqlerp:rrt,sqrLen:Kit,squaredLength:gve,str:Bit},Symbol.toStringTag,{value:"Module"}));function T7(){return new Float32Array(3)}function ort(t){const e=new Float32Array(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function XC(t,e,i){const r=new Float32Array(3);return r[0]=t,r[1]=e,r[2]=i,r}function art(t,e){return new Float32Array(t,e,3)}function yve(){return T7()}function vve(){return XC(1,1,1)}function _ve(){return XC(1,0,0)}function bve(){return XC(0,1,0)}function wve(){return XC(0,0,1)}const lrt=yve(),crt=vve(),urt=_ve(),drt=bve(),hrt=wve();Object.freeze(Object.defineProperty({__proto__:null,ONES:crt,UNIT_X:urt,UNIT_Y:drt,UNIT_Z:hrt,ZEROS:lrt,clone:ort,create:T7,createView:art,fromValues:XC,ones:vve,unitX:_ve,unitY:bve,unitZ:wve,zeros:yve},Symbol.toStringTag,{value:"Module"}));let prt=class{constructor(){this._transform=Xh(),this._transformInverse=new BM({value:this._transform},fL,Xh),this._transformInverseTranspose=new BM(this._transformInverse,ac,Xh),this._transformTranspose=new BM({value:this._transform},ac,Xh),this._transformInverseRotation=new BM({value:this._transform},Pue,g7)}_invalidateLazyTransforms(){this._transformInverse.invalidate(),this._transformInverseTranspose.invalidate(),this._transformTranspose.invalidate(),this._transformInverseRotation.invalidate()}get transform(){return this._transform}get inverse(){return this._transformInverse.value}get inverseTranspose(){return this._transformInverseTranspose.value}get inverseRotation(){return this._transformInverseRotation.value}get transpose(){return this._transformTranspose.value}setTransformMatrix(e){sT(this._transform,e)}multiplyTransform(e){TU(this._transform,this._transform,e)}set(e){sT(this._transform,e),this._invalidateLazyTransforms()}setAndInvalidateLazyTransforms(e,i){this.setTransformMatrix(e),this.multiplyTransform(i),this._invalidateLazyTransforms()}},BM=class{constructor(e,i,r){this._original=e,this._update=i,this._dirty=!0,this._transform=r()}invalidate(){this._dirty=!0}get value(){return this._dirty&&(this._update(this._transform,this._original.value),this._dirty=!1),this._transform}},frt=class{constructor(e=0){this.componentLocalOriginLength=0,this._tmpVertex=Me(),this._mbs=Xv(),this._obb={center:Me(),halfSize:T7(),quaternion:null},this._totalOffset=0,this._offset=0,this._resetOffset(e)}_resetOffset(e){this._offset=e,this._totalOffset=e}set offset(e){this._resetOffset(e)}get offset(){return this._offset}set componentOffset(e){this._totalOffset=this._offset+e}set localOrigin(e){this.componentLocalOriginLength=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2])}applyToVertex(e,i,r){const n=e,s=i,o=r+this.componentLocalOriginLength,a=this._totalOffset/Math.sqrt(n*n+s*s+o*o);return this._tmpVertex[0]=e+n*a,this._tmpVertex[1]=i+s*a,this._tmpVertex[2]=r+o*a,this._tmpVertex}applyToAabb(e){const i=e[0],r=e[1],n=e[2]+this.componentLocalOriginLength,s=e[3],o=e[4],a=e[5]+this.componentLocalOriginLength,l=i*s<0?0:Math.min(Math.abs(i),Math.abs(s)),c=r*o<0?0:Math.min(Math.abs(r),Math.abs(o)),u=n*a<0?0:Math.min(Math.abs(n),Math.abs(a)),h=Math.sqrt(l*l+c*c+u*u);if(h<this._totalOffset)return e[0]-=i<0?this._totalOffset:0,e[1]-=r<0?this._totalOffset:0,e[2]-=n<0?this._totalOffset:0,e[3]+=s>0?this._totalOffset:0,e[4]+=o>0?this._totalOffset:0,e[5]+=a>0?this._totalOffset:0,e;const f=Math.max(Math.abs(i),Math.abs(s)),m=Math.max(Math.abs(r),Math.abs(o)),g=Math.max(Math.abs(n),Math.abs(a)),y=Math.sqrt(f*f+m*m+g*g),v=this._totalOffset/y,b=this._totalOffset/h;return e[0]+=i*(i>0?v:b),e[1]+=r*(r>0?v:b),e[2]+=n*(n>0?v:b),e[3]+=s*(s<0?v:b),e[4]+=o*(o<0?v:b),e[5]+=a*(a<0?v:b),e}applyToMbs(e){const i=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]),r=this._totalOffset/i;return this._mbs[0]=e[0]+e[0]*r,this._mbs[1]=e[1]+e[1]*r,this._mbs[2]=e[2]+e[2]*r,this._mbs[3]=e[3]+e[3]*this._totalOffset/i,this._mbs}applyToObb(e){const i=e.center,r=this._totalOffset/Math.sqrt(i[0]*i[0]+i[1]*i[1]+i[2]*i[2]);this._obb.center[0]=i[0]+i[0]*r,this._obb.center[1]=i[1]+i[1]*r,this._obb.center[2]=i[2]+i[2]*r,WD(this._obb.halfSize,e.halfSize,e.quaternion),Sr(this._obb.halfSize,this._obb.halfSize,e.center);const n=this._totalOffset/Math.sqrt(this._obb.halfSize[0]*this._obb.halfSize[0]+this._obb.halfSize[1]*this._obb.halfSize[1]+this._obb.halfSize[2]*this._obb.halfSize[2]);return this._obb.halfSize[0]+=this._obb.halfSize[0]*n,this._obb.halfSize[1]+=this._obb.halfSize[1]*n,this._obb.halfSize[2]+=this._obb.halfSize[2]*n,Ui(this._obb.halfSize,this._obb.halfSize,e.center),pve(yee,e.quaternion),WD(this._obb.halfSize,this._obb.halfSize,yee),this._obb.halfSize[0]*=this._obb.halfSize[0]<0?-1:1,this._obb.halfSize[1]*=this._obb.halfSize[1]<0?-1:1,this._obb.halfSize[2]*=this._obb.halfSize[2]<0?-1:1,this._obb.quaternion=e.quaternion,this._obb}},mrt=class{constructor(e=0){this.offset=e,this.sphere=Xv(),this.tmpVertex=Me()}applyToVertex(e,i,r){const n=this.objectTransform.transform;let s=n[0]*e+n[4]*i+n[8]*r+n[12],o=n[1]*e+n[5]*i+n[9]*r+n[13],a=n[2]*e+n[6]*i+n[10]*r+n[14];const l=this.offset/Math.sqrt(s*s+o*o+a*a);s+=s*l,o+=o*l,a+=a*l;const c=this.objectTransform.inverse;return this.tmpVertex[0]=c[0]*s+c[4]*o+c[8]*a+c[12],this.tmpVertex[1]=c[1]*s+c[5]*o+c[9]*a+c[13],this.tmpVertex[2]=c[2]*s+c[6]*o+c[10]*a+c[14],this.tmpVertex}applyToMinMax(e,i){const r=this.offset/Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]+=e[0]*r,e[1]+=e[1]*r,e[2]+=e[2]*r;const n=this.offset/Math.sqrt(i[0]*i[0]+i[1]*i[1]+i[2]*i[2]);i[0]+=i[0]*n,i[1]+=i[1]*n,i[2]+=i[2]*n}applyToAabb(e){const i=this.offset/Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]+=e[0]*i,e[1]+=e[1]*i,e[2]+=e[2]*i;const r=this.offset/Math.sqrt(e[3]*e[3]+e[4]*e[4]+e[5]*e[5]);return e[3]+=e[3]*r,e[4]+=e[4]*r,e[5]+=e[5]*r,e}applyToBoundingSphere(e){const i=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]),r=this.offset/i;return this.sphere[0]=e[0]+e[0]*r,this.sphere[1]=e[1]+e[1]*r,this.sphere[2]=e[2]+e[2]*r,this.sphere[3]=e[3]+e[3]*this.offset/i,this.sphere}};const mee=new mrt;function gee(t){return t!=null?(mee.offset=t,mee):null}new frt;const yee=ZC(),vee=1e-5;let grt=class{constructor(e){this.options=new Ctt,this._results=new vrt,this.transform=new prt,this.tolerance=vee,this.verticalOffset=null,this._ray=Zl(),this._rayEnd=Me(),this._rayBeginTransformed=Me(),this._rayEndTransformed=Me(),this.viewingMode=e??u1.Global}get results(){return this._results}get ray(){return this._ray}get rayBegin(){return this._ray.origin}get rayEnd(){return this._rayEnd}reset(e,i,r){this.resetWithRay(U0e(e,i,this._ray),r)}resetWithRay(e,i){this.camera=i,e!==this._ray&&I8(e,this._ray),this.options.verticalOffset!==0?this.viewingMode===u1.Local?this._ray.origin[2]-=this.options.verticalOffset:this.verticalOffset=this.options.verticalOffset:this.verticalOffset=null,Sr(this._rayEnd,this._ray.origin,this._ray.direction),this._results.init(this._ray)}intersect(e=null,i,r,n,s){this.point=i,this.filterPredicate=n,this.tolerance=r??vee;const o=gee(this.verticalOffset);if(e&&e.length>0){const a=s?l=>{s(l)&&this.intersectObject(l)}:l=>{this.intersectObject(l)};for(const l of e){const c=l.getSpatialQueryAccelerator&&l.getSpatialQueryAccelerator();c!=null?(o!=null?c.forEachAlongRayWithVerticalOffset(this._ray.origin,this._ray.direction,a,o):c.forEachAlongRay(this._ray.origin,this._ray.direction,a),this.options.selectionMode&&this.options.hud&&c.forEachDegenerateObject(a)):l.objects.forAll(u=>a(u))}}this.sortResults()}intersectObject(e){const i=e.geometries;if(!i)return;const r=e.shaderTransformation,n=gee(this.verticalOffset);for(const s of i){if(!s.visible)continue;const{material:o,id:a}=s;this.transform.setAndInvalidateLazyTransforms(r,s.shaderTransformation),Td(this._rayBeginTransformed,this.rayBegin,this.transform.inverse),Td(this._rayEndTransformed,this.rayEnd,this.transform.inverse);const l=this.transform.transform;n!=null&&(n.objectTransform=this.transform),o.intersect(s,this.transform.transform,this,this._rayBeginTransformed,this._rayEndTransformed,(c,u,h,f,m,g)=>{if(c>=0){if(this.filterPredicate!=null&&!this.filterPredicate(this._ray.origin,this._rayEnd,c))return;const y=f?this._results.hud:this._results,v=f?b=>{const w=new Mtt(e,a,h,g);b.set(Ea.HUD,w,c,u,y7,m)}:b=>b.set(Ea.OBJECT,{object:e,geometryId:a,triangleNr:h},c,u,l,m);if((y.min.drapedLayerOrder==null||m>=y.min.drapedLayerOrder)&&(y.min.dist==null||c<y.min.dist)&&v(y.min),this.options.store!==C1.MIN&&(y.max.drapedLayerOrder==null||m<y.max.drapedLayerOrder)&&(y.max.dist==null||c>y.max.dist)&&v(y.max),this.options.store===C1.ALL)if(f){const b=new M8(this._ray);v(b),this._results.hud.all.push(b)}else{const b=new Bw(this._ray);v(b),this._results.all.push(b)}}})}}sortResults(e=this._results.all){e.sort((i,r)=>i.dist!==r.dist?(i.dist??0)-(r.dist??0):i.drapedLayerOrder!==r.drapedLayerOrder?(i.drapedLayerOrder??Number.MAX_VALUE)-(r.drapedLayerOrder??Number.MAX_VALUE):(r.drapedLayerGraphicOrder??Number.MIN_VALUE)-(i.drapedLayerGraphicOrder??Number.MIN_VALUE))}};function yrt(t){return new grt(t)}let vrt=class{constructor(){this.min=new Bw(Zl()),this.max=new Bw(Zl()),this.hud={min:new M8(Zl()),max:new M8(Zl()),all:new Array},this.ground=new Bw(Zl()),this.all=[]}init(e){this.min.init(e),this.max.init(e),this.ground.init(e),this.all.length=0,this.hud.min.init(e),this.hud.max.init(e),this.hud.all.length=0}},Bw=class{get ray(){return this._ray}get distanceInRenderSpace(){return this.dist!=null?(xr(UM,this.ray.direction,this.dist),vs(UM)):null}getIntersectionPoint(e){return!!kg(this)&&(xr(UM,this.ray.direction,this.dist),Sr(e,this.ray.origin,UM),!0)}getTransformedNormal(e){return bi(Qx,this.normal),Qx[3]=0,Use(Qx,Qx,this.transformation),bi(e,Qx),Rs(e,e)}constructor(e){this.intersector=Ea.OBJECT,this.normal=Me(),this.transformation=Xh(),this._ray=Zl(),this.init(e)}init(e){this.dist=null,this.target=null,this.drapedLayerOrder=null,this.drapedLayerGraphicOrder=null,this.intersector=Ea.OBJECT,I8(e,this._ray)}set(e,i,r,n,s,o,a){this.intersector=e,this.dist=r,bi(this.normal,n??Mse),sT(this.transformation,s??y7),this.target=i,this.drapedLayerOrder=o,this.drapedLayerGraphicOrder=a}copy(e){I8(e.ray,this._ray),this.intersector=e.intersector,this.dist=e.dist,this.target=e.target,this.drapedLayerOrder=e.drapedLayerOrder,this.drapedLayerGraphicOrder=e.drapedLayerGraphicOrder,bi(this.normal,e.normal),sT(this.transformation,e.transformation)}},M8=class extends Bw{constructor(){super(...arguments),this.intersector=Ea.HUD}};function g2t(t){return new Bw(t)}const UM=Me(),Qx=hg();function _rt(t){return kg(t)&&t.intersector===Ea.PCL&&!!t.target}function brt(t){return kg(t)&&t.intersector===Ea.I3S&&!!t.target}function wrt(t){return kg(t)&&t.intersector===Ea.VOXEL&&!!t.target}let y2t=class extends G0e{constructor(e,i,r){super(e,i),this.triangleNr=r}};function xrt(t){return kg(t)&&t.intersector===Ea.OVERLAY&&!!t.target}let _2t=class extends G0e{constructor(e,i,r,n,s,o){super(e,i),this.layerUid=e,this.graphicUid=i,this.geometryId=r,this.triangleNr=n,this.baseBoundingSphere=s,this.numLodLevels=o}};function Srt(t){return kg(t)&&t.intersector===Ea.LOD&&!!t.target}function Irt(t,e){const i=Trt(t,e);return i!=null&&i.type==="graphic"?i.graphic:null}function Trt(t,e){var i;if(t==null)return null;if(kit(t)||Pit(t))return _ee((i=t.target)==null?void 0:i.object,e);if(_rt(t)){const r=t.target.createGraphic();return{type:"graphic",graphic:r,layer:r.layer}}if(wrt(t)){const r=t.target.createVoxelGraphic();return{type:"graphic",graphic:r,layer:r.layer}}return xrt(t)||Srt(t)?_ee(t.target,e):brt(t)?Crt(t.target,e):null}function _ee(t,e){if(t==null||t.graphicUid==null)return null;const i=xve(t,e);if(i==null)return null;if(i===e.graphics)return e.graphicsView==null||typeof t.graphicUid!="number"?null:e.graphicsView.getHit(t.graphicUid);const r=e.allLayerViews.find(n=>n.layer===i);return!r||r.suspended||t.graphicUid==null?null:"getHit"in r?r.getHit(t.graphicUid):null}function Crt(t,e){const i=xve(t,e);if(i==null)return null;const r=e.allLayerViews.find(n=>n.layer===i);return r&&!r.suspended&&"getGraphicFromIntersectorTarget"in r?Ert(r.getGraphicFromIntersectorTarget(t)):null}function Ert(t){return t!=null?{type:"graphic",graphic:t,layer:t.layer}:null}function xve(t,e){return t&&t.layerUid!=null?e.graphicsView!=null&&t.layerUid===e.graphicsView.processor.layer.id?e.graphics:e.map.findLayerByUid(t.layerUid):null}const Mrt=2e5;let Eo=class extends WC{constructor(e){super(e),this.type="view",this.color=new ce("#cf4ccf"),this.viewVisualizationEnabled=!0,this.include=null,this.exclude=null,this.numSamplesForPreview=50,this.numSamplesPerChunk=25,this._getQueryElevationDependencies=ec((i,r,n,s,o,a,l)=>({inputGraphicUid:i!=null?Sve(i):null,visibleLayers:r,maxIntersectionDistance:n,intersectOptions:s,view:o,stationary:a,spatialReference:l})),this._vecA=hg(),this._vecB=hg(),this._ray=Zl()}get minDemResolution(){var r,n,s;const e=(r=this._viewModel)==null?void 0:r.view;if(e==null||e.type!=="3d")return null;const i=(s=(n=e.pointsOfInterest)==null?void 0:n.focus)==null?void 0:s.renderLocation;return i?e.state.camera.computeRenderPixelSizeAt(i)*Iu(e.spatialReference):null}get queryElevationDependencies(){return lt(this._view,e=>{var i;return this._getQueryElevationDependencies((i=this._viewModel)==null?void 0:i.input,this._visibleLayers,this._maxIntersectionDistance,this._intersectOptions,e,e.stationary,e.spatialReference)})}get _visibleLayers(){const e=this._view;return lt(e,i=>{var r,n;return(n=(r=i.map)==null?void 0:r.allLayers)==null?void 0:n.filter(s=>s.visible).toArray()})??[]}get _intersectOptions(){const e=this._view;if(e==null)return{};const i=e.externalToInternalIntersectOptions({include:this.include,exclude:this.exclude}),r=e.externalToInternalIntersectOptions({exclude:this._pointCloudLayers});return i.exclude=rxe(i.exclude,r.exclude),i}get _pointCloudLayers(){const e=this._view;return e==null?[]:e.allLayerViews.toArray().filter(i=>{var r;return((r=i.layer)==null?void 0:r.type)==="point-cloud"}).map(i=>i.layer)}get _view(){var i;const e=(i=this._viewModel)==null?void 0:i.view;return e!=null&&e.type==="3d"?e:null}get _maxIntersectionDistance(){const e=this._view;return e!=null&&e.renderCoordsHelper?ZO(e.spatialReference).radius/e.renderCoordsHelper.unitInMeters:Number.POSITIVE_INFINITY}get _intersector(){const e=this._view;if(e==null)return null;const i=yrt(e.state.viewingMode),r=i.options;return r.hud=!1,r.invisibleTerrain=!1,r.backfacesTerrain=!1,r.selectionMode=!1,r.store=C1.ALL,i}async queryElevation(e,{noDataValue:i,signal:r}){const n=this.queryElevationDependencies;if(n==null)throw new Error("ElevationProfileLineInput: no dependencies");const s=this._intersector;if(s==null)throw new Error("ElevationProfileLineInput: no view");const{intersectOptions:o,view:a,spatialReference:l}=n,c=a.renderCoordsHelper,u=a.sceneIntersectionHelper,h=this._vecA,f=this._vecA,m=this._vecB,g=this._ray;if(!l)return{geometry:e,noDataValue:i};const y=await Y0.fromGeometry(e).project(l,r);if(!y)return{geometry:e,noDataValue:i};const v=y.coordinates,b=v.length;for(let w=0;w<b;++w){const x=v[w];Bi(m,x.x,x.y,x.z??0),c.toRenderCoords(m,l,m),c.setAltitude(h,Mrt,m);const S=U0e(h,m,g);u.computeIntersection(S,s,o);const I=$rt(n,s.results.all);I?(I.getIntersectionPoint(f),c.fromRenderCoords(f,f,l),x.z=f[2]):x.z=i}return{geometry:y.export(),noDataValue:i}}attach(e){const i=()=>this._onChange();return kn([super.attach(e),J(()=>this.queryElevationDependencies,i),ui(()=>e.elevationProvider,"elevation-change",i,{onListenerAdd:i,onListenerRemove:i})])}};function $rt({view:t,inputGraphicUid:e,maxIntersectionDistance:i},r){for(const n of r){if(n.distanceInRenderSpace!=null&&n.distanceInRenderSpace>i)continue;const s=Irt(n,t);if(s==null||Sve(s)!==e)return n}return null}function Sve(t){if(t.layer&&"objectIdField"in t.layer){const e=t.attributes[t.layer.objectIdField];if(e)return`o-${t.layer.id}-${e}`}return`u-${t.uid}`}d([p({type:ce,nonNullable:!0})],Eo.prototype,"color",void 0),d([p()],Eo.prototype,"viewVisualizationEnabled",void 0),d([p()],Eo.prototype,"include",void 0),d([p()],Eo.prototype,"exclude",void 0),d([p({readOnly:!0})],Eo.prototype,"minDemResolution",null),d([p()],Eo.prototype,"queryElevationDependencies",null),d([p()],Eo.prototype,"_visibleLayers",null),d([p()],Eo.prototype,"_intersectOptions",null),d([p()],Eo.prototype,"_pointCloudLayers",null),d([p()],Eo.prototype,"_view",null),d([p()],Eo.prototype,"_maxIntersectionDistance",null),d([p()],Eo.prototype,"_intersector",null),Eo=d([A("esri.widgets.ElevationProfile.ElevationProfileLineView")],Eo);const Art=Eo,krt={base:WC,key:"type",typeMap:{ground:R0e,input:dtt,query:htt,view:Art},errorContext:"elevation-profile-line"},Prt=ye.ofType(krt);let $h=class extends BL(WL(lC)){constructor(e){super(e),this.elevationInfo=null,this.graphics=new ov,this.screenSizePerspectiveEnabled=!0,this.type="graphics",this.internal=!1}destroy(){this.removeAll(),this.graphics.destroy()}add(e){return this.graphics.add(e),this}addMany(e){return this.graphics.addMany(e),this}removeAll(){return this.graphics.removeAll(),this}remove(e){this.graphics.remove(e)}removeMany(e){this.graphics.removeMany(e)}on(e,i){return super.on(e,i)}graphicChanged(e){this.emit("graphic-update",e)}};d([p({type:Xhe})],$h.prototype,"elevationInfo",void 0),d([p(R4(ov,"graphics"))],$h.prototype,"graphics",void 0),d([p({type:["show","hide"]})],$h.prototype,"listMode",void 0),d([p()],$h.prototype,"screenSizePerspectiveEnabled",void 0),d([p({readOnly:!0})],$h.prototype,"type",void 0),d([p({constructOnly:!0})],$h.prototype,"internal",void 0),$h=d([A("esri.layers.GraphicsLayer")],$h);const C7=$h;function OF(t){switch(t){case _i.SUPPORTED:break;case _i.GRAPHICS_LAYER_MISSING:return"not owned by a graphics layer";case _i.GEOMETRY_MISSING:return"no geometry";case _i.GEOMETRY_TYPE_UNSUPPORTED:return"the geometry type is not supported";case _i.ELEVATION_MODE_UNSUPPORTED:return"the elevation mode is not supported";case _i.SYMBOL_TYPE_UNSUPPORTED:return"the symbol type is not supported"}return""}var _i;(function(t){t[t.SUPPORTED=0]="SUPPORTED",t[t.GRAPHICS_LAYER_MISSING=1]="GRAPHICS_LAYER_MISSING",t[t.GEOMETRY_MISSING=2]="GEOMETRY_MISSING",t[t.GEOMETRY_TYPE_UNSUPPORTED=3]="GEOMETRY_TYPE_UNSUPPORTED",t[t.ELEVATION_MODE_UNSUPPORTED=4]="ELEVATION_MODE_UNSUPPORTED",t[t.SYMBOL_TYPE_UNSUPPORTED=5]="SYMBOL_TYPE_UNSUPPORTED"})(_i||(_i={}));function Ort(t){var e;if(((e=t.layer)==null?void 0:e.type)!=="graphics")return _i.GRAPHICS_LAYER_MISSING;if(t.geometry==null)return _i.GEOMETRY_MISSING;switch(t.geometry.type){case"polygon":case"point":case"polyline":case"mesh":break;default:return _i.GEOMETRY_TYPE_UNSUPPORTED}return bR(t)!=="on-the-ground"&&wR(t)?_i.ELEVATION_MODE_UNSUPPORTED:_i.SUPPORTED}var $8;let Kf=$8=class extends Zn{constructor(...t){super(...t),this.center=null,this.geodesic=!1,this.numberOfPoints=60,this.radius=1e3,this.radiusUnit="meters"}normalizeCtorArgs(t,e){let i;if(t&&t.center)i=t;else{if(t&&t.rings)return super.normalizeCtorArgs(t,e);i={center:t}}return{...super.normalizeCtorArgs(),...i,...e}}initialize(){const t=this.center,e=this.numberOfPoints;if(this.hasZ=(t==null?void 0:t.hasZ)??!1,this.rings.length!==0||!t)return;const i=bt(this.radius,this.radiusUnit,"meters"),r=t.spatialReference;let n,s="geographic";if(r.isWebMercator?s="webMercator":((r.wkid&&O[r.wkid])!=null||r.wkt&&r.wkt.indexOf("PROJCS")===0)&&(s="projected"),this.geodesic){let o;switch(s){case"webMercator":o=j0(t);break;case"projected":console.error("Creating a geodesic circle requires the center to be specified in web mercator or geographic coordinate system");break;case"geographic":o=t}n=this._createGeodesicCircle(o,i,e),s==="webMercator"&&(n=sp(n))}else{let o;s==="webMercator"||s==="projected"?o=i/this._convert2Meters(1,t.spatialReference):s==="geographic"&&(o=Qne(i,"meters",ZO(t.spatialReference).radius)),n=this._createPlanarCircle(t,o,e)}this.spatialReference=n.spatialReference,this.addRing(n.rings[0])}clone(){const{center:t,numberOfPoints:e,radius:i,radiusUnit:r,geodesic:n}=this;return new $8({center:t==null?void 0:t.clone(),numberOfPoints:e,radius:i,radiusUnit:r,geodesic:n})}_createGeodesicCircle(t,e,i){let r=0;const n=[];for(;r<360;){const s=[0,0],o=[t.x,t.y];zw(s,o,r,e),this.hasZ&&s.push(t.z),n.push(s),r+=360/i}return n.push(n[0]),new Zn(n)}_createPlanarCircle(t,e,i){const r=[],n=2*Math.PI/i;for(let s=0;s<i;++s){const o=n*s,a=[t.x+Math.cos(-o)*e,t.y+Math.sin(-o)*e];this.hasZ&&a.push(t.z),r.push(a)}return r.push(r[0]),new Zn({spatialReference:t.spatialReference,rings:[r]})}_convert2Meters(t,e){let i;if(e.wkid&&O[e.wkid]!=null)i=O.values[O[e.wkid]];else{const r=e.wkt,n=r.lastIndexOf(",")+1,s=r.lastIndexOf("]]");i=parseFloat(r.substring(n,s))}return t*i}};d([p({type:fe})],Kf.prototype,"center",void 0),d([p()],Kf.prototype,"geodesic",void 0),d([p()],Kf.prototype,"numberOfPoints",void 0),d([p()],Kf.prototype,"radius",void 0),d([p()],Kf.prototype,"radiusUnit",void 0),Kf=$8=d([A("esri.geometry.Circle")],Kf);const Lrt=Kf;function GM(t){return Ive(t).result}function S2t(t){return Ive(t).geometry}function Ive(t){var r;if(((r=t.layer)==null?void 0:r.type)!=="graphics")return{result:_i.GRAPHICS_LAYER_MISSING,geometry:null};const{geometry:e}=t;if(e==null)return{result:_i.GEOMETRY_MISSING,geometry:null};if(bR(t)!=="on-the-ground"&&wR(t))return{result:_i.ELEVATION_MODE_UNSUPPORTED,geometry:null};const i=e.type;return i!=="point"&&i!=="mesh"&&i!=="polyline"&&(i!=="polygon"||t.geometry instanceof Lrt)?{result:_i.GEOMETRY_TYPE_UNSUPPORTED,geometry:null}:{result:_i.SUPPORTED,geometry:e}}function Rrt(t){var i;if(((i=t.layer)==null?void 0:i.type)!=="graphics")return _i.GRAPHICS_LAYER_MISSING;if(t.geometry==null)return _i.GEOMETRY_MISSING;switch(t.geometry.type){case"point":break;case"polygon":case"polyline":case"multipoint":case"extent":case"mesh":return _i.SUPPORTED;default:return _i.GEOMETRY_TYPE_UNSUPPORTED}const e=t.symbol!=null&&t.symbol.type==="point-3d"&&t.symbol.symbolLayers;return e&&e.length>0&&e.some(r=>r.type==="object")?bR(t)!=="on-the-ground"&&wR(t)?_i.ELEVATION_MODE_UNSUPPORTED:_i.SUPPORTED:_i.SYMBOL_TYPE_UNSUPPORTED}function bee(t,e,i){if(!e||!t||!t.map)return;const{map:r}=t,n=r.layers.find(s=>s===e);n||r.add(e,i),n&&i!=null&&r.layers.reorder(n,i)}function I2t(t,e){return t.allLayerViews.find(i=>{const r=i.layer;return r===e||"sublayers"in r&&r.sublayers!=null&&r.sublayers.includes(e)})}const pn={redo:"r",undo:"z",center:"Alt",constraint:"Shift",cancel:"Escape",delete:["Backspace","Delete"],complete:"Enter",vertexAdd:"f",pan:" "},wee={toggle:"Control"};let JA=class extends he{constructor(e){super(e),this.enabled=!1}};d([p({type:Boolean,nonNullable:!0})],JA.prototype,"enabled",void 0),JA=d([A("esri.views.interactive.sketch.SketchLabelOptions")],JA);const Tve=JA;let EI=class extends he{constructor(e){super(e),this.mode="absolute-height"}toJSON(){return{mode:this.mode}}};d([p({type:String,nonNullable:!0})],EI.prototype,"mode",void 0),EI=d([A("esri.widgets.Sketch.SketchTooltipOptions.ElevationOptions")],EI);let ua=class extends he{constructor(){super(...arguments),this.distance=!0,this.elevation=!0,this.size=!0,this.scale=!0,this.rotation=!0,this.orientation=!0,this.totalLength=!0,this.area=!0,this.radius=!0,this.helpMessage=!1}toJSON(){return{distance:this.distance,size:this.size,scale:this.scale,rotation:this.rotation,orientation:this.orientation,totalLength:this.totalLength,area:this.area,radius:this.radius}}};d([p({type:Boolean,nonNullable:!0})],ua.prototype,"distance",void 0),d([p({type:Boolean,nonNullable:!0})],ua.prototype,"elevation",void 0),d([p({type:Boolean,nonNullable:!0})],ua.prototype,"size",void 0),d([p({type:Boolean,nonNullable:!0})],ua.prototype,"scale",void 0),d([p({type:Boolean,nonNullable:!0})],ua.prototype,"rotation",void 0),d([p({type:Boolean,nonNullable:!0})],ua.prototype,"orientation",void 0),d([p({type:Boolean,nonNullable:!0})],ua.prototype,"totalLength",void 0),d([p({type:Boolean,nonNullable:!0})],ua.prototype,"area",void 0),d([p({type:Boolean,nonNullable:!0})],ua.prototype,"radius",void 0),d([p({type:Boolean,nonNullable:!0})],ua.prototype,"helpMessage",void 0),ua=d([A("esri.widgets.Sketch.SketchTooltipOptions.VisibleElements")],ua);let c0=class extends he{constructor(e){super(e),this.enabled=!1,this.elevation=new EI,this.visibleElements=new ua,this.visualVariables=null}toJSON(){return{enabled:this.enabled,elevation:this.elevation,visibleElements:this.visibleElements}}};d([p({type:Boolean,nonNullable:!0})],c0.prototype,"enabled",void 0),d([p({type:EI,nonNullable:!0})],c0.prototype,"elevation",void 0),d([p({type:ua,nonNullable:!0})],c0.prototype,"visibleElements",void 0),d([p()],c0.prototype,"visualVariables",void 0),c0=d([A("esri.widgets.Sketch.SketchTooltipOptions")],c0);const Cve=c0;let pu=class extends te{constructor(){super(...arguments),this.enabled=!0}};d([p({type:Boolean})],pu.prototype,"enabled",void 0),pu=d([A("esri.views.interactive.snapping.Settings.DefaultSnappingAlgorithm")],pu);let Zi=class extends te{constructor(e){super(e),this.lineSnapper=new pu,this.parallelLineSnapper=new pu,this.rightAngleSnapper=new pu,this.rightAngleTriangleSnapper=new pu,this.shortLineThreshold=15,this.distance=5,this.pointThreshold=1e-6,this.intersectionParallelLineThreshold=1e-6,this.parallelLineThreshold=1e-6,this.verticalLineThreshold=.1,this.touchSensitivityMultiplier=1.5,this.pointOnLineThreshold=1e-6,this.orange=new ce([255,127,0]),this.orangeTransparent=new ce([255,127,0,.5]),this.lineHintWidthReference=3,this.lineHintWidthTarget=3,this.lineHintFadedExtensions=.3,this.parallelLineHintWidth=2,this.parallelLineHintLength=24,this.parallelLineHintOffset=1.5,this.rightAngleHintSize=24,this.rightAngleHintOutlineSize=1.5,this.satisfiesConstraintScreenThreshold=1}};d([p({type:pu,constructOnly:!0,nonNullable:!0,json:{write:!0}})],Zi.prototype,"lineSnapper",void 0),d([p({type:pu,constructOnly:!0,nonNullable:!0,json:{write:!0}})],Zi.prototype,"parallelLineSnapper",void 0),d([p({type:pu,constructOnly:!0,nonNullable:!0,json:{write:!0}})],Zi.prototype,"rightAngleSnapper",void 0),d([p({type:pu,constructOnly:!0,nonNullable:!0,json:{write:!0}})],Zi.prototype,"rightAngleTriangleSnapper",void 0),d([p({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],Zi.prototype,"shortLineThreshold",void 0),d([p({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],Zi.prototype,"distance",void 0),d([p({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],Zi.prototype,"pointThreshold",void 0),d([p({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],Zi.prototype,"intersectionParallelLineThreshold",void 0),d([p({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],Zi.prototype,"parallelLineThreshold",void 0),d([p({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],Zi.prototype,"verticalLineThreshold",void 0),d([p({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],Zi.prototype,"touchSensitivityMultiplier",void 0),d([p({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],Zi.prototype,"pointOnLineThreshold",void 0),d([p({type:ce,nonNullable:!0})],Zi.prototype,"orange",void 0),d([p({type:ce,nonNullable:!0})],Zi.prototype,"orangeTransparent",void 0),d([p({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],Zi.prototype,"lineHintWidthReference",void 0),d([p({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],Zi.prototype,"lineHintWidthTarget",void 0),d([p({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],Zi.prototype,"lineHintFadedExtensions",void 0),d([p({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],Zi.prototype,"parallelLineHintWidth",void 0),d([p({type:Number,nonNullable:!0,range:{min:0,max:50},json:{write:!0}})],Zi.prototype,"parallelLineHintLength",void 0),d([p({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],Zi.prototype,"parallelLineHintOffset",void 0),d([p({type:Number,nonNullable:!0,range:{min:0,max:46},json:{write:!0}})],Zi.prototype,"rightAngleHintSize",void 0),d([p({type:Number,nonNullable:!0,range:{min:0,max:6},json:{write:!0}})],Zi.prototype,"rightAngleHintOutlineSize",void 0),d([p({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],Zi.prototype,"satisfiesConstraintScreenThreshold",void 0),Zi=d([A("esri.views.interactive.snapping.Settings.Defaults")],Zi);const mp=new Zi;var ps;(function(t){t[t.FEATURE=1]="FEATURE",t[t.SELF=2]="SELF",t[t.ALL=3]="ALL"})(ps||(ps={}));let k2t=class{constructor(e,i,r){this.uid=e,this.geometry=i,this.attributes=r,this.visible=!0,this.objectId=null,this.centroid=null}};function O2t(t){return t.geometry!=null}let L2t=class{constructor(){this.exceededTransferLimit=!1,this.features=[],this.fields=[],this.hasM=!1,this.hasZ=!1,this.geometryType=null,this.objectIdFieldName=null,this.globalIdFieldName=null,this.geometryProperties=null,this.geohashFieldName=null,this.spatialReference=null,this.transform=null}};function fv(t,e,i,r){return{x:t,y:e,z:i,hasZ:i!=null,hasM:!1,spatialReference:r,type:"point"}}function F2t(t){if(t==null)return 0;switch(t.type){case"point":return 1;case"polyline":{let e=0;for(const i of t.paths)e+=i.length;return e}case"polygon":{let e=0;for(const i of t.rings)e+=i.length;return e}case"multipoint":return t.points.length;case"extent":return 2;case"mesh":{const e=t.vertexAttributes&&t.vertexAttributes.position;return e?e.length/3:0}default:return}}function D2t(t,e){switch(vAe(e),t.type==="mesh"&&(t=t.extent),t.type){case"point":e[0]=e[3]=t.x,e[1]=e[4]=t.y,t.hasZ&&(e[2]=e[5]=t.z);break;case"polyline":for(let i=0;i<t.paths.length;i++)A3(e,t.paths[i],!!t.hasZ);break;case"polygon":for(let i=0;i<t.rings.length;i++)A3(e,t.rings[i],!!t.hasZ);break;case"multipoint":A3(e,t.points,!!t.hasZ);break;case"extent":e[0]=t.xmin,e[1]=t.ymin,e[3]=t.xmax,e[4]=t.ymax,t.zmin!=null&&(e[2]=t.zmin),t.zmax!=null&&(e[5]=t.zmax)}}function N2t(t,e){switch(OCe(e),t.type==="mesh"&&(t=t.extent),t.type){case"point":e[0]=e[2]=t.x,e[1]=e[3]=t.y;break;case"polyline":for(let i=0;i<t.paths.length;i++)v3(e,t.paths[i]);break;case"polygon":for(let i=0;i<t.rings.length;i++)v3(e,t.rings[i]);break;case"multipoint":v3(e,t.points);break;case"extent":e[0]=t.xmin,e[1]=t.ymin,e[2]=t.xmax,e[3]=t.ymax}}function V2t(t,e){return t.objectId!=null?t.objectId:t.attributes&&e?t.attributes[e]:null}function z2t(t){return t}function Eve(t){return Ls(t)}function j2t(t,e,i){return en(t,e,i)}function Ki(t,e,i){return t==null?null:E2(i.coordinateHelper.vectorToDehydratedPoint(t,Frt),e,i)}function E2(t,e,i){if(t==null)return null;if(e==null)return en(t.x,t.y,t.z??0);if(e.type==="2d")return en(t.x,t.y,0);const{elevationInfo:r}=i,n=KQe(e,t,r,rn)??0;return en(t.x,t.y,n)}function xee(t,e,{z:i,m:r,spatialReference:n,elevationInfo:s}){if(i==null&&r==null){const l=fv(t[0],t[1],void 0,n);return r!=null&&(l.m=r,l.hasM=!0),l}if(e==null||e.type==="2d"){const l=fv(t[0],t[1],i,n);return r!=null&&(l.m=r,l.hasM=!0),l}const o=f0e(e,t,n,rn,s)??0,a=fv(t[0],t[1],o,n);return r!=null&&(a.m=r,a.hasM=!0),a}function B2t(t,e){return fv(t[0],t[1],t[2],e)}const Frt=fv(0,0,0,null);function LF(t,e){return t[0]*e[1]-t[1]*e[0]}function Drt(t,e,i){const r=Tg(i,e)/ug(i);return K1(t,i,r)}function RF(t,e,i,r,n=i){return $n(Uw,r,i),$n(A8,e,n),Drt(wO,A8,Uw),jU(t,n,wO)}function Nrt(t,e,i,r){$n(Uw,e,i);const n=r/h1(Uw);return ap(t,i,Uw,n)}function U2t(t,e){const i=t.start,r=t.end,n=e.start,s=e.end,o=$n(Uw,r,i),a=$n(zrt,s,n),l=LF(o,a);if(Math.abs(l)<=Vrt)return[];const c=$n(A8,i,n),u=LF(a,c)/l,h=LF(o,c)/l;if(u>=0){if(h>=0||e.type===An.LINE)return[ap(wO,i,o,u)]}else if(t.type===An.LINE&&(h>=0||e.type===An.LINE))return[ap(wO,i,o,u)];return[]}var An;(function(t){t[t.RAY=0]="RAY",t[t.LINE=1]="LINE"})(An||(An={}));const Vrt=1e-6,Uw=Gt(),zrt=Gt(),A8=Gt(),wO=Gt();function k8({start:t,end:e,type:i},r,n){const s=[],o=$n(Qv,e,t),a=$n(ax,t,r),l=ug(o),c=2*Tg(o,a),u=c*c-4*l*(ug(a)-n*n);if(u===0){const h=-c/(2*l);(i===wu.PLANE||h>=0)&&s.push(ap(Gt(),t,o,h))}else if(u>0){const h=Math.sqrt(u),f=(-c+h)/(2*l);(i===wu.PLANE||f>=0)&&s.push(ap(Gt(),t,o,f));const m=(-c-h)/(2*l);(i===wu.PLANE||m>=0)&&s.push(ap(Gt(),t,o,m))}return s}function P8(t,e){const i=t.start,r=t.end,n=$n(Qv,r,i),s=Bi(ax,-n[1],n[0],0),o=e.start,a=e.end,l=Xa(M7,a,o),c=Mt(l,s),u=Bi(kve,i[0],i[1],0),h=Xa(Pve,u,o),f=Mt(h,s);if(Math.abs(c)<fu)return[];const m=Wm(Ove,o,l,f/c);if(e.type===An.RAY){const g=Xa(SO,m,o);if(Mt(g,l)<-fu)return[]}if(t.type===wu.HALF_PLANE){const g=TL(SO,m,i);if(Tg(g,n)<-fu)return[]}return[Ls(m)]}function O8(t,e){return L8(xO($7,e[2],t),e)}function Mve(t,e){const r=Ave(xO($7,0,t),xO(Urt,0,e)),n=[];for(const s of r)n.push(cue(s));return n}function $ve(t,e){return E7(t,xO($7,t[2],e))}function jrt(t,e,i){const r=$n(Qv,t,e),n=i/h1(r),s=ap(Me(),e,r,n);return s[2]=t[2],s}function E7(t,{start:e,end:i,type:r}){const n=Xa(Qv,t,e),s=Xa(ax,i,e),o=Mt(n,s)/Mt(s,s);return Wm(Me(),e,s,r===An.RAY?Math.max(o,0):o)}function See({start:t,end:e,type:i},r,n){const s=[],o=Ui(Qv,e,t),a=$n(ax,t,r),l=ug(o),c=2*Tg(o,a),u=c*c-4*l*(ug(a)-n*n);if(u===0){const h=-c/(2*l);(i===An.LINE||h>=0)&&s.push(Wm(Me(),t,o,h))}else if(u>0){const h=Math.sqrt(u),f=(-c+h)/(2*l);(i===An.LINE||f>=0)&&s.push(Wm(Me(),t,o,f));const m=(-c-h)/(2*l);(i===An.LINE||m>=0)&&s.push(Wm(Me(),t,o,m))}return s}function Ave(t,e){const i=t.start,r=t.end,n=e.start,s=e.end,o=Xa(Qv,r,i),a=Xa(ax,s,n),l=Xa(M7,n,i),c=No(kve,o,a),u=Mt(l,c);if(!Cw(u,0,fu))return[];const h=qk(c);if(Cw(h,0,fu))return[];const f=No(Pve,l,a),m=Mt(f,c)/h,g=Wm(Ove,i,o,m);if(t.type===An.RAY){const y=Xa(SO,g,i);if(Mt(o,y)<-fu)return[]}if(e.type===An.RAY){const y=Xa(SO,g,n);if(Mt(a,y)<-fu)return[]}return[Ls(g)]}function L8({start:t,end:e,type:i},r){const n=Xa(Qv,r,t),s=Xa(ax,e,t),o=No(M7,s,n);if(qk(o)/qk(s)<fu)switch(i){case An.LINE:return[Ls(r)];case An.RAY:return Mt(s,n)<-fu?[]:[Ls(r)]}return[]}function Iee(t,e,i){return Cw($u(i,t),e*e,fu)?[Ls(i)]:[]}function xO(t,e,{start:i,end:r,type:n}){return Bi(t.start,i[0],i[1],e),Bi(t.end,r[0],r[1],e),t.type=Brt[n],t}var wu;(function(t){t[t.PLANE=0]="PLANE",t[t.HALF_PLANE=1]="HALF_PLANE"})(wu||(wu={}));const Brt={[wu.PLANE]:An.LINE,[wu.HALF_PLANE]:An.RAY},fu=1e-6,Qv=Me(),ax=Me(),M7=Me(),kve=Me(),Pve=Me(),Ove=Me(),SO=Me(),$7={start:Me(),end:Me(),type:An.LINE},Urt={start:Me(),end:Me(),type:An.LINE};let e_=class{intersect(e){return Wrt(this,e)}},Grt=class extends e_{constructor(e){super(),this.point=e}equals(e){return vw(e)&&Xi(this.point,e.point)}closestTo(){return Eve(this.point)}},Lve=class extends e_{constructor(e,i,r){super(),this.start=e,this.end=i,this.type=r,this.lineLike={start:this.start,end:this.end,type:this.type}}equals(e){return N0(e)&&this.type===e.type&&Xi(this.start,e.start)&&Xi(this.end,e.end)}closestTo(e){const i=E7(e,this.lineLike);return i}},Hrt=class extends Lve{constructor(e,i){super(e,i,An.LINE)}},Rve=class Fve extends e_{constructor(e,i,r){super(),this.intersection=e,this.first=i,this.second=r}equals(e){return e instanceof Fve&&this.first.equals(e.first)&&this.second.equals(e.second)}closestTo(){return Eve(this.intersection)}},FF=class Dve extends e_{constructor(e,i,r){super(),this.basePoint=e,this.first=i,this.second=r}equals(e){return e instanceof Dve&&this.first.equals(e.first)&&this.second.equals(e.second)}closestTo(e){const i=this.basePoint;return en(i[0],i[1],e[2])}},Nve=class extends e_{constructor(e,i){super(),this.center=e,this.radius=i}equals(e){return _w(e)&&this.center[0]===e.center[0]&&this.center[1]===e.center[1]&&this.radius===e.radius}closestTo(e){const i=jrt(e,this.center,this.radius);return i}},A7=class extends e_{constructor(e,i,r){super(),this.start=e,this.end=i,this.type=r,this.planeLike={start:e,end:i,type:r}}equals(e){return V0(e)&&this.type===e.type&&Xi(this.start,e.start)&&Xi(this.end,e.end)}closestTo(e){return $ve(e,this.planeLike)}closestEndTo(e){const{start:i,end:r}=this;return Math.sign(Tg($n(Zrt,r,i),$n(Yrt,e,i)))>0?r:i}},Vve=class extends A7{constructor(e,i){super(e,i,wu.HALF_PLANE)}},zve=class extends A7{constructor(e,i){super(e,i,wu.PLANE)}},jve=class extends e_{constructor(e,i,r){super(),this.start=e,this.end=i,this.getZ=r,this.planeLike={start:e,end:i,type:wu.PLANE}}equals(e){return z0(e)&&Xi(this.start,e.start)&&Xi(this.end,e.end)&&this.getZ===e.getZ}closestTo(e){return qrt(this,e)}addIfOnTheGround(e,i){for(const r of i){const n=this.getZ(r[0],r[1],r[2])??0;Math.abs(r[2]-n)<fu&&(r[2]=n,e.push(r))}}};function qrt(t,e){const i=$ve(e,t.planeLike);return i[2]=t.getZ(e[0],e[1],e[2])??Bve,i}function Wrt(t,e){let i=[];if(vw(t)){const{point:r}=t;N0(e)?i=L8(e.lineLike,r):_w(e)?i=Iee(e.center,e.radius,r):V0(e)?i=O8(e.planeLike,r):z0(e)&&(i=eS(e,t))}else if(N0(t)){const{lineLike:r}=t;vw(e)?i=L8(r,e.point):N0(e)?i=Ave(r,e.lineLike):_w(e)?i=See(r,e.center,e.radius):V0(e)?i=P8(e.planeLike,r):z0(e)&&(i=eS(e,t))}else if(_w(t)){const{center:r,radius:n}=t;if(N0(e))i=See(e.lineLike,r,n);else if(vw(e))i=Iee(r,n,e.point);else{if(V0(e))return k8(e.planeLike,r,n).map(s=>new FF(s,t,e));z0(e)&&(i=eS(e,t))}}else if(V0(t)){const{planeLike:r}=t;if(V0(e))return Mve(r,e.planeLike).map(n=>new FF(n,t,e));if(vw(e))i=O8(r,e.point);else if(N0(e))i=P8(r,e.lineLike);else{if(_w(e))return k8(r,e.center,e.radius).map(n=>new FF(n,t,e));z0(e)&&(i=eS(e,t))}}else z0(t)&&(i=eS(t,e));return Jrt(i,t,e)}function eS(t,e){const{planeLike:i,getZ:r}=t,n=[];if(vw(e))t.addIfOnTheGround(n,O8(i,e.point));else if(N0(e))t.addIfOnTheGround(n,P8(i,e.lineLike));else if(_w(e))for(const[s,o]of k8(i,e.center,e.radius)){const a=r(s,o,0);a!=null&&n.push(en(s,o,a))}else if(V0(e)||z0(e))for(const[s,o]of Mve(i,e.planeLike)){const a=r(s,o,0)??Bve;n.push(en(s,o,a))}return n}function Jrt(t,e,i){return t.map(r=>new Rve(r,e,i))}function vw(t){return t instanceof Grt}function N0(t){return t instanceof Lve}function _w(t){return t instanceof Nve}function V0(t){return t instanceof A7}function z0(t){return t instanceof jve}const Zrt=Gt(),Yrt=Gt(),Bve=0;function t_(t,e){const i=t.x-e.x,r=t.y-e.y;return i*i+r*r}function Krt(t,e){return Math.sqrt(t_(t,e))}function k7(t,e){e.sort((i,r)=>bp(i.targetPoint,t)-bp(r.targetPoint,t))}var dc;function Q2t({point:t,distance:e,returnEdge:i,returnVertex:r,coordinateHelper:{spatialReference:n}},s,o){return{point:fv(t[0],t[1],t[2],n.toJSON()),mode:s,distance:e,returnEdge:i,returnVertex:r,query:o!=null?o.toJSON():{where:"1=1"}}}function IO(t,e,i){return{left:Ki(t.leftVertex.pos,e,i),right:Ki(t.rightVertex.pos,e,i)}}function eIt(t){return t.createQuery()}function Xrt(t,e=()=>{}){const i=J(()=>({view:t.view,snappingOptions:t.snappingOptions}),({view:r,snappingOptions:n})=>{const s="snapping-toggle",o=Pi.TOOL;if(t.removeHandles(s),r&&n!=null){const a=[r.on("key-down",l=>{l.key!==wee.toggle||l.repeat||(n.enabledToggled=!0,e())},o),r.on("key-up",l=>{l.key===wee.toggle&&(n.enabledToggled=!1,e())},o),r.on("pointer-move",l=>{const c=l.native.ctrlKey;n.enabledToggled!==c&&(n.enabledToggled=c,e())},o)];t.addHandles(a,s)}},ji);t.addHandles(i)}(function(t){t[t.TARGET=0]="TARGET",t[t.REFERENCE=1]="REFERENCE",t[t.REFERENCE_EXTENSION=2]="REFERENCE_EXTENSION"})(dc||(dc={}));let lx=class{constructor(e,i,r,n){this.targetPoint=e,this.constraint=i,this.isDraped=r,this.domain=n}},P7=class extends lx{constructor({targetPoint:e,objectId:i,constraint:r,isDraped:n}){super(e,r,n,ps.FEATURE),this.objectId=i}},AR=class{constructor(e,i){this.isDraped=e,this.domain=i}},qd=class Uve extends AR{constructor(e,i,r,n,s=ps.ALL,o=!0,a=!0){super(n,s),this.type=e,this.lineStart=i,this.lineEnd=r,this.fadeLeft=o,this.fadeRight=a}equals(e){return e instanceof Uve&&this.type===e.type&&Xi(this.lineStart,e.lineStart)&&Xi(this.lineEnd,e.lineEnd)&&this.fadeLeft===e.fadeLeft&&this.fadeRight===e.fadeRight}get length(){return N1(this.lineStart,this.lineEnd)}},Qrt=class extends P7{constructor(e){super({...e,isDraped:!0,constraint:new jve(e.edgeStart,e.edgeEnd,e.getGroundElevation)})}get hints(){return[new qd(dc.REFERENCE,this.constraint.start,this.constraint.end,this.isDraped,this.domain)]}},ent=class extends P7{constructor(e){super({...e,constraint:new Hrt(e.edgeStart,e.edgeEnd)})}get hints(){return[new qd(dc.REFERENCE,this.constraint.start,this.constraint.end,this.isDraped,this.domain)]}},Gve=class Hve extends AR{constructor(e,i,r,n,s=ps.ALL){super(n,s),this.previousVertex=e,this.centerVertex=i,this.nextVertex=r}equals(e){return e instanceof Hve&&Xi(this.previousVertex,e.previousVertex)&&Xi(this.centerVertex,e.centerVertex)&&Xi(this.nextVertex,e.nextVertex)}},qve=class extends lx{constructor({targetPoint:e,constraint:i,previousVertex:r,otherVertex:n,otherVertexType:s,objectId:o,isDraped:a}){super(e,i,a,ps.SELF),this.previousVertex=r,this.otherVertex=n,this.otherVertexType=s,this.objectId=o}get hints(){const e=this.previousVertex,i=this.otherVertexType===E1.CENTER?this.otherVertex:this.targetPoint,r=this.otherVertexType===E1.CENTER?this.targetPoint:this.otherVertex;return[new qd(dc.TARGET,i,r,this.isDraped,this.domain),new qd(dc.REFERENCE,e,i,this.isDraped,this.domain),new Gve(this.previousVertex,i,r,this.isDraped,this.domain)]}};var E1;(function(t){t[t.NEXT=0]="NEXT",t[t.CENTER=1]="CENTER"})(E1||(E1={}));function tnt(t,e,i,r,n=Me()){const s=bi(R8,t);return s[2]=f0e(r,s,e,i)||0,r.renderCoordsHelper.toRenderCoords(s,e,n),n}function uo(t,e,i,r){return r.type==="2d"?(HM.x=t[0],HM.y=t[1],HM.spatialReference=e,r.toScreen(HM)):(tnt(t,e,i,r,R8),r.state.camera.projectToScreen(R8,DF),so(DF[0],DF[1]))}const HM=fv(0,0,0,null),R8=Me(),DF=Q$e();let Xf=class extends l1{get updating(){return QT(this.snappingSources,({snappingSource:e})=>e.updating)||this.updatingHandles.updating}get snappingSources(){const e=this._get("snappingSources")||new Map,i=new Map;if(this.options!=null&&this.options.featureSources!=null)for(const r of this.options.featureSources.items){const n=r.layer.uid,s=e.get(n);if(s){e.delete(n),i.set(n,s);continue}if(!r.layer.loaded){this.updatingHandles.addPromise(r.layer.load());continue}const o=this._createSourceInfo(r);o!=null&&i.set(n,o)}for(const[,r]of e)r.destroy();return i}constructor(e){super(e),this.options=null,this._domain=ps.FEATURE,this._sourceModules={featureService:{module:null,loader:null},featureCollection:{module:null,loader:null},graphics:{module:null,loader:null},notes:{module:null,loader:null},scene:{module:null,loader:null}}}initialize(){this.updatingHandles.add(()=>this.snappingSources,()=>this.notifyChange("updating"),Ca),this.view!=null&&this.handles.add([this.view.on("layerview-create",e=>this._updateLayerView(e.layer,e.layerView)),this.view.on("layerview-destroy",e=>this._updateLayerView(e.layer,null))])}_updateLayerView(e,i){for(const[,r]of this.snappingSources)r.snappingSource.layerSource.layer===e&&(r.layerView=i)}destroy(){this._set("options",null);for(const[,e]of this.snappingSources)e.destroy()}async fetchCandidates(e,i,r,n){var c;if(!(i&this._domain&&this.options!=null&&this.options.effectiveFeatureEnabled))return[];const s=[],o=this._computeScreenSizeDistanceParameters(e,r),a={distance:o,mode:((c=this.view)==null?void 0:c.type)??"2d",point:e,coordinateHelper:r.coordinateHelper,...this._types};for(const[,{snappingSource:u,layerView:h}]of this.snappingSources)!u.layerSource.enabled||h!=null&&h.suspended||s.push(u.fetchCandidates(a,n).then(f=>f.filter(m=>!this._candidateIsExcluded(u,m,r.excludeFeature))));const l=(await tne(s)).flat();return this._addRightAngleCandidates(l,e,o,r),_t(n),k7(e,l),l}_addRightAngleCandidates(e,i,r,n){var h,f,m,g,y,v,b,w;const s=n.vertexHandle!=null?(f=(h=n.vertexHandle.rightEdge)==null?void 0:h.rightVertex)==null?void 0:f.pos:n.editGeometryOperations!=null&&n.editGeometryOperations.data.type==="polygon"?(g=(m=n.editGeometryOperations.data.components[0])==null?void 0:m.getFirstVertex())==null?void 0:g.pos:null,o=n.vertexHandle!=null?(v=(y=n.vertexHandle.leftEdge)==null?void 0:y.leftVertex)==null?void 0:v.pos:n.editGeometryOperations!=null?(w=(b=n.editGeometryOperations.data.components[0])==null?void 0:b.getLastVertex())==null?void 0:w.pos:null,{view:a}=this,l=Ki(s,a,n),c=Ki(o,a,n),u=e.length;for(let x=0;x<u;x++)this._addRightAngleCandidate(e[x],c,i,r,e),this._addRightAngleCandidate(e[x],l,i,r,e)}_addRightAngleCandidate(e,i,r,n,s){if(i==null||!rnt(e))return;const o=e.constraint.closestTo(i),a=(o[0]-r[0])/n.x,l=(o[1]-r[1])/n.y,{start:c,end:u}=e.constraint;if(a*a+l*l<=1){const h=new qve({targetPoint:o,otherVertex:i,otherVertexType:E1.NEXT,previousVertex:$u(o,c)>$u(o,u)?c:u,constraint:new Vve(i,o),objectId:e.objectId,isDraped:e.isDraped});s.push(h)}}_computeScreenSizeDistanceParameters(e,i){let r=this.options!=null?this.options.distance*(i.pointer==="touch"?this.options.touchSensitivityMultiplier:1):0;return this.view==null?{x:r,y:r,z:r,distance:r}:this.view.type==="2d"?(r*=this.view.resolution,{x:r,y:r,z:r,distance:r}):this._computeScreenSizeDistanceParameters3D(e,r,this.view,i)}_computeScreenSizeDistanceParameters3D(e,i,r,n){const{spatialReference:s}=n;r.renderCoordsHelper.toRenderCoords(e,s,Tee);const o=r.state.camera.computeScreenPixelSizeAt(Tee),a=o*r.renderCoordsHelper.unitInMeters/r.mapCoordsHelper.unitInMeters,l=i*a,c=uo(e,s,rn,r),u=c?NF(c,e,a,0,0,r,n):0,h=c?NF(c,e,0,a,0,r,n):0,f=c?NF(c,e,0,0,a,r,n):0;return{x:u===0?0:l/u,y:h===0?0:l/h,z:f===0?0:l/f,distance:o*i}}get _types(){return{returnEdge:!0,returnVertex:!0}}_candidateIsExcluded(e,i,r){if(r==null)return!1;const n=this._getCandidateObjectId(i);if(n==null)return!1;const s=e.layerSource.layer;return s.type==="graphics"?r.uid===n:r.sourceLayer===s&&!(!r.attributes||!("objectIdField"in s))&&r.attributes[s.objectIdField]===n}_getCandidateObjectId(e){return e instanceof P7?e.objectId:null}_createSourceInfo(e){const i=this._createFeatureSnappingSourceType(e);if(i==null)return null;if("loading"in i)return this.updatingHandles.addPromise(i.loading.then(()=>{this.destroyed||this.notifyChange("snappingSources")})),null;const r=this.view!=null?this.view.allLayerViews.find(n=>n.layer===e.layer):null;return new int(i.source,r)}_createFeatureSnappingSourceType(e){switch(e.layer.type){case"feature":case"geojson":case"csv":case"oriented-imagery":case"subtype-group":case"wfs":return this._createFeatureSnappingSourceFeatureLayer(e);case"graphics":return this._createFeatureSnappingSourceGraphicsLayer(e);case"map-notes":return this._createFeatureSnappingSourceMapNotesLayer(e);case"scene":case"building-scene":return this._createFeatureSnappingSourceSceneLayer(e)}return null}_createFeatureSnappingSourceSceneLayer(e){const{view:i}=this;if(i==null||i.type!=="3d")return null;const r=this._getSourceModule("scene");return r.module!=null?{source:new r.module.SceneLayerSnappingSource({layerSource:e,view:i})}:{loading:r.loader}}_createFeatureSnappingSourceFeatureLayer(e){var i;switch((i=e.layer.source)==null?void 0:i.type){case"feature-layer":case"oriented-imagery":{const r=this._getSourceModule("featureService");return r.module!=null?{source:new r.module.FeatureServiceSnappingSource({spatialReference:this.spatialReference,view:this.view,layerSource:e})}:{loading:r.loader}}case"memory":case"csv":case"geojson":case"wfs":{if(e.layer.geometryType==="mesh")return null;const r=this._getSourceModule("featureCollection");return r.module!=null?{source:new r.module.FeatureCollectionSnappingSource({layerSource:e,view:this.view})}:{loading:r.loader}}}return null}_createFeatureSnappingSourceGraphicsLayer(e){const i=this._getSourceModule("graphics");return i.module!=null?{source:new i.module.GraphicsSnappingSource({getGraphicsLayers:()=>[e.layer],spatialReference:this.spatialReference,view:this.view,layerSource:e})}:{loading:i.loader}}_createFeatureSnappingSourceMapNotesLayer(e){const i=this._getSourceModule("notes");return i.module!=null?{source:new i.module.GraphicsSnappingSource({getGraphicsLayers:()=>e.layer.sublayers!=null?e.layer.sublayers.toArray():[],spatialReference:this.spatialReference,view:this.view,layerSource:e})}:{loading:i.loader}}_getSourceModule(e){const i=this._sourceModules[e];if(i.loader==null){const r=this._loadSourceModule(e).then(n=>{i.module=n});return i.loader=r,{module:i.module,loader:r}}return{module:i.module,loader:i.loader}}_loadSourceModule(e){const i=this.updatingHandles;switch(e){case"featureService":return i.addPromise(W(()=>import("./FeatureServiceSnappingSource-a05f7ada.js"),["./FeatureServiceSnappingSource-a05f7ada.js","./queryEngineUtils-47a4d279.js","./VertexSnappingCandidate-56c98654.js","./PointSnappingHint-ebe1c1f7.js","./WorkerHandle-51c271c4.js"],import.meta.url));case"featureCollection":return i.addPromise(W(()=>import("./FeatureCollectionSnappingSource-be28c1e8.js"),["./FeatureCollectionSnappingSource-be28c1e8.js","./queryEngineUtils-47a4d279.js","./VertexSnappingCandidate-56c98654.js","./PointSnappingHint-ebe1c1f7.js","./symbologySnappingCandidates-02eb0246.js"],import.meta.url));case"graphics":case"notes":return i.addPromise(W(()=>import("./GraphicsSnappingSource-02ed8aa5.js"),["./GraphicsSnappingSource-02ed8aa5.js","./normalizeUtilsSync-fc897fcb.js","./featureConversionUtils-bafaa402.js","./OptimizedFeature-4701473b.js","./OptimizedFeatureSet-1d1ac4b9.js","./OptimizedGeometry-196224d4.js","./FeatureStore-3ba5cfda.js","./BoundsStore-e82b0770.js","./PooledRBush-312cce69.js","./optimizedFeatureQueryEngineAdapter-2fa61fa1.js","./centroid-8e8cfa47.js","./timeSupport-02e20fc8.js","./projectionSupport-66f9e6bd.js","./json-48e3ea08.js","./QueryEngine-85c46ff8.js","./WhereClause-0a50ffa9.js","./quantizationUtils-533107d2.js","./utils-fddd1fce.js","./SnappingCandidate-970faec6.js","./queryEngineUtils-47a4d279.js","./VertexSnappingCandidate-56c98654.js","./PointSnappingHint-ebe1c1f7.js","./symbologySnappingCandidates-02eb0246.js"],import.meta.url));case"scene":return i.addPromise(W(()=>import("./SceneLayerSnappingSource-1ac228cd.js"),["./SceneLayerSnappingSource-1ac228cd.js","./WorkerHandle-51c271c4.js","./workerHelper-32b5e72c.js","./InterleavedLayout-dee9d785.js","./BufferView-82913510.js","./types-1305598a.js","./edgeProcessing-a6e41f6a.js","./deduplicate-58dc069a.js","./Indices-e7e8209a.js","./glUtil-0b7ee6ea.js","./enums-b14466b3.js","./VertexElementDescriptor-2925c6af.js","./VertexSnappingCandidate-56c98654.js","./PointSnappingHint-ebe1c1f7.js"],import.meta.url))}}};d([p({constructOnly:!0})],Xf.prototype,"spatialReference",void 0),d([p({constructOnly:!0})],Xf.prototype,"view",void 0),d([p()],Xf.prototype,"options",void 0),d([p({readOnly:!0})],Xf.prototype,"updating",null),d([p({readOnly:!0})],Xf.prototype,"snappingSources",null),Xf=d([A("esri.views.interactive.snapping.FeatureSnappingEngine")],Xf);let int=class{constructor(e,i){this.snappingSource=e,this.layerView=i,this.handles=new gs;const r=this.snappingSource.layerSource.layer;if("refresh"in r){const n=r;this.handles.add(n.on("refresh",()=>e.refresh()))}this.handles.add([J(()=>e.updating,n=>e.layerSource.updating=n,ji),J(()=>e.availability,n=>e.layerSource.availability=n,ji)])}destroy(){this.snappingSource.destroy(),this.handles.destroy()}};function rnt(t){return(t instanceof ent||t instanceof Qrt)&&!nnt(t)}function nnt({constraint:{start:t,end:e}}){const i=bp(t,e),r=$u(t,e);return i<Bo()||r/i<ont}function NF(t,e,i,r,n,s,{spatialReference:o}){const a=bi(snt,e);a[0]+=i,a[1]+=r,a[2]+=n;const l=uo(a,o,rn,s);return l?Krt(l,t):1/0}const Tee=Me(),snt=Me(),ont=1e-4;let kR=class{constructor(e,i){this.view=e,this.options=i,this.squaredShortLineThreshold=mp.shortLineThreshold*mp.shortLineThreshold}snap(e,i){return i.vertexHandle!=null?i.vertexHandle.type!=="vertex"?[]:this.snapExistingVertex(e,i):this.snapNewVertex(e,i)}edgeExceedsShortLineThreshold(e,i){return this.exceedsShortLineThreshold(Ki(e.leftVertex.pos,this.view,i),Ki(e.rightVertex.pos,this.view,i),i)}exceedsShortLineThreshold(e,i,{spatialReference:r}){return this.squaredShortLineThreshold===0||t_(uo(i,r,rn,this.view),uo(e,r,rn,this.view))>this.squaredShortLineThreshold}isVertical(e,i){return $u(e,i)<mp.verticalLineThreshold}squaredProximityThreshold(e){return e==="touch"?this._squaredTouchProximityThreshold:this._squaredMouseProximityThreshold}get _squaredMouseProximityThreshold(){return this.options.distance*this.options.distance}get _squaredTouchProximityThreshold(){const{distance:e,touchSensitivityMultiplier:i}=this.options,r=e*i;return r*r}},ant=class extends lx{constructor({lineStart:e,lineEnd:i,targetPoint:r,isDraped:n}){super(r,new zve(e,i),n,ps.SELF),this._referenceLineHint=new qd(dc.REFERENCE_EXTENSION,e,i,n,this.domain)}get hints(){return[this._referenceLineHint,new qd(dc.TARGET,this._lineEndClosestToTarget(),this.targetPoint,this.isDraped,this.domain)]}_lineEndClosestToTarget(){return this.constraint.closestEndTo(this.targetPoint)}},lnt=class extends kR{snapNewVertex(e,i){const r=i.editGeometryOperations.data.components[0],n=r.edges.length,s=[];if(n<1)return s;const{spatialReference:o}=i,a=uo(e,o,rn,this.view),{view:l}=this,c=r.edges[n-1];let u=c;do{if(this.edgeExceedsShortLineThreshold(u,i)){const h=IO(u,l,i);this._processCandidateProposal(h.left,h.right,e,a,i,s)}u=u.leftVertex.leftEdge}while(u&&u!==c);return s}snapExistingVertex(e,i){const r=[],n=i.vertexHandle,s=n.component;if(s.edges.length<2)return r;const{view:o}=this,{spatialReference:a}=i,l=uo(e,a,rn,o),c=n.leftEdge,u=n.rightEdge;c&&u&&this.edgeExceedsShortLineThreshold(c,i)&&this.edgeExceedsShortLineThreshold(u,i)&&this._processCandidateProposal(Ki(c.leftVertex.pos,o,i),Ki(u.rightVertex.pos,o,i),e,l,i,r);const h=s.edges[0];let f=h;do{if(f!==n.leftEdge&&f!==n.rightEdge&&this.edgeExceedsShortLineThreshold(f,i)){const m=IO(f,o,i);this._processCandidateProposal(m.left,m.right,e,l,i,r)}f=f.rightVertex.rightEdge}while(f&&f!==h);return r}_processCandidateProposal(e,i,r,n,s,o){var u;const{spatialReference:a,pointer:l}=s,c=E7(r,{start:e,end:i,type:An.LINE});t_(n,uo(c,a,rn,this.view))<this.squaredProximityThreshold(l)&&o.push(new ant({lineStart:e,lineEnd:i,targetPoint:c,isDraped:((u=s.elevationInfo)==null?void 0:u.mode)==="on-the-ground"}))}},cnt=class Wve extends AR{constructor(e,i,r,n=ps.ALL){super(r,n),this.lineStart=e,this.lineEnd=i}equals(e){return e instanceof Wve&&Xi(this.lineStart,e.lineStart)&&Xi(this.lineEnd,e.lineEnd)}},unt=class extends lx{constructor({referenceLine:e,lineStart:i,targetPoint:r,isDraped:n}){const s=Ls(i),{left:o,right:a}=e;Ui(s,Sr(s,s,a),o),super(r,new zve(i,s),n,ps.SELF),this._referenceLines=[{edge:e,fadeLeft:!0,fadeRight:!0}]}get hints(){return[new qd(dc.TARGET,this.constraint.start,this.targetPoint,this.isDraped,this.domain),new cnt(this.constraint.start,this.targetPoint,this.isDraped,this.domain),...this._referenceLines.map(e=>new qd(dc.REFERENCE,e.edge.left,e.edge.right,this.isDraped,this.domain,e.fadeLeft,e.fadeRight))]}addReferenceLine(e){const i={edge:e,fadeLeft:!0,fadeRight:!0};this._referenceLines.forEach(r=>{Xi(e.right,r.edge.left)&&(r.fadeLeft=!1,i.fadeRight=!1),Xi(e.right,r.edge.right)&&(r.fadeRight=!1,i.fadeRight=!1),Xi(e.left,r.edge.right)&&(r.fadeRight=!1,i.fadeLeft=!1),Xi(e.left,r.edge.left)&&(r.fadeLeft=!1,i.fadeLeft=!1)}),this._referenceLines.push(i)}},dnt=class extends kR{snapNewVertex(e,i){const r=i.editGeometryOperations.data.components[0],n=r.edges.length,s=r.vertices.length,o=[];if(n<2)return o;const{view:a}=this,l=uo(e,i.spatialReference,rn,a),c=Ki(r.vertices[s-1].pos,a,i),u=Ki(r.vertices[0].pos,a,i),h=r.edges[n-1];let f=h;do{if(this.edgeExceedsShortLineThreshold(f,i)){const m=IO(f,a,i);this._checkEdgeForParallelLines(m,c,e,l,i,o),this._checkEdgeForParallelLines(m,u,e,l,i,o)}f=f.leftVertex.leftEdge}while(f&&f!==h);return o}snapExistingVertex(e,i){const r=[],n=i.vertexHandle,s=n.component;if(s.edges.length<3)return r;const{view:o}=this,a=uo(e,i.spatialReference,rn,o),l=n.leftEdge,c=n.rightEdge,u=s.vertices[0],h=Ki(u.pos,o,i),f=s.vertices.length,m=s.vertices[f-1],g=Ki(m.pos,o,i),y=s.edges[0];let v=y;do{if(v!==l&&v!==c&&this.edgeExceedsShortLineThreshold(v,i)){const b=IO(v,o,i);l&&this._checkEdgeForParallelLines(b,Ki(l.leftVertex.pos,o,i),e,a,i,r),c&&this._checkEdgeForParallelLines(b,Ki(c.rightVertex.pos,o,i),e,a,i,r),n===u?this._checkEdgeForParallelLines(b,g,e,a,i,r):n===m&&this._checkEdgeForParallelLines(b,h,e,a,i,r)}v=v.rightVertex.rightEdge}while(v&&v!==y);return r}_checkEdgeForParallelLines(e,i,r,n,s,o){var f;const a=e.left,l=e.right;if(RF(Qg,i,a,l),$u(Qg,i)<mp.parallelLineThreshold)return;RF(Qg,r,a,l,i);const{spatialReference:c,pointer:u}=s,h=en(Qg[0],Qg[1],r[2]);if(t_(n,uo(h,c,rn,this.view))<this.squaredProximityThreshold(u)){if(this.isVertical(h,i)||this.isVertical(a,l)||this._parallelToPreviousCandidate(e,o))return;o.push(new unt({referenceLine:e,lineStart:i,targetPoint:h,isDraped:((f=s.elevationInfo)==null?void 0:f.mode)==="on-the-ground"}))}}_parallelToPreviousCandidate(e,i){const r=e.left,n=e.right;for(const s of i)if(RF(Qg,n,s.constraint.start,s.constraint.end,r),$u(Qg,n)<mp.parallelLineThreshold)return s.addReferenceLine(e),!0;return!1}};const Qg=Gt();let hnt=class extends kR{snapNewVertex(e,i){const r=i.editGeometryOperations.data.components[0],n=r.vertices.length,s=[];if(n<2)return s;const{view:o}=this,a=uo(e,i.spatialReference,rn,o),l=r.vertices[n-1];if(this.edgeExceedsShortLineThreshold(l.leftEdge,i)){const u=Ki(l.pos,o,i),h=Ki(l.leftEdge.leftVertex.pos,o,i);this._checkForSnappingCandidate(s,h,u,e,a,i)}const c=r.vertices[0];if(this.edgeExceedsShortLineThreshold(c.rightEdge,i)){const u=Ki(c.pos,o,i),h=Ki(c.rightEdge.rightVertex.pos,o,i);this._checkForSnappingCandidate(s,h,u,e,a,i)}return s}snapExistingVertex(e,i){const r=[],n=i.vertexHandle;if(n.component.vertices.length<3)return r;const{view:s}=this,o=uo(e,i.spatialReference,rn,s),a=n.leftEdge,l=n.rightEdge;if(a&&a.leftVertex.leftEdge){const c=a.leftVertex.leftEdge;if(this.edgeExceedsShortLineThreshold(c,i)){const u=Ki(c.rightVertex.pos,s,i),h=Ki(c.leftVertex.pos,s,i);this._checkForSnappingCandidate(r,h,u,e,o,i)}}if(l&&l.rightVertex.rightEdge){const c=l.rightVertex.rightEdge;if(this.edgeExceedsShortLineThreshold(c,i)){const u=Ki(c.leftVertex.pos,s,i),h=Ki(c.rightVertex.pos,s,i);this._checkForSnappingCandidate(r,h,u,e,o,i)}}return r}_checkForSnappingCandidate(e,i,r,n,s,o){var f;const{spatialReference:a,pointer:l}=o;$n(qM,r,i);const c=Bi(pnt,qM[1],-qM[0],0),u=Tg(c,$n(qM,n,r))/ug(c),h=ap(Ls(n),r,c,u);if(t_(s,uo(h,a,rn,this.view))<this.squaredProximityThreshold(l)){if(this.isVertical(h,r)||this.isVertical(r,i))return;const m=Wm(Me(),r,c,Math.sign(u));e.push(new qve({targetPoint:h,constraint:new Vve(r,m),previousVertex:i,otherVertex:r,otherVertexType:E1.CENTER,isDraped:((f=o.elevationInfo)==null?void 0:f.mode)==="on-the-ground"}))}}};const qM=Gt(),pnt=Me();let fnt=class extends lx{constructor({targetPoint:e,point1:i,point2:r,isDraped:n}){super(e,new Nve(XO(Me(),i,r,.5),.5*Ig(i,r)),n,ps.SELF),this._p1=i,this._p2=r}get hints(){return[new qd(dc.REFERENCE,this.targetPoint,this._p1,this.isDraped,this.domain),new qd(dc.REFERENCE,this.targetPoint,this._p2,this.isDraped,this.domain),new Gve(this._p1,this.targetPoint,this._p2,this.isDraped,this.domain)]}},mnt=class extends kR{snapNewVertex(e,i){const r=i.editGeometryOperations.data.components[0],n=[],s=r.vertices.length;if(i.editGeometryOperations.data.type!=="polygon"||s<2)return n;const{view:o}=this,a=r.vertices[0],l=r.vertices[s-1],c=Ki(a.pos,o,i),u=Ki(l.pos,o,i);return this._processCandidateProposal(c,u,e,i,n),n}snapExistingVertex(e,i){const r=[],n=i.vertexHandle,s=n.component;if(s.edges.length<2||i.editGeometryOperations.data.type==="polyline"&&(n.index===0||n.index===s.vertices.length-1))return r;const{view:o}=this,a=Ki(n.leftEdge.leftVertex.pos,o,i),l=Ki(n.rightEdge.rightVertex.pos,o,i);return this._processCandidateProposal(a,l,e,i,r),r}_processCandidateProposal(e,i,r,n,s){var m;if(!this.exceedsShortLineThreshold(e,i,n))return;const o=BU(gnt,e,i,.5),a=.5*Ig(e,i),l=Me();Nrt(l,r,o,a),l[2]=r[2];const c=l,{spatialReference:u,pointer:h}=n,f=uo(r,u,rn,this.view);if(t_(f,uo(c,u,rn,this.view))<this.squaredProximityThreshold(h)){if(this.isVertical(e,c)||this.isVertical(c,i))return;s.push(new fnt({targetPoint:c,point1:e,point2:i,isDraped:((m=n.elevationInfo)==null?void 0:m.mode)==="on-the-ground"}))}}};const gnt=Gt();let Gb=class extends he{constructor(e){super(e),this.updating=!1,this._snappers=new ye,this._domain=ps.SELF}initialize(){this._snappers.push(new dnt(this.view,this.options),new lnt(this.view,this.options),new hnt(this.view,this.options),new mnt(this.view,this.options))}set options(e){this._set("options",e);for(const i of this._snappers)i.options=e}async fetchCandidates(e,i,r){if(!(i&this._domain&&this.options.effectiveSelfEnabled))return[];const n=[];for(const s of this._snappers.items)for(const o of s.snap(e,r))n.push(o);return k7(e,n),n}};d([p({readOnly:!0})],Gb.prototype,"updating",void 0),d([p({constructOnly:!0})],Gb.prototype,"view",void 0),d([p()],Gb.prototype,"options",null),Gb=d([A("esri.views.interactive.snapping.SelfSnappingEngine")],Gb);function ynt(t,e){return[new Gb({view:t,options:e}),new Xf({view:t,options:e,spatialReference:t.spatialReference})]}let u0=class extends he{constructor(e){super(e),this.layer=null,this.enabled=!0,this.updating=!1,this.availability=1}};d([p({constructOnly:!0})],u0.prototype,"layer",void 0),d([p()],u0.prototype,"enabled",void 0),d([p()],u0.prototype,"updating",void 0),d([p()],u0.prototype,"availability",void 0),u0=d([A("esri.views.interactive.snapping.FeatureSnappingLayerSource")],u0);const O7=u0;let za=class extends he{constructor(e){super(e),this.enabled=!1,this.enabledToggled=!1,this.selfEnabled=!0,this.featureEnabled=!0,this.featureSources=new ye,this.distance=mp.distance,this.touchSensitivityMultiplier=mp.touchSensitivityMultiplier}get effectiveEnabled(){return this.enabledToggled?!this.enabled:this.enabled}get effectiveSelfEnabled(){return this.effectiveEnabled&&this.selfEnabled}get effectiveFeatureEnabled(){return this.effectiveEnabled&&this.featureEnabled}};d([p()],za.prototype,"enabled",void 0),d([p()],za.prototype,"enabledToggled",void 0),d([p()],za.prototype,"selfEnabled",void 0),d([p()],za.prototype,"featureEnabled",void 0),d([p({type:ye.ofType(O7)})],za.prototype,"featureSources",void 0),d([p()],za.prototype,"distance",void 0),d([p()],za.prototype,"touchSensitivityMultiplier",void 0),d([p({readOnly:!0})],za.prototype,"effectiveEnabled",null),d([p({readOnly:!0})],za.prototype,"effectiveSelfEnabled",null),d([p({readOnly:!0})],za.prototype,"effectiveFeatureEnabled",null),za=d([A("esri.views.interactive.snapping.SnappingOptions")],za);const L7=za;let vnt=class Jve extends AR{constructor(e,i,r=ps.ALL){super(i,r),this.intersectionPoint=e}equals(e){return e instanceof Jve&&Xi(this.intersectionPoint,e.intersectionPoint)}},WM=class extends lx{constructor(e,i,r,n){super(e,new Rve(e,i.constraint,r.constraint),n,ps.ALL),this.first=i,this.second=r}get hints(){return this.first.targetPoint=this.targetPoint,this.second.targetPoint=this.targetPoint,[...this.first.hints,...this.second.hints,new vnt(this.targetPoint,this.isDraped,this.domain)]}},qc=class extends an.EventedMixin(l1){constructor(e){super(e),this.options=new L7,this.snappingEnginesFactory=ynt,this._engines=[],this._currentMainCandidate=null,this._currentOtherActiveCandidates=[],this._currentSnappedType=Nh.MAIN}initialize(){this.handles.add([J(()=>{const{effectiveFeatureEnabled:e,effectiveSelfEnabled:i,touchSensitivityMultiplier:r,distance:n}=this.options;return{effectiveFeatureEnabled:e,effectiveSelfEnabled:i,touchSensitivityMultiplier:r,distance:n}},()=>{this.doneSnapping(),this.emit("changed")},Ca),J(()=>this.options,e=>{for(const i of this._engines)i.options=e},Ca),J(()=>({viewReady:this.view.ready,viewSpatialReference:this.view.spatialReference,snappingEnginesFactory:this.snappingEnginesFactory}),({viewReady:e,snappingEnginesFactory:i})=>this._recreateEngines(e,i),ji)])}destroy(){this._destroyEngines()}get updating(){return this._engines.some(e=>e.updating)}_recreateEngines(e,i){if(this._destroyEngines(),!e)return;const{view:r,options:n}=this;this._engines=i(r,n)}_destroyEngines(){for(const e of this._engines)e.destroy();this._engines=[]}get _squaredMouseProximityTreshold(){return this.options.distance*this.options.distance}get _squaredTouchProximityThreshold(){const{distance:e,touchSensitivityMultiplier:i}=this.options,r=e*i;return r*r}get _squaredSatisfiesConstraintThreshold(){return mp.satisfiesConstraintScreenThreshold*mp.satisfiesConstraintScreenThreshold}async snap(e){return _nt(e)?this._snapMultiPoint(e):this._snapSinglePoint(e)}update(e){const{point:i,context:r}=e;this._removeVisualization();const n=this._currentMainCandidate;if(n==null)return i;const s=this._selectUpdateInput(e);if(s==null)return i;const{spatialReference:o}=r,a=Ir(s,o);if(a==null)return i;const{view:l}=this,{elevationInfo:c,visualizer:u}=r,h=[],f=E2(a,l,r),m=n.constraint.closestTo(f);if(!this._arePointsWithinScreenThreshold(f,m,r))return this._resetSnappingState(),i;n.targetPoint=m,h.push(...n.hints);for(const g of this._currentOtherActiveCandidates)g.targetPoint=m,h.push(...g.hints);return u!=null&&this.handles.add(u.draw(h,{spatialReference:o,elevationInfo:bnt(r),view:l,selfSnappingZ:r.selfSnappingZ}),JM),xee(m,l,{z:i.z,m:i.m,spatialReference:i.spatialReference,elevationInfo:c})}doneSnapping(){this._removeVisualization(),this._resetSnappingState()}_selectUpdateInput({point:e,scenePoint:i}){switch(this._currentSnappedType){case Nh.MAIN:return e;case Nh.SCENE:return i}}_resetSnappingState(){this._currentMainCandidate=null,this._currentOtherActiveCandidates=[],this._currentSnappedType=Nh.MAIN}_removeVisualization(){this.handles.remove(JM)}async _snapSinglePoint({point:e,context:i,signal:r}){const{view:n}=this,s=E2(e,n,i),o=await this._fetchCandidates(s,ps.ALL,i,r);return this._createSnapResult(s,Nh.MAIN,o,n,i,{z:e.z,m:e.m,spatialReference:e.spatialReference,elevationInfo:i.elevationInfo},r)}async _snapMultiPoint({point:e,scenePoint:i,context:r,signal:n}){const{view:s}=this,{coordinateHelper:o,spatialReference:a}=r;await cg(i.spatialReference,a);const l=Ir(i,a),c=E2(l,s,r),u=await this._fetchCandidates(c,ps.FEATURE,r,n);if(u.length>0){const m=await this._fetchCandidates(c,ps.SELF,r,n);return this._createSnapResult(c,Nh.SCENE,[...u,...m],s,r,{z:l.z,m:l.m,spatialReference:l.spatialReference,elevationInfo:r.elevationInfo},n)}const h=E2(e,s,r),f=await this._fetchCandidates(h,ps.SELF,r,n);return this._createSnapResult(h,Nh.MAIN,f,s,r,{z:o.hasZ()&&e.hasZ?e.z??0:void 0,m:o.hasM()&&e.hasM?e.m??0:void 0,spatialReference:e.spatialReference,elevationInfo:r.elevationInfo},n)}async _fetchCandidates(e,i,r,n){return(await Promise.all(this._engines.map(s=>s.fetchCandidates(e,i,r,n)))).flat()}_createSnapResult(e,i,r,n,s,o,a){return{get valid(){return!zo(a)},apply:()=>{const{spatialReference:l}=s,{snappedPoint:c,hints:u}=this._processCandidates(e,i,r,s);return this._removeVisualization(),s.visualizer!=null&&this.handles.add(s.visualizer.draw(u,{spatialReference:l,elevationInfo:rn,view:n,selfSnappingZ:s.selfSnappingZ}),JM),xee(c,n,o)}}}_processCandidates(e,i,r,n){if(r.length<1)return this.doneSnapping(),{snappedPoint:e,hints:[]};this._currentSnappedType!==i&&this._resetSnappingState(),k7(e,r);const s=this._currentMainCandidate;if(s!=null){const o=this._findOldConstraintInNewCandidates(s,r);if(o>=0){if(!(r[o]instanceof WM))return this._intersectWithOtherCandidates(o,r,e,i,n);if(this._arePointsWithinScreenThreshold(e,s.targetPoint,n))return this._updateSnappingCandidate(s,i,r,n)}}return this._intersectWithOtherCandidates(0,r,e,i,n)}_findOldConstraintInNewCandidates(e,i){return e instanceof WM?this._findOldCandidateIndex(i,e.first)>=0&&this._findOldCandidateIndex(i,e.second)>=0?0:-1:this._findOldCandidateIndex(i,e)}_intersectWithOtherCandidates(e,i,r,n,s){const{coordinateHelper:o}=s,a=i[e],l=[];for(let c=0;c<i.length;++c){if(c===e)continue;const u=i[c];for(const h of a.constraint.intersect(u.constraint)){const f=h.closestTo(a.targetPoint);l.push([new WM(f,a,u,u.isDraped),this._squaredScreenDistance(r,f,o)])}}return l.length>0&&(l.sort((c,u)=>c[1]-u[1]),l[0][1]<this._squaredPointProximityThreshold(s.pointer))?this._updateSnappingCandidate(l[0][0],n,i,s):this._updateSnappingCandidate(a,n,i,s)}_updateSnappingCandidate(e,i,r,n){this.doneSnapping(),this._currentMainCandidate=e,this._currentSnappedType=i;const s=this._currentMainCandidate.targetPoint,o=[];o.push(...e.hints);for(const a of r){if(e instanceof WM){if(a.constraint.equals(e.first.constraint)||a.constraint.equals(e.second.constraint))continue}else if(a.constraint.equals(e.constraint))continue;const l=a.constraint.closestTo(s);this._squaredScreenDistance(l,s,n.coordinateHelper)<this._squaredSatisfiesConstraintThreshold&&(a.targetPoint=s,this._currentOtherActiveCandidates.push(a),o.push(...a.hints))}return{snappedPoint:s,hints:o}}_squaredPointProximityThreshold(e){return e==="touch"?this._squaredTouchProximityThreshold:this._squaredMouseProximityTreshold}_arePointsWithinScreenThreshold(e,i,r){return this._squaredScreenDistance(e,i,r.coordinateHelper)<this._squaredPointProximityThreshold(r.pointer)}_squaredScreenDistance(e,i,r){return t_(this._toScreen(e,r),this._toScreen(i,r))}_toScreen(e,i){return uo(e,i.spatialReference,rn,this.view)}_findOldCandidateIndex(e,i){let r=-1;for(let n=0;n<e.length;++n)if(i.constraint.equals(e[n].constraint)){r=n;break}return r}get test(){return{visualizationsActive:this.handles.has(JM),engines:this._engines}}};var Nh;d([p({constructOnly:!0})],qc.prototype,"view",void 0),d([p()],qc.prototype,"options",void 0),d([p({readOnly:!0})],qc.prototype,"updating",null),d([p()],qc.prototype,"snappingEnginesFactory",void 0),d([p()],qc.prototype,"_engines",void 0),d([p()],qc.prototype,"_squaredMouseProximityTreshold",null),d([p()],qc.prototype,"_squaredTouchProximityThreshold",null),d([p()],qc.prototype,"_squaredSatisfiesConstraintThreshold",null),qc=d([A("esri.views.interactive.snapping.SnappingManager")],qc),function(t){t[t.MAIN=0]="MAIN",t[t.SCENE=1]="SCENE"}(Nh||(Nh={}));const JM="visualization-handle";function _nt(t){return t.scenePoint!=null}function bnt({coordinateHelper:t,elevationInfo:e}){return t.hasZ()?rn:e}async function wnt(t,e){if(t.type==="2d")return t.hitTest(e);const i=await t.hitTest(e);if(i.results.length===0)return i;const r=(i.results[0].distance??0)*(1+xnt),n=i.results.findIndex(s=>(s.distance??0)>r);return n!==-1&&(i.results=i.results.slice(0,n)),i}const xnt=.05;function Zve(t){return(t==null?void 0:t.type)==="graphic"}function Snt(t){return t.find(Zve)??null}function Yve(t){return t.filter(Zve)}let As=class extends an.EventedAccessor{constructor(e){super(e),this.cancelled=!1,this.history={undo:[],redo:[]},this.type=null}get tool(){if(!this.activeComponent)return null;switch(this.activeComponent.type){case"graphic-mover":case"move-3d":return"move";case"box":case"transform-3d":return"transform";case"reshape":case"reshape-3d":return"reshape";case"draw-2d":case"draw-3d":return this.activeComponent.geometryType;default:this.activeComponent}return null}addToHistory(e){this.history.redo=[],this.history.undo.push(e)}resetHistory(){this.history.redo=[],this.history.undo=[]}canUndo(){return this.history.undo.length>0}canRedo(){return this.history.redo.length>0}complete(){this._reset(),this.onEnd(),this.emit("complete")}cancel(){this.cancelled=!0,this.complete()}_reset(){var e;(e=this.activeComponent)==null||e.reset()}refreshComponent(){const e=this.activeComponent;e&&(e.type!=="box"&&e.type!=="reshape"&&e.type!=="graphic-mover"||e.refresh())}set undo(e){this._set("undo",()=>{this.canUndo()&&e()})}set redo(e){this._set("redo",()=>{this.canRedo()&&e()})}};d([p()],As.prototype,"activeComponent",void 0),d([p()],As.prototype,"cancelled",void 0),d([p()],As.prototype,"history",void 0),d([p()],As.prototype,"tool",null),d([p()],As.prototype,"type",void 0),d([p()],As.prototype,"canUndo",null),d([p()],As.prototype,"canRedo",null),d([p()],As.prototype,"onEnd",void 0),d([p()],As.prototype,"undo",null),d([p()],As.prototype,"redo",null),d([p()],As.prototype,"toggleTool",void 0),d([p()],As.prototype,"addToSelection",void 0),d([p()],As.prototype,"removeFromSelection",void 0),As=d([A("esri.widgets.Sketch.support.OperationHandle")],As);let ZA=class extends As{};d([p()],ZA.prototype,"activeComponent",void 0),ZA=d([A("esri.widgets.Sketch.support.CreateOperationHandle")],ZA);let Uh=class extends As{};d([p()],Uh.prototype,"activeComponent",void 0),Uh=d([A("esri.widgets.Sketch.support.UpdateOperationHandle")],Uh);const Cee={defaultZ:0},tS={reshapeOptions:{edgeOperation:"split",shapeOperation:"move",vertexOperation:"move"},enableMoveAllGraphics:!0,enableRotation:!0,enableScaling:!0,multipleSelectionEnabled:!0,preserveAspectRatio:!1,toggleToolOnClick:!0,enableZ:!0,highlightOptions:{enabled:!0},tool:"transform"};let Vi=class extends an.EventedAccessor{constructor(e){super(e),this._numUpdating=0,this._handles=new gs,this._internalGraphicsLayer=new C7({listMode:"hide",internal:!0,title:"SVM Internal"}),this._operationHandle=null,this._viewHandles=new gs,this.activeFillSymbol=null,this.activeLineSymbol=null,this.activeVertexSymbol=null,this.allowDeleteKey=!0,this.labelOptions=new Tve,this.layer=null,this.pointSymbol=new ms({style:"circle",size:6,color:[255,255,255],outline:{color:[50,50,50],width:1}}),this.polygonSymbol=new hc({color:[150,150,150,.2],outline:{color:[50,50,50],width:2}}),this.polylineSymbol=new Yn({color:[130,130,130,1],width:2}),this.meshSymbol=new vC({symbolLayers:[new W1]}),this._snappingManager=null,this.tooltipOptions=new Cve,this.updateGraphics=new ye,this.updateOnGraphicClick=!0,this.vertexSymbol=new ms({style:"circle",size:6,color:[255,255,255],outline:{color:[50,50,50],width:1}}),this._moduleLoaderAbortController=null,this._viewReadyAbortController=null,this._originalPopupEnabled=null,this.defaultCreateOptions=Cee,this.defaultUpdateOptions=tS,this.snappingOptions=new L7}initialize(){this._handles.add([ui(()=>{var e,i;return(i=(e=this.view)==null?void 0:e.map)==null?void 0:i.layers},"change",e=>{e.removed.includes(this.layer)&&this.cancel()}),ui(()=>{var e;return(e=this.layer)==null?void 0:e.graphics},"change",e=>{if(this._operationHandle!=null)for(const i of e.removed)this.updateGraphics.includes(i)&&(this.updateGraphics.length>1?this._operationHandle.removeFromSelection(i):this._operationHandle.cancel())}),J(()=>{var e;return((e=this.layer)==null?void 0:e.elevationInfo)??null},e=>{e!==this._internalGraphicsLayer.elevationInfo&&(this.cancel(),this._internalGraphicsLayer.elevationInfo=e)},ji),J(()=>this.view,e=>{je(this._snappingManager),e&&(this._snappingManager=new qc({view:e,options:this.snappingOptions}),e.type==="2d"?W(()=>import("./editingTools-84a62466.js"),["./editingTools-84a62466.js","./SnappingVisualizer2D-bb80f3e9.js","./enums-f1a6a48a.js","./settings-634d0eb6.js","./SnappingContext-224341e2.js","./PointSnappingHint-ebe1c1f7.js","./automaticLengthMeasurementUtils-85946967.js","./spatialReferenceEllipsoidUtils-aadd55de.js","./geometryEngine-40d862d7.js","./geometryEngineBase-eec52f2a.js","./hydrated-1be60493.js","./earcut-6b48af20.js","./triangle-345bd9b9.js","./editPlaneUtils-e0320532.js","./hydratedFeatures-f829a4ca.js","./interfaces-1a80c8eb.js","./GraphicManipulator-db67a3ea.js","./analysisThemeUtils-3cf20539.js","./colorUtils-25efbfd5.js"],import.meta.url):e.type==="3d"&&(W(()=>import("./editingTools-4512aa94.js").then(i=>i.e),["./editingTools-4512aa94.js","./analysisThemeUtils-3cf20539.js","./colorUtils-25efbfd5.js","./automaticLengthMeasurementUtils-85946967.js","./spatialReferenceEllipsoidUtils-aadd55de.js","./geometryEngine-40d862d7.js","./geometryEngineBase-eec52f2a.js","./hydrated-1be60493.js","./OutlineVisualElement-ff6b5a6c.js","./vec4f32-0d1b2306.js","./Octree-ae9c8fa1.js","./line-9c06e0c1.js","./DoubleArray-2809526b.js","./FloatArray-05b27bae.js","./requestImageUtils-89ae2d39.js","./basicInterfaces-bb952591.js","./enums-b14466b3.js","./Texture-eb8cd14a.js","./Indices-e7e8209a.js","./triangle-345bd9b9.js","./doublePrecisionUtils-e3c3d0d8.js","./BufferView-82913510.js","./VertexElementDescriptor-2925c6af.js","./VertexArrayObject-08f516fe.js","./OrderIndependentTransparency-b8ef1857.js","./hydratedFeatures-f829a4ca.js","./triangulationUtils-675e3260.js","./earcut-6b48af20.js","./deduplicate-58dc069a.js","./NestedMap-1b5db22e.js","./InterleavedLayout-dee9d785.js","./types-1305598a.js","./floatRGBA-de0614b2.js","./glUtil-0b7ee6ea.js","./NativeLineMaterial-5686d312.js","./VertexColor.glsl-8fba9b6e.js","./SnappingContext-224341e2.js","./PointSnappingHint-ebe1c1f7.js","./interfaces-1a80c8eb.js","./editPlaneUtils-e0320532.js","./GraphicManipulator-db67a3ea.js","./TranslateTooltipInfos-894e22c7.js","./MeshTransform-392035ba.js","./persistable-0884d473.js","./multiOriginJSONSupportUtils-c978f4c3.js","./resourceExtension-693a589d.js","./ExtentTooltipInfos-89e30dd0.js"],import.meta.url),W(()=>import("./GraphicsLayerView3D-7aa7034a.js").then(i=>i.G),["./GraphicsLayerView3D-7aa7034a.js","./line-9c06e0c1.js","./DoubleArray-2809526b.js","./FloatArray-05b27bae.js","./requestImageUtils-89ae2d39.js","./basicInterfaces-bb952591.js","./enums-b14466b3.js","./Texture-eb8cd14a.js","./Indices-e7e8209a.js","./triangle-345bd9b9.js","./doublePrecisionUtils-e3c3d0d8.js","./BufferView-82913510.js","./VertexElementDescriptor-2925c6af.js","./VertexArrayObject-08f516fe.js","./OrderIndependentTransparency-b8ef1857.js","./hydratedFeatures-f829a4ca.js","./triangulationUtils-675e3260.js","./earcut-6b48af20.js","./deduplicate-58dc069a.js","./NestedMap-1b5db22e.js","./Octree-ae9c8fa1.js","./InterleavedLayout-dee9d785.js","./types-1305598a.js","./floatRGBA-de0614b2.js","./glUtil-0b7ee6ea.js","./OptimizedFeature-4701473b.js","./OptimizedGeometry-196224d4.js","./optimizedFeatureQueryEngineAdapter-2fa61fa1.js","./centroid-8e8cfa47.js","./edgeUtils-d8dd8975.js","./NativeLineMaterial-5686d312.js","./VertexColor.glsl-8fba9b6e.js","./byteSizeEstimations-7cf1c05d.js","./featureConversionUtils-bafaa402.js","./OptimizedFeatureSet-1d1ac4b9.js","./vec32-304b638d.js","./SnappingCandidate-970faec6.js","./objectResourceUtils-18808f8a.js","./DefaultMaterial_COLOR_GAMMA-6867aebc.js","./resourceUtils-ebdc7923.js","./symbolColorUtils-b4c2728c.js","./callExpressionWithFeature-06ba3d44.js","./quantizationUtils-533107d2.js","./MeshComponent-1c3cb4df.js","./imageUtils-c2d0d1ae.js","./projection-0dbacb02.js","./spatialReferenceEllipsoidUtils-aadd55de.js","./interfaces-1a80c8eb.js","./fontUtils-d28127a5.js","./PooledRBush-312cce69.js","./popupUtils-ef750880.js","./geometryServiceUtils-c40372cf.js","./LayerView-6c752c5d.js"],import.meta.url)))},ji),J(()=>{var e;return(e=this.view)==null?void 0:e.spatialReference},(e,i)=>{e&&i&&!e.equals(i)&&this.cancel()})]),Xrt(this)}destroy(){this.cancel(),this._handles=je(this._handles),this._viewHandles=je(this._viewHandles),this._removeDefaultLayer(),this._snappingManager=je(this._snappingManager),this._set("view",null),this.emit("destroy")}get _defaultUpdateTool(){var e;return((e=this.view)==null?void 0:e.type)==="3d"?"move":"transform"}get updating(){return this._numUpdating>0||this._snappingManager!=null&&this._snappingManager.updating}get activeTool(){var e;return((e=this._operationHandle)==null?void 0:e.tool)??null}get activeComponent(){var e;return((e=this._operationHandle)==null?void 0:e.activeComponent)??null}get createGraphic(){return this.activeComponent==null||this.activeComponent.type!=="draw-3d"&&this.activeComponent.type!=="draw-2d"?this._get("createGraphic"):this.activeComponent.graphic}get defaultCreateOptions(){return this._get("defaultCreateOptions")}set defaultCreateOptions(e){this._set("defaultCreateOptions",{...Cee,...e})}get defaultUpdateOptions(){return this._get("defaultUpdateOptions")}set defaultUpdateOptions(e){this._set("defaultUpdateOptions",{...tS,...e,reshapeOptions:{...tS.reshapeOptions,...e==null?void 0:e.reshapeOptions},highlightOptions:{...tS.highlightOptions,...e==null?void 0:e.highlightOptions}})}set snappingOptions(e){this._snappingManager!=null&&(this._snappingManager.options=e),this._set("snappingOptions",e)}get state(){var r;const e=!(!((r=this.view)!=null&&r.ready)||!this.layer),i=this._operationHandle;return e&&i?"active":e?"ready":"disabled"}get view(){return this._get("view")}set view(e){const i=this._get("view");if(i){const{container:n,map:s}=i;n&&(i.cursor=null),s&&s.remove(this._internalGraphicsLayer),this._viewHandles.removeAll(),this.cancel()}const r="view-ready";this._handles.remove(r),e&&this._handles.add(tn(()=>e.ready,n=>{this._viewHandles.removeAll(),n&&this._viewHandles.add(this._generateViewHandles(e))},ji),r),this._set("view",e)}cancel(){this._moduleLoaderAbortController=Qr(this._moduleLoaderAbortController),this._viewReadyAbortController=Qr(this._viewReadyAbortController),this._operationHandle&&this._operationHandle.cancel()}complete(){this._operationHandle&&this._operationHandle.complete()}delete(){const{state:e,updateGraphics:i}=this;if(e==="active"&&i.length){const{activeTool:r,layer:n}=this,s=i.toArray();n.removeMany(s),this.cancel(),this._emitDeleteEvent({graphics:s,tool:r})}}duplicate(){if(this.state==="active"&&this.updateGraphics.length){const e=this.updateGraphics.map(i=>i.clone()).toArray();return this.layer.addMany(e),this.emit("duplicate",{graphics:e,type:"duplicate"}),e}return[]}async create(e,i){this.cancel(),await this._waitViewReady();const{view:r,layer:n}=this;if(!r||this.state==="disabled")throw n||this._logMissingLayer(),wi();if(r.activeTool!=null&&(r.activeTool=null),!e)return void this._logError("sketch:missing-parameter","Missing parameter 'tool'.");bee(r,this._internalGraphicsLayer);const s=await this._setupCreateOperation(e,i);if(s==null||this.destroyed)return void r.map.remove(this._internalGraphicsLayer);const o=()=>{if(s===this._operationHandle){const a=this.createGraphic,l=this._operationHandle.cancelled;this._operationHandle.destroy(),this._operationHandle=null,this._set("createGraphic",null),this.view&&this.view.map&&this.view.map.remove(this._internalGraphicsLayer),s.cancelled||a==null||n.add(a),this.emit("create",{graphic:a,state:l?"cancel":"complete",tool:e,toolEventInfo:null,type:"create"})}};s.on("complete",o),this._operationHandle=s,r.ready&&r.focus()}async update(e,i){this.cancel(),await this._waitViewReady();const{layer:r,view:n,state:s}=this;if(!n||s==="disabled")throw r||this._logMissingLayer(),wi();n.activeTool!=null&&(n.activeTool=null);const o=Array.isArray(e)?e:[e];if(e==null||!o||!o.length)return void this._logError("sketch:missing-parameter","Missing parameter 'graphics'.");if(o.some(l=>l.layer!==r?(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics missing from the supplied GraphicsLayer."),!0):l.geometry==null&&(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics with an unsupported geometry."),!0)))return;const a=await this._setupUpdateOperation(o,i);this.destroyed||a==null||fn(a)||(bee(n,this._internalGraphicsLayer),this._setUpdateOperationHandle(a,i),this.emit("update",{graphics:o,state:"start",aborted:!1,tool:a.tool,toolEventInfo:null,type:"update"}))}async _updateSpatialReference(e){const i=this.view;if(i){this._beginAsyncOperation(),e=Array.isArray(e)?e:[e];for(const r of e)r.geometry==null||r.geometry.type==="mesh"||Pr(r.geometry.spatialReference,i.spatialReference)||(lc(r.geometry.spatialReference,i.spatialReference)||pc()||await Eu(),r.geometry=Ir(r.geometry,i.spatialReference));this._endAsyncOperation()}else this._logMissingView()}undo(){var e;this.canUndo()&&((e=this._operationHandle)==null||e.undo())}redo(){var e;this.canRedo()&&((e=this._operationHandle)==null||e.redo())}canUndo(){return!(!this._operationHandle||!this._operationHandle.canUndo())}canRedo(){return!(!this._operationHandle||!this._operationHandle.canRedo())}toggleUpdateTool(){this._operationHandle&&this._operationHandle.toggleTool&&this._operationHandle.toggleTool()}async _getFirstHit(e){const i=this.view;if(!i)return this._logMissingView(),null;if(i.type==="2d"){const s=[];i.map.allLayers.forEach(a=>{a.type!=="vector-tile"&&a.type!=="imagery"||s.push(a)});const o=await i.hitTest(e,{exclude:s});return Snt(o.results)}const r=[i.map.ground];i.map.allLayers.forEach(s=>{s.type==="integrated-mesh"&&r.push(s)});const n=await i.hitTest(e,{exclude:r});if(n.results.length>0){const s=n.results[0];if(s!=null&&s.type==="graphic"&&s.graphic&&(!n.ground.mapPoint||i.map.ground.opacity<1||n.ground.distance-(s.distance??0)>-Math.min(3*n.ground.distance,i.viewingMode==="global"?ZO(i.renderCoordsHelper.spatialReference).radius/i.renderCoordsHelper.unitInMeters:Number.POSITIVE_INFINITY)))return s}return null}_generateViewHandles(e){return[e.on("immediate-click",async i=>{var o;const r=this.state==="active"&&((o=this._operationHandle)==null?void 0:o.type)==="create";if(this.state==="disabled"||r||!this.updateOnGraphicClick)return;this._beginAsyncOperation();const n=await i.async(()=>this._getFirstHit(jl(i)));let s=null;if(n!=null){const a=n.graphic;this.updateGraphics.includes(a)||a.layer===this.layer?(i.stopPropagation(),s=a):e.type!=="2d"||this._isComponentGraphic(a)||this.state!=="active"||this.cancel()}else this.state==="active"&&this.cancel();s==null||this.updateGraphics.includes(s)||await this.update([s],{...this.defaultUpdateOptions,reshapeOptions:{...this.defaultUpdateOptions.reshapeOptions}}),this._endAsyncOperation()},Pi.WIDGET)]}async _setupCreateOperation(e,i){const r=this.view;if(!r)return this._logMissingView(),null;const n={hasZ:r.type==="3d",...this.defaultCreateOptions,...i},s=await this._setupDrawGraphicTool(e,r,n);return s==null?null:(r.tools.add(s),r.activeTool=s,this._setupCreateOperationHandle(s))}async _setupDrawGraphicTool(e,i,r){if(e==="multipoint"&&i.type==="3d")return this._logError("sketch:create","Multipoint geometries are not supported in SceneView."),null;if(!i)return this._logMissingView(),null;const n=e!=="rectangle",s=e!=="rectangle",o={view:i,mode:e==="rectangle"||e==="circle"?"hybrid":"click",...r,snapToScene:!1,geometryType:e,graphicSymbol:this._getGraphicSymbolFromTool(e),snappingManager:this._snappingManager,forceUniformSize:s,centered:n};return i.type==="2d"?this._makeDrawGraphicTool2D(o):this._makeDrawGraphicTool3D(o)}async _makeDrawGraphicTool2D(e){const i=await this._requireModule(W(()=>import("./editingTools-84a62466.js"),["./editingTools-84a62466.js","./SnappingVisualizer2D-bb80f3e9.js","./enums-f1a6a48a.js","./settings-634d0eb6.js","./SnappingContext-224341e2.js","./PointSnappingHint-ebe1c1f7.js","./automaticLengthMeasurementUtils-85946967.js","./spatialReferenceEllipsoidUtils-aadd55de.js","./geometryEngine-40d862d7.js","./geometryEngineBase-eec52f2a.js","./hydrated-1be60493.js","./earcut-6b48af20.js","./triangle-345bd9b9.js","./editPlaneUtils-e0320532.js","./hydratedFeatures-f829a4ca.js","./interfaces-1a80c8eb.js","./GraphicManipulator-db67a3ea.js","./analysisThemeUtils-3cf20539.js","./colorUtils-25efbfd5.js"],import.meta.url));return fn(i)||this.destroyed?null:new i.module.DrawGraphicTool2D({...e,activeVertexSymbol:this.activeVertexSymbol,regularVerticesSymbol:this.vertexSymbol,activeLineSymbol:this.activeLineSymbol,activeFillSymbol:Tnt(e.geometryType)?this.activeFillSymbol:null,tooltipOptions:this.tooltipOptions})}async _makeDrawGraphicTool3D(e){const i=await this._requireModule(W(()=>import("./editingTools-4512aa94.js").then(n=>n.e),["./editingTools-4512aa94.js","./analysisThemeUtils-3cf20539.js","./colorUtils-25efbfd5.js","./automaticLengthMeasurementUtils-85946967.js","./spatialReferenceEllipsoidUtils-aadd55de.js","./geometryEngine-40d862d7.js","./geometryEngineBase-eec52f2a.js","./hydrated-1be60493.js","./OutlineVisualElement-ff6b5a6c.js","./vec4f32-0d1b2306.js","./Octree-ae9c8fa1.js","./line-9c06e0c1.js","./DoubleArray-2809526b.js","./FloatArray-05b27bae.js","./requestImageUtils-89ae2d39.js","./basicInterfaces-bb952591.js","./enums-b14466b3.js","./Texture-eb8cd14a.js","./Indices-e7e8209a.js","./triangle-345bd9b9.js","./doublePrecisionUtils-e3c3d0d8.js","./BufferView-82913510.js","./VertexElementDescriptor-2925c6af.js","./VertexArrayObject-08f516fe.js","./OrderIndependentTransparency-b8ef1857.js","./hydratedFeatures-f829a4ca.js","./triangulationUtils-675e3260.js","./earcut-6b48af20.js","./deduplicate-58dc069a.js","./NestedMap-1b5db22e.js","./InterleavedLayout-dee9d785.js","./types-1305598a.js","./floatRGBA-de0614b2.js","./glUtil-0b7ee6ea.js","./NativeLineMaterial-5686d312.js","./VertexColor.glsl-8fba9b6e.js","./SnappingContext-224341e2.js","./PointSnappingHint-ebe1c1f7.js","./interfaces-1a80c8eb.js","./editPlaneUtils-e0320532.js","./GraphicManipulator-db67a3ea.js","./TranslateTooltipInfos-894e22c7.js","./MeshTransform-392035ba.js","./persistable-0884d473.js","./multiOriginJSONSupportUtils-c978f4c3.js","./resourceExtension-693a589d.js","./ExtentTooltipInfos-89e30dd0.js"],import.meta.url));if(fn(i)||this.destroyed)return null;const{elevationInfo:r}=this.layer;return new i.module.DrawGraphicTool3D({...e,elevationInfo:r,snapToScene:r==null||r.mode==="absolute-height",labelOptions:this.labelOptions,tooltipOptions:this.tooltipOptions})}_setupCreateOperationHandle(e){const i=this.view;if(!i)return this._logMissingView(),null;let r=null;const n=e.forceUniformSize,s=e.centered,o=[i.on("key-down",l=>{if(l.key===pn.pan)l.stopPropagation(),l.repeat||(e.enabled=!1);else if(l.key===pn.complete)l.stopPropagation(),e.completeCreateOperation();else if(l.key!==pn.vertexAdd||l.repeat)l.key===pn.undo?(l.stopPropagation(),a.undo()):l.key===pn.redo?(l.stopPropagation(),a.redo()):l.key!==pn.constraint||e.geometryType!=="rectangle"&&e.geometryType!=="circle"||l.repeat?l.key===pn.center&&(l.repeat||(e.centered=!s,l.stopPropagation())):(e.forceUniformSize=!n,l.stopPropagation());else{const c=e.drawOperation.geometryType;c!=="polyline"&&c!=="polygon"&&c!=="multipoint"||(l.stopPropagation(),e.drawOperation.commitStagedVertex())}},Pi.WIDGET),i.on("key-up",l=>{l.key===pn.pan?e.enabled=!0:l.key!==pn.constraint||e.geometryType!=="rectangle"&&e.geometryType!=="circle"?l.key===pn.center&&(e.centered=s,l.stopPropagation()):(e.forceUniformSize=n,l.stopPropagation())},Pi.WIDGET),e.on("vertex-add",l=>{switch(r=r==null?"start":"active",l.operation){case"apply":this.emit("create",{graphic:e.graphic,state:r,tool:this.activeTool,toolEventInfo:l,type:"create"});break;case"undo":this._emitUndoEvent({graphics:[e.graphic],tool:e.geometryType});break;case"redo":this._emitRedoEvent({graphics:[e.graphic],tool:e.geometryType})}}),e.on("cursor-update",l=>{e.drawOperation.numCommittedVertices>0&&this.emit("create",{graphic:e.graphic,state:"active",tool:this.activeTool,toolEventInfo:{coordinates:l.vertices[0].coordinates,type:"cursor-update"},type:"create"})}),e.on("vertex-remove",l=>{switch(l.operation){case"apply":this.emit("create",{graphic:e.graphic,state:"active",tool:this.activeTool,toolEventInfo:l,type:"create"});break;case"undo":this._emitUndoEvent({graphics:[e.graphic],tool:e.geometryType});break;case"redo":this._emitRedoEvent({graphics:[e.graphic],tool:e.geometryType})}}),e.on("complete",l=>{this._set("createGraphic",l.graphic),r="complete",l.aborted?a&&a.cancel():a&&a.complete()}),J(()=>this._getGraphicSymbolFromTool(e.geometryType),l=>{e.graphicSymbol=l})],a=new ZA({activeComponent:e,tool:e.geometryType,type:"create",onEnd:()=>{var l;o.forEach(c=>c.remove()),o.length=0,(l=i.tools)==null||l.remove(e)},undo:()=>{e.canUndo&&e.undo()},redo:()=>{e.canRedo&&e.redo()},canUndo:()=>e.canUndo,canRedo:()=>e.canRedo});return a}_getGraphicSymbolFromTool(e){switch(e){case"point":case"multipoint":return this.pointSymbol;case"polyline":return this.polylineSymbol;case"circle":case"rectangle":case"polygon":return this.polygonSymbol;case"mesh":return this.meshSymbol}}async _setupUpdateOperation(e,i){var a;const{layer:r,view:n}=this;if(!n)return this._logMissingView(),null;const s={tool:this._defaultUpdateTool,...this.defaultUpdateOptions,...i,reshapeOptions:{...this.defaultUpdateOptions.reshapeOptions,...i==null?void 0:i.reshapeOptions},highlightOptions:{...this.defaultUpdateOptions.highlightOptions,...i==null?void 0:i.highlightOptions}};let o=s.tool;for(const l of e)r.remove(l),r.add(l);if(n.type==="3d"){if(e.length===0)return null;switch(o){case"move":return this._setupMove3DOperation(e,s,n,o);case"reshape":{if(e.length>1)return this._logError("sketch:reshape-multiple","Reshape operation does not support multiple graphics."),null;const l=GM(e[0]);return l===_i.SUPPORTED?this._setupReshape3DOperation(e[0],s,n):(this._logError("sketch:reshape",`Reshape operation not supported for provided graphic(s) (${OF(l)}).`),null)}case"transform":return this._setupGraphicTransform3DOperation(e,s,n)}}switch(o){case"move":return this._setupMove2DOperation(e,s,n);case"reshape":{if(e.length>1)return this._logError("sketch:reshape-multiple","Reshape operation does not support multiple graphics."),null;const l=GM(e[0]);return l===_i.SUPPORTED?this._setupTransformOrReshape2DOperation(e,o,s,n):(this._logError("sketch:reshape",`Reshape operation not supported for provided graphic(s) (${OF(l)}).`),null)}case"transform":if(e.length===1){const l=(a=e[0].geometry)==null?void 0:a.type;l!=="point"&&l!=="multipoint"||(o="reshape")}return this._setupTransformOrReshape2DOperation(e,o,s,n)}}async _setupMove3DOperation(e,i,r,n,s=!1){for(const u of e){const h=Ort(u);if(h!==_i.SUPPORTED)return this._logError("sketch:move",`Move operation not supported for provided graphic(s) (${OF(h)}).`),null}const o=await this._requireModule(W(()=>import("./editingTools-4512aa94.js").then(u=>u.e),["./editingTools-4512aa94.js","./analysisThemeUtils-3cf20539.js","./colorUtils-25efbfd5.js","./automaticLengthMeasurementUtils-85946967.js","./spatialReferenceEllipsoidUtils-aadd55de.js","./geometryEngine-40d862d7.js","./geometryEngineBase-eec52f2a.js","./hydrated-1be60493.js","./OutlineVisualElement-ff6b5a6c.js","./vec4f32-0d1b2306.js","./Octree-ae9c8fa1.js","./line-9c06e0c1.js","./DoubleArray-2809526b.js","./FloatArray-05b27bae.js","./requestImageUtils-89ae2d39.js","./basicInterfaces-bb952591.js","./enums-b14466b3.js","./Texture-eb8cd14a.js","./Indices-e7e8209a.js","./triangle-345bd9b9.js","./doublePrecisionUtils-e3c3d0d8.js","./BufferView-82913510.js","./VertexElementDescriptor-2925c6af.js","./VertexArrayObject-08f516fe.js","./OrderIndependentTransparency-b8ef1857.js","./hydratedFeatures-f829a4ca.js","./triangulationUtils-675e3260.js","./earcut-6b48af20.js","./deduplicate-58dc069a.js","./NestedMap-1b5db22e.js","./InterleavedLayout-dee9d785.js","./types-1305598a.js","./floatRGBA-de0614b2.js","./glUtil-0b7ee6ea.js","./NativeLineMaterial-5686d312.js","./VertexColor.glsl-8fba9b6e.js","./SnappingContext-224341e2.js","./PointSnappingHint-ebe1c1f7.js","./interfaces-1a80c8eb.js","./editPlaneUtils-e0320532.js","./GraphicManipulator-db67a3ea.js","./TranslateTooltipInfos-894e22c7.js","./MeshTransform-392035ba.js","./persistable-0884d473.js","./multiOriginJSONSupportUtils-c978f4c3.js","./resourceExtension-693a589d.js","./ExtentTooltipInfos-89e30dd0.js"],import.meta.url));if(fn(o))return o;const a=new o.module.GraphicMoveTool({view:r,enableZ:i.enableZ,snappingManager:this._snappingManager,tooltipOptions:this.tooltipOptions});r.tools.add(a),a.graphics.addMany(e),s||this.updateGraphics.addMany(e);const l=[],c=new Uh({activeComponent:a,tool:n,type:"update",onEnd:()=>{var u;l.forEach(h=>h.remove()),l.length=0,(u=r.tools)==null||u.remove(a),a.destroyed||a.destroy()},undo:()=>{ZM(c,this.updateGraphics.toArray()),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:n})},redo:()=>{YM(c,this.updateGraphics.toArray()),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:n})},addToSelection:u=>{this.updateGraphics.push(u),a.graphics.push(u),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[u],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:u=>{const h=this.updateGraphics.indexOf(u);c.history.undo.forEach(f=>f.updates.splice(h,1)),c.history.redo.forEach(f=>f.updates.splice(h,1)),this.updateGraphics.remove(u),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[u],type:"selection-change"},type:"update"}),this.updateGraphics.length!==0?a.graphics.remove(u):c.complete()},toggleTool:async()=>{if(this.updateGraphics.length!==1||i.toggleToolOnClick===!1||n!=="transform")return;const u=this.updateGraphics.at(0);if(GM(u)!==_i.SUPPORTED)return;c.onEnd(),c.destroy();const h=await this._setupReshape3DOperation(u,i,r,!0);fn(h)||this._setUpdateOperationHandle(h,i)}});return l.push(...this._getHandlesForComponent(c,i),r.on("immediate-click",u=>this._getCommonUpdateOperationClickHandlers(c,u,i),Pi.WIDGET),r.on("key-down",u=>{this._getCommonUpdateOperationKeyDownHandlers(c,u)},Pi.WIDGET)),c}_setupGraphicTransform3DOperation(e,i,r,n=!1){if(e.length===1&&Rrt(e[0])===_i.SUPPORTED){const s=e[0],o=s.geometry;if(o!=null&&(o.type==="point"||o.type==="mesh"))return this._setupPointTransform3DOperation(s,i,r);if(o!=null&&(o.type==="polygon"||o.type==="polyline"))return this._setupPolyTransform3DOperation(s,i,r,n)}return this._setupMove3DOperation(e,i,r,"transform",n)}async _setupPointTransform3DOperation(e,i,r){const n="transform",{enableRotation:s,enableScaling:o,enableZ:a}=i,l=await this._requireModule(W(()=>import("./editingTools-4512aa94.js").then(f=>f.e),["./editingTools-4512aa94.js","./analysisThemeUtils-3cf20539.js","./colorUtils-25efbfd5.js","./automaticLengthMeasurementUtils-85946967.js","./spatialReferenceEllipsoidUtils-aadd55de.js","./geometryEngine-40d862d7.js","./geometryEngineBase-eec52f2a.js","./hydrated-1be60493.js","./OutlineVisualElement-ff6b5a6c.js","./vec4f32-0d1b2306.js","./Octree-ae9c8fa1.js","./line-9c06e0c1.js","./DoubleArray-2809526b.js","./FloatArray-05b27bae.js","./requestImageUtils-89ae2d39.js","./basicInterfaces-bb952591.js","./enums-b14466b3.js","./Texture-eb8cd14a.js","./Indices-e7e8209a.js","./triangle-345bd9b9.js","./doublePrecisionUtils-e3c3d0d8.js","./BufferView-82913510.js","./VertexElementDescriptor-2925c6af.js","./VertexArrayObject-08f516fe.js","./OrderIndependentTransparency-b8ef1857.js","./hydratedFeatures-f829a4ca.js","./triangulationUtils-675e3260.js","./earcut-6b48af20.js","./deduplicate-58dc069a.js","./NestedMap-1b5db22e.js","./InterleavedLayout-dee9d785.js","./types-1305598a.js","./floatRGBA-de0614b2.js","./glUtil-0b7ee6ea.js","./NativeLineMaterial-5686d312.js","./VertexColor.glsl-8fba9b6e.js","./SnappingContext-224341e2.js","./PointSnappingHint-ebe1c1f7.js","./interfaces-1a80c8eb.js","./editPlaneUtils-e0320532.js","./GraphicManipulator-db67a3ea.js","./TranslateTooltipInfos-894e22c7.js","./MeshTransform-392035ba.js","./persistable-0884d473.js","./multiOriginJSONSupportUtils-c978f4c3.js","./resourceExtension-693a589d.js","./ExtentTooltipInfos-89e30dd0.js"],import.meta.url));if(fn(l))return l;const c=new l.module.GraphicTransformTool({graphic:e,view:r,enableRotation:s,enableScaling:o,enableZ:a,snappingManager:this._snappingManager,tooltipOptions:this.tooltipOptions});r.tools.add(c),this.updateGraphics.add(e);const u=[],h=new Uh({activeComponent:c,tool:n,type:"update",onEnd:()=>{var f;u.forEach(m=>m.remove()),u.length=0,(f=r.tools)==null||f.remove(c),c.destroyed||c.destroy()},undo:()=>{ZM(h,this.updateGraphics.toArray()),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:n})},redo:()=>{YM(h,this.updateGraphics.toArray()),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:n})},addToSelection:async f=>{this.updateGraphics.add(f),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[f],removed:[],type:"selection-change"},type:"update"}),h.onEnd(),h.destroy();const m=await this._setupMove3DOperation(this.updateGraphics.toArray(),i,r,"transform",!0);fn(m)||this._setUpdateOperationHandle(m,i)},removeFromSelection:f=>{this.updateGraphics.remove(f),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[f],type:"selection-change"},type:"update"}),h.complete()},toggleTool:()=>{}});return u.push(...this._getHandlesForComponent(h,i),r.on("immediate-click",f=>this._getCommonUpdateOperationClickHandlers(h,f,i),Pi.WIDGET),r.on("key-down",f=>{this._getCommonUpdateOperationKeyDownHandlers(h,f)},Pi.WIDGET)),h}async _setupPolyTransform3DOperation(e,i,r,n=!1){const s="transform",{enableRotation:o,enableScaling:a,enableZ:l,preserveAspectRatio:c}=i,u=await this._requireModule(W(()=>import("./editingTools-4512aa94.js").then(g=>g.e),["./editingTools-4512aa94.js","./analysisThemeUtils-3cf20539.js","./colorUtils-25efbfd5.js","./automaticLengthMeasurementUtils-85946967.js","./spatialReferenceEllipsoidUtils-aadd55de.js","./geometryEngine-40d862d7.js","./geometryEngineBase-eec52f2a.js","./hydrated-1be60493.js","./OutlineVisualElement-ff6b5a6c.js","./vec4f32-0d1b2306.js","./Octree-ae9c8fa1.js","./line-9c06e0c1.js","./DoubleArray-2809526b.js","./FloatArray-05b27bae.js","./requestImageUtils-89ae2d39.js","./basicInterfaces-bb952591.js","./enums-b14466b3.js","./Texture-eb8cd14a.js","./Indices-e7e8209a.js","./triangle-345bd9b9.js","./doublePrecisionUtils-e3c3d0d8.js","./BufferView-82913510.js","./VertexElementDescriptor-2925c6af.js","./VertexArrayObject-08f516fe.js","./OrderIndependentTransparency-b8ef1857.js","./hydratedFeatures-f829a4ca.js","./triangulationUtils-675e3260.js","./earcut-6b48af20.js","./deduplicate-58dc069a.js","./NestedMap-1b5db22e.js","./InterleavedLayout-dee9d785.js","./types-1305598a.js","./floatRGBA-de0614b2.js","./glUtil-0b7ee6ea.js","./NativeLineMaterial-5686d312.js","./VertexColor.glsl-8fba9b6e.js","./SnappingContext-224341e2.js","./PointSnappingHint-ebe1c1f7.js","./interfaces-1a80c8eb.js","./editPlaneUtils-e0320532.js","./GraphicManipulator-db67a3ea.js","./TranslateTooltipInfos-894e22c7.js","./MeshTransform-392035ba.js","./persistable-0884d473.js","./multiOriginJSONSupportUtils-c978f4c3.js","./resourceExtension-693a589d.js","./ExtentTooltipInfos-89e30dd0.js"],import.meta.url));if(fn(u))return u;const h=new u.module.ExtentTransformTool({graphic:e,view:r,enableRotation:o,enableScaling:a,enableZ:l,preserveAspectRatio:c,tooltipOptions:this.tooltipOptions});r.tools.add(h),n||this.updateGraphics.add(e);const f=[],m=new Uh({activeComponent:h,tool:s,type:"update",onEnd:()=>{var g;f.forEach(y=>y.remove()),f.length=0,(g=r.tools)==null||g.remove(h),h.destroyed||h.destroy()},canUndo:()=>h.canUndo,undo:()=>{h.undo(),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:s})},canRedo:()=>h.canRedo,redo:()=>{h.redo(),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:s})},addToSelection:async g=>{this.updateGraphics.add(g),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[g],removed:[],type:"selection-change"},type:"update"}),m.onEnd(),m.destroy();const y=await this._setupMove3DOperation(this.updateGraphics.toArray(),i,r,"transform",!0);fn(y)||this._setUpdateOperationHandle(y,i)},removeFromSelection:g=>{this.updateGraphics.remove(g),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[g],type:"selection-change"},type:"update"}),m.complete()},toggleTool:async()=>{if(this.updateGraphics.length!==1||i.toggleToolOnClick===!1)return;const g=this.updateGraphics.at(0);if(GM(g)!==_i.SUPPORTED)return;m.onEnd(),m.destroy();const y=await this._setupReshape3DOperation(g,i,r,!0);fn(y)||this._setUpdateOperationHandle(y,i)}});return f.push(...this._getHandlesForComponent(m,i),r.on("immediate-click",g=>this._getCommonUpdateOperationClickHandlers(m,g,i),Pi.WIDGET),r.on("key-down",g=>this._getCommonUpdateOperationKeyDownHandlers(m,g),Pi.WIDGET),r.on("key-down",g=>{g.key!==pn.constraint||g.repeat||(h.preserveAspectRatio=!h.preserveAspectRatio,g.stopPropagation())},Pi.WIDGET),r.on("key-up",g=>{g.key===pn.constraint&&(h.preserveAspectRatio=!h.preserveAspectRatio,g.stopPropagation())},Pi.WIDGET)),m}async _setupMove2DOperation(e,i,r){const n="move";this.updateGraphics.addMany(e),await this._updateSpatialReference(e);const s=await this._getGraphicMover(e,i,r);if(fn(s))return s;const o=new Uh({activeComponent:s,tool:n,type:"update",onEnd:()=>{var u;this._displayDefaultCursor(),c.forEach(h=>h.remove()),l.forEach(h=>h.remove()),c=[],l=[],s.destroy(),(u=this._internalGraphicsLayer)==null||u.removeMany([...this.updateGraphics.toArray()])},undo:()=>{const u=this.updateGraphics.toArray();ZM(o,u),o.refreshComponent(),this._emitUndoEvent({graphics:u,tool:n})},redo:()=>{const u=this.updateGraphics.toArray();YM(o,u),o.refreshComponent(),this._emitRedoEvent({graphics:u,tool:n})},addToSelection:async u=>{await this._updateSpatialReference(u),this.updateGraphics.push(u),s.graphics=this.updateGraphics.toArray(),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[u],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:u=>{const h=this.updateGraphics.indexOf(u);o.history.undo.forEach(m=>m.updates.splice(h,1)),o.history.redo.forEach(m=>m.updates.splice(h,1)),this.updateGraphics.remove(u);const f=this.updateGraphics.toArray();this.emit("update",{graphics:f,state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[u],type:"selection-change"},type:"update"}),this.updateGraphics.length!==0?s.graphics=f:o.complete()}});let a=!1,l=[r.on("immediate-click",u=>this._getCommonUpdateOperationClickHandlers(o,u,i),Pi.WIDGET),r.on("key-down",u=>{this._getCommonUpdateOperationKeyDownHandlers(o,u),u.key!==pn.constraint||u.repeat||(a=!0,s.enableMoveAllGraphics=!s.enableMoveAllGraphics)},Pi.WIDGET),r.on("key-up",u=>{u.key===pn.constraint&&a&&(a=!1,s.enableMoveAllGraphics=!s.enableMoveAllGraphics)},Pi.WIDGET)],c=this._getHandlesForComponent(o,i);return o}async _setupReshape3DOperation(e,i,r,n=!1){const s="reshape",o=await this._requireModule(W(()=>import("./editingTools-4512aa94.js").then(h=>h.e),["./editingTools-4512aa94.js","./analysisThemeUtils-3cf20539.js","./colorUtils-25efbfd5.js","./automaticLengthMeasurementUtils-85946967.js","./spatialReferenceEllipsoidUtils-aadd55de.js","./geometryEngine-40d862d7.js","./geometryEngineBase-eec52f2a.js","./hydrated-1be60493.js","./OutlineVisualElement-ff6b5a6c.js","./vec4f32-0d1b2306.js","./Octree-ae9c8fa1.js","./line-9c06e0c1.js","./DoubleArray-2809526b.js","./FloatArray-05b27bae.js","./requestImageUtils-89ae2d39.js","./basicInterfaces-bb952591.js","./enums-b14466b3.js","./Texture-eb8cd14a.js","./Indices-e7e8209a.js","./triangle-345bd9b9.js","./doublePrecisionUtils-e3c3d0d8.js","./BufferView-82913510.js","./VertexElementDescriptor-2925c6af.js","./VertexArrayObject-08f516fe.js","./OrderIndependentTransparency-b8ef1857.js","./hydratedFeatures-f829a4ca.js","./triangulationUtils-675e3260.js","./earcut-6b48af20.js","./deduplicate-58dc069a.js","./NestedMap-1b5db22e.js","./InterleavedLayout-dee9d785.js","./types-1305598a.js","./floatRGBA-de0614b2.js","./glUtil-0b7ee6ea.js","./NativeLineMaterial-5686d312.js","./VertexColor.glsl-8fba9b6e.js","./SnappingContext-224341e2.js","./PointSnappingHint-ebe1c1f7.js","./interfaces-1a80c8eb.js","./editPlaneUtils-e0320532.js","./GraphicManipulator-db67a3ea.js","./TranslateTooltipInfos-894e22c7.js","./MeshTransform-392035ba.js","./persistable-0884d473.js","./multiOriginJSONSupportUtils-c978f4c3.js","./resourceExtension-693a589d.js","./ExtentTooltipInfos-89e30dd0.js"],import.meta.url));if(fn(o))return o;const a=i.reshapeOptions,l=new o.module.GraphicReshapeTool({view:r,graphic:e,enableZVertex:i.enableZ&&(a==null?void 0:a.vertexOperation)==="move",enableZShape:i.enableZ&&(a==null?void 0:a.shapeOperation)==="move",enableMoveGraphic:(a==null?void 0:a.shapeOperation)==="move"||(a==null?void 0:a.shapeOperation)==="move-xy",enableMidpoints:(a==null?void 0:a.edgeOperation)==="split",enableEdgeOffset:(a==null?void 0:a.edgeOperation)==="offset",snappingManager:this._snappingManager,labelOptions:this.labelOptions,tooltipOptions:this.tooltipOptions});r.tools.add(l),n||this.updateGraphics.add(e);const c=[],u=new Uh({activeComponent:l,tool:s,type:"update",onEnd:()=>{var h;c.forEach(f=>f.remove()),c.length=0,(h=r.tools)==null||h.remove(l),l.destroyed||l.destroy()},canUndo:()=>l.canUndo,undo:()=>{l.undo(),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:s})},canRedo:()=>l.canRedo,redo:()=>{l.redo(),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:s})},addToSelection:async h=>{this.updateGraphics.add(h),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[h],removed:[],type:"selection-change"},type:"update"}),u.onEnd(),u.destroy();const f=await this._setupMove3DOperation(this.updateGraphics.toArray(),i,r,"transform",!0);fn(f)||this._setUpdateOperationHandle(f,i)},removeFromSelection:h=>{this.updateGraphics.remove(h),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[h],type:"selection-change"},type:"update"}),u.complete()},toggleTool:async()=>{if(i.toggleToolOnClick===!1)return;u.onEnd(),u.destroy();const h=await this._setupGraphicTransform3DOperation(this.updateGraphics.toArray(),i,r,!0);fn(h)||this._setUpdateOperationHandle(h,i)}});return c.push(...this._getHandlesForComponent(u,i),r.on("immediate-click",h=>this._getCommonUpdateOperationClickHandlers(u,h,i),Pi.WIDGET),r.on("key-down",h=>{this._getCommonUpdateOperationKeyDownHandlers(u,h)},Pi.WIDGET)),u}async _setupTransformOrReshape2DOperation(e,i,r,n){this.updateGraphics.addMany(e),await this._updateSpatialReference(e);const s=i==="transform"?await this._getBox(e,r,n):await this._getReshape(e,r,n);if(fn(s))return s;const o=new Uh({activeComponent:s,type:"update",onEnd:()=>{l.forEach(c=>c.remove()),a.forEach(c=>c.remove()),l=[],a=[],o.activeComponent&&!o.activeComponent.destroyed&&o.activeComponent.destroy(),this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray())},undo:()=>{ZM(o,this.updateGraphics.toArray()),o.refreshComponent(),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:o.tool})},redo:()=>{YM(o,this.updateGraphics.toArray()),o.refreshComponent(),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:o.tool})},addToSelection:async c=>{let u=o.activeComponent;if((u==null?void 0:u.type)==="reshape"){const h=[...this.updateGraphics,c];this.updateGraphics.removeAll(),o.onEnd(),o.destroy();const f=await this._setupMove2DOperation(h,r,n);if(fn(f))return;this._setUpdateOperationHandle(f,r)}else this.updateGraphics.add(c),u.graphics=this.updateGraphics.toArray(),u.refresh(),o.resetHistory();this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[c],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:async c=>{const u=this.updateGraphics.indexOf(c);o.history.undo.forEach(f=>f.updates.splice(u,1)),o.history.redo.forEach(f=>f.updates.splice(u,1)),this.updateGraphics.remove(c);const h=this.updateGraphics.toArray();if(h.length===0)o.complete();else{const f=h[0].geometry;h.length!==1||f==null||f.type!=="point"&&f.type!=="multipoint"?o.activeComponent.graphics=h:o.toggleTool()}this.emit("update",{graphics:h,state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[c],type:"selection-change"},type:"update"})},toggleTool:async()=>{var f;if(this.updateGraphics.length>1)return;const c=this.updateGraphics.at(0),u=c.geometry;if(u!=null&&(o.tool==="reshape"&&(u.type==="point"||u.type==="multipoint")||o.tool==="transform"&&u.type==="extent"))return;let h=null;o.tool==="transform"?h=await this._getReshape([c],r,n):o.tool==="reshape"&&(h=await this._getBox([c],r,n)),fn(h)||((f=o.activeComponent)==null||f.destroy(),o.activeComponent=h,o.activeComponent&&(l.forEach(m=>m.remove()),l=this._getHandlesForComponent(o,r)))}});let a=[n.on("immediate-click",c=>this._getCommonUpdateOperationClickHandlers(o,c,r),Pi.WIDGET),n.on("key-down",c=>{if(this._getCommonUpdateOperationKeyDownHandlers(o,c),c.key===pn.constraint&&!c.repeat&&o){const u=o.activeComponent;u&&u.type==="box"&&(u.preserveAspectRatio=!u.preserveAspectRatio)}},Pi.WIDGET),n.on("key-up",c=>{if(c.key===pn.constraint&&o){const u=o.activeComponent;u&&u.type==="box"&&(u.preserveAspectRatio=!u.preserveAspectRatio)}},Pi.WIDGET)],l=this._getHandlesForComponent(o,r);return o}async _getGraphicMover(e,i,r){const{enableMoveAllGraphics:n,highlightOptions:s}=i,o=await this._requireModule(W(()=>import("./GraphicMover-07e0ecf6.js").then(a=>a.G),["./GraphicMover-07e0ecf6.js","./GraphicManipulator-db67a3ea.js"],import.meta.url));return fn(o)?o:new o.module.default({enableMoveAllGraphics:n,highlightsEnabled:!!(s!=null&&s.enabled),indicatorsEnabled:!1,graphics:e,view:r,callbacks:{onGraphicMoveStart:({dx:a,dy:l,graphic:c})=>{this._displayGrabbingCursor(),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:a,dy:l,mover:c,type:"move-start"},type:"update"})},onGraphicMove:({dx:a,dy:l,graphic:c})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:a,dy:l,mover:c,type:"move"},type:"update"}),onGraphicMoveStop:({dx:a,dy:l,graphic:c})=>{this._displayPointerCursor(),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:a,dy:l,mover:c,type:"move-stop"},type:"update"})},onGraphicPointerOver:()=>this._displayPointerCursor(),onGraphicPointerOut:()=>this._displayDefaultCursor()}})}async _getBox(e,i,r){const{enableRotation:n,enableScaling:s,highlightOptions:o,preserveAspectRatio:a}=i,l=await this._requireModule(W(()=>import("./Box-98170dec.js"),["./Box-98170dec.js","./automaticLengthMeasurementUtils-85946967.js","./spatialReferenceEllipsoidUtils-aadd55de.js","./geometryEngine-40d862d7.js","./geometryEngineBase-eec52f2a.js","./hydrated-1be60493.js","./GraphicManipulator-db67a3ea.js","./GraphicMover-07e0ecf6.js","./settings-634d0eb6.js","./ExtentTooltipInfos-89e30dd0.js","./TranslateTooltipInfos-894e22c7.js"],import.meta.url));return fn(l)?l:new l.module.default({graphics:e,enableRotation:n,enableScaling:s,highlightsEnabled:!!(o!=null&&o.enabled),preserveAspectRatio:a,layer:this._internalGraphicsLayer,view:r,tooltipOptions:this.tooltipOptions,callbacks:{onMoveStart:c=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...c},type:"update"}),onMove:c=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...c},type:"update"}),onMoveStop:c=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...c},type:"update"}),onScaleStart:c=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...c},type:"update"}),onScale:c=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...c},type:"update"}),onScaleStop:c=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...c},type:"update"}),onRotateStart:c=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...c},type:"update"}),onRotate:c=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...c},type:"update"}),onRotateStop:c=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...c},type:"update"})}})}async _getReshape(e,i,r){var l,c,u;const n=((l=i.reshapeOptions)==null?void 0:l.edgeOperation)==="split",s=((c=i.reshapeOptions)==null?void 0:c.shapeOperation)==="move",o=!!((u=i.highlightOptions)!=null&&u.enabled),a=await this._requireModule(W(()=>import("./Reshape-8e91878b.js"),["./Reshape-8e91878b.js","./automaticLengthMeasurementUtils-85946967.js","./spatialReferenceEllipsoidUtils-aadd55de.js","./geometryEngine-40d862d7.js","./geometryEngineBase-eec52f2a.js","./hydrated-1be60493.js","./SnappingVisualizer2D-bb80f3e9.js","./enums-f1a6a48a.js","./settings-634d0eb6.js","./SnappingContext-224341e2.js","./PointSnappingHint-ebe1c1f7.js","./earcut-6b48af20.js","./triangle-345bd9b9.js","./GraphicManipulator-db67a3ea.js","./GraphicMover-07e0ecf6.js","./TranslateTooltipInfos-894e22c7.js"],import.meta.url));return fn(a)?a:new a.module.default({enableMidpoints:n,enableMovement:s,graphic:e[0],highlightsEnabled:o,layer:this._internalGraphicsLayer,snappingManager:this._snappingManager,tooltipOptions:this.tooltipOptions,view:r,callbacks:{onReshapeStart:h=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...h},type:"update"}),onReshape:h=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...h},type:"update"}),onReshapeStop:({mover:h,type:f})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:h,type:f},type:"update"}),onMoveStart:({dx:h,dy:f,mover:m,type:g})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:h,dy:f,mover:m,type:g},type:"update"}),onMove:({dx:h,dy:f,mover:m,type:g})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:h,dy:f,mover:m,type:g},type:"update"}),onMoveStop:({dx:h,dy:f,mover:m,type:g})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:h,dy:f,mover:m,type:g},type:"update"}),onVertexAdd:({added:h,type:f,vertices:m})=>{const g=h.map(y=>vq(y.geometry));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:g,vertices:m,type:f},type:"update"})},onVertexRemove:({removed:h,type:f,vertices:m})=>{const g=h.map(y=>vq(y.geometry));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{removed:g,vertices:m,type:f},type:"update"})}}})}_getHandlesForComponent(e,i){const r=e.activeComponent;if(!r)return[];switch(r.type){case"graphic-mover":return[r.on("graphic-click",({graphic:n,viewEvent:s})=>{var o;(o=s.native)!=null&&o.shiftKey&&(s.stopPropagation(),e.removeFromSelection(n))}),r.on("graphic-move-start",n=>e.addToHistory(rh(n.allGraphics)))];case"box":return[r.on("graphic-click",n=>this._onTransformOrReshape2DGraphicClick(e,i,n)),r.on("move-start",n=>e.addToHistory(rh(n.graphics))),r.on("rotate-start",n=>e.addToHistory(rh(n.graphics))),r.on("scale-start",n=>e.addToHistory(rh(n.graphics)))];case"reshape":return[r.on("graphic-click",n=>this._onTransformOrReshape2DGraphicClick(e,i,n)),r.on("move-start",n=>e.addToHistory(rh([n.mover]))),r.on("reshape-start",n=>e.addToHistory(rh([n.graphic]))),r.on("vertex-add",n=>e.addToHistory(rh([n.oldGraphic]))),r.on("vertex-remove",n=>e.addToHistory(rh([n.oldGraphic])))];case"move-3d":return[r.on("graphic-move-start",n=>{e.addToHistory(rh(n.allGraphics)),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:n.allGraphics.length>0?n.allGraphics[0]:null,type:"move-start"},type:"update"})}),r.on("graphic-move",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:n.dx,dy:n.dy,mover:n.allGraphics.length>0?n.allGraphics[0]:null,type:"move"},type:"update"})}),r.on("graphic-move-stop",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:n.allGraphics.length>0?n.allGraphics[0]:null,type:"move-stop"},type:"update"})}),r.on("immediate-click",n=>{n.shiftKey?this._toggleSelection([n.graphic],e,i):e.toggleTool()})];case"transform-3d":return[r.on("record-undo",({record:n})=>{e.addToHistory({updates:[n]})}),r.on("graphic-translate-start",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:n.graphic,dx:n.dxScreen,dy:n.dyScreen,type:"move-start"},type:"update"})}),r.on("graphic-translate-stop",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:n.graphic,dx:n.dxScreen,dy:n.dyScreen,type:"move-stop"},type:"update"})}),r.on("graphic-rotate-start",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:n.graphic,angle:n.angle,type:"rotate-start"},type:"update"})}),r.on("graphic-rotate-stop",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:n.graphic,angle:n.angle,type:"rotate-stop"},type:"update"})}),r.on("graphic-scale-start",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:n.graphic,xScale:n.xScale,yScale:n.yScale,type:"scale-start"},type:"update"})}),r.on("graphic-scale-stop",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:n.graphic,xScale:n.xScale,yScale:n.yScale,type:"scale-stop"},type:"update"})}),r.on("graphic-translate",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:n.graphic,dx:n.dxScreen,dy:n.dyScreen,type:"move"},type:"update"})}),r.on("graphic-rotate",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:n.graphic,angle:n.angle,type:"rotate"},type:"update"})}),r.on("graphic-scale",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:n.graphic,xScale:n.xScale,yScale:n.yScale,type:"scale"},type:"update"})}),r.on("immediate-click",n=>{n.shiftKey?this._toggleSelection([n.graphic],e,i):e.toggleTool()})];case"reshape-3d":return[r.on("reshape",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:n,type:"update"})}),r.on("move",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:n,type:"update"})}),r.on("vertex-add",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:n,type:"update"})}),r.on("vertex-remove",n=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:n,type:"update"})}),r.on("immediate-click",n=>{n.shiftKey?this._toggleSelection([n.graphic],e,i):e.toggleTool()})]}}_onTransformOrReshape2DGraphicClick(e,i,r){var o;const{graphic:n,viewEvent:s}=r;return(o=s.native)!=null&&o.shiftKey&&n.layer===this.layer?(s.stopPropagation(),e.removeFromSelection(n)):i.toggleToolOnClick?(s.stopPropagation(),e.toggleTool()):void 0}_setUpdateOperationHandle(e,i){var s;this._operationHandle=e;const r=(s=this.view)==null?void 0:s.map;this._disablePopup(i);const n=()=>{if(e===this._operationHandle){const o=this.updateGraphics.toArray(),a=this._operationHandle.tool;this._operationHandle.destroy(),this._operationHandle=null,this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray()),this.updateGraphics.removeAll(),r&&r.remove(this._internalGraphicsLayer),this._restorePopup(i),this.emit("update",{graphics:o,state:"complete",aborted:e.cancelled,tool:a,toolEventInfo:null,type:"update"})}};e.on("complete",n)}async _getCommonUpdateOperationClickHandlers(e,i,r){const n=jl(i),s=await i.async(()=>this._getFirstHit(n));if(s==null)return void e.complete();if(i.native.shiftKey&&this._toggleSelection([s.graphic],e,r))return void i.stopPropagation();this.updateGraphics.includes(s.graphic)?i.stopPropagation():e.complete()}_toggleSelection(e,i,r){const n=!!r.multipleSelectionEnabled;return e.some(s=>s!=null&&!(!n||s.layer!==this.layer)&&(this.updateGraphics.includes(s)?i.removeFromSelection(s):i.addToSelection(s),!0))}_getCommonUpdateOperationKeyDownHandlers(e,i){if(!e)return;const r=i.key;r===pn.undo&&e.canUndo()?(i.stopPropagation(),e.undo()):r===pn.redo&&e.canRedo()?(i.stopPropagation(),e.redo()):r===pn.cancel?(i.stopPropagation(),e.cancel()):this.allowDeleteKey&&pn.delete.includes(r)&&this._onDeleteKey(i)}_onDeleteKey(e){var n;if(!this._operationHandle||this._operationHandle.type!=="update")return;const i=this.activeComponent,r=this.updateGraphics.toArray();i!=null&&i.type!=="reshape-3d"&&(i.type!=="reshape"||r.length===1&&((n=r[0].geometry)==null?void 0:n.type)==="point")&&(e.stopPropagation(),this.delete())}_removeDefaultLayer(){var e,i;this._internalGraphicsLayer&&((i=(e=this.view)==null?void 0:e.map)==null||i.remove(this._internalGraphicsLayer),this._internalGraphicsLayer=je(this._internalGraphicsLayer))}_isComponentGraphic(e){const{activeComponent:i}=this;return!(!e||i==null)&&(e.attributes&&e.attributes.esriSketchTool||i.type==="draw-2d"&&i.graphic===e||(i.type==="box"||i.type==="reshape")&&i.isUIGraphic(e))}_displayPointerCursor(){this.view&&this.view.container&&this.view.cursor!=="pointer"&&(this.view.cursor="pointer")}_displayGrabbingCursor(){this.view&&this.view.container&&this.view.cursor!=="grabbing"&&(this.view.cursor="grabbing")}_displayDefaultCursor(){this.view&&this.view.container&&this.view.cursor!==null&&(this.view.cursor=null)}_logError(e,i,r){ie.getLogger(this).error(new N(e,i,r))}async _requireModule(e){const i=new AbortController;this._moduleLoaderAbortController=i;const r=await e;return this._moduleLoaderAbortController!==i||i.signal.aborted?{requireError:"aborted"}:{module:r}}_emitUndoEvent(e){this.emit("undo",{...e,type:"undo"})}_emitRedoEvent(e){this.emit("redo",{...e,type:"redo"})}_emitDeleteEvent(e){this.emit("delete",{...e,type:"delete"})}get test(){return{operationHandle:this._operationHandle,defaultUpdateOptions:tS}}wait(){return _r(()=>!this.updating)}_beginAsyncOperation(){this._numUpdating+=1,this.notifyChange("updating")}_endAsyncOperation(){this._numUpdating-=1,this.notifyChange("updating")}_disablePopupEnabled(e){var i;return((i=this.view)==null?void 0:i.type)!=="3d"||this.updateOnGraphicClick||((e==null?void 0:e.toggleToolOnClick)??!1)}_disablePopup(e){this._disablePopupEnabled(e)&&this.view&&this._originalPopupEnabled==null&&(this._originalPopupEnabled=this.view.popupEnabled,this.view.popupEnabled=!1)}_restorePopup(e){this._disablePopupEnabled(e)&&this.view&&this._originalPopupEnabled!=null&&(this.view.popupEnabled=this._originalPopupEnabled,this._originalPopupEnabled=null)}async _waitViewReady(){const e=this.view;e?(Qr(this._viewReadyAbortController),this._viewReadyAbortController=new AbortController,await gu(_r(()=>e==null?void 0:e.ready),this._viewReadyAbortController.signal)):this._logMissingView()}_logMissingView(){this._logError("sketch:missing-property",Eee("view"))}_logMissingLayer(){this._logError(Int,Eee("layer"))}};d([p()],Vi.prototype,"updating",null),d([p()],Vi.prototype,"_operationHandle",void 0),d([p({readOnly:!0})],Vi.prototype,"activeTool",null),d([p()],Vi.prototype,"activeFillSymbol",void 0),d([p()],Vi.prototype,"activeLineSymbol",void 0),d([p()],Vi.prototype,"activeVertexSymbol",void 0),d([p()],Vi.prototype,"allowDeleteKey",void 0),d([p({readOnly:!0})],Vi.prototype,"createGraphic",null),d([p()],Vi.prototype,"defaultCreateOptions",null),d([p()],Vi.prototype,"defaultUpdateOptions",null),d([p({type:Tve,nonNullable:!0})],Vi.prototype,"labelOptions",void 0),d([p()],Vi.prototype,"layer",void 0),d([p({types:uu})],Vi.prototype,"pointSymbol",void 0),d([p({types:uu})],Vi.prototype,"polygonSymbol",void 0),d([p({types:uu})],Vi.prototype,"polylineSymbol",void 0),d([p()],Vi.prototype,"meshSymbol",void 0),d([p({type:L7,nonNullable:!0})],Vi.prototype,"snappingOptions",null),d([p()],Vi.prototype,"_snappingManager",void 0),d([p({readOnly:!0})],Vi.prototype,"state",null),d([p({type:Cve,nonNullable:!0})],Vi.prototype,"tooltipOptions",void 0),d([p({readOnly:!0})],Vi.prototype,"updateGraphics",void 0),d([p()],Vi.prototype,"updateOnGraphicClick",void 0),d([p({types:uu})],Vi.prototype,"vertexSymbol",void 0),d([p({value:null})],Vi.prototype,"view",null),Vi=d([A("esri.widgets.Sketch.SketchViewModel")],Vi);const Int="sketch:missing-property",Eee=t=>`Property '${t}' is missing on SketchViewModel.`;function Tnt(t){return t==="polygon"||t==="rectangle"||t==="circle"}function ZM(t,e){Kve("undo",t.history.undo,t.history.redo,e)}function YM(t,e){Kve("redo",t.history.redo,t.history.undo,e)}function Kve(t,e,i,r){const n=e.pop();if(!n)return;const s=n.updates,o=[];r.forEach((a,l)=>{const c=s[l];c!=null&&("geometry"in c&&c.geometry!=null&&(o.push({geometry:a.geometry}),a.geometry=c.geometry),"symbol"in c&&c.symbol!=null&&(o.push({symbol:a.symbol}),a.symbol=c.symbol),"undo"in c&&(o.push(c),c[t](a)))}),i.push({updates:o})}function rh(t){return{updates:t.map(e=>({geometry:e.geometry}))}}function fn(t){return"requireError"in t&&t.requireError==="aborted"}const Xve=Vi;var Mi,Ha;function Cnt(t){return t==="2d"?new q1({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",effects:[{type:"CIMGeometricEffectDashes",dashTemplate:[5,4],lineDashEnding:"FullGap",controlPointEnding:"NoConstraint"}],enable:!0,capStyle:"Butt",joinStyle:"Round",width:1.5,color:[0,0,0,255]},{type:"CIMSolidStroke",enable:!0,capStyle:"Butt",joinStyle:"Round",width:1.5,color:[255,255,255,255]}]}}}):new Yn({color:[0,0,0,0]})}(function(t){t.Ready="ready",t.Creating="creating",t.Reshaping="reshaping",t.ReshapingDisabled="rehsaping-disabled",t.Selecting="selecting",t.Selected="selected"})(Mi||(Mi={})),function(t){t.View="view",t.Main="main",t.Interaction="interaction"}(Ha||(Ha={}));let ja=class extends he{constructor(e){super(e),this.state=Mi.Ready,this._handles=new gs,this._pendingStartOptions=null,this._previousInputInfo=null,this._shouldRemoveLastPoint=!1,this._sketchedGraphics=new WeakSet,this._creationToolPromise=null,this._updateToolPromise=null,this._updateDisabled=!1}initialize(){this._handles.add(J(()=>({view:this.tool.viewModel.view,visible:this.tool.visible}),({view:e,visible:i})=>{e!=null&&i?this._attach(e):this._detach()},ji),Ha.View)}destroy(){this._detach(),this._handles=je(this._handles)}get canStopCreating(){const e=this._geometry,i=this._shouldRemoveLastPoint?3:2;return qC(e)&&e.paths.length>0&&e.paths[0].length>=i}get _input(){return this.tool.viewModel.input}set _input(e){this.tool.viewModel.input=e}get _geometry(){return lt(this._input,e=>e.geometry)}get _visibleAndEditable(){return this.tool.visible&&this.tool.editable}get _view(){return this.tool.viewModel.view}get test(){return{sketchVM:this._sketchVM,toolPromise:Promise.all([this._creationToolPromise??Promise.resolve(),this._updateToolPromise??Promise.resolve()])}}start(e={mode:"sketch"}){if(!this.tool.editable)return;const i=this._view;if(i!=null&&i.ready)switch(this._pendingStartOptions=null,this._stopInteraction(),this._previousInputInfo==null&&this._storePreviousInput(this._input),this._setSketchedGraphic(null),e.mode){case"sketch":this._set("state",Mi.Creating),this._startCreationInteraction();break;case"select":this._set("state",Mi.Selecting),this._startSelectionInteraction()}else this._pendingStartOptions=e}stop(){this._pendingStartOptions=null,this._stopInteractionAndUpdate(),this._clearPreviousInput()}cancel(){this._pendingStartOptions=null,this._stopInteractionAndUpdate(),this._restorePreviousInput()}clear(){this._stopInteractionAndUpdate(),this._set("state",Mi.Ready),this._clearPreviousInput(),this._input=null,this._pendingStartOptions=null}isSketchedGraphic(e){return e!=null&&this._sketchedGraphics.has(e)}_attach(e){this._detach();const i={mode:e.type==="3d"?"relative-to-ground":"on-the-ground",offset:null};this._graphicsLayer=new C7({listMode:"hide",internal:!0,elevationInfo:i});const r=Cnt(e.type);this._sketchVM=new Xve({layer:this._graphicsLayer,view:e,defaultCreateOptions:{mode:"click",hasZ:!1},updateOnGraphicClick:!1,defaultUpdateOptions:{reshapeOptions:{shapeOperation:"none"},enableRotation:!1,enableScaling:!1,enableMoveAllGraphics:!1,enableZ:!1,multipleSelectionEnabled:!1,toggleToolOnClick:!1,tool:"reshape"},polylineSymbol:r,activeLineSymbol:r}),this._handles.add([tn(()=>e.ready,()=>lt(this._pendingStartOptions,n=>this.start(n)),ji),J(()=>[this._input,this._visibleAndEditable],()=>this._update(),ji),J(()=>({map:e.map,graphicsLayer:this._graphicsLayer}),({map:n,graphicsLayer:s})=>{n!=null&&s!=null&&n.add(s),this._update()},ji)],Ha.Main)}_detach(){this._handles.remove(Ha.Main),this._sketchVM=je(this._sketchVM),this._creationToolPromise=null,this._updateToolPromise=null;const e=lt(this._view,r=>r.map),i=this._graphicsLayer;e!=null&&i!=null&&e.remove(i),this._graphicsLayer=je(this._graphicsLayer),this._shouldRemoveLastPoint=!1,this._set("state",Mi.Ready)}_startCreationInteraction(){this._stopInteractionAndUpdate();const e=this._view,i=this._sketchVM;if(e==null||i==null)return;this._shouldRemoveLastPoint=!1;const r=i.on("create",s=>{var a;const o=s.graphic;switch(s.state){case"complete":this._shouldRemoveLastPoint=!1,this._setSketchedGraphic(o),this._stopInteractionAndUpdate(),this._clearPreviousInput();break;case"cancel":this.cancel();break;case"active":this._setSketchedGraphic(o),((a=s.toolEventInfo)==null?void 0:a.type)==="cursor-update"&&(this._shouldRemoveLastPoint=!0);break;case"start":this._setSketchedGraphic(o)}}),n=()=>{r.remove();const s=this.canStopCreating,o=lt(this._geometry,a=>a.clone());i.cancel(),this._creationToolPromise=null,o!=null&&s?this._shouldRemoveLastPoint&&this._setSketchedGraphic(new Or({geometry:Ent(o)})):this._input=null};this._handles.remove(Ha.Interaction),this._handles.add(Et(n),Ha.Interaction),this._creationToolPromise=$d(i.create("polyline"))}_startReshapeInteraction(){this._stopInteraction();const e=this._view,i=this._sketchVM;if(e==null||i==null)return;const r=i.on("update",s=>{const o=s.graphics[0];switch(s.state){case"complete":this._setSketchedGraphic(o),this._stopInteractionAndUpdate(),this._clearPreviousInput();break;case"active":case"start":this._setSketchedGraphic(o)}}),n=()=>{r.remove(),i.cancel(),this._updateToolPromise=null};this._handles.remove(Ha.Interaction),this._handles.add(Et(n),Ha.Interaction),lt(this._input,s=>{s.visible=!0,this._updateToolPromise=$d(i.update(s,{tool:"reshape"}))})}_startSelectionInteraction(){this._stopInteraction();const e=this._view;if(e==null)return;const i=e.cursor,r=Et(()=>e.cursor=i);e.cursor="crosshair",e.closePopup();let n=null;const s=Et(()=>Qr(n)),o=e.on("immediate-click",l=>{l.preventDefault(),l.stopPropagation(),Qr(n),n=Cp(async c=>{const{results:u}=await e.hitTest(l);_t(c);const h=u.filter(f=>f.type==="graphic"&&f.graphic!=null).map(f=>f.graphic).find(f=>f.geometry!=null&&f.geometry.type==="polyline");h&&(this._input=h,this._clearPreviousInput(),this._stopInteractionAndUpdate())})}),a=e.on("key-down",l=>{l.key==="Escape"&&this.cancel()});this._handles.remove(Ha.Interaction),this._handles.add([o,a,s,r],Ha.Interaction),e.ready&&e.focus()}_stopInteraction(){this._handles.remove(Ha.Interaction)}_stopInteractionAndUpdate(){this._handles.has(Ha.Interaction)&&(this._updateDisabled=!0,this._stopInteraction(),this._updateDisabled=!1,this._triggerUpdate())}_triggerUpdate(){this._set("state",Mi.Ready),this._update()}_update(){if(this._updateDisabled)return;const e=this.state;if(e!==Mi.Selecting){if(this._visibleAndEditable){if(e===Mi.Creating||e===Mi.Reshaping&&this.isSketchedGraphic(this._input))return}else this.cancel();this._set("state",this._getNextState()),this._updateVisuals()}else this.stop()}_getNextState(){return this._input==null?Mi.Ready:this.isSketchedGraphic(this._input)?this.state===Mi.Creating?Mi.Creating:this._visibleAndEditable?Mi.Reshaping:Mi.ReshapingDisabled:Mi.Selected}_updateVisuals(){switch(this.state){case Mi.Creating:break;case Mi.Reshaping:this._startReshapeInteraction();break;case Mi.ReshapingDisabled:{this._stopInteractionAndUpdate();const e=this._input;e!=null&&this.isSketchedGraphic(e)&&(e.visible=!1);break}case Mi.Ready:case Mi.Selected:this._stopInteractionAndUpdate();case Mi.Selecting:}this._updateSketchedGraphic()}_storePreviousInput(e){this._previousInputInfo={graphic:e}}_restorePreviousInput(){const e=this._previousInputInfo;e!=null&&(this._clearPreviousInput(),this._input=e.graphic,this._triggerUpdate())}_clearPreviousInput(){this._previousInputInfo=null}_updateSketchedGraphic(){const e=this._graphicsLayer;if(e==null)return;const i=e.graphics,r=this._input;if(r==null||!this.isSketchedGraphic(r))return void i.removeAll();if(i.indexOf(r)===-1)i.removeAll(),i.add(r);else if(i.length!==1){const n=i.filter(s=>s!==r);i.removeMany(n)}}_setSketchedGraphic(e){e!=null&&this._sketchedGraphics.add(e),this._input=e,this._updateSketchedGraphic()}};function Ent(t){if(qC(t)){const e=t.clone();return e.paths=[e.paths[0].slice(0,-1)],e}return t}d([p({nonNullable:!0})],ja.prototype,"state",void 0),d([p({nonNullable:!0})],ja.prototype,"tool",void 0),d([p()],ja.prototype,"canStopCreating",null),d([p()],ja.prototype,"_graphicsLayer",void 0),d([p()],ja.prototype,"_sketchVM",void 0),d([p()],ja.prototype,"_input",null),d([p()],ja.prototype,"_geometry",null),d([p()],ja.prototype,"_visibleAndEditable",null),d([p()],ja.prototype,"_view",null),d([p()],ja.prototype,"_shouldRemoveLastPoint",void 0),ja=d([A("esri.widgets.ElevationProfile.ElevationProfileInteraction")],ja);let YA=class extends he{constructor(e){super(e),this._implementation=null,this._loadingTask=null,this._handles=new gs}initialize(){this._handles.add(J(()=>({tool:this.tool,view:this.tool.viewModel.view,visible:this.tool.visible&&!!lt(this.tool.viewModel.view,e=>e.ready)}),({tool:e,view:i,visible:r})=>{i!=null&&r?this._show(i,e):this._hide()},ji))}destroy(){this._handles=je(this._handles),this._hide()}_show(e,i){this._loadingTask=Qr(this._loadingTask),this._loadingTask=Cp(async r=>{if(e.type==="2d"){const n=W(()=>import("./ElevationProfileView2D-7e7cc2c8.js"),["./ElevationProfileView2D-7e7cc2c8.js","./HoveredPoints-d95ec057.js"],import.meta.url),s=(await gu(n,r)).ElevationProfileView2D;this._implementation=new s(e,i)}else if(e.type==="3d"){const n=W(()=>import("./ElevationProfileView3D-666b3dc4.js"),["./ElevationProfileView3D-666b3dc4.js","./HoveredPoints-d95ec057.js","./OutlineVisualElement-ff6b5a6c.js","./analysisThemeUtils-3cf20539.js","./colorUtils-25efbfd5.js","./vec4f32-0d1b2306.js","./Octree-ae9c8fa1.js","./line-9c06e0c1.js","./DoubleArray-2809526b.js","./FloatArray-05b27bae.js","./requestImageUtils-89ae2d39.js","./basicInterfaces-bb952591.js","./enums-b14466b3.js","./Texture-eb8cd14a.js","./Indices-e7e8209a.js","./triangle-345bd9b9.js","./doublePrecisionUtils-e3c3d0d8.js","./BufferView-82913510.js","./VertexElementDescriptor-2925c6af.js","./VertexArrayObject-08f516fe.js","./OrderIndependentTransparency-b8ef1857.js","./hydratedFeatures-f829a4ca.js","./triangulationUtils-675e3260.js","./earcut-6b48af20.js","./deduplicate-58dc069a.js","./NestedMap-1b5db22e.js","./InterleavedLayout-dee9d785.js","./types-1305598a.js","./floatRGBA-de0614b2.js","./glUtil-0b7ee6ea.js"],import.meta.url),s=(await gu(n,r)).ElevationProfileView3D;this._implementation=new s(e,i)}})}_hide(){this._loadingTask=Qr(this._loadingTask),this._implementation=je(this._implementation)}};d([p()],YA.prototype,"tool",void 0),YA=d([A("esri.widgets.ElevationProfile.support.ElevationProfileView")],YA);let Ah=class extends he{constructor(e){super(e),this.editable=!0,this.visible=!0,this.highlightEnabled=!0}initialize(){this.view=new YA({tool:this}),this.interaction=new ja({tool:this})}destroy(){this.interaction.destroy(),this.view.destroy()}get state(){var i;switch((i=this.interaction)==null?void 0:i.state){case Mi.Ready:return ya.Ready;case Mi.Creating:return ya.Creating;case Mi.Selecting:return ya.Selecting;case Mi.Selected:return ya.Selected;case Mi.Reshaping:case Mi.ReshapingDisabled:return ya.Created}}};d([p({nonNullable:!0})],Ah.prototype,"viewModel",void 0),d([p()],Ah.prototype,"view",void 0),d([p()],Ah.prototype,"interaction",void 0),d([p()],Ah.prototype,"editable",void 0),d([p()],Ah.prototype,"visible",void 0),d([p()],Ah.prototype,"highlightEnabled",void 0),Ah=d([A("esri.widgets.ElevationProfile.ElevationProfileTool")],Ah);let jt=class extends he{constructor(e){super(e),this.view=null,this.input=null,this._getEffectiveUnitsMemoized=ec((i,r)=>({distance:i,elevation:r})),this.geodesicDistanceThreshold=1e5,this.hoveredChartPosition=null,this.uniformChartScaling=!1,this.defaultUnit=null,this.queue=null,this._currentTileCache=null,this.error=null,this._defaultProfileLineGround=new R0e,this._userUnitOptions=null,this._userUnit=null,e!=null&&e.profiles||(this.profiles=new ye([this._defaultProfileLineGround]))}initialize(){this.addHandles(J(()=>this.view,e=>{var n;if(e==null)return void ie.getLogger(this).warnOnce("no view. Widget will be disabled until a view is provided.");this.removeHandles(Mee);const i=e.type==="3d"?e.resourceController:void 0;(n=this.queue)==null||n.destroy(),this.queue=Get(i==null?void 0:i.scheduler);const r=i==null?void 0:i.addUpdatingObject(this);r&&this.addHandles(r,Mee)},ji)),this.tool=new Ah({viewModel:this}),this._controller=new Zf({viewModel:this})}destroy(){this._defaultProfileLineGround=je(this._defaultProfileLineGround),this._controller=je(this._controller),this._currentTileCache=je(this._currentTileCache),this.tool=je(this.tool),this.queue=je(this.queue)}get profiles(){return this._get("profiles")}set profiles(e){const i=this._get("profiles"),r=e??new ye;this._set("profiles",rg(r,i))}get state(){const e=this.view;return e!=null&&e.ready?this.tool.state:ya.Disabled}get progress(){let e=0,i=0;for(const r of this.visibleProfiles)e++,i+=r.progress;return e>0?i/e:0}set unitOptions(e){this._userUnitOptions=e,this._set("unitOptions",this._filteredOrAllUnits(this._userUnitOptions))}get unitOptions(){return this._filteredOrAllUnits(this._userUnitOptions)}set unit(e){this._userUnit=e?this._findSelectableUnit(e,this._userUnit):null,this.notifyChange("unit")}get unit(){return this._userUnit?(this._userUnit=this._findSelectableUnit(this._userUnit,this.defaultUnit),this._userUnit):this._findSelectableUnit(this.defaultUnit)}get effectiveUnits(){const e=zet(this.visibleProfiles.map(n=>n.result)),i=g2e(e.maxDistance,"meters",this.unit),r=y2e(e.maxElevation,"meters",this.unit);return this._getEffectiveUnitsMemoized(i,r)}get highlightEnabled(){return this.tool.highlightEnabled}set highlightEnabled(e){this.tool.highlightEnabled=e}get hasVertices(){const e=lt(this.input,i=>i.geometry);return qC(e)&&e.paths.reduce((i,r)=>i+r.length,0)>0}get hoveredPoints(){return this.input!=null&&this.visible&&this.tool.editable?this.visibleProfiles.map(e=>{const i=e.hoveredPoint;return i!=null?{hoveredPoint:i,color:e.color}:null}).filter(Dt):[]}get statistics(){return Vet(this.visibleProfiles.map(e=>e.statistics))}get chartData(){if(this.input==null)return null;const{effectiveUnits:e,progress:i,statistics:r,visibleProfiles:n,uniformChartScaling:s}=this,o=n.filter(a=>a.hasZ).map(a=>({id:a.id,type:a.type,title:a.title,color:a.color,samples:a.samples,progress:a.progress,chartFillEnabled:a.chartFillEnabled,chartStrokeWidth:a.chartStrokeWidth,chartStrokeOffsetY:a.chartStrokeOffsetY,viewVisualizationEnabled:a.viewVisualizationEnabled}));return o.length===0?null:{lines:o,effectiveUnits:e,statistics:r,refined:i===1,dynamicElevationRange:n.some(a=>a.type==="view"),uniformScaling:s}}get visibleProfiles(){return this.profiles.toArray().filter(e=>e.available&&e.visible)}get minDemResolutions(){const e=[];for(const{minDemResolution:i}of this.visibleProfiles)i!=null&&e.push(i);return e}get minDemResolution(){return Sre(this.minDemResolutions)}get errorState(){const e=lt(this.input,i=>i.geometry);if(!p7(e))return Tn.NoValidInput;if(this.error!=null){if(Tet(this.error))switch(this.error.cause){case tc.TooComplex:return Tn.TooComplex;case tc.InvalidGeometry:return Tn.InvalidGeometry;case tc.InvalidElevationInfo:return Tn.InvalidElevationInfo;case tc.ElevationQueryError:return Tn.NoValidInput}return Tn.UnknownError}return this.visibleProfiles.length===0?Tn.NoVisibleProfiles:this.chartData==null&&this.progress===1?Tn.RefinedButNoChartData:Tn.None}get tileCache(){var i;this._currentTileCache=je(this._currentTileCache);const e=this.view;if(e!=null&&(e==null?void 0:e.type)==="3d"){const r=(i=e.basemapTerrain)==null?void 0:i.elevationQueryCache;if(r!=null)return r}return this._currentTileCache==null&&(this._currentTileCache=new qQe(new LL(20*Dv.MEGABYTES))),this._currentTileCache}get visible(){return this.tool.visible}set visible(e){this.tool.visible=e}get inputIsSketched(){return this.tool.interaction.isSketchedGraphic(this.input)}get elevationProvider(){const e=this.view;return e!=null&&e.type==="3d"?e.elevationProvider:null}get updating(){const{progress:e}=this;return e>0&&e<1}start(e){this.tool.interaction.start(e)}stop(){this.tool.interaction.stop()}cancel(){this.tool.interaction.cancel()}clear(){this.tool.interaction.clear()}_findSelectableUnit(e,i){const r=this.unitOptions;return e!=null&&r.includes(e)?e:i?this._findSelectableUnit(i):r[0]}_filteredOrAllUnits(e){const i=(e??[]).filter(r=>zk.includes(r));return i.length===0?zk.slice():i}};d([p()],jt.prototype,"view",void 0),d([p({type:Or})],jt.prototype,"input",void 0),d([p({type:Prt,nonNullable:!0})],jt.prototype,"profiles",null),d([p({readOnly:!0})],jt.prototype,"state",null),d([p({readOnly:!0})],jt.prototype,"progress",null),d([p()],jt.prototype,"unitOptions",null),d([p()],jt.prototype,"unit",null),d([p({readOnly:!0})],jt.prototype,"effectiveUnits",null),d([p({type:Number})],jt.prototype,"geodesicDistanceThreshold",void 0),d([p()],jt.prototype,"hoveredChartPosition",void 0),d([p()],jt.prototype,"uniformChartScaling",void 0),d([p()],jt.prototype,"highlightEnabled",null),d([p({readOnly:!0})],jt.prototype,"hoveredPoints",null),d([p({readOnly:!0})],jt.prototype,"statistics",null),d([p()],jt.prototype,"chartData",null),d([p()],jt.prototype,"visibleProfiles",null),d([p()],jt.prototype,"minDemResolutions",null),d([p({readOnly:!0})],jt.prototype,"minDemResolution",null),d([p({readOnly:!0})],jt.prototype,"errorState",null),d([p(JQe)],jt.prototype,"defaultUnit",void 0),d([p()],jt.prototype,"queue",void 0),d([p()],jt.prototype,"tileCache",null),d([p()],jt.prototype,"tool",void 0),d([p()],jt.prototype,"visible",null),d([p()],jt.prototype,"error",void 0),d([p()],jt.prototype,"inputIsSketched",null),d([p()],jt.prototype,"elevationProvider",null),d([p()],jt.prototype,"updating",null),d([p()],jt.prototype,"_defaultProfileLineGround",void 0),d([p()],jt.prototype,"_userUnitOptions",void 0),d([p()],jt.prototype,"_controller",void 0),d([p()],jt.prototype,"_userUnit",void 0),jt=d([A("esri.widgets.ElevationProfile.ElevationProfileViewModel")],jt);const Mee=Symbol("updating-object"),Qve=jt;let Wc=class extends he{constructor(){super(...arguments),this.legend=!0,this.chart=!0,this.clearButton=!0,this.settingsButton=!0,this.sketchButton=!0,this.selectButton=!0,this.unitSelector=!0,this.uniformChartScalingToggle=!0}};d([p()],Wc.prototype,"legend",void 0),d([p()],Wc.prototype,"chart",void 0),d([p()],Wc.prototype,"clearButton",void 0),d([p()],Wc.prototype,"settingsButton",void 0),d([p()],Wc.prototype,"sketchButton",void 0),d([p()],Wc.prototype,"selectButton",void 0),d([p()],Wc.prototype,"unitSelector",void 0),d([p()],Wc.prototype,"uniformChartScalingToggle",void 0),Wc=d([A("esri.widgets.ElevationProfile.ElevationProfileVisibleElements")],Wc);const e_e=Wc;function R7(t,e,i){return t.units[e][i]}function Wd(t,e,i,r=2,n="abbr"){return`${po(e,{minimumFractionDigits:r,maximumFractionDigits:r,signDisplay:e>0?"never":"exceptZero"})} ${R7(t,i,n)}`}function PR(t,e,i,r=2,n="abbr"){return`${po(e,{minimumFractionDigits:r,maximumFractionDigits:r,signDisplay:"exceptZero"})} ${R7(t,i,n)}`}function kIt(t,e,i,r=2,n="abbr"){const s=fB(e,i);return Wd(t,bt(e,i,s),s,r,n)}function PIt(t,e,i,r=2,n="abbr"){const s=fB(e,i);return PR(t,bt(e,i,s),s,r,n)}function OIt(t,e,i,r=2,n="abbr"){const s=mB(e,i);return Wd(t,bt(e,i,s),s,r,n)}function LIt(t,e,i,r=2,n="abbr"){const s=mB(e,i);return PR(t,bt(e,i,s),s,r,n)}function RIt(t,e,i,r=2,n="abbr"){const s=gB(e,i);return Wd(t,bt(e,i,s),s,r,n)}function FIt(t,e,i,r=2,n="abbr"){const s=gB(e,i);return PR(t,bt(e,i,s),s,r,n)}function DIt(t,e,i,r=2,n="abbr"){const s=yB(e,i);return Wd(t,bt(e,i,s),s,r,n)}function NIt(t,e,i,r=2,n="abbr"){const s=yB(e,i);return PR(t,bt(e,i,s),s,r,n)}function VIt(t,e,i,r=2,n="abbr"){const s=v2e(e,i);return Wd(t,bt(e,i,s),s,r,n)}function zIt(t,e,i,r=2,n="abbr"){const s=_2e(e,i);return Wd(t,bt(e,i,s),s,r,n)}function $ee(t,e,i,r,n){n=n??2;let s=Ele.normalize(Mnt(bt(t,e,"degrees"),i,r),0,!0);const o={style:"unit",unitDisplay:"narrow",unit:"degree",maximumFractionDigits:n,minimumFractionDigits:n,signDisplay:s>0?"never":"exceptZero"};return s=t_e(s,o),po(s,o)}function jIt(t,e,i,r,n){i!==r&&(t=-t);const s={style:"unit",unitDisplay:"narrow",unit:"degree",maximumFractionDigits:n=n??2,minimumFractionDigits:n,signDisplay:"exceptZero"};let o=bt(t,e,"degrees")%360;return o=t_e(o,s),po(o,s)}const Aee=new Map;function t_e(t,e){const i=JSON.stringify(e);let r=Aee.get(i);return r||(r=new Intl.NumberFormat("en-US",e),Aee.set(i,r)),/\-?\+?360/.test(r.format(t))?0:t}function Mnt(t,e,i){if(e===i)return t;switch(i){case"arithmetic":return $nt(t);case"geographic":return Ant(t)}}function $nt(t){return 90-t}function Ant(t){return-t-90}const kee=["B","kB","MB","GB","TB"];function knt(t,e){let i=e===0?0:Math.floor(Math.log(e)/Math.log(Dv.KILOBYTES));i=Pn(i,0,kee.length-1);const r=po(e/Dv.KILOBYTES**i,{maximumFractionDigits:2});return oc(t.units.bytes[kee[i]],{fileSize:r})}const Pnt=100;let d0=class extends di{constructor(e,i){super(e,i),this._updateLayout=r=>{const n=r.parentElement,s=r.style.display;n==null||n.removeChild(r),document.body.appendChild(r),r.style.display="block";let o=80;for(const a of r.childNodes)a instanceof HTMLElement&&(o=Math.max(o,a.offsetWidth));document.body.removeChild(r),n==null||n.appendChild(r),r.style.display=s,r.style.setProperty("--max-width",`${o}px`)},this._updateLayoutThrottled=u0e(this._updateLayout,Pnt)}initialize(){this.addHandles(this._updateLayoutThrottled)}render(){return M("div",{bind:this,class:Yg.base,afterCreate:this._updateLayout,afterUpdate:this._updateLayoutThrottled},this._renderStatistics())}_renderStatistics(){var i;const e=(i=this._messages)==null?void 0:i.statistics;return e?[this._renderDistanceStatistic("maxDistance",e.maxDistance),this._renderElevationStatistic("elevationGain",e.gain),this._renderElevationStatistic("elevationLoss",e.loss),this._renderElevationStatistic("minElevation",e.minElevation),this._renderElevationStatistic("maxElevation",e.maxElevation),this._renderElevationStatistic("avgElevation",e.avgElevation),this._renderSlopeStatistic("maxPositiveSlope","maxNegativeSlope",e.maxSlope),this._renderSlopeStatistic("avgPositiveSlope","avgNegativeSlope",e.avgSlope)]:[]}_renderDistanceStatistic(e,i){const r=co().formatPrecision,n=this._renderValue(e,s=>{const o=this.effectiveUnits.distance;return Wd(this._messagesUnits,s,o,r)});return this._renderStatistic(i,n)}_renderElevationStatistic(e,i){const r=co().formatPrecision,n=this._renderValue(e,s=>{const o=this.effectiveUnits.elevation;return Wd(this._messagesUnits,s,o,r)});return this._renderStatistic(i,n)}_renderSlopeStatistic(e,i,r){const n=co().formatPrecision,s=M("div",{key:"slope-up",class:Yg.slopeValue},M("div",{class:Yg.slopeUpIcon}),this._renderValue(e,o=>$ee(o,"degrees","geographic","geographic",n)),M("div",{class:Yg.slopeDownIcon}),this._renderValue(i,o=>$ee(o,"degrees","geographic","geographic",n)));return this._renderStatistic(r,s)}_renderStatistic(e,i){return M("div",{class:Yg.statistic},M("label",{class:Yg.statisticLabel},e),M("div",{class:Yg.statisticValue},i))}_renderValue(e,i){const r=this.line,n=r.progress===1?r.statistics:null,s=lt(n,o=>o[e]);return s!=null?i(s):T0e}};d([p()],d0.prototype,"effectiveUnits",void 0),d([p()],d0.prototype,"line",void 0),d([p(),ut("esri/widgets/ElevationProfile/t9n/ElevationProfile")],d0.prototype,"_messages",void 0),d([p(),ut("esri/core/t9n/Units")],d0.prototype,"_messagesUnits",void 0),d0=d([A("esri.widgets.ElevationProfile.Statistics")],d0);function F8(t,{profiles:e}){const i=t.title;if(i!=null)return i;switch(t.type){case"ground":return e.ground;case"input":return e.input;case"query":return e.query;case"view":return e.view;default:return""}}let Jc=class extends di{constructor(e,i){super(e,i),this.expanded=!1,this.checkboxVisible=!0,this._messages=null}initialize(){this._statistics=new d0(this._statisticsProps),this.addHandles(J(()=>this._statisticsProps,e=>this._statistics.set(e)))}destroy(){this._statistics=je(this._statistics)}render(){const e=this.expanded;return M("div",{key:this,class:this.classes(yl.base,{[yl.disabled]:this.disabled,[yl.expanded]:e})},this._renderColorIndicator(),M("div",{key:"header",class:yl.header},this._renderLabelWithCheckbox(),this._renderCollapseToggleButton()),e&&M("div",{key:"content",class:yl.content},this._statistics.render()))}get disabled(){return!this.line.available}get _statisticsProps(){return{line:this.line,effectiveUnits:this.effectiveUnits}}_renderColorIndicator(){return M("div",{key:"color-indicator",class:yl.colorIndicator,styles:{backgroundColor:this.line.color.toCss()}})}_renderCollapseToggleButton(){const e=this._messages,i=this.expanded?e.hideDetails:e.showDetails;return M("button",{key:"collapse-toggle",bind:this,class:yl.collapseToggle,onclick:this._onCollapseToggleClick,title:i,"aria-label":i,type:"button"},M("span",{class:yl.collapseToggleIcon}))}_onCollapseToggleClick(){this.onExpandedToggle()}_renderLabelWithCheckbox(){const{line:e,checkboxVisible:i,disabled:r}=this,n=`${yl.base}__check-${e.id}`;return M("label",{key:"id",for:n,class:this.classes(yl.label,{[yl.labelDisabled]:r||!i})},i&&this._renderCheckbox(n),M("span",null,F8(e,this._messages)))}_renderCheckbox(e){const i=this.line,r=i.visible,n=this.disabled,s=this._messages,o=r?s.hideProfile:s.showProfile,a=F8(i,this._messages),l=Os(o,{name:a});return M("input",{key:"checkbox",id:e,type:"checkbox",class:yl.checkbox,title:l,checked:r,disabled:n,"aria-label":l,bind:this,onchange:c=>this._onCheckboxToggle(c,i)})}_onCheckboxToggle(e,i){e.stopPropagation(),i.toggleVisibility()}};d([p({nonNullable:!0})],Jc.prototype,"effectiveUnits",void 0),d([p({nonNullable:!0})],Jc.prototype,"line",void 0),d([p()],Jc.prototype,"expanded",void 0),d([p()],Jc.prototype,"disabled",null),d([p()],Jc.prototype,"checkboxVisible",void 0),d([p()],Jc.prototype,"onExpandedToggle",void 0),d([p()],Jc.prototype,"_statistics",void 0),d([p(),ut("esri/widgets/ElevationProfile/t9n/ElevationProfile")],Jc.prototype,"_messages",void 0),Jc=d([A("esri.widgets.ElevationProfile.LegendItem")],Jc);let h0=class extends di{constructor(e,i){super(e,i),this._items=new ye,this._expandedLine=null}initialize(){this.addHandles([J(()=>this.profiles,e=>{this._destroyItems(),this._items.addMany(e.map(i=>this._createItemForLine(i)))},Le),J(()=>this.effectiveUnits,e=>{this._items.forEach(i=>{i.effectiveUnits=e})},Le)])}destroy(){this._destroyItems()}render(){return M("div",{class:HQe.base},this._items.toArray().map(e=>e.render()))}_onExpandedToggle(e){this._expandedLine=e===this._expandedLine?null:e,this._items.forEach(i=>i.expanded=i.line===this._expandedLine)}_createItemForLine(e){return new Jc({line:e,effectiveUnits:this.effectiveUnits,expanded:e===this._expandedLine,checkboxVisible:this.profiles.length>1,onExpandedToggle:()=>this._onExpandedToggle(e)})}_destroyItems(){this._items.drain(e=>e.destroy())}};d([p()],h0.prototype,"profiles",void 0),d([p()],h0.prototype,"effectiveUnits",void 0),d([p()],h0.prototype,"_items",void 0),d([p()],h0.prototype,"_expandedLine",void 0),h0=d([A("esri.widgets.ElevationProfile.Legend")],h0);let p0=class extends di{constructor(e,i){super(e,i),this._popover=null,this._buttonElement=null,this._focusOutElement=null,this._requestFocusOnCreate=!1}destroy(){this._destroyPopover()}render(){const{unitSelector:e,uniformChartScalingToggle:i}=this.visibleElements;if(!e&&!i)return M("div",{key:`${this.id}-empty`});const r=this._popover!=null&&this._popover.open?this._messages.hideSettings:this._messages.showSettings;return M("button",{class:Xg.base,title:r,bind:this,afterCreate:this._initializePopover,onclick:this._togglePopover,"aria-label":r,type:"button"})}_initializePopover(e){this._destroyPopover(),this._buttonElement=e,this._popover=new yG({owner:this,placement:"bottom-end",offset:[0,0],anchorElement:e,renderContentFunction:()=>this._renderPopoverContent()})}_destroyPopover(){this._focusOutElement=$i(this._focusOutElement),this._popover=je(this._popover)}_renderPopoverContent(){const{unitSelector:e,uniformChartScalingToggle:i}=this.visibleElements;return M("div",{class:Xg.popoverContent,dir:$ce(this._buttonElement),bind:this,afterCreate:this._onPopoverContentAfterCreate},e&&this._renderUnitSelector(),i&&this._renderUniformChartScalingToggle())}_renderUnitSelector(){const{unit:e,unitOptions:i}=this.viewModel,r=this._messagesUnits;return M("label",{key:"unit-selector-label",class:Xg.selectLabel},this._messages.unitSelectLabel,M("select",{class:Xg.select,value:e,bind:this,onchange:this._onUnitChange,afterCreate:this._onUnitSelectAfterCreate},i.map(n=>M("option",{key:n,value:n},m2e(n)?r.systems[n]:r.units[n].pluralCapitalized))))}_onUnitChange(e){this.viewModel.unit=e.target.value}_onUnitSelectAfterCreate(e){this._requestFocusOnCreate&&(this._requestFocusOnCreate=!1,e.focus())}_renderUniformChartScalingToggle(){const e=this._messages,i=this.viewModel.uniformChartScaling,r=i?e.uniformChartScalingDisable:e.uniformChartScalingEnable;return M("label",{key:"uniform-chart-scaling-label",class:Xg.checkboxLabel,onmousedown:Ont},M("input",{class:this.classes(Xg.checkbox,Xg.uniformChartScalingCheckbox),type:"checkbox",checked:i,title:r,"aria-label":r,bind:this,onchange:this._onUniformChartScalingChange}),e.uniformChartScalingLabel)}_onUniformChartScalingChange(e){this.viewModel.uniformChartScaling=e.target.checked}_togglePopover(e){this._popover!=null&&this._popover.open?this._closePopover():this._openPopover()}_openPopover(){lt(this._popover,e=>e.open=!0),this._requestFocusOnCreate=!0}_closePopover({focusOnButton:e=!0}={}){lt(this._popover,i=>i.open=!1),e&&lt(this._buttonElement,i=>i.focus())}_onPopoverContentAfterCreate(e){$i(this._focusOutElement),this._focusOutElement=Wh(e,"focusout",({relatedTarget:i})=>{const r=e.contains(i),n=i===this._buttonElement;r||n||this._closePopover({focusOnButton:!1})})}};function Ont(t){t.preventDefault()}d([p()],p0.prototype,"viewModel",void 0),d([p()],p0.prototype,"visibleElements",void 0),d([p(),ut("esri/widgets/ElevationProfile/t9n/ElevationProfile")],p0.prototype,"_messages",void 0),d([p(),ut("esri/core/t9n/Units")],p0.prototype,"_messagesUnits",void 0),p0=d([A("esri.widgets.ElevationProfile.SettingsButton")],p0);function Lnt(t,e,i=10){const r=Pee(e-t,!1);if(r===0)return[t,e];const n=Pee(r/(i-1),!0);return[Math.floor(t/n)*n,Math.ceil(e/n)*n]}function Pee(t,e){const i=Math.floor(Math.log10(t)),r=t/10**i;let n;return n=e?r<1.5?1:r<3?2:r<5?2.5:r<7?5:10:r<=1?1:r<=2?2:r<=3?2.5:r<=5?5:10,n*10**i}const Oee="en-us",F7=new Map([["ar",()=>W(()=>import("./ar-04a22104.js"),["./ar-04a22104.js","./commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.a)],["bg-bg",()=>W(()=>import("./bg_BG-62b361fa.js"),["./bg_BG-62b361fa.js","./commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.b)],["bs-ba",()=>W(()=>import("./bs_BA-5698df01.js"),["./bs_BA-5698df01.js","./commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.b)],["ca-es",()=>W(()=>import("./ca_ES-88d73256.js"),["./ca_ES-88d73256.js","./commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.c)],["cs-cz",()=>W(()=>import("./cs_CZ-a67293a8.js"),["./cs_CZ-a67293a8.js","./commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.c)],["da-dk",()=>W(()=>import("./da_DK-a35195bd.js"),["./da_DK-a35195bd.js","./commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.d)],["de-de",()=>W(()=>import("./de_DE-b6d9ed5e.js"),["./de_DE-b6d9ed5e.js","./commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.d)],["de-ch",()=>W(()=>import("./de_CH-b523775f.js"),["./de_CH-b523775f.js","./commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.d)],["el-gr",()=>W(()=>import("./el_GR-ba830052.js"),["./el_GR-ba830052.js","./commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.e)],["en-us",()=>W(()=>import("./en_US-3939827b.js"),["./en_US-3939827b.js","./commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.e)],["en-ca",()=>W(()=>import("./en_CA-3939827b.js"),["./en_CA-3939827b.js","./commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.e)],["es-es",()=>W(()=>import("./es_ES-1b8c924e.js"),["./es_ES-1b8c924e.js","./commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.e)],["et-ee",()=>W(()=>import("./et_EE-6da023ab.js"),["./et_EE-6da023ab.js","./commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.e)],["fi-fi",()=>W(()=>import("./fi_FI-e1448a8c.js"),["./fi_FI-e1448a8c.js","./commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.f)],["fr-fr",()=>W(()=>import("./fr_FR-0e2d05e5.js"),["./fr_FR-0e2d05e5.js","./commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.f)],["he-il",()=>W(()=>import("./he_IL-e371cf63.js"),["./he_IL-e371cf63.js","./commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.h)],["hr-hr",()=>W(()=>import("./hr_HR-20170e48.js"),["./hr_HR-20170e48.js","./commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.h)],["hu-hu",()=>W(()=>import("./hu_HU-b3d297c1.js"),["./hu_HU-b3d297c1.js","./commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.h)],["id-id",()=>W(()=>import("./id_ID-719f6a10.js"),["./id_ID-719f6a10.js","./commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.i)],["it-it",()=>W(()=>import("./it_IT-29b5d026.js"),["./it_IT-29b5d026.js","./commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.i)],["ja-jp",()=>W(()=>import("./ja_JP-1ce5e3db.js"),["./ja_JP-1ce5e3db.js","./commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.j)],["ko-kr",()=>W(()=>import("./ko_KR-f7cd4300.js"),["./ko_KR-f7cd4300.js","./commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.k)],["lt-lt",()=>W(()=>import("./lt_LT-145e4a7d.js"),["./lt_LT-145e4a7d.js","./commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.l)],["lv-lv",()=>W(()=>import("./lv_LV-55f949ab.js"),["./lv_LV-55f949ab.js","./commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.l)],["nb-no",()=>W(()=>import("./nb_NO-d7094b6a.js"),["./nb_NO-d7094b6a.js","./commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.n)],["nl-nl",()=>W(()=>import("./nl_NL-a244a34c.js"),["./nl_NL-a244a34c.js","./commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.n)],["pl-pl",()=>W(()=>import("./pl_PL-2ef677c3.js"),["./pl_PL-2ef677c3.js","./commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.p)],["pt-br",()=>W(()=>import("./pt_BR-4baa80fc.js"),["./pt_BR-4baa80fc.js","./commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.p)],["pt-pt",()=>W(()=>import("./pt_PT-3e77176d.js"),["./pt_PT-3e77176d.js","./commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.p)],["ro-ro",()=>W(()=>import("./ro_RO-8279186f.js"),["./ro_RO-8279186f.js","./commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.r)],["ru-ru",()=>W(()=>import("./ru_RU-1d32d544.js"),["./ru_RU-1d32d544.js","./commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.r)],["sk-sk",()=>W(()=>import("./sk_SK-7507463a.js"),["./sk_SK-7507463a.js","./commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.s)],["sl-sl",()=>W(()=>import("./sl_SL-26d504dc.js"),["./sl_SL-26d504dc.js","./commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.s)],["sr-rs",()=>W(()=>import("./sr_RS-bf75b1db.js"),["./sr_RS-bf75b1db.js","./commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.s)],["sv-se",()=>W(()=>import("./sv_SE-6b0b35ba.js"),["./sv_SE-6b0b35ba.js","./commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.s)],["th-th",()=>W(()=>import("./th_TH-e7b559b4.js"),["./th_TH-e7b559b4.js","./commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.t)],["tr-tr",()=>W(()=>import("./tr_TR-4d60d70e.js"),["./tr_TR-4d60d70e.js","./commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.t)],["uk-ua",()=>W(()=>import("./uk_UA-1f23280c.js"),["./uk_UA-1f23280c.js","./commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.u)],["vi-vn",()=>W(()=>import("./vi_VN-5d789490.js"),["./vi_VN-5d789490.js","./commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.v)],["zh-cn",()=>W(()=>import("./zh_Hans-228131ff.js"),["./zh_Hans-228131ff.js","./commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.z)],["zh-hk",()=>W(()=>import("./zh_Hant-73e50784.js"),["./zh_Hant-73e50784.js","./commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.z)],["zh-tw",()=>W(()=>import("./zh_Hant-73e50784.js"),["./zh_Hant-73e50784.js","./commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.z)]]);function Rnt(t){const e=t.split("-")[0].toLowerCase();let i=null;for(const r of F7.keys())if(r.startsWith(e)){i=r;break}return i}function Fnt(t){return t?F7.has(t.toLowerCase())?t.toLowerCase():Rnt(t)||Oee:Oee}let j_=null,iS=null;async function Dnt(t=Mn()){if(t=Fnt(t),j_&&t===iS)return j_;j_=W(()=>import("./index-a58e3505.js"),[],import.meta.url).then(e=>e.i),iS=t;try{const[e,i]=await Promise.all([j_,F7.get(iS)()]);iS===t&&(e.am4core.options.defaultLocale=i.default),e.am4core.options.suppressWarnings=!0,e.am4core.options.autoDispose=!0}catch{return j_=null,iS=null,null}return j_}const TO="#f8f8f8",i_e="#a9a9a9",MI="#323232",Nnt="line",Vnt="fill",rS=15,KM=12,znt=30,Lee=.001,jnt=.5,Bnt=.5,Ree=30,Unt=.02,Gnt=.02,r_e={sideSpacing:rS,paddingBottom:0,paddingLeft:0,paddingRight:0,paddingTop:0,axisFontSize:9,axisFontWeight:"400",axisGridStroke:"#f4f4f4",axisLabelsFontSize:9,axisLabelsFontWeight:"400",axisLabelsColor:i_e,axisTooltipFontSize:12,axisTooltipBackgroundColor:MI,axisTooltipLabelColor:TO,axisTooltipPaddingTop:Math.round(KM/4),axisTooltipPaddingBottom:Math.round(KM/4),axisTooltipPaddingHorizontal:Math.round(rS/4),xAxisMinGridDistance:50,xAxisLabelsSpacing:Math.round(KM/2),xAxisMinLabelPosition:.05,xAxisMaxLabelPosition:.9,yAxisMinGridDistance:30,yAxisLabelSpacing:Math.round(rS/4),yAxisMinLabelPosition:0,yAxisMaxLabelPosition:.8,seriesTooltipFontSize:12,seriesTooltipBackgroundColor:TO,seriesTooltipLabelColor:MI,seriesFillLighten:.9,seriesTooltipSpacing:KM/2,seriesTooltipPaddingVertical:Math.round(rS/4),seriesTooltipPaddingHorizontal:Math.round(rS/4),tooltipBorderRadius:0},Hnt={...r_e,axisGridStroke:MI,axisLabelsColor:i_e,axisTooltipBackgroundColor:MI,axisTooltipLabelColor:TO,seriesTooltipBackgroundColor:MI,seriesTooltipLabelColor:TO,seriesFillLighten:-.75},D8={minX:void 0,maxX:void 0,minY:void 0,maxY:void 0};async function qnt(t){const e=await Dnt();if(!e)throw new N("elevation-profile:load-failed","Could not load amCharts");const{am4core:i,am4charts:r}=e;_t(t.abortOptions);const{options:n}=i;n.minPolylineStep=jnt,n.autoSetClassName=!0,n.animationsEnabled=!1;const s=XU(),o=s?Hnt:r_e;s&&i.useTheme(e.am4themes_dark);const a=i.create(t.container,r.XYChart);a.arrangeTooltips=!1,a.preloader.disabled=!0,a.zoomOutButton.disabled=!0;const l=ll(t.container);a.rtl=l,a.padding(o.paddingTop,l?o.paddingLeft:o.paddingRight,o.paddingBottom,l?o.paddingRight:o.paddingLeft);const c=a.plotContainer.background;c.strokeWidth=0,c.strokeOpacity=0,c.stroke=null;const u=a.xAxes.push(new r.ValueAxis),h=a.yAxes.push(new r.ValueAxis),f={params:t,amCharts4Index:e,amChart:a,xAxis:u,yAxis:h,series:new Map,data:null,messages:null,theme:o,zooming:!1,pointerIsOver:!1};a.cursor=Wnt(f),Jnt(f),Znt(f),Ynt(f);const m=[nst(f,t.onRangeChange),ost(f,t.onCursorPositionChange),sst(f)];let g=null,y=!1;const v=()=>{g!=null&&(typeof window<"u"&&"cancelIdleCallback"in window?window.cancelIdleCallback(g):clearTimeout(g),g=null)};return{...f,destroy(){y=!0,v(),kn(m).remove(),a.dispose()},update(b){if(b.data===f.data&&b.messages===f.messages||(v(),y))return;const w=()=>{y||(g=null,Knt(f,b))};g=typeof window<"u"&&"requestIdleCallback"in window?window.requestIdleCallback(w,{timeout:Ree}):setTimeout(w,Ree)},zoomOut(){y||(f.yAxis.zoom({start:0,end:1},!1,!0),f.xAxis.zoom({start:0,end:1},!1,!0))}}}function Wnt(t){const e=new t.amCharts4Index.am4charts.XYCursor;return e.trackable=!0,e.lineY.disabled=!0,e.behavior="zoomXY",e}function Jnt(t){const e=t.theme,i=t.amChart.tooltip,{am4core:r}=t.amCharts4Index;i.id="series-tooltip",i.fitPointerToBounds=!0,i.pointerOrientation="vertical",i.zIndex=-1,i.getFillFromObject=!1,i.label.fontSize=e.seriesTooltipFontSize,i.label.fill=r.color(e.seriesTooltipLabelColor),i.label.padding(e.seriesTooltipPaddingVertical,e.seriesTooltipPaddingHorizontal,e.seriesTooltipPaddingVertical,e.seriesTooltipPaddingHorizontal),i.background.cornerRadius=e.tooltipBorderRadius,i.background.stroke=null,i.background.fill=r.color(e.seriesTooltipBackgroundColor),i.background.padding(0,0,0,0),i.adapter.add("dy",()=>e.seriesTooltipSpacing*(i.background.pointerY<=0?1:-1)),ll(t.params.container)&&(i.label.textAlign="middle")}function Znt(t){const{xAxis:e,theme:i}=t,{am4core:r}=t.amCharts4Index;e.numberFormatter=s_e(t,"distance"),e.strictMinMax=!0,e.cursorTooltipEnabled=!1,e.title.visible=!1;const n=e.renderer;n.line.visible=!1,n.minGridDistance=i.xAxisMinGridDistance,n.minLabelPosition=i.xAxisMinLabelPosition,n.maxLabelPosition=i.xAxisMaxLabelPosition,n.fontWeight=i.axisFontWeight,n.fontSize=i.axisFontSize,n.baseGrid.disabled=!0;const s=n.labels.template;s.fontSize=i.axisLabelsFontSize,s.fontWeight=i.axisLabelsFontWeight,s.fill=r.color(i.axisLabelsColor),s.paddingTop=i.xAxisLabelsSpacing,s.horizontalCenter="left",s.paddingLeft=0;const o=e.tooltip;o.id="axis-tooltip",o.background.fill=r.color(i.axisTooltipBackgroundColor),o.background.stroke=null,o.background.padding(0,0,0,0),o.label.fontSize=i.axisTooltipFontSize,o.label.fill=r.color(i.axisTooltipLabelColor),o.label.padding(i.axisTooltipPaddingTop,i.axisTooltipPaddingHorizontal,i.axisTooltipPaddingBottom,i.axisTooltipPaddingHorizontal);const a=n.grid.template;a.strokeOpacity=1,a.stroke=r.color(i.axisGridStroke)}function Ynt(t){const{yAxis:e,theme:i}=t,{am4core:r}=t.amCharts4Index;e.numberFormatter=s_e(t,"elevation"),e.title.visible=!1,e.cursorTooltipEnabled=!1,e.strictMinMax=!0,e.baseValue=co().noDataValue;const n=e.renderer;n.inside=!0,n.line.opacity=0,n.line.visible=!1,n.minGridDistance=i.yAxisMinGridDistance,n.minLabelPosition=i.yAxisMinLabelPosition,n.maxLabelPosition=i.yAxisMaxLabelPosition,n.fontWeight=i.axisFontWeight,n.fontSize=i.axisFontSize,n.baseGrid.disabled=!0;const s=n.labels.template;s.fontSize=i.axisLabelsFontSize,s.fontWeight=i.axisLabelsFontWeight,s.fill=r.color(i.axisLabelsColor),s.verticalCenter="bottom",s.paddingLeft=i.yAxisLabelSpacing,s.paddingBottom=0;const o=n.grid.template;o.strokeOpacity=1,o.stroke=r.color(i.axisGridStroke),ll(t.params.container)&&(n.opposite=!0,s.textAlign="middle",s.paddingLeft=0,s.paddingRight=i.yAxisLabelSpacing)}function Knt(t,{data:e,messages:i}){const{htmlContainer:r}=t.amChart;if(!r)return;const n=e!=null&&e.refined;t.amChart.cursor.disabled=!n,r.classList.toggle(GQe.cursorEnabled,n);const s=t.data!==e,o=lt(t.data,a=>a.effectiveUnits)!==lt(e,a=>a.effectiveUnits);t.data=e,t.messages=i,s&&(Xnt(t),est(t)),o&&(t.yAxis.invalidateLabels(),t.xAxis.invalidateLabels()),FT(t)}function Xnt(t){const{xAxis:e,yAxis:i}=t,{minX:r,maxX:n,minY:s,maxY:o}=Qnt({data:t.data,pixelWidth:e.pixelWidth,pixelHeight:i.pixelHeight});e.min=r,e.max=n,i.min=s,i.max=o}function Qnt({data:t,pixelWidth:e,pixelHeight:i}){if(t==null)return D8;const r=t.statistics,n=0,s=lt(r,h=>h.maxDistance);let o=lt(r,h=>h.minElevation),a=lt(r,h=>h.maxElevation);if(s==null||o==null||a==null)return D8;const l=Math.max(s-n,Lee);let c=Math.max(a-o,Lee);const u=t.effectiveUnits;if(t.dynamicElevationRange){const h=bt(l,u.distance,u.elevation);c=Math.max(c,h/co().maxChartRatio)}return o-=Gnt*c,a=o+c+Unt*c,[o,a]=Lnt(o,a,10),c=a-o,t.uniformScaling?n_e({data:t,bounds:{minX:n,maxX:s,minY:o,maxY:a},pixelWidth:e,pixelHeight:i,centered:!0}):{minX:n,maxX:n+l,minY:o,maxY:o+c}}function n_e({data:t,bounds:e,pixelWidth:i,pixelHeight:r,centered:n}){if(t==null)return e;let{minX:s,maxX:o,minY:a,maxY:l}=e;if(s==null||o==null||a==null||l==null)return D8;const c=o-s,u=l-a,h=t.effectiveUnits,f=bt(u,h.elevation,h.distance)/r/(c/i);return f>=1?[s,o]=Fee([s,o],f,n):[a,l]=Fee([a,l],1/f,n),{minX:s,maxX:o,minY:a,maxY:l}}function Fee([t,e],i,r){const n=(e-t)*i;if(r){const s=(t+e)/2-n/2;return[s,s+n]}return[t,t+n]}function est(t){const{amChart:e,data:i}=t;if(i==null||i.lines.length===0)return void e.series.clear();const r=new Map,n=new Set(e.series.values),s=i.lines.length;for(let o=0;o<s;o++){const a=i.lines[o];let l=t.series.get(a.id);l?(lt(l.fill,u=>n.delete(u)),n.delete(l.line)):(l=rst(t,a),lt(l.fill,u=>e.series.push(u)),e.series.push(l.line)),r.set(l.id,l);const c=s-o-1;lt(l.fill,u=>u.zIndex=c),l.line.zIndex=s+c,tst(t,l,a)}t.series=r;for(const o of n)e.series.removeValue(o)}function tst(t,{line:e,fill:i},r){const{theme:n}=t,{am4core:s}=t.amCharts4Index,{r:o,g:a,b:l,a:c}=r.color,u=s.color({r:o,g:a,b:l,a:c}),h=r.samples??new Array,f=h.length>0;e.stroke=u,e.visible=f,lt(i,y=>{y.visible=f,y.fill=u.lighten(n.seriesFillLighten)});const m=h.length,g=e.data;if(g.length===m){let y=!1;for(let v=0;v<m;++v){const b=g[v],w=h[v];y=y||b.elevation!=null!=(w.elevation!=null),ist(b,w)}y?(e.invalidateData(),lt(i,v=>v.invalidateData())):(e.invalidateRawData(),lt(i,v=>v.invalidateRawData()))}else e.data=h,lt(i,y=>y.data=h)}function ist(t,e){t.x=e.x,t.y=e.y,t.z=e.z,t.distance=e.distance,t.elevation=e.elevation}function rst(t,e){const{id:i}=e,r=Dee(t,`${Nnt}-${i}`);r.strokeWidth=e.chartStrokeWidth,r.dy=e.chartStrokeOffsetY;let n=null;return e.chartFillEnabled&&(n=Dee(t,`${Vnt}-${i}`),n.fillOpacity=1),{id:i,line:r,fill:n}}function Dee(t,e){const i=new t.amCharts4Index.am4charts.LineSeries;i.id=e,i.showOnInit=!1,i.simplifiedProcessing=!0,i.minDistance=Bnt,i.excludeFromTotal=!0,i.clickable=!1,i.contextMenuDisabled=!0,i.cursorHoverEnabled=!1,i.cursorTooltipEnabled=!1,i.connect=!1,i.fill=null,i.stroke=null;const r="distance";i.dataFields.valueX=r;const n="elevation";return i.dataFields.valueY=n,i}function nst(t,e){const{amChart:i,xAxis:r,yAxis:n}=t;let s=!1;const o=()=>{const{data:u}=t;if(!s||u==null||!u.uniformScaling)return;s=!1;const{minX:h,maxX:f,minY:m,maxY:g}=n_e({data:t.data,bounds:{minX:r.minZoomed,maxX:r.maxZoomed,minY:n.minZoomed,maxY:n.maxZoomed},pixelWidth:r.pixelWidth,pixelHeight:n.pixelHeight,centered:!0});h!=null&&f!=null&&r.zoomToValues(h,f,!0),m!=null&&g!=null&&n.zoomToValues(m,g,!0),i.validate(),FT(t)},a=()=>{e(t.xAxis.zoomFactor,t.yAxis.zoomFactor)},l=u=>{t.zooming=u,FT(t)},c=[i.events.on("down",()=>l(!0)),i.events.on("up",()=>l(!1)),i.cursor.events.on("zoomended",()=>{s=!0}),r.events.on("startendchanged",o),n.events.on("startendchanged",o),r.events.on("rangechangeended",a),n.events.on("rangechangeended",a)];return Et(()=>{c.forEach(u=>u.dispose())})}function sst({xAxis:t,yAxis:e}){const i=n=>()=>{n.renderer.grid.each(s=>{s.visible=s.dataItem.label.dom.getAttribute("display")!=="none"})},r=[t.events.on("rangechangeended",i(t)),t.events.on("validated",i(t)),e.events.on("rangechangeended",i(e)),e.events.on("validated",i(e))];return Et(()=>{r.forEach(n=>n.dispose())})}function ost(t,e){const{amChart:i,xAxis:r,yAxis:n}=t,{cursor:s,events:o}=i,a=u=>{t.pointerIsOver=u,FT(t)},l=()=>{a(!1),e(null,null)},c=[s.events.on("cursorpositionchanged",()=>{if(!t.pointerIsOver)return;FT(t);let u=r.toAxisPosition(s.xPosition),h=n.toAxisPosition(s.yPosition);const f=t.data;if(f!=null&&f.statistics!=null){const{maxDistance:m,minElevation:g,maxElevation:y}=f.statistics;m!=null&&(u=Nee(u,r.minZoomed,r.maxZoomed,0,m)),g!=null&&y!=null&&(h=Nee(h,n.minZoomed,n.maxZoomed,g,y))}e(u,h)}),o.on("over",()=>a(!0)),o.on("out",l),o.on("blur",l)];return Et(()=>{c.forEach(u=>u.dispose())})}function Nee(t,e,i,r,n){return(e+t*(i-e)-r)/(n-r)}function FT(t){const{amChart:e,xAxis:i,data:r,theme:n,zooming:s,pointerIsOver:o}=t;if(t.amChart.tooltip.hide(),t.xAxis.hideTooltip(),!o||s||r==null||!r.refined)return;const a=ast(t);if(a!=null){const{cursor:l}=e,c=e.tooltip;l.show(0),l.validate(),c.text=a.text,c.show(0),c.validate();const u=a.y-c.contentHeight-n.seriesTooltipSpacing;c.pointerOrientation=u<znt?"up":"down",c.pointTo(a,!0),c.validate();const h=i.tooltip;h.text=ust(t),h.show(0),h.validate()}}function ast(t){const{amChart:e,yAxis:i,data:r}=t;if(r==null)return null;const n=r.lines.map(c=>({line:c,y:lt(o_e(t,c),u=>u.elevation)})).sort(lst),s=n.length?n[0].y:null;if(s==null)return null;const o=e.cursor,a=i.measuredHeight,l=a+e.pixelPaddingTop;return{text:n.map(({y:c,line:u})=>cst(t,u,c)).join(`
`),x:o.point.x+o.parent.pixelX+e.pixelPaddingLeft,y:l-i.valueToPosition(s)*a}}function lst({y:t},{y:e}){return t==null?1:e==null?-1:e-t}function cst(t,e,i){const{data:r,messages:n}=t;if(r==null||n==null)return"";const s=co().formatPrecision,o=Os(n.chartTooltip,{name:F8(e,n),elevation:i!=null?Wd(n,i,r.effectiveUnits.elevation,s):T0e});return`[${e.color.toHex()}]●[/] ${o}`}function ust(t){const{data:e,messages:i}=t;if(e==null||i==null)return"";const r=e.lines[0],n=r?o_e(t,r):null,s=co().formatPrecision;return n!=null?Wd(i,n.distance,e.effectiveUnits.distance,s):"-"}function s_e(t,e){const i=t.xAxis.numberFormatter.clone();return i.format=(r,n,s)=>{const{messages:o,data:a}=t;return o==null||a==null||typeof r=="string"?"":`${po(r,{maximumFractionDigits:s})} ${R7(o,a.effectiveUnits[e],"abbr")}`},i}function o_e({amChart:t,xAxis:e},i){const r=i.samples??[];if(r.length===0)return null;const n=e.toAxisPosition(t.cursor.xPosition),s=e.positionToValue(n);return Ire(r,s,o=>o.distance)}var ha;(function(t){t.Sketch="sketch",t.SketchCancel="sketch-cancel",t.SketchDone="sketch-done",t.Select="select",t.SelectCancel="select-cancel"})(ha||(ha={}));const nS=[{type:ha.Select},{type:ha.Sketch}],dst={[Tn.None]:null,[Tn.NoValidInput]:"noProfile",[Tn.NoVisibleProfiles]:"noProfile",[Tn.RefinedButNoChartData]:"noProfile",[Tn.TooComplex]:"tooComplex",[Tn.UnknownError]:"unknown",[Tn.InvalidGeometry]:"invalidGeometry",[Tn.InvalidElevationInfo]:"invalidElevationInfo"},Vee=Symbol("resize-observer-handle");let ai=class extends di{constructor(e,i){super(e,i),this.viewModel=null,this.visibleElements=new e_e,this.iconClass=Hi.widgetIcon,this.icon=null,this.messages=null,this.messagesCommon=null,this.messagesUnits=null,this._chartContainer=null,this._chart=null,this._chartInitTask=null,this._chartIsRefined=!1,this._width=0,this._zoomOutButtonVisible=!1,this._getChartUpdateParamsMemoized=ec((r,n,s,o)=>({chart:r,data:n,stationary:s,messages:o})),this._getDetailsPropsMemoized=ec((r,n)=>({effectiveUnits:r,profiles:n})),e!=null&&e.viewModel||(this._defaultViewModel=new Qve({view:e==null?void 0:e.view}),this.viewModel=this._defaultViewModel)}initialize(){this._legend=new h0(this._legendProps),this._settingsButton=new p0(this._settingsButtonProps),this.addHandles([J(()=>this._legendProps,e=>this._legend.set(e)),J(()=>this._settingsButtonProps,e=>this._settingsButton.set(e))])}postInitialize(){this.addHandles([J(()=>({container:this._chartContainer,width:this._width}),({container:e,width:i})=>{this._destroyChart(),e!=null&&i>0&&this._initializeChart(e)},Le),J(()=>this._chartUpdateParams,()=>this._updateChart(this._chartUpdateParams),Le)])}destroy(){this._destroyChart(),this._defaultViewModel!=null&&this.viewModel!==this._defaultViewModel&&this._defaultViewModel.destroy(),this._legend=je(this._legend),this._settingsButton=je(this._settingsButton)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}get input(){return this.viewModel.input}set input(e){this.viewModel.input=e}get profiles(){return this.viewModel.profiles}set profiles(e){this.viewModel.profiles=e}get unitOptions(){return this.viewModel.unitOptions}set unitOptions(e){this.viewModel.unitOptions=e}get unit(){return this.viewModel.unit}set unit(e){this.viewModel.unit=e}get geodesicDistanceThreshold(){return this.viewModel.geodesicDistanceThreshold}set geodesicDistanceThreshold(e){this.viewModel.geodesicDistanceThreshold=e}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get visible(){return this.viewModel.visible}set visible(e){this.viewModel.visible=e}get _portrait(){return this._width<co().portraitModePixelBreakpoint}get _chartUpdateParams(){const e=this.view;return this._getChartUpdateParamsMemoized(this._chart,this.viewModel.chartData,e==null||e.stationary,this._chartMessages)}get _chartMessages(){return{...this.messagesUnits,...this.messages}}get _legendProps(){return this._getDetailsPropsMemoized(this.viewModel.effectiveUnits,this._profilesArray)}get _profilesArray(){return this.profiles.toArray()}get _settingsButtonProps(){return{viewModel:this.viewModel,visibleElements:this.visibleElements}}render(){const{viewModel:e,visible:i}=this;return M("div",{key:this,class:this.classes({[Hi.base]:i,[Hi.esriWidget]:i,[Hi.esriWidgetDisabled]:i&&e.state==="disabled",[Hi.portrait]:this._portrait,[Hi.refined]:e.progress===1}),"aria-label":this.messages.widgetLabel},M("div",{key:"content-wrapper",bind:this,afterCreate:this._onContentWrapperAfterCreate,afterRemoved:this._onContentWrapperRemoved},i&&this._renderContentForState()))}_renderContentForState(){switch(this.viewModel.state){case ya.Ready:return this._renderContentForReadyState();case ya.Selecting:return this._renderContentForSelectingState();case ya.Creating:return this._renderContentForCreatingState();case ya.Selected:return this._renderContentForSelectedState();case ya.Created:return this._renderContentForCreatedState();case ya.Disabled:return this._renderContentForReadyState()}}_renderContentForReadyState(){var s;const{sketchButton:e,selectButton:i}=this.visibleElements,r=this.messages;let n;return n=e&&i?r.readyPrompt:e?r.readyPromptCreateOnly:i?r.readyPromptSelectOnly:(s=r.errors)==null?void 0:s.noProfile,this._renderContent({prompt:n,chart:!1,actions:nS})}_renderContentForSelectingState(){const e=this.view;if(e==null)return null;const i=this.messages[`selectingPrompt-${e.type}`];return this._renderContent({prompt:i,chart:!1,actions:[{type:ha.SelectCancel}]})}_renderContentForCreatingState(){const{view:e,viewModel:i}=this;if(e==null)return null;const r=i.hasVertices?[{type:ha.SketchCancel},{type:ha.SketchDone,disabled:!i.tool.interaction.canStopCreating}]:[{type:ha.Select},{type:ha.Sketch,disabled:!0}];if(i.errorState===Tn.NoValidInput){const s=this.messages[`creatingPrompt-${e.type}`];return this._renderContent({chart:!1,actions:r,prompt:s})}const n=this._getErrorMessage();return n?this._renderContent({chart:!1,actions:r,prompt:n}):this._renderContent({chart:!0,actions:r})}_renderContentForSelectedState(){const e=this._getErrorMessage();return e?this._renderContent({chart:!1,actions:nS,prompt:e}):this._renderContent({chart:!0,actions:nS})}_renderContentForCreatedState(){const e=this._getErrorMessage();return e?this._renderContent({chart:!1,actions:nS,prompt:e}):this._renderContent({chart:!0,actions:nS})}_getErrorMessage(){var i,r;const e=dst[this.viewModel.errorState];return e?(r=(i=this.messages)==null?void 0:i.errors)==null?void 0:r[e]:null}_renderContent(e){const i=e.prompt!=null?this._renderPrompt(e.prompt):e.chart&&this._renderChart(),r=this.viewModel.input!=null;return[M("header",{key:"header",class:Hi.header},this._zoomOutButtonVisible&&this._renderZoomOutButton(),this.visibleElements.clearButton&&r&&this._renderClearButton(),this.visibleElements.settingsButton&&this._settingsButton.render()),M("div",{class:Hi.mainContainer},i),this.visibleElements.legend&&this._legend.render(),this._renderActions(e)]}_renderZoomOutButton(){return M("button",{key:"zoom-out",class:Hi.zoomOutButton,bind:this,onclick:this._onZoomOutButtonClick,title:this.messages.zoomOut,type:"button"})}_onZoomOutButtonClick(){lt(this._chart,e=>e.zoomOut())}_renderClearButton(){return M("button",{key:"clear-profile",class:Hi.clearButton,bind:this,onclick:this._onClearButtonClick,title:this.messages.clearProfile,type:"button"})}_onClearButtonClick(){this.viewModel.clear()}_renderPrompt(e){return[M("div",{key:"prompt-container",bind:this,class:Hi.promptContainer},M("p",null,e))]}_renderChart(){if(!this.visibleElements.chart)return[M("div",{key:"empty-chart-container",class:Hi.chartContainer})];const e=this._chartIsRefined||this._canRenderChart();if(!e)return[this._renderSpinner({size:"large"}),M("div",{key:"chart-container-empty",class:Hi.chartContainer})];const{chartData:i,progress:r}=this.viewModel;return[i!=null&&r>0&&r<1&&this._renderSpinner({size:e?"small":"large"}),M("div",{key:"chart-container",bind:this,class:Hi.chartContainer,afterCreate:this._onChartContainerAfterCreate,afterRemoved:this._onChartContainerRemoved})]}_renderSpinner(e){return M("div",{key:"spinner",class:this.classes(Hi.chartSpinner,{[Hi.chartSpinnerSmall]:e.size==="small"}),afterCreate:this._onSpinnerAfterCreate,exitAnimation:this._onSpinnerExit})}_onSpinnerAfterCreate(e){requestAnimationFrame(()=>e.classList.add(Hi.chartSpinnerVisible))}_onSpinnerExit(e,i){e.classList.remove(Hi.chartSpinnerVisible),setTimeout(i,200)}_canRenderChart(){const e=this.viewModel.chartData;if(e==null)return!1;if(!this.viewModel.inputIsSketched)return e.refined;let i=0;for(const{samples:r}of e.lines)i+=r!=null?r.length:0;return e.refined||i<=co().largeChartSamples}_renderActions({actions:e}){const i=e.map(r=>{switch(r.type){case ha.Sketch:return this.visibleElements.sketchButton&&this._renderAction({action:r,onClick:this._onSketchButtonClick,className:Hi.sketchButton,label:this.messages.sketchButtonLabel});case ha.SketchCancel:return this.visibleElements.sketchButton&&this._renderAction({action:r,onClick:this._onCancelButtonClick,className:Hi.sketchCancelButton,label:this.messagesCommon.cancel});case ha.SketchDone:return this.visibleElements.sketchButton&&this._renderAction({action:r,onClick:this._onDoneButtonClick,className:Hi.sketchDoneButton,label:this.messagesCommon.done});case ha.Select:return this.visibleElements.selectButton&&this._renderAction({action:r,onClick:this._onSelectButtonClick,className:Hi.selectButton,label:this.messages.selectButtonLabel});case ha.SelectCancel:return this.visibleElements.selectButton&&this._renderAction({action:r,onClick:this._onCancelButtonClick,className:Hi.selectCancelButton,label:this.messagesCommon.cancel})}}).filter(Boolean);return i.length?M("footer",{key:"footer",class:Hi.footer},i):null}_renderAction({action:e,onClick:i,className:r,label:n}){return M("button",{key:`action-${e.type}`,class:this.classes(Hi.actionButton,r,{[Hi.buttonDisabled]:!!e.disabled}),bind:this,disabled:e.disabled,onclick:i,type:"button"},n)}_onSketchButtonClick(){this.viewModel.start({mode:"sketch"})}_onSelectButtonClick(){this.viewModel.start({mode:"select"})}_onCancelButtonClick(){this.viewModel.cancel()}_onDoneButtonClick(){this.viewModel.stop()}_onContentWrapperAfterCreate(e){const i=eLe(e,r=>{this._width=r.contentRect.width});this.addHandles(i,Vee)}_onContentWrapperRemoved(){this.removeHandles(Vee)}_updateChart(e){const{data:i,chart:r,messages:n,stationary:s}=e;r!=null&&n!=null&&s&&this._canRenderChart()&&(r.update(e),this._chartIsRefined=i!=null&&i.refined)}_onChartContainerAfterCreate(e){this._chartContainer=e}_onChartContainerRemoved(){this._chartContainer=null}_initializeChart(e){Qr(this._chartInitTask),this._chartInitTask=Cp(async i=>{const r=await qnt({container:e,abortOptions:{signal:i},onRangeChange:(n,s)=>{this._zoomOutButtonVisible=n!==1||s!==1},onCursorPositionChange:n=>{this.viewModel.hoveredChartPosition=n}});if(i.aborted)throw je(r),wi();this._chart=r,this._updateChart(this._chartUpdateParams)})}_destroyChart(){this._chartInitTask=Qr(this._chartInitTask),this._chart=je(this._chart),this._chartIsRefined=!1}get test(){return{chart:this._chart}}};d([p({type:Qve})],ai.prototype,"viewModel",void 0),d([p()],ai.prototype,"view",null),d([p()],ai.prototype,"input",null),d([p()],ai.prototype,"profiles",null),d([p()],ai.prototype,"unitOptions",null),d([p()],ai.prototype,"unit",null),d([p()],ai.prototype,"geodesicDistanceThreshold",null),d([p({type:e_e,nonNullable:!0})],ai.prototype,"visibleElements",void 0),d([p()],ai.prototype,"iconClass",void 0),d([p()],ai.prototype,"icon",void 0),d([p()],ai.prototype,"label",null),d([p()],ai.prototype,"visible",null),d([p(),ut("esri/widgets/ElevationProfile/t9n/ElevationProfile")],ai.prototype,"messages",void 0),d([p(),ut("esri/t9n/common")],ai.prototype,"messagesCommon",void 0),d([p(),ut("esri/core/t9n/Units")],ai.prototype,"messagesUnits",void 0),d([p()],ai.prototype,"_chartContainer",void 0),d([p()],ai.prototype,"_chart",void 0),d([p()],ai.prototype,"_chartInitTask",void 0),d([p()],ai.prototype,"_chartIsRefined",void 0),d([p()],ai.prototype,"_settingsButton",void 0),d([p()],ai.prototype,"_legend",void 0),d([p()],ai.prototype,"_width",void 0),d([p()],ai.prototype,"_portrait",null),d([p()],ai.prototype,"_zoomOutButtonVisible",void 0),d([p()],ai.prototype,"_chartUpdateParams",null),d([p()],ai.prototype,"_chartMessages",null),d([p()],ai.prototype,"_legendProps",null),d([p()],ai.prototype,"_profilesArray",null),d([p()],ai.prototype,"_settingsButtonProps",null),ai=d([A("esri.widgets.ElevationProfile")],ai);const hst=ai,tr="esri-search",Ne={base:`${tr} esri-widget`,loader:"esri-widget__loader",loaderText:"esri-widget__loader-text",loaderAnimation:"esri-widget__loader-animation",esriInput:"esri-input",hasMultipleSources:`${tr}--multiple-sources`,isLoading:`${tr}--loading`,isSearching:`${tr}--searching`,showSuggestions:`${tr}--show-suggestions`,showSources:`${tr}--sources`,showWarning:`${tr}--warning`,container:`${tr}__container`,input:`${tr}__input`,inputContainer:`${tr}__input-container`,form:`${tr}__form`,submitButton:`${tr}__submit-button`,sourcesButton:`${tr}__sources-button`,clearButton:`${tr}__clear-button`,sourceName:`${tr}__source-name`,suggestionsMenu:`${tr}__suggestions-menu`,suggestionList:`${tr}__suggestions-list`,suggestionListCurrentLocation:`${tr}__suggestions-list--current-location`,sourcesMenu:`${tr}__sources-menu`,source:`${tr}__source`,warningMenu:`${tr}__warning-menu`,warningMenuBody:`${tr}__warning-body`,warningMenuHeader:`${tr}__warning-header`,warningMenuText:`${tr}__warning-text`,noValueText:`${tr}__no-value-text`,esriWidgetDisabled:"esri-widget--disabled",button:"esri-widget--button",fallbackText:"esri-icon-font-fallback-text",header:"esri-widget__heading",locate:"esri-icon-locate-circled",menu:"esri-menu",menuList:"esri-menu__list",menuItem:"esri-menu__list-item",menuItemActive:"esri-menu__list-item--active",menuItemFocus:"esri-menu__list-item--focus",menuHeader:"esri-menu__header",loadingIcon:"esri-icon-loading-indicator esri-rotating",searchIcon:"esri-icon-search",dropdownIcon:"esri-icon-down-arrow esri-search__sources-button--down",dropupIcon:"esri-icon-up-arrow esri-search__sources-button--up",clearIcon:"esri-icon-close",noticeIcon:"esri-icon-notice-triangle",widgetIcon:"esri-icon-search",disabled:"esri-disabled"},ey="esri-search-result-renderer",nh={base:`${ey} esri-widget`,anchor:"esri-widget__anchor",showMoreResults:`${ey}__more-results--show-more-results`,moreResults:`${ey}__more-results`,moreResultsList:`${ey}__more-results-list`,moreResultsHeader:`${ey}__more-results-header`,moreResultsItem:`${ey}__more-results-item`,moreResultsListHeader:`${ey}__more-results-list-header`};let Yr=class extends bg(te){constructor(e){super(e),this.autoNavigate=null,this.filter=null,this.getResults=null,this.getSuggestions=null,this.maxResults=null,this.maxSuggestions=null,this.minSuggestCharacters=null,this.outFields=null,this.placeholder="",this.popupEnabled=null,this.popupTemplate=null,this.prefix="",this.resultGraphicEnabled=null,this.resultSymbol=null,this.suggestionsEnabled=null,this.suffix="",this.withinViewEnabled=!1,this.zoomScale=null}};d([p()],Yr.prototype,"autoNavigate",void 0),d([p()],Yr.prototype,"filter",void 0),d([p()],Yr.prototype,"getResults",void 0),d([p()],Yr.prototype,"getSuggestions",void 0),d([p()],Yr.prototype,"maxResults",void 0),d([p()],Yr.prototype,"maxSuggestions",void 0),d([p()],Yr.prototype,"minSuggestCharacters",void 0),d([p()],Yr.prototype,"outFields",void 0),d([p()],Yr.prototype,"placeholder",void 0),d([p()],Yr.prototype,"popupEnabled",void 0),d([p()],Yr.prototype,"popupTemplate",void 0),d([p()],Yr.prototype,"prefix",void 0),d([p()],Yr.prototype,"resultGraphicEnabled",void 0),d([p()],Yr.prototype,"resultSymbol",void 0),d([p()],Yr.prototype,"suggestionsEnabled",void 0),d([p()],Yr.prototype,"suffix",void 0),d([p()],Yr.prototype,"withinViewEnabled",void 0),d([p()],Yr.prototype,"zoomScale",void 0),Yr=d([A("esri.widgets.Search.SearchSource")],Yr);const D7=Yr,a_e=96;function JIt(t,e){const i=e||t.extent,r=t.width,n=ti(i&&i.spatialReference);return i&&r?i.width/r*n*Yne*a_e:0}function pst(t,e){return t/(ti(e)*Yne*a_e)}function fst(t,e){const i=t.extent,r=t.width-(t.padding?t.padding.left+t.padding.right:0),n=pst(e,i.spatialReference);return i.clone().expand(n*r/i.width)}const zee=ie.getLogger("esri.widgets.Search.support.geometryUtils");function mst(t,e){var r,n;if(!e)return zee.error("missing-parameter: view is missing."),Promise.reject(new N("searchgeometryutils:missing-parameter","view is missing."));if(!t)return zee.error("missing-parameter: point is missing."),Promise.reject(new N("searchgeometryutils:missing-parameter","point is missing."));if(t.hasZ||e.type==="2d")return Promise.resolve(t);const i=(r=e==null?void 0:e.map)==null?void 0:r.ground;return i&&i.layers.length?i.queryElevation(t,{cache:(n=e.basemapTerrain)==null?void 0:n.elevationQueryCache}).then(s=>s.geometry):Promise.resolve(t)}function jee(t){if(t==null)return null;switch(t.type){case"point":return t;case"extent":return t.center;case"polygon":return t.centroid;case"multipoint":return t.getPoint(0);case"polyline":return t.getPoint(0,0)}return null}function N7(t,e,i){return t==null?null:t.type==="extent"?t:t.type==="multipoint"||t.type==="polygon"||t.type==="polyline"?t.extent:t.type==="point"?l_e(t,e,i):void 0}function N8(t,e,i){return t==null||e==null?null:l_e(t.center,e,i)}function l_e(t,e,i){const r=t.hasZ?t.z:void 0;return e!=null&&e.map?(i!=null?fst(e,i):e.extent).clone().centerAt(t).set({zmax:r,zmin:r}):new Re({xmin:t.x-.25,ymin:t.y-.25,xmax:t.x+.25,ymax:t.y+.25,spatialReference:t.spatialReference,zmin:r,zmax:r})}const gst=/https?:\/\/services.*\.arcgis\.com/i,yst=/(?:\{([^}]+)\})/g,Gw=ie.getLogger("esri.widgets.Search.support.layerSearchUtils");function vst(t,e){const{exactMatch:i=!1,location:r,maxResults:n,spatialReference:s,source:o,sourceIndex:a,suggestResult:l,view:c}=t,{layer:u,filter:h,zoomScale:f}=o,m=c==null?void 0:c.scale,g=c_e(o,c),y=e&&e.signal;return d_e(u).then(()=>{const v=u.popupTemplate;return v?v.getRequiredFields(u.fieldsIndex):null}).then(v=>{var k,L,F,V;const{objectIdField:b,returnZ:w}=u,x=y_e(o);if(!V7(u,x))throw Gw.error("invalid-field: displayField is invalid."),new N("getResults():invalid-field","displayField is invalid.");const S=v&&v.length?v:[x],I=o.outFields||S,T=u_e(I);if(I.includes(b)||T||I.push(b),(k=u.floorInfo)!=null&&k.floorField&&I.push(u.floorInfo.floorField),!(T||CO(u,I)))throw Gw.error("invalid-field: outField is invalid."),new N("getResults():invalid-field","outField is invalid.");const C=u.createQuery(),{orderByFields:E}=o;if(E&&(C.orderByFields=E),s){C.outSpatialReference=s;const z=1/ti(s);z&&(C.maxAllowableOffset=z)}const $=u.geometryType==="mesh"||u.geometryType==="multipatch",P=((F=(L=u.capabilities)==null?void 0:L.data)==null?void 0:F.supportsZ)&&!$;if(C.returnZ=P&&w!==!1,C.returnGeometry=!0,C.multipatchOption=$?"xyFootprint":null,I&&(C.outFields=I),r)C.geometry=r;else if(l.key)C.objectIds=[l.key];else{const z=o.searchFields||[x];if(!CO(u,z))throw Gw.error("invalid-field: search field is invalid."),new N("getResults():invalid-field","search field is invalid.");if(g_e(u)&&(C.num=n),g&&(C.geometry=g),!((V=l.text)==null?void 0:V.trim()))return[];const H=l.text,{prefix:Z="",suffix:K=""}=o,X=v_e(`${Z}${H}${K}`);m_e(u)&&p_e(u,z)&&!i&&H&&(C.fullText=f_e({text:H,searchFields:z}));const oe=__e({searchTerm:X,layer:u,searchFields:z,filter:h,exactMatch:i,query:C,type:"search"});if(C.where=oe,!h_e(C))return[]}return u.queryFeatures(C,{signal:y}).then(z=>Ast(z,c,o,a,x,m,f))})}function _st(t,e){const{source:i,spatialReference:r,view:n,suggestTerm:s,maxSuggestions:o,sourceIndex:a,exactMatch:l}=t,{layer:c,filter:u}=i,h=e&&e.signal,f=c_e(i,n);return d_e(c).then(()=>{if(!g_e(c))return[];const m=y_e(i),g=i.searchFields||[m],y=[];i.suggestionTemplate?i.suggestionTemplate.replaceAll(yst,(P,k)=>(y.push(k),P)):y.push(m);const v=u_e(y);y.includes(c.objectIdField)||v||y.push(c.objectIdField);const b=V7(c,m),w=v||CO(c,y),x=CO(c,g);if(!b)throw Gw.error("invalid-field: displayField is invalid."),new N("getSuggestions():invalid-field","displayField is invalid.");if(!w)throw Gw.error("invalid-field: outField is invalid."),new N("getSuggestions():invalid-field","outField is invalid.");if(!x)throw Gw.error("invalid-field: search field is invalid."),new N("getSuggestions():invalid-field","search field is invalid.");const S=c.createQuery(),{orderByFields:I}=i;if(I&&(S.orderByFields=I),S.outSpatialReference=r,S.returnGeometry=!1,S.num=o,S.outFields=y,f&&(S.geometry=f),!s.trim())return[];const{prefix:T="",suffix:C=""}=i,E=v_e(`${T}${s}${C}`);m_e(c)&&p_e(c,g)&&!l&&s&&(S.fullText=f_e({text:s,searchFields:g}));const $=__e({searchTerm:E,layer:c,searchFields:g,filter:u,exactMatch:l,query:S,type:"suggest"});return S.where=$,h_e(S)?c.queryFeatures(S,{signal:h}).then(P=>Mst(P,i,a,m)):[]})}function c_e(t,e){const{filter:i,withinViewEnabled:r}=t,n=e==null?void 0:e.extent;return(i==null?void 0:i.geometry)??(r&&n?n:void 0)}function u_e(t){return t&&t.includes("*")}async function d_e(t){t&&await t.load()}function h_e(t){return!(!t.fullText&&!t.where)}function p_e(t,e){const i=t==null?void 0:t.indexes;return!i||!(e!=null&&e.length)?!1:i.filter(r=>r.indexType==="FullText").some(r=>{var s;const n=((s=r.fields)==null?void 0:s.split(",").map(o=>o.trim().toLowerCase()))||[];return e.every(o=>n.includes(o.toLowerCase()))})}function f_e({text:t,searchFields:e}){return t.trim().split(" ").filter(i=>!!i.trim()).map(i=>new Yhe({onFields:e,searchTerm:i,searchType:"prefix"}))}function m_e(t){var e,i;return((i=(e=t==null?void 0:t.capabilities)==null?void 0:e.query)==null?void 0:i.supportsFullTextSearch)??!1}function g_e(t){var e,i;return((i=(e=t==null?void 0:t.capabilities)==null?void 0:e.query)==null?void 0:i.supportsPagination)??!1}function bst(t){var e,i,r;return((r=(i=(e=t==null?void 0:t.fieldsIndex)==null?void 0:e.fields)==null?void 0:i.find(n=>n.type==="string"))==null?void 0:r.name)??""}function y_e(t){return t.displayField||t.layer.displayField||bst(t.layer)}function CO(t,e){return!(!t||!(e!=null&&e.length))&&e.every(i=>V7(t,i))}function V7(t,e){return!!t.getField(e)}function wst(t){for(let e=0;e<t.length;e++)if(t.charCodeAt(e)>255)return!0;return!1}function xst(t,e,i){let r=null;const{codedValues:n}=t;return n&&n.some(s=>{const o=s.name,a=i?o:o.toLowerCase();return(i?e:e.toLowerCase())===a&&(r=s.code.toString(),!0)}),r}function v_e(t){return t.replaceAll("'","''")}function sS(t,e){const i=e==null?void 0:e.where;return i?`(${t}) AND (${i})`:t}function Sst({currentTerm:t,field:e,filter:i,exactMatch:r,url:n,type:s}){const o=e==null?void 0:e.type,a=e==null?void 0:e.name;if(o==="string"||o==="date"||o==="global-id"){const l=gst.test(n??""),c=l&&wst(t)?"N":"";return sS(r&&s==="search"?`${a} = ${c}'${t}'`:l?`${a} LIKE ${c}${`'${t}%'`}`:`${`LOWER(${a})`} LIKE ${c}${`'${t.toLowerCase()}%'`}`,i)}if(o==="oid"||o==="small-integer"||o==="integer"||o==="single"||o==="double"){const l=Number(t);return isNaN(l)?null:sS(`${a} = ${l}`,i)}return sS(`${a} = ${t}`,i)}function Ist(t,e){return t?` OR (${e})`:`(${e})`}function __e({searchTerm:t,layer:e,searchFields:i,filter:r,exactMatch:n,query:s,type:o}){const{definitionExpression:a,url:l}=e;let c="";return!s.fullText&&t&&i&&i.forEach(u=>{const h=e.getField(u),f=typeof e.getFieldDomain=="function"&&e.getFieldDomain(u),m=(f&&f.type==="coded-value"?xst(f,t,n):null)||t||null;if(m!==null){const g=Sst({currentTerm:m,field:h,filter:r,exactMatch:n,url:l,type:o});g&&(c+=Ist(c,g))}}),a&&c?`(${a}) AND (${c})`:a||c}function Tst(t,e){let i=null;const{codedValues:r}=t;return r&&r.length&&r.some(n=>n.code===e&&(i=n.name,!0)),i}function Cst(t,e){return t[Object.keys(t).find(i=>i.toLowerCase()===e.toLowerCase())]}function b_e(t,e,i){const r=t.sourceLayer,{attributes:n}=t,s=typeof r.getFieldDomain=="function"&&r.getFieldDomain(i);if(e)return Os(e,n);if(i&&n){const o=r.getField(i),a=Cst(n,i);return a==null?"":s&&s.type==="coded-value"?Tst(s,a)??"":(o==null?void 0:o.type)==="date"?Oi(new Date(a)):typeof a=="number"?a.toString():typeof a!="string"?"":a.trim()}return""}function Est(t,e,i,r){const n=t.sourceLayer,{attributes:s}=t,{objectIdField:o}=n,a=o?s[o]:null;return{text:b_e(t,e.suggestionTemplate,r),key:a,sourceIndex:i}}function Mst(t,e,i,r){return t.features.map(n=>Est(n,e,i,r))}function $st(t,e,i,r,n,s,o){const a=t.clone(),l=t.sourceLayer,c=l==null?void 0:l.objectIdField,u=c?t.attributes[c]:null,h=b_e(t,i.searchTemplate,n),f=N7(a.geometry,e,s),m=typeof o=="number"?N8(U(f),e,o):f,g=t.clone();return m!=null&&(g.geometry=Zn.fromExtent(m)),{extent:m,target:g,feature:a,key:u,name:h,sourceIndex:r}}function Ast(t,e,i,r,n,s,o){return t.features.map(a=>$st(a,e,i,r,n,s,o))}var V8;let Zc=V8=class extends D7{constructor(t){super(t),this.displayField=null,this.exactMatch=null,this.orderByFields=null,this.searchFields=null,this.searchTemplate=null,this.suggestionTemplate=null,this.getResults=(e,i)=>vst({source:this,...e},i),this.getSuggestions=(e,i)=>_st({source:this,...e},i)}set layer(t){this._set("layer",t),t&&t.load().catch(()=>{})}get name(){return this._getLayerTitle()??""}set name(t){this._overrideIfSome("name",t)}clone(){return new V8({autoNavigate:this.autoNavigate,filter:this.filter,maxResults:this.maxResults,maxSuggestions:this.maxSuggestions,minSuggestCharacters:this.minSuggestCharacters,outFields:this.outFields?U(this.outFields):null,placeholder:this.placeholder,popupEnabled:this.popupEnabled,prefix:this.prefix,resultGraphicEnabled:this.resultGraphicEnabled,resultSymbol:this.resultSymbol?this.resultSymbol.clone():null,suggestionsEnabled:this.suggestionsEnabled,suffix:this.suffix,withinViewEnabled:this.withinViewEnabled,displayField:this.displayField,exactMatch:this.exactMatch,layer:this.layer,searchFields:this.searchFields?U(this.searchFields):null,suggestionTemplate:this.suggestionTemplate,zoomScale:this.zoomScale})}_getFirstStringField(){var t,e;return((e=(t=this.layer.fieldsIndex)==null?void 0:t.fields.find(i=>i.type==="string"))==null?void 0:e.name)??""}_getDisplayField(){return this.displayField||this.layer.displayField||this._getFirstStringField()}_getSearchFieldsString(){const{layer:t,searchFields:e}=this;return t.loaded?`: ${(e||[this._getDisplayField()]).map(i=>{const r=t.getField(i);return r&&r.alias||i}).join(", ")}`:""}_getLayerTitle(){const{layer:t}=this;if(!t)return;const{title:e}=t;return e?`${e}${this._getSearchFieldsString()}`:void 0}};d([p({json:{read:{source:"field.name"},write:{target:"field.name"}}})],Zc.prototype,"displayField",void 0),d([p({json:{read:{source:"field.exactMatch"},write:{target:"field.exactMatch"}}})],Zc.prototype,"exactMatch",void 0),d([p({value:null})],Zc.prototype,"layer",null),d([p()],Zc.prototype,"name",null),d([p({type:[String],json:{write:!0}})],Zc.prototype,"orderByFields",void 0),d([p()],Zc.prototype,"searchFields",void 0),d([p()],Zc.prototype,"searchTemplate",void 0),d([p()],Zc.prototype,"suggestionTemplate",void 0),Zc=V8=d([A("esri.widgets.Search.LayerSearchSource")],Zc);const Hb=Zc;function kst(t){return!!t&&typeof t.x=="number"&&typeof t.y=="number"}function Pst(t){return t&&typeof t.xmin=="number"&&typeof t.ymin=="number"&&typeof t.xmax=="number"&&typeof t.ymax=="number"}let Qf=class extends te{constructor(e){super(e),this.address=null,this.attributes=null,this.extent=null,this.location=null,this.score=null}};d([p({type:String,json:{write:!0}})],Qf.prototype,"address",void 0),d([p({type:Object,json:{write:!0}})],Qf.prototype,"attributes",void 0),d([p({type:Re,json:{write:!0}})],Qf.prototype,"extent",void 0),d([p({type:fe,json:{write:!0}})],Qf.prototype,"location",void 0),d([p({type:Number,json:{write:!0}})],Qf.prototype,"score",void 0),Qf=d([A("esri.rest.support.AddressCandidate")],Qf);const w_e=Qf,z7={type:String,json:{read:{source:"token"},write:{target:"token"}}};let Es=class extends te{constructor(e){super(e),this.address=null,this.apiKey=null,this.categories=null,this.countryCode=null,this.forStorage=null,this.location=null,this.locationType=null,this.magicKey=null,this.maxLocations=null,this.outFields=null,this.outSpatialReference=null,this.searchExtent=null}};d([p({type:Object,json:{write:!0}})],Es.prototype,"address",void 0),d([p(z7)],Es.prototype,"apiKey",void 0),d([p({type:[String],json:{read:{source:"category",reader:t=>t?t.split(","):null},write:{target:"category",writer:(t,e)=>{e.category=t?t.join(","):null}}}})],Es.prototype,"categories",void 0),d([p({type:String,json:{write:!0}})],Es.prototype,"countryCode",void 0),d([p({type:Boolean,json:{write:!0}})],Es.prototype,"forStorage",void 0),d([p({type:fe,json:{write:{writer:(t,e)=>{e.location=t?t.clone().normalize():null}}}})],Es.prototype,"location",void 0),d([p({type:String,json:{write:!0}})],Es.prototype,"locationType",void 0),d([p({type:String,json:{write:!0}})],Es.prototype,"magicKey",void 0),d([p({type:Number,json:{write:!0}})],Es.prototype,"maxLocations",void 0),d([p({type:[String],json:{write:{writer:(t,e)=>{e.outFields=t?t.join(","):null}}}})],Es.prototype,"outFields",void 0),d([p({type:Ee,json:{read:{source:"outSR"},write:{target:"outSR"}}})],Es.prototype,"outSpatialReference",void 0),d([p({type:Re,json:{write:{writer:(t,e)=>{const i=t?t.shiftCentralMeridian():null;e.searchExtent=i}}}})],Es.prototype,"searchExtent",void 0),Es=d([A("esri.rest.support.AddressToLocationsParameters")],Es),Es.from=lr(Es);const x_e=Es;async function Ost(t,e,i){e=x_e.from(e);const r=rx(t),{address:n,...s}=e.toJSON(),o={...n,...s,f:"json"},a=LC({...r.query,...o}),l=OC(a,i),c=`${r.path}/findAddressCandidates`;return at(c,l).then(Lst)}function Lst({data:t}){if(!t)return[];const{candidates:e,spatialReference:i}=t;return e?e.map(r=>{if(!r)return;const{extent:n,location:s}=r,o=!n||Pst(n);return kst(s)&&o?(n&&(n.spatialReference=i),s&&(s.spatialReference=i),w_e.fromJSON(r)):void 0}):[]}let kh=class extends te{constructor(e){super(e),this.apiKey=null,this.location=null,this.locationType=null,this.outSpatialReference=null}};d([p(z7)],kh.prototype,"apiKey",void 0),d([p({type:fe,json:{write:{writer:(t,e)=>{const i=t?t.clone().normalize():null,r=i!==void 0;e.location=r?i:null}}}})],kh.prototype,"location",void 0),d([p({type:String,json:{write:!0}})],kh.prototype,"locationType",void 0),d([p({type:Ee,json:{read:{source:"outSR"},write:{target:"outSR"}}})],kh.prototype,"outSpatialReference",void 0),kh=d([A("esri.rest.support.LocationToAddressParameters")],kh),kh.from=lr(kh);const S_e=kh;async function Rst(t,e,i){e=S_e.from(e);const r=rx(t),n={...e.toJSON(),f:"json"},s=LC({...r.query,...n}),o=OC(s,i),a=`${r.path}/reverseGeocode`;return at(a,o).then(Fst)}function Fst({data:t}){if(!t)return;const{address:e,location:i}=t,r=e&&e.Match_addr||"";return w_e.fromJSON({address:r,attributes:e||{},location:i,score:100})}let qb=class extends te{constructor(e){super(e),this.isCollection=null,this.magicKey=null,this.text=null}};d([p({type:Boolean,json:{write:!0}})],qb.prototype,"isCollection",void 0),d([p({type:String,json:{write:!0}})],qb.prototype,"magicKey",void 0),d([p({type:String,json:{write:!0}})],qb.prototype,"text",void 0),qb=d([A("esri.rest.support.SuggestionCandidate")],qb);const Dst=qb;let Ba=class extends te{constructor(e){super(e),this.apiKey=null,this.categories=null,this.countryCode=null,this.location=null,this.maxSuggestions=null,this.outSpatialReference=null,this.searchExtent=null,this.text=null}};d([p(z7)],Ba.prototype,"apiKey",void 0),d([p({type:[String],json:{read:{source:"category",reader:t=>t?t.split(","):null},write:{target:"category",writer:(t,e)=>{e.category=t?t.join(","):null}}}})],Ba.prototype,"categories",void 0),d([p({type:String,json:{write:!0}})],Ba.prototype,"countryCode",void 0),d([p({type:fe,json:{write:{writer:(t,e)=>{e.location=t?t.clone().normalize():null}}}})],Ba.prototype,"location",void 0),d([p({type:Number,json:{write:!0}})],Ba.prototype,"maxSuggestions",void 0),d([p({type:Ee,json:{read:{source:"outSR"},write:{target:"outSR"}}})],Ba.prototype,"outSpatialReference",void 0),d([p({type:Re,json:{write:{writer:(t,e)=>{const i=t?t.shiftCentralMeridian():null;e.searchExtent=JSON.stringify(i)}}}})],Ba.prototype,"searchExtent",void 0),d([p({type:String,json:{write:!0}})],Ba.prototype,"text",void 0),Ba=d([A("esri.rest.support.SuggestLocationsParameters")],Ba),Ba.from=lr(Ba);const I_e=Ba;async function Nst(t,e,i){const r=rx(t),n={...(e=I_e.from(e)).toJSON(),f:"json"},s=LC({...r.query,...n}),o=OC(s,i),a=`${r.path}/suggest`;return at(a,o).then(Vst)}function Vst(t){const{data:e}=t;if(!e)return[];const{suggestions:i}=e;return i?i.map(r=>new Dst(r)):[]}const zst="Single Line Input",jst=3e5;function Bst(t,e){return t.location?Wst(t,e):Jst(t,e)}function T_e(t,e){var r;if(e.localSearchDisabled)return null;const i=t==null?void 0:t.scale;return typeof i=="number"&&i<=jst?(r=t==null?void 0:t.extent)==null?void 0:r.center:null}async function Ust(t,e){const{source:i,spatialReference:r,view:n,suggestTerm:s,maxSuggestions:o,sourceIndex:a}=t,l=new I_e,{apiKey:c,url:u}=i,h=C_e(i,n),f=e&&e.signal;if(!u)return null;c&&(l.apiKey=c),i.categories&&(l.categories=i.categories),r&&(l.outSpatialReference=r);const m=T_e(n,i);if(m&&(l.location=m),!s.trim())return null;const{prefix:g="",suffix:y=""}=i,v=`${g}${s}${y}`;return l.text=v,h&&(l.searchExtent=h),l.maxSuggestions=o,i.countryCode&&(l.countryCode=i.countryCode),Nst(u,l,{signal:f}).then(b=>Yst(b,a))}function Gst(t){return!!t&&/(?:geocode\-api\.arcgis\.com\/arcgis\/rest\/services\/world\/geocodeserver).*/i.test(t)}function Hst(t){return!!t&&/(?:\/servers\/[\da-z\.-]+\/rest\/services\/world\/geocodeserver).*/i.test(t)}function Bee(t){return!!t&&/(?:arcgis\.com\/arcgis\/rest\/services\/world\/geocodeserver).*/i.test(t)}const qst="https://geocode-api.arcgis.com/arcgis/rest/services/World/GeocodeServer";async function Wst(t,e){const{source:i,spatialReference:r,location:n,sourceIndex:s,view:o}=t,{apiKey:a,url:l,zoomScale:c,defaultZoomScale:u}=i;if(l==null)return[];const h=o==null?void 0:o.scale,f=e==null?void 0:e.signal,m=new S_e;m.location=n,a&&(m.apiKey=a),r&&(m.outSpatialReference=r);try{return E_e([await Rst(l,m,{signal:f})],{sourceIndex:s,scale:h,view:o,zoomScale:c,defaultZoomScale:u})}catch{return[]}}function C_e(t,e){const{filter:i,withinViewEnabled:r}=t,n=e&&e.scale,s=e&&e.extent,o=i&&i.geometry;return N7(o,e,n)||(r&&s?s:void 0)}async function Jst(t,e){var C;const{source:i,suggestResult:r,spatialReference:n,view:s,maxResults:o,sourceIndex:a}=t,l=i&&i.zoomScale,c=i&&i.defaultZoomScale;if(!((C=r.text)==null?void 0:C.trim()))return null;const h=!r.key&&i.prefix?i.prefix:"",f=!r.key&&i.suffix?i.suffix:"",m=`${h}${r.text}${f}`,g=new x_e,{apiKey:y,url:v}=i,b=s&&s.scale,w=C_e(i,s),x=e&&e.signal;if(y&&(g.apiKey=y),!v)return null;i.categories&&(g.categories=i.categories),i.locationType&&(g.locationType=i.locationType),n&&(g.outSpatialReference=n);const S=T_e(s,i);S&&(g.location=S),g.maxLocations=o,w&&(g.searchExtent=w),i.countryCode&&(g.countryCode=i.countryCode);const{key:I}=r,T=`${I}`;return I&&(g.magicKey=T),g.address={},g.address[i.singleLineFieldName||zst]=m,i.outFields&&(g.outFields=i.outFields),Ost(v,g,{signal:x}).then(E=>E_e(E,{key:T,scale:b,sourceIndex:a,view:s,zoomScale:l,defaultZoomScale:c}))}function Zst(t,e){return{text:t.text,key:t.magicKey,sourceIndex:e}}function Yst(t,e){return t.map(i=>Zst(i,e))}function Kst(t,e){const{key:i,scale:r,sourceIndex:n,view:s,zoomScale:o,defaultZoomScale:a}=e,{attributes:l,extent:c,location:u,address:h}=t,f=new Or({geometry:u,attributes:l}),m=c||u,g=N7(m,s,r),y=typeof o=="number"?N8(g,s,o):typeof a=="number"&&(m==null?void 0:m.type)==="point"?N8(g,s,a):g,v=u?`${u.x},${u.y}`:"",b=h||v,w=f.clone();return y!=null&&(w.geometry=Zn.fromExtent(y)),{extent:y,feature:f,target:w,key:i,name:b,sourceIndex:n}}function E_e(t,e){return t.filter(Boolean).map(i=>Kst(i,e))}var z8;const Xst="esri.widgets.Search.LocatorSearchSource";let Xs=z8=class extends D7{constructor(t){super(t),this.apiKey=null,this.categories=null,this.countryCode=null,this.defaultZoomScale=null,this.localSearchDisabled=!1,this.locationType=null,this.name="",this.placeholder="",this.searchTemplate="",this.singleLineFieldName=null,this.suggestionsEnabled=null,this.url=null,this.zoomScale=null,this.getResults=(e,i)=>Bst({source:this,...e},i),this.getSuggestions=(e,i)=>Ust({source:this,...e},i)}clone(){return new z8({apiKey:this.apiKey,autoNavigate:this.autoNavigate,filter:this.filter,maxResults:this.maxResults,maxSuggestions:this.maxSuggestions,minSuggestCharacters:this.minSuggestCharacters,outFields:this.outFields?U(this.outFields):null,placeholder:this.placeholder,popupEnabled:this.popupEnabled,prefix:this.prefix,resultGraphicEnabled:this.resultGraphicEnabled,resultSymbol:this.resultSymbol?this.resultSymbol.clone():null,suggestionsEnabled:this.suggestionsEnabled,suffix:this.suffix,withinViewEnabled:this.withinViewEnabled,categories:this.categories?U(this.categories):null,countryCode:this.countryCode,locationType:this.locationType,searchTemplate:this.searchTemplate,singleLineFieldName:this.singleLineFieldName,zoomScale:this.zoomScale})}};d([p()],Xs.prototype,"apiKey",void 0),d([p()],Xs.prototype,"categories",void 0),d([p()],Xs.prototype,"countryCode",void 0),d([p({json:{write:!0}})],Xs.prototype,"defaultZoomScale",void 0),d([p()],Xs.prototype,"localSearchDisabled",void 0),d([p()],Xs.prototype,"locationType",void 0),d([p({json:{write:!0}})],Xs.prototype,"name",void 0),d([p({json:{write:!0}})],Xs.prototype,"placeholder",void 0),d([p()],Xs.prototype,"searchTemplate",void 0),d([p({json:{write:!0}})],Xs.prototype,"singleLineFieldName",void 0),d([p({json:{read:{source:"suggest"},write:{target:"suggest"}}})],Xs.prototype,"suggestionsEnabled",void 0),d([p({json:{write:!0}})],Xs.prototype,"url",void 0),d([p({json:{write:!0}})],Xs.prototype,"zoomScale",void 0),Xs=z8=d([A(Xst)],Xs);const M_e=Xs;let f0=class extends te{constructor(e){super(e),this.geometries=[],this.outSpatialReference=null,this.transformation=null,this.transformForward=null}toJSON(){const e=this.geometries.map(n=>n.toJSON()),i=this.geometries[0],r={};return r.outSR=this.outSpatialReference.wkid||JSON.stringify(this.outSpatialReference.toJSON()),r.inSR=i.spatialReference.wkid||JSON.stringify(i.spatialReference.toJSON()),r.geometries=JSON.stringify({geometryType:V1(i),geometries:e}),this.transformation&&(r.transformation=this.transformation.wkid||JSON.stringify(this.transformation)),this.transformForward!=null&&(r.transformForward=this.transformForward),r}};d([p()],f0.prototype,"geometries",void 0),d([p({json:{read:{source:"outSR"}}})],f0.prototype,"outSpatialReference",void 0),d([p()],f0.prototype,"transformation",void 0),d([p()],f0.prototype,"transformForward",void 0),f0=d([A("esri.rest.support.ProjectParameters")],f0);const $_e=f0,Qst=lr($_e);async function eot(t,e,i){e=Qst(e);const r=rx(t),n={...r.query,f:"json",...e.toJSON()},s=e.outSpatialReference,o=V1(e.geometries[0]),a=OC(n,i);return at(r.path+"/project",a).then(({data:{geometries:l}})=>jpe(l,o,s))}const A_e=ie.getLogger("esri.widgets.support.geolocationUtils"),tot={maximumAge:0,timeout:15e3,enableHighAccuracy:!0};function iot(){const t=ee("esri-geolocation");return t||A_e.warn("geolocation-unsupported","Geolocation unsupported."),t}function rot(){const t=window.isSecureContext;return t||A_e.warn("insecure-context","Geolocation requires a secure origin."),t}function Uee(){return iot()&&rot()}function not(t){return t||(t=tot),new Promise((i,r)=>{setTimeout(()=>r(new N("geolocation:timeout","getting the current geolocation position timed out")),15e3),navigator.geolocation.getCurrentPosition(i,r,t??void 0)})}function sot(t,e){const{position:i,view:r}=t,n=oot(i),s=n==null?void 0:n.coords;if(!s)throw new N("geometry-service:no-coords","Geolocation has no coordinates");return lot(aot(s),r,e)}function oot(t){const e=t&&t.coords||{},i={accuracy:e.accuracy,altitude:e.altitude,altitudeAccuracy:e.altitudeAccuracy,heading:e.heading,latitude:e.latitude,longitude:e.longitude,speed:e.speed};return t&&{coords:i,timestamp:t.timestamp}}function aot({longitude:t,latitude:e,altitude:i}){return new fe({longitude:t,latitude:e,z:i||void 0,spatialReference:{wkid:4326}})}function lot(t,e,i){if(!e)return Promise.resolve(t);const r=e.spatialReference;return r.isWGS84?Promise.resolve(t):r.isWebMercator?Promise.resolve(sp(t)):cot(i).then(n=>{if(!n)throw new N("geometry-service:missing-url","Geometry service URL is missing");const s=new $_e({geometries:[t],outSpatialReference:r});return eot(n,s,i).then(o=>o[0])})}function cot(t){if(Lt.geometryServiceUrl)return Promise.resolve(Lt.geometryServiceUrl);const e=on.getDefault();return e.load(t).catch(()=>{}).then(()=>e.get("helperServices.geometry.url"))}function Bs(t,e){return t.hasOwnProperty(e)&&t[e]!=null&&t[e]!==""}const uot=()=>ev("esri/widgets/Search/t9n/Search"),k_e="esri.widgets.Search.SearchViewModel",sh=ie.getLogger(k_e),Gee="highlight",KA=ye.ofType({key:t=>t.layer?"layer":"locator",base:D7,typeMap:{layer:Hb,locator:M_e}}),Hee=Ee.WGS84,dot="esri/images/search/search-symbol-32.png",hot=/<(?:.|\s)*?>/g,Wb=-1;let dt=class extends Pde(an.EventedMixin(he)){constructor(e){super(e),this._gotoController=null,this._searching=null,this._updatingPromise=null,this._createdFeatureLayers=[],this.autoNavigate=!0,this.autoSelect=!0,this.defaultPopupTemplate=null,this.defaultSources=new KA,this.defaultSymbols={point:new Ym({url:Tt(dot),size:24,width:24,height:24}),polyline:new Yn({color:[130,130,130,1],width:2}),polygon:new hc({color:[235,235,235,.4],outline:{color:[130,130,130,1],width:2}})},this.includeDefaultSources=!0,this.maxInputLength=128,this.maxResults=6,this.maxSuggestions=6,this.messages=null,this.minSuggestCharacters=3,this.popupEnabled=!0,this.popupTemplate=null,this.portal=on.getDefault(),this.resultCount=null,this.resultGraphicEnabled=!0,this.resultGraphic=null,this.results=null,this.selectedSuggestion=null,this.searchAllEnabled=!0,this.selectedResult=null,this.sources=new KA,this.suggestionDelay=350,this.suggestionCount=null,this.suggestions=null,this.suggestionsEnabled=!0,this.view=null}initialize(){const e=async()=>{const i=await uot();this.messages=i,this.defaultPopupTemplate=new Mp({title:i.searchResult,content:"{Match_addr}"})};e(),this.addHandles([J(()=>[this.includeDefaultSources,this.view,this.portal],()=>this._update(),Le),nC(e)])}destroy(){this.removeAllHandles(),this._destroyFeatureLayers(),this._abortGoTo(),this.clearGraphics()}get activeSource(){return this.allSources.at(this.activeSourceIndex)??null}get activeSourceIndex(){return this.allSources.length===1||!this.searchAllEnabled?0:Wb}set activeSourceIndex(e){this._overrideIfSome("activeSourceIndex",e)}get allPlaceholder(){var e;return(e=this.messages)==null?void 0:e.allPlaceholder}set allPlaceholder(e){this._overrideIfSome("allPlaceholder",e)}get allSources(){const{sources:e,defaultSources:i,includeDefaultSources:r}=this,n=typeof r=="function"?r.call(null,{sources:e,defaultSources:i}):r?i.concat(e):e,s=this._get("allSources")||new KA;return s.removeAll(),s.addMany(n.filter(Boolean)),s}get locationEnabled(){return this._get("locationEnabled")||Uee()}set locationEnabled(e){if(e===void 0)return void this._clearOverride("locationEnabled");const i=Uee();if(e&&!i){const r=new N("locationEnabled:geolocation-unsupported","Geolocation API is unsupported.",{geolocation:navigator.geolocation});sh.error(r)}this._override("locationEnabled",!!e&&i)}get placeholder(){const{allSources:e,activeSourceIndex:i,allPlaceholder:r}=this;if(i===Wb)return r??"";const n=e.at(i);return(n==null?void 0:n.placeholder)??""}set searchTerm(e){this._set("searchTerm",e||""),this.clearGraphics(),this.selectedSuggestion&&this.selectedSuggestion.text!==e&&this._set("selectedSuggestion",null),e===""&&this._clear()}get searchTerm(){return this._get("searchTerm")||""}get state(){return this._searching?"searching":this.updating?"loading":this.allSources.length===0?"disabled":"ready"}get updating(){return this._updatingPromise!=null}clear(){this.searchTerm=""}clearGraphics(){this._removeHighlight(),this._closePopup();const{view:e,resultGraphic:i}=this;e&&i&&e.graphics.remove(i),this._set("resultGraphic",null)}search(e,i){this.emit("search-start"),this.clearGraphics();const r=this._createSuggestionForSearch(e),n=(async()=>{var s;try{await this.when();const o=await this._getResultsFromSources(r,i);if((s=i==null?void 0:i.signal)!=null&&s.aborted)return null;const a={activeSourceIndex:this.activeSourceIndex,searchTerm:r.text??"",numResults:0,numErrors:0,errors:[],results:[]};this._formatResponse(a,o,r);const l=this._getFirstResult(a.results),c=r.location&&l?l.name:r.text,u=c==null?void 0:c.replace(hot,"");return this._set("searchTerm",u),(r.key&&typeof r.sourceIndex=="number"||r.location)&&this._set("selectedSuggestion",r),this._set("results",a.results),this._set("resultCount",a.results.reduce((h,f)=>{var m;return h+(((m=f.results)==null?void 0:m.length)??0)},0)),this.emit("search-complete",a),await this._selectFirstResult(l),a}finally{this._clearSearching()}})();return this._searching=n,n}async searchNearby(e){if(!this.locationEnabled){const r=new N("searchNearby:geolocation-unsupported","Geolocation API is unsupported.",{geolocation:navigator.geolocation});throw sh.error(r),r}const i=(async()=>{try{const r=await not(),n=await sot({position:r,view:this.view},e);return await this.search(n,e)}finally{this._clearSearching()}})();return this._searching=i,i}async select(e){if(this.clearGraphics(),!e){const $=new N("select:missing-parameter","Cannot select without a searchResult.",{searchResult:e});throw sh.error($),$}const{view:i}=this,r=Bs(e,"sourceIndex")?e.sourceIndex:this._getSourceIndexOfResult(e),n=r!=null?this.allSources.at(r):null;if(!n){const $=new N("select:missing-source","Cannot select without a source.",{source:n});throw sh.error($),$}const s=n instanceof Hb?this._getLayerSourcePopupTemplate(n):n.popupTemplate,o=n.resultSymbol||this._getDefaultSymbol(e),a=Bs(n,"resultGraphicEnabled")?n.resultGraphicEnabled:this.resultGraphicEnabled,l=Bs(n,"autoNavigate")?n.autoNavigate:this.autoNavigate,c=(Bs(n,"popupEnabled")?n.popupEnabled:this.popupEnabled)?s||this.popupTemplate||this.defaultPopupTemplate:null,{feature:u}=e;if(!u){const $=new N("select:missing-feature","Cannot select without a feature.",{feature:u});throw sh.error($),$}const{attributes:h,geometry:f,layer:m,sourceLayer:g}=u,y=jee(f),v={layerViewQuery:this._getLayerView(u),elevationQuery:i&&y!=null?mst(y,i).catch(()=>y):Promise.resolve(y)},b=await br(v),w=b.layerViewQuery.value,x=b.elevationQuery.value;o instanceof Gv&&(o.text=e.name);const S=i&&l?e.target||e.extent:null;await(S!=null?this._goToSearchResult(S):Promise.resolve());const T=w?u:new Or({geometry:f,symbol:o,attributes:h,layer:m,sourceLayer:g,popupTemplate:c}),C=i==null?void 0:i.popup,E=C&&T.getEffectivePopupTemplate(C.defaultPopupTemplateEnabled);return E&&await i.openPopup({features:[T],location:x}),w&&sR(w)&&!E&&this._highlightFeature({graphic:T,layerView:w}),!w&&a&&i&&i.graphics.push(T),this._setResultFloor(e),this._set("selectedResult",e),this._set("resultGraphic",T),this.emit("select-result",{result:e,source:n,sourceIndex:r}),e}async suggest(e,i,r){const n=e||this.searchTerm;this.emit("suggest-start",{searchTerm:n}),await this._suggestTimer(i,r);const s=await this._suggestImmediate(n,r);return this._set("suggestions",s==null?void 0:s.results),this._set("suggestionCount",(s==null?void 0:s.results.reduce((o,a)=>{var l;return o+(((l=a.results)==null?void 0:l.length)??0)},0))??null),this.emit("suggest-complete",s),s}async when(){await _r(()=>!this.updating)}async _update(){const{portal:e,view:i}=this;if(this.includeDefaultSources){const r=this._updatingPromise=br([e==null?void 0:e.load(),i==null?void 0:i.when()]);if(this.destroyed||(await r,r!==this._updatingPromise))return}await _r(()=>this.messages),this.destroyed||this._updateDefaultSources(),this._updatingPromise=null}_clearSearching(){this._searching=null}_convertHelperServices(){var i,r;const e=(r=(i=this.portal)==null?void 0:i.helperServices)==null?void 0:r.geocode;return e?e.map(n=>{var l;if(n.placefinding===!1)return;const s=Lt.apiKey&&Bee(n.url)?{url:qst}:null,o=M_e.fromJSON({...n,...s}),a=o.url;if(Bee(a)||Hst(a)||Gst(a)){const c=o.outFields??["Addr_type","Match_addr","StAddr","City"],u=(o.placeholder||((l=this.messages)==null?void 0:l.placeholder))??"",h=typeof o.defaultZoomScale=="number"?o.defaultZoomScale:2500;o.singleLineFieldName="SingleLine",o.outFields=c,o.placeholder=u,o.defaultZoomScale=h}return o.singleLineFieldName?o:void 0}).filter(Dt):[]}_destroyFeatureLayers(){this._createdFeatureLayers.forEach(e=>e==null?void 0:e.destroy()),this._createdFeatureLayers=[]}_getLayerSources(e,i){var n;const r=(n=this.view)==null?void 0:n.map;return e.map(s=>{const o=r.findLayerById(s.id);if(!o)return;const a=this._getLayerJSON(s),l=Hb.fromJSON(a);return l.placeholder=i,this._getLayer(o,a).then(c=>{l.layer=c}),l}).filter(Dt).toArray()}_getTableSources(e,i){var n;const r=(n=this.view)==null?void 0:n.map;return e.map(s=>{if(!s.id)return;const o=r.findTableById(s.id);if(!o)return;const a=this._getLayerJSON(s),l=Hb.fromJSON(a);return l.placeholder=i,this._getLayer(o,a).then(c=>{l.layer=c}),l}).filter(Dt).toArray()}_convertApplicationProperties(){var a,l,c;const e=(a=this.view)==null?void 0:a.map,i=(c=(l=e==null?void 0:e.applicationProperties)==null?void 0:l.viewing)==null?void 0:c.search;if(!i)return[];const{enabled:r,hintText:n,layers:s,tables:o}=i;return r?[...this._getLayerSources(s,n),...this._getTableSources(o,n)]:[]}async _getSubLayer(e,i){var s;if(await e.load(),!e.allSublayers)throw new Error;const r=e.allSublayers.find(o=>o.id===i.subLayer);if(!r)throw new Error;const n=await((s=r.createFeatureLayer)==null?void 0:s.call(r));if(!n)throw new Error;return this._createdFeatureLayers.push(n),n}async _getBuildingSubLayer(e,i){await e.load();const r=e.allSublayers.find(n=>n.id===i.subLayer);if((r==null?void 0:r.type)!=="building-component")throw new Error;if(await r.load(),r.associatedLayer==null)throw new Error;return await r.associatedLayer.load(),r}async _getLayer(e,i){if(e.type==="feature"||e.type==="scene"||e.type==="csv"||e.type==="geojson"||e.type==="ogc-feature")return e;if(e.type==="map-image")try{return await this._getSubLayer(e,i)}catch{const n=new N("search:create-featurelayer","Could not create a FeatureLayer from the MapImageLayer",{layer:e});return sh.error(n),null}return e.type==="building-scene"?this._getBuildingSubLayer(e,i):null}_getLayerJSON(e){return typeof e.toJSON=="function"?e.toJSON():e}_updateDefaultSources(){const{defaultSources:e,includeDefaultSources:i}=this;this._destroyFeatureLayers(),e.removeAll(),i&&e.addMany([...this._convertApplicationProperties(),...this._convertHelperServices()])}_abortGoTo(){this._gotoController&&this._gotoController.abort(),this._gotoController=null}_clear(){this._abortGoTo(),this._set("resultCount",null),this._set("results",null),this._set("suggestions",null),this._set("suggestionCount",null),this._set("selectedResult",null),this._set("selectedSuggestion",null),this.emit("search-clear")}_closePopup(){var s;const e=(s=this.view)==null?void 0:s.popup,{resultGraphic:i}=this;if(!e||!i)return;const r="selectedFeature"in e,n=r?e.selectedFeature:null;r&&n&&n===i&&e.close()}_suggestTimer(e,i){const r=e??this.suggestionDelay;return XT(r,null,i&&i.signal)}_createLocationForSearch(e){return e instanceof Or?jee(e.geometry):e instanceof fe?e:Array.isArray(e)&&e.length===2?new fe({longitude:e[0],latitude:e[1]}):null}_createSuggestionForSearch(e){if(e&&Bs(e,"key")&&Bs(e,"text")&&Bs(e,"sourceIndex"))return e;const i=this._createLocationForSearch(e),r=typeof e=="string"?e:this.searchTerm,{selectedSuggestion:n,selectedResult:s}=this,o=!e&&n&&s,a=o&&n.key===s.key&&n.sourceIndex===s.sourceIndex,l=o&&n.location;return a||l?n:{location:i,text:i?"":r,sourceIndex:null,key:null}}_getFirstResult(e){let i=null;return e&&e.some(r=>{const{results:n}=r,s=n==null?void 0:n[0],o=!!s;return o&&(i=s),o}),i}async _selectFirstResult(e){return this.autoSelect&&e?this.select(e):null}async _suggestImmediate(e,i){var s;await this.when();const r=await this._getSuggestionsFromSources(e,i);if((s=i==null?void 0:i.signal)!=null&&s.aborted)return null;const n={activeSourceIndex:this.activeSourceIndex,searchTerm:e??"",numResults:0,numErrors:0,errors:[],results:[]};return this._formatResponse(n,r),n}_formatSourceResponse(e,i,r){const n=(i==null?void 0:i.value)||[],s=i==null?void 0:i.error,o=this.allSources.at(r);if(s){const a={sourceIndex:r,source:o,error:s};e.errors.push(a),sh.error(s),e.numErrors++}else{const a={sourceIndex:r,source:o,results:n};e.results.push(a),e.numResults+=n.length}}_formatResponse(e,i,r){if(i)if(e.activeSourceIndex===Wb){const n=r&&Bs(r,"sourceIndex")&&r.sourceIndex!==-1?r.sourceIndex:void 0;i.forEach((s,o)=>{const a=n!==void 0?n:o;this._formatSourceResponse(e,s,a)})}else this._formatSourceResponse(e,i[0],e.activeSourceIndex)}async _getResultsFromSources(e,i){const{allSources:r}=this,n=!e.location&&Bs(e,"sourceIndex")?e.sourceIndex:this.activeSourceIndex,s=[];if(!r.length){const o=new N("search:no-sources-defined","At least one source is required.",{allSources:r});throw sh.error(o),o}return n===Wb?r.forEach((o,a)=>{s.push(this._getResultsFromSource(e,a,i))}):s.push(this._getResultsFromSource(e,n,i)),br(s)}async _getSuggestionsFromSources(e,i){const{allSources:r,activeSourceIndex:n}=this,s=[];if(!r.length){const o=new N("suggest:no-sources-defined","At least one source is required.",{allSources:r});throw sh.error(o),o}return n===Wb?r.forEach((o,a)=>{s.push(this._getSuggestionsFromSource(e,a,i))}):s.push(this._getSuggestionsFromSource(e,n,i)),br(s)}async _getResultsFromSource(e,i,r){var u,h;const n=i!=null?this.allSources.at(i):null;if(!n)return null;const{location:s=null}=e,o=((u=this.view)==null?void 0:u.spatialReference)||Hee,a=Bs(n,"maxResults")?n.maxResults:this.maxResults,l=!!(n instanceof Hb&&Bs(n,"exactMatch"))&&n.exactMatch,{view:c}=this;return(h=n.getResults)==null?void 0:h.call(n,{view:c,sourceIndex:i,location:s,suggestResult:e,spatialReference:o,exactMatch:l,maxResults:a},r)}async _getSuggestionsFromSource(e,i,r){var l,c;const n=this.allSources.at(i);if(!n)return null;e??(e="");const s=Bs(n,"suggestionsEnabled")?n.suggestionsEnabled:this.suggestionsEnabled,o=e==null?void 0:e.length,a=Bs(n,"minSuggestCharacters")?n.minSuggestCharacters:this.minSuggestCharacters;if(s&&e.trim()&&o>=a){const u=((l=this.view)==null?void 0:l.spatialReference)||Hee,h=Bs(n,"maxSuggestions")?n.maxSuggestions:this.maxSuggestions,{view:f}=this,m=!!(n instanceof Hb&&Bs(n,"exactMatch"))&&n.exactMatch;return(c=n.getSuggestions)==null?void 0:c.call(n,{view:f,sourceIndex:i,suggestTerm:e,spatialReference:u,maxSuggestions:h,exactMatch:m},r)}return null}_getLayerSourcePopupTemplate(e){const{layer:i}=e;if(i)return Bs(e,"popupTemplate")?e.popupTemplate:i.popupTemplate}_getSourceIndexOfResult(e){const i=this.results;if(!i)return null;let r=null;return i.some(n=>n.results.some(s=>s===e&&(r=n.sourceIndex,!0))),r}async _goToSearchResult(e){this._abortGoTo();const i=new AbortController;this._gotoController=i;const r={target:{target:e},options:{signal:i.signal}};e||(r.options.animate=!1),await this.callGoTo(r),this._gotoController=null}_getDefaultSymbol(e){var n;const{defaultSymbols:i}=this,r=(n=e.feature)==null?void 0:n.geometry;if(r==null)return null;switch(r.type){case"point":case"multipoint":return i.point;case"polyline":return i.polyline;case"extent":case"polygon":return i.polygon;default:return null}}_removeHighlight(){this.removeHandles(Gee)}async _getLayerView(e){var n,s;const{view:i}=this;if(!e||!i||((n=e.layer)==null?void 0:n.type)==="building-component"||((s=e.layer)==null?void 0:s.type)==="subtype-sublayer")return null;const{layer:r}=e;return r?(await i.when(),i.whenLayerView(r)):null}_highlightFeature(e){const{graphic:i,layerView:r}=e,{attributes:n,layer:s}=i,{objectIdField:o}=s,a=(o&&(n==null?void 0:n[o]))??null,l=r.highlight(a??i);this.addHandles(l,Gee)}_setResultFloor(e){var s,o,a;const{view:i}=this,r=(s=e.feature)==null?void 0:s.attributes,n=(o=e.feature)==null?void 0:o.sourceLayer;if(n&&"floorInfo"in n&&((a=n==null?void 0:n.floorInfo)!=null&&a.floorField)&&r){const l=r[n.floorInfo.floorField];i==null||i.emit("select-result-floor",l)}}};dt.ALL_INDEX=Wb,d([p()],dt.prototype,"_searching",void 0),d([p()],dt.prototype,"_updatingPromise",void 0),d([p({readOnly:!0,value:null})],dt.prototype,"activeSource",null),d([p()],dt.prototype,"activeSourceIndex",null),d([p()],dt.prototype,"allPlaceholder",null),d([p({readOnly:!0})],dt.prototype,"allSources",null),d([p()],dt.prototype,"autoNavigate",void 0),d([p()],dt.prototype,"autoSelect",void 0),d([p()],dt.prototype,"defaultPopupTemplate",void 0),d([p({readOnly:!0})],dt.prototype,"defaultSources",void 0),d([p()],dt.prototype,"defaultSymbols",void 0),d([p()],dt.prototype,"includeDefaultSources",void 0),d([p()],dt.prototype,"locationEnabled",null),d([p()],dt.prototype,"maxInputLength",void 0),d([p()],dt.prototype,"maxResults",void 0),d([p()],dt.prototype,"maxSuggestions",void 0),d([p()],dt.prototype,"messages",void 0),d([p()],dt.prototype,"minSuggestCharacters",void 0),d([p({readOnly:!0})],dt.prototype,"placeholder",null),d([p()],dt.prototype,"popupEnabled",void 0),d([p({type:Mp})],dt.prototype,"popupTemplate",void 0),d([p({type:on})],dt.prototype,"portal",void 0),d([p()],dt.prototype,"resultCount",void 0),d([p()],dt.prototype,"resultGraphicEnabled",void 0),d([p({readOnly:!0})],dt.prototype,"resultGraphic",void 0),d([p({readOnly:!0})],dt.prototype,"results",void 0),d([p({readOnly:!0})],dt.prototype,"selectedSuggestion",void 0),d([p()],dt.prototype,"searchAllEnabled",void 0),d([p({readOnly:!0})],dt.prototype,"selectedResult",void 0),d([p()],dt.prototype,"searchTerm",null),d([p({type:KA})],dt.prototype,"sources",void 0),d([p({readOnly:!0})],dt.prototype,"state",null),d([p()],dt.prototype,"suggestionDelay",void 0),d([p()],dt.prototype,"suggestionCount",void 0),d([p({readOnly:!0})],dt.prototype,"suggestions",void 0),d([p()],dt.prototype,"suggestionsEnabled",void 0),d([p({readOnly:!0})],dt.prototype,"updating",null),d([p()],dt.prototype,"view",void 0),d([p()],dt.prototype,"clear",null),dt=d([A(k_e)],dt);const bw=dt;let em=class extends di{constructor(e,i){super(e,i),this.messages=null,this.showMoreResultsOpen=!1,this.viewModel=null}destroy(){this.viewModel=null}render(){const e={[nh.showMoreResults]:this.showMoreResultsOpen};return M("div",{class:nh.base},M("div",{key:"esri-search-renderer__container",class:this.classes(nh.moreResults,e)},this.renderSearchResultName(),this.renderMoreResults()))}renderMoreResults(){return M("div",{key:"esri-search-renderer__more-results"},this.renderMoreResultsButton(),this.renderMoreResultsLists())}renderSearchResultName(){var r;const e=(r=this.viewModel)==null?void 0:r.selectedResult,i=e&&e.name||"";return M("div",{key:"esri-search-renderer__result-name",class:nh.moreResultsItem},i)}renderMoreResultsLists(){const{viewModel:e}=this;if(!e)return[];const i=e.results;if((e.resultCount??0)<2)return null;const r=i==null?void 0:i.map(n=>this.renderMoreResultsList(n));return M("div",{key:"esri-search-renderer__more-results-container",class:nh.moreResultsList},r)}renderMoreResultsButton(){const{messages:e,viewModel:i}=this;return i?(i.resultCount??0)<2?null:M("div",{key:"esri-search-renderer__more-results-button",class:nh.moreResultsItem},M("a",{class:nh.anchor,href:"#",bind:this,onclick:this._showMoreResultsClick,onkeydown:this._showMoreResultsClick},this.showMoreResultsOpen?e.hideMoreResults:e.showMoreResults)):null}renderMoreResultsHeader(e,i){return M("div",{key:`esri-search-result-renderer__header-${i}`,class:nh.moreResultsListHeader},e)}renderMoreResultsList(e){var h,f,m;const{results:i}=e,r=(i==null?void 0:i.length)??0,n=r>0,s=(h=this.viewModel)==null?void 0:h.selectedResult,o=r===1&&i[0]===s,a=this._getSourceName(e.source,e.sourceIndex),l=(((m=(f=this.viewModel)==null?void 0:f.results)==null?void 0:m.length)??0)>1&&!o?this.renderMoreResultsHeader(a,e.sourceIndex):null,c=n&&i.map((g,y)=>this.renderMoreResultsListItem(g,y)),u=n&&!o?M("ul",{key:`esri-search-result-renderer__list-${e.sourceIndex}`},c):null;return n?M("div",{key:`esri-search-result-renderer__results-${e.sourceIndex}`},l,u):null}renderMoreResultsListItem(e,i){return e!==this.get("viewModel.selectedResult")?M("li",{key:`esri-search-result-renderer__list-item-${i}`},M("a",{class:nh.anchor,href:"#",tabindex:"0",bind:this,"data-result":e,onclick:this._selectResultClick,onkeydown:this._selectResultClick},e.name)):null}_showMoreResultsClick(e){e.preventDefault(),this.showMoreResultsOpen=!this.showMoreResultsOpen;const i=this.get("viewModel.view.popup");i&&i.reposition()}_selectResultClick(e){var r;e.preventDefault();const i=e.currentTarget["data-result"];(r=this.viewModel)==null||r.select(i)}_getSourceName(e,i){return i===bw.ALL_INDEX?this.messages.all:e.name}};d([p(),ut("esri/widgets/Search/t9n/Search")],em.prototype,"messages",void 0),d([p()],em.prototype,"showMoreResultsOpen",void 0),d([p()],em.prototype,"viewModel",void 0),d([wr()],em.prototype,"_showMoreResultsClick",null),d([wr()],em.prototype,"_selectResultClick",null),em=d([A("esri.widgets.Search.SearchResultRenderer")],em);const pot=em,fot=/<[a-z/][\s\S]*>/i,mot=(t,e)=>{const i=E1e(e).split(/\s/),r=new RegExp(`(${i.join("|")})`,"gi");return t.replace(r,n=>`<strong>${n}</strong>`)};let ht=class extends di{constructor(e,i){super(e,i),this._activeMenuItemIndex=-1,this._inputNode=null,this._menuItemCount=0,this._sourceMenuButtonNode=null,this._sourceListNode=null,this._suggestionListNode=null,this._searchResultRenderer=new pot,this._suggestController=null,this._searchController=null,this._locateFailed=!1,this._container=null,this.activeMenu="none",this.disabled=!1,this.iconClass=Ne.widgetIcon,this.icon=null,this.messages=null,this.messagesCommon=null,this.viewModel=new bw,this._clearActiveMenu=()=>{this.activeMenu="none"},this._removeActiveMenu=r=>{var s;const n=r.relatedTarget;n&&((s=this._container)!=null&&s.contains(n))||this._clearActiveMenu()},this.addHandles([J(()=>this.searchTerm,r=>{(r&&this.activeMenu==="warning"||!r&&!this.get("viewModel.selectedSuggestion.location"))&&this._clearActiveMenu()}),ui(()=>{var r;return(r=this.viewModel)==null?void 0:r.allSources},"change",()=>this._watchSourceChanges()),J(()=>this.activeMenu,()=>this._resetActiveMenuItemIndex(),Le),J(()=>{var r;return(r=this.viewModel)==null?void 0:r.defaultPopupTemplate},r=>{r&&(r.content=this._renderSearchResultsContent.bind(this))},Le)])}destroy(){this.removeAllHandles(),this._cancelSuggest(),this._cancelSearch(),this._searchResultRenderer=je(this._searchResultRenderer)}get displayedSearchTerm(){return`${this.viewModel.searchTerm}`.trim()}get inputId(){return this._buildId("input")}get suggestionsMenuId(){return this._buildId("suggest-menu")}get sourceMenuId(){return this._buildId("source-menu")}get sourceMenuButtonId(){return this._buildId("source-menu-button")}get activeSource(){var e;return(e=this.viewModel)==null?void 0:e.activeSource}get activeSourceIndex(){return this.viewModel.activeSourceIndex}set activeSourceIndex(e){this.viewModel.activeSourceIndex=e}get allPlaceholder(){return this.viewModel.allPlaceholder}set allPlaceholder(e){this.viewModel.allPlaceholder=e}get allSources(){return this.viewModel.allSources}get autoNavigate(){return this.viewModel.autoNavigate}set autoNavigate(e){this.viewModel.autoNavigate=e}get autoSelect(){return this.viewModel.autoSelect}set autoSelect(e){this.viewModel.autoSelect=e}get defaultSources(){return this.viewModel.defaultSources}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}get includeDefaultSources(){return this.viewModel.includeDefaultSources}set includeDefaultSources(e){this.viewModel.includeDefaultSources=e}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get locationEnabled(){return this.viewModel.locationEnabled}set locationEnabled(e){this.viewModel.locationEnabled=e}get maxResults(){return this.viewModel.maxResults}set maxResults(e){this.viewModel.maxResults=e}get maxSuggestions(){return this.viewModel.maxSuggestions}set maxSuggestions(e){this.viewModel.maxSuggestions=e}get minSuggestCharacters(){return this.viewModel.minSuggestCharacters}set minSuggestCharacters(e){this.viewModel.minSuggestCharacters=e}get popupEnabled(){return this.viewModel.popupEnabled}set popupEnabled(e){this.viewModel.popupEnabled=e}get popupTemplate(){return this.viewModel.popupTemplate}set popupTemplate(e){this.viewModel.popupTemplate=e}get portal(){var e;return(e=this.viewModel)==null?void 0:e.portal}set portal(e){this.viewModel&&(this.viewModel.portal=e)}get resultGraphic(){return this.viewModel.resultGraphic}set resultGraphic(e){this.viewModel.resultGraphic=e}get resultGraphicEnabled(){return this.viewModel.resultGraphicEnabled}set resultGraphicEnabled(e){this.viewModel.resultGraphicEnabled=e}get results(){return this.viewModel.results}get searchAllEnabled(){return this.viewModel.searchAllEnabled}set searchAllEnabled(e){this.viewModel.searchAllEnabled=e}get searchTerm(){return this.viewModel.searchTerm}set searchTerm(e){this.viewModel.searchTerm=e}get selectedResult(){return this.viewModel.selectedResult}get sources(){return this.viewModel.sources}set sources(e){this.viewModel.sources=e}get suggestions(){return this.viewModel.suggestions}get suggestionsEnabled(){return this.viewModel.suggestionsEnabled}set suggestionsEnabled(e){this.viewModel.suggestionsEnabled=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}clear(){this.viewModel.clear()}focus(){var e;(e=this._inputNode)==null||e.focus(),this.emit("search-focus")}blur(){var e;(e=this._inputNode)==null||e.blur(),this.emit("search-blur")}async search(e){this._clearActiveMenu(),this._cancelSuggest(),this._cancelSearch();const i=new AbortController,{signal:r}=i;this._searchController=i;try{const n=await this.viewModel.search(e,{signal:r});return this._searchController!==i?void 0:(this.activeMenu=n!=null&&n.numResults?"none":"warning",this._searchController=null,n)}catch{return this._searchController!==i?void 0:(this._clearActiveMenu(),void(this._searchController=null))}}async suggest(e){this._cancelSuggest();const i=new AbortController,{signal:r}=i;this._suggestController=i;try{const n=await this.viewModel.suggest(e,null,{signal:r});return this._suggestController!==i?void 0:(this._suggestController=null,n!=null&&n.numResults&&this._openSuggestionMenu(),this._scrollToTopSuggestion(),n)}catch{return this._suggestController!==i||(this._suggestController=null),null}}render(){const{state:e}=this.viewModel,i={[Ne.disabled]:e==="disabled",[Ne.esriWidgetDisabled]:this.disabled};return M("div",{class:this.classes(Ne.base,i)},e==="loading"?this.renderLoader():this.renderContainer())}renderSubmitButton(){const{messages:e,disabled:i}=this;return M("button",{"aria-label":e.searchButtonTitle,bind:this,disabled:i,class:this.classes(Ne.submitButton,Ne.button),key:"esri-search__submit-button",onclick:this._handleSearchButtonClick,title:e.searchButtonTitle,type:"button"},M("span",{"aria-hidden":"true",class:Ne.searchIcon}))}renderWarningMenu(){return M("div",{key:"esri-search__error-menu",class:this.classes(Ne.menu,Ne.warningMenu)},M("div",{class:Ne.warningMenuBody},this.renderWarning()))}renderSourceMenuButton(){const{messages:e,activeMenu:i,sourceMenuId:r,sourceMenuButtonId:n,disabled:s}=this,{activeSourceIndex:o,allSources:a}=this.viewModel;return a.length>1?M("button",{id:n,key:"esri-search__source-menu-button",bind:this,disabled:s,"aria-label":e.searchIn,title:e.searchIn,"aria-haspopup":"true","aria-expanded":(i==="source").toString(),"aria-controls":r,class:this.classes(Ne.sourcesButton,Ne.button),onclick:this._handleSourcesMenuToggleClick,onfocus:this._handleSourcesMenuToggleFocus,afterCreate:Ed,"data-node-ref":"_sourceMenuButtonNode",type:"button"},M("span",{"aria-hidden":"true",class:Ne.dropdownIcon}),M("span",{"aria-hidden":"true",class:Ne.dropupIcon}),M("span",{class:Ne.sourceName},this._getSourceName(o))):null}renderSourcesList(){const{allSources:e,searchAllEnabled:i}=this.viewModel,{_activeMenuItemIndex:r,activeMenu:n,sourceMenuId:s,sourceMenuButtonId:o}=this,a=n==="source"&&r>-1?this._buildId("source-item",r):null;return e.length>1?M("ul",{"aria-activedescendant":a,"aria-labelledby":o,id:s,role:"menu",bind:this,afterCreate:Ed,onkeydown:this._handleSourceMenuKeydown,onkeyup:this._handleSourceMenuKeyup,"data-node-ref":"_sourceListNode",class:Ne.menuList,tabIndex:-1},i?this.renderSource(bw.ALL_INDEX):null,e.map((l,c)=>this.renderSource(c)).toArray()):null}renderSourcesMenu(){const{allSources:e}=this.viewModel;return e.length>1?M("div",{key:"esri-search__source-menu",class:this.classes(Ne.menu,Ne.sourcesMenu)},this.renderSourcesList()):null}renderLoader(){const{messages:e,messagesCommon:i,disabled:r}=this;return M("div",{class:Ne.loader,key:"base-loader",tabIndex:r?-1:void 0},M("span",{"aria-hidden":"true",class:Ne.loaderAnimation}),M("span",{class:Ne.fallbackText},e.searchButtonTitle),M("span",{class:Ne.loaderText},i.loading))}renderContainer(){const{allSources:e,state:i}=this.viewModel,{activeMenu:r}=this,n={[Ne.hasMultipleSources]:e.length>1,[Ne.isLoading]:i==="loading",[Ne.isSearching]:i==="searching",[Ne.showWarning]:r==="warning",[Ne.showSources]:r==="source",[Ne.showSuggestions]:r==="suggestion"};return M("div",{tabIndex:-1,afterCreate:s=>{this._container=s,s.addEventListener("focusout",this._removeActiveMenu)},afterRemoved:s=>{s.removeEventListener("focusout",this._removeActiveMenu)},class:this.classes(n,Ne.container),key:"base-container"},this.renderSourceMenuButton(),this.renderSourcesMenu(),this.renderInputContainer(),this.renderSubmitButton(),this.renderWarningMenu())}renderClearButton(){return this.searchTerm?M("button",{bind:this,disabled:this.disabled,class:this.classes(Ne.clearButton,Ne.button),key:"esri-search__clear-button",onclick:this._handleClearButtonClick,onfocus:this._clearActiveMenu,title:this.messages.clearButtonTitle,type:"button"},M("span",{"aria-hidden":"true",class:Ne.clearIcon})):null}renderLocationGroup(){const{messages:e,locationEnabled:i,displayedSearchTerm:r}=this,n=i&&!r,s=this.activeMenu==="suggestion"&&this._activeMenuItemIndex===0;return n?M("ul",{role:"group",key:"esri-search__suggestion-list-current-location",class:this.classes(Ne.menuList,Ne.suggestionList,Ne.suggestionListCurrentLocation)},M("li",{bind:this,"data-current-location-item":!0,onclick:this._handleUseCurrentLocationClick,id:this._buildId("suggestion-item",0),"aria-selected":(this.activeMenu==="suggestion"&&this._activeMenuItemIndex===0).toString(),role:"option",class:this.classes(Ne.menuItem,s?Ne.menuItemFocus:null)},M("span",{"aria-hidden":"true",class:Ne.locate})," ",e.useCurrentLocation)):null}renderInput(){const{activeMenu:e,locationEnabled:i,displayedSearchTerm:r,messages:n,suggestionsMenuId:s,inputId:o,_activeMenuItemIndex:a,disabled:l}=this,{maxInputLength:c,placeholder:u,searchTerm:h,suggestionCount:f}=this.viewModel,m=!(!(i&&!r)&&!f),g=e==="suggestion"&&a>-1?this._buildId("suggestion-item",a):null;return M("input",{"aria-activedescendant":g,"aria-autocomplete":"list","aria-expanded":(m&&e==="suggestion").toString(),"aria-controls":m?s:null,"aria-haspopup":"listbox","aria-label":n.searchButtonTitle,bind:this,disabled:l,placeholder:u,maxlength:c,autocomplete:"off",type:"text",class:this.classes(Ne.esriInput,Ne.input),value:h,id:o,role:"combobox",onkeyup:this._handleInputKeyup,onclick:this._openSuggestionMenu,oninput:this._handleInputPaste,onpaste:this._handleInputPaste,afterCreate:Ed,"data-node-ref":"_inputNode",onfocus:this.focus,onblur:this.blur,title:h?"":u})}renderForm(){return M("form",{key:"esri-search__form",bind:this,disabled:this.disabled,class:Ne.form,onsubmit:this._formSubmit,role:"search"},this.renderInput())}renderSuggestList(e){const{sourceIndex:i}=e,{results:r}=e;return(r==null?void 0:r.length)?M("ul",{role:"group",key:`esri-search__suggestion-list-${i}`,class:this.classes(Ne.menuList,Ne.suggestionList)},r==null?void 0:r.map(s=>this.renderSuggestion(s,this._menuItemCount++))):null}renderSuggestionsGroup(){const{suggestions:e}=this.viewModel;return e?e.map(i=>[this.renderSuggestionHeader(i),this.renderSuggestList(i)]):[]}renderSuggestionsMenu(){const{displayedSearchTerm:e,locationEnabled:i,suggestionsMenuId:r,inputId:n}=this,{suggestionCount:s}=this.viewModel,o=i&&!e||s;return this._menuItemCount=0,o?M("div",{id:r,key:"esri-search__suggestions-menu",class:this.classes(Ne.menu,Ne.suggestionsMenu),role:"listbox","aria-labelledby":n,bind:this,afterCreate:Ed,"data-node-ref":"_suggestionListNode"},this.renderLocationGroup(),this.renderSuggestionsGroup()):null}renderInputContainer(){return M("div",{key:"esri-search__input-container",class:Ne.inputContainer},this.renderForm(),this.renderSuggestionsMenu(),this.renderClearButton())}renderSuggestionHeader(e){var a;const{allSources:i,activeSourceIndex:r}=this.viewModel,{sourceIndex:n}=e,s=(a=e.results)==null?void 0:a.length,o=i.length>1&&r===bw.ALL_INDEX;return s&&o?M("div",{key:`esri-search__suggestion-header-${n}`,class:Ne.menuHeader},this._getSourceName(n)):null}renderSuggestion(e,i){const{_activeMenuItemIndex:r,viewModel:{searchTerm:n}}=this;if(!n)return;const s=this.activeMenu==="suggestion"&&r===i;return M("li",{bind:this,id:this._buildId("suggestion-item",i),"aria-selected":(this.activeMenu==="suggestion"&&this._activeMenuItemIndex===i).toString(),onclick:this._handleSuggestionClick,key:`esri-search__suggestion_${i}`,"data-suggestion":e,role:"option",innerHTML:this._getSuggestResultHTML(e.text,n),class:this.classes(Ne.menuItem,s?Ne.menuItemFocus:null)})}renderSource(e){const{activeSourceIndex:i,searchAllEnabled:r}=this.viewModel,n={[Ne.menuItemActive]:e===i,[Ne.menuItemFocus]:this.activeMenu==="source"&&e===(r?this._activeMenuItemIndex-1:this._activeMenuItemIndex)},s=r?e+1:e;return M("li",{bind:this,key:`esri-search__source-${e}`,id:this._buildId("source-item",s),"aria-checked":(e===i).toString(),onclick:this._handleSourceClick,"data-source-index":e,role:"menuitemradio",class:this.classes(Ne.source,Ne.menuItem,n)},this._getSourceName(e))}renderNoResultsWarning(e){const{messages:i}=this,r=e?Os(i.noResultsFoundForValue,{value:`"${e}"`}):i.noResultsFound;return M("div",{key:"esri-search__no_results"},M("div",{class:Ne.warningMenuHeader},i.noResults),M("div",{class:Ne.warningMenuText},r))}renderEmptySearchWarning(){const{messages:e}=this;return M("div",{key:"esri-search__empty-search"},M("span",{"aria-hidden":"true",class:Ne.noticeIcon}),M("span",{class:Ne.noValueText},e.emptyValue))}renderLocateWarning(){const{messages:e}=this;return M("div",{key:"esri-search__locate-error"},M("span",{"aria-hidden":"true",class:Ne.noticeIcon}),M("span",{class:Ne.noValueText},e.locateError))}renderWarning(){var n;const{displayedSearchTerm:e,_locateFailed:i}=this,{viewModel:r}=this;return i?this.renderLocateWarning():(n=r.selectedSuggestion)!=null&&n.location||e?this.renderNoResultsWarning(e):this.renderEmptySearchWarning()}_resetActiveMenuItemIndex(){this._activeMenuItemIndex=-1}_buildId(e,i){return`${this.id}-${e}${i===void 0?"":`-${i}`}`}_watchSourceChanges(){const{viewModel:{allSources:e}}=this,i="sources";this.removeHandles(i),e.forEach(r=>this.addHandles(J(()=>r.name,()=>this.scheduleRender()),i))}_handleSourcesMenuToggleFocus(){this.activeMenu!=="source"&&this._clearActiveMenu()}_handleSourcesMenuToggleClick(){var i;const e=this.activeMenu==="source";this.activeMenu=e?"none":"source",this.renderNow(),this.activeMenu==="source"&&((i=this._sourceListNode)==null||i.focus())}_handleClearButtonClick(){this.viewModel.clear(),this._focus()}_handleSearchButtonClick(){this.search()}_handleSuggestionClick(e){const i=qee(e.currentTarget);i&&(this._focus(),this.search(i))}_handleUseCurrentLocationClick(){this._useCurrentLocation()}_useCurrentLocation(){this._focus("none"),this._cancelSuggest(),this._cancelSearch();const e=new AbortController,{signal:i}=e;this._searchController=e,(async()=>{try{const r=await this.viewModel.searchNearby({signal:i});this.activeMenu=r!=null&&r.numResults?"none":"warning"}catch{this._locateFailed=!0,this.activeMenu="warning"}finally{this._searchController=null}})()}_handleSourceClick(e){this._setSourceFromMenuItem(e.currentTarget)}_setSourceFromMenuItem(e){var r;if(!e)return;const i=got(e);i!=null&&(this.viewModel.activeSourceIndex=i,this._clearActiveMenu(),(r=this._sourceMenuButtonNode)==null||r.focus())}_cancelSuggest(){this._suggestController=Qr(this._suggestController)}_cancelSearch(){this._searchController=Qr(this._searchController),this._locateFailed=!1}_handleInputKeyup(e){var s;const i=ip(e);if(e.ctrlKey||e.metaKey||i==="Copy"||i==="ArrowLeft"||i==="ArrowRight"||i==="Shift")return;if(i==="Tab"||i==="Escape"||e.shiftKey&&i==="Tab")return this._cancelSuggest(),void(i==="Escape"&&this._clearActiveMenu());const r=i==="Home"||i==="End"||i==="ArrowUp"||i==="ArrowDown";if(i==="Enter"&&this._activeMenuItemIndex<0)return void this._cancelSuggest();const n=(s=this._suggestionListNode)==null?void 0:s.getElementsByTagName("li");if(n!=null&&n.length){if(this.activeMenu!=="suggestion"&&this._openSuggestionMenu(),r)return e.preventDefault(),this._cancelSuggest(),void this._handleItemNavigation(i,n,this._suggestionListNode);const o=n[this._activeMenuItemIndex];if(i==="Enter"&&o){const a=qee(o);return void(a?(this._focus(),this.search(a)):yot(o)&&this._useCurrentLocation())}}this.viewModel.searchTerm&&this.suggest()}_handleItemNavigation(e,i,r){const n=this._activeMenuItemIndex;e==="Home"&&(this._activeMenuItemIndex=0),e==="End"&&(this._activeMenuItemIndex=i.length-1),e==="ArrowUp"&&(this._activeMenuItemIndex=this._activeMenuItemIndex<=0?i.length-1:this._activeMenuItemIndex-1),e==="ArrowDown"&&(this._activeMenuItemIndex=this._activeMenuItemIndex===i.length-1?0:this._activeMenuItemIndex+1),n!==this._activeMenuItemIndex&&r&&nLe(i[this._activeMenuItemIndex],r)}_scrollToTopSuggestion(){this._suggestionListNode&&(this._suggestionListNode.scrollTop=0)}_openSuggestionMenu(){this.activeMenu="suggestion"}_handleInputPaste(e){const i=e.target;this.viewModel.searchTerm!==i.value&&(this.viewModel.searchTerm=i.value),this.viewModel.searchTerm&&this.suggest()}_handleSourceMenuKeydown(e){var r;const i=ip(e);if(W0(i)){e.preventDefault();const n=(r=this._sourceListNode)==null?void 0:r.getElementsByTagName("li"),s=n==null?void 0:n[this._activeMenuItemIndex];this._setSourceFromMenuItem(s)}else i!=="ArrowUp"&&i!=="ArrowDown"&&i!=="End"&&i!=="Home"||e.preventDefault()}_handleSourceMenuKeyup(e){var s,o,a;const i=ip(e),r=i==="ArrowUp"||i==="ArrowDown"||i==="End"||i==="Home";if(r&&e.preventDefault(),i==="Escape")return this._clearActiveMenu(),void((s=this._sourceMenuButtonNode)==null?void 0:s.focus());const n=(o=this._sourceListNode)==null?void 0:o.getElementsByTagName("li");return n&&n.length!==0&&r?(this.activeMenu!=="source"&&(this.activeMenu="source"),void this._handleItemNavigation(i,n,(a=this._sourceListNode)==null?void 0:a.parentElement)):void 0}_focus(e){this.focus(),e&&(this.activeMenu=e)}_formSubmit(e){e.preventDefault(),this._activeMenuItemIndex===-1&&this.search()}_getSourceName(e){const{messages:i}=this,r=this.viewModel,{allSources:n}=r,s=n.at(e);return e===bw.ALL_INDEX?i.all:s&&s.name||i.untitledSource}_getSuggestResultHTML(e,i){return e?fot.test(e)?e:mot(e,i):this.messages.untitledResult}_renderSearchResultsContent(){return this._searchResultRenderer.showMoreResultsOpen=!1,this._searchResultRenderer.viewModel=this.viewModel,this._searchResultRenderer}};function qee(t){return t==null?void 0:t["data-suggestion"]}function got(t){return t==null?void 0:t["data-source-index"]}function yot(t){return!!(t!=null&&t["data-current-location-item"])}d([p()],ht.prototype,"_activeMenuItemIndex",void 0),d([p()],ht.prototype,"displayedSearchTerm",null),d([p({readOnly:!0})],ht.prototype,"inputId",null),d([p({readOnly:!0})],ht.prototype,"suggestionsMenuId",null),d([p({readOnly:!0})],ht.prototype,"sourceMenuId",null),d([p({readOnly:!0})],ht.prototype,"sourceMenuButtonId",null),d([p()],ht.prototype,"activeMenu",void 0),d([p({readOnly:!0})],ht.prototype,"activeSource",null),d([p()],ht.prototype,"activeSourceIndex",null),d([p()],ht.prototype,"allPlaceholder",null),d([p({readOnly:!0})],ht.prototype,"allSources",null),d([p()],ht.prototype,"autoNavigate",null),d([p()],ht.prototype,"autoSelect",null),d([p({readOnly:!0})],ht.prototype,"defaultSources",null),d([p()],ht.prototype,"disabled",void 0),d([p()],ht.prototype,"goToOverride",null),d([p()],ht.prototype,"iconClass",void 0),d([p()],ht.prototype,"icon",void 0),d([p()],ht.prototype,"includeDefaultSources",null),d([p()],ht.prototype,"label",null),d([p()],ht.prototype,"locationEnabled",null),d([p()],ht.prototype,"maxResults",null),d([p()],ht.prototype,"maxSuggestions",null),d([p(),ut("esri/widgets/Search/t9n/Search")],ht.prototype,"messages",void 0),d([p(),ut("esri/t9n/common")],ht.prototype,"messagesCommon",void 0),d([p()],ht.prototype,"minSuggestCharacters",null),d([p()],ht.prototype,"popupEnabled",null),d([p()],ht.prototype,"popupTemplate",null),d([p()],ht.prototype,"portal",null),d([p()],ht.prototype,"resultGraphic",null),d([p()],ht.prototype,"resultGraphicEnabled",null),d([p({readOnly:!0})],ht.prototype,"results",null),d([p()],ht.prototype,"searchAllEnabled",null),d([p()],ht.prototype,"searchTerm",null),d([p({readOnly:!0})],ht.prototype,"selectedResult",null),d([p()],ht.prototype,"sources",null),d([p({readOnly:!0})],ht.prototype,"suggestions",null),d([p()],ht.prototype,"suggestionsEnabled",null),d([p()],ht.prototype,"view",null),d([BC(["search-complete","search-clear","search-start","select-result","suggest-start","suggest-complete"]),p({type:bw})],ht.prototype,"viewModel",void 0),ht=d([A("esri.widgets.Search")],ht);const vot=ht;function _ot(t){const{exifInfo:e,exifName:i,tagName:r}=t;if(!e||!i||!r)return null;const n=e.find(s=>s.name===i);return n?bot({tagName:r,tags:n.tags}):null}function bot(t){const{tagName:e,tags:i}=t;if(!i||!e)return null;const r=i.find(n=>n.name===e);return r&&r.value||null}var j8;const wot={1:{id:1,rotation:0,mirrored:!1},2:{id:2,rotation:0,mirrored:!0},3:{id:3,rotation:180,mirrored:!1},4:{id:4,rotation:180,mirrored:!0},5:{id:5,rotation:-90,mirrored:!0},6:{id:6,rotation:90,mirrored:!1},7:{id:7,rotation:90,mirrored:!0},8:{id:8,rotation:-90,mirrored:!1}};let oa=j8=class extends te{constructor(t){super(t),this.contentType=null,this.exifInfo=null,this.id=null,this.globalId=null,this.keywords=null,this.name=null,this.parentGlobalId=null,this.parentObjectId=null,this.size=null,this.url=null}get orientationInfo(){const{exifInfo:t}=this,e=_ot({exifName:"Exif IFD0",tagName:"Orientation",exifInfo:t});return wot[e]||null}clone(){return new j8({contentType:this.contentType,exifInfo:this.exifInfo,id:this.id,globalId:this.globalId,keywords:this.keywords,name:this.name,parentGlobalId:this.parentGlobalId,parentObjectId:this.parentObjectId,size:this.size,url:this.url})}};d([p({type:String})],oa.prototype,"contentType",void 0),d([p()],oa.prototype,"exifInfo",void 0),d([p({readOnly:!0})],oa.prototype,"orientationInfo",null),d([p({type:wt})],oa.prototype,"id",void 0),d([p({type:String})],oa.prototype,"globalId",void 0),d([p({type:String})],oa.prototype,"keywords",void 0),d([p({type:String})],oa.prototype,"name",void 0),d([p({json:{read:!1}})],oa.prototype,"parentGlobalId",void 0),d([p({json:{read:!1}})],oa.prototype,"parentObjectId",void 0),d([p({type:wt})],oa.prototype,"size",void 0),d([p({json:{read:!1}})],oa.prototype,"url",void 0),oa=j8=d([A("esri.layers.support.AttachmentInfo")],oa);const xot=oa,Wee={editing:!1,operations:{add:!0,update:!0,delete:!0}},P_e=ye.ofType(xot);let aa=class extends he{constructor(e){super(e),this._getAttachmentsPromise=null,this._attachmentLayer=null,this.capabilities={...Wee},this.activeAttachmentInfo=null,this.activeFileInfo=null,this.attachmentInfos=new P_e,this.fileInfos=new ye,this.graphic=null,this.mode="view",this.filesEnabled=!1,this.addHandles(J(()=>this.graphic,()=>this._graphicChanged(),Le))}destroy(){this._attachmentLayer=null,this.graphic=null}castCapabilities(e){return{...Wee,...e}}get state(){return this._getAttachmentsPromise?"loading":this.graphic?"ready":"disabled"}get supportsResizeAttachments(){const{graphic:e}=this;if(!e)return!1;const i=e.layer||e.sourceLayer;return(i==null?void 0:i.loaded)&&"capabilities"in i&&i.capabilities&&"operations"in i.capabilities&&"supportsResizeAttachments"in i.capabilities.operations&&i.capabilities.operations.supportsResizeAttachments||!1}async getAttachments(){const{_attachmentLayer:e,attachmentInfos:i}=this;if(!e||typeof e.queryAttachments!="function")throw new N("invalid-layer","getAttachments(): A valid layer is required.");const r=this._getObjectId(),n=new $P({objectIds:[r],returnMetadata:!0}),s=[],o=e.queryAttachments(n).then(l=>l[r]||s).catch(()=>s);this._getAttachmentsPromise=o,this.notifyChange("state");const a=await o;return i.removeAll(),a.length&&i.addMany(a),this._getAttachmentsPromise=null,this.notifyChange("state"),a}async addAttachment(e,i=this.graphic){var l;const{_attachmentLayer:r,attachmentInfos:n,capabilities:s}=this;if(!i)throw new N("invalid-graphic","addAttachment(): A valid graphic is required.",{graphic:i});if(!e)throw new N("invalid-attachment","addAttachment(): An attachment is required.",{attachment:e});if(!((l=s.operations)!=null&&l.add))throw new N("invalid-capabilities","addAttachment(): add capabilities are required.");if(!r||typeof r.addAttachment!="function")throw new N("invalid-layer","addAttachment(): A valid layer is required.");const o=r.addAttachment(i,e).then(c=>this._queryAttachment(c.objectId,i)),a=await o;return n.add(a),a}async deleteAttachment(e){var l;const{_attachmentLayer:i,attachmentInfos:r,graphic:n,capabilities:s}=this;if(!e)throw new N("invalid-attachment-info","deleteAttachment(): An attachmentInfo is required.",{attachmentInfo:e});if(!((l=s.operations)!=null&&l.delete))throw new N("invalid-capabilities","deleteAttachment(): delete capabilities are required.");if(!i||typeof i.deleteAttachments!="function")throw new N("invalid-layer","deleteAttachment(): A valid layer is required.");if(!n)throw new N("invalid-graphic","deleteAttachment(): A graphic is required.");const o=i.deleteAttachments(n,[e.id]).then(()=>e),a=await o;return r.remove(a),a}async updateAttachment(e,i=this.activeAttachmentInfo){var u;const{_attachmentLayer:r,attachmentInfos:n,graphic:s,capabilities:o}=this;if(!e)throw new N("invalid-attachment","updateAttachment(): An attachment is required.",{attachment:e});if(!i)throw new N("invalid-attachment-info","updateAttachment(): An attachmentInfo is required.",{attachmentInfo:i});if(!((u=o.operations)!=null&&u.update))throw new N("invalid-capabilities","updateAttachment(): Update capabilities are required.");const a=n.findIndex(h=>h===i);if(!r||typeof r.updateAttachment!="function")throw new N("invalid-layer","updateAttachment(): A valid layer is required.");if(!s)throw new N("invalid-graphic","updateAttachment(): A graphic is required.");const l=r.updateAttachment(s,i.id,e).then(h=>this._queryAttachment(h.objectId)),c=await l;return n.splice(a,1,c),c}async commitFiles(){return await Promise.all(this.fileInfos.items.map(e=>this.addAttachment(e.form))),this.fileInfos.removeAll(),this.getAttachments()}addFile(e,i){if(!e||!i)return null;const r={file:e,form:i};return this.fileInfos.add(r),r}updateFile(e,i,r=this.activeFileInfo){if(!e||!i||!r)return null;const n=this.fileInfos.findIndex(s=>r===s);return n>-1&&this.fileInfos.splice(n,1,{file:e,form:i}),this.fileInfos.items[n]}deleteFile(e){const i=this.fileInfos.find(r=>r.file===e);return i?(this.fileInfos.remove(i),i):null}async _queryAttachment(e,i){const{_attachmentLayer:r}=this;if(!e||!(r!=null&&r.queryAttachments))throw new N("invalid-attachment-id","Could not query attachment.");const n=this._getObjectId(i),s=new $P({objectIds:[n],attachmentsWhere:`AttachmentId=${e}`,returnMetadata:!0});return r.queryAttachments(s).then(o=>o[n][0])}_getObjectId(e=this.graphic){return(e==null?void 0:e.getObjectId())??null}_graphicChanged(){this.graphic&&(this._setAttachmentLayer(),this.getAttachments().catch(()=>{}))}_setAttachmentLayer(){const{graphic:e}=this,i=BHe(e);this._attachmentLayer=i?i.type==="scene"&&i.associatedLayer!=null?i.associatedLayer:i:null}};d([p()],aa.prototype,"capabilities",void 0),d([tt("capabilities")],aa.prototype,"castCapabilities",null),d([p()],aa.prototype,"activeAttachmentInfo",void 0),d([p()],aa.prototype,"activeFileInfo",void 0),d([p({readOnly:!0,type:P_e})],aa.prototype,"attachmentInfos",void 0),d([p()],aa.prototype,"fileInfos",void 0),d([p({type:Or})],aa.prototype,"graphic",void 0),d([p()],aa.prototype,"mode",void 0),d([p({readOnly:!0})],aa.prototype,"state",null),d([p()],aa.prototype,"filesEnabled",void 0),d([p({readOnly:!0})],aa.prototype,"supportsResizeAttachments",null),aa=d([A("esri.widgets.Attachments.AttachmentsViewModel")],aa);const j7=aa;function Jee(t){const e=t.toLowerCase();return e==="image/bmp"||e==="image/emf"||e==="image/exif"||e==="image/gif"||e==="image/x-icon"||e==="image/jpeg"||e==="image/png"||e==="image/tiff"||e==="image/x-wmf"}function Sot(t){const e=Tt("esri/themes/base/images/files/");return t?t==="text/plain"?`${e}text-32.svg`:t==="application/pdf"?`${e}pdf-32.svg`:t==="text/csv"?`${e}csv-32.svg`:t==="application/gpx+xml"?`${e}gpx-32.svg`:t==="application/x-dwf"?`${e}cad-32.svg`:t==="application/postscript"||t==="application/json"||t==="text/xml"||t==="model/vrml"?`${e}code-32.svg`:t==="application/x-zip-compressed"||t==="application/x-7z-compressed"||t==="application/x-gzip"||t==="application/x-tar"||t==="application/x-gtar"||t==="application/x-bzip2"||t==="application/gzip"||t==="application/x-compress"||t==="application/x-apple-diskimage"||t==="application/x-rar-compressed"||t==="application/zip"?`${e}zip-32.svg`:t.includes("image/")?`${e}image-32.svg`:t.includes("audio/")?`${e}sound-32.svg`:t.includes("video/")?`${e}video-32.svg`:t.includes("msexcel")||t.includes("ms-excel")||t.includes("spreadsheetml")?`${e}excel-32.svg`:t.includes("msword")||t.includes("ms-word")||t.includes("wordprocessingml")?`${e}word-32.svg`:t.includes("powerpoint")||t.includes("presentationml")?`${e}report-32.svg`:`${e}generic-32.svg`:`${e}generic-32.svg`}const Zee={addButton:!0,addSubmitButton:!0,cancelAddButton:!0,cancelUpdateButton:!0,deleteButton:!0,errorMessage:!0,progressBar:!0,updateButton:!0},Nt="esri-attachments",ty="esri-button",_e={base:Nt,loaderContainer:`${Nt}__loader-container`,loader:`${Nt}__loader`,fadeIn:`${Nt}--fade-in`,container:`${Nt}__container`,containerList:`${Nt}__container--list`,containerPreview:`${Nt}__container--preview`,actions:`${Nt}__actions`,deleteButton:`${Nt}__delete-button`,addAttachmentButton:`${Nt}__add-attachment-button`,errorMessage:`${Nt}__error-message`,items:`${Nt}__items`,item:`${Nt}__item`,itemButton:`${Nt}__item-button`,itemMask:`${Nt}__item-mask`,itemMaskIcon:`${Nt}__item-mask--icon`,itemImage:`${Nt}__image`,itemImageResizable:`${Nt}__image--resizable`,itemLabel:`${Nt}__label`,itemFilename:`${Nt}__filename`,itemChevronIcon:`${Nt}__item-chevron-icon`,itemLink:`${Nt}__item-link`,itemLinkOverlay:`${Nt}__item-link-overlay`,itemLinkOverlayIcon:`${Nt}__item-link-overlay-icon`,itemEditIcon:`${Nt}__item-edit-icon`,itemAddIcon:`${Nt}__item-add-icon`,itemAddButton:`${Nt}__item-add-button`,formNode:`${Nt}__form-node`,fileFieldset:`${Nt}__file-fieldset`,fileLabel:`${Nt}__file-label`,fileName:`${Nt}__file-name`,fileInput:`${Nt}__file-input`,metadata:`${Nt}__metadata`,metadataFieldset:`${Nt}__metadata-fieldset`,progressBar:`${Nt}__progress-bar`,esriWidget:"esri-widget",esriButton:ty,buttonDisabled:`${ty}--disabled`,esriButtonSecondary:`${ty}--secondary`,esriButtonTertiary:`${ty}--tertiary`,esriButtonThird:`${ty}--third`,esriButtonSmall:`${ty}--small`,esriButtonHalf:`${ty}--half`,empty:"esri-widget__content--empty",iconExternalLink:"esri-icon-link-external",iconEdit:"esri-icon-edit",iconRight:"esri-icon-right",iconLeft:"esri-icon-left",iconPlus:"esri-icon-plus"},VF=window.CSS;let Qs=class extends di{constructor(e,i){super(e,i),this.displayType="auto",this.messages=null,this.messagesUnits=null,this.selectedFile=null,this.submitting=!1,this.viewModel=null,this.visibleElements={...Zee},this._supportsImageOrientation=VF&&VF.supports&&VF.supports("image-orientation","from-image"),this._addAttachmentForm=null,this._updateAttachmentForm=null}initialize(){this.viewModel||(this.viewModel=new j7),this.addHandles([ui(()=>{var e;return(e=this.viewModel)==null?void 0:e.attachmentInfos},"change",()=>this.scheduleRender()),ui(()=>{var e;return(e=this.viewModel)==null?void 0:e.fileInfos},"change",()=>this.scheduleRender()),J(()=>{var e;return(e=this.viewModel)==null?void 0:e.mode},()=>this._modeChanged(),Le)])}loadDependencies(){return Zd({icon:()=>W(()=>import("./calcite-icon-dc1254b1.js"),["./calcite-icon-dc1254b1.js","./icon-55c3c703.js","./observers-c8819292.js"],import.meta.url)})}get capabilities(){return this.viewModel.capabilities}set capabilities(e){this.viewModel.capabilities=e}get effectiveDisplayType(){const{displayType:e}=this;return e&&e!=="auto"?e:this.viewModel.supportsResizeAttachments?"preview":"list"}get graphic(){return this.viewModel.graphic}set graphic(e){this.viewModel.graphic=e}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}castVisibleElements(e){return{...Zee,...e}}addAttachment(){const{_addAttachmentForm:e,viewModel:i}=this;return this._set("submitting",!0),this._set("error",null),i.addAttachment(e).then(r=>(this._set("submitting",!1),this._set("error",null),i.mode="view",r)).catch(r=>{throw this._set("submitting",!1),this._set("error",new N("attachments:add-attachment",this.messages.addErrorMessage,r)),r})}deleteAttachment(e){const{viewModel:i}=this;return this._set("submitting",!0),this._set("error",null),i.deleteAttachment(e).then(r=>(this._set("submitting",!1),this._set("error",null),i.mode="view",r)).catch(r=>{throw this._set("submitting",!1),this._set("error",new N("attachments:delete-attachment",this.messages.deleteErrorMessage,r)),r})}updateAttachment(){const{viewModel:e}=this,{_updateAttachmentForm:i}=this;return this._set("submitting",!0),this._set("error",null),e.updateAttachment(i).then(r=>(this._set("submitting",!1),this._set("error",null),e.mode="view",r)).catch(r=>{throw this._set("submitting",!1),this._set("error",new N("attachments:update-attachment",this.messages.updateErrorMessage,r)),r})}addFile(){const e=this.viewModel.addFile(this.selectedFile,this._addAttachmentForm);return this.viewModel.mode="view",e}updateFile(){const{viewModel:e}=this,i=e.updateFile(this.selectedFile,this._updateAttachmentForm,e.activeFileInfo);return e.mode="view",i}deleteFile(e){var r;const i=this.viewModel.deleteFile(e||((r=this.viewModel.activeFileInfo)==null?void 0:r.file));return this.viewModel.mode="view",i}render(){const{submitting:e,viewModel:i}=this,{state:r}=i;return M("div",{class:this.classes(_e.base,_e.esriWidget)},e?this.renderProgressBar():null,r==="loading"?this.renderLoading():this.renderAttachments(),this.renderErrorMessage())}renderErrorMessage(){const{error:e,visibleElements:i}=this;return e&&i.errorMessage?M("div",{key:"error-message",class:_e.errorMessage},e.message):null}renderAttachments(){const{activeFileInfo:e,mode:i,activeAttachmentInfo:r}=this.viewModel;return i==="add"?this.renderAddForm():i==="edit"?this.renderDetailsForm(r||e):this.renderAttachmentContainer()}renderLoading(){return M("div",{class:_e.loaderContainer,key:"loader"},M("div",{class:_e.loader}))}renderProgressBar(){return this.visibleElements.progressBar?M("div",{class:_e.progressBar,key:"progress-bar"}):null}renderAddForm(){const{submitting:e,selectedFile:i}=this,r=e||!i,n=this.visibleElements.cancelAddButton?M("button",{type:"button",bind:this,disabled:e,onclick:this._cancelForm,class:this.classes(_e.esriButton,_e.esriButtonTertiary,_e.esriButtonSmall,_e.esriButtonHalf,e&&_e.buttonDisabled)},this.messages.cancel):null,s=this.visibleElements.addSubmitButton?M("button",{type:"submit",disabled:r,class:this.classes(_e.esriButton,_e.esriButtonSecondary,_e.esriButtonSmall,_e.esriButtonHalf,{[_e.buttonDisabled]:r})},this.messages.add):null,o=i?M("span",{key:"file-name",class:_e.fileName},i.name):null,a=M("form",{bind:this,afterCreate:Ed,afterRemoved:TW,"data-node-ref":"_addAttachmentForm",onsubmit:this._submitAddAttachment},M("fieldset",{class:_e.fileFieldset},o,M("label",{class:this.classes(_e.fileLabel,_e.esriButton,_e.esriButtonSecondary)},i?this.messages.changeFile:this.messages.selectFile,M("input",{class:_e.fileInput,type:"file",name:"attachment",bind:this,onchange:this._handleFileInputChange}))),s,n);return M("div",{key:"add-form-container",class:_e.formNode},a)}renderDetailsForm(e){var S,I,T;const{visibleElements:i,viewModel:r,selectedFile:n,submitting:s}=this,{capabilities:o}=r,a=s||!n;let l,c,u,h;n?(l=n.type,c=n.name,u=n.size):e&&"file"in e?(l=e.file.type,c=e.file.name,u=e.file.size):e&&"contentType"in e&&(l=e.contentType,c=e.name,u=e.size,h=e.url);const f=o.editing&&((S=o.operations)!=null&&S.delete)&&i.deleteButton?M("button",{key:"delete-button",type:"button",disabled:s,bind:this,onclick:C=>this._submitDeleteAttachment(C,e),class:this.classes(_e.esriButton,_e.esriButtonSmall,_e.esriButtonTertiary,_e.deleteButton,{[_e.buttonDisabled]:s})},this.messages.delete):void 0,m=o.editing&&((I=o.operations)!=null&&I.update)&&i.updateButton?M("button",{disabled:a,key:"update-button",type:"submit",class:this.classes(_e.esriButton,_e.esriButtonSmall,_e.esriButtonThird,{[_e.buttonDisabled]:a})},this.messages.update):void 0,g=this.visibleElements.cancelUpdateButton?M("button",{disabled:s,key:"cancel-button",type:"button",bind:this,onclick:this._cancelForm,class:this.classes(_e.esriButton,_e.esriButtonSmall,_e.esriButtonTertiary,_e.esriButtonThird,{[_e.buttonDisabled]:s})},this.messages.cancel):void 0,y=o.editing&&((T=o.operations)!=null&&T.update)?M("fieldset",{key:"file",class:_e.fileFieldset},M("span",{key:"file-name",class:_e.fileName},c),M("label",{class:this.classes(_e.fileLabel,_e.esriButton,_e.esriButtonSecondary)},this.messages.changeFile,M("input",{class:_e.fileInput,type:"file",name:"attachment",bind:this,onchange:this._handleFileInputChange}))):void 0,v=M("fieldset",{key:"size",class:_e.metadataFieldset},M("label",null,knt(this.messagesUnits,u??0))),b=M("fieldset",{key:"content-type",class:_e.metadataFieldset},M("label",null,l)),w=h!=null?M("a",{class:_e.itemLink,href:h,rel:"noreferrer",target:"_blank"},this.renderImageMask(e,400),M("div",{class:_e.itemLinkOverlay},M("span",{class:_e.itemLinkOverlayIcon},M("calcite-icon",{icon:"launch"})))):this.renderImageMask(e,400),x=M("form",{bind:this,afterCreate:Ed,afterRemoved:TW,"data-node-ref":"_updateAttachmentForm",onsubmit:C=>this._submitUpdateAttachment(C,e)},M("div",{class:_e.metadata},v,b),y,M("div",{class:_e.actions},f,g,m));return M("div",{key:"edit-form-container",class:_e.formNode},w,x)}renderImageMask(e,i){return e?"file"in e?this.renderGenericImageMask(e.file.name,e.file.type):this.renderImageMaskForAttachment(e,i):null}renderGenericImageMask(e,i){const{supportsResizeAttachments:r}=this.viewModel,n=Sot(i),s={[_e.itemImageResizable]:r};return M("div",{key:n,class:this.classes(_e.itemMaskIcon,_e.itemMask)},M("img",{title:e,alt:e,src:n,class:this.classes(s,_e.itemImage)}))}renderImageMaskForAttachment(e,i){const{supportsResizeAttachments:r}=this.viewModel;if(!e)return null;const{contentType:n,name:s,url:o}=e;if(!r||!Jee(n))return this.renderGenericImageMask(s,n);const a=this._getCSSTransform(e),l=a?{transform:a,"image-orientation":"none"}:{},c=`${o}${o!=null&&o.includes("?")?"&":"?"}w=${i}`,u={[_e.itemImageResizable]:r};return M("div",{key:c,class:this.classes(_e.itemMask)},M("img",{styles:l,alt:s,title:s,src:c,class:this.classes(u,_e.itemImage)}))}renderFile(e){const{file:i}=e;return M("li",{class:_e.item,key:i},M("button",{key:"details-button",bind:this,class:_e.itemButton,title:this.messages.attachmentDetails,"aria-label":this.messages.attachmentDetails,onclick:()=>this._startEditFile(e),type:"button"},this.renderImageMask(e),M("label",{class:_e.itemLabel},M("span",{class:_e.itemFilename},i.name||this.messages.noTitle),M("span",{"aria-hidden":"true",class:this.classes(_e.itemChevronIcon,ll(this.container)?_e.iconLeft:_e.iconRight)}))))}renderAttachmentInfo({attachmentInfo:e,displayType:i}){const{viewModel:r,effectiveDisplayType:n}=this,{capabilities:s,supportsResizeAttachments:o}=r,{contentType:a,name:l,url:c}=e,u=this.renderImageMask(e,i==="list"?48:400),h=s.editing?M("span",{"aria-hidden":"true",class:this.classes(_e.itemChevronIcon,ll(this.container)?_e.iconLeft:_e.iconRight)}):null,f=[u,n==="preview"&&o&&Jee(a)?null:M("label",{class:_e.itemLabel},M("span",{class:_e.itemFilename},l||this.messages.noTitle),h)],m=s.editing?M("button",{key:"details-button",bind:this,class:_e.itemButton,title:this.messages.attachmentDetails,"aria-label":this.messages.attachmentDetails,"data-attachment-info-id":e.id,onclick:()=>this._startEditAttachment(e),type:"button"},f):M("a",{key:"details-link",class:_e.itemButton,href:c??void 0,target:"_blank"},f);return M("li",{class:_e.item,key:e},m)}renderAttachmentContainer(){var g;const{effectiveDisplayType:e,viewModel:i,visibleElements:r}=this,{attachmentInfos:n,capabilities:s,fileInfos:o}=i,a=!!(n!=null&&n.length),l=!!(o!=null&&o.length),c={[_e.containerList]:e!=="preview",[_e.containerPreview]:e==="preview"},u=s.editing&&((g=s.operations)!=null&&g.add)&&r.addButton?M("button",{bind:this,onclick:()=>this._startAddAttachment(),class:this.classes(_e.esriButton,_e.esriButtonTertiary,_e.addAttachmentButton),type:"button"},M("span",{"aria-hidden":"true",class:this.classes(_e.itemAddIcon,_e.iconPlus)}),this.messages.add):void 0,h=a?M("ul",{key:"attachments-list",class:_e.items},n.toArray().map(y=>this.renderAttachmentInfo({attachmentInfo:y,displayType:e}))):void 0,f=l?M("ul",{key:"file-list",class:_e.items},o.toArray().map(y=>this.renderFile(y))):void 0,m=l||a?void 0:M("div",{class:_e.empty},this.messages.noAttachments);return M("div",{key:"attachments-container",class:this.classes(_e.container,c)},h,f,m,u)}_modeChanged(){this._set("error",null),this._set("selectedFile",null)}_handleFileInputChange(e){const i=e.target,r=i&&i.files&&i.files.item(0);this._set("selectedFile",r)}_submitDeleteAttachment(e,i){e.preventDefault(),i&&("file"in i?this.deleteFile(i.file):i&&this.deleteAttachment(i))}_submitAddAttachment(e){e.preventDefault(),this.viewModel.filesEnabled?this.addFile():this.addAttachment()}_submitUpdateAttachment(e,i){e.preventDefault(),i&&"file"in i?this.updateFile():this.updateAttachment()}_startEditAttachment(e){const{viewModel:i}=this;i.activeFileInfo=null,i.activeAttachmentInfo=e,i.mode="edit"}_startEditFile(e){const{viewModel:i}=this;i.activeAttachmentInfo=null,i.activeFileInfo=e,i.mode="edit"}_startAddAttachment(){this.viewModel.mode="add"}_cancelForm(e){e.preventDefault(),this.viewModel.mode="view"}_getCSSTransform(e){const{orientationInfo:i}=e;return!this._supportsImageOrientation&&i?[i.rotation?`rotate(${i.rotation}deg)`:"",i.mirrored?"scaleX(-1)":""].join(" "):""}};d([p()],Qs.prototype,"capabilities",null),d([p()],Qs.prototype,"displayType",void 0),d([p({readOnly:!0})],Qs.prototype,"effectiveDisplayType",null),d([p()],Qs.prototype,"graphic",null),d([p()],Qs.prototype,"label",null),d([p(),ut("esri/widgets/Attachments/t9n/Attachments")],Qs.prototype,"messages",void 0),d([p(),ut("esri/core/t9n/Units")],Qs.prototype,"messagesUnits",void 0),d([p({readOnly:!0})],Qs.prototype,"selectedFile",void 0),d([p({readOnly:!0})],Qs.prototype,"submitting",void 0),d([p({readOnly:!0})],Qs.prototype,"error",void 0),d([p({type:j7})],Qs.prototype,"viewModel",void 0),d([p()],Qs.prototype,"visibleElements",void 0),d([tt("visibleElements")],Qs.prototype,"castVisibleElements",null),Qs=d([A("esri.widgets.Attachments")],Qs);const Iot=Qs,Ul="esri-feature-form",lf=`${Ul}__group`,$c=`${Ul}__input`,Yee=`${Ul}__related-records`,pt={base:Ul,form:`${Ul}__form`,formHeader:`${Ul}__form-header`,label:`${Ul}__label`,relationshipLabel:`${Ul}__relationship-label`,fieldInputWrapper:`${$c}-wrapper`,fieldInputLoader:`${$c}-loader`,fieldInput:`${$c}`,inputDate:`${$c}--date`,inputTime:`${$c}--time`,inputRadioGroup:`${$c}--radio-group`,inputRadio:`${$c}--radio`,inputRadioLabel:`${$c}--radio-label`,inputDisabled:`${$c}--disabled`,inputSwitch:`${$c}--switch`,inputInvalid:`${$c}--invalid`,centeredButton:`${Ul}__centered-button`,description:`${Ul}__description-text`,listObserver:`${Ul}__list-observer`,relatedRecordsHeader:`${Yee}_header`,relatedRecordsList:`${Yee}_list`,dateInputContainer:`${`${Ul}__date`}-input-container`,group:lf,groupLabel:`${lf}-label`,groupHeader:`${lf}-header`,groupTitle:`${lf}-title`,groupToggleIcon:`${lf}-toggle-icon`,groupCollapsed:`${lf}--collapsed`,groupSequential:`${lf}--sequential`,groupActive:`${lf}--active`,collapseIcon:"esri-icon-up",expandIcon:"esri-icon-down",widget:"esri-widget",panel:"esri-widget--panel",input:"esri-input"};let m0=class extends te{constructor(e){super(e),this.description=null,this.label=null,this.type=null,this.visibilityExpression=null}};d([p({type:String,json:{write:!0}})],m0.prototype,"description",void 0),d([p({type:String,json:{write:!0}})],m0.prototype,"label",void 0),d([p()],m0.prototype,"type",void 0),d([p({type:String,json:{write:!0}})],m0.prototype,"visibilityExpression",void 0),m0=d([A("esri.form.elements.Element")],m0);const M1=m0;var B8;let XA=B8=class extends te{constructor(t){super(t),this.type=null}clone(){return new B8({type:this.type})}};d([p({type:["attachment","audio","document","image","signature","video"],json:{write:!0}})],XA.prototype,"type",void 0),XA=B8=d([A("esri.form.elements.inputs.AttachmentInput")],XA);const Tot=XA;var U8;let g0=U8=class extends M1{constructor(t){super(t),this.attachmentKeyword=null,this.editable=!0,this.input=null,this.type="attachment"}clone(){return new U8({attachmentKeyword:this.attachmentKeyword,description:this.description,editable:this.editable,input:this.input,label:this.label,visibilityExpression:this.visibilityExpression})}};d([p({type:String,json:{write:!0}})],g0.prototype,"attachmentKeyword",void 0),d([p({type:Boolean,json:{write:!0}})],g0.prototype,"editable",void 0),d([p({type:Tot,json:{read:{source:"inputType"},write:{target:"inputType"}}})],g0.prototype,"input",void 0),d([p({type:["attachment"],json:{read:!1,write:!0}})],g0.prototype,"type",void 0),g0=U8=d([A("esri.form.elements.AttachmentElement")],g0);const Kee=g0;let QA=class extends te{constructor(e){super(e),this.type=null}};d([p()],QA.prototype,"type",void 0),QA=d([A("esri.form.elements.inputs.Input")],QA);const cx=QA;let M2=class extends cx{constructor(e){super(e),this.maxLength=null,this.minLength=0}};d([p({type:Number,json:{write:!0}})],M2.prototype,"maxLength",void 0),d([p({type:Number,json:{write:!0}})],M2.prototype,"minLength",void 0),M2=d([A("esri.form.elements.inputs.TextInput")],M2);const B7=M2;var G8;let ek=G8=class extends B7{constructor(t){super(t),this.type="barcode-scanner"}clone(){return new G8({maxLength:this.maxLength,minLength:this.minLength})}};d([p({type:["barcode-scanner"],json:{read:!1,write:!0}})],ek.prototype,"type",void 0),ek=G8=d([A("esri.form.elements.inputs.BarcodeScannerInput")],ek);const Cot=ek;var H8;let Jb=H8=class extends cx{constructor(t){super(t),this.noValueOptionLabel=null,this.showNoValueOption=!0,this.type="combo-box"}clone(){return new H8({showNoValueOption:this.showNoValueOption,noValueOptionLabel:this.noValueOptionLabel})}};d([p({type:String,json:{write:!0}})],Jb.prototype,"noValueOptionLabel",void 0),d([p({type:Boolean,json:{write:!0}})],Jb.prototype,"showNoValueOption",void 0),d([p({type:["combo-box"],json:{read:!1,write:!0}})],Jb.prototype,"type",void 0),Jb=H8=d([A("esri.form.elements.inputs.ComboBoxInput")],Jb);const Eot=Jb;var q8;function Xee(t){return t!=null?new Date(t):null}function Qee(t){return t?t.getTime():null}let Yc=q8=class extends cx{constructor(t){super(t),this.includeTime=!1,this.max=null,this.min=null,this.type="datetime-picker"}readMax(t,e){return Xee(e.max)}writeMax(t,e){e.max=Qee(t)}readMin(t,e){return Xee(e.min)}writeMin(t,e){e.min=Qee(t)}clone(){return new q8({includeTime:this.includeTime,max:this.max,min:this.min})}};d([p({type:Boolean,json:{write:!0}})],Yc.prototype,"includeTime",void 0),d([p({type:Date,json:{type:Number,write:!0}})],Yc.prototype,"max",void 0),d([ae("max")],Yc.prototype,"readMax",null),d([ge("max")],Yc.prototype,"writeMax",null),d([p({type:Date,json:{type:Number,write:!0}})],Yc.prototype,"min",void 0),d([ae("min")],Yc.prototype,"readMin",null),d([ge("min")],Yc.prototype,"writeMin",null),d([p({type:["datetime-picker"],json:{read:!1,write:!0}})],Yc.prototype,"type",void 0),Yc=q8=d([A("esri.form.elements.inputs.DateTimePickerInput")],Yc);const Mot=Yc;var W8;let Zb=W8=class extends cx{constructor(t){super(t),this.noValueOptionLabel=null,this.showNoValueOption=!0,this.type="radio-buttons"}clone(){return new W8({noValueOptionLabel:this.noValueOptionLabel,showNoValueOption:this.showNoValueOption})}};d([p({type:String,json:{write:!0}})],Zb.prototype,"noValueOptionLabel",void 0),d([p({type:Boolean,json:{write:!0}})],Zb.prototype,"showNoValueOption",void 0),d([p({type:["radio-buttons"],json:{read:!1,write:!0}})],Zb.prototype,"type",void 0),Zb=W8=d([A("esri.form.elements.inputs.RadioButtonsInput")],Zb);const $ot=Zb;var J8;let Yb=J8=class extends cx{constructor(t){super(t),this.offValue=null,this.onValue=null,this.type="switch"}clone(){return new J8({offValue:this.offValue,onValue:this.onValue})}};d([p({type:[String,Number],json:{write:!0}})],Yb.prototype,"offValue",void 0),d([p({type:[String,Number],json:{write:!0}})],Yb.prototype,"onValue",void 0),d([p({type:["switch"],json:{read:!1,write:!0}})],Yb.prototype,"type",void 0),Yb=J8=d([A("esri.form.elements.inputs.SwitchInput")],Yb);const Aot=Yb;var Z8;let tk=Z8=class extends B7{constructor(t){super(t),this.type="text-area"}clone(){return new Z8({maxLength:this.maxLength,minLength:this.minLength})}};d([p({type:["text-area"],json:{read:!1,write:!0}})],tk.prototype,"type",void 0),tk=Z8=d([A("esri.form.elements.inputs.TextAreaInput")],tk);const kot=tk;var Y8;let ik=Y8=class extends B7{constructor(t){super(t),this.type="text-box"}clone(){return new Y8({maxLength:this.maxLength,minLength:this.minLength})}};d([p({type:["text-box"],json:{read:!1,write:!0}})],ik.prototype,"type",void 0),ik=Y8=d([A("esri.form.elements.inputs.TextBoxInput")],ik);const Pot=ik,Oot={base:cx,key:"type",typeMap:{"barcode-scanner":Cot,"combo-box":Eot,"datetime-picker":Mot,"radio-buttons":$ot,switch:Aot,"text-area":kot,"text-box":Pot}};var K8;const O_e="esri.form.elements.FieldElement",ete=ie.getLogger(O_e);let Fl=K8=class extends M1{constructor(t){super(t),this.domain=null,this.editableExpression=null,this.fieldName=null,this.hint=null,this.input=null,this.requiredExpression=null,this.type="field",this.valueExpression=null}get editable(){return el(ete,"editable",{replacement:"editableExpression",version:"4.26",warnOnce:!0}),this._get("editable")??!0}set editable(t){el(ete,"editable",{replacement:"editableExpression",version:"4.26",warnOnce:!0}),this._set("editable",t)}clone(){return new K8({description:this.description,domain:this.domain,editable:this.editable,editableExpression:this.editableExpression,fieldName:this.fieldName,hint:this.hint,input:this.input,label:this.label,requiredExpression:this.requiredExpression,valueExpression:this.valueExpression,visibilityExpression:this.visibilityExpression})}};d([p({types:Lhe,json:{read:{reader:VL},write:!0}})],Fl.prototype,"domain",void 0),d([p({type:Boolean,json:{write:!0}})],Fl.prototype,"editable",null),d([p({type:String,json:{write:!0}})],Fl.prototype,"editableExpression",void 0),d([p({type:String,json:{write:!0}})],Fl.prototype,"fieldName",void 0),d([p({type:String,json:{write:!0}})],Fl.prototype,"hint",void 0),d([p({types:Oot,json:{read:{source:"inputType"},write:{target:"inputType"}}})],Fl.prototype,"input",void 0),d([p({type:String,json:{write:!0}})],Fl.prototype,"requiredExpression",void 0),d([p({type:String,json:{read:!1,write:!0}})],Fl.prototype,"type",void 0),d([p({type:String,json:{write:!0}})],Fl.prototype,"valueExpression",void 0),Fl=K8=d([A(O_e)],Fl);const tte=Fl;var X8;let Ph=X8=class extends M1{constructor(t){super(t),this.displayCount=null,this.displayType="list",this.editableExpression=null,this.orderByFields=null,this.relationshipId=null,this.type="relationship"}clone(){return new X8({description:this.description,displayCount:this.displayCount,displayType:this.displayType,editableExpression:this.editableExpression,label:this.label,orderByFields:U(this.orderByFields),relationshipId:this.relationshipId,visibilityExpression:this.visibilityExpression})}};d([p({type:Number,json:{write:!0}})],Ph.prototype,"displayCount",void 0),d([p({type:["list"],json:{write:!0}})],Ph.prototype,"displayType",void 0),d([p({type:String,json:{write:!0}})],Ph.prototype,"editableExpression",void 0),d([p({type:[uU],json:{write:!0}})],Ph.prototype,"orderByFields",void 0),d([p({type:Number,json:{write:!0}})],Ph.prototype,"relationshipId",void 0),d([p({type:["relationship"],json:{read:!1,write:!0}})],Ph.prototype,"type",void 0),Ph=X8=d([A("esri.form.elements.RelationshipElement")],Ph);const ite=Ph;function L_e(t){return{typesWithGroup:{base:M1,key:"type",typeMap:{attachment:Kee,field:tte,group:t,relationship:ite}},typesWithoutGroup:{base:M1,key:"type",typeMap:{attachment:Kee,field:tte,relationship:ite}}}}function R_e(t,e,i=!0){if(!t)return null;const r=i?e.typesWithGroup.typeMap:e.typesWithoutGroup.typeMap;return t.filter(n=>r[n.type]).map(n=>r[n.type].fromJSON(n))}function F_e(t,e,i=!0){if(!t)return null;const r=i?e.typesWithGroup.typeMap:e.typesWithoutGroup.typeMap;return t.filter(n=>r[n.type]).map(n=>n.toJSON())}function D_e(t,e,i=!0){return t?t.map(r=>Dd(i?e.typesWithGroup:e.typesWithoutGroup,r)):null}var Q8;let pd=Q8=class extends M1{constructor(t){super(t),this.elements=null,this.initialState="expanded",this.type="group"}castElements(t){return D_e(t,zF,!1)}readElements(t,e){return R_e(e.formElements,zF,!1)}writeElements(t,e){e.formElements=F_e(t,zF,!1)}clone(){return new Q8({description:this.description,elements:U(this.elements),initialState:this.initialState,label:this.label,visibilityExpression:this.visibilityExpression})}};d([p({json:{write:!0}})],pd.prototype,"elements",void 0),d([tt("elements")],pd.prototype,"castElements",null),d([ae("elements",["formElements"])],pd.prototype,"readElements",null),d([ge("elements")],pd.prototype,"writeElements",null),d([p({type:["collapsed","expanded"],json:{write:!0}})],pd.prototype,"initialState",void 0),d([p({type:String,json:{read:!1,write:!0}})],pd.prototype,"type",void 0),pd=Q8=d([A("esri.form.elements.GroupElement")],pd);const zF=L_e(pd),Lot=pd;var e6;const jF=L_e(Lot);let Kc=e6=class extends te{constructor(t){super(t),this.description=null,this.elements=null,this.expressionInfos=null,this.preserveFieldValuesWhenHidden=!1,this.title=null}castElements(t){return D_e(t,jF)}readElements(t,e){return R_e(e.formElements,jF)}writeElements(t,e){e.formElements=F_e(t,jF)}clone(){return new e6({description:this.description,expressionInfos:U(this.expressionInfos),elements:U(this.elements),title:this.title,preserveFieldValuesWhenHidden:this.preserveFieldValuesWhenHidden})}};d([p({type:String,json:{write:!0}})],Kc.prototype,"description",void 0),d([p({json:{write:!0}})],Kc.prototype,"elements",void 0),d([tt("elements")],Kc.prototype,"castElements",null),d([ae("elements",["formElements"])],Kc.prototype,"readElements",null),d([ge("elements")],Kc.prototype,"writeElements",null),d([p({type:[Uge],json:{write:!0}})],Kc.prototype,"expressionInfos",void 0),d([p({type:Boolean,json:{default:!1,write:!0}})],Kc.prototype,"preserveFieldValuesWhenHidden",void 0),d([p({type:String,json:{write:!0}})],Kc.prototype,"title",void 0),Kc=e6=d([A("esri.form.FormTemplate")],Kc);const N_e=Kc;let y0=class extends he{constructor(e){super(e),this.maxValue=null,this.minValue=null,this.codedValue=null}};d([p()],y0.prototype,"objectType",void 0),d([p()],y0.prototype,"maxValue",void 0),d([p()],y0.prototype,"minValue",void 0),d([p()],y0.prototype,"codedValue",void 0),y0=d([A("esri.layers.support.ContingentValue")],y0);const ls=y0;let v0=class extends he{constructor(e){super(e),this.isRetired=!1}};d([p()],v0.prototype,"id",void 0),d([p()],v0.prototype,"isRetired",void 0),d([p()],v0.prototype,"subtype",void 0),d([p()],v0.prototype,"values",void 0),v0=d([A("esri.layers.support.Contingency")],v0);const rte=v0;let $2=class extends he{constructor(e){super(e)}};d([p()],$2.prototype,"fieldGroup",void 0),d([p()],$2.prototype,"type",void 0),$2=d([A("esri.layers.support.ContingencyConstraintViolation")],$2);const nte=$2;let A2=class extends he{constructor(e){super(e)}};d([p()],A2.prototype,"contingentValuesAllGroups",void 0),d([p()],A2.prototype,"contingentValuesByFieldGroup",void 0),A2=d([A("esri.layers.support.ContingentValuesResult")],A2);const Rot=A2;let _0=class extends he{constructor(e){super(e),this.fields=null,this.isEditingRestrictive=!1}};d([p()],_0.prototype,"name",void 0),d([p()],_0.prototype,"fields",void 0),d([p()],_0.prototype,"isEditingRestrictive",void 0),d([p()],_0.prototype,"contingencies",void 0),_0=d([A("esri.layers.support.FieldGroup")],_0);const t6=_0;let Oh=class extends te{constructor(){super(...arguments),this.code=null,this.defaultValues={},this.domains=null,this.name=null}readDomains(e){if(!e)return null;const i={};for(const r of Object.keys(e))i[r]=VL(e[r]);return i}writeDomains(e,i){var n;if(!e)return;const r={};for(const s of Object.keys(e))e[s]&&(r[s]=(n=e[s])==null?void 0:n.toJSON());i.domains=r}};d([p({type:Number,json:{write:!0}})],Oh.prototype,"code",void 0),d([p({type:Object,json:{write:!0}})],Oh.prototype,"defaultValues",void 0),d([p({json:{write:!0}})],Oh.prototype,"domains",void 0),d([ae("domains")],Oh.prototype,"readDomains",null),d([ge("domains")],Oh.prototype,"writeDomains",null),d([p({type:String,json:{write:!0}})],Oh.prototype,"name",void 0),Oh=d([A("esri.layers.support.Subtype")],Oh);const ste=Oh;var tm;let im=tm=class extends R1(Su){constructor(t){super(t),this.request=at,this.fieldGroups=null,this.fieldGroupDefinitions=null}initialize(){}get subtypeFieldName(){const{layer:t}=this;return t.type==="subtype-group"?t.subtypeField:t.typeIdField}static async createLoadedLayerContingentValuesCache(t){await t.load();const e=t.sourceJSON;if(t.layerId===void 0)return null;const i=e.hasContingentValuesDefinition;if(i)return new tm({layer:t}).load();if(i===void 0){const r=op(t.url);if(r==null)return null;const n=r.url.path;if((await tm._staticFetchEnterpriseFeatureRoot(n)).supportsQueryDataElements){const s=t.layerId.toString(),o=await tm._staticFetchEnterpriseFieldGroup(n,s);if(o){const a=o.map(l=>({name:l.name,isEditingRestrictive:l.isEditingRestrictive,fields:l.fieldNames.names}));return new tm({layer:t,fieldGroupDefinitions:a}).load()}}}return null}async load(t){const e=this.layer.load(t).then(()=>this._initializeContingentValues(this.fieldGroupDefinitions,t));return this.addResolvingPromise(e),this}validateContingencyConstraints(t,e){const i=Object.keys(t),r=[],n=[];for(const s of this.fieldGroups){const o=s.isEditingRestrictive?"error":"warning";if(e&&!s.fields.some(u=>e.includes(u)))continue;if(!s.fields.every(u=>i.includes(u))){n.push(new nte({fieldGroup:s,type:o}));continue}let a=!1;const l=t[this.subtypeFieldName],c=s.contingencies.filter(u=>!(!u.isRetired&&u.subtype)||u.subtype.code===l);for(const u of c){let h=!0;for(const f in u.values){const m=u.values[f];if(m.objectType!=="any"){if(m.objectType==="null"){if(t[f]!=null){h=!1;break}}else if(m.objectType==="code"){if(t[f]!==m.codedValue.code){h=!1;break}}else if(m.objectType==="range"){const g=t[f];if(g<m.minValue||g>m.maxValue){h=!1;break}}}}if(h){a=!0;break}}a||r.push(new nte({fieldGroup:s,type:o}))}return{invalid:r,incomplete:n}}getContingentValues(t,e,i=!1){const r=t[this.subtypeFieldName],n=r!=null,s={};let o=[];const a=this.fieldGroups.filter(l=>l.fields.includes(e));o.push(new ls({objectType:"any"}));for(const l of a){let c=[];const u=l.contingencies.filter(m=>!(m.isRetired||m.subtype&&n&&m.subtype.code!==r));let h=!1;const f={};for(const m of u){let g,y=!0;for(const v in m.values){const b=m.values[v];if(e!==v){if(t[v]!==void 0&&b.objectType!=="any"){if(b.objectType==="null")t[v]!==null&&(y=!1);else if(b.objectType==="code")t[v]!==b.codedValue.code&&(y=!1);else if(b.objectType==="range"){const w=t[v];(w<b.minValue||w>b.maxValue)&&(y=!1)}}}else g=b,h=h||b.objectType==="range"}if(g&&y){if(g.objectType==="any"){c.length=0,c.push(g);break}const v=this._generateKey(g);f[v]||c.push(g),f[v]=!0}}h&&(c=this._joinRange(c)),s[l.name]=c,o=i?this._filterIntersection(o,c):[]}return a.length===1&&i&&(o=[]),new Rot({contingentValuesAllGroups:o,contingentValuesByFieldGroup:s})}_generateKey(t){switch(t.objectType){case"any":return"@any@";case"null":return"@null@";case"code":return t.codedValue.name+t.codedValue.code.toString();case"range":return t.minValue.toString()+"-"+t.maxValue.toString()}}_joinRange(t){let e,i;t.sort((n,s)=>n.objectType==="null"?-1:s.objectType==="null"?1:n.minValue-s.minValue);const r=[];for(const n of t)n.objectType!=="null"?e!=null&&i!=null?i<n.minValue?(r.push(new ls({objectType:"range",minValue:e,maxValue:i})),e=n.minValue,i=n.maxValue):i<n.maxValue&&(i=n.maxValue):(e=n.minValue,i=n.maxValue):r.push(n);return r.push(new ls({objectType:"range",minValue:e,maxValue:i})),r}_filterIntersection(t,e){var n,s;if(t.length===0||e.length===0)return[];if(t[0].objectType==="any")return e;if(e[0].objectType==="any")return t;const i=t[0].objectType==="range"||((n=t[1])==null?void 0:n.objectType)==="range",r=e[0].objectType==="range"||((s=e[1])==null?void 0:s.objectType)==="range";return i||r?this._intersectRanges(t,e):this._intersectValues(t,e)}_intersectRanges(t,e){const i=[];let r,n=0;for(const s of t)for(;n<e.length;n++){const o=e[n];if(s.objectType==="null"&&o.objectType==="null")i.push(new ls({objectType:"null"}));else{if(s.objectType==="null")break;if(o.objectType==="null")continue}if(s.maxValue<o.minValue)break;if(s.maxValue===o.minValue){i.push(new ls({objectType:"range",minValue:s.maxValue,maxValue:o.minValue}));break}if(!(s.minValue>o.maxValue))if(s.minValue!==o.maxValue){if(r=s.minValue>o.minValue?s.minValue:o.minValue,s.maxValue<o.maxValue){i.push(new ls({objectType:"range",minValue:r,maxValue:s.maxValue}));break}i.push(new ls({objectType:"range",minValue:r,maxValue:o.maxValue}))}else i.push(new ls({objectType:"range",minValue:s.minValue,maxValue:o.maxValue}))}return i}_intersectValues(t,e){const i=[];for(const r of t)e.some(n=>{if(r.objectType===n.objectType)switch(r.objectType){case"any":case"null":return!0;case"code":return r.codedValue.code===n.codedValue.code&&r.codedValue.name===n.codedValue.name}return!1})&&i.push(r);return i}static async _staticFetchEnterpriseFeatureRoot(t,e){return at(t,{responseType:"json",query:{f:"json"},...e}).then(i=>i.data)}static async _staticFetchEnterpriseFieldGroup(t,e,i){return at(`${t}/queryDataElements`,{responseType:"json",query:{layers:JSON.stringify([e]),f:"json"},...i}).then(r=>{var n;return(n=r.data.layerDataElements)==null?void 0:n[0].dataElement.fieldGroups})}async _initializeContingentValues(t,e){const i=t??await this._fetchFieldGroupDefs(e);if(i.length===0)return void(this.fieldGroups=[]);const r=await this._fetchContingentValues(i,e);this.fieldGroups=r}async _fetchFieldGroupDefs(t){if(this.layer.layerId===void 0)return[];const e=this.layer.sourceJSON,i=this.layer.layerId.toString(),r=op(this.layer.url).url.path;return e.hasContingentValuesDefinition?(await this._fetchAGOLFieldGroup(r,i,t)).map(n=>({name:n.name,isEditingRestrictive:n.restrictive,fields:n.fields.map(s=>this.layer.fieldsIndex.normalizeFieldName(s))})):e.hasContingentValuesDefinition!==void 0?[]:this._fetchEnterpriseFeatureRoot(r,t).then(async n=>n.supportsQueryDataElements?(await this._fetchEnterpriseFieldGroup(r,i,t)).map(s=>({name:s.name,isEditingRestrictive:s.isEditingRestrictive,fields:s.fieldNames.names.map(o=>this.layer.fieldsIndex.normalizeFieldName(o))})):[])}async _fetchAGOLFieldGroup(t,e,i){return at(`${t}/${e}/fieldgroups`,{responseType:"json",query:{f:"json"},...i}).then(r=>r.data.fieldGroups)}async _fetchEnterpriseFieldGroup(t,e,i){return tm._staticFetchEnterpriseFieldGroup(t,e,i)}async _fetchEnterpriseFeatureRoot(t,e){return tm._staticFetchEnterpriseFeatureRoot(t,e)}async _fetchContingentValues(t,e){if(this.layer.layerId===void 0)return[];const i=this.layer.sourceJSON,r=this.layer.layerId.toString(),n=op(this.layer.url).url.path;if(i.hasContingentValuesDefinition){const o=await this._fetchAGOLContingentValues(n,r,e);return this._constructFieldGroupsAGOL(t,o)}const s=await this._fetchEnterpriseContingentValues(n,r,e);return this._constructFieldGroupsEnterprise(t,s)}_constructFieldGroupsAGOL(t,e){return t.map(i=>{const r=e.contingentValuesDefinition.fieldGroups.find(n=>n.name===i.name);if(r){let n=[];return n=e.contingentValuesDefinition.hasSubType?this._parseAGOLFieldGroupSubtype(i,e,r.subTypes):this._parseAGOLFieldGroup(i,e,r.contingentValues),new t6({name:i.name,isEditingRestrictive:i.isEditingRestrictive,fields:i.fields,contingencies:n})}return null}).filter(Dt)}_parseAGOLFieldGroupSubtype(t,e,i){let r=[];return i==null||i.forEach(n=>{const s=this._getSubtypeAGOL(n.name);r=r.concat(this._parseAGOLFieldGroup(t,e,n.contingentValues,s))}),r}_parseAGOLFieldGroup(t,e,i,r=null){const n=[];for(const s of i??[]){const o=this._parseAGOLContingency(s,t,e,r);n.push(o)}return n}_parseAGOLContingency(t,e,i,r){const n=t.id,s=!!t.retired&&t.retired===1,o={};for(let a=0,l=0;a<e.fields.length;a++){const c=e.fields[a],u=i.typeCodes[t.types[a]];if(u==="Code"){let h=t.values[l];l++;const f=this._getDomain(r,c),m=this.layer.getField(c);if((m==null?void 0:m.type)==="string"){const v=i.stringDicts.find(b=>b.domain===f.name);v&&(h=v.entries[h])}const g=f.codedValues.find(v=>v.code===h),y=new ls({codedValue:g,objectType:"code"});o[c]=y}else if(u==="Range"){const h=t.values[l];l++;const f=h.range[0],m=h.range[1],g=new ls({minValue:f,maxValue:m,objectType:"range"});o[c]=g}else if(u==="Any"){const h=new ls({objectType:"any"});o[c]=h}else{const h=new ls({objectType:"null"});o[c]=h}}return new rte({id:n,isRetired:s,subtype:r,values:o})}_constructFieldGroupsEnterprise(t,e){const i=e.fieldGroups;return t.map(r=>{const n=i.find(s=>s.name===r.name);if(n){const s=n.contingencies.map(o=>{const a=o.id,l=o.isRetired||!1,c=this._getSubtypeEnterprise(o.subtypeCode),u={};for(let h=0;h<r.fields.length;h++){const f=r.fields[h];let m=o.values[h];if(typeof m=="number"||typeof m=="string"){const g=this._getDomain(c,f),y=this.layer.getField(f);(y==null?void 0:y.type)==="string"?m=e.stringDictionary[m]:(y==null?void 0:y.type)==="date"&&(m=new Date(`${m}+00:00`).getTime());const v=g.codedValues.find(w=>w.code===m),b=new ls({codedValue:v,objectType:"code"});u[f]=b}else if(typeof m=="object"){const g=m.minValue,y=m.maxValue,v=new ls({minValue:g,maxValue:y,objectType:"range"});u[f]=v}else if(m){const g=new ls({objectType:"any"});u[f]=g}else{const g=new ls({objectType:"null"});u[f]=g}}return new rte({id:a,isRetired:l,subtype:c,values:u})});return new t6({name:r.name,isEditingRestrictive:r.isEditingRestrictive,fields:r.fields,contingencies:s})}return null}).filter(Dt)}async _fetchEnterpriseContingentValues(t,e,i){return at(`${t}/queryContingentValues`,{responseType:"json",query:{layers:JSON.stringify([e]),f:"json"},...i}).then(r=>{var n;return(n=r.data.contingentValueSets)==null?void 0:n[0]})}async _fetchAGOLContingentValues(t,e,i){return at(`${t}/${e}/contingentValues`,{responseType:"json",query:{f:"json"},...i}).then(r=>r.data)}_getSubtypeEnterprise(t){const e=this.layer.sourceJSON;let i;if(e.subtypes){const r=e.subtypes.find(n=>n.code===t);i=ste.fromJSON(r)}return i||null}_getSubtypeAGOL(t){const e=this.layer.sourceJSON;let i;if(e.subtypes){const r=e.subtypes.find(n=>n.name===t);i=ste.fromJSON(r)}return i||null}_getDomain(t,e){var r;const i=t?(r=t.domains)==null?void 0:r[e]:this.layer.getFieldDomain(e);return(i==null?void 0:i.type)==="inherited"?this.layer.getFieldDomain(e):i}};d([p({constructOnly:!0})],im.prototype,"layer",void 0),d([p({constructOnly:!0})],im.prototype,"request",void 0),d([p({type:[t6]})],im.prototype,"fieldGroups",void 0),d([p({constructOnly:!0})],im.prototype,"fieldGroupDefinitions",void 0),d([p()],im.prototype,"subtypeFieldName",null),im=tm=d([A("esri.layers.support.LayerContingentValuesCache")],im);const Fot=im;var yt;(function(t){t.AsyncNotEnabled="AsyncNotEnabled",t.ModulesNotSupported="ModulesNotSupported",t.CircularModules="CircularModules",t.NeverReach="NeverReach",t.UnsupportedHashType="UnsupportedHashType",t.InvalidParameter="InvalidParameter",t.UnexpectedToken="UnexpectedToken",t.Unrecognised="Unrecognised",t.UnrecognisedType="UnrecognisedType",t.MaximumCallDepth="MaximumCallDepth",t.BooleanConditionRequired="BooleanConditionRequired",t.TypeNotAllowedInFeature="TypeNotAllowedInFeature",t.KeyMustBeString="KeyMustBeString",t.WrongNumberOfParameters="WrongNumberOfParameters",t.CallNonFunction="CallNonFunction",t.NoFunctionInTemplateLiteral="NoFunctionInTemplateLiteral",t.NoFunctionInDictionary="NoFunctionInDictionary",t.NoFunctionInArray="NoFunctionInArray",t.AssignModuleFunction="AssignModuleFunction",t.LogicExpressionOrAnd="LogicExpressionOrAnd",t.LogicalExpressionOnlyBoolean="LogicalExpressionOnlyBoolean",t.FunctionNotFound="FunctionNotFound",t.InvalidMemberAccessKey="InvalidMemberAccessKey",t.UnsupportedUnaryOperator="UnsupportUnaryOperator",t.InvalidIdentifier="InvalidIdentifier",t.MemberOfNull="MemberOfNull",t.UnsupportedOperator="UnsupportedOperator",t.Cancelled="Cancelled",t.ModuleAccessorMustBeString="ModuleAccessorMustBeString",t.ModuleExportNotFound="ModuleExportNotFound",t.Immutable="Immutable",t.OutOfBounds="OutOfBounds",t.IllegalResult="IllegalResult",t.FieldNotFound="FieldNotFound",t.PortalRequired="PortalRequired",t.LogicError="LogicError",t.ArrayAccessorMustBeNumber="ArrayAccessMustBeNumber",t.KeyAccessorMustBeString="KeyAccessorMustBeString",t.WrongSpatialReference="WrongSpatialReference"})(yt||(yt={}));const V_e={[yt.TypeNotAllowedInFeature]:"Feature attributes only support dates, numbers, strings, guids.",[yt.LogicError]:"Logic error - {reason}",[yt.NeverReach]:"Encountered unreachable logic",[yt.AsyncNotEnabled]:"Async Arcade must be enabled for this script",[yt.ModuleAccessorMustBeString]:"Module accessor must be a string",[yt.ModuleExportNotFound]:"Module has no export with provided identifier",[yt.ModulesNotSupported]:"Current profile does not support modules",[yt.ArrayAccessorMustBeNumber]:"Array accessor must be a number",[yt.FunctionNotFound]:"Function not found",[yt.FieldNotFound]:"Key not found - {key}",[yt.CircularModules]:"Circular module dependencies are not allowed",[yt.Cancelled]:"Execution cancelled",[yt.UnsupportedHashType]:"Type not supported in hash function",[yt.IllegalResult]:"Value is not a supported return type",[yt.PortalRequired]:"Portal is required",[yt.InvalidParameter]:"Invalid parameter",[yt.WrongNumberOfParameters]:"Call with wrong number of parameters",[yt.Unrecognised]:"Unrecognised code structure",[yt.UnrecognisedType]:"Unrecognised type",[yt.WrongSpatialReference]:"Cannot work with geometry in this spatial reference. It is different to the execution spatial reference",[yt.BooleanConditionRequired]:"Conditions must use booleans",[yt.NoFunctionInDictionary]:"Dictionaries cannot contain functions.",[yt.NoFunctionInArray]:"Arrays cannot contain functions.",[yt.NoFunctionInTemplateLiteral]:"Template Literals do not expect functions by value.",[yt.KeyAccessorMustBeString]:"Accessor must be a string",[yt.KeyMustBeString]:"Object keys must be a string",[yt.Immutable]:"Object is immutable",[yt.UnexpectedToken]:"Unexpected token",[yt.MemberOfNull]:"Cannot access property of null object",[yt.MaximumCallDepth]:"Exceeded maximum function depth",[yt.OutOfBounds]:"Out of bounds",[yt.InvalidIdentifier]:"Identifier not recognised",[yt.CallNonFunction]:"Expression is not a function",[yt.InvalidMemberAccessKey]:"Cannot access value using a key of this type",[yt.AssignModuleFunction]:"Cannot assign function to module variable",[yt.UnsupportedUnaryOperator]:"Unsupported unary operator",[yt.UnsupportedOperator]:"Unsupported operator",[yt.LogicalExpressionOnlyBoolean]:"Logical expressions must be boolean",[yt.LogicExpressionOrAnd]:"Logical expression can only be combined with || or &&"};let Dot=class extends Error{constructor(...e){super(...e)}},ote=class z_e extends Dot{constructor(e,i){super(U7(i)+e.message,{cause:e}),this.loc=null,Error.captureStackTrace&&Error.captureStackTrace(this,z_e),i&&i.loc&&(this.loc=i.loc)}},gTt=class j_e extends Error{constructor(e,i,r,n){super("Execution error - "+U7(r)+OR(V_e[i],n)),this.loc=null,this.declaredRootClass="esri.arcade.arcadeexecutionerror",Error.captureStackTrace&&Error.captureStackTrace(this,j_e),r&&r.loc&&(this.loc=r.loc)}};function U7(t){var e,i;return t&&t.loc?`Line : ${(e=t.loc.start)==null?void 0:e.line}, ${(i=t.loc.start)==null?void 0:i.column}: `:""}let yTt=class B_e extends Error{constructor(e,i,r,n){super("Compilation error - "+U7(r)+OR(V_e[i],n)),this.loc=null,this.declaredRootClass="esri.arcade.arcadecompilationerror",Error.captureStackTrace&&Error.captureStackTrace(this,B_e),r&&r.loc&&(this.loc=r.loc)}},vTt=class U_e extends Error{constructor(){super("Uncompilable code structures"),this.declaredRootClass="esri.arcade.arcadeuncompilableerror",Error.captureStackTrace&&Error.captureStackTrace(this,U_e)}};function OR(t,e){try{if(!e)return t;for(const i in e){let r=e[i];r||(r=""),t=t.replace("{"+i+"}",e[i])}}catch{}return t}function _Tt(t,e,i){return i.declaredRootClass==="esri.arcade.arcadeexecutionerror"||i.declaredRootClass==="esri.arcade.arcadecompilationerror"?i.loc===null&&e&&e.loc?new ote(i,{cause:i}):i:(i.declaredRootClass==="esri.arcade.featureset.support.featureseterror"||i.declaredRootClass==="esri.arcade.featureset.support.sqlerror"||i.declaredRootClass,e&&e.loc?new ote(i,{cause:i}):i)}var EO;(function(t){t.UnrecognisedUri="UnrecognisedUri",t.UnsupportedUriProtocol="UnsupportedUriProtocol"})(EO||(EO={}));const Not={[EO.UnrecognisedUri]:"Unrecognised uri - {uri}",[EO.UnsupportedUriProtocol]:"Unrecognised uri protocol"};let bTt=class G_e extends Error{constructor(e,i){super(OR(Not[e],i)),this.declaredRootClass="esri.arcade.arcademoduleerror",Error.captureStackTrace&&Error.captureStackTrace(this,G_e)}},gm=class{};var MO;gm.instance=new Cu("Etc/UTC"),function(t){t.TimeZoneNotRecognised="TimeZoneNotRecognised"}(MO||(MO={}));const Vot={[MO.TimeZoneNotRecognised]:"Timezone identifier has not been recognised."};let zot=class H_e extends Error{constructor(e,i){super(OR(Vot[e],i)),this.declaredRootClass="esri.arcade.arcadedate.dateerror",Error.captureStackTrace&&Error.captureStackTrace(this,H_e)}},BF=class bn{constructor(e){this._date=e,this.declaredRootClass="esri.arcade.arcadedate"}static fromParts(e=0,i=1,r=1,n=0,s=0,o=0,a=0,l){if(isNaN(e)||isNaN(i)||isNaN(r)||isNaN(n)||isNaN(s)||isNaN(o)||isNaN(a))return null;let c=0;const u=Ae.local(e,i).daysInMonth;r<1&&(c=r-1,r=1),r>u&&(c=r-u,r=u);let h=0;i>12?(h=i-12,i=12):i<1&&(h=i-1,i=1);let f=0;s>59?(f=s-59,s=59):s<0&&(f=s,s=0);let m=0;o>59?(m=o-59,o=59):o<0&&(m=o,o=0);let g=0;a>999?(g=a-999,a=999):a<0&&(g=a,a=0);let y=Ae.fromObject({day:r,year:e,month:i,hour:n,minute:s,second:o,millisecond:a},{zone:XM(l)});return h!==0&&(y=y.plus({months:h})),c!==0&&(y=y.plus({days:c})),f!==0&&(y=y.plus({minutes:f})),m!==0&&(y=y.plus({seconds:m})),g!==0&&(y=y.plus({milliseconds:g})),new bn(y)}static get systemTimeZoneCanonicalName(){return Intl.DateTimeFormat().resolvedOptions().timeZone??"system"}static arcadeDateAndZoneToArcadeDate(e,i){const r=XM(i);return e.isUnknownTimeZone||r===gm.instance?bn.fromParts(e.year,e.monthJS+1,e.day,e.hour,e.minute,e.second,e.millisecond,r):new bn(e._date.setZone(i))}static dateJSToArcadeDate(e){return new bn(Ae.fromJSDate(e,{zone:"system"}))}static dateJSAndZoneToArcadeDate(e,i="system"){return new bn(Ae.fromJSDate(e,{zone:i}))}static unknownEpochToArcadeDate(e){return new bn(Ae.fromMillis(e,{zone:gm.instance}))}static unknownDateJSToArcadeDate(e){return new bn(Ae.fromMillis(e.getTime(),{zone:gm.instance}))}static epochToArcadeDate(e,i="system"){return new bn(Ae.fromMillis(e,{zone:i}))}static dateTimeToArcadeDate(e){return new bn(e)}clone(){return new bn(this._date)}changeTimeZone(e){const i=XM(e);return bn.dateTimeToArcadeDate(this._date.setZone(i))}static dateTimeAndZoneToArcadeDate(e,i){const r=XM(i);return e.zone===gm.instance||r===gm.instance?bn.fromParts(e.year,e.month,e.day,e.hour,e.minute,e.second,e.millisecond,r):new bn(e.setZone(r))}static nowToArcadeDate(e){return new bn(Ae.fromJSDate(new Date,{zone:e}))}static nowUTCToArcadeDate(){return new bn(Ae.utc())}get isSystem(){return this.timeZone==="system"||this.timeZone===bn.systemTimeZoneCanonicalName}equals(e){return this.isSystem&&e.isSystem?this.toNumber()===e.toNumber():this.isUnknownTimeZone===e.isUnknownTimeZone&&this._date.equals(e._date)}get isUnknownTimeZone(){return this._date.zone===gm.instance}get isValid(){return this._date.isValid}get hour(){return this._date.hour}get second(){return this._date.second}get day(){return this._date.day}get dayOfWeekISO(){return this._date.weekday}get dayOfWeekJS(){let e=this._date.weekday;return e>6&&(e=0),e}get millisecond(){return this._date.millisecond}get monthISO(){return this._date.month}get weekISO(){return this._date.weekNumber}get yearISO(){return this._date.weekYear}get monthJS(){return this._date.month-1}get year(){return this._date.year}get minute(){return this._date.minute}get zone(){return this._date.zone}get timeZoneOffset(){return this.isUnknownTimeZone?0:this._date.offset}get timeZone(){if(this.isUnknownTimeZone)return"unknown";if(this._date.zone.type==="system")return"system";const e=this.zone;return e.type==="fixed"?e.fixed===0?"utc":e.formatOffset(0,"short"):e.name}stringify(){return JSON.stringify(this.toJSDate())}plus(e){return new bn(this._date.plus(e))}diff(e,i="milliseconds"){return this._date.diff(e._date,i)[i]}toISOString(e){return e?this._date.toISO({suppressMilliseconds:!0,includeOffset:!this.isUnknownTimeZone}):this._date.toISO({includeOffset:!this.isUnknownTimeZone})}toFormat(e,i){return this._date.toFormat(e,i)}toJSDate(){return this._date.toJSDate()}toSQLString(){return"timestamp '"+this._date.toFormat("yyyy-LL-dd HH:mm:ss")+"'"}toDateTime(){return this._date}toNumber(){return this._date.toMillis()}getTime(){return this._date.toMillis()}toUTC(){return new bn(this._date.toUTC())}toLocal(){return new bn(this._date.toLocal())}toString(){return this.toISOString(!0)}};function XM(t){if(t instanceof z1)return t;if(t.toLowerCase()==="system")return"system";if(t.toLowerCase()==="utc")return"utc";if(t.toLowerCase()==="unknown")return gm.instance;if(/^[\+\-]?[0-9]{1,2}([:][0-9]{2})?$/.test(t)){const i=Ps.parseSpecifier("UTC"+(t.startsWith("+")||t.startsWith("-")?"":"+")+t);if(i)return i}const e=Cu.create(t);if(!e.isValid)throw new zot(MO.TimeZoneNotRecognised);return e}let jot=class{constructor(e=[]){this._elements=e}length(){return this._elements.length}get(e){return this._elements[e]}toArray(){const e=[];for(let i=0;i<this.length();i++)e.push(this.get(i));return e}};function ate(t,e,i){if(t.hasM==null||t.hasZ)for(const r of e)for(const n of r)n.length>2&&(n[2]*=i)}function Bot(t,e,i){if(!t&&!e||!i)return;const r=Iu(i);lte(t,i,r),lte(e,i,r)}function lte(t,e,i){if(t)for(const r of t)Uot(r.geometry,e,i)}function Uot(t,e,i){if(t==null||!t.spatialReference||Pr(t.spatialReference,e))return;const r=Iu(t.spatialReference)/i;if(r!==1){if("x"in t)t.z!=null&&(t.z*=r);else if("rings"in t)ate(t,t.rings,r);else if("paths"in t)ate(t,t.paths,r);else if("points"in t&&(t.hasM==null||t.hasZ))for(const n of t.points)n.length>2&&(n[2]*=r)}}function cte(t,e,i){if(!i||!i.features||!i.hasZ)return;const r=Ule(i.geometryType,e,t.outSpatialReference);if(r!=null)for(const n of i.features)r(n.geometry)}let Got=0;const q_e="esri.layers.graphics.sources.MemorySource",UF=ie.getLogger(q_e);let Vh=class extends Su.LoadableMixin(F1(cn(ye))){constructor(e){super(e),this._idToClientGraphic=null,this.type="memory"}load(e){const i=e!=null?e.signal:null;return this.addResolvingPromise(this._startWorker(i)),Promise.resolve(this)}destroy(){var e;(e=this._connection)==null||e.close(),this._connection=null}get _workerGeometryType(){var i;const e=(i=this.layer)==null?void 0:i.geometryType;return e?this._geometryTypeRequiresClientGraphicMapping(e)?"polygon":e:null}applyEdits(e){return this.load().then(()=>this._applyEdits(e))}openPorts(){return this.load().then(()=>this._connection.openPorts())}async queryFeatures(e,i={}){await this.load(i);const r=await this._connection.invoke("queryFeatures",e?e.toJSON():null,i);cte(e,this.layer.spatialReference,r);const n=Mg.fromJSON(r);if(!this._requiresClientGraphicMapping())return n;const s=this.layer.objectIdField;for(const o of n.features){const a=o.attributes[s],l=this._idToClientGraphic.get(a);l&&(o.geometry=l.geometry)}return n.geometryType=this.layer.geometryType,n}async queryFeaturesJSON(e,i={}){if(this._requiresClientGraphicMapping())throw new N("query-features-json:unsupported","Cannot query in JSON format for client only geometry types (mesh and extent)");await this.load(i);const r=await this._connection.invoke("queryFeatures",e?e.toJSON():null,i);return cte(e,this.layer.spatialReference,r),r}queryFeatureCount(e,i={}){return this.load(i).then(()=>this._connection.invoke("queryFeatureCount",e?e.toJSON():null,i))}queryObjectIds(e,i={}){return this.load(i).then(()=>this._connection.invoke("queryObjectIds",e?e.toJSON():null,i))}queryExtent(e,i={}){return this.load(i).then(()=>this._connection.invoke("queryExtent",e?e.toJSON():null,i)).then(r=>({count:r.count,extent:Re.fromJSON(r.extent)}))}querySnapping(e,i={}){return this.load(i).then(()=>this._connection.invoke("querySnapping",e,i))}async _applyEdits(e){if(!this._connection)throw new N("feature-layer-source:edit-failure","Memory source not loaded");const i=this.layer.objectIdField;let r=null;const n=[],s=[];await Promise.all([this._prepareClientMapping(e.addFeatures,null),this._prepareClientMapping(e.updateFeatures,null)]);const o=u=>"objectId"in u&&u.objectId!=null?u.objectId:"attributes"in u&&u.attributes[i]!=null?u.attributes[i]:null;if(e.addFeatures&&(r=this._prepareAddFeatures(e.addFeatures)),e.deleteFeatures)for(const u of e.deleteFeatures){const h=o(u);h!=null&&n.push(h)}const a=e.updateFeatures&&this._idToClientGraphic?new Map:null;if(e.updateFeatures){for(const u of e.updateFeatures)if(s.push(this._serializeFeature(u)),a){const h=o(u);h!=null&&a.set(h,u)}}Bot(r?r.features:null,s,this.layer.spatialReference);const{fullExtent:l,featureEditResults:c}=await this._connection.invoke("applyEdits",{adds:r?r.features:[],updates:s,deletes:n});return this.fullExtent=l,r&&r.finish(c.uidToObjectId),this._updateClientGraphicIds(a,c),this._createEditsResult(c)}async _prepareClientMapping(e,i){if(this._layerOrSourceGeometryType!=="mesh"||e==null)return;const r=[];for(const{geometry:n}of e)n==null||n.type!=="mesh"||n.hasExtent||n.loaded||r.push(n.load({signal:i}));r.length&&await Promise.all(r)}_updateClientGraphicIds(e,i){if(this._idToClientGraphic){if(e)for(const r of i.updateResults){if(!r.success)continue;const n=e.get(r.objectId);n!=null&&this._addIdToClientGraphic(n)}for(const r of i.deleteResults)r.success&&this._idToClientGraphic.delete(r.objectId)}}_createEditsResult(e){return{addFeatureResults:e.addResults?e.addResults.map(this._createFeatureEditResult,this):[],updateFeatureResults:e.updateResults?e.updateResults.map(this._createFeatureEditResult,this):[],deleteFeatureResults:e.deleteResults?e.deleteResults.map(this._createFeatureEditResult,this):[],addAttachmentResults:[],updateAttachmentResults:[],deleteAttachmentResults:[]}}_createFeatureEditResult(e){const i=e.success===!0?null:e.error||{code:void 0,description:void 0};return{objectId:e.objectId,globalId:e.globalId,error:i?new N("feature-layer-source:edit-failure",i.description,{code:i.code}):null}}_prepareAddFeatures(e){const i=new Map,r=new Array(e.length);let n=null;for(let o=0;o<e.length;o++){const a=e[o],l=this._serializeFeature(a);n||a.geometry==null||(n=a.geometry.type),r[o]=l,i.set(`${l.uid}`,a)}const s=this;return{features:r,inferredGeometryType:n,finish(o){const a=s.sourceJSON.objectIdField;for(const l in o){const c=o[l],u=i.get(l);u&&(u.attributes||(u.attributes={}),c===-1?delete u.attributes[a]:u.attributes[a]=c,s._addIdToClientGraphic(u))}}}}_addIdToClientGraphic(e){if(!this._idToClientGraphic)return;const i=this.sourceJSON.objectIdField,r=e.attributes&&e.attributes[i];r!=null&&this._idToClientGraphic.set(r,e)}get _layerOrSourceGeometryType(){var e,i;return((e=this.layer)==null?void 0:e.geometryType)??((i=this.sourceJSON)==null?void 0:i.geometryType)}_requiresClientGraphicMapping(){return this._geometryTypeRequiresClientGraphicMapping(this._layerOrSourceGeometryType)}_geometryRequiresClientGraphicMapping(e){return this._geometryTypeRequiresClientGraphicMapping(e.type)}_geometryTypeRequiresClientGraphicMapping(e){return e==="mesh"||e==="multipatch"||e==="extent"}_serializeFeature(e){const{attributes:i}=e,r=this._geometryForSerialization(e),n=(Got++).toString();return r?{uid:n,geometry:r.toJSON(),attributes:i}:{uid:n,attributes:i}}_geometryForSerialization(e){const{geometry:i}=e;return i==null?null:this._geometryRequiresClientGraphicMapping(i)?i.extent?Zn.fromExtent(i.extent):null:i}async _startWorker(e){this._connection=await IU("MemorySourceWorker",{strategy:ee("feature-layers-workers")?"dedicated":"local",signal:e});const{fields:i,spatialReference:r,objectIdField:n,hasM:s,hasZ:o,timeInfo:a}=this.layer,l=this.layer.originOf("spatialReference")==="defaults";await this._prepareClientMapping(this.items,e);const c=this._prepareAddFeatures(this.items);this.handles.add(this.on("before-changes",m=>{UF.error("Source modifications will not propagate after layer has been loaded. Please use .applyEdits() instead"),m.preventDefault()}));const u={features:c.features,fields:i&&i.map(m=>m.toJSON()),geometryType:wq.toJSON(this._workerGeometryType),hasM:this._layerOrSourceGeometryType!=="mesh"&&s,hasZ:this._layerOrSourceGeometryType==="mesh"||o,objectIdField:n,spatialReference:l?null:r&&r.toJSON(),timeInfo:a?a.toJSON():null},h=await this._connection.invoke("load",u,{signal:e});for(const m of h.warnings)UF.warn(m.message,{layer:this.layer,warning:m});h.featureErrors.length&&UF.warn(`Encountered ${h.featureErrors.length} validation errors while loading features`,h.featureErrors);const f=h.layerDefinition;this._geometryTypeRequiresClientGraphicMapping(c.inferredGeometryType)&&(f.geometryType=wq.toJSON(c.inferredGeometryType)),this.sourceJSON=f,this._requiresClientGraphicMapping()&&(this._idToClientGraphic=new Map),c.finish(h.assignedObjectIds)}};d([Z6({Type:Or,ensureType:lr(Or)})],Vh.prototype,"itemType",void 0),d([p()],Vh.prototype,"type",void 0),d([p({constructOnly:!0})],Vh.prototype,"layer",void 0),d([p({readOnly:!0})],Vh.prototype,"_workerGeometryType",null),d([p()],Vh.prototype,"sourceJSON",void 0),Vh=d([A(q_e)],Vh);function Hot(t){return"portalItem"in t}const qot=t=>{let e=class extends t{get apiKey(){var i;return this._isOverridden("apiKey")?this._get("apiKey"):Hot(this)?(i=this.portalItem)==null?void 0:i.apiKey:null}set apiKey(i){i!=null?this._override("apiKey",i):(this._clearOverride("apiKey"),this.clear("apiKey","user"))}};return d([p({type:String})],e.prototype,"apiKey",null),e=d([A("esri.layers.mixins.APIKeyMixin")],e),e},W_e=new an.EventEmitter;function ITt(t,e,i=!1){const r=Ta();return i=e==null||i,W_e.emit("apply-edits",{serviceUrl:t,layerId:e,mayReceiveServiceEdits:i,result:r.promise}),r}const J_e="esri.layers.mixins.EditBusLayer",Z_e=Symbol(J_e);function TTt(t){return t!=null&&typeof t=="object"&&Z_e in t}const Wot=t=>{var e;let i=class extends t{constructor(...r){super(...r),this[e]=!0,this.when().then(()=>{this.own([W_e.on("apply-edits",n=>{const{serviceUrl:s,layerId:o,mayReceiveServiceEdits:a,result:l}=n,c=s===this.url,u=o!=null&&this.layerId!=null&&o===this.layerId;if(!c||!u&&!a)return;const h=l.then(f=>{var g;if(u&&(f.addedFeatures.length||f.updatedFeatures.length||f.deletedFeatures.length||f.addedAttachments.length||f.updatedAttachments.length||f.deletedAttachments.length))return this.emit("edits",U(f)),f;const m=(g=f.editedFeatures)==null?void 0:g.find(({layerId:y})=>y===this.layerId);if(m){const{adds:y,updates:v,deletes:b}=m.editedFeatures,w={edits:null,addedAttachments:[],deletedAttachments:[],updatedAttachments:[],addedFeatures:y?y.map(({attributes:x})=>({objectId:this.objectIdField&&x[this.objectIdField],globalId:this.globalIdField&&x[this.globalIdField]})):[],deletedFeatures:b?b.map(({attributes:x})=>({objectId:this.objectIdField&&x[this.objectIdField],globalId:this.globalIdField&&x[this.globalIdField]})):[],updatedFeatures:v?v.map(({current:{attributes:x}})=>({objectId:this.objectIdField&&x[this.objectIdField],globalId:this.globalIdField&&x[this.globalIdField]})):[],editedFeatures:U(f.editedFeatures),exceededTransferLimit:!1};return this.emit("edits",w),w}return{edits:null,addedAttachments:[],deletedAttachments:[],updatedAttachments:[],addedFeatures:[],deletedFeatures:[],updatedFeatures:[],editedFeatures:U(f.editedFeatures),exceededTransferLimit:!1}});this.emit("apply-edits",{result:h})})])},()=>{})}};return e=Z_e,i=d([A(J_e)],i),i};let Lh=class extends Li(te){constructor(e){super(e),this.creatorField=null,this.creationDateField=null,this.editorField=null,this.editDateField=null,this.realm=null,this.dateFieldsTimeReference=null}};d([p()],Lh.prototype,"creatorField",void 0),d([p()],Lh.prototype,"creationDateField",void 0),d([p()],Lh.prototype,"editorField",void 0),d([p()],Lh.prototype,"editDateField",void 0),d([p()],Lh.prototype,"realm",void 0),d([p({type:c1})],Lh.prototype,"dateFieldsTimeReference",void 0),Lh=d([A("esri.layers.support.EditFieldsInfo")],Lh);const Jot=Lh;let fd=class extends Li(te){constructor(e){super(e)}};d([p({constructOnly:!0,json:{write:!0}})],fd.prototype,"name",void 0),d([p({constructOnly:!0,json:{write:!0}})],fd.prototype,"fields",void 0),d([p({constructOnly:!0,json:{write:!0}})],fd.prototype,"isAscending",void 0),d([p({constructOnly:!0,json:{write:!0}})],fd.prototype,"indexType",void 0),d([p({constructOnly:!0,json:{write:!0}})],fd.prototype,"isUnique",void 0),d([p({constructOnly:!0,json:{write:!0}})],fd.prototype,"description",void 0),fd=d([A("esri.layers.support.FeatureIndex")],fd);let Kb=class extends Li(te){constructor(e){super(e),this.shapeAreaField=null,this.shapeLengthField=null,this.units=null}};d([p({type:String,json:{read:{source:"shapeAreaFieldName"}}})],Kb.prototype,"shapeAreaField",void 0),d([p({type:String,json:{read:{source:"shapeLengthFieldName"}}})],Kb.prototype,"shapeLengthField",void 0),d([p({type:String,json:{read:t=>E2e.read(t)||M2e.read(t)}})],Kb.prototype,"units",void 0),Kb=d([A("esri.layers.support.GeometryFieldsInfo")],Kb);const Zot=Kb;var i6;let Xb=i6=class extends te{constructor(t){super(t),this.floorField=null,this.viewAllMode=!1,this.viewAllLevelIds=new ye}clone(){return new i6({floorField:this.floorField,viewAllMode:this.viewAllMode,viewAllLevelIds:this.viewAllLevelIds})}};d([p({type:String,json:{write:!0}})],Xb.prototype,"floorField",void 0),d([p({json:{read:!1,write:!1}})],Xb.prototype,"viewAllMode",void 0),d([p({json:{read:!1,write:!1}})],Xb.prototype,"viewAllLevelIds",void 0),Xb=i6=d([A("esri.layers.support.LayerFloorInfo")],Xb);const Yot=Xb,ute=new He({esriRelCardinalityOneToOne:"one-to-one",esriRelCardinalityOneToMany:"one-to-many",esriRelCardinalityManyToMany:"many-to-many"}),dte=new He({esriRelRoleOrigin:"origin",esriRelRoleDestination:"destination"});let Dl=class extends Li(te){constructor(e){super(e),this.cardinality=null,this.composite=null,this.id=null,this.keyField=null,this.keyFieldInRelationshipTable=null,this.name=null,this.relatedTableId=null,this.relationshipTableId=null,this.role=null}};d([p({json:{read:ute.read,write:ute.write}})],Dl.prototype,"cardinality",void 0),d([p({json:{read:!0,write:!0}})],Dl.prototype,"composite",void 0),d([p({json:{read:!0,write:!0}})],Dl.prototype,"id",void 0),d([p({json:{read:!0,write:!0}})],Dl.prototype,"keyField",void 0),d([p({json:{read:!0,write:!0}})],Dl.prototype,"keyFieldInRelationshipTable",void 0),d([p({json:{read:!0,write:!0}})],Dl.prototype,"name",void 0),d([p({json:{read:!0,write:!0}})],Dl.prototype,"relatedTableId",void 0),d([p({json:{read:!0,write:!0}})],Dl.prototype,"relationshipTableId",void 0),d([p({json:{read:dte.read,write:dte.write}})],Dl.prototype,"role",void 0),Dl=d([A("esri.layers.support.Relationship")],Dl);const Kot=Dl,Xot={name:"supportsName",size:"supportsSize",contentType:"supportsContentType",keywords:"supportsKeywords",exifInfo:"supportsExifInfo"};function qe(t,e,i){return!!Y_e(t,e,i)}function QM(t,e,i){return Y_e(t,e,i)}function Y_e(t,e,i){return t&&t.hasOwnProperty(e)?t[e]:i}function Qot(t){var i;const e=(i=t==null?void 0:t.supportedSpatialAggregationStatistics)==null?void 0:i.map(r=>r.toLowerCase());return{envelope:!!(e!=null&&e.includes("envelopeaggregate")),centroid:!!(e!=null&&e.includes("centroidaggregate")),convexHull:!!(e!=null&&e.includes("convexhullaggregate"))}}function QC(t,e){var r;const i=(r=t==null?void 0:t.supportedOperationsWithCacheHint)==null?void 0:r.map(n=>n.toLowerCase());return!!(i!=null&&i.includes(e.toLowerCase()))}function K_e(t,e){return{analytics:eat(t),attachment:tat(t),data:iat(t),metadata:rat(t),operations:nat(t.capabilities,t,e),query:sat(t,e),queryRelated:oat(t),queryTopFeatures:aat(t),editing:lat(t)}}function eat(t){return{supportsCacheHint:QC(t.advancedQueryCapabilities,"queryAnalytics")}}function tat(t){const e=t.attachmentProperties,i={supportsName:!1,supportsSize:!1,supportsContentType:!1,supportsKeywords:!1,supportsExifInfo:!1,supportsCacheHint:QC(t.advancedQueryCapabilities,"queryAttachments"),supportsResize:qe(t,"supportsAttachmentsResizing",!1)};return e&&Array.isArray(e)&&e.forEach(r=>{const n=Xot[r.name];n&&(i[n]=!!r.isEnabled)}),i}function iat(t){return{isVersioned:qe(t,"isDataVersioned",!1),supportsAttachment:qe(t,"hasAttachments",!1),supportsM:qe(t,"hasM",!1),supportsZ:qe(t,"hasZ",!1)}}function rat(t){return{supportsAdvancedFieldProperties:qe(t,"supportsFieldDescriptionProperty",!1)}}function nat(t,e,i){const r=t?t.toLowerCase().split(",").map(f=>f.trim()):[],n=i?op(i):null,s=r.includes(n!=null&&n.serverType==="MapServer"?"data":"query"),o=r.includes("editing")&&!e.datesInUnknownTimezone;let a=o&&r.includes("create"),l=o&&r.includes("delete"),c=o&&r.includes("update");const u=r.includes("changetracking"),h=e.advancedQueryCapabilities;return o&&!(a||l||c)&&(a=l=c=!0),{supportsCalculate:qe(e,"supportsCalculate",!1),supportsTruncate:qe(e,"supportsTruncate",!1),supportsValidateSql:qe(e,"supportsValidateSql",!1),supportsAdd:a,supportsDelete:l,supportsEditing:o,supportsChangeTracking:u,supportsQuery:s,supportsQueryAnalytics:qe(h,"supportsQueryAnalytic",!1),supportsQueryAttachments:qe(h,"supportsQueryAttachments",!1),supportsQueryTopFeatures:qe(h,"supportsTopFeaturesQuery",!1),supportsResizeAttachments:qe(e,"supportsAttachmentsResizing",!1),supportsSync:r.includes("sync"),supportsUpdate:c,supportsExceedsLimitStatistics:qe(e,"supportsExceedsLimitStatistics",!1),supportsAsyncConvert3D:qe(e,"supportsAsyncConvert3D",!1)}}function sat(t,e){const i=t.advancedQueryCapabilities,r=t.ownershipBasedAccessControlForFeatures,n=t.archivingInfo,s=t.currentVersion,o=e==null?void 0:e.includes("MapServer"),a=!o||s>=ee("mapserver-pbf-version-support"),l=Zce(e),c=new Set((t.supportedQueryFormats??"").split(",").map(u=>u.toLowerCase().trim()));return{supportsStatistics:qe(i,"supportsStatistics",t.supportsStatistics),supportsPercentileStatistics:qe(i,"supportsPercentileStatistics",!1),supportsSpatialAggregationStatistics:qe(i,"supportsSpatialAggregationStatistics",!1),supportedSpatialAggregationStatistics:Qot(i),supportsCentroid:qe(i,"supportsReturningGeometryCentroid",!1),supportsDistance:qe(i,"supportsQueryWithDistance",!1),supportsDistinct:qe(i,"supportsDistinct",t.supportsAdvancedQueries),supportsExtent:qe(i,"supportsReturningQueryExtent",!1),supportsGeometryProperties:qe(i,"supportsReturningGeometryProperties",!1),supportsHavingClause:qe(i,"supportsHavingClause",!1),supportsOrderBy:qe(i,"supportsOrderBy",t.supportsAdvancedQueries),supportsPagination:qe(i,"supportsPagination",!1),supportsQuantization:qe(t,"supportsCoordinatesQuantization",!1),supportsQuantizationEditMode:qe(t,"supportsQuantizationEditMode",!1),supportsQueryGeometry:qe(t,"supportsReturningQueryGeometry",!1),supportsResultType:qe(i,"supportsQueryWithResultType",!1),supportsMaxRecordCountFactor:qe(i,"supportsMaxRecordCountFactor",!1),supportsSqlExpression:qe(i,"supportsSqlExpression",!1),supportsStandardizedQueriesOnly:qe(t,"useStandardizedQueries",!1),supportsTopFeaturesQuery:qe(i,"supportsTopFeaturesQuery",!1),supportsQueryByOthers:qe(r,"allowOthersToQuery",!0),supportsHistoricMoment:qe(n,"supportsQueryWithHistoricMoment",!1),supportsFormatPBF:a&&c.has("pbf"),supportsDisjointSpatialRelationship:qe(i,"supportsDisjointSpatialRel",!1),supportsCacheHint:qe(i,"supportsQueryWithCacheHint",!1)||QC(i,"query"),supportsDefaultSpatialReference:qe(i,"supportsDefaultSR",!1),supportsCompactGeometry:l,supportsFullTextSearch:qe(i,"supportsFullTextSearch",!1),maxRecordCountFactor:QM(t,"maxRecordCountFactor",void 0),maxRecordCount:QM(t,"maxRecordCount",void 0),standardMaxRecordCount:QM(t,"standardMaxRecordCount",void 0),tileMaxRecordCount:QM(t,"tileMaxRecordCount",void 0)}}function oat(t){const e=t.advancedQueryCapabilities,i=qe(e,"supportsAdvancedQueryRelated",!1);return{supportsPagination:qe(e,"supportsQueryRelatedPagination",!1),supportsCount:i,supportsOrderBy:i,supportsCacheHint:QC(e,"queryRelated")}}function aat(t){return{supportsCacheHint:QC(t.advancedQueryCapabilities,"queryTopFilter")}}function lat(t){const e=t.ownershipBasedAccessControlForFeatures,i=t?t.advancedEditingCapabilities:void 0;return{supportsGeometryUpdate:qe(t,"allowGeometryUpdates",!0),supportsGlobalId:qe(t,"supportsApplyEditsWithGlobalIds",!1),supportsReturnServiceEditsInSourceSpatialReference:qe(t,"supportsReturnServiceEditsInSourceSR",!1),supportsRollbackOnFailure:qe(t,"supportsRollbackOnFailureParameter",!1),supportsUpdateWithoutM:qe(t,"allowUpdateWithoutMValues",!1),supportsUploadWithItemId:qe(t,"supportsAttachmentsByUploadId",!1),supportsDeleteByAnonymous:qe(e,"allowAnonymousToDelete",!0),supportsDeleteByOthers:qe(e,"allowOthersToDelete",!0),supportsUpdateByAnonymous:qe(e,"allowAnonymousToUpdate",!0),supportsUpdateByOthers:qe(e,"allowOthersToUpdate",!0),supportsAsyncApplyEdits:qe(i,"supportsAsyncApplyEdits",!1)}}const cat=t=>{let e=class extends t{constructor(){super(...arguments),this.capabilities=null,this.copyright=null,this.dateFieldsTimeReference=null,this.datesInUnknownTimezone=!1,this.displayField=null,this.definitionExpression=null,this.editFieldsInfo=null,this.editingInfo=null,this.elevationInfo=null,this.floorInfo=null,this.fullExtent=null,this.gdbVersion=null,this.geometryFieldsInfo=null,this.geometryType=null,this.hasM=void 0,this.hasZ=void 0,this.heightModelInfo=null,this.historicMoment=null,this.isTable=!1,this.layerId=void 0,this.minScale=0,this.maxScale=0,this.globalIdField=null,this.objectIdField=null,this.preferredTimeReference=null,this.relationships=null,this.sourceJSON=null,this.returnM=void 0,this.returnZ=void 0,this.serviceDefinitionExpression=null,this.serviceItemId=null,this.spatialReference=Ee.WGS84,this.subtypeField=null,this.trackIdField=null,this.indexes=new(ye.ofType(fd)),this.version=void 0}readCapabilitiesFromService(i,r){return K_e(r,this.url)}get effectiveCapabilities(){var o;const i=this.capabilities;if(!i)return null;const r=U(i),{operations:n,editing:s}=r;return(o=this.sourceJSON)!=null&&o.isMultiServicesView?(this.userHasUpdateItemPrivileges&&(n.supportsQuery=!0),r):this.userHasUpdateItemPrivileges?(n.supportsAdd=n.supportsDelete=n.supportsEditing=n.supportsQuery=n.supportsUpdate=s.supportsDeleteByOthers=s.supportsGeometryUpdate=s.supportsUpdateByOthers=!0,r):(this.userHasFullEditingPrivileges&&n.supportsEditing&&(n.supportsAdd=n.supportsDelete=n.supportsUpdate=s.supportsGeometryUpdate=!0),r)}get hasFullEditingRestrictions(){var s;const i=this.capabilities;if(!i||(s=this.sourceJSON)!=null&&s.isMultiServicesView)return!1;const{operations:r,editing:n}=i;return r.supportsEditing&&!(r.supportsAdd&&r.supportsDelete&&r.supportsUpdate&&n.supportsGeometryUpdate)}get hasUpdateItemRestrictions(){var s;const i=this.capabilities;if(!i)return!1;const{operations:r,editing:n}=i;return(s=this.sourceJSON)!=null&&s.isMultiServicesView?!r.supportsQuery:!(r.supportsAdd&&r.supportsDelete&&r.supportsEditing&&r.supportsQuery&&r.supportsUpdate&&n.supportsDeleteByOthers&&n.supportsGeometryUpdate&&n.supportsUpdateByOthers)}readEditingInfo(i,r){const{editingInfo:n}=r;return n?{lastEditDate:n.lastEditDate!=null?new Date(n.lastEditDate):null}:null}readIsTableFromService(i,r){return r.type==="Table"}readMinScale(i,r){return r.effectiveMinScale||i||0}readMaxScale(i,r){return r.effectiveMaxScale||i||0}readGlobalIdFieldFromService(i,r){return spe(r)}readObjectIdFieldFromService(i,r){return ope(r)}readServiceDefinitionExpression(i,r){return r.definitionQuery||r.definitionExpression}set url(i){const r=hRe({layer:this,url:i,nonStandardUrlAllowed:!0,logger:ie.getLogger(this)});this._set("url",r.url),r.layerId!=null&&this._set("layerId",r.layerId)}writeUrl(i,r,n,s){pRe(this,i,null,r,s)}readVersion(i,r){return kze(r)}};return d([p({readOnly:!0,json:{read:!1,origins:{service:{read:{source:["advancedQueryCapabilities","allowGeometryUpdates","allowUpdateWithoutMValues","archivingInfo","capabilities","datesInUnknownTimezone","hasAttachments","hasM","hasZ","maxRecordCount","maxRecordCountFactor","ownershipBasedAccessControlForFeatures","standardMaxRecordCount","supportedQueryFormats","supportsAdvancedQueries","supportsApplyEditsWithGlobalIds","supportsAttachmentsByUploadId","supportsAttachmentsResizing","supportsCalculate","supportsCoordinatesQuantization","supportsExceedsLimitStatistics","supportsFieldDescriptionProperty","supportsQuantizationEditMode","supportsRollbackOnFailureParameter","supportsStatistics","supportsTruncate","supportsValidateSql","tileMaxRecordCount","useStandardizedQueries"]}}}}})],e.prototype,"capabilities",void 0),d([ae("service","capabilities")],e.prototype,"readCapabilitiesFromService",null),d([p({readOnly:!0})],e.prototype,"effectiveCapabilities",null),d([p({readOnly:!0})],e.prototype,"hasFullEditingRestrictions",null),d([p({readOnly:!0})],e.prototype,"hasUpdateItemRestrictions",null),d([p({type:String,json:{origins:{service:{read:{source:"copyrightText"}}}}})],e.prototype,"copyright",void 0),d([p({type:c1})],e.prototype,"dateFieldsTimeReference",void 0),d([p({type:Boolean})],e.prototype,"datesInUnknownTimezone",void 0),d([p({type:String,json:{origins:{service:{read:{source:"displayField"}}}}})],e.prototype,"displayField",void 0),d([p({type:String,json:{origins:{service:{read:!1,write:!1}},name:"layerDefinition.definitionExpression",write:{enabled:!0,allowNull:!0}}})],e.prototype,"definitionExpression",void 0),d([p({readOnly:!0,type:Jot})],e.prototype,"editFieldsInfo",void 0),d([p({readOnly:!0})],e.prototype,"editingInfo",void 0),d([ae("editingInfo")],e.prototype,"readEditingInfo",null),d([p((()=>{const i=U(epe),r=i.json.origins;return r["web-map"]={read:!1,write:!1},r["portal-item"]={read:!1,write:!1},i})())],e.prototype,"elevationInfo",void 0),d([p({type:Yot,json:{read:{source:"layerDefinition.floorInfo"},write:{target:"layerDefinition.floorInfo"}}})],e.prototype,"floorInfo",void 0),d([p({type:Re,json:{origins:{service:{read:{source:"extent"}}}}})],e.prototype,"fullExtent",void 0),d([p()],e.prototype,"gdbVersion",void 0),d([p({readOnly:!0,type:Zot,json:{read:{source:"geometryProperties"}}})],e.prototype,"geometryFieldsInfo",void 0),d([p({type:["point","polygon","polyline","multipoint","multipatch","mesh"],json:{origins:{service:{read:sz.read}}}})],e.prototype,"geometryType",void 0),d([p({type:Boolean,json:{origins:{service:{read:!0}}}})],e.prototype,"hasM",void 0),d([p({type:Boolean,json:{origins:{service:{read:!0}}}})],e.prototype,"hasZ",void 0),d([p({readOnly:!0,type:wC})],e.prototype,"heightModelInfo",void 0),d([p({type:Date})],e.prototype,"historicMoment",void 0),d([p({readOnly:!0})],e.prototype,"isTable",void 0),d([ae("service","isTable",["type"])],e.prototype,"readIsTableFromService",null),d([p({type:Number,json:{origins:{service:{read:{source:"id"}},"portal-item":{read:!1,write:{target:"id"}}},read:!1}})],e.prototype,"layerId",void 0),d([p(fze)],e.prototype,"minScale",void 0),d([ae("service","minScale",["minScale","effectiveMinScale"])],e.prototype,"readMinScale",null),d([p(mze)],e.prototype,"maxScale",void 0),d([ae("service","maxScale",["maxScale","effectiveMaxScale"])],e.prototype,"readMaxScale",null),d([p({type:String})],e.prototype,"globalIdField",void 0),d([ae("service","globalIdField",["globalIdField","fields"])],e.prototype,"readGlobalIdFieldFromService",null),d([p({type:String})],e.prototype,"objectIdField",void 0),d([ae("service","objectIdField",["objectIdField","fields"])],e.prototype,"readObjectIdFieldFromService",null),d([p({type:c1})],e.prototype,"preferredTimeReference",void 0),d([p({type:[Kot],readOnly:!0})],e.prototype,"relationships",void 0),d([p()],e.prototype,"sourceJSON",void 0),d([p({type:Boolean})],e.prototype,"returnM",void 0),d([p({type:Boolean})],e.prototype,"returnZ",void 0),d([p({readOnly:!0})],e.prototype,"serviceDefinitionExpression",void 0),d([ae("service","serviceDefinitionExpression",["definitionQuery","definitionExpression"])],e.prototype,"readServiceDefinitionExpression",null),d([p({type:String,readOnly:!0,json:{read:!1,origins:{service:{read:!0}}}})],e.prototype,"serviceItemId",void 0),d([p({type:Ee,json:{origins:{service:{read:{source:"extent.spatialReference"}}}}})],e.prototype,"spatialReference",void 0),d([p({type:String,readOnly:!0,json:{origins:{service:{read:!0}}}})],e.prototype,"subtypeField",void 0),d([p({type:String,json:{read:{source:"timeInfo.trackIdField"}}})],e.prototype,"trackIdField",void 0),d([p({readOnly:!0,json:{write:!1}})],e.prototype,"serverGens",void 0),d([p({type:ye.ofType(fd),readOnly:!0})],e.prototype,"indexes",void 0),d([p(HL)],e.prototype,"url",null),d([ge("url")],e.prototype,"writeUrl",null),d([p({json:{origins:{service:{read:!0}},read:!1}})],e.prototype,"version",void 0),d([ae("service","version",["currentVersion","capabilities","drawingInfo","hasAttachments","htmlPopupType","relationships","timeInfo","typeIdField","types"])],e.prototype,"readVersion",null),e=d([A("esri.layers.mixins.FeatureLayerBase")],e),e};let k2=class extends he{constructor(){super(...arguments),this.updating=!1,this.status="unknown"}};d([p()],k2.prototype,"updating",void 0),d([p()],k2.prototype,"status",void 0),k2=d([A("esri.layers.support.PublishingInfo")],k2);const uat=k2,X_e="esri.layers.mixins.PublishableLayer",dat=Symbol(X_e),hat=t=>{var e;let i=class extends t{constructor(){super(...arguments),this[e]=!0}get publishingInfo(){if(this.destroyed)return null;const r=this._get("publishingInfo");if(r)return r;const n=new uat;return this._checkPublishingStatus(n),n}_checkPublishingStatus(r){let o=0;const a=async c=>{let u;r.updating=!0;try{u=await this.fetchPublishingStatus()}catch{u="unavailable"}u!=="published"&&u!=="unavailable"||(r.status==="publishing"&&this.refresh(),l.remove()),r.status=u,r.updating=!1,l.removed||(o=setTimeout(a,c,c+125))},l={removed:!1,remove(){this.removed=!0,clearTimeout(o)}};this.when().catch(()=>l.remove()),a(250),this.own(l)}};return e=dat,d([p({readOnly:!0,clonable:!1})],i.prototype,"publishingInfo",null),i=d([A(X_e)],i),i},Xc=[];function pat(t,e){if(Zce(t.url??""))return!0;const{wkid:i}=e;for(const r of Xc){if((t.version??0)>=r[0])return!0;if(typeof r[1]=="function"&&(r[1]=r[1]()),r[1].has(i))return!1}return!0}Xc.push([10.91,()=>{const t=new Set([9709,9716,9741,9761,9766]);for(let e=9712;e<=9713;e++)t.add(e);for(let e=9748;e<=9749;e++)t.add(e);for(let e=20904;e<=20932;e++)t.add(e);for(let e=21004;e<=21032;e++)t.add(e);for(let e=21207;e<=21264;e++)t.add(e);for(let e=21307;e<=21364;e++)t.add(e);for(let e=102759;e<=102760;e++)t.add(e);for(let e=102901;e<=102955;e++)t.add(e);return t}]),Xc.push([10.9,()=>{const t=new Set([9300,9354,9364,9367,9373,9377,9387,9456,9473,9498,9678,9680,29874,103599,103872,104028]);for(let e=9356;e<=9360;e++)t.add(e);for(let e=9404;e<=9407;e++)t.add(e);for(let e=9476;e<=9482;e++)t.add(e);for(let e=9487;e<=9494;e++)t.add(e);for(let e=9697;e<=9699;e++)t.add(e);return t}]),Xc.push([10.81,()=>{const t=new Set([9265,9333,103598,103699]);for(let e=9248;e<=9254;e++)t.add(e);for(let e=9271;e<=9273;e++)t.add(e);for(let e=9284;e<=9285;e++)t.add(e);for(let e=21453;e<=21463;e++)t.add(e);return t}]),Xc.push([10.8,()=>{const t=new Set([8088,8395,8428,8433,8531,8687,8692,8694,8699,8900,9003,9006,9009,9012,9017,9191]);for(let e=8035;e<=8036;e++)t.add(e);for(let e=8455;e<=8456;e++)t.add(e);for(let e=8518;e<=8529;e++)t.add(e);for(let e=8533;e<=8536;e++)t.add(e);for(let e=8538;e<=8540;e++)t.add(e);for(let e=8677;e<=8679;e++)t.add(e);for(let e=8902;e<=8903;e++)t.add(e);for(let e=8907;e<=8910;e++)t.add(e);for(let e=8949;e<=8951;e++)t.add(e);for(let e=8972;e<=8987;e++)t.add(e);for(let e=9039;e<=9040;e++)t.add(e);for(let e=9068;e<=9069;e++)t.add(e);for(let e=9140;e<=9141;e++)t.add(e);for(let e=9148;e<=9150;e++)t.add(e);for(let e=9153;e<=9159;e++)t.add(e);for(let e=9205;e<=9218;e++)t.add(e);for(let e=9221;e<=9222;e++)t.add(e);for(let e=54098;e<=54101;e++)t.add(e);return t}]),Xc.push([10.71,()=>{const t=new Set([6316]);for(let e=8351;e<=8353;e++)t.add(e);for(let e=9294;e<=9297;e++)t.add(e);for(let e=22619;e<=22621;e++)t.add(e);for(let e=103586;e<=103594;e++)t.add(e);return t}]),Xc.push([10.7,()=>{const t=new Set([8387,8391,8427,8545,8682,8685,8818,31370,104022,104024,104975]);for(let e=8065;e<=8068;e++)t.add(e);for(let e=8082;e<=8083;e++)t.add(e);for(let e=8379;e<=8385;e++)t.add(e);for(let e=8836;e<=8840;e++)t.add(e);for(let e=8857;e<=8860;e++)t.add(e);for(let e=53035;e<=53037;e++)t.add(e);for(let e=54090;e<=54091;e++)t.add(e);for(let e=102498;e<=102499;e++)t.add(e);return t}]),Xc.push([10.61,()=>new Set([102497])]),Xc.push([10.6,()=>{const t=new Set([7803,7805,7887,8086,8232,8237,8240,8246,8249,8252,8255,9019,9391]);for(let e=7755;e<=7787;e++)t.add(e);for(let e=7791;e<=7795;e++)t.add(e);for(let e=7799;e<=7801;e++)t.add(e);for(let e=7825;e<=7831;e++)t.add(e);for(let e=7877;e<=7878;e++)t.add(e);for(let e=7882;e<=7883;e++)t.add(e);for(let e=7991;e<=7992;e++)t.add(e);for(let e=8042;e<=8043;e++)t.add(e);for(let e=8058;e<=8059;e++)t.add(e);for(let e=8311;e<=8348;e++)t.add(e);for(let e=9060;e<=9067;e++)t.add(e);for(let e=102562;e<=102568;e++)t.add(e);for(let e=102799;e<=102900;e++)t.add(e);return t}]),Xc.push([10.51,()=>{const t=new Set([7683,7881,7886,7899,8888,9e3]);for(let e=8013;e<=8032;e++)t.add(e);for(let e=9053;e<=9057;e++)t.add(e);for(let e=104017;e<=104018;e++)t.add(e);for(let e=104971;e<=104974;e++)t.add(e);return t}]),Xc.push([10.5,()=>{const t=new Set([6962,7035,7037,7039,7041,7084,7086,7133,7798,102399]);for(let e=4087;e<=4088;e++)t.add(e);for(let e=5896;e<=5899;e++)t.add(e);for(let e=7005;e<=7007;e++)t.add(e);for(let e=7057;e<=7070;e++)t.add(e);for(let e=7073;e<=7082;e++)t.add(e);for(let e=7109;e<=7128;e++)t.add(e);for(let e=7844;e<=7859;e++)t.add(e);return t}]);async function fat(t,e,i){const r=t&&t.getAtOrigin&&t.getAtOrigin("renderer",e.origin);if(r&&r.type==="unique-value"&&r.styleOrigin){const n=await tC(r.populateFromStyle());if(_t(i),n.ok===!1){const s=n.error;e&&e.messages&&e.messages.push(new ol("renderer:style-reference",`Failed to create unique value renderer from style reference: ${s.message}`,{error:s,context:e})),t.clear("renderer",e==null?void 0:e.origin)}}}var r6;let Qb=r6=class extends te{constructor(t){super(t),this.groupByFields=void 0,this.topCount=void 0,this.orderByFields=void 0}clone(){return new r6({groupByFields:this.groupByFields,topCount:this.topCount,orderByFields:this.orderByFields})}};d([p({type:[String],json:{write:!0}})],Qb.prototype,"groupByFields",void 0),d([p({type:Number,json:{write:!0}})],Qb.prototype,"topCount",void 0),d([p({type:[String],json:{write:!0}})],Qb.prototype,"orderByFields",void 0),Qb=r6=d([A("esri.rest.support.TopFilter")],Qb);const mat=Qb;var n6;const hte=new He({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"}),pte=new He({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});let Yi=n6=class extends te{constructor(t){super(t),this.cacheHint=void 0,this.distance=void 0,this.geometry=null,this.geometryPrecision=void 0,this.maxAllowableOffset=void 0,this.num=void 0,this.objectIds=null,this.orderByFields=null,this.outFields=null,this.outSpatialReference=null,this.resultType=null,this.returnGeometry=!1,this.returnM=void 0,this.returnZ=void 0,this.start=void 0,this.spatialRelationship="intersects",this.timeExtent=null,this.topFilter=void 0,this.units=null,this.where="1=1"}writeStart(t,e){e.resultOffset=this.start,e.resultRecordCount=this.num||10}clone(){return new n6(U({cacheHint:this.cacheHint,distance:this.distance,geometry:this.geometry,geometryPrecision:this.geometryPrecision,maxAllowableOffset:this.maxAllowableOffset,num:this.num,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,resultType:this.resultType,returnGeometry:this.returnGeometry,returnZ:this.returnZ,returnM:this.returnM,start:this.start,spatialRelationship:this.spatialRelationship,timeExtent:this.timeExtent,topFilter:this.topFilter,units:this.units,where:this.where}))}};d([p({type:Boolean,json:{write:!0}})],Yi.prototype,"cacheHint",void 0),d([p({type:Number,json:{write:{overridePolicy:t=>({enabled:t>0})}}})],Yi.prototype,"distance",void 0),d([p({types:_g,json:{read:Vd,write:!0}})],Yi.prototype,"geometry",void 0),d([p({type:Number,json:{write:!0}})],Yi.prototype,"geometryPrecision",void 0),d([p({type:Number,json:{write:!0}})],Yi.prototype,"maxAllowableOffset",void 0),d([p({type:Number,json:{read:{source:"resultRecordCount"}}})],Yi.prototype,"num",void 0),d([p({json:{write:!0}})],Yi.prototype,"objectIds",void 0),d([p({type:[String],json:{write:!0}})],Yi.prototype,"orderByFields",void 0),d([p({type:[String],json:{write:!0}})],Yi.prototype,"outFields",void 0),d([p({type:Ee,json:{read:{source:"outSR"},write:{target:"outSR"}}})],Yi.prototype,"outSpatialReference",void 0),d([p({type:String,json:{write:!0}})],Yi.prototype,"resultType",void 0),d([p({json:{write:!0}})],Yi.prototype,"returnGeometry",void 0),d([p({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],Yi.prototype,"returnM",void 0),d([p({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],Yi.prototype,"returnZ",void 0),d([p({type:Number,json:{read:{source:"resultOffset"}}})],Yi.prototype,"start",void 0),d([ge("start"),ge("num")],Yi.prototype,"writeStart",null),d([p({type:String,json:{read:{source:"spatialRel",reader:hte.read},write:{target:"spatialRel",writer:hte.write}}})],Yi.prototype,"spatialRelationship",void 0),d([p({type:ku,json:{write:!0}})],Yi.prototype,"timeExtent",void 0),d([p({type:mat,json:{write:!0}})],Yi.prototype,"topFilter",void 0),d([p({type:String,json:{read:pte.read,write:{writer:pte.write,overridePolicy(t){return{enabled:t!=null&&this.distance!=null&&this.distance>0}}}}})],Yi.prototype,"units",void 0),d([p({type:String,json:{write:!0}})],Yi.prototype,"where",void 0),Yi=n6=d([A("esri.rest.support.TopFeaturesQuery")],Yi),Yi.from=lr(Yi);const e$=Yi,bo="FeatureLayer",Q_e="esri.layers.FeatureLayer",gat=ie.getLogger(Q_e);function t$(t,e){return new N("layer:unsupported",`Layer (${t.title}, ${t.id}) of type '${t.declaredClass}' ${e}`,{layer:t})}function fte(t){return t&&t instanceof ye}const GF=Tpe();function HF(t,e,i){const r=!!(i!=null&&i.writeLayerSchema);return{enabled:r,ignoreOrigin:r}}let ke=class extends cat(ype(Khe(hat(Wot(BL(_pe(k9(WL(A9(Cpe(M9($9(FL(b9(qot(Li(lC))))))))))))))))){constructor(...t){super(...t),this._handles=new gs,this.charts=null,this.copyright=null,this.displayField=null,this.dynamicDataSource=null,this.fields=null,this.fieldsIndex=null,this.formTemplate=null,this.fullExtent=null,this.geometryType=null,this.hasM=void 0,this.hasZ=void 0,this.infoFor3D=null,this.isTable=!1,this.labelsVisible=!0,this.labelingInfo=null,this.legendEnabled=!0,this.objectIdField=null,this.outFields=null,this.path=null,this.popupEnabled=!0,this.popupTemplate=null,this.screenSizePerspectiveEnabled=!0,this.spatialReference=Ee.WGS84,this.subtypeCode=null,this.templates=null,this.timeInfo=null,this.title=null,this.sublayerTitleMode="item-title",this.type="feature",this.typeIdField=null,this.types=null,this.visible=!0}destroy(){var t;(t=this.source)==null||t.destroy(),this._handles=je(this._handles)}normalizeCtorArgs(t,e){return typeof t=="string"?{url:t,...e}:t}load(t){var r;const e=t!=null?t.signal:null;if((r=this.portalItem)!=null&&r.loaded&&this.source)return this.addResolvingPromise(this.createGraphicsSource(e).then(n=>this.initLayerProperties(n))),Promise.resolve(this);const i=this.loadFromPortal({supportedTypes:["Feature Service","Feature Collection"]},t).catch(Lo).then(async()=>{if(this.url&&this.layerId==null&&/FeatureServer|MapServer\/*$/i.test(this.url)){const n=await this._fetchFirstLayerId(e);n!=null&&(this.layerId=n)}if(!this.url&&!this._hasMemorySource())throw new N("feature-layer:missing-url-or-source","Feature layer must be created with either a url or a source");return this.initLayerProperties(await this.createGraphicsSource(e))}).then(()=>this._setUserPrivileges(this.serviceItemId,t)).then(()=>Oze(this,t));return this.addResolvingPromise(i),Promise.resolve(this)}readCapabilities(t,e){return e=e.layerDefinition||e,K_e(e,this.url)}get createQueryVersion(){return this.commitProperty("definitionExpression"),this.commitProperty("dynamicDataSource"),this.commitProperty("timeExtent"),this.commitProperty("timeOffset"),this.commitProperty("geometryType"),this.commitProperty("gdbVersion"),this.commitProperty("historicMoment"),this.commitProperty("returnZ"),this.commitProperty("capabilities"),this.commitProperty("returnM"),(this._get("createQueryVersion")??0)+1}get editingEnabled(){var t;return!(this.loaded&&!((t=this.capabilities)!=null&&t.operations.supportsEditing))&&(this._isOverridden("editingEnabled")?this._get("editingEnabled"):this._hasMemorySource()||this.userHasEditingPrivileges)}set editingEnabled(t){this._overrideIfSome("editingEnabled",t)}readEditingEnabled(t,e){return this._readEditingEnabled(e,!1)}readEditingEnabledFromWebMap(t,e,i){return this._readEditingEnabled(e,!0,i)}writeEditingEnabled(t,e){this._writeEditingEnabled(t,e,!1)}writeEditingEnabledToWebMap(t,e,i,r){this._writeEditingEnabled(t,e,!0,r)}get effectiveEditingEnabled(){return Rze(this)}readIsTable(t,e){return(e=(e==null?void 0:e.layerDefinition)??e).type==="Table"||!e.geometryType}writeIsTable(t,e,i,r){r!=null&&r.writeLayerSchema&&ho(i,t?"Table":"Feature Layer",e)}readGlobalIdField(t,e){return spe(e.layerDefinition||e)}readObjectIdField(t,e){return ope(e.layerDefinition||e)}get parsedUrl(){const t=sn(this.url);return t!=null&&(this.dynamicDataSource!=null?t.path=Kw(t.path,"dynamicLayer"):this.layerId!=null&&(t.path=Kw(t.path,this.layerId.toString()))),t}get defaultPopupTemplate(){return this.createPopupTemplate()}set renderer(t){Jk(t,this.fieldsIndex),this._set("renderer",t)}readRenderer(t,e,i){var n;e=e.layerDefinition||e;const r=(n=e.drawingInfo)==null?void 0:n.renderer;if(r){const s=mT(r,e,i)??void 0;return s||gat.error("Failed to create renderer",{rendererDefinition:e.drawingInfo.renderer,layer:this,context:i}),s}return I9(e,i)}set source(t){const e=this._get("source");e!==t&&(fte(e)&&this._resetMemorySource(e),fte(t)&&this._initMemorySource(t),this._set("source",t))}castSource(t){return t?Array.isArray(t)||t instanceof ye?new Vh({layer:this,items:t}):t:null}readSource(t,e){const i=Mg.fromJSON(e.featureSet);return new Vh({layer:this,items:(i==null?void 0:i.features)??[]})}readTemplates(t,e){const i=e.editFieldsInfo,r=i&&i.creatorField,n=i&&i.editorField;return t=t&&t.map(s=>JL.fromJSON(s)),this._fixTemplates(t,r),this._fixTemplates(t,n),t}readTitle(t,e){var n;const i=((n=e.layerDefinition)==null?void 0:n.name)??e.name,r=e.title||e.layerDefinition&&e.layerDefinition.title;if(i){const s=this.portalItem&&this.portalItem.title;if(this.sublayerTitleMode==="item-title")return this.url?dRe(this.url,i):i;let o=i;if(!o&&this.url){const a=op(this.url);a!=null&&(o=a.title)}return o?(this.sublayerTitleMode==="item-title-and-service-name"&&s&&s!==o&&(o=s+" - "+o),DU(o)):void 0}if(this.sublayerTitleMode==="item-title"&&r)return r}readTitleFromWebMap(t,e){return e.title||e.layerDefinition&&e.layerDefinition.name}readTypeIdField(t,e){let i=(e=e.layerDefinition||e).typeIdField;if(i&&e.fields){i=i.toLowerCase();const r=e.fields.find(n=>n.name.toLowerCase()===i);r&&(i=r.name)}return i}readTypes(t,e){t=(e=e.layerDefinition||e).types;const i=e.editFieldsInfo,r=i&&i.creatorField,n=i&&i.editorField;return t&&t.map(s=>(s=P9.fromJSON(s),this._fixTemplates(s.templates,r),this._fixTemplates(s.templates,n),s))}readVisible(t,e){return e.layerDefinition&&e.layerDefinition.defaultVisibility!=null?!!e.layerDefinition.defaultVisibility:e.visibility!=null?!!e.visibility:void 0}async addAttachment(t,e){return yze(this,t,e,bo)}async updateAttachment(t,e,i){return vze(this,t,e,i,bo)}async applyEdits(t,e){return _ze(this,t,e)}async uploadAssets(t,e){return bze(this,t,e)}on(t,e){return super.on(t,e)}createPopupTemplate(t){return O9(this,t)}async createGraphicsSource(t){if(this._hasMemorySource()&&this.source)return this.source.load({signal:t});const{default:e}=await gu(W(()=>import("./FeatureLayerSource-fd59f4e9.js"),["./FeatureLayerSource-fd59f4e9.js","./MeshGeoreferencedRelativeVertexSpace-a1b9aa0f.js","./vec32-304b638d.js","./External-6ca5180d.js","./editingSupport-5d352845.js","./QueryTask-73f8da3a.js","./executeForIds-9020a9f1.js","./query-5ec3ee5e.js","./pbfQueryUtils-2fe692f0.js","./pbf-beba61b9.js","./OptimizedGeometry-196224d4.js","./OptimizedFeature-4701473b.js","./OptimizedFeatureSet-1d1ac4b9.js","./executeQueryJSON-5ab1910a.js","./executeQueryPBF-b57ee6ca.js","./featureConversionUtils-bafaa402.js"],import.meta.url),t);return new e({layer:this}).load({signal:t})}createQuery(){const t=Aze(this);t.dynamicDataSource=this.dynamicDataSource;const e=this.subtypeCode!=null?`${this.subtypeField} = ${this.subtypeCode}`:null,i=npe(this.definitionExpression,e);return t.where=i||"1=1",t}async deleteAttachments(t,e){return wze(this,t,e,bo)}async fetchRecomputedExtents(t){return xze(this,t,bo)}getFeatureType(t){const{typeIdField:e,types:i}=this;if(!e||!t)return null;const r=t.attributes?t.attributes[e]:void 0;if(r==null)return null;let n=null;return i==null||i.some(s=>{const{id:o}=s;return o!=null&&(o.toString()===r.toString()&&(n=s),!!n)}),n}getFieldDomain(t,e){const i=e==null?void 0:e.feature,r=this.getFeatureType(i);if(r){const n=r.domains&&r.domains[t];if(n&&n.type!=="inherited")return n}return this._getLayerDomain(t)}getField(t){return this.fieldsIndex.get(t)}async queryAttachments(t,e){return Sze(this,t,e,bo)}async queryFeatures(t,e){const i=await this.load(),r=await i.source.queryFeatures(au.from(t)??i.createQuery(),e);if(r!=null&&r.features)for(const n of r.features)n.layer=n.sourceLayer=i;return r}async queryObjectIds(t,e){return Ize(this,t,e,bo)}async queryFeatureCount(t,e){return Tze(this,t,e,bo)}async queryExtent(t,e){return Cze(this,t,e,bo)}async queryRelatedFeatures(t,e){return Eze(this,t,e,bo)}async queryRelatedFeaturesCount(t,e){return Mze(this,t,e,bo)}async queryTopFeatures(t,e){var s;const{source:i,capabilities:r}=await this.load();if(!i.queryTopFeatures||!((s=r==null?void 0:r.query)!=null&&s.supportsTopFeaturesQuery))throw new N(bo,"Layer source does not support queryTopFeatures capability");const n=await i.queryTopFeatures(e$.from(t),e);if(n!=null&&n.features)for(const o of n.features)o.layer=o.sourceLayer=this;return n}async queryTopObjectIds(t,e){const{source:i,capabilities:r}=await this.load();if(!i.queryTopObjectIds||!(r!=null&&r.query.supportsTopFeaturesQuery))throw new N(bo,"Layer source does not support queryTopObjectIds capability");return i.queryTopObjectIds(e$.from(t),e)}async queryTopFeaturesExtent(t,e){var n;const{source:i,capabilities:r}=await this.load();if(!i.queryTopExtents||!((n=r==null?void 0:r.query)!=null&&n.supportsTopFeaturesQuery))throw new N(bo,"Layer source does not support queryTopExtents capability");return i.queryTopExtents(e$.from(t),e)}async queryTopFeatureCount(t,e){var n;const{source:i,capabilities:r}=await this.load();if(!i.queryTopCount||!((n=r==null?void 0:r.query)!=null&&n.supportsTopFeaturesQuery))throw new N(bo,"Layer source does not support queryFeatureCount capability");return i.queryTopCount(e$.from(t),e)}read(t,e){const i=t.featureCollection;if(i){const r=i.layers;r&&r.length===1&&(super.read(r[0],e),i.showLegend!=null&&super.read({showLegend:i.showLegend},e))}super.read(t,e),e&&e.origin==="service"&&(this.revert(["objectIdField","fields","timeInfo"],"service"),this.spatialReference||this.revert(["spatialReference"],"service"))}write(t,e){e={...e,origin:(e==null?void 0:e.origin)??void 0,writeLayerSchema:(e==null?void 0:e.writeLayerSchema)??this._hasMemorySource()};const{origin:i,layerContainerType:r,messages:n}=e;if(this.dynamicDataSource)return n==null||n.push(t$(this,"using a dynamic data source cannot be written to web scenes, web maps and feature service items")),null;if(this.isTable){if(i==="web-scene"||i==="web-map"&&r!=="tables")return n==null||n.push(t$(this,"using a table source cannot be written to web scenes and web maps")),null;if(this._hasMemorySource())return n==null||n.push(t$(this,"using an in-memory table source cannot be written to web scenes and web maps")),null}else if(this.loaded&&i==="web-map"&&r==="tables")return n==null||n.push(t$(this,"using a non-table source cannot be written to tables in web maps")),null;return super.write(t,e)}clone(){if(this._hasMemorySource())throw new N(bo,`FeatureLayer (title: ${this.title}, id: ${this.id}) created using in-memory source cannot be cloned`);return super.clone()}serviceSupportsSpatialReference(t){var e;return!!this.loaded&&(((e=this.source)==null?void 0:e.type)==="memory"||pat(this,t))}async save(t){const{save:e}=await W(()=>import("./featureLayerUtils-c1728743.js"),["./featureLayerUtils-c1728743.js","./originUtils-1469eeaf.js","./multiOriginJSONSupportUtils-c978f4c3.js","./fetchService-7b5fa001.js","./jsonContext-0bf4b056.js"],import.meta.url);return e(this,t)}async saveAs(t,e){const{saveAs:i}=await W(()=>import("./featureLayerUtils-c1728743.js"),["./featureLayerUtils-c1728743.js","./originUtils-1469eeaf.js","./multiOriginJSONSupportUtils-c978f4c3.js","./fetchService-7b5fa001.js","./jsonContext-0bf4b056.js"],import.meta.url);return i(this,t,e)}_readEditingEnabled(t,e,i){var n;let r=(n=t.layerDefinition)==null?void 0:n.capabilities;return r?this._hasEditingCapability(r):(r=t.capabilities,e&&(i==null?void 0:i.origin)==="web-map"&&!this._hasMemorySource()&&r?this._hasEditingCapability(r):void 0)}_hasEditingCapability(t){return t.toLowerCase().split(",").map(e=>e.trim()).includes("editing")}_writeEditingEnabled(t,e,i,r){var n,s;if(!t){const o=(s=(n=this.capabilities)==null?void 0:n.operations)!=null&&s.supportsSync?"Query,Sync":"Query";ho("layerDefinition.capabilities",o,e),i&&!(r!=null&&r.writeLayerSchema)&&(e.capabilities=o)}}_getLayerDomain(t){const e=this.fieldsIndex.get(t);return e?e.domain:null}_fetchFirstLayerId(t){return at(this.url,{query:{f:"json",...this.customParameters,token:this.apiKey},responseType:"json",signal:t}).then(e=>{const i=e.data;if(i)return Array.isArray(i.layers)&&i.layers.length>0?i.layers[0].id:Array.isArray(i.tables)&&i.tables.length>0?i.tables[0].id:void 0})}async initLayerProperties(t){var e;return this._set("source",t),t.sourceJSON&&(this.sourceJSON=t.sourceJSON,this.read(t.sourceJSON,{origin:"service",portalItem:this.portalItem,portal:(e=this.portalItem)==null?void 0:e.portal,url:this.parsedUrl})),this._verifySource(),this._verifyFields(),Jk(this.renderer,this.fieldsIndex),GB(this.timeInfo,this.fieldsIndex),fat(this,{origin:"service"})}async hasDataChanged(){return $ze(this)}async fetchPublishingStatus(){const t=this.source;return t!=null&&t.fetchPublishingStatus?t.fetchPublishingStatus():"unavailable"}_verifyFields(){var e,i;const t=((e=this.parsedUrl)==null?void 0:e.path)??"undefined";this.objectIdField||console.log("FeatureLayer: 'objectIdField' property is not defined (url: "+t+")"),this.isTable||this._hasMemorySource()||t.search(/\/FeatureServer\//i)!==-1||(i=this.fields)!=null&&i.some(r=>r.type==="geometry")||console.log("FeatureLayer: unable to find field of type 'geometry' in the layer 'fields' list. If you are using a map service layer, features will not have geometry (url: "+t+")")}_fixTemplates(t,e){t&&t.forEach(i=>{const r=i.prototype&&i.prototype.attributes;r&&e&&delete r[e]})}_verifySource(){if(this._hasMemorySource()){if(this.url)throw new N("feature-layer:mixed-source-and-url","FeatureLayer cannot be created with both an in-memory source and a url")}else if(!this.url)throw new N("feature-layer:source-or-url-required","FeatureLayer requires either a url, a valid portal item or a source")}_initMemorySource(t){t.forEach(e=>{e.layer=this,e.sourceLayer=this}),this._handles.add([t.on("after-add",e=>{e.item.layer=this,e.item.sourceLayer=this}),t.on("after-remove",e=>{e.item.layer=null,e.item.sourceLayer=null})],"fl-source")}_resetMemorySource(t){t.forEach(e=>{e.layer=null,e.sourceLayer=null}),this._handles.remove("fl-source")}_hasMemorySource(){return!(this.url||!this.source)}};d([ae("service","capabilities")],ke.prototype,"readCapabilities",null),d([p({json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],ke.prototype,"charts",void 0),d([p({readOnly:!0})],ke.prototype,"createQueryVersion",null),d([p({json:{read:{source:"layerDefinition.copyrightText"}}})],ke.prototype,"copyright",void 0),d([p({json:{read:{source:"layerDefinition.displayField"}}})],ke.prototype,"displayField",void 0),d([p({types:uu,readOnly:!0})],ke.prototype,"defaultSymbol",void 0),d([p({type:nu})],ke.prototype,"dynamicDataSource",void 0),d([p({type:Boolean})],ke.prototype,"editingEnabled",null),d([ae(["portal-item","web-scene"],"editingEnabled",["layerDefinition.capabilities"])],ke.prototype,"readEditingEnabled",null),d([ae("web-map","editingEnabled",["capabilities","layerDefinition.capabilities"])],ke.prototype,"readEditingEnabledFromWebMap",null),d([ge(["portal-item","web-scene"],"editingEnabled",{"layerDefinition.capabilities":{type:String}})],ke.prototype,"writeEditingEnabled",null),d([ge("web-map","editingEnabled",{capabilities:{type:String},"layerDefinition.capabilities":{type:String}})],ke.prototype,"writeEditingEnabledToWebMap",null),d([p({readOnly:!0})],ke.prototype,"effectiveEditingEnabled",null),d([p({...GF.fields,json:{read:{source:"layerDefinition.fields"},origins:{service:{name:"fields"},"web-map":{write:{target:"layerDefinition.fields",overridePolicy:HF}}}}})],ke.prototype,"fields",void 0),d([p(GF.fieldsIndex)],ke.prototype,"fieldsIndex",void 0),d([p({type:N_e,json:{name:"formInfo",write:!0,origins:{"web-scene":{read:!1,write:!1}}}})],ke.prototype,"formTemplate",void 0),d([p({json:{read:{source:"layerDefinition.extent"}}})],ke.prototype,"fullExtent",void 0),d([p({json:{origins:{"web-map":{write:{target:"layerDefinition.geometryType",overridePolicy:HF,writer(t,e,i){const r=t?sz.toJSON(t):null;r&&ho(i,r,e)}}}},read:{source:"layerDefinition.geometryType",reader:sz.read}}})],ke.prototype,"geometryType",void 0),d([p({json:{read:{source:"layerDefinition.hasM"}}})],ke.prototype,"hasM",void 0),d([p({json:{read:{source:"layerDefinition.hasZ"}}})],ke.prototype,"hasZ",void 0),d([p(ipe)],ke.prototype,"id",void 0),d([p({readOnly:!0,json:{origins:{service:{read:!0}},read:!1}})],ke.prototype,"infoFor3D",void 0),d([p({json:{origins:{"web-map":{write:{target:"layerDefinition.type"}}}}})],ke.prototype,"isTable",void 0),d([ae("service","isTable",["type","geometryType"]),ae("isTable",["layerDefinition.type","layerDefinition.geometryType"])],ke.prototype,"readIsTable",null),d([ge("web-map","isTable")],ke.prototype,"writeIsTable",null),d([p(GL)],ke.prototype,"labelsVisible",void 0),d([p({type:[Zv],json:{origins:{service:{read:{source:"drawingInfo.labelingInfo",reader:fz},write:{target:"drawingInfo.labelingInfo",enabled:!1}}},read:{source:"layerDefinition.drawingInfo.labelingInfo",reader:fz},write:{target:"layerDefinition.drawingInfo.labelingInfo"}}})],ke.prototype,"labelingInfo",void 0),d([p((()=>{const t=U(hze);return t.json.origins["portal-item"]={write:{target:"layerDefinition.drawingInfo.transparency",writer(e,i,r){ho(r,eL(e),i)}}},t})())],ke.prototype,"opacity",void 0),d([p(x9)],ke.prototype,"legendEnabled",void 0),d([p({type:["show","hide"],json:(()=>{const t=U(rpe.json);return t.origins["portal-item"]={read:!1,write:!1},t})()})],ke.prototype,"listMode",void 0),d([ae("globalIdField",["layerDefinition.globalIdField","layerDefinition.fields"])],ke.prototype,"readGlobalIdField",null),d([p({json:{origins:{"web-map":{write:{target:"layerDefinition.objectIdField",overridePolicy:HF}}}}})],ke.prototype,"objectIdField",void 0),d([ae("objectIdField",["layerDefinition.objectIdField","layerDefinition.fields"])],ke.prototype,"readObjectIdField",null),d([p({value:"ArcGISFeatureLayer",type:["ArcGISFeatureLayer"]})],ke.prototype,"operationalLayerType",void 0),d([p(GF.outFields)],ke.prototype,"outFields",void 0),d([p({readOnly:!0})],ke.prototype,"parsedUrl",null),d([p({type:String,json:{origins:{"web-scene":{read:!0,write:!0}},read:!1}})],ke.prototype,"path",void 0),d([p(UL)],ke.prototype,"popupEnabled",void 0),d([p({type:Mp,json:{name:"popupInfo",write:!0}})],ke.prototype,"popupTemplate",void 0),d([p({readOnly:!0})],ke.prototype,"defaultPopupTemplate",null),d([p({types:kC,json:{origins:{service:{write:{target:"drawingInfo.renderer",enabled:!1}},"web-scene":{types:The,name:"layerDefinition.drawingInfo.renderer",write:{overridePolicy:(t,e,i)=>({ignoreOrigin:i==null?void 0:i.writeLayerSchema})}}},write:{target:"layerDefinition.drawingInfo.renderer",overridePolicy:(t,e,i)=>({ignoreOrigin:i==null?void 0:i.writeLayerSchema})}}})],ke.prototype,"renderer",null),d([ae("service","renderer",["drawingInfo.renderer","defaultSymbol"]),ae("renderer",["layerDefinition.drawingInfo.renderer","layerDefinition.defaultSymbol"])],ke.prototype,"readRenderer",null),d([p((()=>{const t=U(Qhe);return t.json.origins["portal-item"]={read:!1,write:!1},t})())],ke.prototype,"screenSizePerspectiveEnabled",void 0),d([p({clonable:!1})],ke.prototype,"source",null),d([tt("source")],ke.prototype,"castSource",null),d([ae("portal-item","source",["featureSet"]),ae("web-map","source",["featureSet"])],ke.prototype,"readSource",null),d([p({json:{read:{source:"layerDefinition.extent.spatialReference"}}})],ke.prototype,"spatialReference",void 0),d([p({type:Number})],ke.prototype,"subtypeCode",void 0),d([p({type:[JL]})],ke.prototype,"templates",void 0),d([ae("templates",["editFieldsInfo","creatorField","editorField","templates"])],ke.prototype,"readTemplates",null),d([p({type:Ipe})],ke.prototype,"timeInfo",void 0),d([p()],ke.prototype,"title",void 0),d([ae("service","title",["name"]),ae("portal-item","title",["layerDefinition.title","layerDefinition.name","title"])],ke.prototype,"readTitle",null),d([ae("web-map","title",["layerDefinition.name","title"])],ke.prototype,"readTitleFromWebMap",null),d([p({type:String})],ke.prototype,"sublayerTitleMode",void 0),d([p({json:{read:!1}})],ke.prototype,"type",void 0),d([p({type:String})],ke.prototype,"typeIdField",void 0),d([ae("service","typeIdField"),ae("typeIdField",["layerDefinition.typeIdField"])],ke.prototype,"readTypeIdField",null),d([p({type:[P9]})],ke.prototype,"types",void 0),d([ae("service","types",["types"]),ae("types",["layerDefinition.types"])],ke.prototype,"readTypes",null),d([p({type:Boolean,json:{origins:{"portal-item":{write:{target:"layerDefinition.defaultVisibility"}}}}})],ke.prototype,"visible",void 0),d([ae("portal-item","visible",["visibility","layerDefinition.defaultVisibility"])],ke.prototype,"readVisible",null),ke=d([A(Q_e)],ke);const ebe=ke,kTt=Object.freeze(Object.defineProperty({__proto__:null,default:ebe},Symbol.toStringTag,{value:"Module"}));let $I=null;function yat(t,e,i,r={}){const n=e.elementType,s="value",o=n.type==="array"?[{name:s,type:n.type,elementType:n.elementType}]:n.type==="dictionary"?[{name:s,type:n.type,properties:n.properties}]:[{name:s,type:n.type}];return new jot(t.map(a=>{const l={};return G7(l,o,{[s]:a},i,r),l[s]}))}function vat(t,e,i={}){const r=t instanceof Mg?new ebe({source:t.features,geometryType:t.geometryType,fields:t.fields,spatialReference:t.spatialReference}):t;return e.constructFeatureSet(r,i.spatialReference,null,!0,i.lruCache,i.interceptor)}function _at(t,e,i={}){const{spatialReference:r,interceptor:n,lruCache:s}=i;return typeof t=="string"?e.createFeatureSetCollectionFromService(t,r,s,n):e.createFeatureSetCollectionFromMap(t,r,s,n)}function bat(t,e,i,r={}){const n={};return G7(n,e.properties,t,i,r),new $I.Dictionary(n)}function G7(t,e,i,r,n={}){var o,a;const s={};for(const l of Object.keys(i))s[l.toLowerCase()]=i[l];for(const l of e){const c=l.name.toLowerCase();if(n.variablesPreProcessed)t[c]=s[c];else switch(l.type){case"array":{const u=s[c];t[c]=u==null?null:yat(u,l,r,n);break}case"feature":{const u=s[c];t[c]=u==null?null:$I.Feature.createFromGraphic(u,n==null?void 0:n.timeReference);break}case"featureSet":{const u=s[c];t[c]=u==null?null:r?vat(u,r,n):null;break}case"featureSetCollection":{const u=s[c];t[c]=u==null?null:r?_at(u,r,n):null;break}case"dictionary":{const u=s[c];t[c]=u==null?null:bat(u,l,r,n);break}case"date":{const u=s[c];t[c]=u?u instanceof BF?u:(o=n==null?void 0:n.timeReference)!=null&&o.timeZone?BF.dateJSAndZoneToArcadeDate(u,(a=n==null?void 0:n.timeReference)==null?void 0:a.timeZone):BF.dateJSToArcadeDate(u):null;break}case"geometry":case"boolean":case"text":case"number":t[c]=s[c]}}}function tbe(t,e){for(const i of t)e.push(i),i.type==="dictionary"&&tbe(i.properties,e);return e}function mte(t,e,i,r,n){const{spatialReference:s,interceptor:o,lruCache:a,console:l,abortSignal:c,timeReference:u,services:h={portal:on.getDefault()}}=i,f={vars:{},spatialReference:s,interceptor:o,timeReference:u,lrucache:a,useAsync:n,services:h,console:l,abortSignal:c};return e&&G7(f.vars,t.variables,e,r,i),f}function $O(t,e){switch(e.getArcadeType(t)){case"number":case"text":case"boolean":case"point":case"polygon":case"polyline":case"multipoint":case"extent":return t;case"date":return t.toJSDate();case"feature":{const i=(t.type,t),r="geometry"in i?i.geometry():null,n="readAttributes"in i?i.readAttributes():i.attributes;return new Or({geometry:r,attributes:n})}case"dictionary":{const i=t,r=i.attributes,n={};for(const s of Object.keys(r))n[s]=$O(i.field(s),e);return n}case"array":return("toArray"in t?t.toArray():t).map(i=>$O(i,e))}return t}const gte={variables:[{name:"$feature",type:"feature"},{name:"$layer",type:"featureSet"},{name:"$datastore",type:"featureSetCollection"},{name:"$map",type:"featureSetCollection"}]},yte={variables:[{name:"$feature",type:"feature"},{name:"$aggregatedFeatures",type:"featureSet"}]},vte=new Map([["form-constraint",{variables:[{name:"$feature",type:"feature"}]}],["feature-z",{variables:[{name:"$feature",type:"feature"}]}],["field-calculation",{variables:[{name:"$feature",type:"feature"},{name:"$datastore",type:"featureSetCollection"}]}],["form-calculation",{variables:[{name:"$feature",type:"feature"},{name:"$originalFeature",type:"feature"},{name:"$layer",type:"featureSet"},{name:"$featureSet",type:"featureSet"},{name:"$datastore",type:"featureSetCollection"},{name:"$map",type:"featureSetCollection"},{name:"$editContext",type:"dictionary",properties:[{name:"editType",type:"text"}]}]}],["labeling",{variables:[{name:"$feature",type:"feature"}]}],["popup",gte],["popup-element",gte],["feature-reduction-popup",yte],["feature-reduction-popup-element",yte],["visualization",{variables:[{name:"$feature",type:"feature"},{name:"$view",type:"dictionary",properties:[{name:"scale",type:"number"}]}]}]]);function wat(t){const e=vte.get(t);if(!e){const i=Array.from(vte.keys()).map(r=>`'${r}'`).join(", ");throw new N("createArcadeProfile:invalid-profile-name",`Invalid profile name '${t}'. You must specify one of the following values: ${i}`)}return U(e)}async function xat(t,e,i={}){$I||($I=await zd());const{arcade:r,arcadeUtils:n}=$I,{loadScriptDependencies:s,referencesMember:o,scriptIsAsync:a}=r,l=tbe(e.variables,[]),c=l.filter(S=>S.type==="featureSet"||S.type==="featureSetCollection").map(S=>S.name.toLowerCase()),u=r.parseScript(t,c);if(!u)throw new N("arcade:invalid-script","Unable to create SyntaxTree");const h=n.extractFieldNames(u),f=r.scriptTouchesGeometry(u),m=l.map(S=>S.name.toLowerCase()).filter(S=>o(u,S)),g=a(u,c);await s(u,g,c);const y={vars:{},spatialReference:null,useAsync:g};for(const S of m)y.vars[S]="any";const{lruCache:v}=i,b=r.compileScript(u,y),w=r.featureSetUtils(),{services:x}=i;return{execute:(S,I={})=>{if(g)throw new N("arcade:invalid-execution-mode","Cannot execute the script in synchronous mode");const T=b(mte(e,S,{lruCache:v,...I},w,g));return I.rawOutput?T:$O(T,n)},executeAsync:async(S,I={})=>{const T=await b(mte(e,S,{lruCache:v,services:x,...I},w,g));return I.rawOutput?T:$O(T,n)},isAsync:g,variablesUsed:m,fieldsUsed:h,geometryUsed:f,syntaxTree:u}}var ibe;const Sat=Symbol("FormExpressionArcadeExecutor");let Mo=class extends he{constructor(e){super(e),this[ibe]=!0,this._lastEvaluatedValue=null,this._abortController=new AbortController,this._stale=!1,this._updatingTracking=new nv,this._executeAsyncDebounced=Ad(async(i,r,n)=>{const s=await this.executor.executeAsync(i,{...r,abortSignal:n});return n.aborted?this._lastEvaluatedValue:(this._lastEvaluatedValue=s,this._stale=!1,s)})}get isAsync(){return this.executor.isAsync}get fieldsUsed(){return this.executor.fieldsUsed}get syntaxTree(){return this.executor.syntaxTree}get updating(){return this._updatingTracking.updating}get stale(){return this._stale}get geometryUsed(){return this.executor.geometryUsed}get variablesUsed(){return this.executor.variablesUsed}get lastEvaluatedValue(){return this._lastEvaluatedValue}abort(){this._abortController.abort()}execute(e,i){this._abortController=new AbortController;const r=this.executor.execute(e,{...i,abortSignal:this._abortController.signal});return this._lastEvaluatedValue=r,r}async executeAsync(e,i){return this._abortController=new AbortController,this._updatingTracking.addPromise(this._executeAsyncDebounced(e,i??{},this._abortController.signal))}markStale(){this._stale=!0}reset(){this.abort(),this._lastEvaluatedValue=null,this._stale=!1}};ibe=Sat,d([p()],Mo.prototype,"_lastEvaluatedValue",void 0),d([p()],Mo.prototype,"_stale",void 0),d([p()],Mo.prototype,"_updatingTracking",void 0),d([p({constructOnly:!0})],Mo.prototype,"executor",void 0),d([p()],Mo.prototype,"isAsync",null),d([p()],Mo.prototype,"fieldsUsed",null),d([p()],Mo.prototype,"syntaxTree",null),d([p()],Mo.prototype,"updating",null),d([p()],Mo.prototype,"stale",null),d([p()],Mo.prototype,"geometryUsed",null),d([p()],Mo.prototype,"variablesUsed",null),d([p()],Mo.prototype,"lastEvaluatedValue",null),Mo=d([A("esri.widgets.FeatureForm.FormExpressionArcadeExecutor")],Mo);const Iat=async(t,e)=>{const i=wat("form-calculation"),r=await xat(t,i,{});return e!=null&&e.fieldsIndex&&(r.fieldsUsed=iL(e.fieldsIndex,r.fieldsUsed)),new Mo({executor:r})},qF="#JSAPI_FORM_EXPRESSIONS_MANAGER_GEOMETRY",Tat="esri.widgets.FeatureForm.FormExpressionsManager";let rm=class extends he{constructor(e){super(e),this._fieldReferencesLookup=new Map,this._fieldsAffectedLookup=new Map,this._latestFieldValues={...e.feature.attributes}}initialize(){this._dependencyGraph=this._buildDependencyGraph()}get _baseContext(){const{editType:e,layer:i,map:r,originalFeature:n,spatialReference:s}=this.arcadeContextInfo,o=(i==null?void 0:i.type)==="feature"?i:(i==null?void 0:i.type)==="scene"&&i.associatedLayer!=null?i.associatedLayer:void 0;return[{$originalfeature:n,$editcontext:{editType:e},$layer:o,$featureset:o,$datastore:i==null?void 0:i.url,$map:r},{spatialReference:s??void 0}]}set feature(e){this._latestFieldValues={...e==null?void 0:e.attributes},this._set("feature",e)}evaluateAll(){return this._evaluate(this.executors)}evaluateExpressions(e){return this._evaluate(e)}evaluateInvalidated(e){const{_fieldReferencesLookup:i,_latestFieldValues:r,feature:n}=this,s=new Set;for(const o of e)if(r[o]=n.getAttribute(o),i.has(o))for(const a of i.get(o))s.add(a);return this._evaluate([...s])}async evaluateInvalidatedByGeometry(){if(this._fieldReferencesLookup.has(qF))return this._evaluate([...this._fieldReferencesLookup.get(qF)])}resetExecutors(){for(const e of this.executors)e.reset()}_buildDependencyGraph(){const{_fieldReferencesLookup:e,_fieldsAffectedLookup:i,executors:r}=this,n=new Map(this.fieldInputs.map(o=>[o.name,o])),s=new Map(r.map(o=>[o,new Array]));for(const o of r){for(const a of o.fieldsUsed){rw(e,a,()=>new Set).add(o);const l=n.get(a),c=l==null?void 0:l.valueExpressionExecutor,u=l==null?void 0:l.editableExpressionExecutor;c!=null&&c!==o&&(s.get(c).push(o),rw(i,c,()=>new Set).add(l)),u!=null&&u!==o&&(s.get(u).push(o),rw(i,u,()=>new Set).add(l))}o.geometryUsed&&rw(e,qF,()=>new Set).add(o)}return s}async _evaluate(e){const i=new Map,{_dependencyGraph:r,_fieldsAffectedLookup:n,_latestFieldValues:s}=this;for(const a of e)rbe(a,i,r);for(const[a,{resolver:l,dependencyPromises:c}]of i)Promise.all(c).then(async()=>{const[u,h]=this._makeContext(s);return a.executeAsync(u,h)}).then(()=>{if(n.has(a))for(const u of n.get(a))this._latestFieldValues[u.name]=u.value;l.resolve()},u=>{!u||ys(u)||_te(u)||a.markStale(),l.reject(u)});const o=(await Promise.allSettled(Array.from(i.values(),({resolver:a})=>a.promise))).filter(a=>a.status==="rejected"&&!(ys(a.reason)||_te(a.reason)));if(o.length>0)throw new AggregateError(o,"One or more expression executions failed")}_makeContext(e){const[i,r]=this._baseContext,n=this.feature.clone();return n.attributes=e,[{...i,$feature:n},r]}};d([p()],rm.prototype,"_baseContext",null),d([p()],rm.prototype,"feature",null),d([p()],rm.prototype,"executors",void 0),d([p()],rm.prototype,"fieldInputs",void 0),d([p()],rm.prototype,"arcadeContextInfo",void 0),rm=d([A(Tat)],rm);const rbe=(t,e,i)=>{if(e.has(t))return;const r=Ta();e.set(t,{resolver:r,dependencyPromises:[]}),t.abort();const n=i.get(t);for(const s of n)rbe(s,e,i),e.get(s).dependencyPromises.push(r.promise)},_te=t=>t&&typeof t=="object"&&"message"in t&&t.message==="Cancelled",nbe="esri.widgets.FeatureForm.GroupInput",bte=ie.getLogger(nbe);let nm=class extends _me{constructor(e){super(e),this._expressionTrackingHandles=new Map,this.type="group"}initialize(){this.addHandles([J(()=>[this.visible,this.inputs],([e])=>{const{inputs:i}=this,r=!!e&&void 0;for(const n of i)wm(n)&&(n.required=r)},{initial:!0,equals:(e,i)=>i[0]===e[0]&&i[1]===e[1]})])}destroy(){for(const e of this._expressionTrackingHandles.values())e.remove()}set inputFields(e){_p(bte,"Property: GroupInput.inputFields",{replacement:"GroupInput.inputs",version:"4.27"}),this.inputs=e}get inputFields(){return _p(bte,"Property: GroupInput.inputFields",{replacement:"GroupInput.inputs",version:"4.27"}),this.inputs}get inputs(){return this._get("inputs")}set inputs(e){this.handles.removeAll(),e&&this.handles.add(e.map(i=>J(()=>i.visible,()=>this._dirtyEvaluatedVisibilityExpression()))),this._set("inputs",e)}get label(){return this.element.label}set label(e){lt(this.element,i=>{i.label=e})}get state(){return this.element.initialState||"expanded"}set state(e){this._overrideIfSome("state",e)}get visible(){return this.evaluatedVisibilityExpression!==!1&&this.inputs&&this.inputs.some(e=>e.visible)}_dirtyEvaluatedVisibilityExpression(){const{element:e}=this;e.visibilityExpression&&this.notifyChange("evaluatedVisibilityExpression")}};d([p()],nm.prototype,"inputs",null),d([p()],nm.prototype,"label",null),d([p()],nm.prototype,"state",null),d([p({readOnly:!0})],nm.prototype,"type",void 0),d([p()],nm.prototype,"visible",null),nm=d([A(nbe)],nm);const Cat=nm,WF=100;let Zt=class extends Li(bg(cn(he))){constructor(e){super(e),this._loaded=!1,this._queryAbortController=null,this._queryPageAbortController=null,this._queryFeatureCountAbortController=null,this.featuresPerPage=10,this.description=null,this.graphic=null,this.layer=null,this.map=null,this.orderByFields=null,this.featureCount=0,this.relationshipId=null,this.showAllEnabled=!1,this.title=null,this._cancelQuery=()=>{const{_queryAbortController:i}=this;i&&i.abort(),this._queryAbortController=null},this._cancelQueryFeatureCount=()=>{const{_queryFeatureCountAbortController:i}=this;i&&i.abort(),this._queryFeatureCountAbortController=null},this._cancelQueryPage=()=>{const{_queryPageAbortController:i}=this;i&&i.abort(),this._queryPageAbortController=null},this._queryController=async()=>{this._cancelQuery();const i=new AbortController;this._queryAbortController=i,await $d(this._query()),this._queryAbortController===i&&(this._queryAbortController=null)},this._queryFeatureCountController=async()=>{this._loaded=!1,this._cancelQueryFeatureCount();const i=new AbortController;this._queryFeatureCountAbortController=i,await $d(this._queryFeatureCount()),this._queryFeatureCountAbortController===i&&(this._queryFeatureCountAbortController=null),this._loaded=!0},this._queryPageController=async()=>{const i=new AbortController;this._queryPageAbortController=i,await $d(this._queryPage()),this._queryPageAbortController===i&&(this._queryPageAbortController=null)},this._queryDebounced=Ad(this._queryController,WF),this._queryFeatureCountDebounced=Ad(this._queryFeatureCountController,WF),this._queryPageDebounced=Ad(this._queryPageController,WF),this._query=async()=>{const{_queryAbortController:i,relatedFeatures:r}=this;this.featureCount&&(this._destroyRelatedFeatureViewModels(),this.featurePage=1,r.removeAll(),this.destroyed||r.addMany(this._sliceFeatures(await this._queryRelatedFeatures({signal:i==null?void 0:i.signal}))))},this.handles.add([J(()=>{var i;return[this.displayCount,this.graphic,this.layer,(i=this.layer)==null?void 0:i.loaded,this.map,this.orderByFields,this.relationshipId,this.featuresPerPage,this.showAllEnabled,this.canQuery,this.featureCount]},()=>this._queryDebounced(),Le),J(()=>[this.featurePage,this.showAllEnabled],()=>this._queryPageDebounced()),J(()=>[this.layer,this.relationshipId,this.objectId,this.canQuery],()=>this._queryFeatureCountDebounced())])}destroy(){this._destroyRelatedFeatureViewModels(),this.relatedFeatures.removeAll(),this._cancelQuery(),this._cancelQueryFeatureCount(),this._cancelQueryPage()}set featurePage(e){const{featuresPerPage:i,featureCount:r}=this,n=1,s=Math.ceil(r/i)||1;this._set("featurePage",Math.min(Math.max(e,n),s))}get featurePage(){return this._get("featurePage")}get orderByFieldsFixedCasing(){const{orderByFields:e,relatedLayer:i}=this;return e&&(i!=null&&i.loaded)?e.map(r=>{const n=r.clone();return n.field=_G(r.field,i),n}):e??[]}get supportsCacheHint(){var e,i,r;return!!((r=(i=(e=this.layer)==null?void 0:e.capabilities)==null?void 0:i.queryRelated)!=null&&r.supportsCacheHint)}get canLoad(){return!!this.map&&typeof this.relationshipId=="number"&&typeof this.objectId=="number"}get canQuery(){var i,r;const e=(r=(i=this.layer)==null?void 0:i.capabilities)==null?void 0:r.queryRelated;return!!(this.relatedLayer&&this.relationship&&typeof this.relationshipId=="number"&&typeof this.objectId=="number"&&(e!=null&&e.supportsCount)&&(e!=null&&e.supportsPagination))}get itemDescriptionFieldName(){var e;return((e=this.orderByFieldsFixedCasing[0])==null?void 0:e.field)||null}set displayCount(e){this._set("displayCount",Math.min(Math.max(e,0),10))}get displayCount(){return this._get("displayCount")}get objectId(){var e,i;return(this.objectIdField&&((i=(e=this.graphic)==null?void 0:e.attributes)==null?void 0:i[this.objectIdField]))??null}get objectIdField(){var e;return((e=this.layer)==null?void 0:e.objectIdField)||null}get relatedFeatures(){return this._get("relatedFeatures")||new ye}get relatedFeatureInfos(){const{itemDescriptionFieldName:e,relatedFeatures:i,relatedLayer:r}=this;if(!i.length||!r)return[];const n=r&&"formTemplate"in r&&r.formTemplate,s=n&&(n==null?void 0:n.title)||void 0;return i.map(o=>{let a;if(e){const l=o.getAttribute(e),c=r.fieldsIndex.get(e);if(c){const u=dme([l],[c])[e];u!=null&&(a=u.toString())}}return{feature:o,description:a,title:s?Tj(s,o.attributes,r.fieldsIndex):void 0}}).toArray()}get relatedLayer(){const{layer:e,map:i,relationship:r}=this;return e!=null&&e.loaded&&i&&r?hqe(i,e,r)??null:null}get relationship(){var r;const{relationshipId:e,layer:i}=this;return typeof e=="number"?((r=i==null?void 0:i.relationships)==null?void 0:r.find(({id:n})=>n===e))??null:null}get relatedFeatureViewModels(){return this._get("relatedFeatureViewModels")||new ye}get state(){const{_queryAbortController:e,_queryFeatureCountAbortController:i,_queryPageAbortController:r,canQuery:n,_loaded:s,canLoad:o}=this;return i||o&&!s?"loading":e||r?"querying":n?"ready":"disabled"}getRelatedFeatureByObjectId(e){return this.relatedFeatures.find(i=>i.getObjectId()===e)}_destroyRelatedFeatureViewModels(){var e;(e=this.relatedFeatureViewModels)==null||e.forEach(i=>!i.destroyed&&i.destroy()),this.relatedFeatureViewModels.removeAll()}async _queryFeatureCount(){const{layer:e,relatedLayer:i,relationshipId:r,objectId:n,_queryFeatureCountAbortController:s,canQuery:o,supportsCacheHint:a}=this;if(await(e==null?void 0:e.load()),await(i==null?void 0:i.load()),!o||!e||!i)return void this._set("featureCount",0);const l=i.createQuery(),c=new gT({cacheHint:a,relationshipId:r,returnGeometry:!1,objectIds:[n],where:l.where??void 0}),u=await e.queryRelatedFeaturesCount(c,{signal:s==null?void 0:s.signal});this._set("featureCount",u[n]||0)}_sliceFeatures(e){const{showAllEnabled:i,displayCount:r}=this;return i?e:r?e.slice(0,r):[]}async _queryPage(){const{relatedFeatures:e,featurePage:i,showAllEnabled:r,_queryPageAbortController:n,featureCount:s}=this;!r||i<2||!s||e.addMany(await this._queryRelatedFeatures({signal:n==null?void 0:n.signal}))}async _queryRelatedFeatures(e){var C;const{orderByFieldsFixedCasing:i,showAllEnabled:r,featuresPerPage:n,displayCount:s,layer:o,relationshipId:a,featurePage:l,featureCount:c,relatedLayer:u,supportsCacheHint:h}=this,{canQuery:f,objectId:m}=this;if(!f||!o||!u)return[];const g=r?((l-1)*n+c)%c:0,y=r?n:s,v=u.objectIdField,b=[...i.map(E=>E.field),...PHe(u),v].filter(Dt),w=i.map(E=>`${E.field} ${E.order}`),x=u.createQuery(),S=new gT({orderByFields:w,start:g,num:y,outFields:b,cacheHint:h,relationshipId:a,returnGeometry:!1,objectIds:[m],where:x.where??void 0}),I=await o.queryRelatedFeatures(S,{signal:e==null?void 0:e.signal}),T=((C=I[m])==null?void 0:C.features)||[];return T.forEach(E=>{E.sourceLayer=u,E.layer=u}),T}};d([p()],Zt.prototype,"_loaded",void 0),d([p()],Zt.prototype,"_queryAbortController",void 0),d([p()],Zt.prototype,"_queryPageAbortController",void 0),d([p()],Zt.prototype,"_queryFeatureCountAbortController",void 0),d([p({value:1})],Zt.prototype,"featurePage",null),d([p()],Zt.prototype,"featuresPerPage",void 0),d([p({readOnly:!0})],Zt.prototype,"orderByFieldsFixedCasing",null),d([p({readOnly:!0})],Zt.prototype,"supportsCacheHint",null),d([p({readOnly:!0})],Zt.prototype,"canLoad",null),d([p({readOnly:!0})],Zt.prototype,"canQuery",null),d([p()],Zt.prototype,"description",void 0),d([p({readOnly:!0})],Zt.prototype,"itemDescriptionFieldName",null),d([p({value:3})],Zt.prototype,"displayCount",null),d([p({type:Or})],Zt.prototype,"graphic",void 0),d([p()],Zt.prototype,"layer",void 0),d([p()],Zt.prototype,"map",void 0),d([p({readOnly:!0})],Zt.prototype,"objectId",null),d([p({readOnly:!0})],Zt.prototype,"objectIdField",null),d([p()],Zt.prototype,"orderByFields",void 0),d([p({readOnly:!0})],Zt.prototype,"relatedFeatures",null),d([p({readOnly:!0})],Zt.prototype,"relatedFeatureInfos",null),d([p({readOnly:!0})],Zt.prototype,"relatedLayer",null),d([p({readOnly:!0})],Zt.prototype,"relationship",null),d([p()],Zt.prototype,"featureCount",void 0),d([p({readOnly:!0})],Zt.prototype,"relatedFeatureViewModels",null),d([p()],Zt.prototype,"relationshipId",void 0),d([p()],Zt.prototype,"showAllEnabled",void 0),d([p()],Zt.prototype,"state",null),d([p()],Zt.prototype,"title",void 0),d([p()],Zt.prototype,"getRelatedFeatureByObjectId",null),Zt=d([A("esri.widgets.Feature.FeatureRelationship.FeatureRelationshipViewModel")],Zt);const Eat=Zt,Mat=3;let Br=class extends bme{constructor(e){super(e),this._relationshipVM=null,this.group=null,this.type="relationship",this.handles.add([J(()=>({feature:this.feature,element:this.element,layer:this.layer}),i=>this._createRelationshipVM(i),Le)])}destroy(){var e;(e=this._relationshipVM)==null||e.destroy()}get canAddRelatedFeature(){const{editable:e,featureCount:i,_relationshipVM:r}=this;if(!(r!=null&&r.relationship)||!this.loaded||!this.relatedLayerAllowsAdds)return!1;const{cardinality:n,role:s}=r.relationship;return!(n==="one-to-one"&&i>0)&&n!=="many-to-many"&&!(n==="one-to-many"&&s==="destination"&&i>0)&&e}get displayCount(){return this.element.displayCount??Mat}get displayType(){return this.element.displayType}get editable(){return!!this.relatedLayerAllowsEdits&&(this.evaluatedEditableExpression??!1)}get featureCount(){var e;return((e=this._relationshipVM)==null?void 0:e.featureCount)??0}get map(){return this._get("map")}set map(e){var i;e&&((i=this._relationshipVM)==null||i.set("map",e)),this._set("map",e)}get orderByFields(){return this.element.orderByFields}get relationshipId(){return this.element.relationshipId}get relatedFeatureInfos(){var e;return((e=this._relationshipVM)==null?void 0:e.relatedFeatureInfos)??[]}get relatedLayer(){var e;return(e=this._relationshipVM)==null?void 0:e.relatedLayer}get relatedLayerAllowsAdds(){var r;const{relatedLayer:e}=this;if(!e||!this.relatedLayerAllowsEdits)return!1;const i=Ro(e);return!!((r=i==null?void 0:i.operations)!=null&&r.supportsAdd)}get relatedLayerAllowsEdits(){var r;const{relatedLayer:e}=this;if(!e)return!1;const i=Ro(e);return!!((r=i==null?void 0:i.operations)!=null&&r.supportsEditing)}get showAllEnabled(){return this._get("showAllEnabled")}set showAllEnabled(e){var i;(i=this._relationshipVM)==null||i.set("showAllEnabled",e),this._set("showAllEnabled",e)}get showAllActionVisible(){return!this.showAllEnabled&&this.featureCount>0&&this.featureCount>this.displayCount}get visible(){const{_relationshipVM:e,relatedLayer:i}=this;if(!(e!=null&&e.relationship))return!1;const{cardinality:r}=e.relationship;return r!=="many-to-many"&&!(i&&!e1(i))&&(this.evaluatedVisibilityExpression!=null?this.evaluatedVisibilityExpression:this.element!=null)}get updating(){var e,i;return((e=this._relationshipVM)==null?void 0:e.state)==="loading"||((i=this._relationshipVM)==null?void 0:i.state)==="querying"}get loaded(){var e;return((e=this._relationshipVM)==null?void 0:e.state)==="ready"}incrementPage(){this._relationshipVM&&this._relationshipVM.featurePage++}getRelatedFeatureByObjectId(e){var i;return(i=this._relationshipVM)==null?void 0:i.getRelatedFeatureByObjectId(e)}_createRelationshipVM(e){var u;const{feature:i,element:r,layer:n}=e;if((u=this._relationshipVM)==null||u.destroy(),!i||!r||!n)return;const{displayCount:s,map:o,orderByFields:a,relationshipId:l,showAllEnabled:c}=this;lR(n)&&(this._relationshipVM=new Eat({graphic:i,displayCount:s,layer:n,map:o,orderByFields:a,relationshipId:l,showAllEnabled:c}))}};d([p()],Br.prototype,"canAddRelatedFeature",null),d([p()],Br.prototype,"displayCount",null),d([p()],Br.prototype,"displayType",null),d([p()],Br.prototype,"editable",null),d([p()],Br.prototype,"group",void 0),d([p()],Br.prototype,"map",null),d([p()],Br.prototype,"orderByFields",null),d([p()],Br.prototype,"relationshipId",null),d([p()],Br.prototype,"relatedFeatureInfos",null),d([p()],Br.prototype,"relatedLayer",null),d([p()],Br.prototype,"relatedLayerAllowsAdds",null),d([p()],Br.prototype,"relatedLayerAllowsEdits",null),d([p()],Br.prototype,"showAllEnabled",null),d([p()],Br.prototype,"showAllActionVisible",null),d([p({readOnly:!0})],Br.prototype,"type",void 0),d([p()],Br.prototype,"visible",null),d([p()],Br.prototype,"updating",null),d([p()],Br.prototype,"incrementPage",null),d([p()],Br.prototype,"getRelatedFeatureByObjectId",null),Br=d([A("esri.widgets.FeatureForm.RelationshipInput")],Br);const $at=Br,JF=new Or({attributes:{}}),Aat=["editableExpression","requiredExpression","valueExpression","visibilityExpression"],kat=["visibilityExpression"],Pat=["editableExpression","visibilityExpression"],Oat="#JSAPI_CONTINGENT_VALUE_EMPTY_HASH",B_="#JSAPI_CONTINGENT_VALUE_ANY_HASH",Lat="#JSAPI_CONTINGENT_VALUE_NULL_HASH",H7="esri.widgets.FeatureForm.FeatureFormViewModel",i$=ie.getLogger(H7);let Bt=class extends cn(F1(an.EventedAccessor)){constructor(e){super(e),this._expressionExecutorLookup=new Map,this._expressionsManager=null,this._contingentValuesCache=null,this._featureClone=JF.clone(),this._initialFeature=JF.clone(),this.arcadeEditType="NA",this.contingencyConstraintViolations=new Map,this.disabled=!1,this.inputs=[],this.map=null,this.relatedRecordCallbacks=null,this.strict=!1}initialize(){const e=J(()=>{var n;return[this.layer,!!((n=this.layer)!=null&&n.loaded),this.formTemplate,this.feature,this.arcadeEditType]},([n,s])=>{n!=null&&(s?this._updateInputs():n.load().catch(()=>ie.getLogger(this).error("Failed to load layer",n.loadError)))},{equals:([n,s,o,a,l],[c,u,h,f,m])=>n===c&&s===u&&o===h&&a===f&&l===m,initial:!0}),i=J(()=>this._arcadeContextInfo,n=>{this._expressionsManager!=null&&(this._expressionsManager.arcadeContextInfo=n)}),r=J(()=>this.layer,n=>{const s=(n==null?void 0:n.type)==="subtype-sublayer"?n.parent:(n==null?void 0:n.type)==="feature"?n:null;s&&this.addResolvingPromise(Fot.createLoadedLayerContingentValuesCache(s).then(o=>{this._contingentValuesCache=o,this.notifyChange("fieldsWithContingentValues")}))},{initial:!0});this.handles.add([e,i,r])}destroy(){this.feature=null,this.layer=null,this._contingentValuesCache=je(this._contingentValuesCache)}get _expressionInfosLookup(){var e,i;return new Map((i=(e=this.formTemplate)==null?void 0:e.expressionInfos)==null?void 0:i.map(r=>[r.name,r]))}get activeRelationshipInput(){return this.allRelationshipInputs.find(e=>e.relationshipId===this.relationshipId)}get _arcadeContextInfo(){const{_initialFeature:e,arcadeEditType:i,layer:r,map:n,spatialReference:s}=this;return{layer:aC(r)?r:null,originalFeature:e,editType:i,map:n,spatialReference:s}}get allFieldInputs(){return EK(this.inputs)}get allRelationshipInputs(){return EHe(this.inputs)}get _layerFieldsByName(){var e;return new Map((e=this.layer)==null?void 0:e.fields.map(i=>[i.name,i]))}get feature(){return this._get("feature")}set feature(e){this._featureClone=e?e.clone():JF.clone(),this._initialFeature=this._featureClone.clone(),e?(this._resetFieldInputValues(this._featureClone),this.allRelationshipInputs.forEach(i=>i.feature=e)):(this.inputs.forEach(i=>i.destroy()),this.inputs.length=0),this.contingencyConstraintViolations.clear(),this._expressionsManager!=null&&(this._expressionsManager.resetExecutors(),this._expressionsManager.feature=this._featureClone,this.updatingHandles.addPromise(this._expressionsManager.evaluateAll().finally(()=>this._afterExpressionsEvaluated()))),this._set("feature",e)}get fieldsWithContingentValues(){if(this._contingentValuesCache==null)return new Set;const e=this._contingentValuesCache.fieldGroups.flatMap(i=>i.fields);return new Set(e)}get formTemplate(){return this.layer&&"formTemplate"in this.layer?this.layer.formTemplate:null}set formTemplate(e){e===void 0?this._clearOverride("formTemplate"):this._override("formTemplate",e)}get formDescription(){const{formTemplate:e,layer:i}=this;return e!=null&&e.description&&i?Tj(e.description,this.getValues(),i.fieldsIndex):null}get formTitle(){const{formTemplate:e,layer:i}=this;return e!=null&&e.title&&i?Tj(e.title,this.getValues(),i.fieldsIndex):null}formHeaderVisible(){const{activeRelationshipInput:e,formDescription:i,formTitle:r}=this;return!(e||!i&&!r)}set inputFields(e){el(i$,"inputFields",{replacement:"FeatureFormViewModel.inputs",version:"4.27"}),this.inputs=e}get inputFields(){return el(i$,"inputFields",{replacement:"FeatureFormViewModel.inputs",version:"4.27"}),this.inputs}get joinedContingentValues(){return this._joinContingentValues()}get layer(){var e;return(e=this.feature)!=null&&e.sourceLayer&&"applyEdits"in this.feature.sourceLayer?this.feature.sourceLayer:null}set layer(e){this._override("layer",e)}get relationshipId(){return this._get("relationshipId")}set relationshipId(e){const i=this.allRelationshipInputs;if(e!=null&&e===this.relationshipId||i.forEach(r=>r.showAllEnabled=!1),e!=null){const r=i.find(n=>n.relationshipId===e);r&&(r.showAllEnabled=!0)}this._set("relationshipId",e)}get spatialReference(){var e;return((e=this.layer)==null?void 0:e.spatialReference)??null}set spatialReference(e){this._override("spatialReference",e)}get state(){return this.get("layer.loaded")?"ready":"disabled"}get submittable(){return!!this.valid||this.allFieldInputs.filter(e=>!e.valid).every(({submittable:e})=>e)}get updating(){return this.updatingHandles.updating}get valid(){const e=this.allFieldInputs;return e.length>0&&e.every(({valid:i})=>i)}get view(){return el(i$,"view",{replacement:"FeatureForm.map",version:"4.27"}),this._get("view")}set view(e){el(i$,"view",{replacement:"FeatureForm.map",version:"4.27"}),this._set("view",e),e!=null&&e.map&&(this.map=e.map)}findField(e){return this.allFieldInputs.find(i=>i.name===e)}getValue(e){const{_featureClone:i,layer:r}=this,n=!!(r!=null&&r.getField(e));return i.getAttribute(e)??(n?null:void 0)}setValue(e,i){const{_featureClone:r,strict:n}=this,s=this.findField(e);i=i===""?null:i,s&&r.getAttribute(e)!==i&&(s.value=i,n&&!s.valid||(this._afterValueChange(s),this._expressionsManager!=null&&this.updatingHandles.addPromise(this._expressionsManager.evaluateInvalidated([s.name]).finally(()=>this._afterExpressionsEvaluated()))))}getValues(){return{...this._featureClone.attributes}}submit(){const e=this.allFieldInputs,i=new Set(e.filter(s=>s.valid).map(({name:s})=>s)),r=e.filter(s=>!s.valid).map(({name:s})=>s),n=this.getValues();if(this.validateContingencyConstraints(n,{includeIncompleteViolations:!0}).length>0)for(const[s,o]of this.contingencyConstraintViolations.entries())o.type==="error"&&(i.delete(s),r.push(s));this.emit("submit",{valid:[...i],invalid:r,values:n})}validateContingencyConstraints(e,i){const{_contingentValuesCache:r}=this,n=new Map;if(this.contingencyConstraintViolations=n,r==null)return[];const{invalid:s,incomplete:o}=r.validateContingencyConstraints(e),a=[...s,...i!=null&&i.includeIncompleteViolations?o:[]];for(const l of a)for(const c of l.fieldGroup.fields)n.set(c,l);return a}notifyFeatureGeometryChanged(){const{_expressionsManager:e,feature:i,_featureClone:r}=this;r.geometry=i.geometry,e!=null&&this.updatingHandles.addPromise(e.evaluateInvalidatedByGeometry().finally(()=>this._afterExpressionsEvaluated()))}_emitChangeEvent({name:e,valid:i,value:r}){this.emit("value-change",{layer:this.layer,feature:this.feature,fieldName:e,value:r,valid:i})}_updateInputs(){const{_featureClone:e,_initialFeature:i,arcadeEditType:r,formTemplate:n,inputs:s,layer:o}=this;if(!o)return;const a={arcadeEditType:r,feature:e,initialFeature:i,layer:o},l=s.slice(),c=n!=null&&n.elements&&n.elements.length>0?this._updateInputsUsingFormElements(l,n.elements,a):this._updateInputsUsingLayerFields(l,o==null?void 0:o.fields,a);this.inputs=c}_updateInputsUsingFormElements(e,i,r){const n=new Map;for(const a of e)if(eg(a)){n.set(a.element,a);for(const l of a.inputs)l.element&&n.set(l.element,l)}else a.element&&n.set(a.element,a);const s=new Map,o=this._updateInputsUsingFormElementsRecursive({existingInputsByElement:n,updatedElements:i.filter(wte),sharedInitializationProperties:r,group:null,newExpressionExecutorPromises:s});this.updatingHandles.addPromise(Promise.all(Array.from(s.values())).then(()=>{const a=Array.from(this._expressionExecutorLookup.values()),l=EK(o);return this._createExpressionsManager(a,l),this._expressionsManager.evaluateAll().finally(()=>this._afterExpressionsEvaluated())}));for(const[a,l]of n.entries())n.delete(a),l.destroy();return o}_updateInputsUsingFormElementsRecursive(e){const{existingInputsByElement:i,updatedElements:r,sharedInitializationProperties:n,group:s,newExpressionExecutorPromises:o}=e,a=[];for(const l of r){const c=i.has(l),u=c?i.get(l):V5(l)?this._makeGroupInputFromElement(l,n):lme(l)?this._makeFieldInputFromElement(l,n,s):CK(l)?this._makeRelationshipInputFromElement(l,n,s):null;if(u){if(a.push(u),c)if(i.delete(l),eg(u)){const{feature:h}=n;u.set({feature:h})}else if(Rw(u)){const h=this.relationshipId===l.relationshipId;u.set(n),u.set({map:this.map,showAllEnabled:h})}else u.set(n);else this._assignExpressionExecutors(u,l,o);if(V5(l)){const h=l.elements.filter(f=>wte(f));u.inputs=this._updateInputsUsingFormElementsRecursive({existingInputsByElement:i,updatedElements:h,sharedInitializationProperties:n,group:u,newExpressionExecutorPromises:o})}}}return a}_updateInputsUsingLayerFields(e,i,r){if(!Array.isArray(i))return ie.getLogger(this).warn(this.declaredClass,"No attribute fields found."),[];const n=new Map;for(const u of e)if(eg(u)){for(const h of u.inputs)h.destroy();u.inputs.length=0,u.destroy()}else Rw(u)?u.destroy():wm(u)&&(u.element!==null?u.destroy():n.set(u.field,u));const s=[],{arcadeEditType:o,feature:a,initialFeature:l,layer:c}=r;for(const u of i){const h=n.get(u)??new Mj({arcadeEditType:o,field:u,feature:a,initialFeature:l,layer:c,value:(a==null?void 0:a.getAttribute(u.name))??null});s.push(h),n.delete(u)}for(const[u,h]of n.entries())n.delete(u),h.destroy();return s}_resetFieldInputValues(e){for(const i of this.allFieldInputs)i.value=e.getAttribute(i.name)}_makeFieldInputFromElement(e,i,r){const{arcadeEditType:n,feature:s,initialFeature:o,layer:a}=i,{fieldName:l}=e,c=l&&this._layerFieldsByName.get(l);return c?new Mj({arcadeEditType:n,element:e,field:c,value:(s==null?void 0:s.getAttribute(e.fieldName))??null,feature:s,initialFeature:o,layer:a,group:r}):null}_makeGroupInputFromElement(e,i){const{feature:r,layer:n}=i;return new Cat({element:e,inputs:[],feature:r,layer:n})}_makeRelationshipInputFromElement(e,i,r=null){const{map:n}=this,{feature:s,layer:o}=i;return new $at({element:e,feature:s,group:r,layer:o,map:n})}_assignExpressionExecutors(e,i,r){var o;const n=V5(i)?kat:CK(i)?Pat:Aat,s=[];for(const a of n){const l=i[a],{_expressionExecutorLookup:c}=this;if(l!=null&&l!==""){const u=`${a}Executor`,h=((o=this._expressionInfosLookup.get(l))==null?void 0:o.expression)??l;if(c.has(h))e[u]=c.get(h);else if(r.has(h)){const f=r.get(h).then(m=>(e[u]=m,m));r.set(h,f)}else{const f=Iat(h,this.layer).then(m=>(e[u]=m,c.set(h,m),m));r.set(h,f)}}}return s}_createExpressionsManager(e,i){const{_arcadeContextInfo:r,_featureClone:n}=this;this._expressionsManager=new rm({executors:e,feature:n,arcadeContextInfo:r,fieldInputs:i})}_afterValueChange(e){var u;const{name:i,value:r}=e,{_featureClone:n,formTemplate:s,layer:o}=this;if(!o)return;const a=n.getAttribute(i);n.setAttribute(i,r);const{typeFieldName:l,types:c}=Ej(o);if(i===l&&r!==a){if(o.type==="subtype-sublayer"){const f=(u=o.parent)==null?void 0:u.findSublayerForFeature(n);n.sourceLayer=this.feature.sourceLayer=f}const h=new Set;for(const f of c)if(f.domains&&typeof f.domains=="object")for(const m of Object.keys(f.domains))h.add(m);for(const f of h){const m=this.findField(f);m&&m.notifyChange("domain")}}if(s!=null){const{description:h,title:f}=s;f&&NI(f,i)&&this.notifyChange("formTitle"),h&&NI(h,i)&&this.notifyChange("formDescription")}this._emitChangeEvent(e)}_afterExpressionsEvaluated(){const{_featureClone:e}=this;for(const i of this.allFieldInputs)i.value!==e.getAttribute(i.name)&&this._afterValueChange(i)}_joinContingentValues(){const e=this._contingentValuesCache;if(e==null)return[];const{typeFieldName:i}=Ej(this.layer),r=i?this.getValue(i):null,n=[];for(const a of e.fieldGroups){const{contingencies:l,fields:c,name:u}=a,h=[];for(const f of l)f.isRetired||f.subtype!=null&&f.subtype.code!==r||h.push({values:f.values});h.length>0&&n.push({name:u,fields:c,contingencies:h})}const[s,o]=this._generateJoinPlan(n);return[...s.flatMap(a=>this._joinFieldGroupContingencies(a)),...o.flatMap(a=>a.contingencies)]}_generateJoinPlan(e){const i=new Map,r=[],n=new Set;for(const c of e)for(const u of c.fields)if(i.has(u)){const h=i.get(u),f=c,m=[h.name,f.name].sort().join("|");if(n.has(m))continue;r.push([h,f]),n.add(m),i.set(u,f)}else i.set(u,c);const s=new Set(r.flat()),o=new Set(e);for(const c of s)o.delete(c);const a=new Map,l=new Map;for(const c of new Set(r.flat())){const u=Symbol(c.name);a.set(u,new Set([c])),l.set(c,u)}for(const[c,u]of r){const h=l.get(c),f=l.get(u);if(h===f)continue;const m=a.get(h),g=a.get(f);for(const y of g)m.add(y),l.set(y,h);a.delete(f)}return[[...a.values()].map(c=>[...c]),[...o]]}_joinFieldGroupContingencies(e){var c,u;const i=e.slice(),r=i.shift();let n=i.shift(),s=this._generateJoinKey(r.fields,n.fields),o=new Set([...r.fields,...n.fields]),a=new Map;for(const h of r.contingencies){const[f]=this._hashContingency(h,s.codedValueFields,!0);a.has(f)?(c=a.get(f))==null||c.push(h):a.set(f,[h])}for(;i.length>0;){const h=new Map,f=i.shift(),m=this._generateJoinKey(o,f.fields);for(const g of n.contingencies){const[y,v]=this._hashContingency(g,s.codedValueFields),b=v?this._findMatchingContingenciesWithAnyHashMask(a,y):a.get(y);if(a.has(B_)&&(b==null||b.push(...this._findMatchingContingenciesContainingAny(g,a.get(B_),s.codedValueFields))),b!=null)for(const w of b){const x=s.rangeFields.length>0?this._joinContingenciesWithRangeDomains(w,g,s.rangeFields):this._joinContingencies(w,g);if(x==null)break;const[S]=this._hashContingency(x,m.codedValueFields,!0);h.has(S)?(u=h.get(S))==null||u.push(x):h.set(S,[x])}}a=h,n=f,s=m,o=new Set([...o,...n.fields])}const l=[];for(const h of n.contingencies){const[f,m]=this._hashContingency(h,s.codedValueFields),g=m?this._findMatchingContingenciesWithAnyHashMask(a,f):a.get(f);if(a.has(B_)&&g.push(...this._findMatchingContingenciesContainingAny(h,a.get(B_),s.codedValueFields)),g!=null)for(const y of g){const v=s.rangeFields.length>0?this._joinContingenciesWithRangeDomains(y,h,s.rangeFields):this._joinContingencies(y,h);v!=null&&l.push(v)}}return l}_joinContingencies(e,i){const r={values:{...e.values,...i.values}};for(const[n,s]of Object.entries(r.values))s.objectType==="any"&&e.values[n]!=null&&(r.values[n]=e.values[n]);return r}_joinContingenciesWithRangeDomains(e,i,r){const n=this._joinContingencies(e,i);for(const s of r){const o=e.values[s],a=i.values[s],{leftIsNull:l,rightIsNull:c,bothAreNull:u,leftIsAny:h,rightIsAny:f,bothAreAny:m,leftIsRange:g,rightIsRange:y}=this._compareObjectTypes(o.objectType,a.objectType);if(u||m)continue;if(l&&f||c&&h){n.values[s]=new ls({objectType:"null"});continue}if(l&&y||c&&g)return null;h?(o.minValue=-1/0,o.maxValue=1/0):f&&(a.minValue=-1/0,a.maxValue=1/0);const v=Math.max(o.minValue,a.minValue),b=Math.min(o.maxValue,a.maxValue);if(v>b)return null;n.values[s]=new ls({objectType:"range",minValue:v,maxValue:b})}return n}_findMatchingContingenciesContainingAny(e,i,r){return i.filter(n=>r.every(s=>{var l,c;const o=n.values[s],a=e.values[s];return o.objectType==="any"||a.objectType==="any"||((l=o.codedValue)==null?void 0:l.code)===((c=a.codedValue)==null?void 0:c.code)}))}_findMatchingContingenciesWithAnyHashMask(e,i){const r=RegExp(`${i}$`),n=[];for(const[s,o]of e){if(s===B_)break;r.test(s)&&n.push(...o)}return n}_generateJoinKey(e,i){var c;const r=Array.isArray(e)?new Set(e):e,n=Array.isArray(i)?new Set(i):i,s=r.size<n.size?r:n,o=s===r?n:r,a=new Set,l=new Set;for(const u of s)if(o.has(u)){const h=(c=this.layer)==null?void 0:c.getFieldDomain(u,{feature:this.feature});if(h==null)continue;switch(h.type){case"coded-value":a.add(u);break;case"range":l.add(u)}}return{codedValueFields:[...a],rangeFields:[...l]}}_hashContingency(e,i,r=!1){var o;if(i.length<1)return[Oat,!1];const n=[];let s=!1;for(const a of i){const l=e.values[a];if(l.objectType==="any"){if(r)return[B_,!0];s=!0,n.push(`${a}:.*`)}else l.objectType==="null"?n.push(`${a}:${Lat}`):n.push(`${a}:${(o=l.codedValue)==null?void 0:o.code}`)}return[n.sort().join("&"),s]}_compareObjectTypes(e,i){return{leftIsNull:e==="null",rightIsNull:i==="null",bothAreNull:e==="null"&&i==="null",leftIsAny:e==="any",rightIsAny:i==="any",bothAreAny:e==="any"&&i==="any",leftIsRange:e==="range",rightIsRange:i==="range"}}};function wte(t){return t.type==="field"||t.type==="group"||t.type==="relationship"||(ie.getLogger(H7).warn("form-info::unsupported-element-type","Only element types 'field', 'group' and 'relationship' are supported",`Element ${t.label} has unsupported type '${t.type}'`),!1)}d([p()],Bt.prototype,"_expressionInfosLookup",null),d([p()],Bt.prototype,"_featureClone",void 0),d([p()],Bt.prototype,"activeRelationshipInput",null),d([p()],Bt.prototype,"_arcadeContextInfo",null),d([p({readOnly:!0})],Bt.prototype,"allFieldInputs",null),d([p()],Bt.prototype,"allRelationshipInputs",null),d([p()],Bt.prototype,"_layerFieldsByName",null),d([p()],Bt.prototype,"arcadeEditType",void 0),d([p()],Bt.prototype,"contingencyConstraintViolations",void 0),d([p()],Bt.prototype,"disabled",void 0),d([p()],Bt.prototype,"feature",null),d([p()],Bt.prototype,"fieldsWithContingentValues",null),d([p({type:N_e})],Bt.prototype,"formTemplate",null),d([p()],Bt.prototype,"formDescription",null),d([p()],Bt.prototype,"formTitle",null),d([p()],Bt.prototype,"formHeaderVisible",null),d([p()],Bt.prototype,"inputs",void 0),d([p()],Bt.prototype,"inputFields",null),d([p()],Bt.prototype,"joinedContingentValues",null),d([p()],Bt.prototype,"layer",null),d([p()],Bt.prototype,"map",void 0),d([p()],Bt.prototype,"relatedRecordCallbacks",void 0),d([p()],Bt.prototype,"relationshipId",null),d([p()],Bt.prototype,"spatialReference",null),d([p()],Bt.prototype,"state",null),d([p()],Bt.prototype,"strict",void 0),d([p()],Bt.prototype,"submittable",null),d([p()],Bt.prototype,"updating",null),d([p()],Bt.prototype,"valid",null),d([p()],Bt.prototype,"view",null),d([p()],Bt.prototype,"getValues",null),d([p()],Bt.prototype,"submit",null),Bt=d([A(H7)],Bt);const sbe=Bt,xte="TT",oS="data-field-name",Ste="latn",Ite=t=>"valueAsDate"in t,obe="esri.widgets.FeatureForm",Tte=ie.getLogger(obe);let Mr=class extends di{constructor(e,i){super(e,i),this._dateFieldInputMap=new Map,this._activeInputName="",this._activeNumberFieldEdit=null,this._fieldFocusNeeded=!1,this._fieldToInitialIncompatibleDomainValue=new Map,this._switchFieldsWithInitialIncompatibleValue=new Set,this._userUpdatedFieldInputNames=new Set,this._listObserverNode=null,this._listObserver=new IntersectionObserver(r=>{r.length&&r[0].isIntersecting&&this._incrementRelatedRecordPage()},{root:window.document}),this.groupDisplay="all",this.headingLevel=2,this.messages=null,this.messagesCommon=null,this.messagesFeature=null,this.messagesTemplates=null,this.viewModel=new sbe,this._onShowAllRelatedRecordsClick=r=>{const{feature:n,relatedRecordCallbacks:s}=this;n&&(s!=null&&s.showAllRelatedRecords)&&s.showAllRelatedRecords({parentFeature:n,relationshipId:r})},this._onAddRelatedRecordsClick=(r,n)=>{const{feature:s,relatedRecordCallbacks:o}=this;s&&(o!=null&&o.addRelatedRecord)&&o.addRelatedRecord({parentFeature:s,relatedLayer:n,relationshipId:r})},this._handleInputInput=r=>{this._commitInputValue(r.currentTarget)},this._handleFormKeyDown=this._handleFormKeyDown.bind(this),this._handleInputBlur=this._handleInputBlur.bind(this),this._handleInputFocus=this._handleInputFocus.bind(this),this._handleNumberInputMouseDown=this._handleNumberInputMouseDown.bind(this),this._handleInputKeyDown=this._handleInputKeyDown.bind(this),this._handleOptionChange=this._handleOptionChange.bind(this),this._handleGroupClick=this._handleGroupClick.bind(this),this._handleSubmit=this._handleSubmit.bind(this),this._afterInputCreateOrUpdate=this._afterInputCreateOrUpdate.bind(this),this._afterDateInputCreateOrUpdate=this._afterDateInputCreateOrUpdate.bind(this)}initialize(){this.addHandles([J(()=>this.feature,()=>{const e=this._getFocusableInput("forward");this._activeInputName=(e==null?void 0:e.name)||"",this._userUpdatedFieldInputNames.clear(),this._fieldToInitialIncompatibleDomainValue.clear(),this._switchFieldsWithInitialIncompatibleValue.clear(),this._dateFieldInputMap.clear(),this._fieldFocusNeeded=!0}),this.on("submit",e=>{if(e.invalid.length>0){const[i]=e.invalid;e.invalid.forEach(r=>this._userUpdatedFieldInputNames.add(r)),this._activeInputName=i,this._fieldFocusNeeded=!0,this.scheduleRender()}}),J(()=>[this.viewModel.activeRelationshipInput,this._listObserverNode],()=>this._onObserverChange())])}loadDependencies(){return Zd({button:()=>W(()=>import("./calcite-button-63d3e2be.js"),["./calcite-button-63d3e2be.js","./form-5109e7da.js","./interactive-3cbb41b8.js","./browser-14ab28bd.js","./label2-c76d0cf4.js","./loadable-800481cb.js","./t9n-5488ec48.js","./key-a512d618.js","./observers-c8819292.js","./icon-55c3c703.js","./loader-ea07f4e7.js","./guid-40d04074.js"],import.meta.url),combobox:()=>W(()=>import("./calcite-combobox-d6351ca9.js"),["./calcite-combobox-d6351ca9.js","./filter2-55383f9a.js","./debounce-9700caea.js","./openCloseComponent-c78eaefa.js","./browser-14ab28bd.js","./form-5109e7da.js","./guid-40d04074.js","./interactive-3cbb41b8.js","./label2-c76d0cf4.js","./loadable-800481cb.js","./t9n-5488ec48.js","./key-a512d618.js","./observers-c8819292.js","./utils2-e436e645.js","./conditionalSlot-7d11aa4c.js","./icon-55c3c703.js"],import.meta.url),"combobox-item":()=>W(()=>import("./calcite-combobox-item-6c3ae3ea.js"),["./calcite-combobox-item-6c3ae3ea.js","./conditionalSlot-7d11aa4c.js","./observers-c8819292.js","./guid-40d04074.js","./interactive-3cbb41b8.js","./browser-14ab28bd.js","./utils2-e436e645.js","./icon-55c3c703.js"],import.meta.url),"combobox-item-group":()=>W(()=>import("./calcite-combobox-item-group-a06601bc.js"),["./calcite-combobox-item-group-a06601bc.js","./guid-40d04074.js","./utils2-e436e645.js"],import.meta.url),icon:()=>W(()=>import("./calcite-icon-dc1254b1.js"),["./calcite-icon-dc1254b1.js","./icon-55c3c703.js","./observers-c8819292.js"],import.meta.url),"input-date-picker":()=>W(()=>import("./calcite-input-date-picker-fcf849c9.js"),["./calcite-input-date-picker-fcf849c9.js","./t9n-5488ec48.js","./key-a512d618.js","./observers-c8819292.js","./openCloseComponent-c78eaefa.js","./browser-14ab28bd.js","./debounce-9700caea.js","./form-5109e7da.js","./interactive-3cbb41b8.js","./label2-c76d0cf4.js","./loadable-800481cb.js","./focusTrapComponent-b126d96c.js","./icon-55c3c703.js","./guid-40d04074.js","./input-73d8e593.js","./progress-f7b87c62.js"],import.meta.url),"input-message":()=>W(()=>import("./calcite-input-message-49febba8.js"),["./calcite-input-message-49febba8.js","./icon-55c3c703.js","./observers-c8819292.js"],import.meta.url),"input-time-picker":()=>W(()=>import("./calcite-input-time-picker-2206c935.js"),["./calcite-input-time-picker-2206c935.js","./form-5109e7da.js","./guid-40d04074.js","./interactive-3cbb41b8.js","./browser-14ab28bd.js","./key-a512d618.js","./label2-c76d0cf4.js","./loadable-800481cb.js","./t9n-5488ec48.js","./observers-c8819292.js","./focusTrapComponent-b126d96c.js","./icon-55c3c703.js","./action-6ac56df8.js","./loader-ea07f4e7.js","./input-73d8e593.js","./progress-f7b87c62.js","./popover-f35958eb.js","./openCloseComponent-c78eaefa.js","./debounce-9700caea.js","./FloatingArrow-ab842880.js"],import.meta.url),list:()=>W(()=>import("./calcite-list-0080b921.js"),["./calcite-list-0080b921.js","./interactive-3cbb41b8.js","./browser-14ab28bd.js","./observers-c8819292.js","./utils3-9c594b4c.js","./loadable-800481cb.js","./filter2-55383f9a.js","./debounce-9700caea.js","./t9n-5488ec48.js","./key-a512d618.js","./icon-55c3c703.js","./input-73d8e593.js","./form-5109e7da.js","./label2-c76d0cf4.js","./progress-f7b87c62.js","./loader-ea07f4e7.js","./guid-40d04074.js","./scrim-61cfb0a8.js"],import.meta.url),"list-item":()=>W(()=>import("./calcite-list-item-d246eaec.js"),["./calcite-list-item-d246eaec.js","./interactive-3cbb41b8.js","./browser-14ab28bd.js","./utils3-9c594b4c.js","./t9n-5488ec48.js","./key-a512d618.js","./observers-c8819292.js","./loadable-800481cb.js","./action-6ac56df8.js","./guid-40d04074.js","./icon-55c3c703.js","./loader-ea07f4e7.js"],import.meta.url),loader:()=>W(()=>import("./calcite-loader-1e6cb0b1.js"),["./calcite-loader-1e6cb0b1.js","./loader-ea07f4e7.js","./guid-40d04074.js"],import.meta.url),notice:()=>W(()=>import("./calcite-notice-ef4471ac.js"),["./calcite-notice-ef4471ac.js","./conditionalSlot-7d11aa4c.js","./observers-c8819292.js","./loadable-800481cb.js","./t9n-5488ec48.js","./key-a512d618.js","./icon-55c3c703.js"],import.meta.url),progress:()=>W(()=>import("./calcite-progress-97fda67a.js"),["./calcite-progress-97fda67a.js","./progress-f7b87c62.js"],import.meta.url),switch:()=>W(()=>import("./calcite-switch-6eabe4df.js"),["./calcite-switch-6eabe4df.js","./form-5109e7da.js","./interactive-3cbb41b8.js","./browser-14ab28bd.js","./key-a512d618.js","./label2-c76d0cf4.js","./loadable-800481cb.js"],import.meta.url)})}destroy(){this._listObserverNode&&this._listObserver.unobserve(this._listObserverNode)}get _relatedRecordsEnabled(){const e=this.relatedRecordCallbacks;return!(!e||!(e.addRelatedRecord||e.editRelatedRecord||e.showAllRelatedRecords))}get disabled(){return this.viewModel.disabled}set disabled(e){this.viewModel.disabled=e}get feature(){return this.viewModel.feature}set feature(e){this.viewModel.feature=e}get formTemplate(){return this.viewModel.formTemplate}set formTemplate(e){this.viewModel.formTemplate=e}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get layer(){return this.viewModel.layer}set layer(e){this.viewModel.layer=e}get map(){return this.viewModel.map}set map(e){this.viewModel.map=e}get relatedRecordCallbacks(){return this.viewModel.relatedRecordCallbacks}set relatedRecordCallbacks(e){this.viewModel.relatedRecordCallbacks=e}get relationshipId(){return this.viewModel.relationshipId}set relationshipId(e){this.viewModel.relationshipId=e}get spatialReference(){return this.viewModel.spatialReference}set spatialReference(e){this.viewModel.spatialReference=e}get strict(){return this.viewModel.strict}set strict(e){this.viewModel.strict=e}get view(){return el(Tte,"view",{replacement:"Use FeatureForm.map instead.",version:"4.27"}),this.viewModel.view}set view(e){el(Tte,"view",{replacement:"Use FeatureForm.map instead.",version:"4.27"}),this.viewModel.view=e}getValues(){return this.viewModel.getValues()}submit(){return this.viewModel.submit()}render(){const{state:e}=this.viewModel;return M("div",{class:this.classes(pt.base,pt.widget,pt.panel)},e==="ready"?this._renderForm():null)}_renderForm(){return M("form",{class:pt.form,novalidate:!0,onsubmit:this._handleSubmit,onkeydown:this._handleFormKeyDown},this._renderHeader(),this._renderInputs())}_renderHeader(){const e=this.viewModel;if(!e.formHeaderVisible)return;const i=e.formTitle!=null&&M(Ql,{key:"title",level:this.headingLevel},e.formTitle),r=e.formDescription!=null&&M("p",{class:pt.description,key:"description"},e.formDescription);return M("div",{class:pt.formHeader},i,r)}_renderInputs(){const{viewModel:e}=this;return e.activeRelationshipInput?this._renderActiveRelationshipInput(e.activeRelationshipInput):e.inputs.filter(Dt).filter(i=>i.visible).map((i,r)=>eg(i)?this._renderGroup(i,r):wm(i)?this._renderLabeledField(i):Rw(i)?this._renderRelationshipInput(i):void 0)}_renderActiveRelationshipInput(e){return this._renderRelationshipInput(e)}_renderDescriptionOrEmpty(e,i){return e==null?null:M("div",{class:this.classes(pt.description),id:i},e)}_renderGroup(e,i){const{formTemplate:r,disabled:n}=this,{description:s,inputs:o,label:a,state:l}=e,c=o.filter(x=>x.visible),u=this.viewModel.findField(this._activeInputName),h=!(!u||u.group!==e),f=`${this.id}_group_${i}`,m=`${this.id}_group-label_${i}`,g=`${this.id}_group-description_${i}`,y=this._renderDescriptionOrEmpty(s,g),v=this.groupDisplay==="sequential",b=v?h:l==="expanded",w=b?pt.collapseIcon:pt.expandIcon;return M("fieldset",{"aria-expanded":b.toString(),"aria-labelledby":m,"aria-describedby":s?g:"",class:this.classes(pt.group,v?pt.groupSequential:null,b?null:pt.groupCollapsed,h?pt.groupActive:null,n?pt.inputDisabled:null),disabled:n,"data-group":e,id:f,key:i,onclick:this._handleGroupClick},M("button",{role:v?"presentation":void 0,class:pt.groupHeader,type:"button",tabIndex:v?-1:0},M("div",{class:pt.groupTitle},M(Ql,{class:pt.groupLabel,id:m,level:r!=null&&r.title?pw(this.headingLevel):this.headingLevel},a),y),v?null:M("span",{class:this.classes(w,pt.groupToggleIcon)})),c.map(x=>wm(x)?this._renderLabeledField(x):Rw(x)?this._renderRelationshipInput(x):void 0))}_getFocusableInput(e,i){const r=this.viewModel.allFieldInputs,n=e==="forward"?r:r.slice().reverse();let s;if(!i||Rw(i))s=0;else if(eg(i)){const o=i.inputs.find(wm);s=o?n.indexOf(o):0}else{let o;if(N5(i)&&i.group.state==="collapsed"){const a=i.group.inputs.filter(wm);o=e==="forward"?a[a.length-1]:a[0]}else o=i;s=n.indexOf(o)+1}for(let o=s;o<n.length;o++){const a=n[o];if(a.visible&&wm(a))return a}return null}_renderLabeledField(e){const{dataType:i,feature:r,label:n,layer:s}=e;return M("label",{key:`${s.id}-${r.uid}-${e.name}`,class:pt.label},[n,i!=="unsupported"?this._renderFieldInput(e):this._renderUnsupportedField(e),this._renderAuxiliaryText(e)])}_renderFieldInput(e){const{dataType:i,domain:r,name:n,updating:s,value:o}=e,a=this.getCommonInputProps(e);if((r==null?void 0:r.type)==="coded-value"){if(R0(e.element,"switch")){const{element:c}=e;if(!(this._switchFieldsWithInitialIncompatibleValue.has(n)||o==null||c.input.onValue!==o&&c.input.offValue!==o))return this._renderSwitchFieldInput(e,a);this._switchFieldsWithInitialIncompatibleValue.add(n)}return e.inputType==="radio-buttons"?this._renderRadioButtonsFieldInput(e,r.codedValues.map(({code:c,name:u})=>({value:c,name:u})),a):this._renderSelectFieldInput(e,this._getFieldValueOptions(n,r),a)}if(e.inputType==="datetime-picker"||i==="date")return this._renderDateFieldInput(e,a);const l=i==="number"?M("input",{type:"number",...a,value:this._activeNumberFieldEdit!=null&&this._activeNumberFieldEdit.fieldName===e.name?this._activeNumberFieldEdit.value:`${a.value}`}):e.inputType==="text-area"?M("textarea",{...a}):M("input",{type:"text",...a});return s?M("div",{key:`${a.key}-input-updating-wrapper`,class:pt.fieldInputWrapper},l,M("div",{class:pt.fieldInputLoader},M("calcite-progress",{type:"indeterminate"}))):l}_renderDateFieldInput(e,i){const{dateDataType:r,includeTime:n,label:s,name:o,valid:a,value:l}=e,{readOnly:c,required:u}=i;if(r==="string")return this._renderUnsupportedField(e,vG(e.field,i.value));const{date:h,time:f}=this._formatValueForDateInputs(l),m=i.max!=null?this._formatValueForDateInputs(i.max):void 0,g=i.min!=null?this._formatValueForDateInputs(i.min):void 0,y=(m==null?void 0:m.date)??void 0,v=(g==null?void 0:g.date)??void 0,b={afterCreate:this._afterDateInputCreate,afterUpdate:this._afterDateInputCreateOrUpdate,"aria-invalid":!a,label:s,numberingSystem:Ste,overlayPositioning:"fixed",readOnly:c,required:u,tabIndex:0,[oS]:o};return M("div",{key:`${i.key}-date-time-container`,class:pt.dateInputContainer},M("calcite-input-date-picker",{bind:this,...b,class:this.classes(i.class,pt.inputDate),"data-date-part":"date",key:`${i.key}-date-input`,valueAsDate:h??void 0,maxAsDate:y,minAsDate:v,onCalciteInputDatePickerChange:w=>this._commitDateChanges(w.target),onblur:w=>this._commitDateChanges(w.target,!0)}),n?M("calcite-input-time-picker",{bind:this,...b,class:this.classes(i.class,pt.inputTime),"data-date-part":"time",key:`${i.key}-time-input`,value:f??void 0,step:1,onCalciteInputTimePickerChange:w=>this._commitDateChanges(w.target),onfocus:w=>{w.target.calciteTimePickerEl&&(w.target.calciteTimePickerEl.showSecond=!0)},onblur:w=>this._commitDateChanges(w.target,!0)}):null)}_renderUnsupportedField(e,i){const r=this.getCommonInputProps(e);return M("input",{afterCreate:r.afterCreate,afterUpdate:r.afterUpdate,class:this.classes(pt.input,pt.fieldInput,pt.inputDisabled),onfocus:r.onfocus,readOnly:!0,tabIndex:r.tabIndex,type:"text",value:i!=null?`${i}`:r.value,[oS]:r[oS]})}_renderSelectFieldInput(e,i,r){var v;const{element:n,required:s,value:o}=e,{messages:a,messagesTemplates:l}=this,c=i.map(b=>b.map(w=>M("calcite-combobox-item",{value:`${w.value}`,textLabel:w.name,key:`#${w.value}`,selected:o===w.value}))),[u,h]=c;this._registerIncompatibleValue(o,i.flat(),e,b=>{h.unshift(M("calcite-combobox-item",{value:`${b}`,textLabel:`${b}`,key:"incompatible-option",readOnly:!0}))});const f=h.length>0?[M("calcite-combobox-item-group",{key:"recommended",label:a.recommended},u),M("calcite-combobox-item-group",{key:"other",label:l.other},h)]:u,m=n==null,g=R0(n,"combo-box"),y=m||g&&((v=n.input)==null?void 0:v.showNoValueOption);if(!s&&y){const b="",w=g&&n.input.noValueOptionLabel||a.empty;f.unshift(M("calcite-combobox-item",{value:b,textLabel:a.empty,key:"empty-option"},w))}return M("calcite-combobox",{...r,selectionMode:"single",disabled:r.readOnly,allowCustomValues:!1,clearDisabled:!0,onCalciteComboboxChange:b=>this._handleOptionChange(b.target)},f)}_registerIncompatibleValue(e,i,r,n){const s=this._fieldToInitialIncompatibleDomainValue,o=s.has(r.name);(o||e!=null&&e!==""&&!i.some(a=>a.value===e))&&(o||s.set(r.name,e),n==null||n(e))}_renderRadioButtonsFieldInput(e,i,r){var f;const{element:n,name:s,required:o,value:a}=e,l=i.map(m=>this._renderRadioButton({key:m.name,label:m.name,name:s,value:m.value,selected:m.value===a,props:r}));this._registerIncompatibleValue(a,i,e);const c=n==null,u=R0(n,"radio-buttons"),h=c||u&&((f=n.input)==null?void 0:f.showNoValueOption);if(!o&&h){const m="",g=u&&n.input.noValueOptionLabel||this.messages.empty,y=a===m||a===null;l.unshift(this._renderRadioButton({key:"empty-option",label:g,name:s,value:m,selected:y,props:r}))}return M("div",{key:`${r.key}-radio`,class:pt.inputRadioGroup},l)}_renderSwitchFieldInput(e,i){const{value:r}=e,n=!!R0(e.element,"switch")&&r===e.element.input.onValue;return M("calcite-switch",{...i,class:pt.inputSwitch,onCalciteSwitchChange:s=>this._commitInputValue(s.target),checked:n,disabled:i.readOnly})}_renderRadioButton({key:e,name:i,value:r,selected:n,label:s,props:o}){return M("label",{key:e,class:pt.inputRadioLabel},M("input",{...o,class:pt.inputRadio,name:i,type:"radio",value:r,checked:n,disabled:o.readOnly,onchange:a=>this._commitInputValue(a.target)}),s)}_renderAuxiliaryText(e){const i=this._userUpdatedFieldInputNames.has(e.name)&&!e.valid?AHe(e,this.messages):this.viewModel.contingencyConstraintViolations.get(e.name)!=null?this.messages.validationErrors.valuesIncompatible:e.valueExpressionExecutor!=null&&e.valueExpressionExecutor.stale?this.messages.valueExpressionError:null;return i!=null?M("calcite-input-message",{status:"invalid",icon:!0},i):this._renderDescriptionOrEmpty(e.description)}_renderShowAllRelatedRecordsListItem(e){const{featureCount:i,relationshipId:r,showAllActionVisible:n}=e,{relatedRecordCallbacks:s}=this;if(!n||!(s!=null&&s.showAllRelatedRecords))return;const o=this.messages;return M("calcite-list-item",{description:Os(o.totalCount,{count:i}),label:o.showAll,value:!0,onCalciteListItemSelect:()=>this._onShowAllRelatedRecordsClick(r)},M("calcite-icon",{slot:"content-end",scale:"s",icon:"list"}))}_renderAddRelatedRecordButton(e){const{canAddRelatedFeature:i,relationshipId:r,relatedLayer:n}=e,{relatedRecordCallbacks:s}=this;if(i&&(s!=null&&s.addRelatedRecord)&&n)return M("calcite-button",{alignment:"center",appearance:"outline-fill",class:pt.centeredButton,disabled:e.updating,iconStart:"plus",key:`${r}-add-button`,round:!0,scale:"s",width:"half",onclick:()=>this._onAddRelatedRecordsClick(r,n)},this.messages.addRecord)}_renderRelatedRecordListItem(e,i){const{feature:r,description:n,title:s}=e,{feature:o,relatedRecordCallbacks:a}=this,l=()=>{a!=null&&a.editRelatedRecord&&o&&a.editRelatedRecord({parentFeature:o,relationshipId:i,relatedFeature:r})};return M("calcite-list-item",{bind:this,description:n,label:s,key:`${i}-${r.uid}`,value:s,onclick:l},M("calcite-icon",{slot:"content-start",scale:"m",icon:kHe(r)}),M("calcite-icon",{slot:"content-end",scale:"s",icon:"chevron-right"}))}_renderRelationshipInput(e){if(!this._relatedRecordsEnabled||!e.editable)return;const{featureCount:i,relationshipId:r,showAllEnabled:n}=e,s=n?null:this._renderDescriptionOrEmpty(e.description),o=i>0?this._renderRelatedRecordsList(e):e.loaded?this._renderNoRelatedRecordsNotice():void 0;return M("label",{class:this.classes(pt.label,pt.relationshipLabel),key:`relationship-${r}-container`},M("div",null,this._renderRelatedRecordsHeaderContainer(e),s,o),this._renderAddRelatedRecordButton(e))}_renderRelatedRecordsHeaderContainer(e){var r;const i=e.updating||!e.loaded;return M("div",{class:pt.relatedRecordsHeader,key:`relationship-${e.relationshipId}-header`},M("span",null,e.label),i?M("calcite-loader",{label:(r=this.messagesCommon)==null?void 0:r.loading,inline:!0,key:"loader",scale:"s",type:"indeterminate"}):void 0)}_renderRelatedRecordsList(e){const{relationshipId:i}=e;return M("calcite-list",{class:pt.relatedRecordsList},e.relatedFeatureInfos.map(r=>this._renderRelatedRecordListItem(r,i)),this._renderShowAllRelatedRecordsListItem(e),this._renderObserverNode())}_renderNoRelatedRecordsNotice(){return M("calcite-notice",{open:!0,scale:"s",kind:"brand",icon:"information",width:"full"},M("div",{slot:"message"},this.messagesFeature.noRelatedFeatures))}_renderObserverNode(){var e;if((e=this.viewModel.activeRelationshipInput)!=null&&e.showAllEnabled)return M("div",{key:"feature-observer",class:pt.listObserver,bind:this,afterCreate:this._afterListObserverCreated,afterRemoved:this._afterListObserverRemoved})}getCommonInputProps(e){const{disabled:i,groupDisplay:r}=this,{dataType:n,editable:s,group:o,hint:a,label:l,maxLength:c,minLength:u,name:h,required:f,valid:m,value:g}=e,y=this._userUpdatedFieldInputNames.has(h),v=!s||i,b=r==="all"&&o!=null&&o.state==="collapsed";return{afterCreate:this._afterInputCreateOrUpdate,afterUpdate:this._afterInputCreateOrUpdate,"aria-invalid":m?"false":"true",class:this.classes(pt.input,pt.fieldInput,v?pt.inputDisabled:null,y&&!m?pt.inputInvalid:null),key:h,label:l,minlength:u>-1?`${u}`:"",maxlength:c>-1?`${c}`:"",...e.range,readOnly:v,value:g==null?"":`${g}`,[oS]:h,onfocus:this._handleInputFocus,oninput:this._handleInputInput,onblur:this._handleInputBlur,onkeydown:this._handleInputKeyDown,onmousedown:n==="number"?this._handleNumberInputMouseDown:void 0,placeholder:n==="number"||n==="text"?a??void 0:"",required:f,tabIndex:b?-1:0}}_handleNumberInputMouseDown({target:e}){e.focus(),this.scheduleRender()}_getFieldValueOptions(e,i){const r=i.codedValues.map(({code:s,name:o})=>({value:s,name:o})),n=this.viewModel.fieldsWithContingentValues.has(e)?this._getContingentValueOptions(e):[];if(n.length>0){const s=new Set(n.map(o=>o.value));return[n,r.filter(o=>!s.has(o.value))]}return[r,[]]}_getContingentValueOptions(e){const i={};for(const s of this.viewModel.allFieldInputs){const{name:o,value:a}=s;a!=null&&o!==e&&this.viewModel.fieldsWithContingentValues.has(o)&&(i[o]=a)}const r=this.viewModel.joinedContingentValues.slice(),n=new Map;for(const s of r){const o=s.values[e];if(o==null||o.objectType!=="code"&&o.objectType!=="null")continue;const{code:a,name:l}=o.codedValue&&o.objectType!=="null"?o.codedValue:{code:"",name:this.messages.empty};n.has(a)||Object.entries(i).every(([c,u])=>!s.values.hasOwnProperty(c)||this._valueIsValidContingentValue(u,s.values[c]))&&n.set(a,{name:l,value:a})}return[...n.values()]}_getFieldInputFromHTMLElement(e){return this.viewModel.findField(e.getAttribute(oS))}async _afterDateInputCreate(e){this._afterDateInputCreateOrUpdate(e)}_afterDateInputCreateOrUpdate(e){const{name:i}=this._getFieldInputFromHTMLElement(e),r=this._dateFieldInputMap.get(i),n=Ite(e);r!=null?n?r.date=e:r.time=e:this._dateFieldInputMap.set(i,{[n?"date":"time"]:e}),this._afterInputCreateOrUpdate(e)}_afterInputCreateOrUpdate(e){const{viewModel:i}=this,r=this._getFieldInputFromHTMLElement(e),n=i.findField(this._activeInputName),s=this._fieldToInitialIncompatibleDomainValue.get(r.name)===r.value;this._fieldFocusNeeded&&n===r&&(r.inputType!=="radio-buttons"||s||e.checked)&&(this._fieldFocusNeeded=!1,N5(r)&&(r.group.state="expanded"),e.focus())}_handleInputFocus(e){const i=e.target,r=this._getFieldInputFromHTMLElement(i);this._activeInputName=r.name,$K(r)&&(this._activeNumberFieldEdit={fieldName:r.name,input:i,value:i.value})}_handleInputBlur(e){const i=e.target,r=this._getFieldInputFromHTMLElement(i);r.dataType==="number"&&this._activeNumberFieldEdit!=null&&(this._activeNumberFieldEdit.input.value=`${r.value}`,this._activeNumberFieldEdit=null),this._commitInputValue(i),this.scheduleRender()}_commitDateChanges(e,i=!1){const{name:r}=this._getFieldInputFromHTMLElement(e);if(!this._dateFieldInputMap.has(r))return;const n=this._dateFieldInputMap.get(r);if(!n||!n.date)return;const s=this._getFieldValueFromDateInput(e),o=this._getFieldValueFromDateInputs(n.date,n.time);this.viewModel.getValue(r)!==o&&(s!==null&&o!==null?this._updateFieldValue(r,o):i&&this._updateFieldValue(r,null))}_commitInputValue(e){const i=this._getFieldInputFromHTMLElement(e);this._activeNumberFieldEdit!=null&&$K(i)&&(this._activeNumberFieldEdit.value=e.value),this._updateFieldValue(i.name,this._parseValue(e))}_handleInputKeyDown(e){const{key:i,altKey:r,ctrlKey:n,metaKey:s}=e,o=this._getFieldInputFromHTMLElement(e.target);if(i==="Enter")N5(o)&&o.group.state==="collapsed"&&(o.group.state="expanded");else{const{type:a}=o.field,l=a==="single"||a==="double";if((a==="integer"||a==="small-integer"||l)&&!r&&!n&&!s&&i.length===1){const c=Number(i),u=["-","+"],h=["e","."],f=l?[...u,...h]:u;isNaN(c)&&!f.includes(i)&&e.preventDefault()}}}_updateFieldValue(e,i){if(this.viewModel.setValue(e,i),this._userUpdatedFieldInputNames.add(e),this.viewModel.fieldsWithContingentValues.has(e)){const r=Object.fromEntries(Object.entries(this.getValues()).filter(([n,s])=>s!=null));this.viewModel.validateContingencyConstraints(r)}}_parseValue(e){const i=this._getFieldInputFromHTMLElement(e),r=e.value;if(R0(i.element,"switch")&&e.tagName!=="CALCITE-COMBOBOX")return e.checked?i.element.input.onValue:i.element.input.offValue;if(i.inputType==="radio-buttons"&&e.type==="radio"&&!e.checked)return i.value;const{dataType:n}=i;return n==="number"?r?parseFloat(r):null:r}_handleOptionChange(e){this._commitInputValue(e),this.scheduleRender()}_handleGroupClick(e){var o;const i=e.currentTarget["data-group"],r=i.state==="expanded",n=this.groupDisplay==="sequential",s=`.${pt.groupHeader}`;if(!(r&&!e.target.closest(s))){if(this._activeInputName=((o=this._getFocusableInput("forward",i))==null?void 0:o.name)||"",n){const a=e.target.closest(s);if(r&&!a)return;this.viewModel.inputs.forEach(l=>{eg(l)&&l!==i&&(l.state="collapsed")})}i.state=r?"collapsed":"expanded",this._fieldFocusNeeded=n,this.scheduleRender()}}_handleSubmit(e){e.preventDefault()}_handleFormKeyDown(e){e.key==="Enter"&&this.viewModel.submit()}_getDefaultLocaleOptions(){return{locale:Mn(),numberingSystem:Ste}}_getFieldValueFromDateInputs(e,i){const r=this._getDateTimeFromInput(e),n=this._getDateTimeFromInput(i);if(!r&&!n)return null;const s=this._getFieldInputFromHTMLElement(e).range,o=Date.now(),a=s.max!=null&&s.max<o?s.max:o,l=Ae.fromMillis(a,this._getDefaultLocaleOptions()),c=r||l,{year:u,month:h,day:f}=c,{hour:m,minute:g,second:y}=n||l,v=c.set({year:u,month:h,day:f,hour:m,minute:g,second:y});return v.isValid?v.toMillis():null}_getDateTimeFromInput(e){if(!e)return null;let i=null;if(Ite(e)){const r=e.valueAsDate;if(!r||Array.isArray(r))return null;i=Ae.fromJSDate(r)}else{if(!e.value)return null;i=Ae.fromFormat(e.value,xte,this._getDefaultLocaleOptions())}return i??null}_getFieldValueFromDateInput(e){return this._dateTimeToFieldValue(this._getDateTimeFromInput(e))}_dateTimeToFieldValue(e){return e!=null&&e.isValid?e.toMillis():null}_dateTimeFromFieldValue(e){return e===null?null:Ae.fromMillis(e,this._getDefaultLocaleOptions())}_formatValueForDateInputs(e){if(e==null||isNaN(e))return{date:null,time:null};const i=this._dateTimeFromFieldValue(e);return i?{date:i.toJSDate(),time:i.toFormat(xte,this._getDefaultLocaleOptions())}:{date:null,time:null}}_valueIsValidContingentValue(e,i){var r;switch(i.objectType){case"any":return!0;case"null":return e==null;case"code":return e===((r=i.codedValue)==null?void 0:r.code);case"range":return e!=null&&i.minValue!=null&&i.maxValue!=null&&+e>=i.minValue&&+e<=i.maxValue;default:return i.objectType,!1}}_afterListObserverCreated(e){this.viewModel.activeRelationshipInput&&(this._listObserverNode=e)}_afterListObserverRemoved(){this._listObserverNode=null}async _onObserverChange(){this._listObserverNode&&this._listObserver.unobserve(this._listObserverNode);const e=this.viewModel.activeRelationshipInput;if(!e)return;const{showAllEnabled:i,updating:r}=e;this._listObserverNode&&!r&&i&&this._listObserver.observe(this._listObserverNode)}_incrementRelatedRecordPage(){const e=this.viewModel.activeRelationshipInput;e==null||e.incrementPage()}};d([p()],Mr.prototype,"_listObserverNode",void 0),d([p()],Mr.prototype,"_relatedRecordsEnabled",null),d([p()],Mr.prototype,"disabled",null),d([p()],Mr.prototype,"feature",null),d([p()],Mr.prototype,"formTemplate",null),d([p()],Mr.prototype,"groupDisplay",void 0),d([p()],Mr.prototype,"headingLevel",void 0),d([p()],Mr.prototype,"label",null),d([p()],Mr.prototype,"layer",null),d([p()],Mr.prototype,"map",null),d([p(),ut("esri/widgets/FeatureForm/t9n/FeatureForm")],Mr.prototype,"messages",void 0),d([p(),ut("esri/t9n/common")],Mr.prototype,"messagesCommon",void 0),d([p(),ut("esri/widgets/Feature/t9n/Feature")],Mr.prototype,"messagesFeature",void 0),d([p(),ut("esri/widgets/FeatureTemplates/t9n/FeatureTemplates")],Mr.prototype,"messagesTemplates",void 0),d([p()],Mr.prototype,"relatedRecordCallbacks",null),d([p()],Mr.prototype,"relationshipId",null),d([p()],Mr.prototype,"spatialReference",null),d([p()],Mr.prototype,"strict",null),d([p()],Mr.prototype,"view",null),d([p(),BC(["value-change","submit"])],Mr.prototype,"viewModel",void 0),Mr=d([A(obe)],Mr);const Rat=Mr;var s6;const Fat="esri.widgets.FeatureTemplates.TemplateItem";let ld=s6=class extends he{constructor(t){super(t),this._activeFetchInfo={id:null,request:null},this.layer=null,this.template=null,this.thumbnail=null}initialize(){this.addHandles(J(()=>{const{layer:t}=this;return[t&&"renderer"in t?t.renderer:null,this.template]},()=>{this._activeFetchInfo.id=null,this._activeFetchInfo.request=null,this._set("thumbnail",null)},Le))}get description(){var t;return(t=this.template)==null?void 0:t.description}set description(t){this.template&&(this.template.description=t)}get label(){var t;return(t=this.template)==null?void 0:t.name}set label(t){this.template&&(this.template.name=t)}get id(){var t;return`${this.label??""}–${(t=this.layer)==null?void 0:t.id}`}get supportsUpload(){return this.layer.type==="scene"}clone(){const t=this.thumbnail!=null?this.thumbnail.cloneNode(!0):null,e=new s6({layer:this.layer,template:this.template});return e._set("thumbnail",t),e}static async fetchThumbnail(t,e){var n;const i=await Dat(t,e);if(i==null)return null;const r={maxSize:36};return((n=t.renderer)==null?void 0:n.type)==="dictionary"&&(r.fieldMap=t.renderer.fieldMap??void 0,r.feature={attributes:e.prototype.attributes??{}}),await XG(i,r)}};async function Dat(t,e){const{renderer:i}=t;if(i){const r=new Or({attributes:e.prototype.attributes}),n=await i.getSymbolAsync(r);if(n)return n}return Nat(t)}async function Nat(t){const{geometryType:e}=t,i=e==="point"||e==="multipoint"?await W(()=>Promise.resolve().then(()=>qAe),void 0,import.meta.url):e==="polyline"?await W(()=>Promise.resolve().then(()=>aAe),void 0,import.meta.url):e==="polygon"||e==="mesh"||e==="multipatch"?await W(()=>Promise.resolve().then(()=>HAe),void 0,import.meta.url):null;return i?new i.default:null}d([p()],ld.prototype,"description",null),d([p()],ld.prototype,"label",null),d([p()],ld.prototype,"layer",void 0),d([p()],ld.prototype,"template",void 0),d([p({readOnly:!0})],ld.prototype,"thumbnail",void 0),d([p()],ld.prototype,"id",null),d([p()],ld.prototype,"supportsUpload",null),ld=s6=d([A(Fat)],ld);const o6=ld;let ew=class extends bg(he){constructor(e){super(e),this.items=null,this.label=null}get id(){return this.label}findByTemplate(e){return this.items.find(i=>i.template===e)}};d([p()],ew.prototype,"items",void 0),d([p()],ew.prototype,"label",void 0),d([p()],ew.prototype,"id",null),ew=d([A("esri.widgets.FeatureTemplates.TemplateItemGroup")],ew);const Vat=ew;var P2;const zat=({layer:t})=>({key:t,label:t.title??""}),jat=({layer:t})=>({key:t.geometryType,label:t.geometryType??""});let la=P2=class extends cn(an.EventedAccessor){constructor(t){super(t),this._itemPool=new yp(o6),this._groupPool=new yp(Vat),this.filterFunction=null,this.selectedItem=null}initialize(){this._get("groupBy")||(this.groupBy="layer")}set groupBy(t){if(this._set("groupBy",t),typeof t!="function")switch(t){case"layer":this._groupByFunction=zat;break;case"geometry":this._groupByFunction=jat;break;default:this._groupByFunction=null}else this._groupByFunction=e=>this._ensureGroupByObject(t(e))}set layers(t){const e="layers";if(this.handles.remove(e),t){const i=()=>this.notifyChange("state");this.handles.add(t.map(r=>tn(()=>r.loadStatus,i)),e)}this._set("layers",t)}get layers(){return this._get("layers")}get state(){const{layers:t}=this;return t&&t.length!==0?t.some(e=>e.loadStatus==="loading"||e.loadStatus==="not-loaded")?"loading":"ready":"disabled"}get _featureTemplatesByLayer(){if(!this.layers)return new Map;const t=[];for(const e of this.layers)if(e.type==="subtype-group")for(const i of e.sublayers){const r=Cte(i);t.push([i,r])}else e1(e)||t.push([e,Cte(e)]);return new Map(t)}get numberOfFeatureTemplates(){return Array.from(this._featureTemplatesByLayer.values()).reduce((t,e)=>t+e.length,0)}get items(){var s,o,a;if(this.numberOfFeatureTemplates===0)return this._releasePreviousItems(),[];const t=this._featureTemplatesByLayer,e=[],i=this.filterFunction!=null?this.filterFunction:P2._nullFilterFunction;for(const[l,c]of t)if(l.loaded||l.type==="subtype-sublayer"&&((s=l.parent)!=null&&s.loaded)){const u=(o=Ro(l))==null?void 0:o.operations;if(u!=null&&u.supportsEditing&&(u!=null&&u.supportsAdd))for(const h of c)e.push({layer:l,template:h,matchesFilter:i({label:h.name})})}if(this._groupByFunction==null){const l=e.filter(({matchesFilter:c})=>c).map(({template:c,layer:u})=>this._createItem(c,u));return this._releasePreviousItems(),l}const r=new Map;for(const l of e){const{template:c,layer:u}=l,h=this._groupByFunction({template:c,layer:u}),{key:f,label:m}=h.key!=null?h:P2.nullGroupBy;r.has(f)||r.set(f,{label:m,templateItemInfos:[]}),(a=r.get(f))==null||a.templateItemInfos.push(l)}const n=[];for(const l of r.values()){const{label:c,templateItemInfos:u}=l,h=u.filter(({matchesFilter:m})=>m),f=i({label:c})?u:u.length>0?h:[];if(f.length>0){const m=f.map(({template:g,layer:y})=>this._createItem(g,y));n.push(this._createGroup(c,m))}}return n.length===1&&n[0].label===P2.nullGroupBy.label?(this._releasePreviousItems(),n[0].items):(this._releasePreviousItems(),n)}refresh(){this.notifyChange("items")}select(t,{emit:e=!0}={}){const i=this.selectedItem,r=(t==null?void 0:t.clone())||null;this._set("selectedItem",r),e&&this.emit("select",{item:r,oldItem:i,template:(r==null?void 0:r.template)??null})}_createItem(t,e){const i=this._itemPool.acquire();return i.set({template:t,layer:e}),i}_createGroup(t,e){const i=this._groupPool.acquire();return i.set("label",t),i.items=e,i}_releasePreviousItems(){this._destroyItems(this._get("items"))}_destroyItems(t){t&&(t[0]instanceof o6?t.forEach(e=>this._destroyItem(e)):t.forEach(e=>this._destroyGroup(e)))}_destroyGroup(t){t.items.forEach(e=>this._destroyItem(e)),t.items.length=0,this._groupPool.release(t)}_destroyItem(t){t.layer=null,t.template=null,this._itemPool.release(t)}_ensureGroupByObject(t){return typeof t=="string"?{key:t,label:t}:t}};la.nullGroupBy={key:Symbol(),label:"Other​"},la._nullFilterFunction=t=>!0,d([p()],la.prototype,"_groupByFunction",void 0),d([p()],la.prototype,"filterFunction",void 0),d([p()],la.prototype,"groupBy",null),d([p()],la.prototype,"layers",null),d([p()],la.prototype,"state",null),d([p({readOnly:!0})],la.prototype,"_featureTemplatesByLayer",null),d([p({readOnly:!0})],la.prototype,"numberOfFeatureTemplates",null),d([p({readOnly:!0})],la.prototype,"items",null),d([p({readOnly:!0})],la.prototype,"selectedItem",void 0),la=P2=d([A("esri.widgets.FeatureTemplates.FeatureTemplatesViewModel")],la);const Cte=t=>[..."templates"in t&&Array.isArray(t.templates)?t.templates:[],..."types"in t&&Array.isArray(t.types)?t.types.flatMap(e=>e.templates):[]],a6=la,zu="esri-item-list",gp={base:zu,group:`${zu}__group`,scroller:`${zu}__scroller`,scrollerEnabled:`${zu}__scroller--enabled`,groupHeader:`${zu}__group__header`,item:`${zu}__list-item`,itemIcon:`${zu}__list-item-icon`,itemContentEnd:`${zu}__list-item-content-end`,noMatchesMessage:`${zu}__no-matches-message`,filterContainerSticky:`${zu}__filter-container--sticky`},Bat=4;function abe(t){const{filterText:e="",id:i,messages:r,onFilterChange:n,...s}=t;return M("div",{key:i},t.filterEnabled??1?Hat({filterText:e,id:i,messages:r,onFilterChange:n}):null,Gat({...s,enableListScroll:t.enableListScroll??!0,filterText:e,messages:r}))}function Uat(t){return!!t.items}function Gat(t){const{headingLevel:e,items:i,...r}=t;return i.length===0?M("div",{class:gp.noMatchesMessage,key:"no-matches"},t.messages.noMatches):M("div",{class:q0({[gp.scroller]:!0,[gp.scrollerEnabled]:!!t.enableListScroll}),key:"item-container"},i.map(n=>Uat(n)?qat({...r,group:n,headingLevel:e}):q7({...r,grouped:!0,item:n})))}function Hat(t){const{messages:e,filterText:i,enableListScroll:r}=t;return M("div",{key:"filter",class:r?void 0:gp.filterContainerSticky},M("calcite-input",{onCalciteInputInput:n=>{const s=n.currentTarget;t.onFilterChange&&t.onFilterChange(s.value)},placeholder:e.filterPlaceholder,value:i,type:"search"}))}function q7(t){const{grouped:e,identify:i,item:r,onItemMouseEnter:n,onItemMouseLeave:s,onItemSelect:o,renderIcon:a,renderCustomItem:l,renderItemContent:c,renderItemContentEnd:u,renderItemLabel:h,renderItemDescription:f,selectedItem:m}=t,g=Ete(r,i),y=g===Ete(m,i),v=l==null?void 0:l(t);if(v)return v;const b=c==null?void 0:c(r),w=u==null?void 0:u(r);return M("calcite-list-item",{"aria-level":e?"2":"",class:gp.item,"data-item":r,key:g,label:b?void 0:(h==null?void 0:h(r))??r.label??void 0,description:b?void 0:(f==null?void 0:f(r))??void 0,selected:y,tabIndex:0,afterUpdate:x=>{x.selected=y},onCalciteListItemSelect:x=>{x.preventDefault(),o==null||o(ZF(x))},onmouseenter:x=>n==null?void 0:n(ZF(x)),onmouseleave:x=>s==null?void 0:s(ZF(x))},M("div",{key:"content-start",class:gp.itemIcon,slot:"content-start"},a==null?void 0:a(r)),b?M("div",{key:"content",slot:"content"},b):null,w?M("div",{key:"content-end",class:gp.itemContentEnd,slot:"content-end"},w):null)}function Ete(t,e){return t?`${(e==null?void 0:e(t))||t.id}__${t.label}`:""}function ZF(t){return t.currentTarget["data-item"]}function qat(t){const{group:e,headingLevel:i=Bat,selectionMode:r="none",renderCustomGroupContent:n,...s}=t,o=n==null?void 0:n(t);return M("div",{class:gp.group,key:e.label??void 0},M(Ql,{level:i,class:gp.groupHeader},e.label),o||M("calcite-list",{selectionMode:r,selectionAppearance:"border"},e.items.map(a=>q7({...s,item:a,grouped:!0}))))}const Mte="esri-feature-templates",YF={base:Mte,loader:`${Mte}__loader`,widget:"esri-widget"};function Wat(t){return t.length>0&&ume(t[0])}function Jat(t){return t.id}const $te={filter:!0};let Kr=class extends cn(di){constructor(e,i){super(e,i),this.enableListScroll=!0,this.filterText="",this.headingLevel=4,this.messages=null,this.viewModel=new a6,this.visibleElements={...$te},this.renderCustomItem=r=>null,this.renderCustomGroupContent=r=>null,this.renderItemLabel=()=>null,this.renderItemDescription=()=>null,this.renderItemContent=r=>null,this.renderItemContentEnd=r=>null,this._iconIntersectionObserver=new IntersectionObserver((r,n)=>{r.forEach(async s=>{if(s.isIntersecting){const o=s.target;if(Yat(o))return void n.unobserve(o);const a=Zat(o),{layer:l,template:c}=a;Ate(o,!0);const u=await o6.fetchThumbnail(l,c).catch(()=>(Ate(o,!1),null));if(u==null)return;o.appendChild(u)}})}),this.renderItemIcon=r=>M("span",{key:"icon",afterCreate:this._afterItemCreateOrUpdate,afterUpdate:this._afterItemCreateOrUpdate,afterRemoved:this._afterItemRemoved,"data-item":r,"data-has-icon":!1}),this._afterItemCreateOrUpdate=r=>{var n;(n=this._iconIntersectionObserver)==null||n.observe(r)},this._afterItemRemoved=r=>{var n;(n=this._iconIntersectionObserver)==null||n.unobserve(r)}}initialize(){const e=({label:i})=>!this.filterText||!!(i!=null&&i.toLowerCase().includes(this.filterText.toLowerCase()));this.addHandles(J(()=>this.viewModel,(i,r)=>{i&&!i.filterFunction&&(this.filterFunction=e),r&&r!==i&&r.filterFunction===e&&(r.filterFunction=null)},Le))}destroy(){var e;(e=this._iconIntersectionObserver)==null||e.disconnect(),this._iconIntersectionObserver=null}loadDependencies(){return Zd({input:()=>W(()=>import("./calcite-input-3ed71a14.js"),["./calcite-input-3ed71a14.js","./input-73d8e593.js","./form-5109e7da.js","./interactive-3cbb41b8.js","./browser-14ab28bd.js","./key-a512d618.js","./label2-c76d0cf4.js","./loadable-800481cb.js","./t9n-5488ec48.js","./observers-c8819292.js","./icon-55c3c703.js","./progress-f7b87c62.js"],import.meta.url),"list-item":()=>W(()=>import("./calcite-list-item-d246eaec.js"),["./calcite-list-item-d246eaec.js","./interactive-3cbb41b8.js","./browser-14ab28bd.js","./utils3-9c594b4c.js","./t9n-5488ec48.js","./key-a512d618.js","./observers-c8819292.js","./loadable-800481cb.js","./action-6ac56df8.js","./guid-40d04074.js","./icon-55c3c703.js","./loader-ea07f4e7.js"],import.meta.url),notice:()=>W(()=>import("./calcite-notice-ef4471ac.js"),["./calcite-notice-ef4471ac.js","./conditionalSlot-7d11aa4c.js","./observers-c8819292.js","./loadable-800481cb.js","./t9n-5488ec48.js","./key-a512d618.js","./icon-55c3c703.js"],import.meta.url)})}get filterFunction(){return this.viewModel.filterFunction}set filterFunction(e){this.viewModel.filterFunction=e}get groupBy(){return this.viewModel.groupBy}set groupBy(e){this.viewModel.groupBy=e}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get layers(){return this.viewModel.layers}set layers(e){this.viewModel.layers=e}get selectedItem(){return this.viewModel.selectedItem}castVisibleElements(e){return{...$te,...e}}select(e,i){return this.viewModel.select(e,i)}render(){const{enableListScroll:e,filterText:i,headingLevel:r,messages:n,viewModel:{items:s,numberOfFeatureTemplates:o,selectedItem:a,state:l}}=this,c=this.visibleElements.filter&&o>1;if(Wat(s)){const u=s.find(h=>h.label===a6.nullGroupBy.label);u&&(u.label=n.other)}return M("div",{class:this.classes(YF.base,YF.widget),"aria-label":n.widgetLabel},l==="loading"?this.renderLoader():l==="ready"?M(abe,{enableListScroll:e,filterEnabled:c,filterText:i,headingLevel:r,id:this.id,identify:Jat,items:s,messages:{filterPlaceholder:n.filterPlaceholder,noItems:n.noItems,noMatches:n.noMatches},renderIcon:this.renderItemIcon,renderCustomItem:this.renderCustomItem,renderCustomGroupContent:this.renderCustomGroupContent,renderItemContent:this.renderItemContent,renderItemContentEnd:this.renderItemContentEnd,renderItemDescription:this.renderItemDescription,renderItemLabel:this.renderItemLabel,selectedItem:a??void 0,selectionMode:"single",onItemSelect:u=>!ume(u)&&this.viewModel.select(u),onFilterChange:u=>{this.filterText=u,this.viewModel.refresh()}}):null)}renderLoader(){return M("div",{class:YF.loader,key:"loader"})}};function Zat(t){return t==null?void 0:t["data-item"]}function Yat(t){return!!(t!=null&&t["data-has-icon"])}function Ate(t,e){t&&(t["data-has-icon"]=e)}d([p()],Kr.prototype,"enableListScroll",void 0),d([p()],Kr.prototype,"filterFunction",null),d([p()],Kr.prototype,"filterText",void 0),d([p()],Kr.prototype,"groupBy",null),d([p()],Kr.prototype,"headingLevel",void 0),d([p()],Kr.prototype,"label",null),d([p()],Kr.prototype,"layers",null),d([p(),ut("esri/widgets/FeatureTemplates/t9n/FeatureTemplates")],Kr.prototype,"messages",void 0),d([p({readOnly:!0})],Kr.prototype,"selectedItem",null),d([p(),BC("select")],Kr.prototype,"viewModel",void 0),d([p()],Kr.prototype,"visibleElements",void 0),d([tt("visibleElements")],Kr.prototype,"castVisibleElements",null),d([p()],Kr.prototype,"renderCustomItem",void 0),d([p()],Kr.prototype,"renderCustomGroupContent",void 0),d([p()],Kr.prototype,"renderItemLabel",void 0),d([p()],Kr.prototype,"renderItemDescription",void 0),d([p()],Kr.prototype,"renderItemContent",void 0),d([p()],Kr.prototype,"renderItemContentEnd",void 0),Kr=d([A("esri.widgets.FeatureTemplates")],Kr);const Kat=Kr;var lbe;const rk=Symbol("anchorHandles");let b0=class extends an.EventedAccessor{constructor(e){super(e),this[lbe]=new gs,this.location=null,this.screenLocationEnabled=!1,this.view=null,this[rk].add([tn(()=>lt(this.screenLocationEnabled?this.view:null,i=>[i.size,i.type==="3d"?i.camera:i.viewpoint]),()=>this.notifyChange("screenLocation")),J(()=>this.screenLocation,(i,r)=>{i!=null&&r!=null&&this.emit("view-change")})])}destroy(){this.view=null,this[rk]=je(this[rk])}get screenLocation(){var n;const{location:e,view:i,screenLocationEnabled:r}=this;return r&&e!=null&&i!=null&&i.ready?(n=i.toScreen)==null?void 0:n.call(i,e):null}};lbe=rk,d([p()],b0.prototype,"location",void 0),d([p()],b0.prototype,"screenLocation",null),d([p()],b0.prototype,"screenLocationEnabled",void 0),d([p()],b0.prototype,"view",void 0),b0=d([A("esri.widgets.support.AnchorElementViewModel")],b0);const Xat=b0,Qat="esri.widgets.CompassViewModel";let nk=class extends Xat{constructor(e){super(e),this.visible=!1}};d([p()],nk.prototype,"visible",void 0),nk=d([A(Qat)],nk);const W7=nk,KF="esri-spinner",XF={base:KF,spinnerStart:`${KF}--start`,spinnerFinish:`${KF}--finish`};let w0=class extends di{constructor(e,i){super(e,i),this._animationDelay=500,this._animationPromise=null,this.viewModel=new W7}initialize(){this.addHandles(J(()=>this.visible,e=>this._visibleChange(e)))}destroy(){this._animationPromise=null}get location(){return this.viewModel.location}set location(e){this.viewModel.location=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}get visible(){return this.viewModel.visible}set visible(e){this.viewModel.visible=e}show(e){const{location:i,promise:r}=e??{};i&&(this.viewModel.location=i),this.visible=!0;const n=()=>this.hide();r&&r.catch(()=>{}).then(n)}hide(){this.visible=!1}render(){const{visible:e}=this,{screenLocation:i}=this.viewModel,r=!!i,n=e&&r,s=!e&&r,o={[XF.spinnerStart]:n,[XF.spinnerFinish]:s},a=this._getPositionStyles();return M("div",{class:this.classes(XF.base,o),styles:a})}_visibleChange(e){if(e)return void(this.viewModel.screenLocationEnabled=!0);const i=XT(this._animationDelay);this._animationPromise=i,i.catch(()=>{}).then(()=>{this._animationPromise===i&&(this.viewModel.screenLocationEnabled=!1,this._animationPromise=null)})}_getPositionStyles(){const{screenLocation:e,view:i}=this.viewModel;if(i==null||e==null)return{};const{padding:r}=i;return{left:e.x-r.left+"px",top:e.y-r.top+"px"}}};d([p()],w0.prototype,"location",null),d([p()],w0.prototype,"view",null),d([p({type:W7})],w0.prototype,"viewModel",void 0),d([p()],w0.prototype,"visible",null),w0=d([A("esri.widgets.Spinner")],w0);const elt=w0;function Hw(t,e,i=void 0){_p(t,"`"+e+"` is deprecated, because it instantiates the deprecated class 'esri.widgets.Editor.CreateWorkflow'",{replacement:i,version:"4.23",see:"https://developers.arcgis.com/javascript/latest/api-reference/esri-widgets-Editor-CreateFeaturesWorkflow.html"})}function GTt(t,e,i){return Math.sqrt((t[0]-e[0])**2+(t[1]-e[1])**2+(t[2]!==void 0&&e[2]!==void 0?(t[2]*i-e[2]*i)**2:0))}const O2=[];for(const t of[[9002,56146130,6131,6132,8050,8051,8228],[9003,5702,6358,6359,6360,8052,8053],[9095,5754]]){const e=t[0];for(let i=1;i<t.length;i++)O2[t[i]]=e}const AI=[];function tlt(t){return t.vcsWkid&&O2[t.vcsWkid]!==void 0?AI[O2[t.vcsWkid]]:t.latestVcsWkid&&O2[t.latestVcsWkid]!==void 0?AI[O2[t.latestVcsWkid]]:1}function kte(t,e,i){const r={x:0,y:0};e&&(r.z=0),i&&(r.m=0);let n=0,s=t[0];for(let o=0;o<t.length;o++){const a=t[o];if(nlt(a,s)===!1){const l=cbe(s,a,e),c=ilt(s,a,e,i);c.x*=l,c.y*=l,r.x+=c.x,r.y+=c.y,e&&(c.z*=l,r.z+=c.z),i&&(c.m*=l,r.m+=c.m),n+=l,s=a}}return n>0?(r.x/=n,r.y/=n,e&&(r.z/=n),i&&(r.m/=n)):(r.x=t[0][0],r.y=t[0][1],e&&(r.z=t[0][2]),i&&e?r.m=t[0][3]:i&&(r.m=t[0][2])),r}function ilt(t,e,i,r){const n={x:(t[0]+e[0])/2,y:(t[1]+e[1])/2};return i&&(n.z=(t[2]+e[2])/2),i&&r?n.m=(t[3]+e[3])/2:r&&(n.m=(t[2]+e[2])/2),n}function rlt(t,e){if(t.length<=1)return 0;let i=0;for(let r=1;r<t.length;r++)i+=cbe(t[r-1],t[r],e);return i}function cbe(t,e,i){const r=e[0]-t[0],n=e[1]-t[1];if(i){const s=e[2]-e[2];return Math.sqrt(r*r+n*n+s*s)}return Math.sqrt(r*r+n*n)}function nlt(t,e){if(t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}function HTt(t){const e={x:0,y:0,spatialReference:t.spatialReference.toJSON()},i={x:0,y:0,spatialReference:t.spatialReference.toJSON()};let r=0,n=0;for(let s=0;s<t.paths.length;s++){if(t.paths[s].length===0)continue;const o=rlt(t.paths[s],t.hasZ===!0);if(o===0){const a=kte(t.paths[s],t.hasZ===!0,t.hasM===!0);e.x+=a.x,e.y+=a.y,t.hasZ===!0&&(e.z+=a.z),t.hasM===!0&&(e.m+=a.m),++r}else{const a=kte(t.paths[s],t.hasZ===!0,t.hasM===!0);i.x+=a.x*o,i.y+=a.y*o,t.hasZ===!0&&(i.z+=a.z*o),t.hasM===!0&&(i.m+=a.m*o),n+=o}}return n>0?(i.x/=n,i.y/=n,t.hasZ===!0&&(i.z/=n),t.hasM===!0&&(i.m/=n),new fe(i)):r>0?(e.x/=r,e.y/=r,t.hasZ===!0&&(i.z/=r),t.hasM===!0&&(e.m/=r),new fe(e)):null}function qTt(t){if(t.points.length===0)return null;let e=0,i=0,r=0,n=0;for(let o=0;o<t.points.length;o++){const a=t.getPoint(o);a.hasZ===!0&&(r+=a.z),a.hasM===!0&&(n+=a.m),e+=a.x,i+=a.y,n+=a.m}const s={x:e/t.points.length,y:i/t.points.length,spatialReference:null};return s.spatialReference=t.spatialReference.toJSON(),t.hasZ===!0&&(s.z=r/t.points.length),t.hasM===!0&&(s.m=n/t.points.length),new fe(s)}function slt(t,e){return t.x*e.x+t.y*e.y}function olt(t,e){return t.x*e.y-e.x*t.y}function LR(t,e,i=0){for(;t<i;)t+=e;const r=i+e;for(;t>=r;)t-=e;return t}function ube(t,e){return Math.atan2(e.y-t.y,e.x-t.x)}function WTt(t,e){return LR(ube(t,e),2*Math.PI)*(180/Math.PI)}function JTt(t,e){return LR(Math.PI/2-ube(t,e),2*Math.PI)*(180/Math.PI)}function dbe(t,e,i){const r={x:t.x-e.x,y:t.y-e.y},n={x:i.x-e.x,y:i.y-e.y};return Math.atan2(olt(r,n),slt(r,n))}function ZTt(t,e,i){return LR(dbe(t,e,i),2*Math.PI)*(180/Math.PI)}function YTt(t,e,i){return LR(-1*dbe(t,e,i),2*Math.PI)*(180/Math.PI)}AI[9002]=.3048,AI[9003]=.3048006096012192,AI[9095]=.3048007491;const ts=[0,0];function KTt(t){for(let e=0;e<t.length;e++){const i=t[e];for(let n=0;n<i.length-1;n++){const s=i[n],o=i[n+1];for(let a=e+1;a<t.length;a++)for(let l=0;l<t[a].length-1;l++){const c=t[a][l],u=t[a][l+1];if(HI(s,o,c,u,ts)&&!(ts[0]===s[0]&&ts[1]===s[1]||ts[0]===c[0]&&ts[1]===c[1]||ts[0]===o[0]&&ts[1]===o[1]||ts[0]===u[0]&&ts[1]===u[1]))return!0}}const r=i.length;if(!(r<3))for(let n=0;n<=r-2;n++){const s=i[n],o=i[n+1];for(let a=n+2;a<=r-2;a++){const l=i[a],c=i[a+1];if(HI(s,o,l,c,ts)&&!(ts[0]===s[0]&&ts[1]===s[1]||ts[0]===l[0]&&ts[1]===l[1]||ts[0]===o[0]&&ts[1]===o[1]||ts[0]===c[0]&&ts[1]===c[1]))return!0}}}return!1}function hbe(t,e,i){switch(t){case"point":case"multipoint":return"point";case"polyline":return(e!=null&&e.type==="polyline"&&e.paths.length?e.paths[0].length:0)<2?"polylineZeroVertices":"polylineOneVertex";case"polygon":{const r=e!=null&&e.type==="polygon"&&e.rings.length?e.rings[0].length:0;return r<3?"polylineZeroVertices":r<4?"polygonOneVertex":"polygonTwoVertices"}case"mesh":return alt(e,i);default:return}}function alt(t,e){if((t==null?void 0:t.type)!=="mesh"||(e==null?void 0:e.type)!=="3d")return;const{renderCoordsHelper:i}=e,{camera:r}=e.state,{width:n,height:s,zmin:o,zmax:a,center:l,spatialReference:c}=t.extent,u=(a??0)-(o??0),h=ti(c),f=tlt(c),m=ti(i.spatialReference),g=Math.max(n*h,s*h,u*f)/m;Bi(r$,l.x,l.y,l.z??0),i.toRenderCoords(r$,c,r$);const y=g/r.computeScreenPixelSizeAt(r$);return y>r.width*clt?"meshTooClose":y<llt?"meshTooFar":"mesh"}const llt=20,clt=1,r$=Me();let tw=class extends he{constructor(e){super(e),this.creationInfo=null,this.pendingFeatures=new ye,this.viewModel=null,this.upload=null}};d([p()],tw.prototype,"creationInfo",void 0),d([p()],tw.prototype,"viewModel",void 0),d([p()],tw.prototype,"upload",void 0),tw=d([A("esri.widgets.Editor.CreateFeaturesWorkflowData")],tw);function QF(t,e){return e?"xoffset"in e&&e.xoffset?Math.max(t,Math.abs(e.xoffset)):"yoffset"in e&&e.yoffset?Math.max(t,Math.abs(e.yoffset||0)):t:t}function ult(t){let e=0,i=0;for(let r=0;r<t.length;r++){const n=t[r].size;typeof n=="number"&&(e+=n,i++)}return e/i}function Pte(t,e){return typeof t=="number"?t:t&&t.stops&&t.stops.length?ult(t.stops):e}function dlt(t,e){if(!e)return t;const i=e.filter(o=>o.type==="size").map(o=>{const{maxSize:a,minSize:l}=o;return(Pte(a,t)+Pte(l,t))/2});let r=0;const n=i.length;if(n===0)return t;for(let o=0;o<n;o++)r+=i[o];const s=Math.floor(r/n);return Math.max(s,t)}function pbe(t){var n;const e=t&&t.renderer,i=(t&&t.event&&t.event.pointerType)==="touch"?9:6;if(!e)return i;const r="visualVariables"in e?dlt(i,e.visualVariables):i;if(e.type==="simple")return QF(r,e.symbol);if(e.type==="unique-value"){let s=r;return(n=e.uniqueValueInfos)==null||n.forEach(o=>{s=QF(s,o.symbol)}),s}if(e.type==="class-breaks"){let s=r;return e.classBreakInfos.forEach(o=>{s=QF(s,o.symbol)}),s}return e.type==="dot-density"||e.type,r}let ym=class extends an.EventedAccessor{constructor(e){super(e),this.tracking=!1,this.displaying=!1,this.isDraped=!1}};d([p({constructOnly:!0})],ym.prototype,"graphic",void 0),d([p()],ym.prototype,"tracking",void 0),d([p()],ym.prototype,"displaying",void 0),d([p()],ym.prototype,"isDraped",void 0),ym=d([A("esri.views.3d.layers.graphics.GraphicState")],ym);function fbe(t,e,i,r=new Re){let n=0;if(i.type==="2d")n=e*(i.resolution??0);else if(i.type==="3d"){const u=i.overlayPixelSizeInMapUnits(t),h=i.basemapSpatialReference;n=h==null||h.equals(i.spatialReference)?e*u:ti(h)/ti(i.spatialReference)}const s=t.x-n,o=t.y-n,a=t.x+n,l=t.y+n,{spatialReference:c}=i;return r.xmin=Math.min(s,a),r.ymin=Math.min(o,l),r.xmax=Math.max(s,a),r.ymax=Math.max(o,l),r.spatialReference=c,r}function eCt(t,e,i){const r=i.toMap(t);return r==null?!1:fbe(r,pbe(),i,hlt).intersects(e)}const hlt=new Re;function RR(t){const e=t.sourceLayer;if(!e||e.type!=="feature"||!ylt(e.renderer))return{rotation:null,size:null};let i=null,r=null;const n=e.renderer.getVisualVariablesForType("rotation").filter(o=>(!o.axis||o.axis==="heading")&&o.field&&!o.valueExpression&&OL(o,t)!=null);n.length===1&&(i=plt(n[0],e));const s=e.renderer.getVisualVariablesForType("size").filter(o=>o.field&&!o.useSymbolValue&&!o.valueExpression&&Zde(o)===Cn.RealWorldSize&&AC(o,t)!=null);return s.length===1&&(r=glt(s[0],e)),{rotation:i,size:r}}function plt(t,e){const i=(t.axis||"heading")==="heading"&&t.rotationType==="arithmetic"?-1:1,r=t.field,n=e.fields&&e.fields.filter(a=>a.name===r),s=n&&n.length===1?n[0].type:"double",o={initial:0,current:0};return{field:r,fieldType:s,getDefault:()=>Promise.resolve(0),getValue:a=>(o.current=o.initial-i*a,l6((o.current+360)%360,s)),initValue:a=>{o.initial=a??o.current,o.current=0},isUpdatingInteractively:!1,rotationType:t.rotationType??"geographic"}}function flt(t,e){switch(e){case"width":return t[0];case"depth":return t[1];case"height":return t[2];default:return t[2]||t[1]||t[0]}}async function mlt(t,e,i){if(e==null)return 0;const{symbol:r}=Av(e);if(r==null||r.type==="web-style"||r.type==="cim")return 0;const n=r.symbolLayers.at(0);if(!n)return 0;switch(n.type){case"icon":{const{computeIconLayerResourceSize:s}=await W(()=>import("./symbolLayerUtils-442cc767.js"),[],import.meta.url);return n.size||Math.min(cf.icon,(await s(n,cf.icon))[0])||cf.icon}case"text":return n.size||cf.text;case"line":return n.size||cf.line;case"object":{const{computeObjectLayerResourceSize:s}=await W(()=>import("./symbolLayerUtils-442cc767.js"),[],import.meta.url);return flt(await s(n,t.scale/cf.viewScaleSizeFactor),i)}case"path":return(n.width!=null?n.width:n.height)||t.scale/cf.viewScaleSizeFactor;case"extrude":return n.size||t.scale/cf.viewScaleSizeFactor;default:return 0}}function glt(t,e){const i=t.field,r=t.axis,n=e.fields&&e.fields.filter(c=>c.name===i),s=n&&n.length===1?n[0].type:"double",o={updating:!1,initial:0,current:0},a=$C[t.valueUnit]??1;let l;return l=t.valueRepresentation==="area"?c=>(c*a/2)**2*Math.PI:t.valueRepresentation==="radius"||t.valueRepresentation==="distance"?c=>c*a/2:c=>c*a,{field:i,fieldType:s,getDefault:async(c,u)=>l6(l(await mlt(u,c,r)),s),getValue:(c,u)=>(o.initial||(o.initial=u.pixelSizeAt(u.center)),o.current=o.initial*c,l6(o.current,s)),initValue:c=>{o.initial=c??o.current,o.current=0},isUpdatingInteractively:!1,displayUnit:Plt(t.valueUnit),axis:t.axis}}function l6(t,e){switch(e){case"small-integer":case"integer":case"long":return Math.round(t);case"double":case"single":return t;default:return 0}}function ylt(t){switch(t==null?void 0:t.type){case"class-breaks":case"simple":case"unique-value":case"dot-density":case"dictionary":case"pie-chart":return!0;default:return!1}}async function mg(t,e){const i=await c8(t,{useSourceLayer:!0,ignoreGraphicSymbol:!0,webStyleCache:e});bhe(t.symbol,i)!=null&&(t.symbol=i)}function vlt(t){if(!t)throw new Error("no geometry type");return t==="multipatch"?"mesh":t}async function _lt(t,e,i,r){await c6(t,e,r);const n=t.on("create",async s=>{var o;if(s.state==="cancel")return c6(t,e,r);if(s.state==="complete"){const a=s.graphic;a.sourceLayer||(a.sourceLayer=e.layer),a.attributes||(a.attributes={...(o=e.template)==null?void 0:o.prototype.attributes}),await mg(a,r),i(a)}});return kn([n,Et(()=>t.cancel())])}async function c6(t,e,i){var s;const r=e.layer,n={...(s=e.template)==null?void 0:s.prototype.attributes};await blt(t,r,n,i),t.layer.elevationInfo=r.elevationInfo,await t.create(vlt(r.geometryType),{graphicProperties:{attributes:n,sourceLayer:r},hasZ:r.capabilities.data.supportsZ,geometryToPlace:e.geometryToPlace??void 0})}async function blt(t,e,i,r){const n=new Or({sourceLayer:e,attributes:i}),{rotation:s,size:o}=RR(n);let a=await c8(n,{useSourceLayer:!0,webStyleCache:r}),l=!1;for(const c of[o,s])c!=null&&i[c.field]==null&&(i[c.field]=await c.getDefault(a,t.view),l=!0);switch(l&&(a=await c8(n,{useSourceLayer:!0,webStyleCache:r})),a==null?void 0:a.type){case"simple-fill":case"polygon-3d":t.polygonSymbol=a;break;case"simple-line":case"line-3d":t.polylineSymbol=a;break;case"simple-marker":case"picture-marker":case"point-3d":case"cim":t.pointSymbol=a}mbe(t.tooltipOptions,o,s)}function mbe(t,e,i){t.visualVariables=e!=null||i!=null?{size:e!=null?{unit:e.displayUnit,axis:e.axis,valueType:e.fieldType}:null,rotation:i!=null?{valueType:i.fieldType,rotationType:i.rotationType??"geographic"}:null}:null}function J7(t,e){return t?t.find(i=>i.layer===e):void 0}async function wlt(t,e,i,r){if(t.length===0)return[];const{updatable:n,graphicsByLayer:s}=await i.async(async()=>{const{results:o}=await gu(wnt(e,i),r),a=new Map,l=u=>{const h=u.layer,f=a.get(h);if(!f){const m=new Array;return a.set(h,m),m}return f};Yve(o).forEach(({graphic:u})=>l(u).push(u));const c=t.filter(({supports:u,layer:h})=>u.includes("update")&&a.has(h));return c.length!==0&&i.stopPropagation(),{updatable:c,graphicsByLayer:a}});return gu(br(n.map(async({layer:o})=>{const{objectIdField:a}=o,l="displayField"in o?o.displayField:null,c=[a];l!=null&&o.fieldsIndex.has(l)&&c.push(l);const u=s.get(o);if(u.some(h=>c.some(f=>!(f in h.attributes)))){const h=o.createQuery();return h.outFields=c,h.returnGeometry=!1,h.objectIds=u.map(f=>f.getObjectId()),o.queryFeatures(h,{signal:r}).then(({features:f})=>f)}return u})),r)}async function xlt(t,e,i,r){if(t.length===0)return[];let n=null;const s=await i.async(async()=>{const{results:o}=await gu(e.hitTest(i),r);if(o.length===0)return[];const a=new Set;n=Yve(o),n.forEach(({graphic:c})=>c&&a.add(c.layer));const l=t.items.filter(({layer:c,supports:u,attachmentsOnUpdateEnabled:h})=>a.has(c)&&(u.includes("update")||u.includes("delete")||h));return l.length>0&&i.stopPropagation(),l});return gu(br(s.map(({layer:o})=>{const a=o.objectIdField,l="displayField"in o?o.displayField:null,c=HB({displayField:l,fields:o.fields}),u=[a];c!=null&&o.fieldsIndex.has(c)&&u.push(c);const h=o.createQuery();h.outFields=u,h.returnGeometry=!1;const f="renderer"in o?pbe({renderer:o.renderer,event:i}):0;return h.geometry=fbe(i.mapPoint,f,e),h.outSpatialReference=e.spatialReference,o.queryFeatures(h,{signal:r}).then(({features:m})=>(n==null||n.forEach(({graphic:g})=>{g.layer!==o||m.some(y=>y.getObjectId()===g.getObjectId())||m.push(g)}),m))})),r)}async function Slt(t,e,i,r){switch(e.type){case"3d":return wlt(t,e,i,r);case"2d":return xlt(t,e,i,r)}}async function Ilt(t,e,i){const{sourceLayer:r}=t,n=r.createQuery();n.objectIds=[t.getAttribute(r.objectIdField)],n.outFields=["*"],n.outSpatialReference=e,n.returnM=r.capabilities.data.supportsM,n.returnZ=r.capabilities.data.supportsZ,h9()&&d9()&&r.type==="scene"&&r.infoFor3D!=null&&(n.returnGeometry=!0,n.formatOf3DObjects="3D_glb");const s=await r.queryFeatures(n,{signal:i});return _t(i),s.features[0]}async function DT(t){const{graphic:e,sketchViewModel:i,sourceLayer:r,visualVariables:n,webStyleCache:s}=t;let o=!1;const{rotation:a,size:l}=n;[a,l].forEach(async u=>{if(u==null)return;const h=e.getAttribute(u.field);if(h!=null)u.initValue(h);else{const f=await u.getDefault(e.symbol,i.view);u.initValue(f),e.setAttribute(u.field,f),o=!0}}),o&&await mg(e,s);const c={multipleSelectionEnabled:!1};return r.geometryType==="point"&&(c.enableRotation=a!=null,c.enableScaling=l!=null),mbe(i.tooltipOptions,l,a),i.layer.elevationInfo=r.elevationInfo,i.update(e,c)}function Tlt(t){return t==null||t.type!=="rotate-start"&&t.type!=="rotate"&&t.type!=="rotate-stop"?null:t}function Clt(t){return t==null||t.type!=="scale-start"&&t.type!=="scale"&&t.type!=="scale-stop"?null:t}async function Z7(t,e,i,r,n){var c;if(e.geometry==null||((c=e.geometry)==null?void 0:c.type)!=="point")return;const s=r.rotation,o=Tlt(i.toolEventInfo);if(s!=null&&o!=null)if(o.type==="rotate-stop")s.isUpdatingInteractively=!1,s.initValue();else{s.isUpdatingInteractively=!0;const{field:u,getValue:h}=s;e.setAttribute(u,h(o.angle,t))}const a=r.size,l=Clt(i.toolEventInfo);if(a!=null&&l!=null)if(l.type==="scale-stop")a.isUpdatingInteractively=!1,a.initValue();else{a.isUpdatingInteractively=!0;const{field:u,getValue:h}=a;e.setAttribute(u,h(l.xScale,t))}await mg(e,n)}async function Elt(t,e,i,r,n,s){const o=eD(t);await mg(o,s),r.map.add(i.layer),i.layer.add(o);const a=t.sourceLayer,l=NT(r,a);await Alt(r,o),await DT({graphic:o,sketchViewModel:i,sourceLayer:a,visualVariables:e,webStyleCache:s});const c=Mlt(i,t,o);let u=null;l.then(b=>u=b).catch(()=>{});const h=e.size,f=e.rotation,m=J(()=>t.attributes,async b=>{let w=!1;for(const x in b){const S=b[x];S!==o.getAttribute(x)&&(o.setAttribute(x,S),h==null||h.isUpdatingInteractively||h.field!==x||h.initValue(S),f==null||f.isUpdatingInteractively||f.field!==x||f.initValue(S),(u==null||u.requiredFields.includes(x))&&(w=!0))}w&&await mg(o,s)}),g=i.on("update",async b=>{const w=b.graphics[0];if(b.state==="complete")return DT({graphic:w,sketchViewModel:i,sourceLayer:a,visualVariables:e,webStyleCache:s});await Z7(r,w,b,e,s),n(eD(w),b)}),y=i.on(["undo","redo"],async b=>{n(eD(b.graphics[0]),b)}),v=i.updateOnGraphicClick;return{visual:kn([c,Et(()=>{i.updateOnGraphicClick=v})]),interactive:kn([y,g,Et(()=>i.cancel()),m,Et(()=>{i.updateOnGraphicClick=!1})])}}function Mlt(t,e,i){const r=t.view,n=e.sourceLayer,s=e.layer,o=e.getAttribute(s.objectIdField);let a=null;function l(c){a==null||a.abort(),a=Cp(async u=>{var f;const h=await NT(r,n);_t(u),(f=h.setVisibility)==null||f.call(h,o,c)})}return l(!1),kn([$lt(r,i,c=>l(!c)),Et(async()=>{l(!0);const c=await NT(r,n);await _r(()=>!c.updating),t.layer.remove(i)})])}function $lt(t,e,i){if(t.type==="3d"){const r=new ym({graphic:e});return kn([t.trackGraphicState(r),J(()=>r.displaying,i)])}return J(()=>e.visible,i)}async function Alt(t,e){if(t.type==="3d"){const i=new ym({graphic:e}),r=t.trackGraphicState(i);await _r(()=>i.displaying),r.remove()}else await _r(()=>e.visible)}const cf={icon:wa(24),text:wa(12),line:wa(1),viewScaleSizeFactor:100};function Y7(t,e,i){let r=!1;return t.filter(n=>!!r||(r=n===e,r)).map(n=>i[n]())}function klt(t){if(t.length!==1)return null;const e=t[0];if("items"in e){const i=e;return i.items.length===1?i.items[0]:null}return e}function gbe(t,e){if(t.viewModel.refreshCreationTemplates(),e[0].id==="awaiting-feature-creation-info"){const i=klt(t.viewModel.featureTemplatesViewModel.items);i==null||i.supportsUpload||(t.creationInfo=i,e.shift())}return e}function Plt(t){switch(t){case"unknown":case"decimal-degrees":return null;default:return t}}function ybe(t){t.filesEnabled=!0,t.mode="view",t.capabilities={editing:!0,operations:{add:!0,update:!0,delete:!0}}}function vbe(t){var a,l;const{creationInfo:e,viewModel:i}=t;if(!e)return!1;const{layer:r}=e,n=i.editableItems.find(c=>c.layer===r);if(n)return n.attachmentsOnCreateEnabled;const s=(a=r.capabilities)==null?void 0:a.data,o=(l=i.layerInfos)==null?void 0:l.find(c=>c.layer===r);return!(!(s&&"supportsAttachment"in s&&s.supportsAttachment)||o&&(o.allowAttachments===!1||o.attachmentsOnUpdateEnabled===!1))}const _be=t=>/-stop/.test(t)||/vertex-/.test(t),NT=(t,e)=>{const i=e.type==="subtype-sublayer"?e.parent:e;return t.whenLayerView(i)};function Olt(t){return"createInteractiveEditSession"in t}function eD(t){var i;const e=t.geometry;if((e==null?void 0:e.type)==="mesh"){const r=t.cloneShallow();return r.attributes=U(t.attributes),r.geometry=e.cloneShallow(),r.geometry.transform=((i=e.transform)==null?void 0:i.clone())??null,r}return t.clone()}function u6(t){const e=t.cursor;return t.cursor="progress",Et(()=>t.cursor=e)}async function Llt({view:t,data:e,signal:i,next:r,cancel:n}){const{creationInfo:s}=e;if(!s||!AO(s))return;const{layer:o}=s,a=s.geometryToPlace!=null;if(s.geometryToPlace=null,a)return void n();const l=(await W(()=>import("./Upload-4b0b469c.js"),[],import.meta.url)).Upload;_t(i);const c=new l;e.upload=c;const u=u6(t),h=kn([u,J(()=>c.state,f=>{switch(f){case"success":s.maxFeatures=1,s.geometryToPlace=c.result,r();break;case"error":u.remove();break;case"canceled":n()}}),Et(()=>{e.upload=je(e.upload)})]);return c.uploadTo(o),h}function AO(t){const e=t==null?void 0:t.layer;return(e==null?void 0:e.type)==="scene"}let Hn=class extends cn(an.EventedAccessor){constructor(e){super(e),this._indexHistory=[],this._lastStepIndex=-1,this._stepIndex=-1,this._setupAbortController=null,this._handleKeys={afterCommit:"after-commit",beforeCommit:"before-commit"},this.data=void 0,this.started=!1,this.steps=[],this.type=null}get hasNextStep(){const{steps:e}=this;return!!(e&&this._stepIndex<e.filter(i=>!i.parent).length-1)}get hasPreviousStep(){return this._stepIndex>0}get reliesOnOwnerAdminPrivileges(){return!1}get hasInvalidFormTemplate(){return!1}get hasUnsupportedFields(){return!1}get shouldShowAttachments(){return!1}get shouldAllowAttachmentEditing(){return!1}get stepId(){const{steps:e}=this,i=e&&e[this._stepIndex];return i&&i.id}get helpMessage(){}get hasPendingEdits(){return!1}get keyboardCancellationEnabled(){return!0}async back(e=()=>Promise.resolve(!0)){this.hasPendingEdits&&!await e()||(this.hasPreviousStep?await this.previous({cancelCurrentStep:!0}):await this.cancel({force:!0}))}async cancel(e={force:!0}){return e.force!==!1?this._cancel(e):new Promise((i,r)=>{this.emit("cancel-request",{controller:{allow:()=>{this._cancel({...e,force:!0}).then(i)},deny:()=>r(new N("workflow:cancel-denied","Request to cancel workflow was denied."))}})})}async commit(){var e;this.handles.remove(this._handleKeys.beforeCommit),await((e=this.onCommit)==null?void 0:e.call(this,this.data)),this.handles.remove(this._handleKeys.afterCommit),this.emit("commit")}async go(e){const{steps:i}=this,r=i.findIndex(n=>n.id===e);this._indexHistory.push(this._stepIndex),await this._go(r)}async next(){this._indexHistory.push(this._stepIndex),await this._go(this._stepIndex+1)}async previous(e={cancelCurrentStep:!1}){await this._go(this._indexHistory.pop(),e.cancelCurrentStep)}async reset(){await this._cancel({notify:!1}),await this.start()}async save(){await this.commit(),await this.reset()}async start(){this._set("started",!0);const e=this._stepIndex===-1?0:this._stepIndex;await this._go(e)}async _cancel({notify:e=!0,error:i}={}){this.started&&(this._set("started",!1),await this.steps[this._stepIndex].tearDown({canceled:!0})),this.handles.remove([this._handleKeys.afterCommit,this._handleKeys.beforeCommit]),this._resetIndexing(e),e&&this.emit("cancel",{error:i})}async _go(e=-1,i=!1){const{steps:r}=this;if(e<=-1||e>=r.length)return;if(!this.started)return this._stepIndex=e,void this._notifyStepProps();this._lastStepIndex>-1&&(this._setupAbortController=Qr(this._setupAbortController),await r[this._lastStepIndex].tearDown({canceled:i})),this._setupAbortController=new AbortController;const n=this._setupAbortController.signal;try{await r[e].setUp(n)}catch(s){Ek(s)}this._setupAbortController.signal===n&&(this._setupAbortController=null),n.aborted||(this._lastStepIndex=e,this._stepIndex=e,this._notifyStepProps())}_resetIndexing(e=!0){this._stepIndex=-1,this._lastStepIndex=-1,this._indexHistory.length=0,e&&this._notifyStepProps()}_notifyStepProps(){this.notifyChange("stepId"),this.notifyChange("hasPreviousStep"),this.notifyChange("hasNextStep")}};d([p()],Hn.prototype,"data",void 0),d([p()],Hn.prototype,"hasNextStep",null),d([p()],Hn.prototype,"hasPreviousStep",null),d([p()],Hn.prototype,"onCommit",void 0),d([p()],Hn.prototype,"reliesOnOwnerAdminPrivileges",null),d([p()],Hn.prototype,"hasInvalidFormTemplate",null),d([p()],Hn.prototype,"hasUnsupportedFields",null),d([p()],Hn.prototype,"shouldShowAttachments",null),d([p()],Hn.prototype,"shouldAllowAttachmentEditing",null),d([p()],Hn.prototype,"started",void 0),d([p({readOnly:!0})],Hn.prototype,"stepId",null),d([p()],Hn.prototype,"steps",void 0),d([p({readOnly:!0})],Hn.prototype,"type",void 0),d([p()],Hn.prototype,"helpMessage",null),d([p()],Hn.prototype,"hasPendingEdits",null),d([p()],Hn.prototype,"keyboardCancellationEnabled",null),Hn=d([A("esri.widgets.Editor.Workflow")],Hn);const FR=Hn;var sk;const tD=Symbol(),Ote=Symbol();let cd=sk=class extends FR{constructor(t){super(t),this.type="create-features",this.createFeatureState="create-new",this._featureFormHandle=null,this._visualVariableAttributes={rotation:null,size:null},this._attachmentFileInfos=new Map,this._highlightHandles=new Map,this._preventDefaultActionOnCancel=!1,this._lastActiveGraphics=[]}get hasPendingEdits(){var i;if(this.numPendingFeatures)return!0;const{data:t}=this,{upload:e}=t;return!(!e||e.error)||!!((i=t.creationInfo)!=null&&i.geometryToPlace)}get helpMessage(){var n;const{creationInfo:t,viewModel:e}=this.data;if(this.stepId!=="creating-features"||!t)return;const i=t.layer.geometryType,r=(n=e.sketchViewModel.createGraphic)==null?void 0:n.geometry;return hbe(i,r,e.view)}get numPendingFeatures(){return this.pendingFeatures.length}get pendingFeatures(){return this.data.pendingFeatures}get keyboardCancellationEnabled(){return this.numPendingFeatures===0}get reliesOnOwnerAdminPrivileges(){var n,s;const{creationInfo:t}=this.data;if(!t)return!1;const{layer:e}=t,i=(n=e.capabilities)==null?void 0:n.operations.supportsAdd,r=(s=Ro(e))==null?void 0:s.operations.supportsAdd;return KO(e)&&!e.editingEnabled||!!r&&!i}get shouldShowAttachments(){return!!(this.data&&this.data.creationInfo&&this.data.viewModel)&&vbe(this.data)}get shouldAllowAttachmentEditing(){return this.shouldShowAttachments}get updating(){return this.updatingHandles.updating}get test(){return{addAttachment:(t,e)=>{this._attachmentFileInfos.set(t,e)}}}async enter(){const{featureFormViewModel:t}=this.data.viewModel,e=t.relatedRecordCallbacks;t.relatedRecordCallbacks=null,this.addHandles(Et(()=>{t.relatedRecordCallbacks=e}),Ote)}exit(){this.removeHandles(Ote)}async updatePendingFeature(t,e){return this._preventDefaultActionOnCancel=!0,this.data.viewModel.sketchViewModel.cancel(),ww(this._lastActiveGraphics,t),this._startUpdating(t,e)}static create(t){const{addAttachmentsCallback:e,applyEditsCallback:i,creationInfo:r,startAt:n,viewModel:s}=t,o=new sk({data:new tw({creationInfo:r,viewModel:s}),onCommit:async a=>{var g;const{creationInfo:l}=a;if(!l)return;l.geometryToPlace&&(a.creationInfo=null);const c=a.pendingFeatures.toArray(),{layer:u}=l,h=((g=u.capabilities)==null?void 0:g.editing.supportsGlobalId)&&"globalIdField"in u,f=o._attachmentFileInfos;if(h){const y=Dlt(c,u,f);return void await i(u,y,{globalIdUsed:!0})}const m=await i(u,{addFeatures:c});if(f.size>0){const y=(m==null?void 0:m.addFeatureResults)??[];await e(u,Flt(c,y,u,f))}}});return o._set("steps",this._createWorkflowSteps(o,n)),o}_fadeExistingFeatures(t){if("effect"in t){const i=t.effect;return t.effect="saturate(0.6) opacity(0.8)",Et(()=>t.effect=i)}const e=t.opacity;return t.opacity=.7,Et(()=>t.opacity=e)}_highlight(t){const e=this.data.viewModel.view;(e==null?void 0:e.type)==="3d"&&this._highlightHandles.set(t,e.highlight(t))}_removeHighlight(t){$i(this._highlightHandles.get(t)),this._highlightHandles.delete(t)}async _startCreating(t){const{data:e}=this,{creationInfo:i}=e;if(i)return this.createFeatureState="create-new",c6(e.viewModel.sketchViewModel,i,t)}async _startUpdating(t,e){const{pendingFeatures:i}=this;i.includes(t)||i.add(t);const{creationInfo:r,viewModel:n}=this.data,{featureFormViewModel:s,layerInfos:o,sketchViewModel:a,view:l}=n;if(!l||!r)return;const c=r.layer,u=J7(o,c),h=u==null?void 0:u.formTemplate,f=l.spatialReference;return s.set({arcadeEditType:"INSERT",feature:t,formTemplate:h,spatialReference:f,map:l.map}),this._removeHighlight(t),await mg(t,e),$i(this._featureFormHandle),this._featureFormHandle=kn([s.on("value-change",async()=>{t.attributes=s.getValues(),await mg(t,e)}),a.on(["update","undo","redo"],m=>{(m.type==="undo"||m.type==="redo"||m.type==="update"&&m.toolEventInfo!=null&&_be(m.toolEventInfo.type))&&s.notifyFeatureGeometryChanged()})]),this.createFeatureState="update-pending",this._visualVariableAttributes=RR(t),e1(c)?void 0:DT({graphic:t,sketchViewModel:a,sourceLayer:c,visualVariables:this._visualVariableAttributes,webStyleCache:e})}static _createWorkflowSteps(t,e="awaiting-feature-creation-info"){const{data:i,handles:r}=t,n=Y7(["awaiting-feature-creation-info","creating-features","adding-attachment","editing-attachment"],e,{"awaiting-feature-creation-info":()=>({id:"awaiting-feature-creation-info",async setUp(s){const{creationInfo:o,viewModel:a}=i,{view:l}=a;if(l)if(AO(o)){const c=await Llt({view:l,data:i,signal:s,next:()=>t.next(),cancel:()=>a.cancelWorkflow()});_t(s),r.add(c,this.id)}else i.creationInfo=null,r.add(a.featureTemplatesViewModel.on("select",({item:c})=>{var u;c&&(i.creationInfo=c,(u=a.activeWorkflow)==null||u.next())}),this.id)},async tearDown(){r.remove(this.id)}}),"creating-features":()=>({id:"creating-features",async setUp(){var f,m;if(r.has(this.id))return;const{viewModel:s}=i,{view:o}=s;if(!o)return;const a=new Map,l=[],c=[];t._lastActiveGraphics=[],t._featureFormHandle=$i(t._featureFormHandle),t._visualVariableAttributes={rotation:null,size:null},ybe(s.attachmentsViewModel),l.push(J(()=>s.attachmentsViewModel.mode,g=>{switch(g){case"add":t.go("adding-attachment");break;case"edit":t.go("editing-attachment")}}));const u=u6(o);l.push(u);const h=e1((f=t.data.creationInfo)==null?void 0:f.layer);try{if(!h){const y=sk._configureSketchViewModel(t,a);l.push(y.beforeCommit),c.push(y.afterCommit)}const g=(m=i.creationInfo)==null?void 0:m.initialFeature;g?(h||s.sketchViewModel.layer.add(g),await t._startUpdating(g,a)):await t._startCreating(a)}finally{u.remove()}l.push(t._featureFormHandle),r.add(l,t._handleKeys.beforeCommit),r.add([...l,...c],this.id)},async tearDown(s){const{viewModel:o}=i;if(s.canceled){const{pendingFeatures:a}=t;a.drain(l=>o.sketchViewModel.layer.remove(l)),r.remove([this.id,tD]),o.attachmentsViewModel.fileInfos.removeAll(),t._attachmentFileInfos.clear()}}}),"adding-attachment":()=>({id:"adding-attachment",parent:"creating-features",async setUp(){},async tearDown(){const{attachmentsViewModel:s}=i.viewModel,{graphic:o,fileInfos:a}=s;t._attachmentFileInfos.set(o,a.toArray()),s.mode="view"}}),"editing-attachment":()=>({id:"editing-attachment",parent:"creating-features",async setUp(){},async tearDown(){const{attachmentsViewModel:s}=i.viewModel,{graphic:o,fileInfos:a}=s;t._attachmentFileInfos.set(o,a.toArray()),s.mode="view"}})});return gbe(i,n)}static _configureSketchViewModel(t,e){const{data:i,handles:r}=t,{viewModel:n}=i,{view:s}=n,o=n.sketchViewModel;let a=null;const l=[];if(!s)return{beforeCommit:Et(),afterCommit:Et()};const c=o.updateOnGraphicClick;return o.updateOnGraphicClick=!1,s.type==="2d"&&i.creationInfo&&l.push(t._fadeExistingFeatures(i.creationInfo.layer)),l.push(o.on("create",async u=>{if(u.state==="cancel"){if(t._preventDefaultActionOnCancel)return void(t._preventDefaultActionOnCancel=!1);if(t._lastActiveGraphics.length<1)return t._startCreating(e);const h=t._lastActiveGraphics.pop();return t._startUpdating(h,e)}if(u.state==="complete"&&u.graphic)return t._startUpdating(u.graphic,e)}),o.on("update",async u=>{var x,S,I;const{viewModel:h}=i,{attachmentsViewModel:f,featureFormViewModel:m}=h,g=u.graphics[0];if(u.state==="complete"){if(g!==a&&(t._lastActiveGraphics.push(g),t._highlight(g)),a=null,t.numPendingFeatures===((x=i.creationInfo)==null?void 0:x.maxFeatures)){const T=t._lastActiveGraphics.pop();return t._startUpdating(T,e)}if(f.mode!=="add"&&f.mode!=="edit"||((S=h.activeWorkflow)==null||S.previous()),u.aborted&&t._preventDefaultActionOnCancel)return void(t._preventDefaultActionOnCancel=!1);r.add([u6(s),s.on("click",T=>T.preventDefault())],tD),await _r(()=>!m.updating),r.remove(tD),t._startCreating(e)}u.state==="start"&&(t._removeHighlight(g),f.mode!=="add"&&f.mode!=="edit"||((I=h.activeWorkflow)==null||I.previous()),f.fileInfos.removeAll(),f.graphic=g,f.mode="view",(t._attachmentFileInfos.get(g)||[]).forEach(({file:T,form:C})=>f.addFile(T,C)));const y=t._visualVariableAttributes;await Z7(s,g,u,y,e);const v=g.attributes,{rotation:b,size:w}=y;if(b!=null){const{field:T}=b;m.setValue(T,v[T])}if(w!=null){const{field:T}=w;m.setValue(T,v[T])}}),o.on("delete",async u=>{const h=u.graphics[0];t.pendingFeatures.remove(h),ww(t._lastActiveGraphics,h),a=h}),s.on("immediate-click",async u=>{if(AO(i.creationInfo))return;const{results:h}=await s.hitTest(u,{include:o.layer}),f=h.find(g=>g.type==="graphic");if(!f)return;const m=f.graphic;if(o.activeTool==="transform"||o.activeTool==="reshape"){if(o.updateGraphics.at(0)===m)return;await t.updatePendingFeature(m,e)}}),Et(()=>o.cancel()),Rlt(o,i)),{beforeCommit:kn(l),afterCommit:Et(()=>{o.updateOnGraphicClick=c})}}};function Rlt(t,e){let i=null;const r=()=>t.snappingOptions.featureSources,n=()=>(i=new O7({layer:t.layer}),r().add(i),i),s=()=>{i!=null&&(r().remove(i),i=je(i))};return kn([J(()=>{var l;const o=(l=e.creationInfo)==null?void 0:l.layer,a=r().find(c=>c.layer===o);return{hasFeatureLayerSource:!!a,enabled:(a==null?void 0:a.enabled)??!1}},({hasFeatureLayerSource:o,enabled:a})=>{if(!o)return s();i??(i=n()),i.enabled=a},ji),Et(s)])}function Flt(t,e,i,r){const n=[];return e.forEach((s,o)=>{if(!s.error){const a=t[o],l=r.get(a)||[];a.attributes[i.objectIdField]=s.objectId,l.forEach(({form:c})=>n.push({feature:a,attachment:c}))}}),n}function Dlt(t,e,i){const r=[],n=e.globalIdField;return t.forEach((s,o)=>{var a;(a=t[o].attributes)[n]??(a[n]=TJ()),((i==null?void 0:i.get(s))||[]).forEach(({file:l})=>r.push({feature:s,attachment:{globalId:TJ(),data:l}}))}),r.length?{addFeatures:t,addAttachments:r}:{addFeatures:t}}d([p()],cd.prototype,"hasPendingEdits",null),d([p()],cd.prototype,"helpMessage",null),d([p()],cd.prototype,"keyboardCancellationEnabled",null),d([p()],cd.prototype,"reliesOnOwnerAdminPrivileges",null),d([p()],cd.prototype,"shouldShowAttachments",null),d([p()],cd.prototype,"shouldAllowAttachmentEditing",null),d([p()],cd.prototype,"updating",null),cd=sk=d([A("esri.widgets.Editor.CreateFeaturesWorkflow")],cd);const bbe=cd;let iw=class extends he{constructor(e){super(e),this.creationInfo=null,this.edits=null,this.viewModel=null}};d([p()],iw.prototype,"creationInfo",void 0),d([p()],iw.prototype,"edits",void 0),d([p()],iw.prototype,"viewModel",void 0),iw=d([A("esri.widgets.Editor.CreateWorkflowData")],iw);const Nlt=iw;function Lte(t){return t==null?null:JSON.stringify(t)}let zh=class extends cn(he){constructor(e){super(e),this._baselineAttributesJSON=null,this._baselineGeometryJSON=null,this._stagedForDelete=!1,this.feature=null}get attributesModified(){var i;const e=(i=this.feature)==null?void 0:i.attributes;return e!=null&&this._baselineAttributesJSON!==this._stringifyAttributes(e)}get geometryModified(){var i;const e=(i=this.feature)==null?void 0:i.geometry;return e!=null&&this._baselineGeometryJSON!==this._stringifyGeometry(e)}get stagedForDelete(){return this._stagedForDelete}get modified(){return this.attributesModified||this.geometryModified||this._stagedForDelete}stageDelete(){this._stagedForDelete=!0}unstageDelete(){this._stagedForDelete=!1}trackChanges(){const{feature:e}=this;if(!e)return;const{attributes:i,geometry:r}=e;this._baselineAttributesJSON=this._stringifyAttributes(i),this._baselineGeometryJSON=this._stringifyGeometry(r),this.notifyChange("attributesModified"),this.notifyChange("geometryModified")}updateAttributes(e){const{feature:i}=this;i&&(i.attributes=e,this.notifyChange("attributesModified"))}updateGeometry(e){const{feature:i}=this;i&&(i.geometry=e,this.notifyChange("geometryModified"))}_stringifyAttributes(e){return Lte(e)}_stringifyGeometry(e){return Lte((e==null?void 0:e.type)==="mesh"?{transform:e.transform,vertexSpace:e.vertexSpace}:e)}};d([p()],zh.prototype,"_stagedForDelete",void 0),d([p()],zh.prototype,"attributesModified",null),d([p()],zh.prototype,"feature",void 0),d([p()],zh.prototype,"geometryModified",null),d([p()],zh.prototype,"modified",null),zh=d([A("esri.widgets.Editor.Edits")],zh);var d6;let sm=d6=class extends FR{constructor(t){super(t),this.type="create"}get shouldShowAttachments(){return!!(this.data&&this.data.creationInfo&&this.data.viewModel)&&vbe(this.data)}get shouldAllowAttachmentEditing(){return this.shouldShowAttachments}get hasPendingEdits(){return!0}get helpMessage(){var n;if(this.stepId!=="editing-new-feature")return;const{creationInfo:t,viewModel:e}=this.data,i=(n=e.sketchViewModel.createGraphic)==null?void 0:n.geometry,r=t.layer.geometryType;return hbe(r,i,e.view)}get reliesOnOwnerAdminPrivileges(){var r,n;const{layer:t}=this.data.creationInfo,e=(r=t.capabilities)==null?void 0:r.operations.supportsAdd,i=(n=Ro(t))==null?void 0:n.operations.supportsAdd;return KO(t)&&!t.editingEnabled||!!i&&!e}static create(t,e,i){const r=new d6({data:new Nlt({edits:new zh,viewModel:t}),onCommit:async n=>{await i(n.creationInfo.layer,{addFeatures:[n.edits.feature]})}});return r._set("steps",this._createWorkflowSteps(r,e)),r}static _createWorkflowSteps(t,e="awaiting-feature-creation-info"){const{data:i,handles:r}=t,n=new Map,s=Y7(["awaiting-feature-creation-info","awaiting-feature-to-create","editing-new-feature","adding-attachment","editing-attachment"],e,{"awaiting-feature-creation-info":()=>({id:"awaiting-feature-creation-info",async setUp(){i.creationInfo=null,i.edits.feature=null,i.viewModel.featureTemplatesViewModel.select(null),r.add(i.viewModel.featureTemplatesViewModel.on("select",({item:o})=>{var a;o&&(i.creationInfo=o,(a=i.viewModel.activeWorkflow)==null||a.next())}),this.id)},async tearDown(){r.remove(this.id)}}),"awaiting-feature-to-create":()=>({id:"awaiting-feature-to-create",async setUp(){r.add(await _lt(i.viewModel.sketchViewModel,i.creationInfo,o=>{var a;i.edits.feature=o,(a=i.viewModel.activeWorkflow)==null||a.next()},n),this.id)},async tearDown(){r.remove(this.id)}}),"editing-new-feature":()=>({id:"editing-new-feature",async setUp(){const o=i.edits.feature,a=o.sourceLayer,l=i.viewModel,c=l.sketchViewModel,u=J7(l.layerInfos,a),h=u==null?void 0:u.formTemplate,{spatialReference:f}=l.view;l.featureFormViewModel.set({arcadeEditType:"INSERT",feature:o,formTemplate:h,spatialReference:f}),c.allowDeleteKey=!1,ybe(l.attachmentsViewModel);const m=RR(o);await DT({graphic:o,sketchViewModel:c,sourceLayer:a,visualVariables:m,webStyleCache:n});const g=c.on("update",async y=>{const v=y.graphics[0];if(y.state==="complete")return DT({graphic:v,sketchViewModel:c,sourceLayer:a,visualVariables:m,webStyleCache:n});await Z7(c.view,v,y,m,n);const b=v.attributes;if(m.rotation!=null){const{field:w}=m.rotation;l.featureFormViewModel.setValue(w,b[w])}if(m.size!=null){const{field:w}=m.size;l.featureFormViewModel.setValue(w,b[w])}});r.add([i.viewModel.featureFormViewModel.on("value-change",async()=>{i.edits.updateAttributes(i.viewModel.featureFormViewModel.getValues()),o.attributes=i.edits.feature.attributes,c.view.type==="3d"&&await mg(o,n)}),g,J(()=>i.viewModel.attachmentsViewModel.mode,y=>{y==="add"&&i.viewModel.activeWorkflow.go("adding-attachment"),y==="edit"&&i.viewModel.activeWorkflow.go("editing-attachment")})],this.id)},async tearDown(o){o.canceled&&i.viewModel.sketchViewModel.layer.removeAll(),r.remove(this.id)}}),"adding-attachment":()=>({id:"adding-attachment",parent:"editing-new-feature",async setUp(){},async tearDown(){i.viewModel.attachmentsViewModel.mode="view"}}),"editing-attachment":()=>({id:"editing-attachment",parent:"editing-new-feature",async setUp(){},async tearDown(){i.viewModel.attachmentsViewModel.mode="view"}})});return gbe(i,s)}};d([p()],sm.prototype,"shouldShowAttachments",null),d([p()],sm.prototype,"shouldAllowAttachmentEditing",null),d([p()],sm.prototype,"hasPendingEdits",null),d([p()],sm.prototype,"helpMessage",null),d([p()],sm.prototype,"reliesOnOwnerAdminPrivileges",null),sm=d6=d([A("esri.widgets.Editor.CreateWorkflow")],sm);const Vlt=sm;var ok;let om=ok=class extends he{constructor(t){super(t),this.attachmentsCapabilities=null,this.editableItem=null,this.edits=null,this.formTemplate=null,this.viewModel=null}static async create(t){const e=ok._makeConstructorProps(t);return new ok(e)}static _makeConstructorProps(t){const{feature:e,viewModel:i}=t,r=i.editableItems.find(l=>l.layer===e.layer);if(!r)throw new N("no-editableItem-found","The EditorViewModel provided did not have an EditableItem associated with the specified Graphic's layer");const n=J7(i.layerInfos,e.sourceLayer),s=r.supports,o=s.includes("create"),a=s.includes("update");return{attachmentsCapabilities:{editing:!0,operations:{add:o||a,update:a,delete:a}},editableItem:r,edits:new zh({feature:e}),formTemplate:n==null?void 0:n.formTemplate,viewModel:i}}};d([p()],om.prototype,"attachmentsCapabilities",void 0),d([p()],om.prototype,"editableItem",void 0),d([p()],om.prototype,"edits",void 0),d([p()],om.prototype,"formTemplate",void 0),d([p()],om.prototype,"viewModel",void 0),om=ok=d([A("esri.widgets.Editor.UpdateRecordWorkflowData")],om);const wbe=om;var ak;let lk=ak=class extends wbe{constructor(t){super(t)}static async create(t){const{feature:e,viewModel:i}=t,{view:r}=i;if(!r)throw new N("editor:cannot-create-workflow-data","The provided EditorViewModel does not have an associated view");const n=await NT(r,e.layer);return new ak({...ak._makeConstructorProps(t),layerView:n})}};d([p()],lk.prototype,"layerView",void 0),lk=ak=d([A("esri.widgets.Editor.UpdateFeatureWorkflowData")],lk);const zlt=lk;var h6;const ck={exit:Symbol()},jlt="esri.widgets.Editor.UpdateRecordWorkflow";let Vl=h6=class extends FR{constructor(t){super(t),this.fullFeature=null,this.type="update-table-record"}async initialize(){const{data:t}=this,{edits:e}=t,i=e.feature,r=new AbortController;this.addHandles(b1e(r)),this.updatingHandles.addPromise(Ilt(i,t.viewModel.view.spatialReference,r.signal).then(n=>{zo(r)||this._onFullFeatureLoaded(n)},n=>this.cancel({force:!0,error:new N("editor:failed-to-fetch-full-feature","Failed to retrieve all information for this feature. The update cannot proceed.",{detail:{error:n}})})))}get editableItem(){return this.data.editableItem}get hasPendingEdits(){return this.data.edits.modified}get shouldShowAttachments(){return this.editableItem.attachmentsOnUpdateEnabled}get shouldAllowAttachmentEditing(){return this.editableItem.supports.includes("update")}get updating(){return this.updatingHandles.updating}get reliesOnOwnerAdminPrivileges(){var r,n;const{layer:t}=this.editableItem,e=(r=t.capabilities)==null?void 0:r.operations.supportsUpdate,i=(n=Ro(t))==null?void 0:n.operations.supportsUpdate;return KO(t)&&!t.editingEnabled||!!i&&!e}async deleteAndCommit(){return this.data.edits.stageDelete(),this.commit()}async enter(){this._configureAttachmentsViewModel(),this._configureFeatureFormViewModel()}exit(t){this.removeHandles(ck.exit)}_configureAttachmentsViewModel(){const{data:t,fullFeature:e}=this,{attachmentsCapabilities:i,viewModel:r}=t,{attachmentsViewModel:n}=r;n.set({capabilities:i,graphic:e,filesEnabled:!1,mode:"view"}),this.addHandles(J(()=>n.mode,s=>{switch(s){case"add":this.go("adding-attachment");break;case"edit":this.go("editing-attachment")}}),ck.exit)}_configureFeatureFormViewModel(){const{edits:t,formTemplate:e,viewModel:{featureFormViewModel:i,view:r}}=this.data;i.set({arcadeEditType:"UPDATE",feature:this.fullFeature,formTemplate:e,map:r==null?void 0:r.map,spatialReference:r.spatialReference}),this.addHandles(i.on("value-change",()=>{t.updateAttributes(i.getValues()),this.fullFeature.attributes=t.feature.attributes}),ck.exit)}_onFullFeatureLoaded(t){this.fullFeature=t;const{edits:e}=this.data;e.updateAttributes(t.attributes),e.trackChanges()}static async create(t){const e=new h6({data:await wbe.create(t),onCommit:this._onCommitFactory(t.applyEdits)});return e._set("steps",this._createWorkflowSteps(e)),e}static _createWorkflowSteps(t){const{attachmentsViewModel:e}=t.data.viewModel;return[{id:"editing-attributes",async setUp(){},async tearDown(){}},{id:"adding-attachment",async setUp(){},async tearDown(){e.mode="view"}},{id:"editing-attachment",async setUp(){},async tearDown(){e.mode="view"}}]}};Vl._onCommitFactory=t=>async e=>{var a;const{edits:i}=e,{feature:r}=i;if(!r)return;const n=r.sourceLayer,s=r.clone();if(!i.attributesModified||i.stagedForDelete){const l=n.objectIdField;if(s.attributes={[l]:r.getAttribute(l)},h9()&&d9()&&n.type==="scene"&&n.infoFor3D!=null){const c=(a=n.associatedLayer)==null?void 0:a.globalIdField;c!=null&&s.setAttribute(c,r.getAttribute(c))}}i.geometryModified&&!i.stagedForDelete||(s.geometry=null);const o=i.stagedForDelete?"deleteFeatures":"updateFeatures";await t(n,{[o]:[s]})},d([p()],Vl.prototype,"editableItem",null),d([p()],Vl.prototype,"fullFeature",void 0),d([p()],Vl.prototype,"hasPendingEdits",null),d([p()],Vl.prototype,"shouldShowAttachments",null),d([p()],Vl.prototype,"shouldAllowAttachmentEditing",null),d([p()],Vl.prototype,"updating",null),d([p()],Vl.prototype,"reliesOnOwnerAdminPrivileges",null),Vl=h6=d([A(jlt)],Vl);var p6;const ju={...ck,highlights:Symbol(),interactiveGraphics:Symbol(),geometryGraphics:Symbol()};let uk=p6=class extends Vl{constructor(t){super(t),this.type="update-feature",this._layerViewEditSession=null,this._webStyleCache=new Map}async initialize(){const{edits:{feature:t},layerView:e}=this.data;Olt(e)&&(this._layerViewEditSession=e.createInteractiveEditSession(t))}destroy(){var t;(t=this._layerViewEditSession)==null||t.rollback()}async commit(){this.removeHandles(ju.interactiveGraphics);try{const t=this.data.edits.stagedForDelete;await super.commit(),this.removeHandles(ju.geometryGraphics);const e=this._layerViewEditSession;t?e==null||e.rollback():e==null||e.commit()}catch(t){throw this.removeHandles(ju.geometryGraphics),await this._configureSketchViewModel(),new N("editor-workflow:failed-to-commit","An error occurred when sending the updates to the service",{error:t})}}async enter(){await super.enter(),this.data.editableItem.geometryUpdatesEnabled?this.hasHandles(ju.interactiveGraphics)||await this._configureSketchViewModel():this._configureHighlight()}exit(t={removeSketchHandles:!0}){super.exit(t),t.removeSketchHandles&&this.removeHandles([ju.geometryGraphics,ju.interactiveGraphics])}_configureFeatureFormViewModel(){super._configureFeatureFormViewModel();const{_layerViewEditSession:t}=this,{viewModel:e}=this.data;this.addHandles(e.featureFormViewModel.on("value-change",i=>{t==null||t.setAttribute(i.fieldName,i.value)}),ju.exit)}_configureHighlight(){const{edits:t,layerView:e}=this.data;sR(e)&&this.addHandles(e.highlight(t.feature),ju.highlights)}async _configureSketchViewModel(){const{data:t,_layerViewEditSession:e}=this,{edits:i,viewModel:r}=t,n=i.feature,{featureFormViewModel:s,sketchViewModel:o,view:a}=r;o.allowDeleteKey=!1;const l=RR(n),{interactive:c,visual:u}=await Elt(n,l,o,a,({geometry:h,attributes:f},m)=>{if(i.updateAttributes(f),i.updateGeometry(h),s.feature.geometry=h,l.rotation!=null){const{field:y}=l.rotation;s.setValue(y,f[y])}if(l.size!=null){const{field:y}=l.size;s.setValue(y,f[y])}const{sourceLayer:g}=n;g!=null&&g.type==="scene"&&g.infoFor3D!=null&&h9()&&d9()&&e&&h!=null&&h.type==="mesh"&&e.setGeometry(h),(m.type==="undo"||m.type==="redo"||m.type==="update"&&m.toolEventInfo!=null&&_be(m.toolEventInfo.type))&&s.notifyFeatureGeometryChanged()},this._webStyleCache);this.addHandles(c,ju.interactiveGraphics),this.addHandles(u,ju.geometryGraphics)}_onFullFeatureLoaded(t){super._onFullFeatureLoaded(t);const{edits:e}=this.data;e.updateGeometry(t.geometry),e.trackChanges()}static async create(t){const e=new p6({data:await zlt.create(t),onCommit:this._onCommitFactory(t.applyEdits)});return e._set("steps",this._createWorkflowSteps(e)),e}};d([p()],uk.prototype,"_layerViewEditSession",void 0),uk=p6=d([A("esri.widgets.Editor.UpdateFeatureWorkflow")],uk);let am=class extends he{constructor(t){super(t),this.addAttachmentsCallback=null,this.applyEditsCallback=null,this.candidates=null,this.rootFeature=null,this.viewModel=null}};d([p()],am.prototype,"addAttachmentsCallback",void 0),d([p()],am.prototype,"applyEditsCallback",void 0),d([p()],am.prototype,"candidates",void 0),d([p()],am.prototype,"rootFeature",void 0),d([p()],am.prototype,"viewModel",void 0),am=d([A("esri.widgets.Editor.UpdateWorkflowData")],am);const Blt=am;var f6;const Rte="candidate-highlight",xbe="esri.widgets.Editor.UpdateWorkflow",Ult=ie.getLogger(xbe);let ca=f6=class extends FR{constructor(t){super(t),this._workflowStack=new iT(e=>{let i;for(i of e);return i}),this.type="update"}get activeEditableItem(){const{activeWorkflow:t}=this;return Fte(t)?t.data.editableItem:void 0}get activeWorkflow(){return this._workflowStack.last()}get nestedWorkflowCount(){return this._workflowStack.length}get shouldShowAttachments(){var t;return!!((t=this.activeEditableItem)!=null&&t.attachmentsOnUpdateEnabled)}get shouldAllowAttachmentEditing(){var t;return!!((t=this.activeEditableItem)!=null&&t.supports.includes("update"))}get hasPendingEdits(){return Array.from(this._workflowStack).some(t=>t.hasPendingEdits)}get helpMessage(){return this.stepId==="awaiting-feature-to-update"?"select":void 0}get reliesOnOwnerAdminPrivileges(){var t;return((t=this.activeWorkflow)==null?void 0:t.reliesOnOwnerAdminPrivileges)??!1}get hasInvalidFormTemplate(){var t;return!!((t=this.activeEditableItem)!=null&&t.hasInvalidFormTemplate)}get hasUnsupportedFields(){var t;return!!((t=this.activeEditableItem)!=null&&t.hasUnsupportedFields)}get updating(){return this.updatingHandles.updating}async back(t=()=>Promise.resolve(!0)){const{featureFormViewModel:e}=this.data.viewModel;if(e.relationshipId==null)if(this.activeWorkflow){if(this.activeWorkflow.hasPendingEdits&&!await t())return;this.activeWorkflow.hasPreviousStep?await this.activeWorkflow.previous({cancelCurrentStep:!0}):await this.cancelActiveWorkflow({force:!0})}else this.hasPreviousStep?await this.previous({cancelCurrentStep:!0}):await this.cancel({force:!0});else e.relationshipId=null}async cancelActiveWorkflow(t){var e;await((e=this.activeWorkflow)==null?void 0:e.cancel(t)),await this._popWorkflow()}async commit(){await this._drainWorkflowStack(t=>t.commit()),await super.commit()}static create(t,e,i){const r=new f6({data:new Blt({applyEditsCallback:i,viewModel:t}),onCommit:async()=>{}});return r._set("steps",this._createWorkflowSteps(r,e)),r}async save(){var t;this.nestedWorkflowCount>1?(await((t=this.activeWorkflow)==null?void 0:t.commit()),await this._popWorkflow()):await this.commit()}async startCreatingRelatedRecord(t){try{const e=await this._createNestedCreateFeaturesWorkflow(t);await this._pushWorkflow(e)}catch(e){throw new N("editor:unable-to-start-creating","Could not begin updating the provided feature or table record.",{error:e})}}async startUpdating(t){try{const e=await this._createNestedUpdateWorkflow(t);await this._pushWorkflow(e)}catch(e){throw new N("editor:unable-to-start-updating","Could not begin updating the provided feature or table record.",{error:e})}}async deleteActiveFeature(){const{activeWorkflow:t}=this;if(!t)throw new N("editor:nothing-to-delete","There is no feature to delete");Fte(t)?await t.deleteAndCommit():await t.cancel(),this.nestedWorkflowCount===1?await this.reset():await this._popWorkflow()}async cancelAll(){await this._drainWorkflowStack(t=>t.cancel({force:!0}))}async _createNestedCreateFeaturesWorkflow(t){const{relatedLayer:e}=t,{addAttachmentsCallback:i,applyEditsCallback:r,viewModel:n}=this.data;if(!aC(e))throw new N("editor:unsupported-layer","Editing is not supported on the provided layer");const s=new Or({sourceLayer:e,attributes:this._makeRelatedRecordAttributes(t)});return bbe.create({addAttachmentsCallback:i,applyEditsCallback:r,creationInfo:{layer:e,initialFeature:s,maxFeatures:1},startAt:"creating-features",viewModel:n})}async _createNestedUpdateWorkflow(t){const e=e1(t.sourceLayer)?Vl:uk,{applyEditsCallback:i,viewModel:r}=this.data,n=await e.create({feature:t,viewModel:r,applyEdits:i});return await _r(()=>!n.updating),n}async _drainWorkflowStack(t){const e=this._workflowStack,i=[];for(;e.length>0;){const r=e.pop(),n=t(r).then(()=>r.destroy());this.updatingHandles.addPromise(n),i.push(n)}await Promise.all(i)}_highlight(t){this._removeHighlight();const e=this.data.viewModel.view;if(!e||!t)return;const i=t&&e.allLayerViews.items.find(({layer:r})=>{var n,s;return r===t.layer||((n=t.layer)==null?void 0:n.type)==="subtype-sublayer"&&((s=t.layer)==null?void 0:s.parent)===r});sR(i)&&this.handles.add(i.highlight(t),Rte)}_makeRelatedRecordAttributes(t){var l,c;const{parentFeature:e,relatedLayer:i,relationshipId:r}=t;if(!rqe(e))return;const n=(l=i.relationships)==null?void 0:l.find(u=>u.id===r);if(!n)return void aS("relationship-not-found","Could not begin creating a related record because the relationship specified could not be found on the destination layer.");if(n.role==="origin")return void aS("unsupported-role","Creating new related records in the 'origin' table of a relationship is not yet supported");const s=e.sourceLayer;n.relatedTableId!==s.layerId&&aS("invalid-argument-combination","The given parent feature does not belong to the relationship designated by the given relationship ID.");const o=(c=s.relationships)==null?void 0:c.find(u=>u.id===r);if(!o)return void aS("relationship-not-found","Could not begin creating a related record because the relationship specified could not be found on the origin layer.");const a=e.getAttribute(o.keyField);return a||aS("no-key-on-origin-feature","The given parent feature does not have a value for the relationship's origin primary key field."),{[n.keyField]:a}}async _popWorkflow(){var e;(e=this._workflowStack.pop())==null||e.destroy();const t=await this._reconcileWorkflowStack();if(t.failureCount>0)throw new N("editor:next-workflow-failed","Popped the top workflow, but the next workflow in the stack failed to activate",t)}async _pushWorkflow(t){var r;const e=this._workflowRequiresSketchViewModel(t);(r=this.activeWorkflow)==null||r.exit({removeSketchHandles:e}),await t.start(),this._workflowStack.push(t);const i=await this._reconcileWorkflowStack();if(i.failureCount>0)throw new N("editor:failed-to-start-updating-feature","Failed to enter the provided workflow.",i)}async _reconcileWorkflowStack(){const t=this._workflowStack;try{const e=t.peek();return await(e==null?void 0:e.enter()),{activeWorkflow:e,failureCount:0}}catch{t.pop().destroy();const{activeWorkflow:i,failureCount:r}=await this._reconcileWorkflowStack();return{activeWorkflow:i,failureCount:r+1}}}_removeHighlight(){this.handles.remove(Rte)}_workflowRequiresSketchViewModel(t){var i;const{type:e}=t;return e==="update-features"||e==="create-features"&&!e1((i=t.data.creationInfo)==null?void 0:i.layer)}static _createWorkflowSteps(t,e="awaiting-feature-to-update"){const{data:i,handles:r}=t;return Y7(["awaiting-feature-to-update","awaiting-update-feature-candidate","editing-existing-feature","adding-attachment","editing-attachment"],e,{"awaiting-feature-to-update":()=>({id:"awaiting-feature-to-update",async setUp(){const{spinnerViewModel:n}=i.viewModel,s=i.viewModel.view;let o=null;r.add(Et(()=>{o=Qr(o)}),this.id),i.rootFeature=null,i.candidates=[];const a=s.on("immediate-click",async l=>{n.location=l.mapPoint,n.visible=!0,o==null||o.abort();const{editableItems:c}=i.viewModel;o=new AbortController;const u=await new Promise((h,f)=>{Fo(o==null?void 0:o.signal,()=>f(wi())),h(Slt(c,s,l,o==null?void 0:o.signal))});_t(o),i.candidates=u.reduce((h,f)=>f.error?h:[...h,...f.value],[]),n.visible=i.candidates.length===1,i.candidates.length!==0&&(i.candidates.length===1?(i.rootFeature=i.candidates[0],t.go("editing-existing-feature").catch(()=>{}).then(()=>n.visible=!1)):t.next())});s.focus(),r.add(a,this.id)},async tearDown(){r.remove(this.id)}}),"awaiting-update-feature-candidate":()=>({id:"awaiting-update-feature-candidate",async setUp(){i.rootFeature=null,r.add([J(()=>i.rootFeature,n=>t._highlight(n),Ca),Et(()=>t._removeHighlight())],this.id)},async tearDown(){r.remove(this.id)}}),"editing-existing-feature":()=>({id:"editing-existing-feature",async setUp(){const{rootFeature:n,viewModel:s}=t.data;if(!n)throw new N("editor:no-feature-specified","Cannot setup the 'updating-existing-feature' step until the root feature is defined");await t.startUpdating(n),s.spinnerViewModel.visible=!1;const o=Ad(async()=>{await _r(()=>!t.updating),t.previous()}),{featureFormViewModel:a}=i.viewModel,l=a.relatedRecordCallbacks;a.relatedRecordCallbacks={addRelatedRecord:async c=>{await t.startCreatingRelatedRecord(c),a.relationshipId=null},editRelatedRecord:async({relatedFeature:c})=>{await t.startUpdating(c),a.relationshipId=null},showAllRelatedRecords:c=>a.relationshipId=c.relationshipId},r.add([Et(()=>a.relatedRecordCallbacks=l),J(()=>t.nestedWorkflowCount,(c,u)=>{c===0&&u!==0&&o()},Ca)],this.id)},async tearDown(){await t.cancelAll(),r.remove(this.id)}}),"adding-attachment":()=>({id:"adding-attachment",parent:"editing-existing-feature",async setUp(){},async tearDown(){i.viewModel.attachmentsViewModel.mode="view"}}),"editing-attachment":()=>({id:"editing-attachment",parent:"editing-existing-feature",async setUp(){},async tearDown(){i.viewModel.attachmentsViewModel.mode="view"}})})}};d([p()],ca.prototype,"activeEditableItem",null),d([p()],ca.prototype,"activeWorkflow",null),d([p()],ca.prototype,"nestedWorkflowCount",null),d([p()],ca.prototype,"shouldShowAttachments",null),d([p()],ca.prototype,"shouldAllowAttachmentEditing",null),d([p()],ca.prototype,"hasPendingEdits",null),d([p()],ca.prototype,"helpMessage",null),d([p()],ca.prototype,"reliesOnOwnerAdminPrivileges",null),d([p()],ca.prototype,"hasInvalidFormTemplate",null),d([p()],ca.prototype,"hasUnsupportedFields",null),d([p()],ca.prototype,"updating",null),ca=f6=d([A(xbe)],ca);const aS=(t,e)=>Ult.warn(`editor:${t}`,e,"The create operation will be allowed to proceed, but the resulting feature may not be related to the given parent feature."),Fte=t=>!!t&&/update-/.test(t.type),Glt=ca,Sbe="esri.widgets.Editor.EditorViewModel",L2=ie.getLogger(Sbe),Ibe=["create","create-features","update"];function oh(t,e,i){L2.error(new N(t,e,i))}function Hlt(t,e){return t?t.find(i=>i.layer===e):void 0}let Ht=class extends cn(an.EventedAccessor){constructor(e){super(e),this._editableItems=new ye,this._sketchGraphicsLayer=new C7({listMode:"hide",internal:!0}),this._updateEditableItemsTask=null,this.activeWorkflow=null,this._activityQueue=[],this.failures=[],this.attachmentsViewModel=new j7({capabilities:{editing:!0}}),this.featureFormViewModel=new sbe,this.featureTemplatesViewModel=new a6,this.sketchViewModel=new Xve({layer:this._sketchGraphicsLayer}),this.spinnerViewModel=new W7,this.pageStack=[],this.showDiscardEditsPrompt=()=>Promise.resolve(!0),this._candidateCommitted=!1,this.useDeprecatedCreateWorkflow=!1,this.back=async()=>{var i;this.canGoBack&&((i=this.activeWorkflow)!=null&&i.hasPreviousStep?await this.activeWorkflow.back(this.showDiscardEditsPrompt):await this._cancelWorkflow({force:!this.hasPendingEdits}))},this.saveWorkflow=async()=>{var n;const{featureFormViewModel:i}=this;if(i.submit(),!i.submittable)return;const r=i.getValues();i.validateContingencyConstraints(r,{includeIncompleteViolations:!0}).length>0||await((n=this.activeWorkflow)==null?void 0:n.save())},this.selectFeature=(i,r=!1)=>{const n=this.activeWorkflow;this._candidateCommitted||(n==null?void 0:n.type)!=="update"||(n.data.rootFeature=i,r&&(n.next(),this._candidateCommitted=!0))}}initialize(){this.addHandles([J(()=>{var n,s,o;const e=(s=(n=this.view)==null?void 0:n.map)==null?void 0:s.editableLayers.filter(({parent:a,visible:l})=>a&&"visible"in a?l&&a.visible:l),i=(o=this.view)==null?void 0:o.allLayerViews,r=i==null?void 0:i.filter(a=>!!(e!=null&&e.includes(a.layer))&&!a.suspended);return[e,r,this.layerInfos,this.allowedWorkflows]},()=>this._updateEditableItems(),Le),ui(()=>this.activeWorkflow,"cancel",()=>this.emit("workflow-cancel")),ui(()=>this.activeWorkflow,"commit",()=>this.emit("workflow-commit")),ui(()=>this.activeWorkflow,"complete",()=>{this.emit("workflow-commit"),this._set("activeWorkflow",null)}),tn(()=>{var e;return(e=this.view)==null?void 0:e.map},e=>e.add(this._sketchGraphicsLayer),Le),J(()=>this._editableItems.toArray(),()=>{const{activeWorkflow:e}=this;if(this.refreshCreationTemplates(),!e)return;const{stepId:i}=e;e.type!=="create"?e.type==="update"&&(i==="awaiting-feature-to-update"&&!this.canUpdate||i==="awaiting-update-feature-candidate"&&!e.data.candidates.some(r=>{const n=this._editableItems.find(s=>s.layer===r.layer);return n&&n.supports.includes("update")}))&&this._cancelWorkflow():i!=="awaiting-feature-creation-info"||this.canCreate||this._cancelWorkflow()}),J(()=>this.page,(e,i)=>{const r=this.pageStack.slice(),n=r.indexOf(e);n===-1&&i?r.push(i):r.splice(n),this.pageStack=r}),tn(()=>this.state==="awaiting-update-feature-candidate",()=>this._candidateCommitted=!1),ui(()=>this.featureTemplatesViewModel,"select",async({item:e,oldItem:i})=>{var a;const{activeWorkflow:r}=this,n=!!e&&e.id===(i==null?void 0:i.id),s=(r==null?void 0:r.type)==="create-features"&&((a=r.data.upload)==null?void 0:a.error);if(r)try{await this.cancelWorkflow({force:!this.hasPendingEdits})}catch{return this.featureTemplatesViewModel.select(i,{emit:!1})}if(!e||n&&!s)return;const o={layer:e.layer,template:e.template};if(e.supportsUpload)return this.startCreateFeaturesWorkflow(o);this.useDeprecatedCreateWorkflow?this.startCreateWorkflowAtFeatureCreation(o):this.startCreateFeaturesWorkflowAtFeatureCreation(o)}),ui(()=>this.view,"key-down",e=>{var i;e.key==="Escape"&&((i=this.activeWorkflow)!=null&&i.keyboardCancellationEnabled)&&this.back()})])}destroy(){this._cancelWorkflow().then(()=>{var e;(e=this.view)!=null&&e.map&&this.view.map.remove(this._sketchGraphicsLayer),this.view=null}),this._updateEditableItemsTask=Qr(this._updateEditableItemsTask)}get allowedWorkflows(){return this._get("allowedWorkflows")}set allowedWorkflows(e){e&&e.length!==0||(e=[...Ibe]),this._set("allowedWorkflows",e)}get canCreate(){return this._editableItems.some(e=>e.supports.includes("create"))}get canUpdate(){return this._editableItems.some(({attachmentsOnUpdateEnabled:e,layer:i,supports:r})=>{const n=r.includes("update")||r.includes("delete")||e,s=i.parent,o=!(s&&"visible"in s)||!!s.visible;return i.visible&&o&&n})}get editableItems(){return this._editableItems}get labelOptions(){return this.sketchViewModel.labelOptions}set labelOptions(e){this.sketchViewModel.labelOptions=e}set layerInfos(e){e==null||e.some(i=>("allowAttachments"in i&&_p(L2,"Property: layerInfo.allowAttachments",{replacement:"layerInfo.attachmentsOnCreateEnabled or layerInfo.attachmentsOnUpdateEnabled",version:"4.26"}),!0)),this._set("layerInfos",e)}get snappingOptions(){return this.sketchViewModel.snappingOptions}set snappingOptions(e){this.sketchViewModel.snappingOptions=e}get state(){if(!this.get("view.ready")||this._editableItems.length===0)return"disabled";const e=this.attachmentsViewModel.mode;if(e==="add")return"adding-attachment";if(e==="edit")return"editing-attachment";const{activeWorkflow:i}=this;return i?i.stepId:"ready"}get syncing(){return this._activityQueue.length>0}get updating(){return this.updatingHandles.updating}get tooltipOptions(){return this.sketchViewModel.tooltipOptions}set tooltipOptions(e){this.sketchViewModel.tooltipOptions=e}set view(e){this.sketchViewModel.view=e,this.spinnerViewModel.view=e,this._set("view",e)}get page(){const{activeWorkflow:e,state:i}=this;return i==="awaiting-feature-to-update"||i==="awaiting-feature-to-create"||(e==null?void 0:e.type)==="create-features"&&e.numPendingFeatures===0?"ready":i??"disabled"}get selectedTemplateItem(){var i;const{activeWorkflow:e}=this;if((e==null?void 0:e.type)==="create-features"&&e.numPendingFeatures===0){const r=(i=e.data.creationInfo)==null?void 0:i.template;if(!r)return;for(const n of this.featureTemplatesViewModel.items)if("findByTemplate"in n){const s=n.findByTemplate(r);if(s)return s}else if(n.template===r)return n}}get featureFormDisabled(){var i;const{activeWorkflow:e}=this;return(e==null?void 0:e.type)==="update"&&((i=e.activeEditableItem)==null?void 0:i.attributeUpdatesEnabled)===!1}get canGoBack(){return this.activeWorkflow!=null&&!this.syncing}get shouldShowDeleteButton(){var i;const{activeWorkflow:e}=this;return!!e&&e.type==="update"&&!!((i=e.activeEditableItem)!=null&&i.supports.includes("delete"))}get hasPendingEdits(){var e;return((e=this.activeWorkflow)==null?void 0:e.hasPendingEdits)??!1}async startCreateWorkflowAtFeatureTypeSelection(){if(Hw(L2,"startCreateWorkflowAtFeatureTypeSelection","startCreateFeaturesWorkflowAtFeatureTypeSelection"),await _r(()=>!this.updating),!this.canCreate)return void oh("editing:unsupported-workflow","Create workflow is unsupported or disabled.");await this._cancelWorkflow();const e=this._createCreateWorkflow();await e.start(),this._set("activeWorkflow",e)}async startCreateFeaturesWorkflowAtFeatureTypeSelection(){return this.startCreateFeaturesWorkflow()}async startCreateWorkflowAtFeatureCreation(e){if(Hw(L2,"startCreateWorkflowAtFeatureCreation","startCreateFeaturesWorkflowAtFeatureCreation"),await _r(()=>!this.updating),!this.canCreate)return void oh("editing:unsupported-workflow","Create workflow is unsupported or disabled.");await this._cancelWorkflow();const i=this._createCreateWorkflow("awaiting-feature-to-create");i.data.creationInfo=e,await i.start(),this._set("activeWorkflow",i)}async startCreateFeaturesWorkflowAtFeatureCreation(e){return this.startCreateFeaturesWorkflow(e,"creating-features")}async startCreateFeaturesWorkflow(e,i="awaiting-feature-creation-info"){if(await _r(()=>!this.updating),!this.canCreate)throw new N("editing:unsupported-workflow","Creating features is unsupported or disabled.");await this._cancelWorkflow();const r=this._createCreateFeaturesWorkflow(e,i);await r.start(),this._set("activeWorkflow",r)}async startCreateWorkflowAtFeatureEdit(e){if(Hw(L2,"startCreateWorkflowAtFeatureEdit"),await _r(()=>!this.updating),!this.canCreate)return void oh("editing:unsupported-workflow","Create workflow is unsupported or disabled.");await this._cancelWorkflow();const i=this._createCreateWorkflow("editing-new-feature");i.data.edits.feature=e,await i.start(),this._set("activeWorkflow",i)}async startUpdateWorkflowAtFeatureSelection(){if(await _r(()=>!this.updating),!this.canUpdate)return void oh("editing:unsupported-workflow","Update workflow is unsupported or disabled.");await this._cancelWorkflow();const e=this._createUpdateWorkflow();await e.start(),this._set("activeWorkflow",e)}async startUpdateWorkflowAtMultipleFeatureSelection(e){if(await _r(()=>!this.updating),!this.canUpdate)return void oh("editing:unsupported-workflow","Update workflow is unsupported or disabled.");await this._cancelWorkflow();const i=this._createUpdateWorkflow("awaiting-update-feature-candidate");i.data.candidates=e,await i.start(),this._set("activeWorkflow",i)}async startUpdateWorkflowAtFeatureEdit(e){if(await _r(()=>!this.updating),!this.canUpdate)return void oh("editing:unsupported-workflow","Update workflow is unsupported or disabled.");await this._cancelWorkflow();const i=this._createUpdateWorkflow("editing-existing-feature");i.data.rootFeature=e,await i.start(),this._set("activeWorkflow",i)}async deleteFeatureFromWorkflow(){const{activeWorkflow:e}=this;e&&e.type==="update"?await e.deleteActiveFeature():oh("editing:unsupported-workflow","Deleting requires an active update workflow.")}async cancelWorkflow(e){return this._cancelWorkflow({warn:!0,...e})}findEditableItemForLayer(e){const i=e.type==="subtype-sublayer"?e.parent:e;return this._editableItems.find(r=>r.layer===i)}itemHasInvalidFormTemplate(e){var i;return!!e&&(((i=this.findEditableItemForLayer(e.layer))==null?void 0:i.hasInvalidFormTemplate)??!1)}itemHasUnsupportedFields(e){var i;return!!e&&(((i=this.findEditableItemForLayer(e.layer))==null?void 0:i.hasUnsupportedFields)??!1)}refreshCreationTemplates(){const e=[];for(const{layer:i,supports:r}of this._editableItems)i.loaded&&r.includes("create")&&e.push(i);this.featureTemplatesViewModel.layers=e}async toggleUpdateWorkflow(){this.canUpdate&&(this.hasPendingEdits&&!await this.showDiscardEditsPrompt()||(this.activeWorkflow&&this.state==="awaiting-feature-to-update"?await this.cancelWorkflow({force:!0}):await this.startUpdateWorkflowAtFeatureSelection()))}async _updateEditableItems(){Qr(this._updateEditableItemsTask);const e=Cp(async i=>{var f,m;const r=(f=this.view)==null?void 0:f.allLayerViews,n=(m=this.view)==null?void 0:m.map,s=(n==null?void 0:n.editableLayers.toArray())??[],o=(n==null?void 0:n.allTables.toArray().filter(xB))??[];await Promise.all(o.map(g=>g.load()));const a=o.filter(g=>aC(g)),l=[...s.reverse(),...a.reverse()].filter(g=>{var y;return g.geometryType!=="mesh"||((y=this.view)==null?void 0:y.type)==="3d"});if(!r||!s)return;const c=[],u=[];for(const g of l){const y=r.find(b=>b.layer===g),v=y?c:u;if(g.type==="subtype-group"){await g.loadAll(),_t(i);for(let b=g.sublayers.length-1;b>=0;--b)v.push(this._makeEditableItemForLayer(g.sublayers.at(b),!!(y!=null&&y.suspended)))}else v.push(this._makeEditableItemForLayer(g,!!(y!=null&&y.suspended)))}if(i.aborted)return;const h=this._editableItems;this._editableItems=new ye(c.concat(u)),h.destroy()});this.updatingHandles.addPromise(e.promise),this._updateEditableItemsTask=e}async _cancelWorkflow(e){const i=this.activeWorkflow;if(!i)return void(e&&e.warn&&oh("editing:no-active-workflow","There is no active workflow to cancel."));if(!e||e.force!==!1)return this.emit("workflow-cancel"),this._set("activeWorkflow",null),void await i.cancel(e);await i.cancel(e),this._set("activeWorkflow",null)}_createCreateFeaturesWorkflow(e,i){return bbe.create({viewModel:this,creationInfo:e,startAt:i,applyEditsCallback:(r,n,s)=>this._applyEdits(r,n,s),addAttachmentsCallback:(r,n)=>this._addAttachments(r,n)})}_createCreateWorkflow(e){return Vlt.create(this,e,(i,r,n)=>this._applyEdits(i,r,n))}_createUpdateWorkflow(e){return Glt.create(this,e,(i,r)=>this._applyEdits(i,r))}_addAttachments(e,i){const r=i.map(n=>this._addAttachment(e,n.feature,n.attachment))??[];return Promise.all(r)}async _addAttachment(e,i,r){let n=null;if(e.type==="geojson"||e.type==="scene"||e.type==="oriented-imagery")throw new N("editor:attachments-not-supported","Adding attachments is not supported for this layer type");return await this._queueOperation(async()=>{var s;return n=await((s=e.addAttachment)==null?void 0:s.call(e,i,r).catch(o=>{throw(o==null?void 0:o.error)||o}))??null,n}),n}async _applyEdits(e,i,r){let n=null;const s=e.url?await IB(e.url):null,o={returnServiceEditsOption:(!s||!FD(s))&&!RegExp("/hosted/","i").test(e.url)?"original-and-current-features":void 0,...r};return await this._queueOperation(async()=>{const a=await NT(this.view,e).catch(()=>null);return n=await e.applyEdits(i,o),a&&await _r(()=>!a.updating),n}),n}_queueOperation(e){this._activityQueue.push(e),this.notifyChange("syncing");const i=(r,n)=>{const s=n.indexOf(r);s>-1&&n.splice(s,1)};return e().then(r=>{if("error"in r&&r.error)throw r.error;if("addFeatureResults"in r){const{addFeatureResults:n,deleteFeatureResults:s,updateFeatureResults:o}=r,a=n.find(l=>!!l.error)||o.find(l=>!!l.error)||s.find(l=>!!l.error);if(a)throw a.error}return r}).catch(r=>{oh("editing:operation-error","An error occurred.",{error:r});const n={error:r,retry:()=>(i(n,this.failures),this._queueOperation(e)),cancel:()=>{i(n,this.failures)}};this._set("failures",[...this.failures,n])}).then(()=>{i(e,this._activityQueue),this.notifyChange("syncing")})}_makeEditableItemForLayer(e,i=!0){var S,I;const r=Ro(e),n=r==null?void 0:r.operations,s=Hlt(this.layerInfos,e),o=OHe(e),a=e.fields.some(({type:T})=>Cj.has(T)),l=o||a,{allowedWorkflows:c}=this,u=c.includes("create")||c.includes("create-features"),h=c.includes("update"),f=T=>!s||s.enabled!==!1&&s[T]!==!1,m=u&&!!(n!=null&&n.supportsAdd)&&f("addEnabled"),g=h&&!!(n!=null&&n.supportsUpdate)&&f("updateEnabled"),y=!l&&h&&!!(n!=null&&n.supportsDelete)&&f("deleteEnabled"),v=[];i||(m&&v.push("create"),g&&v.push("update"),y&&v.push("delete"));const b=g&&!l&&(!s||s.attributeUpdatesEnabled!==!1),w=g&&!l&&!!((S=r==null?void 0:r.editing)!=null&&S.supportsGeometryUpdate)&&(!s||s.geometryUpdatesEnabled!==!1),x=!(!((I=r==null?void 0:r.data)!=null&&I.supportsAttachment)||s&&s.allowAttachments===!1);return{layer:e,supports:v,attributeUpdatesEnabled:b,geometryUpdatesEnabled:w,hasAttachments:x,attachmentsOnCreateEnabled:x&&u&&(!s||s.attachmentsOnCreateEnabled!==!1),attachmentsOnUpdateEnabled:!l&&x&&(!s||s.attachmentsOnUpdateEnabled!==!1),hasInvalidFormTemplate:o,hasUnsupportedFields:a}}};d([p()],Ht.prototype,"_editableItems",void 0),d([p({readOnly:!0})],Ht.prototype,"activeWorkflow",void 0),d([p({readOnly:!0})],Ht.prototype,"_activityQueue",void 0),d([p({value:[...Ibe]})],Ht.prototype,"allowedWorkflows",null),d([p({readOnly:!0})],Ht.prototype,"canCreate",null),d([p({readOnly:!0})],Ht.prototype,"canUpdate",null),d([p()],Ht.prototype,"editableItems",null),d([p({readOnly:!0})],Ht.prototype,"failures",void 0),d([p()],Ht.prototype,"attachmentsViewModel",void 0),d([p()],Ht.prototype,"featureFormViewModel",void 0),d([p()],Ht.prototype,"featureTemplatesViewModel",void 0),d([p()],Ht.prototype,"labelOptions",null),d([p()],Ht.prototype,"layerInfos",null),d([p()],Ht.prototype,"sketchViewModel",void 0),d([p()],Ht.prototype,"snappingOptions",null),d([p()],Ht.prototype,"spinnerViewModel",void 0),d([p()],Ht.prototype,"state",null),d([p({readOnly:!0})],Ht.prototype,"syncing",null),d([p()],Ht.prototype,"updating",null),d([p()],Ht.prototype,"tooltipOptions",null),d([p()],Ht.prototype,"view",null),d([p()],Ht.prototype,"pageStack",void 0),d([p()],Ht.prototype,"showDiscardEditsPrompt",void 0),d([p()],Ht.prototype,"_candidateCommitted",void 0),d([p()],Ht.prototype,"page",null),d([p()],Ht.prototype,"selectedTemplateItem",null),d([p()],Ht.prototype,"featureFormDisabled",null),d([p()],Ht.prototype,"canGoBack",null),d([p()],Ht.prototype,"shouldShowDeleteButton",null),d([p()],Ht.prototype,"hasPendingEdits",null),d([p()],Ht.prototype,"useDeprecatedCreateWorkflow",void 0),Ht=d([A(Sbe)],Ht);const qlt=Ht,K7=t=>Wlt(t)||Jlt(t),Wlt=t=>{if(!("type"in t))return!1;switch(t.type){case"feature":case"geojson":case"csv":case"graphics":case"wfs":case"map-notes":case"oriented-imagery":case"scene":case"building-scene":return!0;default:return!1}},Jlt=t=>{const e=s7(t);if(e!=null&&t.hasOwnProperty(e)&&t[e]!=null){for(const i of t[e])if(K7(i))return!0}return!1};var m6;let Qc=m6=class extends vR{constructor(t){super(t),this.children=new ye,this.parent=null}get allChildrenEnabled(){return this.children.every(t=>t.enabled)??!1}get childLayerIds(){return this.children.map(t=>t.layer.id).toArray()}get enabled(){return this.featureSource!=null&&this.featureSource.enabled}get featureSource(){const{layer:t,getFeatureSnappingSources:e}=this;return e().find(i=>i.layer===t)}get hasChildrenEnabled(){return this.children.some(t=>t.enabled)}_initializeChildLayers(t){if(!t)return;const e=t.filter(K7);super._initializeChildLayers(e)}_makeChildren(t){return t.map(e=>o7(e)?new m6({layer:e,parent:this,view:this.view,getFeatureSnappingSources:this.getFeatureSnappingSources}):null).filter(Dt).reverse()}};d([p()],Qc.prototype,"allChildrenEnabled",null),d([p()],Qc.prototype,"children",void 0),d([p()],Qc.prototype,"childLayerIds",null),d([p()],Qc.prototype,"enabled",null),d([p()],Qc.prototype,"featureSource",null),d([p({constructOnly:!0})],Qc.prototype,"getFeatureSnappingSources",void 0),d([p()],Qc.prototype,"hasChildrenEnabled",null),d([p()],Qc.prototype,"parent",void 0),Qc=m6=d([A("esri.widgets.support.SnappingControls.SnappingListItem")],Qc);let x0=class extends a7{constructor(){super(...arguments),this.featureSnappingSources=new ye}get operationalItemsFlat(){return this.operationalItems.flatten(t=>t.children)}get selectableItems(){return this.operationalItemsFlat.filter(t=>{var e;return!((e=t.children)!=null&&e.length)})}_compileList(){const t=this.get("view.map.layers");if(!t)return;const e=t.filter(K7);this._watchLayersListMode(e);const i=this._getViewableLayers(e);i&&i.length?(this._createNewItems(i),this._removeItems(i),this._sortItems(i)):this._removeAllItems()}_createListItem(t){return new Qc({layer:t,view:this.view,getFeatureSnappingSources:()=>this.featureSnappingSources})}};d([p()],x0.prototype,"featureSnappingSources",void 0),d([p()],x0.prototype,"operationalItems",void 0),d([p()],x0.prototype,"operationalItemsFlat",null),d([p()],x0.prototype,"selectableItems",null),x0=d([A("esri.widgets.support.SnappingControls.SnappingLayerListViewModel")],x0);const Zlt="esri.widgets.support.SnappingControls.SnappingControlsViewModel";let ud=class extends cn(he){constructor(e){super(e),this.layerListViewModel=new x0,this.snappingOptions=null,this.view=null}initialize(){this.handles.add([J(()=>({viewModel:this.layerListViewModel,view:this.view}),({viewModel:e,view:i})=>{e.view=i},Le),J(()=>{var e;return{viewModel:this.layerListViewModel,sources:(e=this.snappingOptions)==null?void 0:e.featureSources}},({viewModel:e,sources:i})=>{e.featureSnappingSources=i},Le)])}get allLayersEnabled(){var e;return(((e=this.layerListViewModel)==null?void 0:e.selectableItems)??[]).every(i=>i.enabled)}get allLayersDisabled(){var e;return(((e=this.layerListViewModel)==null?void 0:e.selectableItems)??[]).every(i=>!i.enabled)}get layersEnabledCount(){var e,i;return((i=(e=this.layerListViewModel)==null?void 0:e.selectableItems)==null?void 0:i.filter(r=>r.enabled).length)??0}get state(){return this.get("snappingOptions")?"ready":"disabled"}toggleSnappingForLayers(e,i){e==null||e.forEach(r=>i?this.enableSnappingForLayer(r):this.disableSnappingForLayer(r))}toggleSnappingForAllLayers(e){this.layerListViewModel.selectableItems.forEach(({layer:{id:i}})=>{e?this.enableSnappingForLayer(i):this.disableSnappingForLayer(i)})}enableSnappingForLayer(e){(this._findSnappingSourceForLayer(e)??this._makeSnappingSourceForLayer(e)).enabled=!0}disableSnappingForLayer(e){const i=this._findSnappingSourceForLayer(e);i&&(i.enabled=!1)}updateEnabledFeatureSources(e){for(const i of this.snappingOptions.featureSources)o7(i.layer)&&(i.enabled=e.includes(i.layer.id))}_findSnappingSourceForLayer(e){return this.snappingOptions.featureSources.find(i=>i.layer.id===e)}_makeSnappingSourceForLayer(e){var n;const i=(n=this.layerListViewModel.operationalItemsFlat.find(s=>s.layer.id===e))==null?void 0:n.layer;if(!i)throw new N("snapping-controls:layer-not-found",`cannot enable snapping for layer with id ${e} because no such layer was found in the view`);const r=new O7({layer:i});return this.snappingOptions.featureSources.add(r),r}};d([p()],ud.prototype,"allLayersEnabled",null),d([p()],ud.prototype,"allLayersDisabled",null),d([p({constructOnly:!0})],ud.prototype,"layerListViewModel",void 0),d([p()],ud.prototype,"layersEnabledCount",null),d([p()],ud.prototype,"snappingOptions",void 0),d([p()],ud.prototype,"state",null),d([p()],ud.prototype,"view",void 0),ud=d([A(Zlt)],ud);const Ylt=ud,Dte={header:!0,enabledToggle:!0,selfEnabledToggle:!0,featureEnabledToggle:!0,layerList:!0,layerListToggleLayersButton:!0},_l="esri-snapping-controls",Ko={base:_l,container:`${_l}__container`,panel:`${_l}__panel`,item:`${_l}__item`,toggleBlock:`${_l}__toggle-block`,layerListBlock:`${_l}__layer-list-block`,layerList:`${_l}__layer-list`,layerListFilter:`${_l}__layer-list__filter`,layerListButton:`${_l}__layer-list__button`,layerListItem:`${_l}__layer-list__item`,layerListGroup:`${_l}__layer-list__group`,nestedContainer:`${_l}__nested-container`,disabled:"esri-disabled",esriWidget:"esri-widget",widgetIcon:"esri-icon-vertex-gps"},lS={checked:"check-square-f",unchecked:"square",indeterminate:"minus-square"};let $o=class extends di{constructor(t,e){super((()=>{const{view:i,viewModel:r,snappingOptions:n,...s}=t;return s})(),e),this._defaultViewModel=null,this._layerListFilter=null,this.iconClass=Ko.widgetIcon,this.icon=null,this.layerListOpen=!0,this.messages=null,this.visibleElements={...Dte},this._onToggleLayersButtonClick=i=>{this.viewModel.toggleSnappingForAllLayers(!this.viewModel.allLayersEnabled),requestAnimationFrame(()=>i.target.setFocus())},t!=null&&t.viewModel?this.viewModel=t.viewModel:(this._defaultViewModel=new Ylt({snappingOptions:t.snappingOptions,view:t.view}),this.viewModel=this._defaultViewModel)}destroy(){this._defaultViewModel=je(this._defaultViewModel)}loadDependencies(){return Zd({accordion:()=>W(()=>import("./calcite-accordion-250a399d.js"),[],import.meta.url),"accordion-item":()=>W(()=>import("./calcite-accordion-item-1cdccd28.js"),["./calcite-accordion-item-1cdccd28.js","./conditionalSlot-7d11aa4c.js","./observers-c8819292.js","./icon-55c3c703.js"],import.meta.url),action:()=>W(()=>import("./calcite-action-c24244cd.js"),["./calcite-action-c24244cd.js","./action-6ac56df8.js","./guid-40d04074.js","./interactive-3cbb41b8.js","./browser-14ab28bd.js","./loadable-800481cb.js","./t9n-5488ec48.js","./key-a512d618.js","./observers-c8819292.js","./icon-55c3c703.js","./loader-ea07f4e7.js"],import.meta.url),block:()=>W(()=>import("./calcite-block-b7c0a1be.js"),["./calcite-block-b7c0a1be.js","./conditionalSlot-7d11aa4c.js","./observers-c8819292.js","./guid-40d04074.js","./interactive-3cbb41b8.js","./browser-14ab28bd.js","./t9n-5488ec48.js","./key-a512d618.js","./focusTrapComponent-b126d96c.js","./action-6ac56df8.js","./loadable-800481cb.js","./icon-55c3c703.js","./loader-ea07f4e7.js","./action-menu-bdbaa348.js","./popover-f35958eb.js","./openCloseComponent-c78eaefa.js","./debounce-9700caea.js","./FloatingArrow-ab842880.js","./scrim-61cfb0a8.js"],import.meta.url),button:()=>W(()=>import("./calcite-button-63d3e2be.js"),["./calcite-button-63d3e2be.js","./form-5109e7da.js","./interactive-3cbb41b8.js","./browser-14ab28bd.js","./label2-c76d0cf4.js","./loadable-800481cb.js","./t9n-5488ec48.js","./key-a512d618.js","./observers-c8819292.js","./icon-55c3c703.js","./loader-ea07f4e7.js","./guid-40d04074.js"],import.meta.url),icon:()=>W(()=>import("./calcite-icon-dc1254b1.js"),["./calcite-icon-dc1254b1.js","./icon-55c3c703.js","./observers-c8819292.js"],import.meta.url),input:()=>W(()=>import("./calcite-input-3ed71a14.js"),["./calcite-input-3ed71a14.js","./input-73d8e593.js","./form-5109e7da.js","./interactive-3cbb41b8.js","./browser-14ab28bd.js","./key-a512d618.js","./label2-c76d0cf4.js","./loadable-800481cb.js","./t9n-5488ec48.js","./observers-c8819292.js","./icon-55c3c703.js","./progress-f7b87c62.js"],import.meta.url),label:()=>W(()=>import("./calcite-label-322afeb1.js"),["./calcite-label-322afeb1.js","./label2-c76d0cf4.js"],import.meta.url),list:()=>W(()=>import("./calcite-list-0080b921.js"),["./calcite-list-0080b921.js","./interactive-3cbb41b8.js","./browser-14ab28bd.js","./observers-c8819292.js","./utils3-9c594b4c.js","./loadable-800481cb.js","./filter2-55383f9a.js","./debounce-9700caea.js","./t9n-5488ec48.js","./key-a512d618.js","./icon-55c3c703.js","./input-73d8e593.js","./form-5109e7da.js","./label2-c76d0cf4.js","./progress-f7b87c62.js","./loader-ea07f4e7.js","./guid-40d04074.js","./scrim-61cfb0a8.js"],import.meta.url),"list-item":()=>W(()=>import("./calcite-list-item-d246eaec.js"),["./calcite-list-item-d246eaec.js","./interactive-3cbb41b8.js","./browser-14ab28bd.js","./utils3-9c594b4c.js","./t9n-5488ec48.js","./key-a512d618.js","./observers-c8819292.js","./loadable-800481cb.js","./action-6ac56df8.js","./guid-40d04074.js","./icon-55c3c703.js","./loader-ea07f4e7.js"],import.meta.url),panel:()=>W(()=>import("./calcite-panel-3244ce34.js"),["./calcite-panel-3244ce34.js","./panel-2a73adfb.js","./interactive-3cbb41b8.js","./browser-14ab28bd.js","./loadable-800481cb.js","./observers-c8819292.js","./action-menu-bdbaa348.js","./guid-40d04074.js","./key-a512d618.js","./action-6ac56df8.js","./t9n-5488ec48.js","./icon-55c3c703.js","./loader-ea07f4e7.js","./popover-f35958eb.js","./openCloseComponent-c78eaefa.js","./debounce-9700caea.js","./focusTrapComponent-b126d96c.js","./FloatingArrow-ab842880.js","./scrim-61cfb0a8.js"],import.meta.url),switch:()=>W(()=>import("./calcite-switch-6eabe4df.js"),["./calcite-switch-6eabe4df.js","./form-5109e7da.js","./interactive-3cbb41b8.js","./browser-14ab28bd.js","./key-a512d618.js","./label2-c76d0cf4.js","./loadable-800481cb.js"],import.meta.url)})}get label(){var t;return((t=this.messages)==null?void 0:t.widgetLabel)??""}set label(t){this._overrideIfSome("label",t)}get snappingOptions(){return this.viewModel.snappingOptions}set snappingOptions(t){this.viewModel.snappingOptions=t}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}set viewModel(t){t!==this._get("viewModel")&&(this._defaultViewModel!=null&&this._defaultViewModel===t||(this._defaultViewModel=je(this._defaultViewModel)),this._set("viewModel",t))}castVisibleElements(t){return{...Dte,...t}}render(){const{label:t,visibleElements:{header:e}}=this;return M("div",{"aria-label":t,class:this.classes(Ko.base,Ko.esriWidget)},M("div",{class:Ko.container},e?this._renderHeaderView():this._renderContent()))}_renderHeaderView(){return M("calcite-panel",{heading:this.label,class:Ko.panel},this._renderContent())}_renderContent(){return[this._renderToggles(),this._renderLayerList()]}_renderToggles(){const{visibleElements:{enabledToggle:t,selfEnabledToggle:e,featureEnabledToggle:i}}=this;return t||e||i?M("calcite-block",{class:Ko.toggleBlock,key:"toggle-block",heading:"",open:!0},this._renderEnabledToggle(),M("div",{class:Ko.nestedContainer},this._renderSelfEnabledToggle(),this._renderFeatureEnabledToggle())):null}_renderEnabledToggle(){if(!this.visibleElements.enabledToggle)return null;const{messages:{enableSnapping:t},viewModel:{snappingOptions:{enabled:e,enabledToggled:i}}}=this;return M("calcite-label",{layout:"inline-space-between"},t,M("calcite-switch",{checked:e,disabled:i,bind:this,onCalciteSwitchChange:this._enableSnappingSwitchChange}))}_renderSelfEnabledToggle(){if(!this.visibleElements.selfEnabledToggle)return null;const{messages:{geometryGuides:t},viewModel:{snappingOptions:{enabled:e,selfEnabled:i,enabledToggled:r}}}=this;return M("calcite-label",{layout:"inline-space-between",key:"self-enabled-toggle"},t,M("calcite-switch",{checked:i,disabled:r||!e,bind:this,onCalciteSwitchChange:this._selfEnabledSwitchChange}))}_renderFeatureEnabledToggle(){if(!this.visibleElements.featureEnabledToggle)return null;const{messages:{featureToFeature:t},viewModel:{snappingOptions:{enabled:e,featureEnabled:i,enabledToggled:r}}}=this;return M("calcite-label",{layout:"inline-space-between",key:"feature-enabled-toggle"},t,M("calcite-switch",{checked:i,disabled:r||!e,bind:this,onCalciteSwitchChange:this._featureEnabledSwitchChange}))}_renderLayerList(){if(!this.visibleElements.layerList)return null;const{messages:t,viewModel:e}=this,{snappingOptions:{enabled:i,enabledToggled:r}}=e,n=({target:{value:l}})=>this._layerListFilter=l===""?null:new RegExp(l,"i"),s=e.layerListViewModel.operationalItems.length>9?M("calcite-input",{class:Ko.layerListFilter,clearable:!0,placeholder:t==null?void 0:t.searchLayers,onCalciteInputInput:n}):null,o=r||!i,a=this.layerListOpen&&!o;return M("calcite-block",{key:"list-block",heading:t.snappingLayers,disabled:o,class:Ko.layerListBlock,collapsible:!0,open:a,onCalciteBlockToggle:l=>this.layerListOpen=l.target.open},s,this._renderToggleLayersButton(),M("calcite-list",{class:Ko.layerList},this._renderLayerListItemCollection(e.layerListViewModel.operationalItems,this._layerListFilter)))}_renderLayerListItemCollection(t,e){return t.map(i=>{if(!e||this._itemTitleMatchesFilter(i,e))return i.children.length>0?this._renderLayerListItemGroup(i):this._renderLayerListItem(i);const r=i.children.filter(n=>this._itemTitleMatchesFilter(n,e));return r.length>0?this._renderLayerListItemGroup(i,r):null}).toArray().filter(Dt)}_renderToggleLayersButton(){if(!this.visibleElements.layerListToggleLayersButton)return null;const{viewModel:{allLayersEnabled:t},messages:e}=this,i=t?e.disableAllLayers:e.enableAllLayers;return M("calcite-button",{appearance:"transparent",class:Ko.layerListButton,label:i,name:"layer-toggle",scale:"m",onclick:this._onToggleLayersButtonClick},i)}_renderLayerListItem(t){const{messages:{untitledLayer:e}}=this,i=t.title||e,r=t.enabled,n=()=>{this._handleLayerListItemChange({checked:!r,value:t.layer.id})};return M("calcite-list-item",{class:Ko.layerListItem,label:i,key:`${this.id}-list-item-${t.uid}`,onCalciteListItemSelect:n},M("calcite-icon",{icon:r?lS.checked:lS.unchecked,slot:"content-start",scale:"s"}))}_renderLayerListItemGroup(t,e){const{allChildrenEnabled:i,children:r,hasChildrenEnabled:n,title:s}=t,o=this.messages,a=s||o.untitledLayer,l=s&&s!==""?s:X0(),c=!!e,u=e??r,h=i?lS.checked:n?lS.indeterminate:lS.unchecked,f=i?o.disableAllLayers:o.enableAllLayers,m=()=>{this.viewModel.toggleSnappingForLayers(t.childLayerIds,!i)};return M("calcite-list-item",{class:Ko.layerListItem,key:l},M("calcite-accordion",{class:Ko.layerListGroup,appearance:"transparent"},M("calcite-accordion-item",{expanded:c,heading:a,key:t.uid},M("calcite-action",{scale:"m",slot:"actions-start",text:f,textEnabled:!1,onclick:m},M("calcite-icon",{icon:h,scale:"s"})),M("calcite-list",null,[...this._renderLayerListItemCollection(u)]))))}_enableSnappingSwitchChange(t){this.snappingOptions.enabled=t.target.checked}_featureEnabledSwitchChange(t){this.snappingOptions.featureEnabled=t.target.checked}_itemTitleMatchesFilter(t,e){return e!=null&&e.test(t.title)}_selfEnabledSwitchChange(t){this.snappingOptions.selfEnabled=t.target.checked}async _handleLayerListItemChange(t){t.checked?this.viewModel.enableSnappingForLayer(t.value):this.viewModel.disableSnappingForLayer(t.value)}};d([p()],$o.prototype,"_defaultViewModel",void 0),d([p()],$o.prototype,"_layerListFilter",void 0),d([p()],$o.prototype,"iconClass",void 0),d([p()],$o.prototype,"icon",void 0),d([p()],$o.prototype,"label",null),d([p()],$o.prototype,"layerListOpen",void 0),d([p(),ut("esri/widgets/support/SnappingControls/t9n/SnappingControls")],$o.prototype,"messages",void 0),d([p()],$o.prototype,"snappingOptions",null),d([p()],$o.prototype,"view",null),d([p()],$o.prototype,"viewModel",null),d([p()],$o.prototype,"visibleElements",void 0),d([tt("visibleElements")],$o.prototype,"castVisibleElements",null),$o=d([A("esri.widgets.support.SnappingControls")],$o);const Klt=$o,Nte={base:"esri-sketch-tooltip-controls",esriWidget:"esri-widget",widgetIcon:"esri-icon-gear"};let Rh=class extends di{constructor(t){super(t),this.viewModel=null,this.iconClass=Nte.widgetIcon,this.icon=null,this._onEnabledChange=e=>{const i=e.target;this.tooltipOptions.enabled=i.checked}}loadDependencies(){return Zd({block:()=>W(()=>import("./calcite-block-b7c0a1be.js"),["./calcite-block-b7c0a1be.js","./conditionalSlot-7d11aa4c.js","./observers-c8819292.js","./guid-40d04074.js","./interactive-3cbb41b8.js","./browser-14ab28bd.js","./t9n-5488ec48.js","./key-a512d618.js","./focusTrapComponent-b126d96c.js","./action-6ac56df8.js","./loadable-800481cb.js","./icon-55c3c703.js","./loader-ea07f4e7.js","./action-menu-bdbaa348.js","./popover-f35958eb.js","./openCloseComponent-c78eaefa.js","./debounce-9700caea.js","./FloatingArrow-ab842880.js","./scrim-61cfb0a8.js"],import.meta.url),label:()=>W(()=>import("./calcite-label-322afeb1.js"),["./calcite-label-322afeb1.js","./label2-c76d0cf4.js"],import.meta.url),switch:()=>W(()=>import("./calcite-switch-6eabe4df.js"),["./calcite-switch-6eabe4df.js","./form-5109e7da.js","./interactive-3cbb41b8.js","./browser-14ab28bd.js","./key-a512d618.js","./label2-c76d0cf4.js","./loadable-800481cb.js"],import.meta.url)})}render(){var t;return M("div",{class:Nte.base},M("calcite-block",{heading:"",open:!0},M("calcite-label",{layout:"inline-space-between"},(t=this.messages)==null?void 0:t.enabledToggle,M("calcite-switch",{checked:this.tooltipOptions.enabled,onCalciteSwitchChange:this._onEnabledChange}))))}get label(){var t;return((t=this.messages)==null?void 0:t.widgetLabel)??""}set label(t){this._overrideIfSome("label",t)}};d([p()],Rh.prototype,"viewModel",void 0),d([p()],Rh.prototype,"iconClass",void 0),d([p()],Rh.prototype,"icon",void 0),d([p()],Rh.prototype,"label",null),d([p(),ut("esri/widgets/support/SketchTooltipControls/t9n/SketchTooltipControls")],Rh.prototype,"messages",void 0),d([p()],Rh.prototype,"tooltipOptions",void 0),Rh=d([A("esri.widgets.Editor.components.SketchTooltipControls")],Rh);const zl="esri-editor",U_=`${zl}__panel`,G_=`${zl}__prompt`,Vt={base:`${zl} esri-widget esri-widget--panel`,actions:`${zl}__actions`,helpMessage:`${zl}__help-message`,panelToolbar:`${U_}-toolbar`,panelContent:`${U_}-content`,panelContentMessage:`${U_}-content__message`,panelContentSection:`${U_}-content__section`,panelContentSectionGroup:`${U_}-content__section__group`,panelContentScrimContainer:`${U_}-content__scrim-container`,settingsContainer:`${zl}__settings`,featureTemplatesContainer:`${zl}__feature-templates-container`,notice:`${zl}__notice`,templateItemContentEnd:`${zl}__template-item-content-end`,templateItemContentEndSuccess:`${zl}__template-item-content-end--success`,templateItemContentEndError:`${zl}__template-item-content-end--error`,templateItemLoader:`${zl}__template-item-loader`,promptContainer:G_,promptHeader:`${G_}__header`,promptHeading:`${G_}__header__heading`,promptMessage:`${G_}__message`,promptDivider:`${G_}__divider`,promptActions:`${G_}__actions`,widgetIcon:"esri-icon-edit"},iD={undoRedoButtons:!1,snappingControls:!0,snappingControlsElements:{header:!1,enabledToggle:!0,selfEnabledToggle:!0,featureEnabledToggle:!0,layerList:!0},sketchTooltipControls:!0};function Xlt(t){requestAnimationFrame(()=>t.setFocus())}const n$="exclamation-mark-triangle",Tbe="esri.widgets.Editor",rD=ie.getLogger(Tbe);let qt=class extends cn(di){constructor(t,e){super(t,e),this._featureForm=new Rat,this._attachments=new Iot({visibleElements:{addSubmitButton:!1,cancelAddButton:!1,cancelUpdateButton:!1,deleteButton:!1,errorMessage:!1,progressBar:!1,updateButton:!1}}),this._featureTemplates=new Kat({enableListScroll:!1,renderItemContentEnd:i=>this._renderTemplateContentEnd(i),renderItemDescription:i=>this._renderTemplateDescription(i),renderItemLabel:i=>this._renderTemplateLabel(i),renderCustomGroupContent:i=>this._renderCustomTemplateGroupContent(i)}),this._filterText="",this._prompt=null,this._spinner=new elt,this.headingLevel=4,this.iconClass=Vt.widgetIcon,this.messages=null,this.messagesCommon=null,this.messagesTemplates=null,this.supportingWidgetDefaults=null,this.viewModel=new qlt,this.visibleElements={...iD},this._renderSelectIcon=()=>M("calcite-icon",{icon:"cursor",slot:"content-start"}),this.EditorPanel=({handleBack:i,heading:r,headingLevel:n,key:s},...o)=>{const{messagesCommon:a,viewModel:l,visibleElements:c}=this,u=l.sketchViewModel,h=l.syncing||this._attachments.submitting;return M("calcite-flow-item",{closable:!1,heading:r,headingLevel:n,key:s,loading:h,onCalciteFlowItemBack:i??void 0},M("div",{key:"panel-toolbar",class:Vt.panelToolbar},this._renderSettings(),c.undoRedoButtons&&[M("calcite-button",{key:"undo-button",label:a.undo,appearance:"transparent",kind:"neutral",alignment:"center",iconStart:"undo",scale:"l",disabled:!u.canUndo(),onclick:u.undo.bind(u)},a.undo),M("calcite-button",{key:"redo-button",label:a.redo,appearance:"transparent",kind:"neutral",alignment:"center",iconStart:"redo",scale:"l",disabled:!u.canRedo(),onclick:u.redo.bind(u)},a.redo)]),...o)},this._showDiscardEditsPrompt=()=>{const{messages:i,activeWorkflow:r}=this;if((r==null?void 0:r.type)==="create-features"&&AO(r.data.creationInfo))return this._showPrompt({title:i.cancelUploadTitle,message:i.cancelUploadWarningMessage,yesLabel:i.discardUpload,noLabel:i.continueUpload});const n=(r==null?void 0:r.type)==="create";return this._showPrompt({title:i[n?"cancelAddTitle":"cancelEditTitle"],message:i[n?"cancelAddWarningMessage":"cancelEditWarningMessage"],yesLabel:i[n?"discardFeature":"discardEdits"],noLabel:i[n?"continueAdding":"continueEditing"]})},this._showGenericCancelPrompt=()=>{const{messages:i,messagesCommon:r}=this;return this._showPrompt({title:i.cancelRequestTitle,message:i.cancelRequestWarningMessage,yesLabel:r.form.yes,noLabel:r.form.no})},this._onToggleUpdateWorkflow=()=>this.viewModel.toggleUpdateWorkflow(),this._onAttachmentDeleteConfirm=async()=>{const i=this._attachments,{activeWorkflow:r}=this.viewModel;r&&(r.type==="create-features"?i.deleteFile():(await i.deleteAttachment(i.viewModel.activeAttachmentInfo),this._clearPrompt()),await r.back(),this._clearPrompt())},this._onAttachmentsError=i=>{this._prompt={title:this.messages.errorWarningTitle,message:i.message,context:"warning",actions:{primary:{label:this.messagesCommon.form.ok,action:this._clearPrompt}}}},this._clearPrompt=()=>{this._prompt=null},this._onBack=this._onBack.bind(this),this._onSave=this._onSave.bind(this),this._onDelete=this._onDelete.bind(this),this._onToggleUpdateWorkflow=this._onToggleUpdateWorkflow.bind(this),this._onAttachmentAdd=this._onAttachmentAdd.bind(this),this._onAttachmentUpdate=this._onAttachmentUpdate.bind(this),this._onAttachmentDelete=this._onAttachmentDelete.bind(this)}initialize(){this.addHandles([J(()=>pw(this.headingLevel),t=>{this._featureForm.headingLevel=t,this._featureTemplates.headingLevel=t},Le),J(()=>this.viewModel.selectedTemplateItem,t=>this._featureTemplates.select(t,{emit:!1})),ui(()=>this.viewModel.activeWorkflow,"cancel-request",({controller:t})=>{(this.viewModel.hasPendingEdits?this._showDiscardEditsPrompt():this._showGenericCancelPrompt()).then(e=>e?t.allow():t.deny())}),J(()=>this.viewModel,t=>{this._featureForm.viewModel=(t==null?void 0:t.featureFormViewModel)??null,this._attachments.viewModel=(t==null?void 0:t.attachmentsViewModel)??null,this._featureTemplates.viewModel=(t==null?void 0:t.featureTemplatesViewModel)??null,this._spinner.viewModel=(t==null?void 0:t.spinnerViewModel)??null,t.showDiscardEditsPrompt=this._showDiscardEditsPrompt},Le),J(()=>this.view,(t,e)=>{const i=`editor-${this.id}-spinner`;e==null||e.ui.remove(this._spinner,i),t==null||t.ui.add(this._spinner,{key:i,position:"manual"})},Le),tn(()=>this.supportingWidgetDefaults,t=>{this._featureForm.set(t.featureForm),this._attachments.set(t.attachments),this._featureTemplates.set(t.featureTemplates),this.viewModel.sketchViewModel.set(t.sketch)},Le),tn(()=>{var t;return(t=this._attachments)==null?void 0:t.error},t=>this._onAttachmentsError(t)),tn(()=>{var t;return(t=this.viewModel)==null?void 0:t.failures},t=>{const{messages:e}=this,[{error:i,retry:r,cancel:n}]=t;this._prompt={title:e.errorWarningTitle,message:Os(e.errorWarningMessageTemplate,{errorMessage:i.message}),context:"warning",actions:{primary:{label:e.retry,action:()=>{r(),this._clearPrompt()}},secondary:{label:e.ignore,action:()=>{n(),this._clearPrompt()}}}}}),J(()=>{var t;return(t=this.viewModel)==null?void 0:t.state},t=>{switch(t){case"awaiting-feature-to-update":case"ready":case"disabled":this._filterText="",this._featureTemplates.filterText=""}}),J(()=>this.viewModel.featureFormDisabled,t=>this._featureForm.disabled=t)])}destroy(){this._attachments.destroy(),this._featureForm.destroy(),this._featureTemplates.destroy()}loadDependencies(){return Zd({accordion:()=>W(()=>import("./calcite-accordion-250a399d.js"),[],import.meta.url),"accordion-item":()=>W(()=>import("./calcite-accordion-item-1cdccd28.js"),["./calcite-accordion-item-1cdccd28.js","./conditionalSlot-7d11aa4c.js","./observers-c8819292.js","./icon-55c3c703.js"],import.meta.url),button:()=>W(()=>import("./calcite-button-63d3e2be.js"),["./calcite-button-63d3e2be.js","./form-5109e7da.js","./interactive-3cbb41b8.js","./browser-14ab28bd.js","./label2-c76d0cf4.js","./loadable-800481cb.js","./t9n-5488ec48.js","./key-a512d618.js","./observers-c8819292.js","./icon-55c3c703.js","./loader-ea07f4e7.js","./guid-40d04074.js"],import.meta.url),"flow-item":()=>W(()=>import("./calcite-flow-item-830ac777.js"),["./calcite-flow-item-830ac777.js","./interactive-3cbb41b8.js","./browser-14ab28bd.js","./loadable-800481cb.js","./t9n-5488ec48.js","./key-a512d618.js","./observers-c8819292.js","./panel-2a73adfb.js","./action-menu-bdbaa348.js","./guid-40d04074.js","./action-6ac56df8.js","./icon-55c3c703.js","./loader-ea07f4e7.js","./popover-f35958eb.js","./openCloseComponent-c78eaefa.js","./debounce-9700caea.js","./focusTrapComponent-b126d96c.js","./FloatingArrow-ab842880.js","./scrim-61cfb0a8.js","./tooltip-1f202987.js"],import.meta.url),flow:()=>W(()=>import("./calcite-flow-6e9fb354.js"),["./calcite-flow-6e9fb354.js","./observers-c8819292.js"],import.meta.url),icon:()=>W(()=>import("./calcite-icon-dc1254b1.js"),["./calcite-icon-dc1254b1.js","./icon-55c3c703.js","./observers-c8819292.js"],import.meta.url),list:()=>W(()=>import("./calcite-list-0080b921.js"),["./calcite-list-0080b921.js","./interactive-3cbb41b8.js","./browser-14ab28bd.js","./observers-c8819292.js","./utils3-9c594b4c.js","./loadable-800481cb.js","./filter2-55383f9a.js","./debounce-9700caea.js","./t9n-5488ec48.js","./key-a512d618.js","./icon-55c3c703.js","./input-73d8e593.js","./form-5109e7da.js","./label2-c76d0cf4.js","./progress-f7b87c62.js","./loader-ea07f4e7.js","./guid-40d04074.js","./scrim-61cfb0a8.js"],import.meta.url),loader:()=>W(()=>import("./calcite-loader-1e6cb0b1.js"),["./calcite-loader-1e6cb0b1.js","./loader-ea07f4e7.js","./guid-40d04074.js"],import.meta.url),notice:()=>W(()=>import("./calcite-notice-ef4471ac.js"),["./calcite-notice-ef4471ac.js","./conditionalSlot-7d11aa4c.js","./observers-c8819292.js","./loadable-800481cb.js","./t9n-5488ec48.js","./key-a512d618.js","./icon-55c3c703.js"],import.meta.url),scrim:()=>W(()=>import("./calcite-scrim-97dac5b5.js"),["./calcite-scrim-97dac5b5.js","./scrim-61cfb0a8.js","./t9n-5488ec48.js","./key-a512d618.js","./observers-c8819292.js","./loader-ea07f4e7.js","./guid-40d04074.js"],import.meta.url)})}get _deleteButtonCommonInfo(){return{appearance:"outline",kind:"danger",type:"primary"}}get activeWorkflow(){return this.viewModel.activeWorkflow}get allowedWorkflows(){return this.viewModel.allowedWorkflows}set allowedWorkflows(t){this.viewModel.allowedWorkflows=t}get useDeprecatedCreateWorkflow(){return this.viewModel.useDeprecatedCreateWorkflow}set useDeprecatedCreateWorkflow(t){this.viewModel.useDeprecatedCreateWorkflow=t}get label(){var t;return((t=this.messages)==null?void 0:t.widgetLabel)??""}set label(t){this._overrideIfSome("label",t)}get labelOptions(){return this.viewModel.labelOptions}set labelOptions(t){this.viewModel.labelOptions=t}get layerInfos(){return this.viewModel.layerInfos}set layerInfos(t){this.viewModel.layerInfos=t}get snappingOptions(){return this.viewModel.snappingOptions}set snappingOptions(t){this.viewModel.snappingOptions=t}get tooltipOptions(){return this.viewModel.tooltipOptions}set tooltipOptions(t){this.viewModel.tooltipOptions=t}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}castVisibleElements(t){return{...iD,...t,snappingControlsElements:{...iD.snappingControlsElements,...t==null?void 0:t.snappingControlsElements}}}startCreateWorkflowAtFeatureTypeSelection(){return Hw(rD,"startCreateWorkflowAtFeatureTypeSelection","startCreateFeaturesWorkflowAtFeatureTypeSelection"),this.viewModel.startCreateWorkflowAtFeatureTypeSelection()}startCreateFeaturesWorkflowAtFeatureTypeSelection(){return this.viewModel.startCreateFeaturesWorkflowAtFeatureTypeSelection()}startCreateWorkflowAtFeatureCreation(t){return Hw(rD,"startCreateWorkflowAtFeatureCreation","startCreateFeaturesWorkflowAtFeatureCreation"),this.viewModel.startCreateWorkflowAtFeatureCreation(t)}startCreateFeaturesWorkflowAtFeatureCreation(t){return this.viewModel.startCreateFeaturesWorkflowAtFeatureCreation(t)}startCreateWorkflowAtFeatureEdit(t){return Hw(rD,"startCreateWorkflowAtFeatureEdit"),this.viewModel.startCreateWorkflowAtFeatureEdit(t)}startUpdateWorkflowAtFeatureSelection(){return this.viewModel.startUpdateWorkflowAtFeatureSelection()}startUpdateWorkflowAtMultipleFeatureSelection(t){return this.viewModel.startUpdateWorkflowAtMultipleFeatureSelection(t)}startUpdateWorkflowAtFeatureEdit(t){return this.viewModel.startUpdateWorkflowAtFeatureEdit(t)}deleteFeatureFromWorkflow(){return this.viewModel.deleteFeatureFromWorkflow()}cancelWorkflow(t){return this.viewModel.cancelWorkflow(t)}render(){const{viewModel:t}=this;if(!t)return M("div",{key:"empty",class:Vt.base});const{state:e}=t;return M("div",{key:"base",class:Vt.base},M("calcite-flow",{key:"flow"},t.pageStack.map(i=>this._renderPage(i,e)),this._renderPage(t.page,e)),this._renderPrompt())}_renderPage(t,e){switch(t){case"disabled":break;case"ready":return this._renderLanding(e);case"awaiting-feature-creation-info":return this._renderTemplates(e);case"creating-features":case"editing-new-feature":case"editing-existing-feature":return this._renderAttributeEditing(e);case"awaiting-update-feature-candidate":return this._renderFeatureList(e);case"adding-attachment":return this._renderAttachmentAdding(e);case"editing-attachment":return this._renderAttachmentEditing(e)}return M("div",null)}_renderTemplates(t){const{EditorPanel:e,headingLevel:i,messages:r,_onBack:n}=this;return M(e,{active:this._isPanelActive(t),key:"templates-panel",handleBack:n,heading:r.selectTemplate,headingLevel:i},M("div",{key:"feature-templates",class:Vt.panelContent},this._featureTemplates.render()))}_renderAttributeEditing(t){const{activeWorkflow:e,EditorPanel:i,messages:r,messagesCommon:n,headingLevel:s,_onBack:o,viewModel:a}=this;if(!e)return null;const l=e.type,c="activeWorkflow"in e&&e.activeWorkflow,u=c?c.type:null,h=a.featureFormViewModel,f=c&&!c.hasPendingEdits||l==="update"&&!e.hasPendingEdits||a.syncing||h.updating,m=l==="update"?r.editFeature:r.createFeatures,g=l==="update"&&u!=="create-features"?n.update:n.create,y=l==="create-features"&&e.createFeatureState==="create-new",v=l==="create-features"?e.numPendingFeatures:0,b=v>1?Os(r.createFeaturesTemplate,{numFeatures:v}):g,w=e.shouldShowAttachments&&!a.featureFormViewModel.activeRelationshipInput,x=h.inputs.every(S=>!S.visible)&&!w?this._renderMessage(Os(r.clickToFinishTemplate,{button:g})):M("div",{key:"panel-content-section",class:Vt.panelContentSection},this._renderNotices(e),M("div",{class:Vt.panelContentSectionGroup},this._featureForm.render(),w&&M("div",{key:"attachments"},M(Ql,{level:pw(s)},r.attachments),this._attachments.render())));return M(i,{active:this._isPanelActive(t),key:"attribute-editing-panel",heading:m,headingLevel:s,handleBack:o},M("div",{key:"panel-content",class:this.classes(Vt.panelContent,{[Vt.panelContentScrimContainer]:y})},x,y&&M("calcite-scrim",null)),this._renderFooterActions([{clickHandler:this._onSave,disabled:f,label:b,type:"primary"},a.shouldShowDeleteButton?{...this._deleteButtonCommonInfo,clickHandler:this._onDelete,disabled:a.syncing,label:n.delete}:null]))}_renderNotices(t){return[this._renderOwnerAdminNotice(t),this._renderInvalidFormTemplateNotice(t),this._renderInvalidDateFieldNotice(t)]}_renderOwnerAdminNotice(t){return(t==null?void 0:t.reliesOnOwnerAdminPrivileges)&&this._renderNotice(this.messages.ownerAdminNotice)}_renderInvalidFormTemplateNotice(t){return(t==null?void 0:t.hasInvalidFormTemplate)&&this._renderNotice(this.messages.formFieldUpdateError,{icon:n$})}_renderInvalidDateFieldNotice(t){return(t==null?void 0:t.hasUnsupportedFields)&&this._renderNotice(this.messages.formFieldUnsupportedUpdateError,{icon:n$})}_renderNotice(t,e){return M("calcite-notice",{open:!0,scale:"s",class:Vt.notice,...e},M("div",{slot:"message"},t))}_renderCustomTemplateGroupContent(t){const{messages:e,viewModel:i}=this;let r=null;return t.group.items.some(n=>(i.itemHasUnsupportedFields(n)?r=e.formFieldUnsupportedCreateError:i.itemHasInvalidFormTemplate(n)&&(r=e.formFieldCreateError),r)),r?this._renderNotice(r,{icon:n$}):null}_renderAttachmentAdding(t){const{_attachments:e,EditorPanel:i,_onBack:r,headingLevel:n,messages:s,messagesCommon:o}=this;return M(i,{active:this._isPanelActive(t),key:"attachment-adding-panel",heading:s.addAttachment,headingLevel:n,handleBack:r},M("div",{key:"attachments",class:Vt.panelContent},e.render()),this._renderFooterActions([{label:e.submitting?o.cancel:o.add,disabled:e.submitting||!e.selectedFile,type:"primary",clickHandler:this._onAttachmentAdd}]))}_renderAttachmentEditing(t){const{_attachments:e,EditorPanel:i,_onBack:r,activeWorkflow:n,headingLevel:s,messages:o,messagesCommon:a}=this;return n?M(i,{active:this._isPanelActive(t),key:"attachment-editing-panel",heading:o.editAttachment,headingLevel:s,handleBack:r},M("div",{key:"attachments",class:Vt.panelContent},e.render()),n.shouldAllowAttachmentEditing?this._renderFooterActions([{label:a.update,disabled:e.submitting||!e.selectedFile,type:"primary",clickHandler:this._onAttachmentUpdate},{...this._deleteButtonCommonInfo,clickHandler:this._onAttachmentDelete,disabled:e.submitting,label:a.delete}]):void 0):null}_renderMessage(t){return M("div",{key:"panel-content-message",class:Vt.panelContentMessage},t)}_renderFooterActions(t){return M("div",{key:"footer-actions",slot:"footer",class:Vt.actions},t.filter(Dt).map(({type:e,disabled:i,class:r,clickHandler:n,label:s,...o},a)=>M("calcite-button",{key:`action-${a}`,slot:"footer-actions",class:r,disabled:i??!1,onclick:n,width:"full",...o},s)))}_renderPrompt(){const t=this._prompt;if(!t)return null;const{title:e,message:i,context:r,actions:n}=t,s=n.secondary;let o;switch(r){case"danger":o="danger";break;case"info":o="brand";break;default:o="neutral"}const a=M("calcite-button",{afterCreate:Xlt,appearance:"solid",key:"prompt-primary-button",kind:o,onclick:n.primary.action,scale:"m",width:s?"half":"full"},n.primary.label),l=s&&M("calcite-button",{appearance:"outline",key:"prompt-secondary-button",kind:o,onclick:s.action,scale:"m",width:"half"},s.label);return M("calcite-scrim",{key:"prompt"},M("div",{class:`${Vt.promptContainer}--${r}`},M("div",{class:Vt.promptHeader},M("calcite-icon",{icon:n$}),M(Ql,{class:Vt.promptHeading,level:this.headingLevel},e)),M("div",{class:Vt.promptMessage},i),M("div",{class:Vt.promptDivider}),M("div",{class:Vt.promptActions},l,a)))}_renderLanding(t){const{EditorPanel:e,headingLevel:i,messages:r,viewModel:n}=this,{canUpdate:s}=n,o=this._featureTemplates.viewModel.numberOfFeatureTemplates,a=!s&&o===0;return M(e,{active:this._isPanelActive(t),key:"landing-panel",heading:r.widgetLabel,headingLevel:i},M("div",{key:"landing-content",class:Vt.panelContent},s&&M("div",{key:"edit-actions",class:Vt.panelContentSection},this._renderUpdateActions(t)),o>0&&M("div",{key:"create-actions",class:Vt.panelContentSection},this._renderCreateActions()),a&&M("div",{key:"no-content",class:Vt.panelContentMessage},r.noEditableLayers)),this._renderFooterHelpMessages())}_renderFooterHelpMessages(){var s;const{activeWorkflow:t,messages:e,view:i}=this,r=t==null?void 0:t.helpMessage,n=r?(s=e[(i==null?void 0:i.type)==="3d"?"helpMessages3d":"helpMessages2d"])==null?void 0:s[r]:null;return n?M("div",{key:"footer-actions",slot:"footer",class:Vt.helpMessage},n):null}_renderUpdateActions(t){const{messages:e,messagesCommon:i}=this,r={id:"select",label:i.select};return M("div",{key:"update-actions"},M(Ql,{level:pw(this.headingLevel)},e.editFeatures),M("calcite-list",{selectionMode:"single",selectionAppearance:"border"},q7({grouped:!1,item:r,selectedItem:t==="awaiting-feature-to-update"?r:void 0,renderIcon:this._renderSelectIcon,onItemSelect:this._onToggleUpdateWorkflow})))}_renderCreateActions(){const{_featureTemplates:t,headingLevel:e,messages:i}=this;return M("div",{key:"create-actions"},M(Ql,{level:pw(e)},i.createFeatures),M("div",{key:"templates",class:Vt.featureTemplatesContainer},t.render()))}_renderTemplateLabel(t){return t.label}_renderTemplateDescription(t){const e=this._getUploadForTemplateItem(t);if(!e)return null;const{messages:i}=this;switch(e.state){case"pending":return i==null?void 0:i.uploadPending;case"error":return i==null?void 0:i.uploadError;default:return null}}_renderTemplateContentEnd(t){const e=this._getUploadForTemplateItem(t),i=M("calcite-icon",{key:"upload-icon",class:Vt.templateItemContentEnd,icon:"upload-to"});if(!e)return t.supportsUpload?i:null;switch(e.state){case"success":return M("calcite-icon",{key:"success-icon",class:this.classes(Vt.templateItemContentEnd,Vt.templateItemContentEndSuccess),icon:"check"});case"error":return M("calcite-icon",{key:"error-icon",class:this.classes(Vt.templateItemContentEnd,Vt.templateItemContentEndError),icon:"exclamation-mark-circle-f"});case"pending":return M("calcite-loader",{class:Vt.templateItemLoader,inline:!0,key:"loader",label:"",scale:"s",type:"indeterminate"});case"canceled":case"default":return i}}_getUploadForTemplateItem(t){const e=this.activeWorkflow;if((e==null?void 0:e.type)!=="create-features")return null;const{data:i}=e,{creationInfo:r,upload:n}=i;return(r==null?void 0:r.template)===t.template&&(r==null?void 0:r.layer)===t.layer?n:null}_renderFeatureList(t){const{EditorPanel:e,_onBack:i,headingLevel:r,messages:n,messagesTemplates:s,viewModel:{activeWorkflow:o,editableItems:a}}=this;if((o==null?void 0:o.type)!=="update")return null;const l=o.data.candidates,c=Os(n.multipleFeaturesTemplate,{total:l.length}),u=new Map;let h=0;l.map(g=>({label:this._getLabel(g),id:g.attributes[g.layer.objectIdField],data:g})).filter(g=>{const{label:y,data:v}=g,b=this._filterText.toLowerCase(),{title:w}=v.layer,x=a.find(T=>T.layer===v.layer);if(!x)return null;const{attachmentsOnUpdateEnabled:S,supports:I}=x;return(I.includes("update")||I.includes("delete")||S)&&(!b||(y==null?void 0:y.toLowerCase().includes(b))||(w==null?void 0:w.toLowerCase().includes(b)))}).filter(Dt).forEach(g=>{var v;h++;const y=g.data.layer;u.has(y)?(v=u.get(y))==null||v.items.push(g):u.set(y,{id:`${y.id}`,label:y.title??"",items:[g]})});const f=a.toArray().map(({layer:g})=>u.get(g)).filter(Dt),m=h>10||this._filterText.length>0;return M(e,{active:this._isPanelActive(t),key:"feature-list",heading:c,headingLevel:r,handleBack:i},M("div",{key:"feature-list",class:Vt.panelContent},M("div",{class:Vt.panelContentSection},abe({enableListScroll:!1,filterEnabled:m,filterText:this._filterText,id:this.id,items:f,messages:{filterPlaceholder:s.filterPlaceholder,noItems:s.noItems,noMatches:s.noMatches},onFilterChange:g=>this._filterText=g,onItemMouseEnter:g=>this.viewModel.selectFeature(g.data),onItemMouseLeave:()=>this.viewModel.selectFeature(null),onItemSelect:g=>this.viewModel.selectFeature(g.data,!0)}))))}_isPanelActive(t){return this.viewModel.state===t}_renderSettings(){var r;const t=this.visibleElements,e=t.snappingControls,i=t.sketchTooltipControls;return e||i?M("calcite-accordion",{key:"settings",class:Vt.settingsContainer,appearance:"transparent"},M("calcite-accordion-item",{heading:(r=this.messagesCommon)==null?void 0:r.settings,iconStart:"gear"},i&&M(Rh,{tooltipOptions:this.tooltipOptions}),e&&M(Klt,{snappingOptions:this.snappingOptions,view:this.view,visibleElements:t.snappingControlsElements,afterCreate:n=>n.layerListOpen=!1}))):null}_getLabel(t){const e=t.layer;if(!e)return null;const i=e.fieldsIndex.get(e.objectIdField),r=i.alias||i.name,{attributes:n}=t,s=HB(e);return s&&n[s]&&`${n[s]}`||`${r}: ${n[i.name]}`}_showPrompt({title:t,message:e,yesLabel:i,noLabel:r}){const n=Ta(),{view:s}=this,o=s==null?void 0:s.focused;return this._prompt={title:t,message:e,context:"danger",actions:{primary:{label:i,action:()=>n.resolve(!0)},secondary:{label:r,action:()=>n.resolve(!1)}}},n.promise.finally(()=>{this._clearPrompt(),o&&(s==null||s.focus())})}_onSave(){this.viewModel.saveWorkflow()}_onDelete(){const{messages:t,messagesCommon:e}=this;this._prompt={title:t.deleteWarningTitle,message:t.deleteWarningMessage,context:"danger",actions:{primary:{label:e.delete,action:()=>{this.deleteFeatureFromWorkflow(),this._clearPrompt()}},secondary:{label:t.keepFeature,action:this._clearPrompt}}}}async _onBack(t){return t==null||t.stopPropagation(),this.viewModel.back()}_onAttachmentAdd(){const{activeWorkflow:t}=this.viewModel;t&&(t.type==="create-features"?(this._attachments.addFile(),t.back()):this._attachments.addAttachment().then(()=>t.back()))}_onAttachmentUpdate(){const{activeWorkflow:t}=this.viewModel;t&&(t.type==="create-features"?(this._attachments.updateFile(),t.back()):this._attachments.updateAttachment().then(()=>t.back()))}_onAttachmentDelete(){const{messages:t,messagesCommon:e}=this;this._prompt={title:t.deleteAttachmentWarningTitle,message:t.deleteAttachmentWarningMessage,context:"danger",actions:{primary:{label:e.delete,action:this._onAttachmentDeleteConfirm},secondary:{label:t.keepAttachment,action:this._clearPrompt}}}}};d([p()],qt.prototype,"_featureForm",void 0),d([p()],qt.prototype,"_attachments",void 0),d([p()],qt.prototype,"_featureTemplates",void 0),d([p()],qt.prototype,"_filterText",void 0),d([p()],qt.prototype,"_prompt",void 0),d([p()],qt.prototype,"_spinner",void 0),d([p()],qt.prototype,"_deleteButtonCommonInfo",null),d([p({readOnly:!0})],qt.prototype,"activeWorkflow",null),d([p()],qt.prototype,"allowedWorkflows",null),d([p()],qt.prototype,"useDeprecatedCreateWorkflow",null),d([p()],qt.prototype,"headingLevel",void 0),d([p()],qt.prototype,"iconClass",void 0),d([p()],qt.prototype,"label",null),d([p()],qt.prototype,"labelOptions",null),d([p()],qt.prototype,"layerInfos",null),d([p(),ut("esri/widgets/Editor/t9n/Editor")],qt.prototype,"messages",void 0),d([p(),ut("esri/t9n/common")],qt.prototype,"messagesCommon",void 0),d([p(),ut("esri/widgets/FeatureTemplates/t9n/FeatureTemplates")],qt.prototype,"messagesTemplates",void 0),d([p()],qt.prototype,"snappingOptions",null),d([p()],qt.prototype,"tooltipOptions",null),d([p()],qt.prototype,"supportingWidgetDefaults",void 0),d([p()],qt.prototype,"view",null),d([p(),BC(["workflow-cancel","workflow-commit"])],qt.prototype,"viewModel",void 0),d([p()],qt.prototype,"visibleElements",void 0),d([tt("visibleElements")],qt.prototype,"castVisibleElements",null),d([wr()],qt.prototype,"_onSave",null),d([wr()],qt.prototype,"_onDelete",null),d([wr()],qt.prototype,"_onBack",null),d([wr()],qt.prototype,"_onAttachmentAdd",null),d([wr()],qt.prototype,"_onAttachmentUpdate",null),d([wr()],qt.prototype,"_onAttachmentDelete",null),qt=d([A(Tbe)],qt);const Cbe=qt,Qlt="AAPK9e1ac7b4aa5c4f74acc1c5ee1e499125uMYbXoXGe4Jpi8uJ7I3sIsO0e0pVTqJlswJsWuR95YAesw9DoxIN2Ry3IgyO5vTB";Lt.apiKey=Qlt;const DR=Object.freeze(Object.defineProperty({__proto__:null,BasemapToggle:m7e,Editor:Cbe,ElevationProfile:hst,Expand:LYe,FeatureTable:AYe,GeoJSONLayer:L9,ImageryTileLayer:Kfe,LabelClass:Zv,LayerList:BQe,Legend:Uye,Map:Ioe,MapView:HNe,Search:vot,TableTemplate:kYe,reactiveUtils:Ple},Symbol.toStringTag,{value:"Module"}));/*!
 * @kurkle/color v0.3.2
 * https://github.com/kurkle/color#readme
 * (c) 2023 Jukka Kurkela
 * Released under the MIT License
 */function eE(t){return t+.5|0}const Bm=(t,e,i)=>Math.max(Math.min(t,i),e);function R2(t){return Bm(eE(t*2.55),0,255)}function ig(t){return Bm(eE(t*255),0,255)}function Gh(t){return Bm(eE(t/2.55)/100,0,1)}function Vte(t){return Bm(eE(t*100),0,100)}const bl={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},g6=[..."0123456789ABCDEF"],ect=t=>g6[t&15],tct=t=>g6[(t&240)>>4]+g6[t&15],s$=t=>(t&240)>>4===(t&15),ict=t=>s$(t.r)&&s$(t.g)&&s$(t.b)&&s$(t.a);function rct(t){var e=t.length,i;return t[0]==="#"&&(e===4||e===5?i={r:255&bl[t[1]]*17,g:255&bl[t[2]]*17,b:255&bl[t[3]]*17,a:e===5?bl[t[4]]*17:255}:(e===7||e===9)&&(i={r:bl[t[1]]<<4|bl[t[2]],g:bl[t[3]]<<4|bl[t[4]],b:bl[t[5]]<<4|bl[t[6]],a:e===9?bl[t[7]]<<4|bl[t[8]]:255})),i}const nct=(t,e)=>t<255?e(t):"";function sct(t){var e=ict(t)?ect:tct;return t?"#"+e(t.r)+e(t.g)+e(t.b)+nct(t.a,e):void 0}const oct=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function Ebe(t,e,i){const r=e*Math.min(i,1-i),n=(s,o=(s+t/30)%12)=>i-r*Math.max(Math.min(o-3,9-o,1),-1);return[n(0),n(8),n(4)]}function act(t,e,i){const r=(n,s=(n+t/60)%6)=>i-i*e*Math.max(Math.min(s,4-s,1),0);return[r(5),r(3),r(1)]}function lct(t,e,i){const r=Ebe(t,1,.5);let n;for(e+i>1&&(n=1/(e+i),e*=n,i*=n),n=0;n<3;n++)r[n]*=1-e-i,r[n]+=e;return r}function cct(t,e,i,r,n){return t===n?(e-i)/r+(e<i?6:0):e===n?(i-t)/r+2:(t-e)/r+4}function X7(t){const i=t.r/255,r=t.g/255,n=t.b/255,s=Math.max(i,r,n),o=Math.min(i,r,n),a=(s+o)/2;let l,c,u;return s!==o&&(u=s-o,c=a>.5?u/(2-s-o):u/(s+o),l=cct(i,r,n,u,s),l=l*60+.5),[l|0,c||0,a]}function Q7(t,e,i,r){return(Array.isArray(e)?t(e[0],e[1],e[2]):t(e,i,r)).map(ig)}function eH(t,e,i){return Q7(Ebe,t,e,i)}function uct(t,e,i){return Q7(lct,t,e,i)}function dct(t,e,i){return Q7(act,t,e,i)}function Mbe(t){return(t%360+360)%360}function hct(t){const e=oct.exec(t);let i=255,r;if(!e)return;e[5]!==r&&(i=e[6]?R2(+e[5]):ig(+e[5]));const n=Mbe(+e[2]),s=+e[3]/100,o=+e[4]/100;return e[1]==="hwb"?r=uct(n,s,o):e[1]==="hsv"?r=dct(n,s,o):r=eH(n,s,o),{r:r[0],g:r[1],b:r[2],a:i}}function pct(t,e){var i=X7(t);i[0]=Mbe(i[0]+e),i=eH(i),t.r=i[0],t.g=i[1],t.b=i[2]}function fct(t){if(!t)return;const e=X7(t),i=e[0],r=Vte(e[1]),n=Vte(e[2]);return t.a<255?`hsla(${i}, ${r}%, ${n}%, ${Gh(t.a)})`:`hsl(${i}, ${r}%, ${n}%)`}const zte={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},jte={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function mct(){const t={},e=Object.keys(jte),i=Object.keys(zte);let r,n,s,o,a;for(r=0;r<e.length;r++){for(o=a=e[r],n=0;n<i.length;n++)s=i[n],a=a.replace(s,zte[s]);s=parseInt(jte[o],16),t[a]=[s>>16&255,s>>8&255,s&255]}return t}let o$;function gct(t){o$||(o$=mct(),o$.transparent=[0,0,0,0]);const e=o$[t.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const yct=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function vct(t){const e=yct.exec(t);let i=255,r,n,s;if(e){if(e[7]!==r){const o=+e[7];i=e[8]?R2(o):Bm(o*255,0,255)}return r=+e[1],n=+e[3],s=+e[5],r=255&(e[2]?R2(r):Bm(r,0,255)),n=255&(e[4]?R2(n):Bm(n,0,255)),s=255&(e[6]?R2(s):Bm(s,0,255)),{r,g:n,b:s,a:i}}}function _ct(t){return t&&(t.a<255?`rgba(${t.r}, ${t.g}, ${t.b}, ${Gh(t.a)})`:`rgb(${t.r}, ${t.g}, ${t.b})`)}const nD=t=>t<=.0031308?t*12.92:Math.pow(t,1/2.4)*1.055-.055,H_=t=>t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4);function bct(t,e,i){const r=H_(Gh(t.r)),n=H_(Gh(t.g)),s=H_(Gh(t.b));return{r:ig(nD(r+i*(H_(Gh(e.r))-r))),g:ig(nD(n+i*(H_(Gh(e.g))-n))),b:ig(nD(s+i*(H_(Gh(e.b))-s))),a:t.a+i*(e.a-t.a)}}function a$(t,e,i){if(t){let r=X7(t);r[e]=Math.max(0,Math.min(r[e]+r[e]*i,e===0?360:1)),r=eH(r),t.r=r[0],t.g=r[1],t.b=r[2]}}function $be(t,e){return t&&Object.assign(e||{},t)}function Bte(t){var e={r:0,g:0,b:0,a:255};return Array.isArray(t)?t.length>=3&&(e={r:t[0],g:t[1],b:t[2],a:255},t.length>3&&(e.a=ig(t[3]))):(e=$be(t,{r:0,g:0,b:0,a:1}),e.a=ig(e.a)),e}function wct(t){return t.charAt(0)==="r"?vct(t):hct(t)}class VT{constructor(e){if(e instanceof VT)return e;const i=typeof e;let r;i==="object"?r=Bte(e):i==="string"&&(r=rct(e)||gct(e)||wct(e)),this._rgb=r,this._valid=!!r}get valid(){return this._valid}get rgb(){var e=$be(this._rgb);return e&&(e.a=Gh(e.a)),e}set rgb(e){this._rgb=Bte(e)}rgbString(){return this._valid?_ct(this._rgb):void 0}hexString(){return this._valid?sct(this._rgb):void 0}hslString(){return this._valid?fct(this._rgb):void 0}mix(e,i){if(e){const r=this.rgb,n=e.rgb;let s;const o=i===s?.5:i,a=2*o-1,l=r.a-n.a,c=((a*l===-1?a:(a+l)/(1+a*l))+1)/2;s=1-c,r.r=255&c*r.r+s*n.r+.5,r.g=255&c*r.g+s*n.g+.5,r.b=255&c*r.b+s*n.b+.5,r.a=o*r.a+(1-o)*n.a,this.rgb=r}return this}interpolate(e,i){return e&&(this._rgb=bct(this._rgb,e._rgb,i)),this}clone(){return new VT(this.rgb)}alpha(e){return this._rgb.a=ig(e),this}clearer(e){const i=this._rgb;return i.a*=1-e,this}greyscale(){const e=this._rgb,i=eE(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=i,this}opaquer(e){const i=this._rgb;return i.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return a$(this._rgb,2,e),this}darken(e){return a$(this._rgb,2,-e),this}saturate(e){return a$(this._rgb,1,e),this}desaturate(e){return a$(this._rgb,1,-e),this}rotate(e){return pct(this._rgb,e),this}}/*!
 * Chart.js v4.3.0
 * https://www.chartjs.org
 * (c) 2023 Chart.js Contributors
 * Released under the MIT License
 */function ah(){}const xct=(()=>{let t=0;return()=>t++})();function ei(t){return t===null||typeof t>"u"}function sr(t){if(Array.isArray&&Array.isArray(t))return!0;const e=Object.prototype.toString.call(t);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function Ft(t){return t!==null&&Object.prototype.toString.call(t)==="[object Object]"}function Gr(t){return(typeof t=="number"||t instanceof Number)&&isFinite(+t)}function Wa(t,e){return Gr(t)?t:e}function ot(t,e){return typeof t>"u"?e:t}const Sct=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100:+t/e,Abe=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100*e:+t;function ct(t,e,i){if(t&&typeof t.call=="function")return t.apply(i,e)}function Ot(t,e,i,r){let n,s,o;if(sr(t))if(s=t.length,r)for(n=s-1;n>=0;n--)e.call(i,t[n],n);else for(n=0;n<s;n++)e.call(i,t[n],n);else if(Ft(t))for(o=Object.keys(t),s=o.length,n=0;n<s;n++)e.call(i,t[o[n]],o[n])}function kO(t,e){let i,r,n,s;if(!t||!e||t.length!==e.length)return!1;for(i=0,r=t.length;i<r;++i)if(n=t[i],s=e[i],n.datasetIndex!==s.datasetIndex||n.index!==s.index)return!1;return!0}function PO(t){if(sr(t))return t.map(PO);if(Ft(t)){const e=Object.create(null),i=Object.keys(t),r=i.length;let n=0;for(;n<r;++n)e[i[n]]=PO(t[i[n]]);return e}return t}function kbe(t){return["__proto__","prototype","constructor"].indexOf(t)===-1}function Ict(t,e,i,r){if(!kbe(t))return;const n=e[t],s=i[t];Ft(n)&&Ft(s)?zT(n,s,r):e[t]=PO(s)}function zT(t,e,i){const r=sr(e)?e:[e],n=r.length;if(!Ft(t))return t;i=i||{};const s=i.merger||Ict;let o;for(let a=0;a<n;++a){if(o=r[a],!Ft(o))continue;const l=Object.keys(o);for(let c=0,u=l.length;c<u;++c)s(l[c],t,o,i)}return t}function kI(t,e){return zT(t,e,{merger:Tct})}function Tct(t,e,i){if(!kbe(t))return;const r=e[t],n=i[t];Ft(r)&&Ft(n)?kI(r,n):Object.prototype.hasOwnProperty.call(e,t)||(e[t]=PO(n))}const Ute={"":t=>t,x:t=>t.x,y:t=>t.y};function Cct(t){const e=t.split("."),i=[];let r="";for(const n of e)r+=n,r.endsWith("\\")?r=r.slice(0,-1)+".":(i.push(r),r="");return i}function Ect(t){const e=Cct(t);return i=>{for(const r of e){if(r==="")break;i=i&&i[r]}return i}}function gg(t,e){return(Ute[e]||(Ute[e]=Ect(e)))(t)}function tH(t){return t.charAt(0).toUpperCase()+t.slice(1)}const jT=t=>typeof t<"u",yg=t=>typeof t=="function",Gte=(t,e)=>{if(t.size!==e.size)return!1;for(const i of t)if(!e.has(i))return!1;return!0};function Mct(t){return t.type==="mouseup"||t.type==="click"||t.type==="contextmenu"}const Tr=Math.PI,ar=2*Tr,$ct=ar+Tr,OO=Number.POSITIVE_INFINITY,Act=Tr/180,Hr=Tr/2,iy=Tr/4,Hte=Tr*2/3,Um=Math.log10,sc=Math.sign;function PI(t,e,i){return Math.abs(t-e)<i}function qte(t){const e=Math.round(t);t=PI(t,e,t/1e3)?e:t;const i=Math.pow(10,Math.floor(Um(t))),r=t/i;return(r<=1?1:r<=2?2:r<=5?5:10)*i}function kct(t){const e=[],i=Math.sqrt(t);let r;for(r=1;r<i;r++)t%r===0&&(e.push(r),e.push(t/r));return i===(i|0)&&e.push(i),e.sort((n,s)=>n-s).pop(),e}function $1(t){return!isNaN(parseFloat(t))&&isFinite(t)}function Pct(t,e){const i=Math.round(t);return i-e<=t&&i+e>=t}function Pbe(t,e,i){let r,n,s;for(r=0,n=t.length;r<n;r++)s=t[r][i],isNaN(s)||(e.min=Math.min(e.min,s),e.max=Math.max(e.max,s))}function mu(t){return t*(Tr/180)}function iH(t){return t*(180/Tr)}function Wte(t){if(!Gr(t))return;let e=1,i=0;for(;Math.round(t*e)/e!==t;)e*=10,i++;return i}function Obe(t,e){const i=e.x-t.x,r=e.y-t.y,n=Math.sqrt(i*i+r*r);let s=Math.atan2(r,i);return s<-.5*Tr&&(s+=ar),{angle:s,distance:n}}function y6(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function Oct(t,e){return(t-e+$ct)%ar-Tr}function Ya(t){return(t%ar+ar)%ar}function BT(t,e,i,r){const n=Ya(t),s=Ya(e),o=Ya(i),a=Ya(s-n),l=Ya(o-n),c=Ya(n-s),u=Ya(n-o);return n===s||n===o||r&&s===o||a>l&&c<u}function fs(t,e,i){return Math.max(e,Math.min(i,t))}function Lct(t){return fs(t,-32768,32767)}function Qh(t,e,i,r=1e-6){return t>=Math.min(e,i)-r&&t<=Math.max(e,i)+r}function rH(t,e,i){i=i||(o=>t[o]<e);let r=t.length-1,n=0,s;for(;r-n>1;)s=n+r>>1,i(s)?n=s:r=s;return{lo:n,hi:r}}const ep=(t,e,i,r)=>rH(t,i,r?n=>{const s=t[n][e];return s<i||s===i&&t[n+1][e]===i}:n=>t[n][e]<i),Rct=(t,e,i)=>rH(t,i,r=>t[r][e]>=i);function Fct(t,e,i){let r=0,n=t.length;for(;r<n&&t[r]<e;)r++;for(;n>r&&t[n-1]>i;)n--;return r>0||n<t.length?t.slice(r,n):t}const Lbe=["push","pop","shift","splice","unshift"];function Dct(t,e){if(t._chartjs){t._chartjs.listeners.push(e);return}Object.defineProperty(t,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),Lbe.forEach(i=>{const r="_onData"+tH(i),n=t[i];Object.defineProperty(t,i,{configurable:!0,enumerable:!1,value(...s){const o=n.apply(this,s);return t._chartjs.listeners.forEach(a=>{typeof a[r]=="function"&&a[r](...s)}),o}})})}function Jte(t,e){const i=t._chartjs;if(!i)return;const r=i.listeners,n=r.indexOf(e);n!==-1&&r.splice(n,1),!(r.length>0)&&(Lbe.forEach(s=>{delete t[s]}),delete t._chartjs)}function Rbe(t){const e=new Set(t);return e.size===t.length?t:Array.from(e)}const Fbe=function(){return typeof window>"u"?function(t){return t()}:window.requestAnimationFrame}();function Dbe(t,e){let i=[],r=!1;return function(...n){i=n,r||(r=!0,Fbe.call(window,()=>{r=!1,t.apply(e,i)}))}}function Nct(t,e){let i;return function(...r){return e?(clearTimeout(i),i=setTimeout(t,e,r)):t.apply(this,r),e}}const nH=t=>t==="start"?"left":t==="end"?"right":"center",eo=(t,e,i)=>t==="start"?e:t==="end"?i:(e+i)/2,Vct=(t,e,i,r)=>t===(r?"left":"right")?i:t==="center"?(e+i)/2:e;function Nbe(t,e,i){const r=e.length;let n=0,s=r;if(t._sorted){const{iScale:o,_parsed:a}=t,l=o.axis,{min:c,max:u,minDefined:h,maxDefined:f}=o.getUserBounds();h&&(n=fs(Math.min(ep(a,o.axis,c).lo,i?r:ep(e,l,o.getPixelForValue(c)).lo),0,r-1)),f?s=fs(Math.max(ep(a,o.axis,u,!0).hi+1,i?0:ep(e,l,o.getPixelForValue(u),!0).hi+1),n,r)-n:s=r-n}return{start:n,count:s}}function Vbe(t){const{xScale:e,yScale:i,_scaleRanges:r}=t,n={xmin:e.min,xmax:e.max,ymin:i.min,ymax:i.max};if(!r)return t._scaleRanges=n,!0;const s=r.xmin!==e.min||r.xmax!==e.max||r.ymin!==i.min||r.ymax!==i.max;return Object.assign(r,n),s}const l$=t=>t===0||t===1,Zte=(t,e,i)=>-(Math.pow(2,10*(t-=1))*Math.sin((t-e)*ar/i)),Yte=(t,e,i)=>Math.pow(2,-10*t)*Math.sin((t-e)*ar/i)+1,OI={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>-t*(t-2),easeInOutQuad:t=>(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1),easeInCubic:t=>t*t*t,easeOutCubic:t=>(t-=1)*t*t+1,easeInOutCubic:t=>(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2),easeInQuart:t=>t*t*t*t,easeOutQuart:t=>-((t-=1)*t*t*t-1),easeInOutQuart:t=>(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2),easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>(t-=1)*t*t*t*t+1,easeInOutQuint:t=>(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2),easeInSine:t=>-Math.cos(t*Hr)+1,easeOutSine:t=>Math.sin(t*Hr),easeInOutSine:t=>-.5*(Math.cos(Tr*t)-1),easeInExpo:t=>t===0?0:Math.pow(2,10*(t-1)),easeOutExpo:t=>t===1?1:-Math.pow(2,-10*t)+1,easeInOutExpo:t=>l$(t)?t:t<.5?.5*Math.pow(2,10*(t*2-1)):.5*(-Math.pow(2,-10*(t*2-1))+2),easeInCirc:t=>t>=1?t:-(Math.sqrt(1-t*t)-1),easeOutCirc:t=>Math.sqrt(1-(t-=1)*t),easeInOutCirc:t=>(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1),easeInElastic:t=>l$(t)?t:Zte(t,.075,.3),easeOutElastic:t=>l$(t)?t:Yte(t,.075,.3),easeInOutElastic(t){return l$(t)?t:t<.5?.5*Zte(t*2,.1125,.45):.5+.5*Yte(t*2-1,.1125,.45)},easeInBack(t){return t*t*((1.70158+1)*t-1.70158)},easeOutBack(t){return(t-=1)*t*((1.70158+1)*t+1.70158)+1},easeInOutBack(t){let e=1.70158;return(t/=.5)<1?.5*(t*t*(((e*=1.525)+1)*t-e)):.5*((t-=2)*t*(((e*=1.525)+1)*t+e)+2)},easeInBounce:t=>1-OI.easeOutBounce(1-t),easeOutBounce(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},easeInOutBounce:t=>t<.5?OI.easeInBounce(t*2)*.5:OI.easeOutBounce(t*2-1)*.5+.5};function sH(t){if(t&&typeof t=="object"){const e=t.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function Kte(t){return sH(t)?t:new VT(t)}function sD(t){return sH(t)?t:new VT(t).saturate(.5).darken(.1).hexString()}const zct=["x","y","borderWidth","radius","tension"],jct=["color","borderColor","backgroundColor"];function Bct(t){t.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),t.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),t.set("animations",{colors:{type:"color",properties:jct},numbers:{type:"number",properties:zct}}),t.describe("animations",{_fallback:"animation"}),t.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function Uct(t){t.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const Xte=new Map;function Gct(t,e){e=e||{};const i=t+JSON.stringify(e);let r=Xte.get(i);return r||(r=new Intl.NumberFormat(t,e),Xte.set(i,r)),r}function tE(t,e,i){return Gct(e,i).format(t)}const zbe={values(t){return sr(t)?t:""+t},numeric(t,e,i){if(t===0)return"0";const r=this.chart.options.locale;let n,s=t;if(i.length>1){const c=Math.max(Math.abs(i[0].value),Math.abs(i[i.length-1].value));(c<1e-4||c>1e15)&&(n="scientific"),s=Hct(t,i)}const o=Um(Math.abs(s)),a=isNaN(o)?1:Math.max(Math.min(-1*Math.floor(o),20),0),l={notation:n,minimumFractionDigits:a,maximumFractionDigits:a};return Object.assign(l,this.options.ticks.format),tE(t,r,l)},logarithmic(t,e,i){if(t===0)return"0";const r=i[e].significand||t/Math.pow(10,Math.floor(Um(t)));return[1,2,3,5,10,15].includes(r)||e>.8*i.length?zbe.numeric.call(this,t,e,i):""}};function Hct(t,e){let i=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(i)>=1&&t!==Math.floor(t)&&(i=t-Math.floor(t)),i}var NR={formatters:zbe};function qct(t){t.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,i)=>i.lineWidth,tickColor:(e,i)=>i.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:NR.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),t.route("scale.ticks","color","","color"),t.route("scale.grid","color","","borderColor"),t.route("scale.border","color","","borderColor"),t.route("scale.title","color","","color"),t.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),t.describe("scales",{_fallback:"scale"}),t.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const Vv=Object.create(null),v6=Object.create(null);function LI(t,e){if(!e)return t;const i=e.split(".");for(let r=0,n=i.length;r<n;++r){const s=i[r];t=t[s]||(t[s]=Object.create(null))}return t}function oD(t,e,i){return typeof e=="string"?zT(LI(t,e),i):zT(LI(t,""),e)}class Wct{constructor(e,i){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=r=>r.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(r,n)=>sD(n.backgroundColor),this.hoverBorderColor=(r,n)=>sD(n.borderColor),this.hoverColor=(r,n)=>sD(n.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(i)}set(e,i){return oD(this,e,i)}get(e){return LI(this,e)}describe(e,i){return oD(v6,e,i)}override(e,i){return oD(Vv,e,i)}route(e,i,r,n){const s=LI(this,e),o=LI(this,r),a="_"+i;Object.defineProperties(s,{[a]:{value:s[i],writable:!0},[i]:{enumerable:!0,get(){const l=this[a],c=o[n];return Ft(l)?Object.assign({},c,l):ot(l,c)},set(l){this[a]=l}}})}apply(e){e.forEach(i=>i(this))}}var qr=new Wct({_scriptable:t=>!t.startsWith("on"),_indexable:t=>t!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[Bct,Uct,qct]);function Jct(t){return!t||ei(t.size)||ei(t.family)?null:(t.style?t.style+" ":"")+(t.weight?t.weight+" ":"")+t.size+"px "+t.family}function LO(t,e,i,r,n){let s=e[n];return s||(s=e[n]=t.measureText(n).width,i.push(n)),s>r&&(r=s),r}function Zct(t,e,i,r){r=r||{};let n=r.data=r.data||{},s=r.garbageCollect=r.garbageCollect||[];r.font!==e&&(n=r.data={},s=r.garbageCollect=[],r.font=e),t.save(),t.font=e;let o=0;const a=i.length;let l,c,u,h,f;for(l=0;l<a;l++)if(h=i[l],h!=null&&!sr(h))o=LO(t,n,s,o,h);else if(sr(h))for(c=0,u=h.length;c<u;c++)f=h[c],f!=null&&!sr(f)&&(o=LO(t,n,s,o,f));t.restore();const m=s.length/2;if(m>i.length){for(l=0;l<m;l++)delete n[s[l]];s.splice(0,m)}return o}function ry(t,e,i){const r=t.currentDevicePixelRatio,n=i!==0?Math.max(i/2,.5):0;return Math.round((e-n)*r)/r+n}function Qte(t,e){e=e||t.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,t.width,t.height),e.restore()}function _6(t,e,i,r){jbe(t,e,i,r,null)}function jbe(t,e,i,r,n){let s,o,a,l,c,u,h,f;const m=e.pointStyle,g=e.rotation,y=e.radius;let v=(g||0)*Act;if(m&&typeof m=="object"&&(s=m.toString(),s==="[object HTMLImageElement]"||s==="[object HTMLCanvasElement]")){t.save(),t.translate(i,r),t.rotate(v),t.drawImage(m,-m.width/2,-m.height/2,m.width,m.height),t.restore();return}if(!(isNaN(y)||y<=0)){switch(t.beginPath(),m){default:n?t.ellipse(i,r,n/2,y,0,0,ar):t.arc(i,r,y,0,ar),t.closePath();break;case"triangle":u=n?n/2:y,t.moveTo(i+Math.sin(v)*u,r-Math.cos(v)*y),v+=Hte,t.lineTo(i+Math.sin(v)*u,r-Math.cos(v)*y),v+=Hte,t.lineTo(i+Math.sin(v)*u,r-Math.cos(v)*y),t.closePath();break;case"rectRounded":c=y*.516,l=y-c,o=Math.cos(v+iy)*l,h=Math.cos(v+iy)*(n?n/2-c:l),a=Math.sin(v+iy)*l,f=Math.sin(v+iy)*(n?n/2-c:l),t.arc(i-h,r-a,c,v-Tr,v-Hr),t.arc(i+f,r-o,c,v-Hr,v),t.arc(i+h,r+a,c,v,v+Hr),t.arc(i-f,r+o,c,v+Hr,v+Tr),t.closePath();break;case"rect":if(!g){l=Math.SQRT1_2*y,u=n?n/2:l,t.rect(i-u,r-l,2*u,2*l);break}v+=iy;case"rectRot":h=Math.cos(v)*(n?n/2:y),o=Math.cos(v)*y,a=Math.sin(v)*y,f=Math.sin(v)*(n?n/2:y),t.moveTo(i-h,r-a),t.lineTo(i+f,r-o),t.lineTo(i+h,r+a),t.lineTo(i-f,r+o),t.closePath();break;case"crossRot":v+=iy;case"cross":h=Math.cos(v)*(n?n/2:y),o=Math.cos(v)*y,a=Math.sin(v)*y,f=Math.sin(v)*(n?n/2:y),t.moveTo(i-h,r-a),t.lineTo(i+h,r+a),t.moveTo(i+f,r-o),t.lineTo(i-f,r+o);break;case"star":h=Math.cos(v)*(n?n/2:y),o=Math.cos(v)*y,a=Math.sin(v)*y,f=Math.sin(v)*(n?n/2:y),t.moveTo(i-h,r-a),t.lineTo(i+h,r+a),t.moveTo(i+f,r-o),t.lineTo(i-f,r+o),v+=iy,h=Math.cos(v)*(n?n/2:y),o=Math.cos(v)*y,a=Math.sin(v)*y,f=Math.sin(v)*(n?n/2:y),t.moveTo(i-h,r-a),t.lineTo(i+h,r+a),t.moveTo(i+f,r-o),t.lineTo(i-f,r+o);break;case"line":o=n?n/2:Math.cos(v)*y,a=Math.sin(v)*y,t.moveTo(i-o,r-a),t.lineTo(i+o,r+a);break;case"dash":t.moveTo(i,r),t.lineTo(i+Math.cos(v)*(n?n/2:y),r+Math.sin(v)*y);break;case!1:t.closePath();break}t.fill(),e.borderWidth>0&&t.stroke()}}function tp(t,e,i){return i=i||.5,!e||t&&t.x>e.left-i&&t.x<e.right+i&&t.y>e.top-i&&t.y<e.bottom+i}function VR(t,e){t.save(),t.beginPath(),t.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),t.clip()}function zR(t){t.restore()}function Yct(t,e,i,r,n){if(!e)return t.lineTo(i.x,i.y);if(n==="middle"){const s=(e.x+i.x)/2;t.lineTo(s,e.y),t.lineTo(s,i.y)}else n==="after"!=!!r?t.lineTo(e.x,i.y):t.lineTo(i.x,e.y);t.lineTo(i.x,i.y)}function Kct(t,e,i,r){if(!e)return t.lineTo(i.x,i.y);t.bezierCurveTo(r?e.cp1x:e.cp2x,r?e.cp1y:e.cp2y,r?i.cp2x:i.cp1x,r?i.cp2y:i.cp1y,i.x,i.y)}function Xct(t,e){e.translation&&t.translate(e.translation[0],e.translation[1]),ei(e.rotation)||t.rotate(e.rotation),e.color&&(t.fillStyle=e.color),e.textAlign&&(t.textAlign=e.textAlign),e.textBaseline&&(t.textBaseline=e.textBaseline)}function Qct(t,e,i,r,n){if(n.strikethrough||n.underline){const s=t.measureText(r),o=e-s.actualBoundingBoxLeft,a=e+s.actualBoundingBoxRight,l=i-s.actualBoundingBoxAscent,c=i+s.actualBoundingBoxDescent,u=n.strikethrough?(l+c)/2:c;t.strokeStyle=t.fillStyle,t.beginPath(),t.lineWidth=n.decorationWidth||2,t.moveTo(o,u),t.lineTo(a,u),t.stroke()}}function eut(t,e){const i=t.fillStyle;t.fillStyle=e.color,t.fillRect(e.left,e.top,e.width,e.height),t.fillStyle=i}function zv(t,e,i,r,n,s={}){const o=sr(e)?e:[e],a=s.strokeWidth>0&&s.strokeColor!=="";let l,c;for(t.save(),t.font=n.string,Xct(t,s),l=0;l<o.length;++l)c=o[l],s.backdrop&&eut(t,s.backdrop),a&&(s.strokeColor&&(t.strokeStyle=s.strokeColor),ei(s.strokeWidth)||(t.lineWidth=s.strokeWidth),t.strokeText(c,i,r,s.maxWidth)),t.fillText(c,i,r,s.maxWidth),Qct(t,i,r,c,s),r+=Number(n.lineHeight);t.restore()}function UT(t,e){const{x:i,y:r,w:n,h:s,radius:o}=e;t.arc(i+o.topLeft,r+o.topLeft,o.topLeft,-Hr,Tr,!0),t.lineTo(i,r+s-o.bottomLeft),t.arc(i+o.bottomLeft,r+s-o.bottomLeft,o.bottomLeft,Tr,Hr,!0),t.lineTo(i+n-o.bottomRight,r+s),t.arc(i+n-o.bottomRight,r+s-o.bottomRight,o.bottomRight,Hr,0,!0),t.lineTo(i+n,r+o.topRight),t.arc(i+n-o.topRight,r+o.topRight,o.topRight,0,-Hr,!0),t.lineTo(i+o.topLeft,r)}const tut=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,iut=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function rut(t,e){const i=(""+t).match(tut);if(!i||i[1]==="normal")return e*1.2;switch(t=+i[2],i[3]){case"px":return t;case"%":t/=100;break}return e*t}const nut=t=>+t||0;function oH(t,e){const i={},r=Ft(e),n=r?Object.keys(e):e,s=Ft(t)?r?o=>ot(t[o],t[e[o]]):o=>t[o]:()=>t;for(const o of n)i[o]=nut(s(o));return i}function Bbe(t){return oH(t,{top:"y",right:"x",bottom:"y",left:"x"})}function mv(t){return oH(t,["topLeft","topRight","bottomLeft","bottomRight"])}function fo(t){const e=Bbe(t);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function Jn(t,e){t=t||{},e=e||qr.font;let i=ot(t.size,e.size);typeof i=="string"&&(i=parseInt(i,10));let r=ot(t.style,e.style);r&&!(""+r).match(iut)&&(console.warn('Invalid font style specified: "'+r+'"'),r=void 0);const n={family:ot(t.family,e.family),lineHeight:rut(ot(t.lineHeight,e.lineHeight),i),size:i,style:r,weight:ot(t.weight,e.weight),string:""};return n.string=Jct(n),n}function F2(t,e,i,r){let n=!0,s,o,a;for(s=0,o=t.length;s<o;++s)if(a=t[s],a!==void 0&&(e!==void 0&&typeof a=="function"&&(a=a(e),n=!1),i!==void 0&&sr(a)&&(a=a[i%a.length],n=!1),a!==void 0))return r&&!n&&(r.cacheable=!1),a}function sut(t,e,i){const{min:r,max:n}=t,s=Abe(e,(n-r)/2),o=(a,l)=>i&&a===0?0:a+l;return{min:o(r,-Math.abs(s)),max:o(n,s)}}function Pg(t,e){return Object.assign(Object.create(t),e)}function aH(t,e=[""],i,r,n=()=>t[0]){const s=i||t;typeof r>"u"&&(r=qbe("_fallback",t));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:t,_rootScopes:s,_fallback:r,_getTarget:n,override:a=>aH([a,...t],e,s,r)};return new Proxy(o,{deleteProperty(a,l){return delete a[l],delete a._keys,delete t[0][l],!0},get(a,l){return Gbe(a,l,()=>put(l,e,t,a))},getOwnPropertyDescriptor(a,l){return Reflect.getOwnPropertyDescriptor(a._scopes[0],l)},getPrototypeOf(){return Reflect.getPrototypeOf(t[0])},has(a,l){return tie(a).includes(l)},ownKeys(a){return tie(a)},set(a,l,c){const u=a._storage||(a._storage=n());return a[l]=u[l]=c,delete a._keys,!0}})}function A1(t,e,i,r){const n={_cacheable:!1,_proxy:t,_context:e,_subProxy:i,_stack:new Set,_descriptors:Ube(t,r),setContext:s=>A1(t,s,i,r),override:s=>A1(t.override(s),e,i,r)};return new Proxy(n,{deleteProperty(s,o){return delete s[o],delete t[o],!0},get(s,o,a){return Gbe(s,o,()=>aut(s,o,a))},getOwnPropertyDescriptor(s,o){return s._descriptors.allKeys?Reflect.has(t,o)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(t,o)},getPrototypeOf(){return Reflect.getPrototypeOf(t)},has(s,o){return Reflect.has(t,o)},ownKeys(){return Reflect.ownKeys(t)},set(s,o,a){return t[o]=a,delete s[o],!0}})}function Ube(t,e={scriptable:!0,indexable:!0}){const{_scriptable:i=e.scriptable,_indexable:r=e.indexable,_allKeys:n=e.allKeys}=t;return{allKeys:n,scriptable:i,indexable:r,isScriptable:yg(i)?i:()=>i,isIndexable:yg(r)?r:()=>r}}const out=(t,e)=>t?t+tH(e):e,lH=(t,e)=>Ft(e)&&t!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function Gbe(t,e,i){if(Object.prototype.hasOwnProperty.call(t,e))return t[e];const r=i();return t[e]=r,r}function aut(t,e,i){const{_proxy:r,_context:n,_subProxy:s,_descriptors:o}=t;let a=r[e];return yg(a)&&o.isScriptable(e)&&(a=lut(e,a,t,i)),sr(a)&&a.length&&(a=cut(e,a,t,o.isIndexable)),lH(e,a)&&(a=A1(a,n,s&&s[e],o)),a}function lut(t,e,i,r){const{_proxy:n,_context:s,_subProxy:o,_stack:a}=i;if(a.has(t))throw new Error("Recursion detected: "+Array.from(a).join("->")+"->"+t);a.add(t);let l=e(s,o||r);return a.delete(t),lH(t,l)&&(l=cH(n._scopes,n,t,l)),l}function cut(t,e,i,r){const{_proxy:n,_context:s,_subProxy:o,_descriptors:a}=i;if(typeof s.index<"u"&&r(t))return e[s.index%e.length];if(Ft(e[0])){const l=e,c=n._scopes.filter(u=>u!==l);e=[];for(const u of l){const h=cH(c,n,t,u);e.push(A1(h,s,o&&o[t],a))}}return e}function Hbe(t,e,i){return yg(t)?t(e,i):t}const uut=(t,e)=>t===!0?e:typeof t=="string"?gg(e,t):void 0;function dut(t,e,i,r,n){for(const s of e){const o=uut(i,s);if(o){t.add(o);const a=Hbe(o._fallback,i,n);if(typeof a<"u"&&a!==i&&a!==r)return a}else if(o===!1&&typeof r<"u"&&i!==r)return null}return!1}function cH(t,e,i,r){const n=e._rootScopes,s=Hbe(e._fallback,i,r),o=[...t,...n],a=new Set;a.add(r);let l=eie(a,o,i,s||i,r);return l===null||typeof s<"u"&&s!==i&&(l=eie(a,o,s,l,r),l===null)?!1:aH(Array.from(a),[""],n,s,()=>hut(e,i,r))}function eie(t,e,i,r,n){for(;i;)i=dut(t,e,i,r,n);return i}function hut(t,e,i){const r=t._getTarget();e in r||(r[e]={});const n=r[e];return sr(n)&&Ft(i)?i:n||{}}function put(t,e,i,r){let n;for(const s of e)if(n=qbe(out(s,t),i),typeof n<"u")return lH(t,n)?cH(i,r,t,n):n}function qbe(t,e){for(const i of e){if(!i)continue;const r=i[t];if(typeof r<"u")return r}}function tie(t){let e=t._keys;return e||(e=t._keys=fut(t._scopes)),e}function fut(t){const e=new Set;for(const i of t)for(const r of Object.keys(i).filter(n=>!n.startsWith("_")))e.add(r);return Array.from(e)}function Wbe(t,e,i,r){const{iScale:n}=t,{key:s="r"}=this._parsing,o=new Array(r);let a,l,c,u;for(a=0,l=r;a<l;++a)c=a+i,u=e[c],o[a]={r:n.parse(gg(u,s),c)};return o}const mut=Number.EPSILON||1e-14,k1=(t,e)=>e<t.length&&!t[e].skip&&t[e],Jbe=t=>t==="x"?"y":"x";function gut(t,e,i,r){const n=t.skip?e:t,s=e,o=i.skip?e:i,a=y6(s,n),l=y6(o,s);let c=a/(a+l),u=l/(a+l);c=isNaN(c)?0:c,u=isNaN(u)?0:u;const h=r*c,f=r*u;return{previous:{x:s.x-h*(o.x-n.x),y:s.y-h*(o.y-n.y)},next:{x:s.x+f*(o.x-n.x),y:s.y+f*(o.y-n.y)}}}function yut(t,e,i){const r=t.length;let n,s,o,a,l,c=k1(t,0);for(let u=0;u<r-1;++u)if(l=c,c=k1(t,u+1),!(!l||!c)){if(PI(e[u],0,mut)){i[u]=i[u+1]=0;continue}n=i[u]/e[u],s=i[u+1]/e[u],a=Math.pow(n,2)+Math.pow(s,2),!(a<=9)&&(o=3/Math.sqrt(a),i[u]=n*o*e[u],i[u+1]=s*o*e[u])}}function vut(t,e,i="x"){const r=Jbe(i),n=t.length;let s,o,a,l=k1(t,0);for(let c=0;c<n;++c){if(o=a,a=l,l=k1(t,c+1),!a)continue;const u=a[i],h=a[r];o&&(s=(u-o[i])/3,a[`cp1${i}`]=u-s,a[`cp1${r}`]=h-s*e[c]),l&&(s=(l[i]-u)/3,a[`cp2${i}`]=u+s,a[`cp2${r}`]=h+s*e[c])}}function _ut(t,e="x"){const i=Jbe(e),r=t.length,n=Array(r).fill(0),s=Array(r);let o,a,l,c=k1(t,0);for(o=0;o<r;++o)if(a=l,l=c,c=k1(t,o+1),!!l){if(c){const u=c[e]-l[e];n[o]=u!==0?(c[i]-l[i])/u:0}s[o]=a?c?sc(n[o-1])!==sc(n[o])?0:(n[o-1]+n[o])/2:n[o-1]:n[o]}yut(t,n,s),vut(t,s,e)}function c$(t,e,i){return Math.max(Math.min(t,i),e)}function but(t,e){let i,r,n,s,o,a=tp(t[0],e);for(i=0,r=t.length;i<r;++i)o=s,s=a,a=i<r-1&&tp(t[i+1],e),s&&(n=t[i],o&&(n.cp1x=c$(n.cp1x,e.left,e.right),n.cp1y=c$(n.cp1y,e.top,e.bottom)),a&&(n.cp2x=c$(n.cp2x,e.left,e.right),n.cp2y=c$(n.cp2y,e.top,e.bottom)))}function wut(t,e,i,r,n){let s,o,a,l;if(e.spanGaps&&(t=t.filter(c=>!c.skip)),e.cubicInterpolationMode==="monotone")_ut(t,n);else{let c=r?t[t.length-1]:t[0];for(s=0,o=t.length;s<o;++s)a=t[s],l=gut(c,a,t[Math.min(s+1,o-(r?0:1))%o],e.tension),a.cp1x=l.previous.x,a.cp1y=l.previous.y,a.cp2x=l.next.x,a.cp2y=l.next.y,c=a}e.capBezierPoints&&but(t,i)}function Zbe(){return typeof window<"u"&&typeof document<"u"}function uH(t){let e=t.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function RO(t,e,i){let r;return typeof t=="string"?(r=parseInt(t,10),t.indexOf("%")!==-1&&(r=r/100*e.parentNode[i])):r=t,r}const jR=t=>t.ownerDocument.defaultView.getComputedStyle(t,null);function xut(t,e){return jR(t).getPropertyValue(e)}const Sut=["top","right","bottom","left"];function gv(t,e,i){const r={};i=i?"-"+i:"";for(let n=0;n<4;n++){const s=Sut[n];r[s]=parseFloat(t[e+"-"+s+i])||0}return r.width=r.left+r.right,r.height=r.top+r.bottom,r}const Iut=(t,e,i)=>(t>0||e>0)&&(!i||!i.shadowRoot);function Tut(t,e){const i=t.touches,r=i&&i.length?i[0]:t,{offsetX:n,offsetY:s}=r;let o=!1,a,l;if(Iut(n,s,t.target))a=n,l=s;else{const c=e.getBoundingClientRect();a=r.clientX-c.left,l=r.clientY-c.top,o=!0}return{x:a,y:l,box:o}}function bd(t,e){if("native"in t)return t;const{canvas:i,currentDevicePixelRatio:r}=e,n=jR(i),s=n.boxSizing==="border-box",o=gv(n,"padding"),a=gv(n,"border","width"),{x:l,y:c,box:u}=Tut(t,i),h=o.left+(u&&a.left),f=o.top+(u&&a.top);let{width:m,height:g}=e;return s&&(m-=o.width+a.width,g-=o.height+a.height),{x:Math.round((l-h)/m*i.width/r),y:Math.round((c-f)/g*i.height/r)}}function Cut(t,e,i){let r,n;if(e===void 0||i===void 0){const s=uH(t);if(!s)e=t.clientWidth,i=t.clientHeight;else{const o=s.getBoundingClientRect(),a=jR(s),l=gv(a,"border","width"),c=gv(a,"padding");e=o.width-c.width-l.width,i=o.height-c.height-l.height,r=RO(a.maxWidth,s,"clientWidth"),n=RO(a.maxHeight,s,"clientHeight")}}return{width:e,height:i,maxWidth:r||OO,maxHeight:n||OO}}const u$=t=>Math.round(t*10)/10;function Eut(t,e,i,r){const n=jR(t),s=gv(n,"margin"),o=RO(n.maxWidth,t,"clientWidth")||OO,a=RO(n.maxHeight,t,"clientHeight")||OO,l=Cut(t,e,i);let{width:c,height:u}=l;if(n.boxSizing==="content-box"){const f=gv(n,"border","width"),m=gv(n,"padding");c-=m.width+f.width,u-=m.height+f.height}return c=Math.max(0,c-s.width),u=Math.max(0,r?c/r:u-s.height),c=u$(Math.min(c,o,l.maxWidth)),u=u$(Math.min(u,a,l.maxHeight)),c&&!u&&(u=u$(c/2)),(e!==void 0||i!==void 0)&&r&&l.height&&u>l.height&&(u=l.height,c=u$(Math.floor(u*r))),{width:c,height:u}}function iie(t,e,i){const r=e||1,n=Math.floor(t.height*r),s=Math.floor(t.width*r);t.height=Math.floor(t.height),t.width=Math.floor(t.width);const o=t.canvas;return o.style&&(i||!o.style.height&&!o.style.width)&&(o.style.height=`${t.height}px`,o.style.width=`${t.width}px`),t.currentDevicePixelRatio!==r||o.height!==n||o.width!==s?(t.currentDevicePixelRatio=r,o.height=n,o.width=s,t.ctx.setTransform(r,0,0,r,0,0),!0):!1}const Mut=function(){let t=!1;try{const e={get passive(){return t=!0,!1}};window.addEventListener("test",null,e),window.removeEventListener("test",null,e)}catch{}return t}();function rie(t,e){const i=xut(t,e),r=i&&i.match(/^(\d+)(\.\d+)?px$/);return r?+r[1]:void 0}function S0(t,e,i,r){return{x:t.x+i*(e.x-t.x),y:t.y+i*(e.y-t.y)}}function $ut(t,e,i,r){return{x:t.x+i*(e.x-t.x),y:r==="middle"?i<.5?t.y:e.y:r==="after"?i<1?t.y:e.y:i>0?e.y:t.y}}function Aut(t,e,i,r){const n={x:t.cp2x,y:t.cp2y},s={x:e.cp1x,y:e.cp1y},o=S0(t,n,i),a=S0(n,s,i),l=S0(s,e,i),c=S0(o,a,i),u=S0(a,l,i);return S0(c,u,i)}const kut=function(t,e){return{x(i){return t+t+e-i},setWidth(i){e=i},textAlign(i){return i==="center"?i:i==="right"?"left":"right"},xPlus(i,r){return i-r},leftForLtr(i,r){return i-r}}},Put=function(){return{x(t){return t},setWidth(t){},textAlign(t){return t},xPlus(t,e){return t+e},leftForLtr(t,e){return t}}};function qw(t,e,i){return t?kut(e,i):Put()}function Ybe(t,e){let i,r;(e==="ltr"||e==="rtl")&&(i=t.canvas.style,r=[i.getPropertyValue("direction"),i.getPropertyPriority("direction")],i.setProperty("direction",e,"important"),t.prevTextDirection=r)}function Kbe(t,e){e!==void 0&&(delete t.prevTextDirection,t.canvas.style.setProperty("direction",e[0],e[1]))}function Xbe(t){return t==="angle"?{between:BT,compare:Oct,normalize:Ya}:{between:Qh,compare:(e,i)=>e-i,normalize:e=>e}}function nie({start:t,end:e,count:i,loop:r,style:n}){return{start:t%i,end:e%i,loop:r&&(e-t+1)%i===0,style:n}}function Out(t,e,i){const{property:r,start:n,end:s}=i,{between:o,normalize:a}=Xbe(r),l=e.length;let{start:c,end:u,loop:h}=t,f,m;if(h){for(c+=l,u+=l,f=0,m=l;f<m&&o(a(e[c%l][r]),n,s);++f)c--,u--;c%=l,u%=l}return u<c&&(u+=l),{start:c,end:u,loop:h,style:t.style}}function Qbe(t,e,i){if(!i)return[t];const{property:r,start:n,end:s}=i,o=e.length,{compare:a,between:l,normalize:c}=Xbe(r),{start:u,end:h,loop:f,style:m}=Out(t,e,i),g=[];let y=!1,v=null,b,w,x;const S=()=>l(n,x,b)&&a(n,x)!==0,I=()=>a(s,b)===0||l(s,x,b),T=()=>y||S(),C=()=>!y||I();for(let E=u,$=u;E<=h;++E)w=e[E%o],!w.skip&&(b=c(w[r]),b!==x&&(y=l(b,n,s),v===null&&T()&&(v=a(b,n)===0?E:$),v!==null&&C()&&(g.push(nie({start:v,end:E,loop:f,count:o,style:m})),v=null),$=E,x=b));return v!==null&&g.push(nie({start:v,end:h,loop:f,count:o,style:m})),g}function ewe(t,e){const i=[],r=t.segments;for(let n=0;n<r.length;n++){const s=Qbe(r[n],t.points,e);s.length&&i.push(...s)}return i}function Lut(t,e,i,r){let n=0,s=e-1;if(i&&!r)for(;n<e&&!t[n].skip;)n++;for(;n<e&&t[n].skip;)n++;for(n%=e,i&&(s+=n);s>n&&t[s%e].skip;)s--;return s%=e,{start:n,end:s}}function Rut(t,e,i,r){const n=t.length,s=[];let o=e,a=t[e],l;for(l=e+1;l<=i;++l){const c=t[l%n];c.skip||c.stop?a.skip||(r=!1,s.push({start:e%n,end:(l-1)%n,loop:r}),e=o=c.stop?l:null):(o=l,a.skip&&(e=l)),a=c}return o!==null&&s.push({start:e%n,end:o%n,loop:r}),s}function Fut(t,e){const i=t.points,r=t.options.spanGaps,n=i.length;if(!n)return[];const s=!!t._loop,{start:o,end:a}=Lut(i,n,s,r);if(r===!0)return sie(t,[{start:o,end:a,loop:s}],i,e);const l=a<o?a+n:a,c=!!t._fullLoop&&o===0&&a===n-1;return sie(t,Rut(i,o,l,c),i,e)}function sie(t,e,i,r){return!r||!r.setContext||!i?e:Dut(t,e,i,r)}function Dut(t,e,i,r){const n=t._chart.getContext(),s=oie(t.options),{_datasetIndex:o,options:{spanGaps:a}}=t,l=i.length,c=[];let u=s,h=e[0].start,f=h;function m(g,y,v,b){const w=a?-1:1;if(g!==y){for(g+=l;i[g%l].skip;)g-=w;for(;i[y%l].skip;)y+=w;g%l!==y%l&&(c.push({start:g%l,end:y%l,loop:v,style:b}),u=b,h=y%l)}}for(const g of e){h=a?h:g.start;let y=i[h%l],v;for(f=h+1;f<=g.end;f++){const b=i[f%l];v=oie(r.setContext(Pg(n,{type:"segment",p0:y,p1:b,p0DataIndex:(f-1)%l,p1DataIndex:f%l,datasetIndex:o}))),Nut(v,u)&&m(h,f-1,g.loop,u),y=b,u=v}h<f-1&&m(h,f-1,g.loop,u)}return c}function oie(t){return{backgroundColor:t.backgroundColor,borderCapStyle:t.borderCapStyle,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderJoinStyle:t.borderJoinStyle,borderWidth:t.borderWidth,borderColor:t.borderColor}}function Nut(t,e){if(!e)return!1;const i=[],r=function(n,s){return sH(s)?(i.includes(s)||i.push(s),i.indexOf(s)):s};return JSON.stringify(t,r)!==JSON.stringify(e,r)}/*!
 * Chart.js v4.3.0
 * https://www.chartjs.org
 * (c) 2023 Chart.js Contributors
 * Released under the MIT License
 */class Vut{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,i,r,n){const s=i.listeners[n],o=i.duration;s.forEach(a=>a({chart:e,initial:i.initial,numSteps:o,currentStep:Math.min(r-i.start,o)}))}_refresh(){this._request||(this._running=!0,this._request=Fbe.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let i=0;this._charts.forEach((r,n)=>{if(!r.running||!r.items.length)return;const s=r.items;let o=s.length-1,a=!1,l;for(;o>=0;--o)l=s[o],l._active?(l._total>r.duration&&(r.duration=l._total),l.tick(e),a=!0):(s[o]=s[s.length-1],s.pop());a&&(n.draw(),this._notify(n,r,e,"progress")),s.length||(r.running=!1,this._notify(n,r,e,"complete"),r.initial=!1),i+=s.length}),this._lastDate=e,i===0&&(this._running=!1)}_getAnims(e){const i=this._charts;let r=i.get(e);return r||(r={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},i.set(e,r)),r}listen(e,i,r){this._getAnims(e).listeners[i].push(r)}add(e,i){!i||!i.length||this._getAnims(e).items.push(...i)}has(e){return this._getAnims(e).items.length>0}start(e){const i=this._charts.get(e);i&&(i.running=!0,i.start=Date.now(),i.duration=i.items.reduce((r,n)=>Math.max(r,n._duration),0),this._refresh())}running(e){if(!this._running)return!1;const i=this._charts.get(e);return!(!i||!i.running||!i.items.length)}stop(e){const i=this._charts.get(e);if(!i||!i.items.length)return;const r=i.items;let n=r.length-1;for(;n>=0;--n)r[n].cancel();i.items=[],this._notify(e,i,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var Fh=new Vut;const aie="transparent",zut={boolean(t,e,i){return i>.5?e:t},color(t,e,i){const r=Kte(t||aie),n=r.valid&&Kte(e||aie);return n&&n.valid?n.mix(r,i).hexString():e},number(t,e,i){return t+(e-t)*i}};class jut{constructor(e,i,r,n){const s=i[r];n=F2([e.to,n,s,e.from]);const o=F2([e.from,s,n]);this._active=!0,this._fn=e.fn||zut[e.type||typeof o],this._easing=OI[e.easing]||OI.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=i,this._prop=r,this._from=o,this._to=n,this._promises=void 0}active(){return this._active}update(e,i,r){if(this._active){this._notify(!1);const n=this._target[this._prop],s=r-this._start,o=this._duration-s;this._start=r,this._duration=Math.floor(Math.max(o,e.duration)),this._total+=s,this._loop=!!e.loop,this._to=F2([e.to,i,n,e.from]),this._from=F2([e.from,n,i])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const i=e-this._start,r=this._duration,n=this._prop,s=this._from,o=this._loop,a=this._to;let l;if(this._active=s!==a&&(o||i<r),!this._active){this._target[n]=a,this._notify(!0);return}if(i<0){this._target[n]=s;return}l=i/r%2,l=o&&l>1?2-l:l,l=this._easing(Math.min(1,Math.max(0,l))),this._target[n]=this._fn(s,a,l)}wait(){const e=this._promises||(this._promises=[]);return new Promise((i,r)=>{e.push({res:i,rej:r})})}_notify(e){const i=e?"res":"rej",r=this._promises||[];for(let n=0;n<r.length;n++)r[n][i]()}}class twe{constructor(e,i){this._chart=e,this._properties=new Map,this.configure(i)}configure(e){if(!Ft(e))return;const i=Object.keys(qr.animation),r=this._properties;Object.getOwnPropertyNames(e).forEach(n=>{const s=e[n];if(!Ft(s))return;const o={};for(const a of i)o[a]=s[a];(sr(s.properties)&&s.properties||[n]).forEach(a=>{(a===n||!r.has(a))&&r.set(a,o)})})}_animateOptions(e,i){const r=i.options,n=Uut(e,r);if(!n)return[];const s=this._createAnimations(n,r);return r.$shared&&But(e.options.$animations,r).then(()=>{e.options=r},()=>{}),s}_createAnimations(e,i){const r=this._properties,n=[],s=e.$animations||(e.$animations={}),o=Object.keys(i),a=Date.now();let l;for(l=o.length-1;l>=0;--l){const c=o[l];if(c.charAt(0)==="$")continue;if(c==="options"){n.push(...this._animateOptions(e,i));continue}const u=i[c];let h=s[c];const f=r.get(c);if(h)if(f&&h.active()){h.update(f,u,a);continue}else h.cancel();if(!f||!f.duration){e[c]=u;continue}s[c]=h=new jut(f,e,c,u),n.push(h)}return n}update(e,i){if(this._properties.size===0){Object.assign(e,i);return}const r=this._createAnimations(e,i);if(r.length)return Fh.add(this._chart,r),!0}}function But(t,e){const i=[],r=Object.keys(e);for(let n=0;n<r.length;n++){const s=t[r[n]];s&&s.active()&&i.push(s.wait())}return Promise.all(i)}function Uut(t,e){if(!e)return;let i=t.options;if(!i){t.options=e;return}return i.$shared&&(t.options=i=Object.assign({},i,{$shared:!1,$animations:{}})),i}function lie(t,e){const i=t&&t.options||{},r=i.reverse,n=i.min===void 0?e:0,s=i.max===void 0?e:0;return{start:r?s:n,end:r?n:s}}function Gut(t,e,i){if(i===!1)return!1;const r=lie(t,i),n=lie(e,i);return{top:n.end,right:r.end,bottom:n.start,left:r.start}}function Hut(t){let e,i,r,n;return Ft(t)?(e=t.top,i=t.right,r=t.bottom,n=t.left):e=i=r=n=t,{top:e,right:i,bottom:r,left:n,disabled:t===!1}}function iwe(t,e){const i=[],r=t._getSortedDatasetMetas(e);let n,s;for(n=0,s=r.length;n<s;++n)i.push(r[n].index);return i}function cie(t,e,i,r={}){const n=t.keys,s=r.mode==="single";let o,a,l,c;if(e!==null){for(o=0,a=n.length;o<a;++o){if(l=+n[o],l===i){if(r.all)continue;break}c=t.values[l],Gr(c)&&(s||e===0||sc(e)===sc(c))&&(e+=c)}return e}}function qut(t){const e=Object.keys(t),i=new Array(e.length);let r,n,s;for(r=0,n=e.length;r<n;++r)s=e[r],i[r]={x:s,y:t[s]};return i}function uie(t,e){const i=t&&t.options.stacked;return i||i===void 0&&e.stack!==void 0}function Wut(t,e,i){return`${t.id}.${e.id}.${i.stack||i.type}`}function Jut(t){const{min:e,max:i,minDefined:r,maxDefined:n}=t.getUserBounds();return{min:r?e:Number.NEGATIVE_INFINITY,max:n?i:Number.POSITIVE_INFINITY}}function Zut(t,e,i){const r=t[e]||(t[e]={});return r[i]||(r[i]={})}function die(t,e,i,r){for(const n of e.getMatchingVisibleMetas(r).reverse()){const s=t[n.index];if(i&&s>0||!i&&s<0)return n.index}return null}function hie(t,e){const{chart:i,_cachedMeta:r}=t,n=i._stacks||(i._stacks={}),{iScale:s,vScale:o,index:a}=r,l=s.axis,c=o.axis,u=Wut(s,o,r),h=e.length;let f;for(let m=0;m<h;++m){const g=e[m],{[l]:y,[c]:v}=g,b=g._stacks||(g._stacks={});f=b[c]=Zut(n,u,y),f[a]=v,f._top=die(f,o,!0,r.type),f._bottom=die(f,o,!1,r.type);const w=f._visualValues||(f._visualValues={});w[a]=v}}function aD(t,e){const i=t.scales;return Object.keys(i).filter(r=>i[r].axis===e).shift()}function Yut(t,e){return Pg(t,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function Kut(t,e,i){return Pg(t,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:i,index:e,mode:"default",type:"data"})}function cS(t,e){const i=t.controller.index,r=t.vScale&&t.vScale.axis;if(r){e=e||t._parsed;for(const n of e){const s=n._stacks;if(!s||s[r]===void 0||s[r][i]===void 0)return;delete s[r][i],s[r]._visualValues!==void 0&&s[r]._visualValues[i]!==void 0&&delete s[r]._visualValues[i]}}}const lD=t=>t==="reset"||t==="none",pie=(t,e)=>e?t:Object.assign({},t),Xut=(t,e,i)=>t&&!e.hidden&&e._stacked&&{keys:iwe(i,!0),values:null};class xu{constructor(e,i){this.chart=e,this._ctx=e.ctx,this.index=i,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=uie(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&cS(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,i=this._cachedMeta,r=this.getDataset(),n=(h,f,m,g)=>h==="x"?f:h==="r"?g:m,s=i.xAxisID=ot(r.xAxisID,aD(e,"x")),o=i.yAxisID=ot(r.yAxisID,aD(e,"y")),a=i.rAxisID=ot(r.rAxisID,aD(e,"r")),l=i.indexAxis,c=i.iAxisID=n(l,s,o,a),u=i.vAxisID=n(l,o,s,a);i.xScale=this.getScaleForId(s),i.yScale=this.getScaleForId(o),i.rScale=this.getScaleForId(a),i.iScale=this.getScaleForId(c),i.vScale=this.getScaleForId(u)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const i=this._cachedMeta;return e===i.iScale?i.vScale:i.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&Jte(this._data,this),e._stacked&&cS(e)}_dataCheck(){const e=this.getDataset(),i=e.data||(e.data=[]),r=this._data;if(Ft(i))this._data=qut(i);else if(r!==i){if(r){Jte(r,this);const n=this._cachedMeta;cS(n),n._parsed=[]}i&&Object.isExtensible(i)&&Dct(i,this),this._syncList=[],this._data=i}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const i=this._cachedMeta,r=this.getDataset();let n=!1;this._dataCheck();const s=i._stacked;i._stacked=uie(i.vScale,i),i.stack!==r.stack&&(n=!0,cS(i),i.stack=r.stack),this._resyncElements(e),(n||s!==i._stacked)&&hie(this,i._parsed)}configure(){const e=this.chart.config,i=e.datasetScopeKeys(this._type),r=e.getOptionScopes(this.getDataset(),i,!0);this.options=e.createResolver(r,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,i){const{_cachedMeta:r,_data:n}=this,{iScale:s,_stacked:o}=r,a=s.axis;let l=e===0&&i===n.length?!0:r._sorted,c=e>0&&r._parsed[e-1],u,h,f;if(this._parsing===!1)r._parsed=n,r._sorted=!0,f=n;else{sr(n[e])?f=this.parseArrayData(r,n,e,i):Ft(n[e])?f=this.parseObjectData(r,n,e,i):f=this.parsePrimitiveData(r,n,e,i);const m=()=>h[a]===null||c&&h[a]<c[a];for(u=0;u<i;++u)r._parsed[u+e]=h=f[u],l&&(m()&&(l=!1),c=h);r._sorted=l}o&&hie(this,f)}parsePrimitiveData(e,i,r,n){const{iScale:s,vScale:o}=e,a=s.axis,l=o.axis,c=s.getLabels(),u=s===o,h=new Array(n);let f,m,g;for(f=0,m=n;f<m;++f)g=f+r,h[f]={[a]:u||s.parse(c[g],g),[l]:o.parse(i[g],g)};return h}parseArrayData(e,i,r,n){const{xScale:s,yScale:o}=e,a=new Array(n);let l,c,u,h;for(l=0,c=n;l<c;++l)u=l+r,h=i[u],a[l]={x:s.parse(h[0],u),y:o.parse(h[1],u)};return a}parseObjectData(e,i,r,n){const{xScale:s,yScale:o}=e,{xAxisKey:a="x",yAxisKey:l="y"}=this._parsing,c=new Array(n);let u,h,f,m;for(u=0,h=n;u<h;++u)f=u+r,m=i[f],c[u]={x:s.parse(gg(m,a),f),y:o.parse(gg(m,l),f)};return c}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,i,r){const n=this.chart,s=this._cachedMeta,o=i[e.axis],a={keys:iwe(n,!0),values:i._stacks[e.axis]._visualValues};return cie(a,o,s.index,{mode:r})}updateRangeFromParsed(e,i,r,n){const s=r[i.axis];let o=s===null?NaN:s;const a=n&&r._stacks[i.axis];n&&a&&(n.values=a,o=cie(n,s,this._cachedMeta.index)),e.min=Math.min(e.min,o),e.max=Math.max(e.max,o)}getMinMax(e,i){const r=this._cachedMeta,n=r._parsed,s=r._sorted&&e===r.iScale,o=n.length,a=this._getOtherScale(e),l=Xut(i,r,this.chart),c={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:u,max:h}=Jut(a);let f,m;function g(){m=n[f];const y=m[a.axis];return!Gr(m[e.axis])||u>y||h<y}for(f=0;f<o&&!(!g()&&(this.updateRangeFromParsed(c,e,m,l),s));++f);if(s){for(f=o-1;f>=0;--f)if(!g()){this.updateRangeFromParsed(c,e,m,l);break}}return c}getAllParsedValues(e){const i=this._cachedMeta._parsed,r=[];let n,s,o;for(n=0,s=i.length;n<s;++n)o=i[n][e.axis],Gr(o)&&r.push(o);return r}getMaxOverflow(){return!1}getLabelAndValue(e){const i=this._cachedMeta,r=i.iScale,n=i.vScale,s=this.getParsed(e);return{label:r?""+r.getLabelForValue(s[r.axis]):"",value:n?""+n.getLabelForValue(s[n.axis]):""}}_update(e){const i=this._cachedMeta;this.update(e||"default"),i._clip=Hut(ot(this.options.clip,Gut(i.xScale,i.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,i=this.chart,r=this._cachedMeta,n=r.data||[],s=i.chartArea,o=[],a=this._drawStart||0,l=this._drawCount||n.length-a,c=this.options.drawActiveElementsOnTop;let u;for(r.dataset&&r.dataset.draw(e,s,a,l),u=a;u<a+l;++u){const h=n[u];h.hidden||(h.active&&c?o.push(h):h.draw(e,s))}for(u=0;u<o.length;++u)o[u].draw(e,s)}getStyle(e,i){const r=i?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(r):this.resolveDataElementOptions(e||0,r)}getContext(e,i,r){const n=this.getDataset();let s;if(e>=0&&e<this._cachedMeta.data.length){const o=this._cachedMeta.data[e];s=o.$context||(o.$context=Kut(this.getContext(),e,o)),s.parsed=this.getParsed(e),s.raw=n.data[e],s.index=s.dataIndex=e}else s=this.$context||(this.$context=Yut(this.chart.getContext(),this.index)),s.dataset=n,s.index=s.datasetIndex=this.index;return s.active=!!i,s.mode=r,s}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,i){return this._resolveElementOptions(this.dataElementType.id,i,e)}_resolveElementOptions(e,i="default",r){const n=i==="active",s=this._cachedDataOpts,o=e+"-"+i,a=s[o],l=this.enableOptionSharing&&jT(r);if(a)return pie(a,l);const c=this.chart.config,u=c.datasetElementScopeKeys(this._type,e),h=n?[`${e}Hover`,"hover",e,""]:[e,""],f=c.getOptionScopes(this.getDataset(),u),m=Object.keys(qr.elements[e]),g=()=>this.getContext(r,n,i),y=c.resolveNamedOptions(f,m,g,h);return y.$shared&&(y.$shared=l,s[o]=Object.freeze(pie(y,l))),y}_resolveAnimations(e,i,r){const n=this.chart,s=this._cachedDataOpts,o=`animation-${i}`,a=s[o];if(a)return a;let l;if(n.options.animation!==!1){const u=this.chart.config,h=u.datasetAnimationScopeKeys(this._type,i),f=u.getOptionScopes(this.getDataset(),h);l=u.createResolver(f,this.getContext(e,r,i))}const c=new twe(n,l&&l.animations);return l&&l._cacheable&&(s[o]=Object.freeze(c)),c}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,i){return!i||lD(e)||this.chart._animationsDisabled}_getSharedOptions(e,i){const r=this.resolveDataElementOptions(e,i),n=this._sharedOptions,s=this.getSharedOptions(r),o=this.includeOptions(i,s)||s!==n;return this.updateSharedOptions(s,i,r),{sharedOptions:s,includeOptions:o}}updateElement(e,i,r,n){lD(n)?Object.assign(e,r):this._resolveAnimations(i,n).update(e,r)}updateSharedOptions(e,i,r){e&&!lD(i)&&this._resolveAnimations(void 0,i).update(e,r)}_setStyle(e,i,r,n){e.active=n;const s=this.getStyle(i,n);this._resolveAnimations(i,r,n).update(e,{options:!n&&this.getSharedOptions(s)||s})}removeHoverStyle(e,i,r){this._setStyle(e,r,"active",!1)}setHoverStyle(e,i,r){this._setStyle(e,r,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const i=this._data,r=this._cachedMeta.data;for(const[a,l,c]of this._syncList)this[a](l,c);this._syncList=[];const n=r.length,s=i.length,o=Math.min(s,n);o&&this.parse(0,o),s>n?this._insertElements(n,s-n,e):s<n&&this._removeElements(s,n-s)}_insertElements(e,i,r=!0){const n=this._cachedMeta,s=n.data,o=e+i;let a;const l=c=>{for(c.length+=i,a=c.length-1;a>=o;a--)c[a]=c[a-i]};for(l(s),a=e;a<o;++a)s[a]=new this.dataElementType;this._parsing&&l(n._parsed),this.parse(e,i),r&&this.updateElements(s,e,i,"reset")}updateElements(e,i,r,n){}_removeElements(e,i){const r=this._cachedMeta;if(this._parsing){const n=r._parsed.splice(e,i);r._stacked&&cS(r,n)}r.data.splice(e,i)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[i,r,n]=e;this[i](r,n)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,i){i&&this._sync(["_removeElements",e,i]);const r=arguments.length-2;r&&this._sync(["_insertElements",e,r])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}we(xu,"defaults",{}),we(xu,"datasetElementType",null),we(xu,"dataElementType",null);function Qut(t,e){if(!t._cache.$bar){const i=t.getMatchingVisibleMetas(e);let r=[];for(let n=0,s=i.length;n<s;n++)r=r.concat(i[n].controller.getAllParsedValues(t));t._cache.$bar=Rbe(r.sort((n,s)=>n-s))}return t._cache.$bar}function edt(t){const e=t.iScale,i=Qut(e,t.type);let r=e._length,n,s,o,a;const l=()=>{o===32767||o===-32768||(jT(a)&&(r=Math.min(r,Math.abs(o-a)||r)),a=o)};for(n=0,s=i.length;n<s;++n)o=e.getPixelForValue(i[n]),l();for(a=void 0,n=0,s=e.ticks.length;n<s;++n)o=e.getPixelForTick(n),l();return r}function tdt(t,e,i,r){const n=i.barThickness;let s,o;return ei(n)?(s=e.min*i.categoryPercentage,o=i.barPercentage):(s=n*r,o=1),{chunk:s/r,ratio:o,start:e.pixels[t]-s/2}}function idt(t,e,i,r){const n=e.pixels,s=n[t];let o=t>0?n[t-1]:null,a=t<n.length-1?n[t+1]:null;const l=i.categoryPercentage;o===null&&(o=s-(a===null?e.end-e.start:a-s)),a===null&&(a=s+s-o);const c=s-(s-Math.min(o,a))/2*l;return{chunk:Math.abs(a-o)/2*l/r,ratio:i.barPercentage,start:c}}function rdt(t,e,i,r){const n=i.parse(t[0],r),s=i.parse(t[1],r),o=Math.min(n,s),a=Math.max(n,s);let l=o,c=a;Math.abs(o)>Math.abs(a)&&(l=a,c=o),e[i.axis]=c,e._custom={barStart:l,barEnd:c,start:n,end:s,min:o,max:a}}function rwe(t,e,i,r){return sr(t)?rdt(t,e,i,r):e[i.axis]=i.parse(t,r),e}function fie(t,e,i,r){const n=t.iScale,s=t.vScale,o=n.getLabels(),a=n===s,l=[];let c,u,h,f;for(c=i,u=i+r;c<u;++c)f=e[c],h={},h[n.axis]=a||n.parse(o[c],c),l.push(rwe(f,h,s,c));return l}function cD(t){return t&&t.barStart!==void 0&&t.barEnd!==void 0}function ndt(t,e,i){return t!==0?sc(t):(e.isHorizontal()?1:-1)*(e.min>=i?1:-1)}function sdt(t){let e,i,r,n,s;return t.horizontal?(e=t.base>t.x,i="left",r="right"):(e=t.base<t.y,i="bottom",r="top"),e?(n="end",s="start"):(n="start",s="end"),{start:i,end:r,reverse:e,top:n,bottom:s}}function odt(t,e,i,r){let n=e.borderSkipped;const s={};if(!n){t.borderSkipped=s;return}if(n===!0){t.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:o,end:a,reverse:l,top:c,bottom:u}=sdt(t);n==="middle"&&i&&(t.enableBorderRadius=!0,(i._top||0)===r?n=c:(i._bottom||0)===r?n=u:(s[mie(u,o,a,l)]=!0,n=c)),s[mie(n,o,a,l)]=!0,t.borderSkipped=s}function mie(t,e,i,r){return r?(t=adt(t,e,i),t=gie(t,i,e)):t=gie(t,e,i),t}function adt(t,e,i){return t===e?i:t===i?e:t}function gie(t,e,i){return t==="start"?e:t==="end"?i:t}function ldt(t,{inflateAmount:e},i){t.inflateAmount=e==="auto"?i===1?.33:0:e}class dk extends xu{parsePrimitiveData(e,i,r,n){return fie(e,i,r,n)}parseArrayData(e,i,r,n){return fie(e,i,r,n)}parseObjectData(e,i,r,n){const{iScale:s,vScale:o}=e,{xAxisKey:a="x",yAxisKey:l="y"}=this._parsing,c=s.axis==="x"?a:l,u=o.axis==="x"?a:l,h=[];let f,m,g,y;for(f=r,m=r+n;f<m;++f)y=i[f],g={},g[s.axis]=s.parse(gg(y,c),f),h.push(rwe(gg(y,u),g,o,f));return h}updateRangeFromParsed(e,i,r,n){super.updateRangeFromParsed(e,i,r,n);const s=r._custom;s&&i===this._cachedMeta.vScale&&(e.min=Math.min(e.min,s.min),e.max=Math.max(e.max,s.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const i=this._cachedMeta,{iScale:r,vScale:n}=i,s=this.getParsed(e),o=s._custom,a=cD(o)?"["+o.start+", "+o.end+"]":""+n.getLabelForValue(s[n.axis]);return{label:""+r.getLabelForValue(s[r.axis]),value:a}}initialize(){this.enableOptionSharing=!0,super.initialize();const e=this._cachedMeta;e.stack=this.getDataset().stack}update(e){const i=this._cachedMeta;this.updateElements(i.data,0,i.data.length,e)}updateElements(e,i,r,n){const s=n==="reset",{index:o,_cachedMeta:{vScale:a}}=this,l=a.getBasePixel(),c=a.isHorizontal(),u=this._getRuler(),{sharedOptions:h,includeOptions:f}=this._getSharedOptions(i,n);for(let m=i;m<i+r;m++){const g=this.getParsed(m),y=s||ei(g[a.axis])?{base:l,head:l}:this._calculateBarValuePixels(m),v=this._calculateBarIndexPixels(m,u),b=(g._stacks||{})[a.axis],w={horizontal:c,base:y.base,enableBorderRadius:!b||cD(g._custom)||o===b._top||o===b._bottom,x:c?y.head:v.center,y:c?v.center:y.head,height:c?v.size:Math.abs(y.size),width:c?Math.abs(y.size):v.size};f&&(w.options=h||this.resolveDataElementOptions(m,e[m].active?"active":n));const x=w.options||e[m].options;odt(w,x,b,o),ldt(w,x,u.ratio),this.updateElement(e[m],m,w,n)}}_getStacks(e,i){const{iScale:r}=this._cachedMeta,n=r.getMatchingVisibleMetas(this._type).filter(l=>l.controller.options.grouped),s=r.options.stacked,o=[],a=l=>{const c=l.controller.getParsed(i),u=c&&c[l.vScale.axis];if(ei(u)||isNaN(u))return!0};for(const l of n)if(!(i!==void 0&&a(l))&&((s===!1||o.indexOf(l.stack)===-1||s===void 0&&l.stack===void 0)&&o.push(l.stack),l.index===e))break;return o.length||o.push(void 0),o}_getStackCount(e){return this._getStacks(void 0,e).length}_getStackIndex(e,i,r){const n=this._getStacks(e,r),s=i!==void 0?n.indexOf(i):-1;return s===-1?n.length-1:s}_getRuler(){const e=this.options,i=this._cachedMeta,r=i.iScale,n=[];let s,o;for(s=0,o=i.data.length;s<o;++s)n.push(r.getPixelForValue(this.getParsed(s)[r.axis],s));const a=e.barThickness;return{min:a||edt(i),pixels:n,start:r._startPixel,end:r._endPixel,stackCount:this._getStackCount(),scale:r,grouped:e.grouped,ratio:a?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:i,_stacked:r,index:n},options:{base:s,minBarLength:o}}=this,a=s||0,l=this.getParsed(e),c=l._custom,u=cD(c);let h=l[i.axis],f=0,m=r?this.applyStack(i,l,r):h,g,y;m!==h&&(f=m-h,m=h),u&&(h=c.barStart,m=c.barEnd-c.barStart,h!==0&&sc(h)!==sc(c.barEnd)&&(f=0),f+=h);const v=!ei(s)&&!u?s:f;let b=i.getPixelForValue(v);if(this.chart.getDataVisibility(e)?g=i.getPixelForValue(f+m):g=b,y=g-b,Math.abs(y)<o){y=ndt(y,i,a)*o,h===a&&(b-=y/2);const w=i.getPixelForDecimal(0),x=i.getPixelForDecimal(1),S=Math.min(w,x),I=Math.max(w,x);b=Math.max(Math.min(b,I),S),g=b+y,r&&!u&&(l._stacks[i.axis]._visualValues[n]=i.getValueForPixel(g)-i.getValueForPixel(b))}if(b===i.getPixelForValue(a)){const w=sc(y)*i.getLineWidthForValue(a)/2;b+=w,y-=w}return{size:y,base:b,head:g,center:g+y/2}}_calculateBarIndexPixels(e,i){const r=i.scale,n=this.options,s=n.skipNull,o=ot(n.maxBarThickness,1/0);let a,l;if(i.grouped){const c=s?this._getStackCount(e):i.stackCount,u=n.barThickness==="flex"?idt(e,i,n,c):tdt(e,i,n,c),h=this._getStackIndex(this.index,this._cachedMeta.stack,s?e:void 0);a=u.start+u.chunk*h+u.chunk/2,l=Math.min(o,u.chunk*u.ratio)}else a=r.getPixelForValue(this.getParsed(e)[r.axis],e),l=Math.min(o,i.min*i.ratio);return{base:a-l/2,head:a+l/2,center:a,size:l}}draw(){const e=this._cachedMeta,i=e.vScale,r=e.data,n=r.length;let s=0;for(;s<n;++s)this.getParsed(s)[i.axis]!==null&&r[s].draw(this._ctx)}}we(dk,"id","bar"),we(dk,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),we(dk,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});class hk extends xu{initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(e,i,r,n){const s=super.parsePrimitiveData(e,i,r,n);for(let o=0;o<s.length;o++)s[o]._custom=this.resolveDataElementOptions(o+r).radius;return s}parseArrayData(e,i,r,n){const s=super.parseArrayData(e,i,r,n);for(let o=0;o<s.length;o++){const a=i[r+o];s[o]._custom=ot(a[2],this.resolveDataElementOptions(o+r).radius)}return s}parseObjectData(e,i,r,n){const s=super.parseObjectData(e,i,r,n);for(let o=0;o<s.length;o++){const a=i[r+o];s[o]._custom=ot(a&&a.r&&+a.r,this.resolveDataElementOptions(o+r).radius)}return s}getMaxOverflow(){const e=this._cachedMeta.data;let i=0;for(let r=e.length-1;r>=0;--r)i=Math.max(i,e[r].size(this.resolveDataElementOptions(r))/2);return i>0&&i}getLabelAndValue(e){const i=this._cachedMeta,r=this.chart.data.labels||[],{xScale:n,yScale:s}=i,o=this.getParsed(e),a=n.getLabelForValue(o.x),l=s.getLabelForValue(o.y),c=o._custom;return{label:r[e]||"",value:"("+a+", "+l+(c?", "+c:"")+")"}}update(e){const i=this._cachedMeta.data;this.updateElements(i,0,i.length,e)}updateElements(e,i,r,n){const s=n==="reset",{iScale:o,vScale:a}=this._cachedMeta,{sharedOptions:l,includeOptions:c}=this._getSharedOptions(i,n),u=o.axis,h=a.axis;for(let f=i;f<i+r;f++){const m=e[f],g=!s&&this.getParsed(f),y={},v=y[u]=s?o.getPixelForDecimal(.5):o.getPixelForValue(g[u]),b=y[h]=s?a.getBasePixel():a.getPixelForValue(g[h]);y.skip=isNaN(v)||isNaN(b),c&&(y.options=l||this.resolveDataElementOptions(f,m.active?"active":n),s&&(y.options.radius=0)),this.updateElement(m,f,y,n)}}resolveDataElementOptions(e,i){const r=this.getParsed(e);let n=super.resolveDataElementOptions(e,i);n.$shared&&(n=Object.assign({},n,{$shared:!1}));const s=n.radius;return i!=="active"&&(n.radius=0),n.radius+=ot(r&&r._custom,s),n}}we(hk,"id","bubble"),we(hk,"defaults",{datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}}),we(hk,"overrides",{scales:{x:{type:"linear"},y:{type:"linear"}}});function cdt(t,e,i){let r=1,n=1,s=0,o=0;if(e<ar){const a=t,l=a+e,c=Math.cos(a),u=Math.sin(a),h=Math.cos(l),f=Math.sin(l),m=(x,S,I)=>BT(x,a,l,!0)?1:Math.max(S,S*i,I,I*i),g=(x,S,I)=>BT(x,a,l,!0)?-1:Math.min(S,S*i,I,I*i),y=m(0,c,h),v=m(Hr,u,f),b=g(Tr,c,h),w=g(Tr+Hr,u,f);r=(y-b)/2,n=(v-w)/2,s=-(y+b)/2,o=-(v+w)/2}return{ratioX:r,ratioY:n,offsetX:s,offsetY:o}}class K0 extends xu{constructor(e,i){super(e,i),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,i){const r=this.getDataset().data,n=this._cachedMeta;if(this._parsing===!1)n._parsed=r;else{let s=l=>+r[l];if(Ft(r[e])){const{key:l="value"}=this._parsing;s=c=>+gg(r[c],l)}let o,a;for(o=e,a=e+i;o<a;++o)n._parsed[o]=s(o)}}_getRotation(){return mu(this.options.rotation-90)}_getCircumference(){return mu(this.options.circumference)}_getRotationExtents(){let e=ar,i=-ar;for(let r=0;r<this.chart.data.datasets.length;++r)if(this.chart.isDatasetVisible(r)&&this.chart.getDatasetMeta(r).type===this._type){const n=this.chart.getDatasetMeta(r).controller,s=n._getRotation(),o=n._getCircumference();e=Math.min(e,s),i=Math.max(i,s+o)}return{rotation:e,circumference:i-e}}update(e){const i=this.chart,{chartArea:r}=i,n=this._cachedMeta,s=n.data,o=this.getMaxBorderWidth()+this.getMaxOffset(s)+this.options.spacing,a=Math.max((Math.min(r.width,r.height)-o)/2,0),l=Math.min(Sct(this.options.cutout,a),1),c=this._getRingWeight(this.index),{circumference:u,rotation:h}=this._getRotationExtents(),{ratioX:f,ratioY:m,offsetX:g,offsetY:y}=cdt(h,u,l),v=(r.width-o)/f,b=(r.height-o)/m,w=Math.max(Math.min(v,b)/2,0),x=Abe(this.options.radius,w),S=Math.max(x*l,0),I=(x-S)/this._getVisibleDatasetWeightTotal();this.offsetX=g*x,this.offsetY=y*x,n.total=this.calculateTotal(),this.outerRadius=x-I*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-I*c,0),this.updateElements(s,0,s.length,e)}_circumference(e,i){const r=this.options,n=this._cachedMeta,s=this._getCircumference();return i&&r.animation.animateRotate||!this.chart.getDataVisibility(e)||n._parsed[e]===null||n.data[e].hidden?0:this.calculateCircumference(n._parsed[e]*s/ar)}updateElements(e,i,r,n){const s=n==="reset",o=this.chart,a=o.chartArea,c=o.options.animation,u=(a.left+a.right)/2,h=(a.top+a.bottom)/2,f=s&&c.animateScale,m=f?0:this.innerRadius,g=f?0:this.outerRadius,{sharedOptions:y,includeOptions:v}=this._getSharedOptions(i,n);let b=this._getRotation(),w;for(w=0;w<i;++w)b+=this._circumference(w,s);for(w=i;w<i+r;++w){const x=this._circumference(w,s),S=e[w],I={x:u+this.offsetX,y:h+this.offsetY,startAngle:b,endAngle:b+x,circumference:x,outerRadius:g,innerRadius:m};v&&(I.options=y||this.resolveDataElementOptions(w,S.active?"active":n)),b+=x,this.updateElement(S,w,I,n)}}calculateTotal(){const e=this._cachedMeta,i=e.data;let r=0,n;for(n=0;n<i.length;n++){const s=e._parsed[n];s!==null&&!isNaN(s)&&this.chart.getDataVisibility(n)&&!i[n].hidden&&(r+=Math.abs(s))}return r}calculateCircumference(e){const i=this._cachedMeta.total;return i>0&&!isNaN(e)?ar*(Math.abs(e)/i):0}getLabelAndValue(e){const i=this._cachedMeta,r=this.chart,n=r.data.labels||[],s=tE(i._parsed[e],r.options.locale);return{label:n[e]||"",value:s}}getMaxBorderWidth(e){let i=0;const r=this.chart;let n,s,o,a,l;if(!e){for(n=0,s=r.data.datasets.length;n<s;++n)if(r.isDatasetVisible(n)){o=r.getDatasetMeta(n),e=o.data,a=o.controller;break}}if(!e)return 0;for(n=0,s=e.length;n<s;++n)l=a.resolveDataElementOptions(n),l.borderAlign!=="inner"&&(i=Math.max(i,l.borderWidth||0,l.hoverBorderWidth||0));return i}getMaxOffset(e){let i=0;for(let r=0,n=e.length;r<n;++r){const s=this.resolveDataElementOptions(r);i=Math.max(i,s.offset||0,s.hoverOffset||0)}return i}_getRingWeightOffset(e){let i=0;for(let r=0;r<e;++r)this.chart.isDatasetVisible(r)&&(i+=this._getRingWeight(r));return i}_getRingWeight(e){return Math.max(ot(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}we(K0,"id","doughnut"),we(K0,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),we(K0,"descriptors",{_scriptable:e=>e!=="spacing",_indexable:e=>e!=="spacing"&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")}),we(K0,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const i=e.data;if(i.labels.length&&i.datasets.length){const{labels:{pointStyle:r,color:n}}=e.legend.options;return i.labels.map((s,o)=>{const l=e.getDatasetMeta(0).controller.getStyle(o);return{text:s,fillStyle:l.backgroundColor,strokeStyle:l.borderColor,fontColor:n,lineWidth:l.borderWidth,pointStyle:r,hidden:!e.getDataVisibility(o),index:o}})}return[]}},onClick(e,i,r){r.chart.toggleDataVisibility(i.index),r.chart.update()}}}});class pk extends xu{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const i=this._cachedMeta,{dataset:r,data:n=[],_dataset:s}=i,o=this.chart._animationsDisabled;let{start:a,count:l}=Nbe(i,n,o);this._drawStart=a,this._drawCount=l,Vbe(i)&&(a=0,l=n.length),r._chart=this.chart,r._datasetIndex=this.index,r._decimated=!!s._decimated,r.points=n;const c=this.resolveDatasetElementOptions(e);this.options.showLine||(c.borderWidth=0),c.segment=this.options.segment,this.updateElement(r,void 0,{animated:!o,options:c},e),this.updateElements(n,a,l,e)}updateElements(e,i,r,n){const s=n==="reset",{iScale:o,vScale:a,_stacked:l,_dataset:c}=this._cachedMeta,{sharedOptions:u,includeOptions:h}=this._getSharedOptions(i,n),f=o.axis,m=a.axis,{spanGaps:g,segment:y}=this.options,v=$1(g)?g:Number.POSITIVE_INFINITY,b=this.chart._animationsDisabled||s||n==="none",w=i+r,x=e.length;let S=i>0&&this.getParsed(i-1);for(let I=0;I<x;++I){const T=e[I],C=b?T:{};if(I<i||I>=w){C.skip=!0;continue}const E=this.getParsed(I),$=ei(E[m]),P=C[f]=o.getPixelForValue(E[f],I),k=C[m]=s||$?a.getBasePixel():a.getPixelForValue(l?this.applyStack(a,E,l):E[m],I);C.skip=isNaN(P)||isNaN(k)||$,C.stop=I>0&&Math.abs(E[f]-S[f])>v,y&&(C.parsed=E,C.raw=c.data[I]),h&&(C.options=u||this.resolveDataElementOptions(I,T.active?"active":n)),b||this.updateElement(T,I,C,n),S=E}}getMaxOverflow(){const e=this._cachedMeta,i=e.dataset,r=i.options&&i.options.borderWidth||0,n=e.data||[];if(!n.length)return r;const s=n[0].size(this.resolveDataElementOptions(0)),o=n[n.length-1].size(this.resolveDataElementOptions(n.length-1));return Math.max(r,s,o)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}we(pk,"id","line"),we(pk,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),we(pk,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});class RI extends xu{constructor(e,i){super(e,i),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(e){const i=this._cachedMeta,r=this.chart,n=r.data.labels||[],s=tE(i._parsed[e].r,r.options.locale);return{label:n[e]||"",value:s}}parseObjectData(e,i,r,n){return Wbe.bind(this)(e,i,r,n)}update(e){const i=this._cachedMeta.data;this._updateRadius(),this.updateElements(i,0,i.length,e)}getMinMax(){const e=this._cachedMeta,i={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return e.data.forEach((r,n)=>{const s=this.getParsed(n).r;!isNaN(s)&&this.chart.getDataVisibility(n)&&(s<i.min&&(i.min=s),s>i.max&&(i.max=s))}),i}_updateRadius(){const e=this.chart,i=e.chartArea,r=e.options,n=Math.min(i.right-i.left,i.bottom-i.top),s=Math.max(n/2,0),o=Math.max(r.cutoutPercentage?s/100*r.cutoutPercentage:1,0),a=(s-o)/e.getVisibleDatasetCount();this.outerRadius=s-a*this.index,this.innerRadius=this.outerRadius-a}updateElements(e,i,r,n){const s=n==="reset",o=this.chart,l=o.options.animation,c=this._cachedMeta.rScale,u=c.xCenter,h=c.yCenter,f=c.getIndexAngle(0)-.5*Tr;let m=f,g;const y=360/this.countVisibleElements();for(g=0;g<i;++g)m+=this._computeAngle(g,n,y);for(g=i;g<i+r;g++){const v=e[g];let b=m,w=m+this._computeAngle(g,n,y),x=o.getDataVisibility(g)?c.getDistanceFromCenterForValue(this.getParsed(g).r):0;m=w,s&&(l.animateScale&&(x=0),l.animateRotate&&(b=w=f));const S={x:u,y:h,innerRadius:0,outerRadius:x,startAngle:b,endAngle:w,options:this.resolveDataElementOptions(g,v.active?"active":n)};this.updateElement(v,g,S,n)}}countVisibleElements(){const e=this._cachedMeta;let i=0;return e.data.forEach((r,n)=>{!isNaN(this.getParsed(n).r)&&this.chart.getDataVisibility(n)&&i++}),i}_computeAngle(e,i,r){return this.chart.getDataVisibility(e)?mu(this.resolveDataElementOptions(e,i).angle||r):0}}we(RI,"id","polarArea"),we(RI,"defaults",{dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0}),we(RI,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const i=e.data;if(i.labels.length&&i.datasets.length){const{labels:{pointStyle:r,color:n}}=e.legend.options;return i.labels.map((s,o)=>{const l=e.getDatasetMeta(0).controller.getStyle(o);return{text:s,fillStyle:l.backgroundColor,strokeStyle:l.borderColor,fontColor:n,lineWidth:l.borderWidth,pointStyle:r,hidden:!e.getDataVisibility(o),index:o}})}return[]}},onClick(e,i,r){r.chart.toggleDataVisibility(i.index),r.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}});class b6 extends K0{}we(b6,"id","pie"),we(b6,"defaults",{cutout:0,rotation:0,circumference:360,radius:"100%"});class fk extends xu{getLabelAndValue(e){const i=this._cachedMeta.vScale,r=this.getParsed(e);return{label:i.getLabels()[e],value:""+i.getLabelForValue(r[i.axis])}}parseObjectData(e,i,r,n){return Wbe.bind(this)(e,i,r,n)}update(e){const i=this._cachedMeta,r=i.dataset,n=i.data||[],s=i.iScale.getLabels();if(r.points=n,e!=="resize"){const o=this.resolveDatasetElementOptions(e);this.options.showLine||(o.borderWidth=0);const a={_loop:!0,_fullLoop:s.length===n.length,options:o};this.updateElement(r,void 0,a,e)}this.updateElements(n,0,n.length,e)}updateElements(e,i,r,n){const s=this._cachedMeta.rScale,o=n==="reset";for(let a=i;a<i+r;a++){const l=e[a],c=this.resolveDataElementOptions(a,l.active?"active":n),u=s.getPointPositionForValue(a,this.getParsed(a).r),h=o?s.xCenter:u.x,f=o?s.yCenter:u.y,m={x:h,y:f,angle:u.angle,skip:isNaN(h)||isNaN(f),options:c};this.updateElement(l,a,m,n)}}}we(fk,"id","radar"),we(fk,"defaults",{datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}}),we(fk,"overrides",{aspectRatio:1,scales:{r:{type:"radialLinear"}}});class mk extends xu{getLabelAndValue(e){const i=this._cachedMeta,r=this.chart.data.labels||[],{xScale:n,yScale:s}=i,o=this.getParsed(e),a=n.getLabelForValue(o.x),l=s.getLabelForValue(o.y);return{label:r[e]||"",value:"("+a+", "+l+")"}}update(e){const i=this._cachedMeta,{data:r=[]}=i,n=this.chart._animationsDisabled;let{start:s,count:o}=Nbe(i,r,n);if(this._drawStart=s,this._drawCount=o,Vbe(i)&&(s=0,o=r.length),this.options.showLine){const{dataset:a,_dataset:l}=i;a._chart=this.chart,a._datasetIndex=this.index,a._decimated=!!l._decimated,a.points=r;const c=this.resolveDatasetElementOptions(e);c.segment=this.options.segment,this.updateElement(a,void 0,{animated:!n,options:c},e)}this.updateElements(r,s,o,e)}addElements(){const{showLine:e}=this.options;!this.datasetElementType&&e&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(e,i,r,n){const s=n==="reset",{iScale:o,vScale:a,_stacked:l,_dataset:c}=this._cachedMeta,u=this.resolveDataElementOptions(i,n),h=this.getSharedOptions(u),f=this.includeOptions(n,h),m=o.axis,g=a.axis,{spanGaps:y,segment:v}=this.options,b=$1(y)?y:Number.POSITIVE_INFINITY,w=this.chart._animationsDisabled||s||n==="none";let x=i>0&&this.getParsed(i-1);for(let S=i;S<i+r;++S){const I=e[S],T=this.getParsed(S),C=w?I:{},E=ei(T[g]),$=C[m]=o.getPixelForValue(T[m],S),P=C[g]=s||E?a.getBasePixel():a.getPixelForValue(l?this.applyStack(a,T,l):T[g],S);C.skip=isNaN($)||isNaN(P)||E,C.stop=S>0&&Math.abs(T[m]-x[m])>b,v&&(C.parsed=T,C.raw=c.data[S]),f&&(C.options=h||this.resolveDataElementOptions(S,I.active?"active":n)),w||this.updateElement(I,S,C,n),x=T}this.updateSharedOptions(h,n,u)}getMaxOverflow(){const e=this._cachedMeta,i=e.data||[];if(!this.options.showLine){let a=0;for(let l=i.length-1;l>=0;--l)a=Math.max(a,i[l].size(this.resolveDataElementOptions(l))/2);return a>0&&a}const r=e.dataset,n=r.options&&r.options.borderWidth||0;if(!i.length)return n;const s=i[0].size(this.resolveDataElementOptions(0)),o=i[i.length-1].size(this.resolveDataElementOptions(i.length-1));return Math.max(n,s,o)/2}}we(mk,"id","scatter"),we(mk,"defaults",{datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1}),we(mk,"overrides",{interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}});var udt=Object.freeze({__proto__:null,BarController:dk,BubbleController:hk,DoughnutController:K0,LineController:pk,PieController:b6,PolarAreaController:RI,RadarController:fk,ScatterController:mk});function ny(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class dH{constructor(e){we(this,"options");this.options=e||{}}static override(e){Object.assign(dH.prototype,e)}init(){}formats(){return ny()}parse(){return ny()}format(){return ny()}add(){return ny()}diff(){return ny()}startOf(){return ny()}endOf(){return ny()}}var ddt={_date:dH};function hdt(t,e,i,r){const{controller:n,data:s,_sorted:o}=t,a=n._cachedMeta.iScale;if(a&&e===a.axis&&e!=="r"&&o&&s.length){const l=a._reversePixels?Rct:ep;if(r){if(n._sharedOptions){const c=s[0],u=typeof c.getRange=="function"&&c.getRange(e);if(u){const h=l(s,e,i-u),f=l(s,e,i+u);return{lo:h.lo,hi:f.hi}}}}else return l(s,e,i)}return{lo:0,hi:s.length-1}}function iE(t,e,i,r,n){const s=t.getSortedVisibleDatasetMetas(),o=i[e];for(let a=0,l=s.length;a<l;++a){const{index:c,data:u}=s[a],{lo:h,hi:f}=hdt(s[a],e,o,n);for(let m=h;m<=f;++m){const g=u[m];g.skip||r(g,c,m)}}}function pdt(t){const e=t.indexOf("x")!==-1,i=t.indexOf("y")!==-1;return function(r,n){const s=e?Math.abs(r.x-n.x):0,o=i?Math.abs(r.y-n.y):0;return Math.sqrt(Math.pow(s,2)+Math.pow(o,2))}}function uD(t,e,i,r,n){const s=[];return!n&&!t.isPointInArea(e)||iE(t,i,e,function(a,l,c){!n&&!tp(a,t.chartArea,0)||a.inRange(e.x,e.y,r)&&s.push({element:a,datasetIndex:l,index:c})},!0),s}function fdt(t,e,i,r){let n=[];function s(o,a,l){const{startAngle:c,endAngle:u}=o.getProps(["startAngle","endAngle"],r),{angle:h}=Obe(o,{x:e.x,y:e.y});BT(h,c,u)&&n.push({element:o,datasetIndex:a,index:l})}return iE(t,i,e,s),n}function mdt(t,e,i,r,n,s){let o=[];const a=pdt(i);let l=Number.POSITIVE_INFINITY;function c(u,h,f){const m=u.inRange(e.x,e.y,n);if(r&&!m)return;const g=u.getCenterPoint(n);if(!(!!s||t.isPointInArea(g))&&!m)return;const v=a(e,g);v<l?(o=[{element:u,datasetIndex:h,index:f}],l=v):v===l&&o.push({element:u,datasetIndex:h,index:f})}return iE(t,i,e,c),o}function dD(t,e,i,r,n,s){return!s&&!t.isPointInArea(e)?[]:i==="r"&&!r?fdt(t,e,i,n):mdt(t,e,i,r,n,s)}function yie(t,e,i,r,n){const s=[],o=i==="x"?"inXRange":"inYRange";let a=!1;return iE(t,i,e,(l,c,u)=>{l[o](e[i],n)&&(s.push({element:l,datasetIndex:c,index:u}),a=a||l.inRange(e.x,e.y,n))}),r&&!a?[]:s}var gdt={evaluateInteractionItems:iE,modes:{index(t,e,i,r){const n=bd(e,t),s=i.axis||"x",o=i.includeInvisible||!1,a=i.intersect?uD(t,n,s,r,o):dD(t,n,s,!1,r,o),l=[];return a.length?(t.getSortedVisibleDatasetMetas().forEach(c=>{const u=a[0].index,h=c.data[u];h&&!h.skip&&l.push({element:h,datasetIndex:c.index,index:u})}),l):[]},dataset(t,e,i,r){const n=bd(e,t),s=i.axis||"xy",o=i.includeInvisible||!1;let a=i.intersect?uD(t,n,s,r,o):dD(t,n,s,!1,r,o);if(a.length>0){const l=a[0].datasetIndex,c=t.getDatasetMeta(l).data;a=[];for(let u=0;u<c.length;++u)a.push({element:c[u],datasetIndex:l,index:u})}return a},point(t,e,i,r){const n=bd(e,t),s=i.axis||"xy",o=i.includeInvisible||!1;return uD(t,n,s,r,o)},nearest(t,e,i,r){const n=bd(e,t),s=i.axis||"xy",o=i.includeInvisible||!1;return dD(t,n,s,i.intersect,r,o)},x(t,e,i,r){const n=bd(e,t);return yie(t,n,"x",i.intersect,r)},y(t,e,i,r){const n=bd(e,t);return yie(t,n,"y",i.intersect,r)}}};const nwe=["left","top","right","bottom"];function uS(t,e){return t.filter(i=>i.pos===e)}function vie(t,e){return t.filter(i=>nwe.indexOf(i.pos)===-1&&i.box.axis===e)}function dS(t,e){return t.sort((i,r)=>{const n=e?r:i,s=e?i:r;return n.weight===s.weight?n.index-s.index:n.weight-s.weight})}function ydt(t){const e=[];let i,r,n,s,o,a;for(i=0,r=(t||[]).length;i<r;++i)n=t[i],{position:s,options:{stack:o,stackWeight:a=1}}=n,e.push({index:i,box:n,pos:s,horizontal:n.isHorizontal(),weight:n.weight,stack:o&&s+o,stackWeight:a});return e}function vdt(t){const e={};for(const i of t){const{stack:r,pos:n,stackWeight:s}=i;if(!r||!nwe.includes(n))continue;const o=e[r]||(e[r]={count:0,placed:0,weight:0,size:0});o.count++,o.weight+=s}return e}function _dt(t,e){const i=vdt(t),{vBoxMaxWidth:r,hBoxMaxHeight:n}=e;let s,o,a;for(s=0,o=t.length;s<o;++s){a=t[s];const{fullSize:l}=a.box,c=i[a.stack],u=c&&a.stackWeight/c.weight;a.horizontal?(a.width=u?u*r:l&&e.availableWidth,a.height=n):(a.width=r,a.height=u?u*n:l&&e.availableHeight)}return i}function bdt(t){const e=ydt(t),i=dS(e.filter(c=>c.box.fullSize),!0),r=dS(uS(e,"left"),!0),n=dS(uS(e,"right")),s=dS(uS(e,"top"),!0),o=dS(uS(e,"bottom")),a=vie(e,"x"),l=vie(e,"y");return{fullSize:i,leftAndTop:r.concat(s),rightAndBottom:n.concat(l).concat(o).concat(a),chartArea:uS(e,"chartArea"),vertical:r.concat(n).concat(l),horizontal:s.concat(o).concat(a)}}function _ie(t,e,i,r){return Math.max(t[i],e[i])+Math.max(t[r],e[r])}function swe(t,e){t.top=Math.max(t.top,e.top),t.left=Math.max(t.left,e.left),t.bottom=Math.max(t.bottom,e.bottom),t.right=Math.max(t.right,e.right)}function wdt(t,e,i,r){const{pos:n,box:s}=i,o=t.maxPadding;if(!Ft(n)){i.size&&(t[n]-=i.size);const h=r[i.stack]||{size:0,count:1};h.size=Math.max(h.size,i.horizontal?s.height:s.width),i.size=h.size/h.count,t[n]+=i.size}s.getPadding&&swe(o,s.getPadding());const a=Math.max(0,e.outerWidth-_ie(o,t,"left","right")),l=Math.max(0,e.outerHeight-_ie(o,t,"top","bottom")),c=a!==t.w,u=l!==t.h;return t.w=a,t.h=l,i.horizontal?{same:c,other:u}:{same:u,other:c}}function xdt(t){const e=t.maxPadding;function i(r){const n=Math.max(e[r]-t[r],0);return t[r]+=n,n}t.y+=i("top"),t.x+=i("left"),i("right"),i("bottom")}function Sdt(t,e){const i=e.maxPadding;function r(n){const s={left:0,top:0,right:0,bottom:0};return n.forEach(o=>{s[o]=Math.max(e[o],i[o])}),s}return r(t?["left","right"]:["top","bottom"])}function D2(t,e,i,r){const n=[];let s,o,a,l,c,u;for(s=0,o=t.length,c=0;s<o;++s){a=t[s],l=a.box,l.update(a.width||e.w,a.height||e.h,Sdt(a.horizontal,e));const{same:h,other:f}=wdt(e,i,a,r);c|=h&&n.length,u=u||f,l.fullSize||n.push(a)}return c&&D2(n,e,i,r)||u}function d$(t,e,i,r,n){t.top=i,t.left=e,t.right=e+r,t.bottom=i+n,t.width=r,t.height=n}function bie(t,e,i,r){const n=i.padding;let{x:s,y:o}=e;for(const a of t){const l=a.box,c=r[a.stack]||{count:1,placed:0,weight:1},u=a.stackWeight/c.weight||1;if(a.horizontal){const h=e.w*u,f=c.size||l.height;jT(c.start)&&(o=c.start),l.fullSize?d$(l,n.left,o,i.outerWidth-n.right-n.left,f):d$(l,e.left+c.placed,o,h,f),c.start=o,c.placed+=h,o=l.bottom}else{const h=e.h*u,f=c.size||l.width;jT(c.start)&&(s=c.start),l.fullSize?d$(l,s,n.top,f,i.outerHeight-n.bottom-n.top):d$(l,s,e.top+c.placed,f,h),c.start=s,c.placed+=h,s=l.right}}e.x=s,e.y=o}var ao={addBox(t,e){t.boxes||(t.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(i){e.draw(i)}}]},t.boxes.push(e)},removeBox(t,e){const i=t.boxes?t.boxes.indexOf(e):-1;i!==-1&&t.boxes.splice(i,1)},configure(t,e,i){e.fullSize=i.fullSize,e.position=i.position,e.weight=i.weight},update(t,e,i,r){if(!t)return;const n=fo(t.options.layout.padding),s=Math.max(e-n.width,0),o=Math.max(i-n.height,0),a=bdt(t.boxes),l=a.vertical,c=a.horizontal;Ot(t.boxes,y=>{typeof y.beforeLayout=="function"&&y.beforeLayout()});const u=l.reduce((y,v)=>v.box.options&&v.box.options.display===!1?y:y+1,0)||1,h=Object.freeze({outerWidth:e,outerHeight:i,padding:n,availableWidth:s,availableHeight:o,vBoxMaxWidth:s/2/u,hBoxMaxHeight:o/2}),f=Object.assign({},n);swe(f,fo(r));const m=Object.assign({maxPadding:f,w:s,h:o,x:n.left,y:n.top},n),g=_dt(l.concat(c),h);D2(a.fullSize,m,h,g),D2(l,m,h,g),D2(c,m,h,g)&&D2(l,m,h,g),xdt(m),bie(a.leftAndTop,m,h,g),m.x+=m.w,m.y+=m.h,bie(a.rightAndBottom,m,h,g),t.chartArea={left:m.left,top:m.top,right:m.left+m.w,bottom:m.top+m.h,height:m.h,width:m.w},Ot(a.chartArea,y=>{const v=y.box;Object.assign(v,t.chartArea),v.update(m.w,m.h,{left:0,top:0,right:0,bottom:0})})}};class owe{acquireContext(e,i){}releaseContext(e){return!1}addEventListener(e,i,r){}removeEventListener(e,i,r){}getDevicePixelRatio(){return 1}getMaximumSize(e,i,r,n){return i=Math.max(0,i||e.width),r=r||e.height,{width:i,height:Math.max(0,n?Math.floor(i/n):r)}}isAttached(e){return!0}updateConfig(e){}}class Idt extends owe{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const gk="$chartjs",Tdt={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},wie=t=>t===null||t==="";function Cdt(t,e){const i=t.style,r=t.getAttribute("height"),n=t.getAttribute("width");if(t[gk]={initial:{height:r,width:n,style:{display:i.display,height:i.height,width:i.width}}},i.display=i.display||"block",i.boxSizing=i.boxSizing||"border-box",wie(n)){const s=rie(t,"width");s!==void 0&&(t.width=s)}if(wie(r))if(t.style.height==="")t.height=t.width/(e||2);else{const s=rie(t,"height");s!==void 0&&(t.height=s)}return t}const awe=Mut?{passive:!0}:!1;function Edt(t,e,i){t.addEventListener(e,i,awe)}function Mdt(t,e,i){t.canvas.removeEventListener(e,i,awe)}function $dt(t,e){const i=Tdt[t.type]||t.type,{x:r,y:n}=bd(t,e);return{type:i,chart:e,native:t,x:r!==void 0?r:null,y:n!==void 0?n:null}}function FO(t,e){for(const i of t)if(i===e||i.contains(e))return!0}function Adt(t,e,i){const r=t.canvas,n=new MutationObserver(s=>{let o=!1;for(const a of s)o=o||FO(a.addedNodes,r),o=o&&!FO(a.removedNodes,r);o&&i()});return n.observe(document,{childList:!0,subtree:!0}),n}function kdt(t,e,i){const r=t.canvas,n=new MutationObserver(s=>{let o=!1;for(const a of s)o=o||FO(a.removedNodes,r),o=o&&!FO(a.addedNodes,r);o&&i()});return n.observe(document,{childList:!0,subtree:!0}),n}const GT=new Map;let xie=0;function lwe(){const t=window.devicePixelRatio;t!==xie&&(xie=t,GT.forEach((e,i)=>{i.currentDevicePixelRatio!==t&&e()}))}function Pdt(t,e){GT.size||window.addEventListener("resize",lwe),GT.set(t,e)}function Odt(t){GT.delete(t),GT.size||window.removeEventListener("resize",lwe)}function Ldt(t,e,i){const r=t.canvas,n=r&&uH(r);if(!n)return;const s=Dbe((a,l)=>{const c=n.clientWidth;i(a,l),c<n.clientWidth&&i()},window),o=new ResizeObserver(a=>{const l=a[0],c=l.contentRect.width,u=l.contentRect.height;c===0&&u===0||s(c,u)});return o.observe(n),Pdt(t,s),o}function hD(t,e,i){i&&i.disconnect(),e==="resize"&&Odt(t)}function Rdt(t,e,i){const r=t.canvas,n=Dbe(s=>{t.ctx!==null&&i($dt(s,t))},t);return Edt(r,e,n),n}class Fdt extends owe{acquireContext(e,i){const r=e&&e.getContext&&e.getContext("2d");return r&&r.canvas===e?(Cdt(e,i),r):null}releaseContext(e){const i=e.canvas;if(!i[gk])return!1;const r=i[gk].initial;["height","width"].forEach(s=>{const o=r[s];ei(o)?i.removeAttribute(s):i.setAttribute(s,o)});const n=r.style||{};return Object.keys(n).forEach(s=>{i.style[s]=n[s]}),i.width=i.width,delete i[gk],!0}addEventListener(e,i,r){this.removeEventListener(e,i);const n=e.$proxies||(e.$proxies={}),o={attach:Adt,detach:kdt,resize:Ldt}[i]||Rdt;n[i]=o(e,i,r)}removeEventListener(e,i){const r=e.$proxies||(e.$proxies={}),n=r[i];if(!n)return;({attach:hD,detach:hD,resize:hD}[i]||Mdt)(e,i,n),r[i]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,i,r,n){return Eut(e,i,r,n)}isAttached(e){const i=uH(e);return!!(i&&i.isConnected)}}function Ddt(t){return!Zbe()||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas?Idt:Fdt}var _$;let Lp=(_$=class{constructor(){we(this,"x");we(this,"y");we(this,"active",!1);we(this,"options");we(this,"$animations")}tooltipPosition(e){const{x:i,y:r}=this.getProps(["x","y"],e);return{x:i,y:r}}hasValue(){return $1(this.x)&&$1(this.y)}getProps(e,i){const r=this.$animations;if(!i||!r)return this;const n={};return e.forEach(s=>{n[s]=r[s]&&r[s].active()?r[s]._to:this[s]}),n}},we(_$,"defaults",{}),we(_$,"defaultRoutes"),_$);function Ndt(t,e){const i=t.options.ticks,r=Vdt(t),n=Math.min(i.maxTicksLimit||r,r),s=i.major.enabled?jdt(e):[],o=s.length,a=s[0],l=s[o-1],c=[];if(o>n)return Bdt(e,c,s,o/n),c;const u=zdt(s,e,n);if(o>0){let h,f;const m=o>1?Math.round((l-a)/(o-1)):null;for(h$(e,c,u,ei(m)?0:a-m,a),h=0,f=o-1;h<f;h++)h$(e,c,u,s[h],s[h+1]);return h$(e,c,u,l,ei(m)?e.length:l+m),c}return h$(e,c,u),c}function Vdt(t){const e=t.options.offset,i=t._tickSize(),r=t._length/i+(e?0:1),n=t._maxLength/i;return Math.floor(Math.min(r,n))}function zdt(t,e,i){const r=Udt(t),n=e.length/i;if(!r)return Math.max(n,1);const s=kct(r);for(let o=0,a=s.length-1;o<a;o++){const l=s[o];if(l>n)return l}return Math.max(n,1)}function jdt(t){const e=[];let i,r;for(i=0,r=t.length;i<r;i++)t[i].major&&e.push(i);return e}function Bdt(t,e,i,r){let n=0,s=i[0],o;for(r=Math.ceil(r),o=0;o<t.length;o++)o===s&&(e.push(t[o]),n++,s=i[n*r])}function h$(t,e,i,r,n){const s=ot(r,0),o=Math.min(ot(n,t.length),t.length);let a=0,l,c,u;for(i=Math.ceil(i),n&&(l=n-r,i=l/Math.floor(l/i)),u=s;u<0;)a++,u=Math.round(s+a*i);for(c=Math.max(s,0);c<o;c++)c===u&&(e.push(t[c]),a++,u=Math.round(s+a*i))}function Udt(t){const e=t.length;let i,r;if(e<2)return!1;for(r=t[0],i=1;i<e;++i)if(t[i]-t[i-1]!==r)return!1;return r}const Gdt=t=>t==="left"?"right":t==="right"?"left":t,Sie=(t,e,i)=>e==="top"||e==="left"?t[e]+i:t[e]-i,Iie=(t,e)=>Math.min(e||t,t);function Tie(t,e){const i=[],r=t.length/e,n=t.length;let s=0;for(;s<n;s+=r)i.push(t[Math.floor(s)]);return i}function Hdt(t,e,i){const r=t.ticks.length,n=Math.min(e,r-1),s=t._startPixel,o=t._endPixel,a=1e-6;let l=t.getPixelForTick(n),c;if(!(i&&(r===1?c=Math.max(l-s,o-l):e===0?c=(t.getPixelForTick(1)-l)/2:c=(l-t.getPixelForTick(n-1))/2,l+=n<e?c:-c,l<s-a||l>o+a)))return l}function qdt(t,e){Ot(t,i=>{const r=i.gc,n=r.length/2;let s;if(n>e){for(s=0;s<n;++s)delete i.data[r[s]];r.splice(0,n)}})}function hS(t){return t.drawTicks?t.tickLength:0}function Cie(t,e){if(!t.display)return 0;const i=Jn(t.font,e),r=fo(t.padding);return(sr(t.text)?t.text.length:1)*i.lineHeight+r.height}function Wdt(t,e){return Pg(t,{scale:e,type:"scale"})}function Jdt(t,e,i){return Pg(t,{tick:i,index:e,type:"tick"})}function Zdt(t,e,i){let r=nH(t);return(i&&e!=="right"||!i&&e==="right")&&(r=Gdt(r)),r}function Ydt(t,e,i,r){const{top:n,left:s,bottom:o,right:a,chart:l}=t,{chartArea:c,scales:u}=l;let h=0,f,m,g;const y=o-n,v=a-s;if(t.isHorizontal()){if(m=eo(r,s,a),Ft(i)){const b=Object.keys(i)[0],w=i[b];g=u[b].getPixelForValue(w)+y-e}else i==="center"?g=(c.bottom+c.top)/2+y-e:g=Sie(t,i,e);f=a-s}else{if(Ft(i)){const b=Object.keys(i)[0],w=i[b];m=u[b].getPixelForValue(w)-v+e}else i==="center"?m=(c.left+c.right)/2-v+e:m=Sie(t,i,e);g=eo(r,o,n),h=i==="left"?-Hr:Hr}return{titleX:m,titleY:g,maxWidth:f,rotation:h}}class i_ extends Lp{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,i){return e}getUserBounds(){let{_userMin:e,_userMax:i,_suggestedMin:r,_suggestedMax:n}=this;return e=Wa(e,Number.POSITIVE_INFINITY),i=Wa(i,Number.NEGATIVE_INFINITY),r=Wa(r,Number.POSITIVE_INFINITY),n=Wa(n,Number.NEGATIVE_INFINITY),{min:Wa(e,r),max:Wa(i,n),minDefined:Gr(e),maxDefined:Gr(i)}}getMinMax(e){let{min:i,max:r,minDefined:n,maxDefined:s}=this.getUserBounds(),o;if(n&&s)return{min:i,max:r};const a=this.getMatchingVisibleMetas();for(let l=0,c=a.length;l<c;++l)o=a[l].controller.getMinMax(this,e),n||(i=Math.min(i,o.min)),s||(r=Math.max(r,o.max));return i=s&&i>r?r:i,r=n&&i>r?i:r,{min:Wa(i,Wa(r,i)),max:Wa(r,Wa(i,r))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){ct(this.options.beforeUpdate,[this])}update(e,i,r){const{beginAtZero:n,grace:s,ticks:o}=this.options,a=o.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=i,this._margins=r=Object.assign({left:0,right:0,top:0,bottom:0},r),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+r.left+r.right:this.height+r.top+r.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=sut(this,s,n),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const l=a<this.ticks.length;this._convertTicksToLabels(l?Tie(this.ticks,a):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||o.source==="auto")&&(this.ticks=Ndt(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),l&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,i,r;this.isHorizontal()?(i=this.left,r=this.right):(i=this.top,r=this.bottom,e=!e),this._startPixel=i,this._endPixel=r,this._reversePixels=e,this._length=r-i,this._alignToPixels=this.options.alignToPixels}afterUpdate(){ct(this.options.afterUpdate,[this])}beforeSetDimensions(){ct(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){ct(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),ct(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){ct(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const i=this.options.ticks;let r,n,s;for(r=0,n=e.length;r<n;r++)s=e[r],s.label=ct(i.callback,[s.value,r,e],this)}afterTickToLabelConversion(){ct(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){ct(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,i=e.ticks,r=Iie(this.ticks.length,e.ticks.maxTicksLimit),n=i.minRotation||0,s=i.maxRotation;let o=n,a,l,c;if(!this._isVisible()||!i.display||n>=s||r<=1||!this.isHorizontal()){this.labelRotation=n;return}const u=this._getLabelSizes(),h=u.widest.width,f=u.highest.height,m=fs(this.chart.width-h,0,this.maxWidth);a=e.offset?this.maxWidth/r:m/(r-1),h+6>a&&(a=m/(r-(e.offset?.5:1)),l=this.maxHeight-hS(e.grid)-i.padding-Cie(e.title,this.chart.options.font),c=Math.sqrt(h*h+f*f),o=iH(Math.min(Math.asin(fs((u.highest.height+6)/a,-1,1)),Math.asin(fs(l/c,-1,1))-Math.asin(fs(f/c,-1,1)))),o=Math.max(n,Math.min(s,o))),this.labelRotation=o}afterCalculateLabelRotation(){ct(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){ct(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:i,options:{ticks:r,title:n,grid:s}}=this,o=this._isVisible(),a=this.isHorizontal();if(o){const l=Cie(n,i.options.font);if(a?(e.width=this.maxWidth,e.height=hS(s)+l):(e.height=this.maxHeight,e.width=hS(s)+l),r.display&&this.ticks.length){const{first:c,last:u,widest:h,highest:f}=this._getLabelSizes(),m=r.padding*2,g=mu(this.labelRotation),y=Math.cos(g),v=Math.sin(g);if(a){const b=r.mirror?0:v*h.width+y*f.height;e.height=Math.min(this.maxHeight,e.height+b+m)}else{const b=r.mirror?0:y*h.width+v*f.height;e.width=Math.min(this.maxWidth,e.width+b+m)}this._calculatePadding(c,u,v,y)}}this._handleMargins(),a?(this.width=this._length=i.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=i.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,i,r,n){const{ticks:{align:s,padding:o},position:a}=this.options,l=this.labelRotation!==0,c=a!=="top"&&this.axis==="x";if(this.isHorizontal()){const u=this.getPixelForTick(0)-this.left,h=this.right-this.getPixelForTick(this.ticks.length-1);let f=0,m=0;l?c?(f=n*e.width,m=r*i.height):(f=r*e.height,m=n*i.width):s==="start"?m=i.width:s==="end"?f=e.width:s!=="inner"&&(f=e.width/2,m=i.width/2),this.paddingLeft=Math.max((f-u+o)*this.width/(this.width-u),0),this.paddingRight=Math.max((m-h+o)*this.width/(this.width-h),0)}else{let u=i.height/2,h=e.height/2;s==="start"?(u=0,h=e.height):s==="end"&&(u=i.height,h=0),this.paddingTop=u+o,this.paddingBottom=h+o}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){ct(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:i}=this.options;return i==="top"||i==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let i,r;for(i=0,r=e.length;i<r;i++)ei(e[i].label)&&(e.splice(i,1),r--,i--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const i=this.options.ticks.sampleSize;let r=this.ticks;i<r.length&&(r=Tie(r,i)),this._labelSizes=e=this._computeLabelSizes(r,r.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,i,r){const{ctx:n,_longestTextCache:s}=this,o=[],a=[],l=Math.floor(i/Iie(i,r));let c=0,u=0,h,f,m,g,y,v,b,w,x,S,I;for(h=0;h<i;h+=l){if(g=e[h].label,y=this._resolveTickFontOptions(h),n.font=v=y.string,b=s[v]=s[v]||{data:{},gc:[]},w=y.lineHeight,x=S=0,!ei(g)&&!sr(g))x=LO(n,b.data,b.gc,x,g),S=w;else if(sr(g))for(f=0,m=g.length;f<m;++f)I=g[f],!ei(I)&&!sr(I)&&(x=LO(n,b.data,b.gc,x,I),S+=w);o.push(x),a.push(S),c=Math.max(x,c),u=Math.max(S,u)}qdt(s,i);const T=o.indexOf(c),C=a.indexOf(u),E=$=>({width:o[$]||0,height:a[$]||0});return{first:E(0),last:E(i-1),widest:E(T),highest:E(C),widths:o,heights:a}}getLabelForValue(e){return e}getPixelForValue(e,i){return NaN}getValueForPixel(e){}getPixelForTick(e){const i=this.ticks;return e<0||e>i.length-1?null:this.getPixelForValue(i[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const i=this._startPixel+e*this._length;return Lct(this._alignToPixels?ry(this.chart,i,0):i)}getDecimalForPixel(e){const i=(e-this._startPixel)/this._length;return this._reversePixels?1-i:i}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:i}=this;return e<0&&i<0?i:e>0&&i>0?e:0}getContext(e){const i=this.ticks||[];if(e>=0&&e<i.length){const r=i[e];return r.$context||(r.$context=Jdt(this.getContext(),e,r))}return this.$context||(this.$context=Wdt(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,i=mu(this.labelRotation),r=Math.abs(Math.cos(i)),n=Math.abs(Math.sin(i)),s=this._getLabelSizes(),o=e.autoSkipPadding||0,a=s?s.widest.width+o:0,l=s?s.highest.height+o:0;return this.isHorizontal()?l*r>a*n?a/r:l/n:l*n<a*r?l/r:a/n}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const i=this.axis,r=this.chart,n=this.options,{grid:s,position:o,border:a}=n,l=s.offset,c=this.isHorizontal(),h=this.ticks.length+(l?1:0),f=hS(s),m=[],g=a.setContext(this.getContext()),y=g.display?g.width:0,v=y/2,b=function(G){return ry(r,G,y)};let w,x,S,I,T,C,E,$,P,k,L,F;if(o==="top")w=b(this.bottom),C=this.bottom-f,$=w-v,k=b(e.top)+v,F=e.bottom;else if(o==="bottom")w=b(this.top),k=e.top,F=b(e.bottom)-v,C=w+v,$=this.top+f;else if(o==="left")w=b(this.right),T=this.right-f,E=w-v,P=b(e.left)+v,L=e.right;else if(o==="right")w=b(this.left),P=e.left,L=b(e.right)-v,T=w+v,E=this.left+f;else if(i==="x"){if(o==="center")w=b((e.top+e.bottom)/2+.5);else if(Ft(o)){const G=Object.keys(o)[0],H=o[G];w=b(this.chart.scales[G].getPixelForValue(H))}k=e.top,F=e.bottom,C=w+v,$=C+f}else if(i==="y"){if(o==="center")w=b((e.left+e.right)/2);else if(Ft(o)){const G=Object.keys(o)[0],H=o[G];w=b(this.chart.scales[G].getPixelForValue(H))}T=w-v,E=T-f,P=e.left,L=e.right}const V=ot(n.ticks.maxTicksLimit,h),z=Math.max(1,Math.ceil(h/V));for(x=0;x<h;x+=z){const G=this.getContext(x),H=s.setContext(G),Z=a.setContext(G),K=H.lineWidth,X=H.color,oe=Z.dash||[],se=Z.dashOffset,le=H.tickWidth,me=H.tickColor,Se=H.tickBorderDash||[],Ge=H.tickBorderDashOffset;S=Hdt(this,x,l),S!==void 0&&(I=ry(r,S,K),c?T=E=P=L=I:C=$=k=F=I,m.push({tx1:T,ty1:C,tx2:E,ty2:$,x1:P,y1:k,x2:L,y2:F,width:K,color:X,borderDash:oe,borderDashOffset:se,tickWidth:le,tickColor:me,tickBorderDash:Se,tickBorderDashOffset:Ge}))}return this._ticksLength=h,this._borderValue=w,m}_computeLabelItems(e){const i=this.axis,r=this.options,{position:n,ticks:s}=r,o=this.isHorizontal(),a=this.ticks,{align:l,crossAlign:c,padding:u,mirror:h}=s,f=hS(r.grid),m=f+u,g=h?-u:m,y=-mu(this.labelRotation),v=[];let b,w,x,S,I,T,C,E,$,P,k,L,F="middle";if(n==="top")T=this.bottom-g,C=this._getXAxisLabelAlignment();else if(n==="bottom")T=this.top+g,C=this._getXAxisLabelAlignment();else if(n==="left"){const z=this._getYAxisLabelAlignment(f);C=z.textAlign,I=z.x}else if(n==="right"){const z=this._getYAxisLabelAlignment(f);C=z.textAlign,I=z.x}else if(i==="x"){if(n==="center")T=(e.top+e.bottom)/2+m;else if(Ft(n)){const z=Object.keys(n)[0],G=n[z];T=this.chart.scales[z].getPixelForValue(G)+m}C=this._getXAxisLabelAlignment()}else if(i==="y"){if(n==="center")I=(e.left+e.right)/2-m;else if(Ft(n)){const z=Object.keys(n)[0],G=n[z];I=this.chart.scales[z].getPixelForValue(G)}C=this._getYAxisLabelAlignment(f).textAlign}i==="y"&&(l==="start"?F="top":l==="end"&&(F="bottom"));const V=this._getLabelSizes();for(b=0,w=a.length;b<w;++b){x=a[b],S=x.label;const z=s.setContext(this.getContext(b));E=this.getPixelForTick(b)+s.labelOffset,$=this._resolveTickFontOptions(b),P=$.lineHeight,k=sr(S)?S.length:1;const G=k/2,H=z.color,Z=z.textStrokeColor,K=z.textStrokeWidth;let X=C;o?(I=E,C==="inner"&&(b===w-1?X=this.options.reverse?"left":"right":b===0?X=this.options.reverse?"right":"left":X="center"),n==="top"?c==="near"||y!==0?L=-k*P+P/2:c==="center"?L=-V.highest.height/2-G*P+P:L=-V.highest.height+P/2:c==="near"||y!==0?L=P/2:c==="center"?L=V.highest.height/2-G*P:L=V.highest.height-k*P,h&&(L*=-1),y!==0&&!z.showLabelBackdrop&&(I+=P/2*Math.sin(y))):(T=E,L=(1-k)*P/2);let oe;if(z.showLabelBackdrop){const se=fo(z.backdropPadding),le=V.heights[b],me=V.widths[b];let Se=L-se.top,Ge=0-se.left;switch(F){case"middle":Se-=le/2;break;case"bottom":Se-=le;break}switch(C){case"center":Ge-=me/2;break;case"right":Ge-=me;break}oe={left:Ge,top:Se,width:me+se.width,height:le+se.height,color:z.backdropColor}}v.push({label:S,font:$,textOffset:L,options:{rotation:y,color:H,strokeColor:Z,strokeWidth:K,textAlign:X,textBaseline:F,translation:[I,T],backdrop:oe}})}return v}_getXAxisLabelAlignment(){const{position:e,ticks:i}=this.options;if(-mu(this.labelRotation))return e==="top"?"left":"right";let n="center";return i.align==="start"?n="left":i.align==="end"?n="right":i.align==="inner"&&(n="inner"),n}_getYAxisLabelAlignment(e){const{position:i,ticks:{crossAlign:r,mirror:n,padding:s}}=this.options,o=this._getLabelSizes(),a=e+s,l=o.widest.width;let c,u;return i==="left"?n?(u=this.right+s,r==="near"?c="left":r==="center"?(c="center",u+=l/2):(c="right",u+=l)):(u=this.right-a,r==="near"?c="right":r==="center"?(c="center",u-=l/2):(c="left",u=this.left)):i==="right"?n?(u=this.left+s,r==="near"?c="right":r==="center"?(c="center",u-=l/2):(c="left",u-=l)):(u=this.left+a,r==="near"?c="left":r==="center"?(c="center",u+=l/2):(c="right",u=this.right)):c="right",{textAlign:c,x:u}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,i=this.options.position;if(i==="left"||i==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(i==="top"||i==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:i},left:r,top:n,width:s,height:o}=this;i&&(e.save(),e.fillStyle=i,e.fillRect(r,n,s,o),e.restore())}getLineWidthForValue(e){const i=this.options.grid;if(!this._isVisible()||!i.display)return 0;const n=this.ticks.findIndex(s=>s.value===e);return n>=0?i.setContext(this.getContext(n)).lineWidth:0}drawGrid(e){const i=this.options.grid,r=this.ctx,n=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let s,o;const a=(l,c,u)=>{!u.width||!u.color||(r.save(),r.lineWidth=u.width,r.strokeStyle=u.color,r.setLineDash(u.borderDash||[]),r.lineDashOffset=u.borderDashOffset,r.beginPath(),r.moveTo(l.x,l.y),r.lineTo(c.x,c.y),r.stroke(),r.restore())};if(i.display)for(s=0,o=n.length;s<o;++s){const l=n[s];i.drawOnChartArea&&a({x:l.x1,y:l.y1},{x:l.x2,y:l.y2},l),i.drawTicks&&a({x:l.tx1,y:l.ty1},{x:l.tx2,y:l.ty2},{color:l.tickColor,width:l.tickWidth,borderDash:l.tickBorderDash,borderDashOffset:l.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:i,options:{border:r,grid:n}}=this,s=r.setContext(this.getContext()),o=r.display?s.width:0;if(!o)return;const a=n.setContext(this.getContext(0)).lineWidth,l=this._borderValue;let c,u,h,f;this.isHorizontal()?(c=ry(e,this.left,o)-o/2,u=ry(e,this.right,a)+a/2,h=f=l):(h=ry(e,this.top,o)-o/2,f=ry(e,this.bottom,a)+a/2,c=u=l),i.save(),i.lineWidth=s.width,i.strokeStyle=s.color,i.beginPath(),i.moveTo(c,h),i.lineTo(u,f),i.stroke(),i.restore()}drawLabels(e){if(!this.options.ticks.display)return;const r=this.ctx,n=this._computeLabelArea();n&&VR(r,n);const s=this.getLabelItems(e);for(const o of s){const a=o.options,l=o.font,c=o.label,u=o.textOffset;zv(r,c,0,u,l,a)}n&&zR(r)}drawTitle(){const{ctx:e,options:{position:i,title:r,reverse:n}}=this;if(!r.display)return;const s=Jn(r.font),o=fo(r.padding),a=r.align;let l=s.lineHeight/2;i==="bottom"||i==="center"||Ft(i)?(l+=o.bottom,sr(r.text)&&(l+=s.lineHeight*(r.text.length-1))):l+=o.top;const{titleX:c,titleY:u,maxWidth:h,rotation:f}=Ydt(this,l,i,a);zv(e,r.text,0,0,s,{color:r.color,maxWidth:h,rotation:f,textAlign:Zdt(a,i,n),textBaseline:"middle",translation:[c,u]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,i=e.ticks&&e.ticks.z||0,r=ot(e.grid&&e.grid.z,-1),n=ot(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==i_.prototype.draw?[{z:i,draw:s=>{this.draw(s)}}]:[{z:r,draw:s=>{this.drawBackground(),this.drawGrid(s),this.drawTitle()}},{z:n,draw:()=>{this.drawBorder()}},{z:i,draw:s=>{this.drawLabels(s)}}]}getMatchingVisibleMetas(e){const i=this.chart.getSortedVisibleDatasetMetas(),r=this.axis+"AxisID",n=[];let s,o;for(s=0,o=i.length;s<o;++s){const a=i[s];a[r]===this.id&&(!e||a.type===e)&&n.push(a)}return n}_resolveTickFontOptions(e){const i=this.options.ticks.setContext(this.getContext(e));return Jn(i.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class p${constructor(e,i,r){this.type=e,this.scope=i,this.override=r,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const i=Object.getPrototypeOf(e);let r;Qdt(i)&&(r=this.register(i));const n=this.items,s=e.id,o=this.scope+"."+s;if(!s)throw new Error("class does not have id: "+e);return s in n||(n[s]=e,Kdt(e,o,r),this.override&&qr.override(e.id,e.overrides)),o}get(e){return this.items[e]}unregister(e){const i=this.items,r=e.id,n=this.scope;r in i&&delete i[r],n&&r in qr[n]&&(delete qr[n][r],this.override&&delete Vv[r])}}function Kdt(t,e,i){const r=zT(Object.create(null),[i?qr.get(i):{},qr.get(e),t.defaults]);qr.set(e,r),t.defaultRoutes&&Xdt(e,t.defaultRoutes),t.descriptors&&qr.describe(e,t.descriptors)}function Xdt(t,e){Object.keys(e).forEach(i=>{const r=i.split("."),n=r.pop(),s=[t].concat(r).join("."),o=e[i].split("."),a=o.pop(),l=o.join(".");qr.route(s,n,l,a)})}function Qdt(t){return"id"in t&&"defaults"in t}class eht{constructor(){this.controllers=new p$(xu,"datasets",!0),this.elements=new p$(Lp,"elements"),this.plugins=new p$(Object,"plugins"),this.scales=new p$(i_,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,i,r){[...i].forEach(n=>{const s=r||this._getRegistryForType(n);r||s.isForType(n)||s===this.plugins&&n.id?this._exec(e,s,n):Ot(n,o=>{const a=r||this._getRegistryForType(o);this._exec(e,a,o)})})}_exec(e,i,r){const n=tH(e);ct(r["before"+n],[],r),i[e](r),ct(r["after"+n],[],r)}_getRegistryForType(e){for(let i=0;i<this._typedRegistries.length;i++){const r=this._typedRegistries[i];if(r.isForType(e))return r}return this.plugins}_get(e,i,r){const n=i.get(e);if(n===void 0)throw new Error('"'+e+'" is not a registered '+r+".");return n}}var md=new eht;class tht{constructor(){this._init=[]}notify(e,i,r,n){i==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install"));const s=n?this._descriptors(e).filter(n):this._descriptors(e),o=this._notify(s,e,i,r);return i==="afterDestroy"&&(this._notify(s,e,"stop"),this._notify(this._init,e,"uninstall")),o}_notify(e,i,r,n){n=n||{};for(const s of e){const o=s.plugin,a=o[r],l=[i,n,s.options];if(ct(a,l,o)===!1&&n.cancelable)return!1}return!0}invalidate(){ei(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const i=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),i}_createDescriptors(e,i){const r=e&&e.config,n=ot(r.options&&r.options.plugins,{}),s=iht(r);return n===!1&&!i?[]:nht(e,s,n,i)}_notifyStateChanges(e){const i=this._oldCache||[],r=this._cache,n=(s,o)=>s.filter(a=>!o.some(l=>a.plugin.id===l.plugin.id));this._notify(n(i,r),e,"stop"),this._notify(n(r,i),e,"start")}}function iht(t){const e={},i=[],r=Object.keys(md.plugins.items);for(let s=0;s<r.length;s++)i.push(md.getPlugin(r[s]));const n=t.plugins||[];for(let s=0;s<n.length;s++){const o=n[s];i.indexOf(o)===-1&&(i.push(o),e[o.id]=!0)}return{plugins:i,localIds:e}}function rht(t,e){return!e&&t===!1?null:t===!0?{}:t}function nht(t,{plugins:e,localIds:i},r,n){const s=[],o=t.getContext();for(const a of e){const l=a.id,c=rht(r[l],n);c!==null&&s.push({plugin:a,options:sht(t.config,{plugin:a,local:i[l]},c,o)})}return s}function sht(t,{plugin:e,local:i},r,n){const s=t.pluginScopeKeys(e),o=t.getOptionScopes(r,s);return i&&e.defaults&&o.push(e.defaults),t.createResolver(o,n,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function w6(t,e){const i=qr.datasets[t]||{};return((e.datasets||{})[t]||{}).indexAxis||e.indexAxis||i.indexAxis||"x"}function oht(t,e){let i=t;return t==="_index_"?i=e:t==="_value_"&&(i=e==="x"?"y":"x"),i}function aht(t,e){return t===e?"_index_":"_value_"}function Eie(t){if(t==="x"||t==="y"||t==="r")return t}function lht(t){if(t==="top"||t==="bottom")return"x";if(t==="left"||t==="right")return"y"}function x6(t,...e){if(Eie(t))return t;for(const i of e){const r=i.axis||lht(i.position)||t.length>1&&Eie(t[0].toLowerCase());if(r)return r}throw new Error(`Cannot determine type of '${t}' axis. Please provide 'axis' or 'position' option.`)}function Mie(t,e,i){if(i[e+"AxisID"]===t)return{axis:e}}function cht(t,e){if(e.data&&e.data.datasets){const i=e.data.datasets.filter(r=>r.xAxisID===t||r.yAxisID===t);if(i.length)return Mie(t,"x",i[0])||Mie(t,"y",i[0])}return{}}function uht(t,e){const i=Vv[t.type]||{scales:{}},r=e.scales||{},n=w6(t.type,e),s=Object.create(null);return Object.keys(r).forEach(o=>{const a=r[o];if(!Ft(a))return console.error(`Invalid scale configuration for scale: ${o}`);if(a._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${o}`);const l=x6(o,a,cht(o,t),qr.scales[a.type]),c=aht(l,n),u=i.scales||{};s[o]=kI(Object.create(null),[{axis:l},a,u[l],u[c]])}),t.data.datasets.forEach(o=>{const a=o.type||t.type,l=o.indexAxis||w6(a,e),u=(Vv[a]||{}).scales||{};Object.keys(u).forEach(h=>{const f=oht(h,l),m=o[f+"AxisID"]||f;s[m]=s[m]||Object.create(null),kI(s[m],[{axis:f},r[m],u[h]])})}),Object.keys(s).forEach(o=>{const a=s[o];kI(a,[qr.scales[a.type],qr.scale])}),s}function cwe(t){const e=t.options||(t.options={});e.plugins=ot(e.plugins,{}),e.scales=uht(t,e)}function uwe(t){return t=t||{},t.datasets=t.datasets||[],t.labels=t.labels||[],t}function dht(t){return t=t||{},t.data=uwe(t.data),cwe(t),t}const $ie=new Map,dwe=new Set;function f$(t,e){let i=$ie.get(t);return i||(i=e(),$ie.set(t,i),dwe.add(i)),i}const pS=(t,e,i)=>{const r=gg(e,i);r!==void 0&&t.add(r)};class hht{constructor(e){this._config=dht(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=uwe(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),cwe(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return f$(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,i){return f$(`${e}.transition.${i}`,()=>[[`datasets.${e}.transitions.${i}`,`transitions.${i}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,i){return f$(`${e}-${i}`,()=>[[`datasets.${e}.elements.${i}`,`datasets.${e}`,`elements.${i}`,""]])}pluginScopeKeys(e){const i=e.id,r=this.type;return f$(`${r}-plugin-${i}`,()=>[[`plugins.${i}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,i){const r=this._scopeCache;let n=r.get(e);return(!n||i)&&(n=new Map,r.set(e,n)),n}getOptionScopes(e,i,r){const{options:n,type:s}=this,o=this._cachedScopes(e,r),a=o.get(i);if(a)return a;const l=new Set;i.forEach(u=>{e&&(l.add(e),u.forEach(h=>pS(l,e,h))),u.forEach(h=>pS(l,n,h)),u.forEach(h=>pS(l,Vv[s]||{},h)),u.forEach(h=>pS(l,qr,h)),u.forEach(h=>pS(l,v6,h))});const c=Array.from(l);return c.length===0&&c.push(Object.create(null)),dwe.has(i)&&o.set(i,c),c}chartOptionScopes(){const{options:e,type:i}=this;return[e,Vv[i]||{},qr.datasets[i]||{},{type:i},qr,v6]}resolveNamedOptions(e,i,r,n=[""]){const s={$shared:!0},{resolver:o,subPrefixes:a}=Aie(this._resolverCache,e,n);let l=o;if(fht(o,i)){s.$shared=!1,r=yg(r)?r():r;const c=this.createResolver(e,r,a);l=A1(o,r,c)}for(const c of i)s[c]=l[c];return s}createResolver(e,i,r=[""],n){const{resolver:s}=Aie(this._resolverCache,e,r);return Ft(i)?A1(s,i,void 0,n):s}}function Aie(t,e,i){let r=t.get(e);r||(r=new Map,t.set(e,r));const n=i.join();let s=r.get(n);return s||(s={resolver:aH(e,i),subPrefixes:i.filter(a=>!a.toLowerCase().includes("hover"))},r.set(n,s)),s}const pht=t=>Ft(t)&&Object.getOwnPropertyNames(t).reduce((e,i)=>e||yg(t[i]),!1);function fht(t,e){const{isScriptable:i,isIndexable:r}=Ube(t);for(const n of e){const s=i(n),o=r(n),a=(o||s)&&t[n];if(s&&(yg(a)||pht(a))||o&&sr(a))return!0}return!1}var mht="4.3.0";const ght=["top","bottom","left","right","chartArea"];function kie(t,e){return t==="top"||t==="bottom"||ght.indexOf(t)===-1&&e==="x"}function Pie(t,e){return function(i,r){return i[t]===r[t]?i[e]-r[e]:i[t]-r[t]}}function Oie(t){const e=t.chart,i=e.options.animation;e.notifyPlugins("afterRender"),ct(i&&i.onComplete,[t],e)}function yht(t){const e=t.chart,i=e.options.animation;ct(i&&i.onProgress,[t],e)}function hwe(t){return Zbe()&&typeof t=="string"?t=document.getElementById(t):t&&t.length&&(t=t[0]),t&&t.canvas&&(t=t.canvas),t}const yk={},Lie=t=>{const e=hwe(t);return Object.values(yk).filter(i=>i.canvas===e).pop()};function vht(t,e,i){const r=Object.keys(t);for(const n of r){const s=+n;if(s>=e){const o=t[n];delete t[n],(i>0||s>e)&&(t[s+i]=o)}}}function _ht(t,e,i,r){return!i||t.type==="mouseout"?null:r?e:t}function bht(t){const{xScale:e,yScale:i}=t;if(e&&i)return{left:e.left,right:e.right,top:i.top,bottom:i.bottom}}class wd{static register(...e){md.add(...e),Rie()}static unregister(...e){md.remove(...e),Rie()}constructor(e,i){const r=this.config=new hht(i),n=hwe(e),s=Lie(n);if(s)throw new Error("Canvas is already in use. Chart with ID '"+s.id+"' must be destroyed before the canvas with ID '"+s.canvas.id+"' can be reused.");const o=r.createResolver(r.chartOptionScopes(),this.getContext());this.platform=new(r.platform||Ddt(n)),this.platform.updateConfig(r);const a=this.platform.acquireContext(n,o.aspectRatio),l=a&&a.canvas,c=l&&l.height,u=l&&l.width;if(this.id=xct(),this.ctx=a,this.canvas=l,this.width=u,this.height=c,this._options=o,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new tht,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=Nct(h=>this.update(h),o.resizeDelay||0),this._dataChanges=[],yk[this.id]=this,!a||!l){console.error("Failed to create chart: can't acquire context from the given item");return}Fh.listen(this,"complete",Oie),Fh.listen(this,"progress",yht),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:i},width:r,height:n,_aspectRatio:s}=this;return ei(e)?i&&s?s:n?r/n:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return md}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():iie(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return Qte(this.canvas,this.ctx),this}stop(){return Fh.stop(this),this}resize(e,i){Fh.running(this)?this._resizeBeforeDraw={width:e,height:i}:this._resize(e,i)}_resize(e,i){const r=this.options,n=this.canvas,s=r.maintainAspectRatio&&this.aspectRatio,o=this.platform.getMaximumSize(n,e,i,s),a=r.devicePixelRatio||this.platform.getDevicePixelRatio(),l=this.width?"resize":"attach";this.width=o.width,this.height=o.height,this._aspectRatio=this.aspectRatio,iie(this,a,!0)&&(this.notifyPlugins("resize",{size:o}),ct(r.onResize,[this,o],this),this.attached&&this._doResize(l)&&this.render())}ensureScalesHaveIDs(){const i=this.options.scales||{};Ot(i,(r,n)=>{r.id=n})}buildOrUpdateScales(){const e=this.options,i=e.scales,r=this.scales,n=Object.keys(r).reduce((o,a)=>(o[a]=!1,o),{});let s=[];i&&(s=s.concat(Object.keys(i).map(o=>{const a=i[o],l=x6(o,a),c=l==="r",u=l==="x";return{options:a,dposition:c?"chartArea":u?"bottom":"left",dtype:c?"radialLinear":u?"category":"linear"}}))),Ot(s,o=>{const a=o.options,l=a.id,c=x6(l,a),u=ot(a.type,o.dtype);(a.position===void 0||kie(a.position,c)!==kie(o.dposition))&&(a.position=o.dposition),n[l]=!0;let h=null;if(l in r&&r[l].type===u)h=r[l];else{const f=md.getScale(u);h=new f({id:l,type:u,ctx:this.ctx,chart:this}),r[h.id]=h}h.init(a,e)}),Ot(n,(o,a)=>{o||delete r[a]}),Ot(r,o=>{ao.configure(this,o,o.options),ao.addBox(this,o)})}_updateMetasets(){const e=this._metasets,i=this.data.datasets.length,r=e.length;if(e.sort((n,s)=>n.index-s.index),r>i){for(let n=i;n<r;++n)this._destroyDatasetMeta(n);e.splice(i,r-i)}this._sortedMetasets=e.slice(0).sort(Pie("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:i}}=this;e.length>i.length&&delete this._stacks,e.forEach((r,n)=>{i.filter(s=>s===r._dataset).length===0&&this._destroyDatasetMeta(n)})}buildOrUpdateControllers(){const e=[],i=this.data.datasets;let r,n;for(this._removeUnreferencedMetasets(),r=0,n=i.length;r<n;r++){const s=i[r];let o=this.getDatasetMeta(r);const a=s.type||this.config.type;if(o.type&&o.type!==a&&(this._destroyDatasetMeta(r),o=this.getDatasetMeta(r)),o.type=a,o.indexAxis=s.indexAxis||w6(a,this.options),o.order=s.order||0,o.index=r,o.label=""+s.label,o.visible=this.isDatasetVisible(r),o.controller)o.controller.updateIndex(r),o.controller.linkScales();else{const l=md.getController(a),{datasetElementType:c,dataElementType:u}=qr.datasets[a];Object.assign(l,{dataElementType:md.getElement(u),datasetElementType:c&&md.getElement(c)}),o.controller=new l(this,r),e.push(o.controller)}}return this._updateMetasets(),e}_resetElements(){Ot(this.data.datasets,(e,i)=>{this.getDatasetMeta(i).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const i=this.config;i.update();const r=this._options=i.createResolver(i.chartOptionScopes(),this.getContext()),n=this._animationsDisabled=!r.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const s=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let o=0;for(let c=0,u=this.data.datasets.length;c<u;c++){const{controller:h}=this.getDatasetMeta(c),f=!n&&s.indexOf(h)===-1;h.buildOrUpdateElements(f),o=Math.max(+h.getMaxOverflow(),o)}o=this._minPadding=r.layout.autoPadding?o:0,this._updateLayout(o),n||Ot(s,c=>{c.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(Pie("z","_idx"));const{_active:a,_lastEvent:l}=this;l?this._eventHandler(l,!0):a.length&&this._updateHoverStyles(a,a,!0),this.render()}_updateScales(){Ot(this.scales,e=>{ao.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,i=new Set(Object.keys(this._listeners)),r=new Set(e.events);(!Gte(i,r)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,i=this._getUniformDataChanges()||[];for(const{method:r,start:n,count:s}of i){const o=r==="_removeElements"?-s:s;vht(e,n,o)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const i=this.data.datasets.length,r=s=>new Set(e.filter(o=>o[0]===s).map((o,a)=>a+","+o.splice(1).join(","))),n=r(0);for(let s=1;s<i;s++)if(!Gte(n,r(s)))return;return Array.from(n).map(s=>s.split(",")).map(s=>({method:s[1],start:+s[2],count:+s[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;ao.update(this,this.width,this.height,e);const i=this.chartArea,r=i.width<=0||i.height<=0;this._layers=[],Ot(this.boxes,n=>{r&&n.position==="chartArea"||(n.configure&&n.configure(),this._layers.push(...n._layers()))},this),this._layers.forEach((n,s)=>{n._idx=s}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let i=0,r=this.data.datasets.length;i<r;++i)this.getDatasetMeta(i).controller.configure();for(let i=0,r=this.data.datasets.length;i<r;++i)this._updateDataset(i,yg(e)?e({datasetIndex:i}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,i){const r=this.getDatasetMeta(e),n={meta:r,index:e,mode:i,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",n)!==!1&&(r.controller._update(i),n.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",n))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(Fh.has(this)?this.attached&&!Fh.running(this)&&Fh.start(this):(this.draw(),Oie({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:r,height:n}=this._resizeBeforeDraw;this._resize(r,n),this._resizeBeforeDraw=null}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const i=this._layers;for(e=0;e<i.length&&i[e].z<=0;++e)i[e].draw(this.chartArea);for(this._drawDatasets();e<i.length;++e)i[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const i=this._sortedMetasets,r=[];let n,s;for(n=0,s=i.length;n<s;++n){const o=i[n];(!e||o.visible)&&r.push(o)}return r}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let i=e.length-1;i>=0;--i)this._drawDataset(e[i]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const i=this.ctx,r=e._clip,n=!r.disabled,s=bht(e)||this.chartArea,o={meta:e,index:e.index,cancelable:!0};this.notifyPlugins("beforeDatasetDraw",o)!==!1&&(n&&VR(i,{left:r.left===!1?0:s.left-r.left,right:r.right===!1?this.width:s.right+r.right,top:r.top===!1?0:s.top-r.top,bottom:r.bottom===!1?this.height:s.bottom+r.bottom}),e.controller.draw(),n&&zR(i),o.cancelable=!1,this.notifyPlugins("afterDatasetDraw",o))}isPointInArea(e){return tp(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,i,r,n){const s=gdt.modes[i];return typeof s=="function"?s(this,e,r,n):[]}getDatasetMeta(e){const i=this.data.datasets[e],r=this._metasets;let n=r.filter(s=>s&&s._dataset===i).pop();return n||(n={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:i&&i.order||0,index:e,_dataset:i,_parsed:[],_sorted:!1},r.push(n)),n}getContext(){return this.$context||(this.$context=Pg(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const i=this.data.datasets[e];if(!i)return!1;const r=this.getDatasetMeta(e);return typeof r.hidden=="boolean"?!r.hidden:!i.hidden}setDatasetVisibility(e,i){const r=this.getDatasetMeta(e);r.hidden=!i}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,i,r){const n=r?"show":"hide",s=this.getDatasetMeta(e),o=s.controller._resolveAnimations(void 0,n);jT(i)?(s.data[i].hidden=!r,this.update()):(this.setDatasetVisibility(e,r),o.update(s,{visible:r}),this.update(a=>a.datasetIndex===e?n:void 0))}hide(e,i){this._updateVisibility(e,i,!1)}show(e,i){this._updateVisibility(e,i,!0)}_destroyDatasetMeta(e){const i=this._metasets[e];i&&i.controller&&i.controller._destroy(),delete this._metasets[e]}_stop(){let e,i;for(this.stop(),Fh.remove(this),e=0,i=this.data.datasets.length;e<i;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:i}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),Qte(e,i),this.platform.releaseContext(i),this.canvas=null,this.ctx=null),delete yk[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,i=this.platform,r=(s,o)=>{i.addEventListener(this,s,o),e[s]=o},n=(s,o,a)=>{s.offsetX=o,s.offsetY=a,this._eventHandler(s)};Ot(this.options.events,s=>r(s,n))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,i=this.platform,r=(l,c)=>{i.addEventListener(this,l,c),e[l]=c},n=(l,c)=>{e[l]&&(i.removeEventListener(this,l,c),delete e[l])},s=(l,c)=>{this.canvas&&this.resize(l,c)};let o;const a=()=>{n("attach",a),this.attached=!0,this.resize(),r("resize",s),r("detach",o)};o=()=>{this.attached=!1,n("resize",s),this._stop(),this._resize(0,0),r("attach",a)},i.isAttached(this.canvas)?a():o()}unbindEvents(){Ot(this._listeners,(e,i)=>{this.platform.removeEventListener(this,i,e)}),this._listeners={},Ot(this._responsiveListeners,(e,i)=>{this.platform.removeEventListener(this,i,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,i,r){const n=r?"set":"remove";let s,o,a,l;for(i==="dataset"&&(s=this.getDatasetMeta(e[0].datasetIndex),s.controller["_"+n+"DatasetHoverStyle"]()),a=0,l=e.length;a<l;++a){o=e[a];const c=o&&this.getDatasetMeta(o.datasetIndex).controller;c&&c[n+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const i=this._active||[],r=e.map(({datasetIndex:s,index:o})=>{const a=this.getDatasetMeta(s);if(!a)throw new Error("No dataset found at index "+s);return{datasetIndex:s,element:a.data[o],index:o}});!kO(r,i)&&(this._active=r,this._lastEvent=null,this._updateHoverStyles(r,i))}notifyPlugins(e,i,r){return this._plugins.notify(this,e,i,r)}isPluginEnabled(e){return this._plugins._cache.filter(i=>i.plugin.id===e).length===1}_updateHoverStyles(e,i,r){const n=this.options.hover,s=(l,c)=>l.filter(u=>!c.some(h=>u.datasetIndex===h.datasetIndex&&u.index===h.index)),o=s(i,e),a=r?e:s(e,i);o.length&&this.updateHoverStyle(o,n.mode,!1),a.length&&n.mode&&this.updateHoverStyle(a,n.mode,!0)}_eventHandler(e,i){const r={event:e,replay:i,cancelable:!0,inChartArea:this.isPointInArea(e)},n=o=>(o.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",r,n)===!1)return;const s=this._handleEvent(e,i,r.inChartArea);return r.cancelable=!1,this.notifyPlugins("afterEvent",r,n),(s||r.changed)&&this.render(),this}_handleEvent(e,i,r){const{_active:n=[],options:s}=this,o=i,a=this._getActiveElements(e,n,r,o),l=Mct(e),c=_ht(e,this._lastEvent,r,l);r&&(this._lastEvent=null,ct(s.onHover,[e,a,this],this),l&&ct(s.onClick,[e,a,this],this));const u=!kO(a,n);return(u||i)&&(this._active=a,this._updateHoverStyles(a,n,i)),this._lastEvent=c,u}_getActiveElements(e,i,r,n){if(e.type==="mouseout")return[];if(!r)return i;const s=this.options.hover;return this.getElementsAtEventForMode(e,s.mode,s,n)}}we(wd,"defaults",qr),we(wd,"instances",yk),we(wd,"overrides",Vv),we(wd,"registry",md),we(wd,"version",mht),we(wd,"getChart",Lie);function Rie(){return Ot(wd.instances,t=>t._plugins.invalidate())}function wht(t,e,i){const{startAngle:r,pixelMargin:n,x:s,y:o,outerRadius:a,innerRadius:l}=e;let c=n/a;t.beginPath(),t.arc(s,o,a,r-c,i+c),l>n?(c=n/l,t.arc(s,o,l,i+c,r-c,!0)):t.arc(s,o,n,i+Hr,r-Hr),t.closePath(),t.clip()}function xht(t){return oH(t,["outerStart","outerEnd","innerStart","innerEnd"])}function Sht(t,e,i,r){const n=xht(t.options.borderRadius),s=(i-e)/2,o=Math.min(s,r*e/2),a=l=>{const c=(i-Math.min(s,l))*r/2;return fs(l,0,Math.min(s,c))};return{outerStart:a(n.outerStart),outerEnd:a(n.outerEnd),innerStart:fs(n.innerStart,0,o),innerEnd:fs(n.innerEnd,0,o)}}function q_(t,e,i,r){return{x:i+t*Math.cos(e),y:r+t*Math.sin(e)}}function DO(t,e,i,r,n,s){const{x:o,y:a,startAngle:l,pixelMargin:c,innerRadius:u}=e,h=Math.max(e.outerRadius+r+i-c,0),f=u>0?u+r+i+c:0;let m=0;const g=n-l;if(r){const z=u>0?u-r:0,G=h>0?h-r:0,H=(z+G)/2,Z=H!==0?g*H/(H+r):g;m=(g-Z)/2}const y=Math.max(.001,g*h-i/Tr)/h,v=(g-y)/2,b=l+v+m,w=n-v-m,{outerStart:x,outerEnd:S,innerStart:I,innerEnd:T}=Sht(e,f,h,w-b),C=h-x,E=h-S,$=b+x/C,P=w-S/E,k=f+I,L=f+T,F=b+I/k,V=w-T/L;if(t.beginPath(),s){const z=($+P)/2;if(t.arc(o,a,h,$,z),t.arc(o,a,h,z,P),S>0){const K=q_(E,P,o,a);t.arc(K.x,K.y,S,P,w+Hr)}const G=q_(L,w,o,a);if(t.lineTo(G.x,G.y),T>0){const K=q_(L,V,o,a);t.arc(K.x,K.y,T,w+Hr,V+Math.PI)}const H=(w-T/f+(b+I/f))/2;if(t.arc(o,a,f,w-T/f,H,!0),t.arc(o,a,f,H,b+I/f,!0),I>0){const K=q_(k,F,o,a);t.arc(K.x,K.y,I,F+Math.PI,b-Hr)}const Z=q_(C,b,o,a);if(t.lineTo(Z.x,Z.y),x>0){const K=q_(C,$,o,a);t.arc(K.x,K.y,x,b-Hr,$)}}else{t.moveTo(o,a);const z=Math.cos($)*h+o,G=Math.sin($)*h+a;t.lineTo(z,G);const H=Math.cos(P)*h+o,Z=Math.sin(P)*h+a;t.lineTo(H,Z)}t.closePath()}function Iht(t,e,i,r,n){const{fullCircles:s,startAngle:o,circumference:a}=e;let l=e.endAngle;if(s){DO(t,e,i,r,l,n);for(let c=0;c<s;++c)t.fill();isNaN(a)||(l=o+(a%ar||ar))}return DO(t,e,i,r,l,n),t.fill(),l}function Tht(t,e,i,r,n){const{fullCircles:s,startAngle:o,circumference:a,options:l}=e,{borderWidth:c,borderJoinStyle:u,borderDash:h,borderDashOffset:f}=l,m=l.borderAlign==="inner";if(!c)return;t.setLineDash(h||[]),t.lineDashOffset=f,m?(t.lineWidth=c*2,t.lineJoin=u||"round"):(t.lineWidth=c,t.lineJoin=u||"bevel");let g=e.endAngle;if(s){DO(t,e,i,r,g,n);for(let y=0;y<s;++y)t.stroke();isNaN(a)||(g=o+(a%ar||ar))}m&&wht(t,e,g),s||(DO(t,e,i,r,g,n),t.stroke())}class N2 extends Lp{constructor(i){super();we(this,"circumference");we(this,"endAngle");we(this,"fullCircles");we(this,"innerRadius");we(this,"outerRadius");we(this,"pixelMargin");we(this,"startAngle");this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,i&&Object.assign(this,i)}inRange(i,r,n){const s=this.getProps(["x","y"],n),{angle:o,distance:a}=Obe(s,{x:i,y:r}),{startAngle:l,endAngle:c,innerRadius:u,outerRadius:h,circumference:f}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],n),m=(this.options.spacing+this.options.borderWidth)/2,y=ot(f,c-l)>=ar||BT(o,l,c),v=Qh(a,u+m,h+m);return y&&v}getCenterPoint(i){const{x:r,y:n,startAngle:s,endAngle:o,innerRadius:a,outerRadius:l}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],i),{offset:c,spacing:u}=this.options,h=(s+o)/2,f=(a+l+u+c)/2;return{x:r+Math.cos(h)*f,y:n+Math.sin(h)*f}}tooltipPosition(i){return this.getCenterPoint(i)}draw(i){const{options:r,circumference:n}=this,s=(r.offset||0)/4,o=(r.spacing||0)/2,a=r.circular;if(this.pixelMargin=r.borderAlign==="inner"?.33:0,this.fullCircles=n>ar?Math.floor(n/ar):0,n===0||this.innerRadius<0||this.outerRadius<0)return;i.save();const l=(this.startAngle+this.endAngle)/2;i.translate(Math.cos(l)*s,Math.sin(l)*s);const c=1-Math.sin(Math.min(Tr,n||0)),u=s*c;i.fillStyle=r.backgroundColor,i.strokeStyle=r.borderColor,Iht(i,this,u,o,a),Tht(i,this,u,o,a),i.restore()}}we(N2,"id","arc"),we(N2,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0}),we(N2,"defaultRoutes",{backgroundColor:"backgroundColor"}),we(N2,"descriptors",{_scriptable:!0,_indexable:i=>i!=="borderDash"});function pwe(t,e,i=e){t.lineCap=ot(i.borderCapStyle,e.borderCapStyle),t.setLineDash(ot(i.borderDash,e.borderDash)),t.lineDashOffset=ot(i.borderDashOffset,e.borderDashOffset),t.lineJoin=ot(i.borderJoinStyle,e.borderJoinStyle),t.lineWidth=ot(i.borderWidth,e.borderWidth),t.strokeStyle=ot(i.borderColor,e.borderColor)}function Cht(t,e,i){t.lineTo(i.x,i.y)}function Eht(t){return t.stepped?Yct:t.tension||t.cubicInterpolationMode==="monotone"?Kct:Cht}function fwe(t,e,i={}){const r=t.length,{start:n=0,end:s=r-1}=i,{start:o,end:a}=e,l=Math.max(n,o),c=Math.min(s,a),u=n<o&&s<o||n>a&&s>a;return{count:r,start:l,loop:e.loop,ilen:c<l&&!u?r+c-l:c-l}}function Mht(t,e,i,r){const{points:n,options:s}=e,{count:o,start:a,loop:l,ilen:c}=fwe(n,i,r),u=Eht(s);let{move:h=!0,reverse:f}=r||{},m,g,y;for(m=0;m<=c;++m)g=n[(a+(f?c-m:m))%o],!g.skip&&(h?(t.moveTo(g.x,g.y),h=!1):u(t,y,g,f,s.stepped),y=g);return l&&(g=n[(a+(f?c:0))%o],u(t,y,g,f,s.stepped)),!!l}function $ht(t,e,i,r){const n=e.points,{count:s,start:o,ilen:a}=fwe(n,i,r),{move:l=!0,reverse:c}=r||{};let u=0,h=0,f,m,g,y,v,b;const w=S=>(o+(c?a-S:S))%s,x=()=>{y!==v&&(t.lineTo(u,v),t.lineTo(u,y),t.lineTo(u,b))};for(l&&(m=n[w(0)],t.moveTo(m.x,m.y)),f=0;f<=a;++f){if(m=n[w(f)],m.skip)continue;const S=m.x,I=m.y,T=S|0;T===g?(I<y?y=I:I>v&&(v=I),u=(h*u+S)/++h):(x(),t.lineTo(S,I),g=T,h=0,y=v=I),b=I}x()}function S6(t){const e=t.options,i=e.borderDash&&e.borderDash.length;return!t._decimated&&!t._loop&&!e.tension&&e.cubicInterpolationMode!=="monotone"&&!e.stepped&&!i?$ht:Mht}function Aht(t){return t.stepped?$ut:t.tension||t.cubicInterpolationMode==="monotone"?Aut:S0}function kht(t,e,i,r){let n=e._path;n||(n=e._path=new Path2D,e.path(n,i,r)&&n.closePath()),pwe(t,e.options),t.stroke(n)}function Pht(t,e,i,r){const{segments:n,options:s}=e,o=S6(e);for(const a of n)pwe(t,s,a.style),t.beginPath(),o(t,e,a,{start:i,end:i+r-1})&&t.closePath(),t.stroke()}const Oht=typeof Path2D=="function";function Lht(t,e,i,r){Oht&&!e.options.segment?kht(t,e,i,r):Pht(t,e,i,r)}class Gm extends Lp{constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,i){const r=this.options;if((r.tension||r.cubicInterpolationMode==="monotone")&&!r.stepped&&!this._pointsUpdated){const n=r.spanGaps?this._loop:this._fullLoop;wut(this._points,r,e,n,i),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=Fut(this,this.options.segment))}first(){const e=this.segments,i=this.points;return e.length&&i[e[0].start]}last(){const e=this.segments,i=this.points,r=e.length;return r&&i[e[r-1].end]}interpolate(e,i){const r=this.options,n=e[i],s=this.points,o=ewe(this,{property:i,start:n,end:n});if(!o.length)return;const a=[],l=Aht(r);let c,u;for(c=0,u=o.length;c<u;++c){const{start:h,end:f}=o[c],m=s[h],g=s[f];if(m===g){a.push(m);continue}const y=Math.abs((n-m[i])/(g[i]-m[i])),v=l(m,g,y,r.stepped);v[i]=e[i],a.push(v)}return a.length===1?a[0]:a}pathSegment(e,i,r){return S6(this)(e,this,i,r)}path(e,i,r){const n=this.segments,s=S6(this);let o=this._loop;i=i||0,r=r||this.points.length-i;for(const a of n)o&=s(e,this,a,{start:i,end:i+r-1});return!!o}draw(e,i,r,n){const s=this.options||{};(this.points||[]).length&&s.borderWidth&&(e.save(),Lht(e,this,r,n),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}we(Gm,"id","line"),we(Gm,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),we(Gm,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),we(Gm,"descriptors",{_scriptable:!0,_indexable:e=>e!=="borderDash"&&e!=="fill"});function Fie(t,e,i,r){const n=t.options,{[i]:s}=t.getProps([i],r);return Math.abs(e-s)<n.radius+n.hitRadius}class vk extends Lp{constructor(i){super();we(this,"parsed");we(this,"skip");we(this,"stop");this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,i&&Object.assign(this,i)}inRange(i,r,n){const s=this.options,{x:o,y:a}=this.getProps(["x","y"],n);return Math.pow(i-o,2)+Math.pow(r-a,2)<Math.pow(s.hitRadius+s.radius,2)}inXRange(i,r){return Fie(this,i,"x",r)}inYRange(i,r){return Fie(this,i,"y",r)}getCenterPoint(i){const{x:r,y:n}=this.getProps(["x","y"],i);return{x:r,y:n}}size(i){i=i||this.options||{};let r=i.radius||0;r=Math.max(r,r&&i.hoverRadius||0);const n=r&&i.borderWidth||0;return(r+n)*2}draw(i,r){const n=this.options;this.skip||n.radius<.1||!tp(this,r,this.size(n)/2)||(i.strokeStyle=n.borderColor,i.lineWidth=n.borderWidth,i.fillStyle=n.backgroundColor,_6(i,n,this.x,this.y))}getRange(){const i=this.options||{};return i.radius+i.hitRadius}}we(vk,"id","point"),we(vk,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),we(vk,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});function mwe(t,e){const{x:i,y:r,base:n,width:s,height:o}=t.getProps(["x","y","base","width","height"],e);let a,l,c,u,h;return t.horizontal?(h=o/2,a=Math.min(i,n),l=Math.max(i,n),c=r-h,u=r+h):(h=s/2,a=i-h,l=i+h,c=Math.min(r,n),u=Math.max(r,n)),{left:a,top:c,right:l,bottom:u}}function Hm(t,e,i,r){return t?0:fs(e,i,r)}function Rht(t,e,i){const r=t.options.borderWidth,n=t.borderSkipped,s=Bbe(r);return{t:Hm(n.top,s.top,0,i),r:Hm(n.right,s.right,0,e),b:Hm(n.bottom,s.bottom,0,i),l:Hm(n.left,s.left,0,e)}}function Fht(t,e,i){const{enableBorderRadius:r}=t.getProps(["enableBorderRadius"]),n=t.options.borderRadius,s=mv(n),o=Math.min(e,i),a=t.borderSkipped,l=r||Ft(n);return{topLeft:Hm(!l||a.top||a.left,s.topLeft,0,o),topRight:Hm(!l||a.top||a.right,s.topRight,0,o),bottomLeft:Hm(!l||a.bottom||a.left,s.bottomLeft,0,o),bottomRight:Hm(!l||a.bottom||a.right,s.bottomRight,0,o)}}function Dht(t){const e=mwe(t),i=e.right-e.left,r=e.bottom-e.top,n=Rht(t,i/2,r/2),s=Fht(t,i/2,r/2);return{outer:{x:e.left,y:e.top,w:i,h:r,radius:s},inner:{x:e.left+n.l,y:e.top+n.t,w:i-n.l-n.r,h:r-n.t-n.b,radius:{topLeft:Math.max(0,s.topLeft-Math.max(n.t,n.l)),topRight:Math.max(0,s.topRight-Math.max(n.t,n.r)),bottomLeft:Math.max(0,s.bottomLeft-Math.max(n.b,n.l)),bottomRight:Math.max(0,s.bottomRight-Math.max(n.b,n.r))}}}}function pD(t,e,i,r){const n=e===null,s=i===null,a=t&&!(n&&s)&&mwe(t,r);return a&&(n||Qh(e,a.left,a.right))&&(s||Qh(i,a.top,a.bottom))}function Nht(t){return t.topLeft||t.topRight||t.bottomLeft||t.bottomRight}function Vht(t,e){t.rect(e.x,e.y,e.w,e.h)}function fD(t,e,i={}){const r=t.x!==i.x?-e:0,n=t.y!==i.y?-e:0,s=(t.x+t.w!==i.x+i.w?e:0)-r,o=(t.y+t.h!==i.y+i.h?e:0)-n;return{x:t.x+r,y:t.y+n,w:t.w+s,h:t.h+o,radius:t.radius}}class _k extends Lp{constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:i,options:{borderColor:r,backgroundColor:n}}=this,{inner:s,outer:o}=Dht(this),a=Nht(o.radius)?UT:Vht;e.save(),(o.w!==s.w||o.h!==s.h)&&(e.beginPath(),a(e,fD(o,i,s)),e.clip(),a(e,fD(s,-i,o)),e.fillStyle=r,e.fill("evenodd")),e.beginPath(),a(e,fD(s,i)),e.fillStyle=n,e.fill(),e.restore()}inRange(e,i,r){return pD(this,e,i,r)}inXRange(e,i){return pD(this,e,null,i)}inYRange(e,i){return pD(this,null,e,i)}getCenterPoint(e){const{x:i,y:r,base:n,horizontal:s}=this.getProps(["x","y","base","horizontal"],e);return{x:s?(i+n)/2:i,y:s?r:(r+n)/2}}getRange(e){return e==="x"?this.width/2:this.height/2}}we(_k,"id","bar"),we(_k,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),we(_k,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});var zht=Object.freeze({__proto__:null,ArcElement:N2,BarElement:_k,LineElement:Gm,PointElement:vk});const I6=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],Die=I6.map(t=>t.replace("rgb(","rgba(").replace(")",", 0.5)"));function gwe(t){return I6[t%I6.length]}function ywe(t){return Die[t%Die.length]}function jht(t,e){return t.borderColor=gwe(e),t.backgroundColor=ywe(e),++e}function Bht(t,e){return t.backgroundColor=t.data.map(()=>gwe(e++)),e}function Uht(t,e){return t.backgroundColor=t.data.map(()=>ywe(e++)),e}function Ght(t){let e=0;return(i,r)=>{const n=t.getDatasetMeta(r).controller;n instanceof K0?e=Bht(i,e):n instanceof RI?e=Uht(i,e):n&&(e=jht(i,e))}}function Nie(t){let e;for(e in t)if(t[e].borderColor||t[e].backgroundColor)return!0;return!1}function Hht(t){return t&&(t.borderColor||t.backgroundColor)}var qht={id:"colors",defaults:{enabled:!0,forceOverride:!1},beforeLayout(t,e,i){if(!i.enabled)return;const{data:{datasets:r},options:n}=t.config,{elements:s}=n;if(!i.forceOverride&&(Nie(r)||Hht(n)||s&&Nie(s)))return;const o=Ght(t);r.forEach(o)}};function Wht(t,e,i,r,n){const s=n.samples||r;if(s>=i)return t.slice(e,e+i);const o=[],a=(i-2)/(s-2);let l=0;const c=e+i-1;let u=e,h,f,m,g,y;for(o[l++]=t[u],h=0;h<s-2;h++){let v=0,b=0,w;const x=Math.floor((h+1)*a)+1+e,S=Math.min(Math.floor((h+2)*a)+1,i)+e,I=S-x;for(w=x;w<S;w++)v+=t[w].x,b+=t[w].y;v/=I,b/=I;const T=Math.floor(h*a)+1+e,C=Math.min(Math.floor((h+1)*a)+1,i)+e,{x:E,y:$}=t[u];for(m=g=-1,w=T;w<C;w++)g=.5*Math.abs((E-v)*(t[w].y-$)-(E-t[w].x)*(b-$)),g>m&&(m=g,f=t[w],y=w);o[l++]=f,u=y}return o[l++]=t[c],o}function Jht(t,e,i,r){let n=0,s=0,o,a,l,c,u,h,f,m,g,y;const v=[],b=e+i-1,w=t[e].x,S=t[b].x-w;for(o=e;o<e+i;++o){a=t[o],l=(a.x-w)/S*r,c=a.y;const I=l|0;if(I===u)c<g?(g=c,h=o):c>y&&(y=c,f=o),n=(s*n+a.x)/++s;else{const T=o-1;if(!ei(h)&&!ei(f)){const C=Math.min(h,f),E=Math.max(h,f);C!==m&&C!==T&&v.push({...t[C],x:n}),E!==m&&E!==T&&v.push({...t[E],x:n})}o>0&&T!==m&&v.push(t[T]),v.push(a),u=I,s=0,g=y=c,h=f=m=o}}return v}function vwe(t){if(t._decimated){const e=t._data;delete t._decimated,delete t._data,Object.defineProperty(t,"data",{configurable:!0,enumerable:!0,writable:!0,value:e})}}function Vie(t){t.data.datasets.forEach(e=>{vwe(e)})}function Zht(t,e){const i=e.length;let r=0,n;const{iScale:s}=t,{min:o,max:a,minDefined:l,maxDefined:c}=s.getUserBounds();return l&&(r=fs(ep(e,s.axis,o).lo,0,i-1)),c?n=fs(ep(e,s.axis,a).hi+1,r,i)-r:n=i-r,{start:r,count:n}}var Yht={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(t,e,i)=>{if(!i.enabled){Vie(t);return}const r=t.width;t.data.datasets.forEach((n,s)=>{const{_data:o,indexAxis:a}=n,l=t.getDatasetMeta(s),c=o||n.data;if(F2([a,t.options.indexAxis])==="y"||!l.controller.supportsDecimation)return;const u=t.scales[l.xAxisID];if(u.type!=="linear"&&u.type!=="time"||t.options.parsing)return;let{start:h,count:f}=Zht(l,c);const m=i.threshold||4*r;if(f<=m){vwe(n);return}ei(o)&&(n._data=c,delete n.data,Object.defineProperty(n,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(y){this._data=y}}));let g;switch(i.algorithm){case"lttb":g=Wht(c,h,f,r,i);break;case"min-max":g=Jht(c,h,f,r);break;default:throw new Error(`Unsupported decimation algorithm '${i.algorithm}'`)}n._decimated=g})},destroy(t){Vie(t)}};function Kht(t,e,i){const r=t.segments,n=t.points,s=e.points,o=[];for(const a of r){let{start:l,end:c}=a;c=hH(l,c,n);const u=T6(i,n[l],n[c],a.loop);if(!e.segments){o.push({source:a,target:u,start:n[l],end:n[c]});continue}const h=ewe(e,u);for(const f of h){const m=T6(i,s[f.start],s[f.end],f.loop),g=Qbe(a,n,m);for(const y of g)o.push({source:y,target:f,start:{[i]:zie(u,m,"start",Math.max)},end:{[i]:zie(u,m,"end",Math.min)}})}}return o}function T6(t,e,i,r){if(r)return;let n=e[t],s=i[t];return t==="angle"&&(n=Ya(n),s=Ya(s)),{property:t,start:n,end:s}}function Xht(t,e){const{x:i=null,y:r=null}=t||{},n=e.points,s=[];return e.segments.forEach(({start:o,end:a})=>{a=hH(o,a,n);const l=n[o],c=n[a];r!==null?(s.push({x:l.x,y:r}),s.push({x:c.x,y:r})):i!==null&&(s.push({x:i,y:l.y}),s.push({x:i,y:c.y}))}),s}function hH(t,e,i){for(;e>t;e--){const r=i[e];if(!isNaN(r.x)&&!isNaN(r.y))break}return e}function zie(t,e,i,r){return t&&e?r(t[i],e[i]):t?t[i]:e?e[i]:0}function _we(t,e){let i=[],r=!1;return sr(t)?(r=!0,i=t):i=Xht(t,e),i.length?new Gm({points:i,options:{tension:0},_loop:r,_fullLoop:r}):null}function jie(t){return t&&t.fill!==!1}function Qht(t,e,i){let n=t[e].fill;const s=[e];let o;if(!i)return n;for(;n!==!1&&s.indexOf(n)===-1;){if(!Gr(n))return n;if(o=t[n],!o)return!1;if(o.visible)return n;s.push(n),n=o.fill}return!1}function ept(t,e,i){const r=npt(t);if(Ft(r))return isNaN(r.value)?!1:r;let n=parseFloat(r);return Gr(n)&&Math.floor(n)===n?tpt(r[0],e,n,i):["origin","start","end","stack","shape"].indexOf(r)>=0&&r}function tpt(t,e,i,r){return(t==="-"||t==="+")&&(i=e+i),i===e||i<0||i>=r?!1:i}function ipt(t,e){let i=null;return t==="start"?i=e.bottom:t==="end"?i=e.top:Ft(t)?i=e.getPixelForValue(t.value):e.getBasePixel&&(i=e.getBasePixel()),i}function rpt(t,e,i){let r;return t==="start"?r=i:t==="end"?r=e.options.reverse?e.min:e.max:Ft(t)?r=t.value:r=e.getBaseValue(),r}function npt(t){const e=t.options,i=e.fill;let r=ot(i&&i.target,i);return r===void 0&&(r=!!e.backgroundColor),r===!1||r===null?!1:r===!0?"origin":r}function spt(t){const{scale:e,index:i,line:r}=t,n=[],s=r.segments,o=r.points,a=opt(e,i);a.push(_we({x:null,y:e.bottom},r));for(let l=0;l<s.length;l++){const c=s[l];for(let u=c.start;u<=c.end;u++)apt(n,o[u],a)}return new Gm({points:n,options:{}})}function opt(t,e){const i=[],r=t.getMatchingVisibleMetas("line");for(let n=0;n<r.length;n++){const s=r[n];if(s.index===e)break;s.hidden||i.unshift(s.dataset)}return i}function apt(t,e,i){const r=[];for(let n=0;n<i.length;n++){const s=i[n],{first:o,last:a,point:l}=lpt(s,e,"x");if(!(!l||o&&a)){if(o)r.unshift(l);else if(t.push(l),!a)break}}t.push(...r)}function lpt(t,e,i){const r=t.interpolate(e,i);if(!r)return{};const n=r[i],s=t.segments,o=t.points;let a=!1,l=!1;for(let c=0;c<s.length;c++){const u=s[c],h=o[u.start][i],f=o[u.end][i];if(Qh(n,h,f)){a=n===h,l=n===f;break}}return{first:a,last:l,point:r}}class bwe{constructor(e){this.x=e.x,this.y=e.y,this.radius=e.radius}pathSegment(e,i,r){const{x:n,y:s,radius:o}=this;return i=i||{start:0,end:ar},e.arc(n,s,o,i.end,i.start,!0),!r.bounds}interpolate(e){const{x:i,y:r,radius:n}=this,s=e.angle;return{x:i+Math.cos(s)*n,y:r+Math.sin(s)*n,angle:s}}}function cpt(t){const{chart:e,fill:i,line:r}=t;if(Gr(i))return upt(e,i);if(i==="stack")return spt(t);if(i==="shape")return!0;const n=dpt(t);return n instanceof bwe?n:_we(n,r)}function upt(t,e){const i=t.getDatasetMeta(e);return i&&t.isDatasetVisible(e)?i.dataset:null}function dpt(t){return(t.scale||{}).getPointPositionForValue?ppt(t):hpt(t)}function hpt(t){const{scale:e={},fill:i}=t,r=ipt(i,e);if(Gr(r)){const n=e.isHorizontal();return{x:n?r:null,y:n?null:r}}return null}function ppt(t){const{scale:e,fill:i}=t,r=e.options,n=e.getLabels().length,s=r.reverse?e.max:e.min,o=rpt(i,e,s),a=[];if(r.grid.circular){const l=e.getPointPositionForValue(0,s);return new bwe({x:l.x,y:l.y,radius:e.getDistanceFromCenterForValue(o)})}for(let l=0;l<n;++l)a.push(e.getPointPositionForValue(l,o));return a}function mD(t,e,i){const r=cpt(e),{line:n,scale:s,axis:o}=e,a=n.options,l=a.fill,c=a.backgroundColor,{above:u=c,below:h=c}=l||{};r&&n.points.length&&(VR(t,i),fpt(t,{line:n,target:r,above:u,below:h,area:i,scale:s,axis:o}),zR(t))}function fpt(t,e){const{line:i,target:r,above:n,below:s,area:o,scale:a}=e,l=i._loop?"angle":e.axis;t.save(),l==="x"&&s!==n&&(Bie(t,r,o.top),Uie(t,{line:i,target:r,color:n,scale:a,property:l}),t.restore(),t.save(),Bie(t,r,o.bottom)),Uie(t,{line:i,target:r,color:s,scale:a,property:l}),t.restore()}function Bie(t,e,i){const{segments:r,points:n}=e;let s=!0,o=!1;t.beginPath();for(const a of r){const{start:l,end:c}=a,u=n[l],h=n[hH(l,c,n)];s?(t.moveTo(u.x,u.y),s=!1):(t.lineTo(u.x,i),t.lineTo(u.x,u.y)),o=!!e.pathSegment(t,a,{move:o}),o?t.closePath():t.lineTo(h.x,i)}t.lineTo(e.first().x,i),t.closePath(),t.clip()}function Uie(t,e){const{line:i,target:r,property:n,color:s,scale:o}=e,a=Kht(i,r,n);for(const{source:l,target:c,start:u,end:h}of a){const{style:{backgroundColor:f=s}={}}=l,m=r!==!0;t.save(),t.fillStyle=f,mpt(t,o,m&&T6(n,u,h)),t.beginPath();const g=!!i.pathSegment(t,l);let y;if(m){g?t.closePath():Gie(t,r,h,n);const v=!!r.pathSegment(t,c,{move:g,reverse:!0});y=g&&v,y||Gie(t,r,u,n)}t.closePath(),t.fill(y?"evenodd":"nonzero"),t.restore()}}function mpt(t,e,i){const{top:r,bottom:n}=e.chart.chartArea,{property:s,start:o,end:a}=i||{};s==="x"&&(t.beginPath(),t.rect(o,r,a-o,n-r),t.clip())}function Gie(t,e,i,r){const n=e.interpolate(i,r);n&&t.lineTo(n.x,n.y)}var gpt={id:"filler",afterDatasetsUpdate(t,e,i){const r=(t.data.datasets||[]).length,n=[];let s,o,a,l;for(o=0;o<r;++o)s=t.getDatasetMeta(o),a=s.dataset,l=null,a&&a.options&&a instanceof Gm&&(l={visible:t.isDatasetVisible(o),index:o,fill:ept(a,o,r),chart:t,axis:s.controller.options.indexAxis,scale:s.vScale,line:a}),s.$filler=l,n.push(l);for(o=0;o<r;++o)l=n[o],!(!l||l.fill===!1)&&(l.fill=Qht(n,o,i.propagate))},beforeDraw(t,e,i){const r=i.drawTime==="beforeDraw",n=t.getSortedVisibleDatasetMetas(),s=t.chartArea;for(let o=n.length-1;o>=0;--o){const a=n[o].$filler;a&&(a.line.updateControlPoints(s,a.axis),r&&a.fill&&mD(t.ctx,a,s))}},beforeDatasetsDraw(t,e,i){if(i.drawTime!=="beforeDatasetsDraw")return;const r=t.getSortedVisibleDatasetMetas();for(let n=r.length-1;n>=0;--n){const s=r[n].$filler;jie(s)&&mD(t.ctx,s,t.chartArea)}},beforeDatasetDraw(t,e,i){const r=e.meta.$filler;!jie(r)||i.drawTime!=="beforeDatasetDraw"||mD(t.ctx,r,t.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const Hie=(t,e)=>{let{boxHeight:i=e,boxWidth:r=e}=t;return t.usePointStyle&&(i=Math.min(i,e),r=t.pointStyleWidth||Math.min(r,e)),{boxWidth:r,boxHeight:i,itemHeight:Math.max(e,i)}},ypt=(t,e)=>t!==null&&e!==null&&t.datasetIndex===e.datasetIndex&&t.index===e.index;class qie extends Lp{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,i,r){this.maxWidth=e,this.maxHeight=i,this._margins=r,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let i=ct(e.generateLabels,[this.chart],this)||[];e.filter&&(i=i.filter(r=>e.filter(r,this.chart.data))),e.sort&&(i=i.sort((r,n)=>e.sort(r,n,this.chart.data))),this.options.reverse&&i.reverse(),this.legendItems=i}fit(){const{options:e,ctx:i}=this;if(!e.display){this.width=this.height=0;return}const r=e.labels,n=Jn(r.font),s=n.size,o=this._computeTitleHeight(),{boxWidth:a,itemHeight:l}=Hie(r,s);let c,u;i.font=n.string,this.isHorizontal()?(c=this.maxWidth,u=this._fitRows(o,s,a,l)+10):(u=this.maxHeight,c=this._fitCols(o,n,a,l)+10),this.width=Math.min(c,e.maxWidth||this.maxWidth),this.height=Math.min(u,e.maxHeight||this.maxHeight)}_fitRows(e,i,r,n){const{ctx:s,maxWidth:o,options:{labels:{padding:a}}}=this,l=this.legendHitBoxes=[],c=this.lineWidths=[0],u=n+a;let h=e;s.textAlign="left",s.textBaseline="middle";let f=-1,m=-u;return this.legendItems.forEach((g,y)=>{const v=r+i/2+s.measureText(g.text).width;(y===0||c[c.length-1]+v+2*a>o)&&(h+=u,c[c.length-(y>0?0:1)]=0,m+=u,f++),l[y]={left:0,top:m,row:f,width:v,height:n},c[c.length-1]+=v+a}),h}_fitCols(e,i,r,n){const{ctx:s,maxHeight:o,options:{labels:{padding:a}}}=this,l=this.legendHitBoxes=[],c=this.columnSizes=[],u=o-e;let h=a,f=0,m=0,g=0,y=0;return this.legendItems.forEach((v,b)=>{const{itemWidth:w,itemHeight:x}=vpt(r,i,s,v,n);b>0&&m+x+2*a>u&&(h+=f+a,c.push({width:f,height:m}),g+=f+a,y++,f=m=0),l[b]={left:g,top:m,col:y,width:w,height:x},f=Math.max(f,w),m+=x+a}),h+=f,c.push({width:f,height:m}),h}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:i,options:{align:r,labels:{padding:n},rtl:s}}=this,o=qw(s,this.left,this.width);if(this.isHorizontal()){let a=0,l=eo(r,this.left+n,this.right-this.lineWidths[a]);for(const c of i)a!==c.row&&(a=c.row,l=eo(r,this.left+n,this.right-this.lineWidths[a])),c.top+=this.top+e+n,c.left=o.leftForLtr(o.x(l),c.width),l+=c.width+n}else{let a=0,l=eo(r,this.top+e+n,this.bottom-this.columnSizes[a].height);for(const c of i)c.col!==a&&(a=c.col,l=eo(r,this.top+e+n,this.bottom-this.columnSizes[a].height)),c.top=l,c.left+=this.left+n,c.left=o.leftForLtr(o.x(c.left),c.width),l+=c.height+n}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;VR(e,this),this._draw(),zR(e)}}_draw(){const{options:e,columnSizes:i,lineWidths:r,ctx:n}=this,{align:s,labels:o}=e,a=qr.color,l=qw(e.rtl,this.left,this.width),c=Jn(o.font),{padding:u}=o,h=c.size,f=h/2;let m;this.drawTitle(),n.textAlign=l.textAlign("left"),n.textBaseline="middle",n.lineWidth=.5,n.font=c.string;const{boxWidth:g,boxHeight:y,itemHeight:v}=Hie(o,h),b=function(T,C,E){if(isNaN(g)||g<=0||isNaN(y)||y<0)return;n.save();const $=ot(E.lineWidth,1);if(n.fillStyle=ot(E.fillStyle,a),n.lineCap=ot(E.lineCap,"butt"),n.lineDashOffset=ot(E.lineDashOffset,0),n.lineJoin=ot(E.lineJoin,"miter"),n.lineWidth=$,n.strokeStyle=ot(E.strokeStyle,a),n.setLineDash(ot(E.lineDash,[])),o.usePointStyle){const P={radius:y*Math.SQRT2/2,pointStyle:E.pointStyle,rotation:E.rotation,borderWidth:$},k=l.xPlus(T,g/2),L=C+f;jbe(n,P,k,L,o.pointStyleWidth&&g)}else{const P=C+Math.max((h-y)/2,0),k=l.leftForLtr(T,g),L=mv(E.borderRadius);n.beginPath(),Object.values(L).some(F=>F!==0)?UT(n,{x:k,y:P,w:g,h:y,radius:L}):n.rect(k,P,g,y),n.fill(),$!==0&&n.stroke()}n.restore()},w=function(T,C,E){zv(n,E.text,T,C+v/2,c,{strikethrough:E.hidden,textAlign:l.textAlign(E.textAlign)})},x=this.isHorizontal(),S=this._computeTitleHeight();x?m={x:eo(s,this.left+u,this.right-r[0]),y:this.top+u+S,line:0}:m={x:this.left+u,y:eo(s,this.top+S+u,this.bottom-i[0].height),line:0},Ybe(this.ctx,e.textDirection);const I=v+u;this.legendItems.forEach((T,C)=>{n.strokeStyle=T.fontColor,n.fillStyle=T.fontColor;const E=n.measureText(T.text).width,$=l.textAlign(T.textAlign||(T.textAlign=o.textAlign)),P=g+f+E;let k=m.x,L=m.y;l.setWidth(this.width),x?C>0&&k+P+u>this.right&&(L=m.y+=I,m.line++,k=m.x=eo(s,this.left+u,this.right-r[m.line])):C>0&&L+I>this.bottom&&(k=m.x=k+i[m.line].width+u,m.line++,L=m.y=eo(s,this.top+S+u,this.bottom-i[m.line].height));const F=l.x(k);if(b(F,L,T),k=Vct($,k+g+f,x?k+P:this.right,e.rtl),w(l.x(k),L,T),x)m.x+=P+u;else if(typeof T.text!="string"){const V=c.lineHeight;m.y+=wwe(T,V)}else m.y+=I}),Kbe(this.ctx,e.textDirection)}drawTitle(){const e=this.options,i=e.title,r=Jn(i.font),n=fo(i.padding);if(!i.display)return;const s=qw(e.rtl,this.left,this.width),o=this.ctx,a=i.position,l=r.size/2,c=n.top+l;let u,h=this.left,f=this.width;if(this.isHorizontal())f=Math.max(...this.lineWidths),u=this.top+c,h=eo(e.align,h,this.right-f);else{const g=this.columnSizes.reduce((y,v)=>Math.max(y,v.height),0);u=c+eo(e.align,this.top,this.bottom-g-e.labels.padding-this._computeTitleHeight())}const m=eo(a,h,h+f);o.textAlign=s.textAlign(nH(a)),o.textBaseline="middle",o.strokeStyle=i.color,o.fillStyle=i.color,o.font=r.string,zv(o,i.text,m,u,r)}_computeTitleHeight(){const e=this.options.title,i=Jn(e.font),r=fo(e.padding);return e.display?i.lineHeight+r.height:0}_getLegendItemAt(e,i){let r,n,s;if(Qh(e,this.left,this.right)&&Qh(i,this.top,this.bottom)){for(s=this.legendHitBoxes,r=0;r<s.length;++r)if(n=s[r],Qh(e,n.left,n.left+n.width)&&Qh(i,n.top,n.top+n.height))return this.legendItems[r]}return null}handleEvent(e){const i=this.options;if(!wpt(e.type,i))return;const r=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const n=this._hoveredItem,s=ypt(n,r);n&&!s&&ct(i.onLeave,[e,n,this],this),this._hoveredItem=r,r&&!s&&ct(i.onHover,[e,r,this],this)}else r&&ct(i.onClick,[e,r,this],this)}}function vpt(t,e,i,r,n){const s=_pt(r,t,e,i),o=bpt(n,r,e.lineHeight);return{itemWidth:s,itemHeight:o}}function _pt(t,e,i,r){let n=t.text;return n&&typeof n!="string"&&(n=n.reduce((s,o)=>s.length>o.length?s:o)),e+i.size/2+r.measureText(n).width}function bpt(t,e,i){let r=t;return typeof e.text!="string"&&(r=wwe(e,i)),r}function wwe(t,e){const i=t.text?t.text.length+.5:0;return e*i}function wpt(t,e){return!!((t==="mousemove"||t==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(t==="click"||t==="mouseup"))}var xpt={id:"legend",_element:qie,start(t,e,i){const r=t.legend=new qie({ctx:t.ctx,options:i,chart:t});ao.configure(t,r,i),ao.addBox(t,r)},stop(t){ao.removeBox(t,t.legend),delete t.legend},beforeUpdate(t,e,i){const r=t.legend;ao.configure(t,r,i),r.options=i},afterUpdate(t){const e=t.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(t,e){e.replay||t.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(t,e,i){const r=e.datasetIndex,n=i.chart;n.isDatasetVisible(r)?(n.hide(r),e.hidden=!0):(n.show(r),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:t=>t.chart.options.color,boxWidth:40,padding:10,generateLabels(t){const e=t.data.datasets,{labels:{usePointStyle:i,pointStyle:r,textAlign:n,color:s,useBorderRadius:o,borderRadius:a}}=t.legend.options;return t._getSortedDatasetMetas().map(l=>{const c=l.controller.getStyle(i?0:void 0),u=fo(c.borderWidth);return{text:e[l.index].label,fillStyle:c.backgroundColor,fontColor:s,hidden:!l.visible,lineCap:c.borderCapStyle,lineDash:c.borderDash,lineDashOffset:c.borderDashOffset,lineJoin:c.borderJoinStyle,lineWidth:(u.width+u.height)/4,strokeStyle:c.borderColor,pointStyle:r||c.pointStyle,rotation:c.rotation,textAlign:n||c.textAlign,borderRadius:o&&(a||c.borderRadius),datasetIndex:l.index}},this)}},title:{color:t=>t.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:t=>!t.startsWith("on"),labels:{_scriptable:t=>!["generateLabels","filter","sort"].includes(t)}}};class pH extends Lp{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,i){const r=this.options;if(this.left=0,this.top=0,!r.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=e,this.height=this.bottom=i;const n=sr(r.text)?r.text.length:1;this._padding=fo(r.padding);const s=n*Jn(r.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=s:this.width=s}isHorizontal(){const e=this.options.position;return e==="top"||e==="bottom"}_drawArgs(e){const{top:i,left:r,bottom:n,right:s,options:o}=this,a=o.align;let l=0,c,u,h;return this.isHorizontal()?(u=eo(a,r,s),h=i+e,c=s-r):(o.position==="left"?(u=r+e,h=eo(a,n,i),l=Tr*-.5):(u=s-e,h=eo(a,i,n),l=Tr*.5),c=n-i),{titleX:u,titleY:h,maxWidth:c,rotation:l}}draw(){const e=this.ctx,i=this.options;if(!i.display)return;const r=Jn(i.font),s=r.lineHeight/2+this._padding.top,{titleX:o,titleY:a,maxWidth:l,rotation:c}=this._drawArgs(s);zv(e,i.text,0,0,r,{color:i.color,maxWidth:l,rotation:c,textAlign:nH(i.align),textBaseline:"middle",translation:[o,a]})}}function Spt(t,e){const i=new pH({ctx:t.ctx,options:e,chart:t});ao.configure(t,i,e),ao.addBox(t,i),t.titleBlock=i}var Ipt={id:"title",_element:pH,start(t,e,i){Spt(t,i)},stop(t){const e=t.titleBlock;ao.removeBox(t,e),delete t.titleBlock},beforeUpdate(t,e,i){const r=t.titleBlock;ao.configure(t,r,i),r.options=i},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const m$=new WeakMap;var Tpt={id:"subtitle",start(t,e,i){const r=new pH({ctx:t.ctx,options:i,chart:t});ao.configure(t,r,i),ao.addBox(t,r),m$.set(t,r)},stop(t){ao.removeBox(t,m$.get(t)),m$.delete(t)},beforeUpdate(t,e,i){const r=m$.get(t);ao.configure(t,r,i),r.options=i},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const V2={average(t){if(!t.length)return!1;let e,i,r=0,n=0,s=0;for(e=0,i=t.length;e<i;++e){const o=t[e].element;if(o&&o.hasValue()){const a=o.tooltipPosition();r+=a.x,n+=a.y,++s}}return{x:r/s,y:n/s}},nearest(t,e){if(!t.length)return!1;let i=e.x,r=e.y,n=Number.POSITIVE_INFINITY,s,o,a;for(s=0,o=t.length;s<o;++s){const l=t[s].element;if(l&&l.hasValue()){const c=l.getCenterPoint(),u=y6(e,c);u<n&&(n=u,a=l)}}if(a){const l=a.tooltipPosition();i=l.x,r=l.y}return{x:i,y:r}}};function dd(t,e){return e&&(sr(e)?Array.prototype.push.apply(t,e):t.push(e)),t}function Dh(t){return(typeof t=="string"||t instanceof String)&&t.indexOf(`
`)>-1?t.split(`
`):t}function Cpt(t,e){const{element:i,datasetIndex:r,index:n}=e,s=t.getDatasetMeta(r).controller,{label:o,value:a}=s.getLabelAndValue(n);return{chart:t,label:o,parsed:s.getParsed(n),raw:t.data.datasets[r].data[n],formattedValue:a,dataset:s.getDataset(),dataIndex:n,datasetIndex:r,element:i}}function Wie(t,e){const i=t.chart.ctx,{body:r,footer:n,title:s}=t,{boxWidth:o,boxHeight:a}=e,l=Jn(e.bodyFont),c=Jn(e.titleFont),u=Jn(e.footerFont),h=s.length,f=n.length,m=r.length,g=fo(e.padding);let y=g.height,v=0,b=r.reduce((S,I)=>S+I.before.length+I.lines.length+I.after.length,0);if(b+=t.beforeBody.length+t.afterBody.length,h&&(y+=h*c.lineHeight+(h-1)*e.titleSpacing+e.titleMarginBottom),b){const S=e.displayColors?Math.max(a,l.lineHeight):l.lineHeight;y+=m*S+(b-m)*l.lineHeight+(b-1)*e.bodySpacing}f&&(y+=e.footerMarginTop+f*u.lineHeight+(f-1)*e.footerSpacing);let w=0;const x=function(S){v=Math.max(v,i.measureText(S).width+w)};return i.save(),i.font=c.string,Ot(t.title,x),i.font=l.string,Ot(t.beforeBody.concat(t.afterBody),x),w=e.displayColors?o+2+e.boxPadding:0,Ot(r,S=>{Ot(S.before,x),Ot(S.lines,x),Ot(S.after,x)}),w=0,i.font=u.string,Ot(t.footer,x),i.restore(),v+=g.width,{width:v,height:y}}function Ept(t,e){const{y:i,height:r}=e;return i<r/2?"top":i>t.height-r/2?"bottom":"center"}function Mpt(t,e,i,r){const{x:n,width:s}=r,o=i.caretSize+i.caretPadding;if(t==="left"&&n+s+o>e.width||t==="right"&&n-s-o<0)return!0}function $pt(t,e,i,r){const{x:n,width:s}=i,{width:o,chartArea:{left:a,right:l}}=t;let c="center";return r==="center"?c=n<=(a+l)/2?"left":"right":n<=s/2?c="left":n>=o-s/2&&(c="right"),Mpt(c,t,e,i)&&(c="center"),c}function Jie(t,e,i){const r=i.yAlign||e.yAlign||Ept(t,i);return{xAlign:i.xAlign||e.xAlign||$pt(t,e,i,r),yAlign:r}}function Apt(t,e){let{x:i,width:r}=t;return e==="right"?i-=r:e==="center"&&(i-=r/2),i}function kpt(t,e,i){let{y:r,height:n}=t;return e==="top"?r+=i:e==="bottom"?r-=n+i:r-=n/2,r}function Zie(t,e,i,r){const{caretSize:n,caretPadding:s,cornerRadius:o}=t,{xAlign:a,yAlign:l}=i,c=n+s,{topLeft:u,topRight:h,bottomLeft:f,bottomRight:m}=mv(o);let g=Apt(e,a);const y=kpt(e,l,c);return l==="center"?a==="left"?g+=c:a==="right"&&(g-=c):a==="left"?g-=Math.max(u,f)+n:a==="right"&&(g+=Math.max(h,m)+n),{x:fs(g,0,r.width-e.width),y:fs(y,0,r.height-e.height)}}function g$(t,e,i){const r=fo(i.padding);return e==="center"?t.x+t.width/2:e==="right"?t.x+t.width-r.right:t.x+r.left}function Yie(t){return dd([],Dh(t))}function Ppt(t,e,i){return Pg(t,{tooltip:e,tooltipItems:i,type:"tooltip"})}function Kie(t,e){const i=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return i?t.override(i):t}const xwe={beforeTitle:ah,title(t){if(t.length>0){const e=t[0],i=e.chart.data.labels,r=i?i.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(r>0&&e.dataIndex<r)return i[e.dataIndex]}return""},afterTitle:ah,beforeBody:ah,beforeLabel:ah,label(t){if(this&&this.options&&this.options.mode==="dataset")return t.label+": "+t.formattedValue||t.formattedValue;let e=t.dataset.label||"";e&&(e+=": ");const i=t.formattedValue;return ei(i)||(e+=i),e},labelColor(t){const i=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{borderColor:i.borderColor,backgroundColor:i.backgroundColor,borderWidth:i.borderWidth,borderDash:i.borderDash,borderDashOffset:i.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(t){const i=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{pointStyle:i.pointStyle,rotation:i.rotation}},afterLabel:ah,afterBody:ah,beforeFooter:ah,footer:ah,afterFooter:ah};function Xo(t,e,i,r){const n=t[e].call(i,r);return typeof n>"u"?xwe[e].call(i,r):n}class C6 extends Lp{constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const i=this.chart,r=this.options.setContext(this.getContext()),n=r.enabled&&i.options.animation&&r.animations,s=new twe(this.chart,n);return n._cacheable&&(this._cachedAnimations=Object.freeze(s)),s}getContext(){return this.$context||(this.$context=Ppt(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,i){const{callbacks:r}=i,n=Xo(r,"beforeTitle",this,e),s=Xo(r,"title",this,e),o=Xo(r,"afterTitle",this,e);let a=[];return a=dd(a,Dh(n)),a=dd(a,Dh(s)),a=dd(a,Dh(o)),a}getBeforeBody(e,i){return Yie(Xo(i.callbacks,"beforeBody",this,e))}getBody(e,i){const{callbacks:r}=i,n=[];return Ot(e,s=>{const o={before:[],lines:[],after:[]},a=Kie(r,s);dd(o.before,Dh(Xo(a,"beforeLabel",this,s))),dd(o.lines,Xo(a,"label",this,s)),dd(o.after,Dh(Xo(a,"afterLabel",this,s))),n.push(o)}),n}getAfterBody(e,i){return Yie(Xo(i.callbacks,"afterBody",this,e))}getFooter(e,i){const{callbacks:r}=i,n=Xo(r,"beforeFooter",this,e),s=Xo(r,"footer",this,e),o=Xo(r,"afterFooter",this,e);let a=[];return a=dd(a,Dh(n)),a=dd(a,Dh(s)),a=dd(a,Dh(o)),a}_createItems(e){const i=this._active,r=this.chart.data,n=[],s=[],o=[];let a=[],l,c;for(l=0,c=i.length;l<c;++l)a.push(Cpt(this.chart,i[l]));return e.filter&&(a=a.filter((u,h,f)=>e.filter(u,h,f,r))),e.itemSort&&(a=a.sort((u,h)=>e.itemSort(u,h,r))),Ot(a,u=>{const h=Kie(e.callbacks,u);n.push(Xo(h,"labelColor",this,u)),s.push(Xo(h,"labelPointStyle",this,u)),o.push(Xo(h,"labelTextColor",this,u))}),this.labelColors=n,this.labelPointStyles=s,this.labelTextColors=o,this.dataPoints=a,a}update(e,i){const r=this.options.setContext(this.getContext()),n=this._active;let s,o=[];if(!n.length)this.opacity!==0&&(s={opacity:0});else{const a=V2[r.position].call(this,n,this._eventPosition);o=this._createItems(r),this.title=this.getTitle(o,r),this.beforeBody=this.getBeforeBody(o,r),this.body=this.getBody(o,r),this.afterBody=this.getAfterBody(o,r),this.footer=this.getFooter(o,r);const l=this._size=Wie(this,r),c=Object.assign({},a,l),u=Jie(this.chart,r,c),h=Zie(r,c,u,this.chart);this.xAlign=u.xAlign,this.yAlign=u.yAlign,s={opacity:1,x:h.x,y:h.y,width:l.width,height:l.height,caretX:a.x,caretY:a.y}}this._tooltipItems=o,this.$context=void 0,s&&this._resolveAnimations().update(this,s),e&&r.external&&r.external.call(this,{chart:this.chart,tooltip:this,replay:i})}drawCaret(e,i,r,n){const s=this.getCaretPosition(e,r,n);i.lineTo(s.x1,s.y1),i.lineTo(s.x2,s.y2),i.lineTo(s.x3,s.y3)}getCaretPosition(e,i,r){const{xAlign:n,yAlign:s}=this,{caretSize:o,cornerRadius:a}=r,{topLeft:l,topRight:c,bottomLeft:u,bottomRight:h}=mv(a),{x:f,y:m}=e,{width:g,height:y}=i;let v,b,w,x,S,I;return s==="center"?(S=m+y/2,n==="left"?(v=f,b=v-o,x=S+o,I=S-o):(v=f+g,b=v+o,x=S-o,I=S+o),w=v):(n==="left"?b=f+Math.max(l,u)+o:n==="right"?b=f+g-Math.max(c,h)-o:b=this.caretX,s==="top"?(x=m,S=x-o,v=b-o,w=b+o):(x=m+y,S=x+o,v=b+o,w=b-o),I=x),{x1:v,x2:b,x3:w,y1:x,y2:S,y3:I}}drawTitle(e,i,r){const n=this.title,s=n.length;let o,a,l;if(s){const c=qw(r.rtl,this.x,this.width);for(e.x=g$(this,r.titleAlign,r),i.textAlign=c.textAlign(r.titleAlign),i.textBaseline="middle",o=Jn(r.titleFont),a=r.titleSpacing,i.fillStyle=r.titleColor,i.font=o.string,l=0;l<s;++l)i.fillText(n[l],c.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+a,l+1===s&&(e.y+=r.titleMarginBottom-a)}}_drawColorBox(e,i,r,n,s){const o=this.labelColors[r],a=this.labelPointStyles[r],{boxHeight:l,boxWidth:c}=s,u=Jn(s.bodyFont),h=g$(this,"left",s),f=n.x(h),m=l<u.lineHeight?(u.lineHeight-l)/2:0,g=i.y+m;if(s.usePointStyle){const y={radius:Math.min(c,l)/2,pointStyle:a.pointStyle,rotation:a.rotation,borderWidth:1},v=n.leftForLtr(f,c)+c/2,b=g+l/2;e.strokeStyle=s.multiKeyBackground,e.fillStyle=s.multiKeyBackground,_6(e,y,v,b),e.strokeStyle=o.borderColor,e.fillStyle=o.backgroundColor,_6(e,y,v,b)}else{e.lineWidth=Ft(o.borderWidth)?Math.max(...Object.values(o.borderWidth)):o.borderWidth||1,e.strokeStyle=o.borderColor,e.setLineDash(o.borderDash||[]),e.lineDashOffset=o.borderDashOffset||0;const y=n.leftForLtr(f,c),v=n.leftForLtr(n.xPlus(f,1),c-2),b=mv(o.borderRadius);Object.values(b).some(w=>w!==0)?(e.beginPath(),e.fillStyle=s.multiKeyBackground,UT(e,{x:y,y:g,w:c,h:l,radius:b}),e.fill(),e.stroke(),e.fillStyle=o.backgroundColor,e.beginPath(),UT(e,{x:v,y:g+1,w:c-2,h:l-2,radius:b}),e.fill()):(e.fillStyle=s.multiKeyBackground,e.fillRect(y,g,c,l),e.strokeRect(y,g,c,l),e.fillStyle=o.backgroundColor,e.fillRect(v,g+1,c-2,l-2))}e.fillStyle=this.labelTextColors[r]}drawBody(e,i,r){const{body:n}=this,{bodySpacing:s,bodyAlign:o,displayColors:a,boxHeight:l,boxWidth:c,boxPadding:u}=r,h=Jn(r.bodyFont);let f=h.lineHeight,m=0;const g=qw(r.rtl,this.x,this.width),y=function(E){i.fillText(E,g.x(e.x+m),e.y+f/2),e.y+=f+s},v=g.textAlign(o);let b,w,x,S,I,T,C;for(i.textAlign=o,i.textBaseline="middle",i.font=h.string,e.x=g$(this,v,r),i.fillStyle=r.bodyColor,Ot(this.beforeBody,y),m=a&&v!=="right"?o==="center"?c/2+u:c+2+u:0,S=0,T=n.length;S<T;++S){for(b=n[S],w=this.labelTextColors[S],i.fillStyle=w,Ot(b.before,y),x=b.lines,a&&x.length&&(this._drawColorBox(i,e,S,g,r),f=Math.max(h.lineHeight,l)),I=0,C=x.length;I<C;++I)y(x[I]),f=h.lineHeight;Ot(b.after,y)}m=0,f=h.lineHeight,Ot(this.afterBody,y),e.y-=s}drawFooter(e,i,r){const n=this.footer,s=n.length;let o,a;if(s){const l=qw(r.rtl,this.x,this.width);for(e.x=g$(this,r.footerAlign,r),e.y+=r.footerMarginTop,i.textAlign=l.textAlign(r.footerAlign),i.textBaseline="middle",o=Jn(r.footerFont),i.fillStyle=r.footerColor,i.font=o.string,a=0;a<s;++a)i.fillText(n[a],l.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+r.footerSpacing}}drawBackground(e,i,r,n){const{xAlign:s,yAlign:o}=this,{x:a,y:l}=e,{width:c,height:u}=r,{topLeft:h,topRight:f,bottomLeft:m,bottomRight:g}=mv(n.cornerRadius);i.fillStyle=n.backgroundColor,i.strokeStyle=n.borderColor,i.lineWidth=n.borderWidth,i.beginPath(),i.moveTo(a+h,l),o==="top"&&this.drawCaret(e,i,r,n),i.lineTo(a+c-f,l),i.quadraticCurveTo(a+c,l,a+c,l+f),o==="center"&&s==="right"&&this.drawCaret(e,i,r,n),i.lineTo(a+c,l+u-g),i.quadraticCurveTo(a+c,l+u,a+c-g,l+u),o==="bottom"&&this.drawCaret(e,i,r,n),i.lineTo(a+m,l+u),i.quadraticCurveTo(a,l+u,a,l+u-m),o==="center"&&s==="left"&&this.drawCaret(e,i,r,n),i.lineTo(a,l+h),i.quadraticCurveTo(a,l,a+h,l),i.closePath(),i.fill(),n.borderWidth>0&&i.stroke()}_updateAnimationTarget(e){const i=this.chart,r=this.$animations,n=r&&r.x,s=r&&r.y;if(n||s){const o=V2[e.position].call(this,this._active,this._eventPosition);if(!o)return;const a=this._size=Wie(this,e),l=Object.assign({},o,this._size),c=Jie(i,e,l),u=Zie(e,l,c,i);(n._to!==u.x||s._to!==u.y)&&(this.xAlign=c.xAlign,this.yAlign=c.yAlign,this.width=a.width,this.height=a.height,this.caretX=o.x,this.caretY=o.y,this._resolveAnimations().update(this,u))}}_willRender(){return!!this.opacity}draw(e){const i=this.options.setContext(this.getContext());let r=this.opacity;if(!r)return;this._updateAnimationTarget(i);const n={width:this.width,height:this.height},s={x:this.x,y:this.y};r=Math.abs(r)<.001?0:r;const o=fo(i.padding),a=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;i.enabled&&a&&(e.save(),e.globalAlpha=r,this.drawBackground(s,e,n,i),Ybe(e,i.textDirection),s.y+=o.top,this.drawTitle(s,e,i),this.drawBody(s,e,i),this.drawFooter(s,e,i),Kbe(e,i.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,i){const r=this._active,n=e.map(({datasetIndex:a,index:l})=>{const c=this.chart.getDatasetMeta(a);if(!c)throw new Error("Cannot find a dataset at index "+a);return{datasetIndex:a,element:c.data[l],index:l}}),s=!kO(r,n),o=this._positionChanged(n,i);(s||o)&&(this._active=n,this._eventPosition=i,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,i,r=!0){if(i&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const n=this.options,s=this._active||[],o=this._getActiveElements(e,s,i,r),a=this._positionChanged(o,e),l=i||!kO(o,s)||a;return l&&(this._active=o,(n.enabled||n.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,i))),l}_getActiveElements(e,i,r,n){const s=this.options;if(e.type==="mouseout")return[];if(!n)return i;const o=this.chart.getElementsAtEventForMode(e,s.mode,s,r);return s.reverse&&o.reverse(),o}_positionChanged(e,i){const{caretX:r,caretY:n,options:s}=this,o=V2[s.position].call(this,e,i);return o!==!1&&(r!==o.x||n!==o.y)}}we(C6,"positioners",V2);var Opt={id:"tooltip",_element:C6,positioners:V2,afterInit(t,e,i){i&&(t.tooltip=new C6({chart:t,options:i}))},beforeUpdate(t,e,i){t.tooltip&&t.tooltip.initialize(i)},reset(t,e,i){t.tooltip&&t.tooltip.initialize(i)},afterDraw(t){const e=t.tooltip;if(e&&e._willRender()){const i={tooltip:e};if(t.notifyPlugins("beforeTooltipDraw",{...i,cancelable:!0})===!1)return;e.draw(t.ctx),t.notifyPlugins("afterTooltipDraw",i)}},afterEvent(t,e){if(t.tooltip){const i=e.replay;t.tooltip.handleEvent(e.event,i,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(t,e)=>e.bodyFont.size,boxWidth:(t,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:xwe},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:t=>t!=="filter"&&t!=="itemSort"&&t!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},Lpt=Object.freeze({__proto__:null,Colors:qht,Decimation:Yht,Filler:gpt,Legend:xpt,SubTitle:Tpt,Title:Ipt,Tooltip:Opt});const Rpt=(t,e,i,r)=>(typeof e=="string"?(i=t.push(e)-1,r.unshift({index:i,label:e})):isNaN(e)&&(i=null),i);function Fpt(t,e,i,r){const n=t.indexOf(e);if(n===-1)return Rpt(t,e,i,r);const s=t.lastIndexOf(e);return n!==s?i:n}const Dpt=(t,e)=>t===null?null:fs(Math.round(t),0,e);function Xie(t){const e=this.getLabels();return t>=0&&t<e.length?e[t]:t}class E6 extends i_{constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const i=this._addedLabels;if(i.length){const r=this.getLabels();for(const{index:n,label:s}of i)r[n]===s&&r.splice(n,1);this._addedLabels=[]}super.init(e)}parse(e,i){if(ei(e))return null;const r=this.getLabels();return i=isFinite(i)&&r[i]===e?i:Fpt(r,e,ot(i,e),this._addedLabels),Dpt(i,r.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:i}=this.getUserBounds();let{min:r,max:n}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(r=0),i||(n=this.getLabels().length-1)),this.min=r,this.max=n}buildTicks(){const e=this.min,i=this.max,r=this.options.offset,n=[];let s=this.getLabels();s=e===0&&i===s.length-1?s:s.slice(e,i+1),this._valueRange=Math.max(s.length-(r?0:1),1),this._startValue=this.min-(r?.5:0);for(let o=e;o<=i;o++)n.push({value:o});return n}getLabelForValue(e){return Xie.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const i=this.ticks;return e<0||e>i.length-1?null:this.getPixelForValue(i[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}we(E6,"id","category"),we(E6,"defaults",{ticks:{callback:Xie}});function Npt(t,e){const i=[],{bounds:n,step:s,min:o,max:a,precision:l,count:c,maxTicks:u,maxDigits:h,includeBounds:f}=t,m=s||1,g=u-1,{min:y,max:v}=e,b=!ei(o),w=!ei(a),x=!ei(c),S=(v-y)/(h+1);let I=qte((v-y)/g/m)*m,T,C,E,$;if(I<1e-14&&!b&&!w)return[{value:y},{value:v}];$=Math.ceil(v/I)-Math.floor(y/I),$>g&&(I=qte($*I/g/m)*m),ei(l)||(T=Math.pow(10,l),I=Math.ceil(I*T)/T),n==="ticks"?(C=Math.floor(y/I)*I,E=Math.ceil(v/I)*I):(C=y,E=v),b&&w&&s&&Pct((a-o)/s,I/1e3)?($=Math.round(Math.min((a-o)/I,u)),I=(a-o)/$,C=o,E=a):x?(C=b?o:C,E=w?a:E,$=c-1,I=(E-C)/$):($=(E-C)/I,PI($,Math.round($),I/1e3)?$=Math.round($):$=Math.ceil($));const P=Math.max(Wte(I),Wte(C));T=Math.pow(10,ei(l)?P:l),C=Math.round(C*T)/T,E=Math.round(E*T)/T;let k=0;for(b&&(f&&C!==o?(i.push({value:o}),C<o&&k++,PI(Math.round((C+k*I)*T)/T,o,Qie(o,S,t))&&k++):C<o&&k++);k<$;++k){const L=Math.round((C+k*I)*T)/T;if(w&&L>a)break;i.push({value:L})}return w&&f&&E!==a?i.length&&PI(i[i.length-1].value,a,Qie(a,S,t))?i[i.length-1].value=a:i.push({value:a}):(!w||E===a)&&i.push({value:E}),i}function Qie(t,e,{horizontal:i,minRotation:r}){const n=mu(r),s=(i?Math.sin(n):Math.cos(n))||.001,o=.75*e*(""+t).length;return Math.min(e/s,o)}class NO extends i_{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,i){return ei(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:i,maxDefined:r}=this.getUserBounds();let{min:n,max:s}=this;const o=l=>n=i?n:l,a=l=>s=r?s:l;if(e){const l=sc(n),c=sc(s);l<0&&c<0?a(0):l>0&&c>0&&o(0)}if(n===s){let l=s===0?1:Math.abs(s*.05);a(s+l),e||o(n-l)}this.min=n,this.max=s}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:i,stepSize:r}=e,n;return r?(n=Math.ceil(this.max/r)-Math.floor(this.min/r)+1,n>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${r} would result generating up to ${n} ticks. Limiting to 1000.`),n=1e3)):(n=this.computeTickLimit(),i=i||11),i&&(n=Math.min(i,n)),n}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,i=e.ticks;let r=this.getTickLimit();r=Math.max(2,r);const n={maxTicks:r,bounds:e.bounds,min:e.min,max:e.max,precision:i.precision,step:i.stepSize,count:i.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:i.minRotation||0,includeBounds:i.includeBounds!==!1},s=this._range||this,o=Npt(n,s);return e.bounds==="ticks"&&Pbe(o,this,"value"),e.reverse?(o.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),o}configure(){const e=this.ticks;let i=this.min,r=this.max;if(super.configure(),this.options.offset&&e.length){const n=(r-i)/Math.max(e.length-1,1)/2;i-=n,r+=n}this._startValue=i,this._endValue=r,this._valueRange=r-i}getLabelForValue(e){return tE(e,this.chart.options.locale,this.options.ticks.format)}}class M6 extends NO{determineDataLimits(){const{min:e,max:i}=this.getMinMax(!0);this.min=Gr(e)?e:0,this.max=Gr(i)?i:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),i=e?this.width:this.height,r=mu(this.options.ticks.minRotation),n=(e?Math.sin(r):Math.cos(r))||.001,s=this._resolveTickFontOptions(0);return Math.ceil(i/Math.min(40,s.lineHeight/n))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}we(M6,"id","linear"),we(M6,"defaults",{ticks:{callback:NR.formatters.numeric}});const HT=t=>Math.floor(Um(t)),sy=(t,e)=>Math.pow(10,HT(t)+e);function ere(t){return t/Math.pow(10,HT(t))===1}function tre(t,e,i){const r=Math.pow(10,i),n=Math.floor(t/r);return Math.ceil(e/r)-n}function Vpt(t,e){const i=e-t;let r=HT(i);for(;tre(t,e,r)>10;)r++;for(;tre(t,e,r)<10;)r--;return Math.min(r,HT(t))}function zpt(t,{min:e,max:i}){e=Wa(t.min,e);const r=[],n=HT(e);let s=Vpt(e,i),o=s<0?Math.pow(10,Math.abs(s)):1;const a=Math.pow(10,s),l=n>s?Math.pow(10,n):0,c=Math.round((e-l)*o)/o,u=Math.floor((e-l)/a/10)*a*10;let h=Math.floor((c-u)/Math.pow(10,s)),f=Wa(t.min,Math.round((l+u+h*Math.pow(10,s))*o)/o);for(;f<i;)r.push({value:f,major:ere(f),significand:h}),h>=10?h=h<15?15:20:h++,h>=20&&(s++,h=2,o=s>=0?1:o),f=Math.round((l+u+h*Math.pow(10,s))*o)/o;const m=Wa(t.max,f);return r.push({value:m,major:ere(m),significand:h}),r}class $6 extends i_{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(e,i){const r=NO.prototype.parse.apply(this,[e,i]);if(r===0){this._zero=!0;return}return Gr(r)&&r>0?r:null}determineDataLimits(){const{min:e,max:i}=this.getMinMax(!0);this.min=Gr(e)?Math.max(0,e):null,this.max=Gr(i)?Math.max(0,i):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!Gr(this._userMin)&&(this.min=e===sy(this.min,0)?sy(this.min,-1):sy(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:e,maxDefined:i}=this.getUserBounds();let r=this.min,n=this.max;const s=a=>r=e?r:a,o=a=>n=i?n:a;r===n&&(r<=0?(s(1),o(10)):(s(sy(r,-1)),o(sy(n,1)))),r<=0&&s(sy(n,-1)),n<=0&&o(sy(r,1)),this.min=r,this.max=n}buildTicks(){const e=this.options,i={min:this._userMin,max:this._userMax},r=zpt(i,this);return e.bounds==="ticks"&&Pbe(r,this,"value"),e.reverse?(r.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),r}getLabelForValue(e){return e===void 0?"0":tE(e,this.chart.options.locale,this.options.ticks.format)}configure(){const e=this.min;super.configure(),this._startValue=Um(e),this._valueRange=Um(this.max)-Um(e)}getPixelForValue(e){return(e===void 0||e===0)&&(e=this.min),e===null||isNaN(e)?NaN:this.getPixelForDecimal(e===this.min?0:(Um(e)-this._startValue)/this._valueRange)}getValueForPixel(e){const i=this.getDecimalForPixel(e);return Math.pow(10,this._startValue+i*this._valueRange)}}we($6,"id","logarithmic"),we($6,"defaults",{ticks:{callback:NR.formatters.logarithmic,major:{enabled:!0}}});function A6(t){const e=t.ticks;if(e.display&&t.display){const i=fo(e.backdropPadding);return ot(e.font&&e.font.size,qr.font.size)+i.height}return 0}function jpt(t,e,i){return i=sr(i)?i:[i],{w:Zct(t,e.string,i),h:i.length*e.lineHeight}}function ire(t,e,i,r,n){return t===r||t===n?{start:e-i/2,end:e+i/2}:t<r||t>n?{start:e-i,end:e}:{start:e,end:e+i}}function Bpt(t){const e={l:t.left+t._padding.left,r:t.right-t._padding.right,t:t.top+t._padding.top,b:t.bottom-t._padding.bottom},i=Object.assign({},e),r=[],n=[],s=t._pointLabels.length,o=t.options.pointLabels,a=o.centerPointLabels?Tr/s:0;for(let l=0;l<s;l++){const c=o.setContext(t.getPointLabelContext(l));n[l]=c.padding;const u=t.getPointPosition(l,t.drawingArea+n[l],a),h=Jn(c.font),f=jpt(t.ctx,h,t._pointLabels[l]);r[l]=f;const m=Ya(t.getIndexAngle(l)+a),g=Math.round(iH(m)),y=ire(g,u.x,f.w,0,180),v=ire(g,u.y,f.h,90,270);Upt(i,e,m,y,v)}t.setCenterPoint(e.l-i.l,i.r-e.r,e.t-i.t,i.b-e.b),t._pointLabelItems=qpt(t,r,n)}function Upt(t,e,i,r,n){const s=Math.abs(Math.sin(i)),o=Math.abs(Math.cos(i));let a=0,l=0;r.start<e.l?(a=(e.l-r.start)/s,t.l=Math.min(t.l,e.l-a)):r.end>e.r&&(a=(r.end-e.r)/s,t.r=Math.max(t.r,e.r+a)),n.start<e.t?(l=(e.t-n.start)/o,t.t=Math.min(t.t,e.t-l)):n.end>e.b&&(l=(n.end-e.b)/o,t.b=Math.max(t.b,e.b+l))}function Gpt(t,e,i){const r=t.drawingArea,{extra:n,additionalAngle:s,padding:o,size:a}=i,l=t.getPointPosition(e,r+n+o,s),c=Math.round(iH(Ya(l.angle+Hr))),u=Zpt(l.y,a.h,c),h=Wpt(c),f=Jpt(l.x,a.w,h);return{visible:!0,x:l.x,y:u,textAlign:h,left:f,top:u,right:f+a.w,bottom:u+a.h}}function Hpt(t,e){if(!e)return!0;const{left:i,top:r,right:n,bottom:s}=t;return!(tp({x:i,y:r},e)||tp({x:i,y:s},e)||tp({x:n,y:r},e)||tp({x:n,y:s},e))}function qpt(t,e,i){const r=[],n=t._pointLabels.length,s=t.options,{centerPointLabels:o,display:a}=s.pointLabels,l={extra:A6(s)/2,additionalAngle:o?Tr/n:0};let c;for(let u=0;u<n;u++){l.padding=i[u],l.size=e[u];const h=Gpt(t,u,l);r.push(h),a==="auto"&&(h.visible=Hpt(h,c),h.visible&&(c=h))}return r}function Wpt(t){return t===0||t===180?"center":t<180?"left":"right"}function Jpt(t,e,i){return i==="right"?t-=e:i==="center"&&(t-=e/2),t}function Zpt(t,e,i){return i===90||i===270?t-=e/2:(i>270||i<90)&&(t-=e),t}function Ypt(t,e,i){const{left:r,top:n,right:s,bottom:o}=i,{backdropColor:a}=e;if(!ei(a)){const l=mv(e.borderRadius),c=fo(e.backdropPadding);t.fillStyle=a;const u=r-c.left,h=n-c.top,f=s-r+c.width,m=o-n+c.height;Object.values(l).some(g=>g!==0)?(t.beginPath(),UT(t,{x:u,y:h,w:f,h:m,radius:l}),t.fill()):t.fillRect(u,h,f,m)}}function Kpt(t,e){const{ctx:i,options:{pointLabels:r}}=t;for(let n=e-1;n>=0;n--){const s=t._pointLabelItems[n];if(!s.visible)continue;const o=r.setContext(t.getPointLabelContext(n));Ypt(i,o,s);const a=Jn(o.font),{x:l,y:c,textAlign:u}=s;zv(i,t._pointLabels[n],l,c+a.lineHeight/2,a,{color:o.color,textAlign:u,textBaseline:"middle"})}}function Swe(t,e,i,r){const{ctx:n}=t;if(i)n.arc(t.xCenter,t.yCenter,e,0,ar);else{let s=t.getPointPosition(0,e);n.moveTo(s.x,s.y);for(let o=1;o<r;o++)s=t.getPointPosition(o,e),n.lineTo(s.x,s.y)}}function Xpt(t,e,i,r,n){const s=t.ctx,o=e.circular,{color:a,lineWidth:l}=e;!o&&!r||!a||!l||i<0||(s.save(),s.strokeStyle=a,s.lineWidth=l,s.setLineDash(n.dash),s.lineDashOffset=n.dashOffset,s.beginPath(),Swe(t,i,o,r),s.closePath(),s.stroke(),s.restore())}function Qpt(t,e,i){return Pg(t,{label:i,index:e,type:"pointLabel"})}class z2 extends NO{constructor(e){super(e),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const e=this._padding=fo(A6(this.options)/2),i=this.width=this.maxWidth-e.width,r=this.height=this.maxHeight-e.height;this.xCenter=Math.floor(this.left+i/2+e.left),this.yCenter=Math.floor(this.top+r/2+e.top),this.drawingArea=Math.floor(Math.min(i,r)/2)}determineDataLimits(){const{min:e,max:i}=this.getMinMax(!1);this.min=Gr(e)&&!isNaN(e)?e:0,this.max=Gr(i)&&!isNaN(i)?i:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/A6(this.options))}generateTickLabels(e){NO.prototype.generateTickLabels.call(this,e),this._pointLabels=this.getLabels().map((i,r)=>{const n=ct(this.options.pointLabels.callback,[i,r],this);return n||n===0?n:""}).filter((i,r)=>this.chart.getDataVisibility(r))}fit(){const e=this.options;e.display&&e.pointLabels.display?Bpt(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(e,i,r,n){this.xCenter+=Math.floor((e-i)/2),this.yCenter+=Math.floor((r-n)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(e,i,r,n))}getIndexAngle(e){const i=ar/(this._pointLabels.length||1),r=this.options.startAngle||0;return Ya(e*i+mu(r))}getDistanceFromCenterForValue(e){if(ei(e))return NaN;const i=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-e)*i:(e-this.min)*i}getValueForDistanceFromCenter(e){if(ei(e))return NaN;const i=e/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-i:this.min+i}getPointLabelContext(e){const i=this._pointLabels||[];if(e>=0&&e<i.length){const r=i[e];return Qpt(this.getContext(),e,r)}}getPointPosition(e,i,r=0){const n=this.getIndexAngle(e)-Hr+r;return{x:Math.cos(n)*i+this.xCenter,y:Math.sin(n)*i+this.yCenter,angle:n}}getPointPositionForValue(e,i){return this.getPointPosition(e,this.getDistanceFromCenterForValue(i))}getBasePosition(e){return this.getPointPositionForValue(e||0,this.getBaseValue())}getPointLabelPosition(e){const{left:i,top:r,right:n,bottom:s}=this._pointLabelItems[e];return{left:i,top:r,right:n,bottom:s}}drawBackground(){const{backgroundColor:e,grid:{circular:i}}=this.options;if(e){const r=this.ctx;r.save(),r.beginPath(),Swe(this,this.getDistanceFromCenterForValue(this._endValue),i,this._pointLabels.length),r.closePath(),r.fillStyle=e,r.fill(),r.restore()}}drawGrid(){const e=this.ctx,i=this.options,{angleLines:r,grid:n,border:s}=i,o=this._pointLabels.length;let a,l,c;if(i.pointLabels.display&&Kpt(this,o),n.display&&this.ticks.forEach((u,h)=>{if(h!==0){l=this.getDistanceFromCenterForValue(u.value);const f=this.getContext(h),m=n.setContext(f),g=s.setContext(f);Xpt(this,m,l,o,g)}}),r.display){for(e.save(),a=o-1;a>=0;a--){const u=r.setContext(this.getPointLabelContext(a)),{color:h,lineWidth:f}=u;!f||!h||(e.lineWidth=f,e.strokeStyle=h,e.setLineDash(u.borderDash),e.lineDashOffset=u.borderDashOffset,l=this.getDistanceFromCenterForValue(i.ticks.reverse?this.min:this.max),c=this.getPointPosition(a,l),e.beginPath(),e.moveTo(this.xCenter,this.yCenter),e.lineTo(c.x,c.y),e.stroke())}e.restore()}}drawBorder(){}drawLabels(){const e=this.ctx,i=this.options,r=i.ticks;if(!r.display)return;const n=this.getIndexAngle(0);let s,o;e.save(),e.translate(this.xCenter,this.yCenter),e.rotate(n),e.textAlign="center",e.textBaseline="middle",this.ticks.forEach((a,l)=>{if(l===0&&!i.reverse)return;const c=r.setContext(this.getContext(l)),u=Jn(c.font);if(s=this.getDistanceFromCenterForValue(this.ticks[l].value),c.showLabelBackdrop){e.font=u.string,o=e.measureText(a.label).width,e.fillStyle=c.backdropColor;const h=fo(c.backdropPadding);e.fillRect(-o/2-h.left,-s-u.size/2-h.top,o+h.width,u.size+h.height)}zv(e,a.label,0,-s,u,{color:c.color})}),e.restore()}drawTitle(){}}we(z2,"id","radialLinear"),we(z2,"defaults",{display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:NR.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(e){return e},padding:5,centerPointLabels:!1}}),we(z2,"defaultRoutes",{"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"}),we(z2,"descriptors",{angleLines:{_fallback:"grid"}});const BR={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},_a=Object.keys(BR);function eft(t,e){return t-e}function rre(t,e){if(ei(e))return null;const i=t._adapter,{parser:r,round:n,isoWeekday:s}=t._parseOpts;let o=e;return typeof r=="function"&&(o=r(o)),Gr(o)||(o=typeof r=="string"?i.parse(o,r):i.parse(o)),o===null?null:(n&&(o=n==="week"&&($1(s)||s===!0)?i.startOf(o,"isoWeek",s):i.startOf(o,n)),+o)}function nre(t,e,i,r){const n=_a.length;for(let s=_a.indexOf(t);s<n-1;++s){const o=BR[_a[s]],a=o.steps?o.steps:Number.MAX_SAFE_INTEGER;if(o.common&&Math.ceil((i-e)/(a*o.size))<=r)return _a[s]}return _a[n-1]}function tft(t,e,i,r,n){for(let s=_a.length-1;s>=_a.indexOf(i);s--){const o=_a[s];if(BR[o].common&&t._adapter.diff(n,r,o)>=e-1)return o}return _a[i?_a.indexOf(i):0]}function ift(t){for(let e=_a.indexOf(t)+1,i=_a.length;e<i;++e)if(BR[_a[e]].common)return _a[e]}function sre(t,e,i){if(!i)t[e]=!0;else if(i.length){const{lo:r,hi:n}=rH(i,e),s=i[r]>=e?i[r]:i[n];t[s]=!0}}function rft(t,e,i,r){const n=t._adapter,s=+n.startOf(e[0].value,r),o=e[e.length-1].value;let a,l;for(a=s;a<=o;a=+n.add(a,1,r))l=i[a],l>=0&&(e[l].major=!0);return e}function ore(t,e,i){const r=[],n={},s=e.length;let o,a;for(o=0;o<s;++o)a=e[o],n[a]=o,r.push({value:a,major:!1});return s===0||!i?r:rft(t,r,n,i)}class qT extends i_{constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,i={}){const r=e.time||(e.time={}),n=this._adapter=new ddt._date(e.adapters.date);n.init(i),kI(r.displayFormats,n.formats()),this._parseOpts={parser:r.parser,round:r.round,isoWeekday:r.isoWeekday},super.init(e),this._normalized=i.normalized}parse(e,i){return e===void 0?null:rre(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,i=this._adapter,r=e.time.unit||"day";let{min:n,max:s,minDefined:o,maxDefined:a}=this.getUserBounds();function l(c){!o&&!isNaN(c.min)&&(n=Math.min(n,c.min)),!a&&!isNaN(c.max)&&(s=Math.max(s,c.max))}(!o||!a)&&(l(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&l(this.getMinMax(!1))),n=Gr(n)&&!isNaN(n)?n:+i.startOf(Date.now(),r),s=Gr(s)&&!isNaN(s)?s:+i.endOf(Date.now(),r)+1,this.min=Math.min(n,s-1),this.max=Math.max(n+1,s)}_getLabelBounds(){const e=this.getLabelTimestamps();let i=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY;return e.length&&(i=e[0],r=e[e.length-1]),{min:i,max:r}}buildTicks(){const e=this.options,i=e.time,r=e.ticks,n=r.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&n.length&&(this.min=this._userMin||n[0],this.max=this._userMax||n[n.length-1]);const s=this.min,o=this.max,a=Fct(n,s,o);return this._unit=i.unit||(r.autoSkip?nre(i.minUnit,this.min,this.max,this._getLabelCapacity(s)):tft(this,a.length,i.minUnit,this.min,this.max)),this._majorUnit=!r.major.enabled||this._unit==="year"?void 0:ift(this._unit),this.initOffsets(n),e.reverse&&a.reverse(),ore(this,a,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let i=0,r=0,n,s;this.options.offset&&e.length&&(n=this.getDecimalForValue(e[0]),e.length===1?i=1-n:i=(this.getDecimalForValue(e[1])-n)/2,s=this.getDecimalForValue(e[e.length-1]),e.length===1?r=s:r=(s-this.getDecimalForValue(e[e.length-2]))/2);const o=e.length<3?.5:.25;i=fs(i,0,o),r=fs(r,0,o),this._offsets={start:i,end:r,factor:1/(i+1+r)}}_generate(){const e=this._adapter,i=this.min,r=this.max,n=this.options,s=n.time,o=s.unit||nre(s.minUnit,i,r,this._getLabelCapacity(i)),a=ot(n.ticks.stepSize,1),l=o==="week"?s.isoWeekday:!1,c=$1(l)||l===!0,u={};let h=i,f,m;if(c&&(h=+e.startOf(h,"isoWeek",l)),h=+e.startOf(h,c?"day":o),e.diff(r,i,o)>1e5*a)throw new Error(i+" and "+r+" are too far apart with stepSize of "+a+" "+o);const g=n.ticks.source==="data"&&this.getDataTimestamps();for(f=h,m=0;f<r;f=+e.add(f,a,o),m++)sre(u,f,g);return(f===r||n.bounds==="ticks"||m===1)&&sre(u,f,g),Object.keys(u).sort((y,v)=>y-v).map(y=>+y)}getLabelForValue(e){const i=this._adapter,r=this.options.time;return r.tooltipFormat?i.format(e,r.tooltipFormat):i.format(e,r.displayFormats.datetime)}format(e,i){const n=this.options.time.displayFormats,s=this._unit,o=i||n[s];return this._adapter.format(e,o)}_tickFormatFunction(e,i,r,n){const s=this.options,o=s.ticks.callback;if(o)return ct(o,[e,i,r],this);const a=s.time.displayFormats,l=this._unit,c=this._majorUnit,u=l&&a[l],h=c&&a[c],f=r[i],m=c&&h&&f&&f.major;return this._adapter.format(e,n||(m?h:u))}generateTickLabels(e){let i,r,n;for(i=0,r=e.length;i<r;++i)n=e[i],n.label=this._tickFormatFunction(n.value,i,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const i=this._offsets,r=this.getDecimalForValue(e);return this.getPixelForDecimal((i.start+r)*i.factor)}getValueForPixel(e){const i=this._offsets,r=this.getDecimalForPixel(e)/i.factor-i.end;return this.min+r*(this.max-this.min)}_getLabelSize(e){const i=this.options.ticks,r=this.ctx.measureText(e).width,n=mu(this.isHorizontal()?i.maxRotation:i.minRotation),s=Math.cos(n),o=Math.sin(n),a=this._resolveTickFontOptions(0).size;return{w:r*s+a*o,h:r*o+a*s}}_getLabelCapacity(e){const i=this.options.time,r=i.displayFormats,n=r[i.unit]||r.millisecond,s=this._tickFormatFunction(e,0,ore(this,[e],this._majorUnit),n),o=this._getLabelSize(s),a=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h)-1;return a>0?a:1}getDataTimestamps(){let e=this._cache.data||[],i,r;if(e.length)return e;const n=this.getMatchingVisibleMetas();if(this._normalized&&n.length)return this._cache.data=n[0].controller.getAllParsedValues(this);for(i=0,r=n.length;i<r;++i)e=e.concat(n[i].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let i,r;if(e.length)return e;const n=this.getLabels();for(i=0,r=n.length;i<r;++i)e.push(rre(this,n[i]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return Rbe(e.sort(eft))}}we(qT,"id","time"),we(qT,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function y$(t,e,i){let r=0,n=t.length-1,s,o,a,l;i?(e>=t[r].pos&&e<=t[n].pos&&({lo:r,hi:n}=ep(t,"pos",e)),{pos:s,time:a}=t[r],{pos:o,time:l}=t[n]):(e>=t[r].time&&e<=t[n].time&&({lo:r,hi:n}=ep(t,"time",e)),{time:s,pos:a}=t[r],{time:o,pos:l}=t[n]);const c=o-s;return c?a+(l-a)*(e-s)/c:a}class k6 extends qT{constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),i=this._table=this.buildLookupTable(e);this._minPos=y$(i,this.min),this._tableRange=y$(i,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:i,max:r}=this,n=[],s=[];let o,a,l,c,u;for(o=0,a=e.length;o<a;++o)c=e[o],c>=i&&c<=r&&n.push(c);if(n.length<2)return[{time:i,pos:0},{time:r,pos:1}];for(o=0,a=n.length;o<a;++o)u=n[o+1],l=n[o-1],c=n[o],Math.round((u+l)/2)!==c&&s.push({time:c,pos:o/(a-1)});return s}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const i=this.getDataTimestamps(),r=this.getLabelTimestamps();return i.length&&r.length?e=this.normalize(i.concat(r)):e=i.length?i:r,e=this._cache.all=e,e}getDecimalForValue(e){return(y$(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const i=this._offsets,r=this.getDecimalForPixel(e)/i.factor-i.end;return y$(this._table,r*this._tableRange+this._minPos,!0)}}we(k6,"id","timeseries"),we(k6,"defaults",qT.defaults);var nft=Object.freeze({__proto__:null,CategoryScale:E6,LinearScale:M6,LogarithmicScale:$6,RadialLinearScale:z2,TimeScale:qT,TimeSeriesScale:k6});const sft=[udt,zht,Lpt,nft];wd.register(...sft);function oft(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Iwe={exports:{}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function(t){(function(e,i,r,n){var s=["","webkit","Moz","MS","ms","o"],o=i.createElement("div"),a="function",l=Math.round,c=Math.abs,u=Date.now;function h(R,D,q){return setTimeout(x(R,q),D)}function f(R,D,q){return Array.isArray(R)?(m(R,q[D],q),!0):!1}function m(R,D,q){var re;if(R)if(R.forEach)R.forEach(D,q);else if(R.length!==n)for(re=0;re<R.length;)D.call(q,R[re],re,R),re++;else for(re in R)R.hasOwnProperty(re)&&D.call(q,R[re],re,R)}function g(R,D,q){var re="DEPRECATED METHOD: "+D+`
`+q+` AT 
`;return function(){var pe=new Error("get-stack-trace"),$e=pe&&pe.stack?pe.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",kt=e.console&&(e.console.warn||e.console.log);return kt&&kt.call(e.console,re,$e),R.apply(this,arguments)}}var y;typeof Object.assign!="function"?y=function(D){if(D===n||D===null)throw new TypeError("Cannot convert undefined or null to object");for(var q=Object(D),re=1;re<arguments.length;re++){var pe=arguments[re];if(pe!==n&&pe!==null)for(var $e in pe)pe.hasOwnProperty($e)&&(q[$e]=pe[$e])}return q}:y=Object.assign;var v=g(function(D,q,re){for(var pe=Object.keys(q),$e=0;$e<pe.length;)(!re||re&&D[pe[$e]]===n)&&(D[pe[$e]]=q[pe[$e]]),$e++;return D},"extend","Use `assign`."),b=g(function(D,q){return v(D,q,!0)},"merge","Use `assign`.");function w(R,D,q){var re=D.prototype,pe;pe=R.prototype=Object.create(re),pe.constructor=R,pe._super=re,q&&y(pe,q)}function x(R,D){return function(){return R.apply(D,arguments)}}function S(R,D){return typeof R==a?R.apply(D&&D[0]||n,D):R}function I(R,D){return R===n?D:R}function T(R,D,q){m(P(D),function(re){R.addEventListener(re,q,!1)})}function C(R,D,q){m(P(D),function(re){R.removeEventListener(re,q,!1)})}function E(R,D){for(;R;){if(R==D)return!0;R=R.parentNode}return!1}function $(R,D){return R.indexOf(D)>-1}function P(R){return R.trim().split(/\s+/g)}function k(R,D,q){if(R.indexOf&&!q)return R.indexOf(D);for(var re=0;re<R.length;){if(q&&R[re][q]==D||!q&&R[re]===D)return re;re++}return-1}function L(R){return Array.prototype.slice.call(R,0)}function F(R,D,q){for(var re=[],pe=[],$e=0;$e<R.length;){var kt=D?R[$e][D]:R[$e];k(pe,kt)<0&&re.push(R[$e]),pe[$e]=kt,$e++}return q&&(D?re=re.sort(function(ws,yo){return ws[D]>yo[D]}):re=re.sort()),re}function V(R,D){for(var q,re,pe=D[0].toUpperCase()+D.slice(1),$e=0;$e<s.length;){if(q=s[$e],re=q?q+pe:D,re in R)return re;$e++}return n}var z=1;function G(){return z++}function H(R){var D=R.ownerDocument||R;return D.defaultView||D.parentWindow||e}var Z=/mobile|tablet|ip(ad|hone|od)|android/i,K="ontouchstart"in e,X=V(e,"PointerEvent")!==n,oe=K&&Z.test(navigator.userAgent),se="touch",le="pen",me="mouse",Se="kinect",Ge=25,Be=1,gt=2,Pe=4,De=8,ii=1,Rr=2,At=4,mo=8,bs=16,Ai=Rr|At,un=mo|bs,fc=Ai|un,mc=["x","y"],cr=["clientX","clientY"];function ur(R,D){var q=this;this.manager=R,this.callback=D,this.element=R.element,this.target=R.options.inputTarget,this.domHandler=function(re){S(R.options.enable,[R])&&q.handler(re)},this.init()}ur.prototype={handler:function(){},init:function(){this.evEl&&T(this.element,this.evEl,this.domHandler),this.evTarget&&T(this.target,this.evTarget,this.domHandler),this.evWin&&T(H(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&C(this.element,this.evEl,this.domHandler),this.evTarget&&C(this.target,this.evTarget,this.domHandler),this.evWin&&C(H(this.element),this.evWin,this.domHandler)}};function Ho(R){var D,q=R.options.inputClass;return q?D=q:X?D=px:oe?D=n_:K?D=Fp:D=r_,new D(R,Ce)}function Ce(R,D,q){var re=q.pointers.length,pe=q.changedPointers.length,$e=D&Be&&re-pe===0,kt=D&(Pe|De)&&re-pe===0;q.isFirst=!!$e,q.isFinal=!!kt,$e&&(R.session={}),q.eventType=D,Xe(R,q),R.emit("hammer.input",q),R.recognize(q),R.session.prevInput=q}function Xe(R,D){var q=R.session,re=D.pointers,pe=re.length;q.firstInput||(q.firstInput=xi(D)),pe>1&&!q.firstMultiple?q.firstMultiple=xi(D):pe===1&&(q.firstMultiple=!1);var $e=q.firstInput,kt=q.firstMultiple,Xn=kt?kt.center:$e.center,ws=D.center=Ln(re);D.timeStamp=u(),D.deltaTime=D.timeStamp-$e.timeStamp,D.angle=hx(Xn,ws),D.distance=Rp(Xn,ws),Rt(q,D),D.offsetDirection=Rn(D.deltaX,D.deltaY);var yo=Fr(D.deltaTime,D.deltaX,D.deltaY);D.overallVelocityX=yo.x,D.overallVelocityY=yo.y,D.overallVelocity=c(yo.x)>c(yo.y)?yo.x:yo.y,D.scale=kt?GR(kt.pointers,re):1,D.rotation=kt?UR(kt.pointers,re):0,D.maxPointers=q.prevInput?D.pointers.length>q.prevInput.maxPointers?D.pointers.length:q.prevInput.maxPointers:D.pointers.length,Qi(q,D);var Ru=R.element;E(D.srcEvent.target,Ru)&&(Ru=D.srcEvent.target),D.target=Ru}function Rt(R,D){var q=D.center,re=R.offsetDelta||{},pe=R.prevDelta||{},$e=R.prevInput||{};(D.eventType===Be||$e.eventType===Pe)&&(pe=R.prevDelta={x:$e.deltaX||0,y:$e.deltaY||0},re=R.offsetDelta={x:q.x,y:q.y}),D.deltaX=pe.x+(q.x-re.x),D.deltaY=pe.y+(q.y-re.y)}function Qi(R,D){var q=R.lastInterval||D,re=D.timeStamp-q.timeStamp,pe,$e,kt,Xn;if(D.eventType!=De&&(re>Ge||q.velocity===n)){var ws=D.deltaX-q.deltaX,yo=D.deltaY-q.deltaY,Ru=Fr(re,ws,yo);$e=Ru.x,kt=Ru.y,pe=c(Ru.x)>c(Ru.y)?Ru.x:Ru.y,Xn=Rn(ws,yo),R.lastInterval=D}else pe=q.velocity,$e=q.velocityX,kt=q.velocityY,Xn=q.direction;D.velocity=pe,D.velocityX=$e,D.velocityY=kt,D.direction=Xn}function xi(R){for(var D=[],q=0;q<R.pointers.length;)D[q]={clientX:l(R.pointers[q].clientX),clientY:l(R.pointers[q].clientY)},q++;return{timeStamp:u(),pointers:D,center:Ln(D),deltaX:R.deltaX,deltaY:R.deltaY}}function Ln(R){var D=R.length;if(D===1)return{x:l(R[0].clientX),y:l(R[0].clientY)};for(var q=0,re=0,pe=0;pe<D;)q+=R[pe].clientX,re+=R[pe].clientY,pe++;return{x:l(q/D),y:l(re/D)}}function Fr(R,D,q){return{x:D/R||0,y:q/R||0}}function Rn(R,D){return R===D?ii:c(R)>=c(D)?R<0?Rr:At:D<0?mo:bs}function Rp(R,D,q){q||(q=mc);var re=D[q[0]]-R[q[0]],pe=D[q[1]]-R[q[1]];return Math.sqrt(re*re+pe*pe)}function hx(R,D,q){q||(q=mc);var re=D[q[0]]-R[q[0]],pe=D[q[1]]-R[q[1]];return Math.atan2(pe,re)*180/Math.PI}function UR(R,D){return hx(D[1],D[0],cr)+hx(R[1],R[0],cr)}function GR(R,D){return Rp(D[0],D[1],cr)/Rp(R[0],R[1],cr)}var HR={mousedown:Be,mousemove:gt,mouseup:Pe},qR="mousedown",WR="mousemove mouseup";function r_(){this.evEl=qR,this.evWin=WR,this.pressed=!1,ur.apply(this,arguments)}w(r_,ur,{handler:function(D){var q=HR[D.type];q&Be&&D.button===0&&(this.pressed=!0),q&gt&&D.which!==1&&(q=Pe),this.pressed&&(q&Pe&&(this.pressed=!1),this.callback(this.manager,q,{pointers:[D],changedPointers:[D],pointerType:me,srcEvent:D}))}});var JR={pointerdown:Be,pointermove:gt,pointerup:Pe,pointercancel:De,pointerout:De},ZR={2:se,3:le,4:me,5:Se},rE="pointerdown",nE="pointermove pointerup pointercancel";e.MSPointerEvent&&!e.PointerEvent&&(rE="MSPointerDown",nE="MSPointerMove MSPointerUp MSPointerCancel");function px(){this.evEl=rE,this.evWin=nE,ur.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}w(px,ur,{handler:function(D){var q=this.store,re=!1,pe=D.type.toLowerCase().replace("ms",""),$e=JR[pe],kt=ZR[D.pointerType]||D.pointerType,Xn=kt==se,ws=k(q,D.pointerId,"pointerId");$e&Be&&(D.button===0||Xn)?ws<0&&(q.push(D),ws=q.length-1):$e&(Pe|De)&&(re=!0),!(ws<0)&&(q[ws]=D,this.callback(this.manager,$e,{pointers:q,changedPointers:[D],pointerType:kt,srcEvent:D}),re&&q.splice(ws,1))}});var YR={touchstart:Be,touchmove:gt,touchend:Pe,touchcancel:De},KR="touchstart",XR="touchstart touchmove touchend touchcancel";function sE(){this.evTarget=KR,this.evWin=XR,this.started=!1,ur.apply(this,arguments)}w(sE,ur,{handler:function(D){var q=YR[D.type];if(q===Be&&(this.started=!0),!!this.started){var re=QR.call(this,D,q);q&(Pe|De)&&re[0].length-re[1].length===0&&(this.started=!1),this.callback(this.manager,q,{pointers:re[0],changedPointers:re[1],pointerType:se,srcEvent:D})}}});function QR(R,D){var q=L(R.touches),re=L(R.changedTouches);return D&(Pe|De)&&(q=F(q.concat(re),"identifier",!0)),[q,re]}var e3={touchstart:Be,touchmove:gt,touchend:Pe,touchcancel:De},t3="touchstart touchmove touchend touchcancel";function n_(){this.evTarget=t3,this.targetIds={},ur.apply(this,arguments)}w(n_,ur,{handler:function(D){var q=e3[D.type],re=i3.call(this,D,q);re&&this.callback(this.manager,q,{pointers:re[0],changedPointers:re[1],pointerType:se,srcEvent:D})}});function i3(R,D){var q=L(R.touches),re=this.targetIds;if(D&(Be|gt)&&q.length===1)return re[q[0].identifier]=!0,[q,q];var pe,$e,kt=L(R.changedTouches),Xn=[],ws=this.target;if($e=q.filter(function(yo){return E(yo.target,ws)}),D===Be)for(pe=0;pe<$e.length;)re[$e[pe].identifier]=!0,pe++;for(pe=0;pe<kt.length;)re[kt[pe].identifier]&&Xn.push(kt[pe]),D&(Pe|De)&&delete re[kt[pe].identifier],pe++;if(Xn.length)return[F($e.concat(Xn),"identifier",!0),Xn]}var Q=2500,Ri=25;function Fp(){ur.apply(this,arguments);var R=x(this.handler,this);this.touch=new n_(this.manager,R),this.mouse=new r_(this.manager,R),this.primaryTouch=null,this.lastTouches=[]}w(Fp,ur,{handler:function(D,q,re){var pe=re.pointerType==se,$e=re.pointerType==me;if(!($e&&re.sourceCapabilities&&re.sourceCapabilities.firesTouchEvents)){if(pe)dl.call(this,q,re);else if($e&&Oe.call(this,re))return;this.callback(D,q,re)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function dl(R,D){R&Be?(this.primaryTouch=D.changedPointers[0].identifier,s_.call(this,D)):R&(Pe|De)&&s_.call(this,D)}function s_(R){var D=R.changedPointers[0];if(D.identifier===this.primaryTouch){var q={x:D.clientX,y:D.clientY};this.lastTouches.push(q);var re=this.lastTouches,pe=function(){var $e=re.indexOf(q);$e>-1&&re.splice($e,1)};setTimeout(pe,Q)}}function Oe(R){for(var D=R.srcEvent.clientX,q=R.srcEvent.clientY,re=0;re<this.lastTouches.length;re++){var pe=this.lastTouches[re],$e=Math.abs(D-pe.x),kt=Math.abs(q-pe.y);if($e<=Ri&&kt<=Ri)return!0}return!1}var Og=V(o.style,"touchAction"),Wr=Og!==n,Dp="compute",oE="auto",$a="manipulation",Ou="none",Np="pan-x",We="pan-y",o_=n3();function a_(R,D){this.manager=R,this.set(D)}a_.prototype={set:function(R){R==Dp&&(R=this.compute()),Wr&&this.manager.element.style&&o_[R]&&(this.manager.element.style[Og]=R),this.actions=R.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var R=[];return m(this.manager.recognizers,function(D){S(D.options.enable,[D])&&(R=R.concat(D.getTouchAction()))}),r3(R.join(" "))},preventDefaults:function(R){var D=R.srcEvent,q=R.offsetDirection;if(this.manager.session.prevented){D.preventDefault();return}var re=this.actions,pe=$(re,Ou)&&!o_[Ou],$e=$(re,We)&&!o_[We],kt=$(re,Np)&&!o_[Np];if(pe){var Xn=R.pointers.length===1,ws=R.distance<2,yo=R.deltaTime<250;if(Xn&&ws&&yo)return}if(!(kt&&$e)&&(pe||$e&&q&Ai||kt&&q&un))return this.preventSrc(D)},preventSrc:function(R){this.manager.session.prevented=!0,R.preventDefault()}};function r3(R){if($(R,Ou))return Ou;var D=$(R,Np),q=$(R,We);return D&&q?Ou:D||q?D?Np:We:$(R,$a)?$a:oE}function n3(){if(!Wr)return!1;var R={},D=e.CSS&&e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(q){R[q]=D?e.CSS.supports("touch-action",q):!0}),R}var Vp=1,qo=2,Lu=4,Fi=8,gc=Fi,zp=16,hl=32;function yc(R){this.options=y({},this.defaults,R||{}),this.id=G(),this.manager=null,this.options.enable=I(this.options.enable,!0),this.state=Vp,this.simultaneous={},this.requireFail=[]}yc.prototype={defaults:{},set:function(R){return y(this.options,R),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(R){if(f(R,"recognizeWith",this))return this;var D=this.simultaneous;return R=l_(R,this),D[R.id]||(D[R.id]=R,R.recognizeWith(this)),this},dropRecognizeWith:function(R){return f(R,"dropRecognizeWith",this)?this:(R=l_(R,this),delete this.simultaneous[R.id],this)},requireFailure:function(R){if(f(R,"requireFailure",this))return this;var D=this.requireFail;return R=l_(R,this),k(D,R)===-1&&(D.push(R),R.requireFailure(this)),this},dropRequireFailure:function(R){if(f(R,"dropRequireFailure",this))return this;R=l_(R,this);var D=k(this.requireFail,R);return D>-1&&this.requireFail.splice(D,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(R){return!!this.simultaneous[R.id]},emit:function(R){var D=this,q=this.state;function re(pe){D.manager.emit(pe,R)}q<Fi&&re(D.options.event+aE(q)),re(D.options.event),R.additionalEvent&&re(R.additionalEvent),q>=Fi&&re(D.options.event+aE(q))},tryEmit:function(R){if(this.canEmit())return this.emit(R);this.state=hl},canEmit:function(){for(var R=0;R<this.requireFail.length;){if(!(this.requireFail[R].state&(hl|Vp)))return!1;R++}return!0},recognize:function(R){var D=y({},R);if(!S(this.options.enable,[this,D])){this.reset(),this.state=hl;return}this.state&(gc|zp|hl)&&(this.state=Vp),this.state=this.process(D),this.state&(qo|Lu|Fi|zp)&&this.tryEmit(D)},process:function(R){},getTouchAction:function(){},reset:function(){}};function aE(R){return R&zp?"cancel":R&Fi?"end":R&Lu?"move":R&qo?"start":""}function lE(R){return R==bs?"down":R==mo?"up":R==Rr?"left":R==At?"right":""}function l_(R,D){var q=D.manager;return q?q.get(R):R}function dr(){yc.apply(this,arguments)}w(dr,yc,{defaults:{pointers:1},attrTest:function(R){var D=this.options.pointers;return D===0||R.pointers.length===D},process:function(R){var D=this.state,q=R.eventType,re=D&(qo|Lu),pe=this.attrTest(R);return re&&(q&De||!pe)?D|zp:re||pe?q&Pe?D|Fi:D&qo?D|Lu:qo:hl}});function c_(){dr.apply(this,arguments),this.pX=null,this.pY=null}w(c_,dr,{defaults:{event:"pan",threshold:10,pointers:1,direction:fc},getTouchAction:function(){var R=this.options.direction,D=[];return R&Ai&&D.push(We),R&un&&D.push(Np),D},directionTest:function(R){var D=this.options,q=!0,re=R.distance,pe=R.direction,$e=R.deltaX,kt=R.deltaY;return pe&D.direction||(D.direction&Ai?(pe=$e===0?ii:$e<0?Rr:At,q=$e!=this.pX,re=Math.abs(R.deltaX)):(pe=kt===0?ii:kt<0?mo:bs,q=kt!=this.pY,re=Math.abs(R.deltaY))),R.direction=pe,q&&re>D.threshold&&pe&D.direction},attrTest:function(R){return dr.prototype.attrTest.call(this,R)&&(this.state&qo||!(this.state&qo)&&this.directionTest(R))},emit:function(R){this.pX=R.deltaX,this.pY=R.deltaY;var D=lE(R.direction);D&&(R.additionalEvent=this.options.event+D),this._super.emit.call(this,R)}});function fx(){dr.apply(this,arguments)}w(fx,dr,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Ou]},attrTest:function(R){return this._super.attrTest.call(this,R)&&(Math.abs(R.scale-1)>this.options.threshold||this.state&qo)},emit:function(R){if(R.scale!==1){var D=R.scale<1?"in":"out";R.additionalEvent=this.options.event+D}this._super.emit.call(this,R)}});function j(){yc.apply(this,arguments),this._timer=null,this._input=null}w(j,yc,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[oE]},process:function(R){var D=this.options,q=R.pointers.length===D.pointers,re=R.distance<D.threshold,pe=R.deltaTime>D.time;if(this._input=R,!re||!q||R.eventType&(Pe|De)&&!pe)this.reset();else if(R.eventType&Be)this.reset(),this._timer=h(function(){this.state=gc,this.tryEmit()},D.time,this);else if(R.eventType&Pe)return gc;return hl},reset:function(){clearTimeout(this._timer)},emit:function(R){this.state===gc&&(R&&R.eventType&Pe?this.manager.emit(this.options.event+"up",R):(this._input.timeStamp=u(),this.manager.emit(this.options.event,this._input)))}});function ne(){dr.apply(this,arguments)}w(ne,dr,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Ou]},attrTest:function(R){return this._super.attrTest.call(this,R)&&(Math.abs(R.rotation)>this.options.threshold||this.state&qo)}});function ue(){dr.apply(this,arguments)}w(ue,dr,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Ai|un,pointers:1},getTouchAction:function(){return c_.prototype.getTouchAction.call(this)},attrTest:function(R){var D=this.options.direction,q;return D&(Ai|un)?q=R.overallVelocity:D&Ai?q=R.overallVelocityX:D&un&&(q=R.overallVelocityY),this._super.attrTest.call(this,R)&&D&R.offsetDirection&&R.distance>this.options.threshold&&R.maxPointers==this.options.pointers&&c(q)>this.options.velocity&&R.eventType&Pe},emit:function(R){var D=lE(R.offsetDirection);D&&this.manager.emit(this.options.event+D,R),this.manager.emit(this.options.event,R)}});function rt(){yc.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}w(rt,yc,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[$a]},process:function(R){var D=this.options,q=R.pointers.length===D.pointers,re=R.distance<D.threshold,pe=R.deltaTime<D.time;if(this.reset(),R.eventType&Be&&this.count===0)return this.failTimeout();if(re&&pe&&q){if(R.eventType!=Pe)return this.failTimeout();var $e=this.pTime?R.timeStamp-this.pTime<D.interval:!0,kt=!this.pCenter||Rp(this.pCenter,R.center)<D.posThreshold;this.pTime=R.timeStamp,this.pCenter=R.center,!kt||!$e?this.count=1:this.count+=1,this._input=R;var Xn=this.count%D.taps;if(Xn===0)return this.hasRequireFailures()?(this._timer=h(function(){this.state=gc,this.tryEmit()},D.interval,this),qo):gc}return hl},failTimeout:function(){return this._timer=h(function(){this.state=hl},this.options.interval,this),hl},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==gc&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function Si(R,D){return D=D||{},D.recognizers=I(D.recognizers,Si.defaults.preset),new jp(R,D)}Si.VERSION="2.0.7",Si.defaults={domEvents:!1,touchAction:Dp,enable:!0,inputTarget:null,inputClass:null,preset:[[ne,{enable:!1}],[fx,{enable:!1},["rotate"]],[ue,{direction:Ai}],[c_,{direction:Ai},["swipe"]],[rt],[rt,{event:"doubletap",taps:2},["tap"]],[j]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var hi=1,go=2;function jp(R,D){this.options=y({},Si.defaults,D||{}),this.options.inputTarget=this.options.inputTarget||R,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=R,this.input=Ho(this),this.touchAction=new a_(this,this.options.touchAction),gH(this,!0),m(this.options.recognizers,function(q){var re=this.add(new q[0](q[1]));q[2]&&re.recognizeWith(q[2]),q[3]&&re.requireFailure(q[3])},this)}jp.prototype={set:function(R){return y(this.options,R),R.touchAction&&this.touchAction.update(),R.inputTarget&&(this.input.destroy(),this.input.target=R.inputTarget,this.input.init()),this},stop:function(R){this.session.stopped=R?go:hi},recognize:function(R){var D=this.session;if(!D.stopped){this.touchAction.preventDefaults(R);var q,re=this.recognizers,pe=D.curRecognizer;(!pe||pe&&pe.state&gc)&&(pe=D.curRecognizer=null);for(var $e=0;$e<re.length;)q=re[$e],D.stopped!==go&&(!pe||q==pe||q.canRecognizeWith(pe))?q.recognize(R):q.reset(),!pe&&q.state&(qo|Lu|Fi)&&(pe=D.curRecognizer=q),$e++}},get:function(R){if(R instanceof yc)return R;for(var D=this.recognizers,q=0;q<D.length;q++)if(D[q].options.event==R)return D[q];return null},add:function(R){if(f(R,"add",this))return this;var D=this.get(R.options.event);return D&&this.remove(D),this.recognizers.push(R),R.manager=this,this.touchAction.update(),R},remove:function(R){if(f(R,"remove",this))return this;if(R=this.get(R),R){var D=this.recognizers,q=k(D,R);q!==-1&&(D.splice(q,1),this.touchAction.update())}return this},on:function(R,D){if(R!==n&&D!==n){var q=this.handlers;return m(P(R),function(re){q[re]=q[re]||[],q[re].push(D)}),this}},off:function(R,D){if(R!==n){var q=this.handlers;return m(P(R),function(re){D?q[re]&&q[re].splice(k(q[re],D),1):delete q[re]}),this}},emit:function(R,D){this.options.domEvents&&Dwe(R,D);var q=this.handlers[R]&&this.handlers[R].slice();if(!(!q||!q.length)){D.type=R,D.preventDefault=function(){D.srcEvent.preventDefault()};for(var re=0;re<q.length;)q[re](D),re++}},destroy:function(){this.element&&gH(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function gH(R,D){var q=R.element;if(q.style){var re;m(R.options.cssProps,function(pe,$e){re=V(q.style,$e),D?(R.oldCssProps[re]=q.style[re],q.style[re]=pe):q.style[re]=R.oldCssProps[re]||""}),D||(R.oldCssProps={})}}function Dwe(R,D){var q=i.createEvent("Event");q.initEvent(R,!0,!0),q.gesture=D,D.target.dispatchEvent(q)}y(Si,{INPUT_START:Be,INPUT_MOVE:gt,INPUT_END:Pe,INPUT_CANCEL:De,STATE_POSSIBLE:Vp,STATE_BEGAN:qo,STATE_CHANGED:Lu,STATE_ENDED:Fi,STATE_RECOGNIZED:gc,STATE_CANCELLED:zp,STATE_FAILED:hl,DIRECTION_NONE:ii,DIRECTION_LEFT:Rr,DIRECTION_RIGHT:At,DIRECTION_UP:mo,DIRECTION_DOWN:bs,DIRECTION_HORIZONTAL:Ai,DIRECTION_VERTICAL:un,DIRECTION_ALL:fc,Manager:jp,Input:ur,TouchAction:a_,TouchInput:n_,MouseInput:r_,PointerEventInput:px,TouchMouseInput:Fp,SingleTouchInput:sE,Recognizer:yc,AttrRecognizer:dr,Tap:rt,Pan:c_,Swipe:ue,Pinch:fx,Rotate:ne,Press:j,on:T,off:C,each:m,merge:b,extend:v,assign:y,inherit:w,bindFn:x,prefixed:V});var Nwe=typeof e<"u"?e:typeof self<"u"?self:{};Nwe.Hammer=Si,typeof n=="function"&&n.amd?n(function(){return Si}):t.exports?t.exports=Si:e[r]=Si})(window,document,"Hammer")})(Iwe);var aft=Iwe.exports;const FI=oft(aft);/*!
* chartjs-plugin-zoom v2.0.1
* undefined
 * (c) 2016-2023 chartjs-plugin-zoom Contributors
 * Released under the MIT License
 */const WT=t=>t&&t.enabled&&t.modifierKey,Twe=(t,e)=>t&&e[t+"Key"],fH=(t,e)=>t&&!e[t+"Key"];function vg(t,e,i){return t===void 0?!0:typeof t=="string"?t.indexOf(e)!==-1:typeof t=="function"?t({chart:i}).indexOf(e)!==-1:!1}function gD(t,e){return typeof t=="function"&&(t=t({chart:e})),typeof t=="string"?{x:t.indexOf("x")!==-1,y:t.indexOf("y")!==-1}:{x:!1,y:!1}}function lft(t,e){let i;return function(){return clearTimeout(i),i=setTimeout(t,e),e}}function cft({x:t,y:e},i){const r=i.scales,n=Object.keys(r);for(let s=0;s<n.length;s++){const o=r[n[s]];if(e>=o.top&&e<=o.bottom&&t>=o.left&&t<=o.right)return o}return null}function Cwe(t,e,i){const{mode:r="xy",scaleMode:n,overScaleMode:s}=t||{},o=cft(e,i),a=gD(r,i),l=gD(n,i);if(s){const u=gD(s,i);for(const h of["x","y"])u[h]&&(l[h]=a[h],a[h]=!1)}if(o&&l[o.axis])return[o];const c=[];return Ot(i.scales,function(u){a[u.axis]&&c.push(u)}),c}const P6=new WeakMap;function nn(t){let e=P6.get(t);return e||(e={originalScaleLimits:{},updatedScaleLimits:{},handlers:{},panDelta:{}},P6.set(t,e)),e}function uft(t){P6.delete(t)}function Ewe(t,e,i){const r=t.max-t.min,n=r*(e-1),s=t.isHorizontal()?i.x:i.y,o=Math.max(0,Math.min(1,(t.getValueForPixel(s)-t.min)/r||0)),a=1-o;return{min:n*o,max:n*a}}function are(t,e,i,r,n){let s=i[r];if(s==="original"){const o=t.originalScaleLimits[e.id][r];s=ot(o.options,o.scale)}return ot(s,n)}function dft(t,e,i){const r=t.getValueForPixel(e),n=t.getValueForPixel(i);return{min:Math.min(r,n),max:Math.max(r,n)}}function ux(t,{min:e,max:i},r,n=!1){const s=nn(t.chart),{id:o,axis:a,options:l}=t,c=r&&(r[o]||r[a])||{},{minRange:u=0}=c,h=are(s,t,c,"min",-1/0),f=are(s,t,c,"max",1/0),m=n?Math.max(i-e,u):t.max-t.min,g=(m-i+e)/2;return e-=g,i+=g,e<h?(e=h,i=Math.min(h+m,f)):i>f&&(i=f,e=Math.max(f-m,h)),l.min=e,l.max=i,s.updatedScaleLimits[t.id]={min:e,max:i},t.parse(e)!==t.min||t.parse(i)!==t.max}function hft(t,e,i,r){const n=Ewe(t,e,i),s={min:t.min+n.min,max:t.max-n.max};return ux(t,s,r,!0)}function pft(t,e,i,r){ux(t,dft(t,e,i),r,!0)}const lre=t=>t===0||isNaN(t)?0:t<0?Math.min(Math.round(t),-1):Math.max(Math.round(t),1);function fft(t){const i=t.getLabels().length-1;t.min>0&&(t.min-=1),t.max<i&&(t.max+=1)}function mft(t,e,i,r){const n=Ewe(t,e,i);t.min===t.max&&e<1&&fft(t);const s={min:t.min+lre(n.min),max:t.max-lre(n.max)};return ux(t,s,r,!0)}function gft(t){return t.isHorizontal()?t.width:t.height}function yft(t,e,i){const n=t.getLabels().length-1;let{min:s,max:o}=t;const a=Math.max(o-s,1),l=Math.round(gft(t)/Math.max(a,10)),c=Math.round(Math.abs(e/l));let u;return e<-l?(o=Math.min(o+c,n),s=a===1?o:o-a,u=o===n):e>l&&(s=Math.max(0,s-c),o=a===1?s:s+a,u=s===0),ux(t,{min:s,max:o},i)||u}const vft={second:500,minute:30*1e3,hour:30*60*1e3,day:12*60*60*1e3,week:3.5*24*60*60*1e3,month:15*24*60*60*1e3,quarter:60*24*60*60*1e3,year:182*24*60*60*1e3};function Mwe(t,e,i,r=!1){const{min:n,max:s,options:o}=t,a=o.time&&o.time.round,l=vft[a]||0,c=t.getValueForPixel(t.getPixelForValue(n+l)-e),u=t.getValueForPixel(t.getPixelForValue(s+l)-e),{min:h=-1/0,max:f=1/0}=r&&i&&i[t.axis]||{};return isNaN(c)||isNaN(u)||c<h||u>f?!0:ux(t,{min:c,max:u},i,r)}function cre(t,e,i){return Mwe(t,e,i,!0)}const O6={category:mft,default:hft},L6={default:pft},R6={category:yft,default:Mwe,logarithmic:cre,timeseries:cre};function _ft(t,e,i){const{id:r,options:{min:n,max:s}}=t;if(!e[r]||!i[r])return!0;const o=i[r];return o.min!==n||o.max!==s}function ure(t,e){Ot(t,(i,r)=>{e[r]||delete t[r]})}function dx(t,e){const{scales:i}=t,{originalScaleLimits:r,updatedScaleLimits:n}=e;return Ot(i,function(s){_ft(s,r,n)&&(r[s.id]={min:{scale:s.min,options:s.options.min},max:{scale:s.max,options:s.options.max}})}),ure(r,i),ure(n,i),r}function dre(t,e,i,r){const n=O6[t.type]||O6.default;ct(n,[t,e,i,r])}function hre(t,e,i,r,n){const s=L6[t.type]||L6.default;ct(s,[t,e,i,r,n])}function bft(t){const e=t.chartArea;return{x:(e.left+e.right)/2,y:(e.top+e.bottom)/2}}function mH(t,e,i="none"){const{x:r=1,y:n=1,focalPoint:s=bft(t)}=typeof e=="number"?{x:e,y:e}:e,o=nn(t),{options:{limits:a,zoom:l}}=o;dx(t,o);const c=r!==1,u=n!==1,h=Cwe(l,s,t);Ot(h||t.scales,function(f){f.isHorizontal()&&c?dre(f,r,s,a):!f.isHorizontal()&&u&&dre(f,n,s,a)}),t.update(i),ct(l.onZoom,[{chart:t}])}function $we(t,e,i,r="none"){const n=nn(t),{options:{limits:s,zoom:o}}=n,{mode:a="xy"}=o;dx(t,n);const l=vg(a,"x",t),c=vg(a,"y",t);Ot(t.scales,function(u){u.isHorizontal()&&l?hre(u,e.x,i.x,s):!u.isHorizontal()&&c&&hre(u,e.y,i.y,s)}),t.update(r),ct(o.onZoom,[{chart:t}])}function wft(t,e,i,r="none"){dx(t,nn(t));const n=t.scales[e];ux(n,i,void 0,!0),t.update(r)}function xft(t,e="default"){const i=nn(t),r=dx(t,i);Ot(t.scales,function(n){const s=n.options;r[n.id]?(s.min=r[n.id].min.options,s.max=r[n.id].max.options):(delete s.min,delete s.max)}),t.update(e),ct(i.options.zoom.onZoomComplete,[{chart:t}])}function Sft(t,e){const i=t.originalScaleLimits[e];if(!i)return;const{min:r,max:n}=i;return ot(n.options,n.scale)-ot(r.options,r.scale)}function Ift(t){const e=nn(t);let i=1,r=1;return Ot(t.scales,function(n){const s=Sft(e,n.id);if(s){const o=Math.round(s/(n.max-n.min)*100)/100;i=Math.min(i,o),r=Math.max(r,o)}}),i<1?i:r}function pre(t,e,i,r){const{panDelta:n}=r,s=n[t.id]||0;sc(s)===sc(e)&&(e+=s);const o=R6[t.type]||R6.default;ct(o,[t,e,i])?n[t.id]=0:n[t.id]=e}function Awe(t,e,i,r="none"){const{x:n=0,y:s=0}=typeof e=="number"?{x:e,y:e}:e,o=nn(t),{options:{pan:a,limits:l}}=o,{onPan:c}=a||{};dx(t,o);const u=n!==0,h=s!==0;Ot(i||t.scales,function(f){f.isHorizontal()&&u?pre(f,n,l,o):!f.isHorizontal()&&h&&pre(f,s,l,o)}),t.update(r),ct(c,[{chart:t}])}function kwe(t){const e=nn(t);dx(t,e);const i={};for(const r of Object.keys(t.scales)){const{min:n,max:s}=e.originalScaleLimits[r]||{min:{},max:{}};i[r]={min:n.scale,max:s.scale}}return i}function Tft(t){const e=kwe(t);for(const i of Object.keys(t.scales)){const{min:r,max:n}=e[i];if(r!==void 0&&t.scales[i].min!==r||n!==void 0&&t.scales[i].max!==n)return!0}return!1}function va(t,e){const{handlers:i}=nn(t),r=i[e];r&&r.target&&(r.target.removeEventListener(e,r),delete i[e])}function DI(t,e,i,r){const{handlers:n,options:s}=nn(t),o=n[i];o&&o.target===e||(va(t,i),n[i]=a=>r(t,a,s),n[i].target=e,e.addEventListener(i,n[i]))}function Cft(t,e){const i=nn(t);i.dragStart&&(i.dragging=!0,i.dragEnd=e,t.update("none"))}function Eft(t,e){const i=nn(t);!i.dragStart||e.key!=="Escape"||(va(t,"keydown"),i.dragging=!1,i.dragStart=i.dragEnd=null,t.update("none"))}function Pwe(t,e,i){const{onZoomStart:r,onZoomRejected:n}=i;if(r){const s=bd(e,t);if(ct(r,[{chart:t,event:e,point:s}])===!1)return ct(n,[{chart:t,event:e}]),!1}}function Mft(t,e){const i=nn(t),{pan:r,zoom:n={}}=i.options;if(e.button!==0||Twe(WT(r),e)||fH(WT(n.drag),e))return ct(n.onZoomRejected,[{chart:t,event:e}]);Pwe(t,e,n)!==!1&&(i.dragStart=e,DI(t,t.canvas,"mousemove",Cft),DI(t,window.document,"keydown",Eft))}function Owe(t,e,i,r){const n=vg(e,"x",t),s=vg(e,"y",t);let{top:o,left:a,right:l,bottom:c,width:u,height:h}=t.chartArea;const f=bd(i,t),m=bd(r,t);n&&(a=Math.min(f.x,m.x),l=Math.max(f.x,m.x)),s&&(o=Math.min(f.y,m.y),c=Math.max(f.y,m.y));const g=l-a,y=c-o;return{left:a,top:o,right:l,bottom:c,width:g,height:y,zoomX:n&&g?1+(u-g)/u:1,zoomY:s&&y?1+(h-y)/h:1}}function $ft(t,e){const i=nn(t);if(!i.dragStart)return;va(t,"mousemove");const{mode:r,onZoomComplete:n,drag:{threshold:s=0}}=i.options.zoom,o=Owe(t,r,i.dragStart,e),a=vg(r,"x",t)?o.width:0,l=vg(r,"y",t)?o.height:0,c=Math.sqrt(a*a+l*l);if(i.dragStart=i.dragEnd=null,c<=s){i.dragging=!1,t.update("none");return}$we(t,{x:o.left,y:o.top},{x:o.right,y:o.bottom},"zoom"),setTimeout(()=>i.dragging=!1,500),ct(n,[{chart:t}])}function Aft(t,e,i){if(fH(WT(i.wheel),e)){ct(i.onZoomRejected,[{chart:t,event:e}]);return}if(Pwe(t,e,i)!==!1&&(e.cancelable&&e.preventDefault(),e.deltaY!==void 0))return!0}function kft(t,e){const{handlers:{onZoomComplete:i},options:{zoom:r}}=nn(t);if(!Aft(t,e,r))return;const n=e.target.getBoundingClientRect(),s=1+(e.deltaY>=0?-r.wheel.speed:r.wheel.speed),o={x:s,y:s,focalPoint:{x:e.clientX-n.left,y:e.clientY-n.top}};mH(t,o),i&&i()}function Pft(t,e,i,r){i&&(nn(t).handlers[e]=lft(()=>ct(i,[{chart:t}]),r))}function Oft(t,e){const i=t.canvas,{wheel:r,drag:n,onZoomComplete:s}=e.zoom;r.enabled?(DI(t,i,"wheel",kft),Pft(t,"onZoomComplete",s,250)):va(t,"wheel"),n.enabled?(DI(t,i,"mousedown",Mft),DI(t,i.ownerDocument,"mouseup",$ft)):(va(t,"mousedown"),va(t,"mousemove"),va(t,"mouseup"),va(t,"keydown"))}function Lft(t){va(t,"mousedown"),va(t,"mousemove"),va(t,"mouseup"),va(t,"wheel"),va(t,"click"),va(t,"keydown")}function Rft(t,e){return function(i,r){const{pan:n,zoom:s={}}=e.options;if(!n||!n.enabled)return!1;const o=r&&r.srcEvent;return o&&!e.panning&&r.pointerType==="mouse"&&(fH(WT(n),o)||Twe(WT(s.drag),o))?(ct(n.onPanRejected,[{chart:t,event:r}]),!1):!0}}function Fft(t,e){const i=Math.abs(t.clientX-e.clientX),r=Math.abs(t.clientY-e.clientY),n=i/r;let s,o;return n>.3&&n<1.7?s=o=!0:i>r?s=!0:o=!0,{x:s,y:o}}function Lwe(t,e,i){if(e.scale){const{center:r,pointers:n}=i,s=1/e.scale*i.scale,o=i.target.getBoundingClientRect(),a=Fft(n[0],n[1]),l=e.options.zoom.mode,c={x:a.x&&vg(l,"x",t)?s:1,y:a.y&&vg(l,"y",t)?s:1,focalPoint:{x:r.x-o.left,y:r.y-o.top}};mH(t,c),e.scale=i.scale}}function Dft(t,e){e.options.zoom.pinch.enabled&&(e.scale=1)}function Nft(t,e,i){e.scale&&(Lwe(t,e,i),e.scale=null,ct(e.options.zoom.onZoomComplete,[{chart:t}]))}function Rwe(t,e,i){const r=e.delta;r&&(e.panning=!0,Awe(t,{x:i.deltaX-r.x,y:i.deltaY-r.y},e.panScales),e.delta={x:i.deltaX,y:i.deltaY})}function Vft(t,e,i){const{enabled:r,onPanStart:n,onPanRejected:s}=e.options.pan;if(!r)return;const o=i.target.getBoundingClientRect(),a={x:i.center.x-o.left,y:i.center.y-o.top};if(ct(n,[{chart:t,event:i,point:a}])===!1)return ct(s,[{chart:t,event:i}]);e.panScales=Cwe(e.options.pan,a,t),e.delta={x:0,y:0},clearTimeout(e.panEndTimeout),Rwe(t,e,i)}function zft(t,e){e.delta=null,e.panning&&(e.panEndTimeout=setTimeout(()=>e.panning=!1,500),ct(e.options.pan.onPanComplete,[{chart:t}]))}const F6=new WeakMap;function jft(t,e){const i=nn(t),r=t.canvas,{pan:n,zoom:s}=e,o=new FI.Manager(r);s&&s.pinch.enabled&&(o.add(new FI.Pinch),o.on("pinchstart",()=>Dft(t,i)),o.on("pinch",a=>Lwe(t,i,a)),o.on("pinchend",a=>Nft(t,i,a))),n&&n.enabled&&(o.add(new FI.Pan({threshold:n.threshold,enable:Rft(t,i)})),o.on("panstart",a=>Vft(t,i,a)),o.on("panmove",a=>Rwe(t,i,a)),o.on("panend",()=>zft(t,i))),F6.set(t,o)}function Bft(t){const e=F6.get(t);e&&(e.remove("pinchstart"),e.remove("pinch"),e.remove("pinchend"),e.remove("panstart"),e.remove("pan"),e.remove("panend"),e.destroy(),F6.delete(t))}var Uft="2.0.1";function v$(t,e,i){const r=i.zoom.drag,{dragStart:n,dragEnd:s}=nn(t);if(r.drawTime!==e||!s)return;const{left:o,top:a,width:l,height:c}=Owe(t,i.zoom.mode,n,s),u=t.ctx;u.save(),u.beginPath(),u.fillStyle=r.backgroundColor||"rgba(225,225,225,0.3)",u.fillRect(o,a,l,c),r.borderWidth>0&&(u.lineWidth=r.borderWidth,u.strokeStyle=r.borderColor||"rgba(225,225,225)",u.strokeRect(o,a,l,c)),u.restore()}var Gft={id:"zoom",version:Uft,defaults:{pan:{enabled:!1,mode:"xy",threshold:10,modifierKey:null},zoom:{wheel:{enabled:!1,speed:.1,modifierKey:null},drag:{enabled:!1,drawTime:"beforeDatasetsDraw",modifierKey:null},pinch:{enabled:!1},mode:"xy"}},start:function(t,e,i){const r=nn(t);r.options=i,Object.prototype.hasOwnProperty.call(i.zoom,"enabled")&&console.warn("The option `zoom.enabled` is no longer supported. Please use `zoom.wheel.enabled`, `zoom.drag.enabled`, or `zoom.pinch.enabled`."),(Object.prototype.hasOwnProperty.call(i.zoom,"overScaleMode")||Object.prototype.hasOwnProperty.call(i.pan,"overScaleMode"))&&console.warn("The option `overScaleMode` is deprecated. Please use `scaleMode` instead (and update `mode` as desired)."),FI&&jft(t,i),t.pan=(n,s,o)=>Awe(t,n,s,o),t.zoom=(n,s)=>mH(t,n,s),t.zoomRect=(n,s,o)=>$we(t,n,s,o),t.zoomScale=(n,s,o)=>wft(t,n,s,o),t.resetZoom=n=>xft(t,n),t.getZoomLevel=()=>Ift(t),t.getInitialScaleBounds=()=>kwe(t),t.isZoomedOrPanned=()=>Tft(t)},beforeEvent(t){const e=nn(t);if(e.panning||e.dragging)return!1},beforeUpdate:function(t,e,i){const r=nn(t);r.options=i,Oft(t,i)},beforeDatasetsDraw(t,e,i){v$(t,"beforeDatasetsDraw",i)},afterDatasetsDraw(t,e,i){v$(t,"afterDatasetsDraw",i)},beforeDraw(t,e,i){v$(t,"beforeDraw",i)},afterDraw(t,e,i){v$(t,"afterDraw",i)},stop:function(t){Lft(t),FI&&Bft(t),uft(t)},panFunctions:R6,zoomFunctions:O6,zoomRectFunctions:L6};const Hft=(t,e)=>{t.map=new e.Map({basemap:"arcgis-topographic",ground:"world-elevation"})},qft=(t,e)=>{const i=new e.MapView({map:t.map,center:t.defaultView.center,zoom:t.defaultView.zoom,container:"viewDiv",padding:{top:50},highlightOptions:{color:"rgba(0,0,0, 0.8)"},constraints:{minZoom:8,maxZoom:20}});i.ui.add("compass","top-left"),e.reactiveUtils.whenOnce(()=>!i.updating).then(()=>{t.stopLoader()}),i.popup.collapseEnabled=!1,i.popup.dockEnabled=!0,i.popup.visibleElements={featureNavigation:!1},i.popup.dockOptions={buttonEnabled:!1,breakpoint:!1,position:"top-right"},t.widgets={};const r=document.createElement("div");r.id="basemap-toggle",t.widgets.basemapToggle=new e.BasemapToggle({view:i,nextBasemap:"satellite",container:r}),e.reactiveUtils.whenOnce(()=>i.map.findLayerById("satellite-base-layer")).then(()=>{const s=i.map.findLayerById("satellite-base-layer");s.effect="sepia(50%) opacity(50%)"}),i.ui.add(t.widgets.basemapToggle,{position:"top-left"}),t.widgets.search=new e.Search({view:i,locationEnabled:!1,searchAllEnabled:!1,includeDefaultSources:!1}),i.ui.add(t.widgets.eS=new e.Expand({expandTooltip:"Search",expandIcon:"search",content:t.widgets.search}),"top-left"),t.widgets.layerList=new e.LayerList({view:i}),i.ui.add(t.widgets.eLayerList=new e.Expand({expandTooltip:"Layer List",expandIcon:"show-multiple-layers-at-a-time",content:t.widgets.layerList}),"top-left"),t.widgets.legend=new e.Legend({view:i}),i.ui.add(t.widgets.eLegend=new e.Expand({expandTooltip:"Legend",expandIcon:"legend",content:t.widgets.legend}),"top-left"),t.widgets.elevationProfile=new e.ElevationProfile({view:i,unit:"meters",unitOptions:["meters"],profiles:[{type:"ground"}],visibleElements:{legend:!1,chart:!0,clearButton:!0,settingsButton:!1,sketchButton:!0,selectButton:!1,uniformChartScalingToggle:!0}}),i.ui.add(t.widgets.eElevationProfile=new e.Expand({expandTooltip:"Elevation Profile",content:t.widgets.elevationProfile}),"top-left");const n=document.createElement("div");n.id="zoom-to-layer-extent",n.className="esri-widget esri-widget--button esri-interactive",n.title="Zoom to all gauges",n.innerHTML='<calcite-icon icon="layer-zoom-to" text-label="Zoom to all gauges"></calcite-icon>',document.body.appendChild(n),i.ui.add("zoom-to-layer-extent","top-left"),n.addEventListener("click",()=>{t.layers.rgToc.queryExtent().then(s=>{i.goTo(s.extent,{duration:1e3}).catch(o=>{console.error(o)})})}),t.view=i},Wft=(t,e)=>{const i=t.map;t.layers={};const r=["gold-coast-city","somerset-regional","scenic-rim-regional"];let n=null;const o=new URLSearchParams(document.location.search).get("lga");o&&r.indexOf(o)>0&&(n=o);const a=n||r[0];t.layers.channels=Jft(e.ImageryTileLayer),t.layers.sws=Zft(e.GeoJSONLayer,`./gis/${a}/sws.json`),t.layers.ab=Yft(e.GeoJSONLayer,`./gis/${a}/ab.json`),t.layers.lfps=Kft(e.GeoJSONLayer,`./gis/${a}/lfps.json`),t.layers.rgRelocation=Xft(e.GeoJSONLayer,`./gis/${a}/rg-relocation.json`),t.layers.rgToc=Qft(e.GeoJSONLayer,`./gis/${a}/rg-toc.json`,e.LabelClass,t.tocColors),emt(t,e.reactiveUtils),i.add(t.layers.channels),i.add(t.layers.sws),i.add(t.layers.lfps),i.add(t.layers.ab),i.add(t.layers.rgRelocation),i.add(t.layers.rgToc)},Jft=t=>{const e=new t({title:"Channels",url:"./gis/channels.tif",visible:!1});return e.renderer={type:"raster-colormap",colormapInfos:[{value:1,color:"rgb(0,192,255)",label:">100"},{value:2,color:"rgb(0,128,255)",label:">1000"},{value:3,color:"rgb(0,96,192)",label:">10000"},{value:4,color:"rgb(0,64,128)",label:">100000"},{value:5,color:"rgb(0,32,64)",label:">1000000"}]},e.opacity=.75,e},Zft=(t,e)=>{const i={type:"simple",symbol:{type:"simple-fill",color:"rgba(0,64,128,0.2)",outline:{color:"rgba(0,64,128,1)",width:1}}};return new t({id:"sws",title:"Subwatershed",url:e,displayField:"code",objectIdField:"code",outFields:["*"],orderBy:{field:"area"},renderer:i,definitionExpression:"code = ''",listMode:"hide"})},Yft=(t,e)=>{const i={type:"simple",symbol:{type:"simple-fill",style:"none",outline:{color:"#f0f",width:2,style:"short-dot"}}};return new t({id:"ab",title:"Administrative Boundary",url:e,displayField:"lga_name",objectIdField:"fid",renderer:i,opacity:.5})},Kft=(t,e)=>{const i={type:"simple",symbol:{type:"simple-line",style:"short-dot",width:2,color:"rgb(0,64,128)"}};return new t({id:"lfps",title:"Longest Flow Path",url:e,displayField:"code",objectIdField:"code",outFields:["*"],orderBy:{field:"length"},renderer:i,definitionExpression:"code = ''",listMode:"hide"})},Xft=(t,e)=>{const i={type:"simple",symbol:{type:"simple-line",width:2,color:"rgb(128,0,128)"}};return new t({id:"rg-relocation",title:"Rainfall Gauge Relocation",url:e,displayField:"code",objectIdField:"code",outFields:["*"],renderer:i,visible:!1})},Qft=(t,e,i,r)=>{const n={type:"pie-chart",holePercentage:.3,othersCategory:{threshold:.05,color:"gray"},attributes:[{field:"toc_jbp",label:"TOC JBP",color:r[0]},{field:"toc_kir",label:"TOC Kirpich",color:r[1]},{field:"toc_pil",label:"TOC Pilgrim McDermott",color:r[2]},{field:"toc_bw_avg",label:"TOC Bransby Williams (avg)",color:r[3]},{field:"toc_bw_eqa",label:"TOC Bransby Williams (eqa)",color:r[4]}],size:15};n.visualVariables=[{legendOptions:{title:"TOC in hours"},type:"size",valueExpression:"($feature.toc_kir + $feature.toc_pil)/2",minSize:15,maxSize:60,minDataValue:0,maxDataValue:40}];const s=new t({id:"rgToc",title:"Rainfall Gauge - Time of Concentration",url:e,displayField:"code",objectIdField:"fid",outFields:["*"],renderer:n,featureEffect:{filter:{where:"calc_toc > 0"},includedEffect:"drop-shadow(0px, 0px, 5px, #666)",excludedEffect:"opacity(80%)",excludedLabelsVisible:!0},popupTemplate:{title:"{code}, {name}",actions:[{title:"Show subwatershed",id:"show-sws",icon:"drive-time"}],content:[{type:"media",mediaInfos:[{type:"column-chart",caption:"Time of concentation (hours)",value:{fields:["toc_jbp","toc_kir","toc_pil","toc_bw_avg","toc_bw_eqa"],normalizeField:null,tooltipField:"TOC values for various methodologies"}}]},{type:"fields",fieldInfos:[{fieldName:"toc_jbp",label:"TOC JBP",format:{places:2,digitSeparator:!0},stringFieldOption:"text-box"},{fieldName:"toc_kir",label:"TOC Kirpich",format:{places:2,digitSeparator:!0},stringFieldOption:"text-box"},{fieldName:"toc_pil",label:"TOC Pilgrim McDermott",format:{places:2,digitSeparator:!0},stringFieldOption:"text-box"},{fieldName:"toc_bw_avg",label:"TOC Bransby Williams (avg)",format:{places:2,digitSeparator:!0},stringFieldOption:"text-box"},{fieldName:"toc_bw_eqa",label:"TOC Bransby Williams (eqa)",format:{places:2,digitSeparator:!0},stringFieldOption:"text-box"},{fieldName:"sw_area",label:"Subwatershed area:",format:{places:0,digitSeparator:!0},stringFieldOption:"text-box"},{fieldName:"lfp_len",label:"LFP length",format:{places:0,digitSeparator:!0},stringFieldOption:"text-box"},{fieldName:"lfp_dem_min",label:"LFP outlet elevation",format:{places:0,digitSeparator:!0},stringFieldOption:"text-box"},{fieldName:"lfp_dem_max",label:"LFP top elevation",format:{places:0,digitSeparator:!0},stringFieldOption:"text-box"}]}]},copyright:"QIT Plus"}),o=new i({labelExpressionInfo:{expression:"$feature.code"},symbol:{type:"text",color:r[1],haloSize:1,haloColor:"white"}});return s.labelingInfo=[o],s},emt=(t,e)=>{const i=t.view;e.on(()=>i.popup.viewModel,"trigger-action",s=>{s.action.id==="show-sws"&&r()});const r=()=>{const s=i.popup.selectedFeature.attributes.code;t.layers.rgToc.featureEffect={filter:{where:`code = '${s}'`},includedEffect:"drop-shadow(0px, 0px, 5px, #666)",excludedEffect:"opacity(25%)",excludedLabelsVisible:!1},t.layers.lfps.definitionExpression=`code = '${s}'`,t.layers.sws.definitionExpression=`code = '${s}'`,t.layers.sws.queryExtent().then(o=>{i.goTo(o.extent,{duration:1e3}).catch(a=>{console.error(a)})}),t.layers.lfps.queryFeatures().then(o=>{t.widgets.elevationProfile.input=o.features[0],t.widgets.eElevationProfile.expand()})},n=()=>{t.layers.rgToc.featureEffect={filter:{where:"calc_toc > 0"},includedEffect:"drop-shadow(0px, 0px, 5px, #666)",excludedEffect:"opacity(80%)",excludedLabelsVisible:!0},t.layers.lfps.definitionExpression="code = ''",t.layers.sws.definitionExpression="code = ''",t.widgets.eElevationProfile.collapse()};e.watch(()=>i.popup.selectedFeature,s=>{if(s&&(n(),s.layer.id=="rgToc")){const o=s.getEffectivePopupTemplate();o.actions.items[0].visible=!!s.attributes.calc_toc}}),t.widgets.search.sources=[{layer:t.layers.rgToc,searchFields:["code","name"],suggestionTemplate:"{code} - {name}",exactMatch:!1,outFields:["code","name","calc_toc"],name:"Gauges",placeholder:"Gauge code or name",maxSuggestions:6,minSuggestCharacters:2,zoomScale:5e4}]},tmt=()=>{const t=document.createElement("div");t.id="bottomContainer",t.className="collapsed",t.innerHTML=`
        <div id="tableDivToggle" class="active esri-widget--button">Table</div>
        <div id="chartDivToggle" class="esri-widget--button">Chart</div>
        <div id="eViewDivToggle" class="esri-widget--button">eView</div>
        <div id="bcDivToggle" class="esri-widget--button">&#8613;</div>
        <div id="bcDivResize" class="esri-widget--button">&#8597;</div>
        <div id="tableDiv"></div>
        <div id="chartDiv" class="hidden">
            <div id="tocLineChartDivToggle" class="active esri-widget--button">Line</div>
            <div id="tocBubbleChartDivToggle" class="esri-widget--button">Bubble</div>
            <div id="tocLineChartDiv">
                <canvas id="tocLineChartCanvas"></canvas>
            </div>
            <div id="tocBubbleChartDiv" class="hidden">
                <div id="tocBubbleChartToggle" class="esri-widget--button"><calcite-icon icon="round-about-right" text-label="Toggle chart"></calcite-icon></div>
                <canvas id="tocBubbleChartCanvas"></canvas>
            </div>
        </div>
        <div id="eViewDiv" class="hidden">View events log:</div>`,document.body.appendChild(t);const e=document.getElementById("tableDivToggle"),i=document.getElementById("chartDivToggle"),r=document.getElementById("eViewDivToggle"),n=document.getElementById("bcDivToggle"),s=document.getElementById("bcDivResize"),o=document.getElementById("tocLineChartDivToggle"),a=document.getElementById("tocBubbleChartDivToggle");e.addEventListener("click",()=>l(!0,"tableDiv")),i.addEventListener("click",()=>l(!0,"chartDiv")),r.addEventListener("click",()=>l(!0,"eViewDiv")),n.addEventListener("click",()=>l()),o.addEventListener("click",()=>h("tocLineChartDiv")),a.addEventListener("click",()=>h("tocBubbleChartDiv"));const l=(f=!1,m="")=>{if(!f||f&&t.classList.contains("collapsed")){const g=t.classList.toggle("collapsed");n.innerHTML=g?"&#8613;":"&#10515;",s.style.visibility=g?"hidden":"visible"}if(m){let g=["tableDiv","chartDiv","eViewDiv"];if(g.includes(m)){let y=document.getElementById(m);if(y.classList.contains("hidden")){y.classList.remove("hidden"),y=document.getElementById(m+"Toggle"),y.classList.add("active"),g=g.filter(v=>v!==m);for(const v of g)y=document.getElementById(v),y.classList.add("hidden"),y=document.getElementById(v+"Toggle"),y.classList.remove("active")}}}};let c;s.addEventListener("mousedown",f=>{c=f.y,document.addEventListener("mousemove",u,!1)},!1),document.addEventListener("mouseup",()=>{document.removeEventListener("mousemove",u,!1)},!1);const u=f=>{const m=c-f.y;c=f.y,t.style.height=parseInt(getComputedStyle(t,"").height)+m+"px"},h=(f="")=>{if(f){let m=["tocLineChartDiv","tocBubbleChartDiv"];if(m.includes(f)){let g=document.getElementById(f);if(g.classList.contains("hidden")){g.classList.remove("hidden"),g=document.getElementById(f+"Toggle"),g.classList.add("active"),m=m.filter(y=>y!==f);for(const y of m)g=document.getElementById(y),g.classList.add("hidden"),g=document.getElementById(y+"Toggle"),g.classList.remove("active")}}}}},imt=(t,e)=>{t.featureTable=new e.FeatureTable({lable:"Time of concentration",view:t.view,multiSortEnabled:!0,layer:t.layers.rgToc,container:document.getElementById("tableDiv"),tableTemplate:new e.TableTemplate({columnTemplates:[{type:"field",fieldName:"code",label:"Code",direction:"asc"},{type:"field",fieldName:"name",label:"Name"},{type:"field",fieldName:"catchment",label:"Catchment",visible:!1},{type:"field",fieldName:"sw_area",label:"Subwatershed area",visible:!1},{type:"field",fieldName:"lfp_len",label:"LFP length",visible:!1},{type:"field",fieldName:"lfp_dem_min",label:"LFP outlet elevation",visible:!1},{type:"field",fieldName:"lfp_dem_max",label:"LFP top elevation",visible:!1},{type:"field",fieldName:"lfp_dem_slope_avg",label:"Average slope",visible:!1},{type:"field",fieldName:"lfp_dem_slope_eqa",label:"Equal area slope",visible:!1},{type:"field",fieldName:"toc_jbp",label:"TOC JBP"},{type:"field",fieldName:"toc_kir",label:"TOC Kirpich"},{type:"field",fieldName:"toc_pil",label:"TOC Pilgrim McDermott"},{type:"field",fieldName:"toc_bw_avg",label:"TOC Bransby Williams (avg)"},{type:"field",fieldName:"toc_bw_eqa",label:"TOC Bransby Williams (eqa)"}]}),visibleElements:{header:!0,menu:!0,menuItems:{clearSelection:!1,refreshData:!1,toggleColumns:!0,selectedRecordsShowAllToggle:!1,selectedRecordsShowSelectedToggle:!1,zoomToSelection:!1},selectionColumn:!1,columnMenus:!1}})},rmt=(t,e)=>{t.charts={},e.defaults.color=getComputedStyle(document.body).getPropertyValue("--qitp-primary-color"),t.layers.rgToc.queryFeatures({where:"calc_toc = 1",outFields:["*"]}).then(i=>{i.features.length&&(t.charts.tocLineChart=nmt(t,e,i.features),t.charts.tocBubbleChart=smt(t,e,i.features),document.getElementById("tocBubbleChartToggle").addEventListener("click",()=>{omt(t)}))})},nmt=(t,e,i)=>{const r=t.tocColors,n=document.getElementById("tocLineChartCanvas"),s=i.map(m=>m.attributes);s.sort((m,g)=>m.toc_kir-g.toc_kir);const o=s.map(m=>m.code),a=s.map(m=>m.toc_jbp?m.toc_jbp:NaN),l=s.map(m=>m.toc_kir),c=s.map(m=>m.toc_pil),u=s.map(m=>m.toc_bw_avg),h=s.map(m=>m.toc_bw_eqa),f=new e(n,{type:"line",data:{labels:o,datasets:[{label:"TOC JBP",data:a,pointRadius:5,borderColor:r[0]+"33",backgroundColor:r[0],tension:.4},{label:"TOC Kirpich",data:l,pointRadius:5,borderColor:r[1]+"33",backgroundColor:r[1],tension:.4},{label:"TOC Pilgrim McDermott",data:c,pointRadius:5,borderColor:r[2]+"33",backgroundColor:r[2],tension:.4},{label:"TOC Bransby Williams (avg)",data:u,pointRadius:5,borderColor:r[3]+"33",backgroundColor:r[3],tension:.4},{label:"TOC Bransby Williams (eqa)",data:h,pointRadius:5,borderColor:r[4],backgroundColor:r[4],tension:.4,hidden:!0}]},options:{maintainAspectRatio:!1,scales:{y:{title:{display:!0,text:"TOC (h)"},min:0,max:30}},onClick:(m,g)=>{if(g.length===0)return;const{dataIndex:y,raw:v}=g[0].element.$context,b=m.chart.data.labels[y];t.layers.rgToc.queryFeatures({where:`code = '${b}'`,returnGeometry:!0}).then(w=>{if(w.features.length){const x=w.features[0];t.view.goTo({target:x.geometry,zoom:15},{duration:1e3}),t.view.openPopup({features:[x]})}})},plugins:{zoom:{limits:{y:{min:0,max:30}},zoom:{wheel:{enabled:!0},drag:{enabled:!0,threshold:10}}},title:{display:!0,text:"Time of Concentration Methodologies per Gauge"}}}});return n.addEventListener("dblclick",()=>{f.resetZoom()}),f},smt=(t,e,i)=>{const r=t.tocColors;t.charts.tocBubbleData={},t.charts.tocBubbleData.lfp_len=[],t.charts.tocBubbleData.sw_area=[],t.charts.tocBubbleData.slope_avg=[],t.charts.tocBubbleData.mode=0,t.charts.tocBubbleData.params=[["LFP Length","km"],["Subwatershed Area","sqkm"],["TOC","h"],["Slope","m/km"]];const n=t.charts.tocBubbleData.params,s=document.getElementById("tocBubbleChartCanvas"),o=[],a=[],l=[],c=[],u=[],h=[],f=(x,S,I,T)=>{var C=I-x,E=(T-I)/(S-x);return function($){return C+E*$}},m=i.map(x=>x.attributes),g=Math.max(...m.map(x=>x.lfp_len)),y=Math.max(...m.map(x=>x.sw_area)),v=f(0,g,5,50),b=f(0,y,5,50);for(const x of m){o.push(x.code);const S=Math.round(x.lfp_len/10)/100;t.charts.tocBubbleData.slope_avg.push(Math.round(x.lfp_dem_slope_avg*100)/100);const I=Math.round(v(x.lfp_len));t.charts.tocBubbleData.lfp_len.push([S,I]);const T=Math.round(x.sw_area/1e4)/100,C=Math.round(b(x.sw_area));t.charts.tocBubbleData.sw_area.push([T,C]),a.push({x:S,y:T,r:x.toc_jbp?x.toc_jbp:NaN}),l.push({x:S,y:T,r:x.toc_kir}),c.push({x:S,y:T,r:x.toc_pil}),u.push({x:S,y:T,r:x.toc_bw_avg}),h.push({x:S,y:T,r:x.toc_bw_eqa})}const w=new e(s,{type:"bubble",data:{labels:o,datasets:[{label:"TOC JBP",data:a,pointRadius:5,borderColor:r[0],backgroundColor:r[0]+"33"},{label:"TOC Kirpich",data:l,pointRadius:5,borderColor:r[1],backgroundColor:r[1]+"33"},{label:"TOC Pilgrim McDermott",data:c,pointRadius:5,borderColor:r[2],backgroundColor:r[2]+"33"},{label:"TOC Bransby Williams (avg)",data:u,pointRadius:5,borderColor:r[3],backgroundColor:r[3]+"33"},{label:"TOC Bransby Williams (eqa)",data:h,pointRadius:5,borderColor:r[4],backgroundColor:r[4]+"33",hidden:!0}]},options:{maintainAspectRatio:!1,scales:{x:{title:{display:!0,text:`${n[0][0]} (${n[0][1]})`}},y:{title:{display:!0,text:`${n[1][0]} (${n[1][1]})`}}},onClick:(x,S)=>{if(S.length===0)return;const{dataIndex:I,raw:T}=S[0].element.$context,C=x.chart.data.labels[I];t.layers.rgToc.queryFeatures({where:`code = '${C}'`,returnGeometry:!0}).then(E=>{if(E.features.length){const $=E.features[0];t.view.goTo({target:$.geometry,zoom:15},{duration:1e3}),t.view.openPopup({features:[$]})}})},plugins:{zoom:{zoom:{wheel:{enabled:!0},drag:{enabled:!0,threshold:10}}},title:{display:!0,text:`${n[2][0]} (${n[2][1]}) by ${n[0][0]} (${n[0][1]}) x ${n[1][0]} (${n[1][1]})`}}}});return s.addEventListener("dblclick",()=>{w.resetZoom()}),w},omt=t=>{const e=t.charts.tocBubbleChart,i=t.charts.tocBubbleData.lfp_len,r=t.charts.tocBubbleData.sw_area,n=t.charts.tocBubbleData.slope_avg,s=t.charts.tocBubbleData.params;let o=t.charts.tocBubbleData.mode;o=o+1==4?0:o+1,t.charts.tocBubbleData.mode=o;for(const a of e.data.datasets)for(let l=0;l<i.length;l++)o==0?(e.options.scales.x.max=null,a.data[l].r=a.data[l].y,a.data[l].x=i[l][0],a.data[l].y=r[l][0],e.options.plugins.title.text=`${s[2][0]} (${s[2][1]}) by ${s[0][0]} (${s[0][1]}) x ${s[1][0]} (${s[1][1]})`,e.options.scales.x.title.text=`${s[0][0]} (${s[0][1]})`,e.options.scales.y.title.text=`${s[1][0]} (${s[1][1]})`):o==1?(a.data[l].y=a.data[l].r,a.data[l].x=i[l][0],a.data[l].r=r[l][1],e.options.plugins.title.text=`${s[1][0]} (Scaled to 5 - 50 px) by ${s[0][0]} (${s[0][1]}) x ${s[2][0]} (${s[2][1]})`,e.options.scales.y.title.text=`${s[2][0]} (${s[2][1]})`):o==2?(a.data[l].x=r[l][0],a.data[l].r=i[l][1],e.options.plugins.title.text=`${s[0][0]} (Scaled to 5 - 50 px) by ${s[0][0]} (${s[1][1]}) x ${s[2][0]} (${s[2][1]})`,e.options.scales.x.title.text=`${s[1][0]} (${s[1][1]})`):(a.data[l].x=n[l],a.data[l].r=i[l][1],e.options.plugins.title.text=`${s[0][0]} (Scaled to 5 - 50 px) by ${s[3][0]} (${s[3][1]}) x ${s[2][0]} (${s[2][1]})`,e.options.scales.x.title.text=`${s[3][0]} (${s[3][1]})`,e.options.scales.x.max=50);e.update(0)},amt=(t,e)=>{const i=t.view,r=document.getElementById("eViewDiv"),n=o=>{o.name&&o.message&&`${o.name}${o.message}`,s(info)};i.when(()=>{s("<span> view.when </span> --- view loaded successfully")}).catch(n),i.map.allLayers.on("change",o=>{o.added.length>0&&o.added.forEach(a=>{const l=`<span> layer added: </span> ${a.id} - ${a.title}`;s(l)})}),i.on("layerview-create",o=>{const a=`<span> layer created: </span> ${o.layer.id} - ${o.layer.title} is ${o.layer.loadStatus}`;s(a)}),e.watch(()=>i.map.basemap,o=>{const a=`<span> Basemap changed: </span> ${o.id}`;s(a)}),i.on("click",o=>{const a=`<span> click: </span>
            x: ${o.mapPoint.x.toFixed(2)}
            y: ${o.mapPoint.y.toFixed(2)}
            long: ${o.mapPoint.longitude.toFixed(6)}
            lat: ${o.mapPoint.latitude.toFixed(6)}`;s(a)}),e.when(()=>i.stationary===!0,()=>{if(i.center){const o=`<span> center: </span>
                    x: ${i.center.x.toFixed(2)}
                    y: ${i.center.y.toFixed(2)}
                    long: ${i.center.longitude.toFixed(6)}
                    lat: ${i.center.latitude.toFixed(6)}`;s(o)}if(i.extent){const o=`<span> extent: </span>
                    xmin: ${i.extent.xmin.toFixed(2)}
                    xmax: ${i.extent.xmax.toFixed(2)}
                    ymin: ${i.extent.ymin.toFixed(2)}
                    ymax: ${i.extent.ymax.toFixed(2)}`;s(o)}if(i.zoom&&i.scale){const o=`<span> zoom/scale: </span>
                    zoom: ${i.zoom.toFixed(2)}
                    scale: ${i.scale.toFixed(2)}`;s(o)}}),e.watch(()=>i.popup.visible,()=>{const o=`<span> popup: </span> = ${i.popup.visible}`;s(o)});const s=o=>{r.innerHTML+="<br>"+new Date().toLocaleTimeString()+": "+o,r.scrollTop=r.scrollHeight}},Fwe="QIT Plus - Time of Concentration",lmt="";Bwe(Fwe);Uwe(Fwe,jwe,lmt);Gwe();qwe();Hwe();const Xr=Wwe();wd.register(Gft);Hft(Xr,DR);qft(Xr,DR);Wft(Xr,DR);tmt();Xr.view.when(()=>{cmt(),Xr.view.whenLayerView(Xr.layers.rgToc).then(()=>{Xr.layers.rgToc.queryExtent().then(t=>{Xr.view.goTo(t.extent,{duration:1e3}).catch(e=>{console.error(e)})}),imt(Xr,DR),rmt(Xr,wd)})});amt(Xr,Ple);const cmt=()=>{const t=Xr.view.container,e=s=>{s.stopPropagation(),s.preventDefault()},i=s=>{s.stopPropagation(),s.preventDefault()},r=s=>{if(s.stopPropagation(),s.preventDefault(),Xr.layers.csv)alert("Only one CSV layer at this time.");else{const a=s.dataTransfer.files;n(a)}};t.addEventListener("dragenter",e,!1),t.addEventListener("dragover",i,!1),t.addEventListener("drop",r,!1);const n=s=>{if(s.length){const o=s[0];if(o.type==="text/csv"){const a=new FileReader;a.onload=l=>{umt(o.name,l.target.result)},a.readAsText(o)}else alert("CSV only at this time.")}}},umt=(t,e)=>{const i=pmt(e);dmt(t,i)},dmt=(t,e)=>{const i=[];for(const u of e)if(u.code&&u.latitude&&u.longitude){const h={type:"Point",coordinates:[parseFloat(u.longitude),parseFloat(u.latitude)]},f={};for(const m in u)m&&(f[m]=u[m]);i.push({type:"Feature",geometry:h,properties:f})}if(i.length==0){alert("CSV must have at minimum columns code, longitude and latitude (case sensitive) with no null values.");return}const r={type:"FeatureCollection",features:i},n=new Blob([JSON.stringify(r)],{type:"application/json"}),s=URL.createObjectURL(n),o=new L9({title:t,url:s,editingEnabled:!0});Xr.layers.csv=o,e[0].calc_toc?o.renderer={type:"unique-value",field:"calc_toc",defaultLabel:"Not checked",defaultSymbol:{type:"simple-marker",size:8,color:"rgb(0,64,128)",outline:{color:"rgb(255,255,255)",width:1.5}},uniqueValueInfos:[{value:"1",label:"Calculated ToC",symbol:{type:"simple-marker",size:8,color:"rgb(64,128,0)",outline:{color:"rgb(255,255,255)",width:1.5}}},{value:"0",label:"Excluded from ToC",symbol:{type:"simple-marker",size:8,color:"rgb(64,0,0)",outline:{color:"rgb(255,255,255)",width:1.5}}}]}:o.renderer={type:"simple",label:o.title,symbol:{type:"simple-marker",size:8,color:"rgb(0,128,255)",outline:{color:"rgb(255,255,255)",width:1.5}}},console.log(o),o.effect="drop-shadow(0,0,3px)";const a=new Zv({labelExpressionInfo:{expression:"$feature.code"},symbol:{type:"text",color:[0,0,0],haloSize:1,haloColor:"white"}});o.labelingInfo=[a],o.when(()=>o.queryExtent()).then(u=>{Xr.view.goTo(u.extent)}),Xr.view.map.add(o);const l=new Cbe({view:Xr.view});Xr.view.ui.add(l,"top-right");const c=document.createElement("div");c.id="exportCsv",c.className="esri-widget esri-widget--button esri-interactive",c.title="Export CSV",c.innerHTML='<calcite-icon icon="download-to" text-label="Export CSV"></calcite-icon>',document.body.appendChild(c),Xr.view.ui.add("exportCsv","top-right"),c.addEventListener("click",()=>{Xr.layers.csv.queryFeatures().then(u=>{const h=[],f=[];for(const g of Xr.layers.csv.fields)g.name!=="__OBJECTID"&&f.push(g.name);h.push(f.join(",")+",u_longitude,u_latitude");for(const g of u.features){const y=[];for(const v in g.attributes)v!=="__OBJECTID"&&y.push(g.attributes[v]);y.push(g.geometry.longitude.toFixed(6)),y.push(g.geometry.latitude.toFixed(6)),h.push(y.join(","))}const m=h.join(`
`);hmt(t.replace(".csv","_updated.csv"),m)})})};function hmt(t,e){const i=document.createElement("a");i.href="data:text/csv;charset=utf-8,"+encodeURI(e),i.target="_blank",i.download=t,i.click()}const pmt=t=>{let e=t.split(/\n/).map(n=>(n=n.replace(/\r/,""),n.split(",")));if(e.length<2){alert("CSV must have at least two lines - first with column names and second as record.");return}const i=e[0];return e.slice(1).map(n=>n.reduce((s,o,a)=>(s[i[a]]=o,s),{}))};export{QTe as $,fe as A,Qr as B,z_t as C,d as D,p as E,A as F,Qgt as G,V_t as H,Ek as I,Ta as J,Xgt as K,sn as L,kn as M,Wh as N,Et as O,F_t as P,TTt as Q,ITt as R,U as S,KO as T,Ro as U,ie as V,ye as W,BI as X,Upe as Y,Or as Z,W as _,X_t as a,J as a$,eCe as a0,rDe as a1,mNe as a2,K_t as a3,N_t as a4,ee as a5,us as a6,al as a7,Do as a8,_v as a9,Ev as aA,$ue as aB,JU as aC,ohe as aD,VLe as aE,qgt as aF,yp as aG,Pn as aH,KU as aI,fat as aJ,bpe as aK,on as aL,lC as aM,J2 as aN,Rvt as aO,Zn as aP,no as aQ,Zm as aR,Re as aS,Mg as aT,rx as aU,au as aV,ov as aW,U3e as aX,e_t as aY,i_t as aZ,fbe as a_,aM as aa,woe as ab,boe as ac,_oe as ad,Ew as ae,xoe as af,Cyt as ag,zpe as ah,bCe as ai,J0 as aj,nw as ak,H2 as al,Dt as am,cg as an,hs as ao,Pr as ap,C$ as aq,I4 as ar,Lt as as,He as at,Xq as au,T0t as av,fyt as aw,lo as ax,at as ay,Bv as az,H_t as b,vs as b$,cn as b0,bg as b1,F1 as b2,an as b3,ui as b4,jyt as b5,iL as b6,Le as b7,Mp as b8,nVe as b9,LL as bA,y0t as bB,$0t as bC,Me as bD,ms as bE,Yn as bF,q1 as bG,wa as bH,mp as bI,$n as bJ,lue as bK,Gt as bL,ce as bM,Vd as bN,VO as bO,zO as bP,fv as bQ,che as bR,UZ as bS,pg as bT,Pv as bU,AR as bV,Xi as bW,JC as bX,YC as bY,Ls as bZ,Ui as b_,RL as ba,je as bb,En as bc,l3e as bd,vt as be,T$ as bf,cL as bg,Qq as bh,Myt as bi,u0t as bj,E0t as bk,Ee as bl,rg as bm,Mne as bn,ZI as bo,sze as bp,Mn as bq,E1e as br,ae as bs,Od as bt,rd as bu,MH as bv,IU as bw,ww as bx,Kw as by,xgt as bz,R_t as c,jxt as c$,No as c0,o2e as c1,Jne as c2,Zne as c3,a2e as c4,uB as c5,hB as c6,a1e as c7,n1e as c8,uet as c9,Rgt as cA,Rs as cB,Cgt as cC,Xh as cD,g7 as cE,c5e as cF,v5e as cG,gs as cH,Cve as cI,tn as cJ,kle as cK,ayt as cL,u1 as cM,C7 as cN,vq as cO,eoe as cP,pn as cQ,so as cR,bee as cS,Pi as cT,ji as cU,g6e as cV,or as cW,On as cX,X8e as cY,vT as cZ,s8 as c_,toe as ca,fne as cb,jO as cc,mU as cd,gC as ce,eT as cf,Cm as cg,il as ch,AAe as ci,JO as cj,kAe as ck,QU as cl,k0t as cm,Ggt as cn,$_e as co,eot as cp,qm as cq,Omt as cr,yD as cs,pFe as ct,Tre as cu,Mu as cv,UPe as cw,Y3e as cx,X3e as cy,_Te as cz,cDe as d,bje as d$,UC as d0,Q8e as d1,A0t as d2,Gwt as d3,Awt as d4,Mwt as d5,ow as d6,q8e as d7,$wt as d8,M1t as d9,FBe as dA,FGe as dB,uj as dC,Dfe as dD,M8e as dE,IA as dF,qpe as dG,$8e as dH,A8e as dI,jGe as dJ,aP as dK,ffe as dL,Oz as dM,t7e as dN,q6e as dO,lt as dP,Xat as dQ,co as dR,JT as dS,Ad as dT,SB as dU,lwt as dV,ymt as dW,ebe as dX,br as dY,dwt as dZ,uwt as d_,E1t as da,I0t as db,OCe as dc,Li as dd,en as de,xe as df,te as dg,r2e as dh,yVe as di,pEe as dj,Hbt as dk,Wbt as dl,qbt as dm,V1 as dn,eEe as dp,Cd as dq,xEe as dr,Gyt as ds,rN as dt,Uyt as du,Jgt as dv,rC as dw,de as dx,RP as dy,rGe as dz,uNe as e,Emt as e$,Ugt as e0,Qrt as e1,ent as e2,z2t as e3,P7 as e4,Grt as e5,eSt as e6,eIt as e7,Q2t as e8,gu as e9,Ye as eA,Dxt as eB,Na as eC,JIt as eD,ku as eE,Fne as eF,pat as eG,c1 as eH,ge as eI,wt as eJ,hu as eK,Gv as eL,gyt as eM,xPe as eN,Tyt as eO,soe as eP,ho as eQ,pc as eR,Eu as eS,ol as eT,_q as eU,vd as eV,Zw as eW,Zce as eX,Jl as eY,tt as eZ,O1 as e_,tne as ea,k7 as eb,Hwt as ec,lc as ed,Ir as ee,zB as ef,i1e as eg,R1 as eh,BL as ei,A9 as ej,M9 as ek,$9 as el,WL as em,FL as en,Lo as eo,UI as ep,ipe as eq,x9 as er,HL as es,Ma as et,Ym as eu,hc as ev,k9 as ew,Cpe as ex,qot as ey,b9 as ez,W_t as f,Wse as f$,gTt as f0,yt as f1,_Tt as f2,Ep as f3,HTt as f4,qTt as f5,$2e as f6,tlt as f7,ti as f8,GTt as f9,B_t as fA,sA as fB,Amt as fC,xwt as fD,Aue as fE,W4 as fF,p1 as fG,i5e as fH,XC as fI,kue as fJ,Tt as fK,OFe as fL,$C as fM,iT as fN,U6 as fO,r5e as fP,Ca as fQ,zP as fR,eB as fS,pze as fT,ACe as fU,Bi as fV,cs as fW,e5e as fX,bi as fY,dve as fZ,hve as f_,BF as fa,jot as fb,Tp as fc,I_t as fd,bhe as fe,Pbt as ff,l1 as fg,E9 as fh,Lyt as fi,Oi as fj,Zh as fk,po as fl,ape as fm,eyt as fn,rw as fo,ggt as fp,k2e as fq,xot as fr,e$ as fs,cte as ft,Y_t as fu,Z_t as fv,cNe as fw,U_t as fx,aNe as fy,j_t as fz,q_t as g,mVe as g$,Lit as g0,eTe as g1,tTe as g2,Mse as g3,qse as g4,ZC as g5,XIe as g6,qke as g7,fL as g8,Td as g9,ztt as gA,WSt as gB,JSt as gC,Ytt as gD,$mt as gE,BSe as gF,Yw as gG,sB as gH,g1e as gI,$i as gJ,sR as gK,ya as gL,Dle as gM,Su as gN,Bot as gO,XT as gP,Sgt as gQ,TJ as gR,tyt as gS,nu as gT,ZCe as gU,JCe as gV,pCe as gW,lq as gX,Vo as gY,yL as gZ,Iv as g_,oPe as ga,r1 as gb,i2e as gc,zd as gd,Lbt as ge,D4e as gf,QIe as gg,y7 as gh,aPe as gi,TU as gj,Pke as gk,Mgt as gl,bt as gm,L2t as gn,Ule as go,Ygt as gp,k2t as gq,X0 as gr,Smt as gs,pve as gt,WD as gu,T7 as gv,Wm as gw,N1 as gx,Sr as gy,Xv as gz,tde as h,ISe as h$,_r as h0,lr as h1,Fmt as h2,wq as h3,ype as h4,Khe as h5,_pe as h6,Jk as h7,O9 as h8,GB as h9,ex as hA,Kze as hB,Yze as hC,Zze as hD,cat as hE,Wot as hF,Oze as hG,Rze as hH,dRe as hI,yze as hJ,vze as hK,_ze as hL,wze as hM,xze as hN,Sze as hO,Ize as hP,Tze as hQ,Cze as hR,Eze as hS,Mze as hT,$ze as hU,ste as hV,Ipe as hW,hze as hX,U4e as hY,gT as hZ,Wmt as h_,epe as ha,Zv as hb,fz as hc,GL as hd,UL as he,kC as hf,The as hg,Qhe as hh,P9 as hi,Tpe as hj,Iw as hk,Nd as hl,ic as hm,oc as hn,mT as ho,I9 as hp,Xhe as hq,mze as hr,fze as hs,L1 as ht,Aze as hu,npe as hv,N_e as hw,JL as hx,$p as hy,tx as hz,ibt as i,$t as i$,kwt as i0,Iu as i1,Hgt as i2,I3e as i3,dse as i4,hIe as i5,kmt as i6,wC as i7,bR as i8,rwt as i9,jl as iA,cze as iB,j6 as iC,yr as iD,p0e as iE,vO as iF,ym as iG,Rmt as iH,u0e as iI,PPe as iJ,og as iK,IV as iL,cwt as iM,K_e as iN,H6 as iO,Bd as iP,bb as iQ,$P as iR,gwt as iS,Yot as iT,jv as iU,Nxt as iV,Ik as iW,yZ as iX,Fvt as iY,cSe as iZ,od as i_,r0t as ia,$u as ib,eCt as ic,FPe as id,Q$e as ie,Zl as ig,I8 as ih,xr as ii,ox as ij,X0e as ik,wtt as il,Use as im,btt as io,iit as ip,n2t as iq,Eg as ir,q0e as is,zSt as it,IR as iu,bp as iv,aSt as iw,Htt as ix,XO as iy,I2t as iz,op as j,h0t as j$,iet as j0,ZQ as j1,Ose as j2,hg as j3,Ryt as j4,gP as j5,Are as j6,jtt as j7,zo as j8,tC as j9,YI as jA,yoe as jB,$yt as jC,xCe as jD,dyt as jE,v4e as jF,lVe as jG,xbt as jH,yAe as jI,Vce as jJ,iC as jK,lB as jL,cIe as jM,gIe as jN,YO as jO,Fgt as jP,_mt as jQ,Mt as jR,QO as jS,kse as jT,j2 as jU,Sq as jV,Ele as jW,ql as jX,Hle as jY,y1e as jZ,pU as j_,DU as ja,hRe as jb,pRe as jc,ort as jd,N6 as je,V6 as jf,h9 as jg,Fyt as jh,Qm as ji,LZ as jj,WI as jk,Zgt as jl,v1e as jm,$re as jn,vmt as jo,o1e as jp,OR as jq,Ae as jr,Gue as js,NYe as jt,gQ as ju,_g as jv,LC as jw,OC as jx,pbe as jy,pst as jz,uRe as k,B4 as k$,c0t as k0,h0e as k1,O as k2,Egt as k3,ZT as k4,Xwe as k5,nv as k6,Pmt as k7,_1e as k8,Iwt as k9,$d as kA,WLe as kB,hP as kC,ftt as kD,Q3e as kE,ZRe as kF,BU as kG,SC as kH,EB as kI,jB as kJ,vgt as kK,Mre as kL,Une as kM,oB as kN,mgt as kO,FD as kP,ole as kQ,rB as kR,CU as kS,mP as kT,TRe as kU,$0 as kV,awt as kW,hje as kX,efe as kY,wLe as kZ,ER as k_,Twt as ka,uv as kb,hgt as kc,Syt as kd,Dv as ke,vyt as kf,B$e as kg,ut as kh,di as ki,M as kj,Os as kk,Ed as kl,bI as km,kre as kn,Fo as ko,ygt as kp,SSe as kq,WO as kr,Ogt as ks,KC as kt,rve as ku,_it as kv,q1t as kw,U0 as kx,J1 as ky,kB as kz,bgt as l,Oo as l$,Snt as l0,u3e as l1,ln as l2,uu as l3,lv as l4,QNe as l5,Xit as l6,_tt as l7,ytt as l8,Ese as l9,mt as lA,N4 as lB,YQe as lC,Xrt as lD,xTe as lE,e3e as lF,NSt as lG,Tg as lH,jRe as lI,BRe as lJ,jU as lK,K1 as lL,it as lM,MR as lN,Tmt as lO,Cmt as lP,Imt as lQ,VSe as lR,Nke as lS,mtt as lT,kke as lU,Oke as lV,Ere as lW,ewt as lX,_Se as lY,Wae as lZ,twt as l_,jit as la,_gt as lb,fpe as lc,__ as ld,ize as le,n5e as lf,k1t as lg,Cwt as lh,V8e as li,GZ as lj,M0 as lk,Xm as ll,FRe as lm,VU as ln,fp as lo,ert as lp,zit as lq,lyt as lr,wCe as ls,Lrt as lt,cT as lu,Tve as lv,hbe as lw,KQe as lx,Qxt as ly,rn as lz,Bgt as m,vnt as m$,yO as m0,ZSt as m1,tit as m2,net as m3,S0e as m4,qSt as m5,get as m6,ktt as m7,U0e as m8,Gse as m9,mSt as mA,v0e as mB,nSt as mC,rSt as mD,pSt as mE,dSt as mF,eve as mG,o2t as mH,Ptt as mI,KSt as mJ,ySt as mK,M4e as mL,Qyt as mM,lke as mN,Nbt as mO,Ti as mP,vFe as mQ,z7 as mR,NU as mS,Jwe as mT,xyt as mU,pyt as mV,kCe as mW,PCe as mX,swt as mY,owt as mZ,nwt as m_,qI as ma,fTe as mb,ec as mc,p0t as md,Obt as me,kbt as mf,WU as mg,Dk as mh,Cn as mi,dT as mj,oze as mk,Fxt as ml,Byt as mm,Dyt as mn,Vyt as mo,Nyt as mp,zyt as mq,rl as mr,$Ee as ms,mpe as mt,gpe as mu,fje as mv,s1e as mw,w5e as mx,E4e as my,uT as mz,G_t as n,O6e as n$,qd as n0,cnt as n1,Gve as n2,kgt as n3,C4 as n4,eit as n5,t1 as n6,s2t as n7,_St as n8,kPe as n9,wgt as nA,Rv as nB,Jv as nC,bwt as nD,Ov as nE,SA as nF,Qje as nG,Au as nH,wwt as nI,x6e as nJ,qwt as nK,NGe as nL,M2e as nM,E2e as nN,Pgt as nO,nx as nP,Ap as nQ,el as nR,w6e as nS,Iz as nT,Tz as nU,MP as nV,I5 as nW,_6e as nX,VGe as nY,D1t as nZ,Xwt as n_,Ig as na,a3e as nb,QRe as nc,TTe as nd,AB as ne,Hse as nf,Ltt as ng,U2t as nh,An as ni,pv as nj,Q0e as nk,r2t as nl,sTe as nm,Ase as nn,$se as no,fSt as np,hSt as nq,gee as nr,C5e as ns,E5e as nt,x5e as nu,vAe as nv,TQ as nw,Hue as nx,Jw as ny,M_t as nz,$_t as o,Pde as o$,c7e as o0,Lv as o1,$1t as o2,Hfe as o3,tK as o4,rK as o5,RBe as o6,cY as o7,B9 as o8,Mxe as o9,sqe as oA,Zd as oB,Bxt as oC,XU as oD,ll as oE,ip as oF,mme as oG,oxt as oH,eP as oI,iP as oJ,QI as oK,PEe as oL,Eat as oM,nxt as oN,sxt as oO,BHe as oP,lqe as oQ,lR as oR,rxt as oS,lxt as oT,axt as oU,cxt as oV,uxt as oW,OYe as oX,Gae as oY,Hae as oZ,hC as o_,M6e as oa,Lue as ob,Pd as oc,CL as od,_ue as oe,bue as of,m3e as og,jvt as oh,C3e as oi,Bvt as oj,j7 as ok,Ql as ol,Iot as om,X1t as on,Q1t as oo,lU as op,ext as oq,z5 as or,yme as os,ixt as ot,KHe as ou,WHe as ov,txt as ow,_G as ox,UHe as oy,N$e as oz,D_t as p,YTt as p$,sp as p0,c8 as p1,X0t as p2,elt as p3,BC as p4,wr as p5,n1t as p6,r1t as p7,ba as p8,Ufe as p9,PR as pA,kIt as pB,PIt as pC,OIt as pD,LIt as pE,VIt as pF,RIt as pG,FIt as pH,DIt as pI,NIt as pJ,zIt as pK,WQe as pL,q0 as pM,SR as pN,Agt as pO,$gt as pP,h7 as pQ,Qle as pR,xet as pS,APe as pT,E0e as pU,gze as pV,ag as pW,XM as pX,WTt as pY,ZTt as pZ,JTt as p_,t1t as pa,i1t as pb,yY as pc,Ewt as pd,e1t as pe,H9 as pf,iue as pg,SL as ph,d1 as pi,xC as pj,_d as pk,z8e as pl,xhe as pm,eVe as pn,p9 as po,She as pp,aye as pq,Q4e as pr,vKe as ps,uVe as pt,dVe as pu,hVe as pv,zD as pw,$ee as px,jIt as py,Wd as pz,J_t as q,Sg as q$,KTt as q0,zne as q1,yTt as q2,vTt as q3,bTt as q4,EO as q5,ryt as q6,gCe as q7,Eyt as q8,cyt as q9,B8e as qA,U8e as qB,Ype as qC,Owt as qD,G8e as qE,UB as qF,ev as qG,tnt as qH,i0t as qI,sT as qJ,B2t as qK,eet as qL,dc as qM,j2t as qN,ps as qO,g0t as qP,w0t as qQ,ZQe as qR,t0t as qS,ZW as qT,Bre as qU,oit as qV,e0t as qW,YSt as qX,EPe as qY,wyt as qZ,JW as q_,DB as qa,noe as qb,yCe as qc,HI as qd,RCe as qe,TCe as qf,nyt as qg,hyt as qh,Z3e as qi,Pwt as qj,Uwt as qk,Vwt as ql,Nwt as qm,zwt as qn,jwt as qo,iY as qp,nY as qq,rY as qr,Fwt as qs,Dwt as qt,uL as qu,FP as qv,Lwt as qw,Rwt as qx,myt as qy,Bwt as qz,Q_t as r,fC as r$,ZO as r0,gL as r1,MU as r2,bC as r3,Lmt as r4,x0t as r5,FB as r6,XSt as r7,zke as r8,Dke as r9,qk as rA,$Te as rB,Qke as rC,cSt as rD,aue as rE,oSt as rF,lSt as rG,Jmt as rH,pm as rI,a5 as rJ,QT as rK,wmt as rL,uSt as rM,y2t as rN,C1 as rO,g2t as rP,Ea as rQ,Zmt as rR,ixe as rS,Xke as rT,Rtt as rU,oyt as rV,syt as rW,SCe as rX,C4e as rY,Rke as rZ,pC as r_,MTe as ra,Lke as rb,Ort as rc,_i as rd,gtt as re,uyt as rf,KL as rg,WW as rh,cit as ri,S2t as rj,GM as rk,z0t as rl,Stt as rm,QSt as rn,Jke as ro,VSt as rp,Fke as rq,ret as rr,e2t as rs,cPe as rt,Nse as ru,Zke as rv,ac as rw,XRe as rx,zse as ry,Xa as rz,N as s,bLe as s$,mC as s0,Qbt as s1,nce as s2,n3e as s3,O2e as s4,Iyt as s5,RB as s6,lPe as s7,gRe as s8,Dvt as s9,yyt as sA,S0t as sB,_0t as sC,Mke as sD,d0t as sE,n6e as sF,OAe as sG,Uke as sH,RPe as sI,lye as sJ,gmt as sK,mmt as sL,t2t as sM,Dtt as sN,_2t as sO,m0t as sP,M0t as sQ,h1 as sR,w0e as sS,cue as sT,Bo as sU,Wgt as sV,qRe as sW,fet as sX,rit as sY,yrt as sZ,Av as s_,Xxt as sa,u4e as sb,hL as sc,_C as sd,vC as se,W1 as sf,Mhe as sg,rAe as sh,Gbt as si,V2t as sj,mAe as sk,gAe as sl,C0t as sm,b0t as sn,Kwe as so,DAe as sp,v0t as sq,D0t as sr,F0t as ss,_Ae as st,xmt as su,N2t as sv,jPe as sw,F2t as sx,mSe as sy,f0t as sz,ebt as t,F4 as t0,igt as t1,QE as t2,D2t as t3,T4 as t4,O2t as t5,iyt as t6,dL as t7,Hv as t8,Wge as t9,zxt as ta,XD as tb,byt as tc,E8 as td,i2t as te,_yt as tf,Y2e as tg,Z0t as th,Wv as ti,$bt as tj,iwt as tk,vwt as tl,U1t as tm,cee as tn,kTt as to,tbt as u,he as v,ys as w,Cp as x,_t as y,wi as z};
