var mge=Object.defineProperty;var gge=(t,e,i)=>e in t?mge(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i;var ve=(t,e,i)=>(gge(t,typeof e!="symbol"?e+"":e,i),i);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function i(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(r){if(r.ep)return;r.ep=!0;const s=i(r);fetch(r.href,s)}})();const yge=t=>{document.title=t},vge=(t,e)=>{const i=document.createElement("div");e||(e=wge()),i.id="titleDiv",i.innerHTML=`
        <h1 id="title">
            <img
                src="${e}"
                alt="qit-plus-logo"
                id="logo"
            />
            ${t}
        </h1>
    `,document.body.appendChild(i)},_ge=()=>{const t=document.createElement("div");t.id="viewDiv",document.body.appendChild(t)},bge=()=>{const t=document.createElement("div");t.id="loader",t.innerHTML=`
        <div class="loader-inner">
            <div class="loader-line-wrap">
                <div class="loader-line"></div>
            </div>
            <div class="loader-line-wrap">
                <div class="loader-line"></div>
            </div>
            <div class="loader-line-wrap">
                <div class="loader-line"></div>
            </div>
            <div class="loader-line-wrap">
                <div class="loader-line"></div>
            </div>
            <div class="loader-line-wrap">
                <div class="loader-line"></div>
            </div>
        </div>
    `,document.body.appendChild(t)},wge=()=>"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADoAAAAoCAYAAACvpem4AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAD99JREFUaIHFmnl0VdX1xz/n3vuGzHNIyMAQBEKYQZAZRQYFFFREpFVwKfArtlr1RxXtANRWpVq1/Fr1R0FUMGABBUFQQSNDECLzTCAJEEIGSAIveS9vuLt/3JAmTQLYYvtd6611c8/Ze5/v2efsu/c5UfwXISIOoB8wFEgDUoEkIBlwAwIEgHzgOHAM2AFsU0pVfR9b6kYN+nohIrHAZGAs0D9gmkF5BaUcPXGOovPlnDtfTknZJcyACUBUZAhJLaNJaRlDRnoyaa1bANQAXwIfAZlKqZpr2f2PERWRDsCzwINV1TX2dZ/vYcPmfWzNPobb471uPS3iIxjYtwN3Du/O0AGdsNuNIuC3wF+UUtKc3A9OVESigXnA9OO5Rfp7K7awcu1OXC7PVeUiQgx6t3GQEukjMkQn2Ab+QIAKt87ZSo2dJ9wEjCCmTxnGoz+6FYfDthZ4UCnlakrfD0pUREYC714odyW8/MYalq/OxjSbnnSHrnhksI3R7V2kcgqbuxgtpi1aVCuUMxzsIdZwvS7E50YqC3H7hLyqKHa40nns6ZnY7cYbSqknm9L/gxEVkWeB3330ybdqzisrqbxU3WS/9ok2fjfaSydzF3pYC4z0UeitB6C37AJKv9LNhbUvYxrZqSolULgXLSwBLbFLsVIqoSk7N5yoiGjAH/0B82fz5q9i0dKvm+zXvZWDeaNctPPmYEu/A1uvH6PFdwAoADYC+4AwoCXQB+gJ2AFKSiupqvbiqnITGhJEYkIkTocNrAi9Bvh/YKNSyvwhif7SHzDnPvbEO3yZdbBRe2SwxluTTLr7t2D0mIj9lmmokFgPsBRYBkRhReWRAdMM3newgO/25rFnfz7HThZx+kwZnhpfI70pSTH0u/kmxo7syZAB6SildgGPK6V23nCiIjIKWDd7Xqb2/oqtjdpnDAvmp2nfYk/pgX3oM2iRyZeB14FM4AHg0YBpJn6z/SjrPt/Dl18f4EJ5k7HlqmjXNoF5sycwsG+HAPCUUurNG0ZUREKBE0v/ti3h2TkfNmjTNEXmIyZd2Y3jzhcxbrrNBP4KvAr8GPhZcUll2IertpO5ajuFReX/9niUUkyfMoznnxpnAmNuJNFZ5RVVLw8eM4eKyoaBZ8lUjVvCTxE0aQkqJCYPeBgwgHdLyy6lvv72BjJXbcfr9V/Tjl1XdEy2ER+uE+JQeH1CUYXJ/jPeRhH9pqQgvvjL3ehtBhYaN4ooMGXl2p2NSI7pEcwtzl0EPbgKFRz1JXAv8Azw/PLV2dq8P6xuNiIDDOroZFKvAOkRF4nzn8HwVaDCk1AhMShnGABS4yLgvkS518na/CTmf1aNPwCjOhuYF06htxl46oYQFZFEIP2Lrw80eK9pijn9TuAY8woqOGofcD/wR7fH+8hzczNZuXZnk/q6trLz1K1+ejsOYgSqMNrdht5qPFpST7So1AamqRdnQrzVTDv+Bfd1WseSvRH0TqpGS+wCsOdGebQ1QF5BSYOXTwwPIrxla/SUm31Yy/V1V5XnoSkz3+Lb73IbKbm1UxAvDCklqXoP+k3DsXV/GT2lFygNwAecB0qAQqykvxQoBqqBAmUPjjM63z01PmNsn5/3XId39zL0hAyAnTeKqBOgqrphbn1vu0LsA+YCLAaG+XyBh6Y+/nYjkskxBm/dV007bza29Aew9XkVFdIoN7BVu70phUUXUzweb6+6lzaD5JbRhIY4wfr2/hGltTMyxpYYGWM7AlXA+htFtAIgJjqUS5fdgLVs44L9aLFpANnAwudfXM6OnBMNBKcNDeKJtG3Yk/vguP0zVGg8vj2Z4HNTnHwX7yzZzKGjZzmWW9TsXtY1jW6dU3nwvgHd7ru777u6pgFMA84BJUqp8htF9Ajg7ZyeYs8rKAWgTZyBkXozWEtr0ldbD+sfrtzeQOjPkxS3BWdZn5z2wwmYJuUXLxNyeC3iruBIVW8WL8u6pvGAabJ7fz679+eTuSqbxQtmEBkR/IxSqt+VPjeEqFLKIyKbbx2YMWrtht0ARIcZqLAEAIeIjHjp9U/q+mua4uOpLjqElhI0cQ0qLIHd+/OY9esPeWjiQCbU9kuIC2X2uEi6RlfQwukiQlVg+C5hanaqjVjy3LG8l2Nn475/eDpn7yl+MWcZb7/26C0iMlgp9Q00kRmJSAjQH2gFxAKRzfCrBk4DZ4CdwJ01Nb7M/nf8hpLSSmLD7ez40804ek5iz/587pr8hzrBj6dDp7BinBP/SlFFgMQYJ3LhZF27Z/0LUHMZ5/g3/jGZYS1At1t/eKsQrxu5VEigYCcnT55h8rsapZVWamgYOic/m4aWkJGplJoE9TwqIt2BucAIwCFVZYjPDX4v+N0NKRpBYNhRtiBUSCyAH9jkcNjkyemj1OzfLqfskpd9hTp9esJ3+/LqRJ8eHUq62oFzwmqWrz/E/AWfsmvpRKoX39N4JheNq3sOemARetvBOcASnBFeBfHEpqXpbQePTh/kiXu3xXLuemEXARNSYwz8x7/AnpDRum7ItSTvAlYEzu52+HLeI3B6J+Iq+We7TUKFxqO36mvYej80Uk/qwY/uH8jmr3L4cttJXso8yd9GC6ZpFRG6pjE1dTf2e/7Mc/M38NnGHSye7AVnJM7xf6rT6d3yBuKtxjHsubp3Wot0gN61v4tYe38HMAXD2aPr2IfnDfz0ssrafpQJfeyo4BiAuureEJEIYLFv30eOmnWzQdPQW3ZH6zjK8pZm1YTKGQ5eN2L6wAxYy8fvwSw+gv/wOvyH1+Ec8zJGl/G8/ut7+ekzb/HV/kIWL8sio2MKAEMznDhb38yry3M5fySHrEn7cSZ0QgVFYqTfUUfKt/sD0O2c0Luy8P2vuHDRxYXyg4SFOFGaRou4iOjWKbHR/fq0T+/Vrc1UTVOfAuczOqYkZm0/ypjWReipUwB21ffofeKtjvZu+j0qNI6gye+jxaQBFNX+BGtpXq7vSKz9mwTEmmW5uJdOpmbT7zDS7yAiMZU3fj2OWa9l8cGKLfzf/EcYO7InSfZSVKeheHYdZMHYCzh7PI3RaQwA1W4v6z7fTevUeDprNtAMck8Vs+LjHVddUd06t2LRm9PGxMdF4A+Y3N49nHhb4ZXadnXdgEUk039s40TPypk4bn8eW5+pBcAwpdTJZrXXQ+3e3uD95vUW3q0LcN7/Dka729h7oICgIBt5BaX4A2az8smJ0Rw6dpbfvroal8vDrJ+OZUb3c4inktyQIexdn4mOlewLGhVuRZHLYMUONy63FXx6dG3Nx+8/zbKV2xh58TWihkzD6Dhqr1KqR32PZpglxwDQknsCrLlekgBKqb0iskxvM/DnbF2AWXoC2t3GksxvSEyI5MixQmpqC+Wq6hr2HixgQJ/2dfIDbunAoaNniXL4eW6Eg+HO1ZglERAUQVrRctp2C6CFJ4IjDGU4kIAPqSrlmX5lZB6KYO4nbvbsz+fM/mx+dG8/vNnDMDqOEqzCoQ4GkCCXiqxBO8MBDl8vyXrIV+HWUY1UnmvQsHjBjLrnw8cKGfvgfN57ayZrN3yHU/MxJC6far4gKP4gWkpvjA4j0FsPqJ+8e4GzQDlWBhYGJDkgaeq5A3yQ8yGnCi8RlPsJdO+PfcDMamCWUmrTPxMNE78VnJQjjFpl3xcVyhFuEfU1StOOYkXKXwGzAM4WXiC26hA9zr2NquhAZN8H0G+6DeUICwDfAt8AW4E9QFFT57UiMsZo2WVtSPh6hkd7CNNrwDpAC6t/VlSfqA3fFaKhV2VTe8o+EfhYKVVYr0lDt1lPPvc/iwWUUlUiUneF0CrKpGWyB9uoVajwRAGygBVYCUgvoDswDuvUL1xEqrGC4XGsymUB8GxuXjHFJRd5//6j2Lv+AiCrKZJXiJrohgYg/hqU4bQ1Q9IBbCbg64Jue1lEXgb+oJRyA/a6FEvTmxJvABXWAnv/GUXAIiyvDQWeA1LOl1Sw7dvj5J8upbTsEgL4fAFHZERwVOuU2NRbB2WQkhTzY5fLo815ZSVrZgih0X3R04b4a3U0CQPwKFtwKIDUXEY5I5okCjwp7oou7sXj0NsPD7EPemKucoROFZHHAbt4rSWrbMHXJFqLvwCDgefzT5ey4pMdfLXlEIeOFiLS7M0CDoeNjxY9oXXr3IqFM+JQlwPYBz4uwC+UUruvRrQUZ7i1ZmsuA8Q10zcBvwcVkYRv52L8h9fhGPZsGyPjrnXAWfFUWr3s10107o6cE7y1eBNnc4/z2GCDPw8rJmZQAbrpAaWh7MGYJgREUaYlsvF0Ar//tJqVy1bR46Wf4+g2Aax680ml1MKrGTOA01pc+zYAZvlptPj0W5obmApLSA2a/ME9/gOrqdn0Ep5PnkLf9xGOkb9JNi+cAkCLbntdLF95cy1bNm7m1dEXSUo7iN6mP0a7cWhJPdCiW9Gg3hCT8MvFTDuzi31lB+gbXoB54RRaTNpirAhbdi17BpClJ/ccAgrf3hUYHUaME5ENWBXJKawZu4JMUB6jyz0P6mlDqdn4G/xH1lO9cAxaRBIAuvUtvioOHD5N6clDLLs9G3XTvRQlzabCa8Nd5cOZH6CtqiImKhSsjCyA0v5HhSc+6mk1on9ecQ5Duh1AhbYA2Ho9JK8QXanFpP3S6DBC+Y9txL38UWxd7xuptUgfqUWmNAou4nNDwAv+Guy3/i8qNA7friWYF/NBtyFea16CnDac9obbXdcVEeHBJCVGM6ijkxdzJ1BeEEKb0DVE2jx43FXsPx3gmyMe2rdPYfzo3saUSUMMm00fBCR9te0wf33YhrPlRJQj1EW9FO9aUAAiskjcFVNrPp2FP/drkOZTtuagJWRgluVCwEfwY+vRYttdaTqklOosIr8C5gAUl1TiOZFFQvl2ClQaH37rw7xcQlqEiz4Jl4g3ysmtiuOxTBu9bu7EojenC3AOJMm3exm2npMFeFgp9f73JeoE5gMzpapMBfKzMS+cRKrKqAsygdrDZd0qYZU9FBUcjYpKtTKZyGTMyrOYp3dhdBnvAx61BkeVUipbRNpgXd+HAplm5VmHFt4SRPDueAezLJdytx7ILRH9xc8NHhrfkw4x1fzktT1se3cCRpsB24EErG/rTKXU0u/tjSsQkXYi8oKIrBWRoyJyUUTc0himiFwQkUMiskFEfiUi/UVkgYicFpFHrmHnARGRvIISKS6pEK/XLyJSefbcxc23j3lBNi59LzD27llSsDdbvlv4nHhzPhAR2VJ7U/cv4XtfSYiI1lz28T10xABnNm3ICsrelEWxy0DsIfTq2YFezoP+NV8e/XzaENud0b3vBtOP0f52MJxPKKXe/Fdt/sf/WeMKRGQ2/poXfXuXW4HMW42W2BkMB1pce8ziI9h6PGBi1cMLgZ/8uxP8X4OITBeRXbVb5KKInBeRHBEpEZGTIjLu31mu9fF3hSOn9WPPupgAAAAASUVORK5CYII=",xge=()=>{const t=["#311802","#924907","#f48420","#f8af6d","#fde4ce"],e={center:[153,-28],zoom:11},i=document.getElementById("loader");return{tocColors:t,defaultView:e,startLoader:()=>{i.classList.remove("hidden")},stopLoader:()=>{i.classList.add("hidden")}}};let Qp;function ee(t){return typeof Qp[t]=="function"?Qp[t]=Qp[t](globalThis):Qp[t]}var NX,FX,zX,VX;Qp=(NX=globalThis.dojoConfig)!=null&&NX.has||(FX=globalThis.esriConfig)!=null&&FX.has?{...(zX=globalThis.dojoConfig)==null?void 0:zX.has,...(VX=globalThis.esriConfig)==null?void 0:VX.has}:{},ee.add=(t,e,i,n)=>((n||Qp[t]===void 0)&&(Qp[t]=e),i&&ee(t)),ee.cache=Qp,ee.add("esri-deprecation-warnings",!0),ee.add("esri-force-fullscreen-debug",!1),(()=>{var e;ee.add("host-webworker",globalThis.WorkerGlobalScope!==void 0&&self instanceof globalThis.WorkerGlobalScope);const t=typeof window<"u"&&typeof location<"u"&&typeof document<"u"&&window.location===location&&window.document===document;if(ee.add("host-browser",t),ee.add("host-node",typeof globalThis.process=="object"&&((e=globalThis.process.versions)==null?void 0:e.node)&&globalThis.process.versions.v8),ee.add("dom",t),ee("host-browser")){const i=navigator,n=i.userAgent,r=i.appVersion,s=parseFloat(r);if(ee.add("wp",parseFloat(n.split("Windows Phone")[1])||void 0),ee.add("msapp",parseFloat(n.split("MSAppHost/")[1])||void 0),ee.add("khtml",r.includes("Konqueror")?s:void 0),ee.add("edge",parseFloat(n.split("Edge/")[1])||void 0),ee.add("opr",parseFloat(n.split("OPR/")[1])||void 0),ee.add("webkit",!ee("wp")&&!ee("edge")&&parseFloat(n.split("WebKit/")[1])||void 0),ee.add("chrome",!ee("edge")&&!ee("opr")&&parseFloat(n.split("Chrome/")[1])||void 0),ee.add("android",!ee("wp")&&parseFloat(n.split("Android ")[1])||void 0),ee.add("safari",!r.includes("Safari")||ee("wp")||ee("chrome")||ee("android")||ee("edge")||ee("opr")?void 0:parseFloat(r.split("Version/")[1])),ee.add("mac",r.includes("Macintosh")),!ee("wp")&&/(iPhone|iPod|iPad)/.test(n)){const o=RegExp.$1.replace(/P/,"p"),a=/OS ([\d_]+)/.test(n)?RegExp.$1:"1",l=parseFloat(a.replace(/_/,".").replaceAll("_",""));ee.add(o,l),ee.add("ios",l)}ee("webkit")||(!n.includes("Gecko")||ee("wp")||ee("khtml")||ee("edge")||ee.add("mozilla",s),ee("mozilla")&&ee.add("ff",parseFloat(n.split("Firefox/")[1]||n.split("Minefield/")[1])||void 0))}})(),(()=>{if(globalThis.navigator){const t=navigator.userAgent,e=/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini|IEMobile/i.test(t),i=/iPhone/i.test(t);e&&ee.add("esri-mobile",e),i&&ee.add("esri-iPhone",i),ee.add("esri-geolocation",!!navigator.geolocation)}ee.add("esri-wasm","WebAssembly"in globalThis),ee.add("esri-shared-array-buffer",()=>{const t="SharedArrayBuffer"in globalThis,e=globalThis.crossOriginIsolated===!1;return t&&!e}),ee.add("wasm-simd",()=>{const t=[0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11];return WebAssembly.validate(new Uint8Array(t))}),ee.add("esri-atomics","Atomics"in globalThis),ee.add("esri-workers","Worker"in globalThis),ee.add("web-feat:cache","caches"in globalThis),ee.add("esri-workers-arraybuffer-transfer",!ee("safari")||Number(ee("safari"))>=12),ee.add("workers-pool-size",8),ee.add("featurelayer-simplify-thresholds",[.5,.5,.5,.5]),ee.add("featurelayer-simplify-payload-size-factors",[1,1,4]),ee.add("featurelayer-animation-enabled",!0),ee.add("featurelayer-snapshot-enabled",!0),ee.add("featurelayer-snapshot-point-min-threshold",8e4),ee.add("featurelayer-snapshot-point-max-threshold",4e5),ee.add("featurelayer-snapshot-point-coverage",.1),ee.add("featurelayer-advanced-symbols",!1),ee.add("featurelayer-pbf",!0),ee.add("featurelayer-pbf-statistics",!1),ee.add("feature-layers-workers",!0),ee.add("feature-polyline-generalization-factor",1),ee.add("mapview-transitions-duration",200),ee.add("mapview-srswitch-adjust-rotation-scale-threshold",24e6),ee.add("mapserver-pbf-version-support",10.81),ee.add("mapservice-popup-identify-max-tolerance",20),ee.add("heatmap-allow-raster-fallback",!1),ee.add("heatmap-force-raster",!1),ee("host-webworker")||ee("host-browser")&&(ee.add("esri-csp-restrictions",()=>{try{new Function}catch{return!0}return!1}),ee.add("esri-image-decode",()=>{if("decode"in new Image){const t=new Image;return t.src='data:image/svg+xml;charset=UTF-8,<svg version="1.1" xmlns="http://www.w3.org/2000/svg"></svg>',void t.decode().then(()=>{ee.add("esri-image-decode",!0,!0,!0)}).catch(()=>{ee.add("esri-image-decode",!1,!0,!0)})}return!1}),ee.add("esri-url-encodes-apostrophe",()=>{const t=window.document.createElement("a");return t.href="?'",t.href.includes("?%27")}))})();let Mx=class Pm{constructor(e=1){this._seed=e}set seed(e){this._seed=e??Math.random()*Pm._m}getInt(){return this._seed=(Pm._a*this._seed+Pm._c)%Pm._m,this._seed}getFloat(){return this.getInt()/(Pm._m-1)}getIntRange(e,i){return Math.round(this.getFloatRange(e,i))}getFloatRange(e,i){const n=i-e;return e+this.getInt()/Pm._m*n}};Mx._m=2147483647,Mx._a=48271,Mx._c=0;const Sge=1.5,Xst=1/Sge,Kst=.5;function Tge(t){if(!t)return;const e=t.length;return e>0?t[e-1]:void 0}function HX(t){return t}function Ige(t,e=HX){if(!t||t.length===0)return;let i=t[0],n=e(i);for(let r=1;r<t.length;++r){const s=t[r],o=Number(e(s));o>n&&(n=o,i=s)}return i}function qX(t,e=HX){return Ige(t,i=>-e(i))}function Cge(t,e){return e?t.filter((i,n,r)=>r.findIndex(e.bind(null,i))===n):t.filter((i,n,r)=>r.indexOf(i)===n)}function ES(t,e,i){if(t==null&&e==null)return!0;if(t==null||e==null||t.length!==e.length)return!1;if(i){for(let n=0;n<t.length;n++)if(!i(t[n],e[n]))return!1}else for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function Mge(t,e){let i=t.length!==e.length;i&&(t.length=e.length);for(let n=0;n<e.length;++n)t[n]!==e[n]&&(t[n]=e[n],i=!0);return i}function Qst(t,e,i){let n,r;return i?(n=e.filter(s=>!t.some(o=>i(o,s))),r=t.filter(s=>!e.some(o=>i(o,s)))):(n=e.filter(s=>!t.includes(s)),r=t.filter(s=>!e.includes(s))),{added:n,removed:r}}function eot(t){return t&&typeof t.length=="number"}function Ege(t,e){const i=t.length;if(i===0)return[];const n=[];for(let r=0;r<i;r+=e)n.push(t.slice(r,r+e));return n}const Age=!!Array.prototype.fill;function $ge(t,e){if(Age)return new Array(t).fill(e);const i=new Array(t);for(let n=0;n<t;n++)i[n]=e;return i}function tot(t,e){e===void 0&&(e=t,t=0);const i=new Array(e-t);for(let n=t;n<e;n++)i[n-t]=n;return i}function WX(t,e,i){if(!t||t.length===0)return;const n=t.length-1,r=t[0];if(e<=i(r))return r;const s=t[n];if(e>=i(s))return s;let o=0,a=0,l=n;for(;o<l;){a=o+Math.floor((l-o)/2);const c=t[a],u=i(c);if(u===e)return c;if(e<u){if(a>0){const d=t[a-1],f=i(d);if(e>f)return e-f>=u-e?c:d}l=a}else{if(a<n){const d=t[a+1],f=i(d);if(e<f)return e-u>=f-e?d:c}o=a+1}}return t[a]}let JX=class{constructor(){this.last=0}};const ZX=new JX;function qL(t,e,i,n){n=n||ZX;const r=Math.max(0,n.last-10);for(let o=r;o<i;++o)if(t[o]===e)return n.last=o,o;const s=Math.min(r,i);for(let o=0;o<s;++o)if(t[o]===e)return n.last=o,o;return-1}function Pge(t,e,i,n){const r=i??t.length,s=qL(t,e,r,n);if(s!==-1)return t[s]=t[r-1],i==null&&t.pop(),e}const Cl=new Set;function kge(t,e,i=t.length,n=e.length,r,s){if(n===0||i===0)return i;Cl.clear();for(let a=0;a<n;++a)Cl.add(e[a]);r=r||ZX;const o=Math.max(0,r.last-10);for(let a=o;a<i;++a)if(Cl.has(t[a])&&(s&&s.push(t[a]),Cl.delete(t[a]),t[a]=t[i-1],--i,--a,Cl.size===0||i===0))return Cl.clear(),i;for(let a=0;a<o;++a)if(Cl.has(t[a])&&(s&&s.push(t[a]),Cl.delete(t[a]),t[a]=t[i-1],--i,--a,Cl.size===0||i===0))return Cl.clear(),i;return Cl.clear(),i}function not(t,e){let i=0;for(let n=0;n<t.length;++n){const r=t[n];e(r,n)&&(t[i]=r,i++)}t.length=i}function jC(t,e){const i=t.indexOf(e);return i!==-1?(t.splice(i,1),e):null}function Ti(t,e){return t!=null}const rot=[];function sot(t){return t instanceof ArrayBuffer}function Oz(t){var e;return((e=t==null?void 0:t.constructor)==null?void 0:e.name)==="Int8Array"}function YX(t){var e;return((e=t==null?void 0:t.constructor)==null?void 0:e.name)==="Uint8Array"}function XX(t){var e;return((e=t==null?void 0:t.constructor)==null?void 0:e.name)==="Uint8ClampedArray"}function Lz(t){var e;return((e=t==null?void 0:t.constructor)==null?void 0:e.name)==="Int16Array"}function KX(t){var e;return((e=t==null?void 0:t.constructor)==null?void 0:e.name)==="Uint16Array"}function Rz(t){var e;return((e=t==null?void 0:t.constructor)==null?void 0:e.name)==="Int32Array"}function QX(t){var e;return((e=t==null?void 0:t.constructor)==null?void 0:e.name)==="Uint32Array"}function U$(t){var e;return((e=t==null?void 0:t.constructor)==null?void 0:e.name)==="Float32Array"}function G$(t){var e;return((e=t==null?void 0:t.constructor)==null?void 0:e.name)==="Float64Array"}function Oge(t){return!("buffer"in t)}function Lge(t){return t!=null?Oge(t)?8*t.length+12:t.byteLength+Rge:0}const Rge=145,Dge=1024;function oot(t){return G$(t)||U$(t)||Rz(t)||Lz(t)||Oz(t)}function aot(t){return G$(t)||U$(t)}function lot(t){return G$(t)?179769e303:U$(t)?3402823e32:QX(t)?4294967295:KX(t)?65535:YX(t)||XX(t)?255:Rz(t)?2147483647:Lz(t)?32767:Oz(t)?127:256}function eK(t,e){let i;if(e)for(i in t)t.hasOwnProperty(i)&&(t[i]===void 0?delete t[i]:t[i]instanceof Object&&eK(t[i],!0));else for(i in t)t.hasOwnProperty(i)&&t[i]===void 0&&delete t[i];return t}function q(t){if(!t||typeof t!="object"||typeof t=="function")return t;const e=nK(t);if(e!=null)return e;if(AE(t))return t.clone();if(tK(t))return t.map(q);if(iK(t))return t.clone();const i={};for(const n of Object.getOwnPropertyNames(t))i[n]=q(t[n]);return i}function WL(t){if(!t||typeof t!="object"||typeof t=="function"||"HTMLElement"in globalThis&&t instanceof HTMLElement)return t;const e=nK(t);if(e!=null)return e;if(tK(t)){let i=!0;const n=t.map(r=>{const s=WL(r);return r!=null&&s==null&&(i=!1),s});return i?n:null}if(AE(t))return t.clone();if(t instanceof File||t instanceof Blob)return t;if(!iK(t)){const i=new(Object.getPrototypeOf(t)).constructor;for(const n of Object.getOwnPropertyNames(t)){const r=t[n],s=WL(r);if(r!=null&&s==null)return null;i[n]=s}return i}return null}function AE(t){return typeof t.clone=="function"}function tK(t){return typeof t.map=="function"&&typeof t.forEach=="function"}function iK(t){return typeof t.notifyChange=="function"&&typeof t.watch=="function"}function FB(t){if(Object.prototype.toString.call(t)!=="[object Object]")return!1;const e=Object.getPrototypeOf(t);return e===null||e===Object.prototype}function nK(t){if(Oz(t)||YX(t)||XX(t)||Lz(t)||KX(t)||Rz(t)||QX(t)||U$(t)||G$(t))return t.slice();if(t instanceof Date)return new Date(t.getTime());if(t instanceof ArrayBuffer)return t.slice(0,t.byteLength);if(t instanceof Map){const e=new Map;for(const[i,n]of t)e.set(i,q(n));return e}if(t instanceof Set){const e=new Set;for(const i of t)e.add(q(i));return e}return null}function Dz(t,e){return t===e||typeof t=="number"&&isNaN(t)&&typeof e=="number"&&isNaN(e)||typeof(t||{}).getTime=="function"&&typeof(e||{}).getTime=="function"&&t.getTime()===e.getTime()||!1}function rK(t,e){return t===e||(t==null||typeof t=="string"?t===e:typeof t=="number"?t===e||typeof e=="number"&&isNaN(t)&&isNaN(e):t instanceof Date?e instanceof Date&&t.getTime()===e.getTime():Array.isArray(t)?Array.isArray(e)&&ES(t,e):t instanceof Set?e instanceof Set&&Fge(t,e):t instanceof Map?e instanceof Map&&zge(t,e):!!FB(t)&&FB(e)&&Nge(t,e))}function Nge(t,e){if(t===null||e===null)return!1;const i=Object.keys(t);if(e===null||Object.keys(e).length!==i.length)return!1;for(const n of i)if(t[n]!==e[n]||!Object.prototype.hasOwnProperty.call(e,n))return!1;return!0}function Fge(t,e){if(t.size!==e.size)return!1;for(const i of t)if(!e.has(i))return!1;return!0}function zge(t,e){if(t.size!==e.size)return!1;for(const[i,n]of t){const r=e.get(i);if(r!==n||r===void 0&&!e.has(i))return!1}return!0}function sK(t,e,i=!1){return aK(t,e,i)}function AS(t,e){if(e!=null)return e[t]||oK(t.split("."),!1,e)}function dl(t,e,i){const n=t.split("."),r=n.pop(),s=oK(n,!0,i);s&&r&&(s[r]=e)}function oK(t,e,i){let n=i;for(const r of t){if(n==null)return;if(!(r in n)){if(!e)return;n[r]={}}n=n[r]}return n}function aK(t,e,i){return e?Object.keys(e).reduce((n,r)=>{let s=n[r],o=e[r];return s===o?n:s===void 0?(n[r]=q(o),n):(Array.isArray(o)||Array.isArray(n)?(s=s?Array.isArray(s)?n[r]=s.concat():n[r]=[s]:n[r]=[],o&&(Array.isArray(o)||(o=[o]),i?o.forEach(a=>{s.includes(a)||s.push(a)}):n[r]=o.concat())):o&&typeof o=="object"?n[r]=aK(s,o,i):n.hasOwnProperty(r)&&!e.hasOwnProperty(r)||(n[r]=o),n)},t||{}):t}var jX;const Tt={analysisTheme:{accentColor:[255,127,0],textColor:"white"},apiKey:void 0,applicationName:"",applicationUrl:(jX=globalThis.location)==null?void 0:jX.href,assetsPath:"",fontsUrl:"https://static.arcgis.com/fonts",geometryServiceUrl:"https://utility.arcgisonline.com/arcgis/rest/services/Geometry/GeometryServer",geoRSSServiceUrl:"https://utility.arcgis.com/sharing/rss",kmlServiceUrl:"https://utility.arcgis.com/sharing/kml",userPrivilegesApplied:!1,portalUrl:"https://www.arcgis.com",routeServiceUrl:"https://route-api.arcgis.com/arcgis/rest/services/World/Route/NAServer/Route_World",workers:{loaderConfig:{has:{},paths:{},map:{},packages:[]}},request:{crossOriginNoCorsDomains:null,httpsDomains:["arcgis.com","arcgisonline.com","esrikr.com","premiumservices.blackbridge.com","esripremium.accuweather.com","gbm.digitalglobe.com","firstlook.digitalglobe.com","msi.digitalglobe.com"],interceptors:[],maxUrlLength:2e3,priority:"high",proxyRules:[],proxyUrl:null,timeout:6e4,trustedServers:[],useIdentity:!0},log:{interceptors:[],level:null}};if(globalThis.esriConfig&&(sK(Tt,globalThis.esriConfig,!0),delete Tt.has),!Tt.assetsPath){{const t="4.27";Tt.assetsPath=`https://js.arcgis.com/${t}/@arcgis/core/assets`}Tt.defaultAssetsPath=Tt.assetsPath}function h(t,e,i,n){var r,s=arguments.length,o=s<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(o=(s<3?r(o):s>3?r(e,i,o):r(e,i))||o);return s>3&&o&&Object.defineProperty(e,i,o),o}function cot(t,e,i,n){function r(s){return s instanceof i?s:new i(function(o){o(s)})}return new(i||(i=Promise))(function(s,o){function a(u){try{c(n.next(u))}catch(d){o(d)}}function l(u){try{c(n.throw(u))}catch(d){o(d)}}function c(u){u.done?s(u.value):r(u.value).then(a,l)}c((n=n.apply(t,e||[])).next())})}const Vge="modulepreload",jge=function(t,e){return new URL(t,e).href},zB={},Y=function(e,i,n){if(!i||i.length===0)return e();const r=document.getElementsByTagName("link");return Promise.all(i.map(s=>{if(s=jge(s,n),s in zB)return;zB[s]=!0;const o=s.endsWith(".css"),a=o?'[rel="stylesheet"]':"";if(!!n)for(let u=r.length-1;u>=0;u--){const d=r[u];if(d.href===s&&(!o||d.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${a}`))return;const c=document.createElement("link");if(c.rel=o?"stylesheet":Vge,o||(c.as="script",c.crossOrigin=""),c.href=s,document.head.appendChild(c),o)return new Promise((u,d)=>{c.addEventListener("load",u),c.addEventListener("error",()=>d(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>e()).catch(s=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s})};function Bge(t){return t&&t.release&&typeof t.release=="function"}function Uge(t){return t&&t.acquire&&typeof t.acquire=="function"}let e0=class JL{constructor(e,i,n,r=1,s=0){if(this._ctor=e,this._acquireFunction=i,this._releaseFunction=n,this.allocationSize=r,this._pool=new Array(s),this._initialSize=s,this._ctor)for(let o=0;o<s;o++)this._pool[o]=new this._ctor;this.allocationSize=Math.max(r,1)}destroy(){this.prune(0)}acquire(...e){let i;if(JL.test.disabled)i=new this._ctor;else{if(this._pool.length===0){const n=this.allocationSize;for(let r=0;r<n;r++)this._pool[r]=new this._ctor}i=this._pool.pop()}return this._acquireFunction?this._acquireFunction(i,...e):Uge(i)&&i.acquire(...e),i}release(e){e&&!JL.test.disabled&&(this._releaseFunction?this._releaseFunction(e):Bge(e)&&e.release(),this._pool.push(e))}prune(e=this._initialSize){if(!(e>=this._pool.length)){for(let i=e;i<this._pool.length;++i){const n=this._pool[i];this._dispose(n)}this._pool.length=e}}_dispose(e){e.dispose&&typeof e.dispose=="function"&&e.dispose()}};e0.test={disabled:!1};function Gge(t){t.length=0}let eo=class{constructor(e=50,i=50){this._pool=new e0(Array,void 0,Gge,i,e)}acquire(){return this._pool.acquire()}release(e){this._pool.release(e)}prune(){this._pool.prune(0)}static acquire(){return t3.acquire()}static release(e){return t3.release(e)}static prune(){t3.prune()}};const t3=new eo(100);function hot(t){const e=[];return function*(){yield*e;for(const i of t)e.push(i),yield i}}function Hge(t,e){for(const i of t)if(i!=null&&e(i))return i}function $E(t){return t!=null&&typeof t[Symbol.iterator]=="function"}function ot(t,e){return t!=null?e(t):null}function Lr(t,e){return ks(t,e),t}function ks(t,e){if(t==null)throw new Error(e??"value is None")}function Je(t){return t==null||t.destroy(),null}function dot(t){return t==null||t.dispose(),null}function Ri(t){return t==null||t.remove(),null}function is(t){return t==null||t.abort(),null}function pot(t){return t==null||t.release(),null}function qge(t,e,i){return t!=null&&e!=null?i!=null?i(t,e):t.equals(e):t===e}function Wge(t){return null}function fot(t,e){const i=new Array;for(const n of t)i.push(n!=null?e(n):null);return i}function Jge(t,e){for(const i of t)ot(i,e)}function mot(t){return t}let Rs=class ZL{constructor(){this._groups=new Map}destroy(){this.removeAll()}get size(){let e=0;return this._groups.forEach(i=>{e+=i.length}),e}add(e,i){if($E(e)){const n=this._getOrCreateGroup(i);for(const r of e)this._isHandle(r)&&n.push(r)}else this._isHandle(e)&&this._getOrCreateGroup(i).push(e);return this}forEach(e,i){if(typeof e=="function")this._groups.forEach(n=>n.forEach(e));else{const n=this._getGroup(e);n&&i&&n.forEach(i)}}has(e){return this._groups.has(this._ensureGroupKey(e))}remove(e){if(typeof e!="string"&&$E(e)){for(const i of e)this.remove(i);return this}return this.has(e)?(this._removeAllFromGroup(this._getGroup(e)),this._groups.delete(this._ensureGroupKey(e)),this):this}removeAll(){return this._groups.forEach(e=>this._removeAllFromGroup(e)),this._groups.clear(),this}_isHandle(e){return e&&(!!e.remove||e instanceof ZL)}_getOrCreateGroup(e){if(this.has(e))return this._getGroup(e);const i=[];return this._groups.set(this._ensureGroupKey(e),i),i}_getGroup(e){return this._groups.get(this._ensureGroupKey(e))}_ensureGroupKey(e){return e||"_default_"}_removeAllFromGroup(e){for(const i of e)i instanceof ZL?i.removeAll():i.remove()}};const lK=Symbol("Accessor-beforeDestroy");function $c(t){return br(()=>t.forEach(e=>e!=null&&e.remove()))}function br(t){return{remove:()=>{t&&(t(),t=void 0)}}}function got(t){return br(()=>{const e=t();e!=null&&e.remove()})}function yot(t){return br(t!=null?()=>t.destroy():void 0)}function no(t){return t.__accessor__??null}function Zge(t,e){return t!=null&&t.metadatas&&t.metadatas[e]!=null}function BC(t,e,i){return i?PE(t,e,{policy:i,path:""}):PE(t,e,null)}function PE(t,e,i){return e?Object.keys(e).reduce((n,r)=>{const s=r;let o=null,a="merge";if(i&&(o=i.path?`${i.path}.${r}`:r,a=i.policy(o)),a==="replace"||a==="replace-arrays"&&Array.isArray(n[s]))return n[s]=e[s],n;if(n[s]===void 0)return n[s]=q(e[s]),n;let l=n[s],c=e[s];if(l===c)return n;if(Array.isArray(c)||Array.isArray(n))l=l?Array.isArray(l)?n[s]=l.concat():n[s]=[l]:n[s]=[],c&&(Array.isArray(c)||(c=[c]),c.forEach(u=>{l.includes(u)||l.push(u)}));else if(c&&typeof c=="object")if(i){const u=i.path;i.path=o,n[s]=PE(l,c,i),i.path=u}else n[s]=PE(l,c,null);else n.hasOwnProperty(r)&&!e.hasOwnProperty(r)||(n[s]=c);return n},t||{}):t}function cK(t){return Array.isArray(t)?t:t.split(".")}function VB(t){return t.includes(",")?t.split(",").map(e=>e.trim()):[t.trim()]}function Yge(t){if(Array.isArray(t)){const e=[];for(const i of t)e.push(...VB(i));return e}return VB(t)}function uK(t,e,i,n){const r=Yge(e);if(r.length!==1){const s=r.map(o=>n(t,o,i));return $c(s)}return n(t,r[0],i)}function hK(t){let e=!1;return()=>{e||(e=!0,t())}}function dK(t,e){const i=t[t.length-1]==="?"?t.slice(0,-1):t;if(e.getItemAt!=null||Array.isArray(e)){const r=parseInt(i,10);if(!isNaN(r))return Array.isArray(e)?e[r]:e.at(r)}const n=no(e);return Zge(n,i)?n.get(i):e[i]}function pK(t,e,i){if(t==null)return t;const n=dK(e[i],t);return!n&&i<e.length-1?void 0:i===e.length-1?n:pK(n,e,i+1)}function $S(t,e,i=0){return typeof e!="string"||e.includes(".")?pK(t,cK(e),i):dK(e,t)}function kE(t,e){return $S(t,e)}function jB(t,e){return $S(e,t)!==void 0}function PS(t){let e=t.constructor.__accessorMetadata__;const i=Object.prototype.hasOwnProperty.call(t.constructor,"__accessorMetadata__");if(e){if(!i){e=Object.create(e);for(const n in e)e[n]=q(e[n]);Object.defineProperty(t.constructor,"__accessorMetadata__",{value:e,enumerable:!1,configurable:!0,writable:!0})}}else e={},Object.defineProperty(t.constructor,"__accessorMetadata__",{value:e,enumerable:!1,configurable:!0,writable:!0});return t.constructor.__accessorMetadata__}function H$(t,e){const i=PS(t);let n=i[e];return n||(n=i[e]={}),n}function Xge(t,e){return BC(t,e,Qge)}const Kge=/^(?:[^.]+\.)?(?:value|type|(?:json\.type|json\.origins\.[^.]\.type))$/;function Qge(t){return Kge.test(t)?"replace":"merge"}const eye=/\{([^\}]+)\}/g;function BB(t){return t??""}function pl(t,e){return t.replaceAll(eye,typeof e=="object"?(i,n)=>BB(AS(n,e)):(i,n)=>BB(e(n)))}function tye(t,e){return t.replaceAll(/([\.$?*|{}\(\)\[\]\\\/\+\-^])/g,i=>e&&e.includes(i)?i:`\\${i}`)}function Nz(t){let e=0;for(let i=0;i<t.length;i++)e=(e<<5)-e+t.charCodeAt(i),e|=0;return e}function vot(t){return new DOMParser().parseFromString(t||"","text/html").body.innerText||""}function YL(t,e){return new RegExp(`{${e}}`,"ig").test(t)}const UB={info:0,warn:1,error:2,none:3};let ne=class ps{constructor(e){this.level=null,this._module="",this._parent=null,this.writer=null,this._loggedMessages={error:new Map,warn:new Map,info:new Map},e.level!=null&&(this.level=e.level),e.writer!=null&&(this.writer=e.writer),this._module=e.module,ps._loggers.set(this.module,this);const i=this.module.lastIndexOf(".");i!==-1&&(this._parent=ps.getLogger(this.module.slice(0,i)))}get module(){return this._module}get parent(){return this._parent}error(...e){this._log("error","always",...e)}warn(...e){this._log("warn","always",...e)}info(...e){this._log("info","always",...e)}errorOnce(...e){this._log("error","once",...e)}warnOnce(...e){this._log("warn","once",...e)}infoOnce(...e){this._log("info","once",...e)}errorOncePerTick(...e){this._log("error","oncePerTick",...e)}warnOncePerTick(...e){this._log("warn","oncePerTick",...e)}infoOncePerTick(...e){this._log("info","oncePerTick",...e)}get test(){const e=this;return{loggedMessages:e._loggedMessages,clearLoggedWarnings:()=>e._loggedMessages.warn.clear()}}static get test(){return{resetLoggers(e=new Map){const i=ps._loggers;return ps._loggers=e,i},set throttlingDisabled(e){ps._throttlingDisabled=e}}}static getLogger(e){return e=typeof e!="string"?e.declaredClass:e,ps._loggers.get(e)||new ps({module:e})}_log(e,i,...n){if(this._matchLevel(e)){if(i!=="always"&&!ps._throttlingDisabled){const r=this._argsToKey(n),s=this._loggedMessages[e].get(r);if(i==="once"&&s!=null||i==="oncePerTick"&&s&&s>=ps._tickCounter)return;this._loggedMessages[e].set(r,ps._tickCounter),ps._scheduleTickCounterIncrement()}for(const r of Tt.log.interceptors)if(r(e,this.module,...n))return;this._inheritedWriter()(e,this.module,...n)}}_parentWithMember(e,i){let n=this;for(;n!=null;){const r=n[e];if(r!=null)return r;n=n.parent}return i}_inheritedWriter(){return this._parentWithMember("writer",this._consoleWriter)}_consoleWriter(e,i,...n){console[e](`[${i}]`,...n)}_matchLevel(e){const i=Tt.log.level||"warn";return UB[this._parentWithMember("level",i)]<=UB[e]}_argsToKey(...e){return Nz(JSON.stringify(e,(n,r)=>typeof r!="object"||Array.isArray(r)?r:"[Object]"))}static _scheduleTickCounterIncrement(){ps._tickCounterScheduled||(ps._tickCounterScheduled=!0,Promise.resolve().then(()=>{ps._tickCounter++,ps._tickCounterScheduled=!1}))}};ne._loggers=new Map,ne._tickCounter=0,ne._tickCounterScheduled=!1,ne._throttlingDisabled=!1;var Ph;(function(t){t[t.INITIALIZING=0]="INITIALIZING",t[t.CONSTRUCTING=1]="CONSTRUCTING",t[t.CONSTRUCTED=2]="CONSTRUCTED"})(Ph||(Ph={}));let iye=class{constructor(e,i){this._observers=e,this._observer=i}remove(){jC(this._observers,this._observer)}},fK=class{constructor(){this._observers=null,this.destroyed=!1}observe(e){if(this.destroyed||e.destroyed)return nye;this._observers==null&&(this._observers=[]);const i=this._observers;let n=!1,r=!1;const s=i.length;for(let o=0;o<s;++o){const a=i[o];if(a.destroyed)r=!0;else if(a===e){n=!0;break}}return n||(i.push(e),r&&this._removeDestroyedObservers()),new iye(i,e)}_removeDestroyedObservers(){const e=this._observers;if(!e||e.length===0)return;const i=e.length;let n=0;for(let r=0;r<i;++r){for(;r+n<i&&e[r+n].destroyed;)++n;if(n>0){if(!(r+n<i))break;e[r]=e[r+n]}}e.length=i-n}destroy(){if(this.destroyed)return;this.destroyed=!0;const e=this._observers;if(e!=null){for(const i of e)i.onCommitted();this._observers=null}}};const nye=br();var Ge;(function(t){t[t.DEFAULTS=0]="DEFAULTS",t[t.COMPUTED=1]="COMPUTED",t[t.SERVICE=2]="SERVICE",t[t.PORTAL_ITEM=3]="PORTAL_ITEM",t[t.WEB_SCENE=4]="WEB_SCENE",t[t.WEB_MAP=5]="WEB_MAP",t[t.LINK_CHART=6]="LINK_CHART",t[t.USER=7]="USER"})(Ge||(Ge={}));const XL=Ge.USER+1;function ef(t){switch(t){case"defaults":return Ge.DEFAULTS;case"service":return Ge.SERVICE;case"portal-item":return Ge.PORTAL_ITEM;case"web-scene":return Ge.WEB_SCENE;case"web-map":return Ge.WEB_MAP;case"link-chart":return Ge.LINK_CHART;case"user":return Ge.USER;default:return null}}function OE(t){switch(t){case Ge.DEFAULTS:return"defaults";case Ge.SERVICE:return"service";case Ge.PORTAL_ITEM:return"portal-item";case Ge.WEB_SCENE:return"web-scene";case Ge.WEB_MAP:return"web-map";case Ge.LINK_CHART:return"link-chart";case Ge.USER:return"user"}return void 0}function rye(t){return OE(t)}var ii;(function(t){t[t.Dirty=1]="Dirty",t[t.Overriden=2]="Overriden",t[t.Computing=4]="Computing",t[t.NonNullable=8]="NonNullable",t[t.HasDefaultValue=16]="HasDefaultValue",t[t.DepTrackingInitialized=32]="DepTrackingInitialized",t[t.AutoTracked=64]="AutoTracked",t[t.ExplicitlyTracking=128]="ExplicitlyTracking"})(ii||(ii={}));const LE={onObservableAccessed:()=>{},onTrackingEnd:()=>{}},aw=[];let Ex=LE;function We(t){Ex.onObservableAccessed(t)}let UC=!1,GC=!1;function id(t,e,i){if(UC)return Fz(t,e,i);mK(t);const n=e.call(i);return gK(),n}function sye(t,e){return id(LE,t,e)}function Fz(t,e,i){const n=UC;UC=!0,mK(t);let r=null;try{r=e.call(i)}catch(s){GC&&ne.getLogger("esri.core.accessorSupport.tracking").error(s)}return gK(),UC=n,r}function mK(t){Ex=t,aw.push(t)}function gK(){const t=aw.length;if(t>1){const e=aw.pop();Ex=aw[t-2],e.onTrackingEnd()}else if(t===1){const e=aw.pop();Ex=LE,e.onTrackingEnd()}else Ex=LE}function yK(t,e){const i=e.observerObject;if(i.flags&ii.DepTrackingInitialized)return;const n=GC;GC=!1,i.flags&ii.AutoTracked?Fz(e,e.metadata.get,t):vK(t,e),GC=n}const oye=[];function vK(t,e){const i=e.observerObject;i.flags&ii.ExplicitlyTracking||(i.flags|=ii.ExplicitlyTracking,Fz(e,()=>{const n=e.metadata.dependsOn||oye;for(const r of n)if(typeof r!="string"||r.includes(".")){const s=cK(r);for(let o=0,a=t;o<s.length&&a!=null&&typeof a=="object";++o)a=GB(a,s[o],o!==s.length-1)}else GB(t,r,!1)}),i.flags&=~ii.ExplicitlyTracking)}function GB(t,e,i){const n=e[e.length-1]==="?"?e.slice(0,-1):e;if(t.getItemAt!=null||Array.isArray(t)){const s=parseInt(n,10);if(!isNaN(s))return Array.isArray(t)?t[s]:t.at(s)}const r=no(t);if(r){const s=r.propertiesByName.get(n);s&&(We(s.observerObject),yK(t,s))}return i?t[n]:void 0}let HB=class{constructor(e,i){this.propertyName=e,this.metadata=i,this.observerObject=new aye,this._accessed=null,this._handles=null,this.observerObject.flags=ii.Dirty|(i.nonNullable?ii.NonNullable:0)|(i.hasOwnProperty("value")?ii.HasDefaultValue:0)|(i.get===void 0?ii.DepTrackingInitialized:0)|(i.dependsOn===void 0?ii.AutoTracked:0)}destroy(){this.observerObject.destroy(),this._accessed=null,this._clearObservationHandles()}getComputed(e){const i=this.observerObject;We(i);const n=e.store,r=this.propertyName,s=i.flags,o=n.get(r);if(s&ii.Computing||~s&ii.Dirty&&n.has(r))return o;i.flags|=ii.Computing;const a=e.host;let l;s&ii.AutoTracked?l=id(this,this.metadata.get,a):(vK(a,this),l=this.metadata.get.call(a)),n.set(r,l,Ge.COMPUTED);const c=n.get(r);return c===o?i.flags&=~ii.Dirty:sye(this.commit,this),i.flags&=~ii.Computing,c}onObservableAccessed(e){if(e===this.observerObject)return;let i=this._accessed;if(i==null)i=[],this._accessed=i;else if(i.includes(e))return;i.push(e)}onTrackingEnd(){this._clearObservationHandles();const e=this.observerObject;e.flags|=ii.DepTrackingInitialized;const i=this._accessed;if(i==null||i.length===0)return;let n=this._handles;n==null&&(n=[],this._handles=n);for(let r=0;r<i.length;++r)n.push(i[r].observe(e));i.length=0}notifyChange(){const e=this.observerObject;e.onInvalidated(),e.onCommitted()}invalidate(){this.observerObject.onInvalidated()}commit(){const e=this.observerObject;e.flags&=~ii.Dirty,e.onCommitted()}_clearObservationHandles(){const e=this._handles;if(e!==null){for(let i=0;i<e.length;++i)e[i].remove();e.length=0}}},aye=class extends fK{constructor(){super(...arguments),this.flags=0}onInvalidated(){~this.flags&ii.Overriden&&(this.flags|=ii.Dirty);const e=this._observers;if(e&&e.length>0)for(const i of e)i.onInvalidated()}onCommitted(){const e=this._observers;if(e&&e.length>0){const i=e.slice();for(const n of i)n.onCommitted()}}destroy(){this.flags&ii.Dirty&&this.onCommitted(),super.destroy()}},lye=class _K{constructor(){this._values=new Map,this.multipleOriginsSupported=!1}clone(e){const i=new _K;return this._values.forEach((n,r)=>{e&&e.has(r)||i.set(r,q(n))}),i}get(e){return this._values.get(e)}originOf(){return Ge.USER}keys(){return[...this._values.keys()]}set(e,i){this._values.set(e,i)}delete(e){this._values.delete(e)}has(e){return this._values.has(e)}forEach(e){this._values.forEach(e)}};function NT(t,e,i){return t!==void 0}function qB(t,e,i,n){return t!==void 0&&(!(i==null&&t.observerObject.flags&ii.NonNullable)||(n.lifecycle,Ph.INITIALIZING,!1))}function cye(t){return t&&typeof t.destroy=="function"}ne.getLogger("esri.core.accessorSupport.Properties");let uye=class{constructor(e){this.host=e,this.propertiesByName=new Map,this.ctorArgs=null,this.destroyed=!1,this.lifecycle=Ph.INITIALIZING,this.store=new lye,this._origin=Ge.USER;const i=this.host.constructor.__accessorMetadata__;for(const n in i){const r=new HB(n,i[n]);this.propertiesByName.set(n,r)}this.metadatas=i}initialize(){this.lifecycle=Ph.CONSTRUCTING}constructed(){this.lifecycle=Ph.CONSTRUCTED}destroy(){this.destroyed=!0;for(const[e,i]of this.propertiesByName){if(i.metadata.autoDestroy){const n=this.internalGet(e);n&&cye(n)&&(n.destroy(),~i.observerObject.flags&ii.NonNullable&&this._internalSet(i,null))}i.destroy()}}get initialized(){return this.lifecycle!==Ph.INITIALIZING}get(e){const i=this.propertiesByName.get(e);if(i.metadata.get)return i.getComputed(this);We(i.observerObject);const n=this.store;return n.has(e)?n.get(e):i.metadata.value}originOf(e){const i=this.store.originOf(e);if(i===void 0){const n=this.propertiesByName.get(e);if(n!==void 0&&n.observerObject.flags&ii.HasDefaultValue)return"defaults"}return OE(i)}has(e){return!!this.propertiesByName.has(e)&&this.store.has(e)}keys(){return[...this.propertiesByName.keys()]}internalGet(e){const i=this.propertiesByName.get(e);if(NT(i))return this.store.has(e)?this.store.get(e):i.metadata.value}internalSet(e,i){const n=this.propertiesByName.get(e);NT(n)&&this._internalSet(n,i)}getDependsInfo(e,i,n){const r=this.propertiesByName.get(i);if(!NT(r))return"";const s=new Set,o=id({onObservableAccessed:l=>s.add(l),onTrackingEnd:()=>{}},()=>{var l;return(l=r.metadata.get)==null?void 0:l.call(e)});let a=`${n}${e.declaredClass.split(".").pop()}.${i}: ${o}
`;if(s.size===0)return a;n+="  ";for(const l of s)l instanceof HB&&(a+=`${n}${l.propertyName}: undefined
`);return a}setAtOrigin(e,i,n){const r=this.propertiesByName.get(e);if(NT(r))return this._setAtOrigin(r,i,n)}isOverridden(e){const i=this.propertiesByName.get(e);return i!==void 0&&!!(i.observerObject.flags&ii.Overriden)}clearOverride(e){const i=this.propertiesByName.get(e),n=i==null?void 0:i.observerObject;n&&n.flags&ii.Overriden&&(n.flags&=~ii.Overriden,i.notifyChange())}override(e,i){const n=this.propertiesByName.get(e);if(!qB(n,e,i,this))return;const r=n.metadata.cast;if(r){const s=this._cast(r,i),{valid:o,value:a}=s;if(i3.release(s),!o)return;i=a}n.observerObject.flags|=ii.Overriden,this._internalSet(n,i)}set(e,i){const n=this.propertiesByName.get(e);if(!qB(n,e,i,this))return;const r=n.metadata.cast;if(r){const o=this._cast(r,i),{valid:a,value:l}=o;if(i3.release(o),!a)return;i=l}const s=n.metadata.set;s?s.call(this.host,i):this._internalSet(n,i)}setDefaultOrigin(e){this._origin=ef(e)}getDefaultOrigin(){return OE(this._origin)}notifyChange(e){const i=this.propertiesByName.get(e);i!==void 0&&i.notifyChange()}invalidate(e){const i=this.propertiesByName.get(e);i!==void 0&&i.invalidate()}commit(e){const i=this.propertiesByName.get(e);i!==void 0&&i.commit()}_internalSet(e,i){const n=this.lifecycle!==Ph.INITIALIZING?this._origin:Ge.DEFAULTS;this._setAtOrigin(e,i,n)}_setAtOrigin(e,i,n){const r=this.store,s=e.propertyName;r.has(s,n)&&Dz(i,r.get(s))&&~e.observerObject.flags&ii.Overriden&&n===r.originOf(s)||(e.invalidate(),r.set(s,i,n),e.commit(),yK(this.host,e))}_cast(e,i){const n=i3.acquire();return n.valid=!0,n.value=i,e&&(n.value=e.call(this.host,i,n)),n}},hye=class{constructor(){this.value=null,this.valid=!0}acquire(){this.valid=!0}release(){this.value=null}};const i3=new e0(hye);function dye(t,e){return t.replaceAll(/\$\{([^\s\:\}]*)(?:\:([^\s\:\}]+))?\}/g,(i,n)=>n===""?"$":(AS(n,e)??"").toString())}let bK=class{constructor(e,i,n){this.name=e,this.details=n,this.message=(i&&dye(i,n))??""}toString(){return"["+this.name+"]: "+this.message}},V=class wK extends bK{constructor(e,i,n){super(e,i,n)}toJSON(){if(this.details!=null)try{return{name:this.name,message:this.message,details:JSON.parse(JSON.stringify(this.details,(e,i)=>{if(i&&typeof i=="object"&&typeof i.toJSON=="function")return i;try{return q(i)}catch{return"[object]"}}))}}catch(e){throw ne.getLogger("esri.core.Error").error(e),e}return{name:this.name,message:this.message,details:this.details}}static fromJSON(e){return new wK(e.name,e.message,e.details)}};V.prototype.type="error";function RE(t,e,i){if(t&&e)if(typeof e=="object")for(const n of Object.getOwnPropertyNames(e))RE(t,n,e[n]);else{if(e.includes(".")){const r=e.split("."),s=r.splice(r.length-1,1)[0];return void RE(kE(t,r),s,i)}const n=t.__accessor__;n!=null&&pye(e,n),t[e]=i}}function pye(t,e){if(ee("esri-unknown-property-errors")&&!fye(t,e))throw new V("set:unknown-property",mye(t,e))}function fye(t,e){return e.metadatas[t]!=null}function mye(t,e){return"setting unknown property '"+t+"' on instance of "+e.host.declaredClass}let gye;function yye(){return gye}let xK=class extends e0{constructor(){super(...arguments),this._set=new Set}destroy(){super.destroy(),this._set=Wge(this._set)}acquire(...e){const i=super.acquire(...e);return this._set.delete(i),i}release(e){e&&!this._set.has(e)&&(super.release(e),this._set.add(e))}_dispose(e){this._set.delete(e),super._dispose(e)}};const FT=[];function Z_(t){FT.push(t),FT.length===1&&queueMicrotask(()=>{const e=FT.slice();FT.length=0;for(const i of e)i()})}let Ax=class{constructor(e,i=30){this.name=e,this._counter=0,this._samples=new Array(i)}record(e){e!=null&&(this._samples[++this._counter%this._samples.length]=e)}get median(){return this._samples.slice().sort((e,i)=>e-i)[Math.floor(this._samples.length/2)]}get average(){return this._samples.reduce((e,i)=>e+i,0)/this._samples.length}get last(){return this._samples[this._counter%this._samples.length]}};var KL;(function(t){const e=(s,o,a,l)=>{let c=o,u=o;const d=a>>>1,f=s[c-1];for(;u<=d;){u=c<<1,u<a&&l(s[u-1],s[u])<0&&++u;const m=s[u-1];if(l(m,f)<=0)break;s[c-1]=m,c=u}s[c-1]=f},i=(s,o)=>s<o?-1:s>o?1:0;function n(s,o,a,l){o===void 0&&(o=0),a===void 0&&(a=s.length),l===void 0&&(l=i);for(let u=a>>>1;u>o;u--)e(s,u,a,l);const c=o+1;for(let u=a-1;u>o;u--){const d=s[o];s[o]=s[u],s[u]=d,e(s,c,u,l)}}function*r(s,o,a,l){o===void 0&&(o=0),a===void 0&&(a=s.length),l===void 0&&(l=i);for(let u=a>>>1;u>o;u--)e(s,u,a,l),yield;const c=o+1;for(let u=a-1;u>o;u--){const d=s[o];s[o]=s[u],s[u]=d,e(s,c,u,l),yield}}t.sort=n,t.iterableSort=r})(KL||(KL={}));const WB=KL,vye=1.5,_ye=1.1;let Sf=class{constructor(e){this.data=[],this._length=0,this._allocator=void 0,this._deallocator=()=>null,this._shrink=()=>{},this._hint=new JX,e&&(e.initialSize&&(this.data=new Array(e.initialSize)),e.allocator&&(this._allocator=e.allocator),e.deallocator!==void 0&&(this._deallocator=e.deallocator),e.shrink&&(this._shrink=()=>JB(this)))}toArray(){return this.data.slice(0,this.length)}filter(e){const i=new Array;for(let n=0;n<this._length;n++){const r=this.data[n];e(r)&&i.push(r)}return i}at(e){if((e=Math.trunc(e)||0)<0&&(e+=this._length),!(e<0||e>=this._length))return this.data[e]}includes(e,i){const n=this.data.indexOf(e,i);return n!==-1&&n<this.length}get length(){return this._length}set length(e){if(e>this._length){if(this._allocator){for(;this._length<e;)this.data[this._length++]=this._allocator(this.data[this._length]);return}this._length=e}else{if(this._deallocator)for(let i=e;i<this._length;++i)this.data[i]=this._deallocator(this.data[i]);this._length=e,this._shrink()}}clear(){this.length=0}prune(){this.clear(),this.data=[]}push(e){this.data[this._length++]=e}pushArray(e,i=e.length){for(let n=0;n<i;n++)this.data[this._length++]=e[n]}fill(e,i){for(let n=0;n<i;n++)this.data[this._length++]=e}pushNew(){this._allocator&&(this.data[this.length]=this._allocator(this.data[this.length]));const e=this.data[this._length];return++this._length,e}unshift(e){this.data.unshift(e),this._length++,JB(this)}pop(){if(this.length===0)return;const e=this.data[this.length-1];return this.length=this.length-1,this._shrink(),e}remove(e){const i=qL(this.data,e,this.length,this._hint);if(i!==-1)return this.data.splice(i,1),this.length=this.length-1,e}removeUnordered(e){return this.removeUnorderedIndex(qL(this.data,e,this.length,this._hint))}removeUnorderedIndex(e){if(!(e>=this.length||e<0))return this.swapElements(e,this.length-1),this.pop()}removeUnorderedMany(e,i=e.length,n){this.length=kge(this.data,e,this.length,i,this._hint,n),this._shrink()}front(){if(this.length!==0)return this.data[0]}back(){if(this.length!==0)return this.data[this.length-1]}swapElements(e,i){if(e>=this.length||i>=this.length||e===i)return;const n=this.data[e];this.data[e]=this.data[i],this.data[i]=n}sort(e){WB.sort(this.data,0,this.length,e)}iterableSort(e){return WB.iterableSort(this.data,0,this.length,e)}some(e,i){for(let n=0;n<this.length;++n)if(e.call(i,this.data[n],n,this.data))return!0;return!1}find(e,i){for(let n=0;n<this.length;++n){const r=this.data[n];if(e.call(i,r,n))return r}}filterInPlace(e,i){let n=0;for(let r=0;r<this._length;++r){const s=this.data[r];e.call(i,s,r,this.data)&&(this.data[r]=this.data[n],this.data[n]=s,n++)}if(this._deallocator)for(let r=n;r<this._length;r++)this.data[r]=this._deallocator(this.data[r]);return this._length=n,this._shrink(),this}forAll(e,i){const n=this.length,r=this.data;for(let s=0;s<n;++s)e.call(i,r[s],s,r)}forEach(e,i){for(let n=0;n<this.length;++n)e.call(i,this.data[n],n,this.data)}map(e,i){const n=new Array(this.length);for(let r=0;r<this.length;++r)n[r]=e.call(i,this.data[r],r,this.data);return n}reduce(e,i){let n=i;for(let r=0;r<this.length;++r)n=e(n,this.data[r],r,this.data);return n}has(e){const i=this.length,n=this.data;for(let r=0;r<i;++r)if(n[r]===e)return!0;return!1}};function JB(t){t.data.length>vye*t.length&&(t.data.length=Math.floor(t.length*_ye))}function bye(t){return{setTimeout:(e,i)=>{const n=t.setTimeout(e,i);return{remove:()=>t.clearTimeout(n)}}}}const Pb=bye(globalThis);function q$(t){return t&&(typeof t.on=="function"||typeof t.addEventListener=="function")}function Lh(t,e,i){if(!q$(t))throw new TypeError("target is not a Evented or EventTarget object");if("on"in t)return t.on(e,i);if(Array.isArray(e)){const n=e.slice();for(const r of n)t.addEventListener(r,i);return{remove(){for(const r of n)t.removeEventListener(r,i)}}}return t.addEventListener(e,i),{remove(){t.removeEventListener(e,i)}}}function SK(t,e,i){if(!q$(t))throw new TypeError("target is not a Evented or EventTarget object");if("once"in t)return t.once(e,i);const n=Lh(t,e,r=>{n.remove(),i.call(t,r)});return{remove(){n.remove()}}}const wye={Win:"Meta",Scroll:"ScrollLock",Spacebar:" ",Down:"ArrowDown",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Del:"Delete",Apps:"ContextMenu",Esc:"Escape",Multiply:"*",Add:"+",Subtract:"-",Decimal:".",Divide:"/"};function Uh({key:t}){return wye[t]||t}function li(t="Aborted"){return new V("AbortError",t)}function Vt(t,e="Aborted"){if(zo(t))throw li(e)}function W$(t){return t!=null?"aborted"in t?t:t.signal:t}function zo(t){const e=W$(t);return e!=null&&e.aborted}function $o(t){if(Ds(t))throw t}function QL(t){if(!Ds(t))throw t}function Ro(t,e){const i=W$(t);if(i!=null){if(!i.aborted)return SK(i,"abort",()=>e());e()}}function zz(t,e){const i=W$(t);if(i!=null)return Vt(i),SK(i,"abort",()=>e(li()))}function S_(t,e){return W$(e)==null?t:new Promise((i,n)=>{let r=Ro(e,()=>n(li()));const s=()=>r=Ri(r);t.then(s,s),t.then(i,n)})}function Ds(t){return(t==null?void 0:t.name)==="AbortError"}async function $y(t){try{return await t}catch(e){if(!Ds(e))throw e;return}}async function Sn(t){if(!t)return;if(typeof t.forEach!="function"){const i=Object.keys(t),n=i.map(o=>t[o]),r=await Sn(n),s={};return i.map((o,a)=>s[o]=r[a]),s}const e=t;return Promise.allSettled(e).then(i=>Array.from(e,(n,r)=>{const s=i[r];return s.status==="fulfilled"?{promise:n,value:s.value}:{promise:n,error:s.reason}}))}async function TK(t){return(await Sn(t)).filter(e=>!!e.value).map(e=>e.value)}function J$(t,e=void 0,i){const n=new AbortController;return Ro(i,()=>n.abort()),new Promise((r,s)=>{let o=setTimeout(()=>{o=0,r(e)},t);Ro(n,()=>{o&&(clearTimeout(o),s(li()))})})}function fd(t){return t&&typeof t.then=="function"}function eR(t){return fd(t)?t:Promise.resolve(t)}function kS(t,e=-1){let i,n,r,s,o=null;const a=(...l)=>{if(i){n=l,s&&s.reject(li()),s=xc();const f=s.promise;if(o){const m=o;o=null,m.abort()}return f}if(r=s||xc(),s=null,e>0){const f=new AbortController;i=eR(t(...l,f.signal));const m=i;J$(e).then(()=>{i===m&&(s?f.abort():o=f)})}else i=1,i=eR(t(...l));const c=()=>{const f=n;n=r=i=o=null,f!=null&&a(...f)},u=i,d=r;return u.then(c,c),u.then(d.resolve,d.reject),d.promise};return a}function xc(){let t,e;const i=new Promise((r,s)=>{t=r,e=s}),n=r=>{t(r)};return n.resolve=r=>t(r),n.reject=r=>e(r),n.timeout=(r,s)=>Pb.setTimeout(()=>n.reject(s),r),n.promise=i,n}async function ZB(t){await Promise.resolve(),Vt(t)}function Aot(t){return t}function $ot(t){return .001*t}function Pot(){return performance.now()}let xye=class{constructor(e){this.phases=e,this.paused=!1,this.ticks=-1,this.removed=!1}},Sye=class{constructor(e){this.callback=e,this.isActive=!0}remove(){this.isActive=!1}},tR=0;const h1={time:0,deltaTime:0,elapsedFrameTime:0,frameDuration:0},iR=["prepare","preRender","render","postRender","update","finish"],nR=[],Py=new Sf;let Tye=class{constructor(e){this._task=e}remove(){this._task.removed=!0}pause(){this._task.paused=!0}resume(){this._task.paused=!1}};const DE={frameTasks:Py,willDispatch:!1,clearFrameTasks:Iye,dispatch:MK,executeFrameTasks:Cye};function kb(t){const e=new Sye(t);return nR.push(e),DE.willDispatch||(DE.willDispatch=!0,Z_(MK)),e}function Y_(t){const e=new xye(t);return Py.push(e),NE==null&&(tR=performance.now(),NE=requestAnimationFrame(IK)),new Tye(e)}let NE=null;function Iye(t=!1){Py.forAll(e=>{e.removed=!0}),t&&CK()}function IK(){const t=performance.now();NE=null,NE=Py.length>0?requestAnimationFrame(IK):null,DE.executeFrameTasks(t)}function Cye(t){const e=t-tR;tR=t;const i=1e3/60,n=Math.max(0,e-i);h1.time=t,h1.frameDuration=i-n;for(let r=0;r<iR.length;r++){const s=performance.now(),o=iR[r];Py.forAll(a=>{var l;a.paused||a.removed||(r===0&&a.ticks++,a.phases[o]&&(h1.elapsedFrameTime=performance.now()-t,h1.deltaTime=a.ticks===0?0:e,(l=a.phases[o])==null||l.call(a,h1)))}),Eye[r].record(performance.now()-s)}CK(),Aye.record(performance.now()-t)}const zT=new Sf;function CK(){Py.forAll(t=>{t.removed&&zT.push(t)}),Py.removeUnorderedMany(zT.data,zT.length),zT.clear()}function MK(){for(;nR.length;){const t=nR.shift();t.isActive&&t.callback()}DE.willDispatch=!1}function Mye(t=1,e){const i=xc(),n=()=>{zo(e)?i.reject(li()):t===0?i():(--t,Z_(()=>n()))};return n(),i.promise}const Eye=iR.map(t=>new Ax(t)),Aye=new Ax("total");function $ye(t,e){for(const i of t.entries())if(e(i[0]))return!0;return!1}function Pye(t,e){const i=new Set;return t!=null&&t.forEach(n=>i.add(n)),e!=null&&e.forEach(n=>i.add(n)),i}let kye=0;function T_(){return++kye}let Z$=class{constructor(e){this._accessed=[],this._handles=[],this._observerObject=new Oye(e),YB.register(this,new WeakRef(this._observerObject),this)}destroy(){var e;YB.unregister(this._observerObject),this._accessed.length=0,(e=this._observerObject)==null||e.destroy(),this.clear()}onObservableAccessed(e){const i=this._accessed;i.includes(e)||i.push(e)}onTrackingEnd(){const e=this._handles,i=this._accessed,n=this._observerObject;for(let r=0;r<i.length;++r)e.push(i[r].observe(n));i.length=0}clear(){const e=this._handles;for(let i=0;i<e.length;++i)e[i].remove();e.length=0}},Oye=class{constructor(e){this._notify=e,this._invalidCount=0,this.destroyed=!1}onInvalidated(){this._invalidCount++}onCommitted(){if(this.destroyed)return;const e=this._invalidCount;if(e===1)return this._invalidCount=0,void this._notify();this._invalidCount=e>0?e-1:0}destroy(){this.destroyed=!0,this._notify=Lye}};const YB=new FinalizationRegistry(t=>{var e;(e=t.deref())==null||e.destroy()});function Lye(){}let I_=!1;const FE=[];function EK(t,e){let i=new Z$(s),n=null,r=!1;function s(){if(!i||r)return;if(I_)return void $K(s);const a=n;i.clear(),I_=!0,r=!0,n=id(i,t),r=!1,I_=!1,e(n,a),PK()}function o(){i&&(i.destroy(),i=null,n=null)}return r=!0,n=id(i,t),r=!1,{remove:o}}function AK(t,e){let i=new Z$(r),n=null;function r(){e(n,o)}function s(){i&&(i.destroy(),i=null),n=null}function o(){return i?(i.clear(),n=id(i,t),n):null}return o(),{remove:s}}function Vz(t){let e=new Z$(n),i=!1;function n(){e&&!i&&(I_?$K(n):(e.clear(),I_=!0,i=!0,id(e,t),i=!1,I_=!1,PK()))}function r(){e&&(e.destroy(),e=null)}return i=!0,id(e,t),i=!1,{remove:r}}function $K(t){FE.includes(t)||FE.unshift(t)}function PK(){for(;FE.length;)FE.pop()()}var $x;(function(t){t[t.Untracked=0]="Untracked",t[t.Tracked=1]="Tracked"})($x||($x={}));let S2=class{constructor(){this.uid=T_(),this.removed=!1,this.type=null,this.oldValue=null,this.callback=null,this.getValue=null,this.target=null,this.path=null,this.equals=null}static acquireUntracked(e,i,n,r,s){return this.pool.acquire($x.Untracked,e,i,n,r,s,Dz)}static acquireTracked(e,i,n,r){return this.pool.acquire($x.Tracked,e,i,n,null,null,r)}notify(e,i){this.type===$x.Untracked?this.callback.call(this.target,e,i,this.path,this.target):this.callback.call(null,e,i,void 0,void 0)}acquire(e,i,n,r,s,o,a){this.uid=T_(),this.removed=!1,this.type=e,this.oldValue=i,this.callback=n,this.getValue=r,this.target=s,this.path=o,this.equals=a}release(){this.target=this.path=this.oldValue=this.callback=this.getValue=null,this.uid=T_(),this.removed=!0}};S2.pool=new xK(S2);const HC=new eo,Gh=new Set;let zE;function VE(t){Gh.delete(t),Gh.add(t),zE||(zE=kb(Nye))}function Rye(t){if(t.removed)return;const e=t.oldValue,i=t.getValue();t.equals(e,i)||(t.oldValue=i,t.notify(i,e))}function Dye(t){for(const e of Gh.values())e.target===t&&(e.removed=!0)}function Nye(){let t=10;for(;zE&&t--;){zE=null;const e=Fye(),i=HC.acquire();for(const n of e){const r=n.uid;Rye(n),r===n.uid&&n.removed&&i.push(n)}for(const n of Gh)n.removed&&(i.push(n),Gh.delete(n));for(const n of i)S2.pool.release(n);HC.release(i),HC.release(e),rR.forEach(n=>n())}}function Fye(){const t=HC.acquire();t.length=Gh.size;let e=0;for(const i of Gh)t[e]=i,++e;return Gh.clear(),t}const rR=new Set;function zye(t){return rR.add(t),{remove(){rR.delete(t)}}}function Vye(t,e,i){let n=uK(t,e,i,(r,s,o)=>{let a,l,c=AK(()=>$S(r,s),(u,d)=>{r.__accessor__.destroyed||a&&a.uid!==l?n.remove():(a||(a=S2.acquireUntracked(u,o,d,r,s),l=a.uid),VE(a))});return{remove:hK(()=>{c.remove(),a&&(a.uid!==l||a.removed||(a.removed=!0,VE(a)),a=null),n=c=null})}});return n}function jye(t,e,i){const n=uK(t,e,i,(r,s,o)=>{let a=!1;return EK(()=>$S(r,s),(l,c)=>{r.__accessor__.destroyed?n.remove():a||(a=!0,Dz(c,l)||o.call(r,l,c,s,r),a=!1)})});return n}function Bye(t,e,i,n=!1){return!t.__accessor__||t.__accessor__.destroyed?{remove(){}}:n?jye(t,e,i):Vye(t,e,i)}function Uye(t,e,i){let n,r,s=AK(t,(o,a)=>{n&&n.uid!==r?s.remove():(n||(n=S2.acquireTracked(o,e,a,i),r=n.uid),VE(n))});return{remove:hK(()=>{s.remove(),n&&(n.uid!==r||n.removed||(n.removed=!0,VE(n)),n=null),s=null})}}function Gye(t,e,i){let n=!1;return EK(t,(r,s)=>{n||(n=!0,i(s,r)||e(r,s),n=!1)})}function Hye(t,e,i=!1,n=rK){return i?Gye(t,e,n):Uye(t,e,n)}function XB(t){return $ye(Gh,e=>e.oldValue===t)}function OS(t,e){for(const[i,n]of t)if(e(n,i))return!0;return!1}function Fot(t,e){for(const[i,n]of t)if(e(n,i))return n;return null}function kK(t,e,i){const n=t.get(e);if(n!==void 0)return n;const r=i();return t.set(e,r),r}const C_=ne.getLogger("esri.core.accessorSupport.ensureTypes");function qye(t){return t==null?t:new Date(t)}function Wye(t){return t==null?t:!!t}function LS(t){return t==null?t:t.toString()}function Qa(t){return t==null?t:(t=parseFloat(t),isNaN(t)?0:t)}function jz(t){return t==null?t:Math.round(parseFloat(t))}function OK(t){return t&&t.constructor&&t.constructor.__accessorMetadata__!==void 0}function jE(t,e){return e!=null&&t&&!(e instanceof t)}function LK(t){return t&&"isCollection"in t}function KB(t){return t&&t.Type?typeof t.Type=="function"?t.Type:t.Type.base:null}function Jye(t,e){if(!e||!e.constructor||!LK(e.constructor))return sR(t,e)?e:new t(e);const i=KB(t.prototype.itemType),n=KB(e.constructor.prototype.itemType);return i?n?i===n?e:i.prototype.isPrototypeOf(n.prototype)?new t(e):(sR(t,e),e):new t(e):e}function sR(t,e){return!!OK(e)&&(C_.error("Accessor#set","Assigning an instance of '"+(e.declaredClass||"unknown")+"' which is not a subclass of '"+Y$(t)+"'"),!0)}function t0(t,e){return e==null?e:LK(t)?Jye(t,e):jE(t,e)?sR(t,e)?e:new t(e):e}function Y$(t){return t&&t.prototype&&t.prototype.declaredClass||"unknown"}const Zye=new WeakMap;function Yye(t){switch(t){case Number:return Qa;case It:return jz;case Boolean:return Wye;case String:return LS;case Date:return qye;default:return kK(Zye,t,()=>t0.bind(null,t))}}function fn(t,e){const i=Yye(t);return arguments.length===1?i:i(e)}function T2(t,e,i){return arguments.length===1?T2.bind(null,t):e&&(Array.isArray(e)?e.map(n=>t(n,i)):[t(e,i)])}function Xye(t,e){return arguments.length===1?T2(i=>fn(t,i)):T2(i=>fn(t,i),e)}function RK(t,e,i){return e!==0&&Array.isArray(i)?i.map(n=>RK(t,e-1,n)):t(i)}function BE(t,e,i){if(arguments.length===2)return s=>BE(t,e,s);if(!i)return i;i=RK(t,e,i);let n=e,r=i;for(;n>0&&Array.isArray(r);)n--,r=r[0];if(r!==void 0)for(let s=0;s<n;s++)i=[i];return i}function Kye(t,e,i){return arguments.length===2?BE(n=>fn(t,n),e):BE(n=>fn(t,n),e,i)}function DK(t){return!!Array.isArray(t)&&!t.some(e=>{const i=typeof e;return!(i==="string"||i==="number"||i==="function"&&t.length>1)})}function oR(t,e){if(arguments.length===2)return oR(t).call(null,e);const i=new Set,n=t.filter(a=>typeof a!="function"),r=t.filter(a=>typeof a=="function");for(const a of t)typeof a!="string"&&typeof a!="number"||i.add(a);let s=null,o=null;return(a,l)=>{if(a==null)return a;const c=typeof a,u=c==="string"||c==="number";return u&&(i.has(a)||r.some(d=>c==="string"&&d===String||c==="number"&&d===Number))||c==="object"&&r.some(d=>!jE(a,d))?a:(u&&n.length?(s||(s=n.map(d=>typeof d=="string"?`'${d}'`:`${d}`).join(", ")),C_.error("Accessor#set",`'${a}' is not a valid value for this property, only the following values are valid: ${s}`)):typeof a=="object"&&r.length?(o||(o=r.map(d=>Y$(d)).join(", ")),C_.error("Accessor#set",`'${a}' is not a valid value for this property, value must be one of ${o}`)):C_.error("Accessor#set",`'${a}' is not a valid value for this property`),l&&(l.valid=!1),null)}}function nd(t,e){if(arguments.length===2)return nd(t).call(null,e);const i={},n=[],r=[];for(const l in t.typeMap){const c=t.typeMap[l];i[l]=fn(c),n.push(Y$(c)),r.push(l)}const s=()=>`'${n.join("', '")}'`,o=()=>`'${r.join("', '")}'`,a=typeof t.key=="string"?l=>l[t.key]:t.key;return l=>{if(t.base&&!jE(t.base,l)||l==null)return l;const c=a(l)||t.defaultKeyValue,u=i[c];if(!u)return C_.error("Accessor#set",`Invalid property value, value needs to be one of ${s()}, or a plain object that can autocast (having .type = ${o()})`),null;if(!jE(t.typeMap[c],l))return l;if(typeof t.key=="string"&&!OK(l)){const d={};for(const f in l)f!==t.key&&(d[f]=l[f]);return u(d)}return u(l)}}let It=class{};const d1={native:t=>({type:"native",value:t}),array:t=>({type:"array",value:t}),oneOf:t=>({type:"one-of",values:t})};function Qye(t){if(!t||!("type"in t))return!1;switch(t.type){case"native":case"array":case"one-of":return!0}return!1}function NK(t){switch(t.type){case"native":return fn(t.value);case"array":return T2(NK(t.value));case"one-of":return e0e(t);default:return null}}function e0e(t){let e=null;return(i,n)=>lR(i,t)?i:(e==null&&(e=aR(t)),C_.error("Accessor#set",`Invalid property value, value needs to be of type ${e}`),n&&(n.valid=!1),null)}function aR(t){switch(t.type){case"native":switch(t.value){case Number:return"number";case String:return"string";case Boolean:return"boolean";case It:return"integer";case Date:return"date";default:return Y$(t.value)}case"array":return`array of ${aR(t.value)}`;case"one-of":{const e=t.values.map(i=>aR(i));return`one of ${e.slice(0,e.length-1)} or ${e[e.length-1]}`}}return"unknown"}function lR(t,e){if(t==null)return!0;switch(e.type){case"native":switch(e.value){case Number:case It:return typeof t=="number";case Boolean:return typeof t=="boolean";case String:return typeof t=="string"}return t instanceof e.value;case"array":return!!Array.isArray(t)&&!t.some(i=>!lR(i,e.value));case"one-of":return e.values.some(i=>lR(t,i))}}function p(t={}){return(e,i)=>{if(e===Function.prototype)throw new Error(`Inappropriate use of @property() on a static field: ${e.name}.${i}. Accessor does not support static properties.`);const n=Object.getOwnPropertyDescriptor(e,i),r=H$(e,i);n&&(n.get||n.set?(r.get=n.get||r.get,r.set=n.set||r.set):"value"in n&&("value"in t&&ne.getLogger("esri.core.accessorSupport.decorators.property").warn(`@property() will redefine the value of "${i}" on "${e.constructor.name}" already defined in the metadata`,t),r.value=t.value=n.value)),t.readOnly!=null&&(r.readOnly=t.readOnly);const s=t.aliasOf;if(s){const l=typeof s=="string"?s:s.source,c=typeof s=="string"?null:s.overridable===!0;let u;r.dependsOn=[l],r.get=function(){let d=kE(this,l);if(typeof d=="function"){u||(u=l.split(".").slice(0,-1).join("."));const f=kE(this,u);f&&(d=d.bind(f))}return d},r.readOnly||(r.set=c?function(d){this._override(i,d)}:function(d){RE(this,l,d)})}const o=t.type,a=t.types;r.cast||(o?r.cast=t0e(o):a&&(Array.isArray(a)?r.cast=T2(nd(a[0])):r.cast=nd(a))),Xge(r,t),t.range&&(r.cast=i0e(r.cast,t.range))}}function FK(t,e,i){const n=H$(t,i);n.json||(n.json={});let r=n.json;return e!==void 0&&(r.origins||(r.origins={}),r.origins[e]||(r.origins[e]={}),r=r.origins[e]),r}function t0e(t){let e=0,i=t;if(Qye(t))return NK(t);for(;Array.isArray(i)&&i.length===1&&typeof i[0]!="string"&&typeof i[0]!="number";)i=i[0],e++;const n=i;if(DK(n))return e===0?oR(n):BE(oR(n),e);if(e===1)return Xye(n);if(e>1)return Kye(n,e);const r=t;return r.from?r.from:fn(r)}function i0e(t,e){return i=>{let n=+t(i);return e.step!=null&&(n=Math.round(n/e.step)*e.step),e.min!=null&&(n=Math.max(e.min,n)),e.max!=null&&(n=Math.min(e.max,n)),n}}function n0e(t){if(t.json&&t.json.origins){const e=t.json.origins,i={"web-document":["web-scene","web-map"]};for(const n in i)if(e[n]){const r=e[n];i[n].forEach(s=>{e[s]=r}),delete e[n]}}}let fl=class extends bK{constructor(e,i,n){super(e,i,n)}};fl.prototype.type="warning";function zK(t){return!!t&&t.prototype&&t.prototype.declaredClass&&t.prototype.declaredClass.indexOf("esri.core.Collection")===0}const cR=ne.getLogger("esri.core.accessorSupport.extensions.serializableProperty.reader");function QB(t,e,i){var n,r;t&&(!i&&!e.read||(n=e.read)!=null&&n.reader||((r=e.read)==null?void 0:r.enabled)===!1||o0e(t)&&dl("read.reader",Ob(t),e))}function Ob(t){var i,n;const e=t.ndimArray??0;if(e>1)return s0e(t);if(e===1)return e9(t);if("type"in t&&jK(t.type)){const r=(n=(i=t.type.prototype)==null?void 0:i.itemType)==null?void 0:n.Type,s=e9(typeof r=="function"?{type:r}:{types:r});return(o,a,l)=>{const c=s(o,a,l);return c&&new t.type(c)}}return Bz(t)}function Bz(t){return"type"in t?r0e(t.type):a0e(t.types)}function r0e(t){return t.prototype.read?(e,i,n)=>{if(e==null)return e;const r=typeof e;if(r!=="object")return void cR.error(`Expected JSON value of type 'object' to deserialize type '${t.prototype.declaredClass}', but got '${r}'`);const s=new t;return s.read(e,n),s}:t.fromJSON}function VK(t,e,i,n){return n!==0&&Array.isArray(e)?e.map(r=>VK(t,r,i,n-1)):t(e,void 0,i)}function s0e(t){const e=Bz(t),i=VK.bind(null,e),n=t.ndimArray??0;return(r,s,o)=>{if(r==null)return r;r=i(r,o,n);let a=n,l=r;for(;a>0&&Array.isArray(l);)a--,l=l[0];if(l!==void 0)for(let c=0;c<a;c++)r=[r];return r}}function e9(t){const e=Bz(t);return(i,n,r)=>{if(i==null)return i;if(Array.isArray(i)){const o=[];for(const a of i){const l=e(a,void 0,r);l!==void 0&&o.push(l)}return o}const s=e(i,void 0,r);return s!==void 0?[s]:void 0}}function jK(t){if(!zK(t))return!1;const e=t.prototype.itemType;return!(!e||!e.Type)&&(typeof e.Type=="function"?Uz(e.Type):BK(e.Type))}function o0e(t){return"types"in t?BK(t.types):Uz(t.type)}function Uz(t){return!Array.isArray(t)&&!!t&&t.prototype&&("read"in t.prototype||"fromJSON"in t||jK(t))}function BK(t){for(const e in t.typeMap)if(!Uz(t.typeMap[e]))return!1;return!0}function a0e(t){let e=null;const i=t.errorContext??"type";return(n,r,s)=>{if(n==null)return n;const o=typeof n;if(o!=="object")return void cR.error(`Expected JSON value of type 'object' to deserialize, but got '${o}'`);e||(e=l0e(t));const a=t.key;if(typeof a!="string")return;const l=n[a],c=l?e[l]:t.defaultKeyValue?t.typeMap[t.defaultKeyValue]:void 0;if(!c){const d=`Type '${l||"unknown"}' is not supported`;return s&&s.messages&&n&&s.messages.push(new fl(`${i}:unsupported`,d,{definition:n,context:s})),void cR.error(d)}const u=new c;return u.read(n,s),u}}function l0e(t){var i,n;const e={};for(const r in t.typeMap){const s=t.typeMap[r],o=PS(s.prototype);if(typeof t.key=="function")continue;const a=o[t.key];if(!a)continue;(i=a.json)!=null&&i.type&&Array.isArray(a.json.type)&&a.json.type.length===1&&typeof a.json.type[0]=="string"&&(e[a.json.type[0]]=s);const l=(n=a.json)==null?void 0:n.write;if(!l||!l.writer){e[r]=s;continue}const c=l.target,u=typeof c=="string"?c:t.key,d={};l.writer(r,d,u),d[u]&&(e[d[u]]=s)}return e}function c0e(t){if(t.json||(t.json={}),i9(t.json),n9(t.json),t9(t.json),t.json.origins)for(const e in t.json.origins)i9(t.json.origins[e]),n9(t.json.origins[e]),t9(t.json.origins[e]);return!0}function t9(t){t.name&&(t.read&&typeof t.read=="object"?t.read.source===void 0&&(t.read.source=t.name):t.read={source:t.name},t.write&&typeof t.write=="object"?t.write.target===void 0&&(t.write.target=t.name):t.write={target:t.name})}function i9(t){typeof t.read=="boolean"?t.read={enabled:t.read}:typeof t.read=="function"?t.read={enabled:!0,reader:t.read}:t.read&&typeof t.read=="object"&&t.read.enabled===void 0&&(t.read.enabled=!0)}function n9(t){typeof t.write=="boolean"?t.write={enabled:t.write}:typeof t.write=="function"?t.write={enabled:!0,writer:t.write}:t.write&&typeof t.write=="object"&&t.write.enabled===void 0&&(t.write.enabled=!0)}function r9(t,e){if(!e.write||e.write.writer||e.write.enabled===!1&&!e.write.overridePolicy)return;const i=(t==null?void 0:t.ndimArray)??0;t&&(i===1||"type"in t&&zK(t.type))?e.write.writer=d0e:i>1?e.write.writer=p0e(i):e.types?Array.isArray(e.types)?e.write.writer=h0e(e.types[0]):e.write.writer=u0e(e.types):e.write.writer=I2}function u0e(t){return(e,i,n,r)=>e?UK(e,t,r)?I2(e,i,n,r):void 0:I2(e,i,n,r)}function UK(t,e,i){for(const n in e.typeMap)if(t instanceof e.typeMap[n])return!0;if(i!=null&&i.messages){const n=e.errorContext??"type",r=`Values of type '${(typeof e.key!="function"?t[e.key]:t.declaredClass)??"Unknown"}' cannot be written`;i&&i.messages&&t&&i.messages.push(new V(`${n}:unsupported`,r,{definition:t,context:i})),ne.getLogger("esri.core.accessorSupport.extensions.serializableProperty.writer").error(r)}return!1}function h0e(t){return(e,i,n,r)=>!e||!Array.isArray(e)?I2(e,i,n,r):I2(e.filter(s=>UK(s,t,r)),i,n,r)}function I2(t,e,i,n){dl(i,UE(t,n),e)}function UE(t,e){return t&&typeof t.write=="function"?t.write({},e):t&&typeof t.toJSON=="function"?t.toJSON():typeof t=="number"?GE(t):t}function GE(t){return t===-1/0?-Number.MAX_VALUE:t===1/0?Number.MAX_VALUE:isNaN(t)?null:t}function d0e(t,e,i,n){let r;t===null?r=null:t&&typeof t.map=="function"?(r=t.map(s=>UE(s,n)),typeof r.toArray=="function"&&(r=r.toArray())):r=[UE(t,n)],dl(i,r,e)}function GK(t,e,i){return i!==0&&Array.isArray(t)?t.map(n=>GK(n,e,i-1)):UE(t,e)}function p0e(t){return(e,i,n,r)=>{let s;if(e===null)s=null;else{s=GK(e,r,t);let o=t,a=s;for(;o>0&&Array.isArray(a);)o--,a=a[0];if(a!==void 0)for(let l=0;l<o;l++)s=[s]}dl(n,s,i)}}function f0e(t,e){return Gz(t,"any",e==null?void 0:e.origin)}function uR(t,e){return Gz(t,"read",e==null?void 0:e.origin)}function HK(t,e){return Gz(t,"write",e==null?void 0:e.origin)}function Gz(t,e,i){let n=t==null?void 0:t.json;if(n!=null&&n.origins&&i){let r;r=i==="link-chart"?n.origins[i]&&(e==="any"||e in n.origins[i])?n.origins[i]:n.origins["web-map"]:n.origins[i],r&&(e==="any"||e in r)&&(n=r)}return n}function m0e(t){const e=g0e(t);if(t.json.origins)for(const i in t.json.origins){const n=t.json.origins[i],r=n.types?y0e(n):e;QB(r,n,!1),n.types&&!n.write&&t.json.write&&t.json.write.enabled&&(n.write={...t.json.write}),r9(r,n)}QB(e,t.json,!0),r9(e,t.json)}function g0e(t){return t.json.types?hR(t.json):t.type?qK(t):hR(t)}function y0e(t){return t.type?qK(t):hR(t)}function qK(t){if(!t.type)return;let e=0,i=t.type;for(;Array.isArray(i)&&!DK(i);)i=i[0],e++;return{type:i,ndimArray:e}}function hR(t){if(!t.types)return;let e=0,i=t.types;for(;Array.isArray(i);)i=i[0],e++;return{types:i,ndimArray:e}}function v0e(t){c0e(t)&&(n0e(t),m0e(t))}const n3=new Set,r3=new Set;function P(t){return e=>{e.prototype.declaredClass=t,b0e(e);const i=[],n=[];let r=e.prototype;for(;r;)r.hasOwnProperty("initialize")&&!n3.has(r.initialize)&&(n3.add(r.initialize),i.push(r.initialize)),r.hasOwnProperty("destroy")&&!r3.has(r.destroy)&&(r3.add(r.destroy),n.push(r.destroy)),r=Object.getPrototypeOf(r);n3.clear(),r3.clear();class s extends e{constructor(...a){if(super(...a),this.constructor===s&&typeof this.postscript=="function"){if(i.length&&Object.defineProperty(this,"initialize",{enumerable:!1,configurable:!0,value(){for(let l=i.length-1;l>=0;l--)i[l].call(this)}}),n.length){let l=!1;const c=this[lK];Object.defineProperty(this,"destroy",{enumerable:!1,configurable:!0,value(){if(!l){l=!0,c.call(this);for(let u=0;u<n.length;u++)n[u].call(this)}}})}this.postscript(...a)}}}return s.__accessorMetadata__=PS(e.prototype),s.prototype.declaredClass=t,s}}function _0e(t,e){return e.get==null?function(){const i=this.__accessor__,n=i.propertiesByName.get(t);if(n===void 0)return;We(n.observerObject);const r=i.store;return r.has(t)?r.get(t):n.metadata.value}:function(){const i=this.__accessor__,n=i.propertiesByName.get(t);if(n!==void 0)return n.getComputed(i)}}function b0e(t){const e=t.prototype,i=PS(e),n={};for(const r of Object.getOwnPropertyNames(i)){const s=i[r];v0e(s),n[r]={enumerable:!0,configurable:!0,get:_0e(r,s),set(o){const a=this.__accessor__;if(a!==void 0){if(!Object.isFrozen(this)){if(a.initialized&&s.readOnly)throw new TypeError(`[accessor] cannot assign to read-only property '${r}' of ${this.declaredClass}`);if(a.lifecycle===Ph.CONSTRUCTED&&s.constructOnly)throw new TypeError(`[accessor] cannot assign to construct-only property '${r}' of ${this.declaredClass}`);a.set(r,o)}}else Object.defineProperty(this,r,{enumerable:!0,configurable:!0,writable:!0,value:o})}}}Object.defineProperties(t.prototype,n)}var WK,JK;function w0e(t){var e;if(t==null)return{value:t};if(Array.isArray(t))return{type:[t[0]],value:null};switch(typeof t){case"object":return(e=t.constructor)!=null&&e.__accessorMetadata__||t instanceof Date?{type:t.constructor,value:t}:t;case"boolean":return{type:Boolean,value:t};case"string":return{type:String,value:t};case"number":return{type:Number,value:t};case"function":return{type:t,value:null};default:return}}const Jd=Symbol("Accessor-Handles"),dR=Symbol("Accessor-Initialized");let ye=class ZK{static createSubclass(e={}){if(Array.isArray(e))throw new Error("Multi-inheritance unsupported since 4.16");const{properties:i,declaredClass:n,constructor:r}=e;delete e.declaredClass,delete e.properties,delete e.constructor;const s=this;class o extends s{constructor(...l){super(...l),this.inherited=null,r&&r.apply(this,l)}}PS(o.prototype);for(const a in e){const l=e[a];o.prototype[a]=typeof l=="function"?function(...c){const u=this.inherited;let d;this.inherited=function(...f){if(s.prototype[a])return s.prototype[a].apply(this,f)};try{d=l.apply(this,c)}catch(f){throw this.inherited=u,f}return this.inherited=u,d}:e[a]}for(const a in i){const l=w0e(i[a]);p(l)(o.prototype,a)}return P(n)(o)}constructor(...e){if(this[WK]=null,this[JK]=!1,this.constructor===ZK)throw new Error("[accessor] cannot instantiate Accessor. This can be fixed by creating a subclass of Accessor");const i=new uye(this);Object.defineProperty(this,"__accessor__",{enumerable:!1,value:i}),e.length>0&&this.normalizeCtorArgs&&(i.ctorArgs=this.normalizeCtorArgs.apply(this,e)),s9.register(this,i.propertiesByName,this)}postscript(e){const i=this.__accessor__,n=i.ctorArgs||e;i.initialize(),n&&(this.set(n),i.ctorArgs=null),i.constructed(),this.initialize(),this[dR]=!0}initialize(){}[lK](){this[Jd]=Je(this[Jd])}destroy(){var e;this.destroyed||(s9.unregister(this),Dye(this),this.__accessor__.destroy(),(e=yye())==null||e.onInstanceDestroy(this))}get constructed(){return this.__accessor__&&this.__accessor__.initialized||!1}get initialized(){return this[dR]}get destroyed(){return this.__accessor__&&this.__accessor__.destroyed||!1}commitProperty(e){this.get(e)}get(e){return kE(this,e)}hasOwnProperty(e){return this.__accessor__?this.__accessor__.has(e):Object.prototype.hasOwnProperty.call(this,e)}keys(){return this.__accessor__?this.__accessor__.keys():[]}set(e,i){return RE(this,e,i),this}watch(e,i,n){return Bye(this,e,i,n)}own(e){this.addHandles(e)}addHandles(e,i){if(this.destroyed){const r=Array.isArray(e)?e:[e];for(const s of r)s.remove();return}let n=this[Jd];n==null&&(n=this[Jd]=new Rs),n.add(e,i)}removeHandles(e){const i=this[Jd];i!=null&&i.remove(e)}removeAllHandles(){const e=this[Jd];e!=null&&e.removeAll()}hasHandles(e){const i=this[Jd];return i!=null&&i.has(e)}_override(e,i){i===void 0?this.__accessor__.clearOverride(e):this.__accessor__.override(e,i)}_clearOverride(e){return this.__accessor__.clearOverride(e)}_overrideIfSome(e,i){i==null?this.__accessor__.clearOverride(e):this.__accessor__.override(e,i)}_isOverridden(e){return this.__accessor__.isOverridden(e)}notifyChange(e){this.__accessor__.notifyChange(e)}_get(e){return this.__accessor__.internalGet(e)}_set(e,i){return this.__accessor__.internalSet(e,i),this}};WK=Jd,JK=dR;const s9=new FinalizationRegistry(t=>{for(const e of t.values())e.destroy()});let qC=class YK{constructor(){this._emitter=new YK.EventEmitter(this)}emit(e,i){return this._emitter.emit(e,i)}on(e,i){return this._emitter.on(e,i)}once(e,i){return this._emitter.once(e,i)}hasEventListener(e){return this._emitter.hasEventListener(e)}};(function(t){class e{constructor(r=null){this._target=r,this._listenersMap=null}clear(){var r;(r=this._listenersMap)==null||r.clear(),this._listenersMap=null}destroy(){this.clear()}emit(r,s){const o=this._listenersMap&&this._listenersMap.get(r);if(!o)return!1;const a=this._target||this;return[...o].forEach(l=>{l.call(a,s)}),o.length>0}on(r,s){if(Array.isArray(r)){const a=r.map(l=>this.on(l,s));return $c(a)}if(r.includes(","))throw new TypeError("Evented.on() with a comma delimited string of event types is not supported");this._listenersMap||(this._listenersMap=new Map);const o=this._listenersMap.get(r)||[];return o.push(s),this._listenersMap.set(r,o),{remove:()=>{const a=this._listenersMap&&this._listenersMap.get(r)||[],l=a.indexOf(s);l>=0&&a.splice(l,1)}}}once(r,s){const o=this.on(r,a=>{o.remove(),s.call(null,a)});return o}hasEventListener(r){const s=this._listenersMap&&this._listenersMap.get(r);return s!=null&&s.length>0}}t.EventEmitter=e,t.EventedMixin=n=>{let r=class extends n{constructor(){super(...arguments),this._emitter=new e}destroy(){this._emitter.clear()}emit(s,o){return this._emitter.emit(s,o)}on(s,o){return this._emitter.on(s,o)}once(s,o){return this._emitter.once(s,o)}hasEventListener(s){return this._emitter.hasEventListener(s)}};return r=h([P("esri.core.Evented")],r),r};let i=class extends ye{constructor(){super(...arguments),this._emitter=new qC.EventEmitter(this)}destroy(){this._emitter.clear()}emit(n,r){return this._emitter.emit(n,r)}on(n,r){return this._emitter.on(n,r)}once(n,r){return this._emitter.once(n,r)}hasEventListener(n){return this._emitter.hasEventListener(n)}};i=h([P("esri.core.Evented")],i),t.EventedAccessor=i})(qC||(qC={}));const Uo=qC;var Wt;(function(t){t[t.ADD=1]="ADD",t[t.REMOVE=2]="REMOVE",t[t.MOVE=4]="MOVE"})(Wt||(Wt={}));function XK(t){return(e,i)=>{e[i]=t}}let X$=class extends fK{notify(){const e=this._observers;if(e&&e.length>0){const i=e.slice();for(const n of i)n.onInvalidated(),n.onCommitted()}}};var Mh;let x0e=class{constructor(){this.target=null,this.cancellable=!1,this.defaultPrevented=!1,this.item=void 0,this.type=void 0}preventDefault(){this.cancellable&&(this.defaultPrevented=!0)}reset(e){this.defaultPrevented=!1,this.item=e}};const Ca=new e0(x0e,void 0,t=>{t.item=null,t.target=null,t.defaultPrevented=!1,t.cancellable=!1}),S0e=()=>{};function s3(t){return t?t instanceof jg?t.toArray():t.length?Array.prototype.slice.apply(t):[]:[]}function o3(t){if(t&&t.length)return t[0]}function T0e(t,e,i,n){const r=Math.min(t.length-i,e.length-n);let s=0;for(;s<r&&t[i+s]===e[n+s];)s++;return s}function KK(t,e,i,n){e&&e.forEach((r,s,o)=>{t.push(r),KK(t,i.call(n,r,s,o),i,n)})}const Ad=new Set,$d=new Set,Pd=new Set,a3=new Map;let I0e=0,jg=Mh=class extends Uo.EventedAccessor{static isCollection(t){return t!=null&&t instanceof Mh}constructor(t){super(t),this._chgListeners=[],this._notifications=null,this._timer=null,this._observable=new X$,this.length=0,this._items=[],Object.defineProperty(this,"uid",{value:I0e++})}normalizeCtorArgs(t){return t?Array.isArray(t)||t instanceof Mh?{items:t}:t:{}}destroy(){this._removeAllRaw()}*[Symbol.iterator](){yield*this.items}get items(){return We(this._observable),this._items}set items(t){this._emitBeforeChanges(Wt.ADD)||(this._splice(0,this.length,s3(t)),this._emitAfterChanges(Wt.ADD))}hasEventListener(t){return t==="change"?this._chgListeners.length>0:this._emitter.hasEventListener(t)}on(t,e){if(t==="change"){const i=this._chgListeners,n={removed:!1,callback:e};return i.push(n),this._notifications&&this._notifications.push({listeners:i.slice(),items:this._items.slice(),changes:[]}),{remove(){this.remove=S0e,n.removed=!0,i.splice(i.indexOf(n),1)}}}return this._emitter.on(t,e)}once(t,e){const i=this.on(t,e);return{remove(){i.remove()}}}add(t,e){if(We(this._observable),this._emitBeforeChanges(Wt.ADD))return this;const i=this.getNextIndex(e??null);return this._splice(i,0,[t]),this._emitAfterChanges(Wt.ADD),this}addMany(t,e=this._items.length){if(We(this._observable),!t||!t.length)return this;if(this._emitBeforeChanges(Wt.ADD))return this;const i=this.getNextIndex(e);return this._splice(i,0,s3(t)),this._emitAfterChanges(Wt.ADD),this}at(t){if(We(this._observable),(t=Math.trunc(t)||0)<0&&(t+=this.length),!(t<0||t>=this.length))return this._items[t]}removeAll(){if(We(this._observable),!this.length||this._emitBeforeChanges(Wt.REMOVE))return[];const t=this._removeAllRaw();return this._emitAfterChanges(Wt.REMOVE),t}_removeAllRaw(){return this.length===0?[]:this._splice(0,this.length)||[]}clone(){return We(this._observable),this._createNewInstance({items:this._items.map(q)})}concat(...t){We(this._observable);const e=t.map(s3);return this._createNewInstance({items:this._items.concat(...e)})}drain(t,e){if(We(this._observable),!this.length||this._emitBeforeChanges(Wt.REMOVE))return;const i=this._splice(0,this.length),n=i.length;for(let r=0;r<n;r++)t.call(e,i[r],r,i);this._emitAfterChanges(Wt.REMOVE)}every(t,e){return We(this._observable),this._items.every(t,e)}filter(t,e){let i;return We(this._observable),i=arguments.length===2?this._items.filter(t,e):this._items.filter(t),this._createNewInstance({items:i})}find(t,e){return We(this._observable),this._items.find(t,e)}findIndex(t,e){return We(this._observable),this._items.findIndex(t,e)}flatten(t,e){We(this._observable);const i=[];return KK(i,this,t,e),new Mh(i)}forEach(t,e){return We(this._observable),this._items.forEach(t,e)}getItemAt(t){return We(this._observable),this._items[t]}getNextIndex(t){We(this._observable);const e=this.length;return(t=t??e)<0?t=0:t>e&&(t=e),t}includes(t,e=0){return We(this._observable),this._items.includes(t,e)}indexOf(t,e=0){return We(this._observable),this._items.indexOf(t,e)}join(t=","){return We(this._observable),this._items.join(t)}lastIndexOf(t,e=this.length-1){return We(this._observable),this._items.lastIndexOf(t,e)}map(t,e){We(this._observable);const i=this._items.map(t,e);return new Mh({items:i})}reorder(t,e=this.length-1){We(this._observable);const i=this.indexOf(t);if(i!==-1){if(e<0?e=0:e>=this.length&&(e=this.length-1),i!==e){if(this._emitBeforeChanges(Wt.MOVE))return t;this._splice(i,1),this._splice(e,0,[t]),this._emitAfterChanges(Wt.MOVE)}return t}}pop(){if(We(this._observable),!this.length||this._emitBeforeChanges(Wt.REMOVE))return;const t=o3(this._splice(this.length-1,1));return this._emitAfterChanges(Wt.REMOVE),t}push(...t){return We(this._observable),this._emitBeforeChanges(Wt.ADD)||(this._splice(this.length,0,t),this._emitAfterChanges(Wt.ADD)),this.length}reduce(t,e){We(this._observable);const i=this._items;return arguments.length===2?i.reduce(t,e):i.reduce(t)}reduceRight(t,e){We(this._observable);const i=this._items;return arguments.length===2?i.reduceRight(t,e):i.reduceRight(t)}remove(t){return We(this._observable),this.removeAt(this.indexOf(t))}removeAt(t){if(We(this._observable),t<0||t>=this.length||this._emitBeforeChanges(Wt.REMOVE))return;const e=o3(this._splice(t,1));return this._emitAfterChanges(Wt.REMOVE),e}removeMany(t){if(We(this._observable),!t||!t.length||this._emitBeforeChanges(Wt.REMOVE))return[];const e=t instanceof Mh?t.toArray():t,i=this._items,n=[],r=e.length;for(let s=0;s<r;s++){const o=e[s],a=i.indexOf(o);if(a>-1){const l=1+T0e(e,i,s+1,a+1),c=this._splice(a,l);c&&c.length>0&&n.push.apply(n,c),s+=l-1}}return this._emitAfterChanges(Wt.REMOVE),n}reverse(){if(We(this._observable),this._emitBeforeChanges(Wt.MOVE))return this;const t=this._splice(0,this.length);return t&&(t.reverse(),this._splice(0,0,t)),this._emitAfterChanges(Wt.MOVE),this}shift(){if(We(this._observable),!this.length||this._emitBeforeChanges(Wt.REMOVE))return;const t=o3(this._splice(0,1));return this._emitAfterChanges(Wt.REMOVE),t}slice(t=0,e=this.length){return We(this._observable),this._createNewInstance({items:this._items.slice(t,e)})}some(t,e){return We(this._observable),this._items.some(t,e)}sort(t){if(We(this._observable),!this.length||this._emitBeforeChanges(Wt.MOVE))return this;const e=this._splice(0,this.length);return arguments.length?e.sort(t):e.sort(),this._splice(0,0,e),this._emitAfterChanges(Wt.MOVE),this}splice(t,e,...i){We(this._observable);const n=(e?Wt.REMOVE:0)|(i.length?Wt.ADD:0);if(this._emitBeforeChanges(n))return[];const r=this._splice(t,e,i)||[];return this._emitAfterChanges(n),r}toArray(){return We(this._observable),this._items.slice()}toJSON(){return We(this._observable),this.toArray()}toLocaleString(){return We(this._observable),this._items.toLocaleString()}toString(){return We(this._observable),this._items.toString()}unshift(...t){return We(this._observable),!t.length||this._emitBeforeChanges(Wt.ADD)||(this._splice(0,0,t),this._emitAfterChanges(Wt.ADD)),this.length}_createNewInstance(t){return new this.constructor(t)}_splice(t,e,i){const n=this._items,r=this.itemType;let s,o;if(!this._notifications&&this.hasEventListener("change")&&(this._notifications=[{listeners:this._chgListeners.slice(),items:this._items.slice(),changes:[]}],this._timer&&this._timer.remove(),this._timer=kb(()=>this._dispatchChange())),e){if(o=n.splice(t,e),this.hasEventListener("before-remove")){const a=Ca.acquire();a.target=this,a.cancellable=!0;for(let l=0,c=o.length;l<c;l++)s=o[l],a.reset(s),this.emit("before-remove",a),a.defaultPrevented&&(o.splice(l,1),n.splice(t,0,s),t+=1,l-=1,c-=1);Ca.release(a)}if(this.length=this._items.length,this.hasEventListener("after-remove")){const a=Ca.acquire();a.target=this,a.cancellable=!1;const l=o.length;for(let c=0;c<l;c++)a.reset(o[c]),this.emit("after-remove",a);Ca.release(a)}}if(i&&i.length){if(r){const u=[];for(const d of i){const f=r.ensureType(d);f==null&&d!=null||u.push(f)}i=u}const a=this.hasEventListener("before-add"),l=this.hasEventListener("after-add"),c=t===this.length;if(a||l){const u=Ca.acquire();u.target=this,u.cancellable=!0;const d=Ca.acquire();d.target=this,d.cancellable=!1;for(const f of i)a?(u.reset(f),this.emit("before-add",u),u.defaultPrevented||(c?n.push(f):n.splice(t++,0,f),this._set("length",n.length),l&&(d.reset(f),this.emit("after-add",d)))):(c?n.push(f):n.splice(t++,0,f),this._set("length",n.length),d.reset(f),this.emit("after-add",d));Ca.release(d),Ca.release(u)}else{if(c)for(const u of i)n.push(u);else n.splice(t,0,...i);this._set("length",n.length)}}return(i&&i.length||o&&o.length)&&this._notifyChangeEvent(i,o),o}_emitBeforeChanges(t){let e=!1;if(this.hasEventListener("before-changes")){const i=Ca.acquire();i.target=this,i.cancellable=!0,i.type=t,this.emit("before-changes",i),e=i.defaultPrevented,Ca.release(i)}return e}_emitAfterChanges(t){if(this.hasEventListener("after-changes")){const e=Ca.acquire();e.target=this,e.cancellable=!1,e.type=t,this.emit("after-changes",e),Ca.release(e)}this._observable.notify()}_notifyChangeEvent(t,e){this.hasEventListener("change")&&this._notifications&&this._notifications[this._notifications.length-1].changes.push({added:t,removed:e})}_dispatchChange(){if(this._timer&&(this._timer.remove(),this._timer=null),!this._notifications)return;const t=this._notifications;this._notifications=null;for(const e of t){const i=e.changes;Ad.clear(),$d.clear(),Pd.clear();for(const{added:l,removed:c}of i){if(l)if(Pd.size===0&&$d.size===0)for(const u of l)Ad.add(u);else for(const u of l)$d.has(u)?(Pd.add(u),$d.delete(u)):Pd.has(u)||Ad.add(u);if(c)if(Pd.size===0&&Ad.size===0)for(const u of c)$d.add(u);else for(const u of c)Ad.has(u)?Ad.delete(u):(Pd.delete(u),$d.add(u))}const n=eo.acquire();Ad.forEach(l=>{n.push(l)});const r=eo.acquire();$d.forEach(l=>{r.push(l)});const s=this._items,o=e.items,a=eo.acquire();if(Pd.forEach(l=>{o.indexOf(l)!==s.indexOf(l)&&a.push(l)}),e.listeners&&(n.length||r.length||a.length)){const l={target:this,added:n,removed:r,moved:a},c=e.listeners.length;for(let u=0;u<c;u++){const d=e.listeners[u];d.removed||d.callback.call(this,l)}}eo.release(n),eo.release(r),eo.release(a)}Ad.clear(),$d.clear(),Pd.clear()}};jg.ofType=t=>{if(!t)return Mh;if(a3.has(t))return a3.get(t);let e=null;if(typeof t=="function")e=t.prototype.declaredClass;else if(t.base)e=t.base.prototype.declaredClass;else for(const n in t.typeMap){const r=t.typeMap[n].prototype.declaredClass;e?e+=` | ${r}`:e=r}let i=class extends Mh{};return h([XK({Type:t,ensureType:typeof t=="function"?fn(t):nd(t)})],i.prototype,"itemType",void 0),i=h([P(`esri.core.Collection<${e}>`)],i),a3.set(t,i),i},h([p()],jg.prototype,"length",void 0),h([p()],jg.prototype,"items",null),jg=Mh=h([P("esri.core.Collection")],jg);const xe=jg;function Of(t,e,i=xe){return e||(e=new i),e===t||(e.removeAll(),C0e(t)?e.addMany(t):t&&e.add(t)),e}function QK(t){return t}function C0e(t){return t&&(Array.isArray(t)||"items"in t&&Array.isArray(t.items))}const o9=new Set;function M0e(t,e,i=!1){i&&o9.has(e)||(i&&o9.add(e),t.warn(` DEPRECATED - ${e}`))}function a9(t,e,i={}){if(ee("esri-deprecation-warnings")){const{moduleName:n}=i;M2(t,`Function: ${(n?n+"::":"")+e+"()"}`,i)}}function C2(t,e,i={}){if(ee("esri-deprecation-warnings")){const{moduleName:n}=i;M2(t,`Property: ${(n?n+"::":"")+e}`,i)}}function M2(t,e,i={}){if(ee("esri-deprecation-warnings")){const{replacement:n,version:r,see:s,warnOnce:o}=i;let a=e;n&&(a+=`
	 Replacement: ${n}`),r&&(a+=`
	 Version: ${r}`),s&&(a+=`
	 See ${s} for more details.`),M0e(t,a,o)}}let E0e=class eQ{constructor(){this._values=new Map,this.multipleOriginsSupported=!1}clone(e){const i=new eQ;return this._values.forEach((n,r)=>{e&&e.has(r)||i.set(r,q(n.value),n.origin)}),i}get(e,i){i=this._normalizeOrigin(i);const n=this._values.get(e);return i==null||(n==null?void 0:n.origin)===i?n==null?void 0:n.value:void 0}originOf(e){var i;return((i=this._values.get(e))==null?void 0:i.origin)??Ge.USER}keys(e){e=this._normalizeOrigin(e);const i=[...this._values.keys()];return e==null?i:i.filter(n=>{var r;return((r=this._values.get(n))==null?void 0:r.origin)===e})}set(e,i,n){if((n=this._normalizeOrigin(n))===Ge.DEFAULTS){const r=this._values.get(e);if(r&&r.origin!=null&&r.origin>n)return}this._values.set(e,new A0e(i,n))}delete(e,i){var n;(i=this._normalizeOrigin(i))!=null&&((n=this._values.get(e))==null?void 0:n.origin)!==i||this._values.delete(e)}has(e,i){var n;return(i=this._normalizeOrigin(i))!=null?((n=this._values.get(e))==null?void 0:n.origin)===i:this._values.has(e)}forEach(e){this._values.forEach(({value:i},n)=>e(i,n))}_normalizeOrigin(e){if(e!=null)return e===Ge.DEFAULTS?e:Ge.USER}},A0e=class{constructor(e,i){this.value=e,this.origin=i}};function tQ(t,e,i){e.keys().forEach(r=>{i.set(r,e.get(r),Ge.DEFAULTS)});const n=t.metadatas;Object.keys(n).forEach(r=>{t.internalGet(r)&&i.set(r,t.internalGet(r),Ge.DEFAULTS)})}function $0e(t,e,i){if(!t||!t.read||t.read.enabled===!1||!t.read.source)return!1;const n=t.read.source;if(typeof n=="string"){if(n===e||n.includes(".")&&n.indexOf(e)===0&&jB(n,i))return!0}else for(const r of n)if(r===e||r.includes(".")&&r.indexOf(e)===0&&jB(r,i))return!0;return!1}function P0e(t){return t&&(!t.read||t.read.enabled!==!1&&!t.read.source)}function k0e(t,e,i,n,r){let s=uR(e[i],r);P0e(s)&&(t[i]=!0);for(const o of Object.getOwnPropertyNames(e))s=uR(e[o],r),$0e(s,i,n)&&(t[o]=!0)}function O0e(t,e,i,n){const r=i.metadatas,s=f0e(r[e],n),o=s==null?void 0:s.default;if(o===void 0)return;const a=typeof o=="function"?o.call(t,e,n):o;a!==void 0&&i.set(e,a)}const iQ={origin:"service"};function nQ(t,e,i=iQ){if(!e||typeof e!="object")return;const n=no(t),r=n.metadatas,s={};for(const o of Object.getOwnPropertyNames(e))k0e(s,r,o,e,i);n.setDefaultOrigin(i.origin);for(const o of Object.getOwnPropertyNames(s)){const a=uR(r[o],i).read,l=a&&a.source;let c;c=l&&typeof l=="string"?$S(e,l):e[o],a&&a.reader&&(c=a.reader.call(t,c,e,i)),c!==void 0&&n.set(o,c)}if(!i||!i.ignoreDefaults){n.setDefaultOrigin("defaults");for(const o of Object.getOwnPropertyNames(r))s[o]||O0e(t,o,n,i)}n.setDefaultOrigin("user")}function L0e(t,e,i,n=iQ){var s;const r={...n,messages:[]};i(r),(s=r.messages)==null||s.forEach(o=>{o.type!=="warning"||t.loaded?n&&n.messages&&n.messages.push(o):t.loadWarnings.push(o)})}function R0e(t,e,i,n,r){var o,a;const s={};return(a=(o=e.write)==null?void 0:o.writer)==null||a.call(t,n,s,i,r),s}function rQ(t,e,i,n,r,s){if(!n||!n.write)return!1;const o=t.get(i);if(!r&&n.write.overridePolicy){const a=n.write.overridePolicy.call(t,o,i,s??void 0);a!==void 0&&(r=a)}if(r||(r=n.write),!r||r.enabled===!1)return!1;if((o===null&&!r.allowNull&&!r.writerEnsuresNonNull||o===void 0)&&r.isRequired){const a=new V("web-document-write:property-required",`Missing value for required property '${i}' on '${t.declaredClass}'`,{propertyName:i,target:t});return a&&s&&s.messages?s.messages.push(a):a&&!s&&ne.getLogger("esri.core.accessorSupport.write").error(a.name,a.message),!1}return!(o===void 0||o===null&&!r.allowNull&&!r.writerEnsuresNonNull||!r.alwaysWriteDefaults&&(!e.store.multipleOriginsSupported||e.store.originOf(i)===Ge.DEFAULTS)&&D0e(t,i,s,n,o)||!r.ignoreOrigin&&s&&s.origin&&e.store.multipleOriginsSupported&&e.store.originOf(i)<ef(s.origin))}function D0e(t,e,i,n,r){const s=n.default;if(s===void 0)return!1;if(n.defaultEquals!=null)return n.defaultEquals(r);if(typeof s=="function"){if(Array.isArray(r)){const o=s.call(t,e,i??void 0);return ES(o,r)}return!1}return s===r}function N0e(t,e,i,n){const r=no(t),s=r.metadatas,o=HK(s[e],n);return!!o&&rQ(t,r,e,o,i,n)}function sQ(t,e,i){var s,o;if(t&&typeof t.toJSON=="function"&&(!t.toJSON.isDefaultToJSON||!t.write))return BC(e,t.toJSON(i));const n=no(t),r=n.metadatas;for(const a in r){const l=HK(r[a],i);if(!rQ(t,n,a,l,void 0,i))continue;const c=t.get(a),u=R0e(t,l,l.write&&typeof l.write.target=="string"?l.write.target:a,c,i);Object.keys(u).length>0&&(e=BC(e,u),(o=(s=i==null?void 0:i.resources)==null?void 0:s.pendingOperations)!=null&&o.length&&i.resources.pendingOperations.push(Promise.all(i.resources.pendingOperations).then(()=>BC(e,u,()=>"replace-arrays"))),i&&i.writtenProperties&&i.writtenProperties.push({target:t,propName:a,oldOrigin:rye(n.store.originOf(a)),newOrigin:i.origin}))}return e}const RS=t=>{let e=class extends t{constructor(...i){super(...i);const n=no(this),r=n.store,s=new E0e;n.store=s,tQ(n,r,s)}read(i,n){nQ(this,i,n)}write(i,n){return sQ(this,i??{},n)}toJSON(i){return this.write({},i)}static fromJSON(i,n){return F0e.call(this,i,n)}};return e=h([P("esri.core.JSONSupport")],e),e.prototype.toJSON.isDefaultToJSON=!0,e};function F0e(t,e){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");const i=new this;return i.read(t,e),i}let ie=class extends RS(ye){};ie=h([P("esri.core.JSONSupport")],ie);var zp;(function(t){t[t.PENDING=0]="PENDING",t[t.RESOLVED=1]="RESOLVED",t[t.REJECTED=2]="REJECTED"})(zp||(zp={}));let z0e=class{constructor(){this._resolver=xc(),this._status=zp.PENDING,this._resolvingPromises=[],this._resolver.promise.then(()=>{this._status=zp.RESOLVED,this._cleanUp()},()=>{this._status=zp.REJECTED,this._cleanUp()}),this.promise=this._resolver.promise}destroy(){this._cleanUp()}addResolvingPromise(e){this._resolvingPromises.push(e),this._tryResolve()}isResolved(){return this._status===zp.RESOLVED}isRejected(){return this._status===zp.REJECTED}isFulfilled(){return this._status!==zp.PENDING}abort(){this._resolver.reject(li())}_cleanUp(){this._allPromise=null,this._resolvingPromises=null}_tryResolve(){if(this.isFulfilled())return;const e=xc(),i=[...this._resolvingPromises,e.promise],n=this._allPromise=Promise.all(i);n.then(()=>{this.isFulfilled()||this._allPromise!==n||this._resolver.resolve()},r=>{this.isFulfilled()||this._allPromise!==n||Ds(r)||this._resolver.reject(r)}),e.resolve()}};const K$=t=>{let e=class extends t{constructor(...i){super(...i),this._promiseProps=new z0e,this.addResolvingPromise(Promise.resolve())}destroy(){var i;(i=this._promiseProps)==null||i.destroy()}isResolved(){return this._promiseProps.isResolved()}isRejected(){return this._promiseProps.isRejected()}isFulfilled(){return this._promiseProps.isFulfilled()}when(i,n){return this._promiseProps.promise.then(()=>this).then(i,n)}catch(i){return this.when(null,i)}addResolvingPromise(i){i&&!this._promiseProps.isFulfilled()&&this._promiseProps.addResolvingPromise("_promiseProps"in i?i.when():i)}};return e=h([P("esri.core.Promise")],e),e};let HE=class extends K$(ye){};HE=h([P("esri.core.Promise")],HE);const V0e="not-loaded",j0e="loading",B0e="failed",l9="loaded",oQ=t=>{let e=class extends t{constructor(...i){super(...i),this._loadController=null,this.loadError=null,this.loadStatus="not-loaded",this._set("loadWarnings",[]),this.addResolvingPromise(new Promise(n=>{const r=this.load.bind(this);this.load=s=>{const o=new Promise((a,l)=>{const c=zz(s,l);this.destroyed&&l(new V("load:instance-destroyed",`Instance of '${this.declaredClass||this.constructor.name}' is already destroyed`,{instance:this})),this.when(a,l).finally(()=>{c&&c.remove()})});if(this.loadStatus===V0e){this._set("loadStatus",j0e);const a=this._loadController=new AbortController;r({signal:a.signal}),Ro(a.signal,()=>{this._promiseProps.abort()})}return n(),o}})),this.when(()=>{this._set("loadStatus",l9),this._loadController=null},n=>{this._set("loadStatus",B0e),this._set("loadError",n),this._loadController=null})}destroy(){this._loadController=is(this._loadController),this._set("loadError",null),this._set("loadWarnings",[])}get loaded(){return this.loadStatus===l9}get loadWarnings(){return this._get("loadWarnings")}load(){return null}cancelLoad(){var i;return this.isFulfilled()||(this._set("loadError",new V("load:cancelled","Cancelled")),(i=this._loadController)==null||i.abort()),this}};return h([p({readOnly:!0})],e.prototype,"loaded",null),h([p({readOnly:!0})],e.prototype,"loadError",void 0),h([p({clonable:!1})],e.prototype,"loadStatus",void 0),h([p({type:[fl],readOnly:!0})],e.prototype,"loadWarnings",null),e=h([P("esri.core.Loadable")],e),e};let lw=class extends oQ(HE){};lw=h([P("esri.core.Loadable")],lw),function(t){function e(i){return!(!i||!i.load)}t.LoadableMixin=oQ,t.isLoadable=e}(lw||(lw={}));const rd=lw;function U0e(t,e,i){return Sn(t.map((n,r)=>e.apply(i,[n,r])))}async function G0e(t,e,i){return(await Sn(t.map((n,r)=>e.apply(i,[n,r])))).map(n=>n.value)}function Hz(t){return{ok:!0,value:t}}function qz(t){return{ok:!1,error:t}}function H0e(t){return t!=null&&t.ok===!0?t.value:null}function q0e(t){return t!=null&&t.ok===!1?t.error:null}async function Q$(t){if(t==null)return{ok:!1,error:new Error("no promise provided")};try{return Hz(await t)}catch(e){return qz(e)}}async function Jot(t){try{return Hz(await t)}catch(e){return $o(e),qz(e)}}function i0(t,e){return new Zd(t,e)}let Zd=class extends ye{get value(){return H0e(this._result)}get error(){return q0e(this._result)}get finished(){return this._result!=null}constructor(e,i){super({}),this._result=null,this._abortHandle=null,this.abort=()=>{this._abortController=is(this._abortController)},this.remove=this.abort,this._abortController=new AbortController;const{signal:n}=this._abortController;this.promise=e(n),this.promise.then(r=>{this._result=Hz(r),this._cleanup()},r=>{this._result=qz(r),this._cleanup()}),this._abortHandle=Ro(i,this.abort)}normalizeCtorArgs(){return{}}destroy(){this.abort()}_cleanup(){this._abortHandle=Ri(this._abortHandle),this._abortController=null}};h([p()],Zd.prototype,"value",null),h([p()],Zd.prototype,"error",null),h([p()],Zd.prototype,"finished",null),h([p()],Zd.prototype,"promise",void 0),h([p()],Zd.prototype,"_result",void 0),Zd=h([P("esri.core.asyncUtils.ReactiveTask")],Zd);async function aQ(t,e){return await t.load(),W0e(t,e)}async function W0e(t,e){const i=[],n=(...s)=>{for(const o of s)o!=null&&(Array.isArray(o)?n(...o):xe.isCollection(o)?o.forEach(a=>n(a)):rd.isLoadable(o)&&i.push(o))};e(n);let r=null;if(await G0e(i,async s=>{const o=await Q$(J0e(s)?s.loadAll():s.load());o.ok!==!1||r||(r=o)}),r)throw r.error;return t}function J0e(t){return"loadAll"in t&&typeof t.loadAll=="function"}const Z0e=/^https:\/\/([a-z\d-]+)(\.maps([^.]*))?\.arcgis\.com/i,Y0e={devext:{customBaseUrl:"mapsdevext.arcgis.com",portalHostname:"devext.arcgis.com"},qaext:{customBaseUrl:"mapsqa.arcgis.com",portalHostname:"qaext.arcgis.com"},www:{customBaseUrl:"maps.arcgis.com",portalHostname:"www.arcgis.com"}};function c9(t){const e=t==null?void 0:t.match(Z0e);if(!e)return null;const[,i,n,r]=e;if(!i)return null;let s=null,o=null,a=null;const{devext:l,qaext:c,www:u}=Y0e;if(n)if(s=i,r)switch(r.toLowerCase()){case"devext":({customBaseUrl:o,portalHostname:a}=l);break;case"qa":({customBaseUrl:o,portalHostname:a}=c);break;default:return null}else({customBaseUrl:o,portalHostname:a}=u);else switch(i.toLowerCase()){case"devext":({customBaseUrl:o,portalHostname:a}=l);break;case"qaext":({customBaseUrl:o,portalHostname:a}=c);break;case"www":({customBaseUrl:o,portalHostname:a}=u);break;default:return null}return{customBaseUrl:o,isPortal:!1,portalHostname:a,urlKey:s}}function X0e(t){return/\/(sharing|usrsvcs)\/(appservices|servers)\//i.test(t)}function K0e(t){const e=atob(t),i=new Uint8Array(e.length);for(let n=0;n<e.length;n++)i[n]=e.charCodeAt(n);return i.buffer}const Q0e=ne.getLogger("esri.core.urlUtils"),Lb=Tt.request,u9="esri/config: esriConfig.request.proxyUrl is not set.",lQ=/^\s*[a-z][a-z0-9-+.]*:(?![0-9])/i,cQ=/^\s*http:/i,eve=/^\s*https:/i,tve=/^\s*file:/i,ive=/:\d+$/,nve=/^https?:\/\/[^/]+\.arcgis.com\/sharing(\/|$)/i,rve=new RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?$"),sve=new RegExp("^((([^\\[:]+):)?([^@]+)@)?(\\[([^\\]]+)\\]|([^\\[:]*))(:([0-9]+))?$");let M_=class{constructor(e=""){this.uri=e,this.scheme=null,this.authority=null,this.path=null,this.query=null,this.fragment=null,this.user=null,this.password=null,this.host=null,this.port=null;let i=this.uri.match(rve);this.scheme=i[2]||(i[1]?"":null),this.authority=i[4]||(i[3]?"":null),this.path=i[5],this.query=i[7]||(i[6]?"":null),this.fragment=i[9]||(i[8]?"":null),this.authority!=null&&(i=this.authority.match(sve),this.user=i[3]||null,this.password=i[4]||null,this.host=i[6]||i[7],this.port=i[9]||null)}toString(){return this.uri}};const VT={},ove=new M_(Tt.applicationUrl);let Is=ove;const ave=lve();let Wz=ave;const Jz=()=>Is,Xot=()=>Wz;function lve(){const t=Is.path,e=t.substring(0,t.lastIndexOf(t.split("/")[t.split("/").length-1]));return`${`${Is.scheme}://${Is.host}${Is.port!=null?`:${Is.port}`:""}`}${e}`}function ir(t){if(!t)return null;const e={path:null,query:null},i=new M_(t),n=t.indexOf("?");return i.query===null?e.path=t:(e.path=t.substring(0,n),e.query=Zz(i.query)),i.fragment&&(e.hash=i.fragment,i.query===null&&(e.path=e.path.substring(0,e.path.length-(i.fragment.length+1)))),e}function Zz(t){const e=t.split("&"),i={};for(const n of e){if(!n)continue;const r=n.indexOf("=");let s,o;r<0?(s=decodeURIComponent(n),o=""):(s=decodeURIComponent(n.slice(0,r)),o=decodeURIComponent(n.slice(r+1)));let a=i[s];typeof a=="string"&&(a=i[s]=[a]),Array.isArray(a)?a.push(o):i[s]=o}return i}function h9(t){return t&&typeof t=="object"&&"toJSON"in t&&typeof t.toJSON=="function"}function X_(t,e){return t?e&&typeof e=="function"?Object.keys(t).map(i=>encodeURIComponent(i)+"="+encodeURIComponent(e(i,t[i]))).join("&"):Object.keys(t).map(i=>{const n=t[i];if(n==null)return"";const r=encodeURIComponent(i)+"=",s=e&&e[i];return s?r+encodeURIComponent(s(n)):Array.isArray(n)?n.map(o=>h9(o)?r+encodeURIComponent(JSON.stringify(o)):r+encodeURIComponent(o)).join("&"):h9(n)?r+encodeURIComponent(JSON.stringify(n)):r+encodeURIComponent(n)}).filter(i=>i).join("&"):""}function cve(t=!1){let e,i=Lb.proxyUrl;if(typeof t=="string"){e=gve(t);const n=eP(t);n&&(i=n.proxyUrl)}else e=!!t;if(!i)throw Q0e.warn(u9),new V("urlutils:proxy-not-set",u9);return e&&pR()&&(i=e6(i)),ir(i)}function Kot(t){const e=eP(t);let i,n;if(e){const r=Yz(e.proxyUrl);i=r.path,n=r.query?Zz(r.query):null}if(i){const r=ir(t);t=i+"?"+r.path;const s=X_({...n,...r.query});s&&(t=`${t}?${s}`)}return t}const p1={path:"",query:""};function Yz(t){const e=t.indexOf("?");return e!==-1?(p1.path=t.slice(0,e),p1.query=t.slice(e+1)):(p1.path=t,p1.query=null),p1}function uQ(t){return t=(t=WE(t=wve(t=Yz(t).path),!0)).toLowerCase()}function uve(t){const e={proxyUrl:t.proxyUrl,urlPrefix:uQ(t.urlPrefix)},i=Lb.proxyRules,n=e.urlPrefix;let r=i.length;for(let s=0;s<i.length;s++){const o=i[s].urlPrefix;if(n.indexOf(o)===0){if(n.length===o.length)return-1;r=s;break}o.indexOf(n)===0&&(r=s+1)}return i.splice(r,0,e),r}function eP(t){const e=Lb.proxyRules,i=uQ(t);for(let n=0;n<e.length;n++)if(i.indexOf(e[n].urlPrefix)===0)return e[n]}function hve(t,e){if(!t||!e)return!1;t=qE(t),e=qE(e);const i=c9(t),n=c9(e);return i!=null&&n!=null?i.portalHostname===n.portalHostname:i==null&&n==null&&K_(t,e,!0)}function hQ(t,e){return t=qE(t),e=qE(e),WE(t)===WE(e)}function qE(t){const e=(t=ll(t)).indexOf("/sharing");return e>0?t.substring(0,e):t.replace(/\/+$/,"")}function dQ(t){const e=n=>n==null||n instanceof RegExp&&n.test(t)||typeof n=="string"&&t.startsWith(n),i=Lb.interceptors;if(i){for(const n of i)if(Array.isArray(n.urls)){if(n.urls.some(e))return n}else if(e(n.urls))return n}return null}function K_(t,e,i=!1){if(!t||!e)return!1;const n=mR(t),r=mR(e);return!(!i&&n.scheme!==r.scheme)&&n.host!=null&&r.host!=null&&n.host.toLowerCase()===r.host.toLowerCase()&&n.port===r.port}function Xz(t){if(typeof t=="string"){if(!ya(t))return!0;t=mR(t)}if(K_(t,Is))return!0;const e=Lb.trustedServers||[];for(let i=0;i<e.length;i++){const n=dve(e[i]);for(let r=0;r<n.length;r++)if(K_(t,n[r]))return!0}return!1}function dve(t){return VT[t]||(Qz(t)||Pu(t)?VT[t]=[new M_(tl(t))]:VT[t]=[new M_(`http://${t}`),new M_(`https://${t}`)]),VT[t]}function tl(t,e=Wz,i){return Pu(t)?i&&i.preserveProtocolRelative?t:Is.scheme==="http"&&Is.authority===gc(t).slice(2)?`http:${t}`:`https:${t}`:Qz(t)?t:tP(t[0]==="/"?bve(e):e,t)}function Kz(t,e=Wz,i){if(t==null||!ya(t))return t;const n=ll(t),r=n.toLowerCase(),s=ll(e).toLowerCase().replace(/\/+$/,""),o=i?ll(i).toLowerCase().replace(/\/+$/,""):null;if(o&&s.indexOf(o)!==0)return t;const a=(d,f,m)=>(m=d.indexOf(f,m))===-1?d.length:m;let l=a(r,"/",r.indexOf("//")+2),c=-1;for(;r.slice(0,l+1)===s.slice(0,l)+"/"&&(c=l+1,l!==r.length);)l=a(r,"/",l+1);if(c===-1||o&&c<o.length)return t;t=n.slice(c);const u=s.slice(c-1).replaceAll(/[^/]+/g,"").length;if(u>0)for(let d=0;d<u;d++)t=`../${t}`;else t=`./${t}`;return t}function ll(t){return t=Tve(t=Sve(t=xve(t=tl(t=t.trim()))))}function tP(...t){const e=t.filter(Ti);if(!e||!e.length)return;const i=[];if(ya(e[0])){const r=e[0],s=r.indexOf("//");s!==-1&&(i.push(r.slice(0,s+1)),vve(e[0])&&(i[0]+="/"),e[0]=r.slice(s+2))}else e[0][0]==="/"&&i.push("");const n=e.reduce((r,s)=>s?r.concat(s.split("/")):r,[]);for(let r=0;r<n.length;r++){const s=n[r];s===".."&&i.length>0&&i[i.length-1]!==".."?i.pop():(!s&&r===n.length-1||s&&(s!=="."||i.length===0))&&i.push(s)}return i.join("/")}function gc(t,e=!1){if(t==null||iP(t)||n0(t))return null;let i=t.indexOf("://");if(i===-1&&Pu(t))i=2;else{if(i===-1)return null;i+=3}const n=t.indexOf("/",i);return n!==-1&&(t=t.slice(0,n)),e&&(t=WE(t,!0)),t}function ya(t){return Pu(t)||Qz(t)}function iP(t){return t!=null&&t.slice(0,5)==="blob:"}function n0(t){return t!=null&&t.slice(0,5)==="data:"}function pve(t){const e=E2(t);return e&&e.isBase64?K0e(e.data):null}function Qot(t){return btoa(String.fromCharCode.apply(null,t)).replaceAll("+","-").replaceAll("/","_").replace(/=+$/,"")}const fve=/^data:(.*?)(;base64)?,(.*)$/;function E2(t){const e=t.match(fve);if(!e)return null;const[,i,n,r]=e;return{mediaType:i,isBase64:!!n,data:r}}function pQ(t){return t.isBase64?`data:${t.mediaType};base64,${t.data}`:`data:${t.mediaType},${t.data}`}function eat(t){const e=pve(t);if(!e)return null;const i=E2(t);return new Blob([e],{type:i.mediaType})}function tat(t,e){mve(t,e)}function mve(t,e){if(!t)return!1;const i=document.createElement("a");if(!("download"in i))return!1;const n=URL.createObjectURL(t);return i.download=e,i.href=n,i.style.display="none",document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(n),!0}function Pu(t){return t!=null&&t[0]==="/"&&t[1]==="/"}function Qz(t){return t!=null&&lQ.test(t)}function gve(t){return t!=null&&eve.test(t)||Is.scheme==="https"&&Pu(t)}function yve(t){return t!=null&&cQ.test(t)||Is.scheme==="http"&&Pu(t)}function vve(t){return t!=null&&tve.test(t)}function e6(t){return Pu(t)?`https:${t}`:t.replace(cQ,"https:")}function _ve(){return Is.scheme==="http"}function pR(){return Is.scheme==="https"}function WE(t,e=!1){return Pu(t)?t.slice(2):(t=t.replace(lQ,""),e&&t.length>1&&t[0]==="/"&&t[1]==="/"&&(t=t.slice(2)),t)}function bve(t){const e=t.indexOf("//"),i=t.indexOf("/",e+2);return i===-1?t:t.slice(0,i)}function t6(t){let e=0;if(ya(t)){const n=t.indexOf("//");n!==-1&&(e=n+2)}const i=t.lastIndexOf("/");return i<e?t:t.slice(0,i+1)}function iat(t,e){if(!t)return"";const i=ir(t).path.replace(/\/+$/,""),n=i.substring(i.lastIndexOf("/")+1);if(!(e!=null&&e.length))return n;const r=new RegExp(`.(${e.join("|")})$`,"ig");return n.replace(r,"")}function wve(t){return t&&t[t.length-1]==="/"?t:`${t}/`}function fQ(t){return t.replace(/\/+$/,"")}function xve(t){if(/^https?:\/\//i.test(t)){const e=Yz(t);t=(t=e.path.replaceAll(/\/{2,}/g,"/")).replace("/","//"),e.query&&(t+=`?${e.query}`)}return t}function Sve(t){return t.replace(/^(https?:\/\/)(arcgis\.com)/i,"$1www.$2")}function Tve(t){const e=Lb.httpsDomains;if(!yve(t))return t;const i=t.indexOf("/",7);let n;if(n=i===-1?t:t.slice(0,i),n=n.toLowerCase().slice(7),ive.test(n)){if(!n.endsWith(":80"))return t;n=n.slice(0,-3),t=t.replace(":80","")}return _ve()&&n===Is.authority&&!nve.test(t)||(pR()&&n===Is.authority||e&&e.some(r=>n===r||n.endsWith(`.${r}`))||pR()&&!eP(t))&&(t=e6(t)),t}function fR(t,e,i){if(!(e&&i&&t&&ya(t)))return t;const n=t.indexOf("//"),r=t.indexOf("/",n+2),s=t.indexOf(":",n+2),o=Math.min(r<0?t.length:r,s<0?t.length:s);return t.slice(n+2,o).toLowerCase()!==e.toLowerCase()?t:`${t.slice(0,n+2)}${i}${t.slice(o)}`}function mR(t){return typeof t=="string"?new M_(tl(t)):(t.scheme||(t.scheme=Is.scheme),t)}function nat(t){return Ive.test(t)}function mQ(t,e){const i=ir(t),n=Object.keys(i.query||{});return n.length>0&&e&&e.warn("removeQueryParameters()",`Url query parameters are not supported, the following parameters have been removed: ${n.join(", ")}.`),i.path}function gQ(t,e,i){const n=ir(t),r=n.query||{};return r[e]=String(i),`${n.path}?${X_(r)}`}function WC(t,e){const i=ir(t),n=i.query||{};for(const s in e)n[s]=e[s];const r=X_(n);return r?`${i.path}?${r}`:i.path}function rat(t){if(t==null)return null;const e=t.match(yQ);return e?e[2]:null}function d9(t){if(t==null)return null;const e=t.match(yQ);return e?{path:e[1],extension:e[2]}:{path:t,extension:null}}async function sat(t){return typeof t=="string"?E2(t)??{data:t}:new Promise((e,i)=>{const n=new FileReader;n.readAsDataURL(t),n.onload=()=>e(E2(n.result)),n.onerror=r=>i(r)})}const yQ=/([^.]*)\.([^\/]*)$/,Ive=/(^data:image\/svg|\.svg$)/i;function ge(t,e,i){let n,r;return e===void 0?(r=t,n=[void 0]):typeof e!="string"?(r=t,n=[void 0],i=e):(r=e,n=Array.isArray(t)?t:[t]),(s,o)=>{const a=s.constructor.prototype;for(const l of n){const c=FK(s,l,r);c.write&&typeof c.write=="object"||(c.write={}),i&&(c.write.target=i),c.write.writer=a[o]}}}let qe=class{constructor(e,i={ignoreUnknown:!1,useNumericKeys:!1}){this._jsonToAPI=e,this._options=i,this.apiValues=[],this.jsonValues=[],this._apiToJSON=this._invertMap(e),this.apiValues=this._getKeysSorted(this._apiToJSON),this.jsonValues=this._getKeysSorted(this._jsonToAPI),this.read=n=>this.fromJSON(n),this.write=(n,r,s)=>{const o=this.toJSON(n);o!==void 0&&dl(s,o,r)},this.write.isJSONMapWriter=!0}toJSON(e){if(e==null)return null;if(this._apiToJSON.hasOwnProperty(e)){const i=this._apiToJSON[e];return this._options.useNumericKeys?+i:i}return this._options.ignoreUnknown?void 0:e}fromJSON(e){return e!=null&&this._jsonToAPI.hasOwnProperty(e)?this._jsonToAPI[e]:this._options.ignoreUnknown?void 0:e}_invertMap(e){const i={};for(const n in e)i[e[n]]=n;return i}_getKeysSorted(e){const i=[];for(const n in e)i.push(n);return i.sort(),i}};function Nn(){return function(t,e){return new qe(t,{ignoreUnknown:!0,...e})}}let i6=class{constructor(e,i,n,r){this.semiMajorAxis=e,this.flattening=i,this.outerAtmosphereRimWidth=n;const s=1-this.flattening;this.semiMinorAxis=this.semiMajorAxis*s,this.halfSemiMajorAxis=this.semiMajorAxis/2,this.halfCircumference=Math.PI*this.semiMajorAxis,this.metersPerDegree=this.halfCircumference/180,this.inverseFlattening=1/(1-this.flattening)-1,this.eccentricitySquared=r||2*this.flattening-this.flattening*this.flattening,this.meanRadiusSemiAxes=(2*this.semiMajorAxis+this.semiMinorAxis)/3}get radius(){return this.semiMajorAxis}};const ci=new i6(6378137,1/298.257223563,3e5,.006694379990137799),Hh=new i6(3396190,1/169.8944472236118,23e4),Lf=new i6(1737400,0,0);var ky;(function(t){t[t.CGCS2000=4490]="CGCS2000",t[t.GCSMARS2000=104971]="GCSMARS2000",t[t.GCSMARS2000_SPHERE=104905]="GCSMARS2000_SPHERE",t[t.GCSMOON2000=104903]="GCSMOON2000"})(ky||(ky={}));let v;const k={values:[1,.3048,.3048006096012192,.3047972654,.9143917962,.201166195164,.9143984146160287,.3047994715386762,20.11676512155263,20.11678249437587,.9143985307444408,.91439523,.3047997101815088,20.1168,20.116756,5e4,15e4],units:["Meter","Foot","Foot_US","Foot_Clarke","Yard_Clarke","Link_Clarke","Yard_Sears","Foot_Sears","Chain_Sears","Chain_Benoit_1895_B","Yard_Indian","Yard_Indian_1937","Foot_Gold_Coast","Chain","Chain_Sears_1922_Truncated","50_Kilometers","150_Kilometers"],2066:5,2136:12,2155:2,2157:0,2158:0,2159:12,2160:12,2204:2,2219:0,2220:0,2254:2,2255:2,2256:1,2265:1,2266:1,2267:2,2268:2,2269:1,2270:1,2271:2,2272:2,2273:1,2294:0,2295:0,2314:3,2899:2,2900:2,2901:1,2909:1,2910:1,2911:2,2912:2,2913:1,2914:1,2992:1,2993:0,2994:1,3080:1,3089:2,3090:0,3091:2,3102:2,3141:0,3142:0,3167:14,3359:2,3360:0,3361:1,3362:0,3363:2,3364:0,3365:2,3366:3,3404:2,3405:0,3406:0,3407:3,3439:0,3440:0,3479:1,3480:0,3481:1,3482:0,3483:1,3484:0,3485:2,3486:0,3487:2,3488:0,3489:0,3490:2,3491:0,3492:2,3493:0,3494:2,3495:0,3496:2,3497:0,3498:2,3499:0,3500:2,3501:0,3502:2,3503:0,3504:2,3505:0,3506:2,3507:0,3508:2,3509:0,3510:2,3511:0,3512:2,3513:0,3514:0,3515:2,3516:0,3517:2,3518:0,3519:2,3520:0,3521:2,3522:0,3523:2,3524:0,3525:2,3526:0,3527:2,3528:0,3529:2,3530:0,3531:2,3532:0,3533:2,3534:0,3535:2,3536:0,3537:2,3538:0,3539:2,3540:0,3541:2,3542:0,3543:2,3544:0,3545:2,3546:0,3547:2,3548:0,3549:2,3550:0,3551:2,3552:0,3553:2,3582:2,3583:0,3584:2,3585:0,3586:2,3587:0,3588:1,3589:0,3590:1,3591:0,3592:0,3593:1,3598:2,3599:0,3600:2,3605:1,3606:0,3607:0,3608:2,3609:0,3610:2,3611:0,3612:2,3613:0,3614:2,3615:0,3616:2,3617:0,3618:2,3619:0,3620:2,3621:0,3622:2,3623:0,3624:2,3625:0,3626:2,3627:0,3628:2,3629:0,3630:2,3631:0,3632:2,3633:0,3634:1,3635:0,3636:1,3640:2,3641:0,3642:2,3643:0,3644:1,3645:0,3646:1,3647:0,3648:1,3649:0,3650:2,3651:0,3652:2,3653:0,3654:2,3655:0,3656:1,3657:0,3658:2,3659:0,3660:2,3661:0,3662:2,3663:0,3664:2,3668:2,3669:0,3670:2,3671:0,3672:2,3673:0,3674:2,3675:0,3676:1,3677:2,3678:0,3679:1,3680:2,3681:0,3682:1,3683:2,3684:0,3685:0,3686:2,3687:0,3688:2,3689:0,3690:2,3691:0,3692:2,3696:2,3697:0,3698:2,3699:0,3700:2,3793:0,3794:0,3812:0,3854:0,3857:0,3920:0,3978:0,3979:0,3991:2,3992:2,4026:0,4037:0,4038:0,4071:0,4082:0,4083:0,4087:0,4088:0,4217:2,4414:0,4415:0,4417:0,4434:0,4437:0,4438:2,4439:2,4462:0,4467:0,4471:0,4474:0,4559:0,4647:0,4822:0,4826:0,4839:0,5018:0,5041:0,5042:0,5048:0,5167:0,5168:0,5221:0,5223:0,5234:0,5235:0,5243:0,5247:0,5266:0,5316:0,5320:0,5321:0,5325:0,5337:0,5361:0,5362:0,5367:0,5382:0,5383:0,5396:0,5456:0,5457:0,5469:0,5472:4,5490:0,5513:0,5514:0,5523:0,5559:0,5588:1,5589:3,5596:0,5627:0,5629:0,5641:0,5643:0,5644:0,5646:2,5654:2,5655:2,5659:0,5700:0,5825:0,5836:0,5837:0,5839:0,5842:0,5844:0,5858:0,5879:0,5880:0,5887:0,5890:0,6128:1,6129:1,6141:1,6204:0,6210:0,6211:0,6307:0,6312:0,6316:0,6362:0,6391:1,6405:1,6406:0,6407:1,6408:0,6409:1,6410:0,6411:2,6412:0,6413:2,6414:0,6415:0,6416:2,6417:0,6418:2,6419:0,6420:2,6421:0,6422:2,6423:0,6424:2,6425:0,6426:2,6427:0,6428:2,6429:0,6430:2,6431:0,6432:2,6433:0,6434:2,6435:0,6436:2,6437:0,6438:2,6439:0,6440:0,6441:2,6442:0,6443:2,6444:0,6445:2,6446:0,6447:2,6448:0,6449:2,6450:0,6451:2,6452:0,6453:2,6454:0,6455:2,6456:0,6457:2,6458:0,6459:2,6460:0,6461:2,6462:0,6463:2,6464:0,6465:2,6466:0,6467:2,6468:0,6469:2,6470:0,6471:2,6472:0,6473:2,6474:0,6475:2,6476:0,6477:2,6478:0,6479:2,6484:2,6485:0,6486:2,6487:0,6488:2,6489:0,6490:2,6491:0,6492:2,6493:0,6494:1,6495:0,6496:1,6497:0,6498:0,6499:1,6500:0,6501:2,6502:0,6503:2,6504:0,6505:2,6506:0,6507:2,6508:0,6509:0,6510:2,6515:1,6516:0,6518:0,6519:2,6520:0,6521:2,6522:0,6523:2,6524:0,6525:2,6526:0,6527:2,6528:0,6529:2,6530:0,6531:2,6532:0,6533:2,6534:0,6535:2,6536:0,6537:2,6538:0,6539:2,6540:0,6541:2,6542:0,6543:2,6544:0,6545:1,6546:0,6547:1,6548:0,6549:2,6550:0,6551:2,6552:0,6553:2,6554:0,6555:2,6556:0,6557:1,6558:0,6559:1,6560:0,6561:1,6562:0,6563:2,6564:0,6565:2,6566:0,6567:0,6568:2,6569:0,6570:1,6571:0,6572:2,6573:0,6574:2,6575:0,6576:2,6577:0,6578:2,6582:2,6583:0,6584:2,6585:0,6586:2,6587:0,6588:2,6589:0,6590:2,6591:0,6592:0,6593:2,6594:0,6595:2,6596:0,6597:2,6598:0,6599:2,6600:0,6601:2,6602:0,6603:2,6605:2,6606:0,6607:2,6608:0,6609:2,6610:0,6611:0,6612:2,6613:0,6614:2,6615:0,6616:2,6617:0,6618:2,6633:2,6646:0,6703:0,6784:0,6785:1,6786:0,6787:1,6788:0,6789:1,6790:0,6791:1,6792:0,6793:1,6794:0,6795:1,6796:0,6797:1,6798:0,6799:1,6800:0,6801:1,6802:0,6803:1,6804:0,6805:1,6806:0,6807:1,6808:0,6809:1,6810:0,6811:1,6812:0,6813:1,6814:0,6815:1,6816:0,6817:1,6818:0,6819:1,6820:0,6821:1,6822:0,6823:1,6824:0,6825:1,6826:0,6827:1,6828:0,6829:1,6830:0,6831:1,6832:0,6833:1,6834:0,6835:1,6836:0,6837:1,6838:0,6839:1,6840:0,6841:1,6842:0,6843:1,6844:0,6845:1,6846:0,6847:1,6848:0,6849:1,6850:0,6851:1,6852:0,6853:1,6854:0,6855:1,6856:0,6857:1,6858:0,6859:1,6860:0,6861:1,6862:0,6863:1,6867:0,6868:1,6870:0,6875:0,6876:0,6879:0,6880:2,6884:0,6885:1,6886:0,6887:1,6915:0,6922:0,6923:2,6924:0,6925:2,6962:0,6984:0,6991:0,7128:2,7131:0,7132:2,7142:0,7257:0,7258:2,7259:0,7260:2,7261:0,7262:2,7263:0,7264:2,7265:0,7266:2,7267:0,7268:2,7269:0,7270:2,7271:0,7272:2,7273:0,7274:2,7275:0,7276:2,7277:0,7278:2,7279:0,7280:2,7281:0,7282:2,7283:0,7284:2,7285:0,7286:2,7287:0,7288:2,7289:0,7290:2,7291:0,7292:2,7293:0,7294:2,7295:0,7296:2,7297:0,7298:2,7299:0,7300:2,7301:0,7302:2,7303:0,7304:2,7305:0,7306:2,7307:0,7308:2,7309:0,7310:2,7311:0,7312:2,7313:0,7314:2,7315:0,7316:2,7317:0,7318:2,7319:0,7320:2,7321:0,7322:2,7323:0,7324:2,7325:0,7326:2,7327:0,7328:2,7329:0,7330:2,7331:0,7332:2,7333:0,7334:2,7335:0,7336:2,7337:0,7338:2,7339:0,7340:2,7341:0,7342:2,7343:0,7344:2,7345:0,7346:2,7347:0,7348:2,7349:0,7350:2,7351:0,7352:2,7353:0,7354:2,7355:0,7356:2,7357:0,7358:2,7359:0,7360:2,7361:0,7362:2,7363:0,7364:2,7365:0,7366:2,7367:0,7368:2,7369:0,7370:2,7877:0,7878:0,7882:0,7883:0,7887:0,7899:0,7991:0,7992:0,8035:2,8036:2,8058:0,8059:0,8082:0,8083:0,8088:0,8090:0,8091:2,8092:0,8093:2,8095:0,8096:2,8097:0,8098:2,8099:0,8100:2,8101:0,8102:2,8103:0,8104:2,8105:0,8106:2,8107:0,8108:2,8109:0,8110:2,8111:0,8112:2,8113:0,8114:2,8115:0,8116:2,8117:0,8118:2,8119:0,8120:2,8121:0,8122:2,8123:0,8124:2,8125:0,8126:2,8127:0,8128:2,8129:0,8130:2,8131:0,8132:2,8133:0,8134:2,8135:0,8136:2,8137:0,8138:2,8139:0,8140:2,8141:0,8142:2,8143:0,8144:2,8145:0,8146:2,8147:0,8148:2,8149:0,8150:2,8151:0,8152:2,8153:0,8154:2,8155:0,8156:2,8157:0,8158:2,8159:0,8160:2,8161:0,8162:2,8163:0,8164:2,8165:0,8166:2,8167:0,8168:2,8169:0,8170:2,8171:0,8172:2,8173:0,8177:2,8179:0,8180:2,8181:0,8182:2,8184:0,8185:2,8187:0,8189:2,8191:0,8193:2,8196:0,8197:2,8198:0,8200:2,8201:0,8202:2,8203:0,8204:2,8205:0,8206:2,8207:0,8208:2,8209:0,8210:2,8212:0,8213:2,8214:0,8216:2,8218:0,8220:2,8222:0,8224:2,8225:0,8226:2,8311:0,8312:1,8313:0,8314:1,8315:0,8316:1,8317:0,8318:1,8319:0,8320:1,8321:0,8322:1,8323:0,8324:1,8325:0,8326:1,8327:0,8328:1,8329:0,8330:1,8331:0,8332:1,8333:0,8334:1,8335:0,8336:1,8337:0,8338:1,8339:0,8340:1,8341:0,8342:1,8343:0,8344:1,8345:0,8346:1,8347:0,8348:1,8352:0,8353:0,8379:0,8380:2,8381:0,8382:2,8383:0,8384:2,8385:0,8387:2,8391:0,8395:0,8433:0,8441:0,8455:0,8456:0,8531:2,8682:0,8686:0,8687:0,8692:0,8693:0,8826:0,8903:0,8950:0,8951:0,9039:0,9040:0,9141:0,9149:0,9150:0,9191:0,9221:0,9222:0,9249:0,9250:0,9252:0,9254:0,9265:0,9284:0,9285:0,9300:0,9354:0,9367:0,9373:0,9377:0,9387:0,9391:0,9456:0,9473:0,9498:0,9674:0,9678:0,9680:0,9709:0,9712:0,9713:0,9716:0,9741:0,9748:2,9749:2,9761:0,9766:0,9793:0,9794:0,9869:0,9874:0,9875:0,9880:0,9943:0,9945:0,9947:0,9967:0,9972:0,9977:0,20042:0,20050:1,20499:0,20538:0,20539:0,20790:0,20791:0,21291:0,21292:0,21500:0,21817:0,21818:0,22032:0,22033:0,22091:0,22092:0,22239:0,22240:0,22332:0,22337:0,22338:0,22391:0,22392:0,22639:0,22700:0,22739:0,22770:0,22780:0,22832:0,23090:0,23095:0,23239:0,23240:0,23433:0,23700:0,24047:0,24048:0,24100:3,24200:0,24305:0,24306:0,24382:10,24383:0,24500:0,24547:0,24548:0,24571:9,24600:0,25e3:0,25231:0,25884:0,25932:0,26237:0,26331:0,26332:0,26432:0,26591:0,26592:0,26632:0,26692:0,27120:0,27200:0,27291:6,27292:6,27429:0,27492:0,27493:0,27500:0,27700:0,28232:0,28600:0,28991:0,28992:0,29100:0,29101:0,29220:0,29221:0,29333:0,29635:0,29636:0,29701:0,29738:0,29739:0,29849:0,29850:0,29871:8,29872:7,29873:0,29874:0,30200:5,30339:0,30340:0,30591:0,30592:0,30791:0,30792:0,30800:0,31028:0,31121:0,31154:0,31170:0,31171:0,31370:0,31528:0,31529:0,31600:0,31700:0,31838:0,31839:0,31900:0,31901:0,32061:0,32062:0,32098:0,32099:2,32100:0,32104:0,32161:0,32766:0,53048:0,53049:0,54090:0,54091:0,65061:2,65062:2,65161:0,65163:0,102041:2,102064:11,102068:15,102069:16,102118:2,102119:1,102120:2,102121:2,102217:2,102218:0,102219:2,102220:2,102378:1,102379:1,102380:0,102381:1,102589:2,102599:2,102600:2,102604:2,102647:0,102704:2,102705:2,102706:0,102731:0,102732:0,102759:1,102760:1,102761:2,102762:0,102763:2,102764:0,102765:0,102766:2,102970:1,102974:2,102993:0,102994:0,102995:2,102996:2,103015:0,103016:2,103017:0,103018:2,103025:0,103026:0,103027:2,103028:2,103035:0,103036:0,103037:2,103038:2,103039:0,103040:0,103041:2,103042:2,103043:0,103044:0,103045:2,103046:2,103047:0,103048:0,103049:2,103050:2,103051:0,103052:2,103053:0,103054:2,103055:0,103056:2,103057:0,103058:0,103059:2,103060:2,103061:0,103062:0,103063:2,103064:2,103069:2,103070:0,103071:0,103072:2,103073:2,103086:0,103087:0,103088:2,103089:2,103094:1,103095:0,103096:2,103103:0,103104:2,103105:0,103106:2,103121:0,103122:2,103123:0,103124:0,103125:1,103126:1,103127:0,103128:0,103129:2,103130:2,103131:0,103132:0,103133:2,103134:2,103135:0,103136:0,103137:1,103138:1,103139:0,103140:2,103141:0,103142:2,103143:0,103144:2,103145:0,103146:1,103147:0,103148:0,103149:2,103150:2,103151:0,103152:2,103172:0,103173:2,103174:0,103175:0,103176:2,103177:2,103178:0,103179:0,103180:2,103181:2,103182:0,103183:0,103184:2,103185:2,103228:0,103229:0,103230:2,103231:2,103250:0,103251:2,103252:0,103253:2,103260:0,103261:0,103262:2,103263:2,103270:0,103271:0,103272:2,103273:2,103274:0,103275:0,103276:2,103277:2,103278:0,103279:0,103280:2,103281:2,103282:0,103283:0,103284:2,103285:2,103286:0,103287:2,103288:0,103289:2,103290:0,103291:2,103292:0,103293:0,103294:2,103295:2,103296:0,103297:0,103298:2,103299:2,103376:2,103377:0,103378:0,103379:2,103380:2,103393:0,103394:0,103395:2,103396:2,103472:0,103473:1,103474:0,103475:2,103482:0,103483:2,103484:0,103485:2,103500:0,103501:2,103502:0,103503:0,103504:1,103505:1,103506:0,103507:0,103508:2,103509:2,103510:0,103511:0,103512:2,103513:2,103514:0,103515:2,103516:0,103517:2,103518:0,103519:2,103520:0,103521:1,103522:0,103523:0,103524:2,103525:2,103526:0,103527:2,103561:2,103562:2,103563:0,103564:0,103565:2,103566:2,103567:0,103568:0,103569:2,103570:2,103584:0,103585:2,103586:0,103587:2,103588:1,103589:0,103590:2,103591:1,103592:0,103593:2,103594:1,103695:2};for(v=2e3;v<=2045;v++)k[v]=0;for(v=2056;v<=2065;v++)k[v]=0;for(v=2067;v<=2135;v++)k[v]=0;for(v=2137;v<=2154;v++)k[v]=0;for(v=2161;v<=2170;v++)k[v]=0;for(v=2172;v<=2193;v++)k[v]=0;for(v=2195;v<=2198;v++)k[v]=0;for(v=2200;v<=2203;v++)k[v]=0;for(v=2205;v<=2217;v++)k[v]=0;for(v=2222;v<=2224;v++)k[v]=1;for(v=2225;v<=2250;v++)k[v]=2;for(v=2251;v<=2253;v++)k[v]=1;for(v=2257;v<=2264;v++)k[v]=2;for(v=2274;v<=2279;v++)k[v]=2;for(v=2280;v<=2282;v++)k[v]=1;for(v=2283;v<=2289;v++)k[v]=2;for(v=2290;v<=2292;v++)k[v]=0;for(v=2308;v<=2313;v++)k[v]=0;for(v=2315;v<=2491;v++)k[v]=0;for(v=2494;v<=2866;v++)k[v]=0;for(v=2867;v<=2869;v++)k[v]=1;for(v=2870;v<=2888;v++)k[v]=2;for(v=2891;v<=2895;v++)k[v]=2;for(v=2896;v<=2898;v++)k[v]=1;for(v=2902;v<=2908;v++)k[v]=2;for(v=2915;v<=2920;v++)k[v]=2;for(v=2921;v<=2923;v++)k[v]=1;for(v=2924;v<=2930;v++)k[v]=2;for(v=2931;v<=2962;v++)k[v]=0;for(v=2964;v<=2968;v++)k[v]=2;for(v=2969;v<=2973;v++)k[v]=0;for(v=2975;v<=2991;v++)k[v]=0;for(v=2995;v<=3051;v++)k[v]=0;for(v=3054;v<=3079;v++)k[v]=0;for(v=3081;v<=3088;v++)k[v]=0;for(v=3092;v<=3101;v++)k[v]=0;for(v=3106;v<=3138;v++)k[v]=0;for(v=3146;v<=3151;v++)k[v]=0;for(v=3153;v<=3166;v++)k[v]=0;for(v=3168;v<=3172;v++)k[v]=0;for(v=3174;v<=3203;v++)k[v]=0;for(v=3294;v<=3358;v++)k[v]=0;for(v=3367;v<=3403;v++)k[v]=0;for(v=3408;v<=3416;v++)k[v]=0;for(v=3417;v<=3438;v++)k[v]=2;for(v=3441;v<=3446;v++)k[v]=2;for(v=3447;v<=3450;v++)k[v]=0;for(v=3451;v<=3459;v++)k[v]=2;for(v=3460;v<=3478;v++)k[v]=0;for(v=3554;v<=3559;v++)k[v]=0;for(v=3560;v<=3570;v++)k[v]=2;for(v=3571;v<=3581;v++)k[v]=0;for(v=3594;v<=3597;v++)k[v]=0;for(v=3601;v<=3604;v++)k[v]=0;for(v=3637;v<=3639;v++)k[v]=0;for(v=3665;v<=3667;v++)k[v]=0;for(v=3693;v<=3695;v++)k[v]=0;for(v=3701;v<=3727;v++)k[v]=0;for(v=3728;v<=3739;v++)k[v]=2;for(v=3740;v<=3751;v++)k[v]=0;for(v=3753;v<=3760;v++)k[v]=2;for(v=3761;v<=3773;v++)k[v]=0;for(v=3775;v<=3777;v++)k[v]=0;for(v=3779;v<=3781;v++)k[v]=0;for(v=3783;v<=3785;v++)k[v]=0;for(v=3788;v<=3791;v++)k[v]=0;for(v=3797;v<=3802;v++)k[v]=0;for(v=3814;v<=3816;v++)k[v]=0;for(v=3825;v<=3829;v++)k[v]=0;for(v=3832;v<=3841;v++)k[v]=0;for(v=3844;v<=3852;v++)k[v]=0;for(v=3873;v<=3885;v++)k[v]=0;for(v=3890;v<=3893;v++)k[v]=0;for(v=3907;v<=3912;v++)k[v]=0;for(v=3942;v<=3950;v++)k[v]=0;for(v=3968;v<=3970;v++)k[v]=0;for(v=3973;v<=3976;v++)k[v]=0;for(v=3986;v<=3989;v++)k[v]=0;for(v=3994;v<=3997;v++)k[v]=0;for(v=4048;v<=4051;v++)k[v]=0;for(v=4056;v<=4063;v++)k[v]=0;for(v=4093;v<=4096;v++)k[v]=0;for(v=4390;v<=4398;v++)k[v]=0;for(v=4399;v<=4413;v++)k[v]=2;for(v=4418;v<=4433;v++)k[v]=2;for(v=4455;v<=4457;v++)k[v]=2;for(v=4484;v<=4489;v++)k[v]=0;for(v=4491;v<=4554;v++)k[v]=0;for(v=4568;v<=4589;v++)k[v]=0;for(v=4652;v<=4656;v++)k[v]=0;for(v=4766;v<=4800;v++)k[v]=0;for(v=5014;v<=5016;v++)k[v]=0;for(v=5069;v<=5072;v++)k[v]=0;for(v=5105;v<=5130;v++)k[v]=0;for(v=5173;v<=5188;v++)k[v]=0;for(v=5253;v<=5259;v++)k[v]=0;for(v=5269;v<=5275;v++)k[v]=0;for(v=5292;v<=5311;v++)k[v]=0;for(v=5329;v<=5331;v++)k[v]=0;for(v=5343;v<=5349;v++)k[v]=0;for(v=5355;v<=5357;v++)k[v]=0;for(v=5387;v<=5389;v++)k[v]=0;for(v=5459;v<=5463;v++)k[v]=0;for(v=5479;v<=5482;v++)k[v]=0;for(v=5518;v<=5520;v++)k[v]=0;for(v=5530;v<=5539;v++)k[v]=0;for(v=5550;v<=5552;v++)k[v]=0;for(v=5562;v<=5583;v++)k[v]=0;for(v=5623;v<=5625;v++)k[v]=2;for(v=5631;v<=5639;v++)k[v]=0;for(v=5649;v<=5653;v++)k[v]=0;for(v=5663;v<=5680;v++)k[v]=0;for(v=5682;v<=5685;v++)k[v]=0;for(v=5875;v<=5877;v++)k[v]=0;for(v=5896;v<=5899;v++)k[v]=0;for(v=5921;v<=5940;v++)k[v]=0;for(v=6050;v<=6125;v++)k[v]=0;for(v=6244;v<=6275;v++)k[v]=0;for(v=6328;v<=6348;v++)k[v]=0;for(v=6350;v<=6356;v++)k[v]=0;for(v=6366;v<=6372;v++)k[v]=0;for(v=6381;v<=6387;v++)k[v]=0;for(v=6393;v<=6404;v++)k[v]=0;for(v=6480;v<=6483;v++)k[v]=0;for(v=6511;v<=6514;v++)k[v]=0;for(v=6579;v<=6581;v++)k[v]=0;for(v=6619;v<=6624;v++)k[v]=0;for(v=6625;v<=6627;v++)k[v]=2;for(v=6628;v<=6632;v++)k[v]=0;for(v=6634;v<=6637;v++)k[v]=0;for(v=6669;v<=6692;v++)k[v]=0;for(v=6707;v<=6709;v++)k[v]=0;for(v=6720;v<=6723;v++)k[v]=0;for(v=6732;v<=6738;v++)k[v]=0;for(v=6931;v<=6933;v++)k[v]=0;for(v=6956;v<=6959;v++)k[v]=0;for(v=7005;v<=7007;v++)k[v]=0;for(v=7057;v<=7070;v++)k[v]=2;for(v=7074;v<=7082;v++)k[v]=0;for(v=7109;v<=7118;v++)k[v]=0;for(v=7119;v<=7127;v++)k[v]=1;for(v=7374;v<=7376;v++)k[v]=0;for(v=7528;v<=7586;v++)k[v]=0;for(v=7587;v<=7645;v++)k[v]=2;for(v=7692;v<=7696;v++)k[v]=0;for(v=7755;v<=7787;v++)k[v]=0;for(v=7791;v<=7795;v++)k[v]=0;for(v=7799;v<=7801;v++)k[v]=0;for(v=7803;v<=7805;v++)k[v]=0;for(v=7825;v<=7831;v++)k[v]=0;for(v=7845;v<=7859;v++)k[v]=0;for(v=8013;v<=8032;v++)k[v]=0;for(v=8065;v<=8068;v++)k[v]=1;for(v=8518;v<=8529;v++)k[v]=2;for(v=8533;v<=8536;v++)k[v]=2;for(v=8538;v<=8540;v++)k[v]=2;for(v=8677;v<=8679;v++)k[v]=0;for(v=8836;v<=8840;v++)k[v]=0;for(v=8857;v<=8859;v++)k[v]=0;for(v=8908;v<=8910;v++)k[v]=0;for(v=9154;v<=9159;v++)k[v]=0;for(v=9205;v<=9218;v++)k[v]=0;for(v=9271;v<=9273;v++)k[v]=0;for(v=9295;v<=9297;v++)k[v]=0;for(v=9356;v<=9360;v++)k[v]=0;for(v=9404;v<=9407;v++)k[v]=0;for(v=9476;v<=9482;v++)k[v]=0;for(v=9487;v<=9494;v++)k[v]=0;for(v=9697;v<=9699;v++)k[v]=0;for(v=9821;v<=9865;v++)k[v]=0;for(v=20002;v<=20032;v++)k[v]=0;for(v=20047;v<=20049;v++)k[v]=0;for(v=20062;v<=20092;v++)k[v]=0;for(v=20135;v<=20138;v++)k[v]=0;for(v=20248;v<=20258;v++)k[v]=0;for(v=20348;v<=20358;v++)k[v]=0;for(v=20436;v<=20440;v++)k[v]=0;for(v=20822;v<=20824;v++)k[v]=0;for(v=20904;v<=20932;v++)k[v]=0;for(v=20934;v<=20936;v++)k[v]=0;for(v=21004;v<=21032;v++)k[v]=0;for(v=21035;v<=21037;v++)k[v]=0;for(v=21095;v<=21097;v++)k[v]=0;for(v=21148;v<=21150;v++)k[v]=0;for(v=21207;v<=21264;v++)k[v]=0;for(v=21307;v<=21364;v++)k[v]=0;for(v=21413;v<=21423;v++)k[v]=0;for(v=21453;v<=21463;v++)k[v]=0;for(v=21473;v<=21483;v++)k[v]=0;for(v=21780;v<=21782;v++)k[v]=0;for(v=21891;v<=21894;v++)k[v]=0;for(v=21896;v<=21899;v++)k[v]=0;for(v=22171;v<=22177;v++)k[v]=0;for(v=22181;v<=22187;v++)k[v]=0;for(v=22191;v<=22197;v++)k[v]=0;for(v=22207;v<=22222;v++)k[v]=0;for(v=22234;v<=22236;v++)k[v]=0;for(v=22243;v<=22250;v++)k[v]=0;for(v=22262;v<=22265;v++)k[v]=0;for(v=22307;v<=22322;v++)k[v]=0;for(v=22348;v<=22357;v++)k[v]=0;for(v=22407;v<=22422;v++)k[v]=0;for(v=22462;v<=22465;v++)k[v]=0;for(v=22521;v<=22525;v++)k[v]=0;for(v=22607;v<=22622;v++)k[v]=0;for(v=22641;v<=22646;v++)k[v]=0;for(v=22648;v<=22657;v++)k[v]=0;for(v=22707;v<=22722;v++)k[v]=0;for(v=22762;v<=22765;v++)k[v]=0;for(v=22991;v<=22994;v++)k[v]=0;for(v=23028;v<=23038;v++)k[v]=0;for(v=23830;v<=23853;v++)k[v]=0;for(v=23866;v<=23872;v++)k[v]=0;for(v=23877;v<=23884;v++)k[v]=0;for(v=23886;v<=23894;v++)k[v]=0;for(v=23946;v<=23948;v++)k[v]=0;for(v=24311;v<=24313;v++)k[v]=0;for(v=24342;v<=24347;v++)k[v]=0;for(v=24370;v<=24374;v++)k[v]=10;for(v=24375;v<=24381;v++)k[v]=0;for(v=24718;v<=24721;v++)k[v]=0;for(v=24817;v<=24821;v++)k[v]=0;for(v=24877;v<=24882;v++)k[v]=0;for(v=24891;v<=24893;v++)k[v]=0;for(v=25391;v<=25395;v++)k[v]=0;for(v=25828;v<=25838;v++)k[v]=0;for(v=26191;v<=26195;v++)k[v]=0;for(v=26391;v<=26393;v++)k[v]=0;for(v=26701;v<=26722;v++)k[v]=0;for(v=26729;v<=26799;v++)k[v]=2;for(v=26801;v<=26803;v++)k[v]=2;for(v=26811;v<=26813;v++)k[v]=2;for(v=26847;v<=26870;v++)k[v]=2;for(v=26891;v<=26899;v++)k[v]=0;for(v=26901;v<=26923;v++)k[v]=0;for(v=26929;v<=26946;v++)k[v]=0;for(v=26948;v<=26998;v++)k[v]=0;for(v=27037;v<=27040;v++)k[v]=0;for(v=27205;v<=27232;v++)k[v]=0;for(v=27258;v<=27260;v++)k[v]=0;for(v=27391;v<=27398;v++)k[v]=0;for(v=27561;v<=27564;v++)k[v]=0;for(v=27571;v<=27574;v++)k[v]=0;for(v=27581;v<=27584;v++)k[v]=0;for(v=27591;v<=27594;v++)k[v]=0;for(v=28191;v<=28193;v++)k[v]=0;for(v=28348;v<=28358;v++)k[v]=0;for(v=28402;v<=28432;v++)k[v]=0;for(v=28462;v<=28492;v++)k[v]=0;for(v=29118;v<=29122;v++)k[v]=0;for(v=29168;v<=29172;v++)k[v]=0;for(v=29177;v<=29185;v++)k[v]=0;for(v=29187;v<=29195;v++)k[v]=0;for(v=29900;v<=29903;v++)k[v]=0;for(v=30161;v<=30179;v++)k[v]=0;for(v=30491;v<=30494;v++)k[v]=0;for(v=30729;v<=30732;v++)k[v]=0;for(v=31251;v<=31259;v++)k[v]=0;for(v=31265;v<=31268;v++)k[v]=0;for(v=31275;v<=31279;v++)k[v]=0;for(v=31281;v<=31297;v++)k[v]=0;for(v=31461;v<=31469;v++)k[v]=0;for(v=31491;v<=31495;v++)k[v]=0;for(v=31917;v<=31922;v++)k[v]=0;for(v=31965;v<=32e3;v++)k[v]=0;for(v=32001;v<=32003;v++)k[v]=2;for(v=32005;v<=32031;v++)k[v]=2;for(v=32033;v<=32060;v++)k[v]=2;for(v=32064;v<=32067;v++)k[v]=2;for(v=32074;v<=32077;v++)k[v]=2;for(v=32081;v<=32086;v++)k[v]=0;for(v=32107;v<=32130;v++)k[v]=0;for(v=32133;v<=32159;v++)k[v]=0;for(v=32164;v<=32167;v++)k[v]=2;for(v=32180;v<=32199;v++)k[v]=0;for(v=32201;v<=32260;v++)k[v]=0;for(v=32301;v<=32360;v++)k[v]=0;for(v=32601;v<=32662;v++)k[v]=0;for(v=32664;v<=32667;v++)k[v]=2;for(v=32701;v<=32761;v++)k[v]=0;for(v=53001;v<=53004;v++)k[v]=0;for(v=53008;v<=53019;v++)k[v]=0;for(v=53021;v<=53032;v++)k[v]=0;for(v=53034;v<=53037;v++)k[v]=0;for(v=53042;v<=53046;v++)k[v]=0;for(v=53074;v<=53080;v++)k[v]=0;for(v=54001;v<=54004;v++)k[v]=0;for(v=54008;v<=54019;v++)k[v]=0;for(v=54021;v<=54032;v++)k[v]=0;for(v=54034;v<=54037;v++)k[v]=0;for(v=54042;v<=54046;v++)k[v]=0;for(v=54048;v<=54053;v++)k[v]=0;for(v=54074;v<=54080;v++)k[v]=0;for(v=54098;v<=54101;v++)k[v]=0;for(v=102001;v<=102040;v++)k[v]=0;for(v=102042;v<=102063;v++)k[v]=0;for(v=102065;v<=102067;v++)k[v]=0;for(v=102070;v<=102117;v++)k[v]=0;for(v=102122;v<=102216;v++)k[v]=0;for(v=102221;v<=102377;v++)k[v]=0;for(v=102382;v<=102388;v++)k[v]=0;for(v=102389;v<=102398;v++)k[v]=2;for(v=102399;v<=102444;v++)k[v]=0;for(v=102445;v<=102447;v++)k[v]=2;for(v=102448;v<=102458;v++)k[v]=0;for(v=102459;v<=102468;v++)k[v]=2;for(v=102469;v<=102499;v++)k[v]=0;for(v=102500;v<=102519;v++)k[v]=1;for(v=102520;v<=102524;v++)k[v]=0;for(v=102525;v<=102529;v++)k[v]=2;for(v=102530;v<=102588;v++)k[v]=0;for(v=102590;v<=102598;v++)k[v]=0;for(v=102601;v<=102603;v++)k[v]=0;for(v=102605;v<=102628;v++)k[v]=0;for(v=102629;v<=102646;v++)k[v]=2;for(v=102648;v<=102700;v++)k[v]=2;for(v=102701;v<=102703;v++)k[v]=0;for(v=102707;v<=102730;v++)k[v]=2;for(v=102733;v<=102758;v++)k[v]=2;for(v=102767;v<=102900;v++)k[v]=0;for(v=102901;v<=102933;v++)k[v]=2;for(v=102934;v<=102950;v++)k[v]=13;for(v=102951;v<=102955;v++)k[v]=0;for(v=102961;v<=102963;v++)k[v]=0;for(v=102965;v<=102969;v++)k[v]=0;for(v=102971;v<=102973;v++)k[v]=0;for(v=102975;v<=102989;v++)k[v]=0;for(v=102990;v<=102992;v++)k[v]=1;for(v=102997;v<=103002;v++)k[v]=0;for(v=103003;v<=103008;v++)k[v]=2;for(v=103009;v<=103011;v++)k[v]=0;for(v=103012;v<=103014;v++)k[v]=2;for(v=103019;v<=103021;v++)k[v]=0;for(v=103022;v<=103024;v++)k[v]=2;for(v=103029;v<=103031;v++)k[v]=0;for(v=103032;v<=103034;v++)k[v]=2;for(v=103065;v<=103068;v++)k[v]=0;for(v=103074;v<=103076;v++)k[v]=0;for(v=103077;v<=103079;v++)k[v]=1;for(v=103080;v<=103082;v++)k[v]=0;for(v=103083;v<=103085;v++)k[v]=2;for(v=103090;v<=103093;v++)k[v]=0;for(v=103097;v<=103099;v++)k[v]=0;for(v=103100;v<=103102;v++)k[v]=2;for(v=103107;v<=103109;v++)k[v]=0;for(v=103110;v<=103112;v++)k[v]=2;for(v=103113;v<=103116;v++)k[v]=0;for(v=103117;v<=103120;v++)k[v]=2;for(v=103153;v<=103157;v++)k[v]=0;for(v=103158;v<=103162;v++)k[v]=2;for(v=103163;v<=103165;v++)k[v]=0;for(v=103166;v<=103168;v++)k[v]=1;for(v=103169;v<=103171;v++)k[v]=2;for(v=103186;v<=103188;v++)k[v]=0;for(v=103189;v<=103191;v++)k[v]=2;for(v=103192;v<=103195;v++)k[v]=0;for(v=103196;v<=103199;v++)k[v]=2;for(v=103200;v<=103224;v++)k[v]=0;for(v=103225;v<=103227;v++)k[v]=1;for(v=103232;v<=103237;v++)k[v]=0;for(v=103238;v<=103243;v++)k[v]=2;for(v=103244;v<=103246;v++)k[v]=0;for(v=103247;v<=103249;v++)k[v]=2;for(v=103254;v<=103256;v++)k[v]=0;for(v=103257;v<=103259;v++)k[v]=2;for(v=103264;v<=103266;v++)k[v]=0;for(v=103267;v<=103269;v++)k[v]=2;for(v=103300;v<=103375;v++)k[v]=0;for(v=103381;v<=103383;v++)k[v]=0;for(v=103384;v<=103386;v++)k[v]=1;for(v=103387;v<=103389;v++)k[v]=0;for(v=103390;v<=103392;v++)k[v]=2;for(v=103397;v<=103399;v++)k[v]=0;for(v=103400;v<=103471;v++)k[v]=2;for(v=103476;v<=103478;v++)k[v]=0;for(v=103479;v<=103481;v++)k[v]=2;for(v=103486;v<=103488;v++)k[v]=0;for(v=103489;v<=103491;v++)k[v]=2;for(v=103492;v<=103495;v++)k[v]=0;for(v=103496;v<=103499;v++)k[v]=2;for(v=103528;v<=103543;v++)k[v]=0;for(v=103544;v<=103548;v++)k[v]=2;for(v=103549;v<=103551;v++)k[v]=0;for(v=103552;v<=103554;v++)k[v]=1;for(v=103555;v<=103557;v++)k[v]=2;for(v=103558;v<=103560;v++)k[v]=0;for(v=103571;v<=103573;v++)k[v]=0;for(v=103574;v<=103576;v++)k[v]=2;for(v=103577;v<=103580;v++)k[v]=0;for(v=103581;v<=103583;v++)k[v]=2;for(v=103595;v<=103694;v++)k[v]=0;for(v=103696;v<=103699;v++)k[v]=0;for(v=103700;v<=103793;v++)k[v]=2;for(v=103794;v<=103890;v++)k[v]=0;for(v=103891;v<=103896;v++)k[v]=2;for(v=103900;v<=103971;v++)k[v]=2;for(v=103972;v<=103977;v++)k[v]=0;for(v=112e3;v<=112101;v++)k[v]=0;const Cve={102113:!0,102100:!0,3857:!0,3785:!0},Mve={4326:!0,3785:!0,3857:!0,102113:!0,102100:!0,104905:!0,104971:!0},p9='PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]',jT=[-20037508342788905e-9,20037508342788905e-9],BT=[-20037508342787e-6,20037508342787e-6],vQ={102113:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:jT,origin:BT,dx:1e-5},102100:{wkTemplate:p9,valid:jT,origin:BT,dx:1e-5},3785:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:jT,origin:BT,dx:1e-5},3857:{wkTemplate:p9,valid:jT,origin:BT,dx:1e-5},4326:{wkTemplate:'GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",{Central_Meridian}],UNIT["Degree",0.0174532925199433]]',altTemplate:'PROJCS["WGS_1984_Plate_Carree",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Plate_Carree"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],UNIT["Degrees",111319.491]]',valid:[-180,180],origin:[-180,90],dx:1e-5},104971:{wkTemplate:'GEOGCS["Mars_2000_(Sphere)",DATUM["Mars_2000_(Sphere)",SPHEROID["Mars_2000_(Sphere)",3396190.0,0.0]],PRIMEM["Reference_Meridian",0.0],UNIT["Degree",0.0174532925199433]]',valid:[-180,180],origin:[-180,90],dx:1e-5},104905:{wkTemplate:'GEOGCS["GCS_Mars_2000",DATUM["D_Mars_2000",SPHEROID["Mars_2000_IAU_IAG",3396190.0,169.8944472236118]],PRIMEM["Reference_Meridian",0.0],UNIT["Degree",0.0174532925199433]]',valid:[-180,180],origin:[-180,90],dx:1e-5}};function En(t,e){return t===e||t!=null&&e!=null&&(t.wkid!=null||e.wkid!=null?t.wkid===e.wkid||Oy(t)&&Oy(e)||e.latestWkid!=null&&t.wkid===e.latestWkid||t.latestWkid!=null&&e.wkid===t.latestWkid:!(!t.wkt||!e.wkt)&&t.wkt.toUpperCase()===e.wkt.toUpperCase())}function to(t){return Nr(t)&&t.wkid&&vQ[t.wkid]||null}function n6(t){return!!Nr(t)&&(t.wkid?k[t.wkid]==null:!!t.wkt&&!!/^\s*GEOGCS/i.test(t.wkt))}function Eve(t){return!(s6(t)||a6(t))}function A2(t){return Nr(t)&&t.wkid===4326}function lat(t){return Nr(t)&&t.wkid===ky.CGCS2000}function Oy(t){return Nr(t)&&t.wkid!=null&&Cve[t.wkid]===!0}function Ave(t){return Nr(t)&&t.wkid===32662}function r6(t){return t===ky.GCSMARS2000||t===ky.GCSMARS2000_SPHERE}function s6(t){return Nr(t)&&t.wkid!=null&&r6(t.wkid)}function o6(t){return t===ky.GCSMOON2000}function a6(t){return Nr(t)&&t.wkid!=null&&o6(t.wkid)}function $ve(t){return Nr(t)&&t.wkid!=null&&Mve[t.wkid]===!0}function Nr(t){return t!=null&&(t.wkid!=null&&t.wkid>=2e3||t.wkt!=null)}const Pve={wkid:4326,wkt:pl(vQ[4326].wkTemplate,{Central_Meridian:"0.0"})},kve={wkid:102100,latestWkid:3857},Ove={wkid:32662};function l6(t){return{wkt:`GEOCCS["Spherical geocentric",
    DATUM["Not specified",
      SPHEROID["Sphere",${t.radius},0]],
    PRIMEM["Greenwich",0.0,
      AUTHORITY["EPSG","8901"]],
    UNIT["m",1.0],
    AXIS["Geocentric X",OTHER],
    AXIS["Geocentric Y",EAST],
    AXIS["Geocentric Z",NORTH]
  ]`}}const Lve=l6(ci),_Q=l6(Hh),bQ=l6(Lf),Rve={wkt:`GEOCCS["WGS 84",
  DATUM["WGS_1984",
    SPHEROID["WGS 84",${ci.radius},298.257223563,
      AUTHORITY["EPSG","7030"]],
    AUTHORITY["EPSG","6326"]],
  PRIMEM["Greenwich",0,
    AUTHORITY["EPSG","8901"]],
  UNIT["m",1.0,
    AUTHORITY["EPSG","9001"]],
  AXIS["Geocentric X",OTHER],
  AXIS["Geocentric Y",OTHER],
  AXIS["Geocentric Z",NORTH],
  AUTHORITY["EPSG","4978"]
]`};function nP(t){return t!=null&&(s6(t)||En(t,_Q))?Hh:t!=null&&(a6(t)||En(t,bQ))?Lf:ci}function cat(t){return r6(t)?Hh:o6(t)?Lf:ci}const wQ=39.37,Dve=ci.radius*Math.PI/200,xQ=/UNIT\[([^\]]+)\]\]$/i,py=k,SQ=/UNIT\[([^\]]+)\]/i,Nve=new Set([4261,4305,4807,4810,4811,4812,4816,4819,4821,4901,4902,37225,104139,104140]),Fve=Nn()({meter:"meters",foot:"feet",foot_us:"us-feet",foot_clarke:"clarke-feet",yard_clarke:"clarke-yards",link_clarke:"clarke-links",yard_sears:"sears-yards",foot_sears:"sears-feet",chain_sears:"sears-chains",chain_benoit_1895_b:"benoit-1895-b-chains",yard_indian:"indian-yards",yard_indian_1937:"indian-1937-yards",foot_gold_coast:"gold-coast-feet",chain_sears_1922_truncated:"sears-1922-truncated-chains","50_kilometers":"50-kilometers","150_kilometers":"150-kilometers"}),Nc=t=>t*t,kd=t=>t*t*t,$2={length:{baseUnit:"meters",units:{millimeters:{inBaseUnits:.001},centimeters:{inBaseUnits:.01},decimeters:{inBaseUnits:.1},meters:{inBaseUnits:1},kilometers:{inBaseUnits:1e3},inches:{inBaseUnits:.0254},feet:{inBaseUnits:.3048},yards:{inBaseUnits:.9144},miles:{inBaseUnits:1609.344},"nautical-miles":{inBaseUnits:1852},"us-feet":{inBaseUnits:1200/3937}}},area:{baseUnit:"square-meters",units:{"square-millimeters":{inBaseUnits:Nc(.001)},"square-centimeters":{inBaseUnits:Nc(.01)},"square-decimeters":{inBaseUnits:Nc(.1)},"square-meters":{inBaseUnits:1},"square-kilometers":{inBaseUnits:Nc(1e3)},"square-inches":{inBaseUnits:Nc(.0254)},"square-feet":{inBaseUnits:Nc(.3048)},"square-yards":{inBaseUnits:Nc(.9144)},"square-miles":{inBaseUnits:Nc(1609.344)},"square-us-feet":{inBaseUnits:Nc(1200/3937)},acres:{inBaseUnits:.0015625*Nc(1609.344)},ares:{inBaseUnits:100},hectares:{inBaseUnits:1e4}}},volume:{baseUnit:"liters",units:{liters:{inBaseUnits:1},"cubic-millimeters":{inBaseUnits:1e3*kd(.001)},"cubic-centimeters":{inBaseUnits:1e3*kd(.01)},"cubic-decimeters":{inBaseUnits:1e3*kd(.1)},"cubic-meters":{inBaseUnits:1e3},"cubic-kilometers":{inBaseUnits:1e3*kd(1e3)},"cubic-inches":{inBaseUnits:1e3*kd(.0254)},"cubic-feet":{inBaseUnits:1e3*kd(.3048)},"cubic-yards":{inBaseUnits:1e3*kd(.9144)},"cubic-miles":{inBaseUnits:1e3*kd(1609.344)}}},angle:{baseUnit:"radians",units:{radians:{inBaseUnits:1},degrees:{inBaseUnits:Math.PI/180}}}},zve=(()=>{const t={};for(const e in $2)for(const i in $2[e].units)t[i]=e;return t})();function Vve(t,e,i){return t*$2[i].units[e].inBaseUnits}function jve(t,e,i){return t/$2[i].units[e].inBaseUnits}const JE=["metric","imperial","inches","feet","yards","miles","nautical-miles","us-feet","meters","kilometers"],Bve=new Map([["meters","square-meters"],["feet","square-feet"],["us-feet","square-us-feet"]]);function Uve(t){return t==="imperial"||t==="metric"}function gR(t){const e=zve[t];if(!e)throw new Error("unknown type");return e}function f9(t,e=null){return e=e||gR(t),$2[e].baseUnit===t}function ht(t,e,i){if(e===i)return t;const n=gR(e);if(n!==gR(i))throw new Error("incompatible units");const r=f9(e,n)?t:Vve(t,e,n);return f9(i,n)?r:jve(r,i,n)}function Gve(t,e,i){switch(i){case"metric":return c6(t,e);case"imperial":return h6(t,e);default:return i}}function Hve(t,e,i){switch(i){case"metric":return u6(t,e);case"imperial":return d6(t,e);default:return i}}function c6(t,e){const i=ht(t,e,"meters");return Math.abs(i)<3e3?"meters":"kilometers"}function u6(t,e){const i=ht(t,e,"meters");return Math.abs(i)<1e5?"meters":"kilometers"}function h6(t,e){const i=ht(t,e,"feet");return Math.abs(i)<1e3?"feet":"miles"}function d6(t,e){const i=ht(t,e,"feet");return Math.abs(i)<1e5?"feet":"miles"}function qve(t,e){const i=ht(t,e,"square-meters");return Math.abs(i)<3e6?"square-meters":"square-kilometers"}function Wve(t,e){const i=ht(t,e,"square-feet");return Math.abs(i)<1e6?"square-feet":"square-miles"}function TQ(t,e,i){return ht(t,e,"meters")/(i*Math.PI/180)}function IQ(t){return Fve.fromJSON(t.toLowerCase())||null}function sd(t){if(t!=null&&!Eve(t))return 1;const e=pi(t);return e>1e5?1:e}function CQ(t){return pi(t)>=nP(t).metersPerDegree?"meters":DS(t)}function pi(t,e=ci.metersPerDegree){return Jve(t,!0)??e}function Jve(t,e=!1){const i=t!=null?t.wkid:null,n=t!=null?t.wkt:null;let r=null;if(i){if(r6(i))return Hh.metersPerDegree;if(o6(i))return Lf.metersPerDegree;r=py.values[py[i]],!r&&e&&Nve.has(i)&&(r=Dve)}else n&&(AQ(n)?r=m9(xQ.exec(n),r):EQ(n)&&(r=m9(SQ.exec(n),r)));return r}function uat(t){return t.isGeographic?1:pi(t)}function m9(t,e){return t&&t[1]?MQ(t[1]):e}function MQ(t){return parseFloat(t.split(",")[1])}function DS(t){const e=t!=null?t.wkid:null,i=t!=null?t.wkt:null;let n=null;if(e)n=py.units[py[e]];else if(i){const r=AQ(i)?xQ:EQ(i)?SQ:null;if(r){const s=r.exec(i);s&&s[1]&&(n=Yve(s[1]))}}return n!=null?IQ(n):null}function hat(t){const e=DS(t);return e!=null&&JE.includes(e)?e:null}function dat(t){const e=CQ(t);return e!=null&&JE.includes(e)?e:null}function pat(t){const e=DS(t);return e==null?null:Bve.get(e)}function EQ(t){return/^GEOCCS/i.test(t)}function AQ(t){return/^PROJCS/i.test(t)}const Zve=1e-7;function Yve(t){const e=/[\\"\\']{1}([^\\"\\']+)/.exec(t);let i=e&&e[1];if(!i||!py.units.includes(i)){const n=MQ(t);i=null;const r=py.values;for(let s=0;s<r.length;++s)if(Math.abs(n-r[s])<Zve){i=py.units[s];break}}return i}function Xve(t){const e=DS(t);if(e==null)return null;switch(e){case"feet":case"us-feet":case"clarke-feet":case"clarke-yards":case"clarke-links":case"sears-yards":case"sears-feet":case"sears-chains":case"benoit-1895-b-chains":case"indian-yards":case"indian-1937-yards":case"gold-coast-feet":case"sears-1922-truncated-chains":return"imperial";case"50-kilometers":case"150-kilometers":case"meters":return"metric"}return null}const Kve={esriAcres:"acres",esriAres:"ares",esriHectares:"hectares",esriSquareCentimeters:"square-centimeters",esriSquareDecimeters:"square-decimeters",esriSquareFeet:"square-feet",esriSquareInches:"square-inches",esriSquareKilometers:"square-kilometers",esriSquareMeters:"square-meters",esriSquareMiles:"square-miles",esriSquareMillimeters:"square-millimeters",esriSquareUsFeet:"square-us-feet",esriSquareYards:"square-yards"},Qve={esriCentimeters:"centimeters",esriDecimeters:"decimeters",esriFeet:"feet",esriInches:"inches",esriKilometers:"kilometers",esriMeters:"meters",esriMiles:"miles",esriMillimeters:"millimeters",esriNauticalMiles:"nautical-miles",esriYards:"yards"},e_e={esriDUDecimalDegrees:"degrees",esriDURadians:"radians"},fat=Nn()(Kve),mat=Nn()(Qve),gat=Nn()(e_e);var jc;let Bt=jc=class extends ie{static fromJSON(t){if(!t)return null;if(t.wkid){if(t.wkid===102100)return jc.WebMercator;if(t.wkid===4326)return jc.WGS84}const e=new jc;return e.read(t),e}constructor(t){super(t),this.latestWkid=null,this.wkid=null,this.wkt=null,this.vcsWkid=null,this.latestVcsWkid=null,this.imageCoordinateSystem=null}normalizeCtorArgs(t){return t&&typeof t=="object"?t:{[typeof t=="string"?"wkt":"wkid"]:t}}get isWGS84(){return A2(this)}get isWebMercator(){return Oy(this)}get isGeographic(){return n6(this)}get isWrappable(){return $ve(this)}get metersPerUnit(){return pi(this)}get unit(){return DS(this)||(this.isGeographic?"degrees":null)}writeWkt(t,e){this.wkid||(e.wkt=t)}clone(){if(this===jc.WGS84)return jc.WGS84;if(this===jc.WebMercator)return jc.WebMercator;const t=new jc;return this.wkid!=null?(t.wkid=this.wkid,this.latestWkid!=null&&(t.latestWkid=this.latestWkid),this.vcsWkid!=null&&(t.vcsWkid=this.vcsWkid),this.latestVcsWkid!=null&&(t.latestVcsWkid=this.latestVcsWkid)):this.wkt!=null&&(t.wkt=this.wkt),this.imageCoordinateSystem&&(t.imageCoordinateSystem=q(this.imageCoordinateSystem)),t}equals(t){if(t==null)return!1;if(this.imageCoordinateSystem||t.imageCoordinateSystem){if(this.imageCoordinateSystem==null||t.imageCoordinateSystem==null)return!1;const{id:e,referenceServiceName:i}=t.imageCoordinateSystem,{geodataXform:n}=t.imageCoordinateSystem,r=this.imageCoordinateSystem;return e==null||n?JSON.stringify(r)===JSON.stringify(t.imageCoordinateSystem):i?r.id===e&&r.referenceServiceName===i:r.id===e}return En(this,t)}toJSON(t){return this.write(void 0,t)}};Bt.GCS_NAD_1927=null,Bt.WGS84=null,Bt.WebMercator=null,Bt.PlateCarree=null,h([p({readOnly:!0})],Bt.prototype,"isWGS84",null),h([p({readOnly:!0})],Bt.prototype,"isWebMercator",null),h([p({readOnly:!0})],Bt.prototype,"isGeographic",null),h([p({readOnly:!0})],Bt.prototype,"isWrappable",null),h([p({type:It,json:{write:!0}})],Bt.prototype,"latestWkid",void 0),h([p({readOnly:!0})],Bt.prototype,"metersPerUnit",null),h([p({readOnly:!0})],Bt.prototype,"unit",null),h([p({type:It,json:{write:!0,origins:{"web-scene":{write:{overridePolicy(){return{isRequired:this.wkt==null}}}}}}})],Bt.prototype,"wkid",void 0),h([p({type:String,json:{origins:{"web-scene":{write:{overridePolicy(){return{isRequired:this.wkid==null}}}}}}})],Bt.prototype,"wkt",void 0),h([ge("wkt"),ge("web-scene","wkt")],Bt.prototype,"writeWkt",null),h([p({type:It,json:{write:!0}})],Bt.prototype,"vcsWkid",void 0),h([p({type:It,json:{write:!0}})],Bt.prototype,"latestVcsWkid",void 0),h([p()],Bt.prototype,"imageCoordinateSystem",void 0),Bt=jc=h([P("esri.geometry.SpatialReference")],Bt),Bt.prototype.toJSON.isDefaultToJSON=!0,Bt.GCS_NAD_1927=new Bt({wkid:4267,wkt:'GEOGCS["GCS_North_American_1927",DATUM["D_North_American_1927",SPHEROID["Clarke_1866",6378206.4,294.9786982]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]]'}),Bt.WGS84=new Bt(Pve),Bt.WebMercator=new Bt(kve),Bt.PlateCarree=new Bt(Ove),Object.freeze&&(Object.freeze(Bt.GCS_NAD_1927),Object.freeze(Bt.WGS84),Object.freeze(Bt.WebMercator));const Ee=Bt,$Q="20230626",PQ="b81703b48e0b92e492f4cc6b739af02a9af50038",t_e="4.27";let p6=t_e;p6="4.27.6";const i_e={async request(t,e){var a,l;const{default:i}=await Y(()=>Promise.resolve().then(()=>x_e),void 0,import.meta.url),n=t.options,r=n.responseType;n.signal=e==null?void 0:e.signal,n.responseType=r==="native"||r==="native-request-init"?"native-request-init":r&&["blob","json","text"].includes(r)&&((a=dQ(t.url))!=null&&a.after)?r:"array-buffer";const s=await i(t.url,n),o={data:s.data,httpStatus:s.httpStatus,ssl:s.ssl};switch((l=s.requestOptions)==null?void 0:l.responseType){case"native-request-init":return delete o.data.signal,o;case"blob":o.data=await o.data.arrayBuffer();break;case"json":o.data=new TextEncoder().encode(JSON.stringify(o.data)).buffer;break;case"text":o.data=new TextEncoder().encode(o.data).buffer}return{result:o,transferList:[o.data]}}};let ct;function yat(t){ct=t}function n_e(t){const e=ct==null?void 0:ct.findCredential(t);return e!=null&&e.token?gQ(t,"token",e.token):t}ee("host-webworker");const r_e=["elevation3d.arcgis.com","js.arcgis.com","jsdev.arcgis.com","jsqa.arcgis.com","static.arcgis.com"];function kQ(t){const e=gc(t,!0);return!!e&&e.endsWith(".arcgis.com")&&!r_e.includes(e)&&!t.endsWith("/sharing/rest/generateToken")}function s_e(t,e,i=!1,n){return new Promise((r,s)=>{if(zo(n))return void s(g9());let o=()=>{c(),s(new Error(`Unable to load ${e}`))},a=()=>{const u=t;c(),r(u)},l=()=>{if(!t)return;const u=t;c(),u.src="",s(g9())};const c=()=>{ee("esri-image-decode")||(t.removeEventListener("error",o),t.removeEventListener("load",a)),o=null,a=null,t=null,n!=null&&n.removeEventListener("abort",l),l=null,i&&URL.revokeObjectURL(e)};n!=null&&n.addEventListener("abort",l),ee("esri-image-decode")?t.decode().then(a,o):(t.addEventListener("error",o),t.addEventListener("load",a))})}function g9(){try{return new DOMException("Aborted","AbortError")}catch{const t=new Error;return t.name="AbortError",t}}const o_e="Timeout exceeded";function a_e(){return new Error(o_e)}function l_e(t){Tt.request.crossOriginNoCorsDomains||(Tt.request.crossOriginNoCorsDomains={});const e=Tt.request.crossOriginNoCorsDomains;for(let i of t)i=i.toLowerCase(),/^https?:\/\//.test(i)?e[gc(i)??""]=0:(e[gc("http://"+i)??""]=0,e[gc("https://"+i)??""]=0)}function c_e(t){const e=Tt.request.crossOriginNoCorsDomains;if(e){let i=gc(t);if(i)return i=i.toLowerCase(),!K_(i,Jz())&&e[i]<Date.now()-36e5}return!1}async function u_e(t){var r;const e=Tt.request.crossOriginNoCorsDomains,i=gc(t);e&&i&&(e[i.toLowerCase()]=Date.now());const n=ir(t);t=n.path,((r=n.query)==null?void 0:r.f)==="json"&&(t+="?f=json");try{await fetch(t,{mode:"no-cors",credentials:"include"})}catch{}}async function gt(t,e){var c;t instanceof URL&&(t=t.toString()),(e==null?void 0:e.query)instanceof URLSearchParams&&(e.query=Zz(e.query.toString().replaceAll("+"," ")));const i=n0(t),n=iP(t);n||i||(t=ll(t));const r={url:t,requestOptions:{...e}};let s=dQ(t);if(s){const u=await v_e(s,r);if(u!=null)return{data:u,getHeader:f6,httpStatus:200,requestOptions:r.requestOptions,url:r.url};s.after||s.error||(s=null)}if(t=r.url,(e=r.requestOptions).responseType==="image"&&(ee("host-webworker")||ee("host-node")))throw Iu("request:invalid-parameters",new Error("responseType 'image' is not supported in Web Workers or Node environment"),r);if(e.method==="head"){if(e.body)throw Iu("request:invalid-parameters",new Error("body parameter cannot be set when method is 'head'"),r);if(i||n)throw Iu("request:invalid-parameters",new Error("data and blob URLs are not supported for method 'head'"),r)}if(await m_e(),ZE)return ZE.execute(t,e);const o=new AbortController;Ro(e,()=>o.abort());const a={controller:o,credential:void 0,credentialToken:void 0,fetchOptions:void 0,hasToken:!1,interceptor:s,params:r,redoRequest:!1,useIdentity:sc.useIdentity,useProxy:!1,useSSL:!1,withCredentials:!1},l=await b_e(a);return(c=s==null?void 0:s.after)==null||c.call(s,l),l}let ZE;const sc=Tt.request,OQ="FormData"in globalThis,h_e=[499,498,403,401],d_e=["COM_0056","COM_0057","SB_0008"],p_e=[/\/arcgis\/tokens/i,/\/sharing(\/rest)?\/generatetoken/i,/\/rest\/info/i],f6=()=>null,YE=Symbol();function f_e(t){const e=gc(t);e&&!gt._corsServers.includes(e)&&gt._corsServers.push(e)}function y9(t){const e=gc(t);return!e||e.endsWith(".arcgis.com")||gt._corsServers.includes(e)||Xz(e)}function Iu(t,e,i,n){let r="Error";const s={url:i.url,requestOptions:i.requestOptions,getHeader:f6,ssl:!1};if(e instanceof V)return e.details?(e.details=q(e.details),e.details.url=i.url,e.details.requestOptions=i.requestOptions):e.details=s,e;if(e){const o=n&&(c=>n.headers.get(c)),a=n==null?void 0:n.status,l=e.message;l&&(r=l),o&&(s.getHeader=o),s.httpStatus=(e.httpCode!=null?e.httpCode:e.code)||a||0,s.subCode=e.subcode,s.messageCode=e.messageCode,typeof e.details=="string"?s.messages=[e.details]:s.messages=e.details,s.raw=YE in e?e[YE]:e}return Ds(e)?li():new V(t,r,s)}async function m_e(){ee("host-webworker")?ZE||(ZE=await Y(()=>import("./request-554056d4.js"),[],import.meta.url)):gt._abortableFetch||(gt._abortableFetch=globalThis.fetch.bind(globalThis))}async function yR(){ct||await Y(()=>import("./IdentityManager-c97ae3b9.js"),[],import.meta.url)}async function g_e(t){var a;const e=t.params.url,i=t.params.requestOptions,n=t.controller.signal,r=i.body;let s=null,o=null;if(OQ&&"HTMLFormElement"in globalThis&&(r instanceof FormData?s=r:r instanceof HTMLFormElement&&(s=new FormData(r))),typeof r=="string"&&(o=r),t.fetchOptions={cache:i.cacheBust&&!("polyfill"in gt._abortableFetch)?"no-cache":"default",credentials:"same-origin",headers:i.headers||{},method:i.method==="head"?"HEAD":"GET",mode:"cors",priority:sc.priority,redirect:"follow",signal:n},(s||o)&&(t.fetchOptions.body=s||o),i.authMode==="anonymous"&&(t.useIdentity=!1),t.hasToken=!!(/token=/i.test(e)||(a=i.query)!=null&&a.token||s!=null&&s.get("token")),!t.hasToken&&Tt.apiKey&&kQ(e)&&(i.query||(i.query={}),i.query.token=Tt.apiKey,t.hasToken=!0),t.useIdentity&&!t.hasToken&&!t.credentialToken&&!LQ(e)&&!zo(n)){let l;i.authMode==="immediate"?(await yR(),l=await ct.getCredential(e,{signal:n}),t.credential=l):i.authMode==="no-prompt"?(await yR(),l=await ct.getCredential(e,{prompt:!1,signal:n}).catch(()=>{}),t.credential=l):ct&&(l=ct.findCredential(e)),l&&(t.credentialToken=l.token,t.useSSL=!!l.ssl)}}function LQ(t){return p_e.some(e=>e.test(t))}async function y_e(t){let e=t.params.url;const i=t.params.requestOptions,n=t.fetchOptions??{},r=iP(e)||n0(e),s=i.responseType||"json",o=r?0:i.timeout!=null?i.timeout:sc.timeout;let a=!1;if(!r){t.useSSL&&(e=e6(e)),i.cacheBust&&n.cache==="default"&&(e=gQ(e,"request.preventCache",Date.now()));let f={...i.query};t.credentialToken&&(f.token=t.credentialToken);let m=X_(f);ee("esri-url-encodes-apostrophe")&&(m=m.replaceAll("'","%27"));const g=e.length+1+m.length;let y;a=i.method==="delete"||i.method==="post"||i.method==="put"||!!i.body||g>sc.maxUrlLength;const _=i.useProxy||!!eP(e);if(_){const b=cve(e);y=b.path,!a&&y.length+1+g>sc.maxUrlLength&&(a=!0),b.query&&(f={...b.query,...f})}if(n.method==="HEAD"&&(a||_)){if(a)throw g>sc.maxUrlLength?Iu("request:invalid-parameters",new Error("URL exceeds maximum length"),t.params):Iu("request:invalid-parameters",new Error("cannot use POST request when method is 'head'"),t.params);if(_)throw Iu("request:invalid-parameters",new Error("cannot use proxy when method is 'head'"),t.params)}if(a?(n.method=i.method==="delete"?"DELETE":i.method==="put"?"PUT":"POST",i.body?e=WC(e,f):(n.body=X_(f),n.headers||(n.headers={}),n.headers["Content-Type"]="application/x-www-form-urlencoded")):e=WC(e,f),_&&(t.useProxy=!0,e=`${y}?${e}`),f.token&&OQ&&n.body instanceof FormData&&!X0e(e)&&n.body.set("token",f.token),i.hasOwnProperty("withCredentials"))t.withCredentials=i.withCredentials;else if(!K_(e,Jz())){if(Xz(e))t.withCredentials=!0;else if(ct){const b=ct.findServerInfo(e);b!=null&&b.webTierAuth&&(t.withCredentials=!0)}}t.withCredentials&&(n.credentials="include",c_e(e)&&await u_e(a?WC(e,f):e))}let l,c,u=0,d=!1;o>0&&(u=setTimeout(()=>{d=!0,t.controller.abort()},o));try{if(i.responseType==="native-request-init")c=n,c.url=e;else if(i.responseType!=="image"||n.cache!=="default"||n.method!=="GET"||a||__e(i.headers)||!r&&!t.useProxy&&sc.proxyUrl&&!y9(e)){if(l=await gt._abortableFetch(e,n),t.useProxy||f_e(e),i.responseType==="native")c=l;else if(n.method!=="HEAD")if(l.ok){switch(s){case"array-buffer":c=await l.arrayBuffer();break;case"blob":case"image":c=await l.blob();break;default:c=await l.text()}if(u&&(clearTimeout(u),u=0),s==="json"||s==="xml"||s==="document")if(c)switch(s){case"json":c=JSON.parse(c);break;case"xml":c=v9(c,"application/xml");break;case"document":c=v9(c,"text/html")}else c=null;if(c){if(s==="array-buffer"||s==="blob"){const f=l.headers.get("Content-Type");if(f&&/application\/json|text\/plain/i.test(f)&&c[s==="blob"?"size":"byteLength"]<=750)try{const m=await new Response(c).json();m.error&&(c=m)}catch{}}s==="image"&&c instanceof Blob&&(c=await _9(URL.createObjectURL(c),t,!0))}}else{c=await l.text();try{c=JSON.parse(c)}catch{}}}else c=await _9(e,t)}catch(f){if(f.name==="AbortError")throw d?a_e():li("Request canceled");if(!(!l&&f instanceof TypeError&&sc.proxyUrl)||i.body||i.method==="delete"||i.method==="head"||i.method==="post"||i.method==="put"||t.useProxy||y9(e))throw f;t.redoRequest=!0,uve({proxyUrl:sc.proxyUrl,urlPrefix:gc(e)??""})}finally{u&&clearTimeout(u)}return[l,c]}async function v_e(t,e){if(t.responseData!=null)return t.responseData;if(t.headers&&(e.requestOptions.headers={...e.requestOptions.headers,...t.headers}),t.query&&(e.requestOptions.query={...e.requestOptions.query,...t.query}),t.before){let i,n;try{n=await t.before(e)}catch(r){i=Iu("request:interceptor",r,e)}if((n instanceof Error||n instanceof V)&&(i=Iu("request:interceptor",n,e)),i)throw t.error&&t.error(i),i;return n}}function __e(t){if(t){for(const e of Object.getOwnPropertyNames(t))if(t[e])return!0}return!1}function v9(t,e){let i;try{i=new DOMParser().parseFromString(t,e)}catch{}if(!i||i.getElementsByTagName("parsererror").length)throw new SyntaxError("XML Parse error");return i}async function b_e(t){var s,o;let e,i;await g_e(t);try{do[e,i]=await y_e(t);while(!await w_e(t,e,i))}catch(a){const l=Iu("request:server",a,t.params,e);throw l.details.ssl=t.useSSL,(s=t.interceptor)!=null&&s.error&&t.interceptor.error(l),l}const n=t.params.url;if(i&&/\/sharing\/rest\/(accounts|portals)\/self/i.test(n)){if(!t.hasToken&&!t.credentialToken&&((o=i.user)!=null&&o.username)&&!Xz(n)){const a=gc(n,!0);a&&sc.trustedServers.push(a)}Array.isArray(i.authorizedCrossOriginNoCorsDomains)&&l_e(i.authorizedCrossOriginNoCorsDomains)}const r=t.credential;if(r&&ct){const a=ct.findServerInfo(r.server);let l=a==null?void 0:a.owningSystemUrl;if(l){l=l.replace(/\/?$/,"/sharing");const c=ct.findCredential(l,r.userId);c&&ct._getIdenticalSvcIdx(l,c)===-1&&c.resources.unshift(l)}}return{data:i,getHeader:e?a=>e==null?void 0:e.headers.get(a):f6,httpStatus:(e==null?void 0:e.status)??200,requestOptions:t.params.requestOptions,ssl:t.useSSL,url:t.params.url}}async function w_e(t,e,i){var c;if(t.redoRequest)return t.redoRequest=!1,!1;const n=t.params.requestOptions;if(!e||n.responseType==="native"||n.responseType==="native-request-init")return!0;let r,s;if(i&&(i.error?r=i.error:i.status==="error"&&Array.isArray(i.messages)&&(r={...i},r[YE]=i,r.details=i.messages)),!r&&!e.ok)throw r=new Error(`Unable to load ${e.url} status: ${e.status}`),r[YE]=i,r;let o,a=null;r&&(s=Number(r.code),a=r.hasOwnProperty("subcode")?Number(r.subcode):null,o=r.messageCode,o=o==null?void 0:o.toUpperCase());const l=n.authMode;if(s===403&&(a===4||(c=r.message)!=null&&c.toLowerCase().includes("ssl")&&!r.message.toLowerCase().includes("permission"))){if(!t.useSSL)return t.useSSL=!0,!1}else if(!t.hasToken&&t.useIdentity&&(l!=="no-prompt"||s===498)&&s!==void 0&&h_e.includes(s)&&!LQ(t.params.url)&&(s!==403||o&&!d_e.includes(o)&&(a==null||a===2&&t.credentialToken))){await yR();try{const u=await ct.getCredential(t.params.url,{error:Iu("request:server",r,t.params),prompt:l!=="no-prompt",signal:t.controller.signal,token:t.credentialToken});return t.credential=u,t.credentialToken=u.token,t.useSSL=t.useSSL||u.ssl,!1}catch(u){if(l==="no-prompt")return t.credential=void 0,t.credentialToken=void 0,!1;r=u}}if(r)throw r;return!0}function _9(t,e,i=!1){const n=e.controller.signal,r=new Image;return e.withCredentials?r.crossOrigin="use-credentials":r.crossOrigin="anonymous",r.alt="",r.fetchPriority=sc.priority,r.src=t,s_e(r,t,i,n)}gt._abortableFetch=null,gt._corsServers=["https://server.arcgisonline.com","https://services.arcgisonline.com"];const x_e=Object.freeze(Object.defineProperty({__proto__:null,default:gt},Symbol.toStringTag,{value:"Module"}));function _e(t,e,i){let n,r;return e===void 0||Array.isArray(e)?(r=t,i=e,n=[void 0]):(r=e,n=Array.isArray(t)?t:[t]),(s,o)=>{const a=s.constructor.prototype;n.forEach(l=>{const c=FK(s,l,r);c.read&&typeof c.read=="object"||(c.read={}),c.read.reader=a[o],i&&(c.read.source=(c.read.source||[]).concat(i))})}}let Bc=class extends ie{constructor(...e){super(...e),this.type=null,this.hasM=!1,this.hasZ=!1,this.spatialReference=Ee.WGS84}get cache(){return this.commitProperty("spatialReference"),{}}get extent(){return null}readSpatialReference(e,i){if(e instanceof Ee)return e;if(e!=null){const n=new Ee;return n.read(e,i),n}return e}clone(){return console.warn(".clone() is not implemented for "+this.declaredClass),null}clearCache(){this.notifyChange("cache")}getCacheValue(e){return this.cache[e]}setCacheValue(e,i){this.cache[e]=i}};h([p()],Bc.prototype,"type",void 0),h([p({readOnly:!0})],Bc.prototype,"cache",null),h([p({readOnly:!0})],Bc.prototype,"extent",null),h([p({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],Bc.prototype,"hasM",void 0),h([p({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],Bc.prototype,"hasZ",void 0),h([p({type:Ee,json:{write:!0},value:Ee.WGS84})],Bc.prototype,"spatialReference",void 0),h([_e("spatialReference")],Bc.prototype,"readSpatialReference",null),Bc=h([P("esri.geometry.Geometry")],Bc);const md=Bc,S_e=Object.prototype.toString;function T_e(t){const e="__accessorMetadata__"in t?fn(t):t;return function(...i){if(i.push(e),typeof i[2]=="number")throw new Error("Using @cast has parameter decorator is not supported since 4.16");return I_e.apply(this,i)}}function I_e(t,e,i,n){H$(t,e).cast=n}function C_e(t){return(e,i)=>{H$(e,t).cast=e[i]}}function ut(...t){if(t.length!==3||typeof t[1]!="string")return t.length===1&&S_e.call(t[0])==="[object Function]"?T_e(t[0]):t.length===1&&typeof t[0]=="string"?C_e(t[0]):void 0}function M_e(t,e){const i=t.x-e.x,n=t.y-e.y,r=t.hasZ&&e.hasZ?t.z-e.z:0;return Math.sqrt(i*i+n*n+r*r)}const E_e=57.29577951308232,A_e=.017453292519943;function b9(t){return t*E_e}function w9(t){return t*A_e}function _at(t){return Math.PI/2-2*Math.atan(Math.exp(-t/ci.radius))}function vR(t){return t.wkid!=null||t.wkt!=null}const l3=[0,0];function XE(t,e,i,n,r){const s=t,o=r;if(o.spatialReference=i,"x"in s&&"x"in o)[o.x,o.y]=e(s.x,s.y,l3,n);else if("xmin"in s&&"xmin"in o)[o.xmin,o.ymin]=e(s.xmin,s.ymin,l3,n),[o.xmax,o.ymax]=e(s.xmax,s.ymax,l3,n);else if("paths"in s&&"paths"in o||"rings"in s&&"rings"in o){const a="paths"in s?s.paths:s.rings,l=[];let c;for(let u=0;u<a.length;u++){const d=a[u];c=[],l.push(c);for(let f=0;f<d.length;f++)c.push(e(d[f][0],d[f][1],[0,0],n)),d[f].length>2&&c[f].push(d[f][2]),d[f].length>3&&c[f].push(d[f][3])}"paths"in o?o.paths=l:o.rings=l}else if("points"in s&&"points"in o){const a=s.points,l=[];for(let c=0;c<a.length;c++)l[c]=e(a[c][0],a[c][1],[0,0],n),a[c].length>2&&l[c].push(a[c][2]),a[c].length>3&&l[c].push(a[c][3]);o.points=l}return r}function JC(t,e){const i=t&&(vR(t)?t:t.spatialReference),n=e&&(vR(e)?e:e.spatialReference);return!(t&&"type"in t&&t.type==="mesh"||e&&"type"in e&&e.type==="mesh"||!i||!n)&&(!!En(n,i)||Oy(n)&&A2(i)||Oy(i)&&A2(n))}function NS(t,e){if(t==null)return null;const i=t.spatialReference,n=e&&(vR(e)?e:e.spatialReference);return JC(i,n)?En(i,n)?q(t):Oy(n)?XE(t,o_,Ee.WebMercator,!1,q(t)):A2(n)?XE(t,Px,Ee.WGS84,!1,q(t)):null:null}function o_(t,e,i=[0,0]){e>89.99999?e=89.99999:e<-89.99999&&(e=-89.99999);const n=w9(e);return i[0]=w9(t)*ci.radius,i[1]=ci.halfSemiMajorAxis*Math.log((1+Math.sin(n))/(1-Math.sin(n))),i}function Px(t,e,i=[0,0],n=!1){const r=b9(t/ci.radius);return i[0]=n?r:r-360*Math.floor((r+180)/360),i[1]=b9(Math.PI/2-2*Math.atan(Math.exp(-e/ci.radius))),i}function qh(t,e=!1,i=q(t)){return XE(t,o_,Ee.WebMercator,e,i)}function ny(t,e=!1,i=q(t)){return XE(t,Px,Ee.WGS84,e,i)}var ZC;const f1=[0,0];function x9(t){return t&&(t.declaredClass==="esri.geometry.SpatialReference"||t.wkid!=null)}let Gs=ZC=class extends md{static copy(t,e){e._set("x",t._get("x")),e._set("y",t._get("y")),e._set("z",t._get("z")),e._set("m",t._get("m"));const i=t._get("spatialReference");e._set("spatialReference",Object.isFrozen(i)?i:i.clone())}constructor(...t){super(...t),this.x=0,this.y=0,this.z=void 0,this.m=void 0,this.type="point"}normalizeCtorArgs(t,e,i,n,r){let s;if(Array.isArray(t))s=t,r=e,t=s[0],e=s[1],i=s[2],n=s[3];else if(t&&typeof t=="object"){if(s=t,t=s.x!=null?s.x:s.longitude,e=s.y!=null?s.y:s.latitude,i=s.z,n=s.m,(r=s.spatialReference)&&r.declaredClass!=="esri.geometry.SpatialReference"&&(r=new Ee(r)),s.longitude!=null||s.latitude!=null){if(s.longitude==null)ne.getLogger(this).warn(".longitude=","Latitude was defined without longitude");else if(s.latitude==null)ne.getLogger(this).warn(".latitude=","Longitude was defined without latitude");else if(!s.declaredClass&&r&&r.isWebMercator){const a=o_(s.longitude,s.latitude,f1);t=a[0],e=a[1]}}}else x9(i)?(r=i,i=null):x9(n)&&(r=n,n=null);const o={x:t,y:e};return o.x==null&&o.y!=null?ne.getLogger(this).warn(".y=","Y coordinate was defined without an X coordinate"):o.y==null&&o.x!=null&&ne.getLogger(this).warn(".x=","X coordinate was defined without a Y coordinate"),r!=null&&(o.spatialReference=r),i!=null&&(o.z=i),n!=null&&(o.m=n),o}get cache(){return this.commitProperty("x"),this.commitProperty("y"),this.commitProperty("z"),this.commitProperty("m"),this.commitProperty("spatialReference"),{}}get hasM(){return this.m!==void 0}set hasM(t){t!==(this._get("m")!==void 0)&&(this._set("m",t?0:void 0),this._set("hasM",t))}get hasZ(){return this.z!==void 0}set hasZ(t){t!==(this._get("z")!==void 0)&&(this._set("z",t?0:void 0),this._set("hasZ",t))}get latitude(){const{spatialReference:t,x:e,y:i}=this;if(t){if(t.isWebMercator)return Px(e,i,f1)[1];if(t.isGeographic)return i}return null}set latitude(t){const{spatialReference:e,x:i}=this;t!=null&&e&&(e.isWebMercator?this._set("y",o_(i,t,f1)[1]):e.isGeographic&&this._set("y",t),this._set("latitude",t))}get longitude(){const{x:t,y:e,spatialReference:i}=this;if(i){if(i.isWebMercator)return Px(t,e,f1)[0];if(i.isGeographic)return t}return null}set longitude(t){const{y:e,spatialReference:i}=this;t!=null&&i&&(i.isWebMercator?this._set("x",o_(t,e,f1)[0]):i.isGeographic&&this._set("x",t),this._set("longitude",t))}writeX(t,e,i){e[i]=isNaN(t)?"NaN":t}readX(t){return typeof t=="string"?NaN:t}clone(){const t=new ZC;return t.x=this.x,t.y=this.y,t.z=this.z,t.m=this.m,t.spatialReference=this.spatialReference,t}copy(t){return ZC.copy(t,this),this}equals(t){if(t==null)return!1;const{x:e,y:i,z:n,m:r,spatialReference:s}=this,{z:o,m:a}=t;let{x:l,y:c,spatialReference:u}=t;if(!s.equals(u))if(s.isWebMercator&&u.isWGS84)[l,c]=o_(l,c),u=s;else{if(!s.isWGS84||!u.isWebMercator)return!1;[l,c]=Px(l,c),u=s}return e===l&&i===c&&n===o&&r===a&&s.wkid===u.wkid}offset(t,e,i){return this.x+=t,this.y+=e,i!=null&&(this.z=(this.z??0)+i),this}normalize(){if(!this.spatialReference)return this;const t=to(this.spatialReference);if(!t)return this;let e=this.x;const[i,n]=t.valid,r=2*n;let s;return e>n?(s=Math.ceil(Math.abs(e-n)/r),e-=s*r):e<i&&(s=Math.ceil(Math.abs(e-i)/r),e+=s*r),this._set("x",e),this}distance(t){return M_e(this,t)}toArray(){const t=this.hasZ,e=this.hasM;return t&&e?[this.x,this.y,this.z,this.m]:t?[this.x,this.y,this.z]:e?[this.x,this.y,this.m]:[this.x,this.y]}toJSON(t){return this.write({},t)}};h([p({readOnly:!0})],Gs.prototype,"cache",null),h([p({type:Boolean,json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],Gs.prototype,"hasM",null),h([p({type:Boolean,json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],Gs.prototype,"hasZ",null),h([p({type:Number})],Gs.prototype,"latitude",null),h([p({type:Number})],Gs.prototype,"longitude",null),h([p({type:Number,json:{type:[Number,String],write:{isRequired:!0,allowNull:!0}}}),ut(t=>isNaN(t)?t:Qa(t))],Gs.prototype,"x",void 0),h([ge("x")],Gs.prototype,"writeX",null),h([_e("x")],Gs.prototype,"readX",null),h([p({type:Number,json:{write:!0}})],Gs.prototype,"y",void 0),h([p({type:Number,json:{write:{overridePolicy(){return{enabled:this.hasZ}}}}})],Gs.prototype,"z",void 0),h([p({type:Number,json:{write:{overridePolicy(){return{enabled:this.hasM}}}}})],Gs.prototype,"m",void 0),Gs=ZC=h([P("esri.geometry.Point")],Gs),Gs.prototype.toJSON.isDefaultToJSON=!0;const pe=Gs,c3=[0,0];function rP(t,e){return e!=null&&Xs(t,e.x,e.y,e.z)}function bat(t,e){if(!e.points||e.points.length)return!1;for(const i of e.points)if(!Q_(t,i))return!1;return!0}function $_e(t,e){const{xmin:i,ymin:n,zmin:r,xmax:s,ymax:o,zmax:a}=e;return t.hasZ&&e.hasZ?Xs(t,i,n,r)&&Xs(t,i,o,r)&&Xs(t,s,o,r)&&Xs(t,s,n,r)&&Xs(t,i,n,a)&&Xs(t,i,o,a)&&Xs(t,s,o,a)&&Xs(t,s,n,a):Xs(t,i,n)&&Xs(t,i,o)&&Xs(t,s,o)&&Xs(t,s,n)}function Q_(t,e){return Xs(t,e[0],e[1])}function P_e(t,e){return Xs(t,e[0],e[1],e[2])}function Xs(t,e,i,n){return e>=t.xmin&&e<=t.xmax&&i>=t.ymin&&i<=t.ymax&&(n==null||!t.hasZ||n>=t.zmin&&n<=t.zmax)}function RQ(t,e){return c3[1]=e.y,c3[0]=e.x,k_e(t,c3)}function k_e(t,e){return DQ(t.rings,e)}function DQ(t,e){if(!t)return!1;if(O_e(t))return S9(!1,t,e);let i=!1;for(let n=0,r=t.length;n<r;n++)i=S9(i,t[n],e);return i}function O_e(t){return!Array.isArray(t[0][0])}function S9(t,e,i){const[n,r]=i;let s=t,o=0;for(let a=0,l=e.length;a<l;a++){o++,o===l&&(o=0);const[c,u]=e[a],[d,f]=e[o];(u<r&&f>=r||f<r&&u>=r)&&c+(r-u)/(f-u)*(d-c)<n&&(s=!s)}return s}function L_e(t,e){return rP(t,e)}function R_e(t,e){const i=t.hasZ&&e.hasZ;let n,r,s;if(t.xmin<=e.xmin){if(n=e.xmin,t.xmax<n)return!1}else if(n=t.xmin,e.xmax<n)return!1;if(t.ymin<=e.ymin){if(r=e.ymin,t.ymax<r)return!1}else if(r=t.ymin,e.ymax<r)return!1;if(i&&e.hasZ){if(t.zmin<=e.zmin){if(s=e.zmin,t.zmax<s)return!1}else if(s=t.zmin,e.zmax<s)return!1}return!0}function D_e(t,e){const{points:i,hasZ:n}=e,r=n?P_e:Q_;for(const s of i)if(r(t,s))return!0;return!1}const Ly=[0,0],Ry=[0,0],Dy=[0,0],Ny=[0,0],N_e=[Ly,Ry,Dy,Ny],NQ=[[Dy,Ly],[Ly,Ry],[Ry,Ny],[Ny,Dy]];function F_e(t,e){return z_e(t,e.rings)}function z_e(t,e){Ly[0]=t.xmin,Ly[1]=t.ymax,Ry[0]=t.xmax,Ry[1]=t.ymax,Dy[0]=t.xmin,Dy[1]=t.ymin,Ny[0]=t.xmax,Ny[1]=t.ymin;for(const i of N_e)if(DQ(e,i))return!0;for(const i of e){if(!i.length)continue;let n=i[0];if(Q_(t,n))return!0;for(let r=1;r<i.length;r++){const s=i[r];if(Q_(t,s)||FQ(n,s,NQ))return!0;n=s}}return!1}function V_e(t,e){Ly[0]=t.xmin,Ly[1]=t.ymax,Ry[0]=t.xmax,Ry[1]=t.ymax,Dy[0]=t.xmin,Dy[1]=t.ymin,Ny[0]=t.xmax,Ny[1]=t.ymin;const i=e.paths;for(const n of i){if(!i.length)continue;let r=n[0];if(Q_(t,r))return!0;for(let s=1;s<n.length;s++){const o=n[s];if(Q_(t,o)||FQ(r,o,NQ))return!0;r=o}}return!1}const Ir=[0,0];function j_e(t){for(let e=0;e<t.length;e++){const i=t[e];for(let r=0;r<i.length-1;r++){const s=i[r],o=i[r+1];for(let a=e+1;a<t.length;a++)for(let l=0;l<t[a].length-1;l++){const c=t[a][l],u=t[a][l+1];if(_R(s,o,c,u,Ir)&&!(Ir[0]===s[0]&&Ir[1]===s[1]||Ir[0]===c[0]&&Ir[1]===c[1]||Ir[0]===o[0]&&Ir[1]===o[1]||Ir[0]===u[0]&&Ir[1]===u[1]))return!0}}const n=i.length;if(!(n<=4))for(let r=0;r<n-3;r++){let s=n-1;r===0&&(s=n-2);const o=i[r],a=i[r+1];for(let l=r+2;l<s;l++){const c=i[l],u=i[l+1];if(_R(o,a,c,u,Ir)&&!(Ir[0]===o[0]&&Ir[1]===o[1]||Ir[0]===c[0]&&Ir[1]===c[1]||Ir[0]===a[0]&&Ir[1]===a[1]||Ir[0]===u[0]&&Ir[1]===u[1]))return!0}}}return!1}function FQ(t,e,i){for(let n=0;n<i.length;n++)if(_R(t,e,i[n][0],i[n][1]))return!0;return!1}function _R(t,e,i,n,r){const[s,o]=t,[a,l]=e,[c,u]=i,[d,f]=n,m=d-c,g=s-c,y=a-s,_=f-u,b=o-u,w=l-o,x=_*y-m*w;if(x===0)return!1;const S=(m*b-_*g)/x,T=(y*b-w*g)/x;return S>=0&&S<=1&&T>=0&&T<=1&&(r&&(r[0]=s+S*(a-s),r[1]=o+S*(l-o)),!0)}function B_e(t){switch(t){case"esriGeometryEnvelope":case"extent":return R_e;case"esriGeometryMultipoint":case"multipoint":return D_e;case"esriGeometryPoint":case"point":return L_e;case"esriGeometryPolygon":case"polygon":return F_e;case"esriGeometryPolyline":case"polyline":return V_e}}var Oa;function U_e(t){return t&&(t.declaredClass==="esri.geometry.SpatialReference"||t.wkid!=null)}function Od(t,e,i){return e==null?i:i==null?e:t(e,i)}let ur=Oa=class extends md{constructor(...t){super(...t),this.type="extent",this.xmin=0,this.ymin=0,this.mmin=void 0,this.zmin=void 0,this.xmax=0,this.ymax=0,this.mmax=void 0,this.zmax=void 0}normalizeCtorArgs(t,e,i,n,r){return U_e(t)?{spatialReference:t,xmin:0,ymin:0,xmax:0,ymax:0}:typeof t=="object"?(t.spatialReference=t.spatialReference==null?Ee.WGS84:t.spatialReference,t):{xmin:t,ymin:e,xmax:i,ymax:n,spatialReference:r??Ee.WGS84}}static fromBounds(t,e){return new Oa({xmin:t[0],ymin:t[1],xmax:t[2],ymax:t[3],spatialReference:e})}static fromPoint(t){return new Oa({xmin:t.x,ymin:t.y,zmin:t.z,xmax:t.x,ymax:t.y,zmax:t.z,spatialReference:t.spatialReference})}get cache(){return this.commitProperty("xmin"),this.commitProperty("ymin"),this.commitProperty("zmin"),this.commitProperty("mmin"),this.commitProperty("xmax"),this.commitProperty("ymax"),this.commitProperty("zmax"),this.commitProperty("mmax"),this.commitProperty("spatialReference"),{}}get center(){const t=new pe({x:.5*(this.xmin+this.xmax),y:.5*(this.ymin+this.ymax),spatialReference:this.spatialReference});return this.hasZ&&(t.z=.5*(this.zmin+this.zmax)),this.hasM&&(t.m=.5*(this.mmin+this.mmax)),t}get extent(){return this.clone()}get hasM(){return this.mmin!=null&&this.mmax!=null}get hasZ(){return this.zmin!=null&&this.zmax!=null}get height(){return Math.abs(this.ymax-this.ymin)}get width(){return Math.abs(this.xmax-this.xmin)}centerAt(t){const e=this.center;return t.z!=null&&this.hasZ?this.offset(t.x-e.x,t.y-e.y,t.z-e.z):this.offset(t.x-e.x,t.y-e.y)}clone(){const t=new Oa;return t.xmin=this.xmin,t.ymin=this.ymin,t.xmax=this.xmax,t.ymax=this.ymax,t.spatialReference=this.spatialReference,this.zmin!=null&&(t.zmin=this.zmin,t.zmax=this.zmax),this.mmin!=null&&(t.mmin=this.mmin,t.mmax=this.mmax),t}contains(t){if(!t)return!1;const e=this.spatialReference,i=t.spatialReference;return e&&i&&!e.equals(i)&&JC(e,i)&&(t=e.isWebMercator?qh(t):ny(t,!0)),t.type==="point"?rP(this,t):t.type==="extent"&&$_e(this,t)}equals(t){if(this===t)return!0;if(t==null)return!1;const e=this.spatialReference,i=t.spatialReference;return e&&i&&!e.equals(i)&&JC(e,i)&&(t=e.isWebMercator?qh(t):ny(t,!0)),this.xmin===t.xmin&&this.ymin===t.ymin&&this.zmin===t.zmin&&this.mmin===t.mmin&&this.xmax===t.xmax&&this.ymax===t.ymax&&this.zmax===t.zmax&&this.mmax===t.mmax}expand(t){const e=.5*(1-t),i=this.width*e,n=this.height*e;if(this.xmin+=i,this.ymin+=n,this.xmax-=i,this.ymax-=n,this.hasZ){const r=(this.zmax-this.zmin)*e;this.zmin+=r,this.zmax-=r}if(this.hasM){const r=(this.mmax-this.mmin)*e;this.mmin+=r,this.mmax-=r}return this}intersects(t){if(t==null)return!1;t.type==="mesh"&&(t=t.extent);const e=this.spatialReference,i=t.spatialReference;return e&&i&&!En(e,i)&&JC(e,i)&&(t=e.isWebMercator?qh(t):ny(t,!0)),B_e(t.type)(this,t)}normalize(){const t=this._normalize(!1,!0);return Array.isArray(t)?t:[t]}offset(t,e,i){return this.xmin+=t,this.ymin+=e,this.xmax+=t,this.ymax+=e,i!=null&&(this.zmin+=i,this.zmax+=i),this}shiftCentralMeridian(){return this._normalize(!0)}union(t){return this===t||(this.xmin=Math.min(this.xmin,t.xmin),this.ymin=Math.min(this.ymin,t.ymin),this.xmax=Math.max(this.xmax,t.xmax),this.ymax=Math.max(this.ymax,t.ymax),(this.hasZ||t.hasZ)&&(this.zmin=Od(Math.min,this.zmin,t.zmin),this.zmax=Od(Math.max,this.zmax,t.zmax)),(this.hasM||t.hasM)&&(this.mmin=Od(Math.min,this.mmin,t.mmin),this.mmax=Od(Math.max,this.mmax,t.mmax))),this}intersection(t){return this===t?this:t!=null&&this.intersects(t)?(this.xmin=Math.max(this.xmin,t.xmin),this.ymin=Math.max(this.ymin,t.ymin),this.xmax=Math.min(this.xmax,t.xmax),this.ymax=Math.min(this.ymax,t.ymax),(this.hasZ||t.hasZ)&&(this.zmin=Od(Math.max,this.zmin,t.zmin),this.zmax=Od(Math.min,this.zmax,t.zmax)),(this.hasM||t.hasM)&&(this.mmin=Od(Math.max,this.mmin,t.mmin),this.mmax=Od(Math.min,this.mmax,t.mmax)),this):null}toJSON(t){return this.write({},t)}_shiftCM(t=to(this.spatialReference)){if(!t||!this.spatialReference)return this;const e=this.spatialReference,i=this._getCM(t);if(i){const n=e.isWebMercator?ny(i):i;this.xmin-=i.x,this.xmax-=i.x,e.isWebMercator||(n.x=this._normalizeX(n.x,t).x),this.spatialReference=new Ee(pl((e.isWGS84?t.altTemplate:null)??t.wkTemplate,{Central_Meridian:n.x}))}return this}_getCM(t){let e=null;const[i,n]=t.valid,r=this.xmin,s=this.xmax;return r>=i&&r<=n&&s>=i&&s<=n||(e=this.center),e}_normalize(t,e,i){const n=this.spatialReference;if(!n)return this;const r=i??to(n);if(r==null)return this;const s=this._getParts(r).map(l=>l.extent);if(s.length<2)return s[0]||this;if(s.length>2)return t?this._shiftCM(r):this.set({xmin:r.valid[0],xmax:r.valid[1]});if(t)return this._shiftCM(r);if(e)return s;let o=!0,a=!0;return s.forEach(l=>{l.hasZ||(o=!1),l.hasM||(a=!1)}),{rings:s.map(l=>{const c=[[l.xmin,l.ymin],[l.xmin,l.ymax],[l.xmax,l.ymax],[l.xmax,l.ymin],[l.xmin,l.ymin]];if(o){const u=(l.zmax-l.zmin)/2;for(let d=0;d<c.length;d++)c[d].push(u)}if(a){const u=(l.mmax-l.mmin)/2;for(let d=0;d<c.length;d++)c[d].push(u)}return c}),hasZ:o,hasM:a,spatialReference:n}}_getParts(t){let e=this.cache._parts;if(!e){e=[];const{ymin:r,ymax:s,spatialReference:o}=this,a=this.width,l=this.xmin,c=this.xmax;let u;t=t||to(o);const[d,f]=t.valid;u=this._normalizeX(this.xmin,t);const m=u.x,g=u.frameId;u=this._normalizeX(this.xmax,t);const y=u.x,_=u.frameId,b=m===y&&a>0;if(a>2*f){const w=new Oa(l<c?m:y,r,f,s,o),x=new Oa(d,r,l<c?y:m,s,o),S=new Oa(0,r,f,s,o),T=new Oa(d,r,0,s,o),I=[],C=[];w.contains(S)&&I.push(g),w.contains(T)&&C.push(g),x.contains(S)&&I.push(_),x.contains(T)&&C.push(_);for(let M=g+1;M<_;M++)I.push(M),C.push(M);e.push({extent:w,frameIds:[g]},{extent:x,frameIds:[_]},{extent:S,frameIds:I},{extent:T,frameIds:C})}else m>y||b?e.push({extent:new Oa(m,r,f,s,o),frameIds:[g]},{extent:new Oa(d,r,y,s,o),frameIds:[_]}):e.push({extent:new Oa(m,r,y,s,o),frameIds:[g]});this.cache._parts=e}const i=this.hasZ,n=this.hasM;if(i||n){const r={};i&&(r.zmin=this.zmin,r.zmax=this.zmax),n&&(r.mmin=this.mmin,r.mmax=this.mmax);for(let s=0;s<e.length;s++)e[s].extent.set(r)}return e}_normalizeX(t,e){const[i,n]=e.valid,r=2*n;let s,o=0;return t>n?(s=Math.ceil(Math.abs(t-n)/r),t-=s*r,o=s):t<i&&(s=Math.ceil(Math.abs(t-i)/r),t+=s*r,o=-s),{x:t,frameId:o}}};h([p({readOnly:!0})],ur.prototype,"cache",null),h([p({readOnly:!0})],ur.prototype,"center",null),h([p({readOnly:!0})],ur.prototype,"extent",null),h([p({readOnly:!0,json:{write:{enabled:!1,overridePolicy:null}}})],ur.prototype,"hasM",null),h([p({readOnly:!0,json:{write:{enabled:!1,overridePolicy:null}}})],ur.prototype,"hasZ",null),h([p({readOnly:!0})],ur.prototype,"height",null),h([p({readOnly:!0})],ur.prototype,"width",null),h([p({type:Number,json:{type:[Number,String],write:{enabled:!0,allowNull:!0}}})],ur.prototype,"xmin",void 0),h([p({type:Number,json:{write:!0}})],ur.prototype,"ymin",void 0),h([p({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasM}}}}})],ur.prototype,"mmin",void 0),h([p({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasZ}}}}})],ur.prototype,"zmin",void 0),h([p({type:Number,json:{write:!0}})],ur.prototype,"xmax",void 0),h([p({type:Number,json:{write:!0}})],ur.prototype,"ymax",void 0),h([p({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasM}}}}})],ur.prototype,"mmax",void 0),h([p({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasZ}}}}})],ur.prototype,"zmax",void 0),ur=Oa=h([P("esri.geometry.Extent")],ur),ur.prototype.toJSON.isDefaultToJSON=!0;const Le=ur;let kx;var BX,UX;const G_e=((BX=globalThis.esriConfig)==null?void 0:BX.locale)??((UX=globalThis.dojoConfig)==null?void 0:UX.locale);function zQ(){var t;return G_e??((t=globalThis.navigator)==null?void 0:t.language)??"en"}function xr(){return kx===void 0&&(kx=zQ()),kx}function H_e(t=xr()){const e=/^([a-zA-Z]{2,3})(?:[_\-]\w+)*$/.exec(t);return e==null?void 0:e[1].toLowerCase()}const Ox=[];function FS(t){return Ox.push(t),{remove(){Ox.splice(Ox.indexOf(t),1)}}}const bR=[];function m6(t){return bR.push(t),{remove(){Ox.splice(bR.indexOf(t),1)}}}function q_e(){const t=zQ();kx!==t&&(kx=t,[...bR].forEach(e=>{e.call(null,t)}),[...Ox].forEach(e=>{e.call(null,t)}))}var GX;(GX=globalThis.addEventListener)==null||GX.call(globalThis,"languagechange",q_e);let UT;function W_e(t){return UT&&!UT.destroyed||(UT=t()),UT}var wR;const J_e=new qe({avgRating:"avg-rating",numRatings:"num-ratings",numComments:"num-comments",numViews:"num-views"});let La=wR=class extends ye{constructor(t){super(t),this.categories=null,this.disableExtraQuery=!1,this.extent=null,this.filter=null,this.num=10,this.query=null,this.sortField=null,this.start=1}get sortOrder(){return this._get("sortOrder")||"asc"}set sortOrder(t){t!=="asc"&&t!=="desc"||this._set("sortOrder",t)}clone(){return new wR({categories:this.categories?q(this.categories):null,disableExtraQuery:this.disableExtraQuery,extent:this.extent?this.extent.clone():null,filter:this.filter,num:this.num,query:this.query,sortField:this.sortField,sortOrder:this.sortOrder,start:this.start})}toRequestOptions(t,e){let i=[];this.categories&&(i=this.categories.map(o=>Array.isArray(o)?JSON.stringify(o):o));let n="";if(this.extent){const o=NS(this.extent,Ee.WGS84);o!=null&&(n=`${o.xmin},${o.ymin},${o.xmax},${o.ymax}`)}let r=this.query;!this.disableExtraQuery&&t.extraQuery&&(r="("+r+")"+t.extraQuery);const s={categories:i,bbox:n,q:r,filter:this.filter,num:this.num,sortField:null,sortOrder:null,start:this.start};return this.sortField&&(s.sortField=this.sortField.split(",").map(o=>J_e.toJSON(o.trim())).join(","),s.sortOrder=this.sortOrder),{query:{...e,...s}}}};h([p()],La.prototype,"categories",void 0),h([p()],La.prototype,"disableExtraQuery",void 0),h([p({type:Le})],La.prototype,"extent",void 0),h([p()],La.prototype,"filter",void 0),h([p()],La.prototype,"num",void 0),h([p()],La.prototype,"query",void 0),h([p()],La.prototype,"sortField",void 0),h([p()],La.prototype,"sortOrder",null),h([p()],La.prototype,"start",void 0),La=wR=h([P("esri.portal.PortalQueryParams")],La);const yu=La;let km=class extends ye{constructor(e){super(e),this.nextQueryParams=null,this.queryParams=null,this.results=null,this.total=null}};h([p()],km.prototype,"nextQueryParams",void 0),h([p()],km.prototype,"queryParams",void 0),h([p()],km.prototype,"results",void 0),h([p()],km.prototype,"total",void 0),km=h([P("esri.portal.PortalQueryResult")],km);const Z_e=km;let eh=class extends ie{constructor(e){super(e),this.created=null,this.id=null,this.portal=null,this.title=null,this.username=null}get url(){const e=this.get("portal.restUrl");return e?`${e}/content/users/${this.username}/${this.id}`:null}toJSON(){throw new V("internal:not-yet-implemented","PortalFolder.toJSON is not yet implemented")}};h([p({type:Date})],eh.prototype,"created",void 0),h([p()],eh.prototype,"id",void 0),h([p()],eh.prototype,"portal",void 0),h([p()],eh.prototype,"title",void 0),h([p({readOnly:!0})],eh.prototype,"url",null),h([p()],eh.prototype,"username",void 0),eh=h([P("esri.portal.PortalFolder")],eh);const Y_e=eh;let hr=class extends ie{constructor(e){super(e),this.access=null,this.created=null,this.description=null,this.id=null,this.isInvitationOnly=!1,this.modified=null,this.owner=null,this.portal=null,this.snippet=null,this.sortField=null,this.sortOrder=null,this.tags=null,this.title=null}get thumbnailUrl(){var n;const e=this.url,i=this.thumbnail;return e&&i&&this.portal?(n=this.portal)==null?void 0:n.normalizeUrl(`${e}/info/${i}?f=json`):null}get url(){const e=this.get("portal.restUrl");return e?e+"/community/groups/"+this.id:null}fetchCategorySchema(e){return Lr(this.portal).request(this.url+"/categorySchema",e).then(i=>{const n=i.categorySchema||[];return n.some(r=>r.source==="contentCategorySetsGroupQuery.LivingAtlas")?this._fetchCategorySchemaSet("LivingAtlas",e):n})}fetchMembers(e){return Lr(this.portal).request(this.url+"/users",e)}getThumbnailUrl(e){let i=this.thumbnailUrl;return i&&e&&(i+=`&w=${e}`),i}toJSON(){throw new V("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented")}queryItems(e,i){let n=fn(yu,e);const r=Lr(this.portal);return parseFloat(r.currentVersion)>5?(n=n||new yu,r.queryPortal(`/content/groups/${this.id}/search`,n,"PortalItem",i)):(n=n?n.clone():new yu,n.query="group:"+this.id+(n.query?" "+n.query:""),r.queryItems(n,i))}_fetchCategorySchemaSet(e,i){const n=Lr(this.portal);return n.fetchSelf(n.authMode,!0,i).then(r=>{const s=r.contentCategorySetsGroupQuery;if(s){const o=new yu;return o.disableExtraQuery=!0,o.num=1,o.query=s,n.queryGroups(o,i)}throw new V("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery value not found")}).then(r=>{if(r.total){const s=r.results[0],o=new yu;return o.num=1,o.query=`typekeywords:"${e}"`,s.queryItems(o,i)}throw new V("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery group not found")}).then(r=>r.total?r.results[0].fetchData("json",i).then(s=>{const o=s&&s.categorySchema;return o&&o.length?o:[]}):[])}};h([p()],hr.prototype,"access",void 0),h([p({type:Date})],hr.prototype,"created",void 0),h([p()],hr.prototype,"description",void 0),h([p()],hr.prototype,"id",void 0),h([p()],hr.prototype,"isInvitationOnly",void 0),h([p({type:Date})],hr.prototype,"modified",void 0),h([p()],hr.prototype,"owner",void 0),h([p()],hr.prototype,"portal",void 0),h([p()],hr.prototype,"snippet",void 0),h([p()],hr.prototype,"sortField",void 0),h([p()],hr.prototype,"sortOrder",void 0),h([p()],hr.prototype,"tags",void 0),h([p()],hr.prototype,"thumbnail",void 0),h([p({readOnly:!0})],hr.prototype,"thumbnailUrl",null),h([p()],hr.prototype,"title",void 0),h([p({readOnly:!0})],hr.prototype,"url",null),hr=h([P("esri.portal.PortalGroup")],hr);const xR=hr,X_e=Object.freeze(Object.defineProperty({__proto__:null,default:xR},Symbol.toStringTag,{value:"Module"}));var SR;let Ei=SR=class extends ie{constructor(...t){super(...t),this.access=null,this.created=null,this.culture=null,this.description=null,this.email=null,this.fullName=null,this.modified=null,this.orgId=null,this.portal=null,this.preferredView=null,this.privileges=null,this.region=null,this.role=null,this.roleId=null,this.sourceJSON=null,this.units=null,this.username=null,this.userType=null}get thumbnailUrl(){const t=this.url,e=this.thumbnail;return t&&e?this.portal.normalizeUrl(`${t}/info/${e}?f=json`):null}get userContentUrl(){const t=this.get("portal.restUrl");return t?`${t}/content/users/${this.username}`:null}get url(){const t=this.get("portal.restUrl");return t?`${t}/community/users/${this.username}`:null}addItem(t){const e=t&&t.item,i=t&&t.data,n=t&&t.folder,r={method:"post"};e&&(r.query=e.createPostQuery(),i!=null&&(typeof i=="string"?r.query.text=i:typeof i=="object"&&(r.query.text=JSON.stringify(i))));let s=this.userContentUrl;return n&&(s+="/"+(typeof n=="string"?n:n.id)),this.portal.request(s+"/addItem",r).then(o=>(e.id=o.id,e.portal=this.portal,e.loaded?e.reload():e.load()))}deleteItem(t){let e=this.userContentUrl;return t.ownerFolder&&(e+="/"+t.ownerFolder),this.portal.request(e+`/items/${t.id}/delete`,{method:"post"}).then(()=>{t.id=null,t.portal=null})}deleteItems(t){const e=this.userContentUrl+"/deleteItems",i=t.map(n=>n.id);if(i.length){const n={method:"post",query:{items:i.join(",")}};return this.portal.request(e,n).then(()=>{t.forEach(r=>{r.id=null,r.portal=null})})}return Promise.resolve(void 0)}fetchFolders(){const t={query:{num:1}};return this.portal.request(this.userContentUrl??"",t).then(e=>{let i;return i=e&&e.folders?e.folders.map(n=>{const r=Y_e.fromJSON(n);return r.portal=this.portal,r}):[],i})}fetchGroups(){return this.portal.request(this.url??"").then(t=>{let e;return e=t&&t.groups?t.groups.map(i=>{const n=xR.fromJSON(i);return n.portal=this.portal,n}):[],e})}fetchItems(t){const e=t??{};let i,n=this.userContentUrl??"";return e.folder&&(n+="/"+e.folder.id),Y(()=>Promise.resolve().then(()=>VQ),void 0,import.meta.url).then(({default:r})=>{i=r;const s={folders:!1,num:e.num||10,start:e.start||1,sortField:e.sortField||"created",sortOrder:e.sortOrder||"asc"};return this.portal.request(n,{query:s})}).then(r=>{let s;return r&&r.items?(s=r.items.map(o=>{const a=i.fromJSON(o);return a.portal=this.portal,a}),Promise.all(s.map(o=>o.load())).catch(o=>o).then(()=>({items:s,nextStart:r.nextStart,total:r.total}))):{items:[],nextStart:-1,total:0}})}fetchTags(){return this.portal.request(this.url+"/tags").then(t=>t.tags)}getThumbnailUrl(t){let e=this.thumbnailUrl;return e&&t&&(e+=`&w=${t}`),e}queryFavorites(t){return this.favGroupId?(this._favGroup||(this._favGroup=new xR({id:this.favGroupId,portal:this.portal})),this._favGroup.queryItems(t)):Promise.reject(new V("internal:unknown","Unknown internal error",{internalError:"Unknown favGroupId"}))}toJSON(){throw new V("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented")}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");const e=new SR;return e.sourceJSON=t,e.read(t),e}};h([p()],Ei.prototype,"access",void 0),h([p({type:Date})],Ei.prototype,"created",void 0),h([p()],Ei.prototype,"culture",void 0),h([p()],Ei.prototype,"description",void 0),h([p()],Ei.prototype,"email",void 0),h([p()],Ei.prototype,"favGroupId",void 0),h([p()],Ei.prototype,"fullName",void 0),h([p({type:Date})],Ei.prototype,"modified",void 0),h([p()],Ei.prototype,"orgId",void 0),h([p()],Ei.prototype,"portal",void 0),h([p()],Ei.prototype,"preferredView",void 0),h([p()],Ei.prototype,"privileges",void 0),h([p()],Ei.prototype,"region",void 0),h([p()],Ei.prototype,"role",void 0),h([p()],Ei.prototype,"roleId",void 0),h([p()],Ei.prototype,"sourceJSON",void 0),h([p()],Ei.prototype,"thumbnail",void 0),h([p({readOnly:!0})],Ei.prototype,"thumbnailUrl",null),h([p()],Ei.prototype,"units",void 0),h([p({readOnly:!0})],Ei.prototype,"userContentUrl",null),h([p({readOnly:!0})],Ei.prototype,"url",null),h([p()],Ei.prototype,"username",void 0),h([p()],Ei.prototype,"userType",void 0),Ei=SR=h([P("esri.portal.PortalUser")],Ei);const g6=Ei,K_e=Object.freeze(Object.defineProperty({__proto__:null,default:g6},Symbol.toStringTag,{value:"Module"}));var th;let GT;const T9={PortalGroup:()=>Y(()=>Promise.resolve().then(()=>X_e),void 0,import.meta.url),PortalItem:()=>Y(()=>Promise.resolve().then(()=>VQ),void 0,import.meta.url),PortalUser:()=>Y(()=>Promise.resolve().then(()=>K_e),void 0,import.meta.url)};let fe=th=class extends RS(rd){constructor(t){super(t),this._esriIdCredentialCreateHandle=null,this.access=null,this.allSSL=!1,this.authMode="auto",this.authorizedCrossOriginDomains=null,this.basemapGalleryGroupQuery=null,this.basemapGalleryGroupQuery3D=null,this.bingKey=null,this.canListApps=!1,this.canListData=!1,this.canListPreProvisionedItems=!1,this.canProvisionDirectPurchase=!1,this.canSearchPublic=!0,this.canShareBingPublic=!1,this.canSharePublic=!1,this.canSignInArcGIS=!1,this.canSignInIDP=!1,this.colorSetsGroupQuery=null,this.commentsEnabled=!1,this.created=null,this.culture=null,this.customBaseUrl=null,this.defaultBasemap=null,this.defaultDevBasemap=null,this.defaultExtent=null,this.defaultVectorBasemap=null,this.description=null,this.devBasemapGalleryGroupQuery=null,this.eueiEnabled=null,this.featuredGroups=null,this.featuredItemsGroupQuery=null,this.galleryTemplatesGroupQuery=null,this.livingAtlasGroupQuery=null,this.hasCategorySchema=!1,this.helperServices=null,this.homePageFeaturedContent=null,this.homePageFeaturedContentCount=null,this.httpPort=null,this.httpsPort=null,this.id=null,this.ipCntryCode=null,this.isPortal=!1,this.isReadOnly=!1,this.layerTemplatesGroupQuery=null,this.maxTokenExpirationMinutes=null,this.modified=null,this.name=null,this.portalHostname=null,this.portalMode=null,this.portalProperties=null,this.region=null,this.rotatorPanels=null,this.showHomePageDescription=!1,this.sourceJSON=null,this.supportsHostedServices=!1,this.symbolSetsGroupQuery=null,this.templatesGroupQuery=null,this.units=null,this.url=Tt.portalUrl,this.urlKey=null,this.user=null,this.use3dBasemaps=!0,this.useStandardizedQuery=!1,this.useVectorBasemaps=!1,this.vectorBasemapGalleryGroupQuery=null}normalizeCtorArgs(t){return typeof t=="string"?{url:t}:t}destroy(){I9.unregister(this),this.defaultBasemap=Je(this.defaultBasemap),this.defaultDevBasemap=Je(this.defaultDevBasemap),this.defaultVectorBasemap=Je(this.defaultVectorBasemap),this._esriIdCredentialCreateHandle=Ri(this._esriIdCredentialCreateHandle)}readAuthorizedCrossOriginDomains(t){if(t)for(const e of t)Tt.request.trustedServers.includes(e)||Tt.request.trustedServers.push(e);return t}readDefaultBasemap(t){return this._readBasemap(t)}readDefaultDevBasemap(t){return this._readBasemap(t)}readDefaultVectorBasemap(t){return this._readBasemap(t)}get extraQuery(){const t=!(this.user&&this.user.orgId)||this.canSearchPublic;return this.id&&!t?` AND orgid:${this.id}`:null}get isOrganization(){return!!this.access}get itemPageUrl(){return this.url?`${this.url}/home/item.html`:null}get restUrl(){let t=this.url;if(t){const e=t.indexOf("/sharing");t=e>0?t.substring(0,e):this.url.replace(/\/+$/,""),t+="/sharing/rest"}return t}get thumbnailUrl(){const t=this.restUrl,e=this.thumbnail;return t&&e?this._normalizeSSL(t+"/portals/self/resources/"+e):null}readUrlKey(t){return t&&t.toLowerCase()}readUser(t){let e=null;return t&&(e=g6.fromJSON(t),e.portal=this),e}load(t){const e=Y(()=>Promise.resolve().then(()=>xbe),void 0,import.meta.url).then(({default:i})=>{Vt(t),GT=i}).then(()=>this.sourceJSON?this.sourceJSON:this.fetchSelf(this.authMode,!1,t)).then(i=>{var n;if(ct){const r=ct;this.credential=r.findCredential(this.restUrl),this.credential||this.authMode!==th.AUTH_MODE_AUTO||((n=this._esriIdCredentialCreateHandle)==null||n.remove(),this._esriIdCredentialCreateHandle=r.on("credential-create",Q_e(new WeakRef(this))),I9.register(this,this._esriIdCredentialCreateHandle,this))}this.sourceJSON=i,this.read(i)});return this.addResolvingPromise(e),Promise.resolve(this)}async createElevationLayers(){await this.load();const t=this._getHelperService("defaultElevationLayers"),e=(await Y(()=>import("./ElevationLayer-c0ee542c.js"),["./ElevationLayer-c0ee542c.js","./ArcGISCachedService-ae622342.js","./TileInfoTilemapCache-c93fb380.js","./WorkerHandle-6635cad1.js"],import.meta.url)).default;return t?t.map(i=>new e({id:i.id,url:i.url})):[]}async fetchBasemaps(t,e){const i=await this._fetchBasemaps(t,e);if((e==null?void 0:e.include3d)===!0&&this.use3dBasemaps!==!1){const n=await this._fetchBasemaps3D(t,e);i.unshift(...n)}return i}fetchCategorySchema(t){return this.hasCategorySchema?this.request(this.restUrl+"/portals/self/categorySchema",t).then(e=>e.categorySchema):zo(t)?Promise.reject(li()):Promise.resolve([])}fetchFeaturedGroups(t){const e=this.featuredGroups,i=new yu;if(i.num=100,i.sortField="title",e&&e.length){const n=[];for(const r of e)n.push(`(title:"${r.title}" AND owner:${r.owner})`);return i.query=n.join(" OR "),this.queryGroups(i,t).then(r=>r.results)}return zo(t)?Promise.reject(li()):Promise.resolve([])}fetchRegions(t){var i;const e=((i=this.user)==null?void 0:i.culture)||this.culture||xr();return this.request(this.restUrl+"/portals/regions",{...t,query:{culture:e}})}fetchSettings(t){var i;const e=((i=this.user)==null?void 0:i.culture)||this.culture||xr();return this.request(this.restUrl+"/portals/self/settings",{...t,query:{culture:e}})}static getDefault(){return W_e(()=>new th)}queryGroups(t,e){return this.queryPortal("/community/groups",t,"PortalGroup",e)}queryItems(t,e){return this.queryPortal("/search",t,"PortalItem",e)}queryUsers(t,e){return t.sortField||(t.sortField="username"),this.queryPortal("/community/users",t,"PortalUser",e)}fetchSelf(t=this.authMode,e=!1,i){const n=this.restUrl+"/portals/self",r={authMode:t,query:{culture:xr().toLowerCase()},...i};return r.authMode==="auto"&&(r.authMode="no-prompt"),e&&(r.query.default=!0),this.request(n,r)}queryPortal(t,e,i,n){const r=fn(yu,e),s=o=>this.request(this.restUrl+t,{...r.toRequestOptions(this),...n}).then(a=>{const l=r.clone();return l.start=a.nextStart,new Z_e({nextQueryParams:l,queryParams:r,total:a.total,results:th._resultsToTypedArray(o,{portal:this},a,n)})}).then(a=>Promise.all(a.results.map(l=>typeof l.when=="function"?l.when():a)).then(()=>a,l=>($o(l),a)));return i&&T9[i]?T9[i]().then(({default:o})=>(Vt(n),s(o))):s()}signIn(){if(this.authMode===th.AUTH_MODE_ANONYMOUS)return Promise.reject(new V("portal:invalid-auth-mode",`Current "authMode"' is "${this.authMode}"`));if(this.loadStatus==="failed")return Promise.reject(this.loadError);const t=e=>Promise.resolve().then(()=>this.loadStatus==="not-loaded"?(e||(this.authMode="immediate"),this.load().then(()=>null)):this.loadStatus==="loading"?this.load().then(()=>this.credential?null:(this.credential=e,this.fetchSelf("immediate"))):this.user&&this.credential===e?null:(this.credential=e,this.fetchSelf("immediate"))).then(i=>{i&&(this.sourceJSON=i,this.read(i))});return ct?ct.getCredential(this.restUrl).then(e=>t(e)):t(this.credential)}normalizeUrl(t){const e=this.credential&&this.credential.token;return this._normalizeSSL(e?t+(t.includes("?")?"&":"?")+"token="+e:t)}requestToTypedArray(t,e,i){return this.request(t,e).then(n=>{const r=th._resultsToTypedArray(i,{portal:this},n);return Promise.all(r.map(s=>typeof s.when=="function"?s.when():n)).then(()=>r,()=>r)})}request(t,e={}){const i={f:"json",...e.query},{authMode:n=this.authMode===th.AUTH_MODE_ANONYMOUS?"anonymous":"auto",body:r=null,cacheBust:s=!1,method:o="auto",responseType:a="json",signal:l}=e,c={authMode:n,body:r,cacheBust:s,method:o,query:i,responseType:a,timeout:0,signal:l};return gt(this._normalizeSSL(t),c).then(u=>u.data)}toJSON(){throw new V("internal:not-yet-implemented","Portal.toJSON is not yet implemented")}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");return new th({sourceJSON:t})}_getHelperService(t){const e=this.helperServices&&this.helperServices[t];if(!e)throw new V("portal:service-not-found",`The \`helperServices\` do not include an entry named "${t}"`);return e}async _fetchBasemaps(t,e){const i=new yu;i.query=t||(Tt.apiKey&&kQ(this.url)?this.devBasemapGalleryGroupQuery:this.useVectorBasemaps?this.vectorBasemapGalleryGroupQuery:this.basemapGalleryGroupQuery),i.disableExtraQuery=!0;const n=await this.queryGroups(i,e);if(!n.total)return[];const r=n.results[0];i.num=100,i.query='type:"Web Map" -type:"Web Application"',i.sortField=r.sortField||"name",i.sortOrder=r.sortOrder||"desc";const s=await r.queryItems(i,e);return s.total?s.results.filter(o=>o.type==="Web Map").map(o=>new GT({portalItem:o})):[]}async _fetchBasemaps3D(t,e){const i=t||this.basemapGalleryGroupQuery3D;if(!i)return[];const n=new yu({query:i,disableExtraQuery:!0}),r=await this.queryGroups(n,e);if(!r.total)return[];const s=r.results[0];n.num=100,n.query='type:"Web Scene"',n.sortField=s.sortField||"name",n.sortOrder=s.sortOrder||"desc";const o=await s.queryItems(n,e);return o.total?o.results.filter(a=>a.type==="Web Scene").map(a=>new GT({portalItem:a})):[]}_normalizeSSL(t){return t.replace(/^http:/i,"https:").replace(":7080",":7443")}_readBasemap(t){if(t){const e=GT.fromJSON(t);return e.portalItem={portal:this},e}return null}static _resultsToTypedArray(t,e,i,n){let r=[];if(i){const s=n!=null?n.signal:null;r=i.listings||i.notifications||i.userInvitations||i.tags||i.items||i.groups||i.comments||i.provisions||i.results||i.relatedItems||i,(t||e)&&(r=r.map(o=>{const a=Object.assign(t?t.fromJSON(o):o,e);return typeof a.load=="function"&&a.load(s),a}))}else r=[];return r}};fe.AUTH_MODE_ANONYMOUS="anonymous",fe.AUTH_MODE_AUTO="auto",fe.AUTH_MODE_IMMEDIATE="immediate",h([p()],fe.prototype,"access",void 0),h([p()],fe.prototype,"allSSL",void 0),h([p()],fe.prototype,"authMode",void 0),h([p()],fe.prototype,"authorizedCrossOriginDomains",void 0),h([_e("authorizedCrossOriginDomains")],fe.prototype,"readAuthorizedCrossOriginDomains",null),h([p()],fe.prototype,"basemapGalleryGroupQuery",void 0),h([p({json:{name:"3DBasemapGalleryGroupQuery"}})],fe.prototype,"basemapGalleryGroupQuery3D",void 0),h([p()],fe.prototype,"bingKey",void 0),h([p()],fe.prototype,"canListApps",void 0),h([p()],fe.prototype,"canListData",void 0),h([p()],fe.prototype,"canListPreProvisionedItems",void 0),h([p()],fe.prototype,"canProvisionDirectPurchase",void 0),h([p()],fe.prototype,"canSearchPublic",void 0),h([p()],fe.prototype,"canShareBingPublic",void 0),h([p()],fe.prototype,"canSharePublic",void 0),h([p()],fe.prototype,"canSignInArcGIS",void 0),h([p()],fe.prototype,"canSignInIDP",void 0),h([p()],fe.prototype,"colorSetsGroupQuery",void 0),h([p()],fe.prototype,"commentsEnabled",void 0),h([p({type:Date})],fe.prototype,"created",void 0),h([p()],fe.prototype,"credential",void 0),h([p()],fe.prototype,"culture",void 0),h([p()],fe.prototype,"currentVersion",void 0),h([p()],fe.prototype,"customBaseUrl",void 0),h([p()],fe.prototype,"defaultBasemap",void 0),h([_e("defaultBasemap")],fe.prototype,"readDefaultBasemap",null),h([p()],fe.prototype,"defaultDevBasemap",void 0),h([_e("defaultDevBasemap")],fe.prototype,"readDefaultDevBasemap",null),h([p({type:Le})],fe.prototype,"defaultExtent",void 0),h([p()],fe.prototype,"defaultVectorBasemap",void 0),h([_e("defaultVectorBasemap")],fe.prototype,"readDefaultVectorBasemap",null),h([p()],fe.prototype,"description",void 0),h([p()],fe.prototype,"devBasemapGalleryGroupQuery",void 0),h([p()],fe.prototype,"eueiEnabled",void 0),h([p({readOnly:!0})],fe.prototype,"extraQuery",null),h([p()],fe.prototype,"featuredGroups",void 0),h([p()],fe.prototype,"featuredItemsGroupQuery",void 0),h([p()],fe.prototype,"galleryTemplatesGroupQuery",void 0),h([p()],fe.prototype,"livingAtlasGroupQuery",void 0),h([p()],fe.prototype,"hasCategorySchema",void 0),h([p()],fe.prototype,"helpBase",void 0),h([p()],fe.prototype,"helperServices",void 0),h([p()],fe.prototype,"helpMap",void 0),h([p()],fe.prototype,"homePageFeaturedContent",void 0),h([p()],fe.prototype,"homePageFeaturedContentCount",void 0),h([p()],fe.prototype,"httpPort",void 0),h([p()],fe.prototype,"httpsPort",void 0),h([p()],fe.prototype,"id",void 0),h([p()],fe.prototype,"ipCntryCode",void 0),h([p({readOnly:!0})],fe.prototype,"isOrganization",null),h([p()],fe.prototype,"isPortal",void 0),h([p()],fe.prototype,"isReadOnly",void 0),h([p({readOnly:!0})],fe.prototype,"itemPageUrl",null),h([p()],fe.prototype,"layerTemplatesGroupQuery",void 0),h([p()],fe.prototype,"maxTokenExpirationMinutes",void 0),h([p({type:Date})],fe.prototype,"modified",void 0),h([p()],fe.prototype,"name",void 0),h([p()],fe.prototype,"portalHostname",void 0),h([p()],fe.prototype,"portalMode",void 0),h([p()],fe.prototype,"portalProperties",void 0),h([p()],fe.prototype,"region",void 0),h([p({readOnly:!0})],fe.prototype,"restUrl",null),h([p()],fe.prototype,"rotatorPanels",void 0),h([p()],fe.prototype,"showHomePageDescription",void 0),h([p()],fe.prototype,"sourceJSON",void 0),h([p()],fe.prototype,"staticImagesUrl",void 0),h([p({json:{name:"2DStylesGroupQuery"}})],fe.prototype,"stylesGroupQuery2d",void 0),h([p({json:{name:"stylesGroupQuery"}})],fe.prototype,"stylesGroupQuery3d",void 0),h([p()],fe.prototype,"supportsHostedServices",void 0),h([p()],fe.prototype,"symbolSetsGroupQuery",void 0),h([p()],fe.prototype,"templatesGroupQuery",void 0),h([p()],fe.prototype,"thumbnail",void 0),h([p({readOnly:!0})],fe.prototype,"thumbnailUrl",null),h([p()],fe.prototype,"units",void 0),h([p()],fe.prototype,"url",void 0),h([p()],fe.prototype,"urlKey",void 0),h([_e("urlKey")],fe.prototype,"readUrlKey",null),h([p()],fe.prototype,"user",void 0),h([_e("user")],fe.prototype,"readUser",null),h([p()],fe.prototype,"use3dBasemaps",void 0),h([p()],fe.prototype,"useStandardizedQuery",void 0),h([p()],fe.prototype,"useVectorBasemaps",void 0),h([p()],fe.prototype,"vectorBasemapGalleryGroupQuery",void 0),fe=th=h([P("esri.portal.Portal")],fe);const nr=fe,I9=new FinalizationRegistry(t=>{t.remove()});function Q_e(t){const e=ct;return()=>{const i=t.deref();i&&e.findCredential(i.restUrl)&&i.signIn().catch(()=>{})}}const ebe=ne.getLogger("esri.assets");function xt(t){if(!Tt.assetsPath)throw ebe.errorOnce("The API assets location needs to be set using config.assetsPath. More information: https://arcg.is/1OzLe50"),new V("assets:path-not-set","config.assetsPath is not set");return tP(Tt.assetsPath,t)}let ih=class extends ye{constructor(e){super(e),this.portalItem=null}normalizeCtorArgs(e){return e&&e.portalItem&&e.path?{...e,path:this._normalizePath(e.path,e.portalItem)}:e}set path(e){e!=null&&ya(e)?ne.getLogger(this).error("portalitemresource:invalid-path","A portal item resource path must be relative"):this._set("path",e)}_castPath(e){return this._normalizePath(e,this.portalItem)}get url(){return this.portalItem&&this.path?`${this.portalItem.itemUrl}/resources/${this.path}`:null}get cdnUrl(){return this.portalItem&&this.path?`${this.portalItem.itemCdnUrl}/resources/${this.path}`:null}get itemRelativeUrl(){return this.portalItem&&this.path?`./resources/${this.path}`:null}fetch(e="json",i){const n=this.cdnUrl;if(n==null)throw new V("portal-item-resource:fetch","Portal item resource does not refer to a valid item or path");return this.portalItem.portal.request(n,{responseType:e,query:{token:this.portalItem.apiKey},signal:i==null?void 0:i.signal})}async update(e,i){const{addOrUpdateResource:n}=await Y(()=>import("./resourceUtils-c01dc622.js"),[],import.meta.url);return n(this,"update",e,i)}hasPath(){return this.path!=null}_normalizePath(e,i){return e==null?e:(e=e.replace(/^\/+/,""),i!=null&&ya(e)&&(e=Kz(e,i.itemUrl)),e==null?void 0:e.replace(/^\/+/,"").replace(/^(\.\/)?resources\//,""))}};h([p()],ih.prototype,"portalItem",void 0),h([p({type:String,value:null})],ih.prototype,"path",null),h([ut("path")],ih.prototype,"_castPath",null),h([p({type:String,readOnly:!0})],ih.prototype,"url",null),h([p({type:String,readOnly:!0})],ih.prototype,"cdnUrl",null),h([p({type:String,readOnly:!0})],ih.prototype,"itemRelativeUrl",null),ih=h([P("esri.portal.PortalItemResource")],ih);const tbe=ih;let cw=class extends ye{constructor(e){super(e),this.created=null,this.rating=null}};h([p()],cw.prototype,"created",void 0),h([p()],cw.prototype,"rating",void 0),cw=h([P("esri.portal.PortalRating")],cw);const u3=cw;var Om;const ibe=new Set(["Map Service","Feature Service","Feature Collection","Scene Service","Image Service","Stream Service","Vector Tile Service","GeoJson","CSV","KML","WFS","WMTS","WMS","Feed"]),nbe=new Set(["KML","GeoJson","CSV"]);let et=Om=class extends RS(rd){static from(t){return t0(Om,t)}constructor(t){super(t),this.access=null,this.accessInformation=null,this.apiKey=null,this.applicationProxies=null,this.avgRating=null,this.categories=null,this.created=null,this.culture=null,this.description=null,this.extent=null,this.groupCategories=null,this.id=null,this.isOrgItem=!1,this.itemControl=null,this.licenseInfo=null,this.modified=null,this.name=null,this.numComments=null,this.numRatings=null,this.numViews=null,this.owner=null,this.ownerFolder=null,this.portal=null,this.screenshots=null,this.size=null,this.snippet=null,this.sourceJSON=null,this.sourceUrl=null,this.spatialReference=null,this.tags=null,this.title=null,this.type=null,this.typeKeywords=null,this.url=null}destroy(){this.portal=null}get displayName(){const t=this.type,e=this.typeKeywords||[];let i=t;return t==="Feature Service"||t==="Feature Collection"?i=e.includes("Table")?"Table":e.includes("Route Layer")?"Route Layer":e.includes("Markup")?"Markup":"Feature Layer":t==="Image Service"?i=e.includes("Elevation 3D Layer")?"Elevation Layer":e.includes("Tiled Imagery")?"Tiled Imagery Layer":"Imagery Layer":t==="Scene Service"?i="Scene Layer":t==="Video Service"?i="Video Layer":t==="Scene Package"?i="Scene Layer Package":t==="Stream Service"?i="Feature Layer":t==="Geoprocessing Service"?i=e.includes("Web Tool")?"Tool":"Geoprocessing Service":t==="Geocoding Service"?i="Locator":t==="Geoenrichment Service"?i="GeoEnrichment Service":t==="Microsoft Powerpoint"?i="Microsoft PowerPoint":t==="GeoJson"?i="GeoJSON":t==="Globe Service"?i="Globe Layer":t==="Vector Tile Service"?i="Tile Layer":t==="netCDF"?i="NetCDF":t==="Map Service"?i=e.includes("Spatiotemporal")||!e.includes("Hosted Service")&&!e.includes("Tiled")||e.includes("Relational")?"Map Image Layer":"Tile Layer":t&&t.toLowerCase().includes("add in")?i=t.replaceAll(/(add in)/gi,"Add-In"):t==="datastore catalog service"?i="Big Data File Share":t==="Compact Tile Package"?i="Tile Package (tpkx)":t==="OGCFeatureServer"?i="OGC Feature Layer":t==="web mapping application"&&e.includes("configurableApp")?i="Instant App":t==="Insights Page"?i="Insights Report":t==="Excalibur Imagery Project"&&(i="Excalibur Project"),i}readExtent(t){return t&&t.length?new Le(t[0][0],t[0][1],t[1][0],t[1][1]):null}get iconUrl(){const t=this.type&&this.type.toLowerCase()||"",e=this.typeKeywords||[],i="esri/images/portal/",n="16";let r,s=!1,o=!1,a=!1,l=!1,c=!1,u=!1;return t.indexOf("service")>0||t==="feature collection"||t==="kml"||t==="wms"||t==="wmts"||t==="wfs"?(s=e.includes("Hosted Service"),t==="feature service"||t==="feature collection"||t==="kml"||t==="wfs"?(o=e.includes("Table"),a=e.includes("Route Layer"),l=e.includes("Markup"),c=e.includes("Spatiotemporal"),u=e.includes("UtilityNetwork"),r=c&&o?"spatiotemporaltable":o?"table":a?"routelayer":l?"markup":c?"spatiotemporal":s?"featureshosted":u?"utilitynetwork":"features"):r=t==="map service"||t==="wms"||t==="wmts"?s||e.includes("Tiled")||t==="wmts"?"maptiles":"mapimages":t==="scene service"?e.includes("Line")?"sceneweblayerline":e.includes("3DObject")?"sceneweblayermultipatch":e.includes("Point")?"sceneweblayerpoint":e.includes("IntegratedMesh")?"sceneweblayermesh":e.includes("PointCloud")?"sceneweblayerpointcloud":e.includes("Polygon")?"sceneweblayerpolygon":e.includes("Building")?"sceneweblayerbuilding":e.includes("Voxel")?"sceneweblayervoxel":"sceneweblayer":t==="image service"?e.includes("Elevation 3D Layer")?"elevationlayer":e.includes("Tiled Imagery")?"tiledimagerylayer":"imagery":t==="stream service"?"streamlayer":t==="video service"?e.includes("Live Stream")?"livestreamvideolayer":"videolayer":t==="vector tile service"?"vectortile":t==="datastore catalog service"?"datastorecollection":t==="geocoding service"?"geocodeservice":t==="geoprocessing service"?e.includes("Web Tool")?"tool":"layers":t==="geodata service"?"geodataservice":"layers"):r=t==="web map"||t==="cityengine web scene"?"maps":t==="web scene"?e.includes("ViewingMode-Local")?"webscenelocal":"websceneglobal":t==="web mapping application"&&e.includes("configurableApp")?"instantapps":t==="web mapping application"||t==="mobile application"||t==="application"||t==="operation view"||t==="desktop application"?"apps":t==="map document"||t==="map package"||t==="published map"||t==="scene document"||t==="globe document"||t==="basemap package"||t==="mobile basemap package"||t==="mobile map package"||t==="project package"||t==="project template"||t==="pro map"||t==="layout"||t==="layer"&&e.includes("ArcGIS Pro")||t==="explorer map"&&e.indexOf("Explorer Document")?"mapsgray":t==="service definition"||t==="csv"||t==="shapefile"||t==="cad drawing"||t==="geojson"||t==="netcdf"||t==="administrative report"?"datafiles":t==="explorer add in"||t==="desktop add in"||t==="windows viewer add in"||t==="windows viewer configuration"?"appsgray":t==="360 vr experience"?"360vr":t==="arcgis pro add in"||t==="arcgis pro configuration"?"addindesktop":t==="rule package"||t==="file geodatabase"||t==="sqlite geodatabase"||t==="csv collection"||t==="kml collection"||t==="windows mobile package"||t==="map template"||t==="desktop application template"||t==="gml"||t==="arcpad package"||t==="code sample"||t==="form"||t==="document link"||t==="earth configuration"||t==="operations dashboard add in"||t==="rules package"||t==="image"||t==="workflow manager package"||t==="explorer map"&&e.includes("Explorer Mapping Application")||e.includes("Document")?"datafilesgray":t==="network analysis service"||t==="geoprocessing service"||t==="geodata service"||t==="geometry service"||t==="geoprocessing package"||t==="locator package"||t==="geoprocessing sample"||t==="workflow manager service"?"toolsgray":t==="layer"||t==="layer package"||t==="explorer layer"?"layersgray":t==="scene package"?"scenepackage":t==="mobile scene package"?"mobilescenepackage":t==="tile package"||t==="compact tile package"?"tilepackage":t==="task file"?"taskfile":t==="report template"?"report-template":t==="statistical data collection"?"statisticaldatacollection":t==="insights workbook"?"workbook":t==="insights model"?"insightsmodel":t==="insights page"?"insightspage":t==="insights theme"?"insightstheme":t==="hub initiative"?"hubinitiative":t==="hubpage"?"hubpage":t==="hub event"?"hubevent":t==="hub site application"?"hubsite":t==="hub project"?"hubproject":t==="relational database connection"?"relationaldatabaseconnection":t==="big data file share"?"datastorecollection":t==="image collection"?"imagecollection":t==="style"?"style":t==="desktop style"?"desktopstyle":t==="dashboard"?"dashboard":t==="raster function template"?"rasterprocessingtemplate":t==="vector tile package"?"vectortilepackage":t==="ortho mapping project"?"orthomappingproject":t==="ortho mapping template"?"orthomappingtemplate":t==="solution"?"solutions":t==="geopackage"?"geopackage":t==="deep learning package"?"deeplearningpackage":t==="real time analytic"?"realtimeanalytics":t==="big data analytic"?"bigdataanalytics":t==="feed"?"feed":t==="excalibur imagery project"?"excaliburimageryproject":t==="notebook"?"notebook":t==="storymap"?"storymap":t==="survey123 add in"?"survey123addin":t==="mission"?"mission":t==="mission report"?"missionreport":t==="quickcapture project"?"quickcaptureproject":t==="pro report"?"proreport":t==="pro report template"?"proreporttemplate":t==="urban model"?"urbanmodel":t==="web experience"?"experiencebuilder":t==="web experience template"?"webexperiencetemplate":t==="experience builder widget"?"experiencebuilderwidget":t==="experience builder widget package"?"experiencebuilderwidgetpackage":t==="workflow"?"workflow":t==="insights script"?"insightsscript":t==="kernel gateway connection"?"kernelgatewayconnection":t==="hub initiative template"?"hubinitiativetemplate":t==="storymap theme"?"storymaptheme":t==="knowledge graph"?"knowledgegraph":t==="native application"?"nativeapp":t==="native application installer"?"nativeappinstaller":t==="link chart"?"linkchart":t==="investigation"?"investigation":t==="ogcfeatureserver"?"features":t==="pro project"?"proproject":t==="insights workbook package"?"insightsworkbookpackage":t==="apache parquet"?"apacheparquet":t==="notebook code snippets"||t==="notebook code snippet library"?"notebookcodesnippets":t==="suitability model"?"suitabilitymodel":t==="esri classifier definition"?"classifierdefinition":t==="esri classification schema"?"classificationschema":t==="insights data engineering workbook"?"dataengineeringworkbook":t==="insights data engineering model"?"dataengineeringmodel":t==="deep learning studio project"?"deeplearningproject":t==="discussion"?"discussion":t==="allsource project"?"allsourceproject":t==="api key"?"apikey":t==="data pipeline"?"datapipelines":"maps",r?xt(i+r+n+".png"):null}get isLayer(){return this.type!=null&&ibe.has(this.type)}get itemCdnUrl(){let t=this.itemUrl;return t&&ct&&!ct.findCredential(t)&&(t=ct._normalizeAGOLorgDomain(t),t=t.replace(/^https?:\/\/www\.arcgis\.com/,"https://cdn.arcgis.com"),t=t.replace(/^https?:\/\/devext\.arcgis\.com/,"https://cdndev.arcgis.com"),t=t.replace(/^https?:\/\/qaext\.arcgis\.com/,"https://cdnqa.arcgis.com")),t}get itemPageUrl(){var e;const t=(e=this.portal)==null?void 0:e.itemPageUrl;return t&&this.id?`${t}?id=${this.id}`:null}get itemUrl(){var e;const t=(e=this.portal)==null?void 0:e.restUrl;return t&&this.id?`${t}/content/items/${this.id}`:null}get thumbnailUrl(){var i;const t=this.itemUrl,e=this.thumbnail;return t&&e?((i=this.portal)==null?void 0:i.normalizeUrl(`${t}/info/${e}?f=json`))??null:null}get userItemUrl(){const t=this.get("portal.restUrl");if(!t)return null;const e=this.owner||this.get("portal.user.username");return e?`${t}/content/users/${this.ownerFolder?`${e}/${this.ownerFolder}`:e}/items/${this.id}`:null}load(t){const e=this.portal??(this.portal=nr.getDefault()),i=e.load(t).then(()=>this.sourceJSON?this.sourceJSON:this.id&&this.itemUrl?e.request(this.itemUrl,{signal:t!=null?t.signal:null,query:{token:this.apiKey}}):{}).then(n=>{this.sourceJSON=n,this.read(n)});return this.addResolvingPromise(i),Promise.resolve(this)}async addRating(t){const e={method:"post",query:{}};return t instanceof u3&&(t=t.rating),t==null||isNaN(t)||typeof t!="number"||(e.query.rating=t),this.portal?(await this.portal.request(this.itemUrl+"/addRating",e),new u3({rating:t,created:new Date})):null}clone(){const t={access:this.access,accessInformation:this.accessInformation,applicationProxies:q(this.applicationProxies),avgRating:this.avgRating,categories:q(this.categories),created:q(this.created),culture:this.culture,description:this.description,extent:q(this.extent),groupCategories:q(this.groupCategories),id:this.id,itemControl:this.itemControl,licenseInfo:this.licenseInfo,modified:q(this.modified),name:this.name,numComments:this.numComments,numRatings:this.numRatings,numViews:this.numViews,owner:this.owner,ownerFolder:this.ownerFolder,portal:this.portal,screenshots:q(this.screenshots),size:this.size,snippet:this.snippet,sourceUrl:this.sourceUrl,spatialReference:this.spatialReference,tags:q(this.tags),thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:q(this.typeKeywords),url:this.url};this.loaded&&(t.loadStatus="loaded");const e=new Om({sourceJSON:this.sourceJSON}).set(t);return e._set("isOrgItem",this.isOrgItem),e}createPostQuery(){var i;const t=this.toJSON();for(const n of["tags","typeKeywords","categories"])t[n]=(i=t[n])==null?void 0:i.join(", ");const{extent:e}=t;return e&&(t.extent=JSON.stringify(e)),t}async deleteRating(){await Lr(this.portal).request(this.itemUrl+"/deleteRating",{method:"post"})}fetchData(t="json",e){return Lr(this.portal).request(this.itemUrl+"/data",{responseType:t,...e,query:{token:this.apiKey}})}async fetchRating(t){const e=await Lr(this.portal).request(this.itemUrl+"/rating",{query:{token:this.apiKey},...t});return e.rating!=null?(e.created=new Date(e.created),new u3(e)):null}fetchRelatedItems(t,e){return Lr(this.portal).requestToTypedArray(this.itemUrl+"/relatedItems",{query:{...t,token:this.apiKey},...e},Om)}getThumbnailUrl(t){let e=this.thumbnailUrl;return e&&t&&(e+=`&w=${t}`),e}reload(){return Lr(this.portal).request(this.itemUrl??"",{cacheBust:!0,query:{token:this.apiKey}}).then(t=>(this.sourceJSON=t,this.read(t),this))}update(t){return this.id?this.load().then(()=>Lr(this.portal).signIn()).then(()=>{const e=t&&t.data,i={method:"post"};i.query=this.createPostQuery();for(const n in i.query)i.query[n]===null&&(i.query[n]="");return i.query.clearEmptyFields=!0,e!=null&&(typeof e=="string"?i.query.text=e:typeof e=="object"&&(i.query.text=JSON.stringify(e))),this.portal.request(`${this.userItemUrl}/update`,i).then(()=>this.reload())}):Promise.reject(new V("portal:item-does-not-exist","The item does not exist yet and cannot be updated"))}async copy(t){if(!this.id)throw new V("portal:item-does-not-exist","The item does not exist yet");await this.load();const{portal:e,itemUrl:i}=this;await Lr(e).signIn();const{copyResources:n,folder:r,tags:s,title:o}=t||{},a={method:"post",query:{copyPrivateResources:n==="all",folder:typeof r=="string"?r:r==null?void 0:r.id,includeResources:!!n,tags:s==null?void 0:s.join(","),title:o}},{itemId:l}=await e.request(`${i}/copy`,a);return new Om({id:l,portal:e})}updateThumbnail(t){return this.id?this.load().then(()=>this.portal.signIn()).then(()=>{const e=t.thumbnail,i=t.filename,n={method:"post"};if(typeof e=="string")n0(e)?n.query={data:e}:n.query={url:tl(e)},i!=null&&(n.query.filename=i);else{const r=new FormData;i!=null?r.append("file",e,i):r.append("file",e),n.body=r}return this.portal.request(`${this.userItemUrl}/updateThumbnail`,n).then(()=>this.reload())}):Promise.reject(new V("portal:item-does-not-exist","The item does not exist yet and cannot be updated"))}async fetchResources(t={},e){const{fetchResources:i}=await Y(()=>import("./resourceUtils-c01dc622.js"),[],import.meta.url);return i(this,t,e)}async addResource(t,e,i){const{addOrUpdateResource:n}=await Y(()=>import("./resourceUtils-c01dc622.js"),[],import.meta.url);return t.portalItem=this,n(t,"add",e,i)}async removeResource(t,e){const{removeResource:i}=await Y(()=>import("./resourceUtils-c01dc622.js"),[],import.meta.url);if(t.portalItem&&t.portalItem.itemUrl!==this.itemUrl)throw new V("removeresource:portal-item-mismatch","The portal item associated with the provided resource does not match the item");return i(this,t,e)}async removeAllResources(t){const{removeAllResources:e}=await Y(()=>import("./resourceUtils-c01dc622.js"),[],import.meta.url);return e(this,t)}resourceFromPath(t){return new tbe({portalItem:this,path:t})}toJSON(){const t=this.extent,e={accessInformation:this.accessInformation,categories:q(this.categories),created:this.created&&this.created.getTime(),description:this.description,extent:t&&[[t.xmin,t.ymin],[t.xmax,t.ymax]],id:this.id,isOrgItem:this.isOrgItem,licenseInfo:this.licenseInfo,modified:this.modified&&this.modified.getTime(),name:this.name,owner:this.owner,ownerFolder:this.ownerFolder,snippet:this.snippet,sourceUrl:this.sourceUrl,spatialReference:this.spatialReference,tags:q(this.tags),thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:q(this.typeKeywords),url:this.url};return eK(e)}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");return new Om({sourceJSON:t})}_getPostQuery(){const t=this.toJSON();for(const e in t)e==="tags"&&t[e]!==null&&(t[e]=t[e].join(", ")),e==="typeKeywords"&&t[e]!==null&&(t[e]=t[e].join(", ")),e==="extent"&&t[e]&&(t[e]=JSON.stringify(t[e]));return t}};h([p({type:["private","shared","org","public"]})],et.prototype,"access",void 0),h([p()],et.prototype,"accessInformation",void 0),h([p({type:String})],et.prototype,"apiKey",void 0),h([p({json:{read:{source:"appProxies"}}})],et.prototype,"applicationProxies",void 0),h([p()],et.prototype,"avgRating",void 0),h([p()],et.prototype,"categories",void 0),h([p({type:Date})],et.prototype,"created",void 0),h([p()],et.prototype,"culture",void 0),h([p()],et.prototype,"description",void 0),h([p({readOnly:!0})],et.prototype,"displayName",null),h([p({type:Le})],et.prototype,"extent",void 0),h([_e("extent")],et.prototype,"readExtent",null),h([p()],et.prototype,"groupCategories",void 0),h([p({readOnly:!0})],et.prototype,"iconUrl",null),h([p()],et.prototype,"id",void 0),h([p({readOnly:!0})],et.prototype,"isLayer",null),h([p({type:Boolean,readOnly:!0})],et.prototype,"isOrgItem",void 0),h([p()],et.prototype,"itemControl",void 0),h([p({readOnly:!0})],et.prototype,"itemPageUrl",null),h([p({readOnly:!0})],et.prototype,"itemUrl",null),h([p()],et.prototype,"licenseInfo",void 0),h([p({type:Date})],et.prototype,"modified",void 0),h([p()],et.prototype,"name",void 0),h([p()],et.prototype,"numComments",void 0),h([p()],et.prototype,"numRatings",void 0),h([p()],et.prototype,"numViews",void 0),h([p()],et.prototype,"owner",void 0),h([p()],et.prototype,"ownerFolder",void 0),h([p({type:nr})],et.prototype,"portal",void 0),h([p()],et.prototype,"screenshots",void 0),h([p()],et.prototype,"size",void 0),h([p()],et.prototype,"snippet",void 0),h([p()],et.prototype,"sourceJSON",void 0),h([p({type:String})],et.prototype,"sourceUrl",void 0),h([p({type:String})],et.prototype,"spatialReference",void 0),h([p()],et.prototype,"tags",void 0),h([p()],et.prototype,"thumbnail",void 0),h([p({readOnly:!0})],et.prototype,"thumbnailUrl",null),h([p()],et.prototype,"title",void 0),h([p()],et.prototype,"type",void 0),h([p()],et.prototype,"typeKeywords",void 0),h([p({type:String,json:{read(t,e){var i;if(nbe.has(e.type)){const n=(i=this.portal)==null?void 0:i.restUrl;t||(t=n&&this.id?`${n}/content/items/${this.id}/data`:null)}return t}}})],et.prototype,"url",void 0),h([p({readOnly:!0})],et.prototype,"userItemUrl",null),et=Om=h([P("esri.portal.PortalItem")],et);const Lx=et,VQ=Object.freeze(Object.defineProperty({__proto__:null,default:Lx},Symbol.toStringTag,{value:"Module"})),C9=/^([a-z]{2})(?:[-_]([A-Za-z]{2}))?$/,rbe={ar:!0,bg:!0,bs:!0,ca:!0,cs:!0,da:!0,de:!0,el:!0,en:!0,es:!0,et:!0,fi:!0,fr:!0,he:!0,hr:!0,hu:!0,id:!0,it:!0,ja:!0,ko:!0,lt:!0,lv:!0,nb:!0,nl:!0,pl:!0,"pt-BR":!0,"pt-PT":!0,ro:!0,ru:!0,sk:!0,sl:!0,sr:!0,sv:!0,th:!0,tr:!0,uk:!0,vi:!0,"zh-CN":!0,"zh-HK":!0,"zh-TW":!0};function M9(t){return t in rbe}const uw=[],E_=new Map;function E9(t){for(const e of E_.keys())jQ(t.pattern,e)&&E_.delete(e)}function sbe(t){return uw.includes(t)||(E9(t),uw.unshift(t)),{remove(){const e=uw.indexOf(t);e>-1&&(uw.splice(e,1),E9(t))}}}async function fy(t){const e=xr();E_.has(t)||E_.set(t,abe(t,e));const i=E_.get(t);return i&&await lbe.add(i),i}function obe(t){if(!C9.test(t))return null;const e=C9.exec(t);if(e===null)return null;const[,i,n]=e,r=i+(n?"-"+n.toUpperCase():"");return M9(r)?r:M9(i)?i:null}async function abe(t,e){const i=[];for(const n of uw)if(jQ(n.pattern,t))try{return await n.fetchMessageBundle(t,e)}catch(r){i.push(r)}throw i.length?new V("intl:message-bundle-error",`Errors occurred while loading "${t}"`,{errors:i}):new V("intl:no-message-bundle-loader",`No loader found for message bundle "${t}"`)}function jQ(t,e){return typeof t=="string"?e.startsWith(t):t.test(e)}m6(()=>{E_.clear()});const lbe=new class{constructor(){this._numLoading=0,this._dfd=null}async waitForAll(){this._dfd&&await this._dfd.promise}add(t){return this._increase(),t.then(()=>this._decrease(),()=>this._decrease()),this.waitForAll()}_increase(){this._numLoading++,this._dfd||(this._dfd=xc())}_decrease(){this._numLoading=Math.max(this._numLoading-1,0),this._dfd&&this._numLoading===0&&(this._dfd.resolve(),this._dfd=null)}};async function cbe(t){if(!t)return;const e=t.includes("-vector")?t.slice(0,t.indexOf("-vector")):t,i=await fy("esri/t9n/basemaps");return i[t]||i[e]}const eb={streets:{id:"streets",classic:!0,deprecated:!0,get thumbnailUrl(){return xt("esri/images/basemap/streets.jpg")},baseMapLayers:[{id:"streets-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Street Map",showLegend:!1,visibility:!0,opacity:1}]},satellite:{id:"satellite",classic:!0,get thumbnailUrl(){return xt("esri/images/basemap/satellite.jpg")},baseMapLayers:[{id:"satellite-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1}]},hybrid:{id:"hybrid",classic:!0,get thumbnailUrl(){return xt("esri/images/basemap/hybrid.jpg")},baseMapLayers:[{id:"hybrid-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1},{id:"hybrid-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/30d6b8271e1849cd9c3042060001f425/resources/styles/root.json",layerType:"VectorTileLayer",title:"Hybrid Reference Layer",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},terrain:{id:"terrain",classic:!0,get thumbnailUrl(){return xt("esri/images/basemap/terrain.jpg")},baseMapLayers:[{id:"terrain-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Terrain Base",showLegend:!1,visibility:!0,opacity:1},{id:"terrain-reference-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Reference_Overlay/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Reference Overlay",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},topo:{id:"topo",classic:!0,deprecated:!0,get thumbnailUrl(){return xt("esri/images/basemap/topo.jpg")},baseMapLayers:[{id:"topo-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Topo Map",showLegend:!1,visibility:!0,opacity:1}]},gray:{id:"gray",classic:!0,deprecated:!0,get thumbnailUrl(){return xt("esri/images/basemap/gray.jpg")},baseMapLayers:[{id:"gray-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Light Gray Base",showLegend:!1,visibility:!0,opacity:1},{id:"gray-reference-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Reference/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Light Gray Reference",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},"dark-gray":{id:"dark-gray",classic:!0,deprecated:!0,get thumbnailUrl(){return xt("esri/images/basemap/dark-gray.jpg")},baseMapLayers:[{id:"dark-gray-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Dark Gray Base",showLegend:!1,visibility:!0,opacity:1},{id:"dark-gray-reference-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Reference/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Dark Gray Reference",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},oceans:{id:"oceans",classic:!0,get thumbnailUrl(){return xt("esri/images/basemap/oceans.jpg")},baseMapLayers:[{id:"oceans-base-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Base",showLegend:!1,visibility:!0,opacity:1},{id:"oceans-reference-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Reference/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Reference",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},"national-geographic":{id:"national-geographic",classic:!0,deprecated:!0,get thumbnailUrl(){return xt("esri/images/basemap/national-geographic.jpg")},baseMapLayers:[{id:"national-geographic-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer",title:"NatGeo World Map",showLegend:!1,layerType:"ArcGISTiledMapServiceLayer",visibility:!0,opacity:1}]},osm:{id:"osm",classic:!0,get thumbnailUrl(){return xt("esri/images/basemap/osm.jpg")},baseMapLayers:[{id:"osm-base-layer",layerType:"OpenStreetMap",title:"Open Street Map",showLegend:!1,visibility:!0,opacity:1}]},"dark-gray-vector":{id:"dark-gray-vector",classic:!0,get thumbnailUrl(){return xt("esri/images/basemap/dark-gray-vector.jpg")},baseMapLayers:[{id:"dark-gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/5e9b3685f4c24d8781073dd928ebda50/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Base",visibility:!0,opacity:1},{id:"dark-gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/747cb7a5329c478cbe6981076cc879c5/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Reference",isReference:!0,visibility:!0,opacity:1}]},"gray-vector":{id:"gray-vector",classic:!0,get thumbnailUrl(){return xt("esri/images/basemap/gray-vector.jpg")},baseMapLayers:[{id:"gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/291da5eab3a0412593b66d384379f89f/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Base",visibility:!0,opacity:1},{id:"gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/1768e8369a214dfab4e2167d5c5f2454/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Reference",isReference:!0,visibility:!0,opacity:1}]},"streets-vector":{id:"streets-vector",classic:!0,get thumbnailUrl(){return xt("esri/images/basemap/streets-vector.jpg")},baseMapLayers:[{id:"streets-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/de26a3cf4cc9451298ea173c4b324736/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets",visibility:!0,opacity:1}]},"topo-vector":{id:"topo-vector",classic:!0,get thumbnailUrl(){return xt("esri/images/basemap/topo-vector.jpg")},baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"topo-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/7dc6cea0b1764a1f9af2e679f642f0f5/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Topo",visibility:!0,opacity:1}]},"streets-night-vector":{id:"streets-night-vector",classic:!0,get thumbnailUrl(){return xt("esri/images/basemap/streets-night.jpg")},baseMapLayers:[{id:"streets-night-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/86f556a2d1fd468181855a35e344567f/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Night",visibility:!0,opacity:1}]},"streets-relief-vector":{id:"streets-relief-vector",classic:!0,get thumbnailUrl(){return xt("esri/images/basemap/streets-relief.jpg")},baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"streets-relief-vector-base-layer",styleUrl:"//www.arcgis.com/sharing/rest/content/items/b266e6d17fc345b498345613930fbd76/resources/styles/root.json",title:"World Streets Relief",layerType:"VectorTileLayer",visibility:!0,opacity:1}]},"streets-navigation-vector":{id:"streets-navigation-vector",classic:!0,get thumbnailUrl(){return xt("esri/images/basemap/streets-navigation.jpg")},baseMapLayers:[{id:"streets-navigation-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/63c47b7177f946b49902c24129b87252/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Navigation",visibility:!0,opacity:1}]},"arcgis-imagery":{get thumbnailUrl(){return xt("esri/images/basemap/hybrid.jpg")},title:"Imagery Hybrid",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Imagery",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/World_Imagery/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Imagery:Labels",title:"Hybrid Reference Layer",isReference:!0}]},"arcgis-imagery-standard":{get thumbnailUrl(){return xt("esri/images/basemap/satellite.jpg")},title:"Imagery",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Imagery",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/World_Imagery/MapServer"}]},"arcgis-imagery-labels":{title:"Hybrid [Reference]",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Imagery:Labels",title:"Hybrid Reference Layer",isReference:!0}]},"arcgis-light-gray":{get thumbnailUrl(){return xt("esri/images/basemap/gray-vector.jpg")},title:"Light Gray Canvas",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:LightGray:Base",title:"Light Gray Canvas Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:LightGray:Labels",title:"Light Gray Canvas Labels",isReference:!0}]},"arcgis-dark-gray":{get thumbnailUrl(){return xt("esri/images/basemap/dark-gray.jpg")},title:"Dark Gray Canvas",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:DarkGray:Base",title:"Dark Gray Canvas Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:DarkGray:Labels",title:"Dark Gray Canvas Labels",isReference:!0}]},"arcgis-navigation":{get thumbnailUrl(){return xt("esri/images/basemap/streets-navigation.jpg")},title:"Navigation",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Navigation",title:"World Navigation Map"}]},"arcgis-navigation-night":{title:"Navigation (Dark Mode)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:NavigationNight",title:"World Navigation Map (Dark Mode)"}]},"arcgis-streets":{get thumbnailUrl(){return xt("esri/images/basemap/streets-vector.jpg")},title:"Streets",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Streets",title:"World Street Map"}]},"arcgis-streets-night":{get thumbnailUrl(){return xt("esri/images/basemap/streets-night.jpg")},title:"Streets (Night)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:StreetsNight",title:"World Street Map (Night)"}]},"arcgis-streets-relief":{get thumbnailUrl(){return xt("esri/images/basemap/streets-relief.jpg")},title:"Streets (with Relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:StreetsRelief:Base",title:"World Street Map (with Relief)"}]},"arcgis-topographic":{get thumbnailUrl(){return xt("esri/images/basemap/topo.jpg")},title:"Topographic",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Topographic:Base",title:"World Topographic Map"}]},"arcgis-oceans":{get thumbnailUrl(){return xt("esri/images/basemap/oceans.jpg")},title:"Oceans",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Ocean Base",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Oceans:Labels",title:"World Ocean Reference",isReference:!0}]},"osm-standard":{title:"OpenStreetMap",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:Standard",title:"OpenStreetMap"}]},"osm-standard-relief":{title:"OpenStreetMap (with relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:StandardRelief:Base",layerType:"VectorTileLayer",title:"OpenStreetMap Relief Base"}]},"osm-streets":{title:"OpenStreetMap (Streets)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:Streets",title:"OpenStreetMap (Streets)"}]},"osm-streets-relief":{title:"OpenStreetMap (Streets with relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:StreetsRelief:Base",layerType:"VectorTileLayer",title:"OpenStreetMap Relief Base"}]},"osm-light-gray":{title:"OpenStreetMap (Light Gray Canvas)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:LightGray:Base",title:"OSM (Light Gray Base)"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:LightGray:Labels",title:"OSM (Light Gray Reference)",isReference:!0}]},"osm-dark-gray":{title:"OpenStreetMap (Dark Gray Canvas)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:DarkGray:Base",title:"OSM (Dark Gray Base)"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:DarkGray:Labels",title:"OSM (Dark Gray Reference)",isReference:!0}]},"arcgis-terrain":{title:"Terrain with Labels",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Terrain:Base",title:"World Terrain Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Terrain:Detail",title:"World Terrain Reference",isReference:!0}]},"arcgis-community":{title:"Community",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Community",title:"Community"}]},"arcgis-charted-territory":{title:"Charted Territory",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ChartedTerritory:Base",title:"Charted Territory"}]},"arcgis-colored-pencil":{title:"Colored Pencil",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ColoredPencil",title:"Colored Pencil"}]},"arcgis-nova":{title:"Nova",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Nova",title:"Nova"}]},"arcgis-modern-antique":{title:"Modern Antique",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ModernAntique:Base",title:"Modern Antique"}]},"arcgis-midcentury":{title:"Mid-Century",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Midcentury",title:"Mid-Century"}]},"arcgis-newspaper":{title:"Newspaper",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Newspaper",title:"Newspaper"}]},"arcgis-hillshade-light":{title:"Hillshade",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"}]},"arcgis-hillshade-dark":{title:"Hillshade (Dark)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade (Dark)",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade_Dark/MapServer"}]},"arcgis-human-geography":{title:"Human Geography",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeography:Base",title:"Human Geography Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeography:Detail",title:"Human Geography Detail",isReference:!0},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeography:Label",title:"Human Geography Label",isReference:!0}]},"arcgis-human-geography-dark":{title:"Human Geography (Dark)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeographyDark:Base",title:"Human Geography Dark Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeographyDark:Detail",title:"Human Geography Dark Detail",isReference:!0},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeographyDark:Label",title:"Human Geography Dark Label",isReference:!0}]}};function BQ(t){return t!=null&&typeof t=="object"&&"type"in t&&t.type==="feature"}const Cat={Point:"SceneLayer","3DObject":"SceneLayer",IntegratedMesh:"IntegratedMeshLayer",PointCloud:"PointCloudLayer",Building:"BuildingSceneLayer"};function UQ(t){const e=t==null?void 0:t.type;return e==="building-scene"||e==="integrated-mesh"||e==="point-cloud"||e==="scene"}function y6(t){var e;return(t==null?void 0:t.type)==="feature"&&!t.url&&((e=t.source)==null?void 0:e.type)==="memory"}function Mat(t){var e;return(t==null?void 0:t.type)==="feature"&&((e=t.source)==null?void 0:e.type)==="feature-layer"}async function GQ(t,e){const i=ct==null?void 0:ct.findServerInfo(t);if((i==null?void 0:i.currentVersion)!=null)return i.owningSystemUrl||null;const n=t.toLowerCase().indexOf("/rest/services");if(n===-1)return null;const r=`${t.substring(0,n)}/rest/info`,s=e!=null?e.signal:null,{data:o}=await gt(r,{query:{f:"json"},responseType:"json",signal:s});return(o==null?void 0:o.owningSystemUrl)||null}function ube(t){if(!("capabilities"in t))return!1;switch(t.type){case"csv":case"feature":case"geojson":case"imagery":case"knowledge-graph-sublayer":case"ogc-feature":case"oriented-imagery":case"scene":case"subtype-group":case"subtype-sublayer":case"wfs":return!0;default:return!1}}function tf(t){return ube(t)?"effectiveCapabilities"in t?t.effectiveCapabilities:t.capabilities:null}function hbe(t){if(!("editingEnabled"in t))return!1;switch(t.type){case"csv":case"feature":case"geojson":case"oriented-imagery":case"scene":case"subtype-group":case"subtype-sublayer":return!0;default:return!1}}function dbe(t){return!!hbe(t)&&("effectiveEditingEnabled"in t?t.effectiveEditingEnabled:t.editingEnabled)}const pbe=new Set(["bing-maps","imagery","imagery-tile","map-image","open-street-map","tile","unknown","unsupported","vector-tile","web-tile","wms","wmts"]),fbe=new Set(["csv","feature","geo-rss","geojson","group","imagery","imagery-tile","kml","map-image","map-notes","media","ogc-feature","route","stream","subtype-group","tile","unknown","unsupported","vector-tile","web-tile","wfs","wms","wmts"]);function mbe(t){return t.layerContainerType==="basemap"?pbe:t.layerContainerType==="operational-layers"?fbe:null}function gbe(t,e){if(e.restrictedWebMapWriting){const i=mbe(e);return i==null||i.has(t.type)&&!y6(t)}return!0}function ybe(t,e){if(e)if(y6(t)){const i=AS("featureCollection.layers",e),n=i&&i[0]&&i[0].layerDefinition;n&&A9(t,n)}else t.type!=="group"&&A9(t,e)}function A9(t,e){"maxScale"in t&&(e.maxScale=GE(t.maxScale)??void 0),"minScale"in t&&(e.minScale=GE(t.minScale)??void 0)}function vbe(t,e){if(ybe(t,e),e&&("blendMode"in t&&(e.blendMode=t.blendMode,e.blendMode==="normal"&&delete e.blendMode),e.opacity=GE(t.opacity)??void 0,e.title=t.title||"Layer",e.visibility=t.visible,"legendEnabled"in t&&t.type!=="wmts"))if(y6(t)){const i=e.featureCollection;i&&(i.showLegend=t.legendEnabled)}else e.showLegend=t.legendEnabled}function $9(t,e,i){if(!("write"in t)||!t.write)return i&&i.messages&&i.messages.push(new V("layer:unsupported",`Layers (${t.title}, ${t.id}) of type '${t.declaredClass}' cannot be persisted`,{layer:t})),null;if(gbe(t,i)){const n={};return t.write(n,i)?n:null}return e!=null&&vbe(t,e=q(e)),e}var YC;let _be=0;const HQ="esri.Basemap";let Ra=YC=class extends RS(rd){constructor(t){super(t),this.id=null,this.portalItem=null,this.spatialReference=null,this.thumbnailUrl=null,this.title="Basemap",this.id=Date.now().toString(16)+"-basemap-"+_be++,this.baseLayers=new xe,this.referenceLayers=new xe;const e=n=>{n.parent&&n.parent!==this&&"remove"in n.parent&&n.parent.remove(n),n.parent=this,n.type==="elevation"&&ne.getLogger(this).error(`Layer '${n.title}, id:${n.id}' of type '${n.type}' is not supported as a basemap layer and will therefore be ignored.`)},i=n=>{n.parent=null};this.addHandles([this.baseLayers.on("after-add",n=>e(n.item)),this.referenceLayers.on("after-add",n=>e(n.item)),this.baseLayers.on("after-remove",n=>i(n.item)),this.referenceLayers.on("after-remove",n=>i(n.item))])}initialize(){this.when().catch(t=>{ne.getLogger(this).error("#load()",`Failed to load basemap (title: '${this.title}', id: '${this.id}')`,t)}),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}destroy(){var i;const t=this.baseLayers.removeAll();for(const n of t)n.destroy();const e=this.referenceLayers.removeAll();for(const n of e)n.destroy();this.baseLayers.destroy(),this.referenceLayers.destroy(),(i=this.portalItem)==null||i.destroy(),this.portalItem=null}normalizeCtorArgs(t){return t&&"resourceInfo"in t&&(this._set("resourceInfo",t.resourceInfo),delete(t={...t}).resourceInfo),t}set baseLayers(t){this._set("baseLayers",Of(t,this._get("baseLayers")))}_writeBaseLayers(t,e,i){const n=[];t&&(i={...i,layerContainerType:"basemap"},this.baseLayers.forEach(r=>{const s=$9(r,i.webmap?i.webmap.getLayerJSONFromResourceInfo(r):null,i);s!=null&&n.push(s)}),this.referenceLayers.forEach(r=>{const s=$9(r,i.webmap?i.webmap.getLayerJSONFromResourceInfo(r):null,i);s!=null&&(r.type!=="scene"&&(s.isReference=!0),n.push(s))})),e.baseMapLayers=n}set referenceLayers(t){this._set("referenceLayers",Of(t,this._get("referenceLayers")))}writeTitle(t,e){e.title=t||"Basemap"}load(t){return this.addResolvingPromise(this._loadFromSource(t)),Promise.resolve(this)}loadAll(){return aQ(this,t=>{t(this.baseLayers,this.referenceLayers)})}clone(){const t={id:this.id,title:this.title,portalItem:this.portalItem,baseLayers:this.baseLayers.map(e=>AE(e)?e.clone():e),referenceLayers:this.referenceLayers.map(e=>AE(e)?e.clone():e)};return this.loaded&&(t.loadStatus="loaded"),new YC({resourceInfo:this.resourceInfo}).set(t)}read(t,e){this.resourceInfo||this._set("resourceInfo",{data:t,context:e}),super.read(t,e)}write(t,e){return t=t||{},e&&e.origin||(e={origin:"web-map",...e}),super.write(t,e),!this.loaded&&this.resourceInfo&&this.resourceInfo.data.baseMapLayers&&(t.baseMapLayers=this.resourceInfo.data.baseMapLayers.map(i=>{const n=q(i);return n.url&&Pu(n.url)&&(n.url=`https:${n.url}`),n.templateUrl&&Pu(n.templateUrl)&&(n.templateUrl=`https:${n.templateUrl}`),n})),t}async _loadFromSource(t){const{resourceInfo:e,portalItem:i}=this;Vt(t);const n=[];if(e){const r=e.context?e.context.url:null;if(n.push(this._loadLayersFromJSON(e.data,r,t)),e.data.id&&!e.data.title){const s=e.data.id;n.push(cbe(s).then(o=>{o&&this.read({title:o},e.context)}))}}else i&&n.push(this._loadFromItem(i,t));await Promise.all(n)}async _loadLayersFromJSON(t,e,i){const n=this.resourceInfo&&this.resourceInfo.context,r=this.portalItem&&this.portalItem.portal||n&&n.portal||null,s=wbe[(n==null?void 0:n.origin)||""]??"web-map",{populateOperationalLayers:o}=await Y(()=>import("./layersCreator-9b6b32fc.js"),["./layersCreator-9b6b32fc.js","./lazyLayerLoader-722c0802.js","./portalLayers-ccf3da0c.js","./layersLoader-cf53bd10.js","./fetchService-3a21abab.js","./jsonContext-491a2ecb.js","./styleUtils-fd6677de.js"],import.meta.url),a=[];if(Vt(i),t.baseMapLayers&&Array.isArray(t.baseMapLayers)){const l={context:{origin:s,url:e,portal:r,layerContainerType:"basemap"},defaultLayerType:"DefaultTileLayer"},c=f=>s==="web-scene"&&f.layerType==="ArcGISSceneServiceLayer"||f.isReference,u=o(this.baseLayers,t.baseMapLayers.filter(f=>!c(f)),l);a.push(u);const d=o(this.referenceLayers,t.baseMapLayers.filter(c),l);a.push(d)}await Sn(a)}async _loadFromItem(t,e){const i=await t.load(e),n=await i.fetchData("json",e),r=ir(t.itemUrl??"");return this._set("resourceInfo",{data:n.baseMap??{},context:{origin:bbe[t.type||""]??"web-map",portal:t.portal||nr.getDefault(),url:r}}),this.read(this.resourceInfo.data,this.resourceInfo.context),this.read({spatialReference:n.spatialReference},this.resourceInfo.context),this.read({title:t.title,thumbnailUrl:t.thumbnailUrl},{origin:"portal-item",portal:t.portal||nr.getDefault(),url:r}),this._loadLayersFromJSON(this.resourceInfo.data,r,e)}static fromId(t){const e=eb[t];if(!e)return null;if(e.deprecated){let i=null;t==="dark-gray"?i="dark-gray-vector":t==="gray"?i="gray-vector":t==="streets"?i="streets-vector":t==="topo"&&(i="topo-vector"),M2(ne.getLogger(HQ),`The ${t} basemap has entered mature support and is no longer being updated.`,{replacement:i,see:"https://arcg.is/1iq8aD",warnOnce:!0})}return YC.fromJSON(e)}};h([p({json:{write:{ignoreOrigin:!0,target:"baseMapLayers",writer(t,e,i,n){this._writeBaseLayers(t,e,n)}},origins:{"web-scene":{write:{ignoreOrigin:!0,target:{baseMapLayers:{type:xe}},writer(t,e,i,n){this._writeBaseLayers(t,e,n)}}}}}})],Ra.prototype,"baseLayers",null),h([p({type:String,json:{origins:{"web-scene":{write:!0}}}})],Ra.prototype,"id",void 0),h([p({type:Lx})],Ra.prototype,"portalItem",void 0),h([p()],Ra.prototype,"referenceLayers",null),h([p({readOnly:!0})],Ra.prototype,"resourceInfo",void 0),h([p({type:Ee})],Ra.prototype,"spatialReference",void 0),h([p()],Ra.prototype,"thumbnailUrl",void 0),h([p({type:String,json:{origins:{"web-scene":{write:{isRequired:!0}}}}})],Ra.prototype,"title",void 0),h([ge("title")],Ra.prototype,"writeTitle",null),Ra=YC=h([P(HQ)],Ra);const bbe={"Web Scene":"web-scene","Web Map":"web-map","Link Chart":"link-chart"},wbe={"web-scene":"web-scene","web-map":"web-map","link-chart":"link-chart"},KE=Ra,xbe=Object.freeze(Object.defineProperty({__proto__:null,default:KE},Symbol.toStringTag,{value:"Module"})),QE={transparent:[0,0,0,0],black:[0,0,0,1],silver:[192,192,192,1],gray:[128,128,128,1],white:[255,255,255,1],maroon:[128,0,0,1],red:[255,0,0,1],purple:[128,0,128,1],fuchsia:[255,0,255,1],green:[0,128,0,1],lime:[0,255,0,1],olive:[128,128,0,1],yellow:[255,255,0,1],navy:[0,0,128,1],blue:[0,0,255,1],teal:[0,128,128,1],aqua:[0,255,255,1],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],blanchedalmond:[255,235,205,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],oldlace:[253,245,230,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],rebeccapurple:[102,51,153,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],whitesmoke:[245,245,245,1],yellowgreen:[154,205,50,1]};function qQ(t){return!!QE[t]||!!QE[t.toLowerCase()]}function v6(t){return QE[t]??QE[t.toLowerCase()]}function Sbe(t){return[...v6(t)]}function h3(t,e,i){i<0&&++i,i>1&&--i;const n=6*i;return n<1?t+(e-t)*n:2*i<1?e:3*i<2?t+(e-t)*(2/3-i)*6:t}function WQ(t,e,i,n=1){const r=(t%360+360)%360/360,s=i<=.5?i*(e+1):i+e-i*e,o=2*i-s;return[Math.round(255*h3(o,s,r+1/3)),Math.round(255*h3(o,s,r)),Math.round(255*h3(o,s,r-1/3)),n]}function Tbe(t){const e=t.length>5,i=e?8:4,n=(1<<i)-1,r=e?1:17,s=e?t.length===9:t.length===5;let o=+("0x"+t.substr(1));if(isNaN(o))return null;const a=[0,0,0,1];let l;return s&&(l=o&n,o>>=i,a[3]=r*l/255),l=o&n,o>>=i,a[2]=r*l,l=o&n,o>>=i,a[1]=r*l,l=o&n,o>>=i,a[0]=r*l,a}function Me(){return[0,0,0]}function ns(t){return[t[0],t[1],t[2]]}function Ln(t,e,i){return[t,e,i]}function Ibe(t){const e=Me(),i=Math.min(3,t.length);for(let n=0;n<i;++n)e[n]=t[n];return e}function JQ(t,e){return new Float64Array(t,e,3)}function ZQ(){return Me()}function YQ(){return Ln(1,1,1)}function XQ(){return Ln(1,0,0)}function KQ(){return Ln(0,1,0)}function QQ(){return Ln(0,0,1)}const Cbe=ZQ(),eee=YQ(),Mbe=XQ(),Ebe=KQ(),tee=QQ();Object.freeze(Object.defineProperty({__proto__:null,ONES:eee,UNIT_X:Mbe,UNIT_Y:Ebe,UNIT_Z:tee,ZEROS:Cbe,clone:ns,create:Me,createView:JQ,fromArray:Ibe,fromValues:Ln,ones:YQ,unitX:XQ,unitY:KQ,unitZ:QQ,zeros:ZQ},Symbol.toStringTag,{value:"Module"}));let _6=1e-6;function so(){return _6}function Abe(t){_6=t}const zS=Math.random,$be=Math.PI/180,Pbe=180/Math.PI;function b6(t){return t*$be}function kbe(t){return t*Pbe}function Obe(t,e){return Math.abs(t-e)<=_6*Math.max(1,Math.abs(t),Math.abs(e))}Object.freeze(Object.defineProperty({__proto__:null,RANDOM:zS,equals:Obe,getEpsilon:so,setEpsilon:Abe,toDegree:kbe,toRadian:b6},Symbol.toStringTag,{value:"Module"}));function jr(t){const e=t[0],i=t[1],n=t[2];return Math.sqrt(e*e+i*i+n*n)}function ri(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function Di(t,e,i,n){return t[0]=e,t[1]=i,t[2]=n,t}function sn(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t}function Ii(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t}function iee(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t[2]=e[2]*i[2],t}function nee(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t[2]=e[2]/i[2],t}function Lbe(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function Rbe(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function Dbe(t,e){return t[0]=Math.abs(e[0]),t[1]=Math.abs(e[1]),t[2]=Math.abs(e[2]),t}function Nbe(t,e){return t[0]=Math.sign(e[0]),t[1]=Math.sign(e[1]),t[2]=Math.sign(e[2]),t}function Fbe(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t[2]=Math.min(e[2],i[2]),t}function zbe(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t[2]=Math.max(e[2],i[2]),t}function Vbe(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function rn(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t}function Tf(t,e,i,n){return t[0]=e[0]+i[0]*n,t[1]=e[1]+i[1]*n,t[2]=e[2]+i[2]*n,t}function Rb(t,e){const i=e[0]-t[0],n=e[1]-t[1],r=e[2]-t[2];return Math.sqrt(i*i+n*n+r*r)}function od(t,e){const i=e[0]-t[0],n=e[1]-t[1],r=e[2]-t[2];return i*i+n*n+r*r}function tb(t){const e=t[0],i=t[1],n=t[2];return e*e+i*i+n*n}function jbe(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function Bbe(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function ss(t,e){const i=e[0],n=e[1],r=e[2];let s=i*i+n*n+r*r;return s>0&&(s=1/Math.sqrt(s),t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s),t}function yt(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function io(t,e,i){const n=e[0],r=e[1],s=e[2],o=i[0],a=i[1],l=i[2];return t[0]=r*l-s*a,t[1]=s*o-n*l,t[2]=n*a-r*o,t}function sP(t,e,i,n){const r=e[0],s=e[1],o=e[2];return t[0]=r+n*(i[0]-r),t[1]=s+n*(i[1]-s),t[2]=o+n*(i[2]-o),t}function Ube(t,e,i,n,r,s){const o=s*s,a=o*(2*s-3)+1,l=o*(s-2)+s,c=o*(s-1),u=o*(3-2*s);return t[0]=e[0]*a+i[0]*l+n[0]*c+r[0]*u,t[1]=e[1]*a+i[1]*l+n[1]*c+r[1]*u,t[2]=e[2]*a+i[2]*l+n[2]*c+r[2]*u,t}function Gbe(t,e,i,n,r,s){const o=1-s,a=o*o,l=s*s,c=a*o,u=3*s*a,d=3*l*o,f=l*s;return t[0]=e[0]*c+i[0]*u+n[0]*d+r[0]*f,t[1]=e[1]*c+i[1]*u+n[1]*d+r[1]*f,t[2]=e[2]*c+i[2]*u+n[2]*d+r[2]*f,t}function Hbe(t,e){e=e||1;const i=zS,n=2*i()*Math.PI,r=2*i()-1,s=Math.sqrt(1-r*r)*e;return t[0]=Math.cos(n)*s,t[1]=Math.sin(n)*s,t[2]=r*e,t}function wu(t,e,i){const n=e[0],r=e[1],s=e[2];return t[0]=i[0]*n+i[4]*r+i[8]*s+i[12],t[1]=i[1]*n+i[5]*r+i[9]*s+i[13],t[2]=i[2]*n+i[6]*r+i[10]*s+i[14],t}function qbe(t,e,i){const n=e[0],r=e[1],s=e[2];return t[0]=n*i[0]+r*i[3]+s*i[6],t[1]=n*i[1]+r*i[4]+s*i[7],t[2]=n*i[2]+r*i[5]+s*i[8],t}function TR(t,e,i){const n=i[0],r=i[1],s=i[2],o=i[3],a=e[0],l=e[1],c=e[2];let u=r*c-s*l,d=s*a-n*c,f=n*l-r*a,m=r*f-s*d,g=s*u-n*f,y=n*d-r*u;const _=2*o;return u*=_,d*=_,f*=_,m*=2,g*=2,y*=2,t[0]=a+u+m,t[1]=l+d+g,t[2]=c+f+y,t}function Wbe(t,e,i,n){const r=[],s=[];return r[0]=e[0]-i[0],r[1]=e[1]-i[1],r[2]=e[2]-i[2],s[0]=r[0],s[1]=r[1]*Math.cos(n)-r[2]*Math.sin(n),s[2]=r[1]*Math.sin(n)+r[2]*Math.cos(n),t[0]=s[0]+i[0],t[1]=s[1]+i[1],t[2]=s[2]+i[2],t}function Jbe(t,e,i,n){const r=[],s=[];return r[0]=e[0]-i[0],r[1]=e[1]-i[1],r[2]=e[2]-i[2],s[0]=r[2]*Math.sin(n)+r[0]*Math.cos(n),s[1]=r[1],s[2]=r[2]*Math.cos(n)-r[0]*Math.sin(n),t[0]=s[0]+i[0],t[1]=s[1]+i[1],t[2]=s[2]+i[2],t}function Zbe(t,e,i,n){const r=[],s=[];return r[0]=e[0]-i[0],r[1]=e[1]-i[1],r[2]=e[2]-i[2],s[0]=r[0]*Math.cos(n)-r[1]*Math.sin(n),s[1]=r[0]*Math.sin(n)+r[1]*Math.cos(n),s[2]=r[2],t[0]=s[0]+i[0],t[1]=s[1]+i[1],t[2]=s[2]+i[2],t}function Ybe(t,e){ri(HT,t),ri(qT,e),ss(HT,HT),ss(qT,qT);const i=yt(HT,qT);return i>1?0:i<-1?Math.PI:Math.acos(i)}const HT=Me(),qT=Me();function Xbe(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function Li(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function Kbe(t,e){if(t===e)return!0;const i=t[0],n=t[1],r=t[2],s=e[0],o=e[1],a=e[2],l=so();return Math.abs(i-s)<=l*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(n-o)<=l*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(r-a)<=l*Math.max(1,Math.abs(r),Math.abs(a))}function ree(t,e,i){const n=i[0]-e[0],r=i[1]-e[1],s=i[2]-e[2];let o=n*n+r*r+s*s;return o>0?(o=1/Math.sqrt(o),t[0]=n*o,t[1]=r*o,t[2]=s*o,t):(t[0]=0,t[1]=0,t[2]=0,t)}const fa=Ii,Qbe=iee,e1e=nee,t1e=Rb,i1e=od,see=jr,eA=tb;Object.freeze(Object.defineProperty({__proto__:null,abs:Dbe,add:sn,angle:Ybe,bezier:Gbe,ceil:Lbe,copy:ri,cross:io,direction:ree,dist:t1e,distance:Rb,div:e1e,divide:nee,dot:yt,equals:Kbe,exactEquals:Li,floor:Rbe,hermite:Ube,inverse:Bbe,len:see,length:jr,lerp:sP,max:zbe,min:Fbe,mul:Qbe,multiply:iee,negate:jbe,normalize:ss,random:Hbe,rotateX:Wbe,rotateY:Jbe,rotateZ:Zbe,round:Vbe,scale:rn,scaleAndAdd:Tf,set:Di,sign:Nbe,sqrDist:i1e,sqrLen:eA,squaredDistance:od,squaredLength:tb,str:Xbe,sub:fa,subtract:Ii,transformMat3:qbe,transformMat4:wu,transformQuat:TR},Symbol.toStringTag,{value:"Module"}));function P2(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function oee(t,e,i,n,r){return t[0]=e,t[1]=i,t[2]=n,t[3]=r,t}function aee(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t}function lee(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t}function cee(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t[2]=e[2]*i[2],t[3]=e[3]*i[3],t}function uee(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t[2]=e[2]/i[2],t[3]=e[3]/i[3],t}function n1e(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t}function r1e(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t}function s1e(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t[2]=Math.min(e[2],i[2]),t[3]=Math.min(e[3],i[3]),t}function o1e(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t[2]=Math.max(e[2],i[2]),t[3]=Math.max(e[3],i[3]),t}function a1e(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t}function hee(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t}function l1e(t,e,i,n){return t[0]=e[0]+i[0]*n,t[1]=e[1]+i[1]*n,t[2]=e[2]+i[2]*n,t[3]=e[3]+i[3]*n,t}function dee(t,e){const i=e[0]-t[0],n=e[1]-t[1],r=e[2]-t[2],s=e[3]-t[3];return Math.sqrt(i*i+n*n+r*r+s*s)}function pee(t,e){const i=e[0]-t[0],n=e[1]-t[1],r=e[2]-t[2],s=e[3]-t[3];return i*i+n*n+r*r+s*s}function w6(t){const e=t[0],i=t[1],n=t[2],r=t[3];return Math.sqrt(e*e+i*i+n*n+r*r)}function x6(t){const e=t[0],i=t[1],n=t[2],r=t[3];return e*e+i*i+n*n+r*r}function c1e(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function u1e(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t}function fee(t,e){const i=e[0],n=e[1],r=e[2],s=e[3];let o=i*i+n*n+r*r+s*s;return o>0&&(o=1/Math.sqrt(o),t[0]=i*o,t[1]=n*o,t[2]=r*o,t[3]=s*o),t}function mee(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function S6(t,e,i,n){const r=e[0],s=e[1],o=e[2],a=e[3];return t[0]=r+n*(i[0]-r),t[1]=s+n*(i[1]-s),t[2]=o+n*(i[2]-o),t[3]=a+n*(i[3]-a),t}function h1e(t,e){const i=zS;let n,r,s,o,a,l;e=e||1;do n=2*i()-1,r=2*i()-1,a=n*n+r*r;while(a>=1);do s=2*i()-1,o=2*i()-1,l=s*s+o*o;while(l>=1);const c=Math.sqrt((1-a)/l);return t[0]=e*n,t[1]=e*r,t[2]=e*s*c,t[3]=e*o*c,t}function gee(t,e,i){const n=e[0],r=e[1],s=e[2],o=e[3];return t[0]=i[0]*n+i[4]*r+i[8]*s+i[12]*o,t[1]=i[1]*n+i[5]*r+i[9]*s+i[13]*o,t[2]=i[2]*n+i[6]*r+i[10]*s+i[14]*o,t[3]=i[3]*n+i[7]*r+i[11]*s+i[15]*o,t}function d1e(t,e,i){const n=e[0],r=e[1],s=e[2],o=i[0],a=i[1],l=i[2],c=i[3],u=c*n+a*s-l*r,d=c*r+l*n-o*s,f=c*s+o*r-a*n,m=-o*n-a*r-l*s;return t[0]=u*c+m*-o+d*-l-f*-a,t[1]=d*c+m*-a+f*-o-u*-l,t[2]=f*c+m*-l+u*-a-d*-o,t[3]=e[3],t}function p1e(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function yee(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function vee(t,e){const i=t[0],n=t[1],r=t[2],s=t[3],o=e[0],a=e[1],l=e[2],c=e[3],u=so();return Math.abs(i-o)<=u*Math.max(1,Math.abs(i),Math.abs(o))&&Math.abs(n-a)<=u*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(r-l)<=u*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(s-c)<=u*Math.max(1,Math.abs(s),Math.abs(c))}const f1e=lee,m1e=cee,g1e=uee,y1e=dee,v1e=pee,_1e=w6,b1e=x6;Object.freeze(Object.defineProperty({__proto__:null,add:aee,ceil:n1e,copy:P2,dist:y1e,distance:dee,div:g1e,divide:uee,dot:mee,equals:vee,exactEquals:yee,floor:r1e,inverse:u1e,len:_1e,length:w6,lerp:S6,max:o1e,min:s1e,mul:m1e,multiply:cee,negate:c1e,normalize:fee,random:h1e,round:a1e,scale:hee,scaleAndAdd:l1e,set:oee,sqrDist:v1e,sqrLen:b1e,squaredDistance:pee,squaredLength:x6,str:p1e,sub:f1e,subtract:lee,transformMat4:gee,transformQuat:d1e},Symbol.toStringTag,{value:"Module"}));const P9=new Float32Array(1);function Eat(t){--t;for(let e=1;e<32;e<<=1)t|=t>>e;return t+1}function rr(t,e,i){return Math.min(Math.max(t,e),i)}function Aat(t){return(t&t-1)==0}function $at(t){return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,++t}function T6(t,e,i){return t+(e-t)*i}function _ee(t){return t*Math.PI/180}function bee(t){return 180*t/Math.PI}function Pat(t,e=1e-6){return(t<0?-1:1)/Math.max(Math.abs(t),e)}function oP(t){return Math.acos(rr(t,-1,1))}function wee(t){return Math.asin(rr(t,-1,1))}function A_(t,e,i=1e-6){return t===e?!0:!Number.isFinite(t)||!Number.isFinite(e)?!1:(t>e?t-e:e-t)<=i}const tA=new DataView(new ArrayBuffer(Float64Array.BYTES_PER_ELEMENT));function w1e(t){return tA.setFloat64(0,t),tA.getBigInt64(0)}function x1e(t){return tA.setBigInt64(0,t),tA.getFloat64(0)}const d3=BigInt("1000000");S1e(1);function S1e(t){const e=w1e(t=Math.abs(t)),i=x1e(e<=d3?d3:e-d3);return Math.abs(t-i)}function kat(t){return xee(Math.max(-If,Math.min(t,If)))}function xee(t){return P9[0]=t,P9[0]}function k9(t,e){const i=jr(t),n=wee(t[2]/i),r=Math.atan2(t[1]/i,t[0]/i);return Di(e,i,n,r),e}function Oat(t){const e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],i=t[3]*t[3]+t[4]*t[4]+t[5]*t[5],n=t[6]*t[6]+t[7]*t[7]+t[8]*t[8];return!(A_(e,1)&&A_(i,1)&&A_(n,1))}const If=xee(34028234663852886e22);function WT(t){return rr(jz(t),0,255)}function JT(t,e,i){return t=Number(t),isNaN(t)?i:t<e?e:t>i?i:t}let XC=class qr{static blendColors(e,i,n,r=new qr){return r.r=Math.round(e.r+(i.r-e.r)*n),r.g=Math.round(e.g+(i.g-e.g)*n),r.b=Math.round(e.b+(i.b-e.b)*n),r.a=e.a+(i.a-e.a)*n,r._sanitize()}static fromRgb(e,i){const n=e.toLowerCase().match(/^(rgba?|hsla?)\(([\s\.\-,%0-9]+)\)/);if(n){const r=n[2].split(/\s*,\s*/),s=n[1];if(s==="rgb"&&r.length===3||s==="rgba"&&r.length===4){const o=r[0];if(o.charAt(o.length-1)==="%"){const a=r.map(l=>2.56*parseFloat(l));return r.length===4&&(a[3]=parseFloat(r[3])),qr.fromArray(a,i)}return qr.fromArray(r.map(a=>parseFloat(a)),i)}if(s==="hsl"&&r.length===3||s==="hsla"&&r.length===4)return qr.fromArray(WQ(parseFloat(r[0]),parseFloat(r[1])/100,parseFloat(r[2])/100,parseFloat(r[3])),i)}return null}static fromHex(e,i=new qr){if(e.length!==4&&e.length!==7||e[0]!=="#")return null;const n=e.length===4?4:8,r=(1<<n)-1;let s=+("0x"+e.substr(1));return isNaN(s)?null:(["b","g","r"].forEach(o=>{const a=s&r;s>>=n,i[o]=n===4?17*a:a}),i.a=1,i)}static fromArray(e,i=new qr){return i._set(Number(e[0]),Number(e[1]),Number(e[2]),Number(e[3])),isNaN(i.a)&&(i.a=1),i._sanitize()}static fromString(e,i){const n=qQ(e)?v6(e):null;return n&&qr.fromArray(n,i)||qr.fromRgb(e,i)||qr.fromHex(e,i)}static fromJSON(e){return e&&new qr([e[0],e[1],e[2],e[3]/255])}static toUnitRGB(e){return e!=null?[e.r/255,e.g/255,e.b/255]:null}static toUnitRGBA(e){return e!=null?[e.r/255,e.g/255,e.b/255,e.a!=null?e.a:1]:null}constructor(e){this.r=255,this.g=255,this.b=255,this.a=1,e&&this.setColor(e)}get isBright(){return .299*this.r+.587*this.g+.114*this.b>=127}setColor(e){return typeof e=="string"?qr.fromString(e,this):Array.isArray(e)?qr.fromArray(e,this):(this._set(e.r??0,e.g??0,e.b??0,e.a??1),e instanceof qr||this._sanitize()),this}toRgb(){return[this.r,this.g,this.b]}toRgba(){return[this.r,this.g,this.b,this.a]}toHex(){const e=this.r.toString(16),i=this.g.toString(16),n=this.b.toString(16);return`#${e.length<2?"0"+e:e}${i.length<2?"0"+i:i}${n.length<2?"0"+n:n}`}toCss(e=!1){const i=this.r+", "+this.g+", "+this.b;return e?`rgba(${i}, ${this.a})`:`rgb(${i})`}toString(){return this.toCss(!0)}toJSON(){return this.toArray()}toArray(e=qr.AlphaMode.ALWAYS){const i=WT(this.r),n=WT(this.g),r=WT(this.b);return e===qr.AlphaMode.ALWAYS||this.a!==1?[i,n,r,WT(255*this.a)]:[i,n,r]}clone(){return new qr(this.toRgba())}hash(){return this.r<<24|this.g<<16|this.b<<8|255*this.a}equals(e){return e!=null&&e.r===this.r&&e.g===this.g&&e.b===this.b&&e.a===this.a}_sanitize(){return this.r=Math.round(JT(this.r,0,255)),this.g=Math.round(JT(this.g,0,255)),this.b=Math.round(JT(this.b,0,255)),this.a=JT(this.a,0,1),this}_set(e,i,n,r){this.r=e,this.g=i,this.b=n,this.a=r}};XC.prototype.declaredClass="esri.Color",function(t){var e;(e=t.AlphaMode||(t.AlphaMode={}))[e.ALWAYS=0]="ALWAYS",e[e.UNLESS_OPAQUE=1]="UNLESS_OPAQUE"}(XC||(XC={}));const ae=XC;function Lat(t){}function IR(t){return()=>t}function be(t,e={}){const i=t instanceof qe?t:new qe(t,e),n={type:(e==null?void 0:e.ignoreUnknown)??1?i.apiValues:String,json:{type:i.jsonValues,read:!(e!=null&&e.readOnly)&&{reader:i.read},write:{writer:i.write}}};return(e==null?void 0:e.readOnly)!==void 0&&(n.readOnly=!!e.readOnly),(e==null?void 0:e.default)!==void 0&&(n.json.default=e.default),(e==null?void 0:e.name)!==void 0&&(n.json.name=e.name),(e==null?void 0:e.nonNullable)!==void 0&&(n.nonNullable=e.nonNullable),p(n)}var CR;let KC=CR=class extends ie{constructor(t){super(t),this.type="none"}clone(){return new CR({type:this.type})}};h([be({none:"none",stayAbove:"stay-above"})],KC.prototype,"type",void 0),KC=CR=h([P("esri.ground.NavigationConstraint")],KC);function I6(t){const e=jz(100*(1-t));return Math.max(0,Math.min(e,100))}function k2(t){const e=1-t/100;return Math.max(0,Math.min(e,1))}var MR;let nh=MR=class extends RS(rd){constructor(t){super(t),this.opacity=1,this.surfaceColor=null,this.navigationConstraint=null,this.layers=new xe;const e=n=>{n.parent&&n.parent!==this&&"remove"in n.parent&&n.parent.remove(n),n.parent=this,n.type!=="elevation"&&n.type!=="base-elevation"&&ne.getLogger(this).error(`Layer '${n.title}, id:${n.id}' of type '${n.type}' is not supported as a ground layer and will therefore be ignored. Only layers of type 'elevation' are supported.`)},i=n=>{n.parent=null};this.addHandles([this.layers.on("after-add",n=>e(n.item)),this.layers.on("after-remove",n=>i(n.item))])}initialize(){this.when().catch(t=>{Ds(t)||ne.getLogger(this).error("#load()","Failed to load ground",t)}),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}destroy(){const t=this.layers.removeAll();for(const e of t)e.destroy();this.layers.destroy()}normalizeCtorArgs(t){return t&&"resourceInfo"in t&&(this._set("resourceInfo",t.resourceInfo),delete(t={...t}).resourceInfo),t}set layers(t){this._set("layers",Of(t,this._get("layers")))}writeLayers(t,e,i,n){const r=[];t&&(n={...n,layerContainerType:"ground"},t.forEach(s=>{if("write"in s){const o={};IR(s)().write(o,n)&&r.push(o)}else n&&n.messages&&n.messages.push(new V("layer:unsupported",`Layers (${s.title}, ${s.id}) of type '${s.declaredClass}' cannot be persisted in the ground`,{layer:s}))})),e.layers=r}load(t){return this.addResolvingPromise(this._loadFromSource(t)),Promise.resolve(this)}loadAll(){return aQ(this,t=>{t(this.layers)})}async queryElevation(t,e){await this.load({signal:e==null?void 0:e.signal});const{ElevationQuery:i}=await Y(()=>Promise.resolve().then(()=>TZ),void 0,import.meta.url);Vt(e);const n=new i,r=this.layers.filter(O9).toArray();return n.queryAll(r,t,e)}async createElevationSampler(t,e){await this.load({signal:e==null?void 0:e.signal});const{ElevationQuery:i}=await Y(()=>Promise.resolve().then(()=>TZ),void 0,import.meta.url);Vt(e);const n=new i,r=this.layers.filter(O9).toArray();return n.createSamplerAll(r,t,e)}clone(){const t={opacity:this.opacity,surfaceColor:q(this.surfaceColor),navigationConstraint:q(this.navigationConstraint),layers:this.layers.slice()};return this.loaded&&(t.loadStatus="loaded"),new MR({resourceInfo:this.resourceInfo}).set(t)}read(t,e){this.resourceInfo||this._set("resourceInfo",{data:t,context:e}),super.read(t,e)}_loadFromSource(t){const e=this.resourceInfo;return e?this._loadLayersFromJSON(e.data,e.context,t):Promise.resolve()}_loadLayersFromJSON(t,e,i){const n=e&&e.origin||"web-scene",r=e&&e.portal||null,s=e&&e.url||null;return Y(()=>import("./layersCreator-9b6b32fc.js"),["./layersCreator-9b6b32fc.js","./lazyLayerLoader-722c0802.js","./portalLayers-ccf3da0c.js","./layersLoader-cf53bd10.js","./fetchService-3a21abab.js","./jsonContext-491a2ecb.js","./styleUtils-fd6677de.js"],import.meta.url).then(({populateOperationalLayers:o})=>{Vt(i);const a=[];if(t.layers&&Array.isArray(t.layers)){const l={context:{origin:n,url:s,portal:r,layerContainerType:"ground"},defaultLayerType:"ArcGISTiledElevationServiceLayer"};a.push(o(this.layers,t.layers,l))}return Sn(a)}).then(()=>{})}};function T1e(t){return t&&"createElevationSampler"in t}function O9(t){return t.type==="elevation"||T1e(t)}h([p({json:{read:!1}})],nh.prototype,"layers",null),h([ge("layers")],nh.prototype,"writeLayers",null),h([p({readOnly:!0})],nh.prototype,"resourceInfo",void 0),h([p({type:Number,nonNullable:!0,range:{min:0,max:1},json:{type:It,read:{reader:k2,source:"transparency"},write:{writer:(t,e)=>{e.transparency=I6(t)},target:"transparency"}}})],nh.prototype,"opacity",void 0),h([p({type:ae,json:{type:[It],write:(t,e)=>{e.surfaceColor=t.toJSON().slice(0,3)}}})],nh.prototype,"surfaceColor",void 0),h([p({type:KC,json:{write:!0}})],nh.prototype,"navigationConstraint",void 0),nh=MR=h([P("esri.Ground")],nh);const O2=nh;let sv=class extends xe{constructor(e){super(e),this.getCollections=null}initialize(){this.own(Vz(()=>this._refresh()))}destroy(){this.getCollections=null}_refresh(){const e=this.getCollections!=null?this.getCollections():null;if(e==null)return void this.removeAll();let i=0;for(const n of e)n!=null&&(i=this._processCollection(i,n));this.splice(i,this.length)}_createNewInstance(e){return new xe(e)}_processCollection(e,i){if(!i)return e;const n=this.itemFilterFunction??(r=>!!r);for(const r of i)if(r){if(n(r)){const s=this.indexOf(r,e);s>=0?s!==e&&this.reorder(r,e):this.add(r,e),++e}if(this.getChildrenFunction){const s=this.getChildrenFunction(r);if(Array.isArray(s))for(const o of s)e=this._processCollection(e,o);else e=this._processCollection(e,s)}}return e}};h([p()],sv.prototype,"getCollections",void 0),h([p()],sv.prototype,"getChildrenFunction",void 0),h([p()],sv.prototype,"itemFilterFunction",void 0),sv=h([P("esri.core.CollectionFlattener")],sv);const L2=sv,I1e=[["binary","application/octet-stream","bin",""]];function C1e(t,e){return M6(A1e(t,e))}function M1e(t,e){return M6($1e(t,e))}function Dat(t,e){return See(E1e(t,e))}function C6(t){return[...I1e,...t]}function E1e(t,e){return C6(e).find(i=>M6(i)===t)}function A1e(t,e){return C6(e).find(i=>See(i)===t)}function $1e(t,e){const i=t.toLowerCase();return C6(e).find(n=>P1e(n).some(r=>i.endsWith(r)))}function M6(t){return t==null?void 0:t[0]}function See(t){return t==null?void 0:t[1]}function P1e(t){return(t==null?void 0:t[2].split(","))??[]}function Nat(t){var e;return(e=t.tables)==null?void 0:e.find(i=>i.role==="assetMaps")}function Tee(t){var e,i;return!(!(t&&typeof t=="object"&&"loaded"in t&&t.loaded&&((i=(e=tf(t))==null?void 0:e.operations)!=null&&i.supportsEditing)&&"type"in t)||"editingEnabled"in t&&!dbe(t)||t.type==="scene"&&!k1e(t))}function k1e(t){const e=t.infoFor3D;if(!e)return!0;const{supportedFormats:i,queryFormats:n}=e,r=C1e("model/gltf-binary",i)??M1e("glb",i);return r!=null&&n.includes(r)}const L9=ne.getLogger("esri.support.basemapUtils");function O1e(){return{}}function Iee(t){for(const e in t){const i=t[e];(i==null?void 0:i.destroyed)===!1&&i.destroy(),delete t[e]}}function QC(t,e){let i;if(typeof t=="string"){if(!(t in eb)){const n=Object.entries(eb).filter(([r,s])=>Tt.apiKey&&!s.classic||!Tt.apiKey&&s.classic&&!s.deprecated).map(([r])=>`"${r}"`).join(", ");return L9.warn(`Unable to find basemap definition for: ${t}. Try one of these: ${n}`),null}e&&(i=e[t]),i||(i=KE.fromId(t),e&&(e[t]=i))}else i=fn(KE,t);return i!=null&&i.destroyed&&(L9.warn("The provided basemap is already destroyed",{basemap:i}),i=null),i}function Fat(t,e){var i,n,r,s;return((n=(i=t.basemap)==null?void 0:i.referenceLayers)==null?void 0:n.some(o=>o.uid===e))||((s=(r=t.basemap)==null?void 0:r.baseLayers)==null?void 0:s.some(o=>o.uid===e))}function L1e(t){let e=null;const i=D1e(t),n=!(i!=null&&i.baseLayers.length);for(const r in eb){const s=z1e(i,Cee(eb[r]),{mustMatchReferences:n});if(s==="equal"){e=r;break}s==="base-layers-equal"&&(e=r)}return e}function R1e(t,e){var s;if(e==null||t==null)return{spatialReference:null,updating:!1};if(e.loadStatus==="not-loaded")return e.load(),{spatialReference:null,updating:!0};if(e.spatialReference)return{spatialReference:e.spatialReference,updating:!1};if(e.baseLayers.length===0)return{spatialReference:null,updating:!1};const i=e.baseLayers.at(0);switch(i.loadStatus){case"not-loaded":i.load();case"loading":return{spatialReference:null,updating:!0};case"failed":return{spatialReference:null,updating:!1}}const n=(("supportedSpatialReferences"in i?i.supportedSpatialReferences:null)||["tileInfo"in i?(s=i.tileInfo)==null?void 0:s.spatialReference:i.spatialReference]).filter(Boolean),r=t.spatialReference;return r?{spatialReference:n.find(o=>r.equals(o))??n[0]??null,updating:!1}:{spatialReference:n[0],updating:!1}}function D1e(t){return t?!t.loaded&&t.resourceInfo?Cee(t.resourceInfo.data):{baseLayers:R9(t.baseLayers),referenceLayers:R9(t.referenceLayers)}:null}function R9(t){return(xe.isCollection(t)?t.toArray():t).map(N1e)}function N1e(t){var e,i;return{type:t.type,url:Mee("urlTemplate"in t&&t.urlTemplate||t.url||"styleUrl"in t&&t.styleUrl||""),minScale:"minScale"in t&&t.minScale!=null?t.minScale:0,maxScale:"maxScale"in t&&t.maxScale!=null?t.maxScale:0,opacity:t.opacity!=null?t.opacity:1,visible:t.visible==null||!!t.visible,sublayers:t.type!=="map-image"&&t.type!=="wms"||t.sublayers==null||(e=t.sublayers)==null?void 0:e.map(n=>({id:n.id,visible:n.visible})),activeLayerId:t.type==="wmts"?(i=t.activeLayer)==null?void 0:i.id:void 0}}function Cee(t){return t?{baseLayers:D9((t.baseMapLayers??[]).filter(e=>!e.isReference)),referenceLayers:D9((t.baseMapLayers??[]).filter(e=>e.isReference))}:null}function D9(t){return t.map(e=>F1e(e))}function F1e(t){let e;switch(t.layerType){case"VectorTileLayer":e="vector-tile";break;case"ArcGISTiledMapServiceLayer":e="tile";break;default:e="unknown"}return{type:e,url:Mee(t.templateUrl||t.urlTemplate||t.styleUrl||t.url),minScale:t.minScale!=null?t.minScale:0,maxScale:t.maxScale!=null?t.maxScale:0,opacity:t.opacity!=null?t.opacity:1,visible:t.visibility==null||!!t.visibility,sublayers:void 0,activeLayerId:void 0}}function z1e(t,e,i){return t!=null!=(e!=null)?"not-equal":!t||!e?"equal":N9(t.baseLayers,e.baseLayers)?N9(t.referenceLayers,e.referenceLayers)?"equal":i.mustMatchReferences?"not-equal":"base-layers-equal":"not-equal"}function N9(t,e){if(t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(!V1e(t[i],e[i]))return!1;return!0}function V1e(t,e){if(t.type!==e.type||t.type==="scene"||t.url!==e.url||t.minScale!==e.minScale||t.maxScale!==e.maxScale||t.visible!==e.visible||t.opacity!==e.opacity)return!1;if(t.activeLayerId!=null||e.activeLayerId!=null)return t.activeLayerId===e.activeLayerId;if(t.sublayers!=null||e.sublayers!=null){if(t.sublayers==null||e.sublayers==null||t.sublayers.length!==e.sublayers.length)return!1;for(let i=0;i<t.sublayers.length;i++){const n=t.sublayers.at(i),r=e.sublayers.at(i);if((n==null?void 0:n.id)!==(r==null?void 0:r.id)||(n==null?void 0:n.visible)!==(r==null?void 0:r.visible))return!1}}return!0}function Mee(t){return t?ll(t).replace(/^\s*https?:/i,"").toLowerCase():""}function j1e(t){return new L2({getCollections:()=>[t.tables,t.layers],getChildrenFunction:e=>{const i=[];return"tables"in e&&i.push(e.tables),"layers"in e&&i.push(e.layers),i},itemFilterFunction:e=>{const i=e.parent;return!!i&&"tables"in i&&i.tables.includes(e)}})}function p3(t){for(const e of t.values())e==null||e.destroy();t.clear()}const F9={"world-elevation":{id:"worldElevation",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"},"world-topobathymetry":{id:"worldTopoBathymetry",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/TopoBathy3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"}};function B1e(t){let e=null;if(typeof t=="string")if(t in F9){const i=F9[t];e=new O2({resourceInfo:{data:{layers:[i]}}})}else ne.getLogger("esri.support.groundUtils").warn(`Unable to find ground definition for: ${t}. Try "world-elevation"`);else e=fn(O2,t);return e}function ib(t,e,i=!1){let{hasM:n,hasZ:r}=t;Array.isArray(e)?e.length!==4||n||r?e.length===3&&i&&!n?(r=!0,n=!1):e.length===3&&n&&r&&(n=!1,r=!1):(n=!0,r=!0):(r=!r&&e.hasZ&&(!n||e.hasM),n=!n&&e.hasM&&(!r||e.hasZ)),t.hasZ=r,t.hasM=n}var ER;function z9(t){return(e,i)=>e==null?i:i==null?e:t(e,i)}function U1e(t){return t&&(t.declaredClass==="esri.geometry.SpatialReference"||t.wkid!=null)}let Yd=ER=class extends md{constructor(...t){super(...t),this.points=[],this.type="multipoint"}normalizeCtorArgs(t,e){if(!t&&!e)return{};const i={};Array.isArray(t)?(i.points=t,i.spatialReference=e):U1e(t)?i.spatialReference=t:(t.points&&(i.points=t.points),t.spatialReference&&(i.spatialReference=t.spatialReference),t.hasZ&&(i.hasZ=t.hasZ),t.hasM&&(i.hasM=t.hasM));const n=i.points&&i.points[0];return n&&(i.hasZ===void 0&&i.hasM===void 0?(i.hasZ=n.length>2,i.hasM=!1):i.hasZ===void 0?i.hasZ=n.length>3:i.hasM===void 0&&(i.hasM=n.length>3)),i}get cache(){return this.commitProperty("points"),this.commitProperty("hasZ"),this.commitProperty("hasM"),this.commitProperty("spatialReference"),{}}get extent(){const t=this.points;if(!t.length)return null;const e=new Le,i=this.hasZ,n=this.hasM,r=i?3:2,s=t[0],o=z9(Math.min),a=z9(Math.max);let l,c,u,d,[f,m]=s,[g,y]=s;for(let _=0,b=t.length;_<b;_++){const w=t[_],[x,S]=w;if(f=o(f,x),m=o(m,S),g=a(g,x),y=a(y,S),i&&w.length>2){const T=w[2];l=o(l,T),u=a(u,T)}if(n&&w.length>r){const T=w[r];c=o(c,T),d=a(d,T)}}return e.xmin=f,e.ymin=m,e.xmax=g,e.ymax=y,e.spatialReference=this.spatialReference,i?(e.zmin=l,e.zmax=u):(e.zmin=void 0,e.zmax=void 0),n?(e.mmin=c,e.mmax=d):(e.mmin=void 0,e.mmax=void 0),e}writePoints(t,e){e.points=q(this.points)}addPoint(t){return ib(this,t),Array.isArray(t)?this.points.push(t):this.points.push(t.toArray()),this.notifyChange("points"),this}clone(){const t={points:q(this.points),spatialReference:this.spatialReference};return this.hasZ&&(t.hasZ=!0),this.hasM&&(t.hasM=!0),new ER(t)}getPoint(t){if(!this._validateInputs(t))return null;const e=this.points[t],i={x:e[0],y:e[1],spatialReference:this.spatialReference};let n=2;return this.hasZ&&(i.z=e[2],n=3),this.hasM&&(i.m=e[n]),new pe(i)}removePoint(t){if(!this._validateInputs(t))return null;const e=new pe(this.points.splice(t,1)[0],this.spatialReference);return this.notifyChange("points"),e}setPoint(t,e){return this._validateInputs(t)?(ib(this,e),Array.isArray(e)||(e=e.toArray()),this.points[t]=e,this.notifyChange("points"),this):this}toJSON(t){return this.write({},t)}_validateInputs(t){return t!=null&&t>=0&&t<this.points.length}};h([p({readOnly:!0})],Yd.prototype,"cache",null),h([p()],Yd.prototype,"extent",null),h([p({type:[[Number]],json:{write:{isRequired:!0}}})],Yd.prototype,"points",void 0),h([ge("points")],Yd.prototype,"writePoints",null),Yd=ER=h([P("esri.geometry.Multipoint")],Yd),Yd.prototype.toJSON.isDefaultToJSON=!0;const Cf=Yd;function zat(t){const e=[];for(t.reset();t.nextPath();){const i=[];for(;t.nextPoint();)i.push([t.x,t.y]);e.push(i)}return t.reset(),e}function G1e(t){const e=[];for(;t.nextPoint();)e.push([t.x,t.y]);return t.seekPathStart(),e}function V9(t){if(!t)return null;if(Array.isArray(t))return t;const e=t.hasZ,i=t.hasM;if(t.type==="point")return i&&e?[t.x,t.y,t.z,t.m]:e?[t.x,t.y,t.z]:i?[t.x,t.y,t.m]:[t.x,t.y];if(t.type==="polygon")return t.rings.slice(0);if(t.type==="polyline")return t.paths.slice(0);if(t.type==="multipoint")return t.points.slice(0);if(t.type==="extent"){const n=t.clone().normalize();if(!n)return null;let r=!1,s=!1;return n.forEach(o=>{o.hasZ&&(r=!0),o.hasM&&(s=!0)}),n.map(o=>{const a=[[o.xmin,o.ymin],[o.xmin,o.ymax],[o.xmax,o.ymax],[o.xmax,o.ymin],[o.xmin,o.ymin]];if(r&&o.hasZ){const l=.5*(o.zmax-o.zmin);for(let c=0;c<a.length;c++)a[c].push(l)}if(s&&o.hasM){const l=.5*(o.mmax-o.mmin);for(let c=0;c<a.length;c++)a[c].push(l)}return a})}return null}function aP(t,e){const i=e[0]-t[0],n=e[1]-t[1];if(t.length>2&&e.length>2){const r=t[2]-e[2];return Math.sqrt(i*i+n*n+r*r)}return Math.sqrt(i*i+n*n)}function Eee(t,e,i){const n=t[0]+i*(e[0]-t[0]),r=t[1]+i*(e[1]-t[1]);return t.length>2&&e.length>2?[n,r,t[2]+i*(e[2]-t[2])]:[n,r]}function H1e(t,e,i,n){const[r,s]=e,[o,a]=i[n],[l,c]=i[n+1],u=l-o,d=c-a,f=u*u+d*d,m=(r-o)*u+(s-a)*d,g=Math.min(1,Math.max(0,m/f));return t[0]=o+u*g,t[1]=a+d*g,t}function Vat(t,e,i){let n,r,s,o,a=!1,l=1/0;for(i.reset();i.nextPath();)if(i.nextPoint())for(n=i.x,r=i.y;i.nextPoint();)s=i.x,o=i.y,r>e!=o>e&&t<(s-n)*(e-r)/(o-r)+n&&(a=!a),l=Math.min(l,q1e(t,e,n,r,s,o)),n=s,r=o;return l===0?0:(a?1:-1)*Math.sqrt(l)}function q1e(t,e,i,n,r,s){let o=i,a=n,l=r-o,c=s-a;if(l!==0||c!==0){const u=((t-o)*l+(e-a)*c)/(l*l+c*c);u>1?(o=r,a=s):u>0&&(o+=l*u,a+=c*u)}return l=t-o,c=e-a,l*l+c*c}function Aee(t,e){return Eee(t,e,.5)}function jat(t){const e=t.length;let i=0;for(let n=0;n<e-1;++n)i+=aP(t[n],t[n+1]);return i}function Bat(t,e){if(e<=0)return t[0];const i=t.length;let n=0;for(let r=0;r<i-1;++r){const s=aP(t[r],t[r+1]);if(e-n<s){const o=(e-n)/s;return Eee(t[r],t[r+1],o)}n+=s}return t[i-1]}function $ee(t,e,i){const n=t.length;let r=0,s=0,o=0;for(let a=0;a<n;a++){const l=t[a],c=t[(a+1)%n];let u=2;r+=l[0]*c[1]-c[0]*l[1],l.length>2&&c.length>2&&i&&(s+=l[0]*c[2]-c[0]*l[2],u=3),l.length>u&&c.length>u&&e&&(o+=l[0]*c[u]-c[0]*l[u])}return r<=0&&s<=0&&o<=0}function W1e(t){const e=t.length;return e>2&&ES(t[0],t[e-1])}function Uat(t){if("rings"in t&&(J1e(t),t.rings.length>0&&!$ee(t.rings[0],t.hasM??!1,t.hasZ??!1)))for(const e of t.rings)e.reverse()}function J1e(t){if("rings"in t)for(const e of t.rings)W1e(e)||e.push(e[0].slice())}function Gat(t){return t.type!=="polygon"&&t.type!=="polyline"||Z1e(t.type==="polygon"?t.rings:t.paths,t.spatialReference),t}function Z1e(t,e){const i=to(e);if(!i)return;const n=i.valid[0],r=i.valid[1],s=r-n;for(const o of t){let a=1/0,l=-1/0;for(const u of o){const d=Pee(u[0],n,r);a=Math.min(a,d),l=Math.max(l,d),u[0]=d}const c=l-a;s-c<c&&o.forEach(u=>{u[0]<0&&(u[0]+=s)})}}function Pee(t,e,i){const n=i-e;return t<e?i-(e-t)%n:t>i?e+(t-e)%n:t}function Hat(t){if(!t||t.length<3)return 0;let e=0;const i=t.length-1;for(let n=0;n<i;n++)e+=(t[n][0]-t[n+1][0])*(t[n][1]+t[n+1][1]);return e+=(t[i][0]-t[0][0])*(t[i][1]+t[0][1]),-.5*e}function kee(t){if(!t||t.numPoints<3)return 0;let e,i,n=0;if(t.seekPathStart(),!t.nextPoint())return 0;e=t.x,i=t.y;const r=e,s=i;for(;t.nextPoint();)n+=(e-t.x)*(i+t.y),e=t.x,i=t.y;return n+=(e-r)*(i+s),-.5*n}function qat(t,e){if(t===e)return!0;if(t.type!==e.type)return!1;if(t.type==="point"||t.type==="mesh"||t.type==="extent")return!0;if(t.type==="multipoint")return t.points.length===e.points.length;const[i,n]=t.type==="polyline"?[t.paths,e.paths]:[t.rings,e.rings];return i.length===n.length&&i.every((r,s)=>r.length===n[s].length)}function Wat(t){return t?t.hasZ?[t.xmax-t.xmin/2,t.ymax-t.ymin/2,t.zmax-t.zmin/2]:[t.xmax-t.xmin/2,t.ymax-t.ymin/2]:null}function Y1e(t){return t?X1e(t.rings,t.hasZ??!1):null}function X1e(t,e){if(!t||!t.length)return null;const i=[],n=[],r=e?[1/0,-1/0,1/0,-1/0,1/0,-1/0]:[1/0,-1/0,1/0,-1/0];for(let s=0,o=t.length;s<o;s++){const a=Oee(t[s],e,r);a&&n.push(a)}if(n.sort((s,o)=>{let a=s[2]-o[2];return a===0&&e&&(a=s[4]-o[4]),a}),n.length&&(i[0]=n[0][0],i[1]=n[0][1],e&&(i[2]=n[0][3]),(i[0]<r[0]||i[0]>r[1]||i[1]<r[2]||i[1]>r[3]||e&&(i[2]<r[4]||i[2]>r[5]))&&(i.length=0)),!i.length){const s=t[0]&&t[0].length?K1e(t[0],e):null;if(!s)return null;i[0]=s[0],i[1]=s[1],e&&s.length>2&&(i[2]=s[2])}return i}function Oee(t,e,i){let n=0,r=0,s=0,o=0,a=0;const l=t.length?t[0][0]:0,c=t.length?t[0][1]:0,u=t.length&&e?t[0][2]:0;for(let f=0;f<t.length;f++){const m=t[f],g=t[(f+1)%t.length],[y,_,b]=m,w=y-l,x=_-c,[S,T,I]=g,C=S-l,M=T-c,E=w*M-C*x;if(o+=E,n+=(w+C)*E,r+=(x+M)*E,e&&m.length>2&&g.length>2){const A=b-u,$=I-u,L=w*$-C*A;s+=(A+$)*L,a+=L}y<i[0]&&(i[0]=y),y>i[1]&&(i[1]=y),_<i[2]&&(i[2]=_),_>i[3]&&(i[3]=_),e&&(b<i[4]&&(i[4]=b),b>i[5]&&(i[5]=b))}if(o>0&&(o*=-1),a>0&&(a*=-1),!o)return null;o*=.5,a*=.5;const d=[n/(6*o)+l,r/(6*o)+c,o];return e&&(i[4]===i[5]||a===0?(d[3]=(i[4]+i[5])/2,d[4]=0):(d[3]=s/(6*a)+u,d[4]=a)),d}function K1e(t,e){const i=e?[0,0,0]:[0,0],n=e?[0,0,0]:[0,0];let r=0,s=0,o=0,a=0;for(let l=0,c=t.length;l<c-1;l++){const u=t[l],d=t[l+1];if(u&&d){i[0]=u[0],i[1]=u[1],n[0]=d[0],n[1]=d[1],e&&u.length>2&&d.length>2&&(i[2]=u[2],n[2]=d[2]);const f=aP(i,n);if(f){r+=f;const m=Aee(u,d);s+=f*m[0],o+=f*m[1],e&&m.length>2&&(a+=f*m[2])}}}return r>0?e?[s/r,o/r,a/r]:[s/r,o/r]:t.length?t[0]:null}function Q1e(t){const{hasZ:e,numPaths:i}=t;if(i===0)return null;const n=[],r=[],s=e?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY];for(t.reset();t.nextPath();){const o=Oee(G1e(t),t.hasZ,s);o&&r.push(o)}if(r.sort((o,a)=>{let l=o[2]-a[2];return l===0&&e&&(l=o[4]-a[4]),l}),r.length&&(n[0]=r[0][0],n[1]=r[0][1],e&&(n[2]=r[0][3]),(n[0]<s[0]||n[0]>s[1]||n[1]<s[2]||n[1]>s[3]||e&&(n[2]<s[4]||n[2]>s[5]))&&(n.length=0)),!n.length){t.reset(),t.nextPath();const o=t.numPoints?ewe(t):null;if(!o)return null;n[0]=o[0],n[1]=o[1],e&&o.length>2&&(n[2]=o[2])}return n}function ewe(t){const{hasZ:e}=t,i=e?[0,0,0]:[0,0],n=e?[0,0,0]:[0,0];let r=0,s=0,o=0,a=0;if(t.nextPoint()){let l=t.x,c=t.y,u=t.z;for(;t.nextPoint();){const d=t.x,f=t.y,m=t.z;i[0]=l,i[1]=c,n[0]=d,n[1]=f,e&&(i[2]=u,n[2]=m);const g=aP(i,n);if(g){r+=g;const y=Aee(i,n);s+=g*y[0],o+=g*y[1],e&&y.length>2&&(a+=g*y[2])}l=d,c=f,u=m}}return r>0?e?[s/r,o/r,a/r]:[s/r,o/r]:t.numPoints?(t.seekPathStart(),t.nextPoint(),[t.x,t.y]):null}const twe=1e-6;function Jat(t){let e=0;for(t.reset();t.nextPath();)e+=kee(t);if(e<twe){const r=Q1e(t);return r?[r[0],r[1]]:null}const i=[0,0];if(t.reset(),!t.nextPath()||!t.nextPoint())return null;const n=[t.x,t.y];for(t.reset();t.nextPath();)nwe(i,n,t);return i[0]*=1/e,i[1]*=1/e,i[0]+=n[0],i[1]+=n[1],i}const iwe=1/3;function nwe(t,e,i){if(!t||!i||i.numPoints<3)return null;i.nextPoint();const n=i.x,r=i.y;i.nextPoint();let s,o=i.x-n,a=i.y-r,l=0,c=0;for(;i.nextPoint();)l=i.x-n,c=i.y-r,s=.5*iwe*(l*a-c*o),t[0]+=s*(o+l),t[1]+=s*(a+c),o=l,a=c;const u=kee(i),d=[n,r];return d[0]-=e[0],d[1]-=e[1],d[0]*=u,d[1]*=u,t[0]+=d[0],t[1]+=d[1],t}function wa(t=lwe){return[t[0],t[1],t[2],t[3]]}function Zat(t){return[t[0],t[1],t[2],t[3]]}function E6(t,e){return t!==e&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3]),t}function Yat(t,e,i,n,r=wa()){return r[0]=t,r[1]=e,r[2]=i,r[3]=n,r}function rwe(t,e=wa()){return e[0]=t.xmin,e[1]=t.ymin,e[2]=t.xmax,e[3]=t.ymax,e}function Lee(t,e){return new Le({xmin:t[0],ymin:t[1],xmax:t[2],ymax:t[3],spatialReference:e})}function Xat(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function Kat(t,e,i){if(e!=null)if("length"in e)$R(e)?(i[0]=Math.min(t[0],e[0]),i[1]=Math.min(t[1],e[1]),i[2]=Math.max(t[2],e[2]),i[3]=Math.max(t[3],e[3])):e.length!==2&&e.length!==3||(i[0]=Math.min(t[0],e[0]),i[1]=Math.min(t[1],e[1]),i[2]=Math.max(t[2],e[0]),i[3]=Math.max(t[3],e[1]));else switch(e.type){case"extent":i[0]=Math.min(t[0],e.xmin),i[1]=Math.min(t[1],e.ymin),i[2]=Math.max(t[2],e.xmax),i[3]=Math.max(t[3],e.ymax);break;case"point":i[0]=Math.min(t[0],e.x),i[1]=Math.min(t[1],e.y),i[2]=Math.max(t[2],e.x),i[3]=Math.max(t[3],e.y)}else E6(i,t)}function f3(t,e,i=t){const n=e.length;let r=t[0],s=t[1],o=t[2],a=t[3];for(let l=0;l<n;l++){const c=e[l];r=Math.min(r,c[0]),s=Math.min(s,c[1]),o=Math.max(o,c[0]),a=Math.max(a,c[1])}return i[0]=r,i[1]=s,i[2]=o,i[3]=a,i}function Qat(t){for(let e=0;e<4;e++)if(!isFinite(t[e]))return!1;return!0}function swe(t){return t==null||t[0]>=t[2]?0:t[2]-t[0]}function owe(t){return t[1]>=t[3]?0:t[3]-t[1]}function elt(t){return swe(t)*owe(t)}function tlt(t,e=[0,0]){return e[0]=(t[0]+t[2])/2,e[1]=(t[1]+t[3])/2,e}function ilt(t,e){return A6(t,e[0],e[1])}function nlt(t,e){return A6(t,e.x,e.y)}function A6(t,e,i){return e>=t[0]&&i>=t[1]&&e<=t[2]&&i<=t[3]}function rlt(t,e,i){return e[0]>=t[0]-i&&e[1]>=t[1]-i&&e[0]<=t[2]+i&&e[1]<=t[3]+i}function slt(t,e){return Math.max(e[0],t[0])<=Math.min(e[2],t[2])&&Math.max(e[1],t[1])<=Math.min(e[3],t[3])}function AR(t,e){return e[0]>=t[0]&&e[2]<=t[2]&&e[1]>=t[1]&&e[3]<=t[3]}function olt(t,e,i,n=t){return n[0]=t[0]+e,n[1]=t[1]+i,n[2]=t[2]+e,n[3]=t[3]+i,n}function awe(t){return t?E6(t,j9):wa(j9)}function $R(t){return t!=null&&t.length===4}function alt(t,e){return $R(t)&&$R(e)?t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]:t===e}const j9=[1/0,1/0,-1/0,-1/0],lwe=[0,0,0,0];function Ree(t){return t.xmin!==void 0&&t.ymin!==void 0&&t.xmax!==void 0&&t.ymax!==void 0}function Dee(t){return t.points!==void 0}function Nee(t){return t.x!==void 0&&t.y!==void 0}function Fee(t){return t.paths!==void 0}function zee(t){return t.rings!==void 0}function Vee(t){function e(i,n){return i==null?n:n==null?i:t(i,n)}return e}const nf=Vee(Math.min),rf=Vee(Math.max);function llt(t,e){return Fee(e)?nb(t,e.paths,!1,!1):zee(e)?nb(t,e.rings,!1,!1):Dee(e)?$6(t,e.points,!1,!1,!1,!1):Ree(e)?jee(t,e):(Nee(e)&&(t[0]=e.x,t[1]=e.y,t[2]=e.x,t[3]=e.y),t)}function clt(t){let e,i,n,r;for(t.reset(),e=n=1/0,i=r=-1/0;t.nextPath();){const s=cwe(t);e=Math.min(s[0],e),n=Math.min(s[1],n),i=Math.max(s[2],i),r=Math.max(s[3],r)}return wa([e,n,i,r])}function cwe(t){let e,i,n,r;for(e=n=1/0,i=r=-1/0;t.nextPoint();)e=Math.min(t.x,e),n=Math.min(t.y,n),i=Math.max(t.x,i),r=Math.max(t.y,r);return wa([e,n,i,r])}function ult(t,e){return Fee(e)?nb(t,e.paths,!0,!1):zee(e)?nb(t,e.rings,!0,!1):Dee(e)?$6(t,e.points,!0,!1,!0,!1):Ree(e)?jee(t,e,!0,!1,!0,!1):(Nee(e)&&(t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.x,t[4]=e.y,t[5]=e.z),t)}function nb(t,e,i,n){const r=i?3:2;if(!e.length||!e[0].length)return null;let s,o,a,l,[c,u]=e[0][0],[d,f]=e[0][0];for(let m=0;m<e.length;m++){const g=e[m];for(let y=0;y<g.length;y++){const _=g[y],[b,w]=_;if(c=nf(c,b),u=nf(u,w),d=rf(d,b),f=rf(f,w),i&&_.length>2){const x=_[2];s=nf(s,x),o=rf(o,x)}if(n&&_.length>r){const x=_[r];a=nf(s,x),l=rf(o,x)}}}return i?n?(t[0]=c,t[1]=u,t[2]=s,t[3]=a,t[4]=d,t[5]=f,t[6]=o,t[7]=l,t.length=8,t):(t[0]=c,t[1]=u,t[2]=s,t[3]=d,t[4]=f,t[5]=o,t.length=6,t):n?(t[0]=c,t[1]=u,t[2]=a,t[3]=d,t[4]=f,t[5]=l,t.length=6,t):(t[0]=c,t[1]=u,t[2]=d,t[3]=f,t.length=4,t)}function jee(t,e,i,n,r,s){const o=e.xmin,a=e.xmax,l=e.ymin,c=e.ymax;let u=e.zmin,d=e.zmax,f=e.mmin,m=e.mmax;return r?(u=u||0,d=d||0,s?(f=f||0,m=m||0,t[0]=o,t[1]=l,t[2]=u,t[3]=f,t[4]=a,t[5]=c,t[6]=d,t[7]=m,t):(t[0]=o,t[1]=l,t[2]=u,t[3]=a,t[4]=c,t[5]=d,t)):s?(f=f||0,m=m||0,t[0]=o,t[1]=l,t[2]=f,t[3]=a,t[4]=c,t[5]=m,t):(t[0]=o,t[1]=l,t[2]=a,t[3]=c,t)}function $6(t,e,i,n,r,s){const o=i?3:2,a=n&&s,l=i&&r;if(!e.length||!e[0].length)return null;let c,u,d,f,[m,g]=e[0],[y,_]=e[0];for(let b=0;b<e.length;b++){const w=e[b],[x,S]=w;if(m=nf(m,x),g=nf(g,S),y=rf(y,x),_=rf(_,S),l&&w.length>2){const T=w[2];c=nf(c,T),u=rf(u,T)}if(a&&w.length>o){const T=w[o];d=nf(c,T),f=rf(u,T)}}return r?(c=c||0,u=u||0,s?(d=d||0,f=f||0,t[0]=m,t[1]=g,t[2]=c,t[3]=d,t[4]=y,t[5]=_,t[6]=u,t[7]=f,t):(t[0]=m,t[1]=g,t[2]=c,t[3]=y,t[4]=_,t[5]=u,t)):s?(d=d||0,f=f||0,t[0]=m,t[1]=g,t[2]=d,t[3]=y,t[4]=_,t[5]=f,t):(t[0]=m,t[1]=g,t[2]=y,t[3]=_,t)}function uwe(t){return t.xmin!==void 0&&t.ymin!==void 0&&t.xmax!==void 0&&t.ymax!==void 0}function hwe(t){return t.points!==void 0}function dwe(t){return t.x!==void 0&&t.y!==void 0}function pwe(t){return t.paths!==void 0}function fwe(t){return t.rings!==void 0}const P6=[];function Bee(t,e,i,n){return{xmin:t,ymin:e,xmax:i,ymax:n}}function Uee(t,e,i,n,r,s){return{xmin:t,ymin:e,zmin:i,xmax:n,ymax:r,zmax:s}}function Gee(t,e,i,n,r,s){return{xmin:t,ymin:e,mmin:i,xmax:n,ymax:r,mmax:s}}function Hee(t,e,i,n,r,s,o,a){return{xmin:t,ymin:e,zmin:i,mmin:n,xmax:r,ymax:s,zmax:o,mmax:a}}function k6(t,e=!1,i=!1){return e?i?Hee(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]):Uee(t[0],t[1],t[2],t[3],t[4],t[5]):i?Gee(t[0],t[1],t[2],t[3],t[4],t[5]):Bee(t[0],t[1],t[2],t[3])}function hlt(t){return t?uwe(t)?t:dwe(t)?gwe(t):fwe(t)?qee(t):pwe(t)?Wee(t):hwe(t)?mwe(t):null:null}function mwe(t){const{hasZ:e,hasM:i,points:n}=t;return k6($6(P6,n,e??!1,i??!1),e,i)}function gwe(t){const{x:e,y:i,z:n,m:r}=t,s=r!=null;return n!=null?s?Hee(e,i,n,r,e,i,n,r):Uee(e,i,n,e,i,n):s?Gee(e,i,r,e,i,r):Bee(e,i,e,i)}function qee(t){const{hasZ:e,hasM:i,rings:n}=t,r=nb(P6,n,e??!1,i??!1);return r?k6(r,e,i):null}function Wee(t){const{hasZ:e,hasM:i,paths:n}=t,r=nb(P6,n,e??!1,i??!1);return r?k6(r,e,i):null}var eM;function B9(t){return!Array.isArray(t[0])}let Uc=eM=class extends md{static fromExtent(t){const e=t.clone().normalize(),i=t.spatialReference;let n=!1,r=!1;for(const o of e)o.hasZ&&(n=!0),o.hasM&&(r=!0);const s={rings:e.map(o=>{const a=[[o.xmin,o.ymin],[o.xmin,o.ymax],[o.xmax,o.ymax],[o.xmax,o.ymin],[o.xmin,o.ymin]];if(n&&o.hasZ){const l=o.zmin+.5*(o.zmax-o.zmin);for(let c=0;c<a.length;c++)a[c].push(l)}if(r&&o.hasM){const l=o.mmin+.5*(o.mmax-o.mmin);for(let c=0;c<a.length;c++)a[c].push(l)}return a}),spatialReference:i};return n&&(s.hasZ=!0),r&&(s.hasM=!0),new eM(s)}constructor(...t){super(...t),this.rings=[],this.type="polygon"}normalizeCtorArgs(t,e){let i,n,r=null,s=null;return t&&!Array.isArray(t)?(r=t.rings??null,e||(t.spatialReference?e=t.spatialReference:t.rings||(e=t)),i=t.hasZ,n=t.hasM):r=t,r=r||[],e=e||Ee.WGS84,r.length&&r[0]&&r[0][0]!=null&&typeof r[0][0]=="number"&&(r=[r]),s=r[0]&&r[0][0],s&&(i===void 0&&n===void 0?(i=s.length>2,n=s.length>3):i===void 0?i=n?s.length>3:s.length>2:n===void 0&&(n=i?s.length>3:s.length>2)),{rings:r,spatialReference:e,hasZ:i,hasM:n}}get cache(){return this.commitProperty("rings"),this.commitProperty("hasZ"),this.commitProperty("hasM"),this.commitProperty("spatialReference"),{}}get centroid(){const t=Y1e(this);if(!t||isNaN(t[0])||isNaN(t[1])||this.hasZ&&isNaN(t[2]))return null;const e=new pe;return e.x=t[0],e.y=t[1],e.spatialReference=this.spatialReference,this.hasZ&&(e.z=t[2]),e}get extent(){const{spatialReference:t}=this,e=qee(this);if(!e)return null;const i=new Le(e);return i.spatialReference=t,i}get isSelfIntersecting(){return j_e(this.rings)}writeRings(t,e){e.rings=q(this.rings)}addRing(t){if(!t)return;const e=this.rings,i=e.length;if(B9(t)){const n=[];for(let r=0,s=t.length;r<s;r++)n[r]=t[r].toArray();e[i]=n}else e[i]=t.concat();return this.notifyChange("rings"),this}clone(){const t=new eM;return t.spatialReference=this.spatialReference,t.rings=q(this.rings),t.hasZ=this.hasZ,t.hasM=this.hasM,t}equals(t){if(this===t)return!0;if(t==null)return!1;const e=this.spatialReference,i=t.spatialReference;if(e!=null!=(i!=null)||e!=null&&i!=null&&!e.equals(i)||this.rings.length!==t.rings.length)return!1;const n=([r,s,o,a],[l,c,u,d])=>r===l&&s===c&&(o==null&&u==null||o===u)&&(a==null&&d==null||a===d);for(let r=0;r<this.rings.length;r++){const s=this.rings[r],o=t.rings[r];if(!ES(s,o,n))return!1}return!0}contains(t){if(!t)return!1;const e=NS(t,this.spatialReference);return RQ(this,e??t)}isClockwise(t){let e;return e=B9(t)?t.map(i=>this.hasZ?this.hasM?[i.x,i.y,i.z,i.m]:[i.x,i.y,i.z]:[i.x,i.y]):t,$ee(e,this.hasM,this.hasZ)}getPoint(t,e){if(!this._validateInputs(t,e))return null;const i=this.rings[t][e],n=this.hasZ,r=this.hasM;return n&&!r?new pe(i[0],i[1],i[2],void 0,this.spatialReference):r&&!n?new pe(i[0],i[1],void 0,i[2],this.spatialReference):n&&r?new pe(i[0],i[1],i[2],i[3],this.spatialReference):new pe(i[0],i[1],this.spatialReference)}insertPoint(t,e,i){return this._validateInputs(t,e,!0)?(ib(this,i),Array.isArray(i)||(i=i.toArray()),this.rings[t].splice(e,0,i),this.notifyChange("rings"),this):this}removePoint(t,e){if(!this._validateInputs(t,e))return null;const i=new pe(this.rings[t].splice(e,1)[0],this.spatialReference);return this.notifyChange("rings"),i}removeRing(t){if(!this._validateInputs(t,null))return null;const e=this.rings.splice(t,1)[0],i=this.spatialReference,n=e.map(r=>new pe(r,i));return this.notifyChange("rings"),n}setPoint(t,e,i){return this._validateInputs(t,e)?(ib(this,i),Array.isArray(i)||(i=i.toArray()),this.rings[t][e]=i,this.notifyChange("rings"),this):this}_validateInputs(t,e,i=!1){if(t==null||t<0||t>=this.rings.length)return!1;if(e!=null){const n=this.rings[t];if(i&&(e<0||e>n.length)||!i&&(e<0||e>=n.length))return!1}return!0}toJSON(t){return this.write({},t)}};h([p({readOnly:!0})],Uc.prototype,"cache",null),h([p({readOnly:!0})],Uc.prototype,"centroid",null),h([p({readOnly:!0})],Uc.prototype,"extent",null),h([p({readOnly:!0})],Uc.prototype,"isSelfIntersecting",null),h([p({type:[[[Number]]],json:{write:{isRequired:!0}}})],Uc.prototype,"rings",void 0),h([ge("rings")],Uc.prototype,"writeRings",null),Uc=eM=h([P("esri.geometry.Polygon")],Uc),Uc.prototype.toJSON.isDefaultToJSON=!0;const Vr=Uc;var PR;function ywe(t){return!Array.isArray(t[0])}let Xd=PR=class extends md{constructor(...t){super(...t),this.paths=[],this.type="polyline"}normalizeCtorArgs(t,e){let i,n,r=null,s=null;return t&&!Array.isArray(t)?(r=t.paths??null,e||(t.spatialReference?e=t.spatialReference:t.paths||(e=t)),i=t.hasZ,n=t.hasM):r=t,r=r||[],e=e||Ee.WGS84,r.length&&r[0]&&r[0][0]!=null&&typeof r[0][0]=="number"&&(r=[r]),s=r[0]&&r[0][0],s&&(i===void 0&&n===void 0?(i=s.length>2,n=!1):i===void 0?i=!n&&s.length>3:n===void 0&&(n=!i&&s.length>3)),{paths:r,spatialReference:e,hasZ:i,hasM:n}}get cache(){return this.commitProperty("paths"),this.commitProperty("hasZ"),this.commitProperty("hasM"),this.commitProperty("spatialReference"),{}}get extent(){const{spatialReference:t}=this,e=Wee(this);if(!e)return null;const i=new Le(e);return i.spatialReference=t,i}writePaths(t,e){e.paths=q(this.paths)}addPath(t){if(!t)return;const e=this.paths,i=e.length;if(ywe(t)){const n=[];for(let r=0,s=t.length;r<s;r++)n[r]=t[r].toArray();e[i]=n}else e[i]=t.concat();return this.notifyChange("paths"),this}clone(){const t=new PR;return t.spatialReference=this.spatialReference,t.paths=q(this.paths),t.hasZ=this.hasZ,t.hasM=this.hasM,t}getPoint(t,e){if(!this._validateInputs(t,e))return null;const i=this.paths[t][e],n=this.hasZ,r=this.hasM;return n&&!r?new pe(i[0],i[1],i[2],void 0,this.spatialReference):r&&!n?new pe(i[0],i[1],void 0,i[2],this.spatialReference):n&&r?new pe(i[0],i[1],i[2],i[3],this.spatialReference):new pe(i[0],i[1],this.spatialReference)}insertPoint(t,e,i){return this._validateInputs(t,e,!0)?(ib(this,i),Array.isArray(i)||(i=i.toArray()),this.paths[t].splice(e,0,i),this.notifyChange("paths"),this):this}removePath(t){if(!this._validateInputs(t,null))return null;const e=this.paths.splice(t,1)[0],i=this.spatialReference,n=e.map(r=>new pe(r,i));return this.notifyChange("paths"),n}removePoint(t,e){if(!this._validateInputs(t,e))return null;const i=new pe(this.paths[t].splice(e,1)[0],this.spatialReference);return this.notifyChange("paths"),i}setPoint(t,e,i){return this._validateInputs(t,e)?(ib(this,i),Array.isArray(i)||(i=i.toArray()),this.paths[t][e]=i,this.notifyChange("paths"),this):this}_validateInputs(t,e,i=!1){if(t==null||t<0||t>=this.paths.length)return!1;if(e!=null){const n=this.paths[t];if(i&&(e<0||e>n.length)||!i&&(e<0||e>=n.length))return!1}return!0}toJSON(t){return this.write({},t)}};h([p({readOnly:!0})],Xd.prototype,"cache",null),h([p({readOnly:!0})],Xd.prototype,"extent",null),h([p({type:[[[Number]]],json:{write:{isRequired:!0}}})],Xd.prototype,"paths",void 0),h([ge("paths")],Xd.prototype,"writePaths",null),Xd=PR=h([P("esri.geometry.Polyline")],Xd),Xd.prototype.toJSON.isDefaultToJSON=!0;const Ms=Xd,O6=Nn()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon"}),dlt=Nn()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh"});function Jee(t){return t.xmin!==void 0&&t.ymin!==void 0&&t.xmax!==void 0&&t.ymax!==void 0}function Zee(t){return t.points!==void 0}function Yee(t){return t.x!==void 0&&t.y!==void 0}function Xee(t){return t.paths!==void 0}function $_(t){return t.rings!==void 0}function ad(t){return t==null?null:t instanceof md?t:Yee(t)?pe.fromJSON(t):Xee(t)?Ms.fromJSON(t):$_(t)?Vr.fromJSON(t):Zee(t)?Cf.fromJSON(t):Jee(t)?Le.fromJSON(t):null}function Db(t){return t?Yee(t)?"esriGeometryPoint":Xee(t)?"esriGeometryPolyline":$_(t)?"esriGeometryPolygon":Jee(t)?"esriGeometryEnvelope":Zee(t)?"esriGeometryMultipoint":null:null}const vwe={esriGeometryPoint:pe,esriGeometryPolyline:Ms,esriGeometryPolygon:Vr,esriGeometryEnvelope:Le,esriGeometryMultipoint:Cf};function _we(t){return t&&vwe[t]||null}const r0={base:md,key:"type",typeMap:{extent:Le,multipoint:Cf,point:pe,polyline:Ms,polygon:Vr}};nd(r0);let Kee=0;const Nb=t=>{let e=class extends t{constructor(...i){super(...i),Object.defineProperty(this,"uid",{writable:!1,configurable:!1,value:Date.now().toString(16)+"-object-"+Kee++})}};return e=h([P("esri.core.Identifiable")],e),e},L6=t=>{let e=class extends t{constructor(...i){super(...i),Object.defineProperty(this,"uid",{writable:!1,configurable:!1,value:Kee++})}};return e=h([P("esri.core.NumericIdentifiable")],e),e};let U9=class extends Nb(class{}){};U9=h([P("esri.core.Identifiable")],U9);async function bwe(t){const e="portalItem"in t?t:{portalItem:t},{fromItem:i}=await Y(()=>import("./portalLayers-ccf3da0c.js"),["./portalLayers-ccf3da0c.js","./lazyLayerLoader-722c0802.js","./layersLoader-cf53bd10.js","./fetchService-3a21abab.js","./jsonContext-491a2ecb.js","./styleUtils-fd6677de.js"],import.meta.url);try{return await i(e)}catch(n){const r=e&&e.portalItem,s=r&&r.id||"unset",o=r&&r.portal&&r.portal.url||Tt.portalUrl;throw ne.getLogger("esri.layers.support.fromPortalItem").error("#fromPortalItem()","Failed to create layer from portal item (portal: '"+o+"', id: '"+s+"')",n),n}}let wwe=0,dr=class extends Uo.EventedMixin(Nb(rd)){constructor(){super(...arguments),this.attributionDataUrl=null,this.fullExtent=new Le(-180,-90,180,90,Ee.WGS84),this.id=Date.now().toString(16)+"-layer-"+wwe++,this.legendEnabled=!0,this.listMode="show",this.opacity=1,this.parent=null,this.popupEnabled=!0,this.attributionVisible=!0,this.spatialReference=Ee.WGS84,this.title=null,this.type=null,this.url=null,this.visible=!0}static async fromArcGISServerUrl(e){const i=typeof e=="string"?{url:e}:e;return(await Y(()=>import("./arcgisLayers-ddd633d0.js"),["./arcgisLayers-ddd633d0.js","./fetchService-3a21abab.js","./lazyLayerLoader-722c0802.js"],import.meta.url)).fromUrl(i)}static fromPortalItem(e){return bwe(e)}initialize(){this.when().catch(e=>{Ds(e)||ne.getLogger(this).error("#load()",`Failed to load layer (title: '${this.title??"no title"}', id: '${this.id??"no id"}')`,{error:e})})}destroy(){if(this.parent){const e=this,i=this.parent;"layers"in i&&i.layers.includes(e)?i.layers.remove(e):"tables"in i&&i.tables.includes(e)?i.tables.remove(e):"baseLayers"in i&&i.baseLayers.includes(e)?i.baseLayers.remove(e):"baseLayers"in i&&i.referenceLayers.includes(e)&&i.referenceLayers.remove(e)}}get hasAttributionData(){return this.attributionDataUrl!=null}get parsedUrl(){return ir(this.url)}async fetchAttributionData(){const e=this.attributionDataUrl;if(this.hasAttributionData&&e)return(await gt(e,{query:{f:"json"},responseType:"json"})).data;throw new V("layer:no-attribution-data","Layer does not have attribution data")}};h([p({type:String})],dr.prototype,"attributionDataUrl",void 0),h([p({type:Le})],dr.prototype,"fullExtent",void 0),h([p({readOnly:!0})],dr.prototype,"hasAttributionData",null),h([p({type:String,clonable:!1})],dr.prototype,"id",void 0),h([p({type:Boolean,nonNullable:!0})],dr.prototype,"legendEnabled",void 0),h([p({type:["show","hide","hide-children"]})],dr.prototype,"listMode",void 0),h([p({type:Number,range:{min:0,max:1},nonNullable:!0})],dr.prototype,"opacity",void 0),h([p({clonable:!1})],dr.prototype,"parent",void 0),h([p({readOnly:!0})],dr.prototype,"parsedUrl",null),h([p({type:Boolean})],dr.prototype,"popupEnabled",void 0),h([p({type:Boolean})],dr.prototype,"attributionVisible",void 0),h([p({type:Ee})],dr.prototype,"spatialReference",void 0),h([p({type:String})],dr.prototype,"title",void 0),h([p({readOnly:!0,json:{read:!1}})],dr.prototype,"type",void 0),h([p()],dr.prototype,"url",void 0),h([p({type:Boolean,nonNullable:!0})],dr.prototype,"visible",void 0),dr=h([P("esri.layers.Layer")],dr);const lP=dr;function kR(t,e,i){let n,r;if(t)for(let s=0,o=t.length;s<o;s++){if(n=t.at(s),(n==null?void 0:n[e])===i)return n;if((n==null?void 0:n.type)==="group"&&(r=kR(n.layers,e,i),r))return r}}const xwe=t=>{let e=class extends t{constructor(...i){super(...i),this.layers=new xe;const n=o=>{o.parent&&"remove"in o.parent&&o.parent.remove(o)},r=o=>{o.parent=this,this.layerAdded(o),o.type!=="elevation"&&o.type!=="base-elevation"||ne.getLogger(this).error(`Layer 'title:${o.title}, id:${o.id}' of type '${o.type}' is not supported as an operational layer and will therefore be ignored.`)},s=o=>{o.parent=null,this.layerRemoved(o)};this.addHandles([this.layers.on("before-add",o=>n(o.item)),this.layers.on("after-add",o=>r(o.item)),this.layers.on("after-remove",o=>s(o.item))])}destroy(){const i=this.layers.toArray();for(const n of i)n.destroy();this.layers.destroy()}set layers(i){this._set("layers",Of(i,this._get("layers")))}add(i,n){const r=this.layers;if(n=r.getNextIndex(n),i instanceof lP){const s=i;s.parent===this?this.reorder(s,n):r.add(s,n)}else fd(i)?i.then(s=>{this.destroyed||this.add(s,n)}):ne.getLogger(this).error("#add()","The item being added is not a Layer or a Promise that resolves to a Layer.")}addMany(i,n){const r=this.layers;let s=r.getNextIndex(n);i.slice().forEach(o=>{o.parent!==this?(r.add(o,s),s+=1):this.reorder(o,s)})}findLayerById(i){return kR(this.layers,"id",i)}findLayerByUid(i){return kR(this.layers,"uid",i)}remove(i){return this.layers.remove(i)}removeMany(i){return this.layers.removeMany(i)}removeAll(){return this.layers.removeAll()}reorder(i,n){return this.layers.reorder(i,n)}layerAdded(i){}layerRemoved(i){}};return h([p()],e.prototype,"layers",null),e=h([P("esri.support.LayersMixin")],e),e};function OR(t,e,i){if(t)for(let n=0,r=t.length;n<r;n++){const s=t.at(n);if(s[e]===i)return s;if((s==null?void 0:s.type)==="group"){const o=OR(s.tables,e,i);if(o)return o}}}const Swe=t=>{let e=class extends t{constructor(...i){super(...i),this.tables=new xe,this.addHandles([this.tables.on("after-add",n=>{const r=n.item;r.parent&&r.parent!==this&&"tables"in r.parent&&r.parent.tables.remove(r),r.parent=this,r.type!=="feature"&&ne.getLogger(this).error(`Layer 'title:${r.title}, id:${r.id}' of type '${r.type}' is not supported as a table and will therefore be ignored.`)}),this.tables.on("after-remove",n=>{n.item.parent=null})])}destroy(){const i=this.tables.removeAll();for(const n of i)n.destroy();this.tables.destroy()}set tables(i){this._set("tables",Of(i,this._get("tables")))}findTableById(i){return OR(this.tables,"id",i)}findTableByUid(i){return OR(this.tables,"uid",i)}};return h([p()],e.prototype,"tables",null),e=h([P("esri.support.TablesMixin")],e),e};let Gc=class extends Swe(xwe(Uo.EventedMixin(ye))){constructor(e){super(e),this.allLayers=new L2({getCollections:()=>{var i,n,r;return[(i=this.basemap)==null?void 0:i.baseLayers,(n=this.ground)==null?void 0:n.layers,this.layers,(r=this.basemap)==null?void 0:r.referenceLayers]},getChildrenFunction:i=>"layers"in i?i.layers:null}),this.allTables=j1e(this),this.basemap=null,this.editableLayers=new L2({getCollections:()=>[this.allLayers],itemFilterFunction:Tee}),this.ground=new O2,this._basemapCache=O1e()}destroy(){var e,i;this.allLayers.destroy(),this.allTables.destroy(),this.editableLayers.destroy(),(e=this.ground)==null||e.destroy(),(i=this.basemap)==null||i.destroy(),Iee(this._basemapCache),this._basemapCache=null}castBasemap(e){return QC(e,this._basemapCache)}castGround(e){return B1e(e)??this._get("ground")}findLayerById(e){return this.allLayers.find(i=>i.id===e)}findTableById(e){return this.allTables.find(i=>i.id===e)}};h([p({readOnly:!0,dependsOn:[]})],Gc.prototype,"allLayers",void 0),h([p({readOnly:!0})],Gc.prototype,"allTables",void 0),h([p({type:KE})],Gc.prototype,"basemap",void 0),h([ut("basemap")],Gc.prototype,"castBasemap",null),h([p({readOnly:!0})],Gc.prototype,"editableLayers",void 0),h([p({type:O2,nonNullable:!0})],Gc.prototype,"ground",void 0),h([ut("ground")],Gc.prototype,"castGround",null),Gc=h([P("esri.Map")],Gc);const Qee=Gc,An=t=>{let e=class extends t{clone(){var l;const i=Lr(no(this),"unable to clone instance of non-accessor class"),n=i.metadatas,r=i.store,s={},o=new Map;for(const c in n){const u=n[c],d=r==null?void 0:r.originOf(c),f=u.clonable;if(u.readOnly||f===!1||d!==Ge.USER&&d!==Ge.DEFAULTS&&d!==Ge.WEB_MAP&&d!==Ge.WEB_SCENE)continue;const m=this[c];let g=null;g=typeof f=="function"?f(m):f==="reference"?m:WL(m),m!=null&&g==null||(d===Ge.DEFAULTS?o.set(c,g):s[c]=g)}const a=new(Object.getPrototypeOf(this)).constructor(s);if(o.size){const c=(l=no(a))==null?void 0:l.store;if(c)for(const[u,d]of o)c.set(u,d,Ge.DEFAULTS)}return a}};return e=h([P("esri.core.Clonable")],e),e};let G9=class extends An(ye){};G9=h([P("esri.core.Clonable")],G9);var rb;function ete(t,e){switch(t.type){case"range":{const i="range"in t?t.range[0]:t.minValue,n="range"in t?t.range[1]:t.maxValue;if(i!=null&&+e<i||n!=null&&+e>n)return rb.VALUE_OUT_OF_RANGE;break}case"coded-value":case"codedValue":if(t.codedValues==null||t.codedValues.every(i=>i==null||i.code!==e))return rb.INVALID_CODED_VALUE}return null}function tte(t){if(!(!t||t.type!=="range"))return{min:"range"in t?t.range[0]:t.minValue,max:"range"in t?t.range[1]:t.maxValue}}(function(t){t.VALUE_OUT_OF_RANGE="domain-validation-error::value-out-of-range",t.INVALID_CODED_VALUE="domain-validation-error::invalid-coded-value"})(rb||(rb={}));const Twe=ne.getLogger("esri.support.arcadeOnDemand");let m3;function ld(){return m3||(m3=(async()=>{const t=await Y(()=>import("./arcadeUtils-f0d2f94f.js").then(e=>e.av),["./arcadeUtils-f0d2f94f.js","./arcadeTimeUtils-31294c74.js","./executionError-c92d3b85.js","./number-9efd2333.js","./featureConversionUtils-7f0dd1f5.js","./OptimizedFeature-4701473b.js","./OptimizedFeatureSet-1d1ac4b9.js","./OptimizedGeometry-196224d4.js","./centroid-c77ae2ef.js"],import.meta.url);return{arcade:t.arcade,arcadeUtils:t,Dictionary:t.Dictionary,Feature:t.arcadeFeature}})()),m3}const ylt=(t,e,i)=>R6.create(t,e,i,null,["$feature"],[]),vlt=(t,e,i)=>R6.create(t,e,i,null,["$feature","$view"],[]),Iwe=(t,e,i,n)=>R6.create(t,e,i,n,["$feature","$view"],[]);let R6=class ite{constructor(e,i,n,r,s,o,a){this.services=null,this.script=e,this.evaluate=r;const l=Array.isArray(o)?o:o.fields;this.fields=l,this._syntaxTree=n,this._arcade=i,this._arcadeFeature=s,this._spatialReference=a,this._referencesGeometry=i.scriptTouchesGeometry(this._syntaxTree),this._referencesScale=this._arcade.referencesMember(this._syntaxTree,"scale")}static async create(e,i,n,r,s,o){const{arcade:a,Feature:l,Dictionary:c}=await ld(),u=Ee.fromJSON(i);let d;try{d=a.parseScript(e,o)}catch(M){return Twe.error(new V("arcade-bad-expression","Failed to parse arcade script",{script:e,error:M})),null}const f=s.reduce((M,E)=>({...M,[E]:null}),{});let m=null;r!=null&&(m=new c(r),m.immutable=!0,f.$config=null);const g=a.scriptUsesGeometryEngine(d),y=g&&a.enableGeometrySupport(),_=a.scriptUsesFeatureSet(d)&&a.enableFeatureSetSupport(),b=a.scriptIsAsync(d),w=b&&a.enableAsyncSupport(),x={vars:f,spatialReference:u,useAsync:!!w};await Promise.all([y,_,w]);const S=new Set;await a.loadDependentModules(S,d,null,b,g);const T=new c;T.immutable=!1,T.setField("scale",0);const I=a.compileScript(d,x),C=(M,E)=>("$view"in M&&M.$view&&(T.setField("scale",typeof M.$view=="object"&&"scale"in M.$view?M.$view.scale:void 0),M.$view=T),m&&(M.$config=m),I({vars:M,spatialReference:u,services:E}));return new ite(e,a,d,C,new l,n,u)}repurposeFeature(e){return e.geometry&&!e.geometry.spatialReference&&(e.geometry.spatialReference=this._spatialReference),this._arcadeFeature.repurposeFromGraphicLikeObject(e.geometry,e.attributes,{fields:this.fields}),this._arcadeFeature}referencesGeometry(){return this._referencesGeometry}referencesScale(){return this._referencesScale}};const Cwe=/^([0-9_])/,Mwe=/[^a-z0-9_\u0080-\uffff]+/gi;function Ewe(t){return t==null?null:t.trim().replaceAll(Mwe,"_").replace(Cwe,"F$1")||null}const Awe=["field","field2","field3","normalizationField","rotationInfo.field","proportionalSymbolInfo.field","proportionalSymbolInfo.normalizationField","colorInfo.field","colorInfo.normalizationField"],$we=["field","normalizationField"];function H9(t,e){if(t!=null&&e!=null){for(const i of Array.isArray(t)?t:[t])if(q9(Awe,i,e),"visualVariables"in i&&i.visualVariables)for(const n of i.visualVariables)q9($we,n,e)}}function q9(t,e,i){if(t)for(const n of t){const r=AS(n,e),s=r&&typeof r!="function"&&i.get(r);s&&dl(n,s.name,e)}}function nte(t,e){var i;if(t!=null&&((i=e==null?void 0:e.fields)!=null&&i.length))if("startField"in t){const n=e.get(t.startField),r=e.get(t.endField);t.startField=(n==null?void 0:n.name)??null,t.endField=(r==null?void 0:r.name)??null}else{const n=e.get(t.startTimeField),r=e.get(t.endTimeField);t.startTimeField=(n==null?void 0:n.name)??null,t.endTimeField=(r==null?void 0:r.name)??null}}const g3=new Set;function D6(t,e){return t&&e?(g3.clear(),R2(g3,t,e),Array.from(g3).sort()):[]}function R2(t,e,i){var n;if(i)if((n=e==null?void 0:e.fields)!=null&&n.length)if(i.includes("*"))for(const{name:r}of e.fields)t.add(r);else for(const r of i)va(t,e,r);else{if(i.includes("*"))return t.clear(),void t.add("*");for(const r of i)r!=null&&t.add(r)}}function va(t,e,i){if(typeof i=="string")if(e){const n=e.get(i);n&&t.add(n.name)}else t.add(i)}function _lt(t,e){return e==null||t==null?[]:e.includes("*")?(t.fields??[]).map(i=>i.name):e}async function ro(t,e,i){var s;if(!i)return;const{arcadeUtils:n}=await ld(),r=n.extractFieldNames(i,(s=e==null?void 0:e.fields)==null?void 0:s.map(o=>o.name));for(const o of r)va(t,e,o)}async function rte(t,e,i){if(i&&i!=="1=1"){const{WhereClause:n}=await Y(()=>import("./WhereClause-831210c9.js").then(s=>s.W),["./WhereClause-831210c9.js","./executionError-c92d3b85.js"],import.meta.url),r=n.create(i,e);if(!r.isStandardized)throw new V("fieldUtils:collectFilterFields","Where clause is not standardized",{where:i});R2(t,e,r.fieldNames)}}function Pwe({displayField:t,fields:e}){return t||(e&&e.length?y3(e,"name-or-title")||y3(e,"unique-identifier")||y3(e,"type-or-category")||kwe(e):null)}function kwe(t){for(const e of t){if(!e||!e.name)continue;const i=e.name.toLowerCase();if(i.includes("name")||i.includes("title"))return e.name}return null}function y3(t,e){for(const i of t)if(i&&i.valueType&&i.valueType===e)return i.name;return null}async function blt(t,e){var n;if(!e)return;const i=(n=e.elevationInfo)==null?void 0:n.featureExpressionInfo;return i?i.collectRequiredFields(t,e.fieldsIndex):void 0}function Owe(t,e,i){i.onStatisticExpression?ro(t,e,i.onStatisticExpression.expression):t.add(i.onStatisticField)}async function wlt(t,e,i){if(!e||!i||!("fields"in i))return;const n=[],r=i.popupTemplate;n.push(Lwe(t,e,r)),i.fields&&n.push(...i.fields.map(async s=>Owe(t,e.fieldsIndex,s))),await Promise.all(n)}async function Lwe(t,e,i){const n=[];i!=null&&i.expressionInfos&&n.push(...i.expressionInfos.map(s=>ro(t,e.fieldsIndex,s.expression)));const r=i==null?void 0:i.content;if(Array.isArray(r))for(const s of r)s.type==="expression"&&s.expressionInfo&&n.push(ro(t,e.fieldsIndex,s.expressionInfo.expression));await Promise.all(n)}async function xlt(t,e,i){e&&(e.timeInfo&&i!=null&&i.timeExtent&&R2(t,e.fieldsIndex,[e.timeInfo.startField,e.timeInfo.endField]),e.floorInfo&&R2(t,e.fieldsIndex,[e.floorInfo.floorField]),i!=null&&i.where!=null&&await rte(t,e.fieldsIndex,i.where))}async function Slt(t,e,i){e&&i&&await Promise.all(i.map(n=>Rwe(t,e,n)))}async function Rwe(t,e,i){e&&i&&(i.valueExpression?await ro(t,e.fieldsIndex,i.valueExpression):i.field&&va(t,e.fieldsIndex,i.field))}function Tlt(t){return t?D6(t.fieldsIndex,ote(t)):[]}function Dwe(t){if(!t)return[];const e=t.geometryFieldsInfo;return e?D6(t.fieldsIndex,[e.shapeAreaField,e.shapeLengthField]):[]}const Nwe=["oid","global-id","guid"],Fwe=["oid","global-id"],zwe=[/^fnode_$/i,/^tnode_$/i,/^lpoly_$/i,/^rpoly_$/i,/^poly_$/i,/^subclass$/i,/^subclass_$/i,/^rings_ok$/i,/^rings_nok$/i,/shape/i,/perimeter/i,/objectid/i,/_i$/i];function ste(t){const e=new Set;N6(t).forEach(n=>e.add(n)),Dwe(t).forEach(n=>e.add(n.toLowerCase()));const i=t&&"infoFor3D"in t?t.infoFor3D:void 0;return i&&(Object.values(i.assetMapFieldRoles).forEach(n=>e.add(n.toLowerCase())),Object.values(i.transformFieldRoles).forEach(n=>e.add(n.toLowerCase()))),Array.from(e)}function ote(t){if(!t)return[];const e="editFieldsInfo"in t&&t.editFieldsInfo;if(!e)return[];const{creationDateField:i,creatorField:n,editDateField:r,editorField:s}=e;return[i,n,r,s].filter(Boolean)}function N6(t){return ote(t).map(e=>e.toLowerCase())}function Vwe(t,e){var i;return t.editable&&!Nwe.includes(t.type)&&!N6(e).includes(((i=t.name)==null?void 0:i.toLowerCase())??"")}function ate(t,e){var n;const i=((n=t.name)==null?void 0:n.toLowerCase())??"";return!((e==null?void 0:e.objectIdField)!=null&&i===e.objectIdField.toLowerCase()||(e==null?void 0:e.globalIdField)!=null&&i===e.globalIdField.toLowerCase()||ste(e).includes(i)||Fwe.includes(t.type)||zwe.some(r=>r.test(i)))}async function Ilt(t,e){const{labelingInfo:i,fieldsIndex:n}=e;i&&i.length&&await Promise.all(i.map(r=>jwe(t,n,r)))}async function jwe(t,e,i){if(!i)return;const n=i.getLabelExpression(),r=i.where;if(n.type==="arcade")await ro(t,e,n.expression);else{const s=n.expression.match(/{[^}]*}/g);s&&s.forEach(o=>{va(t,e,o.slice(1,-1))})}await rte(t,e,r)}function Bwe(t){const e=t.defaultValue;return e!==void 0&&ute(t,e)?e:t.nullable?null:void 0}function lte(t){return typeof t=="number"&&!isNaN(t)&&isFinite(t)}function Uwe(t){return t===null||lte(t)}const F6="isInteger"in Number?Number.isInteger:t=>typeof t=="number"&&isFinite(t)&&Math.floor(t)===t;function Gwe(t){return t===null||F6(t)}function cte(t){return t!=null&&typeof t=="string"}function Hwe(t){return t===null||cte(t)}function qwe(){return!0}function ute(t,e){let i;switch(t.type){case"date":case"integer":case"long":case"small-integer":case"esriFieldTypeDate":case"esriFieldTypeInteger":case"esriFieldTypeLong":case"esriFieldTypeSmallInteger":i=t.nullable?Gwe:F6;break;case"double":case"single":case"esriFieldTypeSingle":case"esriFieldTypeDouble":i=t.nullable?Uwe:lte;break;case"string":case"esriFieldTypeString":i=t.nullable?Hwe:cte;break;default:i=qwe}return arguments.length===1?i:i(e)}const Wwe=["integer","small-integer","single","double"],Jwe=new Set([...Wwe,"esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeSingle","esriFieldTypeDouble"]),Zwe=["date","date-only","time-only","timestamp-offset"],Ywe=new Set([...Zwe,"esriFieldTypeDate","esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset"]);function xu(t){return t!=null&&Jwe.has(t.type)}function LR(t){return t!=null&&(t.type==="string"||t.type==="esriFieldTypeString")}function iA(t){return t!=null&&Ywe.has(t.type)}var nA,D2;function Clt(t){return t==null||typeof t=="number"&&isNaN(t)?null:t}function Xwe(t,e){return t==null||t.nullable&&e===null?null:xu(t)&&!Kwe(t.type,Number(e))?nA.OUT_OF_RANGE:ute(t,e)?t.domain?ete(t.domain,e):null:D2.INVALID_TYPE}function Kwe(t,e){const i=typeof t=="string"?z6(t):t;if(!i)return!1;const n=i.min,r=i.max;return i.isInteger?F6(e)&&e>=n&&e<=r:e>=n&&e<=r}function Qwe(t){return tte(t.domain)||(xu(t)?z6(t.type):void 0)}function z6(t){switch(t){case"esriFieldTypeSmallInteger":case"small-integer":return exe;case"esriFieldTypeInteger":case"integer":return txe;case"esriFieldTypeBigInteger":case"big-integer":return ixe;case"esriFieldTypeSingle":case"single":return nxe;case"esriFieldTypeDouble":case"double":return rxe}}(function(t){t.OUT_OF_RANGE="numeric-range-validation-error::out-of-range"})(nA||(nA={})),function(t){t.INVALID_TYPE="type-validation-error::invalid-type"}(D2||(D2={}));const exe={min:-32768,max:32767,isInteger:!0},txe={min:-2147483648,max:2147483647,isInteger:!0},ixe={min:-Number.MAX_SAFE_INTEGER,max:Number.MAX_SAFE_INTEGER,isInteger:!0},nxe={min:-34e37,max:12e37,isInteger:!1},rxe={min:-Number.MAX_VALUE,max:Number.MAX_VALUE,isInteger:!1};function Mlt(t,e,i){switch(t){case rb.INVALID_CODED_VALUE:return`Value ${i} is not in the coded domain - field: ${e.name}, domain: ${JSON.stringify(e.domain)}`;case rb.VALUE_OUT_OF_RANGE:return`Value ${i} is out of the range of valid values - field: ${e.name}, domain: ${JSON.stringify(e.domain)}`;case D2.INVALID_TYPE:return`Value ${i} is not a valid value for the field type - field: ${e.name}, type: ${e.type}, nullable: ${e.nullable}`;case nA.OUT_OF_RANGE:{const{min:n,max:r}=z6(e.type);return`Value ${i} is out of range for the number type - field: ${e.name}, type: ${e.type}, value range is ${n} to ${r}`}}}function sxe(t,e){return!oxe(t,e,null)}function oxe(t,e,i){if(!e||!e.attributes||!t){if(i!=null)for(const s of t??[])i.add(s);return!0}const n=e.attributes;let r=!1;for(const s of t)if(!(s in n)){if(r=!0,i==null)break;i.add(s)}return r}function RR(t){return!!t&&["raster.itempixelvalue","raster.servicepixelvalue"].some(e=>t.toLowerCase().startsWith(e))}let tM=class extends ie{constructor(e){super(e),this.type=null}};h([p({type:["attachments","custom","fields","media","text","expression","relationship"],readOnly:!0,json:{read:!1,write:!0}})],tM.prototype,"type",void 0),tM=h([P("esri.popup.content.Content")],tM);const Wf=tM;var DR;let Lm=DR=class extends Wf{constructor(t){super(t),this.description=null,this.displayType="auto",this.title=null,this.type="attachments"}clone(){return new DR({description:this.description,displayType:this.displayType,title:this.title})}};h([p({type:String,json:{write:!0}})],Lm.prototype,"description",void 0),h([p({type:["auto","preview","list"],json:{write:!0}})],Lm.prototype,"displayType",void 0),h([p({type:String,json:{write:!0}})],Lm.prototype,"title",void 0),h([p({type:["attachments"],readOnly:!0,json:{read:!1,write:!0}})],Lm.prototype,"type",void 0),Lm=DR=h([P("esri.popup.content.AttachmentsContent")],Lm);const N2=Lm;var NR;let Rm=NR=class extends Wf{constructor(t){super(t),this.creator=null,this.destroyer=null,this.outFields=null,this.type="custom"}clone(){return new NR({creator:this.creator,destroyer:this.destroyer,outFields:Array.isArray(this.outFields)?q(this.outFields):null})}};h([p()],Rm.prototype,"creator",void 0),h([p()],Rm.prototype,"destroyer",void 0),h([p()],Rm.prototype,"outFields",void 0),h([p({type:["custom"],readOnly:!0})],Rm.prototype,"type",void 0),Rm=NR=h([P("esri.popup.content.CustomContent")],Rm);const axe=Rm;var FR;let ov=FR=class extends ie{constructor(t){super(t),this.title=null,this.expression=null,this.returnType="dictionary"}clone(){return new FR({title:this.title,expression:this.expression})}};h([p({type:String,json:{write:!0}})],ov.prototype,"title",void 0),h([p({type:String,json:{write:!0}})],ov.prototype,"expression",void 0),h([p({type:["dictionary"],readOnly:!0,json:{read:!1,write:!0}})],ov.prototype,"returnType",void 0),ov=FR=h([P("esri.popup.ElementExpressionInfo")],ov);const lxe=ov;var zR;let hw=zR=class extends Wf{constructor(t){super(t),this.expressionInfo=null,this.type="expression"}clone(){var t;return new zR({expressionInfo:(t=this.expressionInfo)==null?void 0:t.clone()})}};h([p({type:lxe,json:{write:!0}})],hw.prototype,"expressionInfo",void 0),h([p({type:["expression"],readOnly:!0,json:{read:!1,write:!0}})],hw.prototype,"type",void 0),hw=zR=h([P("esri.popup.content.ExpressionContent")],hw);const V6=hw;class s0 extends Error{}class cxe extends s0{constructor(e){super(`Invalid DateTime: ${e.toMessage()}`)}}class uxe extends s0{constructor(e){super(`Invalid Interval: ${e.toMessage()}`)}}class hxe extends s0{constructor(e){super(`Invalid Duration: ${e.toMessage()}`)}}class dw extends s0{}class hte extends s0{constructor(e){super(`Invalid unit ${e}`)}}class el extends s0{}class Ld extends s0{constructor(){super("Zone is an abstract class")}}const Se="numeric",Sc="short",_a="long",rA={year:Se,month:Se,day:Se},dte={year:Se,month:Sc,day:Se},dxe={year:Se,month:Sc,day:Se,weekday:Sc},pte={year:Se,month:_a,day:Se},fte={year:Se,month:_a,day:Se,weekday:_a},mte={hour:Se,minute:Se},gte={hour:Se,minute:Se,second:Se},yte={hour:Se,minute:Se,second:Se,timeZoneName:Sc},vte={hour:Se,minute:Se,second:Se,timeZoneName:_a},_te={hour:Se,minute:Se,hourCycle:"h23"},bte={hour:Se,minute:Se,second:Se,hourCycle:"h23"},wte={hour:Se,minute:Se,second:Se,hourCycle:"h23",timeZoneName:Sc},xte={hour:Se,minute:Se,second:Se,hourCycle:"h23",timeZoneName:_a},Ste={year:Se,month:Se,day:Se,hour:Se,minute:Se},Tte={year:Se,month:Se,day:Se,hour:Se,minute:Se,second:Se},Ite={year:Se,month:Sc,day:Se,hour:Se,minute:Se},Cte={year:Se,month:Sc,day:Se,hour:Se,minute:Se,second:Se},pxe={year:Se,month:Sc,day:Se,weekday:Sc,hour:Se,minute:Se},Mte={year:Se,month:_a,day:Se,hour:Se,minute:Se,timeZoneName:Sc},Ete={year:Se,month:_a,day:Se,hour:Se,minute:Se,second:Se,timeZoneName:Sc},Ate={year:Se,month:_a,day:Se,weekday:_a,hour:Se,minute:Se,timeZoneName:_a},$te={year:Se,month:_a,day:Se,weekday:_a,hour:Se,minute:Se,second:Se,timeZoneName:_a};class VS{get type(){throw new Ld}get name(){throw new Ld}get ianaName(){return this.name}get isUniversal(){throw new Ld}offsetName(e,i){throw new Ld}formatOffset(e,i){throw new Ld}offset(e){throw new Ld}equals(e){throw new Ld}get isValid(){throw new Ld}}let v3=null;class cP extends VS{static get instance(){return v3===null&&(v3=new cP),v3}get type(){return"system"}get name(){return new Intl.DateTimeFormat().resolvedOptions().timeZone}get isUniversal(){return!1}offsetName(e,{format:i,locale:n}){return kte(e,i,n)}formatOffset(e,i){return Dx(this.offset(e),i)}offset(e){return-new Date(e).getTimezoneOffset()}equals(e){return e.type==="system"}get isValid(){return!0}}let iM={};function fxe(t){return iM[t]||(iM[t]=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:t,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",era:"short"})),iM[t]}const mxe={year:0,month:1,day:2,era:3,hour:4,minute:5,second:6};function gxe(t,e){const i=t.format(e).replace(/\u200E/g,""),n=/(\d+)\/(\d+)\/(\d+) (AD|BC),? (\d+):(\d+):(\d+)/.exec(i),[,r,s,o,a,l,c,u]=n;return[o,r,s,a,l,c,u]}function yxe(t,e){const i=t.formatToParts(e),n=[];for(let r=0;r<i.length;r++){const{type:s,value:o}=i[r],a=mxe[s];s==="era"?n[a]=o:Ot(a)||(n[a]=parseInt(o,10))}return n}let ZT={};class cd extends VS{static create(e){return ZT[e]||(ZT[e]=new cd(e)),ZT[e]}static resetCache(){ZT={},iM={}}static isValidSpecifier(e){return this.isValidZone(e)}static isValidZone(e){if(!e)return!1;try{return new Intl.DateTimeFormat("en-US",{timeZone:e}).format(),!0}catch{return!1}}constructor(e){super(),this.zoneName=e,this.valid=cd.isValidZone(e)}get type(){return"iana"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(e,{format:i,locale:n}){return kte(e,i,n,this.name)}formatOffset(e,i){return Dx(this.offset(e),i)}offset(e){const i=new Date(e);if(isNaN(i))return NaN;const n=fxe(this.name);let[r,s,o,a,l,c,u]=n.formatToParts?yxe(n,i):gxe(n,i);a==="BC"&&(r=-Math.abs(r)+1);const f=U6({year:r,month:s,day:o,hour:l===24?0:l,minute:c,second:u,millisecond:0});let m=+i;const g=m%1e3;return m-=g>=0?g:1e3+g,(f-m)/(60*1e3)}equals(e){return e.type==="iana"&&e.name===this.name}get isValid(){return this.valid}}let W9={};function vxe(t,e={}){const i=JSON.stringify([t,e]);let n=W9[i];return n||(n=new Intl.ListFormat(t,e),W9[i]=n),n}let VR={};function jR(t,e={}){const i=JSON.stringify([t,e]);let n=VR[i];return n||(n=new Intl.DateTimeFormat(t,e),VR[i]=n),n}let BR={};function _xe(t,e={}){const i=JSON.stringify([t,e]);let n=BR[i];return n||(n=new Intl.NumberFormat(t,e),BR[i]=n),n}let UR={};function bxe(t,e={}){const{base:i,...n}=e,r=JSON.stringify([t,n]);let s=UR[r];return s||(s=new Intl.RelativeTimeFormat(t,e),UR[r]=s),s}let pw=null;function wxe(){return pw||(pw=new Intl.DateTimeFormat().resolvedOptions().locale,pw)}function xxe(t){const e=t.indexOf("-x-");e!==-1&&(t=t.substring(0,e));const i=t.indexOf("-u-");if(i===-1)return[t];{let n,r;try{n=jR(t).resolvedOptions(),r=t}catch{const l=t.substring(0,i);n=jR(l).resolvedOptions(),r=l}const{numberingSystem:s,calendar:o}=n;return[r,s,o]}}function Sxe(t,e,i){return(i||e)&&(t.includes("-u-")||(t+="-u"),i&&(t+=`-ca-${i}`),e&&(t+=`-nu-${e}`)),t}function Txe(t){const e=[];for(let i=1;i<=12;i++){const n=Ve.utc(2016,i,1);e.push(t(n))}return e}function Ixe(t){const e=[];for(let i=1;i<=7;i++){const n=Ve.utc(2016,11,13+i);e.push(t(n))}return e}function YT(t,e,i,n,r){const s=t.listingMode(i);return s==="error"?null:s==="en"?n(e):r(e)}function Cxe(t){return t.numberingSystem&&t.numberingSystem!=="latn"?!1:t.numberingSystem==="latn"||!t.locale||t.locale.startsWith("en")||new Intl.DateTimeFormat(t.intl).resolvedOptions().numberingSystem==="latn"}class Mxe{constructor(e,i,n){this.padTo=n.padTo||0,this.floor=n.floor||!1;const{padTo:r,floor:s,...o}=n;if(!i||Object.keys(o).length>0){const a={useGrouping:!1,...n};n.padTo>0&&(a.minimumIntegerDigits=n.padTo),this.inf=_xe(e,a)}}format(e){if(this.inf){const i=this.floor?Math.floor(e):e;return this.inf.format(i)}else{const i=this.floor?Math.floor(e):B6(e,3);return Xn(i,this.padTo)}}}class Exe{constructor(e,i,n){this.opts=n,this.originalZone=void 0;let r;if(this.opts.timeZone)this.dt=e;else if(e.zone.type==="fixed"){const o=-1*(e.offset/60),a=o>=0?`Etc/GMT+${o}`:`Etc/GMT${o}`;e.offset!==0&&cd.create(a).valid?(r=a,this.dt=e):(r="UTC",this.dt=e.offset===0?e:e.setZone("UTC").plus({minutes:e.offset}),this.originalZone=e.zone)}else e.zone.type==="system"?this.dt=e:e.zone.type==="iana"?(this.dt=e,r=e.zone.name):(r="UTC",this.dt=e.setZone("UTC").plus({minutes:e.offset}),this.originalZone=e.zone);const s={...this.opts};s.timeZone=s.timeZone||r,this.dtf=jR(i,s)}format(){return this.originalZone?this.formatToParts().map(({value:e})=>e).join(""):this.dtf.format(this.dt.toJSDate())}formatToParts(){const e=this.dtf.formatToParts(this.dt.toJSDate());return this.originalZone?e.map(i=>{if(i.type==="timeZoneName"){const n=this.originalZone.offsetName(this.dt.ts,{locale:this.dt.locale,format:this.opts.timeZoneName});return{...i,value:n}}else return i}):e}resolvedOptions(){return this.dtf.resolvedOptions()}}class Axe{constructor(e,i,n){this.opts={style:"long",...n},!i&&Pte()&&(this.rtf=bxe(e,n))}format(e,i){return this.rtf?this.rtf.format(e,i):qxe(i,e,this.opts.numeric,this.opts.style!=="long")}formatToParts(e,i){return this.rtf?this.rtf.formatToParts(e,i):[]}}class Bi{static fromOpts(e){return Bi.create(e.locale,e.numberingSystem,e.outputCalendar,e.defaultToEN)}static create(e,i,n,r=!1){const s=e||Yn.defaultLocale,o=s||(r?"en-US":wxe()),a=i||Yn.defaultNumberingSystem,l=n||Yn.defaultOutputCalendar;return new Bi(o,a,l,s)}static resetCache(){pw=null,VR={},BR={},UR={}}static fromObject({locale:e,numberingSystem:i,outputCalendar:n}={}){return Bi.create(e,i,n)}constructor(e,i,n,r){const[s,o,a]=xxe(e);this.locale=s,this.numberingSystem=i||o||null,this.outputCalendar=n||a||null,this.intl=Sxe(this.locale,this.numberingSystem,this.outputCalendar),this.weekdaysCache={format:{},standalone:{}},this.monthsCache={format:{},standalone:{}},this.meridiemCache=null,this.eraCache={},this.specifiedLocale=r,this.fastNumbersCached=null}get fastNumbers(){return this.fastNumbersCached==null&&(this.fastNumbersCached=Cxe(this)),this.fastNumbersCached}listingMode(){const e=this.isEnglish(),i=(this.numberingSystem===null||this.numberingSystem==="latn")&&(this.outputCalendar===null||this.outputCalendar==="gregory");return e&&i?"en":"intl"}clone(e){return!e||Object.getOwnPropertyNames(e).length===0?this:Bi.create(e.locale||this.specifiedLocale,e.numberingSystem||this.numberingSystem,e.outputCalendar||this.outputCalendar,e.defaultToEN||!1)}redefaultToEN(e={}){return this.clone({...e,defaultToEN:!0})}redefaultToSystem(e={}){return this.clone({...e,defaultToEN:!1})}months(e,i=!1,n=!0){return YT(this,e,n,Rte,()=>{const r=i?{month:e,day:"numeric"}:{month:e},s=i?"format":"standalone";return this.monthsCache[s][e]||(this.monthsCache[s][e]=Txe(o=>this.extract(o,r,"month"))),this.monthsCache[s][e]})}weekdays(e,i=!1,n=!0){return YT(this,e,n,Fte,()=>{const r=i?{weekday:e,year:"numeric",month:"long",day:"numeric"}:{weekday:e},s=i?"format":"standalone";return this.weekdaysCache[s][e]||(this.weekdaysCache[s][e]=Ixe(o=>this.extract(o,r,"weekday"))),this.weekdaysCache[s][e]})}meridiems(e=!0){return YT(this,void 0,e,()=>zte,()=>{if(!this.meridiemCache){const i={hour:"numeric",hourCycle:"h12"};this.meridiemCache=[Ve.utc(2016,11,13,9),Ve.utc(2016,11,13,19)].map(n=>this.extract(n,i,"dayperiod"))}return this.meridiemCache})}eras(e,i=!0){return YT(this,e,i,Vte,()=>{const n={era:e};return this.eraCache[e]||(this.eraCache[e]=[Ve.utc(-40,1,1),Ve.utc(2017,1,1)].map(r=>this.extract(r,n,"era"))),this.eraCache[e]})}extract(e,i,n){const r=this.dtFormatter(e,i),s=r.formatToParts(),o=s.find(a=>a.type.toLowerCase()===n);return o?o.value:null}numberFormatter(e={}){return new Mxe(this.intl,e.forceSimple||this.fastNumbers,e)}dtFormatter(e,i={}){return new Exe(e,this.intl,i)}relFormatter(e={}){return new Axe(this.intl,this.isEnglish(),e)}listFormatter(e={}){return vxe(this.intl,e)}isEnglish(){return this.locale==="en"||this.locale.toLowerCase()==="en-us"||new Intl.DateTimeFormat(this.intl).resolvedOptions().locale.startsWith("en-us")}equals(e){return this.locale===e.locale&&this.numberingSystem===e.numberingSystem&&this.outputCalendar===e.outputCalendar}}let _3=null;class Es extends VS{static get utcInstance(){return _3===null&&(_3=new Es(0)),_3}static instance(e){return e===0?Es.utcInstance:new Es(e)}static parseSpecifier(e){if(e){const i=e.match(/^utc(?:([+-]\d{1,2})(?::(\d{2}))?)?$/i);if(i)return new Es(hP(i[1],i[2]))}return null}constructor(e){super(),this.fixed=e}get type(){return"fixed"}get name(){return this.fixed===0?"UTC":`UTC${Dx(this.fixed,"narrow")}`}get ianaName(){return this.fixed===0?"Etc/UTC":`Etc/GMT${Dx(-this.fixed,"narrow")}`}offsetName(){return this.name}formatOffset(e,i){return Dx(this.fixed,i)}get isUniversal(){return!0}offset(){return this.fixed}equals(e){return e.type==="fixed"&&e.fixed===this.fixed}get isValid(){return!0}}class $xe extends VS{constructor(e){super(),this.zoneName=e}get type(){return"invalid"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(){return null}formatOffset(){return""}offset(){return NaN}equals(){return!1}get isValid(){return!1}}function Wp(t,e){if(Ot(t)||t===null)return e;if(t instanceof VS)return t;if(Pxe(t)){const i=t.toLowerCase();return i==="default"?e:i==="local"||i==="system"?cP.instance:i==="utc"||i==="gmt"?Es.utcInstance:Es.parseSpecifier(i)||cd.create(t)}else return my(t)?Es.instance(t):typeof t=="object"&&t.offset&&typeof t.offset=="number"?t:new $xe(t)}let J9=()=>Date.now(),Z9="system",Y9=null,X9=null,K9=null,Q9=60,eU;class Yn{static get now(){return J9}static set now(e){J9=e}static set defaultZone(e){Z9=e}static get defaultZone(){return Wp(Z9,cP.instance)}static get defaultLocale(){return Y9}static set defaultLocale(e){Y9=e}static get defaultNumberingSystem(){return X9}static set defaultNumberingSystem(e){X9=e}static get defaultOutputCalendar(){return K9}static set defaultOutputCalendar(e){K9=e}static get twoDigitCutoffYear(){return Q9}static set twoDigitCutoffYear(e){Q9=e%100}static get throwOnInvalid(){return eU}static set throwOnInvalid(e){eU=e}static resetCaches(){Bi.resetCache(),cd.resetCache()}}function Ot(t){return typeof t>"u"}function my(t){return typeof t=="number"}function uP(t){return typeof t=="number"&&t%1===0}function Pxe(t){return typeof t=="string"}function kxe(t){return Object.prototype.toString.call(t)==="[object Date]"}function Pte(){try{return typeof Intl<"u"&&!!Intl.RelativeTimeFormat}catch{return!1}}function Oxe(t){return Array.isArray(t)?t:[t]}function tU(t,e,i){if(t.length!==0)return t.reduce((n,r)=>{const s=[e(r),r];return n&&i(n[0],s[0])===n[0]?n:s},null)[1]}function Lxe(t,e){return e.reduce((i,n)=>(i[n]=t[n],i),{})}function sb(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Rh(t,e,i){return uP(t)&&t>=e&&t<=i}function Rxe(t,e){return t-e*Math.floor(t/e)}function Xn(t,e=2){const i=t<0;let n;return i?n="-"+(""+-t).padStart(e,"0"):n=(""+t).padStart(e,"0"),n}function Vp(t){if(!(Ot(t)||t===null||t===""))return parseInt(t,10)}function om(t){if(!(Ot(t)||t===null||t===""))return parseFloat(t)}function j6(t){if(!(Ot(t)||t===null||t==="")){const e=parseFloat("0."+t)*1e3;return Math.floor(e)}}function B6(t,e,i=!1){const n=10**e;return(i?Math.trunc:Math.round)(t*n)/n}function jS(t){return t%4===0&&(t%100!==0||t%400===0)}function Rx(t){return jS(t)?366:365}function sA(t,e){const i=Rxe(e-1,12)+1,n=t+(e-i)/12;return i===2?jS(n)?29:28:[31,null,31,30,31,30,31,31,30,31,30,31][i-1]}function U6(t){let e=Date.UTC(t.year,t.month-1,t.day,t.hour,t.minute,t.second,t.millisecond);return t.year<100&&t.year>=0&&(e=new Date(e),e.setUTCFullYear(t.year,t.month-1,t.day)),+e}function oA(t){const e=(t+Math.floor(t/4)-Math.floor(t/100)+Math.floor(t/400))%7,i=t-1,n=(i+Math.floor(i/4)-Math.floor(i/100)+Math.floor(i/400))%7;return e===4||n===3?53:52}function GR(t){return t>99?t:t>Yn.twoDigitCutoffYear?1900+t:2e3+t}function kte(t,e,i,n=null){const r=new Date(t),s={hourCycle:"h23",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};n&&(s.timeZone=n);const o={timeZoneName:e,...s},a=new Intl.DateTimeFormat(i,o).formatToParts(r).find(l=>l.type.toLowerCase()==="timezonename");return a?a.value:null}function hP(t,e){let i=parseInt(t,10);Number.isNaN(i)&&(i=0);const n=parseInt(e,10)||0,r=i<0||Object.is(i,-0)?-n:n;return i*60+r}function Ote(t){const e=Number(t);if(typeof t=="boolean"||t===""||Number.isNaN(e))throw new el(`Invalid unit value ${t}`);return e}function aA(t,e){const i={};for(const n in t)if(sb(t,n)){const r=t[n];if(r==null)continue;i[e(n)]=Ote(r)}return i}function Dx(t,e){const i=Math.trunc(Math.abs(t/60)),n=Math.trunc(Math.abs(t%60)),r=t>=0?"+":"-";switch(e){case"short":return`${r}${Xn(i,2)}:${Xn(n,2)}`;case"narrow":return`${r}${i}${n>0?`:${n}`:""}`;case"techie":return`${r}${Xn(i,2)}${Xn(n,2)}`;default:throw new RangeError(`Value format ${e} is out of range for property format`)}}function dP(t){return Lxe(t,["hour","minute","second","millisecond"])}const Dxe=["January","February","March","April","May","June","July","August","September","October","November","December"],Lte=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],Nxe=["J","F","M","A","M","J","J","A","S","O","N","D"];function Rte(t){switch(t){case"narrow":return[...Nxe];case"short":return[...Lte];case"long":return[...Dxe];case"numeric":return["1","2","3","4","5","6","7","8","9","10","11","12"];case"2-digit":return["01","02","03","04","05","06","07","08","09","10","11","12"];default:return null}}const Dte=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],Nte=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],Fxe=["M","T","W","T","F","S","S"];function Fte(t){switch(t){case"narrow":return[...Fxe];case"short":return[...Nte];case"long":return[...Dte];case"numeric":return["1","2","3","4","5","6","7"];default:return null}}const zte=["AM","PM"],zxe=["Before Christ","Anno Domini"],Vxe=["BC","AD"],jxe=["B","A"];function Vte(t){switch(t){case"narrow":return[...jxe];case"short":return[...Vxe];case"long":return[...zxe];default:return null}}function Bxe(t){return zte[t.hour<12?0:1]}function Uxe(t,e){return Fte(e)[t.weekday-1]}function Gxe(t,e){return Rte(e)[t.month-1]}function Hxe(t,e){return Vte(e)[t.year<0?0:1]}function qxe(t,e,i="always",n=!1){const r={years:["year","yr."],quarters:["quarter","qtr."],months:["month","mo."],weeks:["week","wk."],days:["day","day","days"],hours:["hour","hr."],minutes:["minute","min."],seconds:["second","sec."]},s=["hours","minutes","seconds"].indexOf(t)===-1;if(i==="auto"&&s){const d=t==="days";switch(e){case 1:return d?"tomorrow":`next ${r[t][0]}`;case-1:return d?"yesterday":`last ${r[t][0]}`;case 0:return d?"today":`this ${r[t][0]}`}}const o=Object.is(e,-0)||e<0,a=Math.abs(e),l=a===1,c=r[t],u=n?l?c[1]:c[2]||c[1]:l?r[t][0]:t;return o?`${a} ${u} ago`:`in ${a} ${u}`}function iU(t,e){let i="";for(const n of t)n.literal?i+=n.val:i+=e(n.val);return i}const Wxe={D:rA,DD:dte,DDD:pte,DDDD:fte,t:mte,tt:gte,ttt:yte,tttt:vte,T:_te,TT:bte,TTT:wte,TTTT:xte,f:Ste,ff:Ite,fff:Mte,ffff:Ate,F:Tte,FF:Cte,FFF:Ete,FFFF:$te};class Cs{static create(e,i={}){return new Cs(e,i)}static parseFormat(e){let i=null,n="",r=!1;const s=[];for(let o=0;o<e.length;o++){const a=e.charAt(o);a==="'"?(n.length>0&&s.push({literal:r||/^\s+$/.test(n),val:n}),i=null,n="",r=!r):r||a===i?n+=a:(n.length>0&&s.push({literal:/^\s+$/.test(n),val:n}),n=a,i=a)}return n.length>0&&s.push({literal:r||/^\s+$/.test(n),val:n}),s}static macroTokenToFormatOpts(e){return Wxe[e]}constructor(e,i){this.opts=i,this.loc=e,this.systemLoc=null}formatWithSystemDefault(e,i){return this.systemLoc===null&&(this.systemLoc=this.loc.redefaultToSystem()),this.systemLoc.dtFormatter(e,{...this.opts,...i}).format()}formatDateTime(e,i={}){return this.loc.dtFormatter(e,{...this.opts,...i}).format()}formatDateTimeParts(e,i={}){return this.loc.dtFormatter(e,{...this.opts,...i}).formatToParts()}formatInterval(e,i={}){return this.loc.dtFormatter(e.start,{...this.opts,...i}).dtf.formatRange(e.start.toJSDate(),e.end.toJSDate())}resolvedOptions(e,i={}){return this.loc.dtFormatter(e,{...this.opts,...i}).resolvedOptions()}num(e,i=0){if(this.opts.forceSimple)return Xn(e,i);const n={...this.opts};return i>0&&(n.padTo=i),this.loc.numberFormatter(n).format(e)}formatDateTimeFromString(e,i){const n=this.loc.listingMode()==="en",r=this.loc.outputCalendar&&this.loc.outputCalendar!=="gregory",s=(m,g)=>this.loc.extract(e,m,g),o=m=>e.isOffsetFixed&&e.offset===0&&m.allowZ?"Z":e.isValid?e.zone.formatOffset(e.ts,m.format):"",a=()=>n?Bxe(e):s({hour:"numeric",hourCycle:"h12"},"dayperiod"),l=(m,g)=>n?Gxe(e,m):s(g?{month:m}:{month:m,day:"numeric"},"month"),c=(m,g)=>n?Uxe(e,m):s(g?{weekday:m}:{weekday:m,month:"long",day:"numeric"},"weekday"),u=m=>{const g=Cs.macroTokenToFormatOpts(m);return g?this.formatWithSystemDefault(e,g):m},d=m=>n?Hxe(e,m):s({era:m},"era"),f=m=>{switch(m){case"S":return this.num(e.millisecond);case"u":case"SSS":return this.num(e.millisecond,3);case"s":return this.num(e.second);case"ss":return this.num(e.second,2);case"uu":return this.num(Math.floor(e.millisecond/10),2);case"uuu":return this.num(Math.floor(e.millisecond/100));case"m":return this.num(e.minute);case"mm":return this.num(e.minute,2);case"h":return this.num(e.hour%12===0?12:e.hour%12);case"hh":return this.num(e.hour%12===0?12:e.hour%12,2);case"H":return this.num(e.hour);case"HH":return this.num(e.hour,2);case"Z":return o({format:"narrow",allowZ:this.opts.allowZ});case"ZZ":return o({format:"short",allowZ:this.opts.allowZ});case"ZZZ":return o({format:"techie",allowZ:this.opts.allowZ});case"ZZZZ":return e.zone.offsetName(e.ts,{format:"short",locale:this.loc.locale});case"ZZZZZ":return e.zone.offsetName(e.ts,{format:"long",locale:this.loc.locale});case"z":return e.zoneName;case"a":return a();case"d":return r?s({day:"numeric"},"day"):this.num(e.day);case"dd":return r?s({day:"2-digit"},"day"):this.num(e.day,2);case"c":return this.num(e.weekday);case"ccc":return c("short",!0);case"cccc":return c("long",!0);case"ccccc":return c("narrow",!0);case"E":return this.num(e.weekday);case"EEE":return c("short",!1);case"EEEE":return c("long",!1);case"EEEEE":return c("narrow",!1);case"L":return r?s({month:"numeric",day:"numeric"},"month"):this.num(e.month);case"LL":return r?s({month:"2-digit",day:"numeric"},"month"):this.num(e.month,2);case"LLL":return l("short",!0);case"LLLL":return l("long",!0);case"LLLLL":return l("narrow",!0);case"M":return r?s({month:"numeric"},"month"):this.num(e.month);case"MM":return r?s({month:"2-digit"},"month"):this.num(e.month,2);case"MMM":return l("short",!1);case"MMMM":return l("long",!1);case"MMMMM":return l("narrow",!1);case"y":return r?s({year:"numeric"},"year"):this.num(e.year);case"yy":return r?s({year:"2-digit"},"year"):this.num(e.year.toString().slice(-2),2);case"yyyy":return r?s({year:"numeric"},"year"):this.num(e.year,4);case"yyyyyy":return r?s({year:"numeric"},"year"):this.num(e.year,6);case"G":return d("short");case"GG":return d("long");case"GGGGG":return d("narrow");case"kk":return this.num(e.weekYear.toString().slice(-2),2);case"kkkk":return this.num(e.weekYear,4);case"W":return this.num(e.weekNumber);case"WW":return this.num(e.weekNumber,2);case"o":return this.num(e.ordinal);case"ooo":return this.num(e.ordinal,3);case"q":return this.num(e.quarter);case"qq":return this.num(e.quarter,2);case"X":return this.num(Math.floor(e.ts/1e3));case"x":return this.num(e.ts);default:return u(m)}};return iU(Cs.parseFormat(i),f)}formatDurationFromString(e,i){const n=l=>{switch(l[0]){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":return"hour";case"d":return"day";case"w":return"week";case"M":return"month";case"y":return"year";default:return null}},r=l=>c=>{const u=n(c);return u?this.num(l.get(u),c.length):c},s=Cs.parseFormat(i),o=s.reduce((l,{literal:c,val:u})=>c?l:l.concat(u),[]),a=e.shiftTo(...o.map(n).filter(l=>l));return iU(s,r(a))}}class uc{constructor(e,i){this.reason=e,this.explanation=i}toMessage(){return this.explanation?`${this.reason}: ${this.explanation}`:this.reason}}const jte=/[A-Za-z_+-]{1,256}(?::?\/[A-Za-z0-9_+-]{1,256}(?:\/[A-Za-z0-9_+-]{1,256})?)?/;function Fb(...t){const e=t.reduce((i,n)=>i+n.source,"");return RegExp(`^${e}$`)}function zb(...t){return e=>t.reduce(([i,n,r],s)=>{const[o,a,l]=s(e,r);return[{...i,...o},a||n,l]},[{},null,1]).slice(0,2)}function Vb(t,...e){if(t==null)return[null,null];for(const[i,n]of e){const r=i.exec(t);if(r)return n(r)}return[null,null]}function Bte(...t){return(e,i)=>{const n={};let r;for(r=0;r<t.length;r++)n[t[r]]=Vp(e[i+r]);return[n,null,i+r]}}const Ute=/(?:(Z)|([+-]\d\d)(?::?(\d\d))?)/,Jxe=`(?:${Ute.source}?(?:\\[(${jte.source})\\])?)?`,G6=/(\d\d)(?::?(\d\d)(?::?(\d\d)(?:[.,](\d{1,30}))?)?)?/,Gte=RegExp(`${G6.source}${Jxe}`),H6=RegExp(`(?:T${Gte.source})?`),Zxe=/([+-]\d{6}|\d{4})(?:-?(\d\d)(?:-?(\d\d))?)?/,Yxe=/(\d{4})-?W(\d\d)(?:-?(\d))?/,Xxe=/(\d{4})-?(\d{3})/,Kxe=Bte("weekYear","weekNumber","weekDay"),Qxe=Bte("year","ordinal"),e2e=/(\d{4})-(\d\d)-(\d\d)/,Hte=RegExp(`${G6.source} ?(?:${Ute.source}|(${jte.source}))?`),t2e=RegExp(`(?: ${Hte.source})?`);function P_(t,e,i){const n=t[e];return Ot(n)?i:Vp(n)}function i2e(t,e){return[{year:P_(t,e),month:P_(t,e+1,1),day:P_(t,e+2,1)},null,e+3]}function jb(t,e){return[{hours:P_(t,e,0),minutes:P_(t,e+1,0),seconds:P_(t,e+2,0),milliseconds:j6(t[e+3])},null,e+4]}function BS(t,e){const i=!t[e]&&!t[e+1],n=hP(t[e+1],t[e+2]),r=i?null:Es.instance(n);return[{},r,e+3]}function US(t,e){const i=t[e]?cd.create(t[e]):null;return[{},i,e+1]}const n2e=RegExp(`^T?${G6.source}$`),r2e=/^-?P(?:(?:(-?\d{1,20}(?:\.\d{1,20})?)Y)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20}(?:\.\d{1,20})?)W)?(?:(-?\d{1,20}(?:\.\d{1,20})?)D)?(?:T(?:(-?\d{1,20}(?:\.\d{1,20})?)H)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20})(?:[.,](-?\d{1,20}))?S)?)?)$/;function s2e(t){const[e,i,n,r,s,o,a,l,c]=t,u=e[0]==="-",d=l&&l[0]==="-",f=(m,g=!1)=>m!==void 0&&(g||m&&u)?-m:m;return[{years:f(om(i)),months:f(om(n)),weeks:f(om(r)),days:f(om(s)),hours:f(om(o)),minutes:f(om(a)),seconds:f(om(l),l==="-0"),milliseconds:f(j6(c),d)}]}const o2e={GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function q6(t,e,i,n,r,s,o){const a={year:e.length===2?GR(Vp(e)):Vp(e),month:Lte.indexOf(i)+1,day:Vp(n),hour:Vp(r),minute:Vp(s)};return o&&(a.second=Vp(o)),t&&(a.weekday=t.length>3?Dte.indexOf(t)+1:Nte.indexOf(t)+1),a}const a2e=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|(?:([+-]\d\d)(\d\d)))$/;function l2e(t){const[,e,i,n,r,s,o,a,l,c,u,d]=t,f=q6(e,r,n,i,s,o,a);let m;return l?m=o2e[l]:c?m=0:m=hP(u,d),[f,new Es(m)]}function c2e(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim()}const u2e=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d\d) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d\d):(\d\d):(\d\d) GMT$/,h2e=/^(Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d\d)-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d\d) (\d\d):(\d\d):(\d\d) GMT$/,d2e=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( \d|\d\d) (\d\d):(\d\d):(\d\d) (\d{4})$/;function nU(t){const[,e,i,n,r,s,o,a]=t;return[q6(e,r,n,i,s,o,a),Es.utcInstance]}function p2e(t){const[,e,i,n,r,s,o,a]=t;return[q6(e,a,i,n,r,s,o),Es.utcInstance]}const f2e=Fb(Zxe,H6),m2e=Fb(Yxe,H6),g2e=Fb(Xxe,H6),y2e=Fb(Gte),qte=zb(i2e,jb,BS,US),v2e=zb(Kxe,jb,BS,US),_2e=zb(Qxe,jb,BS,US),b2e=zb(jb,BS,US);function w2e(t){return Vb(t,[f2e,qte],[m2e,v2e],[g2e,_2e],[y2e,b2e])}function x2e(t){return Vb(c2e(t),[a2e,l2e])}function S2e(t){return Vb(t,[u2e,nU],[h2e,nU],[d2e,p2e])}function T2e(t){return Vb(t,[r2e,s2e])}const I2e=zb(jb);function C2e(t){return Vb(t,[n2e,I2e])}const M2e=Fb(e2e,t2e),E2e=Fb(Hte),A2e=zb(jb,BS,US);function $2e(t){return Vb(t,[M2e,qte],[E2e,A2e])}const P2e="Invalid Duration",Wte={weeks:{days:7,hours:7*24,minutes:7*24*60,seconds:7*24*60*60,milliseconds:7*24*60*60*1e3},days:{hours:24,minutes:24*60,seconds:24*60*60,milliseconds:24*60*60*1e3},hours:{minutes:60,seconds:60*60,milliseconds:60*60*1e3},minutes:{seconds:60,milliseconds:60*1e3},seconds:{milliseconds:1e3}},k2e={years:{quarters:4,months:12,weeks:52,days:365,hours:365*24,minutes:365*24*60,seconds:365*24*60*60,milliseconds:365*24*60*60*1e3},quarters:{months:3,weeks:13,days:91,hours:91*24,minutes:91*24*60,seconds:91*24*60*60,milliseconds:91*24*60*60*1e3},months:{weeks:4,days:30,hours:30*24,minutes:30*24*60,seconds:30*24*60*60,milliseconds:30*24*60*60*1e3},...Wte},Ma=146097/400,I0=146097/4800,O2e={years:{quarters:4,months:12,weeks:Ma/7,days:Ma,hours:Ma*24,minutes:Ma*24*60,seconds:Ma*24*60*60,milliseconds:Ma*24*60*60*1e3},quarters:{months:3,weeks:Ma/28,days:Ma/4,hours:Ma*24/4,minutes:Ma*24*60/4,seconds:Ma*24*60*60/4,milliseconds:Ma*24*60*60*1e3/4},months:{weeks:I0/7,days:I0,hours:I0*24,minutes:I0*24*60,seconds:I0*24*60*60,milliseconds:I0*24*60*60*1e3},...Wte},Dm=["years","quarters","months","weeks","days","hours","minutes","seconds","milliseconds"],L2e=Dm.slice(0).reverse();function Rd(t,e,i=!1){const n={values:i?e.values:{...t.values,...e.values||{}},loc:t.loc.clone(e.loc),conversionAccuracy:e.conversionAccuracy||t.conversionAccuracy,matrix:e.matrix||t.matrix};return new Ft(n)}function R2e(t){return t<0?Math.floor(t):Math.ceil(t)}function Jte(t,e,i,n,r){const s=t[r][i],o=e[i]/s,a=Math.sign(o)===Math.sign(n[r]),l=!a&&n[r]!==0&&Math.abs(o)<=1?R2e(o):Math.trunc(o);n[r]+=l,e[i]-=l*s}function D2e(t,e){L2e.reduce((i,n)=>Ot(e[n])?i:(i&&Jte(t,e,i,e,n),n),null)}function N2e(t){const e={};for(const[i,n]of Object.entries(t))n!==0&&(e[i]=n);return e}class Ft{constructor(e){const i=e.conversionAccuracy==="longterm"||!1;let n=i?O2e:k2e;e.matrix&&(n=e.matrix),this.values=e.values,this.loc=e.loc||Bi.create(),this.conversionAccuracy=i?"longterm":"casual",this.invalid=e.invalid||null,this.matrix=n,this.isLuxonDuration=!0}static fromMillis(e,i){return Ft.fromObject({milliseconds:e},i)}static fromObject(e,i={}){if(e==null||typeof e!="object")throw new el(`Duration.fromObject: argument expected to be an object, got ${e===null?"null":typeof e}`);return new Ft({values:aA(e,Ft.normalizeUnit),loc:Bi.fromObject(i),conversionAccuracy:i.conversionAccuracy,matrix:i.matrix})}static fromDurationLike(e){if(my(e))return Ft.fromMillis(e);if(Ft.isDuration(e))return e;if(typeof e=="object")return Ft.fromObject(e);throw new el(`Unknown duration argument ${e} of type ${typeof e}`)}static fromISO(e,i){const[n]=T2e(e);return n?Ft.fromObject(n,i):Ft.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static fromISOTime(e,i){const[n]=C2e(e);return n?Ft.fromObject(n,i):Ft.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static invalid(e,i=null){if(!e)throw new el("need to specify a reason the Duration is invalid");const n=e instanceof uc?e:new uc(e,i);if(Yn.throwOnInvalid)throw new hxe(n);return new Ft({invalid:n})}static normalizeUnit(e){const i={year:"years",years:"years",quarter:"quarters",quarters:"quarters",month:"months",months:"months",week:"weeks",weeks:"weeks",day:"days",days:"days",hour:"hours",hours:"hours",minute:"minutes",minutes:"minutes",second:"seconds",seconds:"seconds",millisecond:"milliseconds",milliseconds:"milliseconds"}[e&&e.toLowerCase()];if(!i)throw new hte(e);return i}static isDuration(e){return e&&e.isLuxonDuration||!1}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}toFormat(e,i={}){const n={...i,floor:i.round!==!1&&i.floor!==!1};return this.isValid?Cs.create(this.loc,n).formatDurationFromString(this,e):P2e}toHuman(e={}){const i=Dm.map(n=>{const r=this.values[n];return Ot(r)?null:this.loc.numberFormatter({style:"unit",unitDisplay:"long",...e,unit:n.slice(0,-1)}).format(r)}).filter(n=>n);return this.loc.listFormatter({type:"conjunction",style:e.listStyle||"narrow",...e}).format(i)}toObject(){return this.isValid?{...this.values}:{}}toISO(){if(!this.isValid)return null;let e="P";return this.years!==0&&(e+=this.years+"Y"),(this.months!==0||this.quarters!==0)&&(e+=this.months+this.quarters*3+"M"),this.weeks!==0&&(e+=this.weeks+"W"),this.days!==0&&(e+=this.days+"D"),(this.hours!==0||this.minutes!==0||this.seconds!==0||this.milliseconds!==0)&&(e+="T"),this.hours!==0&&(e+=this.hours+"H"),this.minutes!==0&&(e+=this.minutes+"M"),(this.seconds!==0||this.milliseconds!==0)&&(e+=B6(this.seconds+this.milliseconds/1e3,3)+"S"),e==="P"&&(e+="T0S"),e}toISOTime(e={}){if(!this.isValid)return null;const i=this.toMillis();if(i<0||i>=864e5)return null;e={suppressMilliseconds:!1,suppressSeconds:!1,includePrefix:!1,format:"extended",...e};const n=this.shiftTo("hours","minutes","seconds","milliseconds");let r=e.format==="basic"?"hhmm":"hh:mm";(!e.suppressSeconds||n.seconds!==0||n.milliseconds!==0)&&(r+=e.format==="basic"?"ss":":ss",(!e.suppressMilliseconds||n.milliseconds!==0)&&(r+=".SSS"));let s=n.toFormat(r);return e.includePrefix&&(s="T"+s),s}toJSON(){return this.toISO()}toString(){return this.toISO()}toMillis(){return this.as("milliseconds")}valueOf(){return this.toMillis()}plus(e){if(!this.isValid)return this;const i=Ft.fromDurationLike(e),n={};for(const r of Dm)(sb(i.values,r)||sb(this.values,r))&&(n[r]=i.get(r)+this.get(r));return Rd(this,{values:n},!0)}minus(e){if(!this.isValid)return this;const i=Ft.fromDurationLike(e);return this.plus(i.negate())}mapUnits(e){if(!this.isValid)return this;const i={};for(const n of Object.keys(this.values))i[n]=Ote(e(this.values[n],n));return Rd(this,{values:i},!0)}get(e){return this[Ft.normalizeUnit(e)]}set(e){if(!this.isValid)return this;const i={...this.values,...aA(e,Ft.normalizeUnit)};return Rd(this,{values:i})}reconfigure({locale:e,numberingSystem:i,conversionAccuracy:n,matrix:r}={}){const o={loc:this.loc.clone({locale:e,numberingSystem:i}),matrix:r,conversionAccuracy:n};return Rd(this,o)}as(e){return this.isValid?this.shiftTo(e).get(e):NaN}normalize(){if(!this.isValid)return this;const e=this.toObject();return D2e(this.matrix,e),Rd(this,{values:e},!0)}rescale(){if(!this.isValid)return this;const e=N2e(this.normalize().shiftToAll().toObject());return Rd(this,{values:e},!0)}shiftTo(...e){if(!this.isValid)return this;if(e.length===0)return this;e=e.map(o=>Ft.normalizeUnit(o));const i={},n={},r=this.toObject();let s;for(const o of Dm)if(e.indexOf(o)>=0){s=o;let a=0;for(const c in n)a+=this.matrix[c][o]*n[c],n[c]=0;my(r[o])&&(a+=r[o]);const l=Math.trunc(a);i[o]=l,n[o]=(a*1e3-l*1e3)/1e3;for(const c in r)Dm.indexOf(c)>Dm.indexOf(o)&&Jte(this.matrix,r,c,i,o)}else my(r[o])&&(n[o]=r[o]);for(const o in n)n[o]!==0&&(i[s]+=o===s?n[o]:n[o]/this.matrix[s][o]);return Rd(this,{values:i},!0).normalize()}shiftToAll(){return this.isValid?this.shiftTo("years","months","weeks","days","hours","minutes","seconds","milliseconds"):this}negate(){if(!this.isValid)return this;const e={};for(const i of Object.keys(this.values))e[i]=this.values[i]===0?0:-this.values[i];return Rd(this,{values:e},!0)}get years(){return this.isValid?this.values.years||0:NaN}get quarters(){return this.isValid?this.values.quarters||0:NaN}get months(){return this.isValid?this.values.months||0:NaN}get weeks(){return this.isValid?this.values.weeks||0:NaN}get days(){return this.isValid?this.values.days||0:NaN}get hours(){return this.isValid?this.values.hours||0:NaN}get minutes(){return this.isValid?this.values.minutes||0:NaN}get seconds(){return this.isValid?this.values.seconds||0:NaN}get milliseconds(){return this.isValid?this.values.milliseconds||0:NaN}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}equals(e){if(!this.isValid||!e.isValid||!this.loc.equals(e.loc))return!1;function i(n,r){return n===void 0||n===0?r===void 0||r===0:n===r}for(const n of Dm)if(!i(this.values[n],e.values[n]))return!1;return!0}}const C0="Invalid Interval";function F2e(t,e){return!t||!t.isValid?pn.invalid("missing or invalid start"):!e||!e.isValid?pn.invalid("missing or invalid end"):e<t?pn.invalid("end before start",`The end of an interval must be after its start, but you had start=${t.toISO()} and end=${e.toISO()}`):null}class pn{constructor(e){this.s=e.start,this.e=e.end,this.invalid=e.invalid||null,this.isLuxonInterval=!0}static invalid(e,i=null){if(!e)throw new el("need to specify a reason the Interval is invalid");const n=e instanceof uc?e:new uc(e,i);if(Yn.throwOnInvalid)throw new uxe(n);return new pn({invalid:n})}static fromDateTimes(e,i){const n=y1(e),r=y1(i),s=F2e(n,r);return s??new pn({start:n,end:r})}static after(e,i){const n=Ft.fromDurationLike(i),r=y1(e);return pn.fromDateTimes(r,r.plus(n))}static before(e,i){const n=Ft.fromDurationLike(i),r=y1(e);return pn.fromDateTimes(r.minus(n),r)}static fromISO(e,i){const[n,r]=(e||"").split("/",2);if(n&&r){let s,o;try{s=Ve.fromISO(n,i),o=s.isValid}catch{o=!1}let a,l;try{a=Ve.fromISO(r,i),l=a.isValid}catch{l=!1}if(o&&l)return pn.fromDateTimes(s,a);if(o){const c=Ft.fromISO(r,i);if(c.isValid)return pn.after(s,c)}else if(l){const c=Ft.fromISO(n,i);if(c.isValid)return pn.before(a,c)}}return pn.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static isInterval(e){return e&&e.isLuxonInterval||!1}get start(){return this.isValid?this.s:null}get end(){return this.isValid?this.e:null}get isValid(){return this.invalidReason===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}length(e="milliseconds"){return this.isValid?this.toDuration(e).get(e):NaN}count(e="milliseconds"){if(!this.isValid)return NaN;const i=this.start.startOf(e),n=this.end.startOf(e);return Math.floor(n.diff(i,e).get(e))+(n.valueOf()!==this.end.valueOf())}hasSame(e){return this.isValid?this.isEmpty()||this.e.minus(1).hasSame(this.s,e):!1}isEmpty(){return this.s.valueOf()===this.e.valueOf()}isAfter(e){return this.isValid?this.s>e:!1}isBefore(e){return this.isValid?this.e<=e:!1}contains(e){return this.isValid?this.s<=e&&this.e>e:!1}set({start:e,end:i}={}){return this.isValid?pn.fromDateTimes(e||this.s,i||this.e):this}splitAt(...e){if(!this.isValid)return[];const i=e.map(y1).filter(o=>this.contains(o)).sort(),n=[];let{s:r}=this,s=0;for(;r<this.e;){const o=i[s]||this.e,a=+o>+this.e?this.e:o;n.push(pn.fromDateTimes(r,a)),r=a,s+=1}return n}splitBy(e){const i=Ft.fromDurationLike(e);if(!this.isValid||!i.isValid||i.as("milliseconds")===0)return[];let{s:n}=this,r=1,s;const o=[];for(;n<this.e;){const a=this.start.plus(i.mapUnits(l=>l*r));s=+a>+this.e?this.e:a,o.push(pn.fromDateTimes(n,s)),n=s,r+=1}return o}divideEqually(e){return this.isValid?this.splitBy(this.length()/e).slice(0,e):[]}overlaps(e){return this.e>e.s&&this.s<e.e}abutsStart(e){return this.isValid?+this.e==+e.s:!1}abutsEnd(e){return this.isValid?+e.e==+this.s:!1}engulfs(e){return this.isValid?this.s<=e.s&&this.e>=e.e:!1}equals(e){return!this.isValid||!e.isValid?!1:this.s.equals(e.s)&&this.e.equals(e.e)}intersection(e){if(!this.isValid)return this;const i=this.s>e.s?this.s:e.s,n=this.e<e.e?this.e:e.e;return i>=n?null:pn.fromDateTimes(i,n)}union(e){if(!this.isValid)return this;const i=this.s<e.s?this.s:e.s,n=this.e>e.e?this.e:e.e;return pn.fromDateTimes(i,n)}static merge(e){const[i,n]=e.sort((r,s)=>r.s-s.s).reduce(([r,s],o)=>s?s.overlaps(o)||s.abutsStart(o)?[r,s.union(o)]:[r.concat([s]),o]:[r,o],[[],null]);return n&&i.push(n),i}static xor(e){let i=null,n=0;const r=[],s=e.map(l=>[{time:l.s,type:"s"},{time:l.e,type:"e"}]),o=Array.prototype.concat(...s),a=o.sort((l,c)=>l.time-c.time);for(const l of a)n+=l.type==="s"?1:-1,n===1?i=l.time:(i&&+i!=+l.time&&r.push(pn.fromDateTimes(i,l.time)),i=null);return pn.merge(r)}difference(...e){return pn.xor([this].concat(e)).map(i=>this.intersection(i)).filter(i=>i&&!i.isEmpty())}toString(){return this.isValid?`[${this.s.toISO()}  ${this.e.toISO()})`:C0}toLocaleString(e=rA,i={}){return this.isValid?Cs.create(this.s.loc.clone(i),e).formatInterval(this):C0}toISO(e){return this.isValid?`${this.s.toISO(e)}/${this.e.toISO(e)}`:C0}toISODate(){return this.isValid?`${this.s.toISODate()}/${this.e.toISODate()}`:C0}toISOTime(e){return this.isValid?`${this.s.toISOTime(e)}/${this.e.toISOTime(e)}`:C0}toFormat(e,{separator:i="  "}={}){return this.isValid?`${this.s.toFormat(e)}${i}${this.e.toFormat(e)}`:C0}toDuration(e,i){return this.isValid?this.e.diff(this.s,e,i):Ft.invalid(this.invalidReason)}mapEndpoints(e){return pn.fromDateTimes(e(this.s),e(this.e))}}class fw{static hasDST(e=Yn.defaultZone){const i=Ve.now().setZone(e).set({month:12});return!e.isUniversal&&i.offset!==i.set({month:6}).offset}static isValidIANAZone(e){return cd.isValidZone(e)}static normalizeZone(e){return Wp(e,Yn.defaultZone)}static months(e="long",{locale:i=null,numberingSystem:n=null,locObj:r=null,outputCalendar:s="gregory"}={}){return(r||Bi.create(i,n,s)).months(e)}static monthsFormat(e="long",{locale:i=null,numberingSystem:n=null,locObj:r=null,outputCalendar:s="gregory"}={}){return(r||Bi.create(i,n,s)).months(e,!0)}static weekdays(e="long",{locale:i=null,numberingSystem:n=null,locObj:r=null}={}){return(r||Bi.create(i,n,null)).weekdays(e)}static weekdaysFormat(e="long",{locale:i=null,numberingSystem:n=null,locObj:r=null}={}){return(r||Bi.create(i,n,null)).weekdays(e,!0)}static meridiems({locale:e=null}={}){return Bi.create(e).meridiems()}static eras(e="short",{locale:i=null}={}){return Bi.create(i,null,"gregory").eras(e)}static features(){return{relative:Pte()}}}function rU(t,e){const i=r=>r.toUTC(0,{keepLocalTime:!0}).startOf("day").valueOf(),n=i(e)-i(t);return Math.floor(Ft.fromMillis(n).as("days"))}function z2e(t,e,i){const n=[["years",(l,c)=>c.year-l.year],["quarters",(l,c)=>c.quarter-l.quarter+(c.year-l.year)*4],["months",(l,c)=>c.month-l.month+(c.year-l.year)*12],["weeks",(l,c)=>{const u=rU(l,c);return(u-u%7)/7}],["days",rU]],r={},s=t;let o,a;for(const[l,c]of n)i.indexOf(l)>=0&&(o=l,r[l]=c(t,e),a=s.plus(r),a>e?(r[l]--,t=s.plus(r)):t=a);return[t,r,a,o]}function V2e(t,e,i,n){let[r,s,o,a]=z2e(t,e,i);const l=e-r,c=i.filter(d=>["hours","minutes","seconds","milliseconds"].indexOf(d)>=0);c.length===0&&(o<e&&(o=r.plus({[a]:1})),o!==r&&(s[a]=(s[a]||0)+l/(o-r)));const u=Ft.fromObject(s,n);return c.length>0?Ft.fromMillis(l,n).shiftTo(...c).plus(u):u}const W6={arab:"[-]",arabext:"[-]",bali:"[-]",beng:"[-]",deva:"[-]",fullwide:"[-]",gujr:"[-]",hanidec:"[|||||||||]",khmr:"[-]",knda:"[-]",laoo:"[-]",limb:"[-]",mlym:"[-]",mong:"[-]",mymr:"[-]",orya:"[-]",tamldec:"[-]",telu:"[-]",thai:"[-]",tibt:"[-]",latn:"\\d"},sU={arab:[1632,1641],arabext:[1776,1785],bali:[6992,7001],beng:[2534,2543],deva:[2406,2415],fullwide:[65296,65303],gujr:[2790,2799],khmr:[6112,6121],knda:[3302,3311],laoo:[3792,3801],limb:[6470,6479],mlym:[3430,3439],mong:[6160,6169],mymr:[4160,4169],orya:[2918,2927],tamldec:[3046,3055],telu:[3174,3183],thai:[3664,3673],tibt:[3872,3881]},j2e=W6.hanidec.replace(/[\[|\]]/g,"").split("");function B2e(t){let e=parseInt(t,10);if(isNaN(e)){e="";for(let i=0;i<t.length;i++){const n=t.charCodeAt(i);if(t[i].search(W6.hanidec)!==-1)e+=j2e.indexOf(t[i]);else for(const r in sU){const[s,o]=sU[r];n>=s&&n<=o&&(e+=n-s)}}return parseInt(e,10)}else return e}function Ml({numberingSystem:t},e=""){return new RegExp(`${W6[t||"latn"]}${e}`)}const U2e="missing Intl.DateTimeFormat.formatToParts support";function Xt(t,e=i=>i){return{regex:t,deser:([i])=>e(B2e(i))}}const G2e=String.fromCharCode(160),Zte=`[ ${G2e}]`,Yte=new RegExp(Zte,"g");function H2e(t){return t.replace(/\./g,"\\.?").replace(Yte,Zte)}function oU(t){return t.replace(/\./g,"").replace(Yte," ").toLowerCase()}function El(t,e){return t===null?null:{regex:RegExp(t.map(H2e).join("|")),deser:([i])=>t.findIndex(n=>oU(i)===oU(n))+e}}function aU(t,e){return{regex:t,deser:([,i,n])=>hP(i,n),groups:e}}function XT(t){return{regex:t,deser:([e])=>e}}function q2e(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function W2e(t,e){const i=Ml(e),n=Ml(e,"{2}"),r=Ml(e,"{3}"),s=Ml(e,"{4}"),o=Ml(e,"{6}"),a=Ml(e,"{1,2}"),l=Ml(e,"{1,3}"),c=Ml(e,"{1,6}"),u=Ml(e,"{1,9}"),d=Ml(e,"{2,4}"),f=Ml(e,"{4,6}"),m=_=>({regex:RegExp(q2e(_.val)),deser:([b])=>b,literal:!0}),y=(_=>{if(t.literal)return m(_);switch(_.val){case"G":return El(e.eras("short",!1),0);case"GG":return El(e.eras("long",!1),0);case"y":return Xt(c);case"yy":return Xt(d,GR);case"yyyy":return Xt(s);case"yyyyy":return Xt(f);case"yyyyyy":return Xt(o);case"M":return Xt(a);case"MM":return Xt(n);case"MMM":return El(e.months("short",!0,!1),1);case"MMMM":return El(e.months("long",!0,!1),1);case"L":return Xt(a);case"LL":return Xt(n);case"LLL":return El(e.months("short",!1,!1),1);case"LLLL":return El(e.months("long",!1,!1),1);case"d":return Xt(a);case"dd":return Xt(n);case"o":return Xt(l);case"ooo":return Xt(r);case"HH":return Xt(n);case"H":return Xt(a);case"hh":return Xt(n);case"h":return Xt(a);case"mm":return Xt(n);case"m":return Xt(a);case"q":return Xt(a);case"qq":return Xt(n);case"s":return Xt(a);case"ss":return Xt(n);case"S":return Xt(l);case"SSS":return Xt(r);case"u":return XT(u);case"uu":return XT(a);case"uuu":return Xt(i);case"a":return El(e.meridiems(),0);case"kkkk":return Xt(s);case"kk":return Xt(d,GR);case"W":return Xt(a);case"WW":return Xt(n);case"E":case"c":return Xt(i);case"EEE":return El(e.weekdays("short",!1,!1),1);case"EEEE":return El(e.weekdays("long",!1,!1),1);case"ccc":return El(e.weekdays("short",!0,!1),1);case"cccc":return El(e.weekdays("long",!0,!1),1);case"Z":case"ZZ":return aU(new RegExp(`([+-]${a.source})(?::(${n.source}))?`),2);case"ZZZ":return aU(new RegExp(`([+-]${a.source})(${n.source})?`),2);case"z":return XT(/[a-z_+-/]{1,256}?/i);case" ":return XT(/[^\S\n\r]/);default:return m(_)}})(t)||{invalidReason:U2e};return y.token=t,y}const J2e={year:{"2-digit":"yy",numeric:"yyyyy"},month:{numeric:"M","2-digit":"MM",short:"MMM",long:"MMMM"},day:{numeric:"d","2-digit":"dd"},weekday:{short:"EEE",long:"EEEE"},dayperiod:"a",dayPeriod:"a",hour:{numeric:"h","2-digit":"hh"},minute:{numeric:"m","2-digit":"mm"},second:{numeric:"s","2-digit":"ss"},timeZoneName:{long:"ZZZZZ",short:"ZZZ"}};function Z2e(t,e){const{type:i,value:n}=t;if(i==="literal"){const o=/^\s+$/.test(n);return{literal:!o,val:o?" ":n}}const r=e[i];let s=J2e[i];if(typeof s=="object"&&(s=s[r]),s)return{literal:!1,val:s}}function Y2e(t){return[`^${t.map(i=>i.regex).reduce((i,n)=>`${i}(${n.source})`,"")}$`,t]}function X2e(t,e,i){const n=t.match(e);if(n){const r={};let s=1;for(const o in i)if(sb(i,o)){const a=i[o],l=a.groups?a.groups+1:1;!a.literal&&a.token&&(r[a.token.val[0]]=a.deser(n.slice(s,s+l))),s+=l}return[n,r]}else return[n,{}]}function K2e(t){const e=s=>{switch(s){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":case"H":return"hour";case"d":return"day";case"o":return"ordinal";case"L":case"M":return"month";case"y":return"year";case"E":case"c":return"weekday";case"W":return"weekNumber";case"k":return"weekYear";case"q":return"quarter";default:return null}};let i=null,n;return Ot(t.z)||(i=cd.create(t.z)),Ot(t.Z)||(i||(i=new Es(t.Z)),n=t.Z),Ot(t.q)||(t.M=(t.q-1)*3+1),Ot(t.h)||(t.h<12&&t.a===1?t.h+=12:t.h===12&&t.a===0&&(t.h=0)),t.G===0&&t.y&&(t.y=-t.y),Ot(t.u)||(t.S=j6(t.u)),[Object.keys(t).reduce((s,o)=>{const a=e(o);return a&&(s[a]=t[o]),s},{}),i,n]}let b3=null;function Q2e(){return b3||(b3=Ve.fromMillis(1555555555555)),b3}function eSe(t,e){if(t.literal)return t;const i=Cs.macroTokenToFormatOpts(t.val),n=Qte(i,e);return n==null||n.includes(void 0)?t:n}function Xte(t,e){return Array.prototype.concat(...t.map(i=>eSe(i,e)))}function Kte(t,e,i){const n=Xte(Cs.parseFormat(i),t),r=n.map(o=>W2e(o,t)),s=r.find(o=>o.invalidReason);if(s)return{input:e,tokens:n,invalidReason:s.invalidReason};{const[o,a]=Y2e(r),l=RegExp(o,"i"),[c,u]=X2e(e,l,a),[d,f,m]=u?K2e(u):[null,null,void 0];if(sb(u,"a")&&sb(u,"H"))throw new dw("Can't include meridiem when specifying 24-hour format");return{input:e,tokens:n,regex:l,rawMatches:c,matches:u,result:d,zone:f,specificOffset:m}}}function tSe(t,e,i){const{result:n,zone:r,specificOffset:s,invalidReason:o}=Kte(t,e,i);return[n,r,s,o]}function Qte(t,e){return t?Cs.create(e,t).formatDateTimeParts(Q2e()).map(r=>Z2e(r,t)):null}const eie=[0,31,59,90,120,151,181,212,243,273,304,334],tie=[0,31,60,91,121,152,182,213,244,274,305,335];function nl(t,e){return new uc("unit out of range",`you specified ${e} (of type ${typeof e}) as a ${t}, which is invalid`)}function iie(t,e,i){const n=new Date(Date.UTC(t,e-1,i));t<100&&t>=0&&n.setUTCFullYear(n.getUTCFullYear()-1900);const r=n.getUTCDay();return r===0?7:r}function nie(t,e,i){return i+(jS(t)?tie:eie)[e-1]}function rie(t,e){const i=jS(t)?tie:eie,n=i.findIndex(s=>s<e),r=e-i[n];return{month:n+1,day:r}}function HR(t){const{year:e,month:i,day:n}=t,r=nie(e,i,n),s=iie(e,i,n);let o=Math.floor((r-s+10)/7),a;return o<1?(a=e-1,o=oA(a)):o>oA(e)?(a=e+1,o=1):a=e,{weekYear:a,weekNumber:o,weekday:s,...dP(t)}}function lU(t){const{weekYear:e,weekNumber:i,weekday:n}=t,r=iie(e,1,4),s=Rx(e);let o=i*7+n-r-3,a;o<1?(a=e-1,o+=Rx(a)):o>s?(a=e+1,o-=Rx(e)):a=e;const{month:l,day:c}=rie(a,o);return{year:a,month:l,day:c,...dP(t)}}function w3(t){const{year:e,month:i,day:n}=t,r=nie(e,i,n);return{year:e,ordinal:r,...dP(t)}}function cU(t){const{year:e,ordinal:i}=t,{month:n,day:r}=rie(e,i);return{year:e,month:n,day:r,...dP(t)}}function iSe(t){const e=uP(t.weekYear),i=Rh(t.weekNumber,1,oA(t.weekYear)),n=Rh(t.weekday,1,7);return e?i?n?!1:nl("weekday",t.weekday):nl("week",t.week):nl("weekYear",t.weekYear)}function nSe(t){const e=uP(t.year),i=Rh(t.ordinal,1,Rx(t.year));return e?i?!1:nl("ordinal",t.ordinal):nl("year",t.year)}function sie(t){const e=uP(t.year),i=Rh(t.month,1,12),n=Rh(t.day,1,sA(t.year,t.month));return e?i?n?!1:nl("day",t.day):nl("month",t.month):nl("year",t.year)}function oie(t){const{hour:e,minute:i,second:n,millisecond:r}=t,s=Rh(e,0,23)||e===24&&i===0&&n===0&&r===0,o=Rh(i,0,59),a=Rh(n,0,59),l=Rh(r,0,999);return s?o?a?l?!1:nl("millisecond",r):nl("second",n):nl("minute",i):nl("hour",e)}const x3="Invalid DateTime",uU=864e13;function KT(t){return new uc("unsupported zone",`the zone "${t.name}" is not supported`)}function S3(t){return t.weekData===null&&(t.weekData=HR(t.c)),t.weekData}function m1(t,e){const i={ts:t.ts,zone:t.zone,c:t.c,o:t.o,loc:t.loc,invalid:t.invalid};return new Ve({...i,...e,old:i})}function aie(t,e,i){let n=t-e*60*1e3;const r=i.offset(n);if(e===r)return[n,e];n-=(r-e)*60*1e3;const s=i.offset(n);return r===s?[n,r]:[t-Math.min(r,s)*60*1e3,Math.max(r,s)]}function hU(t,e){t+=e*60*1e3;const i=new Date(t);return{year:i.getUTCFullYear(),month:i.getUTCMonth()+1,day:i.getUTCDate(),hour:i.getUTCHours(),minute:i.getUTCMinutes(),second:i.getUTCSeconds(),millisecond:i.getUTCMilliseconds()}}function nM(t,e,i){return aie(U6(t),e,i)}function dU(t,e){const i=t.o,n=t.c.year+Math.trunc(e.years),r=t.c.month+Math.trunc(e.months)+Math.trunc(e.quarters)*3,s={...t.c,year:n,month:r,day:Math.min(t.c.day,sA(n,r))+Math.trunc(e.days)+Math.trunc(e.weeks)*7},o=Ft.fromObject({years:e.years-Math.trunc(e.years),quarters:e.quarters-Math.trunc(e.quarters),months:e.months-Math.trunc(e.months),weeks:e.weeks-Math.trunc(e.weeks),days:e.days-Math.trunc(e.days),hours:e.hours,minutes:e.minutes,seconds:e.seconds,milliseconds:e.milliseconds}).as("milliseconds"),a=U6(s);let[l,c]=aie(a,i,t.zone);return o!==0&&(l+=o,c=t.zone.offset(l)),{ts:l,o:c}}function g1(t,e,i,n,r,s){const{setZone:o,zone:a}=i;if(t&&Object.keys(t).length!==0||e){const l=e||a,c=Ve.fromObject(t,{...i,zone:l,specificOffset:s});return o?c:c.setZone(a)}else return Ve.invalid(new uc("unparsable",`the input "${r}" can't be parsed as ${n}`))}function QT(t,e,i=!0){return t.isValid?Cs.create(Bi.create("en-US"),{allowZ:i,forceSimple:!0}).formatDateTimeFromString(t,e):null}function T3(t,e){const i=t.c.year>9999||t.c.year<0;let n="";return i&&t.c.year>=0&&(n+="+"),n+=Xn(t.c.year,i?6:4),e?(n+="-",n+=Xn(t.c.month),n+="-",n+=Xn(t.c.day)):(n+=Xn(t.c.month),n+=Xn(t.c.day)),n}function pU(t,e,i,n,r,s){let o=Xn(t.c.hour);return e?(o+=":",o+=Xn(t.c.minute),(t.c.second!==0||!i)&&(o+=":")):o+=Xn(t.c.minute),(t.c.second!==0||!i)&&(o+=Xn(t.c.second),(t.c.millisecond!==0||!n)&&(o+=".",o+=Xn(t.c.millisecond,3))),r&&(t.isOffsetFixed&&t.offset===0&&!s?o+="Z":t.o<0?(o+="-",o+=Xn(Math.trunc(-t.o/60)),o+=":",o+=Xn(Math.trunc(-t.o%60))):(o+="+",o+=Xn(Math.trunc(t.o/60)),o+=":",o+=Xn(Math.trunc(t.o%60)))),s&&(o+="["+t.zone.ianaName+"]"),o}const lie={month:1,day:1,hour:0,minute:0,second:0,millisecond:0},rSe={weekNumber:1,weekday:1,hour:0,minute:0,second:0,millisecond:0},sSe={ordinal:1,hour:0,minute:0,second:0,millisecond:0},cie=["year","month","day","hour","minute","second","millisecond"],oSe=["weekYear","weekNumber","weekday","hour","minute","second","millisecond"],aSe=["year","ordinal","hour","minute","second","millisecond"];function fU(t){const e={year:"year",years:"year",month:"month",months:"month",day:"day",days:"day",hour:"hour",hours:"hour",minute:"minute",minutes:"minute",quarter:"quarter",quarters:"quarter",second:"second",seconds:"second",millisecond:"millisecond",milliseconds:"millisecond",weekday:"weekday",weekdays:"weekday",weeknumber:"weekNumber",weeksnumber:"weekNumber",weeknumbers:"weekNumber",weekyear:"weekYear",weekyears:"weekYear",ordinal:"ordinal"}[t.toLowerCase()];if(!e)throw new hte(t);return e}function mU(t,e){const i=Wp(e.zone,Yn.defaultZone),n=Bi.fromObject(e),r=Yn.now();let s,o;if(Ot(t.year))s=r;else{for(const c of cie)Ot(t[c])&&(t[c]=lie[c]);const a=sie(t)||oie(t);if(a)return Ve.invalid(a);const l=i.offset(r);[s,o]=nM(t,l,i)}return new Ve({ts:s,zone:i,loc:n,o})}function gU(t,e,i){const n=Ot(i.round)?!0:i.round,r=(o,a)=>(o=B6(o,n||i.calendary?0:2,!0),e.loc.clone(i).relFormatter(i).format(o,a)),s=o=>i.calendary?e.hasSame(t,o)?0:e.startOf(o).diff(t.startOf(o),o).get(o):e.diff(t,o).get(o);if(i.unit)return r(s(i.unit),i.unit);for(const o of i.units){const a=s(o);if(Math.abs(a)>=1)return r(a,o)}return r(t>e?-0:0,i.units[i.units.length-1])}function yU(t){let e={},i;return t.length>0&&typeof t[t.length-1]=="object"?(e=t[t.length-1],i=Array.from(t).slice(0,t.length-1)):i=Array.from(t),[e,i]}class Ve{constructor(e){const i=e.zone||Yn.defaultZone;let n=e.invalid||(Number.isNaN(e.ts)?new uc("invalid input"):null)||(i.isValid?null:KT(i));this.ts=Ot(e.ts)?Yn.now():e.ts;let r=null,s=null;if(!n)if(e.old&&e.old.ts===this.ts&&e.old.zone.equals(i))[r,s]=[e.old.c,e.old.o];else{const a=i.offset(this.ts);r=hU(this.ts,a),n=Number.isNaN(r.year)?new uc("invalid input"):null,r=n?null:r,s=n?null:a}this._zone=i,this.loc=e.loc||Bi.create(),this.invalid=n,this.weekData=null,this.c=r,this.o=s,this.isLuxonDateTime=!0}static now(){return new Ve({})}static local(){const[e,i]=yU(arguments),[n,r,s,o,a,l,c]=i;return mU({year:n,month:r,day:s,hour:o,minute:a,second:l,millisecond:c},e)}static utc(){const[e,i]=yU(arguments),[n,r,s,o,a,l,c]=i;return e.zone=Es.utcInstance,mU({year:n,month:r,day:s,hour:o,minute:a,second:l,millisecond:c},e)}static fromJSDate(e,i={}){const n=kxe(e)?e.valueOf():NaN;if(Number.isNaN(n))return Ve.invalid("invalid input");const r=Wp(i.zone,Yn.defaultZone);return r.isValid?new Ve({ts:n,zone:r,loc:Bi.fromObject(i)}):Ve.invalid(KT(r))}static fromMillis(e,i={}){if(my(e))return e<-uU||e>uU?Ve.invalid("Timestamp out of range"):new Ve({ts:e,zone:Wp(i.zone,Yn.defaultZone),loc:Bi.fromObject(i)});throw new el(`fromMillis requires a numerical input, but received a ${typeof e} with value ${e}`)}static fromSeconds(e,i={}){if(my(e))return new Ve({ts:e*1e3,zone:Wp(i.zone,Yn.defaultZone),loc:Bi.fromObject(i)});throw new el("fromSeconds requires a numerical input")}static fromObject(e,i={}){e=e||{};const n=Wp(i.zone,Yn.defaultZone);if(!n.isValid)return Ve.invalid(KT(n));const r=Yn.now(),s=Ot(i.specificOffset)?n.offset(r):i.specificOffset,o=aA(e,fU),a=!Ot(o.ordinal),l=!Ot(o.year),c=!Ot(o.month)||!Ot(o.day),u=l||c,d=o.weekYear||o.weekNumber,f=Bi.fromObject(i);if((u||a)&&d)throw new dw("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(c&&a)throw new dw("Can't mix ordinal dates with month/day");const m=d||o.weekday&&!u;let g,y,_=hU(r,s);m?(g=oSe,y=rSe,_=HR(_)):a?(g=aSe,y=sSe,_=w3(_)):(g=cie,y=lie);let b=!1;for(const M of g){const E=o[M];Ot(E)?b?o[M]=y[M]:o[M]=_[M]:b=!0}const w=m?iSe(o):a?nSe(o):sie(o),x=w||oie(o);if(x)return Ve.invalid(x);const S=m?lU(o):a?cU(o):o,[T,I]=nM(S,s,n),C=new Ve({ts:T,zone:n,o:I,loc:f});return o.weekday&&u&&e.weekday!==C.weekday?Ve.invalid("mismatched weekday",`you can't specify both a weekday of ${o.weekday} and a date of ${C.toISO()}`):C}static fromISO(e,i={}){const[n,r]=w2e(e);return g1(n,r,i,"ISO 8601",e)}static fromRFC2822(e,i={}){const[n,r]=x2e(e);return g1(n,r,i,"RFC 2822",e)}static fromHTTP(e,i={}){const[n,r]=S2e(e);return g1(n,r,i,"HTTP",i)}static fromFormat(e,i,n={}){if(Ot(e)||Ot(i))throw new el("fromFormat requires an input string and a format");const{locale:r=null,numberingSystem:s=null}=n,o=Bi.fromOpts({locale:r,numberingSystem:s,defaultToEN:!0}),[a,l,c,u]=tSe(o,e,i);return u?Ve.invalid(u):g1(a,l,n,`format ${i}`,e,c)}static fromString(e,i,n={}){return Ve.fromFormat(e,i,n)}static fromSQL(e,i={}){const[n,r]=$2e(e);return g1(n,r,i,"SQL",e)}static invalid(e,i=null){if(!e)throw new el("need to specify a reason the DateTime is invalid");const n=e instanceof uc?e:new uc(e,i);if(Yn.throwOnInvalid)throw new cxe(n);return new Ve({invalid:n})}static isDateTime(e){return e&&e.isLuxonDateTime||!1}static parseFormatForOpts(e,i={}){const n=Qte(e,Bi.fromObject(i));return n?n.map(r=>r?r.val:null).join(""):null}static expandFormat(e,i={}){return Xte(Cs.parseFormat(e),Bi.fromObject(i)).map(r=>r.val).join("")}get(e){return this[e]}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}get outputCalendar(){return this.isValid?this.loc.outputCalendar:null}get zone(){return this._zone}get zoneName(){return this.isValid?this.zone.name:null}get year(){return this.isValid?this.c.year:NaN}get quarter(){return this.isValid?Math.ceil(this.c.month/3):NaN}get month(){return this.isValid?this.c.month:NaN}get day(){return this.isValid?this.c.day:NaN}get hour(){return this.isValid?this.c.hour:NaN}get minute(){return this.isValid?this.c.minute:NaN}get second(){return this.isValid?this.c.second:NaN}get millisecond(){return this.isValid?this.c.millisecond:NaN}get weekYear(){return this.isValid?S3(this).weekYear:NaN}get weekNumber(){return this.isValid?S3(this).weekNumber:NaN}get weekday(){return this.isValid?S3(this).weekday:NaN}get ordinal(){return this.isValid?w3(this.c).ordinal:NaN}get monthShort(){return this.isValid?fw.months("short",{locObj:this.loc})[this.month-1]:null}get monthLong(){return this.isValid?fw.months("long",{locObj:this.loc})[this.month-1]:null}get weekdayShort(){return this.isValid?fw.weekdays("short",{locObj:this.loc})[this.weekday-1]:null}get weekdayLong(){return this.isValid?fw.weekdays("long",{locObj:this.loc})[this.weekday-1]:null}get offset(){return this.isValid?+this.o:NaN}get offsetNameShort(){return this.isValid?this.zone.offsetName(this.ts,{format:"short",locale:this.locale}):null}get offsetNameLong(){return this.isValid?this.zone.offsetName(this.ts,{format:"long",locale:this.locale}):null}get isOffsetFixed(){return this.isValid?this.zone.isUniversal:null}get isInDST(){return this.isOffsetFixed?!1:this.offset>this.set({month:1,day:1}).offset||this.offset>this.set({month:5}).offset}get isInLeapYear(){return jS(this.year)}get daysInMonth(){return sA(this.year,this.month)}get daysInYear(){return this.isValid?Rx(this.year):NaN}get weeksInWeekYear(){return this.isValid?oA(this.weekYear):NaN}resolvedLocaleOptions(e={}){const{locale:i,numberingSystem:n,calendar:r}=Cs.create(this.loc.clone(e),e).resolvedOptions(this);return{locale:i,numberingSystem:n,outputCalendar:r}}toUTC(e=0,i={}){return this.setZone(Es.instance(e),i)}toLocal(){return this.setZone(Yn.defaultZone)}setZone(e,{keepLocalTime:i=!1,keepCalendarTime:n=!1}={}){if(e=Wp(e,Yn.defaultZone),e.equals(this.zone))return this;if(e.isValid){let r=this.ts;if(i||n){const s=e.offset(this.ts),o=this.toObject();[r]=nM(o,s,e)}return m1(this,{ts:r,zone:e})}else return Ve.invalid(KT(e))}reconfigure({locale:e,numberingSystem:i,outputCalendar:n}={}){const r=this.loc.clone({locale:e,numberingSystem:i,outputCalendar:n});return m1(this,{loc:r})}setLocale(e){return this.reconfigure({locale:e})}set(e){if(!this.isValid)return this;const i=aA(e,fU),n=!Ot(i.weekYear)||!Ot(i.weekNumber)||!Ot(i.weekday),r=!Ot(i.ordinal),s=!Ot(i.year),o=!Ot(i.month)||!Ot(i.day),a=s||o,l=i.weekYear||i.weekNumber;if((a||r)&&l)throw new dw("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(o&&r)throw new dw("Can't mix ordinal dates with month/day");let c;n?c=lU({...HR(this.c),...i}):Ot(i.ordinal)?(c={...this.toObject(),...i},Ot(i.day)&&(c.day=Math.min(sA(c.year,c.month),c.day))):c=cU({...w3(this.c),...i});const[u,d]=nM(c,this.o,this.zone);return m1(this,{ts:u,o:d})}plus(e){if(!this.isValid)return this;const i=Ft.fromDurationLike(e);return m1(this,dU(this,i))}minus(e){if(!this.isValid)return this;const i=Ft.fromDurationLike(e).negate();return m1(this,dU(this,i))}startOf(e){if(!this.isValid)return this;const i={},n=Ft.normalizeUnit(e);switch(n){case"years":i.month=1;case"quarters":case"months":i.day=1;case"weeks":case"days":i.hour=0;case"hours":i.minute=0;case"minutes":i.second=0;case"seconds":i.millisecond=0;break}if(n==="weeks"&&(i.weekday=1),n==="quarters"){const r=Math.ceil(this.month/3);i.month=(r-1)*3+1}return this.set(i)}endOf(e){return this.isValid?this.plus({[e]:1}).startOf(e).minus(1):this}toFormat(e,i={}){return this.isValid?Cs.create(this.loc.redefaultToEN(i)).formatDateTimeFromString(this,e):x3}toLocaleString(e=rA,i={}){return this.isValid?Cs.create(this.loc.clone(i),e).formatDateTime(this):x3}toLocaleParts(e={}){return this.isValid?Cs.create(this.loc.clone(e),e).formatDateTimeParts(this):[]}toISO({format:e="extended",suppressSeconds:i=!1,suppressMilliseconds:n=!1,includeOffset:r=!0,extendedZone:s=!1}={}){if(!this.isValid)return null;const o=e==="extended";let a=T3(this,o);return a+="T",a+=pU(this,o,i,n,r,s),a}toISODate({format:e="extended"}={}){return this.isValid?T3(this,e==="extended"):null}toISOWeekDate(){return QT(this,"kkkk-'W'WW-c")}toISOTime({suppressMilliseconds:e=!1,suppressSeconds:i=!1,includeOffset:n=!0,includePrefix:r=!1,extendedZone:s=!1,format:o="extended"}={}){return this.isValid?(r?"T":"")+pU(this,o==="extended",i,e,n,s):null}toRFC2822(){return QT(this,"EEE, dd LLL yyyy HH:mm:ss ZZZ",!1)}toHTTP(){return QT(this.toUTC(),"EEE, dd LLL yyyy HH:mm:ss 'GMT'")}toSQLDate(){return this.isValid?T3(this,!0):null}toSQLTime({includeOffset:e=!0,includeZone:i=!1,includeOffsetSpace:n=!0}={}){let r="HH:mm:ss.SSS";return(i||e)&&(n&&(r+=" "),i?r+="z":e&&(r+="ZZ")),QT(this,r,!0)}toSQL(e={}){return this.isValid?`${this.toSQLDate()} ${this.toSQLTime(e)}`:null}toString(){return this.isValid?this.toISO():x3}valueOf(){return this.toMillis()}toMillis(){return this.isValid?this.ts:NaN}toSeconds(){return this.isValid?this.ts/1e3:NaN}toUnixInteger(){return this.isValid?Math.floor(this.ts/1e3):NaN}toJSON(){return this.toISO()}toBSON(){return this.toJSDate()}toObject(e={}){if(!this.isValid)return{};const i={...this.c};return e.includeConfig&&(i.outputCalendar=this.outputCalendar,i.numberingSystem=this.loc.numberingSystem,i.locale=this.loc.locale),i}toJSDate(){return new Date(this.isValid?this.ts:NaN)}diff(e,i="milliseconds",n={}){if(!this.isValid||!e.isValid)return Ft.invalid("created by diffing an invalid DateTime");const r={locale:this.locale,numberingSystem:this.numberingSystem,...n},s=Oxe(i).map(Ft.normalizeUnit),o=e.valueOf()>this.valueOf(),a=o?this:e,l=o?e:this,c=V2e(a,l,s,r);return o?c.negate():c}diffNow(e="milliseconds",i={}){return this.diff(Ve.now(),e,i)}until(e){return this.isValid?pn.fromDateTimes(this,e):this}hasSame(e,i){if(!this.isValid)return!1;const n=e.valueOf(),r=this.setZone(e.zone,{keepLocalTime:!0});return r.startOf(i)<=n&&n<=r.endOf(i)}equals(e){return this.isValid&&e.isValid&&this.valueOf()===e.valueOf()&&this.zone.equals(e.zone)&&this.loc.equals(e.loc)}toRelative(e={}){if(!this.isValid)return null;const i=e.base||Ve.fromObject({},{zone:this.zone}),n=e.padding?this<i?-e.padding:e.padding:0;let r=["years","months","days","hours","minutes","seconds"],s=e.unit;return Array.isArray(e.unit)&&(r=e.unit,s=void 0),gU(i,this.plus(n),{...e,numeric:"always",units:r,unit:s})}toRelativeCalendar(e={}){return this.isValid?gU(e.base||Ve.fromObject({},{zone:this.zone}),this,{...e,numeric:"auto",units:["years","months","days"],calendary:!0}):null}static min(...e){if(!e.every(Ve.isDateTime))throw new el("min requires all arguments be DateTimes");return tU(e,i=>i.valueOf(),Math.min)}static max(...e){if(!e.every(Ve.isDateTime))throw new el("max requires all arguments be DateTimes");return tU(e,i=>i.valueOf(),Math.max)}static fromFormatExplain(e,i,n={}){const{locale:r=null,numberingSystem:s=null}=n,o=Bi.fromOpts({locale:r,numberingSystem:s,defaultToEN:!0});return Kte(o,e,i)}static fromStringExplain(e,i,n={}){return Ve.fromFormatExplain(e,i,n)}static get DATE_SHORT(){return rA}static get DATE_MED(){return dte}static get DATE_MED_WITH_WEEKDAY(){return dxe}static get DATE_FULL(){return pte}static get DATE_HUGE(){return fte}static get TIME_SIMPLE(){return mte}static get TIME_WITH_SECONDS(){return gte}static get TIME_WITH_SHORT_OFFSET(){return yte}static get TIME_WITH_LONG_OFFSET(){return vte}static get TIME_24_SIMPLE(){return _te}static get TIME_24_WITH_SECONDS(){return bte}static get TIME_24_WITH_SHORT_OFFSET(){return wte}static get TIME_24_WITH_LONG_OFFSET(){return xte}static get DATETIME_SHORT(){return Ste}static get DATETIME_SHORT_WITH_SECONDS(){return Tte}static get DATETIME_MED(){return Ite}static get DATETIME_MED_WITH_SECONDS(){return Cte}static get DATETIME_MED_WITH_WEEKDAY(){return pxe}static get DATETIME_FULL(){return Mte}static get DATETIME_FULL_WITH_SECONDS(){return Ete}static get DATETIME_HUGE(){return Ate}static get DATETIME_HUGE_WITH_SECONDS(){return $te}}function y1(t){if(Ve.isDateTime(t))return t;if(t&&t.valueOf&&my(t.valueOf()))return Ve.fromJSDate(t);if(t&&typeof t=="object")return Ve.fromObject(t);throw new el(`Unknown datetime argument: ${t}, of type ${typeof t}`)}const lSe={year:void 0,month:void 0,day:void 0,weekday:void 0},cSe={hour:void 0,minute:void 0,second:void 0},uSe={timeZone:Intl.DateTimeFormat().resolvedOptions().timeZone},J6={timeZone:"Etc/UTC"},Fc={year:"numeric",month:"numeric",day:"numeric"},v1={year:"numeric",month:"long",day:"numeric"},_1={year:"numeric",month:"short",day:"numeric"},b1={year:"numeric",month:"long",weekday:"long",day:"numeric"},Da={hour:"numeric",minute:"numeric"},Al={...Da,second:"numeric"},Bb={"short-date":Fc,"short-date-short-time":{...Fc,...Da},"short-date-short-time-24":{...Fc,...Da,hour12:!1},"short-date-long-time":{...Fc,...Al},"short-date-long-time-24":{...Fc,...Al,hour12:!1},"short-date-le":Fc,"short-date-le-short-time":{...Fc,...Da},"short-date-le-short-time-24":{...Fc,...Da,hour12:!1},"short-date-le-long-time":{...Fc,...Al},"short-date-le-long-time-24":{...Fc,...Al,hour12:!1},"long-month-day-year":v1,"long-month-day-year-short-time":{...v1,...Da},"long-month-day-year-short-time-24":{...v1,...Da,hour12:!1},"long-month-day-year-long-time":{...v1,...Al},"long-month-day-year-long-time-24":{...v1,...Al,hour12:!1},"day-short-month-year":_1,"day-short-month-year-short-time":{..._1,...Da},"day-short-month-year-short-time-24":{..._1,...Da,hour12:!1},"day-short-month-year-long-time":{..._1,...Al},"day-short-month-year-long-time-24":{..._1,...Al,hour12:!1},"long-date":b1,"long-date-short-time":{...b1,...Da},"long-date-short-time-24":{...b1,...Da,hour12:!1},"long-date-long-time":{...b1,...Al},"long-date-long-time-24":{...b1,...Al,hour12:!1},"long-month-year":{month:"long",year:"numeric"},"short-month-year":{month:"short",year:"numeric"},year:{year:"numeric"},"short-time":Da,"long-time":Al},hSe=Nn()({shortDate:"short-date",shortDateShortTime:"short-date-short-time",shortDateShortTime24:"short-date-short-time-24",shortDateLongTime:"short-date-long-time",shortDateLongTime24:"short-date-long-time-24",shortDateLE:"short-date-le",shortDateLEShortTime:"short-date-le-short-time",shortDateLEShortTime24:"short-date-le-short-time-24",shortDateLELongTime:"short-date-le-long-time",shortDateLELongTime24:"short-date-le-long-time-24",longMonthDayYear:"long-month-day-year",longMonthDayYearShortTime:"long-month-day-year-short-time",longMonthDayYearShortTime24:"long-month-day-year-short-time-24",longMonthDayYearLongTime:"long-month-day-year-long-time",longMonthDayYearLongTime24:"long-month-day-year-long-time-24",dayShortMonthYear:"day-short-month-year",dayShortMonthYearShortTime:"day-short-month-year-short-time",dayShortMonthYearShortTime24:"day-short-month-year-short-time-24",dayShortMonthYearLongTime:"day-short-month-year-long-time",dayShortMonthYearLongTime24:"day-short-month-year-long-time-24",longDate:"long-date",longDateShortTime:"long-date-short-time",longDateShortTime24:"long-date-short-time-24",longDateLongTime:"long-date-long-time",longDateLongTime24:"long-date-long-time-24",longMonthYear:"long-month-year",shortMonthYear:"short-month-year",year:"year"}),uie={ar:"ar-u-nu-latn-ca-gregory"};let qR=new WeakMap,hie=Bb["short-date-short-time"];function die(t){const e=t||hie;let i=qR.get(e);if(!i){const n=xr(),r=uie[n]||n;i=new Intl.DateTimeFormat(r,e),qR.set(e,i)}return i}function Dh(t){return Bb[t]}function yi(t,e){return die(e).format(t)}function Z6(t,e=Bb["short-date"]){return yi(new Date(t),{...e,...J6,...cSe})}function Y6(t,e=Bb["short-time"]){return yi(new Date(`1970-01-01T${t}Z`),{...e,...J6,...lSe})}function X6(t,e=Bb["short-date-short-time"]){const i=Ve.fromISO(t,{setZone:!0}),n=xr(),r=uie[n]??n;return i.toLocaleString({...uSe,...e},{locale:r})}m6(()=>{qR=new WeakMap,hie=Bb["short-date-short-time"]});const dSe={ar:"ar-u-nu-latn"};let rM=new WeakMap,pie={};function pSe(t){const e=t||pie;if(!rM.has(e)){const i=xr(),n=dSe[xr()]||i;rM.set(e,new Intl.NumberFormat(n,t))}return rM.get(e)}function K6(t={}){const e={};return t.digitSeparator!=null&&(e.useGrouping=t.digitSeparator),t.places!=null&&(e.minimumFractionDigits=e.maximumFractionDigits=t.places),e}function Ns(t,e){return Object.is(t,-0)&&(t=0),pSe(e).format(t)}m6(()=>{rM=new WeakMap,pie={}});let av=class extends An(ie){constructor(e){super(e),this.dateFormat=null,this.digitSeparator=!1,this.places=null}formatNumber(e){return Ns(e,K6(this))}formatDate(e,i=!1){return this.dateFormat?yi(e,{...Dh(this.dateFormat),...i&&J6}):this.formatNumber(e)}formatDateOnly(e){const i=(this.dateFormat&&Dh(this.dateFormat))??void 0;return Z6(e,i)}formatTimeOnly(e){const i=(this.dateFormat&&Dh(this.dateFormat))??void 0;return Y6(e,i)}formatTimestamp(e){const i=(this.dateFormat&&Dh(this.dateFormat))??void 0;return X6(e,i)}formatRasterPixelValue(e){return e.includes("-")?e:e.trim().includes(",")?this._formatDelimitedString(e,",",", "):e.trim().includes(";")?this._formatDelimitedString(e,";","; "):e.trim().includes(" ")?this._formatDelimitedString(e," "," "):this.formatNumber(Number(e))}_formatDelimitedString(e,i,n){return e&&i&&n?e.trim().split(i).map(r=>this.formatNumber(Number(r))).join(n):e}};h([be(hSe)],av.prototype,"dateFormat",void 0),h([p({type:Boolean,json:{write:!0}})],av.prototype,"digitSeparator",void 0),h([p({type:It,json:{write:!0}})],av.prototype,"places",void 0),av=h([P("esri.popup.support.FieldInfoFormat")],av);const a_=av;var WR;let Nl=WR=class extends ie{constructor(t){super(t),this.fieldName=null,this.format=null,this.isEditable=!0,this.label=null,this.stringFieldOption="text-box",this.statisticType=null,this.tooltip=null,this.visible=!0}clone(){return new WR({fieldName:this.fieldName,format:this.format?q(this.format):null,isEditable:this.isEditable,label:this.label,stringFieldOption:this.stringFieldOption,statisticType:this.statisticType,tooltip:this.tooltip,visible:this.visible})}};h([p({type:String,json:{write:!0}})],Nl.prototype,"fieldName",void 0),h([p({type:a_,json:{write:!0}})],Nl.prototype,"format",void 0),h([p({type:Boolean,json:{write:{alwaysWriteDefaults:!0},default:!0}})],Nl.prototype,"isEditable",void 0),h([p({type:String,json:{write:!0}})],Nl.prototype,"label",void 0),h([be(new qe({richtext:"rich-text",textarea:"text-area",textbox:"text-box"}),{default:"text-box"})],Nl.prototype,"stringFieldOption",void 0),h([p({type:["count","sum","min","max","avg","stddev","var"],json:{write:!0}})],Nl.prototype,"statisticType",void 0),h([p({type:String,json:{write:!0}})],Nl.prototype,"tooltip",void 0),h([p({type:Boolean,json:{write:!0}})],Nl.prototype,"visible",void 0),Nl=WR=h([P("esri.popup.FieldInfo")],Nl);const Q6=Nl;var JR;let rh=JR=class extends Wf{constructor(t){super(t),this.attributes=null,this.description=null,this.fieldInfos=null,this.title=null,this.type="fields"}writeFieldInfos(t,e){e.fieldInfos=t&&t.map(i=>i.toJSON())}clone(){return new JR(q({attributes:this.attributes,description:this.description,fieldInfos:this.fieldInfos,title:this.title}))}};h([p({type:Object,json:{write:!0}})],rh.prototype,"attributes",void 0),h([p({type:String,json:{write:!0}})],rh.prototype,"description",void 0),h([p({type:[Q6]})],rh.prototype,"fieldInfos",void 0),h([ge("fieldInfos")],rh.prototype,"writeFieldInfos",null),h([p({type:String,json:{write:!0}})],rh.prototype,"title",void 0),h([p({type:["fields"],readOnly:!0,json:{read:!1,write:!0}})],rh.prototype,"type",void 0),rh=JR=h([P("esri.popup.content.FieldsContent")],rh);const F2=rh;let Nm=class extends ie{constructor(e){super(e),this.altText=null,this.caption="",this.title="",this.type=null}};h([p({type:String,json:{write:!0}})],Nm.prototype,"altText",void 0),h([p({type:String,json:{write:!0}})],Nm.prototype,"caption",void 0),h([p({type:String,json:{write:!0}})],Nm.prototype,"title",void 0),h([p({type:["image","bar-chart","column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],Nm.prototype,"type",void 0),Nm=h([P("esri.popup.content.mixins.MediaInfo")],Nm);const eV=Nm;var ZR;let lv=ZR=class extends ye{constructor(t){super(t),this.fieldName=null,this.tooltip=null,this.value=null}clone(){return new ZR({fieldName:this.fieldName,tooltip:this.tooltip,value:this.value})}};h([p()],lv.prototype,"fieldName",void 0),h([p()],lv.prototype,"tooltip",void 0),h([p()],lv.prototype,"value",void 0),lv=ZR=h([P("esri.popup.content.support.ChartMediaInfoValueSeries")],lv);const fSe=lv;var YR;let Fm=YR=class extends ie{constructor(t){super(t),this.fields=[],this.normalizeField=null,this.series=[],this.tooltipField=null}clone(){return new YR({fields:q(this.fields),normalizeField:this.normalizeField,tooltipField:this.tooltipField})}};h([p({type:[String],json:{write:!0}})],Fm.prototype,"fields",void 0),h([p({type:String,json:{write:!0}})],Fm.prototype,"normalizeField",void 0),h([p({type:[fSe],json:{read:!1}})],Fm.prototype,"series",void 0),h([p({type:String,json:{write:!0}})],Fm.prototype,"tooltipField",void 0),Fm=YR=h([P("esri.popup.content.support.ChartMediaInfoValue")],Fm);const mSe=Fm;let mw=class extends eV{constructor(e){super(e),this.type=null,this.value=null}};h([p({type:["bar-chart","column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],mw.prototype,"type",void 0),h([p({type:mSe,json:{write:!0}})],mw.prototype,"value",void 0),mw=h([P("esri.popup.content.mixins.ChartMediaInfo")],mw);const pP=mw,fP=Nn()({barchart:"bar-chart",columnchart:"column-chart",linechart:"line-chart",piechart:"pie-chart"});var XR;let sM=XR=class extends pP{constructor(t){super(t),this.type="bar-chart"}clone(){return new XR({altText:this.altText,title:this.title,caption:this.caption,value:this.value?this.value.clone():null})}};h([p({type:["bar-chart"],readOnly:!0,json:{type:["barchart"],read:!1,write:fP.write}})],sM.prototype,"type",void 0),sM=XR=h([P("esri.popup.content.BarChartMediaInfo")],sM);const fie=sM;var KR;let oM=KR=class extends pP{constructor(t){super(t),this.type="column-chart"}clone(){return new KR({altText:this.altText,title:this.title,caption:this.caption,value:this.value?this.value.clone():null})}};h([p({type:["column-chart"],readOnly:!0,json:{type:["columnchart"],read:!1,write:fP.write}})],oM.prototype,"type",void 0),oM=KR=h([P("esri.popup.content.ColumnChartMediaInfo")],oM);const mie=oM;var QR;let gw=QR=class extends ie{constructor(t){super(t),this.linkURL=null,this.sourceURL=null}clone(){return new QR({linkURL:this.linkURL,sourceURL:this.sourceURL})}};h([p({type:String,json:{write:!0}})],gw.prototype,"linkURL",void 0),h([p({type:String,json:{write:!0}})],gw.prototype,"sourceURL",void 0),gw=QR=h([P("esri.popup.content.support.ImageMediaInfoValue")],gw);const gSe=gw;var e5;let cv=e5=class extends eV{constructor(t){super(t),this.refreshInterval=null,this.type="image",this.value=null}clone(){return new e5({altText:this.altText,title:this.title,caption:this.caption,refreshInterval:this.refreshInterval,value:this.value?this.value.clone():null})}};h([p({type:Number,json:{write:!0}})],cv.prototype,"refreshInterval",void 0),h([p({type:["image"],readOnly:!0,json:{read:!1,write:!0}})],cv.prototype,"type",void 0),h([p({type:gSe,json:{write:!0}})],cv.prototype,"value",void 0),cv=e5=h([P("esri.popup.content.ImageMediaInfo")],cv);const gie=cv;var t5;let aM=t5=class extends pP{constructor(t){super(t),this.type="line-chart"}clone(){return new t5({altText:this.altText,title:this.title,caption:this.caption,value:this.value?this.value.clone():null})}};h([p({type:["line-chart"],readOnly:!0,json:{type:["linechart"],read:!1,write:fP.write}})],aM.prototype,"type",void 0),aM=t5=h([P("esri.popup.content.LineChartMediaInfo")],aM);const yie=aM;var i5;let lM=i5=class extends pP{constructor(t){super(t),this.type="pie-chart"}clone(){return new i5({altText:this.altText,title:this.title,caption:this.caption,value:this.value?this.value.clone():null})}};h([p({type:["pie-chart"],readOnly:!0,json:{type:["piechart"],read:!1,write:fP.write}})],lM.prototype,"type",void 0),lM=i5=h([P("esri.popup.content.PieChartMediaInfo")],lM);const vie=lM,_ie={base:eV,key:"type",defaultKeyValue:"image",typeMap:{"bar-chart":fie,"column-chart":mie,"line-chart":yie,"pie-chart":vie,image:gie}};var n5;let Fl=n5=class extends Wf{constructor(t){super(t),this.activeMediaInfoIndex=null,this.attributes=null,this.description=null,this.mediaInfos=null,this.title=null,this.type="media"}readMediaInfos(t){return t&&t.map(e=>e.type==="image"?gie.fromJSON(e):e.type==="barchart"?fie.fromJSON(e):e.type==="columnchart"?mie.fromJSON(e):e.type==="linechart"?yie.fromJSON(e):e.type==="piechart"?vie.fromJSON(e):void 0).filter(Boolean)}writeMediaInfos(t,e){e.mediaInfos=t&&t.map(i=>i.toJSON())}clone(){return new n5(q({activeMediaInfoIndex:this.activeMediaInfoIndex,attributes:this.attributes,description:this.description,mediaInfos:this.mediaInfos,title:this.title}))}};h([p()],Fl.prototype,"activeMediaInfoIndex",void 0),h([p({type:Object,json:{write:!0}})],Fl.prototype,"attributes",void 0),h([p({type:String,json:{write:!0}})],Fl.prototype,"description",void 0),h([p({types:[_ie]})],Fl.prototype,"mediaInfos",void 0),h([_e("mediaInfos")],Fl.prototype,"readMediaInfos",null),h([ge("mediaInfos")],Fl.prototype,"writeMediaInfos",null),h([p({type:String,json:{write:!0}})],Fl.prototype,"title",void 0),h([p({type:["media"],readOnly:!0,json:{read:!1,write:!0}})],Fl.prototype,"type",void 0),Fl=n5=h([P("esri.popup.content.MediaContent")],Fl);const lA=Fl;var r5;let yw=r5=class extends ie{constructor(t){super(t),this.field=null,this.order=null}clone(){return new r5({field:this.field,order:this.order})}};h([p({type:String,json:{write:!0}})],yw.prototype,"field",void 0),h([p({type:["asc","desc"],json:{write:!0}})],yw.prototype,"order",void 0),yw=r5=h([P("esri.popup.support.RelatedRecordsInfoFieldOrder")],yw);const bie=yw;let Hc=class extends An(Wf){constructor(e){super(e),this.description=null,this.displayCount=null,this.displayType="list",this.orderByFields=null,this.relationshipId=null,this.title=null,this.type="relationship"}};h([p({type:String,json:{write:!0}})],Hc.prototype,"description",void 0),h([p({type:Number,json:{type:It,write:!0}})],Hc.prototype,"displayCount",void 0),h([p({type:["list"],json:{write:!0}})],Hc.prototype,"displayType",void 0),h([p({type:[bie],json:{write:!0}})],Hc.prototype,"orderByFields",void 0),h([p({type:Number,json:{type:It,write:!0}})],Hc.prototype,"relationshipId",void 0),h([p({type:String,json:{write:!0}})],Hc.prototype,"title",void 0),h([p({type:["relationship"],readOnly:!0,json:{read:!1,write:!0}})],Hc.prototype,"type",void 0),Hc=h([P("esri.popup.content.RelationshipContent")],Hc);const cA=Hc;var s5;let vw=s5=class extends Wf{constructor(t){super(t),this.text=null,this.type="text"}clone(){return new s5({text:this.text})}};h([p({type:String,json:{write:!0}})],vw.prototype,"text",void 0),h([p({type:["text"],readOnly:!0,json:{read:!1,write:!0}})],vw.prototype,"type",void 0),vw=s5=h([P("esri.popup.content.TextContent")],vw);const uA=vw,ySe={base:null,key:"type",typeMap:{attachment:N2,media:lA,text:uA,expression:V6,field:F2,relationship:cA}};var o5;let zm=o5=class extends ie{constructor(t){super(t),this.name=null,this.title=null,this.expression=null,this.returnType=null}clone(){return new o5({name:this.name,title:this.title,expression:this.expression,returnType:this.returnType})}};h([p({type:String,json:{write:!0}})],zm.prototype,"name",void 0),h([p({type:String,json:{write:!0}})],zm.prototype,"title",void 0),h([p({type:String,json:{write:!0}})],zm.prototype,"expression",void 0),h([p({type:["string","number"],json:{write:!0}})],zm.prototype,"returnType",void 0),zm=o5=h([P("esri.popup.ExpressionInfo")],zm);const vSe=zm;var a5;let _w=a5=class extends ie{constructor(t){super(t),this.returnTopmostRaster=null,this.showNoDataRecords=null}clone(){return new a5({showNoDataRecords:this.showNoDataRecords,returnTopmostRaster:this.returnTopmostRaster})}};h([p({type:Boolean,json:{write:!0}})],_w.prototype,"returnTopmostRaster",void 0),h([p({type:Boolean,json:{write:!0}})],_w.prototype,"showNoDataRecords",void 0),_w=a5=h([P("esri.popup.LayerOptions")],_w);const _Se=_w;var l5;let bw=l5=class extends ie{constructor(t){super(t),this.showRelatedRecords=null,this.orderByFields=null}clone(){return new l5({showRelatedRecords:this.showRelatedRecords,orderByFields:this.orderByFields?q(this.orderByFields):null})}};h([p({type:Boolean,json:{write:!0}})],bw.prototype,"showRelatedRecords",void 0),h([p({type:[bie],json:{write:!0}})],bw.prototype,"orderByFields",void 0),bw=l5=h([P("esri.popup.RelatedRecordsInfo")],bw);const bSe=bw;var c5;let Na=c5=class extends Nb(ye){constructor(t){super(t),this.active=!1,this.className=null,this.disabled=!1,this.icon=null,this.id=null,this.indicator=!1,this.title=null,this.type=null,this.visible=!0}clone(){return new c5({active:this.active,className:this.className,disabled:this.disabled,icon:this.icon,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible})}};h([p()],Na.prototype,"active",void 0),h([p()],Na.prototype,"className",void 0),h([p()],Na.prototype,"disabled",void 0),h([p()],Na.prototype,"icon",void 0),h([p()],Na.prototype,"id",void 0),h([p()],Na.prototype,"indicator",void 0),h([p()],Na.prototype,"title",void 0),h([p()],Na.prototype,"type",void 0),h([p()],Na.prototype,"visible",void 0),Na=c5=h([P("esri.support.actions.ActionBase")],Na);const GS=Na;var u5;let cM=u5=class extends GS{constructor(t){super(t),this.image=null,this.type="button"}clone(){return new u5({active:this.active,className:this.className,disabled:this.disabled,icon:this.icon,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image})}};h([p()],cM.prototype,"image",void 0),cM=u5=h([P("esri.support.Action.ActionButton")],cM);const wie=cM;var h5;let ww=h5=class extends GS{constructor(t){super(t),this.image=null,this.type="toggle",this.value=!1}clone(){return new h5({active:this.active,className:this.className,disabled:this.disabled,icon:this.icon,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image,value:this.value})}};h([p()],ww.prototype,"image",void 0),h([p()],ww.prototype,"value",void 0),ww=h5=h([P("esri.support.Action.ActionToggle")],ww);const xie=ww,wSe="esri.PopupTemplate",xSe=ne.getLogger(wSe),w1="relationships/",vU="expression/",SSe=xe.ofType({key:"type",defaultKeyValue:"button",base:GS,typeMap:{button:wie,toggle:xie}}),TSe={base:Wf,key:"type",typeMap:{media:lA,custom:axe,text:uA,attachments:N2,fields:F2,expression:V6,relationship:cA}},ISe=["attachments","fields","media","text","expression","relationship"];let pr=class extends An(ie){constructor(){super(...arguments),this.actions=null,this.content="",this.expressionInfos=null,this.fieldInfos=null,this.layerOptions=null,this.lastEditInfoEnabled=!0,this.outFields=null,this.overwriteActions=!1,this.returnGeometry=!1,this.title=""}castContent(e){return Array.isArray(e)?e.map(i=>nd(TSe,i)):typeof e=="string"||typeof e=="function"||e instanceof HTMLElement||fd(e)?e:(xSe.error("content error","unsupported content value",{value:e}),null)}readContent(e,i){const{popupElements:n}=i;return Array.isArray(n)&&n.length>0?this._readPopupInfoElements(i.description,i.mediaInfos,n):this._readPopupInfo(i)}writeContent(e,i,n,r){typeof e!="string"?Array.isArray(e)&&(i.popupElements=e.filter(s=>ISe.includes(s.type)).map(s=>s&&s.toJSON(r)),i.popupElements.forEach(s=>{s.type==="attachments"?this._writeAttachmentContent(i):s.type==="media"?this._writeMediaContent(s,i):s.type==="text"?this._writeTextContent(s,i):s.type==="relationship"&&this._writeRelationshipContent(s,i)})):i.description=e}writeFieldInfos(e,i,n,r){const{content:s}=this,o=Array.isArray(s)?s:null;if(e){const a=o?o.filter(c=>c.type==="fields"):[],l=a.length&&a.every(c=>{var u;return(u=c.fieldInfos)==null?void 0:u.length});i.fieldInfos=e.filter(Boolean).map(c=>{const u=c.toJSON(r);return l&&(u.visible=!1),u})}if(o)for(const a of o)a.type==="fields"&&this._writeFieldsContent(a,i)}writeLayerOptions(e,i,n,r){i[n]=!e||e.showNoDataRecords===null&&e.returnTopmostRaster===null?null:e.toJSON(r)}writeTitle(e,i){i.title=e||""}async collectRequiredFields(e,i){const n=this.expressionInfos||[];await this._collectExpressionInfoFields(e,i,[...n,...this._getContentExpressionInfos(this.content,n)]),R2(e,i,[...this.outFields||[],...this._getActionsFields(this.actions),...this._getTitleFields(this.title),...this._getContentFields(this.content)])}async getRequiredFields(e){const i=new Set;return await this.collectRequiredFields(i,e),[...i].sort()}_writeFieldsContent(e,i){if(!Array.isArray(e.fieldInfos)||!e.fieldInfos.length)return;const n=q(e.fieldInfos);Array.isArray(i.fieldInfos)?n.forEach(r=>{const s=i.fieldInfos.find(o=>o.fieldName.toLowerCase()===r.fieldName.toLowerCase());s?s.visible=!0:i.fieldInfos.push(r)}):i.fieldInfos=n}_writeAttachmentContent(e){e.showAttachments||(e.showAttachments=!0)}_writeRelationshipContent(e,i){var s,o;const n=((s=e.orderByFields)==null?void 0:s.map(a=>this._toFieldOrderJSON(a,e.relationshipId)))||[],r=[...((o=i.relatedRecordsInfo)==null?void 0:o.orderByFields)||[],...n];i.relatedRecordsInfo={showRelatedRecords:!0,...(r==null?void 0:r.length)&&{orderByFields:r}}}_writeTextContent(e,i){!i.description&&e.text&&(i.description=e.text)}_writeMediaContent(e,i){if(!Array.isArray(e.mediaInfos)||!e.mediaInfos.length)return;const n=q(e.mediaInfos);Array.isArray(i.mediaInfos)?i.mediaInfos=[...i.mediaInfos,...n]:i.mediaInfos=n}_readPopupInfoElements(e,i,n){const r={description:!1,mediaInfos:!1};return n.map(s=>s.type==="media"?(s.mediaInfos||!i||r.mediaInfos||(s.mediaInfos=i,r.mediaInfos=!0),lA.fromJSON(s)):s.type==="text"?(s.text||!e||r.description||(s.text=e,r.description=!0),uA.fromJSON(s)):s.type==="attachments"?N2.fromJSON(s):s.type==="fields"?F2.fromJSON(s):s.type==="expression"?V6.fromJSON(s):s.type==="relationship"?cA.fromJSON(s):void 0).filter(Boolean)}_toRelationshipContent(e){const{field:i,order:n}=e;if(!(i!=null&&i.startsWith(w1)))return null;const r=i.replace(w1,"").split("/");if(r.length!==2)return null;const s=parseInt(r[0],10),o=r[1];return typeof s=="number"&&o?cA.fromJSON({relationshipId:s,orderByFields:[{field:o,order:n}]}):null}_toFieldOrderJSON(e,i){const{order:n,field:r}=e;return{field:`${w1}${i}/${r}`,order:n}}_readPopupInfo({description:e,mediaInfos:i,showAttachments:n,relatedRecordsInfo:r={showRelatedRecords:!1}}){const s=[];e?s.push(new uA({text:e})):s.push(new F2),Array.isArray(i)&&i.length&&s.push(lA.fromJSON({mediaInfos:i})),n&&s.push(N2.fromJSON({displayType:"auto"}));const{showRelatedRecords:o,orderByFields:a}=r;return o&&(a!=null&&a.length)&&a.forEach(l=>{const c=this._toRelationshipContent(l);c&&s.push(c)}),s.length?s:e}_getContentElementFields(e){const i=e==null?void 0:e.type;if(i==="attachments")return[...this._extractFieldNames(e.title),...this._extractFieldNames(e.description)];if(i==="custom")return e.outFields||[];if(i==="fields")return[...this._extractFieldNames(e.title),...this._extractFieldNames(e.description),...this._getFieldInfoFields(e.fieldInfos??this.fieldInfos)];if(i==="media"){const n=e.mediaInfos||[];return[...this._extractFieldNames(e.title),...this._extractFieldNames(e.description),...n.reduce((r,s)=>[...r,...this._getMediaInfoFields(s)],[])]}return i==="text"?this._extractFieldNames(e.text):[]}_getMediaInfoFields(e){const{caption:i,title:n,value:r}=e,s=r||{},{fields:o,normalizeField:a,tooltipField:l,sourceURL:c,linkURL:u}=s,d=[...this._extractFieldNames(n),...this._extractFieldNames(i),...this._extractFieldNames(c),...this._extractFieldNames(u),...o??[]];return a&&d.push(a),l&&d.push(l),d}_getContentExpressionInfos(e,i){return Array.isArray(e)?e.reduce((n,r)=>[...n,...r.type==="expression"&&r.expressionInfo?[r.expressionInfo]:[]],i):[]}_getContentFields(e){return typeof e=="string"?this._extractFieldNames(e):Array.isArray(e)?e.reduce((i,n)=>[...i,...this._getContentElementFields(n)],[]):[]}async _collectExpressionInfoFields(e,i,n){n&&await Promise.all(n.map(r=>ro(e,i,r.expression)))}_getFieldInfoFields(e){return e?e.filter(i=>i.visible===void 0||!!i.visible).map(i=>i.fieldName).filter(i=>!i.startsWith(w1)&&!i.startsWith(vU)):[]}_getActionsFields(e){return e?e.toArray().reduce((i,n)=>[...i,...this._getActionFields(n)],[]):[]}_getActionFields(e){const{className:i,title:n,type:r}=e,s=r==="button"||r==="toggle"?e.image:"";return[...this._extractFieldNames(n),...this._extractFieldNames(i),...this._extractFieldNames(s)]}_getTitleFields(e){return typeof e=="string"?this._extractFieldNames(e):[]}_extractFieldNames(e){if(!e||typeof e!="string")return[];const i=/{[^}]*}/g,n=e.match(i);if(!n)return[];const r=/\{(\w+):.+\}/,s=n.filter(o=>!(o.indexOf(`{${w1}`)===0||o.indexOf(`{${vU}`)===0)).map(o=>o.replace(r,"{$1}"));return s?s.map(o=>o.slice(1,-1)):[]}};h([p({type:SSe})],pr.prototype,"actions",void 0),h([p()],pr.prototype,"content",void 0),h([ut("content")],pr.prototype,"castContent",null),h([_e("content",["description","fieldInfos","popupElements","mediaInfos","showAttachments","relatedRecordsInfo"])],pr.prototype,"readContent",null),h([ge("content",{popupElements:{type:xe.ofType(ySe)},showAttachments:{type:Boolean},mediaInfos:{type:xe.ofType(_ie)},description:{type:String},relatedRecordsInfo:{type:bSe}})],pr.prototype,"writeContent",null),h([p({type:[vSe],json:{write:!0}})],pr.prototype,"expressionInfos",void 0),h([p({type:[Q6]})],pr.prototype,"fieldInfos",void 0),h([ge("fieldInfos")],pr.prototype,"writeFieldInfos",null),h([p({type:_Se})],pr.prototype,"layerOptions",void 0),h([ge("layerOptions")],pr.prototype,"writeLayerOptions",null),h([p({type:Boolean,json:{read:{source:"showLastEditInfo"},write:{target:"showLastEditInfo"},default:!0}})],pr.prototype,"lastEditInfoEnabled",void 0),h([p()],pr.prototype,"outFields",void 0),h([p()],pr.prototype,"overwriteActions",void 0),h([p()],pr.prototype,"returnGeometry",void 0),h([p({json:{type:String}})],pr.prototype,"title",void 0),h([ge("title")],pr.prototype,"writeTitle",null),pr=h([P("esri.PopupTemplate")],pr);const Jf=pr,_U=new qe({esriSMS:"simple-marker",esriPMS:"picture-marker",esriSLS:"simple-line",esriSFS:"simple-fill",esriPFS:"picture-fill",esriTS:"text",esriSHD:"shield-label-symbol",PointSymbol3D:"point-3d",LineSymbol3D:"line-3d",PolygonSymbol3D:"polygon-3d",WebStyleSymbol:"web-style",MeshSymbol3D:"mesh-3d",LabelSymbol3D:"label-3d",CIMSymbolReference:"cim"});let CSe=0,uv=class extends ie{constructor(e){super(e),this.id="sym"+CSe++,this.type=null,this.color=new ae([0,0,0,1])}readColor(e){return e&&e[0]!=null?[e[0],e[1],e[2],e[3]/255]:e}async collectRequiredFields(e,i){}hash(){return JSON.stringify(this.toJSON())}clone(){}};h([p({type:_U.apiValues,readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0,writer:_U.write}}})],uv.prototype,"type",void 0),h([p({type:ae,json:{write:{allowNull:!0}}})],uv.prototype,"color",void 0),h([_e("color")],uv.prototype,"readColor",null),uv=h([P("esri.symbols.Symbol")],uv);const Go=uv;var d5;let Kd=d5=class extends Go{constructor(t){super(t),this.data=null,this.type="cim"}readData(t,e){return e}writeData(t,e){Object.assign(e,t)}async collectRequiredFields(t,e){var i;if(((i=this.data)==null?void 0:i.type)==="CIMSymbolReference"){const n=this.data.primitiveOverrides;if(n){const r=n.map(s=>{const o=s.valueExpressionInfo;return ro(t,e,o.expression)});await Promise.all(r)}}}clone(){return new d5({data:q(this.data)})}hash(){return Nz(JSON.stringify(this.data)).toString()}};h([p({json:{write:!1}})],Kd.prototype,"color",void 0),h([p({json:{write:!0}})],Kd.prototype,"data",void 0),h([_e("data",["symbol"])],Kd.prototype,"readData",null),h([ge("data",{})],Kd.prototype,"writeData",null),h([be({CIMSymbolReference:"cim"},{readOnly:!0})],Kd.prototype,"type",void 0),Kd=d5=h([P("esri.symbols.CIMSymbol")],Kd);const Ub=Kd;let hv=class extends ie{constructor(e){super(e),this.enabled=!0,this.type=null,this.ignoreDrivers=!1}writeEnabled(e,i,n){e||(i[n]=e)}};h([p({type:Boolean,json:{read:{source:"enable"},write:{target:"enable"}}})],hv.prototype,"enabled",void 0),h([ge("enabled")],hv.prototype,"writeEnabled",null),h([p({type:["icon","object","line","path","fill","water","extrude","text"],readOnly:!0})],hv.prototype,"type",void 0),hv=h([P("esri.symbols.Symbol3DLayer")],hv);const ju=hv,MSe=/^-?(\d+(\.\d+)?)\s*((px)|(pt))?$/i,ESe="screenUtils.toPt: input not recognized!",Sie=96;function Gi(t){return t?t/72*Sie:0}function Tc(t){return t?72*t/Sie:0}function vt(t){if(typeof t=="string"){const e=t.match(MSe);if(e){const i=Number(e[1]),n=e[3]&&e[3].toLowerCase(),r=t.charAt(0)==="-",s=n==="px"?Tc(i):i;return r?-s:s}return console.warn(ESe),null}return t}function As(t=0,e=0){return{x:t,y:e}}function ASe(t=0,e=0){return[t,e]}function Dlt(t=0,e=0,i=0){return[t,e,i]}function Nlt(t){return t}function Flt(t){return t}function zlt(t){return t}function Vlt(t,e){return e?(e[0]=t.x,e[1]=t.y,e.length>2&&(e[2]=0),e):[t.x,t.y]}function $Se(t,e){const i=e.transparency!=null?k2(e.transparency):1,n=e.color;return n&&Array.isArray(n)?new ae([n[0]||0,n[1]||0,n[2]||0,i]):null}function PSe(t,e){e.color=t.toJSON().slice(0,3);const i=I6(t.a);i!==0&&(e.transparency=i)}const Zf={type:ae,json:{type:[It],default:null,read:{source:["color","transparency"],reader:$Se},write:{target:{color:{type:[It]},transparency:{type:It}},writer:PSe}}},ku={type:Number,cast:vt,json:{write:!0}};let Vm=class extends ie{constructor(e){super(e),this.color=new ae([0,0,0,1]),this.extensionLength=0,this.size=Tc(1)}clone(){}cloneProperties(){return{color:q(this.color),size:this.size,extensionLength:this.extensionLength}}};h([p({type:["solid","sketch"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],Vm.prototype,"type",void 0),h([p(Zf)],Vm.prototype,"color",void 0),h([p({...ku,json:{write:{overridePolicy:t=>({enabled:!!t})}}})],Vm.prototype,"extensionLength",void 0),h([p(ku)],Vm.prototype,"size",void 0),Vm=h([P("esri.symbols.edges.Edges3D")],Vm);const tV=Vm;var p5;let uM=p5=class extends tV{constructor(t){super(t),this.type="sketch"}clone(){return new p5(this.cloneProperties())}};h([be({sketch:"sketch"},{readOnly:!0})],uM.prototype,"type",void 0),uM=p5=h([P("esri.symbols.edges.SketchEdges3D")],uM);const kSe=uM;var f5;let hM=f5=class extends tV{constructor(t){super(t),this.type="solid"}clone(){return new f5(this.cloneProperties())}};h([be({solid:"solid"},{readOnly:!0})],hM.prototype,"type",void 0),hM=f5=h([P("esri.symbols.support.SolidEdges3D")],hM);const OSe=hM,Tie={types:{key:"type",base:tV,typeMap:{solid:OSe,sketch:kSe}},json:{write:!0}};var m5;let ba=m5=class extends ie{constructor(t){super(t),this.color=null}clone(){const t={color:this.color!=null?this.color.clone():null};return new m5(t)}};h([p(Zf)],ba.prototype,"color",void 0),ba=m5=h([P("esri.symbols.support.Symbol3DMaterial")],ba);var g5;let Qd=g5=class extends ju{constructor(t){super(t),this.type="extrude",this.size=1,this.material=null,this.castShadows=!0,this.edges=null}clone(){return new g5({edges:this.edges&&this.edges.clone(),enabled:this.enabled,material:this.material!=null?this.material.clone():null,castShadows:this.castShadows,size:this.size})}};h([be({Extrude:"extrude"},{readOnly:!0})],Qd.prototype,"type",void 0),h([p({type:Number,json:{write:{enabled:!0,isRequired:!0}},nonNullable:!0})],Qd.prototype,"size",void 0),h([p({type:ba,json:{write:!0}})],Qd.prototype,"material",void 0),h([p({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],Qd.prototype,"castShadows",void 0),h([p(Tie)],Qd.prototype,"edges",void 0),Qd=g5=h([P("esri.symbols.ExtrudeSymbol3DLayer")],Qd);const Iie=Qd;let xw=class extends Go{constructor(e){super(e),this.type="simple-line",this.width=.75}hash(){return`${this.type}.${this.width}`}};h([be({esriSLS:"simple-line"},{readOnly:!0})],xw.prototype,"type",void 0),h([p({type:Number,cast:vt,json:{write:!0}})],xw.prototype,"width",void 0),xw=h([P("esri.symbols.LineSymbol")],xw);const LSe=xw,RSe=["begin","end","begin-end"],Cie=["arrow","circle","square","diamond","cross","x"];var y5;let qc=y5=class extends ie{constructor(t){super(t),this.placement="begin-end",this.type="line-marker",this.style="arrow"}writeStyle(t,e,i,n){e[i]=(n==null?void 0:n.origin)==="web-map"?"arrow":t}set color(t){this._set("color",t)}readColor(t){return t&&t[0]!=null?[t[0],t[1],t[2],t[3]/255]:t}writeColor(t,e,i,n){(n==null?void 0:n.origin)==="web-map"||(e[i]=t)}clone(){return new y5({color:q(this.color),placement:this.placement,style:this.style})}hash(){var t;return`${this.placement}.${(t=this.color)==null?void 0:t.hash()}.${this.style}`}};h([p({type:["begin","end","begin-end"],json:{write:!0}})],qc.prototype,"placement",void 0),h([be({"line-marker":"line-marker"},{readOnly:!0}),p({json:{origins:{"web-map":{write:!1}}}})],qc.prototype,"type",void 0),h([p({type:Cie})],qc.prototype,"style",void 0),h([ge("style")],qc.prototype,"writeStyle",null),h([p({type:ae,value:null,json:{write:{allowNull:!0}}})],qc.prototype,"color",null),h([_e("color")],qc.prototype,"readColor",null),h([ge("color")],qc.prototype,"writeColor",null),qc=y5=h([P("esri.symbols.LineSymbolMarker")],qc);const DSe=qc;var v5;const I3=new qe({esriSLSSolid:"solid",esriSLSDash:"dash",esriSLSDot:"dot",esriSLSDashDot:"dash-dot",esriSLSDashDotDot:"long-dash-dot-dot",esriSLSNull:"none",esriSLSInsideFrame:"inside-frame",esriSLSShortDash:"short-dash",esriSLSShortDot:"short-dot",esriSLSShortDashDot:"short-dash-dot",esriSLSShortDashDotDot:"short-dash-dot-dot",esriSLSLongDash:"long-dash",esriSLSLongDashDot:"long-dash-dot"});let sh=v5=class extends LSe{constructor(...t){super(...t),this.type="simple-line",this.style="solid",this.cap="round",this.join="round",this.marker=null,this.miterLimit=2}normalizeCtorArgs(t,e,i,n,r,s){if(t&&typeof t!="string")return t;const o={};return t!=null&&(o.style=t),e!=null&&(o.color=e),i!=null&&(o.width=vt(i)),n!=null&&(o.cap=n),r!=null&&(o.join=r),s!=null&&(o.miterLimit=vt(s)),o}clone(){var t;return new v5({color:q(this.color),style:this.style,width:this.width,cap:this.cap,join:this.join,miterLimit:this.miterLimit,marker:(t=this.marker)==null?void 0:t.clone()})}hash(){var t,e;return`${super.hash()}.${(t=this.color)==null?void 0:t.hash()}.${this.style}.${this.cap}.${this.join}.${this.miterLimit}.${(e=this.marker)==null?void 0:e.hash()}`}};h([be({esriSLS:"simple-line"},{readOnly:!0})],sh.prototype,"type",void 0),h([p({type:I3.apiValues,json:{read:I3.read,write:I3.write}})],sh.prototype,"style",void 0),h([p({type:["butt","round","square"],json:{write:{overridePolicy:(t,e,i)=>({enabled:t!=="round"&&(i==null||i.origin==null)})}}})],sh.prototype,"cap",void 0),h([p({type:["miter","round","bevel"],json:{write:{overridePolicy:(t,e,i)=>({enabled:t!=="round"&&(i==null||i.origin==null)})}}})],sh.prototype,"join",void 0),h([p({types:{key:"type",base:null,defaultKeyValue:"line-marker",typeMap:{"line-marker":DSe}},json:{write:!0,origins:{"web-scene":{write:!1}}}})],sh.prototype,"marker",void 0),h([p({type:Number,json:{read:!1,write:!1}})],sh.prototype,"miterLimit",void 0),sh=v5=h([P("esri.symbols.SimpleLineSymbol")],sh);const Ur=sh;let Sw=class extends Go{constructor(e){super(e),this.outline=null,this.type=null}hash(){return`${this.type}.${this.outline&&this.outline.hash()}`}};h([p({types:{key:"type",base:null,defaultKeyValue:"simple-line",typeMap:{"simple-line":Ur}},json:{default:null,write:!0}})],Sw.prototype,"outline",void 0),h([p({type:["simple-fill","picture-fill"],readOnly:!0})],Sw.prototype,"type",void 0),Sw=h([P("esri.symbols.FillSymbol")],Sw);const Mie=Sw;let dM=class extends ie{constructor(e){super(e)}clone(){}};h([p({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],dM.prototype,"type",void 0),dM=h([P("esri.symbols.patterns.LinePattern3D")],dM);const Eie=dM,NSe=["dash","dash-dot","dot","long-dash","long-dash-dot","long-dash-dot-dot","none","short-dash","short-dash-dot","short-dash-dot-dot","short-dot","solid"];var _5;const FSe=Nn()({dash:"dash","dash-dot":"dash-dot","dash-dot-dot":"long-dash-dot-dot",dot:"dot","long-dash":"long-dash","long-dash-dot":"long-dash-dot",null:"none","short-dash":"short-dash","short-dash-dot":"short-dash-dot","short-dash-dot-dot":"short-dash-dot-dot","short-dot":"short-dot",solid:"solid"});let Tw=_5=class extends Eie{constructor(t){super(t),this.type="style",this.style="solid"}clone(){const t={style:this.style};return new _5(t)}};h([p({type:["style"]})],Tw.prototype,"type",void 0),h([be(FSe),p({type:NSe})],Tw.prototype,"style",void 0),Tw=_5=h([P("esri.symbols.patterns.LineStylePattern3D")],Tw);const iV=Tw;let pM=class extends ie{constructor(e){super(e)}clone(){}};h([p({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],pM.prototype,"type",void 0),pM=h([P("esri.symbols.patterns.Pattern3D")],pM);const Aie=pM,zSe=["backward-diagonal","cross","diagonal-cross","forward-diagonal","horizontal","none","solid","vertical"];var b5;let Iw=b5=class extends Aie{constructor(t){super(t),this.type="style",this.style="solid"}clone(){const t={style:this.style};return new b5(t)}};h([p({type:["style"]})],Iw.prototype,"type",void 0),h([p({type:zSe,json:{read:!0,write:!0}})],Iw.prototype,"style",void 0),Iw=b5=h([P("esri.symbols.patterns.StylePattern3D")],Iw);const $ie=Iw,VSe={types:{key:"type",base:Aie,typeMap:{style:$ie}},json:{write:!0}},Pie={types:{key:"type",base:Eie,typeMap:{style:iV}},json:{write:!0}},Nx=new ae("white");new ae("black");const jSe=new ae([255,255,255,0]);function BSe(t){return t.r===0&&t.g===0&&t.b===0}var w5;let Fx=w5=class extends ba{constructor(t){super(t),this.colorMixMode=null}clone(){const t={color:this.color!=null?this.color.clone():null,colorMixMode:this.colorMixMode};return new w5(t)}};h([be({multiply:"multiply",replace:"replace",tint:"tint"})],Fx.prototype,"colorMixMode",void 0),Fx=w5=h([P("esri.symbols.support.Symbol3DFillMaterial")],Fx);function mP(t=JSe){return[t[0],t[1],t[2],t[3],t[4],t[5]]}function nV(t,e,i,n,r,s,o=mP()){return o[0]=t,o[1]=e,o[2]=i,o[3]=n,o[4]=r,o[5]=s,o}function qlt(t,e){const i=isFinite(t[2])||isFinite(t[5]);return new Le(i?{xmin:t[0],xmax:t[3],ymin:t[1],ymax:t[4],zmin:t[2],zmax:t[5],spatialReference:e}:{xmin:t[0],xmax:t[3],ymin:t[1],ymax:t[4],spatialReference:e})}function Wlt(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.min(t[2],e[2]),t[3]=Math.max(t[3],e[3]),t[4]=Math.max(t[4],e[4]),t[5]=Math.max(t[5],e[5])}function Jlt(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[3]=Math.max(t[3],e[2]),t[4]=Math.max(t[4],e[3])}function Zlt(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.min(t[2],e[2]),t[3]=Math.max(t[3],e[0]),t[4]=Math.max(t[4],e[1]),t[5]=Math.max(t[5],e[2])}function Ylt(t,e,i=0,n=e.length/3){let r=t[0],s=t[1],o=t[2],a=t[3],l=t[4],c=t[5];for(let u=0;u<n;u++)r=Math.min(r,e[i+3*u]),s=Math.min(s,e[i+3*u+1]),o=Math.min(o,e[i+3*u+2]),a=Math.max(a,e[i+3*u]),l=Math.max(l,e[i+3*u+1]),c=Math.max(c,e[i+3*u+2]);t[0]=r,t[1]=s,t[2]=o,t[3]=a,t[4]=l,t[5]=c}function C3(t,e,i){const n=e.length;let r=t[0],s=t[1],o=t[2],a=t[3],l=t[4],c=t[5];if(i)for(let u=0;u<n;u++){const d=e[u];r=Math.min(r,d[0]),s=Math.min(s,d[1]),o=Math.min(o,d[2]),a=Math.max(a,d[0]),l=Math.max(l,d[1]),c=Math.max(c,d[2])}else for(let u=0;u<n;u++){const d=e[u];r=Math.min(r,d[0]),s=Math.min(s,d[1]),a=Math.max(a,d[0]),l=Math.max(l,d[1])}t[0]=r,t[1]=s,t[2]=o,t[3]=a,t[4]=l,t[5]=c}function Xlt(t){for(let e=0;e<6;e++)if(!isFinite(t[e]))return!1;return!0}function HS(t){return t[0]>=t[3]?0:t[3]-t[0]}function qS(t){return t[1]>=t[4]?0:t[4]-t[1]}function WS(t){return t[2]>=t[5]?0:t[5]-t[2]}function Klt(t){const e=HS(t),i=WS(t),n=qS(t);return Math.sqrt(e*e+i*i+n*n)}function Qlt(t,e=[0,0,0]){return e[0]=t[0]+HS(t)/2,e[1]=t[1]+qS(t)/2,e[2]=t[2]+WS(t)/2,e}function ect(t,e=[0,0,0]){return e[0]=HS(t),e[1]=qS(t),e[2]=WS(t),e}function tct(t,e){return e[0]>=t[0]&&e[1]>=t[1]&&e[2]>=t[2]&&e[0]<=t[3]&&e[1]<=t[4]&&e[2]<=t[5]}function USe(t,e){return Math.max(e[0],t[0])<=Math.min(e[3],t[3])&&Math.max(e[1],t[1])<=Math.min(e[4],t[4])&&Math.max(e[2],t[2])<=Math.min(e[5],t[5])}function ict(t,e){return e==null||USe(t,e)}function nct(t,e,i,n,r=t){return r[0]=t[0]+e,r[1]=t[1]+i,r[2]=t[2]+n,r[3]=t[3]+e,r[4]=t[4]+i,r[5]=t[5]+n,r}function rct(t,e,i=t){const n=t[0]+HS(t)/2,r=t[1]+qS(t)/2,s=t[2]+WS(t)/2;return i[0]=n+(t[0]-n)*e,i[1]=r+(t[1]-r)*e,i[2]=s+(t[2]-s)*e,i[3]=n+(t[3]-n)*e,i[4]=r+(t[4]-r)*e,i[5]=s+(t[5]-s)*e,i}function sct(t,e){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function GSe(t,e,i=t){return i[0]=e[0],i[1]=e[1],i[2]=e[2],i!==t&&(i[3]=t[3],i[4]=t[4],i[5]=t[5]),i}function HSe(t,e,i=t){return i[3]=e[0],i[4]=e[1],i[5]=e[2],i!==t&&(i[0]=t[0],i[1]=t[1],i[2]=t[2]),t}function qSe(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function WSe(t){return t?qSe(t,wU):mP(wU)}function oct(t,e){return e||(e=wa()),e[0]=t[0],e[1]=t[1],e[2]=t[3],e[3]=t[4],e}function act(t,e){return t[0]=e[0],t[1]=e[1],t[2]=Number.NEGATIVE_INFINITY,t[3]=e[2],t[4]=e[3],t[5]=Number.POSITIVE_INFINITY,t}function lct(t,e,i,n,r){return t[0]=e,t[1]=i,t[2]=Number.NEGATIVE_INFINITY,t[3]=n,t[4]=r,t[5]=Number.POSITIVE_INFINITY,t}function bU(t){return t.length===6}function cct(t){return HS(t)===0&&qS(t)===0&&WS(t)===0}function uct(t,e,i){if(t==null||e==null)return t===e;if(!bU(t)||!bU(e))return!1;if(i){for(let n=0;n<t.length;n++)if(!i(t[n],e[n]))return!1}else for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}const wU=[1/0,1/0,1/0,-1/0,-1/0,-1/0],JSe=[0,0,0,0,0,0];mP();function hct(t,{isPrimitive:e,width:i,depth:n,height:r}){const s=e?10:1;if(i==null&&r==null&&n==null)return[s*t[0],s*t[1],s*t[2]];const o=Ln(i,n,r);let a;for(let l=0;l<3;l++){const c=o[l];if(c!=null){a=c/t[l];break}}for(let l=0;l<3;l++)o[l]==null&&(o[l]=t[l]*a);return o}const ZSe=nV(-.5,-.5,-.5,.5,.5,.5),YSe=nV(-.5,-.5,0,.5,.5,1),XSe=nV(-.5,-.5,0,.5,.5,.5);function dct(t){switch(t){case"sphere":case"cube":case"diamond":return ZSe;case"cylinder":case"cone":case"inverted-cone":return YSe;case"tetrahedron":return XSe;default:return}}const rV=["butt","square","round"],KSe=[...rV,"none"],kie=["miter","bevel","round"];var x5;let jm=x5=class extends ie{constructor(t){super(t),this.color=new ae([0,0,0,1]),this.size=Tc(1),this.pattern=null,this.patternCap="butt"}clone(){const t={color:this.color!=null?this.color.clone():null,size:this.size,pattern:this.pattern!=null?this.pattern.clone():null,patternCap:this.patternCap};return new x5(t)}};h([p(Zf)],jm.prototype,"color",void 0),h([p(ku)],jm.prototype,"size",void 0),h([p(Pie)],jm.prototype,"pattern",void 0),h([p({type:rV,json:{default:"butt",write:{overridePolicy(){return{enabled:this.pattern!=null}}}}})],jm.prototype,"patternCap",void 0),jm=x5=h([P("esri.symbols.support.Symbol3DOutline")],jm);var fM;let oh=fM=class extends ju{constructor(t){super(t),this.type="fill",this.material=null,this.pattern=null,this.castShadows=!0,this.outline=null,this.edges=null}clone(){const t={edges:this.edges!=null?this.edges.clone():null,enabled:this.enabled,material:this.material!=null?this.material.clone():null,pattern:this.pattern!=null?this.pattern.clone():null,castShadows:this.castShadows,outline:this.outline!=null?this.outline.clone():null};return new fM(t)}static fromSimpleFillSymbol(t){var n,r,s;const e=t.outline&&t.outline.style&&t.outline.style!=="inside-frame"&&t.outline.style!=="solid"?new iV({style:t.outline.style}):null,i={size:((n=t.outline)==null?void 0:n.width)??0,color:(((r=t.outline)==null?void 0:r.color)??Nx).clone(),pattern:e};return e&&((s=t.outline)!=null&&s.cap)&&(i.patternCap=t.outline.cap),new fM({material:new Fx({color:(t.color??jSe).clone()}),pattern:t.style&&t.style!=="solid"?new $ie({style:t.style}):null,outline:i})}};h([be({Fill:"fill"},{readOnly:!0})],oh.prototype,"type",void 0),h([p({type:Fx,json:{write:!0}})],oh.prototype,"material",void 0),h([p(VSe)],oh.prototype,"pattern",void 0),h([p({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],oh.prototype,"castShadows",void 0),h([p({type:jm,json:{write:!0}})],oh.prototype,"outline",void 0),h([p(Tie)],oh.prototype,"edges",void 0),oh=fM=h([P("esri.symbols.FillSymbol3DLayer")],oh);const Gb=oh,QSe=["none","underline","line-through"],eTe=["normal","italic","oblique"],tTe=["normal","lighter","bold","bolder"],Oie={type:Number,cast:t=>{const e=Qa(t);return e===0?1:rr(e,.1,4)},nonNullable:!0},iTe=["left","right","center"],nTe=["baseline","top","middle","bottom"],Lie={type:iTe,nonNullable:!0},Rie={type:nTe,nonNullable:!0},pct=8;var S5;let ah=S5=class extends ie{constructor(t){super(t),this.decoration="none",this.family="sans-serif",this.size=9,this.style="normal",this.weight="normal"}castSize(t){return vt(t)}clone(){return new S5({decoration:this.decoration,family:this.family,size:this.size,style:this.style,weight:this.weight})}hash(){return`${this.decoration}.${this.family}.${this.size}.${this.style}.${this.weight}`}};h([p({type:QSe,json:{default:"none",write:!0}})],ah.prototype,"decoration",void 0),h([p({type:String,json:{write:!0}})],ah.prototype,"family",void 0),h([p({type:Number,json:{write:{overridePolicy:(t,e,i)=>({enabled:!i||!i.textSymbol3D})}}})],ah.prototype,"size",void 0),h([ut("size")],ah.prototype,"castSize",null),h([p({type:eTe,json:{default:"normal",write:!0}})],ah.prototype,"style",void 0),h([p({type:tTe,json:{default:"normal",write:!0}})],ah.prototype,"weight",void 0),ah=S5=h([P("esri.symbols.Font")],ah);const gP=ah;function Rf(t,e){const i=e&&e.url&&e.url.path;if(t&&i&&(t=tl(t,i,{preserveProtocolRelative:!0}),e.portalItem&&e.readResourcePaths)){const n=Kz(t,e.portalItem.itemUrl);n!=null&&rTe.test(n)&&e.readResourcePaths.push(e.portalItem.resourceFromPath(n).path)}return T5(t,e&&e.portal)}function JS(t,e,i=z2.YES){if(t==null)return t;!ya(t)&&e&&e.blockedRelativeUrls&&e.blockedRelativeUrls.push(t);let n=tl(t);if(e){const r=e.verifyItemRelativeUrls&&e.verifyItemRelativeUrls.rootPath||e.url&&e.url.path;if(r){const s=T5(r,e.portal),o=T5(n,e.portal);n=Kz(o,s,s),n!=null&&n!==o&&n!==t&&e.verifyItemRelativeUrls&&e.verifyItemRelativeUrls.writtenUrls.push(n)}}return n=Nie(n,e==null?void 0:e.portal),ya(n)&&(n=ll(n)),e!=null&&e.resources&&(e!=null&&e.portalItem)&&!ya(n)&&!n0(n)&&i===z2.YES&&e.resources.toKeep.push({resource:e.portalItem.resourceFromPath(n),compress:!1}),n}function sV(t,e,i){return Rf(t,i)}function Fy(t,e,i,n){const r=JS(t,n);r!==void 0&&(e[i]=r)}const Die=/\/items\/([^\/]+)\/resources\/(.*)/,rTe=/^\.\/resources\//;function sTe(t){const e=(t==null?void 0:t.match(Die))??null;return(e==null?void 0:e[1])??null}function oTe(t){const e=(t==null?void 0:t.match(Die))??null;if(e==null)return null;const i=e[2],n=i.lastIndexOf("/");if(n===-1){const{path:o,extension:a}=d9(i);return{prefix:null,filename:o,extension:a}}const{path:r,extension:s}=d9(i.slice(n+1));return{prefix:i.slice(0,n),filename:r,extension:s}}function Nie(t,e){return e&&!e.isPortal&&e.urlKey&&e.customBaseUrl?fR(t,`${e.urlKey}.${e.customBaseUrl}`,e.portalHostname):t}function T5(t,e){if(!e||e.isPortal||!e.urlKey||!e.customBaseUrl)return t;const i=`${e.urlKey}.${e.customBaseUrl}`,n=Jz();return K_(n,`${n.scheme}://${i}`)?fR(t,e.portalHostname,i):fR(t,i,e.portalHostname)}var z2;(function(t){t[t.YES=0]="YES",t[t.NO=1]="NO"})(z2||(z2={}));const fct=Object.freeze(Object.defineProperty({__proto__:null,get MarkKeep(){return z2},ensureMainOnlineDomain:Nie,fromJSON:Rf,itemIdFromResourceUrl:sTe,prefixAndFilenameFromResourceUrl:oTe,read:sV,toJSON:JS,write:Fy},Symbol.toStringTag,{value:"Module"}));var I5;const aTe=Nn()({circle:"circle",square:"square",cross:"cross",x:"x",kite:"kite",triangle:"triangle"});let Bm=I5=class extends ie{constructor(t){super(t)}readHref(t,e,i){return t?Rf(t,i):e.dataURI}writeHref(t,e,i,n){t&&(n0(t)?e.dataURI=t:(e.href=JS(t,n),ya(e.href)&&(e.href=ll(e.href))))}clone(){return new I5({href:this.href,primitive:this.primitive})}};h([p({type:String,json:{write:!0,read:{source:["href","dataURI"]}}})],Bm.prototype,"href",void 0),h([_e("href")],Bm.prototype,"readHref",null),h([ge("href",{href:{type:String},dataURI:{type:String}})],Bm.prototype,"writeHref",null),h([be(aTe)],Bm.prototype,"primitive",void 0),Bm=I5=h([P("esri.symbols.support.IconSymbol3DLayerResource")],Bm);const lTe="circle";var C5;let l_=C5=class extends ye{constructor(){super(...arguments),this.x=0,this.y=0}clone(){return new C5({x:this.x,y:this.y})}};h([p({type:Number})],l_.prototype,"x",void 0),h([p({type:Number})],l_.prototype,"y",void 0),l_=C5=h([P("esri.symbols.support.Symbol3DAnchorPosition2D")],l_);var M5;let Cw=M5=class extends ie{constructor(t){super(t),this.color=new ae([0,0,0,1]),this.size=Tc(1)}clone(){const t={color:this.color!=null?this.color.clone():null,size:this.size};return new M5(t)}};h([p(Zf)],Cw.prototype,"color",void 0),h([p(ku)],Cw.prototype,"size",void 0),Cw=M5=h([P("esri.symbols.support.Symbol3DIconOutline")],Cw);var dv;const Fie="esri.symbols.IconSymbol3DLayer";let Wc=dv=class extends ju{constructor(t){super(t),this.material=null,this.resource=null,this.type="icon",this.size=12,this.anchor="center",this.anchorPosition=null,this.outline=null}clone(){return new dv({anchor:this.anchor,anchorPosition:this.anchorPosition&&this.anchorPosition.clone(),enabled:this.enabled,material:this.material!=null?this.material.clone():null,outline:this.outline!=null?this.outline.clone():null,resource:this.resource&&this.resource.clone(),size:this.size})}static fromSimpleMarkerSymbol(t){const e=t.color||Nx,i=xU(t),n=t.outline&&t.outline.width>0?{size:t.outline.width,color:(t.outline.color||Nx).clone()}:null;return new dv({size:t.size,resource:{primitive:uTe(t.style)},material:{color:e},outline:n,anchor:i?"relative":void 0,anchorPosition:i})}static fromPictureMarkerSymbol(t){const e=!t.color||BSe(t.color)?Nx:t.color,i=xU(t);return new dv({size:t.width<=t.height?t.height:t.width,resource:{href:t.url},material:{color:e.clone()},anchor:i?"relative":void 0,anchorPosition:i})}static fromCIMSymbol(t){return new dv({resource:{href:pQ({mediaType:"application/json",data:JSON.stringify(t.data)})}})}};function xU(t){const e="width"in t?t.width:t.size,i="height"in t?t.height:t.size,n=SU(t.xoffset),r=SU(t.yoffset);return(n||r)&&e&&i?{x:-n/e,y:r/i}:null}function SU(t){return isFinite(t)?t:0}h([p({type:ba,json:{write:!0}})],Wc.prototype,"material",void 0),h([p({type:Bm,json:{write:!0}})],Wc.prototype,"resource",void 0),h([be({Icon:"icon"},{readOnly:!0})],Wc.prototype,"type",void 0),h([p(ku)],Wc.prototype,"size",void 0),h([be({center:"center",left:"left",right:"right",top:"top",bottom:"bottom",topLeft:"top-left",topRight:"top-right",bottomLeft:"bottom-left",bottomRight:"bottom-right",relative:"relative"}),p({json:{default:"center"}})],Wc.prototype,"anchor",void 0),h([p({type:l_,json:{type:[Number],read:{reader:t=>new l_({x:t[0],y:t[1]})},write:{writer:(t,e)=>{e.anchorPosition=[t.x,t.y]},overridePolicy(){return{enabled:this.anchor==="relative"}}}}})],Wc.prototype,"anchorPosition",void 0),h([p({type:Cw,json:{write:!0}})],Wc.prototype,"outline",void 0),Wc=dv=h([P(Fie)],Wc);const cTe={circle:"circle",cross:"cross",diamond:"kite",square:"square",x:"x",triangle:"triangle",path:null};function uTe(t){return cTe[t]||(ne.getLogger(Fie).warn(`${t} cannot be mapped to Icon symbol. Fallback to "circle"`),"circle")}const ry=Wc;let Um=class extends An(ie){constructor(e){super(e),this.type="style",this.placement="begin-end",this.style="arrow",this.color=null}equals(e){return e!=null&&e.placement===this.placement&&e.style===this.style&&(this.color==null&&e.color==null||this.color!=null&&e.color!=null&&this.color.toJSON()===e.color.toJSON())}};h([p({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],Um.prototype,"type",void 0),h([p({type:RSe,json:{default:"begin-end",write:!0}})],Um.prototype,"placement",void 0),h([p({type:Cie,json:{default:"arrow",write:!0}})],Um.prototype,"style",void 0),h([p({type:ae,json:{type:[It],default:null,write:!0}})],Um.prototype,"color",void 0),Um=h([P("esri.symbols.LineStyleMarker3D")],Um);const E5=Um;var mM;let Jc=mM=class extends ju{constructor(t){super(t),this.material=null,this.type="line",this.join="miter",this.cap="butt",this.size=Tc(1),this.pattern=null,this.marker=null}clone(){const t={enabled:this.enabled,material:this.material!=null?this.material.clone():null,size:this.size,join:this.join,cap:this.cap,pattern:this.pattern!=null?this.pattern.clone():null,marker:this.marker!=null?this.marker.clone():null};return new mM(t)}static fromSimpleLineSymbol(t){var i;const e={enabled:!0,size:t.width??Tc(1),cap:t.cap||"butt",join:t.join||"miter",pattern:t.style&&t.style!=="inside-frame"?new iV({style:t.style}):null,material:new ba({color:(t.color||Nx).clone()}),marker:t.marker?new E5({placement:t.marker.placement,style:t.marker.style,color:((i=t.marker.color)==null?void 0:i.clone())??null}):null};return new mM(e)}};h([p({type:ba,json:{write:!0}})],Jc.prototype,"material",void 0),h([be({Line:"line"},{readOnly:!0})],Jc.prototype,"type",void 0),h([p({type:kie,json:{write:!0,default:"miter"}})],Jc.prototype,"join",void 0),h([p({type:rV,json:{write:!0,default:"butt"}})],Jc.prototype,"cap",void 0),h([p(ku)],Jc.prototype,"size",void 0),h([p(Pie)],Jc.prototype,"pattern",void 0),h([p({types:{key:"type",base:E5,typeMap:{style:E5}},json:{write:!0}})],Jc.prototype,"marker",void 0),Jc=mM=h([P("esri.symbols.LineSymbol3DLayer")],Jc);const ZS=Jc;var A5;const hTe=Nn()({sphere:"sphere",cylinder:"cylinder",cube:"cube",cone:"cone",diamond:"diamond",tetrahedron:"tetrahedron",invertedCone:"inverted-cone"});let Mw=A5=class extends ie{clone(){return new A5({href:this.href,primitive:this.primitive})}};h([p({type:String,json:{read:sV,write:Fy}})],Mw.prototype,"href",void 0),h([be(hTe)],Mw.prototype,"primitive",void 0),Mw=A5=h([P("esri.symbols.support.ObjectSymbol3DLayerResource")],Mw);const dTe="sphere";var $5;let Bg=$5=class extends ye{constructor(){super(...arguments),this.x=0,this.y=0,this.z=0}clone(){return new $5({x:this.x,y:this.y,z:this.z})}};h([p({type:Number})],Bg.prototype,"x",void 0),h([p({type:Number})],Bg.prototype,"y",void 0),h([p({type:Number})],Bg.prototype,"z",void 0),Bg=$5=h([P("esri.symbols.support.Symbol3DAnchorPosition3D")],Bg);var P5;let fs=P5=class extends ju{constructor(t){super(t),this.material=null,this.castShadows=!0,this.resource=null,this.type="object",this.width=void 0,this.height=void 0,this.depth=void 0,this.anchor=void 0,this.anchorPosition=void 0,this.heading=void 0,this.tilt=void 0,this.roll=void 0}clone(){return new P5({heading:this.heading,tilt:this.tilt,roll:this.roll,anchor:this.anchor,anchorPosition:this.anchorPosition&&this.anchorPosition.clone(),depth:this.depth,enabled:this.enabled,height:this.height,material:this.material!=null?this.material.clone():null,castShadows:this.castShadows,resource:this.resource&&this.resource.clone(),width:this.width})}get isPrimitive(){return!this.resource||typeof this.resource.href!="string"}};h([p({type:ba,json:{write:!0}})],fs.prototype,"material",void 0),h([p({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],fs.prototype,"castShadows",void 0),h([p({type:Mw,json:{write:!0}})],fs.prototype,"resource",void 0),h([be({Object:"object"},{readOnly:!0})],fs.prototype,"type",void 0),h([p({type:Number,json:{write:!0}})],fs.prototype,"width",void 0),h([p({type:Number,json:{write:!0}})],fs.prototype,"height",void 0),h([p({type:Number,json:{write:!0}})],fs.prototype,"depth",void 0),h([be({center:"center",top:"top",bottom:"bottom",origin:"origin",relative:"relative"}),p({json:{default:"origin"}})],fs.prototype,"anchor",void 0),h([p({type:Bg,json:{type:[Number],read:{reader:t=>new Bg({x:t[0],y:t[1],z:t[2]})},write:{writer:(t,e)=>{e.anchorPosition=[t.x,t.y,t.z]},overridePolicy(){return{enabled:this.anchor==="relative"}}}}})],fs.prototype,"anchorPosition",void 0),h([p({type:Number,json:{write:!0}})],fs.prototype,"heading",void 0),h([p({type:Number,json:{write:!0}})],fs.prototype,"tilt",void 0),h([p({type:Number,json:{write:!0}})],fs.prototype,"roll",void 0),h([p({readOnly:!0})],fs.prototype,"isPrimitive",null),fs=P5=h([P("esri.symbols.ObjectSymbol3DLayer")],fs);const oV=fs;var k5;let Hs=k5=class extends ju{constructor(t){super(t),this.material=null,this.castShadows=!0,this.type="path",this.profile="circle",this.join="miter",this.cap="butt",this.width=void 0,this.height=void 0,this.anchor="center",this.profileRotation="all"}readWidth(t,e){return t??(e.height==null&&e.size!=null?e.size:void 0)}readHeight(t,e){return t??(e.width==null&&e.size!=null?e.size:void 0)}clone(){return new k5({enabled:this.enabled,material:this.material!=null?this.material.clone():null,castShadows:this.castShadows,profile:this.profile,join:this.join,cap:this.cap,width:this.width,height:this.height,profileRotation:this.profileRotation,anchor:this.anchor})}};h([p({type:ba,json:{write:!0}})],Hs.prototype,"material",void 0),h([p({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],Hs.prototype,"castShadows",void 0),h([be({Path:"path"},{readOnly:!0})],Hs.prototype,"type",void 0),h([p({type:["circle","quad"],json:{write:!0,default:"circle"}})],Hs.prototype,"profile",void 0),h([p({type:kie,json:{write:!0,default:"miter"}})],Hs.prototype,"join",void 0),h([p({type:KSe,json:{write:!0,default:"butt"}})],Hs.prototype,"cap",void 0),h([p({type:Number,json:{write:{enabled:!0,target:{width:{type:Number},size:{type:Number}}}}})],Hs.prototype,"width",void 0),h([_e("width",["width","size","height"])],Hs.prototype,"readWidth",null),h([p({type:Number,json:{write:!0}})],Hs.prototype,"height",void 0),h([_e("height",["height","size","width"])],Hs.prototype,"readHeight",null),h([p({type:["center","bottom","top"],json:{write:!0,default:"center"}})],Hs.prototype,"anchor",void 0),h([p({type:["heading","all"],json:{write:!0,default:"all"}})],Hs.prototype,"profileRotation",void 0),Hs=k5=h([P("esri.symbols.PathSymbol3DLayer")],Hs);const aV=Hs;var O5;let c_=O5=class extends ie{constructor(){super(...arguments),this.color=new ae([0,0,0,1]),this.size=0}clone(){const t={color:q(this.color),size:this.size};return new O5(t)}};h([p(Zf)],c_.prototype,"color",void 0),h([p(ku)],c_.prototype,"size",void 0),c_=O5=h([P("esri.symbols.support.Symbol3DHalo")],c_);let zx=class extends An(ie){constructor(e){super(e),this.color=null}};h([p(Zf)],zx.prototype,"color",void 0),zx=h([P("esri.symbols.support.Symbol3DTextBackground")],zx);var gM;let go=gM=class extends ju{constructor(t){super(t),this._userSize=void 0,this.halo=null,this.horizontalAlignment="center",this.lineHeight=1,this.material=null,this.background=null,this.text=null,this.type="text",this.verticalAlignment="baseline"}get font(){return this._get("font")||null}set font(t){t!=null&&this._userSize!=null&&(t.size=this._userSize),this._set("font",t)}writeFont(t,e,i,n){const r={...n,textSymbol3D:!0};e.font=t.write({},r),delete e.font.size}get size(){return this._userSize!=null?this._userSize:this.font!=null&&this.font.size!=null?this.font.size:9}set size(t){this._userSize=t,this.font!=null&&(this.font.size=this._userSize),this.notifyChange("size")}clone(){const t=new gM({enabled:this.enabled,font:this.font&&q(this.font),halo:this.halo&&q(this.halo),horizontalAlignment:this.horizontalAlignment,lineHeight:this.lineHeight,material:this.material!=null?this.material.clone():null,text:this.text,verticalAlignment:this.verticalAlignment,background:q(this.background)});return t._userSize=this._userSize,t}static fromTextSymbol(t){return new gM({font:t.font!=null?t.font.clone():new gP,halo:pTe(t.haloColor,t.haloSize),horizontalAlignment:t.horizontalAlignment,lineHeight:t.lineHeight,material:t.color?new ba({color:t.color.clone()}):null,text:t.text,verticalAlignment:t.verticalAlignment,background:t.backgroundColor?new zx({color:t.backgroundColor.clone()}):null})}};function pTe(t,e){return t&&e!=null&&e>0?new c_({color:q(t),size:e}):null}h([p({type:gP,json:{write:!0}})],go.prototype,"font",null),h([ge("font")],go.prototype,"writeFont",null),h([p({type:c_,json:{write:!0}})],go.prototype,"halo",void 0),h([p({...Lie,json:{default:"center",write:!0}})],go.prototype,"horizontalAlignment",void 0),h([p({...Oie,json:{default:1,write:!0}})],go.prototype,"lineHeight",void 0),h([p({type:ba,json:{write:!0}})],go.prototype,"material",void 0),h([p({type:zx,json:{write:!0}})],go.prototype,"background",void 0),h([p(ku)],go.prototype,"size",null),h([p({type:String,json:{write:!0}})],go.prototype,"text",void 0),h([be({Text:"text"},{readOnly:!0})],go.prototype,"type",void 0),h([p({...Rie,json:{default:"baseline",write:!0}})],go.prototype,"verticalAlignment",void 0),go=gM=h([P("esri.symbols.TextSymbol3DLayer")],go);const Hb=go;var L5;let ep=L5=class extends ju{constructor(t){super(t),this.color=R5.clone(),this.type="water",this.waterbodySize="medium",this.waveDirection=null,this.waveStrength="moderate"}clone(){return new L5({color:q(this.color),waterbodySize:this.waterbodySize,waveDirection:this.waveDirection,waveStrength:this.waveStrength})}};h([p({type:ae,nonNullable:!0,json:{type:[It],write:(t,e,i)=>e[i]=t.toArray(ae.AlphaMode.UNLESS_OPAQUE),default:()=>R5.clone(),defaultEquals:t=>t.toCss(!0)===R5.toCss(!0)}})],ep.prototype,"color",void 0),h([be({Water:"water"},{readOnly:!0})],ep.prototype,"type",void 0),h([p({type:["small","medium","large"],json:{write:!0,default:"medium"}})],ep.prototype,"waterbodySize",void 0),h([p({type:Number,json:{write:!0,default:null}})],ep.prototype,"waveDirection",void 0),h([p({type:["calm","rippled","slight","moderate"],json:{write:!0,default:"moderate"}})],ep.prototype,"waveStrength",void 0),ep=L5=h([P("esri.symbols.WaterSymbol3DLayer")],ep);const R5=new ae([0,119,190]),zie=ep;var D5;let Gm=D5=class extends ye{constructor(t){super(t),this.name=null,this.styleUrl=null,this.styleName=null,this.portal=null}clone(){return new D5({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,portal:this.portal})}};h([p({type:String})],Gm.prototype,"name",void 0),h([p({type:String})],Gm.prototype,"styleUrl",void 0),h([p({type:String})],Gm.prototype,"styleName",void 0),h([p({type:nr})],Gm.prototype,"portal",void 0),Gm=D5=h([P("esri.symbols.support.StyleOrigin")],Gm);const V2=Gm;var N5;let gy=N5=class extends ye{constructor(){super(...arguments),this.url=""}clone(){return new N5({url:this.url})}};h([p({type:String})],gy.prototype,"url",void 0),gy=N5=h([P("esri.symbols.support.Thumbnail")],gy);const Vie={icon:ry,object:oV,line:ZS,path:aV,fill:Gb,extrude:Iie,text:Hb,water:zie},fTe=xe.ofType({base:ju,key:"type",typeMap:Vie,errorContext:"symbol-layer"});let Zc=class extends Go{constructor(e){super(e),this.styleOrigin=null,this.thumbnail=null,this.type=null;const i=this.__accessor__&&this.__accessor__.metadatas&&this.__accessor__.metadatas.symbolLayers,n=i&&i.type||xe;this._set("symbolLayers",new n)}get color(){return null}set color(e){this.constructed&&ne.getLogger(this).error("Symbol3D does not support colors on the symbol level. Colors may be set on individual symbol layer materials instead.")}set symbolLayers(e){Of(e,this._get("symbolLayers"))}readStyleOrigin(e,i,n){if(e.styleUrl&&e.name){const r=Rf(e.styleUrl,n);return new V2({styleUrl:r,name:e.name})}if(e.styleName&&e.name)return new V2({portal:n&&n.portal||nr.getDefault(),styleName:e.styleName,name:e.name});n&&n.messages&&n.messages.push(new fl("symbol3d:incomplete-style-origin","Style origin requires either a 'styleUrl' or 'styleName' and a 'name' property",{context:n,definition:e}))}writeStyleOrigin(e,i,n,r){if(e.styleUrl&&e.name){let s=JS(e.styleUrl,r);ya(s)&&(s=ll(s)),i.styleOrigin={styleUrl:s,name:e.name}}else e.styleName&&e.name&&(e.portal&&r&&r.portal&&!hQ(e.portal.restUrl,r.portal.restUrl)?r&&r.messages&&r.messages.push(new fl("symbol:cross-portal","The symbol style origin cannot be persisted because it refers to an item on a different portal than the one being saved to.",{symbol:this})):i.styleOrigin={styleName:e.styleName,name:e.name})}normalizeCtorArgs(e){return e instanceof ju||e&&Vie[e.type]?{symbolLayers:[e]}:Array.isArray(e)?{symbolLayers:e}:e}};h([p({json:{read:!1,write:!1}})],Zc.prototype,"color",null),h([p({type:fTe,nonNullable:!0,json:{write:!0}}),ut(QK)],Zc.prototype,"symbolLayers",null),h([p({type:V2})],Zc.prototype,"styleOrigin",void 0),h([_e("styleOrigin")],Zc.prototype,"readStyleOrigin",null),h([ge("styleOrigin",{"styleOrigin.styleUrl":{type:String},"styleOrigin.styleName":{type:String},"styleOrigin.name":{type:String}})],Zc.prototype,"writeStyleOrigin",null),h([p({type:gy,json:{read:!1}})],Zc.prototype,"thumbnail",void 0),h([p({type:["point-3d","line-3d","polygon-3d","mesh-3d","label-3d"],readOnly:!0})],Zc.prototype,"type",void 0),Zc=h([P("esri.symbols.Symbol3D")],Zc);const qb=Zc;let Ew=class extends ie{constructor(e){super(e),this.visible=!0}clone(){}};h([p({type:["line"],readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0}}})],Ew.prototype,"type",void 0),h([p({readOnly:!0})],Ew.prototype,"visible",void 0),Ew=h([P("esri.symbols.callouts.Callout3D")],Ew);const jie=Ew;var F5;let yM=F5=class extends ie{constructor(){super(...arguments),this.color=new ae("white")}clone(){return new F5({color:q(this.color)})}};h([p(Zf)],yM.prototype,"color",void 0),yM=F5=h([P("esri.symbols.callouts.LineCallout3DBorder")],yM);const Bie=yM;Object.freeze(Object.defineProperty({__proto__:null,default:Bie},Symbol.toStringTag,{value:"Module"}));var z5;let tp=z5=class extends jie{constructor(t){super(t),this.type="line",this.color=new ae([0,0,0,1]),this.size=Tc(1),this.border=null}get visible(){return this.size>0&&this.color!=null&&this.color.a>0}clone(){return new z5({color:q(this.color),size:this.size,border:q(this.border)})}};h([be({line:"line"},{readOnly:!0})],tp.prototype,"type",void 0),h([p(Zf)],tp.prototype,"color",void 0),h([p(ku)],tp.prototype,"size",void 0),h([p({type:Bie,json:{write:!0}})],tp.prototype,"border",void 0),h([p({readOnly:!0})],tp.prototype,"visible",null),tp=z5=h([P("esri.symbols.callouts.LineCallout3D")],tp);const mTe=tp;function lV(t){if(!t)return!1;const e=t.verticalOffset;return!!e&&!(e.screenLength<=0||e.maxWorldLength!=null&&e.maxWorldLength<=0)}function Uie(t){if(!t||!t.supportsCallout||!t.supportsCallout())return!1;const e=t.callout;return!!e&&!!e.visible&&!!lV(t)}function _ct(t){return t.type==="point-3d"||t.type==="label-3d"}function bct(t){return t.horizontalAlignment==="center"}const Gie={types:{key:"type",base:jie,typeMap:{line:mTe}},json:{write:!0}};var V5;let pv=V5=class extends ie{constructor(t){super(t),this.screenLength=0,this.minWorldLength=0,this.maxWorldLength=null}clone(){return new V5({screenLength:this.screenLength,minWorldLength:this.minWorldLength,maxWorldLength:this.maxWorldLength})}};h([p(ku)],pv.prototype,"screenLength",void 0),h([p({type:Number,nonNullable:!0,json:{write:!0,default:0}})],pv.prototype,"minWorldLength",void 0),h([p({type:Number,json:{write:!0}})],pv.prototype,"maxWorldLength",void 0),pv=V5=h([P("esri.symbols.support.Symbol3DVerticalOffset")],pv);const Hie=pv;var vM;const qie=xe.ofType({base:null,key:"type",typeMap:{text:Hb}});let ip=vM=class extends qb{constructor(t){super(t),this.verticalOffset=null,this.callout=null,this.styleOrigin=null,this.symbolLayers=new qie,this.type="label-3d"}supportsCallout(){return!0}hasVisibleCallout(){return Uie(this)}hasVisibleVerticalOffset(){return lV(this)}clone(){return new vM({styleOrigin:q(this.styleOrigin),symbolLayers:q(this.symbolLayers),thumbnail:q(this.thumbnail),callout:q(this.callout),verticalOffset:q(this.verticalOffset)})}static fromTextSymbol(t){return new vM({symbolLayers:[Hb.fromTextSymbol(t)]})}};h([p({type:Hie,json:{write:!0}})],ip.prototype,"verticalOffset",void 0),h([p(Gie)],ip.prototype,"callout",void 0),h([p({json:{read:!1,write:!1}})],ip.prototype,"styleOrigin",void 0),h([p({type:qie})],ip.prototype,"symbolLayers",void 0),h([be({LabelSymbol3D:"label-3d"},{readOnly:!0})],ip.prototype,"type",void 0),ip=vM=h([P("esri.symbols.LabelSymbol3D")],ip);const yP=ip;var _M;const Wie=xe.ofType({base:null,key:"type",typeMap:{line:ZS,path:aV}}),gTe=xe.ofType({base:null,key:"type",typeMap:{line:ZS,path:aV}});let Aw=_M=class extends qb{constructor(t){super(t),this.symbolLayers=new Wie,this.type="line-3d"}clone(){return new _M({styleOrigin:q(this.styleOrigin),symbolLayers:q(this.symbolLayers),thumbnail:q(this.thumbnail)})}static fromSimpleLineSymbol(t){return new _M({symbolLayers:[ZS.fromSimpleLineSymbol(t)]})}};h([p({type:Wie,json:{type:gTe}})],Aw.prototype,"symbolLayers",void 0),h([be({LineSymbol3D:"line-3d"},{readOnly:!0})],Aw.prototype,"type",void 0),Aw=_M=h([P("esri.symbols.LineSymbol3D")],Aw);const vP=Aw;let np=class extends Go{constructor(e){super(e),this.angle=0,this.type=null,this.xoffset=0,this.yoffset=0,this.size=9}hash(){return`${this.type}.${this.angle}.${this.size}.${this.xoffset}.${this.yoffset}`}};h([p({type:Number,json:{read:t=>t&&-1*t,write:(t,e)=>e.angle=t&&-1*t}})],np.prototype,"angle",void 0),h([p({type:["simple-marker","picture-marker"],readOnly:!0})],np.prototype,"type",void 0),h([p({type:Number,cast:vt,json:{write:!0}})],np.prototype,"xoffset",void 0),h([p({type:Number,cast:vt,json:{write:!0}})],np.prototype,"yoffset",void 0),h([p({type:Number,cast:t=>t==="auto"?t:vt(t),json:{write:!0}})],np.prototype,"size",void 0),np=h([P("esri.symbols.MarkerSymbol")],np);const Jie=np;var bM;const Zie=xe.ofType({base:null,key:"type",typeMap:{fill:Gb}});let $w=bM=class extends qb{constructor(t){super(t),this.symbolLayers=new Zie,this.type="mesh-3d"}clone(){return new bM({styleOrigin:q(this.styleOrigin),symbolLayers:q(this.symbolLayers),thumbnail:q(this.thumbnail)})}static fromSimpleFillSymbol(t){return new bM({symbolLayers:[Gb.fromSimpleFillSymbol(t)]})}};h([p({type:Zie})],$w.prototype,"symbolLayers",void 0),h([be({MeshSymbol3D:"mesh-3d"},{readOnly:!0})],$w.prototype,"type",void 0),$w=bM=h([P("esri.symbols.MeshSymbol3D")],$w);const YS=$w;function yTe(t,e,i){return e.imageData?pQ({mediaType:e.contentType||"image/png",isBase64:!0,data:e.imageData}):Yie(e.url,i)}function Yie(t,e){var i;return _Te(e)&&!ya(t)&&((i=e==null?void 0:e.layer)!=null&&i.parsedUrl)?tP(e.layer.parsedUrl.path,"images",t):Rf(t,e)}function vTe(t,e,i,n){if(n0(t)){const r=E2(t);if(!r)return;e.contentType=r.mediaType,e.imageData=r.data,i&&i.imageData===e.imageData&&i.url&&Fy(i.url,e,"url",n)}else Fy(t,e,"url",n)}const Xie={json:{read:{source:["imageData","url"],reader:yTe},write:{writer(t,e,i,n){vTe(t,e,this.source,n)}}}},Kie={readOnly:!0,json:{read:{source:["imageData","url"],reader(t,e,i){const n={};return e.imageData&&(n.imageData=e.imageData),e.contentType&&(n.contentType=e.contentType),e.url&&(n.url=Yie(e.url,i)),n}}}};function _Te(t){var e,i;return!(t==null||t.origin!=="service"&&t.origin!=="portal-item"||((e=t.layer)==null?void 0:e.type)!=="feature"&&((i=t.layer)==null?void 0:i.type)!=="stream")}var j5;let Fa=j5=class extends Mie{constructor(...t){super(...t),this.type="picture-fill",this.url=null,this.xscale=1,this.yscale=1,this.width=12,this.height=12,this.xoffset=0,this.yoffset=0,this.source=null}normalizeCtorArgs(t,e,i,n){if(t&&typeof t!="string"&&t.imageData==null)return t;const r={};return t&&(r.url=t),e&&(r.outline=e),i!=null&&(r.width=vt(i)),n!=null&&(r.height=vt(n)),r}clone(){const t=new j5({color:q(this.color),height:this.height,outline:this.outline&&this.outline.clone(),url:this.url,width:this.width,xoffset:this.xoffset,xscale:this.xscale,yoffset:this.yoffset,yscale:this.yscale});return t._set("source",q(this.source)),t}hash(){var t;return`${super.hash()}.${(t=this.color)==null?void 0:t.hash()}.${this.height}.${this.url}.${this.width}.${this.xoffset}.${this.xscale}.${this.yoffset}.${this.yscale}`}};h([be({esriPFS:"picture-fill"},{readOnly:!0})],Fa.prototype,"type",void 0),h([p(Xie)],Fa.prototype,"url",void 0),h([p({type:Number,json:{write:!0}})],Fa.prototype,"xscale",void 0),h([p({type:Number,json:{write:!0}})],Fa.prototype,"yscale",void 0),h([p({type:Number,cast:vt,json:{write:!0}})],Fa.prototype,"width",void 0),h([p({type:Number,cast:vt,json:{write:!0}})],Fa.prototype,"height",void 0),h([p({type:Number,cast:vt,json:{write:!0}})],Fa.prototype,"xoffset",void 0),h([p({type:Number,cast:vt,json:{write:!0}})],Fa.prototype,"yoffset",void 0),h([p(Kie)],Fa.prototype,"source",void 0),Fa=j5=h([P("esri.symbols.PictureFillSymbol")],Fa);const Qie=Fa;var B5;let zl=B5=class extends Jie{constructor(...t){super(...t),this.color=null,this.type="picture-marker",this.url=null,this.source=null,this.height=12,this.width=12,this.size=null}normalizeCtorArgs(t,e,i){if(t&&typeof t!="string"&&t.imageData==null)return t;const n={};return t&&(n.url=t),e!=null&&(n.width=vt(e)),i!=null&&(n.height=vt(i)),n}readHeight(t,e){return e.size||t}readWidth(t,e){return e.size||t}clone(){const t=new B5({angle:this.angle,height:this.height,url:this.url,width:this.width,xoffset:this.xoffset,yoffset:this.yoffset});return t._set("source",q(this.source)),t}hash(){return`${super.hash()}.${this.height}.${this.url}.${this.width}`}};h([p({json:{write:!1}})],zl.prototype,"color",void 0),h([be({esriPMS:"picture-marker"},{readOnly:!0})],zl.prototype,"type",void 0),h([p(Xie)],zl.prototype,"url",void 0),h([p(Kie)],zl.prototype,"source",void 0),h([p({type:Number,cast:vt,json:{write:!0}})],zl.prototype,"height",void 0),h([_e("height",["height","size"])],zl.prototype,"readHeight",null),h([p({type:Number,cast:vt,json:{write:!0}})],zl.prototype,"width",void 0),h([p({json:{write:!1}})],zl.prototype,"size",void 0),zl=B5=h([P("esri.symbols.PictureMarkerSymbol")],zl);const Mf=zl;var Hm;const ene=xe.ofType({base:null,key:"type",typeMap:{icon:ry,object:oV,text:Hb}});let qm=Hm=class extends qb{constructor(t){super(t),this.verticalOffset=null,this.callout=null,this.symbolLayers=new ene,this.type="point-3d"}supportsCallout(){if((this.symbolLayers?this.symbolLayers.length:0)<1)return!1;for(const t of this.symbolLayers.items)switch(t.type){case"icon":case"text":case"object":continue;default:return!1}return!0}hasVisibleCallout(){return Uie(this)}hasVisibleVerticalOffset(){return lV(this)}clone(){return new Hm({verticalOffset:q(this.verticalOffset),callout:q(this.callout),styleOrigin:q(this.styleOrigin),symbolLayers:q(this.symbolLayers),thumbnail:q(this.thumbnail)})}static fromSimpleMarkerSymbol(t){return new Hm({symbolLayers:[ry.fromSimpleMarkerSymbol(t)]})}static fromPictureMarkerSymbol(t){return new Hm({symbolLayers:[ry.fromPictureMarkerSymbol(t)]})}static fromCIMSymbol(t){var n,r;if(((r=(n=t.data)==null?void 0:n.symbol)==null?void 0:r.type)!=="CIMPointSymbol")return null;const i=t.data.symbol;return new Hm(i!=null&&i.callout?{symbolLayers:[ry.fromCIMSymbol(t)],callout:{type:"line",size:.5,color:[0,0,0]},verticalOffset:{screenLength:40}}:{symbolLayers:[ry.fromCIMSymbol(t)]})}static fromTextSymbol(t){return new Hm({symbolLayers:[Hb.fromTextSymbol(t)]})}};h([p({type:Hie,json:{write:!0}})],qm.prototype,"verticalOffset",void 0),h([p(Gie)],qm.prototype,"callout",void 0),h([p({type:ene,json:{origins:{"web-scene":{write:!0}}}})],qm.prototype,"symbolLayers",void 0),h([be({PointSymbol3D:"point-3d"},{readOnly:!0})],qm.prototype,"type",void 0),qm=Hm=h([P("esri.symbols.PointSymbol3D")],qm);const sy=qm;var Pw;const tne=xe.ofType({base:null,key:"type",typeMap:{extrude:Iie,fill:Gb,icon:ry,line:ZS,object:oV,text:Hb,water:zie}});let kw=Pw=class extends qb{constructor(t){super(t),this.symbolLayers=new tne,this.type="polygon-3d"}clone(){return new Pw({styleOrigin:q(this.styleOrigin),symbolLayers:q(this.symbolLayers),thumbnail:q(this.thumbnail)})}static fromJSON(t){const e=new Pw;if(e.read(t),e.symbolLayers.length===2&&e.symbolLayers.at(0).type==="fill"&&e.symbolLayers.at(1).type==="line"){const i=e.symbolLayers.at(0),n=e.symbolLayers.at(1);!n.enabled||t.symbolLayers&&t.symbolLayers[1]&&t.symbolLayers[1].enable===!1||(i.outline={size:n.size,color:n.material!=null?n.material.color:null}),e.symbolLayers.removeAt(1)}return e}static fromSimpleFillSymbol(t){return new Pw({symbolLayers:[Gb.fromSimpleFillSymbol(t)]})}};h([p({type:tne,json:{write:!0}})],kw.prototype,"symbolLayers",void 0),h([be({PolygonSymbol3D:"polygon-3d"},{readOnly:!0})],kw.prototype,"type",void 0),kw=Pw=h([P("esri.symbols.PolygonSymbol3D")],kw);const XS=kw;var U5;const M3=new qe({esriSFSSolid:"solid",esriSFSNull:"none",esriSFSHorizontal:"horizontal",esriSFSVertical:"vertical",esriSFSForwardDiagonal:"forward-diagonal",esriSFSBackwardDiagonal:"backward-diagonal",esriSFSCross:"cross",esriSFSDiagonalCross:"diagonal-cross"});let Wm=U5=class extends Mie{constructor(...t){super(...t),this.color=new ae([0,0,0,.25]),this.outline=new Ur,this.type="simple-fill",this.style="solid"}normalizeCtorArgs(t,e,i){if(t&&typeof t!="string")return t;const n={};return t&&(n.style=t),e&&(n.outline=e),i&&(n.color=i),n}clone(){return new U5({color:q(this.color),outline:this.outline&&this.outline.clone(),style:this.style})}hash(){return`${super.hash()}${this.style}.${this.color&&this.color.hash()}`}};h([p()],Wm.prototype,"color",void 0),h([p()],Wm.prototype,"outline",void 0),h([be({esriSFS:"simple-fill"},{readOnly:!0})],Wm.prototype,"type",void 0),h([p({type:M3.apiValues,json:{read:M3.read,write:M3.write}})],Wm.prototype,"style",void 0),Wm=U5=h([P("esri.symbols.SimpleFillSymbol")],Wm);const Pc=Wm;var G5;const E3=new qe({esriSMSCircle:"circle",esriSMSSquare:"square",esriSMSCross:"cross",esriSMSX:"x",esriSMSDiamond:"diamond",esriSMSTriangle:"triangle",esriSMSPath:"path"});let Yc=G5=class extends Jie{constructor(...t){super(...t),this.color=new ae([255,255,255,.25]),this.type="simple-marker",this.size=12,this.style="circle",this.outline=new Ur}normalizeCtorArgs(t,e,i,n){if(t&&typeof t!="string")return t;const r={};return t&&(r.style=t),e!=null&&(r.size=vt(e)),i&&(r.outline=i),n&&(r.color=n),r}writeColor(t,e){t&&this.style!=="x"&&this.style!=="cross"&&(e.color=t.toJSON()),t===null&&(e.color=null)}set path(t){this.style="path",this._set("path",t)}clone(){return new G5({angle:this.angle,color:q(this.color),outline:this.outline&&this.outline.clone(),path:this.path,size:this.size,style:this.style,xoffset:this.xoffset,yoffset:this.yoffset})}hash(){var t;return`${super.hash()}.${this.color&&this.color.hash()}.${this.path}.${this.style}.${(t=this.outline)==null?void 0:t.hash()}`}};h([p()],Yc.prototype,"color",void 0),h([ge("color")],Yc.prototype,"writeColor",null),h([be({esriSMS:"simple-marker"},{readOnly:!0})],Yc.prototype,"type",void 0),h([p()],Yc.prototype,"size",void 0),h([p({type:E3.apiValues,json:{read:E3.read,write:E3.write}})],Yc.prototype,"style",void 0),h([p({type:String,json:{write:!0}})],Yc.prototype,"path",null),h([p({types:{key:"type",base:null,defaultKeyValue:"simple-line",typeMap:{"simple-line":Ur}},json:{default:null,write:!0}})],Yc.prototype,"outline",void 0),Yc=G5=h([P("esri.symbols.SimpleMarkerSymbol")],Yc);const rs=Yc;var H5;let Vi=H5=class extends Go{constructor(...t){super(...t),this.backgroundColor=null,this.borderLineColor=null,this.borderLineSize=null,this.font=new gP,this.horizontalAlignment="center",this.kerning=!0,this.haloColor=null,this.haloSize=null,this.rightToLeft=null,this.rotated=!1,this.text="",this.type="text",this.verticalAlignment="baseline",this.xoffset=0,this.yoffset=0,this.angle=0,this.width=null,this.lineWidth=192,this.lineHeight=1}normalizeCtorArgs(t,e,i){if(t&&typeof t!="string")return t;const n={};return t&&(n.text=t),e&&(n.font=e),i&&(n.color=i),n}writeLineWidth(t,e,i,n){n&&typeof n!="string"?n.origin:e[i]=t}castLineWidth(t){return vt(t)}writeLineHeight(t,e,i,n){n&&typeof n!="string"?n.origin:e[i]=t}clone(){return new H5({angle:this.angle,backgroundColor:q(this.backgroundColor),borderLineColor:q(this.borderLineColor),borderLineSize:this.borderLineSize,color:q(this.color),font:this.font&&this.font.clone(),haloColor:q(this.haloColor),haloSize:this.haloSize,horizontalAlignment:this.horizontalAlignment,kerning:this.kerning,lineHeight:this.lineHeight,lineWidth:this.lineWidth,rightToLeft:this.rightToLeft,rotated:this.rotated,text:this.text,verticalAlignment:this.verticalAlignment,width:this.width,xoffset:this.xoffset,yoffset:this.yoffset})}hash(){var t;return`${this.backgroundColor&&this.backgroundColor.hash()}.${this.borderLineColor}.${this.borderLineSize}.${(t=this.color)==null?void 0:t.hash()}.${this.font&&this.font.hash()}.${this.haloColor&&this.haloColor.hash()}.${this.haloSize}.${this.horizontalAlignment}.${this.kerning}.${this.rightToLeft}.${this.rotated}.${this.text}.${this.verticalAlignment}.${this.width}.${this.xoffset}.${this.yoffset}.${this.lineHeight}.${this.lineWidth}.${this.angle}`}};h([p({type:ae,json:{write:!0}})],Vi.prototype,"backgroundColor",void 0),h([p({type:ae,json:{write:!0}})],Vi.prototype,"borderLineColor",void 0),h([p({type:Number,json:{write:!0},cast:vt})],Vi.prototype,"borderLineSize",void 0),h([p({type:gP,json:{write:!0}})],Vi.prototype,"font",void 0),h([p({...Lie,json:{write:!0}})],Vi.prototype,"horizontalAlignment",void 0),h([p({type:Boolean,json:{write:!0}})],Vi.prototype,"kerning",void 0),h([p({type:ae,json:{write:!0}})],Vi.prototype,"haloColor",void 0),h([p({type:Number,cast:vt,json:{write:!0}})],Vi.prototype,"haloSize",void 0),h([p({type:Boolean,json:{write:!0}})],Vi.prototype,"rightToLeft",void 0),h([p({type:Boolean,json:{write:!0}})],Vi.prototype,"rotated",void 0),h([p({type:String,json:{write:!0}})],Vi.prototype,"text",void 0),h([be({esriTS:"text"},{readOnly:!0})],Vi.prototype,"type",void 0),h([p({...Rie,json:{write:!0}})],Vi.prototype,"verticalAlignment",void 0),h([p({type:Number,cast:vt,json:{write:!0}})],Vi.prototype,"xoffset",void 0),h([p({type:Number,cast:vt,json:{write:!0}})],Vi.prototype,"yoffset",void 0),h([p({type:Number,json:{read:t=>t&&-1*t,write:(t,e)=>e.angle=t&&-1*t}})],Vi.prototype,"angle",void 0),h([p({type:Number,json:{write:!0}})],Vi.prototype,"width",void 0),h([p({type:Number})],Vi.prototype,"lineWidth",void 0),h([ge("lineWidth")],Vi.prototype,"writeLineWidth",null),h([ut("lineWidth")],Vi.prototype,"castLineWidth",null),h([p(Oie)],Vi.prototype,"lineHeight",void 0),h([ge("lineHeight")],Vi.prototype,"writeLineHeight",null),Vi=H5=h([P("esri.symbols.TextSymbol")],Vi);const o0=Vi;var q5;let Vl=q5=class extends Go{constructor(t){super(t),this.styleName=null,this.portal=null,this.styleUrl=null,this.thumbnail=null,this.name=null,this.type="web-style"}get _fetchCacheKey(){const t=this.portal!=null?this.portal:nr.getDefault(),e=t.user?t.user.username:null;return`${this.styleName}:${this.styleUrl}:${this.name}:${e}:${t.url}`}read(t,e){this.portal=e==null?void 0:e.portal,super.read(t,e)}clone(){return new q5({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,portal:this.portal})}fetchSymbol(t){return this._fetchSymbol("webRef",t)}fetchCIMSymbol(t){return this._fetchSymbol("cimRef",t)}async _fetchSymbol(t,e){const i=e!=null?e.cache:null,n=i?this._fetchCacheKey:null;if(i!=null){const a=n&&i.get(n);if(a)return a.clone()}const{resolveWebStyleSymbol:r}=await Y(()=>Promise.resolve().then(()=>BGe),void 0,import.meta.url);Vt(e);const s=r(this,{portal:this.portal},t,e);s.catch(a=>{ne.getLogger(this).error("#fetchSymbol()","Failed to create symbol from style",a)});const o=await s;return t==="webRef"&&o.type==="point-3d"||t==="cimRef"&&o.type==="cim"?(i!=null&&i.set(n,o.clone()),o):null}};h([p({json:{write:!1}})],Vl.prototype,"color",void 0),h([p({type:String,json:{write:!0}})],Vl.prototype,"styleName",void 0),h([p({type:nr,json:{write:!1}})],Vl.prototype,"portal",void 0),h([p({type:String,json:{read:sV,write:Fy}})],Vl.prototype,"styleUrl",void 0),h([p({type:gy,json:{read:!1}})],Vl.prototype,"thumbnail",void 0),h([p({type:String,json:{write:!0}})],Vl.prototype,"name",void 0),h([be({styleSymbolReference:"web-style"},{readOnly:!0})],Vl.prototype,"type",void 0),h([p()],Vl.prototype,"_fetchCacheKey",null),Vl=q5=h([P("esri.symbols.WebStyleSymbol")],Vl);const a0=Vl;function _P(t){if(!t)return!1;switch(t.type){case"picture-fill":case"picture-marker":case"simple-fill":case"simple-line":case"simple-marker":case"text":case"cim":return!0;default:return!1}}function Ou(t){if(!t)return!1;switch(t.type){case"label-3d":case"line-3d":case"mesh-3d":case"point-3d":case"polygon-3d":return!0;default:return!1}}const Su={base:Go,key:"type",typeMap:{"simple-fill":Pc,"picture-fill":Qie,"picture-marker":Mf,"simple-line":Ur,"simple-marker":rs,text:o0,"label-3d":yP,"line-3d":vP,"mesh-3d":YS,"point-3d":sy,"polygon-3d":XS,"web-style":a0,cim:Ub},errorContext:"symbol"},bTe={base:Go,key:"type",typeMap:{"picture-marker":Mf,"simple-marker":rs,text:o0,"web-style":a0,cim:Ub},errorContext:"symbol"},wTe=Ob({types:Su}),ine={base:Go,key:"type",typeMap:{"simple-fill":Pc,"picture-fill":Qie,"picture-marker":Mf,"simple-line":Ur,"simple-marker":rs,text:o0,"line-3d":vP,"mesh-3d":YS,"point-3d":sy,"polygon-3d":XS,"web-style":a0,cim:Ub},errorContext:"symbol"},xTe={base:Go,key:"type",typeMap:{text:o0,"label-3d":yP},errorContext:"symbol"},TU={base:Go,key:"type",typeMap:{"line-3d":vP,"mesh-3d":YS,"point-3d":sy,"polygon-3d":XS,"web-style":a0,cim:Ub},errorContext:"symbol"},STe={base:Go,key:"type",typeMap:{"label-3d":yP},errorContext:"symbol"},nne=nd(Su);var W5;function TTe(t){if(!t)return null;const e={};for(const i in t){const n=ad(t[i]);n&&(e[i]=n)}return Object.keys(e).length!==0?e:null}function ITe(t){if(t==null)return null;const e={};for(const i in t){const n=t[i];n&&(e[i]=n.toJSON())}return Object.keys(e).length!==0?e:null}let yo=W5=class extends An(ie){constructor(...t){super(...t),this.isAggregate=!1,this.layer=null,this.popupTemplate=null,this.sourceLayer=null,Object.defineProperty(this,"uid",{value:T_(),configurable:!0})}normalizeCtorArgs(t,e,i,n){return t&&!t.declaredClass?t:{geometry:t,symbol:e,attributes:i,popupTemplate:n}}set aggregateGeometries(t){const e=this._get("aggregateGeometries");JSON.stringify(e)!==JSON.stringify(t)&&this._set("aggregateGeometries",t)}set attributes(t){const e=this._get("attributes");e!==t&&(this._set("attributes",t),this._notifyLayer("attributes",e,t))}set geometry(t){const e=this._get("geometry");e!==t&&(this._set("geometry",t),this._notifyLayer("geometry",e,t))}set symbol(t){const e=this._get("symbol");e!==t&&(this._set("symbol",t),this._notifyLayer("symbol",e,t))}set visible(t){const e=this._get("visible");e!==t&&(this._set("visible",t),this._notifyLayer("visible",e,t))}cloneShallow(){return new W5({aggregateGeometries:this.aggregateGeometries,attributes:this.attributes,geometry:this.geometry,isAggregate:this.isAggregate,layer:this.layer,popupTemplate:this.popupTemplate,sourceLayer:this.sourceLayer,symbol:this.symbol,visible:this.visible})}getEffectivePopupTemplate(t=!1){if(this.popupTemplate)return this.popupTemplate;for(const e of[this.sourceLayer,this.layer])if(e){if("popupTemplate"in e&&e.popupTemplate)return e.popupTemplate;if(t&&"defaultPopupTemplate"in e&&e.defaultPopupTemplate!=null)return e.defaultPopupTemplate}return null}getAttribute(t){var e;return(e=this.attributes)==null?void 0:e[t]}setAttribute(t,e){if(this.attributes){const i=this.getAttribute(t);this.attributes[t]=e,this._notifyLayer("attributes",i,e,t)}else this.attributes={[t]:e},this._notifyLayer("attributes",void 0,e,t)}getObjectId(){return this.sourceLayer&&"objectIdField"in this.sourceLayer&&this.sourceLayer.objectIdField?this.getAttribute(this.sourceLayer.objectIdField):null}toJSON(){return{aggregateGeometries:ITe(this.aggregateGeometries),geometry:this.geometry!=null?this.geometry.toJSON():null,symbol:this.symbol!=null?this.symbol.toJSON():null,attributes:{...this.attributes},popupTemplate:this.popupTemplate&&this.popupTemplate.toJSON()}}notifyGeometryChanged(){this._notifyLayer("geometry",this.geometry,this.geometry)}notifyMeshTransformChanged(t={}){const{geometry:e}=this;if((e==null?void 0:e.type)==="mesh"){const i={origin:e.origin,transform:e.transform};this._notifyLayer("origin-transform",i,i,t.action)}}_notifyLayer(t,e,i,n){if(!this.layer||!("graphicChanged"in this.layer))return;const r={graphic:this,property:t,oldValue:e,newValue:i};t==="origin-transform"&&(r.action=n),t==="attributes"&&(r.attributeName=n),this.layer.graphicChanged(r)}};h([p({value:null,json:{read:TTe}})],yo.prototype,"aggregateGeometries",null),h([p({value:null})],yo.prototype,"attributes",null),h([p({value:null,types:r0,json:{read:ad}})],yo.prototype,"geometry",null),h([p({type:Boolean})],yo.prototype,"isAggregate",void 0),h([p({clonable:"reference"})],yo.prototype,"layer",void 0),h([p({type:Jf})],yo.prototype,"popupTemplate",void 0),h([p({clonable:"reference"})],yo.prototype,"sourceLayer",void 0),h([p({value:null,types:Su})],yo.prototype,"symbol",null),h([p({type:Boolean,value:!0})],yo.prototype,"visible",null),yo=W5=h([P("esri.Graphic")],yo),function(t){t.generateUID=T_}(yo||(yo={}));const Vo=yo;let cV=class{constructor(e,i){this.min=e,this.max=i,this.range=i-e}ndiff(e,i=0){return Math.ceil((e-i)/this.range)*this.range+i}_normalize(e,i,n,r=0,s=!1){return(n-=r)<e?n+=this.ndiff(e-n):n>i&&(n-=this.ndiff(n-i)),s&&n===i&&(n=e),n+r}normalize(e,i=0,n=!1){return this._normalize(this.min,this.max,e,i,n)}clamp(e,i=0){return rr(e-i,this.min,this.max)+i}monotonic(e,i,n){return e<i?i:i+this.ndiff(e-i,n)}minimalMonotonic(e,i,n){return this._normalize(e,e+this.range,i,n)}center(e,i,n){return i=this.monotonic(e,i,n),this.normalize((e+i)/2,n)}diff(e,i,n){return this.monotonic(e,i,n)-e}shortestSignedDiff(e,i){e=this.normalize(e);const n=(i=this.normalize(i))-e,r=i<e?this.minimalMonotonic(e,i)-e:i-this.minimalMonotonic(i,e);return Math.abs(n)<Math.abs(r)?n:r}contains(e,i,n){return i=this.minimalMonotonic(e,i),(n=this.minimalMonotonic(e,n))>e&&n<i}};function uV(t){for(const e in t){const i=t[e];i instanceof Function&&(t[e]=i.bind(t))}return t}uV(new cV(0,2*Math.PI));const Sct=uV(new cV(-Math.PI,Math.PI)),rne=uV(new cV(0,360));let lh=class extends An(ie){constructor(...e){super(...e),this.position=new pe([0,0,0]),this.heading=0,this.tilt=0,this.fov=55}normalizeCtorArgs(e,i,n,r){if(e&&typeof e=="object"&&("x"in e||Array.isArray(e))){const s={position:e};return i!=null&&(s.heading=i),n!=null&&(s.tilt=n),r!=null&&(s.fov=r),s}return e}writePosition(e,i,n,r){const s=e.clone();s.x=Qa(e.x||0),s.y=Qa(e.y||0),s.z=e.hasZ?Qa(e.z||0):e.z,i[n]=s.write({},r)}readPosition(e,i){const n=new pe;return n.read(e,i),n.x=Qa(n.x||0),n.y=Qa(n.y||0),n.z=n.hasZ?Qa(n.z||0):n.z,n}equals(e){return e!=null&&this.tilt===e.tilt&&this.heading===e.heading&&this.fov===e.fov&&this.position.equals(e.position)}};h([p({type:pe,json:{write:{isRequired:!0}}})],lh.prototype,"position",void 0),h([ge("position")],lh.prototype,"writePosition",null),h([_e("position")],lh.prototype,"readPosition",null),h([p({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),ut(t=>rne.normalize(Qa(t)))],lh.prototype,"heading",void 0),h([p({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),ut(t=>rr(Qa(t),-180,180))],lh.prototype,"tilt",void 0),h([p({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],lh.prototype,"fov",void 0),lh=h([P("esri.Camera")],lh);const CTe=lh;var J5;let rp=J5=class extends ie{constructor(t){super(t),this.rotation=0,this.scale=0,this.targetGeometry=null,this.camera=null}castRotation(t){return(t%=360)<0&&(t+=360),t}clone(){return new J5({rotation:this.rotation,scale:this.scale,targetGeometry:this.targetGeometry!=null?this.targetGeometry.clone():null,camera:this.camera!=null?this.camera.clone():null})}};function A3(){return{enabled:!this.camera}}h([p({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:A3}}}}})],rp.prototype,"rotation",void 0),h([ut("rotation")],rp.prototype,"castRotation",null),h([p({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:A3}}}}})],rp.prototype,"scale",void 0),h([p({types:r0,json:{read:ad,write:!0,origins:{"web-scene":{read:ad,write:{overridePolicy:A3}}}}})],rp.prototype,"targetGeometry",void 0),h([p({type:CTe,json:{write:!0}})],rp.prototype,"camera",void 0),rp=J5=h([P("esri.Viewpoint")],rp);const Cu=rp;function Q(t,e,i={}){return hV(t,e,i,one)}function jo(t,e,i={}){return hV(t,e,i,ane)}function hV(t,e,i={},n){let r=null;const s=i.once?(o,a)=>{n(o)&&(Ri(r),e(o,a))}:(o,a)=>{n(o)&&e(o,a)};if(r=Hye(t,s,i.sync,i.equals),i.initial){const o=t();s(o,o)}return r}function on(t,e,i,n={}){let r=null,s=null,o=null;function a(){var u;r&&s&&(s.remove(),(u=n.onListenerRemove)==null||u.call(n,r),r=null,s=null)}function l(u){n.once&&n.once&&Ri(o),i(u)}const c=Q(t,(u,d)=>{var f;a(),q$(u)&&(r=u,s=Lh(u,e,l),(f=n.onListenerAdd)==null||f.call(n,u))},{sync:n.sync,initial:!0});return o=br(()=>{c.remove(),a()}),o}function MTe(t,e){return sne(t,null,e)}function Lu(t,e){return sne(t,ane,e)}function sne(t,e,i){if(zo(i))return Promise.reject(li());const n=t();if(e!=null&&e(n))return Promise.resolve(n);let r=null;function s(){r=Ri(r)}return new Promise((o,a)=>{r=$c([Ro(i,()=>{s(),a(li())}),hV(t,l=>{s(),o(l)},{sync:!1,once:!0},e??one)])})}function one(t){return!0}function ane(t){return!!t}function lne(t,e,i={}){let n=!1;const r=Q(t,(s,o)=>{n||e(s,o)},i);return{remove(){r.remove()},pause(){n=!0},resume(){n=!1}}}const ml={sync:!0},He={initial:!0},Oi={sync:!0,initial:!0},cne=Object.freeze(Object.defineProperty({__proto__:null,autorun:Vz,initial:He,on,once:MTe,pausable:lne,sync:ml,syncAndInitial:Oi,watch:Q,when:jo,whenOnce:Lu},Symbol.toStringTag,{value:"Module"}));let hA=class{constructor(e=i=>i.values().next().value){this._peeker=e,this._observable=new X$,this._items=new Set}get length(){return We(this._observable),this._items.size}clear(){this.length!==0&&(this._items.clear(),this._observable.notify())}last(){if(this.length===0)return;let e;for(e of this._items);return e}peek(){if(this.length!==0)return this._peeker(this._items)}push(e){this.contains(e)||(this._items.add(e),this._observable.notify())}contains(e){return We(this._observable),this._items.has(e)}pop(){if(this.length===0)return;const e=this.peek();return this._items.delete(e),this._observable.notify(),e}popLast(){if(this.length===0)return;const e=this.last();return this._items.delete(e),this._observable.notify(),e}remove(e){this.contains(e)&&(this._items.delete(e),this._observable.notify())}filter(e){const i=this.length;return this._items.forEach(n=>{e(n)||this._items.delete(n)}),i!==this._items.size&&this._observable.notify(),this}*[Symbol.iterator](){We(this._observable),yield*this._items}};const ETe={statsWorker:()=>Y(()=>import("./statsWorker-ab6fabef.js"),["./statsWorker-ab6fabef.js","./quantizationUtils-4d6bfb95.js","./utils-785aae67.js"],import.meta.url),geometryEngineWorker:()=>Y(()=>import("./geometryEngineWorker-08079560.js"),["./geometryEngineWorker-08079560.js","./geometryEngineJSON-8ecb2693.js","./geometryEngineBase-5d80acc4.js","./json-48e3ea08.js"],import.meta.url),CSVSourceWorker:()=>Y(()=>import("./CSVSourceWorker-45e242f5.js"),["./CSVSourceWorker-45e242f5.js","./json-48e3ea08.js","./OptimizedFeature-4701473b.js","./OptimizedGeometry-196224d4.js","./FeatureStore-0f5f076d.js","./featureConversionUtils-7f0dd1f5.js","./OptimizedFeatureSet-1d1ac4b9.js","./BoundsStore-8f9a5e7d.js","./PooledRBush-c3f6d07d.js","./optimizedFeatureQueryEngineAdapter-2fa61fa1.js","./centroid-8e8cfa47.js","./timeSupport-e85aa784.js","./projectionSupport-7e11e91a.js","./QueryEngine-19cea4e7.js","./WhereClause-831210c9.js","./executionError-c92d3b85.js","./quantizationUtils-4d6bfb95.js","./utils-785aae67.js","./SnappingCandidate-970faec6.js","./number-9efd2333.js"],import.meta.url),EdgeProcessingWorker:()=>Y(()=>import("./EdgeProcessingWorker-17fa755e.js"),["./EdgeProcessingWorker-17fa755e.js","./workerHelper-9db2734a.js","./InterleavedLayout-9fc0b7c6.js","./BufferView-3be96e15.js","./types-1305598a.js","./edgeProcessing-fd058889.js","./deduplicate-c994028e.js","./Indices-ee76e634.js","./glUtil-0b7ee6ea.js","./enums-b14466b3.js","./VertexElementDescriptor-2925c6af.js"],import.meta.url),ElevationSamplerWorker:()=>Y(()=>import("./ElevationSamplerWorker-d4edf617.js"),["./ElevationSamplerWorker-d4edf617.js","./PooledRBush-c3f6d07d.js","./georeference-348a36c9.js","./spatialReferenceEllipsoidUtils-088ffef8.js","./DoubleArray-d8438b2c.js","./MeshGeoreferencedRelativeVertexSpace-f40214e0.js","./MeshLocalVertexSpace-42b42dee.js","./MeshTransform-86944072.js","./vec32-8668bab3.js","./projection-1ffbe9dd.js","./BufferView-3be96e15.js"],import.meta.url),FeatureServiceSnappingSourceWorker:()=>Y(()=>import("./FeatureServiceSnappingSourceWorker-d0ba7229.js"),["./FeatureServiceSnappingSourceWorker-d0ba7229.js","./FeatureStore-0f5f076d.js","./featureConversionUtils-7f0dd1f5.js","./OptimizedFeature-4701473b.js","./OptimizedFeatureSet-1d1ac4b9.js","./OptimizedGeometry-196224d4.js","./BoundsStore-8f9a5e7d.js","./PooledRBush-c3f6d07d.js","./optimizedFeatureQueryEngineAdapter-2fa61fa1.js","./centroid-8e8cfa47.js","./timeSupport-e85aa784.js","./projectionSupport-7e11e91a.js","./json-48e3ea08.js","./QueryEngine-19cea4e7.js","./WhereClause-831210c9.js","./executionError-c92d3b85.js","./quantizationUtils-4d6bfb95.js","./utils-785aae67.js","./SnappingCandidate-970faec6.js","./symbologySnappingCandidates-d66217cb.js","./pbfQueryUtils-380cf68a.js","./pbf-984c4807.js","./query-d707c0a5.js","./queryZScale-e903e101.js","./byteSizeEstimations-7cf1c05d.js"],import.meta.url),GeoJSONSourceWorker:()=>Y(()=>import("./GeoJSONSourceWorker-3a0de029.js"),["./GeoJSONSourceWorker-3a0de029.js","./featureConversionUtils-7f0dd1f5.js","./OptimizedFeature-4701473b.js","./OptimizedFeatureSet-1d1ac4b9.js","./OptimizedGeometry-196224d4.js","./FeatureStore-0f5f076d.js","./BoundsStore-8f9a5e7d.js","./PooledRBush-c3f6d07d.js","./optimizedFeatureQueryEngineAdapter-2fa61fa1.js","./centroid-8e8cfa47.js","./timeSupport-e85aa784.js","./projectionSupport-7e11e91a.js","./json-48e3ea08.js","./QueryEngine-19cea4e7.js","./WhereClause-831210c9.js","./executionError-c92d3b85.js","./quantizationUtils-4d6bfb95.js","./utils-785aae67.js","./SnappingCandidate-970faec6.js","./geojson-acacbdcf.js","./sourceUtils-3d4c455d.js"],import.meta.url),LercWorker:()=>Y(()=>import("./LercWorker-1c385423.js"),[],import.meta.url),MemorySourceWorker:()=>Y(()=>import("./MemorySourceWorker-b8bb5a0d.js"),["./MemorySourceWorker-b8bb5a0d.js","./featureConversionUtils-7f0dd1f5.js","./OptimizedFeature-4701473b.js","./OptimizedFeatureSet-1d1ac4b9.js","./OptimizedGeometry-196224d4.js","./objectIdUtils-789e911a.js","./FeatureStore-0f5f076d.js","./BoundsStore-8f9a5e7d.js","./PooledRBush-c3f6d07d.js","./optimizedFeatureQueryEngineAdapter-2fa61fa1.js","./centroid-8e8cfa47.js","./timeSupport-e85aa784.js","./projectionSupport-7e11e91a.js","./json-48e3ea08.js","./QueryEngine-19cea4e7.js","./WhereClause-831210c9.js","./executionError-c92d3b85.js","./quantizationUtils-4d6bfb95.js","./utils-785aae67.js","./SnappingCandidate-970faec6.js","./sourceUtils-3d4c455d.js"],import.meta.url),PBFDecoderWorker:()=>Y(()=>import("./PBFDecoderWorker-c15d1a2c.js"),["./PBFDecoderWorker-c15d1a2c.js","./featureConversionUtils-7f0dd1f5.js","./OptimizedFeature-4701473b.js","./OptimizedFeatureSet-1d1ac4b9.js","./OptimizedGeometry-196224d4.js","./pbfQueryUtils-380cf68a.js","./pbf-984c4807.js"],import.meta.url),Pipeline:()=>Y(()=>import("./Pipeline-e8056134.js"),["./Pipeline-e8056134.js","./featureConversionUtils-7f0dd1f5.js","./OptimizedFeature-4701473b.js","./OptimizedFeatureSet-1d1ac4b9.js","./OptimizedGeometry-196224d4.js","./QueryEngine-19cea4e7.js","./WhereClause-831210c9.js","./executionError-c92d3b85.js","./projectionSupport-7e11e91a.js","./json-48e3ea08.js","./quantizationUtils-4d6bfb95.js","./timeSupport-e85aa784.js","./utils-785aae67.js","./SnappingCandidate-970faec6.js","./FeatureStore2D-1ceb7fe5.js","./CircularArray-ef508845.js","./ComputedAttributeStorage-4014e53f.js","./arcadeTimeUtils-31294c74.js","./centroid-8e8cfa47.js","./definitions-97fbc524.js","./visualVariablesUtils-be80a4d1.js","./color-769a2896.js","./enums-f1a6a48a.js","./enums-b14466b3.js","./VertexElementDescriptor-2925c6af.js","./number-e491b09e.js","./ogcFeatureUtils-71dca5ce.js","./geojson-acacbdcf.js","./query-d707c0a5.js","./pbfQueryUtils-380cf68a.js","./pbf-984c4807.js","./queryZScale-e903e101.js","./createConnection-7fe0204c.js","./geohashUtils-77d8429b.js"],import.meta.url),PointCloudWorker:()=>Y(()=>import("./PointCloudWorker-7176a520.js"),["./PointCloudWorker-7176a520.js","./I3SBinaryReader-e29e39e4.js","./PointCloudUniqueValueRenderer-cd6e709f.js"],import.meta.url),RasterWorker:()=>Y(()=>import("./RasterWorker-914f6a15.js"),[],import.meta.url),SceneLayerSnappingSourceWorker:()=>Y(()=>import("./SceneLayerSnappingSourceWorker-2a50d1ca.js"),["./SceneLayerSnappingSourceWorker-2a50d1ca.js","./Octree-2fa482dd.js","./edgeProcessing-fd058889.js","./deduplicate-c994028e.js","./Indices-ee76e634.js","./InterleavedLayout-9fc0b7c6.js","./BufferView-3be96e15.js","./types-1305598a.js","./glUtil-0b7ee6ea.js","./enums-b14466b3.js","./VertexElementDescriptor-2925c6af.js"],import.meta.url),SceneLayerWorker:()=>Y(()=>import("./SceneLayerWorker-f4804fc9.js"),["./SceneLayerWorker-f4804fc9.js","./DoubleArray-d8438b2c.js","./MeshGeoreferencedRelativeVertexSpace-f40214e0.js","./MeshLocalVertexSpace-42b42dee.js","./vec32-8668bab3.js"],import.meta.url),WFSSourceWorker:()=>Y(()=>import("./WFSSourceWorker-5850df01.js"),["./WFSSourceWorker-5850df01.js","./featureConversionUtils-7f0dd1f5.js","./OptimizedFeature-4701473b.js","./OptimizedFeatureSet-1d1ac4b9.js","./OptimizedGeometry-196224d4.js","./FeatureStore-0f5f076d.js","./BoundsStore-8f9a5e7d.js","./PooledRBush-c3f6d07d.js","./optimizedFeatureQueryEngineAdapter-2fa61fa1.js","./centroid-8e8cfa47.js","./timeSupport-e85aa784.js","./projectionSupport-7e11e91a.js","./json-48e3ea08.js","./QueryEngine-19cea4e7.js","./WhereClause-831210c9.js","./executionError-c92d3b85.js","./quantizationUtils-4d6bfb95.js","./utils-785aae67.js","./SnappingCandidate-970faec6.js","./geojson-acacbdcf.js","./sourceUtils-3d4c455d.js","./wfsUtils-f34d2a11.js","./xmlUtils-444cb4c0.js"],import.meta.url),WorkerTileHandler:()=>Y(()=>import("./WorkerTileHandler-95d90824.js"),["./WorkerTileHandler-95d90824.js","./enums-fb086c25.js","./GeometryUtils-984e8446.js","./Rect-ea14f53a.js","./config-1337d16e.js","./StyleDefinition-29c49b98.js","./enums-f1a6a48a.js","./pbf-984c4807.js","./TurboLine-08ef9655.js","./definitions-97fbc524.js","./StyleRepository-47ab2876.js","./enums-b14466b3.js","./VertexElementDescriptor-2925c6af.js","./earcut-b7ad7453.js","./BidiEngine-9a40f2f4.js"],import.meta.url)};var Rr;(function(t){t[t.HANDSHAKE=0]="HANDSHAKE",t[t.OPEN=1]="OPEN",t[t.OPENED=2]="OPENED",t[t.RESPONSE=3]="RESPONSE",t[t.INVOKE=4]="INVOKE",t[t.ABORT=5]="ABORT",t[t.CLOSE=6]="CLOSE",t[t.OPEN_PORT=7]="OPEN_PORT",t[t.ON=8]="ON"})(Rr||(Rr={}));let ATe=0;function une(){return ATe++}function $Te(t){return t&&typeof t=="object"&&("result"in t||"transferList"in t)}function j2(t){return t?typeof t=="string"?JSON.stringify({name:"message",message:t}):t.toJSON?JSON.stringify(t):JSON.stringify({name:t.name,message:t.message,details:t.details||{stack:t.stack}}):null}function dV(t,e,i,n){if(e.type===Rr.OPEN_PORT)return void t.postMessage(e,[e.port]);if(e.type!==Rr.INVOKE&&e.type!==Rr.RESPONSE)return void t.postMessage(e);let r;if($Te(i)?(r=IU(i.transferList),e.data=i.result):(r=IU(n),e.data=i),r){if(ee("ff")){for(const s of r)if("byteLength"in s&&s.byteLength>267386880){const o="Worker call with large ArrayBuffer would crash Firefox";switch(e.type){case Rr.INVOKE:throw o;case Rr.RESPONSE:return void dV(t,{type:Rr.RESPONSE,jobId:e.jobId,error:j2(o)})}}}t.postMessage(e,r)}else t.postMessage(e)}function B2(t){if(!t)return null;const e=t.data;return e?typeof e=="string"?JSON.parse(e):e:null}function IU(t){if(!t||!t.length)return null;if(ee("esri-workers-arraybuffer-transfer"))return t;const e=t.filter(i=>!PTe(i));return e.length?e:null}function PTe(t){var e;return t instanceof ArrayBuffer||((e=t==null?void 0:t.constructor)==null?void 0:e.name)==="ArrayBuffer"}const{CLOSE:CU,ABORT:MU,INVOKE:EU,RESPONSE:x1,OPEN_PORT:AU,ON:kTe}=Rr,OTe=2;let LTe=class{constructor(e){this._timer=null,this._cancelledJobIds=new Set,this._invokeMessages=[],this._invoke=e,this._timer=null,this._process=this._process.bind(this)}push(e){e.type===Rr.ABORT?this._cancelledJobIds.add(e.jobId):(this._invokeMessages.push(e),this._timer===null&&(this._timer=setTimeout(this._process,0)))}clear(){this._invokeMessages.length=0,this._cancelledJobIds.clear(),this._timer=null}_process(){this._timer=null;for(const e of this._invokeMessages)this._cancelledJobIds.has(e.jobId)||this._invoke(e);this._cancelledJobIds.clear(),this._invokeMessages.length=0}},Df=class fv{static connect(e){const i=new MessageChannel;let n;n=typeof e=="function"?new e:"default"in e&&typeof e.default=="function"?new e.default:e;const r=new fv(i.port1,{channel:i,client:n},()=>null);return typeof n=="object"&&"remoteClient"in n&&(n.remoteClient=r),fv.clients.set(r,n),i.port2}static loadWorker(e){const i=ETe[e];return i?i():Promise.resolve(null)}constructor(e,i,n){this._port=e,this._getNextJob=n,this._outJobs=new Map,this._inJobs=new Map,this._invokeQueue=new LTe(r=>this._onInvokeMessage(r)),this._client=i.client,this._onMessage=this._onMessage.bind(this),this._channel=i.channel,this._schedule=i.schedule,this._port.addEventListener("message",this._onMessage),this._port.start()}close(){this._post({type:CU}),this._close()}isBusy(){return this._outJobs.size>0}invoke(e,i,n){const r=n==null?void 0:n.signal,s=n==null?void 0:n.transferList;if(!this._port)return Promise.reject(new V("worker:port-closed",`Cannot call invoke('${e}'), port is closed`,{methodName:e,data:i}));const o=une();return new Promise((a,l)=>{if(zo(r))return this._processWork(),void l(li());const c=Ro(r,()=>{const d=this._outJobs.get(o);d&&(this._outJobs.delete(o),this._processWork(),Ri(d.abortHandle),this._post({type:MU,jobId:o}),l(li()))}),u={resolve:a,reject:l,abortHandle:c,debugInfo:e};this._outJobs.set(o,u),this._post({type:EU,jobId:o,methodName:e,abortable:r!=null},i,s)})}on(e,i){const n=new MessageChannel;function r(s){i(s.data)}return this._port.postMessage({type:Rr.ON,eventType:e,port:n.port2},[n.port2]),n.port1.addEventListener("message",r),n.port1.start(),{remove(){n.port1.postMessage({type:Rr.CLOSE}),n.port1.close(),n.port1.removeEventListener("message",r)}}}jobAdded(){this._processWork()}openPort(){const e=new MessageChannel;return this._post({type:AU,port:e.port2}),e.port1}_processWork(){if(this._outJobs.size>=OTe)return;const e=this._getNextJob();if(!e)return;const{methodName:i,data:n,invokeOptions:r,resolver:s}=e;this.invoke(i,n,r).then(o=>s.resolve(o)).catch(o=>s.reject(o))}_close(){this._channel&&(this._channel=void 0),this._port.removeEventListener("message",this._onMessage),this._port.close(),this._outJobs.forEach(e=>{Ri(e.abortHandle),e.reject(li(`Worker closing, aborting job calling '${e.debugInfo}'`))}),this._inJobs.clear(),this._outJobs.clear(),this._invokeQueue.clear(),this._port=null,this._client=null,this._schedule=null}_onMessage(e){this._schedule!=null?this._schedule(()=>this._processMessage(e)):this._processMessage(e)}_processMessage(e){const i=B2(e);if(i)switch(i.type){case x1:this._onResponseMessage(i);break;case EU:this._invokeQueue.push(i);break;case MU:this._onAbortMessage(i);break;case CU:this._onCloseMessage();break;case AU:this._onOpenPortMessage(i);break;case kTe:this._onOnMessage(i)}}_onAbortMessage(e){const i=this._inJobs,n=e.jobId,r=i.get(n);this._invokeQueue.push(e),r&&(r.controller&&r.controller.abort(),i.delete(n))}_onCloseMessage(){const e=this._client;this._close(),e&&"destroy"in e&&fv.clients.get(this)===e&&e.destroy(),fv.clients.delete(this),e!=null&&e.remoteClient&&(e.remoteClient=null)}_onInvokeMessage(e){const{methodName:i,jobId:n,data:r,abortable:s}=e,o=s?new AbortController:null,a=this._inJobs;let l,c=this._client,u=c[i];try{if(!u&&i&&i.includes(".")){const d=i.split(".");for(let f=0;f<d.length-1;f++)c=c[d[f]],u=c[d[f+1]]}if(typeof u!="function")throw new TypeError(`${i} is not a function`);l=u.call(c,r,{client:this,signal:o?o.signal:null})}catch(d){return void this._post({type:x1,jobId:n,error:j2(d)})}fd(l)?(a.set(n,{controller:o,promise:l}),l.then(d=>{a.has(n)&&(a.delete(n),this._post({type:x1,jobId:n},d))},d=>{a.has(n)&&(a.delete(n),Ds(d)||this._post({type:x1,jobId:n,error:j2(d||{message:`Error encountered at method ${i}`})}))})):this._post({type:x1,jobId:n},l)}_onOpenPortMessage(e){new fv(e.port,{client:this._client},()=>null)}_onOnMessage(e){const{port:i}=e,n=this._client.on(e.eventType,s=>{i.postMessage(s)}),r=Lh(e.port,"message",s=>{const o=B2(s);(o==null?void 0:o.type)===Rr.CLOSE&&(r.remove(),n.remove(),i.close())})}_onResponseMessage(e){const{jobId:i,error:n,data:r}=e,s=this._outJobs;if(!s.has(i))return;const o=s.get(i);s.delete(i),this._processWork(),Ri(o.abortHandle),n?o.reject(V.fromJSON(JSON.parse(n))):o.resolve(r)}_post(e,i,n){return dV(this._port,e,i,n)}};Df.kernelInfo={buildDate:$Q,fullVersion:p6,revision:PQ},Df.clients=new Map;let RTe=class{constructor(){this._inUseClients=new Array,this._clients=new Array,this._clientPromises=new Array,this._ongoingJobsQueue=new hA}destroy(){this.close()}get closed(){return!this._clients||!this._clients.length}open(e,i){return new Promise((n,r)=>{let s=!0;const o=a=>{Vt(i.signal),s&&(s=!1,a())};this._clients.length=e.length,this._clientPromises.length=e.length,this._inUseClients.length=e.length;for(let a=0;a<e.length;++a){const l=e[a];fd(l)?this._clientPromises[a]=l.then(c=>(this._clients[a]=new Df(c,i,()=>this._ongoingJobsQueue.pop()??null),o(n),this._clients[a]),()=>(o(r),null)):(this._clients[a]=new Df(l,i,()=>this._ongoingJobsQueue.pop()??null),this._clientPromises[a]=Promise.resolve(this._clients[a]),o(n))}})}broadcast(e,i,n){const r=new Array(this._clientPromises.length);for(let s=0;s<this._clientPromises.length;++s){const o=this._clientPromises[s];r[s]=o.then(a=>a==null?void 0:a.invoke(e,i,n))}return r}close(){let e;for(;e=this._ongoingJobsQueue.pop();)e.resolver.reject(li(`Worker closing, aborting job calling '${e.methodName}'`));for(const i of this._clientPromises)i.then(n=>n==null?void 0:n.close());this._clients.length=0,this._clientPromises.length=0,this._inUseClients.length=0}invoke(e,i,n){let r;Array.isArray(n)?(ne.getLogger("esri.core.workers.Connection").warn("invoke()","The transferList parameter is deprecated, use the options object instead"),r={transferList:n}):r=n;const s=xc();this._ongoingJobsQueue.push({methodName:e,data:i,invokeOptions:r,resolver:s});for(let o=0;o<this._clientPromises.length;o++){const a=this._clients[o];a?a.jobAdded():this._clientPromises[o].then(l=>l==null?void 0:l.jobAdded())}return s.promise}on(e,i){return Promise.all(this._clientPromises).then(()=>$c(this._clients.map(n=>n.on(e,i))))}openPorts(){return new Promise(e=>{const i=new Array(this._clientPromises.length);let n=i.length;for(let r=0;r<this._clientPromises.length;++r)this._clientPromises[r].then(s=>{s&&(i[r]=s.openPort()),--n==0&&e(i)})})}get test(){return{numClients:this._clients.length}}};const hne=ne.getLogger("esri.intl.substitute");function Ru(t,e,i={}){const{format:n={}}=i;return pl(t,r=>DTe(r,e,n))}function DTe(t,e,i){let n,r;const s=t.indexOf(":");if(s===-1?n=t.trim():(n=t.slice(0,s).trim(),r=t.slice(s+1).trim()),!n)return"";const o=AS(n,e);if(o==null)return"";const a=(r?i==null?void 0:i[r]:null)??(i==null?void 0:i[n]);return a?NTe(o,a):r?FTe(o,r):pV(o)}function NTe(t,e){switch(e.type){case"date":return yi(t,e.intlOptions);case"number":return Ns(t,e.intlOptions);default:return hne.warn("missing format descriptor for key {key}"),pV(t)}}function FTe(t,e){switch(e.toLowerCase()){case"dateformat":return yi(t);case"numberformat":return Ns(t);default:return hne.warn(`inline format is unsupported since 4.12: ${e}`),/^(dateformat|datestring)/i.test(e)?yi(t):/^numberformat/i.test(e)?Ns(t):pV(t)}}function pV(t){switch(typeof t){case"string":return t;case"number":return Ns(t);case"boolean":return""+t;default:return t instanceof Date?yi(t):""}}async function zTe(t,e,i,n){const r=e.exec(i);if(!r)throw new V("esri-intl:invalid-bundle",`Bundle id "${i}" is not compatible with the pattern "${e}"`);const s=r[1]?`${r[1]}/`:"",o=r[2],a=obe(n),l=`${s}${o}.json`,c=a?`${s}${o}_${a}.json`:l;let u;try{u=await $U(t(c))}catch(d){if(c===l)throw new V("intl:unknown-bundle",`Bundle "${i}" cannot be loaded`,{error:d});try{u=await $U(t(l))}catch(f){throw new V("intl:unknown-bundle",`Bundle "${i}" cannot be loaded`,{error:f})}}return u}async function $U(t){if(PU.fetchBundleAsset!=null)return PU.fetchBundleAsset(t);const e=await gt(t,{responseType:"text"});return JSON.parse(e.data)}let VTe=class{constructor({base:e="",pattern:i,location:n=new URL(window.location.href)}){let r;r=typeof n=="string"?s=>new URL(s,new URL(n,window.location.href)).href:n instanceof URL?s=>new URL(s,n).href:n,this.pattern=typeof i=="string"?new RegExp(`^${i}`):i,this.getAssetUrl=r,e=e?e.endsWith("/")?e:e+"/":"",this.matcher=new RegExp(`^${e}(?:(.*)/)?(.*)$`)}fetchMessageBundle(e,i){return zTe(this.getAssetUrl,this.matcher,e,i)}};function jTe(t){return new VTe(t)}const PU={};sbe(jTe({pattern:"esri/",location:xt}));const BTe={};function UTe(t){const e={async:t.async,isDebug:t.isDebug,locale:t.locale,baseUrl:t.baseUrl,has:{...t.has},map:{...t.map},packages:t.packages&&t.packages.concat()||[],paths:{...t.paths}};return t.hasOwnProperty("async")||(e.async=!0),t.hasOwnProperty("isDebug")||(e.isDebug=!1),t.baseUrl||(e.baseUrl=BTe.baseUrl),e}let GTe=class{constructor(){const e=document.createDocumentFragment();["addEventListener","dispatchEvent","removeEventListener"].forEach(i=>{this[i]=(...n)=>e[i](...n)})}},wM=class{constructor(){this._dispatcher=new GTe,this._workerPostMessage({type:Rr.HANDSHAKE})}terminate(){}get onmessage(){return this._onmessageHandler}set onmessage(e){this._onmessageHandler&&this.removeEventListener("message",this._onmessageHandler),this._onmessageHandler=e,e&&this.addEventListener("message",e)}get onmessageerror(){return this._onmessageerrorHandler}set onmessageerror(e){this._onmessageerrorHandler&&this.removeEventListener("messageerror",this._onmessageerrorHandler),this._onmessageerrorHandler=e,e&&this.addEventListener("messageerror",e)}get onerror(){return this._onerrorHandler}set onerror(e){this._onerrorHandler&&this.removeEventListener("error",this._onerrorHandler),this._onerrorHandler=e,e&&this.addEventListener("error",e)}postMessage(e){Z_(()=>{this._workerMessageHandler(new MessageEvent("message",{data:e}))})}dispatchEvent(e){return this._dispatcher.dispatchEvent(e)}addEventListener(e,i,n){this._dispatcher.addEventListener(e,i,n)}removeEventListener(e,i,n){this._dispatcher.removeEventListener(e,i,n)}_workerPostMessage(e){Z_(()=>{this.dispatchEvent(new MessageEvent("message",{data:e}))})}async _workerMessageHandler(e){const i=B2(e);if(i&&i.type===Rr.OPEN){const{modulePath:n,jobId:r}=i;let s=await Df.loadWorker(n);s||(s=await Y(()=>import(n),[],import.meta.url));const o=Df.connect(s);this._workerPostMessage({type:Rr.OPENED,jobId:r,data:o})}}};const Z5=ne.getLogger("esri.core.workers.workerFactory"),{HANDSHAKE:HTe}=Rr,qTe='let globalId=0;const outgoing=new Map,configuration=JSON.parse("{CONFIGURATION}");self.esriConfig=configuration.esriConfig;const workerPath=self.esriConfig.workers.workerPath,HANDSHAKE=0,OPEN=1,OPENED=2,RESPONSE=3,INVOKE=4,ABORT=5;function createAbortError(){const e=new Error("Aborted");return e.name="AbortError",e}function receiveMessage(e){return e&&e.data?"string"==typeof e.data?JSON.parse(e.data):e.data:null}function invokeStaticMessage(e,o,r){const t=r&&r.signal,n=globalId++;return new Promise(((r,s)=>{if(t){if(t.aborted)return s(createAbortError());t.addEventListener("abort",(()=>{outgoing.get(n)&&(outgoing.delete(n),self.postMessage({type:ABORT,jobId:n}),s(createAbortError()))}))}outgoing.set(n,{resolve:r,reject:s}),self.postMessage({type:INVOKE,jobId:n,methodName:e,abortable:null!=t,data:o})}))}let workerRevisionChecked=!1;function checkWorkerRevision(e){if(!workerRevisionChecked&&e.kernelInfo){workerRevisionChecked=!0;const{revision:o,fullVersion:r}=configuration.kernelInfo,{revision:t,fullVersion:n,version:s}=e.kernelInfo;esriConfig.assetsPath!==esriConfig.defaultAssetsPath&&o!==t&&console.warn(`Version mismatch detected between ArcGIS Maps SDK for JavaScript modules and assets. For more information visit https://bit.ly/3QnsuSo.\\nModules version: ${r}\\nAssets version: ${n??s}\\nAssets path: ${esriConfig.assetsPath}`)}}function messageHandler(e){const o=receiveMessage(e);if(!o)return;const r=o.jobId;switch(o.type){case OPEN:let n;function t(e){const o=n.connect(e);self.postMessage({type:OPENED,jobId:r,data:o},[o])}"function"==typeof define&&define.amd?require([workerPath],(e=>{n=e.default||e,checkWorkerRevision(n),n.loadWorker(o.modulePath).then((e=>e||new Promise((e=>{require([o.modulePath],e)})))).then(t)})):"System"in self&&"function"==typeof System.import?System.import(workerPath).then((e=>(n=e.default,checkWorkerRevision(n),n.loadWorker(o.modulePath)))).then((e=>e||System.import(o.modulePath))).then(t):esriConfig.workers.useDynamicImport?import(workerPath).then((e=>{n=e.default||e,checkWorkerRevision(n),n.loadWorker(o.modulePath).then((e=>e||import(o.modulePath))).then(t)})):(self.RemoteClient||importScripts(workerPath),n=self.RemoteClient.default||self.RemoteClient,checkWorkerRevision(n),n.loadWorker(o.modulePath).then(t));break;case RESPONSE:if(outgoing.has(r)){const s=outgoing.get(r);outgoing.delete(r),o.error?s.reject(JSON.parse(o.error)):s.resolve(o.data)}}}self.dojoConfig=configuration.loaderConfig,esriConfig.workers.loaderUrl&&(self.importScripts(esriConfig.workers.loaderUrl),"function"==typeof require&&"function"==typeof require.config&&require.config(configuration.loaderConfig)),self.addEventListener("message",messageHandler),self.postMessage({type:0});';let eI,tI;const kU="Failed to create Worker. Fallback to execute module in main thread";async function WTe(){if(!ee("esri-workers")||(ee("mozilla"),0))return OU(new wM);if(!eI&&!tI)try{const e=qTe.split('"{CONFIGURATION}"').join(`'${JTe()}'`);eI=URL.createObjectURL(new Blob([e],{type:"text/javascript"}))}catch(e){tI=e||{}}let t;if(eI)try{t=new Worker(eI,{name:"esri-worker-"+ZTe++})}catch{Z5.warn(kU,tI),t=new wM}else Z5.warn(kU,tI),t=new wM;return OU(t)}async function OU(t){return new Promise(e=>{function i(r){const s=B2(r);s&&s.type===HTe&&(t.removeEventListener("message",i),t.removeEventListener("error",n),e(t))}function n(r){r.preventDefault(),t.removeEventListener("message",i),t.removeEventListener("error",n),Z5.warn("Failed to create Worker. Fallback to execute module in main thread",r),(t=new wM).addEventListener("message",i),t.addEventListener("error",n)}t.addEventListener("message",i),t.addEventListener("error",n)})}function JTe(){let t;if(Tt.default!=null){const r={...Tt};delete r.default,t=JSON.parse(JSON.stringify(r))}else t=JSON.parse(JSON.stringify(Tt));t.assetsPath=tl(t.assetsPath),t.defaultAssetsPath=t.defaultAssetsPath?tl(t.defaultAssetsPath):void 0,t.request.interceptors=[],t.log.interceptors=[],t.locale=xr(),t.has={"esri-csp-restrictions":ee("esri-csp-restrictions"),"esri-2d-debug":!1,"esri-2d-update-debug":ee("esri-2d-update-debug"),"esri-2d-log-updating":ee("esri-2d-log-updating"),"featurelayer-pbf":ee("featurelayer-pbf"),"featurelayer-simplify-thresholds":ee("featurelayer-simplify-thresholds"),"featurelayer-simplify-payload-size-factors":ee("featurelayer-simplify-payload-size-factors"),"featurelayer-simplify-mobile-factor":ee("featurelayer-simplify-mobile-factor"),"esri-atomics":ee("esri-atomics"),"esri-shared-array-buffer":ee("esri-shared-array-buffer"),"esri-tiles-debug":ee("esri-tiles-debug"),"esri-workers-arraybuffer-transfer":ee("esri-workers-arraybuffer-transfer"),"feature-polyline-generalization-factor":ee("feature-polyline-generalization-factor"),"host-webworker":1,"polylabel-placement-enabled":ee("polylabel-placement-enabled")},t.workers.loaderUrl&&(t.workers.loaderUrl=tl(t.workers.loaderUrl)),t.workers.workerPath?t.workers.workerPath=tl(t.workers.workerPath):t.workers.workerPath=tl(xt("esri/core/workers/RemoteClient.js")),t.workers.useDynamicImport=!1;const e=Tt.workers.loaderConfig,i=UTe({baseUrl:e==null?void 0:e.baseUrl,locale:xr(),has:{"csp-restrictions":1,"dojo-test-sniff":0,"host-webworker":1,...e==null?void 0:e.has},map:{...e==null?void 0:e.map},paths:{...e==null?void 0:e.paths},packages:(e==null?void 0:e.packages)||[]});return JSON.stringify({esriConfig:t,loaderConfig:i,kernelInfo:{buildDate:$Q,fullVersion:p6,revision:PQ}})}let ZTe=0;const{ABORT:LU,INVOKE:YTe,OPEN:XTe,OPENED:KTe,RESPONSE:S1}=Rr;let QTe=class dne{static async create(e){const i=await WTe();return new dne(i,e)}constructor(e,i){this._outJobs=new Map,this._inJobs=new Map,this.worker=e,this.id=i,e.addEventListener("message",this._onMessage.bind(this)),e.addEventListener("error",n=>{n.preventDefault(),ne.getLogger("esri.core.workers.WorkerOwner").error(n)})}terminate(){this.worker.terminate()}async open(e,i={}){const{signal:n}=i,r=une();return new Promise((s,o)=>{const a={resolve:s,reject:o,abortHandle:zz(n,()=>{this._outJobs.delete(r),this._post({type:LU,jobId:r})})};this._outJobs.set(r,a),this._post({type:XTe,jobId:r,modulePath:e})})}_onMessage(e){const i=B2(e);if(i)switch(i.type){case KTe:this._onOpenedMessage(i);break;case S1:this._onResponseMessage(i);break;case LU:this._onAbortMessage(i);break;case YTe:this._onInvokeMessage(i)}}_onAbortMessage(e){const i=this._inJobs,n=e.jobId,r=i.get(n);r&&(r.controller&&r.controller.abort(),i.delete(n))}_onInvokeMessage(e){const{methodName:i,jobId:n,data:r,abortable:s}=e,o=s?new AbortController:null,a=this._inJobs,l=i_e[i];let c;try{if(typeof l!="function")throw new TypeError(`${i} is not a function`);c=l.call(null,r,{signal:o?o.signal:null})}catch(u){return void this._post({type:S1,jobId:n,error:j2(u)})}fd(c)?(a.set(n,{controller:o,promise:c}),c.then(u=>{a.has(n)&&(a.delete(n),this._post({type:S1,jobId:n},u))},u=>{a.has(n)&&(a.delete(n),u||(u={message:"Error encountered at method"+i}),Ds(u)||this._post({type:S1,jobId:n,error:j2(u||{message:`Error encountered at method ${i}`})}))})):this._post({type:S1,jobId:n},c)}_onOpenedMessage(e){const{jobId:i,data:n}=e,r=this._outJobs.get(i);r&&(this._outJobs.delete(i),Ri(r.abortHandle),r.resolve(n))}_onResponseMessage(e){const{jobId:i,error:n,data:r}=e,s=this._outJobs.get(i);s&&(this._outJobs.delete(i),Ri(s.abortHandle),n?s.reject(V.fromJSON(JSON.parse(n))):s.resolve(r))}_post(e,i,n){return dV(this.worker,e,i,n)}};const RU=ee("host-browser")?Math.min(navigator.hardwareConcurrency-1,ee("workers-pool-size")):0;let oy=ee("esri-mobile")?Math.min(RU,3):RU;oy||(oy=ee("safari")&&ee("mac")?7:2);let DU=0;const xM=[];function eIe(){fne()}async function iI(t,e){const i=new RTe;return await i.open(t,e),i}async function pne(t,e={}){if(typeof t!="string")throw new V("workers:undefined-module","modulePath is missing");let i=e.strategy||"distributed";if(ee("host-webworker")&&!ee("esri-workers")&&(i="local"),i==="local"){let n=await Df.loadWorker(t);n||(n=await Y(()=>import(t),[],import.meta.url)),Vt(e.signal);const r=e.client||n;return iI([Df.connect(n)],{...e,client:r})}if(await fne(),Vt(e.signal),i==="dedicated"){const n=DU++%oy;return iI([await xM[n].open(t,e)],e)}if(e.maxNumWorkers&&e.maxNumWorkers>0){const n=Math.min(e.maxNumWorkers,oy);if(n<oy){const r=new Array(n);for(let s=0;s<n;++s){const o=DU++%oy;r[s]=xM[o].open(t,e)}return iI(r,e)}}return iI(xM.map(n=>n.open(t,e)),e)}let nI=null;async function fne(){if(nI)return nI;new AbortController;const t=[];for(let e=0;e<oy;e++){const i=QTe.create(e).then(n=>(xM[e]=n,n));t.push(i)}return nI=Promise.all(t),nI}function U2(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Yf(t,e,i,n,r,s,o,a,l,c,u,d,f,m,g,y,_){return t[0]=e,t[1]=i,t[2]=n,t[3]=r,t[4]=s,t[5]=o,t[6]=a,t[7]=l,t[8]=c,t[9]=u,t[10]=d,t[11]=f,t[12]=m,t[13]=g,t[14]=y,t[15]=_,t}function KS(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function gl(t,e){if(t===e){const i=e[1],n=e[2],r=e[3],s=e[6],o=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=i,t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=s,t[11]=e[14],t[12]=r,t[13]=o,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function tIe(t,e){return bP(t,e)||KS(t),t}function bP(t,e){const i=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],d=e[9],f=e[10],m=e[11],g=e[12],y=e[13],_=e[14],b=e[15],w=i*a-n*o,x=i*l-r*o,S=i*c-s*o,T=n*l-r*a,I=n*c-s*a,C=r*c-s*l,M=u*y-d*g,E=u*_-f*g,A=u*b-m*g,$=d*_-f*y,L=d*b-m*y,D=f*b-m*_;let F=w*D-x*L+S*$+T*A-I*E+C*M;return F?(F=1/F,t[0]=(a*D-l*L+c*$)*F,t[1]=(r*L-n*D-s*$)*F,t[2]=(y*C-_*I+b*T)*F,t[3]=(f*I-d*C-m*T)*F,t[4]=(l*A-o*D-c*E)*F,t[5]=(i*D-r*A+s*E)*F,t[6]=(_*S-g*C-b*x)*F,t[7]=(u*C-f*S+m*x)*F,t[8]=(o*L-a*A+c*M)*F,t[9]=(n*A-i*L-s*M)*F,t[10]=(g*I-y*S+b*w)*F,t[11]=(d*S-u*I-m*w)*F,t[12]=(a*E-o*$-l*M)*F,t[13]=(i*$-n*E+r*M)*F,t[14]=(y*x-g*T-_*w)*F,t[15]=(u*T-d*x+f*w)*F,t):null}function iIe(t,e){const i=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],d=e[9],f=e[10],m=e[11],g=e[12],y=e[13],_=e[14],b=e[15];return t[0]=a*(f*b-m*_)-d*(l*b-c*_)+y*(l*m-c*f),t[1]=-(n*(f*b-m*_)-d*(r*b-s*_)+y*(r*m-s*f)),t[2]=n*(l*b-c*_)-a*(r*b-s*_)+y*(r*c-s*l),t[3]=-(n*(l*m-c*f)-a*(r*m-s*f)+d*(r*c-s*l)),t[4]=-(o*(f*b-m*_)-u*(l*b-c*_)+g*(l*m-c*f)),t[5]=i*(f*b-m*_)-u*(r*b-s*_)+g*(r*m-s*f),t[6]=-(i*(l*b-c*_)-o*(r*b-s*_)+g*(r*c-s*l)),t[7]=i*(l*m-c*f)-o*(r*m-s*f)+u*(r*c-s*l),t[8]=o*(d*b-m*y)-u*(a*b-c*y)+g*(a*m-c*d),t[9]=-(i*(d*b-m*y)-u*(n*b-s*y)+g*(n*m-s*d)),t[10]=i*(a*b-c*y)-o*(n*b-s*y)+g*(n*c-s*a),t[11]=-(i*(a*m-c*d)-o*(n*m-s*d)+u*(n*c-s*a)),t[12]=-(o*(d*_-f*y)-u*(a*_-l*y)+g*(a*f-l*d)),t[13]=i*(d*_-f*y)-u*(n*_-r*y)+g*(n*f-r*d),t[14]=-(i*(a*_-l*y)-o*(n*_-r*y)+g*(n*l-r*a)),t[15]=i*(a*f-l*d)-o*(n*f-r*d)+u*(n*l-r*a),t}function nIe(t){const e=t[0],i=t[1],n=t[2],r=t[3],s=t[4],o=t[5],a=t[6],l=t[7],c=t[8],u=t[9],d=t[10],f=t[11],m=t[12],g=t[13],y=t[14],_=t[15];return(e*o-i*s)*(d*_-f*y)-(e*a-n*s)*(u*_-f*g)+(e*l-r*s)*(u*y-d*g)+(i*a-n*o)*(c*_-f*m)-(i*l-r*o)*(c*y-d*m)+(n*l-r*a)*(c*g-u*m)}function fV(t,e,i){const n=e[0],r=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],d=e[8],f=e[9],m=e[10],g=e[11],y=e[12],_=e[13],b=e[14],w=e[15];let x=i[0],S=i[1],T=i[2],I=i[3];return t[0]=x*n+S*a+T*d+I*y,t[1]=x*r+S*l+T*f+I*_,t[2]=x*s+S*c+T*m+I*b,t[3]=x*o+S*u+T*g+I*w,x=i[4],S=i[5],T=i[6],I=i[7],t[4]=x*n+S*a+T*d+I*y,t[5]=x*r+S*l+T*f+I*_,t[6]=x*s+S*c+T*m+I*b,t[7]=x*o+S*u+T*g+I*w,x=i[8],S=i[9],T=i[10],I=i[11],t[8]=x*n+S*a+T*d+I*y,t[9]=x*r+S*l+T*f+I*_,t[10]=x*s+S*c+T*m+I*b,t[11]=x*o+S*u+T*g+I*w,x=i[12],S=i[13],T=i[14],I=i[15],t[12]=x*n+S*a+T*d+I*y,t[13]=x*r+S*l+T*f+I*_,t[14]=x*s+S*c+T*m+I*b,t[15]=x*o+S*u+T*g+I*w,t}function rIe(t,e,i){const n=i[0],r=i[1],s=i[2];if(e===t)t[12]=e[0]*n+e[4]*r+e[8]*s+e[12],t[13]=e[1]*n+e[5]*r+e[9]*s+e[13],t[14]=e[2]*n+e[6]*r+e[10]*s+e[14],t[15]=e[3]*n+e[7]*r+e[11]*s+e[15];else{const o=e[0],a=e[1],l=e[2],c=e[3],u=e[4],d=e[5],f=e[6],m=e[7],g=e[8],y=e[9],_=e[10],b=e[11];t[0]=o,t[1]=a,t[2]=l,t[3]=c,t[4]=u,t[5]=d,t[6]=f,t[7]=m,t[8]=g,t[9]=y,t[10]=_,t[11]=b,t[12]=o*n+u*r+g*s+e[12],t[13]=a*n+d*r+y*s+e[13],t[14]=l*n+f*r+_*s+e[14],t[15]=c*n+m*r+b*s+e[15]}return t}function sIe(t,e,i){const n=i[0],r=i[1],s=i[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*s,t[9]=e[9]*s,t[10]=e[10]*s,t[11]=e[11]*s,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function oIe(t,e,i,n){let r,s,o,a,l,c,u,d,f,m,g,y,_,b,w,x,S,T,I,C,M,E,A,$,L=n[0],D=n[1],F=n[2],z=Math.sqrt(L*L+D*D+F*F);return z<so()?null:(z=1/z,L*=z,D*=z,F*=z,r=Math.sin(i),s=Math.cos(i),o=1-s,a=e[0],l=e[1],c=e[2],u=e[3],d=e[4],f=e[5],m=e[6],g=e[7],y=e[8],_=e[9],b=e[10],w=e[11],x=L*L*o+s,S=D*L*o+F*r,T=F*L*o-D*r,I=L*D*o-F*r,C=D*D*o+s,M=F*D*o+L*r,E=L*F*o+D*r,A=D*F*o-L*r,$=F*F*o+s,t[0]=a*x+d*S+y*T,t[1]=l*x+f*S+_*T,t[2]=c*x+m*S+b*T,t[3]=u*x+g*S+w*T,t[4]=a*I+d*C+y*M,t[5]=l*I+f*C+_*M,t[6]=c*I+m*C+b*M,t[7]=u*I+g*C+w*M,t[8]=a*E+d*A+y*$,t[9]=l*E+f*A+_*$,t[10]=c*E+m*A+b*$,t[11]=u*E+g*A+w*$,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function aIe(t,e,i){const n=Math.sin(i),r=Math.cos(i),s=e[4],o=e[5],a=e[6],l=e[7],c=e[8],u=e[9],d=e[10],f=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=s*r+c*n,t[5]=o*r+u*n,t[6]=a*r+d*n,t[7]=l*r+f*n,t[8]=c*r-s*n,t[9]=u*r-o*n,t[10]=d*r-a*n,t[11]=f*r-l*n,t}function lIe(t,e,i){const n=Math.sin(i),r=Math.cos(i),s=e[0],o=e[1],a=e[2],l=e[3],c=e[8],u=e[9],d=e[10],f=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*r-c*n,t[1]=o*r-u*n,t[2]=a*r-d*n,t[3]=l*r-f*n,t[8]=s*n+c*r,t[9]=o*n+u*r,t[10]=a*n+d*r,t[11]=l*n+f*r,t}function cIe(t,e,i){const n=Math.sin(i),r=Math.cos(i),s=e[0],o=e[1],a=e[2],l=e[3],c=e[4],u=e[5],d=e[6],f=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*r+c*n,t[1]=o*r+u*n,t[2]=a*r+d*n,t[3]=l*r+f*n,t[4]=c*r-s*n,t[5]=u*r-o*n,t[6]=d*r-a*n,t[7]=f*r-l*n,t}function mne(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function uIe(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function mV(t,e,i){if(e===0)return KS(t);let n,r,s,o=i[0],a=i[1],l=i[2],c=Math.sqrt(o*o+a*a+l*l);return c<so()?null:(c=1/c,o*=c,a*=c,l*=c,n=Math.sin(e),r=Math.cos(e),s=1-r,t[0]=o*o*s+r,t[1]=a*o*s+l*n,t[2]=l*o*s-a*n,t[3]=0,t[4]=o*a*s-l*n,t[5]=a*a*s+r,t[6]=l*a*s+o*n,t[7]=0,t[8]=o*l*s+a*n,t[9]=a*l*s-o*n,t[10]=l*l*s+r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function hIe(t,e){const i=Math.sin(e),n=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n,t[6]=i,t[7]=0,t[8]=0,t[9]=-i,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function dIe(t,e){const i=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=0,t[2]=-i,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=i,t[9]=0,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function pIe(t,e){const i=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=i,t[2]=0,t[3]=0,t[4]=-i,t[5]=n,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function gne(t,e,i){const n=e[0],r=e[1],s=e[2],o=e[3],a=n+n,l=r+r,c=s+s,u=n*a,d=n*l,f=n*c,m=r*l,g=r*c,y=s*c,_=o*a,b=o*l,w=o*c;return t[0]=1-(m+y),t[1]=d+w,t[2]=f-b,t[3]=0,t[4]=d-w,t[5]=1-(u+y),t[6]=g+_,t[7]=0,t[8]=f+b,t[9]=g-_,t[10]=1-(u+m),t[11]=0,t[12]=i[0],t[13]=i[1],t[14]=i[2],t[15]=1,t}function fIe(t,e){const i=mIe,n=-e[0],r=-e[1],s=-e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],d=n*n+r*r+s*s+o*o;return d>0?(i[0]=2*(a*o+u*n+l*s-c*r)/d,i[1]=2*(l*o+u*r+c*n-a*s)/d,i[2]=2*(c*o+u*s+a*r-l*n)/d):(i[0]=2*(a*o+u*n+l*s-c*r),i[1]=2*(l*o+u*r+c*n-a*s),i[2]=2*(c*o+u*s+a*r-l*n)),gne(t,e,i),t}const mIe=Me();function gIe(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function yIe(t,e){const i=e[0],n=e[1],r=e[2],s=e[4],o=e[5],a=e[6],l=e[8],c=e[9],u=e[10];return t[0]=Math.sqrt(i*i+n*n+r*r),t[1]=Math.sqrt(s*s+o*o+a*a),t[2]=Math.sqrt(l*l+c*c+u*u),t}function vIe(t,e){const i=e[0]+e[5]+e[10];let n=0;return i>0?(n=2*Math.sqrt(i+1),t[3]=.25*n,t[0]=(e[6]-e[9])/n,t[1]=(e[8]-e[2])/n,t[2]=(e[1]-e[4])/n):e[0]>e[5]&&e[0]>e[10]?(n=2*Math.sqrt(1+e[0]-e[5]-e[10]),t[3]=(e[6]-e[9])/n,t[0]=.25*n,t[1]=(e[1]+e[4])/n,t[2]=(e[8]+e[2])/n):e[5]>e[10]?(n=2*Math.sqrt(1+e[5]-e[0]-e[10]),t[3]=(e[8]-e[2])/n,t[0]=(e[1]+e[4])/n,t[1]=.25*n,t[2]=(e[6]+e[9])/n):(n=2*Math.sqrt(1+e[10]-e[0]-e[5]),t[3]=(e[1]-e[4])/n,t[0]=(e[8]+e[2])/n,t[1]=(e[6]+e[9])/n,t[2]=.25*n),t}function _Ie(t,e,i,n){const r=e[0],s=e[1],o=e[2],a=e[3],l=r+r,c=s+s,u=o+o,d=r*l,f=r*c,m=r*u,g=s*c,y=s*u,_=o*u,b=a*l,w=a*c,x=a*u,S=n[0],T=n[1],I=n[2];return t[0]=(1-(g+_))*S,t[1]=(f+x)*S,t[2]=(m-w)*S,t[3]=0,t[4]=(f-x)*T,t[5]=(1-(d+_))*T,t[6]=(y+b)*T,t[7]=0,t[8]=(m+w)*I,t[9]=(y-b)*I,t[10]=(1-(d+g))*I,t[11]=0,t[12]=i[0],t[13]=i[1],t[14]=i[2],t[15]=1,t}function bIe(t,e,i,n,r){const s=e[0],o=e[1],a=e[2],l=e[3],c=s+s,u=o+o,d=a+a,f=s*c,m=s*u,g=s*d,y=o*u,_=o*d,b=a*d,w=l*c,x=l*u,S=l*d,T=n[0],I=n[1],C=n[2],M=r[0],E=r[1],A=r[2],$=(1-(y+b))*T,L=(m+S)*T,D=(g-x)*T,F=(m-S)*I,z=(1-(f+b))*I,U=(_+w)*I,G=(g+x)*C,W=(_-w)*C,Z=(1-(f+y))*C;return t[0]=$,t[1]=L,t[2]=D,t[3]=0,t[4]=F,t[5]=z,t[6]=U,t[7]=0,t[8]=G,t[9]=W,t[10]=Z,t[11]=0,t[12]=i[0]+M-($*M+F*E+G*A),t[13]=i[1]+E-(L*M+z*E+W*A),t[14]=i[2]+A-(D*M+U*E+Z*A),t[15]=1,t}function wIe(t,e){const i=e[0],n=e[1],r=e[2],s=e[3],o=i+i,a=n+n,l=r+r,c=i*o,u=n*o,d=n*a,f=r*o,m=r*a,g=r*l,y=s*o,_=s*a,b=s*l;return t[0]=1-d-g,t[1]=u+b,t[2]=f-_,t[3]=0,t[4]=u-b,t[5]=1-c-g,t[6]=m+y,t[7]=0,t[8]=f+_,t[9]=m-y,t[10]=1-c-d,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function xIe(t,e,i,n,r,s,o){const a=1/(i-e),l=1/(r-n),c=1/(s-o);return t[0]=2*s*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*s*l,t[6]=0,t[7]=0,t[8]=(i+e)*a,t[9]=(r+n)*l,t[10]=(o+s)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*s*2*c,t[15]=0,t}function SIe(t,e,i,n,r){const s=1/Math.tan(e/2);let o;return t[0]=s/i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,r!=null&&r!==1/0?(o=1/(n-r),t[10]=(r+n)*o,t[14]=2*r*n*o):(t[10]=-1,t[14]=-2*n),t}function TIe(t,e,i,n){const r=Math.tan(e.upDegrees*Math.PI/180),s=Math.tan(e.downDegrees*Math.PI/180),o=Math.tan(e.leftDegrees*Math.PI/180),a=Math.tan(e.rightDegrees*Math.PI/180),l=2/(o+a),c=2/(r+s);return t[0]=l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=-(o-a)*l*.5,t[9]=(r-s)*c*.5,t[10]=n/(i-n),t[11]=-1,t[12]=0,t[13]=0,t[14]=n*i/(i-n),t[15]=0,t}function IIe(t,e,i,n,r,s,o){const a=1/(e-i),l=1/(n-r),c=1/(s-o);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+i)*a,t[13]=(r+n)*l,t[14]=(o+s)*c,t[15]=1,t}function CIe(t,e,i,n){const r=e[0],s=e[1],o=e[2];let a=r-i[0],l=s-i[1],c=o-i[2];const u=so();if(Math.abs(a)<u&&Math.abs(l)<u&&Math.abs(c)<u)return void KS(t);let d=1/Math.sqrt(a*a+l*l+c*c);a*=d,l*=d,c*=d;const f=n[0],m=n[1],g=n[2];let y=m*c-g*l,_=g*a-f*c,b=f*l-m*a;d=Math.sqrt(y*y+_*_+b*b),d?(d=1/d,y*=d,_*=d,b*=d):(y=0,_=0,b=0);let w=l*b-c*_,x=c*y-a*b,S=a*_-l*y;d=Math.sqrt(w*w+x*x+S*S),d?(d=1/d,w*=d,x*=d,S*=d):(w=0,x=0,S=0),t[0]=y,t[1]=w,t[2]=a,t[3]=0,t[4]=_,t[5]=x,t[6]=l,t[7]=0,t[8]=b,t[9]=S,t[10]=c,t[11]=0,t[12]=-(y*r+_*s+b*o),t[13]=-(w*r+x*s+S*o),t[14]=-(a*r+l*s+c*o),t[15]=1}function MIe(t,e,i,n){const r=e[0],s=e[1],o=e[2],a=n[0],l=n[1],c=n[2];let u=r-i[0],d=s-i[1],f=o-i[2],m=u*u+d*d+f*f;m>0&&(m=1/Math.sqrt(m),u*=m,d*=m,f*=m);let g=l*f-c*d,y=c*u-a*f,_=a*d-l*u;return m=g*g+y*y+_*_,m>0&&(m=1/Math.sqrt(m),g*=m,y*=m,_*=m),t[0]=g,t[1]=y,t[2]=_,t[3]=0,t[4]=d*_-f*y,t[5]=f*g-u*_,t[6]=u*y-d*g,t[7]=0,t[8]=u,t[9]=d,t[10]=f,t[11]=0,t[12]=r,t[13]=s,t[14]=o,t[15]=1,t}function EIe(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function AIe(t){return Math.sqrt(t[0]**2+t[1]**2+t[2]**2+t[3]**2+t[4]**2+t[5]**2+t[6]**2+t[7]**2+t[8]**2+t[9]**2+t[10]**2+t[11]**2+t[12]**2+t[13]**2+t[14]**2+t[15]**2)}function $Ie(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t[4]=e[4]+i[4],t[5]=e[5]+i[5],t[6]=e[6]+i[6],t[7]=e[7]+i[7],t[8]=e[8]+i[8],t[9]=e[9]+i[9],t[10]=e[10]+i[10],t[11]=e[11]+i[11],t[12]=e[12]+i[12],t[13]=e[13]+i[13],t[14]=e[14]+i[14],t[15]=e[15]+i[15],t}function yne(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t[4]=e[4]-i[4],t[5]=e[5]-i[5],t[6]=e[6]-i[6],t[7]=e[7]-i[7],t[8]=e[8]-i[8],t[9]=e[9]-i[9],t[10]=e[10]-i[10],t[11]=e[11]-i[11],t[12]=e[12]-i[12],t[13]=e[13]-i[13],t[14]=e[14]-i[14],t[15]=e[15]-i[15],t}function PIe(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*i,t[9]=e[9]*i,t[10]=e[10]*i,t[11]=e[11]*i,t[12]=e[12]*i,t[13]=e[13]*i,t[14]=e[14]*i,t[15]=e[15]*i,t}function kIe(t,e,i,n){return t[0]=e[0]+i[0]*n,t[1]=e[1]+i[1]*n,t[2]=e[2]+i[2]*n,t[3]=e[3]+i[3]*n,t[4]=e[4]+i[4]*n,t[5]=e[5]+i[5]*n,t[6]=e[6]+i[6]*n,t[7]=e[7]+i[7]*n,t[8]=e[8]+i[8]*n,t[9]=e[9]+i[9]*n,t[10]=e[10]+i[10]*n,t[11]=e[11]+i[11]*n,t[12]=e[12]+i[12]*n,t[13]=e[13]+i[13]*n,t[14]=e[14]+i[14]*n,t[15]=e[15]+i[15]*n,t}function OIe(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function LIe(t,e){if(t===e)return!0;const i=t[0],n=t[1],r=t[2],s=t[3],o=t[4],a=t[5],l=t[6],c=t[7],u=t[8],d=t[9],f=t[10],m=t[11],g=t[12],y=t[13],_=t[14],b=t[15],w=e[0],x=e[1],S=e[2],T=e[3],I=e[4],C=e[5],M=e[6],E=e[7],A=e[8],$=e[9],L=e[10],D=e[11],F=e[12],z=e[13],U=e[14],G=e[15],W=so();return Math.abs(i-w)<=W*Math.max(1,Math.abs(i),Math.abs(w))&&Math.abs(n-x)<=W*Math.max(1,Math.abs(n),Math.abs(x))&&Math.abs(r-S)<=W*Math.max(1,Math.abs(r),Math.abs(S))&&Math.abs(s-T)<=W*Math.max(1,Math.abs(s),Math.abs(T))&&Math.abs(o-I)<=W*Math.max(1,Math.abs(o),Math.abs(I))&&Math.abs(a-C)<=W*Math.max(1,Math.abs(a),Math.abs(C))&&Math.abs(l-M)<=W*Math.max(1,Math.abs(l),Math.abs(M))&&Math.abs(c-E)<=W*Math.max(1,Math.abs(c),Math.abs(E))&&Math.abs(u-A)<=W*Math.max(1,Math.abs(u),Math.abs(A))&&Math.abs(d-$)<=W*Math.max(1,Math.abs(d),Math.abs($))&&Math.abs(f-L)<=W*Math.max(1,Math.abs(f),Math.abs(L))&&Math.abs(m-D)<=W*Math.max(1,Math.abs(m),Math.abs(D))&&Math.abs(g-F)<=W*Math.max(1,Math.abs(g),Math.abs(F))&&Math.abs(y-z)<=W*Math.max(1,Math.abs(y),Math.abs(z))&&Math.abs(_-U)<=W*Math.max(1,Math.abs(_),Math.abs(U))&&Math.abs(b-G)<=W*Math.max(1,Math.abs(b),Math.abs(G))}function RIe(t){const e=so(),i=t[0],n=t[1],r=t[2],s=t[4],o=t[5],a=t[6],l=t[8],c=t[9],u=t[10];return Math.abs(1-(i*i+s*s+l*l))<=e&&Math.abs(1-(n*n+o*o+c*c))<=e&&Math.abs(1-(r*r+a*a+u*u))<=e}function DIe(t){return t[0]===1&&t[1]===0&&t[2]===0&&t[4]===0&&t[5]===1&&t[6]===0&&t[8]===0&&t[9]===0&&t[10]===1}const NIe=fV,FIe=yne;Object.freeze(Object.defineProperty({__proto__:null,add:$Ie,adjoint:iIe,copy:U2,determinant:nIe,equals:LIe,exactEquals:OIe,frob:AIe,fromQuat:wIe,fromQuat2:fIe,fromRotation:mV,fromRotationTranslation:gne,fromRotationTranslationScale:_Ie,fromRotationTranslationScaleOrigin:bIe,fromScaling:uIe,fromTranslation:mne,fromXRotation:hIe,fromYRotation:dIe,fromZRotation:pIe,frustum:xIe,getRotation:vIe,getScaling:yIe,getTranslation:gIe,hasIdentityRotation:DIe,identity:KS,invert:bP,invertOrIdentity:tIe,isOrthoNormal:RIe,lookAt:CIe,mul:NIe,multiply:fV,multiplyScalar:PIe,multiplyScalarAndAdd:kIe,ortho:IIe,perspective:SIe,perspectiveFromFieldOfView:TIe,rotate:oIe,rotateX:aIe,rotateY:lIe,rotateZ:cIe,scale:sIe,set:Yf,str:EIe,sub:FIe,subtract:yne,targetTo:MIe,translate:rIe,transpose:gl},Symbol.toStringTag,{value:"Module"}));let $3,J=null;function gV(){return!!J}function zIe(){return!!ee("esri-wasm")}function vne(){return $3||($3=Y(()=>import("./pe-wasm-b1391b3d.js"),[],import.meta.url).then(t=>t.p).then(({default:t})=>t({locateFile:e=>xt(`esri/geometry/support/${e}`)})).then(t=>{bne(t)}),$3)}var G2,Pt,pa;(function(t){function e(s,o,a){J.ensureCache.prepare();const l=Ug(a),c=a===l,u=J.ensureFloat64(l),d=J._pe_geog_to_proj(J.getPointer(s),o,u);return d&&Jp(a,o,u,c),d}function i(s,o,a,l){switch(l){case Pt.PE_TRANSFORM_P_TO_G:return n(s,o,a);case Pt.PE_TRANSFORM_G_TO_P:return e(s,o,a)}return 0}function n(s,o,a){return r(s,o,a,0)}function r(s,o,a,l){J.ensureCache.prepare();const c=Ug(a),u=a===c,d=J.ensureFloat64(c),f=J._pe_proj_to_geog_center(J.getPointer(s),o,d,l);return f&&Jp(a,o,d,u),f}t.geogToProj=e,t.projGeog=i,t.projToGeog=n,t.projToGeogCenter=r})(G2||(G2={})),function(t){function e(){t.PE_BUFFER_MAX=J.PeDefs.prototype.PE_BUFFER_MAX,t.PE_NAME_MAX=J.PeDefs.prototype.PE_NAME_MAX,t.PE_MGRS_MAX=J.PeDefs.prototype.PE_MGRS_MAX,t.PE_USNG_MAX=J.PeDefs.prototype.PE_USNG_MAX,t.PE_DD_MAX=J.PeDefs.prototype.PE_DD_MAX,t.PE_DDM_MAX=J.PeDefs.prototype.PE_DDM_MAX,t.PE_DMS_MAX=J.PeDefs.prototype.PE_DMS_MAX,t.PE_UTM_MAX=J.PeDefs.prototype.PE_UTM_MAX,t.PE_PARM_MAX=J.PeDefs.prototype.PE_PARM_MAX,t.PE_TYPE_NONE=J.PeDefs.prototype.PE_TYPE_NONE,t.PE_TYPE_GEOGCS=J.PeDefs.prototype.PE_TYPE_GEOGCS,t.PE_TYPE_PROJCS=J.PeDefs.prototype.PE_TYPE_PROJCS,t.PE_TYPE_GEOGTRAN=J.PeDefs.prototype.PE_TYPE_GEOGTRAN,t.PE_TYPE_COORDSYS=J.PeDefs.prototype.PE_TYPE_COORDSYS,t.PE_TYPE_UNIT=J.PeDefs.prototype.PE_TYPE_UNIT,t.PE_TYPE_LINUNIT=J.PeDefs.prototype.PE_TYPE_LINUNIT,t.PE_STR_OPTS_NONE=J.PeDefs.prototype.PE_STR_OPTS_NONE,t.PE_STR_AUTH_NONE=J.PeDefs.prototype.PE_STR_AUTH_NONE,t.PE_STR_AUTH_TOP=J.PeDefs.prototype.PE_STR_AUTH_TOP,t.PE_STR_NAME_CANON=J.PeDefs.prototype.PE_STR_NAME_CANON,t.PE_PARM_X0=J.PeDefs.prototype.PE_PARM_X0,t.PE_PARM_ND=J.PeDefs.prototype.PE_PARM_ND,t.PE_TRANSFORM_1_TO_2=J.PeDefs.prototype.PE_TRANSFORM_1_TO_2,t.PE_TRANSFORM_2_TO_1=J.PeDefs.prototype.PE_TRANSFORM_2_TO_1,t.PE_TRANSFORM_P_TO_G=J.PeDefs.prototype.PE_TRANSFORM_P_TO_G,t.PE_TRANSFORM_G_TO_P=J.PeDefs.prototype.PE_TRANSFORM_G_TO_P,t.PE_HORIZON_RECT=J.PeDefs.prototype.PE_HORIZON_RECT,t.PE_HORIZON_POLY=J.PeDefs.prototype.PE_HORIZON_POLY,t.PE_HORIZON_LINE=J.PeDefs.prototype.PE_HORIZON_LINE,t.PE_HORIZON_DELTA=J.PeDefs.prototype.PE_HORIZON_DELTA}t.init=e}(Pt||(Pt={})),function(t){const e={},i={},n=m=>{if(m){const g=m.getType();switch(g){case Pt.PE_TYPE_GEOGCS:m=J.castObject(m,J.PeGeogcs);break;case Pt.PE_TYPE_PROJCS:m=J.castObject(m,J.PeProjcs);break;case Pt.PE_TYPE_GEOGTRAN:m=J.castObject(m,J.PeGeogtran);break;default:g&Pt.PE_TYPE_UNIT&&(m=J.castObject(m,J.PeUnit))}}return m};function r(){J.PeFactory.prototype.initialize(null)}function s(m){return o(Pt.PE_TYPE_COORDSYS,m)}function o(m,g){let y=null,_=e[m];if(_||(_={},e[m]=_),_.hasOwnProperty(String(g)))y=_[g];else{const b=J.PeFactory.prototype.factoryByType(m,g);J.compare(b,J.NULL)||(y=b,_[g]=y)}return y=n(y),y}function a(m,g){let y=null,_=i[m];if(_||(_={},i[m]=_),_.hasOwnProperty(g))y=_[g];else{const b=J.PeFactory.prototype.fromString(m,g);J.compare(b,J.NULL)||(y=b,_[g]=y)}return y=n(y),y}function l(m){return o(Pt.PE_TYPE_GEOGCS,m)}function c(m){return o(Pt.PE_TYPE_GEOGTRAN,m)}function u(m){return J.PeFactory.prototype.getCode(m)}function d(m){return o(Pt.PE_TYPE_PROJCS,m)}function f(m){return o(Pt.PE_TYPE_UNIT,m)}t.initialize=r,t.coordsys=s,t.factoryByType=o,t.fromString=a,t.geogcs=l,t.geogtran=c,t.getCode=u,t.projcs=d,t.unit=f}(pa||(pa={}));let _ne=null;var dA,Y5,pA,X5,fA,K5,mA,H2,Q5;function bne(t){function e(s,o,a){s[o]=a(s[o])}J=t,Pt.init(),dA.init(),fA.init(),mA.init(),H2.init(),_ne=class extends J.PeGCSExtent{destroy(){J.destroy(this)}};const i=[J.PeDatum,J.PeGeogcs,J.PeGeogtran,J.PeObject,J.PeParameter,J.PePrimem,J.PeProjcs,J.PeSpheroid,J.PeUnit];for(const s of i)e(s.prototype,"getName",o=>function(){return o.call(this,new Array(Pt.PE_NAME_MAX))});for(const s of[J.PeGeogtran,J.PeProjcs])e(s.prototype,"getParameters",o=>function(){const a=new Array(Pt.PE_PARM_MAX);let l=o.call(this);for(let c=0;c<a.length;c++){const u=J.getValue(l,"*");a[c]=u?J.wrapPointer(u,J.PeParameter):null,l+=Int32Array.BYTES_PER_ELEMENT}return a});e(J.PeHorizon.prototype,"getCoord",s=>function(){const o=this.getSize();if(!o)return null;const a=[];return Jp(a,o,s.call(this)),a}),e(J.PeGTlistExtendedEntry.prototype,"getEntries",s=>{const o=J._pe_getPeGTlistExtendedGTsSize();return function(){let a=null;const l=s.call(this);if(!J.compare(l,J.NULL)){a=[l];const c=this.getSteps();if(c>1){const u=J.getPointer(l);for(let d=1;d<c;d++)a.push(J.wrapPointer(u+o*d,J.PeGTlistExtendedGTs))}}return a}});const n=J._pe_getPeHorizonSize(),r=s=>function(){let o=this._cache;if(o||(o=new Map,this._cache=o),o.has(s))return o.get(s);let a=null;const l=s.call(this);if(!J.compare(l,J.NULL)){a=[l];const c=l.getNump();if(c>1){const u=J.getPointer(l);for(let d=1;d<c;d++)a.push(J.wrapPointer(u+n*d,J.PeHorizon))}}return o.set(s,a),a};e(J.PeProjcs.prototype,"horizonGcsGenerate",r),e(J.PeProjcs.prototype,"horizonPcsGenerate",r),J.PeObject.prototype.toString=function(s=Pt.PE_STR_OPTS_NONE){J.ensureCache.prepare();const o=J.getPointer(this),a=J.ensureInt8(new Array(Pt.PE_BUFFER_MAX));return J.UTF8ToString(J._pe_object_to_string_ext(o,s,a))}}function Uu(t){if(!t)return;const e=J.getClass(t);if(!e)return;const i=J.getCache(e);if(!i)return;const n=J.getPointer(t);n&&delete i[n]}function rI(t,e){const i=[],n=new Array(e);for(let r=0;r<t;r++)i.push(J.ensureInt8(n));return i}function Ug(t){let e;return Array.isArray(t[0])?(e=[],t.forEach(i=>{e.push(i[0],i[1])})):e=t,e}function Jp(t,e,i,n=!1){if(n)for(let r=0;r<2*e;r++)t[r]=J.getValue(i+r*Float64Array.BYTES_PER_ELEMENT,"double");else{const r=t.length===0;for(let s=0;s<e;s++)r&&(t[s]=new Array(2)),t[s][0]=J.getValue(i,"double"),t[s][1]=J.getValue(i+Float64Array.BYTES_PER_ELEMENT,"double"),i+=2*Float64Array.BYTES_PER_ELEMENT}}(function(t){let e;function i(){t.PE_GTLIST_OPTS_COMMON=J.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON,e=J._pe_getPeGTlistExtendedEntrySize()}function n(r,s,o,a,l,c){let u=null;const d=new J.PeInteger(c);try{const f=J.PeGTlistExtended.prototype.getGTlist(r,s,o,a,l,d);if((c=d.val)&&(u=[f],c>1)){const m=J.getPointer(f);for(let g=1;g<c;g++)u.push(J.wrapPointer(m+e*g,J.PeGTlistExtendedEntry))}}finally{J.destroy(d)}return u}t.init=i,t.getGTlist=n})(dA||(dA={})),function(t){function e(i){if(i&&i.length){for(const n of i)Uu(n),n.getEntries().forEach(r=>{Uu(r);const s=r.getGeogtran();Uu(s),s.getParameters().forEach(Uu),[s.getGeogcs1(),s.getGeogcs2()].forEach(o=>{Uu(o);const a=o.getDatum();Uu(a),Uu(a.getSpheroid()),Uu(o.getPrimem()),Uu(o.getUnit())})});J.PeGTlistExtendedEntry.prototype.Delete(i[0])}}t.destroy=e}(Y5||(Y5={})),function(t){function e(i,n,r,s,o){J.ensureCache.prepare();const a=Ug(r),l=r===a,c=J.ensureFloat64(a);let u=0;s&&(u=J.ensureFloat64(s));const d=J._pe_geog_to_geog(J.getPointer(i),n,c,u,o);return d&&Jp(r,n,c,l),d}t.geogToGeog=e}(pA||(pA={})),function(t){const e=(c,u,d,f,m,g)=>{let y,_;switch(J.ensureCache.prepare(),c){case"dd":y=J._pe_geog_to_dd,_=Pt.PE_DD_MAX;break;case"ddm":y=J._pe_geog_to_ddm,_=Pt.PE_DDM_MAX;break;case"dms":y=J._pe_geog_to_dms,_=Pt.PE_DMS_MAX}let b=0;u&&(b=J.getPointer(u));const w=Ug(f),x=J.ensureFloat64(w),S=rI(d,_),T=y(b,d,x,m,J.ensureInt32(S));if(T)for(let I=0;I<d;I++)g[I]=J.UTF8ToString(S[I]);return T},i=(c,u,d,f,m)=>{let g;switch(J.ensureCache.prepare(),c){case"dd":g=J._pe_dd_to_geog;break;case"ddm":g=J._pe_ddm_to_geog;break;case"dms":g=J._pe_dms_to_geog}let y=0;u&&(y=J.getPointer(u));const _=f.map(S=>J.ensureString(S)),b=J.ensureInt32(_),w=J.ensureFloat64(new Array(2*d)),x=g(y,d,b,w);return x&&Jp(m,d,w),x};function n(c,u,d,f,m){return e("dms",c,u,d,f,m)}function r(c,u,d,f){return i("dms",c,u,d,f)}function s(c,u,d,f,m){return e("ddm",c,u,d,f,m)}function o(c,u,d,f){return i("ddm",c,u,d,f)}function a(c,u,d,f,m){return e("dd",c,u,d,f,m)}function l(c,u,d,f){return i("dd",c,u,d,f)}t.geogToDms=n,t.dmsToGeog=r,t.geogToDdm=s,t.ddmToGeog=o,t.geogToDd=a,t.ddToGeog=l}(X5||(X5={})),function(t){function e(){t.PE_MGRS_STYLE_NEW=J.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW,t.PE_MGRS_STYLE_OLD=J.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD,t.PE_MGRS_STYLE_AUTO=J.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO,t.PE_MGRS_180_ZONE_1_PLUS=J.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS,t.PE_MGRS_ADD_SPACES=J.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES}function i(r,s,o,a,l,c,u){J.ensureCache.prepare();let d=0;r&&(d=J.getPointer(r));const f=Ug(o),m=J.ensureFloat64(f),g=rI(s,Pt.PE_MGRS_MAX),y=J.ensureInt32(g),_=J._pe_geog_to_mgrs_extended(d,s,m,a,l,c,y);if(_)for(let b=0;b<s;b++)u[b]=J.UTF8ToString(g[b]);return _}function n(r,s,o,a,l){J.ensureCache.prepare();let c=0;r&&(c=J.getPointer(r));const u=o.map(g=>J.ensureString(g)),d=J.ensureInt32(u),f=J.ensureFloat64(new Array(2*s)),m=J._pe_mgrs_to_geog_extended(c,s,d,a,f);return m&&Jp(l,s,f),m}t.init=e,t.geogToMgrsExtended=i,t.mgrsToGeogExtended=n}(fA||(fA={})),function(t){function e(n,r,s,o,a,l,c){J.ensureCache.prepare();let u=0;n&&(u=J.getPointer(n));const d=Ug(s),f=J.ensureFloat64(d),m=rI(r,Pt.PE_MGRS_MAX),g=J.ensureInt32(m),y=J._pe_geog_to_usng(u,r,f,o,a,l,g);if(y)for(let _=0;_<r;_++)c[_]=J.UTF8ToString(m[_]);return y}function i(n,r,s,o){J.ensureCache.prepare();let a=0;n&&(a=J.getPointer(n));const l=s.map(f=>J.ensureString(f)),c=J.ensureInt32(l),u=J.ensureFloat64(new Array(2*r)),d=J._pe_usng_to_geog(a,r,c,u);return d&&Jp(o,r,u),d}t.geogToUsng=e,t.usngToGeog=i}(K5||(K5={})),function(t){function e(){t.PE_UTM_OPTS_NONE=J.PeNotationUtm.prototype.PE_UTM_OPTS_NONE,t.PE_UTM_OPTS_ADD_SPACES=J.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES,t.PE_UTM_OPTS_NS=J.PeNotationUtm.prototype.PE_UTM_OPTS_NS}function i(r,s,o,a,l){J.ensureCache.prepare();let c=0;r&&(c=J.getPointer(r));const u=Ug(o),d=J.ensureFloat64(u),f=rI(s,Pt.PE_UTM_MAX),m=J.ensureInt32(f),g=J._pe_geog_to_utm(c,s,d,a,m);if(g)for(let y=0;y<s;y++)l[y]=J.UTF8ToString(f[y]);return g}function n(r,s,o,a,l){J.ensureCache.prepare();let c=0;r&&(c=J.getPointer(r));const u=o.map(g=>J.ensureString(g)),d=J.ensureInt32(u),f=J.ensureFloat64(new Array(2*s)),m=J._pe_utm_to_geog(c,s,d,a,f);return m&&Jp(l,s,f),m}t.init=e,t.geogToUtm=i,t.utmToGeog=n}(mA||(mA={})),function(t){const e=new Map;function i(){t.PE_PCSINFO_OPTION_NONE=J.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE,t.PE_PCSINFO_OPTION_DOMAIN=J.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN,t.PE_POLE_OUTSIDE_BOUNDARY=J.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY,t.PE_POLE_POINT=J.PePCSInfo.prototype.PE_POLE_POINT}function n(r,s=t.PE_PCSINFO_OPTION_DOMAIN){let o=null,a=null;return e.has(r)&&(a=e.get(r),a[s]&&(o=a[s])),o||(o=J.PePCSInfo.prototype.generate(r,s),a||(a=[],e.set(r,a)),a[s]=o),o}t.init=i,t.generate=n}(H2||(H2={})),function(t){function e(){return J.PeVersion.prototype.version_string()}t.versionString=e}(Q5||(Q5={}));const VIe=Object.freeze(Object.defineProperty({__proto__:null,get PeCSTransformations(){return G2},get PeDefs(){return Pt},get PeFactory(){return pa},get PeGCSExtent(){return _ne},get PeGTTransformations(){return pA},get PeGTlistExtended(){return dA},get PeGTlistExtendedEntry(){return Y5},get PeNotationDms(){return X5},get PeNotationMgrs(){return fA},get PeNotationUsng(){return K5},get PeNotationUtm(){return mA},get PePCSInfo(){return H2},get PeVersion(){return Q5},_init:bne,get _pe(){return J},isLoaded:gV,isSupported:zIe,load:vne},Symbol.toStringTag,{value:"Module"})),Eo=Math.PI/180,jIe=/SPHEROID\[([^\]]+)]/i,Dd=ci.radius,$l=ci.eccentricitySquared,BIe={a1:Dd*$l,a2:Dd*$l*Dd*$l,a3:Dd*$l*$l/2,a4:Dd*$l*Dd*$l*2.5,a5:Dd*$l+Dd*$l*$l/2,a6:1-$l},UIe={4267:{a:63782064e-1,f:1/294.9786982},4269:{a:6378137,f:1/298.257222101},4326:{a:ci.radius,f:ci.flattening},104900:{a:2439700,f:0},104901:{a:6051e3,f:0},104902:{a:6051800,f:0},104903:{a:Lf.radius,f:Lf.flattening},104904:{a:3393400,f:1/192.0430107526882},104905:{a:Hh.radius,f:Hh.flattening},104906:{a:6200,f:0},104907:{a:11100,f:0},104908:{a:71492e3,f:.06487439154031222},104909:{a:8200,f:0},104910:{a:83500,f:0},104911:{a:1e4,f:0},104912:{a:2409300,f:0},104913:{a:15e3,f:0},104914:{a:4e4,f:0},104915:{a:1562090,f:0},104916:{a:2632345,f:0},104917:{a:85e3,f:0},104918:{a:1821460,f:0},104919:{a:5e3,f:0},104920:{a:12e3,f:0},104921:{a:3e4,f:3},104922:{a:18e3,f:0},104923:{a:14e3,f:0},104924:{a:49300,f:0},104925:{a:60268e3,f:1/10.2079945799458},104926:{a:16e3,f:0},104927:{a:9500,f:0},104928:{a:56e4,f:0},104929:{a:249400,f:0},104930:{a:59500,f:0},104931:{a:16e3,f:0},104932:{a:133e3,f:0},104933:{a:718e3,f:0},104934:{a:888e3,f:0},104935:{a:1986300,f:0},104936:{a:1e4,f:0},104937:{a:41900,f:0},104938:{a:11e4,f:0},104939:{a:50100,f:0},104940:{a:764e3,f:0},104941:{a:11e3,f:0},104942:{a:529800,f:0},104943:{a:2575e3,f:0},104944:{a:25559e3,f:1/43.61604095563141},104945:{a:578900,f:0},104946:{a:33e3,f:0},104947:{a:21e3,f:0},104948:{a:13e3,f:0},104949:{a:31e3,f:0},104950:{a:27e3,f:0},104951:{a:42e3,f:0},104952:{a:235800,f:0},104953:{a:761400,f:0},104954:{a:15e3,f:0},104955:{a:54e3,f:0},104956:{a:77e3,f:0},104957:{a:27e3,f:0},104958:{a:788900,f:0},104959:{a:584700,f:0},104960:{a:24764e3,f:.01708124697141011},104961:{a:74e3,f:0},104962:{a:79e3,f:0},104963:{a:104e3,f:.14423076923076922},104964:{a:29e3,f:0},104965:{a:17e4,f:0},104966:{a:208e3,f:0},104967:{a:4e4,f:0},104968:{a:1352600,f:0},104969:{a:1195e3,f:0},104970:{a:593e3,f:0},104971:{a:Hh.radius,f:0},104972:{a:47e4,f:0},104973:{a:255e3,f:0},104974:{a:2439400,f:0}};let sI=0,P3=class eD{static fromGE(e){const i=new eD;return i._wkt=e.wkt,i._wkid=e.wkid,i._isInverse=e.isInverse,i}constructor(e){this.uid=sI++,e?(this._wkt=e.wkt!=null?e.wkt:null,this._wkid=e.wkid!=null?e.wkid:-1,this._isInverse=e.isInverse!=null&&e.isInverse===!0):(this._wkt=null,this._wkid=-1,this._isInverse=!1)}get wkt(){return this._wkt}set wkt(e){this._wkt=e,this.uid=sI++}get wkid(){return this._wkid}set wkid(e){this._wkid=e,this.uid=sI++}get isInverse(){return this._isInverse}set isInverse(e){this._isInverse=e,this.uid=sI++}getInverse(){const e=new eD;return e._wkt=this.wkt,e._wkid=this._wkid,e._isInverse=!this.isInverse,e}},gA=class Ow{static cacheKey(e,i){return[e.wkid!==void 0&&e.wkid!==null?e.wkid.toString():"-1",e.wkt!==void 0&&e.wkt!==null?e.wkt.toString():"",i.wkid!==void 0&&i.wkid!==null?i.wkid.toString():"-1",i.wkt!==void 0&&i.wkt!==null?i.wkt.toString():""].join(",")}static fromGE(e){const i=new Ow;let n="";for(const r of e.steps){const s=P3.fromGE(r);i.steps.push(s),n+=s.uid.toString()+","}return i._cachedProjection={},i._gtlistentry=null,i._chain=n,i}constructor(e){if(this.steps=[],this._cachedProjection={},this._chain="",this._gtlistentry=null,e&&e.steps)for(const i of e.steps)i instanceof P3?this.steps.push(i):this.steps.push(new P3({wkid:i.wkid,wkt:i.wkt,isInverse:i.isInverse}))}getInverse(){const e=new Ow;e.steps=[];for(let i=this.steps.length-1;i>=0;i--){const n=this.steps[i];e.steps.push(n.getInverse())}return e}getGTListEntry(){let e="";for(const i of this.steps)e+=i.uid.toString()+",";return e!==this._chain&&(this._gtlistentry=null,this._cachedProjection={},this._chain=e),this._gtlistentry}assignCachedGe(e,i,n){this._cachedProjection[Ow.cacheKey(e,i)]=n}getCachedGeTransformation(e,i){let n="";for(const s of this.steps)n+=s.uid.toString()+",";n!==this._chain&&(this._gtlistentry=null,this._cachedProjection={},this._chain=n);const r=this._cachedProjection[Ow.cacheKey(e,i)];return r===void 0?null:r}};function GIe(t,e,i){if(e==null||i==null||i.vcsWkid||En(e,i))return null;const n=sd(e)/sd(i);if(n===1)return null;switch(t){case"point":case"esriGeometryPoint":return r=>HIe(r,n);case"polyline":case"esriGeometryPolyline":return r=>WIe(r,n);case"polygon":case"esriGeometryPolygon":return r=>qIe(r,n);case"multipoint":case"esriGeometryMultipoint":return r=>JIe(r,n);case"extent":case"esriGeometryEnvelope":return r=>ZIe(r,n);default:return null}}function HIe(t,e){t&&t.z!=null&&(t.z*=e)}function qIe(t,e){if(t)for(const i of t.rings)for(const n of i)n.length>2&&(n[2]*=e)}function WIe(t,e){if(t)for(const i of t.paths)for(const n of i)n.length>2&&(n[2]*=e)}function JIe(t,e){if(t)for(const i of t.points)i.length>2&&(i[2]*=e)}function ZIe(t,e){t&&t.zmin!=null&&t.zmax!=null&&(t.zmin*=e,t.zmax*=e)}let yc=null,Nf=null,Vx=null,SM={};const wne=new X$;function wl(){return!!yc&&gV()}function Ic(t){return Vx==null&&(Vx=Promise.all([vne(),Y(()=>import("./geometryEngineBase-5d80acc4.js"),[],import.meta.url).then(e=>e.g),Y(()=>import("./hydrated-dd8bf351.js"),[],import.meta.url)])),Vx.then(([,e,{hydratedAdapter:i}])=>{Vt(t),Nf=i,yc=e.default,yc._enableProjection(VIe),wne.notify()})}function an(t,e,i=null,n=null){return Array.isArray(t)?t.length===0?[]:tD(Nf,t,t[0].spatialReference,e,i,n):tD(Nf,[t],t.spatialReference,e,i,n)[0]}function tD(t,e,i,n,r=null,s=null){if(i==null||n==null)return e;if(yl(i,n,r))return e.map(o=>Tne(o,i,n));if(r==null){const o=gA.cacheKey(i,n);SM[o]!==void 0?r=SM[o]:((r=yA(i,n,void 0))==null&&(r=new gA),SM[o]=r)}if(yc==null||t==null)throw new wP;return s!=null?yc._project(t,e,i,n,r,s):yc._project(t,e,i,n,r)}function YIe(t,e){const i=xne([t],e);return i.pending!=null?{pending:i.pending,geometry:null}:i.geometries!=null?{pending:null,geometry:i.geometries[0]}:{pending:null,geometry:null}}function xne(t,e){if(!wl()){for(const i of t)if(i!=null&&!En(i.spatialReference,e)&&Nr(i.spatialReference)&&Nr(e)&&!yl(i.spatialReference,e))return We(wne),{pending:Ic(),geometries:null}}return{pending:null,geometries:t.map(i=>i==null?null:En(i.spatialReference,e)?i:Nr(i.spatialReference)&&Nr(e)?Sne(i,e):null)}}function yA(t,e,i=null){if(t==null||e==null)return null;if(yc==null||Nf==null)throw new wP;const n=yc._getTransformation(Nf,t,e,i,i==null?void 0:i.spatialReference);return n!==null?gA.fromGE(n):null}function XIe(t,e,i=null){if(yc==null||Nf==null)throw new wP;const n=yc._getTransformationBySuitability(Nf,t,e,i,i==null?void 0:i.spatialReference);if(n!==null){const r=[];for(const s of n)r.push(gA.fromGE(s));return r}return[]}let wP=class extends V{constructor(){super("projection:not-loaded","projection engine not fully loaded yet, please call load()")}};var B;function KIe(){yc=null,Nf=null,Vx=null,SM={}}(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.SPHERICAL_ECEF=1]="SPHERICAL_ECEF",t[t.WGS84=2]="WGS84",t[t.WEB_MERCATOR=3]="WEB_MERCATOR",t[t.WGS84_ECEF=4]="WGS84_ECEF",t[t.CGCS2000=5]="CGCS2000",t[t.WGS84_COMPARABLE_LON_LAT=6]="WGS84_COMPARABLE_LON_LAT",t[t.SPHERICAL_MARS_PCPF=7]="SPHERICAL_MARS_PCPF",t[t.GCSMARS2000=8]="GCSMARS2000",t[t.SPHERICAL_MOON_PCPF=9]="SPHERICAL_MOON_PCPF",t[t.GCSMOON2000=10]="GCSMOON2000",t[t.LON_LAT=11]="LON_LAT",t[t.PLATE_CARREE=12]="PLATE_CARREE"})(B||(B={}));const QIe={get loadPromise(){return Vx}};function Sne(t,e){try{const i=an(t,e);if(i==null)return null;"xmin"in t&&"xmin"in i&&(i.zmin=t.zmin,i.zmax=t.zmax);const n=GIe(i.type,t.spatialReference,e);return n!=null&&n(i),i}catch(i){if(!(i instanceof wP))throw i;return null}}function yl(t,e,i){return!i&&(!!En(t,e)||Nr(t)&&Nr(e)&&!!_V(t,e,wV))}async function Ff(t,e,i,n){if(wl())return ZB(n);if(Array.isArray(t)){for(const{source:r,dest:s,geographicTransformation:o}of t)if(!yl(r,s,o))return Ic(n)}else if(!yl(t,e,i))return Ic(n);return ZB(n)}function eCe(t,e){switch(_V(t,e,wV)){case ei:return"copy3";case of:return"wgs84ToSphericalECEF";case zy:return"wgs84ToWebMercator";case sf:return"wgs84ToPlateCarree";case lf:return"wgs84ToWGS84ECEF";case yy:return"webMercatorToWGS84";case One:return"webMercatorToSphericalECEF";case Lne:return"webMercatorToWGS84ECEF";case Dne:return"webMercatorToPlateCarree";case cf:return"wgs84ECEFToWGS84";case zne:return"wgs84ECEFToSphericalECEF";case Vne:return"wgs84ECEFToWebMercator";case af:return"sphericalECEFToWGS84";case Nne:return"sphericalECEFToWebMercator";case aD:return"sphericalMarsPCPFToMars2000";case oD:return"sphericalMoonPCPFToMoon2000";case Fne:return"sphericalECEFToWGS84ECEF";case sD:return"mars2000ToSphericalPCPF";case rD:return"moon2000ToSphericalPCPF";default:return null}}function Tne(t,e,i){return t?"x"in t?Ine(t,e,new pe,i,0):"xmin"in t?Ane(t,e,new Le,i,0):"rings"in t?Ene(t,e,new Vr,i,0):"paths"in t?Mne(t,e,new Ms,i,0):"points"in t?Cne(t,e,new Cf,i,0):null:null}function tCe(t,e,i=e.spatialReference,n=0){return i!=null&&t.spatialReference!=null&&Ine(t,t.spatialReference,e,i,n)!=null}function Ine(t,e,i,n,r){mt[0]=t.x,mt[1]=t.y;const s=t.z;return mt[2]=s!==void 0?s:r,Cc(mt,e,0,mt,n,0,1)?(i.x=mt[0],i.y=mt[1],i.spatialReference=n,s===void 0?(i.z=void 0,i.hasZ=!1):(i.z=mt[2],i.hasZ=!0),t.m===void 0?(i.m=void 0,i.hasM=!1):(i.m=t.m,i.hasM=!0),i):null}function iCe(t,e,i=e.spatialReference,n=0){return t.spatialReference!=null&&i!=null&&Cne(t,t.spatialReference,e,i,n)!=null}function Cne(t,e,i,n,r){const{points:s,hasZ:o,hasM:a}=t,l=[],c=s.length,u=[];for(const d of s)u.push(d[0],d[1],o?d[2]:r);if(!Cc(u,e,0,u,n,0,c))return null;for(let d=0;d<c;++d){const f=3*d,m=u[f],g=u[f+1];o&&a?l.push([m,g,u[f+2],s[d][3]]):o?l.push([m,g,u[f+2]]):a?l.push([m,g,s[d][2]]):l.push([m,g])}return i.points=l,i.spatialReference=n,i.hasZ=o,i.hasM=a,i}function nCe(t,e,i=e.spatialReference,n=0){return t.spatialReference!=null&&i!=null&&Mne(t,t.spatialReference,e,i,n)!=null}function Mne(t,e,i,n,r){const{paths:s,hasZ:o,hasM:a}=t,l=[];return Pne(s,o??!1,a??!1,e,l,n,r)?(i.paths=l,i.spatialReference=n,i.hasZ=o,i.hasM=a,i):null}function rCe({hasZ:t,spatialReference:e,paths:i},n,r=0){const s=Du(e,Wb),o=rl[s][B.WGS84_COMPARABLE_LON_LAT];if(o==null)return!1;const a=t?l=>l:l=>Di(mt,l[0],l[1],r);for(const l of i){const c=[];for(const u of l){const d=[0,0,r];o(a(u),0,d,0),c.push(d)}n.push(c)}return!0}function sCe({hasZ:t,spatialReference:e,rings:i},n,r=0){const s=Du(e,Wb),o=rl[s][B.WGS84_COMPARABLE_LON_LAT];if(o==null)return!1;const a=t?l=>l:l=>Di(mt,l[0],l[1],r);for(const l of i){const c=[];for(const u of l){const d=[0,0,r];o(a(u),0,d,0),c.push(d)}n.push(c)}return!0}function oCe(t,e,i=e.spatialReference,n=0){return t.spatialReference!=null&&i!=null&&Ene(t,t.spatialReference,e,i,n)!=null}function Ene(t,e,i,n,r){const{rings:s,hasZ:o,hasM:a}=t,l=[];return Pne(s,o??!1,a??!1,e,l,n,r)?(i.rings=l,i.spatialReference=n,i.hasZ=o,i.hasM=a,i):null}function aCe(t,e,i=e.spatialReference,n=0){return t.spatialReference!=null&&i!=null&&Ane(t,t.spatialReference,e,i,n)!=null}function Ane(t,e,i,n,r){const{xmin:s,ymin:o,xmax:a,ymax:l,hasZ:c,hasM:u}=t;return iD(s,o,c?t.zmin:r,e,mt,n)?(i.xmin=mt[0],i.ymin=mt[1],c&&(i.zmin=mt[2]),iD(a,l,c?t.zmax:r,e,mt,n)?(i.xmax=mt[0],i.ymax=mt[1],c&&(i.zmax=mt[2]),u&&(i.mmin=t.mmin,i.mmax=t.mmax),i.spatialReference=n,i):null):null}function lCe(t,e,i){if(e==null||i==null)return null;const n=new pe({spatialReference:i});return Cc(t,e,0,mt,i,0,1)?(n.x=mt[0],n.y=mt[1],n.z=mt[2],n):null}function cCe(t,e,i){return Cc(t,e,0,mt,i.spatialReference,0,1)?(i.x=mt[0],i.y=mt[1],i.z=mt[2],i):null}function uCe(t,e,i,n=0){mt[0]=t.x,mt[1]=t.y;const r=t.z;return mt[2]=r!==void 0?r:n,Cc(mt,t.spatialReference,0,e,i,0,1)}function iD(t,e,i,n,r,s){return Si[0]=t,Si[1]=e,Si[2]=i,Cc(Si,n,0,r,s,0,1)}function nD(t,e,i,n){return!(e==null||n==null||t.length<2)&&(t.length===2&&(Si[0]=t[0],Si[1]=t[1],Si[2]=0,t=Si),Cc(t,e,0,i,n,0,1))}function hCe(t,e){mt[0]=t.x,mt[1]=t.y;const i=t.z;return mt[2]=i!==void 0?i:0,$ne(mt,t.spatialReference,e)}function $ne(t,e,i){return dCe(t,e,i)}function dCe(t,e,i){if(e==null)return!1;const n=Du(e,Wb),r=rl[n][B.WGS84_COMPARABLE_LON_LAT];return r!=null&&(r(t,0,Si,0),i!==Si&&(i[0]=Si[0],i[1]=Si[1],i.length>2&&(i[2]=Si[2])),!0)}function Cc(t,e,i,n,r,s,o=1){const a=_V(e,r,wV);if(a==null)return!1;if(a===ei){if(t===n&&i===s)return!0;const c=i+3*o;for(let u=i,d=s;u<c;u++,d++)n[d]=t[u];return!0}const l=i+3*o;for(let c=i,u=s;c<l;c+=3,u+=3)a(t,c,n,u);return!0}function pCe(t,e,i,n,r){ri(mt,t),sn(oI,t,e),nD(mt,i,mt,r),nD(oI,i,oI,r),Ii(n,oI,mt),ss(n,n)}function Pne(t,e,i,n,r,s,o=0){const a=new Array;for(const c of t)for(const u of c)a.push(u[0],u[1],e?u[2]:o);if(!Cc(a,n,0,a,s,0,a.length/3))return!1;let l=0;r.length=0;for(const c of t){const u=new Array;for(const d of c)e&&i?u.push([a[l++],a[l++],a[l++],d[3]]):e?u.push([a[l++],a[l++],a[l++]]):i?(u.push([a[l++],a[l++],d[2]]),l++):(u.push([a[l++],a[l++]]),l++);r.push(u)}return!0}function fCe(t,e,i,n){if(e==null||n==null)return!1;const r=jne(e,n,CCe);if(r.projector===ei)return i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],!0;if(r.projector==null)return!1;const{source:s,dest:o}=r;if(o.spatialReferenceId===B.WEB_MERCATOR){const a=rl[s.spatialReferenceId][B.WGS84];return a!=null&&(a(t,0,nc,0),zy(nc,0,i,0),i[3]=NU(nc[1],t[2],t[3],ci.radius),!0)}if(s.spatialReferenceId!==B.WGS84&&s.spatialReferenceId!==B.CGCS2000||o.spatialReferenceId!==B.PLATE_CARREE){r.projector(t,0,i,0);const a=s.metersPerUnit??1,l=o.metersPerUnit??1;i[3]=t[3]*a/l}else{const a=rl[s.spatialReferenceId][B.SPHERICAL_ECEF],l=rl[B.SPHERICAL_ECEF][B.PLATE_CARREE];let c=t[3];a!=null&&l!=null&&(c=NU(t[1],t[2],t[3],ci.radius)),r.projector(t,0,i,0),i[3]=c}return!0}function NU(t,e,i,n){const r=n+e;if(r<n/2||i>r)return Number.MAX_VALUE;const s=Math.abs(hc*t)+Math.asin(i/r);return s>=Math.PI/2?Number.MAX_VALUE:i/Math.cos(s)}function mCe(t,e,i,n){return t!=null&&(En(e,n)?(E6(i,t),!0):(Si[0]=t[0],Si[1]=t[1],Si[2]=0,!!Cc(Si,e,0,Si,n,0,1)&&(i[0]=Si[0],i[1]=Si[1],Si[0]=t[2],Si[1]=t[3],Si[2]=0,!!Cc(Si,e,0,Si,n,0,1)&&(i[2]=Si[0],i[3]=Si[1],!0))))}function gCe(t,e,i,n){if(e==null||n==null)return!1;const r=Du(e,Wb),s=Du(n,Bne);if(r===s&&r!==B.UNKNOWN||En(e,n))return i[0]=1,i[1]=1,i[2]=1,!0;if(r===B.SPHERICAL_ECEF){const o=jr(t),a=o/Math.sqrt(t[0]*t[0]+t[1]*t[1]),l=o/ci.radius;if(s===B.WEB_MERCATOR)return i[0]=a*l,i[1]=a*l,i[2]=1,!0;if(s===B.WGS84||s===B.CGCS2000){const c=jx;return i[0]=c*a*l,i[1]=c*l,i[2]=1,!0}}else if(r===B.PLATE_CARREE){if(s===B.WGS84||s===B.CGCS2000)return i[0]=jx,i[1]=jx,i[2]=1,!0;if(s===B.WEB_MERCATOR){const o=t[1]/ci.radius;return i[0]=1,i[1]=1/Math.cos(o),i[2]=1,!0}}return!1}function yCe(t,e,i,n){if(t==null||n==null)return!1;const r=Du(t,Wb),s=Du(n,Bne);if(r===s&&!FU(s)&&(r!==B.UNKNOWN||En(t,n)))return mne(i,e),!0;if(FU(s)){const o=rl[r][B.LON_LAT],a=rl[B.LON_LAT][s];return o!=null&&a!=null&&(o(e,0,nc,0),a(nc,0,Nd,0),yV(hc*nc[0],hc*nc[1],i),i[12]=Nd[0],i[13]=Nd[1],i[14]=Nd[2],!0)}if((s===B.WEB_MERCATOR||s===B.PLATE_CARREE)&&(r===B.WGS84||r===B.CGCS2000&&s===B.PLATE_CARREE||r===B.SPHERICAL_ECEF||r===B.WEB_MERCATOR)){const o=rl[r][B.LON_LAT],a=rl[B.LON_LAT][s];return o!=null&&a!=null&&(o(e,0,nc,0),a(nc,0,Nd,0),r===B.SPHERICAL_ECEF?kne(hc*nc[0],hc*nc[1],i):KS(i),i[12]=Nd[0],i[13]=Nd[1],i[14]=Nd[2],!0)}return!1}function FU(t){return t===B.SPHERICAL_ECEF||t===B.SPHERICAL_MARS_PCPF||t===B.SPHERICAL_MOON_PCPF}function yV(t,e,i){const n=Math.sin(t),r=Math.cos(t),s=Math.sin(e),o=Math.cos(e),a=i;return a[0]=-n,a[4]=-s*r,a[8]=o*r,a[12]=0,a[1]=r,a[5]=-s*n,a[9]=o*n,a[13]=0,a[2]=0,a[6]=o,a[10]=s,a[14]=0,a[3]=0,a[7]=0,a[11]=0,a[15]=1,a}function kne(t,e,i){return yV(t,e,i),gl(i,i),i}function Du(t,e){return t?e.spatialReference===t?e.spatialReferenceId:(e.spatialReference=t,"metersPerUnit"in e&&(e.metersPerUnit=pi(t,1)),t.wkt===Lve.wkt?e.spatialReferenceId=B.SPHERICAL_ECEF:A2(t)?e.spatialReferenceId=B.WGS84:Oy(t)?e.spatialReferenceId=B.WEB_MERCATOR:Ave(t)?e.spatialReferenceId=B.PLATE_CARREE:t.wkt===Rve.wkt?e.spatialReferenceId=B.WGS84_ECEF:t.wkid===ky.CGCS2000?e.spatialReferenceId=B.CGCS2000:t.wkt===_Q.wkt?e.spatialReferenceId=B.SPHERICAL_MARS_PCPF:t.wkt===bQ.wkt?e.spatialReferenceId=B.SPHERICAL_MOON_PCPF:s6(t)?e.spatialReferenceId=B.GCSMARS2000:a6(t)?e.spatialReferenceId=B.GCSMOON2000:e.spatialReferenceId=B.UNKNOWN):B.UNKNOWN}function ei(t,e,i,n){t!==i&&(i[n++]=t[e++],i[n++]=t[e++],i[n]=t[e])}function yy(t,e,i,n){i[n++]=ob*(t[e++]/ci.radius),i[n++]=ob*(Math.PI/2-2*Math.atan(Math.exp(-t[e++]/ci.radius))),i[n]=t[e]}function One(t,e,i,n){yy(t,e,i,n),of(i,n,i,n)}function Lne(t,e,i,n){yy(t,e,i,n),lf(i,n,i,n)}function Rne(t,e,i,n,r){const s=.4999999*Math.PI,o=rr(hc*t[e+1],-s,s),a=Math.sin(o);i[n++]=hc*t[e]*r.radius,i[n++]=r.halfSemiMajorAxis*Math.log((1+a)/(1-a)),i[n]=t[e+2]}function zy(t,e,i,n){Rne(t,e,i,n,ci)}const zU=ci.radius*Math.PI/180,jx=180/(ci.radius*Math.PI);function sf(t,e,i,n){i[n]=t[e]*zU,i[n+1]=t[e+1]*zU,i[n+2]=t[e+2]}function ay(t,e,i,n){i[n]=t[e]*jx,i[n+1]=t[e+1]*jx,i[n+2]=t[e+2]}function Dne(t,e,i,n){yy(t,e,i,n),sf(i,n,i,n)}function vCe(t,e,i,n){cf(t,e,i,n),sf(i,n,i,n)}function _Ce(t,e,i,n){af(t,e,i,n),sf(i,n,i,n)}function bCe(t,e,i,n){ay(t,e,i,n),of(i,n,i,n)}function wCe(t,e,i,n){ay(t,e,i,n),zy(i,n,i,n)}function xCe(t,e,i,n){ay(t,e,i,n),lf(i,n,i,n)}function SCe(t){if(t==null)return!1;const e=Du(t,Wb);return!!rl[e][B.WGS84_COMPARABLE_LON_LAT]}function TCe(t,e,i,n){const r=Math.cos(i);t[0]=Math.cos(e)*r*n,t[1]=Math.sin(e)*r*n,t[2]=Math.sin(i)*n}function vV(t,e,i,n,r){const s=r+t[e+2],o=hc*t[e+1],a=hc*t[e],l=Math.cos(o);i[n++]=Math.cos(a)*l*s,i[n++]=Math.sin(a)*l*s,i[n]=Math.sin(o)*s}function rD(t,e,i,n){vV(t,e,i,n,Lf.radius)}function sD(t,e,i,n){vV(t,e,i,n,Hh.radius)}function of(t,e,i,n){vV(t,e,i,n,ci.radius)}function xP(t,e,i,n,r){const s=t[e],o=t[e+1],a=t[e+2],l=Math.sqrt(s*s+o*o+a*a),c=wee(a/(l===0?1:l)),u=Math.atan2(o,s);i[n++]=ob*u,i[n++]=ob*c,i[n]=l-r}function oD(t,e,i,n){xP(t,e,i,n,Lf.radius)}function aD(t,e,i,n){xP(t,e,i,n,Hh.radius)}function af(t,e,i,n){xP(t,e,i,n,ci.radius)}function Nne(t,e,i,n){af(t,e,i,n),zy(i,n,i,n)}function Fne(t,e,i,n){af(t,e,i,n),lf(i,n,i,n)}function ICe(t,e,i,n,r){const s=hc*t[e],o=hc*t[e+1],a=t[e+2],l=Math.sin(o),c=Math.cos(o),u=r.radius/Math.sqrt(1-r.eccentricitySquared*l*l);i[n++]=(u+a)*c*Math.cos(s),i[n++]=(u+a)*c*Math.sin(s),i[n++]=(u*(1-r.eccentricitySquared)+a)*l}function lf(t,e,i,n){ICe(t,e,i,n,ci)}function cf(t,e,i,n){const r=BIe,s=t[e],o=t[e+1],a=t[e+2];let l,c,u,d,f,m,g,y,_,b,w,x,S,T,I,C,M,E,A,$,L;l=Math.abs(a),c=s*s+o*o,u=Math.sqrt(c),d=c+a*a,f=Math.sqrt(d),$=Math.atan2(o,s),m=a*a/d,g=c/d,T=r.a2/f,I=r.a3-r.a4/f,g>.3?(y=l/f*(1+g*(r.a1+T+m*I)/f),A=Math.asin(y),b=y*y,_=Math.sqrt(1-b)):(_=u/f*(1-m*(r.a5-T-g*I)/f),A=Math.acos(_),b=1-_*_,y=Math.sqrt(b)),w=1-ci.eccentricitySquared*b,x=ci.radius/Math.sqrt(w),S=r.a6*x,T=u-x*_,I=l-S*y,M=_*T+y*I,C=_*I-y*T,E=C/(S/w+M),A+=E,L=M+C*E/2,a<0&&(A=-A),i[n++]=ob*$,i[n++]=ob*A,i[n]=L}function zne(t,e,i,n){cf(t,e,i,n),of(i,n,i,n)}function Vne(t,e,i,n){cf(t,e,i,n),zy(i,n,i,n)}const rl={[B.WGS84]:{[B.CGCS2000]:null,[B.GCSMARS2000]:null,[B.GCSMOON2000]:null,[B.LON_LAT]:ei,[B.WGS84_COMPARABLE_LON_LAT]:ei,[B.SPHERICAL_ECEF]:of,[B.SPHERICAL_MARS_PCPF]:null,[B.SPHERICAL_MOON_PCPF]:null,[B.UNKNOWN]:null,[B.WEB_MERCATOR]:zy,[B.PLATE_CARREE]:sf,[B.WGS84]:ei,[B.WGS84_ECEF]:lf},[B.CGCS2000]:{[B.CGCS2000]:ei,[B.GCSMARS2000]:null,[B.GCSMOON2000]:null,[B.LON_LAT]:ei,[B.WGS84_COMPARABLE_LON_LAT]:ei,[B.SPHERICAL_ECEF]:of,[B.SPHERICAL_MARS_PCPF]:null,[B.SPHERICAL_MOON_PCPF]:null,[B.UNKNOWN]:null,[B.WEB_MERCATOR]:null,[B.PLATE_CARREE]:sf,[B.WGS84]:null,[B.WGS84_ECEF]:lf},[B.GCSMARS2000]:{[B.CGCS2000]:null,[B.GCSMARS2000]:ei,[B.GCSMOON2000]:null,[B.LON_LAT]:ei,[B.WGS84_COMPARABLE_LON_LAT]:null,[B.SPHERICAL_ECEF]:null,[B.SPHERICAL_MARS_PCPF]:sD,[B.SPHERICAL_MOON_PCPF]:null,[B.UNKNOWN]:null,[B.WEB_MERCATOR]:null,[B.PLATE_CARREE]:null,[B.WGS84]:null,[B.WGS84_ECEF]:null},[B.GCSMOON2000]:{[B.CGCS2000]:null,[B.GCSMARS2000]:null,[B.GCSMOON2000]:ei,[B.LON_LAT]:ei,[B.WGS84_COMPARABLE_LON_LAT]:null,[B.SPHERICAL_ECEF]:null,[B.SPHERICAL_MARS_PCPF]:null,[B.SPHERICAL_MOON_PCPF]:rD,[B.UNKNOWN]:null,[B.WEB_MERCATOR]:null,[B.PLATE_CARREE]:null,[B.WGS84]:null,[B.WGS84_ECEF]:null},[B.WEB_MERCATOR]:{[B.CGCS2000]:null,[B.GCSMARS2000]:null,[B.GCSMOON2000]:null,[B.LON_LAT]:yy,[B.WGS84_COMPARABLE_LON_LAT]:yy,[B.SPHERICAL_ECEF]:One,[B.SPHERICAL_MARS_PCPF]:null,[B.SPHERICAL_MOON_PCPF]:null,[B.UNKNOWN]:null,[B.WEB_MERCATOR]:ei,[B.PLATE_CARREE]:Dne,[B.WGS84]:yy,[B.WGS84_ECEF]:Lne},[B.WGS84_ECEF]:{[B.CGCS2000]:cf,[B.GCSMARS2000]:null,[B.GCSMOON2000]:null,[B.LON_LAT]:cf,[B.WGS84_COMPARABLE_LON_LAT]:cf,[B.SPHERICAL_ECEF]:zne,[B.SPHERICAL_MARS_PCPF]:null,[B.SPHERICAL_MOON_PCPF]:null,[B.UNKNOWN]:null,[B.WEB_MERCATOR]:Vne,[B.PLATE_CARREE]:vCe,[B.WGS84]:cf,[B.WGS84_ECEF]:ei},[B.SPHERICAL_ECEF]:{[B.CGCS2000]:af,[B.GCSMARS2000]:null,[B.GCSMOON2000]:null,[B.LON_LAT]:af,[B.WGS84_COMPARABLE_LON_LAT]:af,[B.SPHERICAL_ECEF]:ei,[B.SPHERICAL_MARS_PCPF]:null,[B.SPHERICAL_MOON_PCPF]:null,[B.UNKNOWN]:null,[B.WEB_MERCATOR]:Nne,[B.PLATE_CARREE]:_Ce,[B.WGS84]:af,[B.WGS84_ECEF]:Fne},[B.SPHERICAL_MARS_PCPF]:{[B.CGCS2000]:null,[B.GCSMARS2000]:aD,[B.GCSMOON2000]:null,[B.LON_LAT]:aD,[B.WGS84_COMPARABLE_LON_LAT]:null,[B.SPHERICAL_ECEF]:null,[B.SPHERICAL_MARS_PCPF]:ei,[B.SPHERICAL_MOON_PCPF]:null,[B.UNKNOWN]:null,[B.WEB_MERCATOR]:null,[B.PLATE_CARREE]:null,[B.WGS84]:null,[B.WGS84_ECEF]:null},[B.SPHERICAL_MOON_PCPF]:{[B.CGCS2000]:null,[B.GCSMARS2000]:null,[B.GCSMOON2000]:oD,[B.LON_LAT]:oD,[B.WGS84_COMPARABLE_LON_LAT]:null,[B.SPHERICAL_ECEF]:null,[B.SPHERICAL_MARS_PCPF]:null,[B.SPHERICAL_MOON_PCPF]:ei,[B.UNKNOWN]:null,[B.WEB_MERCATOR]:null,[B.PLATE_CARREE]:null,[B.WGS84]:null,[B.WGS84_ECEF]:null},[B.UNKNOWN]:{[B.CGCS2000]:null,[B.GCSMARS2000]:null,[B.GCSMOON2000]:null,[B.LON_LAT]:null,[B.WGS84_COMPARABLE_LON_LAT]:null,[B.SPHERICAL_ECEF]:null,[B.SPHERICAL_MARS_PCPF]:null,[B.SPHERICAL_MOON_PCPF]:null,[B.UNKNOWN]:ei,[B.WEB_MERCATOR]:null,[B.PLATE_CARREE]:null,[B.WGS84]:null,[B.WGS84_ECEF]:null},[B.LON_LAT]:{[B.CGCS2000]:ei,[B.GCSMARS2000]:ei,[B.GCSMOON2000]:ei,[B.LON_LAT]:ei,[B.WGS84_COMPARABLE_LON_LAT]:ei,[B.SPHERICAL_ECEF]:of,[B.SPHERICAL_MARS_PCPF]:sD,[B.SPHERICAL_MOON_PCPF]:rD,[B.UNKNOWN]:null,[B.WEB_MERCATOR]:zy,[B.PLATE_CARREE]:sf,[B.WGS84]:ei,[B.WGS84_ECEF]:lf},[B.WGS84_COMPARABLE_LON_LAT]:{[B.CGCS2000]:null,[B.GCSMARS2000]:null,[B.GCSMOON2000]:null,[B.LON_LAT]:ei,[B.WGS84_COMPARABLE_LON_LAT]:ei,[B.SPHERICAL_ECEF]:of,[B.SPHERICAL_MARS_PCPF]:null,[B.SPHERICAL_MOON_PCPF]:null,[B.UNKNOWN]:null,[B.WEB_MERCATOR]:null,[B.PLATE_CARREE]:sf,[B.WGS84]:ei,[B.WGS84_ECEF]:lf},[B.PLATE_CARREE]:{[B.CGCS2000]:ay,[B.GCSMARS2000]:null,[B.GCSMOON2000]:null,[B.LON_LAT]:ay,[B.WGS84_COMPARABLE_LON_LAT]:ay,[B.SPHERICAL_ECEF]:bCe,[B.SPHERICAL_MARS_PCPF]:null,[B.SPHERICAL_MOON_PCPF]:null,[B.UNKNOWN]:null,[B.WEB_MERCATOR]:wCe,[B.PLATE_CARREE]:ei,[B.WGS84]:ay,[B.WGS84_ECEF]:xCe}};function _V(t,e,i=bV()){return t==null||e==null?null:jne(t,e,i).projector}function jne(t,e,i){if(t==null||e==null||i.source.spatialReference===t&&i.dest.spatialReference===e)return i;const n=Du(t,i.source),r=Du(e,i.dest);return n===B.UNKNOWN&&r===B.UNKNOWN?En(t,e)?i.projector=ei:i.projector=null:i.projector=rl[n][r],i}function bV(){return{source:{spatialReference:null,spatialReferenceId:B.UNKNOWN,metersPerUnit:1},dest:{spatialReference:null,spatialReferenceId:B.UNKNOWN,metersPerUnit:1},projector:ei}}const Wb={spatialReference:null,spatialReferenceId:B.UNKNOWN},Bne={spatialReference:null,spatialReferenceId:B.UNKNOWN},wV=bV(),CCe=bV(),hc=_ee(1),ob=bee(1),Si=Me(),nc=Me(),Nd=Me(),mt=Me(),oI=Me(),kct=Object.freeze(Object.defineProperty({__proto__:null,canProjectToWGS84ComparableLonLat:SCe,canProjectWithoutEngine:yl,computeENUToSphericalPCPFLocalRotation:yV,computeSphericalPCPFToENULocalRotation:kne,computeTranslationToOriginAndRotation:yCe,getProjectorName:eCe,getTransformation:yA,getTransformations:XIe,initializeProjection:Ff,isLoaded:wl,load:Ic,localLinearScaleFactors:gCe,lonLatToSphericalPCPF:TCe,lonLatToWebMercatorComparable:Rne,project:an,projectBoundingRect:mCe,projectBoundingSphere:fCe,projectBuffer:Cc,projectDirection:pCe,projectExtent:aCe,projectMany:tD,projectMultipoint:iCe,projectOrLoad:YIe,projectOrLoadMany:xne,projectPoint:tCe,projectPointToVector:uCe,projectPointToWGS84ComparableLonLat:hCe,projectPolygon:oCe,projectPolygonToWGS84ComparableLonLat:sCe,projectPolyline:nCe,projectPolylineToWGS84ComparableLonLat:rCe,projectVectorToDehydratedPoint:cCe,projectVectorToPoint:lCe,projectVectorToVector:nD,projectVectorToWGS84ComparableLonLat:$ne,projectWithoutEngine:Tne,projectXYZToVector:iD,sphericalPCPFtoLonLatElevation:xP,test:QIe,tryProjectWithZConversion:Sne,unload:KIe},Symbol.toStringTag,{value:"Module"}));var lD;let Xc=lD=class extends ie{constructor(t){super(t),this.cols=null,this.level=0,this.levelValue=null,this.origin=null,this.resolution=0,this.rows=null,this.scale=0}clone(){return new lD({cols:this.cols,level:this.level,levelValue:this.levelValue,resolution:this.resolution,rows:this.rows,scale:this.scale})}};h([p({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],Xc.prototype,"cols",void 0),h([p({type:It,json:{write:!0}})],Xc.prototype,"level",void 0),h([p({type:String,json:{write:!0}})],Xc.prototype,"levelValue",void 0),h([p({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],Xc.prototype,"origin",void 0),h([p({type:Number,json:{write:!0}})],Xc.prototype,"resolution",void 0),h([p({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],Xc.prototype,"rows",void 0),h([p({type:Number,json:{write:!0}})],Xc.prototype,"scale",void 0),Xc=lD=h([P("esri.layers.support.LOD")],Xc);const pu=Xc;let SP=class{constructor(e,i,n,r,s=void 0){this.id=e,this.level=i,this.row=n,this.col=r,this.extent=s}};var sp;const VU=new qe({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc",LERC2D:"lerc2d",RAW:"raw",pbf:"pbf"});let Wr=sp=class extends ie{static create(t={}){const{resolutionFactor:e=1,scales:i,size:n=256,spatialReference:r=Ee.WebMercator,numLODs:s=24}=t;if(!Nr(r)){const d=[];if(i)for(let f=0;f<i.length;f++){const m=i[f];d.push(new pu({level:f,scale:m,resolution:m}))}else{let f=5e-4;for(let m=s-1;m>=0;m--)d.unshift(new pu({level:m,scale:f,resolution:f})),f*=2}return new sp({dpi:96,lods:d,origin:new pe(0,0,r),size:[n,n],spatialReference:r})}const o=to(r),a=t.origin?new pe({x:t.origin.x,y:t.origin.y,spatialReference:r}):new pe(o?{x:o.origin[0],y:o.origin[1],spatialReference:r}:{x:0,y:0,spatialReference:r}),l=96,c=1/(pi(r)*39.37*l),u=[];if(i)for(let d=0;d<i.length;d++){const f=i[d],m=f*c;u.push(new pu({level:d,scale:f,resolution:m}))}else{let d=n6(r)?512/n*5916575275917094e-7:256/n*591657527591555e-6;const f=Math.ceil(s/e);u.push(new pu({level:0,scale:d,resolution:d*c}));for(let m=1;m<f;m++){const g=d/2**e,y=g*c;u.push(new pu({level:m,scale:g,resolution:y})),d=g}}return new sp({dpi:l,lods:u,origin:a,size:[n,n],spatialReference:r})}constructor(t){super(t),this.dpi=96,this.format=null,this.origin=null,this.size=null,this.spatialReference=null}get isWrappable(){const{spatialReference:t,origin:e}=this;if(t&&e){const i=to(t);return t.isWrappable&&!!i&&Math.abs(i.origin[0]-e.x)<=i.dx}return!1}readOrigin(t,e){return pe.fromJSON({spatialReference:e.spatialReference,...t})}set lods(t){let e=0,i=0;const n=[],r=this._levelToLOD={};t&&(e=-1/0,i=1/0,t.forEach(s=>{n.push(s.scale),e=s.scale>e?s.scale:e,i=s.scale<i?s.scale:i,r[s.level]=s})),this._set("scales",n),this._set("lods",t),this._initializeUpsampleLevels()}readSize(t,e){return[e.cols,e.rows]}writeSize(t,e){e.cols=t[0],e.rows=t[1]}zoomToScale(t){const e=this.scales;if(t<=0)return e[0];if(t>=e.length-1)return e[e.length-1];const i=Math.floor(t),n=i+1;return e[i]/(e[i]/e[n])**(t-i)}scaleToZoom(t){const e=this.scales,i=e.length-1;let n=0;for(;n<i;n++){const r=e[n],s=e[n+1];if(r<=t)return n;if(s===t)return n+1;if(r>t&&s<t)return n+Math.log(r/t)/Math.log(r/s)}return n}snapScale(t,e=.95){const i=this.scaleToZoom(t);return i%Math.floor(i)>=e?this.zoomToScale(Math.ceil(i)):this.zoomToScale(Math.floor(i))}tileAt(t,e,i,n){const r=this.lodAt(t);if(!r)return null;let s,o;if(typeof e=="number")s=e,o=i;else if(En(e.spatialReference,this.spatialReference))s=e.x,o=e.y,n=i;else{const c=NS(e,this.spatialReference);if(c==null)return null;s=c.x,o=c.y,n=i}const a=r.resolution*this.size[0],l=r.resolution*this.size[1];return n||(n=new SP(null,0,0,0,wa())),n.level=t,n.row=Math.floor((this.origin.y-o)/l+.001),n.col=Math.floor((s-this.origin.x)/a+.001),this.updateTileInfo(n),n}updateTileInfo(t,e=sp.ExtrapolateOptions.NONE){let i=this.lodAt(t.level);if(!i&&e===sp.ExtrapolateOptions.POWER_OF_TWO){const o=this.lods[this.lods.length-1];o.level<t.level&&(i=o)}if(!i)return;const n=t.level-i.level,r=i.resolution*this.size[0]/2**n,s=i.resolution*this.size[1]/2**n;t.id=`${t.level}/${t.row}/${t.col}`,t.extent||(t.extent=wa()),t.extent[0]=this.origin.x+t.col*r,t.extent[1]=this.origin.y-(t.row+1)*s,t.extent[2]=t.extent[0]+r,t.extent[3]=t.extent[1]+s}upsampleTile(t){const e=this._upsampleLevels[t.level];return!(!e||e.parentLevel===-1)&&(t.level=e.parentLevel,t.row=Math.floor(t.row/e.factor+.001),t.col=Math.floor(t.col/e.factor+.001),this.updateTileInfo(t),!0)}getTileBounds(t,e){const i=this.lodAt(e.level);if(i==null)return null;const{resolution:n}=i,r=n*this.size[0],s=n*this.size[1];return t[0]=this.origin.x+e.col*r,t[1]=this.origin.y-(e.row+1)*s,t[2]=t[0]+r,t[3]=t[1]+s,t}lodAt(t){var e;return((e=this._levelToLOD)==null?void 0:e[t])??null}clone(){return sp.fromJSON(this.write({}))}getOrCreateCompatible(t,e){if(this.size[0]===256&&this.size[1]===256)return t===256?this:null;const i=[],n=this.lods.length;for(let r=0;r<n;r++){const s=this.lods[r],o=s.resolution*e;i.push(new pu({level:s.level,scale:s.scale,resolution:o}))}return new sp({size:[t,t],dpi:this.dpi,format:this.format,compressionQuality:this.compressionQuality,origin:this.origin,spatialReference:this.spatialReference,lods:i})}_initializeUpsampleLevels(){const t=this.lods;this._upsampleLevels=[];let e=null;for(let i=0;i<t.length;i++){const n=t[i];this._upsampleLevels[n.level]={parentLevel:e?e.level:-1,factor:e?e.resolution/n.resolution:0},e=n}}};h([p({type:Number,json:{write:!0}})],Wr.prototype,"compressionQuality",void 0),h([p({type:Number,json:{write:!0}})],Wr.prototype,"dpi",void 0),h([p({type:String,json:{read:VU.read,write:VU.write,origins:{"web-scene":{read:!1,write:!1}}}})],Wr.prototype,"format",void 0),h([p({readOnly:!0})],Wr.prototype,"isWrappable",null),h([p({type:pe,json:{write:!0}})],Wr.prototype,"origin",void 0),h([_e("origin")],Wr.prototype,"readOrigin",null),h([p({type:[pu],value:null,json:{write:!0}})],Wr.prototype,"lods",null),h([p({readOnly:!0})],Wr.prototype,"scales",void 0),h([p({cast:t=>Array.isArray(t)?t:typeof t=="number"?[t,t]:[256,256]})],Wr.prototype,"size",void 0),h([_e("size",["rows","cols"])],Wr.prototype,"readSize",null),h([ge("size",{cols:{type:It},rows:{type:It}})],Wr.prototype,"writeSize",null),h([p({type:Ee,json:{write:!0}})],Wr.prototype,"spatialReference",void 0),Wr=sp=h([P("esri.layers.support.TileInfo")],Wr),function(t){var e;(e=t.ExtrapolateOptions||(t.ExtrapolateOptions={}))[e.NONE=0]="NONE",e[e.POWER_OF_TWO=1]="POWER_OF_TWO"}(Wr||(Wr={}));const Mu=Wr,TM={widthBreakpoint:{getValue(t){const e=t.viewSize[0],i=t.breakpoints,n=this.values;return e<=i.xsmall?n.xsmall:e<=i.small?n.small:e<=i.medium?n.medium:e<=i.large?n.large:n.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-width-xsmall esri-view-width-less-than-small esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",small:"esri-view-width-small esri-view-width-greater-than-xsmall esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",medium:"esri-view-width-medium esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-less-than-large esri-view-width-less-than-xlarge",large:"esri-view-width-large esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-less-than-xlarge",xlarge:"esri-view-width-xlarge esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-greater-than-large"}},heightBreakpoint:{getValue(t){const e=t.viewSize[1],i=t.breakpoints,n=this.values;return e<=i.xsmall?n.xsmall:e<=i.small?n.small:e<=i.medium?n.medium:e<=i.large?n.large:n.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-height-xsmall esri-view-height-less-than-small esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",small:"esri-view-height-small esri-view-height-greater-than-xsmall esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",medium:"esri-view-height-medium esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-less-than-large esri-view-height-less-than-xlarge",large:"esri-view-height-large esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-less-than-xlarge",xlarge:"esri-view-height-xlarge esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-greater-than-large"}},orientation:{getValue(t){const e=t.viewSize,i=e[0],n=e[1],r=this.values;return n>=i?r.portrait:r.landscape},values:{portrait:"portrait",landscape:"landscape"},valueToClassName:{portrait:"esri-view-orientation-portrait",landscape:"esri-view-orientation-landscape"}}},k3={xsmall:544,small:768,medium:992,large:1200};function MCe(t){const e=t;return e&&e.xsmall<e.small&&e.small<e.medium&&e.medium<e.large}function O3(t,e){return e?TM[t].valueToClassName[e].split(" "):[]}const ECe=t=>{let e=class extends t{constructor(...i){super(...i),this._breakpointsHandles=new Rs,this.orientation=null,this.widthBreakpoint=null,this.heightBreakpoint=null,this.breakpoints=k3}initialize(){this._breakpointsHandles.add(Q(()=>[this.breakpoints,this.size],()=>this._updateClassNames(),He))}destroy(){this.destroyed||(this._removeActiveClassNames(),this._breakpointsHandles=Je(this._breakpointsHandles))}set breakpoints(i){if(i===this._get("breakpoints"))return;const n=MCe(i);if(!n){const r=JSON.stringify(k3,null,2);console.warn("provided breakpoints are not valid, using defaults:"+r)}i=n?i:k3,this._set("breakpoints",{...i})}_updateClassNames(){if(!this.container)return;const i=eo.acquire(),n=eo.acquire();let r,s=!1;for(r in TM){const o=this[r],a=TM[r].getValue({viewSize:this.size,breakpoints:this.breakpoints});o!==a&&(s=!0,this[r]=a,O3(r,o).forEach(l=>n.push(l)),O3(r,a).forEach(l=>i.push(l)))}s&&(this._applyClassNameChanges(i,n),eo.release(i),eo.release(n))}_applyClassNameChanges(i,n){const r=this.container;r&&(n.forEach(s=>r.classList.remove(s)),i.forEach(s=>r.classList.add(s)))}_removeActiveClassNames(){const i=this.container;if(!i)return;let n;for(n in TM)O3(n,this[n]).forEach(r=>i.classList.remove(r))}};return h([p()],e.prototype,"breakpoints",null),h([p()],e.prototype,"orientation",void 0),h([p()],e.prototype,"widthBreakpoint",void 0),h([p()],e.prototype,"heightBreakpoint",void 0),e=h([P("esri.views.BreakpointsOwner")],e),e};function TP(t){return typeof t=="string"?document.getElementById(t):t??null}function Une(t){for(;t.hasChildNodes();)t.removeChild(t.firstChild)}function jU(t,e){const i=e.parentNode;i&&i.insertBefore(t,e)}function BU(t,e){for(;;){const i=t.firstChild;if(!i)break;e.appendChild(i)}}function ACe(t){t.parentNode&&t.parentNode.removeChild(t)}let k_=class extends ye{constructor(){super(...arguments),this.updating=!1,this._handleId=0,this._handles=new Rs,this._scheduleHandleId=0,this._pendingPromises=new Set}destroy(){this.removeAll(),this._handles.destroy()}add(e,i,n={}){return this._installWatch(e,i,n,Q)}addWhen(e,i,n={}){return this._installWatch(e,i,n,jo)}addOnCollectionChange(e,i,{initial:n=!1,final:r=!1}={}){const s=++this._handleId;return this._handles.add([on(e,"after-changes",this._createSyncUpdatingCallback(),ml),on(e,"change",i,{onListenerAdd:n?o=>i({added:o.toArray(),removed:[]}):void 0,onListenerRemove:r?o=>i({added:[],removed:o.toArray()}):void 0})],s),br(()=>this._handles.remove(s))}addPromise(e){if(e==null)return e;const i=++this._handleId;this._handles.add({remove:()=>{this._pendingPromises.delete(e)&&(this._pendingPromises.size!==0||this._handles.has(aI)||this._set("updating",!1))}},i),this._pendingPromises.add(e),this._set("updating",!0);const n=()=>this._handles.remove(i);return e.then(n,n),e}removeAll(){this._pendingPromises.clear(),this._handles.removeAll(),this._set("updating",!1)}_installWatch(e,i,n={},r){const s=++this._handleId;n.sync||this._installSyncUpdatingWatch(e,s);const o=r(e,i,n);return this._handles.add(o,s),br(()=>this._handles.remove(s))}_installSyncUpdatingWatch(e,i){const n=this._createSyncUpdatingCallback(),r=Q(e,n,{sync:!0,equals:()=>!1});return this._handles.add(r,i),r}_createSyncUpdatingCallback(){return()=>{this._handles.remove(aI),++this._scheduleHandleId;const e=this._scheduleHandleId;this._get("updating")||this._set("updating",!0),this._handles.add(kb(()=>{e===this._scheduleHandleId&&(this._set("updating",this._pendingPromises.size>0),this._handles.remove(aI))}),aI)}}};h([p({readOnly:!0})],k_.prototype,"updating",void 0),k_=h([P("esri.core.support.WatchUpdatingTracking")],k_);const aI=-42;/*!
 * @esri/arcgis-html-sanitizer - v3.0.1 - Tue Nov 15 2022 09:46:54 GMT-0800 (Pacific Standard Time)
 * Copyright (c) 2022 - Environmental Systems Research Institute, Inc.
 * Apache-2.0
 * 
 * js-xss
 * Copyright (c) 2012-2018 Zongmin Lei() <leizongmin@gmail.com>
 * http://ucdok.com
 * MIT License, see https://github.com/leizongmin/js-xss/blob/master/LICENSE for details
 */var $Ce=function(t){if(typeof t!="object"||t===null||Object.prototype.toString.call(t)!=="[object Object]")return!1;var e=Object.getPrototypeOf(t);if(e===null)return!0;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e},Gg={exports:{}},mn={},q2={exports:{}},l0={};function Gne(){var t={};return t["align-content"]=!1,t["align-items"]=!1,t["align-self"]=!1,t["alignment-adjust"]=!1,t["alignment-baseline"]=!1,t.all=!1,t["anchor-point"]=!1,t.animation=!1,t["animation-delay"]=!1,t["animation-direction"]=!1,t["animation-duration"]=!1,t["animation-fill-mode"]=!1,t["animation-iteration-count"]=!1,t["animation-name"]=!1,t["animation-play-state"]=!1,t["animation-timing-function"]=!1,t.azimuth=!1,t["backface-visibility"]=!1,t.background=!0,t["background-attachment"]=!0,t["background-clip"]=!0,t["background-color"]=!0,t["background-image"]=!0,t["background-origin"]=!0,t["background-position"]=!0,t["background-repeat"]=!0,t["background-size"]=!0,t["baseline-shift"]=!1,t.binding=!1,t.bleed=!1,t["bookmark-label"]=!1,t["bookmark-level"]=!1,t["bookmark-state"]=!1,t.border=!0,t["border-bottom"]=!0,t["border-bottom-color"]=!0,t["border-bottom-left-radius"]=!0,t["border-bottom-right-radius"]=!0,t["border-bottom-style"]=!0,t["border-bottom-width"]=!0,t["border-collapse"]=!0,t["border-color"]=!0,t["border-image"]=!0,t["border-image-outset"]=!0,t["border-image-repeat"]=!0,t["border-image-slice"]=!0,t["border-image-source"]=!0,t["border-image-width"]=!0,t["border-left"]=!0,t["border-left-color"]=!0,t["border-left-style"]=!0,t["border-left-width"]=!0,t["border-radius"]=!0,t["border-right"]=!0,t["border-right-color"]=!0,t["border-right-style"]=!0,t["border-right-width"]=!0,t["border-spacing"]=!0,t["border-style"]=!0,t["border-top"]=!0,t["border-top-color"]=!0,t["border-top-left-radius"]=!0,t["border-top-right-radius"]=!0,t["border-top-style"]=!0,t["border-top-width"]=!0,t["border-width"]=!0,t.bottom=!1,t["box-decoration-break"]=!0,t["box-shadow"]=!0,t["box-sizing"]=!0,t["box-snap"]=!0,t["box-suppress"]=!0,t["break-after"]=!0,t["break-before"]=!0,t["break-inside"]=!0,t["caption-side"]=!1,t.chains=!1,t.clear=!0,t.clip=!1,t["clip-path"]=!1,t["clip-rule"]=!1,t.color=!0,t["color-interpolation-filters"]=!0,t["column-count"]=!1,t["column-fill"]=!1,t["column-gap"]=!1,t["column-rule"]=!1,t["column-rule-color"]=!1,t["column-rule-style"]=!1,t["column-rule-width"]=!1,t["column-span"]=!1,t["column-width"]=!1,t.columns=!1,t.contain=!1,t.content=!1,t["counter-increment"]=!1,t["counter-reset"]=!1,t["counter-set"]=!1,t.crop=!1,t.cue=!1,t["cue-after"]=!1,t["cue-before"]=!1,t.cursor=!1,t.direction=!1,t.display=!0,t["display-inside"]=!0,t["display-list"]=!0,t["display-outside"]=!0,t["dominant-baseline"]=!1,t.elevation=!1,t["empty-cells"]=!1,t.filter=!1,t.flex=!1,t["flex-basis"]=!1,t["flex-direction"]=!1,t["flex-flow"]=!1,t["flex-grow"]=!1,t["flex-shrink"]=!1,t["flex-wrap"]=!1,t.float=!1,t["float-offset"]=!1,t["flood-color"]=!1,t["flood-opacity"]=!1,t["flow-from"]=!1,t["flow-into"]=!1,t.font=!0,t["font-family"]=!0,t["font-feature-settings"]=!0,t["font-kerning"]=!0,t["font-language-override"]=!0,t["font-size"]=!0,t["font-size-adjust"]=!0,t["font-stretch"]=!0,t["font-style"]=!0,t["font-synthesis"]=!0,t["font-variant"]=!0,t["font-variant-alternates"]=!0,t["font-variant-caps"]=!0,t["font-variant-east-asian"]=!0,t["font-variant-ligatures"]=!0,t["font-variant-numeric"]=!0,t["font-variant-position"]=!0,t["font-weight"]=!0,t.grid=!1,t["grid-area"]=!1,t["grid-auto-columns"]=!1,t["grid-auto-flow"]=!1,t["grid-auto-rows"]=!1,t["grid-column"]=!1,t["grid-column-end"]=!1,t["grid-column-start"]=!1,t["grid-row"]=!1,t["grid-row-end"]=!1,t["grid-row-start"]=!1,t["grid-template"]=!1,t["grid-template-areas"]=!1,t["grid-template-columns"]=!1,t["grid-template-rows"]=!1,t["hanging-punctuation"]=!1,t.height=!0,t.hyphens=!1,t.icon=!1,t["image-orientation"]=!1,t["image-resolution"]=!1,t["ime-mode"]=!1,t["initial-letters"]=!1,t["inline-box-align"]=!1,t["justify-content"]=!1,t["justify-items"]=!1,t["justify-self"]=!1,t.left=!1,t["letter-spacing"]=!0,t["lighting-color"]=!0,t["line-box-contain"]=!1,t["line-break"]=!1,t["line-grid"]=!1,t["line-height"]=!1,t["line-snap"]=!1,t["line-stacking"]=!1,t["line-stacking-ruby"]=!1,t["line-stacking-shift"]=!1,t["line-stacking-strategy"]=!1,t["list-style"]=!0,t["list-style-image"]=!0,t["list-style-position"]=!0,t["list-style-type"]=!0,t.margin=!0,t["margin-bottom"]=!0,t["margin-left"]=!0,t["margin-right"]=!0,t["margin-top"]=!0,t["marker-offset"]=!1,t["marker-side"]=!1,t.marks=!1,t.mask=!1,t["mask-box"]=!1,t["mask-box-outset"]=!1,t["mask-box-repeat"]=!1,t["mask-box-slice"]=!1,t["mask-box-source"]=!1,t["mask-box-width"]=!1,t["mask-clip"]=!1,t["mask-image"]=!1,t["mask-origin"]=!1,t["mask-position"]=!1,t["mask-repeat"]=!1,t["mask-size"]=!1,t["mask-source-type"]=!1,t["mask-type"]=!1,t["max-height"]=!0,t["max-lines"]=!1,t["max-width"]=!0,t["min-height"]=!0,t["min-width"]=!0,t["move-to"]=!1,t["nav-down"]=!1,t["nav-index"]=!1,t["nav-left"]=!1,t["nav-right"]=!1,t["nav-up"]=!1,t["object-fit"]=!1,t["object-position"]=!1,t.opacity=!1,t.order=!1,t.orphans=!1,t.outline=!1,t["outline-color"]=!1,t["outline-offset"]=!1,t["outline-style"]=!1,t["outline-width"]=!1,t.overflow=!1,t["overflow-wrap"]=!1,t["overflow-x"]=!1,t["overflow-y"]=!1,t.padding=!0,t["padding-bottom"]=!0,t["padding-left"]=!0,t["padding-right"]=!0,t["padding-top"]=!0,t.page=!1,t["page-break-after"]=!1,t["page-break-before"]=!1,t["page-break-inside"]=!1,t["page-policy"]=!1,t.pause=!1,t["pause-after"]=!1,t["pause-before"]=!1,t.perspective=!1,t["perspective-origin"]=!1,t.pitch=!1,t["pitch-range"]=!1,t["play-during"]=!1,t.position=!1,t["presentation-level"]=!1,t.quotes=!1,t["region-fragment"]=!1,t.resize=!1,t.rest=!1,t["rest-after"]=!1,t["rest-before"]=!1,t.richness=!1,t.right=!1,t.rotation=!1,t["rotation-point"]=!1,t["ruby-align"]=!1,t["ruby-merge"]=!1,t["ruby-position"]=!1,t["shape-image-threshold"]=!1,t["shape-outside"]=!1,t["shape-margin"]=!1,t.size=!1,t.speak=!1,t["speak-as"]=!1,t["speak-header"]=!1,t["speak-numeral"]=!1,t["speak-punctuation"]=!1,t["speech-rate"]=!1,t.stress=!1,t["string-set"]=!1,t["tab-size"]=!1,t["table-layout"]=!1,t["text-align"]=!0,t["text-align-last"]=!0,t["text-combine-upright"]=!0,t["text-decoration"]=!0,t["text-decoration-color"]=!0,t["text-decoration-line"]=!0,t["text-decoration-skip"]=!0,t["text-decoration-style"]=!0,t["text-emphasis"]=!0,t["text-emphasis-color"]=!0,t["text-emphasis-position"]=!0,t["text-emphasis-style"]=!0,t["text-height"]=!0,t["text-indent"]=!0,t["text-justify"]=!0,t["text-orientation"]=!0,t["text-overflow"]=!0,t["text-shadow"]=!0,t["text-space-collapse"]=!0,t["text-transform"]=!0,t["text-underline-position"]=!0,t["text-wrap"]=!0,t.top=!1,t.transform=!1,t["transform-origin"]=!1,t["transform-style"]=!1,t.transition=!1,t["transition-delay"]=!1,t["transition-duration"]=!1,t["transition-property"]=!1,t["transition-timing-function"]=!1,t["unicode-bidi"]=!1,t["vertical-align"]=!1,t.visibility=!1,t["voice-balance"]=!1,t["voice-duration"]=!1,t["voice-family"]=!1,t["voice-pitch"]=!1,t["voice-range"]=!1,t["voice-rate"]=!1,t["voice-stress"]=!1,t["voice-volume"]=!1,t.volume=!1,t["white-space"]=!1,t.widows=!1,t.width=!0,t["will-change"]=!1,t["word-break"]=!0,t["word-spacing"]=!0,t["word-wrap"]=!0,t["wrap-flow"]=!1,t["wrap-through"]=!1,t["writing-mode"]=!1,t["z-index"]=!1,t}function PCe(t,e,i){}function kCe(t,e,i){}var OCe=/javascript\s*\:/img;function LCe(t,e){return OCe.test(e)?"":e}l0.whiteList=Gne();l0.getDefaultWhiteList=Gne;l0.onAttr=PCe;l0.onIgnoreAttr=kCe;l0.safeAttrValue=LCe;var RCe={indexOf:function(t,e){var i,n;if(Array.prototype.indexOf)return t.indexOf(e);for(i=0,n=t.length;i<n;i++)if(t[i]===e)return i;return-1},forEach:function(t,e,i){var n,r;if(Array.prototype.forEach)return t.forEach(e,i);for(n=0,r=t.length;n<r;n++)e.call(i,t[n],n,t)},trim:function(t){return String.prototype.trim?t.trim():t.replace(/(^\s*)|(\s*$)/g,"")},trimRight:function(t){return String.prototype.trimRight?t.trimRight():t.replace(/(\s*$)/g,"")}},T1=RCe;function DCe(t,e){t=T1.trimRight(t),t[t.length-1]!==";"&&(t+=";");var i=t.length,n=!1,r=0,s=0,o="";function a(){if(!n){var u=T1.trim(t.slice(r,s)),d=u.indexOf(":");if(d!==-1){var f=T1.trim(u.slice(0,d)),m=T1.trim(u.slice(d+1));if(f){var g=e(r,o.length,f,m,u);g&&(o+=g+"; ")}}}r=s+1}for(;s<i;s++){var l=t[s];if(l==="/"&&t[s+1]==="*"){var c=t.indexOf("*/",s+2);if(c===-1)break;s=c+1,r=s+1,n=!1}else l==="("?n=!0:l===")"?n=!1:l===";"?n||a():l===`
`&&a()}return T1.trim(o)}var NCe=DCe,lI=l0,FCe=NCe;function UU(t){return t==null}function zCe(t){var e={};for(var i in t)e[i]=t[i];return e}function Hne(t){t=zCe(t||{}),t.whiteList=t.whiteList||lI.whiteList,t.onAttr=t.onAttr||lI.onAttr,t.onIgnoreAttr=t.onIgnoreAttr||lI.onIgnoreAttr,t.safeAttrValue=t.safeAttrValue||lI.safeAttrValue,this.options=t}Hne.prototype.process=function(t){if(t=t||"",t=t.toString(),!t)return"";var e=this,i=e.options,n=i.whiteList,r=i.onAttr,s=i.onIgnoreAttr,o=i.safeAttrValue,a=FCe(t,function(l,c,u,d,f){var m=n[u],g=!1;if(m===!0?g=m:typeof m=="function"?g=m(d):m instanceof RegExp&&(g=m.test(d)),g!==!0&&(g=!1),d=o(u,d),!!d){var y={position:c,sourcePosition:l,source:f,isWhite:g};if(g){var _=r(u,d,y);return UU(_)?u+":"+d:_}else{var _=s(u,d,y);if(!UU(_))return _}}});return a};var VCe=Hne;(function(t,e){var i=l0,n=VCe;function r(o,a){var l=new n(a);return l.process(o)}e=t.exports=r,e.FilterCSS=n;for(var s in i)e[s]=i[s]})(q2,q2.exports);var xV={indexOf:function(t,e){var i,n;if(Array.prototype.indexOf)return t.indexOf(e);for(i=0,n=t.length;i<n;i++)if(t[i]===e)return i;return-1},forEach:function(t,e,i){var n,r;if(Array.prototype.forEach)return t.forEach(e,i);for(n=0,r=t.length;n<r;n++)e.call(i,t[n],n,t)},trim:function(t){return String.prototype.trim?t.trim():t.replace(/(^\s*)|(\s*$)/g,"")},spaceIndex:function(t){var e=/\s|\n|\t/,i=e.exec(t);return i?i.index:-1}},jCe=q2.exports.FilterCSS,BCe=q2.exports.getDefaultWhiteList,vA=xV;function qne(){return{a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","crossorigin","loop","muted","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],figcaption:[],figure:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],strike:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","crossorigin","loop","muted","playsinline","poster","preload","src","height","width"]}}var Wne=new jCe;function UCe(t,e,i){}function GCe(t,e,i){}function HCe(t,e,i){}function qCe(t,e,i){}function Jne(t){return t.replace(JCe,"&lt;").replace(ZCe,"&gt;")}function WCe(t,e,i,n){if(i=ere(i),e==="href"||e==="src"){if(i=vA.trim(i),i==="#")return"#";if(!(i.substr(0,7)==="http://"||i.substr(0,8)==="https://"||i.substr(0,7)==="mailto:"||i.substr(0,4)==="tel:"||i.substr(0,11)==="data:image/"||i.substr(0,6)==="ftp://"||i.substr(0,2)==="./"||i.substr(0,3)==="../"||i[0]==="#"||i[0]==="/"))return""}else if(e==="background"){if(cI.lastIndex=0,cI.test(i))return""}else if(e==="style"){if(GU.lastIndex=0,GU.test(i)||(HU.lastIndex=0,HU.test(i)&&(cI.lastIndex=0,cI.test(i))))return"";n!==!1&&(n=n||Wne,i=n.process(i))}return i=tre(i),i}var JCe=/</g,ZCe=/>/g,YCe=/"/g,XCe=/&quot;/g,KCe=/&#([a-zA-Z0-9]*);?/gim,QCe=/&colon;?/gim,eMe=/&newline;?/gim,cI=/((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a):/gi,GU=/e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n\s*\(.*/gi,HU=/u\s*r\s*l\s*\(.*/gi;function Zne(t){return t.replace(YCe,"&quot;")}function Yne(t){return t.replace(XCe,'"')}function Xne(t){return t.replace(KCe,function(i,n){return n[0]==="x"||n[0]==="X"?String.fromCharCode(parseInt(n.substr(1),16)):String.fromCharCode(parseInt(n,10))})}function Kne(t){return t.replace(QCe,":").replace(eMe," ")}function Qne(t){for(var e="",i=0,n=t.length;i<n;i++)e+=t.charCodeAt(i)<32?" ":t.charAt(i);return vA.trim(e)}function ere(t){return t=Yne(t),t=Xne(t),t=Kne(t),t=Qne(t),t}function tre(t){return t=Zne(t),t=Jne(t),t}function tMe(){return""}function iMe(t,e){typeof e!="function"&&(e=function(){});var i=!Array.isArray(t);function n(o){return i?!0:vA.indexOf(t,o)!==-1}var r=[],s=!1;return{onIgnoreTag:function(o,a,l){if(n(o))if(l.isClosing){var c="[/removed]",u=l.position+c.length;return r.push([s!==!1?s:l.position,u]),s=!1,c}else return s||(s=l.position),"[removed]";else return e(o,a,l)},remove:function(o){var a="",l=0;return vA.forEach(r,function(c){a+=o.slice(l,c[0]),l=c[1]}),a+=o.slice(l),a}}}function nMe(t){for(var e="",i=0;i<t.length;){var n=t.indexOf("<!--",i);if(n===-1){e+=t.slice(i);break}e+=t.slice(i,n);var r=t.indexOf("-->",n);if(r===-1)break;i=r+3}return e}function rMe(t){var e=t.split("");return e=e.filter(function(i){var n=i.charCodeAt(0);return n===127?!1:n<=31?n===10||n===13:!0}),e.join("")}mn.whiteList=qne();mn.getDefaultWhiteList=qne;mn.onTag=UCe;mn.onIgnoreTag=GCe;mn.onTagAttr=HCe;mn.onIgnoreTagAttr=qCe;mn.safeAttrValue=WCe;mn.escapeHtml=Jne;mn.escapeQuote=Zne;mn.unescapeQuote=Yne;mn.escapeHtmlEntities=Xne;mn.escapeDangerHtml5Entities=Kne;mn.clearNonPrintableCharacter=Qne;mn.friendlyAttrValue=ere;mn.escapeAttrValue=tre;mn.onIgnoreTagStripAll=tMe;mn.StripTagBody=iMe;mn.stripCommentTag=nMe;mn.stripBlankChar=rMe;mn.cssFilter=Wne;mn.getDefaultCSSWhiteList=BCe;var IP={},jp=xV;function sMe(t){var e=jp.spaceIndex(t),i;return e===-1?i=t.slice(1,-1):i=t.slice(1,e+1),i=jp.trim(i).toLowerCase(),i.slice(0,1)==="/"&&(i=i.slice(1)),i.slice(-1)==="/"&&(i=i.slice(0,-1)),i}function oMe(t){return t.slice(0,2)==="</"}function aMe(t,e,i){var n="",r=0,s=!1,o=!1,a=0,l=t.length,c="",u="";e:for(a=0;a<l;a++){var d=t.charAt(a);if(s===!1){if(d==="<"){s=a;continue}}else if(o===!1){if(d==="<"){n+=i(t.slice(r,a)),s=a,r=a;continue}if(d===">"){n+=i(t.slice(r,s)),u=t.slice(s,a+1),c=sMe(u),n+=e(s,n.length,c,u,oMe(u)),r=a+1,s=!1;continue}if(d==='"'||d==="'")for(var f=1,m=t.charAt(a-f);m.trim()===""||m==="=";){if(m==="="){o=d;continue e}m=t.charAt(a-++f)}}else if(d===o){o=!1;continue}}return r<t.length&&(n+=i(t.substr(r))),n}var lMe=/[^a-zA-Z0-9\\_:.-]/gim;function cMe(t,e){var i=0,n=0,r=[],s=!1,o=t.length;function a(f,m){if(f=jp.trim(f),f=f.replace(lMe,"").toLowerCase(),!(f.length<1)){var g=e(f,m||"");g&&r.push(g)}}for(var l=0;l<o;l++){var c=t.charAt(l),u,d;if(s===!1&&c==="="){s=t.slice(i,l),i=l+1,n=t.charAt(i)==='"'||t.charAt(i)==="'"?i:hMe(t,l+1);continue}if(s!==!1&&l===n){if(d=t.indexOf(c,l+1),d===-1)break;u=jp.trim(t.slice(n+1,d)),a(s,u),s=!1,l=d,i=l+1;continue}if(/\s|\n|\t/.test(c))if(t=t.replace(/\s|\n|\t/g," "),s===!1)if(d=uMe(t,l),d===-1){u=jp.trim(t.slice(i,l)),a(u),s=!1,i=l+1;continue}else{l=d-1;continue}else if(d=dMe(t,l-1),d===-1){u=jp.trim(t.slice(i,l)),u=qU(u),a(s,u),s=!1,i=l+1;continue}else continue}return i<t.length&&(s===!1?a(t.slice(i)):a(s,qU(jp.trim(t.slice(i))))),jp.trim(r.join(" "))}function uMe(t,e){for(;e<t.length;e++){var i=t[e];if(i!==" ")return i==="="?e:-1}}function hMe(t,e){for(;e<t.length;e++){var i=t[e];if(i!==" ")return i==="'"||i==='"'?e:-1}}function dMe(t,e){for(;e>0;e--){var i=t[e];if(i!==" ")return i==="="?e:-1}}function pMe(t){return t[0]==='"'&&t[t.length-1]==='"'||t[0]==="'"&&t[t.length-1]==="'"}function qU(t){return pMe(t)?t.substr(1,t.length-2):t}IP.parseTag=aMe;IP.parseAttr=cMe;var fMe=q2.exports.FilterCSS,rc=mn,ire=IP,mMe=ire.parseTag,gMe=ire.parseAttr,IM=xV;function uI(t){return t==null}function yMe(t){var e=IM.spaceIndex(t);if(e===-1)return{html:"",closing:t[t.length-2]==="/"};t=IM.trim(t.slice(e+1,-1));var i=t[t.length-1]==="/";return i&&(t=IM.trim(t.slice(0,-1))),{html:t,closing:i}}function vMe(t){var e={};for(var i in t)e[i]=t[i];return e}function _Me(t){var e={};for(var i in t)Array.isArray(t[i])?e[i.toLowerCase()]=t[i].map(function(n){return n.toLowerCase()}):e[i.toLowerCase()]=t[i];return e}function nre(t){t=vMe(t||{}),t.stripIgnoreTag&&(t.onIgnoreTag&&console.error('Notes: cannot use these two options "stripIgnoreTag" and "onIgnoreTag" at the same time'),t.onIgnoreTag=rc.onIgnoreTagStripAll),t.whiteList||t.allowList?t.whiteList=_Me(t.whiteList||t.allowList):t.whiteList=rc.whiteList,t.onTag=t.onTag||rc.onTag,t.onTagAttr=t.onTagAttr||rc.onTagAttr,t.onIgnoreTag=t.onIgnoreTag||rc.onIgnoreTag,t.onIgnoreTagAttr=t.onIgnoreTagAttr||rc.onIgnoreTagAttr,t.safeAttrValue=t.safeAttrValue||rc.safeAttrValue,t.escapeHtml=t.escapeHtml||rc.escapeHtml,this.options=t,t.css===!1?this.cssFilter=!1:(t.css=t.css||{},this.cssFilter=new fMe(t.css))}nre.prototype.process=function(t){if(t=t||"",t=t.toString(),!t)return"";var e=this,i=e.options,n=i.whiteList,r=i.onTag,s=i.onIgnoreTag,o=i.onTagAttr,a=i.onIgnoreTagAttr,l=i.safeAttrValue,c=i.escapeHtml,u=e.cssFilter;i.stripBlankChar&&(t=rc.stripBlankChar(t)),i.allowCommentTag||(t=rc.stripCommentTag(t));var d=!1;i.stripIgnoreTagBody&&(d=rc.StripTagBody(i.stripIgnoreTagBody,s),s=d.onIgnoreTag);var f=mMe(t,function(m,g,y,_,b){var w={sourcePosition:m,position:g,isClosing:b,isWhite:Object.prototype.hasOwnProperty.call(n,y)},x=r(y,_,w);if(!uI(x))return x;if(w.isWhite){if(w.isClosing)return"</"+y+">";var S=yMe(_),T=n[y],I=gMe(S.html,function(C,M){var E=IM.indexOf(T,C)!==-1,A=o(y,C,M,E);return uI(A)?E?(M=l(y,C,M,u),M?C+'="'+M+'"':C):(A=a(y,C,M,E),uI(A)?void 0:A):A});return _="<"+y,I&&(_+=" "+I),S.closing&&(_+=" /"),_+=">",_}else return x=s(y,_,w),uI(x)?c(_):x},c);return d&&(f=d.remove(f)),f};var bMe=nre;(function(t,e){var i=mn,n=IP,r=bMe;function s(a,l){var c=new r(l);return c.process(a)}e=t.exports=s,e.filterXSS=s,e.FilterXSS=r,function(){for(var a in i)e[a]=i[a];for(var l in n)e[l]=n[l]}();function o(){return typeof self<"u"&&typeof DedicatedWorkerGlobalScope<"u"&&self instanceof DedicatedWorkerGlobalScope}o()&&(self.filterXSS=t.exports)})(Gg,Gg.exports);var wMe=function(){function t(e,i){var n=this;this.arcgisWhiteList={a:["href","style","target"],abbr:["title"],audio:["autoplay","controls","loop","muted","preload"],b:[],br:[],dd:["style"],div:["align","style"],dl:["style"],dt:["style"],em:[],figcaption:["style"],figure:["style"],font:["color","face","size","style"],h1:["style"],h2:["style"],h3:["style"],h4:["style"],h5:["style"],h6:["style"],hr:[],i:[],img:["alt","border","height","src","style","width"],li:[],ol:[],p:["style"],source:["media","src","type"],span:["style"],strong:[],sub:["style"],sup:["style"],table:["border","cellpadding","cellspacing","height","style","width"],tbody:[],tr:["align","height","style","valign"],td:["align","colspan","height","nowrap","rowspan","style","valign","width"],th:["align","colspan","height","nowrap","rowspan","style","valign","width"],u:[],ul:[],video:["autoplay","controls","height","loop","muted","poster","preload","width"]},this.allowedProtocols=["http","https","mailto","iform","tel","flow","lfmobile","arcgis-navigator","arcgis-appstudio-player","arcgis-survey123","arcgis-collector","arcgis-workforce","arcgis-explorer","arcgis-trek2there","arcgis-quickcapture","mspbi","comgooglemaps","pdfefile","pdfehttp","pdfehttps","boxapp","boxemm","awb","awbs","gropen","radarscope"],this.arcgisFilterOptions={allowCommentTag:!0,safeAttrValue:function(s,o,a,l){return s==="a"&&o==="href"||(s==="img"||s==="source")&&o==="src"?n.sanitizeUrl(a):Gg.exports.safeAttrValue(s,o,a,l)}},this._entityMap={"&":"&#x38;","<":"&#x3C;",">":"&#x3E;",'"':"&#x22;","'":"&#x27;","/":"&#x2F;"};var r;e&&!i?r=e:e&&i?(r=Object.create(this.arcgisFilterOptions),Object.keys(e).forEach(function(s){s==="whiteList"?r.whiteList=n._extendObjectOfArrays([n.arcgisWhiteList,e.whiteList||{}]):r[s]=e[s]})):(r=Object.create(this.arcgisFilterOptions),r.whiteList=this.arcgisWhiteList),this.xssFilterOptions=r,this._xssFilter=new Gg.exports.FilterXSS(r)}return t.prototype.sanitize=function(e,i){switch(i===void 0&&(i={}),typeof e){case"number":return isNaN(e)||!isFinite(e)?null:e;case"boolean":return e;case"string":return this._xssFilter.process(e);case"object":return this._iterateOverObject(e,i);default:return i.allowUndefined&&typeof e>"u"?void 0:null}},t.prototype.sanitizeUrl=function(e,i){var n=(i??{}).isProtocolRequired,r=n===void 0?!0:n,s=this._trim(e.substring(0,e.indexOf(":"))),o=e==="/",a=/^#/.test(e),l=s&&this.allowedProtocols.indexOf(s.toLowerCase())>-1;return o||a||l?Gg.exports.escapeAttrValue(e):!s&&!r?Gg.exports.escapeAttrValue("https://".concat(e)):""},t.prototype.sanitizeHTMLAttribute=function(e,i,n,r){return typeof this.xssFilterOptions.safeAttrValue=="function"?this.xssFilterOptions.safeAttrValue(e,i,n,r):Gg.exports.safeAttrValue(e,i,n,r)},t.prototype.validate=function(e,i){i===void 0&&(i={});var n=this.sanitize(e,i);return{isValid:e===n,sanitized:n}},t.prototype.encodeHTML=function(e){var i=this;return String(e).replace(/[&<>"'\/]/g,function(n){return i._entityMap[n]})},t.prototype.encodeAttrValue=function(e){var i=/^[a-zA-Z0-9]$/;return String(e).replace(/[\x00-\xFF]/g,function(n,r){return i.test(n)?n:"&#x".concat(Number(e.charCodeAt(r)).toString(16),";")})},t.prototype._extendObjectOfArrays=function(e){var i={};return e.forEach(function(n){Object.keys(n).forEach(function(r){Array.isArray(n[r])&&Array.isArray(i[r])?i[r]=i[r].concat(n[r]):i[r]=n[r]})}),i},t.prototype._iterateOverObject=function(e,i){var n=this;i===void 0&&(i={});try{var r=!1,s=void 0;if(Array.isArray(e))s=e.reduce(function(a,l){var c=n.validate(l,i);return c.isValid?a.concat([l]):(r=!0,a.concat([c.sanitized]))},[]);else if($Ce(e)){var o=Object.keys(e);s=o.reduce(function(a,l){var c=e[l],u=n.validate(c,i);return u.isValid?a[l]=c:(r=!0,a[l]=u.sanitized),a},{})}else return i.allowUndefined&&typeof e>"u"?void 0:null;return r?s:e}catch{return null}},t.prototype._trim=function(e){return String.prototype.trim?e.trim():e.replace(/(^\s*)|(\s*$)/g,"")},t}();const CP=new Map;function rre(){CP.clear()}function xMe(t){return CP.get(t)}function SMe(t,e){CP.set(t,e)}function L3(t){CP.delete(t)}var Vy,ab,TMe=function(t){if("WebkitTransition"in t.style)Vy="webkitTransitionEnd",ab="webkitAnimationEnd";else{if(!("transition"in t.style))throw new Error("Your browser is not supported!");Vy="transitionend",ab="animationend"}},sre=function(t){Vy||TMe(t)},IMe=function(t,e){return e===void 0&&(e=t+"-active"),function(i){sre(i);var n=!1,r=function(s){n||(n=!0,i.removeEventListener(Vy,r),i.removeEventListener(ab,r),i.classList.remove(t),i.classList.remove(e))};i.classList.add(t),i.addEventListener(Vy,r),i.addEventListener(ab,r),requestAnimationFrame(function(){i.classList.add(e)})}},CMe=function(t,e){return e===void 0&&(e=t+"-active"),function(i,n){sre(i);var r=!1,s=function(o){r||(r=!0,i.removeEventListener(Vy,s),i.removeEventListener(ab,s),n())};i.classList.add(t),i.addEventListener(Vy,s),i.addEventListener(ab,s),requestAnimationFrame(function(){i.classList.add(e)})}};const MMe=ne.getLogger("esri.widgets.support.widgetUtils");function u_(t){const e=eo.acquire();for(let n=0;n<arguments.length;n++){const r=arguments[n],s=typeof r;if(s==="string")e.push(r);else if(Array.isArray(r))e.push.apply(e,r);else if(s==="object")for(const o in r)r[o]&&e.push(o)}const i=e.join(" ");return eo.release(e),i}const EMe=(()=>{const t=new Map,e=new ResizeObserver(n=>{var r;rre();for(const s of n)(r=t.get(s.target))==null||r(s)}),i=(n,r,s)=>(t.has(n)&&MMe.error("Already observing element",n),t.set(n,r),e.observe(n,s),br(()=>{e.unobserve(n),t.delete(n)}));return(n,r,s)=>{let o=null;return Q(()=>typeof n=="function"?n():n,a=>{o==null||o.remove(),a&&(o=i(a,r,s))},Oi)}})();function Mc(t){const e=t==null?void 0:t.closest("[dir]");return e!==null&&e instanceof HTMLElement&&e.dir==="rtl"||document.dir==="rtl"}function ore(t){return Mc(t)?"rtl":"ltr"}function Rct(t){const e="data-node-ref";this[t.getAttribute(e)]=null}function uf(t){const e="data-node-ref";this[t.getAttribute(e)]=t}function Dct(t,e){return(t==="enter"?IMe:CMe)(e)}const AMe=["dd","dl","dt","h1","h2","h3","h4","h5","h6","sub","sup","animate","animatetransform","circle","clippath","defs","ellipse","g","image","line","lineargradient","marker","mask","path","pattern","polygon","polyline","radialgradient","rect","stop","svg","switch","symbol","text","textpath","tspan","use"],$Me=AMe.reduce((t,e)=>(t[e]=[],t),{}),PMe=["align","alink","alt","bgcolor","border","cellpadding","cellspacing","class","color","cols","colspan","coords","d","dir","face","height","hspace","ismap","lang","marginheight","marginwidth","multiple","nohref","noresize","noshade","nowrap","ref","rel","rev","rows","rowspan","scrolling","shape","span","summary","tabindex","title","usemap","valign","value","vlink","vspace","width"],Ef=new wMe({whiteList:$Me,onTagAttr:(t,e,i)=>{const n=`${e}="${i}"`;if(PMe.includes(e))return n},stripIgnoreTag:!0,stripIgnoreTagBody:["script","style"]},!0);function kMe(t,e){const i=t.getBoundingClientRect(),n=e.getBoundingClientRect(),r=i.top+i.height,s=n.top+n.height,o=i.top,a=n.top;(r>s||o<a)&&t.scrollIntoView({block:"end"})}function ly(t){return t==="Enter"||t===" "}const are="http://www.w3.org/",MP=`${are}2000/svg`,lre=`${are}1999/xlink`;let WU=[],SV=(t,e)=>{let i={};return Object.keys(t).forEach(n=>{i[n]=t[n]}),e&&Object.keys(e).forEach(n=>{i[n]=e[n]}),i},TV=(t,e)=>t.vnodeSelector===e.vnodeSelector&&(t.properties&&e.properties?t.properties.key===e.properties.key&&t.properties.bind===e.properties.bind:!t.properties&&!e.properties),cre=t=>{if(typeof t!="string")throw new Error("Style values must be strings")},OMe=(t,e,i)=>{if(e.vnodeSelector!==""){for(let n=i;n<t.length;n++)if(TV(t[n],e))return n}return-1},R3=(t,e,i,n)=>{let r=t[e];if(r.vnodeSelector==="")return;let s=r.properties;if(!(s&&(s.key===void 0?s.bind:s.key))){for(let o=0;o<t.length;o++)if(o!==e){let a=t[o];if(TV(a,r))throw new Error(`${i.vnodeSelector} had a ${r.vnodeSelector} child ${n==="added"?n:"removed"}, but there is now more than one. You must add unique key properties to make them distinguishable.`)}}},LMe=t=>{if(t.properties){let e=t.properties.enterAnimation;e&&e(t.domNode,t.properties)}},cD=[],uD=!1,ure=t=>{(t.children||[]).forEach(ure),t.properties&&t.properties.afterRemoved&&t.properties.afterRemoved.apply(t.properties.bind||t.properties,[t.domNode])},JU=()=>{uD=!1,cD.forEach(ure),cD.length=0},ZU=t=>{cD.push(t),uD||(uD=!0,typeof window<"u"&&"requestIdleCallback"in window?window.requestIdleCallback(JU,{timeout:16}):setTimeout(JU,16))},YU=t=>{let e=t.domNode;if(t.properties){let i=t.properties.exitAnimation;if(i)return e.style.pointerEvents="none",void i(e,()=>{e.parentNode&&(e.parentNode.removeChild(e),ZU(t))},t.properties)}e.parentNode&&(e.parentNode.removeChild(e),ZU(t))},RMe=(t,e,i)=>{if(!e)return;let n=i.eventHandlerInterceptor,r=Object.keys(e),s=r.length;for(let o=0;o<s;o++){let a=r[o],l=e[a];if(a==="className")throw new Error('Property "className" is not supported, use "class".');if(a==="class")hD(t,l,!0);else if(a==="classes"){let c=Object.keys(l),u=c.length;for(let d=0;d<u;d++){let f=c[d];l[f]&&t.classList.add(f)}}else if(a==="styles"){let c=Object.keys(l),u=c.length;for(let d=0;d<u;d++){let f=c[d],m=l[f];m&&(cre(m),i.styleApplyer(t,f,m))}}else if(a!=="key"&&l!=null){let c=typeof l;c==="function"?(a.lastIndexOf("on",0)===0&&(n&&(l=n(a,l,t,e)),a==="oninput"&&function(){let u=l;l=function(d){u.apply(this,[d]),d.target["oninput-value"]=d.target.value}}()),t[a]=l):i.namespace===MP?a==="href"?t.setAttributeNS(lre,a,l):t.setAttribute(a,l):c==="string"&&a!=="value"?a==="innerHTML"?t[a]=Ef.sanitize(l):hre(t)&&a in t?t[a]=l:t.setAttribute(a,l):t[a]=l}}};function hre(t){if(!(t instanceof Element&&t.tagName.includes("-")))return!1;const e=window.customElements.get(t.tagName.toLowerCase());return!!e&&t instanceof e}let _A,DMe=(t,e,i)=>{if(e)for(let n of e)h_(n,t,void 0,i)},dre=(t,e,i)=>{DMe(t,e.children,i),e.text&&(t.textContent=e.text),RMe(t,e.properties,i),e.properties&&e.properties.afterCreate&&e.properties.afterCreate.apply(e.properties.bind||e.properties,[t,i,e.vnodeSelector,e.properties,e.children])},h_=(t,e,i,n)=>{let r,s=0,o=t.vnodeSelector,a=e.ownerDocument;if(o==="")r=t.domNode=a.createTextNode(t.text),i!==void 0?e.insertBefore(r,i):e.appendChild(r);else{for(let l=0;l<=o.length;++l){let c=o.charAt(l);if(l===o.length||c==="."||c==="#"){let u=o.charAt(s-1),d=o.slice(s,l);u==="."?r.classList.add(d):u==="#"?r.id=d:(d==="svg"&&(n=SV(n,{namespace:MP})),n.namespace!==void 0?r=t.domNode=a.createElementNS(n.namespace,d):(r=t.domNode=t.domNode||a.createElement(d),d==="input"&&t.properties&&t.properties.type!==void 0&&r.setAttribute("type",t.properties.type)),i!==void 0?e.insertBefore(r,i):r.parentNode!==e&&e.appendChild(r)),s=l+1}}dre(r,t,n)}},hD=(t,e,i)=>{e&&e.split(" ").forEach(n=>{n&&t.classList.toggle(n,i)})},NMe=(t,e,i,n)=>{if(!i)return;let r=!1,s=Object.keys(i),o=s.length;for(let a=0;a<o;a++){let l=s[a],c=i[l],u=e[l];if(l==="class")u!==c&&(hD(t,u,!1),hD(t,c,!0));else if(l==="classes"){let d=t.classList,f=Object.keys(c),m=f.length;for(let g=0;g<m;g++){let y=f[g],_=!!c[y];_!==!!u[y]&&(r=!0,_?d.add(y):d.remove(y))}}else if(l==="styles"){let d=Object.keys(c),f=d.length;for(let m=0;m<f;m++){let g=d[m],y=c[g];y!==u[g]&&(r=!0,y?(cre(y),n.styleApplyer(t,g,y)):n.styleApplyer(t,g,""))}}else if(c||typeof u!="string"||(c=""),l==="value"){let d=t[l];d!==c&&(t["oninput-value"]?d===t["oninput-value"]:c!==u)&&(t[l]=c,t["oninput-value"]=void 0),c!==u&&(r=!0)}else if(c!==u){let d=typeof c;d==="function"&&n.eventHandlerInterceptor||(n.namespace===MP?l==="href"?t.setAttributeNS(lre,l,c):t.setAttribute(l,c):d==="string"?l==="innerHTML"?t[l]=Ef.sanitize(c):l==="role"&&c===""?t.removeAttribute(l):hre(t)&&l in t?t[l]=c:t.setAttribute(l,c):t[l]!==c&&(t[l]=c),r=!0)}}return r},FMe=(t,e,i,n,r)=>{if(i===n)return!1;n=n||WU;let s,o=(i=i||WU).length,a=n.length,l=0,c=0,u=!1;for(;c<a;){let d=l<o?i[l]:void 0,f=n[c];if(d!==void 0&&TV(d,f))u=_A(d,f,r)||u,l++;else{let m=OMe(i,f,l+1);if(m>=0){for(s=l;s<m;s++)YU(i[s]),R3(i,s,t,"removed");u=_A(i[m],f,r)||u,l=m+1}else h_(f,e,l<o?i[l].domNode:void 0,r),LMe(f),R3(n,c,t,"added")}c++}if(o>l)for(s=l;s<o;s++)YU(i[s]),R3(i,s,t,"removed");return u};_A=(t,e,i)=>{let n=t.domNode,r=!1;if(t===e)return!1;let s=!1;if(e.vnodeSelector===""){if(e.text!==t.text){let o=n.ownerDocument.createTextNode(e.text);return n.parentNode.replaceChild(o,n),e.domNode=o,r=!0,r}e.domNode=n}else e.vnodeSelector.lastIndexOf("svg",0)===0&&(i=SV(i,{namespace:MP})),t.text!==e.text&&(s=!0,e.text===void 0?n.removeChild(n.firstChild):n.textContent=e.text),e.domNode=n,s=FMe(e,n,t.children,e.children,i)||s,s=NMe(n,t.properties,e.properties,i)||s,e.properties&&e.properties.afterUpdate&&e.properties.afterUpdate.apply(e.properties.bind||e.properties,[n,i,e.vnodeSelector,e.properties,e.children]);return s&&e.properties&&e.properties.updateAnimation&&e.properties.updateAnimation(n,e.properties,t.properties),r};let I1=(t,e)=>({getLastRender:()=>t,update:i=>{if(t.vnodeSelector!==i.vnodeSelector)throw new Error("The selector for the root VNode may not be changed. (consider using dom.merge and add one extra level to the virtual DOM)");let n=t;t=i,_A(n,i,e)},domNode:t.domNode});const zMe={namespace:void 0,performanceLogger:()=>{},eventHandlerInterceptor:void 0,styleApplyer:(t,e,i)=>{e.charAt(0)==="-"?t.style.setProperty(e,i):t.style[e]=i}};let mv=t=>SV(zMe,t),hf={create:(t,e)=>(e=mv(e),h_(t,document.createElement("div"),void 0,e),I1(t,e)),append:(t,e,i)=>(i=mv(i),h_(e,t,void 0,i),I1(e,i)),insertBefore:(t,e,i)=>(i=mv(i),h_(e,t.parentNode,t,i),I1(e,i)),merge:(t,e,i)=>(i=mv(i),e.domNode=t,dre(t,e,i),I1(e,i)),replace:(t,e,i)=>(i=mv(i),h_(e,t.parentNode,t,i),t.parentNode.removeChild(t),I1(e,i))},pre,VMe=(t,e)=>{let i=[];for(;t&&t!==e;)i.push(t),t=t.parentNode;return i};pre=Array.prototype.find?(t,e)=>t.find(e):(t,e)=>t.filter(e)[0];let jMe=(t,e)=>{let i=t;return e.forEach(n=>{i=i&&i.children?pre(i.children,r=>r.domNode===n):void 0}),i},BMe=(t,e,i)=>{let n=function(r){i("domEvent",r);let s=e(),o=VMe(r.currentTarget,s.domNode);o.reverse();let a,l=jMe(s.getLastRender(),o);return t.scheduleRender(),l&&(a=l.properties[`on${r.type}`].apply(l.properties.bind||this,arguments)),i("domEventProcessed",r),a};return(r,s,o,a)=>n},bA=t=>{let e,i,n=mv(t),r=n.performanceLogger,s=!0,o=!1,a=[],l=[],c=(d,f,m)=>{let g,y=()=>g;n.eventHandlerInterceptor=BMe(e,y,r),g=d(f,m(),n),a.push(g),l.push(m)},u=()=>{if(i=void 0,s){s=!1,r("renderStart",void 0);for(let d=0;d<a.length;d++){let f=l[d]();r("rendered",void 0),a[d].update(f),r("patched",void 0)}r("renderDone",void 0),s=!0}};return e={renderNow:u,scheduleRender:()=>{i||o||(i=requestAnimationFrame(u))},stop:()=>{i&&(cancelAnimationFrame(i),i=void 0),o=!0},resume:()=>{o=!1,s=!0,e.scheduleRender()},append:(d,f)=>{c(hf.append,d,f)},insertBefore:(d,f)=>{c(hf.insertBefore,d,f)},merge:(d,f)=>{c(hf.merge,d,f)},replace:(d,f)=>{c(hf.replace,d,f)},detach:d=>{for(let f=0;f<l.length;f++)if(l[f]===d)return l.splice(f,1),a.splice(f,1)[0];throw new Error("renderFunction was not found")}},e},op=class extends ye{constructor(){super(...arguments),this.items=new xe,this._watchUpdatingTracking=new k_,this._callbacks=new Map,this._projector=bA(),this._hiddenProjector=bA()}get needsRender(){return this.items.length>0}get updating(){var e;return((e=this._watchUpdatingTracking)==null?void 0:e.updating)??!1}initialize(){const e=document.createElement("div");e.className="esri-overlay-surface",this._set("surface",e),this._hiddenSurface=document.createElement("div"),this._hiddenSurface.setAttribute("style","visibility: hidden;"),e.appendChild(this._hiddenSurface),this._watchUpdatingTracking.addOnCollectionChange(()=>this.items,i=>{for(const n of i.added){const r=()=>n.render();this._callbacks.set(n,r),this._projector.append(this.surface,r)}for(const n of i.removed){const r=this._projector.detach(this._callbacks.get(n));this.surface.removeChild(r.domNode),this._callbacks.delete(n)}})}addItem(e){this.items.add(e)}removeItem(e){this.items.remove(e)}destroy(){this.items.removeAll(),this._callbacks.forEach(e=>this._projector.detach(e)),this._callbacks=null,this._projector=null,this._watchUpdatingTracking.destroy()}render(){this._projector.renderNow()}computeBoundingRect(e){const i=this._hiddenSurface,n=this._hiddenProjector;let r;const s=()=>(r=e.render(),r);n.append(i,s),n.renderNow();const o={left:0,top:0,right:0,bottom:0};if(r&&r.domNode){const a=r.domNode.getBoundingClientRect();o.left=a.left,o.top=a.top,o.right=a.right,o.bottom=a.bottom}for(n.detach(s);i.firstChild;)i.removeChild(i.firstChild);return o}overlaps(e,i){const n=this.computeBoundingRect(e),r=this.computeBoundingRect(i);return Math.max(n.left,r.left)<=Math.min(n.right,r.right)&&Math.max(n.top,r.top)<=Math.min(n.bottom,r.bottom)}get hasVisibleItems(){return this.items.some(e=>e.visible)}async prepare(){await document.fonts.load(this._fontString()).catch(()=>{})}renderCanvas(e){if(!this.items.some(n=>n.visible))return;const i=e.getContext("2d");i.save(),i.font=this._fontString(),this.items.forEach(n=>{i.save(),n.renderCanvas(i),i.restore()}),i.restore()}_fontString(){return`10px ${getComputedStyle(this.surface).fontFamily}`}};h([p({readOnly:!0})],op.prototype,"surface",void 0),h([p({readOnly:!0})],op.prototype,"items",void 0),h([p({readOnly:!0})],op.prototype,"needsRender",null),h([p({readOnly:!0})],op.prototype,"_watchUpdatingTracking",void 0),h([p({readOnly:!0})],op.prototype,"updating",null),op=h([P("esri.views.overlay.ViewOverlay")],op);const XU=op,D3=[0,0];function UMe(t){const e=(t.ownerDocument||window.document).defaultView,i=t.getBoundingClientRect();return D3[0]=i.left+((e==null?void 0:e.pageXOffset)??0),D3[1]=i.top+((e==null?void 0:e.pageYOffset)??0),D3}function KU(t){t&&(Une(t),t.parentNode&&t.parentNode.removeChild(t))}function GMe(t){const e=document.createElement("div");return t.appendChild(e),e}const C1=16,hI=750,HMe=512,qMe=2,WMe=t=>{let e=class extends t{constructor(...i){super(...i),this._freqInfo={freq:C1,time:hI},this._overlayRenderTaskHandle=null,this.height=0,this.overlay=null,this.position=null,this.resizing=!1,this.root=null,this.surface=null,this.suspended=!0,this.ui=null,this.userContent=null,this.width=0,this.widthBreakpoint=null,this.addHandles([Q(()=>this.cursor,n=>{const{surface:r}=this;r&&r.setAttribute("data-cursor",n)}),Q(()=>this.navigating,n=>{const{surface:r}=this;r&&r.setAttribute("data-navigating",n.toString())})])}initialize(){this.addHandles([Q(()=>this.ui,(i,n)=>this._handleUIChange(i,n),He),this.on("focus",()=>this.notifyChange("focused")),this.on("blur",()=>this.notifyChange("focused"))])}destroy(){this.destroyed||(this.ui=Je(this.ui),this.container=null)}get container(){return this._get("container")??null}set container(i){const n=this._get("container"),r=TP(i);if(r||typeof i!="string"||ne.getLogger(this).error("#container",`element with id '${i}' not found`),n===r)return;if(this._stopMeasuring(),n&&(n.classList.remove("esri-view"),this._overlayRenderTaskHandle&&(this._overlayRenderTaskHandle.remove(),this._overlayRenderTaskHandle=null),this.overlay&&(this.overlay.destroy(),this._set("overlay",null)),this.root&&(KU(this.root),this._set("root",null)),this.userContent&&(BU(this.userContent,n),KU(this.userContent),this._set("userContent",null))),!r)return this._set("width",0),this._set("height",0),this._set("position",null),this._set("suspended",!0),this._set("surface",null),void this._set("container",null);r.classList.add("esri-view");const s=document.createElement("div");s.className="esri-view-user-storage",BU(r,s),r.appendChild(s),this._set("userContent",s);const o=document.createElement("div");o.className="esri-view-root",r.insertBefore(o,r.firstChild),this._set("root",o);const a=document.createElement("div");a.className="esri-view-surface",a.setAttribute("role","application"),a.tabIndex=0,o.appendChild(a),this._set("surface",a);const l=new XU;o.appendChild(l.surface),this._set("overlay",l),this.addHandles(Q(()=>l.needsRender,c=>{c&&!this._overlayRenderTaskHandle?this._overlayRenderTaskHandle=Y_({render:()=>{var u;return(u=this.overlay)==null?void 0:u.render()}}):this._overlayRenderTaskHandle=Ri(this._overlayRenderTaskHandle)})),this.forceDOMReadyCycle(),this._set("container",r),this._startMeasuring()}get focused(){const i=document.activeElement===this.surface;return document.hasFocus()&&i}get size(){return[this.width,this.height]}blur(){var i;(i=this.surface)==null||i.blur()}focus(){var i;(i=this.surface)==null||i.focus()}pageToContainer(i,n,r){const s=this.position;return i-=s?s[0]:0,n-=s?s[1]:0,r?(r[0]=i,r[1]=n):r=[i,n],r}containerToPage(i,n,r){const s=this.position;return i+=s?s[0]:0,n+=s?s[1]:0,r?(r[0]=i,r[1]=n):r=[i,n],r}_handleUIChange(i,n){this.removeHandles("ui"),n&&n!==i&&n.destroy(),i&&(i.view=this,this.addHandles(Q(()=>this.root,r=>{i.container=r?GMe(r):null},He),"ui")),this._set("ui",i)}_stopMeasuring(){this.removeHandles("measuring"),this._get("resizing")&&this._set("resizing",!1)}_startMeasuring(){const i=this._freqInfo;i.freq=C1,i.time=hI,this.addHandles([(()=>{const n=()=>{i.freq=C1,i.time=hI};return window.addEventListener("resize",n),{remove(){window.removeEventListener("resize",n)}}})(),Y_({prepare:n=>{const r=this._measure(),s=this._freqInfo;if(s.time+=n.deltaTime,r&&(s.freq=C1,this._get("resizing")||this._set("resizing",!0)),s.time<s.freq)return;s.time=0;const o=this._position();s.freq=o||r?C1:Math.min(hI,s.freq*qMe),!r&&s.freq>=HMe&&this._get("resizing")&&this._set("resizing",!1)}})],"measuring"),this._measure(),this._position()}_measure(){const i=this.container,n=i?i.clientWidth:0,r=i?i.clientHeight:0;if(n===0||r===0)return this.suspended||this._set("suspended",!0),!1;const s=this.width,o=this.height;return n===s&&r===o?(this.suspended&&this._set("suspended",!1),!1):(this._set("width",n),this._set("height",r),this.suspended&&this._set("suspended",!1),this.emit("resize",{oldWidth:s,oldHeight:o,width:n,height:r}),!0)}_position(){const i=this.container,n=this.position,r=i&&UMe(i);return!!r&&(!n||r[0]!==n[0]||r[1]!==n[1])&&(this._set("position",[r[0],r[1]]),!0)}forceDOMReadyCycle(){}};return h([p()],e.prototype,"container",null),h([p({readOnly:!0})],e.prototype,"focused",null),h([p({readOnly:!0})],e.prototype,"height",void 0),h([p({type:XU})],e.prototype,"overlay",void 0),h([p({readOnly:!0})],e.prototype,"position",void 0),h([p({readOnly:!0})],e.prototype,"resizing",void 0),h([p({readOnly:!0})],e.prototype,"root",void 0),h([p({value:null,readOnly:!0})],e.prototype,"size",null),h([p({readOnly:!0})],e.prototype,"surface",void 0),h([p({readOnly:!0})],e.prototype,"suspended",void 0),h([p()],e.prototype,"ui",void 0),h([p({readOnly:!0})],e.prototype,"userContent",void 0),h([p({readOnly:!0})],e.prototype,"width",void 0),h([p()],e.prototype,"widthBreakpoint",void 0),e=h([P("esri.views.DOMContainer")],e),e};let JMe=class{constructor(e,i){this._owner=i,this._properties={},this._afterDispatchHandle=null;for(const n in e){const r=e[n],s=new xK(r,void 0,void 0,2,2);this._properties[n]={pool:s,acquired:[]}}this._afterDispatchHandle=zye(()=>this._release())}destroy(){this._afterDispatchHandle&&(this._afterDispatchHandle.remove(),this._afterDispatchHandle=null);for(const e in this._properties){const i=this._properties[e];for(const n of i.acquired)XB(n)||i.pool.release(n);i.pool.destroy(),i.pool=null,i.acquired=null}this._properties=null,this._owner=null}get(e){const i=this._owner._get(e),n=this._properties[e];let r=n.pool.acquire();for(n.acquired.push(r);r===i;)n.acquired.push(r),r=n.pool.acquire();return r}_release(){for(const e in this._properties){const i=this._properties[e];let n=0;for(const r of i.acquired)XB(r)?i.acquired[n++]=r:i.pool.release(r);i.acquired.length=n}}};const ZMe=ee("mac")?"Meta":"Ctrl",EP={8:"Backspace",9:"Tab",13:"Enter",27:"Escape",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete"};for(let t=48;t<58;t++)EP[t]=String.fromCharCode(t);for(let t=1;t<25;t++)EP[111+t]=`F${t}`;for(let t=65;t<91;t++)EP[t]=[String.fromCharCode(t+32),String.fromCharCode(t)];function YMe(t){if(t.key!==void 0)return Uh(t);const e=EP[t.keyCode];return Array.isArray(e)?t.shiftKey?e[1]:e[0]:e}function XMe(t){switch(t){case"Ctrl":case"Alt":case"Shift":case"Meta":case"Primary":return!0}return!1}let KMe=class{constructor(e,i=[]){this.eventType=e,this.keyModifiers=i}matches(e){if(e.type!==this.eventType)return!1;if(this.keyModifiers.length===0)return!0;const i=e.modifiers;for(const n of this.keyModifiers)if(!i.has(n))return!1;return!0}};const QU=ne.getLogger("esri.views.input.InputHandler");let Sr=class{constructor(e){this._manager=null,this._incoming={},this._outgoing={},this._incomingEventMatches=null,this._incomingEventTypes=null,this._outgoingEventTypes=null,this._hasSideEffects=e}get incomingEventMatches(){if(!this._incomingEventMatches){this._incomingEventMatches=[];for(const e in this._incoming){const i=this._incoming[e];for(const n of i)this._incomingEventMatches.push(n.match)}}return this._incomingEventMatches}get incomingEventTypes(){return this._incomingEventTypes||(this._incomingEventTypes=this.incomingEventMatches.map(e=>e.eventType)),this._incomingEventTypes}get outgoingEventTypes(){return this._outgoingEventTypes||(this._outgoingEventTypes=Object.keys(this._outgoing)),this._outgoingEventTypes}get hasSideEffects(){return this._hasSideEffects}get hasPendingInputs(){return!1}onInstall(e){this._manager?QU.error("This InputHandler has already been registered with an InputManager"):(e.setEventCallback(i=>this._handleEvent(i)),e.setUninstallCallback(()=>this._onUninstall()),this._manager=e)}onUninstall(){}registerIncoming(e,i,n){let r;typeof i=="function"?(n=i,r=[]):r=i||[];const s=typeof e=="string"?new KMe(e,r):e,o=()=>{this._incomingEventTypes=null,this._incomingEventMatches=null},a=u=>{const d=this._incoming[u.match.eventType];if(d){const f=d.indexOf(u);d.splice(f,1),o(),this._manager&&this._manager.updateDependencies()}},l=new QMe(s,n,{onPause:a,onRemove:a,onResume:u=>{const d=this._incoming[u.match.eventType];d&&!d.includes(u)&&(d.push(u),o(),this._manager&&this._manager.updateDependencies())}});let c=this._incoming[s.eventType];return c||(c=[],this._incoming[s.eventType]=c),c.push(l),o(),this._manager&&this._manager.updateDependencies(),l}registerOutgoing(e){if(this._outgoing[e])throw new Error("There is already a callback registered for this outgoing InputEvent: "+e);const i=new eEe(e,{onEmit:(n,r,s,o)=>{var a;(a=this._manager)==null||a.emit(n.eventType,r,s,o)},onRemove:n=>{var r;delete this._outgoing[n.eventType],(r=this._manager)==null||r.updateDependencies()}});return this._outgoing[e]=i,this._outgoingEventTypes=null,this._manager&&this._manager.updateDependencies(),i}startCapturingPointer(e){var i;(i=this._manager)==null||i.setPointerCapture(e,!0)}stopCapturingPointer(e){var i;(i=this._manager)==null||i.setPointerCapture(e,!1)}refreshHasPendingInputs(){var e;(e=this._manager)==null||e.refreshHasPendingInputs()}_onUninstall(){this._manager?(this.onUninstall(),this._manager=null):QU.error("This InputHandler is not registered with an InputManager")}_handleEvent(e){var n;const i=this._incoming[e.type];if(i){for(const r of i)if(r.match.matches(e)&&((n=r.callback)==null||n.call(r,e),e.shouldStopPropagation()))break}}},QMe=class{constructor(e,i,n){this.match=e,this._callback=i,this._handler=n}pause(){this._handler.onPause(this)}resume(){this._handler.onResume(this)}remove(){this._handler.onRemove(this)}get callback(){return this._callback}},eEe=class{constructor(e,i){this.eventType=e,this._removed=!1,this._handler=i}emit(e,i,n){this._removed||this._handler.onEmit(this,e,i,n)}remove(){this._removed=!0,this._handler.onRemove(this)}},tEe=class extends Sr{constructor(e){super(!0),this._onChange=e,this._value="mouse",this._x=null,this._y=null,this.registerIncoming("pointer-move",i=>{this._update(i.data)})}_update(e){const i=e.native.pointerType==="touch"?"touch":"mouse",{x:n,y:r}=e;i===this._value&&this._x===n&&this._y===r||(this._value=i,this._x=n,this._y=r,this._onChange(i,n,r))}},iEe=class{constructor(e,i){this._observable=new X$,this._value=e,this._equalityFunction=i}get value(){return We(this._observable),this._value}set value(e){this._equalityFunction(e,this._value)||(this._value=e,this._observable.notify())}mutate(e){e(this._value),this._observable.notify()}};function wA(t,e=rK){return new iEe(t,e)}let nEe=class extends Sr{get multiTouchActive(){return this._multiTouchActive.value}constructor(){super(!0),this._activeTouchPointerIds=new Set,this._multiTouchActive=wA(!1),this._onPointerAdd=({data:e})=>{e.pointerType==="touch"&&(this._activeTouchPointerIds.add(e.native.pointerId),this._update())},this._onPointerRemove=({data:e})=>{e.pointerType==="touch"&&(this._activeTouchPointerIds.delete(e.native.pointerId),this._update())},this.registerIncoming("pointer-down",this._onPointerAdd),this.registerIncoming("pointer-up",this._onPointerRemove),this.registerIncoming("pointer-capture-lost",this._onPointerRemove),this.registerIncoming("pointer-cancel",this._onPointerRemove)}_update(){this._multiTouchActive.value=this._activeTouchPointerIds.size>1}},za=class extends ye{constructor(e){super(e),this._pointerCaptures=new Map,this._nameToGroup={},this._handlers=[],this._handlersPriority=[],this._currentPropagation=null,this._updateDependenciesAfterPropagation=!1,this._sourceEvents=new Set,this._keyModifiers=new Set,this._activeKeyModifiers=new Set,this._stoppedPropagationEventIds=new Set,this.primaryKey=ZMe,this._latestPointerType="mouse",this._propertiesPool=new JMe({latestPointerLocation:oEe},this),this.latestPointerLocation=null,this._paused=!1,this.test={timestamp:void 0,hasCurrentPropagation:()=>!!this._currentPropagation}}initialize(){this.eventSource.onEventReceived=this._onEventReceived.bind(this),this._installRecognizers()}destroy(){const e=Object.keys(this._nameToGroup);for(const i of e)this.uninstallHandlers(i);this.eventSource.destroy(),this._currentPropagation=null,this._propertiesPool.destroy()}get hasPendingInputs(){return this._handlers.some(e=>e.handler.hasPendingInputs)}get latestPointerType(){return this._latestPointerType}get multiTouchActive(){return this._multiTouchHandler.multiTouchActive}get updating(){return this.hasPendingInputs||this._paused}installHandlers(e,i,n=gi.INTERNAL){if(this._nameToGroup[e])return void ne.getLogger(this).error("There is already an InputHandler group registered under the name `"+e+"`");if(i.length===0)return void ne.getLogger(this).error("Can't register a group of zero handlers");const r={name:e,handlers:i.map(s=>({handler:s,active:!0,removed:!1,priorityIndex:0,groupPriority:n,eventCallback:null,uninstallCallback:null}))};this._nameToGroup[e]=r;for(let s=r.handlers.length-1;s>=0;s--){const o=r.handlers[s];this._handlers.push(o),o.handler.onInstall({updateDependencies:()=>{this.updateDependencies()},emit:(a,l,c,u,d)=>{this._emitInputEvent(o.priorityIndex+1,a,l,c,d,u)},setPointerCapture:(a,l)=>{this._setPointerCapture(r,o,a,l)},setEventCallback:a=>{o.eventCallback=a},setUninstallCallback:a=>{o.uninstallCallback=a},refreshHasPendingInputs:()=>{this.notifyChange("hasPendingInputs")}})}this.updateDependencies()}uninstallHandlers(e){const i=this._nameToGroup[e];i?(i.handlers.forEach(n=>{var r;n.removed=!0,(r=n.uninstallCallback)==null||r.call(n)}),delete this._nameToGroup[e],this._currentPropagation?this._currentPropagation.needsHandlerGarbageCollect=!0:this._garbageCollectRemovedHandlers()):ne.getLogger(this).error("There is no InputHandler group registered under the name `"+e+"`")}hasHandlers(e){return this._nameToGroup[e]!==void 0}updateDependencies(){if(this._currentPropagation)return void(this._updateDependenciesAfterPropagation=!0);this._updateDependenciesAfterPropagation=!1;const e=new Set,i=new Set;this._handlersPriority=[];for(let n=this._handlers.length-1;n>=0;n--){const r=this._handlers[n];r.priorityIndex=n,this._handlersPriority.push(r)}this._handlersPriority=this._sortHandlersPriority(this._handlersPriority);for(let n=this._handlersPriority.length-1;n>=0;n--){const r=this._handlersPriority[n];r.priorityIndex=n;let s=r.handler.hasSideEffects;if(!s){for(const o of r.handler.outgoingEventTypes)if(e.has(o)){s=!0;break}}if(s)for(const o of r.handler.incomingEventMatches){e.add(o.eventType);for(const a of o.keyModifiers)XMe(a)||i.add(a)}r.active=s}this._sourceEvents=e,this._keyModifiers=i,this._pointerCaptures.size>0&&this._sourceEvents.add("pointer-capture-lost"),this._keyModifiers.size>0&&(this._sourceEvents.add("key-down"),this._sourceEvents.add("key-up")),this.eventSource&&(this.eventSource.activeEvents=this._sourceEvents)}_setLatestPointer(e,i,n){this._latestPointerType=e;const r=this._get("latestPointerLocation");if(r==null||r.x!==i||r.y!==n){const s=this._propertiesPool.get("latestPointerLocation");s.x=i,s.y=n,this._set("latestPointerLocation",s)}}_onEventReceived(e,i){if(e==="pointer-capture-lost"){const s=i;this._pointerCaptures.delete(s.native.pointerId)}this._updateKeyModifiers(e,i);const n=this.test.timestamp!=null?this.test.timestamp:i.native?i.native.timestamp:void 0,r=i.native?i.native.cancelable:void 0;this._emitInputEventFromSource(e,i,n,r)}_updateKeyModifiers(e,i){if(!i)return;let n=!1;const r=()=>{if(!n){const a=new Set;this._activeKeyModifiers.forEach(l=>{a.add(l)}),this._activeKeyModifiers=a,n=!0}},s=(a,l)=>{l&&!this._activeKeyModifiers.has(a)?(r(),this._activeKeyModifiers.add(a)):!l&&this._activeKeyModifiers.has(a)&&(r(),this._activeKeyModifiers.delete(a))};if(e==="key-down"||e==="key-up"){const a=i.key;this._keyModifiers.has(a)&&s(a,e==="key-down")}const o=i.native;s("Alt",!(!o||!o.altKey)),s("Ctrl",!(!o||!o.ctrlKey)),s("Shift",!(!o||!o.shiftKey)),s("Meta",!(!o||!o.metaKey)),s("Primary",this._activeKeyModifiers.has(this.primaryKey))}_installRecognizers(){this._latestPointerHandler=new tEe((e,i,n)=>this._setLatestPointer(e,i,n)),this._multiTouchHandler=new nEe,this.installHandlers("input-manager-logic",[this._latestPointerHandler,this._multiTouchHandler],gi.ALWAYS),this.recognizers.length>0&&this.installHandlers("default",this.recognizers,gi.INTERNAL)}_setPointerCapture(e,i,n,r){const s=e.name+"-"+i.priorityIndex,o=this._pointerCaptures.get(n.pointerId)||new Set;this._pointerCaptures.set(n.pointerId,o),r?(o.add(s),o.size===1&&this.eventSource&&this.eventSource.setPointerCapture(n,!0)):o.has(s)&&(o.delete(s),o.size===0&&(this._pointerCaptures.delete(n.pointerId),this.eventSource&&this.eventSource.setPointerCapture(n,!1)))}_garbageCollectRemovedHandlers(){this._handlers=this._handlers.filter(e=>!e.removed),this.updateDependencies()}_emitInputEventFromSource(e,i,n,r){this._emitInputEvent(0,e,i,n,r)}_emitInputEvent(e,i,n,r,s,o){const a=r!==void 0?r:this._currentPropagation?this._currentPropagation.timestamp:performance.now(),l=s!==void 0&&s,c={event:new rEe(i,n,a,o||this._activeKeyModifiers,l),priorityIndex:e};this._currentPropagation?this._currentPropagation.events.push(c):this._doNewPropagation(c)}_doNewPropagation(e){this._currentPropagation={events:new hA,currentHandler:null,needsHandlerGarbageCollect:!1,timestamp:e.event.timestamp},this._currentPropagation.events.push(e),this._continuePropagation()}_continuePropagation(){var i,n;this._paused=!1;const e=this._currentPropagation;if(e){for(;e.events.length>0;){const{event:r,priorityIndex:s}=e.events.pop(),o=r.data&&r.data.eventId;if(!(o!=null&&this._stoppedPropagationEventIds.has(o)))for(e.currentHandler=this._handlersPriority[s];e.currentHandler;){if(e.currentHandler.removed)e.needsHandlerGarbageCollect=!0;else{if(e.currentHandler.active&&!r.shouldStopPropagation()&&((n=(i=e.currentHandler).eventCallback)==null||n.call(i,r)),r.shouldStopPropagation()){o!=null&&this._stoppedPropagationEventIds.add(o);break}if(r.shouldPausePropagation(()=>this._continuePropagation()))return void this._pausePropagation({event:r,priorityIndex:e.currentHandler.priorityIndex+1})}e.currentHandler=this._handlersPriority[e.currentHandler.priorityIndex+1]}}e.needsHandlerGarbageCollect&&this._garbageCollectRemovedHandlers(),this.hasPendingInputs||this._stoppedPropagationEventIds.clear(),this._currentPropagation=null,this._updateDependenciesAfterPropagation&&this.updateDependencies()}}_pausePropagation(e){const i=new hA;i.push(e);const n=this._currentPropagation;if(n){for(;n.events.length;)i.push(n.events.pop());n.events=i,n.currentHandler=null,this._paused=!0}}_compareHandlerPriority(e,i){if(e.handler.hasSideEffects!==i.handler.hasSideEffects)return e.handler.hasSideEffects?1:-1;if(e.groupPriority!==i.groupPriority)return e.groupPriority>i.groupPriority?-1:1;for(const n of e.handler.incomingEventMatches)for(const r of i.handler.incomingEventMatches){if(n.eventType!==r.eventType)continue;const s=n.keyModifiers.filter(o=>r.keyModifiers.includes(o));if(s.length===n.keyModifiers.length!=(s.length===r.keyModifiers.length))return n.keyModifiers.length>r.keyModifiers.length?-1:1}return e.priorityIndex>i.priorityIndex?-1:1}_sortHandlersPriority(e){const i=[];for(const n of e){let r=0;for(;r<i.length&&this._compareHandlerPriority(n,i[r])>=0;)r++;i.splice(r,0,n)}return i}get debug(){const e=i=>{const n=this._setPointerCapture;this._setPointerCapture=()=>{},i(),this._setPointerCapture=n};return{injectEvent:(i,n)=>{e(()=>{this._onEventReceived(i,n)})},disablePointerCapture:e}}};h([p({readOnly:!0})],za.prototype,"hasPendingInputs",null),h([p({constructOnly:!0})],za.prototype,"eventSource",void 0),h([p({constructOnly:!0})],za.prototype,"recognizers",void 0),h([p()],za.prototype,"_latestPointerType",void 0),h([p()],za.prototype,"latestPointerType",null),h([p()],za.prototype,"multiTouchActive",null),h([p({readOnly:!0})],za.prototype,"latestPointerLocation",void 0),h([p()],za.prototype,"_paused",void 0),h([p({readOnly:!0})],za.prototype,"updating",null),za=h([P("esri.views.input.InputManager")],za);let rEe=class{constructor(e,i,n,r,s){this.type=e,this.data=i,this.timestamp=n,this.modifiers=r,this.cancelable=s,this._propagationState=Bp.NONE,this._resumeCallback=null}stopPropagation(){this._propagationState|=Bp.STOPPED}shouldStopPropagation(){return(this._propagationState&Bp.STOPPED)!=0}async(e){this._propagationState|=Bp.PAUSED;const i=(n,r)=>{this._propagationState&=~Bp.PAUSED;const s=this._resumeCallback;if(this._resumeCallback=null,s&&s(),r)throw n;return n};return(typeof e=="function"?e():e).then(n=>i(n,!1),n=>i(n,!0))}shouldPausePropagation(e){return!!(this._propagationState&Bp.PAUSED)&&(this._resumeCallback=e,!0)}preventDefault(){this.data.native.preventDefault()}};var Bp;(function(t){t[t.NONE=0]="NONE",t[t.STOPPED=1]="STOPPED",t[t.PAUSED=2]="PAUSED"})(Bp||(Bp={}));const gi={ALWAYS:1,DEFAULT:0,TOOL:-1,WIDGET:-2,INTERNAL:-3};let sEe=class{};const oEe=sEe;function zc(t){return t!=null&&"open"in t&&"declaredClass"in t}function e7(t){return t!=null&&"declaredClass"in t&&"dockOptions"in t}const aEe=t=>{let e=class extends t{constructor(){super(...arguments),this._popupSetupTask=null,this.popup={},this.popupEnabled=!0}initialize(){this.addHandles([Q(()=>[this.ui,this.popup],([i,n],r)=>{const s="popup",o="manual";if(r){const[a,l]=r;a&&zc(l)&&(l.view=null,e7(l)&&a.remove(l,s))}i&&zc(n)&&(n.view=this,e7(n)&&i.add(n,{key:s,position:o,internal:!0}))},He),this.on("click",i=>{this.popup&&this.popupEnabled&&(i.pointerType!=="mouse"||i.button===0)&&(!zc(this.popup)&&"autoOpenEnabled"in this.popup&&this.popup.autoOpenEnabled===!1||(zc(this.popup)?this.popup.viewModel.handleViewClick(i):i.async(async()=>{await this.setupPopup(),zc(this.popup)&&!this.destroyed&&this.ready&&this.popupEnabled&&this.popup.viewModel.handleViewClick(i)})))},gi.WIDGET)]),Lu(()=>this.ready&&this.popupEnabled&&!this.updating).then(()=>{Y(()=>import("./Popup-7e549092.js").then(i=>i.a0),["./Popup-7e549092.js","./AttachmentInfo-732bf5d8.js","./executeQueryJSON-00fd007d.js","./query-d707c0a5.js","./pbfQueryUtils-380cf68a.js","./pbf-984c4807.js","./OptimizedGeometry-196224d4.js","./OptimizedFeature-4701473b.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-e903e101.js","./featureConversionUtils-7f0dd1f5.js","./TopFeaturesQuery-029fcf8a.js","./FeatureLayer-a8e9fc48.js","./FeatureLayerBase-2ef2bff9.js","./serviceCapabilitiesUtils-aa05082c.js","./editsZScale-dcc6cfd2.js","./APIKeyMixin-73fe37a5.js","./EditBusLayer-04851d7f.js","./versionUtils-4dbab3dd.js","./styleUtils-fd6677de.js","./AnchorElementViewModel-7827c70f.js"],import.meta.url)})}destroy(){this.destroyed||this.closePopup()}async openPopup(i){zc(this.popup)&&this.popup.open(i);try{if(await this.setupPopup(),!this.popup)return void ne.getLogger(this).error(new V("view:null-popup","Popup is null and can't be opened"));this.popup.open(i)}catch{}}closePopup(){var i;(i=this._popupSetupTask)==null||i.abort(),zc(this.popup)&&this.popup.close()}async fetchPopupFeatures(i,n){await this.when();const{location:r,queryArea:s,layerViewsAndGraphics:o,clientOnlyGraphics:a}=await this._prepareFetchPopupFeatures(i,n),l=Promise.resolve(a),c=this._queryLayerPopupFeatures(s,o,n),u=c.map(d=>d.promise);return{location:r,clientOnlyGraphics:a,allGraphicsPromise:TK([l,...u]).then(d=>Array.from(new Set(d.flat()))),promisesPerLayerView:c}}async setupPopup(){var i;if((i=this._popupSetupTask)==null||i.abort(),this.popup&&!zc(this.popup))return this._popupSetupTask=i0(async n=>{const{default:r}=await Y(()=>import("./Popup-7e549092.js").then(o=>o.a0),["./Popup-7e549092.js","./AttachmentInfo-732bf5d8.js","./executeQueryJSON-00fd007d.js","./query-d707c0a5.js","./pbfQueryUtils-380cf68a.js","./pbf-984c4807.js","./OptimizedGeometry-196224d4.js","./OptimizedFeature-4701473b.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-e903e101.js","./featureConversionUtils-7f0dd1f5.js","./TopFeaturesQuery-029fcf8a.js","./FeatureLayer-a8e9fc48.js","./FeatureLayerBase-2ef2bff9.js","./serviceCapabilitiesUtils-aa05082c.js","./editsZScale-dcc6cfd2.js","./APIKeyMixin-73fe37a5.js","./EditBusLayer-04851d7f.js","./versionUtils-4dbab3dd.js","./styleUtils-fd6677de.js","./AnchorElementViewModel-7827c70f.js"],import.meta.url);if(Vt(n),!this.popup||zc(this.popup))return;const s=this.popup;delete s.open,delete s.close,this.popup=new r(s)}),this._popupSetupTask.promise}_queryLayerPopupFeatures(i,n,r){return n.map(({layerView:s,graphics:o})=>{const a={clientGraphics:o,event:r!=null?r.event:void 0,signal:r!=null?r.signal:void 0,defaultPopupTemplateEnabled:r!=null&&!!r.defaultPopupTemplateEnabled},l=s.fetchPopupFeatures(i,a);return{layerView:s,promise:l}})}_isValidPopupGraphic(i,n){return i&&!!i.getEffectivePopupTemplate(n!=null&&n.defaultPopupTemplateEnabled)}async _prepareFetchPopupFeatures(i,n){const{clientGraphics:r,queryArea:s,location:o}=await this._popupHitTestGraphics(i,n),a=this._getFetchPopupLayerViews(),{layerViewsAndGraphics:l,clientOnlyGraphics:c}=this._graphicsPerFetchPopupLayerView(r,a);return{clientOnlyGraphics:c,layerViewsAndGraphics:l,queryArea:s,location:o}}async _popupHitTestGraphics(i,n){const r=await this.popupHitTest(i),s=r.results,o=r.mapPoint,a=s.filter(c=>c.type==="graphic"&&this._isValidPopupGraphic(c.graphic,n)),l=a.length?a[0].mapPoint:null;return{clientGraphics:a.map(c=>c.graphic),queryArea:o,location:o||l}}_getFetchPopupLayerViews(){const i=[];return this.allLayerViews.forEach(n=>{this._isValidPopupLayerView(n)&&i.push(n)}),this.graphicsView!=null&&this._isValidPopupLayerView(this.graphicsView)&&i.push(this.graphicsView),i.reverse()}_isValidPopupLayerView(i){return i!=null&&(!("layer"in i)||!i.suspended)&&"fetchPopupFeatures"in i}_graphicsPerFetchPopupLayerView(i,n){const r=[],s=new Map,o=n.map(a=>{const l=[];return"layer"in a?s.set(a.layer,l):s.set(a.graphics,l),{layerView:a,graphics:l}});for(const a of i){const l=s.get(a.layer)||s.get(a.sourceLayer)||null;l?l.push(a):r.push(a)}return{layerViewsAndGraphics:o,clientOnlyGraphics:r}}};return h([p({cast(i){return!i||zc(i)||typeof i=="object"&&(i.open=n=>(M2(ne.getLogger(this),"view.popup is no longer created by default. view.popup.open() will stop working when the popup isn't created",{replacement:"Use view.openPopup() instead.",version:"4.27"}),this.openPopup(n)),i.close=()=>(M2(ne.getLogger(this),"view.popup is no longer created by default. view.popup.close() will stop working when the popup isn't created",{replacement:"Use view.closePopup() instead.",version:"4.27"}),this.closePopup())),i}})],e.prototype,"popup",void 0),h([p()],e.prototype,"popupEnabled",void 0),e=h([P("esri.views.PopupView")],e),e},t7={milliseconds:1,seconds:1e3,minutes:6e4,hours:36e5,days:864e5,weeks:6048e5,months:26784e5,years:31536e6,decades:31536e7,centuries:31536e8},lEe={milliseconds:{getter:"getMilliseconds",setter:"setMilliseconds",multiplier:1},seconds:{getter:"getSeconds",setter:"setSeconds",multiplier:1},minutes:{getter:"getMinutes",setter:"setMinutes",multiplier:1},hours:{getter:"getHours",setter:"setHours",multiplier:1},days:{getter:"getDate",setter:"setDate",multiplier:1},weeks:{getter:"getDate",setter:"setDate",multiplier:7},months:{getter:"getMonth",setter:"setMonth",multiplier:1},years:{getter:"getFullYear",setter:"setFullYear",multiplier:1},decades:{getter:"getFullYear",setter:"setFullYear",multiplier:10},centuries:{getter:"getFullYear",setter:"setFullYear",multiplier:100}};function cEe(t,e){const i=new Date(t,e+1,1);return i.setDate(0),i.getDate()}function vy(t,e,i){const n=new Date(t.getTime());if(e&&i){const r=lEe[i],{getter:s,setter:o,multiplier:a}=r;if(i==="months"){const l=cEe(n.getFullYear(),n.getMonth()+e);n.getDate()>l&&n.setDate(l)}n[o](n[s]()+e*a)}return n}function i7(t,e){switch(e){case"milliseconds":return new Date(t.getTime());case"seconds":return new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds());case"minutes":return new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes());case"hours":return new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours());case"days":return new Date(t.getFullYear(),t.getMonth(),t.getDate());case"weeks":return new Date(t.getFullYear(),t.getMonth(),t.getDate()-t.getDay());case"months":return new Date(t.getFullYear(),t.getMonth(),1);case"years":return new Date(t.getFullYear(),0,1);case"decades":return new Date(t.getFullYear()-t.getFullYear()%10,0,1);case"centuries":return new Date(t.getFullYear()-t.getFullYear()%100,0,1);default:return new Date}}function uEe(t,e,i){return t===0?0:t*t7[e]/t7[i]}var jl;let la=jl=class extends ie{static get allTime(){return n7}static get empty(){return hEe}constructor(t){super(t),this.end=null,this.start=null}readEnd(t,e){return e.end!=null?new Date(e.end):null}writeEnd(t,e){e.end=t?t.getTime():null}get isAllTime(){return this.equals(jl.allTime)}get isEmpty(){return this.equals(jl.empty)}readStart(t,e){return e.start!=null?new Date(e.start):null}writeStart(t,e){e.start=t?t.getTime():null}clone(){return new jl({end:this.end,start:this.start})}equals(t){if(!t)return!1;const e=this.start!=null?this.start.getTime():this.start,i=this.end!=null?this.end.getTime():this.end,n=t.start!=null?t.start.getTime():t.start,r=t.end!=null?t.end.getTime():t.end;return e===n&&i===r}expandTo(t){if(this.isEmpty||this.isAllTime)return this.clone();const e=ot(this.start,n=>i7(n,t)),i=ot(this.end,n=>{const r=i7(n,t);return n.getTime()===r.getTime()?r:vy(r,1,t)});return new jl({start:e,end:i})}intersection(t){var a,l,c,u;if(!t)return this.clone();if(this.isEmpty||t.isEmpty)return jl.empty;if(this.isAllTime)return t.clone();if(t.isAllTime)return this.clone();const e=((a=this.start)==null?void 0:a.getTime())??-1/0,i=((l=this.end)==null?void 0:l.getTime())??1/0,n=((c=t.start)==null?void 0:c.getTime())??-1/0,r=((u=t.end)==null?void 0:u.getTime())??1/0;let s,o;if(n>=e&&n<=i?s=n:e>=n&&e<=r&&(s=e),i>=n&&i<=r?o=i:r>=e&&r<=i&&(o=r),s!=null&&o!=null&&!isNaN(s)&&!isNaN(o)){const d=new jl;return d.start=s===-1/0?null:new Date(s),d.end=o===1/0?null:new Date(o),d}return jl.empty}offset(t,e){if(this.isEmpty||this.isAllTime)return this.clone();const i=new jl,{start:n,end:r}=this;return n!=null&&(i.start=vy(n,t,e)),r!=null&&(i.end=vy(r,t,e)),i}union(t){if(!t||t.isEmpty)return this.clone();if(this.isEmpty)return t.clone();if(this.isAllTime||t.isAllTime)return n7.clone();const e=this.start!=null&&t.start!=null?new Date(Math.min(this.start.getTime(),t.start.getTime())):null,i=this.end!=null&&t.end!=null?new Date(Math.max(this.end.getTime(),t.end.getTime())):null;return new jl({start:e,end:i})}};h([p({type:Date,json:{write:{allowNull:!0}}})],la.prototype,"end",void 0),h([_e("end")],la.prototype,"readEnd",null),h([ge("end")],la.prototype,"writeEnd",null),h([p({readOnly:!0,json:{read:!1}})],la.prototype,"isAllTime",null),h([p({readOnly:!0,json:{read:!1}})],la.prototype,"isEmpty",null),h([p({type:Date,json:{write:{allowNull:!0}}})],la.prototype,"start",void 0),h([_e("start")],la.prototype,"readStart",null),h([ge("start")],la.prototype,"writeStart",null),la=jl=h([P("esri.TimeExtent")],la);const n7=new la,hEe=new la({start:void 0,end:void 0}),Bu=la,kc=t=>{let e=class extends t{constructor(){super(...arguments),this._handles=new Rs,this._updatingHandles=new k_}destroy(){this.destroyed||(this._handles.destroy(),this._updatingHandles.destroy())}get handles(){return this._handles}get updatingHandles(){return this._updatingHandles}};return h([p({readOnly:!0})],e.prototype,"handles",null),h([p({readOnly:!0})],e.prototype,"updatingHandles",null),e=h([P("esri.core.HandleOwner")],e),e};let lb=class extends kc(ye){};lb=h([P("esri.core.HandleOwner")],lb);let Bx=class extends kc(xe){constructor(e){super(e),this.handles.add([this.on("before-add",i=>{i.item==null&&i.preventDefault()}),this.on("after-add",i=>this._own(i.item)),this.on("after-remove",i=>this._release(i.item))])}get owner(){return this._get("owner")}set owner(e){e!==this._get("owner")&&(this._releaseAll(),this._set("owner",e),this._ownAll())}_ownAll(){for(const e of this.items)this._own(e)}_releaseAll(){for(const e of this.items)this._release(e)}_createNewInstance(e){return this.itemType?new(xe.ofType(this.itemType.Type))(e):new xe(e)}};function dD(t,e){return{type:t,cast:QK,set(i){const n=Of(i,this._get(e),t);n.owner=this,this._set(e,n)}}}h([p()],Bx.prototype,"owner",null),Bx=h([P("esri.core.support.OwningCollection")],Bx);var Lw;const xA=Nn()({orthometric:"gravity-related-height",gravity_related_height:"gravity-related-height",ellipsoidal:"ellipsoidal"}),fre=xA.jsonValues.slice();Pge(fre,"orthometric");const Ux=Nn()({meter:"meters",foot:"feet","us-foot":"us-feet","clarke-foot":"clarke-feet","clarke-yard":"clarke-yards","clarke-link":"clarke-links","sears-yard":"sears-yards","sears-foot":"sears-feet","sears-chain":"sears-chains","benoit-1895-b-chain":"benoit-1895-b-chains","indian-yard":"indian-yards","indian-1937-yard":"indian-1937-yards","gold-coast-foot":"gold-coast-feet","sears-1922-truncated-chain":"sears-1922-truncated-chains","50-kilometers":"50-kilometers","150-kilometers":"150-kilometers"});let Bl=Lw=class extends ie{constructor(t){super(t),this.heightModel="gravity-related-height",this.heightUnit="meters",this.vertCRS=null}writeHeightModel(t,e,i){return xA.write(t,e,i)}readHeightModel(t,e,i){return xA.read(t)||(i&&i.messages&&i.messages.push(dEe(t,{context:i})),null)}readHeightUnit(t,e,i){return Ux.read(t)||(i&&i.messages&&i.messages.push(r7(t,{context:i})),null)}readHeightUnitService(t,e,i){return IQ(t)||Ux.read(t)||(i&&i.messages&&i.messages.push(r7(t,{context:i})),null)}readVertCRS(t,e){return e.vertCRS||e.ellipsoid||e.geoid}clone(){return new Lw({heightModel:this.heightModel,heightUnit:this.heightUnit,vertCRS:this.vertCRS})}equals(t){return!!t&&(this===t||this.heightModel===t.heightModel&&this.heightUnit===t.heightUnit&&this.vertCRS===t.vertCRS)}static deriveUnitFromSR(t,e){const i=CQ(e);return new Lw({heightModel:t.heightModel,heightUnit:i,vertCRS:t.vertCRS})}write(t,e){return e={origin:"web-scene",...e},super.write(t,e)}static fromJSON(t){if(!t)return null;const e=new Lw;return e.read(t,{origin:"web-scene"}),e}};function r7(t,e){return new fl("height-unit:unsupported",`Height unit of value '${t}' is not supported`,e)}function dEe(t,e){return new fl("height-model:unsupported",`Height model of value '${t}' is not supported`,e)}h([p({type:xA.apiValues,constructOnly:!0,json:{origins:{"web-scene":{type:fre,default:"ellipsoidal"}}}})],Bl.prototype,"heightModel",void 0),h([ge("web-scene","heightModel")],Bl.prototype,"writeHeightModel",null),h([_e(["web-scene","service"],"heightModel")],Bl.prototype,"readHeightModel",null),h([p({type:Ux.apiValues,constructOnly:!0,json:{origins:{"web-scene":{type:Ux.jsonValues,write:Ux.write}}}})],Bl.prototype,"heightUnit",void 0),h([_e("web-scene","heightUnit")],Bl.prototype,"readHeightUnit",null),h([_e("service","heightUnit")],Bl.prototype,"readHeightUnitService",null),h([p({type:String,constructOnly:!0,json:{origins:{"web-scene":{write:!0}}}})],Bl.prototype,"vertCRS",void 0),h([_e("service","vertCRS",["vertCRS","ellipsoid","geoid"])],Bl.prototype,"readVertCRS",null),Bl=Lw=h([P("esri.geometry.HeightModelInfo")],Bl);const AP=Bl;let SA=class extends Bx{constructor(e){super(e),this.handles.add(this.on("before-add",i=>{i.item!=null&&i.item.parent===this.owner&&(ne.getLogger(this).warn("Analysis inside the collection must be unique. Not adding this element again."),i.preventDefault())}))}_own(e){e.parent=this.owner}_release(e){e.parent=null}};SA=h([P("esri.support.AnalysesCollection")],SA);let _y=class extends Bx{_own(e){e.layer&&"remove"in e.layer&&e.layer!==this.owner&&e.layer.remove(e),e.layer=this.owner}_release(e){e.layer===this.owner&&(e.layer=null)}};h([XK({Type:Vo,ensureType:fn(Vo)})],_y.prototype,"itemType",void 0),_y=h([P("esri.support.GraphicsCollection")],_y);const s7=new Map([["AUS Central Standard Time","Australia/Darwin"],["AUS Eastern Standard Time","Australia/Sydney"],["Afghanistan Standard Time","Asia/Kabul"],["Alaskan Standard Time","America/Anchorage"],["Aleutian Standard Time","America/Adak"],["Altai Standard Time","Asia/Barnaul"],["Arab Standard Time","Asia/Riyadh"],["Arabian Standard Time","Asia/Dubai"],["Arabic Standard Time","Asia/Baghdad"],["Argentina Standard Time","America/Buenos_Aires"],["Astrakhan Standard Time","Europe/Astrakhan"],["Atlantic Standard Time","America/Halifax"],["Aus Central W. Standard Time","Australia/Eucla"],["Azerbaijan Standard Time","Asia/Baku"],["Azores Standard Time","Atlantic/Azores"],["Bahia Standard Time","America/Bahia"],["Bangladesh Standard Time","Asia/Dhaka"],["Belarus Standard Time","Europe/Minsk"],["Bougainville Standard Time","Pacific/Bougainville"],["Canada Central Standard Time","America/Regina"],["Cape Verde Standard Time","Atlantic/Cape_Verde"],["Caucasus Standard Time","Asia/Yerevan"],["Cen. Australia Standard Time","Australia/Adelaide"],["Central America Standard Time","America/Guatemala"],["Central Asia Standard Time","Asia/Almaty"],["Central Brazilian Standard Time","America/Cuiaba"],["Central Europe Standard Time","Europe/Budapest"],["Central European Standard Time","Europe/Warsaw"],["Central Pacific Standard Time","Pacific/Guadalcanal"],["Central Standard Time","America/Chicago"],["Central Standard Time (Mexico)","America/Mexico_City"],["Chatham Islands Standard Time","Pacific/Chatham"],["China Standard Time","Asia/Shanghai"],["Cuba Standard Time","America/Havana"],["Dateline Standard Time","Etc/GMT+12"],["E. Africa Standard Time","Africa/Nairobi"],["E. Australia Standard Time","Australia/Brisbane"],["E. Europe Standard Time","Europe/Chisinau"],["E. South America Standard Time","America/Sao_Paulo"],["Easter Island Standard Time","Pacific/Easter"],["Eastern Standard Time","America/New_York"],["Eastern Standard Time (Mexico)","America/Cancun"],["Egypt Standard Time","Africa/Cairo"],["Ekaterinburg Standard Time","Asia/Yekaterinburg"],["FLE Standard Time","Europe/Kiev"],["Fiji Standard Time","Pacific/Fiji"],["GMT Standard Time","Europe/London"],["GTB Standard Time","Europe/Bucharest"],["Georgian Standard Time","Asia/Tbilisi"],["Greenland Standard Time","America/Godthab"],["Greenwich Standard Time","Atlantic/Reykjavik"],["Haiti Standard Time","America/Port-au-Prince"],["Hawaiian Standard Time","Pacific/Honolulu"],["India Standard Time","Asia/Calcutta"],["Iran Standard Time","Asia/Tehran"],["Israel Standard Time","Asia/Jerusalem"],["Jordan Standard Time","Asia/Amman"],["Kaliningrad Standard Time","Europe/Kaliningrad"],["Korea Standard Time","Asia/Seoul"],["Libya Standard Time","Africa/Tripoli"],["Line Islands Standard Time","Pacific/Kiritimati"],["Lord Howe Standard Time","Australia/Lord_Howe"],["Magadan Standard Time","Asia/Magadan"],["Magallanes Standard Time","America/Punta_Arenas"],["Marquesas Standard Time","Pacific/Marquesas"],["Mauritius Standard Time","Indian/Mauritius"],["Middle East Standard Time","Asia/Beirut"],["Montevideo Standard Time","America/Montevideo"],["Morocco Standard Time","Africa/Casablanca"],["Mountain Standard Time","America/Denver"],["Mountain Standard Time (Mexico)","America/Mazatlan"],["Myanmar Standard Time","Asia/Rangoon"],["N. Central Asia Standard Time","Asia/Novosibirsk"],["Namibia Standard Time","Africa/Windhoek"],["Nepal Standard Time","Asia/Katmandu"],["New Zealand Standard Time","Pacific/Auckland"],["Newfoundland Standard Time","America/St_Johns"],["Norfolk Standard Time","Pacific/Norfolk"],["North Asia East Standard Time","Asia/Irkutsk"],["North Asia Standard Time","Asia/Krasnoyarsk"],["North Korea Standard Time","Asia/Pyongyang"],["Omsk Standard Time","Asia/Omsk"],["Pacific SA Standard Time","America/Santiago"],["Pacific Standard Time","America/Los_Angeles"],["Pacific Standard Time (Mexico)","America/Tijuana"],["Pakistan Standard Time","Asia/Karachi"],["Paraguay Standard Time","America/Asuncion"],["Qyzylorda Standard Time","Asia/Qyzylorda"],["Romance Standard Time","Europe/Paris"],["Russia Time Zone 10","Asia/Srednekolymsk"],["Russia Time Zone 11","Asia/Kamchatka"],["Russia Time Zone 3","Europe/Samara"],["Russian Standard Time","Europe/Moscow"],["SA Eastern Standard Time","America/Cayenne"],["SA Pacific Standard Time","America/Bogota"],["SA Western Standard Time","America/La_Paz"],["SE Asia Standard Time","Asia/Bangkok"],["Saint Pierre Standard Time","America/Miquelon"],["Sakhalin Standard Time","Asia/Sakhalin"],["Samoa Standard Time","Pacific/Apia"],["Sao Tome Standard Time","Africa/Sao_Tome"],["Saratov Standard Time","Europe/Saratov"],["Singapore Standard Time","Asia/Singapore"],["South Africa Standard Time","Africa/Johannesburg"],["South Sudan Standard Time","Africa/Juba"],["Sri Lanka Standard Time","Asia/Colombo"],["Sudan Standard Time","Africa/Khartoum"],["Syria Standard Time","Asia/Damascus"],["Taipei Standard Time","Asia/Taipei"],["Tasmania Standard Time","Australia/Hobart"],["Tocantins Standard Time","America/Araguaina"],["Tokyo Standard Time","Asia/Tokyo"],["Tomsk Standard Time","Asia/Tomsk"],["Tonga Standard Time","Pacific/Tongatapu"],["Transbaikal Standard Time","Asia/Chita"],["Turkey Standard Time","Europe/Istanbul"],["Turks And Caicos Standard Time","America/Grand_Turk"],["US Eastern Standard Time","America/Indianapolis"],["US Mountain Standard Time","America/Phoenix"],["UTC","Etc/GMT"],["UTC+01","Etc/GMT-1"],["UTC+02","Etc/GMT-2"],["UTC+03","Etc/GMT-3"],["UTC+04","Etc/GMT-4"],["UTC+05","Etc/GMT-5"],["UTC+06","Etc/GMT-6"],["UTC+07","Etc/GMT-7"],["UTC+08","Etc/GMT-8"],["UTC+09","Etc/GMT-9"],["UTC+10","Etc/GMT-10"],["UTC+11","Etc/GMT-11"],["UTC+12","Etc/GMT-12"],["UTC+13","Etc/GMT-13"],["UTC+14","Etc/GMT-14"],["UTC-01","Etc/GMT+1"],["UTC-02","Etc/GMT+2"],["UTC-03","Etc/GMT+3"],["UTC-04","Etc/GMT+4"],["UTC-05","Etc/GMT+5"],["UTC-06","Etc/GMT+6"],["UTC-07","Etc/GMT+7"],["UTC-08","Etc/GMT+8"],["UTC-09","Etc/GMT+9"],["UTC-10","Etc/GMT+10"],["UTC-11","Etc/GMT+11"],["UTC-12","Etc/GMT+12"],["Ulaanbaatar Standard Time","Asia/Ulaanbaatar"],["Venezuela Standard Time","America/Caracas"],["Vladivostok Standard Time","Asia/Vladivostok"],["Volgograd Standard Time","Europe/Volgograd"],["W. Australia Standard Time","Australia/Perth"],["W. Central Africa Standard Time","Africa/Lagos"],["W. Europe Standard Time","Europe/Berlin"],["W. Mongolia Standard Time","Asia/Hovd"],["West Asia Standard Time","Asia/Tashkent"],["West Bank Standard Time","Asia/Hebron"],["West Pacific Standard Time","Pacific/Port_Moresby"],["Yakutsk Standard Time","Asia/Yakutsk"],["Yukon Standard Time","America/Whitehorse"]]);function pEe(t,e="system"){if(!t||!s7.has(t.timeZone))return e;const i=s7.get(t.timeZone);return mEe(t.timeZone)||t.respectsDaylightSaving?i:fEe(i)}function fEe(t){const e=Ve.local().setZone(t),i=Math.min(e.set({month:1,day:1}).offset,e.set({month:5}).offset);return i===0?"Etc/UTC":`Etc/GMT${Es.instance(-i).formatOffset(0,"narrow")}`}function mEe(t){return t.startsWith("UTC")}let ap=class extends An(ie){constructor(e){super(e),this.legacy=null,this.timeZone="system"}readLegacy(e,i){const{timeZone:n,respectsDaylightSaving:r}=i;return{timeZone:n,respectsDaylightSaving:r}}readTimeZone(e,i){return"timeZoneIANA"in i?i.timeZoneIANA:pEe(i)}writeTimeZone(e,i){i.timeZoneIANA=e}equals(e){return e!=null&&this.timeZone!=null&&e.timeZone!=null&&this.timeZone===e.timeZone}};h([p()],ap.prototype,"legacy",void 0),h([_e("legacy",["timeZone"])],ap.prototype,"readLegacy",null),h([p({type:String,nonNullable:!0})],ap.prototype,"timeZone",void 0),h([_e("timeZone",["timeZone","timeZoneIANA","respectsDaylightSaving"])],ap.prototype,"readTimeZone",null),h([ge("timeZone")],ap.prototype,"writeTimeZone",null),ap=h([P("esri.time.TimeReference")],ap);const IV=ap;let lp=class extends ye{constructor(e){super(e),this.view=null,this.baseLayerViews=new xe,this.referenceLayerViews=new xe,this._loadingHandle=Q(()=>{var i,n;return(n=(i=this.view)==null?void 0:i.map)==null?void 0:n.basemap},i=>{i&&i.load().catch(()=>{})},He)}destroy(){this._set("view",null),this._loadingHandle&&(this._loadingHandle.remove(),this._loadingHandle=null);for(const e of this.baseLayerViews)e.destroy();this.baseLayerViews.length=0;for(const e of this.referenceLayerViews)e.destroy();this.referenceLayerViews.length=0}get suspended(){return!this.view||this.view.suspended}get updating(){var i,n;if(this.view&&this.view.suspended)return!1;const e=(n=(i=this.view)==null?void 0:i.map)==null?void 0:n.basemap;return!!e&&!!e.loaded&&(this.baseLayerViews.some(r=>r.updating)||this.referenceLayerViews.some(r=>r.updating))}};h([p({constructOnly:!0})],lp.prototype,"view",void 0),h([p({readOnly:!0})],lp.prototype,"baseLayerViews",void 0),h([p({readOnly:!0})],lp.prototype,"referenceLayerViews",void 0),h([p({readOnly:!0})],lp.prototype,"suspended",null),h([p({type:Boolean,readOnly:!0})],lp.prototype,"updating",null),lp=h([P("esri.views.BasemapView")],lp);function gEe(t){return"tryRecycleWith"in t}let yEe=class{constructor(e,i,n){this.layer=e,this.view=i,this.layerViewImporter=n,this._controller=new AbortController,this._deferred=xc(),this._started=!1,this.done=!1,this.promise=this._deferred.promise,Ro(this._controller.signal,()=>{const r=new V("cancelled:layerview-create","layerview creation cancelled",{layer:e});this._deferred.reject(r)})}tryRecycle(e){if(!this.done||!this.layerView||!gEe(this.layerView))return null;const i=this.layer.type,n=this._controller.signal;for(let r=0;r<e.length;r++){const s=e[r];if(s.type!==i)continue;const o=this.layerView.tryRecycleWith(s,{signal:n});if(o){e.splice(r,1),this.layer=s;const a=this.layerView,l=a.view;return this.promise=Promise.race([o.then(()=>(Vt(this._controller.signal),s.emit("layerview-destroy",{view:l,layerView:a}),l.emit("layerview-destroy",{view:l,layerView:a}),s.emit("layerview-create",{view:l,layerView:a}),l.emit("layerview-create",{view:l,layerView:a}),a)),new Promise((c,u)=>Ro(this._controller.signal,()=>u(li())))]),this.promise}}return null}destroy(){this._controller.abort();const{layerView:e}=this;if(e){const{layer:i,view:n}=this;i.emit("layerview-destroy",{view:n,layerView:e}),n.emit("layerview-destroy",{layer:i,layerView:e})}this.done=!0,this.layer=null,this.layerView=null,this.view=null,this.layerViewImporter=null,this._map=null}async start(){var r,s,o;if(this._started)return;this._started=!0;const{_controller:{signal:e},layer:i,view:n}=this;this._map=n.map;try{let a,l;if(await i.load({signal:e}),"prefetchResources"in i&&await((r=i.prefetchResources)==null?void 0:r.call(i,{signal:e})),_Ee(i))a=await i.createLayerView(n,{signal:e});else{if(!this.layerViewImporter.hasLayerViewModule(i))throw new V("layer:view-not-supported","No layerview implementation was found");const d=await this.layerViewImporter.importLayerView(i);Vt(e),a="default"in d?new d.default({layer:i,view:n}):new d({layer:i,view:n})}const c=()=>{l=Ri(l),a.destroyed||a.destroy(),a.layer=null,a.parent=null,a.view=null,this.done=!0};l=Ro(e,c),Vt(e);try{await a.when()}catch(d){throw c(),d}if(!((o=(s=this._map)==null?void 0:s.allLayers)==null?void 0:o.includes(i)))return c(),void this._deferred.reject(new V("view:no-layerview-for-layer","The layer has been removed from the map",{layer:i}));this.layerView=a,i.emit("layerview-create",{view:n,layerView:a}),n.emit("layerview-create",{layer:i,layerView:a}),this.done=!0,this._deferred.resolve(a)}catch(a){i.emit("layerview-create-error",{view:n,error:a}),n.emit("layerview-create-error",{layer:i,error:a}),this.done=!0,this._deferred.reject(new V("layerview:create-error","layerview creation failed",{layer:i,error:a}))}}},Va=class extends ye{constructor(e){super(e),this._layerLayerViewInfoMap=new Map,this._recyclingInfoMap=new Map,this._watchUpdatingTracking=new k_,this.supportsGround=!0,this._preloadLayerViewModules=()=>{var n;const i=(n=this.view.map)==null?void 0:n.allLayers;if(i)for(const r of i)this.layerViewImporter.hasLayerViewModule(r)&&this.layerViewImporter.importLayerView(r)},this._reschedule=()=>this.destroyed?Promise.reject():(this._workPromise==null&&(this._workPromise=xc(),this._workPromise.promise.catch(()=>{})),this.removeHandles("reschedule"),this.addHandles(kb(this._doWork),"reschedule"),this._workPromise.promise),this._doWork=()=>{var l,c,u;if(this.destroyed)return;const i=this.view.map;if(this._map!==i&&(this.clear(),this._map=i),this._workPromise==null)return void this.notifyChange("updating");this.removeHandles("reschedule"),this.removeHandles("collection-change");const n=new Set,r=[],s=this.view.ready,o=d=>{if(d!=null){for(const f of d)if(f){n.add(f);const m=this._layerLayerViewInfoMap.get(f);m&&s?m.start():m||this._recyclingInfoMap.has(f)||r.push(f),"layers"in f&&f.layers&&o(f.layers)}}};for(const d of this._rootCollectionNames)o(this.get(d));for(const[d,f]of this._layerLayerViewInfoMap)if(!n.has(d)){this._layerLayerViewInfoMap.delete(f.layer);const m=f.tryRecycle(r);m?(this.notifyChange("updating"),this._recyclingInfoMap.set(f.layer,f),m.then(()=>{this.notifyChange("updating"),this._recyclingInfoMap.delete(f.layer),this._layerLayerViewInfoMap.set(f.layer,f),this._reschedule()}).catch(()=>{this.notifyChange("updating"),this._recyclingInfoMap.delete(f.layer),f.destroy(),this._reschedule()})):f.destroy()}for(const[d,f]of this._recyclingInfoMap)n.has(d)||(this.notifyChange("updating"),this._recyclingInfoMap.delete(f.layer),f.destroy());for(const d of r)this._createLayerView(d);this._refreshCollections();const a=[(l=i==null?void 0:i.ground)==null?void 0:l.layers,(c=i==null?void 0:i.basemap)==null?void 0:c.baseLayers,(u=i==null?void 0:i.basemap)==null?void 0:u.referenceLayers,i==null?void 0:i.layers].filter(d=>!!d);n.forEach(d=>"layers"in d&&a.push(d.layers)),this.addHandles(a.map(d=>this._watchUpdatingTracking.addOnCollectionChange(()=>d,this._reschedule)),"collection-change"),this._workPromise.resolve(),this._workPromise=null}}initialize(){this.own([on(()=>{var e,i;return(i=(e=this.view)==null?void 0:e.map)==null?void 0:i.allLayers},"change",this._preloadLayerViewModules,{onListenerAdd:this._preloadLayerViewModules}),Q(()=>{const e=this.view,i=e==null?void 0:e.map;return[i==null?void 0:i.basemap,i==null?void 0:i.ground,i==null?void 0:i.layers,e==null?void 0:e.ready]},()=>this._reschedule(),Oi)]),this._preloadLayerViewModules(),this._reschedule()}destroy(){this.clear(),p3(this._recyclingInfoMap),p3(this._layerLayerViewInfoMap),this._watchUpdatingTracking.destroy(),this._map=null,this._workPromise!=null&&(this._workPromise.reject(li()),this._workPromise=null)}get _layersToLayerViews(){const e=[["view.map.basemap.baseLayers","view.basemapView.baseLayerViews"],["view.map.layers","view.layerViews"],["view.map.basemap.referenceLayers","view.basemapView.referenceLayerViews"]];return this.supportsGround&&e.push(["view.map.ground.layers","view.groundView.layerViews"]),new Map(e)}get _rootCollectionNames(){return Array.from(this._layersToLayerViews.keys())}get updating(){return this._workPromise!=null||this._watchUpdatingTracking.updating||OS(this._layerLayerViewInfoMap,e=>!e.done)||this._recyclingInfoMap.size>0}get updatingRemaining(){let e=0;for(const i of this._layerLayerViewInfoMap.values())i.done||++e;return e}clear(){this.destroyed||(p3(this._layerLayerViewInfoMap),this._refreshCollections())}async whenLayerView(e){if(await this._reschedule(),!this._layerLayerViewInfoMap.has(e)){if(this._recyclingInfoMap.has(e))return this._recyclingInfoMap.get(e).promise;throw new V("view:no-layerview-for-layer","No layerview has been found for the layer",{layer:e})}return this._layerLayerViewInfoMap.get(e).promise}_refreshCollections(){for(const[e,i]of this._layersToLayerViews)this._populateLayerViewsOwners(this.get(e),this.get(i),this.view);this.notifyChange("updating"),this.notifyChange("updatingRemaining")}_populateLayerViewsOwners(e,i,n){if(!e||!i)return void(i&&i.removeAll());let r=0;for(const s of e){const o=this._layerLayerViewInfoMap.get(s);if(!o||!o.layerView)continue;const a=o.layerView;a.layer=s,a.parent=n,i.at(r)!==a&&i.splice(r,0,a),s.layers&&this._populateLayerViewsOwners(s.layers,a.layerViews,a),r+=1}r<i.length&&i.splice(r,i.length)}_createLayerView(e){e.load().catch(()=>{}),this.layerViewImporter.hasLayerViewModule(e)&&this.layerViewImporter.importLayerView(e);const i=new yEe(e,this.view,this.layerViewImporter);i.promise.then(()=>this._refreshCollections(),n=>{n&&(Ds(n)||n.name==="cancelled:layerview-create")||ne.getLogger(this).error(`Failed to create layerview for layer title:'${e.title??"no title"}', id:'${e.id??"no id"}' of type '${e.type}'.`,{layer:e,error:n}),this._refreshCollections()}),this._layerLayerViewInfoMap.set(e,i),this.view.ready&&i.start(),this.notifyChange("updating"),this.notifyChange("updatingRemaining")}};h([p()],Va.prototype,"_workPromise",void 0),h([p({readOnly:!0})],Va.prototype,"_watchUpdatingTracking",void 0),h([p({readOnly:!0})],Va.prototype,"_layersToLayerViews",null),h([p({readOnly:!0})],Va.prototype,"_rootCollectionNames",null),h([p()],Va.prototype,"layerViewImporter",void 0),h([p()],Va.prototype,"supportsGround",void 0),h([p({readOnly:!0})],Va.prototype,"updating",null),h([p({readOnly:!0})],Va.prototype,"updatingRemaining",null),h([p({constructOnly:!0})],Va.prototype,"view",void 0),Va=h([P("esri.views.LayerViewManager")],Va);const vEe=Va;function _Ee(t){return"createLayerView"in t&&t.createLayerView!=null}let Zo=class extends ye{constructor(e){super(e),this.factor=1.5,this.offset=As(0,0),this.position=null,this.size=120,this.maskUrl=null,this.maskEnabled=!0,this.overlayUrl=null,this.overlayEnabled=!0,this.visible=!0}get version(){return this.commitProperty("factor"),this.commitProperty("offset"),this.commitProperty("position"),this.commitProperty("visible"),this.commitProperty("size"),this.commitProperty("maskUrl"),this.commitProperty("maskEnabled"),this.commitProperty("overlayUrl"),this.commitProperty("overlayEnabled"),(this._get("version")||0)+1}};h([p({type:Number})],Zo.prototype,"factor",void 0),h([p({nonNullable:!0})],Zo.prototype,"offset",void 0),h([p()],Zo.prototype,"position",void 0),h([p({type:Number,range:{min:0}})],Zo.prototype,"size",void 0),h([p()],Zo.prototype,"maskUrl",void 0),h([p()],Zo.prototype,"maskEnabled",void 0),h([p()],Zo.prototype,"overlayUrl",void 0),h([p()],Zo.prototype,"overlayEnabled",void 0),h([p({readOnly:!0})],Zo.prototype,"version",null),h([p({type:Boolean})],Zo.prototype,"visible",void 0),Zo=h([P("esri.views.Magnifier")],Zo);const mre=Zo;let bEe=class{constructor(){this._tasks=new Array,this._running=wA(!1)}get length(){return this._tasks.length}get running(){return this._running.value}destroy(){this.cancelAll()}runTask(e){for(;!e.done&&this._process(e);)e.madeProgress()}push(e,i,n){return this._running.value=!0,new Promise((r,s)=>this._tasks.push(new o7(r,s,e,i,n)))}unshift(e,i,n){return this._running.value=!0,new Promise((r,s)=>this._tasks.unshift(new o7(r,s,e,i,n)))}_process(e){var n;if(this._tasks.length===0)return!1;const i=this._tasks.shift();try{const r=zo(i.signal);if(r&&!i.abortCallback)i.reject(li());else{const s=r?(n=i.abortCallback)==null?void 0:n.call(i,li()):i.callback(e);fd(s)?s.then(i.resolve,i.reject):i.resolve(s)}}catch(r){i.reject(r)}return this._running.value=this._tasks.length>0,!0}cancelAll(){const e=li();for(const i of this._tasks)if(i.abortCallback){const n=i.abortCallback(e);i.resolve(n)}else i.reject(e);this._tasks.length=0,this._running.value=!1}},o7=class{constructor(e,i,n,r=void 0,s=void 0){this.resolve=e,this.reject=i,this.callback=n,this.signal=r,this.abortCallback=s}},Rw=class extends ye{constructor(){super(...arguments),this.SCHEDULER_LOG_SLOW_TASKS=!1,this.FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES=!1}};h([p()],Rw.prototype,"SCHEDULER_LOG_SLOW_TASKS",void 0),h([p()],Rw.prototype,"FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES",void 0),Rw=h([P("esri.views.support.DebugFlags")],Rw);const wEe=new Rw;var sa;(function(t){t[t.ANIMATING=0]="ANIMATING",t[t.INTERACTING=1]="INTERACTING",t[t.IDLE=2]="IDLE"})(sa||(sa={}));var pD,lt;(function(t){t[t.YIELD=1]="YIELD"})(pD||(pD={})),function(t){t.RESOURCE_CONTROLLER_IMMEDIATE="immediate",t.RESOURCE_CONTROLLER="schedule",t.SLIDE="slide",t.STREAM_DATA_LOADER="stream loader",t.ELEVATION_QUERY="elevation query",t.TERRAIN_SURFACE="terrain",t.SURFACE_GEOMETRY_UPDATES="surface geometry updates",t.LOD_RENDERER="LoD renderer",t.GRAPHICS_CORE="Graphics3D",t.I3S_CONTROLLER="I3S",t.POINT_CLOUD_LAYER="point cloud",t.FEATURE_TILE_FETCHER="feature fetcher",t.OVERLAY="overlay",t.STAGE="stage",t.GRAPHICS_DECONFLICTOR="graphics deconflictor",t.FILTER_VISIBILITY="Graphics3D filter visibility",t.SCALE_VISIBILITY="Graphics3D scale visibility",t.FRUSTUM_VISIBILITY="Graphics3D frustum visibility",t.POINT_OF_INTEREST_FREQUENT="POI frequent",t.POINT_OF_INTEREST_INFREQUENT="POI infrequent",t.LABELER="labeler",t.FEATURE_QUERY_ENGINE="feature query",t.FEATURE_TILE_TREE="feature tile tree",t.FEATURE_TILE_TREE_ACTIVE="fast feature tile tree",t.ELEVATION_ALIGNMENT="elevation alignment",t.TEXT_TEXTURE_ATLAS="text texture atlas",t.TEXTURE_UNLOAD="texture unload",t.LINE_OF_SIGHT_TOOL="line of sight tool",t.LINE_OF_SIGHT_TOOL_INTERACTIVE="interactive line of sight tool",t.ELEVATION_PROFILE="elevation profile",t.SNAPPING="snapping",t.SHADOW_ACCUMULATOR="shadow accumulator",t.CLOUDS_GENERATOR="clouds generator",t[t.NONE=0]="NONE",t[t.TEST_PRIO=1]="TEST_PRIO"}(lt||(lt={}));const uu=0,a7=new Map([[lt.RESOURCE_CONTROLLER_IMMEDIATE,uu],[lt.RESOURCE_CONTROLLER,4],[lt.SLIDE,uu],[lt.STREAM_DATA_LOADER,uu],[lt.ELEVATION_QUERY,uu],[lt.TERRAIN_SURFACE,1],[lt.SURFACE_GEOMETRY_UPDATES,1],[lt.LOD_RENDERER,2],[lt.GRAPHICS_CORE,2],[lt.I3S_CONTROLLER,2],[lt.POINT_CLOUD_LAYER,2],[lt.FEATURE_TILE_FETCHER,2],[lt.OVERLAY,4],[lt.STAGE,4],[lt.GRAPHICS_DECONFLICTOR,4],[lt.FILTER_VISIBILITY,4],[lt.SCALE_VISIBILITY,4],[lt.FRUSTUM_VISIBILITY,4],[lt.CLOUDS_GENERATOR,4],[lt.POINT_OF_INTEREST_FREQUENT,6],[lt.POINT_OF_INTEREST_INFREQUENT,30],[lt.LABELER,8],[lt.FEATURE_QUERY_ENGINE,8],[lt.FEATURE_TILE_TREE,16],[lt.FEATURE_TILE_TREE_ACTIVE,uu],[lt.ELEVATION_ALIGNMENT,12],[lt.TEXT_TEXTURE_ATLAS,12],[lt.TEXTURE_UNLOAD,12],[lt.LINE_OF_SIGHT_TOOL,16],[lt.LINE_OF_SIGHT_TOOL_INTERACTIVE,uu],[lt.SNAPPING,uu],[lt.SHADOW_ACCUMULATOR,30]]);function l7(t){return a7.has(t)?a7.get(t):typeof t=="number"?t:1}const c7=6.5,u7=1,xEe=30,h7=1e3/30,d7=100,p7=.9;var fD,am;(function(t){class e{get updating(){return this._updating.value}_updatingChanged(){this._updating.value=this._tasks.some(s=>s.needsUpdate)}constructor(){this._updating=wA(!0),this._microTaskQueued=!1,this._frameNumber=0,this.performanceInfo={total:new Ax("total"),tasks:new Map},this._frameTaskTimes=new Map,this._budget=new n,this._state=sa.INTERACTING,this._tasks=new Sf,this._runQueue=new Sf,this._load=0,this._idleStateCallbacks=new Sf,this._idleUpdatesStartFired=!1,this._forceTask=!1,this._debug=!1,this._debugHandle=Q(()=>wEe.SCHEDULER_LOG_SLOW_TASKS,o=>this._debug=o,He);for(const o of Object.keys(lt))this.performanceInfo.tasks.set(lt[o],new Ax(lt[o]));const s=this;this._test={FRAME_SAFETY_BUDGET:c7,INTERACTING_BUDGET:h7,IDLE_BUDGET:d7,get availableBudget(){return s._budget.budget},usedBudget:0,getBudget:()=>s._budget,setBudget:o=>s._budget=o,updateTask:o=>this._updateTask(o),getState:o=>this._getState(o),getRuntime:o=>this._getRuntime(o),frameTaskTimes:this._frameTaskTimes,resetRuntimes:()=>this._resetRuntimes(),getRunning:()=>this._getRunning()}}destroy(){this._tasks.toArray().forEach(s=>s.remove()),this._tasks.clear(),Ri(this._debugHandle),this._microTaskQueued=!1,this._updatingChanged()}taskRunningChanged(s){this._updatingChanged(),s&&this._budget.remaining>0&&!this._microTaskQueued&&(this._microTaskQueued=!0,queueMicrotask(()=>{this._microTaskQueued&&(this._microTaskQueued=!1,this._budget.remaining>0&&this._schedule()&&this.frame())}))}registerTask(s,o){const a=l7(s),l=new i(this,s,o,a);return this._tasks.push(l),this._updatingChanged(),this.performanceInfo.tasks.has(s)||this.performanceInfo.tasks.set(s,new Ax(s)),l}registerIdleStateCallbacks(s,o){const a={idleBegin:s,idleEnd:o};this._idleStateCallbacks.push(a),this.state===sa.IDLE&&this._idleUpdatesStartFired&&a.idleBegin();const l=this;return{remove:()=>this._removeIdleStateCallbacks(a),set idleBegin(c){l._idleUpdatesStartFired&&(a.idleEnd(),l._state===sa.IDLE&&c()),a.idleBegin=c},set idleEnd(c){a.idleEnd=c}}}get load(){return this._load}set state(s){this._state!==s&&(this._state=s,this.state!==sa.IDLE&&this._idleUpdatesStartFired&&(this._idleUpdatesStartFired=!1,this._idleStateCallbacks.forAll(o=>o.idleEnd())))}get state(){return this._state}updateBudget(s){this._test.usedBudget=0,++this._frameNumber;let o=c7,a=s.frameDuration,l=u7;switch(this.state){case sa.IDLE:o=0,a=Math.max(d7,s.frameDuration),l=xEe;break;case sa.INTERACTING:a=Math.max(h7,s.frameDuration);case sa.ANIMATING:}return a=a-s.elapsedFrameTime-o,this.state!==sa.IDLE&&a<u7&&!this._forceTask?(this._forceTask=!0,!1):(a=Math.max(a,l),this._budget.reset(a,this.state),this._updateLoad(),this._schedule())}frame(){switch(this._forceTask=!1,this._microTaskQueued=!1,this.state){case sa.IDLE:this._idleUpdatesStartFired||(this._idleUpdatesStartFired=!0,this._idleStateCallbacks.forAll(s=>s.idleBegin())),this._runIdle();break;case sa.INTERACTING:this._runInteracting();break;default:this._runAnimating()}this._test.usedBudget=this._budget.elapsed}stopFrame(){this._budget.reset(0,this._state),this._budget.madeProgress()}_removeIdleStateCallbacks(s){this._idleUpdatesStartFired&&s.idleEnd(),this._idleStateCallbacks.removeUnordered(s)}removeTask(s){this._tasks.removeUnordered(s),this._runQueue.removeUnordered(s),this._updatingChanged()}_updateTask(s){this._tasks.forAll(o=>{o.name===s&&o.setPriority(s)})}_getState(s){if(this._runQueue.some(a=>a.name===s))return am.SCHEDULED;let o=am.IDLE;return this._tasks.forAll(a=>{a.name===s&&a.needsUpdate&&(a.schedulePriority<=1?o=am.READY:o!==am.READY&&(o=am.WAITING))}),o}_getRuntime(s){let o=0;return this._tasks.forAll(a=>{a.name===s&&(o+=a.runtime)}),o}_resetRuntimes(){this._tasks.forAll(s=>s.runtime=0)}_getRunning(){const s=new Map;if(this._tasks.forAll(a=>{a.needsUpdate&&s.set(a.name,(s.get(a.name)||0)+1)}),s.size===0)return null;let o="";return s.forEach((a,l)=>{o+=a>1?` ${a}x ${l}`:` ${l}`}),o}_runIdle(){this._run()}_runInteracting(){this._run()}_runAnimating(){this._run()}_updateLoad(){const s=this._tasks.reduce((o,a)=>a.needsUpdate?++o:o,0);this._load=this._load*p7+s*(1-p7)}_schedule(){for(this._runQueue.filterInPlace(s=>!!s.needsUpdate||(s.schedulePriority=s.basePriority,!1)),this._tasks.forAll(s=>{s.basePriority===uu&&s.needsUpdate&&!this._runQueue.includes(s)&&s.blockFrame!==this._frameNumber&&this._runQueue.unshift(s)});this._runQueue.length===0;){let s=!1,o=0;if(this._tasks.forAll(a=>{a.needsUpdate&&a.schedulePriority!==0&&a.basePriority!==uu&&a.blockFrame!==this._frameNumber&&(s=!0,o=Math.max(o,a.basePriority),a.schedulePriority===1?(a.schedulePriority=0,this._runQueue.push(a)):--a.schedulePriority)}),!s)return this._updatingChanged(),!1}return this._updatingChanged(),!0}_run(){const s=this._budget.now();this._startFrameTaskTimes();do for(;this._runQueue.length>0;){const o=this._budget.now(),a=this._runQueue.pop();this._budget.resetProgress();try{a.task.runTask(this._budget)===pD.YIELD&&(a.blockFrame=this._frameNumber)}catch(c){ne.getLogger("esri.views.support.Scheduler").error(`Exception in task "${a.name}"`,c)}!this._budget.hasProgressed&&a.blockFrame!==this._frameNumber&&a.needsUpdate&&(a.name,lt.I3S_CONTROLLER,a.blockFrame=this._frameNumber),a.schedulePriority=a.basePriority;const l=this._budget.now()-o;if(a.runtime+=l,this._frameTaskTimes.set(a.priority,this._frameTaskTimes.get(a.priority)+l),this._debug&&l>2*this._budget.budget&&console.log("Task",a.name,"used",l,"of max",this._budget.budget,"ms"),this._budget.remaining<=0)return this._updatingChanged(),void this._recordFrameTaskTimes(this._budget.now()-s)}while(this._schedule());this._updatingChanged(),this._recordFrameTaskTimes(this._budget.now()-s)}_startFrameTaskTimes(){for(const s of Object.keys(lt))this._frameTaskTimes.set(lt[s],0)}_recordFrameTaskTimes(s){this._frameTaskTimes.forEach((o,a)=>this.performanceInfo.tasks.get(a).record(o)),this.performanceInfo.total.record(s)}get test(){return this._test}}t.Scheduler=e;class i{get task(){return this._task.value}get updating(){return this._queue.running}constructor(s,o,a,l){this._scheduler=s,this.name=o,this._basePriority=l,this.blockFrame=0,this.runtime=0,this._queue=new bEe,this._handles=new Rs,this.schedulePriority=this._basePriority,this._task=wA(a??this._queue),this._handles.add(jo(()=>this.task.running,c=>s.taskRunningChanged(c)))}remove(){this.processQueue(gre),this._scheduler.removeTask(this),this.schedule=mD.schedule,this.reschedule=mD.reschedule,this._handles.destroy()}get basePriority(){return this._basePriority}setPriority(s){this.name=s;const o=l7(s);this._basePriority!==uu&&this.schedulePriority===0||(this.schedulePriority=o),this._basePriority=o}get priority(){return this.name}set priority(s){this.setPriority(s)}get needsUpdate(){return this.updating||this.task.running}schedule(s,o,a){return this._queue.push(s,o,a)}reschedule(s,o,a){return this._queue.unshift(s,o,a)}processQueue(s){this._queue.runTask(s)}}class n{constructor(){this._begin=typeof performance<"u"?performance.now():0,this._budget=0,this._state=sa.IDLE,this._done=!1,this._progressed=!1,this._enabled=!0}run(s){return!this.done&&(s()===!0&&this.madeProgress(),!0)}get done(){return this._done}get budget(){return this._budget}madeProgress(){return this._progressed=!0,this._done=this.elapsed>=this._budget&&this._enabled,this._done}get state(){return this._state}get enabled(){return this._enabled}set enabled(s){this._enabled=s}reset(s,o){this._begin=this.now(),this._budget=s,this._state=o,this.resetProgress()}get remaining(){return Math.max(this._budget-this.elapsed,0)}now(){return performance.now()}get elapsed(){return performance.now()-this._begin}resetProgress(){this._progressed=!1,this._done=!1}get hasProgressed(){return this._progressed}}t.Budget=n})(fD||(fD={})),function(t){t.SCHEDULED="s",t.READY="r",t.WAITING="w",t.IDLE="i"}(am||(am={}));const gre=(()=>{const t=new fD.Budget;return t.enabled=!1,t})();let SEe=class{remove(){}processQueue(){}schedule(e,i,n){try{if(zo(i)){const r=li();return n?Promise.resolve(n(r)):Promise.reject(r)}return eR(e(gre))}catch(r){return Promise.reject(r)}}reschedule(e,i,n){return this.schedule(e,i,n)}};const mD=new SEe;let Dw=class extends ye{constructor(e,i){super({}),this._stage=e,this._textureRequests=new Map,this._frameTask=(i==null?void 0:i.registerTask(lt.TEXTURE_UNLOAD))??mD}normalizeCtorArgs(){return{}}destroy(){var e,i,n;super.destroy(),(e=this._frameTask)==null||e.remove(),(i=this._textureRequests)==null||i.forEach(r=>this._releaseTextureRequest(r)),(n=this._textureRequests)==null||n.clear()}get updating(){return this._frameTask.updating}fromData(e,i,n){var o,a;const r=this.makeUid(e);let s=this._textureRequests.get(r);if(!s){const l=new TEe(n);l.texture=i(),(o=this._stage)==null||o.add(l.texture),(a=this._stage)==null||a.loadImmediate(l.texture),this._textureRequests.set(r,l),s=l}return s.referenceCount++,{uid:r,texture:s.texture,release:()=>this._release(r)}}_release(e){const i=this._textureRequests.get(e);i?(i.referenceCount<1&&console.warn("TextureCollection: reference count is < 1 for "+e),i.referenceCount--,i.referenceCount<1&&this._frameTask.schedule(()=>this._releaseNow(e))):console.warn(`TextureCollection: texture doesn't exist: '${e}'`)}get test(){return{textureRequests:this._textureRequests}}_releaseNow(e){if(!this._textureRequests)return;const i=this._textureRequests.get(e);!i||i.referenceCount>0||(this._releaseTextureRequest(i),this._textureRequests.delete(e))}_releaseTextureRequest(e){var i;e.onRemove&&e.onRemove(),e.texture?(i=this._stage)==null||i.remove(e.texture):e.abortController&&(e.abortController.abort(),e.abortController=null)}makeUid(e,i=null){return i!=null?`${e}.${i}px`:e}};h([p()],Dw.prototype,"_frameTask",void 0),h([p()],Dw.prototype,"updating",null),Dw=h([P("esri.views.3d.support.TextureCollection")],Dw);let TEe=class{constructor(e){this.onRemove=e,this.referenceCount=0}};var f7;(function(t){t[t.Left=0]="Left",t[t.Middle=1]="Middle",t[t.Right=2]="Right"})(f7||(f7={}));const yre=["click","double-click","immediate-click","immediate-double-click","hold","drag","key-down","key-up","pointer-down","pointer-move","pointer-up","pointer-drag","mouse-wheel","pointer-enter","pointer-leave","gamepad","focus","blur"],vre={};function _re(t){return!!vre[t]}function IEe(t){for(const e of t)if(!_re(e))return!1;return!0}yre.forEach(t=>{vre[t]=!0});let CEe=class{constructor(e){this._handlers=new Map,this._counter=0,this._handlerCounts=new Map,this.view=e,this.inputManager=null}connect(e){e&&this.disconnect(),this.inputManager=e,this._handlers.forEach(({handler:i,priority:n},r)=>{var s;return(s=this.inputManager)==null?void 0:s.installHandlers(r,[i],n)})}disconnect(){this.inputManager&&this._handlers.forEach((e,i)=>{var n;return(n=this.inputManager)==null?void 0:n.uninstallHandlers(i)}),this.inputManager=null}destroy(){this.disconnect(),this._handlers.clear(),this.view=null}on(e,i,n,r){const s=Array.isArray(e)?e:e.split(",");if(!IEe(s))return s.some(_re)&&console.error("Error: registering input events and other events on the view at the same time is not supported."),null;let o,a;Array.isArray(i)?a=i:(o=i,a=[]),typeof n=="function"?o=n:r=n,r=r??gi.DEFAULT;const l=this._createUniqueGroupName(),c=new MEe(this.view,s,a,o);this._handlers.set(l,{handler:c,priority:r});for(const u of s){const d=this._handlerCounts.get(u)||0;this._handlerCounts.set(u,d+1)}return this.inputManager&&this.inputManager.installHandlers(l,[c],r),{remove:()=>this._removeHandler(l,s)}}hasHandler(e){return!!this._handlerCounts.get(e)}_removeHandler(e,i){if(this._handlers.has(e)){this._handlers.delete(e);for(const n of i){const r=this._handlerCounts.get(n);r===void 0?console.error("Trying to remove handler for event that has no handlers registered: ",n):r===1?this._handlerCounts.delete(n):this._handlerCounts.set(n,r-1)}}this.inputManager&&this.inputManager.uninstallHandlers(e)}_createUniqueGroupName(){return this._counter+=1,`viewEvents_${this._counter}`}},MEe=class extends Sr{constructor(e,i,n,r){super(!0),this._latestDragStart=void 0,this.view=e;for(const s of i)switch(s){case"click":this.registerIncoming("click",n,o=>r(this._wrapClick(o)));break;case"double-click":this.registerIncoming("double-click",n,o=>r(this._wrapDoubleClick(o)));break;case"immediate-click":this.registerIncoming("immediate-click",n,o=>r(this._wrapImmediateClick(o)));break;case"immediate-double-click":this.registerIncoming("immediate-double-click",n,o=>r(this._wrapImmediateDoubleClick(o)));break;case"hold":this.registerIncoming("hold",n,o=>r(this._wrapHold(o)));break;case"drag":this.registerIncoming("drag",n,o=>{const a=this._wrapDrag(o);a&&r(a)});break;case"key-down":this.registerIncoming("key-down",n,o=>r(this._wrapKeyDown(o)));break;case"key-up":this.registerIncoming("key-up",n,o=>r(this._wrapKeyUp(o)));break;case"pointer-down":this.registerIncoming("pointer-down",n,o=>r(this._wrapPointer(o,"pointer-down")));break;case"pointer-move":this.registerIncoming("pointer-move",n,o=>r(this._wrapPointer(o,"pointer-move")));break;case"pointer-up":this.registerIncoming("pointer-up",n,o=>r(this._wrapPointer(o,"pointer-up")));break;case"pointer-drag":this.registerIncoming("pointer-drag",n,o=>r(this._wrapPointerDrag(o)));break;case"mouse-wheel":this.registerIncoming("mouse-wheel",n,o=>r(this._wrapMouseWheel(o)));break;case"pointer-enter":this.registerIncoming("pointer-enter",n,o=>r(this._wrapPointer(o,"pointer-enter")));break;case"pointer-leave":this.registerIncoming("pointer-leave",n,o=>r(this._wrapPointer(o,"pointer-leave")));break;case"gamepad":this.registerIncoming("gamepad",n,o=>{r(this._wrapGamepad(o))});break;case"focus":this.registerIncoming("focus",n,o=>{r(this._wrapFocus(o))});break;case"blur":this.registerIncoming("blur",n,o=>{r(this._wrapBlur(o))})}}_wrapFocus(e){return{type:"focus",timestamp:e.timestamp,native:e.data.native,cancelable:e.cancelable,stopPropagation:()=>e.stopPropagation(),async:i=>e.async(i),preventDefault:()=>e.preventDefault()}}_wrapBlur(e){return{type:"blur",timestamp:e.timestamp,native:e.data.native,cancelable:e.cancelable,stopPropagation:()=>e.stopPropagation(),async:i=>e.async(i),preventDefault:()=>e.preventDefault()}}_wrapClick(e){const{pointerType:i,button:n,buttons:r,x:s,y:o,native:a,eventId:l}=e.data,{cancelable:c,timestamp:u}=e;return{type:"click",pointerType:i,button:n,buttons:r,x:s,y:o,native:a,timestamp:u,screenPoint:As(s,o),mapPoint:this._getMapPoint(s,o),eventId:l,cancelable:c,stopPropagation:()=>e.stopPropagation(),async:d=>e.async(d),preventDefault:()=>e.preventDefault()}}_wrapDoubleClick(e){const{pointerType:i,button:n,buttons:r,x:s,y:o,native:a,eventId:l}=e.data,{cancelable:c,timestamp:u}=e;return{type:"double-click",pointerType:i,button:n,buttons:r,x:s,y:o,native:a,timestamp:u,mapPoint:this._getMapPoint(s,o),eventId:l,cancelable:c,stopPropagation:()=>e.stopPropagation(),async:d=>e.async(d),preventDefault:()=>e.preventDefault()}}_wrapImmediateClick(e){const{pointerType:i,button:n,buttons:r,x:s,y:o,native:a,eventId:l}=e.data,c=a.pointerId,{cancelable:u,timestamp:d}=e;return{type:"immediate-click",pointerId:c,pointerType:i,button:n,buttons:r,x:s,y:o,native:a,timestamp:d,mapPoint:this._getMapPoint(s,o),eventId:l,cancelable:u,stopPropagation:()=>e.stopPropagation(),async:f=>e.async(f),preventDefault:()=>e.preventDefault()}}_wrapImmediateDoubleClick(e){const{pointerType:i,button:n,buttons:r,x:s,y:o,native:a,eventId:l}=e.data,c=a.pointerId,{cancelable:u,timestamp:d}=e;return{type:"immediate-double-click",pointerId:c,pointerType:i,button:n,buttons:r,x:s,y:o,native:a,timestamp:d,mapPoint:this._getMapPoint(s,o),eventId:l,cancelable:u,stopPropagation:()=>e.stopPropagation(),async:f=>e.async(f),preventDefault:()=>e.preventDefault()}}_wrapHold(e){const{pointerType:i,button:n,buttons:r,x:s,y:o,native:a}=e.data,{cancelable:l,timestamp:c}=e;return{type:"hold",pointerType:i,button:n,buttons:r,x:s,y:o,native:a,timestamp:c,mapPoint:this._getMapPoint(s,o),cancelable:l,stopPropagation:()=>e.stopPropagation(),async:u=>e.async(u),preventDefault:()=>e.preventDefault()}}_getMapPoint(e,i){return this.view.toMap(As(e,i),{exclude:[]})}_wrapDrag(e){const i=e.data,{x:n,y:r}=i.center,{action:s,pointerType:o,button:a}=i;if(s==="start"&&(this._latestDragStart=i),!this._latestDragStart)return;const l=i.pointer.native,c=i.buttons,{cancelable:u,timestamp:d}=e,f={x:this._latestDragStart.center.x,y:this._latestDragStart.center.y};return s==="end"&&(this._latestDragStart=void 0),{type:"drag",action:s,x:n,y:r,origin:f,pointerType:o,button:a,buttons:c,radius:i.radius,angle:bee(i.angle),native:l,timestamp:d,cancelable:u,stopPropagation:()=>e.stopPropagation(),async:m=>e.async(m),preventDefault:()=>e.preventDefault()}}_wrapKeyDown(e){const{key:i,repeat:n,native:r}=e.data,{cancelable:s,timestamp:o}=e;return{type:"key-down",key:i,repeat:n,native:r,timestamp:o,cancelable:s,stopPropagation:()=>e.stopPropagation(),async:a=>e.async(a),preventDefault:()=>e.preventDefault()}}_wrapKeyUp(e){const{key:i,native:n}=e.data,{cancelable:r,timestamp:s}=e;return{type:"key-up",key:i,native:n,timestamp:s,cancelable:r,stopPropagation:()=>e.stopPropagation(),async:o=>e.async(o),preventDefault:()=>e.preventDefault()}}_wrapPointer(e,i){const{x:n,y:r,button:s,buttons:o,native:a,eventId:l}=e.data,c=a.pointerId,u=a.pointerType,{cancelable:d,timestamp:f}=e;return{type:i,x:n,y:r,pointerId:c,pointerType:u,button:s,buttons:o,native:a,timestamp:f,eventId:l,cancelable:d,stopPropagation:()=>e.stopPropagation(),async:m=>e.async(m),preventDefault:()=>e.preventDefault()}}_wrapPointerDrag(e){const{x:i,y:n,buttons:r,native:s,eventId:o}=e.data.currentEvent,{button:a}=e.data.startEvent,l=e.data.startEvent.native.pointerId,c=e.data.startEvent.native.pointerType,u=e.data.action,d={x:e.data.startEvent.x,y:e.data.startEvent.y},{cancelable:f,timestamp:m}=e;return{type:"pointer-drag",x:i,y:n,pointerId:l,pointerType:c,button:a,buttons:r,action:u,origin:d,native:s,timestamp:m,eventId:o,cancelable:f,stopPropagation:()=>e.stopPropagation(),async:g=>e.async(g),preventDefault:()=>e.preventDefault()}}_wrapMouseWheel(e){const{cancelable:i,data:n,timestamp:r}=e,{x:s,y:o,deltaY:a,native:l}=n;return{type:"mouse-wheel",x:s,y:o,deltaY:a,native:l,timestamp:r,cancelable:i,stopPropagation:()=>e.stopPropagation(),async:c=>e.async(c),preventDefault:()=>e.preventDefault()}}_wrapGamepad(e){const{action:i,state:n,device:r}=e.data,{cancelable:s,timestamp:o}=e,{buttons:a,axes:l}=n;return{type:"gamepad",device:r,timestamp:o,action:i,buttons:a,axes:l,cancelable:s,stopPropagation:()=>e.stopPropagation(),async:c=>e.async(c),preventDefault:()=>e.preventDefault()}}};var W2,m7,g7;(function(t){t[t.USER=0]="USER",t[t.MANAGER=1]="MANAGER"})(W2||(W2={})),function(t){t[t.None=0]="None",t[t.Unfocused=1]="Unfocused",t[t.Focused=2]="Focused",t[t.Unselected=4]="Unselected",t[t.Selected=8]="Selected",t[t.All=15]="All"}(m7||(m7={})),function(t){t[t.None=0]="None",t[t.Custom1=16]="Custom1",t[t.Custom2=32]="Custom2",t[t.Custom3=64]="Custom3",t[t.Custom4=128]="Custom4",t[t.Custom5=256]="Custom5",t[t.Custom6=512]="Custom6",t[t.Custom7=1024]="Custom7",t[t.Custom8=2048]="Custom8",t[t.Custom9=4096]="Custom9",t[t.Custom10=8192]="Custom10",t[t.Custom11=16384]="Custom11",t[t.Custom12=32768]="Custom12",t[t.All=65520]="All"}(g7||(g7={}));function EEe(t){return[t.on("before-add",e=>{const i=e.item;if(i==null||t.includes(i))return ne.getLogger("esri.views.interactive.interactiveToolUtils").warn("Tool is either already in the list of tools or tool is `null`. Not adding tool."),void e.preventDefault();i.onAdd()}),t.on("after-remove",e=>{const i=e.item;i.active&&(i.view.activeTool=null),i.destroy()})]}function gD(t){return t.visible&&t.getEditableFlag!=null&&t.getEditableFlag(W2.USER)&&t.getEditableFlag(W2.MANAGER)}function Za(t){return As(t.x,t.y)}function bre(t,e){var n;const i=(n=t instanceof HTMLElement?t:t.surface)==null?void 0:n.getBoundingClientRect();return i?As(e.clientX-i.left,e.clientY-i.top):As(0,0)}function y7(t,e){return e instanceof Event?bre(t,e):Za(e)}function v7(t){if(t instanceof Event)return!0;if(typeof t=="object"&&"type"in t)switch(t.type){case"click":case"double-click":case"pointer-down":case"pointer-drag":case"pointer-enter":case"pointer-leave":case"pointer-up":case"pointer-move":case"immediate-click":case"immediate-double-click":case"hold":case"drag":case"mouse-wheel":return!0;default:return!1}return!1}let AEe=class{constructor(){this._pointerLocations=new Map,this._hoveredManipulators=new Map,this._grabbedManipulators=new Map,this._draggedManipulators=new Map,this._stopDrag=!1,this._revertToNullActiveTool=!1,this._cursor=null}get cursor(){return this._cursor}hasFocusedManipulators(){return this._grabbedManipulators.size>0||this._draggedManipulators.size>0}handleInputEvent(e,i){const n=()=>e.stopPropagation();switch(e.type){case"pointer-move":_7(e.pointerType)&&this._pointerLocations.set(e.pointerId,{x:e.x,y:e.y,pointerType:e.pointerType});break;case"drag":this._grabbedManipulators.size>0&&(this._stopDrag=!0),this._stopDrag&&(n(),e.action==="end"&&(this._stopDrag=!1));break;case"pointer-down":{if(!b7(e))break;const r=Za(e),s=this._intersect(r,e.pointerType,i.forEachTool);if(s==null)break;const o=s.manipulator,a=s.tool;o==null||a==null||!o.interactive||o.grabbable&&o.grabbableForEvent(e)||!o.grabbing||o.dragging||this._ungrabManipulatorBeforeDragging(o,e,i),o!=null&&a!=null&&o.interactive&&o.grabbable&&o.grabbableForEvent(e)&&!o.grabbing&&(this._grabbedManipulators.set(e.pointerId,{manipulator:o,tool:a,start:r,pointerType:e.pointerType}),this._grabbedManipulators.size===1&&i.activeTool==null&&(this._revertToNullActiveTool=!0,i.setActiveTool(s.tool)),o.grabbing=!0,o.events.emit("grab-changed",{action:"start",pointerType:e.pointerType,screenPoint:r}),n());break}case"pointer-up":this._draggedManipulators.has(e.pointerId)||this._handlePointerEnd(e,i);break;case"pointer-drag":{if(!b7(e))break;const r=this._grabbedManipulators.get(e.pointerId),s=ot(r,({manipulator:u})=>u),o=ot(r,({tool:u})=>u);if(s==null||o==null)break;const a=Za(e);a.x=rr(a.x,0,i.view.width),a.y=rr(a.y,0,i.view.height);const l=r.start,c=this._draggedManipulators.get(e.pointerId);switch(e.action){case"start":case"update":e.action!=="update"&&this._grabbedManipulators.size!==1||(s.dragging=!0,c?s.events.emit("drag",{action:"update",start:l,screenPoint:a}):s.events.emit("drag",{action:"start",start:l,screenPoint:a,pointerType:e.pointerType}),this._draggedManipulators.set(e.pointerId,{tool:o,manipulator:s,start:l}));break;case"end":s.dragging=!1,c&&s.events.emit("drag",{action:"end",start:l,screenPoint:a}),this._draggedManipulators.delete(e.pointerId),this._handlePointerEnd(e,i)}n();break}case"immediate-click":{const r=Za(e),s=this._intersect(r,e.pointerType,i.forEachTool);if($Ee(e)||i.forEachTool(c=>{if((s==null||s.tool!==c||c.automaticManipulatorSelection)&&c.manipulators){let u=!1;c.manipulators.forEach(({manipulator:d})=>{d.selected&&(d.selected=!1,u=!0)}),u&&c.onManipulatorSelectionChanged&&c.onManipulatorSelectionChanged()}}),s==null)break;const{manipulator:o,tool:a}=s;if(!o.interactive)break;o.selectable&&a.automaticManipulatorSelection&&(o.selected=!o.selected,a.onManipulatorSelectionChanged&&a.onManipulatorSelectionChanged());const l=e.native.shiftKey;o.events.emit("immediate-click",{screenPoint:r,button:e.button,pointerType:e.pointerType,shiftKey:l,stopPropagation:n});break}case"click":{const r=Za(e),s=this._intersect(r,e.pointerType,i.forEachTool),o=s!=null?s.manipulator:null;if(o==null||!o.interactive)break;const a=e.native.shiftKey;o.events.emit(e.type,{screenPoint:r,button:e.button,pointerType:e.pointerType,shiftKey:a}),n();break}case"double-click":{const r=Za(e),s=this._intersect(r,e.pointerType,i.forEachTool),o=s!=null?s.manipulator:null;if(o==null||!o.interactive)break;const a=e.native.shiftKey;o.events.emit("double-click",{screenPoint:r,button:e.button,pointerType:e.pointerType,shiftKey:a,stopPropagation:n});break}case"immediate-double-click":{const r=Za(e),s=this._intersect(r,e.pointerType,i.forEachTool),o=s!=null?s.manipulator:null;if(o==null||!o.interactive)break;const a=e.native.shiftKey;o.events.emit("immediate-double-click",{screenPoint:r,button:e.button,pointerType:e.pointerType,shiftKey:a,stopPropagation:n});break}}this._onFocusChange(i.forEachTool)}_ungrabManipulatorBeforeDragging(e,i,n){e.grabbing=!1,e.events.emit("grab-changed",{action:"end",pointerType:i.pointerType,screenPoint:Za(i)}),this._grabbedManipulators.forEach(({manipulator:r},s)=>{r===e&&this._grabbedManipulators.delete(s)}),this._afterManipulatorUngrab(n.setActiveTool)}_handlePointerEnd(e,i){const n=ot(this._grabbedManipulators.get(e.pointerId),({manipulator:r})=>r);n!=null&&n.grabbing&&(n.grabbing=!1,n.events.emit("grab-changed",{action:"end",pointerType:e.pointerType,screenPoint:Za(e)}),this._grabbedManipulators.delete(e.pointerId),this._afterManipulatorUngrab(i.setActiveTool))}_cursorFromMap(e){let i=null;return OS(e,({manipulator:n})=>!(n==null||!n.interactive)&&(n.grabbing&&n.grabCursor?(i=n.grabCursor,!0):!!n.cursor&&(i=n.cursor,!0))),i}_onFocusChange(e){this._updateCursor(),this._updateFocusedManipulatorTools(e)}_updateCursor(){this._grabbedManipulators.size>0?this._cursor=this._cursorFromMap(this._grabbedManipulators)||"grabbing":this._hoveredManipulators.size>0?this._cursor=this._cursorFromMap(this._hoveredManipulators)||"pointer":this._cursor=null}_updateFocusedManipulatorTools(e){const i=new Set,n=new Set;this._grabbedManipulators.forEach(({tool:r})=>{i.add(r)}),this._hoveredManipulators.forEach(({tool:r})=>{n.add(r)}),e(r=>{r.hasGrabbedManipulators=i.has(r),r.hasHoveredManipulators=n.has(r);const s=this._grabbedManipulators.values(),o=Hge(s,({tool:a})=>a===r);r.firstGrabbedManipulator=o!=null?o.manipulator:null})}clearPointers(e,{forEachTool:i,setActiveTool:n},r=!0,s){const o=(a,l)=>a===e&&(s==null||s===l);this._grabbedManipulators.forEach(({tool:a,manipulator:l,pointerType:c},u)=>{o(a,l)&&(this._grabbedManipulators.delete(u),l.grabbing=!1,l.events.emit("grab-changed",{action:"end",screenPoint:null,pointerType:c}))}),this._draggedManipulators.forEach(({tool:a,manipulator:l},c)=>{o(a,l)&&(this._draggedManipulators.delete(c),l.dragging=!1,l.events.emit("drag",{action:"cancel"}))}),r&&this._hoveredManipulators.forEach(({tool:a,manipulator:l},c)=>{o(a,l)&&(this._hoveredManipulators.delete(c),l.hovering=!1)}),this._afterManipulatorUngrab(n),this._onFocusChange(i)}_intersect(e,i,n){let r=null;return n(s=>{if(s.manipulators==null||!gD(s))return!1;const o=s.manipulators.intersect(e,i);return o!=null&&(r={tool:s,manipulator:o},!0)}),r}updateHoveredStateFromKnownPointers(e){this._pointerLocations.forEach((i,n)=>{this._updateHoveredStateForPointerAtScreenPosition(As(i.x,i.y),n,i.pointerType,e)})}handleHoverEvent(e,i){e.type!=="pointer-up"&&e.type!=="immediate-click"&&e.type!=="pointer-move"||!_7(e.pointerType)||this._updateHoveredStateForPointerAtScreenPosition(Za(e),e.pointerId,e.pointerType,i)}_updateHoveredStateForPointerAtScreenPosition(e,i,n,r){let s=this._intersect(e,n,r);const o=ot(this._hoveredManipulators.get(i),({manipulator:a})=>a);s==null||s.manipulator.interactive||(s=null),s!=null&&o===s.manipulator||(o!=null&&(o.hovering=!1),s!=null?(s.manipulator.hovering=!0,this._hoveredManipulators.set(i,s)):this._hoveredManipulators.delete(i),this._onFocusChange(r))}_afterManipulatorUngrab(e){this._grabbedManipulators.size===0&&this._revertToNullActiveTool&&(e(null),this._revertToNullActiveTool=!1)}};function _7(t){return t==="mouse"}function b7(t){return t.pointerType!=="mouse"||t.button===0}function $Ee(t){return!!t.native.shiftKey}const w7="attached",N3="tools",PEe=1e3;let Ul=class extends lb{constructor(e){super(e),this._clock=Pb,this._manipulatorState=new AEe,this.tools=new xe,this.cursor=null,this._interacting=!1,this._interactingTimeout=null,this._forEachTool=i=>{for(const n of this.tools.items)if(i(n))return}}initialize(){this.handles.add([this.view.on(yre,e=>{this._handleInputEvent(e)},gi.TOOL),...EEe(this.tools),this.tools.on("before-add",({item:e})=>{this._updateToolEditableFlag(e)}),this.tools.on("before-remove",({item:e})=>{this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs),this._updateCursor()}),this.tools.on("change",()=>{this._refreshToolWatchers()})])}destroy(){this.detach(),this.handles.removeAll()}get _manipulatorStateEventArgs(){return{forEachTool:this._forEachTool,activeTool:this.activeTool,setActiveTool:e=>{this.activeTool=e},view:this.view}}set activeTool(e){if(e!=null&&!this.view.ready)return void ne.getLogger(this).error("Cannot set active tool while view is not ready.");if(e===this.activeTool)return;const i=this.activeTool;this._set("activeTool",e),i!=null&&i.deactivate(),e!=null&&e.activate(),this._removeIncompleteTools(e);for(const n of this.tools){this._updateToolEditableFlag(n);const r=gD(n);this.activeTool!=null&&r||this._manipulatorState.clearPointers(n,this._manipulatorStateEventArgs,!r)}this._updateCursor()}get updating(){var e;return this.updatingHandles.updating||this.tools.some(i=>i.updating)||(((e=this.textures)==null?void 0:e.updating)??!1)}get interacting(){return this._interacting}_clearInteractingTimeout(){this._interactingTimeout=Ri(this._interactingTimeout)}_startInteractingTimeout(){this._clearInteractingTimeout(),this._interactingTimeout=this._clock.setTimeout(()=>this._interacting=!1,PEe)}attach(){var e;this.view.type==="3d"?(this._set("textures",new Dw(this.view._stage,this.view.resourceController.scheduler)),this.handles.add([Q(()=>{const{state:i}=this.view;return"camera"in i&&i.camera},()=>this._forEachManipulator(i=>i.onViewChange())),(e=this.view.elevationProvider)==null?void 0:e.on("elevation-change",i=>this._forEachManipulator(n=>n.onElevationChange(i))),br(()=>this._set("textures",Je(this.textures)))],w7)):this.handles.add(Q(()=>this.view.extent,()=>this._forEachManipulator(i=>i.onViewChange())))}detach(){this.activeTool=null,this.tools.removeAll(),this.handles.remove(w7),this._clearInteractingTimeout(),this._interacting=!1}_forEachManipulator(e){this._forEachTool(i=>{i.manipulators&&i.manipulators.forEach(({manipulator:n})=>e(n,i))})}_handleInputEvent(e){let i=!1;const n={...e,stopPropagation:()=>{i=!0,e.stopPropagation()}};this.activeTool!=null?this.activeTool.handleInputEvent&&this.activeTool.handleInputEvent(n):this._forEachTool(r=>{!i&&r.visible&&r.handleInputEvent(n)}),!i&&e.type==="key-down"&&e.key==="Escape"&&this.activeTool&&(e.stopPropagation(),this.activeTool=null),this._manipulatorState.handleInputEvent(n,this._manipulatorStateEventArgs),i||this.activeTool==null||this.activeTool.handleInputEventAfter(n),this._manipulatorState.handleHoverEvent(n,this._forEachTool),this._updateCursor(),e.type==="pointer-move"&&(this._manipulatorState.hasFocusedManipulators()||this.activeTool)&&(this._interacting=!0,this._startInteractingTimeout())}_refreshToolWatchers(){this.handles.remove(N3),this._forEachTool(e=>{if(e instanceof ye){const i=Q(()=>[e.cursor,e.visible,e.editable],()=>{gD(e)||this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs),this._updateCursor()});this.handles.add(i,N3)}e.manipulators&&this.handles.add([e.manipulators.on("after-remove",i=>{this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs,!0,i.item.manipulator)}),e.manipulators.on("change",()=>{this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor()})],N3)}),this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor()}_updateToolEditableFlag(e){var i;(i=e.setEditableFlag)==null||i.call(e,W2.MANAGER,this.activeTool==null||e===this.activeTool)}_updateCursor(){let e=this._manipulatorState.cursor;e==null&&this._forEachTool(i=>!(i.cursor==null||!i.visible)&&(e=i.cursor,!0)),this._get("cursor")!==e&&this._set("cursor",e)}_removeIncompleteTools(e){this.tools.filter(i=>(e==null||i!==e)&&!i.created&&i.removeIncompleteOnCancel).forEach(i=>{this.tools.remove(i)})}get test(){return{setClock:e=>this._clock=e}}};h([p({constructOnly:!0,nonNullable:!0})],Ul.prototype,"view",void 0),h([p({readOnly:!0,nonNullable:!0})],Ul.prototype,"textures",void 0),h([p({value:null})],Ul.prototype,"activeTool",null),h([p({readOnly:!0,type:xe})],Ul.prototype,"tools",void 0),h([p({readOnly:!0})],Ul.prototype,"cursor",void 0),h([p({readOnly:!0})],Ul.prototype,"updating",null),h([p()],Ul.prototype,"_interacting",void 0),h([p({readOnly:!0})],Ul.prototype,"interacting",null),Ul=h([P("esri.views.ToolViewManager")],Ul);let gv=class extends ye{constructor(e){super(),this.nativeIndex=null,this._detectedDeviceType="unknown",e.mapping==="standard"?this._detectedDeviceType="standard":kEe.test(e.id)?this._detectedDeviceType="spacemouse":this._detectedDeviceType="unknown",this.nativeIndex=e.index}get native(){const e=navigator.getGamepads?navigator.getGamepads():[];return this.nativeIndex!=null&&this.nativeIndex<e.length?e[this.nativeIndex]:null}get deviceType(){return this._detectedDeviceType}get axisThreshold(){return OEe[this.deviceType]}};h([p({nonNullable:!0,readOnly:!0})],gv.prototype,"nativeIndex",void 0),h([p({type:String,readOnly:!0})],gv.prototype,"deviceType",null),h([p({type:Number,readOnly:!0})],gv.prototype,"axisThreshold",null),gv=h([P("esri.views.input.gamepad.GamepadInputDevice")],gv);const kEe=new RegExp("^(3dconnexion|space(mouse|navigator|pilot|explorer))","i"),OEe={standard:.15,spacemouse:.025,unknown:0},CV=gv;let Nw=class extends ye{constructor(...e){super(...e),this.devices=new xe,this.enabledFocusMode="document"}};h([p({type:xe.ofType(CV),readOnly:!0})],Nw.prototype,"devices",void 0),h([p({type:["document","view","none"]})],Nw.prototype,"enabledFocusMode",void 0),Nw=h([P("esri.views.input.gamepad.GamepadSettings")],Nw);const LEe=Nw;let CM=class extends ye{constructor(){super(...arguments),this.gamepad=new LEe}};h([p({readOnly:!0})],CM.prototype,"gamepad",void 0),CM=h([P("esri.views.input.Input")],CM);const REe=CM;let cp=class extends ye{constructor(e){super(e),this.enabled=!0,this.device=null,this.mode="pan",this.tiltDirection="forward-down",this.velocityFactor=1}};h([p({type:Boolean,nonNullable:!0})],cp.prototype,"enabled",void 0),h([p({type:CV})],cp.prototype,"device",void 0),h([p({type:["pan","zoom"],nonNullable:!0})],cp.prototype,"mode",void 0),h([p({type:["forward-down","forward-up"],nonNullable:!0})],cp.prototype,"tiltDirection",void 0),h([p({type:Number,nonNullable:!0})],cp.prototype,"velocityFactor",void 0),cp=h([P("esri.views.navigation.gamepad.GamepadSettings")],cp);const wre=cp;let Jm=class extends ye{constructor(e){super(e),this.browserTouchPanEnabled=!0,this.gamepad=new wre,this.momentumEnabled=!0,this.mouseWheelZoomEnabled=!0}};h([p({type:Boolean})],Jm.prototype,"browserTouchPanEnabled",void 0),h([p({type:wre,nonNullable:!0})],Jm.prototype,"gamepad",void 0),h([p({type:Boolean})],Jm.prototype,"momentumEnabled",void 0),h([p({type:Boolean})],Jm.prototype,"mouseWheelZoomEnabled",void 0),Jm=h([P("esri.views.navigation.Navigation")],Jm);const xre=Jm,Sre={mapserver:"MapServer",imageserver:"ImageServer",featureserver:"FeatureServer",sceneserver:"SceneServer",streamserver:"StreamServer",vectortileserver:"VectorTileServer"},Tre=Object.values(Sre),Ire=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/rest\\/services\\/(.+?)\\/(${Tre.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),DEe=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/([^\\/\\n]+)\\/(${Tre.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),NEe=/(.*?)\/(?:layers\/)?(\d+)\/?$/i;function _ut(t){return!!Ire.test(t)}function $P(t){if(t==null)return null;const e=ir(t),i=e.path.match(Ire)||e.path.match(DEe);if(!i)return null;const[,n,r,s,o]=i,a=r.indexOf("/");return{title:Cre(a!==-1?r.slice(a+1):r),serverType:Sre[s.toLowerCase()],sublayer:o!=null&&o!==""?parseInt(o,10):null,url:{path:n}}}function FEe(t){const e=ir(t).path.match(NEe);return e?{serviceUrl:e[1],sublayerId:Number(e[2])}:null}function Cre(t){return(t=t.replaceAll(/\s*[/_]+\s*/g," "))[0].toUpperCase()+t.slice(1)}function but(t,e){const i=[];if(t){const n=$P(t);n!=null&&n.title&&i.push(n.title)}if(e){const n=Cre(e);i.push(n)}if(i.length===2){if(i[0].toLowerCase().includes(i[1].toLowerCase()))return i[0];if(i[1].toLowerCase().includes(i[0].toLowerCase()))return i[1]}return i.join(" - ")}function wut(t){if(!t)return!1;const e=".arcgis.com/",i="//services",n="//tiles",r="//features",s=(t=t.toLowerCase()).includes(e),o=t.includes(i)||t.includes(n)||t.includes(r);return s&&o}function MV(t,e){return t&&fQ(mQ(t,e))}function xut(t){let{url:e}=t;if(!e)return{url:e};e=mQ(e,t.logger);const i=ir(e),n=$P(i.path);let r;if(n!=null)n.sublayer!=null&&t.layer.layerId==null&&(r=n.sublayer),e=n.url.path;else if(t.nonStandardUrlAllowed){const s=FEe(i.path);s!=null&&(e=s.serviceUrl,r=s.sublayerId)}return{url:fQ(e),layerId:r}}function Sut(t,e,i,n,r){Fy(e,n,"url",r),n.url&&t.layerId!=null&&(n.url=tP(n.url,i,t.layerId.toString()))}function Tut(t){if(!t)return!1;const e=t.toLowerCase(),i=e.includes("/services/"),n=e.includes("/mapserver/wmsserver"),r=e.includes("/imageserver/wmsserver"),s=e.includes("/wmsserver");return i&&(n||r||s)}function Iut(t,e,i){const n=Mre(t),r=e,s=zEe(n,r,i);if(n){const o=AP.deriveUnitFromSR(n,t.spatialReference).heightUnit;if(!i&&o!==n.heightUnit){const a=new V("layerview:unmatched-height-unit",`The vertical units of the layer must match the horizontal units (${o})`,{horizontalUnit:o});return new V("layerview:unsupported-height-model-info","The vertical coordinate system of the layer is not supported",{heightModelInfo:n,error:a})}}if(!VEe(t)||s===Co.Unsupported)return new V("layerview:unsupported-height-model-info","The vertical coordinate system of the layer is not supported",{heightModelInfo:n});switch(s){case Co.Units:{const o=(n==null?void 0:n.heightUnit)||"unknown",a=(r==null?void 0:r.heightUnit)||"unknown",l=new V("layerview:incompatible-height-unit",`The vertical units of the layer (${o}) must match the vertical units of the scene (${a})`,{layerUnit:o,sceneUnit:a});return new V("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:n,sceneHeightModelInfo:r,error:l})}case Co.HeightModel:{const o=(n==null?void 0:n.heightModel)||"unknown",a=(r==null?void 0:r.heightModel)||"unknown",l=new V("layerview:incompatible-height-model",`The height model of the layer (${o}) must match the height model of the scene (${a})`,{layerHeightModel:o,sceneHeightModel:a});return new V("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:n,sceneHeightModelInfo:r,error:l})}case Co.CRS:{const o=(n==null?void 0:n.vertCRS)||"unknown",a=(r==null?void 0:r.vertCRS)||"unknown",l=new V("layerview:incompatible-vertical-datum",`The vertical datum of the layer (${o}) must match the vertical datum of the scene (${a})`,{layerDatum:o,sceneDatum:a});return new V("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:n,sceneHeightModelInfo:r,error:l})}}return null}function zEe(t,e,i){if(!x7(t)||!x7(e))return Co.Unsupported;if(t==null||e==null)return Co.Ok;if(!i&&t.heightUnit!==e.heightUnit)return Co.Units;if(t.heightModel!==e.heightModel)return Co.HeightModel;switch(t.heightModel){case"gravity-related-height":return Co.Ok;case"ellipsoidal":return t.vertCRS===e.vertCRS?Co.Ok:Co.CRS;default:return Co.Unsupported}}var Co;function x7(t){return t==null||t.heightModel!=null&&t.heightUnit!=null}function VEe(t){return"heightModelInfo"in t&&t.heightModelInfo!=null||t.spatialReference!=null||!$re(t)}function Mre(t){var n;const e=t.url?$P(t.url):void 0;return!(((n=t.spatialReference)==null?void 0:n.vcsWkid)==null&&e!=null&&e.serverType==="ImageServer")&&Ere(t)&&t.heightModelInfo?t.heightModelInfo:$re(t)?AP.deriveUnitFromSR(BEe,t.spatialReference):null}function Ere(t){return"heightModelInfo"in t}function Are(t){if(t.type==="unknown"||!("capabilities"in t))return!1;switch(t.type){case"csv":case"feature":case"geojson":case"subtype-group":case"ogc-feature":case"oriented-imagery":case"wfs":case"knowledge-graph-sublayer":return!0;default:return!1}}function $re(t){return Are(t)?!!(t.capabilities&&t.capabilities.data&&t.capabilities.data.supportsZ):Pre(t)}function jEe(t){return t.layers!=null||Pre(t)||Are(t)||Ere(t)}function Pre(t){switch(t.type){case"building-scene":case"elevation":case"integrated-mesh":case"point-cloud":case"scene":case"voxel":return!0;case"base-dynamic":case"base-elevation":case"base-tile":case"bing-maps":case"csv":case"dimension":case"geojson":case"feature":case"subtype-group":case"geo-rss":case"graphics":case"group":case"imagery":case"imagery-tile":case"kml":case"knowledge-graph":case"link-chart":case"knowledge-graph-sublayer":case"line-of-sight":case"map-image":case"map-notes":case"media":case"ogc-feature":case"open-street-map":case"oriented-imagery":case"route":case"stream":case"tile":case"unknown":case"unsupported":case"vector-tile":case"video":case"wcs":case"web-tile":case"wfs":case"wms":case"wmts":case null:return!1}return!1}(function(t){t[t.Ok=0]="Ok",t[t.Units=1]="Units",t[t.HeightModel=2]="HeightModel",t[t.CRS=3]="CRS",t[t.Unsupported=4]="Unsupported"})(Co||(Co={}));const BEe=new AP({heightModel:"gravity-related-height"});var cb;(function(t){t[t.Global=1]="Global",t[t.Local=2]="Local"})(cb||(cb={}));let yD,F3=null;async function UEe(t){F3||(F3=Y(()=>import("./geometryServiceUtils-7fe9dc26.js"),[],import.meta.url).then(e=>yD=e)),await F3,Vt(t)}async function kre(t,e,i,n){if(!t)return null;const r=t.spatialReference;return wl()||yl(r,e)?an(t,e):yD?yD.projectGeometry(t,e,i,n):(await Promise.race([UEe(n),Ic(n)]),kre(t,e,i,n))}let ui=class extends ye{constructor(e){super(e),this.required={tileInfo:!1,heightModelInfo:!1,extent:!1},this.defaultSpatialReference=null,this.userSpatialReference=null,this.sourcePreloadCount=10,this.priorityCollection=null,this.requiresExtentInSpatialReference=!0,this.suspended=!1,this._projectExtentTask={task:null,input:null,output:null,spatialReference:null}}destroy(){this._projectExtentTask.task&&(this._projectExtentTask.task=is(this._projectExtentTask.task)),this._set("map",null)}get ready(){return!this._spatialReferenceTask.updating&&!this._tileInfoTask.updating&&!this._extentTask.updating}get heightModelInfoReady(){return!this._heightModelInfoTask.updating}get spatialReference(){return this.userSpatialReference!=null?this.userSpatialReference:this._spatialReferenceTask.spatialReference}get extent(){return this._extentTask.extent}get heightModelInfo(){return this._heightModelInfoTask.heightModelInfo}get vcsWkid(){return this._heightModelInfoTask.vcsWkid}get latestVcsWkid(){return this._heightModelInfoTask.latestVcsWkid}get viewingMode(){return this.userSpatialReference==null||this.userSpatialReference.equals(this._spatialReferenceTask.spatialReference)?this._spatialReferenceTask.viewingMode:null}get tileInfo(){return this._tileInfoTask.tileInfo}get mapCollections(){var n,r,s,o;const e=(n=this.map)==null?void 0:n.call(this),i=[];return this.priorityCollection!=null&&i.push(this.priorityCollection),i.push({parent:e==null?void 0:e.basemap,layers:(r=e==null?void 0:e.basemap)==null?void 0:r.baseLayers},{layers:e==null?void 0:e.layers},{parent:e==null?void 0:e.ground,layers:(s=e==null?void 0:e.ground)==null?void 0:s.layers},{parent:e==null?void 0:e.basemap,layers:(o=e==null?void 0:e.basemap)==null?void 0:o.referenceLayers}),i}get _allLayers(){return this._collectLayers(this.mapCollections)}get _spatialReferenceTask(){if(this.suspended)return this._get("_spatialReferenceTask")??{updating:!1};const{layers:e,updating:i}=this._allLayers;let n=null;for(const s of e){const o=this._getSupportedSpatialReferences(s);if(o.length>0){const a=this._narrowDownSpatialReferenceCandidates(n,o);a!=null&&(n=a)}if(n!=null&&n.length===1)break}if(i&&(n==null||n.length!==1))return{updating:!0};const r=this._pickSpatialReferenceCandidate(n);return{spatialReference:r!=null?r.spatialReference:null,viewingMode:r!=null?r.viewingMode:null,updating:!1}}get _tileInfoTask(){var n,r,s,o,a,l,c;if(!this.required.tileInfo)return this._get("_tileInfoTask")??{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const{layers:e,updating:i}=this._collectLayers([{parent:(r=(n=this.map)==null?void 0:n.call(this))==null?void 0:r.basemap,layers:(a=(o=(s=this.map)==null?void 0:s.call(this))==null?void 0:o.basemap)==null?void 0:a.baseLayers},{layers:(c=(l=this.map)==null?void 0:l.call(this))==null?void 0:c.layers}]);if(e&&e.length>0&&"tileInfo"in e[0]){const u=e[0].tileInfo;return{tileInfo:u&&u.spatialReference.equals(this.spatialReference)?u:null,updating:!1}}return{updating:i}}get _heightModelInfoTask(){var n,r,s;if(!this.required.heightModelInfo||this.suspended&&((n=this._get("_heightModelInfoTask"))!=null&&n.heightModelInfo))return this._get("_heightModelInfoTask")??{updating:!1};const{layers:e,updating:i}=this._allLayers;for(const o of e)if(jEe(o)){const a=Mre(o);if(a)return{heightModelInfo:a,vcsWkid:(r=o.spatialReference)==null?void 0:r.vcsWkid,latestVcsWkid:(s=o.spatialReference)==null?void 0:s.latestVcsWkid,updating:!1}}return{updating:i}}get _extentCandidatesTask(){if(this.suspended||!this.required.extent)return this._get("_extentCandidatesTask")??{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const e=this._allLayers,i=e.updating,n=[];for(const r of e.layers){const s="fullExtents"in r&&r.fullExtents||(r.fullExtent!=null?[r.fullExtent]:[]),o=this.requiresExtentInSpatialReference?null:s[0],a=s.find(l=>l.spatialReference.equals(this.spatialReference))??o;if(a)return{candidates:[{extent:a,layer:r}],updating:!1};if(this._getSupportedSpatialReferences(r).length>0)for(const l of s)n.push({extent:l,layer:r})}return{candidates:n,updating:i}}get _extentTask(){const{candidates:e,updating:i}=this._extentCandidatesTask;if(i)return{updating:i};if(e==null||e.length===0)return{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const n=this._pickExtentCandidate(e),r=this.spatialReference;return n.extent.equals(this._projectExtentTask.input)&&r.equals(this._projectExtentTask.spatialReference)?{extent:this._projectExtentTask.output,updating:this._projectExtentTask.task!=null&&!this._projectExtentTask.task.finished}:(this._projectExtentTask.task!=null&&(this._projectExtentTask.task=is(this._projectExtentTask.task)),this._projectExtentTask={input:n.extent.clone(),output:null,spatialReference:r.clone(),task:i0(async s=>{try{const o=await kre(n.extent,r,"portalItem"in n.layer?n.layer.portalItem:void 0,s);this._projectExtentTask={...this._projectExtentTask,task:null,output:o}}catch{if(zo(s))return;this._projectExtentTask={...this._projectExtentTask,task:null}}})},{updating:!0})}_narrowDownSpatialReferenceCandidates(e,i){if(e==null)return i;const n=[],r=(s,o)=>s!=null?o!=null?s===o&&s:s:o;for(const s of e)for(const o of i){if(!s.spatialReference.equals(o.spatialReference))continue;const a=r(s.viewingMode,o.viewingMode);if(a!==!1){n.push({spatialReference:s.spatialReference,viewingMode:a});break}}return n.length>0?n:null}_pickSpatialReferenceCandidate(e){const i=this.defaultSpatialReference;return e==null||e.length<1?i!=null?{spatialReference:i,viewingMode:null}:null:(i!=null&&e.length>1&&e.some(({spatialReference:n})=>n.equals(i))&&(e=e.filter(({spatialReference:n})=>n.equals(i))),e.length>1&&e.some(({viewingMode:n})=>n!==cb.Local)&&(e=e.filter(({viewingMode:n})=>n!==cb.Local)),e[0])}_getSupportedSpatialReferences(e){const i="supportedSpatialReferences"in e&&e.supportedSpatialReferences||(e.spatialReference?[e.spatialReference]:[]);if(i.length===0)return[];const n=[];for(const r of i){const s=this.getSpatialReferenceSupport({spatialReference:r,layer:e});if(s!=null){const o=s.constraints!=null?s.constraints:[{spatialReference:r,viewingMode:null}];for(const{spatialReference:a,viewingMode:l}of o)this.requiresExtentInSpatialReference&&this.userSpatialReference!=null&&!a.equals(this.userSpatialReference)||n.push({spatialReference:a,viewingMode:l})}}return n}_pickExtentCandidate(e){const i=this.spatialReference;return e.find(({extent:n})=>i.equals(n.spatialReference))||e[0]}_collectLayers(e){var n;if(this._loadMaybe((n=this.map)==null?void 0:n.call(this))!=="loaded")return{layers:[],updating:!0};const i=new GEe;for(const r of e)if(this._collectCollection(r,i),i.preloading===this.sourcePreloadCount)break;return{layers:i.layers,updating:i.updating}}_collectCollection(e,i){if(e.layers){switch(this._loadMaybe(e.parent)){case"loading":return i.updating=!0,void++i.preloading;case"failed":return}for(const n of e.layers){switch(this._loadMaybe(n)){case"failed":continue;case"loading":i.updating=!0,++i.preloading;break;case"loaded":i.updating||i.layers.push(n),"layers"in n&&this._collectCollection({layers:n.layers},i)}if(i.preloading===this.sourcePreloadCount)break}}}_loadMaybe(e){return e&&"loadStatus"in e&&e.loadStatus!=null?e.loadStatus==="not-loaded"?(e.load().catch(i=>{Ds(i)||console.log(i)}),"loading"):e.loadStatus:"loaded"}};h([p()],ui.prototype,"required",void 0),h([p({constructOnly:!0})],ui.prototype,"map",void 0),h([p({constructOnly:!0})],ui.prototype,"getSpatialReferenceSupport",void 0),h([p()],ui.prototype,"defaultSpatialReference",void 0),h([p()],ui.prototype,"userSpatialReference",void 0),h([p()],ui.prototype,"sourcePreloadCount",void 0),h([p()],ui.prototype,"priorityCollection",void 0),h([p()],ui.prototype,"requiresExtentInSpatialReference",void 0),h([p()],ui.prototype,"suspended",void 0),h([p({readOnly:!0})],ui.prototype,"ready",null),h([p({readOnly:!0})],ui.prototype,"heightModelInfoReady",null),h([p({readOnly:!0})],ui.prototype,"spatialReference",null),h([p({readOnly:!0})],ui.prototype,"extent",null),h([p({readOnly:!0})],ui.prototype,"heightModelInfo",null),h([p({readOnly:!0})],ui.prototype,"vcsWkid",null),h([p({readOnly:!0})],ui.prototype,"latestVcsWkid",null),h([p({readOnly:!0})],ui.prototype,"viewingMode",null),h([p({readOnly:!0})],ui.prototype,"tileInfo",null),h([p({readOnly:!0})],ui.prototype,"mapCollections",null),h([p({readOnly:!0})],ui.prototype,"_allLayers",null),h([p({readOnly:!0})],ui.prototype,"_spatialReferenceTask",null),h([p({readOnly:!0})],ui.prototype,"_tileInfoTask",null),h([p({readOnly:!0})],ui.prototype,"_heightModelInfoTask",null),h([p({readOnly:!0})],ui.prototype,"_extentCandidatesTask",null),h([p()],ui.prototype,"_extentTask",null),h([p()],ui.prototype,"_projectExtentTask",void 0),ui=h([P("esri.views.support.DefaultsFromMap")],ui);let GEe=class{constructor(){this.layers=new Array,this.preloading=-1,this.updating=!1}};var Fw;let Ne=Fw=class extends kc(Uo.EventedMixin(K$(ye))){constructor(t){super(t),this._userSpatialReference=null,this._cursor=null,this.allLayerViews=new L2({getCollections:()=>{var e,i,n;return[(e=this.basemapView)==null?void 0:e.baseLayerViews,(i=this.groundView)==null?void 0:i.layerViews,this.layerViews,(n=this.basemapView)==null?void 0:n.referenceLayerViews]},getChildrenFunction:qEe}),this.groundView=null,this.basemapView=null,this.fatalError=null,this.graphics=new _y,this.analyses=new SA,this.typeSpecificPreconditionsReady=!0,this.layerViews=new xe,this.magnifier=new mre,this.padding={left:0,top:0,right:0,bottom:0},this.ready=!1,this.spatialReferenceWarningDelay=1e3,this.supportsGround=!0,this.timeExtent=null,this.timeReference=new IV,this.type=null,this.scale=null,this.updating=!1,this.initialExtentRequired=!0,this.input=new REe,this.navigation=new xre,this.layerViewManager=null,this.analysisViewManager=null,this.isHeightModelInfoRequired=!1,this.width=null,this.height=null,this.resizing=!1,this.suspended=!1,this.viewEvents=new CEe(this),this.persistableViewModels=new xe,this._isValid=!1,this._readyCycleForced=!1,this._currentSpatialReference=null,this.handles.add(Q(()=>this.preconditionsReady,e=>{var i,n;e?(this._currentSpatialReference=this.spatialReference,Fw.views.add(this)):(this._currentSpatialReference=null,Fw.views.remove(this)),this.notifyChange("spatialReference"),!e&&this.ready?((i=this.toolViewManager)==null||i.detach(),this.analysisViewManager!=null&&this.analysisViewManager.detach(),(n=this.layerViewManager)==null||n.clear(),this._teardown()):e&&!this.ready&&(this._startup(),this.analysisViewManager!=null&&this.analysisViewManager.attach(),this.toolViewManager.attach())},ml))}initialize(){this.addResolvingPromise(this.validate().then(()=>(this._isValid=!0,Lu(()=>this.ready)))),this.basemapView=new lp({view:this}),this.layerViewManager=new vEe({view:this,layerViewImporter:{importLayerView:t=>this.importLayerView(t),hasLayerViewModule:t=>this.hasLayerViewModule(t)},supportsGround:this.supportsGround}),this.toolViewManager=new Ul({view:this}),this._setupSpatialReferenceLogger(),this.handles.add([Q(()=>this.initialExtentRequired,t=>this.defaultsFromMap.required={...this.defaultsFromMap.required,extent:t},{sync:!0,initial:!0}),Q(()=>this.ready,t=>{this.defaultsFromMap&&(this.defaultsFromMap.suspended=t,this.defaultsFromMap.userSpatialReference=t?this.spatialReference:this._userSpatialReference)},{sync:!0}),Q(()=>this._userSpatialReference,t=>{this.defaultsFromMap&&(this.defaultsFromMap.userSpatialReference=t)},{sync:!0,initial:!0})])}_setupSpatialReferenceLogger(){let t=null;this.handles.add([Q(()=>{var e;return(e=this.defaultsFromMap)==null?void 0:e.ready},e=>{var n;const i=((n=this.map)==null?void 0:n.allLayers.length)>0;if(e&&!this.spatialReference&&i){if(t!=null)return;const r=br(()=>t=is(t));t=i0(async s=>{try{await J$(this.spatialReferenceWarningDelay,null,s)}catch{return}finally{t=null}ne.getLogger(this).warn("#spatialReference","no spatial reference could be derived from the currently added map layers")}),this.handles.add(r,"spatial-reference-logger-task")}else this.handles.remove("spatial-reference-logger-task")},{sync:!0})])}destroy(){var t,e;this.destroyed||(Fw.views.remove(this),this.viewEvents.destroy(),this.allLayerViews.destroy(),this.navigation&&(this.navigation.destroy(),this._set("navigation",null)),this.graphics=Je(this.graphics),this.analyses=Je(this.analyses),this.handles.remove("defaultsFromMap"),this.defaultsFromMap.destroy(),this._set("defaultsFromMap",null),Je(this.analysisViewManager),this.toolViewManager=Je(this.toolViewManager),this.layerViewManager=Je(this.layerViewManager),this.basemapView=Je(this.basemapView),(t=this.groundView)==null||t.destroy(),(e=this.layerViews)==null||e.forEach(i=>i.destroy()),this.layerViews.length=0,this.invalidate(),this._emitter.clear(),this.handles.removeAll(),this.map=Je(this.map))}_startup(){this._set("ready",!0)}_teardown(){this._set("ready",!1)}whenReady(){return Promise.resolve(this)}toMap(){return ne.getLogger(this).error("#toMap()","Not implemented on this instance of View"),null}get activeTool(){var t;return(t=this.toolViewManager)==null?void 0:t.activeTool}set activeTool(t){this.toolViewManager&&(this.toolViewManager.activeTool=t)}get animation(){return this._get("animation")}set animation(t){this._set("animation",t)}get center(){return null}get _defaultsFromMapSettings(){return{}}get defaultsFromMap(){return new ui({required:{tileInfo:!1,heightModelInfo:!1,extent:!1},map:()=>this.map,getSpatialReferenceSupport:t=>this.getSpatialReferenceSupport(t),...this._defaultsFromMapSettings})}get extent(){return this._get("extent")}set extent(t){this._set("extent",t)}get heightModelInfo(){return this.getDefaultHeightModelInfo()}get interacting(){return this.navigating}get navigating(){return!1}get preconditionsReady(){var t;return!(this.fatalError||!this._isValid||this._readyCycleForced||!this.map||rd.isLoadable(this.map)&&!this.map.loaded||this.width===0||this.height===0||!this.spatialReference||!this._validateSpatialReference(this.spatialReference)||!this._currentSpatialReference&&!((t=this.defaultsFromMap)!=null&&t.ready)||!this.typeSpecificPreconditionsReady)}get resolution(){return 0}set map(t){t!==this._get("map")&&(t!=null&&t.destroyed&&(ne.getLogger(this).warn("#map","The provided map is already destroyed",{map:t}),t=null),rd.isLoadable(t)&&t.load().catch(()=>{}),this.constructed&&!this.destroyed&&(this.forceReadyCycle(),this._currentSpatialReference=null),this._set("map",t))}get spatialReference(){var e,i;let t=this._userSpatialReference||this._currentSpatialReference||this.getDefaultSpatialReference()||null;return t&&((i=(e=this.defaultsFromMap)==null?void 0:e.required)!=null&&i.heightModelInfo)&&(t=t.clone(),t.vcsWkid=this.defaultsFromMap.vcsWkid,t.latestVcsWkid=this.defaultsFromMap.latestVcsWkid),t}set spatialReference(t){const e=!En(t,this._get("spatialReference"));this._set("_userSpatialReference",t),e&&(this._set("spatialReference",t),this._spatialReferenceChanged(t))}_spatialReferenceChanged(t){}get stationary(){return!this.animation&&!this.navigating&&!this.resizing}get tools(){var t;return(t=this.toolViewManager)==null?void 0:t.tools}get initialExtent(){var t;return(t=this.defaultsFromMap)==null?void 0:t.extent}get cursor(){const t=this.toolViewManager?this.toolViewManager.cursor:null;return t??(this._cursor||"default")}set cursor(t){this._cursor=t,this.notifyChange("cursor")}get size(){return[this.width,this.height]}whenLayerView(t){var e;return((e=this.layerViewManager)==null?void 0:e.whenLayerView(t))??Promise.reject()}getDefaultSpatialReference(){var t;return(t=this.defaultsFromMap)==null?void 0:t.spatialReference}getDefaultHeightModelInfo(){var t;return(this.map&&"heightModelInfo"in this.map?this.map.heightModelInfo:void 0)??((t=this.defaultsFromMap)==null?void 0:t.heightModelInfo)??null}importLayerView(t){throw new V("importLayerView() not implemented")}hasLayerViewModule(t){return!1}async validate(){}invalidate(){this._isValid=!1}getSpatialReferenceSupport(){return{constraints:null}}_validateSpatialReference(t){return this.getSpatialReferenceSupport({spatialReference:t})!=null}when(t,e){return this.isResolved()&&!this.ready&&ne.getLogger(this).warn("#when()","Calling view.when() while the view is no longer ready but was already resolved once will resolve immediately. Use reactiveUtils.whenOnce(() => view.ready).then(...) instead."),super.when(t,e)}forceReadyCycle(){this.ready&&(jo(()=>this.destroyed||this.preconditionsReady===!1,()=>this._readyCycleForced=!1,{once:!0}),this._readyCycleForced=!0)}addAndActivateTool(t){this.toolViewManager.tools.add(t),this.activeTool=t}tryFatalErrorRecovery(){this.fatalError=null}};Ne.views=new xe,h([p()],Ne.prototype,"_userSpatialReference",void 0),h([p()],Ne.prototype,"activeTool",null),h([p({readOnly:!0})],Ne.prototype,"allLayerViews",void 0),h([p()],Ne.prototype,"groundView",void 0),h([p()],Ne.prototype,"animation",null),h([p()],Ne.prototype,"basemapView",void 0),h([p()],Ne.prototype,"center",null),h([p({readOnly:!0})],Ne.prototype,"_defaultsFromMapSettings",null),h([p()],Ne.prototype,"defaultsFromMap",null),h([p()],Ne.prototype,"fatalError",void 0),h([p({type:Le})],Ne.prototype,"extent",null),h([p(dD(_y,"graphics"))],Ne.prototype,"graphics",void 0),h([p(dD(SA,"analyses"))],Ne.prototype,"analyses",void 0),h([p({readOnly:!0,type:AP})],Ne.prototype,"heightModelInfo",null),h([p({readOnly:!0})],Ne.prototype,"interacting",null),h([p({readOnly:!0})],Ne.prototype,"navigating",null),h([p({readOnly:!0,dependsOn:["fatalError","_isValid","_readyCycleForced","map","map.loaded?","width","height","spatialReference","_currentSpatialReference","defaultsFromMap.ready","typeSpecificPreconditionsReady"]})],Ne.prototype,"preconditionsReady",null),h([p({readOnly:!0})],Ne.prototype,"typeSpecificPreconditionsReady",void 0),h([p({type:xe,readOnly:!0})],Ne.prototype,"layerViews",void 0),h([p()],Ne.prototype,"resolution",null),h([p({type:mre})],Ne.prototype,"magnifier",void 0),h([p({value:null,type:Qee})],Ne.prototype,"map",null),h([p()],Ne.prototype,"padding",void 0),h([p({readOnly:!0})],Ne.prototype,"ready",void 0),h([p({type:Ee})],Ne.prototype,"spatialReference",null),h([p()],Ne.prototype,"spatialReferenceWarningDelay",void 0),h([p()],Ne.prototype,"stationary",null),h([p({readOnly:!0})],Ne.prototype,"supportsGround",void 0),h([p({type:Bu})],Ne.prototype,"timeExtent",void 0),h([p({type:IV,nonNullable:!0})],Ne.prototype,"timeReference",void 0),h([p()],Ne.prototype,"tools",null),h([p()],Ne.prototype,"toolViewManager",void 0),h([p({readOnly:!0})],Ne.prototype,"type",void 0),h([p({type:Number})],Ne.prototype,"scale",void 0),h([p({readOnly:!0})],Ne.prototype,"updating",void 0),h([p({readOnly:!0})],Ne.prototype,"initialExtentRequired",void 0),h([p({readOnly:!0})],Ne.prototype,"initialExtent",null),h([p()],Ne.prototype,"cursor",null),h([p({readOnly:!0})],Ne.prototype,"input",void 0),h([p({type:xre,nonNullable:!0})],Ne.prototype,"navigation",void 0),h([p()],Ne.prototype,"layerViewManager",void 0),h([p()],Ne.prototype,"analysisViewManager",void 0),h([p()],Ne.prototype,"width",void 0),h([p()],Ne.prototype,"height",void 0),h([p({readOnly:!0})],Ne.prototype,"resizing",void 0),h([p({value:null,readOnly:!0})],Ne.prototype,"size",null),h([p({readOnly:!0})],Ne.prototype,"suspended",void 0),h([p({readOnly:!0})],Ne.prototype,"viewEvents",void 0),h([p({readOnly:!0})],Ne.prototype,"persistableViewModels",void 0),h([p()],Ne.prototype,"_isValid",void 0),h([p()],Ne.prototype,"_readyCycleForced",void 0),h([p()],Ne.prototype,"_currentSpatialReference",void 0),Ne=Fw=h([P("esri.views.View")],Ne);const HEe=Ne;function qEe(t){return t.layerViews}let up=class extends HE{constructor(e){super(e),this.state="running",this.target=null,this._resolver=null}initialize(){this._resolver=xc(),this.addResolvingPromise(this._resolver.promise)}get done(){return this.state==="finished"||this.state==="stopped"}stop(){var e;this.state!=="stopped"&&this.state!=="finished"&&(this._set("state","stopped"),(e=this._resolver)==null||e.reject(new V("ViewAnimation stopped")))}finish(){var e;this.state!=="stopped"&&this.state!=="finished"&&(this._set("state","finished"),(e=this._resolver)==null||e.resolve())}update(e,i){i||(i=fd(e)?"waiting-for-target":"running"),this._set("target",e),this._set("state",i)}};h([p({readOnly:!0})],up.prototype,"done",null),h([p({readOnly:!0,type:String})],up.prototype,"state",void 0),h([p()],up.prototype,"target",void 0),up=h([P("esri.views.ViewAnimation")],up),function(t){t.State={RUNNING:"running",STOPPED:"stopped",FINISHED:"finished",WAITING_FOR_TARGET:"waiting-for-target"}}(up||(up={}));const vD=up;function Hg(t,e,i,n){const r=3*t,s=3*(i-t)-r,o=1-r-s,a=3*e,l=3*(n-e)-a,c=1-a-l;function u(g){return((o*g+s)*g+r)*g}function d(g){return((c*g+l)*g+a)*g}function f(g){return(3*o*g+2*s)*g+r}function m(g,y){let _,b,w,x,S,T;for(w=g,T=0;T<8;T++){if(x=u(w)-g,Math.abs(x)<y)return w;if(S=f(w),Math.abs(S)<1e-6)break;w-=x/S}if(_=0,b=1,w=g,w<_)return _;if(w>b)return b;for(;_<b;){if(x=u(w),Math.abs(x-g)<y)return w;g>x?_=w:b=w,w=.5*(b-_)+_}return w}return function(g,y=1e-6){return d(m(g,y))}}const WEe=/^cubic-bezier\((.*)\)/,Xa={};function JEe(t){let e=Xa[t]||null;if(!e){const i=WEe.exec(t);if(i){const n=i[1].split(",").map(r=>parseFloat(r.trim()));n.length!==4||n.some(r=>isNaN(r))||(e=Hg.apply(Hg,n))}}return e}Xa.ease=Hg(.25,.1,.25,1),Xa.linear=Hg(0,0,1,1),Xa.easeIn=Xa["ease-in"]=Hg(.42,0,1,1),Xa.easeOut=Xa["ease-out"]=Hg(0,0,.58,1),Xa.easeInOut=Xa["ease-in-out"]=Hg(.42,0,.58,1);function ZEe(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function PP(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}function YEe(t,e,i,n,r,s,o){return t[0]=e,t[1]=i,t[2]=n,t[3]=r,t[4]=s,t[5]=o,t}function EV(t,e){const i=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5];let l=i*s-n*r;return l?(l=1/l,t[0]=s*l,t[1]=-n*l,t[2]=-r*l,t[3]=i*l,t[4]=(r*a-s*o)*l,t[5]=(n*o-i*a)*l,t):null}function XEe(t){return t[0]*t[3]-t[1]*t[2]}function qg(t,e,i){const n=e[0],r=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=i[0],u=i[1],d=i[2],f=i[3],m=i[4],g=i[5];return t[0]=n*c+s*u,t[1]=r*c+o*u,t[2]=n*d+s*f,t[3]=r*d+o*f,t[4]=n*m+s*g+a,t[5]=r*m+o*g+l,t}function QS(t,e,i){const n=e[0],r=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=Math.sin(i),u=Math.cos(i);return t[0]=n*u+s*c,t[1]=r*u+o*c,t[2]=n*-c+s*u,t[3]=r*-c+o*u,t[4]=a,t[5]=l,t}function kP(t,e,i){const n=e[0],r=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=i[0],u=i[1];return t[0]=n*c,t[1]=r*c,t[2]=s*u,t[3]=o*u,t[4]=a,t[5]=l,t}function ub(t,e,i){const n=e[0],r=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=i[0],u=i[1];return t[0]=n,t[1]=r,t[2]=s,t[3]=o,t[4]=n*c+s*u+a,t[5]=r*c+o*u+l,t}function Ore(t,e){const i=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=i,t[2]=-i,t[3]=n,t[4]=0,t[5]=0,t}function Lre(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t}function AV(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t}function KEe(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"}function QEe(t){return Math.sqrt(t[0]**2+t[1]**2+t[2]**2+t[3]**2+t[4]**2+t[5]**2+1)}function eAe(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t[4]=e[4]+i[4],t[5]=e[5]+i[5],t}function Rre(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t[4]=e[4]-i[4],t[5]=e[5]-i[5],t}function tAe(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*i,t[5]=e[5]*i,t}function iAe(t,e,i,n){return t[0]=e[0]+i[0]*n,t[1]=e[1]+i[1]*n,t[2]=e[2]+i[2]*n,t[3]=e[3]+i[3]*n,t[4]=e[4]+i[4]*n,t[5]=e[5]+i[5]*n,t}function nAe(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]}function rAe(t,e){const i=t[0],n=t[1],r=t[2],s=t[3],o=t[4],a=t[5],l=e[0],c=e[1],u=e[2],d=e[3],f=e[4],m=e[5],g=so();return Math.abs(i-l)<=g*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(n-c)<=g*Math.max(1,Math.abs(n),Math.abs(c))&&Math.abs(r-u)<=g*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(s-d)<=g*Math.max(1,Math.abs(s),Math.abs(d))&&Math.abs(o-f)<=g*Math.max(1,Math.abs(o),Math.abs(f))&&Math.abs(a-m)<=g*Math.max(1,Math.abs(a),Math.abs(m))}const sAe=qg,oAe=Rre;Object.freeze(Object.defineProperty({__proto__:null,add:eAe,copy:ZEe,determinant:XEe,equals:rAe,exactEquals:nAe,frob:QEe,fromRotation:Ore,fromScaling:Lre,fromTranslation:AV,identity:PP,invert:EV,mul:sAe,multiply:qg,multiplyScalar:tAe,multiplyScalarAndAdd:iAe,rotate:QS,scale:kP,set:YEe,str:KEe,sub:oAe,subtract:Rre,translate:ub},Symbol.toStringTag,{value:"Module"}));function Af(){return[1,0,0,1,0,0]}function aAe(t){return[t[0],t[1],t[2],t[3],t[4],t[5]]}function lAe(t,e,i,n,r,s){return[t,e,i,n,r,s]}function cAe(t,e){return new Float64Array(t,e,6)}Object.freeze(Object.defineProperty({__proto__:null,clone:aAe,create:Af,createView:cAe,fromValues:lAe},Symbol.toStringTag,{value:"Module"}));function J2(t,e){return t[0]=e[0],t[1]=e[1],t}function Or(t,e,i){return t[0]=e,t[1]=i,t}function $V(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t}function er(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t}function Dre(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t}function Nre(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t}function uAe(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t}function hAe(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t}function dAe(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t}function pAe(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t}function fAe(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t}function Jb(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t}function Wh(t,e,i,n){return t[0]=e[0]+i[0]*n,t[1]=e[1]+i[1]*n,t}function Xf(t,e){const i=e[0]-t[0],n=e[1]-t[1];return Math.sqrt(i*i+n*n)}function Ec(t,e){const i=e[0]-t[0],n=e[1]-t[1];return i*i+n*n}function hb(t){const e=t[0],i=t[1];return Math.sqrt(e*e+i*i)}function zf(t){const e=t[0],i=t[1];return e*e+i*i}function Fre(t,e){return t[0]=-e[0],t[1]=-e[1],t}function mAe(t,e){return t[0]=1/e[0],t[1]=1/e[1],t}function _D(t,e){const i=e[0],n=e[1];let r=i*i+n*n;return r>0&&(r=1/Math.sqrt(r),t[0]=e[0]*r,t[1]=e[1]*r),t}function Kf(t,e){return t[0]*e[0]+t[1]*e[1]}function zre(t,e,i){const n=e[0]*i[1]-e[1]*i[0];return t[0]=t[1]=0,t[2]=n,t}function PV(t,e,i,n){const r=e[0],s=e[1];return t[0]=r+n*(i[0]-r),t[1]=s+n*(i[1]-s),t}function gAe(t,e){e=e||1;const i=2*zS()*Math.PI;return t[0]=Math.cos(i)*e,t[1]=Math.sin(i)*e,t}function yAe(t,e,i){const n=e[0],r=e[1];return t[0]=i[0]*n+i[2]*r,t[1]=i[1]*n+i[3]*r,t}function fu(t,e,i){const n=e[0],r=e[1];return t[0]=i[0]*n+i[2]*r+i[4],t[1]=i[1]*n+i[3]*r+i[5],t}function vAe(t,e,i){const n=e[0],r=e[1];return t[0]=i[0]*n+i[3]*r+i[6],t[1]=i[1]*n+i[4]*r+i[7],t}function _Ae(t,e,i){const n=e[0],r=e[1];return t[0]=i[0]*n+i[4]*r+i[12],t[1]=i[1]*n+i[5]*r+i[13],t}function bAe(t,e,i,n){const r=e[0]-i[0],s=e[1]-i[1],o=Math.sin(n),a=Math.cos(n);return t[0]=r*a-s*o+i[0],t[1]=r*o+s*a+i[1],t}function wAe(t,e){const i=t[0],n=t[1],r=e[0],s=e[1];let o=i*i+n*n;o>0&&(o=1/Math.sqrt(o));let a=r*r+s*s;a>0&&(a=1/Math.sqrt(a));const l=(i*r+n*s)*o*a;return l>1?0:l<-1?Math.PI:Math.acos(l)}function xAe(t){return"vec2("+t[0]+", "+t[1]+")"}function SAe(t,e){return t[0]===e[0]&&t[1]===e[1]}function TAe(t,e){const i=t[0],n=t[1],r=e[0],s=e[1],o=so();return Math.abs(i-r)<=o*Math.max(1,Math.abs(i),Math.abs(r))&&Math.abs(n-s)<=o*Math.max(1,Math.abs(n),Math.abs(s))}function IAe(t,e,i,n,r){let s=e[0]-i[0],o=e[1]-i[1];const a=(n[0]*s+n[1]*o)*(r-1);return s=n[0]*a,o=n[1]*a,t[0]=e[0]+s,t[1]=e[1]+o,t}const CAe=hb,OP=er,MAe=Dre,EAe=Nre,AAe=Xf,$Ae=Ec,PAe=zf;Object.freeze(Object.defineProperty({__proto__:null,add:$V,angle:wAe,ceil:uAe,copy:J2,cross:zre,dist:AAe,distance:Xf,div:EAe,divide:Nre,dot:Kf,equals:TAe,exactEquals:SAe,floor:hAe,inverse:mAe,len:CAe,length:hb,lerp:PV,max:pAe,min:dAe,mul:MAe,multiply:Dre,negate:Fre,normalize:_D,projectAndScale:IAe,random:gAe,rotate:bAe,round:fAe,scale:Jb,scaleAndAdd:Wh,set:Or,sqrDist:$Ae,sqrLen:PAe,squaredDistance:Ec,squaredLength:zf,str:xAe,sub:OP,subtract:er,transformMat2:yAe,transformMat2d:fu,transformMat3:vAe,transformMat4:_Ae},Symbol.toStringTag,{value:"Module"}));function kt(){return[0,0]}function Vre(t){return[t[0],t[1]]}function eT(t,e){return[t,e]}function kAe(t){const e=kt(),i=Math.min(2,t.length);for(let n=0;n<i;++n)e[n]=t[n];return e}function jre(t,e){return new Float64Array(t,e,2)}function Bre(){return kt()}function Ure(){return eT(1,1)}function Gre(){return eT(1,0)}function Hre(){return eT(0,1)}const OAe=Bre(),LAe=Ure(),RAe=Gre(),DAe=Hre();Object.freeze(Object.defineProperty({__proto__:null,ONES:LAe,UNIT_X:RAe,UNIT_Y:DAe,ZEROS:OAe,clone:Vre,create:kt,createView:jre,fromArray:kAe,fromValues:eT,ones:Ure,unitX:Gre,unitY:Hre,zeros:Bre},Symbol.toStringTag,{value:"Module"}));const qre=96,Wre=39.37,NAe=180/Math.PI;function Jre(t){return t.wkid?t:t.spatialReference||Ee.WGS84}function kV(t,e){return e.type?Or(t,e.x,e.y):J2(t,e)}function Zre(t){return pi(t)}function O_(t,e){const i=Math.max(1,e[0]),n=Math.max(1,e[1]);return Math.max(t.width/i,t.height/n)*qAe(t.spatialReference)}async function zw(t,e,i,n){var a,l;let r,s;if(!t||Array.isArray(t)&&!t.length)return null;if(xe.isCollection(t)&&(t=t.toArray()),Array.isArray(t)&&t.length&&typeof t[0]=="object"){const c=t.every(f=>"attributes"in f),u=t.some(f=>!f.geometry);let d=t;if(c&&u&&e&&e.allLayerViews){const f=new Map;for(const _ of t){const b=_.layer,w=f.get(b)||[],x=_.attributes[b.objectIdField];x!=null&&w.push(x),f.set(b,w)}const m=[];f.forEach((_,b)=>{const w=e.allLayerViews.find(x=>x.layer.id===b.id);if(w&&"queryFeatures"in w){const x=b.createQuery();x.objectIds=_,x.returnGeometry=!0,m.push(w.queryFeatures(x))}});const g=await Promise.all(m),y=[];for(const _ of g)if(_&&_.features&&_.features.length)for(const b of _.features)b.geometry!=null&&y.push(b.geometry);d=y}for(const f of d)n=await zw(f,e,i,n);return n}if(Array.isArray(t)&&t.length===2&&typeof t[0]=="number"&&typeof t[1]=="number")r=new pe(t);else if(t instanceof md)r=t;else if("geometry"in t){if(t.geometry)r=t.geometry;else if(t.layer){const c=t.layer,u=e.allLayerViews.find(d=>d.layer.id===c.id);if(u&&"queryFeatures"in u){const d=c.createQuery();d.objectIds=[t.attributes[c.objectIdField]],d.returnGeometry=!0;const f=await u.queryFeatures(d);r=(l=(a=f==null?void 0:f.features)==null?void 0:a[0])==null?void 0:l.geometry}}}if(r==null||(s=r.type==="point"?new Le({xmin:r.x,ymin:r.y,xmax:r.x,ymax:r.y,spatialReference:r.spatialReference}):r.extent,!s))return null;wl()||yl(s.spatialReference,i)||await Ic();const o=an(s,i);return o?n=n?n.union(o):o:null}function FAe(t){if(t&&(!Array.isArray(t)||typeof t[0]!="number")&&(typeof t=="object"||Array.isArray(t)&&typeof t[0]=="object")){if("layer"in t&&t.layer&&t.layer.minScale&&t.layer.maxScale){const e=t.layer;return{min:e.minScale,max:e.maxScale}}if(Array.isArray(t)&&t.length&&t.every(e=>"layer"in e)){let e=0,i=0;for(const n of t){const r=n.layer;r&&r.minScale&&r.maxScale&&(e=r.minScale<e?r.minScale:e,i=r.maxScale>i?r.maxScale:i)}return e&&i?{min:e,max:i}:null}}}function z3(t,e){return En(Jre(t),e)?t:an(t,e)}async function zAe(t,e){if(!t||!e)return new Cu({targetGeometry:new pe,scale:0,rotation:0});let i=e.spatialReference;const{constraints:n,padding:r,viewpoint:s,size:o}=e,a=[r?o[0]-r.left-r.right:o[0],r?o[1]-r.top-r.bottom:o[1]];let l=null;t instanceof Cu?l=t:t.viewpoint?l=t.viewpoint:t.target&&t.target.declaredClass==="esri.Viewpoint"&&(l=t.target);let c=null;l&&l.targetGeometry?c=l.targetGeometry:t instanceof Le?c=t:(t||t&&("center"in t||"extent"in t||"target"in t))&&(c=await zw(t.center,e,i)||await zw(t.extent,e,i)||await zw(t.target,e,i)||await zw(t,e,i)),!c&&s&&s.targetGeometry?c=s.targetGeometry:!c&&e.extent&&(c=e.extent),i||(i=Jre(e.spatialReference||e.extent||c)),wl()||En(c.spatialReference,i)||yl(c,i)||await Ic();const u=z3(c.center??c,i);let d=0;if(l&&l.targetGeometry!=null&&l.targetGeometry.type==="point")d=l.scale;else if("scale"in t&&t.scale)d=t.scale;else if("zoom"in t&&t.zoom!==-1&&n&&n.effectiveLODs)d=n.zoomToScale(t.zoom);else if(Array.isArray(c)||c.type==="point"||c.type==="extent"&&c.width===0&&c.height===0){const y=z3(e.extent,i);d=y!=null?O_(y,a):e.extent?O_(e.extent,a):s.scale}else d=O_(z3(c.extent,i),a);const f=FAe(t);f&&(f.min&&f.min>d?d=f.min:f.max&&f.max<d&&(d=f.max));let m=0;l?m=l.rotation:t.hasOwnProperty("rotation")?m=t.rotation:s&&(m=s.rotation);let g=new Cu({targetGeometry:u,scale:d,rotation:m});return n&&(g=n.fit(g),n.constrainByGeometry(g),n.rotationEnabled||(g.rotation=m)),g}function Oc(t,e){const i=t.targetGeometry,n=e.targetGeometry;return i.x=n.x,i.y=n.y,i.spatialReference=n.spatialReference,t.scale=e.scale,t.rotation=e.rotation,t}function VAe(t,e,i){return i?Or(t,.5*(e[0]-i.right+i.left),.5*(e[1]-i.bottom+i.top)):Jb(t,e,.5)}const jAe=function(){const t=kt();return function(e,i,n){const r=i.targetGeometry;kV(t,r);const s=.5*Zb(i);return e.xmin=t[0]-s*n[0],e.ymin=t[1]-s*n[1],e.xmax=t[0]+s*n[0],e.ymax=t[1]+s*n[1],e.spatialReference=r.spatialReference,e}}();function BAe(t,e,i,n,r){var s;return bD(t,e,i.center),t.scale=O_(i,n),(s=r==null?void 0:r.constraints)==null||s.constrain(t),t}function UAe(t,e,i,n){return RV(t,e,i,n),EV(t,t)}const Yre=function(){const t=kt();return function(e,i,n){return OP(e,WAe(e,i),VAe(t,i,n))}}(),GAe=function(){const t=Af(),e=kt();return function(i,n,r,s){const o=Zb(n),a=OV(n);return Or(e,o,o),Lre(t,e),QS(t,t,a),ub(t,t,Yre(e,r,s)),ub(t,t,[0,s.top-s.bottom]),Or(i,t[4],t[5])}}();function Zb(t){return t.scale*HAe(t.targetGeometry)}function HAe(t){return t!=null&&Nr(t.spatialReference)?1/(Zre(t.spatialReference)*Wre*qre):1}function OV(t){return b6(t.rotation)||0}function qAe(t){return Nr(t)?Zre(t)*Wre*qre:1}function WAe(t,e){return Jb(t,e,.5)}const LV=function(){const t=kt(),e=kt(),i=kt();return function(n,r,s,o,a,l){return Fre(t,r),Jb(e,s,.5*l),Or(i,1/o*l,-1/o*l),AV(n,e),a&&QS(n,n,a),kP(n,n,i),ub(n,n,t),n}}(),RV=function(){const t=kt();return function(e,i,n,r){const s=Zb(i),o=OV(i);return kV(t,i.targetGeometry),LV(e,t,n,s,o,r)}}(),JAe=function(){const t=kt();return function(e,i,n,r){const s=Zb(i);return kV(t,i.targetGeometry),LV(e,t,n,s,0,r)}}();function ZAe(t){const e=to(t);return e?e.valid[1]-e.valid[0]:0}function YAe(t,e){return Math.round(ZAe(t)/e)}const XAe=function(){const t=kt(),e=kt(),i=[0,0,0];return function(n,r,s){er(t,n,r),_D(t,t),er(e,n,s),_D(e,e),zre(i,t,e);let o=Math.acos(Kf(t,e)/(hb(t)*hb(e)))*NAe;return i[2]<0&&(o=-o),isNaN(o)&&(o=0),o}}(),KAe=function(){const t=kt();return function(e,i,n,r){const s=e.targetGeometry;return Oc(e,i),GAe(t,i,n,r),s.x+=t[0],s.y+=t[1],e}}(),bD=function(t,e,i){Oc(t,e);const n=t.targetGeometry;return n.x=i.x,n.y=i.y,n.spatialReference=i.spatialReference,t},QAe=function(){const t=kt();return function(e,i,n,r,s){s||(s="center"),OP(t,n,r),Jb(t,t,.5);const o=t[0],a=t[1];switch(s){case"center":Or(t,0,0);break;case"left":Or(t,-o,0);break;case"top":Or(t,0,a);break;case"right":Or(t,o,0);break;case"bottom":Or(t,0,-a);break;case"top-left":Or(t,-o,a);break;case"bottom-left":Or(t,-o,-a);break;case"top-right":Or(t,o,a);break;case"bottom-right":Or(t,o,-a)}return LP(e,i,t),e}}();function Aut(t,e,i){return Oc(t,e),t.rotation+=i,t}function e$e(t,e,i){return Oc(t,e),t.rotation=i,t}const t$e=function(){const t=kt();return function(e,i,n,r,s){return Oc(e,i),isNaN(n)||n===0||(Kre(t,r,i,s),e.scale=i.scale*n,Qre(t,t,e,s),LP(e,e,Or(t,t[0]-r[0],r[1]-t[1]))),e}}();function S7(t,e,i){return Oc(t,e),t.scale=i,t}const Xre=function(){const t=kt();return function(e,i,n,r,s,o){return Oc(e,i),isNaN(n)||n===0||(Kre(t,s,i,o),e.scale=i.scale*n,e.rotation+=r,Qre(t,t,e,o),LP(e,e,Or(t,t[0]-s[0],s[1]-t[1]))),e}}(),$ut=function(){const t=kt(),e=kt();return function(i,n,r,s,o,a,l){return Yre(e,a,l),$V(t,o,e),s?Xre(i,n,r,s,t,a):t$e(i,n,r,t,a)}}(),Kre=function(){const t=Af();return function(e,i,n,r){return fu(e,i,UAe(t,n,r,1))}}(),Qre=function(){const t=Af();return function(e,i,n,r){return fu(e,i,RV(t,n,r,1))}}(),LP=function(){const t=kt(),e=Af();return function(i,n,r){Oc(i,n);const s=Zb(n),o=i.targetGeometry;return Ore(e,OV(n)),kP(e,e,eT(s,s)),fu(t,r,e),o.x+=t[0],o.y+=t[1],i}}();let i$e=class{constructor(e,i,n,r){const s=e.targetGeometry,o=i.targetGeometry;r?typeof r=="string"&&(r=JEe(r)||Xa.ease):r=Xa.ease,this.easing=r,this.duration=n,this.sCenterX=s.x,this.sCenterY=s.y,this.sScale=e.scale,this.sRotation=e.rotation,this.tCenterX=o.x,this.tCenterY=o.y,this.tScale=i.scale,this.tRotation=i.rotation,this.dCenterX=this.tCenterX-this.sCenterX,this.dCenterY=this.tCenterY-this.sCenterY,this.dScale=this.tScale-this.sScale,this.dRotation=this.tRotation-this.sRotation,this.dRotation>180?this.dRotation-=360:this.dRotation<-180&&(this.dRotation+=360)}applyRatio(e,i){const n=this.easing(i);let r,s,o,a;i>=1?(r=this.tCenterX,s=this.tCenterY,o=this.tRotation,a=this.tScale):(r=this.sCenterX+n*this.dCenterX,s=this.sCenterY+n*this.dCenterY,o=this.sRotation+n*this.dRotation,a=this.sScale+n*this.dScale),e.targetGeometry.x=r,e.targetGeometry.y=s,e.scale=a,e.rotation=o}},ch=class extends ye{constructor(e){super(e),this.updateFunction=null,this.animation=null,this.duration=200,this.transition=null,this.easing=Xa.ease,this.view=null,this.viewpoint=new Cu({targetGeometry:new pe,scale:0,rotation:0}),this._updateTask=Y_({postRender:this._postRender.bind(this)}),this._updateTask.pause()}destroy(){this._updateTask=Ri(this._updateTask)}animate(e,i,n){this.stop();const r=this.viewpoint;Oc(r,i),this.transition=new i$e(this.viewpoint,e.target,n&&n.duration||this.duration,n&&n.easing||this.easing);const s=()=>{var o,a;this.animation===e&&this._updateTask&&(e.state==="finished"&&((o=this.transition)==null||o.applyRatio(this.viewpoint,1),(a=this.view)!=null&&a.state&&(this.view.state.viewpoint=this.viewpoint.clone())),this.animation=null,this.updateFunction=null)};return e.when(s,s),this._startTime=performance.now(),this._updateTask.resume(),this.animation=e,e}animateContinous(e,i){this.stop(),this.updateFunction=i,this.viewpoint=e;const n=new vD({target:e.clone()}),r=()=>{this.animation===n&&this._updateTask&&(this.animation=null,this.updateFunction=null)};return n.when(r,r),this._startTime=performance.now(),this._updateTask.resume(),this.animation=n,n}stop(){this.animation&&(this.animation.stop(),this.animation=null,this.updateFunction=null)}_postRender(e){var n,r;const i=this.animation;if(i&&i.state!==vD.State.STOPPED){if(this.updateFunction)this.updateFunction(this.viewpoint,e.deltaTime);else{const s=this.transition,o=(performance.now()-this._startTime)/s.duration,a=o>=1;s.applyRatio(this.viewpoint,o),a&&((n=this.animation)==null||n.finish())}(r=this.view)!=null&&r.state&&(this.view.state.viewpoint=this.viewpoint.clone())}else this._updateTask.pause()}};h([p()],ch.prototype,"animation",void 0),h([p()],ch.prototype,"duration",void 0),h([p()],ch.prototype,"transition",void 0),h([p()],ch.prototype,"easing",void 0),h([p()],ch.prototype,"view",void 0),h([p()],ch.prototype,"viewpoint",void 0),ch=h([P("esri.views.2d.AnimationManager")],ch);const n$e=ch;let r$e=class{constructor(e){this.view=e,this._stationaryHandle=null,this._frameTaskHandle=null,this._updateParameters=null,this._updateRequested=!1,this.stationary=!0,this.animationInProgress=!1,this.prepare=()=>{this._updateParameters&&(this._updateParameters.state=this.view.state,this._updateParameters.stationary=this.view.stationary,this._updateParameters.pixelRatio=window.devicePixelRatio,this._updateParameters.renderingOptions=this.view.renderingOptions)},this.update=()=>{var o,a;if(this._updateRequested=!1,(o=this.view)==null?void 0:o.destroyed)return;const{allLayerViews:i,graphicsView:n,labelManager:r,state:{id:s}}=this.view;i.forEach(this._updateLayerView,this),r!=null&&(r.lastUpdateId!==s&&(r.viewChange(),r.lastUpdateId=s),r.updateRequested&&r.processUpdate(this._updateParameters)),n!=null&&(n.lastUpdateId!==s&&(n.viewChange(),n.lastUpdateId=s),n.updateRequested&&n.processUpdate(this._updateParameters)),this.view.graphicsTileStore.setViewState(this._updateParameters.state),this.animationInProgress||this._updateRequested||((a=this._frameTaskHandle)==null||a.pause())}}destroy(){this.stop()}start(){if(this._frameTaskHandle)return;const e=this.view;this.stationary=e.stationary,this._updateParameters={state:e.state,pixelRatio:window.devicePixelRatio,stationary:this.stationary,renderingOptions:e.renderingOptions},this._stationaryHandle=Q(()=>e.stationary,i=>{this.stationary=i,this.requestFrame()}),this._frameTaskHandle=Y_(this),this.requestUpdate()}stop(){var e;this._frameTaskHandle&&(this._updateRequested=!1,(e=this._stationaryHandle)==null||e.remove(),this._frameTaskHandle.remove(),this._updateParameters=this._stationaryHandle=this._frameTaskHandle=null,this.stationary=!0,this.animationInProgress=!1)}requestUpdate(){this._updateRequested||(this._updateRequested=!0,this.requestFrame())}requestFrame(){this._frameTaskHandle&&this._frameTaskHandle.resume()}_updateLayerView(e){var r;if(!e.attached)return void this.requestUpdate();const i=this.view.state,n=e.lastUpdateId;n!=null&&(this.stationary||e.moving)||(e.moving=!0,e.moveStart()),n!==i.id&&e.viewChange(),this.stationary&&e.moving&&(e.moving=!1,e.moveEnd()),e.lastUpdateId=i.id,e.updateRequested&&e.processUpdate(this._updateParameters),"layerViews"in e&&((r=e.layerViews)==null||r.forEach(this._updateLayerView,this))}};function hn(){return Promise.all([Y(()=>import("./webglDeps-23009489.js"),["./webglDeps-23009489.js","./VertexArrayObject-c8e6ef22.js","./Texture-6a4a9109.js","./enums-b14466b3.js","./ProgramTemplate-d3ea1e61.js","./programUtils-e6ec1729.js","./NestedMap-1b5db22e.js"],import.meta.url),Y(()=>import("./mapViewDeps-0d6eaf7a.js"),["./mapViewDeps-0d6eaf7a.js","./CIMResourceManager-2b6c9f9f.js","./fontUtils-36c927ab.js","./Rasterizer-37f71a46.js","./cimAnalyzer-1925a3d6.js","./BidiEngine-9a40f2f4.js","./OptimizedGeometry-196224d4.js","./GeometryUtils-984e8446.js","./enums-f1a6a48a.js","./alignmentUtils-ae955d28.js","./definitions-97fbc524.js","./number-e491b09e.js","./Rect-ea14f53a.js","./callExpressionWithFeature-2746b39a.js","./quantizationUtils-4d6bfb95.js","./floatRGBA-3a82b521.js","./rasterizingUtils-1dfc8831.js","./imageutils-bc5643b0.js","./Container-0003cec6.js","./enums-b14466b3.js","./Texture-6a4a9109.js","./BufferPool-ac49ede8.js","./AttributeStoreView-1c173c99.js","./TiledDisplayObject-d0b73ef5.js","./color-769a2896.js","./VertexElementDescriptor-2925c6af.js","./WGLContainer-2cf6354a.js","./VertexArrayObject-c8e6ef22.js","./vec4f32-0d1b2306.js","./ProgramTemplate-d3ea1e61.js","./GeometryUtils-12600119.js","./StyleDefinition-29c49b98.js","./config-1337d16e.js","./earcut-b7ad7453.js","./featureConversionUtils-7f0dd1f5.js","./OptimizedFeature-4701473b.js","./OptimizedFeatureSet-1d1ac4b9.js","./visualVariablesUtils-be80a4d1.js","./ExpandedCIM-3803a601.js","./util-16ac108f.js","./enums-fb086c25.js","./programUtils-e6ec1729.js","./NestedMap-1b5db22e.js","./MagnifierPrograms-ed300406.js","./pbf-984c4807.js","./Matcher-79a45603.js","./tileUtils-c2f19f52.js","./TurboLine-08ef9655.js","./CircularArray-ef508845.js","./testSVGPremultipliedAlpha-970e6ff0.js","./ComputedAttributeStorage-4014e53f.js","./arcadeTimeUtils-31294c74.js","./executionError-c92d3b85.js","./centroid-8e8cfa47.js","./RenderingContext-dbe37d87.js","./OrderIndependentTransparency-2a607a9a.js","./basicInterfaces-bb952591.js","./doublePrecisionUtils-e3c3d0d8.js","./imageUtils-c2d0d1ae.js","./GraphicsView2D-dc0beb08.js","./normalizeUtilsSync-da20ec22.js","./projectionSupport-7e11e91a.js","./json-48e3ea08.js","./GraphicContainer-7977f641.js","./BaseGraphicContainer-95a978d7.js","./FeatureContainer-95df36a3.js","./TileContainer-2082ecc6.js","./requestImageUtils-7eb39924.js"],import.meta.url)])}const M1=()=>hn().then(()=>Y(()=>import("./TileLayerView2D-1a18fc34.js"),["./TileLayerView2D-1a18fc34.js","./Rasterizer-37f71a46.js","./cimAnalyzer-1925a3d6.js","./fontUtils-36c927ab.js","./BidiEngine-9a40f2f4.js","./OptimizedGeometry-196224d4.js","./GeometryUtils-984e8446.js","./enums-f1a6a48a.js","./alignmentUtils-ae955d28.js","./definitions-97fbc524.js","./number-e491b09e.js","./Rect-ea14f53a.js","./callExpressionWithFeature-2746b39a.js","./quantizationUtils-4d6bfb95.js","./floatRGBA-3a82b521.js","./rasterizingUtils-1dfc8831.js","./Container-0003cec6.js","./enums-b14466b3.js","./Texture-6a4a9109.js","./BufferPool-ac49ede8.js","./AttributeStoreView-1c173c99.js","./TiledDisplayObject-d0b73ef5.js","./color-769a2896.js","./VertexElementDescriptor-2925c6af.js","./WGLContainer-2cf6354a.js","./VertexArrayObject-c8e6ef22.js","./vec4f32-0d1b2306.js","./ProgramTemplate-d3ea1e61.js","./GeometryUtils-12600119.js","./StyleDefinition-29c49b98.js","./config-1337d16e.js","./earcut-b7ad7453.js","./featureConversionUtils-7f0dd1f5.js","./OptimizedFeature-4701473b.js","./OptimizedFeatureSet-1d1ac4b9.js","./visualVariablesUtils-be80a4d1.js","./ExpandedCIM-3803a601.js","./util-16ac108f.js","./enums-fb086c25.js","./MagnifierPrograms-ed300406.js","./pbf-984c4807.js","./imageutils-bc5643b0.js","./Matcher-79a45603.js","./tileUtils-c2f19f52.js","./TurboLine-08ef9655.js","./CircularArray-ef508845.js","./testSVGPremultipliedAlpha-970e6ff0.js","./ComputedAttributeStorage-4014e53f.js","./arcadeTimeUtils-31294c74.js","./executionError-c92d3b85.js","./centroid-8e8cfa47.js","./OrderIndependentTransparency-2a607a9a.js","./basicInterfaces-bb952591.js","./GraphicsView2D-dc0beb08.js","./normalizeUtilsSync-da20ec22.js","./projectionSupport-7e11e91a.js","./json-48e3ea08.js","./imageUtils-120d028c.js","./BitmapTileContainer-ecdf3c86.js","./Bitmap-0c15cda6.js","./TileContainer-2082ecc6.js","./LayerView2D-88b65f45.js","./HighlightGraphicContainer-ea35b1bf.js","./BaseGraphicContainer-95a978d7.js","./FeatureContainer-95df36a3.js","./LayerView-849133df.js","./RefreshableLayerView-654bb099.js","./MapServiceLayerViewHelper-5ddc35fd.js","./drapedUtils-c3232933.js","./popupUtils-dd683fba.js"],import.meta.url)),M0=()=>hn().then(()=>Y(()=>import("./FeatureLayerView2D-2adcf44f.js"),["./FeatureLayerView2D-2adcf44f.js","./definitions-97fbc524.js","./LayerView2D-88b65f45.js","./Container-0003cec6.js","./enums-b14466b3.js","./Texture-6a4a9109.js","./AttributeStoreView-1c173c99.js","./TiledDisplayObject-d0b73ef5.js","./color-769a2896.js","./enums-f1a6a48a.js","./VertexElementDescriptor-2925c6af.js","./number-e491b09e.js","./WGLContainer-2cf6354a.js","./VertexArrayObject-c8e6ef22.js","./vec4f32-0d1b2306.js","./ProgramTemplate-d3ea1e61.js","./GeometryUtils-12600119.js","./alignmentUtils-ae955d28.js","./StyleDefinition-29c49b98.js","./config-1337d16e.js","./earcut-b7ad7453.js","./featureConversionUtils-7f0dd1f5.js","./OptimizedFeature-4701473b.js","./OptimizedFeatureSet-1d1ac4b9.js","./OptimizedGeometry-196224d4.js","./visualVariablesUtils-be80a4d1.js","./cimAnalyzer-1925a3d6.js","./fontUtils-36c927ab.js","./BidiEngine-9a40f2f4.js","./GeometryUtils-984e8446.js","./Rect-ea14f53a.js","./callExpressionWithFeature-2746b39a.js","./quantizationUtils-4d6bfb95.js","./floatRGBA-3a82b521.js","./ExpandedCIM-3803a601.js","./util-16ac108f.js","./BitmapTileContainer-ecdf3c86.js","./Bitmap-0c15cda6.js","./TileContainer-2082ecc6.js","./CircularArray-ef508845.js","./BufferPool-ac49ede8.js","./FeatureContainer-95df36a3.js","./popupUtils-dd683fba.js","./LayerView-849133df.js","./RefreshableLayerView-654bb099.js"],import.meta.url)),T7={"base-dynamic":()=>hn().then(()=>Y(()=>import("./BaseDynamicLayerView2D-726efb32.js"),["./BaseDynamicLayerView2D-726efb32.js","./BitmapContainer-ab2a4062.js","./WGLContainer-2cf6354a.js","./definitions-97fbc524.js","./VertexArrayObject-c8e6ef22.js","./Texture-6a4a9109.js","./enums-b14466b3.js","./VertexElementDescriptor-2925c6af.js","./vec4f32-0d1b2306.js","./color-769a2896.js","./enums-f1a6a48a.js","./number-e491b09e.js","./ProgramTemplate-d3ea1e61.js","./GeometryUtils-12600119.js","./alignmentUtils-ae955d28.js","./StyleDefinition-29c49b98.js","./config-1337d16e.js","./Container-0003cec6.js","./earcut-b7ad7453.js","./featureConversionUtils-7f0dd1f5.js","./OptimizedFeature-4701473b.js","./OptimizedFeatureSet-1d1ac4b9.js","./OptimizedGeometry-196224d4.js","./LayerView2D-88b65f45.js","./ExportStrategy-d78af549.js","./Bitmap-0c15cda6.js","./LayerView-849133df.js","./RefreshableLayerView-654bb099.js"],import.meta.url)),"base-tile":M1,"bing-maps":M1,csv:M0,"geo-rss":()=>hn().then(()=>Y(()=>import("./GeoRSSLayerView2D-c805306f.js"),["./GeoRSSLayerView2D-c805306f.js","./LayerView2D-88b65f45.js","./Container-0003cec6.js","./definitions-97fbc524.js","./enums-b14466b3.js","./Texture-6a4a9109.js","./GraphicContainer-7977f641.js","./color-769a2896.js","./enums-f1a6a48a.js","./VertexElementDescriptor-2925c6af.js","./number-e491b09e.js","./BaseGraphicContainer-95a978d7.js","./FeatureContainer-95df36a3.js","./AttributeStoreView-1c173c99.js","./TiledDisplayObject-d0b73ef5.js","./WGLContainer-2cf6354a.js","./VertexArrayObject-c8e6ef22.js","./vec4f32-0d1b2306.js","./ProgramTemplate-d3ea1e61.js","./GeometryUtils-12600119.js","./alignmentUtils-ae955d28.js","./StyleDefinition-29c49b98.js","./config-1337d16e.js","./earcut-b7ad7453.js","./featureConversionUtils-7f0dd1f5.js","./OptimizedFeature-4701473b.js","./OptimizedFeatureSet-1d1ac4b9.js","./OptimizedGeometry-196224d4.js","./visualVariablesUtils-be80a4d1.js","./cimAnalyzer-1925a3d6.js","./fontUtils-36c927ab.js","./BidiEngine-9a40f2f4.js","./GeometryUtils-984e8446.js","./Rect-ea14f53a.js","./callExpressionWithFeature-2746b39a.js","./quantizationUtils-4d6bfb95.js","./floatRGBA-3a82b521.js","./ExpandedCIM-3803a601.js","./util-16ac108f.js","./TileContainer-2082ecc6.js","./GraphicsView2D-dc0beb08.js","./normalizeUtilsSync-da20ec22.js","./projectionSupport-7e11e91a.js","./json-48e3ea08.js","./Matcher-79a45603.js","./tileUtils-c2f19f52.js","./TurboLine-08ef9655.js","./ComputedAttributeStorage-4014e53f.js","./arcadeTimeUtils-31294c74.js","./executionError-c92d3b85.js","./centroid-8e8cfa47.js","./LayerView-849133df.js"],import.meta.url)),feature:M0,geojson:M0,graphics:()=>hn().then(()=>Y(()=>import("./GraphicsLayerView2D-25d24883.js"),["./GraphicsLayerView2D-25d24883.js","./LayerView2D-88b65f45.js","./Container-0003cec6.js","./definitions-97fbc524.js","./enums-b14466b3.js","./Texture-6a4a9109.js","./GraphicContainer-7977f641.js","./color-769a2896.js","./enums-f1a6a48a.js","./VertexElementDescriptor-2925c6af.js","./number-e491b09e.js","./BaseGraphicContainer-95a978d7.js","./FeatureContainer-95df36a3.js","./AttributeStoreView-1c173c99.js","./TiledDisplayObject-d0b73ef5.js","./WGLContainer-2cf6354a.js","./VertexArrayObject-c8e6ef22.js","./vec4f32-0d1b2306.js","./ProgramTemplate-d3ea1e61.js","./GeometryUtils-12600119.js","./alignmentUtils-ae955d28.js","./StyleDefinition-29c49b98.js","./config-1337d16e.js","./earcut-b7ad7453.js","./featureConversionUtils-7f0dd1f5.js","./OptimizedFeature-4701473b.js","./OptimizedFeatureSet-1d1ac4b9.js","./OptimizedGeometry-196224d4.js","./visualVariablesUtils-be80a4d1.js","./cimAnalyzer-1925a3d6.js","./fontUtils-36c927ab.js","./BidiEngine-9a40f2f4.js","./GeometryUtils-984e8446.js","./Rect-ea14f53a.js","./callExpressionWithFeature-2746b39a.js","./quantizationUtils-4d6bfb95.js","./floatRGBA-3a82b521.js","./ExpandedCIM-3803a601.js","./util-16ac108f.js","./TileContainer-2082ecc6.js","./GraphicsView2D-dc0beb08.js","./normalizeUtilsSync-da20ec22.js","./projectionSupport-7e11e91a.js","./json-48e3ea08.js","./Matcher-79a45603.js","./tileUtils-c2f19f52.js","./TurboLine-08ef9655.js","./ComputedAttributeStorage-4014e53f.js","./arcadeTimeUtils-31294c74.js","./executionError-c92d3b85.js","./centroid-8e8cfa47.js","./LayerView-849133df.js"],import.meta.url)),group:()=>hn().then(()=>Y(()=>import("./GroupLayerView2D-d36464bd.js"),["./GroupLayerView2D-d36464bd.js","./GroupContainer-f41088f0.js","./WGLContainer-2cf6354a.js","./definitions-97fbc524.js","./VertexArrayObject-c8e6ef22.js","./Texture-6a4a9109.js","./enums-b14466b3.js","./VertexElementDescriptor-2925c6af.js","./vec4f32-0d1b2306.js","./color-769a2896.js","./enums-f1a6a48a.js","./number-e491b09e.js","./ProgramTemplate-d3ea1e61.js","./GeometryUtils-12600119.js","./alignmentUtils-ae955d28.js","./StyleDefinition-29c49b98.js","./config-1337d16e.js","./Container-0003cec6.js","./earcut-b7ad7453.js","./featureConversionUtils-7f0dd1f5.js","./OptimizedFeature-4701473b.js","./OptimizedFeatureSet-1d1ac4b9.js","./OptimizedGeometry-196224d4.js","./LayerView2D-88b65f45.js","./LayerView-849133df.js"],import.meta.url)),imagery:()=>hn().then(()=>Y(()=>import("./ImageryLayerView2D-a9222936.js"),["./ImageryLayerView2D-a9222936.js","./RasterVFDisplayObject-3caba663.js","./VertexArrayObject-c8e6ef22.js","./Texture-6a4a9109.js","./enums-b14466b3.js","./VertexElementDescriptor-2925c6af.js","./WGLContainer-2cf6354a.js","./definitions-97fbc524.js","./vec4f32-0d1b2306.js","./color-769a2896.js","./enums-f1a6a48a.js","./number-e491b09e.js","./ProgramTemplate-d3ea1e61.js","./GeometryUtils-12600119.js","./alignmentUtils-ae955d28.js","./StyleDefinition-29c49b98.js","./config-1337d16e.js","./Container-0003cec6.js","./earcut-b7ad7453.js","./featureConversionUtils-7f0dd1f5.js","./OptimizedFeature-4701473b.js","./OptimizedFeatureSet-1d1ac4b9.js","./OptimizedGeometry-196224d4.js","./LayerView2D-88b65f45.js","./GraphicsView2D-dc0beb08.js","./cimAnalyzer-1925a3d6.js","./fontUtils-36c927ab.js","./BidiEngine-9a40f2f4.js","./GeometryUtils-984e8446.js","./Rect-ea14f53a.js","./callExpressionWithFeature-2746b39a.js","./quantizationUtils-4d6bfb95.js","./floatRGBA-3a82b521.js","./normalizeUtilsSync-da20ec22.js","./projectionSupport-7e11e91a.js","./json-48e3ea08.js","./AttributeStoreView-1c173c99.js","./TiledDisplayObject-d0b73ef5.js","./visualVariablesUtils-be80a4d1.js","./ExpandedCIM-3803a601.js","./util-16ac108f.js","./Matcher-79a45603.js","./tileUtils-c2f19f52.js","./TurboLine-08ef9655.js","./ComputedAttributeStorage-4014e53f.js","./arcadeTimeUtils-31294c74.js","./executionError-c92d3b85.js","./centroid-8e8cfa47.js","./HighlightGraphicContainer-ea35b1bf.js","./BaseGraphicContainer-95a978d7.js","./FeatureContainer-95df36a3.js","./TileContainer-2082ecc6.js","./BitmapContainer-ab2a4062.js","./Bitmap-0c15cda6.js","./ExportStrategy-d78af549.js","./popupUtils-dd683fba.js","./LayerView-849133df.js","./RefreshableLayerView-654bb099.js"],import.meta.url)),"imagery-tile":()=>hn().then(()=>Y(()=>import("./ImageryTileLayerView2D-4da7cf29.js"),["./ImageryTileLayerView2D-4da7cf29.js","./RasterVFDisplayObject-3caba663.js","./VertexArrayObject-c8e6ef22.js","./Texture-6a4a9109.js","./enums-b14466b3.js","./VertexElementDescriptor-2925c6af.js","./WGLContainer-2cf6354a.js","./definitions-97fbc524.js","./vec4f32-0d1b2306.js","./color-769a2896.js","./enums-f1a6a48a.js","./number-e491b09e.js","./ProgramTemplate-d3ea1e61.js","./GeometryUtils-12600119.js","./alignmentUtils-ae955d28.js","./StyleDefinition-29c49b98.js","./config-1337d16e.js","./Container-0003cec6.js","./earcut-b7ad7453.js","./featureConversionUtils-7f0dd1f5.js","./OptimizedFeature-4701473b.js","./OptimizedFeatureSet-1d1ac4b9.js","./OptimizedGeometry-196224d4.js","./LayerView2D-88b65f45.js","./rasterUtils-85287595.js","./TiledDisplayObject-d0b73ef5.js","./TileContainer-2082ecc6.js","./util-16ac108f.js","./popupUtils-dd683fba.js","./LayerView-849133df.js","./RefreshableLayerView-654bb099.js"],import.meta.url)),kml:()=>hn().then(()=>Y(()=>import("./KMLLayerView2D-9e286fb7.js"),["./KMLLayerView2D-9e286fb7.js","./kmlUtils-62980e54.js","./Bitmap-0c15cda6.js","./Container-0003cec6.js","./definitions-97fbc524.js","./enums-b14466b3.js","./Texture-6a4a9109.js","./BitmapContainer-ab2a4062.js","./WGLContainer-2cf6354a.js","./VertexArrayObject-c8e6ef22.js","./VertexElementDescriptor-2925c6af.js","./vec4f32-0d1b2306.js","./color-769a2896.js","./enums-f1a6a48a.js","./number-e491b09e.js","./ProgramTemplate-d3ea1e61.js","./GeometryUtils-12600119.js","./alignmentUtils-ae955d28.js","./StyleDefinition-29c49b98.js","./config-1337d16e.js","./earcut-b7ad7453.js","./featureConversionUtils-7f0dd1f5.js","./OptimizedFeature-4701473b.js","./OptimizedFeatureSet-1d1ac4b9.js","./OptimizedGeometry-196224d4.js","./LayerView2D-88b65f45.js","./GraphicContainer-7977f641.js","./BaseGraphicContainer-95a978d7.js","./FeatureContainer-95df36a3.js","./AttributeStoreView-1c173c99.js","./TiledDisplayObject-d0b73ef5.js","./visualVariablesUtils-be80a4d1.js","./cimAnalyzer-1925a3d6.js","./fontUtils-36c927ab.js","./BidiEngine-9a40f2f4.js","./GeometryUtils-984e8446.js","./Rect-ea14f53a.js","./callExpressionWithFeature-2746b39a.js","./quantizationUtils-4d6bfb95.js","./floatRGBA-3a82b521.js","./ExpandedCIM-3803a601.js","./util-16ac108f.js","./TileContainer-2082ecc6.js","./GraphicsView2D-dc0beb08.js","./normalizeUtilsSync-da20ec22.js","./projectionSupport-7e11e91a.js","./json-48e3ea08.js","./Matcher-79a45603.js","./tileUtils-c2f19f52.js","./TurboLine-08ef9655.js","./ComputedAttributeStorage-4014e53f.js","./arcadeTimeUtils-31294c74.js","./executionError-c92d3b85.js","./centroid-8e8cfa47.js","./LayerView-849133df.js","./RenderingContext-dbe37d87.js","./programUtils-e6ec1729.js","./NestedMap-1b5db22e.js","./OrderIndependentTransparency-2a607a9a.js","./basicInterfaces-bb952591.js","./testSVGPremultipliedAlpha-970e6ff0.js","./doublePrecisionUtils-e3c3d0d8.js","./rasterUtils-85287595.js"],import.meta.url)),"knowledge-graph":()=>hn().then(()=>Y(()=>import("./KnowledgeGraphLayerView2D-6cbbbe2e.js"),["./KnowledgeGraphLayerView2D-6cbbbe2e.js","./LayerView2D-88b65f45.js","./Container-0003cec6.js","./definitions-97fbc524.js","./enums-b14466b3.js","./Texture-6a4a9109.js","./LayerView-849133df.js"],import.meta.url)),"link-chart":()=>hn().then(()=>Y(()=>import("./KnowledgeGraphLayerView2D-6cbbbe2e.js"),["./KnowledgeGraphLayerView2D-6cbbbe2e.js","./LayerView2D-88b65f45.js","./Container-0003cec6.js","./definitions-97fbc524.js","./enums-b14466b3.js","./Texture-6a4a9109.js","./LayerView-849133df.js"],import.meta.url)),"knowledge-graph-sublayer":M0,"map-image":()=>hn().then(()=>Y(()=>import("./MapImageLayerView2D-78a97387.js"),["./MapImageLayerView2D-78a97387.js","./BitmapContainer-ab2a4062.js","./WGLContainer-2cf6354a.js","./definitions-97fbc524.js","./VertexArrayObject-c8e6ef22.js","./Texture-6a4a9109.js","./enums-b14466b3.js","./VertexElementDescriptor-2925c6af.js","./vec4f32-0d1b2306.js","./color-769a2896.js","./enums-f1a6a48a.js","./number-e491b09e.js","./ProgramTemplate-d3ea1e61.js","./GeometryUtils-12600119.js","./alignmentUtils-ae955d28.js","./StyleDefinition-29c49b98.js","./config-1337d16e.js","./Container-0003cec6.js","./earcut-b7ad7453.js","./featureConversionUtils-7f0dd1f5.js","./OptimizedFeature-4701473b.js","./OptimizedFeatureSet-1d1ac4b9.js","./OptimizedGeometry-196224d4.js","./LayerView2D-88b65f45.js","./GraphicsView2D-dc0beb08.js","./cimAnalyzer-1925a3d6.js","./fontUtils-36c927ab.js","./BidiEngine-9a40f2f4.js","./GeometryUtils-984e8446.js","./Rect-ea14f53a.js","./callExpressionWithFeature-2746b39a.js","./quantizationUtils-4d6bfb95.js","./floatRGBA-3a82b521.js","./normalizeUtilsSync-da20ec22.js","./projectionSupport-7e11e91a.js","./json-48e3ea08.js","./AttributeStoreView-1c173c99.js","./TiledDisplayObject-d0b73ef5.js","./visualVariablesUtils-be80a4d1.js","./ExpandedCIM-3803a601.js","./util-16ac108f.js","./Matcher-79a45603.js","./tileUtils-c2f19f52.js","./TurboLine-08ef9655.js","./ComputedAttributeStorage-4014e53f.js","./arcadeTimeUtils-31294c74.js","./executionError-c92d3b85.js","./centroid-8e8cfa47.js","./HighlightGraphicContainer-ea35b1bf.js","./BaseGraphicContainer-95a978d7.js","./FeatureContainer-95df36a3.js","./TileContainer-2082ecc6.js","./ExportStrategy-d78af549.js","./Bitmap-0c15cda6.js","./LayerView-849133df.js","./RefreshableLayerView-654bb099.js","./MapServiceLayerViewHelper-5ddc35fd.js","./drapedUtils-c3232933.js","./popupUtils-dd683fba.js"],import.meta.url)),"map-notes":()=>hn().then(()=>Y(()=>import("./MapNotesLayerView2D-631896c8.js"),["./MapNotesLayerView2D-631896c8.js","./Container-0003cec6.js","./definitions-97fbc524.js","./enums-b14466b3.js","./Texture-6a4a9109.js","./GroupContainer-f41088f0.js","./WGLContainer-2cf6354a.js","./VertexArrayObject-c8e6ef22.js","./VertexElementDescriptor-2925c6af.js","./vec4f32-0d1b2306.js","./color-769a2896.js","./enums-f1a6a48a.js","./number-e491b09e.js","./ProgramTemplate-d3ea1e61.js","./GeometryUtils-12600119.js","./alignmentUtils-ae955d28.js","./StyleDefinition-29c49b98.js","./config-1337d16e.js","./earcut-b7ad7453.js","./featureConversionUtils-7f0dd1f5.js","./OptimizedFeature-4701473b.js","./OptimizedFeatureSet-1d1ac4b9.js","./OptimizedGeometry-196224d4.js","./LayerView2D-88b65f45.js","./GraphicContainer-7977f641.js","./BaseGraphicContainer-95a978d7.js","./FeatureContainer-95df36a3.js","./AttributeStoreView-1c173c99.js","./TiledDisplayObject-d0b73ef5.js","./visualVariablesUtils-be80a4d1.js","./cimAnalyzer-1925a3d6.js","./fontUtils-36c927ab.js","./BidiEngine-9a40f2f4.js","./GeometryUtils-984e8446.js","./Rect-ea14f53a.js","./callExpressionWithFeature-2746b39a.js","./quantizationUtils-4d6bfb95.js","./floatRGBA-3a82b521.js","./ExpandedCIM-3803a601.js","./util-16ac108f.js","./TileContainer-2082ecc6.js","./GraphicsView2D-dc0beb08.js","./normalizeUtilsSync-da20ec22.js","./projectionSupport-7e11e91a.js","./json-48e3ea08.js","./Matcher-79a45603.js","./tileUtils-c2f19f52.js","./TurboLine-08ef9655.js","./ComputedAttributeStorage-4014e53f.js","./arcadeTimeUtils-31294c74.js","./executionError-c92d3b85.js","./centroid-8e8cfa47.js","./LayerView-849133df.js"],import.meta.url)),media:()=>hn().then(()=>Y(()=>import("./MediaLayerView2D-baf820e6.js"),["./MediaLayerView2D-baf820e6.js","./perspectiveUtils-3f011831.js","./normalizeUtilsSync-da20ec22.js","./Rasterizer-37f71a46.js","./cimAnalyzer-1925a3d6.js","./fontUtils-36c927ab.js","./BidiEngine-9a40f2f4.js","./OptimizedGeometry-196224d4.js","./GeometryUtils-984e8446.js","./enums-f1a6a48a.js","./alignmentUtils-ae955d28.js","./definitions-97fbc524.js","./number-e491b09e.js","./Rect-ea14f53a.js","./callExpressionWithFeature-2746b39a.js","./quantizationUtils-4d6bfb95.js","./floatRGBA-3a82b521.js","./rasterizingUtils-1dfc8831.js","./Container-0003cec6.js","./enums-b14466b3.js","./Texture-6a4a9109.js","./BufferPool-ac49ede8.js","./AttributeStoreView-1c173c99.js","./TiledDisplayObject-d0b73ef5.js","./color-769a2896.js","./VertexElementDescriptor-2925c6af.js","./WGLContainer-2cf6354a.js","./VertexArrayObject-c8e6ef22.js","./vec4f32-0d1b2306.js","./ProgramTemplate-d3ea1e61.js","./GeometryUtils-12600119.js","./StyleDefinition-29c49b98.js","./config-1337d16e.js","./earcut-b7ad7453.js","./featureConversionUtils-7f0dd1f5.js","./OptimizedFeature-4701473b.js","./OptimizedFeatureSet-1d1ac4b9.js","./visualVariablesUtils-be80a4d1.js","./ExpandedCIM-3803a601.js","./util-16ac108f.js","./enums-fb086c25.js","./MagnifierPrograms-ed300406.js","./pbf-984c4807.js","./imageutils-bc5643b0.js","./Matcher-79a45603.js","./tileUtils-c2f19f52.js","./TurboLine-08ef9655.js","./CircularArray-ef508845.js","./testSVGPremultipliedAlpha-970e6ff0.js","./ComputedAttributeStorage-4014e53f.js","./arcadeTimeUtils-31294c74.js","./executionError-c92d3b85.js","./centroid-8e8cfa47.js","./OrderIndependentTransparency-2a607a9a.js","./basicInterfaces-bb952591.js","./GraphicsView2D-dc0beb08.js","./projectionSupport-7e11e91a.js","./json-48e3ea08.js","./LayerView2D-88b65f45.js","./LayerView-849133df.js"],import.meta.url)),"ogc-feature":()=>hn().then(()=>Y(()=>import("./OGCFeatureLayerView2D-1c5410da.js"),["./OGCFeatureLayerView2D-1c5410da.js","./FeatureLayerView2D-2adcf44f.js","./definitions-97fbc524.js","./LayerView2D-88b65f45.js","./Container-0003cec6.js","./enums-b14466b3.js","./Texture-6a4a9109.js","./AttributeStoreView-1c173c99.js","./TiledDisplayObject-d0b73ef5.js","./color-769a2896.js","./enums-f1a6a48a.js","./VertexElementDescriptor-2925c6af.js","./number-e491b09e.js","./WGLContainer-2cf6354a.js","./VertexArrayObject-c8e6ef22.js","./vec4f32-0d1b2306.js","./ProgramTemplate-d3ea1e61.js","./GeometryUtils-12600119.js","./alignmentUtils-ae955d28.js","./StyleDefinition-29c49b98.js","./config-1337d16e.js","./earcut-b7ad7453.js","./featureConversionUtils-7f0dd1f5.js","./OptimizedFeature-4701473b.js","./OptimizedFeatureSet-1d1ac4b9.js","./OptimizedGeometry-196224d4.js","./visualVariablesUtils-be80a4d1.js","./cimAnalyzer-1925a3d6.js","./fontUtils-36c927ab.js","./BidiEngine-9a40f2f4.js","./GeometryUtils-984e8446.js","./Rect-ea14f53a.js","./callExpressionWithFeature-2746b39a.js","./quantizationUtils-4d6bfb95.js","./floatRGBA-3a82b521.js","./ExpandedCIM-3803a601.js","./util-16ac108f.js","./BitmapTileContainer-ecdf3c86.js","./Bitmap-0c15cda6.js","./TileContainer-2082ecc6.js","./CircularArray-ef508845.js","./BufferPool-ac49ede8.js","./FeatureContainer-95df36a3.js","./popupUtils-dd683fba.js","./LayerView-849133df.js","./RefreshableLayerView-654bb099.js"],import.meta.url)),"open-street-map":M1,"oriented-imagery":M0,route:()=>hn().then(()=>Y(()=>import("./RouteLayerView2D-efb2fddc.js"),["./RouteLayerView2D-efb2fddc.js","./Stop-bf3b1e36.js","./LayerView2D-88b65f45.js","./Container-0003cec6.js","./definitions-97fbc524.js","./enums-b14466b3.js","./Texture-6a4a9109.js","./GraphicContainer-7977f641.js","./color-769a2896.js","./enums-f1a6a48a.js","./VertexElementDescriptor-2925c6af.js","./number-e491b09e.js","./BaseGraphicContainer-95a978d7.js","./FeatureContainer-95df36a3.js","./AttributeStoreView-1c173c99.js","./TiledDisplayObject-d0b73ef5.js","./WGLContainer-2cf6354a.js","./VertexArrayObject-c8e6ef22.js","./vec4f32-0d1b2306.js","./ProgramTemplate-d3ea1e61.js","./GeometryUtils-12600119.js","./alignmentUtils-ae955d28.js","./StyleDefinition-29c49b98.js","./config-1337d16e.js","./earcut-b7ad7453.js","./featureConversionUtils-7f0dd1f5.js","./OptimizedFeature-4701473b.js","./OptimizedFeatureSet-1d1ac4b9.js","./OptimizedGeometry-196224d4.js","./visualVariablesUtils-be80a4d1.js","./cimAnalyzer-1925a3d6.js","./fontUtils-36c927ab.js","./BidiEngine-9a40f2f4.js","./GeometryUtils-984e8446.js","./Rect-ea14f53a.js","./callExpressionWithFeature-2746b39a.js","./quantizationUtils-4d6bfb95.js","./floatRGBA-3a82b521.js","./ExpandedCIM-3803a601.js","./util-16ac108f.js","./TileContainer-2082ecc6.js","./GraphicsView2D-dc0beb08.js","./normalizeUtilsSync-da20ec22.js","./projectionSupport-7e11e91a.js","./json-48e3ea08.js","./Matcher-79a45603.js","./tileUtils-c2f19f52.js","./TurboLine-08ef9655.js","./ComputedAttributeStorage-4014e53f.js","./arcadeTimeUtils-31294c74.js","./executionError-c92d3b85.js","./centroid-8e8cfa47.js","./LayerView-849133df.js"],import.meta.url)),stream:()=>hn().then(()=>Y(()=>import("./StreamLayerView2D-40653373.js"),["./StreamLayerView2D-40653373.js","./FeatureLayerView2D-2adcf44f.js","./definitions-97fbc524.js","./LayerView2D-88b65f45.js","./Container-0003cec6.js","./enums-b14466b3.js","./Texture-6a4a9109.js","./AttributeStoreView-1c173c99.js","./TiledDisplayObject-d0b73ef5.js","./color-769a2896.js","./enums-f1a6a48a.js","./VertexElementDescriptor-2925c6af.js","./number-e491b09e.js","./WGLContainer-2cf6354a.js","./VertexArrayObject-c8e6ef22.js","./vec4f32-0d1b2306.js","./ProgramTemplate-d3ea1e61.js","./GeometryUtils-12600119.js","./alignmentUtils-ae955d28.js","./StyleDefinition-29c49b98.js","./config-1337d16e.js","./earcut-b7ad7453.js","./featureConversionUtils-7f0dd1f5.js","./OptimizedFeature-4701473b.js","./OptimizedFeatureSet-1d1ac4b9.js","./OptimizedGeometry-196224d4.js","./visualVariablesUtils-be80a4d1.js","./cimAnalyzer-1925a3d6.js","./fontUtils-36c927ab.js","./BidiEngine-9a40f2f4.js","./GeometryUtils-984e8446.js","./Rect-ea14f53a.js","./callExpressionWithFeature-2746b39a.js","./quantizationUtils-4d6bfb95.js","./floatRGBA-3a82b521.js","./ExpandedCIM-3803a601.js","./util-16ac108f.js","./BitmapTileContainer-ecdf3c86.js","./Bitmap-0c15cda6.js","./TileContainer-2082ecc6.js","./CircularArray-ef508845.js","./BufferPool-ac49ede8.js","./FeatureContainer-95df36a3.js","./popupUtils-dd683fba.js","./LayerView-849133df.js","./RefreshableLayerView-654bb099.js"],import.meta.url)),"subtype-group":()=>hn().then(()=>Y(()=>import("./SubtypeGroupLayerView2D-caa06f2e.js"),["./SubtypeGroupLayerView2D-caa06f2e.js","./FeatureLayerView2D-2adcf44f.js","./definitions-97fbc524.js","./LayerView2D-88b65f45.js","./Container-0003cec6.js","./enums-b14466b3.js","./Texture-6a4a9109.js","./AttributeStoreView-1c173c99.js","./TiledDisplayObject-d0b73ef5.js","./color-769a2896.js","./enums-f1a6a48a.js","./VertexElementDescriptor-2925c6af.js","./number-e491b09e.js","./WGLContainer-2cf6354a.js","./VertexArrayObject-c8e6ef22.js","./vec4f32-0d1b2306.js","./ProgramTemplate-d3ea1e61.js","./GeometryUtils-12600119.js","./alignmentUtils-ae955d28.js","./StyleDefinition-29c49b98.js","./config-1337d16e.js","./earcut-b7ad7453.js","./featureConversionUtils-7f0dd1f5.js","./OptimizedFeature-4701473b.js","./OptimizedFeatureSet-1d1ac4b9.js","./OptimizedGeometry-196224d4.js","./visualVariablesUtils-be80a4d1.js","./cimAnalyzer-1925a3d6.js","./fontUtils-36c927ab.js","./BidiEngine-9a40f2f4.js","./GeometryUtils-984e8446.js","./Rect-ea14f53a.js","./callExpressionWithFeature-2746b39a.js","./quantizationUtils-4d6bfb95.js","./floatRGBA-3a82b521.js","./ExpandedCIM-3803a601.js","./util-16ac108f.js","./BitmapTileContainer-ecdf3c86.js","./Bitmap-0c15cda6.js","./TileContainer-2082ecc6.js","./CircularArray-ef508845.js","./BufferPool-ac49ede8.js","./FeatureContainer-95df36a3.js","./popupUtils-dd683fba.js","./LayerView-849133df.js","./RefreshableLayerView-654bb099.js"],import.meta.url)),tile:M1,"vector-tile":()=>hn().then(()=>Y(()=>import("./VectorTileLayerView2D-c502d8ff.js"),["./VectorTileLayerView2D-c502d8ff.js","./enums-fb086c25.js","./Rect-ea14f53a.js","./enums-b14466b3.js","./Texture-6a4a9109.js","./pbf-984c4807.js","./rasterizingUtils-1dfc8831.js","./floatRGBA-3a82b521.js","./VertexArrayObject-c8e6ef22.js","./config-1337d16e.js","./TiledDisplayObject-d0b73ef5.js","./Container-0003cec6.js","./definitions-97fbc524.js","./StyleDefinition-29c49b98.js","./enums-f1a6a48a.js","./color-769a2896.js","./VertexElementDescriptor-2925c6af.js","./number-e491b09e.js","./TileContainer-2082ecc6.js","./WGLContainer-2cf6354a.js","./vec4f32-0d1b2306.js","./ProgramTemplate-d3ea1e61.js","./GeometryUtils-12600119.js","./alignmentUtils-ae955d28.js","./earcut-b7ad7453.js","./featureConversionUtils-7f0dd1f5.js","./OptimizedFeature-4701473b.js","./OptimizedFeatureSet-1d1ac4b9.js","./OptimizedGeometry-196224d4.js","./StyleRepository-47ab2876.js","./GeometryUtils-984e8446.js","./LayerView2D-88b65f45.js","./LayerView-849133df.js"],import.meta.url)),video:()=>hn().then(()=>Y(()=>import("./VideoLayerView2D-4eb330ec.js"),["./VideoLayerView2D-4eb330ec.js","./LayerView2D-88b65f45.js","./Container-0003cec6.js","./definitions-97fbc524.js","./enums-b14466b3.js","./Texture-6a4a9109.js","./LayerView-849133df.js"],import.meta.url)),wcs:()=>hn().then(()=>Y(()=>import("./ImageryTileLayerView2D-4da7cf29.js"),["./ImageryTileLayerView2D-4da7cf29.js","./RasterVFDisplayObject-3caba663.js","./VertexArrayObject-c8e6ef22.js","./Texture-6a4a9109.js","./enums-b14466b3.js","./VertexElementDescriptor-2925c6af.js","./WGLContainer-2cf6354a.js","./definitions-97fbc524.js","./vec4f32-0d1b2306.js","./color-769a2896.js","./enums-f1a6a48a.js","./number-e491b09e.js","./ProgramTemplate-d3ea1e61.js","./GeometryUtils-12600119.js","./alignmentUtils-ae955d28.js","./StyleDefinition-29c49b98.js","./config-1337d16e.js","./Container-0003cec6.js","./earcut-b7ad7453.js","./featureConversionUtils-7f0dd1f5.js","./OptimizedFeature-4701473b.js","./OptimizedFeatureSet-1d1ac4b9.js","./OptimizedGeometry-196224d4.js","./LayerView2D-88b65f45.js","./rasterUtils-85287595.js","./TiledDisplayObject-d0b73ef5.js","./TileContainer-2082ecc6.js","./util-16ac108f.js","./popupUtils-dd683fba.js","./LayerView-849133df.js","./RefreshableLayerView-654bb099.js"],import.meta.url)),"web-tile":M1,wfs:M0,wms:()=>hn().then(()=>Y(()=>import("./WMSLayerView2D-e5f24287.js"),["./WMSLayerView2D-e5f24287.js","./BitmapContainer-ab2a4062.js","./WGLContainer-2cf6354a.js","./definitions-97fbc524.js","./VertexArrayObject-c8e6ef22.js","./Texture-6a4a9109.js","./enums-b14466b3.js","./VertexElementDescriptor-2925c6af.js","./vec4f32-0d1b2306.js","./color-769a2896.js","./enums-f1a6a48a.js","./number-e491b09e.js","./ProgramTemplate-d3ea1e61.js","./GeometryUtils-12600119.js","./alignmentUtils-ae955d28.js","./StyleDefinition-29c49b98.js","./config-1337d16e.js","./Container-0003cec6.js","./earcut-b7ad7453.js","./featureConversionUtils-7f0dd1f5.js","./OptimizedFeature-4701473b.js","./OptimizedFeatureSet-1d1ac4b9.js","./OptimizedGeometry-196224d4.js","./LayerView2D-88b65f45.js","./ExportStrategy-d78af549.js","./Bitmap-0c15cda6.js","./LayerView-849133df.js","./RefreshableLayerView-654bb099.js","./ExportWMSImageParameters-2d356665.js"],import.meta.url)),wmts:()=>hn().then(()=>Y(()=>import("./WMTSLayerView2D-f84fe801.js"),["./WMTSLayerView2D-f84fe801.js","./imageUtils-120d028c.js","./BitmapTileContainer-ecdf3c86.js","./Bitmap-0c15cda6.js","./Container-0003cec6.js","./definitions-97fbc524.js","./enums-b14466b3.js","./Texture-6a4a9109.js","./TiledDisplayObject-d0b73ef5.js","./WGLContainer-2cf6354a.js","./VertexArrayObject-c8e6ef22.js","./VertexElementDescriptor-2925c6af.js","./vec4f32-0d1b2306.js","./color-769a2896.js","./enums-f1a6a48a.js","./number-e491b09e.js","./ProgramTemplate-d3ea1e61.js","./GeometryUtils-12600119.js","./alignmentUtils-ae955d28.js","./StyleDefinition-29c49b98.js","./config-1337d16e.js","./earcut-b7ad7453.js","./featureConversionUtils-7f0dd1f5.js","./OptimizedFeature-4701473b.js","./OptimizedFeatureSet-1d1ac4b9.js","./OptimizedGeometry-196224d4.js","./TileContainer-2082ecc6.js","./LayerView2D-88b65f45.js","./LayerView-849133df.js","./RefreshableLayerView-654bb099.js"],import.meta.url)),"line-of-sight":null,"base-elevation":null,"building-scene":null,dimension:null,elevation:null,"integrated-mesh":null,"point-cloud":null,voxel:null,scene:null,unknown:null,unsupported:null};function s$e(t){const e=t.declaredClass?t.declaredClass.slice(t.declaredClass.lastIndexOf(".")+1):"Unknown",i=e.replaceAll(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();return new V(`${i}:view-not-supported`,`${e} is not supported in 2D`)}const I7={hasLayerViewModule:t=>T7[t.type]!=null,importLayerView:t=>{const e=T7[t.type];if(e==null)throw s$e(t);return e(t)}};function o$e(t,e){const{spatialReference:i}=e,n=[e.x,e.y];let r=Number.POSITIVE_INFINITY,s=0,o=0;const a=[0,0],l=t.type==="extent"?[[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]]:t.rings;for(const c of l)for(let u=0;u<c.length-1;u++){H1e(a,n,c,u);const d=Xf(n,a);d<r&&(r=d,s=a[0],o=a[1])}return{coordinate:new pe({x:s,y:o,spatialReference:i}),distance:r}}var wD;let Wg=wD=class extends L6(ye){constructor(t){super(t),this.geometry=null,this.spatialReference=null}get normalizedGeometry(){if(this.geometry==null||!this.spatialReference)return null;if(!this.spatialReference.equals(this.geometry.spatialReference))try{return an(this.geometry,this.spatialReference)}catch(t){return ne.getLogger(this).error("#constraints.geometry","could not project the geometry to the view's spatial reference",{geometry:this.geometry,spatialReference:this.spatialReference,error:t}),null}return this.geometry}constrain(t,e){if(this.normalizedGeometry==null)return t;const i=t.targetGeometry;if(this.normalizedGeometry.type==="extent"?rP(this.normalizedGeometry,i):RQ(this.normalizedGeometry,i))return t;const{coordinate:n}=o$e(this.normalizedGeometry,i);return n&&(t.targetGeometry=n),t}clone(){var t,e;return new wD({geometry:(t=this.geometry)==null?void 0:t.clone(),spatialReference:(e=this.spatialReference)==null?void 0:e.clone()})}};h([p({constructOnly:!0})],Wg.prototype,"geometry",void 0),h([p({readOnly:!0})],Wg.prototype,"normalizedGeometry",null),h([p({constructOnly:!0})],Wg.prototype,"spatialReference",void 0),Wg=wD=h([P("esri.views.2d.constraints.GeometryConstraint")],Wg);var xD;let Vw=xD=class extends L6(ye){constructor(){super(...arguments),this.enabled=!0,this.rotationEnabled=!0}constrain(t,e){return this.enabled&&e&&(this.rotationEnabled||(t.rotation=e.rotation)),t}clone(){return new xD({enabled:this.enabled,rotationEnabled:this.rotationEnabled})}};h([p()],Vw.prototype,"enabled",void 0),h([p()],Vw.prototype,"rotationEnabled",void 0),Vw=xD=h([P("esri.views.2d.constraints.RotationConstraint")],Vw);const ese=Vw;var SD;let vo=SD=class extends L6(ye){constructor(t){super(t),this._lodByScale={},this._scales=[],this.effectiveLODs=null,this.effectiveMinZoom=-1,this.effectiveMaxZoom=-1,this.effectiveMinScale=0,this.effectiveMaxScale=0,this.lods=null,this.minZoom=-1,this.maxZoom=-1,this.minScale=0,this.maxScale=0,this.snapToZoom=!0}initialize(){let t,{lods:e,minScale:i,maxScale:n,minZoom:r,maxZoom:s}=this,o=-1,a=-1,l=!1,c=!1;if(i!==0&&n!==0&&i<n&&([i,n]=[n,i]),!e||!e.length)return this._set("effectiveMinScale",i),void this._set("effectiveMaxScale",n);e=e.map(u=>u.clone()),e.sort((u,d)=>d.scale-u.scale),e.forEach((u,d)=>u.level=d);for(const u of e)!l&&i>0&&i>=u.scale&&(o=u.level,l=!0),!c&&n>0&&n>=u.scale&&(a=t?t.level:-1,c=!0),t=u;r===-1&&(r=i===0?0:o),s===-1&&(s=n===0?e.length-1:a),r=Math.max(r,0),r=Math.min(r,e.length-1),s=Math.max(s,0),s=Math.min(s,e.length-1),r>s&&([r,s]=[s,r]),i=e[r].scale,n=e[s].scale,e.splice(0,r),e.splice(s-r+1,e.length),e.forEach((u,d)=>{this._lodByScale[u.scale]=u,this._scales[d]=u.scale}),this._set("effectiveLODs",e),this._set("effectiveMinZoom",r),this._set("effectiveMaxZoom",s),this._set("effectiveMinScale",i),this._set("effectiveMaxScale",n)}constrain(t,e){if(e&&t.scale===e.scale)return t;const i=this.effectiveMinScale,n=this.effectiveMaxScale,r=t.targetGeometry,s=e&&e.targetGeometry,o=n!==0&&t.scale<n,a=i!==0&&t.scale>i;if(o||a){const l=a?i:n;if(e&&s){const c=(l-e.scale)/(t.scale-e.scale);r.x=s.x+(r.x-s.x)*c,r.y=s.y+(r.y-s.y)*c}t.scale=l}return this.snapToZoom&&this.effectiveLODs&&(t.scale=this._getClosestScale(t.scale)),t}fit(t){if(!this.effectiveLODs||!this.snapToZoom)return this.constrain(t,null);const e=this.scaleToZoom(t.scale),i=Math.abs(e-Math.floor(e));return t.scale=this.zoomToScale(i>.99?Math.round(e):Math.floor(e)),t}zoomToScale(t){if(!this.effectiveLODs)return 0;t-=this.effectiveMinZoom,t=Math.max(0,t);const e=this._scales;if(t<=0)return e[0];if(t>=e.length)return e[e.length-1];const i=Math.round(t-.5),n=Math.round(t);return e[n]+(n-t)*(e[i]-e[n])}scaleToZoom(t){if(!this.effectiveLODs)return-1;const e=this._scales;let i,n;if(t>=e[0])return this.effectiveMinZoom;if(t<=e[e.length-1])return this.effectiveMaxZoom;for(let r=0;r<e.length-1;r++){if(i=e[r],n=e[r+1],n===t)return r+this.effectiveMinZoom+1;if(i>t&&n<t)return r+this.effectiveMinZoom+1-(t-n)/(i-n)}return-1}snapToClosestScale(t){if(!this.effectiveLODs)return t;const e=this.scaleToZoom(t);return this.zoomToScale(Math.round(e))}snapToNextScale(t,e=.5){if(!this.effectiveLODs)return t*e;const i=Math.round(this.scaleToZoom(t));return this.zoomToScale(i+1)}snapToPreviousScale(t,e=2){if(!this.effectiveLODs)return t*e;const i=Math.round(this.scaleToZoom(t));return this.zoomToScale(i-1)}clone(){return new SD({lods:this.lods,minZoom:this.minZoom,maxZoom:this.maxZoom,minScale:this.minScale,maxScale:this.maxScale})}_getClosestScale(t){return this._lodByScale[t]||(t=this._scales.reduce((e,i)=>Math.abs(i-t)<=Math.abs(e-t)?i:e,this._scales[0])),this._lodByScale[t].scale}};h([p({readOnly:!0})],vo.prototype,"effectiveLODs",void 0),h([p({readOnly:!0})],vo.prototype,"effectiveMinZoom",void 0),h([p({readOnly:!0})],vo.prototype,"effectiveMaxZoom",void 0),h([p({readOnly:!0})],vo.prototype,"effectiveMinScale",void 0),h([p({readOnly:!0})],vo.prototype,"effectiveMaxScale",void 0),h([p()],vo.prototype,"lods",void 0),h([p()],vo.prototype,"minZoom",void 0),h([p()],vo.prototype,"maxZoom",void 0),h([p()],vo.prototype,"minScale",void 0),h([p()],vo.prototype,"maxScale",void 0),h([p()],vo.prototype,"snapToZoom",void 0),vo=SD=h([P("esri.views.2d.constraints.ZoomConstraint")],vo);const tse=vo,a$e={base:null,key:"type",typeMap:{extent:Le,polygon:Vr}};let vn=class extends ye{constructor(e){super(e),this.lods=null,this.minScale=0,this.maxScale=0,this.minZoom=-1,this.maxZoom=-1,this.rotationEnabled=!0,this.snapToZoom=!0,this.customConstraints=new xe}destroy(){this.view=null}get effectiveLODs(){return this._zoom.effectiveLODs}get effectiveMinScale(){return this._zoom.effectiveMinScale}get effectiveMaxScale(){return this._zoom.effectiveMaxScale}get effectiveMinZoom(){return this._zoom.effectiveMinZoom}get effectiveMaxZoom(){return this._zoom.effectiveMaxZoom}set geometry(e){e?this._set("geometry",e):this._set("geometry",null)}get version(){var e,i,n;return`${(e=this._zoom)==null?void 0:e.uid}/${(i=this._rotation)==null?void 0:i.uid}/${(n=this._geometry)==null?void 0:n.uid}`}get _geometry(){var i,n;const e=this._get("_geometry");return e&&this.geometry===e.geometry&&((i=this.view)==null?void 0:i.constraintsInfo.spatialReference)===e.spatialReference?e:new Wg({geometry:this.geometry,spatialReference:(n=this.view)==null?void 0:n.constraintsInfo.spatialReference})}get _rotation(){return new ese({rotationEnabled:this.rotationEnabled})}get _zoom(){var l;const e=this._get("_zoom"),i=this.lods||((l=this.view)==null?void 0:l.constraintsInfo.lods),n=this.minZoom,r=this.maxZoom,s=this.minScale,o=this.maxScale,a=this.snapToZoom;return e&&e.lods===i&&e.minZoom===n&&e.maxZoom===r&&e.minScale===s&&e.maxScale===o&&e.snapToZoom===a?e:new tse({lods:i,minZoom:n,maxZoom:r,minScale:s,maxScale:o,snapToZoom:a})}canZoomInTo(e){const i=this.effectiveMaxScale;return i===0||e>=i}canZoomOutTo(e){const i=this.effectiveMinScale;return i===0||e<=i}constrain(e,i){return this._zoom.constrain(e,i),this._rotation.constrain(e,i),this._geometry.constrain(e,i),this.customConstraints.forEach(n=>n.constrain(e,i)),e}constrainByGeometry(e){return this._geometry.constrain(e)}fit(e){return this._zoom.fit(e)}zoomToScale(e){return this._zoom.zoomToScale(e)}scaleToZoom(e){return this._zoom.scaleToZoom(e)}snapScale(e){return this._zoom.snapToClosestScale(e)}snapToNextScale(e){return this._zoom.snapToNextScale(e)}snapToPreviousScale(e){return this._zoom.snapToPreviousScale(e)}};h([p({readOnly:!0})],vn.prototype,"effectiveLODs",null),h([p({readOnly:!0})],vn.prototype,"effectiveMinScale",null),h([p({readOnly:!0})],vn.prototype,"effectiveMaxScale",null),h([p({readOnly:!0})],vn.prototype,"effectiveMinZoom",null),h([p({readOnly:!0})],vn.prototype,"effectiveMaxZoom",null),h([p({types:a$e,value:null})],vn.prototype,"geometry",null),h([p({type:[pu]})],vn.prototype,"lods",void 0),h([p()],vn.prototype,"minScale",void 0),h([p()],vn.prototype,"maxScale",void 0),h([p()],vn.prototype,"minZoom",void 0),h([p()],vn.prototype,"maxZoom",void 0),h([p()],vn.prototype,"rotationEnabled",void 0),h([p()],vn.prototype,"snapToZoom",void 0),h([p({type:xe})],vn.prototype,"customConstraints",void 0),h([p()],vn.prototype,"view",void 0),h([p({readOnly:!0})],vn.prototype,"version",null),h([p({type:Wg,readOnly:!0})],vn.prototype,"_geometry",null),h([p({type:ese})],vn.prototype,"_rotation",null),h([p({readOnly:!0,type:tse})],vn.prototype,"_zoom",null),vn=h([P("esri.views.2d.MapViewConstraints")],vn);const ise=vn;let l$e=class{constructor(e,i){this.item=e,this.controller=i,this.promise=null}},DV=class{constructor(e){this._deferreds=new Map,this._controllers=new Map,this._processingItems=new Map,this._isPaused=!1,this._schedule=null,this._task=null,this.concurrency=1,e.concurrency&&(this.concurrency=e.concurrency),this._queue=new hA(e.peeker),this.process=e.process;const i=e.scheduler;e.priority&&i&&(this._task=i.registerTask(e.priority,this))}destroy(){this.clear(),this._schedule=Ri(this._schedule),this._task=Ri(this._task)}get length(){return this._processingItems.size+this._queue.length}abort(e){const i=this._controllers.get(e);i&&i.abort()}clear(){this._queue.clear();const e=[];this._controllers.forEach(i=>e.push(i)),this._controllers.clear(),e.forEach(i=>i.abort()),this._processingItems.clear(),this._cancelNext()}forEach(e){this._deferreds.forEach((i,n)=>e(n))}get(e){const i=this._deferreds.get(e);return i?i.promise:void 0}isOngoing(e){return this._processingItems.has(e)}has(e){return this._deferreds.has(e)}pause(){this._isPaused||(this._isPaused=!0,this._cancelNext())}push(e,i){const n=this.get(e);if(n)return n;const r=new AbortController;let s=null;i&&(s=Ro(i,()=>r.abort()));const o=()=>{const u=this._processingItems.get(e);u&&u.controller.abort(),a(),c.reject(li())},a=()=>{l.remove(),s!=null&&s.remove(),this._deferreds.delete(e),this._controllers.delete(e),this._queue.remove(e),this._processingItems.delete(e),this._scheduleNext()},l=zz(r.signal,o),c=xc();return this._deferreds.set(e,c),this._controllers.set(e,r),c.promise.then(a,a),this._queue.push(e),this._scheduleNext(),c.promise}last(){return this._queue.last()}peek(){return this._queue.peek()}popLast(){return this._queue.popLast()}reset(){const e=[];this._processingItems.forEach(i=>e.push(i)),this._processingItems.clear();for(const i of e)this._queue.push(i.item),i.controller.abort();this._scheduleNext()}resume(){this._isPaused&&(this._isPaused=!1,this._scheduleNext())}takeAll(){const e=[];for(;this._queue.length;)e.push(this._queue.pop());return this.clear(),e}get running(){return!this._isPaused&&this._queue.length>0&&this._processingItems.size<this.concurrency}runTask(e){for(;!e.done&&this._queue.length>0&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop()),e.madeProgress()}_scheduleNext(){this._task||this._isPaused||this._schedule||(this._schedule=kb(()=>{this._schedule=null,this._next()}))}_next(){for(;this._queue.length>0&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop())}_cancelNext(){this._schedule&&(this._schedule.remove(),this._schedule=null)}_processResult(e,i){this._canProcessFulfillment(e)&&(this._scheduleNext(),this._deferreds.get(e.item).resolve(i))}_processError(e,i){this._canProcessFulfillment(e)&&(this._scheduleNext(),this._deferreds.get(e.item).reject(i))}_canProcessFulfillment(e){return!!this._deferreds.get(e.item)&&this._processingItems.get(e.item)===e}_process(e){if(e==null)return;let i;const n=new AbortController,r=new l$e(e,n);this._processingItems.set(e,r);try{i=this.process(e,n.signal)}catch(s){this._processError(r,s)}fd(i)?(r.promise=i,i.then(s=>this._processResult(r,s),s=>this._processError(r,s))):this._processResult(r,i)}get test(){return{update:e=>this.runTask(e)}}};function c$e(t,e){return t.length=0,e.forEach(i=>t.push(i)),t}const V3=new Set,dI=[],E0=new Map,C7=[0,0];let Fd=class extends ye{constructor(e){super(e),this._keyToItem=new Map,this.concurrency=6,this.strategy="scale-first",this.tileInfoView=null}initialize(){const{concurrency:e,process:i}=this;this._queue=new DV({concurrency:e,process:(n,r)=>{const s=this._keyToItem.get(n);return i(s,{signal:r})},peeker:n=>n.values().next().value})}destroy(){this.clear(),this._queue=Je(this._queue)}get length(){return this._queue?this._queue.length:0}get onGoingCount(){return this._keyToItem.size}get updating(){return this.length>0||this.onGoingCount>0}abort(e){const i=typeof e=="string"?e:e.id;this._queue.abort(i)}clear(){this._queue.clear(),this._keyToItem.clear(),this.notifyChange("updating")}has(e){return typeof e=="string"?this._keyToItem.has(e):this._keyToItem.has(e.id)}isOngoing(e){const i=typeof e=="string"?e:e.id;return this.has(i)&&this._queue.isOngoing(i)}pause(){this._queue.pause()}push(e,i){const n=e.key.id+"-"+i;if(this.has(n))return this.get(n);const r=this._queue.push(n),s=()=>{this._keyToItem.delete(n),this.notifyChange("updating")};return this._keyToItem.set(n,e),r.then(s,s),this.notifyChange("updating"),r}reset(){this._queue.reset(),this.notifyChange("updating")}resume(){this._queue.resume()}_peekByScaleFirst(e){if(!this.state)return e.values().next().value;const i=this.tileInfoView;let n=Number.NEGATIVE_INFINITY,r=Number.POSITIVE_INFINITY;e.forEach(u=>{const d=this._keyToItem.get(u),f=this.tileInfoView.getTileScale(d.key);E0.has(f)||(E0.set(f,[]),n=Math.max(f,n),r=Math.min(f,r)),E0.get(f).push(d.key),V3.add(f)});let s=this.state.scale;E0.has(s)||(c$e(dI,V3),dI.sort((u,d)=>u-d),s=dI.reduce((u,d)=>Math.abs(d-s)<Math.abs(u-s)?d:u,dI[0])),s=Math.min(s,n),s=Math.max(s,r);const o=E0.get(s),a=i.getClosestInfoForScale(s),l=a.getColumnForX(this.state.center[0]),c=a.getRowForY(this.state.center[1]);return o.sort((u,d)=>{const f=a.denormalizeCol(u.col,u.world),m=a.denormalizeCol(d.col,d.world);return Math.sqrt((l-f)*(l-f)+(c-u.row)*(c-u.row))-Math.sqrt((l-m)*(l-m)+(c-d.row)*(c-d.row))}),V3.clear(),E0.clear(),o[0].id}_peekByCenterFirst(e){if(!this.state)return e.values().next().value;const i=this.tileInfoView,n=this.state.center;let r,s=Number.POSITIVE_INFINITY;return e.forEach(o=>{const a=this._keyToItem.get(o);i.getTileCoords(C7,a.key);const l=Xf(C7,n);l<s&&(s=l,r=a.key)}),r.id}};h([p({constructOnly:!0})],Fd.prototype,"concurrency",void 0),h([p({constructOnly:!0})],Fd.prototype,"process",void 0),h([p()],Fd.prototype,"state",void 0),h([p({constructOnly:!0})],Fd.prototype,"strategy",void 0),h([p({constructOnly:!0})],Fd.prototype,"tileInfoView",void 0),h([p({readOnly:!0})],Fd.prototype,"updating",null),Fd=h([P("esri.views.2d.tiling.PagedTileQueue")],Fd);let jy=class Zm{static getId(e,i,n,r){return typeof e=="object"?`${e.level}/${e.row}/${e.col}/${e.world}`:`${e}/${i}/${n}/${r}`}constructor(e,i,n,r){this.set(e,i,n,r)}get key(){return this}get id(){return this.toString()}set id(e){this.set(e)}get hash(){const e=4095&this.row,i=4095&this.col,n=63&this.level;return(3&this.world)<<30|i<<22|e<<8|n}acquire(e,i,n,r){this.set(e,i,n,r)}contains(e){const i=e.level-this.level;return i>=0&&this.row===e.row>>i&&this.col===e.col>>i&&this.world===e.world}equals(e){return this.level===e.level&&this.row===e.row&&this.col===e.col&&this.world===e.world}clone(){return new Zm(this)}release(){this.level=0,this.row=0,this.col=0,this.world=0}set(e,i,n,r){if(e==null)this.level=0,this.row=0,this.col=0,this.world=0;else if(typeof e=="object")this.level=e.level||0,this.row=e.row||0,this.col=e.col||0,this.world=e.world||0;else if(typeof e=="string"){const[s,o,a,l]=e.split("/");this.level=parseFloat(s),this.row=parseFloat(o),this.col=parseFloat(a),this.world=parseFloat(l)}else this.level=+e,this.row=+i,this.col=+n,this.world=+r||0;return this}toString(){return`${this.level}/${this.row}/${this.col}/${this.world}`}getParentKey(){return this.level<=0?null:new Zm(this.level-1,this.row>>1,this.col>>1,this.world)}getChildKeys(){const e=this.level+1,i=this.row<<1,n=this.col<<1,r=this.world;return[new Zm(e,i,n,r),new Zm(e,i,n+1,r),new Zm(e,i+1,n,r),new Zm(e,i+1,n+1,r)]}compareRowMajor(e){return this.row<e.row?-1:this.row>e.row?1:this.col<e.col?-1:this.col>e.col?1:0}};jy.pool=new e0(jy,null,null,25,50);function zd(t,e){return[t,e]}function lm(t,e,i){return t[0]=e,t[1]=i,t}function u$e(t,e,i,n,r){return t[0]=e,t[1]=i,t[2]=n,t[3]=r,t}const Pl=new jy("0/0/0/0");let h$e=class nse{static create(e,i,n=null){const r=to(e.spatialReference),s=i.origin||zd(e.origin.x,e.origin.y),o=zd(e.size[0]*i.resolution,e.size[1]*i.resolution),a=zd(-1/0,-1/0),l=zd(1/0,1/0),c=zd(1/0,1/0);n!=null&&(lm(a,Math.max(0,Math.floor((n.xmin-s[0])/o[0])),Math.max(0,Math.floor((s[1]-n.ymax)/o[1]))),lm(l,Math.max(0,Math.floor((n.xmax-s[0])/o[0])),Math.max(0,Math.floor((s[1]-n.ymin)/o[1]))),lm(c,l[0]-a[0]+1,l[1]-a[1]+1));const{cols:u,rows:d}=i;let f,m,g,y;return!n&&u&&d&&(lm(a,u[0],d[0]),lm(l,u[1],d[1]),lm(c,u[1]-u[0]+1,d[1]-d[0]+1)),e.isWrappable?(f=zd(Math.ceil(Math.round((r.valid[1]-r.valid[0])/i.resolution)/e.size[0]),c[1]),m=zd(Math.floor((r.origin[0]-s[0])/o[0]),a[1]),g=zd(f[0]+m[0]-1,l[1]),y=!0):(m=a,g=l,f=c,y=!1),new nse(i.level,i.resolution,i.scale,s,a,l,c,o,m,g,f,y)}constructor(e,i,n,r,s,o,a,l,c,u,d,f){this.level=e,this.resolution=i,this.scale=n,this.origin=r,this.first=s,this.last=o,this.size=a,this.norm=l,this.worldStart=c,this.worldEnd=u,this.worldSize=d,this.wrap=f}normalizeCol(e){if(!this.wrap)return e;const i=this.worldSize[0];return e<0?i-1-Math.abs((e+1)%i):e%i}denormalizeCol(e,i){return this.wrap?this.worldSize[0]*i+e:e}getWorldForColumn(e){return this.wrap?Math.floor(e/this.worldSize[0]):0}getFirstColumnForWorld(e){return e*this.worldSize[0]+this.first[0]}getLastColumnForWorld(e){return e*this.worldSize[0]+this.first[0]+this.size[0]-1}getColumnForX(e){return(e-this.origin[0])/this.norm[0]}getXForColumn(e){return this.origin[0]+e*this.norm[0]}getRowForY(e){return(this.origin[1]-e)/this.norm[1]}getYForRow(e){return this.origin[1]-e*this.norm[1]}getTileBounds(e,i,n=!1){Pl.set(i);const r=n?Pl.col:this.denormalizeCol(Pl.col,Pl.world),s=Pl.row;return u$e(e,this.getXForColumn(r),this.getYForRow(s+1),this.getXForColumn(r+1),this.getYForRow(s)),e}getTileCoords(e,i,n=!1){Pl.set(i);const r=n?Pl.col:this.denormalizeCol(Pl.col,Pl.world);return Array.isArray(e)?lm(e,this.getXForColumn(r),this.getYForRow(Pl.row)):(e.x=this.getXForColumn(r),e.y=this.getYForRow(Pl.row)),e}},Z2=class{constructor(){this.spans=[]}acquire(e){this.lodInfo=e}release(){this.lodInfo=null,this.spans.length=0}forEach(e,i){const{spans:n,lodInfo:r}=this,{level:s}=r;if(n.length!==0)for(const{row:o,colFrom:a,colTo:l}of n)for(let c=a;c<=l;c++)e.call(i,s,o,r.normalizeCol(c),r.getWorldForColumn(c))}};Z2.pool=new e0(Z2);let j3=class{constructor(e,i,n){this.row=e,this.colFrom=i,this.colTo=n}};const Fi=new jy("0/0/0/0");let d$e=class rse{static create(e,i){e[1]>i[1]&&([e,i]=[i,e]);const[n,r]=e,[s,o]=i,a=s-n,l=o-r,c=l!==0?a/l:0,u=(Math.ceil(r)-r)*c,d=(Math.floor(r)-r)*c;return new rse(n,Math.floor(r),Math.ceil(o),c,a<0?u:d,a<0?d:u,a<0?s:n,a<0?n:s)}constructor(e,i,n,r,s,o,a,l){this.x=e,this.ymin=i,this.ymax=n,this.invM=r,this.leftAdjust=s,this.rightAdjust=o,this.leftBound=a,this.rightBound=l}incrRow(){this.x+=this.invM}getLeftCol(){return Math.max(this.x+this.leftAdjust,this.leftBound)}getRightCol(){return Math.min(this.x+this.rightAdjust,this.rightBound)}};const qo=[[0,0],[0,0],[0,0],[0,0]],p$e=1e-6;let f$e=class{constructor(e,i=null,n=e.lods[0].level,r=e.lods[e.lods.length-1].level){this.tileInfo=e,this.fullExtent=i,this.scales=[],this._infoByScale={},this._infoByLevel={};const s=e.lods.filter(a=>a.level>=n&&a.level<=r);this.minScale=s[0].scale,this.maxScale=s[s.length-1].scale;const o=this._lodInfos=s.map(a=>h$e.create(e,a,i));s.forEach((a,l)=>{this._infoByLevel[a.level]=o[l],this._infoByScale[a.scale]=o[l],this.scales[l]=a.scale},this),this._wrap=e.isWrappable}get spatialReference(){return this.tileInfo.spatialReference}getLODInfoAt(e){return this._infoByLevel[typeof e=="number"?e:e.level]}getTileBounds(e,i,n=!1){Fi.set(i);const r=this._infoByLevel[Fi.level];return r?r.getTileBounds(e,Fi,n):e}getTileCoords(e,i,n=!1){Fi.set(i);const r=this._infoByLevel[Fi.level];return r?r.getTileCoords(e,Fi,n):e}getTileCoverage(e,i=192,n=!0,r="closest"){if(!n&&(e.scale>this.minScale||e.scale<this.maxScale))return null;const s=r==="closest"?this.getClosestInfoForScale(e.scale):this.getSmallestInfoForScale(e.scale),o=Z2.pool.acquire(s),a=this._wrap;let l,c,u,d=1/0,f=-1/0;const m=o.spans;qo[0][0]=qo[0][1]=qo[1][1]=qo[3][0]=-i,qo[1][0]=qo[2][0]=e.size[0]+i,qo[2][1]=qo[3][1]=e.size[1]+i;for(const b of qo)e.toMap(b,b),b[0]=s.getColumnForX(b[0]),b[1]=s.getRowForY(b[1]);const g=[];let y=3;for(let b=0;b<4;b++){if(qo[b][1]===qo[y][1]){y=b;continue}const w=d$e.create(qo[b],qo[y]);d=Math.min(w.ymin,d),f=Math.max(w.ymax,f),g[w.ymin]===void 0&&(g[w.ymin]=[]),g[w.ymin].push(w),y=b}if(d==null||f==null||f-d>100)return null;let _=[];for(l=d;l<f;){g[l]!=null&&(_=_.concat(g[l])),c=1/0,u=-1/0;for(let b=_.length-1;b>=0;b--){const w=_[b];c=Math.min(c,w.getLeftCol()),u=Math.max(u,w.getRightCol())}if(c=Math.floor(c),u=Math.floor(u),l>=s.first[1]&&l<=s.last[1])if(a)if(s.size[0]<s.worldSize[0]){const b=Math.floor(u/s.worldSize[0]);for(let w=Math.floor(c/s.worldSize[0]);w<=b;w++)m.push(new j3(l,Math.max(s.getFirstColumnForWorld(w),c),Math.min(s.getLastColumnForWorld(w),u)))}else m.push(new j3(l,c,u));else c>s.last[0]||u<s.first[0]||(c=Math.max(c,s.first[0]),u=Math.min(u,s.last[0]),m.push(new j3(l,c,u)));l+=1;for(let b=_.length-1;b>=0;b--){const w=_[b];w.ymax>=l?w.incrRow():_.splice(b,1)}}return o}getTileParentId(e){Fi.set(e);const i=this._infoByLevel[Fi.level],n=this._lodInfos.indexOf(i)-1;return n<0?null:(this._getTileIdAtLOD(Fi,this._lodInfos[n],Fi),Fi.id)}getTileResolution(e){const i=this._infoByLevel[typeof e=="object"?e.level:e];return i?i.resolution:-1}getTileScale(e){const i=this._infoByLevel[e.level];return i?i.scale:-1}intersects(e,i){Fi.set(i);const n=this._infoByLevel[Fi.level],r=e.lodInfo;if(r.resolution>n.resolution){this._getTileIdAtLOD(Fi,r,Fi);const o=r.denormalizeCol(Fi.col,Fi.world);for(const a of e.spans)if(a.row===Fi.row&&a.colFrom<=o&&a.colTo>=o)return!0}if(r.resolution<n.resolution){const[o,a,l,c]=e.spans.reduce((y,_)=>(y[0]=Math.min(y[0],_.row),y[1]=Math.max(y[1],_.row),y[2]=Math.min(y[2],_.colFrom),y[3]=Math.max(y[3],_.colTo),y),[1/0,-1/0,1/0,-1/0]),u=n.denormalizeCol(Fi.col,Fi.world),d=r.getColumnForX(n.getXForColumn(u)),f=r.getRowForY(n.getYForRow(Fi.row)),m=r.getColumnForX(n.getXForColumn(u+1))-1,g=r.getRowForY(n.getYForRow(Fi.row+1))-1;return!(d>c||m<l||f>a||g<o)}const s=r.denormalizeCol(Fi.col,Fi.world);return e.spans.some(o=>o.row===Fi.row&&o.colFrom<=s&&o.colTo>=s)}normalizeBounds(e,i,n){if(e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],this._wrap){const r=to(this.tileInfo.spatialReference),s=-n*(r.valid[1]-r.valid[0]);e[0]+=s,e[2]+=s}return e}getSmallestInfoForScale(e){const i=this.scales;if(this._infoByScale[e])return this._infoByScale[e];if(e>i[0])return this._infoByScale[i[0]];for(let n=1;n<i.length-1;n++)if(e>i[n]+p$e)return this._infoByScale[i[n-1]];return this._infoByScale[i[i.length-1]]}getClosestInfoForScale(e){const i=this.scales;return this._infoByScale[e]||(e=i.reduce((n,r)=>Math.abs(r-e)<Math.abs(n-e)?r:n,i[0])),this._infoByScale[e]}scaleToLevel(e){const i=this.scales;if(this._infoByScale[e])return this._infoByScale[e].level;for(let n=i.length-1;n>=0;n--)if(e<i[n])return n===i.length-1?this._infoByScale[i[i.length-1]].level:this._infoByScale[i[n]].level+(i[n]-e)/(i[n]-i[n+1]);return this._infoByScale[i[0]].level}scaleToZoom(e){return this.tileInfo.scaleToZoom(e)}_getTileIdAtLOD(e,i,n){const r=this._infoByLevel[n.level];return e.set(n),i.resolution<r.resolution?null:(i.resolution===r.resolution||(e.level=i.level,e.col=Math.floor(n.col*r.resolution/i.resolution+.01),e.row=Math.floor(n.row*r.resolution/i.resolution+.01)),e)}};function m$e(t,e){return t.length=0,e.forEach(i=>t.push(i)),t}const B3=new Set,pI=[],A0=new Map,M7=[0,0];let uh=class extends ye{constructor(e){super(e),this._keyToItem=new Map,this.concurrency=6,this.strategy="scale-first",this.tileInfoView=null}initialize(){const{concurrency:e,process:i,strategy:n}=this;this._queue=new DV({concurrency:e,process:(r,s)=>{const o=this._keyToItem.get(r);return i(o,{signal:s})},peeker:n==="scale-first"?r=>this._peekByScaleFirst(r):r=>this._peekByCenterFirst(r)})}destroy(){this.clear(),this._queue=Je(this._queue)}get length(){return this._queue?this._queue.length:0}get onGoingCount(){return this._keyToItem.size}get updating(){return this.length>0||this.onGoingCount>0}abort(e){const i=typeof e=="string"?e:e.id;this._queue.abort(i)}clear(){this._queue.clear(),this._keyToItem.clear(),this.notifyChange("updating")}has(e){return typeof e=="string"?this._keyToItem.has(e):this._keyToItem.has(e.id)}isOngoing(e){const i=typeof e=="string"?e:e.id;return this.has(i)&&this._queue.isOngoing(i)}pause(){this._queue.pause()}push(e){const i=e.key.id;if(this._queue.has(i))return this._queue.get(i);const n=this._queue.push(i),r=()=>{this._keyToItem.delete(i),this.notifyChange("updating")};return this._keyToItem.set(i,e),n.then(r,r),this.notifyChange("updating"),n}reset(){this._queue.reset()}resume(){this._queue.resume()}_peekByScaleFirst(e){if(!this.state)return e.values().next().value;const i=this.tileInfoView;let n=Number.NEGATIVE_INFINITY,r=Number.POSITIVE_INFINITY;e.forEach(u=>{const d=this._keyToItem.get(u),f=this.tileInfoView.getTileScale(d.key);A0.has(f)||(A0.set(f,[]),n=Math.max(f,n),r=Math.min(f,r)),A0.get(f).push(d.key),B3.add(f)});let s=this.state.scale;A0.has(s)||(m$e(pI,B3),pI.sort((u,d)=>u-d),s=pI.reduce((u,d)=>Math.abs(d-s)<Math.abs(u-s)?d:u,pI[0])),s=Math.min(s,n),s=Math.max(s,r);const o=A0.get(s),a=i.getClosestInfoForScale(s),l=a.getColumnForX(this.state.center[0]),c=a.getRowForY(this.state.center[1]);return o.sort((u,d)=>{const f=a.denormalizeCol(u.col,u.world),m=a.denormalizeCol(d.col,d.world);return Math.sqrt((l-f)*(l-f)+(c-u.row)*(c-u.row))-Math.sqrt((l-m)*(l-m)+(c-d.row)*(c-d.row))}),B3.clear(),A0.clear(),o[0].id}_peekByCenterFirst(e){if(!this.state)return e.values().next().value;const i=this.tileInfoView,n=this.state.center;let r,s=Number.POSITIVE_INFINITY;return e.forEach(o=>{const a=this._keyToItem.get(o);i.getTileCoords(M7,a.key);const l=Xf(M7,n);l<s&&(s=l,r=a.key)}),r.id}};h([p({constructOnly:!0})],uh.prototype,"concurrency",void 0),h([p({constructOnly:!0})],uh.prototype,"process",void 0),h([p()],uh.prototype,"state",void 0),h([p({constructOnly:!0})],uh.prototype,"strategy",void 0),h([p({constructOnly:!0})],uh.prototype,"tileInfoView",void 0),h([p({readOnly:!0})],uh.prototype,"updating",null),uh=h([P("esri.views.2d.tiling.TileQueue")],uh);const But=uh;let g$e=class{constructor(e,i,n){this.maxSize=e,this._tileInfoView=i,this._removedFunc=n,this._tilePerId=new Map,this._tileKeysPerLevel=[]}clear(){this._tilePerId.clear(),this._tileKeysPerLevel=[]}has(e){return this._tilePerId.has(e)}get(e){return this._tilePerId.get(e)}pop(e){const i=this._tilePerId.get(e);if(!i)return;const n=i.key.level,r=this._tileKeysPerLevel[n];E7(this._tilePerId,e);for(let s=0;s<r.length;s++)if(r[s].id===e){r.splice(s,1);break}return i.visible=!0,i}add(e){e.visible=!1;const i=e.key,n=i.id;if(this._tilePerId.has(n))return;this._tilePerId.set(n,e);const r=i.level;this._tileKeysPerLevel[r]||(this._tileKeysPerLevel[r]=[]),this._tileKeysPerLevel[r].push(i)}prune(e,i,n){let r=this._tilePerId.size;if(r<=this.maxSize)return;let s=this._tileKeysPerLevel.length-1;for(;r>this.maxSize&&s>=0;)s!==e&&(r=this._pruneAroundCenterTile(r,i,n,s)),s--;r>this.maxSize&&(r=this._pruneAroundCenterTile(r,i,n,e))}_pruneAroundCenterTile(e,i,n,r){const s=this._tileKeysPerLevel[r];if(!s||s.length===0)return e;const{size:o,origin:a}=this._tileInfoView.tileInfo,l=n*o[0],c=n*o[1],u=[0,0],d=[0,0];for(s.sort((f,m)=>(u[0]=a.x+l*(f.col+.5),u[1]=a.y-c*(f.row+.5),d[0]=a.x+l*(m.col+.5),d[1]=a.y-c*(m.row+.5),Ec(u,i)-Ec(d,i)));s.length>0;){const f=s.pop();if(this._removeTile(f.id),--e===this.maxSize)break}return e}_removeTile(e){const i=this._tilePerId.get(e);this._removedFunc&&i&&this._removedFunc(i),E7(this._tilePerId,e)}};function E7(t,e){t.delete(e)}const cm=new jy(0,0,0,0),Gu=new Map,um=[],U3=[];let Gut=class{constructor(e){this._previousScale=Number.POSITIVE_INFINITY,this.cachePolicy="keep",this.coveragePolicy="closest",this.resampling=!0,this.tileIndex=new Map,this.tiles=[],this.buffer=192,this.acquireTile=e.acquireTile,this.releaseTile=e.releaseTile,this.tileInfoView=e.tileInfoView,e.resampling!=null&&(this.resampling=e.resampling),e.cachePolicy&&(this.cachePolicy=e.cachePolicy),e.coveragePolicy&&(this.coveragePolicy=e.coveragePolicy),e.buffer!=null&&(this.buffer=e.buffer),e.cacheSize&&(this._tileCache=new g$e(e.cacheSize,this.tileInfoView,i=>{this.releaseTile(i)}))}destroy(){this.tileIndex.clear()}update(e){var b,w;const{resampling:i,tileIndex:n}=this,{scale:r,center:s,resolution:o}=e.state,{minScale:a,maxScale:l}=this.tileInfoView,c=!e.stationary&&r>this._previousScale;if(this._previousScale=r,!i&&(r>a||r<l))return this.tiles.length=0,void this.clear();const u=this.tileInfoView.getTileCoverage(e.state,this.buffer,this.resampling,this.coveragePolicy);if(!u)return this.tiles.length=0,void this.clear();const{spans:d,lodInfo:f}=u,{level:m}=f;this.tiles.length=0,n.forEach(x=>x.visible=!0);let g=0,y=0;if(d.length>0)for(const{row:x,colFrom:S,colTo:T}of d)for(let I=S;I<=T;I++){g++;const C=cm.set(m,x,f.normalizeCol(I),f.getWorldForColumn(I)).id;let M=n.get(C);if(M)M.isReady?(Gu.set(C,M),y++):c||this._addParentTile(C,Gu);else{if((b=this._tileCache)!=null&&b.has(C)){if(M=this._tileCache.pop(C),this.tileIndex.set(C,M),M.isReady){Gu.set(C,M),y++;continue}}else M=this.acquireTile(cm),this.tileIndex.set(C,M);c||this._addParentTile(C,Gu)}}const _=y===g;for(const[x,S]of n){if(Gu.has(x))continue;cm.set(x);const T=this.tileInfoView.intersects(u,cm),I=this.cachePolicy==="purge"?cm.level!==m:cm.level>m;!T||!c&&_?!I&&T||um.push(S):S.isReady?I&&this.cachePolicy==="purge"&&this._hasReadyAncestor(cm,m)?um.push(S):U3.push(S):I&&um.push(S)}for(const x of U3)x.isReady&&Gu.set(x.key.id,x);for(const x of um)this._tileCache?this._tileCache.add(x):this.releaseTile(x),n.delete(x.key.id);for(const x of Gu.values())this.tiles.push(x);for(const x of n.values())Gu.has(x.key.id)||(x.visible=!1);(w=this._tileCache)==null||w.prune(m,s,o),Z2.pool.release(u),U3.length=0,um.length=0,Gu.clear()}clear(){const{tileIndex:e}=this;for(const i of e.values())this.releaseTile(i);e.clear()}refresh(e){var i;for(const n of this.tileIndex.values())this.tiles.includes(n)?e(n):um.push(n);for(const n of um)this.releaseTile(n),this.tileIndex.delete(n.key.id);(i=this._tileCache)==null||i.clear()}updateCacheSize(e){this._tileCache&&(this._tileCache.maxSize=e)}_addParentTile(e,i){var s;let n=e,r=null;for(;n=this.tileInfoView.getTileParentId(n),n;)if(this.tileIndex.has(n)){if(r=this.tileIndex.get(n),r==null?void 0:r.isReady){i.has(r.key.id)||i.set(r.key.id,r);break}}else if((s=this._tileCache)!=null&&s.has(n)&&(r=this._tileCache.pop(n),this.tileIndex.set(n,r),r==null?void 0:r.isReady)){i.has(r.key.id)||i.set(r.key.id,r);break}}_hasReadyAncestor(e,i){const n=wa();this.tileInfoView.getTileBounds(n,e,!0);for(const r of this.tileIndex.values())if(r.isReady&&r.key.level>=i&&r.key.level<e.level){const s=wa();if(this.tileInfoView.getTileBounds(s,r.key,!0),AR(s,n))return!0}return!1}};function TA(){const t=new Float32Array(6);return t[0]=1,t[3]=1,t}function y$e(t){const e=new Float32Array(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function v$e(t,e,i,n,r,s){const o=new Float32Array(6);return o[0]=t,o[1]=e,o[2]=i,o[3]=n,o[4]=r,o[5]=s,o}function _$e(t,e){return new Float32Array(t,e,6)}function sse(t,e,i,n){const r=e[n],s=e[n+1];t[n]=i[0]*r+i[2]*s+i[4],t[n+1]=i[1]*r+i[3]*s+i[5]}function b$e(t,e,i,n=0,r=0,s=2){const o=r||e.length/s;for(let a=n;a<o;a++)sse(t,e,i,a*s)}Object.freeze(Object.defineProperty({__proto__:null,clone:y$e,create:TA,createView:_$e,fromValues:v$e,transform:sse,transformMany:b$e},Symbol.toStringTag,{value:"Module"}));function w$e(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function x$e(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function ose(t,e,i,n,r,s,o,a,l,c){return t[0]=e,t[1]=i,t[2]=n,t[3]=r,t[4]=s,t[5]=o,t[6]=a,t[7]=l,t[8]=c,t}function ase(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function S$e(t,e){if(t===e){const i=e[1],n=e[2],r=e[5];t[1]=e[3],t[2]=e[6],t[3]=i,t[5]=e[7],t[6]=n,t[7]=r}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function T$e(t,e){const i=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],d=u*o-a*c,f=-u*s+a*l,m=c*s-o*l;let g=i*d+n*f+r*m;return g?(g=1/g,t[0]=d*g,t[1]=(-u*n+r*c)*g,t[2]=(a*n-r*o)*g,t[3]=f*g,t[4]=(u*i-r*l)*g,t[5]=(-a*i+r*s)*g,t[6]=m*g,t[7]=(-c*i+n*l)*g,t[8]=(o*i-n*s)*g,t):null}function I$e(t,e){const i=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8];return t[0]=o*u-a*c,t[1]=r*c-n*u,t[2]=n*a-r*o,t[3]=a*l-s*u,t[4]=i*u-r*l,t[5]=r*s-i*a,t[6]=s*c-o*l,t[7]=n*l-i*c,t[8]=i*o-n*s,t}function C$e(t){const e=t[0],i=t[1],n=t[2],r=t[3],s=t[4],o=t[5],a=t[6],l=t[7],c=t[8];return e*(c*s-o*l)+i*(-c*r+o*a)+n*(l*r-s*a)}function NV(t,e,i){const n=e[0],r=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],d=e[8],f=i[0],m=i[1],g=i[2],y=i[3],_=i[4],b=i[5],w=i[6],x=i[7],S=i[8];return t[0]=f*n+m*o+g*c,t[1]=f*r+m*a+g*u,t[2]=f*s+m*l+g*d,t[3]=y*n+_*o+b*c,t[4]=y*r+_*a+b*u,t[5]=y*s+_*l+b*d,t[6]=w*n+x*o+S*c,t[7]=w*r+x*a+S*u,t[8]=w*s+x*l+S*d,t}function TD(t,e,i){const n=e[0],r=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],d=e[8],f=i[0],m=i[1];return t[0]=n,t[1]=r,t[2]=s,t[3]=o,t[4]=a,t[5]=l,t[6]=f*n+m*o+c,t[7]=f*r+m*a+u,t[8]=f*s+m*l+d,t}function lse(t,e,i){const n=e[0],r=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],d=e[8],f=Math.sin(i),m=Math.cos(i);return t[0]=m*n+f*o,t[1]=m*r+f*a,t[2]=m*s+f*l,t[3]=m*o-f*n,t[4]=m*a-f*r,t[5]=m*l-f*s,t[6]=c,t[7]=u,t[8]=d,t}function M$e(t,e,i){const n=i[0],r=i[1],s=i[2];return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=r*e[3],t[4]=r*e[4],t[5]=r*e[5],t[6]=s*e[6],t[7]=s*e[7],t[8]=s*e[8],t}function E$e(t,e,i){const n=i[0],r=i[1];return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=r*e[3],t[4]=r*e[4],t[5]=r*e[5],t}function A$e(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t}function $$e(t,e){const i=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=i,t[2]=0,t[3]=-i,t[4]=n,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function P$e(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function k$e(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t}function O$e(t,e){const i=e[0],n=e[1],r=e[2],s=e[3],o=i+i,a=n+n,l=r+r,c=i*o,u=n*o,d=n*a,f=r*o,m=r*a,g=r*l,y=s*o,_=s*a,b=s*l;return t[0]=1-d-g,t[3]=u-b,t[6]=f+_,t[1]=u+b,t[4]=1-c-g,t[7]=m-y,t[2]=f-_,t[5]=m+y,t[8]=1-c-d,t}function cse(t,e){const i=e[0],n=e[1],r=e[2],s=e[4],o=e[5],a=e[6],l=e[8],c=e[9],u=e[10],d=u*o-a*c,f=-u*s+a*l,m=c*s-o*l,g=i*d+n*f+r*m;if(!g)return null;const y=1/g;return t[0]=d*y,t[1]=(-u*n+r*c)*y,t[2]=(a*n-r*o)*y,t[3]=f*y,t[4]=(u*i-r*l)*y,t[5]=(-a*i+r*s)*y,t[6]=m*y,t[7]=(-c*i+n*l)*y,t[8]=(o*i-n*s)*y,t}function L$e(t,e){const i=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],d=e[9],f=e[10],m=e[11],g=e[12],y=e[13],_=e[14],b=e[15],w=i*a-n*o,x=i*l-r*o,S=i*c-s*o,T=n*l-r*a,I=n*c-s*a,C=r*c-s*l,M=u*y-d*g,E=u*_-f*g,A=u*b-m*g,$=d*_-f*y,L=d*b-m*y,D=f*b-m*_;let F=w*D-x*L+S*$+T*A-I*E+C*M;return F?(F=1/F,t[0]=(a*D-l*L+c*$)*F,t[1]=(l*A-o*D-c*E)*F,t[2]=(o*L-a*A+c*M)*F,t[3]=(r*L-n*D-s*$)*F,t[4]=(i*D-r*A+s*E)*F,t[5]=(n*A-i*L-s*M)*F,t[6]=(y*C-_*I+b*T)*F,t[7]=(_*S-g*C-b*x)*F,t[8]=(g*I-y*S+b*w)*F,t):null}function R$e(t,e,i){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/i,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function D$e(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function N$e(t){return Math.sqrt(t[0]**2+t[1]**2+t[2]**2+t[3]**2+t[4]**2+t[5]**2+t[6]**2+t[7]**2+t[8]**2)}function F$e(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t[4]=e[4]+i[4],t[5]=e[5]+i[5],t[6]=e[6]+i[6],t[7]=e[7]+i[7],t[8]=e[8]+i[8],t}function use(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t[4]=e[4]-i[4],t[5]=e[5]-i[5],t[6]=e[6]-i[6],t[7]=e[7]-i[7],t[8]=e[8]-i[8],t}function z$e(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*i,t}function V$e(t,e,i,n){return t[0]=e[0]+i[0]*n,t[1]=e[1]+i[1]*n,t[2]=e[2]+i[2]*n,t[3]=e[3]+i[3]*n,t[4]=e[4]+i[4]*n,t[5]=e[5]+i[5]*n,t[6]=e[6]+i[6]*n,t[7]=e[7]+i[7]*n,t[8]=e[8]+i[8]*n,t}function j$e(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]}function B$e(t,e){const i=t[0],n=t[1],r=t[2],s=t[3],o=t[4],a=t[5],l=t[6],c=t[7],u=t[8],d=e[0],f=e[1],m=e[2],g=e[3],y=e[4],_=e[5],b=e[6],w=e[7],x=e[8],S=so();return Math.abs(i-d)<=S*Math.max(1,Math.abs(i),Math.abs(d))&&Math.abs(n-f)<=S*Math.max(1,Math.abs(n),Math.abs(f))&&Math.abs(r-m)<=S*Math.max(1,Math.abs(r),Math.abs(m))&&Math.abs(s-g)<=S*Math.max(1,Math.abs(s),Math.abs(g))&&Math.abs(o-y)<=S*Math.max(1,Math.abs(o),Math.abs(y))&&Math.abs(a-_)<=S*Math.max(1,Math.abs(a),Math.abs(_))&&Math.abs(l-b)<=S*Math.max(1,Math.abs(l),Math.abs(b))&&Math.abs(c-w)<=S*Math.max(1,Math.abs(c),Math.abs(w))&&Math.abs(u-x)<=S*Math.max(1,Math.abs(u),Math.abs(x))}function U$e(t){const e=so(),i=t[0],n=t[1],r=t[2],s=t[3],o=t[4],a=t[5],l=t[6],c=t[7],u=t[8];return Math.abs(1-(i*i+s*s+l*l))<=e&&Math.abs(1-(n*n+o*o+c*c))<=e&&Math.abs(1-(r*r+a*a+u*u))<=e}const G$e=NV,H$e=use;Object.freeze(Object.defineProperty({__proto__:null,add:F$e,adjoint:I$e,copy:x$e,determinant:C$e,equals:B$e,exactEquals:j$e,frob:N$e,fromMat2d:k$e,fromMat4:w$e,fromQuat:O$e,fromRotation:$$e,fromScaling:P$e,fromTranslation:A$e,identity:ase,invert:T$e,isOrthoNormal:U$e,mul:G$e,multiply:NV,multiplyScalar:z$e,multiplyScalarAndAdd:V$e,normalFromMat4:L$e,normalFromMat4Legacy:cse,projection:R$e,rotate:lse,scale:M$e,scaleByVec2:E$e,set:ose,str:D$e,sub:H$e,subtract:use,translate:TD,transpose:S$e},Symbol.toStringTag,{value:"Module"}));function MM(){const t=new Float32Array(9);return t[0]=1,t[4]=1,t[8]=1,t}function q$e(t){const e=new Float32Array(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function W$e(t,e,i,n,r,s,o,a,l){const c=new Float32Array(9);return c[0]=t,c[1]=e,c[2]=i,c[3]=n,c[4]=r,c[5]=s,c[6]=o,c[7]=a,c[8]=l,c}function J$e(t,e){return new Float32Array(t,e,9)}Object.freeze(Object.defineProperty({__proto__:null,clone:q$e,create:MM,createView:J$e,fromValues:W$e},Symbol.toStringTag,{value:"Module"}));function hse(){return new Float32Array(2)}function Z$e(t){const e=new Float32Array(2);return e[0]=t[0],e[1]=t[1],e}function db(t,e){const i=new Float32Array(2);return i[0]=t,i[1]=e,i}function Y$e(t,e){return new Float32Array(t,e,2)}function dse(){return hse()}function pse(){return db(1,1)}function fse(){return db(1,0)}function mse(){return db(0,1)}const X$e=dse(),K$e=pse(),Q$e=fse(),ePe=mse();Object.freeze(Object.defineProperty({__proto__:null,ONES:K$e,UNIT_X:Q$e,UNIT_Y:ePe,ZEROS:X$e,clone:Z$e,create:hse,createView:Y$e,fromValues:db,ones:pse,unitX:fse,unitY:mse,zeros:dse},Symbol.toStringTag,{value:"Module"}));function tPe(t){return t instanceof Float32Array&&t.length>=2}function iPe(t){return Array.isArray(t)&&t.length>=2}function G3(t){return tPe(t)||iPe(t)}var ID;const Hu=[0,0];let hp=ID=class extends ie{constructor(t){super(t),this._viewpoint2D={center:kt(),rotation:0,scale:0,spatialReference:void 0},this.center=[0,0],this.extent=new Le,this.id=0,this.inverseTransform=Af(),this.resolution=0,this.rotation=0,this.scale=0,this.transform=Af(),this.transformNoRotation=Af(),this.displayMat3=MM(),this.displayViewMat3=MM(),this.viewMat3=MM(),this.viewMat2d=TA(),this.worldScreenWidth=0,this.size=[0,0]}set pixelRatio(t){this._set("pixelRatio",t),this._update()}set size(t){this._set("size",t),this._update()}set viewpoint(t){if(t){const e=this._viewpoint2D,i=t.targetGeometry;e.center[0]=i.x,e.center[1]=i.y,e.rotation=t.rotation,e.scale=t.scale,e.spatialReference=i.spatialReference}this._update()}copy(t){const e=this.size,i=this.viewpoint;return i&&e?(this.viewpoint=Oc(i,t.viewpoint),this._set("size",J2(e,t.size))):(this.viewpoint=t.viewpoint.clone(),this._set("size",[t.size[0],t.size[1]])),this._set("pixelRatio",t.pixelRatio),this}clone(){return new ID({size:this.size,viewpoint:this.viewpoint.clone(),pixelRatio:this.pixelRatio})}toMap(t,e,i){return G3(e)?fu(t,e,this.inverseTransform):(Hu[0]=e,Hu[1]=i,fu(t,Hu,this.inverseTransform))}toScreen(t,e,i){return G3(e)?fu(t,e,this.transform):(Hu[0]=e,Hu[1]=i,fu(t,Hu,this.transform))}toScreenNoRotation(t,e,i){return G3(e)?fu(t,e,this.transformNoRotation):(Hu[0]=e,Hu[1]=i,fu(t,Hu,this.transformNoRotation))}getScreenTransform(t,e){const{center:i}=this._viewpoint2D,n=this._get("pixelRatio")||1,r=this._get("size");return LV(t,i,r,e,0,n),t}_update(){const{center:t,spatialReference:e,scale:i,rotation:n}=this._viewpoint2D,r=this._get("pixelRatio")||1,s=this._get("size"),o=new Cu({targetGeometry:new pe(t[0],t[1],e),scale:i,rotation:n});if(this._set("viewpoint",o),!s||!e||!i)return;this.resolution=Zb(o),this.rotation=n,this.scale=i,this.spatialReference=e,J2(this.center,t);const a=s[0]!==0?2/s[0]:0,l=s[1]!==0?-2/s[1]:0;ose(this.displayMat3,a,0,0,0,l,0,-1,1,1);const c=ase(this.viewMat3),u=db(s[0]/2,s[1]/2),d=db(-s[0]/2,-s[1]/2),f=b6(n);TD(c,c,u),lse(c,c,f),TD(c,c,d),NV(this.displayViewMat3,this.displayMat3,c);const m=AV(this.viewMat2d,u);return QS(m,m,f),ub(m,m,d),jAe(this.extent,o,s),RV(this.transform,o,s,r),EV(this.inverseTransform,this.transform),JAe(this.transformNoRotation,o,s,r),this.worldScreenWidth=YAe(this.spatialReference,this.resolution),this._set("id",this.id+1),this}};h([p({readOnly:!0})],hp.prototype,"id",void 0),h([p({value:1,json:{write:!0}})],hp.prototype,"pixelRatio",null),h([p({json:{write:!0}})],hp.prototype,"size",null),h([p()],hp.prototype,"spatialReference",void 0),h([p({type:Cu,json:{write:!0}})],hp.prototype,"viewpoint",null),hp=ID=h([P("esri.views.2d.ViewState")],hp);const A7=hp;var CD,MD;let Eh=CD=class extends ye{constructor(){super(...arguments),this.left=0,this.top=0,this.right=0,this.bottom=0}clone(){return new CD({left:this.left,top:this.top,right:this.right,bottom:this.bottom})}};h([p()],Eh.prototype,"left",void 0),h([p()],Eh.prototype,"top",void 0),h([p()],Eh.prototype,"right",void 0),h([p()],Eh.prototype,"bottom",void 0),Eh=CD=h([P("esri.views.2d.PaddedViewState.Padding")],Eh);let yv=MD=class extends A7{constructor(...t){super(...t),this.paddedViewState=new A7,this._updateContent=(()=>{const e=kt();return()=>{const i=this._get("size"),n=this._get("padding");if(!i||!n)return;const r=this.paddedViewState;Or(e,n.left+n.right,n.top+n.bottom),er(e,i,e),J2(r.size,e);const s=r.viewpoint;s&&(this.viewpoint=s)}})(),this.addHandles(Q(()=>[this.size,this.padding],()=>this._updateContent(),ml)),this.padding=new Eh,this.size=[0,0]}set padding(t){this._set("padding",t||new Eh)}set viewpoint(t){if(t){const e=t.clone();this.paddedViewState.viewpoint=t,KAe(e,t,this._get("size"),this._get("padding"));const i=this._viewpoint2D,n=e.targetGeometry;i.center[0]=n.x,i.center[1]=n.y,i.rotation=e.rotation,i.scale=e.scale,i.spatialReference=n.spatialReference,this._update()}}clone(){return new MD({padding:this.padding.clone(),size:this.size.slice(),viewpoint:this.paddedViewState.viewpoint.clone(),pixelRatio:this.pixelRatio})}};h([p()],yv.prototype,"paddedViewState",void 0),h([p({type:Eh})],yv.prototype,"padding",null),h([p()],yv.prototype,"viewpoint",null),yv=MD=h([P("esri.views.2d.PaddedViewState")],yv);const nPe=yv;let qs=class extends ye{constructor(e){super(e),this.constraints=null,this.ready=!1,this.resizeAlign="center",this.addHandles([Q(()=>{var i;return(i=this.constraints)==null?void 0:i.version},i=>{this.constraints&&i&&this.ready&&(this.state.viewpoint=this.constraints.fit(this.state.paddedViewState.viewpoint))},ml)])}get center(){if(!this.ready)return this._get("center");const{center:e,spatialReference:i}=this.state.paddedViewState;return this.state.commitProperty("id"),new pe({x:e[0],y:e[1],spatialReference:i})}set center(e){if(e==null)return;if(!this.ready)return void this._set("center",e);let i;try{i=this._project(e,this.state.spatialReference)}catch(r){return void ne.getLogger(this).error(new V("mapview:invalid-center","could not project the value in the view's spatial reference",{input:e,error:r}))}const n=this.viewpoint;bD(n,n,i),this.viewpoint=n}get extent(){return this.ready?(this.state.commitProperty("id"),this.state.paddedViewState.extent.clone()):this._get("extent")}set extent(e){if(e==null)return;if(!e.width||!e.height)return void ne.getLogger(this).error(new V("mapview:invalid-extent","invalid extent size"));if(!this.ready)return this._set("extent",e),this._set("center",void 0),this._set("viewpoint",void 0),this._set("scale",void 0),void this._set("zoom",void 0);let i;try{i=this._project(e,this.state.spatialReference)}catch(r){return void ne.getLogger(this).error(new V("mapview:invalid-extent","could not project the value in the view's spatial reference",{error:r}))}const n=this.viewpoint;BAe(n,n,i,this.state.size,{constraints:this.constraints}),this.viewpoint=n}get padding(){return this.ready?this.state.padding:this._get("padding")}set padding(e){this.ready?(this.state.padding=e,this._set("padding",this.state.padding)):this._set("padding",e)}get resolution(){return this.ready?(this.state.commitProperty("id"),this.state.resolution):0}get rotation(){return this.ready?(this.state.commitProperty("id"),this.state.rotation):this._get("rotation")}set rotation(e){if(isNaN(e))return;if(!this.ready)return void this._set("rotation",e);const i=this.viewpoint;e$e(i,i,e),this.viewpoint=i}get scale(){return this.ready?(this.state.commitProperty("id"),this.state.scale):this._get("scale")}set scale(e){if(!e||isNaN(e))return;if(!this.ready){this._set("scale",e),this._set("zoom",void 0);const n=this._get("extent");return void(n&&(this._set("extent",void 0),this._set("center",n.center)))}const i=this.viewpoint;S7(i,i,e),this.viewpoint=i}get viewpoint(){return this.ready?this.state.paddedViewState.viewpoint.clone():this._get("viewpoint")}set viewpoint(e){var s;if(e==null)return;if(!this.ready)return this._set("viewpoint",e),this._set("extent",void 0),this._set("center",void 0),this._set("zoom",void 0),void this._set("scale",void 0);let i,n;try{i=this._project(e,this.state.spatialReference),!e.scale||isNaN(e.scale)?n=new V("mapview:invalid-viewpoint",`invalid scale value of ${e.scale}`):e.targetGeometry==null&&(n=new V("mapview:invalid-viewpoint","geometry not defined"))}catch(o){n=new V("mapview:invalid-viewpoint","could not project the value in the view's spatial reference",{error:o})}if(n)return void ne.getLogger(this).error(n);this._scaleBeforeChangingSpatialReference=null;const r=new Cu({targetGeometry:new pe,scale:0,rotation:0});Oc(r,i),(s=this.constraints)==null||s.constrain(r,this.state.paddedViewState.viewpoint),this.state.viewpoint=r,this._set("viewpoint",r)}get zoom(){var e;return this.ready?((e=this.constraints)==null?void 0:e.scaleToZoom(this.scale))??-1:this._get("zoom")}set zoom(e){var r,s;if(!(e>=0))return;if(!this.ready){this._set("zoom",e),this._set("scale",void 0);const o=this._get("extent");return void(o&&(this._set("extent",void 0),this._set("center",o.center)))}const i=((r=this.constraints)==null?void 0:r.zoomToScale(e))??0;if(!i)return void this._set("zoom",-1);const n=this.viewpoint;S7(n,n,i),this.viewpoint=n,this._set("zoom",((s=this.constraints)==null?void 0:s.scaleToZoom(this.scale))??-1)}getUserStartupOptions(e){if(!e[0]&&!e[1])return{center:void 0,rotation:void 0,scale:void 0};const{padding:i,constraints:n}=this,r=this._get("center"),s=this._get("extent"),o=this._get("scale"),a=this._get("rotation"),l=this._get("viewpoint"),c=this._get("zoom"),u=c!=null&&n!=null&&n.zoomToScale(c)||void 0;let d,f,m;const g=l==null?void 0:l.rotation,y=l==null?void 0:l.targetGeometry;(y==null?void 0:y.type)==="extent"?d=y:(y==null?void 0:y.type)==="point"&&(f=y,m=l==null?void 0:l.scale);const _=s??d;return{center:r??f??(_==null?void 0:_.center),rotation:a??g,scale:(o??u??m??(_&&O_(_,[e[0]-i.left-i.right,e[1]-i.top-i.bottom])))||void 0}}startup(e,i,n,r){var o;const s=e.targetGeometry;try{this._project(e,n)}catch(a){ne.getLogger(this).warn(new fl("mapview:startup-projection-error","projection of initial viewpoint to the view's spatial reference, defaulting to the initial viewpoint.",{center:s.toJSON(),spatialReference:n,error:a})),e.targetGeometry=r||new pe({x:0,y:0,spatialReference:n})}(o=this.constraints)==null||o.fit(e),this._set("state",new nPe({padding:this.padding,size:i,viewpoint:e})),this._set("ready",!0)}teardown(){this._set("ready",!1);const{center:[e,i],spatialReference:n,rotation:r,scale:s}=this.state.paddedViewState,o=new pe({x:e,y:i,spatialReference:n});this._set("viewpoint",null),this._set("extent",null),this._set("center",o),this._set("zoom",-1),this._set("rotation",r),this._set("scale",s),this._set("state",null)}changeSpatialReference(e){var l;const i=this.state.paddedViewState.clone();if(this._scaleBeforeChangingSpatialReference==null)this._scaleBeforeChangingSpatialReference=i.scale;else{const c=i.viewpoint.clone();c.scale=this._scaleBeforeChangingSpatialReference,i.viewpoint=c}const n=i.clone(),[r,s]=i.center;let o=null;try{o=this._project(new pe({x:r,y:s,spatialReference:i.spatialReference}),e)}catch(c){gV()||ne.getLogger(this).warn(new fl("mapview:spatial-reference-change","could not project the view's center to the new spatial reference",{center:o==null?void 0:o.toJSON(),spatialReference:e,error:c}))}o||(o=new pe({x:0,y:0,spatialReference:e}));const a=bD(new Cu({targetGeometry:new pe,scale:0,rotation:0}),i.viewpoint,o);n.viewpoint=a;try{const u=[i.size[0]/2,i.size[1]/2],d=[u[0]+20,u[1]],f=i.toMap([0,0],d),{x:m,y:g}=this._project(new pe({x:f[0],y:f[1],spatialReference:i.spatialReference}),e);f[0]=m,f[1]=g,n.toScreen(f,f);const y=XAe(u,f,d),_=Math.hypot(f[0]-u[0],f[1]-u[1])/20;!Number.isFinite(_)||Math.abs(_)>4?(a.rotation=0,a.targetGeometry=new pe({x:0,y:0,spatialReference:e})):(a.scale*=_,a.scale>ee("mapview-srswitch-adjust-rotation-scale-threshold")?a.rotation=0:a.rotation+=Number.isFinite(y)?y:0)}catch{}(l=this._get("constraints"))==null||l.constrain(a,void 0),this._get("state").viewpoint=a}resize(e,i){var o;if(!this.ready)return;const n=this.state;let r=this.state.paddedViewState.viewpoint;const s=this.state.paddedViewState.size.concat();n.size=[e,i],QAe(r,r,s,this.state.paddedViewState.size,this.resizeAlign),r=((o=this.constraints)==null?void 0:o.constrain(r,void 0))??r,this.state.viewpoint=r}toMap(e){if(!this.ready)return null;const i=[0,0],[n,r]=this.state.toMap(i,[e.x,e.y]),s=this.state.spatialReference;return new pe({x:n,y:r,spatialReference:s})}toScreen(e){if(!this.ready)return null;const i=this._project(e,this.state.spatialReference),n=[i.x,i.y];return this.state.toScreen(n,n),As(n[0],n[1])}_project(e,i){var s;const n=e&&e.targetGeometry||e;if(!i)return e;if(!n)return null;if(i.imageCoordinateSystem||(s=n.spatialReference)!=null&&s.imageCoordinateSystem||En(i,n.spatialReference))return e;const r=an(n,i);if(!r)throw new V("mapview:projection-not-possible","projecting input geometry to target spatial reference returned a null value",{geometry:n,spatialReference:i});return rPe(e)?(e.targetGeometry=r,e):r}};function rPe(t){return(t==null?void 0:t.declaredClass)==="esri.Viewpoint"}h([p({type:pe})],qs.prototype,"center",null),h([p()],qs.prototype,"constraints",void 0),h([p({type:Le})],qs.prototype,"extent",null),h([p({value:{top:0,right:0,bottom:0,left:0},cast:t=>({top:0,right:0,bottom:0,left:0,...t})})],qs.prototype,"padding",null),h([p()],qs.prototype,"ready",void 0),h([p()],qs.prototype,"resizeAlign",void 0),h([p({readOnly:!0})],qs.prototype,"resolution",null),h([p({type:Number})],qs.prototype,"rotation",null),h([p({type:Number})],qs.prototype,"scale",null),h([p({readOnly:!0})],qs.prototype,"state",void 0),h([p({type:Cu})],qs.prototype,"viewpoint",null),h([p()],qs.prototype,"zoom",null),qs=h([P("esri.views.2d.ViewStateManager")],qs);function FV(t,e){switch(e){case"primary":return t.pointerType==="touch"||t.button===0;case"secondary":return t.pointerType!=="touch"&&t.button===2;case"tertiary":return t.pointerType!=="touch"&&t.button===1}}let $7=class extends Sr{constructor(e,i){super(!0),this._view=e,this.registerIncoming("double-click",i,n=>this._handleDoubleClick(n,i))}_handleDoubleClick(e,i){FV(e.data,"primary")&&(e.stopPropagation(),i?this._view.mapViewNavigation.zoomOut([e.data.x,e.data.y]):this._view.mapViewNavigation.zoomIn([e.data.x,e.data.y]))}},sPe=class extends Sr{constructor(e,i,n){super(!0),this.view=e,this.pointerType=i,this.registerIncoming("double-tap-drag",n,r=>this._handleDoubleTapDrag(r))}_handleDoubleTapDrag(e){const{data:i}=e,{pointerType:n}=i;if(n!==this.pointerType)return;e.stopPropagation();const{action:r,delta:s}=i,{view:o}=this,{mapViewNavigation:a}=o;switch(r){case"begin":{const{scale:l}=o;this._startScale=l,this._currentScale=l,this._previousDelta=s,a.begin();break}case"update":{if(this._previousDelta.y===s.y)return;this._previousDelta=s;const l=1.015**s.y,c=this._startScale*l,u=c/this._currentScale;a.setViewpointImmediate(u),this._currentScale=c;break}case"end":{const{constraints:l}=o,{effectiveLODs:c,snapToZoom:u}=l;if(!u||!c)return void a.end();const d=l.snapScale(this._currentScale),f=(s.y>0?Math.max(d,l.snapToPreviousScale(this._startScale)):Math.min(d,l.snapToNextScale(this._startScale)))/this._currentScale;a.zoom(f);break}}}},RP=class{constructor(e){this._callbacks=e,this._currentCount=0,this._callbacks.condition||(this._callbacks.condition=()=>!0)}handle(e){const i=e.data,n=i.pointers.size;switch(i.action){case"start":this._currentCount=n,this._emitStart(e);break;case"added":this._emitEnd(this._previousEvent),this._currentCount=n,this._emitStart(e);break;case"update":this._emitUpdate(e);break;case"removed":this._startEvent&&this._emitEnd(this._previousEvent),this._currentCount=n,this._emitStart(e);break;case"end":this._emitEnd(e),this._currentCount=0}this._previousEvent=e}_emitStart(e){var i,n;this._startEvent=e,(n=(i=this._callbacks).condition)!=null&&n.call(i,this._currentCount,e)&&this._callbacks.start(this._currentCount,e,this._startEvent)}_emitUpdate(e){var i,n;(n=(i=this._callbacks).condition)!=null&&n.call(i,this._currentCount,e)&&this._callbacks.update(this._currentCount,e,this._startEvent)}_emitEnd(e){var i,n;(n=(i=this._callbacks).condition)!=null&&n.call(i,this._currentCount,e)&&this._callbacks.end(this._currentCount,e,this._startEvent),this._startEvent=null}},oPe=class extends Sr{constructor(e,i,n){super(!0),this.view=e,this.pointerAction=i,this.registerIncoming("drag",n,r=>this._handleDrag(r)),this.registerIncoming("pointer-down",()=>this.stopMomentumNavigation())}onInstall(e){super.onInstall(e),this._dragEventSeparator=new RP({start:(i,n)=>{this.view.mapViewNavigation.pan.begin(this.view,n.data),n.stopPropagation()},update:(i,n)=>{this.view.mapViewNavigation.pan.update(this.view,n.data),n.stopPropagation()},end:(i,n)=>{this.view.mapViewNavigation.pan.end(this.view,n.data),n.stopPropagation()},condition:(i,n)=>i===1&&FV(n.data,this.pointerAction)})}_handleDrag(e){const i=this.view.mapViewNavigation;i.pinch.zoomMomentum||i.pinch.rotateMomentum?this.stopMomentumNavigation():this._dragEventSeparator.handle(e)}stopMomentumNavigation(){this.view.mapViewNavigation.pan.stopMomentumNavigation()}},aPe=class extends Sr{constructor(e,i,n){super(!0),this._view=e,this.pointerAction=i;const r=this._view.mapViewNavigation;this._dragEventSeparator=new RP({start:(s,o)=>{r.rotate.begin(this._view,o.data),o.stopPropagation()},update:(s,o)=>{r.rotate.update(this._view,o.data),o.stopPropagation()},end:(s,o)=>{r.rotate.end(),o.stopPropagation()},condition:(s,o)=>s===1&&FV(o.data,this.pointerAction)}),this.registerIncoming("drag",n,s=>this._dragEventSeparator.handle(s))}};function kl(t){let e=t*t;return t<0&&(e*=-1),e}function lPe(t){return t.translation[0]=0,t.translation[1]=0,t.translation[2]=0,t.heading=0,t.tilt=0,t}function cPe(t,e,i){const n=i,r=t.state,s=t.device,o=e.tiltDirection==="forward-down"?1:-1,a=1;return s.deviceType==="standard"?(n.translation[0]=kl(r.axes[0]),n.translation[1]=kl(r.axes[1]),n.translation[2]=kl(r.buttons[7])-kl(r.buttons[6]),n.heading=kl(r.axes[2]),n.tilt=kl(r.axes[3])):s.deviceType==="spacemouse"&&(n.translation[0]=1.2*kl(r.axes[0]),n.translation[1]=1.2*kl(r.axes[1]),n.translation[2]=2*-kl(r.axes[2]),n.heading=1.2*kl(r.axes[5]),n.tilt=1.2*kl(r.axes[3])),n.tilt*=o,rn(n.translation,n.translation,a),n}function uPe(t){return t.translation[0]===0&&t.translation[1]===0&&t.translation[2]===0&&t.heading===0&&t.tilt===0&&t.zoom===0}let hPe=class extends Sr{constructor(e){super(!0),this._view=e,this._frameTask=null,this._watchHandles=new Rs,this._currentDevice=null,this._transformation={translation:[0,0,0],heading:0,tilt:0,zoom:0},this._handle=this.registerIncoming("gamepad",i=>this._handleGamePadEvent(i)),this._handle.pause()}onInstall(e){super.onInstall(e),this._watchHandles.add([Q(()=>{var i;return(i=this._view.navigation.gamepad)==null?void 0:i.enabled},i=>{i?(this._handle.resume(),this._frameTask||(this._frameTask=Y_({update:n=>this._frameUpdate(n.deltaTime)}))):(this._handle.pause(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null))},He)])}onUninstall(){this._watchHandles.removeAll(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null),super.onUninstall()}_handleGamePadEvent(e){const i=this._view.navigation.gamepad.device;i&&e.data.device!==i||this._currentDevice&&this._currentDevice!==e.data.device||(e.data.action==="end"?(this._currentDevice=null,lPe(this._transformation)):(this._currentDevice=e.data.device,cPe(e.data,this._view.navigation.gamepad,this._transformation)))}_frameUpdate(e){const i=this._transformation;if(uPe(i))return;const n=this._view.viewpoint.clone(),r=this._view.navigation.gamepad.velocityFactor,s=pPe*r*e;LP(n,n,[i.translation[0]*s,-i.translation[1]*s]);const o=1+i.translation[2]*fPe*e,a=this._view.constraints.rotationEnabled?-i.heading*dPe*e:0,l=this._view.size,c=[l[0]/2,l[1]];Xre(n,n,o,a,c,l);const u=this._view.constraints.constrain(n,this._view.viewpoint);this._view.viewpoint=u}};const dPe=.06,pPe=.7,fPe=6e-4;let mPe=class extends Sr{constructor(e,i,n){super(!0),this.view=e,this.keys=i,this._pressed=!1,this._keyMap={[i.left]:"left",[i.right]:"right",[i.up]:"up",[i.down]:"down"},this.registerIncoming("key-down",n,r=>this._handleKeyDown(r)),this.registerIncoming("key-up",n,r=>this._handleKeyUp(r)),this.registerIncoming("blur",n,()=>this._handleBlur())}_handleKeyDown(e){e.data.repeat||this._handleKey(e,!0)}_handleKeyUp(e){this._handleKey(e,!1)}_handleBlur(){this._pressed&&(this._pressed=!1,this.view.mapViewNavigation.stop())}_handleKey(e,i){const n=this._keyMap[e.data.key];if(this._pressed=n!=null,this._pressed){if(i)switch(this.view.mapViewNavigation.begin(),n){case"left":this.view.mapViewNavigation.continousPanLeft();break;case"right":this.view.mapViewNavigation.continousPanRight();break;case"up":this.view.mapViewNavigation.continousPanUp();break;case"down":this.view.mapViewNavigation.continousPanDown()}else this._pressed=!1,this.view.mapViewNavigation.stop();e.stopPropagation()}}},gPe=class extends Sr{constructor(e,i,n){super(!0),this.view=e,this.keys=i,this._pressed=!1,this._keyToDirection={[i.clockwiseOption1]:"clockwise",[i.clockwiseOption2]:"clockwise",[i.counterClockwiseOption1]:"counterClockwise",[i.counterClockwiseOption2]:"counterClockwise",[i.resetOption1]:"reset",[i.resetOption2]:"reset"},this.registerIncoming("key-down",n,r=>this._handleKeyDown(r)),this.registerIncoming("key-up",n,r=>this._handleKeyUp(r)),this.registerIncoming("blur",n,()=>this._handleBlur())}_handleKeyDown(e){e.data.repeat||this._handleKey(e,!0)}_handleKeyUp(e){this._handleKey(e,!1)}_handleBlur(){this._pressed&&(this._pressed=!1,this.view.mapViewNavigation.stop())}_handleKey(e,i){const n=e.modifiers;if(n.size>0&&!n.has("Shift")||!this.view.constraints.rotationEnabled)return;const r=this._keyToDirection[e.data.key];if(this._pressed=r!=null,this._pressed){if(i)switch(this.view.mapViewNavigation.begin(),r){case"clockwise":this.view.mapViewNavigation.continousRotateClockwise();break;case"counterClockwise":this.view.mapViewNavigation.continousRotateCounterclockwise();break;case"reset":this.view.mapViewNavigation.resetRotation()}else this._pressed=!1,this.view.mapViewNavigation.stop();e.stopPropagation()}}};var d_;(function(t){t[t.IN=0]="IN",t[t.OUT=1]="OUT"})(d_||(d_={}));let yPe=class extends Sr{constructor(e,i,n){super(!0),this.view=e,this.keys=i,this._keysToZoomAction={},this.registerIncoming("key-down",n,r=>this._handleKeyDown(r)),i.zoomIn.forEach(r=>this._keysToZoomAction[r]=d_.IN),i.zoomOut.forEach(r=>this._keysToZoomAction[r]=d_.OUT)}_handleKeyDown(e){this._handleKey(e)}_handleKey(e){const i=e.modifiers;if(i.size>0&&!i.has("Shift"))return;const{key:n}=e.data;if(!(n in this._keysToZoomAction))return;const r=this._keysToZoomAction[n],{mapViewNavigation:s}=this.view;let o=null;switch(r){case d_.IN:o=s.zoomIn();break;case d_.OUT:o=s.zoomOut();break;default:return}s.begin(),o.then(()=>s.end()),e.stopPropagation()}};const vPe=.6;let _Pe=class extends Sr{constructor(e,i){super(!0),this._view=e,this._canZoom=!0,this.registerIncoming("mouse-wheel",i,n=>this._handleMouseWheel(n))}_handleMouseWheel(e){if(!this._view.navigation.mouseWheelZoomEnabled||(e.preventDefault(),e.stopPropagation(),!this._canZoom))return;const i=this._view.mapViewNavigation,{x:n,y:r,deltaY:s}=e.data,o=1/vPe**(1/60*s),a=i.zoom(o,[n,r]);a&&(this._canZoom=!1,a.catch(()=>{}).then(()=>{this._canZoom=!0,i.end()}))}},bPe=class extends Sr{constructor(e){super(!0),this.view=e,this.registerIncoming("drag",n=>this._handleDrag(n)),this.registerIncoming("pointer-down",()=>this._stopMomentumNavigation());const i=this.view.mapViewNavigation;this._dragEventSeparator=new RP({start:(n,r)=>{i.pinch.begin(this.view,r.data),r.stopPropagation()},update:(n,r)=>{i.pinch.update(this.view,r.data),r.stopPropagation()},end:(n,r)=>{i.pinch.end(this.view),r.stopPropagation()},condition:n=>n>=2})}_handleDrag(e){this._dragEventSeparator.handle(e)}_stopMomentumNavigation(){this.view.mapViewNavigation.pinch.stopMomentumNavigation()}};function P7(t){const e=t.native;return e?{buttons:e.buttons.map(i=>i.pressed?i.value||1:0),axes:e.axes.map(i=>SPe(i,t.axisThreshold))}:{buttons:[],axes:[]}}function wPe(t,e){if(t.axes.length!==e.axes.length||t.buttons.length!==e.buttons.length)return!1;for(let i=0;i<t.axes.length;i++)if(t.axes[i]!==e.axes[i])return!1;for(let i=0;i<t.buttons.length;i++)if(t.buttons[i]!==e.buttons[i])return!1;return!0}function xPe(t){for(let e=0;e<t.axes.length;e++)if(t.axes[e]!==0)return!1;for(let e=0;e<t.buttons.length;e++)if(t.buttons[e]!==0)return!1;return!0}function SPe(t,e){const i=Math.abs(t);return i<e?0:Math.sign(t)*(i-e)/(1-e)}let TPe=class{constructor(e,i){this._element=e,this._input=i,this._hasEventListeners=!1,this._onConnectGamepad=s=>{this._connectGamepad(s.gamepad)},this._onDisconnectGamepad=s=>{const o=s.gamepad,a=o.index,l=this._inputDevices[a];l&&(this._emitGamepadEvent(o,P7(l),!1),this._inputDevices.splice(a,1),this._latestUpdate.splice(a,1),this._input.gamepad.devices.remove(l),this.ensurePollingState())},this._frameTask=null,this._latestUpdate=new Array,this._inputDevices=new Array,this._callback=null;const n="getGamepads"in window.navigator,r=window.isSecureContext;this.supported=n&&r,this.supported&&(this._forEachGamepad(s=>this._connectGamepad(s)),window.addEventListener("gamepadconnected",this._onConnectGamepad),window.addEventListener("gamepaddisconnected",this._onDisconnectGamepad),this.ensurePollingState())}destroy(){this.hasEventListeners=!1,this.supported&&(window.removeEventListener("gamepadconnected",this._onConnectGamepad),window.removeEventListener("gamepaddisconnected",this._onDisconnectGamepad))}set hasEventListeners(e){this._hasEventListeners!==e&&(this._hasEventListeners=e,this.ensurePollingState())}get _eventsEnabled(){return this.supported&&this._inputDevices.length>0&&this._hasEventListeners}set onEvent(e){this._callback=e}_connectGamepad(e){const i=new CV(e);i.deviceType!=="unknown"&&(this._inputDevices[e.index]=i,this._input.gamepad.devices.add(i)),this.ensurePollingState()}ensurePollingState(){this._eventsEnabled?this._startPolling():this._stopPolling()}_startPolling(){this._frameTask==null&&(this._frameTask=Y_({update:()=>this._readGamepadState()}))}_stopPolling(){this._frameTask!=null&&(this._frameTask.remove(),this._frameTask=null,this._latestUpdate=new Array)}_readGamepadState(){const e=document.hasFocus(),i=this._element.contains(document.activeElement),n=this._input.gamepad.enabledFocusMode==="document"&&!e||this._input.gamepad.enabledFocusMode==="view"&&!i;this._forEachGamepad(r=>{const s=this._inputDevices[r.index];if(!s)return;const o=this._latestUpdate[r.index],a=P7(s),l=n||xPe(a);o&&(o.timestamp===r.timestamp||!o.active&&l||wPe(o.state,a))||this._emitGamepadEvent(r,a,!l)})}_forEachGamepad(e){const i=window.navigator.getGamepads();for(let n=0;n<i.length;n++){const r=i[n];this._validate(r)&&e(r)}}_emitGamepadEvent(e,i,n){const r=this._latestUpdate[e.index],s=r&&r.active;if(!s&&!n)return;const o=!s&&n?"start":s&&n?"update":"end";this._latestUpdate[e.index]={timestamp:e.timestamp,state:i,active:n},this._callback&&this._callback({device:this._inputDevices[e.index],state:i,action:o})}_validate(e){if(!e||!e.connected)return!1;for(let i=0;i<e.axes.length;i++)if(isNaN(e.axes[i]))return!1;return!0}};const k7=ee("edge"),IPe=ee("chrome"),CPe=ee("ff"),MPe=ee("safari"),O7="esri-view-surface",$0={touchNone:`${O7}--touch-none`,touchPan:`${O7}--touch-pan`};let gse=class yse{constructor(e,i){this._input=i,this._active={},this._callback=()=>{},this._activePointerCaptures=new Set,this._keyDownState=new Set,this._eventId=1,this._browserTouchPanningEnabled=!1,this._element=e,e.getAttribute("tabindex")||e.setAttribute("tabindex","0"),this._eventHandlers={"key-down":this._handleKey,"key-up":this._handleKey,"pointer-down":this._handlePointer,"pointer-move":this._handlePointerPreventDefault,"pointer-up":this._handlePointerPreventDefault,"pointer-enter":this._handlePointer,"pointer-leave":this._handlePointer,"pointer-cancel":this._handlePointer,"mouse-wheel":this._handleMouseWheel,"pointer-capture-lost":this._handlePointerCaptureLost},this._updateTouchAction(),this._element.addEventListener("keydown",this._preventAltKeyDefault),this._gamepadSource=new TPe(e,this._input),this._gamepadSource.onEvent=n=>this._callback("gamepad",n)}destroy(){this._callback=()=>{},this.activeEvents=null,this._activePointerCaptures.forEach(e=>{this._releasePointerCaptureSafe(e)}),this._gamepadSource=Je(this._gamepadSource),this._activePointerCaptures=null,this._removeTouchAction(),this._element.removeEventListener("keydown",this._preventAltKeyDefault)}get browserTouchPanningEnabled(){return this._browserTouchPanningEnabled}set browserTouchPanningEnabled(e){this._browserTouchPanningEnabled=e,this._updateTouchAction(),this._updateTouchEventHandling()}set onEventReceived(e){this._callback=e}set activeEvents(e){for(const i in this._active)if(!e||!e.has(i)){const n=this._active[i];this._element.removeEventListener(H3[i],n),delete this._active[i]}e&&e.forEach(i=>{if(!this._active[i]&&H3[i]){const n=(this._eventHandlers[i]||this._handleDefault).bind(this,i);this._element.addEventListener(H3[i],n),this._active[i]=n}}),this._gamepadSource.hasEventListeners=(e==null?void 0:e.has("gamepad"))??!1}setPointerCapture(e,i){i?this._setPointerCatpureSafe(e.pointerId):(this._releasePointerCaptureSafe(e.pointerId),this._activePointerCaptures.delete(e.pointerId))}_updateTouchAction(){this._element.classList.remove(this._browserTouchPanningEnabled?$0.touchNone:$0.touchPan),this._element.classList.add(this._browserTouchPanningEnabled?$0.touchPan:$0.touchNone)}_updateTouchEventHandling(){this._browserTouchPanningEnabled?this._element.addEventListener("touchmove",this._preventMultiTouchPanning):this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_removeTouchAction(){this._element.classList.remove($0.touchNone),this._element.classList.remove($0.touchPan),this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_setPointerCatpureSafe(e){try{this._element.setPointerCapture(e),this._activePointerCaptures.add(e)}catch{}}_releasePointerCaptureSafe(e){try{if(this._element.hasPointerCapture&&!this._element.hasPointerCapture(e))return;this._element.releasePointerCapture(e)}catch{}}_updateNormalizedPointerLikeEvent(e,i){const n=bre(this._element,e);return yse.test.disableSubpixelCoordinates&&(n.x=Math.round(n.x),n.y=Math.round(n.y)),i.x=n.x,i.y=n.y,i}_handleKey(e,i){const n=YMe(i);n&&e==="key-up"&&this._keyDownState.delete(n);const r={native:i,key:n,repeat:!!n&&this._keyDownState.has(n)};n&&e==="key-down"&&this._keyDownState.add(r.key),this._callback(e,r)}_handlePointer(e,i){const n=this._updateNormalizedPointerLikeEvent(i,{native:i,x:0,y:0,pointerType:i.pointerType,button:i.button,buttons:i.buttons,eventId:this._eventId++});this._callback(e,n)}_handlePointerPreventDefault(e,i){const n=this._updateNormalizedPointerLikeEvent(i,{native:i,x:0,y:0,pointerType:i.pointerType,button:i.button,buttons:i.buttons,eventId:this._eventId++});i.preventDefault(),this._callback(e,n)}_handleMouseWheel(e,i){let n=i.deltaY;switch(i.deltaMode){case 0:k7&&(n=n/document.documentElement.clientHeight*600);break;case 1:n*=30;break;case 2:n*=900}k7?n*=.7:IPe||MPe?n*=.6:CPe&&(n*=1.375);const r=100,s=Math.abs(n);s>r&&(n=n/s*200/(1+Math.exp(-.02*(s-r))));const o=this._updateNormalizedPointerLikeEvent(i,{native:i,x:0,y:0,deltaY:n});this._callback(e,o)}_handlePointerCaptureLost(e,i){this._activePointerCaptures.delete(i.pointerId),this._handleDefault(e,i)}_handleDefault(e,i){const n={native:i};i.preventDefault(),this._callback(e,n)}_preventAltKeyDefault(e){e.key==="Alt"&&e.preventDefault()}_preventMultiTouchPanning(e){e.touches.length>1&&e.preventDefault()}};gse.test={disableSubpixelCoordinates:!1};const H3={"key-down":"keydown","key-up":"keyup","pointer-down":"pointerdown","pointer-up":"pointerup","pointer-move":"pointermove","mouse-wheel":"wheel","pointer-capture-got":"gotpointercapture","pointer-capture-lost":"lostpointercapture","context-menu":"contextmenu","pointer-enter":"pointerenter","pointer-leave":"pointerleave","pointer-cancel":"pointercancel",focus:"focus",blur:"blur"};let EPe=class extends Sr{constructor(){super(!0),this.registerIncoming("context-menu",e=>{e.data.native.preventDefault()})}};function zV(t,e){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)}function APe(t,e){const i=e.x-t.x,n=e.y-t.y;return Math.sqrt(i*i+n*n)}function $Pe(t,e){if(e?(e.radius=0,e.center.x=0,e.center.y=0):e={radius:0,center:As()},t.length===0)return e;if(t.length===1)return e.center.x=t[0].x,e.center.y=t[0].y,e;if(t.length===2){const[x,S]=t,[T,I]=[S.x-x.x,S.y-x.y];return e.radius=Math.sqrt(T*T+I*I)/2,e.center.x=(x.x+S.x)/2,e.center.y=(x.y+S.y)/2,e}let i=0,n=0;for(let x=0;x<t.length;x++)i+=t[x].x,n+=t[x].y;i/=t.length,n/=t.length;const r=t.map(x=>x.x-i),s=t.map(x=>x.y-n);let o=0,a=0,l=0,c=0,u=0,d=0,f=0;for(let x=0;x<r.length;x++){const S=r[x],T=s[x],I=S*S,C=T*T;o+=I,a+=C,l+=S*T,c+=I*S,u+=C*T,d+=S*C,f+=T*I}const m=.5*(c+d),g=.5*(u+f),y=o*a-l*l,_=(m*a-g*l)/y,b=(o*g-l*m)/y,w=As(_+i,b+n);return{radius:Math.sqrt(_*_+b*b+(o+a)/t.length),center:w}}function by(t){const{native:e}=t,{pointerId:i,button:n,pointerType:r}=e;return r==="mouse"?`${i}:${n}`:`${r}`}const sl={maximumDoubleClickDelay:250,maximumDoubleClickDistance:10,maximumDoubleTouchDelay:350,maximumDoubleTouchDistance:35};let PPe=class extends Sr{constructor(e=sl.maximumDoubleClickDelay,i=sl.maximumDoubleClickDistance,n=sl.maximumDoubleTouchDelay,r=sl.maximumDoubleTouchDistance,s=Pb){super(!1),this._maximumDoubleClickDelay=e,this._maximumDoubleClickDistance=i,this._maximumDoubleTouchDelay=n,this._maximumDoubleTouchDistance=r,this._clock=s,this._pointerState=new Map,this._click=this.registerOutgoing("click"),this._doubleClick=this.registerOutgoing("double-click"),this.registerIncoming("immediate-click",this._handleImmediateClick.bind(this)),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this))}onUninstall(){this._pointerState.forEach(e=>e.doubleClickTimer=Ri(e.doubleClickTimer))}get hasPendingInputs(){return OS(this._pointerState,e=>e.doubleClickTimer!=null)}_clearDoubleClickTimer(e,i){const n=this._pointerState.get(e);n&&(n.doubleClickTimer=Ri(n.doubleClickTimer),i&&this._click.emit(n.event.data,void 0,n.event.modifiers),this._pointerState.delete(e),this.refreshHasPendingInputs())}_doubleClickTimeoutExceeded(e){const i=this._pointerState.get(e);i.pointerDownCount===1&&this._click.emit(i.event.data,void 0,i.event.modifiers),i.doubleClickTimer=null,this._pointerState.delete(e),this.refreshHasPendingInputs()}_getPointerId(e){const{pointerId:i,pointerType:n,button:r}=e.native;return n==="mouse"?`${i}:${r}`:`${n}`}_handleImmediateClick(e){const i=e.data,{pointerType:n}=i.native,r=this._getPointerId(i);if(!this._pointerState.has(r))return void this._startClick(e);const s=this._pointerState.get(r),{data:o,modifiers:a}=s.event,l=n==="touch"?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;zV(o,i)>l?(this._clearDoubleClickTimer(r,!0),this._startClick(e)):(this._clearDoubleClickTimer(r,!1),s.pointerDownCount===2&&this._doubleClick.emit(o,void 0,a))}_handlePointerDown(e){const i=by(e.data),n=this._pointerState.get(i);n&&(n.pointerDownCount+=1)}_startClick(e){const{data:i}=e,{native:{pointerType:n}}=i,r=by(i),s=n==="touch"?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay,o=this._clock.setTimeout(()=>this._doubleClickTimeoutExceeded(r),s),a=1;this._pointerState.set(r,{event:e,doubleClickTimer:o,pointerDownCount:a}),this.refreshHasPendingInputs()}},kPe=class extends Sr{constructor(e=sl.maximumDoubleClickDelay,i=sl.maximumDoubleClickDistance,n=sl.maximumDoubleTouchDelay,r=sl.maximumDoubleTouchDistance,s=Pb){super(!1),this._maximumDoubleClickDelay=e,this._maximumDoubleClickDistance=i,this._maximumDoubleTouchDelay=n,this._maximumDoubleTouchDistance=r,this._clock=s,this._doubleTapDragReady=!1,this._doubleTapDragActive=!1,this._dragStartCenter=As(0,0),this._pointerState=new Map,this._doubleTapDrag=this.registerOutgoing("double-tap-drag"),this._dragEventSeparator=new RP({start:(o,a)=>this._dragStart(o,a),update:(o,a)=>this._dragUpdate(a),end:(o,a)=>this._dragEnd(a)}),this.registerIncoming("drag",o=>this._dragEventSeparator.handle(o)),this.registerIncoming("pointer-down",o=>this._handlePointerDown(o)),this.registerIncoming("pointer-up",()=>this._handlePointerUp())}onUninstall(){this._pointerState.forEach(e=>{e.doubleTapTimeout=Ri(e.doubleTapTimeout)})}get hasPendingInputs(){return OS(this._pointerState,e=>e.doubleTapTimeout!=null)}_clearPointerDown(e){const i=this._pointerState.get(e);i&&(i.doubleTapTimeout=Ri(i.doubleTapTimeout),this._pointerState.delete(e),this.refreshHasPendingInputs())}_createDoubleTapDragData(e,i,n){const{button:r,buttons:s,pointer:o,pointers:a,pointerType:l,timestamp:c}=n;return{action:e,delta:i,button:r,buttons:s,pointer:o,pointers:a,pointerType:l,timestamp:c}}_dragStart(e,i){if(!this._doubleTapDragReady||e!==1)return;this._doubleTapDragReady=!1,this._doubleTapDragActive=!0;const{data:n,modifiers:r}=i,{center:s}=n;this._dragStartCenter=s;const o=this._createDoubleTapDragData("begin",As(0,0),n);this._doubleTapDrag.emit(o,void 0,r),i.stopPropagation()}_dragUpdate(e){if(!this._doubleTapDragActive)return;const{data:i,modifiers:n}=e,{center:r}=i,s=As(r.x-this._dragStartCenter.x,r.y-this._dragStartCenter.y),o=this._createDoubleTapDragData("update",s,i);this._doubleTapDrag.emit(o,void 0,n),e.stopPropagation()}_dragEnd(e){if(!this._doubleTapDragActive)return;const{data:i,modifiers:n}=e,{center:r}=i,s=As(r.x-this._dragStartCenter.x,r.y-this._dragStartCenter.y),o=this._createDoubleTapDragData("end",s,i);this._doubleTapDrag.emit(o,void 0,n),this._doubleTapDragActive=!1,e.stopPropagation()}_handlePointerDown(e){const{data:i}=e,n=by(i),r=this._pointerState.get(n),{pointerType:s}=i.native;if(r){const o=s==="touch"?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;this._clearPointerDown(n),zV(r.event.data,i)>o?this._storePointerDown(e):this._doubleTapDragReady=!0}else this._storePointerDown(e)}_handlePointerUp(){this._doubleTapDragReady=!1}_storePointerDown(e){const{data:i}=e,{pointerType:n}=i.native,r=by(i),s=n==="touch"?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay,o=this._clock.setTimeout(()=>this._clearPointerDown(r),s);this._pointerState.set(r,{event:e,doubleTapTimeout:o}),this.refreshHasPendingInputs()}},OPe=class extends Sr{constructor(e){super(!1),this._navigationTouch=e,this._startStateModifiers=new Set,this._activePointerMap=new Map,this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._drag=this.registerOutgoing("drag"),this.registerIncoming("pointer-drag",this._handlePointerDrag.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-capture-lost",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-cancel",this._handlePointerUpAndPointerLost.bind(this))}_createPayload(e,i,n,r){return{action:e,pointerType:this._pointerType,button:this._mouseButton,buttons:i.buttons,timestamp:r,pointers:LPe(this._activePointerMap),pointer:i,angle:n.angle,radius:n.radius,center:n.center}}_addPointer(e){const i=e.native.pointerId,n=fI(this._activePointerMap).angle,r={event:e,initialAngle:0,lastAngle:0};this._activePointerMap.set(i,r);const s=EM(r,vse(this._activePointerMap));r.initialAngle=s,r.lastAngle=s,this._updatePointerAngles(n)}_updatePointer(e){if(e&&e.x==null&&e.y==null)return;const i=e.native.pointerId,n=this._activePointerMap.get(i);n?n.event=e:this._addPointer(e)}_removePointer(e){const i=fI(this._activePointerMap).angle;this._activePointerMap.delete(e),this._updatePointerAngles(i)}_updatePointerAngles(e){const i=fI(this._activePointerMap);this._activePointerMap.forEach(n=>{n.initialAngle=EM(n,i)-e,n.lastAngle=EM(n,i)-e})}_emitEvent(e,i,n){const r=fI(this._activePointerMap);this._drag.emit(this._createPayload(e,i,r,n),void 0,this._startStateModifiers)}_handlePointerUpAndPointerLost(e){const i=e.data.native.pointerId,n=e.timestamp;this._activePointerMap.get(i)&&(this._activePointerMap.size===1?(this._updatePointer(e.data),!this._isCurrentDragSuppressed&&this._emitEvent("end",e.data,n),this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._removePointer(i)):(this._removePointer(i),this._emitEvent("removed",e.data,e.timestamp)))}_handlePointerDrag(e){const i=e.data,n=i.currentEvent,r=e.timestamp;switch(i.action){case"start":case"update":this._isDragging?this._activePointerMap.has(n.native.pointerId)?(this._updatePointer(n),!this._isCurrentDragSuppressed&&this._emitEvent("update",n,r)):(this._addPointer(n),this._emitEvent("added",n,r),this._isCurrentDragSuppressed=this._isSuppressed):(this._updatePointer(n),this._pointerType=e.data.startEvent.pointerType,this._mouseButton=e.data.startEvent.button,this._startStateModifiers=e.modifiers,this._isDragging=!0,this._isCurrentDragSuppressed=this._isSuppressed,!this._isCurrentDragSuppressed&&this._emitEvent("start",n,r))}}get _isSuppressed(){return!!this._navigationTouch&&!this._navigationTouch.browserTouchPanEnabled&&this._pointerType==="touch"&&this._activePointerMap.size===1}};function vse(t){const e=[];return t.forEach(i=>{e.push(As(i.event.x,i.event.y))}),$Pe(e)}function fI(t){const e=vse(t);let i=0;return t.forEach(n=>{let r=EM(n,e),s=r-n.lastAngle;for(;s>Math.PI;)s-=2*Math.PI;for(;s<-Math.PI;)s+=2*Math.PI;r=n.lastAngle+s,n.lastAngle=r;const o=r-n.initialAngle;i+=o}),i/=t.size||1,{angle:i,radius:e.radius,center:e.center}}function LPe(t){const e=new Map;return t.forEach((i,n)=>e.set(n,i.event)),e}function EM(t,e){const i=t.event,n=i.x-e.center.x,r=i.y-e.center.y;return Math.atan2(r,n)}var L7;(function(t){t[t.Left=0]="Left",t[t.Middle=1]="Middle",t[t.Right=2]="Right",t[t.Back=3]="Back",t[t.Forward=4]="Forward",t[t.Undefined=-1]="Undefined"})(L7||(L7={}));let RPe=class extends Sr{constructor(e=sl.maximumDoubleClickDelay,i=sl.maximumDoubleClickDistance,n=sl.maximumDoubleTouchDelay,r=sl.maximumDoubleTouchDistance,s=Pb){super(!1),this._maximumDoubleClickDelay=e,this._maximumDoubleClickDistance=i,this._maximumDoubleTouchDelay=n,this._maximumDoubleTouchDistance=r,this._clock=s,this._pointerState=new Map,this._immediateDoubleClick=this.registerOutgoing("immediate-double-click"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUp.bind(this))}onUninstall(){this._pointerState.forEach(e=>{e.immediateDoubleClick&&e.immediateDoubleClick.timeoutHandle.remove()}),super.onUninstall()}_handlePointerDown(e){const i=e.data,n=by(i);if(!this._pointerState.has(n)){const r={downButton:i.native.button,immediateDoubleClick:null};this._pointerState.set(n,r),this.startCapturingPointer(i.native)}}_handlePointerUp(e){const i=e.data,n=by(i),r=this._pointerState.get(n);if(r&&r.downButton===i.native.button){const s=r.immediateDoubleClick;if(s){s.timeoutHandle.remove();const o=e.data.native.pointerType==="touch"?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;zV(s,e.data)>o?this._startImmediateDoubleClick(e,r):(this._immediateDoubleClick.emit(e.data,void 0,s.modifiers),this._removeState(i))}else this._startImmediateDoubleClick(e,r)}}_startImmediateDoubleClick(e,i){const n=e.data.native.pointerType==="touch"?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay;i.immediateDoubleClick={x:e.data.x,y:e.data.y,modifiers:e.modifiers,timeoutHandle:this._clock.setTimeout(()=>this._removeState(e.data),n)}}_removeState(e){const i=by(e);this._pointerState.delete(i),this.stopCapturingPointer(e.native),this.refreshHasPendingInputs()}};const E1={maximumClickDelay:300,movementUntilMouseDrag:1.5,movementUntilPenDrag:6,movementUntilTouchDrag:6,holdDelay:500};let DPe=class extends Sr{constructor(e=E1.maximumClickDelay,i=E1.movementUntilMouseDrag,n=E1.movementUntilPenDrag,r=E1.movementUntilTouchDrag,s=E1.holdDelay,o=Pb){super(!1),this._maximumClickDelay=e,this._movementUntilMouseDrag=i,this._movementUntilPenDrag=n,this._movementUntilTouchDrag=r,this._holdDelay=s,this._clock=o,this._pointerState=new Map,this._pointerDrag=this.registerOutgoing("pointer-drag"),this._immediateClick=this.registerOutgoing("immediate-click"),this._pointerHold=this.registerOutgoing("hold"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",a=>{this._handlePointerLoss(a,"pointer-up")}),this.registerIncoming("pointer-capture-lost",a=>{this._handlePointerLoss(a,"pointer-capture-lost")}),this.registerIncoming("pointer-cancel",a=>{this._handlePointerLoss(a,"pointer-cancel")}),this._moveHandle=this.registerIncoming("pointer-move",this._handlePointerMove.bind(this)),this._moveHandle.pause()}onUninstall(){this._pointerState.forEach(e=>{e.holdTimeout=Ri(e.holdTimeout)}),super.onUninstall()}_handlePointerDown(e){const i=e.data,n=i.native.pointerId;let r=null;this._pointerState.size===0&&(r=this._clock.setTimeout(()=>{const o=this._pointerState.get(n);if(o){if(!o.isDragging){const a=o.previousEvent;this._pointerHold.emit(a,void 0,e.modifiers),o.holdEmitted=!0}o.holdTimeout=null}},this._holdDelay));const s={startEvent:i,previousEvent:i,startTimestamp:e.timestamp,isDragging:!1,downButton:i.native.button,holdTimeout:r,modifiers:new Set};this._pointerState.set(n,s),this.startCapturingPointer(i.native),this._moveHandle.resume(),this._pointerState.size>1&&this._startDragging(e)}_createPointerDragData(e,i,n){return{action:e,startEvent:i.startEvent,previousEvent:i.previousEvent,currentEvent:n}}_handlePointerMove(e){const i=e.data,n=i.native.pointerId,r=this._pointerState.get(n);r&&(r.isDragging?this._pointerDrag.emit(this._createPointerDragData("update",r,i),void 0,r.modifiers):APe(i,r.startEvent)>this._getDragThreshold(i.native.pointerType)&&this._startDragging(e),r.previousEvent=i)}_getDragThreshold(e){switch(e){case"touch":return this._movementUntilTouchDrag;case"pen":return this._movementUntilPenDrag;default:return this._movementUntilMouseDrag}}_startDragging(e){const i=e.data,n=i.native.pointerId;this._pointerState.forEach(r=>{r.holdTimeout!=null&&(r.holdTimeout.remove(),r.holdTimeout=null),r.isDragging||(r.modifiers=e.modifiers,r.isDragging=!0,n===r.startEvent.native.pointerId?this._pointerDrag.emit(this._createPointerDragData("start",r,i)):this._pointerDrag.emit(this._createPointerDragData("start",r,r.previousEvent),e.timestamp))})}_handlePointerLoss(e,i){const n=e.data,r=n.native.pointerId,s=this._pointerState.get(r);s&&(s.holdTimeout!=null&&(s.holdTimeout.remove(),s.holdTimeout=null),s.isDragging?this._pointerDrag.emit(this._createPointerDragData("end",s,i==="pointer-up"?n:s.previousEvent),void 0,s.modifiers):i==="pointer-up"&&s.downButton===n.native.button&&e.timestamp-s.startTimestamp<=this._maximumClickDelay&&!s.holdEmitted&&this._immediateClick.emit(n),this._pointerState.delete(r),this.stopCapturingPointer(n.native),this._pointerState.size===0&&this._moveHandle.pause())}};const mI={counter:"Ctrl",pan:{left:"ArrowLeft",right:"ArrowRight",up:"ArrowUp",down:"ArrowDown"},zoom:{zoomIn:["=","+"],zoomOut:["-","_"]},rotate:{clockwiseOption1:"a",clockwiseOption2:"A",counterClockwiseOption1:"d",counterClockwiseOption2:"D",resetOption1:"n",resetOption2:"N"}};let Ym=class extends ye{constructor(){super(...arguments),this._handles=new Rs}initialize(){const e=()=>{var i;return(i=this.view)==null?void 0:i.ready};this._handles.add([jo(()=>!e(),()=>this._disconnect()),jo(e,()=>this._connect())])}destroy(){this._handles=Je(this._handles),this._disconnect()}get latestPointerType(){var e;return(e=this._inputManager)==null?void 0:e.latestPointerType}get latestPointerLocation(){var e;return(e=this._inputManager)==null?void 0:e.latestPointerLocation}get multiTouchActive(){var e;return((e=this._inputManager)==null?void 0:e.multiTouchActive)??!1}_disconnect(){this.view.viewEvents.disconnect(),this._inputManager=Je(this._inputManager)}_connect(){const e=this.view.surface,i=new gse(e,this.view.input),n=[new RPe,new DPe,new PPe,new OPe(this.view.navigation),new kPe],r=new za({eventSource:i,recognizers:n});r.installHandlers("prevent-context-menu",[new EPe],gi.INTERNAL),r.installHandlers("navigation",[new bPe(this.view),new hPe(this.view),new _Pe(this.view),new $7(this.view),new $7(this.view,[mI.counter]),new oPe(this.view,"primary"),new mPe(this.view,mI.pan),new yPe(this.view,mI.zoom),new gPe(this.view,mI.rotate),new aPe(this.view,"secondary"),new sPe(this.view,"touch")],gi.INTERNAL),this.view.viewEvents.connect(r),this._source=i,this._inputManager=r,Q(()=>{var s,o;return(o=(s=this.view)==null?void 0:s.navigation)==null?void 0:o.browserTouchPanEnabled},s=>{this._source&&(this._source.browserTouchPanningEnabled=!s)},He)}get test(){return{inputManager:this._inputManager}}};h([p()],Ym.prototype,"view",void 0),h([p()],Ym.prototype,"latestPointerType",null),h([p()],Ym.prototype,"latestPointerLocation",null),h([p()],Ym.prototype,"multiTouchActive",null),Ym=h([P("esri.views.2d.input.MapViewInputManager")],Ym);const NPe=Ym;var dht=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function VV(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var R7,D7,N7,ED={exports:{}};ED.exports,R7=ED,D7=function(){function t(r,s,o,a,l){e(r,s,o||0,a||r.length-1,l||n)}function e(r,s,o,a,l){for(;a>o;){if(a-o>600){var c=a-o+1,u=s-o+1,d=Math.log(c),f=.5*Math.exp(2*d/3),m=.5*Math.sqrt(d*f*(c-f)/c)*(u-c/2<0?-1:1);e(r,s,Math.max(o,Math.floor(s-u*f/c+m)),Math.min(a,Math.floor(s+(c-u)*f/c+m)),l)}var g=r[s],y=o,_=a;for(i(r,o,s),l(r[a],g)>0&&i(r,o,a);y<_;){for(i(r,y,_),y++,_--;l(r[y],g)<0;)y++;for(;l(r[_],g)>0;)_--}l(r[o],g)===0?i(r,o,_):i(r,++_,a),_<=s&&(o=_+1),s<=_&&(a=_-1)}}function i(r,s,o){var a=r[s];r[s]=r[o],r[o]=a}function n(r,s){return r<s?-1:r>s?1:0}return t},(N7=D7())!==void 0&&(R7.exports=N7);const FPe=VV(ED.exports);function IA(t,e){if(!(this instanceof IA))return new IA(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&(typeof e=="function"?this.toBBox=e:this._initFormat(e)),this.clear()}function zPe(t,e,i){if(!i)return e.indexOf(t);for(var n=0;n<e.length;n++)if(i(t,e[n]))return n;return-1}function P0(t,e){jw(t,0,t.children.length,e,t)}function jw(t,e,i,n,r){r||(r=vv(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(var s,o=e;o<i;o++)s=t.children[o],Bw(r,t.leaf?n(s):s);return r}function Bw(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function F7(t,e){return t.minX-e.minX}function z7(t,e){return t.minY-e.minY}function q3(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function gI(t){return t.maxX-t.minX+(t.maxY-t.minY)}function VPe(t,e){return(Math.max(e.maxX,t.maxX)-Math.min(e.minX,t.minX))*(Math.max(e.maxY,t.maxY)-Math.min(e.minY,t.minY))}function jPe(t,e){var i=Math.max(t.minX,e.minX),n=Math.max(t.minY,e.minY),r=Math.min(t.maxX,e.maxX),s=Math.min(t.maxY,e.maxY);return Math.max(0,r-i)*Math.max(0,s-n)}function W3(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function yI(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function vv(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function V7(t,e,i,n,r){for(var s,o=[e,i];o.length;)(i=o.pop())-(e=o.pop())<=n||(s=e+Math.ceil((i-e)/n/2)*n,FPe(t,s,e,i,r),o.push(e,s,s,i))}IA.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,i=[],n=this.toBBox;if(!yI(t,e))return i;for(var r,s,o,a,l=[];e;){for(r=0,s=e.children.length;r<s;r++)o=e.children[r],yI(t,a=e.leaf?n(o):o)&&(e.leaf?i.push(o):W3(t,a)?this._all(o,i):l.push(o));e=l.pop()}return i},collides:function(t){var e=this.data,i=this.toBBox;if(!yI(t,e))return!1;for(var n,r,s,o,a=[];e;){for(n=0,r=e.children.length;n<r;n++)if(s=e.children[n],yI(t,o=e.leaf?i(s):s)){if(e.leaf||W3(t,o))return!0;a.push(s)}e=a.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,i=t.length;e<i;e++)this.insert(t[e]);return this}var n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var r=this.data;this.data=n,n=r}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=vv([]),this},remove:function(t,e){if(!t)return this;for(var i,n,r,s,o=this.data,a=this.toBBox(t),l=[],c=[];o||l.length;){if(o||(o=l.pop(),n=l[l.length-1],i=c.pop(),s=!0),o.leaf&&(r=zPe(t,o.children,e))!==-1)return o.children.splice(r,1),l.push(o),this._condense(l),this;s||o.leaf||!W3(o,a)?n?(i++,o=n.children[i],s=!1):o=null:(l.push(o),c.push(i),i=0,n=o,o=o.children[0])}return this},toBBox:function(t){return t},compareMinX:F7,compareMinY:z7,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var i=[];t;)t.leaf?e.push.apply(e,t.children):i.push.apply(i,t.children),t=i.pop();return e},_build:function(t,e,i,n){var r,s=i-e+1,o=this._maxEntries;if(s<=o)return P0(r=vv(t.slice(e,i+1)),this.toBBox),r;n||(n=Math.ceil(Math.log(s)/Math.log(o)),o=Math.ceil(s/Math.pow(o,n-1))),(r=vv([])).leaf=!1,r.height=n;var a,l,c,u,d=Math.ceil(s/o),f=d*Math.ceil(Math.sqrt(o));for(V7(t,e,i,f,this.compareMinX),a=e;a<=i;a+=f)for(V7(t,a,c=Math.min(a+f-1,i),d,this.compareMinY),l=a;l<=c;l+=d)u=Math.min(l+d-1,c),r.children.push(this._build(t,l,u,n-1));return P0(r,this.toBBox),r},_chooseSubtree:function(t,e,i,n){for(var r,s,o,a,l,c,u,d;n.push(e),!e.leaf&&n.length-1!==i;){for(u=d=1/0,r=0,s=e.children.length;r<s;r++)l=q3(o=e.children[r]),(c=VPe(t,o)-l)<d?(d=c,u=l<u?l:u,a=o):c===d&&l<u&&(u=l,a=o);e=a||e.children[0]}return e},_insert:function(t,e,i){var n=this.toBBox,r=i?t:n(t),s=[],o=this._chooseSubtree(r,this.data,e,s);for(o.children.push(t),Bw(o,r);e>=0&&s[e].children.length>this._maxEntries;)this._split(s,e),e--;this._adjustParentBBoxes(r,s,e)},_split:function(t,e){var i=t[e],n=i.children.length,r=this._minEntries;this._chooseSplitAxis(i,r,n);var s=this._chooseSplitIndex(i,r,n),o=vv(i.children.splice(s,i.children.length-s));o.height=i.height,o.leaf=i.leaf,P0(i,this.toBBox),P0(o,this.toBBox),e?t[e-1].children.push(o):this._splitRoot(i,o)},_splitRoot:function(t,e){this.data=vv([t,e]),this.data.height=t.height+1,this.data.leaf=!1,P0(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,i){var n,r,s,o,a,l,c,u;for(l=c=1/0,n=e;n<=i-e;n++)o=jPe(r=jw(t,0,n,this.toBBox),s=jw(t,n,i,this.toBBox)),a=q3(r)+q3(s),o<l?(l=o,u=n,c=a<c?a:c):o===l&&a<c&&(c=a,u=n);return u},_chooseSplitAxis:function(t,e,i){var n=t.leaf?this.compareMinX:F7,r=t.leaf?this.compareMinY:z7;this._allDistMargin(t,e,i,n)<this._allDistMargin(t,e,i,r)&&t.children.sort(n)},_allDistMargin:function(t,e,i,n){t.children.sort(n);var r,s,o=this.toBBox,a=jw(t,0,e,o),l=jw(t,i-e,i,o),c=gI(a)+gI(l);for(r=e;r<i-e;r++)s=t.children[r],Bw(a,t.leaf?o(s):s),c+=gI(a);for(r=i-e-1;r>=e;r--)s=t.children[r],Bw(l,t.leaf?o(s):s),c+=gI(l);return c},_adjustParentBBoxes:function(t,e,i){for(var n=i;n>=0;n--)Bw(e[n],t)},_condense:function(t){for(var e,i=t.length-1;i>=0;i--)t[i].children.length===0?i>0?(e=t[i-1].children).splice(e.indexOf(t[i]),1):this.clear():P0(t[i],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}};var AD;const j7=new qe({upperLeft:"upper-left",lowerLeft:"lower-left"});let Xm=AD=class extends ie{constructor(t){super(t),this.extent=null,this.mode="view",this.originPosition="upper-left",this.tolerance=1}clone(){return new AD(q({extent:this.extent,mode:this.mode,originPosition:this.originPosition,tolerance:this.tolerance}))}};h([p({type:Le,json:{write:{overridePolicy(){return{enabled:this.mode==="view"}}}}})],Xm.prototype,"extent",void 0),h([p({type:["view","edit"],json:{write:!0}})],Xm.prototype,"mode",void 0),h([p({type:String,json:{read:j7.read,write:j7.write}})],Xm.prototype,"originPosition",void 0),h([p({type:Number,json:{write:{overridePolicy(){return{enabled:this.mode==="view"}}}}})],Xm.prototype,"tolerance",void 0),Xm=AD=h([P("esri.rest.support.QuantizationParameters")],Xm);const _se=Xm;let B7=class bse{constructor(e,i){this.key=new jy(0,0,0,0),this.bounds=wa(),this.objectIds=new Set,this.key.set(i);const n=e.getLODInfoAt(this.key);this.tileInfoView=e,this.tileInfoView.getTileBounds(this.bounds,this.key,!0),this.resolution=n.resolution,this.scale=n.scale,this.level=n.level}get id(){return this.key.id}get extent(){return Le.fromBounds(this.bounds,this.tileInfoView.tileInfo.spatialReference)}get transform(){return{originPosition:"upperLeft",scale:[this.resolution,this.resolution],translate:[this.bounds[0],this.bounds[3]]}}createChildTiles(){const e=this.key.getChildKeys(),i=eo.acquire();for(let n=0;n<e.length;n++)i[n]=new bse(this.tileInfoView,e[n]);return i}getQuantizationParameters(){return _se.fromJSON({mode:"view",originPosition:"upperLeft",tolerance:this.resolution,extent:{xmin:this.bounds[0],ymin:this.bounds[1],xmax:this.bounds[2],ymax:this.bounds[3],spatialReference:this.tileInfoView.tileInfo.spatialReference}})}};const hm={added:[],removed:[]},J3=new Set,BPe=new jy(0,0,0,0);let UPe=class extends Uo{constructor(e){super(),this._tiles=new Map,this._index=IA(9,ee("esri-csp-restrictions")?i=>({minX:i.bounds[0],minY:i.bounds[1],maxX:i.bounds[2],maxY:i.bounds[3]}):[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]),this.tiles=[],this.tileScheme=e}destroy(){this.clear()}clear(){this.tiles.length=0,this._tiles.clear(),this._index.clear()}has(e){return this._tiles.has(e)}get(e){return this._tiles.get(e)}boundsIntersections(e){return this._index.search({minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]})}updateTiles(e){const i={added:[],removed:[]};for(const n of e.added)if(!this.has(n)){const r=new B7(this.tileScheme,n);this._tiles.set(n,r),this._index.insert(r),i.added.push(r)}for(const n of e.removed)if(this.has(n)){const r=this.get(n);this._tiles.delete(n),this._index.remove(r),i.removed.push(r)}this.tiles.length=0,this._tiles.forEach(n=>this.tiles.push(n)),(i.added.length||i.removed.length)&&this.emit("update",i)}setViewState(e){const i=this.tileScheme.getTileCoverage(e,0);if(!i)return;const{spans:n,lodInfo:r}=i,{level:s}=r;if(n.length>0)for(const{row:o,colFrom:a,colTo:l}of n)for(let c=a;c<=l;c++){const u=BPe.set(s,o,r.normalizeCol(c),r.getWorldForColumn(c)).id;if(J3.add(u),!this.has(u)){const d=new B7(this.tileScheme,u);this._tiles.set(u,d),this._index.insert(d),this.tiles.push(d),hm.added.push(d)}}for(let o=this.tiles.length-1;o>=0;o--){const a=this.tiles[o];J3.has(a.id)||(this._tiles.delete(a.id),this.tiles.splice(o,1),this._index.remove(a),hm.removed.push(a))}(hm.added.length||hm.removed.length)&&this.emit("update",hm),Z2.pool.release(i),J3.clear(),hm.added.length=0,hm.removed.length=0}},Km=class extends ye{constructor(){super(...arguments),this.color=new ae([0,255,255]),this.haloOpacity=1,this.fillOpacity=.25}equals(e){return this.color.equals(e.color)&&(this.haloColor||this.color).equals(e.haloColor||e.color)&&this.haloOpacity===e.haloOpacity&&this.fillOpacity===e.fillOpacity}};h([p({type:ae})],Km.prototype,"color",void 0),h([p({type:ae})],Km.prototype,"haloColor",void 0),h([p()],Km.prototype,"haloOpacity",void 0),h([p()],Km.prototype,"fillOpacity",void 0),Km=h([P("esri.views.2d.support.HighlightOptions")],Km);const wse=Km,GPe=t=>t.includes("Brush");let xse=class{constructor(){this._names=new Map}begin(e){this._names.has(e)||(this._names.set(e,!1),GPe(e)&&this.record("Esri.FirstDraw"),performance.mark(`Esri.${e}.Start`))}end(e){this._names.has(e)&&!this._names.get(e)&&(this._names.set(e,!0),performance.mark(`Esri.${e}.End`))}record(e){this._names.has(e)||(this._names.set(e,!0),performance.mark(`Esri.${e}`))}};function HPe(t,e,i,n,r,s,o,a){t.ignorePadding&&(n={left:0,right:0,top:0,bottom:0});let l=null;t.width!=null&&t.height!=null?l=[t.width,t.height]:t.width==null&&t.height!=null?l=[t.height,t.height]:t.width!=null&&t.height==null?l=[t.width,t.width]:t.width==null&&t.height==null&&(l=null);const c=i[0]-(n.left+n.right),u=i[1]-(n.top+n.bottom);let d,f,m=t.area||{x:0,y:0,width:c,height:u};if(l){const g=c/u,y=l[0]/l[1];if(y>g){const _=m.width/y;m={x:m.x,y:Math.round(m.y+(m.height-_)/2),width:m.width,height:Math.round(_)}}else{const _=m.height*y;m={x:Math.round(m.x+(m.width-_)/2),y:m.y,width:Math.round(_),height:m.height}}}else l=[m.width,m.height];return l[0]>m.width?(d=Math.min(l[0]/m.width,e),f=l[0]/m.width/d):(d=1,f=l[0]/m.width),{resolutionScale:d,cropArea:{x:Math.round((m.x+n.left)*d),y:Math.round((m.y+n.top)*d),width:Math.round(m.width*d),height:Math.round(m.height*d)},outputScale:f,format:r,quality:s,children:o,rotation:a}}function qPe(t,e,i){const{ctx:n,canvas:r}=Sse(t,i),s=n.getImageData(0,0,t.width,t.height),o=ZPe(r,e);return Tse(r),{dataUrl:o,data:s}}function WPe(t,e){const{ctx:i,canvas:n}=Sse(t,e),r=i.getImageData(0,0,t.width,t.height);return Tse(n),r}function Sse(t,e){const i=JPe();e.premultipliedAlpha&&eke(t),i.width=t.width,i.height=t.height;const n=i.getContext("2d",{willReadFrequently:!0});return n.putImageData(t,0,0),e.flipY&&QPe(n),{ctx:n,canvas:i}}function Tse(t){t.width=0,t.height=0}function JPe(){return Z3==null&&(Z3=document.createElement("canvas")),Z3}let Z3=null;function ZPe(t,e){const i=tke[e.format],n=e.quality/100;return t.toDataURL(i,n)}function YPe(t,e){const i=KPe(t),n=nke[i];return{format:i,quality:rr(e??n,0,100)}}function XPe(t,e){return e/Math.max(t[0],t[1])}function ght(t,e,i,n=0,r=0,s=t.width-n,o=t.height-r,a=!1){const{data:l}=t,{width:c,height:u,data:d}=e,f=s/c,m=o/u,g=Math.ceil(f/2),y=Math.ceil(m/2),_=t.width;for(let b=0;b<u;b++)for(let w=0;w<c;w++){const x=4*(w+(a?u-b-1:b)*c);let S=0,T=0,I=0,C=0,M=0,E=0;const A=(b+.5)*m;for(let $=Math.floor(b*m);$<(b+1)*m;$++){const L=Math.abs(A-($+.5))/y,D=(w+.5)*f,F=L*L;for(let z=Math.floor(w*f);z<(w+1)*f;z++){const U=Math.abs(D-(z+.5))/g,G=Math.sqrt(F+U*U);if(G>=1)continue;let W=2*G*G*G-3*G*G+1;const Z=4*(n+z+(r+$)*_);E+=W*l[Z+3],T+=W,!i&&l[Z+3]<255&&(W=W*l[Z+3]/255),I+=W*l[Z],C+=W*l[Z+1],M+=W*l[Z+2],S+=W}}d[x]=I/S,d[x+1]=C/S,d[x+2]=M/S,d[x+3]=E/T}return e}function KPe(t){switch(t){case"png":case"jpg":case"jpeg":return t;default:return ike}}function QPe(t){t.save(),t.globalCompositeOperation="copy",t.scale(1,-1),t.translate(0,-t.canvas.height),t.drawImage(t.canvas,0,0),t.restore()}function eke(t){const e=t.data,i=e.length;for(let n=0;n<i;n+=4){const r=e[n+3];if(r!==255&&r>0){const s=255/r;e[n]=e[n]*s,e[n+1]=e[n+1]*s,e[n+2]=e[n+2]*s}}}const tke={png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg"},U7=98,ike="png",nke={png:100,jpg:U7,jpeg:U7};var Qn;function $D(t,e,i={}){const n=e===Qn.WEBGL1?["webgl","experimental-webgl","webkit-3d","moz-webgl"]:["webgl2"];for(const r of n){const s=t.getContext(r,i);if(s)return s}return null}function yht(t,e,i={}){const n=Ise(t);for(const r of n){const s=$D(e,r,i);if(s)return s}return null}function Ise(t){if(t==="3d")return[Qn.WEBGL2];const e=ee("esri-force-webgl");return e===Qn.WEBGL1||e===Qn.WEBGL2?[e]:ee("mac")&&ee("chrome")?[Qn.WEBGL1,Qn.WEBGL2]:[Qn.WEBGL2,Qn.WEBGL1]}(function(t){t[t.WEBGL1=1]="WEBGL1",t[t.WEBGL2=2]="WEBGL2"})(Qn||(Qn={}));let Y3,X3;function rke(t){const e=Ise(t);for(;e.length>1;){const i=G7(e.shift());if(i.available)return i}return G7(e.shift())}function G7(t){switch(t){case Qn.WEBGL1:return ske();case Qn.WEBGL2:return oke()}}function ske(){return Y3||(Y3=cke()),Y3}function oke(){return X3||(X3=uke()),X3}let Cse=class{constructor(){this.available=!1,this.majorPerformanceCaveat=!1,this.maxTextureSize=0,this.supportsVertexShaderSamplers=!1,this.supportsHighPrecisionFragment=!1,this.supportsElementIndexUint=!1,this.supportsStandardDerivatives=!1,this.supportsInstancedArrays=!1,this.supportsTextureFloat=!1,this.supportsTextureHalfFloat=!1,this.supportsColorBufferFloat=!1,this.supportsColorBufferFloatBlend=!1,this.supportsColorBufferHalfFloat=!1}},ake=class extends Cse{constructor(){super(...arguments),this.type=Qn.WEBGL1}},lke=class extends Cse{constructor(){super(...arguments),this.type=Qn.WEBGL2,this.supportsElementIndexUint=!0,this.supportsStandardDerivatives=!0,this.supportsInstancedArrays=!0,this.supportsTextureFloat=!0,this.supportsTextureHalfFloat=!0}};function Mse(t,e){if(t===Qn.WEBGL1&&typeof WebGLRenderingContext>"u"||t===Qn.WEBGL2&&typeof WebGL2RenderingContext>"u")return null;const i=document.createElement("canvas");if(!i)return null;let n=$D(i,t,{failIfMajorPerformanceCaveat:!0});if(n==null&&(n=$D(i,t),n!=null&&(e.majorPerformanceCaveat=!0)),n==null)return n;if(t===Qn.WEBGL1){const s=n.getParameter(n.VERSION),o=s==null?void 0:s.match(/^WebGL\s+([\d.]*)/);if(o){const a=parseFloat(o[1]);e.available=a>=.94}}else e.available=!0;e.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE),e.supportsVertexShaderSamplers=n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS)>0;const r=n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT);return r&&(e.supportsHighPrecisionFragment=r.precision>0),n}function cke(){const t=new ake,e=Mse(Qn.WEBGL1,t);return e==null||(t.supportsElementIndexUint=e.getExtension("OES_element_index_uint")!==null,t.supportsStandardDerivatives=e.getExtension("OES_standard_derivatives")!==null,t.supportsInstancedArrays=e.getExtension("ANGLE_instanced_arrays")!==null,t.supportsTextureFloat=e.getExtension("OES_texture_float")!==null,t.supportsTextureHalfFloat=e.getExtension("OES_texture_half_float")!==null,t.supportsColorBufferFloat=e.getExtension("WEBGL_color_buffer_float")!==null,t.supportsColorBufferFloatBlend=e.getExtension("EXT_float_blend")!==null,t.supportsColorBufferHalfFloat=e.getExtension("EXT_color_buffer_half_float")!==null),t}function uke(){const t=new lke,e=Mse(Qn.WEBGL2,t);return e==null||(t.supportsColorBufferFloat=e.getExtension("EXT_color_buffer_float")!==null,t.supportsColorBufferFloatBlend=e.getExtension("EXT_float_blend")!==null,t.supportsColorBufferHalfFloat=t.supportsColorBufferFloat||e.getExtension("EXT_color_buffer_half_float")!==null),t}function hke(t){const e=rke(t);if(!e.available)return new V("webgl:required",t==="3d"?"WebGL2 is required but not supported.":"WebGL is required but not supported.",new Error().stack);if(t==="3d"&&e.majorPerformanceCaveat)return new V("webgl:major-performance-caveat-detected","Your WebGL implementation doesn't seem to support hardware accelerated rendering. Check your browser settings or if your GPU is in a blocklist.");if(!e.supportsHighPrecisionFragment)return new V("webgl:high-precision-fragment-required","WebGL support for high precision fragment shaders is required but not supported.");if(!e.supportsVertexShaderSamplers)return new V("webgl:vertex-shader-samplers-required","WebGL support for vertex shader samplers is required but not supported.");if(e.type===Qn.WEBGL1){if(!e.supportsElementIndexUint)return new V("webgl:element-index-uint-required","WebGL support for uint vertex indices is required but not supported.");if(!e.supportsStandardDerivatives)return new V("webgl:standard-derivatives-required","WebGL support for standard derivatives is required but not supported.");if(!e.supportsInstancedArrays)return new V("webgl:instanced-arrays-required","WebGL support for instanced rendering is required but not supported.")}return null}function dke(t){return t&&"nodeType"in t}function pke(t){return t&&typeof t.render=="function"}const H7={component:"esri-component"};let Qm=class extends ye{constructor(){super(...arguments),this.widget=null}destroy(){var e;this.node=null,(e=this.widget)==null||e.destroy()}get id(){return this.get("widget.id")||this.get("node.id")}set node(e){const i=this._get("node");e!==i&&(e&&e.classList.add(H7.component),i&&i.classList.remove(H7.component),this._set("node",e))}castNode(e){var i;return(i=this.widget)==null||i.destroy(),e?typeof e=="string"||dke(e)?(this._set("widget",null),TP(e)):(pke(e)&&!e.domNode&&(e.domNode=document.createElement("div")),this._set("widget",e),e.domNode):(this._set("widget",null),null)}};h([p({dependsOn:[]})],Qm.prototype,"id",null),h([p()],Qm.prototype,"node",null),h([ut("node")],Qm.prototype,"castNode",null),h([p({readOnly:!0})],Qm.prototype,"widget",void 0),Qm=h([P("esri.views.ui.Component")],Qm);const AM=Qm,Ese="calcite-mode-";function fke(){return getComputedStyle(document.body).getPropertyValue("--esri-calcite-mode-name").replaceAll(/\s|'|"/g,"")}function jV(){return fke().startsWith("dark")}function mke(){return`${Ese}${jV()?"dark":"light"}`}function gke(t){yke(t),t.classList.add(mke())}function yke(t){Array.from(t.classList).forEach(e=>{e.startsWith(Ese)&&t.classList.remove(e)})}const vke={left:0,top:0,bottom:0,right:0},Ase={bottom:30,top:15,right:15,left:15},qu="esri-ui",uo={ui:qu,corner:`${qu}-corner`,innerContainer:`${qu}-inner-container`,manualContainer:`${qu}-manual-container`,cornerContainer:`${qu}-corner-container`,topLeft:`${qu}-top-left`,topRight:`${qu}-top-right`,bottomLeft:`${qu}-bottom-left`,bottomRight:`${qu}-bottom-right`};function _ke(t){return t&&!t._started&&typeof t.postMixInProperties=="function"&&typeof t.buildRendering=="function"&&typeof t.postCreate=="function"&&typeof t.startup=="function"}function vI(t){return t===0?"0":`${t}px`}function K3(t){const e=typeof t=="object"&&t!==null&&Object.getPrototypeOf(t);return(e===null||e===Object.prototype)&&("component"in t||"index"in t||"position"in t)?t:null}function Q3(t,{top:e,bottom:i,left:n,right:r}){t.style.top=e,t.style.bottom=i,t.style.left=n,t.style.right=r}let Kc=class extends Uo.EventedAccessor{constructor(e){super(e),this._cornerNameToContainerLookup={},this._positionNameToContainerLookup={},this._components=new Array,this._componentMap=new Map,this._locale=xr(),this.view=null,this._applyViewPadding=()=>{const i=this.container;i&&Q3(i,this._toPixelPosition(this._getViewPadding()))},this._applyUIPadding=()=>{const i=this._innerContainer;i&&Q3(i,this._toPixelPosition(this.padding))},this._initContainers()}initialize(){this.addHandles([Q(()=>{var e;return[(e=this.view)==null?void 0:e.padding,this.container]},this._applyViewPadding,He),Q(()=>this.padding,this._applyUIPadding,He),Q(()=>[this.container,this._locale],([e,i])=>{e&&e.setAttribute("lang",i)},He),FS(e=>{this._locale=e})])}destroy(){this.container=null;for(const e of this._components)e.destroy();this._components.length=0,this._componentMap.clear()}set container(e){const i=this._get("container");e!==i&&(e&&(e.classList.add(uo.ui),gke(e),this._attachContainers(e)),i&&(i.classList.remove(uo.ui),Q3(i,{top:"",bottom:"",left:"",right:""}),Une(i)),this._set("container",e))}get height(){var s;const e=((s=this.view)==null?void 0:s.height)??0;if(e===0)return e;const i=this._getViewPadding(),{top:n,bottom:r}=i;return Math.max(e-n-r,0)}get padding(){return this._get("padding")}set padding(e){this._overrideIfSome("padding",e)}castPadding(e){return typeof e=="number"?{bottom:e,top:e,right:e,left:e}:{...Ase,...e}}get width(){var s;const e=((s=this.view)==null?void 0:s.width)??0;if(e===0)return e;const i=this._getViewPadding(),{left:n,right:r}=i;return Math.max(e-n-r,0)}add(e,i){let n,r,s;if(Array.isArray(e))return void e.forEach(a=>this.add(a,i));const o=K3(e);o&&({index:n,position:i,component:e,key:r}=o),i&&typeof i=="object"&&({index:n,key:r,position:i,internal:s}=i),!e||i&&!this._isValidPosition(i)||this._add(e,i,n,r,s)}remove(e,i){var r;if(!e)return;if(Array.isArray(e))return e.map(s=>this.remove(s,i));const n=this._find(e);if(n){if(this._componentMap.has(e)&&((r=this._componentMap.get(e))==null?void 0:r.key)!==i)return;const s=this._components.indexOf(n),o=n.node.parentNode;return o==null||o.removeChild(n.node),this._componentMap.delete(e),this._components.splice(s,1)[0]}}empty(e,i={removeInternal:!1}){if(Array.isArray(e)){for(const s of e)this.empty(s,i);return}const n=this._positionNameToContainerLookup[e??"manual"],r=Array.prototype.slice.call(n.children).map(s=>this._findByNode(s)).filter(s=>{var o;return s==null?!1:!(((o=this._componentMap.get(s))==null?void 0:o.internal)??!1)||i.removeInternal});for(const s of r)this.remove(s)}move(e,i){if(Array.isArray(e)&&e.forEach(o=>this.move(o,i)),!e)return;let n;const r=K3(e)||K3(i);if(r&&(n=r.index,i=r.position,e=r.component||e),i&&!this._isValidPosition(i))return;const s=this.remove(e);s&&this.add(s,{position:i,index:n})}find(e){if(!e)return null;const i=this._findById(e);return i&&(i.widget||i.node)}getComponents(e,i={includeInternal:!1}){return e?Array.isArray(e)?e.map(n=>this._getComponentsAtPosition(n,i)).flat():this._getComponentsAtPosition(e,i):this._components.filter(n=>{var r;return i.includeInternal||!((r=this._componentMap.get(n))!=null&&r.internal)}).map(({widget:n,node:r})=>n??r)}getPosition(e){for(const i in this._positionNameToContainerLookup)if(this._positionNameToContainerLookup[i].contains(e))return i;return null}_add(e,i,n,r,s){e instanceof AM||(e=new AM({node:e})),this._place({component:e,position:i,index:n}),this._components.push(e),this._componentMap.set(e,{key:r,internal:s})}_find(e){return e?e instanceof AM?this._findByComponent(e):typeof e=="string"?this._findById(e):this._findByNode(e.domNode||e):null}_getViewPadding(){var e;return((e=this.view)==null?void 0:e.padding)??vke}_attachContainers(e){e.appendChild(this._innerContainer),e.appendChild(this._manualContainer)}_initContainers(){const e=document.createElement("div");e.classList.add(uo.innerContainer,uo.cornerContainer);const i=document.createElement("div");i.classList.add(uo.innerContainer,uo.manualContainer);const n=document.createElement("div");n.classList.add(uo.topLeft,uo.corner),e.appendChild(n);const r=document.createElement("div");r.classList.add(uo.topRight,uo.corner),e.appendChild(r);const s=document.createElement("div");s.classList.add(uo.bottomLeft,uo.corner),e.appendChild(s);const o=document.createElement("div");o.classList.add(uo.bottomRight,uo.corner),e.appendChild(o),this._innerContainer=e,this._manualContainer=i;const a=Mc();this._cornerNameToContainerLookup={"top-left":n,"top-right":r,"bottom-left":s,"bottom-right":o,"top-leading":a?r:n,"top-trailing":a?n:r,"bottom-leading":a?o:s,"bottom-trailing":a?s:o},this._positionNameToContainerLookup={manual:i,...this._cornerNameToContainerLookup}}_isValidPosition(e){return!!this._positionNameToContainerLookup[e]}_place(e){const i=e.position??"manual",{component:n,index:r}=e,s=this._positionNameToContainerLookup[i],o=r!=null&&r>-1;if(_ke(n.widget)&&n.widget.startup(),!o)return void s.appendChild(n.node);const a=Array.from(s.children);if(r===0)return void(s.firstChild?jU(n.node,s.firstChild):s.appendChild(n.node));r>=a.length?s.appendChild(n.node):jU(n.node,a[r])}_toPixelPosition(e){return{top:vI(e.top),left:vI(e.left),right:vI(e.right),bottom:vI(e.bottom)}}_findByComponent(e){return this._components.find(i=>i===e)??null}_findById(e){return this._components.find(({id:i})=>i===e)??null}_findByNode(e){return this._components.find(({node:i})=>i===e)??null}_getComponentsAtPosition(e,i){const n=this._positionNameToContainerLookup[e];return Array.prototype.slice.call(n.children).map(r=>this._findByNode(r)).filter(Ti).filter(r=>{var s;return i.includeInternal||!((s=this._componentMap.get(r))!=null&&s.internal)}).map(({widget:r,node:s})=>r??s)}};h([p()],Kc.prototype,"_locale",void 0),h([p()],Kc.prototype,"container",null),h([p()],Kc.prototype,"height",null),h([p({value:Ase})],Kc.prototype,"padding",null),h([ut("padding")],Kc.prototype,"castPadding",null),h([p()],Kc.prototype,"view",void 0),h([p()],Kc.prototype,"width",null),Kc=h([P("esri.views.ui.UI")],Kc);const bke=Kc,wke="randomUUID"in crypto;function BV(){if(wke)return crypto.randomUUID();const t=crypto.getRandomValues(new Uint16Array(8));t[3]=4095&t[3]|16384,t[4]=16383&t[4]|32768;const e=i=>t[i].toString(16).padStart(4,"0");return e(0)+e(1)+"-"+e(2)+"-"+e(3)+"-"+e(4)+"-"+e(5)+e(6)+e(7)}function Sht(){return`{${BV()}}`}const xke={handleInterceptedEvent:(t,e,i,n)=>(t.scheduleRender(),e.properties[`on${n.type}`].apply(e.properties.bind||i,[n]))},Ske={namespace:void 0,performanceLogger:()=>{},eventHandlerInterceptor:void 0,styleApplyer:(t,e,i)=>{t.style[e]=i}},Tke=t=>({...Ske,...t}),Ike=(t,e)=>{const i=[];for(;t&&t!==e;)i.push(t),t=t.parentNode;return i},Cke=(t,e)=>t.find(e),q7=(t,e,i=!1)=>{let n=t;return e.forEach((r,s)=>{const o=n!=null&&n.children?Cke(n.children,a=>a.domNode===r):void 0;i&&!o&&s!==e.length-1||(n=o)}),n},Mke=t=>{let e;const i={...xke,...t},n=Tke(i),r=n.performanceLogger;let s,o=!0,a=!1;const l=[],c=[],u=(f,m,g)=>{var b;let y;n.eventHandlerInterceptor=(w,x,S,T)=>function(I){let C;r("domEvent",I);const M=Ike(I.currentTarget,y.domNode),E=M.some($=>{var L;return customElements.get((L=$==null?void 0:$.tagName)==null?void 0:L.toLowerCase())});if(I.eventPhase===Event.CAPTURING_PHASE||!E)M.reverse(),C=q7(y.getLastRender(),M);else{const $=I.composedPath(),L=$.slice($.indexOf(I.currentTarget),$.indexOf(y.domNode)).filter(D=>D.getRootNode()===D.ownerDocument).reverse();C=q7(y.getLastRender(),L,!0)}let A;return C&&(A=i.handleInterceptedEvent(e,C,this,I)),r("domEventProcessed",I),A},(b=i.postProcessProjectionOptions)==null||b.call(i,n);const _=g();y=f(m,_,n),l.push(y),c.push(g),i.afterFirstVNodeRendered&&i.afterFirstVNodeRendered(y,_)};let d=()=>{if(s=void 0,o){o=!1,r("renderStart",void 0);for(let f=0;f<l.length;f++){const m=c[f]();r("rendered",void 0),l[f].update(m),r("patched",void 0)}r("renderDone",void 0),o=!0}};return i.modifyDoRenderImplementation&&(d=i.modifyDoRenderImplementation(d,l,c)),e={renderNow:d,scheduleRender:()=>{s||a||(s=requestAnimationFrame(d))},stop:()=>{s&&(cancelAnimationFrame(s),s=void 0),a=!0},resume:()=>{a=!1,o=!0,e.scheduleRender()},append:(f,m)=>{u(hf.append,f,m)},insertBefore:(f,m)=>{u(hf.insertBefore,f,m)},merge:(f,m)=>{u(hf.merge,f,m)},replace:(f,m)=>{u(hf.replace,f,m)},detach:f=>{for(let m=0;m<c.length;m++)if(c[m]===f)return c.splice(m,1),l.splice(m,1)[0];throw new Error("renderFunction was not found")}},e},_v={allRenderFn:!1,cmpDidLoad:!0,cmpDidUnload:!1,cmpDidUpdate:!0,cmpDidRender:!0,cmpWillLoad:!0,cmpWillUpdate:!0,cmpWillRender:!0,connectedCallback:!0,disconnectedCallback:!0,element:!0,event:!0,hasRenderFn:!0,lifecycle:!0,hostListener:!0,hostListenerTargetWindow:!0,hostListenerTargetDocument:!0,hostListenerTargetBody:!0,hostListenerTargetParent:!1,hostListenerTarget:!0,member:!0,method:!0,mode:!0,observeAttribute:!0,prop:!0,propMutable:!0,reflect:!0,scoped:!0,shadowDom:!0,slot:!0,cssAnnotations:!0,state:!0,style:!0,svg:!0,updatable:!0,vdomAttribute:!0,vdomXlink:!0,vdomClass:!0,vdomFunctional:!0,vdomKey:!0,vdomListener:!0,vdomRef:!0,vdomPropOrAttr:!0,vdomRender:!0,vdomStyle:!0,vdomText:!0,watchCallback:!0,taskQueue:!0,hotModuleReplacement:!1,isDebug:!1,isDev:!1,isTesting:!1,hydrateServerSide:!1,hydrateClientSide:!1,lifecycleDOMEvents:!1,lazyLoad:!1,profile:!1,slotRelocation:!0,appendChildSlotFix:!1,cloneNodeFix:!1,hydratedAttribute:!1,hydratedClass:!0,safari10:!1,scriptDataOpts:!1,scopedSlotTextContentFix:!1,shadowDomShim:!1,slotChildNodesFix:!1,invisiblePrehydration:!0,propBoolean:!0,propNumber:!0,propString:!0,cssVarShim:!1,constructableCSS:!0,cmpShouldUpdate:!0,devTools:!1,dynamicImportShim:!1,shadowDelegatesFocus:!0,initializeNextTick:!1,asyncLoading:!1,asyncQueue:!1,transformTagName:!1,attachStyles:!0};let bv,$se,DP,Pse=!1,CA=!1,UV=!1,ua=!1,W7=null,PD=!1;const Eke=t=>{const e=new URL(t,Br.$resourcesUrl$);return e.origin!==nT.location.origin?e.href:e.pathname},Ake=t=>Br.$resourcesUrl$=t,By=(t,e="")=>()=>{},J7="http://www.w3.org/1999/xlink",Z7={},$ke="http://www.w3.org/2000/svg",Pke="http://www.w3.org/1999/xhtml",kke=t=>t!=null,GV=t=>(t=typeof t,t==="object"||t==="function");function Oke(t){var e,i,n;return(n=(i=(e=t.head)===null||e===void 0?void 0:e.querySelector('meta[name="csp-nonce"]'))===null||i===void 0?void 0:i.getAttribute("content"))!==null&&n!==void 0?n:void 0}const kse=(t,e,...i)=>{let n=null,r=null,s=null,o=!1,a=!1;const l=[],c=d=>{for(let f=0;f<d.length;f++)n=d[f],Array.isArray(n)?c(n):n!=null&&typeof n!="boolean"&&((o=typeof t!="function"&&!GV(n))&&(n=String(n)),o&&a?l[l.length-1].$text$+=n:l.push(o?MA(null,n):n),a=o)};if(c(i),e){e.key&&(r=e.key),e.name&&(s=e.name);{const d=e.className||e.class;d&&(e.class=typeof d!="object"?d:Object.keys(d).filter(f=>d[f]).join(" "))}}if(typeof t=="function")return t(e===null?{}:e,l,Dke);const u=MA(t,null);return u.$attrs$=e,l.length>0&&(u.$children$=l),u.$key$=r,u.$name$=s,u},MA=(t,e)=>{const i={$flags$:0,$tag$:t,$text$:e,$elm$:null,$children$:null};return i.$attrs$=null,i.$key$=null,i.$name$=null,i},Lke={},Rke=t=>t&&t.$tag$===Lke,Dke={forEach:(t,e)=>t.map(Y7).forEach(e),map:(t,e)=>t.map(Y7).map(e).map(Nke)},Y7=t=>({vattrs:t.$attrs$,vchildren:t.$children$,vkey:t.$key$,vname:t.$name$,vtag:t.$tag$,vtext:t.$text$}),Nke=t=>{if(typeof t.vtag=="function"){const i=Object.assign({},t.vattrs);return t.vkey&&(i.key=t.vkey),t.vname&&(i.name=t.vname),kse(t.vtag,i,...t.vchildren||[])}const e=MA(t.vtag,t.vtext);return e.$attrs$=t.vattrs,e.$children$=t.vchildren,e.$key$=t.vkey,e.$name$=t.vname,e},Fke=t=>h3e.map(e=>e(t)).find(e=>!!e),zke=(t,e)=>t!=null&&!GV(t)?e&4?t==="false"?!1:t===""||!!t:e&2?parseFloat(t):e&1?String(t):t:t,Vke=t=>t,Tht=(t,e,i)=>{const n=Vke(t);return{emit:r=>jke(n,e,{bubbles:!!(i&4),composed:!!(i&2),cancelable:!!(i&1),detail:r})}},jke=(t,e,i)=>{const n=Br.ce(e,i);return t.dispatchEvent(n),n},X7=new WeakMap,Bke=(t,e,i)=>{let n=AA.get(t);f3e&&i?(n=n||new CSSStyleSheet,typeof n=="string"?n=e:n.replaceSync(e)):n=e,AA.set(t,n)},Uke=(t,e,i,n)=>{var r;let s=Ose(e,i);const o=AA.get(s);if(t=t.nodeType===11?t:vc,o)if(typeof o=="string"){t=t.head||t;let a=X7.get(t),l;if(a||X7.set(t,a=new Set),!a.has(s)){{l=vc.createElement("style"),l.innerHTML=o;const c=(r=Br.$nonce$)!==null&&r!==void 0?r:Oke(vc);c!=null&&l.setAttribute("nonce",c),t.insertBefore(l,t.querySelector("link"))}a&&a.add(s)}}else t.adoptedStyleSheets.includes(o)||(t.adoptedStyleSheets=[...t.adoptedStyleSheets,o]);return s},Gke=t=>{const e=t.$cmpMeta$,i=t.$hostElement$,n=e.$flags$,r=By("attachStyles",e.$tagName$),s=Uke(i.shadowRoot?i.shadowRoot:i.getRootNode(),e,t.$modeName$);n&10&&(i["s-sc"]=s,i.classList.add(s+"-h"),n&2&&i.classList.add(s+"-s")),r()},Ose=(t,e)=>"sc-"+(e&&t.$flags$&32?t.$tagName$+"-"+e:t.$tagName$),K7=(t,e,i,n,r,s)=>{if(i!==n){let o=iG(t,e),a=e.toLowerCase();if(e==="class"){const l=t.classList,c=Q7(i),u=Q7(n);l.remove(...c.filter(d=>d&&!u.includes(d))),l.add(...u.filter(d=>d&&!c.includes(d)))}else if(e==="style"){for(const l in i)(!n||n[l]==null)&&(l.includes("-")?t.style.removeProperty(l):t.style[l]="");for(const l in n)(!i||n[l]!==i[l])&&(l.includes("-")?t.style.setProperty(l,n[l]):t.style[l]=n[l])}else if(e!=="key")if(e==="ref")n&&n(t);else if(!t.__lookupSetter__(e)&&e[0]==="o"&&e[1]==="n")e[2]==="-"?e=e.slice(3):iG(nT,a)?e=a.slice(2):e=a[2]+e.slice(3),i&&Br.rel(t,e,i,!1),n&&Br.ael(t,e,n,!1);else{const l=GV(n);if((o||l&&n!==null)&&!r)try{if(t.tagName.includes("-"))t[e]=n;else{const u=n??"";e==="list"?o=!1:(i==null||t[e]!=u)&&(t[e]=u)}}catch{}let c=!1;a!==(a=a.replace(/^xlink\:?/,""))&&(e=a,c=!0),n==null||n===!1?(n!==!1||t.getAttribute(e)==="")&&(c?t.removeAttributeNS(J7,e):t.removeAttribute(e)):(!o||s&4||r)&&!l&&(n=n===!0?"":n,c?t.setAttributeNS(J7,e,n):t.setAttribute(e,n))}}},Hke=/\s/,Q7=t=>t?t.split(Hke):[],Lse=(t,e,i,n)=>{const r=e.$elm$.nodeType===11&&e.$elm$.host?e.$elm$.host:e.$elm$,s=t&&t.$attrs$||Z7,o=e.$attrs$||Z7;for(n in s)n in o||K7(r,n,s[n],void 0,i,e.$flags$);for(n in o)K7(r,n,s[n],o[n],i,e.$flags$)},EA=(t,e,i,n)=>{const r=e.$children$[i];let s=0,o,a,l;if(Pse||(UV=!0,r.$tag$==="slot"&&(bv&&n.classList.add(bv+"-s"),r.$flags$|=r.$children$?2:1)),r.$text$!==null)o=r.$elm$=vc.createTextNode(r.$text$);else if(r.$flags$&1)o=r.$elm$=vc.createTextNode("");else{if(ua||(ua=r.$tag$==="svg"),o=r.$elm$=vc.createElementNS(ua?$ke:Pke,r.$flags$&2?"slot-fb":r.$tag$),ua&&r.$tag$==="foreignObject"&&(ua=!1),Lse(null,r,ua),kke(bv)&&o["s-si"]!==bv&&o.classList.add(o["s-si"]=bv),r.$children$)for(s=0;s<r.$children$.length;++s)a=EA(t,r,s,o),a&&o.appendChild(a);r.$tag$==="svg"?ua=!1:o.tagName==="foreignObject"&&(ua=!0)}return o["s-hn"]=DP,r.$flags$&3&&(o["s-sr"]=!0,o["s-cr"]=$se,o["s-sn"]=r.$name$||"",l=t&&t.$children$&&t.$children$[i],l&&l.$tag$===r.$tag$&&t.$elm$&&Y2(t.$elm$,!1)),o},Y2=(t,e)=>{Br.$flags$|=1;const i=t.childNodes;for(let n=i.length-1;n>=0;n--){const r=i[n];r["s-hn"]!==DP&&r["s-ol"]&&(Nse(r).insertBefore(r,HV(r)),r["s-ol"].remove(),r["s-ol"]=void 0,UV=!0),e&&Y2(r,e)}Br.$flags$&=-2},Rse=(t,e,i,n,r,s)=>{let o=t["s-cr"]&&t["s-cr"].parentNode||t,a;for(o.shadowRoot&&o.tagName===DP&&(o=o.shadowRoot);r<=s;++r)n[r]&&(a=EA(null,i,r,t),a&&(n[r].$elm$=a,o.insertBefore(a,HV(e))))},Dse=(t,e,i,n,r)=>{for(;e<=i;++e)(n=t[e])&&(r=n.$elm$,Vse(n),CA=!0,r["s-ol"]?r["s-ol"].remove():Y2(r,!0),r.remove())},qke=(t,e,i,n)=>{let r=0,s=0,o=0,a=0,l=e.length-1,c=e[0],u=e[l],d=n.length-1,f=n[0],m=n[d],g,y;for(;r<=l&&s<=d;)if(c==null)c=e[++r];else if(u==null)u=e[--l];else if(f==null)f=n[++s];else if(m==null)m=n[--d];else if(_I(c,f))wv(c,f),c=e[++r],f=n[++s];else if(_I(u,m))wv(u,m),u=e[--l],m=n[--d];else if(_I(c,m))(c.$tag$==="slot"||m.$tag$==="slot")&&Y2(c.$elm$.parentNode,!1),wv(c,m),t.insertBefore(c.$elm$,u.$elm$.nextSibling),c=e[++r],m=n[--d];else if(_I(u,f))(c.$tag$==="slot"||m.$tag$==="slot")&&Y2(u.$elm$.parentNode,!1),wv(u,f),t.insertBefore(u.$elm$,c.$elm$),u=e[--l],f=n[++s];else{for(o=-1,a=r;a<=l;++a)if(e[a]&&e[a].$key$!==null&&e[a].$key$===f.$key$){o=a;break}o>=0?(y=e[o],y.$tag$!==f.$tag$?g=EA(e&&e[s],i,o,t):(wv(y,f),e[o]=void 0,g=y.$elm$),f=n[++s]):(g=EA(e&&e[s],i,s,t),f=n[++s]),g&&Nse(c.$elm$).insertBefore(g,HV(c.$elm$))}r>l?Rse(t,n[d+1]==null?null:n[d+1].$elm$,i,n,s,d):s>d&&Dse(e,r,l)},_I=(t,e)=>t.$tag$===e.$tag$?t.$tag$==="slot"?t.$name$===e.$name$:t.$key$===e.$key$:!1,HV=t=>t&&t["s-ol"]||t,Nse=t=>(t["s-ol"]?t["s-ol"]:t).parentNode,wv=(t,e)=>{const i=e.$elm$=t.$elm$,n=t.$children$,r=e.$children$,s=e.$tag$,o=e.$text$;let a;o===null?(ua=s==="svg"?!0:s==="foreignObject"?!1:ua,s==="slot"||Lse(t,e,ua),n!==null&&r!==null?qke(i,n,e,r):r!==null?(t.$text$!==null&&(i.textContent=""),Rse(i,null,e,r,0,r.length-1)):n!==null&&Dse(n,0,n.length-1),ua&&s==="svg"&&(ua=!1)):(a=i["s-cr"])?a.parentNode.textContent=o:t.$text$!==o&&(i.data=o)},Fse=t=>{const e=t.childNodes;let i,n,r,s,o,a;for(n=0,r=e.length;n<r;n++)if(i=e[n],i.nodeType===1){if(i["s-sr"]){for(o=i["s-sn"],i.hidden=!1,s=0;s<r;s++)if(a=e[s].nodeType,e[s]["s-hn"]!==i["s-hn"]||o!==""){if(a===1&&o===e[s].getAttribute("slot")){i.hidden=!0;break}}else if(a===1||a===3&&e[s].textContent.trim()!==""){i.hidden=!0;break}}Fse(i)}},ac=[],zse=t=>{let e,i,n,r,s,o,a=0;const l=t.childNodes,c=l.length;for(;a<c;a++){if(e=l[a],e["s-sr"]&&(i=e["s-cr"])&&i.parentNode)for(n=i.parentNode.childNodes,r=e["s-sn"],o=n.length-1;o>=0;o--)i=n[o],!i["s-cn"]&&!i["s-nr"]&&i["s-hn"]!==e["s-hn"]&&(eG(i,r)?(s=ac.find(u=>u.$nodeToRelocate$===i),CA=!0,i["s-sn"]=i["s-sn"]||r,s?s.$slotRefNode$=e:ac.push({$slotRefNode$:e,$nodeToRelocate$:i}),i["s-sr"]&&ac.map(u=>{eG(u.$nodeToRelocate$,i["s-sn"])&&(s=ac.find(d=>d.$nodeToRelocate$===i),s&&!u.$slotRefNode$&&(u.$slotRefNode$=s.$slotRefNode$))})):ac.some(u=>u.$nodeToRelocate$===i)||ac.push({$nodeToRelocate$:i}));e.nodeType===1&&zse(e)}},eG=(t,e)=>t.nodeType===1?t.getAttribute("slot")===null&&e===""||t.getAttribute("slot")===e:t["s-sn"]===e?!0:e==="",Vse=t=>{t.$attrs$&&t.$attrs$.ref&&t.$attrs$.ref(null),t.$children$&&t.$children$.map(Vse)},Wke=(t,e)=>{const i=t.$hostElement$,n=t.$cmpMeta$,r=t.$vnode$||MA(null,null),s=Rke(e)?e:kse(null,null,e);DP=i.tagName,n.$attrsToReflect$&&(s.$attrs$=s.$attrs$||{},n.$attrsToReflect$.map(([o,a])=>s.$attrs$[a]=i[o])),s.$tag$=null,s.$flags$|=4,t.$vnode$=s,s.$elm$=r.$elm$=i.shadowRoot||i,bv=i["s-sc"],$se=i["s-cr"],Pse=(n.$flags$&1)!==0,CA=!1,wv(r,s);{if(Br.$flags$|=1,UV){zse(s.$elm$);let o,a,l,c,u,d,f=0;for(;f<ac.length;f++)o=ac[f],a=o.$nodeToRelocate$,a["s-ol"]||(l=vc.createTextNode(""),l["s-nr"]=a,a.parentNode.insertBefore(a["s-ol"]=l,a));for(f=0;f<ac.length;f++)if(o=ac[f],a=o.$nodeToRelocate$,o.$slotRefNode$){for(c=o.$slotRefNode$.parentNode,u=o.$slotRefNode$.nextSibling,l=a["s-ol"];l=l.previousSibling;)if(d=l["s-nr"],d&&d["s-sn"]===a["s-sn"]&&c===d.parentNode&&(d=d.nextSibling,!d||!d["s-nr"])){u=d;break}(!u&&c!==a.parentNode||a.nextSibling!==u)&&a!==u&&(!a["s-hn"]&&a["s-ol"]&&(a["s-hn"]=a["s-ol"].parentNode.nodeName),c.insertBefore(a,u))}else a.nodeType===1&&(a.hidden=!0)}CA&&Fse(s.$elm$),Br.$flags$&=-2,ac.length=0}},Jke=(t,e)=>{},qV=(t,e)=>(t.$flags$|=16,Jke(t,t.$ancestorComponent$),y3e(()=>Zke(t,e))),Zke=(t,e)=>{const i=t.$hostElement$,n=By("scheduleUpdate",t.$cmpMeta$.$tagName$),r=i;let s;return e?s=L_(r,"componentWillLoad"):s=L_(r,"componentWillUpdate"),s=tG(s,()=>L_(r,"componentWillRender")),n(),tG(s,()=>Yke(t,r,e))},Yke=async(t,e,i)=>{const n=t.$hostElement$,r=By("update",t.$cmpMeta$.$tagName$);n["s-rc"],i&&Gke(t);const s=By("render",t.$cmpMeta$.$tagName$);Xke(t,e,n),s(),r(),Kke(t)},Xke=(t,e,i)=>{try{W7=e,e=e.render&&e.render(),t.$flags$&=-17,t.$flags$|=2,(_v.hasRenderFn||_v.reflect)&&(_v.vdomRender||_v.reflect)&&(_v.hydrateServerSide||Wke(t,e))}catch(a){iT(a,t.$hostElement$)}return W7=null,null},Kke=t=>{const e=t.$cmpMeta$.$tagName$,i=t.$hostElement$,n=By("postUpdate",e),r=i;t.$ancestorComponent$,L_(r,"componentDidRender"),t.$flags$&64?(L_(r,"componentDidUpdate"),n()):(t.$flags$|=64,L_(r,"componentDidLoad"),n())},Iht=t=>{{const e=tT(t),i=e.$hostElement$.isConnected;return i&&(e.$flags$&18)===2&&qV(e,!1),i}},L_=(t,e,i)=>{if(t&&t[e])try{return t[e](i)}catch(n){iT(n)}},tG=(t,e)=>t&&t.then?t.then(e):e(),Qke=(t,e)=>tT(t).$instanceValues$.get(e),e3e=(t,e,i,n)=>{const r=tT(t),s=t,o=r.$instanceValues$.get(e),a=r.$flags$,l=s;i=zke(i,n.$members$[e][0]);const c=Number.isNaN(o)&&Number.isNaN(i);if(i!==o&&!c){r.$instanceValues$.set(e,i);{if(n.$watchers$&&a&128){const d=n.$watchers$[e];d&&d.map(f=>{try{l[f](i,o,e)}catch(m){iT(m,s)}})}if((a&18)===2){if(l.componentShouldUpdate&&l.componentShouldUpdate(i,o,e)===!1)return;qV(r,!1)}}}},t3e=(t,e,i)=>{if(e.$members$){t.watchers&&(e.$watchers$=t.watchers);const n=Object.entries(e.$members$),r=t.prototype;n.map(([s,[o]])=>{(o&31||o&32)&&Object.defineProperty(r,s,{get(){return Qke(this,s)},set(a){e3e(this,s,a,e)},configurable:!0,enumerable:!0})});{const s=new Map;r.attributeChangedCallback=function(o,a,l){Br.jmp(()=>{const c=s.get(o);if(this.hasOwnProperty(c))l=this[c],delete this[c];else if(r.hasOwnProperty(c)&&typeof this[c]=="number"&&this[c]==l)return;this[c]=l===null&&typeof this[c]=="boolean"?!1:l})},t.observedAttributes=n.filter(([o,a])=>a[0]&15).map(([o,a])=>{const l=a[1]||o;return s.set(l,o),a[0]&512&&e.$attrsToReflect$.push([o,l]),l})}}return t},i3e=async(t,e,i,n,r)=>{if(!(e.$flags$&32)&&(r=t.constructor,e.$flags$|=32,customElements.whenDefined(i.$tagName$).then(()=>e.$flags$|=128),r.style)){let o=r.style;typeof o!="string"&&(o=o[e.$modeName$=Fke(t)]);const a=Ose(i,e.$modeName$);if(!AA.has(a)){const l=By("registerStyles",i.$tagName$);Bke(a,o,!!(i.$flags$&1)),l()}}e.$ancestorComponent$,(()=>qV(e,!0))()},n3e=t=>{},r3e=t=>{if(!(Br.$flags$&1)){const e=tT(t),i=e.$cmpMeta$,n=By("connectedCallback",i.$tagName$);e.$flags$&1?(jse(t,e,i.$listeners$),n3e(e.$lazyInstance$)):(e.$flags$|=1,i.$flags$&12&&s3e(t),i.$members$&&Object.entries(i.$members$).map(([r,[s]])=>{if(s&31&&t.hasOwnProperty(r)){const o=t[r];delete t[r],t[r]=o}}),i3e(t,e,i)),n()}},s3e=t=>{const e=t["s-cr"]=vc.createComment("");e["s-cn"]=!0,t.insertBefore(e,t.firstChild)},o3e=t=>{if(!(Br.$flags$&1)){const e=tT(t);e.$rmListeners$&&(e.$rmListeners$.map(i=>i()),e.$rmListeners$=void 0)}},Cht=(t,e)=>{const i={$flags$:e[0],$tagName$:e[1]};i.$members$=e[2],i.$listeners$=e[3],i.$watchers$=t.$watchers$,i.$attrsToReflect$=[];const n=t.prototype.connectedCallback,r=t.prototype.disconnectedCallback;return Object.assign(t.prototype,{__registerHost(){u3e(this,i)},connectedCallback(){r3e(this),n&&n.call(this)},disconnectedCallback(){o3e(this),r&&r.call(this)},__attachShadow(){this.attachShadow({mode:"open",delegatesFocus:!!(i.$flags$&16)})}}),t.is=i.$tagName$,t3e(t,i)},Mht=(t,e)=>e,jse=(t,e,i,n)=>{i&&i.map(([r,s,o])=>{const a=l3e(t,r),l=a3e(e,o),c=c3e(r);Br.ael(a,s,l,c),(e.$rmListeners$=e.$rmListeners$||[]).push(()=>Br.rel(a,s,l,c))})},a3e=(t,e)=>i=>{try{_v.lazyLoad||t.$hostElement$[e](i)}catch(n){iT(n)}},l3e=(t,e)=>e&4?vc:e&8?nT:e&16?vc.body:t,c3e=t=>d3e?{passive:(t&1)!==0,capture:(t&2)!==0}:(t&2)!==0,Bse=new WeakMap,tT=t=>Bse.get(t),u3e=(t,e)=>{const i={$flags$:0,$hostElement$:t,$cmpMeta$:e,$instanceValues$:new Map};return jse(t,i,e.$listeners$),Bse.set(t,i)},iG=(t,e)=>e in t,iT=(t,e)=>(0,console.error)(t,e),AA=new Map,h3e=[],nT=typeof window<"u"?window:{},vc=nT.document||{head:{}},Eht=nT.HTMLElement||class{},Br={$flags$:0,$resourcesUrl$:"",jmp:t=>t(),raf:t=>requestAnimationFrame(t),ael:(t,e,i,n)=>t.addEventListener(e,i,n),rel:(t,e,i,n)=>t.removeEventListener(e,i,n),ce:(t,e)=>new CustomEvent(t,e)},d3e=(()=>{let t=!1;try{vc.addEventListener("e",null,Object.defineProperty({},"passive",{get(){t=!0}}))}catch{}return t})(),p3e=t=>Promise.resolve(t),f3e=(()=>{try{return new CSSStyleSheet,typeof new CSSStyleSheet().replaceSync=="function"}catch{}return!1})(),nG=[],Use=[],m3e=(t,e)=>i=>{t.push(i),PD||(PD=!0,e&&Br.$flags$&4?g3e(kD):Br.raf(kD))},rG=t=>{for(let e=0;e<t.length;e++)try{t[e](performance.now())}catch(i){iT(i)}t.length=0},kD=()=>{rG(nG),rG(Use),(PD=nG.length>0)&&Br.raf(kD)},g3e=t=>p3e().then(t),y3e=m3e(Use,!0);/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.4.3
 */const Gse="calcite-mode-auto",Hse="calcite-mode-dark",v3e="calcite-mode-light",Aht={autoMode:Gse,darkMode:Hse,lightMode:v3e,rtl:"calcite--rtl",calciteAnimate:"calcite-animate",calciteAnimateIn:"calcite-animate__in",calciteAnimateInUp:"calcite-animate__in-up",calciteAnimateInDown:"calcite-animate__in-down",calciteAnimateInRight:"calcite-animate__in-right",calciteAnimateInLeft:"calcite-animate__in-left",calciteAnimateInScale:"calcite-animate__in-scale"};/*!
* tabbable 6.1.2
* @license MIT, https://github.com/focus-trap/tabbable/blob/master/LICENSE
*/var qse=["input:not([inert])","select:not([inert])","textarea:not([inert])","a[href]:not([inert])","button:not([inert])","[tabindex]:not(slot):not([inert])","audio[controls]:not([inert])","video[controls]:not([inert])",'[contenteditable]:not([contenteditable="false"]):not([inert])',"details>summary:first-of-type:not([inert])","details:not([inert])"],$A=qse.join(","),Wse=typeof Element>"u",Uy=Wse?function(){}:Element.prototype.matches||Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector,PA=!Wse&&Element.prototype.getRootNode?function(t){var e;return t==null||(e=t.getRootNode)===null||e===void 0?void 0:e.call(t)}:function(t){return t==null?void 0:t.ownerDocument},kA=function t(e,i){var n;i===void 0&&(i=!0);var r=e==null||(n=e.getAttribute)===null||n===void 0?void 0:n.call(e,"inert"),s=r===""||r==="true",o=s||i&&e&&t(e.parentNode);return o},_3e=function(e){var i,n=e==null||(i=e.getAttribute)===null||i===void 0?void 0:i.call(e,"contenteditable");return n===""||n==="true"},Jse=function(e,i,n){if(kA(e))return[];var r=Array.prototype.slice.apply(e.querySelectorAll($A));return i&&Uy.call(e,$A)&&r.unshift(e),r=r.filter(n),r},Zse=function t(e,i,n){for(var r=[],s=Array.from(e);s.length;){var o=s.shift();if(!kA(o,!1))if(o.tagName==="SLOT"){var a=o.assignedElements(),l=a.length?a:o.children,c=t(l,!0,n);n.flatten?r.push.apply(r,c):r.push({scopeParent:o,candidates:c})}else{var u=Uy.call(o,$A);u&&n.filter(o)&&(i||!e.includes(o))&&r.push(o);var d=o.shadowRoot||typeof n.getShadowRoot=="function"&&n.getShadowRoot(o),f=!kA(d,!1)&&(!n.shadowRootFilter||n.shadowRootFilter(o));if(d&&f){var m=t(d===!0?o.children:d.children,!0,n);n.flatten?r.push.apply(r,m):r.push({scopeParent:o,candidates:m})}else s.unshift.apply(s,o.children)}}return r},Yse=function(e,i){return e.tabIndex<0&&(i||/^(AUDIO|VIDEO|DETAILS)$/.test(e.tagName)||_3e(e))&&isNaN(parseInt(e.getAttribute("tabindex"),10))?0:e.tabIndex},b3e=function(e,i){return e.tabIndex===i.tabIndex?e.documentOrder-i.documentOrder:e.tabIndex-i.tabIndex},Xse=function(e){return e.tagName==="INPUT"},w3e=function(e){return Xse(e)&&e.type==="hidden"},x3e=function(e){var i=e.tagName==="DETAILS"&&Array.prototype.slice.apply(e.children).some(function(n){return n.tagName==="SUMMARY"});return i},S3e=function(e,i){for(var n=0;n<e.length;n++)if(e[n].checked&&e[n].form===i)return e[n]},T3e=function(e){if(!e.name)return!0;var i=e.form||PA(e),n=function(a){return i.querySelectorAll('input[type="radio"][name="'+a+'"]')},r;if(typeof window<"u"&&typeof window.CSS<"u"&&typeof window.CSS.escape=="function")r=n(window.CSS.escape(e.name));else try{r=n(e.name)}catch(o){return console.error("Looks like you have a radio button with a name attribute containing invalid CSS selector characters and need the CSS.escape polyfill: %s",o.message),!1}var s=S3e(r,e.form);return!s||s===e},I3e=function(e){return Xse(e)&&e.type==="radio"},C3e=function(e){return I3e(e)&&!T3e(e)},M3e=function(e){var i,n=e&&PA(e),r=(i=n)===null||i===void 0?void 0:i.host,s=!1;if(n&&n!==e){var o,a,l;for(s=!!((o=r)!==null&&o!==void 0&&(a=o.ownerDocument)!==null&&a!==void 0&&a.contains(r)||e!=null&&(l=e.ownerDocument)!==null&&l!==void 0&&l.contains(e));!s&&r;){var c,u,d;n=PA(r),r=(c=n)===null||c===void 0?void 0:c.host,s=!!((u=r)!==null&&u!==void 0&&(d=u.ownerDocument)!==null&&d!==void 0&&d.contains(r))}}return s},sG=function(e){var i=e.getBoundingClientRect(),n=i.width,r=i.height;return n===0&&r===0},E3e=function(e,i){var n=i.displayCheck,r=i.getShadowRoot;if(getComputedStyle(e).visibility==="hidden")return!0;var s=Uy.call(e,"details>summary:first-of-type"),o=s?e.parentElement:e;if(Uy.call(o,"details:not([open]) *"))return!0;if(!n||n==="full"||n==="legacy-full"){if(typeof r=="function"){for(var a=e;e;){var l=e.parentElement,c=PA(e);if(l&&!l.shadowRoot&&r(l)===!0)return sG(e);e.assignedSlot?e=e.assignedSlot:!l&&c!==e.ownerDocument?e=c.host:e=l}e=a}if(M3e(e))return!e.getClientRects().length;if(n!=="legacy-full")return!0}else if(n==="non-zero-area")return sG(e);return!1},A3e=function(e){if(/^(INPUT|BUTTON|SELECT|TEXTAREA)$/.test(e.tagName))for(var i=e.parentElement;i;){if(i.tagName==="FIELDSET"&&i.disabled){for(var n=0;n<i.children.length;n++){var r=i.children.item(n);if(r.tagName==="LEGEND")return Uy.call(i,"fieldset[disabled] *")?!0:!r.contains(e)}return!0}i=i.parentElement}return!1},OA=function(e,i){return!(i.disabled||kA(i)||w3e(i)||E3e(i,e)||x3e(i)||A3e(i))},OD=function(e,i){return!(C3e(i)||Yse(i)<0||!OA(e,i))},$3e=function(e){var i=parseInt(e.getAttribute("tabindex"),10);return!!(isNaN(i)||i>=0)},P3e=function t(e){var i=[],n=[];return e.forEach(function(r,s){var o=!!r.scopeParent,a=o?r.scopeParent:r,l=Yse(a,o),c=o?t(r.candidates):a;l===0?o?i.push.apply(i,c):i.push(a):n.push({documentOrder:s,tabIndex:l,item:r,isScope:o,content:c})}),n.sort(b3e).reduce(function(r,s){return s.isScope?r.push.apply(r,s.content):r.push(s.content),r},[]).concat(i)},k3e=function(e,i){i=i||{};var n;return i.getShadowRoot?n=Zse([e],i.includeContainer,{filter:OD.bind(null,i),flatten:!1,getShadowRoot:i.getShadowRoot,shadowRootFilter:$3e}):n=Jse(e,i.includeContainer,OD.bind(null,i)),P3e(n)},$ht=function(e,i){i=i||{};var n;return i.getShadowRoot?n=Zse([e],i.includeContainer,{filter:OA.bind(null,i),flatten:!0,getShadowRoot:i.getShadowRoot}):n=Jse(e,i.includeContainer,OA.bind(null,i)),n},Pht=function(e,i){if(i=i||{},!e)throw new Error("No node provided");return Uy.call(e,$A)===!1?!1:OD(i,e)},O3e=qse.concat("iframe").join(","),kht=function(e,i){if(i=i||{},!e)throw new Error("No node provided");return Uy.call(e,O3e)===!1?!1:OA(i,e)};const L3e={getShadowRoot:!0};function Oht(t){const e="dir",i=`[${e}]`,n=R3e(t,i);return n?n.getAttribute(e):"ltr"}function WV(t){return t.getRootNode()}function Lht(t){const e=WV(t);return"host"in e?e:null}function Kse(t){return t.host||null}function Rht(t,{selector:e,id:i}){function n(r){if(!r)return null;r.assignedSlot&&(r=r.assignedSlot);const s=WV(r),o=i?"getElementById"in s?s.getElementById(i):null:e?s.querySelector(e):null,a=Kse(s);return o||(a?n(a):null)}return n(t)}function R3e(t,e){function i(n){return n?n.closest(e)||i(Kse(WV(n))):null}return i(t)}function D3e(t,e){return Qse(t,e)}function Qse(t,e){if(!t)return;const i=e(t);if(i!==void 0)return i;const{parentNode:n}=t;return Qse(n instanceof ShadowRoot?n.host:n,e)}function Dht(t,e){return!!D3e(e,i=>i===t?!0:void 0)}function N3e(t){return typeof(t==null?void 0:t.setFocus)=="function"}async function Nht(t){if(t)return N3e(t)?t.setFocus():t.focus()}function Fht(t){t&&(k3e(t,L3e)[0]||t).focus()}const X2=":not([slot])";function zht(t,e,i){e&&!Array.isArray(e)&&typeof e!="string"&&(i=e,e=null);const n=e?Array.isArray(e)?e.map(r=>`[slot="${r}"]`).join(","):`[slot="${e}"]`:X2;return i!=null&&i.all?F3e(t,n,i):z3e(t,n,i)}function eoe(t,e){return t?Array.from(t.children||[]).filter(i=>i==null?void 0:i.matches(e)):[]}function F3e(t,e,i){let n=e===X2?eoe(t,X2):Array.from(t.querySelectorAll(e));n=i&&i.direct===!1?n:n.filter(s=>s.parentElement===t),n=i!=null&&i.matches?n.filter(s=>s==null?void 0:s.matches(i.matches)):n;const r=i==null?void 0:i.selector;return r?n.map(s=>Array.from(s.querySelectorAll(r))).reduce((s,o)=>[...s,...o],[]).filter(s=>!!s):n}function z3e(t,e,i){let n=e===X2?eoe(t,X2)[0]||null:t.querySelector(e);n=i&&i.direct===!1||(n==null?void 0:n.parentElement)===t?n:null,n=i!=null&&i.matches?n!=null&&n.matches(i.matches)?n:null:n;const r=i==null?void 0:i.selector;return r?n==null?void 0:n.querySelector(r):n}function Vht(t,e,i){if(typeof e=="string"&&e!=="")return e;if(e==="")return t[i]}function jht(t){return(!!t).toString()}function Bht(t){return!!V3e(t).length}function V3e(t){return t.target.assignedElements({flatten:!0})}function Uht(t){return!!(t.isPrimary&&t.button===0)}/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.4.3
 */function oG(){const{classList:t}=document.body,e=window.matchMedia("(prefers-color-scheme: dark)").matches,i=()=>t.contains(Hse)||t.contains(Gse)&&e?"dark":"light",n=o=>document.body.dispatchEvent(new CustomEvent("calciteModeChange",{bubbles:!0,detail:{mode:o}})),r=o=>{s!==o&&n(o),s=o};let s=i();n(s),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",o=>r(o.matches?"dark":"light")),new MutationObserver(()=>r(i())).observe(document.body,{attributes:!0,attributeFilter:["class"]})}function j3e(){typeof window<"u"&&typeof location<"u"&&typeof document<"u"&&window.location===location&&window.document===document&&(document.readyState==="interactive"?oG():document.addEventListener("DOMContentLoaded",()=>oG(),{once:!0}))}const B3e=j3e;B3e();let toe;function U3e(){try{Eke(".")}catch{Ake(tl(xt(toe)))}}function NP(t){var i;const e=[];for(const n of Object.keys(t))customElements.get(`calcite-${n}`)||e.push((i=t[n])==null?void 0:i.call(t));return Promise.all(e)}toe="components/assets";const ioe=Symbol("widget"),G3e=Symbol("widget-test-data"),H3e=[],q3e={},LA=new WeakMap;function noe(t,e){let i=e.children;if(i&&i.length)for(let r=0;r<i.length;++r)i[r]=noe(t,i[r]);else i=H3e;const n=e.vnodeSelector;if(JV(n)){const r=e.properties||q3e,s=r.key||n;return{vnodeSelector:"div",properties:{key:s,afterCreate:W3e,afterUpdate:J3e,afterRemoved:roe,parentWidget:t,widgetConstructor:n,widgetProperties:{...r,key:s,children:i}},children:void 0,text:void 0,domNode:null}}return e}function W3e(t,e,i,{parentWidget:n,widgetConstructor:r,widgetProperties:s}){var a;const o=new r(s);o.container=t,LA.set(t,o),(a=o.afterCreate)==null||a.call(o,o,t),n._internalHandles.add(br(()=>roe(t)))}function J3e(t,e,i,{widgetProperties:n}){var s;const r=LA.get(t);r&&(r.set(n),(s=r.afterUpdate)==null||s.call(r,r,t))}function roe(t){var i;const e=LA.get(t);e&&((i=e.afterRemoved)==null||i.call(e,e,t),e.destroy(),LA.delete(t))}function JV(t){return typeof t=="function"&&t[ioe]}const aG=new Set;function Z3e(t){aG.add(t),t.finally(()=>aG.delete(t))}var soe;const Y3e="esri.widgets.Widget";let X3e=0;const K3e={widgetIcon:"esri-icon-checkbox-unchecked"};function ooe(t,e){for(const i in e)t[i]!=null&&(typeof t[i]=="object"&&typeof e[i]=="object"?ooe(t[i],e==null?void 0:e[i]):t[i]=e[i]);return t}const Q3e=Mke({postProcessProjectionOptions(t){const e=t.eventHandlerInterceptor,i=/capture$/i;t.eventHandlerInterceptor=(n,r,s,o)=>{const a=e==null?void 0:e(n,r,s,o),l=i.test(n);if(!((n=n.replace(i,"")).toLowerCase()in s)||l){const c=n[2].toLowerCase()+n.slice(3),u=m=>a==null?void 0:a.call(s,m);s.addEventListener(c,u,l);const d=()=>s.removeEventListener(c,u,l),f=o.afterRemoved;o.afterRemoved=m=>{f==null||f(m),d()}}return a}},handleInterceptedEvent(t,e,i,n){const{eventPhase:r,type:s}=n,o=r===Event.CAPTURING_PHASE;let a=`on${s}${o?"capture":""}`;const l=e.properties;(l&&a in l||(a=`on${s[0].toUpperCase()}${s.slice(1)}${o?"Capture":""}`,l&&a in l))&&(rre(),t.scheduleRender(),l[a].call(l.bind||i,n))}});let eO=!1,Un=class extends K$(Uo.EventedAccessor){constructor(e,i){super(e,i),this._attached=!1,this._internalHandles=new Rs,this._projector=Q3e,this._readyForTrueRender=!1,this.iconClass=K3e.widgetIcon,this.icon=null,this.key=this,this._loadLocale=kS(async()=>{if(this._messageBundleProps&&this._messageBundleProps.length){const o=await Sn(this._messageBundleProps.map(async({bundlePath:a,propertyName:l})=>{if(this.destroyed)return;let c=await fy(a);this.uiStrings&&Object.keys(this.uiStrings)&&(c=ooe(q(c),this.uiStrings)),this[l]=c}));if(this.destroyed)return;for(const a of o)a.error&&ne.getLogger(this).error("widget-intl:locale-error",this.declaredClass,a.error)}await this.loadLocale()}),U3e();const n="esri-widget-uid-"+BV(),r=this.render.bind(this);this._trackingTarget=new Z$(()=>this.scheduleRender());const s=()=>{var u;if(!this._readyForTrueRender||this.destroyed)return null;const o=r();let{properties:a}=o;a||(o.properties=a={});const{key:l}=a;l||(a.key=n),this.visible?a.styles||(a.styles={}):(a.class="",a.styles={display:"none"}),a.styles.display||(a.styles.display="");let c=0;return(u=o.children)==null||u.forEach(d=>{if(JV(d.vnodeSelector))return;let{properties:f}=d;f||(d.properties=f={}),f.key||(f.key=`${this.id}--${c++}`)}),noe(this,o)};this.render=()=>{if(eO)return s();let o=xMe(this)??null;if(o)return o;this._trackingTarget.clear(),eO=!0;try{o=id(this._trackingTarget,s)}catch(a){throw console.error(a),a}finally{eO=!1}return o&&SMe(this,o),o},this.addResolvingPromise(this._resourcesFetch=this.beforeFirstRender().then(()=>{this._readyForTrueRender=!0,this._postInitialize()})),Z3e(this._resourcesFetch)}normalizeCtorArgs(e,i){const n={...e};return i&&(n.container=i),n}postInitialize(){}beforeFirstRender(){return Promise.all([this.loadDependencies(),this._loadLocale()]).then(()=>{}).catch(QL)}async loadDependencies(){}async loadLocale(){}destroy(){this.destroyed||(Je(this._trackingTarget),Je(this.viewModel),this._detach(this.container),this._set("container",null),this._internalHandles.destroy(),this._emitter.clear(),this.render=()=>null,this._projector=null,L3(this))}set container(e){this._get("container")||this._set("container",e)}castContainer(e){return TP(e)}get domNode(){return this.container}set domNode(e){this.container=e}get id(){return this._get("id")||this.get("container.id")||Date.now().toString(16)+"-widget-"+X3e++}set id(e){e&&this._set("id",e)}get label(){return this.declaredClass.split(".").pop()}set label(e){this._overrideIfSome("label",e)}get renderable(){return this._resourcesFetch}get visible(){return this._get("visible")}set visible(e){this._set("visible",e)}get[(soe=ioe,G3e)](){return{projector:this._projector}}render(){throw new Error("not implemented")}scheduleRender(){this.destroyed||(L3(this),this._projector.scheduleRender())}classes(...e){return u_.apply(this,e)}renderNow(){L3(this),this._projector.renderNow()}_postInitialize(){var i;if(this.destroyed)return;this.scheduleRender(),(i=this._delegatedEventNames)!=null&&i.length&&this._internalHandles.add(Q(()=>this.viewModel,(n,r)=>{r&&this._internalHandles.remove("delegated-events"),n&&q$(n)&&this._internalHandles.add(this._delegatedEventNames.map(s=>Lh(n,s,o=>{this.emit(s,o)})),"delegated-events")},He)),this.postInitialize();const e=async()=>{await this._loadLocale().catch(QL),this.scheduleRender()};this._internalHandles.add([FS(e),Q(()=>this.uiStrings,e),jo(()=>this.container,n=>{this.destroyed||this._attach(n)},{initial:!0,once:!0})])}_attach(e){e&&(this._projector.merge(e,this.render),this._attached=!0)}_detach(e){var i;this._attached&&(this._projector.detach(this.render),this._attached=!1),(i=e==null?void 0:e.parentNode)==null||i.removeChild(e)}};Un[soe]=!0,h([p()],Un.prototype,"_readyForTrueRender",void 0),h([p({value:null})],Un.prototype,"container",null),h([ut("container")],Un.prototype,"castContainer",null),h([p()],Un.prototype,"iconClass",void 0),h([p()],Un.prototype,"icon",void 0),h([p()],Un.prototype,"id",null),h([p()],Un.prototype,"label",null),h([p()],Un.prototype,"renderable",null),h([p()],Un.prototype,"uiStrings",void 0),h([p()],Un.prototype,"viewModel",void 0),h([p({value:!0})],Un.prototype,"visible",null),h([p()],Un.prototype,"key",void 0),h([p()],Un.prototype,"children",void 0),h([p()],Un.prototype,"afterCreate",void 0),h([p()],Un.prototype,"afterUpdate",void 0),h([p()],Un.prototype,"afterRemoved",void 0),Un=h([P(Y3e)],Un);const qi=Un;function lG(t,e){return t&&"copyright"in t&&(!e||typeof t.originOf=="function"&&t.originOf("copyright")==="user")}function eOe(t,e){return t.length!==e.length||t.some((i,n)=>i.text!==e[n].text)}function bI(t,e,i){!i||!e||t.find(n=>n.layerView===e&&n.text===i)||t.push({text:i,layerView:e})}function tOe(t){return t.type==="bing-maps"}const Vd=[];let xv=class extends lb{constructor(e){super(e),this._clear=()=>{this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.handles.remove("suspension"),this.notifyChange("state")},this._pendingAttributions=new Set,this._fetchedAttributionData=new Map,this.items=new xe,this.view=null,this._allLayerViewsChange=i=>{this.handles.remove("suspension");const n=this.get("view.allLayerViews");n&&this.handles.add(n.map(r=>Q(()=>{var s;return[r.suspended,(s=r.layer)==null?void 0:s.attributionVisible]},()=>this._updateAttributionItems())),"suspension"),i&&i.removed&&i.removed.forEach(r=>{this._pendingAttributions.delete(r),this._fetchedAttributionData.delete(r)}),this._updateAttributionItems()},this.handles.add([on(()=>{var i;return(i=this.view)==null?void 0:i.allLayerViews},"change",i=>this._allLayerViewsChange(i),{onListenerAdd:()=>this._allLayerViewsChange(),onListenerRemove:this._clear}),jo(()=>{var i;return((i=this.view)==null?void 0:i.stationary)===!0},()=>this._updateAttributionItems())])}destroy(){this.view=null,this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.items.removeAll()}get state(){return this.get("view.ready")?this._pendingAttributions.size>0?"loading":"ready":"disabled"}_updateAttributionItems(){const e=this.view,i=e==null?void 0:e.allLayerViews;Vd.length=0,e&&i?(i.forEach(n=>{var o;if(n.suspended||!((o=n.layer)!=null&&o.attributionVisible))return;const r=n.layer;if(lG(r,"user"))return void bI(Vd,n,r.copyright);if(r.hasAttributionData){if(this._fetchedAttributionData.has(n)){const a=this._fetchedAttributionData.get(n);return void(a?bI(Vd,n,this._getDynamicAttribution(a,e,r)):lG(r)&&bI(Vd,n,r.copyright))}return void this._fetchAttributionData(n)}const s=r.get("portalItem.accessInformation");bI(Vd,n,s||r.copyright)}),eOe(this.items,Vd)&&(this.items.removeAll(),this.items.addMany(Vd)),Vd.length=0,this.notifyChange("state")):this._clear()}async _fetchAttributionData(e){if(this._pendingAttributions.has(e))return;this._pendingAttributions.add(e);const i=await Q$(e.layer.fetchAttributionData());if(this._pendingAttributions.has(e)){const n=i.ok?this._createContributionIndex(i.value,tOe(e.layer)):null;this._pendingAttributions.delete(e),this._fetchedAttributionData.set(e,n)}this._updateAttributionItems()}_createContributionIndex(e,i){const n=e.contributors,r={};if(!n)return r;for(let s=0;s<n.length;s++){const o=n[s],a=o.coverageAreas;if(!a)return;for(const l of a){const c=l.bbox,u=l.zoomMin-(i&&l.zoomMin?1:0),d=l.zoomMax-(i&&l.zoomMax?1:0),f=new Le({xmin:c[1],ymin:c[0],xmax:c[3],ymax:c[2],spatialReference:Ee.WGS84}),m={extent:qh(f),attribution:o.attribution||"",score:l.score!=null?l.score:100,id:s};for(let g=u;g<=d;g++)r[g]??(r[g]=[]),r[g].push(m)}}return r.maxKey=Math.max.apply(null,Object.keys(r)),r}_getDynamicAttribution(e,i,n){var u;const{extent:r,scale:s}=i;let o=((u=n.tileInfo)==null?void 0:u.scaleToZoom(s))??0;if(o=Math.min(e.maxKey??0,Math.round(o)),!r||o==null||o<=-1)return"";const a=e[o],l=NS(r.center.clone().normalize(),i.spatialReference),c=new Set;return a?a.filter(d=>{const f=d.id,m=!c.has(f)&&l&&d.extent&&rP(d.extent,l);return m&&c.add(f),m}).sort((d,f)=>f.score-d.score||d.objectId-f.objectId).map(d=>d.attribution).join(", "):""}};h([p({readOnly:!0,type:xe})],xv.prototype,"items",void 0),h([p({readOnly:!0})],xv.prototype,"state",null),h([p()],xv.prototype,"view",void 0),xv=h([P("esri.widgets.Attribution.AttributionViewModel")],xv);const aoe=xv;function Dr(){return function(t,e){if(!t[e])throw new TypeError(`Cannot auto bind undefined function '${String(e)}'`);return{value:nOe(t[e])}}}function iOe(t){const e=t==null?void 0:t.type;return t instanceof KeyboardEvent||e==="keyup"||e==="keydown"||e==="keypress"}function nOe(t){return function(e,...i){iOe(e)?ly(e.key)&&(e.preventDefault(),e.stopPropagation(),e.target.click()):t.call(this,e,...i)}}function Zt(t){return(e,i)=>{e.hasOwnProperty("_messageBundleProps")||(e._messageBundleProps=e._messageBundleProps?e._messageBundleProps.slice():[]),e._messageBundleProps.push({bundlePath:t,propertyName:i})}}var rOe=function(t){return{vnodeSelector:"",properties:void 0,children:void 0,text:t.toString(),domNode:null}},loe=function(t,e){for(var i=0,n=t.length;i<n;i++){var r=t[i];Array.isArray(r)?loe(r,e):r!=null&&r!==!1&&(r.hasOwnProperty("vnodeSelector")||(r=rOe(r)),e.push(r))}},sOe=function(t,e){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];if(i.length===1&&typeof i[0]=="string")return{vnodeSelector:t,properties:e||void 0,children:void 0,text:i[0],domNode:null};var r=[];return loe(i,r),{vnodeSelector:t,properties:e||void 0,children:r,text:void 0,domNode:null}};function O(t,e,...i){return typeof t!="function"||JV(t)?sOe(t,e,...i):t(e,...i)}const k0="esri-attribution",jd={base:`${k0} esri-widget`,poweredBy:`${k0}__powered-by`,sources:`${k0}__sources`,open:`${k0}--open`,sourcesOpen:`${k0}__sources--open`,link:`${k0}__link`,widgetIcon:"esri-icon-description",interactive:"esri-interactive"};let ms=class extends qi{constructor(e,i){super(e,i),this._isOpen=!1,this._attributionTextOverflowed=!1,this._prevSourceNodeHeight=0,this._resizeObserver=new ResizeObserver(n=>n.forEach(({target:r})=>this._checkSourceTextOverflow(r))),this.iconClass=jd.widgetIcon,this.icon=null,this.itemDelimiter=" | ",this.messages=null,this.viewModel=new aoe}initialize(){this.addHandles(on(()=>{var e;return(e=this.viewModel)==null?void 0:e.items},"change",()=>this.scheduleRender()))}destroy(){var e;(e=this._resizeObserver)==null||e.disconnect()}get _isInteractive(){return this._isOpen||this._attributionTextOverflowed}get attributionText(){return this.viewModel.items.reduce((e,i)=>(e.includes(i.text)||e.push(i.text),e),[]).join(this.itemDelimiter)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){const e={[jd.open]:this._isOpen};return O("div",{bind:this,class:this.classes(jd.base,e),dir:"ltr",onclick:this._toggleState,onkeydown:this._toggleState},this.renderSourcesNode(),this.renderPoweredBy())}renderPoweredBy(){return O("div",{class:jd.poweredBy},"Powered by"," ",O("a",{class:jd.link,href:"http://www.esri.com/",target:"_blank",rel:"noreferrer"},"Esri"))}renderSourcesNode(){const e=this._isOpen,i=this._isInteractive,n=i?"0":"",{attributionText:r}=this,s={[jd.sourcesOpen]:e,[jd.interactive]:i};return O("div",{afterCreate:this._afterSourcesNodeCreate,bind:this,class:this.classes(jd.sources,s),innerHTML:r,tabindex:n})}_afterSourcesNodeCreate(e){this._prevSourceNodeHeight=e.clientWidth,this._resizeObserver.observe(e)}_checkSourceTextOverflow(e){let i=!1;const{clientHeight:n,clientWidth:r,scrollWidth:s}=e,o=s>r,a=this._attributionTextOverflowed!==o;if(this._attributionTextOverflowed=o,a&&(i=!0),this._isOpen){const l=n<this._prevSourceNodeHeight;this._prevSourceNodeHeight=n,l&&(this._isOpen=!1,i=!0)}i&&this.scheduleRender()}_toggleState(){this._isInteractive&&(this._isOpen=!this._isOpen)}};h([p()],ms.prototype,"_isOpen",void 0),h([p()],ms.prototype,"_isInteractive",null),h([p()],ms.prototype,"_attributionTextOverflowed",void 0),h([p()],ms.prototype,"_prevSourceNodeHeight",void 0),h([p({readOnly:!0,dependsOn:["viewModel.items.length","itemDelimiter"]})],ms.prototype,"attributionText",null),h([p()],ms.prototype,"iconClass",void 0),h([p()],ms.prototype,"icon",void 0),h([p()],ms.prototype,"itemDelimiter",void 0),h([p()],ms.prototype,"label",null),h([p(),Zt("esri/widgets/Attribution/t9n/Attribution")],ms.prototype,"messages",void 0),h([p()],ms.prototype,"view",null),h([p({type:aoe})],ms.prototype,"viewModel",void 0),h([Dr()],ms.prototype,"_toggleState",null),ms=h([P("esri.widgets.Attribution")],ms);const oOe=ms,coe=t=>{let e=class extends t{constructor(...i){super(...i),this.goToOverride=null,this.view=null}callGoTo(i){const{view:n}=this;return ks(n),this.goToOverride?this.goToOverride(n,i):n.goTo(i.target,i.options)}};return h([p()],e.prototype,"goToOverride",void 0),h([p()],e.prototype,"view",void 0),e=h([P("esri.widgets.support.GoTo")],e),e},aOe="esri.widgets.CompassViewModel";let eg=class extends coe(ye){constructor(e){super(e),this._handles=new Rs,this.orientation={x:0,y:0,z:0},this.view=null,this._updateForCamera=this._updateForCamera.bind(this),this._updateForRotation=this._updateForRotation.bind(this),this._updateRotationWatcher=this._updateRotationWatcher.bind(this)}initialize(){this._handles.add(Q(()=>this.view,this._updateRotationWatcher,He))}destroy(){Ri(this._handles),this.view=null}get canShowNorth(){const e=this.get("view.spatialReference");return!(!e||!e.isWebMercator&&!e.isGeographic)}get state(){return this.get("view.ready")?this.canShowNorth?"compass":"rotation":"disabled"}reset(){var i;if(!this.get("view.ready"))return;const e={};((i=this.view)==null?void 0:i.type)==="2d"?e.rotation=0:e.heading=0,this.callGoTo({target:e})}_updateForRotation(e){e!=null&&(this.orientation={z:e})}_updateForCamera(e){if(!e)return;const i=-e.heading;this.orientation={x:0,y:0,z:i}}_updateRotationWatcher(e){this._handles.removeAll(),e&&this._handles.add(e.type==="2d"?Q(()=>e==null?void 0:e.rotation,this._updateForRotation,He):Q(()=>e==null?void 0:e.camera,this._updateForCamera,He))}};h([p({readOnly:!0})],eg.prototype,"canShowNorth",null),h([p()],eg.prototype,"orientation",void 0),h([p({readOnly:!0})],eg.prototype,"state",null),h([p()],eg.prototype,"view",void 0),eg=h([P(aOe)],eg);const uoe=eg,Bd={base:"esri-compass esri-widget--button esri-widget",text:"esri-icon-font-fallback-text",icon:"esri-compass__icon",rotationIcon:"esri-icon-dial",northIcon:"esri-icon-compass",widgetIcon:"esri-icon-locate-circled",interactive:"esri-interactive",disabled:"esri-disabled"};let Gl=class extends qi{constructor(e,i){super(e,i),this.iconClass=Bd.widgetIcon,this.icon=null,this.messages=null,this.viewModel=new uoe}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}reset(){return this.viewModel.reset()}render(){const{orientation:e,state:i}=this.viewModel,n=i==="disabled",r=(i==="rotation"?"rotation":"compass")=="compass",s=n?-1:0,o={[Bd.disabled]:n,[Bd.interactive]:!n},a={[Bd.northIcon]:r,[Bd.rotationIcon]:!r},{messages:l}=this;return O("div",{bind:this,class:this.classes(Bd.base,o),onclick:this._reset,onkeydown:this._reset,role:"button",tabIndex:s,"aria-label":l.reset,title:l.reset},O("span",{"aria-hidden":"true",class:this.classes(Bd.icon,a),styles:this._toRotationTransform(e)}),O("span",{class:Bd.text},l.reset))}_reset(){this.viewModel.reset()}_toRotationTransform(e){return{transform:`rotateZ(${e.z}deg)`}}};h([p()],Gl.prototype,"goToOverride",null),h([p()],Gl.prototype,"iconClass",void 0),h([p()],Gl.prototype,"icon",void 0),h([p()],Gl.prototype,"label",null),h([p(),Zt("esri/widgets/Compass/t9n/Compass")],Gl.prototype,"messages",void 0),h([p()],Gl.prototype,"view",null),h([p({type:uoe})],Gl.prototype,"viewModel",void 0),h([Dr()],Gl.prototype,"_reset",null),Gl=h([P("esri.widgets.Compass")],Gl);const lOe=Gl,O0="esri-navigation-toggle",Ea={base:`${O0} esri-widget`,button:`${O0}__button esri-widget--button`,activeButton:`${O0}__button--active`,panButton:`${O0}__button--pan`,rotateButton:`${O0}__button--rotate`,isLayoutHorizontal:`${O0}--horizontal`,rotationIcon:"esri-icon-rotate",panIcon:"esri-icon-pan",widgetIcon:"esri-icon-pan2",disabled:"esri-disabled"};let Sv=class extends ye{constructor(e){super(e),this.navigationMode="pan",this.view=null}initialize(){this.own(jo(()=>{var e;return(e=this.view)==null?void 0:e.inputManager},()=>this._setNavigationMode()))}destroy(){this.view=null}get state(){var e;return this.get("view.ready")&&((e=this.view)==null?void 0:e.type)==="3d"?"ready":"disabled"}toggle(){this.state!=="disabled"&&(this.navigationMode=this.navigationMode!=="pan"?"pan":"rotate",this._setNavigationMode())}_setNavigationMode(){this.get("view.inputManager").primaryDragAction=this.navigationMode==="pan"?"pan":"rotate"}};h([p({readOnly:!0})],Sv.prototype,"state",null),h([p()],Sv.prototype,"navigationMode",void 0),h([p()],Sv.prototype,"view",void 0),Sv=h([P("esri.widgets.NavigationToggleViewModel")],Sv);const hoe=Sv;let Hl=class extends qi{constructor(e,i){super(e,i),this.iconClass=Ea.widgetIcon,this.icon=null,this.messages=null,this.viewModel=new hoe}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}set layout(e){e!=="horizontal"&&(e="vertical"),this._set("layout",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}toggle(){return this.viewModel.toggle()}render(){const e=this.get("viewModel.state")==="disabled",i=this.get("viewModel.navigationMode")==="pan",n={[Ea.disabled]:e,[Ea.isLayoutHorizontal]:this.layout==="horizontal"},r={[Ea.activeButton]:i},s={[Ea.activeButton]:!i},o=e?-1:0,a=this.messages.toggle;return O("div",{bind:this,class:this.classes(Ea.base,n),onclick:this._toggle,onkeydown:this._toggle,tabIndex:o,"aria-label":a,title:a},O("div",{class:this.classes(Ea.button,Ea.panButton,r)},O("span",{class:Ea.panIcon})),O("div",{class:this.classes(Ea.button,Ea.rotateButton,s)},O("span",{class:Ea.rotationIcon})))}_toggle(){this.toggle()}};h([p()],Hl.prototype,"iconClass",void 0),h([p()],Hl.prototype,"icon",void 0),h([p()],Hl.prototype,"label",null),h([p({value:"vertical"})],Hl.prototype,"layout",null),h([p(),Zt("esri/widgets/NavigationToggle/t9n/NavigationToggle")],Hl.prototype,"messages",void 0),h([p()],Hl.prototype,"view",null),h([p({type:hoe})],Hl.prototype,"viewModel",void 0),h([Dr()],Hl.prototype,"_toggle",null),Hl=h([P("esri.widgets.NavigationToggle")],Hl);const cOe=Hl,A1={button:"esri-widget--button esri-widget",disabled:"esri-disabled",interactive:"esri-interactive",iconText:"esri-icon-font-fallback-text",icon:"esri-icon"};let hh=class extends qi{constructor(){super(...arguments),this.enabled=!0,this.iconClass=null,this.icon=null,this.title=""}render(){const e=this.enabled?0:-1,i={[A1.disabled]:!this.enabled,[A1.interactive]:this.enabled};return O("div",{bind:this,class:this.classes(A1.button,i),onclick:this._triggerAction,onkeydown:this._triggerAction,role:"button",tabIndex:e,title:this.title},O("span",{"aria-hidden":"true",role:"presentation",class:this.classes(A1.icon,this.iconClass??"")}),O("span",{class:A1.iconText},this.title))}_triggerAction(){this.action.call(this)}};h([p()],hh.prototype,"action",void 0),h([p()],hh.prototype,"enabled",void 0),h([p()],hh.prototype,"iconClass",void 0),h([p()],hh.prototype,"icon",void 0),h([p()],hh.prototype,"title",void 0),h([Dr()],hh.prototype,"_triggerAction",null),hh=h([P("esri.widgets.IconButton")],hh);const cG=hh;let Tv=class extends ye{get canZoomIn(){if(!this.get("view.ready"))return!1;const e=this.get("view.animation.target.scale")||this.get("view.scale"),i=this.get("view.constraints.effectiveMaxScale");return i===0||e>i}get canZoomOut(){if(!this.get("view.ready"))return!1;const e=this.get("view.animation.target.scale")||this.get("view.scale"),i=this.get("view.constraints.effectiveMinScale");return i===0||e<i}};h([p({readOnly:!0})],Tv.prototype,"canZoomIn",null),h([p({readOnly:!0})],Tv.prototype,"canZoomOut",null),h([p()],Tv.prototype,"view",void 0),Tv=h([P("esri.widgets.Zoom.ZoomConditions2D")],Tv);const uOe=Tv;let Iv=class extends ye{get canZoomIn(){return!!this.view.ready}get canZoomOut(){return!!this.view.ready}};h([p({readOnly:!0})],Iv.prototype,"canZoomIn",null),h([p({readOnly:!0})],Iv.prototype,"canZoomOut",null),h([p()],Iv.prototype,"view",void 0),Iv=h([P("esri.widgets.Zoom.ZoomConditions3D")],Iv);const hOe=Iv;let dp=class extends ye{constructor(e){super(e)}destroy(){this.view=null}get canZoomIn(){return this._zoomConditions!=null&&this._zoomConditions.canZoomIn}get canZoomOut(){var e;return this._zoomConditions!=null&&((e=this._zoomConditions)==null?void 0:e.canZoomOut)}get state(){var e;return(e=this.view)!=null&&e.ready?"ready":"disabled"}set view(e){e?e.type==="2d"?this._zoomConditions=new uOe({view:e}):e.type==="3d"&&(this._zoomConditions=new hOe({view:e})):this._zoomConditions=null,this._set("view",e)}zoomIn(){if(!this.canZoomIn)return;const e=this.view;e.type==="2d"?e.mapViewNavigation.zoomIn():$y(e.goTo({zoomFactor:2}))}zoomOut(){if(!this.canZoomOut)return;const e=this.view;e.type==="2d"?e.mapViewNavigation.zoomOut():$y(e.goTo({zoomFactor:.5}))}};h([p()],dp.prototype,"_zoomConditions",void 0),h([p()],dp.prototype,"canZoomIn",null),h([p()],dp.prototype,"canZoomOut",null),h([p({readOnly:!0})],dp.prototype,"state",null),h([p()],dp.prototype,"view",null),dp=h([P("esri.widgets.Zoom.ZoomViewModel")],dp);const doe=dp,$1={base:"esri-zoom esri-widget",horizontalLayout:"esri-zoom--horizontal",zoomInIcon:"esri-icon-plus",zoomOutIcon:"esri-icon-minus",widgetIcon:"esri-icon-zoom-in-magnifying-glass"};let Qc=class extends qi{constructor(e,i){super(e,i),this.iconClass=$1.widgetIcon,this.icon=null,this.messages=null,this.viewModel=new doe}initialize(){this._zoomInButton=new cG({action:this.zoomIn.bind(this),iconClass:$1.zoomInIcon}),this._zoomOutButton=new cG({action:this.zoomOut.bind(this),iconClass:$1.zoomOutIcon})}destroy(){this._zoomInButton=Je(this._zoomInButton),this._zoomOutButton=Je(this._zoomOutButton)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}set layout(e){e!=="horizontal"&&(e="vertical"),this._set("layout",e)}set view(e){this.viewModel.view=e}get view(){return this.viewModel.view}render(){const e=this.viewModel,i={[$1.horizontalLayout]:this.layout==="horizontal"},{canZoomIn:n,canZoomOut:r}=e;this._zoomInButton.enabled=n,this._zoomOutButton.enabled=r;const{zoomIn:s,zoomOut:o}=this.messages;return this._zoomInButton.title=s,this._zoomOutButton.title=o,O("div",{class:this.classes($1.base,i)},this._zoomInButton.render(),this._zoomOutButton.render())}zoomIn(){return this.viewModel.zoomIn()}zoomOut(){return this.viewModel.zoomOut()}};h([p()],Qc.prototype,"iconClass",void 0),h([p()],Qc.prototype,"icon",void 0),h([p()],Qc.prototype,"label",null),h([p({value:"vertical"})],Qc.prototype,"layout",null),h([p(),Zt("esri/widgets/Zoom/t9n/Zoom")],Qc.prototype,"messages",void 0),h([p()],Qc.prototype,"view",null),h([p({type:doe})],Qc.prototype,"viewModel",void 0),Qc=h([P("esri.widgets.Zoom")],Qc);const dOe=Qc;function pOe(t){return(t==null?void 0:t.view)!==void 0}let $M=class extends bke{constructor(e){super(e),this._defaultPositionLookup={attribution:"manual",compass:"top-left","navigation-toggle":"top-left",zoom:"top-left"},this.components=[],this._updateViewAwareWidgets=i=>{this.components.forEach(n=>{const r=this._find(n),s=r==null?void 0:r.widget;pOe(s)&&(s.view=i)})},this._componentsWatcher=(i,n)=>{this._removeComponents(n),this._addComponents(i),this._adjustPadding(i)}}initialize(){this.addHandles([Q(()=>this.components,this._componentsWatcher,He),Q(()=>this.view,this._updateViewAwareWidgets,He)])}_add(e,i,n,r,s){let o=e;if(typeof e=="string"&&this._defaultPositionLookup[e]){if(this._find(e))return;o=this._createComponent(e)}super._add(o,i,n,r,s)}_removeComponents(e){e.forEach(i=>{const n=this._find(i);n&&(this.remove(n),n.destroy())})}_adjustPadding(e){if(!e.includes("attribution")&&!this._isOverridden("padding")){const{top:i}=this.padding;this.padding=i}}_addComponents(e){this.constructed&&e.forEach(i=>this.add(this._createComponent(i),this._defaultPositionLookup[i]))}_createComponent(e){const i=this._createWidget(e);return new AM({id:e,node:i})}_createWidget(e){const{view:i}=this;switch(e){case"attribution":return new oOe({view:i});case"compass":return new lOe({view:i});case"navigation-toggle":return new cOe({view:i});case"zoom":return new dOe({view:i})}}};h([p()],$M.prototype,"components",void 0),$M=h([P("esri.views.ui.DefaultUI")],$M);const poe=$M;let PM=class extends poe{constructor(e){super(e),this.components=["attribution","zoom"]}};h([p()],PM.prototype,"components",void 0),PM=h([P("esri.views.ui.2d.DefaultUI2D")],PM);const foe=PM;var LD;let kM=LD=class extends ie{constructor(t){super(t),this.color=new ae([0,0,0,1])}clone(){return new LD(q({color:this.color}))}};h([p({type:ae,json:{write:!0}})],kM.prototype,"color",void 0),kM=LD=h([P("esri.webmap.background.ColorBackground")],kM);const fOe=kM;let moe,goe,yoe,voe,_oe,boe;async function mOe(){const[,{GraphicsView2D:t,GraphicContainer:e,LabelManager:i,MapViewNavigation:n,MagnifierView2D:r,Stage:s}]=await Promise.all([Y(()=>import("./webglDeps-23009489.js"),["./webglDeps-23009489.js","./VertexArrayObject-c8e6ef22.js","./Texture-6a4a9109.js","./enums-b14466b3.js","./ProgramTemplate-d3ea1e61.js","./programUtils-e6ec1729.js","./NestedMap-1b5db22e.js"],import.meta.url),Y(()=>import("./mapViewDeps-0d6eaf7a.js"),["./mapViewDeps-0d6eaf7a.js","./CIMResourceManager-2b6c9f9f.js","./fontUtils-36c927ab.js","./Rasterizer-37f71a46.js","./cimAnalyzer-1925a3d6.js","./BidiEngine-9a40f2f4.js","./OptimizedGeometry-196224d4.js","./GeometryUtils-984e8446.js","./enums-f1a6a48a.js","./alignmentUtils-ae955d28.js","./definitions-97fbc524.js","./number-e491b09e.js","./Rect-ea14f53a.js","./callExpressionWithFeature-2746b39a.js","./quantizationUtils-4d6bfb95.js","./floatRGBA-3a82b521.js","./rasterizingUtils-1dfc8831.js","./imageutils-bc5643b0.js","./Container-0003cec6.js","./enums-b14466b3.js","./Texture-6a4a9109.js","./BufferPool-ac49ede8.js","./AttributeStoreView-1c173c99.js","./TiledDisplayObject-d0b73ef5.js","./color-769a2896.js","./VertexElementDescriptor-2925c6af.js","./WGLContainer-2cf6354a.js","./VertexArrayObject-c8e6ef22.js","./vec4f32-0d1b2306.js","./ProgramTemplate-d3ea1e61.js","./GeometryUtils-12600119.js","./StyleDefinition-29c49b98.js","./config-1337d16e.js","./earcut-b7ad7453.js","./featureConversionUtils-7f0dd1f5.js","./OptimizedFeature-4701473b.js","./OptimizedFeatureSet-1d1ac4b9.js","./visualVariablesUtils-be80a4d1.js","./ExpandedCIM-3803a601.js","./util-16ac108f.js","./enums-fb086c25.js","./programUtils-e6ec1729.js","./NestedMap-1b5db22e.js","./MagnifierPrograms-ed300406.js","./pbf-984c4807.js","./Matcher-79a45603.js","./tileUtils-c2f19f52.js","./TurboLine-08ef9655.js","./CircularArray-ef508845.js","./testSVGPremultipliedAlpha-970e6ff0.js","./ComputedAttributeStorage-4014e53f.js","./arcadeTimeUtils-31294c74.js","./executionError-c92d3b85.js","./centroid-8e8cfa47.js","./RenderingContext-dbe37d87.js","./OrderIndependentTransparency-2a607a9a.js","./basicInterfaces-bb952591.js","./doublePrecisionUtils-e3c3d0d8.js","./imageUtils-c2d0d1ae.js","./GraphicsView2D-dc0beb08.js","./normalizeUtilsSync-da20ec22.js","./projectionSupport-7e11e91a.js","./json-48e3ea08.js","./GraphicContainer-7977f641.js","./BaseGraphicContainer-95a978d7.js","./FeatureContainer-95df36a3.js","./TileContainer-2082ecc6.js","./requestImageUtils-7eb39924.js"],import.meta.url)]);goe=t,yoe=e,voe=i,_oe=n,boe=r,moe=s}const uG=160,hG={flipY:!0,premultipliedAlpha:!0};let Ue=class extends ECe(aEe(WMe(HEe))){constructor(e){super(e),this._magnifierView=null,this._stage=null,this._resolveWhenReady=[],this.rootLayerViews=new L2({getCollections:()=>{var i,n;return[(i=this.basemapView)==null?void 0:i.baseLayerViews,this.layerViews,(n=this.basemapView)==null?void 0:n.referenceLayerViews]},getChildrenFunction:()=>null}),this.featuresTilingScheme=null,this.fullOpacity=1,this.graphicsView=null,this.stateManager=new qs({constraints:new ise({view:this})}),this.labelManager=null,this.mapViewNavigation=null,this.renderingOptions={samplingMode:"dynamic",edgeLabelsVisible:!0,labelsAnimationTime:125,labelCollisionsEnabled:!0},this.rendering=!1,this.supersampleScreenshotsEnabled=!0,this.supportsGround=!1,this._stationaryTimer=null,this._gotoTask=null,this.frameTask=new r$e(this),this._pePromise=null,this.floors=new xe,this.highlightOptions=new wse,this.inputManager=new NPe({view:this}),this.map=null,this.spatialReferenceLocked=!1,this.timeline=new xse,this.type="2d",this.ui=new foe,this.padding={top:0,right:0,bottom:0,left:0},this.addHandles([Q(()=>this.viewpoint,()=>{this._lastStationaryEventTimestamp=performance.now(),this._flipStationary(uG)},ml),this.on("resize",i=>this.stateManager.resize(i.width,i.height)),Q(()=>{var i;return(i=this.animationManager)==null?void 0:i.animation},i=>{this.animation=i})]),eIe()}destroy(){this._set("preconditionsReady",!1),this.frameTask=Je(this.frameTask),this._gotoTask=null,this.rootLayerViews.destroy(),this.inputManager.destroy(),this._set("inputManager",null)}get graphicsTileStore(){return new UPe(this.featuresTilingScheme)}get constraintsInfo(){var n,r;const e=(n=this.defaultsFromMap)==null?void 0:n.tileInfo,i=this.spatialReference;return{lods:(r=e==null?void 0:e.spatialReference)!=null&&r.equals(i)?e.lods:null,spatialReference:i}}get state(){return this.stateManager.state}get initialExtentRequired(){var a;if(!this.stateManager)return!1;const{scale:e,constraints:i,center:n,viewpoint:r,extent:s}=this;let o=this.zoom;return!(this.map&&"initialViewProperties"in this.map&&((a=this.map.initialViewProperties)!=null&&a.viewpoint))&&!s&&(i!=null&&i.effectiveLODs||(o=-1),(!n||e===0&&o===-1)&&(!r||r.targetGeometry==null||r.targetGeometry.type!=="extent"&&!r.scale))}get resourceManager(){return this._stage.resourceManager}get textureManager(){return this._stage.painter.textureManager}get _defaultsFromMapSettings(){return{required:{tileInfo:!0,heightModelInfo:!1,extent:!1},requiresExtentInSpatialReference:this.spatialReferenceLocked}}get _projectionEngineLoaded(){return!!wl()||(this._pePromise||(this._pePromise=Ic().finally(()=>{this._pePromise=null})),!1)}get typeSpecificPreconditionsReady(){const e=this._getDefaultViewpoint();if(!e)return!1;const i=this.spatialReference,n=e.targetGeometry;return!!yl(n.spatialReference,i)||this._projectionEngineLoaded}set animation(e){const i=this._get("animation");if(e===i)return;if(i&&i.stop(),!e||e.isFulfilled())return void this._set("animation",null);this._set("animation",e),this.frameTask.animationInProgress=!0;const n=()=>{var r;e===this._get("animation")&&(this._set("animation",null),(r=this.frameTask)==null||r.requestFrame()),this.frameTask.animationInProgress=!1};e.when(n,n)}get background(){return yOe(this.map)?this.map.initialViewProperties.background:null}set background(e){this._override("background",e)}get center(){var e;return((e=this.stateManager)==null?void 0:e.center)??null}set center(e){this.stateManager.center=e}get constraints(){var e;return(e=this.stateManager)==null?void 0:e.constraints}set constraints(e){e.view=this;const i=this.stateManager.constraints;this.stateManager.constraints=e,i==null||i.destroy()}get extent(){var e;return((e=this.stateManager)==null?void 0:e.extent)??null}set extent(e){this.stateManager.extent=e}get padding(){var e;return(e=this.stateManager)==null?void 0:e.padding}set padding(e){this.stateManager&&(this.stateManager.padding=e)}get resizeAlign(){return this.stateManager.resizeAlign}set resizeAlign(e){this.stateManager.resizeAlign=e}get resolution(){return this.stateManager.resolution??0}get rotation(){return this.stateManager.rotation??0}set rotation(e){this.stateManager.rotation=e}get scale(){var e;return((e=this.stateManager)==null?void 0:e.scale)??0}set scale(e){this.stateManager&&(this.stateManager.scale=e)}get stationary(){return!(this.animation||this.navigating||this.resizing||this._stationaryTimer)}get updating(){var i,n,r;const e=!this.destroyed&&(!this.layerViewManager||!this.labelManager||!this.graphicsView||this.layerViewManager.updating===!0||this.labelManager.updating===!0||this.graphicsView.updating===!0||this.allLayerViews.some(s=>!s.destroyed&&!("layerViews"in s)&&s.updating===!0));if(ee("esri-2d-log-updating")){const s=this.allLayerViews.reduce((o,a)=>({...o,[a.layer.id]:!a.destroyed&&!("layerViews"in a)&&a.updating}),{});console.log(`Updating MapView: ${e}
-> Null LayerViewManager: ${!this.layerViewManager}
-> Null LabelManager: ${!this.labelManager}
-> Null GraphicsView: ${!this.graphicsView}
-> layerViewManager.updating: ${(i=this.layerViewManager)==null?void 0:i.updating}
-> labelManager.updating: ${(n=this.labelManager)==null?void 0:n.updating}
-> graphicsView.updating: ${(r=this.graphicsView)==null?void 0:r.updating}
-> allLayerViews: ${JSON.stringify(s)}
`)}return e}get viewpoint(){return this.stateManager.viewpoint??null}set viewpoint(e){this.stateManager.viewpoint=e,this.frameTask.requestFrame()}get zoom(){return this.stateManager.zoom??-1}set zoom(e){this.stateManager.zoom=e}get navigating(){return!(!this.mapViewNavigation||!this.mapViewNavigation.interacting)}goTo(e,i){if(e)return this.animation&&(this.animation=null),this._createAnimation(),Lu(()=>this.ready,i).then(()=>{var s;const n={animate:!0,...i},r=zAe(e,this);return(s=this.animation)==null||s.update(r),this._gotoTask={},n.animate?this._gotoAnimated(r,n):this._gotoImmediate(r,n)});ne.getLogger(this).error("#goTo()","target cannot be null or undefined")}async hitTest(e,i){const n=v7(e)?y7(this,e):e;if(!this.ready||isNaN(n.x)||isNaN(n.y))return{screenPoint:n,results:[]};let r=new Set,s=!1,o=null,a=null;i!=null&&i.include?pG(i.include,dG(this,d=>r.add(d),d=>{o||(o=new Set),o.add(d)},d=>r.add(d),()=>s=!0)):(s=!0,r=new Set(this.allLayerViews)),i!=null&&i.exclude&&pG(i.exclude,dG(this,d=>r.delete(d),d=>{a||(a=new Set),a.add(d)}));const l=this.allLayerViews.filter(d=>!d.suspended&&r.has(d)).reverse(),c=this.toMap(n);let u=[...s?this.graphicsView.hitTest(c).map(d=>({type:"graphic",graphic:d,layer:null,mapPoint:c})):[],...await Promise.all(l.map(d=>d.hitTest(c,n)).toArray())].filter(Ti).flat().filter(Ti);return o&&(u=u.filter(d=>!("graphic"in d)||!d.graphic||(o==null?void 0:o.has(RD(d.graphic))))),a&&(u=u.filter(d=>!("graphic"in d)||!d.graphic||!(a!=null&&a.has(RD(d.graphic))))),{screenPoint:n,results:u}}async takeScreenshot(e){const i=this._createScreenshotPlan(e),n=await this._stage.takeScreenshot(i);return qPe(n,{format:i.format,quality:i.quality,rotation:0,disableDecorations:!1},hG)}async _takeScreenshot(e){const i=this._createScreenshotPlan(e),n=await this._stage.takeScreenshot(i);return WPe(n,hG)}_createScreenshotPlan(e){e=e??{};const i=this.supersampleScreenshotsEnabled?Math.min(4,XPe(this.size,Math.min(4096,this._stage.context.parameters.maxTextureSize))):1;let n;e.layers?(n=[],e.layers.forEach(o=>{const a=this.allLayerViews.find(l=>l.layer.id===o.id);a&&"container"in a&&a.container&&n.push(a.container)})):n=this._stage.children;const{format:r,quality:s}=YPe(e.format,e.quality);return HPe(e,i,this.size,this.padding,r,s,n,e.rotation)}get test(){return{takeScreenshot:e=>this._takeScreenshot(e)}}toMap(e){if(!this.ready)return null;const i=v7(e)?y7(this,e):e;return this.stateManager.toMap(i)}toScreen(e){return this.stateManager.toScreen(e)}on(e,i,n,r){return this.inputManager&&this.viewEvents.on(e,i,n,r)||super.on(e,i)}hasEventListener(e){return super.hasEventListener(e)||this.viewEvents.hasHandler(e)}whenLayerView(e){return super.whenLayerView(e)}graphicChanged(e){this.graphicsView&&this.graphicsView.graphicUpdateHandler(e)}whenReady(){return new Promise(e=>{this.ready?e(this):this._resolveWhenReady.push(e)})}forceDOMReadyCycle(){this.forceReadyCycle()}getDefaultSpatialReference(){var e,i,n;return this.map&&"initialViewProperties"in this.map&&((i=(e=this.map)==null?void 0:e.initialViewProperties)==null?void 0:i.spatialReference)||((n=this.defaultsFromMap)==null?void 0:n.spatialReference)||null}hasLayerViewModule(e){return I7.hasLayerViewModule(e)}importLayerView(e){return I7.importLayerView(e)}pixelSizeAt(){return this.ready?this.resolution:(ne.getLogger(this).error("#pixelSizeAt()","Map view cannot be used before it is ready"),null)}popupHitTest(e){return this.hitTest(e).then(i=>({...i,mapPoint:this.toMap(e)}))}requestUpdate(){this.ready&&this.frameTask.requestUpdate()}validate(){let e=hke(this.type);return ee("safari")&&ee("safari")<9&&(e=new V("mapview:browser-not-supported","This browser is not supported by MapView (Safari < 9)",{type:"safari",requiredVersion:9,detectedVersion:ee("safari")})),e!=null?(ne.getLogger(this).warn("#validate()",e.message),Promise.reject(e)):mOe()}_createAnimation(){return this.animation&&!this.animation.done||(this.animation=new vD),this.animation}_cancellableGoTo(e,i,n){const r=()=>e===this._gotoTask,s=n.then(()=>{r()&&(this.animation=null)}).catch(a=>{throw r()&&(i&&!i.done&&(i.stop(),this.frameTask.animationInProgress=!1),this.animation=null),a}),o=new Promise(a=>a(s));return i.when().catch(()=>{r()&&o.cancel&&o.cancel()}),o}_gotoImmediate(e,i){const n=this._gotoTask,r=this.animation,s=e.then(o=>{if(Vt(i),n!==this._gotoTask)throw new V("view:goto-interrupted","Goto was interrupted");this.viewpoint=r.target=o,r.finish()});return this._cancellableGoTo(n,r,s)}_flipStationary(e){return this._stationaryTimer!==null||(this._stationaryTimer=setTimeout(()=>{this._stationaryTimer=null;const i=performance.now()-this._lastStationaryEventTimestamp;i<uG&&(this._stationaryTimer=this._flipStationary(i))},e)),this._stationaryTimer}_getDefaultViewpoint(){var _;const{constraints:e,initialExtent:i,map:n,padding:r,size:s}=this;if(!e)return null;const o=n&&"initialViewProperties"in n?n.initialViewProperties:void 0,a=this.stateManager.getUserStartupOptions(this.size),l=o==null?void 0:o.viewpoint,c=((_=l==null?void 0:l.targetGeometry)==null?void 0:_.extent)??i,u=c==null?void 0:c.center,d=(l==null?void 0:l.rotation)??0,f=(l==null?void 0:l.scale)||c&&O_(c,[s[0]-r.left-r.right,s[1]-r.top-r.bottom]),m=a.center??u,g=a.rotation??d,y=a.scale??f;return m&&y?new Cu({targetGeometry:m,scale:y,rotation:g}):null}_gotoAnimated(e,i){const n=this._gotoTask,r=this.animation;if(!r)return Promise.resolve();const s=e.then(o=>{if(Vt(i),n!==this._gotoTask)throw new V("view:goto-interrupted","Goto was interrupted");return r.update(o),this.animationManager.animate(r,this.viewpoint,i),r.when().then(()=>{},()=>{})});return this._cancellableGoTo(n,r,s)}_startup(){var a;this.timeline.begin("MapView Startup");const e=this._getDefaultViewpoint();this.stateManager.startup(e,this.size,this.spatialReference,(a=this.defaultsFromMap.extent)==null?void 0:a.center),this.graphics.owner=this;const i=new moe(this.surface,{canvas:this.renderCanvas,supersampleScreenshots:this.supersampleScreenshotsEnabled,contextOptions:{disabledExtensions:this.deactivatedWebGLExtensions,debugWebGLExtensions:this.debugWebGLExtensions},renderingOptions:this.renderingOptions,timeline:this.timeline});this._stage=i,this._magnifierView=new boe,this._magnifierView.magnifier=this.magnifier;const n=new voe({view:this});this._set("labelManager",n);const r=new n$e({view:this});this._set("animationManager",r);const s=new _oe({view:this,animationManager:r});this._set("mapViewNavigation",s),this._setupSpatialReferenceDependentProperties(),this.handles.add([this.rootLayerViews.on("change",()=>this._updateStageChildren()),i.on("post-render",()=>this._set("rendering",i.renderRequested)),i.on("will-render",()=>this._set("rendering",i.renderRequested)),i.on("webgl-error",l=>this.fatalError=l.error),Q(()=>this.stationary,l=>i.stationary=l,Oi),Q(()=>this.background,l=>{i.backgroundColor=l==null?void 0:l.color,this._magnifierView.backgroundColor=l==null?void 0:l.color},Oi),Q(()=>this.magnifier,l=>this._magnifierView.magnifier=l,Oi),Q(()=>this.renderingOptions,l=>i.renderingOptions=l,Oi),Q(()=>this.highlightOptions,l=>i.highlightOptions=l,Oi),Q(()=>this.state.id,()=>i.state=this.state,Oi)],"map-view"),this._updateStageChildren();const o=this._resolveWhenReady;this._resolveWhenReady=[],o.forEach(l=>l(this)),this.timeline.end("MapView Startup"),this.frameTask.start(),this._set("ready",!0)}_teardown(){this._destroySpatialReferenceDependentProperties(),this.handles.remove("map-view"),this.mapViewNavigation.destroy(),this._set("mapViewNavigation",null),this.animationManager.destroy(),this._set("animationManager",null),this.layerViewManager.clear(),this.labelManager.destroy(),this._magnifierView.destroy(),this._stage.destroy(),this._stage=null,this._set("graphicsView",null),this._magnifierView=null,this._set("labelManager",null),this._set("mapViewNavigation",null),this.graphics.owner=null,this.frameTask.stop(),this._stationaryTimer&&(clearTimeout(this._stationaryTimer),this._stationaryTimer=null),this._set("ready",!1),this.stateManager.teardown(),this.animation=null}_updateStageChildren(){this._stage.removeAllChildren(),this.rootLayerViews.forEach(i=>{this._stage.addChild(i.container)});const e=this.graphicsView;this._stage.addChild(e.container),this._stage.addChild(this._magnifierView)}_setupSpatialReferenceDependentProperties(){const e=new f$e(Mu.create({spatialReference:this.spatialReference,size:512,numLODs:36}));this._set("featuresTilingScheme",e);const i=new goe({view:this,graphics:this.graphics,requestUpdateCallback:()=>this.requestUpdate(),container:new yoe(e)});this._set("graphicsView",i)}_destroySpatialReferenceDependentProperties(){const e=this.graphicsView;this._set("graphicsView",null),e.destroy(),this._set("featuresTilingScheme",null)}_spatialReferenceChanged(e){if(this.ready){this.frameTask.stop();for(const i of this.allLayerViews)i.processDetach();this._destroySpatialReferenceDependentProperties(),this.stateManager.changeSpatialReference(e),this._stage.state=this.state,this._setupSpatialReferenceDependentProperties();for(const i of this.allLayerViews)i.processAttach();this.frameTask.requestFrame(),this.frameTask.start(),this._updateStageChildren()}}};Ue.type="2d",h([p({readOnly:!0})],Ue.prototype,"animationManager",void 0),h([p({constructOnly:!0})],Ue.prototype,"deactivatedWebGLExtensions",void 0),h([p({constructOnly:!0})],Ue.prototype,"debugWebGLExtensions",void 0),h([p({readOnly:!0})],Ue.prototype,"featuresTilingScheme",void 0),h([p({readOnly:!0})],Ue.prototype,"fullOpacity",void 0),h([p({readOnly:!0})],Ue.prototype,"graphicsTileStore",null),h([p()],Ue.prototype,"graphicsView",void 0),h([p()],Ue.prototype,"stateManager",void 0),h([p()],Ue.prototype,"constraintsInfo",null),h([p({readOnly:!0})],Ue.prototype,"state",null),h([p()],Ue.prototype,"initialExtentRequired",null),h([p()],Ue.prototype,"labelManager",void 0),h([p({readOnly:!0})],Ue.prototype,"resourceManager",null),h([p({readOnly:!0})],Ue.prototype,"textureManager",null),h([p({readOnly:!0})],Ue.prototype,"mapViewNavigation",void 0),h([p({constructOnly:!0})],Ue.prototype,"renderCanvas",void 0),h([p()],Ue.prototype,"renderingOptions",void 0),h([p({readOnly:!0})],Ue.prototype,"rendering",void 0),h([p({constructOnly:!0})],Ue.prototype,"supersampleScreenshotsEnabled",void 0),h([p({readOnly:!0})],Ue.prototype,"supportsGround",void 0),h([p()],Ue.prototype,"_stationaryTimer",void 0),h([p()],Ue.prototype,"_defaultsFromMapSettings",null),h([p()],Ue.prototype,"_pePromise",void 0),h([p({readOnly:!0})],Ue.prototype,"typeSpecificPreconditionsReady",null),h([p()],Ue.prototype,"animation",null),h([p({type:fOe})],Ue.prototype,"background",null),h([p()],Ue.prototype,"center",null),h([p({type:ise})],Ue.prototype,"constraints",null),h([p()],Ue.prototype,"extent",null),h([p()],Ue.prototype,"floors",void 0),h([p({type:wse})],Ue.prototype,"highlightOptions",void 0),h([p({readOnly:!0})],Ue.prototype,"inputManager",void 0),h([p()],Ue.prototype,"map",void 0),h([p()],Ue.prototype,"padding",null),h([p()],Ue.prototype,"resizeAlign",null),h([p({readOnly:!0})],Ue.prototype,"resolution",null),h([p()],Ue.prototype,"rotation",null),h([p()],Ue.prototype,"scale",null),h([p({constructOnly:!0})],Ue.prototype,"spatialReferenceLocked",void 0),h([p()],Ue.prototype,"stationary",null),h([p({type:xse,readOnly:!0})],Ue.prototype,"timeline",void 0),h([p({readOnly:!0})],Ue.prototype,"type",void 0),h([p({readOnly:!0})],Ue.prototype,"updating",null),h([p()],Ue.prototype,"viewpoint",null),h([p()],Ue.prototype,"zoom",null),h([p({readOnly:!0})],Ue.prototype,"navigating",null),h([p(),ut(t=>t instanceof poe?t:t0(foe,t))],Ue.prototype,"ui",void 0),Ue=h([P("esri.views.MapView")],Ue);const gOe=Ue;function RD(t){var i,n;const e=t.getObjectId();return e?`${((i=t.layer)==null?void 0:i.uid)??((n=t.sourceLayer)==null?void 0:n.uid)??"MapView"}/${e}`:`"MapView/${t.uid}`}function dG(t,e,i,n,r){return s=>{if(s instanceof Vo){if(s.layer===t)r==null||r();else{const o=t.allLayerViews.find(a=>a.layer===s.layer);o&&(n==null||n(o))}i(RD(s))}else{const o=t.allLayerViews.find(a=>a.layer===s);o&&e(o)}}}function pG(t,e){if(t)if($E(t))for(const i of t)if($E(i))for(const n of i)e(n);else e(i);else e(t)}function yOe(t){return(t==null?void 0:t.declaredClass)==="esri.WebMap"}var DD;let Uw=DD=class extends ie{constructor(t){super(t),this.minValue=0,this.maxValue=0}clone(){return new DD({minValue:this.minValue,maxValue:this.maxValue})}};h([p({type:Number,json:{write:!0}})],Uw.prototype,"minValue",void 0),h([p({type:Number,json:{write:!0}})],Uw.prototype,"maxValue",void 0),Uw=DD=h([P("esri.renderer.support.AuthoringInfoClassBreakInfo")],Uw);var ND;let Up=ND=class extends ie{constructor(t){super(t),this.field="",this.normalizationField="",this.label="",this.classBreakInfos=[]}clone(){return new ND({field:this.field,normalizationField:this.normalizationField,label:this.label,classBreakInfos:q(this.classBreakInfos)})}};h([p({type:String,json:{write:!0}})],Up.prototype,"field",void 0),h([p({type:String,json:{write:!0}})],Up.prototype,"normalizationField",void 0),h([p({type:String,json:{write:!0}})],Up.prototype,"label",void 0),h([p({type:[Uw],json:{write:!0}})],Up.prototype,"classBreakInfos",void 0),Up=ND=h([P("esri.renderers.support.AuthoringInfoFieldInfo")],Up);var FD;const wI=new qe({percentTotal:"percent-of-total",ratio:"ratio",percent:"percent"}),xI=new qe({sizeInfo:"size",colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation"}),fG={key:t=>typeof t=="number"?"number":"string",typeMap:{number:Number,string:String},base:null},mG=["high-to-low","above-and-below","centered-on","extremes"],gG=[...new Set(["high-to-low","above-and-below","centered-on","extremes","90-10","above","below","high-to-low","above-and-below","90-10","above","below"])],yG=["seconds","minutes","hours","days","months","years"];let _o=FD=class extends ie{constructor(t){super(t),this.endTime=null,this.field=null,this.maxSliderValue=null,this.minSliderValue=null,this.startTime=null,this.type=null,this.units=null}castEndTime(t){return typeof t=="string"||typeof t=="number"?t:null}castStartTime(t){return typeof t=="string"||typeof t=="number"?t:null}get style(){return this.type==="color"?this._get("style"):null}set style(t){this._set("style",t)}get theme(){return this.type==="color"||this.type==="size"?this._get("theme")||"high-to-low":null}set theme(t){this._set("theme",t)}clone(){return new FD({endTime:this.endTime,field:this.field,maxSliderValue:this.maxSliderValue,minSliderValue:this.minSliderValue,startTime:this.startTime,style:this.style,theme:this.theme,type:this.type,units:this.units})}};h([p({types:fG,json:{write:!0}})],_o.prototype,"endTime",void 0),h([ut("endTime")],_o.prototype,"castEndTime",null),h([p({type:String,json:{write:!0}})],_o.prototype,"field",void 0),h([p({type:Number,json:{write:!0}})],_o.prototype,"maxSliderValue",void 0),h([p({type:Number,json:{write:!0}})],_o.prototype,"minSliderValue",void 0),h([p({types:fG,json:{write:!0}})],_o.prototype,"startTime",void 0),h([ut("startTime")],_o.prototype,"castStartTime",null),h([p({type:wI.apiValues,value:null,json:{type:wI.jsonValues,read:wI.read,write:wI.write}})],_o.prototype,"style",null),h([p({type:gG,value:null,json:{type:gG,origins:{"web-scene":{type:mG,write:{writer:(t,e)=>{mG.includes(t)&&(e.theme=t)}}}},write:!0}})],_o.prototype,"theme",null),h([p({type:xI.apiValues,json:{type:xI.jsonValues,read:xI.read,write:xI.write}})],_o.prototype,"type",void 0),h([p({type:yG,json:{type:yG,write:!0}})],_o.prototype,"units",void 0),_o=FD=h([P("esri.renderers.support.AuthoringInfoVisualVariable")],_o);const vOe=_o;let OM=class extends ie{constructor(e){super(e),this.type=null}};h([p({readOnly:!0,json:{read:!1,write:!0}})],OM.prototype,"type",void 0),OM=h([P("esri.rest.support.ColorRamp")],OM);const ZV=OM;var zD;let tg=zD=class extends ZV{constructor(t){super(t),this.algorithm=null,this.fromColor=null,this.toColor=null,this.type="algorithmic"}clone(){return new zD({fromColor:q(this.fromColor),toColor:q(this.toColor),algorithm:this.algorithm})}};h([be({esriCIELabAlgorithm:"cie-lab",esriHSVAlgorithm:"hsv",esriLabLChAlgorithm:"lab-lch"})],tg.prototype,"algorithm",void 0),h([p({type:ae,json:{type:[It],write:!0}})],tg.prototype,"fromColor",void 0),h([p({type:ae,json:{type:[It],write:!0}})],tg.prototype,"toColor",void 0),h([p({type:["algorithmic"]})],tg.prototype,"type",void 0),tg=zD=h([P("esri.rest.support.AlgorithmicColorRamp")],tg);const YV=tg;var VD;let Gw=VD=class extends ZV{constructor(t){super(t),this.colorRamps=null,this.type="multipart"}clone(){return new VD({colorRamps:q(this.colorRamps)})}};h([p({type:[YV],json:{write:!0}})],Gw.prototype,"colorRamps",void 0),h([p({type:["multipart"]})],Gw.prototype,"type",void 0),Gw=VD=h([P("esri.rest.support.MultipartColorRamp")],Gw);const FP=Gw,zP={key:"type",base:ZV,typeMap:{algorithmic:YV,multipart:FP}};function VP(t){return t&&t.type?t.type==="algorithmic"?YV.fromJSON(t):t.type==="multipart"?FP.fromJSON(t):null:null}var jD;const dm=new qe({esriClassifyDefinedInterval:"defined-interval",esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation"}),SI=new qe({pieChart:"pie-chart",classedSize:"class-breaks-size",classedColor:"class-breaks-color",univariateColorSize:"univariate-color-size",relationship:"relationship",predominance:"predominance",dotDensity:"dot-density",flow:"flow"}),vG=new qe({classedSize:"class-breaks-size",classedColor:"class-breaks-color",univariateColorSize:"univariate-color-size",relationship:"relationship",predominance:"predominance",dotDensity:"dot-density"}),_G=["inches","feet","yards","miles","nautical-miles","millimeters","centimeters","decimeters","meters","kilometers","decimal-degrees"],_Oe=["high-to-low","above-and-below","above","below","90-10"],bOe=["flow-line","wave-front"],wOe=["caret","circle-caret","arrow","circle-arrow","plus-minus","circle-plus-minus","square","circle","triangle","happy-sad","thumb","custom"];let cn=jD=class extends ie{constructor(t){super(t),this.colorRamp=null,this.fadeRatio=null,this.isAutoGenerated=!1,this.lengthUnit=null,this.maxSliderValue=null,this.minSliderValue=null,this.visualVariables=null}get classificationMethod(){const t=this._get("classificationMethod"),e=this.type;return e&&e!=="relationship"?e==="class-breaks-size"||e==="class-breaks-color"?t||"manual":null:t}set classificationMethod(t){this._set("classificationMethod",t)}readColorRamp(t){return t?VP(t):void 0}get fields(){return this.type&&this.type!=="predominance"?null:this._get("fields")}set fields(t){this._set("fields",t)}get field1(){return this.type&&this.type!=="relationship"?null:this._get("field1")}set field1(t){this._set("field1",t)}get field2(){return this.type&&this.type!=="relationship"?null:this._get("field2")}set field2(t){this._set("field2",t)}get flowTheme(){return this.type==="flow"?this._get("flowTheme"):null}set flowTheme(t){this._set("flowTheme",t)}get focus(){return this.type&&this.type!=="relationship"?null:this._get("focus")}set focus(t){this._set("focus",t)}get numClasses(){return this.type&&this.type!=="relationship"?null:this._get("numClasses")}set numClasses(t){this._set("numClasses",t)}get statistics(){return this.type==="univariate-color-size"&&this.univariateTheme==="above-and-below"?this._get("statistics"):null}set statistics(t){this._set("statistics",t)}get standardDeviationInterval(){const t=this.type;return t&&t!=="relationship"&&t!=="class-breaks-size"&&t!=="class-breaks-color"||this.classificationMethod&&this.classificationMethod!=="standard-deviation"?null:this._get("standardDeviationInterval")}set standardDeviationInterval(t){this._set("standardDeviationInterval",t)}get type(){return this._get("type")}set type(t){let e=t;t==="classed-size"?e="class-breaks-size":t==="classed-color"&&(e="class-breaks-color"),this._set("type",e)}get univariateSymbolStyle(){return this.type==="univariate-color-size"&&this.univariateTheme==="above-and-below"?this._get("univariateSymbolStyle"):null}set univariateSymbolStyle(t){this._set("univariateSymbolStyle",t)}get univariateTheme(){return this.type==="univariate-color-size"?this._get("univariateTheme"):null}set univariateTheme(t){this._set("univariateTheme",t)}clone(){return new jD({classificationMethod:this.classificationMethod,colorRamp:q(this.colorRamp),fadeRatio:q(this.fadeRatio),fields:this.fields&&this.fields.slice(0),field1:q(this.field1),field2:q(this.field2),isAutoGenerated:this.isAutoGenerated,focus:this.focus,numClasses:this.numClasses,maxSliderValue:this.maxSliderValue,minSliderValue:this.minSliderValue,lengthUnit:this.lengthUnit,statistics:this.statistics,standardDeviationInterval:this.standardDeviationInterval,type:this.type,visualVariables:this.visualVariables&&this.visualVariables.map(t=>t.clone()),univariateSymbolStyle:this.univariateSymbolStyle,univariateTheme:this.univariateTheme,flowTheme:this.flowTheme})}};h([p({type:dm.apiValues,value:null,json:{type:dm.jsonValues,read:dm.read,write:dm.write,origins:{"web-document":{default:"manual",type:dm.jsonValues,read:dm.read,write:dm.write}}}})],cn.prototype,"classificationMethod",null),h([p({types:zP,json:{write:!0}})],cn.prototype,"colorRamp",void 0),h([_e("colorRamp")],cn.prototype,"readColorRamp",null),h([p({json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],cn.prototype,"fadeRatio",void 0),h([p({type:[String],value:null,json:{write:!0}})],cn.prototype,"fields",null),h([p({type:Up,value:null,json:{write:!0}})],cn.prototype,"field1",null),h([p({type:Up,value:null,json:{write:!0}})],cn.prototype,"field2",null),h([p({type:bOe,value:null,json:{write:!0,origins:{"web-scene":{write:!1}}}})],cn.prototype,"flowTheme",null),h([p({type:["HH","HL","LH","LL"],value:null,json:{write:!0}})],cn.prototype,"focus",null),h([p({type:Boolean,json:{write:!0,default:!1,origins:{"web-scene":{write:!1}}}})],cn.prototype,"isAutoGenerated",void 0),h([p({type:Number,value:null,json:{type:It,write:!0}})],cn.prototype,"numClasses",null),h([p({type:_G,json:{type:_G,read:!1,write:!1,origins:{"web-scene":{read:!0,write:!0}}}})],cn.prototype,"lengthUnit",void 0),h([p({type:Number,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],cn.prototype,"maxSliderValue",void 0),h([p({type:Number,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],cn.prototype,"minSliderValue",void 0),h([p({type:Object,value:null,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],cn.prototype,"statistics",null),h([p({type:[.25,.33,.5,1],value:null,json:{type:[.25,.33,.5,1],write:!0}})],cn.prototype,"standardDeviationInterval",null),h([p({type:SI.apiValues,value:null,json:{type:SI.jsonValues,read:SI.read,write:SI.write,origins:{"web-scene":{type:vG.jsonValues,write:{writer:vG.write,overridePolicy:t=>({enabled:t!=="flow"})}}}}})],cn.prototype,"type",null),h([p({type:[vOe],json:{write:!0}})],cn.prototype,"visualVariables",void 0),h([p({type:wOe,value:null,json:{write:!0,origins:{"web-scene":{write:!1}}}})],cn.prototype,"univariateSymbolStyle",null),h([p({type:_Oe,value:null,json:{write:!0,origins:{"web-scene":{write:!1}}}})],cn.prototype,"univariateTheme",null),cn=jD=h([P("esri.renderers.support.AuthoringInfo")],cn);const rT=cn,tO=new qe({simple:"simple",uniqueValue:"unique-value",classBreaks:"class-breaks",heatmap:"heatmap",dotDensity:"dot-density",dictionary:"dictionary",pieChart:"pie-chart"},{ignoreUnknown:!0});let Hw=class extends ie{constructor(e){super(e),this.authoringInfo=null,this.type=null}async getRequiredFields(e){if(!this.collectRequiredFields)return[];const i=new Set;return await this.collectRequiredFields(i,e),Array.from(i).sort()}getSymbol(e,i){}async getSymbolAsync(e,i){}getSymbols(){return[]}getAttributeHash(){return JSON.stringify(this)}getMeshHash(){return JSON.stringify(this)}};h([p({type:rT,json:{write:!0}})],Hw.prototype,"authoringInfo",void 0),h([p({type:tO.apiValues,readOnly:!0,json:{type:tO.jsonValues,read:!1,write:{writer:tO.write,ignoreOrigin:!0}}})],Hw.prototype,"type",void 0),Hw=h([P("esri.renderers.Renderer")],Hw);const gd=Hw;function xOe(t){var e,i;return((i=(e=t.match(SOe))==null?void 0:e[1])==null?void 0:i.replace(/\\'/g,"'"))??null}const SOe=/^hash\(\$feature\['((\\'|[^'])+)'\]\) \* 8\.381e-8$/;var BD;let wy=BD=class extends ie{constructor(){super(...arguments),this.title=null}clone(){return new BD({title:this.title})}};h([p({type:String,json:{write:!0}})],wy.prototype,"title",void 0),wy=BD=h([P("esri.renderers.support.LegendOptions")],wy);var UD;let LM=UD=class extends wy{constructor(){super(...arguments),this.showLegend=null}clone(){return new UD({title:this.title,showLegend:this.showLegend})}};h([p({type:Boolean,json:{write:!0}})],LM.prototype,"showLegend",void 0),LM=UD=h([P("esri.renderers.visualVariables.support.VisualVariableLegendOptions")],LM);const woe=LM,iO=new qe({colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation",sizeInfo:"size"});let ql=class extends ie{constructor(e){super(e),this.index=null,this.type=null,this.field=null,this.valueExpression=null,this.valueExpressionTitle=null,this.legendOptions=null}castField(e){return e==null?e:typeof e=="function"?(ne.getLogger(this).error(".field: field must be a string value"),null):LS(e)}get arcadeRequired(){return!!this.valueExpression}clone(){}getAttributeHash(){return`${this.type}-${this.field}-${this.valueExpression}`}};h([p()],ql.prototype,"index",void 0),h([p({type:iO.apiValues,readOnly:!0,json:{read:iO.read,write:iO.write}})],ql.prototype,"type",void 0),h([p({type:String,json:{write:!0}})],ql.prototype,"field",void 0),h([ut("field")],ql.prototype,"castField",null),h([p({type:String,json:{write:!0}})],ql.prototype,"valueExpression",void 0),h([p({type:String,json:{write:!0}})],ql.prototype,"valueExpressionTitle",void 0),h([p({readOnly:!0})],ql.prototype,"arcadeRequired",null),h([p({type:woe,json:{write:!0}})],ql.prototype,"legendOptions",void 0),ql=h([P("esri.renderers.visualVariables.VisualVariable")],ql);const sT=ql;var GD;let ig=GD=class extends ie{constructor(t){super(t),this.color=null,this.label=null,this.value=null}writeValue(t,e,i){e[i]=t??0}clone(){return new GD({color:this.color&&this.color.clone(),label:this.label,value:this.value})}};h([p({type:ae,json:{type:[It],write:!0}})],ig.prototype,"color",void 0),h([p({type:String,json:{write:!0}})],ig.prototype,"label",void 0),h([p({type:Number,json:{write:{writerEnsuresNonNull:!0}}})],ig.prototype,"value",void 0),h([ge("value")],ig.prototype,"writeValue",null),ig=GD=h([P("esri.renderers.visualVariables.support.ColorStop")],ig);const TOe=ig;var HD;let ng=HD=class extends sT{constructor(t){super(t),this.type="color",this.normalizationField=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null}}set stops(t){t&&Array.isArray(t)&&(t=t.filter(e=>!!e)).sort((e,i)=>e.value-i.value),this._set("stops",t)}clone(){return new HD({field:this.field,normalizationField:this.normalizationField,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,stops:this.stops&&this.stops.map(t=>t.clone()),legendOptions:this.legendOptions&&this.legendOptions.clone()})}getAttributeHash(){return`${super.getAttributeHash()}-${this.normalizationField}`}_interpolateData(){return this.stops&&this.stops.map(t=>t.value||0)}};h([p({readOnly:!0})],ng.prototype,"cache",null),h([p({type:["color"],json:{type:["colorInfo"]}})],ng.prototype,"type",void 0),h([p({type:String,json:{write:!0}})],ng.prototype,"normalizationField",void 0),h([p({type:[TOe],json:{write:!0}})],ng.prototype,"stops",null),ng=HD=h([P("esri.renderers.visualVariables.ColorVariable")],ng);const xoe=ng;var qD;let pp=qD=class extends ie{constructor(t){super(t),this.label=null,this.opacity=null,this.value=null}readOpacity(t,e){return k2(e.transparency)}writeOpacity(t,e,i){e[i]=I6(t)}clone(){return new qD({label:this.label,opacity:this.opacity,value:this.value})}};h([p({type:String,json:{write:!0}})],pp.prototype,"label",void 0),h([p({type:Number,json:{type:It,write:{target:"transparency"}}})],pp.prototype,"opacity",void 0),h([_e("opacity",["transparency"])],pp.prototype,"readOpacity",null),h([ge("opacity")],pp.prototype,"writeOpacity",null),h([p({type:Number,json:{write:!0}})],pp.prototype,"value",void 0),pp=qD=h([P("esri.renderers.visualVariables.support.OpacityStop")],pp);const IOe=pp;var WD;let rg=WD=class extends sT{constructor(t){super(t),this.type="opacity",this.normalizationField=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null}}set stops(t){t&&Array.isArray(t)&&(t=t.filter(e=>!!e)).sort((e,i)=>e.value-i.value),this._set("stops",t)}clone(){return new WD({field:this.field,normalizationField:this.normalizationField,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,stops:this.stops&&this.stops.map(t=>t.clone()),legendOptions:this.legendOptions&&this.legendOptions.clone()})}getAttributeHash(){return`${super.getAttributeHash()}-${this.normalizationField}`}_interpolateData(){return this.stops&&this.stops.map(t=>t.value||0)}};h([p({readOnly:!0})],rg.prototype,"cache",null),h([p({type:["opacity"],json:{type:["transparencyInfo"]}})],rg.prototype,"type",void 0),h([p({type:String,json:{write:!0}})],rg.prototype,"normalizationField",void 0),h([p({type:[IOe],json:{write:!0}})],rg.prototype,"stops",null),rg=WD=h([P("esri.renderers.visualVariables.OpacityVariable")],rg);const Soe=rg;var JD;let dh=JD=class extends sT{constructor(t){super(t),this.axis=null,this.type="rotation",this.rotationType="geographic",this.valueExpressionTitle=null}get cache(){return{hasExpression:!!this.valueExpression,compiledFunc:null}}writeValueExpressionTitleWebScene(t,e,i,n){if(n&&n.messages){const r=`visualVariables[${this.index}]`;n.messages.push(new V("property:unsupported",this.type+"VisualVariable.valueExpressionTitle is not supported in Web Scene. Please remove this property to save the Web Scene.",{instance:this,propertyName:r+".valueExpressionTitle",context:n}))}}clone(){return new JD({axis:this.axis,rotationType:this.rotationType,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,legendOptions:this.legendOptions&&this.legendOptions.clone()})}};h([p({readOnly:!0})],dh.prototype,"cache",null),h([p({type:["heading","tilt","roll"],json:{origins:{"web-scene":{default:"heading",write:!0}}}})],dh.prototype,"axis",void 0),h([p({type:["rotation"],json:{type:["rotationInfo"]}})],dh.prototype,"type",void 0),h([p({type:["geographic","arithmetic"],json:{write:!0,origins:{"web-document":{write:!0,default:"geographic"}}}})],dh.prototype,"rotationType",void 0),h([p({type:String,json:{write:!0}})],dh.prototype,"valueExpressionTitle",void 0),h([ge("web-scene","valueExpressionTitle")],dh.prototype,"writeValueExpressionTitleWebScene",null),dh=JD=h([P("esri.renderers.visualVariables.RotationVariable")],dh);const jP=dh;var ZD;let Cv=ZD=class extends ie{constructor(t){super(t),this.label=null,this.size=null,this.value=null}clone(){return new ZD({label:this.label,size:this.size,value:this.value})}};h([p({type:String,json:{write:!0}})],Cv.prototype,"label",void 0),h([p({type:Number,cast:vt,json:{write:!0}})],Cv.prototype,"size",void 0),h([p({type:Number,json:{write:!0}})],Cv.prototype,"value",void 0),Cv=ZD=h([P("esri.renderers.visualVariables.support.SizeStop")],Cv);const Mv=Cv;var YD;let RM=YD=class extends woe{constructor(){super(...arguments),this.customValues=null}clone(){return new YD({title:this.title,showLegend:this.showLegend,customValues:this.customValues&&this.customValues.slice(0)})}};h([p({type:[Number],json:{write:!0}})],RM.prototype,"customValues",void 0),RM=YD=h([P("esri.renderers.visualVariables.support.SizeVariableLegendOptions")],RM);const Toe=RM;var Jh,vr;function df(t){return t&&t.declaredClass==="esri.renderers.visualVariables.SizeVariable"}function K2(t){return t!=null&&!isNaN(t)&&isFinite(t)}function Ioe(t){return t.valueExpression?Jh.Expression:t.field&&typeof t.field=="string"?Jh.Field:Jh.Unknown}function COe(t,e){const i=e||Ioe(t),n=t.valueUnit||"unknown";return i===Jh.Unknown?vr.Constant:t.stops?vr.Stops:t.minSize!=null&&t.maxSize!=null&&t.minDataValue!=null&&t.maxDataValue!=null?vr.ClampedLinear:n==="unknown"?t.minSize!=null&&t.minDataValue!=null?t.minSize&&t.minDataValue?vr.Proportional:vr.Additive:vr.Identity:vr.RealWorldSize}(function(t){t.Unknown="unknown",t.Expression="expression",t.Field="field"})(Jh||(Jh={})),function(t){t.Unknown="unknown",t.Stops="stops",t.ClampedLinear="clamped-linear",t.Proportional="proportional",t.Additive="additive",t.Constant="constant",t.Identity="identity",t.RealWorldSize="real-world-size"}(vr||(vr={}));const BP={unknown:1,inches:ht(1,"meters","inches"),feet:ht(1,"meters","feet"),"us-feet":ht(1,"meters","us-feet"),yards:ht(1,"meters","yards"),miles:ht(1,"meters","miles"),"nautical-miles":ht(1,"meters","nautical-miles"),millimeters:ht(1,"meters","millimeters"),centimeters:ht(1,"meters","centimeters"),decimeters:ht(1,"meters","decimeters"),meters:ht(1,"meters","meters"),kilometers:ht(1,"meters","kilometers"),"decimal-degrees":1/TQ(1,"meters",ci.radius)},Vf=ne.getLogger("esri.renderers.visualVariables.support.visualVariableUtils"),bG=new Vo,DM=Math.PI,Coe=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i;function Moe(t,e,i){const n="visualVariables"in t&&t.visualVariables?t.visualVariables.find(g=>g.type==="color"):t;if(!n)return;if(n.declaredClass!=="esri.renderers.visualVariables.ColorVariable")return void Vf.warn("The visualVariable should be an instance of esri.renderers.visualVariables.ColorVariable");const r=typeof e=="number",s=r?null:e,o=s&&s.attributes;let a=r?e:null;const l=n.field,{ipData:c,hasExpression:u}=n.cache;let d=n.cache.compiledFunc;if(!l&&!u){const g=n.stops;return g&&g[0]&&g[0].color}if(typeof a!="number")if(u){if(i==null||i.arcade==null)return void Vf.error("Use of arcade expressions requires an arcade context");const g={viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference},y=i.arcade.arcadeUtils,_=y.getViewInfo(g),b=y.createExecContext(s,_);if(!d){const w=y.createSyntaxTree(n.valueExpression);d=y.createFunction(w),n.cache.compiledFunc=d}a=y.executeFunction(d,b)}else o&&(a=o[l]);const f=n.normalizationField,m=o!=null&&f!=null?parseFloat(o[f]):void 0;if(a!=null&&(!f||r||!isNaN(m)&&m!==0)){isNaN(m)||r||(a/=m);const g=KV(a,c);if(g){const y=g[0],_=g[1],b=y===_?n.stops[y].color:ae.blendColors(n.stops[y].color,n.stops[_].color,g[2],i!=null?i.color:void 0);return new ae(b)}}}function Eoe(t,e,i){const n="visualVariables"in t&&t.visualVariables?t.visualVariables.find(g=>g.type==="opacity"):t;if(!n)return;if(n.declaredClass!=="esri.renderers.visualVariables.OpacityVariable")return void Vf.warn("The visualVariable should be an instance of esri.renderers.visualVariables.OpacityVariable");const r=typeof e=="number",s=r?null:e,o=s&&s.attributes;let a=r?e:null;const l=n.field,{ipData:c,hasExpression:u}=n.cache;let d=n.cache.compiledFunc;if(!l&&!u){const g=n.stops;return g&&g[0]&&g[0].opacity}if(typeof a!="number")if(u){if(i==null||i.arcade==null)return void Vf.error("Use of arcade expressions requires an arcade context");const g={viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference},y=i.arcade.arcadeUtils,_=y.getViewInfo(g),b=y.createExecContext(s,_);if(!d){const w=y.createSyntaxTree(n.valueExpression);d=y.createFunction(w),n.cache.compiledFunc=d}a=y.executeFunction(d,b)}else o&&(a=o[l]);const f=n.normalizationField,m=o!=null&&f!=null?parseFloat(o[f]):void 0;if(a!=null&&(!f||r||!isNaN(m)&&m!==0)){isNaN(m)||r||(a/=m);const g=KV(a,c);if(g){const y=g[0],_=g[1];if(y===_)return n.stops[y].opacity;{const b=n.stops[y].opacity;return b+(n.stops[_].opacity-b)*g[2]}}}}function XV(t,e,i){const n="visualVariables"in t&&t.visualVariables?t.visualVariables.find(m=>m.type==="rotation"):t;if(!n)return;if(n.declaredClass!=="esri.renderers.visualVariables.RotationVariable")return void Vf.warn("The visualVariable should be an instance of esri.renderers.visualVariables.RotationVariable");const r=n.axis||"heading",s=r==="heading"&&n.rotationType==="arithmetic"?90:0,o=r==="heading"&&n.rotationType==="arithmetic"?-1:1,a=typeof e=="number"?null:e,l=a&&a.attributes,c=n.field,{hasExpression:u}=n.cache;let d=n.cache.compiledFunc,f=0;if(!c&&!u)return f;if(u){if(i==null||i.arcade==null)return void Vf.error("Use of arcade expressions requires an arcade context");const m={viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference},g=i.arcade.arcadeUtils,y=g.getViewInfo(m),_=g.createExecContext(a,y);if(!d){const b=g.createSyntaxTree(n.valueExpression);d=g.createFunction(b),n.cache.compiledFunc=d}f=g.executeFunction(d,_)}else l&&(f=l[c]||0);return f=typeof f!="number"||isNaN(f)?null:s+o*f,f}function MOe(t,e,i){const n=typeof e=="number",r=n?null:e,s=r&&r.attributes;let o=n?e:null;const{isScaleDriven:a}=t.cache;let l=t.cache.compiledFunc;if(a){const u=i!=null?i.scale:void 0,d=i!=null?i.view:void 0;o=u==null||d==="3d"?EOe(t):u}else if(!n)switch(t.inputValueType){case Jh.Expression:{if(i==null||i.arcade==null)return void Vf.error("Use of arcade expressions requires an arcade context");const u={viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference},d=i.arcade.arcadeUtils,f=d.getViewInfo(u),m=d.createExecContext(r,f);if(!l){const g=d.createSyntaxTree(t.valueExpression);l=d.createFunction(g),t.cache.compiledFunc=l}o=d.executeFunction(l,m);break}case Jh.Field:s&&(o=s[t.field]);break;case Jh.Unknown:o=null}if(!K2(o))return null;if(n||!t.normalizationField)return o;const c=s?parseFloat(s[t.normalizationField]):null;return K2(c)&&c!==0?o/c:null}function EOe(t){let e=null,i=null;const n=t.stops;return n?(e=n[0].value,i=n[n.length-1].value):(e=t.minDataValue||0,i=t.maxDataValue||0),(e+i)/2}function UP(t,e,i){const n="visualVariables"in t&&t.visualVariables?t.visualVariables.find(s=>s.type==="size"):t;if(!n)return;if(n.declaredClass!=="esri.renderers.visualVariables.SizeVariable")return void Vf.warn("The visualVariable should be an instance of esri.renderers.visualVariables.SizeVariable");const r=$oe(MOe(n,e,i),n,e,i,n.cache.ipData);return r==null||isNaN(r)?0:r}function Do(t,e,i){return t==null?null:df(t)?UP(t,e,i):K2(t)?t:null}function Aoe(t,e,i){return K2(i)&&t>i?i:K2(e)&&t<e?e:t}function AOe(t,e,i,n){return t+((Do(e.minSize,i,n)||e.minDataValue)??0)}function $Oe(t,e,i){const n=t.stops;let r=n&&n.length&&n[0].size;return r==null&&(r=t.minSize),Do(r,e,i)}function POe(t,e,i,n){const r=(t-e.minDataValue)/(e.maxDataValue-e.minDataValue),s=Do(e.minSize,i,n),o=Do(e.maxSize,i,n),a=n!=null?n.shape:void 0;if(t<=e.minDataValue)return s;if(t>=e.maxDataValue)return o;if(s==null||o==null)return null;if(e.scaleBy==="area"&&a){const l=a==="circle",c=l?DM*(s/2)**2:s*s,u=c+r*((l?DM*(o/2)**2:o*o)-c);return l?2*Math.sqrt(u/DM):Math.sqrt(u)}return s+r*(o-s)}function kOe(t,e,i,n){const r=n!=null?n.shape:void 0,s=t/e.minDataValue,o=Do(e.minSize,i,n),a=Do(e.maxSize,i,n);let l=null;return l=r==="circle"?2*Math.sqrt(s*(o/2)**2):r==="square"||r==="diamond"||r==="image"?Math.sqrt(s*o**2):s*o,Aoe(l,o,a)}function OOe(t,e,i,n,r){var l,c,u;const[s,o,a]=KV(t,r);if(s===o)return Do((l=e.stops)==null?void 0:l[s].size,i,n);{const d=Do((c=e.stops)==null?void 0:c[s].size,i,n);return d+(Do((u=e.stops)==null?void 0:u[o].size,i,n)-d)*a}}function LOe(t,e,i,n){const r=(n!=null&&n.resolution?n.resolution:1)*BP[e.valueUnit],s=Do(e.minSize,i,n),o=Do(e.maxSize,i,n),{valueRepresentation:a}=e;let l=null;return l=a==="area"?2*Math.sqrt(t/DM)/r:a==="radius"||a==="distance"?2*t/r:t/r,Aoe(l,s,o)}function $oe(t,e,i,n,r){switch(e.transformationType){case vr.Additive:return AOe(t,e,i,n);case vr.Constant:return $Oe(e,i,n);case vr.ClampedLinear:return POe(t,e,i,n);case vr.Proportional:return kOe(t,e,i,n);case vr.Stops:return OOe(t,e,i,n,r);case vr.RealWorldSize:return LOe(t,e,i,n);case vr.Identity:return t;case vr.Unknown:return null}}function ROe(t,e,i){const{isScaleDriven:n}=t.cache;if(!(n&&i==="3d"||e))return null;const r={scale:e,view:i};let s=Do(t.minSize,bG,r),o=Do(t.maxSize,bG,r);if(s!=null||o!=null){if(s>o){const a=o;o=s,s=a}return{minSize:s,maxSize:o}}}function DOe(t,e,i){if(!t.visualVariables)return;const n=[],r=[],s=[],o=[],a=[];for(const l of t.visualVariables)switch(l.type){case"color":r.push(l);break;case"opacity":s.push(l);break;case"rotation":a.push(l);break;case"size":o.push(l)}return r.forEach(l=>{const c=Moe(l,e,i);n.push({variable:l,value:c})}),s.forEach(l=>{const c=Eoe(l,e,i);n.push({variable:l,value:c})}),a.forEach(l=>{const c=XV(l,e,i);n.push({variable:l,value:c})}),o.forEach(l=>{const c=UP(l,e,i);n.push({variable:l,value:c})}),n.filter(l=>l.value!=null)}function KV(t,e){if(!e)return;let i=0,n=e.length-1;return e.some((r,s)=>t<r?(n=s,!0):(i=s,!1)),[i,n,(t-e[i])/(e[n]-e[i])]}function Poe(t,e,i){const n=["proportional","proportional","proportional"];for(const r of t){const s=r.useSymbolValue?"symbol-value":UP(r,e,i);switch(r.axis){case"width":n[0]=s;break;case"depth":n[1]=s;break;case"height":n[2]=s;break;case"width-and-depth":n[0]=s,n[1]=s;break;case"all":case void 0:case null:n[0]=s,n[1]=s,n[2]=s;break;default:r.axis}}return n}const c0=Object.freeze(Object.defineProperty({__proto__:null,getAllSizes:Poe,getColor:Moe,getOpacity:Eoe,getRotationAngle:XV,getSize:UP,getSizeForValue:$oe,getSizeFromNumberOrVariable:Do,getSizeRangeAtScale:ROe,getVisualVariableValues:DOe,viewScaleRE:Coe},Symbol.toStringTag,{value:"Module"}));var XD;const TI=new qe({width:"width",depth:"depth",height:"height",widthAndDepth:"width-and-depth",all:"all"}),KD=new qe({unknown:"unknown",inch:"inches",foot:"feet",yard:"yards",mile:"miles","nautical-mile":"nautical-miles",millimeter:"millimeters",centimeter:"centimeters",decimeter:"decimeters",meter:"meters",kilometer:"kilometers","decimal-degree":"decimal-degrees"});function wG(t){if(t!=null)return typeof t=="string"||typeof t=="number"?vt(t):t.type==="size"?df(t)?t:(delete(t={...t}).type,new Rt(t)):void 0}function xG(t,e,i){if(typeof t!="object")return t;const n=new Rt;return n.read(t,i),n}let Rt=XD=class extends sT{constructor(t){super(t),this.axis=null,this.legendOptions=null,this.normalizationField=null,this.scaleBy=null,this.target=null,this.type="size",this.useSymbolValue=null,this.valueExpression=null,this.valueRepresentation=null,this.valueUnit=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null,isScaleDriven:this.valueExpression!=null&&Coe.test(this.valueExpression)}}set expression(t){ne.getLogger(this).warn("'expression' is deprecated since version 4.2. Use 'valueExpression' instead. The only supported expression is 'view.scale'."),t==="view.scale"?(this.valueExpression="$view.scale",this._set("expression",t)):this._set("expression",null)}set index(t){df(this.maxSize)&&(this.maxSize.index=`visualVariables[${t}].maxSize`),df(this.minSize)&&(this.minSize.index=`visualVariables[${t}].minSize`),this._set("index",t)}get inputValueType(){return Ioe(this)}set maxDataValue(t){t&&this.stops&&(ne.getLogger(this).warn("cannot set maxDataValue when stops is not null."),t=null),this._set("maxDataValue",t)}set maxSize(t){t&&this.stops&&(ne.getLogger(this).warn("cannot set maxSize when stops is not null."),t=null),this._set("maxSize",t)}castMaxSize(t){return wG(t)}readMaxSize(t,e,i){return xG(t,e,i)}set minDataValue(t){t&&this.stops&&(ne.getLogger(this).warn("cannot set minDataValue when stops is not null."),t=null),this._set("minDataValue",t)}set minSize(t){t&&this.stops&&(ne.getLogger(this).warn("cannot set minSize when stops is not null."),t=null),this._set("minSize",t)}castMinSize(t){return wG(t)}readMinSize(t,e,i){return xG(t,e,i)}get arcadeRequired(){return!!this.valueExpression||this.minSize!=null&&typeof this.minSize=="object"&&this.minSize.arcadeRequired||this.maxSize!=null&&typeof this.maxSize=="object"&&this.maxSize.arcadeRequired}set stops(t){this.minDataValue==null&&this.maxDataValue==null&&this.minSize==null&&this.maxSize==null?t&&Array.isArray(t)&&(t=t.filter(e=>!!e)).sort((e,i)=>e.value-i.value):t&&(ne.getLogger(this).warn("cannot set stops when one of minDataValue, maxDataValue, minSize or maxSize is not null."),t=null),this._set("stops",t)}get transformationType(){return COe(this,this.inputValueType)}readValueExpression(t,e){return t||e.expression&&"$view.scale"}writeValueExpressionWebScene(t,e,i,n){if(t==="$view.scale"){if(n&&n.messages){const r=this.index,s=typeof r=="string"?r:`visualVariables[${r}]`;n.messages.push(new V("property:unsupported",this.type+"VisualVariable.valueExpression = '$view.scale' is not supported in Web Scene. Please remove this property to save the Web Scene.",{instance:this,propertyName:s+".valueExpression",context:n}))}}else e[i]=t}readValueUnit(t){return t?KD.read(t):null}clone(){return new XD({axis:this.axis,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,maxDataValue:this.maxDataValue,maxSize:df(this.maxSize)?this.maxSize.clone():this.maxSize,minDataValue:this.minDataValue,minSize:df(this.minSize)?this.minSize.clone():this.minSize,normalizationField:this.normalizationField,stops:this.stops&&this.stops.map(t=>t.clone()),target:this.target,useSymbolValue:this.useSymbolValue,valueRepresentation:this.valueRepresentation,valueUnit:this.valueUnit,legendOptions:this.legendOptions&&this.legendOptions.clone()})}flipSizes(){if(this.transformationType===vr.ClampedLinear){const{minSize:t,maxSize:e}=this;return this.minSize=e,this.maxSize=t,this}if(this.transformationType===vr.Stops){const t=this.stops;if(!t)return this;const e=t.map(n=>n.size).reverse(),i=t.length;for(let n=0;n<i;n++)t[n].size=e[n];return this}return this}getAttributeHash(){return`${super.getAttributeHash()}-${this.target}-${this.normalizationField}`}_interpolateData(){return this.stops&&this.stops.map(t=>t.value||0)}};h([p({readOnly:!0})],Rt.prototype,"cache",null),h([p({type:TI.apiValues,json:{type:TI.jsonValues,origins:{"web-map":{read:!1}},read:TI.read,write:TI.write}})],Rt.prototype,"axis",void 0),h([p({type:String,value:null,json:{read:!1}})],Rt.prototype,"expression",null),h([p()],Rt.prototype,"index",null),h([p({type:String,readOnly:!0})],Rt.prototype,"inputValueType",null),h([p({type:Toe,json:{write:!0}})],Rt.prototype,"legendOptions",void 0),h([p({type:Number,value:null,json:{write:!0}})],Rt.prototype,"maxDataValue",null),h([p({type:Number,value:null,json:{write:!0}})],Rt.prototype,"maxSize",null),h([ut("maxSize")],Rt.prototype,"castMaxSize",null),h([_e("maxSize")],Rt.prototype,"readMaxSize",null),h([p({type:Number,value:null,json:{write:!0}})],Rt.prototype,"minDataValue",null),h([p({type:Number,value:null,json:{write:!0}})],Rt.prototype,"minSize",null),h([ut("minSize")],Rt.prototype,"castMinSize",null),h([_e("minSize")],Rt.prototype,"readMinSize",null),h([p({type:String,json:{write:!0}})],Rt.prototype,"normalizationField",void 0),h([p({readOnly:!0})],Rt.prototype,"arcadeRequired",null),h([p({type:String})],Rt.prototype,"scaleBy",void 0),h([p({type:[Mv],value:null,json:{write:!0}})],Rt.prototype,"stops",null),h([p({type:["outline"],json:{write:!0}})],Rt.prototype,"target",void 0),h([p({type:String,readOnly:!0})],Rt.prototype,"transformationType",null),h([p({type:["size"],json:{type:["sizeInfo"]}})],Rt.prototype,"type",void 0),h([p({type:Boolean,json:{write:!0,origins:{"web-map":{read:!1}}}})],Rt.prototype,"useSymbolValue",void 0),h([p({type:String,json:{write:!0}})],Rt.prototype,"valueExpression",void 0),h([_e("valueExpression",["valueExpression","expression"])],Rt.prototype,"readValueExpression",null),h([ge("web-scene","valueExpression")],Rt.prototype,"writeValueExpressionWebScene",null),h([p({type:["radius","diameter","area","width","distance"],json:{write:!0}})],Rt.prototype,"valueRepresentation",void 0),h([p({type:KD.apiValues,json:{write:KD.write,origins:{"web-map":{read:!1},"web-scene":{write:!0},"portal-item":{write:!0}}}})],Rt.prototype,"valueUnit",void 0),h([_e("valueUnit")],Rt.prototype,"readValueUnit",null),Rt=XD=h([P("esri.renderers.visualVariables.SizeVariable")],Rt);const u0=Rt,NOe={color:xoe,size:u0,opacity:Soe,rotation:jP},FOe=new qe({colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation",sizeInfo:"size"}),zOe=/^\[([^\]]+)\]$/i;let NM=class extends ye{constructor(){super(...arguments),this.colorVariables=null,this.opacityVariables=null,this.rotationVariables=null,this.sizeVariables=null}set visualVariables(e){if(this._resetVariables(),(e=e&&e.filter(i=>!!i))&&e.length){for(const i of e)switch(i.type){case"color":this.colorVariables.push(i);break;case"opacity":this.opacityVariables.push(i);break;case"rotation":this.rotationVariables.push(i);break;case"size":this.sizeVariables.push(i)}this.sizeVariables.length&&this.sizeVariables.some(i=>!!i.target)&&e.sort((i,n)=>{let r=null;return r=i.target===n.target?0:i.target?1:-1,r});for(let i=0;i<e.length;i++)e[i].index=i;this._set("visualVariables",e)}else this._set("visualVariables",e)}readVariables(e,i,n){const{rotationExpression:r,rotationType:s}=i,o=r&&r.match(zOe),a=o&&o[1];if(a&&(e||(e=[]),e.push({type:"rotationInfo",rotationType:s,field:a})),e)return e.map(l=>{const c=FOe.read(l.type),u=NOe[c];u||(ne.getLogger(this).warn(`Unknown variable type: ${c}`),n&&n.messages&&n.messages.push(new fl("visual-variable:unsupported",`visualVariable of type '${c}' is not supported`,{definition:l,context:n})));const d=new u;return d.read(l,n),d})}writeVariables(e,i){const n=[];for(const r of e){const s=r.toJSON(i);s&&n.push(s)}return n}_resetVariables(){this.colorVariables=[],this.opacityVariables=[],this.rotationVariables=[],this.sizeVariables=[]}};h([p()],NM.prototype,"visualVariables",null),NM=h([P("esri.renderers.visualVariables.VisualVariableFactory")],NM);const VOe=NM,jOe={base:sT,key:"type",typeMap:{opacity:Soe,color:xoe,rotation:jP,size:u0}},Qf=t=>{let e=class extends t{constructor(){super(...arguments),this._vvFactory=new VOe}set visualVariables(i){this._vvFactory.visualVariables=i,this._set("visualVariables",this._vvFactory.visualVariables)}readVisualVariables(i,n,r){return this._vvFactory.readVariables(i,n,r)}writeVisualVariables(i,n,r,s){n[r]=this._vvFactory.writeVariables(i,s)}get arcadeRequiredForVisualVariables(){if(!this.visualVariables)return!1;for(const i of this.visualVariables)if(i.arcadeRequired)return!0;return!1}hasVisualVariables(i,n){return i?this.getVisualVariablesForType(i,n).length>0:this.getVisualVariablesForType("size",n).length>0||this.getVisualVariablesForType("color",n).length>0||this.getVisualVariablesForType("opacity",n).length>0||this.getVisualVariablesForType("rotation",n).length>0}getVisualVariablesForType(i,n){const r=this.visualVariables;return r?r.filter(s=>s.type===i&&(typeof n=="string"?s.target===n:n!==!1||!s.target)):[]}async collectVVRequiredFields(i,n){let r=[];this.visualVariables&&(r=r.concat(this.visualVariables));for(const s of r)s&&(s.field&&va(i,n,s.field),s.normalizationField&&va(i,n,s.normalizationField),s.valueExpression&&(BOe(s.valueExpression,i,n)||await ro(i,n,s.valueExpression)))}};return h([p({types:[jOe],value:null,json:{write:!0}})],e.prototype,"visualVariables",null),h([_e("visualVariables",["visualVariables","rotationType","rotationExpression"])],e.prototype,"readVisualVariables",null),h([ge("visualVariables")],e.prototype,"writeVisualVariables",null),e=h([P("esri.renderers.mixins.VisualVariablesMixin")],e),e};function BOe(t,e,i){const n=xOe(t);return n!=null&&(va(e,i,n),!0)}const Ev={retainId:!1,ignoreDrivers:!1,hasLabelingContext:!0};function pb(t,e=Ev){var a,l;if(!t)return{symbol:null};const{retainId:i=Ev.retainId,ignoreDrivers:n=Ev.ignoreDrivers,hasLabelingContext:r=Ev.hasLabelingContext,retainCIM:s=Ev.retainCIM}=e;let o=null;if(Ou(t)||t instanceof a0)o=t.clone();else if(t.type==="cim"){const c=(l=(a=t.data)==null?void 0:a.symbol)==null?void 0:l.type;if(c!=="CIMPointSymbol")return{error:new V("symbol-conversion:unsupported-cim-symbol",`CIM symbol of type '${c||"unknown"}' is unsupported in 3D`,{symbol:t})};o=s?t.clone():sy.fromCIMSymbol(t)}else if(t instanceof Ur)o=vP.fromSimpleLineSymbol(t);else if(t instanceof rs)o=sy.fromSimpleMarkerSymbol(t);else if(t instanceof Mf)o=sy.fromPictureMarkerSymbol(t);else if(t instanceof Pc)o=e.geometryType&&e.geometryType==="mesh"?YS.fromSimpleFillSymbol(t):XS.fromSimpleFillSymbol(t);else{if(!(t instanceof o0))return{error:new V("symbol-conversion:unsupported-2d-symbol",`2D symbol of type '${t.type||t.declaredClass}' is unsupported in 3D`,{symbol:t})};o=r?yP.fromTextSymbol(t):sy.fromTextSymbol(t)}return i&&o&&o.type!=="cim"&&(o.id=t.id),n&&Ou(o)&&o.symbolLayers.forEach(c=>c.ignoreDrivers=!0),{symbol:o}}function RA(t,e,i,n){const r=koe(t,{},{context:n,isLabelSymbol:!1});r!=null&&(e[i]=r)}function SG(t,e,i,n){const r=koe(t,{},{context:n,isLabelSymbol:!0});r!=null&&(e[i]=r)}function TG(t){return t instanceof qb||t instanceof a0}function koe(t,e,i){if(t==null)return null;const{context:n,isLabelSymbol:r}=i,s=n==null?void 0:n.origin,o=n==null?void 0:n.messages;if(s==="web-scene"&&!TG(t)){const a=pb(t,{retainCIM:!0,hasLabelingContext:r});return a.symbol!=null?a.symbol.write(e,n):(o==null||o.push(new V("symbol:unsupported",`Symbols of type '${t.declaredClass}' are not supported in scenes. Use 3D symbology instead when working with WebScene and SceneView`,{symbol:t,context:n,error:a.error})),null)}return(s==="web-map"||s==="portal-item"&&!UQ(n==null?void 0:n.layer))&&TG(t)?(o==null||o.push(new V("symbol:unsupported",`Symbols of type '${t.declaredClass}' are not supported in web maps and portal items. Use 2D symbology and CIMSymbol instead when working with MapView`,{symbol:t,context:n})),null):t.write(e,n)}function Ooe(t,e){return wTe(t,null,e)}const Yb={types:ine,json:{write:{writer:RA},origins:{"web-scene":{types:TU,write:{writer:RA},read:{reader:Ob({types:TU})}}}}},Loe={types:{base:Go,key:"type",typeMap:{"simple-fill":Su.typeMap["simple-fill"],"picture-fill":Su.typeMap["picture-fill"],"polygon-3d":Su.typeMap["polygon-3d"]}},json:{write:{writer:RA},origins:{"web-scene":{type:XS,write:{writer:RA}}}}},FM={cast:t=>t==null||typeof t=="string"||typeof t=="number"?t:`${t}`,json:{type:String,write:{writer:(t,e)=>{e.value=t==null?void 0:t.toString()}}}};var QD;let fp=QD=class extends ie{constructor(t){super(t),this.description=null,this.label=null,this.minValue=null,this.maxValue=0,this.symbol=null}clone(){return new QD({description:this.description,label:this.label,minValue:this.minValue,maxValue:this.maxValue,symbol:this.symbol?this.symbol.clone():null})}getMeshHash(){const t=JSON.stringify(this.symbol);return`${this.minValue}.${this.maxValue}.${t}`}};h([p({type:String,json:{write:!0}})],fp.prototype,"description",void 0),h([p({type:String,json:{write:!0}})],fp.prototype,"label",void 0),h([p({type:Number,json:{read:{source:"classMinValue"},write:{target:"classMinValue"}}})],fp.prototype,"minValue",void 0),h([p({type:Number,json:{read:{source:"classMaxValue"},write:{target:"classMaxValue"}}})],fp.prototype,"maxValue",void 0),h([p(Yb)],fp.prototype,"symbol",void 0),fp=QD=h([P("esri.renderers.support.ClassBreakInfo")],fp);const fb=fp;var eN;const Roe="log",zM="percent-of-total",VM="field",II=new qe({esriNormalizeByLog:Roe,esriNormalizeByPercentOfTotal:zM,esriNormalizeByField:VM}),UOe=fn(fb);let Gn=eN=class extends Qf(gd){constructor(t){super(t),this._compiledValueExpression={valueExpression:null,compiledFunction:null},this.backgroundFillSymbol=null,this.classBreakInfos=null,this.defaultLabel=null,this.defaultSymbol=null,this.field=null,this.isMaxInclusive=!0,this.legendOptions=null,this.normalizationField=null,this.normalizationTotal=null,this.type="class-breaks",this.valueExpression=null,this.valueExpressionTitle=null,this._set("classBreakInfos",[])}readClassBreakInfos(t,e,i){if(!Array.isArray(t))return;let n=e.minValue;return t.map(r=>{const s=new fb;return s.read(r,i),s.minValue==null&&(s.minValue=n),s.maxValue==null&&(s.maxValue=s.minValue),n=s.maxValue,s})}writeClassBreakInfos(t,e,i,n){const r=t.map(s=>s.write({},n));this._areClassBreaksConsecutive()&&r.forEach(s=>delete s.classMinValue),e[i]=r}castField(t){return t==null?t:typeof t=="function"?(ne.getLogger(this).error(".field: field must be a string value"),null):LS(t)}get minValue(){return this.classBreakInfos&&this.classBreakInfos[0]&&this.classBreakInfos[0].minValue||0}get normalizationType(){let t=this._get("normalizationType");const e=!!this.normalizationField,i=this.normalizationTotal!=null;return e||i?(t=e&&VM||i&&zM||null,e&&i&&ne.getLogger(this).warn("warning: both normalizationField and normalizationTotal are set!")):t!==VM&&t!==zM||(t=null),t}set normalizationType(t){this._set("normalizationType",t)}addClassBreakInfo(t,e,i){let n=null;n=typeof t=="number"?new fb({minValue:t,maxValue:e,symbol:nne(i)}):UOe(q(t)),this.classBreakInfos.push(n),this.classBreakInfos.length===1&&this.notifyChange("minValue")}removeClassBreakInfo(t,e){const i=this.classBreakInfos.length;for(let n=0;n<i;n++){const r=[this.classBreakInfos[n].minValue,this.classBreakInfos[n].maxValue];if(r[0]===t&&r[1]===e){this.classBreakInfos.splice(n,1);break}}}getBreakIndex(t,e){return!this.valueExpression||e!=null&&e.arcade!=null||ne.getLogger(this).warn(""),this.valueExpression?this._getBreakIndexForExpression(t,e):this._getBreakIndexForField(t)}async getClassBreakInfo(t,e){let i=e;!this.valueExpression||e!=null&&e.arcade!=null||(i={...i,arcade:await ld()});const n=this.getBreakIndex(t,i);return n!==-1?this.classBreakInfos[n]:null}getSymbol(t,e){if(this.valueExpression&&(e==null||e.arcade==null))return void ne.getLogger(this).error("#getSymbol()","Please use getSymbolAsync if valueExpression is used");const i=this.getBreakIndex(t,e);return i>-1?this.classBreakInfos[i].symbol:this.defaultSymbol}async getSymbolAsync(t,e){let i=e;if(this.valueExpression&&(e==null||e.arcade==null)){const r=await ld(),{arcadeUtils:s}=r;s.hasGeometryOperations(this.valueExpression)&&await s.enableGeometryOperations(),i={...i,arcade:r}}const n=this.getBreakIndex(t,i);return n>-1?this.classBreakInfos[n].symbol:this.defaultSymbol}getSymbols(){const t=[];return this.classBreakInfos.forEach(e=>{e.symbol&&t.push(e.symbol)}),this.defaultSymbol&&t.push(this.defaultSymbol),t}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce((t,e)=>t+e.getAttributeHash(),"")}getMeshHash(){const t=JSON.stringify(this.backgroundFillSymbol),e=JSON.stringify(this.defaultSymbol),i=`${this.normalizationField}.${this.normalizationType}.${this.normalizationTotal}`;return`${t}.${e}.${this.classBreakInfos.reduce((n,r)=>n+r.getMeshHash(),"")}.${i}.${this.field}.${this.valueExpression}`}get arcadeRequired(){return this.arcadeRequiredForVisualVariables||!!this.valueExpression}clone(){return new eN({field:this.field,backgroundFillSymbol:this.backgroundFillSymbol&&this.backgroundFillSymbol.clone(),defaultLabel:this.defaultLabel,defaultSymbol:this.defaultSymbol&&this.defaultSymbol.clone(),valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,classBreakInfos:q(this.classBreakInfos),isMaxInclusive:this.isMaxInclusive,normalizationField:this.normalizationField,normalizationTotal:this.normalizationTotal,normalizationType:this.normalizationType,visualVariables:q(this.visualVariables),legendOptions:q(this.legendOptions),authoringInfo:this.authoringInfo&&this.authoringInfo.clone()})}async collectRequiredFields(t,e){const i=[this.collectVVRequiredFields(t,e),this.collectSymbolFields(t,e)];await Promise.all(i)}async collectSymbolFields(t,e){const i=[...this.getSymbols().map(n=>n.collectRequiredFields(t,e)),ro(t,e,this.valueExpression)];va(t,e,this.field),va(t,e,this.normalizationField),await Promise.all(i)}_getBreakIndexForExpression(t,e){const{viewingMode:i,scale:n,spatialReference:r,arcade:s}=e??{},{valueExpression:o}=this;let a=this._compiledValueExpression.valueExpression===o?this._compiledValueExpression.compiledFunction:null;const l=s.arcadeUtils;if(!a){const u=l.createSyntaxTree(o);a=l.createFunction(u),this._compiledValueExpression.compiledFunction=a}this._compiledValueExpression.valueExpression=o;const c=l.executeFunction(a,l.createExecContext(t,l.getViewInfo({viewingMode:i,scale:n,spatialReference:r})));return this._getBreakIndexfromInfos(c)}_getBreakIndexForField(t){const e=this.field,i=t.attributes,n=this.normalizationType;let r=parseFloat(i[e]);if(n){const s=this.normalizationTotal,o=parseFloat(this.normalizationField?i[this.normalizationField]:void 0);if(n===Roe)r=Math.log(r)*Math.LOG10E;else if(n!==zM||s==null||isNaN(s)){if(n===VM&&!isNaN(o)){if(isNaN(r)||isNaN(o))return-1;r/=o}}else r=r/s*100}return this._getBreakIndexfromInfos(r)}_getBreakIndexfromInfos(t){const e=this.isMaxInclusive;if(t!=null&&typeof t=="number"&&!isNaN(t))for(let i=0;i<this.classBreakInfos.length;i++){const n=[this.classBreakInfos[i].minValue,this.classBreakInfos[i].maxValue];if(n[0]<=t&&(e?t<=n[1]:t<n[1]))return i}return-1}_areClassBreaksConsecutive(){const t=this.classBreakInfos,e=t.length;for(let i=1;i<e;i++)if(t[i-1].maxValue!==t[i].minValue)return!1;return!0}};h([p(Loe)],Gn.prototype,"backgroundFillSymbol",void 0),h([p({type:[fb]})],Gn.prototype,"classBreakInfos",void 0),h([_e("classBreakInfos")],Gn.prototype,"readClassBreakInfos",null),h([ge("classBreakInfos")],Gn.prototype,"writeClassBreakInfos",null),h([p({type:String,json:{write:!0}})],Gn.prototype,"defaultLabel",void 0),h([p(Yb)],Gn.prototype,"defaultSymbol",void 0),h([p({type:String,json:{write:!0}})],Gn.prototype,"field",void 0),h([ut("field")],Gn.prototype,"castField",null),h([p({type:Boolean})],Gn.prototype,"isMaxInclusive",void 0),h([p({type:wy,json:{write:!0}})],Gn.prototype,"legendOptions",void 0),h([p({type:Number,readOnly:!0,value:null,json:{read:!1,write:{overridePolicy(){return this.classBreakInfos.length!==0&&this._areClassBreaksConsecutive()?{enabled:!0}:{enabled:!1}}}}})],Gn.prototype,"minValue",null),h([p({type:String,json:{write:!0}})],Gn.prototype,"normalizationField",void 0),h([p({type:Number,cast:t=>Qa(t),json:{write:!0}})],Gn.prototype,"normalizationTotal",void 0),h([p({type:II.apiValues,value:null,json:{type:II.jsonValues,read:II.read,write:II.write}})],Gn.prototype,"normalizationType",null),h([be({classBreaks:"class-breaks"})],Gn.prototype,"type",void 0),h([p({type:String,json:{write:!0}})],Gn.prototype,"valueExpression",void 0),h([p({type:String,json:{write:!0}})],Gn.prototype,"valueExpressionTitle",void 0),Gn=eN=h([P("esri.renderers.ClassBreaksRenderer")],Gn);const Xb=Gn,nO=-3;var Gp;(function(t){t[t.ALL=0]="ALL",t[t.SOME=1]="SOME"})(Gp||(Gp={}));let cdt=class{constructor(e,i,n){this.name=e,this._storage=i,this.id=HOe+++":",this.size=0,this.maxSize=0,this._removeFunc=!1,this._hit=0,this._miss=0,this._storage.register(this),n&&(this._storage.registerRemoveFunc(this.id,n),this._removeFunc=!0)}destroy(){this._storage.clear(this),this._removeFunc&&this._storage.deregisterRemoveFunc(this.id),this._storage.deregister(this),this._storage=null}get hitRate(){return this._hit/(this._hit+this._miss)}get sizeAll(){return this._storage.size}resetHitRate(){this._hit=this._miss=0}put(e,i,n,r=0){this._storage.put(this,e,i,n,r)}get(e){const i=this._storage.get(this,e);return i===void 0?++this._miss:++this._hit,i}pop(e){const i=this._storage.pop(this,e);return i===void 0?++this._miss:++this._hit,i}updateSize(e,i,n){this._storage.updateSize(this,e,i,n)}clear(){this._storage.clear(this)}clearAll(){this._storage.clearAll()}get performanceInfo(){return this._storage.performanceInfo}resetStats(){this._storage.resetStats()}},GOe=class{get size(){return this._size}constructor(e=10485760){this._maxSize=e,this._db=new Map,this._size=0,this._hit=0,this._miss=0,this._removeFuncs=new Sf,this._users=new Sf}destroy(){this.clearAll(),this._removeFuncs.clear(),this._users.clear(),this._db=null}register(e){this._users.push(e)}deregister(e){this._users.removeUnordered(e)}registerRemoveFunc(e,i){this._removeFuncs.push([e,i])}deregisterRemoveFunc(e){this._removeFuncs.filterInPlace(i=>i[0]!==e)}get maxSize(){return this._maxSize}set maxSize(e){this._maxSize=Math.max(e,0),this._checkSizeLimits()}put(e,i,n,r,s){i=e.id+i;const o=this._db.get(i);if(o&&(this._size-=o.size,e.size-=o.size,this._db.delete(i),o.entry!==n&&this._notifyRemove(i,o.entry,Gp.ALL)),r>this._maxSize)return void this._notifyRemove(i,n,Gp.ALL);if(n===void 0)return void console.warn("Refusing to cache undefined entry ");if(!r||r<0)return void console.warn("Refusing to cache entry with invalid size "+r);const a=1+Math.max(s,nO)-nO;this._db.set(i,{entry:n,size:r,lifetime:a,lives:a}),this._size+=r,e.size+=r,this._checkSizeLimits()}updateSize(e,i,n,r){i=e.id+i;const s=this._db.get(i);if(s&&s.entry===n){for(this._size-=s.size,e.size-=s.size;r>this._maxSize;){const o=this._notifyRemove(i,n,Gp.SOME);if(!(o!=null&&o>0))return void this._db.delete(i);r=o}s.size=r,this._size+=r,e.size+=r,this._checkSizeLimits()}}pop(e,i){i=e.id+i;const n=this._db.get(i);if(n)return this._size-=n.size,e.size-=n.size,this._db.delete(i),++this._hit,n.entry;++this._miss}get(e,i){i=e.id+i;const n=this._db.get(i);if(n!==void 0)return this._db.delete(i),n.lives=n.lifetime,this._db.set(i,n),++this._hit,n.entry;++this._miss}get performanceInfo(){const e={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},i={},n=new Array;this._db.forEach((o,a)=>{const l=o.lifetime;n[l]=(n[l]||0)+o.size,this._users.forAll(c=>{const{id:u,name:d}=c;if(a.startsWith(u)){const f=i[d]||0;i[d]=f+o.size}})});const r={};this._users.forAll(o=>{const a=o.name;if("hitRate"in o&&typeof o.hitRate=="number"&&!isNaN(o.hitRate)&&o.hitRate>0){const l=i[a]||0;i[a]=l,r[a]=Math.round(100*o.hitRate)+"%"}else r[a]="0%"});const s=Object.keys(i);s.sort((o,a)=>i[a]-i[o]),s.forEach(o=>e[o]=Math.round(i[o]/2**20)+"MB / "+r[o]);for(let o=n.length-1;o>=0;--o){const a=n[o];a&&(e["Priority "+(o+nO-1)]=Math.round(a/this._size*100)+"%")}return e}resetStats(){this._hit=this._miss=0,this._users.forAll(e=>e.resetHitRate())}clear(e){const i=e.id;this._db.forEach((n,r)=>{r.startsWith(i)&&(this._size-=n.size,this._db.delete(r),this._notifyRemove(r,n.entry,Gp.ALL))}),e.size=0}clearAll(){this._db.forEach((e,i)=>this._notifyRemove(i,e.entry,Gp.ALL)),this._users.forEach(e=>e.size=0),this._size=0,this._db.clear()}_getHitRate(){return this._hit/(this._hit+this._miss)}_notifyRemove(e,i,n){let r;return this._removeFuncs.some(s=>{if(e.startsWith(s[0])){const o=s[1](i,n);return typeof o=="number"&&(r=o),!0}return!1}),r}_checkSizeLimits(){if(this._size>this._maxSize){for(const[e,i]of this._db)if(this._purgeItem(e,i),this._size<=.9*this.maxSize)return}this._users.forEach(e=>{if(e.maxSize>0&&e.size>e.maxSize){for(const[i,n]of this._db)if(i.startsWith(e.id)&&(this._purgeItem(i,n,e),e.size<=.9*e.maxSize))return}})}_purgeItem(e,i,n=this._users.find(r=>e.startsWith(r.id))){if(this._db.delete(e),i.lives<=1){this._size-=i.size,n&&(n.size-=i.size);const r=this._notifyRemove(e,i.entry,Gp.SOME);r!=null&&r>0&&(this._size+=r,n&&(n.size+=r),i.lives=i.lifetime,i.size=r,this._db.set(e,i))}else--i.lives,this._db.set(e,i)}},HOe=0,GP=class{constructor(e,i){this._storage=new GOe,this.id="",this.name="",this.size=0,this._storage.maxSize=e,this._storage.register(this),i&&this._storage.registerRemoveFunc("",i)}destroy(){this._storage.deregister(this),this._storage.destroy()}put(e,i,n=1){this._storage.put(this,e,i,n,1)}pop(e){return this._storage.pop(this,e)}get(e){return this._storage.get(this,e)}clear(){this._storage.clearAll()}get maxSize(){return this._storage.maxSize}set maxSize(e){this._storage.maxSize=e}resetHitRate(){}},tN=class{constructor(e,i,n=""){this.major=e,this.minor=i,this._context=n}lessThan(e,i){return this.major<e||e===this.major&&this.minor<i}since(e,i){return!this.lessThan(e,i)}validate(e){if(this.major!==e.major){const i=this._context&&this._context+":",n=this._context&&this._context+" ";throw new V(i+"unsupported-version",`Required major ${n}version is '${this.major}', but got '\${version.major}.\${version.minor}'`,{version:e})}}clone(){return new tN(this.major,this.minor,this._context)}static parse(e,i=""){const[n,r]=e.split("."),s=/^\s*\d+\s*$/;if(!n||!n.match||!s.test(n))throw new V((i&&i+":")+"invalid-version","Expected major version to be a number, but got '${version}'",{version:e});if(!r||!r.match||!s.test(r))throw new V((i&&i+":")+"invalid-version","Expected minor version to be a number, but got '${version}'",{version:e});const o=parseInt(n,10),a=parseInt(r,10);return new tN(o,a,i)}};function qOe(t){return t.type==="date"||t.type==="esriFieldTypeDate"||t.type==="date-only"||t.type==="esriFieldTypeDateOnly"||t.type==="timestamp-offset"||t.type==="esriFieldTypeTimestampOffset"}function IG(t){return t.type==="oid"||t.type==="esriFieldTypeOID"}function CG(t){return t.type==="global-id"||t.type==="esriFieldTypeGlobalID"}let Doe=class{constructor(e=[]){if(this.fields=[],this._fieldsMap=new Map,this._normalizedFieldsMap=new Map,this._dateFieldsSet=new Set,this._numericFieldsSet=new Set,this.dateFields=[],this.numericFields=[],this._requiredFields=null,!e)return;this.fields=e;const i=[];for(const n of e){const r=n==null?void 0:n.name,s=EG(n==null?void 0:n.name);if(r&&s){const o=MG(r);this._fieldsMap.set(r,n),this._fieldsMap.set(o,n),this._normalizedFieldsMap.set(s,n),i.push(o),qOe(n)?(this.dateFields.push(n),this._dateFieldsSet.add(n)):xu(n)&&(this._numericFieldsSet.add(n),this.numericFields.push(n)),IG(n)||CG(n)||(n.editable=n.editable==null||!!n.editable,n.nullable=n.nullable==null||!!n.nullable)}}i.sort(),this.uid=i.join(",")}destroy(){this._fieldsMap.clear()}get requiredFields(){if(!this._requiredFields){this._requiredFields=[];for(const e of this.fields)IG(e)||CG(e)||e.nullable||Bwe(e)!==void 0||this._requiredFields.push(e)}return this._requiredFields}has(e){return this.get(e)!=null}get(e){if(!e)return;let i=this._fieldsMap.get(e);return i||(i=this._fieldsMap.get(MG(e))??this._normalizedFieldsMap.get(EG(e)),i&&this._fieldsMap.set(e,i),i)}isDateField(e){return this._dateFieldsSet.has(this.get(e))}isNumericField(e){return this._numericFieldsSet.has(this.get(e))}normalizeFieldName(e){const i=this.get(e);if(i)return i.name??void 0}};function MG(t){return t.trim().toLowerCase()}function EG(t){var e;return((e=Ewe(t))==null?void 0:e.toLowerCase())??""}const AG="esri.renderers.support.DictionaryLoader",WOe={type:"CIMSimpleLineCallout",lineSymbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",width:.5,color:[0,0,0,255]}]}};let QV=class{constructor(e,i,n){this.config=null,this.fieldMap=null,this.url=null,this._ongoingRequests=new Map,this._symbolCache=new GP(100),this._dictionaryVersion=null,this._fieldIndex=null,this._dictionaryPromise=null,this.url=e,this.config=i,this.fieldMap=n}getSymbolFields(){return this._symbolFields}async getSymbolAsync(e,i){let n;this._dictionaryPromise||(this._dictionaryPromise=this.fetchResources(i));try{n=await this._dictionaryPromise}catch(g){if(Ds(g))return this._dictionaryPromise=null,null}const r=this._dictionaryVersion&&this._dictionaryVersion.since(4,0),s={};if(this.fieldMap)for(const g of this._symbolFields){const y=this._getFieldName(this.fieldMap[g]);s[g]=y?r?e.attributes[y]:""+e.attributes[y]:""}let o=null;try{o=n==null?void 0:n(s,i)}catch{return null}if(!o||typeof o!="string")return null;const a=Nz(o).toString(),l=this._symbolCache.get(a);if(l)return l.catch(()=>{this._symbolCache.pop(a)}),l;const c=o.split(";"),u=[],d=[];for(const g of c)if(g)if(g.includes("po:")){const y=g.substr(3).split("|");if(y.length===3){const _=y[0],b=y[1];let w=y[2];if(b==="DashTemplate")w=w.split(" ").map(x=>Number(x));else if(b==="Color"){const x=new ae(w).toRgba();w=[x[0],x[1],x[2],255*x[3]]}else w=Number(w);d.push({primitiveName:_,propertyName:b,value:w})}}else if(g.includes("|")){for(const y of g.split("|"))if(this._itemNames.has(y)){u.push(y);break}}else this._itemNames.has(g)&&u.push(g);const f=e.geometry==null||!e.geometry.hasZ&&e.geometry.type==="point",m=this._cimPartsToCIMSymbol(u,d,f,i);return this._symbolCache.put(a,m,1),m}async fetchResources(e){if(this._dictionaryPromise)return this._dictionaryPromise;if(!this.url)return void ne.getLogger(AG).error("no valid URL!");const i=gt(this.url+"/resources/styles/dictionary-info.json",{responseType:"json",query:{f:"json"},signal:e!=null?e.signal:null}),[{data:n}]=await Promise.all([i,ld()]);if(!n)throw this._dictionaryPromise=null,new V("esri.renderers.DictionaryRenderer","Bad dictionary data!");const{authoringInfo:r,dictionary_version:s,expression:o,itemsNames:a}=n,l=o;let c=!1;s&&(this._dictionaryVersion=tN.parse(s),c=this._dictionaryVersion.since(4,0)),this._refSymbolUrlTemplate=this.url+"/"+n.cimRefTemplateUrl,this._itemNames=new Set(a),this._symbolFields=r.symbol;const u={};if(this.config){const m=this.config;for(const g in m)u[g]=m[g]}if(r.configuration)for(const m of r.configuration)u.hasOwnProperty(m.name)||(u[m.name]=m.value);const d=[];if(e!=null&&e.fields&&this.fieldMap)for(const m of this._symbolFields){const g=this.fieldMap[m],y=e.fields.filter(_=>_.name.toLowerCase()===(g==null?void 0:g.toLowerCase()));y.length>0&&d.push({...y[0],type:c?y[0].type:"esriFieldTypeString"})}d.length>0&&(this._fieldIndex=new Doe(d));const f=Iwe(l,e!=null?e.spatialReference:null,d,u).then(m=>{const g={scale:0};return(y,_)=>{if(m==null)return null;const b=m.repurposeFeature({geometry:null,attributes:y});return g.scale=_!=null?_.scale??void 0:void 0,m.evaluate({$feature:b,$view:g},m.services)}}).catch(m=>(ne.getLogger(AG).error("Creating dictinoary expression failed:",m),null));return this._dictionaryPromise=f,f}async _cimPartsToCIMSymbol(e,i,n,r){const s=new Array(e.length);for(let l=0;l<e.length;l++)s[l]=this._getSymbolPart(e[l],r);const o=await Promise.all(s),a=this.fieldMap;if(a)for(const l of o)Noe(l,a);return new Ub({data:this._combineSymbolParts(o,i,n)})}async _getSymbolPart(e,i){if(this._ongoingRequests.has(e))return this._ongoingRequests.get(e).then(s=>s.data);const n=this._refSymbolUrlTemplate.replaceAll(/\{itemName\}/gi,e),r=gt(n,{responseType:"json",query:{f:"json"},...i});this._ongoingRequests.set(e,r);try{return(await r).data}catch(s){throw this._ongoingRequests.delete(e),s}}_combineSymbolParts(e,i,n){if(!e||e.length===0)return null;const r={...e[0]};if(e.length>1){r.symbolLayers=[];for(const s of e){const o=s;r.symbolLayers.unshift(...o.symbolLayers)}}return n&&(r.callout=WOe),{type:"CIMSymbolReference",symbol:r,primitiveOverrides:i}}_getFieldName(e){if(this._fieldIndex!==null){const i=this._fieldIndex.get(e);return i?i.name:e}return e}};function Noe(t,e){if(!t)return;const i=t.symbolLayers;if(!i)return;let n=i.length;for(;n--;){const r=i[n];r&&r.enable!==!1&&r.type==="CIMVectorMarker"&&JOe(r,e)}}function JOe(t,e){const i=t.markerGraphics;if(i)for(const n of i){if(!n)continue;const r=n.symbol;if(r)switch(r.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":Noe(r,e);break;case"CIMTextSymbol":r.fieldMap=e}}}const gdt=Object.freeze(Object.defineProperty({__proto__:null,DictionaryLoader:QV},Symbol.toStringTag,{value:"Module"}));var iN;let Wl=iN=class extends Qf(gd){constructor(t){super(t),this.config=null,this.fieldMap=null,this.scaleExpression=null,this.scaleExpressionTitle=null,this.url=null,this.type="dictionary"}get _loader(){return new QV(this.url,this.config,this.fieldMap)}writeData(t,e){t&&(e.scalingExpressionInfo={expression:t,returnType:"number"})}writeVisualVariables(t,e,i,n){n!=null&&n.origin||super.writeVisualVariables(t,e,i,n)}clone(){return new iN({config:q(this.config),scaleExpression:this.scaleExpression,scaleExpressionTitle:this.scaleExpressionTitle,fieldMap:q(this.fieldMap),url:q(this.url),visualVariables:q(this.visualVariables)})}async getSymbolAsync(t,e){return this._loader.getSymbolAsync(t,e)}async collectRequiredFields(t,e){await this.collectVVRequiredFields(t,e),this.scaleExpression&&await ro(t,e,this.scaleExpression);for(const i in this.fieldMap){const n=this.fieldMap[i];e.has(n)&&t.add(n)}}get arcadeRequired(){return!0}getSymbol(){return null}getSymbols(){return[]}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce((t,e)=>t+e.getAttributeHash(),"")}getMeshHash(){return`${this.url}-${JSON.stringify(this.fieldMap)}`}getSymbolFields(){return this._loader.getSymbolFields()}};h([p({type:QV})],Wl.prototype,"_loader",null),h([p({type:Object,json:{read:{source:"configuration"},write:{target:"configuration"}}})],Wl.prototype,"config",void 0),h([p({type:Object,json:{write:!0}})],Wl.prototype,"fieldMap",void 0),h([p({type:String,json:{read:{source:"scalingExpressionInfo.expression"},write:!0}})],Wl.prototype,"scaleExpression",void 0),h([ge("scaleExpression")],Wl.prototype,"writeData",null),h([p({type:String,json:{read:{source:"scalingExpressionInfo.title"},write:{target:"scalingExpressionInfo.title",overridePolicy(t){return{enabled:!!t&&!!this.scaleExpression}}}}})],Wl.prototype,"scaleExpressionTitle",void 0),h([p({type:String,json:{write:!0}})],Wl.prototype,"url",void 0),h([ge("visualVariables")],Wl.prototype,"writeVisualVariables",null),Wl=iN=h([P("esri.renderers.DictionaryRenderer")],Wl);const ZOe=Wl;var nN;let ph=nN=class extends ie{constructor(t){super(t),this.color=null,this.field=null,this.label=null,this.valueExpression=null,this.valueExpressionTitle=null}castField(t){return t==null?t:typeof t=="function"?(ne.getLogger(this).error(".field: field must be a string value"),null):LS(t)}getAttributeHash(){return`${this.field}-${this.valueExpression}`}clone(){return new nN({color:this.color&&this.color.clone(),field:this.field,label:this.label,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle})}};h([p({type:ae,json:{type:[Number],write:!0}})],ph.prototype,"color",void 0),h([p({type:String,json:{write:!0}})],ph.prototype,"field",void 0),h([ut("field")],ph.prototype,"castField",null),h([p({type:String,json:{write:!0}})],ph.prototype,"label",void 0),h([p({type:String,json:{write:!0}})],ph.prototype,"valueExpression",void 0),h([p({type:String,json:{write:!0}})],ph.prototype,"valueExpressionTitle",void 0),ph=nN=h([P("esri.renderers.support.AttributeColorInfo")],ph);const Foe=ph;var rN;let jM=rN=class extends ie{constructor(){super(...arguments),this.unit=null}clone(){return new rN({unit:this.unit})}};h([p({type:String,json:{write:!0}})],jM.prototype,"unit",void 0),jM=rN=h([P("esri.renderers.support.DotDensityLegendOptions")],jM);const YOe=jM;var sN;let bo=sN=class extends Qf(gd){constructor(t){super(t),this.attributes=null,this.backgroundColor=new ae([0,0,0,0]),this.dotBlendingEnabled=!0,this.dotShape="square",this.dotSize=1,this.legendOptions=null,this.outline=new Ur,this.dotValue=null,this.referenceScale=null,this.seed=1,this.type="dot-density"}calculateDotValue(t){if(this.referenceScale==null)return this.dotValue;const e=t/this.referenceScale*this.dotValue;return e<1?1:e}getSymbol(){return new Pc({outline:this.outline})}async getSymbolAsync(){return this.getSymbol()}getSymbols(){return[this.getSymbol()]}getAttributeHash(){var t;return((t=this.attributes)==null?void 0:t.reduce((e,i)=>e+i.getAttributeHash(),""))??""}getMeshHash(){return JSON.stringify(this.outline)}clone(){return new sN({attributes:q(this.attributes),backgroundColor:q(this.backgroundColor),dotBlendingEnabled:q(this.dotBlendingEnabled),dotShape:q(this.dotShape),dotSize:q(this.dotSize),dotValue:q(this.dotValue),legendOptions:q(this.legendOptions),outline:q(this.outline),referenceScale:q(this.referenceScale),visualVariables:q(this.visualVariables),authoringInfo:this.authoringInfo&&this.authoringInfo.clone()})}getControllerHash(){var e;return`${(e=this.attributes)==null?void 0:e.map(i=>i.field||i.valueExpression||"")}-${this.outline&&JSON.stringify(this.outline.toJSON())||""}`}async collectRequiredFields(t,e){await this.collectVVRequiredFields(t,e);for(const i of this.attributes??[])i.valueExpression&&await ro(t,e,i.valueExpression),i.field&&t.add(i.field)}};h([p({type:[Foe],json:{write:!0}})],bo.prototype,"attributes",void 0),h([p({type:ae,json:{write:!0}})],bo.prototype,"backgroundColor",void 0),h([p({type:Boolean,json:{write:!0}})],bo.prototype,"dotBlendingEnabled",void 0),h([p({type:String,json:{write:!1}})],bo.prototype,"dotShape",void 0),h([p({type:Number,json:{write:!0}})],bo.prototype,"dotSize",void 0),h([p({type:YOe,json:{write:!0}})],bo.prototype,"legendOptions",void 0),h([p({type:Ur,json:{default:null,write:!0}})],bo.prototype,"outline",void 0),h([p({type:Number,json:{write:!0}})],bo.prototype,"dotValue",void 0),h([p({type:Number,json:{write:!0}})],bo.prototype,"referenceScale",void 0),h([p({type:Number,json:{write:!0}})],bo.prototype,"seed",void 0),h([be({dotDensity:"dot-density"})],bo.prototype,"type",void 0),bo=sN=h([P("esri.renderers.DotDensityRenderer")],bo);const XOe=bo;var oN;let qw=oN=class extends ie{constructor(t){super(t),this.color=null,this.ratio=null}clone(){return new oN({color:this.color,ratio:this.ratio})}};h([p({type:ae,json:{type:[It],default:null,write:!0}})],qw.prototype,"color",void 0),h([p({type:Number,json:{write:!0}})],qw.prototype,"ratio",void 0),qw=oN=h([P("esri.renderers.support.HeatmapColorStop")],qw);const Gx=qw;let Av=class extends An(ie){constructor(){super(...arguments),this.minLabel=null,this.maxLabel=null,this.title=null}};h([p({type:String,json:{write:!0}})],Av.prototype,"minLabel",void 0),h([p({type:String,json:{write:!0}})],Av.prototype,"maxLabel",void 0),h([p({type:String,json:{write:!0}})],Av.prototype,"title",void 0),Av=h([P("esri.renderers.support.HeatmapLegendOptions")],Av);function jf(){return[0,0,0,0]}function KOe(t){return[t[0],t[1],t[2],t[3]]}function em(t,e,i,n){return[t,e,i,n]}function zoe(t){const e=jf(),i=Math.min(4,t.length);for(let n=0;n<i;++n)e[n]=t[n];return e}function Voe(t,e){return new Float64Array(t,e,4)}function joe(){return jf()}function Boe(){return em(1,1,1,1)}function Uoe(){return em(1,0,0,0)}function Goe(){return em(0,1,0,0)}function Hoe(){return em(0,0,1,0)}function qoe(){return em(0,0,0,1)}const QOe=joe(),eLe=Boe(),tLe=Uoe(),iLe=Goe(),nLe=Hoe(),rLe=qoe();Object.freeze(Object.defineProperty({__proto__:null,ONES:eLe,UNIT_W:rLe,UNIT_X:tLe,UNIT_Y:iLe,UNIT_Z:nLe,ZEROS:QOe,clone:KOe,create:jf,createView:Voe,fromArray:zoe,fromValues:em,ones:Boe,unitW:qoe,unitX:Uoe,unitY:Goe,unitZ:Hoe,zeros:joe},Symbol.toStringTag,{value:"Module"}));const ej=2.4;function sLe(t){return Tc(t*ej)}function oLe(t){return Gi(t)/ej}function aLe(t,e,i,n){let{color:r,ratio:s}=e,{color:o,ratio:a}=i;a===s&&(a===1?s-=1e-6:a+=1e-6);const l=rr((n-s)/(a-s),0,1);S6(t,r.toArray(),o.toArray(),l)}function vdt(t){const i=new Uint8ClampedArray(2048);if(t=t.filter(({ratio:a})=>a>=0&&a<=1).sort((a,l)=>a.ratio-l.ratio).map(({color:a,ratio:l})=>({color:a,ratio:Math.max(l,.001)})),t.length<1)return i;let n=t[0],r=t[0],s=1;const o=jf();for(let a=0;a<512;a++){const l=(a+.5)/512;for(;l>r.ratio&&s<t.length;)n=r,r=t[s++];aLe(o,n,r,l),i.set(o,4*a)}return i}function _dt(t,e,i,n){const{radius:r,fieldOffset:s,field:o}=e,a=Math.round(Gi(r)),l=new Float64Array(i*n);let c,u=Number.NEGATIVE_INFINITY;const d=uLe(o,s),f=new Set;for(const m of t){const g=m.getCursor();for(;g.next();){const y=g.getObjectId();if(f.has(y))continue;f.add(y);const _=g.readLegacyPointGeometry(),b=128;if(_.x<-b||_.x>=i+b||_.y<-b||_.y>n+b)continue;const w=+d(g),x=Math.max(0,Math.round(_.x)-a),S=Math.max(0,Math.round(_.y)-a),T=Math.min(n,Math.round(_.y)+a),I=Math.min(i,Math.round(_.x)+a);for(let C=S;C<T;C++)for(let M=x;M<I;M++){const E=C*i+M,A=cLe(_.x-M,_.y-C,a);c=l[E]+=A*w,c>u&&(u=c)}}}return{matrix:l.buffer,max:u}}function bdt(t,e,i,n,r,s){t.canvas.width=t.canvas.height=e,t.clearRect(0,0,e,e);const o=t.getImageData(0,0,e,e);i&&n&&o.data.set(new Uint8ClampedArray(lLe(e,i,n,r,s))),t.putImageData(o,0,0)}function lLe(t,e,i,n,r){const s=new Uint32Array(t*t),o="buffer"in e?e:new Float64Array(e),a="buffer"in i?new Uint32Array(i.buffer):new Uint32Array(new Uint8Array(i).buffer),l=a.length/(r-n);for(let c=0;c<o.length;c++){const u=o[c],d=Math.floor((u-n)*l);s[c]=a[rr(d,0,a.length-1)]}return s.buffer}function cLe(t,e,i){const n=Math.sqrt(t**2+e**2)/i;return n>1?0:3/(Math.PI*i**2)*(1-n**2)**2}function wdt(t,e){return typeof t=="function"?t:t?typeof e=="string"?i=>-1*+i[t]:i=>+i[t]+e:()=>1}function uLe(t,e){return t!=null?typeof e=="string"?i=>-1*+i.readAttribute(t):i=>+i.readAttribute(t)+e:i=>1}var aN;const Woe="esri.renderers.HeatmapRenderer",hLe=ne.getLogger(Woe);function $G(t){if(t!=null){const{maxDensity:e,minDensity:i,radius:n}=t;if(e!=null||i!=null||n!=null){const{blurRadius:r,maxPixelIntensity:s,minPixelIntensity:o,...a}=t;return a}}return t}let fr=aN=class extends gd{constructor(t){super(t),this.authoringInfo=null,this.colorStops=[new Gx({ratio:0,color:new ae("rgba(255, 140, 0, 0)")}),new Gx({ratio:.75,color:new ae("rgba(255, 140, 0, 1)")}),new Gx({ratio:.9,color:new ae("rgba(255, 0,   0, 1)")})],this.field=null,this.fieldOffset=0,this.legendOptions=null,this.maxDensity=.04,this.minDensity=0,this.radius=18,this.referenceScale=0,this.type="heatmap",this.valueExpression=null,this.valueExpressionTitle=null,this._warnedProps={blurRadius:!1,maxPixelIntensity:!1,minPixelIntensity:!1}}normalizeCtorArgs(t){return $G(t)}get blurRadius(){return oLe(this.radius)}set blurRadius(t){const e=this.maxPixelIntensity,i=this.minPixelIntensity;this._set("radius",sLe(t)),this._warnAboutDeprecatedGaussianBlurProp("blurRadius","radius"),this._set("maxDensity",e*this._pixelIntensityToDensity),this._set("minDensity",i*this._pixelIntensityToDensity)}get maxPixelIntensity(){return this.maxDensity/this._pixelIntensityToDensity}set maxPixelIntensity(t){this._set("maxDensity",t*this._pixelIntensityToDensity),this._warnAboutDeprecatedGaussianBlurProp("maxPixelIntensity","maxDensity")}get minPixelIntensity(){return this.minDensity/this._pixelIntensityToDensity}set minPixelIntensity(t){this._set("minDensity",t*this._pixelIntensityToDensity),this._warnAboutDeprecatedGaussianBlurProp("minPixelIntensity","minDensity")}get _pixelIntensityToDensity(){return 24/(ej**2*this.blurRadius**4)}_warnAboutDeprecatedGaussianBlurProp(t,e){this._warnedProps[t]||no(this).getDefaultOrigin()==="user"&&(this._warnedProps[t]=!0,kb(()=>{C2(hLe,t,{replacement:`${String(e)} (suggested value: ${this._get(e)})`,version:"4.24"})}))}read(t,e){t=$G(t),super.read(t,e)}getSymbol(){return new rs}async getSymbolAsync(){return this.getSymbol()}getSymbols(){return[this.getSymbol()]}async collectRequiredFields(t,e){const i=this.field,n=this.valueExpression;i&&typeof i=="string"&&await va(t,e,i),n&&typeof n=="string"&&await ro(t,e,n)}getAttributeHash(){return null}getMeshHash(){return`${JSON.stringify(this.colorStops)}.${this.blurRadius}.${this.field}`}clone(){return new aN({authoringInfo:this.authoringInfo&&this.authoringInfo.clone(),colorStops:q(this.colorStops),field:this.field,legendOptions:q(this.legendOptions),maxDensity:this.maxDensity,minDensity:this.minDensity,radius:this.radius,referenceScale:this.referenceScale,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle})}};h([p({type:rT,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],fr.prototype,"authoringInfo",void 0),h([p({type:Number,json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],fr.prototype,"blurRadius",null),h([p({type:[Gx],json:{write:!0}})],fr.prototype,"colorStops",void 0),h([p({type:String,json:{write:!0}})],fr.prototype,"field",void 0),h([p({type:Number,json:{write:{overridePolicy:(t,e,i)=>({enabled:i==null})},origins:{"web-scene":{write:!1}}}})],fr.prototype,"fieldOffset",void 0),h([p({type:Av,json:{write:!0}})],fr.prototype,"legendOptions",void 0),h([p({type:Number,json:{write:!0}})],fr.prototype,"maxDensity",void 0),h([p({type:Number,json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],fr.prototype,"maxPixelIntensity",null),h([p({type:Number,json:{write:!0}})],fr.prototype,"minDensity",void 0),h([p({type:Number,json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],fr.prototype,"minPixelIntensity",null),h([p({type:Number,cast:vt,json:{write:!0}})],fr.prototype,"radius",void 0),h([p({type:Number,range:{min:0},json:{default:0,write:!0}})],fr.prototype,"referenceScale",void 0),h([be({heatmap:"heatmap"})],fr.prototype,"type",void 0),h([p({type:String,json:{write:!0,origins:{"web-document":{write:!1},"portal-item":{write:!1}}}})],fr.prototype,"valueExpression",void 0),h([p({type:String})],fr.prototype,"valueExpressionTitle",void 0),h([p({readOnly:!0})],fr.prototype,"_pixelIntensityToDensity",null),fr=aN=h([P(Woe)],fr);const Joe=fr;let Jg=class extends An(ie){constructor(){super(...arguments),this.color=new ae([0,0,0,0]),this.label=null,this.threshold=0}};h([p({type:ae,json:{write:!0}})],Jg.prototype,"color",void 0),h([p({type:String,json:{write:!0}})],Jg.prototype,"label",void 0),h([p({type:Number,range:{min:0,max:1},json:{write:!0}})],Jg.prototype,"threshold",void 0),Jg=h([P("esri.renderers.support.OthersCategory")],Jg);let BM=class extends An(ie){constructor(){super(...arguments),this.title=null}};h([p({type:String,json:{write:!0}})],BM.prototype,"title",void 0),BM=h([P("esri.renderers.support.PieChartLegendOptions")],BM);let Yo=class extends Qf(An(gd)){constructor(e){super(e),this.attributes=null,this.backgroundFillSymbol=null,this.defaultColor=new ae([0,0,0,0]),this.defaultLabel=null,this.holePercentage=0,this.othersCategory=new Jg,this.legendOptions=null,this.outline=null,this.size=12,this.type="pie-chart"}getSymbol(){var e;return new rs({size:this.size?this.size/2+(((e=this.outline)==null?void 0:e.width)||0):0})}async getSymbolAsync(){return this.getSymbol()}getSymbols(){return[this.getSymbol(),this.backgroundFillSymbol].filter(Ti)}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce((e,i)=>e+i.getAttributeHash(),"")}getMeshHash(){return this.getSymbols().reduce((e,i)=>e+JSON.stringify(i),"")}async collectRequiredFields(e,i){await this.collectVVRequiredFields(e,i);for(const n of this.attributes)n.valueExpression&&await ro(e,i,n.valueExpression),n.field&&e.add(n.field)}};h([p({type:[Foe],json:{write:!0}})],Yo.prototype,"attributes",void 0),h([p({type:Pc,json:{default:null,write:!0}})],Yo.prototype,"backgroundFillSymbol",void 0),h([p({type:ae,json:{write:!0}})],Yo.prototype,"defaultColor",void 0),h([p({type:String,json:{write:!0}})],Yo.prototype,"defaultLabel",void 0),h([p({type:Number,range:{min:0,max:1},json:{write:!0}})],Yo.prototype,"holePercentage",void 0),h([p({type:Jg,json:{write:!0}})],Yo.prototype,"othersCategory",void 0),h([p({type:BM,json:{write:!0}})],Yo.prototype,"legendOptions",void 0),h([p({type:Ur,json:{default:null,write:!0}})],Yo.prototype,"outline",void 0),h([p({type:Number,cast:vt,json:{write:!0}})],Yo.prototype,"size",void 0),h([be({pieChart:"pie-chart"})],Yo.prototype,"type",void 0),Yo=h([P("esri.renderers.PieChartRenderer")],Yo);const dLe=Yo;var lN;let sg=lN=class extends Qf(gd){constructor(t){super(t),this.description=null,this.label=null,this.symbol=null,this.type="simple"}async collectRequiredFields(t,e){await Promise.all([this.collectSymbolFields(t,e),this.collectVVRequiredFields(t,e)])}async collectSymbolFields(t,e){await Promise.all(this.getSymbols().map(i=>i.collectRequiredFields(t,e)))}getSymbol(t,e){return this.symbol}async getSymbolAsync(t,e){return this.symbol}getSymbols(){return this.symbol?[this.symbol]:[]}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce((t,e)=>t+e.getAttributeHash(),"")}getMeshHash(){return this.getSymbols().reduce((t,e)=>t+JSON.stringify(e),"")}get arcadeRequired(){return this.arcadeRequiredForVisualVariables}clone(){return new lN({description:this.description,label:this.label,symbol:this.symbol&&this.symbol.clone(),visualVariables:q(this.visualVariables),authoringInfo:this.authoringInfo&&this.authoringInfo.clone()})}};h([p({type:String,json:{write:!0}})],sg.prototype,"description",void 0),h([p({type:String,json:{write:!0}})],sg.prototype,"label",void 0),h([p(Yb)],sg.prototype,"symbol",void 0),h([be({simple:"simple"})],sg.prototype,"type",void 0),sg=lN=h([P("esri.renderers.SimpleRenderer")],sg);const HP=sg,pLe=["esri.Color","esri.portal.Portal","esri.symbols.support.Symbol3DAnchorPosition2D","esri.symbols.support.Symbol3DAnchorPosition3D"];function cN(t){return t instanceof ye}function PG(t){return t instanceof xe?Object.keys(t.items):cN(t)?no(t).keys():t?Object.keys(t):[]}function CI(t,e){return t instanceof xe?t.items[e]:t[e]}function fLe(t,e){return!(!Array.isArray(t)||!Array.isArray(e))&&t.length!==e.length}function Hx(t){return t?t.declaredClass:null}function Zoe(t,e){var d;const i=t.diff;if(i&&typeof i=="function")return i(t,e);const n=PG(t),r=PG(e);if(n.length===0&&r.length===0)return;if(!n.length||!r.length||fLe(t,e))return{type:"complete",oldValue:t,newValue:e};const s=r.filter(f=>!n.includes(f)),o=n.filter(f=>!r.includes(f)),a=n.filter(f=>r.includes(f)&&CI(t,f)!==CI(e,f)).concat(s,o).sort(),l=Hx(t);if(l&&pLe.includes(l)&&a.length)return{type:"complete",oldValue:t,newValue:e};let c;const u=cN(t)&&cN(e);for(const f of a){const m=CI(t,f),g=CI(e,f);let y;if((u||typeof m!="function"&&typeof g!="function")&&m!==g&&(m!=null||g!=null)){if(i&&i[f]&&typeof i[f]=="function")y=(d=i[f])==null?void 0:d.call(i,m,g);else if(m instanceof Date&&g instanceof Date){if(m.getTime()===g.getTime())continue;y={type:"complete",oldValue:m,newValue:g}}else y=typeof m=="object"&&typeof g=="object"&&Hx(m)===Hx(g)?Zoe(m,g):{type:"complete",oldValue:m,newValue:g};y!=null&&(c!=null?c.diff[f]=y:c={type:"partial",diff:{[f]:y}})}}return c}function mLe(t,e){if(t==null)return!1;const i=e.split(".");let n=t;for(const r of i){if(n.type==="complete")return!0;if(n.type!=="partial")return!1;{const s=n.diff[r];if(!s)return!1;n=s}}return!0}function Idt(t,e){for(const i of e)if(mLe(t,i))return!0;return!1}function gLe(t,e){if(typeof t!="function"&&typeof e!="function"&&(t!=null||e!=null))return t==null||e==null||typeof t=="object"&&typeof e=="object"&&Hx(t)!==Hx(e)?{type:"complete",oldValue:t,newValue:e}:Zoe(t,e)}function MI(t){if(t==null)return!0;switch(t.type){case"complete":return!1;case"collection":{const e=t;for(const i of e.added)if(!MI(i))return!1;for(const i of e.removed)if(!MI(i))return!1;for(const i of e.changed)if(!MI(i))return!1;return!0}case"partial":for(const e in t.diff)if(!MI(t.diff[e]))return!1;return!0}}let $v=class extends An(ie){constructor(e){super(e),this.value=null,this.value2=null,this.value3=null}};h([p(FM)],$v.prototype,"value",void 0),h([p(FM)],$v.prototype,"value2",void 0),h([p(FM)],$v.prototype,"value3",void 0),$v=h([P("esri.renderers.support.UniqueValue")],$v);const R_=$v;let mp=class extends An(ie){constructor(e){super(e),this.description=null,this.label=null,this.symbol=null,this.values=null}castValues(e){if(e==null)return null;const i=typeof(e=Array.isArray(e)?e:[e])[0];return i==="string"||i==="number"?e.map(n=>new R_({value:n})):i==="object"?e[0]instanceof R_?e:e.map(n=>new R_(n)):null}};h([p({type:String,json:{write:!0}})],mp.prototype,"description",void 0),h([p({type:String,json:{write:!0}})],mp.prototype,"label",void 0),h([p(Yb)],mp.prototype,"symbol",void 0),h([p({type:[R_],json:{type:[[String]],read:{reader:t=>t?t.map(e=>new R_({value:e[0],value2:e[1],value3:e[2]})):null},write:{writer:(t,e)=>{const i=[];for(const n of t){const r=[n.value,n.value2,n.value3].filter(Ti).map(s=>s.toString());i.push(r)}e.values=i}}}})],mp.prototype,"values",void 0),h([ut("values")],mp.prototype,"castValues",null),mp=h([P("esri.renderers.support.UniqueValueClass")],mp);const Yoe=mp;let Ww=class extends An(ie){constructor(e){super(e),this.heading=null,this.classes=null}};h([p({type:String,json:{write:!0}})],Ww.prototype,"heading",void 0),h([p({type:[Yoe],json:{write:!0}})],Ww.prototype,"classes",void 0),Ww=h([P("esri.renderers.support.UniqueValueGroup")],Ww);const uN=Ww;var hN;let og=hN=class extends ie{constructor(t){super(t),this.description=null,this.label=null,this.symbol=null,this.value=null}clone(){return new hN({value:this.value,description:this.description,label:this.label,symbol:this.symbol?this.symbol.clone():null})}getMeshHash(){const t=JSON.stringify(this.symbol&&this.symbol.toJSON());return`${this.value}.${t}`}};h([p({type:String,json:{write:!0}})],og.prototype,"description",void 0),h([p({type:String,json:{write:!0}})],og.prototype,"label",void 0),h([p(Yb)],og.prototype,"symbol",void 0),h([p(FM)],og.prototype,"value",void 0),og=hN=h([P("esri.renderers.support.UniqueValueInfo")],og);const xy=og,yLe=()=>!!ee("enable-feature:force-wosr"),vLe=()=>ee.add("enable-feature:direct-3d-object-feature-layer-display",!0,!0,!0),_Le=()=>ee.add("enable-feature:direct-3d-object-feature-layer-display",!1,!0,!0),bLe=()=>ee.add("enable-i3s-patching",!0,!0,!0),wLe=()=>ee.add("enable-i3s-patching",!1,!0,!0),Adt=()=>!!ee("enable-feature:SceneLayer-editing"),xLe=(t="i3s-patching")=>{switch(wLe(),_Le(),ee.add("enable-feature:SceneLayer-editing",!0,!0,!0),t){case"feature-layer-view":vLe();break;case"i3s-patching":bLe()}};xLe("i3s-patching");let rO={};async function SLe(t,e){try{return{data:(await tj(t,e)).data,baseUrl:t6(t),styleUrl:t}}catch(i){return $o(i),null}}function TLe(t,e,i){const n=e.portal!=null?e.portal:nr.getDefault();let r;const s=`${n.url} - ${n.user&&n.user.username} - ${t}`;return rO[s]||(rO[s]=ILe(t,n,i).then(o=>(r=o,o.fetchData())).then(o=>({data:o,baseUrl:r.itemUrl??"",styleName:t}))),rO[s]}function ILe(t,e,i){return e.load(i).then(()=>{const n=new yu({disableExtraQuery:!0,query:`owner:${kG} AND type:${OG} AND typekeywords:"${t}"`});return e.queryItems(n,i)}).then(({results:n})=>{var o;let r=null;const s=t.toLowerCase();if(n&&Array.isArray(n)){for(const a of n)if(((o=a.typeKeywords)==null?void 0:o.some(c=>c.toLowerCase()===s))&&a.type===OG&&a.owner===kG){r=a;break}}if(!r)throw new V("symbolstyleutils:style-not-found",`The style '${t}' could not be found`,{styleName:t});return r.load(i)})}function Xoe(t,e,i){return t&&t.styleUrl!=null?SLe(t.styleUrl,i):t&&t.styleName!=null?TLe(t.styleName,e,i):Promise.reject(new V("symbolstyleutils:style-url-and-name-missing","Either styleUrl or styleName is required to resolve a style"))}function Koe(t){return t===null||t.type==="CIMSymbolReference"?t:{type:"CIMSymbolReference",symbol:t}}function CLe(t,e,i=["gltf"]){if(e==="cimRef")return t.cimRef;if(t.formatInfos&&!yLe())for(const n of i){const r=t.formatInfos.find(s=>s.type===n);if(r)return r.href}return t.webRef}function tj(t,e){const i={responseType:"json",query:{f:"json"},...e};return gt(ll(t),i)}const kG="esri_en",OG="Style",MLe="https://cdn.arcgis.com/sharing/rest/content/items/220936cc6ed342c9937abd8f180e7d1e/resources/styles/cim/{SymbolName}.json?f=json";var Jw;const Qoe="esri.renderers.UniqueValueRenderer",Ud=ne.getLogger(Qoe),LG="uvInfos-watcher",RG="uvGroups-watcher",ELe=",",ALe=fn(xy);function $Le(t){const{field1:e,field2:i,field3:n,fieldDelimiter:r,uniqueValueInfos:s,valueExpression:o}=t,a=!(!e||!i);return[{classes:(s??[]).map(l=>{var b;const{symbol:c,label:u,value:d,description:f}=l,[m,g,y]=a?((b=d==null?void 0:d.toString())==null?void 0:b.split(r||""))||[]:[d],_=[];return(e||o)&&_.push(m),i&&_.push(g),n&&_.push(y),{symbol:c,label:u,values:[_],description:f}})}]}let ji=Jw=class extends Qf(gd){constructor(t){super(t),this._valueInfoMap={},this._isDefaultSymbolDerived=!1,this._isInfosSource=null,this.type="unique-value",this.backgroundFillSymbol=null,this.orderByClassesEnabled=!1,this.valueExpressionTitle=null,this.legendOptions=null,this.defaultLabel=null,this.portal=null,this.styleOrigin=null,this.diff={uniqueValueInfos(e,i){if(!e&&!i)return;if(!e||!i)return{type:"complete",oldValue:e,newValue:i};let n=!1;const r={type:"collection",added:[],removed:[],changed:[],unchanged:[]};for(let s=0;s<i.length;s++){const o=e.find(a=>a.value===i[s].value);o?gLe(o,i[s])?(r.changed.push({type:"complete",oldValue:o,newValue:i[s]}),n=!0):r.unchanged.push({oldValue:o,newValue:i[s]}):(r.added.push(i[s]),n=!0)}for(let s=0;s<e.length;s++)i.find(o=>o.value===e[s].value)||(r.removed.push(e[s]),n=!0);return n?r:void 0}},this._set("uniqueValueInfos",[]),this._set("uniqueValueGroups",[])}get _cache(){return{compiledFunc:null}}set field(t){this._set("field",t),this._updateFieldDelimiter(),this._updateUniqueValues()}castField(t){return t==null||typeof t=="function"?t:LS(t)}writeField(t,e,i,n){typeof t=="string"?e[i]=t:n&&n.messages?n.messages.push(new V("property:unsupported","UniqueValueRenderer.field set to a function cannot be written to JSON")):Ud.error(".field: cannot write field to JSON since it's not a string value")}set field2(t){this._set("field2",t),this._updateFieldDelimiter(),this._updateUniqueValues()}set field3(t){this._set("field3",t),this._updateUniqueValues()}set valueExpression(t){this._set("valueExpression",t),this._updateUniqueValues()}set defaultSymbol(t){this._isDefaultSymbolDerived=!1,this._set("defaultSymbol",t)}set fieldDelimiter(t){this._set("fieldDelimiter",t),this._updateUniqueValues()}readPortal(t,e,i){return i.portal||nr.getDefault()}readStyleOrigin(t,e,i){if(e.styleName)return Object.freeze({styleName:e.styleName});if(e.styleUrl){const n=Rf(e.styleUrl,i);return Object.freeze({styleUrl:n})}}writeStyleOrigin(t,e,i,n){t.styleName?e.styleName=t.styleName:t.styleUrl&&(e.styleUrl=JS(t.styleUrl,n))}set uniqueValueGroups(t){this.styleOrigin?Ud.error("#uniqueValueGroups=","Cannot modify unique value groups of a UniqueValueRenderer created from a web style"):(this._set("uniqueValueGroups",t),this._updateInfosFromGroups(),this._isInfosSource=!1,this._watchUniqueValueGroups())}set uniqueValueInfos(t){this.styleOrigin?Ud.error("#uniqueValueInfos=","Cannot modify unique value infos of a UniqueValueRenderer created from a web style"):(this._set("uniqueValueInfos",t),this._updateValueInfoMap(),this._updateGroupsFromInfos(),this._isInfosSource=!0,this._watchUniqueValueInfos())}addUniqueValueInfo(t,e){var n;if(this.styleOrigin)return void Ud.error("#addUniqueValueInfo()","Cannot modify unique value infos of a UniqueValueRenderer created from a web style");let i;i=typeof t=="object"?ALe(t):new xy({value:t,symbol:nne(e)}),(n=this.uniqueValueInfos)==null||n.push(i),this._valueInfoMap[i.value]=i,this._updateGroupsFromInfos(),this._isInfosSource=!0,this._watchUniqueValueInfos()}removeUniqueValueInfo(t){if(this.styleOrigin)return void Ud.error("#removeUniqueValueInfo()","Cannot modify unique value infos of a UniqueValueRenderer created from a web style");const e=this.uniqueValueInfos;if(e){for(let i=0;i<e.length;i++)if(e[i].value===t+""){delete this._valueInfoMap[t],e.splice(i,1);break}}this._updateGroupsFromInfos(),this._isInfosSource=!0,this._watchUniqueValueInfos()}async getUniqueValueInfo(t,e){let i=e;return!this.valueExpression||e!=null&&e.arcade!=null||(i={...i,arcade:await ld()}),this._getUniqueValueInfo(t,i)}getSymbol(t,e){if(this.valueExpression&&(e==null||e.arcade==null))return void Ud.error("#getSymbol()","Please use getSymbolAsync if valueExpression is used");const i=this._getUniqueValueInfo(t,e);return i&&i.symbol||this.defaultSymbol}async getSymbolAsync(t,e){let i=e;if(this.valueExpression&&(i==null||i.arcade==null)){const r=await ld(),{arcadeUtils:s}=r;s.hasGeometryOperations(this.valueExpression)&&await s.enableGeometryOperations(),i={...i,arcade:r}}const n=this._getUniqueValueInfo(t,i);return n&&n.symbol||this.defaultSymbol}getSymbols(){const t=[];for(const e of this.uniqueValueInfos??[])e.symbol&&t.push(e.symbol);return this.defaultSymbol&&t.push(this.defaultSymbol),t}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce((t,e)=>t+e.getAttributeHash(),"")}getMeshHash(){var n;const t=JSON.stringify(this.backgroundFillSymbol),e=JSON.stringify(this.defaultSymbol),i=(n=this.uniqueValueInfos)==null?void 0:n.reduce((r,s)=>r+s.getMeshHash(),"");return`${t}.${e}.${i}.${`${this.field}.${this.field2}.${this.field3}.${this.fieldDelimiter}`}.${this.valueExpression}`}clone(){const t=new Jw({field:this.field,field2:this.field2,field3:this.field3,defaultLabel:this.defaultLabel,defaultSymbol:q(this.defaultSymbol),orderByClassesEnabled:this.orderByClassesEnabled,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,fieldDelimiter:this.fieldDelimiter,visualVariables:q(this.visualVariables),legendOptions:q(this.legendOptions),authoringInfo:this.authoringInfo&&this.authoringInfo.clone(),backgroundFillSymbol:q(this.backgroundFillSymbol)});this._isDefaultSymbolDerived&&(t._isDefaultSymbolDerived=!0),t._set("portal",this.portal);const e=q(this.uniqueValueInfos),i=q(this.uniqueValueGroups);return this.styleOrigin&&(t._set("styleOrigin",Object.freeze(q(this.styleOrigin))),Object.freeze(e),Object.freeze(i)),t._set("uniqueValueInfos",e),t._updateValueInfoMap(),t._set("uniqueValueGroups",i),t._isInfosSource=this._isInfosSource,t._watchUniqueValueInfosAndGroups(),t}get arcadeRequired(){return this.arcadeRequiredForVisualVariables||!!this.valueExpression}async collectRequiredFields(t,e){const i=[this.collectVVRequiredFields(t,e),this.collectSymbolFields(t,e)];await Promise.all(i)}async collectSymbolFields(t,e){const i=[...this.getSymbols().map(n=>n.collectRequiredFields(t,e)),ro(t,e,this.valueExpression)];va(t,e,this.field),va(t,e,this.field2),va(t,e,this.field3),await Promise.all(i)}populateFromStyle(){return Xoe(this.styleOrigin,{portal:this.portal}).then(t=>{var i;const e=[];return this._valueInfoMap={},t&&t.data&&Array.isArray(t.data.items)&&t.data.items.forEach(n=>{const r=new a0({styleUrl:t.styleUrl,styleName:t.styleName,portal:this.portal,name:n.name});this.defaultSymbol||n.name!==t.data.defaultItem||(this.defaultSymbol=r,this._isDefaultSymbolDerived=!0);const s=new xy({value:n.name,symbol:r});e.push(s),this._valueInfoMap[n.name]=s}),this._set("uniqueValueInfos",Object.freeze(e)),this._updateGroupsFromInfos(!0),this._isInfosSource=null,this._watchUniqueValueInfos(),!this.defaultSymbol&&((i=this.uniqueValueInfos)!=null&&i.length)&&(this.defaultSymbol=this.uniqueValueInfos[0].symbol,this._isDefaultSymbolDerived=!0),this})}_updateFieldDelimiter(){this.field&&this.field2&&!this.fieldDelimiter&&this._set("fieldDelimiter",ELe)}_updateUniqueValues(){this._isInfosSource!=null&&(this._isInfosSource?this._updateGroupsFromInfos():this._updateInfosFromGroups())}_updateValueInfoMap(){this._valueInfoMap={};const{uniqueValueInfos:t}=this;if(t)for(const e of t)this._valueInfoMap[e.value+""]=e}_watchUniqueValueInfosAndGroups(){this._watchUniqueValueInfos(),this._watchUniqueValueGroups()}_watchUniqueValueInfos(){this.removeHandles(LG);const{uniqueValueInfos:t}=this;if(t){const e=[];for(const i of t)e.push(Q(()=>({symbol:i.symbol,value:i.value,label:i.label,description:i.description}),(n,r)=>{n!==r&&(this._updateGroupsFromInfos(),this._isInfosSource=!0)},{sync:!0}));this.addHandles(e,LG)}}_watchUniqueValueGroups(){this.removeHandles(RG);const{uniqueValueGroups:t}=this;if(t){const e=[];for(const i of t){e.push(Q(()=>({classes:i.classes}),(n,r)=>{n!==r&&(this._updateInfosFromGroups(),this._isInfosSource=!1)},{sync:!0}));for(const n of i.classes??[])e.push(Q(()=>({symbol:n.symbol,values:n.values,label:n.label,description:n.description}),(r,s)=>{r!==s&&(this._updateInfosFromGroups(),this._isInfosSource=!1)},{sync:!0}))}this.addHandles(e,RG)}}_updateInfosFromGroups(){if(!this.uniqueValueGroups)return this._set("uniqueValueInfos",null),this._updateValueInfoMap(),void this._watchUniqueValueInfos();const t=[],{field:e,field2:i,field3:n,fieldDelimiter:r,uniqueValueGroups:s,valueExpression:o}=this;if(!e&&!o)return this._set("uniqueValueInfos",t),this._updateValueInfoMap(),void this._watchUniqueValueInfos();const a=!(!e||!i);for(const l of s)for(const c of l.classes??[]){const{symbol:u,label:d,values:f,description:m}=c;for(const g of f??[]){const{value:y,value2:_,value3:b}=g,w=[y];i&&w.push(_),n&&w.push(b);const x=a?w.join(r||""):w[0];t.push(new xy({symbol:u,label:d,value:x,description:m}))}}this._set("uniqueValueInfos",t),this._updateValueInfoMap(),this._watchUniqueValueInfos()}_updateGroupsFromInfos(t=!1){if(!this.uniqueValueInfos)return this._set("uniqueValueGroups",null),void this._watchUniqueValueGroups();const{field:e,field2:i,valueExpression:n,fieldDelimiter:r,uniqueValueInfos:s}=this;if(!e&&!n||!s.length)return this._set("uniqueValueGroups",[]),void this._watchUniqueValueGroups();const o=!(!e||!i),a=s.map(c=>{var b;const{symbol:u,label:d,value:f,description:m}=c,[g,y,_]=o?((b=f==null?void 0:f.toString())==null?void 0:b.split(r||""))||[]:[f];return new Yoe({symbol:u,label:d,description:m,values:[new R_({value:g,value2:y,value3:_})]})}),l=[new uN({classes:a})];t&&Object.freeze(l),this._set("uniqueValueGroups",l),this._watchUniqueValueGroups()}_getUniqueValueInfo(t,e){return this.valueExpression?this._getUnqiueValueInfoForExpression(t,e):this._getUnqiueValueInfoForFields(t)}_getUnqiueValueInfoForExpression(t,e){const{viewingMode:i,scale:n,spatialReference:r,arcade:s}=e??{};let o=this._cache.compiledFunc;const a=s.arcadeUtils;if(!o){const c=a.createSyntaxTree(this.valueExpression);o=a.createFunction(c),this._cache.compiledFunc=o}const l=a.executeFunction(o,a.createExecContext(t,a.getViewInfo({viewingMode:i,scale:n,spatialReference:r})));return this._valueInfoMap[l+""]}_getUnqiueValueInfoForFields(t){const e=this.field,i=t.attributes;let n;if(typeof e!="function"&&this.field2){const r=this.field2,s=this.field3,o=[];e&&o.push(i[e]),r&&o.push(i[r]),s&&o.push(i[s]),n=o.join(this.fieldDelimiter||"")}else typeof e=="function"?n=e(t):e&&(n=i[e]);return this._valueInfoMap[n+""]}static fromPortalStyle(t,e){const i=new Jw(e&&e.properties);i._set("styleOrigin",Object.freeze({styleName:t})),i._set("portal",e&&e.portal||nr.getDefault());const n=i.populateFromStyle();return n.catch(r=>{Ud.error(`#fromPortalStyle('${t}'[, ...])`,"Failed to create unique value renderer from style name",r)}),n}static fromStyleUrl(t,e){const i=new Jw(e&&e.properties);i._set("styleOrigin",Object.freeze({styleUrl:t}));const n=i.populateFromStyle();return n.catch(r=>{Ud.error(`#fromStyleUrl('${t}'[, ...])`,"Failed to create unique value renderer from style URL",r)}),n}};h([p({readOnly:!0})],ji.prototype,"_cache",null),h([be({uniqueValue:"unique-value"})],ji.prototype,"type",void 0),h([p(Loe)],ji.prototype,"backgroundFillSymbol",void 0),h([p({value:null,json:{type:String,read:{source:"field1"},write:{target:"field1"}}})],ji.prototype,"field",null),h([ut("field")],ji.prototype,"castField",null),h([ge("field")],ji.prototype,"writeField",null),h([p({type:String,value:null,json:{write:!0}})],ji.prototype,"field2",null),h([p({type:String,value:null,json:{write:!0}})],ji.prototype,"field3",null),h([p({type:Boolean,json:{name:"drawInClassOrder",default:!1,write:!0,origins:{"web-scene":{write:!1}}}})],ji.prototype,"orderByClassesEnabled",void 0),h([p({type:String,value:null,json:{write:!0}})],ji.prototype,"valueExpression",null),h([p({type:String,json:{write:!0}})],ji.prototype,"valueExpressionTitle",void 0),h([p({type:wy,json:{write:!0}})],ji.prototype,"legendOptions",void 0),h([p({type:String,json:{write:!0}})],ji.prototype,"defaultLabel",void 0),h([p(sK({...Yb},{json:{write:{overridePolicy(){return{enabled:!this._isDefaultSymbolDerived}}},origins:{"web-scene":{write:{overridePolicy(){return{enabled:!this._isDefaultSymbolDerived}}}}}}}))],ji.prototype,"defaultSymbol",null),h([p({type:String,value:null,json:{write:!0}})],ji.prototype,"fieldDelimiter",null),h([p({type:nr,readOnly:!0})],ji.prototype,"portal",void 0),h([_e("portal",["styleName"])],ji.prototype,"readPortal",null),h([p({readOnly:!0,json:{write:{enabled:!1,overridePolicy:()=>({enabled:!0})}}})],ji.prototype,"styleOrigin",void 0),h([_e("styleOrigin",["styleName","styleUrl"])],ji.prototype,"readStyleOrigin",null),h([ge("styleOrigin",{styleName:{type:String},styleUrl:{type:String}})],ji.prototype,"writeStyleOrigin",null),h([p({type:[uN],json:{read:{source:["uniqueValueGroups","uniqueValueInfos"],reader:(t,e,i)=>(e.uniqueValueGroups||$Le(e)).map(n=>uN.fromJSON(n,i))},write:{overridePolicy(){return this.styleOrigin?{enabled:!1}:{enabled:!0}}}}})],ji.prototype,"uniqueValueGroups",null),h([p({type:[xy],json:{read:!1,write:{overridePolicy(){return this.styleOrigin?{enabled:!1}:{enabled:!0}}}}})],ji.prototype,"uniqueValueInfos",null),ji=Jw=h([P(Qoe)],ji);const Kb=ji,qP={key:"type",base:gd,typeMap:{heatmap:Joe,simple:HP,"unique-value":Kb,"class-breaks":Xb,"dot-density":XOe,dictionary:ZOe,"pie-chart":dLe},errorContext:"renderer"},PLe={key:"type",base:gd,typeMap:{simple:HP,"unique-value":Kb,"class-breaks":Xb,heatmap:Joe},errorContext:"renderer"};function kLe(t,e){return DA(t,null,e)}const OLe=Ob({types:qP});function DA(t,e,i){return t?t&&(t.styleName||t.styleUrl)&&t.type!=="uniqueValue"?(i&&i.messages&&i.messages.push(new fl("renderer:unsupported","Only UniqueValueRenderer can be referenced from a web style, but found '"+t.type+"'",{definition:t,context:i})),null):OLe(t,e,i):null}let LLe=class eae{constructor(){this._propertyOriginMap=new Map,this._originStores=new Array(XL),this._values=new Map,this.multipleOriginsSupported=!0}clone(e){const i=new eae,n=this._originStores[Ge.DEFAULTS];n&&n.forEach((r,s)=>{i.set(s,q(r),Ge.DEFAULTS)});for(let r=Ge.SERVICE;r<XL;r++){const s=this._originStores[r];s&&s.forEach((o,a)=>{e&&e.has(a)||i.set(a,q(o),r)})}return i}get(e,i){const n=i===void 0?this._values:this._originStores[i];return n?n.get(e):void 0}keys(e){const i=e==null?this._values:this._originStores[e];return i?[...i.keys()]:[]}set(e,i,n=Ge.USER){let r=this._originStores[n];if(r||(r=new Map,this._originStores[n]=r),r.set(e,i),!this._values.has(e)||this._propertyOriginMap.get(e)<=n){const s=this._values.get(e);return this._values.set(e,i),this._propertyOriginMap.set(e,n),s!==i}return!1}delete(e,i=Ge.USER){const n=this._originStores[i];if(!n)return;const r=n.get(e);if(n.delete(e),this._values.has(e)&&this._propertyOriginMap.get(e)===i){this._values.delete(e);for(let s=i-1;s>=0;s--){const o=this._originStores[s];if(o&&o.has(e)){this._values.set(e,o.get(e)),this._propertyOriginMap.set(e,s);break}}}return r}has(e,i){const n=i===void 0?this._values:this._originStores[i];return!!n&&n.has(e)}revert(e,i){for(;i>0&&!this.has(e,i);)--i;const n=this._originStores[i],r=n&&n.get(e),s=this._values.get(e);return this._values.set(e,r),this._propertyOriginMap.set(e,i),s!==r}originOf(e){return this._propertyOriginMap.get(e)||Ge.DEFAULTS}forEach(e){this._values.forEach(e)}};const tae=t=>{let e=class extends t{constructor(...i){super(...i);const n=no(this),r=n.store,s=new LLe;n.store=s,tQ(n,r,s)}read(i,n){nQ(this,i,n)}getAtOrigin(i,n){const r=sO(this),s=ef(n);if(typeof i=="string")return r.get(i,s);const o={};return i.forEach(a=>{o[a]=r.get(a,s)}),o}originOf(i){return OE(this.originIdOf(i))}originIdOf(i){return sO(this).originOf(i)}revert(i,n){const r=sO(this),s=ef(n),o=no(this);let a;a=typeof i=="string"?i==="*"?r.keys(s):[i]:i,a.forEach(l=>{o.invalidate(l),r.revert(l,s),o.commit(l)})}};return e=h([P("esri.core.ReadOnlyMultiOriginJSONSupport")],e),e};function sO(t){return no(t).store}let DG=class extends tae(ye){};DG=h([P("esri.core.ReadOnlyMultiOriginJSONSupport")],DG);const RLe=t=>{let e=class extends t{constructor(...i){super(...i)}clear(i,n="user"){return oO(this).delete(i,ef(n))}write(i,n){return sQ(this,i=i||{},n),i}setAtOrigin(i,n,r){no(this).setAtOrigin(i,n,ef(r))}removeOrigin(i){const n=oO(this),r=ef(i),s=n.keys(r);for(const o of s)n.originOf(o)===r&&n.set(o,n.get(o,r),Ge.USER)}updateOrigin(i,n){const r=oO(this),s=ef(n),o=this.get(i);for(let a=s+1;a<XL;++a)r.delete(i,a);r.set(i,o,s)}toJSON(i){return this.write({},i)}};return e=h([P("esri.core.WriteableMultiOriginJSONSupport")],e),e.prototype.toJSON.isDefaultToJSON=!0,e};function oO(t){return no(t).store}const ij=t=>{let e=class extends RLe(tae(t)){constructor(...i){super(...i)}};return e=h([P("esri.core.MultiOriginJSONSupport")],e),e};let NG=class extends ij(ye){};NG=h([P("esri.core.MultiOriginJSONSupport")],NG);const DLe={supportsStatistics:!0,supportsPercentileStatistics:!0,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsTopFeaturesQuery:!1,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,supportsDefaultSpatialReference:!1,supportsFullTextSearch:!1,supportsCompactGeometry:!1,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0},iae=[252,146,31,255],kdt=[153,153,153,255],nae={type:"esriSMS",style:"esriSMSCircle",size:6,color:iae,outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[153,153,153,255]}},rae={type:"esriSLS",style:"esriSLSSolid",width:.75,color:iae},sae={type:"esriSFS",style:"esriSFSSolid",color:[252,146,31,196],outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[255,255,255,191]}},NLe={type:"esriTS",color:[255,255,255,255],font:{family:"arial-unicode-ms",size:10,weight:"bold"},horizontalAlignment:"center",kerning:!0,haloColor:[0,0,0,255],haloSize:1,rotated:!1,text:"",xoffset:0,yoffset:0,angle:0},FLe={type:"esriSMS",style:"esriSMSCircle",color:[0,0,0,255],outline:null,size:10.5},zLe={type:"esriSLS",style:"esriSLSSolid",color:[0,0,0,255],width:1.5},VLe={type:"esriSFS",style:"esriSFSSolid",color:[0,0,0,255],outline:null};function Odt(t){return{renderer:{type:"simple",symbol:t==="esriGeometryPoint"||t==="esriGeometryMultipoint"?nae:t==="esriGeometryPolyline"?rae:sae}}}const jLe=/^[_$a-zA-Z][_$a-zA-Z0-9]*$/;let BLe=1;function Ldt(t,e){if(ee("esri-csp-restrictions"))return()=>({[e]:null,...t});try{let i=`this.${e} = null;`;for(const r in t)i+=`this${jLe.test(r)?`.${r}`:`["${r}"]`} = ${JSON.stringify(t[r])};`;const n=new Function(`
      return class AttributesClass$${BLe++} {
        constructor() {
          ${i};
        }
      }
    `)();return()=>new n}catch{return()=>({[e]:null,...t})}}function Rdt(t={}){return[{name:"New Feature",description:"",prototype:{attributes:q(t)}}]}function ULe(t,e){return{analytics:{supportsCacheHint:!1},attachment:null,data:{isVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:t},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:e,supportsDelete:e,supportsEditing:e,supportsChangeTracking:!1,supportsQuery:!0,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:e,supportsExceedsLimitStatistics:!0,supportsAsyncConvert3D:!1},query:DLe,queryRelated:{supportsCount:!0,supportsOrderBy:!0,supportsPagination:!0,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},editing:{supportsGeometryUpdate:e,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1,supportsAsyncApplyEdits:!1}}}var dN;let p_=dN=class extends ie{constructor(t){super(t),this.name=null,this.code=null}clone(){return new dN({name:this.name,code:this.code})}};h([p({type:String,json:{write:!0}})],p_.prototype,"name",void 0),h([p({type:[String,Number],json:{write:!0}})],p_.prototype,"code",void 0),p_=dN=h([P("esri.layers.support.CodedValue")],p_);const GLe=new qe({inherited:"inherited",codedValue:"coded-value",range:"range"});let Zw=class extends ie{constructor(e){super(e),this.name=null,this.type=null}};h([p({type:String,json:{write:!0}})],Zw.prototype,"name",void 0),h([be(GLe)],Zw.prototype,"type",void 0),Zw=h([P("esri.layers.support.Domain")],Zw);const WP=Zw;var pN;let Yw=pN=class extends WP{constructor(t){super(t),this.codedValues=null,this.type="coded-value"}getName(t){let e=null;if(this.codedValues){const i=String(t);this.codedValues.some(n=>(String(n.code)===i&&(e=n.name),!!e))}return e}clone(){return new pN({codedValues:q(this.codedValues),name:this.name})}};h([p({type:[p_],json:{write:!0}})],Yw.prototype,"codedValues",void 0),h([be({codedValue:"coded-value"})],Yw.prototype,"type",void 0),Yw=pN=h([P("esri.layers.support.CodedValueDomain")],Yw);const JP=Yw;var fN;let UM=fN=class extends WP{constructor(t){super(t),this.type="inherited"}clone(){return new fN}};h([be({inherited:"inherited"})],UM.prototype,"type",void 0),UM=fN=h([P("esri.layers.support.InheritedDomain")],UM);const oae=UM;var mN;let Pv=mN=class extends WP{constructor(t){super(t),this.maxValue=null,this.minValue=null,this.type="range"}clone(){return new mN({maxValue:this.maxValue,minValue:this.minValue,name:this.name})}};h([p({type:Number,json:{type:[Number],read:{source:"range",reader:(t,e)=>e.range&&e.range[1]},write:{enabled:!1,overridePolicy(){return{enabled:this.maxValue!=null&&this.minValue==null}},target:"range",writer(t,e,i){e[i]=[this.minValue||0,t]}}}})],Pv.prototype,"maxValue",void 0),h([p({type:Number,json:{type:[Number],read:{source:"range",reader:(t,e)=>e.range&&e.range[0]},write:{target:"range",writer(t,e,i){e[i]=[t,this.maxValue||0]}}}})],Pv.prototype,"minValue",void 0),h([be({range:"range"})],Pv.prototype,"type",void 0),Pv=mN=h([P("esri.layers.support.RangeDomain")],Pv);const aae=Pv,HLe={key:"type",base:WP,typeMap:{range:aae,"coded-value":JP,inherited:oae}};function lae(t){if(!t||!t.type)return null;switch(t.type){case"range":return aae.fromJSON(t);case"codedValue":return JP.fromJSON(t);case"inherited":return oae.fromJSON(t)}return null}const qLe=new qe({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml",esriFieldTypeBigInteger:"big-integer",esriFieldTypeDateOnly:"date-only",esriFieldTypeTimeOnly:"time-only",esriFieldTypeTimestampOffset:"timestamp-offset"});var gN;const WLe=new qe({binary:"binary",coordinate:"coordinate",countOrAmount:"count-or-amount",dateAndTime:"date-and-time",description:"description",locationOrPlaceName:"location-or-place-name",measurement:"measurement",nameOrTitle:"name-or-title",none:"none",orderedOrRanked:"ordered-or-ranked",percentageOrRatio:"percentage-or-ratio",typeOrCategory:"type-or-category",uniqueIdentifier:"unique-identifier"});let gs=gN=class extends ie{constructor(t){super(t),this.alias=null,this.defaultValue=void 0,this.description=null,this.domain=null,this.editable=!0,this.length=-1,this.name=null,this.nullable=!0,this.type=null,this.valueType=null,this.visible=!0}readDescription(t,{description:e}){let i=null;try{i=e?JSON.parse(e):null}catch{}return(i==null?void 0:i.value)??null}readValueType(t,{description:e}){let i=null;try{i=e?JSON.parse(e):null}catch{}return i?WLe.fromJSON(i.fieldValueType):null}clone(){return new gN({alias:this.alias,defaultValue:this.defaultValue,description:this.description,domain:this.domain&&this.domain.clone()||null,editable:this.editable,length:this.length,name:this.name,nullable:this.nullable,type:this.type,valueType:this.valueType,visible:this.visible})}};h([p({type:String,json:{write:!0}})],gs.prototype,"alias",void 0),h([p({type:[String,Number],json:{write:{allowNull:!0}}})],gs.prototype,"defaultValue",void 0),h([p()],gs.prototype,"description",void 0),h([_e("description")],gs.prototype,"readDescription",null),h([p({types:HLe,json:{read:{reader:lae},write:!0}})],gs.prototype,"domain",void 0),h([p({type:Boolean,json:{write:!0}})],gs.prototype,"editable",void 0),h([p({type:It,json:{write:!0}})],gs.prototype,"length",void 0),h([p({type:String,json:{write:!0}})],gs.prototype,"name",void 0),h([p({type:Boolean,json:{write:!0}})],gs.prototype,"nullable",void 0),h([be(qLe)],gs.prototype,"type",void 0),h([p()],gs.prototype,"valueType",void 0),h([_e("valueType",["description"])],gs.prototype,"readValueType",null),h([p({type:Boolean,json:{read:!1}})],gs.prototype,"visible",void 0),gs=gN=h([P("esri.layers.support.Field")],gs);const dc=gs;var yN;const vN=new qe({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh","":null});let Mr=yN=class extends ie{constructor(t){super(t),this.displayFieldName=null,this.exceededTransferLimit=!1,this.features=[],this.fields=null,this.geometryType=null,this.hasM=!1,this.hasZ=!1,this.queryGeometry=null,this.spatialReference=null}readFeatures(t,e){const i=Ee.fromJSON(e.spatialReference),n=[];for(let r=0;r<t.length;r++){const s=t[r],o=Vo.fromJSON(s),a=s.geometry&&s.geometry.spatialReference;o.geometry==null||a||(o.geometry.spatialReference=i);const l=s.aggregateGeometries,c=o.aggregateGeometries;if(l&&c!=null)for(const u in c){const d=c[u],f=l[u],m=f==null?void 0:f.spatialReference;d==null||m||(d.spatialReference=i)}n.push(o)}return n}writeGeometryType(t,e,i,n){if(t)return void vN.write(t,e,i,n);const{features:r}=this;if(r){for(const s of r)if(s&&s.geometry!=null)return void vN.write(s.geometry.type,e,i,n)}}readQueryGeometry(t,e){if(!t)return null;const i=!!t.spatialReference,n=ad(t);return n&&!i&&e.spatialReference&&(n.spatialReference=Ee.fromJSON(e.spatialReference)),n}writeSpatialReference(t,e){if(t)return void(e.spatialReference=t.toJSON());const{features:i}=this;if(i){for(const n of i)if(n&&n.geometry!=null&&n.geometry.spatialReference)return void(e.spatialReference=n.geometry.spatialReference.toJSON())}}clone(){return new yN(this.cloneProperties())}cloneProperties(){return q({displayFieldName:this.displayFieldName,exceededTransferLimit:this.exceededTransferLimit,features:this.features,fields:this.fields,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,queryGeometry:this.queryGeometry,spatialReference:this.spatialReference,transform:this.transform})}toJSON(t){const e=this.write();if(e.features&&Array.isArray(t)&&t.length>0)for(let i=0;i<e.features.length;i++){const n=e.features[i];if(n.geometry){const r=t&&t[i];n.geometry=r&&r.toJSON()||n.geometry}}return e}quantize(t){const{scale:[e,i],translate:[n,r]}=t,s=c=>Math.round((c-n)/e),o=c=>Math.round((r-c)/i),a=this.features,l=this._getQuantizationFunction(this.geometryType,s,o);for(let c=0,u=a.length;c<u;c++)l!=null&&l(a[c].geometry)||(a.splice(c,1),c--,u--);return this.transform=t,this}unquantize(){var f,m;const{geometryType:t,features:e,transform:i}=this;if(!i)return this;const{translate:[n,r],scale:[s,o]}=i,a=g=>g*s+n,l=g=>r-g*o;let c=null,u=null;if(this.hasZ&&((f=i==null?void 0:i.scale)==null?void 0:f[2])!=null){const{translate:[,,g],scale:[,,y]}=i;c=_=>_*y+g}if(this.hasM&&((m=i==null?void 0:i.scale)==null?void 0:m[3])!=null){const{translate:[,,,g],scale:[,,,y]}=i;u=_=>_==null?_:_*y+g}const d=this._getHydrationFunction(t,a,l,c,u);for(const{geometry:g}of e)g!=null&&d&&d(g);return this.transform=null,this}_quantizePoints(t,e,i){let n,r;const s=[];for(let o=0,a=t.length;o<a;o++){const l=t[o];if(o>0){const c=e(l[0]),u=i(l[1]);c===n&&u===r||(s.push([c-n,u-r]),n=c,r=u)}else n=e(l[0]),r=i(l[1]),s.push([n,r])}return s.length>0?s:null}_getQuantizationFunction(t,e,i){return t==="point"?n=>(n.x=e(n.x),n.y=i(n.y),n):t==="polyline"||t==="polygon"?n=>{const r=$_(n)?n.rings:n.paths,s=[];for(let o=0,a=r.length;o<a;o++){const l=r[o],c=this._quantizePoints(l,e,i);c&&s.push(c)}return s.length>0?($_(n)?n.rings=s:n.paths=s,n):null}:t==="multipoint"?n=>{const r=this._quantizePoints(n.points,e,i);return r&&r.length>0?(n.points=r,n):null}:t==="extent"?n=>n:null}_getHydrationFunction(t,e,i,n,r){return t==="point"?s=>{s.x=e(s.x),s.y=i(s.y),n&&(s.z=n(s.z))}:t==="polyline"||t==="polygon"?s=>{const o=$_(s)?s.rings:s.paths;let a,l;for(let c=0,u=o.length;c<u;c++){const d=o[c];for(let f=0,m=d.length;f<m;f++){const g=d[f];f>0?(a+=g[0],l+=g[1]):(a=g[0],l=g[1]),g[0]=e(a),g[1]=i(l)}}if(n&&r)for(let c=0,u=o.length;c<u;c++){const d=o[c];for(let f=0,m=d.length;f<m;f++){const g=d[f];g[2]=n(g[2]),g[3]=r(g[3])}}else if(n)for(let c=0,u=o.length;c<u;c++){const d=o[c];for(let f=0,m=d.length;f<m;f++){const g=d[f];g[2]=n(g[2])}}else if(r)for(let c=0,u=o.length;c<u;c++){const d=o[c];for(let f=0,m=d.length;f<m;f++){const g=d[f];g[2]=r(g[2])}}}:t==="extent"?s=>{s.xmin=e(s.xmin),s.ymin=i(s.ymin),s.xmax=e(s.xmax),s.ymax=i(s.ymax),n&&s.zmax!=null&&s.zmin!=null&&(s.zmax=n(s.zmax),s.zmin=n(s.zmin)),r&&s.mmax!=null&&s.mmin!=null&&(s.mmax=r(s.mmax),s.mmin=r(s.mmin))}:t==="multipoint"?s=>{const o=s.points;let a,l;for(let c=0,u=o.length;c<u;c++){const d=o[c];c>0?(a+=d[0],l+=d[1]):(a=d[0],l=d[1]),d[0]=e(a),d[1]=i(l)}if(n&&r)for(let c=0,u=o.length;c<u;c++){const d=o[c];d[2]=n(d[2]),d[3]=r(d[3])}else if(n)for(let c=0,u=o.length;c<u;c++){const d=o[c];d[2]=n(d[2])}else if(r)for(let c=0,u=o.length;c<u;c++){const d=o[c];d[2]=r(d[2])}}:null}};h([p({type:String,json:{write:!0}})],Mr.prototype,"displayFieldName",void 0),h([p({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],Mr.prototype,"exceededTransferLimit",void 0),h([p({type:[Vo],json:{write:!0}})],Mr.prototype,"features",void 0),h([_e("features")],Mr.prototype,"readFeatures",null),h([p({type:[dc],json:{write:!0}})],Mr.prototype,"fields",void 0),h([p({type:["point","multipoint","polyline","polygon","extent","mesh"],json:{read:{reader:vN.read}}})],Mr.prototype,"geometryType",void 0),h([ge("geometryType")],Mr.prototype,"writeGeometryType",null),h([p({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],Mr.prototype,"hasM",void 0),h([p({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],Mr.prototype,"hasZ",void 0),h([p({types:r0,json:{write:!0}})],Mr.prototype,"queryGeometry",void 0),h([_e("queryGeometry")],Mr.prototype,"readQueryGeometry",null),h([p({type:Ee,json:{write:!0}})],Mr.prototype,"spatialReference",void 0),h([ge("spatialReference")],Mr.prototype,"writeSpatialReference",null),h([p({json:{write:!0}})],Mr.prototype,"transform",void 0),Mr=yN=h([P("esri.rest.support.FeatureSet")],Mr),Mr.prototype.toJSON.isDefaultToJSON=!0;const oT=Mr,cae="esri.layers.graphics.sources.GeoJSONSource",FG=ne.getLogger(cae);let ag=class extends rd{constructor(){super(...arguments),this.type="geojson",this.refresh=kS(async e=>{await this.load();const{extent:i,timeExtent:n}=await this._connection.invoke("refresh",e);return this.sourceJSON.extent=i,n&&(this.sourceJSON.timeInfo.timeExtent=[n.start,n.end]),{dataChanged:!0,updates:{extent:this.sourceJSON.extent,timeInfo:this.sourceJSON.timeInfo}}})}load(e){const i=e!=null?e.signal:null;return this.addResolvingPromise(this._startWorker(i)),Promise.resolve(this)}destroy(){var e;(e=this._connection)==null||e.close(),this._connection=null}applyEdits(e){return this.load().then(()=>this._applyEdits(e))}openPorts(){return this.load().then(()=>this._connection.openPorts())}queryFeatures(e,i={}){return this.load(i).then(()=>this._connection.invoke("queryFeatures",e?e.toJSON():null,i)).then(n=>oT.fromJSON(n))}queryFeaturesJSON(e,i={}){return this.load(i).then(()=>this._connection.invoke("queryFeatures",e?e.toJSON():null,i))}queryFeatureCount(e,i={}){return this.load(i).then(()=>this._connection.invoke("queryFeatureCount",e?e.toJSON():null,i))}queryObjectIds(e,i={}){return this.load(i).then(()=>this._connection.invoke("queryObjectIds",e?e.toJSON():null,i))}queryExtent(e,i={}){return this.load(i).then(()=>this._connection.invoke("queryExtent",e?e.toJSON():null,i)).then(n=>({count:n.count,extent:Le.fromJSON(n.extent)}))}querySnapping(e,i={}){return this.load(i).then(()=>this._connection.invoke("querySnapping",e,i))}_applyEdits(e){if(!this._connection)throw new V("geojson-layer-source:edit-failure","Memory source not loaded");const i=this.layer.objectIdField,n=[],r=[],s=[];if(e.addFeatures)for(const o of e.addFeatures)n.push(this._serializeFeature(o));if(e.deleteFeatures)for(const o of e.deleteFeatures)"objectId"in o&&o.objectId!=null?r.push(o.objectId):"attributes"in o&&o.attributes[i]!=null&&r.push(o.attributes[i]);if(e.updateFeatures)for(const o of e.updateFeatures)s.push(this._serializeFeature(o));return this._connection.invoke("applyEdits",{adds:n,updates:s,deletes:r}).then(({extent:o,timeExtent:a,featureEditResults:l})=>(this.sourceJSON.extent=o,a&&(this.sourceJSON.timeInfo.timeExtent=[a.start,a.end]),this._createEditsResult(l)))}_createEditsResult(e){return{addFeatureResults:e.addResults?e.addResults.map(this._createFeatureEditResult,this):[],updateFeatureResults:e.updateResults?e.updateResults.map(this._createFeatureEditResult,this):[],deleteFeatureResults:e.deleteResults?e.deleteResults.map(this._createFeatureEditResult,this):[],addAttachmentResults:[],updateAttachmentResults:[],deleteAttachmentResults:[]}}_createFeatureEditResult(e){const i=e.success===!0?null:e.error||{code:void 0,description:void 0};return{objectId:e.objectId,globalId:e.globalId,error:i?new V("geojson-layer-source:edit-failure",i.description,{code:i.code}):null}}_serializeFeature(e){const{attributes:i}=e,n=this._geometryForSerialization(e);return n?{geometry:n.toJSON(),attributes:i}:{attributes:i}}_geometryForSerialization(e){const{geometry:i}=e;return i==null?null:i.type==="mesh"||i.type==="extent"?Vr.fromExtent(i.extent):i}async _startWorker(e){this._connection=await pne("GeoJSONSourceWorker",{strategy:ee("feature-layers-workers")?"dedicated":"local",signal:e});const{fields:i,spatialReference:n,hasZ:r,geometryType:s,objectIdField:o,url:a,timeInfo:l,customParameters:c}=this.layer,u=this.layer.originOf("spatialReference")==="defaults",d={url:a,customParameters:c,fields:i&&i.map(m=>m.toJSON()),geometryType:O6.toJSON(s),hasZ:r,objectIdField:o,timeInfo:l?l.toJSON():null,spatialReference:u?null:n&&n.toJSON()},f=await this._connection.invoke("load",d,{signal:e});for(const m of f.warnings)FG.warn(m.message,{layer:this.layer,warning:m});f.featureErrors.length&&FG.warn(`Encountered ${f.featureErrors.length} validation errors while loading features`,f.featureErrors),this.sourceJSON=f.layerDefinition,this.capabilities=ULe(this.sourceJSON.hasZ,!0)}};h([p()],ag.prototype,"capabilities",void 0),h([p()],ag.prototype,"type",void 0),h([p({constructOnly:!0})],ag.prototype,"layer",void 0),h([p()],ag.prototype,"sourceJSON",void 0),ag=h([P(cae)],ag);function ZP(){const t=new Float32Array(16);return t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function JLe(t){const e=new Float32Array(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function ZLe(t,e,i,n,r,s,o,a,l,c,u,d,f,m,g,y){const _=new Float32Array(16);return _[0]=t,_[1]=e,_[2]=i,_[3]=n,_[4]=r,_[5]=s,_[6]=o,_[7]=a,_[8]=l,_[9]=c,_[10]=u,_[11]=d,_[12]=f,_[13]=m,_[14]=g,_[15]=y,_}function YLe(t,e){return new Float32Array(t,e,16)}const XLe=ZP();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:XLe,clone:JLe,create:ZP,createView:YLe,fromValues:ZLe},Symbol.toStringTag,{value:"Module"}));const KLe=(t,e)=>{const i=Yf(t,e,0,0,0,0,e,0,0,0,0,e,0,0,0,0,1);return gl(i,i)},QLe=(t,e)=>{const i=Yf(t,e,0,0,.5-.5*e,0,e,0,.5-.5*e,0,0,e,.5-.5*e,0,0,0,1);return gl(i,i)},eRe=(t,e)=>{const i=1-e,n=Yf(t,.2126+.7874*i,.7152-.7152*i,.0722-.0722*i,0,.2126-.2126*i,.7152+.2848*i,.0722-.0722*i,0,.2126-.2126*i,.7152-.7152*i,.0722+.9278*i,0,0,0,0,1);return gl(n,n)},tRe=(t,e)=>{const i=Math.sin(e*Math.PI/180),n=Math.cos(e*Math.PI/180),r=Yf(t,.213+.787*n-.213*i,.715-.715*n-.715*i,.072-.072*n+.928*i,0,.213-.213*n+.143*i,.715+.285*n+.14*i,.072-.072*n-.283*i,0,.213-.213*n-.787*i,.715-.715*n+.715*i,.072+.928*n+.072*i,0,0,0,0,1);return gl(r,r)},iRe=(t,e)=>{const i=1-2*e,n=Yf(t,i,0,0,e,0,i,0,e,0,0,i,e,0,0,0,1);return gl(n,n)},nRe=(t,e)=>{const i=Yf(t,.213+.787*e,.715-.715*e,.072-.072*e,0,.213-.213*e,.715+.285*e,.072-.072*e,0,.213-.213*e,.715-.715*e,.072+.928*e,0,0,0,0,1);return gl(i,i)},rRe=(t,e)=>{const i=1-e,n=Yf(t,.393+.607*i,.769-.769*i,.189-.189*i,0,.349-.349*i,.686+.314*i,.168-.168*i,0,.272-.272*i,.534-.534*i,.131+.869*i,0,0,0,0,1);return gl(n,n)};let uae=class hae{constructor(e,i,n){this.strength=e,this.radius=i,this.threshold=n,this.type="bloom"}interpolate(e,i,n){this.strength=Ao(e.strength,i.strength,n),this.radius=Ao(e.radius,i.radius,n),this.threshold=Ao(e.threshold,i.threshold,n)}clone(){return new hae(this.strength,this.radius,this.threshold)}toJSON(){return{type:"bloom",radius:qx(this.radius),strength:this.strength,threshold:this.threshold}}},dae=class pae{constructor(e){this.radius=e,this.type="blur"}interpolate(e,i,n){this.radius=Math.round(Ao(e.radius,i.radius,n))}clone(){return new pae(this.radius)}toJSON(){return{type:"blur",radius:qx(this.radius)}}},_N=class fae{constructor(e,i){this.type=e,this.amount=i,this.type!=="invert"&&this.type!=="grayscale"&&this.type!=="sepia"||(this.amount=Math.min(this.amount,1))}get colorMatrix(){return this._colorMatrix||this._updateMatrix(),this._colorMatrix}interpolate(e,i,n){this.amount=Ao(e.amount,i.amount,n),this._updateMatrix()}clone(){return new fae(this.type,this.amount)}toJSON(){return{type:this.type,amount:this.amount}}_updateMatrix(){const e=this._colorMatrix||ZP();switch(this.type){case"brightness":this._colorMatrix=KLe(e,this.amount);break;case"contrast":this._colorMatrix=QLe(e,this.amount);break;case"grayscale":this._colorMatrix=eRe(e,this.amount);break;case"invert":this._colorMatrix=iRe(e,this.amount);break;case"saturate":this._colorMatrix=nRe(e,this.amount);break;case"sepia":this._colorMatrix=rRe(e,this.amount)}}},mae=class gae{constructor(e,i,n,r){this.offsetX=e,this.offsetY=i,this.blurRadius=n,this.color=r,this.type="drop-shadow"}interpolate(e,i,n){this.offsetX=Ao(e.offsetX,i.offsetX,n),this.offsetY=Ao(e.offsetY,i.offsetY,n),this.blurRadius=Ao(e.blurRadius,i.blurRadius,n),this.color[0]=Math.round(Ao(e.color[0],i.color[0],n)),this.color[1]=Math.round(Ao(e.color[1],i.color[1],n)),this.color[2]=Math.round(Ao(e.color[2],i.color[2],n)),this.color[3]=Ao(e.color[3],i.color[3],n)}clone(){return new gae(this.offsetX,this.offsetY,this.blurRadius,[...this.color])}toJSON(){const e=[...this.color];return e[3]*=255,{type:"drop-shadow",xoffset:qx(this.offsetX),yoffset:qx(this.offsetY),blurRadius:qx(this.blurRadius),color:e}}},yae=class vae{constructor(e){this.angle=e,this.type="hue-rotate"}get colorMatrix(){return this._colorMatrix||this._updateMatrix(),this._colorMatrix}interpolate(e,i,n){this.angle=Ao(e.angle,i.angle,n),this._updateMatrix()}clone(){return new vae(this.angle)}toJSON(){return{type:"hue-rotate",angle:this.angle}}_updateMatrix(){const e=this._colorMatrix||ZP();this._colorMatrix=tRe(e,this.angle)}},_ae=class bae{constructor(e){this.amount=e,this.type="opacity",this.amount=Math.min(this.amount,1)}interpolate(e,i,n){this.amount=Ao(e.amount,i.amount,n)}clone(){return new bae(this.amount)}toJSON(){return{type:"opacity",amount:this.amount}}};function Ao(t,e,i){return t+(e-t)*i}function qx(t){return Math.round(1e3*Tc(t))/1e3}function sRe(t){switch(t.type){case"grayscale":case"sepia":case"invert":return new _N(t.type,0);case"saturate":case"brightness":case"contrast":return new _N(t.type,1);case"opacity":return new _ae(1);case"hue-rotate":return new yae(0);case"blur":return new dae(0);case"drop-shadow":return new mae(0,0,0,[...v6("transparent")]);case"bloom":return new uae(0,0,1)}}function wae(t,e){const i=t.length>e.length?t:e;return(t.length>e.length?e:t).every((n,r)=>n.type===i[r].type)}function xae(t,e){const i=t.length>e.length?t:e,n=t.length>e.length?e:t;for(let r=n.length;r<i.length;r++)n.push(sRe(i[r]))}function oRe(t){const e=t[0];return!!e&&"type"in e}var zG,VG,bN={exports:{}};bN.exports,VG=function(){function t(r,s){function o(){this.constructor=r}o.prototype=s.prototype,r.prototype=new o}function e(r,s,o,a){var l=Error.call(this,r);return Object.setPrototypeOf&&Object.setPrototypeOf(l,e.prototype),l.expected=s,l.found=o,l.location=a,l.name="SyntaxError",l}function i(r,s,o){return o=o||" ",r.length>s?r:(s-=r.length,r+(o+=o.repeat(s)).slice(0,s))}function n(r,s){var o,a={},l=(s=s!==void 0?s:{}).grammarSource,c={start:x0},u=x0,d="none",f=")",m=",",g="(",y="%",_="px",b="cm",w="mm",x="in",S="pt",T="pc",I="deg",C="rad",M="grad",E="turn",A="#",$=".",L="e",D=/^[ \t\n\r]/,F=/^[a-z\-]/,z=/^[0-9a-fA-F]/,U=/^[+\-]/,G=/^[0-9]/,W=Ho("none"),Z=$n("none",!1),X=$n(")",!1),oe=$n(",",!1),se=Ho("whitespace"),le=Td([" ","	",`
`,"\r"],!1,!1),de=Ho("function"),we=$n("(",!1),Re=Ho("identifier"),ze=Td([["a","z"],"-"],!1,!1),Ct=Ho("percentage"),Ae=$n("%",!1),ke=Ho("length"),jt=$n("px",!1),gn=$n("cm",!1),_t=$n("mm",!1),zs=$n("in",!1),Gr=$n("pt",!1),fi=$n("pc",!1),Fn=Ho("angle"),xl=$n("deg",!1),Sl=$n("rad",!1),Wi=$n("grad",!1),Ji=$n("turn",!1),lo=Ho("number"),Ie=Ho("color"),Ze=$n("#",!1),Mt=Td([["0","9"],["a","f"],["A","F"]],!1,!1),Ni=Td(["+","-"],!1,!1),si=Td([["0","9"]],!1,!1),or=$n(".",!1),yn=$n("e",!1),ar=function(){return[]},xd=function(j,re){return{type:"function",name:j,parameters:re||[]}},l1=function(j,re){return re.length>0?u1(j,re,3):[j]},zk=function(j){return{type:"quantity",value:j.value,unit:j.unit}},Vk=function(j){return{type:"color",colorType:j.type,value:j.value}},jk=function(j){return j},Bk=function(){return sm()},Uk=function(j){return{value:j,unit:"%"}},v0=function(j){return{value:j,unit:"px"}},Gk=function(j){return{value:j,unit:"cm"}},Hk=function(j){return{value:j,unit:"mm"}},PT=function(j){return{value:j,unit:"in"}},kT=function(j){return{value:j,unit:"pt"}},c1=function(j){return{value:j,unit:"pc"}},qk=function(j){return{value:j,unit:"deg"}},Wk=function(j){return{value:j,unit:"rad"}},Jk=function(j){return{value:j,unit:"grad"}},OT=function(j){return{value:j,unit:"turn"}},Zk=function(j){return{value:j,unit:null}},Yk=function(){return{type:"hex",value:sm()}},Xk=function(j){return{type:"function",value:j}},_0=function(){return{type:"named",value:sm()}},Kk=function(){return parseFloat(sm())},K=0,vi=0,Sd=[{line:1,column:1}],Ta=0,b0=[],$e=0;if("startRule"in s){if(!(s.startRule in c))throw new Error(`Can't start parsing from rule "`+s.startRule+'".');u=c[s.startRule]}function sm(){return r.substring(vi,K)}function $n(j,re){return{type:"literal",text:j,ignoreCase:re}}function Td(j,re,ce){return{type:"class",parts:j,inverted:re,ignoreCase:ce}}function LT(){return{type:"end"}}function Ho(j){return{type:"other",description:j}}function Lc(j){var re,ce=Sd[j];if(ce)return ce;for(re=j-1;!Sd[re];)re--;for(ce={line:(ce=Sd[re]).line,column:ce.column};re<j;)r.charCodeAt(re)===10?(ce.line++,ce.column=1):ce.column++,re++;return Sd[j]=ce,ce}function Id(j,re,ce){var Qe=Lc(j),oi=Lc(re),Yt={source:l,start:{offset:j,line:Qe.line,column:Qe.column},end:{offset:re,line:oi.line,column:oi.column}};return ce&&l&&typeof l.offset=="function"&&(Yt.start=l.offset(Yt.start),Yt.end=l.offset(Yt.end)),Yt}function je(j){K<Ta||(K>Ta&&(Ta=K,b0=[]),b0.push(j))}function w0(j,re,ce){return new e(e.buildMessage(j,re),j,re,ce)}function x0(){var j;return(j=Qk())===a&&(j=e3()),j}function Qk(){var j,re;return $e++,j=K,_i(),r.substr(K,4)===d?(re=d,K+=4):(re=a,$e===0&&je(Z)),re!==a?(_i(),vi=j,j=ar()):(K=j,j=a),$e--,j===a&&$e===0&&je(W),j}function e3(){var j,re;if(j=[],(re=Cd())!==a)for(;re!==a;)j.push(re),re=Cd();else j=a;return j}function Cd(){var j,re,ce,Qe;return j=K,_i(),(re=Tl())!==a?(_i(),(ce=co())===a&&(ce=null),_i(),r.charCodeAt(K)===41?(Qe=f,K++):(Qe=a,$e===0&&je(X)),Qe!==a?(_i(),vi=j,j=xd(re,ce)):(K=j,j=a)):(K=j,j=a),j}function co(){var j,re,ce,Qe,oi,Yt,Vs,Ed;if(j=K,(re=Rc())!==a){for(ce=[],Qe=K,oi=_i(),r.charCodeAt(K)===44?(Yt=m,K++):(Yt=a,$e===0&&je(oe)),Yt===a&&(Yt=null),Vs=_i(),(Ed=Rc())!==a?Qe=oi=[oi,Yt,Vs,Ed]:(K=Qe,Qe=a);Qe!==a;)ce.push(Qe),Qe=K,oi=_i(),r.charCodeAt(K)===44?(Yt=m,K++):(Yt=a,$e===0&&je(oe)),Yt===a&&(Yt=null),Vs=_i(),(Ed=Rc())!==a?Qe=oi=[oi,Yt,Vs,Ed]:(K=Qe,Qe=a);vi=j,j=l1(re,ce)}else K=j,j=a;return j}function Rc(){var j,re;return j=K,(re=Ia())===a&&(re=Il())===a&&(re=RT())===a&&(re=DT()),re!==a&&(vi=j,re=zk(re)),(j=re)===a&&(j=K,(re=S0())!==a&&(vi=j,re=Vk(re)),j=re),j}function _i(){var j,re;for($e++,j=[],D.test(r.charAt(K))?(re=r.charAt(K),K++):(re=a,$e===0&&je(le));re!==a;)j.push(re),D.test(r.charAt(K))?(re=r.charAt(K),K++):(re=a,$e===0&&je(le));return $e--,re=a,$e===0&&je(se),j}function Tl(){var j,re,ce;return $e++,j=K,(re=Md())!==a?(r.charCodeAt(K)===40?(ce=g,K++):(ce=a,$e===0&&je(we)),ce!==a?(vi=j,j=jk(re)):(K=j,j=a)):(K=j,j=a),$e--,j===a&&(re=a,$e===0&&je(de)),j}function Md(){var j,re,ce;if($e++,j=K,re=[],F.test(r.charAt(K))?(ce=r.charAt(K),K++):(ce=a,$e===0&&je(ze)),ce!==a)for(;ce!==a;)re.push(ce),F.test(r.charAt(K))?(ce=r.charAt(K),K++):(ce=a,$e===0&&je(ze));else re=a;return re!==a&&(vi=j,re=Bk()),$e--,(j=re)===a&&(re=a,$e===0&&je(Re)),j}function Ia(){var j,re,ce;return $e++,j=K,_i(),(re=Zi())!==a?(r.charCodeAt(K)===37?(ce=y,K++):(ce=a,$e===0&&je(Ae)),ce!==a?(vi=j,j=Uk(re)):(K=j,j=a)):(K=j,j=a),$e--,j===a&&$e===0&&je(Ct),j}function Il(){var j,re,ce;return $e++,j=K,_i(),(re=Zi())!==a?(r.substr(K,2)===_?(ce=_,K+=2):(ce=a,$e===0&&je(jt)),ce!==a?(vi=j,j=v0(re)):(K=j,j=a)):(K=j,j=a),j===a&&(j=K,_i(),(re=Zi())!==a?(r.substr(K,2)===b?(ce=b,K+=2):(ce=a,$e===0&&je(gn)),ce!==a?(vi=j,j=Gk(re)):(K=j,j=a)):(K=j,j=a),j===a&&(j=K,_i(),(re=Zi())!==a?(r.substr(K,2)===w?(ce=w,K+=2):(ce=a,$e===0&&je(_t)),ce!==a?(vi=j,j=Hk(re)):(K=j,j=a)):(K=j,j=a),j===a&&(j=K,_i(),(re=Zi())!==a?(r.substr(K,2)===x?(ce=x,K+=2):(ce=a,$e===0&&je(zs)),ce!==a?(vi=j,j=PT(re)):(K=j,j=a)):(K=j,j=a),j===a&&(j=K,_i(),(re=Zi())!==a?(r.substr(K,2)===S?(ce=S,K+=2):(ce=a,$e===0&&je(Gr)),ce!==a?(vi=j,j=kT(re)):(K=j,j=a)):(K=j,j=a),j===a&&(j=K,_i(),(re=Zi())!==a?(r.substr(K,2)===T?(ce=T,K+=2):(ce=a,$e===0&&je(fi)),ce!==a?(vi=j,j=c1(re)):(K=j,j=a)):(K=j,j=a)))))),$e--,j===a&&$e===0&&je(ke),j}function RT(){var j,re,ce;return $e++,j=K,(re=Zi())!==a?(r.substr(K,3)===I?(ce=I,K+=3):(ce=a,$e===0&&je(xl)),ce!==a?(vi=j,j=qk(re)):(K=j,j=a)):(K=j,j=a),j===a&&(j=K,(re=Zi())!==a?(r.substr(K,3)===C?(ce=C,K+=3):(ce=a,$e===0&&je(Sl)),ce!==a?(vi=j,j=Wk(re)):(K=j,j=a)):(K=j,j=a),j===a&&(j=K,(re=Zi())!==a?(r.substr(K,4)===M?(ce=M,K+=4):(ce=a,$e===0&&je(Wi)),ce!==a?(vi=j,j=Jk(re)):(K=j,j=a)):(K=j,j=a),j===a&&(j=K,(re=Zi())!==a?(r.substr(K,4)===E?(ce=E,K+=4):(ce=a,$e===0&&je(Ji)),ce!==a?(vi=j,j=OT(re)):(K=j,j=a)):(K=j,j=a)))),$e--,j===a&&(re=a,$e===0&&je(Fn)),j}function DT(){var j,re;return $e++,j=K,_i(),(re=Zi())!==a?(vi=j,j=Zk(re)):(K=j,j=a),$e--,j===a&&$e===0&&je(lo),j}function S0(){var j,re,ce,Qe;if($e++,j=K,r.charCodeAt(K)===35?(re=A,K++):(re=a,$e===0&&je(Ze)),re!==a){if(ce=[],z.test(r.charAt(K))?(Qe=r.charAt(K),K++):(Qe=a,$e===0&&je(Mt)),Qe!==a)for(;Qe!==a;)ce.push(Qe),z.test(r.charAt(K))?(Qe=r.charAt(K),K++):(Qe=a,$e===0&&je(Mt));else ce=a;ce!==a?(vi=j,j=Yk()):(K=j,j=a)}else K=j,j=a;return j===a&&(j=K,(re=Cd())!==a&&(vi=j,re=Xk(re)),(j=re)===a&&(j=K,(re=Md())!==a&&(vi=j,re=_0()),j=re)),$e--,j===a&&(re=a,$e===0&&je(Ie)),j}function Zi(){var j,re,ce,Qe,oi,Yt,Vs;for(j=K,U.test(r.charAt(K))?(r.charAt(K),K++):$e===0&&je(Ni),re=K,ce=[],G.test(r.charAt(K))?(Qe=r.charAt(K),K++):(Qe=a,$e===0&&je(si));Qe!==a;)ce.push(Qe),G.test(r.charAt(K))?(Qe=r.charAt(K),K++):(Qe=a,$e===0&&je(si));if(r.charCodeAt(K)===46?(Qe=$,K++):(Qe=a,$e===0&&je(or)),Qe!==a){if(oi=[],G.test(r.charAt(K))?(Yt=r.charAt(K),K++):(Yt=a,$e===0&&je(si)),Yt!==a)for(;Yt!==a;)oi.push(Yt),G.test(r.charAt(K))?(Yt=r.charAt(K),K++):(Yt=a,$e===0&&je(si));else oi=a;oi!==a?re=ce=[ce,Qe,oi]:(K=re,re=a)}else K=re,re=a;if(re===a)if(re=[],G.test(r.charAt(K))?(ce=r.charAt(K),K++):(ce=a,$e===0&&je(si)),ce!==a)for(;ce!==a;)re.push(ce),G.test(r.charAt(K))?(ce=r.charAt(K),K++):(ce=a,$e===0&&je(si));else re=a;if(re!==a){if(ce=K,r.charCodeAt(K)===101?(Qe=L,K++):(Qe=a,$e===0&&je(yn)),Qe!==a){if(U.test(r.charAt(K))?(oi=r.charAt(K),K++):(oi=a,$e===0&&je(Ni)),oi===a&&(oi=null),Yt=[],G.test(r.charAt(K))?(Vs=r.charAt(K),K++):(Vs=a,$e===0&&je(si)),Vs!==a)for(;Vs!==a;)Yt.push(Vs),G.test(r.charAt(K))?(Vs=r.charAt(K),K++):(Vs=a,$e===0&&je(si));else Yt=a;Yt!==a?ce=Qe=[Qe,oi,Yt]:(K=ce,ce=a)}else K=ce,ce=a;ce===a&&(ce=null),vi=j,j=Kk()}else K=j,j=a;return j}function T0(j,re){return j.map(function(ce){return ce[re]})}function u1(j,re,ce){return[j].concat(T0(re,ce))}if((o=u())!==a&&K===r.length)return o;throw o!==a&&K<r.length&&je(LT()),w0(b0,Ta<r.length?r.charAt(Ta):null,Ta<r.length?Id(Ta,Ta+1):Id(Ta,Ta))}return t(e,Error),e.prototype.format=function(r){var s="Error: "+this.message;if(this.location){var o,a=null;for(o=0;o<r.length;o++)if(r[o].source===this.location.source){a=r[o].text.split(/\r\n|\n|\r/g);break}var l=this.location.start,c=this.location.source&&typeof this.location.source.offset=="function"?this.location.source.offset(l):l,u=this.location.source+":"+c.line+":"+c.column;if(a){var d=this.location.end,f=i("",c.line.toString().length," "),m=a[l.line-1],g=(l.line===d.line?d.column:m.length+1)-l.column||1;s+=`
 --> `+u+`
`+f+` |
`+c.line+" | "+m+`
`+f+" | "+i("",l.column-1," ")+i("",g,"^")}else s+=`
 at `+u}return s},e.buildMessage=function(r,s){var o={literal:function(m){return'"'+l(m.text)+'"'},class:function(m){var g=m.parts.map(function(y){return Array.isArray(y)?c(y[0])+"-"+c(y[1]):c(y)});return"["+(m.inverted?"^":"")+g.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(m){return m.description}};function a(m){return m.charCodeAt(0).toString(16).toUpperCase()}function l(m){return m.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(g){return"\\x0"+a(g)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(g){return"\\x"+a(g)})}function c(m){return m.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(g){return"\\x0"+a(g)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(g){return"\\x"+a(g)})}function u(m){return o[m.type](m)}function d(m){var g,y,_=m.map(u);if(_.sort(),_.length>0){for(g=1,y=1;g<_.length;g++)_[g-1]!==_[g]&&(_[y]=_[g],y++);_.length=y}switch(_.length){case 1:return _[0];case 2:return _[0]+" or "+_[1];default:return _.slice(0,-1).join(", ")+", or "+_[_.length-1]}}function f(m){return m?'"'+l(m)+'"':"end of input"}return"Expected "+d(r)+" but "+f(s)+" found."},{SyntaxError:e,parse:n}},(zG=bN).exports&&(zG.exports=VG());var aRe=bN.exports;function nj(t){if(!t||t.length===0)return null;if(typeof t=="string"){const i=jG(t);return i&&i.length!==0?i:null}const e=t.map(i=>{if(!Number.isFinite(i.scale)||i.scale<=0)throw new V("effect:invalid-scale","scale must be finite and greater than 0",{stop:i});return{scale:i.scale,effects:jG(i.value)}});e.sort((i,n)=>n.effects.length-i.effects.length);for(let i=0;i<e.length-1;i++){if(!wae(e[i].effects,e[i+1].effects))throw new V("effect:interpolation-impossible","Cannot interpolate by scale between 2 lists of mixed effects",{a:e[i].effects,b:e[i+1].effects});xae(e[i].effects,e[i+1].effects)}return e.sort((i,n)=>n.scale-i.scale),e}function jG(t){let e;if(!t)return[];try{e=aRe.parse(t)}catch(i){throw new V("effect:invalid-syntax","Invalid effect syntax",{value:t,error:i})}return e.map(i=>lRe(i))}function lRe(t){try{switch(t.name){case"grayscale":case"sepia":case"saturate":case"invert":case"brightness":case"contrast":return cRe(t);case"opacity":return uRe(t);case"hue-rotate":return hRe(t);case"blur":return dRe(t);case"drop-shadow":return pRe(t);case"bloom":return fRe(t)}}catch(e){throw e.details.filter=t,e}throw new V("effect:unknown-effect",`Effect '${t.name}' is not supported`,{effect:t})}function cRe(t){let e=1;return Qb(t.parameters,1),t.parameters.length===1&&(e=oc(t.parameters[0])),new _N(t.name,e)}function uRe(t){let e=1;return Qb(t.parameters,1),t.parameters.length===1&&(e=oc(t.parameters[0])),new _ae(e)}function hRe(t){let e=0;return Qb(t.parameters,1),t.parameters.length===1&&(e=bRe(t.parameters[0])),new yae(e)}function dRe(t){let e=0;return Qb(t.parameters,1),t.parameters.length===1&&(e=oj(t.parameters[0]),aT(e,t.parameters[0])),new dae(e)}function pRe(t){const e=[];let i=null;for(const n of t.parameters)if(n.type==="color"){if(e.length&&Object.freeze(e),i)throw new V("effect:type-error","Accepts only one color",{});i=wRe(n)}else{const r=oj(n);if(Object.isFrozen(e))throw new V("effect:type-error","<length> parameters not consecutive",{lengths:e});e.push(r),e.length===3&&aT(r,n)}if(e.length<2||e.length>3)throw new V("effect:type-error",`Expected <length>{2,3}, Actual: <length>{${e.length}}`,{lengths:e});return new mae(e[0],e[1],e[2]||0,i||Sae("black"))}function fRe(t){let e=1,i=0,n=0;return Qb(t.parameters,3),t.parameters[0]&&(e=oc(t.parameters[0])),t.parameters[1]&&(i=oj(t.parameters[1]),aT(i,t.parameters[1])),t.parameters[2]&&(n=oc(t.parameters[2])),new uae(e,i,n)}function Qb(t,e){if(t.length>e)throw new V("effect:type-error",`Function supports up to ${e} parameters, Actual: ${t.length}`,{parameters:t})}function YP(t){if(t.type==="color")return"<color>";if(t.unit){if(t.unit in sj)return"<length>";if(t.unit in rj)return"<angle>";if(t.unit==="%")return"<percentage>"}return"<double>"}function aT(t,e){if(t<0)throw new V("effect:type-error",`Negative values are not allowed, Actual: ${t}`,{term:e})}function mRe(t){if(t.type!=="quantity"||t.unit!==null)throw new V("effect:type-error",`Expected <double>, Actual: ${YP(t)}`,{term:t})}function gRe(t){if(t.type!=="quantity"||t.unit!==null&&t.unit!=="%")throw new V("effect:type-error",`Expected <double> or <percentage>, Actual: ${YP(t)}`,{term:t})}const rj={deg:1,grad:.9,rad:180/Math.PI,turn:360};function yRe(t){if(t.type!=="quantity"||!(t.value===0&&t.unit===null||t.unit&&rj[t.unit]!=null))throw new V("effect:type-error",`Expected <angle>, Actual: ${YP(t)}`,{term:t})}const sj={px:1,cm:96/2.54,mm:96/2.54/10,in:96,pc:16,pt:96/72};function vRe(t){if(t.type!=="quantity"||!(t.value===0&&t.unit===null||t.unit&&sj[t.unit]!=null))throw new V("effect:type-error",`Expected <length>, Actual: ${YP(t)}`,{term:t})}function oc(t){gRe(t);const e=t.value;return aT(e,t),t.unit==="%"?.01*e:e}function _Re(t){return mRe(t),aT(t.value,t),t.value}function bRe(t){return yRe(t),t.value*rj[t.unit]||0}function oj(t){return vRe(t),t.value*sj[t.unit]||0}function wRe(t){switch(t.colorType){case"hex":return Tbe(t.value);case"named":return Sae(t.value);case"function":return TRe(t.value)}}function Sae(t){if(!qQ(t))throw new V("effect:unknown-color",`color '${t}' isn't valid`,{namedColor:t});return Sbe(t)}const xRe=/^rgba?/i,SRe=/^hsla?/i;function TRe(t){if(Qb(t.parameters,4),xRe.test(t.name))return[oc(t.parameters[0]),oc(t.parameters[1]),oc(t.parameters[2]),t.parameters[3]?oc(t.parameters[3]):1];if(SRe.test(t.name))return WQ(_Re(t.parameters[0]),oc(t.parameters[1]),oc(t.parameters[2]),t.parameters[3]?oc(t.parameters[3]):1);throw new V("effect:syntax-error",`Invalid color function '${t.name}'`,{colorFunction:t})}function aj(t,e,i){var n;try{return CRe(t)}catch(r){(n=i==null?void 0:i.messages)==null||n.push(r)}return null}function lj(t,e,i,n){try{const r=IRe(t);dl(i,r,e)}catch(r){n.messages&&n.messages.push(r)}}function IRe(t){const e=nj(t);return e?oRe(e)?e.map(i=>i.toJSON()):e.map(({scale:i,effects:n})=>({scale:i,value:n.map(r=>r.toJSON())})):null}function CRe(t){if(!t||t.length===0)return null;if(MRe(t)){const e=[];for(const i of t)e.push({scale:i.scale,value:NA(i.value)});return e}return NA(t)}function MRe(t){const e=t[0];return!!e&&"scale"in e}function NA(t){if(!t||!t.length)return"";const e=[];for(const i of t){let n=[];switch(i.type){case"grayscale":case"sepia":case"saturate":case"invert":case"brightness":case"contrast":case"opacity":n=[Wu(i,"amount")];break;case"blur":n=[Wu(i,"radius","pt")];break;case"hue-rotate":n=[Wu(i,"angle","deg")];break;case"drop-shadow":n=[Wu(i,"xoffset","pt"),Wu(i,"yoffset","pt"),Wu(i,"blurRadius","pt"),ERe(i,"color")];break;case"bloom":n=[Wu(i,"strength"),Wu(i,"radius","pt"),Wu(i,"threshold")]}const r=`${i.type}(${n.filter(Boolean).join(" ")})`;nj(r),e.push(r)}return e.join(" ")}function Wu(t,e,i){if(t[e]==null)throw new V("effect:missing-parameter",`Missing parameter '${e}' in ${t.type} effect`,{effect:t});return i?t[e]+i:""+t[e]}function ERe(t,e){if(t[e]==null)throw new V("effect:missing-parameter",`Missing parameter '${e}' in ${t.type} effect`,{effect:t});const i=t[e];return`rgba(${i[0]||0}, ${i[1]||0}, ${i[2]||0}, ${i[3]/255||0})`}const BG={read:{reader:aj},write:{allowNull:!0,writer:lj}},cj=t=>{let e=class extends t{constructor(){super(...arguments),this.blendMode="normal",this.effect=null}};return h([p({type:["average","color-burn","color-dodge","color","darken","destination-atop","destination-in","destination-out","destination-over","difference","exclusion","hard-light","hue","invert","lighten","lighter","luminosity","minus","multiply","normal","overlay","plus","reflect","saturation","screen","soft-light","source-atop","source-in","source-out","vivid-light","xor"],nonNullable:!0,json:{read:!1,write:!1,origins:{"web-map":{read:!0,write:!0},"portal-item":{read:!0,write:!0}}}})],e.prototype,"blendMode",void 0),h([p({json:{read:!1,write:!1,origins:{"web-map":BG,"portal-item":BG}}})],e.prototype,"effect",void 0),e=h([P("esri.layers.mixins.BlendLayer")],e),e},Tae=t=>{let e=class extends t{constructor(){super(...arguments),this.customParameters=null}};return h([p({type:Object,json:{write:{overridePolicy:i=>({enabled:!!(i&&Object.keys(i).length>0)})}}})],e.prototype,"customParameters",void 0),e=h([P("esri.layers.mixins.CustomParametersMixin")],e),e};var wN;let kv=wN=class extends ie{constructor(t){super(t),this.type="map-layer"}clone(){const{mapLayerId:t,gdbVersion:e}=this;return new wN({mapLayerId:t,gdbVersion:e})}};h([be({mapLayer:"map-layer"})],kv.prototype,"type",void 0),h([p({type:It,json:{write:!0}})],kv.prototype,"mapLayerId",void 0),h([p({type:String,json:{write:!0}})],kv.prototype,"gdbVersion",void 0),kv=wN=h([P("esri.layers.support.source.MapLayerSource")],kv);var xN;let fh=xN=class extends ie{constructor(t){super(t),this.type="query-table"}clone(){const{workspaceId:t,query:e,oidFields:i,spatialReference:n,geometryType:r}=this,s={workspaceId:t,query:e,oidFields:i,spatialReference:(n==null?void 0:n.clone())??void 0,geometryType:r};return new xN(s)}};h([be({queryTable:"query-table"})],fh.prototype,"type",void 0),h([p({type:String,json:{write:!0}})],fh.prototype,"workspaceId",void 0),h([p({type:String,json:{write:!0}})],fh.prototype,"query",void 0),h([p({type:String,json:{write:!0}})],fh.prototype,"oidFields",void 0),h([p({type:Ee,json:{write:!0}})],fh.prototype,"spatialReference",void 0),h([be(O6)],fh.prototype,"geometryType",void 0),fh=xN=h([P("esri.layers.support.source.QueryTableDataSource")],fh);var SN;let Ov=SN=class extends ie{constructor(t){super(t),this.type="raster"}clone(){const{workspaceId:t,dataSourceName:e}=this;return new SN({workspaceId:t,dataSourceName:e})}};h([be({raster:"raster"})],Ov.prototype,"type",void 0),h([p({type:String,json:{write:!0}})],Ov.prototype,"dataSourceName",void 0),h([p({type:String,json:{write:!0}})],Ov.prototype,"workspaceId",void 0),Ov=SN=h([P("esri.layers.support.source.RasterDataSource")],Ov);var TN;let lg=TN=class extends ie{constructor(t){super(t),this.type="table"}clone(){const{workspaceId:t,gdbVersion:e,dataSourceName:i}=this;return new TN({workspaceId:t,gdbVersion:e,dataSourceName:i})}};h([be({table:"table"})],lg.prototype,"type",void 0),h([p({type:String,json:{write:!0}})],lg.prototype,"workspaceId",void 0),h([p({type:String,json:{write:!0}})],lg.prototype,"gdbVersion",void 0),h([p({type:String,json:{write:!0}})],lg.prototype,"dataSourceName",void 0),lg=TN=h([P("esri.layers.support.source.TableDataSource")],lg);var IN,CN;const ARe=Nn()({esriLeftInnerJoin:"left-inner-join",esriLeftOuterJoin:"left-outer-join"});let Xo=IN=class extends ie{constructor(t){super(t),this.type="join-table"}readLeftTableSource(t,e,i){return UG()(t,e,i)}castLeftTableSource(t){return nd(MN(),t)}readRightTableSource(t,e,i){return UG()(t,e,i)}castRightTableSource(t){return nd(MN(),t)}clone(){const{leftTableKey:t,rightTableKey:e,leftTableSource:i,rightTableSource:n,joinType:r}=this,s={leftTableKey:t,rightTableKey:e,leftTableSource:(i==null?void 0:i.clone())??void 0,rightTableSource:(n==null?void 0:n.clone())??void 0,joinType:r};return new IN(s)}};h([be({joinTable:"join-table"})],Xo.prototype,"type",void 0),h([p({type:String,json:{write:!0}})],Xo.prototype,"leftTableKey",void 0),h([p({type:String,json:{write:!0}})],Xo.prototype,"rightTableKey",void 0),h([p({json:{write:!0}})],Xo.prototype,"leftTableSource",void 0),h([_e("leftTableSource")],Xo.prototype,"readLeftTableSource",null),h([ut("leftTableSource")],Xo.prototype,"castLeftTableSource",null),h([p({json:{write:!0}})],Xo.prototype,"rightTableSource",void 0),h([_e("rightTableSource")],Xo.prototype,"readRightTableSource",null),h([ut("rightTableSource")],Xo.prototype,"castRightTableSource",null),h([be(ARe)],Xo.prototype,"joinType",void 0),Xo=IN=h([P("esri.layers.support.source.JoinTableDataSource")],Xo);let aO=null;function UG(){return aO||(aO=Ob({types:MN()})),aO}let lO=null;function MN(){return lO||(lO={key:"type",base:null,typeMap:{"data-layer":hu,"map-layer":kv}}),lO}const $Re={key:"type",base:null,typeMap:{"join-table":Xo,"query-table":fh,raster:Ov,table:lg}};let hu=CN=class extends ie{constructor(t){super(t),this.type="data-layer"}clone(){const{fields:t,dataSource:e}=this;return new CN({fields:t,dataSource:e})}};h([be({dataLayer:"data-layer"})],hu.prototype,"type",void 0),h([p({type:[dc],json:{write:!0}})],hu.prototype,"fields",void 0),h([p({types:$Re,json:{write:!0}})],hu.prototype,"dataSource",void 0),hu=CN=h([P("esri.layers.support.source.DataLayerSource")],hu),hu.from=fn(hu);let cg=class extends An(ie){constructor(e){super(e),this.onFields=null,this.operator=null,this.searchTerm=null,this.searchType=null}};h([p({type:[String],json:{write:{enabled:!0,overridePolicy(){return{enabled:this.onFields!=null&&this.onFields.length>0}}}}})],cg.prototype,"onFields",void 0),h([p({type:String,json:{write:!0}})],cg.prototype,"operator",void 0),h([p({type:String,json:{write:!0}})],cg.prototype,"searchTerm",void 0),h([p({type:String,json:{write:!0}})],cg.prototype,"searchType",void 0),cg=h([P("esri.rest.support.FullTextSearch")],cg);const Iae=cg;var EN;const GG=new qe({count:"count",sum:"sum",min:"min",max:"max",avg:"avg",stddev:"stddev",var:"var",exceedslimit:"exceedslimit",percentile_cont:"percentile-continuous",percentile_disc:"percentile-discrete",EnvelopeAggregate:"envelope-aggregate",CentroidAggregate:"centroid-aggregate",ConvexHullAggregate:"convex-hull-aggregate"});let Jl=EN=class extends ie{constructor(t){super(t),this.maxPointCount=void 0,this.maxRecordCount=void 0,this.maxVertexCount=void 0,this.onStatisticField=null,this.outStatisticFieldName=null,this.statisticType=null,this.statisticParameters=null}writeStatisticParameters(t,e){this.statisticType!=="percentile-continuous"&&this.statisticType!=="percentile-discrete"||(e.statisticParameters=q(t))}clone(){return new EN({maxPointCount:this.maxPointCount,maxRecordCount:this.maxRecordCount,maxVertexCount:this.maxVertexCount,onStatisticField:this.onStatisticField,outStatisticFieldName:this.outStatisticFieldName,statisticType:this.statisticType,statisticParameters:q(this.statisticParameters)})}};h([p({type:Number,json:{write:!0}})],Jl.prototype,"maxPointCount",void 0),h([p({type:Number,json:{write:!0}})],Jl.prototype,"maxRecordCount",void 0),h([p({type:Number,json:{write:!0}})],Jl.prototype,"maxVertexCount",void 0),h([p({type:String,json:{write:!0}})],Jl.prototype,"onStatisticField",void 0),h([p({type:String,json:{write:!0}})],Jl.prototype,"outStatisticFieldName",void 0),h([p({type:String,json:{read:{source:"statisticType",reader:GG.read},write:{target:"statisticType",writer:GG.write}}})],Jl.prototype,"statisticType",void 0),h([p({type:Object})],Jl.prototype,"statisticParameters",void 0),h([ge("statisticParameters")],Jl.prototype,"writeStatisticParameters",null),Jl=EN=h([P("esri.rest.support.StatisticDefinition")],Jl);const PRe=Jl;var D_;const kRe=new qe({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"}),ORe=new qe({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});let Fe=D_=class extends ie{static from(t){return t0(D_,t)}constructor(t){super(t),this.aggregateIds=null,this.cacheHint=void 0,this.compactGeometryEnabled=!1,this.datumTransformation=null,this.defaultSpatialReferenceEnabled=!1,this.distance=void 0,this.dynamicDataSource=void 0,this.formatOf3DObjects=null,this.fullText=null,this.gdbVersion=null,this.geometry=null,this.geometryPrecision=void 0,this.groupByFieldsForStatistics=null,this.having=null,this.historicMoment=null,this.maxAllowableOffset=void 0,this.maxRecordCountFactor=1,this.multipatchOption=null,this.num=void 0,this.objectIds=null,this.orderByFields=null,this.outFields=null,this.outSpatialReference=null,this.outStatistics=null,this.parameterValues=null,this.pixelSize=null,this.quantizationParameters=null,this.rangeValues=null,this.relationParameter=null,this.resultType=null,this.returnCentroid=!1,this.returnDistinctValues=!1,this.returnExceededLimitFeatures=!0,this.returnGeometry=!1,this.returnQueryGeometry=!1,this.returnM=void 0,this.returnZ=void 0,this.sourceSpatialReference=null,this.spatialRelationship="intersects",this.start=void 0,this.sqlFormat=null,this.text=null,this.timeExtent=null,this.timeReferenceUnknownClient=!1,this.units=null,this.where=null}castDatumTransformation(t){return typeof t=="number"||typeof t=="object"?t:null}writeHistoricMoment(t,e){e.historicMoment=t&&t.getTime()}writeParameterValues(t,e){if(t){const i={};for(const n in t){const r=t[n];Array.isArray(r)?i[n]=r.map(s=>s instanceof Date?s.getTime():s):r instanceof Date?i[n]=r.getTime():i[n]=r}e.parameterValues=i}}writeStart(t,e){e.resultOffset=this.start,e.resultRecordCount=this.num||10,e.where="1=1"}writeWhere(t,e){e.where=t||"1=1"}clone(){return new D_(q({aggregateIds:this.aggregateIds,cacheHint:this.cacheHint,compactGeometryEnabled:this.compactGeometryEnabled,datumTransformation:this.datumTransformation,defaultSpatialReferenceEnabled:this.defaultSpatialReferenceEnabled,distance:this.distance,fullText:this.fullText,formatOf3DObjects:this.formatOf3DObjects,gdbVersion:this.gdbVersion,geometry:this.geometry,geometryPrecision:this.geometryPrecision,groupByFieldsForStatistics:this.groupByFieldsForStatistics,having:this.having,historicMoment:this.historicMoment!=null?new Date(this.historicMoment.getTime()):null,maxAllowableOffset:this.maxAllowableOffset,maxRecordCountFactor:this.maxRecordCountFactor,multipatchOption:this.multipatchOption,num:this.num,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,outStatistics:this.outStatistics,parameterValues:this.parameterValues,pixelSize:this.pixelSize,quantizationParameters:this.quantizationParameters,rangeValues:this.rangeValues,relationParameter:this.relationParameter,resultType:this.resultType,returnDistinctValues:this.returnDistinctValues,returnGeometry:this.returnGeometry,returnCentroid:this.returnCentroid,returnExceededLimitFeatures:this.returnExceededLimitFeatures,returnQueryGeometry:this.returnQueryGeometry,returnM:this.returnM,returnZ:this.returnZ,dynamicDataSource:this.dynamicDataSource,sourceSpatialReference:this.sourceSpatialReference,spatialRelationship:this.spatialRelationship,start:this.start,sqlFormat:this.sqlFormat,text:this.text,timeExtent:this.timeExtent,timeReferenceUnknownClient:this.timeReferenceUnknownClient,units:this.units,where:this.where}))}};Fe.MAX_MAX_RECORD_COUNT_FACTOR=5,h([p({json:{write:!0}})],Fe.prototype,"aggregateIds",void 0),h([p({type:Boolean,json:{write:!0}})],Fe.prototype,"cacheHint",void 0),h([p({type:Boolean,json:{default:!1,write:!0}})],Fe.prototype,"compactGeometryEnabled",void 0),h([p({json:{write:!0}})],Fe.prototype,"datumTransformation",void 0),h([ut("datumTransformation")],Fe.prototype,"castDatumTransformation",null),h([p({type:Boolean,json:{default:!1,write:!0}})],Fe.prototype,"defaultSpatialReferenceEnabled",void 0),h([p({type:Number,json:{write:{overridePolicy:t=>({enabled:t>0})}}})],Fe.prototype,"distance",void 0),h([p({type:hu,json:{write:!0}})],Fe.prototype,"dynamicDataSource",void 0),h([p({type:String,json:{write:!0}})],Fe.prototype,"formatOf3DObjects",void 0),h([p({type:[Iae],json:{write:{enabled:!0,overridePolicy(){return{enabled:this.fullText!=null&&this.fullText.length>0}}}}})],Fe.prototype,"fullText",void 0),h([p({type:String,json:{write:!0}})],Fe.prototype,"gdbVersion",void 0),h([p({types:r0,json:{read:ad,write:!0}})],Fe.prototype,"geometry",void 0),h([p({type:Number,json:{write:!0}})],Fe.prototype,"geometryPrecision",void 0),h([p({type:[String],json:{write:!0}})],Fe.prototype,"groupByFieldsForStatistics",void 0),h([p({type:String,json:{write:!0}})],Fe.prototype,"having",void 0),h([p({type:Date})],Fe.prototype,"historicMoment",void 0),h([ge("historicMoment")],Fe.prototype,"writeHistoricMoment",null),h([p({type:Number,json:{write:!0}})],Fe.prototype,"maxAllowableOffset",void 0),h([p({type:Number,cast:t=>t<1?1:t>D_.MAX_MAX_RECORD_COUNT_FACTOR?D_.MAX_MAX_RECORD_COUNT_FACTOR:t,json:{write:{overridePolicy:t=>({enabled:t>1})}}})],Fe.prototype,"maxRecordCountFactor",void 0),h([p({type:["xyFootprint"],json:{write:!0}})],Fe.prototype,"multipatchOption",void 0),h([p({type:Number,json:{read:{source:"resultRecordCount"}}})],Fe.prototype,"num",void 0),h([p({json:{write:!0}})],Fe.prototype,"objectIds",void 0),h([p({type:[String],json:{write:!0}})],Fe.prototype,"orderByFields",void 0),h([p({type:[String],json:{write:!0}})],Fe.prototype,"outFields",void 0),h([p({type:Ee,json:{name:"outSR",write:!0}})],Fe.prototype,"outSpatialReference",void 0),h([p({type:[PRe],json:{write:{enabled:!0,overridePolicy(){return{enabled:this.outStatistics!=null&&this.outStatistics.length>0}}}}})],Fe.prototype,"outStatistics",void 0),h([p({json:{write:!0}})],Fe.prototype,"parameterValues",void 0),h([ge("parameterValues")],Fe.prototype,"writeParameterValues",null),h([p({type:pe,json:{write:!0}})],Fe.prototype,"pixelSize",void 0),h([p({type:_se,json:{write:!0}})],Fe.prototype,"quantizationParameters",void 0),h([p({type:[Object],json:{write:!0}})],Fe.prototype,"rangeValues",void 0),h([p({type:String,json:{read:{source:"relationParam"},write:{target:"relationParam",overridePolicy(){return{enabled:this.spatialRelationship==="relation"}}}}})],Fe.prototype,"relationParameter",void 0),h([p({type:String,json:{write:!0}})],Fe.prototype,"resultType",void 0),h([p({type:Boolean,json:{default:!1,write:!0}})],Fe.prototype,"returnCentroid",void 0),h([p({type:Boolean,json:{default:!1,write:!0}})],Fe.prototype,"returnDistinctValues",void 0),h([p({type:Boolean,json:{default:!0,write:!0}})],Fe.prototype,"returnExceededLimitFeatures",void 0),h([p({type:Boolean,json:{write:!0}})],Fe.prototype,"returnGeometry",void 0),h([p({type:Boolean,json:{default:!1,write:!0}})],Fe.prototype,"returnQueryGeometry",void 0),h([p({type:Boolean,json:{default:!1,write:!0}})],Fe.prototype,"returnM",void 0),h([p({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],Fe.prototype,"returnZ",void 0),h([p({type:Ee,json:{write:!0}})],Fe.prototype,"sourceSpatialReference",void 0),h([be(kRe,{ignoreUnknown:!1,name:"spatialRel"})],Fe.prototype,"spatialRelationship",void 0),h([p({type:Number,json:{read:{source:"resultOffset"}}})],Fe.prototype,"start",void 0),h([ge("start"),ge("num")],Fe.prototype,"writeStart",null),h([p({type:String,json:{write:!0}})],Fe.prototype,"sqlFormat",void 0),h([p({type:String,json:{write:!0}})],Fe.prototype,"text",void 0),h([p({type:Bu,json:{write:!0}})],Fe.prototype,"timeExtent",void 0),h([p({type:Boolean,json:{default:!1,write:!0}})],Fe.prototype,"timeReferenceUnknownClient",void 0),h([be(ORe,{ignoreUnknown:!1}),p({json:{write:{overridePolicy(t){return{enabled:!!t&&this.distance!=null&&this.distance>0}}}}})],Fe.prototype,"units",void 0),h([p({type:String,json:{write:{overridePolicy(t){return{enabled:t!=null||this.start!=null&&this.start>0}}}}})],Fe.prototype,"where",void 0),h([ge("where")],Fe.prototype,"writeWhere",null),Fe=D_=h([P("esri.rest.support.Query")],Fe);const vu=Fe;var AN;const cO=new qe({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"}),uO=new qe({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});let eu=AN=class extends ie{constructor(t){super(t),this.where=null,this.geometry=null,this.spatialRelationship="intersects",this.distance=void 0,this.objectIds=null,this.units=null,this.timeExtent=null}createQuery(t={}){const{where:e,geometry:i,spatialRelationship:n,timeExtent:r,objectIds:s,units:o,distance:a}=this;return new vu({geometry:q(i),objectIds:q(s),spatialRelationship:n,timeExtent:q(r),where:e,units:o,distance:a,...t})}clone(){const{where:t,geometry:e,spatialRelationship:i,timeExtent:n,objectIds:r,units:s,distance:o}=this;return new AN({geometry:q(e),objectIds:q(r),spatialRelationship:i,timeExtent:q(n),where:t,units:s,distance:o})}};h([p({type:String,json:{write:!0}})],eu.prototype,"where",void 0),h([p({types:r0,json:{write:!0}})],eu.prototype,"geometry",void 0),h([p({type:cO.apiValues,json:{name:"spatialRel",read:{reader:cO.read},write:{allowNull:!1,writer:cO.write,overridePolicy(){return{enabled:this.geometry!=null}}}}})],eu.prototype,"spatialRelationship",void 0),h([p({type:Number,json:{write:{overridePolicy(t){return{enabled:t!=null&&this.geometry!=null}}}}})],eu.prototype,"distance",void 0),h([p({type:[Number],json:{write:!0}})],eu.prototype,"objectIds",void 0),h([p({type:uO.apiValues,json:{read:uO.read,write:{writer:uO.write,overridePolicy(t){return{enabled:t!=null&&this.geometry!=null}}}}})],eu.prototype,"units",void 0),h([p({type:Bu,json:{write:!0}})],eu.prototype,"timeExtent",void 0),eu=AN=h([P("esri.layers.support.FeatureFilter")],eu);const LRe=eu;var $N;const HG={read:{reader:aj},write:{writer:lj,overridePolicy(){return{allowNull:this.excludedEffect!=null,isRequired:this.excludedEffect==null}}}},qG={read:{reader:aj},write:{writer:lj,overridePolicy(){return{allowNull:this.includedEffect!=null,isRequired:this.includedEffect==null}}}},WG={name:"showExcludedLabels",default:!0};let ug=$N=class extends ie{constructor(t){super(t),this.filter=null,this.includedEffect=null,this.excludedEffect=null,this.excludedLabelsVisible=!1}write(t,e){var n,r;const i=super.write(t,e);if(e!=null&&e.origin){if(i.filter){const s=Object.keys(i.filter);if(s.length>1||s[0]!=="where")return(n=e.messages)==null||n.push(new V("web-document-write:unsupported-feature-effect","Invalid feature effect 'filter'. A filter can only contain a 'where' property",{layer:e.layer,effect:this})),null}if("showExcludedLabels"in i)return(r=e.messages)==null||r.push(new V("web-document-write:unsupported-feature-effect","Invalid value for property 'excludedLabelsVisible' which should always be 'true'",{layer:e.layer,effect:this})),null}return i}clone(){return new $N({filter:this.filter!=null?this.filter.clone():null,includedEffect:this.includedEffect,excludedEffect:this.excludedEffect,excludedLabelsVisible:this.excludedLabelsVisible})}};h([p({type:LRe,json:{write:{allowNull:!0,writer(t,e,i,n){const r=t==null?void 0:t.write({},n);r&&Object.keys(r).length!==0?dl(i,r,e):dl(i,null,e)}}}})],ug.prototype,"filter",void 0),h([p({json:{write:!0,origins:{"web-map":HG,"portal-item":HG}}})],ug.prototype,"includedEffect",void 0),h([p({json:{write:!0,origins:{"web-map":qG,"portal-item":qG}}})],ug.prototype,"excludedEffect",void 0),h([p({type:Boolean,json:{write:!0,name:"showExcludedLabels",origins:{"web-map":WG,"portal-item":WG}}})],ug.prototype,"excludedLabelsVisible",void 0),ug=$N=h([P("esri.layers.support.FeatureEffect")],ug);const RRe=ug,JG={write:{allowNull:!0}},DRe=t=>{let e=class extends t{constructor(){super(...arguments),this.featureEffect=null}};return h([p({type:RRe,json:{origins:{"web-map":JG,"portal-item":JG}}})],e.prototype,"featureEffect",void 0),e=h([P("esri.layers.mixins.FeatureEffectLayer")],e),e};let Lv=class extends An(ie){constructor(e){super(e),this.expression=null,this.title=null,this.returnType=null}};h([p({type:String,json:{write:!0}})],Lv.prototype,"expression",void 0),h([p({type:String,json:{write:!0}})],Lv.prototype,"title",void 0),h([p({type:String,json:{write:!0}})],Lv.prototype,"returnType",void 0),Lv=h([P("esri.layers.support.ExpressionInfo")],Lv);const uj=Lv;var PN;let mh=PN=class extends ie{constructor(t){super(t),this.isAutoGenerated=!1,this.name=null,this.alias=null,this.onStatisticField=null,this.onStatisticExpression=null,this.statisticType=null}clone(){return new PN({name:this.name,alias:this.alias,isAutoGenerated:this.isAutoGenerated,onStatisticExpression:q(this.onStatisticExpression),onStatisticField:this.onStatisticField,statisticType:this.statisticType})}};h([p({type:Boolean,json:{write:!0}})],mh.prototype,"isAutoGenerated",void 0),h([p({type:String,json:{write:!0}})],mh.prototype,"name",void 0),h([p({type:String,json:{write:!0}})],mh.prototype,"alias",void 0),h([p({type:String,json:{write:!0}})],mh.prototype,"onStatisticField",void 0),h([p({type:uj,json:{write:!0}})],mh.prototype,"onStatisticExpression",void 0),h([p({type:String,json:{write:!0}})],mh.prototype,"statisticType",void 0),mh=PN=h([P("esri.layers.support.AggregateField")],mh);const Gy=mh;let $f=class extends ie{constructor(){super(...arguments),this.type=null}};h([p({type:["selection","cluster","binning"],readOnly:!0,json:{read:!1,write:!0}})],$f.prototype,"type",void 0),$f=h([P("esri.layers.support.FeatureReduction")],$f);function NRe(t){if(!t)return t;const{start:e,end:i}=t;return new Bu({start:e!=null?vy(e,-e.getTimezoneOffset(),"minutes"):e,end:i!=null?vy(i,-i.getTimezoneOffset(),"minutes"):i})}function FRe(t){if(!t)return t;const{start:e,end:i}=t;return new Bu({start:e!=null?vy(e,e.getTimezoneOffset(),"minutes"):e,end:i!=null?vy(i,i.getTimezoneOffset(),"minutes"):i})}var kN;let Xw=kN=class extends ie{constructor(t){super(t)}async collectRequiredFields(t,e){return ro(t,e,this.expression)}clone(){return new kN({expression:this.expression,title:this.title})}equals(t){return this.expression===t.expression&&this.title===t.title}};h([p({type:String,json:{write:!0}})],Xw.prototype,"expression",void 0),h([p({type:String,json:{write:!0}})],Xw.prototype,"title",void 0),Xw=kN=h([P("esri.layers.support.FeatureExpressionInfo")],Xw);const ZG=Xw;function jdt(t){return!!t&&BP[t]!=null}function zRe(t){return 1/(BP[t]||1)}function VRe(){const t=Object.keys(BP);return t.sort(),t}const jRe=VRe();var ON;const EI=Nn()({onTheGround:"on-the-ground",relativeToGround:"relative-to-ground",relativeToScene:"relative-to-scene",absoluteHeight:"absolute-height"}),YG=new qe({foot:"feet",kilometer:"kilometers",meter:"meters",mile:"miles","us-foot":"us-feet",yard:"yards"});let gh=ON=class extends ie{constructor(t){super(t),this.offset=null}readFeatureExpressionInfo(t,e){return t??(e.featureExpression&&e.featureExpression.value===0?{expression:"0"}:void 0)}writeFeatureExpressionInfo(t,e,i,n){e[i]=t.write({},n),t.expression==="0"&&(e.featureExpression={value:0})}get mode(){const{offset:t,featureExpressionInfo:e}=this;return this._isOverridden("mode")?this._get("mode"):t!=null||e?"relative-to-ground":"on-the-ground"}set mode(t){this._override("mode",t)}set unit(t){this._set("unit",t)}write(t,e){return this.offset||this.mode||this.featureExpressionInfo||this.unit?super.write(t,e):null}clone(){return new ON({mode:this.mode,offset:this.offset,featureExpressionInfo:this.featureExpressionInfo?this.featureExpressionInfo.clone():void 0,unit:this.unit})}equals(t){return this.mode===t.mode&&this.offset===t.offset&&this.unit===t.unit&&qge(this.featureExpressionInfo,t.featureExpressionInfo)}};h([p({type:ZG,json:{write:!0}})],gh.prototype,"featureExpressionInfo",void 0),h([_e("featureExpressionInfo",["featureExpressionInfo","featureExpression"])],gh.prototype,"readFeatureExpressionInfo",null),h([ge("featureExpressionInfo",{featureExpressionInfo:{type:ZG},"featureExpression.value":{type:[0]}})],gh.prototype,"writeFeatureExpressionInfo",null),h([p({type:EI.apiValues,nonNullable:!0,json:{type:EI.jsonValues,read:EI.read,write:{writer:EI.write,isRequired:!0}}})],gh.prototype,"mode",null),h([p({type:Number,json:{write:!0}})],gh.prototype,"offset",void 0),h([p({type:jRe,json:{type:String,read:YG.read,write:YG.write}})],gh.prototype,"unit",null),gh=ON=h([P("esri.layers.support.ElevationInfo")],gh);const Cae=gh,BRe={type:Boolean,value:!0,json:{origins:{service:{read:!1,write:!1},"web-map":{read:!1,write:!1}},name:"screenSizePerspective",write:!0}},hj={type:Boolean,value:!0,json:{name:"disablePopup",read:{reader:(t,e)=>!e.disablePopup},write:{enabled:!0,writer(t,e,i){e[i]=!t}}}},dj={type:Boolean,value:!0,nonNullable:!0,json:{name:"showLabels",write:!0}},pj={type:String,json:{origins:{"portal-item":{write:!1}},write:{isRequired:!0,ignoreOrigin:!0,writer:Fy}}},Mae={type:Boolean,value:!0,nonNullable:!0,json:{origins:{service:{read:{enabled:!1}}},name:"showLegend",write:!0}},URe={value:null,type:Cae,json:{origins:{service:{name:"elevationInfo",write:!0}},name:"layerDefinition.elevationInfo",write:!0}};function Bdt(t){return{type:t,readOnly:!0,json:{origins:{service:{read:!0}},read:!1}}}const Eae={write:!0,read:!0},FA={type:Number,json:{origins:{"web-document":Eae,"portal-item":{write:!0}}}},Udt={...FA,json:{...FA.json,origins:{"web-document":{...Eae,write:{enabled:!0,target:{opacity:{type:Number},"layerDefinition.drawingInfo.transparency":{type:Number}}}}},read:{source:["layerDefinition.drawingInfo.transparency","drawingInfo.transparency"],reader:(t,e,i)=>i&&i.origin!=="service"||!e.drawingInfo||e.drawingInfo.transparency===void 0?e.layerDefinition&&e.layerDefinition.drawingInfo&&e.layerDefinition.drawingInfo.transparency!==void 0?k2(e.layerDefinition.drawingInfo.transparency):void 0:k2(e.drawingInfo.transparency)}}},GRe={type:Bu,readOnly:!0,get(){var a,l;if(!((a=this.layer)!=null&&a.timeInfo))return null;const{datesInUnknownTimezone:t,timeOffset:e,useViewTime:i}=this.layer,n=(l=this.view)==null?void 0:l.timeExtent;let r=this.layer.timeExtent;t&&(r=FRe(r));let s=i?n&&r?n.intersection(r):n||r:r;if(!s||s.isEmpty||s.isAllTime)return s;e&&(s=s.offset(-e.value,e.unit)),t&&(s=NRe(s));const o=this._get("timeExtent");return s.equals(o)?o:s}},Gdt={type:Le,readOnly:!0,json:{origins:{service:{read:{source:["fullExtent","spatialReference"],reader:(t,e)=>{const i=Le.fromJSON(t);return e.spatialReference!=null&&typeof e.spatialReference=="object"&&(i.spatialReference=Ee.fromJSON(e.spatialReference)),i}}}},read:!1}},HRe={type:String,json:{origins:{service:{read:!1},"portal-item":{read:!1}}}},Hdt={type:Number,json:{origins:{service:{write:{enabled:!1}}},read:{source:"layerDefinition.minScale"},write:{target:"layerDefinition.minScale"}}},qdt={type:Number,json:{origins:{service:{write:{enabled:!1}}},read:{source:"layerDefinition.maxScale"},write:{target:"layerDefinition.maxScale"}}},qRe={json:{write:{ignoreOrigin:!0},origins:{"web-map":{read:!1,write:!1}}}};async function WRe(t,e){const{WhereClause:i}=await Y(()=>import("./WhereClause-831210c9.js").then(n=>n.W),["./WhereClause-831210c9.js","./executionError-c92d3b85.js"],import.meta.url);return i.create(t,e)}function JRe(t,e){return t!=null?e!=null?`(${t}) AND (${e})`:t:e}var LN;let Er=LN=class extends ie{constructor(t){super(t),this.attachmentTypes=null,this.attachmentsWhere=null,this.cacheHint=void 0,this.keywords=null,this.globalIds=null,this.name=null,this.num=null,this.objectIds=null,this.returnMetadata=!1,this.size=null,this.start=null,this.where=null}writeStart(t,e){e.resultOffset=this.start,e.resultRecordCount=this.num||10}clone(){return new LN(q({attachmentTypes:this.attachmentTypes,attachmentsWhere:this.attachmentsWhere,cacheHint:this.cacheHint,keywords:this.keywords,where:this.where,globalIds:this.globalIds,name:this.name,num:this.num,objectIds:this.objectIds,returnMetadata:this.returnMetadata,size:this.size,start:this.start}))}};h([p({type:[String],json:{write:!0}})],Er.prototype,"attachmentTypes",void 0),h([p({type:String,json:{read:{source:"attachmentsDefinitionExpression"},write:{target:"attachmentsDefinitionExpression"}}})],Er.prototype,"attachmentsWhere",void 0),h([p({type:Boolean,json:{write:!0}})],Er.prototype,"cacheHint",void 0),h([p({type:[String],json:{write:!0}})],Er.prototype,"keywords",void 0),h([p({type:[Number],json:{write:!0}})],Er.prototype,"globalIds",void 0),h([p({json:{write:!0}})],Er.prototype,"name",void 0),h([p({type:Number,json:{read:{source:"resultRecordCount"}}})],Er.prototype,"num",void 0),h([p({type:[Number],json:{write:!0}})],Er.prototype,"objectIds",void 0),h([p({type:Boolean,json:{default:!1,write:!0}})],Er.prototype,"returnMetadata",void 0),h([p({type:[Number],json:{write:!0}})],Er.prototype,"size",void 0),h([p({type:Number,json:{read:{source:"resultOffset"}}})],Er.prototype,"start",void 0),h([ge("start"),ge("num")],Er.prototype,"writeStart",null),h([p({type:String,json:{read:{source:"definitionExpression"},write:{target:"definitionExpression"}}})],Er.prototype,"where",void 0),Er=LN=h([P("esri.rest.support.AttachmentQuery")],Er),Er.from=fn(Er);const Aae=Er;var RN;let Xi=RN=class extends ie{constructor(t){super(t),this.cacheHint=void 0,this.dynamicDataSource=void 0,this.gdbVersion=null,this.geometryPrecision=void 0,this.historicMoment=null,this.maxAllowableOffset=void 0,this.objectIds=null,this.orderByFields=null,this.outFields=null,this.outSpatialReference=null,this.relationshipId=void 0,this.start=void 0,this.num=void 0,this.returnGeometry=!1,this.returnM=void 0,this.returnZ=void 0,this.where=null}_writeHistoricMoment(t,e){e.historicMoment=t&&t.getTime()}writeStart(t,e){e.resultOffset=this.start,e.resultRecordCount=this.num||10,this.start>0&&this.where==null&&(e.definitionExpression="1=1")}clone(){return new RN(q({cacheHint:this.cacheHint,dynamicDataSource:this.dynamicDataSource,gdbVersion:this.gdbVersion,geometryPrecision:this.geometryPrecision,historicMoment:this.historicMoment&&new Date(this.historicMoment.getTime()),maxAllowableOffset:this.maxAllowableOffset,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,relationshipId:this.relationshipId,start:this.start,num:this.num,returnGeometry:this.returnGeometry,where:this.where,returnZ:this.returnZ,returnM:this.returnM}))}};h([p({type:Boolean,json:{write:!0}})],Xi.prototype,"cacheHint",void 0),h([p({type:hu,json:{write:!0}})],Xi.prototype,"dynamicDataSource",void 0),h([p({type:String,json:{write:!0}})],Xi.prototype,"gdbVersion",void 0),h([p({type:Number,json:{write:!0}})],Xi.prototype,"geometryPrecision",void 0),h([p({type:Date})],Xi.prototype,"historicMoment",void 0),h([ge("historicMoment")],Xi.prototype,"_writeHistoricMoment",null),h([p({type:Number,json:{write:!0}})],Xi.prototype,"maxAllowableOffset",void 0),h([p({type:[Number],json:{write:!0}})],Xi.prototype,"objectIds",void 0),h([p({type:[String],json:{write:!0}})],Xi.prototype,"orderByFields",void 0),h([p({type:[String],json:{write:!0}})],Xi.prototype,"outFields",void 0),h([p({type:Ee,json:{read:{source:"outSR"},write:{target:"outSR"}}})],Xi.prototype,"outSpatialReference",void 0),h([p({json:{write:!0}})],Xi.prototype,"relationshipId",void 0),h([p({type:Number,json:{read:{source:"resultOffset"}}})],Xi.prototype,"start",void 0),h([ge("start"),ge("num")],Xi.prototype,"writeStart",null),h([p({type:Number,json:{read:{source:"resultRecordCount"}}})],Xi.prototype,"num",void 0),h([p({json:{write:!0}})],Xi.prototype,"returnGeometry",void 0),h([p({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],Xi.prototype,"returnM",void 0),h([p({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],Xi.prototype,"returnZ",void 0),h([p({type:String,json:{read:{source:"definitionExpression"},write:{target:"definitionExpression"}}})],Xi.prototype,"where",void 0),Xi=RN=h([P("esri.rest.support.RelationshipQuery")],Xi),Xi.from=fn(Xi);const fj=Xi,Wdt=Object.freeze(Object.defineProperty({__proto__:null,default:fj},Symbol.toStringTag,{value:"Module"})),Jdt=new qe({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"});async function Zdt(t,e,i,n){const r=await tm(t);if(await mj(t,e,n),!r.addAttachment)throw new V(n,"Layer source does not support addAttachment capability");return r.addAttachment(e,i)}function mj(t,e,i){const{attributes:n}=e,{objectIdField:r}=t;return t.get("capabilities.data.supportsAttachment")?e?n?r&&n[r]?Promise.resolve():Promise.reject(new V(i,`feature is missing the identifying attribute ${r}`)):Promise.reject(new V(i,"'attributes' are required on a feature to query attachments")):Promise.reject(new V(i,"A feature is required to add/delete/update attachments")):Promise.reject(new V(i,"this layer doesn't support attachments"))}async function Ydt(t,e,i,n,r){const s=await tm(t);if(await mj(t,e,r),!s.updateAttachment)throw new V(r,"Layer source does not support updateAttachment capability");return s.updateAttachment(e,i,n)}async function Xdt(t,e,i){const{applyEdits:n}=await Y(()=>import("./editingSupport-2257fe93.js"),["./editingSupport-2257fe93.js","./EditBusLayer-04851d7f.js"],import.meta.url),r=await t.load();return n(r,r.source,e,i)}async function Kdt(t,e,i){const{uploadAssets:n}=await Y(()=>import("./editingSupport-2257fe93.js"),["./editingSupport-2257fe93.js","./EditBusLayer-04851d7f.js"],import.meta.url),r=await t.load();return n(r,r.source,e,i)}async function Qdt(t,e,i,n){const r=await tm(t);if(await mj(t,e,n),!r.deleteAttachments)throw new V(n,"Layer source does not support deleteAttachments capability");return r.deleteAttachments(e,i)}async function ept(t,e,i){const n=(await t.load({signal:e==null?void 0:e.signal})).source;if(!n.fetchRecomputedExtents)throw new V(i,"Layer source does not support fetchUpdates capability");return n.fetchRecomputedExtents(e)}async function tpt(t,e,i,n){var m,g;e=Aae.from(e),await t.load();const r=t.source,s=t.capabilities;if(!((m=s==null?void 0:s.data)!=null&&m.supportsAttachment))throw new V(n,"this layer doesn't support attachments");const{attachmentTypes:o,objectIds:a,globalIds:l,num:c,size:u,start:d,where:f}=e;if(!((g=s==null?void 0:s.operations)!=null&&g.supportsQueryAttachments)&&((o==null?void 0:o.length)>0||(l==null?void 0:l.length)>0||(u==null?void 0:u.length)>0||c||d||f))throw new V(n,"when 'capabilities.operations.supportsQueryAttachments' is false, only objectIds is supported",e);if(!(a!=null&&a.length||l!=null&&l.length||f))throw new V(n,"'objectIds', 'globalIds', or 'where' are required to perform attachment query",e);if(!r.queryAttachments)throw new V(n,"Layer source does not support queryAttachments capability",e);return r.queryAttachments(e)}async function ipt(t,e,i,n){const r=await tm(t);if(!r.queryObjectIds)throw new V(n,"Layer source does not support queryObjectIds capability");return r.queryObjectIds(vu.from(e)??t.createQuery(),i)}async function npt(t,e,i,n){const r=await tm(t);if(!r.queryFeatureCount)throw new V(n,"Layer source does not support queryFeatureCount capability");return r.queryFeatureCount(vu.from(e)??t.createQuery(),i)}async function rpt(t,e,i,n){const r=await tm(t);if(!r.queryExtent)throw new V(n,"Layer source does not support queryExtent capability");return r.queryExtent(vu.from(e)??t.createQuery(),i)}async function spt(t,e,i,n){const r=await tm(t);if(!r.queryRelatedFeatures)throw new V(n,"Layer source does not support queryRelatedFeatures capability");return r.queryRelatedFeatures(fj.from(e),i)}async function opt(t,e,i,n){const r=await tm(t);if(!r.queryRelatedFeaturesCount)throw new V(n,"Layer source does not support queryRelatedFeaturesCount capability");return r.queryRelatedFeaturesCount(fj.from(e),i)}async function apt(t){const e=t.source;if(e!=null&&e.refresh)try{const{dataChanged:i,updates:n}=await e.refresh();if(n!=null&&(t.sourceJSON={...t.sourceJSON,...n},t.read(n,{origin:"service",url:t.parsedUrl})),i)return!0}catch{}if(t.definitionExpression)try{return(await WRe(t.definitionExpression,t.fieldsIndex)).hasDateFunctions}catch{}return!1}function lpt(t){const e=new vu,i=t.get("capabilities.data"),n=t.get("capabilities.query");e.historicMoment=t.historicMoment,e.gdbVersion=t.gdbVersion,e.returnGeometry=!0,n&&(e.compactGeometryEnabled=n.supportsCompactGeometry,e.defaultSpatialReferenceEnabled=n.supportsDefaultSpatialReference),i&&(i.supportsZ&&t.returnZ!=null&&(e.returnZ=t.returnZ),i.supportsM&&t.returnM!=null&&(e.returnM=t.returnM)),e.outFields=["*"];const{timeOffset:r,timeExtent:s}=t;return e.timeExtent=r!=null&&s!=null?s.offset(-r.value,r.unit):s||null,e.multipatchOption=t.geometryType==="multipatch"?"xyFootprint":null,e}function cpt(t){const{globalIdField:e,fields:i}=t;if(e)return e;if(i){for(const n of i)if(n.type==="esriFieldTypeGlobalID")return n.name}}function upt(t){const{objectIdField:e,fields:i}=t;if(e)return e;if(i){for(const n of i)if(n.type==="esriFieldTypeOID")return n.name}}function hpt(t){return t.currentVersion?t.currentVersion:t.hasOwnProperty("capabilities")||t.hasOwnProperty("drawingInfo")||t.hasOwnProperty("hasAttachments")||t.hasOwnProperty("htmlPopupType")||t.hasOwnProperty("relationships")||t.hasOwnProperty("timeInfo")||t.hasOwnProperty("typeIdField")||t.hasOwnProperty("types")?10:9.3}async function tm(t){return(await t.load()).source}async function ZRe(t,e){if(!ct||ct.findCredential(t))return;let i;try{const n=await GQ(t,e);n&&(i=await ct.checkSignInStatus(`${n}/sharing`))}catch{}if(i)try{const n=e!=null?e.signal:null;await ct.getCredential(t,{signal:n})}catch{}}async function dpt(t,e){var n;const i=(n=t.parsedUrl)==null?void 0:n.path;i&&YRe(t)&&await ZRe(i,e)}function YRe(t){const e=t.editFieldsInfo;return!(!(e!=null&&e.creatorField)&&!(e!=null&&e.editorField))||(t.userHasUpdateItemPrivileges?t.hasUpdateItemRestrictions:!!t.userHasFullEditingPrivileges&&t.hasFullEditingRestrictions)}function ppt(t){var e;return!((e=t.sourceJSON)!=null&&e.isMultiServicesView)&&(t.userHasUpdateItemPrivileges||t.editingEnabled)}const hO=Ob({types:ine});function $ae(t,e){if(t.defaultSymbol)return t.types&&t.types.length?new Kb({defaultSymbol:hO(t.defaultSymbol,t,e),field:t.typeIdField,uniqueValueInfos:t.types.map(i=>({id:i.id,symbol:hO(i.symbol,i,e)}))}):new HP({symbol:hO(t.defaultSymbol,t,e)})}const gj="__begin__",yj="__end__",XRe=new RegExp(gj,"ig"),KRe=new RegExp(yj,"ig"),XG=new RegExp("^"+gj,"i"),KG=new RegExp(yj+"$","i"),zA='"',QRe=zA+" + ",e5e=" + "+zA;function t5e(t){return t.replaceAll(new RegExp("\\[","g"),"{").replaceAll(new RegExp("\\]","g"),"}")}function i5e(t){return t.replaceAll(new RegExp("\\{","g"),"[").replaceAll(new RegExp("\\}","g"),"]")}function vj(t){const e={expression:"",type:"none"};return t.labelExpressionInfo?t.labelExpressionInfo.value?(e.expression=t.labelExpressionInfo.value,e.type="conventional"):t.labelExpressionInfo.expression&&(e.expression=t.labelExpressionInfo.expression,e.type="arcade"):t.labelExpression!=null&&(e.expression=t5e(t.labelExpression),e.type="conventional"),e}function n5e(t){const e=vj(t);if(!e)return null;switch(e.type){case"conventional":return DN(e.expression);case"arcade":return e.expression}return null}function r5e(t){const e=vj(t);if(!e)return null;switch(e.type){case"conventional":return o5e(e.expression);case"arcade":return Pae(e.expression)}return null}function DN(t){let e;return t?(e=pl(t,i=>gj+'$feature["'+i+'"]'+yj),e=XG.test(e)?e.replace(XG,""):zA+e,e=KG.test(e)?e.replace(KG,""):e+zA,e=e.replaceAll(XRe,QRe).replaceAll(KRe,e5e)):e='""',e}const s5e=/^\s*\{([^}]+)\}\s*$/i;function o5e(t){const e=t==null?void 0:t.match(s5e);return e&&e[1].trim()||null}const a5e=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])([\w\s]+)(\2)\]));?\s*$/i,l5e=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])([\w\s]+)(\2)\]));?\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(\1|\3)(\5)\s*\));?\s*$/i,c5e=/^\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])([\w\s]+)(\1)\s*\));?\s*$/i;function Pae(t){if(!t)return null;let e=a5e.exec(t)||l5e.exec(t);return e?e[1]||e[3]:(e=c5e.exec(t),e?e[2]:null)}var NN;let gp=NN=class extends ie{constructor(){super(...arguments),this.expression=null,this.title=null,this.value=null}readExpression(t,e){return e.value?DN(e.value):t}writeExpression(t,e,i){this.value!=null&&(t=DN(this.value)),t!=null&&(e[i]=t)}clone(){return new NN({expression:this.expression,title:this.title,value:this.value})}};h([p({type:String,json:{write:{writerEnsuresNonNull:!0}}})],gp.prototype,"expression",void 0),h([_e("expression",["expression","value"])],gp.prototype,"readExpression",null),h([ge("expression")],gp.prototype,"writeExpression",null),h([p({type:String,json:{write:!0,origins:{"web-scene":{write:!1}}}})],gp.prototype,"title",void 0),h([p({json:{read:!1,write:!1}})],gp.prototype,"value",void 0),gp=NN=h([P("esri.layers.support.LabelExpressionInfo")],gp);const kae=gp,u5e=rs.fromJSON(nae),h5e=Ur.fromJSON(rae),d5e=Pc.fromJSON(sae),p5e=o0.fromJSON(NLe);function fpt(t){if(t==null)return null;switch(t.type){case"mesh":return null;case"point":case"multipoint":return u5e;case"polyline":return h5e;case"polygon":case"extent":return d5e}return null}const mpt=rs.fromJSON(FLe),gpt=Ur.fromJSON(zLe),ypt=Pc.fromJSON(VLe);var FN;const AI=new qe({esriServerPointLabelPlacementAboveCenter:"above-center",esriServerPointLabelPlacementAboveLeft:"above-left",esriServerPointLabelPlacementAboveRight:"above-right",esriServerPointLabelPlacementBelowCenter:"below-center",esriServerPointLabelPlacementBelowLeft:"below-left",esriServerPointLabelPlacementBelowRight:"below-right",esriServerPointLabelPlacementCenterCenter:"center-center",esriServerPointLabelPlacementCenterLeft:"center-left",esriServerPointLabelPlacementCenterRight:"center-right",esriServerLinePlacementAboveAfter:"above-after",esriServerLinePlacementAboveAlong:"above-along",esriServerLinePlacementAboveBefore:"above-before",esriServerLinePlacementAboveStart:"above-start",esriServerLinePlacementAboveEnd:"above-end",esriServerLinePlacementBelowAfter:"below-after",esriServerLinePlacementBelowAlong:"below-along",esriServerLinePlacementBelowBefore:"below-before",esriServerLinePlacementBelowStart:"below-start",esriServerLinePlacementBelowEnd:"below-end",esriServerLinePlacementCenterAfter:"center-after",esriServerLinePlacementCenterAlong:"center-along",esriServerLinePlacementCenterBefore:"center-before",esriServerLinePlacementCenterStart:"center-start",esriServerLinePlacementCenterEnd:"center-end",esriServerPolygonPlacementAlwaysHorizontal:"always-horizontal"},{ignoreUnknown:!0});function $I(t,e,i){return{enabled:!UQ(i==null?void 0:i.layer)}}function Oae(t){var e;return!t||t.origin!=="service"&&((e=t.layer)==null?void 0:e.type)!=="map-image"}function f5e(t){return(t==null?void 0:t.type)==="map-image"}function Lae(t){var e,i;return!!f5e(t)&&!!((i=(e=t.capabilities)==null?void 0:e.exportMap)!=null&&i.supportsArcadeExpressionForLabeling)}function m5e(t){return Oae(t)||Lae(t==null?void 0:t.layer)}let _n=FN=class extends ie{static evaluateWhere(t,e){const i=(n,r,s)=>{switch(r){case"=":return n==s;case"<>":return n!=s;case">":return n>s;case">=":return n>=s;case"<":return n<s;case"<=":return n<=s}return!1};try{if(t==null)return!0;const n=t.split(" ");if(n.length===3)return i(e[n[0]],n[1],n[2]);if(n.length===7){const r=i(e[n[0]],n[1],n[2]),s=n[3],o=i(e[n[4]],n[5],n[6]);switch(s){case"AND":return r&&o;case"OR":return r||o}}return!1}catch{console.log("Error.: can't parse = "+t)}}constructor(t){super(t),this.type="label",this.name=null,this.allowOverrun=!1,this.deconflictionStrategy="static",this.labelExpression=null,this.labelExpressionInfo=null,this.labelPlacement=null,this.labelPosition="curved",this.maxScale=0,this.minScale=0,this.repeatLabel=!0,this.repeatLabelDistance=null,this.symbol=p5e,this.useCodedValues=void 0,this.where=null}readLabelExpression(t,e){const i=e.labelExpressionInfo;if(!i||!i.value&&!i.expression)return t}writeLabelExpression(t,e,i){if(this.labelExpressionInfo){if(this.labelExpressionInfo.value!=null)t=i5e(this.labelExpressionInfo.value);else if(this.labelExpressionInfo.expression!=null){const n=Pae(this.labelExpressionInfo.expression);n&&(t="["+n+"]")}}t!=null&&(e[i]=t)}writeLabelExpressionInfo(t,e,i,n){if(t==null&&this.labelExpression!=null&&Oae(n))t=new kae({expression:this.getLabelExpressionArcade()});else if(!t)return;const r=t.toJSON(n);r.expression&&(e[i]=r)}writeMaxScale(t,e){(t||this.minScale)&&(e.maxScale=t)}writeMinScale(t,e){(t||this.maxScale)&&(e.minScale=t)}getLabelExpression(){return vj(this)}getLabelExpressionArcade(){return n5e(this)}getLabelExpressionSingleField(){return r5e(this)}hash(){return JSON.stringify(this)}clone(){return new FN({allowOverrun:this.allowOverrun,deconflictionStrategy:this.deconflictionStrategy,labelExpression:this.labelExpression,labelExpressionInfo:q(this.labelExpressionInfo),labelPosition:this.labelPosition,labelPlacement:this.labelPlacement,maxScale:this.maxScale,minScale:this.minScale,name:this.name,repeatLabel:this.repeatLabel,repeatLabelDistance:this.repeatLabelDistance,symbol:q(this.symbol),where:this.where,useCodedValues:this.useCodedValues})}};h([p({type:String,json:{write:!0}})],_n.prototype,"name",void 0),h([p({type:Boolean,json:{write:!0,default:!1,origins:{"web-scene":{write:!1},"portal-item":{default:!1,write:{overridePolicy:$I}}}}})],_n.prototype,"allowOverrun",void 0),h([p({type:String,json:{write:!0,default:"static",origins:{"web-scene":{write:!1},"portal-item":{default:"static",write:{overridePolicy:$I}}}}})],_n.prototype,"deconflictionStrategy",void 0),h([p({type:String,json:{write:{overridePolicy(t,e,i){return this.labelExpressionInfo&&(i==null?void 0:i.origin)==="service"&&Lae(i.layer)?{enabled:!1}:{allowNull:!0}}}}})],_n.prototype,"labelExpression",void 0),h([_e("labelExpression")],_n.prototype,"readLabelExpression",null),h([ge("labelExpression")],_n.prototype,"writeLabelExpression",null),h([p({type:kae,json:{write:{overridePolicy:(t,e,i)=>m5e(i)?{allowNull:!0}:{enabled:!1}}}})],_n.prototype,"labelExpressionInfo",void 0),h([ge("labelExpressionInfo")],_n.prototype,"writeLabelExpressionInfo",null),h([p({type:AI.apiValues,json:{type:AI.jsonValues,read:AI.read,write:AI.write}})],_n.prototype,"labelPlacement",void 0),h([p({type:["curved","parallel"],json:{write:!0,origins:{"web-map":{write:!1},"web-scene":{write:!1},"portal-item":{write:!1}}}})],_n.prototype,"labelPosition",void 0),h([p({type:Number})],_n.prototype,"maxScale",void 0),h([ge("maxScale")],_n.prototype,"writeMaxScale",null),h([p({type:Number})],_n.prototype,"minScale",void 0),h([ge("minScale")],_n.prototype,"writeMinScale",null),h([p({type:Boolean,json:{write:!0,origins:{"web-scene":{write:!1},"portal-item":{write:{overridePolicy:$I}}}}})],_n.prototype,"repeatLabel",void 0),h([p({type:Number,cast:vt,json:{write:!0,origins:{"web-scene":{write:!1},"portal-item":{write:{overridePolicy:$I}}}}})],_n.prototype,"repeatLabelDistance",void 0),h([p({types:xTe,json:{origins:{"web-scene":{types:STe,write:SG,default:null}},write:SG,default:null}})],_n.prototype,"symbol",void 0),h([p({type:Boolean,json:{write:!0}})],_n.prototype,"useCodedValues",void 0),h([p({type:String,json:{write:!0}})],_n.prototype,"where",void 0),_n=FN=h([P("esri.layers.support.LabelClass")],_n);const lT=_n;var zN;const g5e="esri.layers.support.FeatureReductionBinning";let Ws=zN=class extends $f{constructor(t){super(t),this.type="binning",this.binType="geohash",this.fixedBinLevel=3,this.labelingInfo=null,this.labelsVisible=!0,this.maxScale=0,this.popupEnabled=!0,this.popupTemplate=null,this.fields=[],this.renderer=null}writeFields(t,e,i){const n=t.filter(r=>r.statisticType!=="avg_angle").map(r=>r.toJSON());dl(i,n,e)}readRenderer(t,e,i){var r;const n=(r=e.drawingInfo)==null?void 0:r.renderer;return n?DA(n,e,i)??void 0:$ae(e,i)}clone(){return new zN({fields:q(this.fields),fixedBinLevel:this.fixedBinLevel,labelingInfo:q(this.labelingInfo),labelsVisible:this.labelsVisible,maxScale:this.maxScale,popupEnabled:this.popupEnabled,popupTemplate:q(this.popupTemplate),renderer:q(this.renderer)})}};h([be({binning:"binning"})],Ws.prototype,"type",void 0),h([be({geohash:"geohash"})],Ws.prototype,"binType",void 0),h([p({type:Number,range:{min:1,max:9},json:{write:!0}})],Ws.prototype,"fixedBinLevel",void 0),h([p({type:[lT],json:{read:{source:"drawingInfo.labelingInfo"},write:{target:"drawingInfo.labelingInfo"}}})],Ws.prototype,"labelingInfo",void 0),h([p(dj)],Ws.prototype,"labelsVisible",void 0),h([p({type:Number,json:{default:0,name:"visibilityInfo.maxScale"}})],Ws.prototype,"maxScale",void 0),h([p(hj)],Ws.prototype,"popupEnabled",void 0),h([p({type:Jf,json:{name:"popupInfo",write:!0}})],Ws.prototype,"popupTemplate",void 0),h([p({type:[Gy],json:{write:!0}})],Ws.prototype,"fields",void 0),h([ge("fields")],Ws.prototype,"writeFields",null),h([p({types:qP,json:{write:{target:"drawingInfo.renderer"}}})],Ws.prototype,"renderer",void 0),h([_e("renderer",["drawingInfo.renderer"])],Ws.prototype,"readRenderer",null),Ws=zN=h([P(g5e)],Ws);const Rae=Ws;var VN;const y5e="esri.layers.support.FeatureReductionCluster";function QG(t){var e;return t.type==="simple"&&!((e=t.visualVariables)!=null&&e.length)}let Hn=VN=class extends ie{constructor(t){super(t),this.type="cluster",this.clusterRadius=vt("80px"),this.clusterMinSize=vt("12px"),this.clusterMaxSize=vt("50px"),this.maxScale=0,this.popupEnabled=!0,this.popupTemplate=null,this.renderer=null,this.symbol=null,this.labelingInfo=null,this.labelsVisible=!0,this.fields=null}readRenderer(t,e,i){var r,s;const n=(r=e.drawingInfo)==null?void 0:r.renderer;return(s=n==null?void 0:n.authoringInfo)!=null&&s.isAutoGenerated?null:n?QG(n)?null:DA(n,e,i)??void 0:$ae(e,i)}readSymbol(t,e,i){var r,s;const n=(r=e.drawingInfo)==null?void 0:r.renderer;if((s=n==null?void 0:n.authoringInfo)!=null&&s.isAutoGenerated)return null;if(n&&QG(n)){const o=DA(n,e,i);return o==null?void 0:o.symbol}return null}writeSymbol(t,e,i,n){var s,o;const r=(o=(s=this.renderer)==null?void 0:s.authoringInfo)==null?void 0:o.isAutoGenerated;if(!this.renderer||r){const a=new HP({symbol:t});e.drawingInfo={renderer:a.write({},n)}}}writeFields(t,e,i){const n=t.filter(r=>r.statisticType!=="avg_angle").map(r=>r.toJSON());dl(i,n,e)}readFields(t,e,i){return t.filter(n=>!n.isAutoGenerated).map(n=>Gy.fromJSON(n))}clone(){return new VN({clusterRadius:this.clusterRadius,clusterMinSize:this.clusterMinSize,clusterMaxSize:this.clusterMaxSize,labelingInfo:q(this.labelingInfo),labelsVisible:this.labelsVisible,fields:q(this.fields),maxScale:this.maxScale,renderer:q(this.renderer),symbol:q(this.symbol),popupEnabled:this.popupEnabled,popupTemplate:q(this.popupTemplate)})}};h([p({type:["cluster"],readOnly:!0,json:{write:!0}})],Hn.prototype,"type",void 0),h([p({type:Number,cast:t=>t==="auto"?t:vt(t),json:{write:!0}})],Hn.prototype,"clusterRadius",void 0),h([p({type:Number,cast:vt,json:{write:!0}})],Hn.prototype,"clusterMinSize",void 0),h([p({type:Number,cast:vt,json:{write:!0}})],Hn.prototype,"clusterMaxSize",void 0),h([p({type:Number,json:{default:0,name:"visibilityInfo.maxScale"}})],Hn.prototype,"maxScale",void 0),h([p(hj)],Hn.prototype,"popupEnabled",void 0),h([p({type:Jf,json:{read:{source:"popupInfo"},write:{target:"popupInfo"}}})],Hn.prototype,"popupTemplate",void 0),h([p({types:qP,json:{write:{target:"drawingInfo.renderer"}}})],Hn.prototype,"renderer",void 0),h([_e("renderer",["drawingInfo.renderer"])],Hn.prototype,"readRenderer",null),h([p({types:bTe})],Hn.prototype,"symbol",void 0),h([_e("symbol",["drawingInfo.renderer"])],Hn.prototype,"readSymbol",null),h([ge("symbol")],Hn.prototype,"writeSymbol",null),h([p({type:[lT],json:{read:{source:"drawingInfo.labelingInfo"},write:{target:"drawingInfo.labelingInfo"}}})],Hn.prototype,"labelingInfo",void 0),h([p(dj)],Hn.prototype,"labelsVisible",void 0),h([p({type:[Gy],json:{write:!0}})],Hn.prototype,"fields",void 0),h([ge("fields")],Hn.prototype,"writeFields",null),h([_e("fields")],Hn.prototype,"readFields",null),Hn=VN=h([P(y5e)],Hn);const Dae=Hn;var jN;let GM=jN=class extends $f{constructor(t){super(t),this.type="selection"}clone(){return new jN}};h([p({type:["selection"]})],GM.prototype,"type",void 0),GM=jN=h([P("esri.layers.support.FeatureReductionSelection")],GM);const eH=GM,tH={key:"type",base:$f,typeMap:{cluster:Dae,binning:Rae}},v5e={types:{key:"type",base:$f,typeMap:{selection:eH,cluster:Dae,binning:Rae}},json:{name:"layerDefinition.featureReduction",write:{allowNull:!0},origins:{"web-map":{types:tH},"portal-item":{types:tH},"web-scene":{types:{key:"type",base:$f,typeMap:{selection:eH}}}}}},L0={Base64:0,Hex:1,String:2,Raw:3},N_=8,Nae=(1<<N_)-1;function pf(t,e){const i=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(i>>16)<<16|65535&i}function _5e(t){const e=[];for(let i=0,n=t.length*N_;i<n;i+=N_)e[i>>5]|=(t.charCodeAt(i/N_)&Nae)<<i%32;return e}function b5e(t){const e=[];for(let i=0,n=32*t.length;i<n;i+=N_)e.push(String.fromCharCode(t[i>>5]>>>i%32&Nae));return e.join("")}function w5e(t){const e="0123456789abcdef",i=[];for(let n=0,r=4*t.length;n<r;n++)i.push(e.charAt(t[n>>2]>>n%4*8+4&15)+e.charAt(t[n>>2]>>n%4*8&15));return i.join("")}function x5e(t){const e="=",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=[];for(let r=0,s=4*t.length;r<s;r+=3){const o=(t[r>>2]>>r%4*8&255)<<16|(t[r+1>>2]>>(r+1)%4*8&255)<<8|t[r+2>>2]>>(r+2)%4*8&255;for(let a=0;a<4;a++)8*r+6*a>32*t.length?n.push(e):n.push(i.charAt(o>>6*(3-a)&63))}return n.join("")}function S5e(t,e){return t<<e|t>>>32-e}function XP(t,e,i,n,r,s){return pf(S5e(pf(pf(e,t),pf(n,s)),r),i)}function os(t,e,i,n,r,s,o){return XP(e&i|~e&n,t,e,r,s,o)}function as(t,e,i,n,r,s,o){return XP(e&n|i&~n,t,e,r,s,o)}function ls(t,e,i,n,r,s,o){return XP(e^i^n,t,e,r,s,o)}function cs(t,e,i,n,r,s,o){return XP(i^(e|~n),t,e,r,s,o)}function T5e(t,e){t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;let i=1732584193,n=-271733879,r=-1732584194,s=271733878;for(let o=0;o<t.length;o+=16){const a=i,l=n,c=r,u=s;i=os(i,n,r,s,t[o],7,-680876936),s=os(s,i,n,r,t[o+1],12,-389564586),r=os(r,s,i,n,t[o+2],17,606105819),n=os(n,r,s,i,t[o+3],22,-1044525330),i=os(i,n,r,s,t[o+4],7,-176418897),s=os(s,i,n,r,t[o+5],12,1200080426),r=os(r,s,i,n,t[o+6],17,-1473231341),n=os(n,r,s,i,t[o+7],22,-45705983),i=os(i,n,r,s,t[o+8],7,1770035416),s=os(s,i,n,r,t[o+9],12,-1958414417),r=os(r,s,i,n,t[o+10],17,-42063),n=os(n,r,s,i,t[o+11],22,-1990404162),i=os(i,n,r,s,t[o+12],7,1804603682),s=os(s,i,n,r,t[o+13],12,-40341101),r=os(r,s,i,n,t[o+14],17,-1502002290),n=os(n,r,s,i,t[o+15],22,1236535329),i=as(i,n,r,s,t[o+1],5,-165796510),s=as(s,i,n,r,t[o+6],9,-1069501632),r=as(r,s,i,n,t[o+11],14,643717713),n=as(n,r,s,i,t[o],20,-373897302),i=as(i,n,r,s,t[o+5],5,-701558691),s=as(s,i,n,r,t[o+10],9,38016083),r=as(r,s,i,n,t[o+15],14,-660478335),n=as(n,r,s,i,t[o+4],20,-405537848),i=as(i,n,r,s,t[o+9],5,568446438),s=as(s,i,n,r,t[o+14],9,-1019803690),r=as(r,s,i,n,t[o+3],14,-187363961),n=as(n,r,s,i,t[o+8],20,1163531501),i=as(i,n,r,s,t[o+13],5,-1444681467),s=as(s,i,n,r,t[o+2],9,-51403784),r=as(r,s,i,n,t[o+7],14,1735328473),n=as(n,r,s,i,t[o+12],20,-1926607734),i=ls(i,n,r,s,t[o+5],4,-378558),s=ls(s,i,n,r,t[o+8],11,-2022574463),r=ls(r,s,i,n,t[o+11],16,1839030562),n=ls(n,r,s,i,t[o+14],23,-35309556),i=ls(i,n,r,s,t[o+1],4,-1530992060),s=ls(s,i,n,r,t[o+4],11,1272893353),r=ls(r,s,i,n,t[o+7],16,-155497632),n=ls(n,r,s,i,t[o+10],23,-1094730640),i=ls(i,n,r,s,t[o+13],4,681279174),s=ls(s,i,n,r,t[o],11,-358537222),r=ls(r,s,i,n,t[o+3],16,-722521979),n=ls(n,r,s,i,t[o+6],23,76029189),i=ls(i,n,r,s,t[o+9],4,-640364487),s=ls(s,i,n,r,t[o+12],11,-421815835),r=ls(r,s,i,n,t[o+15],16,530742520),n=ls(n,r,s,i,t[o+2],23,-995338651),i=cs(i,n,r,s,t[o],6,-198630844),s=cs(s,i,n,r,t[o+7],10,1126891415),r=cs(r,s,i,n,t[o+14],15,-1416354905),n=cs(n,r,s,i,t[o+5],21,-57434055),i=cs(i,n,r,s,t[o+12],6,1700485571),s=cs(s,i,n,r,t[o+3],10,-1894986606),r=cs(r,s,i,n,t[o+10],15,-1051523),n=cs(n,r,s,i,t[o+1],21,-2054922799),i=cs(i,n,r,s,t[o+8],6,1873313359),s=cs(s,i,n,r,t[o+15],10,-30611744),r=cs(r,s,i,n,t[o+6],15,-1560198380),n=cs(n,r,s,i,t[o+13],21,1309151649),i=cs(i,n,r,s,t[o+4],6,-145523070),s=cs(s,i,n,r,t[o+11],10,-1120210379),r=cs(r,s,i,n,t[o+2],15,718787259),n=cs(n,r,s,i,t[o+9],21,-343485551),i=pf(i,a),n=pf(n,l),r=pf(r,c),s=pf(s,u)}return[i,n,r,s]}function Fae(t,e=L0.Hex){const i=e||L0.Base64,n=T5e(_5e(t),t.length*N_);switch(i){case L0.Raw:return n;case L0.Hex:return w5e(n);case L0.String:return b5e(n);case L0.Base64:return x5e(n)}}var BN;let Kw=BN=class extends u0{writeLevels(t,e,i){for(const n in t){const r=this.levels[n];return void(e.stops=r)}}clone(){return new BN({axis:this.axis,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,maxDataValue:this.maxDataValue,maxSize:df(this.maxSize)?this.maxSize.clone():this.maxSize,minDataValue:this.minDataValue,minSize:df(this.minSize)?this.minSize.clone():this.minSize,normalizationField:this.normalizationField,stops:this.stops&&this.stops.map(t=>t.clone()),target:this.target,useSymbolValue:this.useSymbolValue,valueRepresentation:this.valueRepresentation,valueUnit:this.valueUnit,legendOptions:this.legendOptions&&this.legendOptions.clone(),levels:q(this.levels)})}};h([p()],Kw.prototype,"levels",void 0),h([ge("levels")],Kw.prototype,"writeLevels",null),Kw=BN=h([P("esri.views.2d.engine.LevelDependentSizeVariable")],Kw);const I5e=ne.getLogger("esri.views.2d.layers.support.clusterUtils");ee.add("esri-cluster-arcade-enabled",!0);const C5e=ee("esri-cluster-arcade-enabled"),M5e=(t,e,i,n,r)=>{const s=e.clone();if(!A5e(s))return s;if(s.authoringInfo||(s.authoringInfo=new rT),s.authoringInfo.isAutoGenerated=!0,"visualVariables"in s){const o=(s.visualVariables||[]).filter(l=>l.valueExpression!=="$view.scale"),a=zae(o);o.forEach(l=>{l.type==="rotation"?l.field?l.field=pm(t,l.field,"avg_angle","number"):l.valueExpression&&(l.field=P1(t,l.valueExpression,"avg_angle","number"),l.valueExpression=null):l.normalizationField?(l.field=pm(t,l.field,"avg_norm","number",l.normalizationField),l.normalizationField=null):l.field?l.field=pm(t,l.field,"avg","number"):l.valueExpression&&(l.field=P1(t,l.valueExpression,"avg","number"),l.valueExpression=null)}),a==null&&!E5e(o)&&r&&(o.push(Vae(i,n)),s.dynamicClusterSize=!0),s.visualVariables=o}switch(s.type){case"simple":break;case"pie-chart":for(const o of s.attributes)o.field?o.field=pm(t,o.field,"sum","number"):o.valueExpression&&(o.field=P1(t,o.valueExpression,"sum","number"),o.valueExpression=null);break;case"unique-value":s.field?s.field=pm(t,s.field,"mode","string"):s.valueExpression&&(s.field=P1(t,s.valueExpression,"mode","string"),s.valueExpression=null);break;case"class-breaks":s.normalizationField?(s.field=pm(t,s.field,"avg_norm","number",s.normalizationField),s.normalizationField=null):s.field?s.field=pm(t,s.field,"avg","number"):s.valueExpression&&(s.field=P1(t,s.valueExpression,"avg","number"),s.valueExpression=null)}return s},zae=t=>{for(const e of t)if(e.type==="size")return e;return null};function vpt(t,e,i){const n=t.clone();let r=!1;if("visualVariables"in n){const s=(n.visualVariables||[]).filter(o=>o.valueExpression!=="$view.scale");zae(s)==null&&(n.visualVariables||(n.visualVariables=[]),n.visualVariables.push(Vae(e,i)),n.dynamicClusterSize=!0,r=!0)}return{renderer:n,didInject:r}}const E5e=t=>{for(const e of t)if(e.field==="cluster_count")return!0;return!1},Vae=(t,e)=>{const i=[new Mv({value:0,size:0}),new Mv({value:1})];if(e==null)return new u0({field:"cluster_count",stops:[...i,new Mv({value:2,size:0})]});const n=Object.keys(e).reduce((r,s)=>({...r,[s]:[...i,new Mv({value:Math.max(2,e[s].minValue),size:t.clusterMinSize}),new Mv({value:Math.max(3,e[s].maxValue),size:t.clusterMaxSize})]}),{});return new Kw({field:"cluster_count",levels:n})},A5e=t=>{const e=i=>I5e.error(new V("Unsupported-renderer",i,{renderer:t}));if(!t)return!1;switch(t.type){case"unique-value":if(t.field2||t.field3)return e("FeatureReductionCluster does not support multi-field UniqueValueRenderers"),!1;break;case"class-breaks":if(t.normalizationField){const i=t.normalizationType;if(i!=="field")return e(`FeatureReductionCluster does not support a normalizationType of ${i}`),!1}break;case"simple":case"pie-chart":break;default:return e(`FeatureReductionCluster does not support renderers of type ${t.type}`),!1}if(!C5e){if("valueExpression"in t&&t.valueExpression)return e("FeatureReductionCluster does not currently support renderer.valueExpression. Support will be added in a future release"),!1;if(("visualVariables"in t&&t.visualVariables||[]).some(i=>!(!("valueExpression"in i)||!i.valueExpression)))return e("FeatureReductionCluster does not currently support visualVariables with a valueExpression. Support will be added in a future release"),!1}return!0};function $5e(t,e,i){switch(t){case"sum":return`cluster_sum_${e}`;case"avg":case"avg_angle":return`cluster_avg_${e}`;case"mode":return`cluster_type_${e}`;case"avg_norm":{const n=i,r="field",s=e.toLowerCase()+",norm:"+r+","+n.toLowerCase();return"cluster_avg_"+Fae(s)}}}function P1(t,e,i,n){const r=Fae(e),s=i==="mode"?`cluster_type_${r}`:i==="sum"?`cluster_sum_${r}`:`cluster_avg_${r}`;return t.some(o=>o.name===s)||t.push(new Gy({name:s,isAutoGenerated:!0,onStatisticExpression:new uj({expression:e,returnType:n}),statisticType:i})),s}function pm(t,e,i,n,r){if(e==="cluster_count"||t.some(o=>o.name===e))return e;const s=$5e(i,e,r);return t.some(o=>o.name===s)||(i==="avg_norm"?t.push(new Gy({name:s,isAutoGenerated:!0,onStatisticExpression:new uj({expression:`$feature.${e} / $feature.${r}`,returnType:n}),statisticType:"avg"})):t.push(new Gy({name:s,isAutoGenerated:!0,onStatisticField:e,statisticType:i}))),s}const P5e=t=>{let e=class extends t{constructor(...i){super(...i),this.own(this.watch("renderer",()=>{if(this.featureReduction){const n=this._normalizeFeatureReduction(this.featureReduction);this._set("featureReduction",n)}},!0))}set featureReduction(i){const n=this._normalizeFeatureReduction(i);this._set("featureReduction",n)}set renderer(i){}_normalizeFeatureReduction(i){var a;if((i==null?void 0:i.type)!=="cluster")return i;const n=i.clone(),r=[new Gy({name:"cluster_count",isAutoGenerated:!0,statisticType:"count"})],s=(n.fields??[]).filter(l=>!l.isAutoGenerated);if(i.renderer&&!((a=i.renderer.authoringInfo)!=null&&a.isAutoGenerated))return n.fields=[...r,...s],n;if(i.symbol)return n.fields=[...r,...s],n.renderer=null,n;if(!this.renderer)return i;const o=M5e(r,this.renderer,i,null,!1);return n.fields=[...r,...s],n.renderer=o,n}};return h([p(v5e)],e.prototype,"featureReduction",null),e=h([P("esri.layers.mixins.FeatureReductionLayer")],e),e},iH={ArcGISAnnotationLayer:!0,ArcGISDimensionLayer:!0,ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISImageServiceVectorLayer:!0,ArcGISMapServiceLayer:!0,ArcGISStreamLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BingMapsAerial:!0,BingMapsHybrid:!0,BingMapsRoad:!0,CSV:!0,GeoRSS:!0,GeoJSON:!0,GroupLayer:!0,KML:!0,MediaLayer:!0,OGCFeatureLayer:!0,OrientedImageryLayer:!0,SubtypeGroupLayer:!0,VectorTileLayer:!0,WFS:!0,WMS:!0,WebTiledLayer:!0},nH={ArcGISImageServiceLayer:!0,ArcGISImageServiceVectorLayer:!0,ArcGISMapServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,OpenStreetMap:!0,VectorTileLayer:!0,WMS:!0,WebTiledLayer:!0,BingMapsAerial:!0,BingMapsRoad:!0,BingMapsHybrid:!0},rH={ArcGISFeatureLayer:!0},k5e={"web-scene/operational-layers":{ArcGISDimensionLayer:!0,ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISMapServiceLayer:!0,ArcGISSceneServiceLayer:!0,ArcGISTiledElevationServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BuildingSceneLayer:!0,GroupLayer:!0,IntegratedMeshLayer:!0,OGCFeatureLayer:!0,PointCloudLayer:!0,WebTiledLayer:!0,CSV:!0,GeoJSON:!0,VectorTileLayer:!0,WFS:!0,WMS:!0,KML:!0,RasterDataLayer:!0,Voxel:!0,LineOfSightLayer:!0},"web-scene/basemap":{ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,WebTiledLayer:!0,OpenStreetMap:!0,VectorTileLayer:!0,ArcGISImageServiceLayer:!0,WMS:!0,ArcGISMapServiceLayer:!0,ArcGISSceneServiceLayer:!0},"web-scene/ground":{ArcGISTiledElevationServiceLayer:!0,RasterDataElevationLayer:!0},"web-map/operational-layers":iH,"web-map/basemap":nH,"web-map/tables":rH,"link-chart/operational-layers":{...iH,LinkChartLayer:!0},"link-chart/basemap":nH,"link-chart/tables":rH,"portal-item/operational-layers":{ArcGISFeatureLayer:!0,ArcGISSceneServiceLayer:!0,PointCloudLayer:!0,BuildingSceneLayer:!0,IntegratedMeshLayer:!0,OrientedImageryLayer:!0}},jae=t=>{let e=class extends t{constructor(){super(...arguments),this.title=null}writeListMode(i,n,r,s){(s&&s.layerContainerType==="ground"||i&&N0e(this,r,{},s))&&(n[r]=i)}writeOperationalLayerType(i,n,r,s){!i||s&&s.layerContainerType==="tables"||(n.layerType=i)}writeTitle(i,n){n.title=i??"Layer"}read(i,n){n&&(n.layer=this),L0e(this,i,r=>super.read(i,r),n)}write(i,n){var o,a;if(n!=null&&n.origin){const l=`${n.origin}/${n.layerContainerType||"operational-layers"}`,c=k5e[l];let u=!!(c!=null&&c[this.operationalLayerType]);if(this.operationalLayerType==="ArcGISTiledElevationServiceLayer"&&l==="web-scene/operational-layers"&&(u=!1),this.operationalLayerType==="ArcGISDimensionLayer"&&l==="web-map/operational-layers"&&(u=!1),!u)return(o=n.messages)==null||o.push(new V("layer:unsupported",`Layers (${this.title}, ${this.id}) of type '${this.declaredClass}' are not supported in the context of '${l}'`,{layer:this})),null}const r=super.write(i,{...n,layer:this}),s=!!n&&!!n.messages&&!!n.messages.filter(l=>l instanceof V&&l.name==="web-document-write:property-required").length;return iP(r==null?void 0:r.url)?((a=n==null?void 0:n.messages)==null||a.push(new V("layer:invalid-url",`Layer (${this.title}, ${this.id}) of type '${this.declaredClass}' using a Blob URL cannot be written to web scenes and web maps`,{layer:this})),null):!this.url&&s?null:r}beforeSave(){}};return h([p({type:String,json:{write:{ignoreOrigin:!0},origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0}},"portal-item":{write:!1}}}})],e.prototype,"id",void 0),h([p(qRe)],e.prototype,"listMode",void 0),h([ge("listMode")],e.prototype,"writeListMode",null),h([p({type:String,readOnly:!0,json:{read:!1,write:{target:"layerType",ignoreOrigin:!0},origins:{"portal-item":{write:!1}}}})],e.prototype,"operationalLayerType",void 0),h([ge("operationalLayerType")],e.prototype,"writeOperationalLayerType",null),h([p(FA)],e.prototype,"opacity",void 0),h([p({type:String,json:{write:{ignoreOrigin:!0,writerEnsuresNonNull:!0},origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0,writerEnsuresNonNull:!0}},"portal-item":{write:!1}}},value:"Layer"})],e.prototype,"title",void 0),h([ge("title"),ge(["web-scene"],"title")],e.prototype,"writeTitle",null),h([p({type:Boolean,json:{name:"visibility"}})],e.prototype,"visible",void 0),e=h([P("esri.layers.mixins.OperationalLayer")],e),e};var UN;const dO=new qe({asc:"ascending",desc:"descending"});let Rv=UN=class extends ie{constructor(t){super(t),this.field=null,this.valueExpression=null,this.order="ascending"}clone(){return new UN({field:this.field,valueExpression:this.valueExpression,order:this.order})}};h([p({type:String,json:{write:!0}})],Rv.prototype,"field",void 0),h([p({type:String,json:{write:!0}})],Rv.prototype,"valueExpression",void 0),h([p({type:dO.apiValues,json:{read:dO.read,write:dO.write}})],Rv.prototype,"order",void 0),Rv=UN=h([P("esri.layers.support.OrderByInfo")],Rv);const Bae=Rv;function O5e(t,e,i){if(!t)return null;const n=t.find(s=>!!s.field);if(!n)return null;const r=new Bae;return r.read(n,i),[r]}function L5e(t,e,i,n){const r=t.find(s=>!!s.field);r&&dl(i,[r.toJSON()],e)}const R5e=t=>{let e=class extends t{constructor(){super(...arguments),this.orderBy=null}};return h([p({type:[Bae],json:{origins:{"web-scene":{write:!1,read:!1}},read:{source:"layerDefinition.orderBy",reader:O5e},write:{target:"layerDefinition.orderBy",writer:L5e}}})],e.prototype,"orderBy",void 0),e=h([P("esri.layers.mixins.OrderedLayer")],e),e};async function D5e(t){const e=t.spatialReference;if(e.isWGS84)return t.clone();if(e.isWebMercator)return ny(t);const i=Ee.WGS84;return await Ff(e,i),an(t,i)}function _pt(t,e){if(!Uae(t,e)){const i=t.typeKeywords;i?i.push(e):t.typeKeywords=[e]}}function Uae(t,e){var i;return!!((i=t.typeKeywords)!=null&&i.includes(e))}function bpt(t){return Uae(t,N5e.HOSTED_SERVICE)}function wpt(t,e){const i=t.typeKeywords;if(i){const n=i.indexOf(e);n>-1&&i.splice(n,1)}}async function xpt(t){const e=t.clone().normalize();let i;if(e.length>1)for(const n of e)i?n.width>i.width&&(i=n):i=n;else i=e[0];return D5e(i)}const N5e={DEVELOPER_BASEMAP:"DeveloperBasemap",JSAPI:"ArcGIS API for JavaScript",METADATA:"Metadata",MULTI_LAYER:"Multilayer",SINGLE_LAYER:"Singlelayer",TABLE:"Table",HOSTED_SERVICE:"Hosted Service"};function sH(t){var l;const{portal:e,isOrgItem:i,itemControl:n}=t,r=(l=e.user)==null?void 0:l.privileges;let s=!r||r.includes("features:user:edit"),o=!!i&&!!(r!=null&&r.includes("features:user:fullEdit"));const a=n==="update"||n==="admin";return a?o=s=!0:o&&(s=!0),{features:{edit:s,fullEdit:o},content:{updateItem:a}}}const Gae=t=>{let e=class extends t{constructor(){super(...arguments),this.resourceReferences={portalItem:null,paths:[]},this.userHasEditingPrivileges=!0,this.userHasFullEditingPrivileges=!1,this.userHasUpdateItemPrivileges=!1}destroy(){this.portalItem=Je(this.portalItem),this.resourceReferences.portalItem=null,this.resourceReferences.paths.length=0}set portalItem(i){i!==this._get("portalItem")&&(this.removeOrigin("portal-item"),this._set("portalItem",i))}readPortalItem(i,n,r){if(n.itemId)return new Lx({id:n.itemId,portal:r&&r.portal})}writePortalItem(i,n){i&&i.id&&(n.itemId=i.id)}async loadFromPortal(i,n){if(this.portalItem&&this.portalItem.id)try{const{load:r}=await Y(()=>import("./layersLoader-cf53bd10.js"),["./layersLoader-cf53bd10.js","./fetchService-3a21abab.js","./jsonContext-491a2ecb.js","./styleUtils-fd6677de.js"],import.meta.url);return Vt(n),await r({instance:this,supportedTypes:i.supportedTypes,validateItem:i.validateItem,supportsData:i.supportsData,layerModuleTypeMap:i.layerModuleTypeMap},n)}catch(r){throw Ds(r)||ne.getLogger(this).warn(`Failed to load layer (${this.title}, ${this.id}) portal item (${this.portalItem.id})
  ${r}`),r}}async finishLoadEditablePortalLayer(i){this._set("userHasEditingPrivileges",await this._fetchUserHasEditingPrivileges(i).catch(n=>($o(n),!0)))}async _setUserPrivileges(i,n){if(!Tt.userPrivilegesApplied)return this.finishLoadEditablePortalLayer(n);if(this.url)try{const{features:{edit:r,fullEdit:s},content:{updateItem:o}}=await this._fetchUserPrivileges(i,n);this._set("userHasEditingPrivileges",r),this._set("userHasFullEditingPrivileges",s),this._set("userHasUpdateItemPrivileges",o)}catch(r){$o(r)}}async _fetchUserPrivileges(i,n){let r=this.portalItem;if(!i||!r||!r.loaded||r.sourceUrl)return this._fetchFallbackUserPrivileges(n);const s=i===r.id;if(s&&r.portal.user)return sH(r);let o,a;if(s)o=r.portal.url;else try{o=await GQ(this.url,n)}catch(d){$o(d)}if(!o||!hve(o,r.portal.url))return this._fetchFallbackUserPrivileges(n);try{const d=n!=null?n.signal:null;a=await(ct==null?void 0:ct.getCredential(`${o}/sharing`,{prompt:!1,signal:d}))}catch(d){$o(d)}const l=!0,c=!1,u=!1;if(!a)return{features:{edit:l,fullEdit:c},content:{updateItem:u}};try{if(s?await r.reload():(r=new Lx({id:i,portal:{url:o}}),await r.load(n)),r.portal.user)return sH(r)}catch(d){$o(d)}return{features:{edit:l,fullEdit:c},content:{updateItem:u}}}async _fetchFallbackUserPrivileges(i){let n=!0;try{n=await this._fetchUserHasEditingPrivileges(i)}catch(r){$o(r)}return{features:{edit:n,fullEdit:!1},content:{updateItem:!1}}}async _fetchUserHasEditingPrivileges(i){const n=this.url?ct==null?void 0:ct.findCredential(this.url):null;if(!n)return!0;const r=PI.credential===n?PI.user:await this._fetchEditingUser(i);return PI.credential=n,PI.user=r,r==null||r.privileges==null||r.privileges.includes("features:user:edit")}async _fetchEditingUser(i){var u,d;const n=(d=(u=this.portalItem)==null?void 0:u.portal)==null?void 0:d.user;if(n)return n;const r=ct.findServerInfo(this.url??"");if(!(r!=null&&r.owningSystemUrl))return null;const s=`${r.owningSystemUrl}/sharing/rest`,o=nr.getDefault();if(o&&o.loaded&&ll(o.restUrl)===ll(s))return o.user;const a=`${s}/community/self`,l=i!=null?i.signal:null,c=await Q$(gt(a,{authMode:"no-prompt",query:{f:"json"},signal:l}));return c.ok?g6.fromJSON(c.value.data):null}read(i,n){n&&(n.layer=this),super.read(i,n)}write(i,n){const r=n&&n.portal,s=this.portalItem&&this.portalItem.id&&(this.portalItem.portal||nr.getDefault());return r&&s&&!hQ(s.restUrl,r.restUrl)?(n.messages&&n.messages.push(new V("layer:cross-portal",`The layer '${this.title} (${this.id})' cannot be persisted because it refers to an item on a different portal than the one being saved to. To save, set layer.portalItem to null or save to the same portal as the item associated with the layer`,{layer:this})),null):super.write(i,{...n,layer:this})}};return h([p({type:Lx})],e.prototype,"portalItem",null),h([_e("web-document","portalItem",["itemId"])],e.prototype,"readPortalItem",null),h([ge("web-document","portalItem",{itemId:{type:String}})],e.prototype,"writePortalItem",null),h([p({clonable:!1})],e.prototype,"resourceReferences",void 0),h([p({type:Boolean,readOnly:!0})],e.prototype,"userHasEditingPrivileges",void 0),h([p({type:Boolean,readOnly:!0})],e.prototype,"userHasFullEditingPrivileges",void 0),h([p({type:Boolean,readOnly:!0})],e.prototype,"userHasUpdateItemPrivileges",void 0),e=h([P("esri.layers.mixins.PortalLayer")],e),e},PI={credential:null,user:null},Q2=new xe,Wx=new WeakMap;function F5e(t){Hae(t)&&Q2.push(t)}function z5e(t){Hae(t)&&Q2.includes(t)&&Q2.remove(t)}function Hae(t){return t!=null&&typeof t=="object"&&"refreshInterval"in t&&"refresh"in t}function qae(t,e){return Number.isFinite(t)&&Number.isFinite(e)?e<=0?t:qae(e,t%e):0}let pO=0,kI=0;function V5e(){const t=Date.now();for(const e of Q2)e.refreshInterval&&t-(Wx.get(e)??0)+5>=6e4*e.refreshInterval&&(Wx.set(e,t),e.refresh(t))}Vz(()=>{const t=Date.now();let e=0;for(const i of Q2)e=qae(Math.round(6e4*i.refreshInterval),e),i.refreshInterval?Wx.get(i)||Wx.set(i,t):Wx.delete(i);if(e!==kI){if(kI=e,clearInterval(pO),kI===0)return void(pO=0);pO=setInterval(V5e,kI)}});const Wae=t=>{let e=class extends t{constructor(...i){super(...i),this.refreshInterval=0,this.refreshTimestamp=0,this._debounceHasDataChanged=kS(()=>this.hasDataChanged()),this.when().then(()=>{this.destroyed||F5e(this)},()=>{})}destroy(){z5e(this)}get refreshParameters(){return{_ts:this.refreshTimestamp||null}}refresh(i=Date.now()){$y(this._debounceHasDataChanged()).then(n=>{n&&this._set("refreshTimestamp",i),this.emit("refresh",{dataChanged:n})},n=>{ne.getLogger(this).error(n),this.emit("refresh",{dataChanged:!1,error:n})})}async hasDataChanged(){return!0}};return h([p({type:Number,cast:i=>i>=.1?i:i<=0?0:.1,json:{write:!0}})],e.prototype,"refreshInterval",void 0),h([p({readOnly:!0})],e.prototype,"refreshTimestamp",void 0),h([p()],e.prototype,"refreshParameters",null),e=h([P("esri.layers.mixins.RefreshableLayer")],e),e},_j=t=>{let e=class extends t{constructor(){super(...arguments),this.minScale=0,this.maxScale=0}get effectiveScaleRange(){const i={minScale:this.minScale,maxScale:this.maxScale},n=this.parent;n&&"effectiveScaleRange"in n&&j5e(i,n.effectiveScaleRange);const r=this._get("effectiveScaleRange");return r&&r.minScale===i.minScale&&r.maxScale===i.maxScale?r:i}};return h([p({type:Number,nonNullable:!0,json:{write:!0}})],e.prototype,"minScale",void 0),h([p({type:Number,nonNullable:!0,json:{write:!0}})],e.prototype,"maxScale",void 0),h([p({readOnly:!0})],e.prototype,"effectiveScaleRange",null),e=h([P("esri.layers.mixins.ScaleRangeLayer")],e),e};function j5e(t,e){return t.minScale=t.minScale>0?e.minScale>0?Math.min(t.minScale,e.minScale):t.minScale:e.minScale,t.maxScale=t.maxScale>0?e.maxScale>0?Math.max(t.maxScale,e.maxScale):t.maxScale:e.maxScale,t}const Jae=Nn()({esriTimeUnitsMilliseconds:"milliseconds",esriTimeUnitsSeconds:"seconds",esriTimeUnitsMinutes:"minutes",esriTimeUnitsHours:"hours",esriTimeUnitsDays:"days",esriTimeUnitsWeeks:"weeks",esriTimeUnitsMonths:"months",esriTimeUnitsYears:"years",esriTimeUnitsDecades:"decades",esriTimeUnitsCenturies:"centuries",esriTimeUnitsUnknown:void 0});let Qw=class extends An(ie){constructor(e){super(e),this.unit="milliseconds",this.value=0}toMilliseconds(){return uEe(this.value,this.unit,"milliseconds")}};h([be(Jae,{nonNullable:!0})],Qw.prototype,"unit",void 0),h([p({type:Number,json:{write:!0},nonNullable:!0})],Qw.prototype,"value",void 0),Qw=h([P("esri.TimeInterval")],Qw);const VA=Qw;function oH(t,e){return VA.fromJSON({value:t,unit:e})}let ys=class extends An(ie){constructor(e){super(e),this.cumulative=!1,this.endField=null,this.fullTimeExtent=null,this.hasLiveData=!1,this.interval=null,this.startField=null,this.timeReference=null,this.trackIdField=null,this.useTime=!0}readFullTimeExtent(e,i){if(!i.timeExtent||!Array.isArray(i.timeExtent)||i.timeExtent.length!==2)return null;const n=new Date(i.timeExtent[0]),r=new Date(i.timeExtent[1]);return new Bu({start:n,end:r})}writeFullTimeExtent(e,i){e&&e.start!=null&&e.end!=null?i.timeExtent=[e.start.getTime(),e.end.getTime()]:i.timeExtent=null}readInterval(e,i){return i.timeInterval&&i.timeIntervalUnits?oH(i.timeInterval,i.timeIntervalUnits):i.defaultTimeInterval&&i.defaultTimeIntervalUnits?oH(i.defaultTimeInterval,i.defaultTimeIntervalUnits):null}writeInterval(e,i){i.timeInterval=(e==null?void 0:e.toJSON().value)??null,i.timeIntervalUnits=(e==null?void 0:e.toJSON().unit)??null}};h([p({type:Boolean,json:{name:"exportOptions.timeDataCumulative",write:!0}})],ys.prototype,"cumulative",void 0),h([p({type:String,json:{name:"endTimeField",write:{enabled:!0,allowNull:!0}}})],ys.prototype,"endField",void 0),h([p({type:Bu,json:{write:{enabled:!0,allowNull:!0}}})],ys.prototype,"fullTimeExtent",void 0),h([_e("fullTimeExtent",["timeExtent"])],ys.prototype,"readFullTimeExtent",null),h([ge("fullTimeExtent")],ys.prototype,"writeFullTimeExtent",null),h([p({type:Boolean,json:{write:!0}})],ys.prototype,"hasLiveData",void 0),h([p({type:VA,json:{write:{enabled:!0,allowNull:!0}}})],ys.prototype,"interval",void 0),h([_e("interval",["timeInterval","timeIntervalUnits","defaultTimeInterval","defaultTimeIntervalUnits"])],ys.prototype,"readInterval",null),h([ge("interval")],ys.prototype,"writeInterval",null),h([p({type:String,json:{name:"startTimeField",write:{enabled:!0,allowNull:!0}}})],ys.prototype,"startField",void 0),h([p({type:IV,json:{write:{enabled:!0,allowNull:!0}}})],ys.prototype,"timeReference",void 0),h([p({type:String,json:{write:{enabled:!0,allowNull:!0}}})],ys.prototype,"trackIdField",void 0),h([p({type:Boolean,json:{name:"exportOptions.useTime",write:!0}})],ys.prototype,"useTime",void 0),ys=h([P("esri.layers.support.TimeInfo")],ys);const B5e=ys,Zae=t=>{let e=class extends t{constructor(){super(...arguments),this.timeExtent=null,this.timeOffset=null,this.useViewTime=!0}readOffset(i,n){const r=n.timeInfo.exportOptions;if(!r)return null;const s=r.timeOffset,o=Jae.fromJSON(r.timeOffsetUnits);return s&&o?new VA({value:s,unit:o}):null}set timeInfo(i){nte(i,this.fieldsIndex),this._set("timeInfo",i)}};return h([p({type:Bu,json:{write:!1}})],e.prototype,"timeExtent",void 0),h([p({type:VA})],e.prototype,"timeOffset",void 0),h([_e("service","timeOffset",["timeInfo.exportOptions"])],e.prototype,"readOffset",null),h([p({value:null,type:B5e,json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],e.prototype,"timeInfo",null),h([p({type:Boolean,json:{read:{source:"timeAnimation"},write:{target:"timeAnimation"},origins:{"web-scene":{read:!1,write:!1}}}})],e.prototype,"useViewTime",void 0),e=h([P("esri.layers.mixins.TemporalLayer")],e),e},aH=new qe({esriFeatureEditToolAutoCompletePolygon:"auto-complete-polygon",esriFeatureEditToolCircle:"circle",esriFeatureEditToolEllipse:"ellipse",esriFeatureEditToolFreehand:"freehand",esriFeatureEditToolLine:"line",esriFeatureEditToolNone:"none",esriFeatureEditToolPoint:"point",esriFeatureEditToolPolygon:"polygon",esriFeatureEditToolRectangle:"rectangle",esriFeatureEditToolArrow:"arrow",esriFeatureEditToolTriangle:"triangle",esriFeatureEditToolLeftArrow:"left-arrow",esriFeatureEditToolRightArrow:"right-arrow",esriFeatureEditToolUpArrow:"up-arrow",esriFeatureEditToolDownArrow:"down-arrow"});let yp=class extends An(ie){constructor(e){super(e),this.name=null,this.description=null,this.drawingTool=null,this.prototype=null,this.thumbnail=null}};h([p({json:{write:!0}})],yp.prototype,"name",void 0),h([p({json:{write:!0}})],yp.prototype,"description",void 0),h([p({json:{read:aH.read,write:aH.write}})],yp.prototype,"drawingTool",void 0),h([p({json:{write:!0}})],yp.prototype,"prototype",void 0),h([p({json:{write:!0}})],yp.prototype,"thumbnail",void 0),yp=h([P("esri.layers.support.FeatureTemplate")],yp);const Yae=yp;let yh=class extends An(ie){constructor(e){super(e),this.id=null,this.name=null,this.domains=null,this.templates=null}readDomains(e){const i={};for(const n of Object.keys(e))i[n]=lae(e[n]);return i}writeDomains(e,i){var r;const n={};for(const s of Object.keys(e))e[s]&&(n[s]=(r=e[s])==null?void 0:r.toJSON());i.domains=n}};h([p({json:{write:!0}})],yh.prototype,"id",void 0),h([p({json:{write:!0}})],yh.prototype,"name",void 0),h([p({json:{write:!0}})],yh.prototype,"domains",void 0),h([_e("domains")],yh.prototype,"readDomains",null),h([ge("domains")],yh.prototype,"writeDomains",null),h([p({type:[Yae],json:{write:!0}})],yh.prototype,"templates",void 0),yh=h([P("esri.layers.support.FeatureType")],yh);const U5e=yh;function G5e(){return{fields:{type:[dc],value:null},fieldsIndex:{readOnly:!0,get(){return new Doe(this.fields||[])}},outFields:{type:[String],json:{read:!1},set:function(t){this._userOutFields=t,this.notifyChange("outFields")},get:function(){var e;const t=this._userOutFields;if(!t||!t.length)return null;if(t.includes("*"))return["*"];if(!this.fields)return t;for(const i of t)((e=this.fieldsIndex)==null?void 0:e.has(i))||ne.getLogger("esri.layers.support.fieldProperties").error("field-attributes-layer:invalid-field",`Invalid field ${i} found in outFields`,{layer:this,outFields:t});return D6(this.fieldsIndex,t)}}}}const fO=ne.getLogger("esri.layers.support.labelingInfo"),H5e=/\[([^\[\]]+)\]/gi;function q5e(t,e,i){return t?t.map(n=>{const r=new lT;if(r.read(n,i),r.labelExpression){const s=e.fields||e.layerDefinition&&e.layerDefinition.fields||this.fields;r.labelExpression=r.labelExpression.replaceAll(H5e,(o,a)=>`[${W5e(a,s)}]`)}return r}):null}function W5e(t,e){if(!e)return t;const i=t.toLowerCase();for(let n=0;n<e.length;n++){const r=e[n].name;if(r.toLowerCase()===i)return r}return t}const J5e={esriGeometryPoint:["above-right","above-center","above-left","center-center","center-left","center-right","below-center","below-left","below-right"],esriGeometryPolygon:["always-horizontal"],esriGeometryPolyline:["center-along"],esriGeometryMultipoint:null};function Mpt(t,e){const i=q(t);return i.some(n=>Z5e(n,e))?[]:i}function Z5e(t,e){const i=t.labelPlacement,n=J5e[e];if(!t.symbol)return fO.warn("No ILabelClass symbol specified."),!0;if(!n)return fO.error(new V("labeling:unsupported-geometry-type",`Unable to create labels for layer, geometry type '${e}' is not supported`)),!0;if(!n.includes(i)){const r=n[0];i&&fO.warn(`Found invalid label placement type ${i} for ${e}. Defaulting to ${r}`),t.labelPlacement=r}return!1}function Xae({displayField:t,editFieldsInfo:e,fields:i,objectIdField:n,title:r},s){if(!i)return null;const o=Q5e({editFieldsInfo:e,fields:i,objectIdField:n},s);if(!o.length)return null;const a=iDe({titleBase:r,fields:i,displayField:t}),l=tDe();return new Jf({title:a,content:l,fieldInfos:o})}const Y5e=(t,e)=>e.visibleFieldNames?e.visibleFieldNames.has(t.name):ate(t,e);function X5e(t,e){const i=t;return e&&(t=t.filter(n=>!e.includes(n.type))),t===i&&(t=t.slice()),t.sort(K5e),t}function K5e(t,e){return t.type==="oid"?-1:e.type==="oid"?1:lH(t)?-1:lH(e)?1:(t.alias||t.name).toLocaleLowerCase().localeCompare((e.alias||e.name).toLocaleLowerCase())}function Q5e(t,e){const i=e==null?void 0:e.visibleFieldNames;return X5e(t.fields??[],(e==null?void 0:e.ignoreFieldTypes)||nDe).map(n=>new Q6({fieldName:n.name,isEditable:Vwe(n,t),label:n.alias,format:eDe(n),visible:Y5e(n,{...t,visibleFieldNames:i})}))}function eDe(t){switch(t.type){case"small-integer":case"integer":case"single":return new a_({digitSeparator:!0,places:0});case"double":return new a_({digitSeparator:!0,places:2});case"date":return new a_({dateFormat:"long-month-day-year"});default:return t.type==="string"&&RR(t.name)?new a_({digitSeparator:!0,places:0}):null}}function tDe(){return[new F2,new N2]}function iDe(t){const e=Pwe(t),{titleBase:i}=t;return e?`${i}: {${e.trim()}}`:i??""}function lH(t){return(t.name&&t.name.toLowerCase())==="name"?!0:(t.alias&&t.alias.toLowerCase())==="name"}const nDe=["geometry","blob","raster","guid","xml"],rDe=G5e();let dt=class extends R5e(Tae(P5e(DRe(cj(Zae(_j(Wae(jae(Gae(ij(lP))))))))))){constructor(e){super(e),this.copyright=null,this.definitionExpression=null,this.displayField=null,this.editingEnabled=!1,this.elevationInfo=null,this.fields=null,this.fieldsIndex=null,this.fullExtent=null,this.geometryType=null,this.hasZ=void 0,this.labelsVisible=!0,this.labelingInfo=null,this.legendEnabled=!0,this.objectIdField=null,this.operationalLayerType="GeoJSON",this.popupEnabled=!0,this.popupTemplate=null,this.screenSizePerspectiveEnabled=!0,this.source=new ag({layer:this}),this.spatialReference=Ee.WGS84,this.templates=null,this.title="GeoJSON",this.type="geojson",this.typeIdField=null,this.types=null}destroy(){var e;(e=this.source)==null||e.destroy()}load(e){const i=this.loadFromPortal({supportedTypes:["GeoJson"],supportsData:!1},e).catch($o).then(()=>this.source.load(e)).then(()=>{this.read(this.source.sourceJSON,{origin:"service",url:this.parsedUrl}),this.revert(["objectIdField","fields","timeInfo"],"service"),H9(this.renderer,this.fieldsIndex),nte(this.timeInfo,this.fieldsIndex)});return this.addResolvingPromise(i),Promise.resolve(this)}get capabilities(){return this.source?this.source.capabilities:null}get createQueryVersion(){return this.commitProperty("definitionExpression"),this.commitProperty("timeExtent"),this.commitProperty("timeOffset"),this.commitProperty("geometryType"),this.commitProperty("capabilities"),(this._get("createQueryVersion")||0)+1}get defaultPopupTemplate(){return this.createPopupTemplate()}get isTable(){return this.loaded&&this.geometryType==null}get parsedUrl(){return this.url?ir(this.url):null}set renderer(e){H9(e,this.fieldsIndex),this._set("renderer",e)}set url(e){if(!e)return void this._set("url",e);const i=ir(e);this._set("url",i.path),i.query&&(this.customParameters={...this.customParameters,...i.query})}async applyEdits(e,i){const{applyEdits:n}=await Y(()=>import("./editingSupport-2257fe93.js"),["./editingSupport-2257fe93.js","./EditBusLayer-04851d7f.js"],import.meta.url);await this.load();const r=await n(this,this.source,e,i);return this.read({extent:this.source.sourceJSON.extent,timeInfo:this.source.sourceJSON.timeInfo},{origin:"service",ignoreDefaults:!0}),r}on(e,i){return super.on(e,i)}createPopupTemplate(e){return Xae(this,e)}createQuery(){const e=new vu,i=this.get("capabilities.data");e.returnGeometry=!0,i&&i.supportsZ&&(e.returnZ=!0),e.outFields=["*"],e.where=this.definitionExpression||"1=1";const{timeOffset:n,timeExtent:r}=this;return e.timeExtent=n!=null&&r!=null?r.offset(-n.value,n.unit):r||null,e}getFieldDomain(e,i){let n,r=!1;const s=i&&i.feature,o=s&&s.attributes,a=this.typeIdField&&o&&o[this.typeIdField];return a!=null&&this.types&&(r=this.types.some(l=>l.id==a&&(n=l.domains&&l.domains[e],n&&n.type==="inherited"&&(n=this._getLayerDomain(e)),!0))),r||n||(n=this._getLayerDomain(e)),n}getField(e){return this.fieldsIndex.get(e)}queryFeatures(e,i){return this.load().then(()=>this.source.queryFeatures(vu.from(e)||this.createQuery(),i)).then(n=>{if(n!=null&&n.features)for(const r of n.features)r.layer=r.sourceLayer=this;return n})}queryObjectIds(e,i){return this.load().then(()=>this.source.queryObjectIds(vu.from(e)||this.createQuery(),i))}queryFeatureCount(e,i){return this.load().then(()=>this.source.queryFeatureCount(vu.from(e)||this.createQuery(),i))}queryExtent(e,i){return this.load().then(()=>this.source.queryExtent(vu.from(e)||this.createQuery(),i))}async hasDataChanged(){try{const{dataChanged:e,updates:i}=await this.source.refresh(this.customParameters);return i!=null&&this.read(i,{origin:"service",url:this.parsedUrl,ignoreDefaults:!0}),e}catch{}return!1}_getLayerDomain(e){if(!this.fields)return null;let i=null;return this.fields.some(n=>(n.name===e&&(i=n.domain),!!i)),i}};h([p({readOnly:!0,json:{read:!1,write:!1}})],dt.prototype,"capabilities",null),h([p({type:String})],dt.prototype,"copyright",void 0),h([p({readOnly:!0})],dt.prototype,"createQueryVersion",null),h([p({readOnly:!0})],dt.prototype,"defaultPopupTemplate",null),h([p({type:String,json:{name:"layerDefinition.definitionExpression",write:{enabled:!0,allowNull:!0}}})],dt.prototype,"definitionExpression",void 0),h([p({type:String})],dt.prototype,"displayField",void 0),h([p({type:Boolean})],dt.prototype,"editingEnabled",void 0),h([p(URe)],dt.prototype,"elevationInfo",void 0),h([p({type:[dc],json:{name:"layerDefinition.fields",write:{ignoreOrigin:!0,isRequired:!0},origins:{service:{name:"fields"}}}})],dt.prototype,"fields",void 0),h([p(rDe.fieldsIndex)],dt.prototype,"fieldsIndex",void 0),h([p({type:Le,json:{name:"extent"}})],dt.prototype,"fullExtent",void 0),h([p({type:["point","polygon","polyline","multipoint"],json:{read:{reader:O6.read}}})],dt.prototype,"geometryType",void 0),h([p({type:Boolean})],dt.prototype,"hasZ",void 0),h([p(HRe)],dt.prototype,"id",void 0),h([p({type:Boolean,readOnly:!0})],dt.prototype,"isTable",null),h([p(dj)],dt.prototype,"labelsVisible",void 0),h([p({type:[lT],json:{name:"layerDefinition.drawingInfo.labelingInfo",read:{reader:q5e},write:!0}})],dt.prototype,"labelingInfo",void 0),h([p(Mae)],dt.prototype,"legendEnabled",void 0),h([p({type:["show","hide"]})],dt.prototype,"listMode",void 0),h([p({type:String,json:{name:"layerDefinition.objectIdField",write:{ignoreOrigin:!0,isRequired:!0},origins:{service:{name:"objectIdField"}}}})],dt.prototype,"objectIdField",void 0),h([p(FA)],dt.prototype,"opacity",void 0),h([p({type:["GeoJSON"]})],dt.prototype,"operationalLayerType",void 0),h([p({readOnly:!0})],dt.prototype,"parsedUrl",null),h([p(hj)],dt.prototype,"popupEnabled",void 0),h([p({type:Jf,json:{name:"popupInfo",write:!0}})],dt.prototype,"popupTemplate",void 0),h([p({types:qP,json:{name:"layerDefinition.drawingInfo.renderer",write:!0,origins:{service:{name:"drawingInfo.renderer"},"web-scene":{types:PLe}}}})],dt.prototype,"renderer",null),h([p(BRe)],dt.prototype,"screenSizePerspectiveEnabled",void 0),h([p({readOnly:!0})],dt.prototype,"source",void 0),h([p({type:Ee})],dt.prototype,"spatialReference",void 0),h([p({type:[Yae]})],dt.prototype,"templates",void 0),h([p()],dt.prototype,"title",void 0),h([p({json:{read:!1},readOnly:!0})],dt.prototype,"type",void 0),h([p({type:String,readOnly:!0})],dt.prototype,"typeIdField",void 0),h([p({type:[U5e]})],dt.prototype,"types",void 0),h([p(pj)],dt.prototype,"url",null),dt=h([P("esri.layers.GeoJSONLayer")],dt);const Kae=dt,Apt=Object.freeze(Object.defineProperty({__proto__:null,default:Kae},Symbol.toStringTag,{value:"Module"})),sDe=t=>{let e=class extends t{get title(){if(this._get("title")&&this.originOf("title")!=="defaults")return this._get("title");if(this.url){const i=$P(this.url);if(i!=null&&i.title)return i.title}return this._get("title")||""}set title(i){this._set("title",i)}set url(i){this._set("url",MV(i,ne.getLogger(this)))}};return h([p()],e.prototype,"title",null),h([p({type:String})],e.prototype,"url",null),e=h([P("esri.layers.mixins.ArcGISService")],e),e};var GN;const OI=new qe({flow_from:"flow-from",flow_to:"flow-to"});let vs=GN=class extends Qf(ie){constructor(t){super(t),this.density=.8,this.color=new ae([255,255,255,1]),this.maxPathLength=200,this.trailWidth=1.5,this.flowSpeed=10,this.trailLength=100,this.smoothing=0,this.flowRepresentation="flow-from",this.type="flow",this.authoringInfo=null,this.legendOptions=null,this.trailCap="butt",this.background="none"}clone(){var m,g;const{density:t,maxPathLength:e,trailWidth:i,flowSpeed:n,trailLength:r,smoothing:s,flowRepresentation:o,trailCap:a,background:l}=this,c=this.color.clone(),u=(this.visualVariables||[]).map(y=>y.clone()),d=(m=this.authoringInfo)==null?void 0:m.clone(),f=(g=this.legendOptions)==null?void 0:g.clone();return new GN({density:t,color:c,maxPathLength:e,trailWidth:i,flowSpeed:n,trailLength:r,trailCap:a,background:l,smoothing:s,flowRepresentation:o,visualVariables:u,authoringInfo:d,legendOptions:f})}getSymbol(t,e){}async getSymbolAsync(t,e){}getSymbols(){return[]}};h([p({type:Number,json:{write:!0}})],vs.prototype,"density",void 0),h([p({type:ae,json:{write:{allowNull:!0}}})],vs.prototype,"color",void 0),h([p({type:Number,cast:vt,json:{write:!0}})],vs.prototype,"maxPathLength",void 0),h([p({type:Number,cast:vt,json:{write:!0}})],vs.prototype,"trailWidth",void 0),h([p({type:Number,json:{write:!0}})],vs.prototype,"flowSpeed",void 0),h([p({type:Number,json:{write:!0}})],vs.prototype,"trailLength",void 0),h([p({type:Number,cast:vt,json:{write:!1}})],vs.prototype,"smoothing",void 0),h([p({type:OI.apiValues,json:{type:OI.jsonValues,read:{reader:OI.read},write:{writer:OI.write}}})],vs.prototype,"flowRepresentation",void 0),h([be({flowRenderer:"flow"})],vs.prototype,"type",void 0),h([p({type:rT,json:{write:!0}})],vs.prototype,"authoringInfo",void 0),h([p({type:wy,json:{write:!0}})],vs.prototype,"legendOptions",void 0),h([p({type:String,json:{write:!0}})],vs.prototype,"trailCap",void 0),h([p({type:String,json:{write:!0}})],vs.prototype,"background",void 0),vs=GN=h([P("esri.renderers.FlowRenderer")],vs);const Qae=vs;let Dv=class extends ie{constructor(){super(...arguments),this.value=null,this.label=null,this.color=null}};h([p({type:Number,json:{write:!0}})],Dv.prototype,"value",void 0),h([p({type:String,json:{write:!0}})],Dv.prototype,"label",void 0),h([p({type:ae,json:{type:[It],write:!0}})],Dv.prototype,"color",void 0),Dv=h([P("esri.renderers.support.ColormapInfo")],Dv);const ele=Dv;function oDe(t){return"r"in t&&"g"in t&&"b"in t}function tle(t){return"h"in t&&"s"in t&&"v"in t}function ile(t){return"l"in t&&"a"in t&&"b"in t}function nle(t){return"l"in t&&"c"in t&&"h"in t}function aDe(t){return"x"in t&&"y"in t&&"z"in t}const lDe=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],cDe=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];function rle(t,e){const i=[];let n,r;if(t[0].length!==e.length)throw new Error("dimensions do not match");const s=t.length,o=t[0].length;let a=0;for(n=0;n<s;n++){for(a=0,r=0;r<o;r++)a+=t[n][r]*e[r];i.push(a)}return i}function sle(t){const e=[t.r/255,t.g/255,t.b/255].map(n=>n<=.04045?n/12.92:((n+.055)/1.055)**2.4),i=rle(lDe,e);return{x:100*i[0],y:100*i[1],z:100*i[2]}}function bj(t){const e=rle(cDe,[t.x/100,t.y/100,t.z/100]).map(i=>{const n=i<=.0031308?12.92*i:1.055*i**.4166666666666667-.055;return Math.min(1,Math.max(n,0))});return{r:Math.round(255*e[0]),g:Math.round(255*e[1]),b:Math.round(255*e[2])}}function ole(t){const e=[t.x/95.047,t.y/100,t.z/108.883].map(i=>i>.008856451679035631?i**.3333333333333333:7.787037037037035*i+.13793103448275862);return{l:116*e[1]-16,a:500*(e[0]-e[1]),b:200*(e[1]-e[2])}}function ale(t){const e=t.l,i=[(e+16)/116+t.a/500,(e+16)/116,(e+16)/116-t.b/200].map(n=>n>6/29?n**3:3*(6/29)**2*(n-4/29));return{x:95.047*i[0],y:100*i[1],z:108.883*i[2]}}function uDe(t){const e=t.l,i=t.a,n=t.b,r=Math.sqrt(i*i+n*n);let s=Math.atan2(n,i);return s=s>0?s:s+2*Math.PI,{l:e,c:r,h:s}}function hDe(t){const e=t.l,i=t.c,n=t.h;return{l:e,a:i*Math.cos(n),b:i*Math.sin(n)}}function dDe(t){return ole(sle(t))}function pDe(t){return bj(ale(t))}function fDe(t){return uDe(ole(sle(t)))}function mDe(t){return bj(ale(hDe(t)))}function gDe(t){const e=t.r,i=t.g,n=t.b,r=Math.max(e,i,n),s=r-Math.min(e,i,n);let o=r,a=s===0?0:r===e?(i-n)/s%6:r===i?(n-e)/s+2:(e-i)/s+4,l=s===0?0:s/o;return a<0&&(a+=6),a*=60,l*=100,o*=100/255,{h:a,s:l,v:o}}function yDe(t){const e=(t.h+360)%360/60,i=t.s/100,n=t.v/100*255,r=n*i,s=r*(1-Math.abs(e%2-1));let o;switch(Math.floor(e)){case 0:o={r,g:s,b:0};break;case 1:o={r:s,g:r,b:0};break;case 2:o={r:0,g:r,b:s};break;case 3:o={r:0,g:s,b:r};break;case 4:o={r:s,g:0,b:r};break;case 5:case 6:o={r,g:0,b:s};break;default:o={r:0,g:0,b:0}}return o.r=Math.round(o.r+n-r),o.g=Math.round(o.g+n-r),o.b=Math.round(o.b+n-r),o}function Bf(t){return oDe(t)?t:nle(t)?mDe(t):ile(t)?pDe(t):aDe(t)?bj(t):tle(t)?yDe(t):t}function Hy(t){return tle(t)?t:gDe(Bf(t))}function cH(t){return ile(t)?t:dDe(Bf(t))}function uH(t){return nle(t)?t:fDe(Bf(t))}const vDe=["random","ndvi","ndvi2","ndvi3","elevation","gray","hillshade"],wj=[{id:"aspect",type:"multipart",colorRamps:[{fromColor:[190,190,190],toColor:[255,45,8]},{fromColor:[255,45,8],toColor:[255,181,61]},{fromColor:[255,181,61],toColor:[255,254,52]},{fromColor:[255,254,52],toColor:[0,251,50]},{fromColor:[0,251,50],toColor:[255,254,52]},{fromColor:[0,253,255],toColor:[0,181,255]},{fromColor:[0,181,255],toColor:[26,35,253]},{fromColor:[26,35,253],toColor:[255,57,251]},{fromColor:[255,57,251],toColor:[255,45,8]}]},{id:"black-to-white",fromColor:[0,0,0],toColor:[255,255,255]},{id:"blue-bright",fromColor:[204,204,255],toColor:[0,0,224]},{id:"blue-light-to-dark",fromColor:[211,229,232],toColor:[46,100,140]},{id:"blue-green-bright",fromColor:[203,245,234],toColor:[48,207,146]},{id:"blue-green-light-to-dark",fromColor:[216,242,237],toColor:[21,79,74]},{id:"brown-light-to-dark",fromColor:[240,236,170],toColor:[102,72,48]},{id:"brown-to-blue-green-diverging-right",type:"multipart",colorRamps:[{fromColor:[156,85,31],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[33,130,145]}]},{id:"brown-to-blue-green-diverging-dark",type:"multipart",colorRamps:[{fromColor:[110,70,45],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[48,100,102]}]},{id:"coefficient-bias",fromColor:[214,214,255],toColor:[0,57,148]},{id:"cold-to-hot-diverging",type:"multipart",colorRamps:[{fromColor:[69,117,181],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[214,47,39]}]},{id:"condition-number",type:"multipart",colorRamps:[{fromColor:[0,97,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,34,0]}]},{id:"cyan-to-purple",type:"multipart",colorRamps:[{fromColor:[0,245,245],toColor:[0,0,245]},{fromColor:[0,0,245],toColor:[245,0,245]}]},{id:"cyan-light-to-blue-dark",type:"multipart",colorRamps:[{fromColor:[182,237,240],toColor:[31,131,224]},{fromColor:[31,131,224],toColor:[9,9,145]}]},{id:"distance",fromColor:[255,200,0],toColor:[0,0,255]},{id:"elevation1",type:"multipart",colorRamps:[{fromColor:[175,240,233],toColor:[255,255,179]},{fromColor:[255,255,179],toColor:[0,128,64]},{fromColor:[0,128,64],toColor:[252,186,3]},{fromColor:[252,186,3],toColor:[128,0,0]},{fromColor:[120,0,0],toColor:[105,48,13]},{fromColor:[105,48,13],toColor:[171,171,171]},{fromColor:[171,171,171],toColor:[255,252,255]}]},{id:"elevation2",type:"multipart",colorRamps:[{fromColor:[118,219,211],toColor:[255,255,199]},{fromColor:[255,255,199],toColor:[255,255,128]},{fromColor:[255,255,128],toColor:[217,194,121]},{fromColor:[217,194,121],toColor:[135,96,38]},{fromColor:[135,96,38],toColor:[150,150,181]},{fromColor:[150,150,181],toColor:[181,150,181]},{fromColor:[181,150,181],toColor:[255,252,255]}]},{id:"errors",fromColor:[255,235,214],toColor:[196,10,10]},{id:"gray-light-to-dark",fromColor:[219,219,219],toColor:[69,69,69]},{id:"green-bright",fromColor:[204,255,204],toColor:[14,204,14]},{id:"green-light-to-dark",fromColor:[220,245,233],toColor:[34,102,51]},{id:"green-to-blue",type:"multipart",colorRamps:[{fromColor:[32,204,16],toColor:[0,242,242]},{fromColor:[0,242,242],toColor:[2,33,227]}]},{id:"orange-bright",fromColor:[255,235,204],toColor:[240,118,5]},{id:"orange-light-to-dark",fromColor:[250,233,212],toColor:[171,65,36]},{id:"partial-spectrum",type:"multipart",colorRamps:[{fromColor:[242,241,162],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,0,0]},{fromColor:[252,3,69],toColor:[176,7,237]},{fromColor:[176,7,237],toColor:[2,29,173]}]},{id:"partial-spectrum-1-diverging",type:"multipart",colorRamps:[{fromColor:[135,38,38],toColor:[240,149,12]},{fromColor:[240,149,12],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[74,80,181]},{fromColor:[74,80,181],toColor:[39,32,122]}]},{id:"partial-spectrum-2-diverging",type:"multipart",colorRamps:[{fromColor:[115,77,42],toColor:[201,137,52]},{fromColor:[201,137,52],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[91,63,176]},{fromColor:[91,63,176],toColor:[81,13,97]}]},{id:"pink-to-yellow-green-diverging-bright",type:"multipart",colorRamps:[{fromColor:[158,30,113],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[99,110,45]}]},{id:"pink-to-yellow-green-diverging-dark",type:"multipart",colorRamps:[{fromColor:[97,47,73],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[22,59,15]}]},{id:"precipitation",type:"multipart",colorRamps:[{fromColor:[194,82,60],toColor:[237,161,19]},{fromColor:[237,161,19],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[0,219,0]},{fromColor:[0,219,0],toColor:[32,153,143]},{fromColor:[32,153,143],toColor:[11,44,122]}]},{id:"prediction",type:"multipart",colorRamps:[{fromColor:[40,146,199],toColor:[250,250,100]},{fromColor:[250,250,100],toColor:[232,16,20]}]},{id:"purple-bright",fromColor:[255,204,255],toColor:[199,0,199]},{id:"purple-to-green-diverging-bright",type:"multipart",colorRamps:[{fromColor:[77,32,150],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[20,122,11]}]},{id:"purple-to-green-diverging-dark",type:"multipart",colorRamps:[{fromColor:[67,14,89],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[24,79,15]}]},{id:"purple-blue-bright",fromColor:[223,184,230],toColor:[112,12,242]},{id:"purple-blue-light-to-dark",fromColor:[229,213,242],toColor:[93,44,112]},{id:"purple-red-bright",fromColor:[255,204,225],toColor:[199,0,99]},{id:"purple-red-light-to-dark",fromColor:[250,215,246],toColor:[143,17,57]},{id:"red-bright",fromColor:[255,204,204],toColor:[219,0,0]},{id:"red-light-to-dark",fromColor:[255,224,224],toColor:[143,10,10]},{id:"red-to-blue-diverging-bright",type:"multipart",colorRamps:[{fromColor:[196,69,57],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[48,95,207]}]},{id:"red-to-blue-diverging-dark",type:"multipart",colorRamps:[{fromColor:[107,13,13],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[13,53,97]}]},{id:"red-to-green",type:"multipart",colorRamps:[{fromColor:[245,0,0],toColor:[245,245,0]},{fromColor:[245,245,0],toColor:[0,245,0]}]},{id:"red-to-green-diverging-bright",type:"multipart",colorRamps:[{fromColor:[186,20,20],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[54,145,33]}]},{id:"red-to-green-diverging-dark",type:"multipart",colorRamps:[{fromColor:[97,21,13],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[16,69,16]}]},{id:"slope",type:"multipart",colorRamps:[{fromColor:[56,168,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,0,0]}]},{id:"spectrum-full-bright",type:"multipart",colorRamps:[{fromColor:[255,0,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[0,255,255]},{fromColor:[0,255,255],toColor:[0,0,255]}]},{id:"spectrum-full-dark",type:"multipart",colorRamps:[{fromColor:[153,0,0],toColor:[153,153,0]},{fromColor:[153,153,0],toColor:[0,153,153]},{fromColor:[0,153,153],toColor:[0,0,153]}]},{id:"spectrum-full-light",type:"multipart",colorRamps:[{fromColor:[255,153,153],toColor:[255,255,153]},{fromColor:[255,255,153],toColor:[153,255,255]},{fromColor:[153,255,255],toColor:[153,153,255]}]},{id:"surface",type:"multipart",colorRamps:[{fromColor:[112,153,89],toColor:[242,238,162]},{fromColor:[242,238,162],toColor:[242,206,133]},{fromColor:[242,206,133],toColor:[194,140,124]},{fromColor:[194,140,124],toColor:[255,242,255]}]},{id:"temperature",type:"multipart",colorRamps:[{fromColor:[255,252,255],toColor:[255,0,255]},{fromColor:[255,0,255],toColor:[0,0,255]},{fromColor:[0,0,255],toColor:[0,255,255]},{fromColor:[0,255,255],toColor:[0,255,0]},{fromColor:[0,255,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,128,0]},{fromColor:[255,128,0],toColor:[128,0,0]}]},{id:"white-to-black",fromColor:[255,255,255],toColor:[0,0,0]},{id:"yellow-to-dark-red",type:"multipart",colorRamps:[{fromColor:[255,255,128],toColor:[242,167,46]},{fromColor:[242,167,46],toColor:[107,0,0]}]},{id:"yellow-to-green-to-dark-blue",type:"multipart",colorRamps:[{fromColor:[255,255,128],toColor:[56,224,9]},{fromColor:[56,224,9],toColor:[26,147,171]},{fromColor:[26,147,171],toColor:[12,16,120]}]},{id:"yellow-to-red",fromColor:[245,245,0],toColor:[255,0,0]},{id:"yellow-green-bright",fromColor:[236,252,204],toColor:[157,204,16]},{id:"yellow-green-light-to-dark",fromColor:[215,240,175],toColor:[96,107,45]}],F_=new qe({Aspect:"aspect","Black to White":"black-to-white","Blue Bright":"blue-bright","Blue Light to Dark":"blue-light-to-dark","Blue-Green Bright":"blue-green-bright","Blue-Green Light to Dark":"blue-green-light-to-dark","Brown Light to Dark":"brown-light-to-dark","Brown to Blue Green Diverging, Bright":"brown-to-blue-green-diverging-right","Brown to Blue Green Diverging, Dark":"brown-to-blue-green-diverging-dark","Coefficient Bias":"coefficient-bias","Cold to Hot Diverging":"cold-to-hot-diverging","Condition Number":"condition-number","Cyan to Purple":"cyan-to-purple","Cyan-Light to Blue-Dark":"cyan-light-to-blue-dark",Distance:"distance","Elevation #1":"elevation1","Elevation #2":"elevation2",Errors:"errors","Gray Light to Dark":"gray-light-to-dark","Green Bright":"green-bright","Green Light to Dark":"green-light-to-dark","Green to Blue":"green-to-blue","Orange Bright":"orange-bright","Orange Light to Dark":"orange-light-to-dark","Partial Spectrum":"partial-spectrum","Partial Spectrum 1 Diverging":"partial-spectrum-1-diverging","Partial Spectrum 2 Diverging":"partial-spectrum-2-diverging","Pink to YellowGreen Diverging, Bright":"pink-to-yellow-green-diverging-bright","Pink to YellowGreen Diverging, Dark":"pink-to-yellow-green-diverging-dark",Precipitation:"precipitation",Prediction:"prediction","Purple Bright":"purple-bright","Purple to Green Diverging, Bright":"purple-to-green-diverging-bright","Purple to Green Diverging, Dark":"purple-to-green-diverging-dark","Purple-Blue Bright":"purple-blue-bright","Purple-Blue Light to Dark":"purple-blue-light-to-dark","Purple-Red Bright":"purple-red-bright","Purple-Red Light to Dark":"purple-red-light-to-dark","Red Bright":"red-bright","Red Light to Dark":"red-light-to-dark","Red to Blue Diverging, Bright":"red-to-blue-diverging-bright","Red to Blue Diverging, Dark":"red-to-blue-diverging-dark","Red to Green":"red-to-green","Red to Green Diverging, Bright":"red-to-green-diverging-bright","Red to Green Diverging, Dark":"red-to-green-diverging-dark",Slope:"slope","Spectrum-Full Bright":"spectrum-full-bright","Spectrum-Full Dark":"spectrum-full-dark","Spectrum-Full Light":"spectrum-full-light",Surface:"surface",Temperature:"temperature","White to Black":"white-to-black","Yellow to Dark Red":"yellow-to-dark-red","Yellow to Green to Dark Blue":"yellow-to-green-to-dark-blue","Yellow to Red":"yellow-to-red","Yellow-Green Bright":"yellow-green-bright","Yellow-Green Light to Dark":"yellow-green-light-to-dark"});function LI(t,e){if(!t||!e||t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(t[i]>e[i]+2||t[i]<e[i]-2)return!1;return!0}function hH(t){const e=t.clone();return e.fromColor=t.toColor,e.toColor=t.fromColor,e.algorithm=t.algorithm,e}function _De(t){var e;if(t.type==="multipart"){const i=t.clone();return(e=i.colorRamps)!=null&&e.length&&(i.colorRamps=i.colorRamps.reverse().map(n=>hH(n))),i}return hH(t)}function dH(t,e){if(!t)return;const i=e??wj;let n=null;return t.type==="algorithmic"?i.some(r=>{if(LI(t.fromColor.toRgb(),r.fromColor)&&LI(t.toColor.toRgb(),r.toColor))return n=r.id,!0}):t.type==="multipart"&&i.some(r=>{const s=t.colorRamps,o=r.colorRamps;if(s&&o&&s.length===o.length&&!o.some((a,l)=>{if(!LI(s[l].fromColor.toRgb(),new ae(a.fromColor).toRgb())||!LI(s[l].toColor.toRgb(),new ae(a.toColor).toRgb()))return!0})){if(n)return!0;n=r.id}}),n}function bDe(t,e,i=!1){if(!t)return;let n=dH(t,e);return n!=null||i||(n=dH(t=_De(t),e)),n}function wDe(t,e=!1){const i=typeof t=="string"?t:bDe(t,void 0,e);return i?F_.toJSON(i):null}function xDe(t,e="esriCIELabAlgorithm"){const i=wj.find(({id:n})=>n===t);return i?i.colorRamps?{type:"multipart",colorRamps:i.colorRamps.map(n=>({type:"algorithmic",algorithm:e,fromColor:[...n.fromColor],toColor:[...n.toColor]}))}:{type:"algorithmic",algorithm:e,fromColor:[...i.fromColor],toColor:[...i.toColor]}:null}function lle(t){const e=(t=t||{}).numColors||256,i=t.distanceOffset||0,n=t.isCustomInterval!=null?t.isCustomInterval:t.distanceInterval!==null&&t.distanceInterval!==1/(e-1),r=t.distanceInterval||1/(e-1);return{...t,numColors:e,distanceOffset:i,interpolateAlpha:!!t.interpolateAlpha,distanceInterval:r,isCustomInterval:n,weights:t.weights}}function SDe(t,e,i){const{numColors:n,distanceOffset:r,distanceInterval:s,isCustomInterval:o}=i,a=t.s===0,l=e.s===0;let c=t.h,u=e.h;a&&!l?c=u:l&&!a&&(e={...e,h:c},u=c);let d,f=Math.abs(u-c);const m=360;f<m/2?d=(u-c)*s:(f=m-f,d=c>u?f*s:-f*s);const g=(e.s-t.s)*s,y=(e.v-t.v)*s;let{s:_,v:b}=t,w=c;if(r){const S=r/s;w=(w+S*d+m)%m,_+=S*g,b+=S*y}const x=[];for(let S=0;S<n-1;S++)x.push({h:w,s:_,v:b}),w=(w+d+m)%m,_+=g,b+=y;return x.push(o?{h:w,s:_,v:b}:e),x}function TDe(t,e,i){const{numColors:n,distanceOffset:r,distanceInterval:s,isCustomInterval:o}=i;let{l:a,a:l,b:c}=t;const u=(e.l-a)*s,d=(e.a-l)*s,f=(e.b-c)*s,m=[];if(r){const g=r/s;a+=g*u,l+=g*d,c+=g*f}for(let g=0;g<n-1;g++)m.push({l:a,a:l,b:c}),a+=u,l+=d,c+=f;return m.push(o?{l:a,a:l,b:c}:e),m}function IDe(t,e,i){const{numColors:n,distanceOffset:r,distanceInterval:s,isCustomInterval:o}=i,a=t.h,l=e.h,c=2*Math.PI;let u;if(a<=l){const w=l-a,x=l-a-c;u=Math.abs(x)<Math.abs(w)?x:w}else{const w=l+c-a,x=l-a;u=Math.abs(x)<Math.abs(w)?x:w}const d=u*s,f=(e.l-t.l)*s,m=(e.c-t.c)*s;let{l:g,c:y,h:_}=t;if(r){const w=r/s;g+=w*f,y+=w*m,_=(_+w*d+c)%c}const b=[];for(let w=0;w<n-1;w++)b.push({l:g,c:y,h:_}),g+=f,y+=m,_=(_+d+c)%c;return b.push(o?{l:g,c:y,h:_}:e),b}function cle(t,e){let{fromColor:i,toColor:n}=t;i=[...i],n=[...n],i.length===3&&(i=i.concat([255])),n.length===3&&(n=n.concat([255]));const r=t.algorithm||"esriCIELabAlgorithm",s=lle(e),{numColors:o,distanceOffset:a,isCustomInterval:l,interpolateAlpha:c}=s;if(o===1&&a===0)return[i];if(o===2&&a===0&&!l)return[i,n];const u={r:i[0],g:i[1],b:i[2]},d={r:n[0],g:n[1],b:n[2]},f=r==="esriCIELabAlgorithm"?TDe(cH(u),cH(d),s):r==="esriHSVAlgorithm"?SDe(Hy(u),Hy(d),s):IDe(uH(u),uH(d),s),m=[],g=i[3]??255,y=((n[3]??255)-g)/(o-1);for(let _=0;_<o;_++){const{r:b,g:w,b:x}=Bf(f[_]),S=c?Math.round(g+y*_):255;m.push([b,w,x,S])}return m}function CDe(t,e){const{numColors:i,interpolateAlpha:n}=lle(e);let r=e==null?void 0:e.weights;const{colorRamps:s}=t;if(r){const f=r.reduce((m,g)=>m+g);r=r.map(m=>m/f)}else{r=[];for(let f=0;f<s.length;f++)r[f]=1/s.length}const o=[];let a=0,l=0;const c=1/(i-1);let u=!1;for(let f=0;f<s.length;f++){let m=u?0:a*c-l,g=f===s.length-1?i-1-a:(r[f]-m)/c;if(u=Math.ceil(g)===g,g=Math.ceil(g),g===0)continue;m/=r[f];const y=cle(s[f],{numColors:g,interpolateAlpha:n,distanceOffset:m,distanceInterval:c/r[f]});a+=y.length,o.push(...y),l+=r[f]}const d=[...s[s.length-1].toColor];return d.length===3&&d.push(255),o.push(d),o}function xj(t,e){const i="toJSON"in t?t.toJSON():t;return i.type==="multipart"?CDe(i,e):cle(i,e)}function qy(t,e){const i=xj(t,e),n=e==null?void 0:e.interpolateAlpha;return i.forEach((r,s)=>{r.unshift(s),n||r.pop()}),i}function pH(t){const e=Hy(t);return{type:"HsvColor",Hue:e.h,Saturation:e.s,Value:e.v,AlphaValue:255}}function fH(t){const e=t.toJSON();return{Algorithm:(e==null?void 0:e.Algorithm)||"esriHSVAlgorithm",type:"AlgorithmicColorRamp",FromColor:pH(t.fromColor),ToColor:pH(t.toColor)}}function Ppt(t){const e=wDe(t);if(!e)return null;if(t.type==="algorithmic")return{...fH(t),Name:e};if(t.colorRamps){const i=t.colorRamps.map(fH);return{type:"MultiPartColorRamp",NumColorRamps:i.length,ArrayOfColorRamp:i,Name:e}}return null}function kpt(t){const e=t.reverse().map(i=>{const n=i.toString(16);return n.length<2?"0"+n:n});return 4294967295&Number.parseInt(e.join(""),16)}var ex;let tx=ex=class extends ie{constructor(t){super(t),this.colormapInfos=null,this.type="raster-colormap"}static createFromColormap(t,e){if(!t)return null;const i=t[0].length===5,n=[...t].sort((r,s)=>r[0]-s[0]).map(r=>ele.fromJSON({value:r[0],color:i?r.slice(1,5):r.slice(1,4).concat([255]),label:e?e[r[0]]??"":r[0]}));return new ex({colormapInfos:n})}static createFromColorramp(t){const e=qy(t);return ex.createFromColormap(e)}clone(){return new ex({colormapInfos:this.colormapInfos.map(t=>t.toJSON())})}extractColormap(){return this.colormapInfos.map(({value:t,color:e})=>[t,e.r,e.g,e.b,e.a>1?e.a:255*e.a&255]).sort((t,e)=>t[0]-e[0])}};h([p({type:[ele],json:{write:!0}})],tx.prototype,"colormapInfos",void 0),h([be({rasterColormap:"raster-colormap"})],tx.prototype,"type",void 0),tx=ex=h([P("esri.renderers.RasterColormapRenderer")],tx);const Sj=tx;var HN;let Ko=HN=class extends ie{constructor(t){super(t),this.altitude=45,this.azimuth=315,this.colorRamp=null,this.hillshadeType="traditional",this.pixelSizePower=.664,this.pixelSizeFactor=.024,this.scalingType="none",this.type="raster-shaded-relief",this.zFactor=1}readColorRamp(t){return VP(t)}clone(){return new HN({hillshadeType:this.hillshadeType,altitude:this.altitude,azimuth:this.azimuth,zFactor:this.zFactor,scalingType:this.scalingType,pixelSizeFactor:this.pixelSizeFactor,pixelSizePower:this.pixelSizePower,colorRamp:q(this.colorRamp)})}};h([p({type:Number,json:{write:!0}})],Ko.prototype,"altitude",void 0),h([p({type:Number,json:{write:!0}})],Ko.prototype,"azimuth",void 0),h([p({types:zP,json:{write:!0}})],Ko.prototype,"colorRamp",void 0),h([_e("colorRamp")],Ko.prototype,"readColorRamp",null),h([p({type:["traditional","multi-directional"],json:{write:!0}})],Ko.prototype,"hillshadeType",void 0),h([p({type:Number,json:{write:!0}})],Ko.prototype,"pixelSizePower",void 0),h([p({type:Number,json:{write:!0}})],Ko.prototype,"pixelSizeFactor",void 0),h([p({type:["none","adjusted"],json:{write:!0}})],Ko.prototype,"scalingType",void 0),h([be({rasterShadedRelief:"raster-shaded-relief"})],Ko.prototype,"type",void 0),h([p({type:Number,json:{write:!0}})],Ko.prototype,"zFactor",void 0),Ko=HN=h([P("esri.renderers.RasterShadedReliefRenderer")],Ko);const ule=Ko,HM=new qe({none:"none",standardDeviation:"standard-deviation",histogramEqualization:"histogram-equalization",minMax:"min-max",percentClip:"percent-clip",sigmoid:"sigmoid"}),hle={0:"none",3:"standardDeviation",4:"histogramEqualization",5:"minMax",6:"percentClip",9:"sigmoid"};var qN;let Pn=qN=class extends ie{constructor(t){super(t),this.colorRamp=null,this.computeGamma=!1,this.dynamicRangeAdjustment=!1,this.gamma=[],this.maxPercent=null,this.minPercent=null,this.numberOfStandardDeviations=null,this.outputMax=null,this.outputMin=null,this.sigmoidStrengthLevel=null,this.statistics=[],this.histograms=null,this.useGamma=!1,this.stretchType="none",this.type="raster-stretch"}readColorRamp(t){if(t)return VP(t)}writeStatistics(t,e,i){t!=null&&t.length&&(Array.isArray(t[0])||(t=t.map(n=>[n.min,n.max,n.avg,n.stddev])),e[i]=t)}readStretchType(t,e){let i=e.stretchType;return typeof i=="number"&&(i=hle[i]),HM.read(i)}clone(){return new qN({stretchType:this.stretchType,outputMin:this.outputMin,outputMax:this.outputMax,useGamma:this.useGamma,computeGamma:this.computeGamma,statistics:q(this.statistics),gamma:q(this.gamma),sigmoidStrengthLevel:this.sigmoidStrengthLevel,numberOfStandardDeviations:this.numberOfStandardDeviations,minPercent:this.minPercent,maxPercent:this.maxPercent,colorRamp:q(this.colorRamp),histograms:q(this.histograms),dynamicRangeAdjustment:this.dynamicRangeAdjustment})}};h([p({types:zP,json:{write:!0}})],Pn.prototype,"colorRamp",void 0),h([_e("colorRamp")],Pn.prototype,"readColorRamp",null),h([p({type:Boolean,json:{write:!0}})],Pn.prototype,"computeGamma",void 0),h([p({type:Boolean,json:{write:{target:"dra"},read:{source:"dra"}}})],Pn.prototype,"dynamicRangeAdjustment",void 0),h([p({type:[Number],json:{write:!0}})],Pn.prototype,"gamma",void 0),h([p({type:Number,json:{write:!0}})],Pn.prototype,"maxPercent",void 0),h([p({type:Number,json:{write:!0}})],Pn.prototype,"minPercent",void 0),h([p({type:Number,json:{write:!0}})],Pn.prototype,"numberOfStandardDeviations",void 0),h([p({type:Number,json:{read:{source:"max"},write:{target:"max"}}})],Pn.prototype,"outputMax",void 0),h([p({type:Number,json:{read:{source:"min"},write:{target:"min"}}})],Pn.prototype,"outputMin",void 0),h([p({type:Number,json:{write:!0}})],Pn.prototype,"sigmoidStrengthLevel",void 0),h([p({json:{type:[[Number]],write:!0}})],Pn.prototype,"statistics",void 0),h([p()],Pn.prototype,"histograms",void 0),h([ge("statistics")],Pn.prototype,"writeStatistics",null),h([p({type:Boolean,json:{write:!0}})],Pn.prototype,"useGamma",void 0),h([p({type:HM.apiValues,json:{type:HM.jsonValues,write:HM.write}})],Pn.prototype,"stretchType",void 0),h([_e("stretchType",["stretchType"])],Pn.prototype,"readStretchType",null),h([be({rasterStretch:"raster-stretch"})],Pn.prototype,"type",void 0),Pn=qN=h([P("esri.renderers.RasterStretchRenderer")],Pn);const Tj=Pn,RI={102100:{maxX:20037508342788905e-9,minX:-20037508342788905e-9,plus180Line:new Ms({paths:[[[20037508342788905e-9,-20037508342788905e-9],[20037508342788905e-9,20037508342788905e-9]]],spatialReference:Ee.WebMercator}),minus180Line:new Ms({paths:[[[-20037508342788905e-9,-20037508342788905e-9],[-20037508342788905e-9,20037508342788905e-9]]],spatialReference:Ee.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new Ms({paths:[[[180,-180],[180,180]]],spatialReference:Ee.WGS84}),minus180Line:new Ms({paths:[[[-180,-180],[-180,180]]],spatialReference:Ee.WGS84})}};function cy(t,e){return Math.ceil((t-e)/(2*e))}function dle(t,e){const i=Jx(t);for(const n of i)for(const r of n)r[0]+=e;return t}function Jx(t){return $_(t)?t.rings:t.paths}function cT(t,e){return e?{...e,query:{...t??{},...e.query}}:{query:t}}function e1(t){return typeof t=="string"?ir(t):q(t)}function uT(t,e,i){const n={};for(const r in t){if(r==="declaredClass")continue;const s=t[r];if(s!=null&&typeof s!="function")if(Array.isArray(s)){n[r]=[];for(let o=0;o<s.length;o++)n[r][o]=uT(s[o])}else if(typeof s=="object")if(s.toJSON){const o=s.toJSON(i&&i[r]);n[r]=e?o:JSON.stringify(o)}else n[r]=e?s:JSON.stringify(s);else n[r]=s}return n}async function MDe(t,e,i,n){const r=e1(t),s=e[0].spatialReference,o={...n,query:{...r.query,f:"json",sr:JSON.stringify(s),target:JSON.stringify({geometryType:Db(e[0]),geometries:e}),cutter:JSON.stringify(i)}},a=await gt(r.path+"/cut",o),{cutIndexes:l,geometries:c=[]}=a.data;return{cutIndexes:l,geometries:c.map(u=>{const d=ad(u);return d.spatialReference=s,d})}}function EDe(t){return{geometryType:Db(t[0]),geometries:t.map(e=>e.toJSON())}}function ple(t,e,i){const n=_we(e);return t.map(r=>{const s=n.fromJSON(r);return s.spatialReference=i,s})}async function ADe(t,e,i){const n=typeof t=="string"?ir(t):t,r=e[0].spatialReference,s=Db(e[0]),o={...i,query:{...n.query,f:"json",sr:r.wkid??JSON.stringify(r),geometries:JSON.stringify(EDe(e))}},{data:a}=await gt(n.path+"/simplify",o);return ple(a.geometries,s,r)}const fle=ne.getLogger("esri.geometry.support.normalizeUtils");function $De(t){return t.type==="polygon"}function PDe(t){return t[0].type==="polygon"}function kDe(t){return t[0].type==="polyline"}function ODe(t,e){if(!(t instanceof Ms||t instanceof Vr)){const r="straightLineDensify: the input geometry is neither polyline nor polygon";throw fle.error(r),new V(r)}const i=Jx(t),n=[];for(const r of i){const s=[];n.push(s),s.push([r[0][0],r[0][1]]);for(let o=0;o<r.length-1;o++){const a=r[o][0],l=r[o][1],c=r[o+1][0],u=r[o+1][1],d=Math.sqrt((c-a)*(c-a)+(u-l)*(u-l)),f=(u-l)/d,m=(c-a)/d,g=d/e;if(g>1){for(let w=1;w<=g-1;w++){const x=w*e,S=m*x+a,T=f*x+l;s.push([S,T])}const y=(d+Math.floor(g-1)*e)/2,_=m*y+a,b=f*y+l;s.push([_,b])}s.push([c,u])}}return $De(t)?new Vr({rings:n,spatialReference:t.spatialReference}):new Ms({paths:n,spatialReference:t.spatialReference})}function mH(t,e,i){if(e){const n=ODe(t,1e6);t=ny(n,!0)}return i&&(t=dle(t,i)),t}function gH(t,e,i){if(Array.isArray(t)){const n=t[0];if(n>e){const r=cy(n,e);t[0]=n+r*(-2*e)}else if(n<i){const r=cy(n,i);t[0]=n+r*(-2*i)}}else{const n=t.x;if(n>e){const r=cy(n,e);t=t.clone().offset(r*(-2*e),0)}else if(n<i){const r=cy(n,i);t=t.clone().offset(r*(-2*i),0)}}return t}function LDe(t,e){let i=-1;for(let n=0;n<e.cutIndexes.length;n++){const r=e.cutIndexes[n],s=e.geometries[n],o=Jx(s);for(let a=0;a<o.length;a++){const l=o[a];l.some(c=>{if(c[0]<180)return!0;{let u=0;for(let f=0;f<l.length;f++){const m=l[f][0];u=m>u?m:u}u=Number(u.toFixed(9));const d=-360*cy(u,180);for(let f=0;f<l.length;f++){const m=s.getPoint(a,f);s.setPoint(a,f,m.clone().offset(d,0))}return!0}})}if(r===i){if(PDe(t))for(const a of Jx(s))t[r]=t[r].addRing(a);else if(kDe(t))for(const a of Jx(s))t[r]=t[r].addPath(a)}else i=r,t[r]=s}return t}async function mle(t,e,i){if(!Array.isArray(t))return mle([t],e);e&&typeof e!="string"&&fle.warn("normalizeCentralMeridian()","The url object is deprecated, use the url string instead");const n=typeof e=="string"?e:(e==null?void 0:e.url)??Tt.geometryServiceUrl;let r,s,o,a,l,c,u,d,f=0;const m=[],g=[];for(const S of t)if(S!=null)if(r||(r=S.spatialReference,s=to(r),o=r.isWebMercator,c=o?102100:4326,a=RI[c].maxX,l=RI[c].minX,u=RI[c].plus180Line,d=RI[c].minus180Line),s)if(S.type==="mesh")g.push(S);else if(S.type==="point")g.push(gH(S.clone(),a,l));else if(S.type==="multipoint"){const T=S.clone();T.points=T.points.map(I=>gH(I,a,l)),g.push(T)}else if(S.type==="extent"){const T=S.clone()._normalize(!1,!1,s);g.push(T.rings?new Vr(T):T)}else if(S.extent){const T=S.extent,I=cy(T.xmin,l)*(2*a);let C=I===0?S.clone():dle(S.clone(),I);T.offset(I,0),T.intersects(u)&&T.xmax!==a?(f=T.xmax>f?T.xmax:f,C=mH(C,o),m.push(C),g.push("cut")):T.intersects(d)&&T.xmin!==l?(f=T.xmax*(2*a)>f?T.xmax*(2*a):f,C=mH(C,o,360),m.push(C),g.push("cut")):g.push(C)}else g.push(S.clone());else g.push(S);else g.push(S);let y=cy(f,a),_=-90;const b=y,w=new Ms;for(;y>0;){const S=360*y-180;w.addPath([[S,_],[S,-1*_]]),_*=-1,y--}if(m.length>0&&b>0){const S=LDe(m,await MDe(n,m,w,i)),T=[],I=[];for(let E=0;E<g.length;E++){const A=g[E];if(A!=="cut")I.push(A);else{const $=S.shift(),L=t[E];L!=null&&L.type==="polygon"&&L.rings&&L.rings.length>1&&$.rings.length>=L.rings.length?(T.push($),I.push("simplify")):I.push(o?qh($):$)}}if(!T.length)return I;const C=await ADe(n,T,i),M=[];for(let E=0;E<I.length;E++){const A=I[E];A!=="simplify"?M.push(A):M.push(o?qh(C.shift()):C.shift())}return M}const x=[];for(let S=0;S<g.length;S++){const T=g[S];if(T!=="cut")x.push(T);else{const I=m.shift();x.push(o===!0?qh(I):I)}}return x}function Opt(t,e){const i=to(e);if(i){const[n,r]=i.valid,s=r-n;if(t<n)for(;t<n;)t+=s;if(t>r)for(;t>r;)t-=s}return t}let yH=class{constructor(e=null,i=null,n=null){this.minValue=e,this.maxValue=i,this.noDataValue=n}};const RDe=9999999e31,DDe=2e-7,NDe={u1:[0,1],u2:[0,3],u4:[0,15],u8:[0,255],s8:[-128,127],u16:[0,65535],s16:[-32768,32767],u32:[0,4294967295],s32:[-2147483648,2147483647],f32:[-34028234663852886e22,34028234663852886e22],f64:[-Number.MAX_VALUE,Number.MAX_VALUE],unknown:void 0,c64:void 0,c128:void 0};function Ac(t){return NDe[t]??[-34028234663852886e22,34028234663852886e22]}function KP(t,e,i){if(t.depthCount&&t.depthCount>1)return;const{pixels:n,statistics:r,pixelType:s}=t,o=n[0].length,a=t.bandMasks??[],l=t.mask??new Uint8Array(o).fill(255),c=s==="f32"||s==="f64",u=Ac(s);let d=!1;for(let f=0;f<n.length;f++){const m=typeof e=="number"?e:e[f];if(m==null)continue;const g=(r==null?void 0:r[f].minValue)??u[0],y=(r==null?void 0:r[f].maxValue)??u[1];if(g>m+Number.EPSILON||y<m-Number.EPSILON)continue;const _=a[f]||new Uint8Array(o).fill(255),b=n[f],w=i==null?void 0:i.customFloatTolerance;if(c&&w!==0){let x=w;x||(x=Math.abs(m)>=RDe?DDe*Math.abs(m):s==="f32"?2**-23:Number.EPSILON);for(let S=0;S<b.length;S++)_[S]&&Math.abs(b[S]-m)<x&&(b[S]=0,_[S]=0,l[S]=0,d=!0)}else for(let x=0;x<b.length;x++)_[x]&&b[x]===m&&(b[x]=0,_[x]=0,l[x]=0,d=!0);a[f]=_}d&&(t.bandMasks=a,t.mask=l),d&&"updateStatistics"in t&&t.updateStatistics()}var hg;let _s=hg=class extends ie{static createEmptyBand(t,e){return new(hg.getPixelArrayConstructor(t))(e)}static getPixelArrayConstructor(t){let e;switch(t){case"u1":case"u2":case"u4":case"u8":e=Uint8Array;break;case"u16":e=Uint16Array;break;case"u32":e=Uint32Array;break;case"s8":e=Int8Array;break;case"s16":e=Int16Array;break;case"s32":e=Int32Array;break;case"f32":case"c64":case"c128":case"unknown":e=Float32Array;break;case"f64":e=Float64Array}return e}constructor(t){super(t),this.width=null,this.height=null,this.pixelType="f32",this.validPixelCount=null,this.mask=null,this.maskIsAlpha=!1,this.premultiplyAlpha=!1,this.statistics=null,this.depthCount=1}castPixelType(t){if(!t)return"f32";let e=t.toLowerCase();return["u1","u2","u4"].includes(e)?e="u8":["unknown","u8","s8","u16","s16","u32","s32","f32","f64"].includes(e)||(e="f32"),e}getPlaneCount(){var t;return(t=this.pixels)==null?void 0:t.length}addData(t){if(!t.pixels||t.pixels.length!==this.width*this.height)throw new V("pixelblock:invalid-or-missing-pixels","add data requires valid pixels array that has same length defined by pixel block width * height");this.pixels||(this.pixels=[]),this.statistics||(this.statistics=[]),this.pixels.push(t.pixels),this.statistics.push(t.statistics??new yH)}getAsRGBA(){const t=new ArrayBuffer(this.width*this.height*4);switch(this.pixelType){case"s8":case"s16":case"u16":case"s32":case"u32":case"f32":case"f64":this._fillFromNon8Bit(t);break;default:this._fillFrom8Bit(t)}return new Uint8ClampedArray(t)}getAsRGBAFloat(){const t=new Float32Array(this.width*this.height*4);return this._fillFrom32Bit(t),t}updateStatistics(){if(!this.pixels)return;this.statistics=this.pixels.map(i=>this._calculateBandStatistics(i,this.mask));const t=this.mask;let e=0;if(t!=null)for(let i=0;i<t.length;i++)t[i]&&e++;else e=this.width*this.height;this.validPixelCount=e}clamp(t){if(!t||t==="f64"||t==="f32"||!this.pixels)return;const[e,i]=Ac(t),n=this.pixels,r=this.width*this.height,s=n.length;let o,a,l;const c=[];for(let u=0;u<s;u++){l=hg.createEmptyBand(t,r),o=n[u];for(let d=0;d<r;d++)a=o[d],l[d]=a>i?i:a<e?e:a;c.push(l)}this.pixels=c,this.pixelType=t}extractBands(t){var d;const{pixels:e,statistics:i}=this;if(t==null||t.length===0||!e||e.length===0)return this;const n=e.length,r=t.some(f=>f>=e.length),s=n===t.length&&!t.some((f,m)=>f!==m);if(r||s)return this;const o=((d=this.bandMasks)==null?void 0:d.length)===n?t.map(f=>this.bandMasks[f]):void 0;let{mask:a,validPixelCount:l}=this;const{width:c,height:u}=this;if(o){if(o.length===1)a=o[0];else{const f=c*u;a=new Uint8Array(f).fill(255);for(let m=0;m<o.length;m++){const g=o[m];for(let y=0;y<f;y++)g[y]||(a[y]=0)}}l=a.filter(f=>!!f).length}return new hg({pixelType:this.pixelType,width:c,height:u,mask:a,bandMasks:o,validPixelCount:l,maskIsAlpha:this.maskIsAlpha,pixels:t.map(f=>e[f]),statistics:i&&t.map(f=>i[f])})}clone(){const t=new hg({width:this.width,height:this.height,pixelType:this.pixelType,maskIsAlpha:this.maskIsAlpha,validPixelCount:this.validPixelCount});let e;this.mask!=null&&(this.mask instanceof Uint8Array?t.mask=new Uint8Array(this.mask):t.mask=this.mask.slice(0)),this.bandMasks&&(t.bandMasks=this.bandMasks.map(n=>new Uint8Array(n)));const i=hg.getPixelArrayConstructor(this.pixelType);if(this.pixels&&this.pixels.length>0){t.pixels=[];const n=!!this.pixels[0].slice;for(e=0;e<this.pixels.length;e++)t.pixels[e]=n?this.pixels[e].slice(0,this.pixels[e].length):new i(this.pixels[e])}if(this.statistics)for(t.statistics=[],e=0;e<this.statistics.length;e++)t.statistics[e]=q(this.statistics[e]);return t.premultiplyAlpha=this.premultiplyAlpha,t}_fillFrom8Bit(t){const{mask:e,maskIsAlpha:i,premultiplyAlpha:n,pixels:r}=this;if(!t||!r||!r.length)return void ne.getLogger(this).error("getAsRGBA()","Unable to convert to RGBA. The input pixel block is empty.");let s,o,a,l;s=o=a=r[0],r.length>=3?(o=r[1],a=r[2]):r.length===2&&(o=r[1]);const c=new Uint32Array(t),u=this.width*this.height;if(s.length===u)if(e!=null&&e.length===u)if(i)for(l=0;l<u;l++){const d=e[l];if(d){const f=d/255;c[l]=n?d<<24|a[l]*f<<16|o[l]*f<<8|s[l]*f:d<<24|a[l]<<16|o[l]<<8|s[l]}}else for(l=0;l<u;l++)e[l]&&(c[l]=255<<24|a[l]<<16|o[l]<<8|s[l]);else for(l=0;l<u;l++)c[l]=255<<24|a[l]<<16|o[l]<<8|s[l];else ne.getLogger(this).error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.")}_fillFromNon8Bit(t){const{pixels:e,mask:i,statistics:n}=this;if(!t||!e||!e.length)return void ne.getLogger(this).error("getAsRGBA()","Unable to convert to RGBA. The input pixel block is empty.");const r=this.pixelType;let s=1,o=0,a=1;if(n&&n.length>0){for(const y of n)if(y.minValue!=null&&(o=Math.min(o,y.minValue)),y.maxValue!=null&&y.minValue!=null){const _=y.maxValue-y.minValue;a=Math.max(a,_)}s=255/a}else{let y=255;r==="s8"?(o=-128,y=127):r==="u16"?y=65535:r==="s16"?(o=-32768,y=32767):r==="u32"?y=4294967295:r==="s32"?(o=-2147483648,y=2147483647):r==="f32"?(o=-34e38,y=34e38):r==="f64"&&(o=-Number.MAX_VALUE,y=Number.MAX_VALUE),s=255/(y-o)}const l=new Uint32Array(t),c=this.width*this.height;let u,d,f,m,g;if(u=d=f=e[0],u.length!==c)return ne.getLogger(this).error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.");if(e.length>=2)if(d=e[1],e.length>=3&&(f=e[2]),i!=null&&i.length===c)for(m=0;m<c;m++)i[m]&&(l[m]=255<<24|(f[m]-o)*s<<16|(d[m]-o)*s<<8|(u[m]-o)*s);else for(m=0;m<c;m++)l[m]=255<<24|(f[m]-o)*s<<16|(d[m]-o)*s<<8|(u[m]-o)*s;else if(i!=null&&i.length===c)for(m=0;m<c;m++)g=(u[m]-o)*s,i[m]&&(l[m]=255<<24|g<<16|g<<8|g);else for(m=0;m<c;m++)g=(u[m]-o)*s,l[m]=255<<24|g<<16|g<<8|g}_fillFrom32Bit(t){const{pixels:e,mask:i}=this;if(!t||!e||!e.length)return ne.getLogger(this).error("getAsRGBAFloat()","Unable to convert to RGBA. The input pixel block is empty.");let n,r,s,o;n=r=s=e[0],e.length>=3?(r=e[1],s=e[2]):e.length===2&&(r=e[1]);const a=this.width*this.height;if(n.length!==a)return ne.getLogger(this).error("getAsRGBAFloat()","Unable to convert to RGBA. The pixelblock is invalid.");let l=0;if(i!=null&&i.length===a)for(o=0;o<a;o++)t[l++]=n[o],t[l++]=r[o],t[l++]=s[o],t[l++]=1&i[o];else for(o=0;o<a;o++)t[l++]=n[o],t[l++]=r[o],t[l++]=s[o],t[l++]=1}_calculateBandStatistics(t,e){let i=1/0,n=-1/0;const r=t.length;let s,o=0;if(e!=null)for(s=0;s<r;s++)e[s]&&(o=t[s],i=o<i?o:i,n=o>n?o:n);else for(s=0;s<r;s++)o=t[s],i=o<i?o:i,n=o>n?o:n;return new yH(i,n)}};h([p({json:{write:!0}})],_s.prototype,"width",void 0),h([p({json:{write:!0}})],_s.prototype,"height",void 0),h([p({json:{write:!0}})],_s.prototype,"pixelType",void 0),h([ut("pixelType")],_s.prototype,"castPixelType",null),h([p({json:{write:!0}})],_s.prototype,"validPixelCount",void 0),h([p({json:{write:!0}})],_s.prototype,"mask",void 0),h([p({json:{write:!0}})],_s.prototype,"maskIsAlpha",void 0),h([p({json:{write:!0}})],_s.prototype,"pixels",void 0),h([p()],_s.prototype,"premultiplyAlpha",void 0),h([p({json:{write:!0}})],_s.prototype,"statistics",void 0),h([p({json:{write:!0}})],_s.prototype,"depthCount",void 0),h([p({json:{write:!0}})],_s.prototype,"noDataValues",void 0),h([p({json:{write:!0}})],_s.prototype,"bandMasks",void 0),_s=hg=h([P("esri.layers.support.PixelBlock")],_s);const ue=_s;var jA,BA;(function(t){t[t.matchAny=0]="matchAny",t[t.matchAll=1]="matchAll"})(jA||(jA={})),function(t){t[t.bestMatch=0]="bestMatch",t[t.fail=1]="fail"}(BA||(BA={}));const kh=6;function Ci(t){return t!=null&&t.declaredClass==="esri.layers.support.PixelBlock"&&t.pixels&&t.pixels.length>0}function FDe(t){var u;if(!(t!=null&&t.length)||t.some(d=>!Ci(d)))return null;if(t.length===1)return((u=t[0])==null?void 0:u.clone())??null;const e=t,{width:i,height:n,pixelType:r}=e[0];if(e.some(d=>d.width!==i||d.height!==n))return null;const s=e.map(({mask:d})=>d).filter(d=>d!=null);let o=null;s.length&&(o=new Uint8Array(i*n),o.set(s[0]),s.length>1&&gle(s.slice(1),o));const a=[];e.forEach(({pixels:d})=>a.push(...d));const l=e.map(({statistics:d})=>d).filter(d=>d==null?void 0:d.length),c=[];return l.forEach(d=>c.push(...d)),new ue({pixelType:r,width:i,height:n,mask:o,pixels:a,statistics:c.length?c:null})}function k1(t){if(!t)return;const e=t.colormap;if(!e||e.length===0)return;const i=e.sort((d,f)=>d[0]-f[0]);let n=0;i[0][0]<0&&(n=i[0][0]);const r=Math.max(256,i[i.length-1][0]-n+1),s=new Uint8Array(4*r),o=[];let a,l=0,c=0;const u=i[0].length===5;if(r>65536)return i.forEach(d=>{o[d[0]-n]=u?d.slice(1):d.slice(1).concat([255])}),{indexed2DColormap:o,offset:n,alphaSpecified:u};if(t.fillUnspecified)for(a=i[c],l=a[0]-n;l<r;l++)s[4*l]=a[1],s[4*l+1]=a[2],s[4*l+2]=a[3],s[4*l+3]=u?a[4]:255,l===a[0]-n&&(a=c===i.length-1?a:i[++c]);else for(l=0;l<i.length;l++)a=i[l],c=4*(a[0]-n),s[c]=a[1],s[c+1]=a[2],s[c+2]=a[3],s[c+3]=u?a[4]:255;return{indexedColormap:s,offset:n,alphaSpecified:u}}function mO(t,e){if(!Ci(t)||!e||!e.indexedColormap&&!e.indexed2DColormap)return t;const i=t.clone(),n=i.pixels;let r=i.mask;const s=i.width*i.height;if(n.length!==1)return t;const{indexedColormap:o,indexed2DColormap:a,offset:l,alphaSpecified:c}=e;let u=0;const d=n[0],f=new Uint8Array(d.length),m=new Uint8Array(d.length),g=new Uint8Array(d.length);let y,_=0;if(o){const b=o.length-1;if(r!=null)for(u=0;u<s;u++)r[u]&&(_=4*(d[u]-l),_<l||_>b?r[u]=0:(f[u]=o[_],m[u]=o[_+1],g[u]=o[_+2],r[u]=o[_+3]));else{for(r=new Uint8Array(s),u=0;u<s;u++)_=4*(d[u]-l),_<l||_>b?r[u]=0:(f[u]=o[_],m[u]=o[_+1],g[u]=o[_+2],r[u]=o[_+3]);i.mask=r}}else if(a)if(r!=null)for(u=0;u<s;u++)r[u]&&(y=a[d[u]],f[u]=y[0],m[u]=y[1],g[u]=y[2],r[u]=y[3]);else{for(r=new Uint8Array(s),u=0;u<s;u++)y=a[d[u]],f[u]=y[0],m[u]=y[1],g[u]=y[2],r[u]=y[3];i.mask=r}return i.pixels=[f,m,g],i.statistics=null,i.pixelType="u8",i.maskIsAlpha=c,i}function UA(t,e){if(!Ci(t))return null;const{pixels:i,mask:n}=t,r=i.length;let s=e.lut;const{offset:o}=e;s&&s[0].length===1&&(s=i.map(()=>s));const a=[],l=e.outputPixelType||"u8";for(let u=0;u<r;u++){const d=Ij(i[u],n,s[u],o||0,l);a.push(d)}const c=new ue({width:t.width,height:t.height,pixels:a,mask:n,pixelType:l});return c.updateStatistics(),c}function Ij(t,e,i,n,r){const s=t.length,o=ue.createEmptyBand(r,s);if(e)for(let a=0;a<s;a++)e[a]&&(o[a]=i[t[a]-n]);else for(let a=0;a<s;a++)o[a]=i[t[a]-n];return o}function zDe(t,e){if(!Ci(t))return null;const i=t.clone(),{pixels:n}=i,r=i.width*i.height,s=e.length,o=Math.floor(s/2),a=e[Math.floor(o)],l=n[0];let c,u,d,f,m,g,y=!1;const _=new Uint8Array(r),b=new Uint8Array(r),w=new Uint8Array(r);let x=i.mask;const S=e[0].mappedColor.length===4;for(x||(x=new Uint8Array(r),x.fill(S?255:1),i.mask=x),m=0;m<r;m++)if(x[m]){for(c=l[m],y=!1,g=o,u=a,d=0,f=s-1;f-d>1;){if(c===u.value){y=!0;break}c>u.value?d=g:f=g,g=Math.floor((d+f)/2),u=e[Math.floor(g)]}y||(c===e[d].value?(u=e[d],y=!0):c===e[f].value?(u=e[f],y=!0):c<e[d].value?(y=!1,u=null):c>e[d].value&&(c<e[f].value?(u=e[d],y=!0):f===s-1?(y=!1,u=null):(u=e[f],y=!0))),y?(_[m]=u.mappedColor[0],b[m]=u.mappedColor[1],w[m]=u.mappedColor[2],x[m]=u.mappedColor[3]):_[m]=b[m]=w[m]=x[m]=0}return i.pixels=[_,b,w],i.mask=x,i.pixelType="u8",i.maskIsAlpha=S,i}function VDe(t,e){if(!Ci(t))return null;const{width:i,height:n}=t,{inputRanges:r,outputValues:s,outputPixelType:o,noDataRanges:a,allowUnmatched:l,isLastInputRangeInclusive:c}=e,u=t.pixels[0],d=ue.createEmptyBand(o,u.length),f=t.mask,m=new Uint8Array(i*n);f?m.set(f):m.fill(255);const g=t.pixelType.startsWith("f")?1e-6:0,y=r.map(S=>S-g);y[0]=r[0],y[y.length-1]=r[r.length-1]+(c?1e-6:0);const _=r.length/2,[b,w]=Ac(o);for(let S=0;S<n;S++)for(let T=0;T<i;T++){const I=S*i+T;if(m[I]){const C=u[I];let M=!1;for(let E=_-1;E>=0;E--)if(C===y[2*E]||C>y[2*E]&&C<y[2*E+1]){d[I]=s[E],M=!0;break}M||(l?d[I]=C>w?w:C<b?b:C:m[I]=0)}}const x=a==null?void 0:a.length;if(x)for(let S=0;S<n;S++)for(let T=0;T<i;T++){const I=S*i+T;if(!f||f[I]){const C=u[I];for(let M=0;M<x;M+=2)if(C>=a[M]&&C<=a[M+1]){d[I]=0,m[I]=0;break}}}return new ue({width:i,height:n,pixelType:o,pixels:[d],mask:m})}function vH(t,e,i,n){const r=i!=null&&i.length>=2?new Set(i):null,s=(i==null?void 0:i.length)===1?i[0]:null,o=!!(e!=null&&e.length);for(let a=0;a<t.length;a++)if(n[a]){const l=t[a];if(o){let c=!1;for(let u=0;u<e.length;u+=2)if(l>=e[u]&&l<=e[u+1]){c=!0;break}c||(n[a]=0)}n[a]&&(l===s||r!=null&&r.has(l))&&(n[a]=0)}}function _H(t,e){const i=t[0].length;for(let n=0;n<i;n++)if(e[n]){let r=!1;for(let s=0;s<t.length;s++)if(t[s][n]){r=!0;break}r||(e[n]=0)}}function gle(t,e){const i=t[0].length;for(let n=0;n<i;n++)if(e[n]){let r=!1;for(let s=0;s<t.length;s++)if(t[s][n]===0){r=!0;break}r&&(e[n]=0)}}function jDe(t,e){if(!Ci(t))return null;const{width:i,height:n,pixels:r}=t,s=i*n,o=new Uint8Array(s);t.mask?o.set(t.mask):o.fill(255);const a=r.length,{includedRanges:l,noDataValues:c,outputPixelType:u,matchAll:d,lookups:f}=e;if(f){const m=[];for(let g=0;g<a;g++){const y=f[g],_=Ij(r[g],o,y.lut,y.offset||0,"u8");m.push(_)}m.length===1?o.set(m[0]):d?_H(m,o):gle(m,o)}else if(d){const m=[];for(let g=0;g<a;g++){const y=new Uint8Array(s);y.set(o),vH(r[g],l==null?void 0:l.slice(2*g,2*g+2),c==null?void 0:c[g],y),m.push(y)}m.length===1?o.set(m[0]):_H(m,o)}else for(let m=0;m<a;m++)vH(r[m],l==null?void 0:l.slice(2*m,2*m+2),c==null?void 0:c[m],o);return new ue({width:i,height:n,pixelType:u,pixels:r,mask:o})}function BDe(t){const{srcPixelType:e,inputRanges:i,outputValues:n,allowUnmatched:r,noDataRanges:s,isLastInputRangeInclusive:o,outputPixelType:a}=t;if(e!=="u8"&&e!=="s8"&&e!=="u16"&&e!=="s16")return null;const l=e.includes("16")?65536:256,c=e.includes("s")?-l/2:0,u=ue.createEmptyBand(a,l),d=new Uint8Array(l);r&&d.fill(255);const[f,m]=Ac(a);if(i!=null&&i.length&&(n!=null&&n.length)){const y=i.map(_=>_-1e-6);y[0]=i[0],o&&(y[y.length-1]=i[i.length-1]);for(let _=0;_<y.length;_++){const b=n[_]>m?m:n[_]<f?f:n[_],w=Math.ceil(y[2*_]-c),x=Math.floor(y[2*_+1]-c);for(let S=w;S<=x;S++)u[S]=b,d[S]=255}}if(s!=null&&s.length)for(let g=0;g<s.length;g++){const y=Math.ceil(s[2*g]-c),_=Math.floor(s[2*g+1]-c);for(let b=y;b<=_;b++)d[b]=0}return{lut:u,offset:c,mask:d}}function UDe(t,e,i){if(t!=="u8"&&t!=="s8"&&t!=="u16"&&t!=="s16")return null;const n=t.includes("16")?65536:256,r=t.includes("s")?-n/2:0,s=new Uint8Array(n);if(e)for(let o=0;o<e.length;o++){const a=Math.ceil(e[2*o]-r),l=Math.floor(e[2*o+1]-r);for(let c=a;c<=l;c++)s[c]=255}else s.fill(255);if(i)for(let o=0;o<i.length;o++)s[i[o]-r]=0;return{lut:s,offset:r}}function GDe(t,e,i,n,r,s,o,a){return{xmin:r<=i*t?0:r<i*t+t?r-i*t:t,ymin:s<=n*e?0:s<n*e+e?s-n*e:e,xmax:r+o<=i*t?0:r+o<i*t+t?r+o-i*t:t,ymax:s+a<=n*e?0:s+a<n*e+e?s+a-n*e:e}}function Rpt(t,e){if(!t||t.length===0)return null;const i=t.find(g=>g.pixelBlock);if(!i||i.pixelBlock==null)return null;const n=(i.extent.xmax-i.extent.xmin)/i.pixelBlock.width,r=(i.extent.ymax-i.extent.ymin)/i.pixelBlock.height,s=.01*Math.min(n,r),o=t.sort((g,y)=>Math.abs(g.extent.ymax-y.extent.ymax)>s?y.extent.ymax-g.extent.ymax:Math.abs(g.extent.xmin-y.extent.xmin)>s?g.extent.xmin-y.extent.xmin:0),a=Math.min.apply(null,o.map(g=>g.extent.xmin)),l=Math.min.apply(null,o.map(g=>g.extent.ymin)),c=Math.max.apply(null,o.map(g=>g.extent.xmax)),u=Math.max.apply(null,o.map(g=>g.extent.ymax)),d={x:Math.round((e.xmin-a)/n),y:Math.round((u-e.ymax)/r)},f={width:Math.round((c-a)/n),height:Math.round((u-l)/r)},m={width:Math.round((e.xmax-e.xmin)/n),height:Math.round((e.ymax-e.ymin)/r)};return Math.round(f.width/i.pixelBlock.width)*Math.round(f.height/i.pixelBlock.height)!==o.length||d.x<0||d.y<0||f.width<m.width||f.height<m.height?null:{extent:e,pixelBlock:qM(o.map(g=>g.pixelBlock),f,{clipOffset:d,clipSize:m})}}function gO(t,e,i,n,r,s){const{width:o,height:a}=i.block,{x:l,y:c}=i.offset,{width:u,height:d}=i.mosaic,f=GDe(o,a,n,r,l,c,u,d);let m=0,g=0;if(s){const y=s.hasGCSSShiftTransform?360:s.halfWorldWidth??0,_=o*s.resolutionX,b=s.startX+n*_;b<y&&b+_>y?g=s.rightPadding:b>=y&&(m=s.leftMargin-s.rightPadding,g=0)}if(f.xmax-=g,typeof e!="number")for(let y=f.ymin;y<f.ymax;y++){const _=(r*a+y-c)*u+(n*o-l)+m,b=y*o;for(let w=f.xmin;w<f.xmax;w++)t[_+w]=e[b+w]}else for(let y=f.ymin;y<f.ymax;y++){const _=(r*a+y-c)*u+(n*o-l)+m;for(let b=f.xmin;b<f.xmax;b++)t[_+b]=e}}function qM(t,e,i={}){var A;const{clipOffset:n,clipSize:r,alignmentInfo:s,blockWidths:o}=i;if(o)return HDe(t,e,{blockWidths:o});const a=t.find($=>Ci($));if(a==null)return null;const l=r?r.width:e.width,c=r?r.height:e.height,u=a.width,d=a.height,f=e.width/u,m=e.height/d,g={offset:n||{x:0,y:0},mosaic:r||e,block:{width:u,height:d}},y=a.pixelType,_=ue.getPixelArrayConstructor(y),b=a.pixels.length,w=[];let x,S;for(let $=0;$<b;$++){S=new _(l*c);for(let L=0;L<m;L++)for(let D=0;D<f;D++){const F=t[L*f+D];Ci(F)&&(x=F.pixels[$],gO(S,x,g,D,L,s))}w.push(S)}const T=t.some($=>$==null||$.mask!=null&&$.mask.length>0),I=t.some($=>$!=null&&$.bandMasks&&$.bandMasks.length>1),C=T?new Uint8Array(l*c):void 0,M=I?[]:void 0;if(C){for(let $=0;$<m;$++)for(let L=0;L<f;L++){const D=t[$*f+L],F=D!=null?D.mask:null;gO(C,F??(D?255:0),g,L,$,s)}if(M)for(let $=0;$<b;$++){const L=new Uint8Array(l*c);for(let D=0;D<m;D++)for(let F=0;F<f;F++){const z=t[D*f+F],U=((A=z==null?void 0:z.bandMasks)==null?void 0:A[$])??(z==null?void 0:z.mask);gO(L,U??(z?255:0),g,F,D,s)}M.push(L)}}const E=new ue({width:l,height:c,pixels:w,pixelType:y,bandMasks:M,mask:C});return E.updateStatistics(),E}function HDe(t,e,i){var _;const n=t.find(b=>b!=null);if(n==null)return null;const r=t.some(b=>b==null||!!b.mask),{width:s,height:o}=e,a=r?new Uint8Array(s*o):null,{blockWidths:l}=i,c=[],u=n.getPlaneCount(),d=ue.getPixelArrayConstructor(n.pixelType);if(r)for(let b=0,w=0;b<t.length;w+=l[b],b++){const x=t[b];if(!Ci(x))continue;const S=x.mask;for(let T=0;T<o;T++)for(let I=0;I<l[b];I++)a[T*s+I+w]=S==null?255:S[T*x.width+I]}const f=t.some(b=>b!=null&&b.bandMasks&&b.bandMasks.length>1),m=f?[]:void 0,g=s*o;for(let b=0;b<u;b++){const w=new d(g),x=f?new Uint8Array(g):void 0;for(let S=0,T=0;S<t.length;T+=l[S],S++){const I=t[S];if(!Ci(I))continue;const C=I.pixels[b];if(C!=null){for(let M=0;M<o;M++)for(let E=0;E<l[S];E++)w[M*s+E+T]=C[M*I.width+E];if(x){const M=((_=I.bandMasks)==null?void 0:_[b])??I.mask;for(let E=0;E<o;E++)for(let A=0;A<l[S];A++)x[E*s+A+T]=M?M[E*I.width+A]:255}}}c.push(w),m&&x&&m.push(x)}const y=new ue({width:s,height:o,mask:a,bandMasks:m,pixels:c,pixelType:n.pixelType});return y.updateStatistics(),y}function qDe(t,e,i){if(!Ci(t))return null;const{width:n,height:r}=t,s=e.x,o=e.y,a=i.width+s,l=i.height+o;if(s<0||o<0||a>n||l>r||s===0&&o===0&&a===n&&l===r)return t;t.mask||(t.mask=new Uint8Array(n*r));const c=t.mask;for(let u=0;u<r;u++){const d=u*n;for(let f=0;f<n;f++)c[d+f]=u<o||u>=l||f<s||f>=a?0:1}return t.updateStatistics(),t}function WDe(t){if(!Ci(t))return null;const e=t.clone(),{width:i,height:n,pixels:r}=t,s=r[0],o=e.pixels[0],a=t.mask;for(let l=2;l<n-1;l++){const c=new Map;for(let d=l-2;d<l+2;d++)for(let f=0;f<4;f++){const m=d*i+f;O1(c,s[m],a?a[m]:1)}o[l*i]=bH(c),o[l*i+1]=o[l*i+2]=o[l*i];let u=3;for(;u<i-1;u++){let d=(l-2)*i+u+1;O1(c,s[d],a?a[d]:1),d=(l-1)*i+u+1,O1(c,s[d],a?a[d]:1),d=l*i+u+1,O1(c,s[d],a?a[d]:1),d=(l+1)*i+u+1,O1(c,s[d],a?a[d]:1),d=(l-2)*i+u-3,DI(c,s[d],a?a[d]:1),d=(l-1)*i+u-3,DI(c,s[d],a?a[d]:1),d=l*i+u-3,DI(c,s[d],a?a[d]:1),d=(l+1)*i+u-3,DI(c,s[d],a?a[d]:1),o[l*i+u]=bH(c)}o[l*i+u+1]=o[l*i+u]}for(let l=0;l<i;l++)o[l]=o[i+l]=o[2*i+l],o[(n-1)*i+l]=o[(n-2)*i+l];return e.updateStatistics(),e}function bH(t){if(t.size===0)return 0;let e=0,i=-1,n=0;const r=t.keys();let s=r.next();for(;!s.done;)n=t.get(s.value),n>e&&(i=s.value,e=n),s=r.next();return i}function DI(t,e,i){if(i===0)return;const n=t.get(e);n===1?t.delete(e):t.set(e,n-1)}function O1(t,e,i){i!==0&&t.set(e,t.has(e)?t.get(e)+1:1)}function JDe(t,e,i){let{x:n,y:r}=e;const{width:s,height:o}=i;if(n===0&&r===0&&o===t.height&&s===t.width)return t;const{width:a,height:l}=t,c=Math.max(0,r),u=Math.max(0,n),d=Math.min(n+s,a),f=Math.min(r+o,l);if(d<0||f<0||!Ci(t))return null;n=Math.max(0,-n),r=Math.max(0,-r);const{pixels:m}=t,g=s*o,y=m.length,_=[];for(let S=0;S<y;S++){const T=m[S],I=ue.createEmptyBand(t.pixelType,g);for(let C=c;C<f;C++){const M=C*a;let E=(C+r-c)*s+n;for(let A=u;A<d;A++)I[E++]=T[M+A]}_.push(I)}const b=new Uint8Array(g),w=t.mask;for(let S=c;S<f;S++){const T=S*a;let I=(S+r-c)*s+n;for(let C=u;C<d;C++)b[I++]=w?w[T+C]:1}const x=new ue({width:i.width,height:i.height,pixelType:t.pixelType,pixels:_,mask:b});return x.updateStatistics(),x}function ZDe(t,e=!0){if(!Ci(t))return null;const{pixels:i,width:n,height:r,mask:s,pixelType:o}=t,a=[],l=Math.round(n/2),c=Math.round(r/2),u=r-1,d=n-1;for(let m=0;m<i.length;m++){const g=i[m],y=ue.createEmptyBand(o,l*c);let _=0;for(let b=0;b<r;b+=2)for(let w=0;w<n;w+=2){const x=g[b*n+w];if(e){const S=w===d?x:g[b*n+w+1],T=b===u?x:g[b*n+w+n],I=w===d?T:b===u?S:g[b*n+w+n+1];y[_++]=(x+S+T+I)/4}else y[_++]=x}a.push(y)}let f=null;if(s!=null){f=new Uint8Array(l*c);let m=0;for(let g=0;g<r;g+=2)for(let y=0;y<n;y+=2){const _=s[g*n+y];if(e){const b=y===d?_:s[g*n+y+1],w=g===u?_:s[g*n+y+n],x=y===d?w:g===u?b:s[g*n+y+n+1];f[m++]=_*b*w*x?1:0}else f[m++]=_}}return new ue({width:l,height:c,pixelType:o,pixels:a,mask:f})}function YDe(t,e,i){if(!Ci(t))return null;const{width:n,height:r}=e;let{width:s,height:o}=t;const a=new Map,l={x:0,y:0},c=i==null?1:1+i;let u=t;for(let d=0;d<c;d++){const f=Math.ceil(s/n),m=Math.ceil(o/r);for(let g=0;g<m;g++){l.y=g*r;for(let y=0;y<f;y++){l.x=y*n;const _=JDe(u,l,e);a.set(`${d}/${g}/${y}`,_)}}d<c-1&&(u=ZDe(u)),s=Math.round(s/2),o=Math.round(o/2)}return a}function yle(t,e,i,n,r=0){const{width:s,height:o}=t,{width:a,height:l}=e,c=n.cols,u=n.rows,d=Math.ceil(a/c-.1/c),f=Math.ceil(l/u-.1/u);let m,g,y,_,b,w,x;const S=d*c,T=S*f*u,I=new Float32Array(T),C=new Float32Array(T),M=new Uint32Array(T),E=new Uint32Array(T);let A,$,L=0;for(let D=0;D<f;D++)for(let F=0;F<d;F++){m=12*(D*d+F),g=i[m],y=i[m+1],_=i[m+2],b=i[m+3],w=i[m+4],x=i[m+5];for(let z=0;z<u;z++){L=(D*u+z)*S+F*c,$=(z+.5)/u;for(let U=0;U<z;U++)A=(U+.5)/c,I[L+U]=(g*A+y*$+_)*s+r,C[L+U]=(b*A+w*$+x)*o+r,M[L+U]=Math.floor(I[L+U]),E[L+U]=Math.floor(C[L+U])}m+=6,g=i[m],y=i[m+1],_=i[m+2],b=i[m+3],w=i[m+4],x=i[m+5];for(let z=0;z<u;z++){L=(D*u+z)*S+F*c,$=(z+.5)/u;for(let U=z;U<c;U++)A=(U+.5)/c,I[L+U]=(g*A+y*$+_)*s+r,C[L+U]=(b*A+w*$+x)*o+r,M[L+U]=Math.floor(I[L+U]),E[L+U]=Math.floor(C[L+U])}}return{offsets_x:I,offsets_y:C,offsets_xi:M,offsets_yi:E,gridWidth:S}}function XDe(t,e){const{coefficients:i,spacing:n}=e,{offsets_x:r,offsets_y:s,gridWidth:o}=yle(t,t,i,{rows:n[0],cols:n[1]}),{width:a,height:l}=t,c=new Float32Array(a*l),u=180/Math.PI;for(let d=0;d<l;d++)for(let f=0;f<a;f++){const m=d*o+f,g=d===0?m:m-o,y=d===l-1?m:m+o,_=r[g]-r[y],b=s[y]-s[g];if(isNaN(_)||isNaN(b))c[d*a+f]=90;else{let w=Math.atan2(b,_)*u;w=(360+w)%360,c[d*a+f]=w}}return c}function vle(t,e,i,n,r="nearest"){if(!Ci(t))return null;r==="majority"&&(t=WDe(t));const{pixels:s,mask:o,bandMasks:a,pixelType:l}=t,c=t.width,u=t.height,d=ue.getPixelArrayConstructor(l),f=s.length,{width:m,height:g}=e;let y=!1;for(let L=0;L<i.length;L+=3)i[L]===-1&&i[L+1]===-1&&i[L+2]===-1&&(y=!0);const{offsets_x:_,offsets_y:b,offsets_xi:w,offsets_yi:x,gridWidth:S}=yle({width:c,height:u},e,i,n,r==="majority"?.5:0);let T;const I=(L,D,F,z)=>{const U=L instanceof Float32Array||L instanceof Float64Array?0:.5;for(let G=0;G<g;G++){T=G*S;for(let W=0;W<m;W++){if(_[T]<0||b[T]<0)L[G*m+W]=0;else if(z)L[G*m+W]=D[w[T]+x[T]*c];else{const Z=Math.floor(_[T]),X=Math.floor(b[T]),oe=Math.ceil(_[T]),se=Math.ceil(b[T]),le=_[T]-Z,de=b[T]-X;if(!F||F[Z+X*c]&&F[oe+X*c]&&F[Z+se*c]&&F[oe+se*c]){const we=(1-le)*D[Z+X*c]+le*D[oe+X*c],Re=(1-le)*D[Z+se*c]+le*D[oe+se*c];L[G*m+W]=(1-de)*we+de*Re+U}else L[G*m+W]=D[w[T]+x[T]*c]}T++}}},C=[];let M;const E=(a==null?void 0:a.length)===f,A=[];for(let L=0;L<f;L++){if(E){const D=new Uint8Array(m*g);I(D,a[L],a[L],!0),A.push(D)}M=new d(m*g),I(M,s[L],E?a[L]:o,r==="nearest"||r==="majority"),C.push(M)}const $=new ue({width:m,height:g,pixelType:l,pixels:C,bandMasks:E?A:void 0});if(o!=null)$.mask=new Uint8Array(m*g),I($.mask,o,o,!0);else if(y){$.mask=new Uint8Array(m*g);for(let L=0;L<m*g;L++)$.mask[L]=_[L]<0||b[L]<0?0:1}return $.updateStatistics(),$}const Zg=new Map;Zg.set("meter-per-second",1),Zg.set("kilometer-per-hour",.277778),Zg.set("knots",.514444),Zg.set("feet-per-second",.3048),Zg.set("mile-per-hour",.44704);const WN=180/Math.PI,Cj=5,ha=new qe({esriMetersPerSecond:"meter-per-second",esriKilometersPerHour:"kilometer-per-hour",esriKnots:"knots",esriFeetPerSecond:"feet-per-second",esriMilesPerHour:"mile-per-hour"});function QP(t,e){return Zg.get(t)/Zg.get(e)||1}function _le(t){return(450-t)%360}function Mj(t,e="geographic"){const[i,n]=t,r=Math.sqrt(i*i+n*n);let s=Math.atan2(n,i)*WN;return s=(360+s)%360,e==="geographic"&&(s=_le(s)),[r,s]}function ble(t,e="geographic"){let i=t[1];e==="geographic"&&(i=_le(i)),i%=360;const n=t[0];return[n*Math.cos(i/WN),n*Math.sin(i/WN)]}function KDe(t,e,i,n="geographic"){if(!Ci(t)||i==null)return t;const r=e==="vector-magdir"?t.clone():GA(t,e),s=r.pixels[1];for(let o=0;o<s.length;o++)s[o]=n==="geographic"?(s[o]+i[o]+270)%360:(s[o]+360-i[o])%360;return e==="vector-magdir"?r:GA(r,"vector-magdir")}function GA(t,e,i="geographic",n=1){if(!Ci(t))return t;const{pixels:r,width:s,height:o}=t,a=s*o,l=r[0],c=r[1],u=t.pixelType.startsWith("f")?t.pixelType:"f32",d=ue.createEmptyBand(u,a),f=ue.createEmptyBand(u,a);let m=0;for(let y=0;y<o;y++)for(let _=0;_<s;_++)e==="vector-uv"?([d[m],f[m]]=Mj([l[m],c[m]],i),d[m]*=n):([d[m],f[m]]=ble([l[m],c[m]],i),d[m]*=n,f[m]*=n),m++;const g=new ue({pixelType:u,width:t.width,height:t.height,mask:t.mask,validPixelCount:t.validPixelCount,maskIsAlpha:t.maskIsAlpha,pixels:[d,f]});return g.updateStatistics(),g}function QDe(t,e,i=1){if(i===1||!Ci(t))return t;const n=t.clone(),{pixels:r,width:s,height:o}=n,a=r[0],l=r[1];let c=0;for(let u=0;u<o;u++)for(let d=0;d<s;d++)e==="vector-uv"?(a[c]*=i,l[c]*=i):a[c]*=i,c++;return n.updateStatistics(),n}function Dpt(t,e,i,n,r){if(r==null||!r.spatialReference.equals(t.spatialReference))return{extent:t,width:Math.round(e/n),height:Math.round(i/n),resolution:t.width/e};const s=r.xmin,o=r.ymax,a=(t.xmax-t.xmin)/e*n,l=(t.ymax-t.ymin)/i*n,c=(a+l)/2;return t.xmin=s+Math.floor((t.xmin-s)/a)*a,t.xmax=s+Math.ceil((t.xmax-s)/a)*a,t.ymin=o+Math.floor((t.ymin-o)/l)*l,t.ymax=o+Math.ceil((t.ymax-o)/l)*l,{extent:t,width:Math.round(t.width/a),height:Math.round(t.height/l),resolution:c}}const eNe=wle(0,0,0);function wle(t=0,e=0,i=Math.PI,n=!0){n&&(i=(2*Math.PI-i)%(2*Math.PI));const r=n?-1:1,s=13*r,o=-7*r,a=-2*r,l=-16*r,c=21.75,[u,d]=ts(0,e+s,i,c),[f,m]=ts(t-5.5,e+o,i,c),[g,y]=ts(t+5.5,e+o,i,c),[_,b]=ts(t-1.5,e+a,i,c),[w,x]=ts(t+1.5,e+a,i,c),[S,T]=ts(t-1.5,e+l,i,c),[I,C]=ts(t+1.5,e+l,i,c);return[u,d,f,m,_,b,w,x,g,y,S,T,I,C]}function tNe(t=0,e=Math.PI,i=!0){i&&(e=(2*Math.PI-e)%(2*Math.PI));const n=10,r=i?-1:1,s=5*r,o=20*r,a=25*r,l=45,c=0,u=0,d=2,f=0,m=d*r,g=i?1:-1,y=n/2*g;let[_,b]=[c+y,u-o],[w,x]=[_+d*g,b],[S,T]=[w-f*g,x+m],[I,C]=[c-y,u-a],[M,E]=[I+f*g,C-m],A=Math.ceil(t/Cj),$=Math.floor(A/10);A-=8*$;const L=[],D=[];for(let le=0;le<A/2;le++,$--){$<=0&&A%2==1&&le===(A-1)/2&&(I=c,M=I+f*g,C=(C+b)/2,E=C-m);const[de,we]=ts(I,C,e,l);if($>0){const[Re,ze]=ts(w,C,e,l),[Ct,Ae]=ts(_,b,e,l);L.push(Re),L.push(ze),L.push(de),L.push(we),L.push(Ct),L.push(Ae)}else{const[Re,ze]=ts(w,x,e,l),[Ct,Ae]=ts(S,T,e,l),[ke,jt]=ts(M,E,e,l);D.push(de),D.push(we),D.push(ke),D.push(jt),D.push(Ct),D.push(Ae),D.push(Re),D.push(ze)}C+=s,b+=s,x+=s,T+=s,E+=s}const[F,z]=ts(c+y,u+o,e,l),U=(n/2+d)*g,[G,W]=ts(c+U,u+o,e,l),[Z,X]=ts(c+y,u-a,e,l),[oe,se]=ts(c+U,u-a,e,l);return{pennants:L,barbs:D,shaft:[F,z,G,W,Z,X,oe,se]}}function ts(t,e,i,n=1){const r=Math.sqrt(t*t+e*e)/n,s=(2*Math.PI+Math.atan2(e,t))%(2*Math.PI);return[r,(2*Math.PI+s-i)%(2*Math.PI)]}const NI=[0,1,3,6,10,16,21,27,33,40,47,55,63],iNe=[0,.5,1,1.5,2],nNe=[0,.25,.5,1,1.5,2,2.5,3,3.5,4];function fm(t,e,i,n){const r=QP(n||"knots",i);let s;for(s=1;s<e.length;s++)if(s===e.length-1){if(t<e[s]*r)break}else if(t<=e[s]*r)break;return Math.min(s-1,e.length-2)}function rNe(t,e,i,n,r){let s=0;switch(e){case"beaufort_kn":s=fm(t,NI,"knots",i);break;case"beaufort_km":s=fm(t,NI,"kilometer-per-hour",i);break;case"beaufort_ft":s=fm(t,NI,"feet-per-second",i);break;case"beaufort_m":s=fm(t,NI,"meter-per-second",i);break;case"classified_arrow":s=fm(t,r??[],n,i);break;case"ocean_current_m":s=fm(t,iNe,"meter-per-second",i);break;case"ocean_current_kn":s=fm(t,nNe,"knots",i)}return s}function sNe(t,e){const{style:i,inputUnit:n,outputUnit:r,breakValues:s}=e,o=ha.fromJSON(n),a=ha.fromJSON(r),l=7*6,c=15;let u=0,d=0;const{width:f,height:m,mask:g}=t,y=t.pixels[0],_=t.pixels[1],b=g!=null?g.filter(T=>T>0).length:f*m,w=new Float32Array(b*l),x=new Uint32Array(c*b),S=e.invertDirection?wle(0,0,0,!1):eNe;for(let T=0;T<m;T++)for(let I=0;I<f;I++){const C=T*f+I;if(!g||g[T*f+I]){const M=(_[C]+360)%360/180*Math.PI,E=rNe(y[C],i,o,a,s);for(let $=0;$<S.length;$+=2)w[u++]=(I+.5)/f,w[u++]=(T+.5)/m,w[u++]=S[$],w[u++]=S[$+1]+M,w[u++]=E,w[u++]=y[C];const A=7*(u/l-1);x[d++]=A,x[d++]=A+1,x[d++]=A+2,x[d++]=A+0,x[d++]=A+4,x[d++]=A+3,x[d++]=A+0,x[d++]=A+2,x[d++]=A+3,x[d++]=A+2,x[d++]=A+5,x[d++]=A+3,x[d++]=A+5,x[d++]=A+6,x[d++]=A+3}}return{vertexData:w,indexData:x}}const yO=[];function oNe(t,e){if(yO.length===0)for(let m=0;m<30;m++)yO.push(tNe(5*m,0,!e.invertDirection));const i=QP(ha.fromJSON(e.inputUnit),"knots"),{width:n,height:r,mask:s}=t,o=t.pixels[0],a=t.pixels[1],l=6,c=[],u=[];let d=0,f=0;for(let m=0;m<r;m++)for(let g=0;g<n;g++){const y=m*n+g,_=o[y]*i;if((!s||s[m*n+g])&&_>=Cj){const b=(a[y]+360)%360/180*Math.PI,{pennants:w,barbs:x,shaft:S}=yO[Math.min(Math.floor(_/5),29)];if(w.length+x.length===0)continue;let T=c.length/l;const I=(g+.5)/n,C=(m+.5)/r;for(let M=0;M<w.length;M+=2)c[d++]=I,c[d++]=C,c[d++]=w[M],c[d++]=w[M+1]+b,c[d++]=0,c[d++]=_;for(let M=0;M<x.length;M+=2)c[d++]=I,c[d++]=C,c[d++]=x[M],c[d++]=x[M+1]+b,c[d++]=0,c[d++]=_;for(let M=0;M<S.length;M+=2)c[d++]=I,c[d++]=C,c[d++]=S[M],c[d++]=S[M+1]+b,c[d++]=0,c[d++]=_;for(let M=0;M<w.length/6;M++)u[f++]=T,u[f++]=T+1,u[f++]=T+2,T+=3;for(let M=0;M<x.length/8;M++)u[f++]=T,u[f++]=T+1,u[f++]=T+2,u[f++]=T+1,u[f++]=T+2,u[f++]=T+3,T+=4;u[f++]=T+0,u[f++]=T+1,u[f++]=T+2,u[f++]=T+1,u[f++]=T+3,u[f++]=T+2,T+=4}}return{vertexData:new Float32Array(c),indexData:new Uint32Array(u)}}function aNe(t,e){let n=0,r=0;const{width:s,height:o,mask:a}=t,l=t.pixels[0],c=[],u=[],d=QP(ha.fromJSON(e.inputUnit),"knots"),f=e.style==="wind_speed"?Cj:Number.MAX_VALUE;for(let m=0;m<o;m++)for(let g=0;g<s;g++){const y=l[m*s+g]*d;if((!a||a[m*s+g])&&y<f){for(let b=0;b<4;b++)c[n++]=(g+.5)/s,c[n++]=(m+.5)/o,c[n++]=b<2?-.5:.5,c[n++]=b%2==0?-.5:.5,c[n++]=0,c[n++]=y;const _=4*(n/24-1);u[r++]=_,u[r++]=_+1,u[r++]=_+2,u[r++]=_+1,u[r++]=_+2,u[r++]=_+3}}return{vertexData:new Float32Array(c),indexData:new Uint32Array(u)}}function Npt(t,e){return e.style==="simple_scalar"?aNe(t,e):e.style==="wind_speed"?oNe(t,e):sNe(t,e)}function Fpt(t,e,i,n=[0,0],r=.5){const{width:s,height:o,mask:a}=t,[l,c]=t.pixels,[u,d]=n,f=Math.round((s-u)/i),m=Math.round((o-d)/i),g=f*m,y=new Float32Array(g),_=new Float32Array(g),b=new Uint8Array(g),w=e==="vector-uv";for(let S=0;S<m;S++)for(let T=0;T<f;T++){let I=0;const C=S*f+T,M=Math.max(0,S*i+d),E=Math.max(0,T*i+u),A=Math.min(o,M+i),$=Math.min(s,E+i);for(let L=M;L<A;L++)for(let D=E;D<$;D++){const F=L*s+D;if(!a||a[F]){I++;const z=w?[l[F],c[F]]:[l[F],(360+c[F])%360],[U,G]=w?z:ble(z);y[C]+=U,_[C]+=G}}if(I>=(A-M)*($-E)*(1-r)){b[C]=1;const[L,D]=Mj([y[C]/I,_[C]/I]);y[C]=L,_[C]=D}else b[C]=0,y[C]=0,_[C]=0}const x=new ue({width:f,height:m,pixels:[y,_],mask:b});return x.updateStatistics(),x}function lNe(t){return typeof t=="function"}function zpt(t,e,i,n){return lNe(t)?t(e,i,n):t}function Vpt(t){return[t.r,t.g,t.b,t.a]}const cNe=` /-,
`;function wH(t){let e=t.length;for(;e--;)if(!cNe.includes(t.charAt(e)))return!1;return!0}function uNe(t,e){const i=[];let n=0,r=-1;do if(r=t.indexOf("[",n),r>=n){if(r>n){const s=t.substr(n,r-n);i.push([s,null,wH(s)])}if(n=r+1,r=t.indexOf("]",n),r>=n){if(r>n){const s=e[t.substr(n,r-n)];s&&i.push([null,s,!1])}n=r+1}}while(r!==-1);if(n<t.length-1){const s=t.substr(n);i.push([s,null,wH(s)])}return i}function hNe(t,e,i){let n="",r=null;for(const s of e){const[o,a,l]=s;if(o)l?r=o:(r&&(n+=r,r=null),n+=o);else{const c=t.attributes[a];c&&(r&&(n+=r,r=null),n+=c)}}return dNe(n,i)}function jpt(t,e,i){const n=uNe(e,t);return r=>hNe(r,n,i)}function dNe(t,e){switch(typeof t!="string"&&(t=String(t)),e){case"LowerCase":return t.toLowerCase();case"Allcaps":return t.toUpperCase();default:return t}}function Bpt(t,e,i,n,r,s,o=!0){const a=e/r,l=i/s,c=Math.ceil(a/2),u=Math.ceil(l/2);for(let d=0;d<s;d++)for(let f=0;f<r;f++){const m=4*(f+(o?s-d-1:d)*r);let g=0,y=0,_=0,b=0,w=0,x=0,S=0;const T=(d+.5)*l;for(let I=Math.floor(d*l);I<(d+1)*l;I++){const C=Math.abs(T-(I+.5))/u,M=(f+.5)*a,E=C*C;for(let A=Math.floor(f*a);A<(f+1)*a;A++){let $=Math.abs(M-(A+.5))/c;const L=Math.sqrt(E+$*$);L>=-1&&L<=1&&(g=2*L*L*L-3*L*L+1,g>0&&($=4*(A+I*e),S+=g*t[$+3],_+=g,t[$+3]<255&&(g=g*t[$+3]/250),b+=g*t[$],w+=g*t[$+1],x+=g*t[$+2],y+=g))}}n[m]=b/y,n[m+1]=w/y,n[m+2]=x/y,n[m+3]=S/_}}function xle(t){return t?{r:t[0],g:t[1],b:t[2],a:t[3]/255}:{r:0,g:0,b:0,a:0}}function Sle(t){var e;return((e=t.data)==null?void 0:e.symbol)??null}function JN(t){return t.type==="CIMVectorMarker"||t.type==="CIMPictureMarker"||t.type==="CIMBarChartMarker"||t.type==="CIMCharacterMarker"||t.type==="CIMPieChartMarker"||t.type==="CIMStackedBarChartMarker"}function ZN(t){return t.type==="CIMGradientStroke"||t.type==="CIMPictureStroke"||t.type==="CIMSolidStroke"}function pNe(t){return t!=null&&(t.type==="CIMGradientFill"||t.type==="CIMHatchFill"||t.type==="CIMPictureFill"||t.type==="CIMSolidFill"||t.type==="CIMWaterFill")}function HA(t){return t!=null&&(t.type==="CIMMarkerPlacementAlongLineRandomSize"||t.type==="CIMMarkerPlacementAlongLineSameSize"||t.type==="CIMMarkerPlacementAlongLineVariableSize"||t.type==="CIMMarkerPlacementAtExtremities"||t.type==="CIMMarkerPlacementAtMeasuredUnits"||t.type==="CIMMarkerPlacementAtRatioPositions"||t.type==="CIMMarkerPlacementOnLine"||t.type==="CIMMarkerPlacementOnVertices")}const Upt=(t,e=0)=>t==null||isNaN(t)?e:t,Gpt=t=>t.tintColor?xle(t.tintColor):{r:255,g:255,b:255,a:1},Hpt=t=>{if(!t)return!1;for(const e of t)switch(e.type){case"CIMGeometricEffectBuffer":case"CIMGeometricEffectOffset":case"CIMGeometricEffectDonut":return!0}return!1};function qpt(){return Y(()=>import("./geometryEngineJSON-2d8ee8bb.js"),["./geometryEngineJSON-2d8ee8bb.js","./geometryEngineBase-5d80acc4.js","./geometryEngineJSON-8ecb2693.js","./json-48e3ea08.js"],import.meta.url)}function Wpt(t){if(!t)return"normal";switch(t.toLowerCase()){case"italic":return"italic";case"oblique":return"oblique";default:return"normal"}}function Jpt(t){if(!t)return"normal";switch(t.toLowerCase()){case"bold":return"bold";case"bolder":return"bolder";case"lighter":return"lighter";default:return"normal"}}function Zpt(t){let e="normal",i="normal";if(t){const n=t.toLowerCase();n.includes("italic")?e="italic":n.includes("oblique")&&(e="oblique"),n.includes("bold")?i="bold":n.includes("light")&&(i="lighter")}return{style:e,weight:i}}function Ypt(t){return t.underline?"underline":t.strikethrough?"line-through":"none"}function xH(t){if(!t)return null;switch(t.type){case"CIMPolygonSymbol":if(t.symbolLayers)for(const e of t.symbolLayers){const i=xH(e);if(i!=null)return i}break;case"CIMTextSymbol":return xH(t.symbol);case"CIMSolidFill":return t.color}}function SH(t){if(t)switch(t.type){case"CIMPolygonSymbol":case"CIMLineSymbol":{const e=t.symbolLayers;if(e)for(const i of e){const n=SH(i);if(n!=null)return n}break}case"CIMTextSymbol":return SH(t.symbol);case"CIMSolidStroke":return t.color}}function TH(t){if(t)switch(t.type){case"CIMPolygonSymbol":case"CIMLineSymbol":if(t.symbolLayers)for(const e of t.symbolLayers){const i=TH(e);if(i!==void 0)return i}break;case"CIMTextSymbol":return TH(t.symbol);case"CIMSolidStroke":case"CIMGradientStroke":case"CIMPictureStroke":return t.width}}function Xpt(t){switch(t){case"Left":default:return"left";case"Right":return"right";case"Center":case"Justify":return"center"}}function Kpt(t){switch(t){case"Top":default:return"top";case"Center":return"middle";case"Baseline":return"baseline";case"Bottom":return"bottom"}}function Qpt(t){return(t?Object.keys(t):[]).map(e=>({name:e,alias:e,type:typeof t[e]=="string"?"esriFieldTypeString":"esriFieldTypeDouble"}))}const eft=t=>t.includes("data:image/svg+xml");function tft(t){if(!t)return null;switch(t.type){case"CIMPointSymbol":case"CIMTextSymbol":return"esriGeometryPoint";case"CIMLineSymbol":return"esriGeometryPolyline";case"CIMPolygonSymbol":return"esriGeometryPolygon";default:return null}}function Tle(t,e,i,n){if(t)if(t.type!=="CIMTextSymbol"){if(i&&t.effects)for(const r of t.effects)gNe(r,e);if(t.symbolLayers)for(const r of t.symbolLayers)switch(r.type){case"CIMPictureMarker":case"CIMVectorMarker":fNe(r,e,n);break;case"CIMPictureStroke":case"CIMSolidStroke":!(n!=null&&n.preserveOutlineWidth)&&r.width&&(r.width*=e);break;case"CIMPictureFill":r.height&&(r.height*=e),r.offsetX&&(r.offsetX*=e),r.offsetY&&(r.offsetY*=e);break;case"CIMHatchFill":Tle(r.lineSymbol,e,!0,{...n,preserveOutlineWidth:!1}),r.offsetX&&(r.offsetX*=e),r.offsetY&&(r.offsetY*=e),r.separation&&(r.separation*=e)}}else t.height!=null&&(t.height*=e)}function fNe(t,e,i){if(t&&(t.markerPlacement&&mNe(t.markerPlacement,e),t.offsetX&&(t.offsetX*=e),t.offsetY&&(t.offsetY*=e),t.anchorPoint&&t.anchorPointUnits==="Absolute"&&(t.anchorPoint={x:t.anchorPoint.x*e,y:t.anchorPoint.y*e}),t.size=t.size!=null?t.size*e:0,t.type==="CIMVectorMarker"&&t.markerGraphics))for(const n of t.markerGraphics)t.scaleSymbolsProportionally||Tle(n.symbol,e,!0,i)}function mNe(t,e){switch(HA(t)&&t.offset&&(t.offset*=e),t.type){case"CIMMarkerPlacementAlongLineRandomSize":case"CIMMarkerPlacementAlongLineSameSize":if(t.customEndingOffset&&(t.customEndingOffset*=e),t.offsetAlongLine&&(t.offsetAlongLine*=e),t.placementTemplate&&t.placementTemplate.length){const i=t.placementTemplate.map(n=>n*e);t.placementTemplate=i}break;case"CIMMarkerPlacementAlongLineVariableSize":if(t.maxRandomOffset&&(t.maxRandomOffset*=e),t.placementTemplate&&t.placementTemplate.length){const i=t.placementTemplate.map(n=>n*e);t.placementTemplate=i}break;case"CIMMarkerPlacementOnLine":t.startPointOffset&&(t.startPointOffset*=e);break;case"CIMMarkerPlacementAtExtremities":t.offsetAlongLine&&(t.offsetAlongLine*=e);break;case"CIMMarkerPlacementAtMeasuredUnits":case"CIMMarkerPlacementOnVertices":break;case"CIMMarkerPlacementAtRatioPositions":t.beginPosition&&(t.beginPosition*=e),t.endPosition&&(t.endPosition*=e);break;case"CIMMarkerPlacementPolygonCenter":t.offsetX&&(t.offsetX*=e),t.offsetY&&(t.offsetY*=e);break;case"CIMMarkerPlacementInsidePolygon":t.offsetX&&(t.offsetX*=e),t.offsetY&&(t.offsetY*=e),t.stepX&&(t.stepX*=e),t.stepY&&(t.stepY*=e)}}function gNe(t,e){switch(t.type){case"CIMGeometricEffectArrow":case"CIMGeometricEffectDonut":t.width&&(t.width*=e);break;case"CIMGeometricEffectBuffer":t.size&&(t.size*=e);break;case"CIMGeometricEffectCut":t.beginCut&&(t.beginCut*=e),t.endCut&&(t.endCut*=e),t.middleCut&&(t.middleCut*=e);break;case"CIMGeometricEffectDashes":if(t.customEndingOffset&&(t.customEndingOffset*=e),t.offsetAlongLine&&(t.offsetAlongLine*=e),t.dashTemplate&&t.dashTemplate.length){const i=t.dashTemplate.map(n=>n*e);t.dashTemplate=i}break;case"CIMGeometricEffectExtension":case"CIMGeometricEffectJog":case"CIMGeometricEffectRadial":t.length&&(t.length*=e);break;case"CIMGeometricEffectMove":t.offsetX&&(t.offsetX*=e),t.offsetY&&(t.offsetY*=e);break;case"CIMGeometricEffectOffset":case"CIMGeometricEffectOffsetTangent":t.offset&&(t.offset*=e);break;case"CIMGeometricEffectRegularPolygon":t.radius&&(t.radius*=e);break;case"CIMGeometricEffectTaperedPolygon":t.fromWidth&&(t.fromWidth*=e),t.length&&(t.length*=e),t.toWidth&&(t.toWidth*=e);break;case"CIMGeometricEffectWave":t.amplitude&&(t.amplitude*=e),t.period&&(t.period*=e)}}function Ile(t){const e=[];return YN(Sle(t),e),e.length?new ae(xle(e[0])):null}function YN(t,e){var r;if(!t)return;let i;i=t.type==="CIMTextSymbol"?t.symbol:t;const n=t.type==="CIMPolygonSymbol";if(i!=null&&i.symbolLayers){for(const s of i.symbolLayers)if(!(s.colorLocked||n&&(ZN(s)||JN(s)&&s.markerPlacement&&HA(s.markerPlacement))))switch(s.type){case"CIMPictureMarker":case"CIMPictureStroke":case"CIMPictureFill":s.tintColor&&IH(e,s.tintColor);break;case"CIMVectorMarker":(r=s.markerGraphics)==null||r.forEach(o=>{YN(o.symbol,e)});break;case"CIMSolidStroke":case"CIMSolidFill":IH(e,s.color);break;case"CIMHatchFill":YN(s.lineSymbol,e)}}}function IH(t,e){for(const i of t)if(i.join(".")===e.join("."))return;t.push(e)}function Cle(t,e,i){e instanceof ae||(e=new ae(e));const n=Sle(t);n&&XN(n,e,i)}function XN(t,e,i){var s;if(!t)return;let n;n=t.type==="CIMTextSymbol"?t.symbol:t;const r=(n==null?void 0:n.type)==="CIMPolygonSymbol";if(n!=null&&n.symbolLayers)for(const o of n.symbolLayers){if(o.colorLocked)continue;if(r){if(i){const{layersToColor:l}=i;if((ZN(o)||JN(o)&&o.markerPlacement&&HA(o.markerPlacement))&&l==="fill"||pNe(o)&&l==="outline")continue}else if(ZN(o)||JN(o)&&o.markerPlacement&&HA(o.markerPlacement))continue}const a=e.toArray();switch(o.type){case"CIMPictureMarker":case"CIMPictureStroke":case"CIMPictureFill":o.tintColor=a;break;case"CIMVectorMarker":(s=o.markerGraphics)==null||s.forEach(l=>{XN(l.symbol,e,i)});break;case"CIMSolidStroke":case"CIMSolidFill":o.color=a;break;case"CIMHatchFill":XN(o.lineSymbol,e,i)}}}const Mle="picture-fill",Ele="simple-fill",yNe="simple-line",Ale="simple-marker",vNe="text",_Ne="cim",vO=new GP(1e3);function bNe(t){const e=t.style;let i=null;if(t)switch(t.type){case Ale:e!=="cross"&&e!=="x"&&(i=t.color);break;case Ele:e==="solid"?i=t.color:e!=="none"&&(i={type:"pattern",x:0,y:0,src:xt(`esri/symbols/patterns/${e}.png`),width:5,height:5});break;case Mle:i={type:"pattern",src:t.url,width:Gi(t.width)*t.xscale,height:Gi(t.height)*t.yscale,x:Gi(t.xoffset),y:Gi(t.yoffset)};break;case vNe:i=t.color;break;case _Ne:i=Ile(t)}return i}function wNe(t,e){const i=t+"-"+e;return vO.get(i)!==void 0?Promise.resolve(vO.get(i)):gt(t,{responseType:"image"}).then(n=>{const r=n.data,s=r.naturalWidth,o=r.naturalHeight,a=document.createElement("canvas");a.width=s,a.height=o;const l=a.getContext("2d");l.fillStyle=e,l.fillRect(0,0,s,o),l.globalCompositeOperation="destination-in",l.drawImage(r,0,0);const c=a.toDataURL();return vO.put(i,c),c})}function eS(t){if(!t)return null;let e=null;switch(t.type){case Ele:case Mle:case Ale:e=eS(t.outline);break;case yNe:{const i=Gi(t.width);t.style!=null&&t.style!=="none"&&i!==0&&(e={color:t.color,style:Ej(t.style),width:i,cap:t.cap,join:t.join==="miter"?Gi(t.miterLimit):t.join});break}default:e=null}return e}const Ej=(()=>{const t={};return e=>{if(t[e])return t[e];const i=e.replaceAll("-","");return t[e]=i,i}})(),xNe=new ae([128,128,128]),SNe=new ae("white");function TNe(t){var i,n;const e=(i=t.symbolLayers)==null?void 0:i.at(-1);if(e&&"outline"in e)return(n=e==null?void 0:e.outline)==null?void 0:n.size}function INe(t){var e;if(!t)return 0;if(Ou(t)){const i=TNe(t);return i??0}return Tc((e=eS(t))==null?void 0:e.width)}function ek(t){if(t==null||!("symbolLayers"in t)||t.symbolLayers==null)return!1;switch(t.type){case"point-3d":return t.symbolLayers.some(e=>e.type==="object");case"line-3d":return t.symbolLayers.some(e=>e.type==="path");case"polygon-3d":return t.symbolLayers.some(e=>e.type==="object"||e.type==="extrude");default:return!1}}function CNe(t){return Lr(t.resource).href}function R0(t,e){if(!t)return null;let i=null;return Ou(t)?i=MNe(t):_P(t)&&(i=t.type==="cim"?Ile(t):t.color?new ae(t.color):null),i?tS(i,e):null}function MNe(t){const e=t.symbolLayers;if(!e)return null;let i=null;return e.forEach(n=>{var r;n.type==="object"&&((r=n.resource)!=null&&r.href)||(i=n.type==="water"?n.color:n.material?n.material.color:null)}),i?new ae(i):null}function tS(t,e){if(e==null||t==null)return t;const i=t.toRgba();return i[3]=i[3]*e,new ae(i)}function ENe(t,e,i){const n=t.symbolLayers;if(!n)return;const r=s=>tS(e=e??s??(i!=null?SNe:null),i);n.forEach(s=>{var o;if(s.type!=="object"||!((o=s.resource)!=null&&o.href)||e)if(s.type==="water")s.color=r(s.color);else{const a=s.material!=null?s.material.color:null,l=r(a);s.material==null?s.material=new ba({color:l}):s.material.color=l,i!=null&&"outline"in s&&s.outline!=null&&s.outline.color!=null&&(s.outline.color=tS(s.outline.color,i))}})}function ANe(t,e,i){(e=e??t.color)&&(t.color=tS(e,i)),i!=null&&"outline"in t&&t.outline&&t.outline.color&&(t.outline.color=tS(t.outline.color,i))}function _O(t,e,i){t&&(e||i!=null)&&(e&&(e=new ae(e)),Ou(t)?ENe(t,e,i):_P(t)&&ANe(t,e,i))}async function $Ne(t,e){const i=t.symbolLayers;i&&await U0e(i,async n=>PNe(n,e))}async function PNe(t,e){switch(t.type){case"extrude":ONe(t,e);break;case"icon":case"line":case"text":kNe(t,e);break;case"path":RNe(t,e);break;case"object":await LNe(t,e)}}function kNe(t,e){const i=$le(e);i!=null&&(t.size=i)}function $le(t){for(const e of t)if(typeof e=="number")return e;return null}function ONe(t,e){t.size=typeof e[2]=="number"?e[2]:0}async function LNe(t,e){const{resourceSize:i,symbolSize:n}=await DNe(t),r=Ple(e,i,n);t.width=Zx(e[0],n[0],i[0],r),t.depth=Zx(e[1],n[1],i[1],r),t.height=Zx(e[2],n[2],i[2],r)}function RNe(t,e){const i=Ple(e,eee,[t.width,void 0,t.height]);t.width=Zx(e[0],t.width,1,i),t.height=Zx(e[2],t.height,1,i)}function Ple(t,e,i){for(let n=0;n<3;n++){const r=t[n];switch(r){case"symbol-value":{const s=i[n];return s!=null?s/e[n]:1}case"proportional":break;default:if(r&&e[n])return r/e[n]}}return 1}async function DNe(t){const{computeObjectLayerResourceSize:e}=await Y(()=>import("./symbolLayerUtils-808ca918.js"),[],import.meta.url),i=await e(t,10),{width:n,height:r,depth:s}=t,o=[n,s,r];let a=1;for(let l=0;l<3;l++){const c=o[l];if(c!=null){a=c/i[l];break}}for(let l=0;l<3;l++)o[l]==null&&(o[l]=i[l]*a);return{resourceSize:i,symbolSize:o}}function Zx(t,e,i,n){switch(t){case"proportional":return i*n;case"symbol-value":return e??i;default:return t}}function NNe(t,e){const i=$le(e);if(i!=null)switch(t.type){case"simple-marker":t.size=i;break;case"picture-marker":{const n=t.width/t.height;n>1?(t.width=i,t.height=i*n):(t.width=i*n,t.height=i);break}case"simple-line":t.width=i;break;case"text":t.font.size=i}}async function kle(t,e){if(t&&e)return Ou(t)?$Ne(t,e):void(_P(t)&&NNe(t,e))}function Ole(t,e,i){if(t&&e!=null)if(Ou(t)){const n=t.symbolLayers;n&&n.forEach(r=>{if(r&&r.type==="object")switch(i){case"tilt":r.tilt=e;break;case"roll":r.roll=e;break;default:r.heading=e}})}else _P(t)&&(t.type!=="simple-marker"&&t.type!=="picture-marker"&&t.type!=="text"||(t.angle=e))}function iS(t){if(!t)return null;const e=t.effects.filter(i=>i.type!=="bloom").map(i=>i.toJSON());return NA(e)}function ift(t){return t!=null&&t.type==="polygon-3d"&&t.symbolLayers.some(e=>e.type==="extrude")}async function FNe(t,e){return await t.fetchSymbol(e)||t.fetchCIMSymbol(e)}var KN;const CH=new Set(["esriMetersPerSecond","esriKilometersPerHour","esriKnots","esriFeetPerSecond","esriMilesPerHour"]),FI=new qe({beaufort_ft:"beaufort-ft",beaufort_km:"beaufort-km",beaufort_kn:"beaufort-kn",beaufort_m:"beaufort-m",beaufort_mi:"beaufort-mi",classified_arrow:"classified-arrow",ocean_current_kn:"ocean-current-kn",ocean_current_m:"ocean-current-m",simple_scalar:"simple-scalar",single_arrow:"single-arrow",wind_speed:"wind-barb"}),zI=new qe({flow_from:"flow-from",flow_to:"flow-to"});let bs=KN=class extends Qf(ie){constructor(t){super(t),this.attributeField="Magnitude",this.flowRepresentation="flow-from",this.rotationType="arithmetic",this.style="single-arrow",this.symbolTileSize=50,this.type="vector-field"}readInputUnit(t,e){return CH.has(t)?ha.fromJSON(t):null}readOutputUnit(t,e){return CH.has(t)?ha.fromJSON(t):null}get styleRenderer(){const t=this.style,e=this.attributeField,i=this._createStyleRenderer(t);return i.field=e,i}get sizeVariables(){const t=[];if(this.visualVariables)for(const e of this.visualVariables)e.type==="size"&&t.push(e);if(t.length===0){const e=new u0({field:"Magnitude",minSize:.2*this.symbolTileSize,maxSize:.8*this.symbolTileSize});this.visualVariables?this.visualVariables.push(e):this._set("visualVariables",[e]),t.push(e)}return t}get rotationVariables(){const t=[];if(this.visualVariables)for(const e of this.visualVariables)e.type==="rotation"&&t.push(e);if(t.length===0){const e=new jP({field:"Direction",rotationType:this.rotationType});this.visualVariables?this.visualVariables.push(e):this._set("visualVariables",[e]),t.push(e)}return t}clone(){return new KN({attributeField:this.attributeField,flowRepresentation:this.flowRepresentation,rotationType:this.rotationType,symbolTileSize:this.symbolTileSize,style:this.style,visualVariables:q(this.visualVariables),inputUnit:this.inputUnit,outputUnit:this.outputUnit})}async getGraphicsFromPixelData(t,e=!1,i=[]){var f;const n=new Array,r=QP(this.inputUnit,this.outputUnit),s=((f=this.rotationVariables[0])==null?void 0:f.rotationType)||this.rotationType,o=e?GA(t.pixelBlock,"vector-uv",s,r):QDe(t.pixelBlock,"vector-magdir",r);if(o==null)return n;const a=t.extent,l=o.mask!=null&&o.mask.length>0;let c=0;const u=(a.xmax-a.xmin)/o.width,d=(a.ymax-a.ymin)/o.height;for(let m=0;m<o.height;m++)for(let g=0;g<o.width;g++,c++){let y=new pe({x:a.xmin+g*u+u/2,y:a.ymax-m*d-d/2,spatialReference:a.spatialReference});y=(await mle(y))[0];const _=i.some(b=>b.intersects(y));if((!l||o.mask[c])&&!_){const b={Magnitude:o.pixels[0][c],Direction:o.pixels[1][c]},w=new Vo({geometry:{type:"point",x:y.x,y:y.y,spatialReference:a.spatialReference},attributes:b});w.symbol=this._getVisualVariablesAppliedSymbol(w),n.push(w)}}return n}getSymbol(t,e){}async getSymbolAsync(t,e){}getSymbols(){return[]}getClassBreakInfos(){var t;return(t=this.styleRenderer)==null?void 0:t.classBreakInfos}getDefaultSymbol(){var t;return(t=this.styleRenderer)==null?void 0:t.defaultSymbol}_getDefaultSymbol(t){return new rs({path:"M14,32 14,18 9,23 16,3 22,23 17,18 17,32 z",outline:new Ur({width:0}),size:20,color:t||new ae([0,92,230])})}_getVisualVariablesAppliedSymbol(t){var r,s;if(!t)return;const e=(s=(r=this.styleRenderer)==null?void 0:r.getSymbol(t))==null?void 0:s.clone(),i=this.sizeVariables,n=this.rotationVariables;if(i&&i.length&&this.sizeVariables.forEach(o=>kle(e,Poe([o],t))),n&&n.length){const o=this.flowRepresentation==="flow-to"==(this.style==="ocean-current-kn"||this.style==="ocean-current-m")?0:180;t.attributes.Direction=t.attributes.Direction+o,this.rotationVariables.forEach(a=>Ole(e,XV(a,t),a.axis))}return e}_createStyleRenderer(t){let e={defaultSymbol:this._getDefaultSymbol(),classBreakInfos:[]};switch(t){case"single-arrow":e=this._createSingleArrowRenderer();break;case"beaufort-kn":e=this._createBeaufortKnotsRenderer();break;case"beaufort-m":e=this._createBeaufortMeterRenderer();break;case"beaufort-ft":e=this._createBeaufortFeetRenderer();break;case"beaufort-mi":e=this._createBeaufortMilesRenderer();break;case"beaufort-km":e=this._createBeaufortKilometersRenderer();break;case"ocean-current-m":e=this._createCurrentMeterRenderer();break;case"ocean-current-kn":e=this._createCurrentKnotsRenderer();break;case"simple-scalar":e=this._createSimpleScalarRenderer();break;case"wind-barb":e=this._createWindBarbsRenderer();break;case"classified-arrow":e=this._createClassifiedArrowRenderer()}return new Xb(e)}_createSingleArrowRenderer(){return{defaultSymbol:this._getDefaultSymbol()}}_createBeaufortKnotsRenderer(){const t=[0,1,3,6,10,16,21,27,33,40,47,55,63],e=[[40,146,199],[89,162,186],[129,179,171],[160,194,155],[191,212,138],[218,230,119],[250,250,100],[252,213,83],[252,179,102],[250,141,52],[247,110,42],[240,71,29]];return{defaultSymbol:this._getDefaultSymbol(new ae([214,47,39])),classBreakInfos:this._getClassBreaks(t,e)}}_createBeaufortMeterRenderer(){const t=[0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7],e=[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]];return{defaultSymbol:this._getDefaultSymbol(new ae([214,47,39])),classBreakInfos:this._getClassBreaks(t,e)}}_createBeaufortFeetRenderer(){const t=this._getDefaultSymbol(new ae([214,47,39]));let e=[0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7];const i=[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]],n=3.28084;return e=e.map(r=>r*n),{defaultSymbol:t,classBreakInfos:this._getClassBreaks(e,i)}}_createBeaufortMilesRenderer(){const t=this._getDefaultSymbol(new ae([214,47,39]));let e=[0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7];const i=[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]],n=2.23694;return e=e.map(r=>r*n),{defaultSymbol:t,classBreakInfos:this._getClassBreaks(e,i)}}_createBeaufortKilometersRenderer(){const t=this._getDefaultSymbol(new ae([214,47,39]));let e=[0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7];const i=[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]],n=3.6;return e=e.map(r=>r*n),{defaultSymbol:t,classBreakInfos:this._getClassBreaks(e,i)}}_createCurrentMeterRenderer(){const t=[0,.5,1,1.5,2],e=[[78,26,153],[179,27,26],[202,128,26],[177,177,177]];return{defaultSymbol:this._getDefaultSymbol(new ae([177,177,177])),classBreakInfos:this._getClassBreaks(t,e)}}_createCurrentKnotsRenderer(){const t=[0,.25,.5,1,1.5,2,2.5,3,3.5,4],e=[[0,0,0],[0,37,100],[78,26,153],[151,0,100],[179,27,26],[177,78,26],[202,128,26],[177,179,52],[177,177,177]];return{defaultSymbol:this._getDefaultSymbol(new ae([177,177,177])),classBreakInfos:this._getClassBreaks(t,e)}}_createClassifiedArrowRenderer(){var n;const t=this._getDefaultSymbol(new ae([56,168,0]));let e=[0,1e-6,3.5,7,10.5,14];if((n=this.sizeVariables)!=null&&n.length){const r=this.sizeVariables[0].minDataValue,s=this.sizeVariables[0].maxDataValue;if(r&&s){const o=(s-r)/5;e=Array.from(Array(6).keys()).map(a=>r+o*a)}}const i=[[56,168,0],[139,309,0],[255,255,0],[255,128,0],[255,0,0]];return{defaultSymbol:t,classBreakInfos:this._getClassBreaks(e,i)}}_createSimpleScalarRenderer(){return{defaultSymbol:Mf.fromJSON({imageData:"iVBORw0KGgoAAAANSUhEUgAAACsAAAArCAQAAABLVLlLAAAABGdBTUEAAYagMeiWXwAAAAJiS0dEAACqjSMyAAAACXBIWXMAAABIAAAASABGyWs+AAAC3ElEQVRIx9XXvW4cVRQH8N982btpsIREJECyiCXsxX4DKh6AliqGKCBBE2SlwlHgAbBD/AKmyEYUeQ1KahPZSZQvBCkQLTHZ7KGY8Xodz4w3a1NwbzVzz/znfJ//zbStVC5q3icKak9GAs2QIdDx3PtW/S011NW3p+M5Eomh11ipTIKe6+4LQzHaQ+G+63pIZNJJQXMpljwTwj1brpgx5w1zZlyx5Z4QnllEIm2xeeSUHBf0hV0bejo1Uh09G3aFvgXk7cCJFBc9EdaRVuHJJaOdKyTV2TVhYLMduNR0Q9gxL5GaaTDw8GzejrDRBpxWoGsySRW0dttKuattwNkIlFw2YXgzOdYq4Ox49PlM+JrKd5OusjTWhBuVxUfMX/KXXZ3WEmkuqa67wspR4BTbwtKr/5u4fFgStse/T7EifFPnnYl9zPq4vmUOPrRndgoHjDti1gOPqlyXoifcRNGQzUd31lDyfHmob1Gp35vSr+P6vilcQ5Egtyd8YF/ySg9NhPM+9M/IOaHwp5+PSZayXTvCogEUwlatC3J8LLwYtcWB8EuDXQVuCkV5/B4eNHb7wGBs87LBDS+xjdVSn09wq1G8dFM+9tSUhIGneLvUdniKxKpTYljCpu3j7rVWlHj/P23v4NPGUEyeCQnexe9lJjzEQqMjJs+EzNAX6B98dBZVRmroJx95x/A/6gln18EyfCUsl+qdXb/tjvfbw+mwforpUOBz4XLVoBwAn3aWnfeH246NyBXhrq7TTN5lNSP9RkU+puUJm3W2Tsdq0nZWM07srk7MwQrZSRysjjGWBLRJNsNbfj2JMR4AbxpU1XLAb9Mxfpsq5EjMuuiR8L0JiHOOBX3hiUvOmavN0nMueSzcceFk0BK4pMqLo7vDD1Z0qrtDx7Itt4Xwm9UqbMmk8S0Dtuzb2pvOU99Z1nLTOfleNmvfZfP2pYZmPfajwosKdDBNpacNpVGGsWX9CyDI8Xq/Sj6QAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE0LTExLTEwVDAzOjE3OjU4LTA1OjAwF+tHyQAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxNC0xMS0xMFQwMzoxNzo1OC0wNTowMGa2/3UAAAAASUVORK5CYII=",height:20,width:20,type:"esriPMS",angle:0})}}_createWindBarbsRenderer(){const t=Array.from(Array(31).keys()).map(r=>5*r),e=[{range:"0-5",path:"M20 20 M5 20 A15 15 0 1 0 35 20 A15 15 0 1 0 5 20 M20 20 M10 20 A10 10 0 1 0 30 20 A10 10 0 1 0 10 20",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTIwIDIwIE01IDIwIEExNSAxNSAwIDEgMCAzNSAyMCBBMTUgMTUgMCAxIDAgNSAyMCBNMjAgMjAgTTEwIDIwIEExMCAxMCAwIDEgMCAzMCAyMCBBMTAgMTAgMCAxIDAgMTAgMjAiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="},{range:"5-10",path:"M25 0 L25 40 M25 35 L17.5 37.5",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjkgMCAyNyA0NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cGF0aCBkPSJNMjUgMCBMMjUgNDAgTTI1IDM1IEwxNy41IDM3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="},{range:"10-15",path:"M25 0 L25 40 L10 45 L25 40",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjkgMCAyNyA0NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cGF0aCBkPSJNMjUgMCBMMjUgNDAgTDEwIDQ1IEwyNSA0MCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"15-20",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L17.5 37.5",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjEyIDAgMTUgNDUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxNy41IDM3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="},{range:"20-25",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjkgMCAyNiA0NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cGF0aCBkPSJNMjUgMCBMMjUgNDAgTDEwIDQ1IEwyNSA0MCBNMjUgMzUgTDEwIDQwIiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},{range:"25-30",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L17.5 32.5",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjkgMCAyNiA0NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cGF0aCBkPSJNMjUgMCBMMjUgNDAgTDEwIDQ1IEwyNSA0MCBNMjUgMzUgTDEwIDQwIEwyNSAzNSBNMjUgMzAgTDE3LjUgMzIuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"30-35",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0NiI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"35-40",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L17.5 27.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0NiI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxNy41IDI3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="},{range:"40-45",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0NiI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"45-50",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L17.5 22.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0NiI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxNy41IDIyLjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="},{range:"50-55",path:"M25 0 L25 40 L10 40 L25 35",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="},{range:"55-60",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L17.5 32.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxNy41IDMyLjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="},{range:"60-65",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"65-70",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L17.5 27.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxNy41IDI3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="},{range:"70-75",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"75-80",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L17.5 22.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxNy41IDIyLjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="},{range:"80-85",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxMCAyNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"85-90",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L17.5 17.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxMCAyNSBMMjUgMjAgTTI1IDE1IEwxNy41IDE3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="},{range:"90-95",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L10 20",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxMCAyNSBMMjUgMjAgTTI1IDE1IEwxMCAyMCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"95-100",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L10 20 L25 15 M25 10 L17.5 12.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxMCAyNSBMMjUgMjAgTTI1IDE1IEwxMCAyMCBMMjUgMTUgTTI1IDEwIEwxNy41IDEyLjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="},{range:"100-105",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"105-110",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L17.5 27.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDE3LjUgMjcuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"110-115",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},{range:"115-120",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L17.5 22.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDE3LjUgMjIuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"120-125",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},{range:"125-130",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L17.5 17.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDE3LjUgMTcuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"130-135",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDEwIDIwIiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},{range:"135-140",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L17.5 12.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDEwIDIwIE0yNSAxNSBNMjUgMTAgTDE3LjUgMTIuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"140-145",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L17.5 12.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDEwIDIwIE0yNSAxNSBNMjUgMTAgTDEwIDE1IiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},{range:"145-150",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L17.5 12.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDEwIDIwIE0yNSAxNSBNMjUgMTAgTDEwIDE1IE0yNSAxMCBNMjUgNSBMMTcuNSA3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="}],i=Mf.fromJSON({imageData:"iVBORw0KGgoAAAANSUhEUgAAACgAAAApCAQAAADtq6NDAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJiS0dEAP+Hj8y/AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAEY0lEQVRIx5XXWWxWRRQH8N+d+31tUdGAVjGglYJABFEBY91jfDAg7piYaFTccA++uMQEFRcSXlATtxiXqMQt4G4iisYl0ai4sIQYtVFZ1KIFKdTS0l4f7vRCS5fPebozc+bM/2z/Mzcx0AgSiUxXnKfIdMn875FIhX53U2n/B/s+kKM4UINTjTBZImixxnrv+9a2iL6zEoUBXcoudrWj/OtHm3wt02lfU9Qao9OnHvIhgmww84MEl1qnxfNmGrqHxAizLdPpC6chGcAxKGGcL+30gOERf1BSpUqVslQSV8d5ReZFe8VQ9avufJn31cWwlJV7iafKStGOE/1qvfH9qUxxu8ydUdmuSKbGO8YUdT2inKLG69pM70tliktl5qIkCAJGmusDG7Vqsc0WjZa4UBlBiA5YZIcjYzB7qDtH5kaUJFLs7RGZTZ42W4PRRmtwvbdt1+wGiaS4drEtDttdZYIDNVuAclR3vA3+dI3qHqmVSy7U6Tv1MScCPvPR7nIpFlsdCy3FdTLPGhK92e2CUITjMJ9ocwKxnsZqc3O3JwMma3d6UVLnyVxB4aXemZqvPqLdpJhW3KVVbY4yYImPo6M5Urv50fj+0z/FG9YaEiENs8UtMfXUaTeTePNHlhXfA1UU+2lyD1Il3Gtt9+adfpNG7dNlpg2U/T3KYLZ2dUWFdTgp3/rQ4sK973qnInV5TIf40x3dhvrJPBiqyWUo4wAtLqhQYS71qK+QKOFRywmGK/kpikzV6WMKhh58vGWs4TIJNjiEYLIuP8Tt4/zmLyqk+AyrJSbF+Qq1DgqRUPMxyl+9q3IQhX/rMCJ6tEunriDs1oSyQZKlr9AkhT2ZIARbJfaJS1vtVbHB+Rgi0RK/y1q1BWsEEyLoz40xtGKcARPVWB1BTPO7f4LNtpkUl1aoMbViLyZo0GRjPD3BxnxjqXeLYlvhqYrzMMG3HoyJXa3JjfnGlbYYFlP7Jh3qKsKY4hQ7TY0nG+xwRL61n63mxHtqNHosigyMLmClNwvuecFnOZB88nNBDzNkzhxEZaKMBVoKapggMzvHHXBEpNSSFAvtcFRsVn0bW8LlMmcXs+c0Kne3gRR32+zg4uXwjC6zit6Wt4a8LXVfcp/MtQXHn2ynGbuCmb8GvvFeJLEE82ReU9/n6+dkq2x3buG9Wn94smcgAw631RPR7BTH+kbmHReZoEpOdEe7zWqZl40s0JWs9Hmv7hjBHqPDwsjGKVJnWWqjbdZp1KhJi0aPmxYZsIRhlttgeF+Jlke41QcOQKoqilSb6HJzSvNG3G/UoWnxwsmt+sVaYwd63dRbqdnMyCPVeyRPvpYgdavM22oGKoMUVRbJfOWMwidJ8Zzb1UvmWK/VVUXzHaTjjrVYh1897HT7xxYEVUaa5SWb/WO+YUWa9SrwvigzM8YlzlYv2GSdVCYxxlBtVnnFq5olwp5/BEk/OLsf5LUmG2+inRJdVvjZ97ZH9/zP34ug1O91pf4p+D+JYBpvrKxfbwAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNC0xMS0xMFQwMzoxMjowOS0wNTowMB9ViV0AAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTQtMTEtMTBUMDM6MTI6MDktMDU6MDBuCDHhAAAAAElFTkSuQmCC",height:20,width:20,type:"esriPMS",angle:0}),n=t.map((r,s)=>{let o;if(s!==t.length-1)if(s===0)o={minValue:r,maxValue:t[s+1],symbol:i};else{const a=Mf.fromJSON({type:"esriPMS",imageData:e[s].imageData,contentType:"image/svg+xml",height:32,width:32,angle:0});o={minValue:r,maxValue:t[s+1],symbol:a}}return new fb(o)});return{defaultSymbol:i,classBreakInfos:n}}_getClassBreaks(t,e){return e.map((i,n)=>new fb({minValue:t[n],maxValue:t[n+1],symbol:this._getDefaultSymbol(new ae(i))}))}};h([p({type:String,json:{write:!0}})],bs.prototype,"attributeField",void 0),h([p({type:zI.apiValues,json:{type:zI.jsonValues,read:{reader:zI.read},write:{writer:zI.write}}})],bs.prototype,"flowRepresentation",void 0),h([p({type:["geographic","arithmetic"],json:{write:!0}})],bs.prototype,"rotationType",void 0),h([p({type:FI.apiValues,json:{type:FI.jsonValues,read:{reader:FI.read},write:{writer:FI.write}}})],bs.prototype,"style",void 0),h([p({json:{write:!0}})],bs.prototype,"symbolTileSize",void 0),h([p({type:ha.apiValues,json:{type:ha.jsonValues,write:{writer:ha.write}}})],bs.prototype,"inputUnit",void 0),h([_e("inputUnit")],bs.prototype,"readInputUnit",null),h([p({type:ha.apiValues,json:{type:ha.jsonValues,read:{reader:ha.read},write:{writer:ha.write}}})],bs.prototype,"outputUnit",void 0),h([_e("outputUnit")],bs.prototype,"readOutputUnit",null),h([be({vectorField:"vector-field"})],bs.prototype,"type",void 0),h([p({type:Xb})],bs.prototype,"styleRenderer",null),h([p({type:u0})],bs.prototype,"sizeVariables",null),h([p({type:jP})],bs.prototype,"rotationVariables",null),bs=KN=h([P("esri.renderers.VectorFieldRenderer")],bs);const Aj=bs,QN={key:"type",base:null,typeMap:{"unique-value":Kb,"class-breaks":Xb,"raster-colormap":Sj,"raster-stretch":Tj,"vector-field":Aj,"raster-shaded-relief":ule,flow:Qae}},e4={...QN,typeMap:{...QN.typeMap}};delete e4.typeMap["vector-field"],delete e4.typeMap.flow;const zNe={uniqueValue:Kb,classBreaks:Xb,rasterStretch:Tj,rasterColormap:Sj,vectorField:Aj,rasterShadedRelief:ule,flowRenderer:Qae};function VNe(t){return t&&zNe[t.type]||null}function jNe(t,e){if(!t)return null;if(t.type==="classBreaks"&&t.classificationMethod){const n=t.authoringInfo||{classificationMethod:""};n.classificationMethod=t.classificationMethod,t.authoringInfo=n}t.type==="vectorField"&&t.visualVariables&&!Array.isArray(t.visualVariables)&&(t.visualVariables=[t.visualVariables]);const i=VNe(t);if(i){const n=new i;return n.read(t,e),n}return e&&e.messages&&t&&e.messages.push(new fl("renderer:unsupported","Renderers of type '"+(t.type||"unknown")+"' are not supported",{definition:t,context:e})),null}var t4;let dg=t4=class extends ie{constructor(t){super(t),this.variableName=null,this.dimensionName=null,this.values=[],this.isSlice=!1}clone(){return new t4({variableName:this.variableName,dimensionName:this.dimensionName,values:q(this.values),isSlice:this.isSlice})}};h([p({type:String,json:{write:!0}})],dg.prototype,"variableName",void 0),h([p({type:String,json:{write:!0}})],dg.prototype,"dimensionName",void 0),h([p({type:d1.array(d1.oneOf([d1.native(Number),d1.array(d1.native(Number))])),json:{write:!0}})],dg.prototype,"values",void 0),h([p({type:Boolean,json:{write:!0}})],dg.prototype,"isSlice",void 0),dg=t4=h([P("esri.layers.support.DimensionalDefinition")],dg);const Wy=dg;var i4;const BNe={base:md,key:"type",typeMap:{extent:Le,polygon:Vr}};let pg=i4=class extends ie{constructor(t){super(t),this.areaOfInterest=null,this.subsetDefinitions=null}get dimensions(){const{subsetDefinitions:t}=this;if(t==null||t.length===0)return[];const e=new Map;t.forEach(n=>{if(!n.dimensionName)return;let r,s;if(Array.isArray(n.values[0])){const o=n.values;r=o[0][0],s=o[n.values.length-1][1]}else{const o=n.values;r=o[0],s=o[n.values.length-1]}if(e.has(n.dimensionName)){const o=e.get(n.dimensionName);o[0]=Math.min(r,o[0]),o[1]=Math.max(s,o[1])}else e.set(n.dimensionName,[r,s])});const i=[];for(const n of e)i.push({name:n[0],extent:n[1]});return i}get variables(){const{subsetDefinitions:t}=this;if(t==null||t.length===0)return[];const e=new Set;return t.forEach(i=>{i.variableName&&e.add(i.variableName)}),[...e]}clone(){var i;const t=(i=this.subsetDefinitions)==null?void 0:i.map(n=>n.clone()),e=this.areaOfInterest?this.areaOfInterest.clone():this.areaOfInterest;return new i4({areaOfInterest:e,subsetDefinitions:t})}};h([p({types:BNe,json:{read:ad,write:!0}})],pg.prototype,"areaOfInterest",void 0),h([p({readOnly:!0})],pg.prototype,"dimensions",null),h([p({readOnly:!0})],pg.prototype,"variables",null),h([p({type:[Wy],json:{write:!0}})],pg.prototype,"subsetDefinitions",void 0),pg=i4=h([P("esri.layers.support.MultidimensionalSubset")],pg);const UNe=pg,GNe=Nn()({RSP_NearestNeighbor:"nearest",RSP_BilinearInterpolation:"bilinear",RSP_CubicConvolution:"cubic",RSP_Majority:"majority"}),nft=Nn()({esriNoDataMatchAny:"any",esriNoDataMatchAll:"all"}),bO=Nn()({U1:"u1",U2:"u2",U4:"u4",U8:"u8",S8:"s8",U16:"u16",S16:"s16",U32:"u32",S32:"s32",F32:"f32",F64:"f64",C64:"c64",C128:"c128",UNKNOWN:"unknown"});let vp=class extends ie{constructor(){super(...arguments),this.pixelType="unknown"}};h([p({type:String,json:{write:!0}})],vp.prototype,"name",void 0),h([p({type:String,json:{write:!0}})],vp.prototype,"description",void 0),h([p({type:It,json:{type:It,write:!0,name:"_object_id"}})],vp.prototype,"id",void 0),h([p({type:String,json:{type:bO.jsonValues,read:bO.read,write:bO.write}})],vp.prototype,"pixelType",void 0),h([p({type:String,json:{write:!0}})],vp.prototype,"type",void 0),vp=h([P("esri.layers.support.RasterFunctionInfo")],vp);const HNe=vp;let vh=class extends ie{constructor(){super(...arguments),this.isDataset=!1,this.isPublic=!1,this.type="RasterFunctionVariable"}};h([p({type:String,json:{write:!0}})],vh.prototype,"name",void 0),h([p({type:Number,json:{type:It,write:!0,name:"_object_id"}})],vh.prototype,"id",void 0),h([p({type:Boolean,json:{write:!0}})],vh.prototype,"isDataset",void 0),h([p({type:Boolean,json:{write:!0}})],vh.prototype,"isPublic",void 0),h([p({json:{write:!0}})],vh.prototype,"value",void 0),h([p({type:String,json:{write:!0}})],vh.prototype,"type",void 0),vh=h([P("esri.layers.support.RasterFunctionVariable")],vh);const qNe=vh,VI={key:"type",base:null,typeMap:{RasterFunctionVariable:qNe}};let fg=class extends ie{};h([p({types:VI,json:{types:VI,name:"MatchVariable"}})],fg.prototype,"matchVariable",void 0),h([p({types:VI,json:{types:VI,name:"UnionDimension"}})],fg.prototype,"unionDimension",void 0),h([p({type:Number,json:{type:It,write:!0,name:"_object_id"}})],fg.prototype,"id",void 0),h([p({type:String,json:{write:!0}})],fg.prototype,"type",void 0),fg=h([P("esri.layers.support.RasterFunctionProperties")],fg);const WNe=fg,wO=new qe({0:"mosaic",1:"item",2:"item-group"},{useNumericKeys:!0});let Ar=class extends ie{constructor(){super(...arguments),this.functionType="mosaic",this.type="RasterFunctionTemplate"}};h([p({type:[String],json:{write:!0}})],Ar.prototype,"aliases",void 0),h([p({type:Object,json:{write:!0}})],Ar.prototype,"arguments",void 0),h([p({type:String,json:{write:!0}})],Ar.prototype,"description",void 0),h([p({type:HNe,json:{write:!0,name:"function"}})],Ar.prototype,"functionInfo",void 0),h([p({type:wO.apiValues,json:{type:[0,1,2],read:wO.read,write:wO.write}})],Ar.prototype,"functionType",void 0),h([p({type:String,json:{write:!0}})],Ar.prototype,"group",void 0),h([p({type:String,json:{write:!0}})],Ar.prototype,"help",void 0),h([p({type:Number,json:{type:It,write:!0,name:"_object_id"}})],Ar.prototype,"id",void 0),h([p({type:String,json:{write:!0}})],Ar.prototype,"name",void 0),h([p({type:String,json:{write:!0,name:"definition"}})],Ar.prototype,"queryDefinition",void 0),h([p({type:String,json:{write:!0}})],Ar.prototype,"tag",void 0),h([p({type:WNe,json:{write:!0}})],Ar.prototype,"properties",void 0),h([p({type:String,json:{write:!0}})],Ar.prototype,"thumbnail",void 0),h([p({type:String,json:{write:!0}})],Ar.prototype,"thumbnailEx",void 0),h([p({json:{type:["RasterFunctionTemplate"],write:!0}})],Ar.prototype,"type",void 0),Ar=h([P("esri.layers.support.RasterFunctionTemplate")],Ar);const Lle=Ar;var n4;const WM=new Set(["raster","raster2","dem","fillraster"]),JM=new Set(["rasters"]),MH=t=>t&&t.rasterFunction?Qs.fromJSON(t):t,xO=t=>t&&t instanceof Qs?t.toJSON():t,r4=t=>(t==null?void 0:t.functionName)&&!t.declaredClass,EH=t=>r4(t)?new Qs(t):t,JNe=t=>{if(t==null)return null;t=q(t);const e={};for(const i of Object.keys(t))WM.has(i.toLowerCase())?e[i]=MH(t[i]):JM.has(i.toLowerCase())&&Array.isArray(t[i])?e[i]=t[i].map(MH):e[i]=t[i];return e},ZNe={types:{key:"type",base:null,typeMap:{RasterFunctionTemplate:Lle}},json:{write:!0,name:"rasterFunctionDefinition"}};let Qs=n4=class extends ie{constructor(t){super(t),this.functionName=null,this.outputPixelType="unknown",this.variableName=null,this.functionDefinition=null}set functionArguments(t){if(t){const e=Object.keys(t);if(e.some(i=>WM.has(i.toLowerCase())&&r4(t[i]))||e.some(i=>JM.has(i.toLowerCase())&&Array.isArray(t[i])&&t[i].some(n=>r4(n)))){t=q(t);for(const i of e)WM.has(i.toLowerCase())?t[i]=EH(t[i]):JM.has(i.toLowerCase())&&Array.isArray(t[i])&&(t[i]=t[i].map(n=>EH(n)))}}this._set("functionArguments",t)}readFunctionArguments(t){return JNe(t)}writeFunctionArguments(t,e,i){const n={};for(const r of Object.keys(t))WM.has(r.toLowerCase())?n[r]=xO(t[r]):JM.has(r.toLowerCase())&&Array.isArray(t[r])?n[r]=t[r].map(xO):n[r]=xO(t[r]);e[i]=n}readFunctionName(t,e){const i=e.rasterFunctionInfos;return e.name||(i&&i.length&&i[0].name!=="None"?i[0].name:e.rasterFunctionDefinition?e.rasterFunctionDefinition.name:e.rasterFunction)}get rasterFunctionDefinition(){var t;return(t=this.functionDefinition)==null?void 0:t.toJSON()}set rasterFunctionDefinition(t){this.functionDefinition=t?Lle.fromJSON(t):null}clone(){return new n4({functionName:this.functionName,functionArguments:q(this.functionArguments),outputPixelType:this.outputPixelType,variableName:this.variableName,rasterFunctionDefinition:q(this.rasterFunctionDefinition)})}};h([p({json:{type:Object,name:"rasterFunctionArguments"}})],Qs.prototype,"functionArguments",null),h([_e("functionArguments")],Qs.prototype,"readFunctionArguments",null),h([ge("functionArguments")],Qs.prototype,"writeFunctionArguments",null),h([p({json:{type:String,write:{target:"rasterFunction"}}})],Qs.prototype,"functionName",void 0),h([_e("functionName",["rasterFunction","rasterFunctionInfos","rasterFunctionDefinition"])],Qs.prototype,"readFunctionName",null),h([be({C128:"c128",C64:"c64",F32:"f32",F64:"f64",S16:"s16",S32:"s32",S8:"s8",U1:"u1",U16:"u16",U2:"u2",U32:"u32",U4:"u4",U8:"u8",UNKNOWN:"unknown"},{ignoreUnknown:!1}),p({json:{default:"unknown"}})],Qs.prototype,"outputPixelType",void 0),h([p({type:String,json:{read:!0,write:!0}})],Qs.prototype,"variableName",void 0),h([p()],Qs.prototype,"rasterFunctionDefinition",null),h([p(ZNe)],Qs.prototype,"functionDefinition",void 0),Qs=n4=h([P("esri.layers.support.RasterFunction")],Qs);const Jy=Qs;let YNe=class{constructor(){this._workerThread=null,this._destroyed=!1}async initialize(){const e=await pne("RasterWorker");this._destroyed?e.close():this._workerThread=e}destroy(){this._destroyed=!0,this._workerThread&&(this._workerThread.close(),this._workerThread=null)}async convertVectorFieldData(e,i){if(!this._workerThread)throw new V("raster-jobhandler:no-connection","no available worker connection");const n=await this._workerThread.invoke("convertVectorFieldData",{pixelBlock:e.pixelBlock.toJSON(),type:e.dataType},i);return n?new ue(n):null}computeStatisticsHistograms(e,i){if(!this._workerThread)throw new V("raster-jobhandler:no-connection","no available worker connection");return this._workerThread.invoke("computeStatisticsHistograms",{pixelBlock:e.pixelBlock.toJSON()},i)}async decode(e,i){if(!this._workerThread)throw new V("raster-jobhandler:no-connection","no available worker connection");const n=await this._workerThread.invoke("decode",e,i);return n?new ue(n):null}async symbolize(e,i){if(!this._workerThread)throw new V("raster-jobhandler:no-connection","no available worker connection");const n={extent:e.extent&&e.extent.toJSON(),pixelBlock:e.pixelBlock!=null&&e.pixelBlock.toJSON(),simpleStretchParams:e.simpleStretchParams,bandIds:e.bandIds},r=await this._workerThread.invoke("symbolize",n,i);return r?new ue(r):null}async updateSymbolizer(e,i){var r;if(!this._workerThread)throw new V("raster-jobhandler:no-connection","no available worker connection");const n=(r=e==null?void 0:e.rendererJSON)==null?void 0:r.histograms;await Promise.all(this._workerThread.broadcast("updateSymbolizer",{symbolizerJSON:e.toJSON(),histograms:n},i))}async updateRasterFunction(e,i){if(!this._workerThread)throw new V("raster-jobhandler:no-connection","no available worker connection");await Promise.all(this._workerThread.broadcast("updateRasterFunction",{rasterFunctionJSON:e.toJSON()},i))}async process(e,i){var r,s;if(!this._workerThread)throw new V("raster-jobhandler:no-connection","no available worker connection");const n=await this._workerThread.invoke("process",{extent:(r=e.extent)==null?void 0:r.toJSON(),primaryPixelSizes:(s=e.primaryPixelSizes)==null?void 0:s.map(o=>o!=null?o.toJSON():null),primaryPixelBlocks:e.primaryPixelBlocks.map(o=>o!=null?o.toJSON():null),primaryRasterIds:e.primaryRasterIds},i);return n?new ue(n):null}async stretch(e,i){if(!this._workerThread)throw new V("raster-jobhandler:no-connection","no available worker connection");if(!(e!=null&&e.pixelBlock))return null;const n={srcPixelBlock:e.pixelBlock.toJSON(),stretchParams:e.stretchParams},r=await this._workerThread.invoke("stretch",n,i);return r?new ue(r):null}async split(e,i){if(!this._workerThread)throw new V("raster-jobhandler:no-connection","no available worker connection");if(!(e!=null&&e.pixelBlock))return null;const n={srcPixelBlock:e.pixelBlock.toJSON(),tileSize:e.tileSize,maximumPyramidLevel:e.maximumPyramidLevel},r=await this._workerThread.invoke("split",n,i);return r&&r.forEach((s,o)=>{r.set(o,s?ue.fromJSON(s):null)}),r}async estimateStatisticsHistograms(e,i){if(!this._workerThread)throw new V("raster-jobhandler:no-connection","no available worker connection");if(!(e!=null&&e.pixelBlock))return null;const n={srcPixelBlock:e.pixelBlock.toJSON()};return await this._workerThread.invoke("estimateStatisticsHistograms",n,i)}async mosaicAndTransform(e,i){var s;if(!this._workerThread)throw new V("raster-jobhandler:no-connection","no available worker connection");if(!((s=e==null?void 0:e.srcPixelBlocks)!=null&&s.length))return{pixelBlock:null};const n={...e,srcPixelBlocks:e.srcPixelBlocks.map(o=>o!=null?o.toJSON():null)},r=await this._workerThread.invoke("mosaicAndTransform",n,i);return{pixelBlock:r.pixelBlock?new ue(r.pixelBlock):null,localNorthDirections:r.localNorthDirections}}async createFlowMesh(e,i){if(!this._workerThread)throw new V("raster-jobhandler:no-connection","no available worker connection");const n={buffer:e.flowData.data.buffer,maskBuffer:e.flowData.mask.buffer,width:e.flowData.width,height:e.flowData.height},{meshType:r,simulationSettings:s}=e,o=await this._workerThread.invoke("createFlowMesh",{meshType:r,flowData:n,simulationSettings:s},{...i,transferList:[n.buffer,n.maskBuffer]});return{vertexData:new Float32Array(o.vertexBuffer),indexData:new Uint32Array(o.indexBuffer)}}getProjectionOffsetGrid(e,i){if(!this._workerThread)throw new V("raster-jobhandler:no-connection","no available worker connection");const n=e.datumTransformation!=null?e.datumTransformation.steps.map(o=>({wkid:o.wkid,wkt:o.wkt,isInverse:o.isInverse})):null,r=e.rasterTransform!=null?e.rasterTransform.toJSON():null,s={projectedExtent:e.projectedExtent.toJSON(),srcBufferExtent:e.srcBufferExtent.toJSON(),pixelSize:e.pixelSize,hasWrapAround:e.hasWrapAround,spacing:e.spacing,datumTransformationSteps:n,rasterTransform:r,isAdaptive:e.isAdaptive,includeGCSGrid:e.includeGCSGrid};return this._workerThread.invoke("getProjectionOffsetGrid",s,i)}};var s4;let Jr=s4=class extends ie{constructor(){super(...arguments),this.blockWidth=void 0,this.blockHeight=void 0,this.compression=null,this.origin=null,this.firstPyramidLevel=null,this.maximumPyramidLevel=null,this.pyramidScalingFactor=2,this.pyramidBlockWidth=null,this.pyramidBlockHeight=null,this.isVirtualTileInfo=!1,this.tileInfo=null,this.transposeInfo=null,this.blockBoundary=null}clone(){return new s4({blockWidth:this.blockWidth,blockHeight:this.blockHeight,compression:this.compression,origin:q(this.origin),firstPyramidLevel:this.firstPyramidLevel,maximumPyramidLevel:this.maximumPyramidLevel,pyramidResolutions:q(this.pyramidResolutions),pyramidScalingFactor:this.pyramidScalingFactor,pyramidBlockWidth:this.pyramidBlockWidth,pyramidBlockHeight:this.pyramidBlockHeight,isVirtualTileInfo:this.isVirtualTileInfo,tileInfo:q(this.tileInfo),transposeInfo:q(this.transposeInfo),blockBoundary:q(this.blockBoundary)})}};h([p({type:Number,json:{write:!0}})],Jr.prototype,"blockWidth",void 0),h([p({type:Number,json:{write:!0}})],Jr.prototype,"blockHeight",void 0),h([p({type:String,json:{write:!0}})],Jr.prototype,"compression",void 0),h([p({type:pe,json:{write:!0}})],Jr.prototype,"origin",void 0),h([p({type:Number,json:{write:!0}})],Jr.prototype,"firstPyramidLevel",void 0),h([p({type:Number,json:{write:!0}})],Jr.prototype,"maximumPyramidLevel",void 0),h([p({json:{write:!0}})],Jr.prototype,"pyramidResolutions",void 0),h([p({type:Number,json:{write:!0}})],Jr.prototype,"pyramidScalingFactor",void 0),h([p({type:Number,json:{write:!0}})],Jr.prototype,"pyramidBlockWidth",void 0),h([p({type:Number,json:{write:!0}})],Jr.prototype,"pyramidBlockHeight",void 0),h([p({type:Boolean,json:{write:!0}})],Jr.prototype,"isVirtualTileInfo",void 0),h([p({json:{write:!0}})],Jr.prototype,"tileInfo",void 0),h([p()],Jr.prototype,"transposeInfo",void 0),h([p()],Jr.prototype,"blockBoundary",void 0),Jr=s4=h([P("esri.layers.support.RasterStorageInfo")],Jr);const t1=Jr;function Rle(t,e,i){var s;const n=e.shift();if(i.length===0){const o=[];i.push({sliceId:-1,multidimensionalDefinition:o})}const r=i.length;for(let o=0;o<r;o++){const a=i.shift().multidimensionalDefinition;(s=n.values)==null||s.forEach(l=>{i.push({sliceId:-1,multidimensionalDefinition:[...a,{variableName:t,dimensionName:n.name,values:[l]}]})})}e.length&&Rle(t,e,i)}function XNe(t,e){const i=[];let n=0;return(e?t.variables.filter(r=>r.name.toLowerCase()===e.toLowerCase()):[...t.variables].sort((r,s)=>r.name>s.name?1:-1)).forEach(r=>{const s=[],o=[...r.dimensions].sort((a,l)=>a.name>l.name?-1:1);Rle(r.name,o,s),s.forEach(a=>{i.push({...a,sliceId:n++})})}),i}function KNe(t,e,i){let n=t;if(e&&(e=[...e].sort((r,s)=>r.dimensionName<s.dimensionName?-1:1)).forEach(({dimensionName:r,values:s,isSlice:o})=>{s.length&&(n=n.filter(a=>{const l=a.multidimensionalDefinition.find(u=>u.dimensionName===r);if(l==null)return!1;const c=l.values[0];return typeof c=="number"?typeof s[0]=="number"?s.includes(c):s.some(u=>u[0]<=c&&u[1]>=c):typeof s[0]=="number"?s.some(u=>c[0]<=u&&c[1]>=u):o?s.some(u=>u[0]===c[0]&&u[0]===c[1]):s.some(u=>u[0]>=c[0]&&u[0]<=c[1]||u[1]>=c[0]&&u[1]<=c[1]||u[0]<c[0]&&u[1]>c[1])}))}),n.length&&i&&i.start!=null&&i.end!=null){const r=i.start.getTime(),s=i.end.getTime(),o=n[0].multidimensionalDefinition.findIndex(a=>a.dimensionName==="StdTime");o>-1&&(n=n.filter(a=>{const l=a.multidimensionalDefinition[o].values[0];return r<=l&&s>=l}))}return n.map(r=>r.sliceId)}function Dle(t,e){return Array.isArray(t)?e[0]===e[1]?t[0]===e[0]||t[1]===e[0]:t[0]>=e[0]&&t[0]<=e[1]&&t[1]>=e[0]&&t[1]<=e[1]:t>=e[0]&&t<=e[1]}function QNe(t,e){return t[0]<=e[0]&&t[1]>=e[0]||t[0]<=e[1]&&t[1]>=e[1]||t[0]>=e[0]&&t[1]<=e[1]}function Nle(t){return t.length===1?[t[0],t[0]]:[t[0],t[t.length-1]]}function Fle(t,e,i){var o,a;if(!((o=e==null?void 0:e.subsetDefinitions)!=null&&o.length))return t;let n;if(i){const{variables:l}=e;if(l.length&&!l.includes(i))return null;const c=e.subsetDefinitions.find(u=>u.dimensionName===t.name&&u.variableName===i);if(!((a=c==null?void 0:c.values)!=null&&a.length))return t;n=Nle(c.values)}else{const l=e.dimensions.find(({name:c})=>c===t.name);n=l==null?void 0:l.extent}const r=n;if(!r||!(r!=null&&r.length))return t;const s=t.values.filter(l=>Dle(l,r));return{...t,extent:[...r],values:s}}function $j(t,e,i){var r;if(!((r=e==null?void 0:e.subsetDefinitions)!=null&&r.length))return!1;const{variables:n}=e;if(n.length&&t.some(({variableName:s})=>s&&!n.includes(s)))return!0;for(let s=0;s<t.length;s++){const o=t[s],a=e.subsetDefinitions.find(l=>(o.variableName===""||l.variableName===o.variableName)&&l.dimensionName===o.dimensionName);if(a!=null&&a.values.length){const l=Nle(a.values);if(!o.isSlice&&o.values.length===2&&!Array.isArray(o.values[0])&&o.values[0]!==o.values[1]&&i){if(!QNe(o.values,l))return!0}else if(o.values.some(c=>!Dle(c,l)))return!0}}return!1}function cft(t,e){if(t==null)return{isOutside:!1};const{geometry:i,timeExtent:n,multidimensionalDefinition:r}=e;let s=null;if(n!=null&&(s=e4e(t,n),s==null))return{isOutside:!0};const{areaOfInterest:o}=t;if(o&&i){const a=i.type==="point"?i:i.type==="extent"?i.center:i.type==="polygon"?i.centroid:null;if(a&&!o.contains(a))return{isOutside:!0}}return r!=null&&r.length&&$j(r,t,!0)?{isOutside:!0}:{isOutside:!1,intersection:{geometry:i,timeExtent:s,multidimensionalDefinition:r}}}function e4e(t,e){const i=t.dimensions.find(({name:o})=>o==="StdTime");if(i==null||e.start==null&&e.end==null)return e;e=e.clone();const{start:n,end:r}=e.toJSON(),s=n===r?[n]:n!=null&&r!=null?[n,r]:[n??r];return s.length===2&&(i!=null&&i.extent.length)&&(s[0]=Math.max(s[0],i.extent[0]),s[1]=Math.min(s[1],i.extent[1]??i.extent[0]),s[1]<s[0])||$j([new Wy({variableName:"",dimensionName:"StdTime",isSlice:s.length===1,values:s})],t,!0)?null:(e.start=new Date(s[0]),e.end=new Date(s[1]??s[0]),e)}function o4(t,e={}){var u,d;const{multidimensionalInfo:i,keyProperties:n}=t;if(i==null)return null;const{variableName:r,multidimensionalSubset:s,multidimensionalDefinition:o}=e,a=o!=null?(u=o[0])==null?void 0:u.variableName:null,l=r||a||(n==null?void 0:n.DefaultVariable);let{variables:c}=i;return(d=s==null?void 0:s.variables)!=null&&d.length&&(c=c.filter(({name:f})=>s.variables.includes(f))),l?c.find(({name:f})=>f===l)??c[0]:c[0]}function AH(t,e={}){const i=o4(t,e);if(!i)return null;const n=[],{dimensions:r,name:s}=i;if(r.length===0)return[new Wy({variableName:s,dimensionName:"",values:[],isSlice:!0})];for(let o=0;o<r.length;o++){const a=Fle(r[o],e.multidimensionalSubset,s);if(!a)return null;const{values:l,extent:c}=a;let u=(l==null?void 0:l[0])??c[0];a.name.toLowerCase()==="stdz"&&!a.hasRanges&&Math.abs(c[1])<=Math.abs(c[0])&&(u=l!=null&&l.length?l[l.length-1]:c[1]),n.push(new Wy({variableName:s,dimensionName:a.name,values:[u],isSlice:!e.useRangeForRangedDimensionInfo||!!a.hasRanges}))}return n}function zle(t){return!(t==null||!t.length)&&t.some(e=>{if(e.values==null)return!0;const i=e.values.length;return i===0||i>1||!e.isSlice&&Array.isArray(e.values[0])})}function t4e(t,e){var n;if(e==null||t==null)return null;let i=e.variables.map(r=>({...r}));return(n=t==null?void 0:t.variables)!=null&&n.length&&(i=i.filter(({name:r})=>t.variables.includes(r)),i.forEach(r=>{r.dimensions=r.dimensions.map(s=>Fle(s,t,r.name)).filter(Ti)})),i}function i4e(t,e){var a;const{values:i}=e;if(i!=null&&i.length){const l=Array.isArray(i[0]),c=Array.isArray(t);return l!==c?-1:l&&c?i.findIndex(u=>u[0]===t[0]&&u[1]===t[1]):i.indexOf(t)}const{extent:n}=e;if(Array.isArray(t)||t<n[0]||t>n[1])return-1;const r=e.interval||1;if(e.unit!=="ISO8601")return Math.round((t-n[0])/r);const s=n[0];let o=-1;switch(((a=e.intervalUnit)==null?void 0:a.toLowerCase())||"seconds"){case"seconds":o=Math.round((t-s)/1e3/r);break;case"minutes":o=Math.round((t-s)/6e4/r);break;case"hours":o=Math.round((t-s)/36e5/r);break;case"days":o=Math.round((t-s)/864e5/r);break;case"months":{const l=new Date(t).getUTCFullYear()-new Date(s).getUTCFullYear(),c=new Date(s).getUTCMonth(),u=new Date(t).getUTCMonth();o=l===0?u-c:u+11-c+12*(l-1)}break;case"years":o=Math.round((new Date(t).getUTCFullYear()-new Date(s).getUTCFullYear())/r);break;case"decades":o=Math.round((new Date(t).getUTCFullYear()-new Date(s).getUTCFullYear())/10/r)}return o}function $H(t){var o,a;let e=(o=t.values)==null?void 0:o.length;if(e)return e;const{extent:i,unit:n}=t,r=t.interval||1,s=i?i[1]-i[0]:0;if(n!=="ISO8601")return Math.round(s/r);switch(((a=t.intervalUnit)==null?void 0:a.toLowerCase())??"seconds"){case"seconds":e=Math.round(s/1e3/r);break;case"minutes":e=Math.round(s/6e4/r);break;case"hours":e=Math.round(s/36e5/r);break;case"days":e=Math.round(s/864e5/r);break;case"months":{const l=new Date(i[1]).getUTCFullYear()-new Date(i[0]).getUTCFullYear(),c=new Date(i[0]).getUTCMonth(),u=new Date(i[1]).getUTCMonth();e=l===0?u-c+1:u+11-c+12*(l-1)+1}break;case"years":e=Math.round((new Date(i[1]).getUTCFullYear()-new Date(i[0]).getUTCFullYear())/r);break;case"decades":e=Math.round((new Date(i[1]).getUTCFullYear()-new Date(i[0]).getUTCFullYear())/10/r);break;default:e=0}return e}function n4e(t,e){let i=0;const n=t[0].variableName,r=[...e.variables].sort((s,o)=>s.name>o.name?1:-1);for(let s=0;s<r.length;s++){const o=r[s],a=[...o.dimensions].sort((u,d)=>u.name>d.name?-1:1);if(o.name!==n){i+=a.map(u=>$H(u)).reduce((u,d)=>u*d);continue}const l=a.map(u=>$H(u)),c=a.length;for(let u=0;u<c;u++){const d=t.find(m=>m.dimensionName===a[u].name);if(d==null)return null;const f=i4e(d.values[0],a[u]);if(f===-1)return null;l.shift(),i+=u===c-1?f:f*l.reduce((m,g)=>m*g)}break}return i}let r4e=class{constructor(e=15e3,i=5e3){this._timer=null,this._cachedBlocks=new Map,this._size=-1,this._duration=e,this._interval=Math.min(e,i)}decreaseRefCount(e,i){const n=e+"/"+i,r=this._cachedBlocks;if(r.has(n)){const s=r.get(n);return s.refCount--,s.refCount<=0&&(r.delete(n),s.controller&&s.controller.abort()),s.refCount}return 0}getBlock(e,i){const n=e+"/"+i,r=this._cachedBlocks;if(r.has(n)){const s=r.get(n);return s.ts=Date.now(),s.refCount++,r.delete(n),r.set(n,s),s.block}return null}putBlock(e,i,n,r){const s=this._cachedBlocks,o=e+"/"+i;if(s.has(o)){const a=s.get(o);a.ts=Date.now(),a.refCount++}else s.set(o,{block:n,ts:Date.now(),refCount:1,controller:r});this._trim(),this._updateTimer()}deleteBlock(e,i){const n=this._cachedBlocks,r=e+"/"+i;n.has(r)&&n.delete(r)}updateMaxSize(e){this._size=e,this._trim()}empty(){this._cachedBlocks.clear(),this._clearTimer()}getCurrentSize(){return this._cachedBlocks.size}_updateTimer(){if(this._timer!=null)return;const e=this._cachedBlocks;this._timer=setInterval(()=>{const i=Array.from(e),n=Date.now();for(let r=0;r<i.length&&i[r][1].ts<=n-this._duration;r++)e.delete(i[r][0]);e.size===0&&this._clearTimer()},this._interval)}_trim(){const e=this._cachedBlocks;if(this._size===-1||this._size>=e.size)return;const i=Array.from(e);for(let n=0;n<i.length-this._size;n++)e.delete(i[n][0])}_clearTimer(){this._timer!=null&&(clearInterval(this._timer),this._timer=null)}};var a4;function Vle(t,e,i){return!yl(t,e,i)}function h0(t,e,i){const n=Vle(t,e,i);if(n&&!wl())throw new V("rasterprojectionhelper-project","projection engine is not loaded");return n}(function(t){t[t.None=0]="None",t[t.North=1]="North",t[t.South=2]="South",t[t.Both=3]="Both"})(a4||(a4={}));const PH=(t,e,i,n=0)=>{if(i[0]===1)return[0,0];let r=1,s=-1,o=1,a=-1;for(let _=0;_<t.length;_+=2)isNaN(t[_])||(r=r>t[_]?t[_]:r,s=s>t[_]?s:t[_],o=o>t[_+1]?t[_+1]:o,a=a>t[_+1]?a:t[_+1]);const{cols:l,rows:c}=e,u=(s-r)/l/i[0],d=(a-o)/c/i[1],f=2*n;let m=0,g=!1,y=[0,0];for(let _=0;_<l-3;_++){for(let b=0;b<c-3;b++){const w=_*c*2+2*b,x=(t[w]+t[w+4]+t[w+4*c]+t[w+4*c+4])/4,S=(t[w+1]+t[w+5]+t[w+4*c+1]+t[w+4*c+5])/4,T=Math.abs((x-t[w+2*c+2])/u),I=Math.abs((S-t[w+2*c+3])/d);if(T+I>m&&(m=T+I,y=[T,I]),f&&m>f){g=!0;break}}if(g)break}return y},s4e={3395:20037508342789244e-9,3410:17334193943686873e-9,3857:20037508342788905e-9,3975:17367530445161372e-9,4087:20037508342789244e-9,4088:20015108787169147e-9,6933:17367530445161372e-9,32662:20037508342789244e-9,53001:2001508679602057e-8,53002:1000754339801029e-8,53003:2001508679602057e-8,53004:2001508679602057e-8,53016:14152803599503474e-9,53017:17333573624304302e-9,53034:2001508679602057e-8,53079:20015114352186374e-9,53080:20015114352186374e-9,54001:20037508342789244e-9,54002:10018754171394624e-9,54003:20037508342789244e-9,54004:20037508342789244e-9,54016:14168658027268292e-9,54017:1736753044516137e-8,54034:20037508342789244e-9,54079:20037508342789244e-9,54080:20037508342789244e-9,54100:20037508342789244e-9,54101:20037508342789244e-9},qA=32,WA=4,SO=WA,TO=new Map,IO=new Map,JA=500;async function l4(){wl()||await Ic()}function hft(t,e,i){return h0(t.spatialReference,e),i?yA(e,t.spatialReference,t):yA(t.spatialReference,e,t)}function ZA(t,e,i,n=null){const r=t.spatialReference;if(r.equals(e))return t;h0(r,e,n);const s=i.center,o=new Le({xmin:s.x-t.x/2,xmax:s.x+t.x/2,ymin:s.y-t.y/2,ymax:s.y+t.y/2,spatialReference:r}),a=an(o,e,n),l=Lo(e);let c;if(a==null||l!=null&&a.width>=l){const u=pi(r)/pi(e);c={x:t.x*u,y:t.y*u}}else c={x:a.width,y:a.height};return c}function ga(t,e=.01){return pi(t)?e/pi(t):0}function YA(t,e,i=null,n=!0){const r=t.spatialReference;if(r.equals(e))return t;h0(r,e,i);const s=an(t,e,i);return n&&s&&jle([t],[s],r,e),s}function jle(t,e,i,n){const r=XA(i,!0),s=XA(n,!0),o=ga(i,JA),a=ga(n,JA);if(o&&r!=null&&s!=null)for(let l=0;l<t.length;l++){const c=e[l];if(!c)continue;const{x:u}=t[l],{x:d}=c;d>=s[1]-a&&Math.abs(u-r[0])<o?c.x-=s[1]-s[0]:d<=s[0]+a&&Math.abs(u-r[1])<o&&(c.x+=s[1]-s[0])}}function o4e(t){const{inSR:e,outSR:i,datumTransformation:n,preferPE:r}=t;if(e.equals(i)){const{points:s}=Pj(t,null);return s}return e.isWebMercator&&i.isWGS84||e.isWGS84&&i.isWebMercator?l4e(t):h0(e,i,n)&&r&&(e.isGeographic||Zy(e)!=null)?kH(t):a4e(t)}function a4e(t){const{points:e}=Pj(t,null),{inSR:i,outSR:n,datumTransformation:r}=t,s=e.map(a=>new pe(a[0],a[1],i)),o=an(s,n,r);return r&&jle(s,o,i,n),o.map(a=>a?[a.x,a.y]:[NaN,NaN])}function kH(t){const{inSR:e,outSR:i,datumTransformation:n}=t,r=Zy(e),{points:s,mask:o}=Pj(t,r);if(!e.isGeographic){const l=e.wkid?pa.coordsys(e.wkid):pa.fromString(e.isGeographic?Pt.PE_TYPE_GEOGCS:Pt.PE_TYPE_PROJCS,e.wkt);G2.projToGeog(l,s.length,s)}if(n!=null&&n.steps.length){let l;if(i.isGeographic&&(l=s.map(([u])=>u>179.9955?1:u<-179.9955?-1:0)),n.steps.forEach(u=>{const d=u.wkid?pa.geogtran(u.wkid):pa.fromString(Pt.PE_TYPE_GEOGTRAN,u.wkt);pA.geogToGeog(d,s.length,s,null,u.isInverse?Pt.PE_TRANSFORM_2_TO_1:Pt.PE_TRANSFORM_1_TO_2)}),l)for(let u=0;u<s.length;u++){const d=l[u],f=s[u][0],m=f>179.9955?1:f<-179.9955?-1:0;d&&m&&d!==m&&(s[u][0]=d>0?f+360:f-360)}}if(!i.isGeographic){const l=Zy(i,!0),c=l!=null&&l.isEnvelope?[l.bbox[1],l.bbox[3]]:[-90,90];c4e(s,c);const u=i.wkid?pa.coordsys(i.wkid):pa.fromString(i.isGeographic?Pt.PE_TYPE_GEOGCS:Pt.PE_TYPE_PROJCS,i.wkt);G2.geogToProj(u,s.length,s)}let a=s;if(o&&s.length!==o.length){a=[];for(let l=0,c=0;l<o.length;l++)o[l]?a.push(s[c++]):a.push([NaN,NaN])}return a}function l4e(t){const{cols:e,rows:i,xres:n,yres:r,usePixelCenter:s,inSR:o,outSR:a}=t;let{xmin:l,ymax:c}=t;s&&(l+=n/2,c-=r/2);const u=[],d=[],f=Math.max(e,i);for(let g=0;g<f;g++){const y=l+n*Math.min(e,g),_=c-r*Math.min(i,g),b=an(new pe({x:y,y:_,spatialReference:o}),a);g<=e&&u.push(b.x),g<=i&&d.push(b.y)}const m=[];for(let g=0;g<e;g++)for(let y=0;y<i;y++)m.push([u[g],d[y]]);return m}function Zy(t,e=!1){let i=t.wkid||t.wkt;if(!i||t.isGeographic)return null;if(i=String(i),TO.has(i)){const o=TO.get(i);return e?o==null?void 0:o.gcs:o==null?void 0:o.pcs}const n=t.wkid?pa.coordsys(t.wkid):pa.fromString(t.isGeographic?Pt.PE_TYPE_GEOGCS:Pt.PE_TYPE_PROJCS,t.wkt),r=OH(n,ga(t,1e-4)),s=OH(n,0,!0);return TO.set(i,{pcs:r,gcs:s}),e?s:r}function OH(t,e=0,i=!1){const n=H2.generate(t),r=i?t.horizonGcsGenerate():t.horizonPcsGenerate();if(!n||!(r!=null&&r.length))return null;let s=!1,o=r.find(_=>_.getInclusive()===1&&_.getKind()===1);if(!o){if(o=r.find(_=>_.getInclusive()===1&&_.getKind()===0),!o)return null;s=!0}const a=i?0:(n.getNorthPoleLocation()===2?1:0)|(n.getSouthPoleLocation()===2?2:0),l=n.isPannableRectangle(),c=o.getCoord();if(s)return{isEnvelope:s,isPannable:l,vertices:c,coef:null,bbox:[c[0][0]-e,c[0][1]-e,c[1][0]+e,c[1][1]+e],poleLocation:a};let u=0;const d=[];let[f,m]=c[0],[g,y]=c[0];for(let _=0,b=c.length;_<b;_++){u++,u===b&&(u=0);const[w,x]=c[_],[S,T]=c[u];if(T===x)d.push([w,S,x,T,2]);else{const I=(S-w)/(T-x||1e-4),C=w-I*x;x<T?d.push([I,C,x,T,0]):d.push([I,C,T,x,1])}f=f<w?f:w,m=m<x?m:x,g=g>w?g:w,y=y>x?y:x}return{isEnvelope:!1,isPannable:l,vertices:c,coef:d,bbox:[f,m,g,y],poleLocation:a}}function Pj(t,e){const i=[],{cols:n,rows:r,xres:s,yres:o,usePixelCenter:a}=t;let{xmin:l,ymax:c}=t;if(a&&(l+=s/2,c-=o/2),e==null){for(let m=0;m<n;m++)for(let g=0;g<r;g++)i.push([l+s*m,c-o*g]);return{points:i}}const u=new Uint8Array(n*r);if(e.isEnvelope){const{bbox:[m,g,y,_]}=e;for(let b=0,w=0;b<n;b++){const x=l+s*b,S=e.isPannable||x>=m&&x<=y;for(let T=0;T<r;T++,w++){const I=c-o*T;S&&I>=g&&I<=_&&(i.push([x,I]),u[w]=1)}}return{points:i,mask:u}}const d=e.coef,f=[];for(let m=0;m<r;m++){const g=c-o*m,y=[],_=[];for(let w=0;w<d.length;w++){const[x,S,T,I,C]=d[w];if(g===T&&T===I)y.push(x),y.push(S),_.push(2),_.push(2);else if(g>=T&&g<=I){const M=x*g+S;y.push(M),_.push(C)}}let b=y;if(y.length>2){let w=_[0]===2?0:_[0],x=y[0];b=[];for(let S=1;S<_.length;S++)_[S]===2&&S!==_.length-1||(_[S]!==w&&(b.push(w===0?Math.min(x,y[S-1]):Math.max(x,y[S-1])),w=_[S],x=y[S]),S===_.length-1&&b.push(_[S]===0?Math.min(x,y[S]):Math.max(x,y[S])));b.sort((S,T)=>S-T)}else y[0]>y[1]&&(b=[y[1],y[0]]);f.push(b)}for(let m=0,g=0;m<n;m++){const y=l+s*m;for(let _=0;_<r;_++,g++){const b=c-o*_,w=f[_];if(w.length===2)y>=w[0]&&y<=w[1]&&(i.push([y,b]),u[g]=1);else if(w.length>2){let x=!1;for(let S=0;S<w.length;S+=2)if(y>=w[S]&&y<=w[S+1]){x=!0;break}x&&(i.push([y,b]),u[g]=1)}}}return{points:i,mask:u}}function c4e(t,e){const[i,n]=e;for(let r=0;r<t.length;r++){const s=t[r][1];(s<i||s>n)&&(t[r]=[NaN,NaN])}}function Ble(t){const e=Lo(t[0].spatialReference);if(t.length<2||e==null)return t[0];const i=ga(t[0].spatialReference);if((t=t.filter(a=>a.width>i)).length===1)return t[0];let{xmin:n,xmax:r,ymin:s,ymax:o}=t[0];for(let a=1;a<t.length;a++){const l=t[a];r=l.xmax+e*a,s=Math.min(s,l.ymin),o=Math.max(o,l.ymax)}return new Le({xmin:n,xmax:r,ymin:s,ymax:o,spatialReference:t[0].spatialReference})}function Sy(t,e,i=null,n=!0){const r=t.spatialReference;if(r.equals(e))return t;const s=ZM(t),o=Lo(r,!0),a=Lo(e);if(s===0||o==null||a==null){const c=LH(t,e,i,n);if(o==null&&a!=null&&Math.abs(c.width-a)<ga(e)&&wl()){const u=Zy(r);if(u!=null&&u.poleLocation===a4.None&&t.width<(u.bbox[2]-u.bbox[0])/2)return h4e(t,e)||c}return c}const l=t.clone().normalize();if(l.length===1&&t.xmax<o&&t.xmax-o/2>ga(r)){const{xmin:c,xmax:u}=t;for(let d=0;d<=s;d++){const f=d===0?c:-o/2,m=d===s?u-o*d:o/2;l[d]=new Le({xmin:f,xmax:m,ymin:t.ymin,ymax:t.ymax,spatialReference:r})}}return Ble(l.map(c=>LH(c,e,i,n)).filter(Ti))}function u4e(t,e,i){if(t.type==="extent"){const{xmin:n,ymin:r,xmax:s,ymax:o,spatialReference:a}=t;t=new Vr({rings:[[[n,o],[s,o],[s,r],[n,r],[n,o]]],spatialReference:a})}return t.spatialReference.equals(e)?t:(h0(t.spatialReference,e,i),an(t,e,i))}function h4e(t,e){const i=Lo(e);if(i==null)return null;let{xmin:n,ymin:r,xmax:s,ymax:o}=t;const a=t.spatialReference,l=new Vr({spatialReference:a,rings:[[[n,r],[s,r],[s,o],[n,o],[n,r]]]}),c=an(l,e);if(c.rings.length!==2||!c.rings[0].length||!c.rings[1].length)return null;const{rings:u}=c,d=ga(a),f=new Le({spatialReference:e});for(let m=0;m<2;m++){n=s=u[m][0][0],r=o=u[m][0][1];for(let g=0;g<u[m].length;g++)n=n>u[m][g][0]?u[m][g][0]:n,s=s<u[m][g][0]?u[m][g][0]:s,r=r>u[m][g][1]?u[m][g][1]:r,o=o<u[m][g][1]?u[m][g][1]:o;if(m===0)f.ymin=r,f.ymax=o,f.xmin=n,f.xmax=s;else if(f.ymin=Math.min(f.ymin,r),f.ymax=Math.max(f.ymax,o),Math.abs(s-i/2)<d)f.xmin=n,f.xmax=f.xmax+i;else{if(!(Math.abs(n+i/2)<d))return null;f.xmax=s+i}}return f}function LH(t,e,i=null,n=!0,r=!0){const s=t.spatialReference;if(s.equals(e)||!e)return t;h0(s,e,i);const o=an(t,e,i);if(r&&e.isWebMercator&&o&&(o.ymax=Math.min(20037508342787e-6,o.ymax),o.ymin=Math.max(-20037508342787e-6,o.ymin),o.ymin>=o.ymax))return null;if(!n||!o)return o;const a=XA(s,!0),l=XA(e,!0);if(a==null||l==null)return o;const c=ga(s,.001),u=ga(s,JA),d=ga(e,.001);if(Math.abs(o.xmin-l[0])<d&&Math.abs(o.xmax-l[1])<d){const f=Math.abs(t.xmin-a[0]),m=Math.abs(a[1]-t.xmax);if(f<c&&m>u){o.xmin=l[0];const g=[];g.push(new pe(t.xmax,t.ymin,s)),g.push(new pe(t.xmax,(t.ymin+t.ymax)/2,s)),g.push(new pe(t.xmax,t.ymax,s));const y=g.map(_=>YA(_,e,i)).filter(_=>!isNaN(_==null?void 0:_.x)).map(_=>_.x);o.xmax=Math.max.apply(null,y)}if(m<c&&f>u){o.xmax=l[1];const g=[];g.push(new pe(t.xmin,t.ymin,s)),g.push(new pe(t.xmin,(t.ymin+t.ymax)/2,s)),g.push(new pe(t.xmin,t.ymax,s));const y=g.map(_=>YA(_,e,i)).filter(_=>!isNaN(_==null?void 0:_.x)).map(_=>_.x);o.xmin=Math.min.apply(null,y)}}else{const f=ga(e,.001);Math.abs(o.xmin-l[0])<f&&(o.xmin=l[0]),Math.abs(o.xmax-l[1])<f&&(o.xmax=l[1])}return o}function Lo(t,e=!1){if(!t)return null;const i=e?20037508342787e-6:20037508342788905e-9;return t.isWebMercator?2*i:t.wkid&&t.isGeographic?360:2*s4e[t.wkid]||null}function XA(t,e=!1){if(t.isGeographic)return[-180,180];const i=Lo(t,e);return i!=null?[-i/2,i/2]:null}function RH(t,e,i,n){let r=(t-e)/i;return r-Math.floor(r)!=0?r=Math.floor(r):n&&(r-=1),r}function ZM(t,e=!1){const i=Lo(t.spatialReference);if(i==null)return 0;const n=e?0:-(i/2),r=ga(t.spatialReference),s=!e&&Math.abs(t.xmax-i/2)<r?i/2:t.xmax,o=!e&&Math.abs(t.xmin+i/2)<r?-i/2:t.xmin;return RH(s,n,i,!0)-RH(o,n,i,!1)}function d4e(t){const e=t.storageInfo.origin.x,i=Lo(t.spatialReference,!0);if(i==null)return{originX:e,halfWorldWidth:null,pyramidsInfo:null};const n=i/2,{nativePixelSize:r,storageInfo:s,extent:o}=t,{maximumPyramidLevel:a,blockWidth:l,pyramidScalingFactor:c}=s;let u=r.x;const d=[],f=t.transform!=null&&t.transform.type==="gcs-shift",m=e+(f?0:n),g=f?i-e:n-e;for(let y=0;y<=a;y++){const _=(o.xmax-e)/u/l,b=_-Math.floor(_)==0?_:Math.ceil(_),w=g/u/l,x=w-Math.floor(w)==0?w:Math.ceil(w),S=Math.floor(m/u/l),T=Math.round(m/u)%l,I=(l-Math.round(g/u)%l)%l;d.push({resolutionX:u,blockWidth:l,datsetColumnCount:b,worldColumnCountFromOrigin:x,leftMargin:T,rightPadding:I,originColumnOffset:S}),u*=c}return{originX:e,halfWorldWidth:n,pyramidsInfo:d,hasGCSSShiftTransform:f}}function p4e(t){if(!t||t.isGeographic)return t;const e=String(t.wkid||t.wkt);let i;return IO.has(e)?i=IO.get(e):(i=(t.wkid?pa.coordsys(t.wkid):pa.fromString(Pt.PE_TYPE_PROJCS,t.wkt)).getGeogcs().getCode(),IO.set(e,i)),new Ee({wkid:i})}function f4e(t){const e=t.isAdaptive&&t.spacing==null;let i=t.spacing||[qA,qA],n=CO(t),r={cols:n.size[0]+1,rows:n.size[1]+1};const s=n.outofBoundPointCount>0&&n.outofBoundPointCount<n.offsets.length/2;let o=n.outofBoundPointCount===n.offsets.length/2||e&&s?[0,0]:PH(n.offsets,r,i,SO);const a=(o[0]+o[1])/2,l=t.projectedExtent.spatialReference,c=t.srcBufferExtent.spatialReference;if(e&&(s||a>SO)&&(Vle(l,c,t.datumTransformation)&&(l.isGeographic||Zy(l)),i=[WA,WA],n=CO({...t,spacing:i}),r={cols:n.size[0]+1,rows:n.size[1]+1},o=PH(n.offsets,r,i,SO)),n.error=o,i[0]>1&&(n.coefficients=DH(n.offsets,r,s)),t.includeGCSGrid&&!l.isGeographic&&!l.isWebMercator)if(c.isGeographic)n.gcsGrid={offsets:n.offsets,coefficients:n.coefficients,spacing:i};else{const u=Zy(l);if(u!=null&&!u.isEnvelope){const d=p4e(l),f=Sy(t.projectedExtent,d),{offsets:m}=CO({...t,srcBufferExtent:f,spacing:i}),g=DH(m,r,s);n.gcsGrid={offsets:m,coefficients:g,spacing:i}}}return n}function CO(t){const{projectedExtent:e,srcBufferExtent:i,pixelSize:n,datumTransformation:r,rasterTransform:s}=t,o=e.spatialReference,a=i.spatialReference,l=h0(o,a),{xmin:c,ymin:u,xmax:d,ymax:f}=e,m=Lo(a),g=m!=null&&(t.hasWrapAround||(s==null?void 0:s.type)==="gcs-shift"),y=t.spacing||[qA,qA],_=y[0]*n.x,b=y[1]*n.y,w=y[0]===1,x=Math.ceil((d-c)/_-.1/y[0])+(w?0:1),S=Math.ceil((f-u)/b-.1/y[1])+(w?0:1),T=o4e({cols:x,rows:S,xmin:c,ymax:f,xres:_,yres:b,inSR:o,outSR:a,datumTransformation:r,preferPE:y[0]<=WA,usePixelCenter:w}),I=[];let C,M=0;const E=w?-1:NaN,{xmin:A,xmax:$,ymax:L,width:D,height:F}=i,z=ga(a,JA),U=m!=null&&A>0&&$>m/2;let G=!1;if(l){const W=Zy(o);G=W!=null&&W.poleLocation>0}for(let W=0;W<x;W++){const Z=[];for(let X=0;X<S;X++){let oe=T[W*S+X];if(g&&oe[0]>$&&oe[0]>m/2-z?oe[0]-=m:g&&W===0&&oe[0]<0&&U&&!s&&(oe[0]+=m),!oe||isNaN(oe[0])||isNaN(oe[1]))I.push(E),I.push(E),Z.push(null),M++;else{if(s){const se=s.inverseTransform(new pe({x:oe[0],y:oe[1],spatialReference:a}));oe=[se.x,se.y]}Z.push(oe),W>0&&g&&C[X]&&oe[0]<C[X][0]&&(oe[0]+=m,G&&oe[0]>$&&oe[0]>m&&(oe[0]-=m)),I.push((oe[0]-A)/D),I.push((L-oe[1])/F)}}C=Z}return{offsets:I,error:null,coefficients:null,outofBoundPointCount:M,spacing:y,size:w?[x,S]:[x-1,S-1]}}function DH(t,e,i){const{cols:n,rows:r}=e,s=new Float32Array((n-1)*(r-1)*2*6),o=new Float32Array([-0,-1,1,-1,1,-0,1,-0,-0]),a=new Float32Array([-1,1,0,0,-1,1,1,0,0]);for(let l=0;l<n-1;l++){for(let c=0;c<r-1;c++){let u=l*r*2+2*c;const d=t[u],f=t[u+1],m=t[u+2],g=t[u+3];u+=2*r;const y=t[u],_=t[u+1],b=t[u+2],w=t[u+3];let x=0,S=12*(c*(n-1)+l);for(let T=0;T<3;T++)s[S++]=o[x++]*d+o[x++]*m+o[x++]*b;x=0;for(let T=0;T<3;T++)s[S++]=o[x++]*f+o[x++]*g+o[x++]*w;x=0;for(let T=0;T<3;T++)s[S++]=a[x++]*d+a[x++]*y+a[x++]*b;x=0;for(let T=0;T<3;T++)s[S++]=a[x++]*f+a[x++]*_+a[x++]*w}if(i)for(let c=0;c<s.length;c++)isNaN(s[c])&&(s[c]=-1)}return s}function m4e(t){const e=t.clone().normalize();return e.length===1?e[0]:Ble(e)}function c4(t,e,i){var g;const{storageInfo:n,pixelSize:r}=e;let s=0,o=!1;const{pyramidResolutions:a}=n,l=((g=n.tileInfo.format)==null?void 0:g.toLowerCase())==="mixed"?Math.max(1,Math.min(3,n.tileInfo.dpi/96)):1,c=(t.x+t.y)/2/l;if(a!=null&&a.length){const y=a[a.length-1],_=(y.x+y.y)/2,b=(r.x+r.y)/2;if(c<=b)s=0;else if(c>=_)s=a.length,o=c/_>8;else{let x,S=b;for(let T=1;T<=a.length;T++){if(x=(a[T-1].x+a[T-1].y)/2,c<=x){c===x?s=T:i==="down"?(s=T-1,o=c/S>8):s=i==="up"||c-S>x-c||c/S>2?T:T-1;break}S=x}}const w=s===0?r:a[s-1];return o&&Math.min(w.x,w.y)*pi(e.spatialReference)>19567&&(o=!1),{pyramidLevel:s,pyramidResolution:new pe({x:w.x,y:w.y,spatialReference:e.spatialReference}),excessiveReading:o}}const u=Math.log(t.x/r.x)/Math.LN2,d=Math.log(t.y/r.y)/Math.LN2,f=e.storageInfo.maximumPyramidLevel||0;s=i==="down"?Math.floor(Math.min(u,d)):i==="up"?Math.ceil(Math.max(u,d)):Math.round((u+d)/2),s<0?s=0:s>f&&(o=s>f+3,s=f);const m=2**s;return{pyramidLevel:s,pyramidResolution:new pe({x:m*e.nativePixelSize.x,y:m*e.nativePixelSize.y,spatialReference:e.spatialReference}),excessiveReading:o}}function dft(t,e,i){var E;const n=(i==null?void 0:i.tileSize)??512,r=(i==null?void 0:i.alignGlobalDatasetWithAGOL)??!0,s=!!(i!=null&&i.limitToSrcResolution),{extent:o,spatialReference:a,pixelSize:l}=t,c=ZA(new pe({x:l.x,y:l.y,spatialReference:a}),e,o);if(c==null)return{projectedPixelSize:null,scales:null,srcResolutions:null,isCustomTilingScheme:!1};const u=(c.x+c.y)/2,d=pi(e),f=u*d*96*39.37,m=e.isGeographic?256/n*2958287637958547e-7:256/n*591657527591555e-6;let g=t.dataType==="vector-magdir"||t.dataType==="vector-uv";const y=Sy(o,e),_=Math.min(Math.ceil(Math.log(Math.min(t.width,t.height)/32)/Math.LN2),Math.ceil(Math.log(m/2/f)/Math.LN2));if(!g&&r&&(e.isGeographic||e.isWebMercator)&&(g=y.xmin*y.xmax<0,!g&&_<3)){const A=Lo(e);if(A!=null){const $=2**_*u*n,L=Math.ceil(A/$);g=L===1||L===2&&A/2-y.xmax<$}}let b,w=f;const x=1.001,S=Math.min(2,Math.max(1.414,((E=t.storageInfo)==null?void 0:E.pyramidScalingFactor)||2));if(g){w=m;const A=e.isGeographic?1341104507446289e-21:.29858214164761665,$=A*(96*d*39.37),L=e.isGeographic?4326:3857;b=ZA(new pe({x:A,y:A,spatialReference:{wkid:L}}),a,y),b.x*=w/$,b.y*=w/$}else{b={x:l.x,y:l.y};let A=0;for(;w<m*(x/2)&&A<_;)A++,w*=S,b.x*=S,b.y*=S;Math.max(w,m)/Math.min(w,m)<=x&&(w=m)}const T=[w],I=[{x:b.x,y:b.y}],C=70.5310735,M=Math.min(C,f)/x;for(;w>=M;)w/=S,b.x/=S,b.y/=S,T.push(w),I.push({x:b.x,y:b.y});if(s){const A=.001*l.x;let $=I.findIndex(L=>L.x>=l.x-A&&L.x<=l.x+A);$>-1?(I.length=$+1,T.length=$+1):($=I.findIndex(L=>L.x<=l.x+A),$>0&&(I.length=$,T.length=$))}return{projectedPixelSize:c,scales:T,srcResolutions:I,isCustomTilingScheme:!g}}const ud=new Map,Uf=new r4e;function NH(t,e){return e==null?t:`${t}?sliceId=${e}`}function pft(t,e){const i={extent:null,rasterInfo:e,cache:new Map},n=ud.get(t);return n?(n.push(i),n.length-1):(ud.set(t,[i]),0)}function fft(t,e){const i=ud.get(t);i&&(i[e]=null,i.some(n=>n!=null)||ud.delete(t))}function g4e(t,e,i){var o,a;const n=ud.get(t);if(!n)return e==null?Uf.decreaseRefCount(t,i):0;if(e==null||n[e]==null)return Uf.decreaseRefCount(t,i);const r=(o=n[e])==null?void 0:o.cache,s=r==null?void 0:r.get(i);if(r&&s){if(s.refCount--,s.refCount===0){r.delete(i);for(let l=0;l<n.length;l++)(a=n[l])==null||a.cache.delete(i);s.controller&&s.controller.abort()}return s.refCount}return 0}function FH(t,e,i){var s,o,a;const n=ud.get(t);if(!n)return e==null?Uf.getBlock(t,i):null;if(e==null||n[e]==null){for(let l=0;l<n.length;l++){const c=(s=n[l])==null?void 0:s.cache.get(i);if(c)return c.refCount++,c.block}return Uf.getBlock(t,i)}const r=(o=n[e])==null?void 0:o.cache.get(i);if(r)return r.refCount++,r.block;for(let l=0;l<n.length;l++){if(l===e||!n[l])continue;const c=(a=n[l])==null?void 0:a.cache,u=c==null?void 0:c.get(i);if(c&&u)return u.refCount++,c.set(i,u),u.block}return null}function zH(t,e,i,n,r=null){var a;const s=ud.get(t);if(!s)return void(e==null&&Uf.putBlock(t,i,n,r));if(e==null||s[e]==null)return void Uf.putBlock(t,i,n,r);const o={refCount:1,block:n,isResolved:!1,isRejected:!1,controller:r};n.then(()=>o.isResolved=!0).catch(()=>o.isRejected=!0),(a=s[e])==null||a.cache.set(i,o)}function y4e(t,e,i){var r;const n=ud.get(t);n?e!=null&&n[e]!=null?(r=n[e])==null||r.cache.delete(i):Uf.deleteBlock(t,i):e==null&&Uf.deleteBlock(t,i)}function v4e(t,e){const i=ud.get(t);return i?i[e]??null:null}function mft(t,e,i,n,r,s,o=null){const a=v4e(t,e);if(!a)return;const l=a.extent,{cache:c,rasterInfo:u}=a;if(l&&l.xmin===i.xmin&&l.xmax===i.xmax&&l.ymin===i.ymin&&l.ymax===i.ymax)return;n=n??0;const d=i.clone().normalize(),{spatialReference:f,transform:m}=u,g=new Set;for(let y=0;y<d.length;y++){const _=d[y];if(_.xmax-_.xmin<=n||_.ymax-_.ymin<=n)continue;let b=Sy(_,f,o);m!=null&&(b=m.inverseTransform(b));const w=new pe({x:n,y:n,spatialReference:_.spatialReference});if(r==null&&!(r=ZA(w,f,_,o)))return;const{pyramidLevel:x,pyramidResolution:S,excessiveReading:T}=c4(r,u,s||"closest");if(T)return;const{storageInfo:I}=u,{origin:C}=I,M={x:Math.max(0,Math.floor((b.xmin-C.x)/S.x)),y:Math.max(0,Math.floor((C.y-b.ymax)/S.y))},E=Math.ceil((b.xmax-b.xmin)/S.x-.1),A=Math.ceil((b.ymax-b.ymin)/S.y-.1),$=x>0?I.pyramidBlockWidth:I.blockWidth,L=x>0?I.pyramidBlockHeight:I.blockHeight,D=1,F=Math.max(0,Math.floor(M.x/$)-D),z=Math.max(0,Math.floor(M.y/L)-D),U=Math.floor((M.x+E-1)/$)+D,G=Math.floor((M.y+A-1)/L)+D;for(let W=z;W<=G;W++)for(let Z=F;Z<=U;Z++)g.add(`${x}/${W}/${Z}`)}c.forEach((y,_)=>{if(!g.has(_)){const b=c.get(_);(b==null||b.isResolved||b.isRejected)&&c.delete(_)}}),a.extent={xmin:i.xmin,ymin:i.ymin,xmax:i.xmax,ymax:i.ymax}}var MO,VH,jH,u4={exports:{}};u4.exports,VH=u4,MO=function(){function t(){this.pos=0,this.bufferLength=0,this.eof=!1,this.buffer=null}return t.prototype={ensureBuffer:function(e){var i=this.buffer,n=i?i.byteLength:0;if(e<n)return i;for(var r=512;r<e;)r<<=1;for(var s=new Uint8Array(r),o=0;o<n;++o)s[o]=i[o];return this.buffer=s},getByte:function(){for(var e=this.pos;this.bufferLength<=e;){if(this.eof)return null;this.readBlock()}return this.buffer[this.pos++]},getBytes:function(e){var i=this.pos;if(e){this.ensureBuffer(i+e);for(var n=i+e;!this.eof&&this.bufferLength<n;)this.readBlock();var r=this.bufferLength;n>r&&(n=r)}else{for(;!this.eof;)this.readBlock();n=this.bufferLength}return this.pos=n,this.buffer.subarray(i,n)},lookChar:function(){for(var e=this.pos;this.bufferLength<=e;){if(this.eof)return null;this.readBlock()}return String.fromCharCode(this.buffer[this.pos])},getChar:function(){for(var e=this.pos;this.bufferLength<=e;){if(this.eof)return null;this.readBlock()}return String.fromCharCode(this.buffer[this.pos++])},makeSubStream:function(e,i,n){for(var r=e+i;this.bufferLength<=r&&!this.eof;)this.readBlock();return new Stream(this.buffer,e,i,n)},skip:function(e){e||(e=1),this.pos+=e},reset:function(){this.pos=0}},t}(),(jH=function(){if(!self||!self.Uint32Array)return null;var t=new Uint32Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),e=new Uint32Array([3,4,5,6,7,8,9,10,65547,65549,65551,65553,131091,131095,131099,131103,196643,196651,196659,196667,262211,262227,262243,262259,327811,327843,327875,327907,258,258,258]),i=new Uint32Array([1,2,3,4,65541,65543,131081,131085,196625,196633,262177,262193,327745,327777,393345,393409,459009,459137,524801,525057,590849,591361,657409,658433,724993,727041,794625,798721,868353,876545]),n=[new Uint32Array([459008,524368,524304,524568,459024,524400,524336,590016,459016,524384,524320,589984,524288,524416,524352,590048,459012,524376,524312,589968,459028,524408,524344,590032,459020,524392,524328,59e4,524296,524424,524360,590064,459010,524372,524308,524572,459026,524404,524340,590024,459018,524388,524324,589992,524292,524420,524356,590056,459014,524380,524316,589976,459030,524412,524348,590040,459022,524396,524332,590008,524300,524428,524364,590072,459009,524370,524306,524570,459025,524402,524338,590020,459017,524386,524322,589988,524290,524418,524354,590052,459013,524378,524314,589972,459029,524410,524346,590036,459021,524394,524330,590004,524298,524426,524362,590068,459011,524374,524310,524574,459027,524406,524342,590028,459019,524390,524326,589996,524294,524422,524358,590060,459015,524382,524318,589980,459031,524414,524350,590044,459023,524398,524334,590012,524302,524430,524366,590076,459008,524369,524305,524569,459024,524401,524337,590018,459016,524385,524321,589986,524289,524417,524353,590050,459012,524377,524313,589970,459028,524409,524345,590034,459020,524393,524329,590002,524297,524425,524361,590066,459010,524373,524309,524573,459026,524405,524341,590026,459018,524389,524325,589994,524293,524421,524357,590058,459014,524381,524317,589978,459030,524413,524349,590042,459022,524397,524333,590010,524301,524429,524365,590074,459009,524371,524307,524571,459025,524403,524339,590022,459017,524387,524323,589990,524291,524419,524355,590054,459013,524379,524315,589974,459029,524411,524347,590038,459021,524395,524331,590006,524299,524427,524363,590070,459011,524375,524311,524575,459027,524407,524343,590030,459019,524391,524327,589998,524295,524423,524359,590062,459015,524383,524319,589982,459031,524415,524351,590046,459023,524399,524335,590014,524303,524431,524367,590078,459008,524368,524304,524568,459024,524400,524336,590017,459016,524384,524320,589985,524288,524416,524352,590049,459012,524376,524312,589969,459028,524408,524344,590033,459020,524392,524328,590001,524296,524424,524360,590065,459010,524372,524308,524572,459026,524404,524340,590025,459018,524388,524324,589993,524292,524420,524356,590057,459014,524380,524316,589977,459030,524412,524348,590041,459022,524396,524332,590009,524300,524428,524364,590073,459009,524370,524306,524570,459025,524402,524338,590021,459017,524386,524322,589989,524290,524418,524354,590053,459013,524378,524314,589973,459029,524410,524346,590037,459021,524394,524330,590005,524298,524426,524362,590069,459011,524374,524310,524574,459027,524406,524342,590029,459019,524390,524326,589997,524294,524422,524358,590061,459015,524382,524318,589981,459031,524414,524350,590045,459023,524398,524334,590013,524302,524430,524366,590077,459008,524369,524305,524569,459024,524401,524337,590019,459016,524385,524321,589987,524289,524417,524353,590051,459012,524377,524313,589971,459028,524409,524345,590035,459020,524393,524329,590003,524297,524425,524361,590067,459010,524373,524309,524573,459026,524405,524341,590027,459018,524389,524325,589995,524293,524421,524357,590059,459014,524381,524317,589979,459030,524413,524349,590043,459022,524397,524333,590011,524301,524429,524365,590075,459009,524371,524307,524571,459025,524403,524339,590023,459017,524387,524323,589991,524291,524419,524355,590055,459013,524379,524315,589975,459029,524411,524347,590039,459021,524395,524331,590007,524299,524427,524363,590071,459011,524375,524311,524575,459027,524407,524343,590031,459019,524391,524327,589999,524295,524423,524359,590063,459015,524383,524319,589983,459031,524415,524351,590047,459023,524399,524335,590015,524303,524431,524367,590079]),9],r=[new Uint32Array([327680,327696,327688,327704,327684,327700,327692,327708,327682,327698,327690,327706,327686,327702,327694,0,327681,327697,327689,327705,327685,327701,327693,327709,327683,327699,327691,327707,327687,327703,327695,0]),5];function s(a){throw new Error(a)}function o(a){var l=0,c=a[l++],u=a[l++];c!=-1&&u!=-1||s("Invalid header in flate stream"),(15&c)!=8&&s("Unknown compression method in flate stream"),((c<<8)+u)%31!=0&&s("Bad FCHECK in flate stream"),32&u&&s("FDICT bit set in flate stream"),this.bytes=a,this.bytesPos=l,this.codeSize=0,this.codeBuf=0,MO.call(this)}return o.prototype=Object.create(MO.prototype),o.prototype.getBits=function(a){for(var l,c=this.codeSize,u=this.codeBuf,d=this.bytes,f=this.bytesPos;c<a;)(l=d[f++])===void 0&&s("Bad encoding in flate stream"),u|=l<<c,c+=8;return l=u&(1<<a)-1,this.codeBuf=u>>a,this.codeSize=c-=a,this.bytesPos=f,l},o.prototype.getCode=function(a){for(var l=a[0],c=a[1],u=this.codeSize,d=this.codeBuf,f=this.bytes,m=this.bytesPos;u<c;){var g;(g=f[m++])===void 0&&s("Bad encoding in flate stream"),d|=g<<u,u+=8}var y=l[d&(1<<c)-1],_=y>>16,b=65535&y;return(u==0||u<_||_==0)&&s("Bad encoding in flate stream"),this.codeBuf=d>>_,this.codeSize=u-_,this.bytesPos=m,b},o.prototype.generateHuffmanTable=function(a){for(var l=a.length,c=0,u=0;u<l;++u)a[u]>c&&(c=a[u]);for(var d=1<<c,f=new Uint32Array(d),m=1,g=0,y=2;m<=c;++m,g<<=1,y<<=1)for(var _=0;_<l;++_)if(a[_]==m){var b=0,w=g;for(u=0;u<m;++u)b=b<<1|1&w,w>>=1;for(u=b;u<d;u+=y)f[u]=m<<16|_;++g}return[f,c]},o.prototype.readBlock=function(){function a(X,oe,se,le,de){for(var we=X.getBits(se)+le;we-- >0;)oe[y++]=de}var l=this.getBits(3);if(1&l&&(this.eof=!0),(l>>=1)!=0){var c,u;if(l==1)c=n,u=r;else if(l==2){for(var d=this.getBits(5)+257,f=this.getBits(5)+1,m=this.getBits(4)+4,g=Array(t.length),y=0;y<m;)g[t[y++]]=this.getBits(3);for(var _=this.generateHuffmanTable(g),b=0,w=(y=0,d+f),x=new Array(w);y<w;){var S=this.getCode(_);S==16?a(this,x,2,3,b):S==17?a(this,x,3,3,b=0):S==18?a(this,x,7,11,b=0):x[y++]=b=S}c=this.generateHuffmanTable(x.slice(0,d)),u=this.generateHuffmanTable(x.slice(d,w))}else s("Unknown block type in flate stream");for(var T=(G=this.buffer)?G.length:0,I=this.bufferLength;;){var C=this.getCode(c);if(C<256)I+1>=T&&(T=(G=this.ensureBuffer(I+1)).length),G[I++]=C;else{if(C==256)return void(this.bufferLength=I);var M=(C=e[C-=257])>>16;M>0&&(M=this.getBits(M)),b=(65535&C)+M,C=this.getCode(u),(M=(C=i[C])>>16)>0&&(M=this.getBits(M));var E=(65535&C)+M;I+b>=T&&(T=(G=this.ensureBuffer(I+b)).length);for(var A=0;A<b;++A,++I)G[I]=G[I-E]}}}else{var $,L=this.bytes,D=this.bytesPos;($=L[D++])===void 0&&s("Bad block header in flate stream");var F=$;($=L[D++])===void 0&&s("Bad block header in flate stream"),F|=$<<8,($=L[D++])===void 0&&s("Bad block header in flate stream");var z=$;($=L[D++])===void 0&&s("Bad block header in flate stream"),(z|=$<<8)!=(65535&~F)&&s("Bad uncompressed block length in flate stream"),this.codeBuf=0,this.codeSize=0;var U=this.bufferLength,G=this.ensureBuffer(U+F),W=U+F;this.bufferLength=W;for(var Z=U;Z<W;++Z){if(($=L[D++])===void 0){this.eof=!0;break}G[Z]=$}this.bytesPos=D}},o}())!==void 0&&(VH.exports=jH);const hT=VV(u4.exports);let _4e=class Ule{constructor(e){this._canvas=null,this._ctx=null,e&&(this._canvas=e.canvas,this._ctx=e.ctx||e.canvas&&e.canvas.getContext("2d"))}decode(e,i,n){if(!e||e.byteLength<10)throw new V("imagecanvasdecoder: decode","required a valid encoded data as input.");let{width:r=0,height:s=0,format:o}=i;const{applyJpegMask:a}=i;if(a&&(!r||!s))throw new V("imagecanvasdecoder: decode","image width and height are needed to apply jpeg mask directly to canvas");return new Promise((l,c)=>{let u=null;o==="jpg"&&a&&(u=Ule._getMask(e,{width:r,height:s}));const d=new Blob([new Uint8Array(e)],{type:"image/"+o=="jpg"?"jpeg":o}),f=URL.createObjectURL(d),m=new Image;let g;m.src=f,m.onload=()=>{if(URL.revokeObjectURL(f),zo(n))return void c(li());r=m.width,s=m.height,this._canvas&&this._ctx?(this._canvas.width===r&&this._canvas.height===s||(this._canvas.width=r,this._canvas.height=s),this._ctx.clearRect(0,0,r,s)):(this._canvas=document.createElement("canvas"),this._canvas.width=r,this._canvas.height=s,this._ctx=this._canvas.getContext("2d")),this._ctx.drawImage(m,0,0);const y=this._ctx.getImageData(0,0,r,s);let _;if(g=y.data,i.renderOnCanvas){if(u)for(_=0;_<u.length;_++)u[_]?g[4*_+3]=255:g[4*_+3]=0;return this._ctx.putImageData(y,0,0),void l(null)}const b=r*s,w=new Uint8Array(b),x=new Uint8Array(b),S=new Uint8Array(b);if(u)for(_=0;_<b;_++)w[_]=g[4*_],x[_]=g[4*_+1],S[_]=g[4*_+2];else for(u=new Uint8Array(b),_=0;_<b;_++)w[_]=g[4*_],x[_]=g[4*_+1],S[_]=g[4*_+2],u[_]=g[4*_+3];l({width:r,height:s,pixels:[w,x,S],mask:u,pixelType:"u8"})},m.onerror=()=>{URL.revokeObjectURL(f),c("cannot load image")}})}static _getMask(e,i){let n=null;try{const r=new Uint8Array(e),s=Math.ceil(r.length/2);let o=0;const a=r.length-2;for(o=s;o<a&&(r[o]!==255||r[o+1]!==217);o++);if(o+=2,o<r.length-1){const l=new hT(r.subarray(o)).getBytes();n=new Uint8Array(i.width*i.height);let c=0;for(let u=0;u<l.length;u++)for(let d=7;d>=0;d--)n[c++]=l[u]>>d&1}}catch{}return n}};var BH,UH,GH,h4={exports:{}};h4.exports,BH=h4,UH=function(){var t=function(){function e(i){this.message="JPEG error: "+i}return e.prototype=new Error,e.prototype.name="JpegError",e.constructor=e,e}();return function(){if(!self||!self.Uint8ClampedArray)return null;var e=new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),i=4017,n=799,r=3406,s=2276,o=1567,a=3784,l=5793,c=2896;function u(){this.decodeTransform=null,this.colorTransform=-1}function d(b,w){for(var x,S,T=0,I=[],C=16;C>0&&!b[C-1];)C--;I.push({children:[],index:0});var M,E=I[0];for(x=0;x<C;x++){for(S=0;S<b[x];S++){for((E=I.pop()).children[E.index]=w[T];E.index>0;)E=I.pop();for(E.index++,I.push(E);I.length<=x;)I.push(M={children:[],index:0}),E.children[E.index]=M.children,E=M;T++}x+1<C&&(I.push(M={children:[],index:0}),E.children[E.index]=M.children,E=M)}return I[0].children}function f(b,w,x){return 64*((b.blocksPerLine+1)*w+x)}function m(b,w,x,S,T,I,C,M,E){var A=x.mcusPerLine,$=x.progressive,L=w,D=0,F=0;function z(){if(F>0)return F--,D>>F&1;if((D=b[w++])===255){var Ie=b[w++];if(Ie)throw new t("unexpected marker "+(D<<8|Ie).toString(16))}return F=7,D>>>7}function U(Ie){for(var Ze=Ie;;){if(typeof(Ze=Ze[z()])=="number")return Ze;if(typeof Ze!="object")throw new t("invalid huffman sequence")}}function G(Ie){for(var Ze=0;Ie>0;)Ze=Ze<<1|z(),Ie--;return Ze}function W(Ie){if(Ie===1)return z()===1?1:-1;var Ze=G(Ie);return Ze>=1<<Ie-1?Ze:Ze+(-1<<Ie)+1}function Z(Ie,Ze){var Mt=U(Ie.huffmanTableDC),Ni=Mt===0?0:W(Mt);Ie.blockData[Ze]=Ie.pred+=Ni;for(var si=1;si<64;){var or=U(Ie.huffmanTableAC),yn=15&or,ar=or>>4;if(yn!==0){var xd=e[si+=ar];Ie.blockData[Ze+xd]=W(yn),si++}else{if(ar<15)break;si+=16}}}function X(Ie,Ze){var Mt=U(Ie.huffmanTableDC),Ni=Mt===0?0:W(Mt)<<E;Ie.blockData[Ze]=Ie.pred+=Ni}function oe(Ie,Ze){Ie.blockData[Ze]|=z()<<E}var se=0;function le(Ie,Ze){if(se>0)se--;else for(var Mt=I,Ni=C;Mt<=Ni;){var si=U(Ie.huffmanTableAC),or=15&si,yn=si>>4;if(or!==0){var ar=e[Mt+=yn];Ie.blockData[Ze+ar]=W(or)*(1<<E),Mt++}else{if(yn<15){se=G(yn)+(1<<yn)-1;break}Mt+=16}}}var de,we=0;function Re(Ie,Ze){for(var Mt,Ni,si=I,or=C,yn=0;si<=or;){var ar=e[si];switch(we){case 0:if(yn=(Ni=U(Ie.huffmanTableAC))>>4,(Mt=15&Ni)==0)yn<15?(se=G(yn)+(1<<yn),we=4):(yn=16,we=1);else{if(Mt!==1)throw new t("invalid ACn encoding");de=W(Mt),we=yn?2:3}continue;case 1:case 2:Ie.blockData[Ze+ar]?Ie.blockData[Ze+ar]+=z()<<E:--yn==0&&(we=we===2?3:0);break;case 3:Ie.blockData[Ze+ar]?Ie.blockData[Ze+ar]+=z()<<E:(Ie.blockData[Ze+ar]=de<<E,we=0);break;case 4:Ie.blockData[Ze+ar]&&(Ie.blockData[Ze+ar]+=z()<<E)}si++}we===4&&--se==0&&(we=0)}function ze(Ie,Ze,Mt,Ni,si){var or=Mt%A;Ze(Ie,f(Ie,(Mt/A|0)*Ie.v+Ni,or*Ie.h+si))}function Ct(Ie,Ze,Mt){Ze(Ie,f(Ie,Mt/Ie.blocksPerLine|0,Mt%Ie.blocksPerLine))}var Ae,ke,jt,gn,_t,zs,Gr=S.length;zs=$?I===0?M===0?X:oe:M===0?le:Re:Z;var fi,Fn,xl,Sl,Wi=0;for(Fn=Gr===1?S[0].blocksPerLine*S[0].blocksPerColumn:A*x.mcusPerColumn;Wi<Fn;){var Ji=T?Math.min(Fn-Wi,T):Fn;for(ke=0;ke<Gr;ke++)S[ke].pred=0;if(se=0,Gr===1)for(Ae=S[0],_t=0;_t<Ji;_t++)Ct(Ae,zs,Wi),Wi++;else for(_t=0;_t<Ji;_t++){for(ke=0;ke<Gr;ke++)for(xl=(Ae=S[ke]).h,Sl=Ae.v,jt=0;jt<Sl;jt++)for(gn=0;gn<xl;gn++)ze(Ae,zs,Wi,jt,gn);Wi++}F=0,(fi=_(b,w))&&fi.invalid&&(console.log("decodeScan - unexpected MCU data, next marker is: "+fi.invalid),w=fi.offset);var lo=fi&&fi.marker;if(!lo||lo<=65280)throw new t("marker was not found");if(!(lo>=65488&&lo<=65495))break;w+=2}return(fi=_(b,w))&&fi.invalid&&(console.log("decodeScan - unexpected Scan data, next marker is: "+fi.invalid),w=fi.offset),w-L}function g(b,w,x){var S,T,I,C,M,E,A,$,L,D,F,z,U,G,W,Z,X,oe=b.quantizationTable,se=b.blockData;if(!oe)throw new t("missing required Quantization Table.");for(var le=0;le<64;le+=8)L=se[w+le],D=se[w+le+1],F=se[w+le+2],z=se[w+le+3],U=se[w+le+4],G=se[w+le+5],W=se[w+le+6],Z=se[w+le+7],L*=oe[le],D|F|z|U|G|W|Z?(D*=oe[le+1],F*=oe[le+2],z*=oe[le+3],U*=oe[le+4],G*=oe[le+5],W*=oe[le+6],Z*=oe[le+7],T=(S=(S=l*L+128>>8)+(T=l*U+128>>8)+1>>1)-T,X=(I=F)*a+(C=W)*o+128>>8,I=I*o-C*a+128>>8,A=(M=(M=c*(D-Z)+128>>8)+(A=G<<4)+1>>1)-A,E=($=($=c*(D+Z)+128>>8)+(E=z<<4)+1>>1)-E,C=(S=S+(C=X)+1>>1)-C,I=(T=T+I+1>>1)-I,X=M*s+$*r+2048>>12,M=M*r-$*s+2048>>12,$=X,X=E*n+A*i+2048>>12,E=E*i-A*n+2048>>12,A=X,x[le]=S+$,x[le+7]=S-$,x[le+1]=T+A,x[le+6]=T-A,x[le+2]=I+E,x[le+5]=I-E,x[le+3]=C+M,x[le+4]=C-M):(X=l*L+512>>10,x[le]=X,x[le+1]=X,x[le+2]=X,x[le+3]=X,x[le+4]=X,x[le+5]=X,x[le+6]=X,x[le+7]=X);for(var de=0;de<8;++de)L=x[de],(D=x[de+8])|(F=x[de+16])|(z=x[de+24])|(U=x[de+32])|(G=x[de+40])|(W=x[de+48])|(Z=x[de+56])?(T=(S=4112+((S=l*L+2048>>12)+(T=l*U+2048>>12)+1>>1))-T,X=(I=F)*a+(C=W)*o+2048>>12,I=I*o-C*a+2048>>12,C=X,A=(M=(M=c*(D-Z)+2048>>12)+(A=G)+1>>1)-A,E=($=($=c*(D+Z)+2048>>12)+(E=z)+1>>1)-E,X=M*s+$*r+2048>>12,M=M*r-$*s+2048>>12,$=X,X=E*n+A*i+2048>>12,E=E*i-A*n+2048>>12,L=(L=(S=S+C+1>>1)+$)<16?0:L>=4080?255:L>>4,D=(D=(T=T+I+1>>1)+(A=X))<16?0:D>=4080?255:D>>4,F=(F=(I=T-I)+E)<16?0:F>=4080?255:F>>4,z=(z=(C=S-C)+M)<16?0:z>=4080?255:z>>4,U=(U=C-M)<16?0:U>=4080?255:U>>4,G=(G=I-E)<16?0:G>=4080?255:G>>4,W=(W=T-A)<16?0:W>=4080?255:W>>4,Z=(Z=S-$)<16?0:Z>=4080?255:Z>>4,se[w+de]=L,se[w+de+8]=D,se[w+de+16]=F,se[w+de+24]=z,se[w+de+32]=U,se[w+de+40]=G,se[w+de+48]=W,se[w+de+56]=Z):(X=(X=l*L+8192>>14)<-2040?0:X>=2024?255:X+2056>>4,se[w+de]=X,se[w+de+8]=X,se[w+de+16]=X,se[w+de+24]=X,se[w+de+32]=X,se[w+de+40]=X,se[w+de+48]=X,se[w+de+56]=X)}function y(b,w){for(var x=w.blocksPerLine,S=w.blocksPerColumn,T=new Int16Array(64),I=0;I<S;I++)for(var C=0;C<x;C++)g(w,f(w,I,C),T);return w.blockData}function _(b,w,x){function S(E){return b[E]<<8|b[E+1]}var T=b.length-1,I=x<w?x:w;if(w>=T)return null;var C=S(w);if(C>=65472&&C<=65534)return{invalid:null,marker:C,offset:w};for(var M=S(I);!(M>=65472&&M<=65534);){if(++I>=T)return null;M=S(I)}return{invalid:C.toString(16),marker:M,offset:I}}return u.prototype={parse:function(b){function w(){var Ie=b[C]<<8|b[C+1];return C+=2,Ie}function x(){var Ie=w(),Ze=C+Ie-2,Mt=_(b,Ze,C);Mt&&Mt.invalid&&(console.log("readDataBlock - incorrect length, next marker is: "+Mt.invalid),Ze=Mt.offset);var Ni=b.subarray(C,Ze);return C+=Ni.length,Ni}function S(Ie){for(var Ze=Math.ceil(Ie.samplesPerLine/8/Ie.maxH),Mt=Math.ceil(Ie.scanLines/8/Ie.maxV),Ni=0;Ni<Ie.components.length;Ni++){_t=Ie.components[Ni];var si=Math.ceil(Math.ceil(Ie.samplesPerLine/8)*_t.h/Ie.maxH),or=Math.ceil(Math.ceil(Ie.scanLines/8)*_t.v/Ie.maxV),yn=Ze*_t.h,ar=Mt*_t.v*64*(yn+1);_t.blockData=new Int16Array(ar),_t.blocksPerLine=si,_t.blocksPerColumn=or}Ie.mcusPerLine=Ze,Ie.mcusPerColumn=Mt}var T,I,C=0,M=null,E=null,A=[],$=[],L=[],D=w();if(D!==65496)throw new t("SOI not found");for(D=w();D!==65497;){var F,z,U;switch(D){case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var G=x();D===65504&&G[0]===74&&G[1]===70&&G[2]===73&&G[3]===70&&G[4]===0&&(M={version:{major:G[5],minor:G[6]},densityUnits:G[7],xDensity:G[8]<<8|G[9],yDensity:G[10]<<8|G[11],thumbWidth:G[12],thumbHeight:G[13],thumbData:G.subarray(14,14+3*G[12]*G[13])}),D===65518&&G[0]===65&&G[1]===100&&G[2]===111&&G[3]===98&&G[4]===101&&(E={version:G[5]<<8|G[6],flags0:G[7]<<8|G[8],flags1:G[9]<<8|G[10],transformCode:G[11]});break;case 65499:for(var W=w()+C-2;C<W;){var Z=b[C++],X=new Uint16Array(64);if(Z>>4){if(Z>>4!=1)throw new t("DQT - invalid table spec");for(z=0;z<64;z++)X[e[z]]=w()}else for(z=0;z<64;z++)X[e[z]]=b[C++];A[15&Z]=X}break;case 65472:case 65473:case 65474:if(T)throw new t("Only single frame JPEGs supported");w(),(T={}).extended=D===65473,T.progressive=D===65474,T.precision=b[C++],T.scanLines=w(),T.samplesPerLine=w(),T.components=[],T.componentIds={};var oe,se=b[C++],le=0,de=0;for(F=0;F<se;F++){oe=b[C];var we=b[C+1]>>4,Re=15&b[C+1];le<we&&(le=we),de<Re&&(de=Re);var ze=b[C+2];U=T.components.push({h:we,v:Re,quantizationId:ze,quantizationTable:null}),T.componentIds[oe]=U-1,C+=3}T.maxH=le,T.maxV=de,S(T);break;case 65476:var Ct=w();for(F=2;F<Ct;){var Ae=b[C++],ke=new Uint8Array(16),jt=0;for(z=0;z<16;z++,C++)jt+=ke[z]=b[C];var gn=new Uint8Array(jt);for(z=0;z<jt;z++,C++)gn[z]=b[C];F+=17+jt,(Ae>>4?$:L)[15&Ae]=d(ke,gn)}break;case 65501:w(),I=w();break;case 65498:w();var _t,zs=b[C++],Gr=[];for(F=0;F<zs;F++){var fi=T.componentIds[b[C++]];_t=T.components[fi];var Fn=b[C++];_t.huffmanTableDC=L[Fn>>4],_t.huffmanTableAC=$[15&Fn],Gr.push(_t)}var xl=b[C++],Sl=b[C++],Wi=b[C++],Ji=m(b,C,T,Gr,I,xl,Sl,Wi>>4,15&Wi);C+=Ji;break;case 65535:b[C]!==255&&C--;break;default:if(b[C-3]===255&&b[C-2]>=192&&b[C-2]<=254){C-=3;break}throw new t("unknown marker "+D.toString(16))}D=w()}for(this.width=T.samplesPerLine,this.height=T.scanLines,this.jfif=M,this.eof=C,this.adobe=E,this.components=[],F=0;F<T.components.length;F++){var lo=A[(_t=T.components[F]).quantizationId];lo&&(_t.quantizationTable=lo),this.components.push({output:y(T,_t),scaleX:_t.h/T.maxH,scaleY:_t.v/T.maxV,blocksPerLine:_t.blocksPerLine,blocksPerColumn:_t.blocksPerColumn})}this.numComponents=this.components.length},_getLinearizedBlockData:function(b,w){var x,S,T,I,C,M,E,A,$,L,D,F=this.width/b,z=this.height/w,U=0,G=this.components.length,W=b*w*G,Z=new Uint8ClampedArray(W),X=new Uint32Array(b),oe=4294967288;for(E=0;E<G;E++){for(S=(x=this.components[E]).scaleX*F,T=x.scaleY*z,U=E,D=x.output,I=x.blocksPerLine+1<<3,C=0;C<b;C++)A=0|C*S,X[C]=(A&oe)<<3|7&A;for(M=0;M<w;M++)for(L=I*((A=0|M*T)&oe)|(7&A)<<3,C=0;C<b;C++)Z[U]=D[L+X[C]],U+=G}var se=this.decodeTransform;if(se)for(E=0;E<W;)for(A=0,$=0;A<G;A++,E++,$+=2)Z[E]=(Z[E]*se[$]>>8)+se[$+1];return Z},_isColorConversionNeeded:function(){return this.adobe?!!this.adobe.transformCode:this.numComponents===3?this.colorTransform!==0:this.colorTransform===1},_convertYccToRgb:function(b){for(var w,x,S,T=0,I=b.length;T<I;T+=3)w=b[T],x=b[T+1],S=b[T+2],b[T]=w-179.456+1.402*S,b[T+1]=w+135.459-.344*x-.714*S,b[T+2]=w-226.816+1.772*x;return b},_convertYcckToRgb:function(b){for(var w,x,S,T,I=0,C=0,M=b.length;C<M;C+=4)w=b[C],x=b[C+1],S=b[C+2],T=b[C+3],b[I++]=x*(-660635669420364e-19*x+.000437130475926232*S-54080610064599e-18*w+.00048449797120281*T-.154362151871126)-122.67195406894+S*(-.000957964378445773*S+.000817076911346625*w-.00477271405408747*T+1.53380253221734)+w*(.000961250184130688*w-.00266257332283933*T+.48357088451265)+T*(-.000336197177618394*T+.484791561490776),b[I++]=107.268039397724+x*(219927104525741e-19*x-.000640992018297945*S+.000659397001245577*w+.000426105652938837*T-.176491792462875)+S*(-.000778269941513683*S+.00130872261408275*w+.000770482631801132*T-.151051492775562)+w*(.00126935368114843*w-.00265090189010898*T+.25802910206845)+T*(-.000318913117588328*T-.213742400323665),b[I++]=x*(-.000570115196973677*x-263409051004589e-19*S+.0020741088115012*w-.00288260236853442*T+.814272968359295)-20.810012546947+S*(-153496057440975e-19*S-.000132689043961446*w+.000560833691242812*T-.195152027534049)+w*(.00174418132927582*w-.00255243321439347*T+.116935020465145)+T*(-.000343531996510555*T+.24165260232407);return b},_convertYcckToCmyk:function(b){for(var w,x,S,T=0,I=b.length;T<I;T+=4)w=b[T],x=b[T+1],S=b[T+2],b[T]=434.456-w-1.402*S,b[T+1]=119.541-w+.344*x+.714*S,b[T+2]=481.816-w-1.772*x;return b},_convertCmykToRgb:function(b){for(var w,x,S,T,I=0,C=1/255,M=0,E=b.length;M<E;M+=4)w=b[M]*C,x=b[M+1]*C,S=b[M+2]*C,T=b[M+3]*C,b[I++]=255+w*(-4.387332384609988*w+54.48615194189176*x+18.82290502165302*S+212.25662451639585*T-285.2331026137004)+x*(1.7149763477362134*x-5.6096736904047315*S-17.873870861415444*T-5.497006427196366)+S*(-2.5217340131683033*S-21.248923337353073*T+17.5119270841813)-T*(21.86122147463605*T+189.48180835922747),b[I++]=255+w*(8.841041422036149*w+60.118027045597366*x+6.871425592049007*S+31.159100130055922*T-79.2970844816548)+x*(-15.310361306967817*x+17.575251261109482*S+131.35250912493976*T-190.9453302588951)+S*(4.444339102852739*S+9.8632861493405*T-24.86741582555878)-T*(20.737325471181034*T+187.80453709719578),b[I++]=255+w*(.8842522430003296*w+8.078677503112928*x+30.89978309703729*S-.23883238689178934*T-14.183576799673286)+x*(10.49593273432072*x+63.02378494754052*S+50.606957656360734*T-112.23884253719248)+S*(.03296041114873217*S+115.60384449646641*T-193.58209356861505)-T*(22.33816807309886*T+180.12613974708367);return b},getData:function(b,w,x){if(this.numComponents>4)throw new t("Unsupported color mode");var S=this._getLinearizedBlockData(b,w);if(this.numComponents===1&&x){for(var T=S.length,I=new Uint8ClampedArray(3*T),C=0,M=0;M<T;M++){var E=S[M];I[C++]=E,I[C++]=E,I[C++]=E}return I}if(this.numComponents===3&&this._isColorConversionNeeded())return this._convertYccToRgb(S);if(this.numComponents===4){if(this._isColorConversionNeeded())return x?this._convertYcckToRgb(S):this._convertYcckToCmyk(S);if(x)return this._convertCmykToRgb(S)}return S}},u}()},(GH=UH())!==void 0&&(BH.exports=GH);const Gle=VV(h4.exports);let b4e=class{static decode(e,i=!1){const n=new Uint8Array(e),r=new Gle;r.parse(n);const{width:s,height:o,numComponents:a,eof:l}=r,c=r.getData(s,o,!0),u=s*o;let d,f=null,m=0,g=0,y=0;if(!i&&l<n.length-1)try{const _=new hT(n.subarray(l)).getBytes();f=new Uint8Array(u);let b=0;for(m=0;m<_.length;m++)for(y=7;y>=0;y--)f[b++]=_[m]>>y&1}catch{}if(a===1&&c.length===s*o){const _=new Uint8Array(c.buffer);d=[_,_,_]}else{for(d=[],m=0;m<3;m++)d.push(new Uint8Array(u));for(y=0,g=0;g<u;g++)for(m=0;m<3;m++)d[m][g]=c[y++]}return{width:s,height:o,pixels:d,mask:f}}};const Hle=[{pixelType:"S8",size:1,ctor:Int8Array,range:[-128,127]},{pixelType:"U8",size:1,ctor:Uint8Array,range:[0,255]},{pixelType:"S16",size:2,ctor:Int16Array,range:[-32768,32767]},{pixelType:"U16",size:2,ctor:Uint16Array,range:[0,65536]},{pixelType:"S32",size:4,ctor:Int32Array,range:[-2147483648,2147483647]},{pixelType:"U32",size:4,ctor:Uint32Array,range:[0,4294967296]},{pixelType:"F32",size:4,ctor:Float32Array,range:[-34027999387901484e22,34027999387901484e22]},{pixelType:"F64",size:8,ctor:Float64Array,range:[-17976931348623157e292,17976931348623157e292]}];let EO=null;function qle(){return EO||(EO=Y(()=>import("./lerc-wasm-501798bf.js"),[],import.meta.url).then(t=>t.l).then(({default:t})=>t({locateFile:e=>xt(`esri/layers/support/rasterFormats/${e}`)})).then(t=>{x4e(t)}),EO)}const KA={getBlobInfo:null,decode:null};function w4e(t){return 16+(t>>3<<3)}function Gd(t,e,i){i.set(t.slice(e,e+i.length))}function x4e(t){const{_malloc:e,_free:i,_lerc_getBlobInfo:n,_lerc_getDataRanges:r,_lerc_decode_4D:s,asm:o}=t;let a;const l=Object.values(o).find(u=>u&&"buffer"in u&&u.buffer===t.HEAPU8.buffer),c=u=>{const d=u.map(y=>w4e(y)),f=d.reduce((y,_)=>y+_),m=e(f);a=new Uint8Array(l.buffer);let g=d[0];d[0]=m;for(let y=1;y<d.length;y++){const _=d[y];d[y]=d[y-1]+g,g=_}return d};KA.getBlobInfo=u=>{const m=new Uint8Array(48),g=new Uint8Array(8*3),[y,_,b]=c([u.length,m.length,g.length]);a.set(u,y),a.set(m,_),a.set(g,b);let w=n(y,u.length,_,b,12,3);if(w)throw i(y),new Error(`lerc-getBlobInfo: error code is ${w}`);a=new Uint8Array(l.buffer),Gd(a,_,m),Gd(a,b,g);const x=new Uint32Array(m.buffer),S=new Float64Array(g.buffer),[T,I,,C,M,E,A,$,L,D,F]=x,z={version:T,depthCount:D,width:C,height:M,validPixelCount:A,bandCount:E,blobSize:$,maskCount:L,dataType:I,minValue:S[0],maxValue:S[1],maxZerror:S[2],statistics:[],bandCountWithNoData:F};if(F)return z;if(D===1&&E===1)return i(y),z.statistics.push({minValue:S[0],maxValue:S[1]}),z;const U=D*E*8,G=new Uint8Array(U),W=new Uint8Array(U);let Z=y,X=0,oe=0,se=!1;if(a.byteLength<y+2*U?(i(y),se=!0,[Z,X,oe]=c([u.length,U,U]),a.set(u,Z)):[X,oe]=c([U,U]),a.set(G,X),a.set(W,oe),w=r(Z,u.length,D,E,X,oe),w)throw i(Z),se||i(X),new Error(`lerc-getDataRanges: error code is ${w}`);a=new Uint8Array(l.buffer),Gd(a,X,G),Gd(a,oe,W);const le=new Float64Array(G.buffer),de=new Float64Array(W.buffer),we=z.statistics;for(let Re=0;Re<E;Re++)if(D>1){const ze=le.slice(Re*D,(Re+1)*D),Ct=de.slice(Re*D,(Re+1)*D),Ae=Math.min.apply(null,ze),ke=Math.max.apply(null,Ct);we.push({minValue:Ae,maxValue:ke,depthStats:{minValues:ze,maxValues:Ct}})}else we.push({minValue:le[Re],maxValue:de[Re]});return i(Z),se||i(X),z},KA.decode=(u,d)=>{const{maskCount:f,depthCount:m,bandCount:g,width:y,height:_,dataType:b,bandCountWithNoData:w}=d,x=Hle[b],S=y*_,T=new Uint8Array(S*g),I=S*m*g*x.size,C=new Uint8Array(I),M=new Uint8Array(g),E=new Uint8Array(8*g),[A,$,L,D,F]=c([u.length,T.length,C.length,M.length,E.length]);a.set(u,A),a.set(T,$),a.set(C,L),a.set(M,D),a.set(E,F);const z=s(A,u.length,f,$,m,y,_,g,b,L,D,F);if(z)throw i(A),new Error(`lerc-decode: error code is ${z}`);a=new Uint8Array(l.buffer),Gd(a,L,C),Gd(a,$,T);let U=null;if(w){Gd(a,D,M),Gd(a,F,E),U=[];const G=new Float64Array(E.buffer);for(let W=0;W<M.length;W++)U.push(M[W]?G[W]:null)}return i(A),{data:C,maskData:T,noDataValues:U}}}function S4e(t,e,i,n,r){if(i<2)return t;const s=new n(e*i);if(r)for(let o=0,a=0;o<e;o++)for(let l=0,c=o;l<i;l++,c+=e)s[c]=t[a++];else for(let o=0,a=0;o<e;o++)for(let l=0,c=o;l<i;l++,c+=e)s[a++]=t[c];return s}function Wle(t,e={}){const i=e.inputOffset??0,n=t instanceof Uint8Array?t.subarray(i):new Uint8Array(t,i),r=KA.getBlobInfo(n),{data:s,maskData:o,noDataValues:a}=KA.decode(n,r),{width:l,height:c,bandCount:u,depthCount:d,dataType:f,maskCount:m,statistics:g}=r,y=Hle[f],_=new y.ctor(s.buffer),b=[],w=[],x=l*c,S=x*d;for(let A=0;A<u;A++){const $=_.subarray(A*S,(A+1)*S);if(e.returnInterleaved)b.push($);else{const L=S4e($,x,d,y.ctor,!0);b.push(L)}w.push(o.subarray(A*S,(A+1)*S))}const T=m===0?null:m===1?w[0]:new Uint8Array(x);if(m>1){T.set(w[0]);for(let A=1;A<w.length;A++){const $=w[A];for(let L=0;L<x;L++)T[L]=T[L]&$[L]}}const{noDataValue:I}=e,C=I!=null&&y.range[0]<=I&&y.range[1]>=I;if(m>0&&C)for(let A=0;A<u;A++){const $=b[A],L=w[A]||T;for(let D=0;D<x;D++)L[D]===0&&($[D]=I)}const M=m===u&&u>1?w:null,{pixelType:E}=y;return{width:l,height:c,bandCount:u,pixelType:E,depthCount:d,statistics:g,pixels:b,mask:T,bandMasks:M,noDataValues:a}}function T4e(t,e,i,n=!0){if(e%4!=0||i%4!=0){const r=new ArrayBuffer(4*Math.ceil(i/4)),s=new Uint8Array(r),o=new Uint8Array(t,e,i);if(n)for(let a=0;a<s.length;a+=4)s[a]=o[a+3],s[a+1]=o[a+2],s[a+2]=o[a+1],s[a+3]=o[a];else s.set(o);return new Uint32Array(s.buffer)}if(n){const r=new Uint8Array(t,e,i),s=new Uint8Array(r.length);for(let o=0;o<s.length;o+=4)s[o]=r[o+3],s[o+1]=r[o+2],s[o+2]=r[o+1],s[o+3]=r[o];return new Uint32Array(s.buffer)}return new Uint32Array(t,e,i/4)}function HH(){const t=[];for(let e=0;e<=257;e++)t[e]=[e];return t}function qH(t,e){for(let i=0;i<e.length;i++)t.push(e[i])}const Nv=new Set;function kj(t,e,i,n=!0){const r=T4e(t,e,i,n);let s=9,o=HH(),a=32,l=o.length,c=[],u=1,d=r[0],f=0;const m=r.length,g=8*(4*m-i),y=[];for(;d!=null;){if(a>=s)a-=s,f=d>>>32-s,d<<=s;else{f=d>>>32-a,d=r[u++];const b=s-a;a=32-b,f=(f<<b)+(d>>>a),d<<=b}if(f===257)break;if(f===256){s=9,o=HH(),l=o.length,c=[];continue}const _=o[f];if(_==null){if(f>o.length)throw new Error("data integrity issue: code does not exist on code page");c.push(c[0]),o[l++]=c.slice(),qH(y,c)}else qH(y,_),c.push(_[0]),c.length>1&&(o[l++]=c.slice()),c=_.slice();if(Nv.has(l)&&s++,a===0&&(d=r[u++],a=32),u>m||u===m&&a<=g)break}return new Uint8Array(y)}Nv.add(511),Nv.add(1023),Nv.add(2047),Nv.add(4095),Nv.add(8191);const WH=(t,e)=>{const i=e.width*e.height,n=e.pixelType;return Math.floor(t.byteLength/(i*Jle(n)))},Jle=t=>{let e=1;switch(t){case Uint8Array:case Int8Array:e=1;break;case Uint16Array:case Int16Array:e=2;break;case Uint32Array:case Int32Array:case Float32Array:e=4;break;case Float64Array:e=8}return e},I4e=(t,e)=>{if(8*t.byteLength<e)return null;const i=new Uint8Array(t,0,Math.ceil(e/8)),n=new Uint8Array(e);let r=0,s=0,o=0,a=0;for(o=0;o<i.length-1;o++)for(s=i[o],a=7;a>=0;a--)n[r++]=s>>a&1;for(a=7;r<e-1;)s=i[i.length-1],n[r++]=s>>a&1,a--;return n};let C4e=class{static decode(e,i){const n=i.pixelType,r=[],s=i.width*i.height,o=WH(e,i),{bandIds:a,format:l}=i,c=a&&a.length||WH(e,i),u=e.byteLength-e.byteLength%(s*Jle(n)),d=new n(e,0,s*o);let f,m,g,y,_=null;if(l==="bip")for(f=0;f<c;f++){for(g=new n(s),y=a?a[f]:f,m=0;m<s;m++)g[m]=d[m*o+y];r.push(g)}else if(l==="bsq")for(f=0;f<c;f++)y=a?a[f]:f,r.push(d.subarray(y*s,(y+1)*s));return u<e.byteLength-1&&(_=I4e(e.slice(u),s)),{pixels:r,mask:_}}};function d4(t,e){let i=0,n="",r=0,s=0;const o=t.length;for(;i<o;)s=t[i++],r=s>>4,r<8?r=1:r===15?(r=4,s=(7&s)<<18|(63&t[i++])<<12|(63&t[i++])<<6|63&t[i++]):r===14?(r=3,s=(15&s)<<12|(63&t[i++])<<6|63&t[i++]):(r=2,s=(31&s)<<6|63&t[i++]),(s!==0||e)&&(n+=String.fromCharCode(s));return n}const Oj=(()=>{const t=[];return t[254]="NEWSUBFILETYPE",t[255]="SUBFILETYPE",t[256]="IMAGEWIDTH",t[257]="IMAGELENGTH",t[258]="BITSPERSAMPLE",t[259]="COMPRESSION",t[262]="PHOTOMETRICINTERPRETATION",t[263]="THRESHHOLDING",t[264]="CELLWIDTH",t[265]="CELLLENGTH",t[266]="FILLORDER",t[269]="DOCUMENTNAME",t[270]="IMAGEDESCRIPTION",t[271]="MAKE",t[272]="MODEL",t[273]="STRIPOFFSETS",t[274]="ORIENTATION",t[277]="SAMPLESPERPIXEL",t[278]="ROWSPERSTRIP",t[279]="STRIPBYTECOUNTS",t[280]="MINSAMPLEVALUE",t[281]="MAXSAMPLEVALUE",t[282]="XRESOLUTION",t[283]="YRESOLUTION",t[284]="PLANARCONFIGURATION",t[285]="PAGENAME",t[286]="XPOSITION",t[287]="YPOSITION",t[288]="FREEOFFSETS",t[289]="FREEBYTECOUNTS",t[290]="GRAYRESPONSEUNIT",t[291]="GRAYRESPONSECURVE",t[292]="T4OPTIONS",t[293]="T6OPTIONS",t[296]="RESOLUTIONUNIT",t[297]="PAGENUMBER",t[300]="COLORRESPONSEUNIT",t[301]="TRANSFERFUNCTION",t[305]="SOFTWARE",t[306]="DATETIME",t[315]="ARTIST",t[316]="HOSTCOMPUTER",t[317]="PREDICTOR",t[318]="WHITEPOINT",t[319]="PRIMARYCHROMATICITIES",t[320]="COLORMAP",t[321]="HALFTONEHINTS",t[322]="TILEWIDTH",t[323]="TILELENGTH",t[324]="TILEOFFSETS",t[325]="TILEBYTECOUNTS",t[326]="BADFAXLINES",t[327]="CLEANFAXDATA",t[328]="CONSECUTIVEBADFAXLINES",t[330]="SUBIFD",t[332]="INKSET",t[333]="INKNAMES",t[334]="NUMBEROFINKS",t[336]="DOTRANGE",t[337]="TARGETPRINTER",t[338]="EXTRASAMPLES",t[339]="SAMPLEFORMAT",t[340]="SMINSAMPLEVALUE",t[341]="SMAXSAMPLEVALUE",t[342]="TRANSFERRANGE",t[347]="JPEGTABLES",t[512]="JPEGPROC",t[513]="JPEGIFOFFSET",t[514]="JPEGIFBYTECOUNT",t[515]="JPEGRESTARTINTERVAL",t[517]="JPEGLOSSLESSPREDICTORS",t[518]="JPEGPOINTTRANSFORM",t[519]="JPEGQTABLES",t[520]="JPEGDCTABLES",t[521]="JPEGACTABLES",t[529]="YCBCRCOEFFICIENTS",t[530]="YCBCRSUBSAMPLING",t[531]="YCBCRPOSITIONING",t[532]="REFERENCEBLACKWHITE",t[700]="XMP",t[33550]="GEOPIXELSCALE",t[33922]="GEOTIEPOINTS",t[33432]="COPYRIGHT",t[42112]="GDAL_METADATA",t[42113]="GDAL_NODATA",t[50844]="RPCCOEFFICIENT",t[34264]="GEOTRANSMATRIX",t[34735]="GEOKEYDIRECTORY",t[34736]="GEODOUBLEPARAMS",t[34737]="GEOASCIIPARAMS",t[34665]="EXIFIFD",t[34853]="GPSIFD",t[40965]="INTEROPERABILITYIFD",t})(),M4e=(()=>{const t=Oj.slice();return t[36864]="ExifVersion",t[40960]="FlashpixVersion",t[40961]="ColorSpace",t[42240]="Gamma",t[37121]="ComponentsConfiguration",t[37122]="CompressedBitsPerPixel",t[40962]="PixelXDimension",t[40963]="PixelYDimension",t[37500]="MakerNote",t[37510]="UserComment",t[40964]="RelatedSoundFile",t[36867]="DateTimeOriginal",t[36868]="DateTimeDigitized",t[36880]="OffsetTime",t[36881]="OffsetTimeOriginal",t[36882]="OffsetTimeDigitized",t[37520]="SubSecTime",t[37521]="SubSecTimeOriginal",t[37522]="SubSecTimeDigitized",t[37888]="Temperature",t[37889]="Humidity",t[37890]="Pressure",t[37891]="WaterDepth",t[37892]="Acceleration",t[37893]="CameraElevationAngle",t[42016]="ImageUniqueID",t[42032]="CameraOwnerName",t[42033]="BodySerialNumber",t[42034]="LensSpecification",t[42035]="LensMake",t[42036]="LensModel",t[42037]="LensSerialNumber",t[33434]="ExposureTime",t[33437]="FNumber",t[34850]="ExposureProgram",t[34852]="SpectralSensitivity",t[34855]="PhotographicSensitivity",t[34856]="OECF",t[34864]="SensitivityType",t[34865]="StandardOutputSensitivity",t[34866]="RecommendedExposureIndex",t[34867]="ISOSpeed",t[34868]="ISOSpeedLatitudeyyy",t[34869]="ISOSpeedLatitudezzz",t[37377]="ShutterSpeedValue",t[37378]="ApertureValue",t[37379]="BrightnessValue",t[37380]="ExposureBiasValue",t[37381]="MaxApertureValue",t[37382]="SubjectDistance",t[37383]="MeteringMode",t[37384]="LightSource",t[37385]="Flash",t[37386]="FocalLength",t[37396]="SubjectArea",t[41483]="FlashEnergy",t[41484]="SpatialFrequencyResponse",t[41486]="FocalPlaneXResolution",t[41487]="FocalPlaneYResolution",t[41488]="FocalPlaneResolutionUnit",t[41492]="SubjectLocation",t[41493]="ExposureIndex",t[41495]="SensingMethod",t[41728]="FileSource",t[41729]="SceneType",t[41730]="CFAPattern",t[41985]="CustomRendered",t[41986]="ExposureMode",t[41987]="WhiteBalance",t[41988]="DigitalZoomRatio",t[41989]="FocalLengthIn35mmFilm",t[41990]="SceneCaptureType",t[41991]="GainControl",t[41992]="Contrast",t[41993]="Saturation",t[41994]="Sharpness",t[41995]="DeviceSettingDescription",t[41996]="SubjectDistanceRange",t})(),E4e=["GPSVersionID","GPSLatitudeRef","GPSLatitude","GPSLongitudeRef","GPSLongitude","GPSAltitudeRef","GPSAltitude","GPSTimeStamp","GPSSatellites","GPSStatus","GPSMeasureMode","GPSDOP","GPSSpeedRef","GPSSpeed","GPSTrackRef","GPSTrack","GPSImgDirectionRef","GPSImgDirection","GPSMapDatum","GPSDestLatitudeRef","GPSDestLatitude","GPSDestLongitudeRef","GPSDestLongitude","GPSDestBearingRef","GPSDestBearing","GPSDestDistanceRef","GPSDestDistance","GPSProcessingMethod","GPSAreaInformation","GPSDateStamp","GPSDifferential","GPSHPositioningError"],A4e=(()=>{const t=[];return t[1024]="GTModelTypeGeoKey",t[1025]="GTRasterTypeGeoKey",t[1026]="GTCitationGeoKey",t[2048]="GeographicTypeGeoKey",t[2049]="GeogCitationGeoKey",t[2050]="GeogGeodeticDatumGeoKey",t[2051]="GeogPrimeMeridianGeoKey",t[2052]="GeogLinearUnitsGeoKey",t[2053]="GeogLinearUnitSizeGeoKey",t[2054]="GeogAngularUnitsGeoKey",t[2055]="GeogAngularUnitSizeGeoKey",t[2056]="GeogEllipsoidGeoKey",t[2057]="GeogSemiMajorAxisGeoKey",t[2058]="GeogSemiMinorAxisGeoKey",t[2059]="GeogInvFlatteningGeoKey",t[2061]="GeogPrimeMeridianLongGeoKey",t[2060]="GeogAzimuthUnitsGeoKey",t[3072]="ProjectedCSTypeGeoKey",t[3073]="PCSCitationGeoKey",t[3074]="ProjectionGeoKey",t[3075]="ProjCoordTransGeoKey",t[3076]="ProjLinearUnitsGeoKey",t[3077]="ProjLinearUnitSizeGeoKey",t[3078]="ProjStdParallel1GeoKey",t[3079]="ProjStdParallel2GeoKey",t[3080]="ProjNatOriginLongGeoKey",t[3081]="ProjNatOriginLatGeoKey",t[3082]="ProjFalseEastingGeoKey",t[3083]="ProjFalseNorthingGeoKey",t[3084]="ProjFalseOriginLongGeoKey",t[3085]="ProjFalseOriginLatGeoKey",t[3086]="ProjFalseOriginEastingGeoKey",t[3087]="ProjFalseOriginNorthingGeoKey",t[3088]="ProjCenterLongGeoKey",t[3090]="ProjCenterEastingGeoKey",t[3091]="ProjCenterNorthingGeoKey",t[3092]="ProjScaleAtNatOriginGeoKey",t[3093]="ProjScaleAtCenterGeoKey",t[3094]="ProjAzimuthAngleGeoKey",t[3095]="ProjStraightVertPoleLongGeoKey",t[4096]="VerticalCSTypeGeoKey",t[4097]="VerticalCitationGeoKey",t[4098]="VerticalDatumGeoKey",t[4099]="VerticalUnitsGeoKey",t})(),$4e=(t,e)=>{let i=(e||Oj)[t];return i===void 0&&(i="unknown"+String(t)),i},p4=new Map;p4.set("EXIFIFD",M4e),p4.set("GPSIFD",E4e);const Tu={TIFF_TAGS:Oj,ifdTags:p4,GEO_KEYS:A4e,getTagName:$4e},tk=(()=>{const t=new ArrayBuffer(4),e=new Uint8Array(t);return new Uint32Array(t)[0]=1,e[0]===1})(),JH=[0,1,1,2,4,8,1,1,2,4,8,4,8,-1,-1,-1,8,8,8],mb=4294967296,P4e=new Set([1,5,6,7,8,34712,34887]);function Lj(t,e){let i="unknown";return t===3?i=e===64?"f64":"f32":t===1?e===1?i="u1":e===2?i="u2":e===4?i="u4":e<=8?i="u8":e<=16?i="u16":e<=32&&(i="u32"):t===2&&(e<=8?i="s8":e<=16?i="s16":e<=32&&(i="s32")),i}function ik(t){let e=null;switch(t?t.toLowerCase():"f32"){case"u1":case"u2":case"u4":case"u8":e=Uint8Array;break;case"u16":e=Uint16Array;break;case"u32":e=Uint32Array;break;case"s8":e=Int8Array;break;case"s16":e=Int16Array;break;case"s32":e=Int32Array;break;case"f64":e=Float64Array;break;default:e=Float32Array}return e}function k4e(t,e){return{x:e[0]*t.x+e[1]*t.y+e[2],y:e[3]*t.x+e[4]*t.y+e[5]}}function Zle(t,e){var i;return(i=t.get(e))==null?void 0:i.values}function Ty(t,e){var i;return(i=t.get(e))==null?void 0:i.values}function ZH(t,e){var i,n;return(n=(i=t.get(e))==null?void 0:i.values)==null?void 0:n[0]}function tt(t,e){var i,n;return(n=(i=t.get(e))==null?void 0:i.values)==null?void 0:n[0]}function AO(t,e,i,n=0,r=Tu.TIFF_TAGS,s=4){const o=s===8,a=o?Nj(new DataView(t,i,8),0,e):new DataView(t,i,2).getUint16(0,e),l=4+2*s,c=o?8:2,u=c+a*l;if(i+u>t.byteLength)return{success:!1,ifd:null,nextIFD:null,requiredBufferSize:u};const d=i+u+4<=t.byteLength?YM(new DataView(t,i+u,s===8?8:4),0,e,s===8):null,f=i+c,m=new Map;let g,y,_,b,w,x=0,S=0;for(let T=0;T<a;T++){y=new DataView(t,f+l*T,l),_=y.getUint16(0,e),w=y.getUint16(2,e),b=Tu.getTagName(_,r);const I=[];s===2?(x=y.getUint16(4,e),S=y.getUint16(6,e)):s===4?(x=y.getUint32(4,e),S=y.getUint32(8,e)):s===8&&(x=YM(y,4,e,!0),S=YM(y,12,e,!0),I.push(y.getUint32(12,e)),I.push(y.getUint32(16,e))),g={id:_,type:w,valueCount:x,valueOffset:S,valueOffsets:I,values:null},Yle(t,e,g,n,!1,s),m.set(b,g)}return{success:!0,ifd:m,nextIFD:d,requiredBufferSize:u}}const O4e=(t,e)=>Wle(t,{inputOffset:e}).pixels[0];function f4(t,e){if(e!==1&&e!==2&&e!==4)return t;const i=new Uint8Array(t),n=8/e,r=new Uint8Array(t.byteLength*n);let s=0;const o=2**e-1;for(let a=0;a<i.length;a++){const l=i[a];for(let c=0;c<n;c++)r[s++]=l<<e*c>>>8-e&o}return r.buffer}function m4(t,e,i){const n=new Gle;n.parse(t),n.colorTransform=i===6?-1:0;const r=n.getData(n.width,n.height,e!==1);return new Uint8Array(r.buffer)}function g4(t){const e=new hT(t).getBytes(),i=new ArrayBuffer(e.length),n=new Uint8Array(i);return n.set(e),n}async function y4(t,e,i,n,r){const s=tk===e,o=tt(i,"BITSPERSAMPLE"),a=tt(i,"SAMPLESPERPIXEL")??1,l=tt(i,"PHOTOMETRICINTERPRETATION"),c=tt(i,"SAMPLEFORMAT")??1,u=Lj(c,o),d=tt(i,"COMPRESSION")??1,f=ik(u);let m,g,y;if(d===34887)return await qle(),O4e(t,n);if(d===1)m=t.slice(n,n+r),g=new Uint8Array(m);else if(d===8||d===32946)g=new Uint8Array(t,n,r),g=g4(g),m=g.buffer;else if(d===6)g=new Uint8Array(t,n,r),g=m4(g,a,l),m=g.buffer;else if(d===7){const x=i.get("JPEGTABLES").values,S=x.length-2;g=new Uint8Array(S+r-2);for(let I=0;I<S;I++)g[I]=x[I];const T=new Uint8Array(t,n+2,r-2);for(let I=0;I<T.length;I++)g[S+I]=T[I];g=m4(g,a,l),m=g.buffer}else{if(d!==5)throw new Error("tiff-decode: unsupport compression "+d);g=kj(t,n,r,e),m=g.buffer}if(m=f4(m,o),u==="u8"||u==="s8"||s)y=new f(m);else{m=new ArrayBuffer(g.length);const x=new Uint8Array(m);switch(u){case"u16":case"s16":for(let S=0;S<g.length;S+=2)x[S]=g[S+1],x[S+1]=g[S];break;case"u32":case"s32":case"f32":for(let S=0;S<g.length;S+=4)x[S]=g[S+3],x[S+1]=g[S+2],x[S+2]=g[S+1],x[S+3]=g[S]}y=new f(m)}const _=tt(i,"PREDICTOR")??1,b=tt(i,"TILEWIDTH"),w=tt(i,"TILELENGTH");if(_>1&&(d===5||d===8||d===32946)&&b&&w){const x=dT(i),S=new f(y.length);S.set(y),y=V4e(S,w,b,c===3&&_===3,x?1:a)}return y}async function L4e(t,e,i){const n=Ty(i,"TILEOFFSETS");if(n===void 0)return null;const r=Ty(i,"TILEBYTECOUNTS"),{width:s,height:o,pixelType:a,tileWidth:l,tileHeight:c}=nk([i]),u=dT(i,e),d=tt(i,"SAMPLESPERPIXEL")||e.planes,f=s*o,m=tt(i,"BITSPERSAMPLE"),g=(tt(i,"COMPRESSION")??1)===34887,y=ik(a),_=[];for(let z=0;z<d;z++)_.push(new y(f));let b,w,x,S,T,I,C,M,E,A,$,L,D;const F=Math.ceil(s/l);if(m%8==0){if(g&&u&&d>1){const z=Math.round(n.length/d);for(b=0;b<z;b++){I=Math.floor(b/F)*c,C=b%F*l,M=I*s+C;for(let U=0;U<d;U++){const G=b*d+U;if(r[G]!==0)for(x=await y4(t,e.littleEndian,i,n[G],r[G]),A=0,E=M,L=Math.min(l,s-C),$=Math.min(c,o-I),D=_[U],S=0;S<$;S++)for(E=M+S*s,A=S*l,T=0;T<L;T++,E++,A++)D[E]=x[A]}}}else for(b=0;b<n.length;b++)if(r[b]!==0)for(I=Math.floor(b/F)*c,C=b%F*l,M=I*s+C,x=await y4(t,e.littleEndian,i,n[b],r[b]),A=0,E=M,L=Math.min(l,s-C),$=Math.min(c,o-I),w=0;w<d;w++)if(D=_[w],u||g)for(S=0;S<$;S++)for(E=M+S*s,A=l*c*w+S*l,T=0;T<L;T++,E++,A++)D[E]=x[A];else for(S=0;S<$;S++)for(E=M+S*s,A=S*l*d+w,T=0;T<L;T++,E++,A+=d)D[E]=x[A]}return{width:s,height:o,pixelType:a,pixels:_}}const R4e=(t,e,i)=>{const n=tk===e.littleEndian,r=Ty(i,"STRIPOFFSETS");if(r===void 0)return null;const{width:s,height:o,pixelType:a}=nk([i]),l=tt(i,"SAMPLESPERPIXEL")||e.planes,c=tt(i,"PHOTOMETRICINTERPRETATION"),u=s*o,d=tt(i,"BITSPERSAMPLE"),f=ik(a),m=new f(u*l),g=Ty(i,"STRIPBYTECOUNTS"),y=tt(i,"ROWSPERSTRIP"),_=tt(i,"COMPRESSION")??1;let b,w,x,S,T,I,C,M,E,A=y;if(d%8==0)for(b=0;b<r.length;b++){if(T=b*(y*s)*l,A=(b+1)*y>o?o-b*y:y,a==="u8"||a==="s8"||n)_===8||_===32946?(C=new Uint8Array(t,r[b],g[b]),C=g4(C),I=C.buffer):_===6?(C=new Uint8Array(t,r[b],g[b]),C=m4(C,l,c),I=C.buffer):_===5?(C=kj(t,r[b],g[b],e.littleEndian),I=C.buffer):(g[b]!==A*s*l*d/8&&console.log("strip byte counts is different than expected"),I=t.slice(r[b],r[b]+g[b])),I=f4(I,d),S=new f(I);else{switch(_===6||_===8||_===32946?(C=new Uint8Array(t,r[b],g[b]),M=g4(C),I=M.buffer):(g[b]!==A*s*l*d/8&&console.log("strip byte counts is different than expected"),I=new ArrayBuffer(g[b]),C=new Uint8Array(t,r[b],g[b]),M=new Uint8Array(I)),a){case"u16":case"s16":for(x=0;x<C.length;x+=2)M[x]=C[x+1],M[x+1]=C[x];break;case"u32":case"s32":case"f32":for(x=0;x<C.length;x+=4)M[x]=C[x+3],M[x+1]=C[x+2],M[x+2]=C[x+1],M[x+3]=C[x]}I=f4(I,d),S=new f(I)}m.set(S,T)}const $=[];if(l===1)$.push(m);else for(b=0;b<l;b++){for(E=new f(u),w=0;w<u;w++)E[w]=m[w*l+b];$.push(E)}return{width:s,height:o,pixelType:a,pixels:$}},D4e=(t,e,i)=>{if(!(t&&t.length>0&&e&&i))return null;let n,r,s;const o=t[0].length,a=t.length,l=new Uint8Array(o);for(let c=0;c<a;c++)if(n=t[c],r=e[c],s=i[c],c===0)for(let u=0;u<o;u++)l[u]=n[u]<r||n[u]>s?0:1;else for(let u=0;u<o;u++)l[u]&&(l[u]=n[u]<r||n[u]>s?0:1);return l},N4e=t=>{if(!t)return null;const e=t.match(/<Item(.*?)Item>/gi);if(!e||e.length===0)return null;const i=new Map;let n,r,s,o,a;for(let b=0;b<e.length;b++)n=e[b],r=n.slice(6,n.indexOf(">")),o=n.indexOf("sample="),o>-1&&(a=n.slice(o+8,n.indexOf('"',o+8))),o=n.indexOf("name="),o>-1&&(r=n.slice(o+6,n.indexOf('"',o+6))),r&&(s=n.slice(n.indexOf(">")+1,n.indexOf("</Item>")).trim(),a!=null?i.has(r)?i.get(r)[a]=s:i.set(r,[s]):i.set(r,s)),a=null;const l=i.get("STATISTICS_MINIMUM"),c=i.get("STATISTICS_MAXIMUM"),u=i.get("STATISTICS_MEAN"),d=i.get("STATISTICS_STDDEV");let f=null;if(l&&c){f=[];for(let b=0;b<l.length;b++)f.push({min:parseFloat(l[b]),max:parseFloat(c[b]),avg:u&&parseFloat(u[b]),stddev:d&&parseFloat(d[b])})}const m=i.get("BandName"),g=i.get("WavelengthMin"),y=i.get("WavelengthMax");let _=null;if(m){_=[];for(let b=0;b<m.length;b++)_.push({BandName:m[b],WavelengthMin:g&&parseFloat(g[b]),WavelengthMax:y&&parseFloat(y[b])})}return{statistics:f,bandProperties:_,dataType:i.get("DataType"),rawMetadata:i}};function Yle(t,e,i,n=0,r=!1,s=4){if(i.values)return!0;const o=i.type,a=i.valueCount;let l=i.valueOffset,c=[];const u=JH[o],d=8*u,f=a*u,m=a*JH[o]*8;let g,y;const _=s===8?64:32,b=i.valueOffsets;if(m>_&&f>(r?t.byteLength:t?t.byteLength-l+n:0))return i.offlineOffsetSize=[l,f],i.values=null,!1;if(m<=_){if(!e)if(_<=32)l>>>=32-m;else{const w=b!=null&&b.length?b[0]:l>>>0,x=b!=null&&b.length?b[1]:Math.round((l-w)/mb);m<=32?(l=w>>>32-m,b[0]=l):(l=w*2**(32-m)+(x>>>32-m),b[0]=w,b[1]=x>>>32-m)}if(a===1&&d===_)c=[l];else if(_===64){const w=b!=null&&b.length?b[0]:l>>>0,x=b!=null&&b.length?b[1]:Math.round((l-w)/mb);let S=w,T=32;for(y=1;y<=a;y++){const I=32-d*y%32;if(T<d){const C=S<<I>>>32-T,M=x<<32-T>>>32-T;S=x,c.push(C+M*2**(d-T)),T-=32-(d-T)}else c.push(S<<I>>>32-d),T-=d;T===0&&(T=32,S=x)}}else for(y=1;y<=a;y++){const w=32-d*y;c.push(l<<w>>>32-d)}}else{l-=n,r&&(l=0);for(let w=l;w<l+f;w+=u){switch(o){case 1:case 2:case 7:g=new DataView(t,w,1).getUint8(0);break;case 3:g=new DataView(t,w,2).getUint16(0,e);break;case 4:case 13:g=new DataView(t,w,4).getUint32(0,e);break;case 5:g=new DataView(t,w,4).getUint32(0,e)/new DataView(t,w+4,4).getUint32(0,e);break;case 6:g=new DataView(t,w,1).getInt8(0);break;case 8:g=new DataView(t,w,2).getInt16(0,e);break;case 9:g=new DataView(t,w,4).getInt32(0,e);break;case 10:g=new DataView(t,w,4).getInt32(0,e)/new DataView(t,w+4,4).getInt32(0,e);break;case 11:g=new DataView(t,w,4).getFloat32(0,e);break;case 12:g=new DataView(t,w,8).getFloat64(0,e);break;case 16:case 18:g=Nj(new DataView(t,w,8),0,e);break;case 17:g=z4e(new DataView(t,w,8),0,e);break;default:g=null}c.push(g)}}if(o===2){let w="";const x=c;for(c=[],y=0;y<x.length;y++)x[y]===0&&w!==""?(c.push(w),w=""):w+=String.fromCharCode(x[y]);w===""&&c.length!==0||c.push(w)}return i.values=c,!0}function nk(t){const e=t[0],i=tt(e,"TILEWIDTH"),n=tt(e,"TILELENGTH"),r=tt(e,"IMAGEWIDTH"),s=tt(e,"IMAGELENGTH"),o=tt(e,"BITSPERSAMPLE"),a=tt(e,"SAMPLESPERPIXEL"),l=tt(e,"SAMPLEFORMAT")??1,c=Lj(l,o),u=dT(e),d=Zle(e,"GDAL_NODATA");let f=null;d!=null&&d.length&&(f=d.map(Z=>parseFloat(Z)),f.some(Z=>isNaN(Z))&&(f=null));const m=tt(e,"COMPRESSION")??1;let g;switch(m){case 1:g="NONE";break;case 2:case 3:case 4:case 32771:g="CCITT";break;case 5:g="LZW";break;case 6:case 7:g="JPEG";break;case 32773:g="PACKBITS";break;case 8:case 32946:g="DEFLATE";break;case 34712:g="JPEG2000";break;case 34887:g="LERC";break;default:g=String(m)}let y=!0,_="";P4e.has(m)||(y=!1,_+="unsupported tag compression "+m),l>3&&(y=!1,_+="unsupported tag sampleFormat "+l),o!==1&&o!==2&&o!==4&&o%8!=0&&(y=!1,_+="unsupported tag bitsPerSample "+o);const b=ZH(e,"GEOASCIIPARAMS");let w;if(b){const Z=b.split("|").find(oe=>oe.includes("ESRI PE String = ")),X=Z?Z.replace("ESRI PE String = ",""):"";w=X.startsWith("COMPD_CS")||X.startsWith("PROJCS")||X.startsWith("GEOGCS")?{wkid:null,wkt:X}:null}const x=Ty(e,"GEOTIEPOINTS"),S=Ty(e,"GEOPIXELSCALE"),T=Ty(e,"GEOTRANSMATRIX"),I=e.has("GEOKEYDIRECTORY")?e.get("GEOKEYDIRECTORY").data:null;let C,M,E=!1,A=!1;if(I){E=tt(I,"GTRasterTypeGeoKey")===2;const Z=tt(I,"GTModelTypeGeoKey");if(Z===2){const X=tt(I,"GeographicTypeGeoKey");X>=1024&&X<=32766&&(w={wkid:X}),w||X!==32767||(A=!0,w={wkid:4326})}else if(Z===1){const X=tt(I,"ProjectedCSTypeGeoKey");X>=1024&&X<=32766&&(w={wkid:X})}}if(S&&x&&x.length>=6?(C=[S[0],0,x[3]-x[0]*S[0],0,-Math.abs(S[1]),x[4]-x[1]*S[1]],E&&(C[2]-=.5*C[0]+.5*C[1],C[5]-=.5*C[3]+.5*C[4])):T&&T.length===16&&(C=E?[T[0],T[1],T[3]-.5*T[0],T[4],T[5],T[7]-.5*T[5]]:[T[0],T[1],T[3],T[4],T[5],T[7]]),C){const Z=[{x:0,y:s},{x:0,y:0},{x:r,y:s},{x:r,y:0}];let X,oe=Number.POSITIVE_INFINITY,se=Number.POSITIVE_INFINITY,le=Number.NEGATIVE_INFINITY,de=Number.NEGATIVE_INFINITY;for(let we=0;we<Z.length;we++)X=k4e(Z[we],C),oe=X.x>oe?oe:X.x,le=X.x<le?le:X.x,se=X.y>se?se:X.y,de=X.y<de?de:X.y;M={xmin:oe,xmax:le,ymin:se,ymax:de,spatialReference:w}}else M={xmin:-.5,ymin:.5-s,xmax:r-.5,ymax:.5,spatialReference:w};A&&(M.xmax-M.xmin>400||Math.max(Math.abs(M.xmin),Math.abs(M.xmax))>361)&&(w=null,M.spatialReference=null);const $=Rj(t);let L,D,F,z,U;if($.length>0){F=Math.round(Math.log(r/tt($[0],"IMAGEWIDTH"))/Math.LN2);const Z=$[$.length-1];z=Math.round(Math.log(r/tt(Z,"IMAGEWIDTH"))/Math.LN2),L=tt(Z,"TILEWIDTH"),D=tt(Z,"TILELENGTH")}L=z!=null&&z>0?L||i:null,D=z!=null&&z>0?D||n:null,i&&(U=[{maxCol:Math.ceil(r/i)-1,maxRow:Math.ceil(s/n)-1,minRow:0,minCol:0}],$.forEach(Z=>{U.push({maxCol:Math.ceil(tt(Z,"IMAGEWIDTH")/tt(Z,"TILEWIDTH"))-1,maxRow:Math.ceil(tt(Z,"IMAGELENGTH")/tt(Z,"TILELENGTH"))-1,minRow:0,minCol:0})}));const G=ZH(t[0],"GDAL_METADATA"),W=N4e(G);return _+=" "+Qle({width:r,height:s,tileWidth:i,tileHeight:n,planes:a,ifds:t}),{width:r,height:s,tileWidth:i,tileHeight:n,planes:a,isBSQ:u,pixelType:c,compression:g,noData:f,hasMaskBand:Dj(t).length===$.length+1,isSupported:y,message:_,extent:M,isPseudoGeographic:A,affine:S?null:C,firstPyramidLevel:F,maximumPyramidLevel:z,pyramidBlockWidth:L,pyramidBlockHeight:D,tileBoundary:U,metadata:W}}function dT(t,e){const i=Zle(t,"PLANARCONFIGURATION");return i?i[0]===2:!!e&&e.isBSQ}function Rj(t){return t.filter(e=>tt(e,"NEWSUBFILETYPE")===1)}function Dj(t){return t.filter(e=>{const i=(4&(tt(e,"NEWSUBFILETYPE")??0))==4,n=tt(e,"PHOTOMETRICINTERPRETATION")===4;return i&&n})}function F4e(t){const{littleEndian:e,isBigTiff:i,firstIFDPos:n}=Xle(t);let r=n;const s=[];do{const o=Kle(t,e,r,0,Tu.TIFF_TAGS,i?8:4);if(!o.success)break;s.push(o.ifd),r=o.nextIFD}while(r>0);return{...nk(s),littleEndian:e,isBigTiff:i,ifds:s,pyramidIFDs:Rj(s),maskIFDs:Dj(s)}}function Nj(t,e,i){const n=t.getUint32(e,i),r=t.getUint32(e+4,i);return i?r*mb+n:n*mb+r}function z4e(t,e,i){let n=i?t.getInt32(e,i):t.getUint32(e,i),r=i?t.getUint32(e+4,i):t.getInt32(e+4,i);const s=(i?n:r)>=0?1:-1;return i?n*=s:r*=s,s*(i?r*mb+n:n*mb+r)}function YM(t,e,i,n){return n?Nj(t,e,i):t.getUint32(e,i)}function Xle(t){const e=new DataView(t,0,16),i=e.getUint16(0,!1);let n=null;if(i===18761)n=!0;else{if(i!==19789)throw new Error("unexpected endianess byte");n=!1}const r=e.getUint16(2,n);if(r!==42&&r!==43)throw new Error("unexpected tiff identifier");let s=4;const o=r===43;if(o){const a=e.getUint16(s,n);if(s+=2,a!==8)throw new Error("unsupported bigtiff version");if(e.getUint16(s,n)!==0)throw new Error("unsupported bigtiff version");s+=2}return{littleEndian:n,isBigTiff:o,firstIFDPos:YM(e,s,n,o)}}function Kle(t,e,i,n=0,r=Tu.TIFF_TAGS,s=4){const o=AO(t,e,i,n,r,s);let a;const l=o.ifd;if(l){if(Tu.ifdTags.forEach((c,u)=>{l.has(u)&&(a=l.get(u),a.data=AO(t,e,a.valueOffset-n,n,c).ifd)}),l.has("GEOKEYDIRECTORY")){a=l.get("GEOKEYDIRECTORY");const c=a.values;if(c&&c.length>4){const u=c[0]+"."+c[1]+"."+c[2];a.data=AO(t,e,a.valueOffset+6-n,n,Tu.GEO_KEYS,2).ifd,a.data&&a.data.set("GEOTIFFVersion",{id:0,type:2,valueCount:1,valueOffset:null,values:[u]})}}if(l.has("XMP")){a=l.get("XMP");const c=a.values;typeof c[0]=="number"&&a.type===7&&(a.values=[d4(new Uint8Array(c))])}}return o}function Qle(t){const{width:e,height:i,tileHeight:n,tileWidth:r}=t,s=t.planes,o=r?r*n:e*i,a=tt(t.ifds[0],"BITSPERSAMPLE");let l="";return o*s>2**30/(a>8?a/8:1)&&(l=r?"tiled tiff exceeding 1 gigabits per tile is not supported":"scanline tiff exceeding 1 gigabits is not supported"),l}function V4e(t,e,i,n,r){const s=n?4:1,o=i*s*r;n&&(t=new Uint8Array(t.buffer));for(let c=0;c<e;c++){const u=c*o;for(let d=r;d<o;d++)t[u+d]+=t[u+d-r]}if(!n)return t;const a=new Uint8Array(t.length),l=i*r;for(let c=0;c<e;c++){const u=c*o;for(let d=0;d<l;d++)for(let f=0;f<s;f++)a[u+d*s+f]=t[u+d+(s-f-1)*l]}return new Float32Array(a.buffer)}async function j4e(t,e){const{headerInfo:i,ifd:n,offsets:r,sizes:s}=e,o=[];for(let E=0;E<r.length;E++){const A=await y4(t,i.littleEndian,n,r[E],s[E]||t.byteLength);o.push(A)}const a=dT(n,i),l=tt(n,"BITSPERSAMPLE"),c=Lj(tt(n,"SAMPLEFORMAT")??1,l),u=tt(n,"SAMPLESPERPIXEL")||i.planes,d=ik(c),f=tt(n,"TILEWIDTH"),m=tt(n,"TILELENGTH"),g=tt(n,"COMPRESSION")??1,y=f*m;let _;const b=[];let w=o[0];const x=g===34887;for(let E=0;E<u;E++){if(_=new d(y),o.length===u)w=o[E],w.length===y&&(_=w);else if(w.length)if(a||x)_=w.length===y?w:w.slice(y*E,y*(E+1));else for(let A=0;A<y;A++)_[A]=w[A*u+E];b.push(_)}const S=i.noData?i.noData[0]:e.noDataValue,T=i.metadata?i.metadata.statistics:null,I=T?T.map(E=>E.min):null,C=T?T.map(E=>E.max):null,M={pixelType:c,width:f,height:m,pixels:b,noDataValue:S};return S!=null?KP(M,S):I&&C&&e.applyMinMaxConstraint&&(M.mask=D4e(b,I,C)),M}async function B4e(t,e={}){const i=e.pyramidLevel||0,n=e.headerInfo||F4e(t),{ifds:r,noData:s}=n;if(r.length===0)throw new Error("no valid image file directory");const o=Qle(n);if(o)throw o;let a=null;const l=i===-1?r[r.length-1]:r[i],c=s??e.noDataValue;return a=n.tileWidth?await L4e(t,n,l):await R4e(t,n,l),a&&(c!=null&&KP(a,c),a)}var U4e=function(t){var e,i,n,r,s,o;function a(l){var c,u,d,f,m,g,y,_,b,w,x,S,T;for(this.data=l,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},m=null;;){switch(c=this.readUInt32(),_=(function(){var I,C;for(C=[],I=0;I<4;++I)C.push(String.fromCharCode(this.data[this.pos++]));return C}).call(this).join(""),_){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(c);break;case"fcTL":m&&this.animation.frames.push(m),this.pos+=4,m={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},f=this.readUInt16(),d=this.readUInt16()||100,m.delay=1e3*f/d,m.disposeOp=this.data[this.pos++],m.blendOp=this.data[this.pos++],m.data=[];break;case"IDAT":case"fdAT":for(_==="fdAT"&&(this.pos+=4,c-=4),l=(m!=null?m.data:void 0)||this.imgData,x=0;0<=c?x<c:x>c;0<=c?++x:--x)l.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(this.transparency.indexed=this.read(c),(b=255-this.transparency.indexed.length)>0)for(S=0;0<=b?S<b:S>b;0<=b?++S:--S)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(c)[0];break;case 2:this.transparency.rgb=this.read(c)}break;case"tEXt":g=(w=this.read(c)).indexOf(0),y=String.fromCharCode.apply(String,w.slice(0,g)),this.text[y]=String.fromCharCode.apply(String,w.slice(g+1));break;case"IEND":return m&&this.animation.frames.push(m),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(T=this.colorType)===4||T===6,u=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*u,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=c}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}return a.load=function(l,c,u){var d;return typeof c=="function"&&(u=c),(d=new XMLHttpRequest).open("GET",l,!0),d.responseType="arraybuffer",d.onload=function(){var f;return f=new a(new Uint8Array(d.response||d.mozResponseArrayBuffer)),typeof(c!=null?c.getContext:void 0)=="function"&&f.render(c),typeof u=="function"?u(f):void 0},d.send(null)},i=1,n=2,e=0,a.prototype.read=function(l){var c,u;for(u=[],c=0;0<=l?c<l:c>l;0<=l?++c:--c)u.push(this.data[this.pos++]);return u},a.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},a.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},a.prototype.decodePixels=function(l){var c,u,d,f,m,g,y,_,b,w,x,S,T,I,C,M,E,A,$,L,D,F,z;if(l==null&&(l=this.imgData),l.length===0)return new Uint8Array(0);for(l=(l=new hT(l)).getBytes(),M=(S=this.pixelBitlength/8)*this.width,T=new Uint8Array(M*this.height),g=l.length,C=0,I=0,u=0;I<g;){switch(l[I++]){case 0:for(f=$=0;$<M;f=$+=1)T[u++]=l[I++];break;case 1:for(f=L=0;L<M;f=L+=1)c=l[I++],m=f<S?0:T[u-S],T[u++]=(c+m)%256;break;case 2:for(f=D=0;D<M;f=D+=1)c=l[I++],d=(f-f%S)/S,E=C&&T[(C-1)*M+d*S+f%S],T[u++]=(E+c)%256;break;case 3:for(f=F=0;F<M;f=F+=1)c=l[I++],d=(f-f%S)/S,m=f<S?0:T[u-S],E=C&&T[(C-1)*M+d*S+f%S],T[u++]=(c+Math.floor((m+E)/2))%256;break;case 4:for(f=z=0;z<M;f=z+=1)c=l[I++],d=(f-f%S)/S,m=f<S?0:T[u-S],C===0?E=A=0:(E=T[(C-1)*M+d*S+f%S],A=d&&T[(C-1)*M+(d-1)*S+f%S]),y=m+E-A,_=Math.abs(y-m),w=Math.abs(y-E),x=Math.abs(y-A),b=_<=w&&_<=x?m:w<=x?E:A,T[u++]=(c+b)%256;break;default:throw new Error("Invalid filter algorithm: "+l[I-1])}C++}return T},a.prototype.decodePalette=function(){var l,c,u,d,f,m,g,y,_;for(u=this.palette,m=this.transparency.indexed||[],f=new Uint8Array((m.length||0)+u.length),d=0,u.length,l=0,c=g=0,y=u.length;g<y;c=g+=3)f[d++]=u[c],f[d++]=u[c+1],f[d++]=u[c+2],f[d++]=(_=m[l++])!=null?_:255;return f},a.prototype.copyToImageData=function(l,c){var u,d,f,m,g,y,_,b,w,x,S;if(d=this.colors,w=null,u=this.hasAlphaChannel,this.palette.length&&(w=(S=this._decodedPalette)!=null?S:this._decodedPalette=this.decodePalette(),d=4,u=!0),b=(f=l.data||l).length,g=w||c,m=y=0,d===1)for(;m<b;)_=w?4*c[m/4]:y,x=g[_++],f[m++]=x,f[m++]=x,f[m++]=x,f[m++]=u?g[_++]:this.transparency.grayscale&&this.transparency.grayscale===x?0:255,y=_;else for(;m<b;)_=w?4*c[m/4]:y,f[m++]=g[_++],f[m++]=g[_++],f[m++]=g[_++],f[m++]=u?g[_++]:this.transparency.rgb&&this.transparency.rgb[1]===g[_-3]&&this.transparency.rgb[3]===g[_-2]&&this.transparency.rgb[5]===g[_-1]?0:255,y=_},a.prototype.decode=function(){var l;return l=new Uint8Array(this.width*this.height*4),this.copyToImageData(l,this.decodePixels()),l},s=t.document&&t.document.createElement("canvas"),o=s&&s.getContext("2d"),r=function(l){var c;return o.width=l.width,o.height=l.height,o.clearRect(0,0,l.width,l.height),o.putImageData(l,0,0),(c=new Image).src=s.toDataURL(),c},a.prototype.decodeFrames=function(l){var c,u,d,f,m,g,y,_;if(this.animation){for(_=[],u=m=0,g=(y=this.animation.frames).length;m<g;u=++m)c=y[u],d=l.createImageData(c.width,c.height),f=this.decodePixels(new Uint8Array(c.data)),this.copyToImageData(d,f),c.imageData=d,_.push(c.image=r(d));return _}},a.prototype.renderFrame=function(l,c){var u,d,f;return u=(d=this.animation.frames)[c],f=d[c-1],c===0&&l.clearRect(0,0,this.width,this.height),(f!=null?f.disposeOp:void 0)===i?l.clearRect(f.xOffset,f.yOffset,f.width,f.height):(f!=null?f.disposeOp:void 0)===n&&l.putImageData(f.imageData,f.xOffset,f.yOffset),u.blendOp===e&&l.clearRect(u.xOffset,u.yOffset,u.width,u.height),l.drawImage(u.image,u.xOffset,u.yOffset)},a.prototype.animate=function(l){var c,u,d,f,m,g,y=this;return u=0,g=this.animation,f=g.numFrames,d=g.frames,m=g.numPlays,(c=function(){var _,b;if(_=u++%f,b=d[_],y.renderFrame(l,_),f>1&&u/f<m)return y.animation._timeout=setTimeout(c,b.delay)})()},a.prototype.stopAnimation=function(){var l;return clearTimeout((l=this.animation)!=null?l._timeout:void 0)},a.prototype.render=function(l){var c,u;return l._png&&l._png.stopAnimation(),l._png=this,l.width=this.width,l.height=this.height,c=l.getContext("2d"),this.animation?(this.decodeFrames(c),this.animate(c)):(u=c.createImageData(this.width,this.height),this.copyToImageData(u,this.decodePixels()),c.putImageData(u,0,0))},a}(self);const G4e=new Set(["jpg","png","bmp","gif"]);async function H4e(t,e){if(!tk)throw new V("rasterCoded:decode","lerc decoder is not supported on big endian platform");await qle();const{offset:i}=e,{width:n,height:r,pixelType:s,statistics:o,depthCount:a,noDataValues:l,bandMasks:c,pixels:u,mask:d}=Wle(t,{inputOffset:i,returnInterleaved:e.returnInterleaved});return new ue({width:n,height:r,pixelType:s.toLowerCase(),pixels:u,mask:d,statistics:o,bandMasks:c,depthCount:a,noDataValues:l})}async function q4e(t,e){const i=await B4e(t,{...e,noDataValue:null});ks(i);const n=new ue({width:i.width,height:i.height,pixels:i.pixels,pixelType:i.pixelType.toLowerCase(),mask:i.mask,statistics:null});return n.updateStatistics(),n}async function W4e(t,e){const i=await j4e(t,e.customOptions),n=new ue({width:i.width,height:i.height,pixels:i.pixels,pixelType:i.pixelType.toLowerCase(),mask:i.mask,statistics:null});return n.updateStatistics(),n}function ece(t,e){const i=e.pixelType||"u8",n=ue.getPixelArrayConstructor(i),r=i==="u8"?t:new n(t.buffer),s=[],o=e.planes||1;if(o===1)s.push(r);else for(let l=0;l<o;l++){const c=(e.width||1)*(e.height||t.length),u=new n(c);for(let d=0;d<c;d++)u[d]=r[d*o+l];s.push(u)}const a=new ue({width:e.width||1,height:e.height||t.length,pixels:s,pixelType:i,statistics:null});return a.updateStatistics(),a}function J4e(t,e){return ece(new hT(new Uint8Array(t)).getBytes(),e)}function Z4e(t,e){return ece(kj(t,e.offset,e.eof,!e.isInputBigEndian),e)}function Y4e(t,e,i){const{pixelTypeCtor:n}=tFe(e.pixelType),r=(0,C4e.decode)(t,{width:e.width,height:e.height,pixelType:n,format:i}),s=new ue({width:e.width,height:e.height,pixels:r.pixels,pixelType:e.pixelType,mask:r.mask,statistics:null});return s.updateStatistics(),s}function X4e(t,e){const i=b4e.decode(t,e.hasNoZlibMask??void 0),n=new ue({width:i.width,height:i.height,pixels:i.pixels,pixelType:"U8",mask:i.mask,statistics:null});return n.updateStatistics(),n}function K4e(t,e){const i=new Uint8Array(t),n=new U4e(i),{width:r,height:s}=e,o=r*s,a=n.decode();let l,c=0,u=0;const d=new Uint8Array(o);for(c=0;c<o;c++)d[c]=a[4*c+3];const f=new ue({width:r,height:s,pixels:[],pixelType:"U8",mask:d,statistics:[]});for(c=0;c<3;c++){for(l=new Uint8Array(o),u=0;u<o;u++)l[u]=a[4*u+c];f.addData({pixels:l})}return f.updateStatistics(),f}async function Q4e(t,e,i,n){const r=new _4e,s={applyJpegMask:!1,format:e,...i},o=await r.decode(t,s,n),a=new ue(o);return a.updateStatistics(),a}function tce(t){if(t==null)throw new V("rasterCodec:decode","parameter encodeddata is required.");const e=new Uint8Array(t,0,10);let i="";return e[0]===255&&e[1]===216?i="jpg":e[0]===137&&e[1]===80&&e[2]===78&&e[3]===71?i="png":e[0]===67&&e[1]===110&&e[2]===116&&e[3]===90&&e[4]===73&&e[5]===109&&e[6]===97&&e[7]===103&&e[8]===101&&e[9]===32?i="lerc":e[0]===76&&e[1]===101&&e[2]===114&&e[3]===99&&e[4]===50&&e[5]===32?i="lerc2":e[0]===73&&e[1]===73&&e[2]===42&&e[3]===0||e[0]===77&&e[1]===77&&e[2]===0&&e[3]===42||e[0]===73&&e[1]===73&&e[2]===43&&e[3]===0||e[0]===77&&e[1]===77&&e[2]===0&&e[3]===43?i="tiff":e[0]===71&&e[1]===73&&e[2]===70?i="gif":e[0]===66&&e[1]===77?i="bmp":String.fromCharCode.apply(null,e).toLowerCase().includes("error")&&(i="error"),i}function eFe(t){let e=null;switch(t){case"lerc":case"lerc2":e=H4e;break;case"jpg":e=X4e;break;case"png":e=K4e;break;case"bsq":case"bip":e=(i,n)=>Y4e(i,n,t);break;case"tiff":e=q4e;break;case"deflate":e=J4e;break;case"lzw":e=Z4e;break;case"error":e=()=>{throw new V("rasterCodec:decode","input data contains error")};break;default:e=()=>{throw new V("rasterCodec:decode","unsupported raster format")}}return e}function tFe(t){let e=null,i=null;switch(t?t.toLowerCase():"f32"){case"u1":case"u2":case"u4":case"u8":i=255,e=Uint8Array;break;case"u16":i=i||65535,e=Uint16Array;break;case"u32":i=i||2**32-1,e=Uint32Array;break;case"s8":i=i||-128,e=Int8Array;break;case"s16":i=i||-32768,e=Int16Array;break;case"s32":i=i||0-2**31,e=Int32Array;break;default:e=Float32Array}return{pixelTypeCtor:e,noDataValue:i}}function iFe(t,e=1){if(!t)return;const{pixels:i,width:n,height:r,mask:s}=t;if(!i||i.length===0)return;const o=i.length,a=n-1,l=r-1,c=[];let u,d,f,m,g,y,_=null;const b=ue.getPixelArrayConstructor(t.pixelType);if(e===0){for(u=0;u<o;u++){for(g=i[u],y=new b(a*l),d=0;d<l;d++)for(m=d*n,f=0;f<a;f++)y[d*a+f]=g[m+f];c.push(y)}if(s!=null)for(_=new Uint8Array(a*l),d=0;d<l;d++)for(m=d*n,f=0;f<a;f++)_[d*a+f]=s[m+f]}else{for(u=0;u<o;u++){for(g=i[u],y=new b(a*l),d=0;d<l;d++)for(m=d*n,f=0;f<a;f++)y[d*a+f]=(g[m+f]+g[m+f+1]+g[m+n+f]+g[m+n+f+1])/4;c.push(y)}if(s)for(_=new Uint8Array(a*l),d=0;d<l;d++)for(m=d*n,f=0;f<a;f++)_[d*a+f]=Math.min.apply(null,[s[m+f],s[m+f+1],s[m+n+f],s[m+n+f+1]])}t.width=a,t.height=l,t.mask=_,t.pixels=c}function nFe(t){let e=tce(t);return e==="lerc2"?e="lerc":e==="error"&&(e=""),e}async function rFe(t,e={},i){if(t==null)throw new V("rasterCodec:decode","missing encodeddata parameter.");let n=e.format&&e.format.toLowerCase();if(!(n!=="bsq"&&n!=="bip"||e.width!=null&&e.height!=null))throw new V("rasterCodec:decode","requires width and height in options parameter.");if(n==="tiff"&&e.customOptions)return W4e(t,e);if((!n||n!=="bsq"&&n!=="bip"&&n!=="deflate"&&n!=="lzw")&&(n=tce(t)),e.useCanvas&&G4e.has(n))return Q4e(t,n,e,i);const r=eFe(n);e.isPoint&&((e={...e}).width!=null&&e.width++,e.height!=null&&e.height++);const s=await r(t,e);return s&&(n!=="jpg"&&e.noDataValue!=null&&s.depthCount===1&&KP(s,e.noDataValue,{customFloatTolerance:e.tolerance}),e.isPoint&&iFe(s),s)}const YH=8,sFe=256;let wo=class extends K$(ie){constructor(){super(...arguments),this.datasetName=null,this.datasetFormat=null,this.hasUniqueSourceStorageInfo=!0,this.rasterInfo=null,this.ioConfig={sampling:"closest"}}async init(){const e=l4();this.addResolvingPromise(e),await this.when()}normalizeCtorArgs(e){return e&&e.ioConfig&&(e={...e,ioConfig:{resolution:null,bandIds:null,sampling:"closest",tileInfo:Mu.create(),...e.ioConfig}}),e}get _isGlobalWrappableSource(){const{rasterInfo:e}=this,i=Lo(e.spatialReference);return i!=null&&e.extent.width>=i/2}get _hasNoneOrGCSShiftTransform(){const{transform:e}=this.rasterInfo;return e==null||e.type==="gcs-shift"}set rasterJobHandler(e){var i,n;this._set("rasterJobHandler",e),this.datasetFormat==="Function"&&((n=(i=this.primaryRasters)==null?void 0:i.rasters)==null||n.forEach(r=>r.rasterJobHandler=e))}set url(e){this._set("url",MV(e,ne.getLogger(this)))}async open(e){throw new V("BaseRaster:open-not-implemented","open() is not implemented")}async fetchTile(e,i,n,r={}){const s=r.tileInfo||this.rasterInfo.storageInfo.tileInfo,o=this.getTileExtentFromTileInfo(e,i,n,s);return this.fetchPixels(o,s.size[0],s.size[1],r)}async identify(e,i={}){var L;e=t0(pe,e).clone().normalize();const{multidimensionalDefinition:n,timeExtent:r}=i,{rasterInfo:s}=this,{hasMultidimensionalTranspose:o,multidimensionalInfo:a}=s;let{transposedVariableName:l}=i;const c=a!=null&&o&&(r!=null||zle(n));c&&!l&&(l=n!=null&&n.length>0?n[0].variableName??void 0:a.variables[0].name,i={...i,transposedVariableName:l}),i=this._getRequestOptionsWithSliceId(i);const{spatialReference:u,extent:d}=s,{datumTransformation:f}=i;let m=YA(e,u,f);if(!d.intersects(m))return{location:m,value:null};if(s.transform!=null){const D=s.transform.inverseTransform(m);if(!s.nativeExtent.intersects(D))return{location:D,value:null};m=D}let g=0;const y=l!=null&&a!=null&&s.hasMultidimensionalTranspose;if(this.datasetFormat==="Function"){const D=this.primaryRasters.rasters[0];if(y)return D.identify(m,i);const{pixelSize:F}=s,z=3,U=F.x*z/2,G=F.y*z/2,W=new Le({xmin:m.x-U,xmax:m.x+U,ymin:m.y-G,ymax:m.y+G,spatialReference:u}),Z={interpolation:"nearest"},{pixelBlock:X}=await D.fetchPixels(W,z,z,Z),{pixelBlock:oe}=await this.fetchPixels(W,z,z,Z);if(X==null)return{location:m,value:null};const se=Math.floor(z*z*.5),le=!X.mask||X.mask[se]?X.pixels.map(we=>we[se]):null;let de;return oe!=null&&(de=!oe.mask||oe.mask[se]?oe.pixels.map(we=>we[se]):void 0),{location:m,value:le,processedValue:de,pyramidLevel:0}}if(!y){if(i.srcResolution)g=c4(i.srcResolution,s,this.ioConfig.sampling).pyramidLevel;else if(g=await this.computeBestPyramidLevelForLocation(e,i),g==null)return{location:m,value:null}}const _=this.identifyPixelLocation(m,g,null,y);if(_===null)return{location:m,value:null};const{row:b,col:w,rowOffset:x,colOffset:S,blockWidth:T}=_,I=l??i.sliceId,C=NH(this.url,I),M=`${g}/${b}/${w}`;let E=FH(C,null,M);E==null&&(E=this.fetchRawTile(g,b,w,i),zH(C,null,M,E));const A=await E;if(A==null||!((L=A.pixels)!=null&&L.length))return{location:m,value:null};const $=x*T+S;return this._processIdentifyResult(A,{srcLocation:m,position:$,pyramidLevel:g,useTransposedTile:!!y,requestSomeSlices:c,identifyOptions:i})}async fetchPixels(e,i,n,r={}){e=m4e(e),r=this._getRequestOptionsWithSliceId(r);const{_hasNoneOrGCSShiftTransform:s}=this;if(r.requestRawData&&s)return this._fetchPixels(e,i,n,r);const o=Lo(e.spatialReference),a=ZM(e);if(o==null||a===0||a===1&&this._isGlobalWrappableSource&&s)return this._fetchPixels(e,i,n,r);if(a>=3)return{extent:e,pixelBlock:null};const l=[],{xmin:c,xmax:u}=e,d=Math.round(o/(u-c)*i),f=d-Math.round((o/2-c)/(u-c)*i);let m=0;const g=[];for(let w=0;w<=a;w++){const x=new Le({xmin:w===0?c:-o/2,xmax:w===a?u-o*w:o/2,ymin:e.ymin,ymax:e.ymax,spatialReference:e.spatialReference}),S=w===0?d-f:w===a?i-m:d;m+=S,g.push(S);const T=r.disableWrapAround&&w>0?null:this._fetchPixels(x,S,n,r);l.push(T)}const y=(await Promise.all(l)).map(w=>w==null?void 0:w.pixelBlock);let _=null;const b={width:i,height:n};return this.rasterJobHandler?_=(await this.rasterJobHandler.mosaicAndTransform({srcPixelBlocks:y,srcMosaicSize:b,destDimension:null,coefs:null,sampleSpacing:null,interpolation:"nearest",alignmentInfo:null,blockWidths:g},r)).pixelBlock:_=qM(y,b,{blockWidths:g}),{extent:e,srcExtent:Sy(e,this.rasterInfo.spatialReference,r.datumTransformation),pixelBlock:_}}async fetchRawPixels(e,i,n,r={}){i={x:Math.floor(i.x),y:Math.floor(i.y)};const s=await this._fetchRawTiles(e,i,n,r),{nativeExtent:o,nativePixelSize:a,storageInfo:l}=this.rasterInfo,c=2**e,u=a.x*c,d=a.y*c,f=new Le({xmin:o.xmin+u*i.x,xmax:o.xmin+u*(i.x+n.width-1),ymin:o.ymax-d*(i.y+n.height-1),ymax:o.ymax-d*i.y,spatialReference:o.spatialReference});if(!s)return{extent:f,srcExtent:f,pixelBlock:null};const{pixelBlocks:m,mosaicSize:g}=s;if(m.length===1&&m[0]!=null&&m[0].width===n.width&&m[0].height===n.height)return{extent:f,srcExtent:f,pixelBlock:s.pixelBlocks[0]};const y=e>0?l.pyramidBlockWidth:l.blockWidth,_=e>0?l.pyramidBlockHeight:l.blockHeight,b={x:i.x%y,y:i.y%_};let w;return this.rasterJobHandler?w=(await this.rasterJobHandler.mosaicAndTransform({srcPixelBlocks:m,srcMosaicSize:g,destDimension:n,clipOffset:b,clipSize:n,coefs:null,sampleSpacing:null,interpolation:r.interpolation,alignmentInfo:null,blockWidths:null},r)).pixelBlock:w=qM(m,g,{clipOffset:b,clipSize:n}),{extent:f,srcExtent:f,pixelBlock:w}}fetchRawTile(e,i,n,r){throw new V("BaseRaster:read-not-implemented","fetchRawTile() is not implemented")}computeExtent(e){return Sy(this.rasterInfo.extent,e)}decodePixelBlock(e,i){return!this.rasterJobHandler||i.useCanvas?rFe(e,i):this.rasterJobHandler.decode({data:e,options:i})}async request(e,i,n=0){const{customFetchParameters:r}=this.ioConfig,{range:s,query:o,headers:a}=i;n=n??i.retryCount??this.ioConfig.retryCount;const l=s?{Range:`bytes=${s.from}-${s.to}`}:null;try{return await gt(e,{...i,query:{...o,...r},headers:{...a,...l}})}catch(c){if(n>0)return n--,this.request(e,i,n);throw c}}getSliceIndex(e){const{multidimensionalInfo:i}=this.rasterInfo;return i==null||e==null||e.length===0?null:n4e(e,i)}getTileExtentFromTileInfo(e,i,n,r){const s=Lr(r.lodAt(e));return this.getTileExtent({x:s.resolution,y:s.resolution},i,n,r.origin,r.spatialReference,r.size)}updateTileInfo(){const{storageInfo:e,spatialReference:i,extent:n,pixelSize:r}=this.rasterInfo;if(!e.tileInfo){const s=[],o=e.maximumPyramidLevel||0;let a=Math.max(r.x,r.y),l=1/.0254*96*a;for(let u=0;u<=o;u++)s.push(new pu({level:o-u,resolution:a,scale:l})),a*=2,l*=2;const c=new pe({x:n.xmin,y:n.ymax,spatialReference:i});e.tileInfo=new Mu({origin:c,size:[e.blockWidth,e.blockHeight],spatialReference:i,lods:s}),e.isVirtualTileInfo=!0}}createRemoteDatasetStorageInfo(e,i=512,n=512,r){const{width:s,height:o,nativeExtent:a,pixelSize:l,spatialReference:c}=e,u=new pe({x:a.xmin,y:a.ymax,spatialReference:c});r==null&&(r=Math.max(0,Math.round(Math.log(Math.max(s,o))/Math.LN2-8)));const d=this.computeBlockBoundary(a,512,512,{x:a.xmin,y:a.ymax},[l],r);e.storageInfo=new t1({blockWidth:i,blockHeight:n,pyramidBlockWidth:i,pyramidBlockHeight:n,origin:u,firstPyramidLevel:1,maximumPyramidLevel:r,blockBoundary:d})}async computeBestPyramidLevelForLocation(e,i={}){return 0}computeBlockBoundary(e,i,n,r,s,o=0,a=2){if(s.length===1&&o>0){s=[...s];let{x:d,y:f}=s[0];for(let m=0;m<o;m++)d*=a,f*=a,s.push({x:d,y:f})}const l=[],{x:c,y:u}=r;for(let d=0;d<s.length;d++){const{x:f,y:m}=s[d];l.push({minCol:Math.floor((e.xmin-c+.1*f)/i/f),maxCol:Math.floor((e.xmax-c-.1*f)/i/f),minRow:Math.floor((u-e.ymax+.1*m)/n/m),maxRow:Math.floor((u-e.ymin-.1*m)/n/m)})}return l}getPyramidPixelSize(e){const{nativePixelSize:i}=this.rasterInfo,{pyramidResolutions:n,pyramidScalingFactor:r}=this.rasterInfo.storageInfo;if(e===0)return i;if(n!=null&&n.length)return n[e-1];const s=r**e;return{x:i.x*s,y:i.y*s}}identifyPixelLocation(e,i,n,r){const{spatialReference:s,nativeExtent:o,storageInfo:a}=this.rasterInfo,{maximumPyramidLevel:l,origin:c,transposeInfo:u}=a,d=r&&u!=null?u.tileSize[0]:a.blockWidth,f=r&&u!=null?u.tileSize[1]:a.blockHeight,m=YA(e,s,n);if(!o.intersects(m)||i<0||i>l)return null;const g=this.getPyramidPixelSize(i),{x:y,y:_}=g,b=(c.y-m.y)/_/f,w=(m.x-c.x)/y/d,x=Math.min(f-1,Math.floor((b-Math.floor(b))*f)),S=Math.min(d-1,Math.floor((w-Math.floor(w))*d));return{pyramidLevel:i,row:Math.floor(b),col:Math.floor(w),rowOffset:x,colOffset:S,blockWidth:d,srcLocation:m}}getTileExtent(e,i,n,r,s,o){const[a,l]=o,c=r.x+n*a*e.x,u=c+a*e.x,d=r.y-i*l*e.y,f=d-l*e.y;return new Le({xmin:c,xmax:u,ymin:f,ymax:d,spatialReference:s})}getBlockWidthHeight(e){return{blockWidth:e>0?this.rasterInfo.storageInfo.pyramidBlockWidth:this.rasterInfo.storageInfo.blockWidth,blockHeight:e>0?this.rasterInfo.storageInfo.pyramidBlockHeight:this.rasterInfo.storageInfo.blockHeight}}isBlockOutside(e,i,n){const r=this.rasterInfo.storageInfo.blockBoundary[e];return!r||r.maxRow<i||r.maxCol<n||r.minRow>i||r.minCol>n}async _fetchPixels(e,i,n,r={}){let s=ZM(e);if(s>=2)return{extent:e,pixelBlock:null};const o=this._getSourceDataInfo(e,i,n,r),{pyramidLevel:a,srcResolution:l,srcExtent:c,srcWidth:u,srcHeight:d,ul:f}=o;if(u===0||d===0)return{extent:e,srcExtent:c,pixelBlock:null};const{rasterInfo:m}=this,g=m.transform,y=(g==null?void 0:g.type)==="gcs-shift",_=Lo(e.spatialReference)!=null;!y&&_||(s=ZM(o.srcExtent,y));const b=await this._fetchRawTiles(a,f,{width:u,height:d,wrapCount:s},r);if(!b)return{extent:e,srcExtent:c,pixelBlock:null};const w=m.storageInfo,x=a>0?w.pyramidBlockWidth:w.blockWidth,S=a>0?w.pyramidBlockHeight:w.blockHeight;let{x:T,y:I}=m.pixelSize;if(a>0){const{pyramidResolutions:we,pyramidScalingFactor:Re}=w;if(we!=null&&we[a-1])({x:T,y:I}=we[a-1]);else{const ze=Re**a;T*=ze,I*=ze}}const C=m.spatialReference,M=new pe({x:T,y:I,spatialReference:C}),E=x===u&&S===d&&f.x%x==0&&f.y%S==0,A=new pe({x:(e.xmax-e.xmin)/i,y:(e.ymax-e.ymin)/n,spatialReference:e.spatialReference}),$=!e.spatialReference.equals(C),L=C.isGeographic?1e-9:1e-4,{datumTransformation:D}=r;if(!$&&E&&b.pixelBlocks.length===1&&x===i&&S===n&&this._isSameResolution(l,A,L))return{extent:e,srcExtent:c,srcTilePixelSize:M,pixelBlock:b.pixelBlocks[0]};const F=_&&Lo(c.spatialReference)!=null&&this._hasNoneOrGCSShiftTransform,z=r.requestProjectedLocalDirections&&this.rasterInfo.dataType.startsWith("vector");z&&!this.rasterJobHandler&&await l4();const U=this.rasterJobHandler?await this.rasterJobHandler.getProjectionOffsetGrid({projectedExtent:e,srcBufferExtent:b.extent,pixelSize:A.toJSON(),datumTransformation:D,rasterTransform:g,hasWrapAround:s>0||F,isAdaptive:this.ioConfig.optimizeProjectionAccuracy!==!1,includeGCSGrid:z},r):f4e({projectedExtent:e,srcBufferExtent:b.extent,pixelSize:A,datumTransformation:D,rasterTransform:g,hasWrapAround:s>0||F,isAdaptive:!1,includeGCSGrid:z});let G;const W=!r.requestRawData,Z={rows:U.spacing[0],cols:U.spacing[1]},X=this._hasNoneOrGCSShiftTransform?this._getRasterTileAlignmentInfo(a,b.extent.xmin):void 0,{pixelBlocks:oe,mosaicSize:se,isPartiallyFilled:le}=b;let de=null;if(this.rasterJobHandler)({pixelBlock:G,localNorthDirections:de}=await this.rasterJobHandler.mosaicAndTransform({srcPixelBlocks:oe,srcMosaicSize:se,destDimension:W?{width:i,height:n}:null,coefs:W?U.coefficients:null,sampleSpacing:W?Z:null,projectDirections:z,gcsGrid:z?U.gcsGrid:null,isUV:this.rasterInfo.dataType==="vector-uv",interpolation:r.interpolation,alignmentInfo:X,blockWidths:null},r));else{const we=qM(oe,se,{alignmentInfo:X});G=W?vle(we,{width:i,height:n},U.coefficients,Z,r.interpolation):we,z&&U.gcsGrid&&(de=XDe({width:i,height:n},U.gcsGrid),G=KDe(G,this.rasterInfo.dataType,de))}return r.requestRawData||z?{extent:e,srcExtent:c,srcTilePixelSize:M,pixelBlock:G,transformGrid:U,localNorthDirections:de,isPartiallyFilled:le}:{extent:e,srcExtent:c,srcTilePixelSize:M,pixelBlock:G}}async _fetchRawTiles(e,i,n,r){const{origin:s,blockBoundary:o}=this.rasterInfo.storageInfo,{blockWidth:a,blockHeight:l}=this.getBlockWidthHeight(e);let{x:c,y:u}=i,{width:d,height:f,wrapCount:m}=n;const g=this._getRasterTileAlignmentInfo(e,0);r.buffer&&(c-=r.buffer.cols,u-=r.buffer.rows,d+=2*r.buffer.cols,f+=2*r.buffer.rows);let y=0,_=0,b=0;m&&g!=null&&({worldColumnCountFromOrigin:_,originColumnOffset:b,rightPadding:y}=g,_*g.blockWidth-y>=c+d&&(y=0));const w=Math.floor(c/a),x=Math.floor(u/l),S=Math.floor((c+d+y-1)/a),T=Math.floor((u+f+y-1)/l),I=o[e];if(!I)return null;const{minRow:C,minCol:M,maxCol:E,maxRow:A}=I;if(m===0&&(T<C||S<M||x>A||w>E))return null;const $=new Array;let L=!1;const D=this.ioConfig.allowPartialFill==null?r.allowPartialFill:this.ioConfig.allowPartialFill;for(let X=x;X<=T;X++)for(let oe=w;oe<=S;oe++){let se=oe;if(!r.disableWrapAround&&m&&g!=null&&_<=oe&&(se=oe-_-b),X>=C&&se>=M&&A>=X&&E>=se){const le=this._fetchRawTile(e,X,se,r);D?$.push(new Promise(de=>{le.then(we=>de(we)).catch(()=>{L=!0,de(null)})})):$.push(le)}else $.push(Promise.resolve(null))}if($.length===0)return null;const F=await Promise.all($),z={height:(T-x+1)*l,width:(S-w+1)*a},{spatialReference:U}=this.rasterInfo,G=this.getPyramidPixelSize(e),{x:W,y:Z}=G;return{extent:new Le({xmin:s.x+w*a*W,xmax:s.x+(S+1)*a*W,ymin:s.y-(T+1)*l*Z,ymax:s.y-x*l*Z,spatialReference:U}),pixelBlocks:F,mosaicSize:z,isPartiallyFilled:L}}_isSameResolution(e,i,n){return Math.abs(e.x-i.x)<n&&Math.abs(e.y-i.y)<n}_fetchRawTile(e,i,n,r){const s=this.rasterInfo.storageInfo.blockBoundary[e];if(!s)return Promise.resolve(null);const{minRow:o,minCol:a,maxCol:l,maxRow:c}=s;if(i<o||n<a||i>c||n>l)return Promise.resolve(null);const u=NH(this.url,r.sliceId),d=`${e}/${i}/${n}`;let f=FH(u,r.registryId,d);if(f==null){const m=new AbortController;f=this.fetchRawTile(e,i,n,{...r,signal:m.signal}),zH(u,r.registryId,d,f,m),f.catch(()=>y4e(u,r.registryId,d))}return r.signal&&Ro(r,()=>{g4e(u,r.registryId,d)}),f}_computeMagDirValues(e){var c;const{bandCount:i,dataType:n}=this.rasterInfo;if(!(i===2&&n==="vector-magdir"||n==="vector-uv")||(e==null?void 0:e.length)!==2||!((c=e[0])!=null&&c.length))return null;const r=e[0].length;if(n==="vector-magdir"){const u=e[1].map(d=>(d+360)%360);return[e[0],u]}const[s,o]=e,a=[],l=[];for(let u=0;u<r;u++){const[d,f]=Mj([s[u],o[u]]);a.push(d),l.push(f)}return[a,l]}_getRasterTileAlignmentInfo(e,i){return this._rasterTileAlighmentInfo==null&&(this._rasterTileAlighmentInfo=d4e(this.rasterInfo)),this._rasterTileAlighmentInfo.pyramidsInfo==null?null:{startX:i,halfWorldWidth:this._rasterTileAlighmentInfo.halfWorldWidth,hasGCSSShiftTransform:this._rasterTileAlighmentInfo.hasGCSSShiftTransform,...this._rasterTileAlighmentInfo.pyramidsInfo[e]}}_getSourceDataInfo(e,i,n,r={}){const s={datumTransformation:r.datumTransformation,pyramidLevel:0,pyramidResolution:null,srcExtent:null,srcHeight:0,srcResolution:null,srcWidth:0,ul:{x:0,y:0}};r.srcResolution&&(s.srcResolution=r.srcResolution,this._updateSourceDataInfo(e,s));const o=this.rasterInfo.storageInfo.maximumPyramidLevel||0,{srcWidth:a,srcHeight:l,pyramidLevel:c}=s,u=a/i,d=l/n,f=c<o&&u*d>=16,m=c===o&&this._requireTooManySrcTiles(a,l,i,n);if(f||m||a===0||l===0){const g=new pe({x:(e.xmax-e.xmin)/i,y:(e.ymax-e.ymin)/n,spatialReference:e.spatialReference});let y=ZA(g,this.rasterInfo.spatialReference,e,s.datumTransformation);const _=!y||r.srcResolution&&y.x+y.y<r.srcResolution.x+r.srcResolution.y;if(f&&r.srcResolution&&_){const b=Math.round(Math.log(Math.max(u,d))/Math.LN2)-1;if(o-c+3>=b){const w=2**b;y={x:r.srcResolution.x*w,y:r.srcResolution.y*w}}}y&&(s.srcResolution=y,this._updateSourceDataInfo(e,s))}return this._requireTooManySrcTiles(s.srcWidth,s.srcHeight,i,n)&&(s.srcWidth=0,s.srcHeight=0),s}_requireTooManySrcTiles(e,i,n,r){const{tileInfo:s}=this.rasterInfo.storageInfo;return Math.ceil(e/s.size[0])*Math.ceil(i/s.size[1])>=sFe||e/n>YH||i/r>YH}_updateSourceDataInfo(e,i){i.srcWidth=0,i.srcHeight=0;const{rasterInfo:n}=this,r=n.spatialReference,{srcResolution:s,datumTransformation:o}=i,{pyramidLevel:a,pyramidResolution:l,excessiveReading:c}=c4(s,n,this.ioConfig.sampling);if(c)return;let u=i.srcExtent||Sy(e,r,o);if(u==null)return;const d=n.transform;d&&(u=d.inverseTransform(u)),i.srcExtent=u;const{x:f,y:m}=n.storageInfo.origin,g=Math.floor((u.xmin-f)/l.x+.1),y=Math.floor((m-u.ymax)/l.y+.1),_=Math.floor((u.xmax-f)/l.x-.1),b=Math.floor((m-u.ymin)/l.y-.1),w=u.width<.1*l.x?0:_-g+1,x=u.height<.1*l.y?0:b-y+1;i.pyramidLevel=a,i.pyramidResolution=l,i.srcWidth=w,i.srcHeight=x,i.ul={x:g,y}}_getRequestOptionsWithSliceId(e){return this.rasterInfo.multidimensionalInfo!=null&&e.sliceId==null&&(e={...e,sliceId:this.getSliceIndex(e.multidimensionalDefinition)}),e}_processIdentifyResult(e,i){const{srcLocation:n,position:r,pyramidLevel:s,useTransposedTile:o}=i,a=e.pixels[0].length/e.width/e.height;if(!(!e.mask||e.mask[r]))return{location:n,value:null};const{multidimensionalInfo:l}=this.rasterInfo;if(l==null||!o){const b=e.pixels.map(S=>S[r]),w={location:n,value:b,pyramidLevel:s},x=this._computeMagDirValues(b.map(S=>[S]));return x!=null&&x.length&&(w.magdirValue=x.map(S=>S[0])),w}let c=e.pixels.map(b=>b.slice(r*a,r*a+a)),u=this._computeMagDirValues(c);const{requestSomeSlices:d,identifyOptions:f}=i;let m=XNe(l,f.transposedVariableName);if(d){const b=KNe(m,f.multidimensionalDefinition,f.timeExtent);c=c.map(w=>b.map(x=>w[x])),u=u==null?void 0:u.map(w=>b.map(x=>w[x])),m=b.map(w=>m[w])}const g=e.noDataValues||this.rasterInfo.noDataValue,y={pixels:c,pixelType:e.pixelType};let _;return g!=null&&(KP(y,g),_=y.mask),{location:n,value:null,dataSeries:m.map((b,w)=>{const x={value:(_==null?void 0:_[w])===0?null:c.map(S=>S[w]),multidimensionalDefinition:b.multidimensionalDefinition.map(S=>new Wy({...S,isSlice:!0}))};return u!=null&&u.length&&(x.magdirValue=[u[0][w],u[1][w]]),x}),pyramidLevel:s}}};h([p()],wo.prototype,"_rasterTileAlighmentInfo",void 0),h([p({readOnly:!0})],wo.prototype,"_isGlobalWrappableSource",null),h([p({readOnly:!0})],wo.prototype,"_hasNoneOrGCSShiftTransform",null),h([p()],wo.prototype,"rasterJobHandler",null),h([p(pj)],wo.prototype,"url",null),h([p({type:String,json:{write:!0}})],wo.prototype,"datasetName",void 0),h([p({type:String,json:{write:!0}})],wo.prototype,"datasetFormat",void 0),h([p()],wo.prototype,"hasUniqueSourceStorageInfo",void 0),h([p()],wo.prototype,"rasterInfo",void 0),h([p()],wo.prototype,"ioConfig",void 0),h([p()],wo.prototype,"sourceJSON",void 0),wo=h([P("esri.layers.support.rasterDatasets.BaseRaster")],wo);const d0=wo;let mg=class extends d0{constructor(){super(...arguments),this.datasetFormat="Function",this.tileType="Raster",this.rasterFunction=null}async open(e){var u,d,f,m;await this.init();const{rasterFunction:i}=this;(d=(u=this.primaryRasters)==null?void 0:u.rasters)!=null&&d.length?i.sourceRasters=this.primaryRasters.rasters:(this.primaryRasters=i.getPrimaryRasters(),this.rasterJobHandler&&((f=this.primaryRasters.rasters)==null||f.forEach(g=>g.rasterJobHandler=this.rasterJobHandler)));const{rasters:n,rasterIds:r}=this.primaryRasters,s=n.map(g=>g.rasterInfo?void 0:g.open(e));await Promise.all(s);const o=n.map(({rasterInfo:g})=>g),a=i.bind({rasterInfos:o,rasterIds:r});if(!a.success||o.length===0)throw new V("raster-function:open",`cannot bind the function: ${a.error??""}`);const l=i.functionName==="Table"?i:(m=i.functionArguments)==null?void 0:m.raster;(l==null?void 0:l.functionName)==="Table"&&(i.rasterInfo.attributeTable=oT.fromJSON(l.functionArguments.attributeTableAsRecordSet)),await this.syncJobHandler();const c=o[0];this.hasUniqueSourceStorageInfo=o.length===1||o.slice(1).every(g=>this._hasSameStorageInfo(g,c)),this.set("sourceJSON",n[0].sourceJSON),this.set("rasterInfo",i.rasterInfo)}async syncJobHandler(){var e;return(e=this.rasterJobHandler)==null?void 0:e.updateRasterFunction(this.rasterFunction)}async fetchPixels(e,i,n,r={}){var x,S;const{rasters:s,rasterIds:o}=this.primaryRasters;let a=!1;const{interpolation:l}=r,c=(x=this.rasterFunction.flatWebGLFunctionChain)==null?void 0:x.hasSurfaceFunction;!r.requestRawData&&l!=="bilinear"&&c&&(a=s.length===1&&!r.skipRasterFunction,r={...r,interpolation:"bilinear",requestRawData:a});const u=s.map(T=>T.fetchPixels(e,i,n,r)),d=await Promise.all(u),f=d.map(T=>T.pixelBlock),m=a||r.requestRawData?d.map(T=>T.srcTilePixelSize):null;if(r.skipRasterFunction||f.every(T=>T==null))return d[0];const g=((S=d.find(T=>T.pixelBlock!=null))==null?void 0:S.extent)??e,y=this.rasterJobHandler?await this.rasterJobHandler.process({extent:g,primaryPixelBlocks:f,primaryPixelSizes:m,primaryRasterIds:o}):this.rasterFunction.process({extent:g,primaryPixelBlocks:f,primaryPixelSizes:m,primaryRasterIds:o}),{transformGrid:_}=d[0];if(!a||y==null||_==null)return{...d[0],pixelBlock:y};const b={rows:_.spacing[0],cols:_.spacing[1]};let w;return this.rasterJobHandler?w=(await this.rasterJobHandler.mosaicAndTransform({srcPixelBlocks:[y],srcMosaicSize:{width:y.width,height:y.height},destDimension:{width:i,height:n},coefs:_.coefficients,sampleSpacing:b,projectDirections:!1,gcsGrid:null,isUV:!1,interpolation:l,alignmentInfo:void 0,blockWidths:null},r)).pixelBlock:w=vle(y,{width:i,height:n},_.coefficients,b,l),{extent:e,srcExtent:d[0].srcExtent,pixelBlock:w}}_hasSameStorageInfo(e,i){const{storageInfo:n,pixelSize:r,spatialReference:s,extent:o}=e,{storageInfo:a,pixelSize:l,spatialReference:c,extent:u}=i;return r.x===l.x&&r.y===l.y&&s.equals(c)&&o.equals(u)&&n.blockHeight===a.blockHeight&&n.blockWidth===a.blockWidth&&n.maximumPyramidLevel===a.maximumPyramidLevel}};h([p({type:String,json:{write:!0}})],mg.prototype,"datasetFormat",void 0),h([p()],mg.prototype,"tileType",void 0),h([p()],mg.prototype,"rasterFunction",void 0),h([p()],mg.prototype,"primaryRasters",void 0),mg=h([P("esri.layers.support.rasterDatasets.FunctionRaster")],mg);const v4=mg;function oFe(t,e){if(t.spatialReference.equals(e))return t;const i=pi(t.spatialReference),n=pi(e);if(i===n)return t;const r=i/n;return{x:t.x*r,y:t.y*r}}async function aFe(t,e,i){if(i.type==="extent")return cFe(t,e,i);const{width:n,height:r}=t,s=new Uint8Array(n*r),{contains:o,intersects:a}=await Y(()=>import("./geometryEngine-4cf0d37c.js"),["./geometryEngine-4cf0d37c.js","./geometryEngineBase-5d80acc4.js","./hydrated-dd8bf351.js"],import.meta.url);return a(e,i)?i.type==="polyline"?uFe(t,e,i):o(i,e)?t:lFe(t,e,i):new ue({pixelType:t.pixelType,width:n,height:r,mask:s,maskIsAlpha:!1,pixels:[...t.pixels]})}function lFe(t,e,i){if(!t)return t;const{width:n,height:r}=t,s=e.width/n,o=e.height/r,{xmin:a,ymax:l}=e;let c;if(i.type==="extent"){const _=(i.xmin-a)/s,b=(i.xmax-a)/s,w=(l-i.ymax)/o,x=(l-i.ymin)/o;c=[[[_,w],[_,x],[b,x],[b,w],[_,w]]]}else c=i.rings.map(_=>_.map(([b,w])=>[(b-a)/s,(l-w)/o]));const u=document.createElement("canvas");u.width=n,u.height=r;const d=u.getContext("2d");d.fillStyle="#f00",c.forEach(_=>{d.beginPath(),d.moveTo(_[0][0],_[0][1]);for(let b=0;b<_.length;b++)d.lineTo(_[b][0],_[b][1]);d.closePath(),d.fill()});const f=d.getImageData(0,0,n,r).data,m=t.mask,g=n*r,y=new Uint8Array(g);for(let _=0;_<g;_++)m&&!m[_]||(y[_]=f[4*_+3]>127?255:0);return new ue({pixelType:t.pixelType,width:n,height:r,mask:y,maskIsAlpha:!1,pixels:[...t.pixels]})}function cFe(t,e,i){const{width:n,height:r}=t,s=new Uint8Array(n*r),o=e.width/n,a=e.height/r;if(i.width/o<.5||i.height/a<.5)return new ue({pixelType:t.pixelType,width:n,height:r,mask:s,pixels:[...t.pixels]});const{xmin:l,xmax:c,ymin:u,ymax:d}=e,{xmin:f,xmax:m,ymin:g,ymax:y}=i,_=Math.max(l,f),b=Math.min(c,m),w=Math.max(u,g),x=Math.min(d,y),S=.5*o,T=.5*a;if(b-_<S||x-w<T||b<l+S||_>c-S||w>d-T||x<u+T)return new ue({pixelType:t.pixelType,width:n,height:r,mask:s,pixels:[...t.pixels]});const I=Math.max(0,(_-l)/o),C=Math.min(n,Math.max(0,(b-l)/o)),M=Math.max(0,(d-x)/a),E=Math.min(r,Math.max(0,(d-w)/a)),A=Math.round(I),$=Math.round(C)-1,L=Math.round(M),D=Math.round(E)-1;if(A===$&&I%1>.5&&C%1<.5||L===D&&M%1>.5&&E%1<.5)return new ue({pixelType:t.pixelType,width:n,height:r,mask:s,pixels:[...t.pixels]});if(A===0&&L===0&&$===n&&D===r)return t;const F=t.mask;for(let z=L;z<=D;z++)for(let U=A;U<=$;U++){const G=z*n+U;s[G]=F?F[G]:255}return new ue({pixelType:t.pixelType,width:n,height:r,mask:s,pixels:[...t.pixels]})}function uFe(t,e,i){const{width:n,height:r}=t,s=new Uint8Array(n*r),o=e.width/n,a=e.height/r,{xmin:l,ymax:c}=e,{paths:u}=i,d=t.mask;for(let f=0;f<u.length;f++){const m=u[f];for(let g=0;g<m.length-1;g++){const[y,_]=m[g],[b,w]=m[g+1];let x=Math.floor((c-_)/a),S=Math.floor((c-w)/a);if(S<x){const I=x;x=S,S=I}x=Math.max(0,x),S=Math.min(r-1,S);const T=(b-y)/(w-_);for(let I=x;I<=S;I++){const C=I===x?Math.max(_,w):(r+1-I)*a,M=I===S?Math.min(_,w):C-a;let E=Math.floor(w===_?(y-l)/o:(T*(C-_)+y-l)/o),A=Math.floor(w===_?(b-l)/o:(T*(M-_)+y-l)/o);if(A<E){const L=E;E=A,A=L}const $=I*n;E=Math.max(0,E),A=Math.min(n-1,A);for(let L=$+E;L<=$+A;L++)s[L]=d?d[L]:255}}}return new ue({pixelType:t.pixelType,width:n,height:r,mask:s,pixels:[...t.pixels]})}function hFe(t,e,i,n=!0){const{spatialReference:r}=t,{x:s,y:o}=oFe(i,r);let a,l,c;const u=e.type==="extent"?e:e.extent;let{xmin:d,xmax:f,ymax:m,ymin:g}=u;const{xmin:y,ymax:_}=t.extent;return n?(d=y+(d>y?s*Math.round((d-y)/s):0),m=_-(m<_?o*Math.round((_-m)/o):0),f=y+(f>y?s*Math.round((f-y)/s):0),g=_-(g<_?o*Math.round((_-g)/o):0),a=new Le({xmin:d,ymax:m,xmax:f,ymin:g,spatialReference:r}),l=Math.round(a.width/s),c=Math.round(a.height/o)):(l=Math.floor((f-d)/s+.8),c=Math.floor((m-g)/o+.8),d=y+(d>y?s*Math.floor((d-y)/s+.1):0),m=_-(m<_?o*Math.floor((_-m)/o+.1):0),f=d+l*s,g=m-c*o,a=new Le({xmin:d,ymax:m,xmax:f,ymin:g,spatialReference:r})),{extent:a,width:l,height:c}}let XM=class extends ie{constructor(){super(...arguments),this.raster=void 0}};h([p({json:{write:!0}})],XM.prototype,"raster",void 0),XM=h([P("esri.layers.support.rasterFunctions.AspectFunctionArguments")],XM);const oo=XM;var _4;let b4=_4=class extends oo{clone(){return new _4({raster:this.raster})}};b4=_4=h([P("esri.layers.support.rasterFunctions.AspectFunctionArguments")],b4);const dFe=b4;var w4;function mm(t){return t=Number(t),isNaN(t)?void 0:t}let Zl=w4=class extends ie{constructor(){super(...arguments),this.name=null,this.minWavelength=void 0,this.maxWavelength=void 0,this.radianceBias=void 0,this.radianceGain=void 0,this.reflectanceBias=void 0,this.reflectanceGain=void 0,this.solarIrradiance=void 0}clone(){return new w4({name:this.name,minWavelength:this.minWavelength,maxWavelength:this.maxWavelength,radianceBias:this.radianceBias,radianceGain:this.radianceGain,reflectanceBias:this.reflectanceBias,reflectanceGain:this.reflectanceGain,solarIrradiance:this.solarIrradiance})}};h([p({json:{name:"BandName",write:!0}})],Zl.prototype,"name",void 0),h([p({json:{name:"WavelengthMin",read:{reader:mm},write:!0}})],Zl.prototype,"minWavelength",void 0),h([p({json:{name:"WavelengthMax",read:{reader:mm},write:!0}})],Zl.prototype,"maxWavelength",void 0),h([p({json:{name:"RadianceBias",read:{reader:mm},write:!0}})],Zl.prototype,"radianceBias",void 0),h([p({json:{name:"RadianceGain",read:{reader:mm},write:!0}})],Zl.prototype,"radianceGain",void 0),h([p({json:{name:"ReflectanceBias",read:{reader:mm},write:!0}})],Zl.prototype,"reflectanceBias",void 0),h([p({json:{name:"ReflectanceGain",read:{reader:mm},write:!0}})],Zl.prototype,"reflectanceGain",void 0),h([p({json:{name:"SolarIrradiance",read:{reader:mm},write:!0}})],Zl.prototype,"solarIrradiance",void 0),Zl=w4=h([P("esri.layers.support.RasterBandInfo")],Zl);const XH=Zl;var x4;function L1(t){return t=Number(t),isNaN(t)?void 0:t}let Qo=x4=class extends ie{constructor(){super(...arguments),this.acquisitionDate=void 0,this.cloudCover=void 0,this.productName=void 0,this.sensorName=null,this.sensorAzimuth=void 0,this.sensorElevation=void 0,this.sunAzimuth=void 0,this.sunElevation=void 0}readAcquisitionDate(t){return new Date(t)}writeAcquisitionDate(t,e){e.AcquisitionDate=t.getTime()}clone(){return new x4({acquisitionDate:this.acquisitionDate,cloudCover:this.cloudCover,productName:this.productName,sensorName:this.sensorName,sensorAzimuth:this.sensorAzimuth,sensorElevation:this.sensorElevation,sunAzimuth:this.sunAzimuth,sunElevation:this.sunElevation})}};h([p({json:{name:"AcquisitionDate",write:!0}})],Qo.prototype,"acquisitionDate",void 0),h([_e("acquisitionDate")],Qo.prototype,"readAcquisitionDate",null),h([ge("acquisitionDate")],Qo.prototype,"writeAcquisitionDate",null),h([p({json:{name:"CloudCover",read:{reader:L1},write:!0}})],Qo.prototype,"cloudCover",void 0),h([p({json:{name:"ProductName",write:!0}})],Qo.prototype,"productName",void 0),h([p({json:{name:"SensorName",write:!0}})],Qo.prototype,"sensorName",void 0),h([p({json:{name:"SensorAzimuth",read:{reader:L1},write:!0}})],Qo.prototype,"sensorAzimuth",void 0),h([p({json:{name:"SensorElevation",read:{reader:L1},write:!0}})],Qo.prototype,"sensorElevation",void 0),h([p({json:{name:"SunAzimuth",read:{reader:L1},write:!0}})],Qo.prototype,"sunAzimuth",void 0),h([p({json:{name:"SunElevation",read:{reader:L1},write:!0}})],Qo.prototype,"sunElevation",void 0),Qo=x4=h([P("esri.layers.support.RasterSensorInfo")],Qo);const pFe=Qo;var S4;let bi=S4=class extends ie{constructor(t){super(t),this.attributeTable=null,this.bandCount=null,this.colormap=null,this.extent=null,this.format=void 0,this.height=null,this.width=null,this.histograms=null,this.keyProperties={},this.multidimensionalInfo=null,this.noDataValue=null,this.pixelSize=null,this.pixelType=null,this.isPseudoSpatialReference=!1,this.spatialReference=null,this.statistics=null,this.storageInfo=null,this.transform=null}get bandInfos(){const t=this.keyProperties.BandProperties;if(!(t!=null&&t.length)){const i=[];for(let n=1;n<=this.bandCount;n++)i.push(new XH({name:"band_"+n}));return i}const e=t.map(i=>XH.fromJSON(i));for(let i=0;i<e.length;i++)e[i].name=e[i].name??"band_"+(i+1);return e}get dataType(){var e,i;const t=((i=(e=this.keyProperties)==null?void 0:e.DataType)==null?void 0:i.toLowerCase())??"generic";return t==="stdtime"?"standard-time":t}get nativeExtent(){return this._get("nativeExtent")||this.extent}set nativeExtent(t){t&&this._set("nativeExtent",t)}get nativePixelSize(){if(this.transform==null||!this.transform.affectsPixelSize)return this.pixelSize;const t=this.nativeExtent;return{x:t.width/this.width,y:t.height/this.height}}get hasMultidimensionalTranspose(){var t;return!!((t=this.storageInfo)!=null&&t.transposeInfo)}get sensorInfo(){var t;if((t=this.keyProperties)!=null&&t.SensorName)return pFe.fromJSON(this.keyProperties)}clone(){return new S4({attributeTable:q(this.attributeTable),bandCount:this.bandCount,colormap:q(this.colormap),extent:q(this.extent),nativePixelSize:q(this.nativePixelSize),format:this.format,height:this.height,width:this.width,histograms:q(this.histograms),keyProperties:q(this.keyProperties),multidimensionalInfo:q(this.multidimensionalInfo),noDataValue:this.noDataValue,pixelSize:q(this.pixelSize),pixelType:this.pixelType,isPseudoSpatialReference:this.isPseudoSpatialReference,spatialReference:q(this.spatialReference),statistics:q(this.statistics),storageInfo:q(this.storageInfo),transform:q(this.transform)})}};h([p({json:{write:!0}})],bi.prototype,"attributeTable",void 0),h([p({json:{write:!0}})],bi.prototype,"bandCount",void 0),h([p({readOnly:!0})],bi.prototype,"bandInfos",null),h([p({json:{write:!0}})],bi.prototype,"colormap",void 0),h([p({type:String,readOnly:!0})],bi.prototype,"dataType",null),h([p({type:Le,json:{write:!0}})],bi.prototype,"extent",void 0),h([p({type:Le,json:{write:!0}})],bi.prototype,"nativeExtent",null),h([p({json:{write:!0}})],bi.prototype,"nativePixelSize",null),h([p({json:{write:!0}})],bi.prototype,"format",void 0),h([p({json:{write:!0}})],bi.prototype,"height",void 0),h([p({json:{write:!0}})],bi.prototype,"width",void 0),h([p({json:{write:!0}})],bi.prototype,"hasMultidimensionalTranspose",null),h([p({json:{write:!0}})],bi.prototype,"histograms",void 0),h([p({json:{write:!0}})],bi.prototype,"keyProperties",void 0),h([p({json:{write:!0}})],bi.prototype,"multidimensionalInfo",void 0),h([p({json:{write:!0}})],bi.prototype,"noDataValue",void 0),h([p({json:{write:!0}})],bi.prototype,"pixelSize",void 0),h([p({json:{write:!0}})],bi.prototype,"pixelType",void 0),h([p()],bi.prototype,"isPseudoSpatialReference",void 0),h([p({readOnly:!0})],bi.prototype,"sensorInfo",null),h([p({type:Ee,json:{write:!0}})],bi.prototype,"spatialReference",void 0),h([p({json:{write:!0}})],bi.prototype,"statistics",void 0),h([p({type:t1,json:{write:!0}})],bi.prototype,"storageInfo",void 0),h([p({json:{write:!0}})],bi.prototype,"transform",void 0),bi=S4=h([P("esri.layers.support.RasterInfo")],bi);const yd=bi,fFe=new Set(["slope","aspect","curvature","hillshade","shadedrelief"]);let kn=class extends ie{constructor(){super(...arguments),this.functionArguments=null,this.readingBufferSize=0,this.id=-1,this.isNoopProcess=!1,this.rawInputBandIds=[],this.isInputBandIdsSwizzled=!1,this.swizzledBandSelection=[],this.isBranch=!1,this._bindingResult=null}get supportsGPU(){return this._bindingResult.supportsGPU}get flatWebGLFunctionChain(){const e=this.getWebGLProcessorDefinition();if(!e)return null;const i=[e],{parameters:n}=e;let r=n.rasters||n.raster&&[n.raster];for(;r!=null&&r.length;){i.unshift(...r);const a=[];for(let l=0;l<r.length;l++){const{parameters:c}=r[l],u=c.rasters||c.raster&&[c.raster];u!=null&&u.length&&a.push(...u)}r=a}for(let a=i.length-1;a>=0;a--)i[a].isNoopProcess&&i.splice(a,1);let s=!1;for(let a=0;a<i.length;a++){const l=i[a];l.id=i.length-a-1;const{rasters:c}=l.parameters;s=s||c!=null&&c.length>1}const o=i.some(({name:a})=>fFe.has(a.toLowerCase()));return{functions:i,hasBranches:s,hasSurfaceFunction:o}}bind(e,i=!1,n=-1){this.id=n+1;const r=this._getRasterValues();let s=!0;for(let o=0;o<r.length;o++){const a=r[o];if(a!=null&&this._isRasterFunctionValue(a)){const l=a.bind(e,i,this.id+o);if(!l.success)return this._bindingResult=l,l;s=s&&l.supportsGPU}}return!this.rasterInfo||i?(this.sourceRasterInfos=this._getSourceRasterInfos(e),this._bindingResult=this._bindSourceRasters(),this._bindingResult.success&&this._patchRasterInfo(),this._bindingResult.supportsGPU=s&&this._bindingResult.supportsGPU,this.processInputBandIds(),this._bindingResult):(this._bindingResult={success:!0,supportsGPU:!0},this.processInputBandIds(),this._bindingResult)}process(e){const i=this._getRasterValues(),n=i.length===0?e.pixelBlocks??e.primaryPixelBlocks:i.map(r=>this._readRasterValue(r,e));return this._processPixels({...e,pixelBlocks:n})}processInputBandIds(){const e=this._getRasterValues().filter(this._isRasterFunctionValue);let i;if(e.length>1){const s=e.map(a=>a.processInputBandIds()[0]);this.rawInputBandIds=s,this.isInputBandIdsSwizzled=this.rawInputBandIds.some((a,l)=>a!==l);const o=e.filter(a=>a.functionName==="ExtractBand");return o.length&&o.forEach((a,l)=>{a.isInputBandIdsSwizzled=!0,a.swizzledBandSelection=[l,l,l]}),this.rawInputBandIds}const n=e[0];if(n){if(i=n.processInputBandIds(),n.isInputBandIdsSwizzled)return this.rawInputBandIds=i,i}else{i=[];const{bandCount:s}=this.sourceRasterInfos[0];for(let o=0;o<s;o++)i.push(o)}const r=this._getInputBandIds(i);return this.isInputBandIdsSwizzled=r.some((s,o)=>s!==o),this.rawInputBandIds=r,this.rawInputBandIds}getPrimaryRasters(){const e=[],i=[];return this._getPrimaryRasters(this,e,i),{rasters:e,rasterIds:i}}getWebGLProcessorDefinition(){const e=this._getWebGLParameters(),{raster:i,rasters:n}=this.functionArguments;return n&&Array.isArray(n)&&n.length?(e.rasters=n.map(r=>this._isRasterFunctionValue(r)?r.getWebGLProcessorDefinition():typeof r=="number"?{name:"Constant",parameters:{value:r},pixelType:"f32",id:-1,isNoopProcess:!1}:{name:"Identity",parameters:{value:r},pixelType:"f32",id:-1,isNoopProcess:!1}),e.rasters.some(r=>r!=null)||(e.rasters=null)):this._isRasterFunctionValue(i)&&(e.raster=i.getWebGLProcessorDefinition()),{name:this.functionName,parameters:e,pixelType:this.outputPixelType,id:this.id,isNoopProcess:this.isNoopProcess}}_getOutputPixelType(e){return this.outputPixelType==="unknown"?e:this.outputPixelType??e}_getWebGLParameters(){return{}}_getInputBandIds(e){return e}_isOutputRoundingNeeded(){const{outputPixelType:e}=this;return((e==null?void 0:e.startsWith("u"))||(e==null?void 0:e.startsWith("s")))??!1}_getRasterValues(){const{rasterArgumentNames:e}=this;return e[0]==="rasters"?this.functionArguments.rasters??[]:e.map(i=>this.functionArguments[i]).flat()}_getSourceRasterInfos(e){const i=this._getRasterValues(),{rasterInfos:n,rasterIds:r}=e;if(i.length===0)return n;const s=i.map(a=>a&&typeof a=="object"&&"bind"in a&&a.rasterInfo?a.rasterInfo:typeof a=="string"&&r.includes(a)?n[r.indexOf(a)]:typeof a!="number"?n[0]:void 0),o=s.find(a=>a)??n[0];return s.forEach((a,l)=>{a===void 0&&(s[l]=o)}),s}_getPrimaryRasterId(e){return e==null?void 0:e.url}_getPrimaryRasters(e,i=[],n=[]){for(let r=0;r<e.sourceRasters.length;r++){const s=e.sourceRasters[r];if(typeof s!="number")if("bind"in s)this._getPrimaryRasters(s,i,n);else{const o=s,a=this._getPrimaryRasterId(o);if(a==null)continue;n.includes(a)||(this.mainPrimaryRasterId===a?(i.unshift(o),n.unshift(a)):(i.push(o),n.push(a)))}}}_isRasterFunctionValue(e){return e!=null&&typeof e=="object"&&"getWebGLProcessorDefinition"in e}_readRasterValue(e,i){const{primaryPixelBlocks:n}=i;if(e==null||e==="$$"){const r=n[0];return r==null?null:r.clone()}if(typeof e=="string"){const r=i.primaryRasterIds.indexOf(e);return r===-1?null:n[r]}if(typeof e=="number"){const r=n[0];if(r==null)return null;const{width:s,height:o,pixelType:a,mask:l}=r,c=l?new Uint8Array(l):null,u=new Float32Array(s*o);u.fill(e);const d=this.sourceRasterInfos[0].bandCount,f=new Array(d).fill(u);return new ue({width:s,height:o,pixelType:a,pixels:f,mask:c})}return e.process(i)}_patchRasterInfo(){const{rasterInfo:e}=this;if(!(e!=null&&e.keyProperties))return;const{bandCount:i,keyProperties:n,statistics:r,histograms:s}=e,o=n.BandProperties;o&&o.length!==i&&(e.keyProperties={...n,BandProperties:void 0}),r&&r.length!==i&&(e.statistics=r.length>i?r.slice(0,i):null),s&&s.length!==i&&(e.histograms=s.length>i?s.slice(0,i):null),n.BAND_COUNT&&Number(n.BAND_COUNT)!==i&&(e.keyProperties={...n,BAND_COUNT:typeof n.BAND_COUNT=="string"?String(i):i})}};h([p({json:{write:!0}})],kn.prototype,"functionName",void 0),h([p({json:{write:!0}})],kn.prototype,"functionArguments",void 0),h([p()],kn.prototype,"rasterArgumentNames",void 0),h([p({json:{write:!0}}),ut(t=>t==null?void 0:t.toLowerCase())],kn.prototype,"outputPixelType",void 0),h([p({json:{write:!0}})],kn.prototype,"mainPrimaryRasterId",void 0),h([p()],kn.prototype,"sourceRasters",void 0),h([p({type:[yd],json:{write:!0}})],kn.prototype,"sourceRasterInfos",void 0),h([p({json:{write:!0}})],kn.prototype,"rasterInfo",void 0),h([p({json:{write:!0}})],kn.prototype,"readingBufferSize",void 0),h([p({json:{write:!0}})],kn.prototype,"id",void 0),h([p()],kn.prototype,"isNoopProcess",void 0),h([p()],kn.prototype,"supportsGPU",null),h([p()],kn.prototype,"rawInputBandIds",void 0),h([p()],kn.prototype,"isInputBandIdsSwizzled",void 0),h([p()],kn.prototype,"swizzledBandSelection",void 0),h([p()],kn.prototype,"isBranch",void 0),h([p()],kn.prototype,"flatWebGLFunctionChain",null),h([p()],kn.prototype,"_bindingResult",void 0),kn=h([P("esri.layers.support.rasterFunctions.BaseRasterFunction")],kn);const ao=kn,$s=1,Nh=1/111e3;function ice(t){let{altitude:e,azimuth:i}=t;const{hillshadeType:n,pixelSizePower:r=1,pixelSizeFactor:s=1,scalingType:o,isGCS:a,resolution:l}=t,c=n==="multi-directional"?2*t.zFactor:t.zFactor,{x:u,y:d}=l;let f=c/(8*u),m=c/(8*d);if(a&&c>.001&&(f/=Nh,m/=Nh),o==="adjusted")if(a){const L=u*Nh,D=d*Nh;f=(c+L**r*s)/(8*L),m=(c+D**r*s)/(8*D)}else f=(c+u**r*s)/(8*u),m=(c+d**r*s)/(8*d);let g=(90-e)*Math.PI/180,y=Math.cos(g),_=(360-i+90)*Math.PI/180,b=Math.sin(g)*Math.cos(_),w=Math.sin(g)*Math.sin(_);const x=[315,270,225,360,180,0],S=[60,60,60,60,60,90],T=new Float32Array([3,5,3,2,1,4]),I=T.reduce((L,D)=>L+D),C=T.map(L=>L/I),M=n==="multi-directional"?x.length:1,E=new Float32Array(6),A=new Float32Array(6),$=new Float32Array(6);if(n==="multi-directional")for(let L=0;L<M;L++)e=S[L],i=x[L],g=(90-e)*Math.PI/180,y=Math.cos(g),_=(360-i+90)*Math.PI/180,b=Math.sin(g)*Math.cos(_),w=Math.sin(g)*Math.sin(_),E[L]=y,A[L]=b,$[L]=w;else E.fill(y),A.fill(b),$.fill(w);return{resolution:l,factor:[f,m],sinZcosA:b,sinZsinA:w,cosZ:y,sinZcosAs:A,sinZsinAs:$,cosZs:E,weights:C,hillshadeType:["traditional","multi-directional"].indexOf(n)}}function rk(t,e){const{width:i,height:n}=t,r=i*n,s=new Uint8Array(r),o=t.mask!=null;let a;if(o){a=new Uint8Array(t.mask);for(let I=0;I<a.length;I++)a[I]&&(s[I]=1,a[I]=1)}const l=t.pixels[0],c=new Float32Array(r),u=new Float32Array(r);let d,f=0;if(e){const{resolution:I}=e,C=I?(I.x+I.y)/2:1;f=200*e.zFactor/(C*C),d=new Float32Array(r)}const m=e==null?void 0:e.curvatureType;let g,y,_,b,w,x,S,T;for(let I=$s;I<n-$s;I++){const C=I*i;for(let M=$s;M<i-$s;M++){const E=C+M;if(!a||a[E]!==0){if(a){if(a[E-i-1]+a[E-i]+a[E-i+1]+a[E-1]+a[E+1]+a[E+i-1]+a[E+i]+a[E+i+1]<7){s[E]=0;continue}g=a[E-i-1]?l[E-i-1]:l[E],y=a[E-i]?l[E-i]:l[E],_=a[E-i+1]?l[E-i+1]:l[E],b=a[E-1]?l[E-1]:l[E],w=a[E+1]?l[E+1]:l[E],x=a[E+i-1]?l[E+i-1]:l[E],S=a[E+i]?l[E+i]:l[E],T=a[E+i+1]?l[E+i+1]:l[E]}else g=l[E-i-1],y=l[E-i],_=l[E-i+1],b=l[E-1],w=l[E+1],x=l[E+i-1],S=l[E+i],T=l[E+i+1];if(c[E]=_+w+w+T-(g+b+b+x),u[E]=x+S+S+T-(g+y+y+_),d!=null){const A=l[E],$=.5*(b+w)-A,L=.5*(y+S)-A;if(m==="standard")d[E]=-f*($+L);else{const D=(-g+_+x-T)/4,F=(-b+w)/2,z=(y-S)/2,U=F*F,G=z*z,W=U+G;W&&(d[E]=m==="profile"?f*($*U+L*G+D*F*z)/W:-f*($*G+L*U-D*F*z)/W)}}}}}return{outMask:o?s:null,dzxs:c,dzys:u,curvatures:d}}function sk(t,e,i){for(let n=0;n<i;n++)t[n*e]=t[n*e+1],t[(n+1)*e-1]=t[(n+1)*e-2];for(let n=1;n<e-1;n++)t[n]=t[n+e],t[n+(i-1)*e]=t[n+(i-2)*e]}function mFe(t,e){if(!Ci(t))return t;const{factor:i,sinZcosA:n,sinZsinA:r,cosZ:s,sinZcosAs:o,sinZsinAs:a,cosZs:l,weights:c}=ice(e),[u,d]=i,f=e.hillshadeType==="traditional",{width:m,height:g}=t,y=new Uint8Array(m*g),{dzxs:_,dzys:b,outMask:w}=rk(t);for(let x=$s;x<g-$s;x++){const S=x*m;for(let T=$s;T<m-$s;T++){const I=S+T;if(!w||w[I]){const C=_[I]*u,M=b[I]*d,E=Math.sqrt(1+C*C+M*M);let A=0;if(f){let $=255*(s+r*M-n*C)/E;$<0&&($=0),A=$}else{const $=a.length;for(let L=0;L<$;L++){let D=255*(l[L]+a[L]*M-o[L]*C)/E;D<0&&(D=0),A+=D*c[L]}}y[I]=255&A}}}return sk(y,m,g),new ue({width:m,height:g,pixels:[y],mask:w,pixelType:"u8",validPixelCount:t.validPixelCount,statistics:[{minValue:0,maxValue:255}]})}function gFe(t,e,i,n){if(!Ci(t)||!Ci(e))return;const{min:r,max:s}=n,o=t.pixels[0],{pixels:a,mask:l}=e,c=a[0],u=255.00001/(s-r),d=new Uint8ClampedArray(c.length),f=new Uint8ClampedArray(c.length),m=new Uint8ClampedArray(c.length),g=i.length-1;for(let y=0;y<c.length;y++){if(l&&l[y]===0)continue;const _=Math.floor((c[y]-r)*u),[b,w]=i[_<0?0:_>g?g:_],x=o[y],S=x*w,T=S*(1-Math.abs(b%2-1)),I=x-S;switch(Math.floor(b)){case 0:d[y]=S+I,f[y]=T+I,m[y]=I;break;case 1:d[y]=T+I,f[y]=S+I,m[y]=I;break;case 2:d[y]=I,f[y]=S+I,m[y]=T+I;break;case 3:d[y]=I,f[y]=T+I,m[y]=S+I;break;case 4:d[y]=T+I,f[y]=I,m[y]=S+I;break;case 5:case 6:d[y]=S+I,f[y]=I,m[y]=T+I}}t.pixels=[d,f,m],t.updateStatistics()}function yFe(t,e){if(!Ci(t))return t;const i=e.zFactor,n=e.pixelSizePower??1,r=e.pixelSizeFactor??1,s=e.slopeType,o=e.isGCS,{x:a,y:l}=e.resolution;let c=i/(8*a),u=i/(8*l);o&&Math.abs(i-1)<1e-4&&(c/=Nh,u/=Nh),s==="adjusted"&&(c=(i+a**n*r)/(8*a),u=(i+l**n*r)/(8*l));const{dzxs:d,dzys:f,outMask:m}=rk(t),{width:g,height:y}=t,_=new Float32Array(g*y);for(let w=$s;w<y-$s;w++){const x=w*g;for(let S=$s;S<g-$s;S++){const T=x+S;if(!m||m[T]){const I=d[T]*c,C=f[T]*u,M=Math.sqrt(I*I+C*C);_[x+S]=s==="percent-rise"?100*M:57.2957795*Math.atan(M)}}}sk(_,g,y);const b=new ue({width:g,height:y,pixels:[_],mask:m,pixelType:"f32",validPixelCount:t.validPixelCount});return b.updateStatistics(),b}function vFe(t,e={}){if(!Ci(t))return t;const{resolution:i}=e,n=i?1/i.x:1,r=i?1/i.y:1,{dzxs:s,dzys:o,outMask:a}=rk(t),{width:l,height:c}=t,u=new Float32Array(l*c);for(let d=$s;d<c-$s;d++){const f=d*l;for(let m=$s;m<l-$s;m++){const g=f+m;if(!a||a[g]){const y=s[g]*n,_=o[g]*r;let b=-1;y===0&&_===0||(b=90-57.29578*Math.atan2(_,-y),b<0&&(b+=360),b===360?b=0:b>360&&(b%=360)),u[f+m]=b}}}return sk(u,l,c),new ue({width:l,height:c,pixels:[u],mask:a,pixelType:"f32",validPixelCount:t.validPixelCount,statistics:[{minValue:-1,maxValue:360}]})}function _Fe(t,e){if(!Ci(t))return t;const{curvatures:i,outMask:n}=rk(t,e),{width:r,height:s}=t;sk(i,r,s);const o=new ue({width:r,height:s,pixels:[i],mask:n,pixelType:"f32",validPixelCount:t.validPixelCount});return o.updateStatistics(),o}let gg=class extends ao{constructor(){super(...arguments),this.functionName="Aspect",this.functionArguments=null,this.rasterArgumentNames=["raster"],this.isGCS=!1}_bindSourceRasters(){var n;const e=this.sourceRasterInfos[0];this.isGCS=((n=e.spatialReference)==null?void 0:n.isGeographic)??!1,this.outputPixelType=this._getOutputPixelType("f32");const i=e.clone();return i.pixelType=this.outputPixelType,i.statistics=[{min:-1,max:360,avg:180,stddev:30}],i.histograms=null,i.colormap=null,i.attributeTable=null,i.bandCount=1,this.rasterInfo=i,{success:!0,supportsGPU:!0}}_processPixels(e){var a;const i=(a=e.pixelBlocks)==null?void 0:a[0];if(i==null)return null;const{extent:n,primaryPixelSizes:r}=e,s=r==null?void 0:r[0],o=s??(n?{x:n.width/i.width,y:n.height/i.height}:{x:1,y:1});return vFe(i,{resolution:o})}};h([p({json:{write:!0,name:"rasterFunction"}})],gg.prototype,"functionName",void 0),h([p({type:dFe,json:{write:!0,name:"rasterFunctionArguments"}})],gg.prototype,"functionArguments",void 0),h([p()],gg.prototype,"rasterArgumentNames",void 0),h([p({json:{write:!0}})],gg.prototype,"isGCS",void 0),gg=h([P("esri.layers.support.rasterFunctions.AspectFunction")],gg);const bFe=gg,wFe=new Set(["+","-","*","/","(",")"]);function xFe(t,e){(t=t.replaceAll(" ","")).startsWith("-")&&(t="0"+t),t.startsWith("+")&&(t=t.slice(1,t.length));const i=t.split(""),n=[],r=[];let s="";for(let o=0;o<i.length;o++){const a=i[o];if(wFe.has(a))s!==""&&r.push(parseFloat(s)),n.push(a),s="";else{if(a.toLowerCase()==="b"){o++,s=a.concat(i[o]),r.push(e[parseInt(s[1],10)-1]),s="";continue}s=s.concat(a),o===i.length-1&&r.push(parseFloat(s))}}return{ops:n,nums:r}}function SFe(t,e,i,n){if(typeof i=="number"&&typeof n=="number")return i+n;let r,s,o;typeof i=="number"?(o=n,r=o.length,s=new Float32Array(r),s.fill(i)):(r=i.length,s=i,n.constructor===Number?(o=new Float32Array(r),o.fill(n)):o=n);const a=new Float32Array(r);switch(e){case"+":for(let l=0;l<r;l++)(t==null||t[l])&&(a[l]=s[l]+o[l]);break;case"-":for(let l=0;l<r;l++)(t==null||t[l])&&(a[l]=s[l]-o[l]);break;case"*":for(let l=0;l<r;l++)(t==null||t[l])&&(a[l]=s[l]*o[l]);break;case"/":for(let l=0;l<r;l++)(t==null||t[l])&&o[l]&&(a[l]=s[l]/o[l]);break;case"(":case")":throw new Error("encountered error with custom band index equation")}return a}function TFe(t,e){t.splice(e,1);let i=0,n=0;do{i=0,n=0;for(let r=0;r<t.length;r++)if(t[r]==="(")i=r;else if(t[r]===")"){n=r;break}n===i+1&&t.splice(i,2)}while(n===i+1);return t}function IFe(t){if(t.length===1)return{opIndex:0,numIndex:0};let e=0,i=0;for(let o=0;o<t.length;o++)if(t[o]==="(")e=o;else if(t[o]===")"){i=o;break}const n=i===0?t:t.slice(e+1,i);let r=-1;for(let o=0;o<n.length;o++)if(n[o]==="*"||n[o]==="/"){r=o;break}if(r>-1)i>0&&(r+=e+1);else{for(let o=0;o<n.length;o++)if(n[o]==="+"||n[o]==="-"){r=o;break}i>0&&(r+=e+1)}let s=0;for(let o=0;o<r;o++)t[o]==="("&&s++;return{opIndex:r,numIndex:r-s}}function CFe(t,e,i){let n,{ops:r,nums:s}=xFe(i,e);if(r.length===0){const o=s.length===1?s[0]:e[0];if(o instanceof Float32Array)return[o];const a=new Float32Array(e[0].length);return typeof o=="number"?a.fill(o):a.set(o),[a]}for(;r.length>0;){const{numIndex:o,opIndex:a}=IFe(r);if(n=SFe(t,r[a],s[o],s[o+1]),r.length===1)break;r=TFe(r,a),s.splice(o,2,n)}return[n]}const MFe=new qe({0:"custom",1:"ndvi",2:"savi",3:"tsavi",4:"msavi",5:"gemi",6:"pvi",7:"gvitm",8:"sultan",9:"vari",10:"gndvi",11:"sr",12:"ndvi-re",13:"sr-re",14:"mtvi2",15:"rtvi-core",16:"ci-re",17:"ci-g",18:"ndwi",19:"evi",20:"iron-oxide",21:"ferrous-minerals",22:"clay-minerals",23:"wndwi",24:"bai",25:"nbr",26:"ndbi",27:"ndmi",28:"ndsi",29:"mndwi"},{useNumericKeys:!0});function EFe(t,e){if(!Ci(t))return t;const{equation:i,method:n}=e,r=e.bandIndexes.map(u=>u-1),{pixels:s,mask:o}=t;let a;switch(n){case"gndvi":case"nbr":case"ndbi":case"ndvi":case"ndvi-re":case"ndsi":case"ndmi":case"mndwi":a=KH(o,s[r[0]],s[r[1]]);break;case"ndwi":a=KH(o,s[r[1]],s[r[0]]);break;case"sr":case"sr-re":case"iron-oxide":case"ferrous-minerals":case"clay-minerals":a=$Fe(o,s[r[0]],s[r[1]]);break;case"ci-g":case"ci-re":a=PFe(o,s[r[0]],s[r[1]]);break;case"savi":a=kFe(o,s[r[0]],s[r[1]],r[2]+1);break;case"tsavi":a=OFe(o,s[r[0]],s[r[1]],r[2]+1,r[3]+1,r[4]+1);break;case"msavi":a=LFe(o,s[r[0]],s[r[1]]);break;case"gemi":a=RFe(o,s[r[0]],s[r[1]]);break;case"pvi":a=DFe(o,s[r[0]],s[r[1]],r[2]+1,r[3]+1);break;case"gvitm":a=NFe(o,[s[r[0]],s[r[1]],s[r[2]],s[r[3]],s[r[4]],s[r[5]]]);break;case"sultan":a=FFe(o,[s[r[0]],s[r[1]],s[r[2]],s[r[3]],s[r[4]],s[r[5]]]);break;case"vari":a=zFe(o,[s[r[0]],s[r[1]],s[r[2]]]);break;case"mtvi2":a=VFe(o,[s[r[0]],s[r[1]],s[r[2]]]);break;case"rtvi-core":a=jFe(o,[s[r[0]],s[r[1]],s[r[2]]]);break;case"evi":a=BFe(o,[s[r[0]],s[r[1]],s[r[2]]]);break;case"wndwi":a=UFe(o,[s[r[0]],s[r[1]],s[r[2]]],r[3]?r[3]+1:.5);break;case"bai":a=GFe(o,s[r[0]],s[r[1]]);break;case"custom":a=CFe(o,s,i);break;default:return t}const l=o!=null?new Uint8Array(o.length):null;o!=null&&l!=null&&l.set(o);const c=new ue({width:t.width,height:t.height,pixelType:"f32",pixels:a,mask:l});return c.updateStatistics(),c}function AFe(t,e,i,n){const{mask:r,pixels:s,width:o,height:a}=t,l=s[i],c=s[e],u=c.length,d=n?new Uint8Array(u):new Float32Array(u),f=n?100:1,m=n?100.5:0;for(let y=0;y<u;y++)if(r==null||r[y]){const _=l[y],b=c[y],w=_+b;w&&(d[y]=(_-b)/w*f+m)}const g=new ue({width:o,height:a,mask:r,pixelType:n?"u8":"f32",pixels:[d]});return g.updateStatistics(),g}function Pr(t){const e=new Float32Array(9);return e[3*t[0]]=1,e[3*t[1]+1]=1,e[3*t[2]+2]=1,e}function KH(t,e,i){const n=i.length,r=new Float32Array(n);for(let s=0;s<n;s++)if(t==null||t[s]){const o=e[s],a=i[s],l=o+a;l&&(r[s]=(o-a)/l)}return[r]}function $Fe(t,e,i){const n=i.length,r=new Float32Array(n);for(let s=0;s<n;s++)if(t==null||t[s]){const o=e[s],a=i[s];a&&(r[s]=o/a)}return[r]}function PFe(t,e,i){const n=e.length,r=new Float32Array(n);for(let s=0;s<n;s++)if(t==null||t[s]){const o=e[s],a=i[s];a&&(r[s]=o/a-1)}return[r]}function kFe(t,e,i,n){const r=i.length,s=new Float32Array(r);for(let o=0;o<r;o++)if(t==null||t[o]){const a=i[o],l=e[o],c=l+a+n;c&&(s[o]=(l-a)/c*(1+n))}return[s]}function OFe(t,e,i,n,r,s){const o=i.length,a=new Float32Array(o),l=-r*n+s*(1+n*n);for(let c=0;c<o;c++)if(t==null||t[c]){const u=i[c],d=e[c],f=r*d+u+l;f&&(a[c]=n*(d-n*u-r)/f)}return[a]}function LFe(t,e,i){const n=i.length,r=new Float32Array(n);for(let s=0;s<n;s++)if(t==null||t[s]){const o=i[s],a=e[s];r[s]=.5*(2*(a+1)-Math.sqrt((2*a+1)**2-8*(a-o)))}return[r]}function RFe(t,e,i){const n=i.length,r=new Float32Array(n);for(let s=0;s<n;s++)if(t==null||t[s]){const o=i[s],a=e[s];if(o!==1){const l=(2*(a*a-o*o)+1.5*a+.5*o)/(a+o+.5);r[s]=l*(1-.25*l)-(o-.125)/(1-o)}}return[r]}function DFe(t,e,i,n,r){const s=i.length,o=new Float32Array(s),a=Math.sqrt(1+n*n);for(let l=0;l<s;l++)if(t==null||t[l]){const c=i[l],u=e[l];o[l]=(u-n*c-r)/a}return[o]}function NFe(t,e){const[i,n,r,s,o,a]=e,l=i.length,c=new Float32Array(l);for(let u=0;u<l;u++)(t==null||t[u])&&(c[u]=-.2848*i[u]-.2435*n[u]-.5436*r[u]+.7243*s[u]+.084*o[u]-1.18*a[u]);return[c]}function FFe(t,e){const[i,,n,r,s,o]=e,a=i.length,l=new Float32Array(a),c=new Float32Array(a),u=new Float32Array(a);for(let d=0;d<a;d++)(t==null||t[d])&&(l[d]=o[d]?s[d]/o[d]*100:0,c[d]=i[d]?s[d]/i[d]*100:0,u[d]=r[d]?n[d]/r[d]*(s[d]/r[d])*100:0);return[l,c,u]}function zFe(t,e){const[i,n,r]=e,s=i.length,o=new Float32Array(s);for(let a=0;a<s;a++)if(t==null||t[a])for(a=0;a<s;a++){const l=i[a],c=n[a],u=c+l-r[a];u&&(o[a]=(c-l)/u)}return[o]}function VFe(t,e){const[i,n,r]=e,s=i.length,o=new Float32Array(s);for(let a=0;a<s;a++)if(t==null||t[a])for(a=0;a<s;a++){const l=i[a],c=n[a],u=r[a],d=Math.sqrt((2*l+1)**2-6*l-5*Math.sqrt(c)-.5);o[a]=1.5*(1.2*(l-u)-2.5*(c-u))*d}return[o]}function jFe(t,e){const[i,n,r]=e,s=i.length,o=new Float32Array(s);for(let a=0;a<s;a++)if(t==null||t[a])for(a=0;a<s;a++){const l=i[a],c=n[a],u=r[a];o[a]=100*(l-c)-10*(l-u)}return[o]}function BFe(t,e){const[i,n,r]=e,s=i.length,o=new Float32Array(s);for(let a=0;a<s;a++)if(t==null||t[a])for(a=0;a<s;a++){const l=i[a],c=n[a],u=l+6*c-7.5*r[a]+1;u&&(o[a]=2.5*(l-c)/u)}return[o]}function UFe(t,e,i=.5){const[n,r,s]=e,o=r.length,a=new Float32Array(o);for(let l=0;l<o;l++)if(t==null||t[l])for(l=0;l<o;l++){const c=n[l],u=r[l],d=s[l],f=c+i*u+(1-i)*d;f&&(a[l]=(c-i*u-(1-i)*d)/f)}return[a]}function GFe(t,e,i){const n=i.length,r=new Float32Array(n);for(let s=0;s<n;s++)if(t==null||t[s])for(s=0;s<n;s++){const o=(.1-e[s])**2+(.06-i[s])**2;o&&(r[s]=1/o)}return[r]}var T4;let ix=T4=class extends oo{constructor(){super(...arguments),this.method="custom"}clone(){return new T4({method:this.method,bandIndexes:this.bandIndexes,raster:q(this.raster)})}};h([p({json:{type:String,write:!0}})],ix.prototype,"bandIndexes",void 0),h([be(MFe)],ix.prototype,"method",void 0),ix=T4=h([P("esri.layers.support.rasterFunctions.BandArithmeticFunctionArguments")],ix);const HFe=ix,qFe=new Set(["vari","mtvi2","rtvi-core","evi"]);let Fv=class extends ao{constructor(){super(...arguments),this.functionName="BandArithmetic",this.functionArguments=null,this.rasterArgumentNames=["raster"]}_bindSourceRasters(){this.outputPixelType=this._getOutputPixelType("f32");const e=this.sourceRasterInfos[0];if(e.bandCount<2)return{success:!1,supportsGPU:!1,error:"band-arithmetic-function: source raster has insufficient amount of raster bands"};const i=e.clone();return i.pixelType=this.outputPixelType,i.statistics=null,i.histograms=null,i.bandCount=this.functionArguments.method==="sultan"?3:1,i.keyProperties={...i.keyProperties,BandProperties:void 0},this.rasterInfo=i,{success:!0,supportsGPU:!["custom","gvitm","sultan"].includes(this.functionArguments.method)}}_processPixels(e){var o;const i=(o=e.pixelBlocks)==null?void 0:o[0];if(i==null)return i;const{method:n,bandIndexes:r}=this.functionArguments,s=r.split(" ").map(a=>parseFloat(a));return EFe(i,{method:n,bandIndexes:s,equation:r})}_getWebGLParameters(){const e=this.functionArguments.bandIndexes.split(" ").map(a=>parseFloat(a)-1);e.length===2&&e.push(0);const i=this.isInputBandIdsSwizzled?[0,1,2]:e;let n,r;const s=new Float32Array(3),{method:o}=this.functionArguments;switch(o){case"gndvi":case"nbr":case"ndbi":case"ndvi":case"ndvi-re":case"ndsi":case"ndmi":case"mndwi":n=Pr([i[0],i[1],0]),r="ndxi";break;case"ndwi":n=Pr([i[1],i[0],0]),r="ndxi";break;case"sr":case"sr-re":case"iron-oxide":case"ferrous-minerals":case"clay-minerals":n=Pr([i[0],i[1],0]),r="sr";break;case"ci-g":case"ci-re":n=Pr([i[0],i[1],0]),r="ci";break;case"savi":n=Pr([i[0],i[1],0]),r="savi",s[0]=e[2]+1;break;case"tsavi":n=Pr([i[0],i[1],0]),r="tsavi",s[0]=e[2]+1,s[1]=e[3]+1,s[2]=e[4]+1;break;case"msavi":n=Pr([i[0],i[1],0]),r="msavi";break;case"gemi":n=Pr([i[0],i[1],0]),r="gemi";break;case"pvi":n=Pr([i[0],i[1],0]),r="tsavi",s[0]=e[2]+1,s[1]=e[3]+1;break;case"vari":n=Pr([i[0],i[1],i[2]]),r="vari";break;case"mtvi2":n=Pr([i[0],i[1],i[2]]),r="mtvi2";break;case"rtvi-core":n=Pr([i[0],i[1],i[2]]),r="rtvicore";break;case"evi":n=Pr([i[0],i[1],i[2]]),r="evi";break;case"wndwi":n=Pr([i[0],i[1],0]),r="wndwi",s[0]=e[3]?e[3]+1:.5;break;case"bai":n=Pr([i[1],i[0],0]),r="bai";break;default:n=Pr([0,1,2]),r="custom"}return{bandIndexMat3:n,indexType:r,adjustments:s}}_getInputBandIds(e){if(this.functionArguments.method==="custom")return e;const i=this.functionArguments.bandIndexes.split(" ").map(a=>parseFloat(a)-1),n=e.length,r=i.map(a=>a>=n?n-1:a),s=qFe.has(this.functionArguments.method)?3:2,o=r.slice(0,s).map(a=>e[a]);return o.length===2&&o.push(0),o}};h([p({json:{write:!0,name:"rasterFunction"}})],Fv.prototype,"functionName",void 0),h([p({type:HFe,json:{write:!0,name:"rasterFunctionArguments"}})],Fv.prototype,"functionArguments",void 0),h([p()],Fv.prototype,"rasterArgumentNames",void 0),Fv=h([P("esri.layers.support.rasterFunctions.BandArithmeticFunction")],Fv);const WFe=Fv;var I4;let tu=I4=class extends oo{castColormapName(t){if(!t)return null;const e=t.toLowerCase();return vDe.includes(e)?e:null}readColorRamp(t){return VP(t)}readColorRampName(t,e){if(!t)return null;const i=F_.jsonValues.find(n=>n.toLowerCase()===t.toLowerCase());return i?F_.fromJSON(i):null}clone(){var t;return new I4({colormap:q(this.colormap),colormapName:this.colormapName,colorRamp:(t=this.colorRamp)==null?void 0:t.clone(),colorRampName:this.colorRampName})}};h([p({type:[[Number]],json:{write:!0}})],tu.prototype,"colormap",void 0),h([p({type:String,json:{write:!0}})],tu.prototype,"colormapName",void 0),h([ut("colormapName")],tu.prototype,"castColormapName",null),h([p({types:zP,json:{write:!0}})],tu.prototype,"colorRamp",void 0),h([_e("colorRamp")],tu.prototype,"readColorRamp",null),h([p({type:F_.apiValues,json:{type:F_.jsonValues,write:F_.write}})],tu.prototype,"colorRampName",void 0),h([_e("colorRampName")],tu.prototype,"readColorRampName",null),tu=I4=h([P("esri.layers.support.rasterFunctions.ColormapFunctionArguments")],tu);const JFe=tu,ZFe=[[36,0,255],[36,0,255],[36,0,255],[36,0,255],[112,75,3],[113,76,3],[114,77,3],[115,77,3],[116,78,3],[117,79,3],[118,79,3],[119,80,3],[121,81,4],[122,82,4],[123,82,4],[124,83,4],[125,84,4],[126,84,4],[127,85,4],[128,86,4],[129,86,4],[130,87,4],[131,88,4],[132,89,4],[133,89,4],[134,90,4],[135,91,4],[136,91,4],[137,92,4],[138,93,4],[139,94,4],[140,94,4],[142,95,5],[143,96,5],[144,96,5],[145,97,5],[146,98,5],[147,99,5],[148,99,5],[149,100,5],[150,101,5],[151,101,5],[152,102,5],[153,103,5],[154,104,5],[155,104,5],[156,105,5],[157,106,5],[158,106,5],[159,107,5],[160,108,5],[161,108,5],[162,109,5],[164,110,6],[165,111,6],[166,111,6],[167,112,6],[168,113,6],[169,113,6],[170,114,6],[171,115,6],[172,116,6],[173,116,6],[174,117,6],[245,0,0],[245,5,0],[245,10,0],[246,15,0],[246,20,0],[246,25,0],[246,30,0],[247,35,0],[247,40,0],[247,45,0],[247,50,0],[247,55,0],[248,60,0],[248,65,0],[248,70,0],[248,75,0],[249,81,0],[249,86,0],[249,91,0],[249,96,0],[250,101,0],[250,106,0],[250,111,0],[250,116,0],[250,121,0],[251,126,0],[251,131,0],[251,136,0],[251,141,0],[252,146,0],[252,151,0],[252,156,0],[252,156,0],[251,159,0],[250,162,0],[249,165,0],[248,168,0],[247,171,0],[246,174,0],[245,177,0],[245,179,0],[244,182,0],[243,185,0],[242,188,0],[241,191,0],[240,194,0],[239,197,0],[238,200,0],[237,203,0],[236,206,0],[235,209,0],[234,212,0],[233,215,0],[232,218,0],[231,221,0],[230,224,0],[230,226,0],[229,229,0],[228,232,0],[227,235,0],[226,238,0],[225,241,0],[224,244,0],[223,247,0],[165,247,0],[163,244,0],[161,240,0],[158,237,0],[156,233,1],[154,230,1],[152,227,1],[149,223,1],[147,220,1],[145,216,1],[143,213,1],[140,210,2],[138,206,2],[136,203,2],[134,200,2],[132,196,2],[129,193,2],[127,189,2],[125,186,3],[123,183,3],[120,179,3],[118,176,3],[116,172,3],[114,169,3],[111,166,3],[109,162,4],[107,159,4],[105,155,4],[103,152,4],[100,149,4],[98,145,4],[96,142,4],[94,138,5],[91,135,5],[89,132,5],[87,128,5],[85,125,5],[82,121,5],[80,118,5],[78,115,6],[76,111,6],[73,108,6],[71,105,6],[69,101,6],[67,98,6],[65,94,6],[62,91,7],[60,88,7],[58,84,7],[56,81,7],[53,77,7],[51,74,7],[49,71,7],[47,67,8],[44,64,8],[42,60,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8]],YFe=[[36,0,255],[36,0,255],[36,0,255],[36,0,255],[245,20,0],[245,24,0],[245,29,0],[245,31,0],[247,33,0],[247,33,0],[247,37,0],[247,41,0],[247,41,0],[247,41,0],[247,45,0],[247,45,0],[247,47,0],[247,49,0],[247,49,0],[247,54,0],[247,54,0],[247,56,0],[247,58,0],[247,58,0],[250,62,0],[250,62,0],[250,62,0],[250,67,0],[250,67,0],[250,67,0],[250,69,0],[250,71,0],[250,71,0],[250,75,0],[250,75,0],[250,78,0],[250,79,0],[250,79,0],[250,79,0],[250,81,0],[250,83,0],[250,83,0],[250,87,0],[250,87,0],[250,90,0],[250,92,0],[252,93,0],[252,93,0],[252,97,0],[252,97,0],[252,97,0],[252,97,0],[252,101,0],[252,101,0],[252,101,0],[252,101,0],[252,105,0],[252,105,0],[252,107,0],[252,109,0],[252,109,0],[252,113,13],[255,118,20],[255,119,23],[255,121,25],[255,126,33],[255,132,38],[255,133,40],[255,135,43],[255,141,48],[255,144,54],[255,150,59],[255,152,61],[255,153,64],[255,159,69],[255,163,77],[255,165,79],[255,168,82],[255,174,87],[255,176,92],[255,181,97],[255,183,99],[255,186,102],[255,191,107],[255,197,115],[255,201,120],[255,203,123],[255,205,125],[255,209,130],[255,214,138],[255,216,141],[255,218,143],[255,224,150],[255,228,156],[255,234,163],[255,236,165],[255,238,168],[255,243,173],[255,248,181],[255,252,186],[253,252,186],[250,252,187],[244,250,180],[238,247,176],[234,246,173],[231,245,169],[223,240,163],[217,237,157],[211,235,150],[205,233,146],[200,230,142],[195,227,136],[189,224,132],[184,222,126],[180,220,123],[174,217,119],[169,214,114],[163,212,108],[160,210,105],[154,207,101],[148,204,96],[143,201,93],[138,199,88],[134,197,84],[130,194,81],[126,191,77],[117,189,70],[115,186,68],[112,184,64],[106,181,60],[100,179,55],[94,176,49],[92,174,47],[90,173,45],[81,168,37],[75,166,33],[71,163,28],[66,160,24],[62,158,21],[56,156,14],[51,153,0],[51,153,0],[51,153,0],[50,150,0],[50,150,0],[50,150,0],[50,150,0],[49,148,0],[49,148,0],[49,148,0],[48,145,0],[48,145,0],[48,145,0],[48,145,0],[48,143,0],[48,143,0],[48,143,0],[48,143,0],[47,140,0],[47,140,0],[47,140,0],[47,140,0],[46,138,0],[46,138,0],[46,138,0],[46,138,0],[45,135,0],[45,135,0],[45,135,0],[45,135,0],[44,133,0],[44,133,0],[44,133,0],[43,130,0],[43,130,0],[43,130,0],[43,130,0],[43,130,0],[43,130,0],[42,128,0],[42,128,0],[42,128,0],[42,125,0],[42,125,0],[42,125,0],[42,125,0],[41,122,0],[41,122,0],[41,122,0],[41,122,0],[40,120,0],[40,120,0],[40,120,0],[40,120,0],[40,120,0],[39,117,0],[39,117,0],[39,117,0],[39,117,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0]];function Fj(t,e){const i=[],n=[];for(let s=0;s<t.length-1;s++)i.push({type:"algorithmic",algorithm:"esriHSVAlgorithm",fromColor:t[s].slice(1),toColor:t[s+1].slice(1)}),n.push(t[s+1][0]-t[s][0]);const r=t[t.length-1][0];return xj({type:"multipart",colorRamps:i},{numColors:r,weights:e=e??n})}function XFe(){return Fj([[0,0,191,191],[51,0,0,255],[102,255,0,255],[153,255,0,127],[204,191,63,127],[256,20,20,20]])}function KFe(){const t=Fj([[0,255,255,255],[70,0,255,0],[80,205,173,193],[100,150,150,150],[110,120,51,100],[130,120,100,200],[140,28,3,144],[160,6,0,55],[180,10,25,30],[201,6,7,27]]);for(let e=t.length;e<256;e++)t.push([6,27,7]);return t}function QFe(){return xj({type:"algorithmic",algorithm:"esriHSVAlgorithm",fromColor:[0,0,0],toColor:[255,255,255]})}function eze(){const t=[];for(let e=0;e<256;e++){const i=[];for(let n=0;n<3;n++)i.push(Math.round(255*Math.random()));t.push(i)}return t}function tze(){return Fj([[0,38,41,54],[69,79,82,90],[131,156,156,156],[256,253,253,241]],[.268,.238,.495])}function ize(t){let e;switch(t){case"elevation":e=XFe();break;case"gray":e=QFe();break;case"hillshade":e=tze();break;case"ndvi":e=ZFe;break;case"ndvi2":e=KFe();break;case"ndvi3":e=YFe;break;case"random":e=eze()}return e?(e=e.map((i,n)=>[n,...i]),e):null}let _p=class extends ao{constructor(){super(...arguments),this.functionName="Colormap",this.functionArguments=null,this.rasterArgumentNames=["raster"],this.isNoopProcess=!0}_bindSourceRasters(){const e=this.sourceRasterInfos[0];if(e.bandCount>1)return{success:!1,supportsGPU:!1,error:"colormap-function: source data must be single band"};let{colormap:i,colormapName:n,colorRamp:r,colorRampName:s}=this.functionArguments;if(!(i!=null&&i.length))if(r)i=qy(r,{interpolateAlpha:!0});else if(s){const a=xDe(s);a&&(i=qy(a))}else n&&(i=ize(n));if(!(i!=null&&i.length))return{success:!1,supportsGPU:!1,error:"colormap-function: missing colormap argument"};this.outputPixelType=this._getOutputPixelType("u8");const o=e.clone();return o.pixelType=this.outputPixelType,o.colormap=i,o.bandCount=1,this.rasterInfo=o,{success:!0,supportsGPU:!0}}_processPixels(e){var i;return(i=e.pixelBlocks)==null?void 0:i[0]}};h([p({json:{write:!0,name:"rasterFunction"}})],_p.prototype,"functionName",void 0),h([p({type:JFe,json:{write:!0,name:"rasterFunctionArguments"}})],_p.prototype,"functionArguments",void 0),h([p()],_p.prototype,"rasterArgumentNames",void 0),h([p()],_p.prototype,"isNoopProcess",void 0),h([p({json:{write:!0}})],_p.prototype,"indexedColormap",void 0),_p=h([P("esri.layers.support.rasterFunctions.ColormapFunction")],_p);const nze=_p;var C4;let nx=C4=class extends oo{constructor(){super(...arguments),this.rasters=[]}writeRasters(t,e){e.rasters=t.map(i=>typeof i=="number"||typeof i=="string"?i:i.toJSON())}clone(){return new C4({rasters:q(this.rasters)})}};h([p({json:{write:!0}})],nx.prototype,"rasters",void 0),h([ge("rasters")],nx.prototype,"writeRasters",null),nx=C4=h([P("esri.layers.support.rasterFunctions.CompositeBandFunctionArguments")],nx);const rze=nx;let zv=class extends ao{constructor(){super(...arguments),this.functionName="CompositeBand",this.functionArguments=null,this.rasterArgumentNames=["rasters"]}_bindSourceRasters(){const{sourceRasterInfos:e}=this,i=e[0];this.outputPixelType=this._getOutputPixelType(i.pixelType);const n=i.clone();if(n.attributeTable=null,n.colormap=null,n.pixelType=this.outputPixelType,n.bandCount=e.map(({bandCount:s})=>s).reduce((s,o)=>s+o),e.every(({statistics:s})=>s!=null&&s.length)){const s=[];e.forEach(({statistics:o})=>o!=null&&s.push(...o)),n.statistics=s}if(e.every(({histograms:s})=>s!=null&&s.length)){const s=[];e.forEach(({histograms:o})=>o!=null&&s.push(...o)),n.histograms=s}n.bandCount>1&&(n.colormap=null,n.attributeTable=null);const r=e.every(s=>{var o;return(o=s.keyProperties.BandProperties)==null?void 0:o.length})?e.flatMap(s=>s.keyProperties.BandProperties):void 0;return n.keyProperties={...n.keyProperties,BandProperties:r},this.rasterInfo=n,{success:!0,supportsGPU:n.bandCount<=3}}_processPixels(e){const{pixelBlocks:i}=e;return i?(i==null?void 0:i[0])==null?null:FDe(i):null}_getWebGLParameters(){return{bandCount:this.rasterInfo.bandCount}}};h([p({json:{write:!0,name:"rasterFunction"}})],zv.prototype,"functionName",void 0),h([p({type:rze,json:{write:!0,name:"rasterFunctionArguments"}})],zv.prototype,"functionArguments",void 0),h([p()],zv.prototype,"rasterArgumentNames",void 0),zv=h([P("esri.layers.support.rasterFunctions.CompositeBandFunction")],zv);const sze=zv,Nt={userDefined:-1,lineDetectionHorizontal:0,lineDetectionVertical:1,lineDetectionLeftDiagonal:2,lineDetectionRightDiagonal:3,gradientNorth:4,gradientWest:5,gradientEast:6,gradientSouth:7,gradientNorthEast:8,gradientNorthWest:9,smoothArithmeticMean:10,smoothing3x3:11,smoothing5x5:12,sharpening3x3:13,sharpening5x5:14,laplacian3x3:15,laplacian5x5:16,sobelHorizontal:17,sobelVertical:18,sharpen:19,sharpen2:20,pointSpread:21,none:255},oze={plus:1,minus:2,times:3,sqrt:4,power:5,abs:10,divide:23,exp:25,exp10:26,exp2:27,int:30,float:32,ln:35,log10:36,log2:37,mod:44,negate:45,roundDown:48,roundUp:49,square:53,floatDivide:64,floorDivide:65},To={bitwiseAnd:11,bitwiseLeftShift:12,bitwiseNot:13,bitwiseOr:14,bitwiseRightShift:15,bitwiseXOr:16,booleanAnd:17,booleanNot:18,booleanOr:19,booleanXOr:20,equalTo:24,greaterThan:28,greaterThanEqual:29,lessThan:33,lessThanEqual:34,isNull:31,notEqual:46},cc={acos:6,asin:7,atan:8,atanh:9,cos:21,cosh:22,sin:51,sinh:52,tan:56,tanh:57,acosh:59,asinh:60,atan2:61},aze={majority:38,max:39,mean:40,med:41,min:42,minority:43,range:47,stddev:54,sum:55,variety:58,majorityIgnoreNoData:66,maxIgnoreNoData:67,meanIgnoreNoData:68,medIgnoreNoData:69,minIgnoreNoData:70,minorityIgnoreNoData:71,rangeIgnoreNoData:72,stddevIgnoreNoData:73,sumIgnoreNoData:74,varietyIgnoreNoData:75},nce={setNull:50,conditional:78},QH={...oze,...To,...cc,...aze,...nce},Ki=new Map;function lze(t){const e=Math.sqrt(t.length),i=t.slice(0,e),n=[1];for(let r=1;r<e;r++){let s=null;for(let o=0;o<e;o++){const a=t[o+r*e],l=t[o];if(s==null)if(l===0){if(a)return{separable:!1,row:null,col:null}}else s=a/l;else if(a/l!==s)return{separable:!1,row:null,col:null}}if(s==null)return{separable:!1,row:null,col:null};n.push(s)}return{separable:!0,row:i,col:n}}function eq(t,e,i,n,r,s,o){const a=new Float32Array(e*i),l=s.length,c=o?0:n,u=o?n:0,d=o?1:e;for(let f=c;f<i-c;f++){const m=f*e;for(let g=u;g<e-u;g++){if(r&&!r[m+g])continue;let y=0;for(let _=0;_<l;_++)y+=t[m+g+(_-n)*d]*s[_];a[m+g]=y}}return a}function cze(t,e,i,n,r,s,o){const a=new Float32Array(e*i),l=Math.floor(n/2),c=Math.floor(r/2);for(let u=l;u<i-l;u++){const d=u*e;for(let f=c;f<e-c;f++){if(s&&!s[d+f])continue;let m=0;for(let g=0;g<n;g++)for(let y=0;y<r;y++)m+=t[d+f+(g-l)*e+y-c]*o[g*r+y];a[d+f]=m}}return a}function uze(t,e,i=!0){const{pixels:n,width:r,height:s,pixelType:o,mask:a}=t,l=n.length,c=[],{kernel:u,rows:d,cols:f}=e;for(let m=0;m<l;m++){const g=cze(n[m],r,s,d,f,a,u);i&&rce(g,r,s,d,f),c.push(g)}return new ue({width:r,height:s,pixelType:o,pixels:c,mask:a})}function rce(t,e,i,n,r){const s=Math.floor(n/2);for(let a=0;a<s;a++)for(let l=0;l<e;l++)t[a*e+l]=t[(r-1-a)*e+l],t[(i-1-a)*e+l]=t[(i-r+a)*e+l];const o=Math.floor(r/2);for(let a=0;a<i;a++){const l=a*e;for(let c=0;c<o;c++)t[l+c]=t[l+r-1-c],t[l+e-c-1]=t[l+e+c-r]}}function hze(t,e,i,n=!0){const{pixels:r,width:s,height:o,pixelType:a,mask:l}=t,c=r.length,u=[],d=e.length,f=i.length,m=Math.floor(d/2),g=Math.floor(f/2);for(let y=0;y<c;y++){let _=eq(r[y],s,o,m,l,e,!0);_=eq(_,s,o,g,l,i,!1),n&&rce(_,s,o,d,f),u.push(_)}return new ue({width:s,height:o,pixelType:a,pixels:u,mask:l})}function dze(t,e){const i=lze(e.kernel),n=e.mirrorEdges!==!1,r=i.separable?hze(t,i.row,i.col,n):uze(t,e,n),{outputPixelType:s}=e;return s&&r.clamp(s),r}Ki.set(Nt.none,[0,0,0,0,1,0,0,0,0]),Ki.set(Nt.lineDetectionHorizontal,[-1,-1,-1,2,2,2,-1,-1,-1]),Ki.set(Nt.lineDetectionVertical,[-1,2,-1,-1,2,-1,-1,2,-1]),Ki.set(Nt.lineDetectionLeftDiagonal,[2,-1,-1,-1,2,-1,-1,-1,2]),Ki.set(Nt.lineDetectionRightDiagonal,[-1,-1,2,-1,2,-1,2,-1,-1]),Ki.set(Nt.gradientNorth,[-1,-2,-1,0,0,0,1,2,1]),Ki.set(Nt.gradientWest,[-1,0,1,-2,0,2,-1,0,1]),Ki.set(Nt.gradientEast,[1,0,-1,2,0,-2,1,0,-1]),Ki.set(Nt.gradientSouth,[1,2,1,0,0,0,-1,-2,-1]),Ki.set(Nt.gradientNorthEast,[0,-1,-2,1,0,-1,2,1,0]),Ki.set(Nt.gradientNorthWest,[-2,-1,0,-1,0,1,0,1,2]),Ki.set(Nt.smoothArithmeticMean,[.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111]),Ki.set(Nt.smoothing3x3,[.0625,.125,.0625,.125,.25,.125,.0625,.125,.0625]),Ki.set(Nt.smoothing5x5,[1,1,1,1,1,1,4,4,4,1,1,4,12,4,1,1,4,4,4,1,1,1,1,1,1]),Ki.set(Nt.sharpening3x3,[-1,-1,-1,-1,9,-1,-1,-1,-1]),Ki.set(Nt.sharpening5x5,[-1,-3,-4,-3,-1,-3,0,6,0,-3,-4,6,21,6,-4,-3,0,6,0,-3,-1,-3,-4,-3,-1]),Ki.set(Nt.laplacian3x3,[0,-1,0,-1,4,-1,0,-1,0]),Ki.set(Nt.laplacian5x5,[0,0,-1,0,0,0,-1,-2,-1,0,-1,-2,17,-2,-1,0,-1,-2,-1,0,0,0,-1,0,0]),Ki.set(Nt.sobelHorizontal,[-1,-2,-1,0,0,0,1,2,1]),Ki.set(Nt.sobelVertical,[-1,0,1,-2,0,2,-1,0,1]),Ki.set(Nt.sharpen,[0,-.25,0,-.25,2,-.25,0,-.25,0]),Ki.set(Nt.sharpen2,[-.25,-.25,-.25,-.25,3,-.25,-.25,-.25,-.25]),Ki.set(Nt.pointSpread,[-.627,.352,-.627,.352,2.923,.352,-.627,.352,-.627]);var M4;let yg=M4=class extends oo{constructor(){super(...arguments),this.rows=3,this.cols=3,this.kernel=[0,0,0,0,1,0,0,0,0]}set convolutionType(t){this._set("convolutionType",t);const e=Ki.get(t);if(!e||t===Nt.userDefined||t===Nt.none)return;const i=Math.sqrt(e.length);this._set("kernel",e),this._set("cols",i),this._set("rows",i)}clone(){return new M4({cols:this.cols,rows:this.rows,kernel:[...this.kernel],convolutionType:this.convolutionType,raster:q(this.raster)})}};h([p({json:{type:Number,write:!0}})],yg.prototype,"rows",void 0),h([p({json:{type:Number,write:!0}})],yg.prototype,"cols",void 0),h([p({json:{name:"type",type:Number,write:!0}})],yg.prototype,"convolutionType",null),h([p({json:{type:[Number],write:!0}})],yg.prototype,"kernel",void 0),yg=M4=h([P("esri.layers.support.rasterFunctions.ConvolutionFunctionArguments")],yg);const pze=yg,tq=25;let Vv=class extends ao{constructor(){super(...arguments),this.functionName="Convolution",this.rasterArgumentNames=["raster"]}_bindSourceRasters(){const{convolutionType:e,rows:i,cols:n,kernel:r}=this.functionArguments;if(!Object.values(Nt).includes(e))return{success:!1,supportsGPU:!1,error:`convolution-function: the specified kernel type is not supported ${e}`};if(e!==Nt.none&&i*n!==r.length)return{success:!1,supportsGPU:!1,error:"convolution-function: the specified rows and cols do not match the length of the kernel"};const s=this.sourceRasterInfos[0];this.outputPixelType=this._getOutputPixelType(s.pixelType);const o=s.clone();o.pixelType=this.outputPixelType;const a=[Nt.none,Nt.sharpen,Nt.sharpen2,Nt.sharpening3x3,Nt.sharpening5x5];return this.outputPixelType==="u8"||a.includes(e)||(o.statistics=null,o.histograms=null),o.colormap=null,o.attributeTable=null,this.rasterInfo=o,{success:!0,supportsGPU:r.length<=tq}}_processPixels(e){var a;const i=(a=e.pixelBlocks)==null?void 0:a[0];if(i==null||this.functionArguments.convolutionType===Nt.none)return i;let{kernel:n,rows:r,cols:s}=this.functionArguments;const o=n.reduce((l,c)=>l+c);return o!==0&&o!==1&&(n=n.map(l=>l/o)),dze(i,{kernel:n,rows:r,cols:s,outputPixelType:this.outputPixelType})}_getWebGLParameters(){let{kernel:e}=this.functionArguments;const i=e.reduce((r,s)=>r+s);i!==0&&i!==1&&(e=e.map(r=>r/i));const n=new Float32Array(tq);return n.set(e),{kernelRows:this.functionArguments.rows,kernelCols:this.functionArguments.cols,kernel:n,clampRange:Ac(this.outputPixelType)}}};h([p({json:{write:!0,name:"rasterFunction"}})],Vv.prototype,"functionName",void 0),h([p({type:pze,json:{write:!0,name:"rasterFunctionArguments"}})],Vv.prototype,"functionArguments",void 0),h([p()],Vv.prototype,"rasterArgumentNames",void 0),Vv=h([P("esri.layers.support.rasterFunctions.ConvolutionFunction")],Vv);const fze=Vv;var E4;const sce=new qe({0:"standard",1:"platform",2:"profile"},{useNumericKeys:!0});let jv=E4=class extends oo{constructor(){super(...arguments),this.curvatureType="standard",this.zFactor=1}readCurvatureType(t,e){return sce.fromJSON(e.type??e.curvatureType??0)}clone(){return new E4({curvatureType:this.curvatureType,zFactor:this.zFactor,raster:this.raster})}};h([p({json:{write:{target:"type"}}}),be(sce)],jv.prototype,"curvatureType",void 0),h([_e("curvatureType",["type","curvatureType"])],jv.prototype,"readCurvatureType",null),h([p({type:Number,json:{write:!0}})],jv.prototype,"zFactor",void 0),jv=E4=h([P("esri.layers.support.rasterFunctions.CurvatureFunctionArguments")],jv);const mze=jv;let vg=class extends ao{constructor(){super(...arguments),this.functionName="Curvature",this.functionArguments=null,this.rasterArgumentNames=["raster"],this.isGCS=!1}_bindSourceRasters(){var i;this.outputPixelType=this._getOutputPixelType("f32");const e=this.sourceRasterInfos[0].clone();return e.pixelType=this.outputPixelType,e.statistics=null,e.histograms=null,e.colormap=null,e.attributeTable=null,e.bandCount=1,this.rasterInfo=e,this.isGCS=((i=e.spatialReference)==null?void 0:i.isGeographic)??!1,{success:!0,supportsGPU:!0}}_processPixels(e){var u;const i=(u=e.pixelBlocks)==null?void 0:u[0];if(i==null)return null;const{zFactor:n,curvatureType:r}=this.functionArguments,{extent:s,primaryPixelSizes:o}=e,a=o==null?void 0:o[0],l=a??(s?{x:s.width/i.width,y:s.height/i.height}:{x:1,y:1}),c=this.isGCS&&n>=1?n*Nh:n;return _Fe(i,{zFactor:c,curvatureType:r,resolution:l})}_getWebGLParameters(){const{zFactor:e,curvatureType:i}=this.functionArguments;return{curvatureType:i,zFactor:this.isGCS&&e>=1?e*Nh:e}}};h([p({json:{write:!0,name:"rasterFunction"}})],vg.prototype,"functionName",void 0),h([p({type:mze,json:{write:!0,name:"rasterFunctionArguments"}})],vg.prototype,"functionArguments",void 0),h([p()],vg.prototype,"rasterArgumentNames",void 0),h([p({json:{write:!0}})],vg.prototype,"isGCS",void 0),vg=h([P("esri.layers.support.rasterFunctions.CurvatureFunction")],vg);const gze=vg;var A4;let _h=A4=class extends oo{constructor(){super(...arguments),this.bandIds=[],this.bandNames=[],this.bandWavelengths=[],this.missingBandAction=BA.bestMatch}clone(){return new A4({bandIds:[...this.bandIds],bandNames:[...this.bandNames],missingBandAction:this.missingBandAction,method:this.method,wavelengthMatchTolerance:this.wavelengthMatchTolerance})}};h([p({json:{write:!0}})],_h.prototype,"bandIds",void 0),h([p({json:{write:!0}})],_h.prototype,"bandNames",void 0),h([p({json:{write:!0}})],_h.prototype,"bandWavelengths",void 0),h([be({0:"name",1:"wavelength",2:"id"})],_h.prototype,"method",void 0),h([p({json:{write:!0}})],_h.prototype,"missingBandAction",void 0),h([p({json:{write:!0}})],_h.prototype,"wavelengthMatchTolerance",void 0),_h=A4=h([P("esri.layers.support.rasterFunctions.ExtractBandFunctionArguments")],_h);const yze=_h;let Bv=class extends ao{constructor(){super(...arguments),this.functionName="ExtractBand",this.functionArguments=null,this.rasterArgumentNames=["raster"]}_bindSourceRasters(){var b;const{functionArguments:e,sourceRasterInfos:i}=this,n=i[0],{method:r,bandNames:s,bandWavelengths:o,bandIds:a,missingBandAction:l}=e,c=(s==null?void 0:s.length)&&(r==="name"||r!=="id"&&!(a!=null&&a.length)),u=(o==null?void 0:o.length)&&(r==="wavelength"||r!=="id"&&!(a!=null&&a.length)),d=l===BA.fail,f=c?this._matchBandNames(n,s):u?this._matchBandWavelengths(n,o,d):this._matchBandIds(n,a,d);if(f==null)return{success:!1,supportsGPU:!1,error:`extract-band-function: Invalid ${c?"band names":u?"band wavelengths":"band ids"} for the imagery data source`};this.functionArguments.bandIds=f,this.functionArguments.method="id",this.outputPixelType=this._getOutputPixelType("f32");const m=n.clone();m.pixelType=this.outputPixelType,m.bandCount=f.length;const{statistics:g,histograms:y}=m;g!=null&&g.length&&(m.statistics=f.map(w=>g[w]||g[g.length-1])),y!=null&&y.length&&(m.histograms=f.map(w=>y[w]||y[y.length-1]));let _=(b=m.keyProperties)==null?void 0:b.BandProperties;return _!=null&&_.length&&(_=f.map(w=>w>=_.length?_[_.length-1]:_[w]),m.keyProperties={...m.keyProperties,BandProperties:_}),this.rasterInfo=m,{success:!0,supportsGPU:m.bandCount<=3}}_processPixels(e){var s;const i=(s=e.pixelBlocks)==null?void 0:s[0];if(i==null)return null;const n=i.pixels.length,r=this.functionArguments.bandIds.map(o=>o>=n?n-1:o);return i.extractBands(r)}_getWebGLParameters(){let e;if(this.isInputBandIdsSwizzled)e=this.swizzledBandSelection.length?this.swizzledBandSelection:[0,1,2];else{e=[...this.functionArguments.bandIds],e.length===0?e=[0,1,2]:e.length<3&&(e[1]=e[1]??e[0],e[2]=e[2]??e[1]);for(let i=0;i<3;i++)e[i]=Math.min(e[i],2)}return{bandIndexMat3:Pr(e)}}_getInputBandIds(e){const i=e.length;return this.functionArguments.bandIds.map(n=>n>=i?i-1:n).map(n=>e[n])}_matchBandNames(e,i){const n=e.bandInfos.map(({name:s})=>s.toLowerCase()),r=[];for(let s=0;s<i.length;s++){const o=i[s].toLowerCase();let a=n.indexOf(o);if(a===-1&&o==="nearinfrared"&&(a=n.findIndex(l=>l.startsWith("nearinfrared_1")),a===-1&&(a=n.findIndex(l=>l.startsWith("nearinfrared")))),a===-1)return null;r.push(a)}return r}_matchBandIds(e,i,n){const{bandCount:r}=e;return!(i!=null&&i.length)||n&&i.some(s=>s<0||s>=r)?null:i}_matchBandWavelengths(e,i,n){const{bandInfos:r}=e,s=[];for(let l=0;l<r.length;l++){const{minWavelength:c,maxWavelength:u}=r[l];if(!c||!u)return null;s.push({minWavelength:c,maxWavelength:u})}const{wavelengthMatchTolerance:o}=this.functionArguments,a=[];for(let l=0;l<i.length;l++){const c=i[l];let u=!1,d=-1,f=Number.MAX_VALUE;for(let m=0;m<s.length;m++){const g=s[m],y=c>=g.minWavelength&&c<=g.maxWavelength,_=Math.abs(c-(g.minWavelength+g.maxWavelength)/2);y?_<f&&(u=!0,d=m,f=_):!u&&_<f&&(d=m,f=_)}if(!u&&o&&f<o&&(u=!0),!u&&n)return null;a.push(d)}return a}};h([p({json:{write:!0,name:"rasterFunction"}})],Bv.prototype,"functionName",void 0),h([p({type:yze,json:{write:!0,name:"rasterFunctionArguments"}})],Bv.prototype,"functionArguments",void 0),h([p()],Bv.prototype,"rasterArgumentNames",void 0),Bv=h([P("esri.layers.support.rasterFunctions.ExtractBandFunction")],Bv);const vze=Bv;var $4;let _g=$4=class extends oo{constructor(){super(...arguments),this.rasters=[],this.processAsMultiband=!0}writeRasters(t,e){e.rasters=t.map(i=>typeof i=="number"||typeof i=="string"?i:i.toJSON())}clone(){return new $4({operation:this.operation,processAsMultiband:this.processAsMultiband,rasters:q(this.rasters)})}};h([p({json:{write:!0}})],_g.prototype,"operation",void 0),h([p({json:{write:!0}})],_g.prototype,"rasters",void 0),h([ge("rasters")],_g.prototype,"writeRasters",null),h([p({json:{write:!0}})],_g.prototype,"processAsMultiband",void 0),_g=$4=h([P("esri.layers.support.rasterFunctions.LocalFunctionArguments")],_g);const _ze=_g,kr=new Map;function bze(t){return kr.get(t)}kr.set(cc.acos,[0,Math.PI]),kr.set(cc.asin,[-Math.PI/2,Math.PI/2]),kr.set(cc.atan,[-Math.PI/2,Math.PI/2]),kr.set(cc.cos,[-1,1]),kr.set(cc.sin,[-1,1]),kr.set(To.booleanAnd,[0,1]),kr.set(To.booleanNot,[0,1]),kr.set(To.booleanOr,[0,1]),kr.set(To.booleanXOr,[0,1]),kr.set(To.equalTo,[0,1]),kr.set(To.notEqual,[0,1]),kr.set(To.greaterThan,[0,1]),kr.set(To.greaterThanEqual,[0,1]),kr.set(To.lessThan,[0,1]),kr.set(To.lessThanEqual,[0,1]),kr.set(To.isNull,[0,1]);const iq=[0,2,2,2,1,2,1,1,1,1,1,2,2,1,2,2,2,2,1,2,2,1,1,2,2,1,1,1,2,2,1,1,1,2,2,1,1,1,999,999,999,999,999,999,2,1,2,999,1,1,2,1,1,1,999,999,1,1,999,1,1,2,999,999,2,2,999,999,999,999,999,999,999,999,999,999,3,999,3];function wze(t,e=!1){const i=t.map(a=>a.mask),n=i.filter(a=>a!=null),r=t[0].pixels[0].length;if(n.length===0)return new Uint8Array(r).fill(255);const s=n[0],o=new Uint8Array(s);if(n.length===1)return o;if(!e){for(let a=1;a<n.length;a++){const l=n[a];for(let c=0;c<o.length;c++)o[c]&&(o[c]=l[c]?255:0)}return o}if(n.length!==i.length)return new Uint8Array(r).fill(255);for(let a=1;a<n.length;a++){const l=n[a];for(let c=0;c<o.length;c++)o[c]===0&&(o[c]=l[c]?255:0)}return o}function xze(t,e,i){const[n,r]=t,s=n.length,o=ue.createEmptyBand(i,s);for(let a=0;a<s;a++)e&&!e[a]||(o[a]=n[a]+r[a]);return o}function Sze(t,e,i){const[n]=t,r=n.length,s=ue.createEmptyBand("f32",r);return s.set(n),s}function Tze(t,e,i){const[n,r]=t,s=n.length,o=ue.createEmptyBand(i,s);for(let a=0;a<s;a++)e&&!e[a]||(o[a]=n[a]-r[a]);return o}function Ize(t,e,i){const[n,r]=t,s=n.length,o=ue.createEmptyBand(i,s);for(let a=0;a<s;a++)e&&!e[a]||(o[a]=n[a]*r[a]);return o}function Cze(t,e,i){const[n]=t,r=n.length,s=ue.createEmptyBand(i,r);for(let o=0;o<r;o++)e&&!e[o]||(s[o]=Math.sign(n[o])*Math.floor(Math.abs(n[o])));return s}function oce(t,e,i){const[n,r]=t,s=n.length,o=ue.createEmptyBand(i,s);for(let a=0;a<s;a++)e&&!e[a]||(o[a]=n[a]/r[a]);return o}function Mze(t,e,i){return oce(t,e,"f32")}function Eze(t,e,i){const[n,r]=t,s=n.length,o=ue.createEmptyBand(i,s);for(let a=0;a<s;a++)e&&!e[a]||(o[a]=Math.floor(n[a]/r[a]));return o}function Aze(t,e,i,n){const r=t[0],s=r.length,o=ue.createEmptyBand(i,s);if(n===cc.atanh){for(let l=0;l<s;l++)if(e[l]){const c=r[l];Math.abs(c)>=1?e[l]=0:o[l]=Math.atanh(c)}return o}const a=n===cc.asin?Math.asin:Math.acos;for(let l=0;l<s;l++)if(e[l]){const c=r[l];Math.abs(c)>1?e[l]=0:o[l]=a(c)}return o}function $ze(t,e,i,n){const[r]=t,s=r.length,o=ue.createEmptyBand(i,s);for(let a=0;a<s;a++)e&&!e[a]||(o[a]=n(r[a]));return o}function Pze(t,e,i,n){const[r,s]=t,o=r.length,a=ue.createEmptyBand(i,o);for(let l=0;l<o;l++)e&&!e[l]||(a[l]=n(r[l],s[l]));return a}function kze(t,e,i){const[n,r]=t,s=n.length,o=ue.createEmptyBand(i,s);for(let a=0;a<s;a++)e&&!e[a]||(o[a]=n[a]&r[a]);return o}function nq(t,e,i){const[n,r]=t,s=n.length,o=ue.createEmptyBand(i,s);for(let a=0;a<s;a++)e&&!e[a]||(o[a]=n[a]<<r[a]);return o}function Oze(t,e,i){const[n]=t,r=n.length,s=ue.createEmptyBand(i,r);for(let o=0;o<r;o++)e&&!e[o]||(s[o]=~n[o]);return s}function Lze(t,e,i){const[n,r]=t,s=n.length,o=ue.createEmptyBand(i,s);for(let a=0;a<s;a++)e&&!e[a]||(o[a]=n[a]|r[a]);return o}function Rze(t,e,i){const[n,r]=t,s=n.length,o=ue.createEmptyBand(i,s);for(let a=0;a<s;a++)e&&!e[a]||(o[a]=n[a]>>r[a]);return o}function Dze(t,e,i){const[n,r]=t,s=n.length,o=ue.createEmptyBand(i,s);for(let a=0;a<s;a++)e&&!e[a]||(o[a]=n[a]^r[a]);return o}function Nze(t,e,i){const[n,r]=t,s=n.length,o=ue.createEmptyBand(i,s);for(let a=0;a<s;a++)e&&!e[a]||(o[a]=n[a]&&r[a]?1:0);return o}function Fze(t,e,i){const[n]=t,r=n.length,s=ue.createEmptyBand(i,r);for(let o=0;o<r;o++)e&&!e[o]||(s[o]=n[o]?0:1);return s}function zze(t,e,i){const[n,r]=t,s=n.length,o=ue.createEmptyBand(i,s);for(let a=0;a<s;a++)e&&!e[a]||(o[a]=n[a]||r[a]?1:0);return o}function Vze(t,e,i){const[n,r]=t,s=n.length,o=ue.createEmptyBand(i,s);for(let a=0;a<s;a++)e&&!e[a]||(o[a]=(n[a]?1:0)^(r[a]?1:0));return o}function jze(t,e,i){const[n,r]=t,s=n.length,o=ue.createEmptyBand(i,s);for(let a=0;a<s;a++)e&&!e[a]||(o[a]=n[a]===r[a]?1:0);return o}function zj(t,e,i,n){const[r]=t,s=r.length,o=ue.createEmptyBand(i,s),a=n===Math.E;for(let l=0;l<s;l++)e&&!e[l]||(o[l]=a?Math.exp(r[l]):n**r[l]);return o}function Bze(t,e,i){return zj(t,e,i,10)}function Uze(t,e,i){return zj(t,e,i,2)}function Gze(t,e,i){return zj(t,e,i,Math.E)}function Vj(t,e,i,n){const[r]=t,s=r.length,o=ue.createEmptyBand(i,s);for(let a=0;a<s;a++)e&&!e[a]||(r[a]<=0?e[a]=0:o[a]=n(r[a]));return o}function Hze(t,e,i){return Vj(t,e,i,Math.log10)}function qze(t,e,i){return Vj(t,e,i,Math.log2)}function Wze(t,e,i){return Vj(t,e,i,Math.log)}function Jze(t,e,i){const[n,r]=t,s=n.length,o=ue.createEmptyBand(i,s);for(let a=0;a<s;a++)e&&!e[a]||(o[a]=n[a]>r[a]?1:0);return o}function Zze(t,e,i){const[n,r]=t,s=n.length,o=ue.createEmptyBand(i,s);for(let a=0;a<s;a++)e&&!e[a]||(o[a]=n[a]>=r[a]?1:0);return o}function Yze(t,e,i){const[n,r]=t,s=n.length,o=ue.createEmptyBand(i,s);for(let a=0;a<s;a++)e&&!e[a]||(o[a]=n[a]<r[a]?1:0);return o}function Xze(t,e,i){const[n,r]=t,s=n.length,o=ue.createEmptyBand(i,s);for(let a=0;a<s;a++)e&&!e[a]||(o[a]=n[a]<=r[a]?1:0);return o}function Kze(t,e,i){const[n]=t,r=n.length,s=ue.createEmptyBand(i,r);if(!e)return s;for(let o=0;o<r;o++)s[o]=e[o]?0:1;return s}function Qze(t,e,i){const[n,r]=t,s=n.length,o=ue.createEmptyBand(i,s);for(let a=0;a<s;a++)e&&!e[a]||(o[a]=n[a]%r[a]);return o}function e6e(t,e,i){const[n]=t,r=n.length,s=ue.createEmptyBand(i,r);for(let o=0;o<r;o++)e&&!e[o]||(s[o]=-n[o]);return s}function t6e(t,e,i){const[n,r]=t,s=n.length,o=ue.createEmptyBand(i,s);for(let a=0;a<s;a++)e&&!e[a]||(o[a]=n[a]===r[a]?0:1);return o}function i6e(t,e,i){const[n,r]=t,s=n.length,o=ue.createEmptyBand(i,s),a=new Uint8Array(s);for(let l=0;l<s;l++)e!=null&&!e[l]||n[l]!==0||(o[l]=r[l],a[l]=255);return{band:o,mask:a}}function rq(t,e,i){const[n,r,s]=t,o=n.length,a=ue.createEmptyBand(i,o);for(let l=0;l<o;l++)e&&!e[l]||(a[l]=n[l]?r[l]:s[l]);return a}function sq(t,e,i){const n=t.length;if(n<2)return t[0];const[r]=t,s=r.length,o=ue.createEmptyBand(i,s);for(let a=0;a<s;a++)if(!e||e[a]){let l=r[a];for(let c=1;c<n;c++){const u=t[c][a];l<u&&(l=u)}o[a]=l}return o}function oq(t,e,i){const n=t.length;if(n<2)return t[0];const[r]=t,s=r.length,o=ue.createEmptyBand(i,s);for(let a=0;a<s;a++)if(!e||e[a]){let l=r[a];for(let c=1;c<n;c++){const u=t[c][a];l>u&&(l=u)}o[a]=l}return o}function aq(t,e,i){const n=t.length;if(n<2)return t[0];const[r]=t,s=r.length,o=ue.createEmptyBand(i,s);for(let a=0;a<s;a++)if(!e||e[a]){let l=r[a],c=l;for(let u=1;u<n;u++){const d=t[u][a];c<d?c=d:l>d&&(l=d)}o[a]=c-l}return o}function lq(t,e,i){const n=t.length;if(n<2)return t[0];const[r]=t,s=r.length,o=ue.createEmptyBand(i,s);for(let a=0;a<s;a++)if(!e||e[a]){let l=0;for(let c=0;c<n;c++)l+=t[c][a];o[a]=l/n}return o}function cq(t,e,i){const n=t.length;if(n<2)return t[0];const[r]=t,s=r.length,o=ue.createEmptyBand(i,s);for(let a=0;a<s;a++)if(!e||e[a])for(let l=0;l<n;l++){const c=t[l];o[a]+=c[a]}return o}function uq(t,e,i){const n=t.length;if(n<2)return t[0];const[r]=t,s=r.length,o=ue.createEmptyBand(i,s);for(let a=0;a<s;a++)if(!e||e[a]){const l=new Float32Array(n);let c=0;for(let d=0;d<n;d++){const f=t[d];c+=f[a],l[d]=f[a]}c/=n;let u=0;for(let d=0;d<n;d++)u+=(l[d]-c)**2;o[a]=Math.sqrt(u/n)}return o}function hq(t,e,i){const n=t.length;if(n<2)return t[0];const r=Math.floor(n/2),[s]=t,o=s.length,a=ue.createEmptyBand(i,o),l=new Float32Array(n),c=n%2==1;for(let u=0;u<o;u++)if(!e||e[u]){for(let d=0;d<n;d++)l[d]=t[d][u];l.sort(),a[u]=c?l[r]:(l[r]+l[r-1])/2}return a}function ace(t,e,i){const[n,r]=t;if(r==null)return n;const s=n.length,o=ue.createEmptyBand(i,s);for(let a=0;a<s;a++)e[a]&&(n[a]===r[a]?o[a]=n[a]:e[a]=0);return o}function dq(t,e,i){const n=t.length;if(n<=2)return ace(t,e,i);const r=t[0].length,s=ue.createEmptyBand(i,r),o=new Map;for(let a=0;a<r;a++)if(!e||e[a]){let l;o.clear();for(let d=0;d<n;d++)l=t[d][a],o.set(l,o.has(l)?o.get(l)+1:1);let c=0,u=0;for(const d of o.keys())c=o.get(d),c>u&&(u=c,l=d);s[a]=l}return s}function pq(t,e,i){const n=t.length;if(n<=2)return ace(t,e,i);const r=t[0].length,s=ue.createEmptyBand(i,r),o=new Map;for(let a=0;a<r;a++)if(!e||e[a]){let l;o.clear();for(let d=0;d<n;d++)l=t[d][a],o.set(l,o.has(l)?o.get(l)+1:1);let c=0,u=t.length;for(const d of o.keys())c=o.get(d),c<u&&(u=c,l=d);s[a]=l}return s}function fq(t,e,i){const n=t.length;if(n<2)return t[0];const[r]=t,s=r.length,o=ue.createEmptyBand(i,s),a=new Set;for(let l=0;l<s;l++)if(!e||e[l]){let c;a.clear();for(let u=0;u<n;u++)c=t[u][l],a.add(c);o[l]=a.size}return o}const Jn=new Map,QA=new Map,ft=new Map,en=new Map;function n6e(){Jn.size||(Jn.set(4,Math.sqrt),Jn.set(6,Math.acos),Jn.set(7,Math.asin),Jn.set(8,Math.atan),Jn.set(9,Math.atanh),Jn.set(10,Math.abs),Jn.set(21,Math.cos),Jn.set(22,Math.cosh),Jn.set(48,Math.floor),Jn.set(49,Math.ceil),Jn.set(51,Math.sin),Jn.set(52,Math.sinh),Jn.set(56,Math.tan),Jn.set(57,Math.tanh),Jn.set(59,Math.acosh),Jn.set(60,Math.asinh),Jn.set(65,Math.floor),QA.set(5,Math.pow),QA.set(61,Math.atan2),ft.set(1,xze),ft.set(2,Tze),ft.set(3,Ize),ft.set(11,kze),ft.set(12,nq),ft.set(12,nq),ft.set(13,Oze),ft.set(14,Lze),ft.set(15,Rze),ft.set(16,Dze),ft.set(17,Nze),ft.set(18,Fze),ft.set(19,zze),ft.set(20,Vze),ft.set(23,oce),ft.set(24,jze),ft.set(25,Gze),ft.set(26,Bze),ft.set(27,Uze),ft.set(28,Jze),ft.set(29,Zze),ft.set(30,Cze),ft.set(31,Kze),ft.set(32,Sze),ft.set(33,Yze),ft.set(34,Xze),ft.set(35,Wze),ft.set(36,Hze),ft.set(37,qze),ft.set(44,Qze),ft.set(45,e6e),ft.set(46,t6e),ft.set(64,Mze),ft.set(65,Eze),ft.set(76,rq),ft.set(78,rq),en.set(38,dq),en.set(39,sq),en.set(40,lq),en.set(41,hq),en.set(42,oq),en.set(43,pq),en.set(47,aq),en.set(54,uq),en.set(55,cq),en.set(58,fq),en.set(66,dq),en.set(67,sq),en.set(68,lq),en.set(69,hq),en.set(70,oq),en.set(71,pq),en.set(72,aq),en.set(73,uq),en.set(74,cq),en.set(75,fq))}function r6e(t,e,i,n){let[r,s]=Ac(i);const o=i.startsWith("u")||i.startsWith("s");o&&(r-=1e-5,s+=1e-5);for(let a=0;a<e.length;a++)if(e[a]){const l=t[a];isNaN(l)||l<r||l>s?e[a]=0:n[a]=o?Math.round(l):l}}function s6e(t,e,i={}){n6e();let n=wze(t,e>=66&&e<=75);const{outputPixelType:r="f32"}=i,s=!en.has(e)||i.processAsMultiband,o=s?t[0].pixels.length:1,a=[];for(let c=0;c<o;c++){const u=en.has(e)&&!s?t.flatMap(m=>m.pixels):t.map(m=>m.pixels[c]);let d,f=!0;if(e===nce.setNull){const m=i6e(u,n,r);d=m.band,n=m.mask,f=!1}else ft.has(e)?d=ft.get(e)(u,n,"f64"):Jn.has(e)?d=e===cc.asin||e===cc.acos||e===cc.atanh?Aze(u,n,"f64",e):$ze(u,n,"f64",Jn.get(e)):QA.has(e)?d=Pze(u,n,"f64",QA.get(e)):en.has(e)?d=en.get(e)(u,n,"f64"):(d=u[0],f=!1);if(f&&e!==To.isNull&&!kr.has(e)){const m=ue.createEmptyBand(r,d.length);n||(n=new Uint8Array(d.length).fill(255)),r6e(d,n,r,m),d=m}a.push(d)}const l=t[0];return new ue({width:l.width,height:l.height,pixelType:r,mask:e===To.isNull?null:n,pixels:a})}let Uv=class extends ao{constructor(){super(...arguments),this.functionName="Local",this.functionArguments=null,this.rasterArgumentNames=["rasters"]}_bindSourceRasters(){const{sourceRasterInfos:e}=this,i=e[0],{bandCount:n}=i,{processAsMultiband:r}=this.functionArguments;if(e.some(u=>u.bandCount!==n))return{success:!1,supportsGPU:!1,error:"local-function: input rasters do not have same band count"};const{operation:s,rasters:o}=this.functionArguments,a=iq[s];if(!(a===999||o.length===a||o.length<=1&&a===1))return{success:!1,supportsGPU:!1,error:`local-function: the length of functionArguments.rasters does not match operation's requirement: ${a}`};this.outputPixelType=this._getOutputPixelType("f32");const l=i.clone();l.pixelType=this.outputPixelType,l.statistics=null,l.histograms=null,l.colormap=null,l.attributeTable=null,l.bandCount=a!==999||r?n:1;const c=bze(s);if(c){l.statistics=[];for(let u=0;u<l.bandCount;u++)l.statistics[u]={min:c[0],max:c[1],avg:(c[0]+c[1])/2,stddev:(c[0]+c[1])/10}}return this.rasterInfo=l,{success:!0,supportsGPU:l.bandCount===1&&a<=3&&(s<11||s>16)}}_processPixels(e){const{pixelBlocks:i}=e;return i==null||i.some(n=>n==null)?null:s6e(i,this.functionArguments.operation,{processAsMultiband:this.functionArguments.processAsMultiband,outputPixelType:this.outputPixelType??void 0})}_getWebGLParameters(){var l;const{operation:e}=this.functionArguments,i=iq[e],n=((l=Object.keys(QH).find(c=>QH[c]===e))==null?void 0:l.toLowerCase())??"undefined",r=this.outputPixelType??"f32";let[s,o]=Ac(r);const a=r.startsWith("u")||r.startsWith("s");return a&&(s-=1e-4,o+=1e-4),{imageCount:i,operationName:n,domainRange:[s,o],isOutputRounded:a}}};h([p({json:{write:!0,name:"rasterFunction"}})],Uv.prototype,"functionName",void 0),h([p({type:_ze,json:{write:!0,name:"rasterFunctionArguments"}})],Uv.prototype,"functionArguments",void 0),h([p()],Uv.prototype,"rasterArgumentNames",void 0),Uv=h([P("esri.layers.support.rasterFunctions.LocalFunction")],Uv);const o6e=Uv;var P4;let bg=P4=class extends oo{constructor(){super(...arguments),this.includedRanges=null,this.noDataValues=null,this.noDataInterpretation=jA.matchAny}get normalizedNoDataValues(){const{noDataValues:t}=this;if(!(t!=null&&t.length))return null;let e=!1;const i=t.map(n=>{if(typeof n=="number")return e=!0,[n];if(typeof n=="string"){const r=n.trim().split(" ").filter(s=>s.trim()!=="").map(s=>Number(s));return e=e||r.length>0,r.length===0?null:r}return null});return e?i:null}clone(){var t,e;return new P4({includedRanges:((t=this.includedRanges)==null?void 0:t.slice())??[],noDataValues:((e=this.noDataValues)==null?void 0:e.slice())??[],noDataInterpretation:this.noDataInterpretation})}};h([p({json:{write:!0}})],bg.prototype,"includedRanges",void 0),h([p({json:{write:!0}})],bg.prototype,"noDataValues",void 0),h([p()],bg.prototype,"normalizedNoDataValues",null),h([p({json:{write:!0}})],bg.prototype,"noDataInterpretation",void 0),bg=P4=h([P("esri.layers.support.rasterFunctions.MaskFunctionArguments")],bg);const a6e=bg;let wg=class extends ao{constructor(){super(...arguments),this.functionName="Mask",this.functionArguments=null,this.rasterArgumentNames=["raster"]}_bindSourceRasters(){const e=this.sourceRasterInfos[0].clone(),{pixelType:i}=e;this.outputPixelType=this._getOutputPixelType(i),e.pixelType=this.outputPixelType,this.rasterInfo=e;const{includedRanges:n,normalizedNoDataValues:r}=this.functionArguments;if(!(n!=null&&n.length)&&!(r!=null&&r.length))return{success:!1,supportsGPU:!1,error:"missing includedRanges or noDataValues argument"};let s=[];for(let a=0;a<e.bandCount;a++){const l=UDe(i,n==null?void 0:n.slice(2*a,2*a+2),r==null?void 0:r[a]);if(l==null){s=null;break}s.push(l)}this.lookups=s;const o=r!=null&&r.every(a=>{var l;return(a==null?void 0:a.length)===((l=r[0])==null?void 0:l.length)});return{success:!0,supportsGPU:(!n||n.length<=2*kh)&&(!r||o&&r[0].length<=kh)}}_processPixels(e){var c;const i=(c=e.pixelBlocks)==null?void 0:c[0];if(i==null)return null;const{outputPixelType:n,lookups:r}=this,{includedRanges:s,noDataInterpretation:o,normalizedNoDataValues:a}=this.functionArguments,l=o===jA.matchAll;return jDe(i,{includedRanges:s,noDataValues:a,outputPixelType:n,matchAll:l,lookups:r})}_getWebGLParameters(){var s;const{includedRanges:e,normalizedNoDataValues:i}=this.functionArguments,n=new Float32Array(kh);n.fill(If),(s=i==null?void 0:i[0])!=null&&s.length&&n.set(i[0]);const r=new Float32Array(kh);for(let o=0;o<r.length;o+=2)r[o]=(e==null?void 0:e[o])??-If,r[o+1]=(e==null?void 0:e[o+1])??If;return e&&e.length&&r.set(e),{bandCount:this.sourceRasterInfos[0].bandCount,noDataValues:n,includedRanges:r}}};h([p({json:{write:!0,name:"rasterFunction"}})],wg.prototype,"functionName",void 0),h([p({type:a6e,json:{write:!0,name:"rasterFunctionArguments"}})],wg.prototype,"functionArguments",void 0),h([p()],wg.prototype,"rasterArgumentNames",void 0),h([p({json:{write:!0}})],wg.prototype,"lookups",void 0),wg=h([P("esri.layers.support.rasterFunctions.MaskFunction")],wg);const l6e=wg;var k4;let Gv=k4=class extends oo{constructor(){super(...arguments),this.visibleBandID=0,this.infraredBandID=1,this.scientificOutput=!1}clone(){const{visibleBandID:t,infraredBandID:e,scientificOutput:i}=this;return new k4({visibleBandID:t,infraredBandID:e,scientificOutput:i})}};h([p({json:{write:!0}})],Gv.prototype,"visibleBandID",void 0),h([p({json:{write:!0}})],Gv.prototype,"infraredBandID",void 0),h([p({json:{write:!0}})],Gv.prototype,"scientificOutput",void 0),Gv=k4=h([P("esri.layers.support.rasterFunctions.NDVIFunctionArguments")],Gv);const c6e=Gv;let Hv=class extends ao{constructor(){super(...arguments),this.functionName="NDVI",this.functionArguments=null,this.rasterArgumentNames=["raster"]}_bindSourceRasters(){const{scientificOutput:e,visibleBandID:i,infraredBandID:n}=this.functionArguments;this.outputPixelType=this._getOutputPixelType(e?"f32":"u8");const r=this.sourceRasterInfos[0],s=Math.max(i,n);if(r.bandCount<2||s>=r.bandCount)return{success:!1,supportsGPU:!1,error:"ndvi-function: source raster has insufficient amount of raster bands"};const o=r.clone();o.pixelType=this.outputPixelType,o.colormap=null,o.histograms=null,o.bandCount=1,o.keyProperties={...o.keyProperties,BandProperties:void 0};const[a,l,c,u]=e?[-1,1,0,.1]:[0,200,100,10];return o.statistics=[{min:a,max:l,avg:c,stddev:u}],this.rasterInfo=o,{success:!0,supportsGPU:!0}}_processPixels(e){var o;const i=(o=e.pixelBlocks)==null?void 0:o[0];if(i==null)return null;const{visibleBandID:n,infraredBandID:r,scientificOutput:s}=this.functionArguments;return AFe(i,n,r,!s)}_getWebGLParameters(){const{visibleBandID:e,infraredBandID:i,scientificOutput:n}=this.functionArguments,r=this.isInputBandIdsSwizzled?[0,1,2]:[i,e,0];return{bandIndexMat3:Pr(r),scaled:!n}}_getInputBandIds(e){const{visibleBandID:i,infraredBandID:n}=this.functionArguments;return[n,i,0].map(r=>e[r])}};h([p({json:{write:!0,name:"rasterFunction"}})],Hv.prototype,"functionName",void 0),h([p({type:c6e,json:{write:!0,name:"rasterFunctionArguments"}})],Hv.prototype,"functionArguments",void 0),h([p()],Hv.prototype,"rasterArgumentNames",void 0),Hv=h([P("esri.layers.support.rasterFunctions.NDVIFunction")],Hv);const u6e=Hv;var O4;let bp=O4=class extends oo{constructor(){super(...arguments),this.inputRanges=null,this.outputValues=null,this.noDataRanges=null,this.allowUnmatched=!1,this.isLastInputRangeInclusive=!1}clone(){return new O4({inputRanges:[...this.inputRanges],outputValues:[...this.outputValues],noDataRanges:[...this.noDataRanges],allowUnmatched:this.allowUnmatched,isLastInputRangeInclusive:this.isLastInputRangeInclusive})}};h([p({json:{write:!0}})],bp.prototype,"inputRanges",void 0),h([p({json:{write:!0}})],bp.prototype,"outputValues",void 0),h([p({json:{write:!0}})],bp.prototype,"noDataRanges",void 0),h([p({json:{write:!0}})],bp.prototype,"allowUnmatched",void 0),h([p({json:{write:!0}})],bp.prototype,"isLastInputRangeInclusive",void 0),bp=O4=h([P("esri.layers.support.rasterFunctions.RemapFunctionArguments")],bp);const h6e=bp;let xg=class extends ao{constructor(){super(...arguments),this.functionName="Remap",this.functionArguments=null,this.rasterArgumentNames=["raster"],this.lookup=null}_bindSourceRasters(){const e=this.sourceRasterInfos[0].clone(),{pixelType:i}=e;this.outputPixelType=this._getOutputPixelType(i),e.pixelType=this.outputPixelType,e.colormap=null,e.histograms=null,e.bandCount=1,e.attributeTable=null;const{statistics:n}=e,{allowUnmatched:r,outputValues:s,inputRanges:o,noDataRanges:a,isLastInputRangeInclusive:l}=this.functionArguments;if(n!=null&&n.length&&(s!=null&&s.length))if(r){const c=Math.min.apply(null,[...s,n[0].min]),u=Math.max.apply(null,[...s,n[0].max]);e.statistics=[{...n[0],min:c,max:u}]}else{let c=s[0],u=c;for(let d=0;d<s.length;d++)c=c>s[d]?s[d]:c,u=u>s[d]?u:s[d];e.statistics=[{...n[0],min:c,max:u}]}return this.rasterInfo=e,this.lookup=r?null:BDe({srcPixelType:i,inputRanges:o,outputValues:s,noDataRanges:a,allowUnmatched:r,isLastInputRangeInclusive:l,outputPixelType:this.outputPixelType}),{success:!0,supportsGPU:(!s||s.length<=kh)&&(!a||a.length<=kh)}}_processPixels(e){var u;const i=(u=e.pixelBlocks)==null?void 0:u[0];if(i==null)return null;const{lookup:n,outputPixelType:r}=this;if(n){const d=UA(i,{lut:[n.lut],offset:n.offset,outputPixelType:r});return d!=null&&n.mask&&(d.mask=Ij(i.pixels[0],i.mask,n.mask,n.offset,"u8")),d}const{inputRanges:s,outputValues:o,noDataRanges:a,allowUnmatched:l,isLastInputRangeInclusive:c}=this.functionArguments;return VDe(i,{inputRanges:s,outputValues:o,noDataRanges:a,outputPixelType:r,allowUnmatched:l,isLastInputRangeInclusive:c})}_getWebGLParameters(){const{allowUnmatched:e,noDataRanges:i,isLastInputRangeInclusive:n}=this.functionArguments,r=new Float32Array(3*kh),s=1e-5,o=this.functionArguments.inputRanges??[],a=this.functionArguments.outputValues??[],l=a.length;for(let u=0;u<kh;u++)r[3*u]=o[2*u]??If-1,r[3*u+1]=o[2*u+1]??If,r[3*u+2]=a[u]??0,u<l&&(u>0&&(r[3*u]-=s),(u<l-1||!n)&&(r[3*u+1]-=s));const c=new Float32Array(2*kh);return c.fill(If),i!=null&&i.length&&c.set(i),{allowUnmatched:e,rangeMaps:r,noDataRanges:c,clampRange:Ac(this.outputPixelType)}}};h([p({json:{write:!0,name:"rasterFunction"}})],xg.prototype,"functionName",void 0),h([p({type:h6e,json:{write:!0,name:"rasterFunctionArguments"}})],xg.prototype,"functionArguments",void 0),h([p()],xg.prototype,"rasterArgumentNames",void 0),h([p({json:{write:!0}})],xg.prototype,"lookup",void 0),xg=h([P("esri.layers.support.rasterFunctions.RemapFunction")],xg);const d6e=xg;var L4;const p6e=new qe({1:"degree",2:"percent-rise",3:"adjusted"},{useNumericKeys:!0});let wp=L4=class extends oo{constructor(){super(...arguments),this.slopeType="degree",this.zFactor=1,this.pixelSizePower=.664,this.pixelSizeFactor=.024,this.removeEdgeEffect=!1}clone(){return new L4({slopeType:this.slopeType,zFactor:this.zFactor,pixelSizePower:this.pixelSizePower,pixelSizeFactor:this.pixelSizeFactor,removeEdgeEffect:this.removeEdgeEffect,raster:this.raster})}};h([be(p6e)],wp.prototype,"slopeType",void 0),h([p({type:Number,json:{write:!0}})],wp.prototype,"zFactor",void 0),h([p({type:Number,json:{name:"psPower",write:!0}})],wp.prototype,"pixelSizePower",void 0),h([p({type:Number,json:{name:"psZFactor",write:!0}})],wp.prototype,"pixelSizeFactor",void 0),h([p({type:Boolean,json:{write:!0}})],wp.prototype,"removeEdgeEffect",void 0),wp=L4=h([P("esri.layers.support.rasterFunctions.SlopeFunctionArguments")],wp);const f6e=wp;let Sg=class extends ao{constructor(){super(...arguments),this.functionName="Slope",this.functionArguments=null,this.rasterArgumentNames=["raster"],this.isGCS=!1}_bindSourceRasters(){var i;this.outputPixelType=this._getOutputPixelType("f32");const e=this.sourceRasterInfos[0].clone();return e.pixelType=this.outputPixelType,e.statistics=this.functionArguments.slopeType!=="percent-rise"?[{min:0,max:90,avg:1,stddev:1}]:null,e.histograms=null,e.colormap=null,e.attributeTable=null,e.bandCount=1,this.rasterInfo=e,this.isGCS=((i=e.spatialReference)==null?void 0:i.isGeographic)??!1,{success:!0,supportsGPU:!0}}_processPixels(e){var f;const i=(f=e.pixelBlocks)==null?void 0:f[0];if(i==null)return null;const{zFactor:n,slopeType:r,pixelSizePower:s,pixelSizeFactor:o}=this.functionArguments,{isGCS:a}=this,{extent:l,primaryPixelSizes:c}=e,u=c==null?void 0:c[0],d=u??(l?{x:l.width/i.width,y:l.height/i.height}:{x:1,y:1});return yFe(i,{zFactor:n,slopeType:r,pixelSizePower:s,pixelSizeFactor:o,isGCS:a,resolution:d})}_getWebGLParameters(){const{zFactor:e,slopeType:i,pixelSizeFactor:n,pixelSizePower:r}=this.functionArguments;return{zFactor:this.isGCS&&e>=1?e*Nh:e,slopeType:i,pixelSizeFactor:n??0,pixelSizePower:r??0}}};h([p({json:{write:!0,name:"rasterFunction"}})],Sg.prototype,"functionName",void 0),h([p({type:f6e,json:{write:!0,name:"rasterFunctionArguments"}})],Sg.prototype,"functionArguments",void 0),h([p()],Sg.prototype,"rasterArgumentNames",void 0),h([p({json:{write:!0}})],Sg.prototype,"isGCS",void 0),Sg=h([P("esri.layers.support.rasterFunctions.SlopeFunction")],Sg);const m6e=Sg;var R4;let Tg=R4=class extends oo{constructor(){super(...arguments),this.statistics=null,this.histograms=null}readStatistics(t,e){if(!(t!=null&&t.length))return null;const i=[];return t.forEach(n=>{const r={min:n.min,max:n.max,avg:n.avg??n.mean,stddev:n.stddev??n.standardDeviation};i.push(r)}),i}writeStatistics(t,e,i){if(!(t!=null&&t.length))return;const n=[];t.forEach(r=>{const s={...r,mean:r.avg,standardDeviation:r.stddev};delete s.avg,delete s.stddev,n.push(s)}),e[i]=n}clone(){return new R4({statistics:q(this.statistics),histograms:q(this.histograms)})}};h([p({json:{write:!0}})],Tg.prototype,"statistics",void 0),h([_e("statistics")],Tg.prototype,"readStatistics",null),h([ge("statistics")],Tg.prototype,"writeStatistics",null),h([p({json:{write:!0}})],Tg.prototype,"histograms",void 0),Tg=R4=h([P("esri.layers.support.rasterFunctions.StatisticsHistogramFunctionArguments")],Tg);const g6e=Tg;let xp=class extends ao{constructor(){super(...arguments),this.functionName="StatisticsHistogram",this.functionArguments=null,this.rasterArgumentNames=["raster"],this.isNoopProcess=!0}_bindSourceRasters(){const e=this.sourceRasterInfos[0];this.outputPixelType=this._getOutputPixelType("u8");const i=e.clone(),{statistics:n,histograms:r}=this.functionArguments;return r&&(i.histograms=r),n&&(i.statistics=n),this.rasterInfo=i,{success:!0,supportsGPU:!0}}_processPixels(e){var i;return(i=e.pixelBlocks)==null?void 0:i[0]}};h([p({json:{write:!0,name:"rasterFunction"}})],xp.prototype,"functionName",void 0),h([p({type:g6e,json:{write:!0,name:"rasterFunctionArguments"}})],xp.prototype,"functionArguments",void 0),h([p()],xp.prototype,"rasterArgumentNames",void 0),h([p({json:{write:!0}})],xp.prototype,"indexedColormap",void 0),h([p()],xp.prototype,"isNoopProcess",void 0),xp=h([P("esri.layers.support.rasterFunctions.StatisticsHistogramFunction")],xp);const y6e=xp;var D4;const v6e=new qe({0:"none",3:"standard-deviation",4:"histogram-equalization",5:"min-max",6:"percent-clip",9:"sigmoid"},{useNumericKeys:!0});let Zr=D4=class extends oo{constructor(){super(...arguments),this.computeGamma=!1,this.dynamicRangeAdjustment=!1,this.gamma=[],this.histograms=null,this.statistics=null,this.stretchType="none",this.useGamma=!1}writeStatistics(t,e,i){t!=null&&t.length&&(Array.isArray(t[0])||(t=t.map(n=>[n.min,n.max,n.avg,n.stddev])),e[i]=t)}clone(){return new D4({stretchType:this.stretchType,outputMin:this.outputMin,outputMax:this.outputMax,useGamma:this.useGamma,computeGamma:this.computeGamma,statistics:q(this.statistics),gamma:q(this.gamma),sigmoidStrengthLevel:this.sigmoidStrengthLevel,numberOfStandardDeviations:this.numberOfStandardDeviations,minPercent:this.minPercent,maxPercent:this.maxPercent,histograms:q(this.histograms),dynamicRangeAdjustment:this.dynamicRangeAdjustment,raster:this.raster})}};h([p({type:Boolean,json:{write:!0}})],Zr.prototype,"computeGamma",void 0),h([p({type:Boolean,json:{name:"dra",write:!0}})],Zr.prototype,"dynamicRangeAdjustment",void 0),h([p({type:[Number],json:{write:!0}})],Zr.prototype,"gamma",void 0),h([p()],Zr.prototype,"histograms",void 0),h([p({type:Number,json:{write:!0}})],Zr.prototype,"maxPercent",void 0),h([p({type:Number,json:{write:!0}})],Zr.prototype,"minPercent",void 0),h([p({type:Number,json:{write:!0}})],Zr.prototype,"numberOfStandardDeviations",void 0),h([p({type:Number,json:{name:"max",write:!0}})],Zr.prototype,"outputMax",void 0),h([p({type:Number,json:{name:"min",write:!0}})],Zr.prototype,"outputMin",void 0),h([p({type:Number,json:{write:!0}})],Zr.prototype,"sigmoidStrengthLevel",void 0),h([p({json:{type:[[Number]],write:!0}})],Zr.prototype,"statistics",void 0),h([ge("statistics")],Zr.prototype,"writeStatistics",null),h([be(v6e)],Zr.prototype,"stretchType",void 0),h([p({type:Boolean,json:{write:!0}})],Zr.prototype,"useGamma",void 0),Zr=D4=h([P("esri.layers.support.rasterFunctions.StretchFunctionArguments")],Zr);const _6e=Zr,$O=1,b6e=[.299,.587,.114];function lce(t,e=256){e=Math.min(e,256);const{size:i,counts:n}=t,r=new Uint8Array(i),s=n.reduce((u,d)=>u+d/e,0);let o=0,a=0,l=0,c=s;for(let u=0;u<i;u++)if(l+=n[u],!(u<i-1&&l+n[u+1]<c)){for(;o<e-1&&c<l;)o++,c+=s;for(let d=a;d<=u;d++)r[d]=o;a=u+1}for(let u=a;u<i;u++)r[u]=e-1;return r}function N4(t){const{minCutOff:e,maxCutOff:i,gamma:n,pixelType:r,rounding:s}=t,o=t.outMin||0,a=t.outMax||255;if(!["u8","u16","s8","s16"].includes(r))return null;const l=e.length;let c,u,d=0;r==="s8"?d=-127:r==="s16"&&(d=-32767);let f=256;["u16","s16"].includes(r)&&(f=65536);const m=[],g=[],y=a-o;for(c=0;c<l;c++)g[c]=i[c]-e[c],m[c]=g[c]===0?0:y/g[c];let _;const b=[];let w,x,S;if(n&&n.length>=l){const T=Bj(l,n);for(c=0;c<l;c++){for(S=[],u=0;u<f;u++)if(g[c]!==0)if(w=u+d,_=(w-e[c])/g[c],x=1,n[c]>1&&(x-=(1/y)**(_*T[c])),w<i[c]&&w>e[c]){const I=x*y*_**(1/n[c])+o;S[u]=s==="floor"?Math.floor(I):s==="round"?Math.round(I):I}else w>=i[c]?S[u]=a:S[u]=o;else S[u]=o;b[c]=S}}else for(c=0;c<l;c++){for(S=[],u=0;u<f;u++)if(w=u+d,w<=e[c])S[u]=o;else if(w>=i[c])S[u]=a;else{const T=(w-e[c])*m[c]+o;S[u]=s==="floor"?Math.floor(T):s==="round"?Math.round(T):T}b[c]=S}if(t.contrastOffset!=null){const T=w6e(t.contrastOffset,t.brightnessOffset);for(c=0;c<l;c++)for(S=b[c],u=0;u<f;u++)S[u]=T[S[u]]}return{lut:b,offset:d}}function w6e(t,e){const i=Math.min(Math.max(t,-100),100),n=Math.min(Math.max(e??0,-100),100),r=255,s=128;let o=0,a=0;const l=new Uint8Array(256);for(o=0;o<256;o++)i>0&&i<100?a=(200*o-100*r+2*r*n)/(2*(100-i))+s:i<=0&&i>-100?a=(200*o-100*r+2*r*n)*(100+i)/2e4+s:i===100?(a=200*o-100*r+(r+1)*(100-i)+2*r*n,a=a>0?r:0):i===-100&&(a=s),l[o]=a>r?r:a<0?0:a;return l}function x6e(t,e,i){const n=[];for(let r=0;r<e.length;r++){let s=0,o=0,a=0;"min"in e[r]?{min:s,max:o,avg:a}=e[r]:[s,o,a]=e[r];let l=a??0;t!=="u8"&&(l=255*(l-s)/(o-s)),i&&(l*=b6e[r]),n.push(S6e(l))}return n}function S6e(t){if(t<=0||t>=255)return $O;let e=0;t!==150&&(e=t<=150?45*Math.cos(.01047*t):17*Math.sin(.021*t));const i=255,n=t+e,r=Math.log(t/i),s=Math.log(n/i);if(s===0)return $O;const o=r/s;return isNaN(o)?$O:Math.min(9.9,Math.max(.01,o))}function T6e(t,e,i,n){let r=1/0,s=-1/0,o=0,a=0;const l=t.length;for(let b=0;b<l;b++){const w=t[b];e&&!e[b]||(r=w<r?w:r,s=w>s?w:s,o+=w,a++)}if(a===0)return{statistics:{min:0,max:0,avg:0,stddev:0},histogram:null};const c=o/a;let u=0;for(let b=0;b<l;b++)e&&!e[b]||(u+=(t[b]-c)**2);const d=e?e.filter(b=>b).length:l,f={min:r,max:s,avg:c,stddev:d<=1?0:Math.sqrt(u/(d-1))};if(!n)return{statistics:f,histogram:null};if(["u8","s8","u4","u2","u1"].includes(i)){const b=s-r+1,w=new Uint32Array(b);for(let x=0;x<l;x++)e&&!e[x]||w[t[x]-r]++;return{statistics:f,histogram:{min:r-.5,max:s+.5,size:b,counts:w}}}const m=256,g=new Uint32Array(m),y=(s-r)/m;if(y===0)return{statistics:f,histogram:{min:r,max:s,size:1,counts:new Uint32Array(1).fill(a)}};const _=new Uint32Array(m+1);for(let b=0;b<l;b++)e&&!e[b]||_[Math.floor((t[b]-r)/y)]++;for(let b=0;b<m-1;b++)g[b]=_[b];return g[m-1]=_[m-1]+_[m],{statistics:f,histogram:{min:r,max:s,size:m,counts:g}}}function I6e(t){const{pixels:e,mask:i,pixelType:n,bandMasks:r}=t,s=e.map((o,a)=>T6e(o,(r==null?void 0:r[a])??i,n,!0));return{statistics:s.map(({statistics:o})=>o),histograms:s.map(({histogram:o})=>o)}}function cce(t){var E;if(t==null||!((E=t.pixels)!=null&&E.length))return null;const{pixels:e,mask:i,bandMasks:n,pixelType:r}=t,s=t.width*t.height,o=e.length;let a,l,c,u,d;const f=[],m=[];let g,y,_,b,w,x,S,T,I,C;const M=256;for(u=0;u<o;u++){g=new Uint32Array(M),_=e[u];const A=(n==null?void 0:n[u])??i;if(r==="u8")if(a=-.5,l=255.5,A)for(d=0;d<s;d++)A[d]&&g[_[d]]++;else for(d=0;d<s;d++)g[_[d]]++;else{let $=!1;t.statistics||(t.updateStatistics(),$=!0);const L=t.statistics;if(a=L[u].minValue,l=L[u].maxValue,c=(l-a)/M,c===0){!L||t.validPixelCount||$||t.updateStatistics();const D=(t.validPixelCount||t.width*t.height)/M;for(let F=0;F<M;F++)g[F]=Math.round(D*(F+1))-Math.round(D*F)}else{for(y=new Uint32Array(M+1),d=0;d<s;d++)A&&!A[d]||y[Math.floor((_[d]-a)/c)]++;for(d=0;d<M-1;d++)g[d]=y[d];g[M-1]=y[M-1]+y[M]}}for(f.push({min:a,max:l,size:M,counts:g}),b=0,w=0,T=0,d=0;d<M;d++)b+=g[d],w+=d*g[d];for(I=w/b,d=0;d<M;d++)T+=g[d]*(d-I)**2;C=Math.sqrt(T/(b-1)),c=(l-a)/M,x=(I+.5)*c+a,S=C*c,m.push({min:a,max:l,avg:x,stddev:S})}return{statistics:m,histograms:f}}function jj(t){const e=[];for(let i=0;i<t.length;i++){const{min:n,max:r,size:s,counts:o}=t[i];let a=0,l=0;for(let g=0;g<s;g++)a+=o[g],l+=g*o[g];const c=l/a;let u=0;for(let g=0;g<s;g++)u+=o[g]*(g-c)**2;const d=(r-n)/s,f=(c+.5)*d+n,m=Math.sqrt(u/(a-1))*d;e.push({min:n,max:r,avg:f,stddev:m})}return e}function Zp(t,e){var A;const{pixelBlock:i,bandIds:n,returnHistogramLut:r,rasterInfo:s}=e;let o=null,a=null,l=t.stretchType;if(typeof l=="number"&&(l=hle[l]),t.dra)if(l==="minMax"&&i!=null&&i.statistics)o=i.statistics.map($=>[$.minValue,$.maxValue,0,0]);else{const $=cce(i);o=$!=null?$.statistics:null,a=$!=null?$.histograms:null}else o=((A=t.statistics)==null?void 0:A.length)>0?t.statistics:s.statistics,a="histograms"in t?t.histograms:void 0,a||(a=s.histograms);l!=="percentClip"&&l!=="histogramEqualization"||a!=null&&a.length||(l="minMax");const c=(o==null?void 0:o.length)||(a==null?void 0:a.length)||s.bandCount,u=[],d=[];let f,m,g,y,_,b,w,x,S;o&&!Array.isArray(o[0])&&(o=o.map($=>[$.min,$.max,$.avg,$.stddev]));const[T,I]=Ac(s.pixelType);if(!(o!=null&&o.length)){for(o=[],x=0;x<c;x++)o.push([T,I,1,1]);l==="standardDeviation"&&(l="minMax")}switch(l){case"none":for(x=0;x<c;x++)u[x]=T,d[x]=I;break;case"minMax":for(x=0;x<c;x++){const $=o[x];u[x]=$[0],d[x]=$[1]}break;case"standardDeviation":for(x=0;x<c;x++){const $=o[x];u[x]=$[2]-t.numberOfStandardDeviations*$[3],d[x]=$[2]+t.numberOfStandardDeviations*$[3],u[x]<$[0]&&(u[x]=$[0]),d[x]>$[1]&&(d[x]=$[1])}break;case"histogramEqualization":for(ks(a),x=0;x<c;x++)u[x]=a[x].min,d[x]=a[x].max;break;case"percentClip":for(ks(a),x=0;x<a.length;x++){for(f=a[x],_=new Uint32Array(f.size),y=[...f.counts],y.length>=20&&(y[0]=y[1]=y[2]=y[y.length-1]=y[y.length-2]=0),g=0,m=(f.max-f.min)/f.size,w=f.min===-.5&&m===1?.5:0,S=0;S<f.size;S++)g+=y[S],_[S]=g;for(b=(t.minPercent||0)*g/100,u[x]=f.min+w,S=0;S<f.size;S++)if(_[S]>b){u[x]=f.min+m*(S+w);break}for(b=(1-(t.maxPercent||0)/100)*g,d[x]=f.max+w,S=f.size-2;S>=0;S--)if(_[S]<b){d[x]=f.min+m*(S+2-w);break}if(d[x]<u[x]){const $=u[x];u[x]=d[x],d[x]=$}}break;default:for(x=0;x<c;x++){const $=o[x];u[x]=$[0],d[x]=$[1]}}let C,M,E;return l==="histogramEqualization"?(ks(a),M=a[0].size||256,C=0,r&&(E=a.map($=>lce($)))):(M=t.max||255,C=t.min||0),C6e({minCutOff:u,maxCutOff:d,outMax:M,outMin:C,histogramLut:E},n)}function C6e(t,e){if(e==null||e.length===0)return t;const i=Math.max.apply(null,e),{minCutOff:n,maxCutOff:r,outMin:s,outMax:o,histogramLut:a}=t;return n.length===e.length||n.length<=i?t:{minCutOff:e.map(l=>n[l]),maxCutOff:e.map(l=>r[l]),histogramLut:a?e.map(l=>a[l]):null,outMin:s,outMax:o}}function Bj(t,e){const i=new Float32Array(t);for(let n=0;n<t;n++)e[n]>1?e[n]>2?i[n]=6.5+(e[n]-2)**2.5:i[n]=6.5+100*(2-e[n])**4:i[n]=1;return i}function KM(t,e){var C;if(t==null||!((C=t.pixels)!=null&&C.length))return t;const{mask:i,bandMasks:n,width:r,height:s,pixels:o}=t,{minCutOff:a,maxCutOff:l,gamma:c}=e,u=e.outMin||0,d=e.outMax||255,f=r*s,m=e.outputPixelType||"u8",g=t.pixels.map(()=>ue.createEmptyBand(m,f)),y=g.length,_=d-u,b=[],w=[];for(let M=0;M<y;M++)w[M]=l[M]-a[M],b[M]=w[M]===0?0:_/w[M];const x=m.startsWith("u")||m.startsWith("s"),S=c&&c.length>=y,T=!!e.isRenderer;if(S){const M=Bj(y,c);for(let E=0;E<y;E++){const A=(n==null?void 0:n[E])??i;for(let $=0;$<f;$++)if(A==null||A[$]){if(w[E]===0){g[E][$]=u;continue}const L=o[E][$],D=(L-a[E])/w[E];let F=1;if(c[E]>1&&(F-=(1/_)**(D*M[E])),L<l[E]&&L>a[E]){const z=F*_*D**(1/c[E])+u;g[E][$]=T?Math.floor(z):x?Math.round(z):z}else L>=l[E]?g[E][$]=d:g[E][$]=u}}}else for(let M=0;M<y;M++){const E=(n==null?void 0:n[M])??i;for(let A=0;A<f;A++)if(E==null||E[A]){const $=o[M][A];if($<l[M]&&$>a[M]){const L=($-a[M])*b[M]+u;g[M][A]=T?Math.floor(L):x?Math.round(L):L}else $>=l[M]?g[M][A]=d:g[M][A]=u}}const I=new ue({width:r,height:s,mask:i,bandMasks:n,pixels:g,pixelType:m});return I.updateStatistics(),I}let Sp=class extends ao{constructor(){super(...arguments),this.functionName="Stretch",this.functionArguments=null,this.rasterArgumentNames=["raster"],this.lookup=null,this.cutOffs=null}_bindSourceRasters(){this.lookup=null,this.cutOffs=null;const e=this.sourceRasterInfos[0],{pixelType:i}=e,{functionArguments:n}=this,{dynamicRangeAdjustment:r,gamma:s,useGamma:o}=n;if(!r&&["u8","u16","s8","s16"].includes(i)){const l=Zp(n.toJSON(),{rasterInfo:e}),c=this._isOutputRoundingNeeded()?"round":"float";this.lookup=N4({pixelType:i,...l,gamma:o?s:null,rounding:c}),this.cutOffs=l}else r||(this.cutOffs=Zp(n.toJSON(),{rasterInfo:e}));this.outputPixelType=this._getOutputPixelType(i);const a=e.clone();return a.pixelType=this.outputPixelType,a.statistics=null,a.histograms=null,a.colormap=null,a.attributeTable=null,this.outputPixelType==="u8"&&(a.keyProperties.DataType="processed"),this.rasterInfo=a,{success:!0,supportsGPU:!r}}_processPixels(e){var a;const i=(a=e.pixelBlocks)==null?void 0:a[0];if(i==null)return i;const{lookup:n}=this;if(n)return UA(i,{...n,outputPixelType:this.rasterInfo.pixelType});const{functionArguments:r}=this,s=this.cutOffs||Zp(r.toJSON(),{rasterInfo:this.sourceRasterInfos[0],pixelBlock:i}),o=r.useGamma?r.gamma:null;return KM(i,{...s,gamma:o,outputPixelType:this.outputPixelType})}_getWebGLParameters(){const{outputMin:e=0,outputMax:i=255,gamma:n,useGamma:r}=this.functionArguments,s=this.rasterInfo.bandCount>=2?3:1,o=r&&n&&n.length?Bj(s,n):[1,1,1],{minCutOff:a,maxCutOff:l}=this.cutOffs??{minCutOff:[0,0,0],maxCutOff:[255,255,255]};a.length===1&&(a[1]=a[2]=a[0],l[1]=l[2]=l[0]);const c=new Float32Array(s);let u;for(u=0;u<s;u++)c[u]=(i-e)/(l[u]-a[u]);const d=this._isOutputRoundingNeeded();return{bandCount:s,outMin:e,outMax:i,minCutOff:a,maxCutOff:l,factor:c,useGamma:r,gamma:r&&n?n:[1,1,1],gammaCorrection:r&&o?o:[1,1,1],stretchType:this.functionArguments.stretchType,isOutputRounded:d,type:"stretch"}}};h([p({json:{write:!0,name:"rasterFunction"}})],Sp.prototype,"functionName",void 0),h([p({type:_6e,json:{write:!0,name:"rasterFunctionArguments"}})],Sp.prototype,"functionArguments",void 0),h([p()],Sp.prototype,"rasterArgumentNames",void 0),h([p({json:{write:!0}})],Sp.prototype,"lookup",void 0),h([p({json:{write:!0}})],Sp.prototype,"cutOffs",void 0),Sp=h([P("esri.layers.support.rasterFunctions.StretchFunction")],Sp);const M6e=Sp;var F4;let QM=F4=class extends oo{constructor(){super(...arguments),this.attributeTableAsRecordSet=null}clone(){return new F4({attributeTableAsRecordSet:q(this.attributeTableAsRecordSet)})}};h([p({json:{write:!0}})],QM.prototype,"attributeTableAsRecordSet",void 0),QM=F4=h([P("esri.layers.support.rasterFunctions.TableFunctionArguments")],QM);const E6e=QM;let Ig=class extends ao{constructor(){super(...arguments),this.functionName="Table",this.functionArguments=null,this.rasterArgumentNames=["raster"],this.isNoopProcess=!0}_bindSourceRasters(){const e=this.sourceRasterInfos[0];if(e.bandCount>1||e.pixelType.startsWith("f"))return{success:!1,supportsGPU:!1,error:"table-function: Source data must be single band and integer pixel type."};const{attributeTableAsRecordSet:i}=this.functionArguments;if(!i)return{success:!1,supportsGPU:!1,error:"table-function: Missing attributeTableAsRecordSet argument."};this.outputPixelType=this._getOutputPixelType(e.pixelType);const n=e.clone();return n.pixelType=this.outputPixelType,n.bandCount=1,n.dataType!=="thematic"&&(n.keyProperties=n.keyProperties?{...n.keyProperties,DataType:"thematic"}:{DataType:"thematic"}),this.rasterInfo=n,{success:!0,supportsGPU:!0}}_processPixels(e){var i;return(i=e.pixelBlocks)==null?void 0:i[0]}};h([p({json:{write:!0,name:"rasterFunction"}})],Ig.prototype,"functionName",void 0),h([p({type:E6e,json:{write:!0,name:"rasterFunctionArguments"}})],Ig.prototype,"functionArguments",void 0),h([p()],Ig.prototype,"rasterArgumentNames",void 0),h([p()],Ig.prototype,"isNoopProcess",void 0),Ig=h([P("esri.layers.support.rasterFunctions.TableFunction")],Ig);const A6e=Ig,Kr=new Map;function uce(t,e){const{rasterFunctionArguments:i}=t;i&&(i.rasters||[i.raster]).forEach(n=>{n&&typeof n!="number"&&(typeof n=="string"?n.startsWith("http")&&(e.includes(n)||e.push(n)):"rasterFunctionArguments"in n&&uce(n,e))})}function z4(t,e){if(e=e??{},"function"in(t=q(t))&&"arguments"in t&&t.arguments){const i=pce(t,new Map,e);if(B4(i),!i.renderingRule)throw new V("raster-function-helper","Unsupported raster function json.");t=i.renderingRule}if("rasterFunction"in t)return hce(t=V4(t),e);throw new V("raster-function-helper","unsupported raster function json.")}function $6e(t,e){return e[0]==="rasters"&&Array.isArray(t.rasters)?t.rasters:e.map(i=>t[i])}function mq(t){return!!(t&&typeof t=="object"&&t.rasterFunction&&t.rasterFunctionArguments)}function V4(t){var r;const{rasterFunction:e,rasterFunctionArguments:i}=t,n={};for(const s in i){let o=i[s];const a=s.toLowerCase();if(a==="rasters"&&Array.isArray(o))n.rasters=o.map(l=>mq(l)?V4(l):l);else switch(mq(o)&&(o=V4(o)),a){case"dra":n.dra=o;break;case"pspower":n.psPower=o;break;case"pszfactor":n.psZFactor=o;break;case"bandids":n.bandIds=o;break;default:n[s[0].toLowerCase()+s.slice(1)]=o}}return e!=="Local"||(r=n.rasters)!=null&&r.length||(n.rasters=["$$"]),{...t,rasterFunctionArguments:n}}function hce(t,e){var f,m;const{rasterFunction:i,rasterFunctionArguments:n}=t,r=(f=t.outputPixelType)==null?void 0:f.toLowerCase();if(i==null||!Kr.has(i))throw new V("raster-function-helper",`unsupported raster function: ${i}`);const s=Kr.get(i),o=(typeof s.ctor=="function"?s.ctor:s.ctor.default).fromJSON({...t,outputPixelType:r}),{rasterArgumentNames:a}=o,l=[],c=$6e(n,a),u=a[0]==="rasters",d=[];for(let g=0;g<c.length;g++){const y=c[g];let _;y==null||typeof y=="string"&&y.startsWith("$")?l.push(e==null?void 0:e.raster):typeof y=="string"?e[y]&&l.push(e[y]):typeof y!="number"&&"rasterFunction"in y&&(_=hce(y,e),u||(o.functionArguments[a[g]]=_),l.push(_)),u&&d.push(_??y)}if(u&&(o.functionArguments.rasters=d),e){o.sourceRasters=l;const g=(m=e.raster)==null?void 0:m.url;g&&(o.mainPrimaryRasterId=g)}return o}function dce(t,e){if(t&&e)for(const i in t){const n=t[i];n&&typeof n=="object"&&"type"in n&&(n.type==="RasterFunctionTemplate"?dce(n.arguments,e):n.type==="RasterFunctionVariable"&&e[n.name]!=null&&(n.value=e[n.name]))}}function j4(t,e){var r;if(!t||typeof t!="object")return t;const{value:i}=t;if(!i||typeof i!="object")return t.isDataset?"$$":i;if(Array.isArray(i))return i.length===0?[]:i.map(s=>typeof s=="object"&&s.type==="RasterFunctionVariable"?j4(s,e):s);if("value"in i&&["number","string","boolean"].includes(typeof i.value))return i.value;if(t.isDataset&&i.type!=="Scalar")return"$$";if(!("type"in i))return i;let n=i;switch(i.type){case"Scalar":n=i.value;break;case"AlgorithmicColorRamp":n=gq(i);break;case"MultiPartColorRamp":n={type:"multipart",colorRamps:i.ArrayOfColorRamp.map(gq)};break;case"ArgumentArray":if((r=i.elements)!=null&&r.length&&i.elements[0].type!=="RasterStatistics"){const s=[];for(let o=0;o<i.elements.length;o++){const a=i.elements[o],{type:l}=a;if(l)if(l==="RasterFunctionTemplate"){const{renderingRule:c}=pce(a,e);s.push(c),a._object_id!=null&&e.set(a._object_id,c)}else{if(l!=="RasterFunctionVariable")throw new V("raster-function-helper","unsupported raster function json.");{const c=j4(a,e);s.push(c),a._object_id!=null&&e.set(a._object_id,c)}}else s.push(a)}n=s}else n=i.elements}return i._object_id!=null&&e.set(i._object_id,n),n}function gq(t){const e=t.algorithm??"esriHSVAlgorithm";let{FromColor:i,ToColor:n}=t;if(!Array.isArray(i)){const{r,g:s,b:o}=Bf({h:i.Hue,s:i.Saturation,v:i.Value});i=[r,s,o,i.AlphaValue]}if(!Array.isArray(n)){const{r,g:s,b:o}=Bf({h:n.Hue,s:n.Saturation,v:n.Value});n=[r,s,o,n.AlphaValue]}return{type:"algorithmic",algorithm:e,fromColor:i,toColor:n}}function pce(t,e,i){i&&dce(t,i);const n={renderingRule:{},templates:e};return fce(t,n),n}function fce(t,e){if(!t||!e.renderingRule)return;const{renderingRule:i,templates:n}=e,{function:r,arguments:s,_object_id:o}=t;if(!r||!s)return;o!=null&&n.set(o,i),i.rasterFunction=r.type.replace("Function",""),i.outputPixelType=r.pixelType;const a={};i.rasterFunctionArguments=a;for(const l in s){if(l==="type"||l==="object_id"||l==="_object_ref_id")continue;const c=s[l];c&&typeof c=="object"&&"type"in c&&(c.type==="RasterFunctionTemplate"||c.type==="RasterFunctionVariable")?(c.type==="RasterFunctionVariable"?a[l]=j4(c,n):(i.rasterFunctionArguments[l]={},fce(c,{renderingRule:i.rasterFunctionArguments[l],templates:n})),c._object_id!=null&&n.set(c._object_id,a[l])):a[l]=c}switch(a.DEM&&!a.Raster&&(a.Raster=a.DEM,delete a.DEM),i.rasterFunction){case"Stretch":P6e(a);break;case"Colormap":k6e(a);break;case"Convolution":O6e(a);break;case"Mask":L6e(a)}}function B4(t){const{renderingRule:e,templates:i}=t;if(typeof e!="object"||!(e!=null&&e.rasterFunctionArguments)||!i.size)return;const{rasterFunctionArguments:n}=e;for(const r in n){const s=n[r],o=r==="_object_ref_id"?s:s&&typeof s=="object"&&"_object_ref_id"in s?s._object_ref_id:null;if(o==null)s&&typeof s=="object"&&(s.rasterFunctionArguments&&B4({renderingRule:s,templates:i}),Array.isArray(s)&&s.forEach((a,l)=>{if(typeof a=="object")if(a._object_ref_id!=null){if(!i.has(a._object_ref_id))throw new V("raster-function-helper",`unsupported raster function json. _object_ref_id: ${s} does not exist`);const c=i.get(o);c&&typeof c=="object"?Object.assign(a,c):s[l]=c}else B4({renderingRule:a,templates:i})}));else{if(!i.has(o))throw new V("raster-function-helper",`unsupported raster function json. _object_ref_id: ${o} does not exist`);const a=i.get(o);r!=="_object_ref_id"?n[r]=a:a&&typeof a=="object"&&Object.assign(n,a)}}}function P6e(t){var e;(e=t.Statistics)!=null&&e.length&&typeof t.Statistics=="object"&&(t.Statistics=t.Statistics.map(i=>[i.min,i.max,i.mean,i.standardDeviation])),t.NumberOfStandardDeviation!=null&&(t.NumberOfStandardDeviations=t.NumberOfStandardDeviation,delete t.NumberOfStandardDeviation)}function k6e(t){var e,i;((i=(e=t.ColorRamp)==null?void 0:e.type)==null?void 0:i.toLowerCase())==="randomcolorramp"&&(delete t.ColorRamp,t.ColormapName="Random"),t.ColorSchemeType===0&&delete t.ColorRamp}function O6e(t){t.ConvolutionType!=null&&(t.Type=t.ConvolutionType,delete t.ConvolutionType)}function L6e(t){var e;(e=t.NoDataValues)!=null&&e.length&&typeof t.NoDataValues[0]=="string"&&(t.NoDataValues=t.NoDataValues.filter(i=>i!=="").map(i=>Number(i)))}Kr.set("Aspect",{desc:"Aspect Function",ctor:bFe,rasterArgumentNames:["raster"]}),Kr.set("BandArithmetic",{desc:"Band Arithmetic Function",ctor:WFe,rasterArgumentNames:["raster"]}),Kr.set("Colormap",{desc:"Colormap Function",ctor:nze,rasterArgumentNames:["raster"]}),Kr.set("CompositeBand",{desc:"CompositeBand Function",ctor:sze,rasterArgumentNames:["rasters"]}),Kr.set("Convolution",{desc:"Convolution Function",ctor:fze,rasterArgumentNames:["raster"]}),Kr.set("ExtractBand",{desc:"ExtractBand Function",ctor:vze,rasterArgumentNames:["raster"]}),Kr.set("Curvature",{desc:"Curvature Function",ctor:gze,rasterArgumentNames:["raster"]}),Kr.set("Local",{desc:"Local Function",ctor:o6e,rasterArgumentNames:["rasters"]}),Kr.set("Mask",{desc:"Mask Function",ctor:l6e,rasterArgumentNames:["raster"]}),Kr.set("NDVI",{desc:"NDVI Function",ctor:u6e,rasterArgumentNames:["raster"]}),Kr.set("Remap",{desc:"Remap Function",ctor:d6e,rasterArgumentNames:["raster"]}),Kr.set("Slope",{desc:"Slope Function",ctor:m6e,rasterArgumentNames:["raster"]}),Kr.set("StatisticsHistogram",{desc:"Statistics Histogram Function",ctor:y6e,rasterArgumentNames:["raster"]}),Kr.set("Stretch",{desc:"Stretch Function",ctor:M6e,rasterArgumentNames:["raster"]}),Kr.set("Table",{desc:"Attribute Table Function",ctor:A6e,rasterArgumentNames:["raster"]});function R6e(t){var e,i,n;return["u8","s8"].includes(t.pixelType)&&((i=(e=t.statistics)==null?void 0:e[0])==null?void 0:i.min)!=null&&((n=t.statistics[0])==null?void 0:n.max)!=null&&t.bandCount===1}function Uj(t,e){const{attributeTable:i,bandCount:n}=t;return i==null&&R6e(t)?!0:!(i==null||n>1||e&&i.fields.find(r=>r.name.toLowerCase()===e.toLowerCase())==null)}function mce(t){const{bandCount:e,dataType:i,pixelType:n}=t;return i==="elevation"||i==="generic"&&e===1&&(n==="s16"||n==="s32"||n==="f32"||n==="f64")}function Gj(t,e=!1){const{bandCount:i,colormap:n,pixelType:r}=t;return i===1&&(!!(n!=null&&n.length)||!e&&r==="u8")}function D6e(t,e=!1){const{attributeTable:i,bandCount:n}=t;return n===1&&(!e||i!=null||t.histograms!=null)}function Hj(t){const{dataType:e}=t;return e==="vector-uv"||e==="vector-magdir"}function N6e(t){const{dataType:e}=t;return e==="vector-uv"||e==="vector-magdir"}const yq=new qe({esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation",esriClassifyDefinedInterval:"defined-interval"}),vq=new qe({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:"percent-of-total",esriNormalizeByField:"field"});let Yl=class extends ie{constructor(e){super(e),this.type="class-breaks-definition",this.breakCount=null,this.classificationField=null,this.classificationMethod=null,this.normalizationField=null,this.normalizationType=null}set standardDeviationInterval(e){this.classificationMethod==="standard-deviation"&&this._set("standardDeviationInterval",e)}set definedInterval(e){this.classificationMethod==="defined-interval"&&this._set("definedInterval",e)}};h([be({classBreaksDef:"class-breaks-definition"})],Yl.prototype,"type",void 0),h([p({json:{write:!0}})],Yl.prototype,"breakCount",void 0),h([p({json:{write:!0}})],Yl.prototype,"classificationField",void 0),h([p({type:String,json:{read:yq.read,write:yq.write}})],Yl.prototype,"classificationMethod",void 0),h([p({json:{write:!0}})],Yl.prototype,"normalizationField",void 0),h([p({json:{read:vq.read,write:vq.write}})],Yl.prototype,"normalizationType",void 0),h([p({value:null,json:{write:!0}})],Yl.prototype,"standardDeviationInterval",null),h([p({value:null,json:{write:!0}})],Yl.prototype,"definedInterval",null),Yl=h([P("esri.rest.support.ClassBreaksDefinition")],Yl);const Fft=Yl,F6e=ne.getLogger("esri.rest.support.generateRendererUtils");function D0(t,e){return Number(t.toFixed(e))}function zft(t){const{normalizationTotal:e}=t;return{classBreaks:z6e(t),normalizationTotal:e}}function z6e(t){const e=t.definition,{classificationMethod:i,normalizationType:n,definedInterval:r}=e,s=e.breakCount??1,o=[];let a=t.values;if(a.length===0)return[];a=a.sort((u,d)=>u-d);const l=a[0],c=a[a.length-1];if(i==="equal-interval")if(a.length>=s){const u=(c-l)/s;let d=l;for(let f=1;f<s;f++){const m=D0(l+f*u,6);o.push({minValue:d,maxValue:m,label:ho(d,m,n)}),d=m}o.push({minValue:d,maxValue:c,label:ho(d,c,n)})}else a.forEach(u=>{o.push({minValue:u,maxValue:u,label:ho(u,u,n)})});else if(i==="natural-breaks"){const u=V6e(a),d=t.valueFrequency||u.valueFrequency,f=j6e(u.uniqueValues,d,s);let m=l;for(let g=1;g<s;g++)if(u.uniqueValues.length>g){const y=D0(u.uniqueValues[f[g]],6);o.push({minValue:m,maxValue:y,label:ho(m,y,n)}),m=y}o.push({minValue:m,maxValue:c,label:ho(m,c,n)})}else if(i==="quantile")if(a.length>=s&&l!==c){let u=l,d=Math.ceil(a.length/s),f=0;for(let m=1;m<s;m++){let g=d+f-1;g>a.length&&(g=a.length-1),g<0&&(g=0),o.push({minValue:u,maxValue:a[g],label:ho(u,a[g],n)}),u=a[g],f+=d,d=Math.ceil((a.length-f)/(s-m))}o.push({minValue:u,maxValue:c,label:ho(u,c,n)})}else{let u=-1;for(let d=0;d<a.length;d++){const f=a[d];f!==u&&(u=f,o.push({minValue:u,maxValue:f,label:ho(u,f,n)}),u=f)}}else if(i==="standard-deviation"){const u=G6e(a),d=H6e(a,u);if(d===0)o.push({minValue:a[0],maxValue:a[0],label:ho(a[0],a[0],n)});else{const f=U6e(l,c,s,u,d)*d;let m=0,g=l;for(let _=s;_>=1;_--){const b=D0(u-(_-.5)*f,6);o.push({minValue:g,maxValue:b,label:ho(g,b,n)}),g=b,m++}let y=D0(u+.5*f,6);o.push({minValue:g,maxValue:y,label:ho(g,y,n)}),g=y,m++;for(let _=1;_<=s;_++)y=m===2*s?c:D0(u+(_+.5)*f,6),o.push({minValue:g,maxValue:y,label:ho(g,y,n)}),g=y,m++}}else if(i==="defined-interval"){if(!r)return o;const u=a[0],d=a[a.length-1],f=Math.ceil((d-u)/r);let m=u;for(let g=1;g<f;g++){const y=D0(u+g*r,6);o.push({minValue:m,maxValue:y,label:ho(m,y,n)}),m=y}o.push({minValue:m,maxValue:d,label:ho(m,d,n)})}return o}function ho(t,e,i){let n=null;return n=t===e?i&&i==="percent-of-total"?t+"%":t.toString():i&&i==="percent-of-total"?t+"% - "+e+"%":t+" - "+e,n}function V6e(t){const e=[],i=[];let n=Number.MIN_VALUE,r=1,s=-1;for(let o=0;o<t.length;o++){const a=t[o];a===n?(r++,i[s]=r):a!==null&&(e.push(a),n=a,r=1,i.push(r),s++)}return{uniqueValues:e,valueFrequency:i}}function j6e(t,e,i){const n=t.length,r=[];i>n&&(i=n);for(let o=0;o<i;o++)r.push(Math.round(o*n/i-1));r.push(n-1);let s=_q(r,t,e,i);return B6e(s.mean,s.sdcm,r,t,e,i)&&(s=_q(r,t,e,i)),r}function _q(t,e,i,n){let r=[],s=[],o=[],a=0;const l=[],c=[];for(let m=0;m<n;m++){const g=f_(m,t,e,i);l.push(g.sbMean),c.push(g.sbSdcm),a+=c[m]}let u,d=a,f=!0;for(;f||a<d;){f=!1,r=[];for(let m=0;m<n;m++)r.push(t[m]);for(let m=0;m<n;m++)for(let g=t[m]+1;g<=t[m+1];g++)if(u=e[g],m>0&&g!==t[m+1]&&Math.abs(u-l[m])>Math.abs(u-l[m-1]))t[m]=g;else if(m<n-1&&t[m]!==g-1&&Math.abs(u-l[m])>Math.abs(u-l[m+1])){t[m+1]=g-1;break}d=a,a=0,s=[],o=[];for(let m=0;m<n;m++){s.push(l[m]),o.push(c[m]);const g=f_(m,t,e,i);l[m]=g.sbMean,c[m]=g.sbSdcm,a+=c[m]}}if(a>d){for(let m=0;m<n;m++)t[m]=r[m],l[m]=s[m],c[m]=o[m];a=d}return{mean:l,sdcm:c}}function B6e(t,e,i,n,r,s){let o=0,a=0,l=0,c=0,u=!0;for(let d=0;d<2&&u;d++){d===0&&(u=!1);for(let f=0;f<s-1;f++)for(;i[f+1]+1!==i[f+2];){i[f+1]=i[f+1]+1;const m=f_(f,i,n,r);l=m.sbMean,o=m.sbSdcm;const g=f_(f+1,i,n,r);if(c=g.sbMean,a=g.sbSdcm,!(o+a<e[f]+e[f+1])){i[f+1]=i[f+1]-1;break}e[f]=o,e[f+1]=a,t[f]=l,t[f+1]=c,u=!0}for(let f=s-1;f>0;f--)for(;i[f]!==i[f-1]+1;){i[f]=i[f]-1;const m=f_(f-1,i,n,r);l=m.sbMean,o=m.sbSdcm;const g=f_(f,i,n,r);if(c=g.sbMean,a=g.sbSdcm,!(o+a<e[f-1]+e[f])){i[f]=i[f]+1;break}e[f-1]=o,e[f]=a,t[f-1]=l,t[f]=c,u=!0}}return u}function U6e(t,e,i,n,r){let s=Math.max(n-t,e-n)/r/i;return s=s>=1?1:s>=.5?.5:.25,s}function G6e(t){let e=0;for(let i=0;i<t.length;i++)e+=t[i];return e/=t.length,e}function H6e(t,e){let i=0;for(let n=0;n<t.length;n++){const r=t[n];i+=(r-e)*(r-e)}return i/=t.length,Math.sqrt(i)}function f_(t,e,i,n){let r=0,s=0;for(let l=e[t]+1;l<=e[t+1];l++){const c=n[l];r+=i[l]*c,s+=c}s<=0&&F6e.warn("Exception in Natural Breaks calculation");const o=r/s;let a=0;for(let l=e[t]+1;l<=e[t+1];l++)a+=n[l]*(i[l]-o)**2;return{sbMean:o,sbSdcm:a}}const q6e=.25,W6e=FP.fromJSON({type:"multipart",colorRamps:[{fromColor:[0,0,255],toColor:[0,255,255]},{fromColor:[0,255,255],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,0,0]}]}),bq=FP.fromJSON(wj[0]),gce=new Set(["scientific","standard-time","vector-uv","vector-magdir","vector-u","vector-v","vector-magnitude","vector-direction"]);function wq(t,e){const{attributeTable:i,colormap:n}=t;if(Hj(t)){const r=iVe(t);if(r!=null)return r}if(n!=null){const r=eVe(t);if(r!=null)return r}if(i!=null){const r=K6e(t);if(r!=null)return r}return Z6e(t,e)}function Vft(t,e=!1){const i=["raster-stretch"];return Gj(t,e)&&i.push("raster-colormap"),Uj(t)&&i.push("unique-value"),D6e(t,e)&&i.push("class-breaks"),mce(t)&&i.push("raster-shaded-relief"),Hj(t)&&i.push("vector-field"),N6e(t)&&i.push("flow"),i}function J6e(t,e,i){const n=["nearest","bilinear","cubic","majority"].find(r=>r===(i==null?void 0:i.toLowerCase()));return e==="Map"?n??"bilinear":t.dataType==="standard-time"?n??"nearest":t.dataType==="thematic"||t.attributeTable||t.colormap?n==="nearest"||n==="majority"?n:"nearest":n??"bilinear"}function Z6e(t,e){t=U4(t,e==null?void 0:e.variableName);const{bandCount:i}=t;let{bandIds:n,stretchType:r}=e||{};n!=null&&n.some(d=>d>=i)&&(n=null);let s=t.statistics,o=t.histograms;i>1?(n=n!=null&&n.length?n:yce(t),s=s==null?null:n==null?void 0:n.map(d=>s[d]),o=o==null?null:n==null?void 0:n.map(d=>o[d])):n=[0],r==null&&(r=X6e(t));let a=!1;switch(r){case"none":a=!1;break;case"percent-clip":a=!(o!=null&&o.length);break;default:a=!(s!=null&&s.length)}const{dataType:l}=t,c=(n==null?void 0:n.length)===1&&gce.has(l)?W6e:null,u=new Tj({stretchType:r,dynamicRangeAdjustment:a,colorRamp:c,outputMin:0,outputMax:255,gamma:(n==null?void 0:n.length)===1?[1]:[1,1,1],useGamma:!1});return r==="percent-clip"?u.maxPercent=u.minPercent=q6e:r==="standard-deviation"&&(u.numberOfStandardDeviations=2),a||t.multidimensionalInfo==null&&!(e!=null&&e.includeStatisticsInStretch)||(r==="percent-clip"?u.histograms=o:r!=="min-max"&&r!=="standard-deviation"||(u.statistics=s)),u}function U4(t,e){if(!e)return t;let i=t.statistics,n=t.histograms;const{multidimensionalInfo:r}=t;if(e&&r!=null){const s=r.variables.find(o=>o.name===e);if(s){const{statistics:o,histograms:a}=s;o!=null&&o.length&&(i=o),a!=null&&a.length&&(n=a)}}return yd.fromJSON({...t.toJSON(),statistics:i,histograms:n})}function yce(t){const e=t.bandCount;if(e===1)return null;if(e===2)return[0];const{bandInfos:i}=t;let n;if(i.length===e){const{red:r,green:s,blue:o,nir:a}=Y6e(i);r!=null&&s!=null&&o!=null?n=[r,s,o]:a!=null&&r!=null&&s!=null&&(n=[a,r,s])}return!n&&e>=3&&(n=[0,1,2]),n}function Y6e(t){const e={};for(let i=0;i<t.length;i++){const n=t[i],r=n.name.toLowerCase();if(r==="red")e.red=i;else if(r==="green")e.green=i;else if(r==="blue")e.blue=i;else if(r==="nearinfrared"||r==="nearinfrared_1"||r==="nir")e.nir=i;else if(n.maxWavelength&&n.minWavelength){const s=n.minWavelength,o=n.maxWavelength;e.blue==null&&s>=410&&s<=480&&o>=480&&o<=540?e.blue=i:e.green==null&&s>=490&&s<=560&&o>=560&&o<=610?e.green=i:e.red==null&&s>=595&&s<=670&&o>=660&&o<=730?e.red=i:e.nir==null&&s>=700&&s<=860&&o>=800&&o<=950&&(e.nir=i)}}return e}function X6e(t){let e="percent-clip";const{pixelType:i,dataType:n,histograms:r,statistics:s,multidimensionalInfo:o}=t,a=gce.has(n)||n==="generic"&&o!=null;return i!=="u8"||n!=="processed"&&r!=null&&s!=null?i==="u8"||n==="elevation"||a?e="min-max":r!=null?e="percent-clip":s!=null&&(e="min-max"):e="none",e}function K6e(t,e,i,n){if(!Uj(t,e))return null;const{attributeTable:r,statistics:s}=t,o=vce(r,e),a=Yx(r,"red"),l=Yx(r,"green"),c=Yx(r,"blue"),u=new rT,d=[],f=new Set,m=!!(a&&l&&c);if(r!=null)r.features.forEach(g=>{const y=g.attributes[o.name];if(!f.has(g.attributes[o.name])&&y!=null){f.add(y);const _=m&&(a.type==="single"||a.type==="double")&&(l.type==="single"||l.type==="double")&&(c.type==="single"||c.type==="double")&&!r.features.some(w=>w.attributes[a.name]>1||w.attributes[l.name]>1||w.attributes[c.name]>1),b=_?255:1;d.push(new xy({value:g.attributes[o.name],label:g.attributes[o.name]+"",symbol:{type:"simple-fill",style:"solid",outline:null,color:new ae(m?[g.attributes[a.name]*b,g.attributes[l.name]*b,g.attributes[c.name]*b,1]:[0,0,0,0])}}))}});else if(s!=null&&s[0])for(let g=s[0].min;g<=s[0].max;g++)d.push(new xy({value:g,label:g.toString(),symbol:{type:"simple-fill",style:"solid",outline:null,color:new ae([0,0,0,0])}}));if(d.sort((g,y)=>g.value&&typeof g.value.valueOf()=="string"?0:g.value>y.value?1:-1),!m){const g=qy(bq,{numColors:d.length});d.forEach((y,_)=>y.symbol.color=new ae(g[_].slice(1,4))),u.colorRamp=bq}if(i||n){const g=i||qy(n,{numColors:d.length}).map(y=>y.slice(1));d.forEach((y,_)=>y.symbol.color=new ae(g[_])),u.colorRamp=n}return new Kb({field:o.name,uniqueValueInfos:d,authoringInfo:u})}function vce(t,e,i){let n;return t!=null?(n=e?t.fields.find(r=>e.toLowerCase()===r.name.toLowerCase()):Q6e(t.fields),n||(i||(n=t.fields.find(r=>r.type==="string")),n||(n=Yx(t,"value")))):n=new dc({name:"value"}),n}function Q6e(t){let e;for(let i=0;i<t.length;i++){const n=t[i].name.toLowerCase();if(t[i].type==="string"){if(n.startsWith("class")){e=t[i];break}e==null&&(n.endsWith("name")||n.endsWith("type"))&&(e=t[i])}}return e}function Yx(t,e){return t==null?null:t.fields.find(i=>i.name.toLowerCase()===e)}function eVe(t){if(!Gj(t))return null;let e;const{attributeTable:i,colormap:n}=t;if(i!=null){const r=Yx(i,"value"),s=vce(i,null,!0);s.type==="string"&&(e={},i.features.forEach(o=>{const a=o.attributes;e[a[r.name]]=s?a[s.name]:a[r.name]}))}return Sj.createFromColormap(n,e)}const tVe=new Map([["m/s","meter-per-second"],["km/h","kilometer-per-hour"],["knots","knots"],["ft/s","feet-per-second"],["mph","mile-per-hour"]]);function iVe(t){if(!Hj(t))return null;let e;if(t.statistics!=null&&t.statistics.length&&(t.dataType==="vector-magdir"||t.dataType==="vector-uv")){const{minMagnitude:r,maxMagnitude:s}=nVe(t.dataType,t.statistics);e=[{type:"size",field:"Magnitude",minSize:10,maxSize:40,minDataValue:r,maxDataValue:s}]}const i=t.multidimensionalInfo!=null?tVe.get(t.multidimensionalInfo.variables[0].unit):null,n=new Aj({visualVariables:e,inputUnit:i,rotationType:"geographic"});return n.visualVariables=[...n.sizeVariables,...n.rotationVariables],n}function xq(t){var e;return{color:(e=t.symbolLayers[0].material)==null?void 0:e.color,type:"esriSFS",style:"esriSFSSolid"}}function Sq(t){var e,i;if(t.type==="uniqueValue"){const n=t.uniqueValueInfos,r=n==null?void 0:n[0].symbol;return(e=r==null?void 0:r.symbolLayers)!=null&&e.length&&(t.uniqueValueInfos=n==null?void 0:n.map(s=>({value:s.value,label:s.label,symbol:s.symbol?xq(s.symbol):null}))),t}if(t.type==="classBreaks"){const n=t.classBreakInfos,r=n[0].symbol;return(i=r==null?void 0:r.symbolLayers)!=null&&i.length&&(t.classBreakInfos=n.map(s=>({classMinValue:s.classMinValue,classMaxValue:s.classMaxValue,label:s.label,symbol:s.symbol?xq(s.symbol):null}))),t}return t}function nVe(t,e){let i,n;if(t==="vector-magdir")i=e[0].min,n=e[0].max;else{const r=e[0].min,s=e[0].max,o=e[1].min,a=e[1].max;i=0,n=Math.max(Math.abs(r),Math.abs(o),Math.abs(s),Math.abs(a))}return{minMagnitude:i,maxMagnitude:n}}let Cg=class extends ie{constructor(e){super(e)}bind(){const{rendererJSON:e}=this;if(!e)return{success:!1};let i;switch(this.lookup={rendererJSON:{}},e.type){case"uniqueValue":i=this._updateUVRenderer(e);break;case"rasterColormap":i=this._updateColormapRenderer(e);break;case"rasterStretch":i=this._updateStretchRenderer(e);break;case"classBreaks":i=this._updateClassBreaksRenderer(e);break;case"rasterShadedRelief":i=this._updateShadedReliefRenderer(e);break;case"vectorField":i=this._updateVectorFieldRenderer();break;case"flowRenderer":i=this._updateFlowRenderer()}return i}symbolize(e){let i=e&&e.pixelBlock;if(!Tq(i))return i;if(e.simpleStretchParams&&this.rendererJSON.type==="rasterStretch")return this.simpleStretch(i,e.simpleStretchParams);try{let n;switch(i.pixels.length>3&&(i=i.extractBands([0,1,2])),this.rendererJSON.type){case"uniqueValue":case"rasterColormap":n=this._symbolizeColormap(i);break;case"classBreaks":n=this._symbolizeClassBreaks(i);break;case"rasterStretch":n=this._symbolizeStretch(i,e.bandIds);break;case"rasterShadedRelief":{const r=e.extent,s=r.spatialReference.isGeographic,o={x:(r.xmax-r.xmin)/i.width,y:(r.ymax-r.ymin)/i.height};n=this._symbolizeShadedRelief(i,{isGCS:s,resolution:o});break}}return n}catch(n){return ne.getLogger(this).error("symbolize",n.message),i}}simpleStretch(e,i){if(!Tq(e))return e;try{return e.pixels.length>3&&(e=e.extractBands([0,1,2])),KM(e,{...i,isRenderer:!0})}catch(n){return ne.getLogger(this).error("symbolize",n.message),e}}generateWebGLParameters(e){if(["uniqueValue","rasterColormap","classBreaks"].includes(this.rendererJSON.type)){const{indexedColormap:a,offset:l}=this.lookup.colormapLut||{};return{colormap:a,colormapOffset:l,type:"lut"}}const{pixelBlock:i,isGCS:n,resolution:r,bandIds:s}=e,{rendererJSON:o}=this;return o.type==="rasterStretch"?this._generateStretchWebGLParams(i,o,s):o.type==="rasterShadedRelief"?this._generateShadedReliefWebGLParams(o,n,r??void 0):o.type==="vectorField"?this._generateVectorFieldWebGLParams(o):null}_isLUTChanged(e){if(!this.lookup||!this.lookup.rendererJSON)return!0;if("colorRamp"in this.rendererJSON){const i=this.rendererJSON.colorRamp;return e?JSON.stringify(i)!==JSON.stringify(this.lookup.rendererJSON.colorRamp):(this.rendererJSON,this.lookup.rendererJSON,JSON.stringify(this.rendererJSON)!==JSON.stringify(this.lookup.rendererJSON))}return JSON.stringify(this.rendererJSON)!==JSON.stringify(this.lookup.rendererJSON)}_symbolizeColormap(e){return this._isLUTChanged()&&!this.bind().success?e:mO(e,this.lookup.colormapLut)}_symbolizeClassBreaks(e){const{canUseIndexedLUT:i}=this._analyzeClassBreaks(this.rendererJSON);return this._isLUTChanged()&&!this.bind().success?e:i?mO(e,this.lookup.colormapLut):zDe(e,this.lookup.remapLut??[])}_symbolizeStretch(e,i){var f,m;const{rasterInfo:n}=this,{pixelType:r,bandCount:s}=n,o=this.rendererJSON,a=["u8","u16","s8","s16"].includes(r);let l,c;const{dra:u}=o,{gamma:d}=this.lookup;if(o.stretchType==="histogramEqualization"){const g=u?null:(f=this.lookup)==null?void 0:f.histogramLut,y=Zp(o,{rasterInfo:n,pixelBlock:e,bandIds:i,returnHistogramLut:!g}),_=KM(e,{...y,gamma:d,isRenderer:!0});c=UA(_,{lut:u?y.histogramLut:g,offset:0})}else if(a){if(u){const g=Zp(o,{rasterInfo:n,pixelBlock:e,bandIds:i});l=N4({pixelType:r,...g,gamma:d,rounding:"floor"})}else if(this._isLUTChanged()){if(!this.bind().success)return e;l=this.lookup?this.lookup.stretchLut:null}else l=this.lookup?this.lookup.stretchLut:null;if(!l)return e;s>1&&i!=null&&i.length===(e==null?void 0:e.pixels.length)&&(l==null?void 0:l.lut.length)===s&&(l={lut:i.map(g=>l.lut[g]),offset:l.offset}),c=UA(e,l)}else{const g=Zp(o,{rasterInfo:n,pixelBlock:e,bandIds:i});c=KM(e,{...g,gamma:d,isRenderer:!0})}if(o.colorRamp){if(this._isLUTChanged(!0)&&!this.bind().success)return e;c=mO(c,(m=this.lookup)==null?void 0:m.colormapLut)}return c}_symbolizeShadedRelief(e,i){var l;const n=this.rendererJSON,r={...n,...i},s=mFe(e,r);if(!n.colorRamp)return s;let o;if(this._isLUTChanged(!0)){if(!this.bind().success)return s;o=this.lookup?this.lookup.hsvMap:null}else o=this.lookup?this.lookup.hsvMap:null;if(!o)return s;const a=((l=this.rasterInfo.statistics)==null?void 0:l[0])??{min:0,max:8e3};return gFe(s,e,o,a),s}_isVectorFieldData(){const{bandCount:e,dataType:i}=this.rasterInfo;return e===2&&(i==="vector-magdir"||i==="vector-uv")}_updateVectorFieldRenderer(){return this._isVectorFieldData()?{success:!0}:{success:!1,error:`Unsupported data type "${this.rasterInfo.dataType}"; VectorFieldRenderer only supports "vector-magdir" and "vector-uv".`}}_updateFlowRenderer(){return this._isVectorFieldData()?{success:!0}:{success:!1,error:`Unsupported data type "${this.rasterInfo.dataType}"; FlowRenderer only supports "vector-magdir" and "vector-uv".`}}_updateUVRenderer(e){var u;const{bandCount:i,attributeTable:n,pixelType:r}=this.rasterInfo,s=e.field1;if(!s)return{success:!1,error:"Unsupported renderer; missing UniqueValueRenderer.field."};const o=e.defaultSymbol,a=i===1&&["u8","s8"].includes(r);if(!Uj(this.rasterInfo,s)&&!a)return{success:!1,error:"Unsupported data; UniqueValueRenderer is only supported on single band data with a valid raster attribute table."};const l=[];if(n!=null){const d=n.fields.find(f=>f.name.toLowerCase()==="value");if(!d)return{success:!1,error:"Unsupported data; the data's raster attribute table does not have a value field."};n.features.forEach(f=>{var y,_;const m=(y=e.uniqueValueInfos)==null?void 0:y.find(b=>String(b.value)===String(f.attributes[s])),g=(_=m==null?void 0:m.symbol)==null?void 0:_.color;g?l.push([f.attributes[d.name]].concat(g)):o&&l.push([f.attributes[d.name]].concat(o.color))})}else{if(s.toLowerCase()!=="value")return{success:!1,error:'Unsupported renderer; UniqueValueRenderer.field must be "Value" when raster attribute table is not availalbe.'};(u=e.uniqueValueInfos)==null||u.forEach(d=>{var m;const f=(m=d==null?void 0:d.symbol)==null?void 0:m.color;f?l.push([parseInt(""+d.value,10)].concat(f)):o&&l.push([parseInt(""+d.value,10)].concat(o==null?void 0:o.color))})}if(l.length===0)return{success:!1,error:"Invalid UniqueValueRenderer. Cannot find matching records in the raster attribute table."};const c=k1({colormap:l});return this.lookup={rendererJSON:e,colormapLut:c},this.canRenderInWebGL=!0,{success:!0}}_updateColormapRenderer(e){if(!Gj(this.rasterInfo))return{success:!1,error:"Unsupported data; the data source does not have a colormap."};const i=e.colormapInfos.map(r=>[r.value].concat(r.color)).sort((r,s)=>r[0]-s[0]);if(!i||i.length===0)return{success:!1,error:"Unsupported renderer; ColormapRenderer must have meaningful colormapInfos."};const n=k1({colormap:i});return this.lookup={rendererJSON:e,colormapLut:n},this.canRenderInWebGL=!0,{success:!0}}_updateShadedReliefRenderer(e){if(!mce(this.rasterInfo))return{success:!1,error:`Unsupported data type "${this.rasterInfo.dataType}"; ShadedReliefRenderer only supports "elevation", or single band float/s16 data.`};if(e.colorRamp){const i=qy(e.colorRamp,{interpolateAlpha:!0}),n=k1({colormap:i}),r=[],s=n.indexedColormap;for(let o=0;o<s.length;o+=4){const a=Hy({r:s[o],g:s[o+1],b:s[o+2]});r.push([a.h/60,a.s/100,255*a.v/100])}this.lookup={rendererJSON:e,colormapLut:n,hsvMap:r}}else this.lookup=null;return this.canRenderInWebGL=!0,{success:!0}}_analyzeClassBreaks(e){const{attributeTable:i,pixelType:n}=this.rasterInfo,r=i!=null?i.fields.find(a=>a.name.toLowerCase()==="value"):null,s=i!=null?i.fields.find(a=>a.name.toLowerCase()===e.field.toLowerCase()):null,o=r!=null&&s!==null;return{canUseIndexedLUT:["u8","u16","s8","s16"].includes(n)||o,tableValueField:r,tableBreakField:s}}_updateClassBreaksRenderer(e){const{attributeTable:i}=this.rasterInfo,{canUseIndexedLUT:n,tableValueField:r,tableBreakField:s}=this._analyzeClassBreaks(e),o=e.classBreakInfos;if(!(o!=null&&o.length))return{success:!1,error:"Unsupported renderer; missing or invalid ClassBreaksRenderer.classBreakInfos."};const a=o.sort((f,m)=>f.classMaxValue-m.classMaxValue),l=a[a.length-1];let c=e.minValue;if(!n){const f=[];for(let m=0;m<a.length;m++)f.push({value:a[m].classMinValue??c,mappedColor:a[m].symbol.color}),c=a[m].classMaxValue;return f.push({value:l.classMaxValue,mappedColor:l.symbol.color}),this.lookup={rendererJSON:e,remapLut:f},this.canRenderInWebGL=!1,{success:!0}}const u=[];if(i!=null&&r!=null&&s!==null&&r!==s){const f=r.name,m=s.name,g=a[a.length-1],{classMaxValue:y}=g;c=e.minValue;for(const _ of i.features){const b=_.attributes[f],w=_.attributes[m],x=w===y?g:w<c?null:a.find(({classMaxValue:S})=>S>w);x&&u.push([b].concat(x.symbol.color))}}else{c=Math.floor(e.minValue);for(let f=0;f<a.length;f++){const m=a[f];for(let g=c;g<m.classMaxValue;g++)u.push([g].concat(m.symbol.color));c=Math.ceil(m.classMaxValue)}l.classMaxValue===c&&u.push([l.classMaxValue].concat(l.symbol.color))}const d=k1({colormap:u,fillUnspecified:!1});return this.lookup={rendererJSON:e,colormapLut:d},this.canRenderInWebGL=!0,{success:!0}}_isHistogramRequired(e){return e==="percentClip"||e==="histogramEqualization"}_isValidRasterStatistics(e){return e!=null&&e.length>0&&e[0].min!=null&&e[0].max!=null}_updateStretchRenderer(e){var d,f;let{stretchType:i,dra:n}=e;if(!(i==="none"||(d=e.statistics)!=null&&d.length||this._isValidRasterStatistics(this.rasterInfo.statistics)||n))return{success:!1,error:"Unsupported renderer; StretchRenderer.statistics is required when dynamic range adjustment is not used."};const r=e.histograms||this.rasterInfo.histograms;!this._isHistogramRequired(e.stretchType)||r!=null&&r.length||n||(i="minMax");const{computeGamma:s,useGamma:o,colorRamp:a}=e;let{gamma:l}=e;if(o&&s&&!(l!=null&&l.length)){const m=(f=e.statistics)!=null&&f.length?e.statistics:this.rasterInfo.statistics;l=x6e(this.rasterInfo.pixelType,m)}const c=this.rasterInfo.pixelType,u=!n&&["u8","u16","s8","s16"].includes(c);if(i==="histogramEqualization"){const m=r.map(g=>lce(g));this.lookup={rendererJSON:e,histogramLut:m}}else if(u){const m=Zp(e,{rasterInfo:this.rasterInfo}),g=N4({pixelType:c,...m,gamma:o?l:null,rounding:"floor"});this.lookup={rendererJSON:e,stretchLut:g}}if(a){const m=qy(a,{interpolateAlpha:!0});this.lookup||(this.lookup={rendererJSON:e}),this.lookup.colormapLut=k1({colormap:m}),this.lookup.rendererJSON=e}return this.lookup.gamma=o&&(l!=null&&l.length)?l:null,this.canRenderInWebGL=!0,{success:!0}}_generateStretchWebGLParams(e,i,n){let r=null,s=null;const o=this.lookup&&this.lookup.colormapLut;i.colorRamp&&o&&(r=o.indexedColormap,s=o.offset),i.stretchType==="histogramEqualization"&&(i={...i,stretchType:"minMax"});const{gamma:a}=this.lookup,l=!!(i.useGamma&&a&&a.some(S=>S!==1)),{minCutOff:c,maxCutOff:u,outMin:d,outMax:f}=Zp(i,{rasterInfo:this.rasterInfo,pixelBlock:e,bandIds:n});let m=0;e!=null&&(m=e.getPlaneCount(),m===2&&((e=e.clone()).statistics=[e.statistics[0]],e.pixels=[e.pixels[0]]));const{bandCount:g}=this.rasterInfo,y=Math.min(3,(n==null?void 0:n.length)||m||g,g),_=new Float32Array(y),b=r||l?1:255;let w;for(w=0;w<c.length;w++)_[w]=u[w]===c[w]?0:(f-d)/(u[w]-c[w])/b;const x=new Float32Array(y);if(l&&a)for(w=0;w<y;w++)a[w]>1?a[w]>2?x[w]=6.5+(a[w]-2)**2.5:x[w]=6.5+100*(2-a[w])**4:x[w]=1;return{bandCount:y,outMin:d/b,outMax:f/b,minCutOff:c,maxCutOff:u,factor:_,useGamma:l,gamma:l?a:[1,1,1],gammaCorrection:l?x:[1,1,1],colormap:r,colormapOffset:s,stretchType:i.stretchType,type:"stretch"}}_generateShadedReliefWebGLParams(e,i=!1,n={x:0,y:0}){var u;let r=null,s=null;const o=this.lookup&&this.lookup.colormapLut;e.colorRamp&&o&&(r=o.indexedColormap,s=o.offset);const a={...e,isGCS:i,resolution:n},l=ice(a),c=(u=this.rasterInfo.statistics)==null?void 0:u[0];return{...l,minValue:(c==null?void 0:c.min)??0,maxValue:(c==null?void 0:c.max)??8e3,hillshadeType:e.hillshadeType==="traditional"?0:1,type:"hillshade",colormap:r,colormapOffset:s}}_generateVectorFieldWebGLParams(e){var w,x,S;const{style:i,inputUnit:n,outputUnit:r,visualVariables:s,symbolTileSize:o,flowRepresentation:a}=e;let l;const c=((w=this.rasterInfo.statistics)==null?void 0:w[0].min)??0,u=((x=this.rasterInfo.statistics)==null?void 0:x[0].max)??50,d=(s==null?void 0:s.find(T=>T.type==="sizeInfo"))??{type:"sizeInfo",field:"Magnitude",maxDataValue:u,maxSize:.8*o,minDataValue:c,minSize:.2*o},f=d.minDataValue??c,m=d.maxDataValue??u,g=d.maxSize!=null&&d.minSize!=null?[d.minSize/o,d.maxSize/o]:[.2,.8];if(i==="wind_speed"){const T=(g[0]+g[1])/2;g[0]=g[1]=T}const y=f!=null&&m!=null?[f,m]:null;if(i==="classified_arrow")if(f!=null&&m!=null&&d!=null){l=[];const T=(d.maxDataValue-d.minDataValue)/5;for(let I=0;I<6;I++)l.push(d.minDataValue+T*I)}else l=[0,1e-6,3.5,7,10.5,14];const _=a==="flow_to"==(i==="ocean_current_kn"||i==="ocean_current_m")?0:Math.PI,b=s==null?void 0:s.find(T=>T.type==="rotationInfo");return{breakValues:l,dataRange:y,inputUnit:n,outputUnit:r,symbolTileSize:o,symbolPercentRange:g,style:i||"single_arrow",rotation:_,rotationType:(S=this.rasterInfo.storageInfo)!=null&&S.tileInfo&&this.rasterInfo.dataType==="vector-uv"?"geographic":(b==null?void 0:b.rotationType)||e.rotationType,type:"vectorField"}}};function Tq(t){return Ci(t)&&t.validPixelCount!==0}h([p({json:{write:!0}})],Cg.prototype,"rendererJSON",void 0),h([p({type:yd,json:{write:!0}})],Cg.prototype,"rasterInfo",void 0),h([p({json:{write:!0}})],Cg.prototype,"lookup",void 0),h([p()],Cg.prototype,"canRenderInWebGL",void 0),Cg=h([P("esri.renderers.support.RasterSymbolizer")],Cg);const rVe=Cg;var G4;const Xx=Nn()({MT_FIRST:"first",MT_LAST:"last",MT_MIN:"min",MT_MAX:"max",MT_MEAN:"mean",MT_BLEND:"blend",MT_SUM:"sum"}),H4=Nn()({esriMosaicNone:"none",esriMosaicCenter:"center",esriMosaicNadir:"nadir",esriMosaicViewpoint:"viewpoint",esriMosaicAttribute:"attribute",esriMosaicLockRaster:"lock-raster",esriMosaicNorthwest:"northwest",esriMosaicSeamline:"seamline"});function sVe(t){let e;switch(t?t.toLowerCase().replace("esrimosaic",""):""){case"byattribute":case"attribute":e="esriMosaicAttribute";break;case"lockraster":e="esriMosaicLockRaster";break;case"center":e="esriMosaicCenter";break;case"northwest":e="esriMosaicNorthwest";break;case"nadir":e="esriMosaicNadir";break;case"viewpoint":e="esriMosaicViewpoint";break;case"seamline":e="esriMosaicSeamline";break;default:e="esriMosaicNone"}return H4.fromJSON(e)}let qn=G4=class extends ie{constructor(t){super(t),this.ascending=!0,this.itemRasterFunction=null,this.lockRasterIds=null,this.method=null,this.multidimensionalDefinition=null,this.objectIds=null,this.operation=null,this.sortField=null,this.sortValue=null,this.viewpoint=null,this.where=null}readAscending(t,e){return e.ascending!=null?e.ascending:e.sortAscending==null||e.sortAscending}get itemRenderingRule(){return C2(ne.getLogger(this),"itemRenderingRule",{replacement:"itemRasterFunction",version:"4.27",warnOnce:!0}),this._get("itemRasterFunction")}set itemRenderingRule(t){C2(ne.getLogger(this),"itemRenderingRule",{replacement:"itemRasterFunction",version:"4.27",warnOnce:!0}),this._set("itemRasterFunction",t)}readMethod(t,e){return sVe(e.mosaicMethod||e.defaultMosaicMethod)}writeMultidimensionalDefinition(t,e,i){t!=null&&(t=t.filter(({variableName:n,dimensionName:r})=>n&&n!=="*"||r)).length&&(e[i]=t.map(n=>n.toJSON()))}readOperation(t,e){const i=e.mosaicOperation,n=e.mosaicOperator&&e.mosaicOperator.toLowerCase(),r=i||(n?Xx.toJSON(n):null);return Xx.fromJSON(r)||"first"}castSortValue(t){return t==null||typeof t=="string"||typeof t=="number"?t:`${t}`}clone(){return new G4({ascending:this.ascending,itemRasterFunction:q(this.itemRasterFunction),lockRasterIds:q(this.lockRasterIds),method:this.method,multidimensionalDefinition:q(this.multidimensionalDefinition),objectIds:q(this.objectIds),operation:this.operation,sortField:this.sortField,sortValue:this.sortValue,viewpoint:q(this.viewpoint),where:this.where})}};h([p({type:Boolean,json:{write:!0}})],qn.prototype,"ascending",void 0),h([_e("ascending",["ascending","sortAscending"])],qn.prototype,"readAscending",null),h([p({type:Jy,json:{name:"itemRenderingRule",write:!0}})],qn.prototype,"itemRasterFunction",void 0),h([p({type:Jy})],qn.prototype,"itemRenderingRule",null),h([p({type:[It],json:{write:{overridePolicy(){return{enabled:this.method==="lock-raster"}}}}})],qn.prototype,"lockRasterIds",void 0),h([p({type:String,json:{type:H4.jsonValues,write:{target:"mosaicMethod",writer:H4.write}}})],qn.prototype,"method",void 0),h([_e("method",["mosaicMethod","defaultMosaicMethod"])],qn.prototype,"readMethod",null),h([p({type:[Wy],json:{write:!0}})],qn.prototype,"multidimensionalDefinition",void 0),h([ge("multidimensionalDefinition")],qn.prototype,"writeMultidimensionalDefinition",null),h([p({type:[It],json:{name:"fids",write:!0}})],qn.prototype,"objectIds",void 0),h([p({json:{type:Xx.jsonValues,read:{reader:Xx.read},write:{target:"mosaicOperation",writer:Xx.write}}})],qn.prototype,"operation",void 0),h([_e("operation",["mosaicOperation","mosaicOperator"])],qn.prototype,"readOperation",null),h([p({type:String,json:{write:{overridePolicy(){return{enabled:this.method==="attribute"}}}}})],qn.prototype,"sortField",void 0),h([p({type:[String,Number],json:{write:{allowNull:!0,overridePolicy(){return{enabled:this.method==="attribute",allowNull:!0}}}}})],qn.prototype,"sortValue",void 0),h([ut("sortValue")],qn.prototype,"castSortValue",null),h([p({type:pe,json:{write:!0}})],qn.prototype,"viewpoint",void 0),h([p({type:String,json:{write:!0}})],qn.prototype,"where",void 0),qn=G4=h([P("esri.layers.support.MosaicRule")],qn);const oVe=qn;var q4;let Xl=q4=class extends ie{constructor(){super(...arguments),this.geometry=null,this.mosaicRule=null,this.rasterFunction=null,this.pixelSize=null,this.raster=void 0,this.timeExtent=null}writeGeometry(t,e,i){t!=null&&(e.geometryType=Db(t),e[i]=t.toJSON())}get renderingRule(){return C2(ne.getLogger(this),"renderingRule",{replacement:"rasterFunction",version:"4.27",warnOnce:!0}),this._get("rasterFunction")}set renderingRule(t){C2(ne.getLogger(this),"renderingRule",{replacement:"rasterFunction",version:"4.27",warnOnce:!0}),this._set("rasterFunction",t)}clone(){return new q4(q({geometry:this.geometry,mosaicRule:this.mosaicRule,rasterFunction:this.rasterFunction,pixelSize:this.pixelSize,raster:this.raster,timeExtent:this.timeExtent}))}};h([p({types:r0,json:{read:ad}})],Xl.prototype,"geometry",void 0),h([ge("geometry")],Xl.prototype,"writeGeometry",null),h([p({type:oVe,json:{write:!0}})],Xl.prototype,"mosaicRule",void 0),h([p({type:Jy})],Xl.prototype,"renderingRule",null),h([p({type:Jy,json:{write:!0,name:"renderingRule"}})],Xl.prototype,"rasterFunction",void 0),h([p({type:pe,json:{write:!0}})],Xl.prototype,"pixelSize",void 0),h([p({json:{write:!0}})],Xl.prototype,"raster",void 0),h([p({type:Bu,json:{read:{source:"time"},write:{target:"time"}}})],Xl.prototype,"timeExtent",void 0),Xl=q4=h([P("esri.rest.support.ImageHistogramParameters")],Xl);const aVe=Xl,lc=ne.getLogger("esri.views.2d.engine.flow.dataUtils"),lVe=10;async function cVe(t,e,i,n){const r=performance.now(),s=uVe(e,i),o=performance.now(),a=dVe(e,s,i.width,i.height),l=performance.now(),c=fVe(a,!0),u=performance.now(),d=t==="Streamlines"?mVe(c,lVe):gVe(c),f=performance.now();return ee("esri-2d-profiler")&&(lc.info("I.1","_createFlowFieldFromData (ms)",Math.round(o-r)),lc.info("I.2","_getStreamlines (ms)",Math.round(l-o)),lc.info("I.3","createAnimatedLinesData (ms)",Math.round(u-l)),lc.info("I.4","create{Streamlines|Particles}Mesh (ms)",Math.round(f-u)),lc.info("I.5","createFlowMesh (ms)",Math.round(f-r)),lc.info("I.6","Mesh size (bytes)",d.vertexData.buffer.byteLength+d.indexData.buffer.byteLength)),await Promise.resolve(),Vt(n),d}function uVe(t,e){const i=pVe(e.data,e.width,e.height,t.smoothing);return t.interpolate?(n,r)=>{const s=Math.floor(n),o=Math.floor(r);if(s<0||s>=e.width)return[0,0];if(o<0||o>=e.height)return[0,0];const a=n-s,l=r-o,c=s,u=o,d=s<e.width-1?s+1:s,f=o<e.height-1?o+1:o,m=i[2*(u*e.width+c)],g=i[2*(u*e.width+d)],y=i[2*(f*e.width+c)],_=i[2*(f*e.width+d)],b=i[2*(u*e.width+c)+1],w=i[2*(u*e.width+d)+1];return[(m*(1-l)+y*l)*(1-a)+(g*(1-l)+_*l)*a,(b*(1-l)+i[2*(f*e.width+c)+1]*l)*(1-a)+(w*(1-l)+i[2*(f*e.width+d)+1]*l)*a]}:(n,r)=>{const s=Math.round(n),o=Math.round(r);return s<0||s>=e.width||o<0||o>=e.height?[0,0]:[i[2*(o*e.width+s)],i[2*(o*e.width+s)+1]]}}function hVe(t,e,i,n,r,s,o,a,l){const c=[];let u=i,d=n,f=0,[m,g]=e(u,d);m*=t.velocityScale,g*=t.velocityScale;const y=Math.sqrt(m*m+g*g);let _,b;c.push({x:u,y:d,t:f,speed:y});for(let w=0;w<t.verticesPerLine;w++){let[x,S]=e(u,d);x*=t.velocityScale,S*=t.velocityScale;const T=Math.sqrt(x*x+S*S);if(T<t.minSpeedThreshold)return c;const I=x/T,C=S/T;if(u+=I*t.segmentLength,d+=C*t.segmentLength,f+=t.segmentLength/T,Math.acos(I*_+C*b)>t.maxTurnAngle)return c;if(t.collisions){const M=Math.round(u*l),E=Math.round(d*l);if(M<0||M>o-1||E<0||E>a-1)return c;const A=s[E*o+M];if(A!==-1&&A!==r)return c;s[E*o+M]=r}c.push({x:u,y:d,t:f,speed:T}),_=I,b=C}return c}function dVe(t,e,i,n){const r=[],s=new Mx,o=1/Math.max(t.lineCollisionWidth,1),a=Math.round(i*o),l=Math.round(n*o),c=new Int32Array(a*l);for(let d=0;d<c.length;d++)c[d]=-1;const u=[];for(let d=0;d<n;d+=t.lineSpacing)for(let f=0;f<i;f+=t.lineSpacing)u.push({x:f,y:d,sort:s.getFloat()});u.sort((d,f)=>d.sort-f.sort);for(const{x:d,y:f}of u)if(s.getFloat()<t.density){const m=hVe(t,e,d,f,r.length,c,a,l,o);if(m.length<2)continue;r.push(m)}return r}function pVe(t,e,i,n){if(n===0)return t;const r=Math.round(3*n),s=new Array(2*r+1);let o=0;for(let c=-r;c<=r;c++){const u=Math.exp(-c*c/(n*n));s[c+r]=u,o+=u}for(let c=-r;c<=r;c++)s[c+r]/=o;const a=new Float32Array(t.length);for(let c=0;c<i;c++)for(let u=0;u<e;u++){let d=0,f=0;for(let m=-r;m<=r;m++){if(u+m<0||u+m>=e)continue;const g=s[m+r];d+=g*t[2*(c*e+(u+m))],f+=g*t[2*(c*e+(u+m))+1]}a[2*(c*e+u)]=d,a[2*(c*e+u)+1]=f}const l=new Float32Array(t.length);for(let c=0;c<e;c++)for(let u=0;u<i;u++){let d=0,f=0;for(let m=-r;m<=r;m++){if(u+m<0||u+m>=i)continue;const g=s[m+r];d+=g*a[2*((u+m)*e+c)],f+=g*a[2*((u+m)*e+c)+1]}l[2*(u*e+c)]=d,l[2*(u*e+c)+1]=f}return l}function fVe(t,e){const i=new Mx,n=t.reduce((l,c)=>l+c.length,0),r=new Float32Array(4*n),s=new Array(t.length);let o=0,a=0;for(const l of t){const c=o;for(const u of l)r[4*o]=u.x,r[4*o+1]=u.y,r[4*o+2]=u.t,r[4*o+3]=u.speed,o++;s[a++]={startVertex:c,numberOfVertices:l.length,totalTime:l[l.length-1].t,timeSeed:e?i.getFloat():0}}return{lineVertices:r,lineDescriptors:s}}function mVe(t,e){const{lineVertices:n,lineDescriptors:r}=t;let s=0,o=0;for(const m of r)s+=2*m.numberOfVertices,o+=6*(m.numberOfVertices-1);const a=new Float32Array(s*9),l=new Uint32Array(o);let c=0,u=0;function d(){l[u++]=c-2,l[u++]=c,l[u++]=c-1,l[u++]=c,l[u++]=c+1,l[u++]=c-1}function f(m,g,y,_,b,w,x,S){const T=c*9;let I=0;a[T+I++]=m,a[T+I++]=g,a[T+I++]=1,a[T+I++]=y,a[T+I++]=w,a[T+I++]=x,a[T+I++]=_/2,a[T+I++]=b/2,a[T+I++]=S,c++,a[T+I++]=m,a[T+I++]=g,a[T+I++]=-1,a[T+I++]=y,a[T+I++]=w,a[T+I++]=x,a[T+I++]=-_/2,a[T+I++]=-b/2,a[T+I++]=S,c++}for(const m of r){const{totalTime:g,timeSeed:y}=m;let _=null,b=null,w=null,x=null,S=null,T=null;for(let I=0;I<m.numberOfVertices;I++){const C=n[4*(m.startVertex+I)],M=n[4*(m.startVertex+I)+1],E=n[4*(m.startVertex+I)+2],A=n[4*(m.startVertex+I)+3];let $=null,L=null,D=null,F=null;if(I>0){$=C-_,L=M-b;const z=Math.sqrt($*$+L*L);if($/=z,L/=z,I>1){let U=$+S,G=L+T;const W=Math.sqrt(U*U+G*G);U/=W,G/=W;const Z=Math.min(1/(U*$+G*L),e);U*=Z,G*=Z,D=-G,F=U}else D=-L,F=$;D!==null&&F!==null&&(f(_,b,w,D,F,g,y,A),d())}_=C,b=M,w=E,S=$,T=L,x=A}f(_,b,w,-T,S,g,y,x)}return{vertexData:a,indexData:l}}function gVe(t){const{lineVertices:r,lineDescriptors:s}=t;let o=0,a=0;for(const z of s){const U=z.numberOfVertices-1;o+=4*U*2,a+=6*U*2}const l=new Float32Array(o*16),c=new Uint32Array(a);let u,d,f,m,g,y,_,b,w,x,S,T,I,C,M=0,E=0;function A(){c[E++]=M-8,c[E++]=M-7,c[E++]=M-6,c[E++]=M-7,c[E++]=M-5,c[E++]=M-6,c[E++]=M-4,c[E++]=M-3,c[E++]=M-2,c[E++]=M-3,c[E++]=M-1,c[E++]=M-2}function $(z,U,G,W,Z,X,oe,se,le,de,we,Re,ze,Ct){const Ae=M*16;let ke=0;for(const jt of[1,2])for(const gn of[1,2,3,4])l[Ae+ke++]=z,l[Ae+ke++]=U,l[Ae+ke++]=G,l[Ae+ke++]=W,l[Ae+ke++]=oe,l[Ae+ke++]=se,l[Ae+ke++]=le,l[Ae+ke++]=de,l[Ae+ke++]=jt,l[Ae+ke++]=gn,l[Ae+ke++]=ze,l[Ae+ke++]=Ct,l[Ae+ke++]=Z/2,l[Ae+ke++]=X/2,l[Ae+ke++]=we/2,l[Ae+ke++]=Re/2,M++}function L(z,U){let G=w+S,W=x+T;const Z=Math.sqrt(G*G+W*W);G/=Z,W/=Z;const X=w*G+x*W;G/=X,W/=X;let oe=S+I,se=T+C;const le=Math.sqrt(oe*oe+se*se);oe/=le,se/=le;const de=S*oe+T*se;oe/=de,se/=de,$(u,d,f,m,-W,G,g,y,_,b,-se,oe,z,U),A()}function D(z,U,G,W,Z,X){if(w=S,x=T,S=I,T=C,w==null&&x==null&&(w=S,x=T),g!=null&&y!=null){I=z-g,C=U-y;const oe=Math.sqrt(I*I+C*C);I/=oe,C/=oe}w!=null&&x!=null&&L(Z,X),u=g,d=y,f=_,m=b,g=z,y=U,_=G,b=W}function F(z,U){w=S,x=T,S=I,T=C,w==null&&x==null&&(w=S,x=T),w!=null&&x!=null&&L(z,U)}for(const z of s){u=null,d=null,f=null,m=null,g=null,y=null,_=null,b=null,w=null,x=null,S=null,T=null,I=null,C=null;const{totalTime:U,timeSeed:G}=z;for(let W=0;W<z.numberOfVertices;W++)D(r[4*(z.startVertex+W)],r[4*(z.startVertex+W)+1],r[4*(z.startVertex+W)+2],r[4*(z.startVertex+W)+3],U,G);F(U,G)}return{vertexData:l,indexData:c}}function Iq(t,e){const i=e.pixels,{width:n,height:r}=e,s=new Float32Array(n*r*2),o=e.mask||new Uint8Array(n*r*2);if(e.mask||o.fill(255),t==="vector-uv")for(let a=0;a<n*r;a++)s[2*a]=i[0][a],s[2*a+1]=-i[1][a];else if(t==="vector-magdir")for(let a=0;a<n*r;a++){const l=i[0][a],c=_ee(i[1][a]),u=Math.cos(c-Math.PI/2),d=Math.sin(c-Math.PI/2);s[2*a]=u*l,s[2*a+1]=d*l}return{data:s,mask:o,width:n,height:r}}async function Bft(t,e,i,n,r,s){const o=performance.now(),a=to(e.spatialReference);if(!a){const S=await Cq(t,e,i,n,r,s);return ee("esri-2d-profiler")&&lc.info("I.7","loadImagery, early exit (ms)",Math.round(performance.now()-o)),ee("esri-2d-profiler")&&lc.info("I.9","Number of parts",1),S}const[l,c]=a.valid,u=c-l,d=Math.ceil(e.width/u),f=e.width/d,m=Math.round(i/d);let g=e.xmin;const y=[],_=performance.now();for(let S=0;S<d;S++){const T=new Le({xmin:g,xmax:g+f,ymin:e.ymin,ymax:e.ymax,spatialReference:e.spatialReference});y.push(Cq(t,T,m,n,r,s)),g+=f}const b=await Promise.all(y);ee("esri-2d-profiler")&&lc.info("I.8","All calls to _fetchPart (ms)",Math.round(performance.now()-_)),ee("esri-2d-profiler")&&lc.info("I.9","Number of parts",b.length);const w={data:new Float32Array(i*n*2),mask:new Uint8Array(i*n),width:i,height:n};let x=0;for(const S of b){for(let T=0;T<S.height;T++)for(let I=0;I<S.width;I++)x+I>=i||(w.data[2*(T*i+x+I)]=S.data[2*(T*S.width+I)],w.data[2*(T*i+x+I)+1]=S.data[2*(T*S.width+I)+1],w.mask[T*i+x+I]=S.mask[T*S.width+I]);x+=S.width}return ee("esri-2d-profiler")&&lc.info("I.10","loadImagery, general exit (ms)",Math.round(performance.now()-o)),w}async function Cq(t,e,i,n,r,s){const o={requestProjectedLocalDirections:!0,signal:s};if(r!=null&&(o.timeExtent=r),t.type==="imagery"){await t.load({signal:s});const c=t.rasterInfo.dataType,u=await t.fetchImage(e,i,n,o);return u&&u.pixelData!=null&&u.pixelData.pixelBlock!=null?Iq(c,u.pixelData.pixelBlock):{data:new Float32Array(i*n*2),mask:new Uint8Array(i*n),width:i,height:n}}await t.load({signal:s});const a=t.rasterInfo.dataType,l=await t.fetchPixels(e,i,n,o);return l&&l.pixelBlock!=null?Iq(a,l.pixelBlock):{data:new Float32Array(i*n*2),mask:new Uint8Array(i*n),width:i,height:n}}const Mq=ne.getLogger("esri.layers.mixins.ImageryTileMixin"),yVe=t=>{let e=class extends t{constructor(...n){var r,s;super(...n),this._isConstructedFromFunctionRaster=!1,this._rasterJobHandler={instance:null,refCount:0,connectionPromise:null},this.bandIds=null,this.copyright=null,this.interpolation="nearest",this.multidimensionalSubset=null,this.raster=null,this.rasterInfo=null,this.sourceJSON=null,this.spatialReference=null,this.symbolizer=null,this._isConstructedFromFunctionRaster=((s=(r=n[0])==null?void 0:r.raster)==null?void 0:s.datasetFormat)==="Function"}get fullExtent(){var n;return(n=this.rasterInfo)==null?void 0:n.extent}set multidimensionalDefinition(n){this._set("multidimensionalDefinition",n),this.updateRenderer()}set rasterFunction(n){var r;((r=n==null?void 0:n.functionName)==null?void 0:r.toLowerCase())==="none"&&(n=void 0),this._set("rasterFunction",n),this.updateRasterFunction()}set url(n){this._set("url",MV(n,Mq))}set renderer(n){n==null&&this.rasterFunction==null?this._configDefaultRenderer("override"):(this._set("renderer",n),this.updateRenderer())}readRenderer(n,r,s){var a,l;const o=(l=(a=r==null?void 0:r.layerDefinition)==null?void 0:a.drawingInfo)==null?void 0:l.renderer;return jNe(o,s)||void 0}async convertVectorFieldData(n,r){if(n==null||!this.rasterInfo)return null;const s=this._rasterJobHandler.instance,o=this.rasterInfo.dataType;return s?s.convertVectorFieldData({pixelBlock:n,dataType:o},r):GA(n,o)}async computeStatisticsHistograms(n,r){n=t0(aVe,n).clone();const{rasterInfo:s}=this,{geometry:o}=n;if(o==null)throw new V("imagery-tile-mixin:compute-statistics-histograms","geometry must be specified");let a=o;const{spatialReference:l}=s;o.spatialReference.equals(l)||(await l4(),a=o.type==="extent"?Sy(o,l):u4e(o,l));const c=n.pixelSize??new pe({x:s.pixelSize.x,y:s.pixelSize.y,spatialReference:l}),{extent:u,width:d,height:f}=hFe(s,a,c),m=await this.fetchPixels(u,d,f,{...r,interpolation:"nearest"});if(m.pixelBlock==null)throw new V("imagery-tile-mixin:compute-statistics-histograms","failed to fetch pixels");const g=await aFe(m.pixelBlock,u,a),y=this._rasterJobHandler.instance;return y?y.computeStatisticsHistograms({pixelBlock:g},r):I6e(g)}async createFlowMesh(n,r){const s=this._rasterJobHandler.instance;return s?s.createFlowMesh(n,r):cVe(n.meshType,n.simulationSettings,n.flowData,r.signal!=null?r.signal:new AbortController().signal)}normalizeRasterFetchOptions(n){var a,l;const{multidimensionalInfo:r}=this.rasterInfo??{};if(r==null)return n;let s=n.multidimensionalDefinition||this.multidimensionalDefinition;s!=null&&s.length||(s=AH(this.raster.rasterInfo,{multidimensionalSubset:this.multidimensionalSubset}));const o=n.timeExtent||this.timeExtent;if(s!=null&&o!=null&&(o.start!=null||o.end!=null)){s=s.map(b=>b.clone());const c=(l=(a=r.variables.find(({name:b})=>b===s[0].variableName))==null?void 0:a.dimensions)==null?void 0:l.find(({name:b})=>b==="StdTime"),u=s.find(({dimensionName:b})=>b==="StdTime");if(!c||!u)return{...n,multidimensionalDefinition:null};const{start:d,end:f}=o,m=d==null?null:d.getTime(),g=f==null?null:f.getTime(),y=m??g,_=g??m;if(c.values!=null){const b=c.values.filter(w=>{if(Array.isArray(w)){if(y===_)return w[0]<=y&&w[1]>=y;const x=w[0]<=y&&w[1]>y||w[0]<_&&w[1]>=_,S=w[0]>=y&&w[1]<=_||w[0]<y&&w[1]>_;return x||S}return y===_?w===y:w>=y&&w<=_});if(b.length){const w=b.sort((x,S)=>{const T=Array.isArray(x)?x[0]:x,I=Array.isArray(x)?x[1]:x,C=Array.isArray(S)?S[0]:S,M=Array.isArray(S)?S[1]:S;return y===_?T-C:Math.abs(I-_)-Math.abs(M-_)})[0];u.values=[w]}else s=null}else if(c.hasRegularIntervals&&c.extent){const[b,w]=c.extent;y>w||_<b?s=null:u.values=y===_?[y]:[Math.max(b,y),Math.min(w,_)]}}return s!=null&&$j(s,this.multidimensionalSubset)?{...n,multidimensionalDefinition:null}:{...n,multidimensionalDefinition:s}}async updateRasterFunction(){var u,d,f;if(!this.loaded||this.type!=="imagery-tile"||!this.rasterFunction&&!this._cachedRasterFunctionJson||JSON.stringify(this.rasterFunction)===JSON.stringify(this._cachedRasterFunctionJson))return;if(this._isConstructedFromFunctionRaster&&this.raster.datasetFormat==="Function"){const m=this.raster.rasterFunction.toJSON();return!this.rasterFunction&&m&&this._set("rasterFunction",Jy.fromJSON(m)),void(this._cachedRasterFunctionJson=(u=this.rasterFunction)==null?void 0:u.toJSON())}let n,r=this.raster,s=!1;r.datasetFormat==="Function"?(n=r.primaryRasters.rasters,r=n[0],s=!0):n=[r];const{rasterFunction:o}=this;if(o){const m={raster:r};n.length>1&&n.forEach(_=>m[_.url]=_);const g=z4(((d=o.functionDefinition)==null?void 0:d.toJSON())??o.toJSON(),m),y=new v4({rasterFunction:g});y.rasterJobHandler=this._rasterJobHandler.instance,await y.open(),this._cachedRasterFunctionJson=(f=this.rasterFunction)==null?void 0:f.toJSON(),this.raster=y}else this.raster=r,this._cachedRasterFunctionJson=null,await r.when();if(this._cachedRendererJson=null,!s&&!o)return;const{bandIds:a}=this,{bandCount:l}=this.raster.rasterInfo,c=a!=null&&a.length?a.some(m=>m>=l):l>=3;a&&(c||this.renderer&&this.renderer.type!=="raster-stretch")&&this._set("bandIds",null),this._configDefaultRenderer("auto")}async updateRenderer(){const{loaded:n,symbolizer:r}=this;if(!n||!r||!this.renderer)return;const{rasterInfo:s}=this.raster,o=o4(s,{multidimensionalDefinition:this.multidimensionalDefinition,multidimensionalSubset:this.multidimensionalSubset}),a=o==null?void 0:o.name,l=Sq({...this.renderer.toJSON(),variableName:a});if(JSON.stringify(this._cachedRendererJson)===JSON.stringify(l))return;const c=this._rasterJobHandler.instance;c&&(r.rasterInfo=U4(s,a),r.rendererJSON=l,r.bind(),await c.updateSymbolizer(r),this._cachedRendererJson=l)}async applyRenderer(n,r){const s=n&&n.pixelBlock;if(!(s!=null&&s.pixels&&s.pixels.length>0))return null;let o;await this.updateRenderer();const a=this._rasterJobHandler.instance,l=this.bandIds??[];return o=a?await a.symbolize({...n,simpleStretchParams:r,bandIds:l}):this.symbolizer.symbolize({...n,simpleStretchParams:r,bandIds:l}),o}getTileUrl(n,r,s){return this.raster.datasetFormat==="RasterTileServer"?`${this.url}/tile/${n}/${r}/${s}`:""}getCompatibleTileInfo(n,r,s=!1){if(!this.loaded||r==null)return null;if(s&&n.equals(this.spatialReference))return this.tileInfo;const o=to(n);return Mu.create({size:256,spatialReference:n,origin:o?{x:o.origin[0],y:o.origin[1]}:{x:r.xmin,y:r.ymax}})}getCompatibleFullExtent(n){return this.loaded?(this._compatibleFullExtent&&this._compatibleFullExtent.spatialReference.equals(n)||(this._compatibleFullExtent=this.raster.computeExtent(n)),this._compatibleFullExtent):null}async fetchTile(n,r,s,o={}){var l;if(i(this),o.requestAsImageElement){const c=this.getTileUrl(n,r,s);return gt(c,{responseType:"image",query:{...this.refreshParameters,...this.raster.ioConfig.customFetchParameters},signal:o.signal}).then(u=>u.data)}const{rasterInfo:a}=this;if(a.multidimensionalInfo!=null&&(o=this.normalizeRasterFetchOptions(o)).multidimensionalDefinition==null){const c=o.tileInfo||a.storageInfo.tileInfo;return{extent:this.raster.getTileExtentFromTileInfo(n,r,s,c),pixelBlock:null}}return await this._initJobHandler(),await this.updateRasterFunction(),((l=this.renderer)==null?void 0:l.type)==="raster-shaded-relief"&&(o={...o,buffer:{cols:1,rows:1}}),this.raster.fetchTile(n,r,s,o)}async fetchPixels(n,r,s,o={}){return this.rasterInfo.multidimensionalInfo!=null&&(o=this.normalizeRasterFetchOptions(o)).multidimensionalDefinition==null?{extent:n,pixelBlock:null}:(await this._initJobHandler(),await this.updateRasterFunction(),r=Math.round(r),s=Math.round(s),this.raster.fetchPixels(n,r,s,o))}async identify(n,r={}){var l;const{raster:s,rasterInfo:o}=this;if(o.multidimensionalInfo!=null&&!(o.hasMultidimensionalTranspose&&(zle(r.multidimensionalDefinition)||r.transposedVariableName||r.timeExtent))&&(r=this.normalizeRasterFetchOptions(r)).multidimensionalDefinition==null)return{location:n,value:null};const a=(l=this.multidimensionalSubset)==null?void 0:l.areaOfInterest;if(a&&!a.contains(n))throw new V("imagery-tile-mixin:identify","the request cannot be fulfilled when falling outside of the multidimensional subset");return s.identify(n,r)}increaseRasterJobHandlerUsage(){this._rasterJobHandler.refCount++}decreaseRasterJobHandlerUsage(){this._rasterJobHandler.refCount--,this._rasterJobHandler.refCount<=0&&this._shutdownJobHandler()}hasStandardTime(){var o,a,l;const n=(o=this.rasterInfo)==null?void 0:o.multidimensionalInfo;if(n==null||((a=this.rasterInfo)==null?void 0:a.dataType)!=="standard-time")return!1;const r=this.multidimensionalDefinition,s=(l=r==null?void 0:r[0])==null?void 0:l.variableName;return n.variables.some(c=>c.name===s&&(!(r!=null&&r[0].dimensionName)||c.dimensions.some(u=>u.name==="StdTime")))}getStandardTimeValue(n){return new Date(24*(n-25569)*3600*1e3).toString()}getMultidimensionalSubsetVariables(n){var s;const r=n??((s=this.rasterInfo)==null?void 0:s.multidimensionalInfo);return t4e(this.multidimensionalSubset,r)}_configDefaultSettings(){this._configDefaultInterpolation(),this.multidimensionalDefinition||(this.multidimensionalDefinition=AH(this.raster.rasterInfo,{multidimensionalSubset:this.multidimensionalSubset})),this.rasterFunction&&this.raster.datasetFormat==="Function"&&(this._cachedRasterFunctionJson=this.rasterFunction.toJSON()),this._configDefaultRenderer()}_initJobHandler(){if(this._rasterJobHandler.connectionPromise!=null)return this._rasterJobHandler.connectionPromise;const n=new YNe;return this._rasterJobHandler.connectionPromise=n.initialize().then(async()=>{i(this),this._rasterJobHandler.instance=n,this.raster.rasterJobHandler=n,this.raster.datasetFormat==="Function"&&this.raster.syncJobHandler(),this.rasterFunction&&await this.updateRasterFunction().catch(()=>{}),this.renderer&&this.updateRenderer()}).catch(()=>{}),this._rasterJobHandler.connectionPromise}_shutdownJobHandler(){this._rasterJobHandler.instance&&this._rasterJobHandler.instance.destroy(),this._rasterJobHandler.instance=null,this._rasterJobHandler.connectionPromise=null,this._rasterJobHandler.refCount=0,this._cachedRendererJson=null,this.raster&&(this.raster.rasterJobHandler=null)}_configDefaultInterpolation(){var n;if(this.interpolation==null){i(this);const{raster:r}=this,s=J6e(r.rasterInfo,r.tileType,(n=this.sourceJSON)==null?void 0:n.defaultResamplingMethod);this._set("interpolation",s)}}_configDefaultRenderer(n="no"){var u,d;i(this);const{rasterInfo:r}=this.raster;!this.bandIds&&r.bandCount>1&&(this.bandIds=yce(r));const s=o4(r,{multidimensionalDefinition:this.multidimensionalDefinition,multidimensionalSubset:this.multidimensionalSubset}),o=s==null?void 0:s.name;if(!this.renderer||n==="override"){const f=wq(r,{bandIds:this.bandIds,variableName:o}),m=r.statistics,g=m&&m.length>0?m[0]:null,y=(g==null?void 0:g.max)??0,_=(g==null?void 0:g.min)??0;this.raster.datasetFormat==="WCSServer"&&f.type==="raster-stretch"&&(y>1e24||_<-1e24)&&(f.dynamicRangeAdjustment=!0,f.statistics=null,f.stretchType==="none"&&(f.stretchType="min-max")),this.renderer=f}const a=Sq({...this.renderer.toJSON(),variableName:o}),l=U4(r,o);this.symbolizer?(this.symbolizer.rendererJSON=a,this.symbolizer.rasterInfo=l):this.symbolizer=new rVe({rendererJSON:a,rasterInfo:l});const c=this.symbolizer.bind();if(c.success){if(n==="auto"){const{colormap:f}=this.raster.rasterInfo,m=this.renderer;if(f!=null&&m.type==="raster-colormap"){const g=wq(this.raster.rasterInfo);JSON.stringify(g)!==JSON.stringify(m)&&this._configDefaultRenderer("override")}else if(m.type==="raster-stretch"){const g=(u=this.bandIds)==null?void 0:u.length,y=(d=m.statistics)==null?void 0:d.length;!m.dynamicRangeAdjustment&&y&&g&&y!==g&&this._configDefaultRenderer("override")}}}else Mq.warn("imagery-tile-mixin",c.error||"The given renderer is not supported by the layer."),n==="auto"&&this._configDefaultRenderer("override")}};function i(n){if(!n.raster||!n.rasterInfo)throw new V("imagery-tile","no raster")}return h([p()],e.prototype,"_cachedRendererJson",void 0),h([p()],e.prototype,"_cachedRasterFunctionJson",void 0),h([p()],e.prototype,"_compatibleFullExtent",void 0),h([p()],e.prototype,"_isConstructedFromFunctionRaster",void 0),h([p()],e.prototype,"_rasterJobHandler",void 0),h([p()],e.prototype,"bandIds",void 0),h([p({json:{origins:{service:{read:{source:"copyrightText"}}}}})],e.prototype,"copyright",void 0),h([p({json:{read:!1}})],e.prototype,"fullExtent",null),h([p()],e.prototype,"interpolation",void 0),h([p()],e.prototype,"ioConfig",void 0),h([p({type:[Wy],json:{write:!0}})],e.prototype,"multidimensionalDefinition",null),h([p({type:UNe,json:{write:!0}})],e.prototype,"multidimensionalSubset",void 0),h([p()],e.prototype,"raster",void 0),h([p({type:Jy,json:{name:"renderingRule",write:!0}})],e.prototype,"rasterFunction",null),h([p()],e.prototype,"rasterInfo",void 0),h([p()],e.prototype,"sourceJSON",void 0),h([p({readOnly:!0,type:Ee,json:{read:!1}})],e.prototype,"spatialReference",void 0),h([p({type:Mu})],e.prototype,"tileInfo",void 0),h([p(pj)],e.prototype,"url",null),h([p({types:QN,json:{name:"layerDefinition.drawingInfo.renderer",write:{overridePolicy(){var r;const n=((r=this.renderer)==null?void 0:r.type)==="raster-stretch"&&this.renderer.stretchType==="none"&&!this.renderer.useGamma;return{enabled:!this.loaded||this.raster.tileType==="Raster"||!n}}},origins:{"web-scene":{types:e4,name:"layerDefinition.drawingInfo.renderer",write:{overridePolicy:n=>({enabled:n&&n.type!=="vector-field"&&n.type!=="flow"})}}}}})],e.prototype,"renderer",null),h([_e("renderer")],e.prototype,"readRenderer",null),h([p()],e.prototype,"symbolizer",void 0),e=h([P("esri.layers.ImageryTileMixin")],e),e};function vVe(t){const e=t.fields,i=t.records,n=e.some(c=>c.name.toLowerCase()==="oid")?"OBJECTID":"OID",r=[{name:n,type:"esriFieldTypeOID",alias:"OID"}].concat(e.map(c=>({name:c.name,type:"esriFieldType"+c.typeName,alias:c.name}))),s=r.map(c=>c.name),o=[];let a=0,l=0;return i.forEach(c=>{const u={};for(u[n]=a++,l=1;l<s.length;l++)u[s[l]]=c[l-1];o.push({attributes:u})}),{displayFieldName:"",fields:r,features:o}}let _ce=class{static get supportedVersions(){return[5]}static parse(e){const i=new DataView(e),n=3&i.getUint8(0);if(n!==3)return{header:{version:n},recordSet:null};const r=i.getUint32(4,!0),s=i.getUint16(8,!0),o=i.getUint16(10,!0),a={version:n,recordCount:r,headerByteCount:s,recordByteCount:o};let l=32;const c=[],u=[];let d;if(n===3){for(;i.getUint8(l)!==13;)d=String.fromCharCode(i.getUint8(l+11)).trim(),c.push({name:d4(new Uint8Array(e,l,11)),type:d,typeName:["String","Date","Double","Boolean","String","Integer"][["C","D","F","L","M","N"].indexOf(d)],length:i.getUint8(l+16)}),l+=32;if(l+=1,c.length>0)for(;u.length<r&&e.byteLength-l>o;){const f=[];i.getUint8(l)===32?(l+=1,c.forEach(m=>{if(m.type==="C")f.push(d4(new Uint8Array(e,l,m.length)).trim());else if(m.type==="N")f.push(parseInt(String.fromCharCode.apply(null,new Uint8Array(e,l,m.length)).trim(),10));else if(m.type==="F")f.push(parseFloat(String.fromCharCode.apply(null,new Uint8Array(e,l,m.length)).trim()));else if(m.type==="D"){const g=String.fromCharCode.apply(null,new Uint8Array(e,l,m.length)).trim();f.push(new Date(parseInt(g.substring(0,4),10),parseInt(g.substring(4,6),10)-1,parseInt(g.substring(6,8),10)))}l+=m.length}),u.push(f)):l+=o}}return{header:a,fields:c,records:u,recordSet:vVe({fields:c,records:u})}}},rx=class extends ie{get affectsPixelSize(){return!1}forwardTransform(e){return e}inverseTransform(e){return e}};h([p()],rx.prototype,"affectsPixelSize",null),h([p({json:{write:!0}})],rx.prototype,"spatialReference",void 0),rx=h([P("esri.layers.support.rasterTransforms.BaseRasterTransform")],rx);const qj=rx;var W4;let sx=W4=class extends qj{constructor(){super(...arguments),this.type="gcs-shift",this.tolerance=1e-8}forwardTransform(t){return(t=t.clone()).type==="point"?(t.x>180+this.tolerance&&(t.x-=360),t):(t.xmin>=180-this.tolerance?(t.xmax-=360,t.xmin-=360):t.xmax>180+this.tolerance&&(t.xmin=-180,t.xmax=180),t)}inverseTransform(t){return(t=t.clone()).type==="point"?(t.x<-this.tolerance&&(t.x+=360),t):(t.xmin<-this.tolerance&&(t.xmin+=360,t.xmax+=360),t)}clone(){return new W4({tolerance:this.tolerance})}};h([be({GCSShiftXform:"gcs-shift"})],sx.prototype,"type",void 0),h([p()],sx.prototype,"tolerance",void 0),sx=W4=h([P("esri.layers.support.rasterTransforms.GCSShiftTransform")],sx);const bce=sx;var J4;let eE=J4=class extends qj{constructor(){super(...arguments),this.type="identity"}clone(){return new J4}};h([be({IdentityXform:"identity"})],eE.prototype,"type",void 0),eE=J4=h([P("esri.layers.support.rasterTransforms.IdentityTransform")],eE);const _Ve=eE;var Z4;function Y4(t,e,i){const{x:n,y:r}=e;if(i<2)return{x:t[0]+n*t[2]+r*t[4],y:t[1]+n*t[3]+r*t[5]};if(i===2){const f=n*n,m=r*r,g=n*r;return{x:t[0]+n*t[2]+r*t[4]+f*t[6]+g*t[8]+m*t[10],y:t[1]+n*t[3]+r*t[5]+f*t[7]+g*t[9]+m*t[11]}}const s=n*n,o=r*r,a=n*r,l=s*n,c=s*r,u=n*o,d=r*o;return{x:t[0]+n*t[2]+r*t[4]+s*t[6]+a*t[8]+o*t[10]+l*t[12]+c*t[14]+u*t[16]+d*t[18],y:t[1]+n*t[3]+r*t[5]+s*t[7]+a*t[9]+o*t[11]+l*t[13]+c*t[15]+u*t[17]+d*t[19]}}function Eq(t,e,i){const{xmin:n,ymin:r,xmax:s,ymax:o,spatialReference:a}=e;let l=[];if(i<2)l.push({x:n,y:o}),l.push({x:s,y:o}),l.push({x:n,y:r}),l.push({x:s,y:r});else{let d=10;for(let f=0;f<d;f++)l.push({x:n,y:r+(o-r)*f/(d-1)}),l.push({x:s,y:r+(o-r)*f/(d-1)});d=8;for(let f=1;f<=d;f++)l.push({x:n+(s-n)*f/d,y:r}),l.push({x:n+(s-n)*f/d,y:o})}l=l.map(d=>Y4(t,d,i));const c=l.map(d=>d.x),u=l.map(d=>d.y);return new Le({xmin:Math.min.apply(null,c),xmax:Math.max.apply(null,c),ymin:Math.min.apply(null,u),ymax:Math.max.apply(null,u),spatialReference:a})}function bVe(t){const[e,i,n,r,s,o]=t,a=n*o-s*r,l=s*r-n*o;return[(s*i-e*o)/a,(n*i-e*r)/l,o/a,r/l,-s/a,-n/l]}let ja=Z4=class extends qj{constructor(){super(...arguments),this.polynomialOrder=1,this.type="polynomial"}readForwardCoefficients(t,e){const{coeffX:i,coeffY:n}=e;if(!(i!=null&&i.length)||!(n!=null&&n.length)||i.length!==n.length)return null;const r=[];for(let s=0;s<i.length;s++)r.push(i[s]),r.push(n[s]);return r}writeForwardCoefficients(t,e,i){const n=[],r=[];for(let s=0;s<(t==null?void 0:t.length);s++)s%2==0?n.push(t[s]):r.push(t[s]);e.coeffX=n,e.coeffY=r}get inverseCoefficients(){let t=this._get("inverseCoefficients");const e=this._get("forwardCoefficients");return!t&&e&&this.polynomialOrder<2&&(t=bVe(e)),t}set inverseCoefficients(t){this._set("inverseCoefficients",t)}readInverseCoefficients(t,e){const{inverseCoeffX:i,inverseCoeffY:n}=e;if(!(i!=null&&i.length)||!(n!=null&&n.length)||i.length!==n.length)return null;const r=[];for(let s=0;s<i.length;s++)r.push(i[s]),r.push(n[s]);return r}writeInverseCoefficients(t,e,i){const n=[],r=[];for(let s=0;s<(t==null?void 0:t.length);s++)s%2==0?n.push(t[s]):r.push(t[s]);e.inverseCoeffX=n,e.inverseCoeffY=r}get affectsPixelSize(){return this.polynomialOrder>0}forwardTransform(t){if(t.type==="point"){const e=Y4(this.forwardCoefficients,t,this.polynomialOrder);return new pe({x:e.x,y:e.y,spatialReference:t.spatialReference})}return Eq(this.forwardCoefficients,t,this.polynomialOrder)}inverseTransform(t){if(t.type==="point"){const e=Y4(this.inverseCoefficients,t,this.polynomialOrder);return new pe({x:e.x,y:e.y,spatialReference:t.spatialReference})}return Eq(this.inverseCoefficients,t,this.polynomialOrder)}clone(){return new Z4({polynomialOrder:this.polynomialOrder,forwardCoefficients:this.forwardCoefficients?[...this.forwardCoefficients]:null,inverseCoefficients:this.inverseCoefficients?[...this.inverseCoefficients]:null})}};h([p({json:{write:!0}})],ja.prototype,"polynomialOrder",void 0),h([p()],ja.prototype,"forwardCoefficients",void 0),h([_e("forwardCoefficients",["coeffX","coeffY"])],ja.prototype,"readForwardCoefficients",null),h([ge("forwardCoefficients")],ja.prototype,"writeForwardCoefficients",null),h([p({json:{write:!0}})],ja.prototype,"inverseCoefficients",null),h([_e("inverseCoefficients",["inverseCoeffX","inverseCoeffY"])],ja.prototype,"readInverseCoefficients",null),h([ge("inverseCoefficients")],ja.prototype,"writeInverseCoefficients",null),h([p()],ja.prototype,"affectsPixelSize",null),h([be({PolynomialXform:"polynomial"})],ja.prototype,"type",void 0),ja=Z4=h([P("esri.layers.support.rasterTransforms.PolynomialTransform")],ja);const ok=ja,wce={GCSShiftXform:bce,IdentityXform:_Ve,PolynomialXform:ok},wVe=Object.keys(wce);function xVe(t){const e=t==null?void 0:t.type;return!t||wVe.includes(e)}function SVe(t){if(!(t==null?void 0:t.type))return null;const i=wce[t==null?void 0:t.type];if(i){const n=new i;return n.read(t),n}return null}const Mg=new Map;Mg.set("int16","esriFieldTypeSmallInteger"),Mg.set("int32","esriFieldTypeInteger"),Mg.set("int64","esriFieldTypeInteger"),Mg.set("float32","esriFieldTypeSingle"),Mg.set("float64","esriFieldTypeDouble"),Mg.set("text","esriFieldTypeString");const Aq=8;let ox=class extends d0{constructor(){super(...arguments),this.storageInfo=null,this.datasetFormat="CRF"}async open(e){await this.init();const{data:i}=await this.request(this.url+"/conf.json",{signal:e==null?void 0:e.signal});if(!this._validateHeader(i))throw new V("cloudraster:open","Invalid or unsupported conf.json.");this.datasetName=this.url.slice(this.url.lastIndexOf("/")+1);const{storageInfo:n,rasterInfo:r}=this._parseHeader(i);if(r.dataType==="thematic"){const s=await this._fetchAuxiliaryInformation();r.attributeTable=s}this._set("storageInfo",n),this._set("rasterInfo",r),this.ioConfig.retryCount=this.ioConfig.retryCount||0}async fetchRawTile(e,i,n,r={}){const{transposeInfo:s}=this.rasterInfo.storageInfo,{transposedVariableName:o}=r,a=!(!s||!o),l=a?0:this.rasterInfo.storageInfo.maximumPyramidLevel-e;if(l<0)return null;const c=this._buildCacheFilePath(l,i,n,r.multidimensionalDefinition,o),u=this._getIndexRecordFromBundle(i,n,a),d=await this.request(c,{range:{from:0,to:this.storageInfo.headerSize-1},responseType:"array-buffer",signal:r.signal});if(!d)return null;const f=new Uint8Array(d.data),m=this._getTileEndAndContentType(f,u);if(m.recordSize===0)return null;const g=await this.request(c,{range:{from:m.position,to:m.position+m.recordSize},responseType:"array-buffer",signal:r.signal});if(!g)return null;const[y,_]=this._getTileSize(a);return this.decodePixelBlock(g.data,{width:y,height:_,planes:null,pixelType:null,returnInterleaved:a})}_validateHeader(e){const i=["origin","extent","geodataXform","LODInfos","blockWidth","blockHeight","bandCount","pixelType","pixelSizeX","pixelSizeY","format","packetSize"];return e&&e.type==="RasterInfo"&&!i.some(n=>!e[n])}_parseHeader(e){var Z;const i=["u1","u2","u4","u8","s8","u16","s16","u32","s32","f32","f64"][e.pixelType],{bandCount:n,histograms:r,colormap:s,blockWidth:o,blockHeight:a,firstPyramidLevel:l,maximumPyramidLevel:c}=e,u=e.statistics&&e.statistics.map(X=>({min:X.min,max:X.max,avg:X.mean,stddev:X.standardDeviation,median:X.median,mode:X.mode})),d=e.extent.spatialReference,f=(Z=e.geodataXform)==null?void 0:Z.spatialReference,m=new Ee(d!=null&&d.wkid||d!=null&&d.wkt?d:f);let g=new Le({xmin:e.extent.xmin,ymin:e.extent.ymin,xmax:e.extent.xmax,ymax:e.extent.ymax,spatialReference:m});const y=new pe({x:e.pixelSizeX,y:e.pixelSizeY,spatialReference:m}),_=Math.round((g.xmax-g.xmin)/y.x),b=Math.round((g.ymax-g.ymin)/y.y),w=this._parseTransform(e.geodataXform),x=w?g:null;w&&(g=w.forwardTransform(g),y.x=(g.xmax-g.xmin)/_,y.y=(g.ymax-g.ymin)/b);const S=e.properties??{},T=e.format.toLowerCase().replace("cache/",""),I=new pe(e.origin.x,e.origin.y,m);let C,M,E,A;if(s&&s.colors)for(C=[],M=0;M<s.colors.length;M++)E=s.colors[M],A=s.values?s.values[M]:M,C.push([A,255&E,E<<16>>>24,E<<8>>>24,E>>>24]);const $=e.LODInfos,L=[];for(M=0;M<$.levels.length;M++)L.push(new pu({level:$.levels[M],resolution:$.resolutions[M],scale:96/.0254*$.resolutions[M]}));const D=new Mu({dpi:96,lods:L,format:T,origin:I,size:[o,a],spatialReference:m}),F={recordSize:Aq,packetSize:e.packetSize,headerSize:e.packetSize*e.packetSize*Aq+64},z=[{maxCol:Math.ceil(_/o)-1,maxRow:Math.ceil(b/a)-1,minCol:0,minRow:0}];let U=2;if(c>0)for(M=0;M<c;M++)z.push({maxCol:Math.ceil(_/U/o)-1,maxRow:Math.ceil(b/U/a)-1,minCol:0,minRow:0}),U*=2;const G=e.mdInfo;let W=null;if(G&&S._yxs){const X=S._yxs;W={packetSize:X.PacketSize,tileSize:[X.TileXSize,X.TileYSize]}}return{storageInfo:F,rasterInfo:new yd({width:_,height:b,pixelType:i,bandCount:n,extent:g,nativeExtent:x,transform:w,spatialReference:m,pixelSize:y,keyProperties:S,statistics:u,histograms:r,multidimensionalInfo:G,colormap:C,storageInfo:new t1({blockWidth:o,blockHeight:a,pyramidBlockWidth:o,pyramidBlockHeight:a,origin:I,tileInfo:D,transposeInfo:W,firstPyramidLevel:l,maximumPyramidLevel:c,blockBoundary:z})})}}_parseTransform(e){var n,r;if(!xVe(e))throw new V("cloudraster:open","the data contains unsupported geodata transform types");const i=SVe(e);if(i.type==="identity")return null;if(i.type!=="polynomial"||!((n=i.forwardCoefficients)!=null&&n.length)||!((r=i.inverseCoefficients)!=null&&r.length))throw new V("cloudraster:open","the data contains unsupported geodata transforms - both forward and inverse coefficients are required currently");return i}async _fetchAuxiliaryInformation(e){const i=this.request(this.url+"/conf.vat.json",{signal:e}).then(o=>o.data).catch(()=>null),n=this.request(this.url+"/conf.vat.dbf",{responseType:"array-buffer",signal:e}).then(o=>o.data).catch(()=>null),r=await Promise.all([i,n]);let s;if(r[0]){let o=r[0].fields;const a=r[0].values;if(o&&a){o=o.map(c=>({type:c.name==="OID"?"esriFieldTypeOID":Mg.get(c.type),name:c.name,alias:c.alias||c.name}));const l=a.map(c=>({attributes:c}));o&&a&&(s={fields:o,features:l})}}return!s&&r[1]&&(s=_ce.parse(r[1]).recordSet),oT.fromJSON(s)}_buildCacheFilePath(e,i,n,r,s){const o=this._getPackageSize(!!s),a=Math.floor(i/o)*o,l=Math.floor(n/o)*o,c="R"+this._toHexString4(a)+"C"+this._toHexString4(l);let u="L";u+=e>=10?e.toString():"0"+e.toString();const{multidimensionalInfo:d}=this.rasterInfo,f=r==null?void 0:r[0];if(d==null||!f)return`${this.url}/_alllayers/${u}/${c}.bundle`;let m="_yxs";if(!s){m=d.variables.find(_=>_.name===f.variableName).dimensions[0].values.indexOf(f.values[0]).toString(16);const y=4-m.length;for(let _=0;_<y;_++)m="0"+m;m="S"+m}const g=this._getVariableFolderName(s||f.variableName);return`${this.url}/_alllayers/${g}/${m}/${u}/${c}.bundle`}_getPackageSize(e=!1){const{transposeInfo:i}=this.rasterInfo.storageInfo;return e&&i!=null?i.packetSize??0:this.storageInfo.packetSize}_getTileSize(e=!1){const{storageInfo:i}=this.rasterInfo,{transposeInfo:n}=i;return e&&n!=null?n.tileSize:i.tileInfo.size}_getVariableFolderName(e){return(e=e.trim())===""?"_v":e.replaceAll(/[\{|\}\-]/g,"_").replace("\\*","_v")}_getIndexRecordFromBundle(e,i,n=!1){const r=this._getPackageSize(n),s=r*(e%r)+i%r;if(s<0)throw new Error("Invalid level / row / col");return 20+s*this.storageInfo.recordSize+44}_getTileEndAndContentType(e,i){const n=e.subarray(i,i+8);let r,s=0;for(r=0;r<5;r++)s|=(255&n[r])<<8*r;const o=0xffffffffff&s;for(s=0,r=5;r<8;r++)s|=(255&n[r])<<8*(r-5);return{position:o,recordSize:0xffffffffff&s}}_toHexString4(e){let i=e.toString(16);if(i.length!==4){let n=4-i.length;for(;n-- >0;)i="0"+i}return i}};h([p({readOnly:!0})],ox.prototype,"storageInfo",void 0),h([p({type:String,json:{write:!0}})],ox.prototype,"datasetFormat",void 0),ox=h([P("esri.layers.support.rasterDatasets.CloudRaster")],ox);const TVe=ox;let ax=class extends d0{constructor(){super(...arguments),this.datasetFormat="MEMORY",this.data=null}async open(e){await this.init();const i=this.data,{pixelBlock:n,statistics:r,histograms:s,name:o,keyProperties:a,nativeExtent:l,transform:c}=this.data,{width:u,height:d,pixelType:f}=n,m=i.extent??new Le({xmin:-.5,ymin:.5,xmax:u-.5,ymax:d-.5,spatialReference:new Ee({wkid:3857})}),g=i.isPseudoSpatialReference??!i.extent,y={x:m.width/u,y:m.height/d},_=new yd({width:u,height:d,pixelType:f,extent:m,nativeExtent:l,transform:c,pixelSize:y,spatialReference:m.spatialReference,bandCount:n.pixels.length,keyProperties:a||{},statistics:r,isPseudoSpatialReference:g,histograms:s});this.createRemoteDatasetStorageInfo(_,512,512),this._set("rasterInfo",_),this.updateTileInfo(),await this._buildInMemoryRaster(n,{width:512,height:512},e),this.datasetName=o,this.url="/InMemory/"+o}fetchRawTile(e,i,n,r={}){const s=this._pixelBlockTiles.get(`${e}/${i}/${n}`);return Promise.resolve(s)}async _buildInMemoryRaster(e,i,n){var u,d;const r=this.rasterInfo.storageInfo.maximumPyramidLevel,s=this.rasterJobHandler?this.rasterJobHandler.split({pixelBlock:e,tileSize:i,maximumPyramidLevel:r},n):Promise.resolve(YDe(e,i,r)),o=this.rasterInfo.statistics!=null,a=this.rasterInfo.histograms!=null,l=o?Promise.resolve({statistics:null,histograms:null}):this.rasterJobHandler?this.rasterJobHandler.estimateStatisticsHistograms({pixelBlock:e},n):Promise.resolve(cce(e)),c=await Sn([s,l]);if(!c[0].value&&c[1].value)throw new V("inmemory-raster:open","failed to build in memory raster");this._pixelBlockTiles=c[0].value,o||(this.rasterInfo.statistics=(u=c[1].value)==null?void 0:u.statistics),a||(this.rasterInfo.histograms=(d=c[1].value)==null?void 0:d.histograms)}};h([p({type:String,json:{write:!0}})],ax.prototype,"datasetFormat",void 0),h([p()],ax.prototype,"data",void 0),ax=h([P("esri.layers.support.rasterDatasets.InMemoryRaster")],ax);const IVe=ax;function gb(t,e){if(!t||!e)return[];let i=e;e.includes("/")?(i=e.slice(0,e.indexOf("/")),e=e.slice(e.indexOf("/")+1)):e="";const n=[];if(e){const s=gb(t,i);for(let o=0;o<s.length;o++)gb(s[o],e).forEach(a=>n.push(a));return n}const r=t.getElementsByTagNameNS("*",i);if(!r||r.length===0)return[];for(let s=0;s<r.length;s++)n.push(r[s]||r.item(s));return n}function Ka(t,e){if(!t||!e)return null;let i=e;e.includes("/")?(i=e.slice(0,e.indexOf("/")),e=e.slice(e.indexOf("/")+1)):e="";const n=gb(t,i);return n.length>0?e?Ka(n[0],e):n[0]:null}function _u(t,e=null){const i=e?Ka(t,e):t;let n;return i?(n=i.textContent||i.nodeValue,n?n.trim():null):null}function CVe(t,e){const i=gb(t,e),n=[];let r;for(let s=0;s<i.length;s++)r=i[s].textContent||i[s].nodeValue,r&&(r=r.trim(),r!==""&&n.push(r));return n}function jI(t,e){return CVe(t,e).map(i=>Number(i))}function Yg(t,e){const i=_u(t,e);return Number(i)}function PO(t,e){var r;const i=(r=t==null?void 0:t.nodeName)==null?void 0:r.toLowerCase(),n=e.toLowerCase();return i.slice(i.lastIndexOf(":")+1)===n}function $q(t,e){if(!t||!e)return null;const i=[];for(let n=0;n<t.length;n++)i.push(t[n]),i.push(e[n]);return i}function MVe(t){const e=Ka(t,"GeodataXform"),i=ak(Yg(e,"SpatialReference/WKID")||_u(e,"SpatialReference/WKT"));if(e.getAttribute("xsi:type")!=="typens:PolynomialXform")return{spatialReference:i,transform:null};const n=Yg(e,"PolynomialOrder")??1,r=jI(e,"CoeffX/Double"),s=jI(e,"CoeffY/Double"),o=jI(e,"InverseCoeffX/Double"),a=jI(e,"InverseCoeffY/Double"),l=$q(r,s),c=$q(o,a);return{spatialReference:i,transform:l&&c&&l.length&&c.length?new ok({spatialReference:i,polynomialOrder:n,forwardCoefficients:l,inverseCoefficients:c}):null}}function EVe(t){var f;const e=Yg(t,"NoDataValue"),i=Ka(t,"Histograms/HistItem"),n=Yg(i,"HistMin"),r=Yg(i,"HistMax"),s=Yg(i,"BucketCount"),o=(f=_u(i,"HistCounts"))==null?void 0:f.split("|").map(m=>Number(m));let a,l,c,u;gb(t,"Metadata/MDI").forEach(m=>{const g=Number(m.textContent??m.nodeValue);switch(m.getAttribute("key").toUpperCase()){case"STATISTICS_MINIMUM":a=g;break;case"STATISTICS_MAXIMUM":l=g;break;case"STATISTICS_MEAN":c=g;break;case"STATISTICS_STDDEV":u=g}});const d=Yg(t,"Metadata/SourceBandIndex");return{noDataValue:e,histogram:o!=null&&o.length&&n!=null&&r!=null?{min:n,max:r,size:s||o.length,counts:o}:null,sourceBandIndex:d,statistics:a!=null&&l!=null?{min:a,max:l,avg:c,stddev:u}:null}}function ak(t){if(!t)return null;let e=Number(t);if(!isNaN(e)&&e!==0)return new Ee({wkid:e});if((t=String(t)).startsWith("COMPD_CS")){if(!t.includes("VERTCS")||!t.includes("GEOGCS")&&!t.startsWith("PROJCS"))return null;const i=t.indexOf("VERTCS"),n=t.indexOf("PROJCS"),r=n>-1?n:t.indexOf("GEOGCS");if(r===-1)return null;const s=t.slice(r,t.lastIndexOf("]",i)+1).trim(),o=t.slice(i,t.lastIndexOf("]")).trim();e=kO(s);const a=new Ee(e?{wkid:e}:{wkt:s}),l=kO(o);return l&&(a.vcsWkid=l),a}return t.startsWith("GEOGCS")||t.startsWith("PROJCS")?(e=kO(t),new Ee(e!==0?{wkid:e}:{wkt:t})):null}function kO(t){var r;const e=t.replaceAll("]","[").replaceAll('"',"").split("[").map(s=>s.trim()).filter(s=>s!==""),i=e[e.length-1].split(","),n=(r=i[0])==null?void 0:r.toLowerCase();if((n==="epsg"||n==="esri")&&t.endsWith('"]]')){const s=Number(i[1]);if(!isNaN(s)&&s!==0)return s}return 0}function Wj(t){var n;if(((n=t==null?void 0:t.documentElement.tagName)==null?void 0:n.toLowerCase())!=="pamdataset")return{};const e={spatialReference:null,transform:null,metadata:{},rasterBands:[],statistics:null,histograms:null};t.documentElement.childNodes.forEach(r=>{if(r.nodeType===1){if(PO(r,"SRS")){if(!e.spatialReference){const s=_u(r);e.spatialReference=ak(s)}}else if(PO(r,"Metadata"))if(r.getAttribute("domain")==="xml:ESRI"){const{spatialReference:s,transform:o}=MVe(r);e.transform=o,e.spatialReference||(e.spatialReference=s)}else gb(r,"MDI").forEach(s=>e.metadata[s.getAttribute("key")]=_u(s));else if(PO(r,"PAMRasterBand")){const s=EVe(r);s.sourceBandIndex!=null&&e.rasterBands[s.sourceBandIndex]==null?e.rasterBands[s.sourceBandIndex]=s:e.rasterBands.push(s)}}});const i=e.rasterBands;if(i.length){const r=!!i[0].statistics;e.statistics=r?i.map(o=>o.statistics).filter(Ti):null;const s=!!i[0].histogram;e.histograms=s?i.map(o=>o.histogram).filter(Ti):null}return e}let tE=class extends d0{async open(e){await this.init();const i=await this._fetchData(e);let{spatialReference:n,statistics:r,histograms:s,transform:o}=await this._fetchAuxiliaryData(e);const a=!n;a&&(n=new Ee({wkid:3857})),s!=null&&s.length&&r==null&&(r=jj(s));const{width:l,height:c}=i;let u=new Le({xmin:-.5,ymin:.5-c,xmax:l-.5,ymax:.5,spatialReference:n});const d=o?o.forwardTransform(u):u;let f=!0;if(o){const g=o.forwardCoefficients;f=g&&g[1]===0&&g[2]===0,f&&(o=null,u=d)}const m=new IVe({data:{extent:d,nativeExtent:u,transform:o,pixelBlock:i,statistics:r,histograms:s,keyProperties:{DateType:"Processed"},isPseudoSpatialReference:a}});await m.open(),m.data=null,this._set("rasterInfo",m.rasterInfo),this._inMemoryRaster=m}fetchRawTile(e,i,n,r={}){return this._inMemoryRaster.fetchRawTile(e,i,n,r)}async _fetchData(e){const{data:i}=await this.request(this.url,{responseType:"array-buffer",signal:e==null?void 0:e.signal}),n=nFe(i).toUpperCase();if(n!=="JPG"&&n!=="PNG"&&n!=="GIF"&&n!=="BMP")throw new V("image-aux-raster:open","the data is not a supported format");this._set("datasetFormat",n);const r=n.toLowerCase(),s=r==="gif"||r==="bmp"||!ee("ios"),o=await this.decodePixelBlock(i,{format:r,useCanvas:s,hasNoZlibMask:!0});if(o==null)throw new V("image-aux-raster:open","the data cannot be decoded");return o}async _fetchAuxiliaryData(e){var u;const i=e==null?void 0:e.signal,n=this.ioConfig.skipExtensions??[],r=n.includes("aux.xml")?null:this.request(this.url+".aux.xml",{responseType:"xml",signal:i}),s=this.datasetFormat,o=s==="JPG"?"jgw":s==="PNG"?"pgw":s==="BMP"?"bpw":null,a=o&&n.includes(o)?null:this.request(this.url.slice(0,this.url.lastIndexOf("."))+"."+o,{responseType:"text",signal:i}),l=await Sn([r,a]);if(i!=null&&i.aborted)throw li();const c=Wj((u=l[0].value)==null?void 0:u.data);if(!c.transform){const d=l[1].value?l[1].value.data.split(`
`).slice(0,6).map(f=>Number(f)):null;c.transform=(d==null?void 0:d.length)===6?new ok({forwardCoefficients:[d[4],d[5],d[0],-d[1],d[2],-d[3]]}):null}return c}};h([p({type:String,json:{write:!0}})],tE.prototype,"datasetFormat",void 0),tE=h([P("esri.layers.support.rasterDatasets.ImageAuxRaster")],tE);const BI=tE;var Yy;(function(t){t[t.KILOBYTES=1024]="KILOBYTES",t[t.MEGABYTES=1048576]="MEGABYTES",t[t.GIGABYTES=1073741824]="GIGABYTES"})(Yy||(Yy={}));function AVe(t,e=!1){return t<=Dge?e?new Array(t).fill(0):new Array(t):new Uint32Array(t)}let Pq=class X4{constructor(e){this._validateJSON(e);const{location:i,data:n}=e;this.location=Object.freeze(q(i));const r=this.location.width,s=this.location.height;let o=!0,a=!0;const l=Math.ceil(r*s/32),c=AVe(l);let u=0;for(let d=0;d<n.length;d++){const f=d%32;n[d]?(a=!1,c[u]|=1<<f):o=!1,f===31&&++u}a?(this._availability="unavailable",this.byteSize=40):o?(this._availability="available",this.byteSize=40):(this._availability=c,this.byteSize=40+Lge(c))}getAvailability(e,i){if(this._availability==="unavailable"||this._availability==="available")return this._availability;const n=(e-this.location.top)*this.location.width+(i-this.location.left),r=n%32,s=n>>5,o=this._availability;return s<0||s>o.length?"unknown":o[s]&1<<r?"available":"unavailable"}static fromDefinition(e,i){const n=e.service.request||gt,{row:r,col:s,width:o,height:a}=e,l={query:{f:"json"}};return i=i?{...l,...i}:l,n($Ve(e),i).then(c=>c.data).catch(c=>{if(c&&c.details&&c.details.httpStatus===422)return{location:{top:r,left:s,width:o,height:a},valid:!0,data:$ge(o*a,0)};throw c}).then(c=>{if(c.location&&(c.location.top!==r||c.location.left!==s||c.location.width!==o||c.location.height!==a))throw new V("tilemap:location-mismatch","Tilemap response for different location than requested",{response:c,definition:{top:r,left:s,width:o,height:a}});return X4.fromJSON(c)})}static fromJSON(e){return Object.freeze(new X4(e))}_validateJSON(e){if(!e||!e.location)throw new V("tilemap:missing-location","Location missing from tilemap response");if(e.valid===!1)throw new V("tilemap:invalid","Tilemap response was marked as invalid");if(!e.data)throw new V("tilemap:missing-data","Data missing from tilemap response");if(!Array.isArray(e.data))throw new V("tilemap:data-mismatch","Data must be an array of numbers");if(e.data.length!==e.location.width*e.location.height)throw new V("tilemap:data-mismatch","Number of data items does not match width/height of tilemap")}};function kq(t){return`${t.level}/${t.row}/${t.col}/${t.width}/${t.height}`}function $Ve(t){var n;let e;if((n=t.service.tileServers)!=null&&n.length){const r=t.service.tileServers;e=`${r&&r.length?r[t.row%r.length]:t.service.url}/tilemap/${t.level}/${t.row}/${t.col}/${t.width}/${t.height}`}else e=`${t.service.url}/tilemap/${t.level}/${t.row}/${t.col}/${t.width}/${t.height}`;const i=t.service.query;return i&&(e=`${e}?${i}`),e}var Xg;let iu=Xg=class extends ye{constructor(t){super(t),this._pendingTilemapRequests={},this.request=gt,this.size=32,this._prefetchingEnabled=!0}initialize(){this._tilemapCache=new GP(2*Yy.MEGABYTES),this.addHandles([Q(()=>{const{layer:t}=this;return[t==null?void 0:t.parsedUrl,t==null?void 0:t.tileServers,t==null?void 0:t.apiKey,t==null?void 0:t.customParameters]},()=>this._initializeTilemapDefinition(),He)])}get effectiveMinLOD(){return this.minLOD??this.layer.tileInfo.lods[0].level}get effectiveMaxLOD(){return this.maxLOD??this.layer.tileInfo.lods[this.layer.tileInfo.lods.length-1].level}fetchTilemap(t,e,i,n){if(!this.layer.tileInfo.lodAt(t)||t<this.effectiveMinLOD||t>this.effectiveMaxLOD)return Promise.reject(new V("tilemap-cache:level-unavailable",`Level ${t} is unavailable in the service`));const r=this._tmpTilemapDefinition,s=this._tilemapFromCache(t,e,i,r);if(s)return Promise.resolve(s);const o=n&&n.signal;return n={...n,signal:null},new Promise((a,l)=>{Ro(o,()=>l(li()));const c=kq(r);let u=this._pendingTilemapRequests[c];if(!u){u=Pq.fromDefinition(r,n).then(f=>(this._tilemapCache.put(c,f,f.byteSize),f));const d=()=>delete this._pendingTilemapRequests[c];this._pendingTilemapRequests[c]=u,u.then(d,d)}u.then(a,l)})}getAvailability(t,e,i){if(!this.layer.tileInfo.lodAt(t)||t<this.effectiveMinLOD||t>this.effectiveMaxLOD)return"unavailable";const n=this._tilemapFromCache(t,e,i,this._tmpTilemapDefinition);return n?n.getAvailability(e,i):"unknown"}fetchAvailability(t,e,i,n){return!this.layer.tileInfo.lodAt(t)||t<this.effectiveMinLOD||t>this.effectiveMaxLOD?Promise.reject(new V("tile-map:tile-unavailable","Tile is not available",{level:t,row:e,col:i})):this.fetchTilemap(t,e,i,n).catch(r=>r).then(r=>{if(r instanceof Pq){const s=r.getAvailability(e,i);if(s==="unavailable")throw new V("tile-map:tile-unavailable","Tile is not available",{level:t,row:e,col:i});return s}if(Ds(r))throw r;return"unknown"})}fetchAvailabilityUpsample(t,e,i,n,r){n.level=t,n.row=e,n.col=i;const s=this.layer.tileInfo;s.updateTileInfo(n);const o=this.fetchAvailability(t,e,i,r).catch(a=>{if(Ds(a))throw a;if(s.upsampleTile(n))return this.fetchAvailabilityUpsample(n.level,n.row,n.col,n,r);throw a});return this._fetchAvailabilityUpsamplePrefetch(n.id,t,e,i,r,o),o}async _fetchAvailabilityUpsamplePrefetch(t,e,i,n,r,s){if(!this._prefetchingEnabled||t==null)return;const o=`prefetch-${t}`;if(this.hasHandles(o))return;const a=new AbortController;s.then(()=>a.abort(),()=>a.abort());let l=!1;const c=br(()=>{l||(l=!0,a.abort())});if(this.addHandles(c,o),await Mye(10,a.signal).catch(()=>{}),l||(l=!0,this.removeHandles(o)),zo(a))return;const u=new SP(t,e,i,n),d={...r,signal:a.signal},f=this.layer.tileInfo;for(let m=0;Xg._prefetches.length<Xg._maxPrefetch&&f.upsampleTile(u);++m){const g=this.fetchAvailability(u.level,u.row,u.col,d);Xg._prefetches.push(g);const y=()=>{Xg._prefetches.removeUnordered(g)};g.then(y,y)}}_initializeTilemapDefinition(){var n;if(!this.layer.parsedUrl)return;const{parsedUrl:t,apiKey:e,customParameters:i}=this.layer;this._tilemapCache.clear(),this._tmpTilemapDefinition={service:{url:t.path,query:X_({...t.query,...i,token:e??((n=t.query)==null?void 0:n.token)}),tileServers:this.layer.tileServers,request:this.request},width:this.size,height:this.size,level:0,row:0,col:0}}_tilemapFromCache(t,e,i,n){n.level=t,n.row=e-e%this.size,n.col=i-i%this.size;const r=kq(n);return this._tilemapCache.get(r)}get test(){const t=this;return{get prefetchingEnabled(){return t._prefetchingEnabled},set prefetchingEnabled(e){t._prefetchingEnabled=e},hasTilemap:(e,i,n)=>!!t._tilemapFromCache(e,i,n,t._tmpTilemapDefinition)}}};iu._maxPrefetch=4,iu._prefetches=new Sf({initialSize:Xg._maxPrefetch}),h([p({constructOnly:!0})],iu.prototype,"layer",void 0),h([p({constructOnly:!0})],iu.prototype,"minLOD",void 0),h([p({constructOnly:!0})],iu.prototype,"maxLOD",void 0),h([p({constructOnly:!0})],iu.prototype,"request",void 0),h([p({constructOnly:!0})],iu.prototype,"size",void 0),iu=Xg=h([P("esri.layers.support.TilemapCache")],iu);async function xce(t,e,i){var D,F,z,U,G,W;const n=e1(t),{rasterFunction:r,sourceJSON:s}=e||{},o=r?JSON.stringify(r.rasterFunctionDefinition||r):null,a=uT({...n.query,renderingRule:o,f:"json"}),l=cT(a,i);t=n.path;const c=s||await gt(t,l).then(Z=>Z.data),u=c.hasRasterAttributeTable?gt(`${t}/rasterAttributeTable`,l):null,d=c.hasColormap?gt(`${t}/colormap`,l):null,f=c.hasHistograms?gt(`${t}/histograms`,l):null,m=c.currentVersion>=10.3?gt(`${t}/keyProperties`,l):null,g=c.hasMultidimensions?gt(`${t}/multidimensionalInfo`,l):null,y=await Promise.allSettled([u,d,f,m,g]);let _=null;if(c.minValues&&c.minValues.length===c.bandCount){_=[];for(let Z=0;Z<c.minValues.length;Z++)_.push({min:c.minValues[Z],max:c.maxValues[Z],avg:c.meanValues[Z],stddev:c.stdvValues[Z]})}const b=Le.fromJSON(c.extent),w=Math.ceil(b.width/c.pixelSizeX-.1),x=Math.ceil(b.height/c.pixelSizeY-.1),S=Ee.fromJSON(c.spatialReference||c.extent.spatialReference),T=y[0].status==="fulfilled"&&y[0].value?oT.fromJSON(y[0].value.data):null,I=y[1].status==="fulfilled"?(D=y[1].value)==null?void 0:D.data.colormap:null,C=y[2].status==="fulfilled"?(F=y[2].value)==null?void 0:F.data.histograms:null,M=y[3].status==="fulfilled"?((z=y[3].value)==null?void 0:z.data)??{}:{},E=y[4].status==="fulfilled"?(U=y[4].value)==null?void 0:U.data.multidimensionalInfo:null;(G=E==null?void 0:E.variables)!=null&&G.length&&E.variables.forEach(Z=>{var X;(X=Z.statistics)!=null&&X.length&&Z.statistics.forEach(oe=>{oe.avg=oe.mean,oe.stddev=oe.standardDeviation})});const{defaultVariable:A,serviceDataType:$}=c;A&&A!==M.DefaultVariable&&(M.DefaultVariable=A),$&&$.includes("esriImageServiceDataTypeVector")&&!$.includes(M.DataType)&&(M.DataType=$.replace("esriImageServiceDataType",""));let L=c.noDataValue;return(W=c.noDataValues)!=null&&W.length&&c.noDataValues.some(Z=>Z!==L)&&(L=c.noDataValues),new yd({width:w,height:x,bandCount:c.bandCount,extent:Le.fromJSON(c.extent),spatialReference:S,pixelSize:new pe({x:c.pixelSizeX,y:c.pixelSizeY,spatialReference:S}),pixelType:c.pixelType.toLowerCase(),statistics:_,attributeTable:T,colormap:I,histograms:C,keyProperties:M,noDataValue:L,multidimensionalInfo:E})}function PVe(t,e,i){return xce(t,{sourceJSON:e},i)}function Jft(t,e,i){return xce(t,{rasterFunction:e},i)}let lx=class extends d0{constructor(){super(...arguments),this._levelOffset=0,this._tilemapCache=null,this._slices=null,this.datasetFormat="RasterTileServer",this.tileType=null}async open(e){var M,E;await this.init();const i=e&&e.signal,n=this.sourceJSON?{data:this.sourceJSON}:await this.request(this.url,{query:{f:"json"},signal:i});n.ssl&&(this.url=this.url.replace(/^http:/i,"https:"));const r=n.data;if(this.sourceJSON=r,!r)throw new V("imageserverraster:open","cannot initialize tiled image service, missing service info");if(!r.tileInfo)throw new V("imageserverraster:open","use ImageryLayer to open non-tiled image services");this._fixScaleInServiceInfo();const s=["jpg","jpeg","png","png8","png24","png32","mixed"];this.tileType=r.cacheType,this.tileType==null&&(s.includes(r.tileInfo.format.toLowerCase())?this.tileType="Map":r.tileInfo.format.toLowerCase()==="lerc"?this.tileType="Elevation":this.tileType="Raster"),this.datasetName=((M=r.name)==null?void 0:M.slice(r.name.indexOf("/")+1))??"";const o=await this._fetchRasterInfo({signal:i});if(o==null)throw new V("image-server-raster:open","cannot initialize image service");const a=this.tileType==="Map"?kVe(r.tileInfo,r):Mu.fromJSON(r.tileInfo);ks(a);const[l,c]=this._computeMinMaxLOD(o,a),{extent:u,pixelSize:d}=o,f=.5/o.width*d.x,m=Math.max(d.x,d.y),{lods:g}=a;(this.tileType!=="Map"&&r.maxScale!==0||Math.abs(d.x-d.y)>f||!g.some(A=>Math.abs(A.resolution-m)<f))&&(d.x=d.y=l.resolution,o.width=Math.ceil((u.xmax-u.xmin)/d.x-.1),o.height=Math.ceil((u.ymax-u.ymin)/d.y-.1));const y=l.level-c.level,[_,b]=a.size,w=[],x=[];g.forEach((A,$)=>{A.level>=c.level&&A.level<=l.level&&w.push({x:A.resolution,y:A.resolution}),$<g.length-1&&x.push(Math.round(10*A.resolution/g[$+1].resolution)/10)}),w.sort((A,$)=>A.x-$.x);const S=this.computeBlockBoundary(u,_,b,a.origin,w,y),T=w.length>1?w.slice(1):null;let I;r.transposeInfo&&(I={tileSize:[r.transposeInfo.rows,r.transposeInfo.cols],packetSize:((E=o.keyProperties)==null?void 0:E._yxs.PacketSize)??0});const C=x.length<=1||x.length>=3&&x.slice(0,x.length-1).every(A=>A===x[0])?x[0]??2:Math.round(10/(c.resolution/l.resolution)**(-1/y))/10;if(o.storageInfo=new t1({blockWidth:a.size[0],blockHeight:a.size[1],pyramidBlockWidth:a.size[0],pyramidBlockHeight:a.size[1],pyramidResolutions:T,pyramidScalingFactor:C,compression:a.format,origin:a.origin,firstPyramidLevel:1,maximumPyramidLevel:y,tileInfo:a,transposeInfo:I,blockBoundary:S}),this._fixGCSShift(o),this._set("rasterInfo",o),r.capabilities.toLowerCase().includes("tilemap")){const A={tileInfo:o.storageInfo.tileInfo,parsedUrl:ir(this.url),url:this.url,tileServers:[]};this._tilemapCache=new iu({layer:A})}}async fetchRawTile(e,i,n,r={}){const{storageInfo:s,extent:o}=this.rasterInfo,{transposeInfo:a}=s,l=a!=null&&!!r.transposedVariableName;if(this._slices&&!l&&r.sliceId==null)return null;const c=l?0:s.maximumPyramidLevel-e+this._levelOffset,u=`${this.url}/tile/${c}/${i}/${n}`,d=this._slices?l?{variable:r.transposedVariableName}:{sliceId:r.sliceId||0}:null,{data:f}=await this.request(u,{query:d,responseType:"array-buffer",signal:r.signal});if(!f)return null;const m=l?a.tileSize:s.tileInfo.size,g=await this.decodePixelBlock(f,{width:m[0],height:m[1],planes:null,pixelType:null,isPoint:this.tileType==="Elevation",returnInterleaved:l,noDataValue:this.rasterInfo.noDataValue});if(g==null)return null;const y=s.blockBoundary[e];if(s.compression!=="jpg"||n>y.minCol&&n<y.maxCol&&i>y.minRow&&i<y.maxRow)return g;const{origin:_,blockWidth:b,blockHeight:w}=s,{x,y:S}=this.getPyramidPixelSize(e),T=Math.round((o.xmin-_.x)/x)%b,I=Math.round((o.xmax-_.x)/x)%b||b,C=Math.round((_.y-o.ymax)/S)%w,M=Math.round((_.y-o.ymin)/S)%w||w,E=n===y.minCol?T:0,A=i===y.minRow?C:0,$=n===y.maxCol?I:b,L=i===y.maxRow?M:w;return qDe(g,{x:E,y:A},{width:$-E,height:L-A}),g}getSliceIndex(e){if(!this._slices||e==null||e.length===0)return null;const i=e;for(let n=0;n<this._slices.length;n++){const r=this._slices[n].multidimensionalDefinition;if(r.length===i.length&&!r.some(s=>{const o=i.find(a=>s.variableName===a.variableName&&a.dimensionName===s.dimensionName);return o?(Array.isArray(s.values[0])?`${s.values[0][0]}-${s.values[0][1]}`:s.values[0])!==(Array.isArray(o.values[0])?`${o.values[0][0]}-${o.values[0][1]}`:o.values[0]):!0}))return n}return null}async fetchVariableStatisticsHistograms(e,i){const n=this.request(this.url+"/statistics",{query:{variable:e,f:"json"},signal:i}).then(o=>{var a;return(a=o.data)==null?void 0:a.statistics}),r=this.request(this.url+"/histograms",{query:{variable:e,f:"json"},signal:i}).then(o=>{var a;return(a=o.data)==null?void 0:a.histograms}),s=await Promise.all([n,r]);return s[0]&&s[0].forEach(o=>{o.avg=o.mean,o.stddev=o.standardDeviation}),{statistics:s[0]||null,histograms:s[1]||null}}async computeBestPyramidLevelForLocation(e,i={}){if(!this._tilemapCache)return 0;let n=this.identifyPixelLocation(e,0,i.datumTransformation);if(n===null)return null;let r=0;const{maximumPyramidLevel:s}=this.rasterInfo.storageInfo;let o=s-r+this._levelOffset;const a=n.srcLocation;for(;o>=0;){try{if(await this._tilemapCache.fetchAvailability(o,n.row,n.col,i)==="available")break}catch{}if(o--,r++,n=this.identifyPixelLocation(a,r,i.datumTransformation),n===null)return null}return o===-1||n==null?null:r}async _fetchRasterInfo(e){const i=this.sourceJSON;if(this.tileType==="Map"){const a=i.fullExtent||i.extent,l=Math.ceil((a.xmax-a.xmin)/i.pixelSizeX-.1),c=Math.ceil((a.ymax-a.ymin)/i.pixelSizeY-.1),u=Ee.fromJSON(i.spatialReference||a.spatialReference),d=new pe({x:i.pixelSizeX,y:i.pixelSizeY,spatialReference:u});return new yd({width:l,height:c,bandCount:3,extent:Le.fromJSON(a),spatialReference:u,pixelSize:d,pixelType:"u8",statistics:null,keyProperties:{DataType:"processed"}})}const{signal:n}=e,r=PVe(this.url,this.sourceJSON,{signal:n,query:this.ioConfig.customFetchParameters}),s=i.hasMultidimensions?this.request(`${this.url}/slices`,{query:{f:"json"},signal:n}).then(a=>a.data&&a.data.slices).catch(()=>null):null,o=await Promise.all([r,s]);return this._slices=o[1],o[0]}_fixScaleInServiceInfo(){const{sourceJSON:e}=this;e.minScale&&e.minScale<0&&(e.minScale=0),e.maxScale&&e.maxScale<0&&(e.maxScale=0)}_fixGCSShift(e){const{extent:i,spatialReference:n}=e;i.xmin>-1&&i.xmax>181&&(n!=null&&n.wkid)&&n.isGeographic&&(e.nativeExtent=e.extent,e.transform=new bce,e.extent=e.transform.forwardTransform(i))}_computeMinMaxLOD(e,i){const{pixelSize:n}=e,r=.5/e.width*n.x,{lods:s}=i,o=i.lodAt(Math.max.apply(null,s.map(m=>m.level))),a=i.lodAt(Math.min.apply(null,s.map(m=>m.level))),{tileType:l}=this;if(l==="Map")return this._levelOffset=s[0].level,[o,a];if(l==="Raster")return[s.find(m=>m.resolution===n.x)??o,a];const{minScale:c,maxScale:u}=this.sourceJSON;let d=o;u>0&&(d=s.find(m=>Math.abs(m.scale-u)<r),d||(d=s.filter(m=>m.scale>u).sort((m,g)=>m.scale>g.scale?1:-1)[0]??o));let f=a;return c>0&&(f=s.find(m=>Math.abs(m.scale-c)<r)??a,this._levelOffset=f.level-a.level),[d,f]}};function kVe(t,e){if(!t)return null;const{minScale:i,maxScale:n,minLOD:r,maxLOD:s}=e;if(r!=null&&s!=null)return Mu.fromJSON({...t,lods:t.lods.filter(({level:o})=>o!=null&&o>=r&&o<=s)});if(i!==0&&n!==0){const o=c=>Math.round(1e4*c)/1e4,a=i?o(i):1/0,l=n?o(n):-1/0;return Mu.fromJSON({...t,lods:t.lods.filter(c=>{const u=o(c.scale);return u<=a&&u>=l})})}return Mu.fromJSON(t)}h([p({type:String,json:{write:!0}})],lx.prototype,"datasetFormat",void 0),h([p()],lx.prototype,"tileType",void 0),lx=h([P("esri.layers.support.rasterDatasets.ImageServerRaster")],lx);const OVe=lx,nu=new Map;nu.set("Int8","s8"),nu.set("UInt8","u8"),nu.set("Int16","s16"),nu.set("UInt16","u16"),nu.set("Int32","s32"),nu.set("UInt32","u32"),nu.set("Float32","f32"),nu.set("Float64","f32"),nu.set("Double64","f32");const ff=new Map;ff.set("none",{blobExtension:".til",isOneSegment:!0,decoderFormat:"bip"}),ff.set("lerc",{blobExtension:".lrc",isOneSegment:!1,decoderFormat:"lerc"}),ff.set("deflate",{blobExtension:".pzp",isOneSegment:!0,decoderFormat:"deflate"}),ff.set("jpeg",{blobExtension:".pjg",isOneSegment:!0,decoderFormat:"jpg"});let qv=class extends d0{constructor(){super(...arguments),this._files=null,this._storageIndex=null,this.datasetFormat="MRF"}async open(e){var _;await this.init(),this.datasetName=this.url.slice(this.url.lastIndexOf("/")+1);const i=e?e.signal:null,n=await this.request(this.url,{responseType:"xml",signal:i}),{rasterInfo:r,files:s}=this._parseHeader(n.data);if(((_=this.ioConfig.skipExtensions)==null?void 0:_.indexOf("aux.xml"))===-1){const b=await this._fetchAuxiliaryData(e);b!=null&&(r.statistics=b.statistics??r.statistics,r.histograms=b.histograms,b.histograms&&r.statistics==null&&(r.statistics=jj(b.histograms)))}this._set("rasterInfo",r),this._files=s;const o=await this.request(s.index,{responseType:"array-buffer",signal:i});this._storageIndex=this._parseIndex(o.data);const{blockWidth:a,blockHeight:l}=this.rasterInfo.storageInfo,c=this.rasterInfo.storageInfo.pyramidScalingFactor,{width:u,height:d}=this.rasterInfo,f=[],m=this._getBandSegmentCount();let g=0,y=-1;for(;g<this._storageIndex.length;){y++;const b=Math.ceil(u/a/c**y)-1,w=Math.ceil(d/l/c**y)-1;g+=(b+1)*(w+1)*m*4,f.push({maxRow:w,maxCol:b,minCol:0,minRow:0})}this.rasterInfo.storageInfo.blockBoundary=f,y>0&&(this.rasterInfo.storageInfo.firstPyramidLevel=1,this.rasterInfo.storageInfo.maximumPyramidLevel=y),this.updateTileInfo()}async fetchRawTile(e,i,n,r={}){const{blockWidth:s,blockHeight:o,blockBoundary:a}=this.rasterInfo.storageInfo,l=a[e];if(!l||l.maxRow<i||l.maxCol<n||l.minRow>i||l.minCol>n)return null;const{bandCount:c,pixelType:u}=this.rasterInfo,{ranges:d,actualTileWidth:f,actualTileHeight:m}=this._getTileLocation(e,i,n);if(!d||d.length===0)return null;if(d[0].from===0&&d[0].to===0){const $=new Uint8Array(s*o);return new ue({width:s,height:o,pixels:null,mask:$,validPixelCount:0})}const{bandIds:g}=this.ioConfig,y=this._getBandSegmentCount(),_=[];let b=0;for(b=0;b<y;b++)g&&!g.includes(b)||_.push(this.request(this._files.data,{range:{from:d[b].from,to:d[b].to},responseType:"array-buffer",signal:r.signal}));const w=await Promise.all(_),x=w.map($=>$.data.byteLength).reduce(($,L)=>$+L),S=new Uint8Array(x);let T=0;for(b=0;b<y;b++)S.set(new Uint8Array(w[b].data),T),T+=w[b].data.byteLength;const I=ff.get(this.rasterInfo.storageInfo.compression).decoderFormat,C=await this.decodePixelBlock(S.buffer,{width:s,height:o,format:I,planes:(g==null?void 0:g.length)||c,pixelType:u});if(C==null)return null;let{noDataValue:M}=this.rasterInfo;if(M!=null&&I!=="lerc"&&!C.mask&&(M=M[0],M!=null)){const $=C.width*C.height,L=new Uint8Array($);if(Math.abs(M)>1e24)for(b=0;b<$;b++)Math.abs((C.pixels[0][b]-M)/M)>1e-6&&(L[b]=1);else for(b=0;b<$;b++)C.pixels[0][b]!==M&&(L[b]=1);C.mask=L}let E=0,A=0;if(f!==s||m!==o){let $=C.mask;if($)for(b=0;b<o;b++)if(A=b*s,b<m)for(E=f;E<s;E++)$[A+E]=0;else for(E=0;E<s;E++)$[A+E]=0;else for($=new Uint8Array(s*o),C.mask=$,b=0;b<m;b++)for(A=b*s,E=0;E<f;E++)$[A+E]=1}return C}_parseIndex(e){if(e.byteLength%16>0)throw new Error("invalid array buffer must be multiples of 16");let i,n,r,s,o,a;if(tk){for(n=new Uint8Array(e),s=new ArrayBuffer(e.byteLength),r=new Uint8Array(s),o=0;o<e.byteLength/4;o++)for(a=0;a<4;a++)r[4*o+a]=n[4*o+3-a];i=new Uint32Array(s)}else i=new Uint32Array(e);return i}_getBandSegmentCount(){return ff.get(this.rasterInfo.storageInfo.compression).isOneSegment?1:this.rasterInfo.bandCount}_getTileLocation(e,i,n){const{blockWidth:r,blockHeight:s,pyramidScalingFactor:o}=this.rasterInfo.storageInfo,{width:a,height:l}=this.rasterInfo,c=this._getBandSegmentCount();let u,d,f,m=0,g=0;for(f=0;f<e;f++)g=o**f,u=Math.ceil(a/r/g),d=Math.ceil(l/s/g),m+=u*d;g=o**e,u=Math.ceil(a/r/g),d=Math.ceil(l/s/g),m+=i*u+n,m*=4*c;const y=this._storageIndex.subarray(m,m+4*c);let _=0,b=0;const w=[];for(let x=0;x<c;x++)_=y[4*x]*2**32+y[4*x+1],b=_+y[4*x+2]*2**32+y[4*x+3],w.push({from:_,to:b});return{ranges:w,actualTileWidth:n<u-1?r:Math.ceil(a/g)-r*(u-1),actualTileHeight:i<d-1?s:Math.ceil(l/g)-s*(d-1)}}_parseHeader(e){const i=Ka(e,"MRF_META/Raster");if(!i)throw new V("mrf:open","not a valid MRF format");const n=Ka(i,"Size"),r=parseInt(n.getAttribute("x"),10),s=parseInt(n.getAttribute("y"),10),o=parseInt(n.getAttribute("c"),10),a=(_u(i,"Compression")||"none").toLowerCase();if(!ff.has(a))throw new V("mrf:open","currently does not support compression "+a);const l=_u(i,"DataType")||"UInt8",c=nu.get(l);if(c==null)throw new V("mrf:open","currently does not support pixel type "+l);const u=Ka(i,"PageSize"),d=parseInt(u.getAttribute("x"),10),f=parseInt(u.getAttribute("y"),10),m=Ka(i,"DataValues");let g,y;if(m&&(y=m.getAttribute("NoData"),y!=null&&(g=y.trim().split(" ").map(L=>parseFloat(L)))),Ka(e,"MRF_META/CachedSource"))throw new V("mrf:open","currently does not support MRF referencing other data files");const _=Ka(e,"MRF_META/GeoTags"),b=Ka(_,"BoundingBox");let w,x=!1;if(b!=null){const L=parseFloat(b.getAttribute("minx")),D=parseFloat(b.getAttribute("miny")),F=parseFloat(b.getAttribute("maxx")),z=parseFloat(b.getAttribute("maxy")),U=_u(_,"Projection")||"";let G=Ee.WGS84;if(U!=="LOCAL_CS[]")if(U.toLowerCase().startsWith("epsg:")){const W=Number(U.slice(5));isNaN(W)||W===0||(G=new Ee({wkid:W}))}else G=ak(U)??Ee.WGS84;else x=!0,G=new Ee({wkid:3857});w=new Le(L,D,F,z),w.spatialReference=G}else x=!0,w=new Le({xmin:-.5,ymin:.5-s,xmax:r-.5,ymax:.5,spatialReference:new Ee({wkid:3857})});const S=Ka(e,"MRF_META/Rsets"),T=parseInt(S&&S.getAttribute("scale")||"2",10),I=w.spatialReference,C=new t1({origin:new pe({x:w.xmin,y:w.ymax,spatialReference:I}),blockWidth:d,blockHeight:f,pyramidBlockWidth:d,pyramidBlockHeight:f,compression:a,pyramidScalingFactor:T}),M=new pe({x:w.width/r,y:w.height/s,spatialReference:I}),E=new yd({width:r,height:s,extent:w,isPseudoSpatialReference:x,spatialReference:I,bandCount:o,pixelType:c,pixelSize:M,noDataValue:g,storageInfo:C}),A=_u(e,"datafile"),$=_u(e,"IndexFile");return{rasterInfo:E,files:{mrf:this.url,index:$||this.url.replace(".mrf",".idx"),data:A||this.url.replace(".mrf",ff.get(a).blobExtension)}}}async _fetchAuxiliaryData(e){try{const{data:i}=await this.request(this.url+".aux.xml",{responseType:"xml",signal:e==null?void 0:e.signal});return Wj(i)}catch{return null}}};h([p()],qv.prototype,"_files",void 0),h([p()],qv.prototype,"_storageIndex",void 0),h([p({type:String,json:{write:!0}})],qv.prototype,"datasetFormat",void 0),qv=h([P("esri.layers.support.rasterIO.MRFRaster")],qv);const LVe=qv,OO=(t,e)=>{var i;return(i=t.get(e))==null?void 0:i.values},R1=(t,e)=>{var i,n;return(n=(i=t.get(e))==null?void 0:i.values)==null?void 0:n[0]};let Eg=class extends d0{constructor(){super(...arguments),this._files=null,this._headerInfo=null,this._bufferSize=1048576,this.datasetFormat="TIFF"}async open(e){var y,_,b,w;await this.init();const i=e?e.signal:null,{data:n}=await this.request(this.url,{range:{from:0,to:this._bufferSize},responseType:"array-buffer",signal:i});if(!n)throw new V("tiffraster:open","failed to open url "+this.url);this.datasetName=this.url.slice(this.url.lastIndexOf("/")+1,this.url.lastIndexOf("."));const{littleEndian:r,firstIFDPos:s,isBigTiff:o}=Xle(n),a=[];await this._readIFDs(a,n,r,s,0,o?8:4,i);const{imageInfo:l,rasterInfo:c}=this._parseIFDs(a),u=Rj(a),d=Dj(a);if(this._headerInfo={littleEndian:r,isBigTiff:o,ifds:a,pyramidIFDs:u,maskIFDs:d,...l},this._set("rasterInfo",c),!l.isSupported)throw new V("tiffraster:open","this tiff is not supported: "+l.message);if(!l.tileWidth)throw new V("tiffraster:open","none-tiled tiff is not optimized for access, convert to COG and retry.");const f=(_=(y=a[0].get("PREDICTOR"))==null?void 0:y.values)==null?void 0:_[0];if(((w=(b=a[0].get("SAMPLEFORMAT"))==null?void 0:b.values)==null?void 0:w[0])===3&&f===2)throw new V("tiffraster:open","unsupported horizontal difference encoding. Predictor=3 is supported for floatting point data");const{skipExtensions:g=[]}=this.ioConfig;if(!g.includes("aux.xml")){const x=await this._fetchAuxiliaryMetaData(e);x!=null&&this._processPAMInfo(x,c)}g.includes("vat.dbf")||c.bandCount!==1||c.pixelType!=="u8"||(c.attributeTable=await this._fetchAuxiliaryTable(e),c.attributeTable!=null&&(c.keyProperties.DataType="thematic")),this.updateTileInfo()}async fetchRawTile(e,i,n,r={}){var o;if(!((o=this._headerInfo)!=null&&o.isSupported)||this.isBlockOutside(e,i,n))return null;const s=await this._fetchRawTiffTile(e,i,n,!1,r);if(s!=null&&this._headerInfo.hasMaskBand){const a=await this._fetchRawTiffTile(e,i,n,!0,r);a!=null&&a.pixels[0]instanceof Uint8Array&&(s.mask=a.pixels[0])}return s}_parseIFDs(e){var D,F;const i=nk(e),{width:n,height:r,tileWidth:s,tileHeight:o,planes:a,pixelType:l,compression:c,firstPyramidLevel:u,maximumPyramidLevel:d,pyramidBlockWidth:f,pyramidBlockHeight:m,tileBoundary:g,affine:y,metadata:_}=i,b=((D=i.extent.spatialReference)==null?void 0:D.wkt)||((F=i.extent.spatialReference)==null?void 0:F.wkid);let w=ak(b),x=!!i.isPseudoGeographic;w==null&&(x=!0,w=new Ee({wkid:3857}));const S=new Le({...i.extent,spatialReference:w}),T=new pe(S?{x:S.xmin,y:S.ymax,spatialReference:w}:{x:0,y:0}),I=new t1({blockWidth:s,blockHeight:o,pyramidBlockWidth:f,pyramidBlockHeight:m,compression:c,origin:T,firstPyramidLevel:u,maximumPyramidLevel:d,blockBoundary:g}),C=new pe({x:(S.xmax-S.xmin)/n,y:(S.ymax-S.ymin)/r,spatialReference:w}),M=_?{BandProperties:_.bandProperties,DataType:_.dataType}:{};let E=null;const A=R1(e[0],"PHOTOMETRICINTERPRETATION"),$=OO(e[0],"COLORMAP");if(A<=3&&($==null?void 0:$.length)>3&&$.length%3==0){E=[];const z=$.length/3;for(let U=0;U<z;U++)E.push([U,$[U]>>>8,$[U+z]>>>8,$[U+2*z]>>>8])}const L=new yd({width:n,height:r,bandCount:a,pixelType:l,pixelSize:C,storageInfo:I,spatialReference:w,isPseudoSpatialReference:x,keyProperties:M,extent:S,colormap:E,statistics:_?_.statistics:null});return y!=null&&y.length&&(L.nativeExtent=new Le({xmin:-.5,ymin:.5-r,xmax:n-.5,ymax:.5,spatialReference:w}),L.transform=new ok({polynomialOrder:1,forwardCoefficients:[y[2]+y[0]/2,y[5]-y[3]/2,y[0],y[3],-y[1],-y[4]]}),L.extent=L.transform.forwardTransform(L.nativeExtent),L.pixelSize=new pe({x:(S.xmax-S.xmin)/n,y:(S.ymax-S.ymin)/r,spatialReference:w}),I.origin.x=-.5,I.origin.y=.5),{imageInfo:i,rasterInfo:L}}_processPAMInfo(e,i){if(i.statistics=e.statistics??i.statistics,i.histograms=e.histograms,e.histograms&&i.statistics==null&&(i.statistics=jj(e.histograms)),e.transform&&i.transform==null){i.transform=e.transform,i.nativeExtent=i.extent;const n=i.transform.forwardTransform(i.nativeExtent);i.pixelSize=new pe({x:(n.xmax-n.xmin)/i.width,y:(n.ymax-n.ymin)/i.height,spatialReference:i.spatialReference}),i.extent=n}i.isPseudoSpatialReference&&e.spatialReference&&(i.spatialReference=e.spatialReference,i.extent.spatialReference=i.nativeExtent.spatialReference=i.storageInfo.origin.spatialReference=i.spatialReference)}async _readIFDs(e,i,n,r,s,o=4,a){if(!r)return null;(r>=i.byteLength||r<0)&&(i=(await this.request(this.url,{range:{from:r+s,to:r+s+this._bufferSize},responseType:"array-buffer",signal:a})).data,s=r+s,r=0);const l=await this._readIFD(i,n,r,s,Tu.TIFF_TAGS,o,a);if(e.push(l.ifd),!l.nextIFD)return null;await this._readIFDs(e,i,n,l.nextIFD-s,s,o,a)}async _readIFD(e,i,n,r,s=Tu.TIFF_TAGS,o=4,a){var c,u;if(!e)return null;const l=Kle(e,i,n,r,s,o);if(l.success){const d=[];if((c=l.ifd)==null||c.forEach(f=>{f.values||d.push(f)}),d.length>0){const f=d.map(g=>g.offlineOffsetSize).filter(Ti),m=Math.min.apply(null,f.map(g=>g[0]));if(Math.min.apply(null,f.map(g=>g[0]+g[1]))-m<=this._bufferSize){const{data:g}=await this.request(this.url,{range:{from:m,to:m+this._bufferSize},responseType:"array-buffer",signal:a});e=g,r=m,d.forEach(y=>Yle(e,i,y,r))}}if((u=l.ifd)!=null&&u.has("GEOKEYDIRECTORY")){const f=l.ifd.get("GEOKEYDIRECTORY"),m=f==null?void 0:f.values;if(m&&m.length>4){const g=m[0]+"."+m[1]+"."+m[2],y=await this._readIFD(e,i,f.valueOffset+6-r,r,Tu.GEO_KEYS,2,a);f.data=y.ifd,f.data&&f.data.set("GEOTIFFVersion",{id:0,type:2,valueCount:1,valueOffset:null,values:[g]})}}return l}if(l.requiredBufferSize&&l.requiredBufferSize!==e.byteLength)return(e=(await this.request(this.url,{range:{from:r,to:r+l.requiredBufferSize+4},responseType:"array-buffer",signal:a})).data).byteLength<l.requiredBufferSize?null:this._readIFD(e,i,0,r,Tu.TIFF_TAGS,4,a)}async _fetchRawTiffTile(e,i,n,r,s={}){const o=this._getTileLocation(e,i,n,r);if(!o)return null;const{ranges:a,actualTileWidth:l,actualTileHeight:c,ifd:u}=o,d=a.map(C=>this.request(this.url,{range:C,responseType:"array-buffer",signal:s.signal})),f=await Promise.all(d),m=f.map(C=>C.data.byteLength).reduce((C,M)=>C+M),g=f.length===1?f[0].data:new ArrayBuffer(m),y=[0],_=[0];if(f.length>1){const C=new Uint8Array(g);for(let M=0,E=0;M<f.length;M++){const A=f[M].data;C.set(new Uint8Array(A),E),y[M]=E,E+=A.byteLength,_[M]=A.byteLength}}const{blockWidth:b,blockHeight:w}=this.getBlockWidthHeight(e),x=await this.decodePixelBlock(g,{format:"tiff",customOptions:{headerInfo:this._headerInfo,ifd:u,offsets:y,sizes:_},width:b,height:w,planes:null,pixelType:null});if(x==null)return null;let S,T,I;if(l!==b||c!==w){let C=x.mask;if(C)for(S=0;S<w;S++)if(I=S*b,S<c)for(T=l;T<b;T++)C[I+T]=0;else for(T=0;T<b;T++)C[I+T]=0;else for(C=new Uint8Array(b*w),x.mask=C,S=0;S<c;S++)for(I=S*b,T=0;T<l;T++)C[I+T]=1}return x}_getTileLocation(e,i,n,r=!1){const{firstPyramidLevel:s,blockBoundary:o}=this.rasterInfo.storageInfo,a=e===0?0:e-(s-1),{_headerInfo:l}=this;if(!l)return null;const c=r?l.maskIFDs[a]:a===0?l==null?void 0:l.ifds[0]:l==null?void 0:l.pyramidIFDs[a-1];if(!c)return null;const u=dT(c,l),d=OO(c,"TILEOFFSETS");if(d===void 0)return null;const f=OO(c,"TILEBYTECOUNTS"),{minRow:m,minCol:g,maxRow:y,maxCol:_}=o[a];if(i>y||n>_||i<m||n<g)return null;const b=R1(c,"IMAGEWIDTH"),w=R1(c,"IMAGELENGTH"),x=R1(c,"TILEWIDTH"),S=R1(c,"TILELENGTH"),T=[];if(u){const{bandCount:I}=this.rasterInfo;for(let C=0;C<I;C++){const M=C*(y+1)*(_+1)+i*(_+1)+n;T[C]={from:d[M],to:d[M]+f[M]-1}}}else{const I=i*(_+1)+n;T.push({from:d[I],to:d[I]+f[I]-1})}for(let I=0;I<T.length;I++)if(T[I].from==null||!T[I].to)return null;return{ranges:T,ifd:c,actualTileWidth:n===_&&b%x||x,actualTileHeight:i===y&&w%S||S}}async _fetchAuxiliaryMetaData(e){try{const{data:i}=await this.request(this.url+".aux.xml",{responseType:"xml",signal:e==null?void 0:e.signal});return Wj(i)}catch{return null}}async _fetchAuxiliaryTable(e){try{const{data:i}=await this.request(this.url+".vat.dbf",{responseType:"array-buffer",signal:e==null?void 0:e.signal}),n=_ce.parse(i);return n!=null&&n.recordSet?oT.fromJSON(n.recordSet):null}catch{return null}}};h([p()],Eg.prototype,"_files",void 0),h([p()],Eg.prototype,"_headerInfo",void 0),h([p()],Eg.prototype,"_bufferSize",void 0),h([p({type:String,json:{write:!0}})],Eg.prototype,"datasetFormat",void 0),Eg=h([P("esri.layers.support.rasterDatasets.TIFFRaster")],Eg);const RVe=Eg,Mo=new Map;Mo.set("CRF",{desc:"Cloud Raster Format",constructor:TVe}),Mo.set("MRF",{desc:"Meta Raster Format",constructor:LVe}),Mo.set("TIFF",{desc:"GeoTIFF",constructor:RVe}),Mo.set("RasterTileServer",{desc:"Raster Tile Server",constructor:OVe}),Mo.set("JPG",{desc:"JPG Raster Format",constructor:BI}),Mo.set("PNG",{desc:"PNG Raster Format",constructor:BI}),Mo.set("GIF",{desc:"GIF Raster Format",constructor:BI}),Mo.set("BMP",{desc:"BMP Raster Format",constructor:BI});let DVe=class{static get supportedFormats(){const e=new Set;return Mo.forEach((i,n)=>e.add(n)),e}static async open(e){const{url:i,ioConfig:n,sourceJSON:r}=e;let s=e.datasetFormat;s==null&&i.lastIndexOf(".")&&(s=i.slice(i.lastIndexOf(".")+1).toUpperCase()),s==="OVR"||s==="TIF"?s="TIFF":s!=="JPG"&&s!=="JPEG"&&s!=="JFIF"||(s="JPG"),i.toLowerCase().includes("/imageserver")&&!i.toLowerCase().includes("/wcsserver")&&(s="RasterTileServer");const o={url:i,sourceJSON:r,datasetFormat:s,ioConfig:n??{bandIds:null,sampling:null}};let a,l;if(s&&this.supportedFormats.has(s)){if(s==="CRF"&&!(n!=null&&n.enableCRF))throw new V("rasterfactory:open",`cannot open raster: ${i}`);return a=Mo.get(s).constructor,l=new a(o),await l.open({signal:e.signal}),l}if(s)throw new V("rasterfactory:open","not a supported format "+s);const c=Array.from(Mo.keys());let u=0;const d=()=>(s=c[u++],s&&(s!=="CRF"||n!=null&&n.enableCRF)?(a=Mo.get(s).constructor,l=new a(o),l.open({signal:e.signal}).then(()=>l).catch(()=>d())):null);return d()}static register(e,i,n){Mo.has(e.toUpperCase())||Mo.set(e.toUpperCase(),{desc:i,constructor:n})}},mr=class extends cj(_j(jae(Gae(Tae(yVe(Zae(sDe(Wae(ij(lP)))))))))){constructor(...e){super(...e),this._primaryRasters=[],this.bandIds=null,this.interpolation=null,this.legendEnabled=!0,this.isReference=null,this.listMode="show",this.sourceJSON=null,this.version=null,this.type="imagery-tile",this.operationalLayerType="ArcGISTiledImageServiceLayer",this.popupEnabled=!0,this.popupTemplate=null,this.fields=null}normalizeCtorArgs(e,i){return typeof e=="string"?{url:e,...i}:e}load(e){const i=e!=null?e.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Image Service"]},e).catch($o).then(()=>this._openRaster(i))),Promise.resolve(this)}get defaultPopupTemplate(){return this.createPopupTemplate()}get rasterFields(){var l;const e=[new dc({name:"Raster.ServicePixelValue",alias:"Pixel Value",domain:null,editable:!1,length:50,type:"string"}),new dc({name:"Raster.ServicePixelValue.Raw",alias:"Raw Pixel Value",domain:null,editable:!1,length:50,type:"string"})],{rasterInfo:i}=this,n=i==null?void 0:i.attributeTable,r=n!=null?n.fields:null,s="Raster.";if(r){const c=r.filter(u=>u.type!=="oid"&&u.name.toLowerCase()!=="value").map(u=>{const d=u.clone();return d.name=s+u.name,d});e.push(...c)}const o=i==null?void 0:i.dataType,a=i==null?void 0:i.multidimensionalInfo;if((o==="vector-magdir"||o==="vector-uv")&&a!=null){const c=(l=a.variables[0].unit)==null?void 0:l.trim(),u="Magnitude"+(c?` (${c})`:"");e.push(new dc({name:"Raster.Magnitude",alias:u,domain:null,editable:!1,type:"double"})),e.push(new dc({name:"Raster.Direction",alias:"Direction ()",domain:null,editable:!1,type:"double"}))}return e}createPopupTemplate(e){const{rasterFields:i}=this,n=new Set(i.map(({name:r})=>r).filter(r=>r.toLowerCase()!=="raster.servicepixelvalue.raw"));return Xae({fields:i,title:this.title},{...e,visibleFieldNames:n})}async generateRasterInfo(e,i){var n;if(!(e=t0(Jy,e)))return this.rasterInfo;try{const r={raster:this._primaryRasters[0]};this._primaryRasters.length>1&&this._primaryRasters.forEach(a=>r[a.url]=a);const s=z4(((n=e.functionDefinition)==null?void 0:n.toJSON())??e.toJSON(),r),o=new v4({rasterFunction:s});return await o.open(i),o.rasterInfo}catch(r){throw r instanceof V?r:new V("imagery-tile-layer","the given raster function is not supported")}}write(e,i){const n=this._primaryRasters[0]??this.raster;if(this.loaded?n.datasetFormat==="RasterTileServer"&&(n.tileType==="Raster"||n.tileType==="Map"):this.url&&/\/ImageServer(\/|\/?$)/i.test(this.url))return super.write(e,i);if(i&&i.messages){const r=`${i.origin}/${i.layerContainerType||"operational-layers"}`;i.messages.push(new V("layer:unsupported",`Layers (${this.title}, ${this.id}) of type '${this.declaredClass}' are not supported in the context of '${r}'`,{layer:this}))}return null}async _openRaster(e){var r;let i=!1;if(this.raster)this.raster.rasterInfo||await this.raster.open(),this.raster.datasetFormat==="Function"?(i=!0,this._primaryRasters=this.raster.primaryRasters.rasters):this._primaryRasters=[this.raster],this.url=this.raster.url;else{const{rasterFunction:s}=this,o=[this.url];s&&uce(s.toJSON(),o);const a=await Promise.all(o.map(c=>DVe.open({url:c,sourceJSON:this.sourceJSON,ioConfig:{sampling:"closest",...this.ioConfig,customFetchParameters:this.customParameters},signal:e}))),l=a.findIndex(c=>c==null);if(l>-1)throw new V("imagery-tile-layer:open",`cannot open raster: ${o[l]}`);if(this._primaryRasters=a,s){const c={raster:this._primaryRasters[0]};this._primaryRasters.length>1&&this._primaryRasters.forEach(f=>c[f.url]=f);const u=z4(((r=s.functionDefinition)==null?void 0:r.toJSON())??s.toJSON(),c),d=new v4({rasterFunction:u});try{await d.open(),this.raster=d}catch(f){const m=ne.getLogger(this);f instanceof V&&m.error("imagery-tile-layer:open",f.message),m.warn("imagery-tile-layer:open","the raster function cannot be applied and is removed"),this._set("rasterFunction",null),this.raster=a[0]}}else this.raster=a[0]}const n=this.raster.rasterInfo;if(!n)throw new V("imagery-tile-layer:load","cannot load resources on "+this.url);if(this._set("rasterInfo",i?n:this._primaryRasters[0].rasterInfo),this._set("spatialReference",n.spatialReference),this.sourceJSON=this.sourceJSON||this.raster.sourceJSON,this.sourceJSON!=null){const s=this.raster.tileType==="Map"&&this.sourceJSON.minLOD!=null&&this.sourceJSON.maxLOD!=null?this.sourceJSON:{...this.sourceJSON,minScale:0,maxScale:0};this.read(s,{origin:"service"})}else this.read({tileInfo:this.rasterInfo.storageInfo.tileInfo.toJSON()},{origin:"service"});this.title||(this.title=this.raster.datasetName),this.raster.tileType==="Map"&&(this.popupEnabled=!1),this._configDefaultSettings(),this.addHandles(Q(()=>this.customParameters,s=>{this.raster&&(this.raster.ioConfig.customFetchParameters=s)}))}};h([p()],mr.prototype,"_primaryRasters",void 0),h([p({type:[It],json:{write:{overridePolicy(){var t;return{enabled:!this.loaded||this.raster.tileType==="Raster"||((t=this.bandIds)==null?void 0:t.join(","))!=="0,1,2"}}}}})],mr.prototype,"bandIds",void 0),h([p({json:{write:{overridePolicy(){return{enabled:!this.loaded||this.raster.tileType==="Raster"||this.interpolation!=="bilinear"}}}}}),be(GNe)],mr.prototype,"interpolation",void 0),h([p(Mae)],mr.prototype,"legendEnabled",void 0),h([p({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],mr.prototype,"isReference",void 0),h([p({type:["show","hide"]})],mr.prototype,"listMode",void 0),h([p({json:{read:!0,write:!0}})],mr.prototype,"blendMode",void 0),h([p()],mr.prototype,"sourceJSON",void 0),h([p({readOnly:!0,json:{origins:{service:{read:{source:"currentVersion"}}}}})],mr.prototype,"version",void 0),h([p({readOnly:!0,json:{read:!1}})],mr.prototype,"type",void 0),h([p({type:["ArcGISTiledImageServiceLayer"]})],mr.prototype,"operationalLayerType",void 0),h([p({type:Boolean,value:!0,json:{read:{source:"disablePopup",reader:(t,e)=>!e.disablePopup},write:{target:"disablePopup",overridePolicy(){return{enabled:!this.loaded||this.raster.tileType==="Raster"}},writer(t,e,i){e[i]=!t}}}})],mr.prototype,"popupEnabled",void 0),h([p({type:Jf,json:{read:{source:"popupInfo"},write:{target:"popupInfo",overridePolicy(){return{enabled:!this.loaded||this.raster.tileType==="Raster"}}}}})],mr.prototype,"popupTemplate",void 0),h([p({readOnly:!0})],mr.prototype,"defaultPopupTemplate",null),h([p({readOnly:!0,type:[dc]})],mr.prototype,"fields",void 0),h([p({readOnly:!0,type:[dc]})],mr.prototype,"rasterFields",null),mr=h([P("esri.layers.ImageryTileLayer")],mr);const Sce=mr,emt=Object.freeze(Object.defineProperty({__proto__:null,default:Sce},Symbol.toStringTag,{value:"Module"}));let Ba=class extends ye{constructor(e){super(e),this._basemapCache={},this._loadingProjectionEngine=!1,this.nextBasemap=QC("hybrid",this._basemapCache),this.view=null}initialize(){Q(()=>this.nextBasemap,e=>{e&&!e.loaded&&e.load().catch(()=>{})},He)}destroy(){this.view=null,Iee(this._basemapCache),this._basemapCache=null}get _nextBasemapSpatialReferenceTask(){return R1e(this.view,this.nextBasemap)}get _viewSpatialReferenceLocked(){const{view:e}=this;return!e||!("spatialReferenceLocked"in e)||e.spatialReferenceLocked}get activeBasemap(){var e,i;return QC(((i=(e=this.view)==null?void 0:e.map)==null?void 0:i.basemap)??"topo-vector",this._basemapCache)}castNextBasemap(e){return QC(e,this._basemapCache)}get state(){const{view:e}=this;if(!(e!=null&&e.ready)||this._nextBasemapSpatialReferenceTask.updating)return"disabled";const{spatialReference:i}=this._nextBasemapSpatialReferenceTask;return this._viewSpatialReferenceLocked&&i!=null&&!e.spatialReference.equals(i)?"incompatible-next-basemap":this._loadingProjectionEngine?"loading":"ready"}async toggle(){const{activeBasemap:e,nextBasemap:i,state:n,view:r}=this;if(!r||n==="disabled"||n==="incompatible-next-basemap")return;const s=this._viewSpatialReferenceLocked;if(!s){if(await Lu(()=>!this._nextBasemapSpatialReferenceTask.updating),i!==this.nextBasemap||e!==this.activeBasemap)return;const{spatialReference:o}=this._nextBasemapSpatialReferenceTask;if(o==null||En(r.spatialReference,o)||wl()||yl(r.spatialReference,o)||(this._loadingProjectionEngine=!0,await Ic(),this._loadingProjectionEngine=!1),i!==this.nextBasemap||e!==this.activeBasemap)return}r.map.basemap=i,s||this._nextBasemapSpatialReferenceTask.spatialReference==null||En(r.spatialReference,this._nextBasemapSpatialReferenceTask.spatialReference)||(r.spatialReference=this._nextBasemapSpatialReferenceTask.spatialReference),this.nextBasemap=e}static getThumbnailUrl(e){if(!e)return null;const{thumbnailUrl:i}=e;if(i)return i;const n=L1e(e);if(n)return eb[n].thumbnailUrl;const r=e.baseLayers.find(s=>!!IR(s)().get("portalItem.thumbnailUrl"));return r?IR(r)().get("portalItem.thumbnailUrl"):null}};h([p()],Ba.prototype,"_loadingProjectionEngine",void 0),h([p({readOnly:!0})],Ba.prototype,"_nextBasemapSpatialReferenceTask",null),h([p({readOnly:!0})],Ba.prototype,"_viewSpatialReferenceLocked",null),h([p({readOnly:!0})],Ba.prototype,"activeBasemap",null),h([p()],Ba.prototype,"nextBasemap",void 0),h([ut("nextBasemap")],Ba.prototype,"castNextBasemap",null),h([p({readOnly:!0})],Ba.prototype,"state",null),h([p()],Ba.prototype,"view",void 0),h([p()],Ba.prototype,"toggle",null),Ba=h([P("esri.widgets.BasemapToggle.BasemapToggleViewModel")],Ba);const Jj=Ba,Aa={base:"esri-basemap-toggle esri-widget",secondaryBasemapImage:"esri-basemap-toggle__image--secondary",container:"esri-basemap-thumbnail esri-basemap-toggle__container",image:"esri-basemap-thumbnail__image esri-basemap-toggle__image",imageLoading:"esri-basemap-toggle__image--loading",overlay:"esri-basemap-thumbnail__overlay esri-basemap-toggle__image-overlay",title:"esri-basemap-thumbnail__title esri-basemap-toggle__title",overlayScrim:"esri-basemap-thumbnail__overlay-scrim",disabled:"esri-disabled",loaderAnimation:"esri-widget__loader-animation"};function Oq(t){const e=Jj.getThumbnailUrl(t);return e?{backgroundImage:"url("+e+")"}:{backgroundImage:""}}const Lq={title:!1};let Ua=class extends qi{constructor(e,i){super(e,i),this.messages=null,this.viewModel=new Jj,this.visibleElements={...Lq}}loadDependencies(){return NP({icon:()=>Y(()=>import("./calcite-icon-83ed4825.js"),["./calcite-icon-83ed4825.js","./icon-26983b54.js","./observers-9352e65c.js"],import.meta.url),scrim:()=>Y(()=>import("./calcite-scrim-223224cc.js"),["./calcite-scrim-223224cc.js","./scrim-33d83c8e.js","./t9n-9eda9136.js","./observers-9352e65c.js","./loader-9ff8d54d.js","./guid-40d04074.js"],import.meta.url)})}get activeBasemap(){return this.viewModel.activeBasemap}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get nextBasemap(){return this.viewModel.nextBasemap}set nextBasemap(e){this.viewModel.nextBasemap=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}castVisibleElements(e){return{...Lq,...e}}toggle(){return this.viewModel.toggle()}render(){const e=this.viewModel,i=e.state==="disabled"?null:e.activeBasemap,n=e.state==="disabled"?null:e.nextBasemap,r=e.state==="loading",s=e.state==="incompatible-next-basemap",o=n?n.title:"",a=n&&n.loadStatus!=="loaded";let l;const c=this.visibleElements.title&&o,u=s;return(c||u)&&(l=O("div",{class:Aa.overlay,key:"overlay"},c?O("span",{class:Aa.title,title:o},o):null,u?O("calcite-scrim",{class:Aa.overlayScrim,title:this.messages.incompatibleSpatialReference},O("calcite-icon",{icon:"exclamation-mark-triangle"})):null)),O("div",{class:this.classes(Aa.base,s?Aa.disabled:null),role:"button","data-basemap-id":n?n.id:"",bind:this,onclick:this._toggle,onkeydown:this._toggle,tabIndex:s?-1:0,title:this.label},O("div",{class:this.classes(Aa.container,Aa.secondaryBasemapImage)},O("div",{class:Aa.image,styles:Oq(i)})),O("div",{class:Aa.container},O("div",{class:this.classes(Aa.image,a?Aa.imageLoading:null),styles:Oq(n)},a||r?O("calcite-scrim",null,O("span",{"aria-hidden":"true",role:"presentation",class:Aa.loaderAnimation})):null),l))}_toggle(){this.toggle()}};h([p({readOnly:!0})],Ua.prototype,"activeBasemap",null),h([p()],Ua.prototype,"label",null),h([p(),Zt("esri/widgets/BasemapToggle/t9n/BasemapToggle")],Ua.prototype,"messages",void 0),h([p()],Ua.prototype,"nextBasemap",null),h([p()],Ua.prototype,"view",null),h([p({type:Jj})],Ua.prototype,"viewModel",void 0),h([p()],Ua.prototype,"visibleElements",void 0),h([ut("visibleElements")],Ua.prototype,"castVisibleElements",null),h([Dr()],Ua.prototype,"_toggle",null),Ua=h([P("esri.widgets.BasemapToggle")],Ua);const NVe=Ua;function Tce(t){return t&&typeof t.highlight=="function"}function nmt(t,e,i){return t==null||t>i&&(e===0||t<e)}var iE;let Ga=iE=class extends ye{constructor(t){super(t),this.autoCloseMenu=!1,this.iconClass=null,this.items=null,this.label=null,this.open=!1,this.selected=!1,this.selectionEnabled=!1,this.clickFunction=null}castItems(t){return t?t.map(e=>e instanceof iE?e:new iE(e)):null}};h([p()],Ga.prototype,"autoCloseMenu",void 0),h([p()],Ga.prototype,"iconClass",void 0),h([p()],Ga.prototype,"items",void 0),h([ut("items")],Ga.prototype,"castItems",null),h([p()],Ga.prototype,"label",void 0),h([p()],Ga.prototype,"open",void 0),h([p()],Ga.prototype,"selected",void 0),h([p()],Ga.prototype,"selectionEnabled",void 0),h([p()],Ga.prototype,"clickFunction",void 0),Ga=iE=h([P("esri.widgets.FeatureTable.Grid.support.ButtonMenuItem")],Ga);const lu=Ga;let Wv=class extends ye{constructor(e){super(e),this.items=null,this.open=!1}castItems(e){return e?e.map(i=>i instanceof lu?i:new lu(i)):null}};h([p()],Wv.prototype,"items",void 0),h([ut("items")],Wv.prototype,"castItems",null),h([p()],Wv.prototype,"open",void 0),Wv=h([P("esri.widgets.FeatureTable.Grid.support.ButtonMenuViewModel")],Wv);const FVe=Wv;function xa(t){if(t==null)return window;if(t.toString()!=="[object Window]"){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function Xy(t){var e=xa(t).Element;return t instanceof e||t instanceof Element}function cl(t){var e=xa(t).HTMLElement;return t instanceof e||t instanceof HTMLElement}function Zj(t){if(typeof ShadowRoot>"u")return!1;var e=xa(t).ShadowRoot;return t instanceof e||t instanceof ShadowRoot}var Iy=Math.max,e$=Math.min,yb=Math.round;function K4(){var t=navigator.userAgentData;return t!=null&&t.brands&&Array.isArray(t.brands)?t.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function Ice(){return!/^((?!chrome|android).)*safari/i.test(K4())}function vb(t,e,i){e===void 0&&(e=!1),i===void 0&&(i=!1);var n=t.getBoundingClientRect(),r=1,s=1;e&&cl(t)&&(r=t.offsetWidth>0&&yb(n.width)/t.offsetWidth||1,s=t.offsetHeight>0&&yb(n.height)/t.offsetHeight||1);var o=Xy(t)?xa(t):window,a=o.visualViewport,l=!Ice()&&i,c=(n.left+(l&&a?a.offsetLeft:0))/r,u=(n.top+(l&&a?a.offsetTop:0))/s,d=n.width/r,f=n.height/s;return{width:d,height:f,top:u,right:c+d,bottom:u+f,left:c,x:c,y:u}}function Yj(t){var e=xa(t),i=e.pageXOffset,n=e.pageYOffset;return{scrollLeft:i,scrollTop:n}}function zVe(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}function VVe(t){return t===xa(t)||!cl(t)?Yj(t):zVe(t)}function Nu(t){return t?(t.nodeName||"").toLowerCase():null}function im(t){return((Xy(t)?t.ownerDocument:t.document)||window.document).documentElement}function Xj(t){return vb(im(t)).left+Yj(t).scrollLeft}function hd(t){return xa(t).getComputedStyle(t)}function Kj(t){var e=hd(t),i=e.overflow,n=e.overflowX,r=e.overflowY;return/auto|scroll|overlay|hidden/.test(i+r+n)}function jVe(t){var e=t.getBoundingClientRect(),i=yb(e.width)/t.offsetWidth||1,n=yb(e.height)/t.offsetHeight||1;return i!==1||n!==1}function BVe(t,e,i){i===void 0&&(i=!1);var n=cl(e),r=cl(e)&&jVe(e),s=im(e),o=vb(t,r,i),a={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(n||!n&&!i)&&((Nu(e)!=="body"||Kj(s))&&(a=VVe(e)),cl(e)?(l=vb(e,!0),l.x+=e.clientLeft,l.y+=e.clientTop):s&&(l.x=Xj(s))),{x:o.left+a.scrollLeft-l.x,y:o.top+a.scrollTop-l.y,width:o.width,height:o.height}}function Qj(t){var e=vb(t),i=t.offsetWidth,n=t.offsetHeight;return Math.abs(e.width-i)<=1&&(i=e.width),Math.abs(e.height-n)<=1&&(n=e.height),{x:t.offsetLeft,y:t.offsetTop,width:i,height:n}}function lk(t){return Nu(t)==="html"?t:t.assignedSlot||t.parentNode||(Zj(t)?t.host:null)||im(t)}function Cce(t){return["html","body","#document"].indexOf(Nu(t))>=0?t.ownerDocument.body:cl(t)&&Kj(t)?t:Cce(lk(t))}function Kx(t,e){var i;e===void 0&&(e=[]);var n=Cce(t),r=n===((i=t.ownerDocument)==null?void 0:i.body),s=xa(n),o=r?[s].concat(s.visualViewport||[],Kj(n)?n:[]):n,a=e.concat(o);return r?a:a.concat(Kx(lk(o)))}function UVe(t){return["table","td","th"].indexOf(Nu(t))>=0}function Rq(t){return!cl(t)||hd(t).position==="fixed"?null:t.offsetParent}function GVe(t){var e=/firefox/i.test(K4()),i=/Trident/i.test(K4());if(i&&cl(t)){var n=hd(t);if(n.position==="fixed")return null}var r=lk(t);for(Zj(r)&&(r=r.host);cl(r)&&["html","body"].indexOf(Nu(r))<0;){var s=hd(r);if(s.transform!=="none"||s.perspective!=="none"||s.contain==="paint"||["transform","perspective"].indexOf(s.willChange)!==-1||e&&s.willChange==="filter"||e&&s.filter&&s.filter!=="none")return r;r=r.parentNode}return null}function pT(t){for(var e=xa(t),i=Rq(t);i&&UVe(i)&&hd(i).position==="static";)i=Rq(i);return i&&(Nu(i)==="html"||Nu(i)==="body"&&hd(i).position==="static")?e:i||GVe(t)||e}var No="top",vl="bottom",_l="right",Fo="left",e8="auto",fT=[No,vl,_l,Fo],_b="start",nS="end",HVe="clippingParents",Mce="viewport",D1="popper",qVe="reference",Dq=fT.reduce(function(t,e){return t.concat([e+"-"+_b,e+"-"+nS])},[]),Ece=[].concat(fT,[e8]).reduce(function(t,e){return t.concat([e,e+"-"+_b,e+"-"+nS])},[]),WVe="beforeRead",JVe="read",ZVe="afterRead",YVe="beforeMain",XVe="main",KVe="afterMain",QVe="beforeWrite",eje="write",tje="afterWrite",ije=[WVe,JVe,ZVe,YVe,XVe,KVe,QVe,eje,tje];function nje(t){var e=new Map,i=new Set,n=[];t.forEach(function(s){e.set(s.name,s)});function r(s){i.add(s.name);var o=[].concat(s.requires||[],s.requiresIfExists||[]);o.forEach(function(a){if(!i.has(a)){var l=e.get(a);l&&r(l)}}),n.push(s)}return t.forEach(function(s){i.has(s.name)||r(s)}),n}function rje(t){var e=nje(t);return ije.reduce(function(i,n){return i.concat(e.filter(function(r){return r.phase===n}))},[])}function sje(t){var e;return function(){return e||(e=new Promise(function(i){Promise.resolve().then(function(){e=void 0,i(t())})})),e}}function oje(t){var e=t.reduce(function(i,n){var r=i[n.name];return i[n.name]=r?Object.assign({},r,n,{options:Object.assign({},r.options,n.options),data:Object.assign({},r.data,n.data)}):n,i},{});return Object.keys(e).map(function(i){return e[i]})}function aje(t,e){var i=xa(t),n=im(t),r=i.visualViewport,s=n.clientWidth,o=n.clientHeight,a=0,l=0;if(r){s=r.width,o=r.height;var c=Ice();(c||!c&&e==="fixed")&&(a=r.offsetLeft,l=r.offsetTop)}return{width:s,height:o,x:a+Xj(t),y:l}}function lje(t){var e,i=im(t),n=Yj(t),r=(e=t.ownerDocument)==null?void 0:e.body,s=Iy(i.scrollWidth,i.clientWidth,r?r.scrollWidth:0,r?r.clientWidth:0),o=Iy(i.scrollHeight,i.clientHeight,r?r.scrollHeight:0,r?r.clientHeight:0),a=-n.scrollLeft+Xj(t),l=-n.scrollTop;return hd(r||i).direction==="rtl"&&(a+=Iy(i.clientWidth,r?r.clientWidth:0)-s),{width:s,height:o,x:a,y:l}}function Ace(t,e){var i=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(i&&Zj(i)){var n=e;do{if(n&&t.isSameNode(n))return!0;n=n.parentNode||n.host}while(n)}return!1}function Q4(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function cje(t,e){var i=vb(t,!1,e==="fixed");return i.top=i.top+t.clientTop,i.left=i.left+t.clientLeft,i.bottom=i.top+t.clientHeight,i.right=i.left+t.clientWidth,i.width=t.clientWidth,i.height=t.clientHeight,i.x=i.left,i.y=i.top,i}function Nq(t,e,i){return e===Mce?Q4(aje(t,i)):Xy(e)?cje(e,i):Q4(lje(im(t)))}function uje(t){var e=Kx(lk(t)),i=["absolute","fixed"].indexOf(hd(t).position)>=0,n=i&&cl(t)?pT(t):t;return Xy(n)?e.filter(function(r){return Xy(r)&&Ace(r,n)&&Nu(r)!=="body"}):[]}function hje(t,e,i,n){var r=e==="clippingParents"?uje(t):[].concat(e),s=[].concat(r,[i]),o=s[0],a=s.reduce(function(l,c){var u=Nq(t,c,n);return l.top=Iy(u.top,l.top),l.right=e$(u.right,l.right),l.bottom=e$(u.bottom,l.bottom),l.left=Iy(u.left,l.left),l},Nq(t,o,n));return a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,a}function Eu(t){return t.split("-")[0]}function bb(t){return t.split("-")[1]}function t8(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function $ce(t){var e=t.reference,i=t.element,n=t.placement,r=n?Eu(n):null,s=n?bb(n):null,o=e.x+e.width/2-i.width/2,a=e.y+e.height/2-i.height/2,l;switch(r){case No:l={x:o,y:e.y-i.height};break;case vl:l={x:o,y:e.y+e.height};break;case _l:l={x:e.x+e.width,y:a};break;case Fo:l={x:e.x-i.width,y:a};break;default:l={x:e.x,y:e.y}}var c=r?t8(r):null;if(c!=null){var u=c==="y"?"height":"width";switch(s){case _b:l[c]=l[c]-(e[u]/2-i[u]/2);break;case nS:l[c]=l[c]+(e[u]/2-i[u]/2);break}}return l}function Pce(){return{top:0,right:0,bottom:0,left:0}}function kce(t){return Object.assign({},Pce(),t)}function Oce(t,e){return e.reduce(function(i,n){return i[n]=t,i},{})}function rS(t,e){e===void 0&&(e={});var i=e,n=i.placement,r=n===void 0?t.placement:n,s=i.strategy,o=s===void 0?t.strategy:s,a=i.boundary,l=a===void 0?HVe:a,c=i.rootBoundary,u=c===void 0?Mce:c,d=i.elementContext,f=d===void 0?D1:d,m=i.altBoundary,g=m===void 0?!1:m,y=i.padding,_=y===void 0?0:y,b=kce(typeof _!="number"?_:Oce(_,fT)),w=f===D1?qVe:D1,x=t.rects.popper,S=t.elements[g?w:f],T=hje(Xy(S)?S:S.contextElement||im(t.elements.popper),l,u,o),I=vb(t.elements.reference),C=$ce({reference:I,element:x,strategy:"absolute",placement:r}),M=Q4(Object.assign({},x,C)),E=f===D1?M:I,A={top:T.top-E.top+b.top,bottom:E.bottom-T.bottom+b.bottom,left:T.left-E.left+b.left,right:E.right-T.right+b.right},$=t.modifiersData.offset;if(f===D1&&$){var L=$[r];Object.keys(A).forEach(function(D){var F=[_l,vl].indexOf(D)>=0?1:-1,z=[No,vl].indexOf(D)>=0?"y":"x";A[D]+=L[z]*F})}return A}var Fq={placement:"bottom",modifiers:[],strategy:"absolute"};function zq(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return!e.some(function(n){return!(n&&typeof n.getBoundingClientRect=="function")})}function dje(t){t===void 0&&(t={});var e=t,i=e.defaultModifiers,n=i===void 0?[]:i,r=e.defaultOptions,s=r===void 0?Fq:r;return function(a,l,c){c===void 0&&(c=s);var u={placement:"bottom",orderedModifiers:[],options:Object.assign({},Fq,s),modifiersData:{},elements:{reference:a,popper:l},attributes:{},styles:{}},d=[],f=!1,m={state:u,setOptions:function(b){var w=typeof b=="function"?b(u.options):b;y(),u.options=Object.assign({},s,u.options,w),u.scrollParents={reference:Xy(a)?Kx(a):a.contextElement?Kx(a.contextElement):[],popper:Kx(l)};var x=rje(oje([].concat(n,u.options.modifiers)));return u.orderedModifiers=x.filter(function(S){return S.enabled}),g(),m.update()},forceUpdate:function(){if(!f){var b=u.elements,w=b.reference,x=b.popper;if(zq(w,x)){u.rects={reference:BVe(w,pT(x),u.options.strategy==="fixed"),popper:Qj(x)},u.reset=!1,u.placement=u.options.placement,u.orderedModifiers.forEach(function(A){return u.modifiersData[A.name]=Object.assign({},A.data)});for(var S=0;S<u.orderedModifiers.length;S++){if(u.reset===!0){u.reset=!1,S=-1;continue}var T=u.orderedModifiers[S],I=T.fn,C=T.options,M=C===void 0?{}:C,E=T.name;typeof I=="function"&&(u=I({state:u,options:M,name:E,instance:m})||u)}}}},update:sje(function(){return new Promise(function(_){m.forceUpdate(),_(u)})}),destroy:function(){y(),f=!0}};if(!zq(a,l))return m;m.setOptions(c).then(function(_){!f&&c.onFirstUpdate&&c.onFirstUpdate(_)});function g(){u.orderedModifiers.forEach(function(_){var b=_.name,w=_.options,x=w===void 0?{}:w,S=_.effect;if(typeof S=="function"){var T=S({state:u,name:b,instance:m,options:x}),I=function(){};d.push(T||I)}})}function y(){d.forEach(function(_){return _()}),d=[]}return m}}var UI={passive:!0};function pje(t){var e=t.state,i=t.instance,n=t.options,r=n.scroll,s=r===void 0?!0:r,o=n.resize,a=o===void 0?!0:o,l=xa(e.elements.popper),c=[].concat(e.scrollParents.reference,e.scrollParents.popper);return s&&c.forEach(function(u){u.addEventListener("scroll",i.update,UI)}),a&&l.addEventListener("resize",i.update,UI),function(){s&&c.forEach(function(u){u.removeEventListener("scroll",i.update,UI)}),a&&l.removeEventListener("resize",i.update,UI)}}const fje={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:pje,data:{}};function mje(t){var e=t.state,i=t.name;e.modifiersData[i]=$ce({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})}const gje={name:"popperOffsets",enabled:!0,phase:"read",fn:mje,data:{}};var yje={top:"auto",right:"auto",bottom:"auto",left:"auto"};function vje(t,e){var i=t.x,n=t.y,r=e.devicePixelRatio||1;return{x:yb(i*r)/r||0,y:yb(n*r)/r||0}}function Vq(t){var e,i=t.popper,n=t.popperRect,r=t.placement,s=t.variation,o=t.offsets,a=t.position,l=t.gpuAcceleration,c=t.adaptive,u=t.roundOffsets,d=t.isFixed,f=o.x,m=f===void 0?0:f,g=o.y,y=g===void 0?0:g,_=typeof u=="function"?u({x:m,y}):{x:m,y};m=_.x,y=_.y;var b=o.hasOwnProperty("x"),w=o.hasOwnProperty("y"),x=Fo,S=No,T=window;if(c){var I=pT(i),C="clientHeight",M="clientWidth";if(I===xa(i)&&(I=im(i),hd(I).position!=="static"&&a==="absolute"&&(C="scrollHeight",M="scrollWidth")),I=I,r===No||(r===Fo||r===_l)&&s===nS){S=vl;var E=d&&I===T&&T.visualViewport?T.visualViewport.height:I[C];y-=E-n.height,y*=l?1:-1}if(r===Fo||(r===No||r===vl)&&s===nS){x=_l;var A=d&&I===T&&T.visualViewport?T.visualViewport.width:I[M];m-=A-n.width,m*=l?1:-1}}var $=Object.assign({position:a},c&&yje),L=u===!0?vje({x:m,y},xa(i)):{x:m,y};if(m=L.x,y=L.y,l){var D;return Object.assign({},$,(D={},D[S]=w?"0":"",D[x]=b?"0":"",D.transform=(T.devicePixelRatio||1)<=1?"translate("+m+"px, "+y+"px)":"translate3d("+m+"px, "+y+"px, 0)",D))}return Object.assign({},$,(e={},e[S]=w?y+"px":"",e[x]=b?m+"px":"",e.transform="",e))}function _je(t){var e=t.state,i=t.options,n=i.gpuAcceleration,r=n===void 0?!0:n,s=i.adaptive,o=s===void 0?!0:s,a=i.roundOffsets,l=a===void 0?!0:a,c={placement:Eu(e.placement),variation:bb(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:r,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,Vq(Object.assign({},c,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:o,roundOffsets:l})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,Vq(Object.assign({},c,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const bje={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:_je,data:{}};function wje(t){var e=t.state;Object.keys(e.elements).forEach(function(i){var n=e.styles[i]||{},r=e.attributes[i]||{},s=e.elements[i];!cl(s)||!Nu(s)||(Object.assign(s.style,n),Object.keys(r).forEach(function(o){var a=r[o];a===!1?s.removeAttribute(o):s.setAttribute(o,a===!0?"":a)}))})}function xje(t){var e=t.state,i={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,i.popper),e.styles=i,e.elements.arrow&&Object.assign(e.elements.arrow.style,i.arrow),function(){Object.keys(e.elements).forEach(function(n){var r=e.elements[n],s=e.attributes[n]||{},o=Object.keys(e.styles.hasOwnProperty(n)?e.styles[n]:i[n]),a=o.reduce(function(l,c){return l[c]="",l},{});!cl(r)||!Nu(r)||(Object.assign(r.style,a),Object.keys(s).forEach(function(l){r.removeAttribute(l)}))})}}const Sje={name:"applyStyles",enabled:!0,phase:"write",fn:wje,effect:xje,requires:["computeStyles"]};function Tje(t,e,i){var n=Eu(t),r=[Fo,No].indexOf(n)>=0?-1:1,s=typeof i=="function"?i(Object.assign({},e,{placement:t})):i,o=s[0],a=s[1];return o=o||0,a=(a||0)*r,[Fo,_l].indexOf(n)>=0?{x:a,y:o}:{x:o,y:a}}function Ije(t){var e=t.state,i=t.options,n=t.name,r=i.offset,s=r===void 0?[0,0]:r,o=Ece.reduce(function(u,d){return u[d]=Tje(d,e.rects,s),u},{}),a=o[e.placement],l=a.x,c=a.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=l,e.modifiersData.popperOffsets.y+=c),e.modifiersData[n]=o}const Cje={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:Ije};var Mje={left:"right",right:"left",bottom:"top",top:"bottom"};function nE(t){return t.replace(/left|right|bottom|top/g,function(e){return Mje[e]})}var Eje={start:"end",end:"start"};function jq(t){return t.replace(/start|end/g,function(e){return Eje[e]})}function Aje(t,e){e===void 0&&(e={});var i=e,n=i.placement,r=i.boundary,s=i.rootBoundary,o=i.padding,a=i.flipVariations,l=i.allowedAutoPlacements,c=l===void 0?Ece:l,u=bb(n),d=u?a?Dq:Dq.filter(function(g){return bb(g)===u}):fT,f=d.filter(function(g){return c.indexOf(g)>=0});f.length===0&&(f=d);var m=f.reduce(function(g,y){return g[y]=rS(t,{placement:y,boundary:r,rootBoundary:s,padding:o})[Eu(y)],g},{});return Object.keys(m).sort(function(g,y){return m[g]-m[y]})}function $je(t){if(Eu(t)===e8)return[];var e=nE(t);return[jq(t),e,jq(e)]}function Pje(t){var e=t.state,i=t.options,n=t.name;if(!e.modifiersData[n]._skip){for(var r=i.mainAxis,s=r===void 0?!0:r,o=i.altAxis,a=o===void 0?!0:o,l=i.fallbackPlacements,c=i.padding,u=i.boundary,d=i.rootBoundary,f=i.altBoundary,m=i.flipVariations,g=m===void 0?!0:m,y=i.allowedAutoPlacements,_=e.options.placement,b=Eu(_),w=b===_,x=l||(w||!g?[nE(_)]:$je(_)),S=[_].concat(x).reduce(function(de,we){return de.concat(Eu(we)===e8?Aje(e,{placement:we,boundary:u,rootBoundary:d,padding:c,flipVariations:g,allowedAutoPlacements:y}):we)},[]),T=e.rects.reference,I=e.rects.popper,C=new Map,M=!0,E=S[0],A=0;A<S.length;A++){var $=S[A],L=Eu($),D=bb($)===_b,F=[No,vl].indexOf(L)>=0,z=F?"width":"height",U=rS(e,{placement:$,boundary:u,rootBoundary:d,altBoundary:f,padding:c}),G=F?D?_l:Fo:D?vl:No;T[z]>I[z]&&(G=nE(G));var W=nE(G),Z=[];if(s&&Z.push(U[L]<=0),a&&Z.push(U[G]<=0,U[W]<=0),Z.every(function(de){return de})){E=$,M=!1;break}C.set($,Z)}if(M)for(var X=g?3:1,oe=function(we){var Re=S.find(function(ze){var Ct=C.get(ze);if(Ct)return Ct.slice(0,we).every(function(Ae){return Ae})});if(Re)return E=Re,"break"},se=X;se>0;se--){var le=oe(se);if(le==="break")break}e.placement!==E&&(e.modifiersData[n]._skip=!0,e.placement=E,e.reset=!0)}}const kje={name:"flip",enabled:!0,phase:"main",fn:Pje,requiresIfExists:["offset"],data:{_skip:!1}};function Oje(t){return t==="x"?"y":"x"}function Qx(t,e,i){return Iy(t,e$(e,i))}function Lje(t,e,i){var n=Qx(t,e,i);return n>i?i:n}function Rje(t){var e=t.state,i=t.options,n=t.name,r=i.mainAxis,s=r===void 0?!0:r,o=i.altAxis,a=o===void 0?!1:o,l=i.boundary,c=i.rootBoundary,u=i.altBoundary,d=i.padding,f=i.tether,m=f===void 0?!0:f,g=i.tetherOffset,y=g===void 0?0:g,_=rS(e,{boundary:l,rootBoundary:c,padding:d,altBoundary:u}),b=Eu(e.placement),w=bb(e.placement),x=!w,S=t8(b),T=Oje(S),I=e.modifiersData.popperOffsets,C=e.rects.reference,M=e.rects.popper,E=typeof y=="function"?y(Object.assign({},e.rects,{placement:e.placement})):y,A=typeof E=="number"?{mainAxis:E,altAxis:E}:Object.assign({mainAxis:0,altAxis:0},E),$=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,L={x:0,y:0};if(I){if(s){var D,F=S==="y"?No:Fo,z=S==="y"?vl:_l,U=S==="y"?"height":"width",G=I[S],W=G+_[F],Z=G-_[z],X=m?-M[U]/2:0,oe=w===_b?C[U]:M[U],se=w===_b?-M[U]:-C[U],le=e.elements.arrow,de=m&&le?Qj(le):{width:0,height:0},we=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:Pce(),Re=we[F],ze=we[z],Ct=Qx(0,C[U],de[U]),Ae=x?C[U]/2-X-Ct-Re-A.mainAxis:oe-Ct-Re-A.mainAxis,ke=x?-C[U]/2+X+Ct+ze+A.mainAxis:se+Ct+ze+A.mainAxis,jt=e.elements.arrow&&pT(e.elements.arrow),gn=jt?S==="y"?jt.clientTop||0:jt.clientLeft||0:0,_t=(D=$==null?void 0:$[S])!=null?D:0,zs=G+Ae-_t-gn,Gr=G+ke-_t,fi=Qx(m?e$(W,zs):W,G,m?Iy(Z,Gr):Z);I[S]=fi,L[S]=fi-G}if(a){var Fn,xl=S==="x"?No:Fo,Sl=S==="x"?vl:_l,Wi=I[T],Ji=T==="y"?"height":"width",lo=Wi+_[xl],Ie=Wi-_[Sl],Ze=[No,Fo].indexOf(b)!==-1,Mt=(Fn=$==null?void 0:$[T])!=null?Fn:0,Ni=Ze?lo:Wi-C[Ji]-M[Ji]-Mt+A.altAxis,si=Ze?Wi+C[Ji]+M[Ji]-Mt-A.altAxis:Ie,or=m&&Ze?Lje(Ni,Wi,si):Qx(m?Ni:lo,Wi,m?si:Ie);I[T]=or,L[T]=or-Wi}e.modifiersData[n]=L}}const Dje={name:"preventOverflow",enabled:!0,phase:"main",fn:Rje,requiresIfExists:["offset"]};var Nje=function(e,i){return e=typeof e=="function"?e(Object.assign({},i.rects,{placement:i.placement})):e,kce(typeof e!="number"?e:Oce(e,fT))};function Fje(t){var e,i=t.state,n=t.name,r=t.options,s=i.elements.arrow,o=i.modifiersData.popperOffsets,a=Eu(i.placement),l=t8(a),c=[Fo,_l].indexOf(a)>=0,u=c?"height":"width";if(!(!s||!o)){var d=Nje(r.padding,i),f=Qj(s),m=l==="y"?No:Fo,g=l==="y"?vl:_l,y=i.rects.reference[u]+i.rects.reference[l]-o[l]-i.rects.popper[u],_=o[l]-i.rects.reference[l],b=pT(s),w=b?l==="y"?b.clientHeight||0:b.clientWidth||0:0,x=y/2-_/2,S=d[m],T=w-f[u]-d[g],I=w/2-f[u]/2+x,C=Qx(S,I,T),M=l;i.modifiersData[n]=(e={},e[M]=C,e.centerOffset=C-I,e)}}function zje(t){var e=t.state,i=t.options,n=i.element,r=n===void 0?"[data-popper-arrow]":n;r!=null&&(typeof r=="string"&&(r=e.elements.popper.querySelector(r),!r)||Ace(e.elements.popper,r)&&(e.elements.arrow=r))}const Vje={name:"arrow",enabled:!0,phase:"main",fn:Fje,effect:zje,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Bq(t,e,i){return i===void 0&&(i={x:0,y:0}),{top:t.top-e.height-i.y,right:t.right-e.width+i.x,bottom:t.bottom-e.height+i.y,left:t.left-e.width-i.x}}function Uq(t){return[No,_l,vl,Fo].some(function(e){return t[e]>=0})}function jje(t){var e=t.state,i=t.name,n=e.rects.reference,r=e.rects.popper,s=e.modifiersData.preventOverflow,o=rS(e,{elementContext:"reference"}),a=rS(e,{altBoundary:!0}),l=Bq(o,n),c=Bq(a,r,s),u=Uq(l),d=Uq(c);e.modifiersData[i]={referenceClippingOffsets:l,popperEscapeOffsets:c,isReferenceHidden:u,hasPopperEscaped:d},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":d})}const Bje={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:jje};var Uje=[fje,gje,bje,Sje,Cje,kje,Dje,Vje,Bje],Gje=dje({defaultModifiers:Uje});const Hje=["bottom","bottom-start","bottom-end","left","left-start","left-end","right","right-start","right-end","top","top-start","top-end"],Gq={base:"esri-popover",open:"esri-popover--open"},qje={position:"fixed","z-index":"1000"};let ru=class extends qi{constructor(e,i){super(e,i),this._popper=null,this._contentNode=null,this._renderAttached=!1,this._rootNode=null,this.anchorElement=null,this.offset=[0,0],this.open=!1,this.renderContentFunction=null,this._afterRootCreate=n=>{this._rootNode=n},this._afterContentCreate=n=>{this._contentNode=n},this._updatePosition=()=>{this._popper!=null&&this._popper.update()}}initialize(){this.when(()=>{this.destroyed||(this._projector.append(document.body,this.render),this._renderAttached=!0)}),this.addHandles([Q(()=>[this.open,this.anchorElement],()=>this._buildPopper(),He),Q(()=>[this.placement,this.offset],()=>this._setPopperOptions(),He)])}destroy(){this.owner=null,this.anchorElement=null,this.renderContentFunction=null,this._renderAttached&&(this._projector.detach(this.render),this._renderAttached=!1),this._rootNode!=null&&(ACe(this._rootNode),this._rootNode=null),this._contentNode=null,this._popper!=null&&(this._popper.destroy(),this._popper=null)}set container(e){}set owner(e){this._set("owner",e)}get placement(){return"top"}set placement(e){Hje.includes(e)?this._override("placement",e):this._clearOverride("placement")}get test(){return{rootNode:this._rootNode}}render(){var r;const{open:e,owner:i,renderContentFunction:n}=this;return O("div",{afterCreate:this._afterRootCreate,class:this.classes(Gq.base,e?Gq.open:null),styles:qje,lang:xr()},O("div",{dir:ore((r=this.owner)==null?void 0:r.container),afterCreate:this._afterContentCreate,afterUpdate:this._updatePosition},e&&(n==null?void 0:n.call(i))))}_buildPopper(){this._popper!=null&&(this._popper.destroy(),this._popper=null);const e=this._contentNode;if(e==null||!this.open||!this.renderContentFunction)return;const i=this._getAnchor();i&&(this._popper=Gje(i,e),this._setPopperOptions())}_setPopperOptions(){const{placement:e,offset:i,_popper:n}=this;n!=null&&(n.setOptions({placement:e,modifiers:[{name:"offset",options:{offset:i}}]}),n.forceUpdate())}_getAnchor(){const{anchorElement:e}=this;return TP(typeof e=="function"?e():e)}};h([p()],ru.prototype,"anchorElement",void 0),h([p()],ru.prototype,"container",null),h([p()],ru.prototype,"offset",void 0),h([p()],ru.prototype,"open",void 0),h([p()],ru.prototype,"owner",null),h([p()],ru.prototype,"placement",null),h([p()],ru.prototype,"renderContentFunction",void 0),ru=h([P("esri.widgets.support.Popover")],ru);const i8=ru,Bs="esri-button-menu",us={base:Bs,content:`${Bs}__content`,contentWrapper:`${Bs}__content-wrapper`,itemWrapper:`${Bs}__item-wrapper`,label:`${Bs}__label`,icon:`${Bs}__icon`,item:`${Bs}__item`,itemLabel:`${Bs}__item-label`,itemLabelContent:`${Bs}__item-label-content`,selectableMenuItem:`${Bs}__item--selectable`,selectedMenuItem:`${Bs}__item--selected`,checkbox:`${Bs}__checkbox`,embeddedContentWrapper:`${Bs}__embedded-content-wrapper`,button:`${Bs}__button`,buttonSelected:`${Bs}__button--selected`,defaultIconClass:"esri-icon-menu",widget:"esri-widget"};let Tp=class extends kc(qi){constructor(e,i){super(e,i),this._menuContentNode=null,this._popover=null,this._rootNode=null,this.disabled=!1,this.iconClass="",this.viewModel=new FVe,this._handleOutsideClick=this._handleOutsideClick.bind(this)}postInitialize(){this._popover=new i8({owner:this,open:!!this.open,placement:Mc(this.container)?"bottom-start":"bottom-end",renderContentFunction:this.renderMenuContent,anchorElement:this._rootNode}),this.handles.add(Q(()=>this.open,e=>{var i;return(i=this._popover)==null?void 0:i.set("open",e)})),document.addEventListener("click",this._handleOutsideClick)}destroy(){var e;(e=this._popover)==null||e.destroy(),this._popover=null,document.removeEventListener("click",this._handleOutsideClick)}_handleOutsideClick(e){var n,r;if(!this.open||!this._rootNode||!this._menuContentNode)return;const i=e.target;(n=this._menuContentNode)!=null&&n.contains(i)||(r=this._rootNode)!=null&&r.contains(i)||(this.open=!1)}get items(){return this.viewModel.items}set items(e){this.viewModel.items=e}get open(){return this.viewModel.open}set open(e){this.viewModel.open=e}render(){return O("div",{afterCreate:this._afterRootNodeCreate,bind:this,"data-node-ref":"_rootNode",class:this.classes(us.base,us.widget),key:"menu"},this.renderMenuButton())}renderMenuButton(){const{iconClass:e,id:i,label:n,open:r}=this,s=this.classes(us.button,e??us.defaultIconClass,r?us.buttonSelected:null);return O("button",{"aria-pressed":r.toString(),"aria-controls":`${i}-menu`,"aria-expanded":r.toString(),"aria-haspopup":"true","aria-label":n,bind:this,class:s,disabled:this.disabled,id:`${i}-button`,title:n??"",selected:r,onclick:this._toggleOpen,tabindex:this.disabled?-1:0,type:"button"})}renderMenuContent(){var n;const{id:e,open:i}=this;return O("div",{afterCreate:this._afterMenuContentNodeCreate,bind:this,class:us.content,"data-node-ref":"_menuContentNode",key:"esri-button-menu-content",hidden:!i},O("ul",{"aria-labelledby":`${e}-button`,bind:this,class:us.itemWrapper,id:`${e}-menu`,role:"menu"},((n=this.items)==null?void 0:n.length)&&this.renderItems()))}renderItems(){var e;return(e=this.items)==null?void 0:e.map((i,n)=>this.renderItem(i,n))}renderItem(e,i,n){var a;const r=n!=null?`${this.id}-menu-item-${i}-${n}`:`${this.id}-menu-item-${i}`,s=`${r}-label`,o=this.classes(us.item,e.selectionEnabled?us.selectableMenuItem:null,e.selectionEnabled&&e.selected?us.selectedMenuItem:null);return O("li",{afterCreate:this._afterMenuItemCreate,bind:this,class:o,"data-item-index":i,"data-item-subIndex":n,for:r,key:r,onkeydown:l=>this._handleMenuItemKeydown(l,e),onclick:l=>this._handleMenuItemInteraction(l,e),role:"menuitem",tabindex:this.disabled?-1:0},O("input",{disabled:!0,checked:e.selected,class:us.checkbox,id:r,name:r,tabindex:"-1",type:"checkbox"}),O("label",{bind:this,class:this.classes(us.button,us.itemLabel),for:r,id:s},O("span",{class:this.classes(us.icon,e.iconClass),"aria-hidden":"true"}),O("span",{class:us.itemLabelContent},Ef.sanitize(e.label))),O("ul",{"aria-labelledby":s,class:us.embeddedContentWrapper,id:`${this.id}-submenu`,role:"menu"},(a=e==null?void 0:e.items)==null?void 0:a.map((l,c)=>this.renderItem(l,i,c))))}_afterRootNodeCreate(e){var i;this._rootNode=e,(i=this._popover)==null||i.set("anchorElement",()=>e)}_handleMenuItemInteraction(e,i){i.selected=!i.selected,i.open=!(!i.selected||!i.items),i.autoCloseMenu&&this.set("open",!1),i.clickFunction&&i.clickFunction({event:e,item:i}),e.stopPropagation()}_handleMenuItemKeydown(e,i){const n=Uh(e);ly(n)&&this._handleMenuItemInteraction(e,i),n==="Escape"&&(this.open=!1,e.preventDefault(),e.stopPropagation())}_afterMenuContentNodeCreate(e){this._menuContentNode=e,e.focus()}_toggleOpen(){this.open=!this.open}_afterMenuItemCreate(e){e["data-item-index"]===0&&e.focus()}};h([p()],Tp.prototype,"disabled",void 0),h([p()],Tp.prototype,"iconClass",void 0),h([p()],Tp.prototype,"items",null),h([p()],Tp.prototype,"open",null),h([p()],Tp.prototype,"viewModel",void 0),Tp=h([P("esri.widgets.FeatureTable.Grid.support.ButtonMenu")],Tp);const Lce=Tp,GI="esri-column",gm={sortAscIcon:"esri-icon-arrow-up",sortDescIcon:"esri-icon-arrow-down",menuContainer:`${GI}__menu-container`,menuIcon:"esri-icon-handle-horizontal",sorter:`${GI}__sorter`,headerContent:`${GI}__header-content`,headerLabel:`${GI}__header-label`},Hq={keyboardSort1:"Enter",keyboardSort2:"Spacebar"};let Kt=class extends kc(Uo.EventedAccessor){constructor(e){super(e),this._menuContainer=document.createElement("div"),this.activeRowIndex=null,this.autoWidth=!1,this.cellValueFormatFunction=({value:i})=>Ef.sanitize(i),this.flexGrow=1,this.footerRenderFunction=null,this.frozen=!1,this.grid=null,this.header=null,this.headerRenderFunction=i=>{const{root:n}=i;if(this.removeCellContent(n),n.classList.add(gm.headerContent),this.sortable)this.headerSorterRenderFunction(i);else{const r=document.createElement("div");r.classList.add(gm.headerLabel),r.textContent=this.label,n.appendChild(r)}this.headerMenuEnabled&&this.headerMenuRenderFunction(i)},this.headerMenuRenderFunction=({root:i})=>{var n,r;(r=(n=this.menu)==null?void 0:n.items)!=null&&r.length&&i.appendChild(this._menuContainer)},this.headerSorterRenderFunction=({root:i})=>{var a;const{label:n,sortElement:r}=this;if(!r)return void(i.textContent=n);r.textContent!==n&&r.setAttribute("textContent",n),i.appendChild(r);const s=(a=this.grid)==null?void 0:a.getSlotElementByName(i.slot),o=s==null?void 0:s.parentElement;o&&!o.onkeydown&&(o.onkeydown=({key:l})=>{l!==Hq.keyboardSort1&&l!==Hq.keyboardSort2||r.click()})},this.hidden=!1,this.headerMenuEnabled=!0,this.initialSortPriority=null,this.menu=null,this.menuConfig=null,this.messages=null,this.messagesCommon=null,this.messagesURIUtils=null,this.path=null,this.renderFunction=({root:i,column:n,rowData:r})=>{const s=this.getCellValue(n,r),o=this.cellValueFormatFunction({column:n,rowData:r,value:s});i.innerHTML!==o&&(i.innerHTML=o)},this.resizable=!0,this.sortable=!0,this.textAlign="start",this.width=200}initialize(){const{messages:e,path:i}=this;this._set("sortElement",this.createSortElement()),this.sortElement.setAttribute("path",i??""),this._menuContainer.classList.add(gm.menuContainer),this.menu=new Lce({label:e==null?void 0:e.options,iconClass:gm.menuIcon,...this.menuConfig}),this.menu.container=this._menuContainer,this.menu.set("items",this.getMenuItems()),this.handles.add(Q(()=>this.hidden,()=>{var n;return(n=this.menu)==null?void 0:n.set("open",!1)}),Q(()=>this.path,n=>{this.sortElement&&this.sortElement.path!==n&&this.sortElement.setAttribute("path",n??"")}))}destroy(){var e;(e=this.menu)==null||e.destroy()}set direction(e){this.sortable&&(this.sortElement&&(e?this.sortElement.direction!==e&&this.sortElement.setAttribute("direction",e):this.sortElement.removeAttribute("direction")),this._set("direction",e))}get direction(){return this._get("direction")||null}get label(){return Ef.sanitize(this.header??this.path??"")}getMenuItems(){const{menuConfig:e,sortable:i}=this,n=e==null?void 0:e.items,r=this.getSortMenuItems(),s=[];return i&&s.push(...r),n!=null&&n.length&&s.push(...n),s.length?s:null}getSortMenuItems(){const{messages:e}=this;return[{selected:this.direction==="asc",iconClass:gm.sortAscIcon,label:e==null?void 0:e.sortAsc,autoCloseMenu:!0,clickFunction:()=>this.set("direction",this.direction!=="asc"?"asc":null)},{selected:this.direction==="desc",iconClass:gm.sortDescIcon,label:e==null?void 0:e.sortDesc,autoCloseMenu:!0,clickFunction:()=>this.set("direction",this.direction!=="desc"?"desc":null)}]}getCellValue(e,i){return(i==null?void 0:i.item[e==null?void 0:e.path])??""}createSortElement(){const{direction:e,label:i,path:n,initialSortPriority:r}=this,s=document.createElement("vaadin-grid-sorter");return s.classList.add(gm.sorter),s.setAttribute("path",n??""),s.setAttribute("title",i),s.textContent=i,e&&s.setAttribute("direction",e),r!=null&&(s._initialOrder=r),s.addEventListener("direction-changed",()=>{this.direction!==s.direction&&this._set("direction",s.direction)}),s}removeCellContent(e){if(e)for(;e.firstChild;)try{e.removeChild(e.firstChild)}catch{}}};h([p()],Kt.prototype,"activeRowIndex",void 0),h([p()],Kt.prototype,"autoWidth",void 0),h([p()],Kt.prototype,"cellValueFormatFunction",void 0),h([p()],Kt.prototype,"direction",null),h([p()],Kt.prototype,"flexGrow",void 0),h([p()],Kt.prototype,"footerRenderFunction",void 0),h([p()],Kt.prototype,"frozen",void 0),h([p()],Kt.prototype,"grid",void 0),h([p()],Kt.prototype,"header",void 0),h([p()],Kt.prototype,"headerRenderFunction",void 0),h([p()],Kt.prototype,"headerMenuRenderFunction",void 0),h([p()],Kt.prototype,"headerSorterRenderFunction",void 0),h([p()],Kt.prototype,"hidden",void 0),h([p()],Kt.prototype,"headerMenuEnabled",void 0),h([p({constructOnly:!0})],Kt.prototype,"initialSortPriority",void 0),h([p({readOnly:!0})],Kt.prototype,"label",null),h([p()],Kt.prototype,"menu",void 0),h([p()],Kt.prototype,"menuConfig",void 0),h([p()],Kt.prototype,"messages",void 0),h([p()],Kt.prototype,"messagesCommon",void 0),h([p()],Kt.prototype,"messagesURIUtils",void 0),h([p()],Kt.prototype,"path",void 0),h([p()],Kt.prototype,"renderFunction",void 0),h([p()],Kt.prototype,"resizable",void 0),h([p()],Kt.prototype,"sortable",void 0),h([p({readOnly:!0})],Kt.prototype,"sortElement",void 0),h([p()],Kt.prototype,"textAlign",void 0),h([p()],Kt.prototype,"width",void 0),Kt=h([P("esri.widgets.FeatureTable.Grid.Column")],Kt);const ck=Kt,Wje={attachmentsColumn:"esri-feature-table__column--attachments"};let Ip=class extends ck{constructor(e){super(e),this.header="",this.path="EsriFeatureTableAttachmentsColumn",this.renderFunction=({root:i,rowData:n})=>{const r=this._countFromItem(n==null?void 0:n.item).toString();i.innerHTML=`<div class="${Wje.attachmentsColumn}">${r}</div>`},this.sortable=!1,this.textAlign="center"}_countFromItem(e){return(e==null?void 0:e.attachments)&&e.attachments.length||0}};h([p({constructOnly:!0})],Ip.prototype,"header",void 0),h([p({readOnly:!0})],Ip.prototype,"path",void 0),h([p()],Ip.prototype,"renderFunction",void 0),h([p({readOnly:!0})],Ip.prototype,"sortable",void 0),h([p({readOnly:!0})],Ip.prototype,"textAlign",void 0),Ip=h([P("esri.widgets.FeatureTable.AttachmentsColumn")],Ip);const Jje=Ip,qq=(t,e)=>{var i;return t!=null&&((i=t.input)==null?void 0:i.type)===e},Wq=t=>t!=null&&(qq(t,"text-box")||qq(t,"text-area")),Jq={typeFieldName:null,types:[]};function cmt(t,e,i){const n=Object.keys(e).filter(o=>YL(t,o)),r=n.map(o=>e[o]),s=n.map(o=>i.get(o)).filter(Ti);return Yje(t,Zje(r,s))}function Zje(t,e){const i=e.map((n,r)=>{let s=t[r];if(n.domain&&n.domain.type==="coded-value"){const o=n.domain.codedValues.find(a=>a.code===s);o!=null&&o.name&&(s=o.name)}return iA(n)&&(s=Rce(n,s)),[n.name,s]});return Object.fromEntries(i)}function Rce(t,e){if(!t||e==null)return null;switch(t.type){case"date":return yi(e);case"date-only":return Z6(e);case"time-only":return Y6(e);case"timestamp-offset":return X6(e);default:return null}}const Zq=new Set(["date-only","time-only","timestamp-offset"]);function Yje(t,e){return pl(pl(t,i=>`{${i.toLowerCase()}}`),Object.fromEntries(Object.entries(e).map(([i,n])=>[i.toLowerCase(),n])))}const Xje=t=>{var e,i;return t?t.type==="subtype-sublayer"?{typeFieldName:(e=t.parent)==null?void 0:e.subtypeField,types:((i=t.parent)==null?void 0:i.subtypes)??[]}:"types"in t&&t.types?{typeFieldName:t.typeIdField,types:t.types.map(({id:n,name:r,domains:s})=>({code:n,name:r,domains:s}))}:Jq:Jq},Kje=(t,e)=>{if(!t)return!0;const{operations:i}=t;switch(e){case"INSERT":return i.supportsAdd;case"UPDATE":case"DELETE":return i.supportsUpdate;default:return!0}};var eF;(function(t){t.TOO_SHORT="length-validation-error::too-short"})(eF||(eF={}));const umt=t=>{var i;const e=[];if(t.formTemplate){const{description:n,title:r}=t.formTemplate;(i=t.fields)==null||i.forEach(s=>{const o=r&&YL(r,s.name),a=n&&YL(n,s.name);(o||a)&&e.push(s.name)})}return e},Qje="esri.widgets.Feature.support.featureUtils",Yq=ne.getLogger(Qje),e8e=/href=(""|'')/gi,t8e=/(\{([^\{\r\n]+)\})/g,i8e=/\'/g,Dce=/^\s*expression\//i,n8e=/(\n)/gi,r8e=/[\u00A0-\u9999<>\&]/gim,s8e=/href\s*=\s*(?:\"([^\"]+)\"|\'([^\']+)\')/gi,o8e=/^(?:mailto:|tel:)/,Nce="relationships/",Xq=Dh("short-date-short-time");function hmt(t){if(t!=null)return t.get("sourceLayer")||t.get("layer")}async function dmt(t,e){return typeof t=="function"?t(e):t}function pmt(t=""){if(t)return!o8e.test(t.trim().toLowerCase())}function a8e(t){return!!t&&Dce.test(t)}function l8e(t,e){if(!a8e(e)||!t)return null;const i=e.replace(Dce,"").toLowerCase();let n=null;return t.some(r=>r.name.toLowerCase()===i&&(n=r,!0)),n}function fmt(t,e){const i=l8e(e,t==null?void 0:t.fieldName);return i?i.title||null:t?t.label||t.fieldName:null}function c8e(t,e){const i=e.get(t.toLowerCase());return`{${i&&i.fieldName||t}}`}function u8e(t){return t.replaceAll(e8e,"")}function Fce(t,e){const i=n8(e,t);return i?i.name:t}function mmt(t,e){return t&&t.map(i=>Fce(i,e))}function n8(t,e){return t&&typeof t.getField=="function"&&e?t.getField(e)??null:null}function zce(t){return`${t}`.trim()}function gmt({attributes:t,globalAttributes:e,layer:i,text:n,expressionAttributes:r,fieldInfoMap:s}){return n?h8e({formattedAttributes:e,template:g8e(n,{...e,...r,...t},i),fieldInfoMap:s}):""}function h8e({formattedAttributes:t,template:e,fieldInfoMap:i}){return zce(u8e(pl(pl(e,n=>c8e(n,i)),t)))}function d8e(t,e,i=!1){const n=e[t];if(typeof n=="string"){const r="%27",s=(i?encodeURIComponent(n):n).replaceAll(i8e,r);e[t]=s}}function p8e(t,e=!1){const i={...t};return Object.keys(i).forEach(n=>d8e(n,i,e)),i}function f8e(t,e,i){const n=(e=zce(e))&&e[0]!=="{";return pl(t,p8e(i,n||!1))}function m8e(t,e){return t.replaceAll(t8e,(i,n,r)=>{const s=n8(e,r);return s?`{${s.name}}`:n})}function g8e(t,e,i){const n=m8e(t,i);return n&&n.replaceAll(s8e,(r,s,o)=>f8e(r,s||o,e))}function y8e(t,e){if(typeof t=="string"&&e&&e.dateFormat==null&&(e.places!=null||e.digitSeparator!=null)){const i=Number(t);if(!isNaN(i))return i}return t}function Kq(t){return t!=null&&typeof t=="object"&&"layer"in t&&!!t.layer}function v8e(t){return t!=null&&typeof t=="object"&&"type"in t&&t.type==="map-image"}function _8e(t){return t!=null&&typeof t=="object"&&"fieldsIndex"in t&&"geometryType"in t&&"getField"in t&&"load"in t&&"loaded"in t&&"objectIdField"in t&&"spatialReference"in t&&"type"in t&&t.type==="feature"&&"when"in t}function b8e(t){return t!=null&&typeof t=="object"&&"createQuery"in t&&"queryFeatureCount"in t&&"queryObjectIds"in t&&"queryRelatedFeatures"in t&&"queryRelatedFeaturesCount"in t&&"relationships"in t}function Vce(t){return _8e(t)&&b8e(t)}function w8e(t,e){var u;const{fieldInfos:i,fieldName:n,preventPlacesFormatting:r,layer:s}=e,o=x8e(i,n),a=o==null?void 0:o.clone(),l=n8(s,n);if(a&&!RR(n)){const d=l==null?void 0:l.type;if(d==="date"||d==="date-only"||d==="time-only"||d==="timestamp-offset"||(u=a.format)!=null&&u.dateFormat){const f=a.format??new a_;if(f.dateFormat??(f.dateFormat=d==="date-only"?"short-date":"short-date-short-time"),typeof t=="number"){const m=!Kq(s)&&BQ(s)&&s.datesInUnknownTimezone||Kq(s)&&v8e(s.layer)&&s.layer.datesInUnknownTimezone;return f.formatDate(t,m)}switch(d){case"date-only":return f.formatDateOnly(t);case"time-only":return f.formatTimeOnly(t);case"timestamp-offset":return f.formatTimestamp(t)}}}const c=a==null?void 0:a.format;return typeof t=="string"&&RR(n)&&c?c.formatRasterPixelValue(t):typeof(t=y8e(t,c))=="string"||t==null||c==null?jce(t):r?Ns(t,{...K6(c),minimumFractionDigits:0,maximumFractionDigits:20}):c.formatNumber(t)}function x8e(t,e){if(t&&t.length&&e)return t.find(i=>{var n;return((n=i.fieldName)==null?void 0:n.toLowerCase())===e.toLowerCase()})}function S8e({fieldName:t,graphic:e,layer:i}){if(Uce(t)||!i||typeof i.getFeatureType!="function")return null;const{typeIdField:n}=i;if(!n||t!==n)return null;const r=i.getFeatureType(e);return r?r.name:null}function T8e({fieldName:t,value:e,graphic:i,layer:n}){if(Uce(t)||!n||typeof n.getFieldDomain!="function")return null;const r=i&&n.getFieldDomain(t,{feature:i});return r&&r.type==="coded-value"?r.getName(e):null}function ymt(t,e){const{creatorField:i,creationDateField:n,editorField:r,editDateField:s}=t;if(!e)return;const o=e[s];if(typeof o=="number"){const l=e[r];return{type:"edit",date:yi(o,Xq),user:l}}const a=e[n];if(typeof a=="number"){const l=e[i];return{type:"create",date:yi(a,Xq),user:l}}return null}function vmt(t,e){const i=new Map;return t&&t.forEach(n=>{const r=Fce(n.fieldName,e);n.fieldName=r,i.set(r.toLowerCase(),n)}),i}function _mt(t){const e=[];if(!t)return e;const{fieldInfos:i,content:n}=t;return i&&e.push(...i),n&&Array.isArray(n)&&n.forEach(r=>{if(r.type==="fields"){const s=r&&r.fieldInfos;s&&e.push(...s)}}),e}function bmt(t){return t.replaceAll(r8e,e=>`&#${e.charCodeAt(0)};`)}function jce(t){return typeof t=="string"?t.replaceAll(n8e,'<br class="esri-text-new-line" />'):t}function Bce(t){var c,u;const{value:e,fieldName:i,fieldInfos:n,fieldInfoMap:r,layer:s,graphic:o}=t;if(e==null)return"";const a=T8e({fieldName:i,value:e,graphic:o,layer:s});if(a)return a;const l=S8e({fieldName:i,graphic:o,layer:s});if(l)return l;if(r.get(i.toLowerCase()))return w8e(e,{fieldInfos:n||Array.from(r.values()),fieldName:i,layer:s});switch((u=(c=s==null?void 0:s.fieldsIndex)==null?void 0:c.get(i))==null?void 0:u.type){case"date":return yi(e);case"date-only":return Z6(e);case"time-only":return Y6(e);case"timestamp-offset":return X6(e)}return jce(e)}function wmt({fieldInfos:t,attributes:e,layer:i,graphic:n,fieldInfoMap:r,relatedInfos:s}){const o={};return s==null||s.forEach(a=>E8e({attributes:o,relatedInfo:a,fieldInfoMap:r,fieldInfos:t,layer:i})),e&&Object.keys(e).forEach(a=>{const l=e[a];o[a]=Bce({fieldName:a,fieldInfos:t,fieldInfoMap:r,layer:i,value:l,graphic:n})}),o}async function I8e(t,e){var u,d;const{layer:i,graphic:n,outFields:r,objectIds:s,returnGeometry:o,spatialReference:a}=t,l=s[0];if(typeof l!="number"&&typeof l!="string"){const f="Could not query required fields for the specified feature. The feature's ID is invalid.",m={layer:i,graphic:n,objectId:l,requiredFields:r};return Yq.warn(f,m),null}if(!((d=(u=tf(i))==null?void 0:u.operations)!=null&&d.supportsQuery)){const f="The specified layer cannot be queried. The following fields will not be available.",m={layer:i,graphic:n,requiredFields:r,returnGeometry:o};return Yq.warn(f,m),null}const c=i.createQuery();return c.objectIds=s,c.outFields=r!=null&&r.length?r:[i.objectIdField],c.returnGeometry=!!o,c.returnZ=!!o,c.returnM=!!o,c.outSpatialReference=a,(await i.queryFeatures(c,e)).features[0]}async function C8e(t){var n;if(!((n=t.expressionInfos)!=null&&n.length))return!1;const e=await ld(),{arcadeUtils:{hasGeometryFunctions:i}}=e;return i(t)}async function xmt({graphic:t,popupTemplate:e,layer:i,spatialReference:n},r){if(!i||!e||(typeof i.load=="function"&&await i.load(r),!t.attributes))return;const s=t.attributes[i.objectIdField];if(s==null)return;const o=[s],a=await e.getRequiredFields(i.fieldsIndex),l=sxe(a,t),c=l?[]:a,u=e.returnGeometry||await C8e(e);if(l&&!u)return;const d=await I8e({layer:i,graphic:t,outFields:c,objectIds:o,returnGeometry:u,spatialReference:n},r);d&&(d.geometry&&(t.geometry=d.geometry),d.attributes&&(t.attributes={...t.attributes,...d.attributes}))}function Uce(t=""){return!!t&&t.includes(Nce)}function M8e(t){return t?`${Nce}${t.layerId}/${t.fieldName}`:""}function Qq({attributes:t,graphic:e,relatedInfo:i,fieldInfos:n,fieldInfoMap:r,layer:s}){t&&e&&i&&Object.keys(e.attributes).forEach(o=>{const a=M8e({layerId:i.relation.id.toString(),fieldName:o}),l=e.attributes[o];t[a]=Bce({fieldName:a,fieldInfos:n,fieldInfoMap:r,layer:s,value:l,graphic:e})})}function E8e({attributes:t,relatedInfo:e,fieldInfoMap:i,fieldInfos:n,layer:r}){t&&e&&(e.relatedFeatures&&e.relatedFeatures&&e.relatedFeatures.forEach(s=>Qq({attributes:t,graphic:s,relatedInfo:e,fieldInfoMap:i,fieldInfos:n,layer:r})),e.relatedStatsFeatures&&e.relatedStatsFeatures&&e.relatedStatsFeatures.forEach(s=>Qq({attributes:t,graphic:s,relatedInfo:e,fieldInfoMap:i,fieldInfos:n,layer:r})))}const eW=t=>{if(!t)return!1;const e=t.toUpperCase();return e.includes("CURRENT_TIMESTAMP")||e.includes("CURRENT_DATE")||e.includes("CURRENT_TIME")},Gce=({layer:t,method:e,query:i,definitionExpression:n})=>{var o,a;if(!((a=(o=t.capabilities)==null?void 0:o.query)!=null&&a.supportsCacheHint)||e==="attachments")return;const r=i.where!=null?i.where:null,s=i.geometry!=null?i.geometry:null;eW(n)||eW(r)||(s==null?void 0:s.type)==="extent"||i.resultType==="tile"||(i.cacheHint=!0)},Smt=({query:t,layer:e,method:i})=>{Gce({layer:e,method:i,query:t,definitionExpression:`${e.definitionExpression} ${e.serviceDefinitionExpression}`})},Tmt=({queryPayload:t,layer:e,method:i})=>{Gce({layer:e,method:i,query:t,definitionExpression:`${e.definitionExpression} ${e.serviceDefinitionExpression}`})};function Imt(t,e,i){return t&&e&&i?tW(t.allLayers,e,i)||tW(t.allTables,e,i):null}function tW(t,e,i){return t.filter(Vce).find(n=>n!==e&&n.url===e.url&&n.layerId===i.relatedTableId)}let Ha=class extends kc(ye){constructor(e){super(e),this.element=null,this.feature=null,this.layer=null,this.type=null,this.visibilityExpressionExecutor=null}get description(){var e;return(e=this.element)==null?void 0:e.description}get evaluatedVisibilityExpression(){const{visibilityExpressionExecutor:e}=this;return e!=null?!!e.lastEvaluatedValue:null}get label(){var e;return(e=this.element)==null?void 0:e.label}get visible(){return this.evaluatedVisibilityExpression!=null?this.evaluatedVisibilityExpression:this.element!=null}};h([p({readOnly:!0})],Ha.prototype,"description",null),h([p({constructOnly:!0})],Ha.prototype,"element",void 0),h([p()],Ha.prototype,"evaluatedVisibilityExpression",null),h([p()],Ha.prototype,"feature",void 0),h([p()],Ha.prototype,"label",null),h([p()],Ha.prototype,"layer",void 0),h([p()],Ha.prototype,"type",void 0),h([p()],Ha.prototype,"visible",null),h([p()],Ha.prototype,"visibilityExpressionExecutor",void 0),Ha=h([P("esri.widgets.FeatureForm.InputBase")],Ha);const A8e=Ha;let Cp=class extends A8e{constructor(e){super(e),this.arcadeEditType="NA",this.editableExpressionExecutor=null}get editable(){return!!this.layerAllowsEdits&&(this.evaluatedEditableExpression??!1)}get evaluatedEditableExpression(){const{editableExpressionExecutor:e}=this;return e!=null?!!e.lastEvaluatedValue:null}get layerAllowsEdits(){const{layer:e}=this;if(!e)return!1;const i=tf(e),n=i==null?void 0:i.operations.supportsEditing,r=Kje(i,this.arcadeEditType);return!(!n||!r)}};h([p()],Cp.prototype,"arcadeEditType",void 0),h([p()],Cp.prototype,"editable",null),h([p()],Cp.prototype,"editableExpressionExecutor",void 0),h([p()],Cp.prototype,"evaluatedEditableExpression",null),h([p()],Cp.prototype,"layerAllowsEdits",null),Cp=h([P("esri.widgets.FeatureForm.EditableInput")],Cp);const $8e=Cp;var Ja;(function(t){t.Text="text",t.Number="number",t.Date="date",t.Unsupported="unsupported"})(Ja||(Ja={}));const P8e="__internal-type-based-coded-value-domain__";let pt=class extends $8e{constructor(e){super(e),this._storedValue=null,this.error=null,this.field=null,this.group=null,this.requiredExpressionExecutor=null,this.type="field",this.valueExpressionExecutor=null}get _dateRange(){var i;const{element:e}=this;if(((i=e==null?void 0:e.input)==null?void 0:i.type)==="datetime-picker"){const{max:n,min:r}=e.input;return{max:n,min:r}}return{min:null,max:null}}get _configAllowsEdits(){var s,o;const{element:e,layer:i,name:n}=this;if(e!=null)return e.editableExpression?!!this.evaluatedEditableExpression:e.editable!==!1;if(i!=null&&i.userHasUpdateItemPrivileges)return!0;const r=i&&"popupTemplate"in i?(o=(s=i==null?void 0:i.popupTemplate)==null?void 0:s.fieldInfos)==null?void 0:o.find(({fieldName:a})=>a===n):null;return(r==null?void 0:r.isEditable)??!0}get _layerAndFieldAllowEdits(){var e;return this.layerAllowsEdits&&((e=this.field)==null?void 0:e.editable)}get _isVisibleByDefault(){const{field:e,layer:i}=this;return!!(e!=null&&e.visible)&&ate(e,i)}get _isEditTrackingField(){var e;return N6(this.layer).includes((e=this.name)==null?void 0:e.toLowerCase())}get _shouldUseValueExpression(){return this._layerAndFieldAllowEdits&&!this._configAllowsEdits&&this.valueExpressionExecutor!=null}get dataType(){const{field:e}=this;return xu(e)?Ja.Number:LR(e)?Ja.Text:iA(e)?Ja.Date:Ja.Unsupported}get dateDataType(){if(this.dataType===Ja.Date)return this.field.type!=="date"?"string":"number"}get domain(){var a;const{layer:e}=this,{typeFieldName:i,types:n}=Xje(e);if(i===this.name&&this.field.domain==null)return new JP({name:P8e,codedValues:n.map(({code:l,name:c})=>new p_({code:l,name:c}))});const{feature:r}=this,s=e==null?void 0:e.getFieldDomain(this.name,{feature:r}),o=(a=this.element)==null?void 0:a.domain;return o!=null&&this._isDomainCompatible(o)?o:s}get editable(){return!!this._layerAndFieldAllowEdits&&(this.evaluatedEditableExpression??this._configAllowsEdits)}get evaluatedRequiredExpression(){const{requiredExpressionExecutor:e}=this;return e!=null?!!e.lastEvaluatedValue:null}get evaluatedValueExpression(){const{valueExpressionExecutor:e}=this;return e!=null?e.lastEvaluatedValue:null}get hint(){var e;return(e=this.element)==null?void 0:e.hint}get includeDate(){return!(this.dataType!==Ja.Date||this.field.type==="time-only")}get includeTime(){var r;const{element:e,field:i}=this;if(this.dataType!==Ja.Date)return!1;if(i.type==="time-only")return!0;if(i.type==="date-only")return!1;const n=((r=e==null?void 0:e.input)==null?void 0:r.type)==="datetime-picker"?e.input.includeTime:void 0;return n===void 0||n}get includeTimestamp(){return this.field.type==="timestamp-offset"}set initialFeature(e){this._set("initialFeature",e),this.notifyChange("valid")}get inputType(){var e,i;return(i=(e=this.element)==null?void 0:e.input)==null?void 0:i.type}get isRelationshipKeyField(){var n;const{field:e,layer:i}=this;return Vce(i)&&!!((n=i.relationships)!=null&&n.some(r=>r.keyField===e.name))}get label(){var e;return((e=this.element)==null?void 0:e.label)||this.field.alias||this.field.name}get maxLength(){if(this.dataType===Ja.Date)return-1;const{field:i,element:n}=this,r=i==null?void 0:i.length,s=Wq(n)?n.input.maxLength:NaN;return s!=null&&!isNaN(s)&&s>=-1&&(r===-1||s<=r)?s:r}get minLength(){if(this.dataType===Ja.Date)return-1;const{field:i,element:n}=this,r=i==null?void 0:i.length,s=Wq(n)?n.input.minLength:NaN;return s!=null&&!isNaN(s)&&s>=-1&&(r===-1||s<=r)?s:-1}get name(){var e;return(e=this.field)==null?void 0:e.name}get range(){const{_dateRange:e,domain:i,field:n}=this,{max:r,min:s}=e,o=r!=null&&iW(r)?r.getTime():null,a=s!=null&&iW(s)?s.getTime():null,l=tte(i)||Qwe(n);if(!l)return{max:o,min:a};const c=l.max===Number.MAX_VALUE?null:l.max,u=l.min===Number.MIN_VALUE?null:l.min;return{max:o!=null&&(c===null||c!=null&&o<c)?o:c,min:a!=null&&(u===null||u!=null&&a>u)?a:u}}get required(){const{editable:e,evaluatedRequiredExpression:i,field:n,visible:r}=this;return!!e&&((n==null?void 0:n.nullable)===!1||!(!r||i==null)&&i)}set required(e){this._overrideIfSome("required",e)}get submittable(){const{field:e,required:i,valid:n,value:r}=this;return(!i||r!=null)&&(!!n||this.initialFeature.getAttribute(e.name)===r)}get updating(){const{editableExpressionExecutor:e,valueExpressionExecutor:i}=this;return i!=null&&i.updating||e!=null&&e.updating}get valid(){const e=this.editable?this._validate():null;return this._set("error",e),e===null}get value(){if(this._shouldUseValueExpression){const e=this.evaluatedValueExpression;if(this.dataType===Ja.Date){if(e instanceof Date)return e.getTime();if(typeof e!="number")return parseInt(e,10)}return e!=null&&typeof e=="object"?e.toString():e}return this.get("_storedValue")}set value(e){this.notifyChange("evaluatedVisibilityExpression"),this.set("_storedValue",e)}get visible(){return!this._isEditTrackingField&&(this.evaluatedVisibilityExpression!=null?this.evaluatedVisibilityExpression:this.element!=null||this._isVisibleByDefault)}_isDomainCompatible(e){const{field:i}=this;if((e==null?void 0:e.type)==="coded-value"){const n=typeof e.codedValues[0].code;if(n==="string"&&LR(i)||n==="number"&&xu(i))return!0}return!!((e==null?void 0:e.type)==="range"&&xu(i)||iA(i))}_validate(){const{dataType:e,domain:i,field:n,initialFeature:r,minLength:s,required:o,valid:a,value:l}=this,c=o&&l==null,u=a!==void 0;return!c&&r.getAttribute(n.name)===l&&u?null:c?D2.INVALID_TYPE:e==="text"&&s>-1&&typeof l=="string"&&l.length<s?eF.TOO_SHORT:i?l!==null||o?ete(i,l):null:Xwe(n,l)}};h([p()],pt.prototype,"_storedValue",void 0),h([p()],pt.prototype,"_configAllowsEdits",null),h([p()],pt.prototype,"_layerAndFieldAllowEdits",null),h([p()],pt.prototype,"_isVisibleByDefault",null),h([p()],pt.prototype,"_isEditTrackingField",null),h([p()],pt.prototype,"_shouldUseValueExpression",null),h([p()],pt.prototype,"dataType",null),h([p()],pt.prototype,"dateDataType",null),h([p()],pt.prototype,"domain",null),h([p()],pt.prototype,"editable",null),h([p({readOnly:!0})],pt.prototype,"error",void 0),h([p()],pt.prototype,"evaluatedRequiredExpression",null),h([p()],pt.prototype,"evaluatedValueExpression",null),h([p()],pt.prototype,"field",void 0),h([p()],pt.prototype,"group",void 0),h([p({readOnly:!0})],pt.prototype,"hint",null),h([p()],pt.prototype,"includeDate",null),h([p()],pt.prototype,"includeTime",null),h([p()],pt.prototype,"includeTimestamp",null),h([p()],pt.prototype,"initialFeature",null),h([p({readOnly:!0})],pt.prototype,"inputType",null),h([p()],pt.prototype,"label",null),h([p()],pt.prototype,"maxLength",null),h([p()],pt.prototype,"minLength",null),h([p({readOnly:!0})],pt.prototype,"name",null),h([p()],pt.prototype,"range",null),h([p()],pt.prototype,"required",null),h([p()],pt.prototype,"requiredExpressionExecutor",void 0),h([p()],pt.prototype,"submittable",null),h([p({readOnly:!0})],pt.prototype,"type",void 0),h([p()],pt.prototype,"updating",null),h([p()],pt.prototype,"valid",null),h([p({value:null})],pt.prototype,"value",null),h([p()],pt.prototype,"valueExpressionExecutor",void 0),h([p()],pt.prototype,"visible",null),pt=h([P("esri.widgets.FeatureForm.FieldInput")],pt);const iW=t=>t&&!Number.isNaN(t.valueOf()),k8e=pt,O8e=[{pattern:/^\s*(https?:\/\/([^\s]+))\s*$/i,target:"_blank",label:"{messages.view}"},{pattern:/^\s*(tel:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(mailto:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(arcgis-appstudio-player:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"App Studio Player"},{pattern:/^\s*(arcgis-collector:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Collector"},{pattern:/^\s*(arcgis-explorer:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Explorer"},{pattern:/^\s*(arcgis-navigator:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Navigator"},{pattern:/^\s*(arcgis-survey123:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Survey123"},{pattern:/^\s*(arcgis-trek2there:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Trek2There"},{pattern:/^\s*(arcgis-workforce:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Workforce"},{pattern:/^\s*(iform:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"iForm"},{pattern:/^\s*(flow:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"FlowFinity"},{pattern:/^\s*(lfmobile:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Laserfische"},{pattern:/^\s*(mspbi:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Microsoft Power Bi"}];function L8e(t){let e=null;return O8e.some(i=>(i.pattern.test(t)&&(e=i),!!e)),e}function LO(t,e){if(typeof e!="string"||!e)return e;const i=L8e(e);if(!i)return e;const n=e.match(i.pattern),r=n&&n[2],s=pl(pl(i.label,{messages:t,hierPart:r}),{appName:i.appName}),o=i.target?` target="${i.target}"`:"",a=i.target==="_blank"?' rel="noreferrer"':"";return e.replace(i.pattern,`<a${o} href="$1"${a}>${s}</a>`)}const nW="esri-editor-column__cell-input",rW={input:nW,inputContainer:`${nW}--container`},sW={showInput:"Enter",hideInput:"Escape"};let ws=class extends ck{constructor(e){super(e),this.activeEditInfo=null,this.cellValueValidatorFunction=({oldValue:i,value:n})=>i!==n,this.editable=!1,this.inputRenderFunction=({root:i,column:n,rowData:r})=>{var l,c;if((l=this.activeEditInfo)!=null&&l.updating||!this.editable)return;const s=this.getCellValue(n,r),o=this.createInputElement({root:i,column:n,rowData:r,value:s});this._set("activeEditInfo",{column:n,input:o,root:i,rowData:r,updating:!0,oldValue:s});const a=this.createInputContainer();a.appendChild(o),this.removeCellContent(i),i.appendChild(a),o.focus(),o instanceof HTMLInputElement&&o.select(),(c=this.grid)==null||c.notifyResize()},this.loadingMessage="",this.inputType="text",this.maxLength=null,this.parseInputValueFunction=({input:i})=>i.value,this.renderFunction=i=>{var f;const{root:n,column:r,rowData:s}=i,{activeEditInfo:o}=this;if(o&&o.updating)return;const a=this.getCellValue(r,s),l=this.cellValueFormatFunction({column:r,rowData:s,value:a});n.onclick=()=>n.focus(),n.ondblclick=()=>this.inputRenderFunction(i),n.ontouchend=()=>this.inputRenderFunction(i);const c=(f=this.grid)==null?void 0:f.getSlotElementByName(n.slot),u=c==null?void 0:c.parentElement;u&&!u.onkeydown&&(u.onkeydown=m=>{m.key!==sW.showInput||this.activeEditInfo||this.inputRenderFunction(i),m.key===sW.hideInput&&this.activeEditInfo&&this.cancel()}),a!=null&&l!=null?n.title=l.toString():n.title&&n.removeAttribute("title");const d=LO(this.messagesURIUtils,l);(l==null?void 0:l.toString())!==n.innerHTML&&d!==n.innerHTML&&(n.innerHTML=d)},this.required=!1,this.store=null,this.updateRowItemFunction=({rowData:i,column:n,value:r})=>{ks(i),i.item[n.path]=r},this.updateStoreItemFunction=async({rowData:i,column:n,value:r})=>{var s;ks(i),await((s=this.store)==null?void 0:s.updateItem({index:i.index,name:n.path,value:r}))}}cancel(){var l;const{activeEditInfo:e}=this;if(!e)return;const{column:i,root:n,rowData:r,oldValue:s}=e;this._set("activeEditInfo",null);const o=this.cellValueFormatFunction({column:i,rowData:r,value:s}),a=LO(this.messagesURIUtils,o);n.innerHTML=a,(l=this.grid)==null||l.notifyResize()}createInputContainer(){const e=document.createElement("div");return e.classList.add(rW.inputContainer),e}createInputElement({value:e}){const i=document.createElement("input");return i.classList.add(rW.input),this.maxLength!=null&&(i.maxLength=this.maxLength),i.type=this.inputType,i.value=e,i.onblur=()=>{i.onblur=null,this.submit()},i}async submit(){var l,c;const{activeEditInfo:e}=this;if(!e)return;const{column:i,input:n,root:r,rowData:s,oldValue:o}=e,a=this.parseInputValueFunction({input:n,column:i,rowData:s});if(!this.cellValueValidatorFunction({value:a,oldValue:o,column:i,rowData:s}))this.cancel();else{r.innerHTML=this.loadingMessage,(l=this.grid)==null||l.notifyResize();try{await this.updateStoreItemFunction({rowData:s,column:i,value:a}),this.updateRowItemFunction({rowData:s,column:i,value:a});const u=this.getCellValue(i,s),d=this.cellValueFormatFunction({column:i,rowData:s,value:u});u!=null&&d!=null?r.title=d.toString():r.title&&r.removeAttribute("title");const f=LO(this.messagesURIUtils,d);r.innerHTML=f,this.emit("value-change",{column:i,rowData:s,value:u}),this._set("activeEditInfo",null),(c=this.grid)==null||c.notifyResize()}catch{this.cancel()}}}};h([p({readOnly:!0})],ws.prototype,"activeEditInfo",void 0),h([p()],ws.prototype,"cellValueValidatorFunction",void 0),h([p()],ws.prototype,"editable",void 0),h([p()],ws.prototype,"inputRenderFunction",void 0),h([p({constructOnly:!0})],ws.prototype,"loadingMessage",void 0),h([p()],ws.prototype,"inputType",void 0),h([p()],ws.prototype,"maxLength",void 0),h([p()],ws.prototype,"parseInputValueFunction",void 0),h([p()],ws.prototype,"renderFunction",void 0),h([p()],ws.prototype,"required",void 0),h([p()],ws.prototype,"store",void 0),h([p()],ws.prototype,"updateRowItemFunction",void 0),h([p()],ws.prototype,"updateStoreItemFunction",void 0),ws=h([P("esri.widgets.FeatureTable.Grid.EditorColumn")],ws);const R8e=ws;function D8e(t,e){const i=die(e),n=Date.now(),r=i.formatToParts(n),s=new Set;r.filter(({type:c})=>c==="literal").forEach(({value:c})=>s.add(c));let o=0;const a={};for(;r.length>0;){const{type:c,value:u}=r.shift();for(let d=0;d<u.length;d++,o++){const f=t.charAt(o);if(s.has(f)){o++;break}if(c==="literal")break;a[c]||(a[c]=[]),a[c].push(f)}}const l={};try{l.day=RO(a.day.join("")),l.month=RO(a.month.join("")),l.year=RO((a.year||a.relatedYear).join(""))}catch{throw oW(e)}if(isNaN(l.day)||isNaN(l.month)||isNaN(l.year))throw oW(e);return l}function RO(t){const e=[//g,//g,//g,//g,//g,//g,//g,//g,//g,//g];for(let i=0;i<10;i++)t=t.replace(e[i],i.toString());return Number(t)}function oW(t){return new V(`could not parse date input, expecting the following format: ${yi(Date.now(),t)}`)}const N1={ar:6,"ar-dz":6,"ar-kw":6,"ar-ly":6,"ar-ma":1,"ar-sa":7,"ar-tn":1,bg:1,bs:1,ca:1,cs:1,da:1,de:1,"de-at":1,"de-ch":1,el:1,"en-au":1,"en-ca":7,"en-gb":1,"en-ie":1,"en-il":7,"en-in":7,"en-nz":1,"en-sg":7,es:1,"es-do":7,"es-mx":7,"es-us":7,et:1,fi:1,fr:1,"fr-ca":7,"fr-ch":1,he:7,hr:1,hu:1,id:7,it:1,"it-ch":1,ja:7,ko:7,lt:1,lv:1,nb:1,nl:1,"nl-be":1,pl:1,pt:7,"pt-br":7,ro:1,ru:1,sk:1,sl:1,sr:1,"sr-cyrl":1,sv:1,th:7,tr:1,uk:1,vi:1,"zh-cn":1,"zh-hk":7,"zh-mo":7,"zh-tw":7},N8e="Locale"in Intl&&"weekInfo"in Intl.Locale.prototype;function Hce(t){if(t=t.toLowerCase(),N1[t])return N1[t];if(N8e)try{const i=new Intl.Locale(t).weekInfo.firstDay;return N1[t]=i,i}catch{}const e=H_e(t);return N1[e]?N1[e]:7}function F8e(t,e){return(e+7-Hce(t))%7}let cx=class extends ye{constructor(){super(...arguments),this.state="ready",this.value=new Date}};h([p()],cx.prototype,"state",void 0),h([p()],cx.prototype,"value",void 0),cx=h([P("esri.widgets.support.DateTimeElementViewModel")],cx);const qce=cx;let tF=class extends qce{constructor(e){super(e)}};tF=h([P("esri.widgets.support.DatePickerViewModel")],tF);const Wce=tF,zn="esri-date-picker",wt={base:zn,datePicker:`${zn}__calendar`,monthPicker:`${zn}__month-picker`,dayPicker:`${zn}__day-picker`,week:`${zn}__week-item`,nearbyMonth:`${zn}__day-item--nearby-month`,activeDay:`${zn}__day-item--active`,today:`${zn}__day-item--today`,selectedDay:`${zn}__day-item--selected`,day:`${zn}__day-item`,dayHeader:`${zn}__day-item--header`,yearPicker:`${zn}__year-picker`,selectedYear:`${zn}__year-picker-item--selected`,year:`${zn}__year-picker-item`,monthDropdown:`${zn}__month-dropdown`,date:`${zn}__date`,datePickerToggle:`${zn}__calendar-toggle`,dateInput:`${zn}__input`,dateTextInput:`${zn}__text-input`,leadingIcon:`${zn}__icon--leading`,previousIcon:"esri-icon-left",nextIcon:"esri-icon-right",calendarIcon:"esri-icon-calendar",widget:"esri-widget",button:"esri-widget--button",input:"esri-input",select:"esri-select"},N0={year:"numeric",month:"2-digit",day:"2-digit"},z8e=[" ","ArrowDown","ArrowLeft","ArrowRight","ArrowUp","End","Enter","Home","PageDown","PageUp"];let Yr=class extends qi{constructor(e,i){super(e,i),this._calendarNode=null,this._inputOrButtonNode=null,this._rootNode=null,this._requestDayPickerFocusOnCreate=!1,this._activeDate=null,this._calendarPopover=new i8({owner:this,placement:"bottom-start",anchorElement:()=>this._rootNode,renderContentFunction:this._renderCalendar}),this._isOpen=!1,this.dateInputEnabled=!1,this.messages=null,this.commitOnMonthChange=!1,this.viewModel=new Wce,this.disabled=!1,this.toggle=this.toggle.bind(this)}initialize(){this.addHandles(Q(()=>{var e;return{viewModel:this.viewModel,value:(e=this.viewModel)==null?void 0:e.value}},({viewModel:e,value:i})=>{!this.destroyed&&e&&this.onChange!=null&&this.onChange(i)},ml))}destroy(){this._calendarPopover.destroy()}get value(){return this.viewModel.value}set value(e){this.viewModel.value=e}get isOpen(){return this._isOpen}render(){return O("div",{afterCreate:uf,bind:this,class:this.classes(wt.base,wt.widget),"data-node-ref":"_rootNode"},this.dateInputEnabled?this._renderInputAndButtonMode():this._renderButtonOnlyMode())}toggle(){this._isOpen?this.close():this.open()}open(e=!0){this._activeDate=Ve.fromJSDate(this.viewModel.value),this._isOpen=!0,this._calendarPopover.open=!0,this._requestDayPickerFocusOnCreate=e}close(e=!0){var i;this._activeDate=null,this._isOpen=!1,this._calendarPopover.open=!1,e&&((i=this._inputOrButtonNode)==null||i.focus())}_renderButtonOnlyMode(){const e=yi(this.viewModel.value,N0),{disabled:i,_isOpen:n,messages:r}=this;return O("div",{key:`date-button-${i}`,afterCreate:uf,"aria-controls":n?this._getCalendarId():null,"aria-expanded":n.toString(),"aria-haspopup":"true","aria-label":r.setDate,"aria-pressed":n.toString(),bind:this,class:this.classes(wt.button,wt.select,wt.datePickerToggle),"data-node-ref":"_inputOrButtonNode",onclick:this.toggle,onkeydown:this._handleDateButtonKeyDown,role:"button",tabIndex:i?void 0:0},O("span",{class:wt.date},e))}_renderInputAndButtonMode(){const e=yi(this.viewModel.value,N0),{_isOpen:i,messages:n}=this;return O("div",{class:this.classes(wt.dateInput)},O("input",{afterCreate:uf,"data-node-ref":"_inputOrButtonNode","aria-controls":i?this._getCalendarId():null,"aria-haspopup":"true","aria-label":n.setDate,bind:this,class:this.classes(wt.dateTextInput,wt.input),key:"date-input",onblur:this._handleDateInputBlur,onclick:this._handleDateInputClick,onkeydown:this._handleDateInputKeyDown,type:"text",value:e}),O("span",{"aria-hidden":"true",class:this.classes(wt.leadingIcon,wt.calendarIcon)}))}_handleDateInputClick(){this.open(!1)}_handleDateInputKeyDown(e){const{key:i}=e;this._isOpen?i==="Enter"?this._handleDateText(e):i==="Escape"&&this.close():i==="ArrowDown"&&(this.open(),e.preventDefault())}_handleDateButtonKeyDown(e){const{key:i,shiftKey:n}=e;this._isOpen&&i==="Tab"&&n?this.close():ly(i)&&this.toggle()}_handleDateInputBlur(e){this._isOpen||this._handleDateText(e)}_handleDateText(e){const i=e.currentTarget;let n;try{n=D8e(i.value,N0)}catch(s){return ne.getLogger(this).warn(s),void(i.value=yi(this.viewModel.value,N0))}const r=Ve.fromObject(n);r.isValid?(this.viewModel.value=r.toJSDate(),this._activeDate=r):i.value=yi(this.viewModel.value,N0)}_handleDatePickerKeydown(e){Uh(e)==="Escape"&&(this.close(),e.preventDefault(),e.stopPropagation())}_renderCalendar(){const e=this._activeDate;if(!e)return null;const i=Ve.fromJSDate(this.viewModel.value);return O("div",{afterCreate:uf,bind:this,class:this.classes(wt.datePicker,wt.widget),"data-node-ref":"_calendarNode",id:this._getCalendarId(),key:"esri-date-picker__calendar",tabIndex:-1,onfocusout:this._onCalendarFocusOut,onkeydown:this._handleDatePickerKeydown},this._renderMonthPicker(e),this._renderDayPicker(e,i),this._renderYearPicker(e))}_getCalendarId(){return`date-picker__calendar--${this.id}`}_onCalendarFocusOut(e){var n,r;const i=e.relatedTarget;i&&i instanceof Node&&((n=this._calendarNode)!=null&&n.contains(i)||(r=this._rootNode)!=null&&r.contains(i))||this.close(!1)}_renderMonthPicker(e){const i=Mc(this.container),n=i?wt.nextIcon:wt.previousIcon,r=i?wt.previousIcon:wt.nextIcon,s=fw.months("long",{locale:xr()}).map((l,c)=>{const u=e.month-1===c;return O("option",{selected:u,value:c.toString()},l)}),{disabled:o,messages:a}=this;return O("div",{class:wt.monthPicker},O("div",{key:`previous-month-${o}`,"aria-label":a.goToPreviousMonth,bind:this,class:wt.button,onclick:this._setPreviousMonth,onkeydown:this._handlePreviousMonthKeyDown,role:"button",tabIndex:o?void 0:0,title:a.goToPreviousMonth},O("span",{"aria-hidden":"true",class:n})),O("select",{"aria-live":"assertive","aria-label":a.selectMonth,bind:this,class:this.classes(wt.monthDropdown,wt.select),disabled:o,id:`${this.id}__month-picker`,onchange:this._setMonth,onkeydown:this._setMonth,title:a.selectMonth},s),O("div",{key:`next-month-${o}`,"aria-label":a.goToNextMonth,bind:this,class:wt.button,onclick:this._setNextMonth,onkeydown:this._setNextMonth,role:"button",tabIndex:o?void 0:0,title:a.goToNextMonth},O("span",{"aria-hidden":"true",class:r})))}_renderDayPicker(e,i){const n=this._getWeekLabels(),r=this._getDayId(e),s=this._renderMonth(e,i),{id:o,disabled:a}=this;return O("div",{key:`day-picker-${a}`,afterCreate:this._handleDayPickerCreate,"aria-activedescendant":r,"aria-labelledby":`${o}__month-picker ${o}__selected-year`,bind:this,class:wt.dayPicker,id:`${o}__day-picker`,onkeydown:this._handleDayPickerKeydown,role:"grid",tabIndex:a?void 0:0},O("div",{class:wt.week,role:"row"},n.map(l=>O("div",{"aria-label":l.name,class:this.classes(wt.day,wt.dayHeader),role:"columnheader",title:l.name},l.abbr))),s)}_getDayId(e){return`${this.id}__${yi(e.valueOf(),N0)}`}_handleDayPickerCreate(e){this._requestDayPickerFocusOnCreate&&(this._requestDayPickerFocusOnCreate=!1,e.focus())}_getWeekLabels(){const e=[],i={weekday:"long"},n={weekday:"narrow"};let r=Ve.now().set({weekday:Hce(xr())});for(let s=0;s<7;s++)e.push({name:yi(r.valueOf(),i),abbr:yi(r.valueOf(),n)}),r=r.plus({day:1});return e}_handleDayPickerKeydown(e){const{ctrlKey:i,shiftKey:n}=e,r=Uh(e);if(!z8e.includes(r))return;let s=this._activeDate;if(s){if(r==="ArrowLeft")s=s.minus({day:1});else if(r==="ArrowRight")s=s.plus({day:1});else if(r==="ArrowUp")s=s.minus({week:1});else if(r==="ArrowDown")s=s.plus({week:1});else if(r==="PageUp"){const o=n?"year":"month";s=s.minus({[o]:1})}else if(r==="PageDown"){const o=n?"year":"month";s=s.plus({[o]:1})}else if(r==="Home"){const o=i?"year":"month";s=s.startOf(o)}else if(r==="End"){const o=i?"year":"month";s=s.endOf(o)}else ly(r)&&(this.viewModel.value=s.toJSDate(),this.close());this._activeDate=s,e.preventDefault(),e.stopPropagation()}}_renderMonth(e,i){const n=Ve.now(),r=e.startOf("month"),s=e.endOf("month"),o=6,a=7;let l=r.minus({day:F8e(xr(),r.weekday)});const c=[];for(let u=0;u<o;u++){const d=[];for(let f=0;f<a;f++){const m=l.day,g=l.hasSame(e,"day"),y=l.hasSame(i,"day"),_=this._getDayId(l),b=pn.fromDateTimes(r,s),w={[wt.nearbyMonth]:!b.contains(l),[wt.today]:l.hasSame(n,"day"),[wt.activeDay]:g,[wt.selectedDay]:y};d.push(O("div",{"aria-label":m.toString(),"aria-selected":g.toString(),bind:this,class:this.classes(wt.day,w),"data-iso-date":l.toISO(),id:_,onclick:this._handleSelectedDate,onkeydown:this._handleSelectedDate,role:"gridcell"},m)),l=l.plus({day:1})}c.push(O("div",{class:wt.week,role:"row"},d))}return c}_renderYearPicker(e){const i={year:"numeric"},n=e,r=yi(n.valueOf(),i),s=yi(n.plus({year:1}).valueOf(),i),o=yi(n.minus({year:1}).valueOf(),i),{disabled:a,messages:l}=this;return O("div",{class:wt.yearPicker},O("div",{key:`previous-year-${a}`,"aria-label":l.goToPreviousYear,bind:this,class:wt.year,onclick:this._setPreviousYear,onkeydown:this._setPreviousYear,tabIndex:a?void 0:0,title:l.goToPreviousYear},o),O("div",{class:this.classes(wt.year,wt.selectedYear),id:`${this.id}__selected-year`},r),O("div",{key:`next-year-${a}`,"aria-label":l.goToNextYear,bind:this,class:wt.year,onclick:this._setNextYear,onkeydown:this._handleNextYearKeyDown,tabIndex:a?void 0:0,title:l.goToNextYear},s))}_setMonth(e){const i=e.target,n=Number(i.value)+1;this._activeDate&&(this._activeDate=this._activeDate.set({month:n}),this.commitOnMonthChange&&(this.viewModel.value=this._activeDate.toJSDate()))}_setPreviousMonth(){this._activeDate&&(this._activeDate=this._activeDate.minus({month:1}),this.commitOnMonthChange&&(this.viewModel.value=this._activeDate.toJSDate()))}_handlePreviousMonthKeyDown(e){if(e.key==="Tab"&&e.shiftKey)return e.preventDefault(),void this.close();ly(e.key)&&this._setPreviousMonth()}_setNextMonth(){this._activeDate&&(this._activeDate=this._activeDate.plus({month:1}),this.commitOnMonthChange&&(this.viewModel.value=this._activeDate.toJSDate()))}_setPreviousYear(){var e;this._activeDate=((e=this._activeDate)==null?void 0:e.minus({year:1}))??null}_setNextYear(){var e;this._activeDate=((e=this._activeDate)==null?void 0:e.plus({year:1}))??null}_handleNextYearKeyDown(e){if(e.key==="Tab"&&!e.shiftKey)return e.preventDefault(),void this.close();ly(e.key)&&this._setNextYear()}_handleSelectedDate(e){const i=e.target;this.viewModel.value=Ve.fromISO(i.getAttribute("data-iso-date")).toJSDate(),this.close()}};h([p()],Yr.prototype,"_activeDate",void 0),h([p()],Yr.prototype,"_calendarPopover",void 0),h([p()],Yr.prototype,"_isOpen",void 0),h([p()],Yr.prototype,"dateInputEnabled",void 0),h([p(),Zt("esri/widgets/support/t9n/DatePicker")],Yr.prototype,"messages",void 0),h([p()],Yr.prototype,"value",null),h([p()],Yr.prototype,"commitOnMonthChange",void 0),h([p({type:Wce})],Yr.prototype,"viewModel",void 0),h([p()],Yr.prototype,"onChange",void 0),h([p()],Yr.prototype,"disabled",void 0),h([p()],Yr.prototype,"isOpen",null),h([Dr()],Yr.prototype,"_setNextMonth",null),h([Dr()],Yr.prototype,"_setPreviousYear",null),h([Dr()],Yr.prototype,"_handleSelectedDate",null),Yr=h([P("esri.widgets.support.DatePicker")],Yr);const V8e=Yr;let iF=class extends qce{constructor(e){super(e)}};iF=h([P("esri.widgets.support.TimePickerViewModel")],iF);const Jce=iF,DO="esri-time-picker",NO={base:`${DO} esri-widget`,timePicker:`${DO}__date-picker`,timePickerInput:`${DO}__input`,input:"esri-input",button:"esri-widget--button"},nF={hour:"numeric",minute:"numeric"},aW="t",j8e=["ArrowDown","ArrowLeft","ArrowRight","ArrowUp","Tab"];function lW(t){return t!=null&&yi(t.valueOf(),nF).includes(" ")}let Jv=class extends qi{constructor(e,i){super(e,i),this._activePart=null,this._activeTime=null,this.messages=null,this.viewModel=new Jce}get value(){return this.viewModel.value}set value(e){this.viewModel.value=e}render(){const e=this._activeTime||this.viewModel.value;return O("div",{class:NO.base},O("input",{afterUpdate:this._handleInputUpdate,"aria-label":this.messages.inputTitle,bind:this,class:this.classes(NO.timePickerInput,NO.input),onblur:this._handleInputBlur,onfocus:this._handleInputFocus,onkeydown:this._handleInputKeydown,oninput:this._handleInputKeydown,onclick:this._handleInputClick,onpaste:this._handleInputPaste,onwheel:this._handleInputWheel,value:yi(e.valueOf(),nF)}))}_handleInputBlur(){var e;(e=this._activeTime)!=null&&e.isValid&&(this.viewModel.value=this._activeTime.toJSDate()),this._activeTime=null,this._activePart=null}_handleInputUpdate(e){this._selectPart(e,this._activePart)}_selectPart(e,i){const n=this._activeTime;if(!n||!e)return;const r=yi(n.valueOf(),nF),s=0,o=r.indexOf(":");if(i==="hours")return void e.setSelectionRange(s,o);const a=o+1,l=a+2;if(i==="minutes")return void e.setSelectionRange(a,l);const c=l+1,u=r.length;i!=="meridiem"||e.setSelectionRange(c,u)}_handleInputFocus(e){this._activePart="hours",this._activeTime=Ve.fromJSDate(this.viewModel.value).startOf("minute"),this._selectPart(e.target,"hours")}_caretIndexToPartName(e){var s;const i=(s=this._activeTime)==null?void 0:s.toFormat(aW,{locale:xr(),numberingSystem:"latn"});if(!i)return null;const n=i.indexOf(":"),r=i.indexOf(" ");return e<=n?"hours":e>n&&e<=r?"minutes":"meridiem"}_handleInputKeydown(e){const{ctrlKey:i,metaKey:n,shiftKey:r}=e,s=Uh(e),o=this._activeTime,a=this._activePart,l=/\d/.test(s),c=/^a|p$/i.test(s),u=n||i;if((j8e.includes(s)||l||a==="meridiem"&&c&&!u)&&o!=null){if(s==="ArrowLeft")this._activePart=this._prevPart();else if(s==="ArrowRight")this._activePart=this._nextPart();else if(s==="Tab"){const d=r?this._prevPart():this._nextPart();if(d===this._activePart)return;this._activePart=d}else if(s==="ArrowUp")this._shift("up",a);else if(s==="ArrowDown")this._shift("down",a);else if(l)this._setTime(o,a,Number(s));else if(c){const d=s.toLowerCase(),f=o.hour;(d==="a"&&f>=12||d==="p"&&f<12)&&this._shift("up",a)}e.preventDefault(),e.stopImmediatePropagation()}else u||(e.preventDefault(),e.stopImmediatePropagation())}_handleInputClick(e){const i=e.target;this._activePart=null,this.renderNow(),this._activePart=this._caretIndexToPartName(i.selectionStart??0)}_getOrderedParts(){return lW(this._activeTime)?["hours","minutes","meridiem"]:["hours","minutes"]}_prevPart(){const e=this._getOrderedParts(),i=this._activePart?e.indexOf(this._activePart)-1:0;return e[Math.max(i,0)]}_nextPart(){const e=this._getOrderedParts(),i=this._activePart?e.indexOf(this._activePart)+1:0;return e[Math.min(i,e.length-1)]}_setTime(e,i,n){if(i==="hours"){const r=lW(e)?12:24,s=""+e.hour%r,o=n,a=+`${s}${n}`;s.length===2||a>r?this._activeTime=e.set({hour:o}):a<=r&&(this._activeTime=e.set({hour:a}))}else if(i==="minutes"){const s=`${e.minute}`,o=n,a=+`${s}${n}`;s.length===2||a>59?this._activeTime=e.set({minute:o}):a<59&&(this._activeTime=e.set({minute:a}))}}_parseTime(e){if(!e)return null;const i={locale:xr(),numberingSystem:"latn"};let n=Ve.fromFormat(e,aW,i);return n.isValid?n:(n=Ve.fromISO(e,i),n.isValid?n:(n=Ve.fromRFC2822(e,i),n.isValid?n:(n=Ve.fromJSDate(new Date(e)),n.isValid?n:null)))}_handleInputPaste(e){var r;const i=(r=e.clipboardData)==null?void 0:r.getData("text/plain"),n=this._parseTime(i);n&&(this._activeTime=n),e.preventDefault(),e.stopImmediatePropagation()}_handleInputWheel(e){const i=e.deltaY<0?"up":"down";this._shift(i,this._activePart)}_shift(e,i){var o;if(!i)return;const n=e==="up"?"plus":"minus",r=i==="meridiem"?12:1,s=i==="hours"?"hour":i==="minutes"?"minute":"hours";this._activeTime=((o=this._activeTime)==null?void 0:o[n]({[s]:r}))??null}};h([p(),Zt("esri/widgets/support/t9n/TimePicker")],Jv.prototype,"messages",void 0),h([p()],Jv.prototype,"value",null),h([p({type:Jce})],Jv.prototype,"viewModel",void 0),Jv=h([P("esri.widgets.support.TimePicker")],Jv);const B8e=Jv,U8e={cancelEdit:"Escape"},ym="esri-field-column",Ol={headerContent:`${ym}__header-content`,headerLabel:`${ym}__header-label`,input:`${ym}__cell-input`,inputContainer:`${ym}__cell__input-container`,dateInputContainer:`${ym}__cell__date-input-container`,dateInputWrapper:`${ym}__cell__date-input-wrapper`,button:`${ym}__button`,saveIcon:"esri-icon-save",trashIcon:"esri-icon-trash",locked:"esri-icon-locked"},G8e=Dh("short-date-short-time"),H8e=Dh("short-date"),q8e={useGrouping:!0,maximumFractionDigits:20};let Ut=class extends R8e{constructor(e){super(e),this._inputField=null,this.cellValueFormatFunction=({rowData:i,value:n})=>{var l,c;if(this.formatFunction){const{config:u,field:d}=this;return this.formatFunction({config:u,field:d,value:Ef.sanitize(n)})}if(n===null)return"&nbsp;";const{config:r,field:s}=this,o=(l=i==null?void 0:i.item)==null?void 0:l.feature,a=this._getDomainForFeature(o);if(a)return this._getComputedDomain(n,a);if(s.type==="date"){const u=this._getDateFormatOptions(),d=((c=this.layer)==null?void 0:c.type)==="feature"&&this.layer.datesInUnknownTimezone?{timeZone:"UTC"}:null;return n?yi(n,{...u,...d}):null}if(Zq.has(s.type)&&n){const u=Rce(s,n);return Ef.sanitize(u)}if(xu(s)){const u=r!=null&&r.format?K6(r.format):q8e;return Ns(parseFloat(n),u)}return Ef.sanitize(n)},this.cellValueValidatorFunction=({oldValue:i,value:n})=>!(this._inputField&&!this._inputField.valid)&&(!this.required||n!=null&&n!=="")&&i!==n,this.config=null,this.editingEnabled=!1,this.expressionInfos=null,this.field=null,this.formatFunction=null,this.headerRenderFunction=i=>{const{root:n}=i,{editable:r,editingEnabled:s,headerMenuEnabled:o,sortable:a}=this;if(this.removeCellContent(n),n.classList.add(Ol.headerContent),s&&!r&&n.appendChild(this.createLockedElement()),a)this.headerSorterRenderFunction(i);else{const l=document.createElement("div");l.classList.add(Ol.headerLabel),l.textContent=this.label,n.appendChild(l)}o&&this.headerMenuRenderFunction(i)},this.inputRenderFunction=({root:i,column:n,rowData:r})=>{var l,c;if((l=this.activeEditInfo)!=null&&l.updating||!this.editable)return;const s=this.getCellValue(n,r),o=this.createInputElement({root:i,column:n,rowData:r,value:s});if(this._set("activeEditInfo",{column:n,input:o,root:i,rowData:r,updating:!0,oldValue:s}),this.field.type==="date")return void this._renderDateEditors(s,i,o);const a=this.createInputContainer();a.appendChild(o),this.removeCellContent(i),i.appendChild(a),o.focus(),o instanceof HTMLInputElement&&o.select(),(c=this.grid)==null||c.notifyResize()},this.layer=null,this.parseInputValueFunction=({input:i})=>{const n=this._inputField;if(!n)return null;const r=i.value,{dataType:s,required:o}=n;return o||r!==""?s==="number"||s==="date"?parseFloat(r):s==="text"?r.trim():r:null},this.store=null,this.template=null,this.updateRowItemFunction=({rowData:i,column:n,value:r})=>{i&&(i.item.feature.attributes[n.path]=r)},this.updateStoreItemFunction=async({rowData:i,column:n,value:r})=>{if(!i||!this.store)return;const s=i.item.objectId,o=this.store.getObjectIdIndex(s)??i.index;await this.store.updateItem({index:o,name:n.path,value:r})}}get alias(){var e;return(e=this.field)==null?void 0:e.alias}get defaultValue(){var e;return(e=this.field)==null?void 0:e.defaultValue}get description(){var e,i,n;return((e=this.template)==null?void 0:e.description)??((i=this.config)==null?void 0:i.description)??((n=this.field)==null?void 0:n.description)??null}get editable(){const{config:e,editingEnabled:i,field:n,layer:r,template:s}=this;if(n==null||r==null)return!1;const o=Tee(r),a=tf(r),l=a==null?void 0:a.operations.supportsUpdate;return!!(n.editable&&o&&l)&&!Zq.has(n.type)&&(i?!((s==null?void 0:s.editable)===!1||(e==null?void 0:e.editable)===!1):!(!(s!=null&&s.editable)&&!(e!=null&&e.editable)))}get header(){var e,i;return((e=this.template)==null?void 0:e.label)||((i=this.config)==null?void 0:i.label)||this.alias||this.path||null}get hidden(){const{config:e}=this;return(e==null?void 0:e.visible)===!1||this._get("hidden")||!1}set hidden(e){this._set("hidden",e)}get loadingMessage(){var e;return((e=this.messages)==null?void 0:e.loading)||"..."}get maxLength(){const{field:e,config:i,template:n}=this,r=e==null?void 0:e.length,s=n!=null&&n.input&&"maxLength"in n.input?n.input.maxLength:i==null?void 0:i.maxLength;return s!=null&&!isNaN(s)&&s>=-1&&(r===-1||s<=r)?s:r}get minLength(){const{config:e,template:i,maxLength:n}=this,r=i!=null&&i.input&&"minLength"in i.input?i.input.minLength:(e==null?void 0:e.minLength)||null;return n&&r<=n?r:null}get name(){var e;return(e=this.field)==null?void 0:e.name}get nullable(){var e;return((e=this.field)==null?void 0:e.nullable)??!1}get path(){var e;return(e=this.field)==null?void 0:e.name}get required(){const{config:e,field:i,template:n}=this,r=i==null?void 0:i.nullable,s=e==null?void 0:e.required,o=n==null?void 0:n.required;return this.editable&&(!r||s===!0||o===!0)}get sortable(){var e,i;return this.template?((e=this.template)==null?void 0:e.sortable)!==!1:((i=this.config)==null?void 0:i.sortable)!==!1}createInputElement({rowData:e,value:i}){const n=e==null?void 0:e.item;if(!n||!n.feature)return null;this._inputField=this._setUpInputField(n.feature,i);const{field:r,maxLength:s,minLength:o,required:a}=this,{domain:l}=this._inputField;let c;(l==null?void 0:l.type)==="coded-value"?(c=this._createSelectElement(i,l.codedValues.map(({code:f,name:m})=>({value:f,name:m})),this._inputField),c.onchange=()=>{c.onblur=null,d()}):(c=document.createElement("input"),c.type=xu(r)?"number":"text",s>-1&&(c.maxLength=s),o>0&&(c.minLength=o)),c.classList.add(Ol.input),c.value=i,c.required=a;let u=!1;c.onkeydown=f=>{u=f.key===U8e.cancelEdit},c.onblur=()=>{c.onblur=null,d()};const d=()=>{u?this.cancel():this.submit(),this._inputField=null};return c}createInputContainer(){const e=document.createElement("div");return e.classList.add(Ol.inputContainer),e}createLockedElement(){const e=document.createElement("div");return e.classList.add(Ol.locked),e}getCellValue({path:e},i){var n,r,s;return((s=(r=(n=i==null?void 0:i.item)==null?void 0:n.feature)==null?void 0:r.attributes)==null?void 0:s[e])??null}_renderDateEditors(e,i,n){var S;const{config:r,messagesCommon:s,template:o}=this,a=e?new Date(e):new Date(Date.now()),l=new V8e({dateInputEnabled:!0,value:a}),c=new B8e({value:a});n.value=a.getTime().toString();let u=!e;const d=()=>{u=!0;const T=this._getCombinedDateTime(l.value,c.value);n.value=T.getTime().toString()},f=()=>{u?this.submit():this.cancel()},m=()=>{n.value=null,this.submit()};Q(()=>[l.value,c.value],()=>d());const g=document.createElement("div"),y=document.createElement("div");l.container=g,c.container=y;const _=document.createElement("button");_.classList.add(Ol.button,Ol.saveIcon),_.onclick=()=>f(),_.title=s==null?void 0:s.save;const b=document.createElement("button");b.classList.add(Ol.button,Ol.trashIcon),b.onclick=()=>m(),b.title=s==null?void 0:s.clear;const w=document.createElement("div");w.classList.add(Ol.dateInputWrapper),w.appendChild(g),(o&&o.input&&o.input.type==="datetime-picker"&&o.input.includeTime!==!1||r&&r.includeTime!==!1)&&w.appendChild(y);const x=document.createElement("div");x.classList.add(Ol.dateInputContainer),x.appendChild(w),x.appendChild(_),x.appendChild(b),l.when(()=>{var I;const T=l._inputOrButtonNode;T&&(T.onblur=C=>{const M=C.relatedTarget;M&&M.className.includes("esri-date-picker")||l.close(!1)}),(I=this.grid)==null||I.notifyResize()}),c.when(()=>{var T;return(T=this.grid)==null?void 0:T.notifyResize()}),this.removeCellContent(i),i.appendChild(x),(S=this.grid)==null||S.notifyResize()}_createSelectElement(e,i,n){let r=!1;const s=i.map(a=>{a.value===e&&(r=!0);const l=document.createElement("option");return l.text=a.name,l.value=a.value,l});if(e!=null&&e!==""&&!r){const a=document.createElement("option");a.text=e,a.value=e,s.unshift(a)}if(!n.required&&n.value==null){const a=document.createElement("option");a.value="",s.unshift(a)}const o=document.createElement("select");return s.forEach(a=>o.add(a)),o.value=e,o}_setUpInputField(e,i){const{field:n,layer:r}=this,s=new k8e({feature:e,initialFeature:e.clone(),field:n,layer:r});return s.set("value",i),s}_isDomainCompatible(e){const{field:i}=this;if(e&&e.type==="coded-value"){const n=typeof e.codedValues[0].code;if(n==="string"&&LR(i)||n==="number"&&xu(i))return!0}return!(!e||e.type!=="range"||!xu(i))}_getDomainForFeature(e){var d;const{config:i,layer:n,name:r,template:s}=this;if(!n||n.type==="wfs"||n.type==="geojson"||n.type==="csv")return null;if(s!=null&&s.domain&&this._isDomainCompatible(s.domain))return s.domain;const{typeIdField:o}=n,a=o===r,l=this.field.domain;if(a&&!l)return new JP({name:"__internal-type-based-coded-value-domain__",codedValues:(d=n.types)==null?void 0:d.map(({id:f,name:m})=>({code:f,name:m}))});const c=o&&r!=null&&n.getFieldDomain(r,{feature:e})||l,u=i==null?void 0:i.domain;return this._isDomainCompatible(u)?u:c}_getComputedDomain(e,i){if(!i)return null;if(i.type==="range")return e;if(i.type==="coded-value"){const n=i.codedValues.filter(r=>r.hasOwnProperty("code")&&r.code===e);return n&&n.length?n[0].name:e}return null}_getCombinedDateTime(e,i){return new Date(e.getFullYear(),e.getMonth(),e.getDate(),i.getHours(),i.getMinutes(),i.getSeconds())}_getDateFormatOptions(){var r,s;const{config:e,template:i}=this,n=((r=i==null?void 0:i.format)==null?void 0:r.dateFormat)||((s=e==null?void 0:e.format)==null?void 0:s.dateFormat);return n?Dh(n):i&&i.input&&!("includeTime"in i.input)||(e==null?void 0:e.includeTime)===!1?H8e:G8e}};h([p({readOnly:!0})],Ut.prototype,"alias",null),h([p()],Ut.prototype,"cellValueFormatFunction",void 0),h([p()],Ut.prototype,"cellValueValidatorFunction",void 0),h([p()],Ut.prototype,"config",void 0),h([p({readOnly:!0})],Ut.prototype,"defaultValue",null),h([p({readOnly:!0})],Ut.prototype,"description",null),h([p({readOnly:!0})],Ut.prototype,"editable",null),h([p()],Ut.prototype,"editingEnabled",void 0),h([p()],Ut.prototype,"expressionInfos",void 0),h([p()],Ut.prototype,"field",void 0),h([p()],Ut.prototype,"formatFunction",void 0),h([p({readOnly:!0})],Ut.prototype,"header",null),h([p()],Ut.prototype,"hidden",null),h([p()],Ut.prototype,"headerRenderFunction",void 0),h([p()],Ut.prototype,"inputRenderFunction",void 0),h([p()],Ut.prototype,"layer",void 0),h([p({readOnly:!0})],Ut.prototype,"loadingMessage",null),h([p()],Ut.prototype,"maxLength",null),h([p()],Ut.prototype,"minLength",null),h([p({readOnly:!0})],Ut.prototype,"name",null),h([p({readOnly:!0})],Ut.prototype,"nullable",null),h([p()],Ut.prototype,"parseInputValueFunction",void 0),h([p({readOnly:!0})],Ut.prototype,"path",null),h([p({readOnly:!0})],Ut.prototype,"required",null),h([p()],Ut.prototype,"sortable",null),h([p()],Ut.prototype,"store",void 0),h([p()],Ut.prototype,"template",void 0),h([p()],Ut.prototype,"updateRowItemFunction",void 0),h([p()],Ut.prototype,"updateStoreItemFunction",void 0),Ut=h([P("esri.widgets.FeatureTable.FieldColumn")],Ut);const FO=Ut;let xo=class extends ye{constructor(e){super(e),this.cellClassNameGenerator=null,this.columnReorderingEnabled=!0,this.columns=new xe,this.dataProvider=async({page:i,pageSize:n},r)=>{const{store:s}=this;r&&(s?r(await s.fetchItems({page:i,pageSize:n})):r&&r([]))},this.multiSortEnabled=!1,this.pageSize=50,this.rowDetailsRenderer=null,this.store=null}get highlightIds(){return this._get("highlightIds")||new xe}set highlightIds(e){Array.isArray(e)?this._set("highlightIds",new xe(e)):this._set("highlightIds",e)}get size(){return this.store&&this.store.count||0}get state(){const{store:e}=this;return e&&e.state!=="disabled"?e.state==="loading"?"loading":e.state==="loaded"?"loaded":"ready":"disabled"}closeColumnMenus(){var e;(e=this.columns)==null||e.forEach(i=>{i.menu&&i.menu.open&&i.menu.set("open",!1)})}sortColumn(e,i){const n=this.findColumn(e);n&&(n.direction=i)}hideColumn(e){const i=this.findColumn(e);(i==null?void 0:i.hidden)===!1&&(i.hidden=!0)}showColumn(e){const i=this.findColumn(e);i!=null&&i.hidden&&(i.hidden=!1)}showAllColumns(){var e;(e=this.columns)==null||e.forEach(i=>{i.hidden&&(i.hidden=!1)})}findColumn(e){const i=[];return this.columns.forEach(n=>{var r;i.push(n),"columns"in n&&((r=n.columns)==null||r.forEach(s=>i.push(s)))}),i.find(n=>n.path===e)}getRowItemAt(e){var i;return(i=this.store)==null?void 0:i.getLocalItemAt(e)}refresh(){this.store&&(this.store.reset(),this.store.load())}};h([p()],xo.prototype,"cellClassNameGenerator",void 0),h([p()],xo.prototype,"columnReorderingEnabled",void 0),h([p()],xo.prototype,"columns",void 0),h([p()],xo.prototype,"dataProvider",void 0),h([p()],xo.prototype,"highlightIds",null),h([p()],xo.prototype,"multiSortEnabled",void 0),h([p()],xo.prototype,"pageSize",void 0),h([p()],xo.prototype,"rowDetailsRenderer",void 0),h([p({readOnly:!0})],xo.prototype,"size",null),h([p()],xo.prototype,"store",void 0),h([p({readOnly:!0})],xo.prototype,"state",null),xo=h([P("esri.widgets.FeatureTable.Grid.GridViewModel")],xo);const Zce=xo;let W8e=class extends HTMLElement{static get version(){return"1.6.1"}};customElements.define("vaadin-lumo-styles",W8e);let zO,VO=null,cW=window.HTMLImports&&window.HTMLImports.whenReady||null;function uW(t){requestAnimationFrame(function(){cW?cW(t):(VO||(VO=new Promise(e=>{zO=e}),document.readyState==="complete"?zO():document.addEventListener("readystatechange",()=>{document.readyState==="complete"&&zO()})),VO.then(function(){t&&t()}))})}const hW="__seenByShadyCSS",HI="__shadyCSSCachedStyle";let t$=null,e2=null,Mp=class{constructor(){this.customStyles=[],this.enqueued=!1,uW(()=>{window.ShadyCSS.flushCustomStyles&&window.ShadyCSS.flushCustomStyles()})}enqueueDocumentValidation(){!this.enqueued&&e2&&(this.enqueued=!0,uW(e2))}addCustomStyle(e){e[hW]||(e[hW]=!0,this.customStyles.push(e),this.enqueueDocumentValidation())}getStyleForCustomStyle(e){if(e[HI])return e[HI];let i;return i=e.getStyle?e.getStyle():e,i}processStyles(){const e=this.customStyles;for(let i=0;i<e.length;i++){const n=e[i];if(n[HI])continue;const r=this.getStyleForCustomStyle(n);if(r){const s=r.__appliedElement||r;t$&&t$(s),n[HI]=s}}return e}};Mp.prototype.addCustomStyle=Mp.prototype.addCustomStyle,Mp.prototype.getStyleForCustomStyle=Mp.prototype.getStyleForCustomStyle,Mp.prototype.processStyles=Mp.prototype.processStyles,Object.defineProperties(Mp.prototype,{transformCallback:{get:()=>t$,set(t){t$=t}},validateCallback:{get:()=>e2,set(t){let e=!1;e2||(e=!0),e2=t,e&&this.enqueueDocumentValidation()}}});const rF=/(?:^|[;\s{]\s*)(--[\w-]*?)\s*:\s*(?:((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};{])+)|\{([^}]*)\}(?:(?=[;\s}])|$))/gi,i$=/(?:^|\W+)@apply\s*\(?([^);\n]*)\)?/gi,J8e=/@media\s(.*)/;function sF(t,e){for(let i in e)i===null?t.style.removeProperty(i):t.style.setProperty(i,e[i])}function Yce(t,e){const i=window.getComputedStyle(t).getPropertyValue(e);return i?i.trim():""}function Z8e(t){const e=i$.test(t)||rF.test(t);return i$.lastIndex=0,rF.lastIndex=0,e}const uk=!(window.ShadyDOM&&window.ShadyDOM.inUse);let r8,sS;function dW(t){r8=(!t||!t.shimcssproperties)&&(uk||!!(!navigator.userAgent.match(/AppleWebKit\/601|Edge\/15/)&&window.CSS&&CSS.supports&&CSS.supports("box-shadow","0 0 0 var(--foo)")))}window.ShadyCSS&&window.ShadyCSS.cssBuild!==void 0&&(sS=window.ShadyCSS.cssBuild);const Xce=!!(window.ShadyCSS&&window.ShadyCSS.disableRuntime);window.ShadyCSS&&window.ShadyCSS.nativeCss!==void 0?r8=window.ShadyCSS.nativeCss:window.ShadyCSS?(dW(window.ShadyCSS),window.ShadyCSS=void 0):dW(window.WebComponents&&window.WebComponents.flags);const s8=r8,qI=new Mp;window.ShadyCSS||(window.ShadyCSS={prepareTemplate(t,e,i){},prepareTemplateDom(t,e){},prepareTemplateStyles(t,e,i){},styleSubtree(t,e){qI.processStyles(),sF(t,e)},styleElement(t){qI.processStyles()},styleDocument(t){qI.processStyles(),sF(document.body,t)},getComputedStyleValue:(t,e)=>Yce(t,e),flushCustomStyles(){},nativeCss:s8,nativeShadow:uk,cssBuild:sS,disableRuntime:Xce}),window.ShadyCSS.CustomStyleInterface=qI,window.JSCompiler_renameProperty=function(t,e){return t};let WI,Wo,Y8e=/(url\()([^)]*)(\))/g,X8e=/(^\/[^\/])|(^#)|(^[\w-\d]*:)/;function t2(t,e){if(t&&X8e.test(t)||t==="//")return t;if(WI===void 0){WI=!1;try{const i=new URL("b","http://a");i.pathname="c%20d",WI=i.href==="http://a/c%20d"}catch{}}if(e||(e=document.baseURI||window.location.href),WI)try{return new URL(t,e).href}catch{return t}return Wo||(Wo=document.implementation.createHTMLDocument("temp"),Wo.base=Wo.createElement("base"),Wo.head.appendChild(Wo.base),Wo.anchor=Wo.createElement("a"),Wo.body.appendChild(Wo.anchor)),Wo.base.href=e,Wo.anchor.href=t,Wo.anchor.href||t}function o8(t,e){return t.replace(Y8e,function(i,n,r,s){return n+"'"+t2(r.replace(/["']/g,""),e)+"'"+s})}function a8(t){return t.substring(0,t.lastIndexOf("/")+1)}const l8=!window.ShadyDOM||!window.ShadyDOM.inUse;!window.ShadyCSS||window.ShadyCSS.nativeCss;const K8e=l8&&"adoptedStyleSheets"in Document.prototype&&"replaceSync"in CSSStyleSheet.prototype&&(()=>{try{const t=new CSSStyleSheet;t.replaceSync("");const e=document.createElement("div");return e.attachShadow({mode:"open"}),e.shadowRoot.adoptedStyleSheets=[t],e.shadowRoot.adoptedStyleSheets[0]===t}catch{return!1}})();let Q8e=window.Polymer&&window.Polymer.rootPath||a8(document.baseURI||window.location.href),n$=window.Polymer&&window.Polymer.sanitizeDOMValue||void 0,eBe=window.Polymer&&window.Polymer.setPassiveTouchGestures||!1,wb=window.Polymer&&window.Polymer.strictTemplatePolicy||!1,tBe=window.Polymer&&window.Polymer.allowTemplateFromDomModule||!1,oS=window.Polymer&&window.Polymer.legacyOptimizations||!1,Kce=window.Polymer&&window.Polymer.legacyWarnings||!1,iBe=window.Polymer&&window.Polymer.syncInitialRender||!1,oF=window.Polymer&&window.Polymer.legacyUndefined||!1,nBe=window.Polymer&&window.Polymer.orderedComputed||!1,pW=window.Polymer&&window.Polymer.removeNestedTemplates||!1,Qce=window.Polymer&&window.Polymer.fastDomIf||!1,aF=window.Polymer&&window.Polymer.suppressTemplateNotifications||!1,JI=window.Polymer&&window.Polymer.legacyNoObservedAttributes||!1,rBe=window.Polymer&&window.Polymer.useAdoptedStyleSheetsWithBuiltCSS||!1,c8={},eue={};function fW(t,e){c8[t]=eue[t.toLowerCase()]=e}function mW(t){return c8[t]||eue[t.toLowerCase()]}function sBe(t){t.querySelector("style")&&console.warn("dom-module %s has style outside template",t.id)}let xb=class extends HTMLElement{static get observedAttributes(){return["id"]}static import(e,i){if(e){let n=mW(e);return n&&i?n.querySelector(i):n}return null}attributeChangedCallback(e,i,n,r){i!==n&&this.register()}get assetpath(){if(!this.__assetpath){const e=window.HTMLImports&&HTMLImports.importForElement?HTMLImports.importForElement(this)||document:this.ownerDocument,i=t2(this.getAttribute("assetpath")||"",e.baseURI);this.__assetpath=a8(i)}return this.__assetpath}register(e){if(e=e||this.id){if(wb&&mW(e)!==void 0)throw fW(e,null),new Error(`strictTemplatePolicy: dom-module ${e} re-registered`);this.id=e,fW(e,this),sBe(this)}}};xb.prototype.modules=c8,customElements.define("dom-module",xb);const oBe="link[rel=import][type~=css]",aBe="include",gW="shady-unscoped";function u8(t){return xb.import(t)}function yW(t){const e=o8((t.body?t.body:t).textContent,t.baseURI),i=document.createElement("style");return i.textContent=e,i}function lBe(t){const e=t.trim().split(/\s+/),i=[];for(let n=0;n<e.length;n++)i.push(...cBe(e[n]));return i}function cBe(t){const e=u8(t);if(!e)return console.warn("Could not find style data in module named",t),[];if(e._styles===void 0){const i=[];i.push(...d8(e));const n=e.querySelector("template");n&&i.push(...h8(n,e.assetpath)),e._styles=i}return e._styles}function h8(t,e){if(!t._styles){const i=[],n=t.content.querySelectorAll("style");for(let r=0;r<n.length;r++){let s=n[r],o=s.getAttribute(aBe);o&&i.push(...lBe(o).filter(function(a,l,c){return c.indexOf(a)===l})),e&&(s.textContent=o8(s.textContent,e)),i.push(s)}t._styles=i}return t._styles}function uBe(t){let e=u8(t);return e?d8(e):[]}function d8(t){const e=[],i=t.querySelectorAll(oBe);for(let n=0;n<i.length;n++){let r=i[n];if(r.import){const s=r.import,o=r.hasAttribute(gW);if(o&&!s._unscopedStyle){const a=yW(s);a.setAttribute(gW,""),s._unscopedStyle=a}else s._style||(s._style=yW(s));e.push(o?s._unscopedStyle:s._style)}}return e}function hBe(t){let e=t.trim().split(/\s+/),i="";for(let n=0;n<e.length;n++)i+=dBe(e[n]);return i}function dBe(t){let e=u8(t);if(e&&e._cssText===void 0){let i=fBe(e),n=e.querySelector("template");n&&(i+=pBe(n,e.assetpath)),e._cssText=i||null}return e||console.warn("Could not find style data in module named",t),e&&e._cssText||""}function pBe(t,e){let i="";const n=h8(t,e);for(let r=0;r<n.length;r++){let s=n[r];s.parentNode&&s.parentNode.removeChild(s),i+=s.textContent}return i}function fBe(t){let e="",i=d8(t);for(let n=0;n<i.length;n++)e+=i[n].textContent;return e}const vW="include",mBe=window.ShadyCSS.CustomStyleInterface;let gBe=class extends HTMLElement{constructor(){super(),this._style=null,mBe.addCustomStyle(this)}getStyle(){if(this._style)return this._style;const e=this.querySelector("style");if(!e)return null;this._style=e;const i=e.getAttribute(vW);return i&&(e.removeAttribute(vW),e.textContent=hBe(i)+e.textContent),this.ownerDocument!==window.document&&window.document.head.appendChild(this),this._style}};window.customElements.define("custom-style",gBe);const _W=document.createElement("template");_W.innerHTML=`<custom-style>
  <style>
    html {
      /* Base (background) */
      --lumo-base-color: #FFF;

      /* Tint */
      --lumo-tint-5pct: hsla(0, 0%, 100%, 0.3);
      --lumo-tint-10pct: hsla(0, 0%, 100%, 0.37);
      --lumo-tint-20pct: hsla(0, 0%, 100%, 0.44);
      --lumo-tint-30pct: hsla(0, 0%, 100%, 0.5);
      --lumo-tint-40pct: hsla(0, 0%, 100%, 0.57);
      --lumo-tint-50pct: hsla(0, 0%, 100%, 0.64);
      --lumo-tint-60pct: hsla(0, 0%, 100%, 0.7);
      --lumo-tint-70pct: hsla(0, 0%, 100%, 0.77);
      --lumo-tint-80pct: hsla(0, 0%, 100%, 0.84);
      --lumo-tint-90pct: hsla(0, 0%, 100%, 0.9);
      --lumo-tint: #FFF;

      /* Shade */
      --lumo-shade-5pct: hsla(214, 61%, 25%, 0.05);
      --lumo-shade-10pct: hsla(214, 57%, 24%, 0.1);
      --lumo-shade-20pct: hsla(214, 53%, 23%, 0.16);
      --lumo-shade-30pct: hsla(214, 50%, 22%, 0.26);
      --lumo-shade-40pct: hsla(214, 47%, 21%, 0.38);
      --lumo-shade-50pct: hsla(214, 45%, 20%, 0.5);
      --lumo-shade-60pct: hsla(214, 43%, 19%, 0.61);
      --lumo-shade-70pct: hsla(214, 42%, 18%, 0.72);
      --lumo-shade-80pct: hsla(214, 41%, 17%, 0.83);
      --lumo-shade-90pct: hsla(214, 40%, 16%, 0.94);
      --lumo-shade: hsl(214, 35%, 15%);

      /* Contrast */
      --lumo-contrast-5pct: var(--lumo-shade-5pct);
      --lumo-contrast-10pct: var(--lumo-shade-10pct);
      --lumo-contrast-20pct: var(--lumo-shade-20pct);
      --lumo-contrast-30pct: var(--lumo-shade-30pct);
      --lumo-contrast-40pct: var(--lumo-shade-40pct);
      --lumo-contrast-50pct: var(--lumo-shade-50pct);
      --lumo-contrast-60pct: var(--lumo-shade-60pct);
      --lumo-contrast-70pct: var(--lumo-shade-70pct);
      --lumo-contrast-80pct: var(--lumo-shade-80pct);
      --lumo-contrast-90pct: var(--lumo-shade-90pct);
      --lumo-contrast: var(--lumo-shade);

      /* Text */
      --lumo-header-text-color: var(--lumo-contrast);
      --lumo-body-text-color: var(--lumo-contrast-90pct);
      --lumo-secondary-text-color: var(--lumo-contrast-70pct);
      --lumo-tertiary-text-color: var(--lumo-contrast-50pct);
      --lumo-disabled-text-color: var(--lumo-contrast-30pct);

      /* Primary */
      --lumo-primary-color: hsl(214, 90%, 52%);
      --lumo-primary-color-50pct: hsla(214, 90%, 52%, 0.5);
      --lumo-primary-color-10pct: hsla(214, 90%, 52%, 0.1);
      --lumo-primary-text-color: var(--lumo-primary-color);
      --lumo-primary-contrast-color: #FFF;

      /* Error */
      --lumo-error-color: hsl(3, 100%, 61%);
      --lumo-error-color-50pct: hsla(3, 100%, 60%, 0.5);
      --lumo-error-color-10pct: hsla(3, 100%, 60%, 0.1);
      --lumo-error-text-color: hsl(3, 92%, 53%);
      --lumo-error-contrast-color: #FFF;

      /* Success */
      --lumo-success-color: hsl(145, 80%, 42%); /* hsl(144,82%,37%); */
      --lumo-success-color-50pct: hsla(145, 76%, 44%, 0.55);
      --lumo-success-color-10pct: hsla(145, 76%, 44%, 0.12);
      --lumo-success-text-color: hsl(145, 100%, 32%);
      --lumo-success-contrast-color: #FFF;
    }
  </style>
</custom-style><dom-module id="lumo-color">
  <template>
    <style>
      [theme~="dark"] {
        /* Base (background) */
        --lumo-base-color: hsl(214, 35%, 21%);

        /* Tint */
        --lumo-tint-5pct: hsla(214, 65%, 85%, 0.06);
        --lumo-tint-10pct: hsla(214, 60%, 80%, 0.14);
        --lumo-tint-20pct: hsla(214, 64%, 82%, 0.23);
        --lumo-tint-30pct: hsla(214, 69%, 84%, 0.32);
        --lumo-tint-40pct: hsla(214, 73%, 86%, 0.41);
        --lumo-tint-50pct: hsla(214, 78%, 88%, 0.5);
        --lumo-tint-60pct: hsla(214, 82%, 90%, 0.6);
        --lumo-tint-70pct: hsla(214, 87%, 92%, 0.7);
        --lumo-tint-80pct: hsla(214, 91%, 94%, 0.8);
        --lumo-tint-90pct: hsla(214, 96%, 96%, 0.9);
        --lumo-tint: hsl(214, 100%, 98%);

        /* Shade */
        --lumo-shade-5pct: hsla(214, 0%, 0%, 0.07);
        --lumo-shade-10pct: hsla(214, 4%, 2%, 0.15);
        --lumo-shade-20pct: hsla(214, 8%, 4%, 0.23);
        --lumo-shade-30pct: hsla(214, 12%, 6%, 0.32);
        --lumo-shade-40pct: hsla(214, 16%, 8%, 0.41);
        --lumo-shade-50pct: hsla(214, 20%, 10%, 0.5);
        --lumo-shade-60pct: hsla(214, 24%, 12%, 0.6);
        --lumo-shade-70pct: hsla(214, 28%, 13%, 0.7);
        --lumo-shade-80pct: hsla(214, 32%, 13%, 0.8);
        --lumo-shade-90pct: hsla(214, 33%, 13%, 0.9);
        --lumo-shade: hsl(214, 33%, 13%);

        /* Contrast */
        --lumo-contrast-5pct: var(--lumo-tint-5pct);
        --lumo-contrast-10pct: var(--lumo-tint-10pct);
        --lumo-contrast-20pct: var(--lumo-tint-20pct);
        --lumo-contrast-30pct: var(--lumo-tint-30pct);
        --lumo-contrast-40pct: var(--lumo-tint-40pct);
        --lumo-contrast-50pct: var(--lumo-tint-50pct);
        --lumo-contrast-60pct: var(--lumo-tint-60pct);
        --lumo-contrast-70pct: var(--lumo-tint-70pct);
        --lumo-contrast-80pct: var(--lumo-tint-80pct);
        --lumo-contrast-90pct: var(--lumo-tint-90pct);
        --lumo-contrast: var(--lumo-tint);

        /* Text */
        --lumo-header-text-color: var(--lumo-contrast);
        --lumo-body-text-color: var(--lumo-contrast-90pct);
        --lumo-secondary-text-color: var(--lumo-contrast-70pct);
        --lumo-tertiary-text-color: var(--lumo-contrast-50pct);
        --lumo-disabled-text-color: var(--lumo-contrast-30pct);

        /* Primary */
        --lumo-primary-color: hsl(214, 86%, 55%);
        --lumo-primary-color-50pct: hsla(214, 86%, 55%, 0.5);
        --lumo-primary-color-10pct: hsla(214, 90%, 63%, 0.1);
        --lumo-primary-text-color: hsl(214, 100%, 70%);
        --lumo-primary-contrast-color: #FFF;

        /* Error */
        --lumo-error-color: hsl(3, 90%, 63%);
        --lumo-error-color-50pct: hsla(3, 90%, 63%, 0.5);
        --lumo-error-color-10pct: hsla(3, 90%, 63%, 0.1);
        --lumo-error-text-color: hsl(3, 100%, 67%);

        /* Success */
        --lumo-success-color: hsl(145, 65%, 42%);
        --lumo-success-color-50pct: hsla(145, 65%, 42%, 0.5);
        --lumo-success-color-10pct: hsla(145, 65%, 42%, 0.1);
        --lumo-success-text-color: hsl(145, 85%, 47%);
      }

      html {
        color: var(--lumo-body-text-color);
        background-color: var(--lumo-base-color);
      }

      [theme~="dark"] {
        color: var(--lumo-body-text-color);
        background-color: var(--lumo-base-color);
      }

      h1,
      h2,
      h3,
      h4,
      h5,
      h6 {
        color: var(--lumo-header-text-color);
      }

      a {
        color: var(--lumo-primary-text-color);
      }

      blockquote {
        color: var(--lumo-secondary-text-color);
      }

      code,
      pre {
        background-color: var(--lumo-contrast-10pct);
        border-radius: var(--lumo-border-radius-m);
      }
    </style>
  </template>
</dom-module><dom-module id="lumo-color-legacy">
  <template>
    <style include="lumo-color">
      :host {
        color: var(--lumo-body-text-color) !important;
        background-color: var(--lumo-base-color) !important;
      }
    </style>
  </template>
</dom-module>`,document.head.appendChild(_W.content);const bW=document.createElement("template");bW.innerHTML=`<custom-style>
  <style>
    @font-face {
      font-family: 'lumo-icons';
      src: url(data:application/font-woff;charset=utf-8;base64,d09GRgABAAAAABEcAAsAAAAAIiwAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABHU1VCAAABCAAAADsAAABUIIslek9TLzIAAAFEAAAAQwAAAFZAIUuKY21hcAAAAYgAAAD4AAADrsCU8d5nbHlmAAACgAAAC2MAABd4h9To2WhlYWQAAA3kAAAAMAAAADZa/6SsaGhlYQAADhQAAAAdAAAAJAbpA35obXR4AAAONAAAABAAAACspBAAAGxvY2EAAA5EAAAAWAAAAFh55IAsbWF4cAAADpwAAAAfAAAAIAFKAXBuYW1lAAAOvAAAATEAAAIuUUJZCHBvc3QAAA/wAAABKwAAAelm8SzVeJxjYGRgYOBiMGCwY2BycfMJYeDLSSzJY5BiYGGAAJA8MpsxJzM9kYEDxgPKsYBpDiBmg4gCACY7BUgAeJxjYGS+yDiBgZWBgamKaQ8DA0MPhGZ8wGDIyAQUZWBlZsAKAtJcUxgcXjG+0mIO+p/FEMUcxDANKMwIkgMABn8MLQB4nO3SWW6DMABF0UtwCEnIPM/zhLK8LqhfXRybSP14XUYtHV9hGYQwQBNIo3cUIPkhQeM7rib1ekqnXg981XuC1qvy84lzojleh3puxL0hPjGjRU473teloEefAUNGjJkwZcacBUtWrNmwZceeA0dOnLlw5cadB09elPGhGf+j0NTI/65KfXerT6JhqKnpRKtgOpuqaTrtKjPUlqHmhto21I7pL6i6hlqY3q7qGWrfUAeGOjTUkaGODXViqFNDnRnq3FAXhro01JWhrg11Y6hbQ90Z6t5QD4Z6NNSToZ4N9WKoV0O9GerdUB+G+jTUl6GWRvkL24BkEXictVh9bFvVFb/nxvbz+7Rf/N6zHcd2bCfP+Wgc1Z9N0jpNnEL6kbRVS6HA2hQYGh9TGR1CbCqa2rXrWOkQE/sHNJgmtZvoVNZqE1B1DNHxzTQxCehUTYiJTQyENui0qSLezr3PduyQfgmRWOfde8+9551z7rnn/O4jLoJ/bRP0UaKQMLFJjpBAvphLZC3Dk0ok7WBzR2/upJs7Ryw/nfFbln/uuN/apCvwrKLrSvUqRufbm5pn0fs0w4gYxnGVP6qHnO4bWiDQGQgwtS6lm3lB3QoX1M2vwEmuzirF39y+Es2+DJ8d1pkyqBIqoze3D1+Zz4DrFoazxI8dWwMrDlZ2DMqQAR9AROsJU+2cmlTPazTco52F1xTa2a2+K8vvq92dVHmtLoPeQX/AZPRYGthDYOeZjBjKoFsVGulR3lWU95WeCK44qHU7MhWUGUKZDT3oKUcG2GWuh+EDDfUYA/jhAhl0TOsJNYSEu7mQmi3UzfXwZKA4BsVsHLXQYGgRW95uEtpJ1Vfn9XiLriRBlFEqxsDjA09yCNUoQxxwd7KWSTt2y3GTKiflqHRSoWZc3m11Wa/fJdFgXD4sSYfleJBKd8GMz7J8dZn/cGRCcKGDnA2Ge3fKzcvlnTDNthGWLXzX/WaXtUAmRgeLlHSr30r0G9UTXMb0AtmwzOoy73fkSlHZkduw/TYuU9cAD4YutPoxTTsA3797wVr4Z/1NC5zARHr4vtxJjxIfiZMhMkbWk+14BnJZKwqGZwDfswLyxWDSg11rFLJF7Nopxjd1h1/QOT+oezgfu3Yq+Hk+duf5x+40o1GTkaIgikK/IEnC6aYxCUBaZJSN4XTYFjU/YMNIKqJwhDGOCCI8FDXnXmXjtGhGJyShqjAOnBOkW2JG9S7GgYeMWAU5JzhnWmBOaOM+CKEPoqSfFDC2Unq+DLlUgUVUFFLZGJg6jtlojsdsa8kPObPuJdi5dnBdBsLJMGTWDa4t2JvtwuPo9s+Y86suv/W33QG1rAaOAUV+vx4K6f2D04PVKlC7WLSrZzAi45ZV6lIC7WoXqmRyvUqoVwrzUoVsIjeTXWQv+RH5GTlBXiB/In8ln0IbBCAFOajAJrgZYyOHWqOfUe/aHjI12R6OQo1jCgt215l+4f6XPb+0MNou0V+43n2F77tSfRb24d7zitgnKmvYHs69zugaPvBwv6ioXkb2LdL65Atw51uLkXlu1bhMMRcXSPcYoqKIRlh34lQP8/5JbuUFye4vxD6/6MxFF11C0uVLr9Ulgw44tS3pMViNLUExbycFgLIct+QDMibRimx1ydUz8FXZiuOIDBOMVX2nUZc+huNE5XUJ81uiJoiabwqaVF0uacKbau/pl4R2VW0XXlJra6boVrYG646TF5NYzwy4vjENVrDlcNpZPl8DH6XX8XWCx0mvWVZY6KFLrvsY66/zPict5FnxaNUR/juvZCM3TvD60E2W1tZizbXTPDuabcm0nbbzpWKpmA1ayBQ8giedLUM+A0kNjBjQjmuYz7YrgIXYvmF63ZLBwSXrpn9Tb9wwdd/U1H0PMQK3XcO8ul3WT7PyPPdpy0TemKxNRcJNauiXJnnUDpUppQWs4SnUIy0EESGYqJYQLGHxzaGWwVIaS6Y7mQFM8ZjYDQ3axjf61SWjU33JwOZA1pwaG1L9mzf71aHRdX1JHw6Fp0aXhNwbqyeGNg4NbdzGCBxoz4ZXjy4Nu69Zr6sDY6vMrLU5nA1P8JkbdWXJ6ERfMryvNh1JfQ9+T4dIhGvK9w3dxjBBzatsQ/MlOHVIDnYpDz6odAXlQ01t2Pa5Iafd8MMpxAeDKP0C6CjgVLT5osB6icUx01lWjXxzT/GyRF2welEM5Z/7jG3VjQ1SrNn5IbyzOG5dobB3/QHxyZvsXcoz8IoEwS7plCg+zxHQk424q9BfEpkESJbFHQusDBSWFkuBkoPO0kLKwRVYjxGXlHTcTDQMJ/H6TX9afkO7mnraTO1feTnZAXLu4cp7HAXMmNG1yeFk9TgS/NHhZR/4QoBTr/ZB+6hCgyl15Nq1UbN6nE1/ZnP1U2cizCBpvs8cJQZJ4LkYx5N/yZPAUZNQQ0V4f3BQllWrK3YRzl30dOT6RVn2upNur6woSa8CqpdT/aKnBM4o3jNur9d9xqtUT6veBEt9Ca9at+ERzEEhUkR8sa5mQ4aVvJoVeEA8zI4ei5mULXFGyU7z/6TAeYLVcpzSWZY8PYYF5yrTV60sT0+XV141vX++Wf16V2bFeGVPZXxFpkvyeKTWLlzfW0mnKxsY6Y3294/0998SCfX1blm5pbcvFGlq/r07MRAMhYIDiW5JFKWW3vdrEpCsZSJG+om7Zu/PSScZJhNkLbmW5Wsr12pWqW5zKtlwRS4bFOxUw17mCzy6lskCDl1WYOGWDYrADrMA7BDDweWWNd5koiJnR1dz+ytLP2q0SqPB1lnK2ccB7RYe4FSoPks3iB3t4txTSHctb2sy1ivk0pvHuCNm6w1f6wxv3+OCgN78LqdQnUVh7R0oTAp0zOf2rbW770Vu5C2dIyGdTnHo8zSji7dppj0USoVCz+lhRMTh53Teq9VbGfbjuSbAooSdXayY4PYHg374C6f7gl1B/DXuJ4/QXxOBdJFJspFsI3egpoWUUCjlTIFnNYNl+ZyZKmBeYKGHkD1QyDlhaKbKwKcIJqJ4TLJ2OmdY/JWXae4DdGBw8HZ7eXcgFF2zr2SoalDry5iKqoa0Puhe3hPQ2s3elTYM+MI+n3rK0KgL7/La3GeMLt6m7u912vGnvtORiIa0qBmhqVi+XW9XNBmqb8eVgKzIHfGI5bNoG7X0UCzeISmqIcO/nY8FH7U8avX9fx/ST+hx0sezPw9Qy8Mum3GWf2N4Uy/yIYGVBXbJHWIZp7dfTcptdMTr9Qmq7DaiK/ukqCL4kt4RUfS5XPnMtmT22/mQFqF7emSqtrlu8SVElxDRJrZODkpuwe0VfTfjdEp1f7A7v+fozNBXUJ/6WTuK2TtFlpFVZAZ3LcFvUi1Z2p2YT+EMAkGJVStOzLTAPg4IqWIAlzRSjOBkl2zxj3TKycpzT/MnvX3uaSMWM+gU0rkXjohhefVRMaps3/kLMSKv23lT23uxQrkQjyOJleMDsdhAnD6ZGElWZ5MjCXzCE/hkWX+WF4knzGhVOyK2eQZekV3eyo0zL8kuYWCnDCvjjhAkcTPOBDXVdoav3HVcFnQjLvtV9S2p0zA6JegPwMQxt+yFb3ll9zGlq/5dRKb3cEyQYoaNYpharJ7xCB7AWxsLY3jjZXY0XsZj0Wjwc9I6PP/dKABnCZaqHpaZEACxk4ZeLZSKNgZABl+lYQX1sJQOSX3n6r410evcoud5JeAGUXVP9H1tZOKejTq4Ono0z0erro1FrnOpohva1d/hTdtVsQdKN5W9RlT3NjD0nznyKNTgKAMfWNWcyodV0IGLPIHOF0o4JyqufaK4z6WIIzuGh3d8c8cwQg8ER+OVxyrjdm8vNuhts4LoOihGxIMuUdgzwiYN7xhh1+oZnJNuTG7gQZvu4XWZ9GAZZjGEubwePqYhtKDTH+9VQkl17/iGybsnJ+8+sKtyPrcll9ty65Zsdst/9iqpEKh7M5VdBxh3csOdNc6tW3I1uyM1PzOXegSOrLFsFNI2O27M+TF2ApnN9MUv5ud6LjxIvEQnHRzxIu4IsA9MLFkJn2tcZoZ7ON7dXe7ujrc8HrusPKamlqXwd77lQUuLpilau4PUMapueBb7irU4RoUXEYXuVuIGlRGmOp+2lNkaRPVziOqmlaZvaqG4dFgSj0jxEJWrv12IUWntmw+rfQarRE0Aph4ocI6nlUlGqs+u3/+T/ethW62PpHp2eHbZstnh/wOO95yDAHicY2BkYGAA4pmJ6QHx/DZfGbiZXwBFGGpUNzQi6P+vmacy3QJyORiYQKIANoULVXicY2BkYGAO+p8FJF8wAAHzVAZGBlSgDQBW9gNvAAAAeJxjYGBgYH4xNDAAzwQmjwAAAAAATgCaAOgBCgEsAU4BcAGaAcQB7gIaApwC6ASaBLwE1gTyBQ4FKgV6BdAF/gZEBmYGtgcYB5AIGAhSCGoI/glGCb4J2goECjwKggq4CvALUAuWC7x4nGNgZGBg0GZMYRBlAAEmIOYCQgaG/2A+AwAYlAG8AHicbZE9TsMwGIbf9A/RSggEYmHxAgtq+jN2ZGj3Dt3T1GlTOXHkuBW9AyfgEByCgTNwCA7BW/NJlVBtyd/jx+8XKwmAa3whwnFE6Ib1OBq44O6Pm6Qb4Rb5QbiNHh6FO/RD4S6eMRHu4RaaT4halzR3eBVu4Apvwk36d+EW+UO4jXt8Cnfov4W7WOBHuIen6MXsCtvPU1vWc73emcSdxIkW2tW5LdUoHp7kTJfaJV6v1PKg6v167H2mMmcLNbWl18ZYVTm71amPN95Xk8EgEx+ntoDBDgUs+siRspaoMef7rukNEriziXNuwS7Hmoe9wggxv+e55IzJMqQTeNYV00scuNbY8+YxrUfGfcaMZb/CNPQe04bT0lThbEuT0sfYhK6K/23Amf3Lx+H24hcj4GScAAAAeJxtjtlugzAQRbkJUEJIuu/7vqR8lGNPAcWx0YAb5e/LklR96EgenSufGY038PqKvf9rhgGG8BEgxA4ijBBjjAQTTLGLPezjAIc4wjFOcIoznOMCl7jCNW5wizvc4wGPeMIzXvCKN7zjAzN8eonQRWZSSaYmjvug6ase98hFltexMJmmVNmV2WBvdNgZUc+ujAWzXW3UDnu1w43asStHc8GpzAXX/py0jqTQZJTgkcxJLpaCF0lD32xNt+43tAsn29Dft02uDKS2cjGUNgsk26qK2lFthYoU27INPqmiDqg5goe0pqR5qSoqMdek/CUZFywL46rEsiImleqiqoMyt4baXlu/1GLdNFf5zbcNmdr1YUWCZe47o+zUmb/DoStbw3cVsef9ALjjiPQA) format('woff');
      font-weight: normal;
      font-style: normal;
    }

    html {
      --lumo-icons-align-center: "\\ea01";
      --lumo-icons-align-left: "\\ea02";
      --lumo-icons-align-right: "\\ea03";
      --lumo-icons-angle-down: "\\ea04";
      --lumo-icons-angle-left: "\\ea05";
      --lumo-icons-angle-right: "\\ea06";
      --lumo-icons-angle-up: "\\ea07";
      --lumo-icons-arrow-down: "\\ea08";
      --lumo-icons-arrow-left: "\\ea09";
      --lumo-icons-arrow-right: "\\ea0a";
      --lumo-icons-arrow-up: "\\ea0b";
      --lumo-icons-bar-chart: "\\ea0c";
      --lumo-icons-bell: "\\ea0d";
      --lumo-icons-calendar: "\\ea0e";
      --lumo-icons-checkmark: "\\ea0f";
      --lumo-icons-chevron-down: "\\ea10";
      --lumo-icons-chevron-left: "\\ea11";
      --lumo-icons-chevron-right: "\\ea12";
      --lumo-icons-chevron-up: "\\ea13";
      --lumo-icons-clock: "\\ea14";
      --lumo-icons-cog: "\\ea15";
      --lumo-icons-cross: "\\ea16";
      --lumo-icons-download: "\\ea17";
      --lumo-icons-dropdown: "\\ea18";
      --lumo-icons-edit: "\\ea19";
      --lumo-icons-error: "\\ea1a";
      --lumo-icons-eye: "\\ea1b";
      --lumo-icons-eye-disabled: "\\ea1c";
      --lumo-icons-menu: "\\ea1d";
      --lumo-icons-minus: "\\ea1e";
      --lumo-icons-ordered-list: "\\ea1f";
      --lumo-icons-phone: "\\ea20";
      --lumo-icons-photo: "\\ea21";
      --lumo-icons-play: "\\ea22";
      --lumo-icons-plus: "\\ea23";
      --lumo-icons-redo: "\\ea24";
      --lumo-icons-reload: "\\ea25";
      --lumo-icons-search: "\\ea26";
      --lumo-icons-undo: "\\ea27";
      --lumo-icons-unordered-list: "\\ea28";
      --lumo-icons-upload: "\\ea29";
      --lumo-icons-user: "\\ea2a";
    }
  </style>
</custom-style>`,document.head.appendChild(bW.content);const wW=document.createElement("template");wW.innerHTML=`<custom-style>
  <style>
    html {
      --lumo-size-xs: 1.625rem;
      --lumo-size-s: 1.875rem;
      --lumo-size-m: 2.25rem;
      --lumo-size-l: 2.75rem;
      --lumo-size-xl: 3.5rem;

      /* Icons */
      --lumo-icon-size-s: 1.25em;
      --lumo-icon-size-m: 1.5em;
      --lumo-icon-size-l: 2.25em;
      /* For backwards compatibility */
      --lumo-icon-size: var(--lumo-icon-size-m);
    }
  </style>
</custom-style>`,document.head.appendChild(wW.content);const xW=document.createElement("template");xW.innerHTML=`<custom-style>
  <style>
    html {
      /* Square */
      --lumo-space-xs: 0.25rem;
      --lumo-space-s: 0.5rem;
      --lumo-space-m: 1rem;
      --lumo-space-l: 1.5rem;
      --lumo-space-xl: 2.5rem;

      /* Wide */
      --lumo-space-wide-xs: calc(var(--lumo-space-xs) / 2) var(--lumo-space-xs);
      --lumo-space-wide-s: calc(var(--lumo-space-s) / 2) var(--lumo-space-s);
      --lumo-space-wide-m: calc(var(--lumo-space-m) / 2) var(--lumo-space-m);
      --lumo-space-wide-l: calc(var(--lumo-space-l) / 2) var(--lumo-space-l);
      --lumo-space-wide-xl: calc(var(--lumo-space-xl) / 2) var(--lumo-space-xl);

      /* Tall */
      --lumo-space-tall-xs: var(--lumo-space-xs) calc(var(--lumo-space-xs) / 2);
      --lumo-space-tall-s: var(--lumo-space-s) calc(var(--lumo-space-s) / 2);
      --lumo-space-tall-m: var(--lumo-space-m) calc(var(--lumo-space-m) / 2);
      --lumo-space-tall-l: var(--lumo-space-l) calc(var(--lumo-space-l) / 2);
      --lumo-space-tall-xl: var(--lumo-space-xl) calc(var(--lumo-space-xl) / 2);
    }
  </style>
</custom-style>`,document.head.appendChild(xW.content);const SW=document.createElement("template");SW.innerHTML=`<custom-style>
  <style>
    html {
      /* Border radius */
      --lumo-border-radius-s: 0.25em; /* Checkbox, badge, date-picker year indicator, etc */
      --lumo-border-radius-m: var(--lumo-border-radius, 0.25em); /* Button, text field, menu overlay, etc */
      --lumo-border-radius-l: 0.5em; /* Dialog, notification, etc */
      --lumo-border-radius: 0.25em; /* Deprecated */

      /* Shadow */
      --lumo-box-shadow-xs: 0 1px 4px -1px var(--lumo-shade-50pct);
      --lumo-box-shadow-s: 0 2px 4px -1px var(--lumo-shade-20pct), 0 3px 12px -1px var(--lumo-shade-30pct);
      --lumo-box-shadow-m: 0 2px 6px -1px var(--lumo-shade-20pct), 0 8px 24px -4px var(--lumo-shade-40pct);
      --lumo-box-shadow-l: 0 3px 18px -2px var(--lumo-shade-20pct), 0 12px 48px -6px var(--lumo-shade-40pct);
      --lumo-box-shadow-xl: 0 4px 24px -3px var(--lumo-shade-20pct), 0 18px 64px -8px var(--lumo-shade-40pct);

      /* Clickable element cursor */
      --lumo-clickable-cursor: default;
    }
  </style>
</custom-style>`,document.head.appendChild(SW.content);const TW=document.createElement("template");TW.innerHTML=`<custom-style>
  <style>
    html {
      /* Font families */
      --lumo-font-family: -apple-system, BlinkMacSystemFont, "Roboto", "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";

      /* Font sizes */
      --lumo-font-size-xxs: .75rem;
      --lumo-font-size-xs: .8125rem;
      --lumo-font-size-s: .875rem;
      --lumo-font-size-m: 1rem;
      --lumo-font-size-l: 1.125rem;
      --lumo-font-size-xl: 1.375rem;
      --lumo-font-size-xxl: 1.75rem;
      --lumo-font-size-xxxl: 2.5rem;

      /* Line heights */
      --lumo-line-height-xs: 1.25;
      --lumo-line-height-s: 1.375;
      --lumo-line-height-m: 1.625;
    }

  </style>
</custom-style><dom-module id="lumo-typography">
  <template>
    <style>
      html {
        font-family: var(--lumo-font-family);
        font-size: var(--lumo-font-size, var(--lumo-font-size-m));
        line-height: var(--lumo-line-height-m);
        -webkit-text-size-adjust: 100%;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
      }

      /* Cant combine with the above selector because that doesnt work in browsers without native shadow dom */
      :host {
        font-family: var(--lumo-font-family);
        font-size: var(--lumo-font-size, var(--lumo-font-size-m));
        line-height: var(--lumo-line-height-m);
        -webkit-text-size-adjust: 100%;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
      }

      small,
      [theme~="font-size-s"] {
        font-size: var(--lumo-font-size-s);
        line-height: var(--lumo-line-height-s);
      }

      [theme~="font-size-xs"] {
        font-size: var(--lumo-font-size-xs);
        line-height: var(--lumo-line-height-xs);
      }

      h1,
      h2,
      h3,
      h4,
      h5,
      h6 {
        font-weight: 600;
        line-height: var(--lumo-line-height-xs);
        margin-top: 1.25em;
      }

      h1 {
        font-size: var(--lumo-font-size-xxxl);
        margin-bottom: 0.75em;
      }

      h2 {
        font-size: var(--lumo-font-size-xxl);
        margin-bottom: 0.5em;
      }

      h3 {
        font-size: var(--lumo-font-size-xl);
        margin-bottom: 0.5em;
      }

      h4 {
        font-size: var(--lumo-font-size-l);
        margin-bottom: 0.5em;
      }

      h5 {
        font-size: var(--lumo-font-size-m);
        margin-bottom: 0.25em;
      }

      h6 {
        font-size: var(--lumo-font-size-xs);
        margin-bottom: 0;
        text-transform: uppercase;
        letter-spacing: 0.03em;
      }

      p,
      blockquote {
        margin-top: 0.5em;
        margin-bottom: 0.75em;
      }

      a {
        text-decoration: none;
      }

      a:hover {
        text-decoration: underline;
      }

      hr {
        display: block;
        align-self: stretch;
        height: 1px;
        border: 0;
        padding: 0;
        margin: var(--lumo-space-s) calc(var(--lumo-border-radius-m) / 2);
        background-color: var(--lumo-contrast-10pct);
      }

      blockquote {
        border-left: 2px solid var(--lumo-contrast-30pct);
      }

      b,
      strong {
        font-weight: 600;
      }

      /* RTL specific styles */

      blockquote[dir="rtl"] {
        border-left: none;
        border-right: 2px solid var(--lumo-contrast-30pct);
      }

    </style>
  </template>
</dom-module>`,document.head.appendChild(TW.content);const IW=typeof window<"u"&&window.customElements!=null&&window.customElements.polyfillWrapFlushCallback!==void 0,p8=(t,e,i=null)=>{for(;e!==i;){const n=e.nextSibling;t.removeChild(e),e=n}},Zh=`{{lit-${String(Math.random()).slice(2)}}}`,tue=`<!--${Zh}-->`,CW=new RegExp(`${Zh}|${tue}`),ux="$lit$";let iue=class{constructor(e,i){this.parts=[],this.element=i;const n=[],r=[],s=document.createTreeWalker(i.content,133,null,!1);let o=0,a=-1,l=0;const{strings:c,values:{length:u}}=e;for(;l<u;){const d=s.nextNode();if(d!==null){if(a++,d.nodeType===1){if(d.hasAttributes()){const f=d.attributes,{length:m}=f;let g=0;for(let y=0;y<m;y++)MW(f[y].name,ux)&&g++;for(;g-- >0;){const y=c[l],_=lF.exec(y)[2],b=_.toLowerCase()+ux,w=d.getAttribute(b);d.removeAttribute(b);const x=w.split(CW);this.parts.push({type:"attribute",index:a,name:_,strings:x}),l+=x.length-1}}d.tagName==="TEMPLATE"&&(r.push(d),s.currentNode=d.content)}else if(d.nodeType===3){const f=d.data;if(f.indexOf(Zh)>=0){const m=d.parentNode,g=f.split(CW),y=g.length-1;for(let _=0;_<y;_++){let b,w=g[_];if(w==="")b=Yp();else{const x=lF.exec(w);x!==null&&MW(x[2],ux)&&(w=w.slice(0,x.index)+x[1]+x[2].slice(0,-ux.length)+x[3]),b=document.createTextNode(w)}m.insertBefore(b,d),this.parts.push({type:"node",index:++a})}g[y]===""?(m.insertBefore(Yp(),d),n.push(d)):d.data=g[y],l+=y}}else if(d.nodeType===8)if(d.data===Zh){const f=d.parentNode;d.previousSibling!==null&&a!==o||(a++,f.insertBefore(Yp(),d)),o=a,this.parts.push({type:"node",index:a}),d.nextSibling===null?d.data="":(n.push(d),a--),l++}else{let f=-1;for(;(f=d.data.indexOf(Zh,f+1))!==-1;)this.parts.push({type:"node",index:-1}),l++}}else s.currentNode=r.pop()}for(const d of n)d.parentNode.removeChild(d)}};const MW=(t,e)=>{const i=t.length-e.length;return i>=0&&t.slice(i)===e},nue=t=>t.index!==-1,Yp=()=>document.createComment(""),lF=/([ \x09\x0a\x0c\x0d])([^\0-\x1F\x7F-\x9F "'>=/]+)([ \x09\x0a\x0c\x0d]*=[ \x09\x0a\x0c\x0d]*(?:[^ \x09\x0a\x0c\x0d"'`<>=]*|"[^"]*|'[^']*))$/,f8=133;function rue(t,e){const{element:{content:i},parts:n}=t,r=document.createTreeWalker(i,f8,null,!1);let s=i2(n),o=n[s],a=-1,l=0;const c=[];let u=null;for(;r.nextNode();){a++;const d=r.currentNode;for(d.previousSibling===u&&(u=null),e.has(d)&&(c.push(d),u===null&&(u=d)),u!==null&&l++;o!==void 0&&o.index===a;)o.index=u!==null?-1:o.index-l,s=i2(n,s),o=n[s]}c.forEach(d=>d.parentNode.removeChild(d))}const yBe=t=>{let e=t.nodeType===11?0:1;const i=document.createTreeWalker(t,f8,null,!1);for(;i.nextNode();)e++;return e},i2=(t,e=-1)=>{for(let i=e+1;i<t.length;i++){const n=t[i];if(nue(n))return i}return-1};function vBe(t,e,i=null){const{element:{content:n},parts:r}=t;if(i==null)return void n.appendChild(e);const s=document.createTreeWalker(n,f8,null,!1);let o=i2(r),a=0,l=-1;for(;s.nextNode();)for(l++,s.currentNode===i&&(a=yBe(e),i.parentNode.insertBefore(e,i));o!==-1&&r[o].index===l;){if(a>0){for(;o!==-1;)r[o].index+=a,o=i2(r,o);return}o=i2(r,o)}}const _Be=new WeakMap,bBe=t=>typeof t=="function"&&_Be.has(t),EW={},AW={};let cF=class{constructor(e,i,n){this.__parts=[],this.template=e,this.processor=i,this.options=n}update(e){let i=0;for(const n of this.__parts)n!==void 0&&n.setValue(e[i]),i++;for(const n of this.__parts)n!==void 0&&n.commit()}_clone(){const e=IW?this.template.element.content.cloneNode(!0):document.importNode(this.template.element.content,!0),i=[],n=this.template.parts,r=document.createTreeWalker(e,133,null,!1);let s,o=0,a=0,l=r.nextNode();for(;o<n.length;)if(s=n[o],nue(s)){for(;a<s.index;)a++,l.nodeName==="TEMPLATE"&&(i.push(l),r.currentNode=l.content),(l=r.nextNode())===null&&(r.currentNode=i.pop(),l=r.nextNode());if(s.type==="node"){const c=this.processor.handleTextExpression(this.options);c.insertAfterNode(l.previousSibling),this.__parts.push(c)}else this.__parts.push(...this.processor.handleAttributeExpressions(l,s.name,s.strings,this.options));o++}else this.__parts.push(void 0),o++;return IW&&(document.adoptNode(e),customElements.upgrade(e)),e}};const $W=window.trustedTypes&&trustedTypes.createPolicy("lit-html",{createHTML:t=>t}),wBe=` ${Zh} `;let xBe=class{constructor(e,i,n,r){this.strings=e,this.values=i,this.type=n,this.processor=r}getHTML(){const e=this.strings.length-1;let i="",n=!1;for(let r=0;r<e;r++){const s=this.strings[r],o=s.lastIndexOf("<!--");n=(o>-1||n)&&s.indexOf("-->",o+1)===-1;const a=lF.exec(s);i+=a===null?s+(n?wBe:tue):s.substr(0,a.index)+a[1]+a[2]+ux+a[3]+Zh}return i+=this.strings[e],i}getTemplateElement(){const e=document.createElement("template");let i=this.getHTML();return $W!==void 0&&(i=$W.createHTML(i)),e.innerHTML=i,e}};const SBe=t=>t===null||!(typeof t=="object"||typeof t=="function"),TBe=t=>Array.isArray(t)||!(!t||!t[Symbol.iterator]);class m8{constructor(e){this.value=void 0,this.__pendingValue=void 0,this.options=e}appendInto(e){this.startNode=e.appendChild(Yp()),this.endNode=e.appendChild(Yp())}insertAfterNode(e){this.startNode=e,this.endNode=e.nextSibling}appendIntoPart(e){e.__insert(this.startNode=Yp()),e.__insert(this.endNode=Yp())}insertAfterPart(e){e.__insert(this.startNode=Yp()),this.endNode=e.endNode,e.endNode=this.startNode}setValue(e){this.__pendingValue=e}commit(){if(this.startNode.parentNode===null)return;for(;bBe(this.__pendingValue);){const i=this.__pendingValue;this.__pendingValue=EW,i(this)}const e=this.__pendingValue;e!==EW&&(SBe(e)?e!==this.value&&this.__commitText(e):e instanceof xBe?this.__commitTemplateResult(e):e instanceof Node?this.__commitNode(e):TBe(e)?this.__commitIterable(e):e===AW?(this.value=AW,this.clear()):this.__commitText(e))}__insert(e){this.endNode.parentNode.insertBefore(e,this.endNode)}__commitNode(e){this.value!==e&&(this.clear(),this.__insert(e),this.value=e)}__commitText(e){const i=this.startNode.nextSibling,n=typeof(e=e??"")=="string"?e:String(e);i===this.endNode.previousSibling&&i.nodeType===3?i.data=n:this.__commitNode(document.createTextNode(n)),this.value=e}__commitTemplateResult(e){const i=this.options.templateFactory(e);if(this.value instanceof cF&&this.value.template===i)this.value.update(e.values);else{const n=new cF(i,e.processor,this.options),r=n._clone();n.update(e.values),this.__commitNode(r),this.value=n}}__commitIterable(e){Array.isArray(this.value)||(this.value=[],this.clear());const i=this.value;let n,r=0;for(const s of e)n=i[r],n===void 0&&(n=new m8(this.options),i.push(n),r===0?n.appendIntoPart(this):n.insertAfterPart(i[r-1])),n.setValue(s),n.commit(),r++;r<i.length&&(i.length=r,this.clear(n&&n.endNode))}clear(e=this.startNode){p8(this.startNode.parentNode,e.nextSibling,this.endNode)}}let IBe=!1;function CBe(t){let e=aS.get(t.type);e===void 0&&(e={stringsArray:new WeakMap,keyString:new Map},aS.set(t.type,e));let i=e.stringsArray.get(t.strings);if(i!==void 0)return i;const n=t.strings.join(Zh);return i=e.keyString.get(n),i===void 0&&(i=new iue(t,t.getTemplateElement()),e.keyString.set(n,i)),e.stringsArray.set(t.strings,i),i}(()=>{try{const t={get capture(){return IBe=!0,!1}};window.addEventListener("test",t,t),window.removeEventListener("test",t,t)}catch{}})();const aS=new Map,m_=new WeakMap,MBe=(t,e,i)=>{let n=m_.get(e);n===void 0&&(p8(e,e.firstChild),m_.set(e,n=new m8(Object.assign({templateFactory:CBe},i))),n.appendInto(e)),n.setValue(t),n.commit()};typeof window<"u"&&(window.litHtmlVersions||(window.litHtmlVersions=[])).push("1.4.1");const sue=(t,e)=>`${t}--${e}`;let r$=!0;window.ShadyCSS===void 0?r$=!1:window.ShadyCSS.prepareTemplateDom===void 0&&(console.warn("Incompatible ShadyCSS version detected. Please update to at least @webcomponents/webcomponentsjs@2.0.2 and @webcomponents/shadycss@1.3.1."),r$=!1);const EBe=t=>e=>{const i=sue(e.type,t);let n=aS.get(i);n===void 0&&(n={stringsArray:new WeakMap,keyString:new Map},aS.set(i,n));let r=n.stringsArray.get(e.strings);if(r!==void 0)return r;const s=e.strings.join(Zh);if(r=n.keyString.get(s),r===void 0){const o=e.getTemplateElement();r$&&window.ShadyCSS.prepareTemplateDom(o,t),r=new iue(e,o),n.keyString.set(s,r)}return n.stringsArray.set(e.strings,r),r},ABe=["html","svg"],$Be=t=>{ABe.forEach(e=>{const i=aS.get(sue(e,t));i!==void 0&&i.keyString.forEach(n=>{const{element:{content:r}}=n,s=new Set;Array.from(r.querySelectorAll("style")).forEach(o=>{s.add(o)}),rue(n,s)})})},oue=new Set,PBe=(t,e,i)=>{oue.add(t);const n=i?i.element:document.createElement("template"),r=e.querySelectorAll("style"),{length:s}=r;if(s===0)return void window.ShadyCSS.prepareTemplateStyles(n,t);const o=document.createElement("style");for(let c=0;c<s;c++){const u=r[c];u.parentNode.removeChild(u),o.textContent+=u.textContent}$Be(t);const a=n.content;i?vBe(i,o,a.firstChild):a.insertBefore(o,a.firstChild),window.ShadyCSS.prepareTemplateStyles(n,t);const l=a.querySelector("style");if(window.ShadyCSS.nativeShadow&&l!==null)e.insertBefore(l.cloneNode(!0),e.firstChild);else if(i){a.insertBefore(o,a.firstChild);const c=new Set;c.add(o),rue(i,c)}},kBe=(t,e,i)=>{if(!i||typeof i!="object"||!i.scopeName)throw new Error("The `scopeName` option is required.");const n=i.scopeName,r=m_.has(e),s=r$&&e.nodeType===11&&!!e.host,o=s&&!oue.has(n),a=o?document.createDocumentFragment():e;if(MBe(t,a,Object.assign({templateFactory:EBe(n)},i)),o){const l=m_.get(a);m_.delete(a);const c=l.value instanceof cF?l.value.template:void 0;PBe(n,a,c),p8(e,e.firstChild),e.appendChild(a),m_.set(e,l)}!r&&s&&window.ShadyCSS.styleElement(e.host)};window.JSCompiler_renameProperty=(t,e)=>t;const uF={toAttribute(t,e){switch(e){case Boolean:return t?"":null;case Object:case Array:return t==null?t:JSON.stringify(t)}return t},fromAttribute(t,e){switch(e){case Boolean:return t!==null;case Number:return t===null?null:Number(t);case Object:case Array:return JSON.parse(t)}return t}},aue=(t,e)=>e!==t&&(e==e||t==t),jO={attribute:!0,type:String,converter:uF,reflect:!1,hasChanged:aue},BO=1,UO=4,GO=8,HO=16,hF="finalized";class lue extends HTMLElement{constructor(){super(),this.initialize()}static get observedAttributes(){this.finalize();const e=[];return this._classProperties.forEach((i,n)=>{const r=this._attributeNameForProperty(n,i);r!==void 0&&(this._attributeToPropertyMap.set(r,n),e.push(r))}),e}static _ensureClassProperties(){if(!this.hasOwnProperty(JSCompiler_renameProperty("_classProperties",this))){this._classProperties=new Map;const e=Object.getPrototypeOf(this)._classProperties;e!==void 0&&e.forEach((i,n)=>this._classProperties.set(n,i))}}static createProperty(e,i=jO){if(this._ensureClassProperties(),this._classProperties.set(e,i),i.noAccessor||this.prototype.hasOwnProperty(e))return;const n=typeof e=="symbol"?Symbol():`__${e}`,r=this.getPropertyDescriptor(e,n,i);r!==void 0&&Object.defineProperty(this.prototype,e,r)}static getPropertyDescriptor(e,i,n){return{get(){return this[i]},set(r){const s=this[e];this[i]=r,this.requestUpdateInternal(e,s,n)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this._classProperties&&this._classProperties.get(e)||jO}static finalize(){const e=Object.getPrototypeOf(this);if(e.hasOwnProperty(hF)||e.finalize(),this[hF]=!0,this._ensureClassProperties(),this._attributeToPropertyMap=new Map,this.hasOwnProperty(JSCompiler_renameProperty("properties",this))){const i=this.properties,n=[...Object.getOwnPropertyNames(i),...typeof Object.getOwnPropertySymbols=="function"?Object.getOwnPropertySymbols(i):[]];for(const r of n)this.createProperty(r,i[r])}}static _attributeNameForProperty(e,i){const n=i.attribute;return n===!1?void 0:typeof n=="string"?n:typeof e=="string"?e.toLowerCase():void 0}static _valueHasChanged(e,i,n=aue){return n(e,i)}static _propertyValueFromAttribute(e,i){const n=i.type,r=i.converter||uF,s=typeof r=="function"?r:r.fromAttribute;return s?s(e,n):e}static _propertyValueToAttribute(e,i){if(i.reflect===void 0)return;const n=i.type,r=i.converter;return(r&&r.toAttribute||uF.toAttribute)(e,n)}initialize(){this._updateState=0,this._updatePromise=new Promise(e=>this._enableUpdatingResolver=e),this._changedProperties=new Map,this._saveInstanceProperties(),this.requestUpdateInternal()}_saveInstanceProperties(){this.constructor._classProperties.forEach((e,i)=>{if(this.hasOwnProperty(i)){const n=this[i];delete this[i],this._instanceProperties||(this._instanceProperties=new Map),this._instanceProperties.set(i,n)}})}_applyInstanceProperties(){this._instanceProperties.forEach((e,i)=>this[i]=e),this._instanceProperties=void 0}connectedCallback(){this.enableUpdating()}enableUpdating(){this._enableUpdatingResolver!==void 0&&(this._enableUpdatingResolver(),this._enableUpdatingResolver=void 0)}disconnectedCallback(){}attributeChangedCallback(e,i,n){i!==n&&this._attributeToProperty(e,n)}_propertyToAttribute(e,i,n=jO){const r=this.constructor,s=r._attributeNameForProperty(e,n);if(s!==void 0){const o=r._propertyValueToAttribute(i,n);if(o===void 0)return;this._updateState=this._updateState|GO,o==null?this.removeAttribute(s):this.setAttribute(s,o),this._updateState=this._updateState&~GO}}_attributeToProperty(e,i){if(this._updateState&GO)return;const n=this.constructor,r=n._attributeToPropertyMap.get(e);if(r!==void 0){const s=n.getPropertyOptions(r);this._updateState=this._updateState|HO,this[r]=n._propertyValueFromAttribute(i,s),this._updateState=this._updateState&~HO}}requestUpdateInternal(e,i,n){let r=!0;if(e!==void 0){const s=this.constructor;n=n||s.getPropertyOptions(e),s._valueHasChanged(this[e],i,n.hasChanged)?(this._changedProperties.has(e)||this._changedProperties.set(e,i),n.reflect!==!0||this._updateState&HO||(this._reflectingProperties===void 0&&(this._reflectingProperties=new Map),this._reflectingProperties.set(e,n))):r=!1}!this._hasRequestedUpdate&&r&&(this._updatePromise=this._enqueueUpdate())}requestUpdate(e,i){return this.requestUpdateInternal(e,i),this.updateComplete}async _enqueueUpdate(){this._updateState=this._updateState|UO;try{await this._updatePromise}catch{}const e=this.performUpdate();return e!=null&&await e,!this._hasRequestedUpdate}get _hasRequestedUpdate(){return this._updateState&UO}get hasUpdated(){return this._updateState&BO}performUpdate(){if(!this._hasRequestedUpdate)return;this._instanceProperties&&this._applyInstanceProperties();let e=!1;const i=this._changedProperties;try{e=this.shouldUpdate(i),e?this.update(i):this._markUpdated()}catch(n){throw e=!1,this._markUpdated(),n}e&&(this._updateState&BO||(this._updateState=this._updateState|BO,this.firstUpdated(i)),this.updated(i))}_markUpdated(){this._changedProperties=new Map,this._updateState=this._updateState&~UO}get updateComplete(){return this._getUpdateComplete()}_getUpdateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._updatePromise}shouldUpdate(e){return!0}update(e){this._reflectingProperties!==void 0&&this._reflectingProperties.size>0&&(this._reflectingProperties.forEach((i,n)=>this._propertyToAttribute(n,this[n],i)),this._reflectingProperties=void 0),this._markUpdated()}updated(e){}firstUpdated(e){}}lue[hF]=!0;const dF=window.ShadowRoot&&(window.ShadyCSS===void 0||window.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,g8=Symbol();class hk{constructor(e,i){if(i!==g8)throw new Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e}get styleSheet(){return this._styleSheet===void 0&&(dF?(this._styleSheet=new CSSStyleSheet,this._styleSheet.replaceSync(this.cssText)):this._styleSheet=null),this._styleSheet}toString(){return this.cssText}}const OBe=t=>new hk(String(t),g8),LBe=t=>{if(t instanceof hk)return t.cssText;if(typeof t=="number")return t;throw new Error(`Value passed to 'css' function must be a 'css' function result: ${t}. Use 'unsafeCSS' to pass non-literal values, but
            take care to ensure page security.`)},lS=(t,...e)=>{const i=e.reduce((n,r,s)=>n+LBe(r)+t[s+1],t[0]);return new hk(i,g8)};(window.litElementVersions||(window.litElementVersions=[])).push("2.5.1");const PW={};class qO extends lue{static getStyles(){return this.styles}static _getUniqueStyles(){if(this.hasOwnProperty(JSCompiler_renameProperty("_styles",this)))return;const e=this.getStyles();if(Array.isArray(e)){const i=(s,o)=>s.reduceRight((a,l)=>Array.isArray(l)?i(l,a):(a.add(l),a),o),n=i(e,new Set),r=[];n.forEach(s=>r.unshift(s)),this._styles=r}else this._styles=e===void 0?[]:[e];this._styles=this._styles.map(i=>{if(i instanceof CSSStyleSheet&&!dF){const n=Array.prototype.slice.call(i.cssRules).reduce((r,s)=>r+s.cssText,"");return OBe(n)}return i})}initialize(){super.initialize(),this.constructor._getUniqueStyles(),this.renderRoot=this.createRenderRoot(),window.ShadowRoot&&this.renderRoot instanceof window.ShadowRoot&&this.adoptStyles()}createRenderRoot(){return this.attachShadow(this.constructor.shadowRootOptions)}adoptStyles(){const e=this.constructor._styles;e.length!==0&&(window.ShadyCSS===void 0||window.ShadyCSS.nativeShadow?dF?this.renderRoot.adoptedStyleSheets=e.map(i=>i instanceof CSSStyleSheet?i:i.styleSheet):this._needsShimAdoptedStyleSheets=!0:window.ShadyCSS.ScopingShim.prepareAdoptedCssText(e.map(i=>i.cssText),this.localName))}connectedCallback(){super.connectedCallback(),this.hasUpdated&&window.ShadyCSS!==void 0&&window.ShadyCSS.styleElement(this)}update(e){const i=this.render();super.update(e),i!==PW&&this.constructor.render(i,this.renderRoot,{scopeName:this.localName,eventContext:this}),this._needsShimAdoptedStyleSheets&&(this._needsShimAdoptedStyleSheets=!1,this.constructor._styles.forEach(n=>{const r=document.createElement("style");r.textContent=n.cssText,this.renderRoot.appendChild(r)}))}render(){return PW}}qO.finalized=!0,qO.render=kBe,qO.shadowRootOptions={mode:"open"};let kW=0;const WO={},cS=(t,e,i)=>{const n=i&&i.moduleId||"custom-style-module-"+kW++;Array.isArray(e)||(e=e?[e]:[]),e.forEach(o=>{if(!(o instanceof hk))throw new Error("An item in styles is not of type CSSResult. Use `unsafeCSS` or `css`.");if(!WO[o]){const a=document.createElement("dom-module");a.innerHTML=`
        <template>
          <style>${o.toString()}</style>
        </template>
      `;const l="custom-style-module-"+kW++;a.register(l),WO[o]=l}});const r=document.createElement("dom-module");if(t){const o=window.customElements&&window.customElements.get(t);o&&o.hasOwnProperty("__finalized")&&console.warn(`The custom element definition for "${t}"
      was finalized before a style module was registered.
      Make sure to add component specific style modules before
      importing the corresponding custom element.`),r.setAttribute("theme-for",t)}const s=i&&i.include||[];r.innerHTML=`
    <template>
      ${s.map(o=>`<style include=${o}></style>`)}
      ${e.map(o=>`<style include=${WO[o]}></style>`)}
    </template>
  `,r.register(n)};cS("vaadin-checkbox",lS`
    :host {
      -webkit-tap-highlight-color: transparent;
      -webkit-user-select: none;
      -moz-user-select: none;
      user-select: none;
      cursor: default;
      outline: none;
    }

    [part='label']:not([empty]) {
      margin: 0.1875em 0.875em 0.1875em 0.375em;
    }

    [part='checkbox'] {
      width: calc(1em + 2px);
      height: calc(1em + 2px);
      margin: 0.1875em;
      position: relative;
      border-radius: var(--lumo-border-radius-s);
      background-color: var(--lumo-contrast-20pct);
      transition: transform 0.2s cubic-bezier(0.12, 0.32, 0.54, 2), background-color 0.15s;
      pointer-events: none;
      line-height: 1.2;
    }

    :host([indeterminate]) [part='checkbox'],
    :host([checked]) [part='checkbox'] {
      background-color: var(--lumo-primary-color);
    }

    /* Needed to align the checkbox nicely on the baseline */
    [part='checkbox']::before {
      content: '\\2003';
    }

    /* Checkmark */
    [part='checkbox']::after {
      content: '';
      display: inline-block;
      width: 0;
      height: 0;
      border: 0 solid var(--lumo-primary-contrast-color);
      border-width: 0.1875em 0 0 0.1875em;
      box-sizing: border-box;
      transform-origin: 0 0;
      position: absolute;
      top: 0.8125em;
      left: 0.5em;
      transform: scale(0.55) rotate(-135deg);
      opacity: 0;
    }

    :host([checked]) [part='checkbox']::after {
      opacity: 1;
      width: 0.625em;
      height: 1.0625em;
    }

    /* Indeterminate checkmark */
    :host([indeterminate]) [part='checkbox']::after {
      transform: none;
      opacity: 1;
      top: 45%;
      height: 10%;
      left: 22%;
      right: 22%;
      width: auto;
      border: 0;
      background-color: var(--lumo-primary-contrast-color);
      transition: opacity 0.25s;
    }

    /* Focus ring */
    :host([focus-ring]) [part='checkbox'] {
      box-shadow: 0 0 0 3px var(--lumo-primary-color-50pct);
    }

    /* Disabled */
    :host([disabled]) {
      pointer-events: none;
      color: var(--lumo-disabled-text-color);
    }

    :host([disabled]) [part='label'] ::slotted(*) {
      color: inherit;
    }

    :host([disabled]) [part='checkbox'] {
      background-color: var(--lumo-contrast-10pct);
    }

    :host([disabled]) [part='checkbox']::after {
      border-color: var(--lumo-contrast-30pct);
    }

    :host([indeterminate][disabled]) [part='checkbox']::after {
      background-color: var(--lumo-contrast-30pct);
    }

    /* RTL specific styles */
    :host([dir='rtl']) [part='label']:not([empty]) {
      margin: 0.1875em 0.375em 0.1875em 0.875em;
    }

    /* Transition the checkmark if activated with the mouse (disabled for grid select-all this way) */
    :host(:hover) [part='checkbox']::after {
      transition: width 0.1s, height 0.25s;
    }

    /* Used for activation "halo" */
    [part='checkbox']::before {
      color: transparent;
      display: inline-block;
      width: 100%;
      height: 100%;
      border-radius: inherit;
      background-color: inherit;
      transform: scale(1.4);
      opacity: 0;
      transition: transform 0.1s, opacity 0.8s;
    }

    /* Hover */
    :host(:not([checked]):not([indeterminate]):not([disabled]):hover) [part='checkbox'] {
      background-color: var(--lumo-contrast-30pct);
    }

    /* Disable hover for touch devices */
    @media (pointer: coarse) {
      :host(:not([checked]):not([indeterminate]):not([disabled]):hover) [part='checkbox'] {
        background-color: var(--lumo-contrast-20pct);
      }
    }

    /* Active */
    :host([active]) [part='checkbox'] {
      transform: scale(0.9);
      transition-duration: 0.05s;
    }

    :host([active][checked]) [part='checkbox'] {
      transform: scale(1.1);
    }

    :host([active]:not([checked])) [part='checkbox']::before {
      transition-duration: 0.01s, 0.01s;
      transform: scale(0);
      opacity: 0.4;
    }
  `,{moduleId:"lumo-checkbox"});let RBe=0;const Sa=function(t){let e=t.__mixinApplications;e||(e=new WeakMap,t.__mixinApplications=e);let i=RBe++;function n(r){let s=r.__mixinSet;if(s&&s[i])return r;let o=e,a=o.get(r);if(!a){a=t(r),o.set(r,a);let l=Object.create(a.__mixinSet||s||null);l[i]=!0,a.__mixinSet=l}return a}return n},De=window.ShadyDOM&&window.ShadyDOM.noPatch&&window.ShadyDOM.wrap?window.ShadyDOM.wrap:window.ShadyDOM?t=>ShadyDOM.patch(t):t=>t;function pF(t){return t.indexOf(".")>=0}function vd(t){let e=t.indexOf(".");return e===-1?t:t.slice(0,e)}function cue(t,e){return t.indexOf(e+".")===0}function uS(t,e){return e.indexOf(t+".")===0}function hS(t,e,i){return e+i.slice(t.length)}function DBe(t,e){return t===e||cue(t,e)||uS(t,e)}function hx(t){if(Array.isArray(t)){let e=[];for(let i=0;i<t.length;i++){let n=t[i].toString().split(".");for(let r=0;r<n.length;r++)e.push(n[r])}return e.join(".")}return t}function uue(t){return Array.isArray(t)?hx(t).split("."):t.toString().split(".")}function Ks(t,e,i){let n=t,r=uue(e);for(let s=0;s<r.length;s++){if(!n)return;n=n[r[s]]}return i&&(i.path=r.join(".")),n}function OW(t,e,i){let n=t,r=uue(e),s=r[r.length-1];if(r.length>1){for(let o=0;o<r.length-1;o++)if(n=n[r[o]],!n)return;n[s]=i}else n[e]=i;return r.join(".")}const s$={},NBe=/-[a-z]/g,FBe=/([A-Z])/g;function hue(t){return s$[t]||(s$[t]=t.indexOf("-")<0?t:t.replace(NBe,e=>e[1].toUpperCase()))}function dk(t){return s$[t]||(s$[t]=t.replace(FBe,"-$1").toLowerCase())}let zBe=0,due=0,z_=[],VBe=0,fF=!1,pue=document.createTextNode("");function jBe(){fF=!1;const t=z_.length;for(let e=0;e<t;e++){let i=z_[e];if(i)try{i()}catch(n){setTimeout(()=>{throw n})}}z_.splice(0,t),due+=t}new window.MutationObserver(jBe).observe(pue,{characterData:!0});const _c={after:t=>({run:e=>window.setTimeout(e,t),cancel(e){window.clearTimeout(e)}}),run:(t,e)=>window.setTimeout(t,e),cancel(t){window.clearTimeout(t)}},Yh={run:t=>window.requestAnimationFrame(t),cancel(t){window.cancelAnimationFrame(t)}},fue={run:t=>window.requestIdleCallback?window.requestIdleCallback(t):window.setTimeout(t,16),cancel(t){window.cancelIdleCallback?window.cancelIdleCallback(t):window.clearTimeout(t)}},ul={run:t=>(fF||(fF=!0,pue.textContent=VBe++),z_.push(t),zBe++),cancel(t){const e=t-due;if(e>=0){if(!z_[e])throw new Error("invalid async handle: "+t);z_[e]=null}}},BBe=ul,mue=Sa(t=>{class e extends t{static createProperties(n){const r=this.prototype;for(let s in n)s in r||r._createPropertyAccessor(s)}static attributeNameForProperty(n){return n.toLowerCase()}static typeForProperty(n){}_createPropertyAccessor(n,r){this._addPropertyToAttributeMap(n),this.hasOwnProperty(JSCompiler_renameProperty("__dataHasAccessor",this))||(this.__dataHasAccessor=Object.assign({},this.__dataHasAccessor)),this.__dataHasAccessor[n]||(this.__dataHasAccessor[n]=!0,this._definePropertyAccessor(n,r))}_addPropertyToAttributeMap(n){this.hasOwnProperty(JSCompiler_renameProperty("__dataAttributes",this))||(this.__dataAttributes=Object.assign({},this.__dataAttributes));let r=this.__dataAttributes[n];return r||(r=this.constructor.attributeNameForProperty(n),this.__dataAttributes[r]=n),r}_definePropertyAccessor(n,r){Object.defineProperty(this,n,{get(){return this.__data[n]},set:r?function(){}:function(s){this._setPendingProperty(n,s,!0)&&this._invalidateProperties()}})}constructor(){super(),this.__dataEnabled=!1,this.__dataReady=!1,this.__dataInvalid=!1,this.__data={},this.__dataPending=null,this.__dataOld=null,this.__dataInstanceProps=null,this.__dataCounter=0,this.__serializing=!1,this._initializeProperties()}ready(){this.__dataReady=!0,this._flushProperties()}_initializeProperties(){for(let n in this.__dataHasAccessor)this.hasOwnProperty(n)&&(this.__dataInstanceProps=this.__dataInstanceProps||{},this.__dataInstanceProps[n]=this[n],delete this[n])}_initializeInstanceProperties(n){Object.assign(this,n)}_setProperty(n,r){this._setPendingProperty(n,r)&&this._invalidateProperties()}_getProperty(n){return this.__data[n]}_setPendingProperty(n,r,s){let o=this.__data[n],a=this._shouldPropertyChange(n,r,o);return a&&(this.__dataPending||(this.__dataPending={},this.__dataOld={}),this.__dataOld&&!(n in this.__dataOld)&&(this.__dataOld[n]=o),this.__data[n]=r,this.__dataPending[n]=r),a}_isPropertyPending(n){return!(!this.__dataPending||!this.__dataPending.hasOwnProperty(n))}_invalidateProperties(){!this.__dataInvalid&&this.__dataReady&&(this.__dataInvalid=!0,BBe.run(()=>{this.__dataInvalid&&(this.__dataInvalid=!1,this._flushProperties())}))}_enableProperties(){this.__dataEnabled||(this.__dataEnabled=!0,this.__dataInstanceProps&&(this._initializeInstanceProperties(this.__dataInstanceProps),this.__dataInstanceProps=null),this.ready())}_flushProperties(){this.__dataCounter++;const n=this.__data,r=this.__dataPending,s=this.__dataOld;this._shouldPropertiesChange(n,r,s)&&(this.__dataPending=null,this.__dataOld=null,this._propertiesChanged(n,r,s)),this.__dataCounter--}_shouldPropertiesChange(n,r,s){return!!r}_propertiesChanged(n,r,s){}_shouldPropertyChange(n,r,s){return s!==r&&(s==s||r==r)}attributeChangedCallback(n,r,s,o){r!==s&&this._attributeToProperty(n,s),super.attributeChangedCallback&&super.attributeChangedCallback(n,r,s,o)}_attributeToProperty(n,r,s){if(!this.__serializing){const o=this.__dataAttributes,a=o&&o[n]||n;this[a]=this._deserializeValue(r,s||this.constructor.typeForProperty(a))}}_propertyToAttribute(n,r,s){this.__serializing=!0,s=arguments.length<3?this[n]:s,this._valueToNodeAttribute(this,s,r||this.constructor.attributeNameForProperty(n)),this.__serializing=!1}_valueToNodeAttribute(n,r,s){const o=this._serializeValue(r);s!=="class"&&s!=="name"&&s!=="slot"||(n=De(n)),o===void 0?n.removeAttribute(s):n.setAttribute(s,o)}_serializeValue(n){return typeof n=="boolean"?n?"":void 0:n!=null?n.toString():void 0}_deserializeValue(n,r){switch(r){case Boolean:return n!==null;case Number:return Number(n);default:return n}}}return e}),gue={};let ZI=HTMLElement.prototype;for(;ZI;){let t=Object.getOwnPropertyNames(ZI);for(let e=0;e<t.length;e++)gue[t[e]]=!0;ZI=Object.getPrototypeOf(ZI)}function UBe(t,e){if(!gue[e]){let i=t[e];i!==void 0&&(t.__data?t._setPendingProperty(e,i):(t.__dataProto?t.hasOwnProperty(JSCompiler_renameProperty("__dataProto",t))||(t.__dataProto=Object.create(t.__dataProto)):t.__dataProto={},t.__dataProto[e]=i))}}const yue=Sa(t=>{const e=mue(t);class i extends e{static createPropertiesForAttributes(){let r=this.observedAttributes;for(let s=0;s<r.length;s++)this.prototype._createPropertyAccessor(hue(r[s]))}static attributeNameForProperty(r){return dk(r)}_initializeProperties(){this.__dataProto&&(this._initializeProtoProperties(this.__dataProto),this.__dataProto=null),super._initializeProperties()}_initializeProtoProperties(r){for(let s in r)this._setProperty(s,r[s])}_ensureAttribute(r,s){const o=this;o.hasAttribute(r)||this._valueToNodeAttribute(o,s,r)}_serializeValue(r){if(typeof r=="object"){if(r instanceof Date)return r.toString();if(r)try{return JSON.stringify(r)}catch{return""}}return super._serializeValue(r)}_deserializeValue(r,s){let o;switch(s){case Object:try{o=JSON.parse(r)}catch{o=r}break;case Array:try{o=JSON.parse(r)}catch{o=null,console.warn(`Polymer::Attributes: couldn't decode Array as JSON: ${r}`)}break;case Date:o=isNaN(r)?String(r):Number(r),o=new Date(o);break;default:o=super._deserializeValue(r,s)}return o}_definePropertyAccessor(r,s){UBe(this,r),super._definePropertyAccessor(r,s)}_hasAccessor(r){return this.__dataHasAccessor&&this.__dataHasAccessor[r]}_isPropertyPending(r){return!!(this.__dataPending&&r in this.__dataPending)}}return i}),GBe={"dom-if":!0,"dom-repeat":!0};let LW=!1,RW=!1;function HBe(){if(!LW){LW=!0;const t=document.createElement("textarea");t.placeholder="a",RW=t.placeholder===t.textContent}return RW}function qBe(t){HBe()&&t.localName==="textarea"&&t.placeholder&&t.placeholder===t.textContent&&(t.textContent=null)}function WBe(t){let e=t.getAttribute("is");if(e&&GBe[e]){let i=t;for(i.removeAttribute("is"),t=i.ownerDocument.createElement(e),i.parentNode.replaceChild(t,i),t.appendChild(i);i.attributes.length;)t.setAttribute(i.attributes[0].name,i.attributes[0].value),i.removeAttribute(i.attributes[0].name)}return t}function vue(t,e){let i=e.parentInfo&&vue(t,e.parentInfo);if(!i)return t;for(let n=i.firstChild,r=0;n;n=n.nextSibling)if(e.parentIndex===r++)return n}function JBe(t,e,i,n){n.id&&(e[n.id]=i)}function ZBe(t,e,i){if(i.events&&i.events.length)for(let n,r=0,s=i.events;r<s.length&&(n=s[r]);r++)t._addMethodEventListenerToNode(e,n.name,n.value,t)}function YBe(t,e,i,n){i.templateInfo&&(e._templateInfo=i.templateInfo,e._parentTemplateInfo=n)}function XBe(t,e,i){return t=t._methodHost||t,function(n){t[i]?t[i](n,n.detail):console.warn("listener method `"+i+"` not defined")}}const KBe=Sa(t=>{class e extends t{static _parseTemplate(n,r){if(!n._templateInfo){let s=n._templateInfo={};s.nodeInfoList=[],s.nestedTemplate=!!r,s.stripWhiteSpace=r&&r.stripWhiteSpace||n.hasAttribute("strip-whitespace"),this._parseTemplateContent(n,s,{parent:null})}return n._templateInfo}static _parseTemplateContent(n,r,s){return this._parseTemplateNode(n.content,r,s)}static _parseTemplateNode(n,r,s){let o=!1,a=n;return a.localName!="template"||a.hasAttribute("preserve-content")?a.localName==="slot"&&(r.hasInsertionPoint=!0):o=this._parseTemplateNestedTemplate(a,r,s)||o,qBe(a),a.firstChild&&this._parseTemplateChildNodes(a,r,s),a.hasAttributes&&a.hasAttributes()&&(o=this._parseTemplateNodeAttributes(a,r,s)||o),o||s.noted}static _parseTemplateChildNodes(n,r,s){if(n.localName!=="script"&&n.localName!=="style")for(let o,a=n.firstChild,l=0;a;a=o){if(a.localName=="template"&&(a=WBe(a)),o=a.nextSibling,a.nodeType===Node.TEXT_NODE){let u=o;for(;u&&u.nodeType===Node.TEXT_NODE;)a.textContent+=u.textContent,o=u.nextSibling,n.removeChild(u),u=o;if(r.stripWhiteSpace&&!a.textContent.trim()){n.removeChild(a);continue}}let c={parentIndex:l,parentInfo:s};this._parseTemplateNode(a,r,c)&&(c.infoIndex=r.nodeInfoList.push(c)-1),a.parentNode&&l++}}static _parseTemplateNestedTemplate(n,r,s){let o=n,a=this._parseTemplate(o,r);return(a.content=o.content.ownerDocument.createDocumentFragment()).appendChild(o.content),s.templateInfo=a,!0}static _parseTemplateNodeAttributes(n,r,s){let o=!1,a=Array.from(n.attributes);for(let l,c=a.length-1;l=a[c];c--)o=this._parseTemplateNodeAttribute(n,r,s,l.name,l.value)||o;return o}static _parseTemplateNodeAttribute(n,r,s,o,a){return o.slice(0,3)==="on-"?(n.removeAttribute(o),s.events=s.events||[],s.events.push({name:o.slice(3),value:a}),!0):o==="id"&&(s.id=a,!0)}static _contentForTemplate(n){let r=n._templateInfo;return r&&r.content||n.content}_stampTemplate(n,r){n&&!n.content&&window.HTMLTemplateElement&&HTMLTemplateElement.decorate&&HTMLTemplateElement.decorate(n);let s=(r=r||this.constructor._parseTemplate(n)).nodeInfoList,o=r.content||n.content,a=document.importNode(o,!0);a.__noInsertionPoint=!r.hasInsertionPoint;let l=a.nodeList=new Array(s.length);a.$={};for(let c,u=0,d=s.length;u<d&&(c=s[u]);u++){let f=l[u]=vue(a,c);JBe(this,a.$,f,c),YBe(this,f,c,r),ZBe(this,f,c)}return a}_addMethodEventListenerToNode(n,r,s,o){let a=XBe(o=o||n,r,s);return this._addEventListenerToNode(n,r,a),a}_addEventListenerToNode(n,r,s){n.addEventListener(r,s)}_removeEventListenerFromNode(n,r,s){n.removeEventListener(r,s)}}return e});let dS=0;const pS=[],Jt={COMPUTE:"__computeEffects",REFLECT:"__reflectEffects",NOTIFY:"__notifyEffects",PROPAGATE:"__propagateEffects",OBSERVE:"__observeEffects",READ_ONLY:"__readOnly"},_ue="__computeInfo",QBe=/[A-Z]/;function JO(t,e,i){let n=t[e];if(n){if(!t.hasOwnProperty(e)&&(n=t[e]=Object.create(t[e]),i))for(let r in n){let s=n[r],o=n[r]=Array(s.length);for(let a=0;a<s.length;a++)o[a]=s[a]}}else n=t[e]={};return n}function dx(t,e,i,n,r,s){if(e){let o=!1;const a=dS++;for(let l in i){let c=e[r?vd(l):l];if(c)for(let u,d=0,f=c.length;d<f&&(u=c[d]);d++)u.info&&u.info.lastRun===a||r&&!y8(l,u.trigger)||(u.info&&(u.info.lastRun=a),u.fn(t,l,i,n,u.info,r,s),o=!0)}return o}return!1}function e9e(t,e,i,n,r,s,o,a){let l=!1,c=e[o?vd(n):n];if(c)for(let u,d=0,f=c.length;d<f&&(u=c[d]);d++)u.info&&u.info.lastRun===i||o&&!y8(n,u.trigger)||(u.info&&(u.info.lastRun=i),u.fn(t,n,r,s,u.info,o,a),l=!0);return l}function y8(t,e){if(e){let i=e.name;return i==t||!(!e.structured||!cue(i,t))||!(!e.wildcard||!uS(i,t))}return!0}function DW(t,e,i,n,r){let s=typeof r.method=="string"?t[r.method]:r.method,o=r.property;s?s.call(t,t.__data[o],n[o]):r.dynamicFn||console.warn("observer method `"+r.method+"` not defined")}function t9e(t,e,i,n,r){let s,o,a=t[Jt.NOTIFY],l=dS++;for(let c in e)e[c]&&(a&&e9e(t,a,l,c,i,n,r)||r&&i9e(t,c,i))&&(s=!0);s&&(o=t.__dataHost)&&o._invalidateProperties&&o._invalidateProperties()}function i9e(t,e,i){let n=vd(e);return n!==e?(bue(t,dk(n)+"-changed",i[e],e),!0):!1}function bue(t,e,i,n){let r={value:i,queueProperty:!0};n&&(r.path=n),De(t).dispatchEvent(new CustomEvent(e,{detail:r}))}function n9e(t,e,i,n,r,s){let o=(s?vd(e):e)!=e?e:null,a=o?Ks(t,o):t.__data[e];o&&a===void 0&&(a=i[e]),bue(t,r.eventName,a,o)}function r9e(t,e,i,n,r){let s,o=t.detail,a=o&&o.path;a?(n=hS(i,n,a),s=o&&o.value):s=t.currentTarget[i],s=r?!s:s,e[Jt.READ_ONLY]&&e[Jt.READ_ONLY][n]||!e._setPendingPropertyOrPath(n,s,!0,!!a)||o&&o.queueProperty||e._invalidateProperties()}function s9e(t,e,i,n,r){let s=t.__data[e];n$&&(s=n$(s,r.attrName,"attribute",t)),t._propertyToAttribute(e,r.attrName,s)}function o9e(t,e,i,n){let r=t[Jt.COMPUTE];if(r)if(nBe){dS++;const s=l9e(t),o=[];for(let l in e)NW(l,r,o,s,n);let a;for(;a=o.shift();)wue(t,"",e,i,a)&&NW(a.methodInfo,r,o,s,n);Object.assign(i,t.__dataOld),Object.assign(e,t.__dataPending),t.__dataPending=null}else{let s=e;for(;dx(t,r,s,i,n);)Object.assign(i,t.__dataOld),Object.assign(e,t.__dataPending),s=t.__dataPending,t.__dataPending=null}}const a9e=(t,e,i)=>{let n=0,r=e.length-1,s=-1;for(;n<=r;){const o=n+r>>1,a=i.get(e[o].methodInfo)-i.get(t.methodInfo);if(a<0)n=o+1;else{if(!(a>0)){s=o;break}r=o-1}}s<0&&(s=r+1),e.splice(s,0,t)},NW=(t,e,i,n,r)=>{const s=e[r?vd(t):t];if(s)for(let o=0;o<s.length;o++){const a=s[o];a.info.lastRun===dS||r&&!y8(t,a.trigger)||(a.info.lastRun=dS,a9e(a.info,i,n))}};function l9e(t){let e=t.constructor.__orderedComputedDeps;if(!e){e=new Map;const i=t[Jt.COMPUTE];let n,{counts:r,ready:s,total:o}=c9e(t);for(;n=s.shift();){e.set(n,e.size);const a=i[n];a&&a.forEach(l=>{const c=l.info.methodInfo;--o,--r[c]==0&&s.push(c)})}o!==0&&console.warn(`Computed graph for ${t.localName} incomplete; circular?`),t.constructor.__orderedComputedDeps=e}return e}function c9e(t){const e=t[_ue],i={},n=t[Jt.COMPUTE],r=[];let s=0;for(let o in e){const a=e[o];s+=i[o]=a.args.filter(l=>!l.literal).length+(a.dynamicFn?1:0)}for(let o in n)e[o]||r.push(o);return{counts:i,ready:r,total:s}}function wue(t,e,i,n,r){let s=mF(t,e,i,n,r);if(s===pS)return!1;let o=r.methodInfo;return t.__dataHasAccessor&&t.__dataHasAccessor[o]?t._setPendingProperty(o,s,!0):(t[o]=s,!1)}function u9e(t,e,i){let n=t.__dataLinkedPaths;if(n){let r;for(let s in n){let o=n[s];uS(s,e)?(r=hS(s,o,e),t._setPendingPropertyOrPath(r,i,!0,!0)):uS(o,e)&&(r=hS(o,s,e),t._setPendingPropertyOrPath(r,i,!0,!0))}}}function ZO(t,e,i,n,r,s,o){i.bindings=i.bindings||[];let a={kind:n,target:r,parts:s,literal:o,isCompound:s.length!==1};if(i.bindings.push(a),m9e(a)){let{event:c,negate:u}=a.parts[0];a.listenerEvent=c||dk(r)+"-changed",a.listenerNegate=u}let l=e.nodeInfoList.length;for(let c=0;c<a.parts.length;c++){let u=a.parts[c];u.compoundIndex=c,h9e(t,e,a,u,l)}}function h9e(t,e,i,n,r){if(!n.literal)if(i.kind==="attribute"&&i.target[0]==="-")console.warn("Cannot set attribute "+i.target+' because "-" is not a valid attribute starting character');else{let s=n.dependencies,o={index:r,binding:i,part:n,evaluator:t};for(let a=0;a<s.length;a++){let l=s[a];typeof l=="string"&&(l=Sue(l),l.wildcard=!0),t._addTemplatePropertyEffect(e,l.rootProperty,{fn:d9e,info:o,trigger:l})}}}function d9e(t,e,i,n,r,s,o){let a=o[r.index],l=r.binding,c=r.part;if(s&&c.source&&e.length>c.source.length&&l.kind=="property"&&!l.isCompound&&a.__isPropertyEffectsClient&&a.__dataHasAccessor&&a.__dataHasAccessor[l.target]){let u=i[e];e=hS(c.source,l.target,e),a._setPendingPropertyOrPath(e,u,!1,!0)&&t._enqueueClient(a)}else{let u=r.evaluator._evaluateBinding(t,c,e,i,n,s);u!==pS&&p9e(t,a,l,c,u)}}function p9e(t,e,i,n,r){if(r=f9e(e,r,i,n),n$&&(r=n$(r,i.target,i.kind,e)),i.kind=="attribute")t._valueToNodeAttribute(e,r,i.target);else{let s=i.target;e.__isPropertyEffectsClient&&e.__dataHasAccessor&&e.__dataHasAccessor[s]?e[Jt.READ_ONLY]&&e[Jt.READ_ONLY][s]||e._setPendingProperty(s,r)&&t._enqueueClient(e):t._setUnmanagedPropertyToNode(e,s,r)}}function f9e(t,e,i,n){if(i.isCompound){let r=t.__dataCompoundStorage[i.target];r[n.compoundIndex]=e,e=r.join("")}return i.kind!=="attribute"&&(i.target!=="textContent"&&(i.target!=="value"||t.localName!=="input"&&t.localName!=="textarea")||(e=e??"")),e}function m9e(t){return!!t.target&&t.kind!="attribute"&&t.kind!="text"&&!t.isCompound&&t.parts[0].mode==="{"}function g9e(t,e){let{nodeList:i,nodeInfoList:n}=e;if(n.length)for(let r=0;r<n.length;r++){let s=n[r],o=i[r],a=s.bindings;if(a)for(let l=0;l<a.length;l++){let c=a[l];y9e(o,c),v9e(o,t,c)}o.__dataHost=t}}function y9e(t,e){if(e.isCompound){let i=t.__dataCompoundStorage||(t.__dataCompoundStorage={}),n=e.parts,r=new Array(n.length);for(let o=0;o<n.length;o++)r[o]=n[o].literal;let s=e.target;i[s]=r,e.literal&&e.kind=="property"&&(s==="className"&&(t=De(t)),t[s]=e.literal)}}function v9e(t,e,i){if(i.listenerEvent){let n=i.parts[0];t.addEventListener(i.listenerEvent,function(r){r9e(r,e,i.target,n.source,n.negate)})}}function FW(t,e,i,n,r,s){s=e.static||s&&(typeof s!="object"||s[e.methodName]);let o={methodName:e.methodName,args:e.args,methodInfo:r,dynamicFn:s};for(let a,l=0;l<e.args.length&&(a=e.args[l]);l++)a.literal||t._addPropertyEffect(a.rootProperty,i,{fn:n,info:o,trigger:a});return s&&t._addPropertyEffect(e.methodName,i,{fn:n,info:o}),o}function mF(t,e,i,n,r){let s=t._methodHost||t,o=s[r.methodName];if(o){let a=t._marshalArgs(r.args,e,i);return a===pS?pS:o.apply(s,a)}r.dynamicFn||console.warn("method `"+r.methodName+"` not defined")}const _9e=[],xue="(?:[a-zA-Z_$][\\w.:$\\-*]*)",zW="(?:("+xue+`|(?:[-+]?[0-9]*\\.?[0-9]+(?:[eE][-+]?[0-9]+)?)|(?:(?:'(?:[^'\\\\]|\\\\.)*')|(?:"(?:[^"\\\\]|\\\\.)*")))\\s*)`,VW=new RegExp("(\\[\\[|{{)\\s*(?:(!)\\s*)?"+("("+xue+"\\s*"+("(?:\\(\\s*(?:"+("(?:"+zW+"(?:,\\s*"+zW+")*)")+"?)\\)\\s*)")+"?)")+"(?:]]|}})","g");function jW(t){let e="";for(let i=0;i<t.length;i++)e+=t[i].literal||"";return e}function YO(t){let e=t.match(/([^\s]+?)\(([\s\S]*)\)/);if(e){let i={methodName:e[1],static:!0,args:_9e};return e[2].trim()?b9e(e[2].replace(/\\,/g,"&comma;").split(","),i):i}return null}function b9e(t,e){return e.args=t.map(function(i){let n=Sue(i);return n.literal||(e.static=!1),n},this),e}function Sue(t){let e=t.trim().replace(/&comma;/g,",").replace(/\\(.)/g,"$1"),i={name:e,value:"",literal:!1},n=e[0];switch(n==="-"&&(n=e[1]),n>="0"&&n<="9"&&(n="#"),n){case"'":case'"':i.value=e.slice(1,-1),i.literal=!0;break;case"#":i.value=Number(e),i.literal=!0}return i.literal||(i.rootProperty=vd(e),i.structured=pF(e),i.structured&&(i.wildcard=e.slice(-2)==".*",i.wildcard&&(i.name=e.slice(0,-2)))),i}function BW(t,e,i){let n=Ks(t,i);return n===void 0&&(n=e[i]),n}function Tue(t,e,i,n){const r={indexSplices:n};oF&&!t._overrideLegacyUndefined&&(e.splices=r),t.notifyPath(i+".splices",r),t.notifyPath(i+".length",e.length),oF&&!t._overrideLegacyUndefined&&(r.indexSplices=[])}function F1(t,e,i,n,r,s){Tue(t,e,i,[{index:n,addedCount:r,removed:s,object:e,type:"splice"}])}function w9e(t){return t[0].toUpperCase()+t.substring(1)}const pk=Sa(t=>{const e=KBe(yue(t));class i extends e{constructor(){super(),this.__isPropertyEffectsClient=!0,this.__dataClientsReady,this.__dataPendingClients,this.__dataToNotify,this.__dataLinkedPaths,this.__dataHasPaths,this.__dataCompoundStorage,this.__dataHost,this.__dataTemp,this.__dataClientsInitialized,this.__data,this.__dataPending,this.__dataOld,this.__computeEffects,this.__computeInfo,this.__reflectEffects,this.__notifyEffects,this.__propagateEffects,this.__observeEffects,this.__readOnly,this.__templateInfo,this._overrideLegacyUndefined}get PROPERTY_EFFECT_TYPES(){return Jt}_initializeProperties(){super._initializeProperties(),this._registerHost(),this.__dataClientsReady=!1,this.__dataPendingClients=null,this.__dataToNotify=null,this.__dataLinkedPaths=null,this.__dataHasPaths=!1,this.__dataCompoundStorage=this.__dataCompoundStorage||null,this.__dataHost=this.__dataHost||null,this.__dataTemp={},this.__dataClientsInitialized=!1}_registerHost(){if(z1.length){let r=z1[z1.length-1];r._enqueueClient(this),this.__dataHost=r}}_initializeProtoProperties(r){this.__data=Object.create(r),this.__dataPending=Object.create(r),this.__dataOld={}}_initializeInstanceProperties(r){let s=this[Jt.READ_ONLY];for(let o in r)s&&s[o]||(this.__dataPending=this.__dataPending||{},this.__dataOld=this.__dataOld||{},this.__data[o]=this.__dataPending[o]=r[o])}_addPropertyEffect(r,s,o){this._createPropertyAccessor(r,s==Jt.READ_ONLY);let a=JO(this,s,!0)[r];a||(a=this[s][r]=[]),a.push(o)}_removePropertyEffect(r,s,o){let a=JO(this,s,!0)[r],l=a.indexOf(o);l>=0&&a.splice(l,1)}_hasPropertyEffect(r,s){let o=this[s];return!!(o&&o[r])}_hasReadOnlyEffect(r){return this._hasPropertyEffect(r,Jt.READ_ONLY)}_hasNotifyEffect(r){return this._hasPropertyEffect(r,Jt.NOTIFY)}_hasReflectEffect(r){return this._hasPropertyEffect(r,Jt.REFLECT)}_hasComputedEffect(r){return this._hasPropertyEffect(r,Jt.COMPUTE)}_setPendingPropertyOrPath(r,s,o,a){if(a||vd(Array.isArray(r)?r[0]:r)!==r){if(!a){let l=Ks(this,r);if(!(r=OW(this,r,s))||!super._shouldPropertyChange(r,s,l))return!1}if(this.__dataHasPaths=!0,this._setPendingProperty(r,s,o))return u9e(this,r,s),!0}else{if(this.__dataHasAccessor&&this.__dataHasAccessor[r])return this._setPendingProperty(r,s,o);this[r]=s}return!1}_setUnmanagedPropertyToNode(r,s,o){o===r[s]&&typeof o!="object"||(s==="className"&&(r=De(r)),r[s]=o)}_setPendingProperty(r,s,o){let a=this.__dataHasPaths&&pF(r),l=a?this.__dataTemp:this.__data;return!!this._shouldPropertyChange(r,s,l[r])&&(this.__dataPending||(this.__dataPending={},this.__dataOld={}),r in this.__dataOld||(this.__dataOld[r]=this.__data[r]),a?this.__dataTemp[r]=s:this.__data[r]=s,this.__dataPending[r]=s,(a||this[Jt.NOTIFY]&&this[Jt.NOTIFY][r])&&(this.__dataToNotify=this.__dataToNotify||{},this.__dataToNotify[r]=o),!0)}_setProperty(r,s){this._setPendingProperty(r,s,!0)&&this._invalidateProperties()}_invalidateProperties(){this.__dataReady&&this._flushProperties()}_enqueueClient(r){this.__dataPendingClients=this.__dataPendingClients||[],r!==this&&this.__dataPendingClients.push(r)}_flushClients(){this.__dataClientsReady?this.__enableOrFlushClients():(this.__dataClientsReady=!0,this._readyClients(),this.__dataReady=!0)}__enableOrFlushClients(){let r=this.__dataPendingClients;if(r){this.__dataPendingClients=null;for(let s=0;s<r.length;s++){let o=r[s];o.__dataEnabled?o.__dataPending&&o._flushProperties():o._enableProperties()}}}_readyClients(){this.__enableOrFlushClients()}setProperties(r,s){for(let o in r)!s&&this[Jt.READ_ONLY]&&this[Jt.READ_ONLY][o]||this._setPendingPropertyOrPath(o,r[o],!0);this._invalidateProperties()}ready(){this._flushProperties(),this.__dataClientsReady||this._flushClients(),this.__dataPending&&this._flushProperties()}_propertiesChanged(r,s,o){let a,l=this.__dataHasPaths;this.__dataHasPaths=!1,o9e(this,s,o,l),a=this.__dataToNotify,this.__dataToNotify=null,this._propagatePropertyChanges(s,o,l),this._flushClients(),dx(this,this[Jt.REFLECT],s,o,l),dx(this,this[Jt.OBSERVE],s,o,l),a&&t9e(this,a,s,o,l),this.__dataCounter==1&&(this.__dataTemp={})}_propagatePropertyChanges(r,s,o){this[Jt.PROPAGATE]&&dx(this,this[Jt.PROPAGATE],r,s,o),this.__templateInfo&&this._runEffectsForTemplate(this.__templateInfo,r,s,o)}_runEffectsForTemplate(r,s,o,a){const l=(c,u)=>{dx(this,r.propertyEffects,c,o,u,r.nodeList);for(let d=r.firstChild;d;d=d.nextSibling)this._runEffectsForTemplate(d,c,o,u)};r.runEffects?r.runEffects(l,s,a):l(s,a)}linkPaths(r,s){r=hx(r),s=hx(s),this.__dataLinkedPaths=this.__dataLinkedPaths||{},this.__dataLinkedPaths[r]=s}unlinkPaths(r){r=hx(r),this.__dataLinkedPaths&&delete this.__dataLinkedPaths[r]}notifySplices(r,s){let o={path:""};Tue(this,Ks(this,r,o),o.path,s)}get(r,s){return Ks(s||this,r)}set(r,s,o){o?OW(o,r,s):this[Jt.READ_ONLY]&&this[Jt.READ_ONLY][r]||this._setPendingPropertyOrPath(r,s,!0)&&this._invalidateProperties()}push(r,...s){let o={path:""},a=Ks(this,r,o),l=a.length,c=a.push(...s);return s.length&&F1(this,a,o.path,l,s.length,[]),c}pop(r){let s={path:""},o=Ks(this,r,s),a=!!o.length,l=o.pop();return a&&F1(this,o,s.path,o.length,0,[l]),l}splice(r,s,o,...a){let l,c={path:""},u=Ks(this,r,c);return s<0?s=u.length-Math.floor(-s):s&&(s=Math.floor(s)),l=arguments.length===2?u.splice(s):u.splice(s,o,...a),(a.length||l.length)&&F1(this,u,c.path,s,a.length,l),l}shift(r){let s={path:""},o=Ks(this,r,s),a=!!o.length,l=o.shift();return a&&F1(this,o,s.path,0,0,[l]),l}unshift(r,...s){let o={path:""},a=Ks(this,r,o),l=a.unshift(...s);return s.length&&F1(this,a,o.path,0,s.length,[]),l}notifyPath(r,s){let o;if(arguments.length==1){let a={path:""};s=Ks(this,r,a),o=a.path}else o=Array.isArray(r)?hx(r):r;this._setPendingPropertyOrPath(o,s,!0,!0)&&this._invalidateProperties()}_createReadOnlyProperty(r,s){this._addPropertyEffect(r,Jt.READ_ONLY),s&&(this["_set"+w9e(r)]=function(o){this._setProperty(r,o)})}_createPropertyObserver(r,s,o){let a={property:r,method:s,dynamicFn:!!o};this._addPropertyEffect(r,Jt.OBSERVE,{fn:DW,info:a,trigger:{name:r}}),o&&this._addPropertyEffect(s,Jt.OBSERVE,{fn:DW,info:a,trigger:{name:s}})}_createMethodObserver(r,s){let o=YO(r);if(!o)throw new Error("Malformed observer expression '"+r+"'");FW(this,o,Jt.OBSERVE,mF,null,s)}_createNotifyingProperty(r){this._addPropertyEffect(r,Jt.NOTIFY,{fn:n9e,info:{eventName:dk(r)+"-changed",property:r}})}_createReflectedProperty(r){let s=this.constructor.attributeNameForProperty(r);s[0]==="-"?console.warn("Property "+r+" cannot be reflected to attribute "+s+' because "-" is not a valid starting attribute name. Use a lowercase first letter for the property instead.'):this._addPropertyEffect(r,Jt.REFLECT,{fn:s9e,info:{attrName:s}})}_createComputedProperty(r,s,o){let a=YO(s);if(!a)throw new Error("Malformed computed expression '"+s+"'");const l=FW(this,a,Jt.COMPUTE,wue,r,o);JO(this,_ue)[r]=l}_marshalArgs(r,s,o){const a=this.__data,l=[];for(let c=0,u=r.length;c<u;c++){let{name:d,structured:f,wildcard:m,value:g,literal:y}=r[c];if(!y)if(m){const _=uS(d,s),b=BW(a,o,_?s:d);g={path:_?s:d,value:b,base:_?Ks(a,d):b}}else g=f?BW(a,o,d):a[d];if(oF&&!this._overrideLegacyUndefined&&g===void 0&&r.length>1)return pS;l[c]=g}return l}static addPropertyEffect(r,s,o){this.prototype._addPropertyEffect(r,s,o)}static createPropertyObserver(r,s,o){this.prototype._createPropertyObserver(r,s,o)}static createMethodObserver(r,s){this.prototype._createMethodObserver(r,s)}static createNotifyingProperty(r){this.prototype._createNotifyingProperty(r)}static createReadOnlyProperty(r,s){this.prototype._createReadOnlyProperty(r,s)}static createReflectedProperty(r){this.prototype._createReflectedProperty(r)}static createComputedProperty(r,s,o){this.prototype._createComputedProperty(r,s,o)}static bindTemplate(r){return this.prototype._bindTemplate(r)}_bindTemplate(r,s){let o=this.constructor._parseTemplate(r),a=this.__preBoundTemplateInfo==o;if(!a)for(let l in o.propertyEffects)this._createPropertyAccessor(l);if(s)if(o=Object.create(o),o.wasPreBound=a,this.__templateInfo){const l=r._parentTemplateInfo||this.__templateInfo,c=l.lastChild;o.parent=l,l.lastChild=o,o.previousSibling=c,c?c.nextSibling=o:l.firstChild=o}else this.__templateInfo=o;else this.__preBoundTemplateInfo=o;return o}static _addTemplatePropertyEffect(r,s,o){(r.hostProps=r.hostProps||{})[s]=!0;let a=r.propertyEffects=r.propertyEffects||{};(a[s]=a[s]||[]).push(o)}_stampTemplate(r,s){s=s||this._bindTemplate(r,!0),z1.push(this);let o=super._stampTemplate(r,s);if(z1.pop(),s.nodeList=o.nodeList,!s.wasPreBound){let a=s.childNodes=[];for(let l=o.firstChild;l;l=l.nextSibling)a.push(l)}return o.templateInfo=s,g9e(this,s),this.__dataClientsReady&&(this._runEffectsForTemplate(s,this.__data,null,!1),this._flushClients()),o}_removeBoundDom(r){const s=r.templateInfo,{previousSibling:o,nextSibling:a,parent:l}=s;o?o.nextSibling=a:l&&(l.firstChild=a),a?a.previousSibling=o:l&&(l.lastChild=o),s.nextSibling=s.previousSibling=null;let c=s.childNodes;for(let u=0;u<c.length;u++){let d=c[u];De(De(d).parentNode).removeChild(d)}}static _parseTemplateNode(r,s,o){let a=e._parseTemplateNode.call(this,r,s,o);if(r.nodeType===Node.TEXT_NODE){let l=this._parseBindings(r.textContent,s);l&&(r.textContent=jW(l)||" ",ZO(this,s,o,"text","textContent",l),a=!0)}return a}static _parseTemplateNodeAttribute(r,s,o,a,l){let c=this._parseBindings(l,s);if(c){let u=a,d="property";QBe.test(a)?d="attribute":a[a.length-1]=="$"&&(a=a.slice(0,-1),d="attribute");let f=jW(c);return f&&d=="attribute"&&(a=="class"&&r.hasAttribute("class")&&(f+=" "+r.getAttribute(a)),r.setAttribute(a,f)),d=="attribute"&&u=="disable-upgrade$"&&r.setAttribute(a,""),r.localName==="input"&&u==="value"&&r.setAttribute(u,""),r.removeAttribute(u),d==="property"&&(a=hue(a)),ZO(this,s,o,d,a,c,f),!0}return e._parseTemplateNodeAttribute.call(this,r,s,o,a,l)}static _parseTemplateNestedTemplate(r,s,o){let a=e._parseTemplateNestedTemplate.call(this,r,s,o);const l=r.parentNode,c=o.templateInfo,u=l.localName==="dom-if",d=l.localName==="dom-repeat";pW&&(u||d)&&(l.removeChild(r),(o=o.parentInfo).templateInfo=c,o.noted=!0,a=!1);let f=c.hostProps;if(Qce&&u)f&&(s.hostProps=Object.assign(s.hostProps||{},f),pW||(o.parentInfo.noted=!0));else{let m="{";for(let g in f)ZO(this,s,o,"property","_host_"+g,[{mode:m,source:g,dependencies:[g],hostProp:!0}])}return a}static _parseBindings(r,s){let o,a=[],l=0;for(;(o=VW.exec(r))!==null;){o.index>l&&a.push({literal:r.slice(l,o.index)});let c=o[1][0],u=!!o[2],d=o[3].trim(),f=!1,m="",g=-1;c=="{"&&(g=d.indexOf("::"))>0&&(m=d.substring(g+2),d=d.substring(0,g),f=!0);let y=YO(d),_=[];if(y){let{args:b,methodName:w}=y;for(let S=0;S<b.length;S++){let T=b[S];T.literal||_.push(T)}let x=s.dynamicFns;(x&&x[w]||y.static)&&(_.push(w),y.dynamicFn=!0)}else _.push(d);a.push({source:d,mode:c,negate:u,customEvent:f,signature:y,dependencies:_,event:m}),l=VW.lastIndex}if(l&&l<r.length){let c=r.substring(l);c&&a.push({literal:c})}return a.length?a:null}static _evaluateBinding(r,s,o,a,l,c){let u;return u=s.signature?mF(r,o,a,l,s.signature):o!=s.source?Ks(r,s.source):c&&pF(o)?Ks(r,o):r.__data[o],s.negate&&(u=!u),u}}return i}),z1=[];function x9e(t){const e={};for(let i in t){const n=t[i];e[i]=typeof n=="function"?{type:n}:n}return e}const S9e=Sa(t=>{const e=mue(t);function i(s){const o=Object.getPrototypeOf(s);return o.prototype instanceof r?o:null}function n(s){if(!s.hasOwnProperty(JSCompiler_renameProperty("__ownProperties",s))){let o=null;if(s.hasOwnProperty(JSCompiler_renameProperty("properties",s))){const a=s.properties;a&&(o=x9e(a))}s.__ownProperties=o}return s.__ownProperties}class r extends e{static get observedAttributes(){if(!this.hasOwnProperty(JSCompiler_renameProperty("__observedAttributes",this))){this.prototype;const o=this._properties;this.__observedAttributes=o?Object.keys(o).map(a=>this.prototype._addPropertyToAttributeMap(a)):[]}return this.__observedAttributes}static finalize(){if(!this.hasOwnProperty(JSCompiler_renameProperty("__finalized",this))){const o=i(this);o&&o.finalize(),this.__finalized=!0,this._finalizeClass()}}static _finalizeClass(){const o=n(this);o&&this.createProperties(o)}static get _properties(){if(!this.hasOwnProperty(JSCompiler_renameProperty("__properties",this))){const o=i(this);this.__properties=Object.assign({},o&&o._properties,n(this))}return this.__properties}static typeForProperty(o){const a=this._properties[o];return a&&a.type}_initializeProperties(){this.constructor.finalize(),super._initializeProperties()}connectedCallback(){super.connectedCallback&&super.connectedCallback(),this._enableProperties()}disconnectedCallback(){super.disconnectedCallback&&super.disconnectedCallback()}}return r}),T9e="3.4.1",gF=window.ShadyCSS&&window.ShadyCSS.cssBuild,fk=Sa(t=>{const e=S9e(pk(t));function i(l){if(!l.hasOwnProperty(JSCompiler_renameProperty("__propertyDefaults",l))){l.__propertyDefaults=null;let c=l._properties;for(let u in c){let d=c[u];"value"in d&&(l.__propertyDefaults=l.__propertyDefaults||{},l.__propertyDefaults[u]=d)}}return l.__propertyDefaults}function n(l){return l.hasOwnProperty(JSCompiler_renameProperty("__ownObservers",l))||(l.__ownObservers=l.hasOwnProperty(JSCompiler_renameProperty("observers",l))?l.observers:null),l.__ownObservers}function r(l,c,u,d){u.computed&&(u.readOnly=!0),u.computed&&(l._hasReadOnlyEffect(c)?console.warn(`Cannot redefine computed property '${c}'.`):l._createComputedProperty(c,u.computed,d)),u.readOnly&&!l._hasReadOnlyEffect(c)?l._createReadOnlyProperty(c,!u.computed):u.readOnly===!1&&l._hasReadOnlyEffect(c)&&console.warn(`Cannot make readOnly property '${c}' non-readOnly.`),u.reflectToAttribute&&!l._hasReflectEffect(c)?l._createReflectedProperty(c):u.reflectToAttribute===!1&&l._hasReflectEffect(c)&&console.warn(`Cannot make reflected property '${c}' non-reflected.`),u.notify&&!l._hasNotifyEffect(c)?l._createNotifyingProperty(c):u.notify===!1&&l._hasNotifyEffect(c)&&console.warn(`Cannot make notify property '${c}' non-notify.`),u.observer&&l._createPropertyObserver(c,u.observer,d[u.observer]),l._addPropertyToAttributeMap(c)}function s(l,c,u,d){if(!gF){const f=c.content.querySelectorAll("style"),m=h8(c),g=uBe(u),y=c.content.firstElementChild;for(let b=0;b<g.length;b++){let w=g[b];w.textContent=l._processStyleText(w.textContent,d),c.content.insertBefore(w,y)}let _=0;for(let b=0;b<m.length;b++){let w=m[b],x=f[_];x!==w?(w=w.cloneNode(!0),x.parentNode.insertBefore(w,x)):_++,w.textContent=l._processStyleText(w.textContent,d)}}if(window.ShadyCSS&&window.ShadyCSS.prepareTemplate(c,u),rBe&&gF&&K8e){const f=c.content.querySelectorAll("style");if(f){let m="";Array.from(f).forEach(g=>{m+=g.textContent,g.parentNode.removeChild(g)}),l._styleSheet=new CSSStyleSheet,l._styleSheet.replaceSync(m)}}}function o(l){let c=null;if(l&&(!wb||tBe)&&(c=xb.import(l,"template"),wb&&!c))throw new Error(`strictTemplatePolicy: expecting dom-module or null template for ${l}`);return c}class a extends e{static get polymerElementVersion(){return T9e}static _finalizeClass(){e._finalizeClass.call(this);const c=n(this);c&&this.createObservers(c,this._properties),this._prepareTemplate()}static _prepareTemplate(){let c=this.template;c&&(typeof c=="string"?(console.error("template getter must return HTMLTemplateElement"),c=null):oS||(c=c.cloneNode(!0))),this.prototype._template=c}static createProperties(c){for(let u in c)r(this.prototype,u,c[u],c)}static createObservers(c,u){const d=this.prototype;for(let f=0;f<c.length;f++)d._createMethodObserver(c[f],u)}static get template(){if(!this.hasOwnProperty(JSCompiler_renameProperty("_template",this))){const c=this.prototype.hasOwnProperty(JSCompiler_renameProperty("_template",this.prototype))?this.prototype._template:void 0;this._template=c!==void 0?c:this.hasOwnProperty(JSCompiler_renameProperty("is",this))&&o(this.is)||Object.getPrototypeOf(this.prototype).constructor.template}return this._template}static set template(c){this._template=c}static get importPath(){if(!this.hasOwnProperty(JSCompiler_renameProperty("_importPath",this))){const c=this.importMeta;if(c)this._importPath=a8(c.url);else{const u=xb.import(this.is);this._importPath=u&&u.assetpath||Object.getPrototypeOf(this.prototype).constructor.importPath}}return this._importPath}constructor(){super(),this._template,this._importPath,this.rootPath,this.importPath,this.root,this.$}_initializeProperties(){this.constructor.finalize(),this.constructor._finalizeTemplate(this.localName),super._initializeProperties(),this.rootPath=Q8e,this.importPath=this.constructor.importPath;let c=i(this.constructor);if(c)for(let u in c){let d=c[u];if(this._canApplyPropertyDefault(u)){let f=typeof d.value=="function"?d.value.call(this):d.value;this._hasAccessor(u)?this._setPendingProperty(u,f,!0):this[u]=f}}}_canApplyPropertyDefault(c){return!this.hasOwnProperty(c)}static _processStyleText(c,u){return o8(c,u)}static _finalizeTemplate(c){const u=this.prototype._template;if(u&&!u.__polymerFinalized){u.__polymerFinalized=!0;const d=this.importPath;s(this,u,c,d?t2(d):""),this.prototype._bindTemplate(u)}}connectedCallback(){window.ShadyCSS&&this._template&&window.ShadyCSS.styleElement(this),super.connectedCallback()}ready(){this._template&&(this.root=this._stampTemplate(this._template),this.$=this.root.$),super.ready()}_readyClients(){this._template&&(this.root=this._attachDom(this.root)),super._readyClients()}_attachDom(c){const u=De(this);if(u.attachShadow)return c?(u.shadowRoot||(u.attachShadow({mode:"open",shadyUpgradeFragment:c}),u.shadowRoot.appendChild(c),this.constructor._styleSheet&&(u.shadowRoot.adoptedStyleSheets=[this.constructor._styleSheet])),iBe&&window.ShadyDOM&&window.ShadyDOM.flushInitial(u.shadowRoot),u.shadowRoot):null;throw new Error("ShadowDOM not available. PolymerElement can create dom as children instead of in ShadowDOM by setting `this.root = this;` before `ready`.")}updateStyles(c){window.ShadyCSS&&window.ShadyCSS.styleSubtree(this,c)}resolveUrl(c,u){return!u&&this.importPath&&(u=t2(this.importPath)),t2(c,u)}static _parseTemplateContent(c,u,d){return u.dynamicFns=u.dynamicFns||this._properties,e._parseTemplateContent.call(this,c,u,d)}static _addTemplatePropertyEffect(c,u,d){return!Kce||u in this._properties||d.info.part.signature&&d.info.part.signature.static||d.info.part.hostProp||c.nestedTemplate||console.warn(`Property '${u}' used in template but not declared in 'properties'; attribute will not be observed.`),e._addTemplatePropertyEffect.call(this,c,u,d)}}return a});class Iue{constructor(e){this.value=e.toString()}toString(){return this.value}}function I9e(t){if(t instanceof Iue)return t.value;throw new Error(`non-literal value passed to Polymer's htmlLiteral function: ${t}`)}function C9e(t){if(t instanceof HTMLTemplateElement)return t.innerHTML;if(t instanceof Iue)return I9e(t);throw new Error(`non-template value passed to Polymer's html function: ${t}`)}const mT=function(t,...e){const i=document.createElement("template");return i.innerHTML=e.reduce((n,r,s)=>n+C9e(r)+t[s+1],t[0]),i},_d=fk(HTMLElement);class Tn{constructor(){this._asyncModule=null,this._callback=null,this._timer=null}setConfig(e,i){this._asyncModule=e,this._callback=i,this._timer=this._asyncModule.run(()=>{this._timer=null,fS.delete(this),this._callback()})}cancel(){this.isActive()&&(this._cancelAsync(),fS.delete(this))}_cancelAsync(){this.isActive()&&(this._asyncModule.cancel(this._timer),this._timer=null)}flush(){this.isActive()&&(this.cancel(),this._callback())}isActive(){return this._timer!=null}static debounce(e,i,n){return e instanceof Tn?e._cancelAsync():e=new Tn,e.setConfig(i,n),e}}let fS=new Set;const mk=function(t){fS.add(t)},M9e=function(){const t=!!fS.size;return fS.forEach(e=>{try{e.flush()}catch(i){setTimeout(()=>{throw i})}}),t};let v8=typeof document.head.style.touchAction=="string",o$="__polymerGestures",rE="__polymerGesturesHandled",yF="__polymerGesturesTouchAction",UW=25,GW=5,E9e=2,A9e=2500,Cue=["mousedown","mousemove","mouseup","click"],$9e=[0,1,4,2],P9e=function(){try{return new MouseEvent("test",{buttons:1}).buttons===1}catch{return!1}}();function _8(t){return Cue.indexOf(t)>-1}let b8=!1;function Mue(t){if(!_8(t)&&t!=="touchend")return v8&&b8&&eBe?{passive:!0}:void 0}(function(){try{let t=Object.defineProperty({},"passive",{get(){b8=!0}});window.addEventListener("test",null,t),window.removeEventListener("test",null,t)}catch{}})();let Eue=navigator.userAgent.match(/iP(?:[oa]d|hone)|Android/);const vF=[],k9e={button:!0,input:!0,keygen:!0,meter:!0,output:!0,textarea:!0,progress:!0,select:!0},O9e={button:!0,command:!0,fieldset:!0,input:!0,keygen:!0,optgroup:!0,option:!0,select:!0,textarea:!0};function L9e(t){return k9e[t.localName]||!1}function R9e(t){let e=Array.prototype.slice.call(t.labels||[]);if(!e.length){e=[];let i=t.getRootNode();if(t.id){let n=i.querySelectorAll(`label[for = ${t.id}]`);for(let r=0;r<n.length;r++)e.push(n[r])}}return e}let HW=function(t){let e=t.sourceCapabilities;if((!e||e.firesTouchEvents)&&(t[rE]={skip:!0},t.type==="click")){let i=!1,n=gk(t);for(let r=0;r<n.length;r++){if(n[r].nodeType===Node.ELEMENT_NODE){if(n[r].localName==="label")vF.push(n[r]);else if(L9e(n[r])){let s=R9e(n[r]);for(let o=0;o<s.length;o++)i=i||vF.indexOf(s[o])>-1}}if(n[r]===Ts.mouse.target)return}if(i)return;t.preventDefault(),t.stopPropagation()}};function qW(t){let e=Eue?["click"]:Cue;for(let i,n=0;n<e.length;n++)i=e[n],t?(vF.length=0,document.addEventListener(i,HW,!0)):document.removeEventListener(i,HW,!0)}function D9e(t){Ts.mouse.mouseIgnoreJob||qW(!0);let e=function(){qW(),Ts.mouse.target=null,Ts.mouse.mouseIgnoreJob=null};Ts.mouse.target=gk(t)[0],Ts.mouse.mouseIgnoreJob=Tn.debounce(Ts.mouse.mouseIgnoreJob,_c.after(A9e),e)}function vm(t){let e=t.type;if(!_8(e))return!1;if(e==="mousemove"){let i=t.buttons===void 0?1:t.buttons;return t instanceof window.MouseEvent&&!P9e&&(i=$9e[t.which]||0),!!(1&i)}return(t.button===void 0?0:t.button)===0}function N9e(t){if(t.type==="click"){if(t.detail===0)return!0;let e=Hp(t);if(!e.nodeType||e.nodeType!==Node.ELEMENT_NODE)return!0;let i=e.getBoundingClientRect(),n=t.pageX,r=t.pageY;return!(n>=i.left&&n<=i.right&&r>=i.top&&r<=i.bottom)}return!1}let Ts={mouse:{target:null,mouseIgnoreJob:null},touch:{x:0,y:0,id:-1,scrollDecided:!1}};function F9e(t){let e="auto",i=gk(t);for(let n,r=0;r<i.length;r++)if(n=i[r],n[yF]){e=n[yF];break}return e}function WW(t,e,i){t.movefn=e,t.upfn=i,document.addEventListener("mousemove",e),document.addEventListener("mouseup",i)}function F0(t){document.removeEventListener("mousemove",t.movefn),document.removeEventListener("mouseup",t.upfn),t.movefn=null,t.upfn=null}document.addEventListener("touchend",D9e,!!b8&&{passive:!0});const gk=window.ShadyDOM&&window.ShadyDOM.noPatch?window.ShadyDOM.composedPath:t=>t.composedPath&&t.composedPath()||[],gT={},uy=[];function z9e(t,e){let i=document.elementFromPoint(t,e),n=i;for(;n&&n.shadowRoot&&!window.ShadyDOM;){let r=n;if(n=n.shadowRoot.elementFromPoint(t,e),r===n)break;n&&(i=n)}return i}function Hp(t){const e=gk(t);return e.length>0?e[0]:t.target}function Aue(t){let e,i=t.type,n=t.currentTarget[o$];if(!n)return;let r=n[i];if(r){if(!t[rE]&&(t[rE]={},i.slice(0,5)==="touch")){let s=t.changedTouches[0];if(i==="touchstart"&&t.touches.length===1&&(Ts.touch.id=s.identifier),Ts.touch.id!==s.identifier)return;v8||i!=="touchstart"&&i!=="touchmove"||V9e(t)}if(e=t[rE],!e.skip){for(let s,o=0;o<uy.length;o++)s=uy[o],r[s.name]&&!e[s.name]&&s.flow&&s.flow.start.indexOf(t.type)>-1&&s.reset&&s.reset();for(let s,o=0;o<uy.length;o++)s=uy[o],r[s.name]&&!e[s.name]&&(e[s.name]=!0,s[i](t))}}}function V9e(t){let e=t.changedTouches[0],i=t.type;if(i==="touchstart")Ts.touch.x=e.clientX,Ts.touch.y=e.clientY,Ts.touch.scrollDecided=!1;else if(i==="touchmove"){if(Ts.touch.scrollDecided)return;Ts.touch.scrollDecided=!0;let n=F9e(t),r=!1,s=Math.abs(Ts.touch.x-e.clientX),o=Math.abs(Ts.touch.y-e.clientY);t.cancelable&&(n==="none"?r=!0:n==="pan-x"?r=o>s:n==="pan-y"&&(r=s>o)),r?t.preventDefault():a$("track")}}function w8(t,e,i){return!!gT[e]&&(B9e(t,e,i),!0)}function j9e(t,e,i){return!!gT[e]&&(U9e(t,e,i),!0)}function B9e(t,e,i){let n=gT[e],r=n.deps,s=n.name,o=t[o$];o||(t[o$]=o={});for(let a,l,c=0;c<r.length;c++)a=r[c],Eue&&_8(a)&&a!=="click"||(l=o[a],l||(o[a]=l={_count:0}),l._count===0&&t.addEventListener(a,Aue,Mue(a)),l[s]=(l[s]||0)+1,l._count=(l._count||0)+1);t.addEventListener(e,i),n.touchAction&&$ue(t,n.touchAction)}function U9e(t,e,i){let n=gT[e],r=n.deps,s=n.name,o=t[o$];if(o)for(let a,l,c=0;c<r.length;c++)a=r[c],l=o[a],l&&l[s]&&(l[s]=(l[s]||1)-1,l._count=(l._count||1)-1,l._count===0&&t.removeEventListener(a,Aue,Mue(a)));t.removeEventListener(e,i)}function XO(t){uy.push(t);for(let e=0;e<t.emits.length;e++)gT[t.emits[e]]=t}function G9e(t){for(let e,i=0;i<uy.length;i++){e=uy[i];for(let n,r=0;r<e.emits.length;r++)if(n=e.emits[r],n===t)return e}return null}function $ue(t,e){v8&&t instanceof HTMLElement&&ul.run(()=>{t.style.touchAction=e}),t[yF]=e}function x8(t,e,i){let n=new Event(e,{bubbles:!0,cancelable:!0,composed:!0});if(n.detail=i,De(t).dispatchEvent(n),n.defaultPrevented){let r=i.preventer||i.sourceEvent;r&&r.preventDefault&&r.preventDefault()}}function a$(t){let e=G9e(t);e.info&&(e.info.prevent=!0)}function V1(t,e,i,n){e&&x8(e,t,{x:i.clientX,y:i.clientY,sourceEvent:i,preventer:n,prevent:function(r){return a$(r)}})}function JW(t,e,i){if(t.prevent)return!1;if(t.started)return!0;let n=Math.abs(t.x-e),r=Math.abs(t.y-i);return n>=GW||r>=GW}function KO(t,e,i){if(!e)return;let n,r=t.moves[t.moves.length-2],s=t.moves[t.moves.length-1],o=s.x-t.x,a=s.y-t.y,l=0;r&&(n=s.x-r.x,l=s.y-r.y),x8(e,"track",{state:t.state,x:i.clientX,y:i.clientY,dx:o,dy:a,ddx:n,ddy:l,sourceEvent:i,hover:function(){return z9e(i.clientX,i.clientY)}})}function ZW(t,e,i){let n=Math.abs(e.clientX-t.x),r=Math.abs(e.clientY-t.y),s=Hp(i||e);!s||O9e[s.localName]&&s.hasAttribute("disabled")||(isNaN(n)||isNaN(r)||n<=UW&&r<=UW||N9e(e))&&(t.prevent||x8(s,"tap",{x:e.clientX,y:e.clientY,sourceEvent:e,preventer:i}))}XO({name:"downup",deps:["mousedown","touchstart","touchend"],flow:{start:["mousedown","touchstart"],end:["mouseup","touchend"]},emits:["down","up"],info:{movefn:null,upfn:null},reset:function(){F0(this.info)},mousedown:function(t){if(!vm(t))return;let e=Hp(t),i=this,n=function(s){vm(s)||(V1("up",e,s),F0(i.info))},r=function(s){vm(s)&&V1("up",e,s),F0(i.info)};WW(this.info,n,r),V1("down",e,t)},touchstart:function(t){V1("down",Hp(t),t.changedTouches[0],t)},touchend:function(t){V1("up",Hp(t),t.changedTouches[0],t)}}),XO({name:"track",touchAction:"none",deps:["mousedown","touchstart","touchmove","touchend"],flow:{start:["mousedown","touchstart"],end:["mouseup","touchend"]},emits:["track"],info:{x:0,y:0,state:"start",started:!1,moves:[],addMove:function(t){this.moves.length>E9e&&this.moves.shift(),this.moves.push(t)},movefn:null,upfn:null,prevent:!1},reset:function(){this.info.state="start",this.info.started=!1,this.info.moves=[],this.info.x=0,this.info.y=0,this.info.prevent=!1,F0(this.info)},mousedown:function(t){if(!vm(t))return;let e=Hp(t),i=this,n=function(s){let o=s.clientX,a=s.clientY;JW(i.info,o,a)&&(i.info.state=i.info.started?s.type==="mouseup"?"end":"track":"start",i.info.state==="start"&&a$("tap"),i.info.addMove({x:o,y:a}),vm(s)||(i.info.state="end",F0(i.info)),e&&KO(i.info,e,s),i.info.started=!0)},r=function(s){i.info.started&&n(s),F0(i.info)};WW(this.info,n,r),this.info.x=t.clientX,this.info.y=t.clientY},touchstart:function(t){let e=t.changedTouches[0];this.info.x=e.clientX,this.info.y=e.clientY},touchmove:function(t){let e=Hp(t),i=t.changedTouches[0],n=i.clientX,r=i.clientY;JW(this.info,n,r)&&(this.info.state==="start"&&a$("tap"),this.info.addMove({x:n,y:r}),KO(this.info,e,i),this.info.state="track",this.info.started=!0)},touchend:function(t){let e=Hp(t),i=t.changedTouches[0];this.info.started&&(this.info.state="end",this.info.addMove({x:i.clientX,y:i.clientY}),KO(this.info,e,i))}}),XO({name:"tap",deps:["mousedown","click","touchstart","touchend"],flow:{start:["mousedown","touchstart"],end:["click","touchend"]},emits:["tap"],info:{x:NaN,y:NaN,prevent:!1},reset:function(){this.info.x=NaN,this.info.y=NaN,this.info.prevent=!1},mousedown:function(t){vm(t)&&(this.info.x=t.clientX,this.info.y=t.clientY)},click:function(t){vm(t)&&ZW(this.info,t)},touchstart:function(t){const e=t.changedTouches[0];this.info.x=e.clientX,this.info.y=e.clientY},touchend:function(t){ZW(this.info,t.changedTouches[0],t)}});const yT=Sa(t=>{class e extends t{_addEventListenerToNode(n,r,s){w8(n,r,s)||super._addEventListenerToNode(n,r,s)}_removeEventListenerFromNode(n,r,s){j9e(n,r,s)||super._removeEventListenerFromNode(n,r,s)}}return e}),H9e=t=>class extends t{static get properties(){return{theme:{type:String,readOnly:!0}}}attributeChangedCallback(e,i,n){super.attributeChangedCallback(e,i,n),e==="theme"&&this._setTheme(n)}},S8=t=>class extends H9e(t){static finalize(){super.finalize();const e=this.prototype._template,i=this.template&&this.template.parentElement&&this.template.parentElement.id===this.is,n=Object.getPrototypeOf(this.prototype)._template;n&&!i&&Array.from(n.content.querySelectorAll("style[include]")).forEach(r=>{this._includeStyle(r.getAttribute("include"),e)}),this._includeMatchingThemes(e)}static _includeMatchingThemes(e){const i=xb.prototype.modules;let n=!1;const r=this.is+"-default-theme";Object.keys(i).sort((s,o)=>{const a=s.indexOf("vaadin-")===0,l=o.indexOf("vaadin-")===0,c=["lumo-","material-"],u=c.filter(f=>s.indexOf(f)===0).length>0,d=c.filter(f=>o.indexOf(f)===0).length>0;return a!==l?a?-1:1:u!==d?u?-1:1:0}).forEach(s=>{if(s!==r){const o=i[s].getAttribute("theme-for");o&&o.split(" ").forEach(a=>{new RegExp("^"+a.split("*").join(".*")+"$").test(this.is)&&(n=!0,this._includeStyle(s,e))})}}),!n&&i[r]&&this._includeStyle(r,e)}static _includeStyle(e,i){if(i&&!i.content.querySelector(`style[include="${e}"]`)){const n=document.createElement("style");n.setAttribute("include",e),i.content.appendChild(n)}}};let l$=!1;window.addEventListener("keydown",()=>{l$=!0},{capture:!0}),window.addEventListener("mousedown",()=>{l$=!1},{capture:!0});const q9e=t=>class extends t{static get properties(){var e={tabindex:{type:Number,value:0,reflectToAttribute:!0,observer:"_tabindexChanged"}};return window.ShadyDOM&&(e.tabIndex=e.tabindex),e}},W9e=t=>class extends q9e(t){static get properties(){return{autofocus:{type:Boolean},_previousTabIndex:{type:Number},disabled:{type:Boolean,observer:"_disabledChanged",reflectToAttribute:!0},_isShiftTabbing:{type:Boolean}}}get _keyboardActive(){return l$}ready(){this.addEventListener("focusin",i=>{i.composedPath()[0]===this?this.contains(i.relatedTarget)||this._focus():i.composedPath().indexOf(this.focusElement)===-1||this.disabled||this._setFocused(!0)}),this.addEventListener("focusout",i=>this._setFocused(!1)),super.ready();const e=i=>{i.composed||i.target.dispatchEvent(new CustomEvent(i.type,{bubbles:!0,composed:!0,cancelable:!1}))};this.shadowRoot.addEventListener("focusin",e),this.shadowRoot.addEventListener("focusout",e),this.addEventListener("keydown",i=>{if(!i.defaultPrevented&&i.keyCode===9)if(i.shiftKey)this._isShiftTabbing=!0,HTMLElement.prototype.focus.apply(this),this._setFocused(!1),setTimeout(()=>this._isShiftTabbing=!1,0);else{const n=window.navigator.userAgent.match(/Firefox\/(\d\d\.\d)/);if(n&&parseFloat(n[1])>=63&&parseFloat(n[1])<66&&this.parentNode&&this.nextSibling){const r=document.createElement("input");r.style.position="absolute",r.style.opacity="0",r.tabIndex=this.tabIndex,this.parentNode.insertBefore(r,this.nextSibling),r.focus(),r.addEventListener("focusout",()=>this.parentNode.removeChild(r))}}}),this.autofocus&&!this.disabled&&window.requestAnimationFrame(()=>{this._focus(),this._setFocused(!0),this.setAttribute("focus-ring","")})}disconnectedCallback(){super.disconnectedCallback(),this.hasAttribute("focused")&&this._setFocused(!1)}_setFocused(e){e?this.setAttribute("focused",""):this.removeAttribute("focused"),e&&l$?this.setAttribute("focus-ring",""):this.removeAttribute("focus-ring")}get focusElement(){return window.console.warn(`Please implement the 'focusElement' property in <${this.localName}>`),this}_focus(){this.focusElement&&!this._isShiftTabbing&&(this.focusElement.focus(),this._setFocused(!0))}focus(){this.focusElement&&!this.disabled&&(this.focusElement.focus(),this._setFocused(!0))}blur(){this.focusElement&&(this.focusElement.blur(),this._setFocused(!1))}_disabledChanged(e){this.focusElement.disabled=e,e?(this.blur(),this._previousTabIndex=this.tabindex,this.tabindex=-1,this.setAttribute("aria-disabled","true")):(this._previousTabIndex!==void 0&&(this.tabindex=this._previousTabIndex),this.removeAttribute("aria-disabled"))}_tabindexChanged(e){e!==void 0&&(this.focusElement.tabIndex=e),this.disabled&&this.tabindex&&(this.tabindex!==-1&&(this._previousTabIndex=this.tabindex),this.tabindex=e=void 0),window.ShadyDOM&&this.setProperties({tabIndex:e,tabindex:e})}click(){this.disabled||super.click()}},Sb=function(){let t,e;do t=window.ShadyDOM&&ShadyDOM.flush(),window.ShadyCSS&&window.ShadyCSS.ScopingShim&&window.ShadyCSS.ScopingShim.flush(),e=M9e();while(t||e)};class QO{static detectScrollType(){const e=document.createElement("div");e.textContent="ABCD",e.dir="rtl",e.style.fontSize="14px",e.style.width="4px",e.style.height="1px",e.style.position="absolute",e.style.top="-1000px",e.style.overflow="scroll",document.body.appendChild(e);let i="reverse";return e.scrollLeft>0?i="default":(e.scrollLeft=2,e.scrollLeft<2&&(i="negative")),document.body.removeChild(e),i}static getNormalizedScrollLeft(e,i,n){const{scrollLeft:r}=n;if(i!=="rtl"||!e)return r;switch(e){case"negative":return n.scrollWidth-n.clientWidth+r;case"reverse":return n.scrollWidth-n.clientWidth-r}return r}static setNormalizedScrollLeft(e,i,n,r){if(i==="rtl"&&e)switch(e){case"negative":n.scrollLeft=n.clientWidth-n.scrollWidth+r;break;case"reverse":n.scrollLeft=n.scrollWidth-n.clientWidth-r;break;default:n.scrollLeft=r}else n.scrollLeft=r}}const Ep=[],J9e=function(){const t=Zv();Ep.forEach(e=>{_F(e,t)})};let YI;new MutationObserver(J9e).observe(document.documentElement,{attributes:!0,attributeFilter:["dir"]});const _F=function(t,e){e?t.setAttribute("dir",e):t.removeAttribute("dir")},Zv=function(){return document.documentElement.getAttribute("dir")},T8=t=>class extends t{static get properties(){return{dir:{type:String,readOnly:!0}}}static finalize(){super.finalize(),YI||(YI=QO.detectScrollType())}connectedCallback(){super.connectedCallback(),this.hasAttribute("dir")||(this.__subscribe(),_F(this,Zv()))}attributeChangedCallback(e,i,n){if(super.attributeChangedCallback(e,i,n),e!=="dir")return;const r=n===Zv()&&Ep.indexOf(this)===-1,s=!n&&i&&Ep.indexOf(this)===-1,o=n!==Zv()&&i===Zv();r||s?(this.__subscribe(),_F(this,Zv())):o&&this.__subscribe(!1)}disconnectedCallback(){super.disconnectedCallback(),this.__subscribe(!1),this.removeAttribute("dir")}__subscribe(e=!0){e?Ep.indexOf(this)===-1&&Ep.push(this):Ep.indexOf(this)>-1&&Ep.splice(Ep.indexOf(this),1)}__getNormalizedScrollLeft(e){return QO.getNormalizedScrollLeft(YI,this.getAttribute("dir")||"ltr",e)}__setNormalizedScrollLeft(e,i){return QO.setNormalizedScrollLeft(YI,this.getAttribute("dir")||"ltr",e,i)}},Z9e=/\/\*\*\s+vaadin-dev-mode:start([\s\S]*)vaadin-dev-mode:end\s+\*\*\//i,sE=window.Vaadin&&window.Vaadin.Flow&&window.Vaadin.Flow.clients;function Y9e(){function t(){return!0}return Pue(t)}function X9e(){try{return!!K9e()||!!Q9e()&&(sE?!eUe():!Y9e())}catch{return!1}}function K9e(){return localStorage.getItem("vaadin.developmentmode.force")}function Q9e(){return["localhost","127.0.0.1"].indexOf(window.location.hostname)>=0}function eUe(){return!!(sE&&Object.keys(sE).map(t=>sE[t]).filter(t=>t.productionMode).length>0)}function Pue(t,e){if(typeof t!="function")return;const i=Z9e.exec(t.toString());if(i)try{t=new Function(i[1])}catch(n){console.log("vaadin-development-mode-detector: uncommentAndRun() failed",n)}return t(e)}window.Vaadin=window.Vaadin||{};const YW=function(t,e){if(window.Vaadin.developmentMode)return Pue(t,e)};function tUe(){}window.Vaadin.developmentMode===void 0&&(window.Vaadin.developmentMode=X9e());const XW=function(){if(typeof YW=="function")return YW(tUe)};let eL;window.Vaadin||(window.Vaadin={}),window.Vaadin.registrations=window.Vaadin.registrations||[],window.Vaadin.developmentModeCallback=window.Vaadin.developmentModeCallback||{},window.Vaadin.developmentModeCallback["vaadin-usage-statistics"]=function(){XW&&XW()};const KW=new Set,kue=t=>class extends T8(t){static finalize(){super.finalize();const{is:e}=this;e&&!KW.has(e)&&(window.Vaadin.registrations.push(this),KW.add(e),window.Vaadin.developmentModeCallback&&(eL=Tn.debounce(eL,fue,()=>{window.Vaadin.developmentModeCallback["vaadin-usage-statistics"]()}),mk(eL)))}constructor(){super(),document.doctype===null&&console.warn('Vaadin components require the "standards mode" declaration. Please add <!DOCTYPE html> to the HTML document.')}};class QW extends kue(W9e(S8(yT(_d)))){static get template(){return mT`
      <style>
        :host {
          display: inline-block;
        }

        :host([hidden]) {
          display: none !important;
        }

        label {
          display: inline-flex;
          align-items: baseline;
          outline: none;
        }

        [part='checkbox'] {
          position: relative;
          display: inline-block;
          flex: none;
        }

        input[type='checkbox'] {
          position: absolute;
          top: 0;
          left: 0;
          right: 0;
          width: 100%;
          height: 100%;
          opacity: 0;
          cursor: inherit;
          margin: 0;
        }

        :host([disabled]) {
          -webkit-tap-highlight-color: transparent;
        }
      </style>

      <label>
        <span part="checkbox">
          <input
            type="checkbox"
            checked="{{checked::change}}"
            disabled$="[[disabled]]"
            indeterminate="{{indeterminate::change}}"
            role="presentation"
            tabindex="-1"
          />
        </span>

        <span part="label">
          <slot></slot>
        </span>
      </label>
    `}static get is(){return"vaadin-checkbox"}static get version(){return"3.0.0"}static get properties(){return{checked:{type:Boolean,value:!1,notify:!0,observer:"_checkedChanged",reflectToAttribute:!0},indeterminate:{type:Boolean,notify:!0,observer:"_indeterminateChanged",reflectToAttribute:!0,value:!1},value:{type:String,value:"on"},_nativeCheckbox:{type:Object}}}constructor(){super(),this.name}get name(){return this.checked?this._storedName:""}set name(e){this._storedName=e}ready(){super.ready(),this.setAttribute("role","checkbox"),this._nativeCheckbox=this.shadowRoot.querySelector('input[type="checkbox"]'),this.addEventListener("click",this._handleClick.bind(this)),this._addActiveListeners();const e=this.getAttribute("name");e&&(this.name=e),this.shadowRoot.querySelector('[part~="label"]').querySelector("slot").addEventListener("slotchange",this._updateLabelAttribute.bind(this)),this._updateLabelAttribute()}_updateLabelAttribute(){const e=this.shadowRoot.querySelector('[part~="label"]'),i=e.firstElementChild.assignedNodes();this._isAssignedNodesEmpty(i)?e.setAttribute("empty",""):e.removeAttribute("empty")}_isAssignedNodesEmpty(e){return e.length===0||e.length==1&&e[0].nodeType==Node.TEXT_NODE&&e[0].textContent.trim()===""}_checkedChanged(e){this.indeterminate?this.setAttribute("aria-checked","mixed"):this.setAttribute("aria-checked",!!e)}_indeterminateChanged(e){e?this.setAttribute("aria-checked","mixed"):this.setAttribute("aria-checked",this.checked)}_addActiveListeners(){this._addEventListenerToNode(this,"down",e=>{this.__interactionsAllowed(e)&&this.setAttribute("active","")}),this._addEventListenerToNode(this,"up",()=>this.removeAttribute("active")),this.addEventListener("keydown",e=>{this.__interactionsAllowed(e)&&e.keyCode===32&&(e.preventDefault(),this.setAttribute("active",""))}),this.addEventListener("keyup",e=>{this.__interactionsAllowed(e)&&e.keyCode===32&&(e.preventDefault(),this._toggleChecked(),this.removeAttribute("active"),this.indeterminate&&(this.indeterminate=!1))})}get focusElement(){return this.shadowRoot.querySelector("input")}__interactionsAllowed(e){return!this.disabled&&e.target.localName!=="a"}_handleClick(e){this.__interactionsAllowed(e)&&(this.indeterminate?(this.indeterminate=!1,e.preventDefault(),this._toggleChecked()):e.composedPath()[0]!==this._nativeCheckbox&&(e.preventDefault(),this._toggleChecked()))}_toggleChecked(){this.checked=!this.checked,this.dispatchEvent(new CustomEvent("change",{composed:!1,bubbles:!0}))}}customElements.define(QW.is,QW),cS("vaadin-grid",lS`
    :host {
      font-family: var(--lumo-font-family);
      font-size: var(--lumo-font-size-m);
      line-height: var(--lumo-line-height-s);
      color: var(--lumo-body-text-color);
      background-color: var(--lumo-base-color);
      box-sizing: border-box;
      -webkit-text-size-adjust: 100%;
      -webkit-tap-highlight-color: transparent;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;

      /* For internal use only */
      --_lumo-grid-border-color: var(--lumo-contrast-20pct);
      --_lumo-grid-secondary-border-color: var(--lumo-contrast-10pct);
      --_lumo-grid-border-width: 1px;
      --_lumo-grid-selected-row-color: var(--lumo-primary-color-10pct);
    }

    /* No (outer) border */

    :host(:not([theme~='no-border'])) {
      border: var(--_lumo-grid-border-width) solid var(--_lumo-grid-border-color);
    }

    /* Cell styles */

    [part~='cell'] {
      min-height: var(--lumo-size-m);
      background-color: var(--lumo-base-color);
    }

    [part~='cell'] ::slotted(vaadin-grid-cell-content) {
      cursor: default;
      padding: var(--lumo-space-xs) var(--lumo-space-m);
    }

    /* Apply row borders by default and introduce the "no-row-borders" variant */
    :host(:not([theme~='no-row-borders'])) [part~='cell']:not([part~='details-cell']) {
      border-top: var(--_lumo-grid-border-width) solid var(--_lumo-grid-secondary-border-color);
    }

    /* Hide first body row top border */
    :host(:not([theme~='no-row-borders'])) [part='row'][first] [part~='cell']:not([part~='details-cell']) {
      border-top: 0;
      min-height: calc(var(--lumo-size-m) - var(--_lumo-grid-border-width));
    }

    /* Focus-ring */

    [part~='cell']:focus {
      outline: none;
    }

    :host([navigating]) [part~='cell']:focus::before {
      content: '';
      position: absolute;
      top: 0;
      right: 0;
      bottom: 0;
      left: 0;
      pointer-events: none;
      box-shadow: inset 0 0 0 2px var(--lumo-primary-color-50pct);
    }

    /* Drag and Drop styles */
    :host([dragover])::after {
      content: '';
      position: absolute;
      z-index: 100;
      top: 0;
      right: 0;
      bottom: 0;
      left: 0;
      pointer-events: none;
      box-shadow: inset 0 0 0 2px var(--lumo-primary-color-50pct);
    }

    [part~='row'][dragover] {
      z-index: 100 !important;
    }

    [part~='row'][dragover] [part~='cell'] {
      overflow: visible;
    }

    [part~='row'][dragover] [part~='cell']::after {
      content: '';
      position: absolute;
      top: 0;
      right: 0;
      bottom: 0;
      left: 0;
      height: calc(var(--_lumo-grid-border-width) + 2px);
      pointer-events: none;
      background: var(--lumo-primary-color-50pct);
    }

    :host([theme~='no-row-borders']) [dragover] [part~='cell']::after {
      height: 2px;
    }

    [part~='row'][dragover='below'] [part~='cell']::after {
      top: 100%;
      bottom: auto;
      margin-top: -1px;
    }

    [part~='row'][dragover='above'] [part~='cell']::after {
      top: auto;
      bottom: 100%;
      margin-bottom: -1px;
    }

    [part~='row'][details-opened][dragover='below'] [part~='cell']:not([part~='details-cell'])::after,
    [part~='row'][details-opened][dragover='above'] [part~='details-cell']::after {
      display: none;
    }

    [part~='row'][dragover][dragover='on-top'] [part~='cell']::after {
      height: 100%;
    }

    [part~='row'][dragstart] {
      /* Add bottom-space to the row so the drag number doesn't get clipped. Needed for IE/Edge */
      border-bottom: 100px solid transparent;
      z-index: 100 !important;
      opacity: 0.9;
    }

    [part~='row'][dragstart] [part~='cell'] {
      border: none !important;
      box-shadow: none !important;
    }

    [part~='row'][dragstart] [part~='cell'][last-column] {
      border-radius: 0 var(--lumo-border-radius-s) var(--lumo-border-radius-s) 0;
    }

    [part~='row'][dragstart] [part~='cell'][first-column] {
      border-radius: var(--lumo-border-radius-s) 0 0 var(--lumo-border-radius-s);
    }

    [ios] [part~='row'][dragstart] [part~='cell'] {
      background: var(--lumo-primary-color-50pct);
    }

    #scroller:not([ios]) [part~='row'][dragstart]:not([dragstart=''])::after {
      display: block;
      position: absolute;
      left: var(--_grid-drag-start-x);
      top: var(--_grid-drag-start-y);
      z-index: 100;
      content: attr(dragstart);
      align-items: center;
      justify-content: center;
      box-sizing: border-box;
      padding: calc(var(--lumo-space-xs) * 0.8);
      color: var(--lumo-error-contrast-color);
      background-color: var(--lumo-error-color);
      border-radius: var(--lumo-border-radius-m);
      font-family: var(--lumo-font-family);
      font-size: var(--lumo-font-size-xxs);
      line-height: 1;
      font-weight: 500;
      text-transform: initial;
      letter-spacing: initial;
      min-width: calc(var(--lumo-size-s) * 0.7);
      text-align: center;
    }

    /* Headers and footers */

    [part~='header-cell'] ::slotted(vaadin-grid-cell-content),
    [part~='footer-cell'] ::slotted(vaadin-grid-cell-content),
    [part~='reorder-ghost'] {
      font-size: var(--lumo-font-size-s);
      font-weight: 500;
    }

    [part~='footer-cell'] ::slotted(vaadin-grid-cell-content) {
      font-weight: 400;
    }

    [part='row']:only-child [part~='header-cell'] {
      min-height: var(--lumo-size-xl);
    }

    /* Header borders */

    /* Hide first header row top border */
    :host(:not([theme~='no-row-borders'])) [part='row']:first-child [part~='header-cell'] {
      border-top: 0;
    }

    [part='row']:last-child [part~='header-cell'] {
      border-bottom: var(--_lumo-grid-border-width) solid transparent;
    }

    :host(:not([theme~='no-row-borders'])) [part='row']:last-child [part~='header-cell'] {
      border-bottom-color: var(--_lumo-grid-secondary-border-color);
    }

    /* Overflow uses a stronger border color */
    :host([overflow~='top']) [part='row']:last-child [part~='header-cell'] {
      border-bottom-color: var(--_lumo-grid-border-color);
    }

    /* Footer borders */

    [part='row']:first-child [part~='footer-cell'] {
      border-top: var(--_lumo-grid-border-width) solid transparent;
    }

    :host(:not([theme~='no-row-borders'])) [part='row']:first-child [part~='footer-cell'] {
      border-top-color: var(--_lumo-grid-secondary-border-color);
    }

    /* Overflow uses a stronger border color */
    :host([overflow~='bottom']) [part='row']:first-child [part~='footer-cell'] {
      border-top-color: var(--_lumo-grid-border-color);
    }

    /* Column reordering */

    :host([reordering]) [part~='cell'] {
      background: linear-gradient(var(--lumo-shade-20pct), var(--lumo-shade-20pct)) var(--lumo-base-color);
    }

    :host([reordering]) [part~='cell'][reorder-status='allowed'] {
      background: var(--lumo-base-color);
    }

    :host([reordering]) [part~='cell'][reorder-status='dragging'] {
      background: linear-gradient(var(--lumo-contrast-5pct), var(--lumo-contrast-5pct)) var(--lumo-base-color);
    }

    [part~='reorder-ghost'] {
      opacity: 0.85;
      box-shadow: var(--lumo-box-shadow-s);
      /* TODO Use the same styles as for the cell element (reorder-ghost copies styles from the cell element) */
      padding: var(--lumo-space-s) var(--lumo-space-m) !important;
    }

    /* Column resizing */

    [part='resize-handle'] {
      width: 3px;
      background-color: var(--lumo-primary-color-50pct);
      opacity: 0;
      transition: opacity 0.2s;
    }

    :host(:not([reordering])) *:not([column-resizing]) [part~='cell']:hover [part='resize-handle'],
    [part='resize-handle']:active {
      opacity: 1;
      transition-delay: 0.15s;
    }

    /* Column borders */

    :host([theme~='column-borders']) [part~='cell']:not([last-column]):not([part~='details-cell']) {
      border-right: var(--_lumo-grid-border-width) solid var(--_lumo-grid-secondary-border-color);
    }

    /* Frozen columns */

    [last-frozen] {
      border-right: var(--_lumo-grid-border-width) solid transparent;
      overflow: hidden;
    }

    :host([overflow~='left']) [part~='cell'][last-frozen]:not([part~='details-cell']) {
      border-right-color: var(--_lumo-grid-border-color);
    }

    /* Row stripes */

    :host([theme~='row-stripes']) [part~='row']:not([odd]) [part~='body-cell'],
    :host([theme~='row-stripes']) [part~='row']:not([odd]) [part~='details-cell'] {
      background-image: linear-gradient(var(--lumo-contrast-5pct), var(--lumo-contrast-5pct));
      background-repeat: repeat-x;
    }

    /* Selected row */

    /* Raise the selected rows above unselected rows (so that box-shadow can cover unselected rows) */
    :host(:not([reordering])) [part~='row'][selected] {
      z-index: 1;
    }

    :host(:not([reordering])) [part~='row'][selected] [part~='body-cell']:not([part~='details-cell']) {
      background-image: linear-gradient(var(--_lumo-grid-selected-row-color), var(--_lumo-grid-selected-row-color));
      background-repeat: repeat;
    }

    /* Cover the border of an unselected row */
    :host(:not([theme~='no-row-borders'])) [part~='row'][selected] [part~='cell']:not([part~='details-cell']) {
      box-shadow: 0 var(--_lumo-grid-border-width) 0 0 var(--_lumo-grid-selected-row-color);
    }

    /* Compact */

    :host([theme~='compact']) [part='row']:only-child [part~='header-cell'] {
      min-height: var(--lumo-size-m);
    }

    :host([theme~='compact']) [part~='cell'] {
      min-height: var(--lumo-size-s);
    }

    :host([theme~='compact']) [part='row'][first] [part~='cell']:not([part~='details-cell']) {
      min-height: calc(var(--lumo-size-s) - var(--_lumo-grid-border-width));
    }

    :host([theme~='compact']) [part~='cell'] ::slotted(vaadin-grid-cell-content) {
      padding: var(--lumo-space-xs) var(--lumo-space-s);
    }

    /* Wrap cell contents */

    :host([theme~='wrap-cell-content']) [part~='cell'] ::slotted(vaadin-grid-cell-content) {
      white-space: normal;
    }

    /* RTL specific styles */

    :host([dir='rtl']) [part~='row'][dragstart] [part~='cell'][last-column] {
      border-radius: var(--lumo-border-radius-s) 0 0 var(--lumo-border-radius-s);
    }

    :host([dir='rtl']) [part~='row'][dragstart] [part~='cell'][first-column] {
      border-radius: 0 var(--lumo-border-radius-s) var(--lumo-border-radius-s) 0;
    }

    :host([dir='rtl'][theme~='column-borders']) [part~='cell']:not([last-column]):not([part~='details-cell']) {
      border-right: none;
      border-left: var(--_lumo-grid-border-width) solid var(--_lumo-grid-secondary-border-color);
    }

    :host([dir='rtl']) [last-frozen] {
      border-right: none;
      border-left: var(--_lumo-grid-border-width) solid transparent;
    }

    :host([dir='rtl'][overflow~='right']) [part~='cell'][last-frozen]:not([part~='details-cell']) {
      border-left-color: var(--_lumo-grid-border-color);
    }
  `,{moduleId:"lumo-grid"}),cS("vaadin-checkbox",lS`
    :host(.vaadin-grid-select-all-checkbox) {
      font-size: var(--lumo-font-size-m);
    }
  `,{moduleId:"vaadin-grid-select-all-checkbox-lumo"});let c$=!1,Oue=[],Lue=[];function Rue(){c$=!0,requestAnimationFrame(function(){c$=!1,iUe(Oue),setTimeout(function(){nUe(Lue)})})}function iUe(t){for(;t.length;)Due(t.shift())}function nUe(t){for(let e=0,i=t.length;e<i;e++)Due(t.shift())}function Due(t){const e=t[0],i=t[1],n=t[2];try{i.apply(e,n)}catch(r){setTimeout(()=>{throw r})}}function rUe(t,e,i){c$||Rue(),Oue.push([t,e,i])}function sUe(t,e,i){c$||Rue(),Lue.push([t,e,i])}class eJ{constructor(){this.start=0,this.end=0,this.previous=null,this.parent=null,this.rules=null,this.parsedCssText="",this.cssText="",this.atRule=!1,this.type=0,this.keyframesName="",this.selector="",this.parsedSelector=""}}function Nue(t){return Fue(aUe(t=oUe(t)),t)}function oUe(t){return t.replace(Xh.comments,"").replace(Xh.port,"")}function aUe(t){let e=new eJ;e.start=0,e.end=t.length;let i=e;for(let n=0,r=t.length;n<r;n++)if(t[n]===Vue){i.rules||(i.rules=[]);let s=i,o=s.rules[s.rules.length-1]||null;i=new eJ,i.start=n+1,i.parent=s,i.previous=o,s.rules.push(i)}else t[n]===jue&&(i.end=n+1,i=i.parent||e);return e}function Fue(t,e){let i=e.substring(t.start,t.end-1);if(t.parsedCssText=t.cssText=i.trim(),t.parent){let r=t.previous?t.previous.end:t.parent.start;i=e.substring(r,t.start-1),i=lUe(i),i=i.replace(Xh.multipleSpaces," "),i=i.substring(i.lastIndexOf(";")+1);let s=t.parsedSelector=t.selector=i.trim();t.atRule=s.indexOf(fUe)===0,t.atRule?s.indexOf(pUe)===0?t.type=mf.MEDIA_RULE:s.match(Xh.keyframesRule)&&(t.type=mf.KEYFRAMES_RULE,t.keyframesName=t.selector.split(Xh.multipleSpaces).pop()):s.indexOf(Bue)===0?t.type=mf.MIXIN_RULE:t.type=mf.STYLE_RULE}let n=t.rules;if(n)for(let r,s=0,o=n.length;s<o&&(r=n[s]);s++)Fue(r,e);return t}function lUe(t){return t.replace(/\\([0-9a-f]{1,6})\s/gi,function(){let e=arguments[1],i=6-e.length;for(;i--;)e="0"+e;return"\\"+e})}function zue(t,e,i=""){let n="";if(t.cssText||t.rules){let r=t.rules;if(r&&!cUe(r))for(let s,o=0,a=r.length;o<a&&(s=r[o]);o++)n=zue(s,e,n);else n=e?t.cssText:uUe(t.cssText),n=n.trim(),n&&(n="  "+n+`
`)}return n&&(t.selector&&(i+=t.selector+" "+Vue+`
`),i+=n,t.selector&&(i+=jue+`

`)),i}function cUe(t){let e=t[0];return!!e&&!!e.selector&&e.selector.indexOf(Bue)===0}function uUe(t){return dUe(t=hUe(t))}function hUe(t){return t.replace(Xh.customProp,"").replace(Xh.mixinProp,"")}function dUe(t){return t.replace(Xh.mixinApply,"").replace(Xh.varApply,"")}const mf={STYLE_RULE:1,KEYFRAMES_RULE:7,MEDIA_RULE:4,MIXIN_RULE:1e3},Vue="{",jue="}",Xh={comments:/\/\*[^*]*\*+([^/*][^*]*\*+)*\//gim,port:/@import[^;]*;/gim,customProp:/(?:^[^;\-\s}]+)?--[^;{}]*?:[^{};]*?(?:[;\n]|$)/gim,mixinProp:/(?:^[^;\-\s}]+)?--[^;{}]*?:[^{};]*?{[^}]*?}(?:[;\n]|$)?/gim,mixinApply:/@apply\s*\(?[^);]*\)?\s*(?:[;\n]|$)?/gim,varApply:/[^;:]*?:[^;]*?var\([^;]*\)(?:[;\n]|$)?/gim,keyframesRule:/^@[^\s]*keyframes/,multipleSpaces:/\s+/g},Bue="--",pUe="@media",fUe="@",tJ=new Set,mUe="shady-unscoped";function gUe(t){const e=t.textContent;if(!tJ.has(e)){tJ.add(e);const i=document.createElement("style");i.setAttribute("shady-unscoped",""),i.textContent=e,document.head.appendChild(i)}}function yUe(t){return t.hasAttribute(mUe)}function bF(t,e){return t?(typeof t=="string"&&(t=Nue(t)),e&&n2(t,e),zue(t,s8)):""}function iJ(t){return!t.__cssRules&&t.textContent&&(t.__cssRules=Nue(t.textContent)),t.__cssRules||null}function n2(t,e,i,n){if(!t)return;let r=!1,s=t.type;if(n&&s===mf.MEDIA_RULE){let a=t.selector.match(J8e);a&&(window.matchMedia(a[1]).matches||(r=!0))}s===mf.STYLE_RULE?e(t):i&&s===mf.KEYFRAMES_RULE?i(t):s===mf.MIXIN_RULE&&(r=!0);let o=t.rules;if(o&&!r)for(let a,l=0,c=o.length;l<c&&(a=o[l]);l++)n2(a,e,i,n)}function vUe(t,e){let i=0;for(let n=e,r=t.length;n<r;n++)if(t[n]==="(")i++;else if(t[n]===")"&&--i==0)return n;return-1}function Uue(t,e){let i=t.indexOf("var(");if(i===-1)return e(t,"","","");let n=vUe(t,i+3),r=t.substring(i+4,n),s=t.substring(0,i),o=Uue(t.substring(n+1),e),a=r.indexOf(",");return a===-1?e(s,r.trim(),"",o):e(s,r.substring(0,a).trim(),r.substring(a+1).trim(),o)}function _Ue(t){let e=t.localName,i="",n="";return e?e.indexOf("-")>-1?i=e:(n=e,i=t.getAttribute&&t.getAttribute("is")||""):(i=t.is,n=t.extends),{is:i,typeExtension:n}}function bUe(t){const e=[],i=t.querySelectorAll("style");for(let n=0;n<i.length;n++){const r=i[n];yUe(r)?uk||(gUe(r),r.parentNode.removeChild(r)):(e.push(r.textContent),r.parentNode.removeChild(r))}return e.join("").trim()}window.ShadyDOM&&window.ShadyDOM.wrap;const Gue="css-build";function wUe(t){if(sS!==void 0)return sS;if(t.__cssBuild===void 0){const e=t.getAttribute(Gue);if(e)t.__cssBuild=e;else{const i=xUe(t);i!==""&&SUe(t),t.__cssBuild=i}}return t.__cssBuild||""}function nJ(t){return wUe(t)!==""}function xUe(t){const e=t.localName==="template"?t.content.firstChild:t.firstChild;if(e instanceof Comment){const i=e.textContent.trim().split(":");if(i[0]===Gue)return i[1]}return""}function SUe(t){const e=t.localName==="template"?t.content.firstChild:t.firstChild;e.parentNode.removeChild(e)}const TUe=/;\s*/m,IUe=/^\s*(initial)|(inherit)\s*$/,rJ=/\s*!important/,wF="_-_";class CUe{constructor(){this._map={}}set(e,i){e=e.trim(),this._map[e]={properties:i,dependants:{}}}get(e){return e=e.trim(),this._map[e]||null}}let u$=null;class Js{constructor(){this._currentElement=null,this._measureElement=null,this._map=new CUe}detectMixin(e){return Z8e(e)}gatherStyles(e){const i=bUe(e.content);if(i){const n=document.createElement("style");return n.textContent=i,e.content.insertBefore(n,e.content.firstChild),n}return null}transformTemplate(e,i){e._gatheredStyle===void 0&&(e._gatheredStyle=this.gatherStyles(e));const n=e._gatheredStyle;return n?this.transformStyle(n,i):null}transformStyle(e,i=""){let n=iJ(e);return this.transformRules(n,i),e.textContent=bF(n),n}transformCustomStyle(e){let i=iJ(e);return n2(i,n=>{n.selector===":root"&&(n.selector="html"),this.transformRule(n)}),e.textContent=bF(i),i}transformRules(e,i){this._currentElement=i,n2(e,n=>{this.transformRule(n)}),this._currentElement=null}transformRule(e){e.cssText=this.transformCssText(e.parsedCssText,e),e.selector===":root"&&(e.selector=":host > *")}transformCssText(e,i){return e=e.replace(rF,(n,r,s,o)=>this._produceCssProperties(n,r,s,o,i)),this._consumeCssProperties(e,i)}_getInitialValueForProperty(e){return this._measureElement||(this._measureElement=document.createElement("meta"),this._measureElement.setAttribute("apply-shim-measure",""),this._measureElement.style.all="initial",document.head.appendChild(this._measureElement)),window.getComputedStyle(this._measureElement).getPropertyValue(e)}_fallbacksFromPreviousRules(e){let i=e;for(;i.parent;)i=i.parent;const n={};let r=!1;return n2(i,s=>{r=r||s===e,r||s.selector===e.selector&&Object.assign(n,this._cssTextToMap(s.parsedCssText))}),n}_consumeCssProperties(e,i){let n=null;for(;n=i$.exec(e);){let r=n[0],s=n[1],o=n.index,a=o+r.indexOf("@apply"),l=o+r.length,c=e.slice(0,a),u=e.slice(l),d=i?this._fallbacksFromPreviousRules(i):{};Object.assign(d,this._cssTextToMap(c));let f=this._atApplyToCssProperties(s,d);e=`${c}${f}${u}`,i$.lastIndex=o+f.length}return e}_atApplyToCssProperties(e,i){e=e.replace(TUe,"");let n=[],r=this._map.get(e);if(r||(this._map.set(e,{}),r=this._map.get(e)),r){let s,o,a;this._currentElement&&(r.dependants[this._currentElement]=!0);const l=r.properties;for(s in l)a=i&&i[s],o=[s,": var(",e,wF,s],a&&o.push(",",a.replace(rJ,"")),o.push(")"),rJ.test(l[s])&&o.push(" !important"),n.push(o.join(""))}return n.join("; ")}_replaceInitialOrInherit(e,i){let n=IUe.exec(i);return n&&(i=n[1]?this._getInitialValueForProperty(e):"apply-shim-inherit"),i}_cssTextToMap(e,i=!1){let n,r,s=e.split(";"),o={};for(let a,l,c=0;c<s.length;c++)a=s[c],a&&(l=a.split(":"),l.length>1&&(n=l[0].trim(),r=l.slice(1).join(":"),i&&(r=this._replaceInitialOrInherit(n,r)),o[n]=r));return o}_invalidateMixinEntry(e){if(u$)for(let i in e.dependants)i!==this._currentElement&&u$(i)}_produceCssProperties(e,i,n,r,s){if(n&&Uue(n,(_,b)=>{b&&this._map.get(b)&&(r=`@apply ${b};`)}),!r)return e;let o=this._consumeCssProperties(""+r,s),a=e.slice(0,e.indexOf("--")),l=this._cssTextToMap(o,!0),c=l,u=this._map.get(i),d=u&&u.properties;d?c=Object.assign(Object.create(d),l):this._map.set(i,c);let f,m,g=[],y=!1;for(f in c)m=l[f],m===void 0&&(m="initial"),d&&!(f in d)&&(y=!0),g.push(`${i}${wF}${f}: ${m}`);return y&&this._invalidateMixinEntry(u),u&&(u.properties=c),n&&(a=`${e};${a}`),`${a}${g.join("; ")};`}}Js.prototype.detectMixin=Js.prototype.detectMixin,Js.prototype.transformStyle=Js.prototype.transformStyle,Js.prototype.transformCustomStyle=Js.prototype.transformCustomStyle,Js.prototype.transformRules=Js.prototype.transformRules,Js.prototype.transformRule=Js.prototype.transformRule,Js.prototype.transformTemplate=Js.prototype.transformTemplate,Js.prototype._separator=wF,Object.defineProperty(Js.prototype,"invalidCallback",{get:()=>u$,set(t){u$=t}});const xF={},h$="_applyShimCurrentVersion",Tb="_applyShimNextVersion",d$="_applyShimValidatingVersion",MUe=Promise.resolve();function EUe(t){let e=xF[t];e&&AUe(e)}function AUe(t){t[h$]=t[h$]||0,t[d$]=t[d$]||0,t[Tb]=(t[Tb]||0)+1}function Hue(t){return t[h$]===t[Tb]}function $Ue(t){return!Hue(t)&&t[d$]===t[Tb]}function PUe(t){t[d$]=t[Tb],t._validating||(t._validating=!0,MUe.then(function(){t[h$]=t[Tb],t._validating=!1}))}const px=new Js;class kUe{constructor(){this.customStyleInterface=null,px.invalidCallback=EUe}ensure(){this.customStyleInterface||window.ShadyCSS.CustomStyleInterface&&(this.customStyleInterface=window.ShadyCSS.CustomStyleInterface,this.customStyleInterface.transformCallback=e=>{px.transformCustomStyle(e)},this.customStyleInterface.validateCallback=()=>{requestAnimationFrame(()=>{this.customStyleInterface.enqueued&&this.flushCustomStyles()})})}prepareTemplate(e,i){if(this.ensure(),nJ(e))return;xF[i]=e;let n=px.transformTemplate(e,i);e._styleAst=n}flushCustomStyles(){if(this.ensure(),!this.customStyleInterface)return;let e=this.customStyleInterface.processStyles();if(this.customStyleInterface.enqueued){for(let i=0;i<e.length;i++){let n=e[i],r=this.customStyleInterface.getStyleForCustomStyle(n);r&&px.transformCustomStyle(r)}this.customStyleInterface.enqueued=!1}}styleSubtree(e,i){if(this.ensure(),i&&sF(e,i),e.shadowRoot){this.styleElement(e);let n=e.shadowRoot.children||e.shadowRoot.childNodes;for(let r=0;r<n.length;r++)this.styleSubtree(n[r])}else{let n=e.children||e.childNodes;for(let r=0;r<n.length;r++)this.styleSubtree(n[r])}}styleElement(e){this.ensure();let{is:i}=_Ue(e),n=xF[i];if((!n||!nJ(n))&&n&&!Hue(n)){$Ue(n)||(this.prepareTemplate(n,i),PUe(n));let r=e.shadowRoot;if(r){let s=r.querySelector("style");s&&(s.__cssRules=n._styleAst,s.textContent=bF(n._styleAst))}}}styleDocument(e){this.ensure(),this.styleSubtree(document.body,e)}}if(!window.ShadyCSS||!window.ShadyCSS.ScopingShim){const t=new kUe;let e=window.ShadyCSS&&window.ShadyCSS.CustomStyleInterface;window.ShadyCSS={prepareTemplate(i,n,r){t.flushCustomStyles(),t.prepareTemplate(i,n)},prepareTemplateStyles(i,n,r){window.ShadyCSS.prepareTemplate(i,n,r)},prepareTemplateDom(i,n){},styleSubtree(i,n){t.flushCustomStyles(),t.styleSubtree(i,n)},styleElement(i){t.flushCustomStyles(),t.styleElement(i)},styleDocument(i){t.flushCustomStyles(),t.styleDocument(i)},getComputedStyleValue:(i,n)=>Yce(i,n),flushCustomStyles(){t.flushCustomStyles()},nativeCss:s8,nativeShadow:uk,cssBuild:sS,disableRuntime:Xce},e&&(window.ShadyCSS.CustomStyleInterface=e)}window.ShadyCSS.ApplyShim=px;const OUe=/:host\(:dir\((ltr|rtl)\)\)/g,LUe=':host([dir="$1"])',RUe=/([\s\w-#\.\[\]\*]*):dir\((ltr|rtl)\)/g,DUe=':host([dir="$2"]) $1',NUe=/:dir\((?:ltr|rtl)\)/,sJ=!!(window.ShadyDOM&&window.ShadyDOM.inUse),r2=[];let s2=null,I8="";function que(){I8=document.documentElement.getAttribute("dir")}function Wue(t){t.__autoDirOptOut||t.setAttribute("dir",I8)}function Jue(){que(),I8=document.documentElement.getAttribute("dir");for(let t=0;t<r2.length;t++)Wue(r2[t])}function FUe(){s2&&s2.takeRecords().length&&Jue()}const zUe=Sa(t=>{sJ||s2||(que(),s2=new MutationObserver(Jue),s2.observe(document.documentElement,{attributes:!0,attributeFilter:["dir"]}));const e=yue(t);class i extends e{static _processStyleText(r,s){return r=e._processStyleText.call(this,r,s),!sJ&&NUe.test(r)&&(r=this._replaceDirInCssText(r),this.__activateDir=!0),r}static _replaceDirInCssText(r){let s=r;return s=s.replace(OUe,LUe),s=s.replace(RUe,DUe),s}constructor(){super(),this.__autoDirOptOut=!1}ready(){super.ready(),this.__autoDirOptOut=this.hasAttribute("dir")}connectedCallback(){e.prototype.connectedCallback&&super.connectedCallback(),this.constructor.__activateDir&&(FUe(),r2.push(this),Wue(this))}disconnectedCallback(){if(e.prototype.disconnectedCallback&&super.disconnectedCallback(),this.constructor.__activateDir){const r=r2.indexOf(this);r>-1&&r2.splice(r,1)}}}return i.__activateDir=!1,i});function oJ(){document.body.removeAttribute("unresolved")}function j1(t,e,i){return{index:t,removed:e,addedCount:i}}document.readyState==="interactive"||document.readyState==="complete"?oJ():window.addEventListener("DOMContentLoaded",oJ);const Zue=0,Yue=1,SF=2,TF=3;function VUe(t,e,i,n,r,s){let o=s-r+1,a=i-e+1,l=new Array(o);for(let c=0;c<o;c++)l[c]=new Array(a),l[c][0]=c;for(let c=0;c<a;c++)l[0][c]=c;for(let c=1;c<o;c++)for(let u=1;u<a;u++)if(C8(t[e+u-1],n[r+c-1]))l[c][u]=l[c-1][u-1];else{let d=l[c-1][u]+1,f=l[c][u-1]+1;l[c][u]=d<f?d:f}return l}function jUe(t){let e=t.length-1,i=t[0].length-1,n=t[e][i],r=[];for(;e>0||i>0;){if(e==0){r.push(SF),i--;continue}if(i==0){r.push(TF),e--;continue}let s,o=t[e-1][i-1],a=t[e-1][i],l=t[e][i-1];s=a<l?a<o?a:o:l<o?l:o,s==o?(o==n?r.push(Zue):(r.push(Yue),n=o),e--,i--):s==a?(r.push(TF),e--,n=a):(r.push(SF),i--,n=l)}return r.reverse(),r}function BUe(t,e,i,n,r,s){let o,a=0,l=0,c=Math.min(i-e,s-r);if(e==0&&r==0&&(a=UUe(t,n,c)),i==t.length&&s==n.length&&(l=GUe(t,n,c-a)),r+=a,s-=l,(i-=l)-(e+=a)==0&&s-r==0)return[];if(e==i){for(o=j1(e,[],0);r<s;)o.removed.push(n[r++]);return[o]}if(r==s)return[j1(e,[],i-e)];let u=jUe(VUe(t,e,i,n,r,s));o=void 0;let d=[],f=e,m=r;for(let g=0;g<u.length;g++)switch(u[g]){case Zue:o&&(d.push(o),o=void 0),f++,m++;break;case Yue:o||(o=j1(f,[],0)),o.addedCount++,f++,o.removed.push(n[m]),m++;break;case SF:o||(o=j1(f,[],0)),o.addedCount++,f++;break;case TF:o||(o=j1(f,[],0)),o.removed.push(n[m]),m++}return o&&d.push(o),d}function UUe(t,e,i){for(let n=0;n<i;n++)if(!C8(t[n],e[n]))return n;return i}function GUe(t,e,i){let n=t.length,r=e.length,s=0;for(;s<i&&C8(t[--n],e[--r]);)s++;return s}function Xue(t,e){return BUe(t,0,t.length,e,0,e.length)}function C8(t,e){return t===e}function z0(t){return t.localName==="slot"}let Kh=class{static getFlattenedNodes(t){const e=De(t);return z0(t)?e.assignedNodes({flatten:!0}):Array.from(e.childNodes).map(i=>z0(i)?De(i).assignedNodes({flatten:!0}):[i]).reduce((i,n)=>i.concat(n),[])}constructor(t,e){this._shadyChildrenObserver=null,this._nativeChildrenObserver=null,this._connected=!1,this._target=t,this.callback=e,this._effectiveNodes=[],this._observer=null,this._scheduled=!1,this._boundSchedule=()=>{this._schedule()},this.connect(),this._schedule()}connect(){z0(this._target)?this._listenSlots([this._target]):De(this._target).children&&(this._listenSlots(De(this._target).children),window.ShadyDOM?this._shadyChildrenObserver=window.ShadyDOM.observeChildren(this._target,t=>{this._processMutations(t)}):(this._nativeChildrenObserver=new MutationObserver(t=>{this._processMutations(t)}),this._nativeChildrenObserver.observe(this._target,{childList:!0}))),this._connected=!0}disconnect(){z0(this._target)?this._unlistenSlots([this._target]):De(this._target).children&&(this._unlistenSlots(De(this._target).children),window.ShadyDOM&&this._shadyChildrenObserver?(window.ShadyDOM.unobserveChildren(this._shadyChildrenObserver),this._shadyChildrenObserver=null):this._nativeChildrenObserver&&(this._nativeChildrenObserver.disconnect(),this._nativeChildrenObserver=null)),this._connected=!1}_schedule(){this._scheduled||(this._scheduled=!0,ul.run(()=>this.flush()))}_processMutations(t){this._processSlotMutations(t),this.flush()}_processSlotMutations(t){if(t)for(let e=0;e<t.length;e++){let i=t[e];i.addedNodes&&this._listenSlots(i.addedNodes),i.removedNodes&&this._unlistenSlots(i.removedNodes)}}flush(){if(!this._connected)return!1;window.ShadyDOM&&ShadyDOM.flush(),this._nativeChildrenObserver?this._processSlotMutations(this._nativeChildrenObserver.takeRecords()):this._shadyChildrenObserver&&this._processSlotMutations(this._shadyChildrenObserver.takeRecords()),this._scheduled=!1;let t={target:this._target,addedNodes:[],removedNodes:[]},e=this.constructor.getFlattenedNodes(this._target),i=Xue(e,this._effectiveNodes);for(let r,s=0;s<i.length&&(r=i[s]);s++)for(let o,a=0;a<r.removed.length&&(o=r.removed[a]);a++)t.removedNodes.push(o);for(let r,s=0;s<i.length&&(r=i[s]);s++)for(let o=r.index;o<r.index+r.addedCount;o++)t.addedNodes.push(e[o]);this._effectiveNodes=e;let n=!1;return(t.addedNodes.length||t.removedNodes.length)&&(n=!0,this.callback.call(this._target,t)),n}_listenSlots(t){for(let e=0;e<t.length;e++){let i=t[e];z0(i)&&i.addEventListener("slotchange",this._boundSchedule)}}_unlistenSlots(t){for(let e=0;e<t.length;e++){let i=t[e];z0(i)&&i.removeEventListener("slotchange",this._boundSchedule)}}};const V0=Element.prototype,HUe=V0.matches||V0.matchesSelector||V0.mozMatchesSelector||V0.msMatchesSelector||V0.oMatchesSelector||V0.webkitMatchesSelector,Kue=function(t,e){return HUe.call(t,e)};class hi{constructor(e){window.ShadyDOM&&window.ShadyDOM.inUse&&window.ShadyDOM.patch(e),this.node=e}observeNodes(e){return new Kh(this.node,e)}unobserveNodes(e){e.disconnect()}notifyObserver(){}deepContains(e){if(De(this.node).contains(e))return!0;let i=e,n=e.ownerDocument;for(;i&&i!==n&&i!==this.node;)i=De(i).parentNode||De(i).host;return i===this.node}getOwnerRoot(){return De(this.node).getRootNode()}getDistributedNodes(){return this.node.localName==="slot"?De(this.node).assignedNodes({flatten:!0}):[]}getDestinationInsertionPoints(){let e=[],i=De(this.node).assignedSlot;for(;i;)e.push(i),i=De(i).assignedSlot;return e}importNode(e,i){let n=this.node instanceof Document?this.node:this.node.ownerDocument;return De(n).importNode(e,i)}getEffectiveChildNodes(){return Kh.getFlattenedNodes(this.node)}queryDistributedElements(e){let i=this.getEffectiveChildNodes(),n=[];for(let r,s=0,o=i.length;s<o&&(r=i[s]);s++)r.nodeType===Node.ELEMENT_NODE&&Kue(r,e)&&n.push(r);return n}get activeElement(){let e=this.node;return e._activeElement!==void 0?e._activeElement:e.activeElement}}function qUe(t,e){for(let i=0;i<e.length;i++){let n=e[i];t[n]=function(){return this.node[n].apply(this.node,arguments)}}}function aJ(t,e){for(let i=0;i<e.length;i++){let n=e[i];Object.defineProperty(t,n,{get:function(){return this.node[n]},configurable:!0})}}function WUe(t,e){for(let i=0;i<e.length;i++){let n=e[i];Object.defineProperty(t,n,{get:function(){return this.node[n]},set:function(r){this.node[n]=r},configurable:!0})}}class IF{constructor(e){this.event=e}get rootTarget(){return this.path[0]}get localTarget(){return this.event.target}get path(){return this.event.composedPath()}}hi.prototype.cloneNode,hi.prototype.appendChild,hi.prototype.insertBefore,hi.prototype.removeChild,hi.prototype.replaceChild,hi.prototype.setAttribute,hi.prototype.removeAttribute,hi.prototype.querySelector,hi.prototype.querySelectorAll,hi.prototype.parentNode,hi.prototype.firstChild,hi.prototype.lastChild,hi.prototype.nextSibling,hi.prototype.previousSibling,hi.prototype.firstElementChild,hi.prototype.lastElementChild,hi.prototype.nextElementSibling,hi.prototype.previousElementSibling,hi.prototype.childNodes,hi.prototype.children,hi.prototype.classList,hi.prototype.textContent,hi.prototype.innerHTML;let CF=hi;if(window.ShadyDOM&&window.ShadyDOM.inUse&&window.ShadyDOM.noPatch&&window.ShadyDOM.Wrapper){class t extends window.ShadyDOM.Wrapper{}Object.getOwnPropertyNames(hi.prototype).forEach(e=>{e!="activeElement"&&(t.prototype[e]=hi.prototype[e])}),aJ(t.prototype,["classList"]),CF=t,Object.defineProperties(IF.prototype,{localTarget:{get(){const e=this.event.currentTarget,i=e&&gf(e).getOwnerRoot(),n=this.path;for(let r=0;r<n.length;r++){const s=n[r];if(gf(s).getOwnerRoot()===i)return s}},configurable:!0},path:{get(){return window.ShadyDOM.composedPath(this.event)},configurable:!0}})}else qUe(hi.prototype,["cloneNode","appendChild","insertBefore","removeChild","replaceChild","setAttribute","removeAttribute","querySelector","querySelectorAll"]),aJ(hi.prototype,["parentNode","firstChild","lastChild","nextSibling","previousSibling","firstElementChild","lastElementChild","nextElementSibling","previousElementSibling","childNodes","children","classList"]),WUe(hi.prototype,["textContent","innerHTML","className"]);const gf=function(t){if((t=t||document)instanceof CF||t instanceof IF)return t;let e=t.__domApi;return e||(e=t instanceof Event?new IF(t):new CF(t),t.__domApi=e),e},tL=window.ShadyDOM,lJ=window.ShadyCSS;function cJ(t,e){return De(t).getRootNode()===e}function JUe(t,e=!1){if(!tL||!lJ||!tL.handlesDynamicScoping)return null;const i=lJ.ScopingShim;if(!i)return null;const n=i.scopeForNode(t),r=De(t).getRootNode(),s=o=>{if(!cJ(o,r))return;const a=Array.from(tL.nativeMethods.querySelectorAll.call(o,"*"));a.push(o);for(let l=0;l<a.length;l++){const c=a[l];if(!cJ(c,r))continue;const u=i.currentScopeForNode(c);u!==n&&(u!==""&&i.unscopeNode(c,u),i.scopeNode(c,n))}};if(s(t),e){const o=new MutationObserver(a=>{for(let l=0;l<a.length;l++){const c=a[l];for(let u=0;u<c.addedNodes.length;u++){const d=c.addedNodes[u];d.nodeType===Node.ELEMENT_NODE&&s(d)}}});return o.observe(t,{childList:!0,subtree:!0}),o}return null}const iL="disable-upgrade",Que=t=>{for(;t;){const e=Object.getOwnPropertyDescriptor(t,"observedAttributes");if(e)return e.get;t=Object.getPrototypeOf(t.prototype).constructor}return()=>[]};Sa(t=>{const e=fk(t);let i=Que(e);class n extends e{constructor(){super(),this.__isUpgradeDisabled}static get observedAttributes(){return i.call(this).concat(iL)}_initializeProperties(){this.hasAttribute(iL)?this.__isUpgradeDisabled=!0:super._initializeProperties()}_enableProperties(){this.__isUpgradeDisabled||super._enableProperties()}_canApplyPropertyDefault(s){return super._canApplyPropertyDefault(s)&&!(this.__isUpgradeDisabled&&this._isPropertyPending(s))}attributeChangedCallback(s,o,a,l){s==iL?this.__isUpgradeDisabled&&a==null&&(super._initializeProperties(),this.__isUpgradeDisabled=!1,De(this).isConnected&&super.connectedCallback()):super.attributeChangedCallback(s,o,a,l)}connectedCallback(){this.__isUpgradeDisabled||super.connectedCallback()}disconnectedCallback(){this.__isUpgradeDisabled||super.disconnectedCallback()}}return n});const XI="disable-upgrade";let ZUe=window.ShadyCSS;const ehe=Sa(t=>{const e=yT(fk(t)),i=gF?e:zUe(e),n=Que(i),r={x:"pan-x",y:"pan-y",none:"none",all:"auto"};class s extends i{constructor(){super(),this.isAttached,this.__boundListeners,this._debouncers,this.__isUpgradeDisabled,this.__needsAttributesAtConnected,this._legacyForceObservedAttributes}static get importMeta(){return this.prototype.importMeta}created(){}__attributeReaction(a,l,c){(this.__dataAttributes&&this.__dataAttributes[a]||a===XI)&&this.attributeChangedCallback(a,l,c,null)}setAttribute(a,l){if(JI&&!this._legacyForceObservedAttributes){const c=this.getAttribute(a);super.setAttribute(a,l),this.__attributeReaction(a,c,String(l))}else super.setAttribute(a,l)}removeAttribute(a){if(JI&&!this._legacyForceObservedAttributes){const l=this.getAttribute(a);super.removeAttribute(a),this.__attributeReaction(a,l,null)}else super.removeAttribute(a)}static get observedAttributes(){return JI&&!this.prototype._legacyForceObservedAttributes?(this.hasOwnProperty(JSCompiler_renameProperty("__observedAttributes",this))||(this.__observedAttributes=[],this.prototype,void 0),this.__observedAttributes):n.call(this).concat(XI)}_enableProperties(){this.__isUpgradeDisabled||super._enableProperties()}_canApplyPropertyDefault(a){return super._canApplyPropertyDefault(a)&&!(this.__isUpgradeDisabled&&this._isPropertyPending(a))}connectedCallback(){this.__needsAttributesAtConnected&&this._takeAttributes(),this.__isUpgradeDisabled||(super.connectedCallback(),this.isAttached=!0,this.attached())}attached(){}disconnectedCallback(){this.__isUpgradeDisabled||(super.disconnectedCallback(),this.isAttached=!1,this.detached())}detached(){}attributeChangedCallback(a,l,c,u){l!==c&&(a==XI?this.__isUpgradeDisabled&&c==null&&(this._initializeProperties(),this.__isUpgradeDisabled=!1,De(this).isConnected&&this.connectedCallback()):(super.attributeChangedCallback(a,l,c,u),this.attributeChanged(a,l,c)))}attributeChanged(a,l,c){}_initializeProperties(){if(oS&&this.hasAttribute(XI))this.__isUpgradeDisabled=!0;else{let a=Object.getPrototypeOf(this);a.hasOwnProperty(JSCompiler_renameProperty("__hasRegisterFinished",a))||(this._registered(),a.__hasRegisterFinished=!0),super._initializeProperties(),this.root=this,this.created(),JI&&!this._legacyForceObservedAttributes&&(this.hasAttributes()?this._takeAttributes():this.parentNode||(this.__needsAttributesAtConnected=!0)),this._applyListeners()}}_takeAttributes(){const a=this.attributes;for(let l=0,c=a.length;l<c;l++){const u=a[l];this.__attributeReaction(u.name,null,u.value)}}_registered(){}ready(){this._ensureAttributes(),super.ready()}_ensureAttributes(){}_applyListeners(){}serialize(a){return this._serializeValue(a)}deserialize(a,l){return this._deserializeValue(a,l)}reflectPropertyToAttribute(a,l,c){this._propertyToAttribute(a,l,c)}serializeValueToAttribute(a,l,c){this._valueToNodeAttribute(c||this,a,l)}extend(a,l){if(!a||!l)return a||l;let c=Object.getOwnPropertyNames(l);for(let u,d=0;d<c.length&&(u=c[d]);d++){let f=Object.getOwnPropertyDescriptor(l,u);f&&Object.defineProperty(a,u,f)}return a}mixin(a,l){for(let c in l)a[c]=l[c];return a}chainObject(a,l){return a&&l&&a!==l&&(a.__proto__=l),a}instanceTemplate(a){let l=this.constructor._contentForTemplate(a);return document.importNode(l,!0)}fire(a,l,c){c=c||{},l=l??{};let u=new Event(a,{bubbles:c.bubbles===void 0||c.bubbles,cancelable:!!c.cancelable,composed:c.composed===void 0||c.composed});u.detail=l;let d=c.node||this;return De(d).dispatchEvent(u),u}listen(a,l,c){a=a||this;let u=this.__boundListeners||(this.__boundListeners=new WeakMap),d=u.get(a);d||(d={},u.set(a,d));let f=l+c;d[f]||(d[f]=this._addMethodEventListenerToNode(a,l,c,this))}unlisten(a,l,c){a=a||this;let u=this.__boundListeners&&this.__boundListeners.get(a),d=l+c,f=u&&u[d];f&&(this._removeEventListenerFromNode(a,l,f),u[d]=null)}setScrollDirection(a,l){$ue(l||this,r[a]||"auto")}$$(a){return this.root.querySelector(a)}get domHost(){let a=De(this).getRootNode();return a instanceof DocumentFragment?a.host:a}distributeContent(){const a=gf(this);window.ShadyDOM&&a.shadowRoot&&ShadyDOM.flush()}getEffectiveChildNodes(){return gf(this).getEffectiveChildNodes()}queryDistributedElements(a){return gf(this).queryDistributedElements(a)}getEffectiveChildren(){return this.getEffectiveChildNodes().filter(function(a){return a.nodeType===Node.ELEMENT_NODE})}getEffectiveTextContent(){let a=this.getEffectiveChildNodes(),l=[];for(let c,u=0;c=a[u];u++)c.nodeType!==Node.COMMENT_NODE&&l.push(c.textContent);return l.join("")}queryEffectiveChildren(a){let l=this.queryDistributedElements(a);return l&&l[0]}queryAllEffectiveChildren(a){return this.queryDistributedElements(a)}getContentChildNodes(a){let l=this.root.querySelector(a||"slot");return l?gf(l).getDistributedNodes():[]}getContentChildren(a){return this.getContentChildNodes(a).filter(function(l){return l.nodeType===Node.ELEMENT_NODE})}isLightDescendant(a){const l=this;return l!==a&&De(l).contains(a)&&De(l).getRootNode()===De(a).getRootNode()}isLocalDescendant(a){return this.root===De(a).getRootNode()}scopeSubtree(a,l=!1){return JUe(a,l)}getComputedStyleValue(a){return ZUe.getComputedStyleValue(this,a)}debounce(a,l,c){return this._debouncers=this._debouncers||{},this._debouncers[a]=Tn.debounce(this._debouncers[a],c>0?_c.after(c):ul,l.bind(this))}isDebouncerActive(a){this._debouncers=this._debouncers||{};let l=this._debouncers[a];return!(!l||!l.isActive())}flushDebouncer(a){this._debouncers=this._debouncers||{};let l=this._debouncers[a];l&&l.flush()}cancelDebouncer(a){this._debouncers=this._debouncers||{};let l=this._debouncers[a];l&&l.cancel()}async(a,l){return l>0?_c.run(a.bind(this),l):~ul.run(a.bind(this))}cancelAsync(a){a<0?ul.cancel(~a):_c.cancel(a)}create(a,l){let c=document.createElement(a);if(l)if(c.setProperties)c.setProperties(l);else for(let u in l)c[u]=l[u];return c}elementMatches(a,l){return Kue(l||this,a)}toggleAttribute(a,l){let c=this;return arguments.length===3&&(c=arguments[2]),arguments.length==1&&(l=!c.hasAttribute(a)),l?(De(c).setAttribute(a,""),!0):(De(c).removeAttribute(a),!1)}toggleClass(a,l,c){c=c||this,arguments.length==1&&(l=!c.classList.contains(a)),l?c.classList.add(a):c.classList.remove(a)}transform(a,l){(l=l||this).style.webkitTransform=a,l.style.transform=a}translate3d(a,l,c,u){u=u||this,this.transform("translate3d("+a+","+l+","+c+")",u)}arrayDelete(a,l){let c;if(Array.isArray(a)){if(c=a.indexOf(l),c>=0)return a.splice(c,1)}else if(c=Ks(this,a).indexOf(l),c>=0)return this.splice(a,c,1);return null}_logger(a,l){switch(Array.isArray(l)&&l.length===1&&Array.isArray(l[0])&&(l=l[0]),a){case"log":case"warn":case"error":console[a](...l)}}_log(...a){this._logger("log",a)}_warn(...a){this._logger("warn",a)}_error(...a){this._logger("error",a)}_logf(a,...l){return["[%s::%s]",this.is,a,...l]}}return s.prototype.is="",s}),YUe={attached:!0,detached:!0,ready:!0,created:!0,beforeRegister:!0,registered:!0,attributeChanged:!0,listeners:!0,hostAttributes:!0},the={attached:!0,detached:!0,ready:!0,created:!0,beforeRegister:!0,registered:!0,attributeChanged:!0,behaviors:!0,_noAccessors:!0},XUe=Object.assign({listeners:!0,hostAttributes:!0,properties:!0,observers:!0},the);function KUe(t,e,i){const n=t._noAccessors,r=Object.getOwnPropertyNames(t);for(let s=0;s<r.length;s++){let o=r[s];if(!(o in i))if(n)e[o]=t[o];else{let a=Object.getOwnPropertyDescriptor(t,o);a&&(a.configurable=!0,Object.defineProperty(e,o,a))}}}function QUe(t,e,i){for(let n=0;n<e.length;n++)ihe(t,e[n],i,XUe)}function ihe(t,e,i,n){KUe(e,t,n);for(let r in YUe)e[r]&&(i[r]=i[r]||[],i[r].push(e[r]))}function nhe(t,e,i){e=e||[];for(let n=t.length-1;n>=0;n--){let r=t[n];r?Array.isArray(r)?nhe(r,e):e.indexOf(r)<0&&(!i||i.indexOf(r)<0)&&e.unshift(r):console.warn("behavior is null, check for missing or 404 import")}return e}function uJ(t,e){for(const i in e){const n=t[i],r=e[i];t[i]=!("value"in r)&&n&&"value"in n?Object.assign({value:n.value},r):r}}const hJ=ehe(HTMLElement);function e7e(t,e,i){let n;const r={};class s extends e{static _finalizeClass(){if(this.hasOwnProperty(JSCompiler_renameProperty("generatedFrom",this))){if(n)for(let l,c=0;c<n.length;c++)l=n[c],l.properties&&this.createProperties(l.properties),l.observers&&this.createObservers(l.observers,l.properties);t.properties&&this.createProperties(t.properties),t.observers&&this.createObservers(t.observers,t.properties),this._prepareTemplate()}else e._finalizeClass.call(this)}static get properties(){const l={};if(n)for(let c=0;c<n.length;c++)uJ(l,n[c].properties);return uJ(l,t.properties),l}static get observers(){let l=[];if(n)for(let c,u=0;u<n.length;u++)c=n[u],c.observers&&(l=l.concat(c.observers));return t.observers&&(l=l.concat(t.observers)),l}created(){super.created();const l=r.created;if(l)for(let c=0;c<l.length;c++)l[c].call(this)}_registered(){const l=s.prototype;if(!l.hasOwnProperty(JSCompiler_renameProperty("__hasRegisterFinished",l))){l.__hasRegisterFinished=!0,super._registered(),oS&&o(l);const c=Object.getPrototypeOf(this);let u=r.beforeRegister;if(u)for(let d=0;d<u.length;d++)u[d].call(c);if(u=r.registered,u)for(let d=0;d<u.length;d++)u[d].call(c)}}_applyListeners(){super._applyListeners();const l=r.listeners;if(l)for(let c=0;c<l.length;c++){const u=l[c];if(u)for(let d in u)this._addMethodEventListenerToNode(this,d,u[d])}}_ensureAttributes(){const l=r.hostAttributes;if(l)for(let c=l.length-1;c>=0;c--){const u=l[c];for(let d in u)this._ensureAttribute(d,u[d])}super._ensureAttributes()}ready(){super.ready();let l=r.ready;if(l)for(let c=0;c<l.length;c++)l[c].call(this)}attached(){super.attached();let l=r.attached;if(l)for(let c=0;c<l.length;c++)l[c].call(this)}detached(){super.detached();let l=r.detached;if(l)for(let c=0;c<l.length;c++)l[c].call(this)}attributeChanged(l,c,u){super.attributeChanged();let d=r.attributeChanged;if(d)for(let f=0;f<d.length;f++)d[f].call(this,l,c,u)}}if(i){Array.isArray(i)||(i=[i]);let a=e.prototype.behaviors;n=nhe(i,null,a),s.prototype.behaviors=a?a.concat(i):n}const o=a=>{n&&QUe(a,n,r),ihe(a,t,r,the)};return oS||o(s.prototype),s.generatedFrom=t,s}const t7e=function(t,e){t||console.warn("Polymer.Class requires `info` argument");let i=e?e(hJ):hJ;return i=e7e(t,i,t.behaviors),i.is=i.prototype.is=t.is,i};function M8(t,e,i,n,r){let s;r&&(s=typeof i=="object"&&i!==null,s&&(n=t.__dataTemp[e]));let o=n!==i&&(n==n||i==i);return s&&o&&(t.__dataTemp[e]=i),o}const E8=Sa(t=>{class e extends t{_shouldPropertyChange(n,r,s){return M8(this,n,r,s,!0)}}return e}),rhe=Sa(t=>{class e extends t{static get properties(){return{mutableData:Boolean}}_shouldPropertyChange(n,r,s){return M8(this,n,r,s,this.mutableData)}}return e});E8._mutablePropertyChange=M8;let MF=null;function EF(){return MF}EF.prototype=Object.create(HTMLTemplateElement.prototype,{constructor:{value:EF,writable:!0}});const she=pk(EF),i7e=E8(she);function n7e(t,e){MF=t,Object.setPrototypeOf(t,e.prototype),new e,MF=null}const r7e=pk(class{});function ohe(t,e){for(let i=0;i<e.length;i++){let n=e[i];if(!!t!=!!n.__hideTemplateChildren__)if(n.nodeType===Node.TEXT_NODE)t?(n.__polymerTextContent__=n.textContent,n.textContent=""):n.textContent=n.__polymerTextContent__;else if(n.localName==="slot")if(t)n.__polymerReplaced__=document.createComment("hidden-slot"),De(De(n).parentNode).replaceChild(n.__polymerReplaced__,n);else{const r=n.__polymerReplaced__;r&&De(De(r).parentNode).replaceChild(n,r)}else n.style&&(t?(n.__polymerDisplay__=n.style.display,n.style.display="none"):n.style.display=n.__polymerDisplay__);n.__hideTemplateChildren__=t,n._showHideChildren&&n._showHideChildren(t)}}class Xp extends r7e{constructor(e){super(),this._configureProperties(e),this.root=this._stampTemplate(this.__dataHost);let i=[];this.children=i;for(let r=this.root.firstChild;r;r=r.nextSibling)i.push(r),r.__templatizeInstance=this;this.__templatizeOwner&&this.__templatizeOwner.__hideTemplateChildren__&&this._showHideChildren(!0);let n=this.__templatizeOptions;(e&&n.instanceProps||!n.instanceProps)&&this._enableProperties()}_configureProperties(e){if(this.__templatizeOptions.forwardHostProp)for(let i in this.__hostProps)this._setPendingProperty(i,this.__dataHost["_host_"+i]);for(let i in e)this._setPendingProperty(i,e[i])}forwardHostProp(e,i){this._setPendingPropertyOrPath(e,i,!1,!0)&&this.__dataHost._enqueueClient(this)}_addEventListenerToNode(e,i,n){if(this._methodHost&&this.__templatizeOptions.parentModel)this._methodHost._addEventListenerToNode(e,i,r=>{r.model=this,n(r)});else{let r=this.__dataHost.__dataHost;r&&r._addEventListenerToNode(e,i,n)}}_showHideChildren(e){ohe(e,this.children)}_setUnmanagedPropertyToNode(e,i,n){e.__hideTemplateChildren__&&e.nodeType==Node.TEXT_NODE&&i=="textContent"?e.__polymerTextContent__=n:super._setUnmanagedPropertyToNode(e,i,n)}get parentModel(){let e=this.__parentModel;if(!e){let i;e=this;do e=e.__dataHost.__dataHost;while((i=e.__templatizeOptions)&&!i.parentModel);this.__parentModel=e}return e}dispatchEvent(e){return!0}}Xp.prototype.__dataHost,Xp.prototype.__templatizeOptions,Xp.prototype._methodHost,Xp.prototype.__templatizeOwner,Xp.prototype.__hostProps;const s7e=E8(Xp);function dJ(t){let e=t.__dataHost;return e&&e._methodHost||e}function o7e(t,e,i){let n=i.mutableData?s7e:Xp;mS.mixin&&(n=mS.mixin(n));let r=class extends n{};return r.prototype.__templatizeOptions=i,r.prototype._bindTemplate(t),c7e(r,t,e,i),r}function a7e(t,e,i,n){let r=i.forwardHostProp;if(r&&e.hasHostProps){const s=t.localName=="template";let o=e.templatizeTemplateClass;if(!o){if(s){let l=i.mutableData?i7e:she;class c extends l{}o=e.templatizeTemplateClass=c}else{const l=t.constructor;class c extends l{}o=e.templatizeTemplateClass=c}let a=e.hostProps;for(let l in a)o.prototype._addPropertyEffect("_host_"+l,o.prototype.PROPERTY_EFFECT_TYPES.PROPAGATE,{fn:l7e(l,r)}),o.prototype._createNotifyingProperty("_host_"+l);Kce&&n&&d7e(e,i,n)}if(t.__dataProto&&Object.assign(t.__data,t.__dataProto),s)n7e(t,o),t.__dataTemp={},t.__dataPending=null,t.__dataOld=null,t._enableProperties();else{Object.setPrototypeOf(t,o.prototype);const a=e.hostProps;for(let l in a)if(l="_host_"+l,l in t){const c=t[l];delete t[l],t.__data[l]=c}}}}function l7e(t,e){return function(i,n,r){e.call(i.__templatizeOwner,n.substring(6),r[n])}}function c7e(t,e,i,n){let r=i.hostProps||{};for(let s in n.instanceProps){delete r[s];let o=n.notifyInstanceProp;o&&t.prototype._addPropertyEffect(s,t.prototype.PROPERTY_EFFECT_TYPES.NOTIFY,{fn:u7e(s,o)})}if(n.forwardHostProp&&e.__dataHost)for(let s in r)i.hasHostProps||(i.hasHostProps=!0),t.prototype._addPropertyEffect(s,t.prototype.PROPERTY_EFFECT_TYPES.NOTIFY,{fn:h7e()})}function u7e(t,e){return function(i,n,r){e.call(i.__templatizeOwner,i,n,r[n])}}function h7e(){return function(t,e,i){t.__dataHost._setPendingPropertyOrPath("_host_"+e,i[e],!0,!0)}}function mS(t,e,i){if(wb&&!dJ(t))throw new Error("strictTemplatePolicy: template owner not trusted");if(i=i||{},t.__templatizeOwner)throw new Error("A <template> can only be templatized once");t.__templatizeOwner=e;let n=(e?e.constructor:Xp)._parseTemplate(t),r=n.templatizeInstanceClass;r||(r=o7e(t,n,i),n.templatizeInstanceClass=r);const s=dJ(t);a7e(t,n,i,s);let o=class extends r{};return o.prototype._methodHost=s,o.prototype.__dataHost=t,o.prototype.__templatizeOwner=e,o.prototype.__hostProps=n.hostProps,o}function d7e(t,e,i){const n=i.constructor._properties,{propertyEffects:r}=t,{instanceProps:s}=e;for(let o in r)if(!(n[o]||s&&s[o])){const a=r[o];for(let l=0;l<a.length;l++){const{part:c}=a[l].info;if(!c.signature||!c.signature.static){console.warn(`Property '${o}' used in template but not declared in 'properties'; attribute will not be observed.`);break}}}}function p7e(t,e){let i;for(;e;)if(i=e.__dataHost?e:e.__templatizeInstance){if(i.__dataHost==t)return i;e=i.__dataHost}else e=De(e).parentNode;return null}let pJ=!1;function A8(){if(oS&&!l8){if(!pJ){pJ=!0;const t=document.createElement("style");t.textContent="dom-bind,dom-if,dom-repeat{display:none;}",document.head.appendChild(t)}return!0}return!1}const f7e=yT(rhe(pk(HTMLElement)));class m7e extends f7e{static get observedAttributes(){return["mutable-data"]}constructor(){if(super(),wb)throw new Error("strictTemplatePolicy: dom-bind not allowed");this.root=null,this.$=null,this.__children=null}attributeChangedCallback(e,i,n,r){this.mutableData=!0}connectedCallback(){A8()||(this.style.display="none"),this.render()}disconnectedCallback(){this.__removeChildren()}__insertChildren(){De(De(this).parentNode).insertBefore(this.root,this)}__removeChildren(){if(this.__children)for(let e=0;e<this.__children.length;e++)this.root.appendChild(this.__children[e])}render(){let e;if(!this.__children){if(e=e||this.querySelector("template"),!e){let i=new MutationObserver(()=>{if(e=this.querySelector("template"),!e)throw new Error("dom-bind requires a <template> child");i.disconnect(),this.render()});return void i.observe(this,{childList:!0})}this.root=this._stampTemplate(e),this.$=this.root.$,this.__children=[];for(let i=this.root.firstChild;i;i=i.nextSibling)this.__children[this.__children.length]=i;this._enableProperties()}this.__insertChildren(),this.dispatchEvent(new CustomEvent("dom-change",{bubbles:!0,composed:!0}))}}customElements.define("dom-bind",m7e);const g7e=rhe(_d);class fJ extends g7e{static get is(){return"dom-repeat"}static get template(){return null}static get properties(){return{items:{type:Array},as:{type:String,value:"item"},indexAs:{type:String,value:"index"},itemsIndexAs:{type:String,value:"itemsIndex"},sort:{type:Function,observer:"__sortChanged"},filter:{type:Function,observer:"__filterChanged"},observe:{type:String,observer:"__observeChanged"},delay:Number,renderedItemCount:{type:Number,notify:!aF,readOnly:!0},initialCount:{type:Number},targetFramerate:{type:Number,value:20},_targetFrameTime:{type:Number,computed:"__computeFrameTime(targetFramerate)"},notifyDomChange:{type:Boolean},reuseChunkedInstances:{type:Boolean}}}static get observers(){return["__itemsChanged(items.*)"]}constructor(){super(),this.__instances=[],this.__renderDebouncer=null,this.__itemsIdxToInstIdx={},this.__chunkCount=null,this.__renderStartTime=null,this.__itemsArrayChanged=!1,this.__shouldMeasureChunk=!1,this.__shouldContinueChunking=!1,this.__chunkingId=0,this.__sortFn=null,this.__filterFn=null,this.__observePaths=null,this.__ctor=null,this.__isDetached=!0,this.template=null,this._templateInfo}disconnectedCallback(){super.disconnectedCallback(),this.__isDetached=!0;for(let e=0;e<this.__instances.length;e++)this.__detachInstance(e)}connectedCallback(){if(super.connectedCallback(),A8()||(this.style.display="none"),this.__isDetached){this.__isDetached=!1;let e=De(De(this).parentNode);for(let i=0;i<this.__instances.length;i++)this.__attachInstance(i,e)}}__ensureTemplatized(){if(!this.__ctor){const e=this;let i=this.template=e._templateInfo?e:this.querySelector("template");if(!i){let r=new MutationObserver(()=>{if(!this.querySelector("template"))throw new Error("dom-repeat requires a <template> child");r.disconnect(),this.__render()});return r.observe(this,{childList:!0}),!1}let n={};n[this.as]=!0,n[this.indexAs]=!0,n[this.itemsIndexAs]=!0,this.__ctor=mS(i,this,{mutableData:this.mutableData,parentModel:!0,instanceProps:n,forwardHostProp:function(r,s){let o=this.__instances;for(let a,l=0;l<o.length&&(a=o[l]);l++)a.forwardHostProp(r,s)},notifyInstanceProp:function(r,s,o){if(DBe(this.as,s)){let a=r[this.itemsIndexAs];s==this.as&&(this.items[a]=o);let l=hS(this.as,`${JSCompiler_renameProperty("items",this)}.${a}`,s);this.notifyPath(l,o)}}})}return!0}__getMethodHost(){return this.__dataHost._methodHost||this.__dataHost}__functionFromPropertyValue(e){if(typeof e=="string"){let i=e,n=this.__getMethodHost();return function(){return n[i].apply(n,arguments)}}return e}__sortChanged(e){this.__sortFn=this.__functionFromPropertyValue(e),this.items&&this.__debounceRender(this.__render)}__filterChanged(e){this.__filterFn=this.__functionFromPropertyValue(e),this.items&&this.__debounceRender(this.__render)}__computeFrameTime(e){return Math.ceil(1e3/e)}__observeChanged(){this.__observePaths=this.observe&&this.observe.replace(".*",".").split(" ")}__handleObservedPaths(e){if(this.__sortFn||this.__filterFn)if(e){if(this.__observePaths){let i=this.__observePaths;for(let n=0;n<i.length;n++)e.indexOf(i[n])===0&&this.__debounceRender(this.__render,this.delay)}}else this.__debounceRender(this.__render,this.delay)}__itemsChanged(e){this.items&&!Array.isArray(this.items)&&console.warn("dom-repeat expected array for `items`, found",this.items),this.__handleItemPath(e.path,e.value)||(e.path==="items"&&(this.__itemsArrayChanged=!0),this.__debounceRender(this.__render))}__debounceRender(e,i=0){this.__renderDebouncer=Tn.debounce(this.__renderDebouncer,i>0?_c.after(i):ul,e.bind(this)),mk(this.__renderDebouncer)}render(){this.__debounceRender(this.__render),Sb()}__render(){if(!this.__ensureTemplatized())return;let e=this.items||[];const i=this.__sortAndFilterItems(e),n=this.__calculateLimit(i.length);this.__updateInstances(e,n,i),this.initialCount&&(this.__shouldMeasureChunk||this.__shouldContinueChunking)&&(cancelAnimationFrame(this.__chunkingId),this.__chunkingId=requestAnimationFrame(()=>this.__continueChunking())),this._setRenderedItemCount(this.__instances.length),aF&&!this.notifyDomChange||this.dispatchEvent(new CustomEvent("dom-change",{bubbles:!0,composed:!0}))}__sortAndFilterItems(e){let i=new Array(e.length);for(let n=0;n<e.length;n++)i[n]=n;return this.__filterFn&&(i=i.filter((n,r,s)=>this.__filterFn(e[n],r,s))),this.__sortFn&&i.sort((n,r)=>this.__sortFn(e[n],e[r])),i}__calculateLimit(e){let i=e;const n=this.__instances.length;if(this.initialCount){let r;!this.__chunkCount||this.__itemsArrayChanged&&!this.reuseChunkedInstances?(i=Math.min(e,this.initialCount),r=Math.max(i-n,0),this.__chunkCount=r||1):(r=Math.min(Math.max(e-n,0),this.__chunkCount),i=Math.min(n+r,e)),this.__shouldMeasureChunk=r===this.__chunkCount,this.__shouldContinueChunking=i<e,this.__renderStartTime=performance.now()}return this.__itemsArrayChanged=!1,i}__continueChunking(){if(this.__shouldMeasureChunk){const e=performance.now()-this.__renderStartTime,i=this._targetFrameTime/e;this.__chunkCount=Math.round(this.__chunkCount*i)||1}this.__shouldContinueChunking&&this.__debounceRender(this.__render)}__updateInstances(e,i,n){const r=this.__itemsIdxToInstIdx={};let s;for(s=0;s<i;s++){let o=this.__instances[s],a=n[s],l=e[a];r[a]=s,o?(o._setPendingProperty(this.as,l),o._setPendingProperty(this.indexAs,s),o._setPendingProperty(this.itemsIndexAs,a),o._flushProperties()):this.__insertInstance(l,s,a)}for(let o=this.__instances.length-1;o>=s;o--)this.__detachAndRemoveInstance(o)}__detachInstance(e){let i=this.__instances[e];const n=De(i.root);for(let r=0;r<i.children.length;r++){let s=i.children[r];n.appendChild(s)}return i}__attachInstance(e,i){let n=this.__instances[e];i.insertBefore(n.root,this)}__detachAndRemoveInstance(e){this.__detachInstance(e),this.__instances.splice(e,1)}__stampInstance(e,i,n){let r={};return r[this.as]=e,r[this.indexAs]=i,r[this.itemsIndexAs]=n,new this.__ctor(r)}__insertInstance(e,i,n){const r=this.__stampInstance(e,i,n);let s=this.__instances[i+1],o=s?s.children[0]:this;return De(De(this).parentNode).insertBefore(r.root,o),this.__instances[i]=r,r}_showHideChildren(e){for(let i=0;i<this.__instances.length;i++)this.__instances[i]._showHideChildren(e)}__handleItemPath(e,i){let n=e.slice(6),r=n.indexOf("."),s=r<0?n:n.substring(0,r);if(s==parseInt(s,10)){let o=r<0?"":n.substring(r+1);this.__handleObservedPaths(o);let a=this.__itemsIdxToInstIdx[s],l=this.__instances[a];if(l){let c=this.as+(o?"."+o:"");l._setPendingPropertyOrPath(c,i,!1,!0),l._flushProperties()}return!0}}itemForElement(e){let i=this.modelForElement(e);return i&&i[this.as]}indexForElement(e){let i=this.modelForElement(e);return i&&i[this.indexAs]}modelForElement(e){return p7e(this.template,e)}}customElements.define(fJ.is,fJ);class ahe extends _d{static get is(){return"dom-if"}static get template(){return null}static get properties(){return{if:{type:Boolean,observer:"__debounceRender"},restamp:{type:Boolean,observer:"__debounceRender"},notifyDomChange:{type:Boolean}}}constructor(){super(),this.__renderDebouncer=null,this._lastIf=!1,this.__hideTemplateChildren__=!1,this.__template,this._templateInfo}__debounceRender(){this.__renderDebouncer=Tn.debounce(this.__renderDebouncer,ul,()=>this.__render()),mk(this.__renderDebouncer)}disconnectedCallback(){super.disconnectedCallback();const e=De(this).parentNode;e&&(e.nodeType!=Node.DOCUMENT_FRAGMENT_NODE||De(e).host)||this.__teardownInstance()}connectedCallback(){super.connectedCallback(),A8()||(this.style.display="none"),this.if&&this.__debounceRender()}__ensureTemplate(){if(!this.__template){const e=this;let i=e._templateInfo?e:De(e).querySelector("template");if(!i){let n=new MutationObserver(()=>{if(!De(this).querySelector("template"))throw new Error("dom-if requires a <template> child");n.disconnect(),this.__render()});return n.observe(this,{childList:!0}),!1}this.__template=i}return!0}__ensureInstance(){let e=De(this).parentNode;if(this.__hasInstance()){let i=this.__getInstanceNodes();if(i&&i.length&&De(this).previousSibling!==i[i.length-1])for(let n,r=0;r<i.length&&(n=i[r]);r++)De(e).insertBefore(n,this)}else{if(!e||!this.__ensureTemplate())return!1;this.__createAndInsertInstance(e)}return!0}render(){Sb()}__render(){if(this.if){if(!this.__ensureInstance())return}else this.restamp&&this.__teardownInstance();this._showHideChildren(),aF&&!this.notifyDomChange||this.if==this._lastIf||(this.dispatchEvent(new CustomEvent("dom-change",{bubbles:!0,composed:!0})),this._lastIf=this.if)}__hasInstance(){}__getInstanceNodes(){}__createAndInsertInstance(e){}__teardownInstance(){}_showHideChildren(){}}class y7e extends ahe{constructor(){super(),this.__instance=null,this.__syncInfo=null}__hasInstance(){return!!this.__instance}__getInstanceNodes(){return this.__instance.templateInfo.childNodes}__createAndInsertInstance(e){const i=this.__dataHost||this;if(wb&&!this.__dataHost)throw new Error("strictTemplatePolicy: template owner not trusted");const n=i._bindTemplate(this.__template,!0);n.runEffects=(r,s,o)=>{let a=this.__syncInfo;if(this.if)a&&(this.__syncInfo=null,this._showHideChildren(),s=Object.assign(a.changedProps,s)),r(s,o);else if(this.__instance)if(a||(a=this.__syncInfo={runEffects:r,changedProps:{}}),o)for(const l in s){const c=vd(l);a.changedProps[c]=this.__dataHost[c]}else Object.assign(a.changedProps,s)},this.__instance=i._stampTemplate(this.__template,n),De(e).insertBefore(this.__instance,this)}__syncHostProperties(){const e=this.__syncInfo;e&&(this.__syncInfo=null,e.runEffects(e.changedProps,!1))}__teardownInstance(){const e=this.__dataHost||this;this.__instance&&(e._removeBoundDom(this.__instance),this.__instance=null,this.__syncInfo=null)}_showHideChildren(){const e=this.__hideTemplateChildren__||!this.if;this.__instance&&!!this.__instance.__hidden!==e&&(this.__instance.__hidden=e,ohe(e,this.__instance.templateInfo.childNodes)),e||this.__syncHostProperties()}}class v7e extends ahe{constructor(){super(),this.__ctor=null,this.__instance=null,this.__invalidProps=null}__hasInstance(){return!!this.__instance}__getInstanceNodes(){return this.__instance.children}__createAndInsertInstance(e){this.__ctor||(this.__ctor=mS(this.__template,this,{mutableData:!0,forwardHostProp:function(i,n){this.__instance&&(this.if?this.__instance.forwardHostProp(i,n):(this.__invalidProps=this.__invalidProps||Object.create(null),this.__invalidProps[vd(i)]=!0))}})),this.__instance=new this.__ctor,De(e).insertBefore(this.__instance.root,this)}__teardownInstance(){if(this.__instance){let e=this.__instance.children;if(e&&e.length){let i=De(e[0]).parentNode;if(i){i=De(i);for(let n,r=0;r<e.length&&(n=e[r]);r++)i.removeChild(n)}}this.__invalidProps=null,this.__instance=null}}__syncHostProperties(){let e=this.__invalidProps;if(e){this.__invalidProps=null;for(let i in e)this.__instance._setPendingProperty(i,this.__dataHost[i]);this.__instance._flushProperties()}}_showHideChildren(){const e=this.__hideTemplateChildren__||!this.if;this.__instance&&!!this.__instance.__hidden!==e&&(this.__instance.__hidden=e,this.__instance._showHideChildren(e)),e||this.__syncHostProperties()}}const mJ=Qce?y7e:v7e;customElements.define(mJ.is,mJ);let _7e=Sa(t=>{let e=fk(t);class i extends e{static get properties(){return{items:{type:Array},multi:{type:Boolean,value:!1},selected:{type:Object,notify:!0},selectedItem:{type:Object,notify:!0},toggle:{type:Boolean,value:!1}}}static get observers(){return["__updateSelection(multi, items.*)"]}constructor(){super(),this.__lastItems=null,this.__lastMulti=null,this.__selectedMap=null}__updateSelection(r,s){let o=s.path;if(o==JSCompiler_renameProperty("items",this)){let a=s.base||[],l=this.__lastItems;if(r!==this.__lastMulti&&this.clearSelection(),l){let c=Xue(a,l);this.__applySplices(c)}this.__lastItems=a,this.__lastMulti=r}else if(s.path==`${JSCompiler_renameProperty("items",this)}.splices`)this.__applySplices(s.value.indexSplices);else{let a=o.slice(`${JSCompiler_renameProperty("items",this)}.`.length),l=parseInt(a,10);a.indexOf(".")<0&&a==l&&this.__deselectChangedIdx(l)}}__applySplices(r){let s=this.__selectedMap;for(let a=0;a<r.length;a++){let l=r[a];s.forEach((c,u)=>{c<l.index||(c>=l.index+l.removed.length?s.set(u,c+l.addedCount-l.removed.length):s.set(u,-1))});for(let c=0;c<l.addedCount;c++){let u=l.index+c;s.has(this.items[u])&&s.set(this.items[u],u)}}this.__updateLinks();let o=0;s.forEach((a,l)=>{a<0?(this.multi?this.splice(JSCompiler_renameProperty("selected",this),o,1):this.selected=this.selectedItem=null,s.delete(l)):o++})}__updateLinks(){if(this.__dataLinkedPaths={},this.multi){let r=0;this.__selectedMap.forEach(s=>{s>=0&&this.linkPaths(`${JSCompiler_renameProperty("items",this)}.${s}`,`${JSCompiler_renameProperty("selected",this)}.${r++}`)})}else this.__selectedMap.forEach(r=>{this.linkPaths(JSCompiler_renameProperty("selected",this),`${JSCompiler_renameProperty("items",this)}.${r}`),this.linkPaths(JSCompiler_renameProperty("selectedItem",this),`${JSCompiler_renameProperty("items",this)}.${r}`)})}clearSelection(){this.__dataLinkedPaths={},this.__selectedMap=new Map,this.selected=this.multi?[]:null,this.selectedItem=null}isSelected(r){return this.__selectedMap.has(r)}isIndexSelected(r){return this.isSelected(this.items[r])}__deselectChangedIdx(r){let s=this.__selectedIndexForItemIndex(r);if(s>=0){let o=0;this.__selectedMap.forEach((a,l)=>{s==o++&&this.deselect(l)})}}__selectedIndexForItemIndex(r){let s=this.__dataLinkedPaths[`${JSCompiler_renameProperty("items",this)}.${r}`];if(s)return parseInt(s.slice(`${JSCompiler_renameProperty("selected",this)}.`.length),10)}deselect(r){let s=this.__selectedMap.get(r);if(s>=0){let o;this.__selectedMap.delete(r),this.multi&&(o=this.__selectedIndexForItemIndex(s)),this.__updateLinks(),this.multi?this.splice(JSCompiler_renameProperty("selected",this),o,1):this.selected=this.selectedItem=null}}deselectIndex(r){this.deselect(this.items[r])}select(r){this.selectIndex(this.items.indexOf(r))}selectIndex(r){let s=this.items[r];this.isSelected(s)?this.toggle&&this.deselectIndex(r):(this.multi||this.__selectedMap.clear(),this.__selectedMap.set(s,r),this.__updateLinks(),this.multi?this.push(JSCompiler_renameProperty("selected",this),s):this.selected=this.selectedItem=s)}}return i})(_d);class gJ extends _7e{static get is(){return"array-selector"}static get template(){return null}}customElements.define(gJ.is,gJ);const j0=ehe(HTMLElement).prototype;var KI=new Set;const b7e={properties:{_parentResizable:{type:Object,observer:"_parentResizableChanged"},_notifyingDescendant:{type:Boolean,value:!1}},listeners:{"iron-request-resize-notifications":"_onIronRequestResizeNotifications"},created:function(){this._interestedResizables=[],this._boundNotifyResize=this.notifyResize.bind(this),this._boundOnDescendantIronResize=this._onDescendantIronResize.bind(this)},attached:function(){this._requestResizeNotifications()},detached:function(){this._parentResizable?this._parentResizable.stopResizeNotificationsFor(this):(KI.delete(this),window.removeEventListener("resize",this._boundNotifyResize)),this._parentResizable=null},notifyResize:function(){this.isAttached&&(this._interestedResizables.forEach(function(t){this.resizerShouldNotify(t)&&this._notifyDescendant(t)},this),this._fireResize())},assignParentResizable:function(t){this._parentResizable&&this._parentResizable.stopResizeNotificationsFor(this),this._parentResizable=t,t&&t._interestedResizables.indexOf(this)===-1&&(t._interestedResizables.push(this),t._subscribeIronResize(this))},stopResizeNotificationsFor:function(t){var e=this._interestedResizables.indexOf(t);e>-1&&(this._interestedResizables.splice(e,1),this._unsubscribeIronResize(t))},_subscribeIronResize:function(t){t.addEventListener("iron-resize",this._boundOnDescendantIronResize)},_unsubscribeIronResize:function(t){t.removeEventListener("iron-resize",this._boundOnDescendantIronResize)},resizerShouldNotify:function(t){return!0},_onDescendantIronResize:function(t){this._notifyingDescendant?t.stopPropagation():l8||this._fireResize()},_fireResize:function(){this.fire("iron-resize",null,{node:this,bubbles:!1})},_onIronRequestResizeNotifications:function(t){var e=gf(t).rootTarget;e!==this&&(e.assignParentResizable(this),this._notifyDescendant(e),t.stopPropagation())},_parentResizableChanged:function(t){t&&window.removeEventListener("resize",this._boundNotifyResize)},_notifyDescendant:function(t){this.isAttached&&(this._notifyingDescendant=!0,t.notifyResize(),this._notifyingDescendant=!1)},_requestResizeNotifications:function(){if(this.isAttached)if(document.readyState==="loading"){var t=this._requestResizeNotifications.bind(this);document.addEventListener("readystatechange",function e(){document.removeEventListener("readystatechange",e),t()})}else this._findParent(),this._parentResizable?this._parentResizable._interestedResizables.forEach(function(e){e!==this&&e._findParent()},this):(KI.forEach(function(e){e!==this&&e._findParent()},this),window.addEventListener("resize",this._boundNotifyResize),this.notifyResize())},_findParent:function(){this.assignParentResizable(null),this.fire("iron-request-resize-notifications",null,{node:this,bubbles:!0,cancelable:!0}),this._parentResizable?KI.delete(this):KI.add(this)}},w7e={properties:{scrollTarget:{type:HTMLElement,value:function(){return this._defaultScrollTarget}}},observers:["_scrollTargetChanged(scrollTarget, isAttached)"],_shouldHaveListener:!0,_scrollTargetChanged:function(t,e){if(this._oldScrollTarget&&(this._toggleScrollListener(!1,this._oldScrollTarget),this._oldScrollTarget=null),e)if(t==="document")this.scrollTarget=this._doc;else if(typeof t=="string"){var i=this.domHost;this.scrollTarget=i&&i.$?i.$[t]:gf(this.ownerDocument).querySelector("#"+t)}else this._isValidScrollTarget()&&(this._oldScrollTarget=t,this._toggleScrollListener(this._shouldHaveListener,t))},_scrollHandler:function(){},get _defaultScrollTarget(){return this._doc},get _doc(){return this.ownerDocument.documentElement},get _scrollTop(){return this._isValidScrollTarget()?this.scrollTarget===this._doc?window.pageYOffset:this.scrollTarget.scrollTop:0},get _scrollLeft(){return this._isValidScrollTarget()?this.scrollTarget===this._doc?window.pageXOffset:this.scrollTarget.scrollLeft:0},set _scrollTop(t){this.scrollTarget===this._doc?window.scrollTo(window.pageXOffset,t):this._isValidScrollTarget()&&(this.scrollTarget.scrollTop=t)},set _scrollLeft(t){this.scrollTarget===this._doc?window.scrollTo(t,window.pageYOffset):this._isValidScrollTarget()&&(this.scrollTarget.scrollLeft=t)},scroll:function(t,e){var i;typeof t=="object"?(i=t.left,e=t.top):i=t,i=i||0,e=e||0,this.scrollTarget===this._doc?window.scrollTo(i,e):this._isValidScrollTarget()&&(this.scrollTarget.scrollLeft=i,this.scrollTarget.scrollTop=e)},get _scrollTargetWidth(){return this._isValidScrollTarget()?this.scrollTarget===this._doc?window.innerWidth:this.scrollTarget.offsetWidth:0},get _scrollTargetHeight(){return this._isValidScrollTarget()?this.scrollTarget===this._doc?window.innerHeight:this.scrollTarget.offsetHeight:0},_isValidScrollTarget:function(){return this.scrollTarget instanceof HTMLElement},_toggleScrollListener:function(t,e){var i=e===this._doc?window:e;t?this._boundScrollHandler||(this._boundScrollHandler=this._scrollHandler.bind(this),i.addEventListener("scroll",this._boundScrollHandler)):this._boundScrollHandler&&(i.removeEventListener("scroll",this._boundScrollHandler),this._boundScrollHandler=null)},toggleScrollListener:function(t){this._shouldHaveListener=t,this._toggleScrollListener(t,this.scrollTarget)}},yJ=navigator.userAgent.match(/iP(?:hone|ad;(?: U;)? CPU) OS (\d+)/),x7e=yJ&&yJ[1]>=8,vJ=3,S7e=t7e({behaviors:[b7e,w7e],_ratio:.5,_scrollerPaddingTop:0,_scrollPosition:0,_physicalSize:0,_physicalAverage:0,_physicalAverageCount:0,_physicalTop:0,_virtualCount:0,_estScrollHeight:0,_scrollHeight:0,_viewportHeight:0,_viewportWidth:0,_physicalItems:null,_physicalSizes:null,_firstVisibleIndexVal:null,_lastVisibleIndexVal:null,_maxPages:2,_focusedVirtualIndex:-1,_templateCost:0,get _physicalBottom(){return this._physicalTop+this._physicalSize},get _scrollBottom(){return this._scrollPosition+this._viewportHeight},get _virtualEnd(){return this._virtualStart+this._physicalCount-1},get _hiddenContentSize(){return this._physicalSize-this._viewportHeight},get _maxScrollTop(){return this._estScrollHeight-this._viewportHeight+this._scrollOffset},get _maxVirtualStart(){return Math.max(0,this._virtualCount-this._physicalCount)},set _virtualStart(t){t=this._clamp(t,0,this._maxVirtualStart),this._virtualStartVal=t},get _virtualStart(){return this._virtualStartVal||0},set _physicalStart(t){(t%=this._physicalCount)<0&&(t=this._physicalCount+t),this._physicalStartVal=t},get _physicalStart(){return this._physicalStartVal||0},get _physicalEnd(){return(this._physicalStart+this._physicalCount-1)%this._physicalCount},set _physicalCount(t){this._physicalCountVal=t},get _physicalCount(){return this._physicalCountVal||0},get _optPhysicalSize(){return this._viewportHeight===0?1/0:this._viewportHeight*this._maxPages},get _isVisible(){return!!(this.offsetWidth||this.offsetHeight)},get firstVisibleIndex(){let t=this._firstVisibleIndexVal;if(t==null){let e=this._physicalTop+this._scrollOffset;t=this._iterateItems(function(i,n){if(e+=this._physicalSizes[i],e>this._scrollPosition)return n})||0,this._firstVisibleIndexVal=t}return t},get lastVisibleIndex(){let t=this._lastVisibleIndexVal;if(t==null){let e=this._physicalTop+this._scrollOffset;this._iterateItems(function(i,n){e<this._scrollBottom&&(t=n),e+=this._physicalSizes[i]}),this._lastVisibleIndexVal=t}return t},get _scrollOffset(){return this._scrollerPaddingTop},attached:function(){this._debounce("_render",this._render,Yh),this.listen(this,"iron-resize","_resizeHandler")},detached:function(){this.unlisten(this,"iron-resize","_resizeHandler")},updateViewportBoundaries:function(){const t=window.getComputedStyle(this);this._scrollerPaddingTop=this.scrollTarget===this?0:parseInt(t["padding-top"],10),this._isRTL=t.direction==="rtl",this._viewportWidth=this.$.items.offsetWidth,this._viewportHeight=this._scrollTargetHeight},_scrollHandler:function(){const t=Math.max(0,Math.min(this._maxScrollTop,this._scrollTop));let e=t-this._scrollPosition;const i=e>=0;if(this._scrollPosition=t,this._firstVisibleIndexVal=null,this._lastVisibleIndexVal=null,Math.abs(e)>this._physicalSize&&this._physicalSize>0){e-=this._scrollOffset;const n=Math.round(e/this._physicalAverage);this._virtualStart=this._virtualStart+n,this._physicalStart=this._physicalStart+n,this._physicalTop=Math.floor(this._virtualStart)*this._physicalAverage,this._update()}else if(this._physicalCount>0){const{physicalTop:n,indexes:r}=this._getReusables(i);i?(this._physicalTop=n,this._virtualStart=this._virtualStart+r.length,this._physicalStart=this._physicalStart+r.length):(this._virtualStart=this._virtualStart-r.length,this._physicalStart=this._physicalStart-r.length),this._update(r,i?null:r),this._debounce("_increasePoolIfNeeded",this._increasePoolIfNeeded.bind(this,0),ul)}},_getReusables:function(t){let e,i,n;const r=[],s=this._hiddenContentSize*this._ratio,o=this._virtualStart,a=this._virtualEnd,l=this._physicalCount;let c=this._physicalTop+this._scrollOffset;const u=this._physicalBottom+this._scrollOffset,d=this._scrollTop,f=this._scrollBottom;for(t?(e=this._physicalStart,i=d-c):(e=this._physicalEnd,i=u-f);n=this._physicalSizes[e],i-=n,!(r.length>=l||i<=s);)if(t){if(a+r.length+1>=this._virtualCount||c+n>=d-this._scrollOffset)break;r.push(e),c+=n,e=(e+1)%l}else{if(o-r.length<=0||c+this._physicalSize-n<=f)break;r.push(e),c-=n,e=e===0?l-1:e-1}return{indexes:r,physicalTop:c-this._scrollOffset}},_update:function(t,e){if(!(t&&t.length===0||this._physicalCount===0)){if(this._assignModels(t),this._updateMetrics(t),e)for(;e.length;){const i=e.pop();this._physicalTop-=this._physicalSizes[i]}this._positionItems(),this._updateScrollerSize()}},_isClientFull:function(){return this._scrollBottom!=0&&this._physicalBottom-1>=this._scrollBottom&&this._physicalTop<=this._scrollPosition},_increasePoolIfNeeded:function(t){const e=this._clamp(this._physicalCount+t,vJ,this._virtualCount-this._virtualStart)-this._physicalCount;let i=Math.round(.5*this._physicalCount);if(!(e<0)){if(e>0){const n=window.performance.now();[].push.apply(this._physicalItems,this._createPool(e));for(let r=0;r<e;r++)this._physicalSizes.push(0);this._physicalCount=this._physicalCount+e,this._physicalStart>this._physicalEnd&&this._isIndexRendered(this._focusedVirtualIndex)&&this._getPhysicalIndex(this._focusedVirtualIndex)<this._physicalEnd&&(this._physicalStart=this._physicalStart+e),this._update(),this._templateCost=(window.performance.now()-n)/e,i=Math.round(.5*this._physicalCount)}this._virtualEnd>=this._virtualCount-1||i===0||(this._isClientFull()?this._physicalSize<this._optPhysicalSize&&this._debounce("_increasePoolIfNeeded",this._increasePoolIfNeeded.bind(this,this._clamp(Math.round(50/this._templateCost),1,i)),fue):this._debounce("_increasePoolIfNeeded",this._increasePoolIfNeeded.bind(this,i),ul))}},_render:function(){if(this.isAttached&&this._isVisible)if(this._physicalCount!==0){const{physicalTop:t,indexes:e}=this._getReusables(!0);this._physicalTop=t,this._virtualStart=this._virtualStart+e.length,this._physicalStart=this._physicalStart+e.length,this._update(e),this._update(),this._increasePoolIfNeeded(0)}else this._virtualCount>0&&(this.updateViewportBoundaries(),this._increasePoolIfNeeded(vJ))},_itemsChanged:function(t){t.path==="items"&&(this._virtualStart=0,this._physicalTop=0,this._virtualCount=this.items?this.items.length:0,this._physicalIndexForKey={},this._firstVisibleIndexVal=null,this._lastVisibleIndexVal=null,this._physicalCount=this._physicalCount||0,this._physicalItems=this._physicalItems||[],this._physicalSizes=this._physicalSizes||[],this._physicalStart=0,this._scrollTop>this._scrollOffset&&this._resetScrollPosition(0),this._debounce("_render",this._render,Yh))},_iterateItems:function(t,e){let i,n,r,s;if(arguments.length===2&&e){for(s=0;s<e.length;s++)if(i=e[s],n=this._computeVidx(i),(r=t.call(this,i,n))!=null)return r}else{for(i=this._physicalStart,n=this._virtualStart;i<this._physicalCount;i++,n++)if((r=t.call(this,i,n))!=null)return r;for(i=0;i<this._physicalStart;i++,n++)if((r=t.call(this,i,n))!=null)return r}},_computeVidx:function(t){return t>=this._physicalStart?this._virtualStart+(t-this._physicalStart):this._virtualStart+(this._physicalCount-this._physicalStart)+t},_updateMetrics:function(t){Sb();let e=0,i=0;const n=this._physicalAverageCount,r=this._physicalAverage;this._iterateItems(function(s){i+=this._physicalSizes[s],this._physicalSizes[s]=this._physicalItems[s].offsetHeight,e+=this._physicalSizes[s],this._physicalAverageCount+=this._physicalSizes[s]?1:0},t),this._physicalSize=this._physicalSize+e-i,this._physicalAverageCount!==n&&(this._physicalAverage=Math.round((r*n+e)/this._physicalAverageCount))},_positionItems:function(){this._adjustScrollPosition();let t=this._physicalTop;this._iterateItems(function(e){this.translate3d(0,t+"px",0,this._physicalItems[e]),t+=this._physicalSizes[e]})},_adjustScrollPosition:function(){const t=this._virtualStart===0?this._physicalTop:Math.min(this._scrollPosition+this._physicalTop,0);if(t!==0){this._physicalTop=this._physicalTop-t;const e=this._scrollTop;!x7e&&e>0&&this._resetScrollPosition(e-t)}},_resetScrollPosition:function(t){this.scrollTarget&&t>=0&&(this._scrollTop=t,this._scrollPosition=this._scrollTop)},_updateScrollerSize:function(t){this._estScrollHeight=this._physicalBottom+Math.max(this._virtualCount-this._physicalCount-this._virtualStart,0)*this._physicalAverage,((t=(t=t||this._scrollHeight===0)||this._scrollPosition>=this._estScrollHeight-this._physicalSize)||Math.abs(this._estScrollHeight-this._scrollHeight)>=this._viewportHeight)&&(this.$.items.style.height=this._estScrollHeight+"px",this._scrollHeight=this._estScrollHeight)},scrollToIndex:function(t){if(typeof t!="number"||t<0||t>this.items.length-1||(Sb(),this._physicalCount===0))return;t=this._clamp(t,0,this._virtualCount-1),(!this._isIndexRendered(t)||t>=this._maxVirtualStart)&&(this._virtualStart=t-1),this._assignModels(),this._updateMetrics(),this._physicalTop=Math.floor(this._virtualStart)*this._physicalAverage;let e=this._physicalStart,i=this._virtualStart,n=0;const r=this._hiddenContentSize;for(;i<t&&n<=r;)n+=this._physicalSizes[e],e=(e+1)%this._physicalCount,i++;this._updateScrollerSize(!0),this._positionItems(),this._resetScrollPosition(this._physicalTop+this._scrollOffset+n),this._increasePoolIfNeeded(0),this._firstVisibleIndexVal=null,this._lastVisibleIndexVal=null},_resetAverage:function(){this._physicalAverage=0,this._physicalAverageCount=0},_resizeHandler:function(){this._debounce("_render",function(){this._firstVisibleIndexVal=null,this._lastVisibleIndexVal=null,this.updateViewportBoundaries(),this._isVisible?(this.toggleScrollListener(!0),this._resetAverage(),this._render()):this.toggleScrollListener(!1)},Yh)},_isIndexRendered:function(t){return t>=this._virtualStart&&t<=this._virtualEnd},_getPhysicalIndex:function(t){return(this._physicalStart+(t-this._virtualStart))%this._physicalCount},_clamp:function(t,e,i){return Math.min(i,Math.max(e,t))},_debounce:function(t,e,i){this._debouncers=this._debouncers||{},this._debouncers[t]=Tn.debounce(this._debouncers[t],i,e.bind(this)),mk(this._debouncers[t])}});class T7e extends S7e{static get properties(){return{size:{type:Number,notify:!0},_vidxOffset:{type:Number,value:0}}}static get observers(){return["_effectiveSizeChanged(_effectiveSize)"]}connectedCallback(){super.connectedCallback(),this._scrollHandler()}_updateScrollerItem(){}_afterScroll(){}_getRowTarget(){}_createScrollerRows(){}_canPopulate(){}scrollToIndex(e){this._warnPrivateAPIAccess("scrollToIndex"),this._scrollingToIndex=!0,e=Math.min(Math.max(e,0),this._effectiveSize-1),this.$.table.scrollTop=e/this._effectiveSize*(this.$.table.scrollHeight-this.$.table.offsetHeight),this._scrollHandler(),this._accessIronListAPI(()=>this._maxScrollTop)&&this._virtualCount<this._effectiveSize&&this._adjustVirtualIndexOffset(1e6),this._accessIronListAPI(()=>super.scrollToIndex(e-this._vidxOffset)),this._scrollHandler();const i=Array.from(this.$.items.children).filter(n=>n.index===e)[0];if(i){const n=i.getBoundingClientRect().top-this.$.header.getBoundingClientRect().bottom;Math.abs(n)>1&&(this.$.table.scrollTop+=n,this._scrollHandler())}this._scrollingToIndex=!1}_effectiveSizeChanged(e){let i,n=0;this._iterateItems((r,s)=>{if(s===this._firstVisibleIndex){const o=this._physicalItems[r];i=o.index,n=o.getBoundingClientRect().top}}),this.items&&e<this.items.length&&(this._scrollTop=0),!Array.isArray(this.items)&&(this.items={length:Math.min(e,1e5)}),this._accessIronListAPI(()=>super._itemsChanged({path:"items"})),this._virtualCount=Math.min(this.items.length,e)||0,this._scrollTop===0&&(this._accessIronListAPI(()=>this._scrollToIndex(Math.min(e-1,i))),this._iterateItems(r=>{const s=this._physicalItems[r];if(s.index===i&&(this.$.table.scrollTop+=Math.round(s.getBoundingClientRect().top-n)),s.index===this._focusedItemIndex&&this._itemsFocusable&&this.$.items.contains(this.shadowRoot.activeElement)){const o=Array.from(this._itemsFocusable.parentElement.children).indexOf(this._itemsFocusable);s.children[o].focus()}})),this._assignModels(),requestAnimationFrame(()=>this._update()),this.__updateFooterPositioning()}_positionItems(){let e;this._adjustScrollPosition(),isNaN(this._physicalTop)&&(e=!0,this._physicalTop=0);let i=this._physicalTop;this._iterateItems(n=>{this._physicalItems[n].style.transform=`translateY(${i}px)`,i+=this._physicalSizes[n]}),e&&this._scrollToIndex(0)}_increasePoolIfNeeded(e){e===0&&this._scrollingToIndex||!this._canPopulate()||!this._effectiveSize||(this._initialPoolCreated?this._optPhysicalSize!==1/0&&(this._debounceIncreasePool=Tn.debounce(this._debounceIncreasePool,Yh,()=>{this._updateMetrics();const i=this._optPhysicalSize-this._physicalSize;let n=Math.ceil(i/this._physicalAverage);this._physicalCount+n>this._effectiveSize&&(n=Math.max(0,this._effectiveSize-this._physicalCount)),this._physicalSize&&n>0&&this._optPhysicalSize!==1/0&&(super._increasePoolIfNeeded(n),this.__reorderChildNodes())})):(this._initialPoolCreated=!0,super._increasePoolIfNeeded(25)))}__reorderChildNodes(){const e=Array.from(this.$.items.childNodes);e.reduce((i,n,r,s)=>{if(r===0||s[r-1].index===n.index-1)return i},!0)||e.sort((i,n)=>i.index-n.index).forEach(i=>this.$.items.appendChild(i))}_createPool(e){const i=document.createDocumentFragment(),n=this._createScrollerRows(e);n.forEach(s=>i.appendChild(s)),this._getRowTarget().appendChild(i);const r=this.querySelector("[slot]");if(r){const s=r.getAttribute("slot");r.setAttribute("slot","foo-bar"),r.setAttribute("slot",s)}return sUe(this,()=>this.notifyResize()),n}_assignModels(e){this._iterateItems((i,n)=>{const r=this._physicalItems[i];this._toggleAttribute("hidden",n>=this._effectiveSize,r),this._updateScrollerItem(r,n+(this._vidxOffset||0))},e)}_scrollHandler(){const e=this.$.table.scrollTop-this._scrollPosition;this._accessIronListAPI(super._scrollHandler);const i=this._vidxOffset;this._accessIronListAPI(()=>this._maxScrollTop)&&this._virtualCount<this._effectiveSize?this._adjustVirtualIndexOffset(e):this._vidxOffset=0,this._vidxOffset!==i&&this._update(),this._afterScroll()}_adjustVirtualIndexOffset(e){if(Math.abs(e)>1e4){if(this._noScale)return void(this._noScale=!1);const i=this.$.table.scrollTop/(this.$.table.scrollHeight-this.$.table.offsetHeight),n=i*this._effectiveSize;this._vidxOffset=Math.round(n-i*this._virtualCount)}else{const i=this._vidxOffset||0,n=1e3,r=100;this._scrollTop===0?(this._vidxOffset=0,i!==this._vidxOffset&&super.scrollToIndex(0)):this.firstVisibleIndex<n&&this._vidxOffset>0&&(this._vidxOffset-=Math.min(this._vidxOffset,r),i!==this._vidxOffset&&super.scrollToIndex(this.firstVisibleIndex+(i-this._vidxOffset)),this._noScale=!0);const s=this._effectiveSize-this._virtualCount;this._scrollTop>=this._maxScrollTop&&this._maxScrollTop>0?(this._vidxOffset=s,i!==this._vidxOffset&&super.scrollToIndex(this._virtualCount)):this.firstVisibleIndex>this._virtualCount-n&&this._vidxOffset<s&&(this._vidxOffset+=Math.min(s-this._vidxOffset,r),i!==this._vidxOffset&&super.scrollToIndex(this.firstVisibleIndex-(this._vidxOffset-i)),this._noScale=!0)}}_accessIronListAPI(e){this._warnPrivateAPIAccessAsyncEnabled=!1;const i=e.apply(this);return this._debouncerWarnPrivateAPIAccess=Tn.debounce(this._debouncerWarnPrivateAPIAccess,Yh,()=>this._warnPrivateAPIAccessAsyncEnabled=!0),i}_debounceRender(e,i){super._debounceRender(()=>this._accessIronListAPI(e),i)}_warnPrivateAPIAccess(e){this._warnPrivateAPIAccessAsyncEnabled&&console.warn(`Accessing private API (${e})!`)}_render(){this._accessIronListAPI(super._render)}_itemsChanged(){}get _firstVisibleIndex(){return this._accessIronListAPI(()=>super.firstVisibleIndex)}get _lastVisibleIndex(){return this._accessIronListAPI(()=>super.lastVisibleIndex)}_scrollToIndex(e){this._accessIronListAPI(()=>this.scrollToIndex(e))}get firstVisibleIndex(){return this._warnPrivateAPIAccess("firstVisibleIndex"),super.firstVisibleIndex}set firstVisibleIndex(e){this._warnPrivateAPIAccess("firstVisibleIndex"),super.firstVisibleIndex=e}get lastVisibleIndex(){return this._warnPrivateAPIAccess("lastVisibleIndex"),super.lastVisibleIndex}set lastVisibleIndex(e){this._warnPrivateAPIAccess("lastVisibleIndex"),super.lastVisibleIndex=e}updateViewportBoundaries(){this._warnPrivateAPIAccess("updateViewportBoundaries"),super.updateViewportBoundaries.apply(this,arguments)}_resizeHandler(){super._resizeHandler(),Sb()}}const I7e=t=>class extends t{static get observers(){return["_a11yUpdateGridSize(size, _columnTree, _columnTree.*)"]}_a11yGetHeaderRowCount(e){return e.filter(i=>i.some(n=>n._headerTemplate||n.headerRenderer||n.path||n.header)).length}_a11yGetFooterRowCount(e){return e.filter(i=>i.some(n=>n._headerTemplate||n.headerRenderer)).length}_a11yUpdateGridSize(e,i){if(e===void 0||i===void 0)return;const n=i[i.length-1];this.$.table.setAttribute("aria-rowcount",e+this._a11yGetHeaderRowCount(i)+this._a11yGetFooterRowCount(i)),this.$.table.setAttribute("aria-colcount",n&&n.length||0),this._a11yUpdateHeaderRows(),this._a11yUpdateFooterRows()}_a11yUpdateHeaderRows(){Array.from(this.$.header.children).forEach((e,i)=>e.setAttribute("aria-rowindex",i+1))}_a11yUpdateFooterRows(){Array.from(this.$.footer.children).forEach((e,i)=>e.setAttribute("aria-rowindex",this._a11yGetHeaderRowCount(this._columnTree)+this.size+i+1))}_a11yUpdateRowRowindex(e,i){e.setAttribute("aria-rowindex",i+this._a11yGetHeaderRowCount(this._columnTree)+1)}_a11yUpdateRowSelected(e,i){e.setAttribute("aria-selected",!!i),Array.from(e.children).forEach(n=>n.setAttribute("aria-selected",!!i))}_a11yUpdateRowLevel(e,i){e.setAttribute("aria-level",i+1)}_a11yUpdateRowDetailsOpened(e,i){Array.from(e.children).forEach(n=>{typeof i=="boolean"?n.setAttribute("aria-expanded",i):n.hasAttribute("aria-expanded")&&n.removeAttribute("aria-expanded")})}_a11ySetRowDetailsCell(e,i){Array.from(e.children).forEach(n=>{n!==i&&n.setAttribute("aria-controls",i.id)})}_a11yUpdateCellColspan(e,i){e.setAttribute("aria-colspan",Number(i))}_a11yUpdateSorters(){Array.from(this.querySelectorAll("vaadin-grid-sorter")).forEach(e=>{let i=e.parentNode;for(;i&&i.localName!=="vaadin-grid-cell-content";)i=i.parentNode;i&&i.assignedSlot&&i.assignedSlot.parentNode.setAttribute("aria-sort",{asc:"ascending",desc:"descending"}[String(e.direction)]||"none")})}},C7e=t=>class extends t{static get properties(){return{activeItem:{type:Object,notify:!0,value:null}}}ready(){super.ready(),this.$.scroller.addEventListener("click",this._onClick.bind(this)),this.addEventListener("cell-activate",this._activateItem.bind(this))}_activateItem(e){const i=e.detail.model,n=i?i.item:null;n&&(this.activeItem=this._itemsEqual(this.activeItem,n)?null:n)}_onClick(e){if(e.defaultPrevented)return;const i=e.composedPath(),n=i[i.indexOf(this.$.table)-3];if(!n||n.getAttribute("part").indexOf("details-cell")>-1)return;const r=n._content,s=this.getRootNode().activeElement;r.contains(s)||this._isFocusable(e.target)||this.dispatchEvent(new CustomEvent("cell-activate",{detail:{model:this.__getRowModel(n.parentElement)}}))}_isFocusable(e){return M7e(e)}},M7e=t=>{if(!t.parentNode)return!1;const e=Array.from(t.parentNode.querySelectorAll("[tabindex], button, input, select, textarea, object, iframe, label, a[href], area[href]")).filter(i=>i.getAttribute("part")!=="cell body-cell").indexOf(t)!==-1;return!t.disabled&&e},E7e=t=>class extends t{static get properties(){return{items:Array}}static get observers(){return["_itemsChanged(items, items.*, isAttached)"]}_itemsChanged(e,i,n){if(n){if(!Array.isArray(e))return e==null&&(this.size=0),void(this.dataProvider===this._arrayDataProvider&&(this.dataProvider=void 0));this.size=e.length,this.dataProvider=this.dataProvider||this._arrayDataProvider,this.clearCache(),this._ensureFirstPageLoaded()}}_arrayDataProvider(e,i){let n=(Array.isArray(this.items)?this.items:[]).slice(0);this._filters&&this._checkPaths(this._filters,"filtering",n)&&(n=this._filter(n)),this.size=n.length,e.sortOrders.length&&this._checkPaths(this._sorters,"sorting",n)&&(n=n.sort(this._multiSort.bind(this)));const r=e.page*e.pageSize,s=r+e.pageSize;i(n.slice(r,s),n.length)}_checkPaths(e,i,n){if(!n.length)return!1;let r=!0;for(let s in e){const o=e[s].path;if(!o||o.indexOf(".")===-1)continue;const a=o.replace(/\.[^.]*$/,"");j0.get(a,n[0])===void 0&&(console.warn(`Path "${o}" used for ${i} does not exist in all of the items, ${i} is disabled.`),r=!1)}return r}_multiSort(e,i){return this._sorters.map(n=>n.direction==="asc"?this._compare(j0.get(n.path,e),j0.get(n.path,i)):n.direction==="desc"?this._compare(j0.get(n.path,i),j0.get(n.path,e)):0).reduce((n,r)=>n||r,0)}_normalizeEmptyValue(e){return[void 0,null].indexOf(e)>=0?"":isNaN(e)?e.toString():e}_compare(e,i){return(e=this._normalizeEmptyValue(e))<(i=this._normalizeEmptyValue(i))?-1:e>i?1:0}_filter(e){return e.filter(i=>this._filters.filter(n=>{const r=this._normalizeEmptyValue(j0.get(n.path,i)),s=this._normalizeEmptyValue(n.value).toString().toLowerCase();return r.toString().toLowerCase().indexOf(s)===-1}).length===0)}},A7e=t=>class extends yT(t){ready(){super.ready();const e=this.$.scroller;w8(e,"track",this._onHeaderTrack.bind(this)),e.addEventListener("touchmove",i=>e.hasAttribute("column-resizing")&&i.preventDefault()),e.addEventListener("contextmenu",i=>i.target.getAttribute("part")=="resize-handle"&&i.preventDefault()),e.addEventListener("mousedown",i=>i.target.getAttribute("part")==="resize-handle"&&i.preventDefault())}_onHeaderTrack(e){const i=e.target;if(i.getAttribute("part")==="resize-handle"){let n=i.parentElement._column;for(this._toggleAttribute("column-resizing",!0,this.$.scroller);n.localName==="vaadin-grid-column-group";)n=Array.prototype.slice.call(n._childColumns,0).sort(function(o,a){return o._order-a._order}).filter(function(o){return!o.hidden}).pop();const r=Array.from(this.$.header.querySelectorAll('[part~="row"]:last-child [part~="cell"]')),s=r.filter(o=>o._column===n)[0];if(s.offsetWidth){const o=window.getComputedStyle(s),a=10+parseInt(o.paddingLeft)+parseInt(o.paddingRight)+parseInt(o.borderLeftWidth)+parseInt(o.borderRightWidth)+parseInt(o.marginLeft)+parseInt(o.marginRight),l=s.offsetWidth+(this.__isRTL?s.getBoundingClientRect().left-e.detail.x:e.detail.x-s.getBoundingClientRect().right);n.width=Math.max(a,l)+"px",n.flexGrow=0}r.sort(function(o,a){return o._column._order-a._column._order}).forEach(function(o,a,l){a<l.indexOf(s)&&(o._column.width=o.offsetWidth+"px",o._column.flexGrow=0)}),e.detail.state==="end"&&(this._toggleAttribute("column-resizing",!1,this.$.scroller),this.dispatchEvent(new CustomEvent("column-resize",{detail:{resizedColumn:n}}))),this._resizeHandler()}}},_J=class lhe{constructor(e,i,n){this.grid=e,this.parentCache=i,this.parentItem=n,this.itemCaches={},this.items={},this.effectiveSize=0,this.size=0,this.pendingRequests={}}isLoading(){return!!(Object.keys(this.pendingRequests).length||Object.keys(this.itemCaches).filter(e=>this.itemCaches[e].isLoading())[0])}getItemForIndex(e){const{cache:i,scaledIndex:n}=this.getCacheAndIndex(e);return i.items[n]}updateSize(){this.effectiveSize=!this.parentItem||this.grid._isExpanded(this.parentItem)?this.size+Object.keys(this.itemCaches).reduce((e,i)=>{const n=this.itemCaches[i];return n.updateSize(),e+n.effectiveSize},0):0}ensureSubCacheForScaledIndex(e){if(!this.itemCaches[e]){const i=new lhe(this.grid,this,this.items[e]);this.itemCaches[e]=i,this.grid._loadPage(0,i)}}getCacheAndIndex(e){let i=e;const n=Object.keys(this.itemCaches);for(let r=0;r<n.length;r++){const s=Number(n[r]),o=this.itemCaches[s];if(i<=s)return{cache:this,scaledIndex:i};if(i<=s+o.effectiveSize)return o.getCacheAndIndex(i-s-1);i-=o.effectiveSize}return{cache:this,scaledIndex:i}}},$7e=t=>class extends t{static get properties(){return{pageSize:{type:Number,value:50,observer:"_pageSizeChanged"},dataProvider:{type:Object,notify:!0,observer:"_dataProviderChanged"},loading:{type:Boolean,notify:!0,readOnly:!0,reflectToAttribute:!0},_cache:{type:Object,value:function(){return new _J(this)}},itemIdPath:{type:String,value:null},expandedItems:{type:Object,notify:!0,value:()=>[]}}}static get observers(){return["_sizeChanged(size)","_itemIdPathChanged(itemIdPath)","_expandedItemsChanged(expandedItems.*)"]}_sizeChanged(e){const i=e-this._cache.size;this._cache.size+=i,this._cache.effectiveSize+=i,this._effectiveSize=this._cache.effectiveSize,this._increasePoolIfNeeded(0),this._debounceIncreasePool&&this._debounceIncreasePool.flush()}_getItem(e,i){if(e>=this._effectiveSize)return;i.index=e;const{cache:n,scaledIndex:r}=this._cache.getCacheAndIndex(e),s=n.items[r];s?(this._toggleAttribute("loading",!1,i),this._updateItem(i,s),this._isExpanded(s)&&n.ensureSubCacheForScaledIndex(r)):(this._toggleAttribute("loading",!0,i),this._loadPage(this._getPageForIndex(r),n))}_expandedInstanceChangedCallback(e,i){e.item!==void 0&&(i?this.expandItem(e.item):this.collapseItem(e.item))}getItemId(e){return this.itemIdPath?this.get(this.itemIdPath,e):e}_isExpanded(e){return this.__expandedKeys.has(this.getItemId(e))}_expandedItemsChanged(){this.__cacheExpandedKeys(),this._cache.updateSize(),this._effectiveSize=this._cache.effectiveSize,this._assignModels()}_itemIdPathChanged(){this.__cacheExpandedKeys()}__cacheExpandedKeys(){this.expandedItems&&(this.__expandedKeys=new Set,this.expandedItems.forEach(e=>{this.__expandedKeys.add(this.getItemId(e))}))}expandItem(e){this._isExpanded(e)||this.push("expandedItems",e)}collapseItem(e){this._isExpanded(e)&&this.splice("expandedItems",this._getItemIndexInArray(e,this.expandedItems),1)}_getIndexLevel(e){let{cache:i}=this._cache.getCacheAndIndex(e),n=0;for(;i.parentCache;)i=i.parentCache,n++;return n}_canPopulate(){return!!(this._hasData&&this._columnTree)}_loadPage(e,i){if(!i.pendingRequests[e]&&this.dataProvider){this._setLoading(!0),i.pendingRequests[e]=!0;const n={page:e,pageSize:this.pageSize,sortOrders:this._mapSorters(),filters:this._mapFilters(),parentItem:i.parentItem};this._debounceIncreasePool&&this._debounceIncreasePool.flush(),this.dataProvider(n,(r,s)=>{s!==void 0?i.size=s:n.parentItem&&(i.size=r.length);const o=Array.from(this.$.items.children).map(a=>a._item);r.forEach((a,l)=>{const c=e*this.pageSize+l;i.items[c]=a,this._isExpanded(a)&&o.indexOf(a)>-1&&i.ensureSubCacheForScaledIndex(c)}),this._hasData=!0,delete i.pendingRequests[e],this._debouncerApplyCachedData=Tn.debounce(this._debouncerApplyCachedData,_c.after(0),()=>{this._setLoading(!1),this._cache.updateSize(),this._effectiveSize=this._cache.effectiveSize,Array.from(this.$.items.children).filter(a=>!a.hidden).forEach(a=>{this._cache.getItemForIndex(a.index)&&this._getItem(a.index,a)}),this._increasePoolIfNeeded(0),this.__scrollToPendingIndex()}),this._cache.isLoading()||this._debouncerApplyCachedData.flush(),this.__itemsReceived()})}}_getPageForIndex(e){return Math.floor(e/this.pageSize)}clearCache(){this._cache=new _J(this),Array.from(this.$.items.children).forEach(e=>{Array.from(e.children).forEach(i=>{i._instance&&i._instance._setPendingProperty("item",{},!1)})}),this._cache.size=this.size||0,this._cache.updateSize(),this._hasData=!1,this._assignModels(),this._effectiveSize&&this._initialPoolCreated||this._loadPage(0,this._cache)}_pageSizeChanged(e,i){i!==void 0&&e!==i&&this.clearCache()}_checkSize(){this.size===void 0&&this._effectiveSize===0&&console.warn("The <vaadin-grid> needs the total number of items in order to display rows. Set the total number of items to the `size` property, or provide the total number of items in the second argument of the `dataProvider`s `callback` call.")}_dataProviderChanged(e,i){i!==void 0&&this.clearCache(),e&&this.items&&this.items.length&&this._scrollToIndex(this._firstVisibleIndex),this._ensureFirstPageLoaded(),this._debouncerCheckSize=Tn.debounce(this._debouncerCheckSize,_c.after(2e3),this._checkSize.bind(this)),this._scrollHandler()}_ensureFirstPageLoaded(){this._hasData||this._loadPage(0,this._cache)}_itemsEqual(e,i){return this.getItemId(e)===this.getItemId(i)}_getItemIndexInArray(e,i){let n=-1;return i.forEach((r,s)=>{this._itemsEqual(r,e)&&(n=s)}),n}scrollToIndex(e){super.scrollToIndex(e),isNaN(e)||!this._cache.isLoading()&&this.clientHeight||(this.__pendingScrollToIndex=e)}__scrollToPendingIndex(){if(this.__pendingScrollToIndex&&this.$.items.children.length){const e=this.__pendingScrollToIndex;delete this.__pendingScrollToIndex,this._debounceIncreasePool&&this._debounceIncreasePool.flush(),this.scrollToIndex(e)}}},P7e=t=>class extends t{ready(){super.ready(),this._addNodeObserver()}_hasColumnGroups(e){for(let i=0;i<e.length;i++)if(e[i].localName==="vaadin-grid-column-group")return!0;return!1}_getChildColumns(e){return Kh.getFlattenedNodes(e).filter(this._isColumnElement)}_flattenColumnGroups(e){return e.map(i=>i.localName==="vaadin-grid-column-group"?this._getChildColumns(i):[i]).reduce((i,n)=>i.concat(n),[])}_getColumnTree(){const e=[];for(let i=Kh.getFlattenedNodes(this).filter(this._isColumnElement);e.push(i),this._hasColumnGroups(i);)i=this._flattenColumnGroups(i);return e}_updateColumnTree(){const e=this._getColumnTree();this._arrayEquals(e,this._columnTree)||(this._columnTree=e)}_addNodeObserver(){this._observer=new Kh(this,e=>{const i=e.addedNodes.filter(r=>r.localName==="template"&&r.classList.contains("row-details"))[0];i&&this._rowDetailsTemplate!==i&&(this._rowDetailsTemplate=i);const n=r=>r.filter(this._isColumnElement).length>0;if(n(e.addedNodes)||n(e.removedNodes)){const r=e.removedNodes.flatMap(o=>o._allCells),s=o=>r.filter(a=>a._content.contains(o)).length;this.__removeSorters(this._sorters.filter(s)),this.__removeFilters(this._filters.filter(s)),this._updateColumnTree()}this._debouncerCheckImports=Tn.debounce(this._debouncerCheckImports,_c.after(2e3),this._checkImports.bind(this)),this._ensureFirstPageLoaded()})}_arrayEquals(e,i){if(!e||!i||e.length!=i.length)return!1;for(let n=0,r=e.length;n<r;n++)if(e[n]instanceof Array&&i[n]instanceof Array){if(!this._arrayEquals(e[n],i[n]))return!1}else if(e[n]!=i[n])return!1;return!0}_checkImports(){["vaadin-grid-column-group","vaadin-grid-filter","vaadin-grid-filter-column","vaadin-grid-tree-toggle","vaadin-grid-selection-column","vaadin-grid-sort-column","vaadin-grid-sorter"].forEach(e=>{const i=this.querySelector(e);!i||i instanceof _d||console.warn(`Make sure you have imported the required module for <${e}> element.`)})}_updateFirstAndLastColumn(){Array.from(this.shadowRoot.querySelectorAll("tr")).forEach(e=>this._updateFirstAndLastColumnForRow(e))}_updateFirstAndLastColumnForRow(e){Array.from(e.querySelectorAll('[part~="cell"]:not([part~="details-cell"])')).sort((i,n)=>i._column._order-n._column._order).forEach((i,n,r)=>{this._toggleAttribute("first-column",n===0,i),this._toggleAttribute("last-column",n===r.length-1,i)})}_isColumnElement(e){return e.nodeType===Node.ELEMENT_NODE&&/\bcolumn\b/.test(e.localName)}},k7e=t=>class extends t{getEventContext(e){const i={},n=e.composedPath(),r=n[n.indexOf(this.$.table)-3];return r&&(i.section=["body","header","footer","details"].filter(s=>r.getAttribute("part").indexOf(s)>-1)[0],r._column&&(i.column=r._column),i.section!=="body"&&i.section!=="details"||Object.assign(i,this.__getRowModel(r.parentElement))),i}},O7e=t=>class extends t{static get properties(){return{_filters:{type:Array,value:function(){return[]}}}}ready(){super.ready(),this.addEventListener("filter-changed",this._filterChanged.bind(this))}_filterChanged(e){e.stopPropagation(),this.__addFilter(e.target),this.__applyFilters()}__removeFilters(e){e.length!=0&&(this._filters=this._filters.filter(i=>e.indexOf(i)<0),this.__applyFilters())}__addFilter(e){this._filters.indexOf(e)===-1&&this._filters.push(e)}__applyFilters(){this.dataProvider&&this.isAttached&&this.clearCache()}_mapFilters(){return this._filters.map(e=>({path:e.path,value:e.value}))}};class p$ extends _d{static get is(){return"vaadin-grid-templatizer"}static get properties(){return{dataHost:Object,template:Object,_templateInstances:{type:Array,value:function(){return[]}},_parentPathValues:{value:function(){return{}}},_grid:Object}}static get observers(){return["_templateInstancesChanged(_templateInstances.*, _parentPathValues.*)"]}constructor(){super(),this._instanceProps={detailsOpened:!0,index:!0,item:!0,selected:!0,expanded:!0,level:!0}}createInstance(){this._ensureTemplatized();const e=new this._TemplateClass({});return this.addInstance(e),e}addInstance(e){this._templateInstances.indexOf(e)===-1&&(this._templateInstances.push(e),requestAnimationFrame(()=>this.notifyPath("_templateInstances.*",this._templateInstances)))}removeInstance(e){const i=this._templateInstances.indexOf(e);this.splice("_templateInstances",i,1)}_ensureTemplatized(){this._TemplateClass||(this._TemplateClass=mS(this.template,this,{instanceProps:this._instanceProps,parentModel:!0,forwardHostProp:function(e,i){this._forwardParentProp(e,i),this._templateInstances&&this._templateInstances.forEach(n=>n.notifyPath(e,i))},notifyInstanceProp:function(e,i,n){if(i==="index"||i==="item")return;const r=`__${i}__`;if(e[r]===n)return;e[r]=n;const s=Array.from(this._grid.$.items.children).filter(l=>this._grid._itemsEqual(l._item,e.item))[0];s&&Array.from(s.children).forEach(l=>{l._instance&&(l._instance[r]=n,l._instance.notifyPath(i,n))});const o="item.";if(Array.isArray(this._grid.items)&&i.indexOf(o)===0){const l=this._grid.items.indexOf(e.item),c=i.slice(o.length);this._grid.notifyPath(`items.${l}.${c}`,n)}const a=`_${i}InstanceChangedCallback`;this._grid&&this._grid[a]&&this._grid[a](e,n)}}))}_forwardParentProp(e,i){this._parentPathValues[e]=i,this._templateInstances.forEach(n=>n.notifyPath(e,i))}_templateInstancesChanged(e){let i,n;if(e.path==="_templateInstances")i=0,n=this._templateInstances.length;else{if(e.path!=="_templateInstances.splices")return;i=e.value.index,n=e.value.addedCount}Object.keys(this._parentPathValues||{}).forEach(r=>{for(let s=i;s<i+n;s++)this._templateInstances[s].set(r,this._parentPathValues[r])})}}customElements.define(p$.is,p$);const L7e=t=>class extends t{static get properties(){return{detailsOpenedItems:{type:Array,value:function(){return[]}},_rowDetailsTemplate:Object,rowDetailsRenderer:Function,_detailsCells:{type:Array}}}static get observers(){return["_detailsOpenedItemsChanged(detailsOpenedItems.*, _rowDetailsTemplate, rowDetailsRenderer)","_rowDetailsTemplateOrRendererChanged(_rowDetailsTemplate, rowDetailsRenderer)"]}_rowDetailsTemplateOrRendererChanged(e,i){if(e&&i)throw new Error("You should only use either a renderer or a template for row details");if(e||i){if(e&&!e.templatizer){const n=new p$;n._grid=this,n.dataHost=this.dataHost,n.template=e,e.templatizer=n}this._columnTree&&Array.from(this.$.items.children).forEach(n=>{n.querySelector("[part~=details-cell]")||(this._updateRow(n,this._columnTree[this._columnTree.length-1]),this._a11yUpdateRowDetailsOpened(n,!1)),delete n.querySelector("[part~=details-cell]")._instance}),this.detailsOpenedItems.length&&(Array.from(this.$.items.children).forEach(this._toggleDetailsCell,this),this._update())}}_detailsOpenedItemsChanged(e){e.path!=="detailsOpenedItems.length"&&e.value&&Array.from(this.$.items.children).forEach(i=>{this._toggleDetailsCell(i,i._item),this._a11yUpdateRowDetailsOpened(i,this._isDetailsOpened(i._item)),this._toggleAttribute("details-opened",this._isDetailsOpened(i._item),i)})}_configureDetailsCell(e){e.setAttribute("part","cell details-cell"),this._toggleAttribute("frozen",!0,e)}_toggleDetailsCell(e,i){const n=e.querySelector('[part~="details-cell"]');if(!n)return;const r=!this._isDetailsOpened(i),s=!!n.hidden!==r;(n._instance||n._renderer)&&n.hidden===r||(n.hidden=r,r?e.style.removeProperty("padding-bottom"):(this.rowDetailsRenderer?(n._renderer=this.rowDetailsRenderer,n._renderer.call(this,n._content,this,{index:e.index,item:i})):this._rowDetailsTemplate&&!n._instance&&(n._instance=this._rowDetailsTemplate.templatizer.createInstance(),n._content.innerHTML="",n._content.appendChild(n._instance.root),this._updateItem(e,i)),Sb(),e.style.setProperty("padding-bottom",`${n.offsetHeight}px`),requestAnimationFrame(()=>this.notifyResize()))),s&&(this._updateMetrics(),this._positionItems())}_updateDetailsCellHeights(){Array.from(this.$.items.querySelectorAll('[part~="details-cell"]:not([hidden])')).forEach(e=>{e.parentElement.style.setProperty("padding-bottom",`${e.offsetHeight}px`)})}_isDetailsOpened(e){return this.detailsOpenedItems&&this._getItemIndexInArray(e,this.detailsOpenedItems)!==-1}openItemDetails(e){this._isDetailsOpened(e)||this.push("detailsOpenedItems",e)}closeItemDetails(e){this._isDetailsOpened(e)&&this.splice("detailsOpenedItems",this._getItemIndexInArray(e,this.detailsOpenedItems),1)}_detailsOpenedInstanceChangedCallback(e,i){i?this.openItemDetails(e.item):this.closeItemDetails(e.item)}},nL={SCROLLING:500,IGNORE_WHEEL:500},R7e=t=>class extends t{static get properties(){return{_frozenCells:{type:Array,value:()=>[]},_rowWithFocusedElement:Element,_deltaYAcc:{type:Number,value:0},_useSticky:{type:Boolean,value:window.CSS&&window.CSS.supports&&(window.CSS.supports("position","sticky")||window.CSS.supports("position","-webkit-sticky"))}}}static get observers(){return["_scrollViewportHeightUpdated(_viewportHeight)"]}set _scrollTop(e){this.$.table.scrollTop=e}get _scrollTop(){return this.$.table.scrollTop}constructor(){super(),this._scrollLineHeight=this._getScrollLineHeight()}_getScrollLineHeight(){const e=document.createElement("div");e.style.fontSize="initial",e.style.display="none",document.body.appendChild(e);const i=window.getComputedStyle(e).fontSize;return document.body.removeChild(e),i?window.parseInt(i):void 0}_scrollViewportHeightUpdated(e){this._scrollPageHeight=e-this.$.header.clientHeight-this.$.footer.clientHeight-this._scrollLineHeight}ready(){super.ready(),this.$.outerscroller=document.createElement("div"),this.scrollTarget=this.$.table,this.addEventListener("wheel",this._onWheel),this.$.items.addEventListener("focusin",e=>{const i=e.composedPath().indexOf(this.$.items);this._rowWithFocusedElement=e.composedPath()[i-1]}),this.$.items.addEventListener("focusout",()=>this._rowWithFocusedElement=void 0),this.scrollTarget.addEventListener("mousedown",()=>this.__mouseDown=!0),this.scrollTarget.addEventListener("mouseup",()=>{this.__mouseDown=!1,this.__pendingReorder&&(this.__pendingReorder=!1,setTimeout(()=>this._reorderRows(),nL.SCROLLING))})}scrollToIndex(e){this._accessIronListAPI(()=>super.scrollToIndex(e))}_onWheel(e){if(e.ctrlKey||this._hasScrolledAncestor(e.target,e.deltaX,e.deltaY))return;const i=this.$.table;let n=e.deltaY;if(e.deltaMode===WheelEvent.DOM_DELTA_LINE?n*=this._scrollLineHeight:e.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(n*=this._scrollPageHeight),this._wheelAnimationFrame)return this._deltaYAcc+=n,void e.preventDefault();n+=this._deltaYAcc,this._deltaYAcc=0,this._wheelAnimationFrame=!0,this._debouncerWheelAnimationFrame=Tn.debounce(this._debouncerWheelAnimationFrame,Yh,()=>this._wheelAnimationFrame=!1);const r=Math.abs(e.deltaX)+Math.abs(n);this._canScroll(i,e.deltaX,n)?(e.preventDefault(),i.scrollTop+=n,i.scrollLeft+=e.deltaX,this._scrollHandler(),this._hasResidualMomentum=!0,this._ignoreNewWheel=!0,this._debouncerIgnoreNewWheel=Tn.debounce(this._debouncerIgnoreNewWheel,_c.after(nL.IGNORE_WHEEL),()=>this._ignoreNewWheel=!1)):this._hasResidualMomentum&&r<=this._previousMomentum||this._ignoreNewWheel?e.preventDefault():r>this._previousMomentum&&(this._hasResidualMomentum=!1),this._previousMomentum=r}_hasScrolledAncestor(e,i,n){return e.localName!=="vaadin-grid-cell-content"&&(!(!this._canScroll(e,i,n)||["auto","scroll"].indexOf(getComputedStyle(e).overflow)===-1)||(e!==this&&e.parentElement?this._hasScrolledAncestor(e.parentElement,i,n):void 0))}_canScroll(e,i,n){return n>0&&e.scrollTop<e.scrollHeight-e.offsetHeight||n<0&&e.scrollTop>0||i>0&&e.scrollLeft<e.scrollWidth-e.offsetWidth||i<0&&e.scrollLeft>0}_scheduleScrolling(){this._scrollingFrame||(this._scrollingFrame=requestAnimationFrame(()=>this._toggleAttribute("scrolling",!0,this.$.scroller))),this._debounceScrolling=Tn.debounce(this._debounceScrolling,_c.after(nL.SCROLLING),()=>{cancelAnimationFrame(this._scrollingFrame),delete this._scrollingFrame,this._toggleAttribute("scrolling",!1,this.$.scroller),this._reorderRows()})}_afterScroll(){this._translateStationaryElements(),this.hasAttribute("reordering")||this._scheduleScrolling(),this._updateOverflow()}_updateOverflow(){let e="";const i=this.$.table;i.scrollTop<i.scrollHeight-i.clientHeight&&(e+=" bottom"),i.scrollTop>0&&(e+=" top"),i.scrollLeft<i.scrollWidth-i.clientWidth&&(e+=" right"),i.scrollLeft>0&&(e+=" left"),this._debounceOverflow=Tn.debounce(this._debounceOverflow,Yh,()=>{const n=e.trim();n.length>0&&this.getAttribute("overflow")!==n?this.setAttribute("overflow",n):n.length==0&&this.hasAttribute("overflow")&&this.removeAttribute("overflow")})}_reorderRows(){if(this.__mouseDown)return void(this.__pendingReorder=!0);const e=this.$.items,i=e.querySelectorAll("tr");if(!i.length)return;const n=this._virtualStart+this._vidxOffset,r=this._rowWithFocusedElement||Array.from(i).filter(a=>!a.hidden)[0];if(!r)return;const s=r.index-n,o=Array.from(i).indexOf(r)-s;if(o>0)for(let a=0;a<o;a++)e.appendChild(i[a]);else if(o<0)for(let a=i.length+o;a<i.length;a++)e.insertBefore(i[a],i[0]);if(this._safari){const{transform:a}=this.$.header.style;this.$.header.style.transform="",setTimeout(()=>this.$.header.style.transform=a)}}_frozenCellsChanged(){this._debouncerCacheElements=Tn.debounce(this._debouncerCacheElements,ul,()=>{Array.from(this.shadowRoot.querySelectorAll('[part~="cell"]')).forEach(function(e){e.style.transform=""}),this._frozenCells=Array.prototype.slice.call(this.$.table.querySelectorAll("[frozen]")),this._updateScrollerMeasurements(),this._translateStationaryElements()}),this._updateLastFrozen()}_updateScrollerMeasurements(){this._frozenCells.length>0&&this.__isRTL&&(this.__scrollerMetrics={scrollWidth:this.$.table.scrollWidth,clientWidth:this.$.table.clientWidth})}_updateLastFrozen(){if(!this._columnTree)return;const e=this._columnTree[this._columnTree.length-1].slice(0);e.sort((n,r)=>n._order-r._order);const i=e.reduce((n,r,s)=>(r._lastFrozen=!1,r.frozen&&!r.hidden?s:n),void 0);i!==void 0&&(e[i]._lastFrozen=!0)}_translateStationaryElements(){const e=Math.max(0,this._scrollLeft),i=Math.max(0,this._scrollTop);let n=0,r=0,s=0;if(this._useSticky||(n=e,r=i,s=this.$.table.clientHeight-this.$.footer.offsetHeight-this.$.footer.offsetTop),this.$.header.style.transform=this._getTranslate(-e+n,r),this.$.footer.style.transform=this._getTranslate(-e+n,r+s),this.$.items.style.transform=this._getTranslate(-e+n,0),this._frozenCells.length>0){const o=this.__isRTL?this.__getNormalizedScrollLeft(this.$.table)+this.__scrollerMetrics.clientWidth-this.__scrollerMetrics.scrollWidth:this._scrollLeft,a=this._getTranslate(o,0);for(let l=0;l<this._frozenCells.length;l++)this._frozenCells[l].style.transform=a}}_getTranslate(e,i){return`translate(${e}px, ${i}px)`}},D7e=t=>class extends t{static get properties(){return{selectedItems:{type:Object,notify:!0,value:()=>[]}}}static get observers(){return["_selectedItemsChanged(selectedItems.*)"]}_isSelected(e){return this.selectedItems&&this._getItemIndexInArray(e,this.selectedItems)>-1}selectItem(e){this._isSelected(e)||this.push("selectedItems",e)}deselectItem(e){const i=this._getItemIndexInArray(e,this.selectedItems);i>-1&&this.splice("selectedItems",i,1)}_toggleItem(e){this._getItemIndexInArray(e,this.selectedItems)===-1?this.selectItem(e):this.deselectItem(e)}_selectedItemsChanged(e){!this.$.items.children.length||e.path!=="selectedItems"&&e.path!=="selectedItems.splices"||Array.from(this.$.items.children).forEach(i=>{this._updateItem(i,i._item)})}_selectedInstanceChangedCallback(e,i){i?this.selectItem(e.item):this.deselectItem(e.item)}},N7e=t=>class extends t{static get properties(){return{multiSort:{type:Boolean,value:!1},_sorters:{type:Array,value:function(){return[]}},_previousSorters:{type:Array,value:function(){return[]}}}}ready(){super.ready(),this.addEventListener("sorter-changed",this._onSorterChanged)}_onSorterChanged(e){const i=e.target;e.stopPropagation(),this.__updateSorter(i),this.__applySorters()}__removeSorters(e){e.length!=0&&(this._sorters=this._sorters.filter(i=>e.indexOf(i)<0),this.multiSort&&this.__updateSortOrders(),this.__applySorters())}__updateSortOrders(){this._sorters.forEach((e,i)=>e._order=this._sorters.length>1?i:null,this)}__updateSorter(e){if(e.direction||this._sorters.indexOf(e)!==-1){if(e._order=null,this.multiSort)this._removeArrayItem(this._sorters,e),e.direction&&this._sorters.unshift(e),this.__updateSortOrders();else if(e.direction){const i=this._sorters.filter(n=>n!=e);this._sorters=[e],i.forEach(n=>{n._order=null,n.direction=null})}}}__applySorters(){this.dataProvider&&this.isAttached&&JSON.stringify(this._previousSorters)!==JSON.stringify(this._mapSorters())&&this.clearCache(),this._a11yUpdateSorters(),this._previousSorters=this._mapSorters()}_mapSorters(){return this._sorters.map(e=>({path:e.path,direction:e.direction}))}_removeArrayItem(e,i){const n=e.indexOf(i);n>-1&&e.splice(n,1)}},F7e=t=>class extends t{static get properties(){return{cellClassNameGenerator:Function}}static get observers(){return["__cellClassNameGeneratorChanged(cellClassNameGenerator)"]}__cellClassNameGeneratorChanged(){this.generateCellClassNames()}generateCellClassNames(){Array.from(this.$.items.children).filter(e=>!e.hidden).forEach(e=>this._generateCellClassNames(e,this.__getRowModel(e)))}_generateCellClassNames(e,i){Array.from(e.children).forEach(n=>{if(n.__generatedClasses&&n.__generatedClasses.forEach(r=>n.classList.remove(r)),this.cellClassNameGenerator){const r=this.cellClassNameGenerator(n._column,i);n.__generatedClasses=r&&r.split(" ").filter(s=>s.length>0),n.__generatedClasses&&n.__generatedClasses.forEach(s=>n.classList.add(s))}})}},B1={BETWEEN:"between",ON_TOP:"on-top",ON_TOP_OR_BETWEEN:"on-top-or-between",ON_GRID:"on-grid"},Hd={ON_TOP:"on-top",ABOVE:"above",BELOW:"below",EMPTY:"empty"},z7e=t=>class extends t{static get properties(){return{dropMode:String,rowsDraggable:Boolean,dragFilter:Function,dropFilter:Function,__dndAutoScrollThreshold:{value:50}}}static get observers(){return["_dragDropAccessChanged(rowsDraggable, dropMode, dragFilter, dropFilter)"]}ready(){super.ready(),this.$.table.addEventListener("dragstart",this._onDragStart.bind(this)),this.$.table.addEventListener("dragend",this._onDragEnd.bind(this)),this.$.table.addEventListener("dragover",this._onDragOver.bind(this)),this.$.table.addEventListener("dragleave",this._onDragLeave.bind(this)),this.$.table.addEventListener("drop",this._onDrop.bind(this)),this.$.table.addEventListener("dragenter",e=>{this.dropMode&&(e.preventDefault(),e.stopPropagation())})}_onDragStart(e){if(this.rowsDraggable){let i=e.target;if(i.localName==="vaadin-grid-cell-content"&&(i=i.assignedSlot.parentNode.parentNode),i.parentNode!==this.$.items)return;if(e.stopPropagation(),this._toggleAttribute("dragging-rows",!0,this),this._safari){const o=i.style.transform;i.style.top=/translateY\((.*)\)/.exec(o)[1],i.style.transform="none",requestAnimationFrame(()=>{i.style.top="",i.style.transform=o})}const n=i.getBoundingClientRect();this._ios?e.dataTransfer.setDragImage(i):e.dataTransfer.setDragImage(i,e.clientX-n.left,e.clientY-n.top);let r=[i];this._isSelected(i._item)&&(r=this.__getViewportRows().filter(o=>this._isSelected(o._item)).filter(o=>!this.dragFilter||this.dragFilter(this.__getRowModel(o)))),e.dataTransfer.setData("text",this.__formatDefaultTransferData(r)),i.setAttribute("dragstart",r.length>1?r.length:""),this.updateStyles({"--_grid-drag-start-x":e.clientX-n.left+20+"px","--_grid-drag-start-y":e.clientY-n.top+10+"px"}),requestAnimationFrame(()=>{i.removeAttribute("dragstart"),this.updateStyles({"--_grid-drag-start-x":"","--_grid-drag-start-y":""})});const s=new CustomEvent("grid-dragstart",{detail:{draggedItems:r.map(o=>o._item),setDragData:(o,a)=>e.dataTransfer.setData(o,a),setDraggedItemsCount:o=>i.setAttribute("dragstart",o)}});s.originalEvent=e,this.dispatchEvent(s)}}_onDragEnd(e){this._toggleAttribute("dragging-rows",!1,this),e.stopPropagation();const i=new CustomEvent("grid-dragend");i.originalEvent=e,this.dispatchEvent(i)}_onDragLeave(e){e.stopPropagation(),this._clearDragStyles()}_onDragOver(e){if(this.dropMode){if(this._dropLocation=void 0,this._dragOverItem=void 0,this.__dndAutoScroll(e.clientY))return void this._clearDragStyles();let i=e.composedPath().filter(n=>n.localName==="tr")[0];if(this._effectiveSize&&this.dropMode!==B1.ON_GRID)if(i&&i.parentNode===this.$.items){const n=i.getBoundingClientRect();if(this._dropLocation=Hd.ON_TOP,this.dropMode===B1.BETWEEN){const r=e.clientY-n.top<n.bottom-e.clientY;this._dropLocation=r?Hd.ABOVE:Hd.BELOW}else this.dropMode===B1.ON_TOP_OR_BETWEEN&&(e.clientY-n.top<n.height/3?this._dropLocation=Hd.ABOVE:e.clientY-n.top>n.height/3*2&&(this._dropLocation=Hd.BELOW))}else{if(i||this.dropMode!==B1.BETWEEN&&this.dropMode!==B1.ON_TOP_OR_BETWEEN)return;i=Array.from(this.$.items.children).filter(n=>!n.hidden).pop(),this._dropLocation=Hd.BELOW}else this._dropLocation=Hd.EMPTY;if(i&&i.hasAttribute("drop-disabled"))return void(this._dropLocation=void 0);e.stopPropagation(),e.preventDefault(),this._dropLocation===Hd.EMPTY?this._toggleAttribute("dragover",!0,this):i?(this._dragOverItem=i._item,i.getAttribute("dragover")!==this._dropLocation&&i.setAttribute("dragover",this._dropLocation)):this._clearDragStyles()}}__dndAutoScroll(e){if(this.__dndAutoScrolling)return!0;const i=this.$.header.getBoundingClientRect().bottom,n=this.$.footer.getBoundingClientRect().top,r=i-e+this.__dndAutoScrollThreshold,s=e-n+this.__dndAutoScrollThreshold;let o=0;if(s>0?o=2*s:r>0&&(o=2*-r),o){const a=this.$.table.scrollTop;if(this.$.table.scrollTop+=o,a!==this.$.table.scrollTop)return this.__dndAutoScrolling=!0,setTimeout(()=>this.__dndAutoScrolling=!1,20),this._scrollHandler(),!0}}__getViewportRows(){const e=this.$.header.getBoundingClientRect().bottom,i=this.$.footer.getBoundingClientRect().top;return Array.from(this.$.items.children).filter(n=>{const r=n.getBoundingClientRect();return r.bottom>e&&r.top<i})}_clearDragStyles(){this.removeAttribute("dragover"),Array.from(this.$.items.children).forEach(e=>e.removeAttribute("dragover"))}_onDrop(e){if(this.dropMode){e.stopPropagation(),e.preventDefault();const i=e.dataTransfer.types&&Array.from(e.dataTransfer.types).map(r=>({type:r,data:e.dataTransfer.getData(r)}));this._clearDragStyles();const n=new CustomEvent("grid-drop",{bubbles:e.bubbles,cancelable:e.cancelable,detail:{dropTargetItem:this._dragOverItem,dropLocation:this._dropLocation,dragData:i}});n.originalEvent=e,this.dispatchEvent(n)}}__formatDefaultTransferData(e){return e.map(i=>Array.from(i.children).filter(n=>!n.hidden&&n.getAttribute("part").indexOf("details-cell")===-1).sort((n,r)=>n._column._order>r._column._order?1:-1).map(n=>n._content.textContent.trim()).filter(n=>n).join("	")).join(`
`)}_dragDropAccessChanged(){this.filterDragAndDrop()}filterDragAndDrop(){Array.from(this.$.items.children).filter(e=>!e.hidden).forEach(e=>{this._filterDragAndDrop(e,this.__getRowModel(e))})}_filterDragAndDrop(e,i){const n=!this.rowsDraggable||this.dragFilter&&!this.dragFilter(i),r=!this.dropMode||this.dropFilter&&!this.dropFilter(i);Array.from(e.children).map(s=>s._content).forEach(s=>{n?s.removeAttribute("draggable"):s.setAttribute("draggable",!0)}),this._toggleAttribute("drag-disabled",n,e),this._toggleAttribute("drop-disabled",r,e)}},V7e=t=>class extends t{static get properties(){return{_headerFocusable:{type:Object,observer:"_focusableChanged"},_itemsFocusable:{type:Object,observer:"_focusableChanged"},_footerFocusable:{type:Object,observer:"_focusableChanged"},_navigatingIsHidden:Boolean,_focusedItemIndex:{type:Number,value:0},_focusedColumnOrder:Number}}ready(){super.ready(),this._ios||this._android||(this.addEventListener("keydown",this._onKeyDown),this.addEventListener("keyup",this._onKeyUp),this.addEventListener("focusin",this._onFocusIn),this.addEventListener("focusout",this._onFocusOut),this.$.table.addEventListener("focusin",this._onCellFocusIn.bind(this)),this.$.table.addEventListener("focusout",this._onCellFocusOut.bind(this)),this.addEventListener("mousedown",()=>{this._toggleAttribute("navigating",!1,this),this._isMousedown=!0}),this.addEventListener("mouseup",()=>this._isMousedown=!1))}_focusableChanged(e,i){i&&i.setAttribute("tabindex","-1"),e&&e.setAttribute("tabindex","0")}_onKeyDown(e){const i=e.key;let n;switch(i){case"ArrowUp":case"ArrowDown":case"ArrowLeft":case"ArrowRight":case"PageUp":case"PageDown":case"Home":case"End":n="Navigation";break;case"Enter":case"Escape":case"F2":n="Interaction";break;case"Tab":n="Tab";break;case" ":n="Space"}this._detectInteracting(e),this.hasAttribute("interacting")&&n!=="Interaction"&&(n=void 0),n&&this[`_on${n}KeyDown`](e,i)}_ensureScrolledToIndex(e){Array.from(this.$.items.children).filter(i=>i.index===e)[0]||this._scrollToIndex(e)}_onNavigationKeyDown(e,i){function n(M){return Array.prototype.indexOf.call(M.parentNode.children,M)}this._scrollHandler(),e.preventDefault();const r=this._lastVisibleIndex-this._firstVisibleIndex-1;let s=0,o=0;switch(i){case"ArrowRight":s=this.__isRTL?-1:1;break;case"ArrowLeft":s=this.__isRTL?1:-1;break;case"Home":s=-1/0,e.ctrlKey&&(o=-1/0);break;case"End":s=1/0,e.ctrlKey&&(o=1/0);break;case"ArrowDown":o=1;break;case"ArrowUp":o=-1;break;case"PageDown":o=r;break;case"PageUp":o=-r}const a=e.composedPath()[0],l=n(a),c=this._elementMatches(a,'[part~="details-cell"]'),u=a.parentNode,d=u.parentNode,f=(d===this.$.items?this._effectiveSize:d.children.length)-1,m=d===this.$.items?this._focusedItemIndex!==void 0?this._focusedItemIndex:u.index:n(u);let g=Math.max(0,Math.min(m+o,f)),y=!1;if(d===this.$.items){const M=u._item,E=this._cache.getItemForIndex(g);y=c?o===0:o===1&&this._isDetailsOpened(M)||o===-1&&g!==m&&this._isDetailsOpened(E),y!==c&&(o===1&&y||o===-1&&!y)&&(g=m)}if(d!==this.$.items){if(g>m)for(;g<f&&d.children[g].hidden;)g++;else if(g<m)for(;g>0&&d.children[g].hidden;)g--}this._focusedColumnOrder===void 0&&(this._focusedColumnOrder=c?0:this._getColumns(d,m).filter(M=>!M.hidden)[l]._order);const _=this._getColumns(d,g).filter(M=>!M.hidden),b=_.map(M=>M._order).sort((M,E)=>M-E),w=b.length-1,x=b.indexOf(b.slice(0).sort((M,E)=>Math.abs(M-this._focusedColumnOrder)-Math.abs(E-this._focusedColumnOrder))[0]),S=o===0&&c?x:Math.max(0,Math.min(x+s,w));S!==x&&(this._focusedColumnOrder=void 0),d===this.$.items&&this._ensureScrolledToIndex(g),this._toggleAttribute("navigating",!0,this);const T=_.reduce((M,E,A)=>(M[E._order]=A,M),{})[b[S]],I=d===this.$.items?Array.from(d.children).filter(M=>M.index===g)[0]:d.children[g];if(!I)return;const C=y?Array.from(I.children).filter(M=>this._elementMatches(M,'[part~="details-cell"]'))[0]:I.children[T];if(this._scrollHorizontallyToCell(C),d===this.$.items&&(this._focusedItemIndex=g),d===this.$.items){const M=C.getBoundingClientRect(),E=this.$.footer.getBoundingClientRect().top,A=this.$.header.getBoundingClientRect().bottom;M.bottom>E?(this.$.table.scrollTop+=M.bottom-E,this._scrollHandler()):M.top<A&&(this.$.table.scrollTop-=A-M.top,this._scrollHandler())}C.focus()}_parseEventPath(e){const i=e.indexOf(this.$.table);return{rowGroup:e[i-1],row:e[i-2],cell:e[i-3]}}_onInteractionKeyDown(e,i){const n=e.composedPath()[0],r=n.localName==="input"&&!/^(button|checkbox|color|file|image|radio|range|reset|submit)$/i.test(n.type);let s;switch(i){case"Enter":s=!this.hasAttribute("interacting")||!r;break;case"Escape":s=!1;break;case"F2":s=!this.hasAttribute("interacting")}const{cell:o}=this._parseEventPath(e.composedPath());if(this.hasAttribute("interacting")!==s)if(s){const a=o._content.querySelector("[focus-target]")||o._content.firstElementChild;a&&(e.preventDefault(),a.focus(),this._toggleAttribute("interacting",!0,this),this._toggleAttribute("navigating",!1,this))}else e.preventDefault(),this._focusedColumnOrder=void 0,o.focus(),this._toggleAttribute("interacting",!1,this),this._toggleAttribute("navigating",!0,this)}_predictFocusStepTarget(e,i){const n=[this.$.table,this._headerFocusable,this._itemsFocusable,this._footerFocusable,this.$.focusexit];let r=n.indexOf(e);for(r+=i;r>=0&&r<=n.length-1&&(!n[r]||n[r].parentNode.hidden);)r+=i;return n[r]}_onTabKeyDown(e){const i=this._predictFocusStepTarget(e.composedPath()[0],e.shiftKey?-1:1);if(i===this.$.table)this.$.table.focus();else if(i===this.$.focusexit)this.$.focusexit.focus();else if(i===this._itemsFocusable){let n=i;const r=this._itemsFocusable.parentNode;if(this._ensureScrolledToIndex(this._focusedItemIndex),r.index!==this._focusedItemIndex){const s=Array.from(r.children).indexOf(this._itemsFocusable),o=Array.from(this.$.items.children).filter(a=>a.index===this._focusedItemIndex)[0];o&&(n=o.children[s])}e.preventDefault(),n.focus()}else e.preventDefault(),i.focus();this._toggleAttribute("navigating",!0,this)}_onSpaceKeyDown(e){e.preventDefault();const i=e.composedPath()[0];i._content&&i._content.firstElementChild||this.dispatchEvent(new CustomEvent("cell-activate",{detail:{model:this.__getRowModel(i.parentElement)}}))}_onKeyUp(e){if(!/^( |SpaceBar)$/.test(e.key))return;e.preventDefault();const i=e.composedPath()[0];if(i._content&&i._content.firstElementChild){const n=this.hasAttribute("navigating");i._content.firstElementChild.click(),this._toggleAttribute("navigating",n,this)}}_onFocusIn(e){this._isMousedown||this._toggleAttribute("navigating",!0,this);const i=e.composedPath()[0];i===this.$.table||i===this.$.focusexit?(this._predictFocusStepTarget(i,i===this.$.table?1:-1).focus(),this._toggleAttribute("interacting",!1,this)):this._detectInteracting(e)}_onFocusOut(e){this._toggleAttribute("navigating",!1,this),this._detectInteracting(e)}_onCellFocusIn(e){if(this._detectInteracting(e),e.composedPath().indexOf(this.$.table)===3){const i=e.composedPath()[0];this._activeRowGroup=i.parentNode.parentNode,this._activeRowGroup===this.$.header?this._headerFocusable=i:this._activeRowGroup===this.$.items?this._itemsFocusable=i:this._activeRowGroup===this.$.footer&&(this._footerFocusable=i),i._content.dispatchEvent(new CustomEvent("cell-focusin",{bubbles:!1}))}this._detectFocusedItemIndex(e)}_onCellFocusOut(e){e.composedPath().indexOf(this.$.table)===3&&e.composedPath()[0]._content.dispatchEvent(new CustomEvent("cell-focusout",{bubbles:!1}))}_detectInteracting(e){this._toggleAttribute("interacting",e.composedPath().some(i=>i.localName==="vaadin-grid-cell-content"),this)}_detectFocusedItemIndex(e){const{rowGroup:i,row:n}=this._parseEventPath(e.composedPath());i===this.$.items&&(this._focusedItemIndex=n.index)}_preventScrollerRotatingCellFocus(e,i){e.index===this._focusedItemIndex&&this.hasAttribute("navigating")&&this._activeRowGroup===this.$.items&&(this._navigatingIsHidden=!0,this._toggleAttribute("navigating",!1,this)),i===this._focusedItemIndex&&this._navigatingIsHidden&&(this._navigatingIsHidden=!1,this._toggleAttribute("navigating",!0,this))}_getColumns(e,i){let n=this._columnTree.length-1;return e===this.$.header?n=i:e===this.$.footer&&(n=this._columnTree.length-1-i),this._columnTree[n]}_resetKeyboardNavigation(){if(this.$.header.firstElementChild&&(this._headerFocusable=Array.from(this.$.header.firstElementChild.children).filter(e=>!e.hidden)[0]),this.$.items.firstElementChild){const e=this._iterateItems((i,n)=>{if(this._firstVisibleIndex===n)return this.$.items.children[i]});e&&(this._itemsFocusable=Array.from(e.children).filter(i=>!i.hidden)[0])}this.$.footer.firstElementChild&&(this._footerFocusable=Array.from(this.$.footer.firstElementChild.children).filter(e=>!e.hidden)[0])}_scrollHorizontallyToCell(e){if(e.hasAttribute("frozen")||this._elementMatches(e,'[part~="details-cell"]'))return;const i=e.getBoundingClientRect(),n=e.parentNode,r=Array.from(n.children).indexOf(e),s=this.$.table.getBoundingClientRect();let o=s.left,a=s.right;for(let l=r-1;l>=0;l--){const c=n.children[l];if(!c.hasAttribute("hidden")&&!this._elementMatches(c,'[part~="details-cell"]')&&c.hasAttribute("frozen")){o=c.getBoundingClientRect().right;break}}for(let l=r+1;l<n.children.length;l++){const c=n.children[l];if(!c.hasAttribute("hidden")&&!this._elementMatches(c,'[part~="details-cell"]')&&c.hasAttribute("frozen")){a=c.getBoundingClientRect().left;break}}i.left<o&&(this.$.table.scrollLeft+=Math.round(i.left-o)),i.right>a&&(this.$.table.scrollLeft+=Math.round(i.right-a))}_elementMatches(e,i){return e.matches?e.matches(i):Array.from(e.parentNode.querySelectorAll(i)).indexOf(e)!==-1}},j7e=t=>class extends yT(t){static get properties(){return{columnReorderingAllowed:{type:Boolean,value:!1},_orderBaseScope:{type:Number,value:1e7}}}static get observers(){return["_updateOrders(_columnTree, _columnTree.*)"]}ready(){super.ready(),w8(this,"track",this._onTrackEvent),this._reorderGhost=this.shadowRoot.querySelector('[part="reorder-ghost"]'),this.addEventListener("touchstart",this._onTouchStart.bind(this)),this.addEventListener("touchmove",this._onTouchMove.bind(this)),this.addEventListener("touchend",this._onTouchEnd.bind(this)),this.addEventListener("contextmenu",this._onContextMenu.bind(this))}_onContextMenu(e){this.hasAttribute("reordering")&&e.preventDefault()}_onTouchStart(e){this._startTouchReorderTimeout=setTimeout(()=>{this._onTrackStart({detail:{x:e.touches[0].clientX,y:e.touches[0].clientY}})},100)}_onTouchMove(e){this._draggedColumn&&e.preventDefault(),clearTimeout(this._startTouchReorderTimeout)}_onTouchEnd(){clearTimeout(this._startTouchReorderTimeout),this._onTrackEnd()}_onTrackEvent(e){if(e.detail.state==="start"){const i=e.composedPath(),n=i[i.indexOf(this.$.header)-2];if(!n||!n._content||n._content.contains(this.getRootNode().activeElement)||this.$.scroller.hasAttribute("column-resizing"))return;this._touchDevice||this._onTrackStart(e)}else e.detail.state==="track"?this._onTrack(e):e.detail.state==="end"&&this._onTrackEnd(e)}_onTrackStart(e){if(!this.columnReorderingAllowed)return;const i=e.composedPath&&e.composedPath();if(i&&i.filter(r=>r.hasAttribute&&r.hasAttribute("draggable"))[0])return;const n=this._cellFromPoint(e.detail.x,e.detail.y);if(n&&n.getAttribute("part").indexOf("header-cell")!==-1){for(this._toggleAttribute("reordering",!0,this),this._draggedColumn=n._column;this._draggedColumn.parentElement.childElementCount===1;)this._draggedColumn=this._draggedColumn.parentElement;this._setSiblingsReorderStatus(this._draggedColumn,"allowed"),this._draggedColumn._reorderStatus="dragging",this._updateGhost(n),this._reorderGhost.style.visibility="visible",this._updateGhostPosition(e.detail.x,this._touchDevice?e.detail.y-50:e.detail.y),this._autoScroller()}}_onTrack(e){if(!this._draggedColumn)return;const i=this._cellFromPoint(e.detail.x,e.detail.y);if(!i)return;const n=this._getTargetColumn(i,this._draggedColumn);this._isSwapAllowed(this._draggedColumn,n)&&this._isSwappableByPosition(n,e.detail.x)&&this._swapColumnOrders(this._draggedColumn,n),this._updateGhostPosition(e.detail.x,this._touchDevice?e.detail.y-50:e.detail.y),this._lastDragClientX=e.detail.x}_onTrackEnd(){this._draggedColumn&&(this._toggleAttribute("reordering",!1,this),this._draggedColumn._reorderStatus="",this._setSiblingsReorderStatus(this._draggedColumn,""),this._draggedColumn=null,this._lastDragClientX=null,this._reorderGhost.style.visibility="hidden",this.dispatchEvent(new CustomEvent("column-reorder",{detail:{columns:this._getColumnsInOrder()}})))}_getColumnsInOrder(){return this._columnTree.slice(0).pop().filter(e=>!e.hidden).sort((e,i)=>e._order-i._order)}_cellFromPoint(e,i){e=e||0,i=i||0,this._draggedColumn||this._toggleAttribute("no-content-pointer-events",!0,this.$.scroller);const n=this.shadowRoot.elementFromPoint(e,i);if(this._toggleAttribute("no-content-pointer-events",!1,this.$.scroller),n&&n._column)return n}_updateGhostPosition(e,i){const n=this._reorderGhost.getBoundingClientRect(),r=e-n.width/2,s=i-n.height/2,o=parseInt(this._reorderGhost._left||0),a=parseInt(this._reorderGhost._top||0);this._reorderGhost._left=o-(n.left-r),this._reorderGhost._top=a-(n.top-s),this._reorderGhost.style.transform=`translate(${this._reorderGhost._left}px, ${this._reorderGhost._top}px)`}_updateGhost(e){const i=this._reorderGhost;i.textContent=e._content.innerText;const n=window.getComputedStyle(e);return["boxSizing","display","width","height","background","alignItems","padding","border","flex-direction","overflow"].forEach(r=>i.style[r]=n[r]),i}_updateOrders(e,i){e!==void 0&&i!==void 0&&(e[0].forEach(n=>n._order=0),e[0].forEach((n,r)=>n._order=(r+1)*this._orderBaseScope))}_setSiblingsReorderStatus(e,i){Array.from(e.parentNode.children).filter(n=>/column/.test(n.localName)&&this._isSwapAllowed(n,e)).forEach(n=>n._reorderStatus=i)}_autoScroller(){if(this._lastDragClientX){const e=this._lastDragClientX-this.getBoundingClientRect().right+50,i=this.getBoundingClientRect().left-this._lastDragClientX+50;e>0?this.$.table.scrollLeft+=e/10:i>0&&(this.$.table.scrollLeft-=i/10),this._scrollHandler()}this._draggedColumn&&this.async(this._autoScroller,10)}_isSwapAllowed(e,i){if(e&&i){const n=e!==i,r=e.parentElement===i.parentElement,s=e.frozen===i.frozen;return n&&r&&s}}_isSwappableByPosition(e,i){const n=Array.from(this.$.header.querySelectorAll('tr:not([hidden]) [part~="cell"]')).filter(o=>e.contains(o._column))[0],r=this.$.header.querySelector("tr:not([hidden]) [reorder-status=dragging]").getBoundingClientRect(),s=n.getBoundingClientRect();return s.left>r.left?i>s.right-r.width:i<s.left+r.width}_swapColumnOrders(e,i){const n=e._order;e._order=i._order,i._order=n,this._updateLastFrozen(),this._updateFirstAndLastColumn()}_getTargetColumn(e,i){if(e&&i){let n=e._column;for(;n.parentElement!==i.parentElement&&n!==this;)n=n.parentElement;return n.parentElement===i.parentElement?n:e._column}}},che=t=>class extends t{static get properties(){return{resizable:{type:Boolean,value:function(){if(this.localName==="vaadin-grid-column-group")return;const e=this.parentNode;return e&&e.localName==="vaadin-grid-column-group"&&e.resizable||!1}},_headerTemplate:{type:Object},_footerTemplate:{type:Object},frozen:{type:Boolean,value:!1},hidden:{type:Boolean},header:{type:String},textAlign:{type:String},_lastFrozen:{type:Boolean,value:!1},_order:Number,_reorderStatus:Boolean,_emptyCells:Array,_headerCell:Object,_footerCell:Object,_grid:Object,headerRenderer:Function,footerRenderer:Function}}static get observers(){return["_widthChanged(width, _headerCell, _footerCell, _cells.*)","_frozenChanged(frozen, _headerCell, _footerCell, _cells.*)","_flexGrowChanged(flexGrow, _headerCell, _footerCell, _cells.*)","_pathOrHeaderChanged(path, header, _headerCell, _footerCell, _cells.*, renderer, headerRenderer, _bodyTemplate, _headerTemplate)","_textAlignChanged(textAlign, _cells.*, _headerCell, _footerCell)","_orderChanged(_order, _headerCell, _footerCell, _cells.*)","_lastFrozenChanged(_lastFrozen)","_setBodyTemplateOrRenderer(_bodyTemplate, renderer, _cells, _cells.*)","_setHeaderTemplateOrRenderer(_headerTemplate, headerRenderer, _headerCell)","_setFooterTemplateOrRenderer(_footerTemplate, footerRenderer, _footerCell)","_resizableChanged(resizable, _headerCell)","_reorderStatusChanged(_reorderStatus, _headerCell, _footerCell, _cells.*)","_hiddenChanged(hidden, _headerCell, _footerCell, _cells.*)"]}connectedCallback(){super.connectedCallback(),this._bodyTemplate&&(this._bodyTemplate.templatizer._grid=this._grid),this._headerTemplate&&(this._headerTemplate.templatizer._grid=this._grid),this._footerTemplate&&(this._footerTemplate.templatizer._grid=this._grid),this._templateObserver.flush(),this._bodyTemplate||this._templateObserver.callback(),requestAnimationFrame(()=>{this._allCells.forEach(e=>{e._content.parentNode||this._grid&&this._grid.appendChild(e._content)})})}disconnectedCallback(){super.disconnectedCallback(),requestAnimationFrame(()=>{this._findHostGrid()||this._allCells.forEach(e=>{e._content.parentNode&&e._content.parentNode.removeChild(e._content)})}),this._gridValue=void 0}_findHostGrid(){let e=this;for(;e&&!/^vaadin.*grid(-pro)?$/.test(e.localName);)e=e.assignedSlot?e.assignedSlot.parentNode:e.parentNode;return e||void 0}get _grid(){return this._gridValue||(this._gridValue=this._findHostGrid()),this._gridValue}get _allCells(){return[].concat(this._cells||[]).concat(this._emptyCells||[]).concat(this._headerCell).concat(this._footerCell).filter(e=>e)}constructor(){super(),this._templateObserver=new Kh(this,()=>{this._headerTemplate=this._prepareHeaderTemplate(),this._footerTemplate=this._prepareFooterTemplate(),this._bodyTemplate=this._prepareBodyTemplate()})}_prepareHeaderTemplate(){return this._prepareTemplatizer(this._findTemplate(!0)||null,{})}_prepareFooterTemplate(){return this._prepareTemplatizer(this._findTemplate(!1,!0)||null,{})}_prepareBodyTemplate(){return this._prepareTemplatizer(this._findTemplate()||null)}_prepareTemplatizer(e,i){if(e&&!e.templatizer){const n=new p$;n._grid=this._grid,n.dataHost=this.dataHost,n._instanceProps=i||n._instanceProps,n.template=e,e.templatizer=n}return e}_renderHeaderAndFooter(){this.headerRenderer&&this._headerCell&&this.__runRenderer(this.headerRenderer,this._headerCell),this.footerRenderer&&this._footerCell&&this.__runRenderer(this.footerRenderer,this._footerCell)}__runRenderer(e,i,n){const r=[i._content,this];n&&n.item&&r.push(n),e.apply(this,r)}__setColumnTemplateOrRenderer(e,i,n){if(!this.hidden){if(e&&i)throw new Error("You should only use either a renderer or a template");n.forEach(r=>{const s=this._grid.__getRowModel(r.parentElement);if(i)r._renderer=i,(s.item||i===this.headerRenderer||i===this.footerRenderer)&&this.__runRenderer(i,r,s);else if(r._template!==e){r._template=e,r._content.innerHTML="",e.templatizer._grid=e.templatizer._grid||this._grid;const o=e.templatizer.createInstance();r._content.appendChild(o.root),r._instance=o,s.item&&r._instance.setProperties(s)}})}}_setBodyTemplateOrRenderer(e,i,n){(e||i)&&n&&this.__setColumnTemplateOrRenderer(e,i,n)}_setHeaderTemplateOrRenderer(e,i,n){(e||i)&&n&&this.__setColumnTemplateOrRenderer(e,i,[n])}_setFooterTemplateOrRenderer(e,i,n){(e||i)&&n&&(this.__setColumnTemplateOrRenderer(e,i,[n]),this._grid.__updateHeaderFooterRowVisibility(n.parentElement))}_selectFirstTemplate(e=!1,i=!1){return Kh.getFlattenedNodes(this).filter(n=>n.localName==="template"&&n.classList.contains("header")===e&&n.classList.contains("footer")===i)[0]}_findTemplate(e,i){const n=this._selectFirstTemplate(e,i);return n&&this.dataHost&&(n._rootDataHost=this.dataHost._rootDataHost||this.dataHost),n}_flexGrowChanged(e){this.parentElement&&this.parentElement._columnPropChanged&&this.parentElement._columnPropChanged("flexGrow"),this._allCells.forEach(i=>i.style.flexGrow=e)}_orderChanged(e){this._allCells.forEach(i=>i.style.order=e)}_widthChanged(e){this.parentElement&&this.parentElement._columnPropChanged&&this.parentElement._columnPropChanged("width"),this._allCells.forEach(i=>i.style.width=e),this._grid&&this._grid.__forceReflow&&this._grid.__forceReflow()}_frozenChanged(e){this.parentElement&&this.parentElement._columnPropChanged&&this.parentElement._columnPropChanged("frozen",e),this._allCells.forEach(i=>this._toggleAttribute("frozen",e,i)),this._grid&&this._grid._frozenCellsChanged&&this._grid._frozenCellsChanged()}_lastFrozenChanged(e){this._allCells.forEach(i=>this._toggleAttribute("last-frozen",e,i)),this.parentElement&&this.parentElement._columnPropChanged&&(this.parentElement._lastFrozen=e)}_pathOrHeaderChanged(e,i,n,r,s,o,a,l,c){const u=i!==void 0;if(!a&&!c&&u&&n&&this.__setTextContent(n._content,i),e&&s.value){if(!o&&!l){const d=(f,m,{item:g})=>this.__setTextContent(f,this.get(e,g));this.__setColumnTemplateOrRenderer(void 0,d,s.value)}a||c||u||!n||i===null||this.__setTextContent(n._content,this._generateHeader(e))}n&&this._grid.__updateHeaderFooterRowVisibility(n.parentElement)}__setTextContent(e,i){e.textContent!==i&&(e.textContent=i)}_generateHeader(e){return e.substr(e.lastIndexOf(".")+1).replace(/([A-Z])/g,"-$1").toLowerCase().replace(/-/g," ").replace(/^./,i=>i.toUpperCase())}_toggleAttribute(e,i,n){n.hasAttribute(e)===!i&&(i?n.setAttribute(e,""):n.removeAttribute(e))}_reorderStatusChanged(e){this._allCells.forEach(i=>i.setAttribute("reorder-status",e))}_resizableChanged(e,i){e!==void 0&&i!==void 0&&i&&[i].concat(this._emptyCells).forEach(n=>{if(n){const r=n.querySelector('[part~="resize-handle"]');if(r&&n.removeChild(r),e){const s=document.createElement("div");s.setAttribute("part","resize-handle"),n.appendChild(s)}}})}_textAlignChanged(e){if(e===void 0)return;if(["start","end","center"].indexOf(e)===-1)return void console.warn('textAlign can only be set as "start", "end" or "center"');let i;getComputedStyle(this._grid).direction==="ltr"?e==="start"?i="left":e==="end"&&(i="right"):e==="start"?i="right":e==="end"&&(i="left"),this._allCells.forEach(n=>{n._content.style.textAlign=e,getComputedStyle(n._content).textAlign!==e&&(n._content.style.textAlign=i)})}_hiddenChanged(e){this.parentElement&&this.parentElement._columnPropChanged&&this.parentElement._columnPropChanged("hidden",e),!!e!=!!this._previousHidden&&this._grid&&(e===!0&&this._allCells.forEach(i=>{i._content.parentNode&&i._content.parentNode.removeChild(i._content)}),this._grid._debouncerHiddenChanged=Tn.debounce(this._grid._debouncerHiddenChanged,Yh,()=>{this._grid&&this._grid._renderColumnTree&&this._grid._renderColumnTree(this._grid._columnTree)}),this._grid._updateLastFrozen&&this._grid._updateLastFrozen(),this._grid.notifyResize&&this._grid.notifyResize(),this._grid._resetKeyboardNavigation&&this._grid._resetKeyboardNavigation()),this._previousHidden=e}};class f$ extends che(T8(_d)){static get is(){return"vaadin-grid-column"}static get properties(){return{width:{type:String,value:"100px"},flexGrow:{type:Number,value:1},renderer:Function,path:{type:String},autoWidth:{type:Boolean,value:!1},_bodyTemplate:{type:Object},_cells:Array}}}customElements.define(f$.is,f$),cS("vaadin-grid",lS`
    @keyframes vaadin-grid-appear {
      to {
        opacity: 1;
      }
    }

    :host {
      display: block;
      animation: 1ms vaadin-grid-appear;
      height: 400px;
      flex: 1 1 auto;
      align-self: stretch;
      position: relative;
    }

    :host([hidden]) {
      display: none !important;
    }

    #scroller {
      display: block;
      transform: translateY(0);
      width: auto;
      height: auto;
      position: absolute;
      top: 0;
      right: 0;
      bottom: 0;
      left: 0;
    }

    :host([height-by-rows]) {
      height: auto;
      align-self: flex-start;
      flex-grow: 0;
      width: 100%;
    }

    :host([height-by-rows]) #scroller {
      width: 100%;
      height: 100%;
      position: relative;
    }

    #table {
      display: flex;
      flex-direction: column;
      width: 100%;
      height: 100%;
      overflow: auto;
      position: relative;
      outline: none;
      /* Workaround for a Desktop Safari bug: new stacking context here prevents the scrollbar from getting hidden */
      z-index: 0;
    }

    #header,
    #footer {
      display: block;
      position: -webkit-sticky;
      position: sticky;
      left: 0;
      overflow: visible;
      width: 100%;
      z-index: 1;
    }

    #header {
      top: 0;
    }

    th {
      text-align: inherit;
    }

    /* Safari doesn't work with "inherit" */
    [safari] th {
      text-align: initial;
    }

    #footer {
      bottom: 0;
    }

    #items {
      flex-grow: 1;
      flex-shrink: 0;
      display: block;
      position: -webkit-sticky;
      position: sticky;
      width: 100%;
      left: 0;
      overflow: visible;
    }

    [part~='row'] {
      display: flex;
      width: 100%;
      box-sizing: border-box;
      margin: 0;
    }

    [part~='row'][loading] [part~='body-cell'] ::slotted(vaadin-grid-cell-content) {
      opacity: 0;
    }

    #items [part~='row'] {
      position: absolute;
    }

    #items [part~='row']:empty {
      height: 1em;
    }

    [part~='cell']:not([part~='details-cell']) {
      flex-shrink: 0;
      flex-grow: 1;
      box-sizing: border-box;
      display: flex;
      width: 100%;
      position: relative;
      align-items: center;
      padding: 0;
      white-space: nowrap;
    }

    [part~='details-cell'] {
      position: absolute;
      bottom: 0;
      width: 100%;
      box-sizing: border-box;
      padding: 0;
    }

    [part~='cell'] ::slotted(vaadin-grid-cell-content) {
      display: block;
      width: 100%;
      box-sizing: border-box;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    [hidden] {
      display: none !important;
    }

    [frozen] {
      z-index: 2;
      will-change: transform;
    }

    [no-scrollbars][safari] #table,
    [no-scrollbars][firefox] #table {
      overflow: hidden;
    }

    /* Reordering styles */
    :host([reordering]) [part~='cell'] ::slotted(vaadin-grid-cell-content),
    :host([reordering]) [part~='resize-handle'],
    #scroller[no-content-pointer-events] [part~='cell'] ::slotted(vaadin-grid-cell-content) {
      pointer-events: none;
    }

    [part~='reorder-ghost'] {
      visibility: hidden;
      position: fixed;
      pointer-events: none;
      opacity: 0.5;

      /* Prevent overflowing the grid in Firefox */
      top: 0;
      left: 0;
    }

    :host([reordering]) {
      -moz-user-select: none;
      -webkit-user-select: none;
      user-select: none;
    }

    /* Resizing styles */
    [part~='resize-handle'] {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
      cursor: col-resize;
      z-index: 1;
    }

    [part~='resize-handle']::before {
      position: absolute;
      content: '';
      height: 100%;
      width: 35px;
      transform: translateX(-50%);
    }

    [last-column] [part~='resize-handle']::before,
    [last-frozen] [part~='resize-handle']::before {
      width: 18px;
      transform: none;
      right: 0;
    }

    #scroller[column-resizing] {
      -ms-user-select: none;
      -moz-user-select: none;
      -webkit-user-select: none;
      user-select: none;
    }

    /* Sizer styles */
    #sizer {
      display: flex;
      position: absolute;
      visibility: hidden;
    }

    #sizer [part~='details-cell'] {
      display: none !important;
    }

    #sizer [part~='cell'][hidden] {
      display: none !important;
    }

    #sizer [part~='cell'] {
      display: block;
      flex-shrink: 0;
      line-height: 0;
      height: 0 !important;
      min-height: 0 !important;
      max-height: 0 !important;
      padding: 0 !important;
      border: none !important;
    }

    #sizer [part~='cell']::before {
      content: '-';
    }

    #sizer [part~='cell'] ::slotted(vaadin-grid-cell-content) {
      display: none !important;
    }

    /* RTL specific styles */

    :host([dir='rtl']) #items,
    :host([dir='rtl']) #header,
    :host([dir='rtl']) #footer {
      left: auto;
    }

    :host([dir='rtl']) [part~='reorder-ghost'] {
      left: auto;
      right: 0;
    }

    :host([dir='rtl']) [part~='resize-handle'] {
      left: 0;
      right: auto;
    }

    :host([dir='rtl']) [part~='resize-handle']::before {
      transform: translateX(50%);
    }

    :host([dir='rtl']) [last-column] [part~='resize-handle']::before,
    :host([dir='rtl']) [last-frozen] [part~='resize-handle']::before {
      left: 0;
      right: auto;
    }
  `,{moduleId:"vaadin-grid-styles"});const B7e=(()=>{try{return document.createEvent("TouchEvent"),!0}catch{return!1}})();class bJ extends kue(S8($7e(E7e(P7e(C7e(R7e(D7e(N7e(L7e(V7e(I7e(O7e(j7e(A7e(k7e(z7e(F7e(T7e)))))))))))))))))){static get template(){return mT`
      <div
        id="scroller"
        safari$="[[_safari]]"
        ios$="[[_ios]]"
        loading$="[[loading]]"
        column-reordering-allowed$="[[columnReorderingAllowed]]"
      >
        <table id="table" role="grid" aria-multiselectable="true" tabindex="0">
          <caption id="sizer" part="row"></caption>
          <thead id="header" role="rowgroup"></thead>
          <tbody id="items" role="rowgroup"></tbody>
          <tfoot id="footer" role="rowgroup"></tfoot>
        </table>

        <div part="reorder-ghost"></div>
      </div>

      <div id="focusexit" tabindex="0"></div>
    `}static get is(){return"vaadin-grid"}static get version(){return"6.0.2"}static get observers(){return["_columnTreeChanged(_columnTree, _columnTree.*)"]}static get properties(){return{_safari:{type:Boolean,value:/^((?!chrome|android).)*safari/i.test(navigator.userAgent)},_ios:{type:Boolean,value:/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1},_firefox:{type:Boolean,value:navigator.userAgent.toLowerCase().indexOf("firefox")>-1},_android:{type:Boolean,value:/android/i.test(navigator.userAgent)},_touchDevice:{type:Boolean,value:B7e},heightByRows:{type:Boolean,value:!1,reflectToAttribute:!0,observer:"_heightByRowsChanged"},_recalculateColumnWidthOnceLoadingFinished:{type:Boolean,value:!0}}}constructor(){super(),this.addEventListener("animationend",this._onAnimationEnd)}connectedCallback(){super.connectedCallback(),this.recalculateColumnWidths()}attributeChangedCallback(e,i,n){super.attributeChangedCallback(e,i,n),e==="dir"&&(this.__isRTL=n==="rtl",this._updateScrollerMeasurements())}__hasRowsWithClientHeight(){return!!Array.from(this.$.items.children).filter(e=>e.clientHeight).length}__itemsReceived(){this._recalculateColumnWidthOnceLoadingFinished&&!this._cache.isLoading()&&this.__hasRowsWithClientHeight()&&(this._recalculateColumnWidthOnceLoadingFinished=!1,this.recalculateColumnWidths())}_recalculateColumnWidths(e){e.forEach(i=>{i.width="auto",i._origFlexGrow=i.flexGrow,i.flexGrow=0}),e.forEach(i=>{i._currentWidth=0,i._allCells.forEach(n=>{const r=n.offsetWidth+1;i._currentWidth=Math.max(i._currentWidth,r)})}),e.forEach(i=>{i.width=`${i._currentWidth}px`,i.flexGrow=i._origFlexGrow,i._currentWidth=void 0,i._origFlexGrow=void 0})}recalculateColumnWidths(){if(this._columnTree)if(this._cache.isLoading())this._recalculateColumnWidthOnceLoadingFinished=!0;else{const e=this._getColumns().filter(i=>!i.hidden&&i.autoWidth);this._recalculateColumnWidths(e)}}_createScrollerRows(e){const i=[];for(let n=0;n<e;n++){const r=document.createElement("tr");r.setAttribute("part","row"),r.setAttribute("role","row"),this._columnTree&&this._updateRow(r,this._columnTree[this._columnTree.length-1],"body",!1,!0),i.push(r)}return this._columnTree&&this._columnTree[this._columnTree.length-1].forEach(n=>n.isConnected&&n.notifyPath&&n.notifyPath("_cells.*",n._cells)),rUe(this,()=>{this._updateFirstAndLastColumn(),this._resetKeyboardNavigation()}),i}_getRowTarget(){return this.$.items}_createCell(e){const i="vaadin-grid-cell-content-"+(this._contentIndex=this._contentIndex+1||0),n=document.createElement("vaadin-grid-cell-content");n.setAttribute("slot",i);const r=document.createElement(e);r.id=i.replace("-content-","-"),r.setAttribute("tabindex","-1"),r.setAttribute("role",e==="td"?"gridcell":"columnheader");const s=document.createElement("slot");return s.setAttribute("name",i),r.appendChild(s),r._content=n,n.addEventListener("mousedown",()=>{if(window.chrome){const o=()=>{n.contains(this.getRootNode().activeElement)||r.focus(),document.removeEventListener("mouseup",o,!0)};document.addEventListener("mouseup",o,!0)}else setTimeout(()=>{n.contains(this.getRootNode().activeElement)||r.focus()})}),r}_updateRow(e,i,n,r,s){n=n||"body";const o=document.createDocumentFragment();Array.from(e.children).forEach(a=>a._vacant=!0),e.innerHTML="",e.id!=="sizer"&&(e.hidden=!0),i.filter(a=>!a.hidden).forEach((a,l,c)=>{let u;if(n==="body"){if(a._cells=a._cells||[],u=a._cells.filter(d=>d._vacant)[0],u||(u=this._createCell("td"),a._cells.push(u)),u.setAttribute("part","cell body-cell"),e.appendChild(u),l===c.length-1&&(this._rowDetailsTemplate||this.rowDetailsRenderer)){this._detailsCells=this._detailsCells||[];const d=this._detailsCells.filter(f=>f._vacant)[0]||this._createCell("td");this._detailsCells.indexOf(d)===-1&&this._detailsCells.push(d),d._content.parentElement||o.appendChild(d._content),this._configureDetailsCell(d),e.appendChild(d),this._a11ySetRowDetailsCell(e,d),d._vacant=!1}a.notifyPath&&!s&&a.notifyPath("_cells.*",a._cells)}else{const d=n==="header"?"th":"td";r||a.localName==="vaadin-grid-column-group"?(u=a[`_${n}Cell`]||this._createCell(d),u._column=a,e.appendChild(u),a[`_${n}Cell`]=u):(a._emptyCells=a._emptyCells||[],u=a._emptyCells.filter(f=>f._vacant)[0]||this._createCell(d),u._column=a,e.appendChild(u),a._emptyCells.indexOf(u)===-1&&a._emptyCells.push(u)),u.setAttribute("part",`cell ${n}-cell`),this.__updateHeaderFooterRowVisibility(e)}u._content.parentElement||o.appendChild(u._content),u._vacant=!1,u._column=a}),this.appendChild(o),this._frozenCellsChanged(),this._updateFirstAndLastColumnForRow(e)}__updateHeaderFooterRowVisibility(e){if(!e)return;const i=Array.from(e.children).filter(n=>{const r=n._column;if(r._emptyCells&&r._emptyCells.indexOf(n)>-1)return!1;if(e.parentElement===this.$.header){if(r.headerRenderer||r._headerTemplate)return!0;if(r.header===null)return!1;if(r.path||r.header!==void 0)return!0}else if(r.footerRenderer||r._footerTemplate)return!0});e.hidden!==!i.length&&(e.hidden=!i.length,this.notifyResize())}_updateScrollerItem(e,i){this._preventScrollerRotatingCellFocus(e,i),this._columnTree&&(this._toggleAttribute("first",i===0,e),this._toggleAttribute("odd",i%2,e),this._a11yUpdateRowRowindex(e,i),this._getItem(i,e))}_columnTreeChanged(e){this._renderColumnTree(e),this.recalculateColumnWidths()}_renderColumnTree(e){for(Array.from(this.$.items.children).forEach(i=>this._updateRow(i,e[e.length-1],null,!1,!0));this.$.header.children.length<e.length;){const i=document.createElement("tr");i.setAttribute("part","row"),i.setAttribute("role","row"),this.$.header.appendChild(i);const n=document.createElement("tr");n.setAttribute("part","row"),n.setAttribute("role","row"),this.$.footer.appendChild(n)}for(;this.$.header.children.length>e.length;)this.$.header.removeChild(this.$.header.firstElementChild),this.$.footer.removeChild(this.$.footer.firstElementChild);Array.from(this.$.header.children).forEach((i,n)=>this._updateRow(i,e[n],"header",n===e.length-1)),Array.from(this.$.footer.children).forEach((i,n)=>this._updateRow(i,e[e.length-1-n],"footer",n===0)),this._updateRow(this.$.sizer,e[e.length-1]),this._resizeHandler(),this._frozenCellsChanged(),this._updateFirstAndLastColumn(),this._resetKeyboardNavigation(),this._a11yUpdateHeaderRows(),this._a11yUpdateFooterRows(),this.__updateFooterPositioning()}__updateFooterPositioning(){this._firefox&&(this.$.items.style.paddingBottom=0,this.heightByRows||(this.$.items.style.paddingBottom=`${this.$.footer.offsetHeight}px`)),this._ios&&!window.CSS.supports("position","sticky")&&(this.$.table.style.height="",this.$.table.style.minHeight="100%",this.$.table.style.maxHeight="100%",setTimeout(()=>this.$.table.style.height=`${this.$.scroller.offsetHeight}px`))}_updateItem(e,i){e._item=i;const n=this.__getRowModel(e);this._toggleAttribute("selected",n.selected,e),this._a11yUpdateRowSelected(e,n.selected),this._a11yUpdateRowLevel(e,n.level),this._toggleAttribute("expanded",n.expanded,e),this._toggleAttribute("details-opened",this._isDetailsOpened(i),e),(this._rowDetailsTemplate||this.rowDetailsRenderer)&&this._toggleDetailsCell(e,i),this._generateCellClassNames(e,n),this._filterDragAndDrop(e,n),Array.from(e.children).forEach(r=>{if(r._renderer){const s=r._column||this;r._renderer.call(s,r._content,s,n)}else r._instance&&(r._instance.__detailsOpened__=n.detailsOpened,r._instance.__selected__=n.selected,r._instance.__level__=n.level,r._instance.__expanded__=n.expanded,r._instance.setProperties(n))}),this._debouncerUpdateHeights=Tn.debounce(this._debouncerUpdateHeights,_c.after(1),()=>{this._updateMetrics(),this._positionItems(),this._updateScrollerSize()})}_resizeHandler(){this._updateDetailsCellHeights(),this._accessIronListAPI(super._resizeHandler,!0),this._updateScrollerMeasurements(),this.__updateFooterPositioning()}_onAnimationEnd(e){e.animationName.indexOf("vaadin-grid-appear")===0&&(this._render(),e.stopPropagation(),this.notifyResize(),this.__itemsReceived(),requestAnimationFrame(()=>{this.__scrollToPendingIndex(),this.$.table.style.webkitOverflowScrolling="touch"}))}_toggleAttribute(e,i,n){n.hasAttribute(e)===!i&&(i?n.setAttribute(e,""):n.removeAttribute(e))}__getRowModel(e){return{index:e.index,item:e._item,level:this._getIndexLevel(e.index),expanded:this._isExpanded(e._item),selected:this._isSelected(e._item),detailsOpened:!(!this._rowDetailsTemplate&&!this.rowDetailsRenderer)&&this._isDetailsOpened(e._item)}}render(){this._columnTree&&(this._columnTree.forEach(e=>{e.forEach(i=>i._renderHeaderAndFooter())}),this._update())}notifyResize(){super.notifyResize()}_heightByRowsChanged(e,i){(e||i)&&this.notifyResize()}__forceReflow(){this._debouncerForceReflow=Tn.debounce(this._debouncerForceReflow,Yh,()=>{this.$.scroller.style.overflow="hidden",setTimeout(()=>this.$.scroller.style.overflow="")})}}customElements.define(bJ.is,bJ);class wJ extends che(_d){static get is(){return"vaadin-grid-column-group"}static get properties(){return{_childColumns:{value:function(){return this._getChildColumns(this)}},flexGrow:{type:Number,readOnly:!0},width:{type:String,readOnly:!0},_visibleChildColumns:Array,_colSpan:Number,_rootColumns:Array}}static get observers(){return["_updateVisibleChildColumns(_childColumns)","_childColumnsChanged(_childColumns)","_groupFrozenChanged(frozen, _rootColumns)","_groupHiddenChanged(hidden, _rootColumns)","_visibleChildColumnsChanged(_visibleChildColumns)","_colSpanChanged(_colSpan, _headerCell, _footerCell)","_groupOrderChanged(_order, _rootColumns)","_groupReorderStatusChanged(_reorderStatus, _rootColumns)","_groupResizableChanged(resizable, _rootColumns)"]}connectedCallback(){super.connectedCallback(),this._addNodeObserver(),this._updateFlexAndWidth()}disconnectedCallback(){super.disconnectedCallback(),this._observer&&this._observer.disconnect()}_columnPropChanged(e,i){e==="hidden"&&(this._preventHiddenCascade=!0,this._updateVisibleChildColumns(this._childColumns),this._preventHiddenCascade=!1),/flexGrow|width|hidden|_childColumns/.test(e)&&this._updateFlexAndWidth(),e==="frozen"&&(this.frozen=this.frozen||i),e==="lastFrozen"&&(this._lastFrozen=this._lastFrozen||i)}_groupOrderChanged(e,i){if(i){const n=i.slice(0);if(!e)return void n.forEach(a=>a._order=0);const r=/(0+)$/.exec(e).pop().length,s=1+~~(Math.log(i.length)/Math.log(Math.LN10)),o=Math.pow(10,r-s);n[0]&&n[0]._order&&n.sort((a,l)=>a._order-l._order),n.forEach((a,l)=>a._order=e+(l+1)*o)}}_groupReorderStatusChanged(e,i){e!==void 0&&i!==void 0&&i.forEach(n=>n._reorderStatus=e)}_groupResizableChanged(e,i){e!==void 0&&i!==void 0&&i.forEach(n=>n.resizable=e)}_updateVisibleChildColumns(e){this._visibleChildColumns=Array.prototype.filter.call(e,i=>!i.hidden)}_childColumnsChanged(e){!this._autoHidden&&this.hidden&&(Array.prototype.forEach.call(e,i=>i.hidden=!0),this._updateVisibleChildColumns(e))}_updateFlexAndWidth(){this._visibleChildColumns&&(this._visibleChildColumns.length?this._setWidth("calc("+Array.prototype.reduce.call(this._visibleChildColumns,(e,i)=>e+" + "+(i.width||"0px").replace("calc",""),"").substring(3)+")"):this._setWidth("0px"),this._setFlexGrow(Array.prototype.reduce.call(this._visibleChildColumns,(e,i)=>e+i.flexGrow,0)))}_groupFrozenChanged(e,i){i!==void 0&&e!==void 0&&e!==!1&&Array.from(i).forEach(n=>n.frozen=e)}_groupHiddenChanged(e,i){i&&!this._preventHiddenCascade&&(this._ignoreVisibleChildColumns=!0,i.forEach(n=>n.hidden=e),this._ignoreVisibleChildColumns=!1),this._columnPropChanged("hidden")}_visibleChildColumnsChanged(e){this._colSpan=e.length,this._ignoreVisibleChildColumns||(e.length===0?this._autoHidden=this.hidden=!0:this.hidden&&this._autoHidden&&(this._autoHidden=this.hidden=!1))}_colSpanChanged(e,i,n){i&&(i.setAttribute("colspan",e),this._grid&&this._grid._a11yUpdateCellColspan(i,e)),n&&(n.setAttribute("colspan",e),this._grid&&this._grid._a11yUpdateCellColspan(n,e))}_getChildColumns(e){return Kh.getFlattenedNodes(e).filter(this._isColumnElement)}_addNodeObserver(){this._observer=new Kh(this,e=>{(e.addedNodes.filter(this._isColumnElement).length>0||e.removedNodes.filter(this._isColumnElement).length>0)&&(this._preventHiddenCascade=!0,this._rootColumns=this._getChildColumns(this),this._childColumns=this._rootColumns,this._preventHiddenCascade=!1,ul.run(()=>{this._grid&&this._grid._updateColumnTree&&this._grid._updateColumnTree()}))}),this._observer.flush()}_isColumnElement(e){return e.nodeType===Node.ELEMENT_NODE&&/\bcolumn\b/.test(e.localName)}}customElements.define(wJ.is,wJ);class xJ extends f${static get template(){return mT`
      <template class="header" id="defaultHeaderTemplate">
        <vaadin-checkbox
          class="vaadin-grid-select-all-checkbox"
          aria-label="Select All"
          hidden$="[[_selectAllHidden]]"
          on-checked-changed="_onSelectAllCheckedChanged"
          checked="[[_isChecked(selectAll, _indeterminate)]]"
          indeterminate="[[_indeterminate]]"
        ></vaadin-checkbox>
      </template>
      <template id="defaultBodyTemplate">
        <vaadin-checkbox aria-label="Select Row" checked="{{selected}}"></vaadin-checkbox>
      </template>
    `}static get is(){return"vaadin-grid-selection-column"}static get properties(){return{width:{type:String,value:"58px"},flexGrow:{type:Number,value:0},selectAll:{type:Boolean,value:!1,notify:!0},autoSelect:{type:Boolean,value:!1},_indeterminate:Boolean,_previousActiveItem:Object,_selectAllHidden:Boolean}}static get observers(){return["_onSelectAllChanged(selectAll)"]}_pathOrHeaderChanged(e,i,n,r,s,o,a,l,c){!s.value||e===void 0&&o===void 0||(this._bodyTemplate=l=void 0,this.__cleanCellsOfTemplateProperties(s.value)),!n||i===void 0&&a===void 0||(this._headerTemplate=c=void 0,this.__cleanCellsOfTemplateProperties([n])),super._pathOrHeaderChanged(e,i,n,r,s,o,a,l,c)}__cleanCellsOfTemplateProperties(e){e.forEach(i=>{i._content.innerHTML="",delete i._instance,delete i._template})}_prepareHeaderTemplate(){const e=this._prepareTemplatizer(this._findTemplate(!0)||this.$.defaultHeaderTemplate);return e.templatizer.dataHost=e===this.$.defaultHeaderTemplate?this:this.dataHost,e}_prepareBodyTemplate(){const e=this._prepareTemplatizer(this._findTemplate()||this.$.defaultBodyTemplate);return e.templatizer.dataHost=e===this.$.defaultBodyTemplate?this:this.dataHost,e}constructor(){super(),this._boundOnActiveItemChanged=this._onActiveItemChanged.bind(this),this._boundOnDataProviderChanged=this._onDataProviderChanged.bind(this),this._boundOnSelectedItemsChanged=this._onSelectedItemsChanged.bind(this)}disconnectedCallback(){this._grid.removeEventListener("active-item-changed",this._boundOnActiveItemChanged),this._grid.removeEventListener("data-provider-changed",this._boundOnDataProviderChanged),this._grid.removeEventListener("filter-changed",this._boundOnSelectedItemsChanged),this._grid.removeEventListener("selected-items-changed",this._boundOnSelectedItemsChanged),super.disconnectedCallback()}connectedCallback(){super.connectedCallback(),this._grid&&(this._grid.addEventListener("active-item-changed",this._boundOnActiveItemChanged),this._grid.addEventListener("data-provider-changed",this._boundOnDataProviderChanged),this._grid.addEventListener("filter-changed",this._boundOnSelectedItemsChanged),this._grid.addEventListener("selected-items-changed",this._boundOnSelectedItemsChanged))}_onSelectAllChanged(e){e!==void 0&&this._grid&&(this._selectAllChangeLock||(this._grid.selectedItems=e&&Array.isArray(this._grid.items)?this._grid._filter(this._grid.items):[]))}_arrayContains(e,i){for(var n=0;e&&i&&i[n]&&e.indexOf(i[n])>=0;n++);return n==i.length}_onSelectAllCheckedChanged(e){this.selectAll=this._indeterminate||e.target.checked}_isChecked(e,i){return i||e}_onActiveItemChanged(e){const i=e.detail.value;if(this.autoSelect){const n=i||this._previousActiveItem;n&&this._grid._toggleItem(n)}this._previousActiveItem=i}_onSelectedItemsChanged(){this._selectAllChangeLock=!0,Array.isArray(this._grid.items)&&(this._grid.selectedItems.length?this._arrayContains(this._grid.selectedItems,this._grid._filter(this._grid.items))?(this.selectAll=!0,this._indeterminate=!1):(this.selectAll=!1,this._indeterminate=!0):(this.selectAll=!1,this._indeterminate=!1)),this._selectAllChangeLock=!1}_onDataProviderChanged(){this._selectAllHidden=!Array.isArray(this._grid.items)}}customElements.define(xJ.is,xJ),cS("vaadin-grid-sorter",lS`
    :host {
      justify-content: flex-start;
      align-items: baseline;
      -webkit-user-select: none;
      -moz-user-select: none;
      user-select: none;
    }

    [part='content'] {
      display: inline-block;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    [part='indicators'] {
      margin-left: var(--lumo-space-s);
    }

    :host(:not([direction])) [part='indicators']::before {
      opacity: 0.2;
    }

    :host([direction]) {
      color: var(--lumo-primary-text-color);
    }

    [part='order'] {
      font-size: var(--lumo-font-size-xxs);
      line-height: 1;
    }

    /* RTL specific styles */

    :host([dir='rtl']) [part='indicators'] {
      margin-right: var(--lumo-space-s);
      margin-left: 0;
    }
  `,{moduleId:"lumo-grid-sorter"});const SJ=document.createElement("template");SJ.innerHTML=`
  <style>
    @font-face {
      font-family: 'vaadin-grid-sorter-icons';
      src: url(data:application/font-woff;charset=utf-8;base64,d09GRgABAAAAAAQwAA0AAAAABuwAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABGRlRNAAAEFAAAABkAAAAcfep+mUdERUYAAAP4AAAAHAAAAB4AJwAOT1MvMgAAAZgAAAA/AAAAYA8TBPpjbWFwAAAB7AAAAFUAAAFeF1fZ4mdhc3AAAAPwAAAACAAAAAgAAAAQZ2x5ZgAAAlgAAABcAAAAnMvguMloZWFkAAABMAAAAC8AAAA2C5Ap72hoZWEAAAFgAAAAHQAAACQGbQPHaG10eAAAAdgAAAAUAAAAHAoAAABsb2NhAAACRAAAABIAAAASAIwAYG1heHAAAAGAAAAAFgAAACAACwAKbmFtZQAAArQAAAECAAACZxWCgKhwb3N0AAADuAAAADUAAABZCrApUXicY2BkYGAA4rDECVrx/DZfGbhZGEDgyqNPOxH0/wNMq5kPALkcDEwgUQBWRA0dAHicY2BkYGA+8P8AAwMLAwgwrWZgZEAFbABY4QM8AAAAeJxjYGRgYOAAQiYGEICQSAAAAi8AFgAAeJxjYGY6yziBgZWBgWkm0xkGBoZ+CM34msGYkZMBFTAKoAkwODAwvmRiPvD/AIMDMxCD1CDJKjAwAgBktQsXAHicY2GAAMZQCM0EwqshbAALxAEKeJxjYGBgZoBgGQZGBhCIAPIYwXwWBhsgzcXAwcAEhIwMCi+Z/v/9/x+sSuElA4T9/4k4K1gHFwMMMILMY2QDYmaoABOQYGJABUA7WBiGNwAAJd4NIQAAAAAAAAAACAAIABAAGAAmAEAATgAAeJyNjLENgDAMBP9tIURJwQCMQccSZgk2i5fIYBDAidJjycXr7x5EPwE2wY8si7jmyBNXGo/bNBerxJNrpxhbO3/fEFpx8ZICpV+ghxJ74fAMe+h7Ox14AbrsHB14nK2QQWrDMBRER4mTkhQK3ZRQKOgCNk7oGQqhhEIX2WSlWEI1BAlkJ5CDdNsj5Ey9Rncdi38ES+jzNJo/HwTgATcoDEthhY3wBHc4CE+pfwsX5F/hGe7Vo/AcK/UhvMSz+mGXKhZU6pww8ISz3oWn1BvhgnwTnuEJf8Jz1OpFeIlX9YULDLdFi4ASHolkSR0iuYdjLak1vAequBhj21D61Nqyi6l3qWybGPjySbPHGScGJl6dP58MYcQRI0bts7mjebBqrFENH7t3qWtj0OuqHnXcW7b0HOTZFnKryRGW2hFX1m0O2vEM3opNMfTau+CS6Z3Vx6veNnEXY6jwDxhsc2gAAHicY2BiwA84GBgYmRiYGJkZmBlZGFkZ2djScyoLMgzZS/MyDQwMwLSrpYEBlIbxjQDrzgsuAAAAAAEAAf//AA94nGNgZGBg4AFiMSBmYmAEQnYgZgHzGAAD6wA2eJxjYGBgZACCKyoz1cD0o087YTQATOcIewAAAA==) format('woff');
      font-weight: normal;
      font-style: normal;
    }
  </style>
`,document.head.appendChild(SJ.content);class TJ extends S8(T8(_d)){static get template(){return mT`
      <style>
        :host {
          display: inline-flex;
          cursor: pointer;
          max-width: 100%;
        }

        [part='content'] {
          flex: 1 1 auto;
        }

        [part='indicators'] {
          position: relative;
          align-self: center;
          flex: none;
        }

        [part='order'] {
          display: inline;
          vertical-align: super;
        }

        [part='indicators']::before {
          font-family: 'vaadin-grid-sorter-icons';
          display: inline-block;
        }

        :host(:not([direction])) [part='indicators']::before {
          content: '\\e901';
        }

        :host([direction='asc']) [part='indicators']::before {
          content: '\\e900';
        }

        :host([direction='desc']) [part='indicators']::before {
          content: '\\e902';
        }
      </style>

      <div part="content">
        <slot></slot>
      </div>
      <div part="indicators">
        <span part="order">[[_getDisplayOrder(_order)]]</span>
      </div>
    `}static get is(){return"vaadin-grid-sorter"}static get properties(){return{path:String,direction:{type:String,reflectToAttribute:!0,notify:!0,value:null},_order:{type:Number,value:null},_isConnected:{type:Boolean,observer:"__isConnectedChanged"}}}static get observers(){return["_pathOrDirectionChanged(path, direction)"]}ready(){super.ready(),this.addEventListener("click",this._onClick.bind(this))}connectedCallback(){super.connectedCallback(),this._isConnected=!0}disconnectedCallback(){super.disconnectedCallback(),this._isConnected=!1}_pathOrDirectionChanged(){this.__dispatchSorterChangedEvenIfPossible()}__isConnectedChanged(e,i){i!==!1&&this.__dispatchSorterChangedEvenIfPossible()}__dispatchSorterChangedEvenIfPossible(){this.path!==void 0&&this.direction!==void 0&&this._isConnected&&this.dispatchEvent(new CustomEvent("sorter-changed",{bubbles:!0,composed:!0}))}_getDisplayOrder(e){return e===null?"":e+1}_onClick(e){const i=this.getRootNode().activeElement;this!==i&&this.contains(i)||(e.preventDefault(),this.direction==="asc"?this.direction="desc":this.direction==="desc"?this.direction=null:this.direction="asc")}}customElements.define(TJ.is,TJ);class IJ extends f${static get template(){return mT`
      <template class="header" id="headerTemplate">
        <vaadin-grid-sorter path="[[path]]" direction="{{direction}}">[[_getHeader(header, path)]]</vaadin-grid-sorter>
      </template>
    `}static get is(){return"vaadin-grid-sort-column"}static get properties(){return{path:String,direction:{type:String,notify:!0}}}_prepareHeaderTemplate(){const e=this._prepareTemplatizer(this.$.headerTemplate);return e.templatizer.dataHost=this,e}_getHeader(e,i){return e||this._generateHeader(i)}}customElements.define(IJ.is,IJ);const CJ={selectionColumn:!0,columnMenus:!0},QI="esri-grid",U7e="compact column-borders",U1={base:QI,content:`${QI}__content`,grid:`${QI}__grid`,noColumnMenu:`${QI}--no-column-menu`,widget:"esri-widget"};let bn=class extends kc(qi){constructor(t,e){super(t,e),this._grid=null,this._columnElements=[],this._isDataLoaded=!1,this.itemIdPath=null,this.messages=null,this.viewModel=new Zce,this.visibleElements={...CJ}}initialize(){this.handles.add([this.columns.on("change",()=>this.onColumnChange()),Q(()=>{var t;return(t=this.viewModel)==null?void 0:t.size},()=>this._updateGridSize()),Q(()=>{var t;return(t=this.store)==null?void 0:t.state},(t,e)=>{t!=="ready"||e!=="loaded"&&e!=="error"||this.refreshPageCache()}),on(()=>this.highlightIds,"change",t=>{const{added:e,removed:i}=t,n=e.map(s=>{var o;return((o=this.store)==null?void 0:o.getLocalItemByKey(s))||{objectId:s}}),r=i.map(s=>{var o;return((o=this.store)==null?void 0:o.getLocalItemByKey(s))||{objectId:s}});this._deselectRows(r),this._selectRows(n)}),on(()=>{var t,e;return(e=(t=this._grid)==null?void 0:t.$)==null?void 0:e.table},"scroll",()=>{var t;return(t=this.viewModel)==null?void 0:t.closeColumnMenus()})])}destroy(){var t;this.handles.removeAll(),this.resetColumns(),(t=this.columns)==null||t.destroy()}resetColumns(){this.columns.items.forEach(t=>t.destroy()),this.columns.removeAll()}get cellClassNameGenerator(){return this.viewModel.cellClassNameGenerator}set cellClassNameGenerator(t){this.viewModel.cellClassNameGenerator=t}get columns(){return this.viewModel.columns}set columns(t){this.viewModel.columns=t}get columnReorderingEnabled(){return this.viewModel.columnReorderingEnabled}set columnReorderingEnabled(t){this.viewModel.columnReorderingEnabled=t}get dataProvider(){return this.viewModel.dataProvider}set dataProvider(t){this.viewModel.dataProvider=t}get highlightIds(){return this.viewModel.highlightIds}set highlightIds(t){this.viewModel.highlightIds=t}get label(){var t;return((t=this.messages)==null?void 0:t.widgetLabel)??""}set label(t){this._overrideIfSome("label",t)}get multiSortEnabled(){return this.viewModel.multiSortEnabled}set multiSortEnabled(t){this.viewModel.multiSortEnabled=t}get pageSize(){return this.viewModel.pageSize}set pageSize(t){this.viewModel.pageSize=t}get rowDetailsRenderer(){return this.viewModel.rowDetailsRenderer}set rowDetailsRenderer(t){this.viewModel.rowDetailsRenderer=t}get size(){return this.viewModel.size}get sortOrders(){var t;return(t=this._grid)!=null&&t._sorters?this._grid._sorters.filter(e=>!!e).map(({direction:e,path:i})=>({direction:e,path:i})):[]}get store(){return this.viewModel.store}set store(t){this.viewModel.store=t}castVisibleElements(t){return{...CJ,...t}}render(){const{columnMenus:t}=this.visibleElements;return O("div",{bind:this,class:this.classes(U1.base,U1.widget,{[U1.noColumnMenu]:!t})},O("div",{bind:this,class:U1.content},this.renderGrid()))}renderGrid(){return O("vaadin-grid",{_safari:!1,afterCreate:this._afterGridCreate,afterUpdate:this._afterGridUpdate,bind:this,cellClassNameGenerator:this.cellClassNameGenerator,class:U1.grid,columnReorderingAllowed:this.columnReorderingEnabled,dataProvider:this.dataProvider,id:`${this.id}_grid`,itemIdPath:this.itemIdPath,multiSort:this.multiSortEnabled,pageSize:this.pageSize,ref:"grid",rowDetailsRenderer:this.rowDetailsRenderer,size:this.size},this.renderAllColumns())}renderAllColumns(){var t;return this.viewModel.state!=="disabled"&&((t=this.columns)!=null&&t.length)?[this.renderSelectionColumn(),this.renderColumns()]:null}renderSelectionColumn(){return O("vaadin-grid-selection-column",{_selectAllHidden:!0,selectAll:!1,bind:this,hidden:!this.visibleElements.selectionColumn,sortable:!1,frozen:!Mc(this.container)})}renderColumns(){return this.columns.items.map((t,e)=>"columns"in t?this.renderGroupColumn(t,e):O("vaadin-grid-column",{...this.getColumnProps(t,e)})).filter(Ti)}renderGroupColumn(t,e){const i=this.getColumnProps(t,e);if(i.hidden||!t.columns)return null;const n=t.columns.filter(({hidden:r})=>!r);return n.length?O("vaadin-grid-column-group",{...i},n.map(r=>O("vaadin-grid-column",{...this.getColumnProps(r,e)}))):null}getColumnProps(t,e){const{id:i}=this,{autoWidth:n,direction:r,flexGrow:s,frozen:o,header:a,hidden:l,path:c,resizable:u,textAlign:d,width:f}=t;return{autoWidth:n,direction:r,flexGrow:s,frozen:o,header:a,hidden:l,key:`${i}_${a}_${e??c}`,path:c,resizable:u,"text-align":d,width:typeof f=="number"?`${f}px`:f,bind:this,afterCreate:this._afterColumnCreate,afterRemoved:this._afterColumnRemoved}}clearSelection(){this._clearSelection(),this.scheduleRender()}clearSort(){var e,i;let t=!1;this._grid&&((e=this._grid._sorters)!=null&&e.length&&(this._grid._sorters.forEach(n=>{n._order=null,n.direction=null}),t=!0),(i=this.columns)!=null&&i.length&&this.columns.some(n=>!!n.direction)&&(this.columns.forEach(n=>n.direction=null),t=!0),t&&(this.notifyChange("sortOrders"),this.scheduleRender()))}findColumn(t){this.viewModel.findColumn(t)}generateCellClassNames(){var t;(t=this._grid)==null||t.generateCellClassNames()}getSlotElementByName(t){var e,i;return((i=(e=this._grid)==null?void 0:e.shadowRoot)==null?void 0:i.querySelector(`slot[name='${t}']`))??null}hideColumn(t){var e;(e=this.viewModel)==null||e.hideColumn(t),this.scheduleRender()}notifyResize(){var t;(t=this._grid)==null||t.notifyResize()}recalculateColumnWidths(){var t;(t=this._grid)==null||t.recalculateColumnWidths()}async reset(){var t;this._isDataLoaded=!1,this._clearSelection(),await((t=this.store)==null?void 0:t.reset()),this.scrollToTop()}refreshPageCache(){var t;(t=this._grid)==null||t.clearCache()}selectRows(t){const e=t==null?void 0:t.filter(n=>!this.highlightIds.includes(n.objectId)),i=e.map(n=>n.objectId);i.length&&(this.highlightIds.addMany(i),this._selectRows(e))}deselectRows(t){const e=(t==null?void 0:t.map(i=>i.objectId))||[];e.length&&(this.highlightIds.removeMany(e),this._deselectRows(t))}showColumn(t){var e;(e=this.viewModel)==null||e.showColumn(t),this.scheduleRender()}sort({path:t,direction:e}){var i;(i=this.viewModel)==null||i.sortColumn(t,e),this.notifyChange("sortOrders")}scrollToIndex(t){var e;(e=this._grid)==null||e.scrollToIndex(t)}scrollToTop(){var t;(t=this._grid)==null||t.scrollToIndex(0)}isEditingActive(){return!!this._getActiveEditInfo().length}onColumnChange(){this._syncColumnRenderers()}_afterGridCreate(t){const e=this._grid=t;e.setAttribute("theme",U7e),customElements.whenDefined("vaadin-grid").then(()=>this._addGridEventListeners()),e.__updateSorter=i=>{const n=e._sorters,r=!n.includes(i);if(i.direction||!r){if(i._order=null,e.multiSort)e._removeArrayItem(n,i),i.direction&&(i._initialOrder!=null?(r?n[i._initialOrder]=i:n.splice(i._initialOrder,0,i),i._initialOrder=null):n.unshift(i)),e.__updateSortOrders();else if(i.direction){const s=n.filter(o=>o!==i);e._sorters=[i],s.forEach(o=>{o._order=null,o.direction=null})}}}}_afterGridUpdate(t){this._grid||(this._grid=t)}_afterColumnCreate(t){this._applyRenderersToColumnElement(t),this._columnElements.push(t)}_afterColumnRemoved(t){const e=this._columnElements.indexOf(t,0);e>-1&&this._columnElements.splice(e,1)}_syncColumnRenderers(){this._columnElements.forEach(t=>{this._applyRenderersToColumnElement(t)})}_updateGridSize(){this._grid&&(this._grid.size=this.size||0,this.scheduleRender())}_getActiveEditInfo(){return!this.columns||this.columns.length?[]:this.columns.filter(t=>"activeEditInfo"in t).map(t=>t.activeEditInfo).items}_addGridEventListeners(){const t=this._grid;ks(t),this.handles.add([Lh(t,"click",e=>this._onRowClick(e)),Lh(t,"selected-items-changed",e=>this._onSelectionChange(e)),Lh(t,"sorter-changed",()=>this.notifyChange("sortOrders")),Lh(t,"loading-changed",e=>{this._isDataLoaded||e.detail.value===!1&&(this._isDataLoaded=!0,this._selectRowsOnLoad())})])}_onRowClick(t){const e=this._grid;ks(e);const i=e.getEventContext(t),{item:n,section:r}=i;n&&r&&r!=="details"&&r!=="header"&&this.emit("row-click",{context:i,native:t})}_clearSelection(){this._grid&&(this.highlightIds.removeAll(),this._grid.selectedItems=[],this._grid.render())}_selectRowsOnLoad(){var n;const t=this._grid;if(!t)return;const e=t.selectedItems.slice();((n=this.highlightIds)==null?void 0:n.filter(r=>e.findIndex(s=>s.objectId===r)<0)).forEach(r=>{var s;return t.selectedItems.push(((s=this.store)==null?void 0:s.getLocalItemByKey(r))||{objectId:r})}),t.render()}_selectRows(t){const e=this._grid;if(!e)return;const i=e.selectedItems.slice();t.filter(n=>i.findIndex(r=>r.objectId===n.objectId)<0).forEach(n=>e.selectedItems.push(n)),e.render()}_deselectRows(t){const e=this._grid;if(!e)return;const i=e.selectedItems.slice();t.forEach(n=>{const r=i.findIndex(s=>s.objectId===n.objectId);r>-1&&i.splice(r,1)}),e.selectedItems=i,e.render()}_onSelectionChange(t){const e=t;if(e.detail.path==="selectedItems.splices"){const{removed:i,object:n}=e.detail.value.indexSplices[0],r=n.filter(o=>!this.highlightIds.includes(o.objectId)).map(o=>o.objectId),s=i.filter(o=>this.highlightIds.includes(o.objectId)).map(o=>o.objectId);this.highlightIds.removeMany(s),this.highlightIds.addMany(r)}}_applyRenderersToColumnElement(t){const e=t==null?void 0:t.path,i=e!=null?this.viewModel.findColumn(e):void 0;if(i)try{const{renderFunction:n,footerRenderFunction:r,headerRenderFunction:s}=i;n&&"renderer"in t&&(t.renderer=(o,a,l)=>n({root:o,column:a,rowData:l})),r&&(t.footerRenderer=(o,a)=>r({root:o,column:a})),s&&(t.headerRenderer=(o,a)=>s({root:o,column:a}))}catch{}}};h([p()],bn.prototype,"_grid",void 0),h([p()],bn.prototype,"_isDataLoaded",void 0),h([p()],bn.prototype,"cellClassNameGenerator",null),h([p()],bn.prototype,"columns",null),h([p()],bn.prototype,"columnReorderingEnabled",null),h([p()],bn.prototype,"dataProvider",null),h([p()],bn.prototype,"highlightIds",null),h([p()],bn.prototype,"itemIdPath",void 0),h([p()],bn.prototype,"label",null),h([p(),Zt("esri/widgets/FeatureTable/t9n/FeatureTable")],bn.prototype,"messages",void 0),h([p()],bn.prototype,"multiSortEnabled",null),h([p()],bn.prototype,"pageSize",null),h([p()],bn.prototype,"rowDetailsRenderer",null),h([p()],bn.prototype,"size",null),h([p({readOnly:!0})],bn.prototype,"sortOrders",null),h([p()],bn.prototype,"store",null),h([p()],bn.prototype,"viewModel",void 0),h([p()],bn.prototype,"visibleElements",void 0),h([ut("visibleElements")],bn.prototype,"castVisibleElements",null),bn=h([P("esri.widgets.FeatureTable.Grid.Grid")],bn);const G7e=bn;let Yv=class extends ck{constructor(e){super(e),this.columns=null,this.sortable=!1}get path(){return this.header}set path(e){this.header=e}};h([p()],Yv.prototype,"columns",void 0),h([p()],Yv.prototype,"path",null),h([p({readOnly:!0})],Yv.prototype,"sortable",void 0),Yv=h([P("esri.widgets.FeatureTable.Grid.GroupColumn")],Yv);const H7e=Yv,uhe="esri.widgets.FeatureTable.support.FeatureStore",q7e=ne.getLogger(uhe);function rL(t,e,i){q7e.error(new V(t,e,i))}let $r=class extends ye{constructor(e){super(e),this._loaded=!1,this._loadError=!1,this._loading=!1,this._editOperationQueue=[],this._queryOperationQueue=[],this._objectIdCache=new xe,this._hasStaleCache=!1,this.count=0,this.failures=new xe,this.itemCache=new xe,this.relatedRecordsEnabled=!1}destroy(){var e,i;this.layer=null,(e=this.itemCache)==null||e.destroy(),(i=this.failures)==null||i.destroy(),this._set("itemCache",null)}set attachmentsEnabled(e){this._reset(),this._set("attachmentsEnabled",e),this.notifyChange("state")}set filterGeometry(e){this._reset(),this._set("filterGeometry",e),this.notifyChange("state")}set layer(e){this._reset(),this._set("layer",e),this.notifyChange("state")}set objectIds(e){this._reset(),this._set("objectIds",e||null),this.notifyChange("state")}get orderByFields(){return this._get("orderByFields")||[]}set orderByFields(e){const i=this.orderByFields;ES(e,i)||(this.itemCache.removeAll(),this._hasStaleCache=!0,this._set("orderByFields",e))}get querying(){return this._queryOperationQueue.length>0}set returnGeometry(e){this._reset(),this._set("returnGeometry",e),this.notifyChange("state")}get state(){const{layer:e,_loaded:i,_loadError:n,_loading:r}=this;return n?"error":!e||this.get("layer.loadError")?"disabled":r?"loading":this.get("layer.loadStatus")==="loaded"&&i?"loaded":"ready"}get syncing(){return this._editOperationQueue.length>0}set timeExtent(e){this._reset(),this._set("timeExtent",e),this.notifyChange("state")}get where(){return this._get("where")||null}set where(e){this._reset(),this._set("where",e),this.notifyChange("state")}async load(){this._reset();const{layer:e}=this;if(e){this._loading=!0,this.notifyChange("state");try{await e.when(),await this._syncLayerInfo(),this._loading=!1,this._loaded=!0,this.notifyChange("state")}catch(i){throw this._reset(),this._loadError=!0,this.notifyChange("state"),rL("store:load-error","An error ocurred.",{error:i}),i}}}async refreshLayerInfo(){return this._syncLayerInfo()}async addItems(e){}async fetchItems(e){const{page:i,pageSize:n}=e,r=i*n,s=r+n,{layer:o,state:a}=this;if(!o||a!=="loaded")return[];this.notifyChange("querying");const l=await this._query({start:r,num:s,page:i,pageSize:n});return this.notifyChange("state"),l}async verifyFeaturesByObjectId(e){const{layer:i,state:n}=this;if(!i||n!=="loaded")return[];const{features:r}=await this._verifyFeaturesByObjectId(e);return e.map(s=>r.some(o=>(o==null?void 0:o.getObjectId())===s))}async query(e){const{layer:i,state:n}=this;if(!i||n!=="loaded")return[];this.notifyChange("querying");const r=await this._query(e);return this.notifyChange("state"),r}async removeItemAt(e){}async reset(){this._reset()}async updateItem(e){return this._update(e).then(()=>{})}async deleteRowsByObjectId(e){return this._delete({objectIds:e})}getLocalItemByKey(e){return this.getItemByObjectId(e)}getItemByObjectId(e){const{itemCache:i,layer:{objectIdField:n}}=this;return i.find(r=>{var s;return((s=r.feature)==null?void 0:s.attributes[n])===e})}getLocalItemAt(e){return this.itemCache.at(e)}at(e){return Promise.resolve(this.itemCache.at(e))}getObjectIdIndex(e){const{itemCache:i,layer:{objectIdField:n}}=this;return i.findIndex(r=>{var s;return((s=r.feature)==null?void 0:s.attributes[n])===e})}_reset(){this.itemCache.removeAll(),this.failures.removeAll(),this._editOperationQueue=[],this._queryOperationQueue=[],this._hasStaleCache=!1,this._loading=!1,this._loaded=!1,this._loadError=!1,this._set("count",0),this._objectIdCache.removeAll(),this.notifyChange("querying"),this.notifyChange("syncing"),this.notifyChange("state")}_getIdsFromFeatures(e){return e.map(i=>i.attributes[this.layer.objectIdField])}_toFeatureData(e,i){const{layer:{objectIdField:n}}=this;return e.map(r=>{const{attributes:s}=r,o=s[n];return{objectId:o,feature:r,attachments:i?i[o]:null,relatedRecords:null}})}async _update(e){const{layer:i}=this,{operations:n}=tf(i);if(!n.supportsUpdate||!("applyEdits"in i))throw new V("store:update-error","Update is not supported.");const{index:r,name:s,value:o}=e,a=await this.at(r);if(!a||!a.feature)throw new V("store:update-error","Feature with provided 'objectId' not found.");const{feature:l}=a,c=q(l.attributes);c[s]=o;const u=new Vo({attributes:c}),d=i.applyEdits({updateFeatures:[u]}).then(f=>{const{updateFeatureResults:m}=f,g=m.find(y=>!!y.error);if(g)throw g.error;return m.length&&(l.attributes=c),f});return this._queueEditOperation(()=>d)}async _delete(e){const{layer:i}=this,{operations:n}=tf(i);if(!n.supportsDelete||!("applyEdits"in i))throw new V("store:delete-error","Delete is not supported.");const{objectIds:r}=e,s=r.map(o=>{var a;return(a=this.getItemByObjectId(o))==null?void 0:a.feature}).filter(Ti);return this._queueEditOperation(()=>i.applyEdits({deleteFeatures:s}))}async _query(e){const{refresh:i}=e;return i===!0?(this.itemCache.removeAll(),this._syncLayerInfo().then(()=>this._queryFeatureData(e))):(this._hasStaleCache&&(await this._updateIds(),this._hasStaleCache=!1),this._queryFeatureData(e))}async _queryFeatureData(e){return this._queueQueryOperation(async()=>{const{features:i}=await this._queryFeatures(e),n=this._getIdsFromFeatures(i),r=await this._queryAttachments(n);return this._toFeatureData(i,r)||[]})}async _syncLayerInfo(){await this._updateCount(),await this._updateIds()}async _updateCount(){await this._queryCount().then(e=>this._set("count",e))}async _updateIds(){var e,i,n;(n=(i=(e=this.layer)==null?void 0:e.capabilities)==null?void 0:i.query)!=null&&n.supportsPagination||(this._objectIdCache.removeAll(),await this._queryForObjectIds().then(r=>this._objectIdCache.addMany(r)))}_queryCount(){var s,o;const{filterGeometry:e,layer:i}=this,n=(o=(s=i.capabilities)==null?void 0:s.query)==null?void 0:o.supportsCacheHint,r=i.createQuery();return r.geometry=e,r.returnGeometry=!1,r.where=this._getWhere(),r.timeExtent=this._getTimeExtent(),r.objectIds=this.objectIds,n&&(r.cacheHint=!0),i.queryFeatureCount(r)}_queryForObjectIds(){var l;const{filterGeometry:e,layer:i,orderByFields:n}=this,r=(l=i.capabilities)==null?void 0:l.query,s=r==null?void 0:r.supportsCacheHint,o=r==null?void 0:r.supportsOrderBy,a=i.createQuery();return a.geometry=e,a.outFields=[i.objectIdField],a.returnGeometry=!1,a.where=this._getWhere(),a.timeExtent=this._getTimeExtent(),a.objectIds=this.objectIds,o&&(a.orderByFields=n),s&&(a.cacheHint=!0),i.queryObjectIds(a)}async _queryFeatures(e){var u,d,f;const{layer:i}=this;if(!((u=tf(i))!=null&&u.operations.supportsQuery))throw new V("store:query-error","Layer does not support query operation.");const{filterGeometry:n,orderByFields:r,returnGeometry:s}=this,o=(f=(d=this.layer)==null?void 0:d.capabilities)==null?void 0:f.query,{start:a,pageSize:l}=e,c=i.createQuery();return c.returnGeometry=s,o!=null&&o.supportsPagination?(c.start=a,c.num=l,c.where=this._getWhere(),c.timeExtent=this._getTimeExtent(),c.objectIds=this.objectIds):c.objectIds=this.objectIds||this._getObjectIdsForPage(a,l??0),o!=null&&o.supportsOrderBy&&(c.orderByFields=r),n&&(c.geometry=n),o!=null&&o.supportsCacheHint&&(c.cacheHint=!0),i.queryFeatures(c)}async _verifyFeaturesByObjectId(e){var a,l,c;const{layer:i}=this;if(!((a=tf(i))!=null&&a.operations.supportsQuery))throw new V("store:query-error","Layer does not support query operation.");const{filterGeometry:n,orderByFields:r}=this,s=(c=(l=this.layer)==null?void 0:l.capabilities)==null?void 0:c.query,o=i.createQuery();return o.where=this._getWhere(),o.timeExtent=this._getTimeExtent(),o.returnGeometry=!1,o.objectIds=e,o.outFields=[i.objectIdField],s!=null&&s.supportsOrderBy&&(o.orderByFields=r),n&&(o.geometry=n),s!=null&&s.supportsCacheHint&&(o.cacheHint=!0),i.queryFeatures(o)}_getObjectIdsForPage(e,i){const n=this._objectIdCache.toArray();return n.length>=e+i?n.slice(e,e+i):n.slice(e)}_queryAttachments(e){var a;const{attachmentsEnabled:i,layer:n}=this,{capabilities:r}=n,s=r==null?void 0:r.data.supportsAttachment,o=(a=r==null?void 0:r.operations)==null?void 0:a.supportsQueryAttachments;return i&&s&&o&&"queryAttachments"in n?n.queryAttachments(new Aae({objectIds:e,where:this._getWhere()})):Promise.resolve(null)}_syncLocalCache(e){e.forEach(i=>{if(i.feature){const n=i.feature.getObjectId();if(n!=null){const r=this.getObjectIdIndex(n);r===-1?this.itemCache.add(i):this.itemCache.splice(r,1,i)}}})}_queueQueryOperation(e){return this._queryOperationQueue.push(e),this.notifyChange("querying"),e().then(i=>this._queryOperationQueue.includes(e)?(this._syncLocalCache(i),i):[]).catch(i=>{rL("store:query-error","An error ocurred.",{error:i});const n={error:i,retry:()=>{this.failures.remove(n),this._queueQueryOperation(e)},cancel:()=>this.failures.remove(n)};return this.failures.add(n),[]}).then(i=>(jC(this._queryOperationQueue,e),this.notifyChange("querying"),i))}_queueEditOperation(e){return this._editOperationQueue.push(e),this.notifyChange("syncing"),e().then(i=>(jC(this._editOperationQueue,e),this.notifyChange("syncing"),i)).catch(i=>{rL("store:edit-error","An error ocurred.",{error:i});const n={error:i,retry:()=>{this.failures.remove(n),this._queueEditOperation(e)},cancel:()=>this.failures.remove(n)};throw this.failures.add(n),jC(this._editOperationQueue,e),this.notifyChange("syncing"),i})}_getWhere(){var e;return this.where||((e=this.layer)==null?void 0:e.definitionExpression)||"1=1"}_getTimeExtent(){const e=this.layer;return this.timeExtent||e&&"timeExtent"in e&&e.timeExtent||null}};h([p()],$r.prototype,"attachmentsEnabled",null),h([p({readOnly:!0})],$r.prototype,"count",void 0),h([p({readOnly:!0})],$r.prototype,"failures",void 0),h([p()],$r.prototype,"filterGeometry",null),h([p({readOnly:!0})],$r.prototype,"itemCache",void 0),h([p({value:null})],$r.prototype,"layer",null),h([p({value:null})],$r.prototype,"objectIds",null),h([p()],$r.prototype,"orderByFields",null),h([p({readOnly:!0})],$r.prototype,"querying",null),h([p()],$r.prototype,"relatedRecordsEnabled",void 0),h([p({value:!1})],$r.prototype,"returnGeometry",null),h([p({readOnly:!0})],$r.prototype,"state",null),h([p({readOnly:!0})],$r.prototype,"syncing",null),h([p()],$r.prototype,"timeExtent",null),h([p()],$r.prototype,"where",null),$r=h([P(uhe)],$r);const hhe=$r;let Gt=class extends kc(Zce){constructor(e){super(e),this._debounceRefresh=kS(()=>this._refresh()),this._highlights=new Rs,this.activeFilters=new xe,this.autoRefreshEnabled=!0,this.cellClassNameGenerator=(i,n)=>i.path||null,this.columns=new xe,this.dataProvider=async(i,n)=>{const{store:r}=this,{page:s,pageSize:o,sortOrders:a}=i,l=this._sortOrdersToLayerOrderByFields(a);n&&(r?(await r.set({orderByFields:l}),r.state!=="loaded"&&r.state!=="loading"&&await r.load(),n&&n(await r.fetchItems({page:s,pageSize:o}))):n&&n([]))},this.editingEnabled=!1,this.fieldConfigs=null,this.grid=null,this.highlightEnabled=!0,this.itemIdPath="objectId",this.messagesCommon=null,this.messagesURIUtils=null,this.relatedRecordsEnabled=!1,this.returnGeometryEnabled=!1,this.store=null,this.tableTemplate=null,this.view=null,this._onLayerRefresh=this._onLayerRefresh.bind(this),this._set("store",new hhe),this._set("grid",new G7e({itemIdPath:this.itemIdPath,viewModel:this}))}initialize(){const e=async()=>{this.messages=await fy("esri/widgets/FeatureTable/t9n/FeatureTable"),this.messagesCommon=await fy("esri/t9n/common"),this.messagesURIUtils=await fy("esri/widgets/support/t9n/uriUtils")};e(),this.handles.add([FS(()=>{e(),this._generateColumns()}),on(()=>this.highlightIds,"change",i=>this._onHighlightIdsChange(i),{onListenerAdd:()=>{this.highlightIds.forEach(i=>this._highlight(i))},onListenerRemove:()=>{this.highlightIds.forEach(i=>this._unhighlight(i))}}),Q(()=>this.layerView,()=>{var i;this._highlights.removeAll(),this.layerView&&this.highlightEnabled&&((i=this.highlightIds)==null||i.forEach(n=>this._highlight(n)))}),Q(()=>this.highlightEnabled,()=>{var i;this._highlights.removeAll(),this.highlightEnabled&&((i=this.highlightIds)==null||i.forEach(n=>this._highlight(n)))}),Q(()=>this.relatedRecordsEnabled,i=>this.store.relatedRecordsEnabled=i),Q(()=>this.returnGeometryEnabled,i=>this.store.returnGeometry=i),Q(()=>{var i;return(i=this.layer)==null?void 0:i.loaded},i=>i&&this._onLayerLoad()),Q(()=>this.store.state,i=>{var n;i==="loaded"&&((n=this.grid)==null||n.scrollToTop())}),Q(()=>[this.messages,this.tableTemplate,this.fieldConfigs],()=>{var i;return((i=this.layer)==null?void 0:i.loaded)&&this._generateColumns()}),Q(()=>this.editingEnabled,i=>{var n;this.columns.forEach(r=>{"editingEnabled"in r&&(r.editingEnabled=i)}),(n=this.grid)==null||n.onColumnChange()}),Q(()=>{var i;return(i=this.layer)==null?void 0:i.definitionExpression},(i,n)=>(i||n)&&this.store.state==="loaded"&&this.reset()),Q(()=>this.layer&&"timeExtent"in this.layer&&this.layer.timeExtent,(i,n)=>(i||n)&&!this.timeExtent&&this.store.state==="loaded"&&this.reset()),on(()=>this.layer,"refresh",i=>this._onLayerRefresh(i))])}destroy(){var e,i;this._resetColumns(),this.handles.removeAll(),this._highlights.removeAll(),this._highlights.destroy(),(e=this.grid)==null||e.destroy(),(i=this.columns)==null||i.destroy(),this.layer=null,this.view=null}get _defaultHiddenFields(){return ste(this.layer)}get activeSortOrders(){var e;return(e=this.grid)!=null&&e.sortOrders?this.grid.sortOrders.map(({path:i,direction:n})=>({fieldName:i,direction:n})):[]}set attachmentsEnabled(e){this.attachmentsEnabled!==e&&(this._set("attachmentsEnabled",e),this._generateColumns(),this.store.attachmentsEnabled=e)}set filterGeometry(e){if(!this.filterGeometry&&!e)return;const i=this.activeFilters.find(n=>n.type==="geometry");i&&this.activeFilters.remove(i),this._set("filterGeometry",e),this.store.filterGeometry=e,e&&this.activeFilters.add({type:"geometry",geometry:e})}get hiddenFields(){return this._get("hiddenFields")??new xe}set hiddenFields(e){Array.isArray(e)?this._set("hiddenFields",new xe(e)):this._set("hiddenFields",e)}get highlightOnRowSelectEnabled(){return this.highlightEnabled}set highlightOnRowSelectEnabled(e){this.highlightEnabled=e}set layer(e){var i;this._set("layer",e),(i=this.grid)==null||i.clearSort(),this._resetColumns(),this.store.layer=e,e&&(e.loaded?this._onLayerLoad():e.load()),this.notifyChange("state")}get layerView(){var e;return((e=this.view)==null?void 0:e.allLayerViews.find(i=>i.layer===this.layer))||null}set messages(e){var i;(i=this.grid)==null||i.set("messages",e),this._set("messages",e)}get state(){const{store:e}=this;return e&&e.state!=="disabled"?e.state==="loading"?"loading":e.state==="loaded"?"loaded":"ready":"disabled"}set timeExtent(e){this._set("timeExtent",e),this.store.timeExtent=e}clearHighlights(){this._highlights.removeAll()}clearSelection(){var e;(e=this.grid)==null||e.clearSelection()}async deleteSelection(){const e=this.highlightIds.toArray();if(!(e!=null&&e.length))return;const{deleteFeatureResults:i}=await this.store.deleteRowsByObjectId(e),n=i.filter(r=>!r.error).map(r=>r.objectId);n.length&&(this.deselectRows(n),await this.refresh())}deselectRows(e){var n;const i=this._getStoreItemsFromSelectionParams(e);(n=this.grid)==null||n.deselectRows(i)}filterBySelection(){const e=this.highlightIds.toArray();e.length&&(this.clearSelectionFilter(),this.store.objectIds=e,this.activeFilters.add({type:"selection",objectIds:e}))}getObjectIdIndex(e){var i;return(i=this.store)==null?void 0:i.getObjectIdIndex(e)}getValue(e,i){var r;const n=this.store.getItemByObjectId(e);return(r=n==null?void 0:n.feature)==null?void 0:r.attributes[i]}get highlightIds(){return this._get("highlightIds")||new xe}set highlightIds(e){Array.isArray(e)?this._set("highlightIds",new xe(e)):this._set("highlightIds",e)}async refresh(){return $y(this._debounceRefresh())}reset(){var e;(e=this.grid)==null||e.reset()}selectRows(e){var n;const i=this._getStoreItemsFromSelectionParams(e);return(n=this.grid)==null?void 0:n.selectRows(i)}scrollToIndex(e){var i;(i=this.grid)==null||i.scrollToIndex(e)}clearSelectionFilter(){this.store.objectIds=null;const e=this.activeFilters.find(i=>i.type==="selection");e&&this.activeFilters.remove(e)}zoomToSelection(){const{layer:e,view:i}=this,n=this.highlightIds.toArray();if(!e||!i||!n.length)return;const r=e.createQuery();r.objectIds=n,r.returnGeometry=!0,e.queryFeatures(r).then(s=>{i.goTo(s.features).catch(o=>{o.name!=="AbortError"&&console.error(o)})})}async _refresh(){var i;await this.store.refreshLayerInfo();const e=this.highlightIds.toArray();e.length&&(await this.store.verifyFeaturesByObjectId(e)).forEach((n,r)=>{n||this.deselectRows(e[r])}),(i=this.grid)==null||i.refreshPageCache()}_onLayerLoad(){var i;const e=(i=this.layer.capabilities)==null?void 0:i.query.maxRecordCount;e&&e<this.pageSize&&this.grid&&(this.grid.pageSize=e),this._generateColumns()}_onLayerRefresh(e){this.autoRefreshEnabled&&e.dataChanged&&this.refresh()}_generateColumns(){var n,r;this._resetColumns();const e=[],i=(n=this.tableTemplate)!=null&&n.columnTemplates?this._generateColumnsFromTemplates(this.tableTemplate.columnTemplates):(r=this.fieldConfigs)!=null&&r.length?this._generateColumnsFromConfigs():this._generateDefaultFieldColumns();e.push(...i),e.length&&this.attachmentsEnabled&&e.push(this._generateDefaultAttachmentColumn()),this.columns.addMany([...e])}_generateColumnsFromTemplates(e){var f;const{editingEnabled:i,grid:n,layer:r,messages:s,messagesCommon:o,messagesURIUtils:a,store:l,tableTemplate:c}=this,u=((f=this.layer)==null?void 0:f.fields)??[],d=m=>{var y;const g="fieldName"in m&&((y=m.fieldName)==null?void 0:y.toLowerCase());return u.find(_=>{var b;return g===((b=_.name)==null?void 0:b.toLowerCase())})};return e.filter(m=>d(m)!=null||m.type==="group"&&"columnTemplates"in m).map(m=>{if("fieldName"in m){const g=d(m),y=m.visible===!1||m.visible!==!0&&this._isFieldHidden(g==null?void 0:g.name),{direction:_,formatFunction:b,initialSortPriority:w,menuConfig:x,textAlign:S}=m;return new FO({direction:_,editingEnabled:i,expressionInfos:(c==null?void 0:c.expressionInfos)||null,field:g,formatFunction:b,grid:n,hidden:y,initialSortPriority:w,layer:r,messages:s,messagesCommon:o,messagesURIUtils:a,menuConfig:x,store:l,template:m,textAlign:S})}if(m.type==="group"&&"columnTemplates"in m){const g=this._generateColumnsFromTemplates(m.columnTemplates),y=m.visible===!1||m.visible!==!0&&this._isFieldHidden(m.label),{label:_}=m;return new H7e({header:_,columns:g,hidden:y})}return new ck({...m})})}_generateColumnsFromConfigs(){var d;const{editingEnabled:e,fieldConfigs:i,grid:n,layer:r,messages:s,messagesCommon:o,messagesURIUtils:a,store:l}=this;if(!i)return[];const c=((d=this.layer)==null?void 0:d.fields)??[],u=f=>{var g;const m=(g=f.name)==null?void 0:g.toLocaleLowerCase();return c.find(y=>{var _;return m===((_=y.name)==null?void 0:_.toLowerCase())})};return i.filter(u).map(f=>{const m=f.direction||null,g=f.formatFunction||null,y=f.textAlign||null,_=f.initialSortPriority!=null?f.initialSortPriority:null,b=u(f),w=f.visible===!1||f.visible!==!0&&this._isFieldHidden(b==null?void 0:b.name),x=f.menuConfig||null;return new FO({config:f,direction:m,editingEnabled:e,field:b,formatFunction:g,grid:n,hidden:w,layer:r,store:l,messages:s,messagesCommon:o,messagesURIUtils:a,menuConfig:x,textAlign:y,initialSortPriority:_})})}_generateDefaultFieldColumns(){var l;const{editingEnabled:e,grid:i,layer:n,messages:r,messagesCommon:s,messagesURIUtils:o,store:a}=this;return(((l=this.layer)==null?void 0:l.fields)??[]).map(c=>new FO({editingEnabled:e,field:c,grid:i,hidden:this._isFieldHidden(c.name),layer:n,store:a,messages:r,messagesCommon:s,messagesURIUtils:o}))}_generateDefaultAttachmentColumn(){var e;return new Jje({header:(e=this.messages)==null?void 0:e.attachments})}_sortOrdersToLayerOrderByFields(e){return e&&e.length?e.filter((i,n,r)=>r.map(s=>s.path).indexOf(i.path)===n).filter(({direction:i})=>!!i).map(({direction:i,path:n})=>n+" "+(i==null?void 0:i.toUpperCase())):[]}_isFieldHidden(e){const i=e==null?void 0:e.toLowerCase();return(this.hiddenFields??this._defaultHiddenFields).some(n=>n.toLowerCase()===i)}_highlight(e){this.layerView&&Tce(this.layerView)&&this._highlights.add(this.layerView.highlight(e),e)}_unhighlight(e){this._highlights.remove(e)}_getStoreItemsFromSelectionParams(e){const i=[];return(e=e instanceof Array?e:[e]).forEach(n=>{let r=n instanceof Vo?n:null;const s=r?r.getObjectId():n;if(typeof s=="number"||typeof s=="string"){if(!r){const o=this.store.getItemByObjectId(s);o&&(r=o.feature)}i.push({objectId:s,feature:r})}}),i}_onHighlightIdsChange(e){const{highlightEnabled:i}=this,{added:n,removed:r}=e;i&&(n.forEach(s=>this._highlight(s)),r.forEach(s=>this._unhighlight(s)))}_resetColumns(){this.columns.items.forEach(e=>e.destroy()),this.columns.removeAll()}};h([p()],Gt.prototype,"_defaultHiddenFields",null),h([p({readOnly:!0})],Gt.prototype,"activeFilters",void 0),h([p({readOnly:!0})],Gt.prototype,"activeSortOrders",null),h([p()],Gt.prototype,"attachmentsEnabled",null),h([p()],Gt.prototype,"autoRefreshEnabled",void 0),h([p()],Gt.prototype,"cellClassNameGenerator",void 0),h([p({readOnly:!0})],Gt.prototype,"columns",void 0),h([p()],Gt.prototype,"dataProvider",void 0),h([p()],Gt.prototype,"editingEnabled",void 0),h([p()],Gt.prototype,"fieldConfigs",void 0),h([p()],Gt.prototype,"filterGeometry",null),h([p({readOnly:!0})],Gt.prototype,"grid",void 0),h([p()],Gt.prototype,"hiddenFields",null),h([p()],Gt.prototype,"highlightEnabled",void 0),h([p()],Gt.prototype,"highlightOnRowSelectEnabled",null),h([p({readOnly:!0})],Gt.prototype,"itemIdPath",void 0),h([p()],Gt.prototype,"layer",null),h([p()],Gt.prototype,"layerView",null),h([p()],Gt.prototype,"messages",null),h([p(),Zt("esri/t9n/common")],Gt.prototype,"messagesCommon",void 0),h([p(),Zt("esri/widgets/support/t9n/uriUtils")],Gt.prototype,"messagesURIUtils",void 0),h([p()],Gt.prototype,"relatedRecordsEnabled",void 0),h([p()],Gt.prototype,"returnGeometryEnabled",void 0),h([p({readOnly:!0})],Gt.prototype,"state",null),h([p({readOnly:!0,type:hhe})],Gt.prototype,"store",void 0),h([p()],Gt.prototype,"tableTemplate",void 0),h([p()],Gt.prototype,"timeExtent",null),h([p()],Gt.prototype,"view",void 0),h([p()],Gt.prototype,"highlightIds",null),Gt=h([P("esri.widgets.FeatureTable.FeatureTableViewModel")],Gt);const W7e=Gt,J7e={heading:"esri-widget__heading"};function o2({level:t,class:e,...i},n){const r=dhe(t);return O(`h${r}`,{...i,class:u_(J7e.heading,e),role:"heading","aria-level":String(r)},n)}function dhe(t){return rr(Math.ceil(t),1,6)}function Z7e(t,e=1){return dhe(t+e)}const MJ={header:!0,menu:!0,menuItems:{clearSelection:!0,refreshData:!0,toggleColumns:!0,selectedRecordsShowAllToggle:!0,selectedRecordsShowSelectedToggle:!0,zoomToSelection:!0,deleteSelection:!0},selectionColumn:!0,columnMenus:!0},Ap="esri-feature-table",B0=`${Ap}__prompt`,lr={base:Ap,header:`${Ap}__header`,title:`${Ap}__title`,content:`${Ap}__content`,loader:`${Ap}__loader`,loaderContainer:`${Ap}__loader-container`,menuContainer:`${Ap}__menu`,menuIcon:"esri-icon-handle-horizontal",menuItemGroupOpenedIcon:"esri-icon-down",menuItemGroupClosedIcon:"esri-icon-right",checkmarkIcon:"esri-icon-check-mark",promptContainer:B0,promptHeader:`${B0}__header`,promptHeading:`${B0}__header__heading`,promptMessage:`${B0}__message`,promptDivider:`${B0}__divider`,promptActions:`${B0}__actions`,widget:"esri-widget"},EJ=ne.getLogger("esri.widgets.FeatureTable");let At=class extends kc(qi){constructor(e,i){super(e,i),this._prompt=null,this.menu=null,this.menuConfig=null,this.viewModel=new W7e,this.visibleElements={...MJ},this._showDeletePrompt=this._showDeletePrompt.bind(this),this._onDeleteSelectionClick=this._onDeleteSelectionClick.bind(this)}initialize(){var n,r,s;this.handles.add([on(()=>this.viewModel.columns,"change",()=>this._syncMenuConfig()),on(()=>this.viewModel.activeFilters,"change",()=>this._syncMenuConfig()),on(()=>this.highlightIds,"change",o=>{this._syncMenuConfig(),this._onSelectionChange(o)}),Q(()=>[this.viewModel.store.querying,this.viewModel.store.syncing,this.editingEnabled],()=>this.scheduleRender()),Q(()=>[this.menuConfig,this.editingEnabled],()=>this._syncMenuConfig()),Q(()=>this.messages,()=>{var o;this.menu&&(this.menu.label=(o=this.messages)==null?void 0:o.options),this._syncMenuConfig()})]),this._set("menu",new Lce({label:(n=this.messages)==null?void 0:n.options,iconClass:lr.menuIcon,...this.menuConfig}));const{attachmentsEnabled:e,relatedRecordsEnabled:i}=this;(s=(r=this.viewModel)==null?void 0:r.store)==null||s.set({attachmentsEnabled:e,relatedRecordsEnabled:i})}loadDependencies(){return NP({button:()=>Y(()=>import("./calcite-button-5becc4fa.js"),["./calcite-button-5becc4fa.js","./label2-0f0371a3.js","./interactive-3cbb41b8.js","./browser-14ab28bd.js","./loadable-800481cb.js","./t9n-9eda9136.js","./observers-9352e65c.js","./icon-26983b54.js","./loader-9ff8d54d.js","./guid-40d04074.js"],import.meta.url),icon:()=>Y(()=>import("./calcite-icon-83ed4825.js"),["./calcite-icon-83ed4825.js","./icon-26983b54.js","./observers-9352e65c.js"],import.meta.url),scrim:()=>Y(()=>import("./calcite-scrim-223224cc.js"),["./calcite-scrim-223224cc.js","./scrim-33d83c8e.js","./t9n-9eda9136.js","./observers-9352e65c.js","./loader-9ff8d54d.js","./guid-40d04074.js"],import.meta.url)})}destroy(){var e;this._prompt=null,this.handles.removeAll(),(e=this.menu)==null||e.destroy()}get activeFilters(){return this.viewModel.activeFilters}get activeSortOrders(){return this.viewModel.activeSortOrders}get attachmentsEnabled(){return this.viewModel.attachmentsEnabled}set attachmentsEnabled(e){this.viewModel.attachmentsEnabled=e}get autoRefreshEnabled(){return this.viewModel.autoRefreshEnabled}set autoRefreshEnabled(e){this.viewModel.autoRefreshEnabled=e}get columnReorderingEnabled(){return this.viewModel.columnReorderingEnabled}set columnReorderingEnabled(e){this.viewModel.columnReorderingEnabled=e}get columns(){return this.viewModel.columns}get editingEnabled(){return this.viewModel.editingEnabled}set editingEnabled(e){this.viewModel.editingEnabled=e}get fieldConfigs(){return this.viewModel.fieldConfigs??[]}set fieldConfigs(e){this.viewModel.fieldConfigs=e}get filterGeometry(){return this.viewModel.filterGeometry}set filterGeometry(e){this.viewModel.filterGeometry=e}get grid(){return this.viewModel.grid}get hiddenFields(){return this.viewModel.hiddenFields}set hiddenFields(e){this.viewModel.hiddenFields=e}get highlightEnabled(){return this.viewModel.highlightEnabled}set highlightEnabled(e){this.viewModel.highlightEnabled=e}get highlightIds(){return this.viewModel.highlightIds}set highlightIds(e){this.viewModel.highlightIds=e}get highlightOnRowSelectEnabled(){return this.viewModel.highlightEnabled}set highlightOnRowSelectEnabled(e){this.viewModel.highlightEnabled=e}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get layer(){return this.viewModel.layer}set layer(e){this.viewModel.layer=e}get messages(){return this.viewModel.messages}set messages(e){this.viewModel.messages=e}get messagesCommon(){return this.viewModel.messagesCommon}set messagesCommon(e){this.viewModel.messagesCommon=e}get messagesURIUtils(){return this.viewModel.messagesURIUtils}set messagesURIUtils(e){this.viewModel.messagesURIUtils=e}get multiSortEnabled(){return this.viewModel.multiSortEnabled}set multiSortEnabled(e){this.viewModel.multiSortEnabled=e}get pageSize(){return this.viewModel.pageSize}set pageSize(e){this.viewModel.pageSize=e}get relatedRecordsEnabled(){return this.viewModel.relatedRecordsEnabled}set relatedRecordsEnabled(e){this.viewModel.relatedRecordsEnabled=e}get state(){return this.viewModel.state}get tableTemplate(){return this.viewModel.tableTemplate}set tableTemplate(e){this.viewModel.tableTemplate=e}get timeExtent(){return this.viewModel.timeExtent}set timeExtent(e){this.viewModel.timeExtent=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}castVisibleElements(e){var n;const i={...MJ,...e};return(n=this.grid)==null||n.set("visibleElements",{...this.grid.visibleElements,selectionColumn:i.selectionColumn,columnMenus:i.columnMenus}),i}clearHighlights(){return a9(EJ,"`FeatureTable.clearHighlights` is deprecated in favor of FeatureTable.highlightIds'",{replacement:"FeatureTable.highlightIds",version:"4.25",see:"https://developers.arcgis.com/javascript/latest/api-reference/esri-widgets-FeatureTable.html#highlightIds"}),this.viewModel.clearHighlights()}clearSelection(){return a9(EJ,"`FeatureTable.clearSelection` is deprecated in favor of FeatureTable.highlightIds'",{replacement:"FeatureTable.highlightIds",version:"4.25",see:"https://developers.arcgis.com/javascript/latest/api-reference/esri-widgets-FeatureTable.html#highlightIds"}),this.viewModel.clearSelection()}clearSelectionFilter(){return this.viewModel.clearSelectionFilter()}deleteSelection(e){return this.highlightIds.length?e?(this._showDeletePrompt(),this.scheduleRender(),Promise.resolve()):this.viewModel.deleteSelection():Promise.resolve()}deselectRows(e){return this.viewModel.deselectRows(e)}filterBySelection(){return this.viewModel.filterBySelection()}findColumn(e){return this.viewModel.findColumn(e)}hideColumn(e){var i;(i=this.grid)==null||i.hideColumn(e),this._syncMenuConfig()}refresh(){return this.viewModel.refresh()}get returnGeometryEnabled(){return this.viewModel.returnGeometryEnabled}set returnGeometryEnabled(e){this.viewModel.returnGeometryEnabled=e}showAllColumns(){return this.viewModel.showAllColumns()}showColumn(e){var i;(i=this.grid)==null||i.showColumn(e),this._syncMenuConfig()}sortColumn(e,i){return this.viewModel.sortColumn(e,i)}selectRows(e){return this.viewModel.selectRows(e)}scrollToIndex(e){return this.viewModel.scrollToIndex(e)}zoomToSelection(){return this.viewModel.zoomToSelection()}render(){var n;const{_prompt:e}=this,i=e!=null?O("calcite-scrim",null,this.renderPrompt(e)):null;return O("div",{bind:this,class:this.classes(lr.base,lr.widget)},this.visibleElements.header?this._renderHeader():null,O("div",{class:lr.content},this.state!=="disabled"&&((n=this.grid)==null?void 0:n.render())),i)}renderPrompt({title:e,message:i,context:n,actions:r}){const s=O("calcite-button",{appearance:"solid",kind:n==="danger"?"danger":"brand",width:r.secondary?"half":"full",onclick:r.primary.action,key:"prompt-primary-button"},r.primary.label),o=r.secondary?O("calcite-button",{appearance:"outline",kind:n==="danger"?"danger":"brand",width:"half",onclick:r.secondary.action,key:"prompt-secondary-button"},r.secondary.label):null;return O("div",{class:`${lr.promptContainer}--${n}`},O("div",{class:lr.promptHeader},O("calcite-icon",{icon:"exclamation-mark-triangle"}),O(o2,{class:lr.promptHeading,level:2},e)),O("div",{class:lr.promptMessage},i),O("div",{class:lr.promptDivider}),O("div",{class:lr.promptActions},o,s))}_renderHeader(){return O("div",{key:"header",class:lr.header},this._renderLoader(),this._renderTitle(),this.visibleElements.menu?this._renderMenu():null)}_renderTitle(){return O("div",{class:lr.title,key:"title"},this._getTitle())}_getTitle(){const{grid:e,highlightIds:i,layer:n,messages:r,viewModel:{size:s}}=this;return e&&n?Ru(r.header,{title:n.title,count:s,selected:i.length||0}):""}_renderLoader(){const{state:e,store:i}=this.viewModel,n=e==="loading"||i.syncing||i.querying;return O("div",{class:lr.loaderContainer},n?O("div",{class:lr.loader,key:"loader"}):null)}_renderMenu(){var e;return O("div",{class:lr.menuContainer},(e=this.menu)==null?void 0:e.render())}_onSelectionChange(e){const{added:i,removed:n}=e,r=i.map(o=>this.viewModel.store.getLocalItemByKey(o)||{objectId:o,feature:null,attachments:null,relatedRecords:null}),s=n.map(o=>this.viewModel.store.getLocalItemByKey(o)||{objectId:o,feature:null,attachments:null,relatedRecords:null});this.emit("selection-change",{added:r,removed:s})}_syncMenuConfig(){var e;(e=this.menu)==null||e.set({...this.menuConfig,items:this._getMenuItems()})}_getMenuItems(){var r;const e=(r=this.menuConfig)==null?void 0:r.items,i=this._getDefaultMenuItems(),n=[];return i!=null&&i.length&&n.push(...i),e!=null&&e.length&&n.push(...e),n}_getDefaultMenuItems(){var a,l,c,u;const{highlightIds:e,messages:i,viewModel:n,visibleElements:r}=this,{menuItems:s}=r,o=[];if(s!=null&&s.refreshData&&o.push(new lu({selectionEnabled:!1,label:i==null?void 0:i.refreshData,clickFunction:()=>this.refresh()})),e.length){const d=this._getSelectionFilter();if(s!=null&&s.clearSelection&&o.push(new lu({selectionEnabled:!1,label:i==null?void 0:i.clearSelection,clickFunction:()=>{var f;return(f=this.highlightIds)==null?void 0:f.removeAll()}})),s!=null&&s.zoomToSelection&&this.view&&o.push(new lu({selectionEnabled:!1,label:i==null?void 0:i.zoomToSelection,clickFunction:()=>this.viewModel.zoomToSelection()})),(s==null?void 0:s.selectedRecordsShowSelectedToggle)&&(!d||e.length!==d.objectIds.length)){const f=i.showSelected,m=new lu({selectionEnabled:!1,label:f,clickFunction:()=>{this.filterBySelection(),m.set("label",f)}});o.push(m)}s!=null&&s.deleteSelection&&this.editingEnabled&&((c=(l=(a=this.layer)==null?void 0:a.capabilities)==null?void 0:l.operations)!=null&&c.supportsDelete)&&o.push(new lu({selectionEnabled:!1,label:i.deleteSelection,clickFunction:this._showDeletePrompt}))}if(s!=null&&s.selectedRecordsShowAllToggle&&this._hasSelectionFilter()){const d=i.showAllRecords,f=new lu({selectionEnabled:!1,label:d,clickFunction:()=>{this.clearSelectionFilter(),f.set("label",d)}});o.push(f)}return s!=null&&s.toggleColumns&&o.push(new lu({iconClass:lr.menuItemGroupClosedIcon,label:i==null?void 0:i.toggleColumns,clickFunction:this._toggleMenuItemSelectedIcon,items:(u=n==null?void 0:n.columns)==null?void 0:u.items.map(({header:d,hidden:f,path:m})=>new lu({label:d||m,selected:!f,selectionEnabled:!0,iconClass:lr.checkmarkIcon,clickFunction:()=>this._toggleColumnFromMenuItem(m)}))})),o.length?o:null}_toggleMenuItemSelectedIcon({item:e}){e==null||e.set("iconClass",e!=null&&e.selected?lr.menuItemGroupOpenedIcon:lr.menuItemGroupClosedIcon)}_toggleColumnFromMenuItem(e){const{grid:i,viewModel:n}=this,r=n.findColumn(e);r!=null&&r.hidden?i==null||i.showColumn(e):i==null||i.hideColumn(e)}_showDeletePrompt(){const{messages:e,messagesCommon:i}=this,n=this.highlightIds.length||0,r=Ru(e.deleteSelectionCount,{count:n});this.menu&&(this.menu.open=!1),this._prompt={title:r,message:e.deleteRecordsRemoved,context:"danger",actions:{primary:{label:i.delete,action:this._onDeleteSelectionClick},secondary:{label:e.keepRecords,action:()=>this._prompt=null}}}}async _onDeleteSelectionClick(){await this.viewModel.deleteSelection(),this._prompt=null}_getSelectionFilter(){var e;return(e=this.viewModel.activeFilters)==null?void 0:e.find(i=>i.type==="selection")}_hasSelectionFilter(){return!!this._getSelectionFilter()}};h([p({readOnly:!0})],At.prototype,"activeFilters",null),h([p({readOnly:!0})],At.prototype,"activeSortOrders",null),h([p()],At.prototype,"attachmentsEnabled",null),h([p()],At.prototype,"autoRefreshEnabled",null),h([p()],At.prototype,"columnReorderingEnabled",null),h([p({readOnly:!0})],At.prototype,"columns",null),h([p()],At.prototype,"editingEnabled",null),h([p()],At.prototype,"fieldConfigs",null),h([p()],At.prototype,"filterGeometry",null),h([p({readOnly:!0})],At.prototype,"grid",null),h([p()],At.prototype,"hiddenFields",null),h([p()],At.prototype,"highlightEnabled",null),h([p()],At.prototype,"highlightIds",null),h([p()],At.prototype,"highlightOnRowSelectEnabled",null),h([p()],At.prototype,"label",null),h([p()],At.prototype,"layer",null),h([p(),Zt("esri/widgets/FeatureTable/t9n/FeatureTable")],At.prototype,"messages",null),h([p(),Zt("esri/t9n/common")],At.prototype,"messagesCommon",null),h([p(),Zt("esri/widgets/support/t9n/uriUtils")],At.prototype,"messagesURIUtils",null),h([p({readOnly:!0})],At.prototype,"menu",void 0),h([p()],At.prototype,"menuConfig",void 0),h([p()],At.prototype,"multiSortEnabled",null),h([p()],At.prototype,"pageSize",null),h([p()],At.prototype,"relatedRecordsEnabled",null),h([p({readOnly:!0})],At.prototype,"state",null),h([p()],At.prototype,"tableTemplate",null),h([p()],At.prototype,"timeExtent",null),h([p()],At.prototype,"view",null),h([p()],At.prototype,"viewModel",void 0),h([p()],At.prototype,"visibleElements",void 0),h([ut("visibleElements")],At.prototype,"castVisibleElements",null),h([p()],At.prototype,"returnGeometryEnabled",null),At=h([P("esri.widgets.FeatureTable")],At);const Y7e=At;var AF;let Ag=AF=class extends ie{constructor(t){super(t),this.expression=null,this.name=null,this.returnType="boolean",this.title=null}clone(){return new AF({name:this.name,title:this.title,expression:this.expression,returnType:this.returnType})}};h([p({type:String,json:{write:!0}})],Ag.prototype,"expression",void 0),h([p({type:String,json:{write:!0}})],Ag.prototype,"name",void 0),h([p({type:["boolean","date","number","string"],json:{write:!0}})],Ag.prototype,"returnType",void 0),h([p({type:String,json:{write:!0}})],Ag.prototype,"title",void 0),Ag=AF=h([P("esri.form.ExpressionInfo")],Ag);const X7e=Ag;var $F;let fx=$F=class extends ie{constructor(t){super(t),this.columnTemplates=[],this.expressionInfos=null}clone(){return new $F({columnTemplates:q(this.columnTemplates),expressionInfos:q(this.expressionInfos)})}};h([p()],fx.prototype,"columnTemplates",void 0),h([p({type:[X7e],json:{write:!0}})],fx.prototype,"expressionInfos",void 0),fx=$F=h([P("esri.widgets.FeatureTable.support.TableTemplate")],fx);const K7e=fx;let $p=class extends ye{constructor(e){super(e),this._viewpointHandle=null,this.group=null}initialize(){this.addHandles(on(()=>{var e;return(e=this.view)==null?void 0:e.ui},"expand",e=>{const{target:i}=e;i&&i!==this&&i.expanded&&i.group&&i.group===this.group&&this._collapse()}))}destroy(){this.removeAllHandles(),this._viewpointHandle=null,this.view=null}set autoCollapse(e){this._set("autoCollapse",e),this._watchViewpoint()}set expanded(e){const i=!!e;this._set("expanded",i);const n=this.get("view.ui");n&&n.emit("expand",{target:this}),this._viewpointHandleChange(i)}get state(){return this.get("view.ready")?"ready":"disabled"}set view(e){this._get("view")!==e&&(this._set("view",e),e&&jo(()=>e.ready,()=>{this.view===e&&this._watchViewpoint()},{once:!0,initial:!0}))}_viewpointHandleChange(e){this._viewpointHandle&&(e?jo(()=>{var i;return(i=this.view)==null?void 0:i.stationary},()=>{var i;return(i=this._viewpointHandle)==null?void 0:i.resume()},{once:!0,initial:!0}):this._viewpointHandle.pause())}_watchViewpoint(){const e="viewpoint";this.removeHandles(e),this._viewpointHandle=null;const{autoCollapse:i,view:n}=this;if(!n||!i)return;const r=lne(()=>n.type==="3d"?n.camera:n.viewpoint,()=>this._collapse());this.addHandles(r,e),this._viewpointHandle=r}_collapse(){this.expanded=!1}};h([p({value:!1})],$p.prototype,"autoCollapse",null),h([p({value:!1})],$p.prototype,"expanded",null),h([p()],$p.prototype,"group",void 0),h([p({readOnly:!0})],$p.prototype,"state",null),h([p({value:null})],$p.prototype,"view",null),$p=h([P("esri.widgets.Expand.ExpandViewModel")],$p);const phe=$p;function fhe(t){return e=>{e.hasOwnProperty("_delegatedEventNames")||(e._delegatedEventNames=e._delegatedEventNames?e._delegatedEventNames.slice():[]);const i=e._delegatedEventNames,n=Array.isArray(t)?t:Q7e(t);i.push(...n)}}function Q7e(t){return t.split(",").map(e=>e.trim())}function a2(t){return t&&typeof t.render=="function"}function eGe(t){return t&&typeof t.postMixInProperties=="function"&&typeof t.buildRendering=="function"&&typeof t.postCreate=="function"&&typeof t.startup=="function"}const po="esri-expand",Vn={base:`${po} esri-widget`,modeAuto:`${po}--auto`,modeDrawer:`${po}--drawer`,modeFloating:`${po}--floating`,container:`${po}__container`,containerExpanded:`${po}__container--expanded`,panel:`${po}__panel`,button:"esri-widget--button",text:"esri-icon-font-fallback-text",icon:"esri-collapse__icon",iconExpanded:`${po}__icon--expanded`,iconNumber:`${po}__icon-number`,iconNumberExpanded:`${po}__icon-number--expanded`,expandIcon:"esri-icon-expand",collapseIcon:"esri-icon-collapse",content:`${po}__content`,contentExpanded:`${po}__content--expanded`,expandMask:`${po}__mask`,expandMaskExpanded:`${po}__mask--expanded`};let Ai=class extends qi{constructor(e,i){super(e,i),this.closeOnEsc=!0,this.collapseIcon=null,this.collapseTooltip="",this.content="",this.expandTooltip="",this.iconClass=null,this.icon=null,this.iconNumber=0,this.messages=null,this.messagesCommon=null,this.mode="auto",this.viewModel=new phe,this._handleKeyDown=n=>{const{closeOnEsc:r,_toggleButtonEl:s,expanded:o}=this;!o||!r||n.target===s||n.key!=="Escape"||(typeof r=="function"?r(n):r)&&(this.expanded=!1,s==null||s.focus())}}loadDependencies(){return NP({icon:()=>Y(()=>import("./calcite-icon-83ed4825.js"),["./calcite-icon-83ed4825.js","./icon-26983b54.js","./observers-9352e65c.js"],import.meta.url)})}get contentId(){return`${this.id}_controls_content`}get expandTitle(){const{expanded:e,messagesCommon:i,collapseTooltip:n,expandTooltip:r}=this;return(e?n||(i==null?void 0:i.collapse):r||(i==null?void 0:i.expand))??""}get autoCollapse(){return this.viewModel.autoCollapse}set autoCollapse(e){this.viewModel.autoCollapse=e}get collapseIconClass(){return Vn.collapseIcon}set collapseIconClass(e){this._overrideIfSome("collapseIconClass",e)}get expanded(){return this.viewModel.expanded}set expanded(e){this.viewModel.expanded=e}get expandIconClass(){return a2(this.content)?this.content.iconClass:Vn.expandIcon}set expandIconClass(e){this._overrideIfSome("expandIconClass",e)}get expandIcon(){return a2(this.content)?this.content.icon:void 0}set expandIcon(e){this._overrideIfSome("expandIcon",e)}get group(){return this.viewModel.group}set group(e){this.viewModel.group=e}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}expand(){this.viewModel.expanded=!0}collapse(){this.viewModel.expanded=!1}toggle(){this.viewModel.expanded=!this.viewModel.expanded}render(){const{mode:e}=this,i={[Vn.modeAuto]:e==="auto",[Vn.modeDrawer]:e==="drawer",[Vn.modeFloating]:e==="floating"};return O("div",{class:this.classes(Vn.base,i),onkeydown:this._handleKeyDown},this._renderMask(),this._renderContainer())}_renderContainer(){const{expanded:e}=this,i={[Vn.containerExpanded]:e};return O("div",{class:this.classes(Vn.container,i)},this._renderPanel(),this._renderContent())}_renderMask(){const{expanded:e}=this,i={[Vn.expandMaskExpanded]:e};return O("div",{bind:this,onclick:this._toggle,class:this.classes(Vn.expandMask,i)})}_renderBadgeNumber(){const{expanded:e,iconNumber:i}=this;return i&&!e?O("span",{key:"expand__icon-number",class:Vn.iconNumber},i):null}_renderPanelNumber(){const{iconNumber:e,expanded:i}=this;return e&&i?O("span",{key:"expand__expand-icon-number",class:this.classes(Vn.iconNumber,Vn.iconNumberExpanded)},e):null}_renderIcon(){const e=(this.expanded?this.collapseIcon:this.expandIcon)??"";return O("calcite-icon",{key:"icon",icon:e,scale:"s"})}_renderLegacyIcon(){const{collapseIconClass:e,expandIconClass:i,expanded:n}=this,r={[Vn.iconExpanded]:n};return i!=null&&(r[i]=!n),e!=null&&(r[e]=e===i||n),O("span",{key:"legacy-icon","aria-hidden":"true",class:this.classes(Vn.icon,r)})}_renderTitle(){return O("span",{class:Vn.text},this.expandTitle)}_renderExpandButton(){const{expanded:e,expandTitle:i,expandIcon:n,collapseIcon:r,contentId:s}=this;return O("div",{afterCreate:this._storeToggleButtonEl,"aria-controls":s,"aria-expanded":e?"true":"false",bind:this,class:Vn.button,onclick:this._toggle,onkeydown:this._toggle,role:"button",tabindex:"0",title:i},this._renderBadgeNumber(),!e&&n!=null||e&&r!=null?this._renderIcon():this._renderLegacyIcon(),this._renderTitle())}_renderPanel(){return O("div",{class:Vn.panel},this._renderExpandButton(),this._renderPanelNumber())}_renderContent(){const{expanded:e,contentId:i,content:n}=this,r={[Vn.contentExpanded]:e},s={id:i,role:"region",class:this.classes(Vn.content,r)};return typeof n=="string"?O("div",{key:"content__string",innerHTML:n,...s}):a2(n)?O("div",{key:"content__widget",...s},n.render()):n instanceof HTMLElement?O("div",{key:"content__html-element",bind:n,afterCreate:this._attachToNode,...s}):eGe(n)?O("div",{key:"content__node",bind:n.domNode,afterCreate:this._attachToNode,...s}):null}_toggle(){this.toggle()}_attachToNode(e){const i=this;e.appendChild(i)}_storeToggleButtonEl(e){this._toggleButtonEl=e}};h([p({readOnly:!0})],Ai.prototype,"contentId",null),h([p({readOnly:!0})],Ai.prototype,"expandTitle",null),h([p()],Ai.prototype,"autoCollapse",null),h([p()],Ai.prototype,"closeOnEsc",void 0),h([p()],Ai.prototype,"collapseIconClass",null),h([p()],Ai.prototype,"collapseIcon",void 0),h([p()],Ai.prototype,"collapseTooltip",void 0),h([p()],Ai.prototype,"content",void 0),h([p()],Ai.prototype,"expanded",null),h([p()],Ai.prototype,"expandIconClass",null),h([p()],Ai.prototype,"expandIcon",null),h([p()],Ai.prototype,"expandTooltip",void 0),h([p()],Ai.prototype,"group",null),h([p()],Ai.prototype,"iconClass",void 0),h([p()],Ai.prototype,"icon",void 0),h([p()],Ai.prototype,"iconNumber",void 0),h([p()],Ai.prototype,"label",null),h([p(),Zt("esri/widgets/Expand/t9n/Expand")],Ai.prototype,"messages",void 0),h([p(),Zt("esri/t9n/common")],Ai.prototype,"messagesCommon",void 0),h([p()],Ai.prototype,"mode",void 0),h([p()],Ai.prototype,"view",null),h([p({type:phe})],Ai.prototype,"viewModel",void 0),h([Dr()],Ai.prototype,"_toggle",null),Ai=h([P("esri.widgets.Expand")],Ai);const tGe=Ai,gS=-1;let su=class extends ye{constructor(e){super(e),this._from=null,this._to=null,this._final=null,this._current=[],this._time=0,this.duration=ee("mapview-transitions-duration"),this.effects=[]}set effect(e){if(this._get("effect")!==(e=e||"")){this._set("effect",e);try{this._transitionTo(AJ(e))}catch(i){this._transitionTo([]),ne.getLogger(this).warn("Invalid Effect",{effect:e,error:i})}}}get hasEffects(){return this.transitioning||!!this.effects.length}set scale(e){this._updateForScale(e)}get transitioning(){return this._to!==null}canTransitionTo(e){try{return this.scale>0&&$J(this._current,AJ(e),this.scale)}catch{return!1}}transitionStep(e,i){this._applyTimeTransition(e),this._updateForScale(i)}endTransitions(){this._applyTimeTransition(this.duration)}_transitionTo(e){this.scale>0&&$J(this._current,e,this.scale)?(this._final=e,this._to=q(e),iGe(this._current,this._to,this.scale),this._from=q(this._current),this._time=0):(this._from=this._to=this._final=null,this._current=e),this._set("effects",this._current[0]?q(this._current[0].effects):[])}_applyTimeTransition(e){if(!(this._to&&this._from&&this._current&&this._final))return;this._time+=e;const i=Math.min(1,this._time/this.duration);for(let n=0;n<this._current.length;n++){const r=this._current[n],s=this._from[n],o=this._to[n];r.scale=nGe(s.scale,o.scale,i);for(let a=0;a<r.effects.length;a++){const l=r.effects[a],c=s.effects[a],u=o.effects[a];l.interpolate(c,u,i)}}i===1&&(this._current=this._final,this._set("effects",this._current[0]?q(this._current[0].effects):[]),this._from=this._to=this._final=null)}_updateForScale(e){if(this._set("scale",e),this._current.length===0)return;const i=this._current,n=this._current.length-1;let r,s,o=1;if(i.length===1||e>=i[0].scale)s=r=i[0].effects;else if(e<=i[n].scale)s=r=i[n].effects;else for(let a=0;a<n;a++){const l=i[a],c=i[a+1];if(l.scale>=e&&c.scale<=e){o=(e-l.scale)/(c.scale-l.scale),r=l.effects,s=c.effects;break}}for(let a=0;a<this.effects.length;a++)this.effects[a].interpolate(r[a],s[a],o)}};function AJ(t){const e=nj(t)||[];return rGe(e)?[{scale:gS,effects:e}]:e}function $J(t,e,i){var n,r,s,o;return!((n=t[0])!=null&&n.effects)||!((r=e[0])!=null&&r.effects)?!0:!((((s=t[0])==null?void 0:s.scale)===gS||((o=e[0])==null?void 0:o.scale)===gS)&&(t.length>1||e.length>1)&&i<=0)&&wae(t[0].effects,e[0].effects)}function iGe(t,e,i){const n=t.length>e.length?t:e,r=t.length>e.length?e:t,s=r[r.length-1],o=(s==null?void 0:s.scale)??i,a=(s==null?void 0:s.effects)??[];for(let l=r.length;l<n.length;l++)r.push({scale:o,effects:[...a]});for(let l=0;l<n.length;l++)r[l].scale=r[l].scale===gS?i:r[l].scale,n[l].scale=n[l].scale===gS?i:n[l].scale,xae(r[l].effects,n[l].effects)}function nGe(t,e,i){return t+(e-t)*i}function rGe(t){const e=t[0];return!!e&&"type"in e}h([p()],su.prototype,"_to",void 0),h([p()],su.prototype,"duration",void 0),h([p({value:""})],su.prototype,"effect",null),h([p({readOnly:!0})],su.prototype,"effects",void 0),h([p({readOnly:!0})],su.prototype,"hasEffects",null),h([p({value:0})],su.prototype,"scale",null),h([p({readOnly:!0})],su.prototype,"transitioning",null),su=h([P("esri.layers.effects.EffectView")],su);function Xmt(t){var i;const e=t.layer;return"floorInfo"in e&&((i=e.floorInfo)!=null&&i.floorField)&&"floors"in t.view?mhe(t.view.floors,e.floorInfo.floorField):null}function PJ(t,e){var i;return"floorInfo"in e&&((i=e.floorInfo)!=null&&i.floorField)?mhe(t,e.floorInfo.floorField):null}function mhe(t,e){if(!(t!=null&&t.length))return null;const i=t.filter(n=>n!=="").map(n=>`'${n}'`);return i.push("''"),`${e} IN (${i.join(",")}) OR ${e} IS NULL`}function Kmt(t,e,i){return e.flatten(({sublayers:r})=>r).length!==t.length?!0:!!t.some(r=>r.originIdOf("minScale")>i||r.originIdOf("maxScale")>i||r.originIdOf("renderer")>i||r.originIdOf("labelingInfo")>i||r.originIdOf("opacity")>i||r.originIdOf("labelsVisible")>i||r.originIdOf("source")>i)||!ghe(t,e)}function sGe(t,e,i){return!!t.some(n=>{const r=n.source;return!(!r||r.type==="map-layer"&&r.mapLayerId===n.id&&(r.gdbVersion==null||r.gdbVersion===i))||n.originIdOf("renderer")>Ge.SERVICE||n.originIdOf("labelingInfo")>Ge.SERVICE||n.originIdOf("opacity")>Ge.SERVICE||n.originIdOf("labelsVisible")>Ge.SERVICE})||!ghe(t,e)}function ghe(t,e){if(!t||!t.length||e==null)return!0;const i=e.slice().reverse().flatten(({sublayers:s})=>s&&s.toArray().reverse()).map(s=>s.id).toArray();if(t.length>i.length)return!1;let n=0;const r=i.length;for(const{id:s}of t){for(;n<r&&i[n]!==s;)n++;if(n>=r)return!1}return!0}function Qmt(t){return!!t&&t.some(e=>e.minScale!=null||e.layerDefinition&&e.layerDefinition.minScale!=null)}const oGe={visible:"visibleSublayers",definitionExpression:"layerDefs",labelingInfo:"hasDynamicLayers",labelsVisible:"hasDynamicLayers",opacity:"hasDynamicLayers",minScale:"visibleSublayers",maxScale:"visibleSublayers",renderer:"hasDynamicLayers",source:"hasDynamicLayers"};let ea=class extends kc(ye){constructor(e){super(e),this.floors=null,this.scale=0}destroy(){this.layer=null}get dynamicLayers(){if(!this.hasDynamicLayers)return null;const e=this.visibleSublayers.map(i=>{const n=PJ(this.floors,i);return i.toExportImageJSON(n)});return e.length?JSON.stringify(e):null}get hasDynamicLayers(){return this.layer&&sGe(this.visibleSublayers,this.layer.serviceSublayers,this.layer.gdbVersion)}set layer(e){this._get("layer")!==e&&(this._set("layer",e),this.handles.remove("layer"),e&&this.handles.add([e.allSublayers.on("change",()=>this.notifyChange("visibleSublayers")),e.on("sublayer-update",i=>this.notifyChange(oGe[i.propertyName]))],"layer"))}get layers(){const e=this.visibleSublayers;return e?e.length?"show:"+e.map(i=>i.id).join(","):"show:-1":null}get layerDefs(){var n;const e=!!((n=this.floors)!=null&&n.length),i=this.visibleSublayers.filter(r=>r.definitionExpression!=null||e&&r.floorInfo!=null);return i.length?JSON.stringify(i.reduce((r,s)=>{const o=PJ(this.floors,s),a=JRe(o,s.definitionExpression);return a!=null&&(r[s.id]=a),r},{})):null}get version(){this.commitProperty("layers"),this.commitProperty("layerDefs"),this.commitProperty("dynamicLayers"),this.commitProperty("timeExtent");const e=this.layer;return e&&(e.commitProperty("dpi"),e.commitProperty("imageFormat"),e.commitProperty("imageTransparency"),e.commitProperty("gdbVersion")),(this._get("version")||0)+1}get visibleSublayers(){const e=[];if(!this.layer)return e;const i=this.layer.sublayers,n=s=>{const o=this.scale,a=o===0,l=s.minScale===0||o<=s.minScale,c=s.maxScale===0||o>=s.maxScale;s.visible&&(a||l&&c)&&(s.sublayers?s.sublayers.forEach(n):e.unshift(s))};i&&i.forEach(n);const r=this._get("visibleSublayers");return!r||r.length!==e.length||r.some((s,o)=>e[o]!==s)?e:r}toJSON(){const e=this.layer;let i={dpi:e.dpi,format:e.imageFormat,transparent:e.imageTransparency,gdbVersion:e.gdbVersion||null};return this.hasDynamicLayers&&this.dynamicLayers?i.dynamicLayers=this.dynamicLayers:i={...i,layers:this.layers,layerDefs:this.layerDefs},i}};h([p({readOnly:!0})],ea.prototype,"dynamicLayers",null),h([p()],ea.prototype,"floors",void 0),h([p({readOnly:!0})],ea.prototype,"hasDynamicLayers",null),h([p()],ea.prototype,"layer",null),h([p({readOnly:!0})],ea.prototype,"layers",null),h([p({readOnly:!0})],ea.prototype,"layerDefs",null),h([p({type:Number})],ea.prototype,"scale",void 0),h([p(GRe)],ea.prototype,"timeExtent",void 0),h([p({readOnly:!0})],ea.prototype,"version",null),h([p({readOnly:!0})],ea.prototype,"visibleSublayers",null),ea=h([P("esri.layers.mixins.ExportImageParameters")],ea);function yhe(t){return t==null||t.type==="simple"||t.type==="unique-value"||t.type==="class-breaks"||t.type==="dictionary"||t.type==="heatmap"}function tgt(t,e){if(t==null)return null;if(!yhe(t))return new V("renderer-conversion-3d:unsupported-renderer",`Unsupported renderer of type '${t.type||t.declaredClass}'`,{renderer:t});switch(t.type){case"simple":return aGe(t);case"unique-value":return lGe(t,e);case"class-breaks":return cGe(t);case"dictionary":case"heatmap":return null}return null}function $8(t,e){if(!e)return null;let i;if(i=Array.isArray(e)?e:[e],i.length>0){const n=i.map(s=>s.details.symbol.type||s.details.symbol.declaredClass).filter(s=>!!s);n.sort();const r=[];return n.forEach((s,o)=>{o!==0&&s===n[o-1]||r.push(s)}),new V("renderer-conversion-3d:unsupported-symbols",`Renderer contains symbols (${r.join(", ")}) which are not supported in 3D`,{renderer:t,symbolErrors:i})}return null}function aGe(t){return $8(t,pb(t.symbol).error)}function lGe(t,e){var s;const i={...Ev,...e},n=(s=t.uniqueValueInfos)==null?void 0:s.map(o=>pb(o.symbol,i).error).filter(Ti),r=pb(t.defaultSymbol,i);return r.error&&(n==null||n.unshift(r.error)),$8(t,n)}function cGe(t){const e=t.classBreakInfos.map(n=>pb(n.symbol).error).filter(Ti),i=pb(t.defaultSymbol);return i.error&&e.unshift(i.error),$8(t,e)}var sr;(function(t){t[t.size=22]="size",t[t.lineWidth=50]="lineWidth",t[t.maxSize=120]="maxSize",t[t.maxOutlineSize=80]="maxOutlineSize",t[t.tallSymbolWidth=20]="tallSymbolWidth"})(sr||(sr={}));const PF={fill:[{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 Z"}],squareFill:[{type:"path",path:"M -10,-10 L 10,-10 L 10,10 L -10,10 L -10,-10 Z"}],pathSymbol3DLayer:[{type:"path",path:"M 3,12 L 12,0 L 11,-2 L -4,5 L -1,5 L 1,7 L 3,10 L 3,12 Z"},{type:"circle",cx:-2,cy:10,r:5}],extrudeSymbol3DLayer:[{type:"path",path:"M -7,-5 L -2,0 L -2,7 L -7,3 L -7,-5 Z"},{type:"path",path:"M -2,0 L -2,7 L 10,-3 L 10,-10 L -2,0 Z"},{type:"path",path:"M -7,-5 L -2,0 L 10,-10 L -2,-10 L -7,-5 Z"}],cone:[{type:"path",path:"M 0,-10 L -8,5 L -4,6.5 L 0,7 L 4,6.5 L 8,5 Z"}],tallCone:[{type:"path",path:"M 0,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 0,-9 Z"}],invertedCone:[{type:"path",path:"M 0,7 L -8,-8 L 8,-8 Z"},{type:"path",path:"M -8,-8 L -4,-9.5 L 0,-10 L 4,-9.5 L 8,-8 L 4,-6.5 L 0,-6 L -4,-6.5 Z"}],cube:[{type:"path",path:"M -10,-7 L 0,-12 L 10,-7 L 0,-2 L -10,-7 Z"},{type:"path",path:"M -10,-7 L 0,-2 L 0,12 L -10,7 L -10,-7 Z"},{type:"path",path:"M 0,-2 L 10,-7 L 10,7 L 0,12 L 0,-2 Z"}],tallCube:[{type:"path",path:"M -3.5,-8.5 L 0,-9.5 L 3.5,-8.5 L 0,-7.5 L -3.5,-8.5 Z"},{type:"path",path:"M -3.5,-8.5 L 0,-7.5 L 0,9 L -3.5,8 L -3.5,-8.5 Z"},{type:"path",path:"M 0,-7.5 L 3.5,-8.5 L 3.5,8 L 0,9 L 0,-7.5 Z"}],cylinder:[{type:"path",path:"M -8,-9 L -8,7 L -4,8.5 L 0,9 L 4,8.5 L 8,7 L 8,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:8,ry:2}],tallCylinder:[{type:"path",path:"M -3.5,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 3.5,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:3.5,ry:1}],diamond:[{type:"path",path:"M 0,-10 L 10,-1 L -1,1 L 0,-10 Z"},{type:"path",path:"M 0,-10 L -1,1 L -8,-1 L 0,-10 Z"},{type:"path",path:"M -1,1 L 0,10 L -8,-1 L -1,1 Z"},{type:"path",path:"M -1,0 L 0,10 L 10,-1 L -1,1 Z"}],tetrahedron:[{type:"path",path:"M 0,-10 L 10,7 L 0,0 L 0,-10 Z"},{type:"path",path:"M 0,-10 L 0,0 L -8,7 L 0,-10 Z"},{type:"path",path:"M 10,7 L 0,0 L -8,7 L 10,7 Z"}]};function uGe(t,e,i){const n=sr.size;let r=n,s=n;t<1?r*=.75:t>1&&(s*=1.25);const o=0,a=0;let l=n,c=n;return e&&i&&(r=s=l=c=0),[{type:"path",path:[{command:"M",values:[l,o]},{command:"L",values:[i?l:.875*l,o]},{command:"L",values:[i?r-.5*l:a,s-.5*c]},{command:"L",values:[r-.5*l,s-.5*c]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[l,o]},{command:"L",values:[l,e?o:.125*c]},{command:"L",values:[r-.5*l,e?s-.5*c:c]},{command:"L",values:[r-.5*l,s-.5*c]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[r-.5*l,s-.5*c]},{command:"L",values:[i?r-.5*l:a,s-.5*c]},{command:"L",values:[i?r-.5*l:a,e?s-.5*c:c]},{command:"L",values:[r-.5*l,e?s-.5*c:c]},{command:"Z",values:[]}]}]}function hGe(t){const e=sr.size,i=.5*t,n=0,r=0;return[{type:"path",path:[{command:"M",values:[r,.7*e*.5]},{command:"L",values:[.3*e,.7*e]},{command:"L",values:[.3*e,.7*e+i]},{command:"L",values:[r,.7*e+i-.7*e*.5]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.3*e,.7*e]},{command:"L",values:[.3*e,.7*e+i]},{command:"L",values:[e,i]},{command:"L",values:[e,n]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.3*e,n]},{command:"L",values:[e,n]},{command:"L",values:[.3*e,.7*e]},{command:"L",values:[r,.7*e*.5]},{command:"Z",values:[]}]}]}function dGe(){return[{type:"path",path:"M80,80.2v-27c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4C8.3,59.3,5.7,58,3.9,56c-1.1-1.2-2.4-2.1-3.9-2.8v27"},{type:"path",path:"M11,59.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8v-24c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-1.1-1.2-2.4-2.1-3.9-2.8v24c1.5,0.7,2.8,1.6,3.9,2.8C5.7,58,8.3,59.3,11,59.4z"},{type:"path",path:"M11,35.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8V3.6c-1.5,0.7-2.8,1.6-3.9,2.8c-2.2,2.1-4.6,3.4-7.1,3.4s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6S42.5,9.9,40,9.9s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.5,0-5-1.3-7.1-3.4C2.8,5.3,1.4,4.3,0,3.6v25.6c1.5,0.7,2.8,1.6,3.9,2.8C5.7,34.1,8.3,35.3,11,35.4z"}]}function pGe(t,e){let i=e?sr.tallSymbolWidth:t;const n=t,r=e?4:6;i<=sr.size?i-=.5*r:i-=r;const s=0,o=0,a=e?.35*i:.5*i;return[{type:"path",path:[{command:"M",values:[.5*i,s]},{command:"L",values:[i,.5*a]},{command:"L",values:[.5*i,a]},{command:"L",values:[o,.5*a]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[s,.5*a]},{command:"L",values:[.5*i,a]},{command:"L",values:[.5*i,n]},{command:"L",values:[o,n-.5*a]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.5*i,a]},{command:"L",values:[.5*i,n]},{command:"L",values:[i,n-.5*a]},{command:"L",values:[i,.5*a]},{command:"Z",values:[]}]}]}function fGe(t,e){let i=e?sr.tallSymbolWidth:t;const n=t,r=e?4:6;i<=sr.size?i-=.5*r:i-=r;const s=.5*i,o=.15*i,a=0,l=n-o;return[{type:"ellipse",cx:.5*i,cy:l,rx:s,ry:o},{type:"path",path:[{command:"M",values:[a,o]},{command:"L",values:[a,l]},{command:"L",values:[i,l]},{command:"L",values:[i,o]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*i,cy:o,rx:s,ry:o}]}function mGe(t,e){let i=e?sr.tallSymbolWidth:t;const n=t,r=e?4:6;i<=sr.size?i-=.5*r:i-=r;const s=.15*i,o=n-s;return[{type:"ellipse",cx:.5*i,cy:o,rx:.5*i,ry:s},{type:"path",path:[{command:"M",values:[.5*i,0]},{command:"L",values:[i,o]},{command:"L",values:[0,o]},{command:"Z",values:[]}]}]}function gGe(t){let e=t;const i=t,n=6;e<sr.size?e-=.5*n:e-=n;const r=.15*e,s=0;return[{type:"path",path:[{command:"M",values:[0,s]},{command:"L",values:[e,s]},{command:"L",values:[.5*e,i-r]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*e,cy:s,rx:.5*e,ry:r}]}function yGe(t){let e=t;const i=t,n=4;e<sr.size?e-=.5*n:e-=n;const r=0,s=0,o=e,a=i,l=Math.floor(t/10)-1||1;return[{type:"path",path:[{command:"M",values:[.45*o,r]},{command:"L",values:[o,.5*a-l]},{command:"L",values:[.45*o-l,.5*a+l]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*o,r]},{command:"L",values:[.45*o-l,.5*a+l]},{command:"L",values:[s,.5*a-l]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[s,.5*a-l]},{command:"L",values:[.45*o-l,.5*a+l]},{command:"L",values:[.45*o,i]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*o,i]},{command:"L",values:[o,.5*a-l]},{command:"L",values:[.45*o-l,.5*a+l]},{command:"Z",values:[]}]}]}function vGe(t){const e=t,i=2;let n=t;n<sr.size?n-=.5*i:n-=i;const r=0,s=0;return[{type:"path",path:[{command:"M",values:[.45*e,r]},{command:"L",values:[e,n]},{command:"L",values:[.45*e,.6*n]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*e,r]},{command:"L",values:[.45*e,.6*n]},{command:"L",values:[s,n]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[s,n]},{command:"L",values:[.45*e,.6*n]},{command:"L",values:[e,n]},{command:"Z",values:[]}]}]}function Pf(t,e){return Math.round(Math.min(Math.max(t+255*e*.75,0),255))}function igt(t,e){if(t==null)return new ae;if("type"in t&&(t.type==="linear"||t.type==="pattern"))return t;const i=new ae(t);return new ae([Pf(i.r,e),Pf(i.g,e),Pf(i.b,e),i.a])}const _Ge="http://www.w3.org/2000/svg";let bGe=0,wGe=0;const kJ=ee("android"),xGe=ee("chrome")||kJ&&kJ>=4?"auto":"optimizeLegibility",SGe={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},TGe=/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g;let nn={},Ht={};const OJ={solid:"none",shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]},IGe=Math.PI;let CGe=1;function g_(t,e){const i=t*(IGe/180);return Math.abs(e*Math.sin(i))+Math.abs(e*Math.cos(i))}function vhe(t){return t.map(e=>`${e.command} ${e.values.join(" ")}`).join(" ").trim()}function P8(t,e,i,n){if(t){if(t.type==="circle")return O("circle",{fill:e,"fill-rule":"evenodd",stroke:i.color,"stroke-width":i.width,"stroke-linecap":i.cap,"stroke-linejoin":i.join,"stroke-dasharray":i.dashArray,"stroke-dashoffset":i.dashOffset,"stroke-miterlimit":"4",cx:t.cx,cy:t.cy,r:t.r});if(t.type==="ellipse")return O("ellipse",{fill:e,"fill-rule":"evenodd",stroke:i.color,"stroke-width":i.width,"stroke-linecap":i.cap,"stroke-linejoin":i.join,"stroke-dasharray":i.dashArray,"stroke-miterlimit":"4",cx:t.cx,cy:t.cy,rx:t.rx,ry:t.ry});if(t.type==="rect")return O("rect",{fill:e,"fill-rule":"evenodd",stroke:i.color,"stroke-width":i.width,"stroke-linecap":i.cap,"stroke-linejoin":i.join,"stroke-dasharray":i.dashArray,"stroke-miterlimit":"4",x:t.x,y:t.y,width:t.width,height:t.height});if(t.type==="image")return O("image",{href:t.src,x:t.x,y:t.y,width:t.width,height:t.height,preserveAspectRatio:"none"});if(t.type==="path"){const r=typeof t.path!="string"?vhe(t.path):t.path;return O("path",{fill:e,"fill-rule":"evenodd",stroke:i.color,"stroke-width":i.width,"stroke-linecap":i.cap,"stroke-linejoin":i.join,"stroke-dasharray":i.dashArray,"stroke-miterlimit":"4",d:r})}if(t.type==="text")return ks(n),O("text",{"dominant-baseline":n.dominantBaseline,fill:e,"fill-rule":"evenodd",stroke:i.color,"stroke-width":i.width,"stroke-linecap":i.cap,"stroke-linejoin":i.join,"stroke-dasharray":i.dashArray,"stroke-miterlimit":"4","text-anchor":n.align,"text-decoration":n.decoration,kerning:n.kerning,rotate:n.rotate,"text-rendering":xGe,"font-style":n.font.style,"font-variant":n.font.variant,"font-weight":n.font.weight,"font-size":n.font.size,"font-family":n.font.family,x:t.x,y:t.y},t.text)}return null}function k8(t){const e={fill:"none",pattern:null,linearGradient:null};if(t){if("type"in t&&t.type==="pattern"){const i="patternId-"+ ++bGe;e.fill=`url(#${i})`,e.pattern={id:i,x:t.x,y:t.y,width:t.width,height:t.height,image:{x:0,y:0,width:t.width,height:t.height,href:t.src}}}else if("type"in t&&t.type==="linear"){const i="linearGradientId-"+ ++wGe;e.fill=`url(#${i})`,e.linearGradient={id:i,x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2,stops:t.colors.map(n=>({offset:n.offset,color:n.color&&new ae(n.color).toString()}))}}else if(t){const i=new ae(t);e.fill=i.toString()}}return e}function O8(t){const e={color:"none",width:1,cap:"butt",join:"4",dashArray:"none",dashOffset:"0"};if(t&&(t.width!=null&&(e.width=t.width),t.cap&&(e.cap=t.cap),t.join&&(e.join=t.join.toString()),t.color&&(e.color=new ae(t.color).toString()),t.dashArray&&(e.dashArray=t.dashArray),t.dashArray&&(e.dashOffset=t.dashoffset),t.style)){let i=null;if(t.style in OJ&&(i=OJ[t.style]),Array.isArray(i)){i=i.slice(0);const n=t.width??0;for(let r=0;r<i.length;++r)i[r]*=n;if(t.cap!=="butt"){for(let r=0;r<i.length;r+=2)i[r]-=n,i[r]<1&&(i[r]=1);for(let r=1;r<i.length;r+=2)i[r]+=n}i=i.join(",")}e.dashArray=i}return e}function _he(t,e){const i={align:null,decoration:null,kerning:null,rotate:null,font:{style:null,variant:null,weight:null,size:null,family:null}};if(t){const n=t.alignBaseline,r=n==="baseline"?"auto":n==="top"?"text-top":n==="bottom"?"hanging":n;i.align=t.align,i.dominantBaseline=r,i.decoration=t.decoration,i.kerning=t.kerning?"auto":"0",i.rotate=t.rotated?"90":"0",ks(e),i.font.style=e.style||"normal",i.font.variant=e.variant||"normal",i.font.weight=e.weight||"normal",i.font.size=e.size&&e.size.toString()||"10pt",i.font.family=e.family||"serif"}return i}function bhe(t){const{pattern:e,linearGradient:i}=t;if(e)return O("pattern",{id:e.id,patternUnits:"userSpaceOnUse",x:e.x,y:e.y,width:e.width,height:e.height},O("image",{x:e.image.x,y:e.image.y,width:e.image.width,height:e.image.height,href:e.image.href}));if(i){const n=i.stops.map((r,s)=>O("stop",{key:`${s}-stop`,offset:r.offset,"stop-color":r.color}));return O("linearGradient",{id:i.id,gradientUnits:"userSpaceOnUse",x1:i.x1,y1:i.y1,x2:i.x2,y2:i.y2},n)}return null}function MGe(t,e){if(!t||t.length===0)return null;const i=[];for(const n of t){const{shape:r,fill:s,stroke:o,font:a}=n,l=k8(s),c=O8(o),u=r.type==="text"?_he(r,a):null,d=P8(r,l.fill,c,u);d&&i.push(d)}return O("mask",{id:e,maskUnits:"userSpaceOnUse"},O("g",null,i))}function LJ(t,e,i){return ub(t,PP(t),[e,i])}function RJ(t,e,i,n,r){return kP(t,PP(t),[e,i]),t[4]=t[4]*e-n*e+n,t[5]=t[5]*i-r*i+r,t}function EGe(t,e,i,n){const r=e%360*Math.PI/180;QS(t,PP(t),r);const s=Math.cos(r),o=Math.sin(r),a=t[4],l=t[5];return t[4]=a*s-l*o+n*o-i*s+i,t[5]=l*s+a*o-i*o-n*s+n,t}function Us(t,e){nn&&"left"in nn?(nn.left!=null&&nn.left>t&&(nn.left=t),(nn.right==null||nn.right<t)&&(nn.right=t),(nn.top==null||nn.top>e)&&(nn.top=e),(nn.bottom==null||nn.bottom<e)&&(nn.bottom=e)):nn={left:t,bottom:e,right:t,top:e}}function DJ(t){const e=t.args,i=e.length;let n;switch(t.action){case"M":case"L":case"C":case"S":case"Q":case"T":for(n=0;n<i;n+=2)Us(e[n],e[n+1]);Ht.x=e[i-2],Ht.y=e[i-1];break;case"H":for(n=0;n<i;++n)Us(e[n],Ht.y);Ht.x=e[i-1];break;case"V":for(n=0;n<i;++n)Us(Ht.x,e[n]);Ht.y=e[i-1];break;case"m":{let r=0;for(("x"in Ht)||(Us(Ht.x=e[0],Ht.y=e[1]),r=2),n=r;n<i;n+=2)Us(Ht.x+=e[n],Ht.y+=e[n+1]);break}case"l":case"t":for(n=0;n<i;n+=2)Us(Ht.x+=e[n],Ht.y+=e[n+1]);break;case"h":for(n=0;n<i;++n)Us(Ht.x+=e[n],Ht.y);break;case"v":for(n=0;n<i;++n)Us(Ht.x,Ht.y+=e[n]);break;case"c":for(n=0;n<i;n+=6)Us(Ht.x+e[n],Ht.y+e[n+1]),Us(Ht.x+e[n+2],Ht.y+e[n+3]),Us(Ht.x+=e[n+4],Ht.y+=e[n+5]);break;case"s":case"q":for(n=0;n<i;n+=4)Us(Ht.x+e[n],Ht.y+e[n+1]),Us(Ht.x+=e[n+2],Ht.y+=e[n+3]);break;case"A":for(n=0;n<i;n+=7)Us(e[n+5],e[n+6]);Ht.x=e[i-2],Ht.y=e[i-1];break;case"a":for(n=0;n<i;n+=7)Us(Ht.x+=e[n+5],Ht.y+=e[n+6])}}function NJ(t,e,i){const n=SGe[t.toLowerCase()];let r;typeof n=="number"&&(n?e.length>=n&&(r={action:t,args:e.slice(0,e.length-e.length%n)},i.push(r),DJ(r)):(r={action:t,args:[]},i.push(r),DJ(r)))}function AGe(t){const e=(typeof t.path!="string"?vhe(t.path):t.path).match(TGe),i=[];if(nn={},Ht={},!e)return null;let n="",r=[];const s=e.length;for(let a=0;a<s;++a){const l=e[a],c=parseFloat(l);isNaN(c)?(n&&NJ(n,r,i),r=[],n=l):r.push(c)}NJ(n,r,i);const o={x:0,y:0,width:0,height:0};return nn&&"left"in nn&&(o.x=nn.left,o.y=nn.top,o.width=nn.right-nn.left,o.height=nn.bottom-nn.top),o}function whe(t){const e={x:0,y:0,width:0,height:0};if(t.type==="circle")e.x=t.cx-t.r,e.y=t.cy-t.r,e.width=2*t.r,e.height=2*t.r;else if(t.type==="ellipse")e.x=t.cx-t.rx,e.y=t.cy-t.ry,e.width=2*t.rx,e.height=2*t.ry;else if(t.type==="image"||t.type==="rect")e.x=t.x,e.y=t.y,e.width=t.width,e.height=t.height;else if(t.type==="path"){const i=Lr(AGe(t));e.x=i.x,e.y=i.y,e.width=i.width,e.height=i.height}return e}function xhe(t){const e={x:0,y:0,width:0,height:0};let i=null,n=Number.NEGATIVE_INFINITY,r=Number.NEGATIVE_INFINITY;for(const s of t)i?(i.x=Math.min(i.x,s.x),i.y=Math.min(i.y,s.y),n=Math.max(n,s.x+s.width),r=Math.max(r,s.y+s.height)):(i=e,i.x=s.x,i.y=s.y,n=s.x+s.width,r=s.y+s.height);return i&&(i.width=n-i.x,i.height=r-i.y),i}function kF(t,e,i,n,r,s,o,a,l){let c=(o&&s?g_(s,e):e)/2,u=(o&&s?g_(s,i):i)/2;if(l){const w=l[0],x=l[1];c=(o&&s?g_(s,w):w)/2,u=(o&&s?g_(s,x):x)/2}const d=t.width+n,f=t.height+n,m=TA(),g=TA();let y=!1;if(r&&d!==0&&f!==0){const w=e!==i?e/i:d/f,x=e>i?e:i;let S=1,T=1;isNaN(x)||(w>1?(S=x/d,T=x/w/f):(T=x/f,S=x*w/d)),qg(g,g,RJ(m,S,T,c,u)),y=!0}const _=t.x+(d-n)/2,b=t.y+(f-n)/2;if(qg(g,g,LJ(m,c-_,u-b)),!y&&(d>e||f>i)){const w=d/e>f/i,x=(w?e:i)/(w?d:f);qg(g,g,RJ(m,x,x,_,b))}return s&&qg(g,g,EGe(m,s,_,b)),a&&qg(g,g,LJ(m,a[0],a[1])),`matrix(${g[0]},${g[1]},${g[2]},${g[3]},${g[4]},${g[5]})`}function $Ge(t,e,i){const n=t==null?void 0:t.effects.find(c=>c.type==="bloom");if(!n)return null;const{strength:r,radius:s}=n,o=r>0?s:0,a=(r+o)*e,l=4*r+1;return O("filter",{id:`bloom${i}`,x:"-100%",y:"-100%",width:"300%",height:"300%",filterUnits:"userSpaceOnUse"},O("feMorphology",{operator:"dilate",radius:(r+.5*o)*(5**(e/100)*(.4+e/100)),in:"SourceGraphic",result:"dilate"}),O("feGaussianBlur",{in:"dilate",stdDeviation:a/25,result:"blur"}),O("feGaussianBlur",{in:"blur",stdDeviation:a/50,result:"intensityBlur"}),O("feComponentTransfer",{in:"SourceGraphic",result:"intensityBrightness"},O("feFuncR",{type:"linear",slope:l}),O("feFuncG",{type:"linear",slope:l}),O("feFuncB",{type:"linear",slope:l})),O("feMerge",null,O("feMergeNode",{in:"intensityBlur"}),O("feMergeNode",{in:"intensityBrightness"}),O("feGaussianBlur",{stdDeviation:r/10})))}function She(t,e,i,n={}){var c;const r=[],s=[],o=++CGe,a=$Ge(n.effectView,e,o);let l=null;if(a){const u=(c=n.effectView)==null?void 0:c.effects.find(g=>g.type==="bloom"),d=(u.strength?u.strength+u.radius/2:0)/3,f=e+e*d,m=i+i*d;l=[Math.max(f,10),Math.max(m,10)]}for(let u=0;u<t.length;u++){const d=t[u],f=[],m=[];let g=0,y=0,_=0;for(const x of d){const{shape:S,fill:T,stroke:I,font:C,offset:M}=x;n.ignoreStrokeWidth||S.type==="text"||(g+=I&&I.width||0);const E=k8(T),A=O8(I),$=S.type==="text"?_he(S,C):null;r.push(bhe(E)),f.push(P8(S,E.fill,A,$)),m.push(whe(S)),M&&(y+=M[0],_+=M[1])}const b=kF(Lr(xhe(m)),e,i,g,n.scale??!1,n.rotation,n.useRotationSize??!1,[y,_],l);let w=null;if(n.masking){const x=`mask-${u}`,S=n.masking[u];r.push(MGe(S,x)),w=`url(#${x})`}s.push(w?O("g",{mask:w},O("g",{transform:b},f)):O("g",{transform:b},f))}return n.useRotationSize&&n.rotation&&(e=g_(n.rotation,e),i=g_(n.rotation,i)),a&&(ks(l),e=l[0],i=l[1]),O("svg",{xmlns:_Ge,width:e,height:i,style:"display: block;","aria-labelledby":n.ariaLabel,role:"img",focusable:!1},a,O("defs",null,r),a?O("g",{filter:`url(#bloom${o})`},s):s)}const FJ=bA();function PGe(t,e){FJ.append(t,e),FJ.detach(e)}function vT(t,e,i){const n=Math.ceil(e[0]),r=Math.ceil(e[1]);if(!t.some(o=>!!o.length))return null;const s=i&&i.node||document.createElement("div");return i.opacity!=null&&(s.style.opacity=i.opacity.toString()),i.effectView!=null&&(s.style.filter=iS(i.effectView)),PGe(s,()=>She(t,n,r,i)),s}function kGe(t,e){t=Math.ceil(t),e=Math.ceil(e);const i=document.createElement("canvas");i.width=t,i.height=e,i.style.width=t+"px",i.style.height=e+"px";const n=i.getContext("2d");return n.clearRect(0,0,t,e),n}function OGe(t,e,i){return t?gt(t,{responseType:"image"}).then(n=>{const r=n.data,s=r.width,o=r.height,a=s/o;let l=e;if(i){const c=Math.max(s,o);l=Math.min(l,c)}return{image:r,width:a<=1?Math.ceil(l*a):l,height:a<=1?l:Math.ceil(l/a)}}):Promise.reject(new V("renderUtils: imageDataSize","href not provided."))}function LGe(t,e){return!(!t||e==="ignore")&&(e!=="multiply"||t.r!==255||t.g!==255||t.b!==255||t.a!==1)}function RGe(t,e,i,n,r){switch(r){case"multiply":t[e]*=i[0],t[e+1]*=i[1],t[e+2]*=i[2],t[e+3]*=i[3];break;default:{const s=Hy({r:t[e],g:t[e+1],b:t[e+2]});s.h=n.h,s.s=n.s,s.v=s.v/100*n.v;const o=Bf(s);t[e]=o.r,t[e+1]=o.g,t[e+2]=o.b,t[e+3]*=i[3];break}}}function DGe(t,e,i,n,r){return OGe(t,e,r).then(s=>{const o=s.width??e,a=s.height??e;if(s.image&&LGe(i,n)){let l=s.image.width,c=s.image.height;ee("edge")&&/\.svg$/i.test(t)&&(l-=1,c-=1);const u=kGe(o,a);u.drawImage(s.image,0,0,l,c,0,0,o,a);const d=u.getImageData(0,0,o,a),f=[i.r/255,i.g/255,i.b/255,i.a],m=Hy(i);for(let g=0;g<d.data.length;g+=4)RGe(d.data,g,f,m,n);u.putImageData(d,0,0),t=u.canvas.toDataURL("image/png")}else{const l=ct&&ct.findCredential(t);if(l&&l.token){const c=t.includes("?")?"&":"?";t=`${t}${c}token=${l.token}`}}return{url:t,width:o,height:a}}).catch(()=>({url:t,width:e,height:e}))}const The="esri-relationship-ramp",U0=`${The}--diamond`,qd=`${The}--square`,NGe="http://www.w3.org/2000/svg",mi={diamondContainer:`${U0}__container`,diamondLeftCol:`${U0}__left-column`,diamondRightCol:`${U0}__right-column`,diamondMidCol:`${U0}__middle-column`,diamondMidColLabel:`${U0}__middle-column--label`,diamondMidColRamp:`${U0}__middle-column--ramp`,squareTable:`${qd}__table`,squareTableRow:`${qd}__table-row`,squareTableCell:`${qd}__table-cell`,squareTableLabel:`${qd}__table-label`,squareTableLabelLeftBottom:`${qd}__table-label--left-bottom`,squareTableLabelRightBottom:`${qd}__table-label--right-bottom`,squareTableLabelLeftTop:`${qd}__table-label--left-top`,squareTableLabelRightTop:`${qd}__table-label--right-top`};function Ihe(t,e,i={}){const{focus:n,labels:r}=t,s=!!n,o=FGe(t,e,i),a={justifyContent:"center"},l=Mc();return s?O("div",{class:mi.diamondContainer,styles:a},O("div",{class:mi.diamondLeftCol},l?r.right:r.left),O("div",{class:mi.diamondMidCol},O("div",{class:mi.diamondMidColLabel},r.top),o,O("div",{class:mi.diamondMidColLabel},r.bottom)),O("div",{class:mi.diamondRightCol},l?r.left:r.right)):O("div",{class:mi.squareTable},O("div",{class:mi.squareTableRow},O("div",{class:u_(mi.squareTableCell,mi.squareTableLabel,mi.squareTableLabelRightBottom)},l?r.top:r.left),O("div",{class:mi.squareTableCell}),O("div",{class:u_(mi.squareTableCell,mi.squareTableLabel,mi.squareTableLabelLeftBottom)},l?r.left:r.top)),O("div",{class:mi.squareTableRow},O("div",{class:mi.squareTableCell}),o,O("div",{class:mi.squareTableCell})),O("div",{class:mi.squareTableRow},O("div",{class:u_(mi.squareTableCell,mi.squareTableLabel,mi.squareTableLabelRightTop)},l?r.right:r.bottom),O("div",{class:mi.squareTableCell}),O("div",{class:u_(mi.squareTableCell,mi.squareTableLabel,mi.squareTableLabelLeftTop)},l?r.bottom:r.right)))}function zJ(t,e,i){const n=`${i}_arrowStart`,r=`${i}_arrowEnd`,s=t==="left",o={markerStart:null,markerEnd:null};switch(e){case"HL":s?o.markerStart=`url(#${r})`:o.markerEnd=`url(#${n})`;break;case"LL":o.markerStart=`url(#${r})`;break;case"LH":s?o.markerEnd=`url(#${n})`:o.markerStart=`url(#${r})`;break;default:o.markerEnd=`url(#${n})`}return o}function FGe(t,e,i={}){const{focus:n,numClasses:r,colors:s,rotation:o}=t,{opacity:a,effectList:l,ariaLabel:c}=i,u=i.size??60,d=!!n,f=Math.sqrt(u**2+u**2)+(d?0:5),m=[],g=[],y=[],_=(u||75)/r;for(let L=0;L<r;L++){const D=L*_;for(let F=0;F<r;F++){const z=F*_,U=k8(s[L][F]),G=O8(null),W={type:"rect",x:z,y:D,width:_,height:_},Z=bhe(U);Z&&m.push(Z);const X=P8(W,U.fill,G,null);X&&g.push(X),y.push(whe(W))}}const b=10,w=15,x=15,S=10;let T=null;d||(T="margin: -15px -15px -18px -15px");const I=zJ("left",n,e),C=zJ("right",n,e),M=xhe(y),E=kF(M,f,f,0,!1,o,!1),A=kF(M,f,f,0,!1,d?-45:null,!1),$={filter:iS(l)??void 0,opacity:a==null?"":`${a}`};return O("div",{styles:$,class:d?mi.diamondMidColRamp:mi.squareTableCell},O("svg",{xmlns:NGe,width:f,height:f,style:T,"aria-labelledBy":c,role:"image",focusable:!1},O("defs",null,O("marker",{id:`${e}_arrowStart`,markerWidth:"10",markerHeight:"10",refX:"5",refY:"5",markerUnits:"strokeWidth",orient:"auto"},O("polyline",{points:"0,0 5,5 0,10",fill:"none",stroke:"#555555","stroke-width":"1"})),O("marker",{id:`${e}_arrowEnd`,markerWidth:"10",markerHeight:"10",refX:"0",refY:"5",markerUnits:"strokeWidth",orient:"auto"},O("polyline",{points:"5,0 0,5 5,10",fill:"none",stroke:"#555555","stroke-width":"1"})),m),O("g",{transform:E},g),O("g",{transform:A},O("line",{fill:"none",stroke:"#555555","stroke-width":"1","marker-start":I.markerStart,"marker-end":I.markerEnd,x1:-b,y1:u-w,x2:-b,y2:w}),O("line",{fill:"none",stroke:"#555555","stroke-width":"1","marker-start":C.markerStart,"marker-end":C.markerEnd,x1:x,y1:u+S,x2:u-x,y2:u+S}))))}function zGe(t){return t=t||globalThis.location.hostname,VGe.some(e=>(t==null?void 0:t.match(e))!=null)}function VJ(t,e){return t&&(e=e||globalThis.location.hostname)?e.match(Che)!=null||e.match(Ehe)!=null?t.replace("static.arcgis.com","staticdev.arcgis.com"):e.match(Mhe)!=null||e.match(Ahe)!=null?t.replace("static.arcgis.com","staticqa.arcgis.com"):t:t}const Che=/^devext.arcgis.com$/,Mhe=/^qaext.arcgis.com$/,Ehe=/^[\w-]*\.mapsdevext.arcgis.com$/,Ahe=/^[\w-]*\.mapsqa.arcgis.com$/,VGe=[/^([\w-]*\.)?[\w-]*\.zrh-dev-local.esri.com$/,Che,Mhe,/^jsapps.esri.com$/,Ehe,Ahe];function $he(t,e,i,n){const r=t.name;return r==null?Promise.reject(new V("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference")):t.styleName&&t.styleName==="Esri2DPointSymbolsStyle"?jGe(r,e,n):Xoe(t,e,n).then(s=>khe(Lr(s),r,e,i,CLe,n))}function Phe(t,e){return e.items.find(i=>i.name===t)}function khe(t,e,i,n,r,s){var m;const o=i&&i.portal!=null?i.portal:nr.getDefault(),a={portal:o,url:ir(t.baseUrl),origin:"portal-item"},l=Phe(e,t.data);if(!l){const g=`The symbol name '${e}' could not be found`;return Promise.reject(new V("symbolstyleutils:symbol-name-not-found",g,{symbolName:e}))}let c=Rf(r(l,n),a),u=((m=l.thumbnail)==null?void 0:m.href)??null;const d=l.thumbnail&&l.thumbnail.imageData;zGe()&&(c=VJ(c)??"",u=VJ(u));const f={portal:o,url:ir(t6(c)),origin:"portal-item"};return tj(c,s).then(g=>{const y=n==="cimRef"?Koe(g.data):g.data,_=Ooe(y,f);if(_&&Ou(_)){if(u){const b=Rf(u,a);_.thumbnail=new gy({url:b})}else d&&(_.thumbnail=new gy({url:`data:image/png;base64,${d}`}));t.styleUrl?_.styleOrigin=new V2({portal:i.portal,styleUrl:t.styleUrl,name:e}):t.styleName&&(_.styleOrigin=new V2({portal:i.portal,styleName:t.styleName,name:e}))}return _})}function jGe(t,e,i){const n=MLe.replaceAll(/\{SymbolName\}/gi,t),r=e.portal!=null?e.portal:nr.getDefault();return tj(n,i).then(s=>{const o=Koe(s.data);return Ooe(o,{portal:r,url:ir(t6(n)),origin:"portal-item"})})}const BGe=Object.freeze(Object.defineProperty({__proto__:null,fetchSymbolFromStyle:khe,getStyleItemFromStyle:Phe,resolveWebStyleSymbol:$he},Symbol.toStringTag,{value:"Module"})),Kg=sr.size,oE=sr.maxSize,L8=sr.maxOutlineSize,jJ=sr.lineWidth,OF=sr.tallSymbolWidth;function y_(t){const e=t.outline,i=t.material!=null?t.material.color:null,n=i!=null?i.toHex():null;if(e==null||"pattern"in e&&e.pattern!=null&&e.pattern.type==="style"&&e.pattern.style==="none")return t.type==="fill"&&n==="#ffffff"?{color:"#bdc3c7",width:.75}:null;const r=Gi(e.size)||0;return{color:"rgba("+(e.color!=null?e.color.toRgba():"255,255,255,1")+")",width:Math.min(r,L8),style:"pattern"in e&&e.pattern!=null&&e.pattern.type==="style"?Ej(e.pattern.style):null,join:"butt",cap:"patternCap"in e?e.patternCap:"butt"}}async function UGe(t,e){var n,r,s;if((n=t.thumbnail)!=null&&n.url)return t.thumbnail.url;if(e.type==="icon"&&((r=e==null?void 0:e.resource)==null?void 0:r.href))return CNe(e);const i=xt("esri/images/Legend/legend3dsymboldefault.png");if(t.styleOrigin&&(t.styleOrigin.styleName||t.styleOrigin.styleUrl)){const o=await $he(t.styleOrigin,{portal:t.styleOrigin.portal},"webRef").catch(()=>null);if(o&&"thumbnail"in o&&((s=o.thumbnail)!=null&&s.url))return o.thumbnail.url}return i}function sL(t,e=1){const i=t.a,n=Hy(t),r=n.h,s=n.s/e,o=100-(100-n.v)/e,{r:a,g:l,b:c}=Bf({h:r,s,v:o});return[a,l,c,i]}function m$(t){return t.type==="water"?t.color==null?null:t.color:t.material==null||t.material.color==null?null:t.material.color}function ai(t,e=0){const i=m$(t);if(!i){if(t.type==="fill")return null;const r=xNe.r,s=Pf(r,e);return[s,s,s,100]}const n=i.toRgba();for(let r=0;r<3;r++)n[r]=Pf(n[r],e);return n}async function Ohe(t,e){const i=t.style;return i==="none"?null:{type:"pattern",x:0,y:0,src:await wNe(xt(`esri/symbols/patterns/${i}.png`),e.toCss(!0)),width:5,height:5}}function BJ(t){return t.outline?y_(t):{color:"rgba(0, 0, 0, 1)",width:1.5}}function Lhe(t,e){const i=m$(t);if(!i)return null;let n="rgba(";return n+=Pf(i.r,e)+",",n+=Pf(i.g,e)+",",n+=Pf(i.b,e)+",",n+i.a+");"}function LF(t,e){const i=Lhe(t,e);return i?"pattern"in t&&t.pattern!=null&&t.pattern.type==="style"&&t.pattern.style==="none"?null:{color:i,width:Math.min(t.size?Gi(t.size):.75,L8),style:"pattern"in t&&t.pattern!=null&&t.pattern.type==="style"?Ej(t.pattern.style):null,cap:"cap"in t?t.cap:null,join:"join"in t?t.join==="miter"?Gi(2):t.join:null}:{}}function eC(t,e,i){const n=i!=null?.75*i:0;return{type:"linear",x1:n?.25*n:0,y1:n?.5*n:0,x2:n||4,y2:n?.5*n:4,colors:[{color:t,offset:0},{color:e,offset:1}]}}function GGe(t){const e=t.depth,i=t.height,n=t.width;return n!==0&&e!==0&&i!==0&&n===e&&n!=null&&i!=null&&n<i}function HGe(t,e,i){const n=[];if(!t)return n;switch(t.type){case"icon":{const o=e,a=e;switch(t.resource&&t.resource.primitive||lTe){case"circle":n.push({shape:{type:"circle",cx:0,cy:0,r:.5*e},fill:ai(t,0),stroke:y_(t)});break;case"square":n.push({shape:{type:"path",path:[{command:"M",values:[0,a]},{command:"L",values:[0,0]},{command:"L",values:[o,0]},{command:"L",values:[o,a]},{command:"Z",values:[]}]},fill:ai(t,0),stroke:y_(t)});break;case"triangle":n.push({shape:{type:"path",path:[{command:"M",values:[0,a]},{command:"L",values:[.5*o,0]},{command:"L",values:[o,a]},{command:"Z",values:[]}]},fill:ai(t,0),stroke:y_(t)});break;case"cross":n.push({shape:{type:"path",path:[{command:"M",values:[.5*o,0]},{command:"L",values:[.5*o,a]},{command:"M",values:[0,.5*a]},{command:"L",values:[o,.5*a]}]},stroke:BJ(t)});break;case"x":n.push({shape:{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[o,a]},{command:"M",values:[o,0]},{command:"L",values:[0,a]}]},stroke:BJ(t)});break;case"kite":n.push({shape:{type:"path",path:[{command:"M",values:[0,.5*a]},{command:"L",values:[.5*o,0]},{command:"L",values:[o,.5*a]},{command:"L",values:[.5*o,a]},{command:"Z",values:[]}]},fill:ai(t,0),stroke:y_(t)})}break}case"object":switch(t.resource&&t.resource.primitive||dTe){case"cone":{const r=eC(ai(t,0),ai(t,-.6),i?OF:e),s=mGe(e,i);n.push({shape:s[0],fill:r}),n.push({shape:s[1],fill:r});break}case"inverted-cone":{const r=ai(t,0),s=eC(r,ai(t,-.6),e),o=gGe(e);n.push({shape:o[0],fill:s}),n.push({shape:o[1],fill:r});break}case"cube":{const r=pGe(e,i);n.push({shape:r[0],fill:ai(t,0)}),n.push({shape:r[1],fill:ai(t,-.3)}),n.push({shape:r[2],fill:ai(t,-.5)});break}case"cylinder":{const r=eC(ai(t,0),ai(t,-.6),i?OF:e),s=fGe(e,i);n.push({shape:s[0],fill:r}),n.push({shape:s[1],fill:r}),n.push({shape:s[2],fill:ai(t,0)});break}case"diamond":{const r=yGe(e);n.push({shape:r[0],fill:ai(t,-.3)}),n.push({shape:r[1],fill:ai(t,0)}),n.push({shape:r[2],fill:ai(t,-.3)}),n.push({shape:r[3],fill:ai(t,-.7)});break}case"sphere":{const r=eC(ai(t,0),ai(t,-.6));r.x1=0,r.y1=0,r.x2=.25*e,r.y2=.25*e,n.push({shape:{type:"circle",cx:0,cy:0,r:.5*e},fill:r});break}case"tetrahedron":{const r=vGe(e);n.push({shape:r[0],fill:ai(t,-.3)}),n.push({shape:r[1],fill:ai(t,0)}),n.push({shape:r[2],fill:ai(t,-.6)});break}}break}return n}function yk(t){const e=typeof(t==null?void 0:t.size)=="number"?t==null?void 0:t.size:null;return e?Gi(e):null}function qGe(t){return t.type==="icon"?"multiply":"tint"}function WGe(t,e){const i=yk(e),n=e!=null&&e.maxSize?Gi(e.maxSize):null,r=(e==null?void 0:e.disableUpsampling)??!1,s=t.symbolLayers,o=[];let a=0,l=0;const c=s.at(-1);let u;return c&&c.type==="icon"&&(u=c.size&&Gi(c.size)),s.forEach(d=>{var g;if(d.type!=="icon"&&d.type!=="object")return;const f=d.type==="icon"?d.size&&Gi(d.size):0,m=i||f?Math.ceil(Math.min(i||f,n||oE)):Kg;if(d&&d.resource&&d.resource.href){const y=UGe(t,d).then(_=>{const b=d.get("material.color"),w=qGe(d);return DGe(_,m,b,w,r)}).then(_=>{const b=_.width,w=_.height;return a=Math.max(a,b),l=Math.max(l,w),[{shape:{type:"image",x:0,y:0,width:b,height:w,src:_.url},fill:null,stroke:null}]});o.push(y)}else{let y=m;d.type==="icon"&&u&&i&&(y=m*(f/u));const _=(e==null?void 0:e.symbolConfig)==="tall"||((g=e==null?void 0:e.symbolConfig)==null?void 0:g.isTall)||d.type==="object"&&GGe(d);a=Math.max(a,_?OF:y),l=Math.max(l,y),o.push(Promise.resolve(HGe(d,y,_)))}}),Sn(o).then(d=>{const f=[];return d.forEach(m=>{m.value?f.push(m.value):m.error&&ne.getLogger("esri.symbols.support.previewSymbol3D").warn("error while building swatchInfo!",m.error)}),vT(f,[a,l],{node:e&&e.node,scale:!1,opacity:e&&e.opacity,ariaLabel:e==null?void 0:e.ariaLabel})})}function JGe(t,e){const i=t.symbolLayers,n=[],r=ek(t),s=yk(e),o=(e&&e.maxSize?Gi(e.maxSize):null)||L8;let a,l=0,c=0;return i.forEach((u,d)=>{if(!u||u.type!=="line"&&u.type!=="path")return;const f=[];switch(u.type){case"line":{const m=LF(u,0);if(m==null)break;const g=m&&m.width||0;d===0&&(a=g);const y=Math.min(s||g,o),_=d===0?y:s?y*(g/a):y,b=_>jJ/2?2*_:jJ;c=Math.max(c,_),l=Math.max(l,b),m.width=_,f.push({shape:{type:"path",path:[{command:"M",values:[0,.5*c]},{command:"L",values:[l,.5*c]}]},stroke:m});break}case"path":{const m=Math.min(s||Kg,o),g=ai(u,0),y=ai(u,-.2),_=Lhe(u,-.4),b=_?{color:_,width:1}:{};if(u.profile==="quad"){const w=u.width,x=u.height,S=uGe(w&&x?w/x:1,x===0,w===0),T={...b,join:"bevel"};f.push({shape:S[0],fill:y,stroke:T}),f.push({shape:S[1],fill:y,stroke:T}),f.push({shape:S[2],fill:g,stroke:T})}else f.push({shape:PF.pathSymbol3DLayer[0],fill:y,stroke:b}),f.push({shape:PF.pathSymbol3DLayer[1],fill:g,stroke:b});c=Math.max(c,m),l=c}}n.push(f)}),Promise.resolve(vT(n,[l,c],{node:e&&e.node,scale:r,opacity:e&&e.opacity,ariaLabel:e==null?void 0:e.ariaLabel}))}async function ZGe(t,e){const i=t.type==="mesh-3d",n=t.symbolLayers,r=yk(e),s=e&&e.maxSize?Gi(e.maxSize):null,o=r||Kg,a=[];let l=0,c=0,u=!1;for(let d=0;d<n.length;d++){const f=n.at(d),m=[];if(i&&f.type!=="fill")continue;const g=PF.fill[0];switch(f.type){case"fill":{const y=y_(f),_=Math.min(o,s||oE);l=Math.max(l,_),c=Math.max(c,_),u=!0;let b=ai(f,0);const w="pattern"in f?f.pattern:null,x=m$(f);!i&&w!=null&&w.type==="style"&&w.style!=="solid"&&x&&(b=await Ohe(w,x)),m.push({shape:g,fill:b,stroke:y});break}case"line":{const y=LF(f,0);if(y==null)break;const _={stroke:y,shape:g};l=Math.max(l,Kg),c=Math.max(c,Kg),m.push(_);break}case"extrude":{const y={join:"round",width:1,...LF(f,-.4)},_=ai(f,0),b=ai(f,-.2),w=Math.min(o,s||oE),x=hGe(w);y.width=1,m.push({shape:x[0],fill:b,stroke:y}),m.push({shape:x[1],fill:b,stroke:y}),m.push({shape:x[2],fill:_,stroke:y});const S=Kg,T=.7*Kg+.5*w;l=Math.max(l,S),c=Math.max(c,T);break}case"water":{const y=Lr(m$(f)),_=sL(y),b=sL(y,2),w=sL(y,3),x=dGe();u=!0,m.push({shape:x[0],fill:_}),m.push({shape:x[1],fill:b}),m.push({shape:x[2],fill:w});const S=Math.min(o,s||oE);l=Math.max(l,S),c=Math.max(c,S);break}}a.push(m)}return vT(a,[l,c],{node:e&&e.node,scale:u,opacity:e&&e.opacity,ariaLabel:e==null?void 0:e.ariaLabel})}function YGe(t,e){if(t.symbolLayers.length===0)return Promise.reject(new V("symbolPreview: renderPreviewHTML3D","No symbolLayers in the symbol."));switch(t.type){case"point-3d":return WGe(t,e);case"line-3d":return JGe(t,e);case"polygon-3d":case"mesh-3d":return ZGe(t,e)}return Promise.reject(new V("symbolPreview: swatchInfo3D","symbol not supported."))}const XGe=Object.freeze(Object.defineProperty({__proto__:null,getPatternDescriptor:Ohe,getSizeFromOptions:yk,getSymbolLayerFill:ai,previewSymbol3D:YGe},Symbol.toStringTag,{value:"Module"})),UJ={HH:315,HL:45,LL:135,LH:225},KGe={2:[["HL","HH"],["LL","LH"]],3:[["HL","HM","HH"],["ML","MM","MH"],["LL","LM","LH"]],4:[["HL","HM1","HM2","HH"],["M2L","M2M1","M2M2","M2H"],["M1L","M1M1","M1M2","M1H"],["LL","LM1","LM2","LH"]]};function QGe(t){if(!t)return;const{type:e}=t;if(e.includes("3d"))return ai(t.symbolLayers.at(0));if(e==="simple-line"){const i=eS(t);return i&&i.color}if(t.type==="simple-marker"&&(t.style==="x"||t.style==="cross")){const i=eS(t);return i&&i.color}return bNe(t)}function eHe(t,e){const i=e.HH.label,n=e.LL.label,r=e.HL.label,s=e.LH.label;switch(t){case"HH":default:return{top:i,bottom:n,left:r,right:s};case"HL":return{top:r,bottom:s,left:n,right:i};case"LL":return{top:n,bottom:i,left:s,right:r};case"LH":return{top:s,bottom:r,left:i,right:n}}}function tHe(t){const{focus:e,infos:i,numClasses:n}=t,r=KGe[n],s={};i.forEach(a=>{s[a.value]={label:a.label,fill:QGe(a.symbol)}});const o=[];for(let a=0;a<n;a++){const l=[];for(let c=0;c<n;c++){const u=s[r[a][c]];l.push(u.fill)}o.push(l)}return{type:"relationship-ramp",numClasses:n,focus:e,colors:o,labels:eHe(e,s),rotation:Rhe(e)}}function Rhe(t){let e=UJ[t];return t&&e==null&&(e=UJ.HH),e||0}let G0=null;const GJ=[255,255,255];function HJ(t,e){return Math.floor(Math.random()*(e-t+1)+t)}function iHe(t,e,i){const{backgroundColor:n,outline:r,dotSize:s}=t,o=i&&i.swatchSize||sr.size,a=.8,l=Math.round(o*o/s**2*a),c=window.devicePixelRatio,u=document.createElement("canvas"),d=o*c;u.width=d,u.height=d,u.style.width=u.width/c+"px",u.style.height=u.height/c+"px";const f=u.getContext("2d");if(n&&(f.fillStyle=n.toCss(!0),f.fillRect(0,0,d,d),f.fill()),f.fillStyle=(e==null?void 0:e.toCss(!0))??"",G0&&G0.length/2===l)for(let g=0;g<2*l;g+=2){const y=G0[g],_=G0[g+1];f.fillRect(y,_,s*c,s*c),f.fill()}else{G0=[];for(let g=0;g<2*l;g+=2){const y=HJ(0,d),_=HJ(0,d);G0.push(y,_),f.fillRect(y,_,s*c,s*c),f.fill()}}r&&(r.color&&(f.strokeStyle=r.color.toCss(!0)),f.lineWidth=r.width,f.strokeRect(0,0,d,d));const m=new Image(o,o);return m.src=u.toDataURL(),m.ariaLabel=(i==null?void 0:i.ariaLabel)??null,m.alt=(i==null?void 0:i.ariaLabel)??"",m}function nHe(t,e={}){const i=e.radius||40,n=2*Math.PI*i,r=t.length,s=n/r,o=[],a=eS(e.outline);(a==null?void 0:a.width)!=null&&(a.width*=2),(a||e.backgroundColor)&&o.push({shape:{type:"circle",cx:i,cy:i,r:i},fill:e.backgroundColor,stroke:a,offset:[0,0]});const l=e.values,c=l&&l.length===r&&l.reduce((g,y)=>g+y,0)===100,u=[0];for(let g=0;g<r;g++){let y=null;c&&(y=l[g]*n/100,u.push(y+u[g])),o.push({shape:{type:"circle",cx:i,cy:i,r:i/2},fill:[0,0,0,0],stroke:{width:i,dashArray:`${(y??s)/2} ${n}`,dashoffset:"-"+(c?u[g]/2:g*(s/2)),color:t[g]},offset:[0,0]})}let d=null;const f=2*i+((a==null?void 0:a.width)||0),m=e.holePercentage;if(m){a&&o.push({shape:{type:"circle",cx:i,cy:i,r:i*m},fill:null,stroke:a,offset:[0,0]});const g=f/2;d=[[{shape:{type:"circle",cx:g,cy:g,r:g},fill:GJ,stroke:a?{...a,color:GJ}:null,offset:[0,0]},{shape:{type:"circle",cx:g,cy:g,r:i*m},fill:[0,0,0],stroke:null,offset:[0,0]}]]}return vT([o],[f,f],{effectView:e.effectList,ignoreStrokeWidth:!0,masking:d,rotation:-90,ariaLabel:e.ariaLabel})}function $g(t,e={}){const r=e.align==="horizontal",s=r?75:24,o=r?24:75,a=e.width??s,l=e.height??o,c=e.gradient??!0,u=window.devicePixelRatio,d=a*u,f=l*u,m=document.createElement("canvas");m.width=d,m.height=f,m.ariaLabel=e.ariaLabel??null,m.style.width=`${a}px`,m.style.height=`${l}px`;const g=m.getContext("2d"),y=r?d:0,_=r?0:f;if(c){const w=g.createLinearGradient(0,0,y,_),x=t.length,S=x===1?0:1/(x-1);t.forEach((T,I)=>w.addColorStop(I*S,T.toString())),g.fillStyle=w,g.fillRect(0,0,d,f)}else{const w=r?d/t.length:d,x=r?f:f/t.length;let S=0,T=0;for(const I of t)g.fillStyle=I.toString(),g.fillRect(S,T,w,x),S=r?S+w:0,T=r?0:T+x}const b=document.createElement("div");return b.style.width=`${a}px`,b.style.height=`${l}px`,rHe(b,e==null?void 0:e.effectList),b.appendChild(m),b}function rHe(t,e){if(!e)return;t.style.filter=iS(e);const i=e.effects;if(i){for(const n of i)if((n==null?void 0:n.type)==="drop-shadow"){n.offsetX<0?t.style.marginLeft=`${Math.abs(n.offsetX)}px`:t.style.marginRight=`${n.offsetX}px`;break}}}async function Dhe(t,e){switch(t.type){case"web-style":{const{previewWebStyleSymbol:i}=await Y(()=>import("./previewWebStyleSymbol-22629154.js"),[],import.meta.url);return i(t,Dhe,e)}case"label-3d":case"line-3d":case"mesh-3d":case"point-3d":case"polygon-3d":{const{previewSymbol3D:i}=await Y(()=>Promise.resolve().then(()=>XGe),void 0,import.meta.url);return i(t,e)}case"simple-marker":case"simple-line":case"simple-fill":case"picture-marker":case"picture-fill":case"text":{const{previewSymbol2D:i}=await Y(()=>import("./previewSymbol2D-ff05e8af.js"),["./previewSymbol2D-ff05e8af.js","./fontUtils-36c927ab.js","./colorUtils-7a1a7a9f.js"],import.meta.url);return i(t,e)}case"cim":{const{previewCIMSymbol:i}=await Y(()=>import("./previewCIMSymbol-bc2d8979.js"),["./previewCIMSymbol-bc2d8979.js","./cimAnalyzer-1925a3d6.js","./fontUtils-36c927ab.js","./BidiEngine-9a40f2f4.js","./OptimizedGeometry-196224d4.js","./GeometryUtils-984e8446.js","./enums-f1a6a48a.js","./alignmentUtils-ae955d28.js","./definitions-97fbc524.js","./number-e491b09e.js","./Rect-ea14f53a.js","./callExpressionWithFeature-2746b39a.js","./quantizationUtils-4d6bfb95.js","./floatRGBA-3a82b521.js","./CIMSymbolRasterizer-522e6e10.js","./CIMResourceManager-2b6c9f9f.js","./Rasterizer-37f71a46.js","./rasterizingUtils-1dfc8831.js","./imageutils-bc5643b0.js"],import.meta.url);return i(t,e)}default:return}}function Nhe(t){return t&&"opacity"in t?t.opacity*Nhe(t.parent):1}async function ngt(t,e){if(!t)return;const i=t.sourceLayer,n=(e!=null&&e.useSourceLayer?i:t.layer)??i,r=Nhe(n);if(t.symbol!=null&&(e==null||e.ignoreGraphicSymbol!==!0)){const x=t.symbol.type==="web-style"?await FNe(t.symbol,{...e,cache:e!=null?e.webStyleCache:null}):t.symbol.clone();return _O(x,null,r),x}const s=(e!=null?e.renderer:null)??(n&&"renderer"in n?n.renderer:null);let o=s&&"getSymbolAsync"in s?await s.getSymbolAsync(t,e):null;if(!o)return;if(o=o.type==="web-style"?await o.fetchSymbol({...e,cache:e!=null?e.webStyleCache:null}):o.clone(),!(s&&"visualVariables"in s&&s.visualVariables&&s.visualVariables.length))return _O(o,null,r),o;if("arcadeRequiredForVisualVariables"in s&&s.arcadeRequiredForVisualVariables&&(e==null||e.arcade==null)){const x={...e};x.arcade=await ld(),e=x}const{getColor:a,getOpacity:l,getAllSizes:c,getRotationAngle:u}=await Y(()=>Promise.resolve().then(()=>c0),void 0,import.meta.url),d=[],f=[],m=[],g=[];for(const x of s.visualVariables)switch(x.type){case"color":d.push(x);break;case"opacity":f.push(x);break;case"rotation":g.push(x);break;case"size":x.target||m.push(x)}const y=!!d.length&&d[d.length-1],_=y?a(y,t,e):null,b=!!f.length&&f[f.length-1];let w=b?l(b,t,e):null;if(r!=null&&(w=w!=null?w*r:r),_O(o,_,w),m.length){const x=c(m,t,e);await kle(o,x)}for(const x of g)Ole(o,u(x,t,e),x.axis);return o}const sHe=(t,e)=>{const i=t.featuresTilingScheme.getClosestInfoForScale(t.scale).level;return e!=null&&e.levels?e.levels[i]:null};function oHe(t,e){if(!t||!("visualVariables"in t)||!t.visualVariables)return null;const i=t.visualVariables.find(r=>r.type==="size"),n=sHe(e,i);return n?new u0({field:i.field,minSize:n[2].size,minDataValue:n[2].value,maxSize:n[3].size,maxDataValue:n[3].value}):null}const aHe=/^-?(\d+)(\.(\d+))?$/i;function lHe(t,e){return t-e}function cHe(t,e){let i,n;return i=Number(t.toFixed(e)),i<t?n=i+1/10**e:(n=i,i-=1/10**e),i=Number(i.toFixed(e)),n=Number(n.toFixed(e)),[i,n]}function uHe(t,e,i,n,r){const s=aE(t,e,i,n),o=s.previous==null||s.previous<=r,a=s.next==null||s.next<=r;return o&&a||s.previous+s.next<=2*r}function g$(t){const e=String(t),i=e.match(aHe);if(i&&i[1])return{integer:i[1].split("").length,fractional:i[3]?i[3].split("").length:0};if(e.toLowerCase().includes("e")){const n=e.split("e"),r=n[0],s=n[1];if(r&&s){const o=Number(r);let a=Number(s);const l=a>0;l||(a=Math.abs(a));const c=g$(o);return l?(c.integer+=a,a>c.fractional?c.fractional=0:c.fractional-=a):(c.fractional+=a,a>c.integer?c.integer=1:c.integer-=a),c}}return{integer:0,fractional:0}}function aE(t,e,i,n){const r={previous:null,next:null};if(i!=null){const s=t-i,o=e-i-s;r.previous=Math.floor(Math.abs(100*o/s))}if(n!=null){const s=n-t,o=n-e-s;r.next=Math.floor(Math.abs(100*o/s))}return r}function y$(t,e={}){const i=t.slice(0),{tolerance:n=2,strictBounds:r=!1,indexes:s=i.map((o,a)=>a)}=e;s.sort(lHe);for(let o=0;o<s.length;o++){const a=s[o],l=i[a],c=a===0?null:i[a-1],u=a===i.length-1?null:i[a+1],d=g$(l).fractional;if(d){let f,m=0,g=!1;for(;m<=d&&!g;){const y=cHe(l,m);f=r&&o===0?y[1]:y[0],g=uHe(l,f,c,u,n),m++}g&&(i[a]=f)}}return i}const hHe={maximumFractionDigits:20};function dHe(t){return Ns(t,hHe)}const Fhe="<",zhe=">",pHe=Dh("short-date");function Vhe(t,e,i,n){let r="";e===0?r=`${Fhe} `:e===i&&(r=`${zhe} `);let s=null;return s=n?yi(t,pHe):dHe(t),r+s}const fHe=["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwcdIkqhiWn5fHwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6JrzFUAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwaeIkqhiWl5/HwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6sKxboAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwadJEqhiWl5fPwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu75+IUcAAAAASUVORK5CYII="];async function RF(t){if(!("visualVariables"in t)||!t.visualVariables)return null;const e=t.visualVariables.find(o=>o.type==="color");if(!e)return null;let i=null,n=null;if(e.stops){if(e.stops.length===1)return e.stops[0].color;i=e.stops[0].value,n=e.stops[e.stops.length-1].value}const r=i!=null&&n!=null?i+(n-i)/2:0,{getColor:s}=await Y(()=>Promise.resolve().then(()=>c0),void 0,import.meta.url);return s(e,r)??null}async function jhe(t,e){const i=t.trailCap,n=t.trailWidth||1,r=e||await RF(t)||t.color;return new Ur({cap:i,color:r,width:n})}function qJ(t){return t!=null&&typeof t=="object"&&"min"in t&&"max"in t}const mHe=new ae([64,64,64]);function Bhe(t,e){const i=[],n=t.length-1;return t.length===5?i.push(0,2,4):i.push(0,n),t.map((r,s)=>i.includes(s)?Vhe(r,s,n,e):null)}async function DF(t,e,i){let n=!1,r=[],s=[];if(t.stops){const c=t.stops;r=c.map(u=>u.value),n=c.some(u=>!!u.label),n&&(s=c.map(u=>u.label))}const o=r[0],a=r[r.length-1];if(o==null&&a==null)return null;const l=n?null:Bhe(r,i??!1);return(await Promise.all(r.map(async(c,u)=>({value:c,color:t.type==="opacity"?await gHe(c,t,e):(await Y(()=>Promise.resolve().then(()=>c0),void 0,import.meta.url)).getColor(t,c),label:n?s[u]:(l==null?void 0:l[u])??""})))).reverse()}async function gHe(t,e,i){const n=new ae(i??mHe),r=(await Y(()=>Promise.resolve().then(()=>c0),void 0,import.meta.url)).getOpacity(e,t);return r!=null&&(n.a=r),n}function yHe(t){let e=!1,i=[],n=[];i=t.map(a=>a.value),e=t.some(a=>!!a.label),e&&(n=t.map(a=>a.label??""));const r=i[0],s=i[i.length-1];if(r==null&&s==null)return null;const o=e?null:Bhe(i,!1);return i.map((a,l)=>({value:a,color:Uhe(a,t),label:e?n[l]:(o==null?void 0:o[l])??""})).reverse()}function Uhe(t,e){const{startIndex:i,endIndex:n,weight:r}=vHe(t,e);if(i===n)return e[i].color;const s=ae.blendColors(e[i].color,e[n].color,r);return new ae(s)}function vHe(t,e){let i=0,n=e.length-1;return e.some((r,s)=>t<r.value?(n=s,!0):(i=s,!1)),{startIndex:i,endIndex:n,weight:(t-e[i].value)/(e[n].value-e[i].value)}}function _He(t,e){let i=[];if(t&&t.type==="multipart")t.colorRamps.reverse().forEach((n,r)=>{r===0?i.push({value:e.max,color:new ae(n.toColor),label:"high"}):i.push({value:null,color:new ae(n.toColor),label:""}),r===t.colorRamps.length-1?i.push({value:e.min,color:new ae(n.fromColor),label:"low"}):i.push({value:null,color:new ae(n.fromColor),label:""})});else{let n,r;t&&t.type==="algorithmic"?(n=t.fromColor,r=t.toColor):(n=[0,0,0,1],r=[255,255,255,1]),i=[{value:e.max,color:new ae(r),label:"high"},{value:e.min,color:new ae(n),label:"low"}]}return i}function Ghe(t){if(!t.colorStops)return[];const e=[...t.colorStops].filter(n=>{var r;return((r=n.color)==null?void 0:r.a)>0});let i=e.length-1;if(e&&e[0]){const n=e[i];n&&n.ratio!==1&&(e.push(new Gx({ratio:1,color:n.color})),i++)}return e.map((n,r)=>{var o,a;let s="";return r===0?s=((o=t.legendOptions)==null?void 0:o.minLabel)||"low":r===i&&(s=((a=t.legendOptions)==null?void 0:a.maxLabel)||"high"),{color:n.color,label:s,ratio:n.ratio}}).reverse()}const NF=30,FF=12,Hhe=[255,255,255],qhe=[200,200,200],v_=[128,128,128],bHe=20,wHe=5;function xHe(t){return t.declaredClass==="esri.symbols.SimpleMarkerSymbol"}function SHe(t){return t.declaredClass==="esri.symbols.PictureMarkerSymbol"}function THe(t){return t.declaredClass==="esri.symbols.SimpleLineSymbol"}function IHe(t){return t.declaredClass==="esri.symbols.TextSymbol"}function CHe(t,e){const i=t.length-1;return t.map((n,r)=>Vhe(n,r,i,e))}async function MHe(t,e,i,n,r,s,o){const a=e.legendOptions,l=a&&a.customValues,c=o||await $He(t,i),u=e.stops,d=!!c,f=!!l,m=e.minSize!=null&&e.maxSize!=null,g=u&&u.length>1,y=!!e.target;if(!d||!f&&!(m||g&&!y))return;const _=ek(c);let b=!1,w=null,x=null;w=_&&!g?y$([e.minDataValue,e.maxDataValue]):l??await kHe(e,c,n,r);const S=t==null?void 0:t.authoringInfo,T=(S==null?void 0:S.type)==="univariate-color-size",I=T&&(S==null?void 0:S.univariateTheme)==="above-and-below";if(!w&&g&&(w=u.map(A=>A.value),b=u.some(A=>!!A.label),t.type==="flow"&&(w=y$(w)),b&&(x=u.map(A=>A.label))),_&&w!=null&&(w==null?void 0:w.length)>2&&!I&&(w=[w[0],w[w.length-1]]),!w)return null;T&&(w==null?void 0:w.length)!==5&&(w=Zhe({minSize:w[0],maxSize:w[w.length-1]}));const C=_?EHe(t,w):null,M=INe(c),E=b?null:CHe(w,s);return(await Promise.all(w.map(async(A,$)=>{const L=_?C[$]:await Xv(e,c,A,n,r);return{value:A,symbol:RHe(I&&t.type==="class-breaks"?AHe(t,$):c,L),label:b?x[$]:E[$],size:L,outlineSize:M}}))).reverse()}function EHe(t,e){const i=t==null?void 0:t.authoringInfo,n=(i==null?void 0:i.type)==="univariate-color-size";let r=[FF,NF];if(n){const s=e[0],o=e[e.length-1],a=FF,l=NF;r=e.map(c=>a+(c-s)/(o-s)*(l-a))}return n&&(i==null?void 0:i.univariateTheme)==="below"&&r.reverse(),r}function AHe(t,e){const i=t.classBreakInfos,n=i.length,r=n<2||!(e>=2)?i[0].symbol.clone():i[n-1].symbol.clone();return t.visualVariables.some(s=>s.type==="color")&&(r.type.includes("3d")?Whe(r):Jhe(r)),r}async function $He(t,e){var r,s;if(t.type==="flow")return jhe(t,e);if(t.type==="pie-chart")return new rs({color:null,outline:(r=t.outline)!=null&&r.width?t.outline:new Ur});let i=null,n=null;if(t.type==="simple")i=t.symbol;else if(t.type==="class-breaks"){const o=t.classBreakInfos;i=o&&o[0]&&o[0].symbol,n=o.length>1}else if(t.type==="unique-value"){const o=t.uniqueValueInfos;i=(s=o==null?void 0:o[0])==null?void 0:s.symbol,n=o!=null&&o.length>1}return!i||PHe(i)?null:(i=i.clone(),(e||n)&&(i.type.includes("3d")?Whe(i):Jhe(i)),i)}function PHe(t){return t?Ou(t)?!!t.symbolLayers&&t.symbolLayers.some(e=>e&&e.type==="fill"):t.type.includes("fill"):!1}function Whe(t){t.type==="line-3d"?t.symbolLayers.forEach(e=>{e.material={color:v_}}):t.symbolLayers.forEach(e=>{e.type!=="icon"||e.resource&&e.resource.href?e.material={color:qhe}:(e.material={color:Hhe},e.outline={color:v_,size:1.5})})}function Jhe(t){var i,n;const e=jV();t.type==="cim"?Cle(t,new ae(qhe)):t.type.includes("line")?t.color=v_:(t.color=e?v_:Hhe,t.type==="simple-marker"&&(t.outline?((n=(i=t.outline)==null?void 0:i.color)==null?void 0:n.toHex())==="#ffffff"&&(t.outline.color=v_):t.outline={color:v_,width:1.5}))}async function kHe(t,e,i,n){const r=(await Y(()=>Promise.resolve().then(()=>c0),void 0,import.meta.url)).getSizeRangeAtScale(t,i,n),s=r&&Zhe(r);if(!r||!s)return;let o=s.map(a=>OHe(a,t,r));o=y$(o);for(let a=1;a<o.length-1;a++){const l=await LHe(t,e,o[a],o[a-1],i,n);l&&(o[a]=l[0],s[a]=l[1])}return o}function Zhe(t){const e=t.minSize,i=t.maxSize,n=wHe,r=(i-e)/(n-1),s=[];for(let o=0;o<n;o++)s.push(e+r*o);return s}function OHe(t,e,i){const n=i.minSize,r=i.maxSize,s=e.minDataValue,o=e.maxDataValue;let a;return t<=n?a=s:t>=r?a=o:a=(t-n)/(r-n)*(o-s)+s,a}async function LHe(t,e,i,n,r,s){const o=await Xv(t,e,i,r,s),a=await Xv(t,e,n,r,s),l=g$(i),c=l.fractional,u=bHe;let d=l.integer,f=null,m=null;i>0&&i<1&&(f=10**c,d=g$(i*=f).integer);for(let g=d-1;g>=0;g--){const y=10**g;let _=Math.floor(i/y)*y,b=Math.ceil(i/y)*y;f!=null&&(_/=f,b/=f);let w=(_+b)/2;[,w]=y$([_,w,b],{indexes:[1]});const x=await Xv(t,e,_,r,s),S=await Xv(t,e,b,r,s),T=await Xv(t,e,w,r,s),I=aE(o,x,a,null),C=aE(o,S,a,null),M=aE(o,T,a,null);let E=I.previous<=u,A=C.previous<=u;if(E&&A&&(I.previous<=C.previous?(E=!0,A=!1):(A=!0,E=!1)),E?m=[_,x]:A?m=[b,S]:M.previous<=u&&(m=[w,T]),m)break}return m}async function Xv(t,e,i,n,r){const{getSize:s}=await Y(()=>Promise.resolve().then(()=>c0),void 0,import.meta.url);return s(t,i,{scale:n,view:r,shape:e.type==="simple-marker"?e.style:null})}function RHe(t,e){const i=t.clone();if(Ou(i))ek(i)||i.symbolLayers.forEach(n=>{n.type!=="fill"&&(n.size=e)});else if(xHe(i))i.size=e;else if(SHe(i)){const n=i.width,r=i.height;i.height=e,i.width=e*(n/r)}else THe(i)?i.width=e:IHe(i)&&i.font&&(i.font.size=e);return i}ne.getLogger("esri.renderers.support.utils");async function Jo(t,e,i){kK(t,e,()=>[]).push(...i)}async function rgt(t){var i,n;const e=new Map;if(!t)return e;if("visualVariables"in t&&t.visualVariables){const r=t.visualVariables.filter(s=>s.type==="color");for(const s of r){const o=(await DF(s)??[]).map(a=>a.color);await Jo(e,s.field||s.valueExpression,o)}}if(t.type==="heatmap"){const r=Ghe(t).map(s=>s.color);await Jo(e,t.field||t.valueExpression,r)}else if(t.type==="pie-chart"){for(const r of t.attributes)await Jo(e,r.field||r.valueExpression,[r.color]);await Jo(e,"default",[(i=t==null?void 0:t.othersCategory)==null?void 0:i.color,R0(t.backgroundFillSymbol,null)])}else if(t.type==="dot-density"){for(const r of t.attributes)await Jo(e,r.field||r.valueExpression,[r.color]);await Jo(e,"default",[t.backgroundColor])}else if(t.type==="unique-value")if(((n=t.authoringInfo)==null?void 0:n.type)==="predominance")for(const r of t.uniqueValueInfos??[])await Jo(e,r.value.toString(),[R0(r.symbol,null)]);else{const r=(t.uniqueValueInfos??[]).map(c=>R0(c.symbol,null)),{field:s,field2:o,field3:a,valueExpression:l}=t;(s||l)&&await Jo(e,s||l,r),o&&await Jo(e,o,r),a&&await Jo(e,a,r)}else if(t.type==="class-breaks"){const r=t.classBreakInfos.map(a=>R0(a.symbol,null)),{field:s,valueExpression:o}=t;await Jo(e,s??o,r)}else t.type==="simple"&&await Jo(e,"default",[R0(t.symbol,null)]);return"defaultSymbol"in t&&t.defaultSymbol&&await Jo(e,"default",[R0(t.defaultSymbol,null)]),e.forEach((r,s)=>{const o=Cge(r.filter(Boolean),(a,l)=>JSON.stringify(a)===JSON.stringify(l));e.set(s,o)}),e}function DHe(t){const i=Math.floor(Math.log10(Math.abs(t)))+1,n=i<4||i>6?4:i,r=1e6,s=Math.abs(t)>=r?"compact":"standard";return Ns(t,{notation:s,minimumSignificantDigits:2,maximumSignificantDigits:n})}const NHe="https://utility.arcgis.com/sharing/tools/legend",FHe="esri.layers.ImageryLayer",zHe="esri.layers.ImageryTileLayer",VHe="esri.layers.WCSLayer",tC=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i,jHe=new qe({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"}),iC=new rs({size:6,outline:{color:[128,128,128,.5],width:.5}}),BHe=new Pc({style:"solid"});function zF(t){return t.type==="flow"}function Yhe(t){return t.type==="vector-field"}function Xhe(t){return t.type==="raster-colormap"}function Khe(t){return t.type==="raster-stretch"}function Qhe(t){return t.type==="raster-shaded-relief"}function Kv(t){return t.declaredClass==="esri.renderers.SimpleRenderer"}function Qv(t){return t.declaredClass==="esri.renderers.ClassBreaksRenderer"}function lE(t){return t.declaredClass==="esri.renderers.UniqueValueRenderer"}function ede(t){return t.declaredClass==="esri.renderers.HeatmapRenderer"}function UHe(t){return R8(t)||D8(t)||N8(t)||GHe(t)}function GHe(t){return t.declaredClass==="esri.renderers.PointCloudRGBRenderer"}function R8(t){return t.declaredClass==="esri.renderers.PointCloudClassBreaksRenderer"}function D8(t){return t.declaredClass==="esri.renderers.PointCloudStretchRenderer"}function N8(t){return t.declaredClass==="esri.renderers.PointCloudUniqueValueRenderer"}function tde(t){return t.declaredClass==="esri.renderers.DotDensityRenderer"}function ide(t){return t.declaredClass==="esri.renderers.PieChartRenderer"}function HHe(t,e){return Kv(t)||Qv(t)||lE(t)||ede(t)||tde(t)||ide(t)?e.type==="2d"||yhe(t):Khe(t)||Xhe(t)||Qhe(t)||R8(t)||D8(t)||N8(t)||Yhe(t)||zF(t)}function qHe(t){return t.declaredClass==="esri.layers.BuildingSceneLayer"}function oL(t){return t.declaredClass==="esri.layers.SubtypeGroupLayer"}function WHe(t){return t.declaredClass==="esri.layers.VoxelLayer"}function JHe(t){return t.declaredClass==="esri.layers.WMSLayer"}function ZHe(t){return t.declaredClass==="esri.layers.WMTSLayer"}function aL(t){return t.declaredClass==="esri.layers.MapImageLayer"}function WJ(t){return t.declaredClass==="esri.layers.TileLayer"}function H0(t){return t.declaredClass===FHe}function nC(t){return t.declaredClass===zHe}function YHe(t){return t.declaredClass===VHe}function XHe(t){return t.type==="stretch-ramp"}function KHe(t){const e="authoringInfo"in t?t==null?void 0:t.authoringInfo:null;return(e==null?void 0:e.type)==="univariate-color-size"}function QHe(t){const e="authoringInfo"in t?t==null?void 0:t.authoringInfo:null;return(e==null?void 0:e.type)==="univariate-color-size"&&(e==null?void 0:e.univariateTheme)==="above-and-below"}function JJ(t){return"sublayers"in t}async function Ju(t,e){const i=await fy("esri/widgets/Legend/t9n/Legend");return t!=="previewTemplateAriaLabel"||e||(t="previewAriaLabel"),Ru(i[t],{label:e})}const eqe=new rs({style:"path",path:"M10,5 L5,0 0,5 M5,0 L5,15",size:15,outline:{width:1,color:[85,85,85,1]}});let q0={},Wn=class extends ye{constructor(t){super(t),this._hasColorRamp=!1,this._hasOpacityRamp=!1,this._hasSizeRamp=!1,this._webStyleSymbolCache=new Map,this._dotDensityUrlCache=new Map,this._scaleDrivenSizeVariable=null,this._hasClusterSizeVariable=!1,this.children=new xe,this.layerView=null,this.layer=null,this.legendElements=[],this.parent=null,this.hideLayersNotInCurrentView=!1,this.keepCacheOnDestroy=!1,this.respectLayerVisibility=!0,this.sublayerIds=[],this.title=null,this.view=null}initialize(){const t=()=>this.notifyChange("ready");this.addHandles([on(()=>this.children,"change",e=>{const{added:i,removed:n}=e;i.forEach(r=>{const s=`activeLayerInfo-ready-watcher-${r.layer.uid}`;this.addHandles(Q(()=>r.ready,t,He),s)}),n.forEach(r=>this.removeHandles(r.layer.uid)),t()})]),this.keepCacheOnDestroy||(q0={})}destroy(){this._webStyleSymbolCache=null,this._dotDensityUrlCache=null,this._scaleDrivenSizeVariable=null,this.keepCacheOnDestroy||(q0=null)}get effectList(){const t=this.layer;let e=null;return"effect"in t&&t.effect&&(e=new su,e.effect=t.effect,e.endTransitions(),e.scale=this.scale),e}get opacity(){var r;const t=this.layer.opacity,e=(r=this.parent)==null?void 0:r.opacity,i=this.layer.parent,n=i&&"uid"in i?this._getParentLayerOpacity(i):null;return e!=null?e*t:n!=null?n*t:t}get ready(){return this.layer===null||(this.children.length>0?this._isGroupActive():this.legendElements.length>0)}get scale(){var t;return((t=this.view)==null?void 0:t.scale)??0}get isScaleDriven(){const t=this.layer;if(t===null)return!1;if("effect"in t&&t.effect&&Array.isArray(t.effect))return!0;if("featureReduction"in t&&t.featureReduction){if(t.featureReduction.type==="cluster")return!0;if(t.featureReduction.type==="binning"&&"renderer"in t.featureReduction&&t.featureReduction.renderer)return this._isRendererScaleDriven(t.featureReduction.renderer)}return"renderer"in t&&t.renderer?this._isRendererScaleDriven(t.renderer):this._isLayerScaleDriven(this.layer)}get version(){return this._get("version")+1}async buildLegendElementsForFeatureCollections(t){if(!(!this.hideLayersNotInCurrentView||await this._isLayerInCurrentView()))return this.legendElements=[],void this.notifyChange("ready");const e=Array.from(t,i=>{if(BQ(i))return this._getRendererLegendElements(i.renderer,{title:i.title});if(i.featureSet&&i.featureSet.features.length){const n=i.layerDefinition,r=n&&n.drawingInfo,s=r&&kLe(r.renderer),o=jHe.read(n.geometryType);return s?this._getRendererLegendElements(s,{title:i.name,geometryType:o}):(ne.getLogger(this).warn("drawingInfo not available!"),null)}return null});try{const i=[];await Sn(e).then(n=>{n.forEach(({value:r})=>r&&i.push(...r))}),this.legendElements=i,this.notifyChange("ready")}catch(i){ne.getLogger(this).warn("error while building legend for layer!",i)}}async buildLegendElementsForRenderer(t){try{const e=!this.hideLayersNotInCurrentView||await this._isLayerInCurrentView();this.legendElements=e?await this._getRendererLegendElements(t):[],this.notifyChange("ready")}catch(e){ne.getLogger(this).warn("error while building legend for layer!",e)}}async buildLegendElementsForFeatureReduction(t){try{const e=!this.hideLayersNotInCurrentView||await this._isLayerInCurrentView();this.legendElements=e?await this._getLegendElementsForFeatureReduction(t):[],this.notifyChange("ready")}catch(e){ne.getLogger(this).warn("error while building legend for layer!",e)}}async buildLegendElementsForTools(){var e,i;const t=this.layer;if(WHe(t))this._constructLegendElementsForVoxellayer();else if(ZHe(t))this._constructLegendElementsForWMTSlayer();else if(JHe(t))await this._constructLegendElementsForWMSSublayers();else if(qHe(t))await this._constructLegendElementsForBuildingSceneLayer();else if(aL(t)||WJ(t)||oL(t))await this._constructLegendElementsForSublayers();else{this.removeHandles("imageryLayers-watcher");let n="default";if(H0(t)){const r=t;n=(((e=r==null?void 0:r.rasterFunction)==null?void 0:e.functionName)||"default")+"_"+((i=t.bandIds)!=null&&i.length?t.bandIds.join(""):"###")}await this._getLegendLayers(`${t.uid}-${n}`).then(async r=>{this.legendElements=[],this.notifyChange("ready");const s=r.map(async o=>{if(H0(t)||nC(t)){const l=Q(()=>["renderingRule"in t&&t.rasterFunction,t.bandIds],()=>kS(async()=>{q0.default=null,t.renderer?await this.buildLegendElementsForRenderer(t.renderer):await this.buildLegendElementsForTools()})());this.addHandles(l,"imageryLayers-watcher")}const a=this._generateSymbolTableElementForLegendLayer(o);a&&a.infos.length&&(H0(t)&&(a.title=t.title),this.legendElements.push(a)),this.notifyChange("ready")});await Sn(s)}).catch(r=>{ne.getLogger(this).warn("Request to server for legend has failed!",r)})}}async _isLayerInCurrentView(){const t=this.layer,e=this.layerView,i=e&&"createQuery"in e&&"queryFeatureCount"in e;if(!i&&!(e&&"createQuery"in t&&"queryFeatureCount"in t))return!0;await Lu(()=>!e.updating);const n=i?"createQuery"in e&&e.createQuery():"createQuery"in t&&t.createQuery();return n?(n.geometry=this.view.extent,(i?"queryFeatureCount"in e&&await e.queryFeatureCount(n):"queryFeatureCount"in t&&await t.queryFeatureCount(n))!==0):!0}_getParentLayerOpacity(t){let e=1;const i=t.parent;return i&&"uid"in i&&(e=this._getParentLayerOpacity(i)),t.opacity*e}_isGroupActive(){const t=this.children;return!!t.length&&t.some(e=>e.ready)}_isRendererScaleDriven(t){if(t.type==="dot-density")return!0;const e="valueExpression"in t?t.valueExpression:null;if(tC.test(e))return!0;const i="visualVariables"in t?t.visualVariables:null;return!!i&&i.some(n=>this._isScaleDrivenSizeVariable(n))}_isScaleDrivenSizeVariable(t){if(t&&t.type!=="size")return!1;const e=t,i=e.minSize,n=e.maxSize;return typeof i=="object"&&i?this._isScaleDrivenSizeVariable(i):typeof n=="object"&&n?this._isScaleDrivenSizeVariable(n):!!e.expression||tC.test(e.valueExpression)}_isLayerScaleDriven(t){if("minScale"in t&&t.minScale>0||"maxScale"in t&&t.maxScale>0)return!0;if("sublayers"in t&&t.sublayers)return t.sublayers.some(i=>this._isLayerScaleDriven(i));const e=t.parent;if(t.loaded===!1&&e&&aL(e)&&"source"in t&&t.source&&t.source.type==="map-layer"){for(const i of e.sourceJSON.layers??[])if(i.id===t.source.mapLayerId&&(i.minScale>0||i.maxScale>0))return!0}return!1}async _constructLegendElementsForVoxellayer(){var s;this.legendElements=[],this.removeHandles("voxel-style-watcher"),this.removeHandles("voxel-current-variable");const t=this.layer;this.addHandles(Q(()=>t.currentVariableId,()=>this._constructLegendElementsForVoxellayer()),"voxel-current-variable"),this.addHandles(Q(()=>t.getVariableStyles(),()=>this._constructLegendElementsForVoxellayer()),"voxel-style-watcher");const e=t.getVariableStyle(null),i=[];if(e){if((s=e.uniqueValues)!=null&&s.length){const o=[];e.uniqueValues.forEach(a=>{a.enabled&&o.push({label:a.label||`${a.value}`,value:a.value,symbol:new Pc({color:a.color,outline:null})})}),o.length&&i.push({type:"symbol-table",title:e.label,infos:o})}else if(e.transferFunction){const{colorStops:o,stretchRange:a}=e.transferFunction,l=o.toArray().reverse(),c=a.map((d,f)=>`${f===0?Fhe:zhe} ${DHe(d)}`).reverse(),u=l.map(d=>({color:d.color,value:null,label:null}));u[0].label=c[0],u[u.length-1].label=c[1],i.push({type:"color-ramp",title:e.label,infos:u,preview:$g(l.map(d=>d.color),{ariaLabel:await Ju("previewColorRampAriaLabel")})})}}const n=t.opacity,r=i.reduce((o,a)=>[...o,...this._getAllInfos(a)],[]).filter(o=>!!(o!=null&&o.symbol)).map(o=>this._getSymbolPreview(o,n));await Sn(r),this.legendElements=i,this.notifyChange("ready")}_constructLegendElementsForWMTSlayer(){this.legendElements=[],this.removeHandles("wmts-activeLayer-watcher");const t=this.layer.activeLayer;if(this.addHandles(Q(()=>{const{layer:e}=this;return e&&"activeLayer"in e&&e.activeLayer},()=>this._constructLegendElementsForWMTSlayer()),"wmts-activeLayer-watcher"),t.styleId&&t.styles){let e=null;t.styles.some(i=>t.styleId===i.id&&(e=i.legendUrl,!0)),e&&(this.legendElements=[{type:"symbol-table",title:t.title,infos:[{src:e,opacity:this.opacity}]}])}this.notifyChange("ready")}async _constructLegendElementsForWMSSublayers(){this.legendElements=[],this.removeHandles("wms-sublayers-watcher");const t=this.layer;let e=null;(t.customParameters||t.customLayerParameters)&&(e={...t.customParameters,...t.customLayerParameters}),this.addHandles(Q(()=>{const{layer:i}=this;return i&&"sublayers"in i&&i.sublayers},()=>this._constructLegendElementsForWMSSublayers()),"wms-sublayers-watcher"),this.legendElements=await this._generateLegendElementsForWMSSublayers(t.sublayers,e),this.notifyChange("ready")}async _generateLegendElementsForWMSSublayers(t,e){const i=[];this.addHandles(t.on("change",()=>this._constructLegendElementsForWMSSublayers()),"wms-sublayers-watcher");const n=t.toArray();for(const r of n){const s=Q(()=>[r.title,r.visible,r.legendEnabled],()=>this._constructLegendElementsForWMSSublayers());if(this.addHandles(s,"wms-sublayers-watcher"),!this.respectLayerVisibility||r.visible&&r.legendEnabled){const o=await this._generateSymbolTableElementForWMSSublayer(r,e);o&&o.infos.length&&i.unshift(o)}}return i}async _generateSymbolTableElementForWMSSublayer(t,e){if(!t.legendUrl&&t.sublayers){const i=(await this._generateLegendElementsForWMSSublayers(t.sublayers,e)).filter(n=>n);return{type:"symbol-table",title:t.title,infos:i}}return this._generateSymbolTableElementForLegendUrl(t,e)}async _generateSymbolTableElementForLegendUrl(t,e){var o;let i=t.legendUrl;if(!i)return;const n={type:"symbol-table",title:t.title||t.name||String(t.id??""),infos:[]};e&&(i=WC(i,e));let r=null;const s=(o=t.layer)==null?void 0:o.opacity;try{r=(await gt(i,{responseType:"image"})).data,r&&(r.style.opacity=s)}catch{}return n.infos.push({src:i,preview:r,opacity:s}),n}_getLegendLayers(t,e){const i=q0&&q0[t];return i?Promise.resolve(i):this._legendRequest(e).then(n=>{const r=n.layers;return q0[t]=r,r})}_legendRequest(t){var r;const e=this.layer;let i={f:"json",dynamicLayers:t};if(H0(e)){const s=e.exportImageServiceParameters.rasterFunction;if(s&&(i.renderingRule=JSON.stringify(((r=s.functionDefinition)==null?void 0:r.toJSON())||s.toJSON())),e.bandIds&&(i.bandIds=e.bandIds.join()),e.raster||e.viewId||e.customParameters){const{raster:o,viewId:a,customParameters:l}=e;i={raster:o,viewId:a,...i,...l}}}let n=e.url.replace(/(\/)+$/,"");if("version"in e&&+e.version>=10.01){const s=n.indexOf("?");s>-1?n=n.substring(0,s)+"/legend"+n.substring(s):n+="/legend"}else{const s=n.toLowerCase().indexOf("/rest/"),o=n.substring(0,s)+n.substring(s+5,n.length);n=NHe+"?soapUrl="+encodeURI(o)+"&returnbytes=true"}return gt(n,{query:i}).then(s=>s.data)}async _constructLegendElementsForBuildingSceneLayer(){this.legendElements=[],this.removeHandles("sublayers-watcher");const t=this.layer;this.addHandles(Q(()=>t.sublayers,()=>this._constructLegendElementsForBuildingSceneLayer()),"sublayers-watcher");try{this.legendElements=await this._generateLegendElementsForBuildingSublayers(t.sublayers,this.opacity),this.notifyChange("ready")}catch(e){ne.getLogger(this).warn("Request to server for legend has failed!",e)}}async _generateLegendElementsForBuildingSublayers(t,e){let i=[];this.addHandles(t.on("change",()=>this._constructLegendElementsForBuildingSceneLayer()),"sublayers-watcher");const n=t.toArray();for(const r of n){const s=Q(()=>["renderer"in r&&r.renderer,r.opacity,r.title,r.visible],()=>this._constructLegendElementsForBuildingSceneLayer());if(this.addHandles(s,"sublayers-watcher"),!this.respectLayerVisibility||r.visible){const o=r&&r.opacity!=null?r.opacity:null,a=o!=null?o*e:e;if(r.type==="building-group"){const l={type:"symbol-table",title:r.title,infos:[]},c=await this._generateLegendElementsForBuildingSublayers(r.sublayers,a);l.infos.push(...c),i=[l,...i]}else r.renderer&&(i=[...await this._getRendererLegendElements(r.renderer,{title:r.title,opacity:a,sublayer:r}),...i])}}return i.filter(r=>!!r&&(!("infos"in r)||!r.infos||r.infos.length>0))}async _constructLegendElementsForSublayers(){this.legendElements=[],this.removeHandles("sublayers-watcher");const t=this.layer;if(aL(t)||WJ(t)||oL(t)){this.addHandles(Q(()=>t.sublayers,()=>this._constructLegendElementsForSublayers),"sublayers-watcher");try{this.legendElements=await this._generateLegendElementsForSublayers(t.sublayers,this.opacity),this.notifyChange("ready")}catch(e){ne.getLogger(this).warn("Request to server for legend has failed!",e)}}}async _generateLegendElementsForSublayers(t,e,i){const n=this.layer;let r=[];this.addHandles(t.on("change",()=>this._constructLegendElementsForSublayers()),"sublayers-watcher");let s=t.toArray();!i&&this.sublayerIds&&this.sublayerIds.length&&(s=oL(n)?this.sublayerIds.map(o=>n.findSublayerForSubtypeCode(o)).filter(Ti):this.sublayerIds.map(o=>n.findSublayerById(o)).filter(Ti));for(const o of s){const a=Q(()=>[o.renderer,o.opacity,o.title,o.visible,o.legendEnabled],()=>this._constructLegendElementsForSublayers());if(this.addHandles(a,"sublayers-watcher"),!this.respectLayerVisibility||o.visible&&o.legendEnabled&&this._isSublayerInScale(o)){const l=o&&o.opacity!=null?o.opacity:null,c=l!=null?l*e:e,u=!JJ(o)||o.originIdOf("renderer")>Ge.SERVICE&&!o.sublayers;if(o.renderer&&u)await o.load(),r=[...await this._getRendererLegendElements(o.renderer,{title:o.title,opacity:c,sublayer:o}),...r];else if(JJ(o)){const d=await this._generateSymbolTableElementForSublayer(o,c,i);d&&r.unshift(d)}}}return r.filter(o=>!!o&&(!("infos"in o)||!o.infos||o.infos.length>0))}async _generateSymbolTableElementForSublayer(t,e,i){if(!i){i=new Map;const r=this.layer,s=t.source;let o=null;if(!(!s||s.type==="map-layer"&&s.mapLayerId===t.id&&(!s.gdbVersion||s.gdbVersion===("gdbVersion"in r&&r.gdbVersion)))||t.originIdOf("renderer")>Ge.SERVICE||t.originIdOf("labelingInfo")>Ge.SERVICE||t.originIdOf("labelsVisible")>Ge.SERVICE){const l=new ea({layer:this.layer});o=l.hasDynamicLayers?l.dynamicLayers:null,l.destroy()}const a=o||`${r.uid}-default`;(await this._getLegendLayers(a,o)).forEach(l=>i.set(l.layerId,l))}const n=i.get(t.id);if((!n||n!=null&&n.subLayerIds&&n.defaultVisibility)&&t.sublayers){const r=await this._generateLegendElementsForSublayers(t.sublayers,e,i);return{type:"symbol-table",title:t.title,infos:r}}return this._generateSymbolTableElementForLegendLayer(n,t,e)}_generateSymbolTableElementForLegendLayer(t,e,i){if(!t||!t.legend||this.respectLayerVisibility&&!this._isLegendLayerInScale(t,e))return null;const n=e==null?void 0:e.renderer;let r=(e==null?void 0:e.title)||t.layerName;if(n&&(!e||(e==null?void 0:e.originIdOf("renderer"))>Ge.SERVICE)){const a=(e==null?void 0:e.title)||this._getRendererTitle(n,e);a&&(r&&typeof a!="string"&&"title"in a&&(a.title=r),r=a)}const s={type:"symbol-table",title:r,legendType:t.legendType||null,infos:[]},o=e?this._sanitizeLegendForSublayer(t.legend.slice(),e):t.legend;return t.legendGroups&&t.legendGroups.length>0?t.legendGroups.forEach(a=>{var c;const l={type:"symbol-table",title:a.heading,legendType:t.legendType||null,infos:this._generateSymbolTableElementInfosForLegendLayer(o.filter(u=>u.groupId===a.id),t.layerId,i)};((c=l.infos)==null?void 0:c.length)>0&&s.infos.push(l)}):s.infos=this._generateSymbolTableElementInfosForLegendLayer(o,t.layerId,i),s.infos.length>0?s:null}_generateSymbolTableElementInfosForLegendLayer(t,e,i){return t.map(n=>{let r=n.url;if(n.imageData&&n.imageData.length>0)r=`data:image/png;base64,${n.imageData}`;else{if(r.indexOf("http")===0)return null;r=n_e(`${this.layer.url}/${e}/images/${r}`)}return{label:n.label,src:r,opacity:i??this.opacity,width:n.width,height:n.height}}).filter(Ti)}_isSublayerInScale(t){const e=t.minScale||0,i=t.maxScale||0;return!(e>0&&e<this.scale||i>this.scale)}_isLegendLayerInScale(t,e){const i=e||this.layer;let n=null,r=null,s=!0;return!i.minScale&&i.minScale!==0||!i.maxScale&&i.maxScale!==0?(t.minScale===0&&i.tileInfo&&(n=i.tileInfo.lods[0].scale),t.maxScale===0&&i.tileInfo&&(r=i.tileInfo.lods[i.tileInfo.lods.length-1].scale)):(n=Math.min(i.minScale,t.minScale)||i.minScale||t.minScale,r=Math.max(i.maxScale,t.maxScale)),(n>0&&n<this.scale||r>this.scale)&&(s=!1),s}_sanitizeLegendForSublayer(t,e){if("version"in this.layer&&+this.layer.version<10.1||t.length===0)return t;const i=e.renderer,n=t.some(o=>o.values);let r=0,s=null;return n&&t.some((o,a)=>(o.values||(r=a,s=o,s.label||(s.label="others")),s!=null)),i?i.type==="unique-value"?s&&(t.splice(r,1),t.push(s)):i.type==="class-breaks"&&(s&&t.splice(r,1),t.reverse(),s&&t.push(s)):s&&(t.splice(r,1),t.push(s)),t}async _getRendererLegendElements(t,e={}){if(!HHe(t,this.view))return ne.getLogger(this).warn(`Renderer of type '${t.type}' not supported!`),[];if(UHe(t))return this._constructPointCloudRendererLegendElements(t,e);if(tde(t))return this._constructDotDensityRendererLegendElements(t);const i=await this._loadRenderer(t);return ide(i)?this._constructPieChartRendererLegendElements(i):this._constructRendererLegendElements(i,e)}async _getLegendElementsForFeatureReduction(t){let e=null;return t.type==="binning"?e=t.renderer:t.type==="cluster"&&(e=this._getClusterRenderer(t)),e?this._getRendererLegendElements(e):[]}_getPointCloudRendererTitle(t){var e;return(((e=t.legendOptions)==null?void 0:e.title)||t.field)??""}async _constructPointCloudRendererLegendElements(t,e={}){var a;const i=e.title,n=[];let r=null,s=null;if(R8(t))r={type:"symbol-table",title:i||this._getPointCloudRendererTitle(t),infos:[]},t.colorClassBreakInfos.forEach(l=>{r.infos.unshift({label:l.label||l.minValue+" - "+l.maxValue,value:[l.minValue,l.maxValue],symbol:this._getAppliedCloneSymbol(iC,l.color)})});else if(D8(t)){const l=t.stops;let c=null;if(l!=null&&l.length&&(l.length===1&&(c=l[0].color),!c)){const d=l[0].value,f=l[l.length-1].value;d!=null&&f!=null&&(c=Uhe(d+(f-d)/2,l))}r={type:"symbol-table",title:null,infos:[{label:null,value:null,symbol:this._getAppliedCloneSymbol(iC,c||iC.color)}]};const u=yHe(t.stops??[])??[];s={type:"color-ramp",title:i||this._getPointCloudRendererTitle(t),infos:u,preview:$g(u.map(d=>d.color),{ariaLabel:await Ju("previewColorRampAriaLabel")})}}else N8(t)&&(r={type:"symbol-table",title:i||this._getPointCloudRendererTitle(t),infos:[]},(a=t.colorUniqueValueInfos)==null||a.forEach(l=>{r.infos.push({label:l.label||l.values.join(", "),value:l.values.join(", "),symbol:this._getAppliedCloneSymbol(iC,l.color)})}));r&&r.infos.length&&n.push(r),s&&s.infos.length&&n.push(s);const o=n.reduce((l,c)=>[...l,...c.infos??[]],[]).filter(l=>!!l.symbol).map(l=>this._getSymbolPreview(l,this.opacity,{symbolConfig:{applyColorModulation:!!t.colorModulation}}));return Sn(o).then(()=>n)}async _getElementInfoForDotDensity(t,e){const{color:i,label:n,valueExpressionTitle:r}=e,{backgroundColor:s,outline:o,dotSize:a}=t,l=this.effectList,c=l==null?void 0:l.effects.map(b=>b.toJSON()),u=NA(c),d=await Ju("previewTemplateAriaLabel",n||r),f=a+"-"+i+"-"+s+"-"+(o&&JSON.stringify(o.toJSON()))+"-"+u,m=this._dotDensityUrlCache,g=m.has(f)?m.get(f):iHe(t,i,{ariaLabel:d});m.set(f,g);const y={shape:{type:"image",x:0,y:0,width:g.width,height:g.height,src:g.src},fill:null,stroke:null,offset:[0,0]},_=vT([[y]],[g.width,g.height],{effectView:this.effectList,ariaLabel:d});return{opacity:1,src:g.src,preview:_,width:g.width,height:g.height}}async _constructDotDensityRendererLegendElements(t){const e=t.calculateDotValue(this.view.scale),i=t.legendOptions&&t.legendOptions.unit,n={type:"symbol-table",title:{value:e&&Math.round(e),unit:i||""},infos:[]};for(const r of t.attributes){const s=await this._getElementInfoForDotDensity(t,r);s.label=r.label||r.valueExpressionTitle||r.field,n.infos.push(s)}return[n]}async _constructPieChartRendererLegendElements(t){var l,c,u,d;const e=this.layer.opacity,i=[];let n=null;const r=t.outline;t.attributes.forEach(f=>{const m=new rs({color:f.color,outline:r}),g=f.label||f.valueExpressionTitle||f.field;i.push({label:g,symbol:m})});const s=i.length?[...i]:[];if((l=t.othersCategory)!=null&&l.color&&((c=t.othersCategory)==null?void 0:c.threshold)!==0){const f=new rs({color:t.othersCategory.color,outline:r});n=t.othersCategory.label||"Other",i.push({label:n,symbol:f})}if((u=t.defaultColor)!=null&&u.a){const f=new rs({color:t.defaultColor,outline:r});i.push({label:t.defaultLabel,symbol:f})}const o=await this._getVisualVariableLegendElements(t,this.layer)||[];if(i.length){o.unshift({type:"symbol-table",title:null,infos:i});const f=s.filter(g=>g.label!==n).map(g=>g.symbol.color).filter(Boolean),m=nHe(f,{holePercentage:t.holePercentage,backgroundColor:(d=t.backgroundFillSymbol)==null?void 0:d.color,effectList:this.effectList,outline:r,ariaLabel:await Ju("previewPieChartAriaLabel")});o.unshift({type:"pie-chart-ramp",title:this._getRendererTitle(t,this.layer),infos:i,preview:m})}const a=o.reduce((f,m)=>[...f,...this._getAllInfos(m)],[]).filter(f=>!!(f!=null&&f.symbol)&&!(f!=null&&f.preview)).map(f=>this._getSymbolPreview(f,e,{effectList:this.effectList}));return await Sn(a),o}async _constructRendererLegendElements(t,e={}){var y,_,b,w;const{title:i,sublayer:n}=e,r=n||this.layer;this._hasColorRamp=!1,this._hasOpacityRamp=!1,this._hasSizeRamp=!1,this._scaleDrivenSizeVariable=null;const s=await this._getVisualVariableLegendElements(t,r)||[],o={type:"symbol-table",title:i||this._getRendererTitle(t,r),infos:[]};let a=null,l=!1;const c=new Set;if(zF(t)&&!this._hasSizeRamp){const x=await jhe(t);o.infos.push({label:null,symbol:x})}else if(KHe(t)){let x=i;const S=QHe(t)?"univariate-above-and-below-ramp":"univariate-color-size-ramp",T=s.findIndex(A=>A.type==="color-ramp"),I=T!==-1?s.splice(T,1)[0]:null,C=s.findIndex(A=>A.type==="size-ramp"),M=C!==-1?s.splice(C,1)[0]:null,E=[];I&&(x=I.title,E.push(I)),M&&(x=M.title,E.push(M)),E.length>0&&s.push({type:S,title:x,infos:E})}else if(ede(t)){const x=Ghe(t);s.push({type:"heatmap-ramp",title:i||this._getRendererTitle(t,r),infos:x,preview:$g(x.map(S=>S.color),{effectList:this.effectList,ariaLabel:await Ju("previewColorRampAriaLabel")})})}else if(lE(t)){const x=t&&t.authoringInfo;if(x&&x.type==="relationship"){const{numClasses:S,field1:T,field2:I}=x,C=x.focus;if(S&&T&&I){const M=[T,I];let E=Rhe(C)||0;for(const $ of M){const{field:L,normalizationField:D,label:F}=$,z=F||{field:this._getFieldAlias(L,r),normField:D&&this._getFieldAlias(D,r)},U=eqe.clone();U.angle=E,o.infos.push({label:z,symbol:U}),c.add(U),E+=90}const A=tHe({focus:C,numClasses:S,infos:t.uniqueValueInfos??[]});s.unshift(A)}}else if(H0(this.layer)||nC(this.layer))(y=t.uniqueValueInfos)==null||y.forEach(S=>{S.symbol&&o.infos.push({label:S.label||S.value,value:S.value,symbol:S.symbol})});else{const{field:S,field2:T,field3:I,fieldDelimiter:C,valueExpression:M,defaultSymbol:E}=t,A=!(!S&&!M||!T&&!I),$=[];if((_=t.uniqueValueGroups)==null||_.forEach(L=>{var F;const D={type:"symbol-table",title:L.heading,infos:[]};(F=L.classes)==null||F.forEach(z=>{const{symbol:U,values:G}=z;if(U){const W=[],Z=[];for(const se of G??[]){const{value:le,value2:de,value3:we}=se,Re=[],ze=[];(S||M)&&(Re.push(le),ze.push(this._getDomainName(S,le,r))),T&&(Re.push(de),ze.push(this._getDomainName(T,de,r))),I&&(Re.push(we),ze.push(this._getDomainName(I,we,r))),W.push(A?Re.join(C||""):Re[0]),Z.push(ze.join(" - "))}const X=W.join(", ");let oe=z.label;if(!oe){const se=Z.filter(Boolean);oe=se.length?se.join(", "):X}D.infos.push({label:oe,value:X,symbol:U})}}),D.infos.length&&$.push(D)}),$.length){const L=$[0];$.length===1&&"title"in L&&!L.title?o.infos.push(...L.infos??[]):(E&&($.push({type:"symbol-table",infos:[{label:t.defaultLabel||"others",symbol:E}]}),l=!0),o.infos.push(...$)),i||t.legendOptions&&t.legendOptions.title||t.valueExpressionTitle||(o.title=null)}}t.defaultSymbol&&!l&&(o.infos.push({label:t.defaultLabel||"others",symbol:t.defaultSymbol}),l=!0)}else if(Qv(t))a=this._isUnclassedRenderer(t),(!a||!this._hasSizeRamp)&&(t.classBreakInfos.forEach(x=>{x.symbol&&o.infos.unshift({label:x.label||(a?null:x.minValue+" - "+x.maxValue),value:[x.minValue,x.maxValue],symbol:x.symbol})}),a&&(o.title=null),this._updateInfosforClassedSizeRenderer(t,o.infos)),t.defaultSymbol&&!a&&(o.infos.push({label:t.defaultLabel||"others",symbol:t.defaultSymbol}),l=!0);else if(Khe(t))if(nC(this.layer)||YHe(this.layer)){const x=await this._constructTileImageryStretchRendererElements(t);XHe(x)?s.push(x):o.infos=x}else{const x=this.layer;let S,T;if((b=t.statistics)!=null&&b.length){const A=t.statistics[0];qJ(A)?(S=A.min,T=A.max):[S,T]=A}let I=[],C=x.serviceRasterInfo;if(x.rasterFunction)try{C=await x.generateRasterInfo(x.rasterFunction)}catch{}const M=C.keyProperties.BandProperties,E=Ac(C.pixelType);if(C.bandCount===1){const A=((w=x.bandIds)==null?void 0:w[0])||0;S=S??(C.statistics?C.statistics[A].min:E[0]),T=T??(C.statistics?C.statistics[A].max:E[1]),S||T?s.push(await this._getStretchLegendElements(t,{min:S,max:T})):this._getServerSideLegend()}else x.bandIds&&x.bandIds.length===1?(S=S??(C.statistics?C.statistics[x.bandIds[0]].min:E[0]),T=T??(C.statistics?C.statistics[x.bandIds[0]].max:E[1]),S||T?s.push(await this._getStretchLegendElements(t,{min:S,max:T})):this._getServerSideLegend()):C.bandCount>=3?M&&M.length>=C.bandCount?x.bandIds&&x.bandIds.length===3?(I=x.bandIds.map(A=>M[A].BandName),o.infos=this._createSymbolTableElementMultiBand(I)):x.format==="lerc"?(I=[0,1,2].map(A=>M[A].BandName),o.infos=this._createSymbolTableElementMultiBand(I)):this._getServerSideLegend():x.format==="lerc"?(I=["band1","band2","band3"],o.infos=this._createSymbolTableElementMultiBand(I)):this._getServerSideLegend():this._getServerSideLegend()}else if(Xhe(t))t.colormapInfos.forEach(x=>{o.infos.push({label:x.label,value:x.value,symbol:this._getAppliedCloneSymbol(BHe,x.color)})});else if(Kv(t)){let x=t.symbol;switch(e.geometryType){case"point":x="pointSymbol"in r?r.pointSymbol:null;break;case"polyline":x="lineSymbol"in r?r.lineSymbol:null;break;case"polygon":x="polygonSymbol"in r?r.polygonSymbol:null}const S=this._hasClusterSizeVariable&&this._getClusterSymbol()||!this._hasSizeRamp;t.symbol&&S&&o.infos.push({label:t.label,symbol:x})}else if(Yhe(t)){t.outputUnit&&(this.title="("+t.toJSON().outputUnit+")"),o.title=t.attributeField;const x=t.getClassBreakInfos();x!=null&&x.length?x.forEach(S=>{o.infos.push({label:S.minValue+" - "+S.maxValue,symbol:S.symbol})}):o.infos.push({label:t.attributeField,symbol:t.getDefaultSymbol()})}else Qhe(t)&&s.push(await this._getStretchLegendElements(t,{min:0,max:255}));const u=t.defaultSymbol;!u||l||Kv(t)||a&&!this._hasColorRamp&&!this._hasSizeRamp&&!this._hasOpacityRamp||s.push({type:"symbol-table",infos:[{label:t.defaultLabel||"others",symbol:u}]}),o.infos.length&&s.unshift(o);const d=e.opacity==null?this.opacity:e.opacity,f=this._isTallSymbol("visualVariables"in t?t.visualVariables:null),m=H0(this.layer)||nC(this.layer),g=s.reduce((x,S)=>[...x,...this._getAllInfos(S)],[]).filter(x=>!!(x!=null&&x.symbol)).map(x=>this._getSymbolPreview(x,d,{isDefault:x.symbol===u,applyScaleDrivenSize:!c.has(x.symbol),symbolConfig:{isTall:f,isSquareFill:m},effectList:c.has(x.symbol)?null:this.effectList}));return t=null,await Sn(g),s}_getServerSideLegend(){setTimeout(()=>this.buildLegendElementsForTools(),0)}_getAllInfos(t){const e=t==null?void 0:t.infos;return e?e.reduce((i,n)=>i.concat(this._getAllInfos(n)),[]):[t]}async _constructTileImageryStretchRendererElements(t){var u,d;const e=this.layer,{rasterInfo:i}=e.raster,n=i.bandCount||t.statistics.length;let r,s,o=[];const a=i.keyProperties&&i.keyProperties.BandProperties,l=(u=t==null?void 0:t.statistics)!=null&&u.length?t.statistics:i==null?void 0:i.statistics;if(l){const f=l[0];qJ(f)?(r=f.min,s=f.max):[r,s]=f}else{const f=Ac(i.pixelType);r=f[0],s=f[1]}if(e.hasStandardTime()&&(r=e.getStandardTimeValue(r),s=e.getStandardTimeValue(s)),i.bandCount===1||((d=e.bandIds)==null?void 0:d.length)===1)return this._getStretchLegendElements(t,{min:r,max:s});function c(f){var g;const m=((g=e==null?void 0:e.bandIds)!=null&&g.length?e.bandIds:Array.from(Array(Math.min(i.bandCount,3)).keys())).map(y=>f&&f[y]&&f[y].BandName||"band"+(y+1));return m.length<3?m.push(m[1]):m.length>3&&m.splice(3),m}return o=a&&a.length>=n?c(a):c(),this._createSymbolTableElementMultiBand(o)}async _getStretchLegendElements(t,e){const i=t.colorRamp,n=_He(i,e);return{type:"stretch-ramp",title:"",infos:n,preview:$g(n.map(r=>r.color),{ariaLabel:await Ju("previewColorRampAriaLabel")})}}_getClusterSymbol(){var n;const t=this.layer,e="featureReduction"in t&&t.featureReduction,i=e&&"symbol"in e&&e.renderer;return i&&((n=i==null?void 0:i.authoringInfo)==null?void 0:n.isAutoGenerated)!==!0?null:e&&"symbol"in e?e.symbol:null}async _getSizeLegendElement(t,e,i,n){return{type:"size-ramp",title:this._hasClusterSizeVariable?this._getClusterTitle(e):t,infos:await MHe(i,e,await RF(i),this.scale,this.view.type,!!n,this._hasClusterSizeVariable?this._getClusterSymbol():null)}}_createSymbolTableElementMultiBand(t){const e=[],i=["red","green","blue"];return t.forEach((n,r)=>{e.push({label:{colorName:i[r],bandName:n},src:fHe[r],opacity:this.opacity??1})}),e}_updateInfosforClassedSizeRenderer(t,e){const i=t.authoringInfo&&t.authoringInfo.type==="class-breaks-size",n=t.classBreakInfos.some(r=>ek(r.symbol));if(i&&n){const r=NF,s=FF,o=t.classBreakInfos.length,a=(r-s)/(o>1?o-1:o);e.forEach((l,c)=>{l.size=r-a*c})}}_isTallSymbol(t){let e=!1,i=!1;if(t)for(let n=0;n<t.length&&(!e||!i);n++){const r=t[n];r.type==="size"&&(r.axis==="height"&&(e=!0),r.axis==="width-and-depth"&&(i=!0))}return e&&i}async _getSymbolPreview(t,e,i){let n=!(i!=null&&i.isDefault)&&t.size==null&&this._hasSizeRamp?Tc(sr.size):t.size;if(this._scaleDrivenSizeVariable&&(i!=null&&i.applyScaleDrivenSize)){const{getSize:r}=await Y(()=>Promise.resolve().then(()=>c0),void 0,import.meta.url);n=r(this._scaleDrivenSizeVariable,null,{view:this.view.type,scale:this.scale,shape:t.symbol.type==="simple-marker"?t.symbol.style:null})}return Dhe(t.symbol,{size:n,opacity:e,scale:!1,symbolConfig:i==null?void 0:i.symbolConfig,effectView:i==null?void 0:i.effectList,ariaLabel:t.label&&typeof t.label!="string"?null:await Ju("previewTemplateAriaLabel",t.label)}).then(r=>(t.preview=r,t)).catch(()=>(t.preview=null,t))}_getClusterRenderer(t){var r,s;this._hasClusterSizeVariable=!1;const e="renderer"in this.layer?this.layer.renderer:null,i=((r=t.renderer)==null?void 0:r.clone())||(e==null?void 0:e.clone()),n=oHe(this.layerView._effectiveRenderer,this.view);if(n&&i!=null&&"visualVariables"in i&&!((s=i.visualVariables)==null?void 0:s.some(a=>a.type==="size"&&a.target!=="outline"&&!tC.test(a.valueExpression)))){if("clusterMinSize"in t&&"clusterMaxSize"in t){const{clusterMinSize:l,clusterMaxSize:c}=t;n.legendOptions=new Toe({showLegend:l!==c})}const a=i.visualVariables||[];i.visualVariables=a.concat([n]),this._hasClusterSizeVariable=!0}return i}async _loadRenderer(t){const e=[],i=t.clone(),n=await RF(i);if(Qv(i)||lE(i)){const r=(i.classBreakInfos||i.uniqueValueInfos).map(s=>this._fetchSymbol(s.symbol,n).then(o=>{s.symbol=o}).catch(()=>{s.symbol=null}));Array.prototype.push.apply(e,r)}return e.push(this._fetchSymbol(i.symbol||i.defaultSymbol,i.defaultSymbol?null:n).then(r=>{this._applySymbolToRenderer(i,r,Kv(i))}).catch(()=>{this._applySymbolToRenderer(i,null,Kv(i))})),Sn(e).then(()=>i)}_applySymbolToRenderer(t,e,i){i?t.symbol=e:t.defaultSymbol=e}async _fetchSymbol(t,e){if(!t)throw new Error;if(t.type==="web-style"){const i=this._webStyleSymbolCache;try{const n=await(this.view.type==="2d"?t.fetchCIMSymbol({cache:i}):t.fetchSymbol({cache:i}));return this._getAppliedCloneSymbol(n,e)}catch{throw ne.getLogger(this).warn("Fetching web-style failed!"),new Error}}return this._getAppliedCloneSymbol(t,e)}_getAppliedCloneSymbol(t,e){if(!t||!e)return t;const i=t.clone(),n=e&&e.toRgba();return i.type.includes("3d")?this._applyColorTo3dSymbol(i,n):i.type==="cim"?Cle(i,e):i.color&&(i.color=new ae(n||i.color)),i}_applyColorTo3dSymbol(t,e){e&&t.symbolLayers.forEach(i=>{i&&(i.material||(i.material={}),i.material.color=new ae(e))})}async _getVisualVariableLegendElements(t,e){if(!("visualVariables"in t)||!t.visualVariables||t.type==="vector-field")return null;const i=t.visualVariables,n=[],r=[],s=[];for(const u of i)u.type==="color"?n.push(u):u.type==="size"?r.push(u):u.type==="opacity"&&s.push(u);const o=[...n,...r,...s];let a,l;if(n.length===0&&Qv(t)&&t.classBreakInfos&&t.classBreakInfos.length===1){const u=t.classBreakInfos[0];a=u&&u.symbol}if(n.length===0&&Kv(t)&&(a=t.symbol),a)if(a.type.includes("3d")){const u=a.symbolLayers.at(0);u.type==="water"?u.color!=null&&(l=u.color):u.material!=null&&u.material.color!=null&&(l=u.material.color)}else a.url||(l=a.color);const c=this.effectList;return(await Promise.all(o.map(async u=>{var d;if(!u.legendOptions||u.legendOptions.showLegend!==!1){const f=zF(t)?u.field:this._getRampTitle(u,e);let m=null;const g="getField"in e?(d=e.getField)==null?void 0:d.call(e,u.field):null,y=g&&iA(g);if(u.type==="color"){const _=await DF(u,null,y)??[];m={type:"color-ramp",title:f,infos:_,preview:$g(_.map(b=>b.color),{effectList:c,ariaLabel:await Ju("previewColorRampAriaLabel")})},this._hasColorRamp||(this._hasColorRamp=_.length>0)}else if(u.type==="size"&&u.target!=="outline")tC.test(u.valueExpression)?this._hasClusterSizeVariable||(this._scaleDrivenSizeVariable=u):(m=await this._getSizeLegendElement(f,u,t,y),this._hasSizeRamp||(this._hasSizeRamp=!(m.infos==null||!m.infos.length)));else if(u.type==="opacity"){const _=await DF(u,l,y)??[];m={type:"opacity-ramp",title:f,infos:_,preview:$g(_.map(b=>b.color),{effectList:c,ariaLabel:await Ju("previewColorRampAriaLabel")})},this._hasOpacityRamp||(this._hasOpacityRamp=_.length>0)}return m&&m.infos?m:null}}))).filter(Ti)}_getDomainName(t,e,i){if(t&&typeof t!="function"){const n="getField"in i&&i.getField&&i.getField(t),r=n&&"getFieldDomain"in i&&i.getFieldDomain?i.getFieldDomain(n.name):null;return(r==null?void 0:r.type)==="coded-value"?r.getName(e):null}return null}_getClusterTitle(t){const e=this.layer,i=t.field;if("featureReduction"in e&&e.featureReduction&&e.featureReduction.type==="cluster"){const n=e.featureReduction,r="popupTemplate"in n&&n.popupTemplate,s=r&&r.fieldInfos;if(s){for(const o of s)if(o.fieldName===i)return i==="cluster_count"?o.label||{showCount:!0}:o.label}}return{showCount:!0}}_getRampTitle(t,e){let i=t.field,n=t.normalizationField,r=!1,s=!1,o=!1,a=null;i=typeof i=="function"?null:i,n=typeof n=="function"?null:n;const l=t.legendOptions&&t.legendOptions.title;if(l!=null)a=l;else if(t.valueExpressionTitle)a=t.valueExpressionTitle;else{if("renderer"in e&&e.renderer&&"authoringInfo"in e.renderer&&e.renderer.authoringInfo&&e.renderer.authoringInfo.visualVariables){const c=e.renderer.authoringInfo.visualVariables;for(let u=0;u<c.length;u++){const d=c[u];if(d.type==="color"){if(d.style==="ratio"){r=!0;break}if(d.style==="percent"){s=!0;break}if(d.style==="percent-of-total"){o=!0;break}}}}a={field:i&&this._getFieldAlias(i,e),normField:n&&this._getFieldAlias(n,e),ratio:r,ratioPercent:s,ratioPercentTotal:o}}return a}_getRendererTitle(t,e){const i=t;if(i.legendOptions&&i.legendOptions.title)return i.legendOptions.title;if(i.valueExpressionTitle)return i.valueExpressionTitle;let n=i.field,r=null,s=null;if(Qv(i)&&(r=i.normalizationField,s=i.normalizationType==="percent-of-total"),n=typeof n=="function"?null:n,r=typeof r=="function"?null:r,lE(i)){const{field2:a,field3:l,fieldDelimiter:c}=i;let u=n&&this._getFieldAlias(n,e);return a&&(u=`<${u}>${c}<${this._getFieldAlias(a,e)}>`,l&&(u=`${u}${c}<${this._getFieldAlias(l,e)}>`)),u}let o=null;return(n||r)&&(o={field:n&&this._getFieldAlias(n,e),normField:r&&this._getFieldAlias(r,e),normByPct:s}),o}_getFieldAlias(t,e){const i="popupTemplate"in e?e.popupTemplate:null,n=i==null?void 0:i.fieldInfos;let r;n&&n.some(u=>t===u.fieldName&&(r=u,!0));let s=null;"getField"in e&&e.getField?s=e.getField(t):"fieldsIndex"in e&&e.fieldsIndex&&(s=e.fieldsIndex.get(t));let o=null;const a="featureReduction"in e&&e.featureReduction;a&&(!r&&"popupTemplate"in a&&a.popupTemplate&&a.popupTemplate.fieldInfos&&a.popupTemplate.fieldInfos.some(u=>{var d;return(t==null?void 0:t.toLowerCase())===((d=u.fieldName)==null?void 0:d.toLowerCase())&&(r=u,!0)}),"fields"in a&&a.fields&&(o=a.fields.find(u=>{var d;return((d=u.name)==null?void 0:d.toLowerCase())===(t==null?void 0:t.toLowerCase())})));const l=r||s||o;let c=null;return l&&(c=(r==null?void 0:r.label)||(s==null?void 0:s.alias)||(o==null?void 0:o.alias)||"name"in l&&l.name||"fieldName"in l&&l.fieldName||null),c}_isUnclassedRenderer(t){const e=t.visualVariables;let i=!1;return Qv(t)&&t.classBreakInfos&&t.classBreakInfos.length===1&&e&&(i=t.field?e.some(n=>!(!n||t.field!==n.field||(t.normalizationField||n.normalizationField)&&t.normalizationField!==n.normalizationField)):!!e.length),i}};h([p()],Wn.prototype,"children",void 0),h([p({readOnly:!0})],Wn.prototype,"effectList",null),h([p()],Wn.prototype,"layerView",void 0),h([p()],Wn.prototype,"layer",void 0),h([p()],Wn.prototype,"legendElements",void 0),h([p({readOnly:!0})],Wn.prototype,"opacity",null),h([p()],Wn.prototype,"parent",void 0),h([p({readOnly:!0,dependsOn:[]})],Wn.prototype,"ready",null),h([p()],Wn.prototype,"hideLayersNotInCurrentView",void 0),h([p()],Wn.prototype,"keepCacheOnDestroy",void 0),h([p()],Wn.prototype,"respectLayerVisibility",void 0),h([p({readOnly:!0})],Wn.prototype,"scale",null),h([p()],Wn.prototype,"sublayerIds",void 0),h([p({readOnly:!0})],Wn.prototype,"isScaleDriven",null),h([p()],Wn.prototype,"title",void 0),h([p({readOnly:!0,dependsOn:["ready"],value:0})],Wn.prototype,"version",null),h([p()],Wn.prototype,"view",void 0),Wn=h([P("esri.widgets.Legend.support.ActiveLayerInfo")],Wn);const nde=Wn,_m={state:"state",view:"view",allLayerViews:"all-layer-views",legendProperties:"legend-properties"},rde=xe.ofType(nde),tqe=["esri.layers.BuildingSceneLayer","esri.layers.CSVLayer","esri.layers.FeatureLayer","esri.layers.GeoJSONLayer","esri.layers.GeoRSSLayer","esri.layers.GroupLayer","esri.layers.HeatmapLayer","esri.layers.ImageryLayer","esri.layers.ImageryTileLayer","esri.layers.MapImageLayer","esri.layers.OGCFeatureLayer","esri.layers.PointCloudLayer","esri.layers.StreamLayer","esri.layers.SceneLayer","esri.layers.SubtypeGroupLayer","esri.layers.TileLayer","esri.layers.VoxelLayer","esri.layers.WFSLayer","esri.layers.WMSLayer","esri.layers.WMTSLayer","esri.layers.WCSLayer","esri.layers.LinkChartLayer","esri.layers.knowledgeGraph.KnowledgeGraphSublayer"],sde="view.basemapView.baseLayerViews",ode="view.groundView.layerViews",ade="view.basemapView.referenceLayerViews",iqe=[sde,ode,"view.layerViews",ade];let qa=class extends ye{constructor(e){super(e),this._layerViewByLayerId={},this._layerInfosByLayerViewId={},this._activeLayerInfosByLayerViewId={},this._activeLayerInfosWithNoParent=new xe,this.activeLayerInfos=new rde,this.basemapLegendVisible=!1,this.groundLegendVisible=!1,this.hideLayersNotInCurrentView=!1,this.keepCacheOnDestroy=!1,this.respectLayerVisibility=!0,this.layerInfos=[],this.view=null}initialize(){this.addHandles(Q(()=>this.view,()=>this._viewHandles(),He),_m.view),this.addHandles(FS(()=>this._refresh()))}destroy(){this._destroyViewActiveLayerInfos(),this.view=null}get state(){return this.get("view.ready")?"ready":"disabled"}_viewHandles(){this.removeHandles(_m.state),this.view&&this.addHandles(Q(()=>this.state,()=>this._stateHandles(),He),_m.state)}_stateHandles(){this._resetAll(),this.state==="ready"&&this._watchPropertiesAndAllLayerViews()}_resetAll(){this.removeHandles([_m.allLayerViews,_m.legendProperties]),this._destroyViewActiveLayerInfos(),this.activeLayerInfos.removeAll()}_destroyViewActiveLayerInfos(){Object.keys(this._activeLayerInfosByLayerViewId).forEach(this._destroyViewActiveLayerInfo,this)}_destroyViewActiveLayerInfo(e){this.removeHandles(e);const i=this._activeLayerInfosByLayerViewId[e];delete this._activeLayerInfosByLayerViewId[e],i&&i.parent&&i.parent.children.remove(i)}_watchPropertiesAndAllLayerViews(){const{view:e}=this;if(!e)return;const{allLayerViews:i}=e;i.length&&this._refresh(),this.addHandles(i.on("change",n=>this._allLayerViewsChangeHandle(n)),_m.allLayerViews),this.addHandles(Q(()=>[this.layerInfos,this.basemapLegendVisible,this.groundLegendVisible],()=>this._propertiesChangeHandle()),_m.legendProperties)}_allLayerViewsChangeHandle(e){e.removed.forEach(i=>this._destroyViewActiveLayerInfo(i.uid)),this._refresh()}_propertiesChangeHandle(){this._destroyViewActiveLayerInfos(),this._refresh()}_refresh(){this._layerInfosByLayerViewId={},this.activeLayerInfos.removeAll(),this._generateLayerViews().filter(this._filterLayerViewsByLayerInfos,this).filter(this._isLayerViewSupported,this).forEach(this._generateActiveLayerInfo,this),this._sortActiveLayerInfos(this.activeLayerInfos)}_sortActiveLayerInfos(e){const i=this.view;if(e.length<2||!i)return;const n=[];e.forEach(s=>{if(!s.parent){const o=s.layer.parent,a=o&&"uid"in o&&this._layerViewByLayerId[o.uid],l=a&&this._activeLayerInfosByLayerViewId[a.uid];l&&e.includes(l)&&(n.push(s),s.parent=l,l.children.add(s),this._sortActiveLayerInfos(l.children))}}),e.removeMany(n);const r={};i.allLayerViews.forEach((s,o)=>r[s.layer.uid]=o),e.sort((s,o)=>{const a=r[s.layer.uid]||0;return(r[o.layer.uid]||0)-a})}_generateLayerViews(){const e=[];return iqe.filter(this._filterLayerViews,this).map(this.get,this).filter(i=>i!=null).forEach(this._collectLayerViews("layerViews",e)),e}_filterLayerViews(e){const i=!this.basemapLegendVisible&&(e===sde||e===ade),n=!this.groundLegendVisible&&e===ode;return!i&&!n}_collectLayerViews(e,i){const n=r=>(r&&r.forEach(s=>{i.push(s),n(s[e])}),i);return n}_filterLayerViewsByLayerInfos(e){const i=this.layerInfos;return!i||!i.length||i.some(n=>this._hasLayerInfo(n,e))}_hasLayerInfo(e,i){const n=this._isLayerUIDMatching(e.layer,i.layer.uid);return n&&(this._layerInfosByLayerViewId[i.uid]=e),n}_isLayerUIDMatching(e,i){return e&&(e.uid===i||this._hasLayerUID(e.layers,i))}_hasLayerUID(e,i){return e&&e.some(n=>this._isLayerUIDMatching(n,i))}_isLayerViewSupported(e){return!!tqe.includes(e.layer.declaredClass)&&(this._layerViewByLayerId[e.layer.uid]=e,!0)}_generateActiveLayerInfo(e){this._isLayerActive(e)?this._buildActiveLayerInfo(e):(this.removeHandles(e.uid),this.addHandles(Q(()=>{var i;return[e.legendEnabled,(i=e.layer)==null?void 0:i.legendEnabled]},()=>this._layerActiveHandle(e)),e.uid))}_layerActiveHandle(e){this._isLayerActive(e)&&(this.removeHandles(e.uid),this._buildActiveLayerInfo(e))}_isLayerActive(e){return!this.respectLayerVisibility||e.legendEnabled&&e.get("layer.legendEnabled")}_buildActiveLayerInfo(e){var a;const i=e.layer,n=e.uid,r=this._layerInfosByLayerViewId[n];let s=this._activeLayerInfosByLayerViewId[n];if(!s){const l=r&&r.title!==void 0&&r.layer.uid===i.uid;s=new nde({layer:i,layerView:e,title:l?r.title:i.title,view:this.view,respectLayerVisibility:this.respectLayerVisibility,hideLayersNotInCurrentView:this.hideLayersNotInCurrentView,keepCacheOnDestroy:this.keepCacheOnDestroy,sublayerIds:r&&r.sublayerIds||[]}),this._activeLayerInfosByLayerViewId[n]=s}const o=i.parent&&"uid"in i.parent?this._layerViewByLayerId[(a=i.parent)==null?void 0:a.uid]:null;if(s.parent=this._activeLayerInfosByLayerViewId[o==null?void 0:o.uid],!this.hasHandles(n)){const l=[Q(()=>i.title,c=>this._titleHandle(c,s)),Q(()=>[i.opacity,"renderer"in i&&i.renderer,"pointSymbol"in i&&i.pointSymbol,"lineSymbol"in i&&i.lineSymbol,"polygonSymbol"in i&&i.polygonSymbol],()=>this._constructLegendElements(s)),jo(()=>{var c;return((c=this.view)==null?void 0:c.stationary)===!0},()=>this._scaleHandle(s),He),Q(()=>e._effectiveRenderer,()=>this._constructLegendElements(s)),Q(()=>"effect"in i&&i.effect,()=>this._constructLegendElements(s))];if(this.respectLayerVisibility){const c=Q(()=>e.legendEnabled,d=>this._legendEnabledHandle(d,s)),u=Q(()=>i.legendEnabled,d=>this._legendEnabledHandle(d,s));l.push(c,u)}this.addHandles(l,n)}s.isScaleDriven||this._constructLegendElements(s),this._addActiveLayerInfo(s)}_titleHandle(e,i){i.title=e,this._constructLegendElements(i)}_legendEnabledHandle(e,i){e?this._addActiveLayerInfo(i):this._removeActiveLayerInfo(i)}_scaleHandle(e){(e.isScaleDriven||e.hideLayersNotInCurrentView)&&this._constructLegendElements(e)}_addActiveLayerInfo(e){var r;const{layerView:i,layer:n}=e;if(this._isLayerActive(i)&&!this.activeLayerInfos.includes(e)){const s=e.parent;if(s)s.children.includes(e)||s.children.push(e),this._sortActiveLayerInfos(s.children);else{const o=(r=this.layerInfos)==null?void 0:r.some(a=>a.layer.uid===n.uid);n.parent&&"uid"in n.parent&&!o?this._activeLayerInfosWithNoParent.add(e):(this.activeLayerInfos.add(e),this._sortActiveLayerInfos(this.activeLayerInfos))}if(this._activeLayerInfosWithNoParent.length){const o=[];this._activeLayerInfosWithNoParent.forEach(a=>{const l=a.layer.parent,c=l&&"uid"in l?this._layerViewByLayerId[l==null?void 0:l.uid]:null,u=this._activeLayerInfosByLayerViewId[c==null?void 0:c.uid];u&&(o.push(a),a.parent=u)}),o.length&&(this._activeLayerInfosWithNoParent.removeMany(o),o.forEach(a=>this._addActiveLayerInfo(a)))}}}_removeActiveLayerInfo(e){const i=e.parent;i?i.children.remove(e):this.activeLayerInfos.remove(e)}_constructLegendElements(e){const i=e.layer;"featureCollections"in i&&i.featureCollections?e.buildLegendElementsForFeatureCollections(i.featureCollections):"featureReduction"in i&&i.featureReduction&&"renderer"in i.featureReduction&&(i.featureReduction.type==="binning"||i.featureReduction.type==="cluster")?e.buildLegendElementsForFeatureReduction(i.featureReduction):"renderer"in i&&i.renderer&&!("sublayers"in i)?e.buildLegendElementsForRenderer(i.renderer):"url"in i&&i.url?e.buildLegendElementsForTools():e.children.forEach(n=>this._constructLegendElements(n))}};h([p({type:rde})],qa.prototype,"activeLayerInfos",void 0),h([p()],qa.prototype,"basemapLegendVisible",void 0),h([p()],qa.prototype,"groundLegendVisible",void 0),h([p()],qa.prototype,"hideLayersNotInCurrentView",void 0),h([p()],qa.prototype,"keepCacheOnDestroy",void 0),h([p()],qa.prototype,"respectLayerVisibility",void 0),h([p()],qa.prototype,"layerInfos",void 0),h([p({readOnly:!0})],qa.prototype,"state",null),h([p()],qa.prototype,"view",void 0),qa=h([P("esri.widgets.Legend.LegendViewModel")],qa);const nqe=qa,Lt="esri-legend--card",W0="esri-legend",Pe={activated:`${Lt}__carousel-indicator--activated`,base:Lt,stacked:`${W0}--stacked`,carouselTitle:`${Lt}__carousel-title`,indicator:`${Lt}__carousel-indicator`,intervalSeparator:`${Lt}__interval-separator`,imageryLayerStretchedImage:`${Lt}__imagery-layer-image--stretched`,imageLabel:`${Lt}__image-label`,layerCaption:`${Lt}__layer-caption`,labelElement:`${Lt}__label-element`,layerRow:`${Lt}__layer-row`,labelCell:`${Lt}__label-cell`,message:`${Lt}__message`,rampLabel:`${Lt}__ramp-label`,section:`${Lt}__section`,relationshipSection:`${Lt}__relationship-section`,serviceCaptionText:`${Lt}__service-caption-text`,serviceContent:`${Lt}__service-content`,service:`${Lt}__service`,groupLayer:`${Lt}__group-layer`,groupLayerChild:`${Lt}__group-layer-child`,symbol:`${Lt}__symbol`,sizeRampRow:`${Lt}__size-ramp-row`,symbolRow:`${Lt}__symbol-row`,symbolCell:`${Lt}__symbol-cell`,indicatorContainer:`${Lt}__carousel-indicator-container`,intervalSeparatorsContainer:`${Lt}__interval-separators-container`,relationshipLabelContainer:`${Lt}__relationship-label-container`,labelContainer:`${Lt}__label-container`,serviceCaptionContainer:`${Lt}__service-caption-container`,symbolContainer:`${Lt}__symbol-container`,sizeRampContainer:`${Lt}__size-ramp-container`,sizeRampPreview:`${Lt}__size-ramp-preview`,pieChartRampPreview:`${Lt}__pie-chart-ramp-preview`,rampContainer:`${W0}__ramps`,sizeRampHorizontal:`${W0}__size-ramp--horizontal`,rampLabelsContainer:`${W0}__ramp-labels`,layerInfo:`${W0}__layer-cell ${W0}__layer-cell--info`,univariateAboveAndBelowColorRamp:"esri-univariate-above-and-below-ramp__color--card",hidden:"esri-hidden"},rqe=bA(),lde=10,F8=20,vk=10,z8=20,V8={univariateAboveAndBelowSymbol:"esri-univariate-above-and-below-ramp__symbol",colorRamp:"esri-legend__color-ramp"};function sqe(t="vertical"){const e="stroke:rgb(200, 200, 200);stroke-width:1";return t==="vertical"?O("svg",{height:"4",width:"10"},O("line",{x1:"0",y1:"2",x2:"10",y2:"2",style:e})):O("svg",{height:"10",width:"10"},O("line",{x1:"5",y1:"0",x2:"5",y2:"10",style:e}))}function oqe(t,e="vertical"){const i=document.createElement("div");return i.style.height=`${F8}px`,i.className=V8.univariateAboveAndBelowSymbol,t!=null&&(i.style.opacity=t.toString()),rqe.append(i,sqe.bind(null,e)),i}function cde(t,e,i="vertical",n){t.infos.forEach((r,s)=>{if(n&&s===2)r.preview=oqe(e,i);else{const o=Gi(r.size)+(i==="horizontal"?z8:vk),a=r.preview,l=(a==null?void 0:a.tagName.toLowerCase())==="div",c=l?a:document.createElement("div");c.className=V8.univariateAboveAndBelowSymbol,i==="horizontal"?c.style.width=`${o}px`:c.style.height=`${o}px`,!l&&a&&c.appendChild(a),r.preview=c}})}function v$(t,e="classic"){const i=t.infos;return e==="classic"?(Gi(i[0].size)+vk)/2:(Gi(i[0].size)-Gi(i[i.length-1].size))/2}function V_(t,e){if(!t)return null;const i=t.infos.map(r=>r.color),n=$g(e.type==="full"?i:e.type==="above"?i.slice(0,3):i.slice(2,5),{width:e.width,height:e.height,align:e.rampAlignment,effectList:e.effectList,ariaLabel:e.ariaLabel});return n.className=V8.colorRamp,e.opacity!=null&&(n.style.opacity=e.opacity.toString()),n}function VF(t,e,i,n="vertical"){let r=0;const s=t.infos,o=Math.floor(s.length/2),a=e==="full"||e==="above"?0:o,l=e==="full"||e==="below"?s.length-1:o;for(let c=a;c<=l;c++)i&&c===o?r+=n==="horizontal"?lde:F8:r+=Gi(s[c].size)+(n==="horizontal"?z8:vk);return Math.round(r)}function j_(t,e,i,n="vertical"){const r=VF(t,e,i,n),s=t.infos,o=Math.floor(s.length/2),a=e==="full"||e==="above"?0:o,l=e==="full"||e==="below"?s.length-1:o,c=e==="full"?s[a].size+s[l].size:e==="above"?s[a].size:s[l].size,u=i?n==="vertical"?F8:lde:0,d=n==="vertical"?vk*(e==="full"?2:1):z8*(e==="full"?2:1);return Math.round(r-(Gi(c)/2+u/2+d/2))}function ude(t,e,i="vertical"){const n=t.infos;let r=n.find(({type:o})=>o==="size-ramp"),s=n.find(({type:o})=>o==="color-ramp");return r&&(r={...r},r.infos=[...r.infos],cde(r,e,i,!0)),s&&(s={...s},s.infos=[...s.infos]),i==="horizontal"&&(r==null||r.infos.reverse(),s==null||s.infos.reverse()),{sizeRampElement:r,colorRampElement:s}}function hde(t,e="vertical"){const i=t.infos;let n=i.find(({type:s})=>s==="size-ramp"),r=i.find(({type:s})=>s==="color-ramp");return n&&(n={...n},n.infos=[...n.infos],cde(n,null,e,!1)),r&&(r={...r},r.infos=[...r.infos]),e==="horizontal"&&(n==null||n.infos.reverse(),r==null||r.infos.reverse()),{sizeRampElement:n,colorRampElement:r}}function aqe(t,e){return e}function yr(t){const e=this;t.appendChild(e)}function yf(t,e,i){if(!e)return;if(typeof e=="string"||typeof e=="number")return e;if("value"in e||"unit"in e)return Ru(t.dotValue,e);if("colorName"in e&&"bandName"in e)return t[e.colorName]+": "+(t[e.bandName]||e.bandName);if("showCount"in e)return e.showCount?t.clusterCountTitle:void 0;let n=null;return aqe(e,i)?n=e.ratioPercentTotal?"showRatioPercentTotal":e.ratioPercent?"showRatioPercent":e.ratio?"showRatio":e.normField?"showNormField":e.field?"showField":null:dde(e,i)&&(n=e.normField?"showNormField":e.normByPct?"showNormPct":e.field?"showField":null),n?Ru(n==="showField"?"{field}":t[n],{field:e.field,normField:e.normField}):void 0}function dde(t,e){return!e}function pde(t,e){return!!(e&&e==="Stretched"&&t.version>=10.3&&t.declaredClass==="esri.layers.ImageryLayer")}const lqe=25,cqe=25,uqe=768,hqe=100;var l2;(function(t){t.Auto="auto",t.Stack="stack",t.SideBySide="side-by-side"})(l2||(l2={}));const dqe="#ddd",J0=window.devicePixelRatio;function pqe(t){if(t){if(t.type.includes("3d")){const e=t.symbolLayers&&t.symbolLayers.length;if(!e)return;const i=t.symbolLayers.at(e-1),n=i.resource&&i.resource.primitive;return n==="circle"||n==="cross"||n==="kite"||n==="sphere"||n==="cube"||n==="diamond"}{const e=t.style;return e==="circle"||e==="diamond"||e==="cross"}}}function fqe(t){if(t){if(t.type.includes("3d")){const e=t.symbolLayers&&t.symbolLayers.length;if(!e)return;const i=t.symbolLayers.at(e-1).get("resource.primitive");return i==="triangle"||i==="cone"||i==="tetrahedron"}return t.style==="triangle"}}let Kl=class extends qi{constructor(e,i){super(e,i),this._hasIndicators=!1,this._selectedSectionName=null,this._sectionNames=[],this._sectionMap=new Map,this.activeLayerInfos=null,this.headingLevel=3,this.layout=l2.Stack,this.messages=null,this.messagesCommon=null,this.type="card",this.view=null}initialize(){this.addHandles(Q(()=>this.activeLayerInfos,e=>{this.removeAllHandles(),this._watchForSectionChanges(e)}))}render(){const{view:e}=this;this._hasIndicators=this.layout===l2.Auto&&e&&e.container.clientWidth<=uqe||this.layout===l2.Stack;const i=this.activeLayerInfos,n=i&&i.toArray().map(c=>this._renderLegendForLayer(c)).filter(c=>!!c);this._hasIndicators?this._selectedSectionName&&this._sectionNames.includes(this._selectedSectionName)||(this._selectedSectionName=this._sectionNames&&this._sectionNames[0]):this._selectedSectionName=null;const r=this._sectionNames.length,s=this._sectionNames.map((c,u)=>{const d=Ru(this.messagesCommon.pagination.pageText,{index:u+1,total:r});return O("div",{key:c,role:"tab",id:c,"aria-label":d,"aria-controls":`${c}-panel`,"aria-selected":(this._selectedSectionName===c).toString(),tabIndex:this._selectedSectionName===c?0:-1,title:d,onclick:this._selectSection,onkeydown:this._focusSection,bind:this,class:this.classes(Pe.indicator,{[Pe.activated]:this._selectedSectionName===c}),"data-section-name":c})}),o=this._hasIndicators&&r>1?O("div",{class:Pe.indicatorContainer,key:"carousel-navigation",role:"tablist"},s):null,a=this._hasIndicators?this._sectionMap.get(this._selectedSectionName):n&&n.length?n:null,l={[Pe.stacked]:this._hasIndicators};return O("div",{class:this.classes(Pe.base,l)},a||O("div",{class:Pe.message},this.messages.noLegend),o)}_selectSection(e){const i=e.target.getAttribute("data-section-name");i&&(this._selectedSectionName=i)}_focusSection(e){switch(e.key){case"ArrowLeft":case"ArrowRight":this._switchSectionOnArrowPress(e);break;case"Enter":case" ":this._selectSection(e)}}_switchSectionOnArrowPress(e){const i=e.key,n=i==="ArrowLeft"?-1:1,r=e.target.getAttribute("data-section-name"),s=this._sectionNames.indexOf(r),o=this._sectionNames;let a=null;s!==-1&&(o[s+n]?a=document.getElementById(o[s+n]):i==="ArrowLeft"?a=document.getElementById(o[o.length-1]):i==="ArrowRight"&&(a=document.getElementById(o[0])),a==null||a.focus())}_watchForSectionChanges(e){if(this._generateSectionNames(),e){e.forEach(n=>{const r=`activeLayerInfo-${n.layer.uid}-version-change`;this.removeHandles(r),this._watchForSectionChanges(n.children),this.addHandles(Q(()=>n.version,()=>this._generateSectionNames()),r)});const i="activeLayerInfos-collection-change";this.removeHandles(i),this.addHandles(e.on("change",()=>this._watchForSectionChanges(e)),i)}}_generateSectionNames(){this._sectionNames.length=0,this._selectedSectionName=null,this.activeLayerInfos&&this.activeLayerInfos.forEach(this._generateSectionNamesForActiveLayerInfo,this)}_getSectionName(e,i,n){return`${this.id}${e.uid}-type-${i.type}-${n}`}_generateSectionNamesForActiveLayerInfo(e){e.children.forEach(this._generateSectionNamesForActiveLayerInfo,this),e.legendElements&&e.legendElements.forEach((i,n)=>{this._sectionNames.push(this._getSectionName(e.layer,i,n))})}_renderLegendForLayer(e){if(!e.ready)return null;if(e.children.length){const i=e.children.map(n=>this._renderLegendForLayer(n)).toArray();return O("div",{key:e.layer.uid,class:this.classes(Pe.service,Pe.groupLayer)},O("div",{class:Pe.serviceCaptionContainer},e.title),i)}{const i=e.legendElements;if(i&&!i.length)return null;const n=i.some(o=>o.type==="relationship-ramp"),r=i.map((o,a)=>this._renderLegendForElement(o,e,a,n)).filter(o=>!!o);if(!r.length)return null;const s={[Pe.groupLayerChild]:!!e.parent};return O("div",{key:e.layer.uid,class:this.classes(Pe.service,s)},O("div",{class:Pe.serviceCaptionContainer},O("div",{class:Pe.serviceCaptionText},e.title)),O("div",{class:Pe.serviceContent},r))}}_renderLegendForElement(e,i,n,r=!1,s=!1){const o=e.type==="color-ramp",a=e.type==="opacity-ramp",l=e.type==="size-ramp",c=i.layer;let u=null;if(typeof e.title=="string")u=e.title;else if(e.title){const _=e.title,b=yf(this.messages,_,o||a);u=_.title?`${_.title} (${b})`:b}const d=this._getSectionName(c,e,n),f=this._hasIndicators&&!s?O("div",null,O(o2,{level:this.headingLevel,class:Pe.carouselTitle},i.title),O(o2,{level:Z7e(this.headingLevel),class:Pe.layerCaption},u)):u?O(o2,{level:this.headingLevel,class:Pe.layerCaption},u):null,m=i.effectList;let g=null;if(e.type==="symbol-table"){const _=e.infos.map((b,w)=>this._renderLegendForElementInfo(b,i,e.legendType,w)).filter(b=>!!b);if(_.length){const b=_[0].properties.classes&&_[0].properties.classes[Pe.symbolRow],w={[Pe.labelContainer]:!b&&!r,[Pe.relationshipLabelContainer]:r};g=O("div",{class:this.classes(w)},_)}}else e.type==="color-ramp"||e.type==="opacity-ramp"||e.type==="heatmap-ramp"?g=this._renderLegendForRamp(e,c.opacity,m):l?g=this._renderSizeRamp(e,c.opacity):e.type==="pie-chart-ramp"?g=this._renderPieChartRamp(e):e.type==="relationship-ramp"?g=Ihe(e,this.id,{opacity:c.opacity,effectList:m,ariaLabel:this.messages.previewRelationshipRampAriaLabel}):e.type==="univariate-above-and-below-ramp"?g=this._renderUnivariateAboveAndBelowRamp(e,c.opacity,m):e.type==="univariate-color-size-ramp"&&(g=this._renderUnivariateColorSizeRamp(e,c.opacity,m));if(!g)return null;const y=O("div",{key:d,class:Pe.section,id:`${d}-panel`,role:"tabpanel","aria-labelledby":d,tabIndex:0},[f,g]);return s||this._sectionMap.set(d,y),y}_renderPieChartRamp(e){return O("div",{class:Pe.pieChartRampPreview,bind:e.preview,afterCreate:yr})}_renderUnivariateAboveAndBelowRamp(e,i,n){var T;const{sizeRampElement:r,colorRampElement:s}=ude(e,i,"horizontal");if(!r)return null;const o=VF(r,"full",!0,"horizontal"),a=j_(r,"above",!0,"horizontal"),l=j_(r,"below",!0,"horizontal"),c=12,u=(T=this.messages)==null?void 0:T.previewColorRampAriaLabel,d=V_(s,{width:a,height:c,rampAlignment:"horizontal",opacity:i,type:"above",effectList:n,ariaLabel:u}),f=V_(s,{width:l,height:c,rampAlignment:"horizontal",opacity:i,type:"below",effectList:n,ariaLabel:u}),m=v$(r,"card"),g=r.infos.map(I=>I.label),y=g.length-1,_=g.map((I,C)=>C===0||C===y?O("div",{key:C},I):null),b={display:"flex",flexDirection:"column"},w={display:"flex",flexDirection:"row"},x={marginTop:"3px",display:"flex"};Mc(this.container)?x.marginRight=`${m}px`:x.marginLeft=`${m}px`;const S={width:`${o}px`,display:"flex",flexDirection:"row",justifyContent:"space-between"};return O("div",{class:Pe.layerRow,key:"size-ramp-preview",styles:b},O("div",{class:this.classes(Pe.symbolContainer,Pe.sizeRampHorizontal),styles:w},r.infos.map((I,C)=>O("div",{key:C,class:Pe.symbol,bind:I.preview,afterCreate:yr}))),d?O("div",{class:Pe.univariateAboveAndBelowColorRamp,styles:x,key:"color-ramp-preview"},O("div",{bind:d,afterCreate:yr}),O("div",{bind:f,afterCreate:yr})):null,O("div",{class:Pe.layerInfo},O("div",{class:Pe.rampLabelsContainer,styles:S},_)))}_renderUnivariateColorSizeRamp(e,i,n){var _;const{sizeRampElement:r,colorRampElement:s}=hde(e,"horizontal");if(!r)return null;const o=VF(r,"full",!1,"horizontal"),a=j_(r,"full",!1,"horizontal"),l=V_(s,{width:a,height:12,rampAlignment:"horizontal",opacity:i,type:"full",effectList:n,ariaLabel:(_=this.messages)==null?void 0:_.previewColorRampAriaLabel}),c=v$(r,"card"),u=r.infos.length-1,d=r.infos.map((b,w)=>w===0||w===u?O("div",{key:w},b.label):null),f={display:"flex",flexDirection:"column"},m={display:"flex",flexDirection:"row"},g={marginTop:"3px",display:"flex"};Mc(this.container)?g.marginRight=`${c}px`:g.marginLeft=`${c}px`;const y={width:`${o}px`,display:"flex",flexDirection:"row",justifyContent:"space-between"};return O("div",{class:Pe.layerRow,key:"size-ramp-preview",styles:f},O("div",{class:this.classes(Pe.symbolContainer,Pe.sizeRampHorizontal),styles:m},r.infos.map((b,w)=>O("div",{key:w,class:Pe.symbol,bind:b.preview,afterCreate:yr}))),O("div",{class:Pe.univariateAboveAndBelowColorRamp,styles:g,key:"color-ramp-preview"},O("div",{bind:l,afterCreate:yr})),O("div",{class:Pe.layerInfo},O("div",{class:Pe.rampLabelsContainer,styles:y},d)))}_renderLegendForElementInfo(e,i,n,r){var a;const s=i.layer;if(e.type)return this._renderLegendForElement(e,i,r,!1,!0);const o=pde(s,n);if(e.preview){if(!e.symbol||!e.symbol.type.includes("simple-fill")){if(!e.label)return O("div",{key:r,bind:e.preview,afterCreate:yr});const T={[Pe.symbolCell]:this._hasIndicators};return O("div",{key:r,class:this.classes(Pe.layerRow,{[Pe.symbolRow]:this._hasIndicators})},O("div",{class:this.classes(T),bind:e.preview,afterCreate:yr}),O("div",{class:this.classes(Pe.imageLabel,{[Pe.labelCell]:this._hasIndicators})},yf(this.messages,e.label,!1)||""))}let l=255,c=255,u=255,d=0,f=255,m=255,g=255,y=0;const _=e.symbol.color&&e.symbol.color.a,b=e.symbol.outline&&e.symbol.outline.color&&e.symbol.outline.color.a;_&&(l=e.symbol.color.r,c=e.symbol.color.g,u=e.symbol.color.b,d=e.symbol.color.a*s.opacity),b&&(f=e.symbol.outline.color.r,m=e.symbol.outline.color.g,g=e.symbol.outline.color.b,y=e.symbol.outline.color.a*s.opacity);const w=((a=e.symbol.color)==null?void 0:a.isBright)??!0,x=w?"rgba(255, 255, 255, .6)":"rgba(0, 0, 0, .6)",S={background:_?`rgba(${l}, ${c}, ${u}, ${d})`:"none",color:w?"black":"white",textShadow:`-1px -1px 0 ${x},
                                              1px -1px 0 ${x},
                                              -1px 1px 0 ${x},
                                              1px 1px 0 ${x}`,border:b?`1px solid rgba(${f}, ${m}, ${g}, ${y})`:"none",filter:iS(i.effectList)??void 0};return O("div",{key:r,class:Pe.layerRow},O("div",{class:Pe.labelElement,styles:S}," ",e.label," "))}if(e.src){const l=this._renderImage(e,s,o);return O("div",{key:r,class:Pe.layerRow},l,O("div",{class:Pe.imageLabel},e.label||""))}}_renderImage(e,i,n){const{label:r,src:s,opacity:o}=e,a={[Pe.imageryLayerStretchedImage]:n,[Pe.symbol]:!n},l={opacity:`${o??i.opacity}`};return O("img",{alt:yf(this.messages,r,!1),"aria-label":yf(this.messages,r,!1),src:s,border:0,width:e.width,height:e.height,class:this.classes(a),styles:l})}_renderSizeRampLines(e){const i=e.infos,n=i[0],r=i[i.length-1],s=n.symbol,o=this._hasIndicators,a=Gi(n.size+n.outlineSize)*J0,l=Gi(r.size+r.outlineSize)*J0,c=o?a:a+50*J0,u=o?a/2+50*J0:a,d=fqe(s),f=pqe(s),m=document.createElement("canvas");m.width=c,m.height=u,m.style.width=m.width/J0+"px",m.style.height=m.height/J0+"px";const g=m.getContext("2d");if(o){g.beginPath();const y=0,_=0,b=c/2-l/2,w=u;g.moveTo(y,_),g.lineTo(b,w);const x=c,S=0,T=c/2+l/2,I=u;g.moveTo(x,S),g.lineTo(T,I)}else{g.beginPath();const y=0,_=u/2-l/2,b=c,w=0;g.moveTo(y,_),g.lineTo(b,w);const x=0,S=u/2+l/2,T=c,I=u;g.moveTo(x,S),g.lineTo(T,I)}return g.strokeStyle=dqe,g.stroke(),O("div",{bind:m,afterCreate:yr,styles:o?{display:"flex",marginTop:`-${d?0:f?a/2:0}px`,marginBottom:`-${d?l:f?l/2:0}px`}:{display:"flex",marginRight:`-${d?0:f?a/2:0}px`,marginLeft:`-${d?0:f?l/2:0}px`}})}_renderSizeRamp(e,i){const n=e.infos,r=n[0].label,s=n[n.length-1].label;let o=n[0].preview,a=n[n.length-1].preview;const l=this._hasIndicators,c={"flex-direction":l?"column":"row-reverse"};o&&(o=o.cloneNode(!0),o.style.display="flex"),a&&(a=a.cloneNode(!0),a.style.display="flex");const u={opacity:i!=null?`${i}`:""};return O("div",{class:this.classes(Pe.layerRow,{[Pe.sizeRampRow]:l})},O("div",{class:Pe.rampLabel},l?r:s),O("div",{class:Pe.sizeRampContainer,styles:c},O("div",{bind:o,afterCreate:yr,class:Pe.sizeRampPreview,styles:u}),this._renderSizeRampLines(e),O("div",{bind:a,afterCreate:yr,class:Pe.sizeRampContainer,styles:u})),O("div",{class:Pe.rampLabel},l?s:r))}_renderLegendForRamp(e,i,n){const r=e.infos,s=e.type==="heatmap-ramp",o=r.length-1,a=cqe,l=o>2&&!s?lqe*o:hqe,c=l+20,u=10,d=r.slice(0).reverse();d.forEach((I,C)=>{I.offset=s?I.ratio:C/o});const f=d.length-1,m=d.length%2!=0&&d[d.length/2|0],g=m&&O("div",{class:Pe.intervalSeparatorsContainer},O("div",{class:Pe.intervalSeparator},"|"),O("div",{class:Pe.rampLabel},m.label)),y=r[r.length-1].label,_=r[0].label,b=[[{shape:{type:"path",path:`M0 ${a/2} L${u} 0 L${u} ${a} Z`},fill:d[0].color,stroke:{width:0}},{shape:{type:"rect",x:u,y:0,width:l,height:a},fill:{type:"linear",x1:u,y1:0,x2:l+u,y2:0,colors:d},stroke:{width:0}},{shape:{type:"path",path:`M${l+u} 0 L${c} ${a/2} L${l+u} ${a} Z`},fill:d[f].color,stroke:{width:0}}]],w=She(b,c,a),{messages:x}=this,S={filter:iS(n)??void 0,opacity:i==null?void 0:`${i}`},T={justifyContent:"center"};return O("div",{class:Pe.layerRow,styles:T},O("div",{class:Pe.rampLabel},s?x[y]:y),O("div",{class:Pe.symbolContainer},O("div",{styles:S},w),g),O("div",{class:Pe.rampLabel},s?x[_]:_))}};h([p()],Kl.prototype,"activeLayerInfos",void 0),h([p()],Kl.prototype,"headingLevel",void 0),h([p()],Kl.prototype,"layout",void 0),h([p(),Zt("esri/widgets/Legend/t9n/Legend")],Kl.prototype,"messages",void 0),h([p(),Zt("esri/t9n/common")],Kl.prototype,"messagesCommon",void 0),h([p({readOnly:!0})],Kl.prototype,"type",void 0),h([p()],Kl.prototype,"view",void 0),h([Dr()],Kl.prototype,"_selectSection",null),Kl=h([P("esri.widgets.Legend.styles.Card")],Kl);const lL=Kl,Qt="esri-legend",Be={service:`${Qt}__service`,label:`${Qt}__service-label`,layer:`${Qt}__layer`,groupLayer:`${Qt}__group-layer`,groupLayerChild:`${Qt}__group-layer-child`,layerTable:`${Qt}__layer-table`,layerTableSizeRamp:`${Qt}__layer-table--size-ramp`,layerChildTable:`${Qt}__layer-child-table`,layerCaption:`${Qt}__layer-caption`,layerBody:`${Qt}__layer-body`,layerRow:`${Qt}__layer-row`,layerCell:`${Qt}__layer-cell`,layerInfo:`${Qt}__layer-cell ${Qt}__layer-cell--info`,imageryLayerStretchedImage:`${Qt}__imagery-layer-image--stretched`,imageryLayerCellStretched:`${Qt}__imagery-layer-cell--stretched`,imageryLayerInfoStretched:`${Qt}__imagery-layer-info--stretched`,symbolContainer:`${Qt}__layer-cell esri-legend__layer-cell--symbols`,symbol:`${Qt}__symbol`,rampContainer:`${Qt}__ramps`,sizeRamp:`${Qt}__size-ramp`,colorRamp:`${Qt}__color-ramp`,opacityRamp:`${Qt}__opacity-ramp`,borderlessRamp:`${Qt}__borderless-ramp`,rampTick:`${Qt}__ramp-tick`,rampFirstTick:`${Qt}__ramp-tick-first`,rampLastTick:`${Qt}__ramp-tick-last`,rampLabelsContainer:`${Qt}__ramp-labels`,rampLabel:`${Qt}__ramp-label`,univariateAboveAndBelowSymbol:"esri-univariate-above-and-below-ramp__symbol",univariateAboveAndBelowLabel:"esri-univariate-above-and-below-ramp__label",message:`${Qt}__message`,header:"esri-widget__heading",hidden:"esri-hidden"},mqe=`${Qt}__`,gqe=24,ZJ={display:"flex",alignItems:"flex-start"},cL={marginLeft:"3px"},Z0={display:"table-cell",verticalAlign:"middle"};let Pg=class extends qi{constructor(e,i){super(e,i),this.activeLayerInfos=null,this.headingLevel=3,this.messages=null,this.type="classic"}render(){const e=this.activeLayerInfos,i=e&&e.toArray().map(n=>this._renderLegendForLayer(n)).filter(n=>!!n);return O("div",null,i&&i.length?i:O("div",{class:Be.message},this.messages.noLegend))}_renderLegendForLayer(e){if(!e.ready)return null;const i=!!e.children.length,n=`${mqe}${e.layer.uid}-version-${e.version}`,r=e.title?o2({level:this.headingLevel,class:this.classes(Be.header,Be.label)},e.title):null;if(i){const s=e.children.map(o=>this._renderLegendForLayer(o)).toArray();return O("div",{key:n,class:this.classes(Be.service,Be.groupLayer)},r,s)}{const s=e.legendElements;if(s&&!s.length)return null;const o=s.map(l=>this._renderLegendForElement(l,e.layer,e.effectList)).filter(l=>!!l);if(!o.length)return null;const a={[Be.groupLayerChild]:!!e.parent};return O("div",{key:n,class:this.classes(Be.service,a),tabIndex:0},r,O("div",{class:Be.layer},o))}}_renderLegendForElement(e,i,n,r){const s=e.type==="color-ramp",o=e.type==="opacity-ramp",a=e.type==="size-ramp";let l=null;if(e.type==="symbol-table"||a){const g=e.infos.map(y=>this._renderLegendForElementInfo(y,i,n,a,e.legendType)).filter(y=>!!y);g.length&&(l=O("div",{class:Be.layerBody},g))}else e.type==="color-ramp"||e.type==="opacity-ramp"||e.type==="heatmap-ramp"||e.type==="stretch-ramp"?l=this._renderLegendForRamp(e,i.opacity):e.type==="relationship-ramp"?l=Ihe(e,this.id,{opacity:i.opacity,effectList:n,ariaLabel:this.messages.previewRelationshipRampAriaLabel}):e.type==="pie-chart-ramp"?l=this._renderPieChartRamp(e):e.type==="univariate-above-and-below-ramp"?l=this._renderUnivariateAboveAndBelowRamp(e,i.opacity,n):e.type==="univariate-color-size-ramp"&&(l=this._renderUnivariateColorSizeRamp(e,i.opacity,n));if(!l)return null;const c=e.title;let u=null;if(typeof c=="string")u=c;else if(c){const g=yf(this.messages,c,s||o);u=dde(c,s||o)&&c.title?`${c.title} (${g})`:g}const d=r?Be.layerChildTable:Be.layerTable,f=u?O("div",{class:Be.layerCaption},u):null,m={[Be.layerTableSizeRamp]:a||!r};return O("div",{class:this.classes(d,m)},f,l)}_renderPieChartRamp(e){return O("div",{bind:e.preview,afterCreate:yr})}_renderUnivariateAboveAndBelowRamp(e,i,n){var I;const{sizeRampElement:r,colorRampElement:s}=ude(e,i);if(!r)return null;const o=(I=this.messages)==null?void 0:I.previewColorRampAriaLabel,a=j_(r,"above",!0),l=j_(r,"below",!0),c=12,u=V_(s,{width:c,height:a,rampAlignment:"vertical",opacity:i,type:"above",effectList:n,ariaLabel:o}),d=V_(s,{width:c,height:l,rampAlignment:"vertical",opacity:i,type:"below",effectList:n,ariaLabel:o}),f=v$(r),m=r.infos.map(C=>C.label),g=m.map((C,M)=>M===0?O("div",{key:M,class:C?u?Be.univariateAboveAndBelowLabel:Be.rampLabel:void 0},C):M===2?O("div",null):null),y=m.length-1,_=Math.floor(m.length/2),b=m.map((C,M)=>M===_||M===y?O("div",{key:M,class:C?u?Be.univariateAboveAndBelowLabel:Be.rampLabel:void 0},C):null),w={display:"table-cell",verticalAlign:"middle"},x={marginTop:`${f}px`},S={height:`${a}px`},T={height:`${l}px`};return O("div",{key:"univariate-above-and-below-ramp-preview",styles:ZJ},O("div",{class:Be.layerBody},r.infos.map((C,M)=>O("div",{class:this.classes(Be.layerRow,Be.sizeRamp)},O("div",{class:Be.symbol,styles:w,bind:C.preview,afterCreate:yr}),u||M%2!=0?null:O("div",{class:Be.layerInfo},m[M])))),u?O("div",{styles:x,key:"color-ramp-preview"},O("div",{styles:cL},O("div",{styles:Z0},O("div",{class:Be.rampContainer,bind:u,afterCreate:yr})),O("div",{styles:Z0},O("div",{class:Be.rampLabelsContainer,styles:S},g))),O("div",{styles:cL},O("div",{styles:Z0},O("div",{class:Be.rampContainer,bind:d,afterCreate:yr})),O("div",{styles:Z0},O("div",{class:Be.rampLabelsContainer,styles:T},b)))):null)}_renderUnivariateColorSizeRamp(e,i,n){var y;const{sizeRampElement:r,colorRampElement:s}=hde(e);if(!r)return null;const o=v$(r),a=12,l=j_(r,"full",!1),c=V_(s,{width:a,height:l,rampAlignment:"vertical",opacity:i,type:"full",effectList:n,ariaLabel:(y=this.messages)==null?void 0:y.previewColorRampAriaLabel}),u=r.infos.length-1,d=r.infos.map((_,b)=>b===0||b===u?O("div",{key:b,class:_.label?s?Be.univariateAboveAndBelowLabel:Be.rampLabel:void 0},_.label):null),f={display:"table-cell",verticalAlign:"middle"},m={marginTop:`${o}px`},g={height:`${l}px`};return O("div",{key:"univariate-above-and-below-ramp-preview",styles:ZJ},O("div",{class:Be.layerBody},r.infos.map(_=>O("div",{class:this.classes(Be.layerRow,Be.sizeRamp)},O("div",{class:Be.symbol,styles:f,bind:_.preview,afterCreate:yr})))),O("div",{styles:m,key:"color-ramp-preview"},O("div",{styles:cL},O("div",{styles:Z0},O("div",{class:Be.rampContainer,bind:c,afterCreate:yr})),O("div",{styles:Z0},O("div",{class:Be.rampLabelsContainer,styles:g},d)))))}_renderLegendForRamp(e,i){const n=e.infos,r=e.type==="opacity-ramp",s=e.type==="heatmap-ramp",o=e.type==="stretch-ramp",a=e.preview,l=r?Be.opacityRamp:"";a.className=`${Be.colorRamp} ${l}`,i!=null&&(a.style.opacity=i.toString());const c=n.map(f=>O("div",{class:f.label?Be.rampLabel:void 0},s?this.messages[f.label]||f.label:o?this._getStretchStopLabel(f):f.label)),u={width:`${gqe}px`},d={height:a.style.height};return O("div",{class:Be.layerRow},O("div",{class:Be.symbolContainer,styles:u},O("div",{class:Be.rampContainer,bind:a,afterCreate:yr})),O("div",{class:Be.layerInfo},O("div",{class:Be.rampLabelsContainer,styles:d},c)))}_getStretchStopLabel(e){return e.label?this.messages[e.label]+": "+(typeof e.value=="string"?e.value:Ns(e.value,{style:"decimal",notation:e.value.toString().includes("e")?"scientific":"standard"})):""}_renderLegendForElementInfo(e,i,n,r,s){if(e.type)return this._renderLegendForElement(e,i,n,!0);let o=null;const a=pde(i,s);if(e.preview?o=O("div",{class:Be.symbol,bind:e.preview,afterCreate:yr}):e.src&&(o=this._renderImage(e,i,a)),!o)return null;const l={[Be.imageryLayerInfoStretched]:a},c={[Be.imageryLayerInfoStretched]:a,[Be.sizeRamp]:!a&&r};return O("div",{class:Be.layerRow},O("div",{class:this.classes(Be.symbolContainer,c)},o),O("div",{class:this.classes(Be.layerInfo,l)},yf(this.messages,e.label,!1)||""))}_renderImage(e,i,n){const{label:r,src:s,opacity:o}=e,a={[Be.imageryLayerStretchedImage]:n,[Be.symbol]:!n},l={opacity:`${o??i.opacity}`};return O("img",{alt:yf(this.messages,r,!1),"aria-label":yf(this.messages,r,!1),src:s,border:0,width:e.width,height:e.height,class:this.classes(a),styles:l})}};h([p()],Pg.prototype,"activeLayerInfos",void 0),h([p()],Pg.prototype,"headingLevel",void 0),h([p(),Zt("esri/widgets/Legend/t9n/Legend")],Pg.prototype,"messages",void 0),h([p({readOnly:!0})],Pg.prototype,"type",void 0),Pg=h([P("esri.widgets.Legend.styles.Classic")],Pg);const Y0=Pg,rC={base:"esri-legend",widget:"esri-widget",panel:"esri-widget--panel",widgetIcon:"esri-icon-layer-list"};let gr=class extends qi{constructor(e,i){super(e,i),this.headingLevel=3,this.iconClass=rC.widgetIcon,this.icon=null,this.messages=null,this.style=new Y0,this.viewModel=new nqe}initialize(){this.addHandles([on(()=>this.view,"resize",()=>this.scheduleRender()),on(()=>this.activeLayerInfos,"change",()=>this._refreshActiveLayerInfos(this.activeLayerInfos)),Q(()=>this.headingLevel,e=>{const{style:i}=this;i&&(i.headingLevel=e)}),Q(()=>this.style,(e,i)=>{i&&e!==i&&i.destroy(),e&&(e.activeLayerInfos=this.activeLayerInfos,e.type==="card"&&(e.view=this.view),e.headingLevel=this.headingLevel)},He)])}get activeLayerInfos(){return this.viewModel.activeLayerInfos}set activeLayerInfos(e){this.viewModel.activeLayerInfos=e}get basemapLegendVisible(){return this.viewModel.basemapLegendVisible}set basemapLegendVisible(e){this.viewModel.basemapLegendVisible=e}get groundLegendVisible(){return this.viewModel.groundLegendVisible}set groundLegendVisible(e){this.viewModel.groundLegendVisible=e}get hideLayersNotInCurrentView(){return this.viewModel.hideLayersNotInCurrentView}set hideLayersNotInCurrentView(e){this.viewModel.hideLayersNotInCurrentView=e}get keepCacheOnDestroy(){return this.viewModel.keepCacheOnDestroy}set keepCacheOnDestroy(e){this.viewModel.keepCacheOnDestroy=e}get respectLayerVisibility(){return this.viewModel.respectLayerVisibility}set respectLayerVisibility(e){this.viewModel.respectLayerVisibility=e}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get layerInfos(){return this.viewModel.layerInfos}set layerInfos(e){this.viewModel.layerInfos=e}castStyle(e){if(e instanceof lL||e instanceof Y0)return e;if(typeof e=="string")return e==="card"?new lL:new Y0;if(e&&typeof e.type=="string"){const i={...e};return delete i.type,new(e.type==="card"?lL:Y0)(i)}return new Y0}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){return O("div",{class:this.classes(rC.base,rC.widget,this.style instanceof Y0?rC.panel:null)},this.style.render())}_refreshActiveLayerInfos(e){e.forEach(i=>{this.removeHandles(`version_${i.layer.uid}`),this._renderOnActiveLayerInfoChange(i)}),this.scheduleRender()}_renderOnActiveLayerInfoChange(e){const i=Q(()=>e.version,()=>this.scheduleRender());this.addHandles(i,`version_${e.layer.uid}`);const n=on(()=>e.children,"change",()=>e.children.forEach(r=>this._renderOnActiveLayerInfoChange(r)),He);this.addHandles(n,`version_${e.layer.uid}`),e.children.forEach(r=>this._renderOnActiveLayerInfoChange(r))}};h([p()],gr.prototype,"activeLayerInfos",null),h([p()],gr.prototype,"basemapLegendVisible",null),h([p()],gr.prototype,"groundLegendVisible",null),h([p()],gr.prototype,"headingLevel",void 0),h([p()],gr.prototype,"hideLayersNotInCurrentView",null),h([p()],gr.prototype,"keepCacheOnDestroy",null),h([p()],gr.prototype,"respectLayerVisibility",null),h([p()],gr.prototype,"iconClass",void 0),h([p()],gr.prototype,"icon",void 0),h([p()],gr.prototype,"label",null),h([p()],gr.prototype,"layerInfos",null),h([p(),Zt("esri/widgets/Legend/t9n/Legend")],gr.prototype,"messages",void 0),h([p()],gr.prototype,"style",void 0),h([ut("style")],gr.prototype,"castStyle",null),h([p()],gr.prototype,"view",null),h([p()],gr.prototype,"viewModel",void 0),gr=h([P("esri.widgets.Legend")],gr);const fde=gr,yqe=Object.freeze(Object.defineProperty({__proto__:null,default:fde},Symbol.toStringTag,{value:"Module"}));var jF;let Pp=jF=class extends GS{constructor(t){super(t),this.displayValueEnabled=!1,this.max=1,this.min=0,this.step=.1,this.type="slider",this.value=null}clone(){return new jF({active:this.active,className:this.className,disabled:this.disabled,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,displayValueEnabled:this.displayValueEnabled,max:this.max,min:this.min,step:this.step,value:this.value})}};h([p()],Pp.prototype,"displayValueEnabled",void 0),h([p()],Pp.prototype,"max",void 0),h([p()],Pp.prototype,"min",void 0),h([p()],Pp.prototype,"step",void 0),h([p()],Pp.prototype,"value",void 0),Pp=jF=h([P("esri.support.Action.ActionSlider")],Pp);const vqe=Pp,mde={hide:"hide",hideChildren:"hide-children"};function _$(t){if(t)return t.listMode!=null?t.listMode:void 0}function _qe(t){if(t)return t.minScale!=null?t.minScale:void 0}function bqe(t){if(t)return t.maxScale!=null?t.maxScale:void 0}function wqe(t){if(!t)return"inherited";const e=t.get("layer.capabilities.exportMap.supportsSublayerVisibility");if(typeof e=="boolean")return e?"independent":"inherited";const i=t.get("capabilities.exportMap.supportsSublayerVisibility");return typeof i=="boolean"?i?"independent":"inherited":t.visibilityMode!=null?t.visibilityMode:"independent"}function gde(t){if(t&&(!("type"in t)||t.type!=="wmts")&&t.listMode!==mde.hideChildren)return"sublayers"in t?"sublayers":"layers"in t?"layers":void 0}function xqe(t){const e=t&&(t.get("layer.layer")||t.layer);if(!e)return!1;const i=e.get("capabilities.exportMap.supportsDynamicLayers");return typeof i!="boolean"||i}function Sqe(t){return _$(t)!==mde.hide}function Tqe(t,e){if(!t||isNaN(e))return!1;const i=_qe(t),n=bqe(t),r=i!=null&&!isNaN(i)&&i>0&&e>i,s=n!=null&&!isNaN(n)&&n>0&&e<n;return r||s}function yde(t,e){t&&t.sort((i,n)=>{const r=e.indexOf(i.uid),s=e.indexOf(n.uid);return r>s?-1:r<s?1:0})}function Iqe(t,e){const i=t==null?void 0:t.layer;if(!i)return;const n=gde(i);n&&yde(i.get(n),e)}function YJ(t){const e=t==null?void 0:t.layer;return e&&"layers"in e?e.layers:null}function uL(t,e){var n;const i=(n=t.layer)==null?void 0:n.uid;return i!=null?e.find(r=>{var s;return((s=r.layer)==null?void 0:s.uid)===i}):null}function Cqe(t){const e=Mqe(t)?t:null,i=t==null?void 0:t.parent,n=(i==null?void 0:i.type)==="map-image"?e==null?void 0:e.source:null,r="";return n&&i?{layer:i,title:r,sublayerIds:[n.mapLayerId]}:{layer:t,title:r}}function Mqe(t){return!!(t!=null&&t.layer)}const vde="esri-layer-list-panel",G1=`${vde}__content`,Zu={base:vde,content:G1,contentLegend:`${G1}--legend`,contentString:`${G1}--string`,contentElement:`${G1}--html-element`,contentWidget:`${G1}--widget`},Eqe="legends";let Wa=class extends Nb(qi){constructor(e,i){super(e,i),this._legend=null,this.content=null,this.image=null,this.listItem=null,this.open=!1,this.visible=!0}initialize(){this.addHandles(Q(()=>this.content,e=>this._createLegend(e),He))}destroy(){this._legend=Je(this._legend)}get className(){const{image:e}=this,i=this._getFirstWidget();return this._get("className")||(!e&&i?i.iconClass??"":"")}set className(e){this._override("className",e)}get disabled(){var r;const{listItem:e,_legend:i,content:n}=this;return!e||!(Array.isArray(n)&&n.length>1)&&!!i&&(!((r=i.activeLayerInfos)!=null&&r.length)||!e.visibleAtCurrentScale||!e.visible)}set disabled(e){this._overrideIfSome("disabled",e)}get title(){const e=this._getFirstWidget();return this._get("title")||((e==null?void 0:e.label)??"")}set title(e){this._override("title",e)}render(){return O("div",{class:Zu.base},this._renderContents())}_renderContent(e){const{_legend:i,disabled:n}=this;return!e||n?null:e==="legend"&&i?O("div",{class:this.classes(Zu.content,Zu.contentLegend),key:i},i.render()):typeof e=="string"?O("div",{class:this.classes(Zu.content,Zu.contentString),key:e,innerHTML:e}):a2(e)?O("div",{class:this.classes(Zu.content,Zu.contentWidget),key:e},e.render()):e instanceof HTMLElement?O("div",{class:this.classes(Zu.content,Zu.contentElement),key:e,bind:e,afterCreate:this._attachToNode}):null}_renderContents(){const{content:e}=this;return Array.isArray(e)?e.map(i=>this._renderContent(i)):this._renderContent(e)}_getLegendOptions(){const{listItem:e}=this;if(!e)return{};const{layer:i,view:n}=e;return i&&n?{view:n,layerInfos:[Cqe(i)]}:{}}async _createLegend(e){if(!this._hasLegend(e)||this._legend)return;const{default:i}=await Y(()=>Promise.resolve().then(()=>yqe),void 0,import.meta.url),{listItem:n}=this,r=new i(this._getLegendOptions());this._legend=r,this.notifyChange("className"),this.notifyChange("title");const s=Q(()=>{var o,a;return[n==null?void 0:n.view,n==null?void 0:n.layer,(o=n==null?void 0:n.layer)==null?void 0:o.source,(a=n==null?void 0:n.layer)==null?void 0:a.parent]},()=>this._updateLegend(r),He);this.addHandles(s,Eqe),this.scheduleRender()}_hasLegend(e){const i="legend";return e===i||e!=null&&!!Array.isArray(e)&&e.includes(i)}_attachToNode(e){e.appendChild(this)}_updateLegend(e){e.set(this._getLegendOptions()),this.scheduleRender()}_getWidget(e){return e==="legend"?this._legend:a2(e)?e:null}_getFirstWidget(){const{content:e}=this;if(Array.isArray(e)){let i=null;return e.some(n=>{const r=this._getWidget(n);return r&&(i=r),!!r}),i}return this._getWidget(e)}};h([p()],Wa.prototype,"_legend",void 0),h([p()],Wa.prototype,"className",null),h([p()],Wa.prototype,"content",void 0),h([p()],Wa.prototype,"disabled",null),h([p()],Wa.prototype,"image",void 0),h([p()],Wa.prototype,"listItem",void 0),h([p()],Wa.prototype,"title",null),h([p()],Wa.prototype,"open",void 0),h([p()],Wa.prototype,"visible",void 0),Wa=h([P("esri.widgets.LayerList.ListItemPanel")],Wa);const _de=Wa;var mx;const Aqe=xe.ofType({key:"type",defaultKeyValue:"button",base:GS,typeMap:{button:wie,toggle:xie,slider:vqe}}),bde=xe.ofType(Aqe),sC="layer",hL="child-list-mode",$qe="hide",Pqe="esri.widgets.LayerList.ListItem";let wi=mx=class extends Nb(kc(ye)){constructor(t){super(t),this.actionsSections=new bde,this.actionsOpen=!1,this.checkPublishStatusEnabled=!1,this.children=new(xe.ofType(mx)),this.childrenSortable=!0,this.hidden=!1,this.layer=null,this.layerView=null,this.listItemCreatedFunction=null,this.open=!1,this.panel=null,this.parent=null,this.sortable=!0,this.view=null}initialize(){if(this.handles.add([Q(()=>this.layer,t=>this._watchLayerProperties(t),He),Q(()=>this.checkPublishStatusEnabled,t=>this._updateChildrenPublishing(t),He),Q(()=>this.view,t=>this._updateChildrenView(t),He),Q(()=>this.panel,t=>this._setListItemOnPanel(t),He),Q(()=>[this.layer,this.view],()=>this._getLayerView(),He)]),typeof this.listItemCreatedFunction=="function"){const t={item:this};this.listItemCreatedFunction.call(null,t)}}destroy(){this.view=null}get connectionStatus(){const{layerView:t,publishing:e}=this;if(!e&&t&&"connectionStatus"in t)return t.connectionStatus}get error(){var t;return(t=this.layer)==null?void 0:t.loadError}get incompatible(){const{layerView:t}=this;return!(!t||!("spatialReferenceSupported"in t))&&!t.spatialReferenceSupported}castPanel(t){return this.get("panel.open")&&!t.hasOwnProperty("open")&&(t.open=!0),t?new _de(t):null}get title(){const t=this.get("layer.layer");return(!t||t&&this.get("layer.layer.loaded"))&&this.get("layer.title")||this.get("layer.attributes.title")||""}set title(t){this._override("title",t)}get publishing(){var i;const{layer:t,checkPublishStatusEnabled:e}=this;return e&&t&&"publishingInfo"in t&&((i=t.publishingInfo)==null?void 0:i.status)==="publishing"}get updating(){const{layerView:t,connectionStatus:e,layer:i,publishing:n}=this;return!n&&!e&&(t?t.updating:(i==null?void 0:i.loadStatus)==="loading"||!1)}get visible(){var t;return(t=this.layer)==null?void 0:t.visible}set visible(t){const e=this.layer;e&&(e.visible=t)}get visibleAtCurrentScale(){return!Tqe(this.layer,this.get("view.scale"))}get visibilityMode(){return wqe(this.layer)}clone(){return new mx({actionsSections:this.actionsSections.clone(),actionsOpen:this.actionsOpen,checkPublishStatusEnabled:this.checkPublishStatusEnabled,children:this.children.clone(),layer:this.layer,listItemCreatedFunction:this.listItemCreatedFunction,open:this.open,panel:this.panel,title:this.title,view:this.view,visible:this.visible})}_setListItemOnPanel(t){t&&(t.listItem=this)}_updateChildrenPublishing(t){const e=this.children;e&&e.forEach(i=>i.checkPublishStatusEnabled=t)}_updateChildrenView(t){const e=this.children;e&&e.forEach(i=>i.view=t)}_addChildren(t){if(this.handles.remove(hL),this.children.removeAll(),!t)return;t.forEach(i=>{this.handles.add(Q(()=>i.listMode,()=>this._addChildren(t)),hL)});const e=t.filter(i=>_$(i)!==$qe);this.children.addMany(this._makeChildren(e))}_watchSublayerChanges(t){t&&this.handles.add(t.on("change",()=>{this._addChildren(t)}),sC)}_initializeChildLayers(t){this._addChildren(t),this._watchSublayerChanges(t)}_makeChildren(t){return t.map(e=>Sqe(e)?new mx({layer:e,checkPublishStatusEnabled:this.checkPublishStatusEnabled,listItemCreatedFunction:this.listItemCreatedFunction,parent:this,view:this.view}):null).filter(Ti).reverse()}_watchLayerProperties(t){if(!this.handles||(this.handles.remove(sC),this.handles.remove(hL),!t))return;if(this.handles.add(Q(()=>t.listMode,()=>this._watchLayerProperties(t)),sC),_$(t)==="hide-children")return void this.children.removeAll();const e=gde(t);e&&this.handles.add(Q(()=>t[e],i=>{t.hasOwnProperty(e)&&this._initializeChildLayers(i)},He),sC)}async _getLayerView(){const{layer:t,view:e}=this;if(t&&e)try{const i=await e.whenLayerView(t);if(i.layer!==this.layer)return;this._set("layerView",i)}catch{}}};h([p({type:bde})],wi.prototype,"actionsSections",void 0),h([p()],wi.prototype,"actionsOpen",void 0),h([p()],wi.prototype,"checkPublishStatusEnabled",void 0),h([p({type:xe})],wi.prototype,"children",void 0),h([p()],wi.prototype,"childrenSortable",void 0),h([p({readOnly:!0})],wi.prototype,"connectionStatus",null),h([p({readOnly:!0})],wi.prototype,"error",null),h([p()],wi.prototype,"hidden",void 0),h([p({readOnly:!0})],wi.prototype,"incompatible",null),h([p()],wi.prototype,"layer",void 0),h([p({readOnly:!0})],wi.prototype,"layerView",void 0),h([p()],wi.prototype,"listItemCreatedFunction",void 0),h([p()],wi.prototype,"open",void 0),h([p({type:_de})],wi.prototype,"panel",void 0),h([ut("panel")],wi.prototype,"castPanel",null),h([p()],wi.prototype,"parent",void 0),h([p()],wi.prototype,"sortable",void 0),h([p()],wi.prototype,"title",null),h([p({readOnly:!0})],wi.prototype,"publishing",null),h([p({readOnly:!0})],wi.prototype,"updating",null),h([p()],wi.prototype,"view",void 0),h([p()],wi.prototype,"visible",null),h([p({readOnly:!0})],wi.prototype,"visibleAtCurrentScale",null),h([p({readOnly:!0})],wi.prototype,"visibilityMode",null),wi=mx=h([P(Pqe)],wi);const j8=wi,Ll={view:"view",viewLayers:"view-layers",mapLayers:"map-layers",layerViews:"layer-views",layerListMode:"layer-list-mode"},kqe="hide",wde=xe.ofType(j8);let kp=class extends Uo.EventedAccessor{constructor(e){super(e),this.checkPublishStatusEnabled=!1,this.listItemCreatedFunction=null,this.operationalItems=new wde,this.view=null}initialize(){this.addHandles([Q(()=>{var e;return[this.view,(e=this.view)==null?void 0:e.ready]},()=>this._viewHandles(),He),Q(()=>[this.listItemCreatedFunction,this.checkPublishStatusEnabled],()=>this._recompileList())],Ll.view)}destroy(){this.removeAllHandles(),this.view=null,this.operationalItems.removeAll()}get state(){const e=this.get("view");return this.get("view.ready")?"ready":e?"loading":"disabled"}triggerAction(e,i){e&&!e.disabled&&this.emit("trigger-action",{action:e,item:i})}moveListItem(e,i,n,r){var m,g;const s=e==null?void 0:e.layer;if(!s)return;const o=(g=(m=this.view)==null?void 0:m.map)==null?void 0:g.layers,a=i?YJ(i):o,l=n?YJ(n):o;if(!a||!l)return;const{operationalItems:c}=this,u=(i==null?void 0:i.children)||c,d=(n==null?void 0:n.children)||c,f=l.length-r;e.parent=n||null,u.includes(e)&&u.remove(e),a.includes(s)&&a.remove(s),d.includes(e)||d.add(e,f),l.includes(s)||l.add(s,f)}_createLayerViewHandles(e){this.removeHandles(Ll.layerViews),this._compileList(),e&&this.addHandles(e.on("change",()=>this._compileList()),Ll.layerViews)}_createMapLayerHandles(e){this.removeHandles(Ll.mapLayers),this._compileList(),e&&this.addHandles(e.on("change",()=>this._compileList()),Ll.mapLayers)}_createListItem(e){const{view:i,listItemCreatedFunction:n,checkPublishStatusEnabled:r}=this;return new j8({checkPublishStatusEnabled:r,layer:e,listItemCreatedFunction:n,view:i})}_removeAllItems(){this.operationalItems.removeAll()}_getViewableLayers(e){if(e)return e.filter(i=>_$(i)!==kqe)}_watchLayersListMode(e){this.removeHandles(Ll.layerListMode),e&&e.forEach(i=>{"listMode"in i&&this.addHandles(Q(()=>i.listMode,()=>this._compileList()),Ll.layerListMode)})}_compileList(){const e=this.get("view.map.layers");this._watchLayersListMode(e);const i=this._getViewableLayers(e);i&&i.length?(this._createNewItems(i),this._removeItems(i),this._sortItems(i)):this._removeAllItems()}_createNewItems(e){const{operationalItems:i}=this;e.forEach(n=>{i.find(r=>r.layer===n)||i.add(this._createListItem(n))})}_removeItems(e){const{operationalItems:i}=this,n=[];i.forEach(r=>{r&&e&&e.includes(r.layer)||n.push(r)}),i.removeMany(n)}_sortItems(e){const{operationalItems:i}=this;i.sort((n,r)=>{const s=e.indexOf(n.layer),o=e.indexOf(r.layer);return s>o?-1:s<o?1:0})}_recompileList(){this._removeAllItems(),this._compileList()}_viewHandles(){const{view:e}=this;this.removeHandles([Ll.mapLayers,Ll.layerViews,Ll.viewLayers]),this._recompileList(),e&&e.ready&&this.addHandles([Q(()=>{var i,n;return(n=(i=this.view)==null?void 0:i.map)==null?void 0:n.allLayers},i=>this._createMapLayerHandles(i),He),Q(()=>{var i;return(i=this.view)==null?void 0:i.allLayerViews},i=>this._createLayerViewHandles(i),He)],Ll.viewLayers)}};h([p()],kp.prototype,"checkPublishStatusEnabled",void 0),h([p()],kp.prototype,"listItemCreatedFunction",void 0),h([p({type:wde})],kp.prototype,"operationalItems",void 0),h([p({readOnly:!0})],kp.prototype,"state",null),h([p()],kp.prototype,"view",void 0),kp=h([P("esri.widgets.LayerList.LayerListViewModel")],kp);const xde=kp;/**!
 * Sortable 1.15.0
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function XJ(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),i.push.apply(i,n)}return i}function Fu(t){for(var e=1;e<arguments.length;e++){var i=arguments[e]!=null?arguments[e]:{};e%2?XJ(Object(i),!0).forEach(function(n){Oqe(t,n,i[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):XJ(Object(i)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(i,n))})}return t}function cE(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?cE=function(e){return typeof e}:cE=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cE(t)}function Oqe(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function dd(){return dd=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},dd.apply(this,arguments)}function Lqe(t,e){if(t==null)return{};var i={},n=Object.keys(t),r,s;for(s=0;s<n.length;s++)r=n[s],!(e.indexOf(r)>=0)&&(i[r]=t[r]);return i}function Rqe(t,e){if(t==null)return{};var i=Lqe(t,e),n,r;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(r=0;r<s.length;r++)n=s[r],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}var Dqe="1.15.0";function Qh(t){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(t)}var bd=Qh(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),_T=Qh(/Edge/i),KJ=Qh(/firefox/i),c2=Qh(/safari/i)&&!Qh(/chrome/i)&&!Qh(/android/i),Sde=Qh(/iP(ad|od|hone)/i),Tde=Qh(/chrome/i)&&Qh(/android/i),Ide={capture:!1,passive:!1};function ti(t,e,i){t.addEventListener(e,i,!bd&&Ide)}function Dt(t,e,i){t.removeEventListener(e,i,!bd&&Ide)}function b$(t,e){if(e){if(e[0]===">"&&(e=e.substring(1)),t)try{if(t.matches)return t.matches(e);if(t.msMatchesSelector)return t.msMatchesSelector(e);if(t.webkitMatchesSelector)return t.webkitMatchesSelector(e)}catch{return!1}return!1}}function Nqe(t){return t.host&&t!==document&&t.host.nodeType?t.host:t.parentNode}function du(t,e,i,n){if(t){i=i||document;do{if(e!=null&&(e[0]===">"?t.parentNode===i&&b$(t,e):b$(t,e))||n&&t===i)return t;if(t===i)break}while(t=Nqe(t))}return null}var QJ=/\s+/g;function ta(t,e,i){if(t&&e)if(t.classList)t.classList[i?"add":"remove"](e);else{var n=(" "+t.className+" ").replace(QJ," ").replace(" "+e+" "," ");t.className=(n+(i?" "+e:"")).replace(QJ," ")}}function Ye(t,e,i){var n=t&&t.style;if(n){if(i===void 0)return document.defaultView&&document.defaultView.getComputedStyle?i=document.defaultView.getComputedStyle(t,""):t.currentStyle&&(i=t.currentStyle),e===void 0?i:i[e];!(e in n)&&e.indexOf("webkit")===-1&&(e="-webkit-"+e),n[e]=i+(typeof i=="string"?"":"px")}}function B_(t,e){var i="";if(typeof t=="string")i=t;else do{var n=Ye(t,"transform");n&&n!=="none"&&(i=n+" "+i)}while(!e&&(t=t.parentNode));var r=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return r&&new r(i)}function Cde(t,e,i){if(t){var n=t.getElementsByTagName(e),r=0,s=n.length;if(i)for(;r<s;r++)i(n[r],r);return n}return[]}function Au(){var t=document.scrollingElement;return t||document.documentElement}function _r(t,e,i,n,r){if(!(!t.getBoundingClientRect&&t!==window)){var s,o,a,l,c,u,d;if(t!==window&&t.parentNode&&t!==Au()?(s=t.getBoundingClientRect(),o=s.top,a=s.left,l=s.bottom,c=s.right,u=s.height,d=s.width):(o=0,a=0,l=window.innerHeight,c=window.innerWidth,u=window.innerHeight,d=window.innerWidth),(e||i)&&t!==window&&(r=r||t.parentNode,!bd))do if(r&&r.getBoundingClientRect&&(Ye(r,"transform")!=="none"||i&&Ye(r,"position")!=="static")){var f=r.getBoundingClientRect();o-=f.top+parseInt(Ye(r,"border-top-width")),a-=f.left+parseInt(Ye(r,"border-left-width")),l=o+s.height,c=a+s.width;break}while(r=r.parentNode);if(n&&t!==window){var m=B_(r||t),g=m&&m.a,y=m&&m.d;m&&(o/=y,a/=g,d/=g,u/=y,l=o+u,c=a+d)}return{top:o,left:a,bottom:l,right:c,width:d,height:u}}}function eZ(t,e,i){for(var n=vf(t,!0),r=_r(t)[e];n;){var s=_r(n)[i],o=void 0;if(i==="top"||i==="left"?o=r>=s:o=r<=s,!o)return n;if(n===Au())break;n=vf(n,!1)}return!1}function Ib(t,e,i,n){for(var r=0,s=0,o=t.children;s<o.length;){if(o[s].style.display!=="none"&&o[s]!==Xe.ghost&&(n||o[s]!==Xe.dragged)&&du(o[s],i.draggable,t,!1)){if(r===e)return o[s];r++}s++}return null}function B8(t,e){for(var i=t.lastElementChild;i&&(i===Xe.ghost||Ye(i,"display")==="none"||e&&!b$(i,e));)i=i.previousElementSibling;return i||null}function Ya(t,e){var i=0;if(!t||!t.parentNode)return-1;for(;t=t.previousElementSibling;)t.nodeName.toUpperCase()!=="TEMPLATE"&&t!==Xe.clone&&(!e||b$(t,e))&&i++;return i}function tZ(t){var e=0,i=0,n=Au();if(t)do{var r=B_(t),s=r.a,o=r.d;e+=t.scrollLeft*s,i+=t.scrollTop*o}while(t!==n&&(t=t.parentNode));return[e,i]}function Fqe(t,e){for(var i in t)if(t.hasOwnProperty(i)){for(var n in e)if(e.hasOwnProperty(n)&&e[n]===t[i][n])return Number(i)}return-1}function vf(t,e){if(!t||!t.getBoundingClientRect)return Au();var i=t,n=!1;do if(i.clientWidth<i.scrollWidth||i.clientHeight<i.scrollHeight){var r=Ye(i);if(i.clientWidth<i.scrollWidth&&(r.overflowX=="auto"||r.overflowX=="scroll")||i.clientHeight<i.scrollHeight&&(r.overflowY=="auto"||r.overflowY=="scroll")){if(!i.getBoundingClientRect||i===document.body)return Au();if(n||e)return i;n=!0}}while(i=i.parentNode);return Au()}function zqe(t,e){if(t&&e)for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t}function dL(t,e){return Math.round(t.top)===Math.round(e.top)&&Math.round(t.left)===Math.round(e.left)&&Math.round(t.height)===Math.round(e.height)&&Math.round(t.width)===Math.round(e.width)}var u2;function Mde(t,e){return function(){if(!u2){var i=arguments,n=this;i.length===1?t.call(n,i[0]):t.apply(n,i),u2=setTimeout(function(){u2=void 0},e)}}}function Vqe(){clearTimeout(u2),u2=void 0}function Ede(t,e,i){t.scrollLeft+=e,t.scrollTop+=i}function Ade(t){var e=window.Polymer,i=window.jQuery||window.Zepto;return e&&e.dom?e.dom(t).cloneNode(!0):i?i(t).clone(!0)[0]:t.cloneNode(!0)}var ma="Sortable"+new Date().getTime();function jqe(){var t=[],e;return{captureAnimationState:function(){if(t=[],!!this.options.animation){var n=[].slice.call(this.el.children);n.forEach(function(r){if(!(Ye(r,"display")==="none"||r===Xe.ghost)){t.push({target:r,rect:_r(r)});var s=Fu({},t[t.length-1].rect);if(r.thisAnimationDuration){var o=B_(r,!0);o&&(s.top-=o.f,s.left-=o.e)}r.fromRect=s}})}},addAnimationState:function(n){t.push(n)},removeAnimationState:function(n){t.splice(Fqe(t,{target:n}),1)},animateAll:function(n){var r=this;if(!this.options.animation){clearTimeout(e),typeof n=="function"&&n();return}var s=!1,o=0;t.forEach(function(a){var l=0,c=a.target,u=c.fromRect,d=_r(c),f=c.prevFromRect,m=c.prevToRect,g=a.rect,y=B_(c,!0);y&&(d.top-=y.f,d.left-=y.e),c.toRect=d,c.thisAnimationDuration&&dL(f,d)&&!dL(u,d)&&(g.top-d.top)/(g.left-d.left)===(u.top-d.top)/(u.left-d.left)&&(l=Uqe(g,f,m,r.options)),dL(d,u)||(c.prevFromRect=u,c.prevToRect=d,l||(l=r.options.animation),r.animate(c,g,d,l)),l&&(s=!0,o=Math.max(o,l),clearTimeout(c.animationResetTimer),c.animationResetTimer=setTimeout(function(){c.animationTime=0,c.prevFromRect=null,c.fromRect=null,c.prevToRect=null,c.thisAnimationDuration=null},l),c.thisAnimationDuration=l)}),clearTimeout(e),s?e=setTimeout(function(){typeof n=="function"&&n()},o):typeof n=="function"&&n(),t=[]},animate:function(n,r,s,o){if(o){Ye(n,"transition",""),Ye(n,"transform","");var a=B_(this.el),l=a&&a.a,c=a&&a.d,u=(r.left-s.left)/(l||1),d=(r.top-s.top)/(c||1);n.animatingX=!!u,n.animatingY=!!d,Ye(n,"transform","translate3d("+u+"px,"+d+"px,0)"),this.forRepaintDummy=Bqe(n),Ye(n,"transition","transform "+o+"ms"+(this.options.easing?" "+this.options.easing:"")),Ye(n,"transform","translate3d(0,0,0)"),typeof n.animated=="number"&&clearTimeout(n.animated),n.animated=setTimeout(function(){Ye(n,"transition",""),Ye(n,"transform",""),n.animated=!1,n.animatingX=!1,n.animatingY=!1},o)}}}}function Bqe(t){return t.offsetWidth}function Uqe(t,e,i,n){return Math.sqrt(Math.pow(e.top-t.top,2)+Math.pow(e.left-t.left,2))/Math.sqrt(Math.pow(e.top-i.top,2)+Math.pow(e.left-i.left,2))*n.animation}var X0=[],pL={initializeByDefault:!0},bT={mount:function(e){for(var i in pL)pL.hasOwnProperty(i)&&!(i in e)&&(e[i]=pL[i]);X0.forEach(function(n){if(n.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")}),X0.push(e)},pluginEvent:function(e,i,n){var r=this;this.eventCanceled=!1,n.cancel=function(){r.eventCanceled=!0};var s=e+"Global";X0.forEach(function(o){i[o.pluginName]&&(i[o.pluginName][s]&&i[o.pluginName][s](Fu({sortable:i},n)),i.options[o.pluginName]&&i[o.pluginName][e]&&i[o.pluginName][e](Fu({sortable:i},n)))})},initializePlugins:function(e,i,n,r){X0.forEach(function(a){var l=a.pluginName;if(!(!e.options[l]&&!a.initializeByDefault)){var c=new a(e,i,e.options);c.sortable=e,c.options=e.options,e[l]=c,dd(n,c.defaults)}});for(var s in e.options)if(e.options.hasOwnProperty(s)){var o=this.modifyOption(e,s,e.options[s]);typeof o<"u"&&(e.options[s]=o)}},getEventProperties:function(e,i){var n={};return X0.forEach(function(r){typeof r.eventProperties=="function"&&dd(n,r.eventProperties.call(i[r.pluginName],e))}),n},modifyOption:function(e,i,n){var r;return X0.forEach(function(s){e[s.pluginName]&&s.optionListeners&&typeof s.optionListeners[i]=="function"&&(r=s.optionListeners[i].call(e[s.pluginName],n))}),r}};function Gqe(t){var e=t.sortable,i=t.rootEl,n=t.name,r=t.targetEl,s=t.cloneEl,o=t.toEl,a=t.fromEl,l=t.oldIndex,c=t.newIndex,u=t.oldDraggableIndex,d=t.newDraggableIndex,f=t.originalEvent,m=t.putSortable,g=t.extraEventProperties;if(e=e||i&&i[ma],!!e){var y,_=e.options,b="on"+n.charAt(0).toUpperCase()+n.substr(1);window.CustomEvent&&!bd&&!_T?y=new CustomEvent(n,{bubbles:!0,cancelable:!0}):(y=document.createEvent("Event"),y.initEvent(n,!0,!0)),y.to=o||i,y.from=a||i,y.item=r||i,y.clone=s,y.oldIndex=l,y.newIndex=c,y.oldDraggableIndex=u,y.newDraggableIndex=d,y.originalEvent=f,y.pullMode=m?m.lastPutMode:void 0;var w=Fu(Fu({},g),bT.getEventProperties(n,e));for(var x in w)y[x]=w[x];i&&i.dispatchEvent(y),_[b]&&_[b].call(e,y)}}var Hqe=["evt"],fo=function(e,i){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=n.evt,s=Rqe(n,Hqe);bT.pluginEvent.bind(Xe)(e,i,Fu({dragEl:me,parentEl:wn,ghostEl:at,rootEl:Qi,nextEl:kg,lastDownEl:uE,cloneEl:dn,cloneHidden:Kp,dragStarted:gx,putSortable:Qr,activeSortable:Xe.active,originalEvent:r,oldIndex:__,oldDraggableIndex:h2,newIndex:oa,newDraggableIndex:qp,hideGhostForTarget:Ode,unhideGhostForTarget:Lde,cloneNowHidden:function(){Kp=!0},cloneNowShown:function(){Kp=!1},dispatchSortableEvent:function(a){Zs({sortable:i,name:a,originalEvent:r})}},s))};function Zs(t){Gqe(Fu({putSortable:Qr,cloneEl:dn,targetEl:me,rootEl:Qi,oldIndex:__,oldDraggableIndex:h2,newIndex:oa,newDraggableIndex:qp},t))}var me,wn,at,Qi,kg,uE,dn,Kp,__,oa,h2,qp,oC,Qr,e_=!1,w$=!1,x$=[],bm,Rl,fL,mL,iZ,nZ,gx,K0,d2,p2=!1,aC=!1,hE,hs,gL=[],BF=!1,S$=[],_k=typeof document<"u",lC=Sde,rZ=_T||bd?"cssFloat":"float",qqe=_k&&!Tde&&!Sde&&"draggable"in document.createElement("div"),$de=function(){if(_k){if(bd)return!1;var t=document.createElement("x");return t.style.cssText="pointer-events:auto",t.style.pointerEvents==="auto"}}(),Pde=function(e,i){var n=Ye(e),r=parseInt(n.width)-parseInt(n.paddingLeft)-parseInt(n.paddingRight)-parseInt(n.borderLeftWidth)-parseInt(n.borderRightWidth),s=Ib(e,0,i),o=Ib(e,1,i),a=s&&Ye(s),l=o&&Ye(o),c=a&&parseInt(a.marginLeft)+parseInt(a.marginRight)+_r(s).width,u=l&&parseInt(l.marginLeft)+parseInt(l.marginRight)+_r(o).width;if(n.display==="flex")return n.flexDirection==="column"||n.flexDirection==="column-reverse"?"vertical":"horizontal";if(n.display==="grid")return n.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(s&&a.float&&a.float!=="none"){var d=a.float==="left"?"left":"right";return o&&(l.clear==="both"||l.clear===d)?"vertical":"horizontal"}return s&&(a.display==="block"||a.display==="flex"||a.display==="table"||a.display==="grid"||c>=r&&n[rZ]==="none"||o&&n[rZ]==="none"&&c+u>r)?"vertical":"horizontal"},Wqe=function(e,i,n){var r=n?e.left:e.top,s=n?e.right:e.bottom,o=n?e.width:e.height,a=n?i.left:i.top,l=n?i.right:i.bottom,c=n?i.width:i.height;return r===a||s===l||r+o/2===a+c/2},Jqe=function(e,i){var n;return x$.some(function(r){var s=r[ma].options.emptyInsertThreshold;if(!(!s||B8(r))){var o=_r(r),a=e>=o.left-s&&e<=o.right+s,l=i>=o.top-s&&i<=o.bottom+s;if(a&&l)return n=r}}),n},kde=function(e){function i(s,o){return function(a,l,c,u){var d=a.options.group.name&&l.options.group.name&&a.options.group.name===l.options.group.name;if(s==null&&(o||d))return!0;if(s==null||s===!1)return!1;if(o&&s==="clone")return s;if(typeof s=="function")return i(s(a,l,c,u),o)(a,l,c,u);var f=(o?a:l).options.group.name;return s===!0||typeof s=="string"&&s===f||s.join&&s.indexOf(f)>-1}}var n={},r=e.group;(!r||cE(r)!="object")&&(r={name:r}),n.name=r.name,n.checkPull=i(r.pull,!0),n.checkPut=i(r.put),n.revertClone=r.revertClone,e.group=n},Ode=function(){!$de&&at&&Ye(at,"display","none")},Lde=function(){!$de&&at&&Ye(at,"display","")};_k&&!Tde&&document.addEventListener("click",function(t){if(w$)return t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.stopImmediatePropagation&&t.stopImmediatePropagation(),w$=!1,!1},!0);var wm=function(e){if(me){e=e.touches?e.touches[0]:e;var i=Jqe(e.clientX,e.clientY);if(i){var n={};for(var r in e)e.hasOwnProperty(r)&&(n[r]=e[r]);n.target=n.rootEl=i,n.preventDefault=void 0,n.stopPropagation=void 0,i[ma]._onDragOver(n)}}},Zqe=function(e){me&&me.parentNode[ma]._isOutsideThisEl(e.target)};function Xe(t,e){if(!(t&&t.nodeType&&t.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(t));this.el=t,this.options=e=dd({},e),t[ma]=this;var i={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(t.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Pde(t,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(o,a){o.setData("Text",a.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:Xe.supportPointer!==!1&&"PointerEvent"in window&&!c2,emptyInsertThreshold:5};bT.initializePlugins(this,t,i);for(var n in i)!(n in e)&&(e[n]=i[n]);kde(e);for(var r in this)r.charAt(0)==="_"&&typeof this[r]=="function"&&(this[r]=this[r].bind(this));this.nativeDraggable=e.forceFallback?!1:qqe,this.nativeDraggable&&(this.options.touchStartThreshold=1),e.supportPointer?ti(t,"pointerdown",this._onTapStart):(ti(t,"mousedown",this._onTapStart),ti(t,"touchstart",this._onTapStart)),this.nativeDraggable&&(ti(t,"dragover",this),ti(t,"dragenter",this)),x$.push(this.el),e.store&&e.store.get&&this.sort(e.store.get(this)||[]),dd(this,jqe())}Xe.prototype={constructor:Xe,_isOutsideThisEl:function(e){!this.el.contains(e)&&e!==this.el&&(K0=null)},_getDirection:function(e,i){return typeof this.options.direction=="function"?this.options.direction.call(this,e,i,me):this.options.direction},_onTapStart:function(e){if(e.cancelable){var i=this,n=this.el,r=this.options,s=r.preventOnFilter,o=e.type,a=e.touches&&e.touches[0]||e.pointerType&&e.pointerType==="touch"&&e,l=(a||e).target,c=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||l,u=r.filter;if(nWe(n),!me&&!(/mousedown|pointerdown/.test(o)&&e.button!==0||r.disabled)&&!c.isContentEditable&&!(!this.nativeDraggable&&c2&&l&&l.tagName.toUpperCase()==="SELECT")&&(l=du(l,r.draggable,n,!1),!(l&&l.animated)&&uE!==l)){if(__=Ya(l),h2=Ya(l,r.draggable),typeof u=="function"){if(u.call(this,e,l,this)){Zs({sortable:i,rootEl:c,name:"filter",targetEl:l,toEl:n,fromEl:n}),fo("filter",i,{evt:e}),s&&e.cancelable&&e.preventDefault();return}}else if(u&&(u=u.split(",").some(function(d){if(d=du(c,d.trim(),n,!1),d)return Zs({sortable:i,rootEl:d,name:"filter",targetEl:l,fromEl:n,toEl:n}),fo("filter",i,{evt:e}),!0}),u)){s&&e.cancelable&&e.preventDefault();return}r.handle&&!du(c,r.handle,n,!1)||this._prepareDragStart(e,a,l)}}},_prepareDragStart:function(e,i,n){var r=this,s=r.el,o=r.options,a=s.ownerDocument,l;if(n&&!me&&n.parentNode===s){var c=_r(n);if(Qi=s,me=n,wn=me.parentNode,kg=me.nextSibling,uE=n,oC=o.group,Xe.dragged=me,bm={target:me,clientX:(i||e).clientX,clientY:(i||e).clientY},iZ=bm.clientX-c.left,nZ=bm.clientY-c.top,this._lastX=(i||e).clientX,this._lastY=(i||e).clientY,me.style["will-change"]="all",l=function(){if(fo("delayEnded",r,{evt:e}),Xe.eventCanceled){r._onDrop();return}r._disableDelayedDragEvents(),!KJ&&r.nativeDraggable&&(me.draggable=!0),r._triggerDragStart(e,i),Zs({sortable:r,name:"choose",originalEvent:e}),ta(me,o.chosenClass,!0)},o.ignore.split(",").forEach(function(u){Cde(me,u.trim(),yL)}),ti(a,"dragover",wm),ti(a,"mousemove",wm),ti(a,"touchmove",wm),ti(a,"mouseup",r._onDrop),ti(a,"touchend",r._onDrop),ti(a,"touchcancel",r._onDrop),KJ&&this.nativeDraggable&&(this.options.touchStartThreshold=4,me.draggable=!0),fo("delayStart",this,{evt:e}),o.delay&&(!o.delayOnTouchOnly||i)&&(!this.nativeDraggable||!(_T||bd))){if(Xe.eventCanceled){this._onDrop();return}ti(a,"mouseup",r._disableDelayedDrag),ti(a,"touchend",r._disableDelayedDrag),ti(a,"touchcancel",r._disableDelayedDrag),ti(a,"mousemove",r._delayedDragTouchMoveHandler),ti(a,"touchmove",r._delayedDragTouchMoveHandler),o.supportPointer&&ti(a,"pointermove",r._delayedDragTouchMoveHandler),r._dragStartTimer=setTimeout(l,o.delay)}else l()}},_delayedDragTouchMoveHandler:function(e){var i=e.touches?e.touches[0]:e;Math.max(Math.abs(i.clientX-this._lastX),Math.abs(i.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){me&&yL(me),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;Dt(e,"mouseup",this._disableDelayedDrag),Dt(e,"touchend",this._disableDelayedDrag),Dt(e,"touchcancel",this._disableDelayedDrag),Dt(e,"mousemove",this._delayedDragTouchMoveHandler),Dt(e,"touchmove",this._delayedDragTouchMoveHandler),Dt(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,i){i=i||e.pointerType=="touch"&&e,!this.nativeDraggable||i?this.options.supportPointer?ti(document,"pointermove",this._onTouchMove):i?ti(document,"touchmove",this._onTouchMove):ti(document,"mousemove",this._onTouchMove):(ti(me,"dragend",this),ti(Qi,"dragstart",this._onDragStart));try{document.selection?dE(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(e,i){if(e_=!1,Qi&&me){fo("dragStarted",this,{evt:i}),this.nativeDraggable&&ti(document,"dragover",Zqe);var n=this.options;!e&&ta(me,n.dragClass,!1),ta(me,n.ghostClass,!0),Xe.active=this,e&&this._appendGhost(),Zs({sortable:this,name:"start",originalEvent:i})}else this._nulling()},_emulateDragOver:function(){if(Rl){this._lastX=Rl.clientX,this._lastY=Rl.clientY,Ode();for(var e=document.elementFromPoint(Rl.clientX,Rl.clientY),i=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(Rl.clientX,Rl.clientY),e!==i);)i=e;if(me.parentNode[ma]._isOutsideThisEl(e),i)do{if(i[ma]){var n=void 0;if(n=i[ma]._onDragOver({clientX:Rl.clientX,clientY:Rl.clientY,target:e,rootEl:i}),n&&!this.options.dragoverBubble)break}e=i}while(i=i.parentNode);Lde()}},_onTouchMove:function(e){if(bm){var i=this.options,n=i.fallbackTolerance,r=i.fallbackOffset,s=e.touches?e.touches[0]:e,o=at&&B_(at,!0),a=at&&o&&o.a,l=at&&o&&o.d,c=lC&&hs&&tZ(hs),u=(s.clientX-bm.clientX+r.x)/(a||1)+(c?c[0]-gL[0]:0)/(a||1),d=(s.clientY-bm.clientY+r.y)/(l||1)+(c?c[1]-gL[1]:0)/(l||1);if(!Xe.active&&!e_){if(n&&Math.max(Math.abs(s.clientX-this._lastX),Math.abs(s.clientY-this._lastY))<n)return;this._onDragStart(e,!0)}if(at){o?(o.e+=u-(fL||0),o.f+=d-(mL||0)):o={a:1,b:0,c:0,d:1,e:u,f:d};var f="matrix(".concat(o.a,",").concat(o.b,",").concat(o.c,",").concat(o.d,",").concat(o.e,",").concat(o.f,")");Ye(at,"webkitTransform",f),Ye(at,"mozTransform",f),Ye(at,"msTransform",f),Ye(at,"transform",f),fL=u,mL=d,Rl=s}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!at){var e=this.options.fallbackOnBody?document.body:Qi,i=_r(me,!0,lC,!0,e),n=this.options;if(lC){for(hs=e;Ye(hs,"position")==="static"&&Ye(hs,"transform")==="none"&&hs!==document;)hs=hs.parentNode;hs!==document.body&&hs!==document.documentElement?(hs===document&&(hs=Au()),i.top+=hs.scrollTop,i.left+=hs.scrollLeft):hs=Au(),gL=tZ(hs)}at=me.cloneNode(!0),ta(at,n.ghostClass,!1),ta(at,n.fallbackClass,!0),ta(at,n.dragClass,!0),Ye(at,"transition",""),Ye(at,"transform",""),Ye(at,"box-sizing","border-box"),Ye(at,"margin",0),Ye(at,"top",i.top),Ye(at,"left",i.left),Ye(at,"width",i.width),Ye(at,"height",i.height),Ye(at,"opacity","0.8"),Ye(at,"position",lC?"absolute":"fixed"),Ye(at,"zIndex","100000"),Ye(at,"pointerEvents","none"),Xe.ghost=at,e.appendChild(at),Ye(at,"transform-origin",iZ/parseInt(at.style.width)*100+"% "+nZ/parseInt(at.style.height)*100+"%")}},_onDragStart:function(e,i){var n=this,r=e.dataTransfer,s=n.options;if(fo("dragStart",this,{evt:e}),Xe.eventCanceled){this._onDrop();return}fo("setupClone",this),Xe.eventCanceled||(dn=Ade(me),dn.removeAttribute("id"),dn.draggable=!1,dn.style["will-change"]="",this._hideClone(),ta(dn,this.options.chosenClass,!1),Xe.clone=dn),n.cloneId=dE(function(){fo("clone",n),!Xe.eventCanceled&&(n.options.removeCloneOnHide||Qi.insertBefore(dn,me),n._hideClone(),Zs({sortable:n,name:"clone"}))}),!i&&ta(me,s.dragClass,!0),i?(w$=!0,n._loopId=setInterval(n._emulateDragOver,50)):(Dt(document,"mouseup",n._onDrop),Dt(document,"touchend",n._onDrop),Dt(document,"touchcancel",n._onDrop),r&&(r.effectAllowed="move",s.setData&&s.setData.call(n,r,me)),ti(document,"drop",n),Ye(me,"transform","translateZ(0)")),e_=!0,n._dragStartId=dE(n._dragStarted.bind(n,i,e)),ti(document,"selectstart",n),gx=!0,c2&&Ye(document.body,"user-select","none")},_onDragOver:function(e){var i=this.el,n=e.target,r,s,o,a=this.options,l=a.group,c=Xe.active,u=oC===l,d=a.sort,f=Qr||c,m,g=this,y=!1;if(BF)return;function _(W,Z){fo(W,g,Fu({evt:e,isOwner:u,axis:m?"vertical":"horizontal",revert:o,dragRect:r,targetRect:s,canSort:d,fromSortable:f,target:n,completed:w,onMove:function(oe,se){return cC(Qi,i,me,r,oe,_r(oe),e,se)},changed:x},Z))}function b(){_("dragOverAnimationCapture"),g.captureAnimationState(),g!==f&&f.captureAnimationState()}function w(W){return _("dragOverCompleted",{insertion:W}),W&&(u?c._hideClone():c._showClone(g),g!==f&&(ta(me,Qr?Qr.options.ghostClass:c.options.ghostClass,!1),ta(me,a.ghostClass,!0)),Qr!==g&&g!==Xe.active?Qr=g:g===Xe.active&&Qr&&(Qr=null),f===g&&(g._ignoreWhileAnimating=n),g.animateAll(function(){_("dragOverAnimationComplete"),g._ignoreWhileAnimating=null}),g!==f&&(f.animateAll(),f._ignoreWhileAnimating=null)),(n===me&&!me.animated||n===i&&!n.animated)&&(K0=null),!a.dragoverBubble&&!e.rootEl&&n!==document&&(me.parentNode[ma]._isOutsideThisEl(e.target),!W&&wm(e)),!a.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),y=!0}function x(){oa=Ya(me),qp=Ya(me,a.draggable),Zs({sortable:g,name:"change",toEl:i,newIndex:oa,newDraggableIndex:qp,originalEvent:e})}if(e.preventDefault!==void 0&&e.cancelable&&e.preventDefault(),n=du(n,a.draggable,i,!0),_("dragOver"),Xe.eventCanceled)return y;if(me.contains(e.target)||n.animated&&n.animatingX&&n.animatingY||g._ignoreWhileAnimating===n)return w(!1);if(w$=!1,c&&!a.disabled&&(u?d||(o=wn!==Qi):Qr===this||(this.lastPutMode=oC.checkPull(this,c,me,e))&&l.checkPut(this,c,me,e))){if(m=this._getDirection(e,n)==="vertical",r=_r(me),_("dragOverValid"),Xe.eventCanceled)return y;if(o)return wn=Qi,b(),this._hideClone(),_("revert"),Xe.eventCanceled||(kg?Qi.insertBefore(me,kg):Qi.appendChild(me)),w(!0);var S=B8(i,a.draggable);if(!S||Qqe(e,m,this)&&!S.animated){if(S===me)return w(!1);if(S&&i===e.target&&(n=S),n&&(s=_r(n)),cC(Qi,i,me,r,n,s,e,!!n)!==!1)return b(),S&&S.nextSibling?i.insertBefore(me,S.nextSibling):i.appendChild(me),wn=i,x(),w(!0)}else if(S&&Kqe(e,m,this)){var T=Ib(i,0,a,!0);if(T===me)return w(!1);if(n=T,s=_r(n),cC(Qi,i,me,r,n,s,e,!1)!==!1)return b(),i.insertBefore(me,T),wn=i,x(),w(!0)}else if(n.parentNode===i){s=_r(n);var I=0,C,M=me.parentNode!==i,E=!Wqe(me.animated&&me.toRect||r,n.animated&&n.toRect||s,m),A=m?"top":"left",$=eZ(n,"top","top")||eZ(me,"top","top"),L=$?$.scrollTop:void 0;K0!==n&&(C=s[A],p2=!1,aC=!E&&a.invertSwap||M),I=eWe(e,n,s,m,E?1:a.swapThreshold,a.invertedSwapThreshold==null?a.swapThreshold:a.invertedSwapThreshold,aC,K0===n);var D;if(I!==0){var F=Ya(me);do F-=I,D=wn.children[F];while(D&&(Ye(D,"display")==="none"||D===at))}if(I===0||D===n)return w(!1);K0=n,d2=I;var z=n.nextElementSibling,U=!1;U=I===1;var G=cC(Qi,i,me,r,n,s,e,U);if(G!==!1)return(G===1||G===-1)&&(U=G===1),BF=!0,setTimeout(Xqe,30),b(),U&&!z?i.appendChild(me):n.parentNode.insertBefore(me,U?z:n),$&&Ede($,0,L-$.scrollTop),wn=me.parentNode,C!==void 0&&!aC&&(hE=Math.abs(C-_r(n)[A])),x(),w(!0)}if(i.contains(me))return w(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){Dt(document,"mousemove",this._onTouchMove),Dt(document,"touchmove",this._onTouchMove),Dt(document,"pointermove",this._onTouchMove),Dt(document,"dragover",wm),Dt(document,"mousemove",wm),Dt(document,"touchmove",wm)},_offUpEvents:function(){var e=this.el.ownerDocument;Dt(e,"mouseup",this._onDrop),Dt(e,"touchend",this._onDrop),Dt(e,"pointerup",this._onDrop),Dt(e,"touchcancel",this._onDrop),Dt(document,"selectstart",this)},_onDrop:function(e){var i=this.el,n=this.options;if(oa=Ya(me),qp=Ya(me,n.draggable),fo("drop",this,{evt:e}),wn=me&&me.parentNode,oa=Ya(me),qp=Ya(me,n.draggable),Xe.eventCanceled){this._nulling();return}e_=!1,aC=!1,p2=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),UF(this.cloneId),UF(this._dragStartId),this.nativeDraggable&&(Dt(document,"drop",this),Dt(i,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),c2&&Ye(document.body,"user-select",""),Ye(me,"transform",""),e&&(gx&&(e.cancelable&&e.preventDefault(),!n.dropBubble&&e.stopPropagation()),at&&at.parentNode&&at.parentNode.removeChild(at),(Qi===wn||Qr&&Qr.lastPutMode!=="clone")&&dn&&dn.parentNode&&dn.parentNode.removeChild(dn),me&&(this.nativeDraggable&&Dt(me,"dragend",this),yL(me),me.style["will-change"]="",gx&&!e_&&ta(me,Qr?Qr.options.ghostClass:this.options.ghostClass,!1),ta(me,this.options.chosenClass,!1),Zs({sortable:this,name:"unchoose",toEl:wn,newIndex:null,newDraggableIndex:null,originalEvent:e}),Qi!==wn?(oa>=0&&(Zs({rootEl:wn,name:"add",toEl:wn,fromEl:Qi,originalEvent:e}),Zs({sortable:this,name:"remove",toEl:wn,originalEvent:e}),Zs({rootEl:wn,name:"sort",toEl:wn,fromEl:Qi,originalEvent:e}),Zs({sortable:this,name:"sort",toEl:wn,originalEvent:e})),Qr&&Qr.save()):oa!==__&&oa>=0&&(Zs({sortable:this,name:"update",toEl:wn,originalEvent:e}),Zs({sortable:this,name:"sort",toEl:wn,originalEvent:e})),Xe.active&&((oa==null||oa===-1)&&(oa=__,qp=h2),Zs({sortable:this,name:"end",toEl:wn,originalEvent:e}),this.save()))),this._nulling()},_nulling:function(){fo("nulling",this),Qi=me=wn=at=kg=dn=uE=Kp=bm=Rl=gx=oa=qp=__=h2=K0=d2=Qr=oC=Xe.dragged=Xe.ghost=Xe.clone=Xe.active=null,S$.forEach(function(e){e.checked=!0}),S$.length=fL=mL=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":me&&(this._onDragOver(e),Yqe(e));break;case"selectstart":e.preventDefault();break}},toArray:function(){for(var e=[],i,n=this.el.children,r=0,s=n.length,o=this.options;r<s;r++)i=n[r],du(i,o.draggable,this.el,!1)&&e.push(i.getAttribute(o.dataIdAttr)||iWe(i));return e},sort:function(e,i){var n={},r=this.el;this.toArray().forEach(function(s,o){var a=r.children[o];du(a,this.options.draggable,r,!1)&&(n[s]=a)},this),i&&this.captureAnimationState(),e.forEach(function(s){n[s]&&(r.removeChild(n[s]),r.appendChild(n[s]))}),i&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,i){return du(e,i||this.options.draggable,this.el,!1)},option:function(e,i){var n=this.options;if(i===void 0)return n[e];var r=bT.modifyOption(this,e,i);typeof r<"u"?n[e]=r:n[e]=i,e==="group"&&kde(n)},destroy:function(){fo("destroy",this);var e=this.el;e[ma]=null,Dt(e,"mousedown",this._onTapStart),Dt(e,"touchstart",this._onTapStart),Dt(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(Dt(e,"dragover",this),Dt(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),function(i){i.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),x$.splice(x$.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!Kp){if(fo("hideClone",this),Xe.eventCanceled)return;Ye(dn,"display","none"),this.options.removeCloneOnHide&&dn.parentNode&&dn.parentNode.removeChild(dn),Kp=!0}},_showClone:function(e){if(e.lastPutMode!=="clone"){this._hideClone();return}if(Kp){if(fo("showClone",this),Xe.eventCanceled)return;me.parentNode==Qi&&!this.options.group.revertClone?Qi.insertBefore(dn,me):kg?Qi.insertBefore(dn,kg):Qi.appendChild(dn),this.options.group.revertClone&&this.animate(me,dn),Ye(dn,"display",""),Kp=!1}}};function Yqe(t){t.dataTransfer&&(t.dataTransfer.dropEffect="move"),t.cancelable&&t.preventDefault()}function cC(t,e,i,n,r,s,o,a){var l,c=t[ma],u=c.options.onMove,d;return window.CustomEvent&&!bd&&!_T?l=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(l=document.createEvent("Event"),l.initEvent("move",!0,!0)),l.to=e,l.from=t,l.dragged=i,l.draggedRect=n,l.related=r||e,l.relatedRect=s||_r(e),l.willInsertAfter=a,l.originalEvent=o,t.dispatchEvent(l),u&&(d=u.call(c,l,o)),d}function yL(t){t.draggable=!1}function Xqe(){BF=!1}function Kqe(t,e,i){var n=_r(Ib(i.el,0,i.options,!0)),r=10;return e?t.clientX<n.left-r||t.clientY<n.top&&t.clientX<n.right:t.clientY<n.top-r||t.clientY<n.bottom&&t.clientX<n.left}function Qqe(t,e,i){var n=_r(B8(i.el,i.options.draggable)),r=10;return e?t.clientX>n.right+r||t.clientX<=n.right&&t.clientY>n.bottom&&t.clientX>=n.left:t.clientX>n.right&&t.clientY>n.top||t.clientX<=n.right&&t.clientY>n.bottom+r}function eWe(t,e,i,n,r,s,o,a){var l=n?t.clientY:t.clientX,c=n?i.height:i.width,u=n?i.top:i.left,d=n?i.bottom:i.right,f=!1;if(!o){if(a&&hE<c*r){if(!p2&&(d2===1?l>u+c*s/2:l<d-c*s/2)&&(p2=!0),p2)f=!0;else if(d2===1?l<u+hE:l>d-hE)return-d2}else if(l>u+c*(1-r)/2&&l<d-c*(1-r)/2)return tWe(e)}return f=f||o,f&&(l<u+c*s/2||l>d-c*s/2)?l>u+c/2?1:-1:0}function tWe(t){return Ya(me)<Ya(t)?1:-1}function iWe(t){for(var e=t.tagName+t.className+t.src+t.href+t.textContent,i=e.length,n=0;i--;)n+=e.charCodeAt(i);return n.toString(36)}function nWe(t){S$.length=0;for(var e=t.getElementsByTagName("input"),i=e.length;i--;){var n=e[i];n.checked&&S$.push(n)}}function dE(t){return setTimeout(t,0)}function UF(t){return clearTimeout(t)}_k&&ti(document,"touchmove",function(t){(Xe.active||e_)&&t.cancelable&&t.preventDefault()});Xe.utils={on:ti,off:Dt,css:Ye,find:Cde,is:function(e,i){return!!du(e,i,e,!1)},extend:zqe,throttle:Mde,closest:du,toggleClass:ta,clone:Ade,index:Ya,nextTick:dE,cancelNextTick:UF,detectDirection:Pde,getChild:Ib};Xe.get=function(t){return t[ma]};Xe.mount=function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];e[0].constructor===Array&&(e=e[0]),e.forEach(function(n){if(!n.prototype||!n.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(n));n.utils&&(Xe.utils=Fu(Fu({},Xe.utils),n.utils)),bT.mount(n)})};Xe.create=function(t,e){return new Xe(t,e)};Xe.version=Dqe;var Zn=[],yx,GF,HF=!1,vL,_L,T$,vx;function rWe(){function t(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var e in this)e.charAt(0)==="_"&&typeof this[e]=="function"&&(this[e]=this[e].bind(this))}return t.prototype={dragStarted:function(i){var n=i.originalEvent;this.sortable.nativeDraggable?ti(document,"dragover",this._handleAutoScroll):this.options.supportPointer?ti(document,"pointermove",this._handleFallbackAutoScroll):n.touches?ti(document,"touchmove",this._handleFallbackAutoScroll):ti(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(i){var n=i.originalEvent;!this.options.dragOverBubble&&!n.rootEl&&this._handleAutoScroll(n)},drop:function(){this.sortable.nativeDraggable?Dt(document,"dragover",this._handleAutoScroll):(Dt(document,"pointermove",this._handleFallbackAutoScroll),Dt(document,"touchmove",this._handleFallbackAutoScroll),Dt(document,"mousemove",this._handleFallbackAutoScroll)),sZ(),pE(),Vqe()},nulling:function(){T$=GF=yx=HF=vx=vL=_L=null,Zn.length=0},_handleFallbackAutoScroll:function(i){this._handleAutoScroll(i,!0)},_handleAutoScroll:function(i,n){var r=this,s=(i.touches?i.touches[0]:i).clientX,o=(i.touches?i.touches[0]:i).clientY,a=document.elementFromPoint(s,o);if(T$=i,n||this.options.forceAutoScrollFallback||_T||bd||c2){bL(i,this.options,a,n);var l=vf(a,!0);HF&&(!vx||s!==vL||o!==_L)&&(vx&&sZ(),vx=setInterval(function(){var c=vf(document.elementFromPoint(s,o),!0);c!==l&&(l=c,pE()),bL(i,r.options,c,n)},10),vL=s,_L=o)}else{if(!this.options.bubbleScroll||vf(a,!0)===Au()){pE();return}bL(i,this.options,vf(a,!1),!1)}}},dd(t,{pluginName:"scroll",initializeByDefault:!0})}function pE(){Zn.forEach(function(t){clearInterval(t.pid)}),Zn=[]}function sZ(){clearInterval(vx)}var bL=Mde(function(t,e,i,n){if(e.scroll){var r=(t.touches?t.touches[0]:t).clientX,s=(t.touches?t.touches[0]:t).clientY,o=e.scrollSensitivity,a=e.scrollSpeed,l=Au(),c=!1,u;GF!==i&&(GF=i,pE(),yx=e.scroll,u=e.scrollFn,yx===!0&&(yx=vf(i,!0)));var d=0,f=yx;do{var m=f,g=_r(m),y=g.top,_=g.bottom,b=g.left,w=g.right,x=g.width,S=g.height,T=void 0,I=void 0,C=m.scrollWidth,M=m.scrollHeight,E=Ye(m),A=m.scrollLeft,$=m.scrollTop;m===l?(T=x<C&&(E.overflowX==="auto"||E.overflowX==="scroll"||E.overflowX==="visible"),I=S<M&&(E.overflowY==="auto"||E.overflowY==="scroll"||E.overflowY==="visible")):(T=x<C&&(E.overflowX==="auto"||E.overflowX==="scroll"),I=S<M&&(E.overflowY==="auto"||E.overflowY==="scroll"));var L=T&&(Math.abs(w-r)<=o&&A+x<C)-(Math.abs(b-r)<=o&&!!A),D=I&&(Math.abs(_-s)<=o&&$+S<M)-(Math.abs(y-s)<=o&&!!$);if(!Zn[d])for(var F=0;F<=d;F++)Zn[F]||(Zn[F]={});(Zn[d].vx!=L||Zn[d].vy!=D||Zn[d].el!==m)&&(Zn[d].el=m,Zn[d].vx=L,Zn[d].vy=D,clearInterval(Zn[d].pid),(L!=0||D!=0)&&(c=!0,Zn[d].pid=setInterval((function(){n&&this.layer===0&&Xe.active._onTouchMove(T$);var z=Zn[this.layer].vy?Zn[this.layer].vy*a:0,U=Zn[this.layer].vx?Zn[this.layer].vx*a:0;typeof u=="function"&&u.call(Xe.dragged.parentNode[ma],U,z,t,T$,Zn[this.layer].el)!=="continue"||Ede(Zn[this.layer].el,U,z)}).bind({layer:d}),24))),d++}while(e.bubbleScroll&&f!==l&&(f=vf(f,!1)));HF=c}},30),Rde=function(e){var i=e.originalEvent,n=e.putSortable,r=e.dragEl,s=e.activeSortable,o=e.dispatchSortableEvent,a=e.hideGhostForTarget,l=e.unhideGhostForTarget;if(i){var c=n||s;a();var u=i.changedTouches&&i.changedTouches.length?i.changedTouches[0]:i,d=document.elementFromPoint(u.clientX,u.clientY);l(),c&&!c.el.contains(d)&&(o("spill"),this.onSpill({dragEl:r,putSortable:n}))}};function U8(){}U8.prototype={startIndex:null,dragStart:function(e){var i=e.oldDraggableIndex;this.startIndex=i},onSpill:function(e){var i=e.dragEl,n=e.putSortable;this.sortable.captureAnimationState(),n&&n.captureAnimationState();var r=Ib(this.sortable.el,this.startIndex,this.options);r?this.sortable.el.insertBefore(i,r):this.sortable.el.appendChild(i),this.sortable.animateAll(),n&&n.animateAll()},drop:Rde};dd(U8,{pluginName:"revertOnSpill"});function G8(){}G8.prototype={onSpill:function(e){var i=e.dragEl,n=e.putSortable,r=n||this.sortable;r.captureAnimationState(),i.parentNode&&i.parentNode.removeChild(i),r.animateAll()},drop:Rde};dd(G8,{pluginName:"removeOnSpill"});Xe.mount(new rWe);Xe.mount(G8,U8);function oZ(t,e,i){t.splice(i,0,t.splice(e,1)[0])}const sWe="esri-layerlist-new-ui",oWe=xe.ofType(j8),aZ="data-sort-filter",lZ="data-layer-uid",aWe="layerUid",xn="esri-layer-list",Yi=`${xn}__item`,Te={base:`${xn} esri-widget esri-widget--panel`,newUI:`${xn}--new-ui`,noItems:`${xn}__no-items`,list:`${xn}__list`,listRoot:`${xn}__list--root`,listExclusive:`${xn}__list--exclusive`,listInherited:`${xn}__list--inherited`,listIndependent:`${xn}__list--independent`,item:Yi,itemContent:`${Yi}-content`,itemMessage:`${Yi}--has-message`,itemInvisible:`${Yi}--invisible`,itemInvisibleAtScale:`${Yi}--invisible-at-scale`,itemChildren:`${Yi}--has-children`,itemSelectable:`${Yi}--selectable`,itemContainer:`${Yi}-container`,actionsMenu:`${Yi}-actions-menu`,actionsMenuItem:`${Yi}-actions-menu-item`,actionsMenuItemActive:`${Yi}-actions-menu-item--active`,actions:`${Yi}-actions`,actionsList:`${Yi}-actions-list`,action:`${Yi}-action`,actionIcon:`${Yi}-action-icon`,actionImage:`${Yi}-action-image`,actionTitle:`${Yi}-action-title`,actionToggle:`${xn}__action-toggle`,actionToggleOn:`${xn}__action-toggle--on`,label:`${Yi}-label`,message:`${Yi}-message`,title:`${Yi}-title`,statusIndicator:`${xn}__status-indicator`,publishing:`${xn}__publishing`,updating:`${xn}__updating`,connectionStatus:`${xn}__connection-status`,connectionStatusConnected:`${xn}__connection-status--connected`,toggleVisible:`${Yi}-toggle`,toggleVisibleIcon:`${Yi}-toggle-icon`,toggleIcon:`${Yi}-toggle-icon`,radioIcon:`${Yi}-radio-icon`,childToggle:`${xn}__child-toggle`,childToggleOpen:`${xn}__child-toggle--open`,childOpened:`${xn}__child-toggle-icon--opened`,childClosed:`${xn}__child-toggle-icon--closed`,childClosed_RTL:`${xn}__child-toggle-icon--closed-rtl`,sortableChosen:`${xn}--chosen`,disabled:"esri-disabled",disabledElement:"esri-disabled-element",hidden:"esri-hidden",rotating:"esri-rotating",iconEllipses:"esri-icon-handle-horizontal",iconVisible:"esri-icon-visible",iconInvisible:"esri-icon-non-visible",iconRadioSelected:"esri-icon-radio-checked",iconRadioUnselected:"esri-icon-radio-unchecked",iconNoticeTriangle:"esri-icon-notice-triangle",iconChildrenOpen:"esri-icon-down-arrow",iconDownArrow:"esri-icon-down-arrow",iconRightArrow:"esri-icon-right-triangle-arrow",iconLeftArrow:"esri-icon-left-triangle-arrow",iconLoading:"esri-icon-loading-indicator",iconDefaultAction:"esri-icon-default-action",widgetIcon:"esri-icon-layers"},Wd={actions:"actions",actionSection:"action-section",items:"items"},H1={exclusive:"exclusive",inherited:"inherited",independent:"independent"};function Dde(t){const{actionsOpen:e,children:i}=t;e&&(t.actionsOpen=!1),i.forEach(n=>Dde(n))}const wL="root",cZ={statusIndicators:!0,errors:!1};let $i=class extends qi{constructor(e,i){super(e,i),this._sortableNodes=new Map,this._sortableMap=new Map,this._focusSortUid=null,this._newUI=ee(sWe),this._tooltipReferenceMap=new Map,this.visibleItems=null,this.iconClass=Te.widgetIcon,this.icon=null,this.listItemCanGiveFunction=null,this.listItemCanReceiveFunction=null,this.messages=null,this.messagesCommon=null,this.multipleSelectionEnabled=!1,this.selectionEnabled=!1,this.selectedItems=new oWe,this.viewModel=new xde,this.visibleElements={...cZ},this._onSortableSort=({to:n,from:r,item:s,newIndex:o})=>{r&&n&&(r===n?this._sortLayers(this._sortableMap.get(r.dataset.group)):this._moveLayerFromChildList({to:n,from:r,item:s,newIndex:o}))},this._sortableCanSort=(n,r)=>!(!n.el.dataset.group||!r.el.dataset.group),this._sortableCanPull=(n,r,s)=>{const{listItemCanGiveFunction:o}=this,a={selected:Cr(s),from:Cr(r.el),to:Cr(n.el)};return!this._sortableCanSort(n,r)||typeof o!="function"||o.call(null,a)},this._sortableCanPut=(n,r,s)=>{const{listItemCanReceiveFunction:o}=this,a={selected:Cr(s),from:Cr(r.el),to:Cr(n.el)};return!this._sortableCanSort(n,r)||typeof o!="function"||o.call(null,a)},this._onSortableEnd=({oldIndex:n,from:r,to:s,item:o})=>{r!==s&&r.insertBefore(o,r.children[n])}}initialize(){const e=this.operationalItems;this._setVisibleItems(e),this.addHandles([on(()=>this.operationalItems,"change",()=>this._itemsChanged(e)),Q(()=>this.visibleElements,()=>this._itemsChanged(e)),Q(()=>this.selectionEnabled,()=>this._toggleAllSorting(),He)])}loadDependencies(){return NP({icon:()=>Y(()=>import("./calcite-icon-83ed4825.js"),["./calcite-icon-83ed4825.js","./icon-26983b54.js","./observers-9352e65c.js"],import.meta.url),tooltip:()=>Y(()=>import("./calcite-tooltip-a4bd2ff1.js"),["./calcite-tooltip-a4bd2ff1.js","./tooltip-c9bd78a8.js","./browser-14ab28bd.js","./debounce-9700caea.js","./guid-40d04074.js"],import.meta.url)})}destroy(){this.removeAllHandles(),this._destroySortables(),this._tooltipReferenceMap.clear()}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get listItemCreatedFunction(){return this.viewModel.listItemCreatedFunction}set listItemCreatedFunction(e){this.viewModel.listItemCreatedFunction=e}get operationalItems(){return this.viewModel.operationalItems}set operationalItems(e){this.viewModel.operationalItems=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}castVisibleElements(e){return{...cZ,...e}}triggerAction(e,i){return this.viewModel.triggerAction(e,i)}render(){var a;const{visibleItems:e,_newUI:i}=this,n=(a=this.viewModel)==null?void 0:a.state,r={[Te.newUI]:i,[Te.hidden]:n==="loading",[Te.disabled]:n==="disabled"},s=this.renderItemTooltips(),o=this.renderItems();return O("div",{class:this.classes(Te.base,r)},e.length?[s,o]:this.renderNoItems())}renderItemTooltip(e){const{_tooltipReferenceMap:i,messages:n}=this;return e?O("calcite-tooltip",{label:n.layerIncompatible,referenceElement:i.get(e.uid)},n.layerIncompatibleTooltip):null}renderItemTooltipNodes(e){const{incompatible:i,children:n}=e;return[i?this.renderItemTooltip(e):null,...!i&&n?n.toArray().map(r=>this.renderItemTooltipNodes(r)):[]]}renderItemTooltips(){return this.visibleItems.toArray().map(e=>this.renderItemTooltipNodes(e))??[]}renderNoItems(){return O("div",{class:Te.noItems},this.messages.noItemsToDisplay)}renderItems(){const{visibleItems:e,selectionEnabled:i,messages:n}=this;return O("ul",{"aria-label":n.widgetLabel,role:i?"listbox":void 0,afterCreate:this._sortNodeCreated,afterUpdate:this._sortNodeCreated,afterRemoved:this._sortNodeRemoved,"data-group":wL,bind:this,class:this.classes(Te.list,Te.listRoot,Te.listIndependent)},e.map(r=>this.renderItem(r,null)).toArray())}renderActionsMenuIcon(e,i){const{messagesCommon:n}=this,r={[Te.actionsMenuItemActive]:e.actionsOpen};return O("div",{key:"actions-menu-toggle","data-item":e,bind:this,onclick:this._toggleActionsOpen,onkeydown:this._toggleActionsOpen,class:this.classes(Te.actionsMenuItem,r),tabindex:"0",role:"button","aria-controls":i,"aria-label":n.options,title:n.options},O("span",{"aria-hidden":"true",class:Te.iconEllipses}))}renderActionsMenu(e,i,n,r){const{panel:s}=e,o=s&&s.visible?this.renderPanelButton(s):null,a=n===1&&this._getSingleActionButton(i),l=a?this.renderAction({item:e,action:a,singleAction:!0}):null,c=!a&&n?this.renderActionsMenuIcon(e,r):null;return c||o||a?O("div",{key:"actions-menu",class:Te.actionsMenu},o,l,c):null}renderChildList(e,i){var d;const{selectionEnabled:n}=this,{visibilityMode:r,children:s}=e,o=this._hasChildren(e),a=!o&&n&&((d=e.layer)==null?void 0:d.type)==="group",{exclusive:l,inherited:c}=H1,u={[Te.listExclusive]:r===l,[Te.listInherited]:r===c,[Te.listIndependent]:r!==c&&r!==l};return o||a?O("ul",{bind:this,key:"list-items",id:i,"data-group":e.uid,"data-item":e,afterCreate:this._sortNodeCreated,afterUpdate:this._sortNodeCreated,afterRemoved:this._sortNodeRemoved,class:this.classes(Te.list,u),"aria-expanded":e.open?"true":"false",role:n?"listbox":r===l?"radiogroup":"group",hidden:!e.open&&!a||null},s==null?void 0:s.map(f=>this.renderItem(f,e)).toArray()):null}renderChildrenToggle(e,i){const{messagesCommon:n}=this,r=this._hasChildren(e),s={[Te.childToggleOpen]:e.open},o=e.open?n.collapse:n.expand;return r?O("span",{onclick:this._toggleChildrenClick,onkeydown:this._toggleChildrenClick,"data-item":e,key:"toggle-children",class:this.classes(Te.childToggle,s),tabindex:"0",role:"button","aria-controls":i,"aria-label":o,title:o},O("span",{"aria-hidden":"true",class:this.classes(Te.childClosed,Te.iconRightArrow)}),O("span",{"aria-hidden":"true",class:this.classes(Te.childOpened,Te.iconDownArrow)}),O("span",{"aria-hidden":"true",class:this.classes(Te.childClosed_RTL,Te.iconLeftArrow)})):null}renderItemMessage(e){return e.error?O("div",{key:"esri-layer-list__error",class:Te.message,role:"alert"},O("span",{"aria-hidden":"true",class:Te.iconNoticeTriangle}),this.messages.layerError):e.incompatible?O("div",{key:"esri-layer-list__incompatible",class:Te.message,role:"alert"},O("span",{bind:this,tabIndex:0,"aria-hidden":"true",class:Te.iconNoticeTriangle,afterCreate:i=>this._setTooltipReference(i,e)}),this.messages.layerIncompatible):null}renderItemContent(e,i,n){const{id:r}=this,s=`${r}_${e.uid}`,o=`${s}_actions`,a=`${s}__list`,{panel:l}=e,c=this._filterActions(e.actionsSections),u=this._countActions(c);return[O("div",{key:"list-item-container",class:Te.itemContainer},this.renderChildrenToggle(e,a),this.renderLabel(e,i,n),this.renderActionsMenu(e,c,u,o)),this.renderItemMessage(e),u?this.renderActionsSections(e,c,o):null,l&&l.open&&!l.disabled?l.render():null,this.renderChildList(e,a)]}renderItem(e,i){var d;const{_newUI:n,id:r,selectionEnabled:s,selectedItems:o}=this,a=`${`${r}_${e.uid}`}__title`,l=this._hasMessage(e),c=this._hasChildren(e),u={[Te.itemChildren]:c,[Te.itemMessage]:!!l,[Te.itemInvisible]:n&&!e.visible,[Te.itemInvisibleAtScale]:!e.visibleAtCurrentScale,[Te.itemSelectable]:s};if(s){const f={[lZ]:(d=e.layer)==null?void 0:d.uid,[aZ]:(!e.sortable).toString()};return O("li",{key:`item-with-selection-${e.uid}`,bind:this,afterCreate:this._focusListItem,afterUpdate:this._focusListItem,class:this.classes(Te.item,u),"aria-labelledby":a,onclick:this._toggleSelection,onkeydown:this._selectionKeydown,"data-item":e,"data-group":i?i.uid:wL,tabIndex:0,"aria-selected":uL(e,o)?"true":"false",role:"option",...f},this.renderItemContent(e,i,a))}return O("li",{key:`item-no-selection-${e.uid}`,bind:this,afterCreate:this._focusListItem,afterUpdate:this._focusListItem,class:this.classes(Te.item,u),"aria-labelledby":a},this.renderItemContent(e,i,a))}renderConnectionIcon(e){const{connectionStatus:i}=e;return i!=null?O("calcite-icon",{icon:i==="connected"?"beacon":"offline",scale:"s"}):null}renderItemStatus(e,i){const{visibleElements:n}=this;if(!n.statusIndicators)return null;const{connectionStatus:r,publishing:s,updating:o}=e,a=o&&!i,l=!!r;return O("span",{class:this.classes({[Te.statusIndicator]:!0,[Te.publishing]:s,[Te.updating]:a,[Te.connectionStatus]:l,[Te.connectionStatusConnected]:l&&r==="connected"}),key:"layer-item-status"},this.renderConnectionIcon(e))}renderItemTitle(e,i){const{messages:n}=this;if(!e)return null;const r=e.title||n.untitledLayer,s=e.visibleAtCurrentScale?r:`${r} (${n.layerInvisibleAtScale})`;return O("span",{key:"layer-title-container",id:i,title:s,"aria-label":s,class:Te.title},r)}renderItemToggleIcon(e,i){const{_newUI:n}=this,{exclusive:r}=H1,s=i==null?void 0:i.visibilityMode,o={[Te.toggleVisibleIcon]:n,[Te.toggleIcon]:n&&s!==r,[Te.radioIcon]:n&&s===r,[Te.iconRadioSelected]:s===r&&e.visible,[Te.iconRadioUnselected]:s===r&&!e.visible,[Te.iconVisible]:s!==r&&e.visible,[Te.iconInvisible]:s!==r&&!e.visible};return O("span",{key:"item-toggle-icon",class:this.classes(o),"aria-hidden":"true"})}renderItemToggle(e,i,n){const{selectionEnabled:r,messages:s}=this,{exclusive:o}=H1,a=i==null?void 0:i.visibilityMode,l=a===o?"radio":"switch";return O("span",r?{key:"item-toggle-selection-enabled",class:Te.toggleVisible,bind:this,onclick:this._toggleVisibility,onkeydown:this._toggleVisibility,"data-item":e,"data-parent-visibility":a,tabIndex:0,title:s.layerVisibility,"aria-checked":e.visible?"true":"false",role:l,"aria-labelledby":n}:{key:"item-toggle",class:Te.toggleVisible},this.renderItemToggleIcon(e,i))}renderLabel(e,i,n){const{selectionEnabled:r,_newUI:s,messages:o}=this,{inherited:a,exclusive:l}=H1,c=i==null?void 0:i.visibilityMode,u=c===l?"radio":"switch",d=s?[this.renderItemTitle(e,n),this.renderItemStatus(e,i),this.renderItemToggle(e,i,n)]:[this.renderItemToggle(e,i,n),this.renderItemTitle(e,n),this.renderItemStatus(e,i)],f=O("div",r?{key:`item-label-no-selection-${e.uid}`,class:Te.label}:{key:`item-label-with-selection-${e.uid}`,class:Te.label,bind:this,onclick:this._toggleVisibility,onkeydown:this._toggleVisibility,"data-item":e,"data-parent-visibility":c,tabIndex:0,"aria-checked":e.visible?"true":"false",title:o.layerVisibility,role:u,"aria-labelledby":n},d);return c===a||e.error?O("div",{key:`item-label-container-${e.uid}`,class:Te.label},this.renderItemTitle(e,n),this.renderItemStatus(e,i)):f}renderPanelButton(e){const{className:i,open:n,title:r,image:s,disabled:o}=e,a=s||i?i:Te.iconDefaultAction,l=this._getIconImageStyles(e),c={[Te.actionsMenuItemActive]:n&&!o},u={[Te.actionImage]:!!l["background-image"],[Te.disabledElement]:e.disabled};return a&&(u[a]=!!a),O("div",{"aria-disabled":e.disabled.toString(),key:`panel-${e.uid}`,bind:this,"data-panel":e,onclick:this._triggerPanel,onkeydown:this._triggerPanel,class:this.classes(Te.actionsMenuItem,c),role:"button",tabindex:e.disabled?null:0,title:r,"aria-label":r},O("span",{class:this.classes(u),styles:l}))}renderActionsSections(e,i,n){const r=i.toArray().map((s,o)=>O("ul",{key:`${e}-action-section-${o}`,class:Te.actionsList},this.renderActionSection(e,s)));return O("div",{role:"group","aria-expanded":e.actionsOpen?"true":"false",key:"actions-section",id:n,class:Te.actions,hidden:!e.actionsOpen||null},r)}renderActionSection(e,i){return(i&&i.toArray()).map(n=>this.renderAction({item:e,action:n}))}renderActionIcon(e){const{active:i,className:n}=e,r=this._getIconImageStyles(e),s=e.type!=="button"||e.image||n?n:Te.iconDefaultAction,o={[Te.actionImage]:!i&&!!r["background-image"],[Te.iconLoading]:i,[Te.rotating]:i};return s&&!i&&(o[s]=!0),O("span",{key:"action-icon","aria-hidden":"true",class:this.classes(Te.actionIcon,o),styles:r})}renderActionTitle(e,i){return i?null:O("span",{key:"action-title",class:Te.actionTitle},e)}renderAction(e){const{item:i,action:n,singleAction:r}=e,{active:s,disabled:o,title:a}=n,l={[Te.actionsMenuItem]:r&&n.type==="button",[Te.action]:s||!r&&n.type!=="toggle",[Te.actionToggle]:!s&&n.type==="toggle",[Te.actionToggleOn]:!s&&n.type==="toggle"&&n.value,[Te.disabledElement]:o},c=[this.renderActionIcon(n),this.renderActionTitle(a,r)];return r?O("div",{bind:this,"data-item":i,"data-action":n,role:"button",key:`single-action-${n.uid}`,onclick:this._triggerAction,onkeydown:this._triggerAction,classes:l,tabindex:"0",title:a??void 0,"aria-label":a??void 0},c):O("li",{bind:this,"data-item":i,"data-action":n,key:`action-${n.uid}`,onclick:this._triggerAction,onkeydown:this._triggerAction,classes:l,tabindex:"0",role:"button",title:a??void 0,"aria-label":a??void 0},c)}_setTooltipReference(e,i){this._tooltipReferenceMap.set(i.uid,e),this.scheduleRender()}_hasMessage(e){return!!e.error||e.incompatible}_hasChildren(e){return!!e.children.length&&!this._hasMessage(e)}_sortNodeRemoved(e){const{_sortableMap:i}=this,n=e.dataset.group,r=i.get(n);r&&r.destroy(),i.delete(n)}_destroySortables(){const{_sortableMap:e,_sortableNodes:i}=this;e.forEach(n=>n&&n.destroy()),e.clear(),i.clear()}_moveLayerFromChildList({to:e,from:i,item:n,newIndex:r}){const s=Cr(n),o=Cr(e),a=Cr(i);this.viewModel.moveListItem(s,a,o,r)}_sortLayers(e){var r,s;if(!e)return;const i=Cr(e.el),n=e.toArray();i?Iqe(i,n):yde((s=(r=this.view)==null?void 0:r.map)==null?void 0:s.layers,n)}_toggleSorting(e,i){const{_sortableMap:n,selectionEnabled:r}=this,s=n.get(i),o=Cr(e),a=(i===wL||(o==null?void 0:o.childrenSortable)&&xqe(o))&&r;if(s)s.option("disabled",!a);else if(a){const l=Xe.create(e,{dataIdAttr:lZ,group:{name:i,pull:this._sortableCanPull,put:this._sortableCanPut},filter:`[${aZ}="true"]`,fallbackTolerance:4,onSort:this._onSortableSort,onEnd:this._onSortableEnd,disabled:!a,chosenClass:Te.sortableChosen});n.set(i,l)}}_toggleAllSorting(){this._sortableNodes.forEach((e,i)=>this._toggleSorting(e,i))}_sortNodeCreated(e){const i=e.dataset.group;i&&(this._sortableNodes.set(i,e),this._toggleSorting(e,i))}_setVisibleItems(e){this.visibleItems=e.filter(i=>!i.hidden&&(this.visibleElements.errors||!i.error))}_getSingleActionButton(e){return e.reduce(i=>i).filter(i=>i&&i.type==="button").at(0)}_focusListItem(e){var r;const{_focusSortUid:i}=this;if(!e||!i)return;const n=Cr(e);((r=n==null?void 0:n.layer)==null?void 0:r.uid)===i&&(e.focus(),this._focusSortUid=null)}_watchActionSectionChanges(e){this.addHandles(e.on("change",this.scheduleRender.bind(this)),Wd.actionSection),e.forEach(i=>this._renderOnActionChanges(i))}_renderOnActionChanges(e){e.type!=="toggle"?e.type!=="slider"?this.addHandles(Q(()=>[e==null?void 0:e.className,e==null?void 0:e.image,e==null?void 0:e.id,e==null?void 0:e.title,e==null?void 0:e.visible],()=>this.scheduleRender(),He),Wd.actions):this.addHandles(Q(()=>[e==null?void 0:e.className,e==null?void 0:e.id,e==null?void 0:e.title,e==null?void 0:e.visible,e==null?void 0:e.value,e==null?void 0:e.displayValueEnabled,e==null?void 0:e.max,e==null?void 0:e.min,e==null?void 0:e.step],()=>this.scheduleRender(),He),Wd.actions):this.addHandles(Q(()=>[e==null?void 0:e.className,e==null?void 0:e.image,e==null?void 0:e.id,e==null?void 0:e.title,e==null?void 0:e.visible,e==null?void 0:e.value],()=>this.scheduleRender(),He),Wd.actions)}_renderOnItemChanges(e){this.addHandles([Q(()=>{var i,n,r;return[e==null?void 0:e.actionsOpen,e==null?void 0:e.visible,e==null?void 0:e.open,e==null?void 0:e.updating,e==null?void 0:e.connectionStatus,e==null?void 0:e.publishing,e==null?void 0:e.title,e==null?void 0:e.visibleAtCurrentScale,e==null?void 0:e.error,e==null?void 0:e.visibilityMode,e==null?void 0:e.panel,(i=e==null?void 0:e.panel)==null?void 0:i.title,(n=e==null?void 0:e.panel)==null?void 0:n.content,(r=e==null?void 0:e.panel)==null?void 0:r.className,e==null?void 0:e.sortable,e==null?void 0:e.childrenSortable]},()=>this.scheduleRender(),Oi),Q(()=>[e==null?void 0:e.hidden,e==null?void 0:e.error],()=>this._setVisibleItems(this.operationalItems)),e.actionsSections.on("change",()=>this.scheduleRender()),e.children.on("change",()=>this.scheduleRender())],Wd.items),e.children.forEach(i=>this._renderOnItemChanges(i)),e.actionsSections.forEach(i=>this._watchActionSectionChanges(i))}_itemsChanged(e){this.removeHandles(Wd.items),this.removeHandles(Wd.actions),this.removeHandles(Wd.actionSection),e.forEach(i=>this._renderOnItemChanges(i)),this._tooltipReferenceMap.clear(),this._setVisibleItems(e),this.scheduleRender()}_filterActions(e){return e.map(i=>i.filter(n=>n.visible))}_countActions(e){return e.reduce((i,n)=>i+n.length,0)}_getIconImageStyles(e){const i=e.declaredClass==="esri.widgets.LayerList.ListItemPanel"||e.declaredClass==="esri.support.Action.ActionButton"||e.declaredClass==="esri.support.Action.ActionToggle"?e.image:null;return{"background-image":i?`url("${i}")`:void 0}}_selectionKeydown(e){var g,y,_,b;const i=["ArrowDown","ArrowUp"],n=Uh(e);if(!i.includes(n))return void this._toggleSelection(e);e.stopPropagation();const r=e.currentTarget,s=Cr(r),{_sortableMap:o,selectedItems:a}=this,l=r.dataset.group,c=o.get(l);if(!c||!s)return;const u=uL(s,a),d=c.toArray(),f=e.target,m=d.indexOf(f.dataset[aWe]);if(m!==-1){if(n==="ArrowDown"){const w=m+1;if(w>=d.length)return;u?(oZ(d,m,w),c.sort(d),this._sortLayers(c),this._focusSortUid=(g=s.layer)==null?void 0:g.uid):(this._focusSortUid=(y=s.layer)==null?void 0:y.uid,this.scheduleRender())}if(n==="ArrowUp"){const w=m-1;if(w<=-1)return;u?(oZ(d,m,w),c.sort(d),this._sortLayers(c),this._focusSortUid=(_=s.layer)==null?void 0:_.uid):(this._focusSortUid=(b=s.layer)==null?void 0:b.uid,this.scheduleRender())}}}_toggleActionsOpen(e){const i=Cr(e.currentTarget);if(!i)return;const{actionsOpen:n}=i,r=!n;r&&this.operationalItems.forEach(s=>Dde(s)),i.actionsOpen=r,e.stopPropagation()}_triggerPanel(e){const i=lWe(e.currentTarget);e.stopPropagation(),i&&!i.disabled&&(i.open=!i.open)}_triggerAction(e){const i=e.currentTarget,n=cWe(i),r=Cr(i);n&&r&&(n.type==="toggle"&&(n.value=!n.value),this.triggerAction(n,r),e.stopPropagation())}_toggleVisibility(e){const i=e.currentTarget,n=i.getAttribute("data-parent-visibility"),r=Cr(i);r&&(n===H1.exclusive&&r.visible||(r.visible=!r.visible),e.stopPropagation())}_toggleChildrenClick(e){const i=Cr(e.currentTarget);i&&(i.open=!i.open,e.stopPropagation())}_toggleSelection(e){var a,l;e.stopPropagation();const{multipleSelectionEnabled:i,selectedItems:n}=this,r=Cr(e.currentTarget);if(!r)return;const s=uL(r,n),{length:o}=n;if(!i)return o&&!(s&&o===1)?(n.removeAll(),void n.add(r)):void(s?(a=n.remove)==null?void 0:a.call(n,s):n.add(r));s?(l=n.remove)==null||l.call(n,s):n.add(r)}get test(){return{visibleItems:this.visibleItems}}};function Cr(t){return t==null?void 0:t["data-item"]}function lWe(t){return t==null?void 0:t["data-panel"]}function cWe(t){return t==null?void 0:t["data-action"]}h([p()],$i.prototype,"visibleItems",void 0),h([p()],$i.prototype,"iconClass",void 0),h([p()],$i.prototype,"icon",void 0),h([p()],$i.prototype,"label",null),h([p()],$i.prototype,"listItemCanGiveFunction",void 0),h([p()],$i.prototype,"listItemCanReceiveFunction",void 0),h([p()],$i.prototype,"listItemCreatedFunction",null),h([p(),Zt("esri/widgets/LayerList/t9n/LayerList")],$i.prototype,"messages",void 0),h([p(),Zt("esri/t9n/common")],$i.prototype,"messagesCommon",void 0),h([p()],$i.prototype,"multipleSelectionEnabled",void 0),h([p()],$i.prototype,"operationalItems",null),h([p()],$i.prototype,"selectionEnabled",void 0),h([p()],$i.prototype,"selectedItems",void 0),h([p()],$i.prototype,"view",null),h([fhe("trigger-action"),p({type:xde})],$i.prototype,"viewModel",void 0),h([p()],$i.prototype,"visibleElements",void 0),h([ut("visibleElements")],$i.prototype,"castVisibleElements",null),h([Dr()],$i.prototype,"_toggleActionsOpen",null),h([Dr()],$i.prototype,"_triggerPanel",null),h([Dr()],$i.prototype,"_triggerAction",null),h([Dr()],$i.prototype,"_toggleVisibility",null),h([Dr()],$i.prototype,"_toggleChildrenClick",null),h([Dr()],$i.prototype,"_toggleSelection",null),$i=h([P("esri.widgets.LayerList")],$i);const uWe=$i;function ol(t){let e,i,n=[],r=!1;function s(...o){return r&&e===this&&hWe(o,n)||(i=t.apply(this,o),e=this,n=o,r=!0),i}return s}function hWe(t,e){if(t.length!==e.length)return!1;for(let i=0;i<t.length;++i)if(t[i]!==e[i])return!1;return!0}const cr="esri-elevation-profile",Mi={esriWidget:"esri-widget--panel esri-widget",esriWidgetDisabled:"esri-widget--disabled",buttonDisabled:"esri-button--disabled",widgetIcon:"esri-icon-elevation-profile",base:`${cr}`,portrait:`${cr}--portrait`,refined:`${cr}--refined`,mainContainer:`${cr}__main-container`,promptContainer:`${cr}__prompt-container`,header:`${cr}__header`,zoomOutButton:`${cr}__zoom-out-button esri-icon-zoom-out-magnifying-glass`,clearButton:`${cr}__clear-button esri-icon-trash`,actionButton:`${cr}__action-button esri-button`,sketchButton:`${cr}__sketch-button esri-button--primary`,sketchCancelButton:`${cr}__sketch-cancel-button esri-button--secondary`,sketchDoneButton:`${cr}__sketch-done-button esri-button--primary`,selectButton:`${cr}__select-button esri-button--secondary`,selectCancelButton:`${cr}__select-cancel-button esri-button--secondary`,chartContainer:`${cr}__chart-container`,chartSpinner:`${cr}__chart-spinner esri-icon-loading-indicator esri-rotating`,chartSpinnerVisible:`${cr}__chart-spinner--visible`,chartSpinnerSmall:`${cr}__chart-spinner--small`,footer:`${cr}__footer`},dWe={line:"amcharts-LineSeries",cursorEnabled:"amcharts-cursor--enabled",axisTooltip:"amcharts-axis-tooltip",seriesTooltip:"amcharts-series-tooltip"},pWe={base:"esri-elevation-profile-legend"},Dl="esri-elevation-profile-legend-item",$a={base:Dl,disabled:`${Dl}--disabled`,expanded:`${Dl}--expanded`,colorIndicator:`${Dl}__color-indicator`,header:`${Dl}__header`,content:`${Dl}__content`,collapseToggle:`${Dl}__collapse-toggle esri-button esri-button--tertiary`,collapseToggleIcon:`${Dl}__collapse-toggle__icon esri-icon-down`,label:`${Dl}__label`,labelDisabled:`${Dl}__label--disabled`,checkbox:`${Dl}__checkbox`},q1="esri-elevation-profile-statistics",xm={base:q1,statistic:`${q1}__statistic`,statisticLabel:`${q1}__statistic__label`,statisticValue:`${q1}__statistic__value`,slopeValue:`${q1}__slope-value`,slopeUpIcon:"esri-icon-arrow-up",slopeDownIcon:"esri-icon-arrow-down"},Sm="esri-elevation-profile-settings",Tm={base:`${Sm} esri-icon-handle-vertical`,popoverContent:`${Sm}__popover-content`,select:`${Sm}__select esri-select`,selectLabel:`${Sm}__select-label`,checkboxLabel:`${Sm}__checkbox-label`,checkbox:`${Sm}__checkbox`,uniformChartScalingCheckbox:`${Sm}__uniform-chart-scaling-checkbox`};let fWe=class{constructor(e){this._store=e}destroy(){this._store.destroy()}get(e){return this._store.get(e)}put(e,i){this._store.put(e,i,i.values.byteLength+256)}};function mWe(t){var r,s;const e="metric";if(t==null)return e;const i=t.map,n=(i&&"portalItem"in i?(r=i.portalItem)==null?void 0:r.portal:null)??nr.getDefault();switch(((s=n.user)==null?void 0:s.units)??n.units){case e:return e;case"english":return"imperial"}return Xve(t.spatialReference)??e}const gWe={readOnly:!0,get(){return mWe(this.view)}};function Nde(t,e,i,n){let r=null,s=1e3;typeof e=="number"?(s=e,n=i):(r=e??null,s=i);let o,a=0;const l=()=>{a=0,t.apply(n,o)},c=(...u)=>{r&&r.apply(n,u),o=u,s?a||(a=setTimeout(l,s)):l()};return c.remove=()=>{a&&(clearTimeout(a),a=0)},c.forceUpdate=()=>{a&&(clearTimeout(a),l())},c.hasPendingUpdates=()=>!!a,c}function Fde(t){return t?Rn:xWe}function yWe(t,e){return e!=null&&e.mode?e.mode:Fde(t).mode}function vWe(t,e){return e??Fde(t)}function zde(t,e){return yWe(t!=null&&t.hasZ,e)}function pgt(t,e){return vWe(t!=null&&!!t.hasZ,e)}function bk(t){const e=H8(t);return zde(t.geometry,e)}function Vde(t){const e=H8(t),i=zde(t.geometry,e);return{mode:i,offset:e!=null&&i!=="on-the-ground"?(e.offset??0)*zRe(e.unit??"meters"):0}}function wk(t){if(bk(t)==="on-the-ground")return!1;const e=H8(t),i=e!=null&&e.featureExpressionInfo?e.featureExpressionInfo.expression:null;return!(!i||i==="0")}function H8(t){return t.layer&&"elevationInfo"in t.layer?t.layer.elevationInfo:null}function fgt(t,e,i){if(i==null||!i.mode)return;const n=t.hasZ?t.z:0,r=i.offset!=null?i.offset:0;switch(i.mode){case"absolute-height":return n-r;case"on-the-ground":return 0;case"relative-to-ground":return n-((e.elevationProvider.getElevation(t.x,t.y,n,t.spatialReference,"ground")??0)+r);case"relative-to-scene":return n-((e.elevationProvider.getElevation(t.x,t.y,n,t.spatialReference,"scene")??0)+r)}}function _We(t,e,i,n=null){return Bde(t,e.x,e.y,e.hasZ?e.z:0,e.spatialReference,i,n)}function jde(t,e,i,n,r=null){return Bde(t,e[0],e[1],e.length>2?e[2]:0,i,n,r)}function Bde(t,e,i,n,r,s,o=null){if(s==null)return;const a=o!=null?o.mode:"absolute-height";if(a==="on-the-ground")return 0;const{absoluteZ:l}=bWe(e,i,n,r,t,s);return wWe(l,e,i,n,r,t,o,a)}function bWe(t,e,i,n,r,s){const o=s.offset!=null?s.offset:0;switch(s.mode){case"absolute-height":return{absoluteZ:i+o,elevation:0};case"on-the-ground":{const a=r.elevationProvider.getElevation(t,e,0,n,"ground")??0;return{absoluteZ:a,elevation:a}}case"relative-to-ground":{const a=r.elevationProvider.getElevation(t,e,i,n,"ground")??0;return{absoluteZ:i+a+o,elevation:a}}case"relative-to-scene":{const a=r.elevationProvider.getElevation(t,e,i,n,"scene")??0;return{absoluteZ:i+a+o,elevation:a}}}}function wWe(t,e,i,n,r,s,o,a){const l=o!=null&&o.offset!=null?o.offset:0;switch(a){case"absolute-height":return t-l;case"relative-to-ground":return t-((s.elevationProvider.getElevation(e,i,n,r,"ground")??0)+l);case"relative-to-scene":return t-((s.elevationProvider.getElevation(e,i,n,r,"scene")??0)+l)}}function mgt(t,e){if(e==null)return!1;const{mode:i}=e;return i!=null&&(t==="scene"&&i==="relative-to-scene"||t==="ground"&&i!=="absolute-height")}const Rn={mode:"absolute-height",offset:0},xWe={mode:"on-the-ground",offset:null};let SWe=class{};const TWe=SWe;function uZ(t,...e){let i="";for(let n=0;n<e.length;n++)i+=t[n]+e[n];return i+=t[t.length-1],i}(function(t){function e(n){return Math.round(n).toString()}function i(n){return n.toPrecision(8)}t.int=e,t.float=i})(uZ||(uZ={}));let IWe=class{constructor(){this.id=T_()}unload(){}};var I$;(function(t){t[t.Layer=0]="Layer",t[t.Object=1]="Object",t[t.Mesh=2]="Mesh",t[t.Line=3]="Line",t[t.Point=4]="Point",t[t.Material=5]="Material",t[t.Texture=6]="Texture",t[t.COUNT=7]="COUNT"})(I$||(I$={}));var tn;(function(t){t.POSITION="position",t.NORMAL="normal",t.NORMALCOMPRESSED="normalCompressed",t.UV0="uv0",t.AUXPOS1="auxpos1",t.AUXPOS2="auxpos2",t.COLOR="color",t.SYMBOLCOLOR="symbolColor",t.SIZE="size",t.TANGENT="tangent",t.OFFSET="offset",t.SUBDIVISIONFACTOR="subdivisionFactor",t.COLORFEATUREATTRIBUTE="colorFeatureAttribute",t.SIZEFEATUREATTRIBUTE="sizeFeatureAttribute",t.OPACITYFEATUREATTRIBUTE="opacityFeatureAttribute",t.DISTANCETOSTART="distanceToStart",t.UVMAPSPACE="uvMapSpace",t.BOUNDINGRECT="boundingRect",t.UVREGION="uvRegion",t.PROFILERIGHT="profileRight",t.PROFILEUP="profileUp",t.PROFILEVERTEXANDNORMAL="profileVertexAndNormal",t.FEATUREVALUE="featureValue",t.MODELORIGINHI="modelOriginHi",t.MODELORIGINLO="modelOriginLo",t.MODEL="model",t.MODELNORMAL="modelNormal",t.INSTANCECOLOR="instanceColor",t.INSTANCEFEATUREATTRIBUTE="instanceFeatureAttribute",t.LOCALTRANSFORM="localTransform",t.GLOBALTRANSFORM="globalTransform",t.BOUNDINGSPHERE="boundingSphere",t.MODELORIGIN="modelOrigin",t.MODELSCALEFACTORS="modelScaleFactors",t.FEATUREATTRIBUTE="featureAttribute",t.STATE="state",t.LODLEVEL="lodLevel",t.POSITION0="position0",t.POSITION1="position1",t.NORMALA="normalA",t.NORMALB="normalB",t.COMPONENTINDEX="componentIndex",t.VARIANTOFFSET="variantOffset",t.VARIANTSTROKE="variantStroke",t.VARIANTEXTENSION="variantExtension",t.U8PADDING="u8padding",t.U16PADDING="u16padding",t.SIDENESS="sideness",t.START="start",t.END="end",t.UP="up",t.EXTRUDE="extrude",t.OBJECTANDLAYERIDCOLOR="objectAndLayerIdColor",t.INSTANCEOBJECTANDLAYERIDCOLOR="instanceObjectAndLayerIdColor"})(tn||(tn={}));const CWe=new Map([[tn.POSITION,0],[tn.NORMAL,1],[tn.NORMALCOMPRESSED,1],[tn.UV0,2],[tn.COLOR,3],[tn.COLORFEATUREATTRIBUTE,3],[tn.SIZE,4],[tn.TANGENT,4],[tn.AUXPOS1,5],[tn.SYMBOLCOLOR,5],[tn.AUXPOS2,6],[tn.FEATUREATTRIBUTE,6],[tn.INSTANCEFEATUREATTRIBUTE,6],[tn.INSTANCECOLOR,7],[tn.OBJECTANDLAYERIDCOLOR,7],[tn.INSTANCEOBJECTANDLAYERIDCOLOR,7],[tn.MODEL,8],[tn.MODELNORMAL,12],[tn.MODELORIGINHI,11],[tn.MODELORIGINLO,15]]);function MWe(t){return Math.abs(t*t*t)}function Ude(t,e,i){const n=i.parameters,r=i.paddingPixelsOverride;return W1.scale=Math.min(n.divisor/(e-n.offset),1),W1.factor=MWe(t),W1.minPixelSize=n.minPixelSize,W1.paddingPixels=r,W1}function Gde(t,e){return t===0?e.minPixelSize:e.minPixelSize*(1+2*e.paddingPixels/t)}function Hde(t,e){return Math.max(T6(t*e.scale,t,e.factor),Gde(t,e))}function EWe(t,e,i){const n=Ude(t,e,i);return n.minPixelSize=0,n.paddingPixels=0,Hde(1,n)}function vgt(t,e,i,n){n.scale=EWe(t,e,i),n.factor=0,n.minPixelSize=i.parameters.minPixelSize,n.paddingPixels=i.paddingPixelsOverride}function _gt(t,e,i=[0,0]){const n=Math.min(Math.max(e.scale,Gde(t[1],e)/Math.max(1e-5,t[1])),1);return i[0]=t[0]*n,i[1]=t[1]*n,i}function AWe(t,e,i,n){return Hde(t,Ude(e,i,n))}const W1={scale:0,factor:0,minPixelSize:0,paddingPixels:0};let $We=class{constructor(e){this.message=e}toString(){return`AssertException: ${this.message}`}};function PWe(t,e){if(!t){e=e||"Assertion";const i=new Error(e).stack;throw new $We(`${e} at ${i}`)}}function wgt(t,e){t||(e=e||"",console.warn("Verify failed: "+e+`
`+new Error("verify").stack))}function xgt(t,e,i,n){let r,s=(i[0]-t[0])/e[0],o=(n[0]-t[0])/e[0];s>o&&(r=s,s=o,o=r);let a=(i[1]-t[1])/e[1],l=(n[1]-t[1])/e[1];if(a>l&&(r=a,a=l,l=r),s>l||a>o)return!1;a>s&&(s=a),l<o&&(o=l);let c=(i[2]-t[2])/e[2],u=(n[2]-t[2])/e[2];return c>u&&(r=c,c=u,u=r),!(s>u||c>o)&&(u<o&&(o=u),!(o<0))}function Sgt(t,e,i,n,r,s=kt()){const o=(n[r]-i[r])*(e[0]-t[0])-(n[0]-i[0])*(e[r]-t[r]),a=(n[0]-i[0])*(t[r]-i[r])-(n[r]-i[r])*(t[0]-i[0]);if(o===0)return!1;const l=a/o;return s[0]=t[0]+l*(e[0]-t[0]),s[1]=t[r]+l*(e[r]-t[r]),!0}function Tgt(t,e){return Math.log(t)/Math.log(e)}function Igt(t,e,i,n){t[12]=e,t[13]=i,t[14]=n}function Cgt(t){return t[0]===1&&t[1]===0&&t[2]===0&&t[3]===0&&t[4]===0&&t[5]===1&&t[6]===0&&t[7]===0&&t[8]===0&&t[9]===0&&t[10]===1&&t[11]===0&&t[15]===1}const uC=mP();function Mgt(t,e,i,n,r,s){if(t.visible)if(t.boundingInfo){PWe(t.type===I$.Mesh);const o=e.tolerance;qde(t.boundingInfo,i,n,o,r,s)}else{const o=t.indices.get(tn.POSITION),a=t.vertexAttributes.get(tn.POSITION);Jde(i,n,0,o.length/3,o,a,void 0,r,s)}}const kWe=Me();function qde(t,e,i,n,r,s){if(t==null)return;const o=LWe(e,i,kWe);if(GSe(uC,t.bbMin),HSe(uC,t.bbMax),r!=null&&r.applyToAabb(uC),RWe(uC,e,o,n)){const{primitiveIndices:a,indices:l,position:c}=t,u=a?a.length:l.length/3;if(u>zWe){const d=t.getChildren();if(d!==void 0){for(const f of d)qde(f,e,i,n,r,s);return}}Jde(e,i,0,u,l,c,a,r,s)}}const Wde=Me();function Jde(t,e,i,n,r,s,o,a,l){if(o)return OWe(t,e,i,n,r,s,o,a,l);const{data:c,stride:u}=s,d=t[0],f=t[1],m=t[2],g=e[0]-d,y=e[1]-f,_=e[2]-m;for(let b=i,w=3*i;b<n;++b){let x=u*r[w++],S=c[x++],T=c[x++],I=c[x];x=u*r[w++];let C=c[x++],M=c[x++],E=c[x];x=u*r[w++];let A=c[x++],$=c[x++],L=c[x];a!=null&&([S,T,I]=a.applyToVertex(S,T,I,b),[C,M,E]=a.applyToVertex(C,M,E,b),[A,$,L]=a.applyToVertex(A,$,L,b));const D=C-S,F=M-T,z=E-I,U=A-S,G=$-T,W=L-I,Z=y*W-G*_,X=_*U-W*g,oe=g*G-U*y,se=D*Z+F*X+z*oe;if(Math.abs(se)<=Number.EPSILON)continue;const le=d-S,de=f-T,we=m-I,Re=le*Z+de*X+we*oe;if(se>0){if(Re<0||Re>se)continue}else if(Re>0||Re<se)continue;const ze=de*z-F*we,Ct=we*D-z*le,Ae=le*F-D*de,ke=g*ze+y*Ct+_*Ae;if(se>0){if(ke<0||Re+ke>se)continue}else if(ke>0||Re+ke<se)continue;const jt=(U*ze+G*Ct+W*Ae)/se;jt>=0&&l(jt,Zde(D,F,z,U,G,W,Wde),b,!1)}}function OWe(t,e,i,n,r,s,o,a,l){const{data:c,stride:u}=s,d=t[0],f=t[1],m=t[2],g=e[0]-d,y=e[1]-f,_=e[2]-m;for(let b=i;b<n;++b){const w=o[b];let x=3*w,S=u*r[x++],T=c[S++],I=c[S++],C=c[S];S=u*r[x++];let M=c[S++],E=c[S++],A=c[S];S=u*r[x];let $=c[S++],L=c[S++],D=c[S];a!=null&&([T,I,C]=a.applyToVertex(T,I,C,b),[M,E,A]=a.applyToVertex(M,E,A,b),[$,L,D]=a.applyToVertex($,L,D,b));const F=M-T,z=E-I,U=A-C,G=$-T,W=L-I,Z=D-C,X=y*Z-W*_,oe=_*G-Z*g,se=g*W-G*y,le=F*X+z*oe+U*se;if(Math.abs(le)<=Number.EPSILON)continue;const de=d-T,we=f-I,Re=m-C,ze=de*X+we*oe+Re*se;if(le>0){if(ze<0||ze>le)continue}else if(ze>0||ze<le)continue;const Ct=we*U-z*Re,Ae=Re*F-U*de,ke=de*z-F*we,jt=g*Ct+y*Ae+_*ke;if(le>0){if(jt<0||ze+jt>le)continue}else if(jt>0||ze+jt<le)continue;const gn=(G*Ct+W*Ae+Z*ke)/le;gn>=0&&l(gn,Zde(F,z,U,G,W,Z,Wde),w,!1)}}const hZ=Me(),dZ=Me();function Zde(t,e,i,n,r,s,o){return Di(hZ,t,e,i),Di(dZ,n,r,s),io(o,hZ,dZ),ss(o,o),o}function LWe(t,e,i){return Di(i,1/(e[0]-t[0]),1/(e[1]-t[1]),1/(e[2]-t[2]))}function RWe(t,e,i,n){return DWe(t,e,i,n,1/0)}function DWe(t,e,i,n,r){const s=(t[0]-n-e[0])*i[0],o=(t[3]+n-e[0])*i[0];let a=Math.min(s,o),l=Math.max(s,o);const c=(t[1]-n-e[1])*i[1],u=(t[4]+n-e[1])*i[1];if(l=Math.min(l,Math.max(c,u)),l<0||(a=Math.max(a,Math.min(c,u)),a>l))return!1;const d=(t[2]-n-e[2])*i[2],f=(t[5]+n-e[2])*i[2];return l=Math.min(l,Math.max(d,f)),!(l<0)&&(a=Math.max(a,Math.min(d,f)),!(a>l)&&a<r)}function Egt(t,e,i,n,r){let s=(i.screenLength||0)*t.pixelRatio;r!=null&&(s=AWe(s,n,e,r));const o=s*Math.tan(.5*t.fovY)/(.5*t.fullHeight);return rr(o*e,i.minWorldLength||0,i.maxWorldLength!=null?i.maxWorldLength:1/0)}function Yde(t,e){const i=e?Yde(e):{};for(const n in t){let r=t[n];r&&r.forEach&&(r=FWe(r)),r==null&&n in i||(i[n]=r)}return i}function NWe(t,e){let i=!1;for(const n in e){const r=e[n];r!==void 0&&(Array.isArray(r)?t[n]===null?(t[n]=r.slice(),i=!0):Mge(t[n],r)&&(i=!0):t[n]!==r&&(i=!0,t[n]=r))}return i}function FWe(t){const e=[];return t.forEach(i=>e.push(i)),e}const Agt={multiply:1,ignore:2,replace:3,tint:4},zWe=1e3;let $gt=class extends IWe{constructor(e,i){super(),this.type=I$.Material,this.supportsEdges=!1,this._visible=!0,this._renderPriority=0,this._insertOrder=0,this._vertexAttributeLocations=CWe,this._pp0=Ln(0,0,1),this._pp1=Ln(0,0,0),this._parameters=Yde(e,i),this.validateParameters(this._parameters)}dispose(){}get parameters(){return this._parameters}update(e){return!1}setParameters(e,i=!0){NWe(this._parameters,e)&&(this.validateParameters(this._parameters),i&&this.parametersChanged())}validateParameters(e){}get visible(){return this._visible}set visible(e){e!==this._visible&&(this._visible=e,this.parametersChanged())}shouldRender(e){return this.isVisible()&&this.isVisibleForOutput(e.output)&&(this.renderOccluded&e.renderOccludedMask)!=0}isVisibleForOutput(e){return!0}get renderOccluded(){return this.parameters.renderOccluded}get renderPriority(){return this._renderPriority}set renderPriority(e){e!==this._renderPriority&&(this._renderPriority=e,this.parametersChanged())}get insertOrder(){return this._insertOrder}set insertOrder(e){e!==this._insertOrder&&(this._insertOrder=e,this.parametersChanged())}get vertexAttributeLocations(){return this._vertexAttributeLocations}isVisible(){return this._visible}parametersChanged(){this.repository!=null&&this.repository.materialChanged(this)}intersectDraped(e,i,n,r,s,o){return this._pp0[0]=this._pp1[0]=r[0],this._pp0[1]=this._pp1[1]=r[1],this.intersect(e,i,n,this._pp0,this._pp1,s)}};var C$;(function(t){t[t.None=0]="None",t[t.Occlude=1]="Occlude",t[t.Transparent=2]="Transparent",t[t.OccludeAndTransparent=4]="OccludeAndTransparent",t[t.OccludeAndTransparentStencil=8]="OccludeAndTransparentStencil",t[t.Opaque=16]="Opaque"})(C$||(C$={}));let kgt=class extends TWe{constructor(){super(...arguments),this.renderOccluded=C$.Occlude}};var Po,Kn;(function(t){t.Disabled="disabled",t.Ready="ready",t.Creating="creating",t.Created="created",t.Selecting="selecting",t.Selected="selected"})(Po||(Po={})),function(t){t.NoValidInput="no-valid-input",t.NoVisibleProfiles="no-visible-profiles",t.InvalidGeometry="invalid-geometry",t.TooComplex="too-complex",t.InvalidElevationInfo="invalid-elevation-info",t.UnknownError="unknown-error",t.RefinedButNoChartData="refined-but-no-chart-data",t.None="none"}(Kn||(Kn={}));let Xde={noDataValue:-5e5,defaultQueryOptions:()=>({noDataValue:Xde.noDataValue,demResolution:"auto",maximumAutoTileRequests:150,ignoreInvisibleLayers:!0}),updateThrottleMillis:100,delayAfterPreviewMillis:500,defaultDemResolution:ht(10,"centimeters","meters"),densificationMaxSamples:3e3,largeChartSamples:1e4,maxTotalSamples:1e5,maxChartRatio:300,minSlopeSampleDistance:10,formatPrecision:1,portraitModePixelBreakpoint:400,profileLinesStyle3D:{width:3,outlineSize:0,falloff:0,outlineColor:zoe([1,1,1,0]),renderOccluded:C$.Opaque},hoveredPointsStyle:{size:14,borderStyle:"solid",borderWidth:3,borderColor:"#ffffff",boxShadow:"0px 0px 0px 5px rgba(255,255,255,0.2)"}};function Os(){return Xde}const Kde="  ",VWe={progress:1,hasZ:!1,samples:[],statistics:null,spatialReference:null};function Qde(t){if(!t)return null;if(n6(t)&&t.wkid){const e=UIe[t.wkid];if(e)return e}if(t.wkt){const e=jWe(t.wkt);if(e)return e}return null}function jWe(t){const e=jIe.exec(t);if(!e||e.length!==2)return null;const i=e[1].split(",");if(!i||i.length<3)return null;const n=parseFloat(i[1]),r=parseFloat(i[2]);return isNaN(n)||isNaN(r)?null:{a:n,f:r===0?0:1/r}}function xk(t){const e=Qde(t??Ee.WGS84);if(BWe(e))return e;const i=e.a*(1-e.f);return Object.assign(e,{b:i,eSq:1-(i/e.a)**2,radius:(2*e.a+i)/3,densificationRatio:1e4/((2*e.a+i)/3)})}function BWe(t){return t!=null&&"b"in t&&"eSq"in t&&"radius"in t}function hC(t,e,i){const{a:n,eSq:r}=xk(i),s=Math.sqrt(r),o=Math.sin(e[1]*Eo),a=n*e[0]*Eo;let l;return r>0?l=n*((1-r)*(o/(1-r*(o*o))-1/(2*s)*Math.log((1-s*o)/(1+s*o))))*.5:l=n*o,t[0]=a,t[1]=l,t}function Sk(t){return Qde(t)!==null}function Lgt(t,e="square-meters"){if(t.some(o=>!Sk(o.spatialReference)))throw new V("geodesic-areas:invalid-spatial-reference","the input geometries spatial reference is not supported");const i=[];for(let o=0;o<t.length;o++){const a=t[o],l=a.spatialReference,{radius:c,densificationRatio:u}=xk(l),d=c*u;i.push(GWe(a,d))}const n=[],r=[0,0],s=[0,0];for(let o=0;o<i.length;o++){const{rings:a,spatialReference:l}=i[o];let c=0;for(let u=0;u<a.length;u++){const d=a[u];hC(r,d[0],l),hC(s,d[d.length-1],l);let f=s[0]*r[1]-r[0]*s[1];for(let m=0;m<d.length-1;m++)hC(r,d[m+1],l),hC(s,d[m],l),f+=s[0]*r[1]-r[0]*s[1];c+=f}c=ht(c,"square-meters",e),n.push(c/-2)}return n}function UWe(t,e="meters"){if(!t)throw new V("geodesic-lengths:invalid-geometries","the input geometries type is not supported");if(t.some(n=>!Sk(n.spatialReference)))throw new V("geodesic-lengths:invalid-spatial-reference","the input geometries spatial reference is not supported");const i=[];for(let n=0;n<t.length;n++){const r=t[n],{spatialReference:s}=r,o=r.type==="polyline"?r.paths:r.rings;let a=0;for(let l=0;l<o.length;l++){const c=o[l];let u=0;for(let d=1;d<c.length;d++){const f=c[d-1][0],m=c[d][0],g=c[d-1][1],y=c[d][1];if(g!==y||f!==m){const _=new epe;q8(_,[f,g],[m,y],s),u+=_.distance}}a+=u}a=ht(a,"meters",e),i.push(a)}return i}function GWe(t,e){if(t.type!=="polyline"&&t.type!=="polygon")throw new V("geodesic-densify:invalid-geometry","the input geometry is neither polyline nor polygon");const{spatialReference:i}=t;if(!Sk(i))throw new V("geodesic-densify:invalid-spatial-reference","the input geometry spatial reference is not supported");const n=t.type==="polyline"?t.paths:t.rings,r=[],s=[0,0],o=new epe;for(const a of n){const l=[];r.push(l),l.push([a[0][0],a[0][1]]);let c,u,d=a[0][0],f=a[0][1];for(let m=0;m<a.length-1;m++){if(c=a[m+1][0],u=a[m+1][1],d===c&&f===u)continue;const g=[d,f];q8(o,[d,f],[c,u],i);const{azimuth:y,distance:_}=o,b=_/e;if(b>1){for(let w=1;w<=b-1;w++)U_(s,g,y,w*e,i),l.push(s.slice(0));U_(s,g,y,(_+Math.floor(b-1)*e)/2,i),l.push(s.slice(0))}U_(s,g,y,_,i),l.push(s.slice(0)),d=s[0],f=s[1]}}return t.type==="polyline"?new Ms({paths:r,spatialReference:i}):new Vr({rings:r,spatialReference:i})}let epe=class{constructor(e=0,i=void 0,n=void 0){this.distance=e,this.azimuth=i,this.reverseAzimuth=n}};function U_(t,e,i,n,r){const s=e[0],o=e[1],a=s*Eo,l=o*Eo,c=(i??0)*Eo,{a:u,b:d,f}=xk(r),m=Math.sin(c),g=Math.cos(c),y=(1-f)*Math.tan(l),_=1/Math.sqrt(1+y*y),b=y*_,w=Math.atan2(y,g),x=_*m,S=x*x,T=1-S,I=T*(u*u-d*d)/(d*d),C=1+I/16384*(4096+I*(I*(320-175*I)-768)),M=I/1024*(256+I*(I*(74-47*I)-128));let E,A,$,L,D=n/(d*C),F=2*Math.PI;for(;Math.abs(D-F)>1e-12;)$=Math.cos(2*w+D),E=Math.sin(D),A=Math.cos(D),L=M*E*($+M/4*(A*(2*$*$-1)-M/6*$*(4*E*E-3)*(4*$*$-3))),F=D,D=n/(d*C)+L;const z=b*E-_*A*g,U=Math.atan2(b*A+_*E*g,(1-f)*Math.sqrt(S+z*z)),G=Math.atan2(E*m,_*A-b*E*g),W=f/16*T*(4+f*(4-3*T)),Z=U/Eo,X=(a+(G-(1-W)*f*x*(D+W*E*($+W*A*(2*$*$-1)))))/Eo;return t[0]=X,t[1]=Z,t}function q8(t,e,i,n){const r=e[0]*Eo,s=e[1]*Eo,o=i[0]*Eo,a=i[1]*Eo,{a:l,b:c,f:u,radius:d}=xk(n),f=o-r,m=Math.atan((1-u)*Math.tan(s)),g=Math.atan((1-u)*Math.tan(a)),y=Math.sin(m),_=Math.cos(m),b=Math.sin(g),w=Math.cos(g);let x,S,T,I,C,M,E,A,$,L,D=1e3,F=f;do{if(E=Math.sin(F),A=Math.cos(F),T=Math.sqrt(w*E*(w*E)+(_*b-y*w*A)*(_*b-y*w*A)),T===0)return t.distance=0,t.azimuth=void 0,t.reverseAzimuth=void 0,t;C=y*b+_*w*A,M=Math.atan2(T,C),$=_*w*E/T,S=1-$*$,I=C-2*y*b/S,isNaN(I)&&(I=0),L=u/16*S*(4+u*(4-3*S)),x=F,F=f+(1-L)*u*$*(M+L*T*(I+L*C*(2*I*I-1)))}while(Math.abs(F-x)>1e-12&&--D>0);if(D===0){const X=d,oe=Math.acos(Math.sin(s)*Math.sin(a)+Math.cos(s)*Math.cos(a)*Math.cos(o-r))*X,se=o-r,le=Math.sin(se)*Math.cos(a),de=Math.cos(s)*Math.sin(a)-Math.sin(s)*Math.cos(a)*Math.cos(se),we=Math.atan2(le,de);return t.azimuth=we/Eo,t.distance=oe,t.reverseAzimuth=void 0,t}const z=S*(l*l-c*c)/(c*c),U=z/1024*(256+z*(z*(74-47*z)-128)),G=c*(1+z/16384*(4096+z*(z*(320-175*z)-768)))*(M-U*T*(I+U/4*(C*(2*I*I-1)-U/6*I*(4*T*T-3)*(4*I*I-3)))),W=Math.atan2(w*Math.sin(F),_*b-y*w*Math.cos(F)),Z=Math.atan2(_*Math.sin(F),_*b*Math.cos(F)-y*w);return t.azimuth=W/Eo,t.distance=G,t.reverseAzimuth=Z/Eo,t}const tpe="ProfileGenerationError";var al;(function(t){t.TooComplex="too-complex",t.InvalidGeometry="invalid-geometry",t.InvalidElevationInfo="invalid-elevation-info",t.ElevationQueryError="elevation-query-error"})(al||(al={}));let G_=class extends Error{constructor(e){super("profile could not be generated"),this.cause=e,this.type=tpe}};function HWe(t){return t.type===tpe}async function qWe(t,e,i,n,r,s,o){let a,l,c;const u=t.spatialReference,d=u.isGeographic||u.isWebMercator;let f=0;if(!d){const{planarLength:g}=await Y(()=>import("./geometryEngineAsync-50c17696.js"),[],import.meta.url);Vt(o),f=await g(t,"meters"),Vt(o)}const m=1/pi(n);if(d||f>=r.geodesicDistanceThreshold){await Ff([{source:u,dest:n},{source:u,dest:Ee.WGS84}],o);const g=nJe(t);a=UWe([g],"meters")[0];const y=pZ(a,r);if(gZ(t,a,y)>s)throw new G_(al.TooComplex);const _=fZ(g,e,i);({densifiedPath:l,distances:c}=YWe(_,y,m)),l=an(l,n)}else{await Ff([{source:u,dest:n}],o),a=f;const g=pZ(a,r);if(gZ(t,a,g)>s)throw new G_(al.TooComplex);const y=fZ(t,e,i);({densifiedPath:l,distances:c}=ZWe(y,g,m)),Vt(o),l=an(l,n)}return{densifiedPath:l,pathLength:a*m,distances:c}}function pZ(t,e){const i=t/e.densificationMaxSamples;return Math.max(e.samplingDistance,i)}function fZ(t,e,i){if(e==null)return mZ(t);const n=t.spatialReference,r=e.mode,s=e.offset??0;let o=null;switch(i.type){case"2d":o=WWe(t,r,s);break;case"3d":o=JWe(t,r,s,i)}return o==null?mZ(t):new Ms({hasZ:!0,hasM:!1,spatialReference:n,paths:ipe(t.paths,o)})}function WWe({hasZ:t},e,i){return e==="absolute-height"?t?([n,r,s])=>[n,r,s+i]:([n,r])=>[n,r,i]:null}function JWe({spatialReference:t,hasZ:e},i,n,{elevationProvider:r}){const s=(o,a,l,c)=>(r==null?void 0:r.getElevation(o,a,l,t,c))??0;switch(i){case"on-the-ground":return([o,a])=>[o,a,s(o,a,0,"ground")];case"absolute-height":return e?([o,a,l])=>[o,a,l+n]:([o,a])=>[o,a,n];case"relative-to-ground":return e?([o,a,l])=>[o,a,l+s(o,a,l,"ground")+n]:([o,a])=>[o,a,s(o,a,0,"ground")+n];case"relative-to-scene":return e?([o,a,l])=>[o,a,l+s(o,a,l,"scene")+n]:([o,a])=>[o,a,s(o,a,0,"scene")+n];default:return null}}function mZ(t){return t.hasZ?new Ms({hasZ:!1,hasM:!1,spatialReference:t.spatialReference,paths:ipe(t.paths,([e,i])=>[e,i])}):t}function ipe(t,e){const i=t.length,n=new Array(i);for(let r=0;r<i;++r){const s=t[r],o=s.length,a=new Array(s.length);n[r]=a;for(let l=0;l<o;++l)a[l]=e(s[l])}return n}function W8(t){return wT(t)&&t.paths.length>0&&t.paths.every(e=>e.length>=2)}function wT(t){return t!=null&&t.type==="polyline"}function npe(t,e,i,n,r){const{spatialReference:s,hasZ:o}=t,a={from:null,to:null,distance:0,azimuth:0,reverseAzimuth:0,spatialReference:s,metersPerSR:pi(s)},l=[],c=[];let u=0;for(let d=0;d<t.paths.length;++d){const f=t.paths[d],m=new Array,g=new Array;let y=0;for(let _=1;_<f.length;++_){const b=f[_-1],w=f[_],x=n(a,b,w);let S;for(S=y;S<x.distance;S+=e)m.push(r(x,S)),g.push((u+S)*i);y=S-x.distance,u+=x.distance,m.push(w),g.push(u*i)}l[d]=m,c[d]=g}return{densifiedPath:new Ms({spatialReference:s,hasZ:o,paths:l}),distances:c}}function ZWe(t,e,i){const{hasZ:n}=t;return npe(t,e,i,KWe,n?iJe:tJe)}function YWe(t,e,i){const{hasZ:n}=t;return npe(t,e,i,XWe,n?eJe:QWe)}function XWe(t,e,i){return t.distance=0,q8(t,e,i,t.spatialReference),t.from=e,t.to=i,t}function KWe(t,e,i){return t.from=e,t.to=i,t.distance=Xf(i,e)*t.metersPerSR,t}function QWe({from:t,azimuth:e,spatialReference:i},n){return U_([0,0],t,e,n,i)}function eJe({from:t,to:e,azimuth:i,distance:n,spatialReference:r},s){const o=s/n,a=[0,0,T6(t[2],e[2],o)];return U_(a,t,i,s,r),a}function tJe({from:t,to:e,distance:i},n){return PV([0,0],t,e,n/i)}function iJe({from:t,to:e,distance:i},n){return sP([0,0,0],t,e,n/i)}function nJe(t){return Sk(t.spatialReference)?t:an(t,Ee.WGS84)}function rpe(t){return t.paths.reduce((e,i)=>e+i.length,0)}function gZ(t,e,i){return rpe(t)+Math.floor(e/i)+Math.max(0,t.paths.reduce(n=>1+n,0)-1)}function rJe(t,e){const i=t.length;if(i===0)return null;const n=t[0],r=n.sampledZ;let s=r,o=r,a=0,l=0,c=null,u=null,d=r??0,f=0,m=0,g=r!=null?1:0,y=0,_=0;const b=pi(e),w=sd(e),x=Os().minSlopeSampleDistance/b,S=2*x,T=new yZ,I=new yZ,C=()=>{E(),T.copy(I),I.reset()},M=(A,$)=>{C(),A>0&&A-T.start<=S&&(A=T.start+x),I.restart(A,$)},E=()=>{if(T.isHole||I.isHole)return;const A=I.avgElevation-T.avgElevation,$=I.start-T.start,L=A*w,D=$*b,F=ht(Math.atan2(L,D),"radians","degrees");F>0?(f+=F,c=Fh(c,F),y++):F<0&&(m-=F,u=Fh(u,-F),_++)};n.sampledZ!=null&&M(n.distance,n.sampledZ);for(let A=1;A<i;++A){const $=t[A-1],L=t[A],D=L.sampledZ;if(D==null){I.isHole||C();continue}g++,d+=D,s=J8(s,D),o=Fh(o,D),I.isHole||L.distance-I.start>=x?M(L.distance,D):I.insert(D);const F=$.sampledZ;if(F!=null){const z=D-F;z>0?a+=z:z<0&&(l-=z)}}return C(),g===0?null:{maxDistance:t[i-1].distance,minElevation:s,maxElevation:o,avgElevation:g===0?null:d/g,elevationGain:a,elevationLoss:l,maxPositiveSlope:c,maxNegativeSlope:u,avgPositiveSlope:y===0?null:f/y,avgNegativeSlope:_===0?null:m/_}}function sJe(t){const e=t.filter(Ti),i=e.length;if(i===0)return null;const n=e[0];if(i===1)return n;let r=n.maxDistance,s=n.minElevation,o=n.maxElevation,a=n.maxPositiveSlope,l=n.maxNegativeSlope;for(let c=1;c<e.length;++c){const u=e[c];r=Fh(r,u.maxDistance),s=J8(s,u.minElevation),o=Fh(o,u.maxElevation),a=Fh(a,u.maxPositiveSlope),l=Fh(l,u.maxNegativeSlope)}return{maxDistance:r,minElevation:s,maxElevation:o,avgElevation:null,elevationGain:null,elevationLoss:null,maxPositiveSlope:a,maxNegativeSlope:l,avgPositiveSlope:null,avgNegativeSlope:null}}function oJe(t){let e=null,i=null,n=null;for(const r of t){if(r==null)continue;const{statistics:s,spatialReference:o}=r;if(s==null)continue;const a=pi(o);e=Fh(e,xL(s.maxDistance,a));const l=sd(o);n=J8(n,xL(s.minElevation,l)),i=Fh(i,xL(s.maxElevation,l))}return{minDistance:0,maxDistance:e??0,minElevation:n??0,maxElevation:i??0}}function J8(t,e){return e==null?t:t!=null?Math.min(t,e):e}function Fh(t,e){return e==null?t:t!=null?Math.max(t,e):e}function xL(t,e){return t!=null&&e!=null?t*e:null}let yZ=class{constructor(){this._start=0,this._totalElevation=0,this._sampleCount=0}get avgElevation(){return this._totalElevation/this._sampleCount}get isHole(){return this._sampleCount===0}get start(){return this._start}copy(e){this._start=e._start,this._sampleCount=e._sampleCount,this._totalElevation=e._totalElevation}reset(){this._start=0,this._sampleCount=0,this._totalElevation=0}restart(e,i){this._start=e,this._sampleCount=1,this._totalElevation=i}insert(e){++this._sampleCount,this._totalElevation+=e}};function aJe(t,e,i=[]){if(t>=e||(i.push(t),e-t<2))return i;const n=e-1;i.push(n);const r=qF(t+1,n);for(;;){const s=r.next();if(s.done)break;i.push(s.value)}return i}function*qF(t,e){if(t>=e)return;const i=t+Math.floor((e-t)/2);yield i;const n=qF(t,i),r=qF(i+1,e);for(;;){const s=n.next(),o=r.next();if(s.done&&o.done)break;s.done||(yield s.value),o.done||(yield o.value)}}async function*lJe(t,e){const{view:i,geometry:n,elevationInfo:r,providers:s,options:o}=t,a=i.spatialReference;if(!a||n==null||!W8(n))throw new G_(al.InvalidGeometry);const l=s.length;if(l===0)return null;const c=Math.round(o.maxTotalSamples/l);if(rpe(n)>c)throw new G_(al.TooComplex);const u=await qWe(n,r,i,a,o,c,e);let d=0;const f=new Array(l),m=new Array(l);for(let _=0;_<l;_++){const b=fJe(u);f[_]=b,d+=b.samples.length;const w={...t,provider:s[_],result:b,densificationResult:u};m[_]=cJe(w,e)[Symbol.iterator]()}if(d>o.maxTotalSamples)throw new G_(al.TooComplex);const g=await Promise.all(m.map(_=>{const b=_.next();return b.done===!0?Promise.resolve(null):b.value}));Vt(e);for(let _=0;_<l;_++)f[_]=g[_];yield f,await J$(t.delayAfterPreview??Os().delayAfterPreviewMillis,null,e.signal);const y=[];try{let _;do{_=!1;for(let b=0;b<l;b++){const w=m[b].next();w.done===!1&&(y.push({resultPromise:w.value,index:b}),_=!0)}}while(_)}finally{m.forEach(_=>{var b;return(b=_.return)==null?void 0:b.call(_)})}for(const{resultPromise:_,index:b}of y)f[b]=await _,Vt(e),yield f;Jge(f,_=>{_.progress=1}),yield f}function*cJe(t,e){const{densificationResult:i}=t,n={...t,abortOptions:e,densificationResult:i},r=aJe(0,n.result.samples.length),s=r.slice(0,n.provider.numSamplesForPreview);yield vZ(n,s,!0);const o=Ege(r,n.provider.numSamplesPerChunk);for(const a of o)yield vZ(n,a,!1)}async function vZ({densificationResult:t,result:e,provider:i,queue:n,abortOptions:r,cache:s},o,a){const{densifiedPath:l,pathLength:c}=t,u=e.spatialReference,{samples:d}=e,f=[];for(let m=0;m<o.length;m++){const g=d[o[m]];f[m]=g.coordinate}try{return await n.push({geometry:new Cf({spatialReference:u,points:f,hasZ:l.hasZ}),provider:i,indices:o,preview:a,result:e,queryOptions:{...Os().defaultQueryOptions(),minDemResolution:Math.round(a?c/i.numSamplesForPreview:c/d.length),cache:s}},r),{...e}}catch(m){return Ds(m)?null:VWe}}function uJe(t){return new DV({priority:lt.ELEVATION_PROFILE,concurrency:1,scheduler:t,process:async e=>{Vt(e.queryOptions);try{await hJe(e)}catch(i){QL(i)}}})}async function hJe({geometry:t,provider:e,indices:i,preview:n,result:r,queryOptions:s}){if(i.length===0)return;const o=(await yJe(e,t,s)).geometry,{hasZ:a,points:l}=o,c=s.noDataValue,{samples:u}=r;for(let d=0;d<i.length;d++){const f=u[i[d]];if(f.isHole)continue;const m=a?l[d][2]:null;m===null||m===c?f.sampledZ=null:(r.hasZ=!0,f.sampledZ=m),f.sampled=!0}dJe(u),r.progress=n?0:r.progress+i.length/u.length,r.statistics=rJe(r.samples,r.spatialReference)}function dJe(t){const e=t.length-1;let i=0;for(let n=1;n<=e;n++)(t[n].sampled||n===e)&&(pJe(t,i,n),i=n)}function pJe(t,e,i){if(i-e==1)return;const n=t[e],r=n.sampledZ,s=t[i],o=s.sampledZ;if(r==null||o==null){for(let c=e+1;c<i;c++)t[c].sampledZ=null;return}const a=n.distance,l=s.distance-a;for(let c=e+1;c<i;c++){const u=t[c],d=(u.distance-a)/l;u.sampledZ=T6(r,o,d)}}function fJe({densifiedPath:t,distances:e}){const i=t.spatialReference,n=to(i),r=t.paths,s=r.length,o=[];let a=null,l=0;for(let c=0;c<s;c++){const u=r[c],d=u.length,f=e[c];for(let m=0;m<d;m++){const g=u[m],y=f[m];n&&(g[0]=Pee(g[0],n.valid[0],n.valid[1])),a&&m===0&&mJe(o,a,g,l,y),o.push(gJe(g,y)),a=g,l=y}}return{progress:0,samples:o,hasZ:!1,statistics:null,spatialReference:i}}function mJe(t,e,i,n,r){t.push(_Z(e,n)),t.push(_Z(i,r))}function gJe(t,e){return{coordinate:t,distance:e,sampledZ:null,sampled:!1,isHole:!1}}function _Z(t,e){return{coordinate:t,distance:e,sampledZ:null,sampled:!0,isHole:!0}}async function yJe(t,e,i){try{return await t.queryElevation(e,i)}catch{throw new G_(al.ElevationQueryError)}}const bZ="line-change";let Op=class extends ye{constructor(e){super(e),this._handles=new Rs,this._updateTask=null,this._paramsPerProfile=new Map,this._getUpdateParametersMemoized=ol((i,n,r)=>({stationary:i,visibleProfiles:n,generationParameters:r})),this._getGenerationParametersMemoized=ol((i,n,r,s,o,a,l)=>wT(n)&&W8(n)&&s!=null?{view:i,geometry:n,elevationInfo:r,options:a,queue:s,cache:o,slicePlane:l}:null),this._getElevationInfoMemoized=ol((i,n)=>({mode:i,offset:n})),this._getOptionsMemoized=ol((i,n,r)=>{const{densificationMaxSamples:s,maxTotalSamples:o}=Os();return{geodesicDistanceThreshold:i,samplingDistance:n,densificationMaxSamples:Math.round(s/r),maxTotalSamples:o}}),this._updateThrottled=Nde(i=>$y(this._update(i)),Os().updateThrottleMillis)}initialize(){const e=this.viewModel;this._handles.add([Q(()=>e.profiles.toArray(),i=>{this._abortUpdate(),this._paramsPerProfile.clear(),this._handles.remove(bZ),this._handles.add(i.map(n=>$c([n.attach(this.viewModel),n.on("change",()=>{this._invalidateProfile(n)})])),bZ)},Oi),this._updateThrottled,Q(()=>this._updateParameters,this._updateThrottled,Oi)])}destroy(){this._handles.destroy(),this._paramsPerProfile.clear()}get _updateParameters(){const{viewModel:e}=this,i=e.view;return this._getUpdateParametersMemoized(i==null||i.stationary,this.viewModel.visibleProfiles,this._generationParameters)}get _generationParameters(){const{view:e,input:i,queue:n,tileCache:r}=this.viewModel;return e!=null&&e.ready?this._getGenerationParametersMemoized(e,ot(i,s=>s.geometry),this._elevationInfo,n,r,this._options,e.type==="3d"?e.slicePlane:null):null}get _elevationInfo(){const e=ot(this.viewModel.input,i=>wk(i)?null:Vde(i));return e!=null?this._getElevationInfoMemoized(e.mode,e.offset):null}get _options(){const e=this.viewModel,i=e.visibleProfiles.length;let n=e.minDemResolution??Os().defaultDemResolution;return n=parseFloat(n.toFixed(2)),this._getOptionsMemoized(e.geodesicDistanceThreshold,n,i)}async _update({stationary:e,visibleProfiles:i,generationParameters:n}){this._abortUpdate(),e&&(n!=null?this._updateTask=i0(async r=>{this.viewModel.error=null;const s=i.filter(a=>!this._isProfileValid(a,n)),o=lJe({...n,providers:s},{signal:r});try{for await(const a of o){Vt(r),this._clearInvalidResults(n);for(let l=0;l<s.length;l++)s[l].result=a[l]}for(const a of s)this._paramsPerProfile.set(a,n)}catch(a){$o(a),this._abortUpdate(),this.viewModel.error=a,s.forEach(l=>{l.result=null})}}):this._clearResults())}_abortUpdate(){this._updateTask=is(this._updateTask)}_isProfileValid(e,i){return this._paramsPerProfile.has(e)&&this._paramsPerProfile.get(e)===i}_invalidateProfile(e){this._paramsPerProfile.delete(e),this._updateThrottled(this._updateParameters)}_clearInvalidResults(e){for(const i of this.viewModel.profiles.items)this._isProfileValid(i,e)||(i.result=null,this._paramsPerProfile.delete(i))}_clearResults(){for(const e of this.viewModel.profiles.items)e.result=null,this._paramsPerProfile.delete(e)}};h([p({nonNullable:!0})],Op.prototype,"viewModel",void 0),h([p()],Op.prototype,"_updateParameters",null),h([p()],Op.prototype,"_generationParameters",null),h([p()],Op.prototype,"_elevationInfo",null),h([p()],Op.prototype,"_options",null),Op=h([P("esri.widgets.ElevationProfile.ElevationProfileController")],Op);function vJe(t,e){if(t==null||e==null)return null;const{samples:i,spatialReference:n}=t,{distance:r,elevation:s}=e,o=pi(n),a=sd(n),l=i.length,c=new Array(l);for(let u=0;u<l;++u){const d=i[u],f=d.sampledZ,m=d.coordinate;c[u]={x:m[0],y:m[1],z:f,distance:spe(d.distance,o,r),elevation:t_(f,a,s)}}return c}function _Je(t,e){if(t==null||e==null||t.statistics==null||t.spatialReference==null)return null;const{distance:i,elevation:n}=e,{statistics:r,spatialReference:s}=t,o=pi(s),a=sd(s);return{maxDistance:spe(r.maxDistance,o,i),minElevation:t_(r.minElevation,a,n),maxElevation:t_(r.maxElevation,a,n),avgElevation:t_(r.avgElevation,a,n),elevationGain:t_(r.elevationGain,a,n),elevationLoss:t_(r.elevationLoss,a,n),maxPositiveSlope:r.maxPositiveSlope,maxNegativeSlope:r.maxNegativeSlope,avgPositiveSlope:r.avgPositiveSlope,avgNegativeSlope:r.avgNegativeSlope}}function spe(t,e,i){return t==null?null:ht(t*e,"meters",i)}function t_(t,e,i){return t==null?null:ht(t*e,"meters",i)}let un=class extends Uo.EventedAccessor{constructor(e){super(e),this.type=null,this.id=BV(),this.title=null,this.color=new ae("#000000"),this.visible=!0,this._getSamplesMemoized=ol((i,n)=>vJe(i,n)),this._getStatisticsMemoized=ol((i,n)=>_Je(i,n)),this.viewVisualizationEnabled=!0,this.result=null,this.effectiveUnits=null,this.numSamplesForPreview=30,this.numSamplesPerChunk=200,this.chartFillEnabled=!0,this.chartStrokeWidth=1.5,this.chartStrokeOffsetY=0,this._viewModel=null}get progress(){return this.result!=null&&this.visible?this.result.progress:0}get samples(){return this._getSamplesMemoized(this.result,this.effectiveUnits)}get statistics(){return this._getStatisticsMemoized(this.result,this.effectiveUnits)}get hoveredPoint(){var e;return ot((e=this._viewModel)==null?void 0:e.hoveredChartPosition,i=>this._getPoint(i))}get available(){return!0}get hasZ(){const e=this.result;return e!=null&&e.hasZ}get minDemResolution(){return Os().defaultDemResolution}queryElevation(){throw new Error("not implemented")}attach(e){return this._viewModel=e,$c([Q(()=>e.effectiveUnits,i=>{this.effectiveUnits=i},Oi),Q(()=>[e.input],()=>this._onChange(),ml)])}toggleVisibility(e){this.visible=e===void 0?!this.visible:e}_onChange(){this.emit("change")}_getPoint(e){const{samples:i,result:n}=this;if(i==null||n==null)return null;const r=i.length;if(r===0)return null;const s=i[r-1].distance,o=WX(i,e*s,u=>u.distance);if(o==null)return null;const{x:a,y:l,z:c}=o;return c==null?null:new pe({x:a,y:l,z:c,spatialReference:n.spatialReference})}};h([p({nonNullable:!0})],un.prototype,"id",void 0),h([p({nonNullable:!0})],un.prototype,"title",void 0),h([p({type:ae,nonNullable:!0})],un.prototype,"color",void 0),h([p({nonNullable:!0})],un.prototype,"visible",void 0),h([p({readOnly:!0})],un.prototype,"progress",null),h([p({readOnly:!0})],un.prototype,"samples",null),h([p({readOnly:!0})],un.prototype,"statistics",null),h([p()],un.prototype,"hoveredPoint",null),h([p()],un.prototype,"viewVisualizationEnabled",void 0),h([p()],un.prototype,"available",null),h([p()],un.prototype,"result",void 0),h([p()],un.prototype,"effectiveUnits",void 0),h([p()],un.prototype,"numSamplesForPreview",void 0),h([p()],un.prototype,"numSamplesPerChunk",void 0),h([p()],un.prototype,"chartFillEnabled",void 0),h([p()],un.prototype,"chartStrokeWidth",void 0),h([p()],un.prototype,"chartStrokeOffsetY",void 0),h([p({readOnly:!0})],un.prototype,"hasZ",null),h([p({readOnly:!0})],un.prototype,"minDemResolution",null),h([p()],un.prototype,"_viewModel",void 0),un=h([P("esri.widgets.ElevationProfile.ElevationProfileLine")],un);const xT=un;function ope(t){if(t==null)return null;if(t instanceof O2)return ape(t);const e=t.tileInfo;if(e==null)return null;const i=Tge(e.lods);return i==null?null:i.resolution*pi(e.spatialReference)}function ape(t){if(t==null)return null;const e=t.layers.items.map(bJe).filter(Ti);return qX(e)??null}function bJe(t){return t&&"tileInfo"in t?ope(t):null}let ou=class extends xT{constructor(e){super(e),this.type="ground",this.color=new ae("#ff7f00"),this.viewVisualizationEnabled=!0,this.numSamplesForPreview=50,this.numSamplesPerChunk=1e3,this._getQueryElevationDependencies=ol((i,n)=>({ground:i,groundLayers:n}))}get available(){const e=this._ground;return e!=null&&e.layers.some(i=>i.visible)}get minDemResolution(){return ape(this._ground)}get _queryElevationDependencies(){return this._getQueryElevationDependencies(this._ground,this._groundLayers)}get _ground(){var e;return ot((e=this._viewModel)==null?void 0:e.view,i=>{var n;return(n=i.map)==null?void 0:n.ground})}get _groundLayers(){const e=this._ground;return ot(e,i=>{var n;return(n=i.layers)==null?void 0:n.toArray()})??[]}async queryElevation(e,i){const n=this._queryElevationDependencies;if(n==null)throw new Error("ElevationProfileLineGround: no dependencies");const{ground:r}=n;if(r==null)throw new Error("No ground configured in the view");const s=await r.queryElevation(e,i),o=sd(e.spatialReference),a=sd(r.layers.at(0).spatialReference);if(o!==a){const l=s.geometry;l.points=l.points.map(([c,u,d])=>[c,u,d===i.noDataValue?d:d*a/o])}return s}attach(e){return $c([super.attach(e),Q(()=>this._queryElevationDependencies,()=>this._onChange())])}};h([p({type:ae,nonNullable:!0})],ou.prototype,"color",void 0),h([p()],ou.prototype,"viewVisualizationEnabled",void 0),h([p()],ou.prototype,"available",null),h([p({readOnly:!0})],ou.prototype,"minDemResolution",null),h([p()],ou.prototype,"_queryElevationDependencies",null),h([p()],ou.prototype,"_ground",null),h([p()],ou.prototype,"_groundLayers",null),ou=h([P("esri.widgets.ElevationProfile.ElevationProfileLineGround")],ou);const lpe=ou,Z8=ne.getLogger("esri.layers.support.ElevationSampler");let cpe=class{queryElevation(e){return xJe(e.clone(),this)}on(){return CJe}projectIfRequired(e,i){return upe(e,i)}},wJe=class extends cpe{get spatialReference(){return this.extent.spatialReference}constructor(e,i,n){super(),this.tile=e,this.noDataValue=n;const r=e.tile.extent;this.extent=Lee(r,i.spatialReference),this.extent.zmin=e.zmin,this.extent.zmax=e.zmax,this._aaExtent=r;const s=pi(i.spatialReference),o=i.lodAt(e.tile.level).resolution*s;this.demResolution={min:o,max:o}}contains(e){const i=this.projectIfRequired(e,this.spatialReference);return i!=null&&this.containsAt(i.x,i.y)}containsAt(e,i){return A6(this._aaExtent,e,i)}elevationAt(e,i){if(!this.containsAt(e,i)){const n=this.extent,r=`${n.xmin}, ${n.ymin}, ${n.xmax}, ${n.ymax}`;return Z8.warn("#elevationAt()",`Point used to sample elevation (${e}, ${i}) is outside of the sampler extent (${r})`),this.noDataValue}return this.tile.sample(e,i)??this.noDataValue}},wZ=class extends cpe{get spatialReference(){return this.extent.spatialReference}constructor(e,i,n){let r;super(),typeof i=="number"?(this.noDataValue=i,r=null):(r=i,this.noDataValue=n),this.samplers=r?e.map(o=>new wJe(o,r,this.noDataValue)):e;const s=this.samplers[0];if(s){this.extent=s.extent.clone();const{min:o,max:a}=s.demResolution;this.demResolution={min:o,max:a};for(let l=1;l<this.samplers.length;l++){const c=this.samplers[l];this.extent.union(c.extent),this.demResolution.min=Math.min(this.demResolution.min,c.demResolution.min),this.demResolution.max=Math.max(this.demResolution.max,c.demResolution.max)}}else this.extent=Lee(wa(),r.spatialReference),this.demResolution={min:0,max:0}}elevationAt(e,i){for(const n of this.samplers)if(n.containsAt(e,i))return n.elevationAt(e,i);return Z8.warn("#elevationAt()",`Point used to sample elevation (${e}, ${i}) is outside of the sampler`),this.noDataValue}};function xJe(t,e){const i=upe(t,e.spatialReference);if(!i)return null;switch(t.type){case"point":SJe(t,i,e);break;case"polyline":TJe(t,i,e);break;case"multipoint":IJe(t,i,e)}return t}function upe(t,e){if(t==null)return null;const i=t.spatialReference;if(i.equals(e))return t;const n=NS(t,e);return n||Z8.error(`Cannot project geometry spatial reference (wkid:${i.wkid}) to elevation sampler spatial reference (wkid:${e.wkid})`),n}function SJe(t,e,i){t.z=i.elevationAt(e.x,e.y)}function TJe(t,e,i){bu.spatialReference=e.spatialReference;const n=t.hasM&&!t.hasZ;for(let r=0;r<t.paths.length;r++){const s=t.paths[r],o=e.paths[r];for(let a=0;a<s.length;a++){const l=s[a],c=o[a];bu.x=c[0],bu.y=c[1],n&&(l[3]=l[2]),l[2]=i.elevationAt(bu.x,bu.y)}}t.hasZ=!0}function IJe(t,e,i){bu.spatialReference=e.spatialReference;const n=t.hasM&&!t.hasZ;for(let r=0;r<t.points.length;r++){const s=t.points[r],o=e.points[r];bu.x=o[0],bu.y=o[1],n&&(s[3]=s[2]),s[2]=i.elevationAt(bu.x,bu.y)}t.hasZ=!0}const bu=new pe,CJe={remove(){}};let MJe=class{constructor(e,i){this.data=e,this.safeWidth=.99999999*(e.width-1),this.dx=(e.width-1)/(i[2]-i[0]),this.dy=(e.width-1)/(i[3]-i[1]),this.x0=i[0],this.y1=i[3]}},xZ=class{constructor(e,i=null){if(this.tile=e,i!=null&&e!=null){const n=e.extent;this._samplerData=new MJe(i,n)}}get zmin(){return this._samplerData!=null?this._samplerData.data.minValue:0}get zmax(){return this._samplerData!=null?this._samplerData.data.maxValue:0}sample(e,i){if(this._samplerData==null)return;const{safeWidth:n,data:r,dx:s,dy:o,y1:a,x0:l}=this._samplerData,{width:c,values:u,noDataValue:d}=r,f=SZ(o*(a-i),0,n),m=SZ(s*(e-l),0,n),g=Math.floor(f),y=Math.floor(m),_=g*c+y,b=_+c,w=u[_],x=u[b],S=u[_+1],T=u[b+1];if(w!==d&&x!==d&&S!==d&&T!==d){const I=m-y,C=w+(S-w)*I;return C+(x+(T-x)*I-C)*(f-g)}}};function SZ(t,e,i){return t<e?e:t>i?i:t}let EJe=class{async queryAll(e,i,n){if(!(e=n&&n.ignoreInvisibleLayers?e.filter(c=>c.visible):e.slice()).length)throw new V("elevation-query:invalid-layer","Elevation queries require at least one elevation layer to fetch tiles from");const r=hy.fromGeometry(i);let s=!1;n&&n.returnSampleInfo||(s=!0);const o={...dC,...n,returnSampleInfo:!0},a=await this.query(e[e.length-1],r,o),l=await this._queryAllContinue(e,a,o);return l.geometry=l.geometry.export(),s&&delete l.sampleInfo,l}async query(e,i,n){if(!e)throw new V("elevation-query:invalid-layer","Elevation queries require an elevation layer to fetch tiles from");if(!i||!(i instanceof hy)&&i.type!=="point"&&i.type!=="multipoint"&&i.type!=="polyline")throw new V("elevation-query:invalid-geometry","Only point, polyline and multipoint geometries can be used to query elevation");const r={...dC,...n},s=new AJe(e,i.spatialReference,r),o=r.signal;return await e.load({signal:o}),await this._createGeometryDescriptor(s,i,o),await this._selectTiles(s,o),await this._populateElevationTiles(s,o),this._sampleGeometryWithElevation(s),this._createQueryResult(s,o)}async createSampler(e,i,n){if(!e)throw new V("elevation-query:invalid-layer","Elevation queries require an elevation layer to fetch tiles from");if(!i||i.type!=="extent")throw new V("elevation-query:invalid-extent","Invalid or undefined extent");const r={...dC,...n};return this._createSampler(e,i,r)}async createSamplerAll(e,i,n){if(!(e=n&&n.ignoreInvisibleLayers?e.filter(o=>o.visible):e.slice()).length)throw new V("elevation-query:invalid-layer","Elevation queries require at least one elevation layer to fetch tiles from");if(!i||i.type!=="extent")throw new V("elevation-query:invalid-extent","Invalid or undefined extent");const r={...dC,...n,returnSampleInfo:!0},s=await this._createSampler(e[e.length-1],i,r);return this._createSamplerAllContinue(e,i,s,r)}async _createSampler(e,i,n,r){const s=n.signal;await e.load({signal:s});const o=i.spatialReference,a=e.tileInfo.spatialReference;o.equals(a)||(await Ff([{source:o,dest:a}],{signal:s}),i=an(i,a));const l=new $Je(e,i,n,r);return await this._selectTiles(l,s),await this._populateElevationTiles(l,s),new wZ(l.elevationTiles,l.layer.tileInfo,l.options.noDataValue)}async _createSamplerAllContinue(e,i,n,r){if(e.pop(),!e.length)return n;const s=n.samplers.map(c=>rwe(c.extent)),o=await this._createSampler(e[e.length-1],i,r,s);if(o.samplers.length===0)return n;const a=n.samplers.concat(o.samplers),l=new wZ(a,r.noDataValue);return this._createSamplerAllContinue(e,i,l,r)}async _queryAllContinue(e,i,n){const r=e.pop(),s=i.geometry.coordinates,o=i.sampleInfo;ks(o);const a=[],l=[];for(let f=0;f<s.length;f++){const m=o[f];m.demResolution>=0?m.source||(m.source=r):e.length&&(a.push(s[f]),l.push(f))}if(!e.length||a.length===0)return i;const c=i.geometry.clone(a),u=await this.query(e[e.length-1],c,n),d=u.sampleInfo;if(!d)throw new Error("no sampleInfo");return l.forEach((f,m)=>{s[f].z=u.geometry.coordinates[m].z,o[f].demResolution=d[m].demResolution}),this._queryAllContinue(e,i,n)}async _createQueryResult(e,i){const n=await e.geometry.project(e.outSpatialReference,i);ks(n);const r={geometry:n.export(),noDataValue:e.options.noDataValue};return e.options.returnSampleInfo&&(r.sampleInfo=this._extractSampleInfo(e)),e.geometry.coordinates.forEach(s=>{s.tile=null,s.elevationTile=null}),r}async _createGeometryDescriptor(e,i,n){let r;const s=e.layer.tileInfo.spatialReference;if(i instanceof hy?r=await i.project(s,n):(await Ff([{source:i.spatialReference,dest:s}],{signal:n}),r=an(i,s)),!r)throw new V("elevation-query:spatial-reference-mismatch",`Cannot query elevation in '${i.spatialReference.wkid}' on an elevation service in '${s.wkid}'`);e.geometry=hy.fromGeometry(r)}async _selectTiles(e,i){e.type==="geometry"&&this._preselectOutsideLayerExtent(e);const n=e.options.demResolution;if(typeof n=="number")this._selectTilesClosestResolution(e,n);else if(n==="finest-contiguous")await this._selectTilesFinestContiguous(e,i);else{if(n!=="auto")throw new V("elevation-query:invalid-dem-resolution",`Invalid dem resolution value '${n}', expected a number, "finest-contiguous" or "auto"`);await this._selectTilesAuto(e,i)}}_preselectOutsideLayerExtent(e){if(e.layer.fullExtent==null)return;const i=new xZ(null);i.sample=()=>e.options.noDataValue,e.outsideExtentTile=i;const n=e.layer.fullExtent;e.geometry.coordinates.forEach(r=>{const s=r.x,o=r.y;(s<n.xmin||s>n.xmax||o<n.ymin||o>n.ymax)&&(r.elevationTile=i)})}_selectTilesClosestResolution(e,i){const n=this._findNearestDemResolutionLODIndex(e,i);e.selectTilesAtLOD(n)}_findNearestDemResolutionLODIndex(e,i){const{tileInfo:n,tilemapCache:r}=e.layer,s=i/pi(n.spatialReference),o=yS(n,r);let a=o[0],l=0;for(let c=1;c<o.length;c++){const u=o[c];Math.abs(u.resolution-s)<Math.abs(a.resolution-s)&&(a=u,l=c)}return l}async _selectTilesFinestContiguous(e,i){const{tileInfo:n,tilemapCache:r}=e.layer,s=WF(n,r,e.options.minDemResolution);await this._selectTilesFinestContiguousAt(e,s,i)}async _selectTilesFinestContiguousAt(e,i,n){const r=e.layer;if(e.selectTilesAtLOD(i),i<0)return;const s=r.tilemapCache,o=e.getTilesToFetch();try{if(s&&!JF(s))await S_(Promise.all(o.map(a=>s.fetchAvailability(a.level,a.row,a.col,{signal:n}))),n);else if(await this._populateElevationTiles(e,n),!e.allElevationTilesFetched())throw e.clearElevationTiles(),new V("elevation-query:has-unavailable-tiles")}catch(a){$o(a),await this._selectTilesFinestContiguousAt(e,i-1,n)}}async _populateElevationTiles(e,i){const n=e.getTilesToFetch(),r={},s=e.options.cache,o=e.options.noDataValue,a=n.map(async l=>{if(l.id==null)return;const c=`${e.layer.uid}:${l.id}:${o}`,u=s!=null?s.get(c):null,d=u??await e.layer.fetchTile(l.level,l.row,l.col,{noDataValue:o,signal:i});s!=null&&s.put(c,d),r[l.id]=new xZ(l,d)});await S_(Sn(a),i),e.populateElevationTiles(r)}async _selectTilesAuto(e,i){this._selectTilesAutoFinest(e),this._reduceTilesForMaximumRequests(e);const n=e.layer.tilemapCache;if(!n||JF(n))return this._selectTilesAutoPrefetchUpsample(e,i);const r=e.getTilesToFetch(),s={},o=r.map(async a=>{const l=new SP(null,0,0,0,wa()),c=await Q$(n.fetchAvailabilityUpsample(a.level,a.row,a.col,l,{signal:i}));c.ok!==!1?a.id!=null&&(s[a.id]=l):$o(c.error)});await S_(Promise.all(o),i),e.remapTiles(s)}_reduceTilesForMaximumRequests(e){const i=e.layer.tileInfo;let n=0;const r={},s=l=>{l.id!=null&&(l.id in r?r[l.id]++:(r[l.id]=1,n++))},o=l=>{if(l.id==null)return;const c=r[l.id];c===1?(delete r[l.id],n--):r[l.id]=c-1};e.forEachTileToFetch(s,o);let a=!0;for(;a&&(a=!1,e.forEachTileToFetch(l=>{n<=e.options.maximumAutoTileRequests||(o(l),i.upsampleTile(l)&&(a=!0),s(l))},o),a););}_selectTilesAutoFinest(e){const{tileInfo:i,tilemapCache:n}=e.layer,r=WF(i,n,e.options.minDemResolution);e.selectTilesAtLOD(r,e.options.maximumAutoTileRequests)}async _selectTilesAutoPrefetchUpsample(e,i){const n=e.layer.tileInfo;await this._populateElevationTiles(e,i);let r=!1;e.forEachTileToFetch((s,o)=>{n.upsampleTile(s)?r=!0:o()}),r&&await this._selectTilesAutoPrefetchUpsample(e,i)}_sampleGeometryWithElevation(e){e.geometry.coordinates.forEach(i=>{const n=i.elevationTile;let r=e.options.noDataValue;if(n){const s=n.sample(i.x,i.y);s!=null?r=s:i.elevationTile=null}i.z=r})}_extractSampleInfo(e){const i=e.layer.tileInfo,n=pi(i.spatialReference);return e.geometry.coordinates.map(r=>{let s=-1;return r.elevationTile&&r.elevationTile!==e.outsideExtentTile&&(s=i.lodAt(r.elevationTile.tile.level).resolution*n),{demResolution:s}})}},hy=class fE{export(){return this._exporter(this.coordinates,this.spatialReference)}clone(e){const i=new fE;return i.geometry=this.geometry,i.spatialReference=this.spatialReference,i.coordinates=e||this.coordinates.map(n=>n.clone()),i._exporter=this._exporter,i}async project(e,i){if(this.spatialReference.equals(e))return this.clone();await Ff([{source:this.spatialReference,dest:e}],{signal:i});const n=new Cf({spatialReference:this.spatialReference,points:this.coordinates.map(a=>[a.x,a.y])}),r=an(n,e);if(!r)return null;const s=this.coordinates.map((a,l)=>{const c=a.clone(),u=r.points[l];return c.x=u[0],c.y=u[1],c}),o=this.clone(s);return o.spatialReference=e,o}static fromGeometry(e){const i=new fE;if(i.geometry=e,i.spatialReference=e.spatialReference,e instanceof fE)i.coordinates=e.coordinates.map(n=>n.clone()),i._exporter=(n,r)=>{const s=e.clone(n);return s.spatialReference=r,s};else switch(e.type){case"point":{const n=e,{hasZ:r,hasM:s}=n;i.coordinates=r&&s?[new Pa(n.x,n.y,n.z,n.m)]:r?[new Pa(n.x,n.y,n.z)]:s?[new Pa(n.x,n.y,null,n.m)]:[new Pa(n.x,n.y)],i._exporter=(o,a)=>e.hasM?new pe(o[0].x,o[0].y,o[0].z,o[0].m,a):new pe(o[0].x,o[0].y,o[0].z,a);break}case"multipoint":{const n=e,{hasZ:r,hasM:s}=n;i.coordinates=r&&s?n.points.map(o=>new Pa(o[0],o[1],o[2],o[3])):r?n.points.map(o=>new Pa(o[0],o[1],o[2])):s?n.points.map(o=>new Pa(o[0],o[1],null,o[2])):n.points.map(o=>new Pa(o[0],o[1])),i._exporter=(o,a)=>e.hasM?new Cf({points:o.map(l=>[l.x,l.y,l.z,l.m]),hasZ:!0,hasM:!0,spatiaReference:a}):new Cf(o.map(l=>[l.x,l.y,l.z]),a);break}case"polyline":{const n=e,r=[],s=[],{hasZ:o,hasM:a}=e;let l=0;for(const c of n.paths)if(s.push([l,l+c.length]),l+=c.length,o&&a)for(const u of c)r.push(new Pa(u[0],u[1],u[2],u[3]));else if(o)for(const u of c)r.push(new Pa(u[0],u[1],u[2]));else if(a)for(const u of c)r.push(new Pa(u[0],u[1],null,u[2]));else for(const u of c)r.push(new Pa(u[0],u[1]));i.coordinates=r,i._exporter=(c,u)=>{const d=e.hasM?c.map(m=>[m.x,m.y,m.z,m.m]):c.map(m=>[m.x,m.y,m.z]),f=s.map(m=>d.slice(m[0],m[1]));return new Ms({paths:f,hasM:e.hasM,hasZ:!0,spatialReference:u})};break}}return i}},Pa=class hpe{constructor(e,i,n=null,r=null,s=null,o=null){this.x=e,this.y=i,this.z=n,this.m=r,this.tile=s,this.elevationTile=o}clone(){return new hpe(this.x,this.y,this.z,this.m)}},dpe=class{constructor(e,i){this.layer=e,this.options=i}},AJe=class extends dpe{constructor(e,i,n){super(e,n),this.outSpatialReference=i,this.type="geometry"}selectTilesAtLOD(e){if(e<0)this.geometry.coordinates.forEach(i=>i.tile=null);else{const{tileInfo:i,tilemapCache:n}=this.layer,r=yS(i,n)[e].level;this.geometry.coordinates.forEach(s=>s.tile=i.tileAt(r,s.x,s.y))}}allElevationTilesFetched(){return!this.geometry.coordinates.some(e=>!e.elevationTile)}clearElevationTiles(){for(const e of this.geometry.coordinates)e.elevationTile!==this.outsideExtentTile&&(e.elevationTile=null)}populateElevationTiles(e){var i;for(const n of this.geometry.coordinates)!n.elevationTile&&((i=n.tile)!=null&&i.id)&&(n.elevationTile=e[n.tile.id])}remapTiles(e){var i;for(const n of this.geometry.coordinates){const r=(i=n.tile)==null?void 0:i.id;n.tile=r?e[r]:null}}getTilesToFetch(){var n;const e={},i=[];for(const r of this.geometry.coordinates){const s=r.tile;if(!s)continue;const o=(n=r.tile)==null?void 0:n.id;r.elevationTile||!o||e[o]||(e[o]=s,i.push(s))}return i}forEachTileToFetch(e){for(const i of this.geometry.coordinates)i.tile&&!i.elevationTile&&e(i.tile,()=>{i.tile=null})}},$Je=class extends dpe{constructor(e,i,n,r){super(e,n),this.type="extent",this.elevationTiles=[],this._candidateTiles=[],this._fetchedCandidates=new Set,this.extent=i.intersection(e.fullExtent),this.maskExtents=r}selectTilesAtLOD(e,i){const n=this._maximumLodForRequests(i),r=Math.min(n,e);r<0?this._candidateTiles.length=0:this._selectCandidateTilesCoveringExtentAt(r)}_maximumLodForRequests(e){const{tileInfo:i,tilemapCache:n}=this.layer,r=yS(i,n);if(!e)return r.length-1;const s=this.extent;if(s==null)return-1;for(let o=r.length-1;o>=0;o--){const a=r[o],l=a.resolution*i.size[0],c=a.resolution*i.size[1];if(Math.ceil(s.width/l)*Math.ceil(s.height/c)<=e)return o}return-1}allElevationTilesFetched(){return this._candidateTiles.length===this.elevationTiles.length}clearElevationTiles(){this.elevationTiles.length=0,this._fetchedCandidates.clear()}populateElevationTiles(e){for(const i of this._candidateTiles){const n=i.id&&e[i.id];n&&(this._fetchedCandidates.add(i),this.elevationTiles.push(n))}}remapTiles(e){this._candidateTiles=this._uniqueNonOverlappingTiles(this._candidateTiles.map(i=>e[i.id]))}getTilesToFetch(){return this._candidateTiles}forEachTileToFetch(e,i){const n=this._candidateTiles;this._candidateTiles=[],n.forEach(r=>{if(this._fetchedCandidates.has(r))return void(i&&i(r));let s=!1;e(r,()=>s=!0),s?i&&i(r):this._candidateTiles.push(r)}),this._candidateTiles=this._uniqueNonOverlappingTiles(this._candidateTiles,i)}_uniqueNonOverlappingTiles(e,i){const n={},r=[];for(const o of e){const a=o.id;a&&!n[a]?(n[a]=o,r.push(o)):i&&i(o)}const s=r.sort((o,a)=>o.level-a.level);return s.filter((o,a)=>{for(let l=0;l<a;l++){const c=s[l].extent;if(c&&o.extent&&AR(c,o.extent))return i&&i(o),!1}return!0})}_selectCandidateTilesCoveringExtentAt(e){this._candidateTiles.length=0;const i=this.extent;if(i==null)return;const{tileInfo:n,tilemapCache:r}=this.layer,s=yS(n,r)[e],o=n.tileAt(s.level,i.xmin,i.ymin),a=o.extent;if(a==null)return;const l=s.resolution*n.size[0],c=s.resolution*n.size[1],u=Math.ceil((i.xmax-a[0])/l),d=Math.ceil((i.ymax-a[1])/c);for(let f=0;f<d;f++)for(let m=0;m<u;m++){const g=new SP(null,o.level,o.row-f,o.col+m);n.updateTileInfo(g),this._tileIsMasked(g)||this._candidateTiles.push(g)}}_tileIsMasked(e){return!!this.maskExtents&&this.maskExtents.some(i=>e.extent&&AR(i,e.extent))}};function WF(t,e,i=0){const n=yS(t,e);let r=n.length-1;if(i>0){const s=i/pi(t.spatialReference),o=n.findIndex(a=>a.resolution<s);o===0?r=0:o>0&&(r=o-1)}return r}const dC={maximumAutoTileRequests:20,noDataValue:0,returnSampleInfo:!1,demResolution:"auto",minDemResolution:0};function yS(t,e){const i=t.lods;if(JF(e)){const{effectiveMinLOD:n,effectiveMaxLOD:r}=e;return i.filter(s=>s.level>=n&&s.level<=r)}return i}function JF(t){return(t==null?void 0:t.tileInfo)!=null}const TZ=Object.freeze(Object.defineProperty({__proto__:null,ElevationQuery:EJe,GeometryDescriptor:hy,getFinestLodIndex:WF},Symbol.toStringTag,{value:"Module"}));let bh=class extends xT{constructor(e){super(e),this.type="input",this.color=new ae("#00c8c8"),this.viewVisualizationEnabled=!1,this.numSamplesForPreview=50,this.numSamplesPerChunk=500,this.chartFillEnabled=!1,this.chartStrokeOffsetY=-1,this._getQueryElevationDependencies=ol((i,n,r,s,o)=>ot(i,a=>({elevationInfo:a,visibleLayers:n,view:r,stationary:s,spatialReference:o})))}get queryElevationDependencies(){var i;const e=(i=this._viewModel)==null?void 0:i.view;return e==null?null:this._getQueryElevationDependencies(this._elevationInfo,this._visibleLayers,e,e.stationary,e.spatialReference)}get available(){var e;return!((e=this._viewModel)!=null&&e.inputIsSketched)}get _elevationInfo(){var e;return ot((e=this._viewModel)==null?void 0:e.input,Vde)}get _visibleLayers(){var i;const e=(i=this._viewModel)==null?void 0:i.view;return ot(e,n=>{var r,s;return(s=(r=n.map)==null?void 0:r.allLayers)==null?void 0:s.filter(o=>o.visible).toArray()})??[]}async queryElevation(e,{noDataValue:i,signal:n}){const r=this.queryElevationDependencies;if(r==null)throw new Error("ElevationProfileLineInput: no dependencies");const{view:s,elevationInfo:o,spatialReference:a}=r;if(o.mode==="on-the-ground"&&s.type==="3d"&&a){const l=await hy.fromGeometry(e).project(a,n);if(!l)return{geometry:e,noDataValue:i};const c=s.elevationProvider;return l.coordinates.forEach(u=>{u.z=c.getElevation(u.x,u.y,0,a,"ground")??0}),{geometry:l.export(),noDataValue:i}}return{geometry:e,noDataValue:i}}attach(e){const i=()=>this._onChange();return $c([super.attach(e),Q(()=>this.queryElevationDependencies,i),on(()=>e.elevationProvider,"elevation-change",i,{onListenerAdd:i,onListenerRemove:i})])}};h([p({type:ae,nonNullable:!0})],bh.prototype,"color",void 0),h([p()],bh.prototype,"viewVisualizationEnabled",void 0),h([p()],bh.prototype,"queryElevationDependencies",null),h([p()],bh.prototype,"available",null),h([p()],bh.prototype,"_elevationInfo",null),h([p()],bh.prototype,"_visibleLayers",null),bh=h([P("esri.widgets.ElevationProfile.ElevationProfileLineInput")],bh);const PJe=bh;let Lp=class extends xT{constructor(e){super(e),this.type="query",this.color=new ae("#db334a"),this.viewVisualizationEnabled=!0,this.source=null,this.numSamplesForPreview=50,this.numSamplesPerChunk=500}get minDemResolution(){return ope(this.source)}get available(){const e=this.source;return!!e&&(e.visible==null||e.visible)&&(e.layers==null||e.layers.some(i=>i.visible))}queryElevation(e,i){if(!this.source)throw new Error("No source configured for the elevation profile line");return this.source.queryElevation(e,i)}attach(e){return $c([super.attach(e),Q(()=>this.source,()=>this._onChange(),ml)])}};h([p({type:ae,nonNullable:!0})],Lp.prototype,"color",void 0),h([p()],Lp.prototype,"viewVisualizationEnabled",void 0),h([p()],Lp.prototype,"source",void 0),h([p({readOnly:!0})],Lp.prototype,"minDemResolution",null),h([p()],Lp.prototype,"available",null),Lp=h([P("esri.widgets.ElevationProfile.ElevationProfileLineQuery")],Lp);const kJe=Lp;let ST=class{constructor(e){this._allocator=e,this._items=[],this._itemsPtr=0,this._grow()}get(){return this._itemsPtr===0&&Z_(()=>this._reset()),this._itemsPtr===this._items.length&&this._grow(),this._items[this._itemsPtr++]}_reset(){const e=Math.min(3*Math.max(8,this._itemsPtr),this._itemsPtr+3*IZ);this._items.length=Math.min(e,this._items.length),this._itemsPtr=0}_grow(){for(let e=0;e<Math.max(8,Math.min(this._items.length,IZ));e++)this._items.push(this._allocator())}};const IZ=1024;function Y8(){return[1,0,0,0,1,0,0,0,1]}function OJe(t){return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8]]}function LJe(t,e,i,n,r,s,o,a,l){return[t,e,i,n,r,s,o,a,l]}function ppe(t,e){return new Float64Array(t,e,9)}Object.freeze(Object.defineProperty({__proto__:null,clone:OJe,create:Y8,createView:ppe,fromValues:LJe},Symbol.toStringTag,{value:"Module"}));function zh(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function RJe(t){return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15]]}function DJe(t,e,i,n,r,s,o,a,l,c,u,d,f,m,g,y){return[t,e,i,n,r,s,o,a,l,c,u,d,f,m,g,y]}function fpe(t,e){return new Float64Array(t,e,16)}const X8=zh();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:X8,clone:RJe,create:zh,createView:fpe,fromValues:DJe},Symbol.toStringTag,{value:"Module"}));function TT(){return[0,0,0,1]}function NJe(t){return[t[0],t[1],t[2],t[3]]}function FJe(t,e,i,n){return[t,e,i,n]}function mpe(t,e){return new Float64Array(t,e,4)}const zJe=TT();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:zJe,clone:NJe,create:TT,createView:mpe,fromValues:FJe},Symbol.toStringTag,{value:"Module"}));let i1=class Og{constructor(e,i,n){this._itemByteSize=e,this._itemCreate=i,this._buffers=new Array,this._items=new Array,this._itemsPtr=0,this._itemsPerBuffer=Math.ceil(n/this._itemByteSize)}get(){this._itemsPtr===0&&Z_(()=>this._reset());const e=Math.floor(this._itemsPtr/this._itemsPerBuffer);for(;this._buffers.length<=e;){const i=new ArrayBuffer(this._itemsPerBuffer*this._itemByteSize);for(let n=0;n<this._itemsPerBuffer;++n)this._items.push(this._itemCreate(i,n*this._itemByteSize));this._buffers.push(i)}return this._items[this._itemsPtr++]}_reset(){const e=2*(Math.floor(this._itemsPtr/this._itemsPerBuffer)+1);for(;this._buffers.length>e;)this._buffers.pop(),this._items.length=this._buffers.length*this._itemsPerBuffer;this._itemsPtr=0}static createVec2f64(e=Q0){return new Og(16,jre,e)}static createVec3f64(e=Q0){return new Og(24,JQ,e)}static createVec4f64(e=Q0){return new Og(32,Voe,e)}static createMat3f64(e=Q0){return new Og(72,ppe,e)}static createMat4f64(e=Q0){return new Og(128,fpe,e)}static createQuatf64(e=Q0){return new Og(32,mpe,e)}get test(){return{size:this._buffers.length*this._itemsPerBuffer*this._itemByteSize}}};const Q0=4*Yy.KILOBYTES,Qgt=i1.createVec2f64(),Ke=i1.createVec3f64(),VJe=i1.createVec4f64();i1.createMat3f64();const jJe=i1.createMat4f64(),eyt=i1.createQuatf64();function il(t){return t?CZ(ns(t.origin),ns(t.direction)):CZ(Me(),Me())}function CZ(t,e){return{origin:t,direction:e}}function tyt(t,e){const i=HJe.get();return i.origin=t,i.direction=e,i}function ZF(t,e=il()){return BJe(t.origin,t.direction,e)}function gpe(t,e,i=il()){return ri(i.origin,t),Ii(i.direction,e,t),i}function BJe(t,e,i=il()){return ri(i.origin,t),ri(i.direction,e),i}function UJe(t,e){const i=io(Ke.get(),ss(Ke.get(),t.direction),Ii(Ke.get(),e,t.origin));return yt(i,i)}function GJe(t,e,i){const n=yt(t.direction,Ii(i,e,t.origin));return sn(i,t.origin,rn(i,t.direction,n)),i}const HJe=new ST(()=>il());var Bo,Cb;(function(t){t[t.OBJECT=0]="OBJECT",t[t.HUD=1]="HUD",t[t.TERRAIN=2]="TERRAIN",t[t.OVERLAY=3]="OVERLAY",t[t.I3S=4]="I3S",t[t.PCL=5]="PCL",t[t.LOD=6]="LOD",t[t.VOXEL=7]="VOXEL"})(Bo||(Bo={}));let qJe=class{constructor(){this.verticalOffset=0,this.selectionMode=!1,this.hud=!0,this.selectOpaqueTerrainOnly=!0,this.invisibleTerrain=!1,this.backfacesTerrain=!0,this.isFiltered=!1,this.filteredLayerUids=[],this.store=Cb.ALL}};(function(t){t[t.MIN=0]="MIN",t[t.MINMAX=1]="MINMAX",t[t.ALL=2]="ALL"})(Cb||(Cb={}));let WJe=class{constructor(e,i,n){this.object=e,this.geometryId=i,this.triangleNr=n}},JJe=class extends WJe{constructor(e,i,n,r){super(e,i,n),this.center=r!=null?ns(r):null}},ZJe=class{constructor(e){this.layerUid=e}},ype=class extends ZJe{constructor(e,i){super(e),this.graphicUid=i}};var ed;(function(t){t[t.X=0]="X",t[t.Y=1]="Y",t[t.Z=2]="Z"})(ed||(ed={}));function IT(t){return t?{origin:ns(t.origin),vector:ns(t.vector)}:{origin:Me(),vector:Me()}}function YJe(t,e){const i=QJe.get();return i.origin=t,i.vector=e,i}function ayt(t,e=IT()){return XJe(t.origin,t.vector,e)}function XJe(t,e,i=IT()){return ri(i.origin,t),ri(i.vector,e),i}function lyt(t,e,i=IT()){return ri(i.origin,t),Ii(i.vector,e,t),i}function KJe(t,e){const i=Ii(Ke.get(),e,t.origin),n=yt(t.vector,i),r=yt(t.vector,t.vector),s=rr(n/r,0,1),o=Ii(Ke.get(),rn(Ke.get(),t.vector,s),i);return yt(o,o)}function cyt(t,e,i){return YF(t,e,0,1,i)}function uyt(t,e,i){return sn(i,t.origin,rn(i,t.vector,e))}function YF(t,e,i,n,r){const{vector:s,origin:o}=t,a=Ii(Ke.get(),e,o),l=yt(s,a)/tb(s);return rn(r,s,rr(l,i,n)),sn(r,r,t.origin)}function hyt(t,e){if(vpe(t,YJe(e.origin,e.direction),!1,M$)){const{tA:i,pB:n,distance2:r}=M$;if(i>=0&&i<=1)return r;if(i<0)return od(t.origin,n);if(i>1)return od(sn(Ke.get(),t.origin,t.vector),n)}return null}function dyt(t,e,i){return!!vpe(t,e,!0,M$)&&(ri(i,M$.pA),!0)}function vpe(t,e,i,n){const s=t.origin,o=sn(Ke.get(),s,t.vector),a=e.origin,l=sn(Ke.get(),a,e.vector),c=Ke.get(),u=Ke.get();if(c[0]=s[0]-a[0],c[1]=s[1]-a[1],c[2]=s[2]-a[2],u[0]=l[0]-a[0],u[1]=l[1]-a[1],u[2]=l[2]-a[2],Math.abs(u[0])<1e-6&&Math.abs(u[1])<1e-6&&Math.abs(u[2])<1e-6)return!1;const d=Ke.get();if(d[0]=o[0]-s[0],d[1]=o[1]-s[1],d[2]=o[2]-s[2],Math.abs(d[0])<1e-6&&Math.abs(d[1])<1e-6&&Math.abs(d[2])<1e-6)return!1;const f=c[0]*u[0]+c[1]*u[1]+c[2]*u[2],m=u[0]*d[0]+u[1]*d[1]+u[2]*d[2],g=c[0]*d[0]+c[1]*d[1]+c[2]*d[2],y=u[0]*u[0]+u[1]*u[1]+u[2]*u[2],_=(d[0]*d[0]+d[1]*d[1]+d[2]*d[2])*y-m*m;if(Math.abs(_)<1e-6)return!1;let b=(f*m-g*y)/_,w=(f+m*b)/y;i&&(b=rr(b,0,1),w=rr(w,0,1));const x=Ke.get(),S=Ke.get();return x[0]=s[0]+b*d[0],x[1]=s[1]+b*d[1],x[2]=s[2]+b*d[2],S[0]=a[0]+w*u[0],S[1]=a[1]+w*u[1],S[2]=a[2]+w*u[2],n.tA=b,n.tB=w,n.pA=x,n.pB=S,n.distance2=od(x,S),!0}const M$={tA:0,tB:0,pA:Me(),pB:Me(),distance2:0},QJe=new ST(()=>IT());function pyt(t,e,i){const n=yt(t,e)/yt(t,t);return rn(i,t,n)}function Cy(t,e){return yt(t,e)/jr(t)}function eZe(t,e){const i=yt(t,e)/(jr(t)*jr(e));return-oP(i)}function fyt(t,e,i){ss(pC,t),ss(SL,e);const n=yt(pC,SL),r=oP(n),s=io(pC,pC,SL);return yt(s,i)<0?2*Math.PI-r:r}const pC=Me(),SL=Me(),tZe=p0();function p0(){return jf()}function _pe(t,e=p0()){return P2(e,t)}function iZe(t,e){return em(t[0],t[1],t[2],e)}function nZe(t){return t}function rZe(t){t[0]=t[1]=t[2]=t[3]=0}function sZe(t,e){return t[0]=t[1]=t[2]=0,t[3]=e,t}function Tk(t){return t[3]}function oZe(t){return t}function aZe(t,e,i,n){return em(t,e,i,n)}function lZe(t,e,i){return t!==i&&ri(i,t),i[3]=t[3]+e,i}function cZe(t,e,i){return ne.getLogger("esri.geometry.support.sphere").error("sphere.setExtent is not yet supported"),t===i?i:_pe(t,i)}function Ik(t,e,i){if(e==null)return!1;const{origin:n,direction:r}=e,s=uZe;s[0]=n[0]-t[0],s[1]=n[1]-t[1],s[2]=n[2]-t[2];const o=r[0]*r[0]+r[1]*r[1]+r[2]*r[2];if(o===0)return!1;const a=2*(r[0]*s[0]+r[1]*s[1]+r[2]*s[2]),l=a*a-4*o*(s[0]*s[0]+s[1]*s[1]+s[2]*s[2]-t[3]*t[3]);if(l<0)return!1;const c=Math.sqrt(l);let u=(-a-c)/(2*o);const d=(-a+c)/(2*o);return(u<0||d<u&&d>0)&&(u=d),!(u<0)&&(i&&(i[0]=n[0]+r[0]*u,i[1]=n[1]+r[1]*u,i[2]=n[2]+r[2]*u),!0)}const uZe=Me();function hZe(t,e){return Ik(t,e,null)}function dZe(t,e,i){if(Ik(t,e,i))return i;const n=bpe(t,e,Ke.get());return sn(i,e.origin,rn(Ke.get(),e.direction,Rb(e.origin,n)/jr(e.direction))),i}function bpe(t,e,i){const n=Ke.get(),r=jJe.get();io(n,e.origin,e.direction);const s=Tk(t);io(i,n,e.origin),rn(i,i,1/jr(i)*s);const o=xpe(t,e.origin),a=eZe(e.origin,i);return mV(r,a+o,n),wu(i,i,r),i}function pZe(t,e,i){return Ik(t,e,i)?i:(GJe(e,t,i),wpe(t,i,i))}function wpe(t,e,i){const n=Ii(Ke.get(),e,t),r=rn(Ke.get(),n,t[3]/jr(n));return sn(i,r,t)}function fZe(t,e){const i=Ii(Ke.get(),e,t),n=tb(i),r=t[3]*t[3];return Math.sqrt(Math.abs(n-r))}function xpe(t,e){const i=Ii(Ke.get(),e,t),n=jr(i),r=Tk(t),s=r+Math.abs(r-n);return oP(r/s)}const TL=Me();function Spe(t,e,i,n){const r=Ii(TL,e,t);switch(i){case ed.X:{const s=k9(r,TL)[2];return Di(n,-Math.sin(s),Math.cos(s),0)}case ed.Y:{const s=k9(r,TL),o=s[1],a=s[2],l=Math.sin(o);return Di(n,-l*Math.cos(a),-l*Math.sin(a),Math.cos(o))}case ed.Z:return ss(n,r);default:return}}function Tpe(t,e){const i=Ii(XF,e,t);return jr(i)-t[3]}function mZe(t,e,i,n){const r=Tpe(t,e),s=Spe(t,e,ed.Z,XF),o=rn(XF,s,i-r);return sn(n,e,o)}function gZe(t,e){const i=od(t,e),n=Tk(t);return i<=n*n}function yZe(t,e,i=p0()){const n=Rb(t,e),r=t[3],s=e[3];return n+s<r?(P2(i,t),i):n+r<s?(P2(i,e),i):(sP(i,t,e,(n+s-r)/(2*n)),i[3]=(n+r+s)/2,i)}const XF=Me(),vZe=p0();Object.freeze(Object.defineProperty({__proto__:null,NullSphere:tZe,altitudeAt:Tpe,angleToSilhouette:xpe,axisAt:Spe,clear:rZe,closestPoint:pZe,closestPointOnSilhouette:bpe,containsPoint:gZe,copy:_pe,create:p0,distanceToSilhouette:fZe,elevate:lZe,fromCenterAndRadius:iZe,fromRadius:sZe,fromValues:aZe,getCenter:oZe,getRadius:Tk,intersectRay:Ik,intersectRayClosestSilhouette:dZe,intersectsRay:hZe,projectPoint:wpe,setAltitudeAt:mZe,setExtent:cZe,tmpSphere:vZe,union:yZe,wrap:nZe},Symbol.toStringTag,{value:"Module"}));function myt(t){const e=t[0]*t[0]+t[4]*t[4]+t[8]*t[8],i=t[1]*t[1]+t[5]*t[5]+t[9]*t[9],n=t[2]*t[2]+t[6]*t[6]+t[10]*t[10];return Math.sqrt(Math.max(e,i,n))}function gyt(t,e){const i=Math.sqrt(e[0]*e[0]+e[4]*e[4]+e[8]*e[8]),n=Math.sqrt(e[1]*e[1]+e[5]*e[5]+e[9]*e[9]),r=Math.sqrt(e[2]*e[2]+e[6]*e[6]+e[10]*e[10]);return Di(t,i,n,r),t}function _Ze(t,e,i){Math.abs(t[0])>Math.abs(t[1])?Di(e,0,1,0):Di(e,1,0,0),io(i,t,e),ss(e,e),io(e,i,t),ss(i,i)}function n1(t=_x){return[t[0],t[1],t[2],t[3]]}function bZe(t=_x[0],e=_x[1],i=_x[2],n=_x[3]){return K8(t,e,i,n,VJe.get())}function Ipe(t,e){return K8(e[0],e[1],e[2],e[3],t)}function K8(t,e,i,n,r=n1()){return r[0]=t,r[1]=e,r[2]=i,r[3]=n,r}function wZe(t,e,i){const n=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=Math.abs(n-1)>1e-5&&n>1e-12?1/Math.sqrt(n):1;return i[0]=e[0]*r,i[1]=e[1]*r,i[2]=e[2]*r,i[3]=-(i[0]*t[0]+i[1]*t[1]+i[2]*t[2]),i}function xZe(t,e,i,n=n1()){const r=i[0]-e[0],s=i[1]-e[1],o=i[2]-e[2],a=t[0]-e[0],l=t[1]-e[1],c=t[2]-e[2],u=s*c-o*l,d=o*a-r*c,f=r*l-s*a,m=u*u+d*d+f*f,g=Math.abs(m-1)>1e-5&&m>1e-12?1/Math.sqrt(m):1;return n[0]=u*g,n[1]=d*g,n[2]=f*g,n[3]=-(n[0]*t[0]+n[1]*t[1]+n[2]*t[2]),n}function SZe(t,e,i,n,r){const s=t.length/3;if(s<3)return!1;Di(J1,t[3*i],t[3*i+1],t[3*i+2]);let o=n,a=!1;for(;o<s-1&&!a;){const l=3*o;Di(ev,t[l],t[l+1],t[l+2]),o++,a=!Li(J1,ev)}if(!a)return!1;for(o=Math.max(o,r),a=!1;o<s&&!a;){const l=3*o;Di(Qg,t[l],t[l+1],t[l+2]),o++,Ii(fC,J1,ev),ss(fC,fC),Ii(mC,ev,Qg),ss(mC,mC),a=!Li(J1,Qg)&&!Li(ev,Qg)&&Math.abs(yt(fC,mC))<TZe}return a?(xZe(J1,ev,Qg,e),!0):(i!==0||n!==1||r!==2)&&SZe(t,e,0,1,2)}const TZe=.99619469809,J1=Me(),ev=Me(),Qg=Me(),fC=Me(),mC=Me();function IZe(t,e,i){return e!==t&&Ipe(t,e),t[3]=-yt(t,i),t}function yyt(t,e){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e}function KF(t,e,i,n){return io(Qg,e,t),wZe(i,Qg,n)}function vyt(t,e,i,n){return Ck(t,e,Ii(Ke.get(),i,e),PZe,n)}function CZe(t,e,i){return e!=null&&Ck(t,e.origin,e.direction,kZe,i)}function MZe(t,e,i){return Ck(t,e.origin,e.vector,$u.NONE,i)}function EZe(t,e,i){return Ck(t,e.origin,e.vector,$u.CLAMP,i)}function Cpe(t,e){return Mpe(t,e)>=0}function _yt(t,e){const i=yt(t,e.ray.direction),n=-Mpe(t,e.ray.origin);if(i>-1e-6&&i<1e-6)return n>0;const r=n/i;return i>0?r<e.c1&&(e.c1=r):r>e.c0&&(e.c0=r),e.c0<=e.c1}function AZe(t,e,i){const n=rn(Ke.get(),t,-t[3]),r=$Ze(t,Ii(Ke.get(),e,n),Ke.get());return sn(i,r,n),i}function byt(t,e,i,n){const r=t,s=Ke.get(),o=Ke.get();_Ze(r,s,o);const a=Ii(Ke.get(),i,e),l=Cy(s,a),c=Cy(o,a),u=Cy(r,a);return Di(n,l,c,u)}function $Ze(t,e,i){const n=rn(Ke.get(),t,yt(t,e));return Ii(i,e,n),i}function Mpe(t,e){return yt(t,e)+t[3]}function Ck(t,e,i,n,r){const s=yt(t,i);if(s===0)return!1;let o=-(yt(t,e)+t[3])/s;return n&$u.CLAMP&&(o=rr(o,0,1)),!(!(n&$u.INFINITE_MIN)&&o<0||!(n&$u.INFINITE_MAX)&&o>1)&&(sn(r,e,rn(r,i,o)),!0)}function wyt(t){return t}const _x=[0,0,1,0];var $u;(function(t){t[t.NONE=0]="NONE",t[t.CLAMP=1]="CLAMP",t[t.INFINITE_MIN=4]="INFINITE_MIN",t[t.INFINITE_MAX=8]="INFINITE_MAX"})($u||($u={}));const PZe=$u.INFINITE_MIN|$u.INFINITE_MAX,kZe=$u.INFINITE_MAX,IL=ne.getLogger("esri.views.3d.support.geometryUtils.boundedPlane");let OZe=class{constructor(){this.plane=n1(),this.origin=Me(),this.basis1=Me(),this.basis2=Me()}};const LZe=OZe;function CT(t=Npe){return{plane:n1(t.plane),origin:ns(t.origin),basis1:ns(t.basis1),basis2:ns(t.basis2)}}function RZe(t,e,i){const n=YZe.get();return n.origin=t,n.basis1=e,n.basis2=i,n.plane=bZe(0,0,0,0),Ek(n),n}function Mk(t,e=CT()){return Epe(t.origin,t.basis1,t.basis2,e)}function DZe(t,e){ri(e.origin,t.origin),ri(e.basis1,t.basis1),ri(e.basis2,t.basis2),Ipe(e.plane,t.plane)}function Epe(t,e,i,n=CT()){return ri(n.origin,t),ri(n.basis1,e),ri(n.basis2,i),Ek(n),JZe(n,"fromValues()"),n}function Ek(t){KF(t.basis2,t.basis1,t.origin,t.plane)}function Ape(t,e,i){t!==i&&Mk(t,i);const n=rn(Ke.get(),pd(t),e);return sn(i.origin,i.origin,n),i.plane[3]-=e,i}function NZe(t,e,i){return $pe(e,i),Ape(i,tB(t,t.origin),i),i}function $pe(t,e=CT()){const i=(t[2]-t[0])/2,n=(t[3]-t[1])/2;return Di(e.origin,t[0]+i,t[1]+n,0),Di(e.basis1,i,0,0),Di(e.basis2,0,n,0),K8(0,0,1,0,e.plane),e}function Q8(t,e,i){return!!CZe(t.plane,e,i)&&Rpe(t,i)}function FZe(t,e,i){if(Q8(t,e,i))return i;const n=Ppe(t,e,Ke.get());return sn(i,e.origin,rn(Ke.get(),e.direction,Rb(e.origin,n)/jr(e.direction))),i}function Ppe(t,e,i){const n=E$.get();Dpe(t,e,n,E$.get());let r=Number.POSITIVE_INFINITY;for(const s of nB){const o=iB(t,s,Ak.get()),a=Ke.get();if(MZe(n,o,a)){const l=ree(Ke.get(),e.origin,a),c=Math.abs(oP(yt(e.direction,l)));c<r&&(r=c,ri(i,a))}}return r===Number.POSITIVE_INFINITY?kpe(t,e,i):i}function kpe(t,e,i){if(Q8(t,e,i))return i;const n=E$.get(),r=E$.get();Dpe(t,e,n,r);let s=Number.POSITIVE_INFINITY;for(const o of nB){const a=iB(t,o,Ak.get()),l=Ke.get();if(EZe(n,a,l)){const c=UJe(e,l);if(!Cpe(r,l))continue;c<s&&(s=c,ri(i,l))}}return eB(t,e.origin)<s&&Ope(t,e.origin,i),i}function Ope(t,e,i){const n=AZe(t.plane,e,Ke.get()),r=YF(MZ(t,t.basis1),n,-1,1,Ke.get()),s=YF(MZ(t,t.basis2),n,-1,1,Ke.get());return Ii(i,sn(Ke.get(),r,s),t.origin),i}function Lpe(t,e,i){const{origin:n,basis1:r,basis2:s}=t,o=Ii(Ke.get(),e,n),a=Cy(r,o),l=Cy(s,o),c=Cy(pd(t),o);return Di(i,a,l,c)}function eB(t,e){const i=Lpe(t,e,Ke.get()),{basis1:n,basis2:r}=t,s=jr(n),o=jr(r),a=Math.max(Math.abs(i[0])-s,0),l=Math.max(Math.abs(i[1])-o,0),c=i[2];return a*a+l*l+c*c}function zZe(t,e){return Math.sqrt(eB(t,e))}function VZe(t,e){let i=Number.NEGATIVE_INFINITY;for(const n of nB){const r=iB(t,n,Ak.get()),s=KJe(r,e);s>i&&(i=s)}return Math.sqrt(i)}function jZe(t,e){return Cpe(t.plane,e)&&Rpe(t,e)}function BZe(t,e,i,n){return WZe(t,i,n)}function tB(t,e){const i=-t.plane[3];return Cy(pd(t),e)-i}function UZe(t,e,i,n){const r=tB(t,e),s=rn(ZZe,pd(t),i-r);return sn(n,e,s),n}function GZe(t,e){return Li(t.basis1,e.basis1)&&Li(t.basis2,e.basis2)&&Li(t.origin,e.origin)}function HZe(t,e,i){return t!==i&&Mk(t,i),bP(tv,e),gl(tv,tv),wu(i.basis1,t.basis1,tv),wu(i.basis2,t.basis2,tv),wu(i.plane,t.plane,tv),wu(i.origin,t.origin,e),IZe(i.plane,i.plane,i.origin),i}function qZe(t,e,i,n){return t!==n&&Mk(t,n),mV(CL,e,i),wu(n.basis1,t.basis1,CL),wu(n.basis2,t.basis2,CL),Ek(n),n}function pd(t){return t.plane}function WZe(t,e,i){switch(e){case ed.X:ri(i,t.basis1),ss(i,i);break;case ed.Y:ri(i,t.basis2),ss(i,i);break;case ed.Z:ri(i,pd(t))}return i}function Rpe(t,e){const i=Ii(Ke.get(),e,t.origin),n=tb(t.basis1),r=tb(t.basis2),s=yt(t.basis1,i),o=yt(t.basis2,i);return-s-n<0&&s-n<0&&-o-r<0&&o-r<0}function MZ(t,e){const i=Ak.get();return ri(i.origin,t.origin),ri(i.vector,e),i}function iB(t,e,i){const{basis1:n,basis2:r,origin:s}=t,o=rn(Ke.get(),n,e.origin[0]),a=rn(Ke.get(),r,e.origin[1]);sn(i.origin,o,a),sn(i.origin,i.origin,s);const l=rn(Ke.get(),n,e.direction[0]),c=rn(Ke.get(),r,e.direction[1]);return rn(i.vector,sn(l,l,c),2),i}function JZe(t,e){Math.abs(yt(t.basis1,t.basis2)/(jr(t.basis1)*jr(t.basis2)))>1e-6&&IL.warn(e,"Provided basis vectors are not perpendicular"),Math.abs(yt(t.basis1,pd(t)))>1e-6&&IL.warn(e,"Basis vectors and plane normal are not perpendicular"),Math.abs(-yt(pd(t),t.origin)-t.plane[3])>1e-6&&IL.warn(e,"Plane offset is not consistent with plane origin")}function Dpe(t,e,i,n){const r=pd(t);KF(r,e.direction,e.origin,i),KF(i,r,e.origin,n)}const Npe={plane:n1(),origin:Ln(0,0,0),basis1:Ln(1,0,0),basis2:Ln(0,1,0)},E$=new ST(n1),Ak=new ST(IT),ZZe=Me(),YZe=new ST(()=>CT()),nB=[{origin:[-1,-1],direction:[1,0]},{origin:[1,-1],direction:[0,1]},{origin:[1,1],direction:[-1,0]},{origin:[-1,1],direction:[0,-1]}],tv=zh(),CL=zh();Object.freeze(Object.defineProperty({__proto__:null,BoundedPlaneClass:LZe,UP:Npe,altitudeAt:tB,axisAt:BZe,closestPoint:kpe,closestPointOnSilhouette:Ppe,copy:Mk,copyWithoutVerify:DZe,create:CT,distance:zZe,distance2:eB,distanceToSilhouette:VZe,elevate:Ape,equals:GZe,extrusionContainsPoint:jZe,fromAABoundingRect:$pe,fromValues:Epe,intersectRay:Q8,intersectRayClosestSilhouette:FZe,normal:pd,projectPoint:Ope,projectPointLocal:Lpe,rotate:qZe,setAltitudeAt:UZe,setExtent:NZe,transform:HZe,updateUnboundedPlane:Ek,wrap:RZe},Symbol.toStringTag,{value:"Module"}));function nm(t){return t!=null&&t.dist!=null}function XZe(t){return nm(t)&&t.intersector===Bo.OBJECT&&!!t.target}function KZe(t){return nm(t)&&t.intersector===Bo.HUD&&!!t.target&&"center"in t.target&&t.target.center!=null}function QZe(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function Fpe(t,e,i){i*=.5;const n=Math.sin(i);return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=Math.cos(i),t}function eYe(t,e){const i=2*Math.acos(e[3]),n=Math.sin(i/2);return n>so()?(t[0]=e[0]/n,t[1]=e[1]/n,t[2]=e[2]/n):(t[0]=1,t[1]=0,t[2]=0),i}function zpe(t,e,i){const n=e[0],r=e[1],s=e[2],o=e[3],a=i[0],l=i[1],c=i[2],u=i[3];return t[0]=n*u+o*a+r*c-s*l,t[1]=r*u+o*l+s*a-n*c,t[2]=s*u+o*c+n*l-r*a,t[3]=o*u-n*a-r*l-s*c,t}function tYe(t,e,i){i*=.5;const n=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(i),l=Math.cos(i);return t[0]=n*l+o*a,t[1]=r*l+s*a,t[2]=s*l-r*a,t[3]=o*l-n*a,t}function iYe(t,e,i){i*=.5;const n=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(i),l=Math.cos(i);return t[0]=n*l-s*a,t[1]=r*l+o*a,t[2]=s*l+n*a,t[3]=o*l-r*a,t}function nYe(t,e,i){i*=.5;const n=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(i),l=Math.cos(i);return t[0]=n*l+r*a,t[1]=r*l-n*a,t[2]=s*l+o*a,t[3]=o*l-s*a,t}function rYe(t,e){const i=e[0],n=e[1],r=e[2];return t[0]=i,t[1]=n,t[2]=r,t[3]=Math.sqrt(Math.abs(1-i*i-n*n-r*r)),t}function mE(t,e,i,n){const r=e[0],s=e[1],o=e[2],a=e[3];let l,c,u,d,f,m=i[0],g=i[1],y=i[2],_=i[3];return c=r*m+s*g+o*y+a*_,c<0&&(c=-c,m=-m,g=-g,y=-y,_=-_),1-c>so()?(l=Math.acos(c),u=Math.sin(l),d=Math.sin((1-n)*l)/u,f=Math.sin(n*l)/u):(d=1-n,f=n),t[0]=d*r+f*m,t[1]=d*s+f*g,t[2]=d*o+f*y,t[3]=d*a+f*_,t}function sYe(t){const e=zS,i=e(),n=e(),r=e(),s=Math.sqrt(1-i),o=Math.sqrt(i);return t[0]=s*Math.sin(2*Math.PI*n),t[1]=s*Math.cos(2*Math.PI*n),t[2]=o*Math.sin(2*Math.PI*r),t[3]=o*Math.cos(2*Math.PI*r),t}function oYe(t,e){const i=e[0],n=e[1],r=e[2],s=e[3],o=i*i+n*n+r*r+s*s,a=o?1/o:0;return t[0]=-i*a,t[1]=-n*a,t[2]=-r*a,t[3]=s*a,t}function Vpe(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function jpe(t,e){const i=e[0]+e[4]+e[8];let n;if(i>0)n=Math.sqrt(i+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{let r=0;e[4]>e[0]&&(r=1),e[8]>e[3*r+r]&&(r=2);const s=(r+1)%3,o=(r+2)%3;n=Math.sqrt(e[3*r+r]-e[3*s+s]-e[3*o+o]+1),t[r]=.5*n,n=.5/n,t[3]=(e[3*s+o]-e[3*o+s])*n,t[s]=(e[3*s+r]+e[3*r+s])*n,t[o]=(e[3*o+r]+e[3*r+o])*n}return t}function aYe(t,e,i,n){const r=.5*Math.PI/180;e*=r,i*=r,n*=r;const s=Math.sin(e),o=Math.cos(e),a=Math.sin(i),l=Math.cos(i),c=Math.sin(n),u=Math.cos(n);return t[0]=s*l*u-o*a*c,t[1]=o*a*u+s*l*c,t[2]=o*l*c-s*a*u,t[3]=o*l*u+s*a*c,t}function lYe(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}const cYe=P2,uYe=oee,hYe=aee,dYe=zpe,pYe=hee,fYe=mee,mYe=S6,Bpe=w6,gYe=Bpe,Upe=x6,yYe=Upe,rB=fee,vYe=yee,_Ye=vee;function bYe(t,e,i){const n=yt(e,i);return n<-.999999?(io(Vc,wYe,e),see(Vc)<1e-6&&io(Vc,xYe,e),ss(Vc,Vc),Fpe(t,Vc,Math.PI),t):n>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(io(Vc,e,i),t[0]=Vc[0],t[1]=Vc[1],t[2]=Vc[2],t[3]=1+n,rB(t,t))}const Vc=Me(),wYe=Ln(1,0,0),xYe=Ln(0,1,0);function SYe(t,e,i,n,r,s){return mE(EZ,e,r,s),mE(AZ,i,n,s),mE(t,EZ,AZ,2*s*(1-s)),t}const EZ=TT(),AZ=TT();function TYe(t,e,i,n){const r=IYe;return r[0]=i[0],r[3]=i[1],r[6]=i[2],r[1]=n[0],r[4]=n[1],r[7]=n[2],r[2]=-e[0],r[5]=-e[1],r[8]=-e[2],rB(t,jpe(t,r))}const IYe=Y8();Object.freeze(Object.defineProperty({__proto__:null,add:hYe,calculateW:rYe,conjugate:Vpe,copy:cYe,dot:fYe,equals:_Ye,exactEquals:vYe,fromEuler:aYe,fromMat3:jpe,getAxisAngle:eYe,identity:QZe,invert:oYe,len:gYe,length:Bpe,lerp:mYe,mul:dYe,multiply:zpe,normalize:rB,random:sYe,rotateX:tYe,rotateY:iYe,rotateZ:nYe,rotationTo:bYe,scale:pYe,set:uYe,setAxes:TYe,setAxisAngle:Fpe,slerp:mE,sqlerp:SYe,sqrLen:yYe,squaredLength:Upe,str:lYe},Symbol.toStringTag,{value:"Module"}));function sB(){return new Float32Array(3)}function CYe(t){const e=new Float32Array(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function MT(t,e,i){const n=new Float32Array(3);return n[0]=t,n[1]=e,n[2]=i,n}function MYe(t,e){return new Float32Array(t,e,3)}function Gpe(){return sB()}function Hpe(){return MT(1,1,1)}function qpe(){return MT(1,0,0)}function Wpe(){return MT(0,1,0)}function Jpe(){return MT(0,0,1)}const EYe=Gpe(),AYe=Hpe(),$Ye=qpe(),PYe=Wpe(),kYe=Jpe();Object.freeze(Object.defineProperty({__proto__:null,ONES:AYe,UNIT_X:$Ye,UNIT_Y:PYe,UNIT_Z:kYe,ZEROS:EYe,clone:CYe,create:sB,createView:MYe,fromValues:MT,ones:Hpe,unitX:qpe,unitY:Wpe,unitZ:Jpe,zeros:Gpe},Symbol.toStringTag,{value:"Module"}));let OYe=class{constructor(){this._transform=zh(),this._transformInverse=new gC({value:this._transform},bP,zh),this._transformInverseTranspose=new gC(this._transformInverse,gl,zh),this._transformTranspose=new gC({value:this._transform},gl,zh),this._transformInverseRotation=new gC({value:this._transform},cse,Y8)}_invalidateLazyTransforms(){this._transformInverse.invalidate(),this._transformInverseTranspose.invalidate(),this._transformTranspose.invalidate(),this._transformInverseRotation.invalidate()}get transform(){return this._transform}get inverse(){return this._transformInverse.value}get inverseTranspose(){return this._transformInverseTranspose.value}get inverseRotation(){return this._transformInverseRotation.value}get transpose(){return this._transformTranspose.value}setTransformMatrix(e){U2(this._transform,e)}multiplyTransform(e){fV(this._transform,this._transform,e)}set(e){U2(this._transform,e),this._invalidateLazyTransforms()}setAndInvalidateLazyTransforms(e,i){this.setTransformMatrix(e),this.multiplyTransform(i),this._invalidateLazyTransforms()}},gC=class{constructor(e,i,n){this._original=e,this._update=i,this._dirty=!0,this._transform=n()}invalidate(){this._dirty=!0}get value(){return this._dirty&&(this._update(this._transform,this._original.value),this._dirty=!1),this._transform}},LYe=class{constructor(e=0){this.componentLocalOriginLength=0,this._tmpVertex=Me(),this._mbs=p0(),this._obb={center:Me(),halfSize:sB(),quaternion:null},this._totalOffset=0,this._offset=0,this._resetOffset(e)}_resetOffset(e){this._offset=e,this._totalOffset=e}set offset(e){this._resetOffset(e)}get offset(){return this._offset}set componentOffset(e){this._totalOffset=this._offset+e}set localOrigin(e){this.componentLocalOriginLength=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2])}applyToVertex(e,i,n){const r=e,s=i,o=n+this.componentLocalOriginLength,a=this._totalOffset/Math.sqrt(r*r+s*s+o*o);return this._tmpVertex[0]=e+r*a,this._tmpVertex[1]=i+s*a,this._tmpVertex[2]=n+o*a,this._tmpVertex}applyToAabb(e){const i=e[0],n=e[1],r=e[2]+this.componentLocalOriginLength,s=e[3],o=e[4],a=e[5]+this.componentLocalOriginLength,l=i*s<0?0:Math.min(Math.abs(i),Math.abs(s)),c=n*o<0?0:Math.min(Math.abs(n),Math.abs(o)),u=r*a<0?0:Math.min(Math.abs(r),Math.abs(a)),d=Math.sqrt(l*l+c*c+u*u);if(d<this._totalOffset)return e[0]-=i<0?this._totalOffset:0,e[1]-=n<0?this._totalOffset:0,e[2]-=r<0?this._totalOffset:0,e[3]+=s>0?this._totalOffset:0,e[4]+=o>0?this._totalOffset:0,e[5]+=a>0?this._totalOffset:0,e;const f=Math.max(Math.abs(i),Math.abs(s)),m=Math.max(Math.abs(n),Math.abs(o)),g=Math.max(Math.abs(r),Math.abs(a)),y=Math.sqrt(f*f+m*m+g*g),_=this._totalOffset/y,b=this._totalOffset/d;return e[0]+=i*(i>0?_:b),e[1]+=n*(n>0?_:b),e[2]+=r*(r>0?_:b),e[3]+=s*(s<0?_:b),e[4]+=o*(o<0?_:b),e[5]+=a*(a<0?_:b),e}applyToMbs(e){const i=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]),n=this._totalOffset/i;return this._mbs[0]=e[0]+e[0]*n,this._mbs[1]=e[1]+e[1]*n,this._mbs[2]=e[2]+e[2]*n,this._mbs[3]=e[3]+e[3]*this._totalOffset/i,this._mbs}applyToObb(e){const i=e.center,n=this._totalOffset/Math.sqrt(i[0]*i[0]+i[1]*i[1]+i[2]*i[2]);this._obb.center[0]=i[0]+i[0]*n,this._obb.center[1]=i[1]+i[1]*n,this._obb.center[2]=i[2]+i[2]*n,TR(this._obb.halfSize,e.halfSize,e.quaternion),sn(this._obb.halfSize,this._obb.halfSize,e.center);const r=this._totalOffset/Math.sqrt(this._obb.halfSize[0]*this._obb.halfSize[0]+this._obb.halfSize[1]*this._obb.halfSize[1]+this._obb.halfSize[2]*this._obb.halfSize[2]);return this._obb.halfSize[0]+=this._obb.halfSize[0]*r,this._obb.halfSize[1]+=this._obb.halfSize[1]*r,this._obb.halfSize[2]+=this._obb.halfSize[2]*r,Ii(this._obb.halfSize,this._obb.halfSize,e.center),Vpe(kZ,e.quaternion),TR(this._obb.halfSize,this._obb.halfSize,kZ),this._obb.halfSize[0]*=this._obb.halfSize[0]<0?-1:1,this._obb.halfSize[1]*=this._obb.halfSize[1]<0?-1:1,this._obb.halfSize[2]*=this._obb.halfSize[2]<0?-1:1,this._obb.quaternion=e.quaternion,this._obb}},RYe=class{constructor(e=0){this.offset=e,this.sphere=p0(),this.tmpVertex=Me()}applyToVertex(e,i,n){const r=this.objectTransform.transform;let s=r[0]*e+r[4]*i+r[8]*n+r[12],o=r[1]*e+r[5]*i+r[9]*n+r[13],a=r[2]*e+r[6]*i+r[10]*n+r[14];const l=this.offset/Math.sqrt(s*s+o*o+a*a);s+=s*l,o+=o*l,a+=a*l;const c=this.objectTransform.inverse;return this.tmpVertex[0]=c[0]*s+c[4]*o+c[8]*a+c[12],this.tmpVertex[1]=c[1]*s+c[5]*o+c[9]*a+c[13],this.tmpVertex[2]=c[2]*s+c[6]*o+c[10]*a+c[14],this.tmpVertex}applyToMinMax(e,i){const n=this.offset/Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]+=e[0]*n,e[1]+=e[1]*n,e[2]+=e[2]*n;const r=this.offset/Math.sqrt(i[0]*i[0]+i[1]*i[1]+i[2]*i[2]);i[0]+=i[0]*r,i[1]+=i[1]*r,i[2]+=i[2]*r}applyToAabb(e){const i=this.offset/Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]+=e[0]*i,e[1]+=e[1]*i,e[2]+=e[2]*i;const n=this.offset/Math.sqrt(e[3]*e[3]+e[4]*e[4]+e[5]*e[5]);return e[3]+=e[3]*n,e[4]+=e[4]*n,e[5]+=e[5]*n,e}applyToBoundingSphere(e){const i=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]),n=this.offset/i;return this.sphere[0]=e[0]+e[0]*n,this.sphere[1]=e[1]+e[1]*n,this.sphere[2]=e[2]+e[2]*n,this.sphere[3]=e[3]+e[3]*this.offset/i,this.sphere}};const $Z=new RYe;function PZ(t){return t!=null?($Z.offset=t,$Z):null}new LYe;const kZ=TT(),OZ=1e-5;let DYe=class{constructor(e){this.options=new qJe,this._results=new FYe,this.transform=new OYe,this.tolerance=OZ,this.verticalOffset=null,this._ray=il(),this._rayEnd=Me(),this._rayBeginTransformed=Me(),this._rayEndTransformed=Me(),this.viewingMode=e??cb.Global}get results(){return this._results}get ray(){return this._ray}get rayBegin(){return this._ray.origin}get rayEnd(){return this._rayEnd}reset(e,i,n){this.resetWithRay(gpe(e,i,this._ray),n)}resetWithRay(e,i){this.camera=i,e!==this._ray&&ZF(e,this._ray),this.options.verticalOffset!==0?this.viewingMode===cb.Local?this._ray.origin[2]-=this.options.verticalOffset:this.verticalOffset=this.options.verticalOffset:this.verticalOffset=null,sn(this._rayEnd,this._ray.origin,this._ray.direction),this._results.init(this._ray)}intersect(e=null,i,n,r,s){this.point=i,this.filterPredicate=r,this.tolerance=n??OZ;const o=PZ(this.verticalOffset);if(e&&e.length>0){const a=s?l=>{s(l)&&this.intersectObject(l)}:l=>{this.intersectObject(l)};for(const l of e){const c=l.getSpatialQueryAccelerator&&l.getSpatialQueryAccelerator();c!=null?(o!=null?c.forEachAlongRayWithVerticalOffset(this._ray.origin,this._ray.direction,a,o):c.forEachAlongRay(this._ray.origin,this._ray.direction,a),this.options.selectionMode&&this.options.hud&&c.forEachDegenerateObject(a)):l.objects.forAll(u=>a(u))}}this.sortResults()}intersectObject(e){const i=e.geometries;if(!i)return;const n=e.shaderTransformation,r=PZ(this.verticalOffset);for(const s of i){if(!s.visible)continue;const{material:o,id:a}=s;this.transform.setAndInvalidateLazyTransforms(n,s.shaderTransformation),wu(this._rayBeginTransformed,this.rayBegin,this.transform.inverse),wu(this._rayEndTransformed,this.rayEnd,this.transform.inverse);const l=this.transform.transform;r!=null&&(r.objectTransform=this.transform),o.intersect(s,this.transform.transform,this,this._rayBeginTransformed,this._rayEndTransformed,(c,u,d,f,m,g)=>{if(c>=0){if(this.filterPredicate!=null&&!this.filterPredicate(this._ray.origin,this._rayEnd,c))return;const y=f?this._results.hud:this._results,_=f?b=>{const w=new JJe(e,a,d,g);b.set(Bo.HUD,w,c,u,X8,m)}:b=>b.set(Bo.OBJECT,{object:e,geometryId:a,triangleNr:d},c,u,l,m);if((y.min.drapedLayerOrder==null||m>=y.min.drapedLayerOrder)&&(y.min.dist==null||c<y.min.dist)&&_(y.min),this.options.store!==Cb.MIN&&(y.max.drapedLayerOrder==null||m<y.max.drapedLayerOrder)&&(y.max.dist==null||c>y.max.dist)&&_(y.max),this.options.store===Cb.ALL)if(f){const b=new QF(this._ray);_(b),this._results.hud.all.push(b)}else{const b=new H_(this._ray);_(b),this._results.all.push(b)}}})}}sortResults(e=this._results.all){e.sort((i,n)=>i.dist!==n.dist?(i.dist??0)-(n.dist??0):i.drapedLayerOrder!==n.drapedLayerOrder?(i.drapedLayerOrder??Number.MAX_VALUE)-(n.drapedLayerOrder??Number.MAX_VALUE):(n.drapedLayerGraphicOrder??Number.MIN_VALUE)-(i.drapedLayerGraphicOrder??Number.MIN_VALUE))}};function NYe(t){return new DYe(t)}let FYe=class{constructor(){this.min=new H_(il()),this.max=new H_(il()),this.hud={min:new QF(il()),max:new QF(il()),all:new Array},this.ground=new H_(il()),this.all=[]}init(e){this.min.init(e),this.max.init(e),this.ground.init(e),this.all.length=0,this.hud.min.init(e),this.hud.max.init(e),this.hud.all.length=0}},H_=class{get ray(){return this._ray}get distanceInRenderSpace(){return this.dist!=null?(rn(yC,this.ray.direction,this.dist),jr(yC)):null}getIntersectionPoint(e){return!!nm(this)&&(rn(yC,this.ray.direction,this.dist),sn(e,this.ray.origin,yC),!0)}getTransformedNormal(e){return ri(Z1,this.normal),Z1[3]=0,gee(Z1,Z1,this.transformation),ri(e,Z1),ss(e,e)}constructor(e){this.intersector=Bo.OBJECT,this.normal=Me(),this.transformation=zh(),this._ray=il(),this.init(e)}init(e){this.dist=null,this.target=null,this.drapedLayerOrder=null,this.drapedLayerGraphicOrder=null,this.intersector=Bo.OBJECT,ZF(e,this._ray)}set(e,i,n,r,s,o,a){this.intersector=e,this.dist=n,ri(this.normal,r??tee),U2(this.transformation,s??X8),this.target=i,this.drapedLayerOrder=o,this.drapedLayerGraphicOrder=a}copy(e){ZF(e.ray,this._ray),this.intersector=e.intersector,this.dist=e.dist,this.target=e.target,this.drapedLayerOrder=e.drapedLayerOrder,this.drapedLayerGraphicOrder=e.drapedLayerGraphicOrder,ri(this.normal,e.normal),U2(this.transformation,e.transformation)}},QF=class extends H_{constructor(){super(...arguments),this.intersector=Bo.HUD}};function Pyt(t){return new H_(t)}const yC=Me(),Z1=jf();function zYe(t){return nm(t)&&t.intersector===Bo.PCL&&!!t.target}function VYe(t){return nm(t)&&t.intersector===Bo.I3S&&!!t.target}function jYe(t){return nm(t)&&t.intersector===Bo.VOXEL&&!!t.target}let kyt=class extends ype{constructor(e,i,n){super(e,i),this.triangleNr=n}};function BYe(t){return nm(t)&&t.intersector===Bo.OVERLAY&&!!t.target}let Lyt=class extends ype{constructor(e,i,n,r,s,o){super(e,i),this.layerUid=e,this.graphicUid=i,this.geometryId=n,this.triangleNr=r,this.baseBoundingSphere=s,this.numLodLevels=o}};function UYe(t){return nm(t)&&t.intersector===Bo.LOD&&!!t.target}function GYe(t,e){const i=HYe(t,e);return i!=null&&i.type==="graphic"?i.graphic:null}function HYe(t,e){var i;if(t==null)return null;if(XZe(t)||KZe(t))return LZ((i=t.target)==null?void 0:i.object,e);if(zYe(t)){const n=t.target.createGraphic();return{type:"graphic",graphic:n,layer:n.layer}}if(jYe(t)){const n=t.target.createVoxelGraphic();return{type:"graphic",graphic:n,layer:n.layer}}return BYe(t)||UYe(t)?LZ(t.target,e):VYe(t)?qYe(t.target,e):null}function LZ(t,e){if(t==null||t.graphicUid==null)return null;const i=Zpe(t,e);if(i==null)return null;if(i===e.graphics)return e.graphicsView==null||typeof t.graphicUid!="number"?null:e.graphicsView.getHit(t.graphicUid);const n=e.allLayerViews.find(r=>r.layer===i);return!n||n.suspended||t.graphicUid==null?null:"getHit"in n?n.getHit(t.graphicUid):null}function qYe(t,e){const i=Zpe(t,e);if(i==null)return null;const n=e.allLayerViews.find(r=>r.layer===i);return n&&!n.suspended&&"getGraphicFromIntersectorTarget"in n?WYe(n.getGraphicFromIntersectorTarget(t)):null}function WYe(t){return t!=null?{type:"graphic",graphic:t,layer:t.layer}:null}function Zpe(t,e){return t&&t.layerUid!=null?e.graphicsView!=null&&t.layerUid===e.graphicsView.processor.layer.id?e.graphics:e.map.findLayerByUid(t.layerUid):null}const JYe=2e5;let Ys=class extends xT{constructor(e){super(e),this.type="view",this.color=new ae("#cf4ccf"),this.viewVisualizationEnabled=!0,this.include=null,this.exclude=null,this.numSamplesForPreview=50,this.numSamplesPerChunk=25,this._getQueryElevationDependencies=ol((i,n,r,s,o,a,l)=>({inputGraphicUid:i!=null?Ype(i):null,visibleLayers:n,maxIntersectionDistance:r,intersectOptions:s,view:o,stationary:a,spatialReference:l})),this._vecA=jf(),this._vecB=jf(),this._ray=il()}get minDemResolution(){var n,r,s;const e=(n=this._viewModel)==null?void 0:n.view;if(e==null||e.type!=="3d")return null;const i=(s=(r=e.pointsOfInterest)==null?void 0:r.focus)==null?void 0:s.renderLocation;return i?e.state.camera.computeRenderPixelSizeAt(i)*sd(e.spatialReference):null}get queryElevationDependencies(){return ot(this._view,e=>{var i;return this._getQueryElevationDependencies((i=this._viewModel)==null?void 0:i.input,this._visibleLayers,this._maxIntersectionDistance,this._intersectOptions,e,e.stationary,e.spatialReference)})}get _visibleLayers(){const e=this._view;return ot(e,i=>{var n,r;return(r=(n=i.map)==null?void 0:n.allLayers)==null?void 0:r.filter(s=>s.visible).toArray()})??[]}get _intersectOptions(){const e=this._view;if(e==null)return{};const i=e.externalToInternalIntersectOptions({include:this.include,exclude:this.exclude}),n=e.externalToInternalIntersectOptions({exclude:this._pointCloudLayers});return i.exclude=Pye(i.exclude,n.exclude),i}get _pointCloudLayers(){const e=this._view;return e==null?[]:e.allLayerViews.toArray().filter(i=>{var n;return((n=i.layer)==null?void 0:n.type)==="point-cloud"}).map(i=>i.layer)}get _view(){var i;const e=(i=this._viewModel)==null?void 0:i.view;return e!=null&&e.type==="3d"?e:null}get _maxIntersectionDistance(){const e=this._view;return e!=null&&e.renderCoordsHelper?nP(e.spatialReference).radius/e.renderCoordsHelper.unitInMeters:Number.POSITIVE_INFINITY}get _intersector(){const e=this._view;if(e==null)return null;const i=NYe(e.state.viewingMode),n=i.options;return n.hud=!1,n.invisibleTerrain=!1,n.backfacesTerrain=!1,n.selectionMode=!1,n.store=Cb.ALL,i}async queryElevation(e,{noDataValue:i,signal:n}){const r=this.queryElevationDependencies;if(r==null)throw new Error("ElevationProfileLineInput: no dependencies");const s=this._intersector;if(s==null)throw new Error("ElevationProfileLineInput: no view");const{intersectOptions:o,view:a,spatialReference:l}=r,c=a.renderCoordsHelper,u=a.sceneIntersectionHelper,d=this._vecA,f=this._vecA,m=this._vecB,g=this._ray;if(!l)return{geometry:e,noDataValue:i};const y=await hy.fromGeometry(e).project(l,n);if(!y)return{geometry:e,noDataValue:i};const _=y.coordinates,b=_.length;for(let w=0;w<b;++w){const x=_[w];Di(m,x.x,x.y,x.z??0),c.toRenderCoords(m,l,m),c.setAltitude(d,JYe,m);const S=gpe(d,m,g);u.computeIntersection(S,s,o);const T=ZYe(r,s.results.all);T?(T.getIntersectionPoint(f),c.fromRenderCoords(f,f,l),x.z=f[2]):x.z=i}return{geometry:y.export(),noDataValue:i}}attach(e){const i=()=>this._onChange();return $c([super.attach(e),Q(()=>this.queryElevationDependencies,i),on(()=>e.elevationProvider,"elevation-change",i,{onListenerAdd:i,onListenerRemove:i})])}};function ZYe({view:t,inputGraphicUid:e,maxIntersectionDistance:i},n){for(const r of n){if(r.distanceInRenderSpace!=null&&r.distanceInRenderSpace>i)continue;const s=GYe(r,t);if(s==null||Ype(s)!==e)return r}return null}function Ype(t){if(t.layer&&"objectIdField"in t.layer){const e=t.attributes[t.layer.objectIdField];if(e)return`o-${t.layer.id}-${e}`}return`u-${t.uid}`}h([p({type:ae,nonNullable:!0})],Ys.prototype,"color",void 0),h([p()],Ys.prototype,"viewVisualizationEnabled",void 0),h([p()],Ys.prototype,"include",void 0),h([p()],Ys.prototype,"exclude",void 0),h([p({readOnly:!0})],Ys.prototype,"minDemResolution",null),h([p()],Ys.prototype,"queryElevationDependencies",null),h([p()],Ys.prototype,"_visibleLayers",null),h([p()],Ys.prototype,"_intersectOptions",null),h([p()],Ys.prototype,"_pointCloudLayers",null),h([p()],Ys.prototype,"_view",null),h([p()],Ys.prototype,"_maxIntersectionDistance",null),h([p()],Ys.prototype,"_intersector",null),Ys=h([P("esri.widgets.ElevationProfile.ElevationProfileLineView")],Ys);const YYe=Ys,XYe={base:xT,key:"type",typeMap:{ground:lpe,input:PJe,query:kJe,view:YYe},errorContext:"elevation-profile-line"},KYe=xe.ofType(XYe);let wh=class extends cj(_j(lP)){constructor(e){super(e),this.elevationInfo=null,this.graphics=new _y,this.screenSizePerspectiveEnabled=!0,this.type="graphics",this.internal=!1}destroy(){this.removeAll(),this.graphics.destroy()}add(e){return this.graphics.add(e),this}addMany(e){return this.graphics.addMany(e),this}removeAll(){return this.graphics.removeAll(),this}remove(e){this.graphics.remove(e)}removeMany(e){this.graphics.removeMany(e)}on(e,i){return super.on(e,i)}graphicChanged(e){this.emit("graphic-update",e)}};h([p({type:Cae})],wh.prototype,"elevationInfo",void 0),h([p(dD(_y,"graphics"))],wh.prototype,"graphics",void 0),h([p({type:["show","hide"]})],wh.prototype,"listMode",void 0),h([p()],wh.prototype,"screenSizePerspectiveEnabled",void 0),h([p({readOnly:!0})],wh.prototype,"type",void 0),h([p({constructOnly:!0})],wh.prototype,"internal",void 0),wh=h([P("esri.layers.GraphicsLayer")],wh);const Xpe=wh;function ML(t){switch(t){case ni.SUPPORTED:break;case ni.GRAPHICS_LAYER_MISSING:return"not owned by a graphics layer";case ni.GEOMETRY_MISSING:return"no geometry";case ni.GEOMETRY_TYPE_UNSUPPORTED:return"the geometry type is not supported";case ni.ELEVATION_MODE_UNSUPPORTED:return"the elevation mode is not supported";case ni.SYMBOL_TYPE_UNSUPPORTED:return"the symbol type is not supported"}return""}var ni;(function(t){t[t.SUPPORTED=0]="SUPPORTED",t[t.GRAPHICS_LAYER_MISSING=1]="GRAPHICS_LAYER_MISSING",t[t.GEOMETRY_MISSING=2]="GEOMETRY_MISSING",t[t.GEOMETRY_TYPE_UNSUPPORTED=3]="GEOMETRY_TYPE_UNSUPPORTED",t[t.ELEVATION_MODE_UNSUPPORTED=4]="ELEVATION_MODE_UNSUPPORTED",t[t.SYMBOL_TYPE_UNSUPPORTED=5]="SYMBOL_TYPE_UNSUPPORTED"})(ni||(ni={}));function QYe(t){var e;if(((e=t.layer)==null?void 0:e.type)!=="graphics")return ni.GRAPHICS_LAYER_MISSING;if(t.geometry==null)return ni.GEOMETRY_MISSING;switch(t.geometry.type){case"polygon":case"point":case"polyline":case"mesh":break;default:return ni.GEOMETRY_TYPE_UNSUPPORTED}return bk(t)!=="on-the-ground"&&wk(t)?ni.ELEVATION_MODE_UNSUPPORTED:ni.SUPPORTED}var ez;let Rp=ez=class extends Vr{constructor(...t){super(...t),this.center=null,this.geodesic=!1,this.numberOfPoints=60,this.radius=1e3,this.radiusUnit="meters"}normalizeCtorArgs(t,e){let i;if(t&&t.center)i=t;else{if(t&&t.rings)return super.normalizeCtorArgs(t,e);i={center:t}}return{...super.normalizeCtorArgs(),...i,...e}}initialize(){const t=this.center,e=this.numberOfPoints;if(this.hasZ=(t==null?void 0:t.hasZ)??!1,this.rings.length!==0||!t)return;const i=ht(this.radius,this.radiusUnit,"meters"),n=t.spatialReference;let r,s="geographic";if(n.isWebMercator?s="webMercator":((n.wkid&&k[n.wkid])!=null||n.wkt&&n.wkt.indexOf("PROJCS")===0)&&(s="projected"),this.geodesic){let o;switch(s){case"webMercator":o=ny(t);break;case"projected":console.error("Creating a geodesic circle requires the center to be specified in web mercator or geographic coordinate system");break;case"geographic":o=t}r=this._createGeodesicCircle(o,i,e),s==="webMercator"&&(r=qh(r))}else{let o;s==="webMercator"||s==="projected"?o=i/this._convert2Meters(1,t.spatialReference):s==="geographic"&&(o=TQ(i,"meters",nP(t.spatialReference).radius)),r=this._createPlanarCircle(t,o,e)}this.spatialReference=r.spatialReference,this.addRing(r.rings[0])}clone(){const{center:t,numberOfPoints:e,radius:i,radiusUnit:n,geodesic:r}=this;return new ez({center:t==null?void 0:t.clone(),numberOfPoints:e,radius:i,radiusUnit:n,geodesic:r})}_createGeodesicCircle(t,e,i){let n=0;const r=[];for(;n<360;){const s=[0,0],o=[t.x,t.y];U_(s,o,n,e),this.hasZ&&s.push(t.z),r.push(s),n+=360/i}return r.push(r[0]),new Vr(r)}_createPlanarCircle(t,e,i){const n=[],r=2*Math.PI/i;for(let s=0;s<i;++s){const o=r*s,a=[t.x+Math.cos(-o)*e,t.y+Math.sin(-o)*e];this.hasZ&&a.push(t.z),n.push(a)}return n.push(n[0]),new Vr({spatialReference:t.spatialReference,rings:[n]})}_convert2Meters(t,e){let i;if(e.wkid&&k[e.wkid]!=null)i=k.values[k[e.wkid]];else{const n=e.wkt,r=n.lastIndexOf(",")+1,s=n.lastIndexOf("]]");i=parseFloat(n.substring(r,s))}return t*i}};h([p({type:pe})],Rp.prototype,"center",void 0),h([p()],Rp.prototype,"geodesic",void 0),h([p()],Rp.prototype,"numberOfPoints",void 0),h([p()],Rp.prototype,"radius",void 0),h([p()],Rp.prototype,"radiusUnit",void 0),Rp=ez=h([P("esri.geometry.Circle")],Rp);const eXe=Rp;function vC(t){return Kpe(t).result}function Fyt(t){return Kpe(t).geometry}function Kpe(t){var n;if(((n=t.layer)==null?void 0:n.type)!=="graphics")return{result:ni.GRAPHICS_LAYER_MISSING,geometry:null};const{geometry:e}=t;if(e==null)return{result:ni.GEOMETRY_MISSING,geometry:null};if(bk(t)!=="on-the-ground"&&wk(t))return{result:ni.ELEVATION_MODE_UNSUPPORTED,geometry:null};const i=e.type;return i!=="point"&&i!=="mesh"&&i!=="polyline"&&(i!=="polygon"||t.geometry instanceof eXe)?{result:ni.GEOMETRY_TYPE_UNSUPPORTED,geometry:null}:{result:ni.SUPPORTED,geometry:e}}function tXe(t){var i;if(((i=t.layer)==null?void 0:i.type)!=="graphics")return ni.GRAPHICS_LAYER_MISSING;if(t.geometry==null)return ni.GEOMETRY_MISSING;switch(t.geometry.type){case"point":break;case"polygon":case"polyline":case"multipoint":case"extent":case"mesh":return ni.SUPPORTED;default:return ni.GEOMETRY_TYPE_UNSUPPORTED}const e=t.symbol!=null&&t.symbol.type==="point-3d"&&t.symbol.symbolLayers;return e&&e.length>0&&e.some(n=>n.type==="object")?bk(t)!=="on-the-ground"&&wk(t)?ni.ELEVATION_MODE_UNSUPPORTED:ni.SUPPORTED:ni.SYMBOL_TYPE_UNSUPPORTED}function RZ(t,e,i){if(!e||!t||!t.map)return;const{map:n}=t,r=n.layers.find(s=>s===e);r||n.add(e,i),r&&i!=null&&n.layers.reorder(r,i)}function zyt(t,e){return t.allLayerViews.find(i=>{const n=i.layer;return n===e||"sublayers"in n&&n.sublayers!=null&&n.sublayers.includes(e)})}const jn={redo:"r",undo:"z",center:"Alt",constraint:"Shift",cancel:"Escape",delete:["Backspace","Delete"],complete:"Enter",vertexAdd:"f",pan:" "},DZ={toggle:"Control"};let gE=class extends ye{constructor(e){super(e),this.enabled=!1}};h([p({type:Boolean,nonNullable:!0})],gE.prototype,"enabled",void 0),gE=h([P("esri.views.interactive.sketch.SketchLabelOptions")],gE);const Qpe=gE;let f2=class extends ye{constructor(e){super(e),this.mode="absolute-height"}toJSON(){return{mode:this.mode}}};h([p({type:String,nonNullable:!0})],f2.prototype,"mode",void 0),f2=h([P("esri.widgets.Sketch.SketchTooltipOptions.ElevationOptions")],f2);let So=class extends ye{constructor(){super(...arguments),this.distance=!0,this.elevation=!0,this.size=!0,this.scale=!0,this.rotation=!0,this.orientation=!0,this.totalLength=!0,this.area=!0,this.radius=!0,this.helpMessage=!1}toJSON(){return{distance:this.distance,size:this.size,scale:this.scale,rotation:this.rotation,orientation:this.orientation,totalLength:this.totalLength,area:this.area,radius:this.radius}}};h([p({type:Boolean,nonNullable:!0})],So.prototype,"distance",void 0),h([p({type:Boolean,nonNullable:!0})],So.prototype,"elevation",void 0),h([p({type:Boolean,nonNullable:!0})],So.prototype,"size",void 0),h([p({type:Boolean,nonNullable:!0})],So.prototype,"scale",void 0),h([p({type:Boolean,nonNullable:!0})],So.prototype,"rotation",void 0),h([p({type:Boolean,nonNullable:!0})],So.prototype,"orientation",void 0),h([p({type:Boolean,nonNullable:!0})],So.prototype,"totalLength",void 0),h([p({type:Boolean,nonNullable:!0})],So.prototype,"area",void 0),h([p({type:Boolean,nonNullable:!0})],So.prototype,"radius",void 0),h([p({type:Boolean,nonNullable:!0})],So.prototype,"helpMessage",void 0),So=h([P("esri.widgets.Sketch.SketchTooltipOptions.VisibleElements")],So);let Lg=class extends ye{constructor(e){super(e),this.enabled=!1,this.elevation=new f2,this.visibleElements=new So,this.visualVariables=null}toJSON(){return{enabled:this.enabled,elevation:this.elevation,visibleElements:this.visibleElements}}};h([p({type:Boolean,nonNullable:!0})],Lg.prototype,"enabled",void 0),h([p({type:f2,nonNullable:!0})],Lg.prototype,"elevation",void 0),h([p({type:So,nonNullable:!0})],Lg.prototype,"visibleElements",void 0),h([p()],Lg.prototype,"visualVariables",void 0),Lg=h([P("esri.widgets.Sketch.SketchTooltipOptions")],Lg);const efe=Lg;let pc=class extends ie{constructor(){super(...arguments),this.enabled=!0}};h([p({type:Boolean})],pc.prototype,"enabled",void 0),pc=h([P("esri.views.interactive.snapping.Settings.DefaultSnappingAlgorithm")],pc);let Pi=class extends ie{constructor(e){super(e),this.lineSnapper=new pc,this.parallelLineSnapper=new pc,this.rightAngleSnapper=new pc,this.rightAngleTriangleSnapper=new pc,this.shortLineThreshold=15,this.distance=5,this.pointThreshold=1e-6,this.intersectionParallelLineThreshold=1e-6,this.parallelLineThreshold=1e-6,this.verticalLineThreshold=.1,this.touchSensitivityMultiplier=1.5,this.pointOnLineThreshold=1e-6,this.orange=new ae([255,127,0]),this.orangeTransparent=new ae([255,127,0,.5]),this.lineHintWidthReference=3,this.lineHintWidthTarget=3,this.lineHintFadedExtensions=.3,this.parallelLineHintWidth=2,this.parallelLineHintLength=24,this.parallelLineHintOffset=1.5,this.rightAngleHintSize=24,this.rightAngleHintOutlineSize=1.5,this.satisfiesConstraintScreenThreshold=1}};h([p({type:pc,constructOnly:!0,nonNullable:!0,json:{write:!0}})],Pi.prototype,"lineSnapper",void 0),h([p({type:pc,constructOnly:!0,nonNullable:!0,json:{write:!0}})],Pi.prototype,"parallelLineSnapper",void 0),h([p({type:pc,constructOnly:!0,nonNullable:!0,json:{write:!0}})],Pi.prototype,"rightAngleSnapper",void 0),h([p({type:pc,constructOnly:!0,nonNullable:!0,json:{write:!0}})],Pi.prototype,"rightAngleTriangleSnapper",void 0),h([p({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],Pi.prototype,"shortLineThreshold",void 0),h([p({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],Pi.prototype,"distance",void 0),h([p({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],Pi.prototype,"pointThreshold",void 0),h([p({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],Pi.prototype,"intersectionParallelLineThreshold",void 0),h([p({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],Pi.prototype,"parallelLineThreshold",void 0),h([p({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],Pi.prototype,"verticalLineThreshold",void 0),h([p({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],Pi.prototype,"touchSensitivityMultiplier",void 0),h([p({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],Pi.prototype,"pointOnLineThreshold",void 0),h([p({type:ae,nonNullable:!0})],Pi.prototype,"orange",void 0),h([p({type:ae,nonNullable:!0})],Pi.prototype,"orangeTransparent",void 0),h([p({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],Pi.prototype,"lineHintWidthReference",void 0),h([p({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],Pi.prototype,"lineHintWidthTarget",void 0),h([p({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],Pi.prototype,"lineHintFadedExtensions",void 0),h([p({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],Pi.prototype,"parallelLineHintWidth",void 0),h([p({type:Number,nonNullable:!0,range:{min:0,max:50},json:{write:!0}})],Pi.prototype,"parallelLineHintLength",void 0),h([p({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],Pi.prototype,"parallelLineHintOffset",void 0),h([p({type:Number,nonNullable:!0,range:{min:0,max:46},json:{write:!0}})],Pi.prototype,"rightAngleHintSize",void 0),h([p({type:Number,nonNullable:!0,range:{min:0,max:6},json:{write:!0}})],Pi.prototype,"rightAngleHintOutlineSize",void 0),h([p({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],Pi.prototype,"satisfiesConstraintScreenThreshold",void 0),Pi=h([P("esri.views.interactive.snapping.Settings.Defaults")],Pi);const td=new Pi;var Fr;(function(t){t[t.FEATURE=1]="FEATURE",t[t.SELF=2]="SELF",t[t.ALL=3]="ALL"})(Fr||(Fr={}));let qyt=class{constructor(e,i,n){this.uid=e,this.geometry=i,this.attributes=n,this.visible=!0,this.objectId=null,this.centroid=null}};function Jyt(t){return t.geometry!=null}let Zyt=class{constructor(){this.exceededTransferLimit=!1,this.features=[],this.fields=[],this.hasM=!1,this.hasZ=!1,this.geometryType=null,this.objectIdFieldName=null,this.globalIdFieldName=null,this.geometryProperties=null,this.geohashFieldName=null,this.spatialReference=null,this.transform=null}};function My(t,e,i,n){return{x:t,y:e,z:i,hasZ:i!=null,hasM:!1,spatialReference:n,type:"point"}}function Xyt(t){if(t==null)return 0;switch(t.type){case"point":return 1;case"polyline":{let e=0;for(const i of t.paths)e+=i.length;return e}case"polygon":{let e=0;for(const i of t.rings)e+=i.length;return e}case"multipoint":return t.points.length;case"extent":return 2;case"mesh":{const e=t.vertexAttributes&&t.vertexAttributes.position;return e?e.length/3:0}default:return}}function Kyt(t,e){switch(WSe(e),t.type==="mesh"&&(t=t.extent),t.type){case"point":e[0]=e[3]=t.x,e[1]=e[4]=t.y,t.hasZ&&(e[2]=e[5]=t.z);break;case"polyline":for(let i=0;i<t.paths.length;i++)C3(e,t.paths[i],!!t.hasZ);break;case"polygon":for(let i=0;i<t.rings.length;i++)C3(e,t.rings[i],!!t.hasZ);break;case"multipoint":C3(e,t.points,!!t.hasZ);break;case"extent":e[0]=t.xmin,e[1]=t.ymin,e[3]=t.xmax,e[4]=t.ymax,t.zmin!=null&&(e[2]=t.zmin),t.zmax!=null&&(e[5]=t.zmax)}}function Qyt(t,e){switch(awe(e),t.type==="mesh"&&(t=t.extent),t.type){case"point":e[0]=e[2]=t.x,e[1]=e[3]=t.y;break;case"polyline":for(let i=0;i<t.paths.length;i++)f3(e,t.paths[i]);break;case"polygon":for(let i=0;i<t.rings.length;i++)f3(e,t.rings[i]);break;case"multipoint":f3(e,t.points);break;case"extent":e[0]=t.xmin,e[1]=t.ymin,e[2]=t.xmax,e[3]=t.ymax}}function e0t(t,e){return t.objectId!=null?t.objectId:t.attributes&&e?t.attributes[e]:null}function t0t(t){return t}function tfe(t){return ns(t)}function i0t(t,e,i){return Ln(t,e,i)}function ki(t,e,i){return t==null?null:bx(i.coordinateHelper.vectorToDehydratedPoint(t,iXe),e,i)}function bx(t,e,i){if(t==null)return null;if(e==null)return Ln(t.x,t.y,t.z??0);if(e.type==="2d")return Ln(t.x,t.y,0);const{elevationInfo:n}=i,r=_We(e,t,n,Rn)??0;return Ln(t.x,t.y,r)}function NZ(t,e,{z:i,m:n,spatialReference:r,elevationInfo:s}){if(i==null&&n==null){const l=My(t[0],t[1],void 0,r);return n!=null&&(l.m=n,l.hasM=!0),l}if(e==null||e.type==="2d"){const l=My(t[0],t[1],i,r);return n!=null&&(l.m=n,l.hasM=!0),l}const o=jde(e,t,r,Rn,s)??0,a=My(t[0],t[1],o,r);return n!=null&&(a.m=n,a.hasM=!0),a}function n0t(t,e){return My(t[0],t[1],t[2],e)}const iXe=My(0,0,0,null);function EL(t,e){return t[0]*e[1]-t[1]*e[0]}function nXe(t,e,i){const n=Kf(i,e)/zf(i);return Jb(t,i,n)}function AL(t,e,i,n,r=i){return er(q_,n,i),er(tz,e,r),nXe(A$,tz,q_),$V(t,r,A$)}function rXe(t,e,i,n){er(q_,e,i);const r=n/hb(q_);return Wh(t,i,q_,r)}function r0t(t,e){const i=t.start,n=t.end,r=e.start,s=e.end,o=er(q_,n,i),a=er(oXe,s,r),l=EL(o,a);if(Math.abs(l)<=sXe)return[];const c=er(tz,i,r),u=EL(a,c)/l,d=EL(o,c)/l;if(u>=0){if(d>=0||e.type===tr.LINE)return[Wh(A$,i,o,u)]}else if(t.type===tr.LINE&&(d>=0||e.type===tr.LINE))return[Wh(A$,i,o,u)];return[]}var tr;(function(t){t[t.RAY=0]="RAY",t[t.LINE=1]="LINE"})(tr||(tr={}));const sXe=1e-6,q_=kt(),oXe=kt(),tz=kt(),A$=kt();function iz({start:t,end:e,type:i},n,r){const s=[],o=er(f0,e,t),a=er(r1,t,n),l=zf(o),c=2*Kf(o,a),u=c*c-4*l*(zf(a)-r*r);if(u===0){const d=-c/(2*l);(i===bc.PLANE||d>=0)&&s.push(Wh(kt(),t,o,d))}else if(u>0){const d=Math.sqrt(u),f=(-c+d)/(2*l);(i===bc.PLANE||f>=0)&&s.push(Wh(kt(),t,o,f));const m=(-c-d)/(2*l);(i===bc.PLANE||m>=0)&&s.push(Wh(kt(),t,o,m))}return s}function nz(t,e){const i=t.start,n=t.end,r=er(f0,n,i),s=Di(r1,-r[1],r[0],0),o=e.start,a=e.end,l=fa(aB,a,o),c=yt(l,s),u=Di(sfe,i[0],i[1],0),d=fa(ofe,u,o),f=yt(d,s);if(Math.abs(c)<fc)return[];const m=Tf(afe,o,l,f/c);if(e.type===tr.RAY){const g=fa(P$,m,o);if(yt(g,l)<-fc)return[]}if(t.type===bc.HALF_PLANE){const g=OP(P$,m,i);if(Kf(g,r)<-fc)return[]}return[ns(m)]}function rz(t,e){return sz($$(lB,e[2],t),e)}function ife(t,e){const n=rfe($$(lB,0,t),$$(cXe,0,e)),r=[];for(const s of n)r.push(Vre(s));return r}function nfe(t,e){return oB(t,$$(lB,t[2],e))}function aXe(t,e,i){const n=er(f0,t,e),r=i/hb(n),s=Wh(Me(),e,n,r);return s[2]=t[2],s}function oB(t,{start:e,end:i,type:n}){const r=fa(f0,t,e),s=fa(r1,i,e),o=yt(r,s)/yt(s,s);return Tf(Me(),e,s,n===tr.RAY?Math.max(o,0):o)}function FZ({start:t,end:e,type:i},n,r){const s=[],o=Ii(f0,e,t),a=er(r1,t,n),l=zf(o),c=2*Kf(o,a),u=c*c-4*l*(zf(a)-r*r);if(u===0){const d=-c/(2*l);(i===tr.LINE||d>=0)&&s.push(Tf(Me(),t,o,d))}else if(u>0){const d=Math.sqrt(u),f=(-c+d)/(2*l);(i===tr.LINE||f>=0)&&s.push(Tf(Me(),t,o,f));const m=(-c-d)/(2*l);(i===tr.LINE||m>=0)&&s.push(Tf(Me(),t,o,m))}return s}function rfe(t,e){const i=t.start,n=t.end,r=e.start,s=e.end,o=fa(f0,n,i),a=fa(r1,s,r),l=fa(aB,r,i),c=io(sfe,o,a),u=yt(l,c);if(!A_(u,0,fc))return[];const d=eA(c);if(A_(d,0,fc))return[];const f=io(ofe,l,a),m=yt(f,c)/d,g=Tf(afe,i,o,m);if(t.type===tr.RAY){const y=fa(P$,g,i);if(yt(o,y)<-fc)return[]}if(e.type===tr.RAY){const y=fa(P$,g,r);if(yt(a,y)<-fc)return[]}return[ns(g)]}function sz({start:t,end:e,type:i},n){const r=fa(f0,n,t),s=fa(r1,e,t),o=io(aB,s,r);if(eA(o)/eA(s)<fc)switch(i){case tr.LINE:return[ns(n)];case tr.RAY:return yt(s,r)<-fc?[]:[ns(n)]}return[]}function zZ(t,e,i){return A_(Ec(i,t),e*e,fc)?[ns(i)]:[]}function $$(t,e,{start:i,end:n,type:r}){return Di(t.start,i[0],i[1],e),Di(t.end,n[0],n[1],e),t.type=lXe[r],t}var bc;(function(t){t[t.PLANE=0]="PLANE",t[t.HALF_PLANE=1]="HALF_PLANE"})(bc||(bc={}));const lXe={[bc.PLANE]:tr.LINE,[bc.HALF_PLANE]:tr.RAY},fc=1e-6,f0=Me(),r1=Me(),aB=Me(),sfe=Me(),ofe=Me(),afe=Me(),P$=Me(),lB={start:Me(),end:Me(),type:tr.LINE},cXe={start:Me(),end:Me(),type:tr.LINE};let m0=class{intersect(e){return pXe(this,e)}},uXe=class extends m0{constructor(e){super(),this.point=e}equals(e){return b_(e)&&Li(this.point,e.point)}closestTo(){return tfe(this.point)}},lfe=class extends m0{constructor(e,i,n){super(),this.start=e,this.end=i,this.type=n,this.lineLike={start:this.start,end:this.end,type:this.type}}equals(e){return ey(e)&&this.type===e.type&&Li(this.start,e.start)&&Li(this.end,e.end)}closestTo(e){const i=oB(e,this.lineLike);return i}},hXe=class extends lfe{constructor(e,i){super(e,i,tr.LINE)}},cfe=class ufe extends m0{constructor(e,i,n){super(),this.intersection=e,this.first=i,this.second=n}equals(e){return e instanceof ufe&&this.first.equals(e.first)&&this.second.equals(e.second)}closestTo(){return tfe(this.intersection)}},$L=class hfe extends m0{constructor(e,i,n){super(),this.basePoint=e,this.first=i,this.second=n}equals(e){return e instanceof hfe&&this.first.equals(e.first)&&this.second.equals(e.second)}closestTo(e){const i=this.basePoint;return Ln(i[0],i[1],e[2])}},dfe=class extends m0{constructor(e,i){super(),this.center=e,this.radius=i}equals(e){return w_(e)&&this.center[0]===e.center[0]&&this.center[1]===e.center[1]&&this.radius===e.radius}closestTo(e){const i=aXe(e,this.center,this.radius);return i}},cB=class extends m0{constructor(e,i,n){super(),this.start=e,this.end=i,this.type=n,this.planeLike={start:e,end:i,type:n}}equals(e){return ty(e)&&this.type===e.type&&Li(this.start,e.start)&&Li(this.end,e.end)}closestTo(e){return nfe(e,this.planeLike)}closestEndTo(e){const{start:i,end:n}=this;return Math.sign(Kf(er(mXe,n,i),er(gXe,e,i)))>0?n:i}},pfe=class extends cB{constructor(e,i){super(e,i,bc.HALF_PLANE)}},ffe=class extends cB{constructor(e,i){super(e,i,bc.PLANE)}},mfe=class extends m0{constructor(e,i,n){super(),this.start=e,this.end=i,this.getZ=n,this.planeLike={start:e,end:i,type:bc.PLANE}}equals(e){return iy(e)&&Li(this.start,e.start)&&Li(this.end,e.end)&&this.getZ===e.getZ}closestTo(e){return dXe(this,e)}addIfOnTheGround(e,i){for(const n of i){const r=this.getZ(n[0],n[1],n[2])??0;Math.abs(n[2]-r)<fc&&(n[2]=r,e.push(n))}}};function dXe(t,e){const i=nfe(e,t.planeLike);return i[2]=t.getZ(e[0],e[1],e[2])??gfe,i}function pXe(t,e){let i=[];if(b_(t)){const{point:n}=t;ey(e)?i=sz(e.lineLike,n):w_(e)?i=zZ(e.center,e.radius,n):ty(e)?i=rz(e.planeLike,n):iy(e)&&(i=Y1(e,t))}else if(ey(t)){const{lineLike:n}=t;b_(e)?i=sz(n,e.point):ey(e)?i=rfe(n,e.lineLike):w_(e)?i=FZ(n,e.center,e.radius):ty(e)?i=nz(e.planeLike,n):iy(e)&&(i=Y1(e,t))}else if(w_(t)){const{center:n,radius:r}=t;if(ey(e))i=FZ(e.lineLike,n,r);else if(b_(e))i=zZ(n,r,e.point);else{if(ty(e))return iz(e.planeLike,n,r).map(s=>new $L(s,t,e));iy(e)&&(i=Y1(e,t))}}else if(ty(t)){const{planeLike:n}=t;if(ty(e))return ife(n,e.planeLike).map(r=>new $L(r,t,e));if(b_(e))i=rz(n,e.point);else if(ey(e))i=nz(n,e.lineLike);else{if(w_(e))return iz(n,e.center,e.radius).map(r=>new $L(r,t,e));iy(e)&&(i=Y1(e,t))}}else iy(t)&&(i=Y1(t,e));return fXe(i,t,e)}function Y1(t,e){const{planeLike:i,getZ:n}=t,r=[];if(b_(e))t.addIfOnTheGround(r,rz(i,e.point));else if(ey(e))t.addIfOnTheGround(r,nz(i,e.lineLike));else if(w_(e))for(const[s,o]of iz(i,e.center,e.radius)){const a=n(s,o,0);a!=null&&r.push(Ln(s,o,a))}else if(ty(e)||iy(e))for(const[s,o]of ife(i,e.planeLike)){const a=n(s,o,0)??gfe;r.push(Ln(s,o,a))}return r}function fXe(t,e,i){return t.map(n=>new cfe(n,e,i))}function b_(t){return t instanceof uXe}function ey(t){return t instanceof lfe}function w_(t){return t instanceof dfe}function ty(t){return t instanceof cB}function iy(t){return t instanceof mfe}const mXe=kt(),gXe=kt(),gfe=0;function g0(t,e){const i=t.x-e.x,n=t.y-e.y;return i*i+n*n}function yXe(t,e){return Math.sqrt(g0(t,e))}function uB(t,e){e.sort((i,n)=>od(i.targetPoint,t)-od(n.targetPoint,t))}var bl;function f0t({point:t,distance:e,returnEdge:i,returnVertex:n,coordinateHelper:{spatialReference:r}},s,o){return{point:My(t[0],t[1],t[2],r.toJSON()),mode:s,distance:e,returnEdge:i,returnVertex:n,query:o!=null?o.toJSON():{where:"1=1"}}}function k$(t,e,i){return{left:ki(t.leftVertex.pos,e,i),right:ki(t.rightVertex.pos,e,i)}}function m0t(t){return t.createQuery()}function vXe(t,e=()=>{}){const i=Q(()=>({view:t.view,snappingOptions:t.snappingOptions}),({view:n,snappingOptions:r})=>{const s="snapping-toggle",o=gi.TOOL;if(t.removeHandles(s),n&&r!=null){const a=[n.on("key-down",l=>{l.key!==DZ.toggle||l.repeat||(r.enabledToggled=!0,e())},o),n.on("key-up",l=>{l.key===DZ.toggle&&(r.enabledToggled=!1,e())},o),n.on("pointer-move",l=>{const c=l.native.ctrlKey;r.enabledToggled!==c&&(r.enabledToggled=c,e())},o)];t.addHandles(a,s)}},Oi);t.addHandles(i)}(function(t){t[t.TARGET=0]="TARGET",t[t.REFERENCE=1]="REFERENCE",t[t.REFERENCE_EXTENSION=2]="REFERENCE_EXTENSION"})(bl||(bl={}));let s1=class{constructor(e,i,n,r){this.targetPoint=e,this.constraint=i,this.isDraped=n,this.domain=r}},hB=class extends s1{constructor({targetPoint:e,objectId:i,constraint:n,isDraped:r}){super(e,n,r,Fr.FEATURE),this.objectId=i}},$k=class{constructor(e,i){this.isDraped=e,this.domain=i}},zu=class yfe extends $k{constructor(e,i,n,r,s=Fr.ALL,o=!0,a=!0){super(r,s),this.type=e,this.lineStart=i,this.lineEnd=n,this.fadeLeft=o,this.fadeRight=a}equals(e){return e instanceof yfe&&this.type===e.type&&Li(this.lineStart,e.lineStart)&&Li(this.lineEnd,e.lineEnd)&&this.fadeLeft===e.fadeLeft&&this.fadeRight===e.fadeRight}get length(){return Rb(this.lineStart,this.lineEnd)}},_Xe=class extends hB{constructor(e){super({...e,isDraped:!0,constraint:new mfe(e.edgeStart,e.edgeEnd,e.getGroundElevation)})}get hints(){return[new zu(bl.REFERENCE,this.constraint.start,this.constraint.end,this.isDraped,this.domain)]}},bXe=class extends hB{constructor(e){super({...e,constraint:new hXe(e.edgeStart,e.edgeEnd)})}get hints(){return[new zu(bl.REFERENCE,this.constraint.start,this.constraint.end,this.isDraped,this.domain)]}},vfe=class _fe extends $k{constructor(e,i,n,r,s=Fr.ALL){super(r,s),this.previousVertex=e,this.centerVertex=i,this.nextVertex=n}equals(e){return e instanceof _fe&&Li(this.previousVertex,e.previousVertex)&&Li(this.centerVertex,e.centerVertex)&&Li(this.nextVertex,e.nextVertex)}},bfe=class extends s1{constructor({targetPoint:e,constraint:i,previousVertex:n,otherVertex:r,otherVertexType:s,objectId:o,isDraped:a}){super(e,i,a,Fr.SELF),this.previousVertex=n,this.otherVertex=r,this.otherVertexType=s,this.objectId=o}get hints(){const e=this.previousVertex,i=this.otherVertexType===Mb.CENTER?this.otherVertex:this.targetPoint,n=this.otherVertexType===Mb.CENTER?this.targetPoint:this.otherVertex;return[new zu(bl.TARGET,i,n,this.isDraped,this.domain),new zu(bl.REFERENCE,e,i,this.isDraped,this.domain),new vfe(this.previousVertex,i,n,this.isDraped,this.domain)]}};var Mb;(function(t){t[t.NEXT=0]="NEXT",t[t.CENTER=1]="CENTER"})(Mb||(Mb={}));function wXe(t,e,i,n,r=Me()){const s=ri(oz,t);return s[2]=jde(n,s,e,i)||0,n.renderCoordsHelper.toRenderCoords(s,e,r),r}function Ls(t,e,i,n){return n.type==="2d"?(_C.x=t[0],_C.y=t[1],_C.spatialReference=e,n.toScreen(_C)):(wXe(t,e,i,n,oz),n.state.camera.projectToScreen(oz,PL),As(PL[0],PL[1]))}const _C=My(0,0,0,null),oz=Me(),PL=ASe();let Dp=class extends lb{get updating(){return OS(this.snappingSources,({snappingSource:e})=>e.updating)||this.updatingHandles.updating}get snappingSources(){const e=this._get("snappingSources")||new Map,i=new Map;if(this.options!=null&&this.options.featureSources!=null)for(const n of this.options.featureSources.items){const r=n.layer.uid,s=e.get(r);if(s){e.delete(r),i.set(r,s);continue}if(!n.layer.loaded){this.updatingHandles.addPromise(n.layer.load());continue}const o=this._createSourceInfo(n);o!=null&&i.set(r,o)}for(const[,n]of e)n.destroy();return i}constructor(e){super(e),this.options=null,this._domain=Fr.FEATURE,this._sourceModules={featureService:{module:null,loader:null},featureCollection:{module:null,loader:null},graphics:{module:null,loader:null},notes:{module:null,loader:null},scene:{module:null,loader:null}}}initialize(){this.updatingHandles.add(()=>this.snappingSources,()=>this.notifyChange("updating"),ml),this.view!=null&&this.handles.add([this.view.on("layerview-create",e=>this._updateLayerView(e.layer,e.layerView)),this.view.on("layerview-destroy",e=>this._updateLayerView(e.layer,null))])}_updateLayerView(e,i){for(const[,n]of this.snappingSources)n.snappingSource.layerSource.layer===e&&(n.layerView=i)}destroy(){this._set("options",null);for(const[,e]of this.snappingSources)e.destroy()}async fetchCandidates(e,i,n,r){var c;if(!(i&this._domain&&this.options!=null&&this.options.effectiveFeatureEnabled))return[];const s=[],o=this._computeScreenSizeDistanceParameters(e,n),a={distance:o,mode:((c=this.view)==null?void 0:c.type)??"2d",point:e,coordinateHelper:n.coordinateHelper,...this._types};for(const[,{snappingSource:u,layerView:d}]of this.snappingSources)!u.layerSource.enabled||d!=null&&d.suspended||s.push(u.fetchCandidates(a,r).then(f=>f.filter(m=>!this._candidateIsExcluded(u,m,n.excludeFeature))));const l=(await TK(s)).flat();return this._addRightAngleCandidates(l,e,o,n),Vt(r),uB(e,l),l}_addRightAngleCandidates(e,i,n,r){var d,f,m,g,y,_,b,w;const s=r.vertexHandle!=null?(f=(d=r.vertexHandle.rightEdge)==null?void 0:d.rightVertex)==null?void 0:f.pos:r.editGeometryOperations!=null&&r.editGeometryOperations.data.type==="polygon"?(g=(m=r.editGeometryOperations.data.components[0])==null?void 0:m.getFirstVertex())==null?void 0:g.pos:null,o=r.vertexHandle!=null?(_=(y=r.vertexHandle.leftEdge)==null?void 0:y.leftVertex)==null?void 0:_.pos:r.editGeometryOperations!=null?(w=(b=r.editGeometryOperations.data.components[0])==null?void 0:b.getLastVertex())==null?void 0:w.pos:null,{view:a}=this,l=ki(s,a,r),c=ki(o,a,r),u=e.length;for(let x=0;x<u;x++)this._addRightAngleCandidate(e[x],c,i,n,e),this._addRightAngleCandidate(e[x],l,i,n,e)}_addRightAngleCandidate(e,i,n,r,s){if(i==null||!SXe(e))return;const o=e.constraint.closestTo(i),a=(o[0]-n[0])/r.x,l=(o[1]-n[1])/r.y,{start:c,end:u}=e.constraint;if(a*a+l*l<=1){const d=new bfe({targetPoint:o,otherVertex:i,otherVertexType:Mb.NEXT,previousVertex:Ec(o,c)>Ec(o,u)?c:u,constraint:new pfe(i,o),objectId:e.objectId,isDraped:e.isDraped});s.push(d)}}_computeScreenSizeDistanceParameters(e,i){let n=this.options!=null?this.options.distance*(i.pointer==="touch"?this.options.touchSensitivityMultiplier:1):0;return this.view==null?{x:n,y:n,z:n,distance:n}:this.view.type==="2d"?(n*=this.view.resolution,{x:n,y:n,z:n,distance:n}):this._computeScreenSizeDistanceParameters3D(e,n,this.view,i)}_computeScreenSizeDistanceParameters3D(e,i,n,r){const{spatialReference:s}=r;n.renderCoordsHelper.toRenderCoords(e,s,VZ);const o=n.state.camera.computeScreenPixelSizeAt(VZ),a=o*n.renderCoordsHelper.unitInMeters/n.mapCoordsHelper.unitInMeters,l=i*a,c=Ls(e,s,Rn,n),u=c?kL(c,e,a,0,0,n,r):0,d=c?kL(c,e,0,a,0,n,r):0,f=c?kL(c,e,0,0,a,n,r):0;return{x:u===0?0:l/u,y:d===0?0:l/d,z:f===0?0:l/f,distance:o*i}}get _types(){return{returnEdge:!0,returnVertex:!0}}_candidateIsExcluded(e,i,n){if(n==null)return!1;const r=this._getCandidateObjectId(i);if(r==null)return!1;const s=e.layerSource.layer;return s.type==="graphics"?n.uid===r:n.sourceLayer===s&&!(!n.attributes||!("objectIdField"in s))&&n.attributes[s.objectIdField]===r}_getCandidateObjectId(e){return e instanceof hB?e.objectId:null}_createSourceInfo(e){const i=this._createFeatureSnappingSourceType(e);if(i==null)return null;if("loading"in i)return this.updatingHandles.addPromise(i.loading.then(()=>{this.destroyed||this.notifyChange("snappingSources")})),null;const n=this.view!=null?this.view.allLayerViews.find(r=>r.layer===e.layer):null;return new xXe(i.source,n)}_createFeatureSnappingSourceType(e){switch(e.layer.type){case"feature":case"geojson":case"csv":case"oriented-imagery":case"subtype-group":case"wfs":return this._createFeatureSnappingSourceFeatureLayer(e);case"graphics":return this._createFeatureSnappingSourceGraphicsLayer(e);case"map-notes":return this._createFeatureSnappingSourceMapNotesLayer(e);case"scene":case"building-scene":return this._createFeatureSnappingSourceSceneLayer(e)}return null}_createFeatureSnappingSourceSceneLayer(e){const{view:i}=this;if(i==null||i.type!=="3d")return null;const n=this._getSourceModule("scene");return n.module!=null?{source:new n.module.SceneLayerSnappingSource({layerSource:e,view:i})}:{loading:n.loader}}_createFeatureSnappingSourceFeatureLayer(e){var i;switch((i=e.layer.source)==null?void 0:i.type){case"feature-layer":case"oriented-imagery":{const n=this._getSourceModule("featureService");return n.module!=null?{source:new n.module.FeatureServiceSnappingSource({spatialReference:this.spatialReference,view:this.view,layerSource:e})}:{loading:n.loader}}case"memory":case"csv":case"geojson":case"wfs":{if(e.layer.geometryType==="mesh")return null;const n=this._getSourceModule("featureCollection");return n.module!=null?{source:new n.module.FeatureCollectionSnappingSource({layerSource:e,view:this.view})}:{loading:n.loader}}}return null}_createFeatureSnappingSourceGraphicsLayer(e){const i=this._getSourceModule("graphics");return i.module!=null?{source:new i.module.GraphicsSnappingSource({getGraphicsLayers:()=>[e.layer],spatialReference:this.spatialReference,view:this.view,layerSource:e})}:{loading:i.loader}}_createFeatureSnappingSourceMapNotesLayer(e){const i=this._getSourceModule("notes");return i.module!=null?{source:new i.module.GraphicsSnappingSource({getGraphicsLayers:()=>e.layer.sublayers!=null?e.layer.sublayers.toArray():[],spatialReference:this.spatialReference,view:this.view,layerSource:e})}:{loading:i.loader}}_getSourceModule(e){const i=this._sourceModules[e];if(i.loader==null){const n=this._loadSourceModule(e).then(r=>{i.module=r});return i.loader=n,{module:i.module,loader:n}}return{module:i.module,loader:i.loader}}_loadSourceModule(e){const i=this.updatingHandles;switch(e){case"featureService":return i.addPromise(Y(()=>import("./FeatureServiceSnappingSource-9f3ebd05.js"),["./FeatureServiceSnappingSource-9f3ebd05.js","./queryEngineUtils-f46f3aca.js","./VertexSnappingCandidate-46a2a507.js","./PointSnappingHint-713a7d52.js","./WorkerHandle-6635cad1.js"],import.meta.url));case"featureCollection":return i.addPromise(Y(()=>import("./FeatureCollectionSnappingSource-944d7f86.js"),["./FeatureCollectionSnappingSource-944d7f86.js","./queryEngineUtils-f46f3aca.js","./VertexSnappingCandidate-46a2a507.js","./PointSnappingHint-713a7d52.js","./symbologySnappingCandidates-d66217cb.js"],import.meta.url));case"graphics":case"notes":return i.addPromise(Y(()=>import("./GraphicsSnappingSource-8894b89f.js"),["./GraphicsSnappingSource-8894b89f.js","./normalizeUtilsSync-da20ec22.js","./featureConversionUtils-7f0dd1f5.js","./OptimizedFeature-4701473b.js","./OptimizedFeatureSet-1d1ac4b9.js","./OptimizedGeometry-196224d4.js","./FeatureStore-0f5f076d.js","./BoundsStore-8f9a5e7d.js","./PooledRBush-c3f6d07d.js","./optimizedFeatureQueryEngineAdapter-2fa61fa1.js","./centroid-8e8cfa47.js","./timeSupport-e85aa784.js","./projectionSupport-7e11e91a.js","./json-48e3ea08.js","./QueryEngine-19cea4e7.js","./WhereClause-831210c9.js","./executionError-c92d3b85.js","./quantizationUtils-4d6bfb95.js","./utils-785aae67.js","./SnappingCandidate-970faec6.js","./queryEngineUtils-f46f3aca.js","./VertexSnappingCandidate-46a2a507.js","./PointSnappingHint-713a7d52.js","./symbologySnappingCandidates-d66217cb.js"],import.meta.url));case"scene":return i.addPromise(Y(()=>import("./SceneLayerSnappingSource-0eff7445.js"),["./SceneLayerSnappingSource-0eff7445.js","./WorkerHandle-6635cad1.js","./workerHelper-9db2734a.js","./InterleavedLayout-9fc0b7c6.js","./BufferView-3be96e15.js","./types-1305598a.js","./edgeProcessing-fd058889.js","./deduplicate-c994028e.js","./Indices-ee76e634.js","./glUtil-0b7ee6ea.js","./enums-b14466b3.js","./VertexElementDescriptor-2925c6af.js","./VertexSnappingCandidate-46a2a507.js","./PointSnappingHint-713a7d52.js"],import.meta.url))}}};h([p({constructOnly:!0})],Dp.prototype,"spatialReference",void 0),h([p({constructOnly:!0})],Dp.prototype,"view",void 0),h([p()],Dp.prototype,"options",void 0),h([p({readOnly:!0})],Dp.prototype,"updating",null),h([p({readOnly:!0})],Dp.prototype,"snappingSources",null),Dp=h([P("esri.views.interactive.snapping.FeatureSnappingEngine")],Dp);let xXe=class{constructor(e,i){this.snappingSource=e,this.layerView=i,this.handles=new Rs;const n=this.snappingSource.layerSource.layer;if("refresh"in n){const r=n;this.handles.add(r.on("refresh",()=>e.refresh()))}this.handles.add([Q(()=>e.updating,r=>e.layerSource.updating=r,Oi),Q(()=>e.availability,r=>e.layerSource.availability=r,Oi)])}destroy(){this.snappingSource.destroy(),this.handles.destroy()}};function SXe(t){return(t instanceof bXe||t instanceof _Xe)&&!TXe(t)}function TXe({constraint:{start:t,end:e}}){const i=od(t,e),n=Ec(t,e);return i<so()||n/i<CXe}function kL(t,e,i,n,r,s,{spatialReference:o}){const a=ri(IXe,e);a[0]+=i,a[1]+=n,a[2]+=r;const l=Ls(a,o,Rn,s);return l?yXe(l,t):1/0}const VZ=Me(),IXe=Me(),CXe=1e-4;let Pk=class{constructor(e,i){this.view=e,this.options=i,this.squaredShortLineThreshold=td.shortLineThreshold*td.shortLineThreshold}snap(e,i){return i.vertexHandle!=null?i.vertexHandle.type!=="vertex"?[]:this.snapExistingVertex(e,i):this.snapNewVertex(e,i)}edgeExceedsShortLineThreshold(e,i){return this.exceedsShortLineThreshold(ki(e.leftVertex.pos,this.view,i),ki(e.rightVertex.pos,this.view,i),i)}exceedsShortLineThreshold(e,i,{spatialReference:n}){return this.squaredShortLineThreshold===0||g0(Ls(i,n,Rn,this.view),Ls(e,n,Rn,this.view))>this.squaredShortLineThreshold}isVertical(e,i){return Ec(e,i)<td.verticalLineThreshold}squaredProximityThreshold(e){return e==="touch"?this._squaredTouchProximityThreshold:this._squaredMouseProximityThreshold}get _squaredMouseProximityThreshold(){return this.options.distance*this.options.distance}get _squaredTouchProximityThreshold(){const{distance:e,touchSensitivityMultiplier:i}=this.options,n=e*i;return n*n}},MXe=class extends s1{constructor({lineStart:e,lineEnd:i,targetPoint:n,isDraped:r}){super(n,new ffe(e,i),r,Fr.SELF),this._referenceLineHint=new zu(bl.REFERENCE_EXTENSION,e,i,r,this.domain)}get hints(){return[this._referenceLineHint,new zu(bl.TARGET,this._lineEndClosestToTarget(),this.targetPoint,this.isDraped,this.domain)]}_lineEndClosestToTarget(){return this.constraint.closestEndTo(this.targetPoint)}},EXe=class extends Pk{snapNewVertex(e,i){const n=i.editGeometryOperations.data.components[0],r=n.edges.length,s=[];if(r<1)return s;const{spatialReference:o}=i,a=Ls(e,o,Rn,this.view),{view:l}=this,c=n.edges[r-1];let u=c;do{if(this.edgeExceedsShortLineThreshold(u,i)){const d=k$(u,l,i);this._processCandidateProposal(d.left,d.right,e,a,i,s)}u=u.leftVertex.leftEdge}while(u&&u!==c);return s}snapExistingVertex(e,i){const n=[],r=i.vertexHandle,s=r.component;if(s.edges.length<2)return n;const{view:o}=this,{spatialReference:a}=i,l=Ls(e,a,Rn,o),c=r.leftEdge,u=r.rightEdge;c&&u&&this.edgeExceedsShortLineThreshold(c,i)&&this.edgeExceedsShortLineThreshold(u,i)&&this._processCandidateProposal(ki(c.leftVertex.pos,o,i),ki(u.rightVertex.pos,o,i),e,l,i,n);const d=s.edges[0];let f=d;do{if(f!==r.leftEdge&&f!==r.rightEdge&&this.edgeExceedsShortLineThreshold(f,i)){const m=k$(f,o,i);this._processCandidateProposal(m.left,m.right,e,l,i,n)}f=f.rightVertex.rightEdge}while(f&&f!==d);return n}_processCandidateProposal(e,i,n,r,s,o){var u;const{spatialReference:a,pointer:l}=s,c=oB(n,{start:e,end:i,type:tr.LINE});g0(r,Ls(c,a,Rn,this.view))<this.squaredProximityThreshold(l)&&o.push(new MXe({lineStart:e,lineEnd:i,targetPoint:c,isDraped:((u=s.elevationInfo)==null?void 0:u.mode)==="on-the-ground"}))}},AXe=class wfe extends $k{constructor(e,i,n,r=Fr.ALL){super(n,r),this.lineStart=e,this.lineEnd=i}equals(e){return e instanceof wfe&&Li(this.lineStart,e.lineStart)&&Li(this.lineEnd,e.lineEnd)}},$Xe=class extends s1{constructor({referenceLine:e,lineStart:i,targetPoint:n,isDraped:r}){const s=ns(i),{left:o,right:a}=e;Ii(s,sn(s,s,a),o),super(n,new ffe(i,s),r,Fr.SELF),this._referenceLines=[{edge:e,fadeLeft:!0,fadeRight:!0}]}get hints(){return[new zu(bl.TARGET,this.constraint.start,this.targetPoint,this.isDraped,this.domain),new AXe(this.constraint.start,this.targetPoint,this.isDraped,this.domain),...this._referenceLines.map(e=>new zu(bl.REFERENCE,e.edge.left,e.edge.right,this.isDraped,this.domain,e.fadeLeft,e.fadeRight))]}addReferenceLine(e){const i={edge:e,fadeLeft:!0,fadeRight:!0};this._referenceLines.forEach(n=>{Li(e.right,n.edge.left)&&(n.fadeLeft=!1,i.fadeRight=!1),Li(e.right,n.edge.right)&&(n.fadeRight=!1,i.fadeRight=!1),Li(e.left,n.edge.right)&&(n.fadeRight=!1,i.fadeLeft=!1),Li(e.left,n.edge.left)&&(n.fadeLeft=!1,i.fadeLeft=!1)}),this._referenceLines.push(i)}},PXe=class extends Pk{snapNewVertex(e,i){const n=i.editGeometryOperations.data.components[0],r=n.edges.length,s=n.vertices.length,o=[];if(r<2)return o;const{view:a}=this,l=Ls(e,i.spatialReference,Rn,a),c=ki(n.vertices[s-1].pos,a,i),u=ki(n.vertices[0].pos,a,i),d=n.edges[r-1];let f=d;do{if(this.edgeExceedsShortLineThreshold(f,i)){const m=k$(f,a,i);this._checkEdgeForParallelLines(m,c,e,l,i,o),this._checkEdgeForParallelLines(m,u,e,l,i,o)}f=f.leftVertex.leftEdge}while(f&&f!==d);return o}snapExistingVertex(e,i){const n=[],r=i.vertexHandle,s=r.component;if(s.edges.length<3)return n;const{view:o}=this,a=Ls(e,i.spatialReference,Rn,o),l=r.leftEdge,c=r.rightEdge,u=s.vertices[0],d=ki(u.pos,o,i),f=s.vertices.length,m=s.vertices[f-1],g=ki(m.pos,o,i),y=s.edges[0];let _=y;do{if(_!==l&&_!==c&&this.edgeExceedsShortLineThreshold(_,i)){const b=k$(_,o,i);l&&this._checkEdgeForParallelLines(b,ki(l.leftVertex.pos,o,i),e,a,i,n),c&&this._checkEdgeForParallelLines(b,ki(c.rightVertex.pos,o,i),e,a,i,n),r===u?this._checkEdgeForParallelLines(b,g,e,a,i,n):r===m&&this._checkEdgeForParallelLines(b,d,e,a,i,n)}_=_.rightVertex.rightEdge}while(_&&_!==y);return n}_checkEdgeForParallelLines(e,i,n,r,s,o){var f;const a=e.left,l=e.right;if(AL(Im,i,a,l),Ec(Im,i)<td.parallelLineThreshold)return;AL(Im,n,a,l,i);const{spatialReference:c,pointer:u}=s,d=Ln(Im[0],Im[1],n[2]);if(g0(r,Ls(d,c,Rn,this.view))<this.squaredProximityThreshold(u)){if(this.isVertical(d,i)||this.isVertical(a,l)||this._parallelToPreviousCandidate(e,o))return;o.push(new $Xe({referenceLine:e,lineStart:i,targetPoint:d,isDraped:((f=s.elevationInfo)==null?void 0:f.mode)==="on-the-ground"}))}}_parallelToPreviousCandidate(e,i){const n=e.left,r=e.right;for(const s of i)if(AL(Im,r,s.constraint.start,s.constraint.end,n),Ec(Im,r)<td.parallelLineThreshold)return s.addReferenceLine(e),!0;return!1}};const Im=kt();let kXe=class extends Pk{snapNewVertex(e,i){const n=i.editGeometryOperations.data.components[0],r=n.vertices.length,s=[];if(r<2)return s;const{view:o}=this,a=Ls(e,i.spatialReference,Rn,o),l=n.vertices[r-1];if(this.edgeExceedsShortLineThreshold(l.leftEdge,i)){const u=ki(l.pos,o,i),d=ki(l.leftEdge.leftVertex.pos,o,i);this._checkForSnappingCandidate(s,d,u,e,a,i)}const c=n.vertices[0];if(this.edgeExceedsShortLineThreshold(c.rightEdge,i)){const u=ki(c.pos,o,i),d=ki(c.rightEdge.rightVertex.pos,o,i);this._checkForSnappingCandidate(s,d,u,e,a,i)}return s}snapExistingVertex(e,i){const n=[],r=i.vertexHandle;if(r.component.vertices.length<3)return n;const{view:s}=this,o=Ls(e,i.spatialReference,Rn,s),a=r.leftEdge,l=r.rightEdge;if(a&&a.leftVertex.leftEdge){const c=a.leftVertex.leftEdge;if(this.edgeExceedsShortLineThreshold(c,i)){const u=ki(c.rightVertex.pos,s,i),d=ki(c.leftVertex.pos,s,i);this._checkForSnappingCandidate(n,d,u,e,o,i)}}if(l&&l.rightVertex.rightEdge){const c=l.rightVertex.rightEdge;if(this.edgeExceedsShortLineThreshold(c,i)){const u=ki(c.leftVertex.pos,s,i),d=ki(c.rightVertex.pos,s,i);this._checkForSnappingCandidate(n,d,u,e,o,i)}}return n}_checkForSnappingCandidate(e,i,n,r,s,o){var f;const{spatialReference:a,pointer:l}=o;er(bC,n,i);const c=Di(OXe,bC[1],-bC[0],0),u=Kf(c,er(bC,r,n))/zf(c),d=Wh(ns(r),n,c,u);if(g0(s,Ls(d,a,Rn,this.view))<this.squaredProximityThreshold(l)){if(this.isVertical(d,n)||this.isVertical(n,i))return;const m=Tf(Me(),n,c,Math.sign(u));e.push(new bfe({targetPoint:d,constraint:new pfe(n,m),previousVertex:i,otherVertex:n,otherVertexType:Mb.CENTER,isDraped:((f=o.elevationInfo)==null?void 0:f.mode)==="on-the-ground"}))}}};const bC=kt(),OXe=Me();let LXe=class extends s1{constructor({targetPoint:e,point1:i,point2:n,isDraped:r}){super(e,new dfe(sP(Me(),i,n,.5),.5*Xf(i,n)),r,Fr.SELF),this._p1=i,this._p2=n}get hints(){return[new zu(bl.REFERENCE,this.targetPoint,this._p1,this.isDraped,this.domain),new zu(bl.REFERENCE,this.targetPoint,this._p2,this.isDraped,this.domain),new vfe(this._p1,this.targetPoint,this._p2,this.isDraped,this.domain)]}},RXe=class extends Pk{snapNewVertex(e,i){const n=i.editGeometryOperations.data.components[0],r=[],s=n.vertices.length;if(i.editGeometryOperations.data.type!=="polygon"||s<2)return r;const{view:o}=this,a=n.vertices[0],l=n.vertices[s-1],c=ki(a.pos,o,i),u=ki(l.pos,o,i);return this._processCandidateProposal(c,u,e,i,r),r}snapExistingVertex(e,i){const n=[],r=i.vertexHandle,s=r.component;if(s.edges.length<2||i.editGeometryOperations.data.type==="polyline"&&(r.index===0||r.index===s.vertices.length-1))return n;const{view:o}=this,a=ki(r.leftEdge.leftVertex.pos,o,i),l=ki(r.rightEdge.rightVertex.pos,o,i);return this._processCandidateProposal(a,l,e,i,n),n}_processCandidateProposal(e,i,n,r,s){var m;if(!this.exceedsShortLineThreshold(e,i,r))return;const o=PV(DXe,e,i,.5),a=.5*Xf(e,i),l=Me();rXe(l,n,o,a),l[2]=n[2];const c=l,{spatialReference:u,pointer:d}=r,f=Ls(n,u,Rn,this.view);if(g0(f,Ls(c,u,Rn,this.view))<this.squaredProximityThreshold(d)){if(this.isVertical(e,c)||this.isVertical(c,i))return;s.push(new LXe({targetPoint:c,point1:e,point2:i,isDraped:((m=r.elevationInfo)==null?void 0:m.mode)==="on-the-ground"}))}}};const DXe=kt();let i_=class extends ye{constructor(e){super(e),this.updating=!1,this._snappers=new xe,this._domain=Fr.SELF}initialize(){this._snappers.push(new PXe(this.view,this.options),new EXe(this.view,this.options),new kXe(this.view,this.options),new RXe(this.view,this.options))}set options(e){this._set("options",e);for(const i of this._snappers)i.options=e}async fetchCandidates(e,i,n){if(!(i&this._domain&&this.options.effectiveSelfEnabled))return[];const r=[];for(const s of this._snappers.items)for(const o of s.snap(e,n))r.push(o);return uB(e,r),r}};h([p({readOnly:!0})],i_.prototype,"updating",void 0),h([p({constructOnly:!0})],i_.prototype,"view",void 0),h([p()],i_.prototype,"options",null),i_=h([P("esri.views.interactive.snapping.SelfSnappingEngine")],i_);function NXe(t,e){return[new i_({view:t,options:e}),new Dp({view:t,options:e,spatialReference:t.spatialReference})]}let Rg=class extends ye{constructor(e){super(e),this.layer=null,this.enabled=!0,this.updating=!1,this.availability=1}};h([p({constructOnly:!0})],Rg.prototype,"layer",void 0),h([p()],Rg.prototype,"enabled",void 0),h([p()],Rg.prototype,"updating",void 0),h([p()],Rg.prototype,"availability",void 0),Rg=h([P("esri.views.interactive.snapping.FeatureSnappingLayerSource")],Rg);const FXe=Rg;let ia=class extends ye{constructor(e){super(e),this.enabled=!1,this.enabledToggled=!1,this.selfEnabled=!0,this.featureEnabled=!0,this.featureSources=new xe,this.distance=td.distance,this.touchSensitivityMultiplier=td.touchSensitivityMultiplier}get effectiveEnabled(){return this.enabledToggled?!this.enabled:this.enabled}get effectiveSelfEnabled(){return this.effectiveEnabled&&this.selfEnabled}get effectiveFeatureEnabled(){return this.effectiveEnabled&&this.featureEnabled}};h([p()],ia.prototype,"enabled",void 0),h([p()],ia.prototype,"enabledToggled",void 0),h([p()],ia.prototype,"selfEnabled",void 0),h([p()],ia.prototype,"featureEnabled",void 0),h([p({type:xe.ofType(FXe)})],ia.prototype,"featureSources",void 0),h([p()],ia.prototype,"distance",void 0),h([p()],ia.prototype,"touchSensitivityMultiplier",void 0),h([p({readOnly:!0})],ia.prototype,"effectiveEnabled",null),h([p({readOnly:!0})],ia.prototype,"effectiveSelfEnabled",null),h([p({readOnly:!0})],ia.prototype,"effectiveFeatureEnabled",null),ia=h([P("esri.views.interactive.snapping.SnappingOptions")],ia);const dB=ia;let zXe=class xfe extends $k{constructor(e,i,n=Fr.ALL){super(i,n),this.intersectionPoint=e}equals(e){return e instanceof xfe&&Li(this.intersectionPoint,e.intersectionPoint)}},wC=class extends s1{constructor(e,i,n,r){super(e,new cfe(e,i.constraint,n.constraint),r,Fr.ALL),this.first=i,this.second=n}get hints(){return this.first.targetPoint=this.targetPoint,this.second.targetPoint=this.targetPoint,[...this.first.hints,...this.second.hints,new zXe(this.targetPoint,this.isDraped,this.domain)]}},Ql=class extends Uo.EventedMixin(lb){constructor(e){super(e),this.options=new dB,this.snappingEnginesFactory=NXe,this._engines=[],this._currentMainCandidate=null,this._currentOtherActiveCandidates=[],this._currentSnappedType=Ch.MAIN}initialize(){this.handles.add([Q(()=>{const{effectiveFeatureEnabled:e,effectiveSelfEnabled:i,touchSensitivityMultiplier:n,distance:r}=this.options;return{effectiveFeatureEnabled:e,effectiveSelfEnabled:i,touchSensitivityMultiplier:n,distance:r}},()=>{this.doneSnapping(),this.emit("changed")},ml),Q(()=>this.options,e=>{for(const i of this._engines)i.options=e},ml),Q(()=>({viewReady:this.view.ready,viewSpatialReference:this.view.spatialReference,snappingEnginesFactory:this.snappingEnginesFactory}),({viewReady:e,snappingEnginesFactory:i})=>this._recreateEngines(e,i),Oi)])}destroy(){this._destroyEngines()}get updating(){return this._engines.some(e=>e.updating)}_recreateEngines(e,i){if(this._destroyEngines(),!e)return;const{view:n,options:r}=this;this._engines=i(n,r)}_destroyEngines(){for(const e of this._engines)e.destroy();this._engines=[]}get _squaredMouseProximityTreshold(){return this.options.distance*this.options.distance}get _squaredTouchProximityThreshold(){const{distance:e,touchSensitivityMultiplier:i}=this.options,n=e*i;return n*n}get _squaredSatisfiesConstraintThreshold(){return td.satisfiesConstraintScreenThreshold*td.satisfiesConstraintScreenThreshold}async snap(e){return VXe(e)?this._snapMultiPoint(e):this._snapSinglePoint(e)}update(e){const{point:i,context:n}=e;this._removeVisualization();const r=this._currentMainCandidate;if(r==null)return i;const s=this._selectUpdateInput(e);if(s==null)return i;const{spatialReference:o}=n,a=an(s,o);if(a==null)return i;const{view:l}=this,{elevationInfo:c,visualizer:u}=n,d=[],f=bx(a,l,n),m=r.constraint.closestTo(f);if(!this._arePointsWithinScreenThreshold(f,m,n))return this._resetSnappingState(),i;r.targetPoint=m,d.push(...r.hints);for(const g of this._currentOtherActiveCandidates)g.targetPoint=m,d.push(...g.hints);return u!=null&&this.handles.add(u.draw(d,{spatialReference:o,elevationInfo:jXe(n),view:l,selfSnappingZ:n.selfSnappingZ}),xC),NZ(m,l,{z:i.z,m:i.m,spatialReference:i.spatialReference,elevationInfo:c})}doneSnapping(){this._removeVisualization(),this._resetSnappingState()}_selectUpdateInput({point:e,scenePoint:i}){switch(this._currentSnappedType){case Ch.MAIN:return e;case Ch.SCENE:return i}}_resetSnappingState(){this._currentMainCandidate=null,this._currentOtherActiveCandidates=[],this._currentSnappedType=Ch.MAIN}_removeVisualization(){this.handles.remove(xC)}async _snapSinglePoint({point:e,context:i,signal:n}){const{view:r}=this,s=bx(e,r,i),o=await this._fetchCandidates(s,Fr.ALL,i,n);return this._createSnapResult(s,Ch.MAIN,o,r,i,{z:e.z,m:e.m,spatialReference:e.spatialReference,elevationInfo:i.elevationInfo},n)}async _snapMultiPoint({point:e,scenePoint:i,context:n,signal:r}){const{view:s}=this,{coordinateHelper:o,spatialReference:a}=n;await Ff(i.spatialReference,a);const l=an(i,a),c=bx(l,s,n),u=await this._fetchCandidates(c,Fr.FEATURE,n,r);if(u.length>0){const m=await this._fetchCandidates(c,Fr.SELF,n,r);return this._createSnapResult(c,Ch.SCENE,[...u,...m],s,n,{z:l.z,m:l.m,spatialReference:l.spatialReference,elevationInfo:n.elevationInfo},r)}const d=bx(e,s,n),f=await this._fetchCandidates(d,Fr.SELF,n,r);return this._createSnapResult(d,Ch.MAIN,f,s,n,{z:o.hasZ()&&e.hasZ?e.z??0:void 0,m:o.hasM()&&e.hasM?e.m??0:void 0,spatialReference:e.spatialReference,elevationInfo:n.elevationInfo},r)}async _fetchCandidates(e,i,n,r){return(await Promise.all(this._engines.map(s=>s.fetchCandidates(e,i,n,r)))).flat()}_createSnapResult(e,i,n,r,s,o,a){return{get valid(){return!zo(a)},apply:()=>{const{spatialReference:l}=s,{snappedPoint:c,hints:u}=this._processCandidates(e,i,n,s);return this._removeVisualization(),s.visualizer!=null&&this.handles.add(s.visualizer.draw(u,{spatialReference:l,elevationInfo:Rn,view:r,selfSnappingZ:s.selfSnappingZ}),xC),NZ(c,r,o)}}}_processCandidates(e,i,n,r){if(n.length<1)return this.doneSnapping(),{snappedPoint:e,hints:[]};this._currentSnappedType!==i&&this._resetSnappingState(),uB(e,n);const s=this._currentMainCandidate;if(s!=null){const o=this._findOldConstraintInNewCandidates(s,n);if(o>=0){if(!(n[o]instanceof wC))return this._intersectWithOtherCandidates(o,n,e,i,r);if(this._arePointsWithinScreenThreshold(e,s.targetPoint,r))return this._updateSnappingCandidate(s,i,n,r)}}return this._intersectWithOtherCandidates(0,n,e,i,r)}_findOldConstraintInNewCandidates(e,i){return e instanceof wC?this._findOldCandidateIndex(i,e.first)>=0&&this._findOldCandidateIndex(i,e.second)>=0?0:-1:this._findOldCandidateIndex(i,e)}_intersectWithOtherCandidates(e,i,n,r,s){const{coordinateHelper:o}=s,a=i[e],l=[];for(let c=0;c<i.length;++c){if(c===e)continue;const u=i[c];for(const d of a.constraint.intersect(u.constraint)){const f=d.closestTo(a.targetPoint);l.push([new wC(f,a,u,u.isDraped),this._squaredScreenDistance(n,f,o)])}}return l.length>0&&(l.sort((c,u)=>c[1]-u[1]),l[0][1]<this._squaredPointProximityThreshold(s.pointer))?this._updateSnappingCandidate(l[0][0],r,i,s):this._updateSnappingCandidate(a,r,i,s)}_updateSnappingCandidate(e,i,n,r){this.doneSnapping(),this._currentMainCandidate=e,this._currentSnappedType=i;const s=this._currentMainCandidate.targetPoint,o=[];o.push(...e.hints);for(const a of n){if(e instanceof wC){if(a.constraint.equals(e.first.constraint)||a.constraint.equals(e.second.constraint))continue}else if(a.constraint.equals(e.constraint))continue;const l=a.constraint.closestTo(s);this._squaredScreenDistance(l,s,r.coordinateHelper)<this._squaredSatisfiesConstraintThreshold&&(a.targetPoint=s,this._currentOtherActiveCandidates.push(a),o.push(...a.hints))}return{snappedPoint:s,hints:o}}_squaredPointProximityThreshold(e){return e==="touch"?this._squaredTouchProximityThreshold:this._squaredMouseProximityTreshold}_arePointsWithinScreenThreshold(e,i,n){return this._squaredScreenDistance(e,i,n.coordinateHelper)<this._squaredPointProximityThreshold(n.pointer)}_squaredScreenDistance(e,i,n){return g0(this._toScreen(e,n),this._toScreen(i,n))}_toScreen(e,i){return Ls(e,i.spatialReference,Rn,this.view)}_findOldCandidateIndex(e,i){let n=-1;for(let r=0;r<e.length;++r)if(i.constraint.equals(e[r].constraint)){n=r;break}return n}get test(){return{visualizationsActive:this.handles.has(xC),engines:this._engines}}};var Ch;h([p({constructOnly:!0})],Ql.prototype,"view",void 0),h([p()],Ql.prototype,"options",void 0),h([p({readOnly:!0})],Ql.prototype,"updating",null),h([p()],Ql.prototype,"snappingEnginesFactory",void 0),h([p()],Ql.prototype,"_engines",void 0),h([p()],Ql.prototype,"_squaredMouseProximityTreshold",null),h([p()],Ql.prototype,"_squaredTouchProximityThreshold",null),h([p()],Ql.prototype,"_squaredSatisfiesConstraintThreshold",null),Ql=h([P("esri.views.interactive.snapping.SnappingManager")],Ql),function(t){t[t.MAIN=0]="MAIN",t[t.SCENE=1]="SCENE"}(Ch||(Ch={}));const xC="visualization-handle";function VXe(t){return t.scenePoint!=null}function jXe({coordinateHelper:t,elevationInfo:e}){return t.hasZ()?Rn:e}function BXe(t){return(t==null?void 0:t.type)==="graphic"}function UXe(t){return t.find(BXe)??null}let es=class extends Uo.EventedAccessor{constructor(e){super(e),this.cancelled=!1,this.history={undo:[],redo:[]},this.type=null}get tool(){if(!this.activeComponent)return null;switch(this.activeComponent.type){case"graphic-mover":case"move-3d":return"move";case"box":case"transform-3d":return"transform";case"reshape":case"reshape-3d":return"reshape";case"draw-2d":case"draw-3d":return this.activeComponent.geometryType;default:this.activeComponent}return null}addToHistory(e){this.history.redo=[],this.history.undo.push(e)}resetHistory(){this.history.redo=[],this.history.undo=[]}canUndo(){return this.history.undo.length>0}canRedo(){return this.history.redo.length>0}complete(){this._reset(),this.onEnd(),this.emit("complete")}cancel(){this.cancelled=!0,this.complete()}_reset(){var e;(e=this.activeComponent)==null||e.reset()}refreshComponent(){const e=this.activeComponent;e&&(e.type!=="box"&&e.type!=="reshape"&&e.type!=="graphic-mover"||e.refresh())}set undo(e){this._set("undo",()=>{this.canUndo()&&e()})}set redo(e){this._set("redo",()=>{this.canRedo()&&e()})}};h([p()],es.prototype,"activeComponent",void 0),h([p()],es.prototype,"cancelled",void 0),h([p()],es.prototype,"history",void 0),h([p()],es.prototype,"tool",null),h([p()],es.prototype,"type",void 0),h([p()],es.prototype,"canUndo",null),h([p()],es.prototype,"canRedo",null),h([p()],es.prototype,"onEnd",void 0),h([p()],es.prototype,"undo",null),h([p()],es.prototype,"redo",null),h([p()],es.prototype,"toggleTool",void 0),h([p()],es.prototype,"addToSelection",void 0),h([p()],es.prototype,"removeFromSelection",void 0),es=h([P("esri.widgets.Sketch.support.OperationHandle")],es);let yE=class extends es{};h([p()],yE.prototype,"activeComponent",void 0),yE=h([P("esri.widgets.Sketch.support.CreateOperationHandle")],yE);let Ah=class extends es{};h([p()],Ah.prototype,"activeComponent",void 0),Ah=h([P("esri.widgets.Sketch.support.UpdateOperationHandle")],Ah);const jZ={defaultZ:0},X1={reshapeOptions:{edgeOperation:"split",shapeOperation:"move",vertexOperation:"move"},enableMoveAllGraphics:!0,enableRotation:!0,enableScaling:!0,multipleSelectionEnabled:!0,preserveAspectRatio:!1,toggleToolOnClick:!0,enableZ:!0,highlightOptions:{enabled:!0},tool:"transform"};let xi=class extends Uo.EventedAccessor{constructor(e){super(e),this._numUpdating=0,this._handles=new Rs,this._internalGraphicsLayer=new Xpe({listMode:"hide",internal:!0,title:"SVM Internal"}),this._operationHandle=null,this._viewHandles=new Rs,this.activeFillSymbol=null,this.activeLineSymbol=null,this.activeVertexSymbol=null,this.allowDeleteKey=!0,this.labelOptions=new Qpe,this.layer=null,this.pointSymbol=new rs({style:"circle",size:6,color:[255,255,255],outline:{color:[50,50,50],width:1}}),this.polygonSymbol=new Pc({color:[150,150,150,.2],outline:{color:[50,50,50],width:2}}),this.polylineSymbol=new Ur({color:[130,130,130,1],width:2}),this.meshSymbol=new YS({symbolLayers:[new Gb]}),this._snappingManager=null,this.tooltipOptions=new efe,this.updateGraphics=new xe,this.updateOnGraphicClick=!0,this.vertexSymbol=new rs({style:"circle",size:6,color:[255,255,255],outline:{color:[50,50,50],width:1}}),this._moduleLoaderAbortController=null,this._viewReadyAbortController=null,this._originalPopupEnabled=null,this.defaultCreateOptions=jZ,this.defaultUpdateOptions=X1,this.snappingOptions=new dB}initialize(){this._handles.add([on(()=>{var e,i;return(i=(e=this.view)==null?void 0:e.map)==null?void 0:i.layers},"change",e=>{e.removed.includes(this.layer)&&this.cancel()}),on(()=>{var e;return(e=this.layer)==null?void 0:e.graphics},"change",e=>{if(this._operationHandle!=null)for(const i of e.removed)this.updateGraphics.includes(i)&&(this.updateGraphics.length>1?this._operationHandle.removeFromSelection(i):this._operationHandle.cancel())}),Q(()=>{var e;return((e=this.layer)==null?void 0:e.elevationInfo)??null},e=>{e!==this._internalGraphicsLayer.elevationInfo&&(this.cancel(),this._internalGraphicsLayer.elevationInfo=e)},Oi),Q(()=>this.view,e=>{Je(this._snappingManager),e&&(this._snappingManager=new Ql({view:e,options:this.snappingOptions}),e.type==="2d"?Y(()=>import("./editingTools-4c0426e2.js"),["./editingTools-4c0426e2.js","./SnappingVisualizer2D-311712a0.js","./enums-f1a6a48a.js","./settings-ae8277ff.js","./SnappingContext-aa3210c2.js","./PointSnappingHint-713a7d52.js","./automaticLengthMeasurementUtils-25068de2.js","./spatialReferenceEllipsoidUtils-088ffef8.js","./geometryEngine-4cf0d37c.js","./geometryEngineBase-5d80acc4.js","./hydrated-dd8bf351.js","./earcut-b7ad7453.js","./triangle-1ff63f40.js","./editPlaneUtils-a9b72b05.js","./centroid-c77ae2ef.js","./hydratedFeatures-e026b41c.js","./interfaces-1a80c8eb.js","./GraphicManipulator-43f96552.js","./drapedUtils-c3232933.js","./analysisThemeUtils-3e441352.js","./colorUtils-7a1a7a9f.js"],import.meta.url):e.type==="3d"&&(Y(()=>import("./editingTools-a07852ac.js").then(i=>i.e),["./editingTools-a07852ac.js","./analysisThemeUtils-3e441352.js","./colorUtils-7a1a7a9f.js","./automaticLengthMeasurementUtils-25068de2.js","./spatialReferenceEllipsoidUtils-088ffef8.js","./geometryEngine-4cf0d37c.js","./geometryEngineBase-5d80acc4.js","./hydrated-dd8bf351.js","./GraphicState-31d7820f.js","./vec4f32-0d1b2306.js","./Octree-2fa482dd.js","./line-df821705.js","./DoubleArray-d8438b2c.js","./FloatArray-c6ec366f.js","./requestImageUtils-7eb39924.js","./basicInterfaces-bb952591.js","./enums-b14466b3.js","./Texture-6a4a9109.js","./Indices-ee76e634.js","./triangle-1ff63f40.js","./doublePrecisionUtils-e3c3d0d8.js","./BufferView-3be96e15.js","./VertexElementDescriptor-2925c6af.js","./VertexArrayObject-c8e6ef22.js","./OrderIndependentTransparency-2a607a9a.js","./hydratedFeatures-e026b41c.js","./triangulationUtils-00809067.js","./earcut-b7ad7453.js","./deduplicate-c994028e.js","./NestedMap-1b5db22e.js","./InterleavedLayout-9fc0b7c6.js","./types-1305598a.js","./floatRGBA-3a82b521.js","./glUtil-0b7ee6ea.js","./NativeLineMaterial-f33d0b31.js","./VertexColor.glsl-d6559625.js","./SnappingContext-aa3210c2.js","./PointSnappingHint-713a7d52.js","./interfaces-1a80c8eb.js","./editPlaneUtils-a9b72b05.js","./centroid-c77ae2ef.js","./GraphicManipulator-43f96552.js","./drapedUtils-c3232933.js","./TranslateTooltipInfos-9187a553.js","./MeshTransform-86944072.js","./persistable-abb7bc04.js","./multiOriginJSONSupportUtils-c978f4c3.js","./resourceExtension-38152471.js","./ExtentTooltipInfos-7465e1c4.js"],import.meta.url),Y(()=>import("./GraphicsLayerView3D-e51833eb.js").then(i=>i.G),["./GraphicsLayerView3D-e51833eb.js","./line-df821705.js","./DoubleArray-d8438b2c.js","./FloatArray-c6ec366f.js","./requestImageUtils-7eb39924.js","./basicInterfaces-bb952591.js","./enums-b14466b3.js","./Texture-6a4a9109.js","./Indices-ee76e634.js","./triangle-1ff63f40.js","./doublePrecisionUtils-e3c3d0d8.js","./BufferView-3be96e15.js","./VertexElementDescriptor-2925c6af.js","./VertexArrayObject-c8e6ef22.js","./OrderIndependentTransparency-2a607a9a.js","./hydratedFeatures-e026b41c.js","./triangulationUtils-00809067.js","./earcut-b7ad7453.js","./deduplicate-c994028e.js","./NestedMap-1b5db22e.js","./Octree-2fa482dd.js","./InterleavedLayout-9fc0b7c6.js","./types-1305598a.js","./floatRGBA-3a82b521.js","./glUtil-0b7ee6ea.js","./OptimizedFeature-4701473b.js","./OptimizedGeometry-196224d4.js","./optimizedFeatureQueryEngineAdapter-2fa61fa1.js","./centroid-8e8cfa47.js","./edgeUtils-aec49665.js","./NativeLineMaterial-f33d0b31.js","./VertexColor.glsl-d6559625.js","./byteSizeEstimations-7cf1c05d.js","./featureConversionUtils-7f0dd1f5.js","./OptimizedFeatureSet-1d1ac4b9.js","./vec32-8668bab3.js","./SnappingCandidate-970faec6.js","./objectResourceUtils-468b1aec.js","./DefaultMaterial_COLOR_GAMMA-566d622c.js","./resourceUtils-ebdc7923.js","./symbolColorUtils-e00b4661.js","./callExpressionWithFeature-2746b39a.js","./quantizationUtils-4d6bfb95.js","./MeshComponent-89daf4bd.js","./imageUtils-c2d0d1ae.js","./projection-1ffbe9dd.js","./spatialReferenceEllipsoidUtils-088ffef8.js","./interfaces-1a80c8eb.js","./fontUtils-36c927ab.js","./PooledRBush-c3f6d07d.js","./popupUtils-dd683fba.js","./geometryServiceUtils-7fe9dc26.js","./LayerView-849133df.js"],import.meta.url)))},Oi),Q(()=>{var e;return(e=this.view)==null?void 0:e.spatialReference},(e,i)=>{e&&i&&!e.equals(i)&&this.cancel()})]),vXe(this)}destroy(){this.cancel(),this._handles=Je(this._handles),this._viewHandles=Je(this._viewHandles),this._removeDefaultLayer(),this._snappingManager=Je(this._snappingManager),this._set("view",null),this.emit("destroy")}get _defaultUpdateTool(){var e;return((e=this.view)==null?void 0:e.type)==="3d"?"move":"transform"}get updating(){return this._numUpdating>0||this._snappingManager!=null&&this._snappingManager.updating}get activeTool(){var e;return((e=this._operationHandle)==null?void 0:e.tool)??null}get activeComponent(){var e;return((e=this._operationHandle)==null?void 0:e.activeComponent)??null}get createGraphic(){return this.activeComponent==null||this.activeComponent.type!=="draw-3d"&&this.activeComponent.type!=="draw-2d"?this._get("createGraphic"):this.activeComponent.graphic}get defaultCreateOptions(){return this._get("defaultCreateOptions")}set defaultCreateOptions(e){this._set("defaultCreateOptions",{...jZ,...e})}get defaultUpdateOptions(){return this._get("defaultUpdateOptions")}set defaultUpdateOptions(e){this._set("defaultUpdateOptions",{...X1,...e,reshapeOptions:{...X1.reshapeOptions,...e==null?void 0:e.reshapeOptions},highlightOptions:{...X1.highlightOptions,...e==null?void 0:e.highlightOptions}})}set snappingOptions(e){this._snappingManager!=null&&(this._snappingManager.options=e),this._set("snappingOptions",e)}get state(){var n;const e=!(!((n=this.view)!=null&&n.ready)||!this.layer),i=this._operationHandle;return e&&i?"active":e?"ready":"disabled"}get view(){return this._get("view")}set view(e){const i=this._get("view");if(i){const{container:r,map:s}=i;r&&(i.cursor=null),s&&s.remove(this._internalGraphicsLayer),this._viewHandles.removeAll(),this.cancel()}const n="view-ready";this._handles.remove(n),e&&this._handles.add(jo(()=>e.ready,r=>{this._viewHandles.removeAll(),r&&this._viewHandles.add(this._generateViewHandles(e))},Oi),n),this._set("view",e)}cancel(){this._moduleLoaderAbortController=is(this._moduleLoaderAbortController),this._viewReadyAbortController=is(this._viewReadyAbortController),this._operationHandle&&this._operationHandle.cancel()}complete(){this._operationHandle&&this._operationHandle.complete()}delete(){const{state:e,updateGraphics:i}=this;if(e==="active"&&i.length){const{activeTool:n,layer:r}=this,s=i.toArray();r.removeMany(s),this.cancel(),this._emitDeleteEvent({graphics:s,tool:n})}}duplicate(){if(this.state==="active"&&this.updateGraphics.length){const e=this.updateGraphics.map(i=>i.clone()).toArray();return this.layer.addMany(e),this.emit("duplicate",{graphics:e,type:"duplicate"}),e}return[]}async create(e,i){this.cancel(),await this._waitViewReady();const{view:n,layer:r}=this;if(!n||this.state==="disabled")throw r||this._logMissingLayer(),li();if(n.activeTool!=null&&(n.activeTool=null),!e)return void this._logError("sketch:missing-parameter","Missing parameter 'tool'.");RZ(n,this._internalGraphicsLayer);const s=await this._setupCreateOperation(e,i);if(s==null||this.destroyed)return void n.map.remove(this._internalGraphicsLayer);const o=()=>{if(s===this._operationHandle){const a=this.createGraphic,l=this._operationHandle.cancelled;this._operationHandle.destroy(),this._operationHandle=null,this._set("createGraphic",null),this.view&&this.view.map&&this.view.map.remove(this._internalGraphicsLayer),s.cancelled||a==null||r.add(a),this.emit("create",{graphic:a,state:l?"cancel":"complete",tool:e,toolEventInfo:null,type:"create"})}};s.on("complete",o),this._operationHandle=s,n.ready&&n.focus()}async update(e,i){this.cancel(),await this._waitViewReady();const{layer:n,view:r,state:s}=this;if(!r||s==="disabled")throw n||this._logMissingLayer(),li();r.activeTool!=null&&(r.activeTool=null);const o=Array.isArray(e)?e:[e];if(e==null||!o||!o.length)return void this._logError("sketch:missing-parameter","Missing parameter 'graphics'.");if(o.some(l=>l.layer!==n?(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics missing from the supplied GraphicsLayer."),!0):l.geometry==null&&(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics with an unsupported geometry."),!0)))return;const a=await this._setupUpdateOperation(o,i);this.destroyed||a==null||Bn(a)||(RZ(r,this._internalGraphicsLayer),this._setUpdateOperationHandle(a,i),this.emit("update",{graphics:o,state:"start",aborted:!1,tool:a.tool,toolEventInfo:null,type:"update"}))}async _updateSpatialReference(e){const i=this.view;if(i){this._beginAsyncOperation(),e=Array.isArray(e)?e:[e];for(const n of e)n.geometry==null||n.geometry.type==="mesh"||En(n.geometry.spatialReference,i.spatialReference)||(yl(n.geometry.spatialReference,i.spatialReference)||wl()||await Ic(),n.geometry=an(n.geometry,i.spatialReference));this._endAsyncOperation()}else this._logMissingView()}undo(){var e;this.canUndo()&&((e=this._operationHandle)==null||e.undo())}redo(){var e;this.canRedo()&&((e=this._operationHandle)==null||e.redo())}canUndo(){return!(!this._operationHandle||!this._operationHandle.canUndo())}canRedo(){return!(!this._operationHandle||!this._operationHandle.canRedo())}toggleUpdateTool(){this._operationHandle&&this._operationHandle.toggleTool&&this._operationHandle.toggleTool()}async _getFirstHit(e){const i=this.view;if(!i)return this._logMissingView(),null;if(i.type==="2d"){const s=[];i.map.allLayers.forEach(a=>{a.type!=="vector-tile"&&a.type!=="imagery"||s.push(a)});const o=await i.hitTest(e,{exclude:s});return UXe(o.results)}const n=[i.map.ground];i.map.allLayers.forEach(s=>{s.type==="integrated-mesh"&&n.push(s)});const r=await i.hitTest(e,{exclude:n});if(r.results.length>0){const s=r.results[0];if(s!=null&&s.type==="graphic"&&s.graphic&&(!r.ground.mapPoint||i.map.ground.opacity<1||r.ground.distance-(s.distance??0)>-Math.min(3*r.ground.distance,i.viewingMode==="global"?nP(i.renderCoordsHelper.spatialReference).radius/i.renderCoordsHelper.unitInMeters:Number.POSITIVE_INFINITY)))return s}return null}_generateViewHandles(e){return[e.on("immediate-click",async i=>{var o;const n=this.state==="active"&&((o=this._operationHandle)==null?void 0:o.type)==="create";if(this.state==="disabled"||n||!this.updateOnGraphicClick)return;this._beginAsyncOperation();const r=await i.async(()=>this._getFirstHit(Za(i)));let s=null;if(r!=null){const a=r.graphic;this.updateGraphics.includes(a)||a.layer===this.layer?(i.stopPropagation(),s=a):e.type!=="2d"||this._isComponentGraphic(a)||this.state!=="active"||this.cancel()}else this.state==="active"&&this.cancel();s==null||this.updateGraphics.includes(s)||await this.update([s],{...this.defaultUpdateOptions,reshapeOptions:{...this.defaultUpdateOptions.reshapeOptions}}),this._endAsyncOperation()},gi.WIDGET)]}async _setupCreateOperation(e,i){const n=this.view;if(!n)return this._logMissingView(),null;const r={hasZ:n.type==="3d",...this.defaultCreateOptions,...i},s=await this._setupDrawGraphicTool(e,n,r);return s==null?null:(n.tools.add(s),n.activeTool=s,this._setupCreateOperationHandle(s))}async _setupDrawGraphicTool(e,i,n){if(e==="multipoint"&&i.type==="3d")return this._logError("sketch:create","Multipoint geometries are not supported in SceneView."),null;if(!i)return this._logMissingView(),null;const r=e!=="rectangle",s=e!=="rectangle",o={view:i,mode:e==="rectangle"||e==="circle"?"hybrid":"click",...n,snapToScene:!1,geometryType:e,graphicSymbol:this._getGraphicSymbolFromTool(e),snappingManager:this._snappingManager,forceUniformSize:s,centered:r};return i.type==="2d"?this._makeDrawGraphicTool2D(o):this._makeDrawGraphicTool3D(o)}async _makeDrawGraphicTool2D(e){const i=await this._requireModule(Y(()=>import("./editingTools-4c0426e2.js"),["./editingTools-4c0426e2.js","./SnappingVisualizer2D-311712a0.js","./enums-f1a6a48a.js","./settings-ae8277ff.js","./SnappingContext-aa3210c2.js","./PointSnappingHint-713a7d52.js","./automaticLengthMeasurementUtils-25068de2.js","./spatialReferenceEllipsoidUtils-088ffef8.js","./geometryEngine-4cf0d37c.js","./geometryEngineBase-5d80acc4.js","./hydrated-dd8bf351.js","./earcut-b7ad7453.js","./triangle-1ff63f40.js","./editPlaneUtils-a9b72b05.js","./centroid-c77ae2ef.js","./hydratedFeatures-e026b41c.js","./interfaces-1a80c8eb.js","./GraphicManipulator-43f96552.js","./drapedUtils-c3232933.js","./analysisThemeUtils-3e441352.js","./colorUtils-7a1a7a9f.js"],import.meta.url));return Bn(i)||this.destroyed?null:new i.module.DrawGraphicTool2D({...e,activeVertexSymbol:this.activeVertexSymbol,regularVerticesSymbol:this.vertexSymbol,activeLineSymbol:this.activeLineSymbol,activeFillSymbol:HXe(e.geometryType)?this.activeFillSymbol:null,tooltipOptions:this.tooltipOptions})}async _makeDrawGraphicTool3D(e){const i=await this._requireModule(Y(()=>import("./editingTools-a07852ac.js").then(r=>r.e),["./editingTools-a07852ac.js","./analysisThemeUtils-3e441352.js","./colorUtils-7a1a7a9f.js","./automaticLengthMeasurementUtils-25068de2.js","./spatialReferenceEllipsoidUtils-088ffef8.js","./geometryEngine-4cf0d37c.js","./geometryEngineBase-5d80acc4.js","./hydrated-dd8bf351.js","./GraphicState-31d7820f.js","./vec4f32-0d1b2306.js","./Octree-2fa482dd.js","./line-df821705.js","./DoubleArray-d8438b2c.js","./FloatArray-c6ec366f.js","./requestImageUtils-7eb39924.js","./basicInterfaces-bb952591.js","./enums-b14466b3.js","./Texture-6a4a9109.js","./Indices-ee76e634.js","./triangle-1ff63f40.js","./doublePrecisionUtils-e3c3d0d8.js","./BufferView-3be96e15.js","./VertexElementDescriptor-2925c6af.js","./VertexArrayObject-c8e6ef22.js","./OrderIndependentTransparency-2a607a9a.js","./hydratedFeatures-e026b41c.js","./triangulationUtils-00809067.js","./earcut-b7ad7453.js","./deduplicate-c994028e.js","./NestedMap-1b5db22e.js","./InterleavedLayout-9fc0b7c6.js","./types-1305598a.js","./floatRGBA-3a82b521.js","./glUtil-0b7ee6ea.js","./NativeLineMaterial-f33d0b31.js","./VertexColor.glsl-d6559625.js","./SnappingContext-aa3210c2.js","./PointSnappingHint-713a7d52.js","./interfaces-1a80c8eb.js","./editPlaneUtils-a9b72b05.js","./centroid-c77ae2ef.js","./GraphicManipulator-43f96552.js","./drapedUtils-c3232933.js","./TranslateTooltipInfos-9187a553.js","./MeshTransform-86944072.js","./persistable-abb7bc04.js","./multiOriginJSONSupportUtils-c978f4c3.js","./resourceExtension-38152471.js","./ExtentTooltipInfos-7465e1c4.js"],import.meta.url));if(Bn(i)||this.destroyed)return null;const{elevationInfo:n}=this.layer;return new i.module.DrawGraphicTool3D({...e,elevationInfo:n,snapToScene:n==null||n.mode==="absolute-height",labelOptions:this.labelOptions,tooltipOptions:this.tooltipOptions})}_setupCreateOperationHandle(e){const i=this.view;if(!i)return this._logMissingView(),null;let n=null;const r=e.forceUniformSize,s=e.centered,o=[i.on("key-down",l=>{if(l.key===jn.pan)l.stopPropagation(),l.repeat||(e.enabled=!1);else if(l.key===jn.complete)l.stopPropagation(),e.completeCreateOperation();else if(l.key!==jn.vertexAdd||l.repeat)l.key===jn.undo?(l.stopPropagation(),a.undo()):l.key===jn.redo?(l.stopPropagation(),a.redo()):l.key!==jn.constraint||e.geometryType!=="rectangle"&&e.geometryType!=="circle"||l.repeat?l.key===jn.center&&(l.repeat||(e.centered=!s,l.stopPropagation())):(e.forceUniformSize=!r,l.stopPropagation());else{const c=e.drawOperation.geometryType;c!=="polyline"&&c!=="polygon"&&c!=="multipoint"||(l.stopPropagation(),e.drawOperation.commitStagedVertex())}},gi.WIDGET),i.on("key-up",l=>{l.key===jn.pan?e.enabled=!0:l.key!==jn.constraint||e.geometryType!=="rectangle"&&e.geometryType!=="circle"?l.key===jn.center&&(e.centered=s,l.stopPropagation()):(e.forceUniformSize=r,l.stopPropagation())},gi.WIDGET),e.on("vertex-add",l=>{switch(n=n==null?"start":"active",l.operation){case"apply":this.emit("create",{graphic:e.graphic,state:n,tool:this.activeTool,toolEventInfo:l,type:"create"});break;case"undo":this._emitUndoEvent({graphics:[e.graphic],tool:e.geometryType});break;case"redo":this._emitRedoEvent({graphics:[e.graphic],tool:e.geometryType})}}),e.on("cursor-update",l=>{e.drawOperation.numCommittedVertices>0&&this.emit("create",{graphic:e.graphic,state:"active",tool:this.activeTool,toolEventInfo:{coordinates:l.vertices[0].coordinates,type:"cursor-update"},type:"create"})}),e.on("vertex-remove",l=>{switch(l.operation){case"apply":this.emit("create",{graphic:e.graphic,state:"active",tool:this.activeTool,toolEventInfo:l,type:"create"});break;case"undo":this._emitUndoEvent({graphics:[e.graphic],tool:e.geometryType});break;case"redo":this._emitRedoEvent({graphics:[e.graphic],tool:e.geometryType})}}),e.on("complete",l=>{this._set("createGraphic",l.graphic),n="complete",l.aborted?a&&a.cancel():a&&a.complete()}),Q(()=>this._getGraphicSymbolFromTool(e.geometryType),l=>{e.graphicSymbol=l})],a=new yE({activeComponent:e,tool:e.geometryType,type:"create",onEnd:()=>{var l;o.forEach(c=>c.remove()),o.length=0,(l=i.tools)==null||l.remove(e)},undo:()=>{e.canUndo&&e.undo()},redo:()=>{e.canRedo&&e.redo()},canUndo:()=>e.canUndo,canRedo:()=>e.canRedo});return a}_getGraphicSymbolFromTool(e){switch(e){case"point":case"multipoint":return this.pointSymbol;case"polyline":return this.polylineSymbol;case"circle":case"rectangle":case"polygon":return this.polygonSymbol;case"mesh":return this.meshSymbol}}async _setupUpdateOperation(e,i){var a;const{layer:n,view:r}=this;if(!r)return this._logMissingView(),null;const s={tool:this._defaultUpdateTool,...this.defaultUpdateOptions,...i,reshapeOptions:{...this.defaultUpdateOptions.reshapeOptions,...i==null?void 0:i.reshapeOptions},highlightOptions:{...this.defaultUpdateOptions.highlightOptions,...i==null?void 0:i.highlightOptions}};let o=s.tool;for(const l of e)n.remove(l),n.add(l);if(r.type==="3d"){if(e.length===0)return null;switch(o){case"move":return this._setupMove3DOperation(e,s,r,o);case"reshape":{if(e.length>1)return this._logError("sketch:reshape-multiple","Reshape operation does not support multiple graphics."),null;const l=vC(e[0]);return l===ni.SUPPORTED?this._setupReshape3DOperation(e[0],s,r):(this._logError("sketch:reshape",`Reshape operation not supported for provided graphic(s) (${ML(l)}).`),null)}case"transform":return this._setupGraphicTransform3DOperation(e,s,r)}}switch(o){case"move":return this._setupMove2DOperation(e,s,r);case"reshape":{if(e.length>1)return this._logError("sketch:reshape-multiple","Reshape operation does not support multiple graphics."),null;const l=vC(e[0]);return l===ni.SUPPORTED?this._setupTransformOrReshape2DOperation(e,o,s,r):(this._logError("sketch:reshape",`Reshape operation not supported for provided graphic(s) (${ML(l)}).`),null)}case"transform":if(e.length===1){const l=(a=e[0].geometry)==null?void 0:a.type;l!=="point"&&l!=="multipoint"||(o="reshape")}return this._setupTransformOrReshape2DOperation(e,o,s,r)}}async _setupMove3DOperation(e,i,n,r,s=!1){for(const u of e){const d=QYe(u);if(d!==ni.SUPPORTED)return this._logError("sketch:move",`Move operation not supported for provided graphic(s) (${ML(d)}).`),null}const o=await this._requireModule(Y(()=>import("./editingTools-a07852ac.js").then(u=>u.e),["./editingTools-a07852ac.js","./analysisThemeUtils-3e441352.js","./colorUtils-7a1a7a9f.js","./automaticLengthMeasurementUtils-25068de2.js","./spatialReferenceEllipsoidUtils-088ffef8.js","./geometryEngine-4cf0d37c.js","./geometryEngineBase-5d80acc4.js","./hydrated-dd8bf351.js","./GraphicState-31d7820f.js","./vec4f32-0d1b2306.js","./Octree-2fa482dd.js","./line-df821705.js","./DoubleArray-d8438b2c.js","./FloatArray-c6ec366f.js","./requestImageUtils-7eb39924.js","./basicInterfaces-bb952591.js","./enums-b14466b3.js","./Texture-6a4a9109.js","./Indices-ee76e634.js","./triangle-1ff63f40.js","./doublePrecisionUtils-e3c3d0d8.js","./BufferView-3be96e15.js","./VertexElementDescriptor-2925c6af.js","./VertexArrayObject-c8e6ef22.js","./OrderIndependentTransparency-2a607a9a.js","./hydratedFeatures-e026b41c.js","./triangulationUtils-00809067.js","./earcut-b7ad7453.js","./deduplicate-c994028e.js","./NestedMap-1b5db22e.js","./InterleavedLayout-9fc0b7c6.js","./types-1305598a.js","./floatRGBA-3a82b521.js","./glUtil-0b7ee6ea.js","./NativeLineMaterial-f33d0b31.js","./VertexColor.glsl-d6559625.js","./SnappingContext-aa3210c2.js","./PointSnappingHint-713a7d52.js","./interfaces-1a80c8eb.js","./editPlaneUtils-a9b72b05.js","./centroid-c77ae2ef.js","./GraphicManipulator-43f96552.js","./drapedUtils-c3232933.js","./TranslateTooltipInfos-9187a553.js","./MeshTransform-86944072.js","./persistable-abb7bc04.js","./multiOriginJSONSupportUtils-c978f4c3.js","./resourceExtension-38152471.js","./ExtentTooltipInfos-7465e1c4.js"],import.meta.url));if(Bn(o))return o;const a=new o.module.GraphicMoveTool({view:n,enableZ:i.enableZ,snappingManager:this._snappingManager,tooltipOptions:this.tooltipOptions});n.tools.add(a),a.graphics.addMany(e),s||this.updateGraphics.addMany(e);const l=[],c=new Ah({activeComponent:a,tool:r,type:"update",onEnd:()=>{var u;l.forEach(d=>d.remove()),l.length=0,(u=n.tools)==null||u.remove(a),a.destroyed||a.destroy()},undo:()=>{SC(c,this.updateGraphics.toArray()),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:r})},redo:()=>{TC(c,this.updateGraphics.toArray()),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:r})},addToSelection:u=>{this.updateGraphics.push(u),a.graphics.push(u),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[u],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:u=>{const d=this.updateGraphics.indexOf(u);c.history.undo.forEach(f=>f.updates.splice(d,1)),c.history.redo.forEach(f=>f.updates.splice(d,1)),this.updateGraphics.remove(u),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[u],type:"selection-change"},type:"update"}),this.updateGraphics.length!==0?a.graphics.remove(u):c.complete()},toggleTool:async()=>{if(this.updateGraphics.length!==1||i.toggleToolOnClick===!1||r!=="transform")return;const u=this.updateGraphics.at(0);if(vC(u)!==ni.SUPPORTED)return;c.onEnd(),c.destroy();const d=await this._setupReshape3DOperation(u,i,n,!0);Bn(d)||this._setUpdateOperationHandle(d,i)}});return l.push(...this._getHandlesForComponent(c,i),n.on("immediate-click",u=>this._getCommonUpdateOperationClickHandlers(c,u,i),gi.WIDGET),n.on("key-down",u=>{this._getCommonUpdateOperationKeyDownHandlers(c,u)},gi.WIDGET)),c}_setupGraphicTransform3DOperation(e,i,n,r=!1){if(e.length===1&&tXe(e[0])===ni.SUPPORTED){const s=e[0],o=s.geometry;if(o!=null&&(o.type==="point"||o.type==="mesh"))return this._setupPointTransform3DOperation(s,i,n);if(o!=null&&(o.type==="polygon"||o.type==="polyline"))return this._setupPolyTransform3DOperation(s,i,n,r)}return this._setupMove3DOperation(e,i,n,"transform",r)}async _setupPointTransform3DOperation(e,i,n){const r="transform",{enableRotation:s,enableScaling:o,enableZ:a}=i,l=await this._requireModule(Y(()=>import("./editingTools-a07852ac.js").then(f=>f.e),["./editingTools-a07852ac.js","./analysisThemeUtils-3e441352.js","./colorUtils-7a1a7a9f.js","./automaticLengthMeasurementUtils-25068de2.js","./spatialReferenceEllipsoidUtils-088ffef8.js","./geometryEngine-4cf0d37c.js","./geometryEngineBase-5d80acc4.js","./hydrated-dd8bf351.js","./GraphicState-31d7820f.js","./vec4f32-0d1b2306.js","./Octree-2fa482dd.js","./line-df821705.js","./DoubleArray-d8438b2c.js","./FloatArray-c6ec366f.js","./requestImageUtils-7eb39924.js","./basicInterfaces-bb952591.js","./enums-b14466b3.js","./Texture-6a4a9109.js","./Indices-ee76e634.js","./triangle-1ff63f40.js","./doublePrecisionUtils-e3c3d0d8.js","./BufferView-3be96e15.js","./VertexElementDescriptor-2925c6af.js","./VertexArrayObject-c8e6ef22.js","./OrderIndependentTransparency-2a607a9a.js","./hydratedFeatures-e026b41c.js","./triangulationUtils-00809067.js","./earcut-b7ad7453.js","./deduplicate-c994028e.js","./NestedMap-1b5db22e.js","./InterleavedLayout-9fc0b7c6.js","./types-1305598a.js","./floatRGBA-3a82b521.js","./glUtil-0b7ee6ea.js","./NativeLineMaterial-f33d0b31.js","./VertexColor.glsl-d6559625.js","./SnappingContext-aa3210c2.js","./PointSnappingHint-713a7d52.js","./interfaces-1a80c8eb.js","./editPlaneUtils-a9b72b05.js","./centroid-c77ae2ef.js","./GraphicManipulator-43f96552.js","./drapedUtils-c3232933.js","./TranslateTooltipInfos-9187a553.js","./MeshTransform-86944072.js","./persistable-abb7bc04.js","./multiOriginJSONSupportUtils-c978f4c3.js","./resourceExtension-38152471.js","./ExtentTooltipInfos-7465e1c4.js"],import.meta.url));if(Bn(l))return l;const c=new l.module.GraphicTransformTool({graphic:e,view:n,enableRotation:s,enableScaling:o,enableZ:a,snappingManager:this._snappingManager,tooltipOptions:this.tooltipOptions});n.tools.add(c),this.updateGraphics.add(e);const u=[],d=new Ah({activeComponent:c,tool:r,type:"update",onEnd:()=>{var f;u.forEach(m=>m.remove()),u.length=0,(f=n.tools)==null||f.remove(c),c.destroyed||c.destroy()},undo:()=>{SC(d,this.updateGraphics.toArray()),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:r})},redo:()=>{TC(d,this.updateGraphics.toArray()),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:r})},addToSelection:async f=>{this.updateGraphics.add(f),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[f],removed:[],type:"selection-change"},type:"update"}),d.onEnd(),d.destroy();const m=await this._setupMove3DOperation(this.updateGraphics.toArray(),i,n,"transform",!0);Bn(m)||this._setUpdateOperationHandle(m,i)},removeFromSelection:f=>{this.updateGraphics.remove(f),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[f],type:"selection-change"},type:"update"}),d.complete()},toggleTool:()=>{}});return u.push(...this._getHandlesForComponent(d,i),n.on("immediate-click",f=>this._getCommonUpdateOperationClickHandlers(d,f,i),gi.WIDGET),n.on("key-down",f=>{this._getCommonUpdateOperationKeyDownHandlers(d,f)},gi.WIDGET)),d}async _setupPolyTransform3DOperation(e,i,n,r=!1){const s="transform",{enableRotation:o,enableScaling:a,enableZ:l,preserveAspectRatio:c}=i,u=await this._requireModule(Y(()=>import("./editingTools-a07852ac.js").then(g=>g.e),["./editingTools-a07852ac.js","./analysisThemeUtils-3e441352.js","./colorUtils-7a1a7a9f.js","./automaticLengthMeasurementUtils-25068de2.js","./spatialReferenceEllipsoidUtils-088ffef8.js","./geometryEngine-4cf0d37c.js","./geometryEngineBase-5d80acc4.js","./hydrated-dd8bf351.js","./GraphicState-31d7820f.js","./vec4f32-0d1b2306.js","./Octree-2fa482dd.js","./line-df821705.js","./DoubleArray-d8438b2c.js","./FloatArray-c6ec366f.js","./requestImageUtils-7eb39924.js","./basicInterfaces-bb952591.js","./enums-b14466b3.js","./Texture-6a4a9109.js","./Indices-ee76e634.js","./triangle-1ff63f40.js","./doublePrecisionUtils-e3c3d0d8.js","./BufferView-3be96e15.js","./VertexElementDescriptor-2925c6af.js","./VertexArrayObject-c8e6ef22.js","./OrderIndependentTransparency-2a607a9a.js","./hydratedFeatures-e026b41c.js","./triangulationUtils-00809067.js","./earcut-b7ad7453.js","./deduplicate-c994028e.js","./NestedMap-1b5db22e.js","./InterleavedLayout-9fc0b7c6.js","./types-1305598a.js","./floatRGBA-3a82b521.js","./glUtil-0b7ee6ea.js","./NativeLineMaterial-f33d0b31.js","./VertexColor.glsl-d6559625.js","./SnappingContext-aa3210c2.js","./PointSnappingHint-713a7d52.js","./interfaces-1a80c8eb.js","./editPlaneUtils-a9b72b05.js","./centroid-c77ae2ef.js","./GraphicManipulator-43f96552.js","./drapedUtils-c3232933.js","./TranslateTooltipInfos-9187a553.js","./MeshTransform-86944072.js","./persistable-abb7bc04.js","./multiOriginJSONSupportUtils-c978f4c3.js","./resourceExtension-38152471.js","./ExtentTooltipInfos-7465e1c4.js"],import.meta.url));if(Bn(u))return u;const d=new u.module.ExtentTransformTool({graphic:e,view:n,enableRotation:o,enableScaling:a,enableZ:l,preserveAspectRatio:c,tooltipOptions:this.tooltipOptions});n.tools.add(d),r||this.updateGraphics.add(e);const f=[],m=new Ah({activeComponent:d,tool:s,type:"update",onEnd:()=>{var g;f.forEach(y=>y.remove()),f.length=0,(g=n.tools)==null||g.remove(d),d.destroyed||d.destroy()},canUndo:()=>d.canUndo,undo:()=>{d.undo(),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:s})},canRedo:()=>d.canRedo,redo:()=>{d.redo(),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:s})},addToSelection:async g=>{this.updateGraphics.add(g),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[g],removed:[],type:"selection-change"},type:"update"}),m.onEnd(),m.destroy();const y=await this._setupMove3DOperation(this.updateGraphics.toArray(),i,n,"transform",!0);Bn(y)||this._setUpdateOperationHandle(y,i)},removeFromSelection:g=>{this.updateGraphics.remove(g),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[g],type:"selection-change"},type:"update"}),m.complete()},toggleTool:async()=>{if(this.updateGraphics.length!==1||i.toggleToolOnClick===!1)return;const g=this.updateGraphics.at(0);if(vC(g)!==ni.SUPPORTED)return;m.onEnd(),m.destroy();const y=await this._setupReshape3DOperation(g,i,n,!0);Bn(y)||this._setUpdateOperationHandle(y,i)}});return f.push(...this._getHandlesForComponent(m,i),n.on("immediate-click",g=>this._getCommonUpdateOperationClickHandlers(m,g,i),gi.WIDGET),n.on("key-down",g=>this._getCommonUpdateOperationKeyDownHandlers(m,g),gi.WIDGET),n.on("key-down",g=>{g.key!==jn.constraint||g.repeat||(d.preserveAspectRatio=!d.preserveAspectRatio,g.stopPropagation())},gi.WIDGET),n.on("key-up",g=>{g.key===jn.constraint&&(d.preserveAspectRatio=!d.preserveAspectRatio,g.stopPropagation())},gi.WIDGET)),m}async _setupMove2DOperation(e,i,n){const r="move";this.updateGraphics.addMany(e),await this._updateSpatialReference(e);const s=await this._getGraphicMover(e,i,n);if(Bn(s))return s;const o=new Ah({activeComponent:s,tool:r,type:"update",onEnd:()=>{var u;this._displayDefaultCursor(),c.forEach(d=>d.remove()),l.forEach(d=>d.remove()),c=[],l=[],s.destroy(),(u=this._internalGraphicsLayer)==null||u.removeMany([...this.updateGraphics.toArray()])},undo:()=>{const u=this.updateGraphics.toArray();SC(o,u),o.refreshComponent(),this._emitUndoEvent({graphics:u,tool:r})},redo:()=>{const u=this.updateGraphics.toArray();TC(o,u),o.refreshComponent(),this._emitRedoEvent({graphics:u,tool:r})},addToSelection:async u=>{await this._updateSpatialReference(u),this.updateGraphics.push(u),s.graphics=this.updateGraphics.toArray(),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[u],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:u=>{const d=this.updateGraphics.indexOf(u);o.history.undo.forEach(m=>m.updates.splice(d,1)),o.history.redo.forEach(m=>m.updates.splice(d,1)),this.updateGraphics.remove(u);const f=this.updateGraphics.toArray();this.emit("update",{graphics:f,state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[u],type:"selection-change"},type:"update"}),this.updateGraphics.length!==0?s.graphics=f:o.complete()}});let a=!1,l=[n.on("immediate-click",u=>this._getCommonUpdateOperationClickHandlers(o,u,i),gi.WIDGET),n.on("key-down",u=>{this._getCommonUpdateOperationKeyDownHandlers(o,u),u.key!==jn.constraint||u.repeat||(a=!0,s.enableMoveAllGraphics=!s.enableMoveAllGraphics)},gi.WIDGET),n.on("key-up",u=>{u.key===jn.constraint&&a&&(a=!1,s.enableMoveAllGraphics=!s.enableMoveAllGraphics)},gi.WIDGET)],c=this._getHandlesForComponent(o,i);return o}async _setupReshape3DOperation(e,i,n,r=!1){const s="reshape",o=await this._requireModule(Y(()=>import("./editingTools-a07852ac.js").then(d=>d.e),["./editingTools-a07852ac.js","./analysisThemeUtils-3e441352.js","./colorUtils-7a1a7a9f.js","./automaticLengthMeasurementUtils-25068de2.js","./spatialReferenceEllipsoidUtils-088ffef8.js","./geometryEngine-4cf0d37c.js","./geometryEngineBase-5d80acc4.js","./hydrated-dd8bf351.js","./GraphicState-31d7820f.js","./vec4f32-0d1b2306.js","./Octree-2fa482dd.js","./line-df821705.js","./DoubleArray-d8438b2c.js","./FloatArray-c6ec366f.js","./requestImageUtils-7eb39924.js","./basicInterfaces-bb952591.js","./enums-b14466b3.js","./Texture-6a4a9109.js","./Indices-ee76e634.js","./triangle-1ff63f40.js","./doublePrecisionUtils-e3c3d0d8.js","./BufferView-3be96e15.js","./VertexElementDescriptor-2925c6af.js","./VertexArrayObject-c8e6ef22.js","./OrderIndependentTransparency-2a607a9a.js","./hydratedFeatures-e026b41c.js","./triangulationUtils-00809067.js","./earcut-b7ad7453.js","./deduplicate-c994028e.js","./NestedMap-1b5db22e.js","./InterleavedLayout-9fc0b7c6.js","./types-1305598a.js","./floatRGBA-3a82b521.js","./glUtil-0b7ee6ea.js","./NativeLineMaterial-f33d0b31.js","./VertexColor.glsl-d6559625.js","./SnappingContext-aa3210c2.js","./PointSnappingHint-713a7d52.js","./interfaces-1a80c8eb.js","./editPlaneUtils-a9b72b05.js","./centroid-c77ae2ef.js","./GraphicManipulator-43f96552.js","./drapedUtils-c3232933.js","./TranslateTooltipInfos-9187a553.js","./MeshTransform-86944072.js","./persistable-abb7bc04.js","./multiOriginJSONSupportUtils-c978f4c3.js","./resourceExtension-38152471.js","./ExtentTooltipInfos-7465e1c4.js"],import.meta.url));if(Bn(o))return o;const a=i.reshapeOptions,l=new o.module.GraphicReshapeTool({view:n,graphic:e,enableZVertex:i.enableZ&&(a==null?void 0:a.vertexOperation)==="move",enableZShape:i.enableZ&&(a==null?void 0:a.shapeOperation)==="move",enableMoveGraphic:(a==null?void 0:a.shapeOperation)==="move"||(a==null?void 0:a.shapeOperation)==="move-xy",enableMidpoints:(a==null?void 0:a.edgeOperation)==="split",enableEdgeOffset:(a==null?void 0:a.edgeOperation)==="offset",snappingManager:this._snappingManager,labelOptions:this.labelOptions,tooltipOptions:this.tooltipOptions});n.tools.add(l),r||this.updateGraphics.add(e);const c=[],u=new Ah({activeComponent:l,tool:s,type:"update",onEnd:()=>{var d;c.forEach(f=>f.remove()),c.length=0,(d=n.tools)==null||d.remove(l),l.destroyed||l.destroy()},canUndo:()=>l.canUndo,undo:()=>{l.undo(),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:s})},canRedo:()=>l.canRedo,redo:()=>{l.redo(),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:s})},addToSelection:async d=>{this.updateGraphics.add(d),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[d],removed:[],type:"selection-change"},type:"update"}),u.onEnd(),u.destroy();const f=await this._setupMove3DOperation(this.updateGraphics.toArray(),i,n,"transform",!0);Bn(f)||this._setUpdateOperationHandle(f,i)},removeFromSelection:d=>{this.updateGraphics.remove(d),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[d],type:"selection-change"},type:"update"}),u.complete()},toggleTool:async()=>{if(i.toggleToolOnClick===!1)return;u.onEnd(),u.destroy();const d=await this._setupGraphicTransform3DOperation(this.updateGraphics.toArray(),i,n,!0);Bn(d)||this._setUpdateOperationHandle(d,i)}});return c.push(...this._getHandlesForComponent(u,i),n.on("immediate-click",d=>this._getCommonUpdateOperationClickHandlers(u,d,i),gi.WIDGET),n.on("key-down",d=>{this._getCommonUpdateOperationKeyDownHandlers(u,d)},gi.WIDGET)),u}async _setupTransformOrReshape2DOperation(e,i,n,r){this.updateGraphics.addMany(e),await this._updateSpatialReference(e);const s=i==="transform"?await this._getBox(e,n,r):await this._getReshape(e,n,r);if(Bn(s))return s;const o=new Ah({activeComponent:s,type:"update",onEnd:()=>{l.forEach(c=>c.remove()),a.forEach(c=>c.remove()),l=[],a=[],o.activeComponent&&!o.activeComponent.destroyed&&o.activeComponent.destroy(),this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray())},undo:()=>{SC(o,this.updateGraphics.toArray()),o.refreshComponent(),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:o.tool})},redo:()=>{TC(o,this.updateGraphics.toArray()),o.refreshComponent(),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:o.tool})},addToSelection:async c=>{let u=o.activeComponent;if((u==null?void 0:u.type)==="reshape"){const d=[...this.updateGraphics,c];this.updateGraphics.removeAll(),o.onEnd(),o.destroy();const f=await this._setupMove2DOperation(d,n,r);if(Bn(f))return;this._setUpdateOperationHandle(f,n)}else this.updateGraphics.add(c),u.graphics=this.updateGraphics.toArray(),u.refresh(),o.resetHistory();this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[c],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:async c=>{const u=this.updateGraphics.indexOf(c);o.history.undo.forEach(f=>f.updates.splice(u,1)),o.history.redo.forEach(f=>f.updates.splice(u,1)),this.updateGraphics.remove(c);const d=this.updateGraphics.toArray();if(d.length===0)o.complete();else{const f=d[0].geometry;d.length!==1||f==null||f.type!=="point"&&f.type!=="multipoint"?o.activeComponent.graphics=d:o.toggleTool()}this.emit("update",{graphics:d,state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[c],type:"selection-change"},type:"update"})},toggleTool:async()=>{var f;if(this.updateGraphics.length>1)return;const c=this.updateGraphics.at(0),u=c.geometry;if(u!=null&&(o.tool==="reshape"&&(u.type==="point"||u.type==="multipoint")||o.tool==="transform"&&u.type==="extent"))return;let d=null;o.tool==="transform"?d=await this._getReshape([c],n,r):o.tool==="reshape"&&(d=await this._getBox([c],n,r)),Bn(d)||((f=o.activeComponent)==null||f.destroy(),o.activeComponent=d,o.activeComponent&&(l.forEach(m=>m.remove()),l=this._getHandlesForComponent(o,n)))}});let a=[r.on("immediate-click",c=>this._getCommonUpdateOperationClickHandlers(o,c,n),gi.WIDGET),r.on("key-down",c=>{if(this._getCommonUpdateOperationKeyDownHandlers(o,c),c.key===jn.constraint&&!c.repeat&&o){const u=o.activeComponent;u&&u.type==="box"&&(u.preserveAspectRatio=!u.preserveAspectRatio)}},gi.WIDGET),r.on("key-up",c=>{if(c.key===jn.constraint&&o){const u=o.activeComponent;u&&u.type==="box"&&(u.preserveAspectRatio=!u.preserveAspectRatio)}},gi.WIDGET)],l=this._getHandlesForComponent(o,n);return o}async _getGraphicMover(e,i,n){const{enableMoveAllGraphics:r,highlightOptions:s}=i,o=await this._requireModule(Y(()=>import("./GraphicMover-3844e2e3.js").then(a=>a.G),["./GraphicMover-3844e2e3.js","./GraphicManipulator-43f96552.js","./drapedUtils-c3232933.js"],import.meta.url));return Bn(o)?o:new o.module.default({enableMoveAllGraphics:r,highlightsEnabled:!!(s!=null&&s.enabled),indicatorsEnabled:!1,graphics:e,view:n,callbacks:{onGraphicMoveStart:({dx:a,dy:l,graphic:c})=>{this._displayGrabbingCursor(),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:a,dy:l,mover:c,type:"move-start"},type:"update"})},onGraphicMove:({dx:a,dy:l,graphic:c})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:a,dy:l,mover:c,type:"move"},type:"update"}),onGraphicMoveStop:({dx:a,dy:l,graphic:c})=>{this._displayPointerCursor(),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:a,dy:l,mover:c,type:"move-stop"},type:"update"})},onGraphicPointerOver:()=>this._displayPointerCursor(),onGraphicPointerOut:()=>this._displayDefaultCursor()}})}async _getBox(e,i,n){const{enableRotation:r,enableScaling:s,highlightOptions:o,preserveAspectRatio:a}=i,l=await this._requireModule(Y(()=>import("./Box-22245151.js"),["./Box-22245151.js","./automaticLengthMeasurementUtils-25068de2.js","./spatialReferenceEllipsoidUtils-088ffef8.js","./geometryEngine-4cf0d37c.js","./geometryEngineBase-5d80acc4.js","./hydrated-dd8bf351.js","./GraphicManipulator-43f96552.js","./drapedUtils-c3232933.js","./GraphicMover-3844e2e3.js","./settings-ae8277ff.js","./ExtentTooltipInfos-7465e1c4.js","./TranslateTooltipInfos-9187a553.js"],import.meta.url));return Bn(l)?l:new l.module.default({graphics:e,enableRotation:r,enableScaling:s,highlightsEnabled:!!(o!=null&&o.enabled),preserveAspectRatio:a,layer:this._internalGraphicsLayer,view:n,tooltipOptions:this.tooltipOptions,callbacks:{onMoveStart:c=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...c},type:"update"}),onMove:c=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...c},type:"update"}),onMoveStop:c=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...c},type:"update"}),onScaleStart:c=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...c},type:"update"}),onScale:c=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...c},type:"update"}),onScaleStop:c=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...c},type:"update"}),onRotateStart:c=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...c},type:"update"}),onRotate:c=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...c},type:"update"}),onRotateStop:c=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...c},type:"update"})}})}async _getReshape(e,i,n){var l,c,u;const r=((l=i.reshapeOptions)==null?void 0:l.edgeOperation)==="split",s=((c=i.reshapeOptions)==null?void 0:c.shapeOperation)==="move",o=!!((u=i.highlightOptions)!=null&&u.enabled),a=await this._requireModule(Y(()=>import("./Reshape-79681b7d.js"),["./Reshape-79681b7d.js","./automaticLengthMeasurementUtils-25068de2.js","./spatialReferenceEllipsoidUtils-088ffef8.js","./geometryEngine-4cf0d37c.js","./geometryEngineBase-5d80acc4.js","./hydrated-dd8bf351.js","./SnappingVisualizer2D-311712a0.js","./enums-f1a6a48a.js","./settings-ae8277ff.js","./SnappingContext-aa3210c2.js","./PointSnappingHint-713a7d52.js","./earcut-b7ad7453.js","./triangle-1ff63f40.js","./GraphicManipulator-43f96552.js","./drapedUtils-c3232933.js","./GraphicMover-3844e2e3.js","./TranslateTooltipInfos-9187a553.js"],import.meta.url));return Bn(a)?a:new a.module.default({enableMidpoints:r,enableMovement:s,graphic:e[0],highlightsEnabled:o,layer:this._internalGraphicsLayer,snappingManager:this._snappingManager,tooltipOptions:this.tooltipOptions,view:n,callbacks:{onReshapeStart:d=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...d},type:"update"}),onReshape:d=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...d},type:"update"}),onReshapeStop:({mover:d,type:f})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:d,type:f},type:"update"}),onMoveStart:({dx:d,dy:f,mover:m,type:g})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:d,dy:f,mover:m,type:g},type:"update"}),onMove:({dx:d,dy:f,mover:m,type:g})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:d,dy:f,mover:m,type:g},type:"update"}),onMoveStop:({dx:d,dy:f,mover:m,type:g})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:d,dy:f,mover:m,type:g},type:"update"}),onVertexAdd:({added:d,type:f,vertices:m})=>{const g=d.map(y=>V9(y.geometry));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:g,vertices:m,type:f},type:"update"})},onVertexRemove:({removed:d,type:f,vertices:m})=>{const g=d.map(y=>V9(y.geometry));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{removed:g,vertices:m,type:f},type:"update"})}}})}_getHandlesForComponent(e,i){const n=e.activeComponent;if(!n)return[];switch(n.type){case"graphic-mover":return[n.on("graphic-click",({graphic:r,viewEvent:s})=>{var o;(o=s.native)!=null&&o.shiftKey&&(s.stopPropagation(),e.removeFromSelection(r))}),n.on("graphic-move-start",r=>e.addToHistory(Yu(r.allGraphics)))];case"box":return[n.on("graphic-click",r=>this._onTransformOrReshape2DGraphicClick(e,i,r)),n.on("move-start",r=>e.addToHistory(Yu(r.graphics))),n.on("rotate-start",r=>e.addToHistory(Yu(r.graphics))),n.on("scale-start",r=>e.addToHistory(Yu(r.graphics)))];case"reshape":return[n.on("graphic-click",r=>this._onTransformOrReshape2DGraphicClick(e,i,r)),n.on("move-start",r=>e.addToHistory(Yu([r.mover]))),n.on("reshape-start",r=>e.addToHistory(Yu([r.graphic]))),n.on("vertex-add",r=>e.addToHistory(Yu([r.oldGraphic]))),n.on("vertex-remove",r=>e.addToHistory(Yu([r.oldGraphic])))];case"move-3d":return[n.on("graphic-move-start",r=>{e.addToHistory(Yu(r.allGraphics)),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:r.allGraphics.length>0?r.allGraphics[0]:null,type:"move-start"},type:"update"})}),n.on("graphic-move",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:r.dx,dy:r.dy,mover:r.allGraphics.length>0?r.allGraphics[0]:null,type:"move"},type:"update"})}),n.on("graphic-move-stop",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:r.allGraphics.length>0?r.allGraphics[0]:null,type:"move-stop"},type:"update"})}),n.on("immediate-click",r=>{r.shiftKey?this._toggleSelection([r.graphic],e,i):e.toggleTool()})];case"transform-3d":return[n.on("record-undo",({record:r})=>{e.addToHistory({updates:[r]})}),n.on("graphic-translate-start",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:r.graphic,dx:r.dxScreen,dy:r.dyScreen,type:"move-start"},type:"update"})}),n.on("graphic-translate-stop",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:r.graphic,dx:r.dxScreen,dy:r.dyScreen,type:"move-stop"},type:"update"})}),n.on("graphic-rotate-start",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:r.graphic,angle:r.angle,type:"rotate-start"},type:"update"})}),n.on("graphic-rotate-stop",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:r.graphic,angle:r.angle,type:"rotate-stop"},type:"update"})}),n.on("graphic-scale-start",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:r.graphic,xScale:r.xScale,yScale:r.yScale,type:"scale-start"},type:"update"})}),n.on("graphic-scale-stop",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:r.graphic,xScale:r.xScale,yScale:r.yScale,type:"scale-stop"},type:"update"})}),n.on("graphic-translate",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:r.graphic,dx:r.dxScreen,dy:r.dyScreen,type:"move"},type:"update"})}),n.on("graphic-rotate",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:r.graphic,angle:r.angle,type:"rotate"},type:"update"})}),n.on("graphic-scale",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:r.graphic,xScale:r.xScale,yScale:r.yScale,type:"scale"},type:"update"})}),n.on("immediate-click",r=>{r.shiftKey?this._toggleSelection([r.graphic],e,i):e.toggleTool()})];case"reshape-3d":return[n.on("reshape",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:r,type:"update"})}),n.on("move",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:r,type:"update"})}),n.on("vertex-add",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:r,type:"update"})}),n.on("vertex-remove",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:r,type:"update"})}),n.on("immediate-click",r=>{r.shiftKey?this._toggleSelection([r.graphic],e,i):e.toggleTool()})]}}_onTransformOrReshape2DGraphicClick(e,i,n){var o;const{graphic:r,viewEvent:s}=n;return(o=s.native)!=null&&o.shiftKey&&r.layer===this.layer?(s.stopPropagation(),e.removeFromSelection(r)):i.toggleToolOnClick?(s.stopPropagation(),e.toggleTool()):void 0}_setUpdateOperationHandle(e,i){var s;this._operationHandle=e;const n=(s=this.view)==null?void 0:s.map;this._disablePopup(i);const r=()=>{if(e===this._operationHandle){const o=this.updateGraphics.toArray(),a=this._operationHandle.tool;this._operationHandle.destroy(),this._operationHandle=null,this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray()),this.updateGraphics.removeAll(),n&&n.remove(this._internalGraphicsLayer),this._restorePopup(i),this.emit("update",{graphics:o,state:"complete",aborted:e.cancelled,tool:a,toolEventInfo:null,type:"update"})}};e.on("complete",r)}async _getCommonUpdateOperationClickHandlers(e,i,n){const r=Za(i),s=await i.async(()=>this._getFirstHit(r));if(s==null)return void e.complete();if(i.native.shiftKey&&this._toggleSelection([s.graphic],e,n))return void i.stopPropagation();this.updateGraphics.includes(s.graphic)?i.stopPropagation():e.complete()}_toggleSelection(e,i,n){const r=!!n.multipleSelectionEnabled;return e.some(s=>s!=null&&!(!r||s.layer!==this.layer)&&(this.updateGraphics.includes(s)?i.removeFromSelection(s):i.addToSelection(s),!0))}_getCommonUpdateOperationKeyDownHandlers(e,i){if(!e)return;const n=i.key;n===jn.undo&&e.canUndo()?(i.stopPropagation(),e.undo()):n===jn.redo&&e.canRedo()?(i.stopPropagation(),e.redo()):n===jn.cancel?(i.stopPropagation(),e.cancel()):this.allowDeleteKey&&jn.delete.includes(n)&&this._onDeleteKey(i)}_onDeleteKey(e){var r;if(!this._operationHandle||this._operationHandle.type!=="update")return;const i=this.activeComponent,n=this.updateGraphics.toArray();i!=null&&i.type!=="reshape-3d"&&(i.type!=="reshape"||n.length===1&&((r=n[0].geometry)==null?void 0:r.type)==="point")&&(e.stopPropagation(),this.delete())}_removeDefaultLayer(){var e,i;this._internalGraphicsLayer&&((i=(e=this.view)==null?void 0:e.map)==null||i.remove(this._internalGraphicsLayer),this._internalGraphicsLayer=Je(this._internalGraphicsLayer))}_isComponentGraphic(e){const{activeComponent:i}=this;return!(!e||i==null)&&(e.attributes&&e.attributes.esriSketchTool||i.type==="draw-2d"&&i.graphic===e||(i.type==="box"||i.type==="reshape")&&i.isUIGraphic(e))}_displayPointerCursor(){this.view&&this.view.container&&this.view.cursor!=="pointer"&&(this.view.cursor="pointer")}_displayGrabbingCursor(){this.view&&this.view.container&&this.view.cursor!=="grabbing"&&(this.view.cursor="grabbing")}_displayDefaultCursor(){this.view&&this.view.container&&this.view.cursor!==null&&(this.view.cursor=null)}_logError(e,i,n){ne.getLogger(this).error(new V(e,i,n))}async _requireModule(e){const i=new AbortController;this._moduleLoaderAbortController=i;const n=await e;return this._moduleLoaderAbortController!==i||i.signal.aborted?{requireError:"aborted"}:{module:n}}_emitUndoEvent(e){this.emit("undo",{...e,type:"undo"})}_emitRedoEvent(e){this.emit("redo",{...e,type:"redo"})}_emitDeleteEvent(e){this.emit("delete",{...e,type:"delete"})}get test(){return{operationHandle:this._operationHandle,defaultUpdateOptions:X1}}wait(){return Lu(()=>!this.updating)}_beginAsyncOperation(){this._numUpdating+=1,this.notifyChange("updating")}_endAsyncOperation(){this._numUpdating-=1,this.notifyChange("updating")}_disablePopupEnabled(e){var i;return((i=this.view)==null?void 0:i.type)!=="3d"||this.updateOnGraphicClick||((e==null?void 0:e.toggleToolOnClick)??!1)}_disablePopup(e){this._disablePopupEnabled(e)&&this.view&&this._originalPopupEnabled==null&&(this._originalPopupEnabled=this.view.popupEnabled,this.view.popupEnabled=!1)}_restorePopup(e){this._disablePopupEnabled(e)&&this.view&&this._originalPopupEnabled!=null&&(this.view.popupEnabled=this._originalPopupEnabled,this._originalPopupEnabled=null)}async _waitViewReady(){const e=this.view;e?(is(this._viewReadyAbortController),this._viewReadyAbortController=new AbortController,await S_(Lu(()=>e==null?void 0:e.ready),this._viewReadyAbortController.signal)):this._logMissingView()}_logMissingView(){this._logError("sketch:missing-property",BZ("view"))}_logMissingLayer(){this._logError(GXe,BZ("layer"))}};h([p()],xi.prototype,"updating",null),h([p()],xi.prototype,"_operationHandle",void 0),h([p({readOnly:!0})],xi.prototype,"activeTool",null),h([p()],xi.prototype,"activeFillSymbol",void 0),h([p()],xi.prototype,"activeLineSymbol",void 0),h([p()],xi.prototype,"activeVertexSymbol",void 0),h([p()],xi.prototype,"allowDeleteKey",void 0),h([p({readOnly:!0})],xi.prototype,"createGraphic",null),h([p()],xi.prototype,"defaultCreateOptions",null),h([p()],xi.prototype,"defaultUpdateOptions",null),h([p({type:Qpe,nonNullable:!0})],xi.prototype,"labelOptions",void 0),h([p()],xi.prototype,"layer",void 0),h([p({types:Su})],xi.prototype,"pointSymbol",void 0),h([p({types:Su})],xi.prototype,"polygonSymbol",void 0),h([p({types:Su})],xi.prototype,"polylineSymbol",void 0),h([p()],xi.prototype,"meshSymbol",void 0),h([p({type:dB,nonNullable:!0})],xi.prototype,"snappingOptions",null),h([p()],xi.prototype,"_snappingManager",void 0),h([p({readOnly:!0})],xi.prototype,"state",null),h([p({type:efe,nonNullable:!0})],xi.prototype,"tooltipOptions",void 0),h([p({readOnly:!0})],xi.prototype,"updateGraphics",void 0),h([p()],xi.prototype,"updateOnGraphicClick",void 0),h([p({types:Su})],xi.prototype,"vertexSymbol",void 0),h([p({value:null})],xi.prototype,"view",null),xi=h([P("esri.widgets.Sketch.SketchViewModel")],xi);const GXe="sketch:missing-property",BZ=t=>`Property '${t}' is missing on SketchViewModel.`;function HXe(t){return t==="polygon"||t==="rectangle"||t==="circle"}function SC(t,e){Sfe("undo",t.history.undo,t.history.redo,e)}function TC(t,e){Sfe("redo",t.history.redo,t.history.undo,e)}function Sfe(t,e,i,n){const r=e.pop();if(!r)return;const s=r.updates,o=[];n.forEach((a,l)=>{const c=s[l];c!=null&&("geometry"in c&&c.geometry!=null&&(o.push({geometry:a.geometry}),a.geometry=c.geometry),"symbol"in c&&c.symbol!=null&&(o.push({symbol:a.symbol}),a.symbol=c.symbol),"undo"in c&&(o.push(c),c[t](a)))}),i.push({updates:o})}function Yu(t){return{updates:t.map(e=>({geometry:e.geometry}))}}function Bn(t){return"requireError"in t&&t.requireError==="aborted"}const qXe=xi;var di,aa;function WXe(t){return t==="2d"?new Ub({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",effects:[{type:"CIMGeometricEffectDashes",dashTemplate:[5,4],lineDashEnding:"FullGap",controlPointEnding:"NoConstraint"}],enable:!0,capStyle:"Butt",joinStyle:"Round",width:1.5,color:[0,0,0,255]},{type:"CIMSolidStroke",enable:!0,capStyle:"Butt",joinStyle:"Round",width:1.5,color:[255,255,255,255]}]}}}):new Ur({color:[0,0,0,0]})}(function(t){t.Ready="ready",t.Creating="creating",t.Reshaping="reshaping",t.ReshapingDisabled="rehsaping-disabled",t.Selecting="selecting",t.Selected="selected"})(di||(di={})),function(t){t.View="view",t.Main="main",t.Interaction="interaction"}(aa||(aa={}));let na=class extends ye{constructor(e){super(e),this.state=di.Ready,this._handles=new Rs,this._pendingStartOptions=null,this._previousInputInfo=null,this._shouldRemoveLastPoint=!1,this._sketchedGraphics=new WeakSet,this._creationToolPromise=null,this._updateToolPromise=null,this._updateDisabled=!1}initialize(){this._handles.add(Q(()=>({view:this.tool.viewModel.view,visible:this.tool.visible}),({view:e,visible:i})=>{e!=null&&i?this._attach(e):this._detach()},Oi),aa.View)}destroy(){this._detach(),this._handles=Je(this._handles)}get canStopCreating(){const e=this._geometry,i=this._shouldRemoveLastPoint?3:2;return wT(e)&&e.paths.length>0&&e.paths[0].length>=i}get _input(){return this.tool.viewModel.input}set _input(e){this.tool.viewModel.input=e}get _geometry(){return ot(this._input,e=>e.geometry)}get _visibleAndEditable(){return this.tool.visible&&this.tool.editable}get _view(){return this.tool.viewModel.view}get test(){return{sketchVM:this._sketchVM,toolPromise:Promise.all([this._creationToolPromise??Promise.resolve(),this._updateToolPromise??Promise.resolve()])}}start(e={mode:"sketch"}){if(!this.tool.editable)return;const i=this._view;if(i!=null&&i.ready)switch(this._pendingStartOptions=null,this._stopInteraction(),this._previousInputInfo==null&&this._storePreviousInput(this._input),this._setSketchedGraphic(null),e.mode){case"sketch":this._set("state",di.Creating),this._startCreationInteraction();break;case"select":this._set("state",di.Selecting),this._startSelectionInteraction()}else this._pendingStartOptions=e}stop(){this._pendingStartOptions=null,this._stopInteractionAndUpdate(),this._clearPreviousInput()}cancel(){this._pendingStartOptions=null,this._stopInteractionAndUpdate(),this._restorePreviousInput()}clear(){this._stopInteractionAndUpdate(),this._set("state",di.Ready),this._clearPreviousInput(),this._input=null,this._pendingStartOptions=null}isSketchedGraphic(e){return e!=null&&this._sketchedGraphics.has(e)}_attach(e){this._detach();const i={mode:e.type==="3d"?"relative-to-ground":"on-the-ground",offset:null};this._graphicsLayer=new Xpe({listMode:"hide",internal:!0,elevationInfo:i});const n=WXe(e.type);this._sketchVM=new qXe({layer:this._graphicsLayer,view:e,defaultCreateOptions:{mode:"click",hasZ:!1},updateOnGraphicClick:!1,defaultUpdateOptions:{reshapeOptions:{shapeOperation:"none"},enableRotation:!1,enableScaling:!1,enableMoveAllGraphics:!1,enableZ:!1,multipleSelectionEnabled:!1,toggleToolOnClick:!1,tool:"reshape"},polylineSymbol:n,activeLineSymbol:n}),this._handles.add([jo(()=>e.ready,()=>ot(this._pendingStartOptions,r=>this.start(r)),Oi),Q(()=>[this._input,this._visibleAndEditable],()=>this._update(),Oi),Q(()=>({map:e.map,graphicsLayer:this._graphicsLayer}),({map:r,graphicsLayer:s})=>{r!=null&&s!=null&&r.add(s),this._update()},Oi)],aa.Main)}_detach(){this._handles.remove(aa.Main),this._sketchVM=Je(this._sketchVM),this._creationToolPromise=null,this._updateToolPromise=null;const e=ot(this._view,n=>n.map),i=this._graphicsLayer;e!=null&&i!=null&&e.remove(i),this._graphicsLayer=Je(this._graphicsLayer),this._shouldRemoveLastPoint=!1,this._set("state",di.Ready)}_startCreationInteraction(){this._stopInteractionAndUpdate();const e=this._view,i=this._sketchVM;if(e==null||i==null)return;this._shouldRemoveLastPoint=!1;const n=i.on("create",s=>{var a;const o=s.graphic;switch(s.state){case"complete":this._shouldRemoveLastPoint=!1,this._setSketchedGraphic(o),this._stopInteractionAndUpdate(),this._clearPreviousInput();break;case"cancel":this.cancel();break;case"active":this._setSketchedGraphic(o),((a=s.toolEventInfo)==null?void 0:a.type)==="cursor-update"&&(this._shouldRemoveLastPoint=!0);break;case"start":this._setSketchedGraphic(o)}}),r=()=>{n.remove();const s=this.canStopCreating,o=ot(this._geometry,a=>a.clone());i.cancel(),this._creationToolPromise=null,o!=null&&s?this._shouldRemoveLastPoint&&this._setSketchedGraphic(new Vo({geometry:JXe(o)})):this._input=null};this._handles.remove(aa.Interaction),this._handles.add(br(r),aa.Interaction),this._creationToolPromise=$y(i.create("polyline"))}_startReshapeInteraction(){this._stopInteraction();const e=this._view,i=this._sketchVM;if(e==null||i==null)return;const n=i.on("update",s=>{const o=s.graphics[0];switch(s.state){case"complete":this._setSketchedGraphic(o),this._stopInteractionAndUpdate(),this._clearPreviousInput();break;case"active":case"start":this._setSketchedGraphic(o)}}),r=()=>{n.remove(),i.cancel(),this._updateToolPromise=null};this._handles.remove(aa.Interaction),this._handles.add(br(r),aa.Interaction),ot(this._input,s=>{s.visible=!0,this._updateToolPromise=$y(i.update(s,{tool:"reshape"}))})}_startSelectionInteraction(){this._stopInteraction();const e=this._view;if(e==null)return;const i=e.cursor,n=br(()=>e.cursor=i);e.cursor="crosshair",e.closePopup();let r=null;const s=br(()=>is(r)),o=e.on("immediate-click",l=>{l.preventDefault(),l.stopPropagation(),is(r),r=i0(async c=>{const{results:u}=await e.hitTest(l);Vt(c);const d=u.filter(f=>f.type==="graphic"&&f.graphic!=null).map(f=>f.graphic).find(f=>f.geometry!=null&&f.geometry.type==="polyline");d&&(this._input=d,this._clearPreviousInput(),this._stopInteractionAndUpdate())})}),a=e.on("key-down",l=>{l.key==="Escape"&&this.cancel()});this._handles.remove(aa.Interaction),this._handles.add([o,a,s,n],aa.Interaction),e.ready&&e.focus()}_stopInteraction(){this._handles.remove(aa.Interaction)}_stopInteractionAndUpdate(){this._handles.has(aa.Interaction)&&(this._updateDisabled=!0,this._stopInteraction(),this._updateDisabled=!1,this._triggerUpdate())}_triggerUpdate(){this._set("state",di.Ready),this._update()}_update(){if(this._updateDisabled)return;const e=this.state;if(e!==di.Selecting){if(this._visibleAndEditable){if(e===di.Creating||e===di.Reshaping&&this.isSketchedGraphic(this._input))return}else this.cancel();this._set("state",this._getNextState()),this._updateVisuals()}else this.stop()}_getNextState(){return this._input==null?di.Ready:this.isSketchedGraphic(this._input)?this.state===di.Creating?di.Creating:this._visibleAndEditable?di.Reshaping:di.ReshapingDisabled:di.Selected}_updateVisuals(){switch(this.state){case di.Creating:break;case di.Reshaping:this._startReshapeInteraction();break;case di.ReshapingDisabled:{this._stopInteractionAndUpdate();const e=this._input;e!=null&&this.isSketchedGraphic(e)&&(e.visible=!1);break}case di.Ready:case di.Selected:this._stopInteractionAndUpdate();case di.Selecting:}this._updateSketchedGraphic()}_storePreviousInput(e){this._previousInputInfo={graphic:e}}_restorePreviousInput(){const e=this._previousInputInfo;e!=null&&(this._clearPreviousInput(),this._input=e.graphic,this._triggerUpdate())}_clearPreviousInput(){this._previousInputInfo=null}_updateSketchedGraphic(){const e=this._graphicsLayer;if(e==null)return;const i=e.graphics,n=this._input;if(n==null||!this.isSketchedGraphic(n))return void i.removeAll();if(i.indexOf(n)===-1)i.removeAll(),i.add(n);else if(i.length!==1){const r=i.filter(s=>s!==n);i.removeMany(r)}}_setSketchedGraphic(e){e!=null&&this._sketchedGraphics.add(e),this._input=e,this._updateSketchedGraphic()}};function JXe(t){if(wT(t)){const e=t.clone();return e.paths=[e.paths[0].slice(0,-1)],e}return t}h([p({nonNullable:!0})],na.prototype,"state",void 0),h([p({nonNullable:!0})],na.prototype,"tool",void 0),h([p()],na.prototype,"canStopCreating",null),h([p()],na.prototype,"_graphicsLayer",void 0),h([p()],na.prototype,"_sketchVM",void 0),h([p()],na.prototype,"_input",null),h([p()],na.prototype,"_geometry",null),h([p()],na.prototype,"_visibleAndEditable",null),h([p()],na.prototype,"_view",null),h([p()],na.prototype,"_shouldRemoveLastPoint",void 0),na=h([P("esri.widgets.ElevationProfile.ElevationProfileInteraction")],na);let vE=class extends ye{constructor(e){super(e),this._implementation=null,this._loadingTask=null,this._handles=new Rs}initialize(){this._handles.add(Q(()=>({tool:this.tool,view:this.tool.viewModel.view,visible:this.tool.visible&&!!ot(this.tool.viewModel.view,e=>e.ready)}),({tool:e,view:i,visible:n})=>{i!=null&&n?this._show(i,e):this._hide()},Oi))}destroy(){this._handles=Je(this._handles),this._hide()}_show(e,i){this._loadingTask=is(this._loadingTask),this._loadingTask=i0(async n=>{if(e.type==="2d"){const r=Y(()=>import("./ElevationProfileView2D-20c12974.js"),["./ElevationProfileView2D-20c12974.js","./HoveredPoints-83a0ce30.js","./AnchorElementViewModel-7827c70f.js"],import.meta.url),s=(await S_(r,n)).ElevationProfileView2D;this._implementation=new s(e,i)}else if(e.type==="3d"){const r=Y(()=>import("./ElevationProfileView3D-f3b5cafc.js"),["./ElevationProfileView3D-f3b5cafc.js","./HoveredPoints-83a0ce30.js","./AnchorElementViewModel-7827c70f.js","./GraphicState-31d7820f.js","./analysisThemeUtils-3e441352.js","./colorUtils-7a1a7a9f.js","./vec4f32-0d1b2306.js","./Octree-2fa482dd.js","./line-df821705.js","./DoubleArray-d8438b2c.js","./FloatArray-c6ec366f.js","./requestImageUtils-7eb39924.js","./basicInterfaces-bb952591.js","./enums-b14466b3.js","./Texture-6a4a9109.js","./Indices-ee76e634.js","./triangle-1ff63f40.js","./doublePrecisionUtils-e3c3d0d8.js","./BufferView-3be96e15.js","./VertexElementDescriptor-2925c6af.js","./VertexArrayObject-c8e6ef22.js","./OrderIndependentTransparency-2a607a9a.js","./hydratedFeatures-e026b41c.js","./triangulationUtils-00809067.js","./earcut-b7ad7453.js","./deduplicate-c994028e.js","./NestedMap-1b5db22e.js","./InterleavedLayout-9fc0b7c6.js","./types-1305598a.js","./floatRGBA-3a82b521.js","./glUtil-0b7ee6ea.js"],import.meta.url),s=(await S_(r,n)).ElevationProfileView3D;this._implementation=new s(e,i)}})}_hide(){this._loadingTask=is(this._loadingTask),this._implementation=Je(this._implementation)}};h([p()],vE.prototype,"tool",void 0),vE=h([P("esri.widgets.ElevationProfile.support.ElevationProfileView")],vE);let xh=class extends ye{constructor(e){super(e),this.editable=!0,this.visible=!0,this.highlightEnabled=!0}initialize(){this.view=new vE({tool:this}),this.interaction=new na({tool:this})}destroy(){this.interaction.destroy(),this.view.destroy()}get state(){var i;switch((i=this.interaction)==null?void 0:i.state){case di.Ready:return Po.Ready;case di.Creating:return Po.Creating;case di.Selecting:return Po.Selecting;case di.Selected:return Po.Selected;case di.Reshaping:case di.ReshapingDisabled:return Po.Created}}};h([p({nonNullable:!0})],xh.prototype,"viewModel",void 0),h([p()],xh.prototype,"view",void 0),h([p()],xh.prototype,"interaction",void 0),h([p()],xh.prototype,"editable",void 0),h([p()],xh.prototype,"visible",void 0),h([p()],xh.prototype,"highlightEnabled",void 0),xh=h([P("esri.widgets.ElevationProfile.ElevationProfileTool")],xh);let $t=class extends ye{constructor(e){super(e),this.view=null,this.input=null,this._getEffectiveUnitsMemoized=ol((i,n)=>({distance:i,elevation:n})),this.geodesicDistanceThreshold=1e5,this.hoveredChartPosition=null,this.uniformChartScaling=!1,this.defaultUnit=null,this.queue=null,this._currentTileCache=null,this.error=null,this._defaultProfileLineGround=new lpe,this._userUnitOptions=null,this._userUnit=null,e!=null&&e.profiles||(this.profiles=new xe([this._defaultProfileLineGround]))}initialize(){this.addHandles(Q(()=>this.view,e=>{var r;if(e==null)return void ne.getLogger(this).warnOnce("no view. Widget will be disabled until a view is provided.");this.removeHandles(UZ);const i=e.type==="3d"?e.resourceController:void 0;(r=this.queue)==null||r.destroy(),this.queue=uJe(i==null?void 0:i.scheduler);const n=i==null?void 0:i.addUpdatingObject(this);n&&this.addHandles(n,UZ)},Oi)),this.tool=new xh({viewModel:this}),this._controller=new Op({viewModel:this})}destroy(){this._defaultProfileLineGround=Je(this._defaultProfileLineGround),this._controller=Je(this._controller),this._currentTileCache=Je(this._currentTileCache),this.tool=Je(this.tool),this.queue=Je(this.queue)}get profiles(){return this._get("profiles")}set profiles(e){const i=this._get("profiles"),n=e??new xe;this._set("profiles",Of(n,i))}get state(){const e=this.view;return e!=null&&e.ready?this.tool.state:Po.Disabled}get progress(){let e=0,i=0;for(const n of this.visibleProfiles)e++,i+=n.progress;return e>0?i/e:0}set unitOptions(e){this._userUnitOptions=e,this._set("unitOptions",this._filteredOrAllUnits(this._userUnitOptions))}get unitOptions(){return this._filteredOrAllUnits(this._userUnitOptions)}set unit(e){this._userUnit=e?this._findSelectableUnit(e,this._userUnit):null,this.notifyChange("unit")}get unit(){return this._userUnit?(this._userUnit=this._findSelectableUnit(this._userUnit,this.defaultUnit),this._userUnit):this._findSelectableUnit(this.defaultUnit)}get effectiveUnits(){const e=oJe(this.visibleProfiles.map(r=>r.result)),i=Gve(e.maxDistance,"meters",this.unit),n=Hve(e.maxElevation,"meters",this.unit);return this._getEffectiveUnitsMemoized(i,n)}get highlightEnabled(){return this.tool.highlightEnabled}set highlightEnabled(e){this.tool.highlightEnabled=e}get hasVertices(){const e=ot(this.input,i=>i.geometry);return wT(e)&&e.paths.reduce((i,n)=>i+n.length,0)>0}get hoveredPoints(){return this.input!=null&&this.visible&&this.tool.editable?this.visibleProfiles.map(e=>{const i=e.hoveredPoint;return i!=null?{hoveredPoint:i,color:e.color}:null}).filter(Ti):[]}get statistics(){return sJe(this.visibleProfiles.map(e=>e.statistics))}get chartData(){if(this.input==null)return null;const{effectiveUnits:e,progress:i,statistics:n,visibleProfiles:r,uniformChartScaling:s}=this,o=r.filter(a=>a.hasZ).map(a=>({id:a.id,type:a.type,title:a.title,color:a.color,samples:a.samples,progress:a.progress,chartFillEnabled:a.chartFillEnabled,chartStrokeWidth:a.chartStrokeWidth,chartStrokeOffsetY:a.chartStrokeOffsetY,viewVisualizationEnabled:a.viewVisualizationEnabled}));return o.length===0?null:{lines:o,effectiveUnits:e,statistics:n,refined:i===1,dynamicElevationRange:r.some(a=>a.type==="view"),uniformScaling:s}}get visibleProfiles(){return this.profiles.toArray().filter(e=>e.available&&e.visible)}get minDemResolutions(){const e=[];for(const{minDemResolution:i}of this.visibleProfiles)i!=null&&e.push(i);return e}get minDemResolution(){return qX(this.minDemResolutions)}get errorState(){const e=ot(this.input,i=>i.geometry);if(!W8(e))return Kn.NoValidInput;if(this.error!=null){if(HWe(this.error))switch(this.error.cause){case al.TooComplex:return Kn.TooComplex;case al.InvalidGeometry:return Kn.InvalidGeometry;case al.InvalidElevationInfo:return Kn.InvalidElevationInfo;case al.ElevationQueryError:return Kn.NoValidInput}return Kn.UnknownError}return this.visibleProfiles.length===0?Kn.NoVisibleProfiles:this.chartData==null&&this.progress===1?Kn.RefinedButNoChartData:Kn.None}get tileCache(){var i;this._currentTileCache=Je(this._currentTileCache);const e=this.view;if(e!=null&&(e==null?void 0:e.type)==="3d"){const n=(i=e.basemapTerrain)==null?void 0:i.elevationQueryCache;if(n!=null)return n}return this._currentTileCache==null&&(this._currentTileCache=new fWe(new GP(20*Yy.MEGABYTES))),this._currentTileCache}get visible(){return this.tool.visible}set visible(e){this.tool.visible=e}get inputIsSketched(){return this.tool.interaction.isSketchedGraphic(this.input)}get elevationProvider(){const e=this.view;return e!=null&&e.type==="3d"?e.elevationProvider:null}get updating(){const{progress:e}=this;return e>0&&e<1}start(e){this.tool.interaction.start(e)}stop(){this.tool.interaction.stop()}cancel(){this.tool.interaction.cancel()}clear(){this.tool.interaction.clear()}_findSelectableUnit(e,i){const n=this.unitOptions;return e!=null&&n.includes(e)?e:i?this._findSelectableUnit(i):n[0]}_filteredOrAllUnits(e){const i=(e??[]).filter(n=>JE.includes(n));return i.length===0?JE.slice():i}};h([p()],$t.prototype,"view",void 0),h([p({type:Vo})],$t.prototype,"input",void 0),h([p({type:KYe,nonNullable:!0})],$t.prototype,"profiles",null),h([p({readOnly:!0})],$t.prototype,"state",null),h([p({readOnly:!0})],$t.prototype,"progress",null),h([p()],$t.prototype,"unitOptions",null),h([p()],$t.prototype,"unit",null),h([p({readOnly:!0})],$t.prototype,"effectiveUnits",null),h([p({type:Number})],$t.prototype,"geodesicDistanceThreshold",void 0),h([p()],$t.prototype,"hoveredChartPosition",void 0),h([p()],$t.prototype,"uniformChartScaling",void 0),h([p()],$t.prototype,"highlightEnabled",null),h([p({readOnly:!0})],$t.prototype,"hoveredPoints",null),h([p({readOnly:!0})],$t.prototype,"statistics",null),h([p()],$t.prototype,"chartData",null),h([p()],$t.prototype,"visibleProfiles",null),h([p()],$t.prototype,"minDemResolutions",null),h([p({readOnly:!0})],$t.prototype,"minDemResolution",null),h([p({readOnly:!0})],$t.prototype,"errorState",null),h([p(gWe)],$t.prototype,"defaultUnit",void 0),h([p()],$t.prototype,"queue",void 0),h([p()],$t.prototype,"tileCache",null),h([p()],$t.prototype,"tool",void 0),h([p()],$t.prototype,"visible",null),h([p()],$t.prototype,"error",void 0),h([p()],$t.prototype,"inputIsSketched",null),h([p()],$t.prototype,"elevationProvider",null),h([p()],$t.prototype,"updating",null),h([p()],$t.prototype,"_defaultProfileLineGround",void 0),h([p()],$t.prototype,"_userUnitOptions",void 0),h([p()],$t.prototype,"_controller",void 0),h([p()],$t.prototype,"_userUnit",void 0),$t=h([P("esri.widgets.ElevationProfile.ElevationProfileViewModel")],$t);const UZ=Symbol("updating-object"),Tfe=$t;let ec=class extends ye{constructor(){super(...arguments),this.legend=!0,this.chart=!0,this.clearButton=!0,this.settingsButton=!0,this.sketchButton=!0,this.selectButton=!0,this.unitSelector=!0,this.uniformChartScalingToggle=!0}};h([p()],ec.prototype,"legend",void 0),h([p()],ec.prototype,"chart",void 0),h([p()],ec.prototype,"clearButton",void 0),h([p()],ec.prototype,"settingsButton",void 0),h([p()],ec.prototype,"sketchButton",void 0),h([p()],ec.prototype,"selectButton",void 0),h([p()],ec.prototype,"unitSelector",void 0),h([p()],ec.prototype,"uniformChartScalingToggle",void 0),ec=h([P("esri.widgets.ElevationProfile.ElevationProfileVisibleElements")],ec);const Ife=ec;function pB(t,e,i){return t.units[e][i]}function Vu(t,e,i,n=2,r="abbr"){return`${Ns(e,{minimumFractionDigits:n,maximumFractionDigits:n,signDisplay:e>0?"never":"exceptZero"})} ${pB(t,i,r)}`}function kk(t,e,i,n=2,r="abbr"){return`${Ns(e,{minimumFractionDigits:n,maximumFractionDigits:n,signDisplay:"exceptZero"})} ${pB(t,i,r)}`}function q0t(t,e,i,n=2,r="abbr"){const s=c6(e,i);return Vu(t,ht(e,i,s),s,n,r)}function W0t(t,e,i,n=2,r="abbr"){const s=c6(e,i);return kk(t,ht(e,i,s),s,n,r)}function J0t(t,e,i,n=2,r="abbr"){const s=u6(e,i);return Vu(t,ht(e,i,s),s,n,r)}function Z0t(t,e,i,n=2,r="abbr"){const s=u6(e,i);return kk(t,ht(e,i,s),s,n,r)}function Y0t(t,e,i,n=2,r="abbr"){const s=h6(e,i);return Vu(t,ht(e,i,s),s,n,r)}function X0t(t,e,i,n=2,r="abbr"){const s=h6(e,i);return kk(t,ht(e,i,s),s,n,r)}function K0t(t,e,i,n=2,r="abbr"){const s=d6(e,i);return Vu(t,ht(e,i,s),s,n,r)}function Q0t(t,e,i,n=2,r="abbr"){const s=d6(e,i);return kk(t,ht(e,i,s),s,n,r)}function evt(t,e,i,n=2,r="abbr"){const s=qve(e,i);return Vu(t,ht(e,i,s),s,n,r)}function tvt(t,e,i,n=2,r="abbr"){const s=Wve(e,i);return Vu(t,ht(e,i,s),s,n,r)}function GZ(t,e,i,n,r){r=r??2;let s=rne.normalize(ZXe(ht(t,e,"degrees"),i,n),0,!0);const o={style:"unit",unitDisplay:"narrow",unit:"degree",maximumFractionDigits:r,minimumFractionDigits:r,signDisplay:s>0?"never":"exceptZero"};return s=Cfe(s,o),Ns(s,o)}function ivt(t,e,i,n,r){i!==n&&(t=-t);const s={style:"unit",unitDisplay:"narrow",unit:"degree",maximumFractionDigits:r=r??2,minimumFractionDigits:r,signDisplay:"exceptZero"};let o=ht(t,e,"degrees")%360;return o=Cfe(o,s),Ns(o,s)}const HZ=new Map;function Cfe(t,e){const i=JSON.stringify(e);let n=HZ.get(i);return n||(n=new Intl.NumberFormat("en-US",e),HZ.set(i,n)),/\-?\+?360/.test(n.format(t))?0:t}function ZXe(t,e,i){if(e===i)return t;switch(i){case"arithmetic":return YXe(t);case"geographic":return XXe(t)}}function YXe(t){return 90-t}function XXe(t){return-t-90}const qZ=["B","kB","MB","GB","TB"];function nvt(t,e){let i=e===0?0:Math.floor(Math.log(e)/Math.log(Yy.KILOBYTES));i=rr(i,0,qZ.length-1);const n=Ns(e/Yy.KILOBYTES**i,{maximumFractionDigits:2});return pl(t.units.bytes[qZ[i]],{fileSize:n})}const KXe=100;let Dg=class extends qi{constructor(e,i){super(e,i),this._updateLayout=n=>{const r=n.parentElement,s=n.style.display;r==null||r.removeChild(n),document.body.appendChild(n),n.style.display="block";let o=80;for(const a of n.childNodes)a instanceof HTMLElement&&(o=Math.max(o,a.offsetWidth));document.body.removeChild(n),r==null||r.appendChild(n),n.style.display=s,n.style.setProperty("--max-width",`${o}px`)},this._updateLayoutThrottled=Nde(this._updateLayout,KXe)}initialize(){this.addHandles(this._updateLayoutThrottled)}render(){return O("div",{bind:this,class:xm.base,afterCreate:this._updateLayout,afterUpdate:this._updateLayoutThrottled},this._renderStatistics())}_renderStatistics(){var i;const e=(i=this._messages)==null?void 0:i.statistics;return e?[this._renderDistanceStatistic("maxDistance",e.maxDistance),this._renderElevationStatistic("elevationGain",e.gain),this._renderElevationStatistic("elevationLoss",e.loss),this._renderElevationStatistic("minElevation",e.minElevation),this._renderElevationStatistic("maxElevation",e.maxElevation),this._renderElevationStatistic("avgElevation",e.avgElevation),this._renderSlopeStatistic("maxPositiveSlope","maxNegativeSlope",e.maxSlope),this._renderSlopeStatistic("avgPositiveSlope","avgNegativeSlope",e.avgSlope)]:[]}_renderDistanceStatistic(e,i){const n=Os().formatPrecision,r=this._renderValue(e,s=>{const o=this.effectiveUnits.distance;return Vu(this._messagesUnits,s,o,n)});return this._renderStatistic(i,r)}_renderElevationStatistic(e,i){const n=Os().formatPrecision,r=this._renderValue(e,s=>{const o=this.effectiveUnits.elevation;return Vu(this._messagesUnits,s,o,n)});return this._renderStatistic(i,r)}_renderSlopeStatistic(e,i,n){const r=Os().formatPrecision,s=O("div",{key:"slope-up",class:xm.slopeValue},O("div",{class:xm.slopeUpIcon}),this._renderValue(e,o=>GZ(o,"degrees","geographic","geographic",r)),O("div",{class:xm.slopeDownIcon}),this._renderValue(i,o=>GZ(o,"degrees","geographic","geographic",r)));return this._renderStatistic(n,s)}_renderStatistic(e,i){return O("div",{class:xm.statistic},O("label",{class:xm.statisticLabel},e),O("div",{class:xm.statisticValue},i))}_renderValue(e,i){const n=this.line,r=n.progress===1?n.statistics:null,s=ot(r,o=>o[e]);return s!=null?i(s):Kde}};h([p()],Dg.prototype,"effectiveUnits",void 0),h([p()],Dg.prototype,"line",void 0),h([p(),Zt("esri/widgets/ElevationProfile/t9n/ElevationProfile")],Dg.prototype,"_messages",void 0),h([p(),Zt("esri/core/t9n/Units")],Dg.prototype,"_messagesUnits",void 0),Dg=h([P("esri.widgets.ElevationProfile.Statistics")],Dg);function az(t,{profiles:e}){const i=t.title;if(i!=null)return i;switch(t.type){case"ground":return e.ground;case"input":return e.input;case"query":return e.query;case"view":return e.view;default:return""}}let tc=class extends qi{constructor(e,i){super(e,i),this.expanded=!1,this.checkboxVisible=!0,this._messages=null}initialize(){this._statistics=new Dg(this._statisticsProps),this.addHandles(Q(()=>this._statisticsProps,e=>this._statistics.set(e)))}destroy(){this._statistics=Je(this._statistics)}render(){const e=this.expanded;return O("div",{key:this,class:this.classes($a.base,{[$a.disabled]:this.disabled,[$a.expanded]:e})},this._renderColorIndicator(),O("div",{key:"header",class:$a.header},this._renderLabelWithCheckbox(),this._renderCollapseToggleButton()),e&&O("div",{key:"content",class:$a.content},this._statistics.render()))}get disabled(){return!this.line.available}get _statisticsProps(){return{line:this.line,effectiveUnits:this.effectiveUnits}}_renderColorIndicator(){return O("div",{key:"color-indicator",class:$a.colorIndicator,styles:{backgroundColor:this.line.color.toCss()}})}_renderCollapseToggleButton(){const e=this._messages,i=this.expanded?e.hideDetails:e.showDetails;return O("button",{key:"collapse-toggle",bind:this,class:$a.collapseToggle,onclick:this._onCollapseToggleClick,title:i,"aria-label":i,type:"button"},O("span",{class:$a.collapseToggleIcon}))}_onCollapseToggleClick(){this.onExpandedToggle()}_renderLabelWithCheckbox(){const{line:e,checkboxVisible:i,disabled:n}=this,r=`${$a.base}__check-${e.id}`;return O("label",{key:"id",for:r,class:this.classes($a.label,{[$a.labelDisabled]:n||!i})},i&&this._renderCheckbox(r),O("span",null,az(e,this._messages)))}_renderCheckbox(e){const i=this.line,n=i.visible,r=this.disabled,s=this._messages,o=n?s.hideProfile:s.showProfile,a=az(i,this._messages),l=Ru(o,{name:a});return O("input",{key:"checkbox",id:e,type:"checkbox",class:$a.checkbox,title:l,checked:n,disabled:r,"aria-label":l,bind:this,onchange:c=>this._onCheckboxToggle(c,i)})}_onCheckboxToggle(e,i){e.stopPropagation(),i.toggleVisibility()}};h([p({nonNullable:!0})],tc.prototype,"effectiveUnits",void 0),h([p({nonNullable:!0})],tc.prototype,"line",void 0),h([p()],tc.prototype,"expanded",void 0),h([p()],tc.prototype,"disabled",null),h([p()],tc.prototype,"checkboxVisible",void 0),h([p()],tc.prototype,"onExpandedToggle",void 0),h([p()],tc.prototype,"_statistics",void 0),h([p(),Zt("esri/widgets/ElevationProfile/t9n/ElevationProfile")],tc.prototype,"_messages",void 0),tc=h([P("esri.widgets.ElevationProfile.LegendItem")],tc);let Ng=class extends qi{constructor(e,i){super(e,i),this._items=new xe,this._expandedLine=null}initialize(){this.addHandles([Q(()=>this.profiles,e=>{this._destroyItems(),this._items.addMany(e.map(i=>this._createItemForLine(i)))},He),Q(()=>this.effectiveUnits,e=>{this._items.forEach(i=>{i.effectiveUnits=e})},He)])}destroy(){this._destroyItems()}render(){return O("div",{class:pWe.base},this._items.toArray().map(e=>e.render()))}_onExpandedToggle(e){this._expandedLine=e===this._expandedLine?null:e,this._items.forEach(i=>i.expanded=i.line===this._expandedLine)}_createItemForLine(e){return new tc({line:e,effectiveUnits:this.effectiveUnits,expanded:e===this._expandedLine,checkboxVisible:this.profiles.length>1,onExpandedToggle:()=>this._onExpandedToggle(e)})}_destroyItems(){this._items.drain(e=>e.destroy())}};h([p()],Ng.prototype,"profiles",void 0),h([p()],Ng.prototype,"effectiveUnits",void 0),h([p()],Ng.prototype,"_items",void 0),h([p()],Ng.prototype,"_expandedLine",void 0),Ng=h([P("esri.widgets.ElevationProfile.Legend")],Ng);let Fg=class extends qi{constructor(e,i){super(e,i),this._popover=null,this._buttonElement=null,this._focusOutElement=null,this._requestFocusOnCreate=!1}destroy(){this._destroyPopover()}render(){const{unitSelector:e,uniformChartScalingToggle:i}=this.visibleElements;if(!e&&!i)return O("div",{key:`${this.id}-empty`});const n=this._popover!=null&&this._popover.open?this._messages.hideSettings:this._messages.showSettings;return O("button",{class:Tm.base,title:n,bind:this,afterCreate:this._initializePopover,onclick:this._togglePopover,"aria-label":n,type:"button"})}_initializePopover(e){this._destroyPopover(),this._buttonElement=e,this._popover=new i8({owner:this,placement:"bottom-end",offset:[0,0],anchorElement:e,renderContentFunction:()=>this._renderPopoverContent()})}_destroyPopover(){this._focusOutElement=Ri(this._focusOutElement),this._popover=Je(this._popover)}_renderPopoverContent(){const{unitSelector:e,uniformChartScalingToggle:i}=this.visibleElements;return O("div",{class:Tm.popoverContent,dir:ore(this._buttonElement),bind:this,afterCreate:this._onPopoverContentAfterCreate},e&&this._renderUnitSelector(),i&&this._renderUniformChartScalingToggle())}_renderUnitSelector(){const{unit:e,unitOptions:i}=this.viewModel,n=this._messagesUnits;return O("label",{key:"unit-selector-label",class:Tm.selectLabel},this._messages.unitSelectLabel,O("select",{class:Tm.select,value:e,bind:this,onchange:this._onUnitChange,afterCreate:this._onUnitSelectAfterCreate},i.map(r=>O("option",{key:r,value:r},Uve(r)?n.systems[r]:n.units[r].pluralCapitalized))))}_onUnitChange(e){this.viewModel.unit=e.target.value}_onUnitSelectAfterCreate(e){this._requestFocusOnCreate&&(this._requestFocusOnCreate=!1,e.focus())}_renderUniformChartScalingToggle(){const e=this._messages,i=this.viewModel.uniformChartScaling,n=i?e.uniformChartScalingDisable:e.uniformChartScalingEnable;return O("label",{key:"uniform-chart-scaling-label",class:Tm.checkboxLabel,onmousedown:QXe},O("input",{class:this.classes(Tm.checkbox,Tm.uniformChartScalingCheckbox),type:"checkbox",checked:i,title:n,"aria-label":n,bind:this,onchange:this._onUniformChartScalingChange}),e.uniformChartScalingLabel)}_onUniformChartScalingChange(e){this.viewModel.uniformChartScaling=e.target.checked}_togglePopover(e){this._popover!=null&&this._popover.open?this._closePopover():this._openPopover()}_openPopover(){ot(this._popover,e=>e.open=!0),this._requestFocusOnCreate=!0}_closePopover({focusOnButton:e=!0}={}){ot(this._popover,i=>i.open=!1),e&&ot(this._buttonElement,i=>i.focus())}_onPopoverContentAfterCreate(e){Ri(this._focusOutElement),this._focusOutElement=Lh(e,"focusout",({relatedTarget:i})=>{const n=e.contains(i),r=i===this._buttonElement;n||r||this._closePopover({focusOnButton:!1})})}};function QXe(t){t.preventDefault()}h([p()],Fg.prototype,"viewModel",void 0),h([p()],Fg.prototype,"visibleElements",void 0),h([p(),Zt("esri/widgets/ElevationProfile/t9n/ElevationProfile")],Fg.prototype,"_messages",void 0),h([p(),Zt("esri/core/t9n/Units")],Fg.prototype,"_messagesUnits",void 0),Fg=h([P("esri.widgets.ElevationProfile.SettingsButton")],Fg);function eKe(t,e,i=10){const n=WZ(e-t,!1);if(n===0)return[t,e];const r=WZ(n/(i-1),!0);return[Math.floor(t/r)*r,Math.ceil(e/r)*r]}function WZ(t,e){const i=Math.floor(Math.log10(t)),n=t/10**i;let r;return r=e?n<1.5?1:n<3?2:n<5?2.5:n<7?5:10:n<=1?1:n<=2?2:n<=3?2.5:n<=5?5:10,r*10**i}const JZ="en-us",fB=new Map([["ar",()=>Y(()=>import("./ar-dc69a97f.js"),["./ar-dc69a97f.js","./_commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.a)],["bg-bg",()=>Y(()=>import("./bg_BG-259533d5.js"),["./bg_BG-259533d5.js","./_commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.b)],["bs-ba",()=>Y(()=>import("./bs_BA-df67ca2b.js"),["./bs_BA-df67ca2b.js","./_commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.b)],["ca-es",()=>Y(()=>import("./ca_ES-e99400fb.js"),["./ca_ES-e99400fb.js","./_commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.c)],["cs-cz",()=>Y(()=>import("./cs_CZ-74c0b41a.js"),["./cs_CZ-74c0b41a.js","./_commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.c)],["da-dk",()=>Y(()=>import("./da_DK-07d4c33e.js"),["./da_DK-07d4c33e.js","./_commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.d)],["de-de",()=>Y(()=>import("./de_DE-71e8c114.js"),["./de_DE-71e8c114.js","./_commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.d)],["de-ch",()=>Y(()=>import("./de_CH-f83a7d0e.js"),["./de_CH-f83a7d0e.js","./_commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.d)],["el-gr",()=>Y(()=>import("./el_GR-ca5b23e3.js"),["./el_GR-ca5b23e3.js","./_commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.e)],["en-us",()=>Y(()=>import("./en_US-27d36088.js"),["./en_US-27d36088.js","./_commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.e)],["en-ca",()=>Y(()=>import("./en_CA-27d36088.js"),["./en_CA-27d36088.js","./_commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.e)],["es-es",()=>Y(()=>import("./es_ES-15e9df8a.js"),["./es_ES-15e9df8a.js","./_commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.e)],["et-ee",()=>Y(()=>import("./et_EE-3f8b6eeb.js"),["./et_EE-3f8b6eeb.js","./_commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.e)],["fi-fi",()=>Y(()=>import("./fi_FI-76dd8a81.js"),["./fi_FI-76dd8a81.js","./_commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.f)],["fr-fr",()=>Y(()=>import("./fr_FR-65f73278.js"),["./fr_FR-65f73278.js","./_commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.f)],["he-il",()=>Y(()=>import("./he_IL-f47b976f.js"),["./he_IL-f47b976f.js","./_commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.h)],["hr-hr",()=>Y(()=>import("./hr_HR-0213dc48.js"),["./hr_HR-0213dc48.js","./_commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.h)],["hu-hu",()=>Y(()=>import("./hu_HU-9c930e18.js"),["./hu_HU-9c930e18.js","./_commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.h)],["id-id",()=>Y(()=>import("./id_ID-564423b7.js"),["./id_ID-564423b7.js","./_commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.i)],["it-it",()=>Y(()=>import("./it_IT-28a33c73.js"),["./it_IT-28a33c73.js","./_commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.i)],["ja-jp",()=>Y(()=>import("./ja_JP-a2e37870.js"),["./ja_JP-a2e37870.js","./_commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.j)],["ko-kr",()=>Y(()=>import("./ko_KR-cba864ee.js"),["./ko_KR-cba864ee.js","./_commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.k)],["lt-lt",()=>Y(()=>import("./lt_LT-b2b8e47f.js"),["./lt_LT-b2b8e47f.js","./_commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.l)],["lv-lv",()=>Y(()=>import("./lv_LV-95fb59c2.js"),["./lv_LV-95fb59c2.js","./_commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.l)],["nb-no",()=>Y(()=>import("./nb_NO-ea136269.js"),["./nb_NO-ea136269.js","./_commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.n)],["nl-nl",()=>Y(()=>import("./nl_NL-9b7a3198.js"),["./nl_NL-9b7a3198.js","./_commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.n)],["pl-pl",()=>Y(()=>import("./pl_PL-53c55eff.js"),["./pl_PL-53c55eff.js","./_commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.p)],["pt-br",()=>Y(()=>import("./pt_BR-f28c82ff.js"),["./pt_BR-f28c82ff.js","./_commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.p)],["pt-pt",()=>Y(()=>import("./pt_PT-23f227c1.js"),["./pt_PT-23f227c1.js","./_commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.p)],["ro-ro",()=>Y(()=>import("./ro_RO-2e60ab11.js"),["./ro_RO-2e60ab11.js","./_commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.r)],["ru-ru",()=>Y(()=>import("./ru_RU-81f9717f.js"),["./ru_RU-81f9717f.js","./_commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.r)],["sk-sk",()=>Y(()=>import("./sk_SK-f029de4a.js"),["./sk_SK-f029de4a.js","./_commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.s)],["sl-sl",()=>Y(()=>import("./sl_SL-37772a2d.js"),["./sl_SL-37772a2d.js","./_commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.s)],["sr-rs",()=>Y(()=>import("./sr_RS-1eb98fe3.js"),["./sr_RS-1eb98fe3.js","./_commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.s)],["sv-se",()=>Y(()=>import("./sv_SE-1f9851a6.js"),["./sv_SE-1f9851a6.js","./_commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.s)],["th-th",()=>Y(()=>import("./th_TH-86117c45.js"),["./th_TH-86117c45.js","./_commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.t)],["tr-tr",()=>Y(()=>import("./tr_TR-06246dda.js"),["./tr_TR-06246dda.js","./_commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.t)],["uk-ua",()=>Y(()=>import("./uk_UA-5e6d5a9a.js"),["./uk_UA-5e6d5a9a.js","./_commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.u)],["vi-vn",()=>Y(()=>import("./vi_VN-3b11c20c.js"),["./vi_VN-3b11c20c.js","./_commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.v)],["zh-cn",()=>Y(()=>import("./zh_Hans-af52e653.js"),["./zh_Hans-af52e653.js","./_commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.z)],["zh-hk",()=>Y(()=>import("./zh_Hant-21a928e4.js"),["./zh_Hant-21a928e4.js","./_commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.z)],["zh-tw",()=>Y(()=>import("./zh_Hant-21a928e4.js"),["./zh_Hant-21a928e4.js","./_commonjs-dynamic-modules-42bbacb3.js"],import.meta.url).then(t=>t.z)]]);function tKe(t){const e=t.split("-")[0].toLowerCase();let i=null;for(const n of fB.keys())if(n.startsWith(e)){i=n;break}return i}function iKe(t){return t?fB.has(t.toLowerCase())?t.toLowerCase():tKe(t)||JZ:JZ}let iv=null,K1=null;async function nKe(t=xr()){if(t=iKe(t),iv&&t===K1)return iv;iv=Y(()=>import("./index-3e5092a5.js"),[],import.meta.url).then(e=>e.i),K1=t;try{const[e,i]=await Promise.all([iv,fB.get(K1)()]);K1===t&&(e.am4core.options.defaultLocale=i.default),e.am4core.options.suppressWarnings=!0,e.am4core.options.autoDispose=!0}catch{return iv=null,K1=null,null}return iv}const O$="#f8f8f8",Mfe="#a9a9a9",m2="#323232",rKe="line",sKe="fill",Q1=15,IC=12,oKe=30,ZZ=.001,aKe=.5,lKe=.5,YZ=30,cKe=.02,uKe=.02,Efe={sideSpacing:Q1,paddingBottom:0,paddingLeft:0,paddingRight:0,paddingTop:0,axisFontSize:9,axisFontWeight:"400",axisGridStroke:"#f4f4f4",axisLabelsFontSize:9,axisLabelsFontWeight:"400",axisLabelsColor:Mfe,axisTooltipFontSize:12,axisTooltipBackgroundColor:m2,axisTooltipLabelColor:O$,axisTooltipPaddingTop:Math.round(IC/4),axisTooltipPaddingBottom:Math.round(IC/4),axisTooltipPaddingHorizontal:Math.round(Q1/4),xAxisMinGridDistance:50,xAxisLabelsSpacing:Math.round(IC/2),xAxisMinLabelPosition:.05,xAxisMaxLabelPosition:.9,yAxisMinGridDistance:30,yAxisLabelSpacing:Math.round(Q1/4),yAxisMinLabelPosition:0,yAxisMaxLabelPosition:.8,seriesTooltipFontSize:12,seriesTooltipBackgroundColor:O$,seriesTooltipLabelColor:m2,seriesFillLighten:.9,seriesTooltipSpacing:IC/2,seriesTooltipPaddingVertical:Math.round(Q1/4),seriesTooltipPaddingHorizontal:Math.round(Q1/4),tooltipBorderRadius:0},hKe={...Efe,axisGridStroke:m2,axisLabelsColor:Mfe,axisTooltipBackgroundColor:m2,axisTooltipLabelColor:O$,seriesTooltipBackgroundColor:m2,seriesTooltipLabelColor:O$,seriesFillLighten:-.75},lz={minX:void 0,maxX:void 0,minY:void 0,maxY:void 0};async function dKe(t){const e=await nKe();if(!e)throw new V("elevation-profile:load-failed","Could not load amCharts");const{am4core:i,am4charts:n}=e;Vt(t.abortOptions);const{options:r}=i;r.minPolylineStep=aKe,r.autoSetClassName=!0,r.animationsEnabled=!1;const s=jV(),o=s?hKe:Efe;s&&i.useTheme(e.am4themes_dark);const a=i.create(t.container,n.XYChart);a.arrangeTooltips=!1,a.preloader.disabled=!0,a.zoomOutButton.disabled=!0;const l=Mc(t.container);a.rtl=l,a.padding(o.paddingTop,l?o.paddingLeft:o.paddingRight,o.paddingBottom,l?o.paddingRight:o.paddingLeft);const c=a.plotContainer.background;c.strokeWidth=0,c.strokeOpacity=0,c.stroke=null;const u=a.xAxes.push(new n.ValueAxis),d=a.yAxes.push(new n.ValueAxis),f={params:t,amCharts4Index:e,amChart:a,xAxis:u,yAxis:d,series:new Map,data:null,messages:null,theme:o,zooming:!1,pointerIsOver:!1};a.cursor=pKe(f),fKe(f),mKe(f),gKe(f);const m=[TKe(f,t.onRangeChange),CKe(f,t.onCursorPositionChange),IKe(f)];let g=null,y=!1;const _=()=>{g!=null&&(typeof window<"u"&&"cancelIdleCallback"in window?window.cancelIdleCallback(g):clearTimeout(g),g=null)};return{...f,destroy(){y=!0,_(),$c(m).remove(),a.dispose()},update(b){if(b.data===f.data&&b.messages===f.messages||(_(),y))return;const w=()=>{y||(g=null,yKe(f,b))};g=typeof window<"u"&&"requestIdleCallback"in window?window.requestIdleCallback(w,{timeout:YZ}):setTimeout(w,YZ)},zoomOut(){y||(f.yAxis.zoom({start:0,end:1},!1,!0),f.xAxis.zoom({start:0,end:1},!1,!0))}}}function pKe(t){const e=new t.amCharts4Index.am4charts.XYCursor;return e.trackable=!0,e.lineY.disabled=!0,e.behavior="zoomXY",e}function fKe(t){const e=t.theme,i=t.amChart.tooltip,{am4core:n}=t.amCharts4Index;i.id="series-tooltip",i.fitPointerToBounds=!0,i.pointerOrientation="vertical",i.zIndex=-1,i.getFillFromObject=!1,i.label.fontSize=e.seriesTooltipFontSize,i.label.fill=n.color(e.seriesTooltipLabelColor),i.label.padding(e.seriesTooltipPaddingVertical,e.seriesTooltipPaddingHorizontal,e.seriesTooltipPaddingVertical,e.seriesTooltipPaddingHorizontal),i.background.cornerRadius=e.tooltipBorderRadius,i.background.stroke=null,i.background.fill=n.color(e.seriesTooltipBackgroundColor),i.background.padding(0,0,0,0),i.adapter.add("dy",()=>e.seriesTooltipSpacing*(i.background.pointerY<=0?1:-1)),Mc(t.params.container)&&(i.label.textAlign="middle")}function mKe(t){const{xAxis:e,theme:i}=t,{am4core:n}=t.amCharts4Index;e.numberFormatter=$fe(t,"distance"),e.strictMinMax=!0,e.cursorTooltipEnabled=!1,e.title.visible=!1;const r=e.renderer;r.line.visible=!1,r.minGridDistance=i.xAxisMinGridDistance,r.minLabelPosition=i.xAxisMinLabelPosition,r.maxLabelPosition=i.xAxisMaxLabelPosition,r.fontWeight=i.axisFontWeight,r.fontSize=i.axisFontSize,r.baseGrid.disabled=!0;const s=r.labels.template;s.fontSize=i.axisLabelsFontSize,s.fontWeight=i.axisLabelsFontWeight,s.fill=n.color(i.axisLabelsColor),s.paddingTop=i.xAxisLabelsSpacing,s.horizontalCenter="left",s.paddingLeft=0;const o=e.tooltip;o.id="axis-tooltip",o.background.fill=n.color(i.axisTooltipBackgroundColor),o.background.stroke=null,o.background.padding(0,0,0,0),o.label.fontSize=i.axisTooltipFontSize,o.label.fill=n.color(i.axisTooltipLabelColor),o.label.padding(i.axisTooltipPaddingTop,i.axisTooltipPaddingHorizontal,i.axisTooltipPaddingBottom,i.axisTooltipPaddingHorizontal);const a=r.grid.template;a.strokeOpacity=1,a.stroke=n.color(i.axisGridStroke)}function gKe(t){const{yAxis:e,theme:i}=t,{am4core:n}=t.amCharts4Index;e.numberFormatter=$fe(t,"elevation"),e.title.visible=!1,e.cursorTooltipEnabled=!1,e.strictMinMax=!0,e.baseValue=Os().noDataValue;const r=e.renderer;r.inside=!0,r.line.opacity=0,r.line.visible=!1,r.minGridDistance=i.yAxisMinGridDistance,r.minLabelPosition=i.yAxisMinLabelPosition,r.maxLabelPosition=i.yAxisMaxLabelPosition,r.fontWeight=i.axisFontWeight,r.fontSize=i.axisFontSize,r.baseGrid.disabled=!0;const s=r.labels.template;s.fontSize=i.axisLabelsFontSize,s.fontWeight=i.axisLabelsFontWeight,s.fill=n.color(i.axisLabelsColor),s.verticalCenter="bottom",s.paddingLeft=i.yAxisLabelSpacing,s.paddingBottom=0;const o=r.grid.template;o.strokeOpacity=1,o.stroke=n.color(i.axisGridStroke),Mc(t.params.container)&&(r.opposite=!0,s.textAlign="middle",s.paddingLeft=0,s.paddingRight=i.yAxisLabelSpacing)}function yKe(t,{data:e,messages:i}){const{htmlContainer:n}=t.amChart;if(!n)return;const r=e!=null&&e.refined;t.amChart.cursor.disabled=!r,n.classList.toggle(dWe.cursorEnabled,r);const s=t.data!==e,o=ot(t.data,a=>a.effectiveUnits)!==ot(e,a=>a.effectiveUnits);t.data=e,t.messages=i,s&&(vKe(t),bKe(t)),o&&(t.yAxis.invalidateLabels(),t.xAxis.invalidateLabels()),vS(t)}function vKe(t){const{xAxis:e,yAxis:i}=t,{minX:n,maxX:r,minY:s,maxY:o}=_Ke({data:t.data,pixelWidth:e.pixelWidth,pixelHeight:i.pixelHeight});e.min=n,e.max=r,i.min=s,i.max=o}function _Ke({data:t,pixelWidth:e,pixelHeight:i}){if(t==null)return lz;const n=t.statistics,r=0,s=ot(n,d=>d.maxDistance);let o=ot(n,d=>d.minElevation),a=ot(n,d=>d.maxElevation);if(s==null||o==null||a==null)return lz;const l=Math.max(s-r,ZZ);let c=Math.max(a-o,ZZ);const u=t.effectiveUnits;if(t.dynamicElevationRange){const d=ht(l,u.distance,u.elevation);c=Math.max(c,d/Os().maxChartRatio)}return o-=uKe*c,a=o+c+cKe*c,[o,a]=eKe(o,a,10),c=a-o,t.uniformScaling?Afe({data:t,bounds:{minX:r,maxX:s,minY:o,maxY:a},pixelWidth:e,pixelHeight:i,centered:!0}):{minX:r,maxX:r+l,minY:o,maxY:o+c}}function Afe({data:t,bounds:e,pixelWidth:i,pixelHeight:n,centered:r}){if(t==null)return e;let{minX:s,maxX:o,minY:a,maxY:l}=e;if(s==null||o==null||a==null||l==null)return lz;const c=o-s,u=l-a,d=t.effectiveUnits,f=ht(u,d.elevation,d.distance)/n/(c/i);return f>=1?[s,o]=XZ([s,o],f,r):[a,l]=XZ([a,l],1/f,r),{minX:s,maxX:o,minY:a,maxY:l}}function XZ([t,e],i,n){const r=(e-t)*i;if(n){const s=(t+e)/2-r/2;return[s,s+r]}return[t,t+r]}function bKe(t){const{amChart:e,data:i}=t;if(i==null||i.lines.length===0)return void e.series.clear();const n=new Map,r=new Set(e.series.values),s=i.lines.length;for(let o=0;o<s;o++){const a=i.lines[o];let l=t.series.get(a.id);l?(ot(l.fill,u=>r.delete(u)),r.delete(l.line)):(l=SKe(t,a),ot(l.fill,u=>e.series.push(u)),e.series.push(l.line)),n.set(l.id,l);const c=s-o-1;ot(l.fill,u=>u.zIndex=c),l.line.zIndex=s+c,wKe(t,l,a)}t.series=n;for(const o of r)e.series.removeValue(o)}function wKe(t,{line:e,fill:i},n){const{theme:r}=t,{am4core:s}=t.amCharts4Index,{r:o,g:a,b:l,a:c}=n.color,u=s.color({r:o,g:a,b:l,a:c}),d=n.samples??new Array,f=d.length>0;e.stroke=u,e.visible=f,ot(i,y=>{y.visible=f,y.fill=u.lighten(r.seriesFillLighten)});const m=d.length,g=e.data;if(g.length===m){let y=!1;for(let _=0;_<m;++_){const b=g[_],w=d[_];y=y||b.elevation!=null!=(w.elevation!=null),xKe(b,w)}y?(e.invalidateData(),ot(i,_=>_.invalidateData())):(e.invalidateRawData(),ot(i,_=>_.invalidateRawData()))}else e.data=d,ot(i,y=>y.data=d)}function xKe(t,e){t.x=e.x,t.y=e.y,t.z=e.z,t.distance=e.distance,t.elevation=e.elevation}function SKe(t,e){const{id:i}=e,n=KZ(t,`${rKe}-${i}`);n.strokeWidth=e.chartStrokeWidth,n.dy=e.chartStrokeOffsetY;let r=null;return e.chartFillEnabled&&(r=KZ(t,`${sKe}-${i}`),r.fillOpacity=1),{id:i,line:n,fill:r}}function KZ(t,e){const i=new t.amCharts4Index.am4charts.LineSeries;i.id=e,i.showOnInit=!1,i.simplifiedProcessing=!0,i.minDistance=lKe,i.excludeFromTotal=!0,i.clickable=!1,i.contextMenuDisabled=!0,i.cursorHoverEnabled=!1,i.cursorTooltipEnabled=!1,i.connect=!1,i.fill=null,i.stroke=null;const n="distance";i.dataFields.valueX=n;const r="elevation";return i.dataFields.valueY=r,i}function TKe(t,e){const{amChart:i,xAxis:n,yAxis:r}=t;let s=!1;const o=()=>{const{data:u}=t;if(!s||u==null||!u.uniformScaling)return;s=!1;const{minX:d,maxX:f,minY:m,maxY:g}=Afe({data:t.data,bounds:{minX:n.minZoomed,maxX:n.maxZoomed,minY:r.minZoomed,maxY:r.maxZoomed},pixelWidth:n.pixelWidth,pixelHeight:r.pixelHeight,centered:!0});d!=null&&f!=null&&n.zoomToValues(d,f,!0),m!=null&&g!=null&&r.zoomToValues(m,g,!0),i.validate(),vS(t)},a=()=>{e(t.xAxis.zoomFactor,t.yAxis.zoomFactor)},l=u=>{t.zooming=u,vS(t)},c=[i.events.on("down",()=>l(!0)),i.events.on("up",()=>l(!1)),i.cursor.events.on("zoomended",()=>{s=!0}),n.events.on("startendchanged",o),r.events.on("startendchanged",o),n.events.on("rangechangeended",a),r.events.on("rangechangeended",a)];return br(()=>{c.forEach(u=>u.dispose())})}function IKe({xAxis:t,yAxis:e}){const i=r=>()=>{r.renderer.grid.each(s=>{s.visible=s.dataItem.label.dom.getAttribute("display")!=="none"})},n=[t.events.on("rangechangeended",i(t)),t.events.on("validated",i(t)),e.events.on("rangechangeended",i(e)),e.events.on("validated",i(e))];return br(()=>{n.forEach(r=>r.dispose())})}function CKe(t,e){const{amChart:i,xAxis:n,yAxis:r}=t,{cursor:s,events:o}=i,a=u=>{t.pointerIsOver=u,vS(t)},l=()=>{a(!1),e(null,null)},c=[s.events.on("cursorpositionchanged",()=>{if(!t.pointerIsOver)return;vS(t);let u=n.toAxisPosition(s.xPosition),d=r.toAxisPosition(s.yPosition);const f=t.data;if(f!=null&&f.statistics!=null){const{maxDistance:m,minElevation:g,maxElevation:y}=f.statistics;m!=null&&(u=QZ(u,n.minZoomed,n.maxZoomed,0,m)),g!=null&&y!=null&&(d=QZ(d,r.minZoomed,r.maxZoomed,g,y))}e(u,d)}),o.on("over",()=>a(!0)),o.on("out",l),o.on("blur",l)];return br(()=>{c.forEach(u=>u.dispose())})}function QZ(t,e,i,n,r){return(e+t*(i-e)-n)/(r-n)}function vS(t){const{amChart:e,xAxis:i,data:n,theme:r,zooming:s,pointerIsOver:o}=t;if(t.amChart.tooltip.hide(),t.xAxis.hideTooltip(),!o||s||n==null||!n.refined)return;const a=MKe(t);if(a!=null){const{cursor:l}=e,c=e.tooltip;l.show(0),l.validate(),c.text=a.text,c.show(0),c.validate();const u=a.y-c.contentHeight-r.seriesTooltipSpacing;c.pointerOrientation=u<oKe?"up":"down",c.pointTo(a,!0),c.validate();const d=i.tooltip;d.text=$Ke(t),d.show(0),d.validate()}}function MKe(t){const{amChart:e,yAxis:i,data:n}=t;if(n==null)return null;const r=n.lines.map(c=>({line:c,y:ot(Pfe(t,c),u=>u.elevation)})).sort(EKe),s=r.length?r[0].y:null;if(s==null)return null;const o=e.cursor,a=i.measuredHeight,l=a+e.pixelPaddingTop;return{text:r.map(({y:c,line:u})=>AKe(t,u,c)).join(`
`),x:o.point.x+o.parent.pixelX+e.pixelPaddingLeft,y:l-i.valueToPosition(s)*a}}function EKe({y:t},{y:e}){return t==null?1:e==null?-1:e-t}function AKe(t,e,i){const{data:n,messages:r}=t;if(n==null||r==null)return"";const s=Os().formatPrecision,o=Ru(r.chartTooltip,{name:az(e,r),elevation:i!=null?Vu(r,i,n.effectiveUnits.elevation,s):Kde});return`[${e.color.toHex()}][/] ${o}`}function $Ke(t){const{data:e,messages:i}=t;if(e==null||i==null)return"";const n=e.lines[0],r=n?Pfe(t,n):null,s=Os().formatPrecision;return r!=null?Vu(i,r.distance,e.effectiveUnits.distance,s):"-"}function $fe(t,e){const i=t.xAxis.numberFormatter.clone();return i.format=(n,r,s)=>{const{messages:o,data:a}=t;return o==null||a==null||typeof n=="string"?"":`${Ns(n,{maximumFractionDigits:s})} ${pB(o,a.effectiveUnits[e],"abbr")}`},i}function Pfe({amChart:t,xAxis:e},i){const n=i.samples??[];if(n.length===0)return null;const r=e.toAxisPosition(t.cursor.xPosition),s=e.positionToValue(r);return WX(n,s,o=>o.distance)}var Io;(function(t){t.Sketch="sketch",t.SketchCancel="sketch-cancel",t.SketchDone="sketch-done",t.Select="select",t.SelectCancel="select-cancel"})(Io||(Io={}));const ew=[{type:Io.Select},{type:Io.Sketch}],PKe={[Kn.None]:null,[Kn.NoValidInput]:"noProfile",[Kn.NoVisibleProfiles]:"noProfile",[Kn.RefinedButNoChartData]:"noProfile",[Kn.TooComplex]:"tooComplex",[Kn.UnknownError]:"unknown",[Kn.InvalidGeometry]:"invalidGeometry",[Kn.InvalidElevationInfo]:"invalidElevationInfo"},eY=Symbol("resize-observer-handle");let qt=class extends qi{constructor(e,i){super(e,i),this.viewModel=null,this.visibleElements=new Ife,this.iconClass=Mi.widgetIcon,this.icon=null,this.messages=null,this.messagesCommon=null,this.messagesUnits=null,this._chartContainer=null,this._chart=null,this._chartInitTask=null,this._chartIsRefined=!1,this._width=0,this._zoomOutButtonVisible=!1,this._getChartUpdateParamsMemoized=ol((n,r,s,o)=>({chart:n,data:r,stationary:s,messages:o})),this._getDetailsPropsMemoized=ol((n,r)=>({effectiveUnits:n,profiles:r})),e!=null&&e.viewModel||(this._defaultViewModel=new Tfe({view:e==null?void 0:e.view}),this.viewModel=this._defaultViewModel)}initialize(){this._legend=new Ng(this._legendProps),this._settingsButton=new Fg(this._settingsButtonProps),this.addHandles([Q(()=>this._legendProps,e=>this._legend.set(e)),Q(()=>this._settingsButtonProps,e=>this._settingsButton.set(e))])}postInitialize(){this.addHandles([Q(()=>({container:this._chartContainer,width:this._width}),({container:e,width:i})=>{this._destroyChart(),e!=null&&i>0&&this._initializeChart(e)},He),Q(()=>this._chartUpdateParams,()=>this._updateChart(this._chartUpdateParams),He)])}destroy(){this._destroyChart(),this._defaultViewModel!=null&&this.viewModel!==this._defaultViewModel&&this._defaultViewModel.destroy(),this._legend=Je(this._legend),this._settingsButton=Je(this._settingsButton)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}get input(){return this.viewModel.input}set input(e){this.viewModel.input=e}get profiles(){return this.viewModel.profiles}set profiles(e){this.viewModel.profiles=e}get unitOptions(){return this.viewModel.unitOptions}set unitOptions(e){this.viewModel.unitOptions=e}get unit(){return this.viewModel.unit}set unit(e){this.viewModel.unit=e}get geodesicDistanceThreshold(){return this.viewModel.geodesicDistanceThreshold}set geodesicDistanceThreshold(e){this.viewModel.geodesicDistanceThreshold=e}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get visible(){return this.viewModel.visible}set visible(e){this.viewModel.visible=e}get _portrait(){return this._width<Os().portraitModePixelBreakpoint}get _chartUpdateParams(){const e=this.view;return this._getChartUpdateParamsMemoized(this._chart,this.viewModel.chartData,e==null||e.stationary,this._chartMessages)}get _chartMessages(){return{...this.messagesUnits,...this.messages}}get _legendProps(){return this._getDetailsPropsMemoized(this.viewModel.effectiveUnits,this._profilesArray)}get _profilesArray(){return this.profiles.toArray()}get _settingsButtonProps(){return{viewModel:this.viewModel,visibleElements:this.visibleElements}}render(){const{viewModel:e,visible:i}=this;return O("div",{key:this,class:this.classes({[Mi.base]:i,[Mi.esriWidget]:i,[Mi.esriWidgetDisabled]:i&&e.state==="disabled",[Mi.portrait]:this._portrait,[Mi.refined]:e.progress===1}),"aria-label":this.messages.widgetLabel},O("div",{key:"content-wrapper",bind:this,afterCreate:this._onContentWrapperAfterCreate,afterRemoved:this._onContentWrapperRemoved},i&&this._renderContentForState()))}_renderContentForState(){switch(this.viewModel.state){case Po.Ready:return this._renderContentForReadyState();case Po.Selecting:return this._renderContentForSelectingState();case Po.Creating:return this._renderContentForCreatingState();case Po.Selected:return this._renderContentForSelectedState();case Po.Created:return this._renderContentForCreatedState();case Po.Disabled:return this._renderContentForReadyState()}}_renderContentForReadyState(){var s;const{sketchButton:e,selectButton:i}=this.visibleElements,n=this.messages;let r;return r=e&&i?n.readyPrompt:e?n.readyPromptCreateOnly:i?n.readyPromptSelectOnly:(s=n.errors)==null?void 0:s.noProfile,this._renderContent({prompt:r,chart:!1,actions:ew})}_renderContentForSelectingState(){const e=this.view;if(e==null)return null;const i=this.messages[`selectingPrompt-${e.type}`];return this._renderContent({prompt:i,chart:!1,actions:[{type:Io.SelectCancel}]})}_renderContentForCreatingState(){const{view:e,viewModel:i}=this;if(e==null)return null;const n=i.hasVertices?[{type:Io.SketchCancel},{type:Io.SketchDone,disabled:!i.tool.interaction.canStopCreating}]:[{type:Io.Select},{type:Io.Sketch,disabled:!0}];if(i.errorState===Kn.NoValidInput){const s=this.messages[`creatingPrompt-${e.type}`];return this._renderContent({chart:!1,actions:n,prompt:s})}const r=this._getErrorMessage();return r?this._renderContent({chart:!1,actions:n,prompt:r}):this._renderContent({chart:!0,actions:n})}_renderContentForSelectedState(){const e=this._getErrorMessage();return e?this._renderContent({chart:!1,actions:ew,prompt:e}):this._renderContent({chart:!0,actions:ew})}_renderContentForCreatedState(){const e=this._getErrorMessage();return e?this._renderContent({chart:!1,actions:ew,prompt:e}):this._renderContent({chart:!0,actions:ew})}_getErrorMessage(){var i,n;const e=PKe[this.viewModel.errorState];return e?(n=(i=this.messages)==null?void 0:i.errors)==null?void 0:n[e]:null}_renderContent(e){const i=e.prompt!=null?this._renderPrompt(e.prompt):e.chart&&this._renderChart(),n=this.viewModel.input!=null;return[O("header",{key:"header",class:Mi.header},this._zoomOutButtonVisible&&this._renderZoomOutButton(),this.visibleElements.clearButton&&n&&this._renderClearButton(),this.visibleElements.settingsButton&&this._settingsButton.render()),O("div",{class:Mi.mainContainer},i),this.visibleElements.legend&&this._legend.render(),this._renderActions(e)]}_renderZoomOutButton(){return O("button",{key:"zoom-out",class:Mi.zoomOutButton,bind:this,onclick:this._onZoomOutButtonClick,title:this.messages.zoomOut,type:"button"})}_onZoomOutButtonClick(){ot(this._chart,e=>e.zoomOut())}_renderClearButton(){return O("button",{key:"clear-profile",class:Mi.clearButton,bind:this,onclick:this._onClearButtonClick,title:this.messages.clearProfile,type:"button"})}_onClearButtonClick(){this.viewModel.clear()}_renderPrompt(e){return[O("div",{key:"prompt-container",bind:this,class:Mi.promptContainer},O("p",null,e))]}_renderChart(){if(!this.visibleElements.chart)return[O("div",{key:"empty-chart-container",class:Mi.chartContainer})];const e=this._chartIsRefined||this._canRenderChart();if(!e)return[this._renderSpinner({size:"large"}),O("div",{key:"chart-container-empty",class:Mi.chartContainer})];const{chartData:i,progress:n}=this.viewModel;return[i!=null&&n>0&&n<1&&this._renderSpinner({size:e?"small":"large"}),O("div",{key:"chart-container",bind:this,class:Mi.chartContainer,afterCreate:this._onChartContainerAfterCreate,afterRemoved:this._onChartContainerRemoved})]}_renderSpinner(e){return O("div",{key:"spinner",class:this.classes(Mi.chartSpinner,{[Mi.chartSpinnerSmall]:e.size==="small"}),afterCreate:this._onSpinnerAfterCreate,exitAnimation:this._onSpinnerExit})}_onSpinnerAfterCreate(e){requestAnimationFrame(()=>e.classList.add(Mi.chartSpinnerVisible))}_onSpinnerExit(e,i){e.classList.remove(Mi.chartSpinnerVisible),setTimeout(i,200)}_canRenderChart(){const e=this.viewModel.chartData;if(e==null)return!1;if(!this.viewModel.inputIsSketched)return e.refined;let i=0;for(const{samples:n}of e.lines)i+=n!=null?n.length:0;return e.refined||i<=Os().largeChartSamples}_renderActions({actions:e}){const i=e.map(n=>{switch(n.type){case Io.Sketch:return this.visibleElements.sketchButton&&this._renderAction({action:n,onClick:this._onSketchButtonClick,className:Mi.sketchButton,label:this.messages.sketchButtonLabel});case Io.SketchCancel:return this.visibleElements.sketchButton&&this._renderAction({action:n,onClick:this._onCancelButtonClick,className:Mi.sketchCancelButton,label:this.messagesCommon.cancel});case Io.SketchDone:return this.visibleElements.sketchButton&&this._renderAction({action:n,onClick:this._onDoneButtonClick,className:Mi.sketchDoneButton,label:this.messagesCommon.done});case Io.Select:return this.visibleElements.selectButton&&this._renderAction({action:n,onClick:this._onSelectButtonClick,className:Mi.selectButton,label:this.messages.selectButtonLabel});case Io.SelectCancel:return this.visibleElements.selectButton&&this._renderAction({action:n,onClick:this._onCancelButtonClick,className:Mi.selectCancelButton,label:this.messagesCommon.cancel})}}).filter(Boolean);return i.length?O("footer",{key:"footer",class:Mi.footer},i):null}_renderAction({action:e,onClick:i,className:n,label:r}){return O("button",{key:`action-${e.type}`,class:this.classes(Mi.actionButton,n,{[Mi.buttonDisabled]:!!e.disabled}),bind:this,disabled:e.disabled,onclick:i,type:"button"},r)}_onSketchButtonClick(){this.viewModel.start({mode:"sketch"})}_onSelectButtonClick(){this.viewModel.start({mode:"select"})}_onCancelButtonClick(){this.viewModel.cancel()}_onDoneButtonClick(){this.viewModel.stop()}_onContentWrapperAfterCreate(e){const i=EMe(e,n=>{this._width=n.contentRect.width});this.addHandles(i,eY)}_onContentWrapperRemoved(){this.removeHandles(eY)}_updateChart(e){const{data:i,chart:n,messages:r,stationary:s}=e;n!=null&&r!=null&&s&&this._canRenderChart()&&(n.update(e),this._chartIsRefined=i!=null&&i.refined)}_onChartContainerAfterCreate(e){this._chartContainer=e}_onChartContainerRemoved(){this._chartContainer=null}_initializeChart(e){is(this._chartInitTask),this._chartInitTask=i0(async i=>{const n=await dKe({container:e,abortOptions:{signal:i},onRangeChange:(r,s)=>{this._zoomOutButtonVisible=r!==1||s!==1},onCursorPositionChange:r=>{this.viewModel.hoveredChartPosition=r}});if(i.aborted)throw Je(n),li();this._chart=n,this._updateChart(this._chartUpdateParams)})}_destroyChart(){this._chartInitTask=is(this._chartInitTask),this._chart=Je(this._chart),this._chartIsRefined=!1}get test(){return{chart:this._chart}}};h([p({type:Tfe})],qt.prototype,"viewModel",void 0),h([p()],qt.prototype,"view",null),h([p()],qt.prototype,"input",null),h([p()],qt.prototype,"profiles",null),h([p()],qt.prototype,"unitOptions",null),h([p()],qt.prototype,"unit",null),h([p()],qt.prototype,"geodesicDistanceThreshold",null),h([p({type:Ife,nonNullable:!0})],qt.prototype,"visibleElements",void 0),h([p()],qt.prototype,"iconClass",void 0),h([p()],qt.prototype,"icon",void 0),h([p()],qt.prototype,"label",null),h([p()],qt.prototype,"visible",null),h([p(),Zt("esri/widgets/ElevationProfile/t9n/ElevationProfile")],qt.prototype,"messages",void 0),h([p(),Zt("esri/t9n/common")],qt.prototype,"messagesCommon",void 0),h([p(),Zt("esri/core/t9n/Units")],qt.prototype,"messagesUnits",void 0),h([p()],qt.prototype,"_chartContainer",void 0),h([p()],qt.prototype,"_chart",void 0),h([p()],qt.prototype,"_chartInitTask",void 0),h([p()],qt.prototype,"_chartIsRefined",void 0),h([p()],qt.prototype,"_settingsButton",void 0),h([p()],qt.prototype,"_legend",void 0),h([p()],qt.prototype,"_width",void 0),h([p()],qt.prototype,"_portrait",null),h([p()],qt.prototype,"_zoomOutButtonVisible",void 0),h([p()],qt.prototype,"_chartUpdateParams",null),h([p()],qt.prototype,"_chartMessages",null),h([p()],qt.prototype,"_legendProps",null),h([p()],qt.prototype,"_profilesArray",null),h([p()],qt.prototype,"_settingsButtonProps",null),qt=h([P("esri.widgets.ElevationProfile")],qt);const kKe=qt,zi="esri-search",Oe={base:`${zi} esri-widget`,loader:"esri-widget__loader",loaderText:"esri-widget__loader-text",loaderAnimation:"esri-widget__loader-animation",esriInput:"esri-input",hasMultipleSources:`${zi}--multiple-sources`,isLoading:`${zi}--loading`,isSearching:`${zi}--searching`,showSuggestions:`${zi}--show-suggestions`,showSources:`${zi}--sources`,showWarning:`${zi}--warning`,container:`${zi}__container`,input:`${zi}__input`,inputContainer:`${zi}__input-container`,form:`${zi}__form`,submitButton:`${zi}__submit-button`,sourcesButton:`${zi}__sources-button`,clearButton:`${zi}__clear-button`,sourceName:`${zi}__source-name`,suggestionsMenu:`${zi}__suggestions-menu`,suggestionList:`${zi}__suggestions-list`,suggestionListCurrentLocation:`${zi}__suggestions-list--current-location`,sourcesMenu:`${zi}__sources-menu`,source:`${zi}__source`,warningMenu:`${zi}__warning-menu`,warningMenuBody:`${zi}__warning-body`,warningMenuHeader:`${zi}__warning-header`,warningMenuText:`${zi}__warning-text`,noValueText:`${zi}__no-value-text`,esriWidgetDisabled:"esri-widget--disabled",button:"esri-widget--button",fallbackText:"esri-icon-font-fallback-text",header:"esri-widget__heading",locate:"esri-icon-locate-circled",menu:"esri-menu",menuList:"esri-menu__list",menuItem:"esri-menu__list-item",menuItemActive:"esri-menu__list-item--active",menuItemFocus:"esri-menu__list-item--focus",menuHeader:"esri-menu__header",loadingIcon:"esri-icon-loading-indicator esri-rotating",searchIcon:"esri-icon-search",dropdownIcon:"esri-icon-down-arrow esri-search__sources-button--down",dropupIcon:"esri-icon-up-arrow esri-search__sources-button--up",clearIcon:"esri-icon-close",noticeIcon:"esri-icon-notice-triangle",widgetIcon:"esri-icon-search",disabled:"esri-disabled"},Cm="esri-search-result-renderer",Xu={base:`${Cm} esri-widget`,anchor:"esri-widget__anchor",showMoreResults:`${Cm}__more-results--show-more-results`,moreResults:`${Cm}__more-results`,moreResultsList:`${Cm}__more-results-list`,moreResultsHeader:`${Cm}__more-results-header`,moreResultsItem:`${Cm}__more-results-item`,moreResultsListHeader:`${Cm}__more-results-list-header`};let On=class extends Nb(ie){constructor(e){super(e),this.autoNavigate=null,this.filter=null,this.getResults=null,this.getSuggestions=null,this.maxResults=null,this.maxSuggestions=null,this.minSuggestCharacters=null,this.outFields=null,this.placeholder="",this.popupEnabled=null,this.popupTemplate=null,this.prefix="",this.resultGraphicEnabled=null,this.resultSymbol=null,this.suggestionsEnabled=null,this.suffix="",this.withinViewEnabled=!1,this.zoomScale=null}};h([p()],On.prototype,"autoNavigate",void 0),h([p()],On.prototype,"filter",void 0),h([p()],On.prototype,"getResults",void 0),h([p()],On.prototype,"getSuggestions",void 0),h([p()],On.prototype,"maxResults",void 0),h([p()],On.prototype,"maxSuggestions",void 0),h([p()],On.prototype,"minSuggestCharacters",void 0),h([p()],On.prototype,"outFields",void 0),h([p()],On.prototype,"placeholder",void 0),h([p()],On.prototype,"popupEnabled",void 0),h([p()],On.prototype,"popupTemplate",void 0),h([p()],On.prototype,"prefix",void 0),h([p()],On.prototype,"resultGraphicEnabled",void 0),h([p()],On.prototype,"resultSymbol",void 0),h([p()],On.prototype,"suggestionsEnabled",void 0),h([p()],On.prototype,"suffix",void 0),h([p()],On.prototype,"withinViewEnabled",void 0),h([p()],On.prototype,"zoomScale",void 0),On=h([P("esri.widgets.Search.SearchSource")],On);const mB=On,kfe=96;function uvt(t,e){const i=e||t.extent,n=t.width,r=pi(i&&i.spatialReference);return i&&n?i.width/n*r*wQ*kfe:0}function OKe(t,e){return t/(pi(e)*wQ*kfe)}function LKe(t,e){const i=t.extent,n=t.width-(t.padding?t.padding.left+t.padding.right:0),r=OKe(e,i.spatialReference);return i.clone().expand(r*n/i.width)}const tY=ne.getLogger("esri.widgets.Search.support.geometryUtils");function RKe(t,e){var n,r;if(!e)return tY.error("missing-parameter: view is missing."),Promise.reject(new V("searchgeometryutils:missing-parameter","view is missing."));if(!t)return tY.error("missing-parameter: point is missing."),Promise.reject(new V("searchgeometryutils:missing-parameter","point is missing."));if(t.hasZ||e.type==="2d")return Promise.resolve(t);const i=(n=e==null?void 0:e.map)==null?void 0:n.ground;return i&&i.layers.length?i.queryElevation(t,{cache:(r=e.basemapTerrain)==null?void 0:r.elevationQueryCache}).then(s=>s.geometry):Promise.resolve(t)}function iY(t){if(t==null)return null;switch(t.type){case"point":return t;case"extent":return t.center;case"polygon":return t.centroid;case"multipoint":return t.getPoint(0);case"polyline":return t.getPoint(0,0)}return null}function gB(t,e,i){return t==null?null:t.type==="extent"?t:t.type==="multipoint"||t.type==="polygon"||t.type==="polyline"?t.extent:t.type==="point"?Ofe(t,e,i):void 0}function cz(t,e,i){return t==null||e==null?null:Ofe(t.center,e,i)}function Ofe(t,e,i){const n=t.hasZ?t.z:void 0;return e!=null&&e.map?(i!=null?LKe(e,i):e.extent).clone().centerAt(t).set({zmax:n,zmin:n}):new Le({xmin:t.x-.25,ymin:t.y-.25,xmax:t.x+.25,ymax:t.y+.25,spatialReference:t.spatialReference,zmin:n,zmax:n})}const DKe=/https?:\/\/services.*\.arcgis\.com/i,NKe=/(?:\{([^}]+)\})/g,W_=ne.getLogger("esri.widgets.Search.support.layerSearchUtils");function FKe(t,e){const{exactMatch:i=!1,location:n,maxResults:r,spatialReference:s,source:o,sourceIndex:a,suggestResult:l,view:c}=t,{layer:u,filter:d,zoomScale:f}=o,m=c==null?void 0:c.scale,g=Lfe(o,c),y=e&&e.signal;return Dfe(u).then(()=>{const _=u.popupTemplate;return _?_.getRequiredFields(u.fieldsIndex):null}).then(_=>{var $,L,D,F;const{objectIdField:b,returnZ:w}=u,x=Bfe(o);if(!yB(u,x))throw W_.error("invalid-field: displayField is invalid."),new V("getResults():invalid-field","displayField is invalid.");const S=_&&_.length?_:[x],T=o.outFields||S,I=Rfe(T);if(T.includes(b)||I||T.push(b),($=u.floorInfo)!=null&&$.floorField&&T.push(u.floorInfo.floorField),!(I||L$(u,T)))throw W_.error("invalid-field: outField is invalid."),new V("getResults():invalid-field","outField is invalid.");const C=u.createQuery(),{orderByFields:M}=o;if(M&&(C.orderByFields=M),s){C.outSpatialReference=s;const z=1/pi(s);z&&(C.maxAllowableOffset=z)}const E=u.geometryType==="mesh"||u.geometryType==="multipatch",A=((D=(L=u.capabilities)==null?void 0:L.data)==null?void 0:D.supportsZ)&&!E;if(C.returnZ=A&&w!==!1,C.returnGeometry=!0,C.multipatchOption=E?"xyFootprint":null,T&&(C.outFields=T),n)C.geometry=n;else if(l.key)C.objectIds=[l.key];else{const z=o.searchFields||[x];if(!L$(u,z))throw W_.error("invalid-field: search field is invalid."),new V("getResults():invalid-field","search field is invalid.");if(jfe(u)&&(C.num=r),g&&(C.geometry=g),!((F=l.text)==null?void 0:F.trim()))return[];const G=l.text,{prefix:W="",suffix:Z=""}=o,X=Ufe(`${W}${G}${Z}`);Vfe(u)&&Ffe(u,z)&&!i&&G&&(C.fullText=zfe({text:G,searchFields:z}));const oe=Gfe({searchTerm:X,layer:u,searchFields:z,filter:d,exactMatch:i,query:C,type:"search"});if(C.where=oe,!Nfe(C))return[]}return u.queryFeatures(C,{signal:y}).then(z=>YKe(z,c,o,a,x,m,f))})}function zKe(t,e){const{source:i,spatialReference:n,view:r,suggestTerm:s,maxSuggestions:o,sourceIndex:a,exactMatch:l}=t,{layer:c,filter:u}=i,d=e&&e.signal,f=Lfe(i,r);return Dfe(c).then(()=>{if(!jfe(c))return[];const m=Bfe(i),g=i.searchFields||[m],y=[];i.suggestionTemplate?i.suggestionTemplate.replaceAll(NKe,(A,$)=>(y.push($),A)):y.push(m);const _=Rfe(y);y.includes(c.objectIdField)||_||y.push(c.objectIdField);const b=yB(c,m),w=_||L$(c,y),x=L$(c,g);if(!b)throw W_.error("invalid-field: displayField is invalid."),new V("getSuggestions():invalid-field","displayField is invalid.");if(!w)throw W_.error("invalid-field: outField is invalid."),new V("getSuggestions():invalid-field","outField is invalid.");if(!x)throw W_.error("invalid-field: search field is invalid."),new V("getSuggestions():invalid-field","search field is invalid.");const S=c.createQuery(),{orderByFields:T}=i;if(T&&(S.orderByFields=T),S.outSpatialReference=n,S.returnGeometry=!1,S.num=o,S.outFields=y,f&&(S.geometry=f),!s.trim())return[];const{prefix:I="",suffix:C=""}=i,M=Ufe(`${I}${s}${C}`);Vfe(c)&&Ffe(c,g)&&!l&&s&&(S.fullText=zfe({text:s,searchFields:g}));const E=Gfe({searchTerm:M,layer:c,searchFields:g,filter:u,exactMatch:l,query:S,type:"suggest"});return S.where=E,Nfe(S)?c.queryFeatures(S,{signal:d}).then(A=>JKe(A,i,a,m)):[]})}function Lfe(t,e){const{filter:i,withinViewEnabled:n}=t,r=e==null?void 0:e.extent;return(i==null?void 0:i.geometry)??(n&&r?r:void 0)}function Rfe(t){return t&&t.includes("*")}async function Dfe(t){t&&await t.load()}function Nfe(t){return!(!t.fullText&&!t.where)}function Ffe(t,e){const i=t==null?void 0:t.indexes;return!i||!(e!=null&&e.length)?!1:i.filter(n=>n.indexType==="FullText").some(n=>{var s;const r=((s=n.fields)==null?void 0:s.split(",").map(o=>o.trim().toLowerCase()))||[];return e.every(o=>r.includes(o.toLowerCase()))})}function zfe({text:t,searchFields:e}){return t.trim().split(" ").filter(i=>!!i.trim()).map(i=>new Iae({onFields:e,searchTerm:i,searchType:"prefix"}))}function Vfe(t){var e,i;return((i=(e=t==null?void 0:t.capabilities)==null?void 0:e.query)==null?void 0:i.supportsFullTextSearch)??!1}function jfe(t){var e,i;return((i=(e=t==null?void 0:t.capabilities)==null?void 0:e.query)==null?void 0:i.supportsPagination)??!1}function VKe(t){var e,i,n;return((n=(i=(e=t==null?void 0:t.fieldsIndex)==null?void 0:e.fields)==null?void 0:i.find(r=>r.type==="string"))==null?void 0:n.name)??""}function Bfe(t){return t.displayField||t.layer.displayField||VKe(t.layer)}function L$(t,e){return!(!t||!(e!=null&&e.length))&&e.every(i=>yB(t,i))}function yB(t,e){return!!t.getField(e)}function jKe(t){for(let e=0;e<t.length;e++)if(t.charCodeAt(e)>255)return!0;return!1}function BKe(t,e,i){let n=null;const{codedValues:r}=t;return r&&r.some(s=>{const o=s.name,a=i?o:o.toLowerCase();return(i?e:e.toLowerCase())===a&&(n=s.code.toString(),!0)}),n}function Ufe(t){return t.replaceAll("'","''")}function tw(t,e){const i=e==null?void 0:e.where;return i?`(${t}) AND (${i})`:t}function UKe({currentTerm:t,field:e,filter:i,exactMatch:n,url:r,type:s}){const o=e==null?void 0:e.type,a=e==null?void 0:e.name;if(o==="string"||o==="date"||o==="global-id"){const l=DKe.test(r??""),c=l&&jKe(t)?"N":"";return tw(n&&s==="search"?`${a} = ${c}'${t}'`:l?`${a} LIKE ${c}${`'${t}%'`}`:`${`LOWER(${a})`} LIKE ${c}${`'${t.toLowerCase()}%'`}`,i)}if(o==="oid"||o==="small-integer"||o==="integer"||o==="single"||o==="double"){const l=Number(t);return isNaN(l)?null:tw(`${a} = ${l}`,i)}return tw(`${a} = ${t}`,i)}function GKe(t,e){return t?` OR (${e})`:`(${e})`}function Gfe({searchTerm:t,layer:e,searchFields:i,filter:n,exactMatch:r,query:s,type:o}){const{definitionExpression:a,url:l}=e;let c="";return!s.fullText&&t&&i&&i.forEach(u=>{const d=e.getField(u),f=typeof e.getFieldDomain=="function"&&e.getFieldDomain(u),m=(f&&f.type==="coded-value"?BKe(f,t,r):null)||t||null;if(m!==null){const g=UKe({currentTerm:m,field:d,filter:n,exactMatch:r,url:l,type:o});g&&(c+=GKe(c,g))}}),a&&c?`(${a}) AND (${c})`:a||c}function HKe(t,e){let i=null;const{codedValues:n}=t;return n&&n.length&&n.some(r=>r.code===e&&(i=r.name,!0)),i}function qKe(t,e){return t[Object.keys(t).find(i=>i.toLowerCase()===e.toLowerCase())]}function Hfe(t,e,i){const n=t.sourceLayer,{attributes:r}=t,s=typeof n.getFieldDomain=="function"&&n.getFieldDomain(i);if(e)return Ru(e,r);if(i&&r){const o=n.getField(i),a=qKe(r,i);return a==null?"":s&&s.type==="coded-value"?HKe(s,a)??"":(o==null?void 0:o.type)==="date"?yi(new Date(a)):typeof a=="number"?a.toString():typeof a!="string"?"":a.trim()}return""}function WKe(t,e,i,n){const r=t.sourceLayer,{attributes:s}=t,{objectIdField:o}=r,a=o?s[o]:null;return{text:Hfe(t,e.suggestionTemplate,n),key:a,sourceIndex:i}}function JKe(t,e,i,n){return t.features.map(r=>WKe(r,e,i,n))}function ZKe(t,e,i,n,r,s,o){const a=t.clone(),l=t.sourceLayer,c=l==null?void 0:l.objectIdField,u=c?t.attributes[c]:null,d=Hfe(t,i.searchTemplate,r),f=gB(a.geometry,e,s),m=typeof o=="number"?cz(q(f),e,o):f,g=t.clone();return m!=null&&(g.geometry=Vr.fromExtent(m)),{extent:m,target:g,feature:a,key:u,name:d,sourceIndex:n}}function YKe(t,e,i,n,r,s,o){return t.features.map(a=>ZKe(a,e,i,n,r,s,o))}var uz;let ic=uz=class extends mB{constructor(t){super(t),this.displayField=null,this.exactMatch=null,this.orderByFields=null,this.searchFields=null,this.searchTemplate=null,this.suggestionTemplate=null,this.getResults=(e,i)=>FKe({source:this,...e},i),this.getSuggestions=(e,i)=>zKe({source:this,...e},i)}set layer(t){this._set("layer",t),t&&t.load().catch(()=>{})}get name(){return this._getLayerTitle()??""}set name(t){this._overrideIfSome("name",t)}clone(){return new uz({autoNavigate:this.autoNavigate,filter:this.filter,maxResults:this.maxResults,maxSuggestions:this.maxSuggestions,minSuggestCharacters:this.minSuggestCharacters,outFields:this.outFields?q(this.outFields):null,placeholder:this.placeholder,popupEnabled:this.popupEnabled,prefix:this.prefix,resultGraphicEnabled:this.resultGraphicEnabled,resultSymbol:this.resultSymbol?this.resultSymbol.clone():null,suggestionsEnabled:this.suggestionsEnabled,suffix:this.suffix,withinViewEnabled:this.withinViewEnabled,displayField:this.displayField,exactMatch:this.exactMatch,layer:this.layer,searchFields:this.searchFields?q(this.searchFields):null,suggestionTemplate:this.suggestionTemplate,zoomScale:this.zoomScale})}_getFirstStringField(){var t,e;return((e=(t=this.layer.fieldsIndex)==null?void 0:t.fields.find(i=>i.type==="string"))==null?void 0:e.name)??""}_getDisplayField(){return this.displayField||this.layer.displayField||this._getFirstStringField()}_getSearchFieldsString(){const{layer:t,searchFields:e}=this;return t.loaded?`: ${(e||[this._getDisplayField()]).map(i=>{const n=t.getField(i);return n&&n.alias||i}).join(", ")}`:""}_getLayerTitle(){const{layer:t}=this;if(!t)return;const{title:e}=t;return e?`${e}${this._getSearchFieldsString()}`:void 0}};h([p({json:{read:{source:"field.name"},write:{target:"field.name"}}})],ic.prototype,"displayField",void 0),h([p({json:{read:{source:"field.exactMatch"},write:{target:"field.exactMatch"}}})],ic.prototype,"exactMatch",void 0),h([p({value:null})],ic.prototype,"layer",null),h([p()],ic.prototype,"name",null),h([p({type:[String],json:{write:!0}})],ic.prototype,"orderByFields",void 0),h([p()],ic.prototype,"searchFields",void 0),h([p()],ic.prototype,"searchTemplate",void 0),h([p()],ic.prototype,"suggestionTemplate",void 0),ic=uz=h([P("esri.widgets.Search.LayerSearchSource")],ic);const n_=ic;function XKe(t){return!!t&&typeof t.x=="number"&&typeof t.y=="number"}function KKe(t){return t&&typeof t.xmin=="number"&&typeof t.ymin=="number"&&typeof t.xmax=="number"&&typeof t.ymax=="number"}let Np=class extends ie{constructor(e){super(e),this.address=null,this.attributes=null,this.extent=null,this.location=null,this.score=null}};h([p({type:String,json:{write:!0}})],Np.prototype,"address",void 0),h([p({type:Object,json:{write:!0}})],Np.prototype,"attributes",void 0),h([p({type:Le,json:{write:!0}})],Np.prototype,"extent",void 0),h([p({type:pe,json:{write:!0}})],Np.prototype,"location",void 0),h([p({type:Number,json:{write:!0}})],Np.prototype,"score",void 0),Np=h([P("esri.rest.support.AddressCandidate")],Np);const qfe=Np,vB={type:String,json:{read:{source:"token"},write:{target:"token"}}};let Xr=class extends ie{constructor(e){super(e),this.address=null,this.apiKey=null,this.categories=null,this.countryCode=null,this.forStorage=null,this.location=null,this.locationType=null,this.magicKey=null,this.maxLocations=null,this.outFields=null,this.outSpatialReference=null,this.searchExtent=null}};h([p({type:Object,json:{write:!0}})],Xr.prototype,"address",void 0),h([p(vB)],Xr.prototype,"apiKey",void 0),h([p({type:[String],json:{read:{source:"category",reader:t=>t?t.split(","):null},write:{target:"category",writer:(t,e)=>{e.category=t?t.join(","):null}}}})],Xr.prototype,"categories",void 0),h([p({type:String,json:{write:!0}})],Xr.prototype,"countryCode",void 0),h([p({type:Boolean,json:{write:!0}})],Xr.prototype,"forStorage",void 0),h([p({type:pe,json:{write:{writer:(t,e)=>{e.location=t?t.clone().normalize():null}}}})],Xr.prototype,"location",void 0),h([p({type:String,json:{write:!0}})],Xr.prototype,"locationType",void 0),h([p({type:String,json:{write:!0}})],Xr.prototype,"magicKey",void 0),h([p({type:Number,json:{write:!0}})],Xr.prototype,"maxLocations",void 0),h([p({type:[String],json:{write:{writer:(t,e)=>{e.outFields=t?t.join(","):null}}}})],Xr.prototype,"outFields",void 0),h([p({type:Ee,json:{read:{source:"outSR"},write:{target:"outSR"}}})],Xr.prototype,"outSpatialReference",void 0),h([p({type:Le,json:{write:{writer:(t,e)=>{const i=t?t.shiftCentralMeridian():null;e.searchExtent=i}}}})],Xr.prototype,"searchExtent",void 0),Xr=h([P("esri.rest.support.AddressToLocationsParameters")],Xr),Xr.from=fn(Xr);const Wfe=Xr;async function QKe(t,e,i){e=Wfe.from(e);const n=e1(t),{address:r,...s}=e.toJSON(),o={...r,...s,f:"json"},a=uT({...n.query,...o}),l=cT(a,i),c=`${n.path}/findAddressCandidates`;return gt(c,l).then(eQe)}function eQe({data:t}){if(!t)return[];const{candidates:e,spatialReference:i}=t;return e?e.map(n=>{if(!n)return;const{extent:r,location:s}=n,o=!r||KKe(r);return XKe(s)&&o?(r&&(r.spatialReference=i),s&&(s.spatialReference=i),qfe.fromJSON(n)):void 0}):[]}let Sh=class extends ie{constructor(e){super(e),this.apiKey=null,this.location=null,this.locationType=null,this.outSpatialReference=null}};h([p(vB)],Sh.prototype,"apiKey",void 0),h([p({type:pe,json:{write:{writer:(t,e)=>{const i=t?t.clone().normalize():null,n=i!==void 0;e.location=n?i:null}}}})],Sh.prototype,"location",void 0),h([p({type:String,json:{write:!0}})],Sh.prototype,"locationType",void 0),h([p({type:Ee,json:{read:{source:"outSR"},write:{target:"outSR"}}})],Sh.prototype,"outSpatialReference",void 0),Sh=h([P("esri.rest.support.LocationToAddressParameters")],Sh),Sh.from=fn(Sh);const Jfe=Sh;async function tQe(t,e,i){e=Jfe.from(e);const n=e1(t),r={...e.toJSON(),f:"json"},s=uT({...n.query,...r}),o=cT(s,i),a=`${n.path}/reverseGeocode`;return gt(a,o).then(iQe)}function iQe({data:t}){if(!t)return;const{address:e,location:i}=t,n=e&&e.Match_addr||"";return qfe.fromJSON({address:n,attributes:e||{},location:i,score:100})}let r_=class extends ie{constructor(t){super(t),this.isCollection=null,this.magicKey=null,this.text=null}};h([p({type:Boolean,json:{write:!0}})],r_.prototype,"isCollection",void 0),h([p({type:String,json:{write:!0}})],r_.prototype,"magicKey",void 0),h([p({type:String,json:{write:!0}})],r_.prototype,"text",void 0),r_=h([P("esri.rest.support.SuggestionCandidate")],r_);const nQe=r_;let ra=class extends ie{constructor(e){super(e),this.apiKey=null,this.categories=null,this.countryCode=null,this.location=null,this.maxSuggestions=null,this.outSpatialReference=null,this.searchExtent=null,this.text=null}};h([p(vB)],ra.prototype,"apiKey",void 0),h([p({type:[String],json:{read:{source:"category",reader:t=>t?t.split(","):null},write:{target:"category",writer:(t,e)=>{e.category=t?t.join(","):null}}}})],ra.prototype,"categories",void 0),h([p({type:String,json:{write:!0}})],ra.prototype,"countryCode",void 0),h([p({type:pe,json:{write:{writer:(t,e)=>{e.location=t?t.clone().normalize():null}}}})],ra.prototype,"location",void 0),h([p({type:Number,json:{write:!0}})],ra.prototype,"maxSuggestions",void 0),h([p({type:Ee,json:{read:{source:"outSR"},write:{target:"outSR"}}})],ra.prototype,"outSpatialReference",void 0),h([p({type:Le,json:{write:{writer:(t,e)=>{const i=t?t.shiftCentralMeridian():null;e.searchExtent=JSON.stringify(i)}}}})],ra.prototype,"searchExtent",void 0),h([p({type:String,json:{write:!0}})],ra.prototype,"text",void 0),ra=h([P("esri.rest.support.SuggestLocationsParameters")],ra),ra.from=fn(ra);const Zfe=ra;async function rQe(t,e,i){const n=e1(t),r={...(e=Zfe.from(e)).toJSON(),f:"json"},s=uT({...n.query,...r}),o=cT(s,i),a=`${n.path}/suggest`;return gt(a,o).then(sQe)}function sQe(t){const{data:e}=t;if(!e)return[];const{suggestions:i}=e;return i?i.map(n=>new nQe(n)):[]}const oQe="Single Line Input",aQe=3e5;function lQe(t,e){return t.location?pQe(t,e):fQe(t,e)}function Yfe(t,e){var n;if(e.localSearchDisabled)return null;const i=t==null?void 0:t.scale;return typeof i=="number"&&i<=aQe?(n=t==null?void 0:t.extent)==null?void 0:n.center:null}async function cQe(t,e){const{source:i,spatialReference:n,view:r,suggestTerm:s,maxSuggestions:o,sourceIndex:a}=t,l=new Zfe,{apiKey:c,url:u}=i,d=Xfe(i,r),f=e&&e.signal;if(!u)return null;c&&(l.apiKey=c),i.categories&&(l.categories=i.categories),n&&(l.outSpatialReference=n);const m=Yfe(r,i);if(m&&(l.location=m),!s.trim())return null;const{prefix:g="",suffix:y=""}=i,_=`${g}${s}${y}`;return l.text=_,d&&(l.searchExtent=d),l.maxSuggestions=o,i.countryCode&&(l.countryCode=i.countryCode),rQe(u,l,{signal:f}).then(b=>gQe(b,a))}function uQe(t){return!!t&&/(?:geocode\-api\.arcgis\.com\/arcgis\/rest\/services\/world\/geocodeserver).*/i.test(t)}function hQe(t){return!!t&&/(?:\/servers\/[\da-z\.-]+\/rest\/services\/world\/geocodeserver).*/i.test(t)}function nY(t){return!!t&&/(?:arcgis\.com\/arcgis\/rest\/services\/world\/geocodeserver).*/i.test(t)}const dQe="https://geocode-api.arcgis.com/arcgis/rest/services/World/GeocodeServer";async function pQe(t,e){const{source:i,spatialReference:n,location:r,sourceIndex:s,view:o}=t,{apiKey:a,url:l,zoomScale:c,defaultZoomScale:u}=i;if(l==null)return[];const d=o==null?void 0:o.scale,f=e==null?void 0:e.signal,m=new Jfe;m.location=r,a&&(m.apiKey=a),n&&(m.outSpatialReference=n);try{return Kfe([await tQe(l,m,{signal:f})],{sourceIndex:s,scale:d,view:o,zoomScale:c,defaultZoomScale:u})}catch{return[]}}function Xfe(t,e){const{filter:i,withinViewEnabled:n}=t,r=e&&e.scale,s=e&&e.extent,o=i&&i.geometry;return gB(o,e,r)||(n&&s?s:void 0)}async function fQe(t,e){var C;const{source:i,suggestResult:n,spatialReference:r,view:s,maxResults:o,sourceIndex:a}=t,l=i&&i.zoomScale,c=i&&i.defaultZoomScale;if(!((C=n.text)==null?void 0:C.trim()))return null;const d=!n.key&&i.prefix?i.prefix:"",f=!n.key&&i.suffix?i.suffix:"",m=`${d}${n.text}${f}`,g=new Wfe,{apiKey:y,url:_}=i,b=s&&s.scale,w=Xfe(i,s),x=e&&e.signal;if(y&&(g.apiKey=y),!_)return null;i.categories&&(g.categories=i.categories),i.locationType&&(g.locationType=i.locationType),r&&(g.outSpatialReference=r);const S=Yfe(s,i);S&&(g.location=S),g.maxLocations=o,w&&(g.searchExtent=w),i.countryCode&&(g.countryCode=i.countryCode);const{key:T}=n,I=`${T}`;return T&&(g.magicKey=I),g.address={},g.address[i.singleLineFieldName||oQe]=m,i.outFields&&(g.outFields=i.outFields),QKe(_,g,{signal:x}).then(M=>Kfe(M,{key:I,scale:b,sourceIndex:a,view:s,zoomScale:l,defaultZoomScale:c}))}function mQe(t,e){return{text:t.text,key:t.magicKey,sourceIndex:e}}function gQe(t,e){return t.map(i=>mQe(i,e))}function yQe(t,e){const{key:i,scale:n,sourceIndex:r,view:s,zoomScale:o,defaultZoomScale:a}=e,{attributes:l,extent:c,location:u,address:d}=t,f=new Vo({geometry:u,attributes:l}),m=c||u,g=gB(m,s,n),y=typeof o=="number"?cz(g,s,o):typeof a=="number"&&(m==null?void 0:m.type)==="point"?cz(g,s,a):g,_=u?`${u.x},${u.y}`:"",b=d||_,w=f.clone();return y!=null&&(w.geometry=Vr.fromExtent(y)),{extent:y,feature:f,target:w,key:i,name:b,sourceIndex:r}}function Kfe(t,e){return t.filter(Boolean).map(i=>yQe(i,e))}var hz;const vQe="esri.widgets.Search.LocatorSearchSource";let xs=hz=class extends mB{constructor(t){super(t),this.apiKey=null,this.categories=null,this.countryCode=null,this.defaultZoomScale=null,this.localSearchDisabled=!1,this.locationType=null,this.name="",this.placeholder="",this.searchTemplate="",this.singleLineFieldName=null,this.suggestionsEnabled=null,this.url=null,this.zoomScale=null,this.getResults=(e,i)=>lQe({source:this,...e},i),this.getSuggestions=(e,i)=>cQe({source:this,...e},i)}clone(){return new hz({apiKey:this.apiKey,autoNavigate:this.autoNavigate,filter:this.filter,maxResults:this.maxResults,maxSuggestions:this.maxSuggestions,minSuggestCharacters:this.minSuggestCharacters,outFields:this.outFields?q(this.outFields):null,placeholder:this.placeholder,popupEnabled:this.popupEnabled,prefix:this.prefix,resultGraphicEnabled:this.resultGraphicEnabled,resultSymbol:this.resultSymbol?this.resultSymbol.clone():null,suggestionsEnabled:this.suggestionsEnabled,suffix:this.suffix,withinViewEnabled:this.withinViewEnabled,categories:this.categories?q(this.categories):null,countryCode:this.countryCode,locationType:this.locationType,searchTemplate:this.searchTemplate,singleLineFieldName:this.singleLineFieldName,zoomScale:this.zoomScale})}};h([p()],xs.prototype,"apiKey",void 0),h([p()],xs.prototype,"categories",void 0),h([p()],xs.prototype,"countryCode",void 0),h([p({json:{write:!0}})],xs.prototype,"defaultZoomScale",void 0),h([p()],xs.prototype,"localSearchDisabled",void 0),h([p()],xs.prototype,"locationType",void 0),h([p({json:{write:!0}})],xs.prototype,"name",void 0),h([p({json:{write:!0}})],xs.prototype,"placeholder",void 0),h([p()],xs.prototype,"searchTemplate",void 0),h([p({json:{write:!0}})],xs.prototype,"singleLineFieldName",void 0),h([p({json:{read:{source:"suggest"},write:{target:"suggest"}}})],xs.prototype,"suggestionsEnabled",void 0),h([p({json:{write:!0}})],xs.prototype,"url",void 0),h([p({json:{write:!0}})],xs.prototype,"zoomScale",void 0),xs=hz=h([P(vQe)],xs);const Qfe=xs;let zg=class extends ie{constructor(e){super(e),this.geometries=[],this.outSpatialReference=null,this.transformation=null,this.transformForward=null}toJSON(){const e=this.geometries.map(r=>r.toJSON()),i=this.geometries[0],n={};return n.outSR=this.outSpatialReference.wkid||JSON.stringify(this.outSpatialReference.toJSON()),n.inSR=i.spatialReference.wkid||JSON.stringify(i.spatialReference.toJSON()),n.geometries=JSON.stringify({geometryType:Db(i),geometries:e}),this.transformation&&(n.transformation=this.transformation.wkid||JSON.stringify(this.transformation)),this.transformForward!=null&&(n.transformForward=this.transformForward),n}};h([p()],zg.prototype,"geometries",void 0),h([p({json:{read:{source:"outSR"}}})],zg.prototype,"outSpatialReference",void 0),h([p()],zg.prototype,"transformation",void 0),h([p()],zg.prototype,"transformForward",void 0),zg=h([P("esri.rest.support.ProjectParameters")],zg);const eme=zg,_Qe=fn(eme);async function bQe(t,e,i){e=_Qe(e);const n=e1(t),r={...n.query,f:"json",...e.toJSON()},s=e.outSpatialReference,o=Db(e.geometries[0]),a=cT(r,i);return gt(n.path+"/project",a).then(({data:{geometries:l}})=>ple(l,o,s))}const tme=ne.getLogger("esri.widgets.support.geolocationUtils"),wQe={maximumAge:0,timeout:15e3,enableHighAccuracy:!0};function xQe(){const t=ee("esri-geolocation");return t||tme.warn("geolocation-unsupported","Geolocation unsupported."),t}function SQe(){const t=window.isSecureContext;return t||tme.warn("insecure-context","Geolocation requires a secure origin."),t}function rY(){return xQe()&&SQe()}function TQe(t){return t||(t=wQe),new Promise((i,n)=>{setTimeout(()=>n(new V("geolocation:timeout","getting the current geolocation position timed out")),15e3),navigator.geolocation.getCurrentPosition(i,n,t??void 0)})}function IQe(t,e){const{position:i,view:n}=t,r=CQe(i),s=r==null?void 0:r.coords;if(!s)throw new V("geometry-service:no-coords","Geolocation has no coordinates");return EQe(MQe(s),n,e)}function CQe(t){const e=t&&t.coords||{},i={accuracy:e.accuracy,altitude:e.altitude,altitudeAccuracy:e.altitudeAccuracy,heading:e.heading,latitude:e.latitude,longitude:e.longitude,speed:e.speed};return t&&{coords:i,timestamp:t.timestamp}}function MQe({longitude:t,latitude:e,altitude:i}){return new pe({longitude:t,latitude:e,z:i||void 0,spatialReference:{wkid:4326}})}function EQe(t,e,i){if(!e)return Promise.resolve(t);const n=e.spatialReference;return n.isWGS84?Promise.resolve(t):n.isWebMercator?Promise.resolve(qh(t)):AQe(i).then(r=>{if(!r)throw new V("geometry-service:missing-url","Geometry service URL is missing");const s=new eme({geometries:[t],outSpatialReference:n});return bQe(r,s,i).then(o=>o[0])})}function AQe(t){if(Tt.geometryServiceUrl)return Promise.resolve(Tt.geometryServiceUrl);const e=nr.getDefault();return e.load(t).catch(()=>{}).then(()=>e.get("helperServices.geometry.url"))}function ds(t,e){return t.hasOwnProperty(e)&&t[e]!=null&&t[e]!==""}const $Qe=()=>fy("esri/widgets/Search/t9n/Search"),ime="esri.widgets.Search.SearchViewModel",Ku=ne.getLogger(ime),sY="highlight",_E=xe.ofType({key:t=>t.layer?"layer":"locator",base:mB,typeMap:{layer:n_,locator:Qfe}}),oY=Ee.WGS84,PQe="esri/images/search/search-symbol-32.png",kQe=/<(?:.|\s)*?>/g,s_=-1;let rt=class extends coe(Uo.EventedMixin(ye)){constructor(t){super(t),this._gotoController=null,this._searching=null,this._updatingPromise=null,this._createdFeatureLayers=[],this.autoNavigate=!0,this.autoSelect=!0,this.defaultPopupTemplate=null,this.defaultSources=new _E,this.defaultSymbols={point:new Mf({url:xt(PQe),size:24,width:24,height:24}),polyline:new Ur({color:[130,130,130,1],width:2}),polygon:new Pc({color:[235,235,235,.4],outline:{color:[130,130,130,1],width:2}})},this.includeDefaultSources=!0,this.maxInputLength=128,this.maxResults=6,this.maxSuggestions=6,this.messages=null,this.minSuggestCharacters=3,this.popupEnabled=!0,this.popupTemplate=null,this.portal=nr.getDefault(),this.resultCount=null,this.resultGraphicEnabled=!0,this.resultGraphic=null,this.results=null,this.selectedSuggestion=null,this.searchAllEnabled=!0,this.selectedResult=null,this.sources=new _E,this.suggestionDelay=350,this.suggestionCount=null,this.suggestions=null,this.suggestionsEnabled=!0,this.view=null}initialize(){const t=async()=>{const e=await $Qe();this.messages=e,this.defaultPopupTemplate=new Jf({title:e.searchResult,content:"{Match_addr}"})};t(),this.addHandles([Q(()=>[this.includeDefaultSources,this.view,this.portal],()=>this._update(),He),FS(t)])}destroy(){this.removeAllHandles(),this._destroyFeatureLayers(),this._abortGoTo(),this.clearGraphics()}get activeSource(){return this.allSources.at(this.activeSourceIndex)??null}get activeSourceIndex(){return this.allSources.length===1||!this.searchAllEnabled?0:s_}set activeSourceIndex(t){this._overrideIfSome("activeSourceIndex",t)}get allPlaceholder(){var t;return(t=this.messages)==null?void 0:t.allPlaceholder}set allPlaceholder(t){this._overrideIfSome("allPlaceholder",t)}get allSources(){const{sources:t,defaultSources:e,includeDefaultSources:i}=this,n=typeof i=="function"?i.call(null,{sources:t,defaultSources:e}):i?e.concat(t):t,r=this._get("allSources")||new _E;return r.removeAll(),r.addMany(n.filter(Boolean)),r}get locationEnabled(){return this._get("locationEnabled")||rY()}set locationEnabled(t){if(t===void 0)return void this._clearOverride("locationEnabled");const e=rY();if(t&&!e){const i=new V("locationEnabled:geolocation-unsupported","Geolocation API is unsupported.",{geolocation:navigator.geolocation});Ku.error(i)}this._override("locationEnabled",!!t&&e)}get placeholder(){const{allSources:t,activeSourceIndex:e,allPlaceholder:i}=this;if(e===s_)return i??"";const n=t.at(e);return(n==null?void 0:n.placeholder)??""}set searchTerm(t){this._set("searchTerm",t||""),this.clearGraphics(),this.selectedSuggestion&&this.selectedSuggestion.text!==t&&this._set("selectedSuggestion",null),t===""&&this._clear()}get searchTerm(){return this._get("searchTerm")||""}get state(){return this._searching?"searching":this.updating?"loading":this.allSources.length===0?"disabled":"ready"}get updating(){return this._updatingPromise!=null}clear(){this.searchTerm=""}clearGraphics(){this._removeHighlight(),this._closePopup();const{view:t,resultGraphic:e}=this;t&&e&&t.graphics.remove(e),this._set("resultGraphic",null)}search(t,e){this.emit("search-start"),this.clearGraphics();const i=this._createSuggestionForSearch(t),n=(async()=>{var r;try{await this.when();const s=await this._getResultsFromSources(i,e);if((r=e==null?void 0:e.signal)!=null&&r.aborted)return null;const o={activeSourceIndex:this.activeSourceIndex,searchTerm:i.text??"",numResults:0,numErrors:0,errors:[],results:[]};this._formatResponse(o,s,i);const a=this._getFirstResult(o.results),l=i.location&&a?a.name:i.text,c=l==null?void 0:l.replace(kQe,"");return this._set("searchTerm",c),(i.key&&typeof i.sourceIndex=="number"||i.location)&&this._set("selectedSuggestion",i),this._set("results",o.results),this._set("resultCount",o.results.reduce((u,d)=>{var f;return u+(((f=d.results)==null?void 0:f.length)??0)},0)),this.emit("search-complete",o),await this._selectFirstResult(a),o}finally{this._clearSearching()}})();return this._searching=n,n}async searchNearby(t){if(!this.locationEnabled){const i=new V("searchNearby:geolocation-unsupported","Geolocation API is unsupported.",{geolocation:navigator.geolocation});throw Ku.error(i),i}const e=(async()=>{try{const i=await TQe(),n=await IQe({position:i,view:this.view},t);return await this.search(n,t)}finally{this._clearSearching()}})();return this._searching=e,e}async select(t){if(this.clearGraphics(),!t){const M=new V("select:missing-parameter","Cannot select without a searchResult.",{searchResult:t});throw Ku.error(M),M}const{view:e}=this,i=ds(t,"sourceIndex")?t.sourceIndex:this._getSourceIndexOfResult(t),n=i!=null?this.allSources.at(i):null;if(!n){const M=new V("select:missing-source","Cannot select without a source.",{source:n});throw Ku.error(M),M}const r=n instanceof n_?this._getLayerSourcePopupTemplate(n):n.popupTemplate,s=n.resultSymbol||this._getDefaultSymbol(t),o=ds(n,"resultGraphicEnabled")?n.resultGraphicEnabled:this.resultGraphicEnabled,a=ds(n,"autoNavigate")?n.autoNavigate:this.autoNavigate,l=(ds(n,"popupEnabled")?n.popupEnabled:this.popupEnabled)?r||this.popupTemplate||this.defaultPopupTemplate:null,{feature:c}=t;if(!c){const M=new V("select:missing-feature","Cannot select without a feature.",{feature:c});throw Ku.error(M),M}const{attributes:u,geometry:d,layer:f,sourceLayer:m}=c,g=iY(d),y={layerViewQuery:this._getLayerView(c),elevationQuery:e&&g!=null?RKe(g,e).catch(()=>g):Promise.resolve(g)},_=await Sn(y),b=_.layerViewQuery.value,w=_.elevationQuery.value;s instanceof o0&&(s.text=t.name);const x=e&&a?t.target||t.extent:null;await(x!=null?this._goToSearchResult(x):Promise.resolve());const T=b?c:new Vo({geometry:d,symbol:s,attributes:u,layer:f,sourceLayer:m,popupTemplate:l}),I=e==null?void 0:e.popup,C=I&&T.getEffectivePopupTemplate(I.defaultPopupTemplateEnabled);return C&&await e.openPopup({features:[T],location:w}),b&&Tce(b)&&!C&&this._highlightFeature({graphic:T,layerView:b}),!b&&o&&e&&e.graphics.push(T),this._setResultFloor(t),this._set("selectedResult",t),this._set("resultGraphic",T),this.emit("select-result",{result:t,source:n,sourceIndex:i}),t}async suggest(t,e,i){const n=t||this.searchTerm;this.emit("suggest-start",{searchTerm:n}),await this._suggestTimer(e,i);const r=await this._suggestImmediate(n,i);return this._set("suggestions",r==null?void 0:r.results),this._set("suggestionCount",(r==null?void 0:r.results.reduce((s,o)=>{var a;return s+(((a=o.results)==null?void 0:a.length)??0)},0))??null),this.emit("suggest-complete",r),r}async when(){await Lu(()=>!this.updating)}async _update(){const{portal:t,view:e}=this;if(this.includeDefaultSources){const i=this._updatingPromise=Sn([t==null?void 0:t.load(),e==null?void 0:e.when()]);if(this.destroyed||(await i,i!==this._updatingPromise))return}await Lu(()=>this.messages),this.destroyed||this._updateDefaultSources(),this._updatingPromise=null}_clearSearching(){this._searching=null}_convertHelperServices(){var e,i;const t=(i=(e=this.portal)==null?void 0:e.helperServices)==null?void 0:i.geocode;return t?t.map(n=>{var a;if(n.placefinding===!1)return;const r=Tt.apiKey&&nY(n.url)?{url:dQe}:null,s=Qfe.fromJSON({...n,...r}),o=s.url;if(nY(o)||hQe(o)||uQe(o)){const l=s.outFields??["Addr_type","Match_addr","StAddr","City"],c=(s.placeholder||((a=this.messages)==null?void 0:a.placeholder))??"",u=typeof s.defaultZoomScale=="number"?s.defaultZoomScale:2500;s.singleLineFieldName="SingleLine",s.outFields=l,s.placeholder=c,s.defaultZoomScale=u}return s.singleLineFieldName?s:void 0}).filter(Ti):[]}_destroyFeatureLayers(){this._createdFeatureLayers.forEach(t=>t==null?void 0:t.destroy()),this._createdFeatureLayers=[]}_getLayerSources(t,e){var n;const i=(n=this.view)==null?void 0:n.map;return t.map(r=>{const s=i.findLayerById(r.id);if(!s)return;const o=this._getLayerJSON(r),a=n_.fromJSON(o);return a.placeholder=e,this._getLayer(s,o).then(l=>{a.layer=l}),a}).filter(Ti).toArray()}_getTableSources(t,e){var n;const i=(n=this.view)==null?void 0:n.map;return t.map(r=>{if(!r.id)return;const s=i.findTableById(r.id);if(!s)return;const o=this._getLayerJSON(r),a=n_.fromJSON(o);return a.placeholder=e,this._getLayer(s,o).then(l=>{a.layer=l}),a}).filter(Ti).toArray()}_convertApplicationProperties(){var o,a,l;const t=(o=this.view)==null?void 0:o.map,e=(l=(a=t==null?void 0:t.applicationProperties)==null?void 0:a.viewing)==null?void 0:l.search;if(!e)return[];const{enabled:i,hintText:n,layers:r,tables:s}=e;return i?[...this._getLayerSources(r,n),...this._getTableSources(s,n)]:[]}async _getSubLayer(t,e){var r;if(await t.load(),!t.allSublayers)throw new Error;const i=t.allSublayers.find(s=>s.id===e.subLayer);if(!i)throw new Error;const n=await((r=i.createFeatureLayer)==null?void 0:r.call(i));if(!n)throw new Error;return this._createdFeatureLayers.push(n),n}async _getBuildingSubLayer(t,e){await t.load();const i=t.allSublayers.find(n=>n.id===e.subLayer);if((i==null?void 0:i.type)!=="building-component")throw new Error;if(await i.load(),i.associatedLayer==null)throw new Error;return await i.associatedLayer.load(),i}async _getLayer(t,e){if(t.type==="feature"||t.type==="scene"||t.type==="csv"||t.type==="geojson"||t.type==="ogc-feature")return t;if(t.type==="map-image")try{return await this._getSubLayer(t,e)}catch{const n=new V("search:create-featurelayer","Could not create a FeatureLayer from the MapImageLayer",{layer:t});return Ku.error(n),null}return t.type==="building-scene"?this._getBuildingSubLayer(t,e):null}_getLayerJSON(t){return typeof t.toJSON=="function"?t.toJSON():t}_updateDefaultSources(){const{defaultSources:t,includeDefaultSources:e}=this;this._destroyFeatureLayers(),t.removeAll(),e&&t.addMany([...this._convertApplicationProperties(),...this._convertHelperServices()])}_abortGoTo(){this._gotoController&&this._gotoController.abort(),this._gotoController=null}_clear(){this._abortGoTo(),this._set("resultCount",null),this._set("results",null),this._set("suggestions",null),this._set("suggestionCount",null),this._set("selectedResult",null),this._set("selectedSuggestion",null),this.emit("search-clear")}_closePopup(){var r;const t=(r=this.view)==null?void 0:r.popup,{resultGraphic:e}=this;if(!t||!e)return;const i="selectedFeature"in t,n=i?t.selectedFeature:null;i&&n&&n===e&&t.close()}_suggestTimer(t,e){const i=t??this.suggestionDelay;return J$(i,null,e&&e.signal)}_createLocationForSearch(t){return t instanceof Vo?iY(t.geometry):t instanceof pe?t:Array.isArray(t)&&t.length===2?new pe({longitude:t[0],latitude:t[1]}):null}_createSuggestionForSearch(t){if(t&&ds(t,"key")&&ds(t,"text")&&ds(t,"sourceIndex"))return t;const e=this._createLocationForSearch(t),i=typeof t=="string"?t:this.searchTerm,{selectedSuggestion:n,selectedResult:r}=this,s=!t&&n&&r,o=s&&n.key===r.key&&n.sourceIndex===r.sourceIndex,a=s&&n.location;return o||a?n:{location:e,text:e?"":i,sourceIndex:null,key:null}}_getFirstResult(t){let e=null;return t&&t.some(i=>{const{results:n}=i,r=n==null?void 0:n[0],s=!!r;return s&&(e=r),s}),e}async _selectFirstResult(t){return this.autoSelect&&t?this.select(t):null}async _suggestImmediate(t,e){var r;await this.when();const i=await this._getSuggestionsFromSources(t,e);if((r=e==null?void 0:e.signal)!=null&&r.aborted)return null;const n={activeSourceIndex:this.activeSourceIndex,searchTerm:t??"",numResults:0,numErrors:0,errors:[],results:[]};return this._formatResponse(n,i),n}_formatSourceResponse(t,e,i){const n=(e==null?void 0:e.value)||[],r=e==null?void 0:e.error,s=this.allSources.at(i);if(r){const o={sourceIndex:i,source:s,error:r};t.errors.push(o),Ku.error(r),t.numErrors++}else{const o={sourceIndex:i,source:s,results:n};t.results.push(o),t.numResults+=n.length}}_formatResponse(t,e,i){if(e)if(t.activeSourceIndex===s_){const n=i&&ds(i,"sourceIndex")&&i.sourceIndex!==-1?i.sourceIndex:void 0;e.forEach((r,s)=>{const o=n!==void 0?n:s;this._formatSourceResponse(t,r,o)})}else this._formatSourceResponse(t,e[0],t.activeSourceIndex)}async _getResultsFromSources(t,e){const{allSources:i}=this,n=!t.location&&ds(t,"sourceIndex")?t.sourceIndex:this.activeSourceIndex,r=[];if(!i.length){const s=new V("search:no-sources-defined","At least one source is required.",{allSources:i});throw Ku.error(s),s}return n===s_?i.forEach((s,o)=>{r.push(this._getResultsFromSource(t,o,e))}):r.push(this._getResultsFromSource(t,n,e)),Sn(r)}async _getSuggestionsFromSources(t,e){const{allSources:i,activeSourceIndex:n}=this,r=[];if(!i.length){const s=new V("suggest:no-sources-defined","At least one source is required.",{allSources:i});throw Ku.error(s),s}return n===s_?i.forEach((s,o)=>{r.push(this._getSuggestionsFromSource(t,o,e))}):r.push(this._getSuggestionsFromSource(t,n,e)),Sn(r)}async _getResultsFromSource(t,e,i){var c,u;const n=e!=null?this.allSources.at(e):null;if(!n)return null;const{location:r=null}=t,s=((c=this.view)==null?void 0:c.spatialReference)||oY,o=ds(n,"maxResults")?n.maxResults:this.maxResults,a=!!(n instanceof n_&&ds(n,"exactMatch"))&&n.exactMatch,{view:l}=this;return(u=n.getResults)==null?void 0:u.call(n,{view:l,sourceIndex:e,location:r,suggestResult:t,spatialReference:s,exactMatch:a,maxResults:o},i)}async _getSuggestionsFromSource(t,e,i){var a,l;const n=this.allSources.at(e);if(!n)return null;t??(t="");const r=ds(n,"suggestionsEnabled")?n.suggestionsEnabled:this.suggestionsEnabled,s=t==null?void 0:t.length,o=ds(n,"minSuggestCharacters")?n.minSuggestCharacters:this.minSuggestCharacters;if(r&&t.trim()&&s>=o){const c=((a=this.view)==null?void 0:a.spatialReference)||oY,u=ds(n,"maxSuggestions")?n.maxSuggestions:this.maxSuggestions,{view:d}=this,f=!!(n instanceof n_&&ds(n,"exactMatch"))&&n.exactMatch;return(l=n.getSuggestions)==null?void 0:l.call(n,{view:d,sourceIndex:e,suggestTerm:t,spatialReference:c,maxSuggestions:u,exactMatch:f},i)}return null}_getLayerSourcePopupTemplate(t){const{layer:e}=t;if(e)return ds(t,"popupTemplate")?t.popupTemplate:e.popupTemplate}_getSourceIndexOfResult(t){const e=this.results;if(!e)return null;let i=null;return e.some(n=>n.results.some(r=>r===t&&(i=n.sourceIndex,!0))),i}async _goToSearchResult(t){this._abortGoTo();const e=new AbortController;this._gotoController=e;const i={target:{target:t},options:{signal:e.signal}};t||(i.options.animate=!1),await this.callGoTo(i),this._gotoController=null}_getDefaultSymbol(t){var n;const{defaultSymbols:e}=this,i=(n=t.feature)==null?void 0:n.geometry;if(i==null)return null;switch(i.type){case"point":case"multipoint":return e.point;case"polyline":return e.polyline;case"extent":case"polygon":return e.polygon;default:return null}}_removeHighlight(){this.removeHandles(sY)}async _getLayerView(t){var n,r;const{view:e}=this;if(!t||!e||((n=t.layer)==null?void 0:n.type)==="building-component"||((r=t.layer)==null?void 0:r.type)==="subtype-sublayer")return null;const{layer:i}=t;return i?(await e.when(),e.whenLayerView(i)):null}_highlightFeature(t){const{graphic:e,layerView:i}=t,{attributes:n,layer:r}=e,{objectIdField:s}=r,o=(s&&(n==null?void 0:n[s]))??null,a=i.highlight(o??e);this.addHandles(a,sY)}_setResultFloor(t){var r,s,o;const{view:e}=this,i=(r=t.feature)==null?void 0:r.attributes,n=(s=t.feature)==null?void 0:s.sourceLayer;if(n&&"floorInfo"in n&&((o=n==null?void 0:n.floorInfo)!=null&&o.floorField)&&i){const a=i[n.floorInfo.floorField];e==null||e.emit("select-result-floor",a)}}};rt.ALL_INDEX=s_,h([p()],rt.prototype,"_searching",void 0),h([p()],rt.prototype,"_updatingPromise",void 0),h([p({readOnly:!0,value:null})],rt.prototype,"activeSource",null),h([p()],rt.prototype,"activeSourceIndex",null),h([p()],rt.prototype,"allPlaceholder",null),h([p({readOnly:!0})],rt.prototype,"allSources",null),h([p()],rt.prototype,"autoNavigate",void 0),h([p()],rt.prototype,"autoSelect",void 0),h([p()],rt.prototype,"defaultPopupTemplate",void 0),h([p({readOnly:!0})],rt.prototype,"defaultSources",void 0),h([p()],rt.prototype,"defaultSymbols",void 0),h([p()],rt.prototype,"includeDefaultSources",void 0),h([p()],rt.prototype,"locationEnabled",null),h([p()],rt.prototype,"maxInputLength",void 0),h([p()],rt.prototype,"maxResults",void 0),h([p()],rt.prototype,"maxSuggestions",void 0),h([p()],rt.prototype,"messages",void 0),h([p()],rt.prototype,"minSuggestCharacters",void 0),h([p({readOnly:!0})],rt.prototype,"placeholder",null),h([p()],rt.prototype,"popupEnabled",void 0),h([p({type:Jf})],rt.prototype,"popupTemplate",void 0),h([p({type:nr})],rt.prototype,"portal",void 0),h([p()],rt.prototype,"resultCount",void 0),h([p()],rt.prototype,"resultGraphicEnabled",void 0),h([p({readOnly:!0})],rt.prototype,"resultGraphic",void 0),h([p({readOnly:!0})],rt.prototype,"results",void 0),h([p({readOnly:!0})],rt.prototype,"selectedSuggestion",void 0),h([p()],rt.prototype,"searchAllEnabled",void 0),h([p({readOnly:!0})],rt.prototype,"selectedResult",void 0),h([p()],rt.prototype,"searchTerm",null),h([p({type:_E})],rt.prototype,"sources",void 0),h([p({readOnly:!0})],rt.prototype,"state",null),h([p()],rt.prototype,"suggestionDelay",void 0),h([p()],rt.prototype,"suggestionCount",void 0),h([p({readOnly:!0})],rt.prototype,"suggestions",void 0),h([p()],rt.prototype,"suggestionsEnabled",void 0),h([p({readOnly:!0})],rt.prototype,"updating",null),h([p()],rt.prototype,"view",void 0),h([p()],rt.prototype,"clear",null),rt=h([P(ime)],rt);const x_=rt;let Fp=class extends qi{constructor(t,e){super(t,e),this.messages=null,this.showMoreResultsOpen=!1,this.viewModel=null}destroy(){this.viewModel=null}render(){const t={[Xu.showMoreResults]:this.showMoreResultsOpen};return O("div",{class:Xu.base},O("div",{key:"esri-search-renderer__container",class:this.classes(Xu.moreResults,t)},this.renderSearchResultName(),this.renderMoreResults()))}renderMoreResults(){return O("div",{key:"esri-search-renderer__more-results"},this.renderMoreResultsButton(),this.renderMoreResultsLists())}renderSearchResultName(){var i;const t=(i=this.viewModel)==null?void 0:i.selectedResult,e=t&&t.name||"";return O("div",{key:"esri-search-renderer__result-name",class:Xu.moreResultsItem},e)}renderMoreResultsLists(){const{viewModel:t}=this;if(!t)return[];const e=t.results;if((t.resultCount??0)<2)return null;const i=e==null?void 0:e.map(n=>this.renderMoreResultsList(n));return O("div",{key:"esri-search-renderer__more-results-container",class:Xu.moreResultsList},i)}renderMoreResultsButton(){const{messages:t,viewModel:e}=this;return e?(e.resultCount??0)<2?null:O("div",{key:"esri-search-renderer__more-results-button",class:Xu.moreResultsItem},O("a",{class:Xu.anchor,href:"#",bind:this,onclick:this._showMoreResultsClick,onkeydown:this._showMoreResultsClick},this.showMoreResultsOpen?t.hideMoreResults:t.showMoreResults)):null}renderMoreResultsHeader(t,e){return O("div",{key:`esri-search-result-renderer__header-${e}`,class:Xu.moreResultsListHeader},t)}renderMoreResultsList(t){var u,d,f;const{results:e}=t,i=(e==null?void 0:e.length)??0,n=i>0,r=(u=this.viewModel)==null?void 0:u.selectedResult,s=i===1&&e[0]===r,o=this._getSourceName(t.source,t.sourceIndex),a=(((f=(d=this.viewModel)==null?void 0:d.results)==null?void 0:f.length)??0)>1&&!s?this.renderMoreResultsHeader(o,t.sourceIndex):null,l=n&&e.map((m,g)=>this.renderMoreResultsListItem(m,g)),c=n&&!s?O("ul",{key:`esri-search-result-renderer__list-${t.sourceIndex}`},l):null;return n?O("div",{key:`esri-search-result-renderer__results-${t.sourceIndex}`},a,c):null}renderMoreResultsListItem(t,e){return t!==this.get("viewModel.selectedResult")?O("li",{key:`esri-search-result-renderer__list-item-${e}`},O("a",{class:Xu.anchor,href:"#",tabindex:"0",bind:this,"data-result":t,onclick:this._selectResultClick,onkeydown:this._selectResultClick},t.name)):null}_showMoreResultsClick(t){t.preventDefault(),this.showMoreResultsOpen=!this.showMoreResultsOpen;const e=this.get("viewModel.view.popup");e&&e.reposition()}_selectResultClick(t){var i;t.preventDefault();const e=t.currentTarget["data-result"];(i=this.viewModel)==null||i.select(e)}_getSourceName(t,e){return e===x_.ALL_INDEX?this.messages.all:t.name}};h([p(),Zt("esri/widgets/Search/t9n/Search")],Fp.prototype,"messages",void 0),h([p()],Fp.prototype,"showMoreResultsOpen",void 0),h([p()],Fp.prototype,"viewModel",void 0),h([Dr()],Fp.prototype,"_showMoreResultsClick",null),h([Dr()],Fp.prototype,"_selectResultClick",null),Fp=h([P("esri.widgets.Search.SearchResultRenderer")],Fp);const OQe=Fp,LQe=/<[a-z/][\s\S]*>/i,RQe=(t,e)=>{const i=tye(e).split(/\s/),n=new RegExp(`(${i.join("|")})`,"gi");return t.replace(n,r=>`<strong>${r}</strong>`)};let st=class extends qi{constructor(t,e){super(t,e),this._activeMenuItemIndex=-1,this._inputNode=null,this._menuItemCount=0,this._sourceMenuButtonNode=null,this._sourceListNode=null,this._suggestionListNode=null,this._searchResultRenderer=new OQe,this._suggestController=null,this._searchController=null,this._locateFailed=!1,this._container=null,this.activeMenu="none",this.disabled=!1,this.iconClass=Oe.widgetIcon,this.icon=null,this.messages=null,this.messagesCommon=null,this.viewModel=new x_,this._clearActiveMenu=()=>{this.activeMenu="none"},this._removeActiveMenu=i=>{var r;const n=i.relatedTarget;n&&((r=this._container)!=null&&r.contains(n))||this._clearActiveMenu()},this.addHandles([Q(()=>this.searchTerm,i=>{(i&&this.activeMenu==="warning"||!i&&!this.get("viewModel.selectedSuggestion.location"))&&this._clearActiveMenu()}),on(()=>{var i;return(i=this.viewModel)==null?void 0:i.allSources},"change",()=>this._watchSourceChanges()),Q(()=>this.activeMenu,()=>this._resetActiveMenuItemIndex(),He),Q(()=>{var i;return(i=this.viewModel)==null?void 0:i.defaultPopupTemplate},i=>{i&&(i.content=this._renderSearchResultsContent.bind(this))},He)])}destroy(){this.removeAllHandles(),this._cancelSuggest(),this._cancelSearch(),this._searchResultRenderer=Je(this._searchResultRenderer)}get displayedSearchTerm(){return`${this.viewModel.searchTerm}`.trim()}get inputId(){return this._buildId("input")}get suggestionsMenuId(){return this._buildId("suggest-menu")}get sourceMenuId(){return this._buildId("source-menu")}get sourceMenuButtonId(){return this._buildId("source-menu-button")}get activeSource(){var t;return(t=this.viewModel)==null?void 0:t.activeSource}get activeSourceIndex(){return this.viewModel.activeSourceIndex}set activeSourceIndex(t){this.viewModel.activeSourceIndex=t}get allPlaceholder(){return this.viewModel.allPlaceholder}set allPlaceholder(t){this.viewModel.allPlaceholder=t}get allSources(){return this.viewModel.allSources}get autoNavigate(){return this.viewModel.autoNavigate}set autoNavigate(t){this.viewModel.autoNavigate=t}get autoSelect(){return this.viewModel.autoSelect}set autoSelect(t){this.viewModel.autoSelect=t}get defaultSources(){return this.viewModel.defaultSources}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(t){this.viewModel.goToOverride=t}get includeDefaultSources(){return this.viewModel.includeDefaultSources}set includeDefaultSources(t){this.viewModel.includeDefaultSources=t}get label(){var t;return((t=this.messages)==null?void 0:t.widgetLabel)??""}set label(t){this._overrideIfSome("label",t)}get locationEnabled(){return this.viewModel.locationEnabled}set locationEnabled(t){this.viewModel.locationEnabled=t}get maxResults(){return this.viewModel.maxResults}set maxResults(t){this.viewModel.maxResults=t}get maxSuggestions(){return this.viewModel.maxSuggestions}set maxSuggestions(t){this.viewModel.maxSuggestions=t}get minSuggestCharacters(){return this.viewModel.minSuggestCharacters}set minSuggestCharacters(t){this.viewModel.minSuggestCharacters=t}get popupEnabled(){return this.viewModel.popupEnabled}set popupEnabled(t){this.viewModel.popupEnabled=t}get popupTemplate(){return this.viewModel.popupTemplate}set popupTemplate(t){this.viewModel.popupTemplate=t}get portal(){var t;return(t=this.viewModel)==null?void 0:t.portal}set portal(t){this.viewModel&&(this.viewModel.portal=t)}get resultGraphic(){return this.viewModel.resultGraphic}set resultGraphic(t){this.viewModel.resultGraphic=t}get resultGraphicEnabled(){return this.viewModel.resultGraphicEnabled}set resultGraphicEnabled(t){this.viewModel.resultGraphicEnabled=t}get results(){return this.viewModel.results}get searchAllEnabled(){return this.viewModel.searchAllEnabled}set searchAllEnabled(t){this.viewModel.searchAllEnabled=t}get searchTerm(){return this.viewModel.searchTerm}set searchTerm(t){this.viewModel.searchTerm=t}get selectedResult(){return this.viewModel.selectedResult}get sources(){return this.viewModel.sources}set sources(t){this.viewModel.sources=t}get suggestions(){return this.viewModel.suggestions}get suggestionsEnabled(){return this.viewModel.suggestionsEnabled}set suggestionsEnabled(t){this.viewModel.suggestionsEnabled=t}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}clear(){this.viewModel.clear()}focus(){var t;(t=this._inputNode)==null||t.focus(),this.emit("search-focus")}blur(){var t;(t=this._inputNode)==null||t.blur(),this.emit("search-blur")}async search(t){this._clearActiveMenu(),this._cancelSuggest(),this._cancelSearch();const e=new AbortController,{signal:i}=e;this._searchController=e;try{const n=await this.viewModel.search(t,{signal:i});return this._searchController!==e?void 0:(this.activeMenu=n!=null&&n.numResults?"none":"warning",this._searchController=null,n)}catch{return this._searchController!==e?void 0:(this._clearActiveMenu(),void(this._searchController=null))}}async suggest(t){this._cancelSuggest();const e=new AbortController,{signal:i}=e;this._suggestController=e;try{const n=await this.viewModel.suggest(t,null,{signal:i});return this._suggestController!==e?void 0:(this._suggestController=null,n!=null&&n.numResults&&this._openSuggestionMenu(),this._scrollToTopSuggestion(),n)}catch{return this._suggestController!==e||(this._suggestController=null),null}}render(){const{state:t}=this.viewModel,e={[Oe.disabled]:t==="disabled",[Oe.esriWidgetDisabled]:this.disabled};return O("div",{class:this.classes(Oe.base,e)},t==="loading"?this.renderLoader():this.renderContainer())}renderSubmitButton(){const{messages:t,disabled:e}=this;return O("button",{"aria-label":t.searchButtonTitle,bind:this,disabled:e,class:this.classes(Oe.submitButton,Oe.button),key:"esri-search__submit-button",onclick:this._handleSearchButtonClick,title:t.searchButtonTitle,type:"button"},O("span",{"aria-hidden":"true",class:Oe.searchIcon}))}renderWarningMenu(){return O("div",{key:"esri-search__error-menu",class:this.classes(Oe.menu,Oe.warningMenu)},O("div",{class:Oe.warningMenuBody},this.renderWarning()))}renderSourceMenuButton(){const{messages:t,activeMenu:e,sourceMenuId:i,sourceMenuButtonId:n,disabled:r}=this,{activeSourceIndex:s,allSources:o}=this.viewModel;return o.length>1?O("button",{id:n,key:"esri-search__source-menu-button",bind:this,disabled:r,"aria-label":t.searchIn,title:t.searchIn,"aria-haspopup":"true","aria-expanded":(e==="source").toString(),"aria-controls":i,class:this.classes(Oe.sourcesButton,Oe.button),onclick:this._handleSourcesMenuToggleClick,onfocus:this._handleSourcesMenuToggleFocus,afterCreate:uf,"data-node-ref":"_sourceMenuButtonNode",type:"button"},O("span",{"aria-hidden":"true",class:Oe.dropdownIcon}),O("span",{"aria-hidden":"true",class:Oe.dropupIcon}),O("span",{class:Oe.sourceName},this._getSourceName(s))):null}renderSourcesList(){const{allSources:t,searchAllEnabled:e}=this.viewModel,{_activeMenuItemIndex:i,activeMenu:n,sourceMenuId:r,sourceMenuButtonId:s}=this,o=n==="source"&&i>-1?this._buildId("source-item",i):null;return t.length>1?O("ul",{"aria-activedescendant":o,"aria-labelledby":s,id:r,role:"menu",bind:this,afterCreate:uf,onkeydown:this._handleSourceMenuKeydown,onkeyup:this._handleSourceMenuKeyup,"data-node-ref":"_sourceListNode",class:Oe.menuList,tabIndex:-1},e?this.renderSource(x_.ALL_INDEX):null,t.map((a,l)=>this.renderSource(l)).toArray()):null}renderSourcesMenu(){const{allSources:t}=this.viewModel;return t.length>1?O("div",{key:"esri-search__source-menu",class:this.classes(Oe.menu,Oe.sourcesMenu)},this.renderSourcesList()):null}renderLoader(){const{messages:t,messagesCommon:e,disabled:i}=this;return O("div",{class:Oe.loader,key:"base-loader",tabIndex:i?-1:void 0},O("span",{"aria-hidden":"true",class:Oe.loaderAnimation}),O("span",{class:Oe.fallbackText},t.searchButtonTitle),O("span",{class:Oe.loaderText},e.loading))}renderContainer(){const{allSources:t,state:e}=this.viewModel,{activeMenu:i}=this,n={[Oe.hasMultipleSources]:t.length>1,[Oe.isLoading]:e==="loading",[Oe.isSearching]:e==="searching",[Oe.showWarning]:i==="warning",[Oe.showSources]:i==="source",[Oe.showSuggestions]:i==="suggestion"};return O("div",{tabIndex:-1,afterCreate:r=>{this._container=r,r.addEventListener("focusout",this._removeActiveMenu)},afterRemoved:r=>{r.removeEventListener("focusout",this._removeActiveMenu)},class:this.classes(n,Oe.container),key:"base-container"},this.renderSourceMenuButton(),this.renderSourcesMenu(),this.renderInputContainer(),this.renderSubmitButton(),this.renderWarningMenu())}renderClearButton(){return this.searchTerm?O("button",{bind:this,disabled:this.disabled,class:this.classes(Oe.clearButton,Oe.button),key:"esri-search__clear-button",onclick:this._handleClearButtonClick,onfocus:this._clearActiveMenu,title:this.messages.clearButtonTitle,type:"button"},O("span",{"aria-hidden":"true",class:Oe.clearIcon})):null}renderLocationGroup(){const{messages:t,locationEnabled:e,displayedSearchTerm:i}=this,n=e&&!i,r=this.activeMenu==="suggestion"&&this._activeMenuItemIndex===0;return n?O("ul",{role:"group",key:"esri-search__suggestion-list-current-location",class:this.classes(Oe.menuList,Oe.suggestionList,Oe.suggestionListCurrentLocation)},O("li",{bind:this,"data-current-location-item":!0,onclick:this._handleUseCurrentLocationClick,id:this._buildId("suggestion-item",0),"aria-selected":(this.activeMenu==="suggestion"&&this._activeMenuItemIndex===0).toString(),role:"option",class:this.classes(Oe.menuItem,r?Oe.menuItemFocus:null)},O("span",{"aria-hidden":"true",class:Oe.locate})," ",t.useCurrentLocation)):null}renderInput(){const{activeMenu:t,locationEnabled:e,displayedSearchTerm:i,messages:n,suggestionsMenuId:r,inputId:s,_activeMenuItemIndex:o,disabled:a}=this,{maxInputLength:l,placeholder:c,searchTerm:u,suggestionCount:d}=this.viewModel,f=!(!(e&&!i)&&!d),m=t==="suggestion"&&o>-1?this._buildId("suggestion-item",o):null;return O("input",{"aria-activedescendant":m,"aria-autocomplete":"list","aria-expanded":(f&&t==="suggestion").toString(),"aria-controls":f?r:null,"aria-haspopup":"listbox","aria-label":n.searchButtonTitle,bind:this,disabled:a,placeholder:c,maxlength:l,autocomplete:"off",type:"text",class:this.classes(Oe.esriInput,Oe.input),value:u,id:s,role:"combobox",onkeyup:this._handleInputKeyup,onclick:this._openSuggestionMenu,oninput:this._handleInputPaste,onpaste:this._handleInputPaste,afterCreate:uf,"data-node-ref":"_inputNode",onfocus:this.focus,onblur:this.blur,title:u?"":c})}renderForm(){return O("form",{key:"esri-search__form",bind:this,disabled:this.disabled,class:Oe.form,onsubmit:this._formSubmit,role:"search"},this.renderInput())}renderSuggestList(t){const{sourceIndex:e}=t,{results:i}=t;return(i==null?void 0:i.length)?O("ul",{role:"group",key:`esri-search__suggestion-list-${e}`,class:this.classes(Oe.menuList,Oe.suggestionList)},i==null?void 0:i.map(r=>this.renderSuggestion(r,this._menuItemCount++))):null}renderSuggestionsGroup(){const{suggestions:t}=this.viewModel;return t?t.map(e=>[this.renderSuggestionHeader(e),this.renderSuggestList(e)]):[]}renderSuggestionsMenu(){const{displayedSearchTerm:t,locationEnabled:e,suggestionsMenuId:i,inputId:n}=this,{suggestionCount:r}=this.viewModel,s=e&&!t||r;return this._menuItemCount=0,s?O("div",{id:i,key:"esri-search__suggestions-menu",class:this.classes(Oe.menu,Oe.suggestionsMenu),role:"listbox","aria-labelledby":n,bind:this,afterCreate:uf,"data-node-ref":"_suggestionListNode"},this.renderLocationGroup(),this.renderSuggestionsGroup()):null}renderInputContainer(){return O("div",{key:"esri-search__input-container",class:Oe.inputContainer},this.renderForm(),this.renderSuggestionsMenu(),this.renderClearButton())}renderSuggestionHeader(t){var o;const{allSources:e,activeSourceIndex:i}=this.viewModel,{sourceIndex:n}=t,r=(o=t.results)==null?void 0:o.length,s=e.length>1&&i===x_.ALL_INDEX;return r&&s?O("div",{key:`esri-search__suggestion-header-${n}`,class:Oe.menuHeader},this._getSourceName(n)):null}renderSuggestion(t,e){const{_activeMenuItemIndex:i,viewModel:{searchTerm:n}}=this;if(!n)return;const r=this.activeMenu==="suggestion"&&i===e;return O("li",{bind:this,id:this._buildId("suggestion-item",e),"aria-selected":(this.activeMenu==="suggestion"&&this._activeMenuItemIndex===e).toString(),onclick:this._handleSuggestionClick,key:`esri-search__suggestion_${e}`,"data-suggestion":t,role:"option",innerHTML:this._getSuggestResultHTML(t.text,n),class:this.classes(Oe.menuItem,r?Oe.menuItemFocus:null)})}renderSource(t){const{activeSourceIndex:e,searchAllEnabled:i}=this.viewModel,n={[Oe.menuItemActive]:t===e,[Oe.menuItemFocus]:this.activeMenu==="source"&&t===(i?this._activeMenuItemIndex-1:this._activeMenuItemIndex)},r=i?t+1:t;return O("li",{bind:this,key:`esri-search__source-${t}`,id:this._buildId("source-item",r),"aria-checked":(t===e).toString(),onclick:this._handleSourceClick,"data-source-index":t,role:"menuitemradio",class:this.classes(Oe.source,Oe.menuItem,n)},this._getSourceName(t))}renderNoResultsWarning(t){const{messages:e}=this,i=t?Ru(e.noResultsFoundForValue,{value:`"${t}"`}):e.noResultsFound;return O("div",{key:"esri-search__no_results"},O("div",{class:Oe.warningMenuHeader},e.noResults),O("div",{class:Oe.warningMenuText},i))}renderEmptySearchWarning(){const{messages:t}=this;return O("div",{key:"esri-search__empty-search"},O("span",{"aria-hidden":"true",class:Oe.noticeIcon}),O("span",{class:Oe.noValueText},t.emptyValue))}renderLocateWarning(){const{messages:t}=this;return O("div",{key:"esri-search__locate-error"},O("span",{"aria-hidden":"true",class:Oe.noticeIcon}),O("span",{class:Oe.noValueText},t.locateError))}renderWarning(){var n;const{displayedSearchTerm:t,_locateFailed:e}=this,{viewModel:i}=this;return e?this.renderLocateWarning():(n=i.selectedSuggestion)!=null&&n.location||t?this.renderNoResultsWarning(t):this.renderEmptySearchWarning()}_resetActiveMenuItemIndex(){this._activeMenuItemIndex=-1}_buildId(t,e){return`${this.id}-${t}${e===void 0?"":`-${e}`}`}_watchSourceChanges(){const{viewModel:{allSources:t}}=this,e="sources";this.removeHandles(e),t.forEach(i=>this.addHandles(Q(()=>i.name,()=>this.scheduleRender()),e))}_handleSourcesMenuToggleFocus(){this.activeMenu!=="source"&&this._clearActiveMenu()}_handleSourcesMenuToggleClick(){var e;const t=this.activeMenu==="source";this.activeMenu=t?"none":"source",this.renderNow(),this.activeMenu==="source"&&((e=this._sourceListNode)==null||e.focus())}_handleClearButtonClick(){this.viewModel.clear(),this._focus()}_handleSearchButtonClick(){this.search()}_handleSuggestionClick(t){const e=aY(t.currentTarget);e&&(this._focus(),this.search(e))}_handleUseCurrentLocationClick(){this._useCurrentLocation()}_useCurrentLocation(){this._focus("none"),this._cancelSuggest(),this._cancelSearch();const t=new AbortController,{signal:e}=t;this._searchController=t,(async()=>{try{const i=await this.viewModel.searchNearby({signal:e});this.activeMenu=i!=null&&i.numResults?"none":"warning"}catch{this._locateFailed=!0,this.activeMenu="warning"}finally{this._searchController=null}})()}_handleSourceClick(t){this._setSourceFromMenuItem(t.currentTarget)}_setSourceFromMenuItem(t){var i;if(!t)return;const e=DQe(t);e!=null&&(this.viewModel.activeSourceIndex=e,this._clearActiveMenu(),(i=this._sourceMenuButtonNode)==null||i.focus())}_cancelSuggest(){this._suggestController=is(this._suggestController)}_cancelSearch(){this._searchController=is(this._searchController),this._locateFailed=!1}_handleInputKeyup(t){var r;const e=Uh(t);if(t.ctrlKey||t.metaKey||e==="Copy"||e==="ArrowLeft"||e==="ArrowRight"||e==="Shift")return;if(e==="Tab"||e==="Escape"||t.shiftKey&&e==="Tab")return this._cancelSuggest(),void(e==="Escape"&&this._clearActiveMenu());const i=e==="Home"||e==="End"||e==="ArrowUp"||e==="ArrowDown";if(e==="Enter"&&this._activeMenuItemIndex<0)return void this._cancelSuggest();const n=(r=this._suggestionListNode)==null?void 0:r.getElementsByTagName("li");if(n!=null&&n.length){if(this.activeMenu!=="suggestion"&&this._openSuggestionMenu(),i)return t.preventDefault(),this._cancelSuggest(),void this._handleItemNavigation(e,n,this._suggestionListNode);const s=n[this._activeMenuItemIndex];if(e==="Enter"&&s){const o=aY(s);return void(o?(this._focus(),this.search(o)):NQe(s)&&this._useCurrentLocation())}}this.viewModel.searchTerm&&this.suggest()}_handleItemNavigation(t,e,i){const n=this._activeMenuItemIndex;t==="Home"&&(this._activeMenuItemIndex=0),t==="End"&&(this._activeMenuItemIndex=e.length-1),t==="ArrowUp"&&(this._activeMenuItemIndex=this._activeMenuItemIndex<=0?e.length-1:this._activeMenuItemIndex-1),t==="ArrowDown"&&(this._activeMenuItemIndex=this._activeMenuItemIndex===e.length-1?0:this._activeMenuItemIndex+1),n!==this._activeMenuItemIndex&&i&&kMe(e[this._activeMenuItemIndex],i)}_scrollToTopSuggestion(){this._suggestionListNode&&(this._suggestionListNode.scrollTop=0)}_openSuggestionMenu(){this.activeMenu="suggestion"}_handleInputPaste(t){const e=t.target;this.viewModel.searchTerm!==e.value&&(this.viewModel.searchTerm=e.value),this.viewModel.searchTerm&&this.suggest()}_handleSourceMenuKeydown(t){var i;const e=Uh(t);if(ly(e)){t.preventDefault();const n=(i=this._sourceListNode)==null?void 0:i.getElementsByTagName("li"),r=n==null?void 0:n[this._activeMenuItemIndex];this._setSourceFromMenuItem(r)}else e!=="ArrowUp"&&e!=="ArrowDown"&&e!=="End"&&e!=="Home"||t.preventDefault()}_handleSourceMenuKeyup(t){var r,s,o;const e=Uh(t),i=e==="ArrowUp"||e==="ArrowDown"||e==="End"||e==="Home";if(i&&t.preventDefault(),e==="Escape")return this._clearActiveMenu(),void((r=this._sourceMenuButtonNode)==null?void 0:r.focus());const n=(s=this._sourceListNode)==null?void 0:s.getElementsByTagName("li");return n&&n.length!==0&&i?(this.activeMenu!=="source"&&(this.activeMenu="source"),void this._handleItemNavigation(e,n,(o=this._sourceListNode)==null?void 0:o.parentElement)):void 0}_focus(t){this.focus(),t&&(this.activeMenu=t)}_formSubmit(t){t.preventDefault(),this._activeMenuItemIndex===-1&&this.search()}_getSourceName(t){const{messages:e}=this,i=this.viewModel,{allSources:n}=i,r=n.at(t);return t===x_.ALL_INDEX?e.all:r&&r.name||e.untitledSource}_getSuggestResultHTML(t,e){return t?LQe.test(t)?t:RQe(t,e):this.messages.untitledResult}_renderSearchResultsContent(){return this._searchResultRenderer.showMoreResultsOpen=!1,this._searchResultRenderer.viewModel=this.viewModel,this._searchResultRenderer}};function aY(t){return t==null?void 0:t["data-suggestion"]}function DQe(t){return t==null?void 0:t["data-source-index"]}function NQe(t){return!!(t!=null&&t["data-current-location-item"])}h([p()],st.prototype,"_activeMenuItemIndex",void 0),h([p()],st.prototype,"displayedSearchTerm",null),h([p({readOnly:!0})],st.prototype,"inputId",null),h([p({readOnly:!0})],st.prototype,"suggestionsMenuId",null),h([p({readOnly:!0})],st.prototype,"sourceMenuId",null),h([p({readOnly:!0})],st.prototype,"sourceMenuButtonId",null),h([p()],st.prototype,"activeMenu",void 0),h([p({readOnly:!0})],st.prototype,"activeSource",null),h([p()],st.prototype,"activeSourceIndex",null),h([p()],st.prototype,"allPlaceholder",null),h([p({readOnly:!0})],st.prototype,"allSources",null),h([p()],st.prototype,"autoNavigate",null),h([p()],st.prototype,"autoSelect",null),h([p({readOnly:!0})],st.prototype,"defaultSources",null),h([p()],st.prototype,"disabled",void 0),h([p()],st.prototype,"goToOverride",null),h([p()],st.prototype,"iconClass",void 0),h([p()],st.prototype,"icon",void 0),h([p()],st.prototype,"includeDefaultSources",null),h([p()],st.prototype,"label",null),h([p()],st.prototype,"locationEnabled",null),h([p()],st.prototype,"maxResults",null),h([p()],st.prototype,"maxSuggestions",null),h([p(),Zt("esri/widgets/Search/t9n/Search")],st.prototype,"messages",void 0),h([p(),Zt("esri/t9n/common")],st.prototype,"messagesCommon",void 0),h([p()],st.prototype,"minSuggestCharacters",null),h([p()],st.prototype,"popupEnabled",null),h([p()],st.prototype,"popupTemplate",null),h([p()],st.prototype,"portal",null),h([p()],st.prototype,"resultGraphic",null),h([p()],st.prototype,"resultGraphicEnabled",null),h([p({readOnly:!0})],st.prototype,"results",null),h([p()],st.prototype,"searchAllEnabled",null),h([p()],st.prototype,"searchTerm",null),h([p({readOnly:!0})],st.prototype,"selectedResult",null),h([p()],st.prototype,"sources",null),h([p({readOnly:!0})],st.prototype,"suggestions",null),h([p()],st.prototype,"suggestionsEnabled",null),h([p()],st.prototype,"view",null),h([fhe(["search-complete","search-clear","search-start","select-result","suggest-start","suggest-complete"]),p({type:x_})],st.prototype,"viewModel",void 0),st=h([P("esri.widgets.Search")],st);const FQe=st,zQe="AAPK9e1ac7b4aa5c4f74acc1c5ee1e499125uMYbXoXGe4Jpi8uJ7I3sIsO0e0pVTqJlswJsWuR95YAesw9DoxIN2Ry3IgyO5vTB";Tt.apiKey=zQe;const Ok=Object.freeze(Object.defineProperty({__proto__:null,BasemapToggle:NVe,ElevationProfile:kKe,Expand:tGe,FeatureTable:Y7e,GeoJSONLayer:Kae,ImageryTileLayer:Sce,LabelClass:lT,LayerList:uWe,Legend:fde,Map:Qee,MapView:gOe,Search:FQe,TableTemplate:K7e,reactiveUtils:cne},Symbol.toStringTag,{value:"Module"}));/*!
 * @kurkle/color v0.3.2
 * https://github.com/kurkle/color#readme
 * (c) 2023 Jukka Kurkela
 * Released under the MIT License
 */function ET(t){return t+.5|0}const _f=(t,e,i)=>Math.max(Math.min(t,i),e);function wx(t){return _f(ET(t*2.55),0,255)}function kf(t){return _f(ET(t*255),0,255)}function $h(t){return _f(ET(t/2.55)/100,0,1)}function lY(t){return _f(ET(t*100),0,100)}const ka={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},dz=[..."0123456789ABCDEF"],VQe=t=>dz[t&15],jQe=t=>dz[(t&240)>>4]+dz[t&15],CC=t=>(t&240)>>4===(t&15),BQe=t=>CC(t.r)&&CC(t.g)&&CC(t.b)&&CC(t.a);function UQe(t){var e=t.length,i;return t[0]==="#"&&(e===4||e===5?i={r:255&ka[t[1]]*17,g:255&ka[t[2]]*17,b:255&ka[t[3]]*17,a:e===5?ka[t[4]]*17:255}:(e===7||e===9)&&(i={r:ka[t[1]]<<4|ka[t[2]],g:ka[t[3]]<<4|ka[t[4]],b:ka[t[5]]<<4|ka[t[6]],a:e===9?ka[t[7]]<<4|ka[t[8]]:255})),i}const GQe=(t,e)=>t<255?e(t):"";function HQe(t){var e=BQe(t)?VQe:jQe;return t?"#"+e(t.r)+e(t.g)+e(t.b)+GQe(t.a,e):void 0}const qQe=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function nme(t,e,i){const n=e*Math.min(i,1-i),r=(s,o=(s+t/30)%12)=>i-n*Math.max(Math.min(o-3,9-o,1),-1);return[r(0),r(8),r(4)]}function WQe(t,e,i){const n=(r,s=(r+t/60)%6)=>i-i*e*Math.max(Math.min(s,4-s,1),0);return[n(5),n(3),n(1)]}function JQe(t,e,i){const n=nme(t,1,.5);let r;for(e+i>1&&(r=1/(e+i),e*=r,i*=r),r=0;r<3;r++)n[r]*=1-e-i,n[r]+=e;return n}function ZQe(t,e,i,n,r){return t===r?(e-i)/n+(e<i?6:0):e===r?(i-t)/n+2:(t-e)/n+4}function _B(t){const i=t.r/255,n=t.g/255,r=t.b/255,s=Math.max(i,n,r),o=Math.min(i,n,r),a=(s+o)/2;let l,c,u;return s!==o&&(u=s-o,c=a>.5?u/(2-s-o):u/(s+o),l=ZQe(i,n,r,u,s),l=l*60+.5),[l|0,c||0,a]}function bB(t,e,i,n){return(Array.isArray(e)?t(e[0],e[1],e[2]):t(e,i,n)).map(kf)}function wB(t,e,i){return bB(nme,t,e,i)}function YQe(t,e,i){return bB(JQe,t,e,i)}function XQe(t,e,i){return bB(WQe,t,e,i)}function rme(t){return(t%360+360)%360}function KQe(t){const e=qQe.exec(t);let i=255,n;if(!e)return;e[5]!==n&&(i=e[6]?wx(+e[5]):kf(+e[5]));const r=rme(+e[2]),s=+e[3]/100,o=+e[4]/100;return e[1]==="hwb"?n=YQe(r,s,o):e[1]==="hsv"?n=XQe(r,s,o):n=wB(r,s,o),{r:n[0],g:n[1],b:n[2],a:i}}function QQe(t,e){var i=_B(t);i[0]=rme(i[0]+e),i=wB(i),t.r=i[0],t.g=i[1],t.b=i[2]}function eet(t){if(!t)return;const e=_B(t),i=e[0],n=lY(e[1]),r=lY(e[2]);return t.a<255?`hsla(${i}, ${n}%, ${r}%, ${$h(t.a)})`:`hsl(${i}, ${n}%, ${r}%)`}const cY={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},uY={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function tet(){const t={},e=Object.keys(uY),i=Object.keys(cY);let n,r,s,o,a;for(n=0;n<e.length;n++){for(o=a=e[n],r=0;r<i.length;r++)s=i[r],a=a.replace(s,cY[s]);s=parseInt(uY[o],16),t[a]=[s>>16&255,s>>8&255,s&255]}return t}let MC;function iet(t){MC||(MC=tet(),MC.transparent=[0,0,0,0]);const e=MC[t.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const net=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function ret(t){const e=net.exec(t);let i=255,n,r,s;if(e){if(e[7]!==n){const o=+e[7];i=e[8]?wx(o):_f(o*255,0,255)}return n=+e[1],r=+e[3],s=+e[5],n=255&(e[2]?wx(n):_f(n,0,255)),r=255&(e[4]?wx(r):_f(r,0,255)),s=255&(e[6]?wx(s):_f(s,0,255)),{r:n,g:r,b:s,a:i}}}function set(t){return t&&(t.a<255?`rgba(${t.r}, ${t.g}, ${t.b}, ${$h(t.a)})`:`rgb(${t.r}, ${t.g}, ${t.b})`)}const OL=t=>t<=.0031308?t*12.92:Math.pow(t,1/2.4)*1.055-.055,nv=t=>t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4);function oet(t,e,i){const n=nv($h(t.r)),r=nv($h(t.g)),s=nv($h(t.b));return{r:kf(OL(n+i*(nv($h(e.r))-n))),g:kf(OL(r+i*(nv($h(e.g))-r))),b:kf(OL(s+i*(nv($h(e.b))-s))),a:t.a+i*(e.a-t.a)}}function EC(t,e,i){if(t){let n=_B(t);n[e]=Math.max(0,Math.min(n[e]+n[e]*i,e===0?360:1)),n=wB(n),t.r=n[0],t.g=n[1],t.b=n[2]}}function sme(t,e){return t&&Object.assign(e||{},t)}function hY(t){var e={r:0,g:0,b:0,a:255};return Array.isArray(t)?t.length>=3&&(e={r:t[0],g:t[1],b:t[2],a:255},t.length>3&&(e.a=kf(t[3]))):(e=sme(t,{r:0,g:0,b:0,a:1}),e.a=kf(e.a)),e}function aet(t){return t.charAt(0)==="r"?ret(t):KQe(t)}class _S{constructor(e){if(e instanceof _S)return e;const i=typeof e;let n;i==="object"?n=hY(e):i==="string"&&(n=UQe(e)||iet(e)||aet(e)),this._rgb=n,this._valid=!!n}get valid(){return this._valid}get rgb(){var e=sme(this._rgb);return e&&(e.a=$h(e.a)),e}set rgb(e){this._rgb=hY(e)}rgbString(){return this._valid?set(this._rgb):void 0}hexString(){return this._valid?HQe(this._rgb):void 0}hslString(){return this._valid?eet(this._rgb):void 0}mix(e,i){if(e){const n=this.rgb,r=e.rgb;let s;const o=i===s?.5:i,a=2*o-1,l=n.a-r.a,c=((a*l===-1?a:(a+l)/(1+a*l))+1)/2;s=1-c,n.r=255&c*n.r+s*r.r+.5,n.g=255&c*n.g+s*r.g+.5,n.b=255&c*n.b+s*r.b+.5,n.a=o*n.a+(1-o)*r.a,this.rgb=n}return this}interpolate(e,i){return e&&(this._rgb=oet(this._rgb,e._rgb,i)),this}clone(){return new _S(this.rgb)}alpha(e){return this._rgb.a=kf(e),this}clearer(e){const i=this._rgb;return i.a*=1-e,this}greyscale(){const e=this._rgb,i=ET(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=i,this}opaquer(e){const i=this._rgb;return i.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return EC(this._rgb,2,e),this}darken(e){return EC(this._rgb,2,-e),this}saturate(e){return EC(this._rgb,1,e),this}desaturate(e){return EC(this._rgb,1,-e),this}rotate(e){return QQe(this._rgb,e),this}}/*!
 * Chart.js v4.3.0
 * https://www.chartjs.org
 * (c) 2023 Chart.js Contributors
 * Released under the MIT License
 */function Qu(){}const cet=(()=>{let t=0;return()=>t++})();function zt(t){return t===null||typeof t>"u"}function Ui(t){if(Array.isArray&&Array.isArray(t))return!0;const e=Object.prototype.toString.call(t);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function Et(t){return t!==null&&Object.prototype.toString.call(t)==="[object Object]"}function In(t){return(typeof t=="number"||t instanceof Number)&&isFinite(+t)}function ca(t,e){return In(t)?t:e}function it(t,e){return typeof t>"u"?e:t}const uet=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100:+t/e,ome=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100*e:+t;function nt(t,e,i){if(t&&typeof t.call=="function")return t.apply(i,e)}function St(t,e,i,n){let r,s,o;if(Ui(t))if(s=t.length,n)for(r=s-1;r>=0;r--)e.call(i,t[r],r);else for(r=0;r<s;r++)e.call(i,t[r],r);else if(Et(t))for(o=Object.keys(t),s=o.length,r=0;r<s;r++)e.call(i,t[o[r]],o[r])}function R$(t,e){let i,n,r,s;if(!t||!e||t.length!==e.length)return!1;for(i=0,n=t.length;i<n;++i)if(r=t[i],s=e[i],r.datasetIndex!==s.datasetIndex||r.index!==s.index)return!1;return!0}function D$(t){if(Ui(t))return t.map(D$);if(Et(t)){const e=Object.create(null),i=Object.keys(t),n=i.length;let r=0;for(;r<n;++r)e[i[r]]=D$(t[i[r]]);return e}return t}function ame(t){return["__proto__","prototype","constructor"].indexOf(t)===-1}function het(t,e,i,n){if(!ame(t))return;const r=e[t],s=i[t];Et(r)&&Et(s)?bS(r,s,n):e[t]=D$(s)}function bS(t,e,i){const n=Ui(e)?e:[e],r=n.length;if(!Et(t))return t;i=i||{};const s=i.merger||het;let o;for(let a=0;a<r;++a){if(o=n[a],!Et(o))continue;const l=Object.keys(o);for(let c=0,u=l.length;c<u;++c)s(l[c],t,o,i)}return t}function g2(t,e){return bS(t,e,{merger:det})}function det(t,e,i){if(!ame(t))return;const n=e[t],r=i[t];Et(n)&&Et(r)?g2(n,r):Object.prototype.hasOwnProperty.call(e,t)||(e[t]=D$(r))}const dY={"":t=>t,x:t=>t.x,y:t=>t.y};function pet(t){const e=t.split("."),i=[];let n="";for(const r of e)n+=r,n.endsWith("\\")?n=n.slice(0,-1)+".":(i.push(n),n="");return i}function fet(t){const e=pet(t);return i=>{for(const n of e){if(n==="")break;i=i&&i[n]}return i}}function Gf(t,e){return(dY[e]||(dY[e]=fet(e)))(t)}function xB(t){return t.charAt(0).toUpperCase()+t.slice(1)}const wS=t=>typeof t<"u",Hf=t=>typeof t=="function",pY=(t,e)=>{if(t.size!==e.size)return!1;for(const i of t)if(!e.has(i))return!1;return!0};function met(t){return t.type==="mouseup"||t.type==="click"||t.type==="contextmenu"}const ln=Math.PI,Hi=2*ln,get=Hi+ln,N$=Number.POSITIVE_INFINITY,yet=ln/180,Cn=ln/2,Mm=ln/4,fY=ln*2/3,bf=Math.log10,hl=Math.sign;function y2(t,e,i){return Math.abs(t-e)<i}function mY(t){const e=Math.round(t);t=y2(t,e,t/1e3)?e:t;const i=Math.pow(10,Math.floor(bf(t))),n=t/i;return(n<=1?1:n<=2?2:n<=5?5:10)*i}function vet(t){const e=[],i=Math.sqrt(t);let n;for(n=1;n<i;n++)t%n===0&&(e.push(n),e.push(t/n));return i===(i|0)&&e.push(i),e.sort((r,s)=>r-s).pop(),e}function Eb(t){return!isNaN(parseFloat(t))&&isFinite(t)}function _et(t,e){const i=Math.round(t);return i-e<=t&&i+e>=t}function lme(t,e,i){let n,r,s;for(n=0,r=t.length;n<r;n++)s=t[n][i],isNaN(s)||(e.min=Math.min(e.min,s),e.max=Math.max(e.max,s))}function mc(t){return t*(ln/180)}function SB(t){return t*(180/ln)}function gY(t){if(!In(t))return;let e=1,i=0;for(;Math.round(t*e)/e!==t;)e*=10,i++;return i}function cme(t,e){const i=e.x-t.x,n=e.y-t.y,r=Math.sqrt(i*i+n*n);let s=Math.atan2(n,i);return s<-.5*ln&&(s+=Hi),{angle:s,distance:r}}function pz(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function bet(t,e){return(t-e+get)%Hi-ln}function da(t){return(t%Hi+Hi)%Hi}function xS(t,e,i,n){const r=da(t),s=da(e),o=da(i),a=da(s-r),l=da(o-r),c=da(r-s),u=da(r-o);return r===s||r===o||n&&s===o||a>l&&c<u}function zr(t,e,i){return Math.max(e,Math.min(i,t))}function wet(t){return zr(t,-32768,32767)}function Vh(t,e,i,n=1e-6){return t>=Math.min(e,i)-n&&t<=Math.max(e,i)+n}function TB(t,e,i){i=i||(o=>t[o]<e);let n=t.length-1,r=0,s;for(;n-r>1;)s=r+n>>1,i(s)?r=s:n=s;return{lo:r,hi:n}}const jh=(t,e,i,n)=>TB(t,i,n?r=>{const s=t[r][e];return s<i||s===i&&t[r+1][e]===i}:r=>t[r][e]<i),xet=(t,e,i)=>TB(t,i,n=>t[n][e]>=i);function Tet(t,e,i){let n=0,r=t.length;for(;n<r&&t[n]<e;)n++;for(;r>n&&t[r-1]>i;)r--;return n>0||r<t.length?t.slice(n,r):t}const ume=["push","pop","shift","splice","unshift"];function Iet(t,e){if(t._chartjs){t._chartjs.listeners.push(e);return}Object.defineProperty(t,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),ume.forEach(i=>{const n="_onData"+xB(i),r=t[i];Object.defineProperty(t,i,{configurable:!0,enumerable:!1,value(...s){const o=r.apply(this,s);return t._chartjs.listeners.forEach(a=>{typeof a[n]=="function"&&a[n](...s)}),o}})})}function yY(t,e){const i=t._chartjs;if(!i)return;const n=i.listeners,r=n.indexOf(e);r!==-1&&n.splice(r,1),!(n.length>0)&&(ume.forEach(s=>{delete t[s]}),delete t._chartjs)}function hme(t){const e=new Set(t);return e.size===t.length?t:Array.from(e)}const dme=function(){return typeof window>"u"?function(t){return t()}:window.requestAnimationFrame}();function pme(t,e){let i=[],n=!1;return function(...r){i=r,n||(n=!0,dme.call(window,()=>{n=!1,t.apply(e,i)}))}}function Cet(t,e){let i;return function(...n){return e?(clearTimeout(i),i=setTimeout(t,e,n)):t.apply(this,n),e}}const IB=t=>t==="start"?"left":t==="end"?"right":"center",Ss=(t,e,i)=>t==="start"?e:t==="end"?i:(e+i)/2,Met=(t,e,i,n)=>t===(n?"left":"right")?i:t==="center"?(e+i)/2:e;function fme(t,e,i){const n=e.length;let r=0,s=n;if(t._sorted){const{iScale:o,_parsed:a}=t,l=o.axis,{min:c,max:u,minDefined:d,maxDefined:f}=o.getUserBounds();d&&(r=zr(Math.min(jh(a,o.axis,c).lo,i?n:jh(e,l,o.getPixelForValue(c)).lo),0,n-1)),f?s=zr(Math.max(jh(a,o.axis,u,!0).hi+1,i?0:jh(e,l,o.getPixelForValue(u),!0).hi+1),r,n)-r:s=n-r}return{start:r,count:s}}function mme(t){const{xScale:e,yScale:i,_scaleRanges:n}=t,r={xmin:e.min,xmax:e.max,ymin:i.min,ymax:i.max};if(!n)return t._scaleRanges=r,!0;const s=n.xmin!==e.min||n.xmax!==e.max||n.ymin!==i.min||n.ymax!==i.max;return Object.assign(n,r),s}const AC=t=>t===0||t===1,vY=(t,e,i)=>-(Math.pow(2,10*(t-=1))*Math.sin((t-e)*Hi/i)),_Y=(t,e,i)=>Math.pow(2,-10*t)*Math.sin((t-e)*Hi/i)+1,v2={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>-t*(t-2),easeInOutQuad:t=>(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1),easeInCubic:t=>t*t*t,easeOutCubic:t=>(t-=1)*t*t+1,easeInOutCubic:t=>(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2),easeInQuart:t=>t*t*t*t,easeOutQuart:t=>-((t-=1)*t*t*t-1),easeInOutQuart:t=>(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2),easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>(t-=1)*t*t*t*t+1,easeInOutQuint:t=>(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2),easeInSine:t=>-Math.cos(t*Cn)+1,easeOutSine:t=>Math.sin(t*Cn),easeInOutSine:t=>-.5*(Math.cos(ln*t)-1),easeInExpo:t=>t===0?0:Math.pow(2,10*(t-1)),easeOutExpo:t=>t===1?1:-Math.pow(2,-10*t)+1,easeInOutExpo:t=>AC(t)?t:t<.5?.5*Math.pow(2,10*(t*2-1)):.5*(-Math.pow(2,-10*(t*2-1))+2),easeInCirc:t=>t>=1?t:-(Math.sqrt(1-t*t)-1),easeOutCirc:t=>Math.sqrt(1-(t-=1)*t),easeInOutCirc:t=>(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1),easeInElastic:t=>AC(t)?t:vY(t,.075,.3),easeOutElastic:t=>AC(t)?t:_Y(t,.075,.3),easeInOutElastic(t){return AC(t)?t:t<.5?.5*vY(t*2,.1125,.45):.5+.5*_Y(t*2-1,.1125,.45)},easeInBack(t){return t*t*((1.70158+1)*t-1.70158)},easeOutBack(t){return(t-=1)*t*((1.70158+1)*t+1.70158)+1},easeInOutBack(t){let e=1.70158;return(t/=.5)<1?.5*(t*t*(((e*=1.525)+1)*t-e)):.5*((t-=2)*t*(((e*=1.525)+1)*t+e)+2)},easeInBounce:t=>1-v2.easeOutBounce(1-t),easeOutBounce(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},easeInOutBounce:t=>t<.5?v2.easeInBounce(t*2)*.5:v2.easeOutBounce(t*2-1)*.5+.5};function CB(t){if(t&&typeof t=="object"){const e=t.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function bY(t){return CB(t)?t:new _S(t)}function LL(t){return CB(t)?t:new _S(t).saturate(.5).darken(.1).hexString()}const Eet=["x","y","borderWidth","radius","tension"],Aet=["color","borderColor","backgroundColor"];function $et(t){t.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),t.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),t.set("animations",{colors:{type:"color",properties:Aet},numbers:{type:"number",properties:Eet}}),t.describe("animations",{_fallback:"animation"}),t.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function Pet(t){t.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const wY=new Map;function ket(t,e){e=e||{};const i=t+JSON.stringify(e);let n=wY.get(i);return n||(n=new Intl.NumberFormat(t,e),wY.set(i,n)),n}function AT(t,e,i){return ket(e,i).format(t)}const gme={values(t){return Ui(t)?t:""+t},numeric(t,e,i){if(t===0)return"0";const n=this.chart.options.locale;let r,s=t;if(i.length>1){const c=Math.max(Math.abs(i[0].value),Math.abs(i[i.length-1].value));(c<1e-4||c>1e15)&&(r="scientific"),s=Oet(t,i)}const o=bf(Math.abs(s)),a=isNaN(o)?1:Math.max(Math.min(-1*Math.floor(o),20),0),l={notation:r,minimumFractionDigits:a,maximumFractionDigits:a};return Object.assign(l,this.options.ticks.format),AT(t,n,l)},logarithmic(t,e,i){if(t===0)return"0";const n=i[e].significand||t/Math.pow(10,Math.floor(bf(t)));return[1,2,3,5,10,15].includes(n)||e>.8*i.length?gme.numeric.call(this,t,e,i):""}};function Oet(t,e){let i=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(i)>=1&&t!==Math.floor(t)&&(i=t-Math.floor(t)),i}var Lk={formatters:gme};function Let(t){t.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,i)=>i.lineWidth,tickColor:(e,i)=>i.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:Lk.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),t.route("scale.ticks","color","","color"),t.route("scale.grid","color","","borderColor"),t.route("scale.border","color","","borderColor"),t.route("scale.title","color","","color"),t.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),t.describe("scales",{_fallback:"scale"}),t.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const Ky=Object.create(null),fz=Object.create(null);function _2(t,e){if(!e)return t;const i=e.split(".");for(let n=0,r=i.length;n<r;++n){const s=i[n];t=t[s]||(t[s]=Object.create(null))}return t}function RL(t,e,i){return typeof e=="string"?bS(_2(t,e),i):bS(_2(t,""),e)}class Ret{constructor(e,i){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=n=>n.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(n,r)=>LL(r.backgroundColor),this.hoverBorderColor=(n,r)=>LL(r.borderColor),this.hoverColor=(n,r)=>LL(r.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(i)}set(e,i){return RL(this,e,i)}get(e){return _2(this,e)}describe(e,i){return RL(fz,e,i)}override(e,i){return RL(Ky,e,i)}route(e,i,n,r){const s=_2(this,e),o=_2(this,n),a="_"+i;Object.defineProperties(s,{[a]:{value:s[i],writable:!0},[i]:{enumerable:!0,get(){const l=this[a],c=o[r];return Et(l)?Object.assign({},c,l):it(l,c)},set(l){this[a]=l}}})}apply(e){e.forEach(i=>i(this))}}var Mn=new Ret({_scriptable:t=>!t.startsWith("on"),_indexable:t=>t!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[$et,Pet,Let]);function Det(t){return!t||zt(t.size)||zt(t.family)?null:(t.style?t.style+" ":"")+(t.weight?t.weight+" ":"")+t.size+"px "+t.family}function F$(t,e,i,n,r){let s=e[r];return s||(s=e[r]=t.measureText(r).width,i.push(r)),s>n&&(n=s),n}function Net(t,e,i,n){n=n||{};let r=n.data=n.data||{},s=n.garbageCollect=n.garbageCollect||[];n.font!==e&&(r=n.data={},s=n.garbageCollect=[],n.font=e),t.save(),t.font=e;let o=0;const a=i.length;let l,c,u,d,f;for(l=0;l<a;l++)if(d=i[l],d!=null&&!Ui(d))o=F$(t,r,s,o,d);else if(Ui(d))for(c=0,u=d.length;c<u;c++)f=d[c],f!=null&&!Ui(f)&&(o=F$(t,r,s,o,f));t.restore();const m=s.length/2;if(m>i.length){for(l=0;l<m;l++)delete r[s[l]];s.splice(0,m)}return o}function Em(t,e,i){const n=t.currentDevicePixelRatio,r=i!==0?Math.max(i/2,.5):0;return Math.round((e-r)*n)/n+r}function xY(t,e){e=e||t.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,t.width,t.height),e.restore()}function mz(t,e,i,n){yme(t,e,i,n,null)}function yme(t,e,i,n,r){let s,o,a,l,c,u,d,f;const m=e.pointStyle,g=e.rotation,y=e.radius;let _=(g||0)*yet;if(m&&typeof m=="object"&&(s=m.toString(),s==="[object HTMLImageElement]"||s==="[object HTMLCanvasElement]")){t.save(),t.translate(i,n),t.rotate(_),t.drawImage(m,-m.width/2,-m.height/2,m.width,m.height),t.restore();return}if(!(isNaN(y)||y<=0)){switch(t.beginPath(),m){default:r?t.ellipse(i,n,r/2,y,0,0,Hi):t.arc(i,n,y,0,Hi),t.closePath();break;case"triangle":u=r?r/2:y,t.moveTo(i+Math.sin(_)*u,n-Math.cos(_)*y),_+=fY,t.lineTo(i+Math.sin(_)*u,n-Math.cos(_)*y),_+=fY,t.lineTo(i+Math.sin(_)*u,n-Math.cos(_)*y),t.closePath();break;case"rectRounded":c=y*.516,l=y-c,o=Math.cos(_+Mm)*l,d=Math.cos(_+Mm)*(r?r/2-c:l),a=Math.sin(_+Mm)*l,f=Math.sin(_+Mm)*(r?r/2-c:l),t.arc(i-d,n-a,c,_-ln,_-Cn),t.arc(i+f,n-o,c,_-Cn,_),t.arc(i+d,n+a,c,_,_+Cn),t.arc(i-f,n+o,c,_+Cn,_+ln),t.closePath();break;case"rect":if(!g){l=Math.SQRT1_2*y,u=r?r/2:l,t.rect(i-u,n-l,2*u,2*l);break}_+=Mm;case"rectRot":d=Math.cos(_)*(r?r/2:y),o=Math.cos(_)*y,a=Math.sin(_)*y,f=Math.sin(_)*(r?r/2:y),t.moveTo(i-d,n-a),t.lineTo(i+f,n-o),t.lineTo(i+d,n+a),t.lineTo(i-f,n+o),t.closePath();break;case"crossRot":_+=Mm;case"cross":d=Math.cos(_)*(r?r/2:y),o=Math.cos(_)*y,a=Math.sin(_)*y,f=Math.sin(_)*(r?r/2:y),t.moveTo(i-d,n-a),t.lineTo(i+d,n+a),t.moveTo(i+f,n-o),t.lineTo(i-f,n+o);break;case"star":d=Math.cos(_)*(r?r/2:y),o=Math.cos(_)*y,a=Math.sin(_)*y,f=Math.sin(_)*(r?r/2:y),t.moveTo(i-d,n-a),t.lineTo(i+d,n+a),t.moveTo(i+f,n-o),t.lineTo(i-f,n+o),_+=Mm,d=Math.cos(_)*(r?r/2:y),o=Math.cos(_)*y,a=Math.sin(_)*y,f=Math.sin(_)*(r?r/2:y),t.moveTo(i-d,n-a),t.lineTo(i+d,n+a),t.moveTo(i+f,n-o),t.lineTo(i-f,n+o);break;case"line":o=r?r/2:Math.cos(_)*y,a=Math.sin(_)*y,t.moveTo(i-o,n-a),t.lineTo(i+o,n+a);break;case"dash":t.moveTo(i,n),t.lineTo(i+Math.cos(_)*(r?r/2:y),n+Math.sin(_)*y);break;case!1:t.closePath();break}t.fill(),e.borderWidth>0&&t.stroke()}}function Bh(t,e,i){return i=i||.5,!e||t&&t.x>e.left-i&&t.x<e.right+i&&t.y>e.top-i&&t.y<e.bottom+i}function Rk(t,e){t.save(),t.beginPath(),t.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),t.clip()}function Dk(t){t.restore()}function Fet(t,e,i,n,r){if(!e)return t.lineTo(i.x,i.y);if(r==="middle"){const s=(e.x+i.x)/2;t.lineTo(s,e.y),t.lineTo(s,i.y)}else r==="after"!=!!n?t.lineTo(e.x,i.y):t.lineTo(i.x,e.y);t.lineTo(i.x,i.y)}function zet(t,e,i,n){if(!e)return t.lineTo(i.x,i.y);t.bezierCurveTo(n?e.cp1x:e.cp2x,n?e.cp1y:e.cp2y,n?i.cp2x:i.cp1x,n?i.cp2y:i.cp1y,i.x,i.y)}function Vet(t,e){e.translation&&t.translate(e.translation[0],e.translation[1]),zt(e.rotation)||t.rotate(e.rotation),e.color&&(t.fillStyle=e.color),e.textAlign&&(t.textAlign=e.textAlign),e.textBaseline&&(t.textBaseline=e.textBaseline)}function jet(t,e,i,n,r){if(r.strikethrough||r.underline){const s=t.measureText(n),o=e-s.actualBoundingBoxLeft,a=e+s.actualBoundingBoxRight,l=i-s.actualBoundingBoxAscent,c=i+s.actualBoundingBoxDescent,u=r.strikethrough?(l+c)/2:c;t.strokeStyle=t.fillStyle,t.beginPath(),t.lineWidth=r.decorationWidth||2,t.moveTo(o,u),t.lineTo(a,u),t.stroke()}}function Bet(t,e){const i=t.fillStyle;t.fillStyle=e.color,t.fillRect(e.left,e.top,e.width,e.height),t.fillStyle=i}function Qy(t,e,i,n,r,s={}){const o=Ui(e)?e:[e],a=s.strokeWidth>0&&s.strokeColor!=="";let l,c;for(t.save(),t.font=r.string,Vet(t,s),l=0;l<o.length;++l)c=o[l],s.backdrop&&Bet(t,s.backdrop),a&&(s.strokeColor&&(t.strokeStyle=s.strokeColor),zt(s.strokeWidth)||(t.lineWidth=s.strokeWidth),t.strokeText(c,i,n,s.maxWidth)),t.fillText(c,i,n,s.maxWidth),jet(t,i,n,c,s),n+=Number(r.lineHeight);t.restore()}function SS(t,e){const{x:i,y:n,w:r,h:s,radius:o}=e;t.arc(i+o.topLeft,n+o.topLeft,o.topLeft,-Cn,ln,!0),t.lineTo(i,n+s-o.bottomLeft),t.arc(i+o.bottomLeft,n+s-o.bottomLeft,o.bottomLeft,ln,Cn,!0),t.lineTo(i+r-o.bottomRight,n+s),t.arc(i+r-o.bottomRight,n+s-o.bottomRight,o.bottomRight,Cn,0,!0),t.lineTo(i+r,n+o.topRight),t.arc(i+r-o.topRight,n+o.topRight,o.topRight,0,-Cn,!0),t.lineTo(i+o.topLeft,n)}const Uet=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,Get=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function Het(t,e){const i=(""+t).match(Uet);if(!i||i[1]==="normal")return e*1.2;switch(t=+i[2],i[3]){case"px":return t;case"%":t/=100;break}return e*t}const qet=t=>+t||0;function MB(t,e){const i={},n=Et(e),r=n?Object.keys(e):e,s=Et(t)?n?o=>it(t[o],t[e[o]]):o=>t[o]:()=>t;for(const o of r)i[o]=qet(s(o));return i}function vme(t){return MB(t,{top:"y",right:"x",bottom:"y",left:"x"})}function Ey(t){return MB(t,["topLeft","topRight","bottomLeft","bottomRight"])}function Fs(t){const e=vme(t);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function wr(t,e){t=t||{},e=e||Mn.font;let i=it(t.size,e.size);typeof i=="string"&&(i=parseInt(i,10));let n=it(t.style,e.style);n&&!(""+n).match(Get)&&(console.warn('Invalid font style specified: "'+n+'"'),n=void 0);const r={family:it(t.family,e.family),lineHeight:Het(it(t.lineHeight,e.lineHeight),i),size:i,style:n,weight:it(t.weight,e.weight),string:""};return r.string=Det(r),r}function xx(t,e,i,n){let r=!0,s,o,a;for(s=0,o=t.length;s<o;++s)if(a=t[s],a!==void 0&&(e!==void 0&&typeof a=="function"&&(a=a(e),r=!1),i!==void 0&&Ui(a)&&(a=a[i%a.length],r=!1),a!==void 0))return n&&!r&&(n.cacheable=!1),a}function Wet(t,e,i){const{min:n,max:r}=t,s=ome(e,(r-n)/2),o=(a,l)=>i&&a===0?0:a+l;return{min:o(n,-Math.abs(s)),max:o(r,s)}}function rm(t,e){return Object.assign(Object.create(t),e)}function EB(t,e=[""],i,n,r=()=>t[0]){const s=i||t;typeof n>"u"&&(n=xme("_fallback",t));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:t,_rootScopes:s,_fallback:n,_getTarget:r,override:a=>EB([a,...t],e,s,n)};return new Proxy(o,{deleteProperty(a,l){return delete a[l],delete a._keys,delete t[0][l],!0},get(a,l){return bme(a,l,()=>ttt(l,e,t,a))},getOwnPropertyDescriptor(a,l){return Reflect.getOwnPropertyDescriptor(a._scopes[0],l)},getPrototypeOf(){return Reflect.getPrototypeOf(t[0])},has(a,l){return TY(a).includes(l)},ownKeys(a){return TY(a)},set(a,l,c){const u=a._storage||(a._storage=r());return a[l]=u[l]=c,delete a._keys,!0}})}function Ab(t,e,i,n){const r={_cacheable:!1,_proxy:t,_context:e,_subProxy:i,_stack:new Set,_descriptors:_me(t,n),setContext:s=>Ab(t,s,i,n),override:s=>Ab(t.override(s),e,i,n)};return new Proxy(r,{deleteProperty(s,o){return delete s[o],delete t[o],!0},get(s,o,a){return bme(s,o,()=>Zet(s,o,a))},getOwnPropertyDescriptor(s,o){return s._descriptors.allKeys?Reflect.has(t,o)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(t,o)},getPrototypeOf(){return Reflect.getPrototypeOf(t)},has(s,o){return Reflect.has(t,o)},ownKeys(){return Reflect.ownKeys(t)},set(s,o,a){return t[o]=a,delete s[o],!0}})}function _me(t,e={scriptable:!0,indexable:!0}){const{_scriptable:i=e.scriptable,_indexable:n=e.indexable,_allKeys:r=e.allKeys}=t;return{allKeys:r,scriptable:i,indexable:n,isScriptable:Hf(i)?i:()=>i,isIndexable:Hf(n)?n:()=>n}}const Jet=(t,e)=>t?t+xB(e):e,AB=(t,e)=>Et(e)&&t!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function bme(t,e,i){if(Object.prototype.hasOwnProperty.call(t,e))return t[e];const n=i();return t[e]=n,n}function Zet(t,e,i){const{_proxy:n,_context:r,_subProxy:s,_descriptors:o}=t;let a=n[e];return Hf(a)&&o.isScriptable(e)&&(a=Yet(e,a,t,i)),Ui(a)&&a.length&&(a=Xet(e,a,t,o.isIndexable)),AB(e,a)&&(a=Ab(a,r,s&&s[e],o)),a}function Yet(t,e,i,n){const{_proxy:r,_context:s,_subProxy:o,_stack:a}=i;if(a.has(t))throw new Error("Recursion detected: "+Array.from(a).join("->")+"->"+t);a.add(t);let l=e(s,o||n);return a.delete(t),AB(t,l)&&(l=$B(r._scopes,r,t,l)),l}function Xet(t,e,i,n){const{_proxy:r,_context:s,_subProxy:o,_descriptors:a}=i;if(typeof s.index<"u"&&n(t))return e[s.index%e.length];if(Et(e[0])){const l=e,c=r._scopes.filter(u=>u!==l);e=[];for(const u of l){const d=$B(c,r,t,u);e.push(Ab(d,s,o&&o[t],a))}}return e}function wme(t,e,i){return Hf(t)?t(e,i):t}const Ket=(t,e)=>t===!0?e:typeof t=="string"?Gf(e,t):void 0;function Qet(t,e,i,n,r){for(const s of e){const o=Ket(i,s);if(o){t.add(o);const a=wme(o._fallback,i,r);if(typeof a<"u"&&a!==i&&a!==n)return a}else if(o===!1&&typeof n<"u"&&i!==n)return null}return!1}function $B(t,e,i,n){const r=e._rootScopes,s=wme(e._fallback,i,n),o=[...t,...r],a=new Set;a.add(n);let l=SY(a,o,i,s||i,n);return l===null||typeof s<"u"&&s!==i&&(l=SY(a,o,s,l,n),l===null)?!1:EB(Array.from(a),[""],r,s,()=>ett(e,i,n))}function SY(t,e,i,n,r){for(;i;)i=Qet(t,e,i,n,r);return i}function ett(t,e,i){const n=t._getTarget();e in n||(n[e]={});const r=n[e];return Ui(r)&&Et(i)?i:r||{}}function ttt(t,e,i,n){let r;for(const s of e)if(r=xme(Jet(s,t),i),typeof r<"u")return AB(t,r)?$B(i,n,t,r):r}function xme(t,e){for(const i of e){if(!i)continue;const n=i[t];if(typeof n<"u")return n}}function TY(t){let e=t._keys;return e||(e=t._keys=itt(t._scopes)),e}function itt(t){const e=new Set;for(const i of t)for(const n of Object.keys(i).filter(r=>!r.startsWith("_")))e.add(n);return Array.from(e)}function Sme(t,e,i,n){const{iScale:r}=t,{key:s="r"}=this._parsing,o=new Array(n);let a,l,c,u;for(a=0,l=n;a<l;++a)c=a+i,u=e[c],o[a]={r:r.parse(Gf(u,s),c)};return o}const ntt=Number.EPSILON||1e-14,$b=(t,e)=>e<t.length&&!t[e].skip&&t[e],Tme=t=>t==="x"?"y":"x";function rtt(t,e,i,n){const r=t.skip?e:t,s=e,o=i.skip?e:i,a=pz(s,r),l=pz(o,s);let c=a/(a+l),u=l/(a+l);c=isNaN(c)?0:c,u=isNaN(u)?0:u;const d=n*c,f=n*u;return{previous:{x:s.x-d*(o.x-r.x),y:s.y-d*(o.y-r.y)},next:{x:s.x+f*(o.x-r.x),y:s.y+f*(o.y-r.y)}}}function stt(t,e,i){const n=t.length;let r,s,o,a,l,c=$b(t,0);for(let u=0;u<n-1;++u)if(l=c,c=$b(t,u+1),!(!l||!c)){if(y2(e[u],0,ntt)){i[u]=i[u+1]=0;continue}r=i[u]/e[u],s=i[u+1]/e[u],a=Math.pow(r,2)+Math.pow(s,2),!(a<=9)&&(o=3/Math.sqrt(a),i[u]=r*o*e[u],i[u+1]=s*o*e[u])}}function ott(t,e,i="x"){const n=Tme(i),r=t.length;let s,o,a,l=$b(t,0);for(let c=0;c<r;++c){if(o=a,a=l,l=$b(t,c+1),!a)continue;const u=a[i],d=a[n];o&&(s=(u-o[i])/3,a[`cp1${i}`]=u-s,a[`cp1${n}`]=d-s*e[c]),l&&(s=(l[i]-u)/3,a[`cp2${i}`]=u+s,a[`cp2${n}`]=d+s*e[c])}}function att(t,e="x"){const i=Tme(e),n=t.length,r=Array(n).fill(0),s=Array(n);let o,a,l,c=$b(t,0);for(o=0;o<n;++o)if(a=l,l=c,c=$b(t,o+1),!!l){if(c){const u=c[e]-l[e];r[o]=u!==0?(c[i]-l[i])/u:0}s[o]=a?c?hl(r[o-1])!==hl(r[o])?0:(r[o-1]+r[o])/2:r[o-1]:r[o]}stt(t,r,s),ott(t,s,e)}function $C(t,e,i){return Math.max(Math.min(t,i),e)}function ltt(t,e){let i,n,r,s,o,a=Bh(t[0],e);for(i=0,n=t.length;i<n;++i)o=s,s=a,a=i<n-1&&Bh(t[i+1],e),s&&(r=t[i],o&&(r.cp1x=$C(r.cp1x,e.left,e.right),r.cp1y=$C(r.cp1y,e.top,e.bottom)),a&&(r.cp2x=$C(r.cp2x,e.left,e.right),r.cp2y=$C(r.cp2y,e.top,e.bottom)))}function ctt(t,e,i,n,r){let s,o,a,l;if(e.spanGaps&&(t=t.filter(c=>!c.skip)),e.cubicInterpolationMode==="monotone")att(t,r);else{let c=n?t[t.length-1]:t[0];for(s=0,o=t.length;s<o;++s)a=t[s],l=rtt(c,a,t[Math.min(s+1,o-(n?0:1))%o],e.tension),a.cp1x=l.previous.x,a.cp1y=l.previous.y,a.cp2x=l.next.x,a.cp2y=l.next.y,c=a}e.capBezierPoints&&ltt(t,i)}function Ime(){return typeof window<"u"&&typeof document<"u"}function PB(t){let e=t.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function z$(t,e,i){let n;return typeof t=="string"?(n=parseInt(t,10),t.indexOf("%")!==-1&&(n=n/100*e.parentNode[i])):n=t,n}const Nk=t=>t.ownerDocument.defaultView.getComputedStyle(t,null);function utt(t,e){return Nk(t).getPropertyValue(e)}const htt=["top","right","bottom","left"];function Ay(t,e,i){const n={};i=i?"-"+i:"";for(let r=0;r<4;r++){const s=htt[r];n[s]=parseFloat(t[e+"-"+s+i])||0}return n.width=n.left+n.right,n.height=n.top+n.bottom,n}const dtt=(t,e,i)=>(t>0||e>0)&&(!i||!i.shadowRoot);function ptt(t,e){const i=t.touches,n=i&&i.length?i[0]:t,{offsetX:r,offsetY:s}=n;let o=!1,a,l;if(dtt(r,s,t.target))a=r,l=s;else{const c=e.getBoundingClientRect();a=n.clientX-c.left,l=n.clientY-c.top,o=!0}return{x:a,y:l,box:o}}function mu(t,e){if("native"in t)return t;const{canvas:i,currentDevicePixelRatio:n}=e,r=Nk(i),s=r.boxSizing==="border-box",o=Ay(r,"padding"),a=Ay(r,"border","width"),{x:l,y:c,box:u}=ptt(t,i),d=o.left+(u&&a.left),f=o.top+(u&&a.top);let{width:m,height:g}=e;return s&&(m-=o.width+a.width,g-=o.height+a.height),{x:Math.round((l-d)/m*i.width/n),y:Math.round((c-f)/g*i.height/n)}}function ftt(t,e,i){let n,r;if(e===void 0||i===void 0){const s=PB(t);if(!s)e=t.clientWidth,i=t.clientHeight;else{const o=s.getBoundingClientRect(),a=Nk(s),l=Ay(a,"border","width"),c=Ay(a,"padding");e=o.width-c.width-l.width,i=o.height-c.height-l.height,n=z$(a.maxWidth,s,"clientWidth"),r=z$(a.maxHeight,s,"clientHeight")}}return{width:e,height:i,maxWidth:n||N$,maxHeight:r||N$}}const PC=t=>Math.round(t*10)/10;function mtt(t,e,i,n){const r=Nk(t),s=Ay(r,"margin"),o=z$(r.maxWidth,t,"clientWidth")||N$,a=z$(r.maxHeight,t,"clientHeight")||N$,l=ftt(t,e,i);let{width:c,height:u}=l;if(r.boxSizing==="content-box"){const f=Ay(r,"border","width"),m=Ay(r,"padding");c-=m.width+f.width,u-=m.height+f.height}return c=Math.max(0,c-s.width),u=Math.max(0,n?c/n:u-s.height),c=PC(Math.min(c,o,l.maxWidth)),u=PC(Math.min(u,a,l.maxHeight)),c&&!u&&(u=PC(c/2)),(e!==void 0||i!==void 0)&&n&&l.height&&u>l.height&&(u=l.height,c=PC(Math.floor(u*n))),{width:c,height:u}}function IY(t,e,i){const n=e||1,r=Math.floor(t.height*n),s=Math.floor(t.width*n);t.height=Math.floor(t.height),t.width=Math.floor(t.width);const o=t.canvas;return o.style&&(i||!o.style.height&&!o.style.width)&&(o.style.height=`${t.height}px`,o.style.width=`${t.width}px`),t.currentDevicePixelRatio!==n||o.height!==r||o.width!==s?(t.currentDevicePixelRatio=n,o.height=r,o.width=s,t.ctx.setTransform(n,0,0,n,0,0),!0):!1}const gtt=function(){let t=!1;try{const e={get passive(){return t=!0,!1}};window.addEventListener("test",null,e),window.removeEventListener("test",null,e)}catch{}return t}();function CY(t,e){const i=utt(t,e),n=i&&i.match(/^(\d+)(\.\d+)?px$/);return n?+n[1]:void 0}function Vg(t,e,i,n){return{x:t.x+i*(e.x-t.x),y:t.y+i*(e.y-t.y)}}function ytt(t,e,i,n){return{x:t.x+i*(e.x-t.x),y:n==="middle"?i<.5?t.y:e.y:n==="after"?i<1?t.y:e.y:i>0?e.y:t.y}}function vtt(t,e,i,n){const r={x:t.cp2x,y:t.cp2y},s={x:e.cp1x,y:e.cp1y},o=Vg(t,r,i),a=Vg(r,s,i),l=Vg(s,e,i),c=Vg(o,a,i),u=Vg(a,l,i);return Vg(c,u,i)}const _tt=function(t,e){return{x(i){return t+t+e-i},setWidth(i){e=i},textAlign(i){return i==="center"?i:i==="right"?"left":"right"},xPlus(i,n){return i-n},leftForLtr(i,n){return i-n}}},btt=function(){return{x(t){return t},setWidth(t){},textAlign(t){return t},xPlus(t,e){return t+e},leftForLtr(t,e){return t}}};function J_(t,e,i){return t?_tt(e,i):btt()}function Cme(t,e){let i,n;(e==="ltr"||e==="rtl")&&(i=t.canvas.style,n=[i.getPropertyValue("direction"),i.getPropertyPriority("direction")],i.setProperty("direction",e,"important"),t.prevTextDirection=n)}function Mme(t,e){e!==void 0&&(delete t.prevTextDirection,t.canvas.style.setProperty("direction",e[0],e[1]))}function Eme(t){return t==="angle"?{between:xS,compare:bet,normalize:da}:{between:Vh,compare:(e,i)=>e-i,normalize:e=>e}}function MY({start:t,end:e,count:i,loop:n,style:r}){return{start:t%i,end:e%i,loop:n&&(e-t+1)%i===0,style:r}}function wtt(t,e,i){const{property:n,start:r,end:s}=i,{between:o,normalize:a}=Eme(n),l=e.length;let{start:c,end:u,loop:d}=t,f,m;if(d){for(c+=l,u+=l,f=0,m=l;f<m&&o(a(e[c%l][n]),r,s);++f)c--,u--;c%=l,u%=l}return u<c&&(u+=l),{start:c,end:u,loop:d,style:t.style}}function Ame(t,e,i){if(!i)return[t];const{property:n,start:r,end:s}=i,o=e.length,{compare:a,between:l,normalize:c}=Eme(n),{start:u,end:d,loop:f,style:m}=wtt(t,e,i),g=[];let y=!1,_=null,b,w,x;const S=()=>l(r,x,b)&&a(r,x)!==0,T=()=>a(s,b)===0||l(s,x,b),I=()=>y||S(),C=()=>!y||T();for(let M=u,E=u;M<=d;++M)w=e[M%o],!w.skip&&(b=c(w[n]),b!==x&&(y=l(b,r,s),_===null&&I()&&(_=a(b,r)===0?M:E),_!==null&&C()&&(g.push(MY({start:_,end:M,loop:f,count:o,style:m})),_=null),E=M,x=b));return _!==null&&g.push(MY({start:_,end:d,loop:f,count:o,style:m})),g}function $me(t,e){const i=[],n=t.segments;for(let r=0;r<n.length;r++){const s=Ame(n[r],t.points,e);s.length&&i.push(...s)}return i}function xtt(t,e,i,n){let r=0,s=e-1;if(i&&!n)for(;r<e&&!t[r].skip;)r++;for(;r<e&&t[r].skip;)r++;for(r%=e,i&&(s+=r);s>r&&t[s%e].skip;)s--;return s%=e,{start:r,end:s}}function Stt(t,e,i,n){const r=t.length,s=[];let o=e,a=t[e],l;for(l=e+1;l<=i;++l){const c=t[l%r];c.skip||c.stop?a.skip||(n=!1,s.push({start:e%r,end:(l-1)%r,loop:n}),e=o=c.stop?l:null):(o=l,a.skip&&(e=l)),a=c}return o!==null&&s.push({start:e%r,end:o%r,loop:n}),s}function Ttt(t,e){const i=t.points,n=t.options.spanGaps,r=i.length;if(!r)return[];const s=!!t._loop,{start:o,end:a}=xtt(i,r,s,n);if(n===!0)return EY(t,[{start:o,end:a,loop:s}],i,e);const l=a<o?a+r:a,c=!!t._fullLoop&&o===0&&a===r-1;return EY(t,Stt(i,o,l,c),i,e)}function EY(t,e,i,n){return!n||!n.setContext||!i?e:Itt(t,e,i,n)}function Itt(t,e,i,n){const r=t._chart.getContext(),s=AY(t.options),{_datasetIndex:o,options:{spanGaps:a}}=t,l=i.length,c=[];let u=s,d=e[0].start,f=d;function m(g,y,_,b){const w=a?-1:1;if(g!==y){for(g+=l;i[g%l].skip;)g-=w;for(;i[y%l].skip;)y+=w;g%l!==y%l&&(c.push({start:g%l,end:y%l,loop:_,style:b}),u=b,d=y%l)}}for(const g of e){d=a?d:g.start;let y=i[d%l],_;for(f=d+1;f<=g.end;f++){const b=i[f%l];_=AY(n.setContext(rm(r,{type:"segment",p0:y,p1:b,p0DataIndex:(f-1)%l,p1DataIndex:f%l,datasetIndex:o}))),Ctt(_,u)&&m(d,f-1,g.loop,u),y=b,u=_}d<f-1&&m(d,f-1,g.loop,u)}return c}function AY(t){return{backgroundColor:t.backgroundColor,borderCapStyle:t.borderCapStyle,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderJoinStyle:t.borderJoinStyle,borderWidth:t.borderWidth,borderColor:t.borderColor}}function Ctt(t,e){if(!e)return!1;const i=[],n=function(r,s){return CB(s)?(i.includes(s)||i.push(s),i.indexOf(s)):s};return JSON.stringify(t,n)!==JSON.stringify(e,n)}/*!
 * Chart.js v4.3.0
 * https://www.chartjs.org
 * (c) 2023 Chart.js Contributors
 * Released under the MIT License
 */class Mtt{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,i,n,r){const s=i.listeners[r],o=i.duration;s.forEach(a=>a({chart:e,initial:i.initial,numSteps:o,currentStep:Math.min(n-i.start,o)}))}_refresh(){this._request||(this._running=!0,this._request=dme.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let i=0;this._charts.forEach((n,r)=>{if(!n.running||!n.items.length)return;const s=n.items;let o=s.length-1,a=!1,l;for(;o>=0;--o)l=s[o],l._active?(l._total>n.duration&&(n.duration=l._total),l.tick(e),a=!0):(s[o]=s[s.length-1],s.pop());a&&(r.draw(),this._notify(r,n,e,"progress")),s.length||(n.running=!1,this._notify(r,n,e,"complete"),n.initial=!1),i+=s.length}),this._lastDate=e,i===0&&(this._running=!1)}_getAnims(e){const i=this._charts;let n=i.get(e);return n||(n={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},i.set(e,n)),n}listen(e,i,n){this._getAnims(e).listeners[i].push(n)}add(e,i){!i||!i.length||this._getAnims(e).items.push(...i)}has(e){return this._getAnims(e).items.length>0}start(e){const i=this._charts.get(e);i&&(i.running=!0,i.start=Date.now(),i.duration=i.items.reduce((n,r)=>Math.max(n,r._duration),0),this._refresh())}running(e){if(!this._running)return!1;const i=this._charts.get(e);return!(!i||!i.running||!i.items.length)}stop(e){const i=this._charts.get(e);if(!i||!i.items.length)return;const n=i.items;let r=n.length-1;for(;r>=0;--r)n[r].cancel();i.items=[],this._notify(e,i,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var Th=new Mtt;const $Y="transparent",Ett={boolean(t,e,i){return i>.5?e:t},color(t,e,i){const n=bY(t||$Y),r=n.valid&&bY(e||$Y);return r&&r.valid?r.mix(n,i).hexString():e},number(t,e,i){return t+(e-t)*i}};class Att{constructor(e,i,n,r){const s=i[n];r=xx([e.to,r,s,e.from]);const o=xx([e.from,s,r]);this._active=!0,this._fn=e.fn||Ett[e.type||typeof o],this._easing=v2[e.easing]||v2.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=i,this._prop=n,this._from=o,this._to=r,this._promises=void 0}active(){return this._active}update(e,i,n){if(this._active){this._notify(!1);const r=this._target[this._prop],s=n-this._start,o=this._duration-s;this._start=n,this._duration=Math.floor(Math.max(o,e.duration)),this._total+=s,this._loop=!!e.loop,this._to=xx([e.to,i,r,e.from]),this._from=xx([e.from,r,i])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const i=e-this._start,n=this._duration,r=this._prop,s=this._from,o=this._loop,a=this._to;let l;if(this._active=s!==a&&(o||i<n),!this._active){this._target[r]=a,this._notify(!0);return}if(i<0){this._target[r]=s;return}l=i/n%2,l=o&&l>1?2-l:l,l=this._easing(Math.min(1,Math.max(0,l))),this._target[r]=this._fn(s,a,l)}wait(){const e=this._promises||(this._promises=[]);return new Promise((i,n)=>{e.push({res:i,rej:n})})}_notify(e){const i=e?"res":"rej",n=this._promises||[];for(let r=0;r<n.length;r++)n[r][i]()}}class Pme{constructor(e,i){this._chart=e,this._properties=new Map,this.configure(i)}configure(e){if(!Et(e))return;const i=Object.keys(Mn.animation),n=this._properties;Object.getOwnPropertyNames(e).forEach(r=>{const s=e[r];if(!Et(s))return;const o={};for(const a of i)o[a]=s[a];(Ui(s.properties)&&s.properties||[r]).forEach(a=>{(a===r||!n.has(a))&&n.set(a,o)})})}_animateOptions(e,i){const n=i.options,r=Ptt(e,n);if(!r)return[];const s=this._createAnimations(r,n);return n.$shared&&$tt(e.options.$animations,n).then(()=>{e.options=n},()=>{}),s}_createAnimations(e,i){const n=this._properties,r=[],s=e.$animations||(e.$animations={}),o=Object.keys(i),a=Date.now();let l;for(l=o.length-1;l>=0;--l){const c=o[l];if(c.charAt(0)==="$")continue;if(c==="options"){r.push(...this._animateOptions(e,i));continue}const u=i[c];let d=s[c];const f=n.get(c);if(d)if(f&&d.active()){d.update(f,u,a);continue}else d.cancel();if(!f||!f.duration){e[c]=u;continue}s[c]=d=new Att(f,e,c,u),r.push(d)}return r}update(e,i){if(this._properties.size===0){Object.assign(e,i);return}const n=this._createAnimations(e,i);if(n.length)return Th.add(this._chart,n),!0}}function $tt(t,e){const i=[],n=Object.keys(e);for(let r=0;r<n.length;r++){const s=t[n[r]];s&&s.active()&&i.push(s.wait())}return Promise.all(i)}function Ptt(t,e){if(!e)return;let i=t.options;if(!i){t.options=e;return}return i.$shared&&(t.options=i=Object.assign({},i,{$shared:!1,$animations:{}})),i}function PY(t,e){const i=t&&t.options||{},n=i.reverse,r=i.min===void 0?e:0,s=i.max===void 0?e:0;return{start:n?s:r,end:n?r:s}}function ktt(t,e,i){if(i===!1)return!1;const n=PY(t,i),r=PY(e,i);return{top:r.end,right:n.end,bottom:r.start,left:n.start}}function Ott(t){let e,i,n,r;return Et(t)?(e=t.top,i=t.right,n=t.bottom,r=t.left):e=i=n=r=t,{top:e,right:i,bottom:n,left:r,disabled:t===!1}}function kme(t,e){const i=[],n=t._getSortedDatasetMetas(e);let r,s;for(r=0,s=n.length;r<s;++r)i.push(n[r].index);return i}function kY(t,e,i,n={}){const r=t.keys,s=n.mode==="single";let o,a,l,c;if(e!==null){for(o=0,a=r.length;o<a;++o){if(l=+r[o],l===i){if(n.all)continue;break}c=t.values[l],In(c)&&(s||e===0||hl(e)===hl(c))&&(e+=c)}return e}}function Ltt(t){const e=Object.keys(t),i=new Array(e.length);let n,r,s;for(n=0,r=e.length;n<r;++n)s=e[n],i[n]={x:s,y:t[s]};return i}function OY(t,e){const i=t&&t.options.stacked;return i||i===void 0&&e.stack!==void 0}function Rtt(t,e,i){return`${t.id}.${e.id}.${i.stack||i.type}`}function Dtt(t){const{min:e,max:i,minDefined:n,maxDefined:r}=t.getUserBounds();return{min:n?e:Number.NEGATIVE_INFINITY,max:r?i:Number.POSITIVE_INFINITY}}function Ntt(t,e,i){const n=t[e]||(t[e]={});return n[i]||(n[i]={})}function LY(t,e,i,n){for(const r of e.getMatchingVisibleMetas(n).reverse()){const s=t[r.index];if(i&&s>0||!i&&s<0)return r.index}return null}function RY(t,e){const{chart:i,_cachedMeta:n}=t,r=i._stacks||(i._stacks={}),{iScale:s,vScale:o,index:a}=n,l=s.axis,c=o.axis,u=Rtt(s,o,n),d=e.length;let f;for(let m=0;m<d;++m){const g=e[m],{[l]:y,[c]:_}=g,b=g._stacks||(g._stacks={});f=b[c]=Ntt(r,u,y),f[a]=_,f._top=LY(f,o,!0,n.type),f._bottom=LY(f,o,!1,n.type);const w=f._visualValues||(f._visualValues={});w[a]=_}}function DL(t,e){const i=t.scales;return Object.keys(i).filter(n=>i[n].axis===e).shift()}function Ftt(t,e){return rm(t,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function ztt(t,e,i){return rm(t,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:i,index:e,mode:"default",type:"data"})}function iw(t,e){const i=t.controller.index,n=t.vScale&&t.vScale.axis;if(n){e=e||t._parsed;for(const r of e){const s=r._stacks;if(!s||s[n]===void 0||s[n][i]===void 0)return;delete s[n][i],s[n]._visualValues!==void 0&&s[n]._visualValues[i]!==void 0&&delete s[n]._visualValues[i]}}}const NL=t=>t==="reset"||t==="none",DY=(t,e)=>e?t:Object.assign({},t),Vtt=(t,e,i)=>t&&!e.hidden&&e._stacked&&{keys:kme(i,!0),values:null};class wc{constructor(e,i){this.chart=e,this._ctx=e.ctx,this.index=i,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=OY(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&iw(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,i=this._cachedMeta,n=this.getDataset(),r=(d,f,m,g)=>d==="x"?f:d==="r"?g:m,s=i.xAxisID=it(n.xAxisID,DL(e,"x")),o=i.yAxisID=it(n.yAxisID,DL(e,"y")),a=i.rAxisID=it(n.rAxisID,DL(e,"r")),l=i.indexAxis,c=i.iAxisID=r(l,s,o,a),u=i.vAxisID=r(l,o,s,a);i.xScale=this.getScaleForId(s),i.yScale=this.getScaleForId(o),i.rScale=this.getScaleForId(a),i.iScale=this.getScaleForId(c),i.vScale=this.getScaleForId(u)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const i=this._cachedMeta;return e===i.iScale?i.vScale:i.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&yY(this._data,this),e._stacked&&iw(e)}_dataCheck(){const e=this.getDataset(),i=e.data||(e.data=[]),n=this._data;if(Et(i))this._data=Ltt(i);else if(n!==i){if(n){yY(n,this);const r=this._cachedMeta;iw(r),r._parsed=[]}i&&Object.isExtensible(i)&&Iet(i,this),this._syncList=[],this._data=i}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const i=this._cachedMeta,n=this.getDataset();let r=!1;this._dataCheck();const s=i._stacked;i._stacked=OY(i.vScale,i),i.stack!==n.stack&&(r=!0,iw(i),i.stack=n.stack),this._resyncElements(e),(r||s!==i._stacked)&&RY(this,i._parsed)}configure(){const e=this.chart.config,i=e.datasetScopeKeys(this._type),n=e.getOptionScopes(this.getDataset(),i,!0);this.options=e.createResolver(n,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,i){const{_cachedMeta:n,_data:r}=this,{iScale:s,_stacked:o}=n,a=s.axis;let l=e===0&&i===r.length?!0:n._sorted,c=e>0&&n._parsed[e-1],u,d,f;if(this._parsing===!1)n._parsed=r,n._sorted=!0,f=r;else{Ui(r[e])?f=this.parseArrayData(n,r,e,i):Et(r[e])?f=this.parseObjectData(n,r,e,i):f=this.parsePrimitiveData(n,r,e,i);const m=()=>d[a]===null||c&&d[a]<c[a];for(u=0;u<i;++u)n._parsed[u+e]=d=f[u],l&&(m()&&(l=!1),c=d);n._sorted=l}o&&RY(this,f)}parsePrimitiveData(e,i,n,r){const{iScale:s,vScale:o}=e,a=s.axis,l=o.axis,c=s.getLabels(),u=s===o,d=new Array(r);let f,m,g;for(f=0,m=r;f<m;++f)g=f+n,d[f]={[a]:u||s.parse(c[g],g),[l]:o.parse(i[g],g)};return d}parseArrayData(e,i,n,r){const{xScale:s,yScale:o}=e,a=new Array(r);let l,c,u,d;for(l=0,c=r;l<c;++l)u=l+n,d=i[u],a[l]={x:s.parse(d[0],u),y:o.parse(d[1],u)};return a}parseObjectData(e,i,n,r){const{xScale:s,yScale:o}=e,{xAxisKey:a="x",yAxisKey:l="y"}=this._parsing,c=new Array(r);let u,d,f,m;for(u=0,d=r;u<d;++u)f=u+n,m=i[f],c[u]={x:s.parse(Gf(m,a),f),y:o.parse(Gf(m,l),f)};return c}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,i,n){const r=this.chart,s=this._cachedMeta,o=i[e.axis],a={keys:kme(r,!0),values:i._stacks[e.axis]._visualValues};return kY(a,o,s.index,{mode:n})}updateRangeFromParsed(e,i,n,r){const s=n[i.axis];let o=s===null?NaN:s;const a=r&&n._stacks[i.axis];r&&a&&(r.values=a,o=kY(r,s,this._cachedMeta.index)),e.min=Math.min(e.min,o),e.max=Math.max(e.max,o)}getMinMax(e,i){const n=this._cachedMeta,r=n._parsed,s=n._sorted&&e===n.iScale,o=r.length,a=this._getOtherScale(e),l=Vtt(i,n,this.chart),c={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:u,max:d}=Dtt(a);let f,m;function g(){m=r[f];const y=m[a.axis];return!In(m[e.axis])||u>y||d<y}for(f=0;f<o&&!(!g()&&(this.updateRangeFromParsed(c,e,m,l),s));++f);if(s){for(f=o-1;f>=0;--f)if(!g()){this.updateRangeFromParsed(c,e,m,l);break}}return c}getAllParsedValues(e){const i=this._cachedMeta._parsed,n=[];let r,s,o;for(r=0,s=i.length;r<s;++r)o=i[r][e.axis],In(o)&&n.push(o);return n}getMaxOverflow(){return!1}getLabelAndValue(e){const i=this._cachedMeta,n=i.iScale,r=i.vScale,s=this.getParsed(e);return{label:n?""+n.getLabelForValue(s[n.axis]):"",value:r?""+r.getLabelForValue(s[r.axis]):""}}_update(e){const i=this._cachedMeta;this.update(e||"default"),i._clip=Ott(it(this.options.clip,ktt(i.xScale,i.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,i=this.chart,n=this._cachedMeta,r=n.data||[],s=i.chartArea,o=[],a=this._drawStart||0,l=this._drawCount||r.length-a,c=this.options.drawActiveElementsOnTop;let u;for(n.dataset&&n.dataset.draw(e,s,a,l),u=a;u<a+l;++u){const d=r[u];d.hidden||(d.active&&c?o.push(d):d.draw(e,s))}for(u=0;u<o.length;++u)o[u].draw(e,s)}getStyle(e,i){const n=i?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(n):this.resolveDataElementOptions(e||0,n)}getContext(e,i,n){const r=this.getDataset();let s;if(e>=0&&e<this._cachedMeta.data.length){const o=this._cachedMeta.data[e];s=o.$context||(o.$context=ztt(this.getContext(),e,o)),s.parsed=this.getParsed(e),s.raw=r.data[e],s.index=s.dataIndex=e}else s=this.$context||(this.$context=Ftt(this.chart.getContext(),this.index)),s.dataset=r,s.index=s.datasetIndex=this.index;return s.active=!!i,s.mode=n,s}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,i){return this._resolveElementOptions(this.dataElementType.id,i,e)}_resolveElementOptions(e,i="default",n){const r=i==="active",s=this._cachedDataOpts,o=e+"-"+i,a=s[o],l=this.enableOptionSharing&&wS(n);if(a)return DY(a,l);const c=this.chart.config,u=c.datasetElementScopeKeys(this._type,e),d=r?[`${e}Hover`,"hover",e,""]:[e,""],f=c.getOptionScopes(this.getDataset(),u),m=Object.keys(Mn.elements[e]),g=()=>this.getContext(n,r,i),y=c.resolveNamedOptions(f,m,g,d);return y.$shared&&(y.$shared=l,s[o]=Object.freeze(DY(y,l))),y}_resolveAnimations(e,i,n){const r=this.chart,s=this._cachedDataOpts,o=`animation-${i}`,a=s[o];if(a)return a;let l;if(r.options.animation!==!1){const u=this.chart.config,d=u.datasetAnimationScopeKeys(this._type,i),f=u.getOptionScopes(this.getDataset(),d);l=u.createResolver(f,this.getContext(e,n,i))}const c=new Pme(r,l&&l.animations);return l&&l._cacheable&&(s[o]=Object.freeze(c)),c}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,i){return!i||NL(e)||this.chart._animationsDisabled}_getSharedOptions(e,i){const n=this.resolveDataElementOptions(e,i),r=this._sharedOptions,s=this.getSharedOptions(n),o=this.includeOptions(i,s)||s!==r;return this.updateSharedOptions(s,i,n),{sharedOptions:s,includeOptions:o}}updateElement(e,i,n,r){NL(r)?Object.assign(e,n):this._resolveAnimations(i,r).update(e,n)}updateSharedOptions(e,i,n){e&&!NL(i)&&this._resolveAnimations(void 0,i).update(e,n)}_setStyle(e,i,n,r){e.active=r;const s=this.getStyle(i,r);this._resolveAnimations(i,n,r).update(e,{options:!r&&this.getSharedOptions(s)||s})}removeHoverStyle(e,i,n){this._setStyle(e,n,"active",!1)}setHoverStyle(e,i,n){this._setStyle(e,n,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const i=this._data,n=this._cachedMeta.data;for(const[a,l,c]of this._syncList)this[a](l,c);this._syncList=[];const r=n.length,s=i.length,o=Math.min(s,r);o&&this.parse(0,o),s>r?this._insertElements(r,s-r,e):s<r&&this._removeElements(s,r-s)}_insertElements(e,i,n=!0){const r=this._cachedMeta,s=r.data,o=e+i;let a;const l=c=>{for(c.length+=i,a=c.length-1;a>=o;a--)c[a]=c[a-i]};for(l(s),a=e;a<o;++a)s[a]=new this.dataElementType;this._parsing&&l(r._parsed),this.parse(e,i),n&&this.updateElements(s,e,i,"reset")}updateElements(e,i,n,r){}_removeElements(e,i){const n=this._cachedMeta;if(this._parsing){const r=n._parsed.splice(e,i);n._stacked&&iw(n,r)}n.data.splice(e,i)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[i,n,r]=e;this[i](n,r)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,i){i&&this._sync(["_removeElements",e,i]);const n=arguments.length-2;n&&this._sync(["_insertElements",e,n])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}ve(wc,"defaults",{}),ve(wc,"datasetElementType",null),ve(wc,"dataElementType",null);function jtt(t,e){if(!t._cache.$bar){const i=t.getMatchingVisibleMetas(e);let n=[];for(let r=0,s=i.length;r<s;r++)n=n.concat(i[r].controller.getAllParsedValues(t));t._cache.$bar=hme(n.sort((r,s)=>r-s))}return t._cache.$bar}function Btt(t){const e=t.iScale,i=jtt(e,t.type);let n=e._length,r,s,o,a;const l=()=>{o===32767||o===-32768||(wS(a)&&(n=Math.min(n,Math.abs(o-a)||n)),a=o)};for(r=0,s=i.length;r<s;++r)o=e.getPixelForValue(i[r]),l();for(a=void 0,r=0,s=e.ticks.length;r<s;++r)o=e.getPixelForTick(r),l();return n}function Utt(t,e,i,n){const r=i.barThickness;let s,o;return zt(r)?(s=e.min*i.categoryPercentage,o=i.barPercentage):(s=r*n,o=1),{chunk:s/n,ratio:o,start:e.pixels[t]-s/2}}function Gtt(t,e,i,n){const r=e.pixels,s=r[t];let o=t>0?r[t-1]:null,a=t<r.length-1?r[t+1]:null;const l=i.categoryPercentage;o===null&&(o=s-(a===null?e.end-e.start:a-s)),a===null&&(a=s+s-o);const c=s-(s-Math.min(o,a))/2*l;return{chunk:Math.abs(a-o)/2*l/n,ratio:i.barPercentage,start:c}}function Htt(t,e,i,n){const r=i.parse(t[0],n),s=i.parse(t[1],n),o=Math.min(r,s),a=Math.max(r,s);let l=o,c=a;Math.abs(o)>Math.abs(a)&&(l=a,c=o),e[i.axis]=c,e._custom={barStart:l,barEnd:c,start:r,end:s,min:o,max:a}}function Ome(t,e,i,n){return Ui(t)?Htt(t,e,i,n):e[i.axis]=i.parse(t,n),e}function NY(t,e,i,n){const r=t.iScale,s=t.vScale,o=r.getLabels(),a=r===s,l=[];let c,u,d,f;for(c=i,u=i+n;c<u;++c)f=e[c],d={},d[r.axis]=a||r.parse(o[c],c),l.push(Ome(f,d,s,c));return l}function FL(t){return t&&t.barStart!==void 0&&t.barEnd!==void 0}function qtt(t,e,i){return t!==0?hl(t):(e.isHorizontal()?1:-1)*(e.min>=i?1:-1)}function Wtt(t){let e,i,n,r,s;return t.horizontal?(e=t.base>t.x,i="left",n="right"):(e=t.base<t.y,i="bottom",n="top"),e?(r="end",s="start"):(r="start",s="end"),{start:i,end:n,reverse:e,top:r,bottom:s}}function Jtt(t,e,i,n){let r=e.borderSkipped;const s={};if(!r){t.borderSkipped=s;return}if(r===!0){t.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:o,end:a,reverse:l,top:c,bottom:u}=Wtt(t);r==="middle"&&i&&(t.enableBorderRadius=!0,(i._top||0)===n?r=c:(i._bottom||0)===n?r=u:(s[FY(u,o,a,l)]=!0,r=c)),s[FY(r,o,a,l)]=!0,t.borderSkipped=s}function FY(t,e,i,n){return n?(t=Ztt(t,e,i),t=zY(t,i,e)):t=zY(t,e,i),t}function Ztt(t,e,i){return t===e?i:t===i?e:t}function zY(t,e,i){return t==="start"?e:t==="end"?i:t}function Ytt(t,{inflateAmount:e},i){t.inflateAmount=e==="auto"?i===1?.33:0:e}class bE extends wc{parsePrimitiveData(e,i,n,r){return NY(e,i,n,r)}parseArrayData(e,i,n,r){return NY(e,i,n,r)}parseObjectData(e,i,n,r){const{iScale:s,vScale:o}=e,{xAxisKey:a="x",yAxisKey:l="y"}=this._parsing,c=s.axis==="x"?a:l,u=o.axis==="x"?a:l,d=[];let f,m,g,y;for(f=n,m=n+r;f<m;++f)y=i[f],g={},g[s.axis]=s.parse(Gf(y,c),f),d.push(Ome(Gf(y,u),g,o,f));return d}updateRangeFromParsed(e,i,n,r){super.updateRangeFromParsed(e,i,n,r);const s=n._custom;s&&i===this._cachedMeta.vScale&&(e.min=Math.min(e.min,s.min),e.max=Math.max(e.max,s.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const i=this._cachedMeta,{iScale:n,vScale:r}=i,s=this.getParsed(e),o=s._custom,a=FL(o)?"["+o.start+", "+o.end+"]":""+r.getLabelForValue(s[r.axis]);return{label:""+n.getLabelForValue(s[n.axis]),value:a}}initialize(){this.enableOptionSharing=!0,super.initialize();const e=this._cachedMeta;e.stack=this.getDataset().stack}update(e){const i=this._cachedMeta;this.updateElements(i.data,0,i.data.length,e)}updateElements(e,i,n,r){const s=r==="reset",{index:o,_cachedMeta:{vScale:a}}=this,l=a.getBasePixel(),c=a.isHorizontal(),u=this._getRuler(),{sharedOptions:d,includeOptions:f}=this._getSharedOptions(i,r);for(let m=i;m<i+n;m++){const g=this.getParsed(m),y=s||zt(g[a.axis])?{base:l,head:l}:this._calculateBarValuePixels(m),_=this._calculateBarIndexPixels(m,u),b=(g._stacks||{})[a.axis],w={horizontal:c,base:y.base,enableBorderRadius:!b||FL(g._custom)||o===b._top||o===b._bottom,x:c?y.head:_.center,y:c?_.center:y.head,height:c?_.size:Math.abs(y.size),width:c?Math.abs(y.size):_.size};f&&(w.options=d||this.resolveDataElementOptions(m,e[m].active?"active":r));const x=w.options||e[m].options;Jtt(w,x,b,o),Ytt(w,x,u.ratio),this.updateElement(e[m],m,w,r)}}_getStacks(e,i){const{iScale:n}=this._cachedMeta,r=n.getMatchingVisibleMetas(this._type).filter(l=>l.controller.options.grouped),s=n.options.stacked,o=[],a=l=>{const c=l.controller.getParsed(i),u=c&&c[l.vScale.axis];if(zt(u)||isNaN(u))return!0};for(const l of r)if(!(i!==void 0&&a(l))&&((s===!1||o.indexOf(l.stack)===-1||s===void 0&&l.stack===void 0)&&o.push(l.stack),l.index===e))break;return o.length||o.push(void 0),o}_getStackCount(e){return this._getStacks(void 0,e).length}_getStackIndex(e,i,n){const r=this._getStacks(e,n),s=i!==void 0?r.indexOf(i):-1;return s===-1?r.length-1:s}_getRuler(){const e=this.options,i=this._cachedMeta,n=i.iScale,r=[];let s,o;for(s=0,o=i.data.length;s<o;++s)r.push(n.getPixelForValue(this.getParsed(s)[n.axis],s));const a=e.barThickness;return{min:a||Btt(i),pixels:r,start:n._startPixel,end:n._endPixel,stackCount:this._getStackCount(),scale:n,grouped:e.grouped,ratio:a?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:i,_stacked:n,index:r},options:{base:s,minBarLength:o}}=this,a=s||0,l=this.getParsed(e),c=l._custom,u=FL(c);let d=l[i.axis],f=0,m=n?this.applyStack(i,l,n):d,g,y;m!==d&&(f=m-d,m=d),u&&(d=c.barStart,m=c.barEnd-c.barStart,d!==0&&hl(d)!==hl(c.barEnd)&&(f=0),f+=d);const _=!zt(s)&&!u?s:f;let b=i.getPixelForValue(_);if(this.chart.getDataVisibility(e)?g=i.getPixelForValue(f+m):g=b,y=g-b,Math.abs(y)<o){y=qtt(y,i,a)*o,d===a&&(b-=y/2);const w=i.getPixelForDecimal(0),x=i.getPixelForDecimal(1),S=Math.min(w,x),T=Math.max(w,x);b=Math.max(Math.min(b,T),S),g=b+y,n&&!u&&(l._stacks[i.axis]._visualValues[r]=i.getValueForPixel(g)-i.getValueForPixel(b))}if(b===i.getPixelForValue(a)){const w=hl(y)*i.getLineWidthForValue(a)/2;b+=w,y-=w}return{size:y,base:b,head:g,center:g+y/2}}_calculateBarIndexPixels(e,i){const n=i.scale,r=this.options,s=r.skipNull,o=it(r.maxBarThickness,1/0);let a,l;if(i.grouped){const c=s?this._getStackCount(e):i.stackCount,u=r.barThickness==="flex"?Gtt(e,i,r,c):Utt(e,i,r,c),d=this._getStackIndex(this.index,this._cachedMeta.stack,s?e:void 0);a=u.start+u.chunk*d+u.chunk/2,l=Math.min(o,u.chunk*u.ratio)}else a=n.getPixelForValue(this.getParsed(e)[n.axis],e),l=Math.min(o,i.min*i.ratio);return{base:a-l/2,head:a+l/2,center:a,size:l}}draw(){const e=this._cachedMeta,i=e.vScale,n=e.data,r=n.length;let s=0;for(;s<r;++s)this.getParsed(s)[i.axis]!==null&&n[s].draw(this._ctx)}}ve(bE,"id","bar"),ve(bE,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),ve(bE,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});class wE extends wc{initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(e,i,n,r){const s=super.parsePrimitiveData(e,i,n,r);for(let o=0;o<s.length;o++)s[o]._custom=this.resolveDataElementOptions(o+n).radius;return s}parseArrayData(e,i,n,r){const s=super.parseArrayData(e,i,n,r);for(let o=0;o<s.length;o++){const a=i[n+o];s[o]._custom=it(a[2],this.resolveDataElementOptions(o+n).radius)}return s}parseObjectData(e,i,n,r){const s=super.parseObjectData(e,i,n,r);for(let o=0;o<s.length;o++){const a=i[n+o];s[o]._custom=it(a&&a.r&&+a.r,this.resolveDataElementOptions(o+n).radius)}return s}getMaxOverflow(){const e=this._cachedMeta.data;let i=0;for(let n=e.length-1;n>=0;--n)i=Math.max(i,e[n].size(this.resolveDataElementOptions(n))/2);return i>0&&i}getLabelAndValue(e){const i=this._cachedMeta,n=this.chart.data.labels||[],{xScale:r,yScale:s}=i,o=this.getParsed(e),a=r.getLabelForValue(o.x),l=s.getLabelForValue(o.y),c=o._custom;return{label:n[e]||"",value:"("+a+", "+l+(c?", "+c:"")+")"}}update(e){const i=this._cachedMeta.data;this.updateElements(i,0,i.length,e)}updateElements(e,i,n,r){const s=r==="reset",{iScale:o,vScale:a}=this._cachedMeta,{sharedOptions:l,includeOptions:c}=this._getSharedOptions(i,r),u=o.axis,d=a.axis;for(let f=i;f<i+n;f++){const m=e[f],g=!s&&this.getParsed(f),y={},_=y[u]=s?o.getPixelForDecimal(.5):o.getPixelForValue(g[u]),b=y[d]=s?a.getBasePixel():a.getPixelForValue(g[d]);y.skip=isNaN(_)||isNaN(b),c&&(y.options=l||this.resolveDataElementOptions(f,m.active?"active":r),s&&(y.options.radius=0)),this.updateElement(m,f,y,r)}}resolveDataElementOptions(e,i){const n=this.getParsed(e);let r=super.resolveDataElementOptions(e,i);r.$shared&&(r=Object.assign({},r,{$shared:!1}));const s=r.radius;return i!=="active"&&(r.radius=0),r.radius+=it(n&&n._custom,s),r}}ve(wE,"id","bubble"),ve(wE,"defaults",{datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}}),ve(wE,"overrides",{scales:{x:{type:"linear"},y:{type:"linear"}}});function Xtt(t,e,i){let n=1,r=1,s=0,o=0;if(e<Hi){const a=t,l=a+e,c=Math.cos(a),u=Math.sin(a),d=Math.cos(l),f=Math.sin(l),m=(x,S,T)=>xS(x,a,l,!0)?1:Math.max(S,S*i,T,T*i),g=(x,S,T)=>xS(x,a,l,!0)?-1:Math.min(S,S*i,T,T*i),y=m(0,c,d),_=m(Cn,u,f),b=g(ln,c,d),w=g(ln+Cn,u,f);n=(y-b)/2,r=(_-w)/2,s=-(y+b)/2,o=-(_+w)/2}return{ratioX:n,ratioY:r,offsetX:s,offsetY:o}}class dy extends wc{constructor(e,i){super(e,i),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,i){const n=this.getDataset().data,r=this._cachedMeta;if(this._parsing===!1)r._parsed=n;else{let s=l=>+n[l];if(Et(n[e])){const{key:l="value"}=this._parsing;s=c=>+Gf(n[c],l)}let o,a;for(o=e,a=e+i;o<a;++o)r._parsed[o]=s(o)}}_getRotation(){return mc(this.options.rotation-90)}_getCircumference(){return mc(this.options.circumference)}_getRotationExtents(){let e=Hi,i=-Hi;for(let n=0;n<this.chart.data.datasets.length;++n)if(this.chart.isDatasetVisible(n)&&this.chart.getDatasetMeta(n).type===this._type){const r=this.chart.getDatasetMeta(n).controller,s=r._getRotation(),o=r._getCircumference();e=Math.min(e,s),i=Math.max(i,s+o)}return{rotation:e,circumference:i-e}}update(e){const i=this.chart,{chartArea:n}=i,r=this._cachedMeta,s=r.data,o=this.getMaxBorderWidth()+this.getMaxOffset(s)+this.options.spacing,a=Math.max((Math.min(n.width,n.height)-o)/2,0),l=Math.min(uet(this.options.cutout,a),1),c=this._getRingWeight(this.index),{circumference:u,rotation:d}=this._getRotationExtents(),{ratioX:f,ratioY:m,offsetX:g,offsetY:y}=Xtt(d,u,l),_=(n.width-o)/f,b=(n.height-o)/m,w=Math.max(Math.min(_,b)/2,0),x=ome(this.options.radius,w),S=Math.max(x*l,0),T=(x-S)/this._getVisibleDatasetWeightTotal();this.offsetX=g*x,this.offsetY=y*x,r.total=this.calculateTotal(),this.outerRadius=x-T*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-T*c,0),this.updateElements(s,0,s.length,e)}_circumference(e,i){const n=this.options,r=this._cachedMeta,s=this._getCircumference();return i&&n.animation.animateRotate||!this.chart.getDataVisibility(e)||r._parsed[e]===null||r.data[e].hidden?0:this.calculateCircumference(r._parsed[e]*s/Hi)}updateElements(e,i,n,r){const s=r==="reset",o=this.chart,a=o.chartArea,c=o.options.animation,u=(a.left+a.right)/2,d=(a.top+a.bottom)/2,f=s&&c.animateScale,m=f?0:this.innerRadius,g=f?0:this.outerRadius,{sharedOptions:y,includeOptions:_}=this._getSharedOptions(i,r);let b=this._getRotation(),w;for(w=0;w<i;++w)b+=this._circumference(w,s);for(w=i;w<i+n;++w){const x=this._circumference(w,s),S=e[w],T={x:u+this.offsetX,y:d+this.offsetY,startAngle:b,endAngle:b+x,circumference:x,outerRadius:g,innerRadius:m};_&&(T.options=y||this.resolveDataElementOptions(w,S.active?"active":r)),b+=x,this.updateElement(S,w,T,r)}}calculateTotal(){const e=this._cachedMeta,i=e.data;let n=0,r;for(r=0;r<i.length;r++){const s=e._parsed[r];s!==null&&!isNaN(s)&&this.chart.getDataVisibility(r)&&!i[r].hidden&&(n+=Math.abs(s))}return n}calculateCircumference(e){const i=this._cachedMeta.total;return i>0&&!isNaN(e)?Hi*(Math.abs(e)/i):0}getLabelAndValue(e){const i=this._cachedMeta,n=this.chart,r=n.data.labels||[],s=AT(i._parsed[e],n.options.locale);return{label:r[e]||"",value:s}}getMaxBorderWidth(e){let i=0;const n=this.chart;let r,s,o,a,l;if(!e){for(r=0,s=n.data.datasets.length;r<s;++r)if(n.isDatasetVisible(r)){o=n.getDatasetMeta(r),e=o.data,a=o.controller;break}}if(!e)return 0;for(r=0,s=e.length;r<s;++r)l=a.resolveDataElementOptions(r),l.borderAlign!=="inner"&&(i=Math.max(i,l.borderWidth||0,l.hoverBorderWidth||0));return i}getMaxOffset(e){let i=0;for(let n=0,r=e.length;n<r;++n){const s=this.resolveDataElementOptions(n);i=Math.max(i,s.offset||0,s.hoverOffset||0)}return i}_getRingWeightOffset(e){let i=0;for(let n=0;n<e;++n)this.chart.isDatasetVisible(n)&&(i+=this._getRingWeight(n));return i}_getRingWeight(e){return Math.max(it(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}ve(dy,"id","doughnut"),ve(dy,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),ve(dy,"descriptors",{_scriptable:e=>e!=="spacing",_indexable:e=>e!=="spacing"&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")}),ve(dy,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const i=e.data;if(i.labels.length&&i.datasets.length){const{labels:{pointStyle:n,color:r}}=e.legend.options;return i.labels.map((s,o)=>{const l=e.getDatasetMeta(0).controller.getStyle(o);return{text:s,fillStyle:l.backgroundColor,strokeStyle:l.borderColor,fontColor:r,lineWidth:l.borderWidth,pointStyle:n,hidden:!e.getDataVisibility(o),index:o}})}return[]}},onClick(e,i,n){n.chart.toggleDataVisibility(i.index),n.chart.update()}}}});class xE extends wc{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const i=this._cachedMeta,{dataset:n,data:r=[],_dataset:s}=i,o=this.chart._animationsDisabled;let{start:a,count:l}=fme(i,r,o);this._drawStart=a,this._drawCount=l,mme(i)&&(a=0,l=r.length),n._chart=this.chart,n._datasetIndex=this.index,n._decimated=!!s._decimated,n.points=r;const c=this.resolveDatasetElementOptions(e);this.options.showLine||(c.borderWidth=0),c.segment=this.options.segment,this.updateElement(n,void 0,{animated:!o,options:c},e),this.updateElements(r,a,l,e)}updateElements(e,i,n,r){const s=r==="reset",{iScale:o,vScale:a,_stacked:l,_dataset:c}=this._cachedMeta,{sharedOptions:u,includeOptions:d}=this._getSharedOptions(i,r),f=o.axis,m=a.axis,{spanGaps:g,segment:y}=this.options,_=Eb(g)?g:Number.POSITIVE_INFINITY,b=this.chart._animationsDisabled||s||r==="none",w=i+n,x=e.length;let S=i>0&&this.getParsed(i-1);for(let T=0;T<x;++T){const I=e[T],C=b?I:{};if(T<i||T>=w){C.skip=!0;continue}const M=this.getParsed(T),E=zt(M[m]),A=C[f]=o.getPixelForValue(M[f],T),$=C[m]=s||E?a.getBasePixel():a.getPixelForValue(l?this.applyStack(a,M,l):M[m],T);C.skip=isNaN(A)||isNaN($)||E,C.stop=T>0&&Math.abs(M[f]-S[f])>_,y&&(C.parsed=M,C.raw=c.data[T]),d&&(C.options=u||this.resolveDataElementOptions(T,I.active?"active":r)),b||this.updateElement(I,T,C,r),S=M}}getMaxOverflow(){const e=this._cachedMeta,i=e.dataset,n=i.options&&i.options.borderWidth||0,r=e.data||[];if(!r.length)return n;const s=r[0].size(this.resolveDataElementOptions(0)),o=r[r.length-1].size(this.resolveDataElementOptions(r.length-1));return Math.max(n,s,o)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}ve(xE,"id","line"),ve(xE,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),ve(xE,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});class b2 extends wc{constructor(e,i){super(e,i),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(e){const i=this._cachedMeta,n=this.chart,r=n.data.labels||[],s=AT(i._parsed[e].r,n.options.locale);return{label:r[e]||"",value:s}}parseObjectData(e,i,n,r){return Sme.bind(this)(e,i,n,r)}update(e){const i=this._cachedMeta.data;this._updateRadius(),this.updateElements(i,0,i.length,e)}getMinMax(){const e=this._cachedMeta,i={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return e.data.forEach((n,r)=>{const s=this.getParsed(r).r;!isNaN(s)&&this.chart.getDataVisibility(r)&&(s<i.min&&(i.min=s),s>i.max&&(i.max=s))}),i}_updateRadius(){const e=this.chart,i=e.chartArea,n=e.options,r=Math.min(i.right-i.left,i.bottom-i.top),s=Math.max(r/2,0),o=Math.max(n.cutoutPercentage?s/100*n.cutoutPercentage:1,0),a=(s-o)/e.getVisibleDatasetCount();this.outerRadius=s-a*this.index,this.innerRadius=this.outerRadius-a}updateElements(e,i,n,r){const s=r==="reset",o=this.chart,l=o.options.animation,c=this._cachedMeta.rScale,u=c.xCenter,d=c.yCenter,f=c.getIndexAngle(0)-.5*ln;let m=f,g;const y=360/this.countVisibleElements();for(g=0;g<i;++g)m+=this._computeAngle(g,r,y);for(g=i;g<i+n;g++){const _=e[g];let b=m,w=m+this._computeAngle(g,r,y),x=o.getDataVisibility(g)?c.getDistanceFromCenterForValue(this.getParsed(g).r):0;m=w,s&&(l.animateScale&&(x=0),l.animateRotate&&(b=w=f));const S={x:u,y:d,innerRadius:0,outerRadius:x,startAngle:b,endAngle:w,options:this.resolveDataElementOptions(g,_.active?"active":r)};this.updateElement(_,g,S,r)}}countVisibleElements(){const e=this._cachedMeta;let i=0;return e.data.forEach((n,r)=>{!isNaN(this.getParsed(r).r)&&this.chart.getDataVisibility(r)&&i++}),i}_computeAngle(e,i,n){return this.chart.getDataVisibility(e)?mc(this.resolveDataElementOptions(e,i).angle||n):0}}ve(b2,"id","polarArea"),ve(b2,"defaults",{dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0}),ve(b2,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const i=e.data;if(i.labels.length&&i.datasets.length){const{labels:{pointStyle:n,color:r}}=e.legend.options;return i.labels.map((s,o)=>{const l=e.getDatasetMeta(0).controller.getStyle(o);return{text:s,fillStyle:l.backgroundColor,strokeStyle:l.borderColor,fontColor:r,lineWidth:l.borderWidth,pointStyle:n,hidden:!e.getDataVisibility(o),index:o}})}return[]}},onClick(e,i,n){n.chart.toggleDataVisibility(i.index),n.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}});class gz extends dy{}ve(gz,"id","pie"),ve(gz,"defaults",{cutout:0,rotation:0,circumference:360,radius:"100%"});class SE extends wc{getLabelAndValue(e){const i=this._cachedMeta.vScale,n=this.getParsed(e);return{label:i.getLabels()[e],value:""+i.getLabelForValue(n[i.axis])}}parseObjectData(e,i,n,r){return Sme.bind(this)(e,i,n,r)}update(e){const i=this._cachedMeta,n=i.dataset,r=i.data||[],s=i.iScale.getLabels();if(n.points=r,e!=="resize"){const o=this.resolveDatasetElementOptions(e);this.options.showLine||(o.borderWidth=0);const a={_loop:!0,_fullLoop:s.length===r.length,options:o};this.updateElement(n,void 0,a,e)}this.updateElements(r,0,r.length,e)}updateElements(e,i,n,r){const s=this._cachedMeta.rScale,o=r==="reset";for(let a=i;a<i+n;a++){const l=e[a],c=this.resolveDataElementOptions(a,l.active?"active":r),u=s.getPointPositionForValue(a,this.getParsed(a).r),d=o?s.xCenter:u.x,f=o?s.yCenter:u.y,m={x:d,y:f,angle:u.angle,skip:isNaN(d)||isNaN(f),options:c};this.updateElement(l,a,m,r)}}}ve(SE,"id","radar"),ve(SE,"defaults",{datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}}),ve(SE,"overrides",{aspectRatio:1,scales:{r:{type:"radialLinear"}}});class TE extends wc{getLabelAndValue(e){const i=this._cachedMeta,n=this.chart.data.labels||[],{xScale:r,yScale:s}=i,o=this.getParsed(e),a=r.getLabelForValue(o.x),l=s.getLabelForValue(o.y);return{label:n[e]||"",value:"("+a+", "+l+")"}}update(e){const i=this._cachedMeta,{data:n=[]}=i,r=this.chart._animationsDisabled;let{start:s,count:o}=fme(i,n,r);if(this._drawStart=s,this._drawCount=o,mme(i)&&(s=0,o=n.length),this.options.showLine){const{dataset:a,_dataset:l}=i;a._chart=this.chart,a._datasetIndex=this.index,a._decimated=!!l._decimated,a.points=n;const c=this.resolveDatasetElementOptions(e);c.segment=this.options.segment,this.updateElement(a,void 0,{animated:!r,options:c},e)}this.updateElements(n,s,o,e)}addElements(){const{showLine:e}=this.options;!this.datasetElementType&&e&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(e,i,n,r){const s=r==="reset",{iScale:o,vScale:a,_stacked:l,_dataset:c}=this._cachedMeta,u=this.resolveDataElementOptions(i,r),d=this.getSharedOptions(u),f=this.includeOptions(r,d),m=o.axis,g=a.axis,{spanGaps:y,segment:_}=this.options,b=Eb(y)?y:Number.POSITIVE_INFINITY,w=this.chart._animationsDisabled||s||r==="none";let x=i>0&&this.getParsed(i-1);for(let S=i;S<i+n;++S){const T=e[S],I=this.getParsed(S),C=w?T:{},M=zt(I[g]),E=C[m]=o.getPixelForValue(I[m],S),A=C[g]=s||M?a.getBasePixel():a.getPixelForValue(l?this.applyStack(a,I,l):I[g],S);C.skip=isNaN(E)||isNaN(A)||M,C.stop=S>0&&Math.abs(I[m]-x[m])>b,_&&(C.parsed=I,C.raw=c.data[S]),f&&(C.options=d||this.resolveDataElementOptions(S,T.active?"active":r)),w||this.updateElement(T,S,C,r),x=I}this.updateSharedOptions(d,r,u)}getMaxOverflow(){const e=this._cachedMeta,i=e.data||[];if(!this.options.showLine){let a=0;for(let l=i.length-1;l>=0;--l)a=Math.max(a,i[l].size(this.resolveDataElementOptions(l))/2);return a>0&&a}const n=e.dataset,r=n.options&&n.options.borderWidth||0;if(!i.length)return r;const s=i[0].size(this.resolveDataElementOptions(0)),o=i[i.length-1].size(this.resolveDataElementOptions(i.length-1));return Math.max(r,s,o)/2}}ve(TE,"id","scatter"),ve(TE,"defaults",{datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1}),ve(TE,"overrides",{interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}});var Ktt=Object.freeze({__proto__:null,BarController:bE,BubbleController:wE,DoughnutController:dy,LineController:xE,PieController:gz,PolarAreaController:b2,RadarController:SE,ScatterController:TE});function Am(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class kB{constructor(e){ve(this,"options");this.options=e||{}}static override(e){Object.assign(kB.prototype,e)}init(){}formats(){return Am()}parse(){return Am()}format(){return Am()}add(){return Am()}diff(){return Am()}startOf(){return Am()}endOf(){return Am()}}var Qtt={_date:kB};function eit(t,e,i,n){const{controller:r,data:s,_sorted:o}=t,a=r._cachedMeta.iScale;if(a&&e===a.axis&&e!=="r"&&o&&s.length){const l=a._reversePixels?xet:jh;if(n){if(r._sharedOptions){const c=s[0],u=typeof c.getRange=="function"&&c.getRange(e);if(u){const d=l(s,e,i-u),f=l(s,e,i+u);return{lo:d.lo,hi:f.hi}}}}else return l(s,e,i)}return{lo:0,hi:s.length-1}}function $T(t,e,i,n,r){const s=t.getSortedVisibleDatasetMetas(),o=i[e];for(let a=0,l=s.length;a<l;++a){const{index:c,data:u}=s[a],{lo:d,hi:f}=eit(s[a],e,o,r);for(let m=d;m<=f;++m){const g=u[m];g.skip||n(g,c,m)}}}function tit(t){const e=t.indexOf("x")!==-1,i=t.indexOf("y")!==-1;return function(n,r){const s=e?Math.abs(n.x-r.x):0,o=i?Math.abs(n.y-r.y):0;return Math.sqrt(Math.pow(s,2)+Math.pow(o,2))}}function zL(t,e,i,n,r){const s=[];return!r&&!t.isPointInArea(e)||$T(t,i,e,function(a,l,c){!r&&!Bh(a,t.chartArea,0)||a.inRange(e.x,e.y,n)&&s.push({element:a,datasetIndex:l,index:c})},!0),s}function iit(t,e,i,n){let r=[];function s(o,a,l){const{startAngle:c,endAngle:u}=o.getProps(["startAngle","endAngle"],n),{angle:d}=cme(o,{x:e.x,y:e.y});xS(d,c,u)&&r.push({element:o,datasetIndex:a,index:l})}return $T(t,i,e,s),r}function nit(t,e,i,n,r,s){let o=[];const a=tit(i);let l=Number.POSITIVE_INFINITY;function c(u,d,f){const m=u.inRange(e.x,e.y,r);if(n&&!m)return;const g=u.getCenterPoint(r);if(!(!!s||t.isPointInArea(g))&&!m)return;const _=a(e,g);_<l?(o=[{element:u,datasetIndex:d,index:f}],l=_):_===l&&o.push({element:u,datasetIndex:d,index:f})}return $T(t,i,e,c),o}function VL(t,e,i,n,r,s){return!s&&!t.isPointInArea(e)?[]:i==="r"&&!n?iit(t,e,i,r):nit(t,e,i,n,r,s)}function VY(t,e,i,n,r){const s=[],o=i==="x"?"inXRange":"inYRange";let a=!1;return $T(t,i,e,(l,c,u)=>{l[o](e[i],r)&&(s.push({element:l,datasetIndex:c,index:u}),a=a||l.inRange(e.x,e.y,r))}),n&&!a?[]:s}var rit={evaluateInteractionItems:$T,modes:{index(t,e,i,n){const r=mu(e,t),s=i.axis||"x",o=i.includeInvisible||!1,a=i.intersect?zL(t,r,s,n,o):VL(t,r,s,!1,n,o),l=[];return a.length?(t.getSortedVisibleDatasetMetas().forEach(c=>{const u=a[0].index,d=c.data[u];d&&!d.skip&&l.push({element:d,datasetIndex:c.index,index:u})}),l):[]},dataset(t,e,i,n){const r=mu(e,t),s=i.axis||"xy",o=i.includeInvisible||!1;let a=i.intersect?zL(t,r,s,n,o):VL(t,r,s,!1,n,o);if(a.length>0){const l=a[0].datasetIndex,c=t.getDatasetMeta(l).data;a=[];for(let u=0;u<c.length;++u)a.push({element:c[u],datasetIndex:l,index:u})}return a},point(t,e,i,n){const r=mu(e,t),s=i.axis||"xy",o=i.includeInvisible||!1;return zL(t,r,s,n,o)},nearest(t,e,i,n){const r=mu(e,t),s=i.axis||"xy",o=i.includeInvisible||!1;return VL(t,r,s,i.intersect,n,o)},x(t,e,i,n){const r=mu(e,t);return VY(t,r,"x",i.intersect,n)},y(t,e,i,n){const r=mu(e,t);return VY(t,r,"y",i.intersect,n)}}};const Lme=["left","top","right","bottom"];function nw(t,e){return t.filter(i=>i.pos===e)}function jY(t,e){return t.filter(i=>Lme.indexOf(i.pos)===-1&&i.box.axis===e)}function rw(t,e){return t.sort((i,n)=>{const r=e?n:i,s=e?i:n;return r.weight===s.weight?r.index-s.index:r.weight-s.weight})}function sit(t){const e=[];let i,n,r,s,o,a;for(i=0,n=(t||[]).length;i<n;++i)r=t[i],{position:s,options:{stack:o,stackWeight:a=1}}=r,e.push({index:i,box:r,pos:s,horizontal:r.isHorizontal(),weight:r.weight,stack:o&&s+o,stackWeight:a});return e}function oit(t){const e={};for(const i of t){const{stack:n,pos:r,stackWeight:s}=i;if(!n||!Lme.includes(r))continue;const o=e[n]||(e[n]={count:0,placed:0,weight:0,size:0});o.count++,o.weight+=s}return e}function ait(t,e){const i=oit(t),{vBoxMaxWidth:n,hBoxMaxHeight:r}=e;let s,o,a;for(s=0,o=t.length;s<o;++s){a=t[s];const{fullSize:l}=a.box,c=i[a.stack],u=c&&a.stackWeight/c.weight;a.horizontal?(a.width=u?u*n:l&&e.availableWidth,a.height=r):(a.width=n,a.height=u?u*r:l&&e.availableHeight)}return i}function lit(t){const e=sit(t),i=rw(e.filter(c=>c.box.fullSize),!0),n=rw(nw(e,"left"),!0),r=rw(nw(e,"right")),s=rw(nw(e,"top"),!0),o=rw(nw(e,"bottom")),a=jY(e,"x"),l=jY(e,"y");return{fullSize:i,leftAndTop:n.concat(s),rightAndBottom:r.concat(l).concat(o).concat(a),chartArea:nw(e,"chartArea"),vertical:n.concat(r).concat(l),horizontal:s.concat(o).concat(a)}}function BY(t,e,i,n){return Math.max(t[i],e[i])+Math.max(t[n],e[n])}function Rme(t,e){t.top=Math.max(t.top,e.top),t.left=Math.max(t.left,e.left),t.bottom=Math.max(t.bottom,e.bottom),t.right=Math.max(t.right,e.right)}function cit(t,e,i,n){const{pos:r,box:s}=i,o=t.maxPadding;if(!Et(r)){i.size&&(t[r]-=i.size);const d=n[i.stack]||{size:0,count:1};d.size=Math.max(d.size,i.horizontal?s.height:s.width),i.size=d.size/d.count,t[r]+=i.size}s.getPadding&&Rme(o,s.getPadding());const a=Math.max(0,e.outerWidth-BY(o,t,"left","right")),l=Math.max(0,e.outerHeight-BY(o,t,"top","bottom")),c=a!==t.w,u=l!==t.h;return t.w=a,t.h=l,i.horizontal?{same:c,other:u}:{same:u,other:c}}function uit(t){const e=t.maxPadding;function i(n){const r=Math.max(e[n]-t[n],0);return t[n]+=r,r}t.y+=i("top"),t.x+=i("left"),i("right"),i("bottom")}function hit(t,e){const i=e.maxPadding;function n(r){const s={left:0,top:0,right:0,bottom:0};return r.forEach(o=>{s[o]=Math.max(e[o],i[o])}),s}return n(t?["left","right"]:["top","bottom"])}function Sx(t,e,i,n){const r=[];let s,o,a,l,c,u;for(s=0,o=t.length,c=0;s<o;++s){a=t[s],l=a.box,l.update(a.width||e.w,a.height||e.h,hit(a.horizontal,e));const{same:d,other:f}=cit(e,i,a,n);c|=d&&r.length,u=u||f,l.fullSize||r.push(a)}return c&&Sx(r,e,i,n)||u}function kC(t,e,i,n,r){t.top=i,t.left=e,t.right=e+n,t.bottom=i+r,t.width=n,t.height=r}function UY(t,e,i,n){const r=i.padding;let{x:s,y:o}=e;for(const a of t){const l=a.box,c=n[a.stack]||{count:1,placed:0,weight:1},u=a.stackWeight/c.weight||1;if(a.horizontal){const d=e.w*u,f=c.size||l.height;wS(c.start)&&(o=c.start),l.fullSize?kC(l,r.left,o,i.outerWidth-r.right-r.left,f):kC(l,e.left+c.placed,o,d,f),c.start=o,c.placed+=d,o=l.bottom}else{const d=e.h*u,f=c.size||l.width;wS(c.start)&&(s=c.start),l.fullSize?kC(l,s,r.top,f,i.outerHeight-r.bottom-r.top):kC(l,s,e.top+c.placed,f,d),c.start=s,c.placed+=d,s=l.right}}e.x=s,e.y=o}var Ps={addBox(t,e){t.boxes||(t.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(i){e.draw(i)}}]},t.boxes.push(e)},removeBox(t,e){const i=t.boxes?t.boxes.indexOf(e):-1;i!==-1&&t.boxes.splice(i,1)},configure(t,e,i){e.fullSize=i.fullSize,e.position=i.position,e.weight=i.weight},update(t,e,i,n){if(!t)return;const r=Fs(t.options.layout.padding),s=Math.max(e-r.width,0),o=Math.max(i-r.height,0),a=lit(t.boxes),l=a.vertical,c=a.horizontal;St(t.boxes,y=>{typeof y.beforeLayout=="function"&&y.beforeLayout()});const u=l.reduce((y,_)=>_.box.options&&_.box.options.display===!1?y:y+1,0)||1,d=Object.freeze({outerWidth:e,outerHeight:i,padding:r,availableWidth:s,availableHeight:o,vBoxMaxWidth:s/2/u,hBoxMaxHeight:o/2}),f=Object.assign({},r);Rme(f,Fs(n));const m=Object.assign({maxPadding:f,w:s,h:o,x:r.left,y:r.top},r),g=ait(l.concat(c),d);Sx(a.fullSize,m,d,g),Sx(l,m,d,g),Sx(c,m,d,g)&&Sx(l,m,d,g),uit(m),UY(a.leftAndTop,m,d,g),m.x+=m.w,m.y+=m.h,UY(a.rightAndBottom,m,d,g),t.chartArea={left:m.left,top:m.top,right:m.left+m.w,bottom:m.top+m.h,height:m.h,width:m.w},St(a.chartArea,y=>{const _=y.box;Object.assign(_,t.chartArea),_.update(m.w,m.h,{left:0,top:0,right:0,bottom:0})})}};class Dme{acquireContext(e,i){}releaseContext(e){return!1}addEventListener(e,i,n){}removeEventListener(e,i,n){}getDevicePixelRatio(){return 1}getMaximumSize(e,i,n,r){return i=Math.max(0,i||e.width),n=n||e.height,{width:i,height:Math.max(0,r?Math.floor(i/r):n)}}isAttached(e){return!0}updateConfig(e){}}class dit extends Dme{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const IE="$chartjs",pit={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},GY=t=>t===null||t==="";function fit(t,e){const i=t.style,n=t.getAttribute("height"),r=t.getAttribute("width");if(t[IE]={initial:{height:n,width:r,style:{display:i.display,height:i.height,width:i.width}}},i.display=i.display||"block",i.boxSizing=i.boxSizing||"border-box",GY(r)){const s=CY(t,"width");s!==void 0&&(t.width=s)}if(GY(n))if(t.style.height==="")t.height=t.width/(e||2);else{const s=CY(t,"height");s!==void 0&&(t.height=s)}return t}const Nme=gtt?{passive:!0}:!1;function mit(t,e,i){t.addEventListener(e,i,Nme)}function git(t,e,i){t.canvas.removeEventListener(e,i,Nme)}function yit(t,e){const i=pit[t.type]||t.type,{x:n,y:r}=mu(t,e);return{type:i,chart:e,native:t,x:n!==void 0?n:null,y:r!==void 0?r:null}}function V$(t,e){for(const i of t)if(i===e||i.contains(e))return!0}function vit(t,e,i){const n=t.canvas,r=new MutationObserver(s=>{let o=!1;for(const a of s)o=o||V$(a.addedNodes,n),o=o&&!V$(a.removedNodes,n);o&&i()});return r.observe(document,{childList:!0,subtree:!0}),r}function _it(t,e,i){const n=t.canvas,r=new MutationObserver(s=>{let o=!1;for(const a of s)o=o||V$(a.removedNodes,n),o=o&&!V$(a.addedNodes,n);o&&i()});return r.observe(document,{childList:!0,subtree:!0}),r}const TS=new Map;let HY=0;function Fme(){const t=window.devicePixelRatio;t!==HY&&(HY=t,TS.forEach((e,i)=>{i.currentDevicePixelRatio!==t&&e()}))}function bit(t,e){TS.size||window.addEventListener("resize",Fme),TS.set(t,e)}function wit(t){TS.delete(t),TS.size||window.removeEventListener("resize",Fme)}function xit(t,e,i){const n=t.canvas,r=n&&PB(n);if(!r)return;const s=pme((a,l)=>{const c=r.clientWidth;i(a,l),c<r.clientWidth&&i()},window),o=new ResizeObserver(a=>{const l=a[0],c=l.contentRect.width,u=l.contentRect.height;c===0&&u===0||s(c,u)});return o.observe(r),bit(t,s),o}function jL(t,e,i){i&&i.disconnect(),e==="resize"&&wit(t)}function Sit(t,e,i){const n=t.canvas,r=pme(s=>{t.ctx!==null&&i(yit(s,t))},t);return mit(n,e,r),r}class Tit extends Dme{acquireContext(e,i){const n=e&&e.getContext&&e.getContext("2d");return n&&n.canvas===e?(fit(e,i),n):null}releaseContext(e){const i=e.canvas;if(!i[IE])return!1;const n=i[IE].initial;["height","width"].forEach(s=>{const o=n[s];zt(o)?i.removeAttribute(s):i.setAttribute(s,o)});const r=n.style||{};return Object.keys(r).forEach(s=>{i.style[s]=r[s]}),i.width=i.width,delete i[IE],!0}addEventListener(e,i,n){this.removeEventListener(e,i);const r=e.$proxies||(e.$proxies={}),o={attach:vit,detach:_it,resize:xit}[i]||Sit;r[i]=o(e,i,n)}removeEventListener(e,i){const n=e.$proxies||(e.$proxies={}),r=n[i];if(!r)return;({attach:jL,detach:jL,resize:jL}[i]||git)(e,i,r),n[i]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,i,n,r){return mtt(e,i,n,r)}isAttached(e){const i=PB(e);return!!(i&&i.isConnected)}}function Iit(t){return!Ime()||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas?dit:Tit}var VC;let wd=(VC=class{constructor(){ve(this,"x");ve(this,"y");ve(this,"active",!1);ve(this,"options");ve(this,"$animations")}tooltipPosition(e){const{x:i,y:n}=this.getProps(["x","y"],e);return{x:i,y:n}}hasValue(){return Eb(this.x)&&Eb(this.y)}getProps(e,i){const n=this.$animations;if(!i||!n)return this;const r={};return e.forEach(s=>{r[s]=n[s]&&n[s].active()?n[s]._to:this[s]}),r}},ve(VC,"defaults",{}),ve(VC,"defaultRoutes"),VC);function Cit(t,e){const i=t.options.ticks,n=Mit(t),r=Math.min(i.maxTicksLimit||n,n),s=i.major.enabled?Ait(e):[],o=s.length,a=s[0],l=s[o-1],c=[];if(o>r)return $it(e,c,s,o/r),c;const u=Eit(s,e,r);if(o>0){let d,f;const m=o>1?Math.round((l-a)/(o-1)):null;for(OC(e,c,u,zt(m)?0:a-m,a),d=0,f=o-1;d<f;d++)OC(e,c,u,s[d],s[d+1]);return OC(e,c,u,l,zt(m)?e.length:l+m),c}return OC(e,c,u),c}function Mit(t){const e=t.options.offset,i=t._tickSize(),n=t._length/i+(e?0:1),r=t._maxLength/i;return Math.floor(Math.min(n,r))}function Eit(t,e,i){const n=Pit(t),r=e.length/i;if(!n)return Math.max(r,1);const s=vet(n);for(let o=0,a=s.length-1;o<a;o++){const l=s[o];if(l>r)return l}return Math.max(r,1)}function Ait(t){const e=[];let i,n;for(i=0,n=t.length;i<n;i++)t[i].major&&e.push(i);return e}function $it(t,e,i,n){let r=0,s=i[0],o;for(n=Math.ceil(n),o=0;o<t.length;o++)o===s&&(e.push(t[o]),r++,s=i[r*n])}function OC(t,e,i,n,r){const s=it(n,0),o=Math.min(it(r,t.length),t.length);let a=0,l,c,u;for(i=Math.ceil(i),r&&(l=r-n,i=l/Math.floor(l/i)),u=s;u<0;)a++,u=Math.round(s+a*i);for(c=Math.max(s,0);c<o;c++)c===u&&(e.push(t[c]),a++,u=Math.round(s+a*i))}function Pit(t){const e=t.length;let i,n;if(e<2)return!1;for(n=t[0],i=1;i<e;++i)if(t[i]-t[i-1]!==n)return!1;return n}const kit=t=>t==="left"?"right":t==="right"?"left":t,qY=(t,e,i)=>e==="top"||e==="left"?t[e]+i:t[e]-i,WY=(t,e)=>Math.min(e||t,t);function JY(t,e){const i=[],n=t.length/e,r=t.length;let s=0;for(;s<r;s+=n)i.push(t[Math.floor(s)]);return i}function Oit(t,e,i){const n=t.ticks.length,r=Math.min(e,n-1),s=t._startPixel,o=t._endPixel,a=1e-6;let l=t.getPixelForTick(r),c;if(!(i&&(n===1?c=Math.max(l-s,o-l):e===0?c=(t.getPixelForTick(1)-l)/2:c=(l-t.getPixelForTick(r-1))/2,l+=r<e?c:-c,l<s-a||l>o+a)))return l}function Lit(t,e){St(t,i=>{const n=i.gc,r=n.length/2;let s;if(r>e){for(s=0;s<r;++s)delete i.data[n[s]];n.splice(0,r)}})}function sw(t){return t.drawTicks?t.tickLength:0}function ZY(t,e){if(!t.display)return 0;const i=wr(t.font,e),n=Fs(t.padding);return(Ui(t.text)?t.text.length:1)*i.lineHeight+n.height}function Rit(t,e){return rm(t,{scale:e,type:"scale"})}function Dit(t,e,i){return rm(t,{tick:i,index:e,type:"tick"})}function Nit(t,e,i){let n=IB(t);return(i&&e!=="right"||!i&&e==="right")&&(n=kit(n)),n}function Fit(t,e,i,n){const{top:r,left:s,bottom:o,right:a,chart:l}=t,{chartArea:c,scales:u}=l;let d=0,f,m,g;const y=o-r,_=a-s;if(t.isHorizontal()){if(m=Ss(n,s,a),Et(i)){const b=Object.keys(i)[0],w=i[b];g=u[b].getPixelForValue(w)+y-e}else i==="center"?g=(c.bottom+c.top)/2+y-e:g=qY(t,i,e);f=a-s}else{if(Et(i)){const b=Object.keys(i)[0],w=i[b];m=u[b].getPixelForValue(w)-_+e}else i==="center"?m=(c.left+c.right)/2-_+e:m=qY(t,i,e);g=Ss(n,o,r),d=i==="left"?-Cn:Cn}return{titleX:m,titleY:g,maxWidth:f,rotation:d}}class y0 extends wd{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,i){return e}getUserBounds(){let{_userMin:e,_userMax:i,_suggestedMin:n,_suggestedMax:r}=this;return e=ca(e,Number.POSITIVE_INFINITY),i=ca(i,Number.NEGATIVE_INFINITY),n=ca(n,Number.POSITIVE_INFINITY),r=ca(r,Number.NEGATIVE_INFINITY),{min:ca(e,n),max:ca(i,r),minDefined:In(e),maxDefined:In(i)}}getMinMax(e){let{min:i,max:n,minDefined:r,maxDefined:s}=this.getUserBounds(),o;if(r&&s)return{min:i,max:n};const a=this.getMatchingVisibleMetas();for(let l=0,c=a.length;l<c;++l)o=a[l].controller.getMinMax(this,e),r||(i=Math.min(i,o.min)),s||(n=Math.max(n,o.max));return i=s&&i>n?n:i,n=r&&i>n?i:n,{min:ca(i,ca(n,i)),max:ca(n,ca(i,n))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){nt(this.options.beforeUpdate,[this])}update(e,i,n){const{beginAtZero:r,grace:s,ticks:o}=this.options,a=o.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=i,this._margins=n=Object.assign({left:0,right:0,top:0,bottom:0},n),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+n.left+n.right:this.height+n.top+n.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=Wet(this,s,r),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const l=a<this.ticks.length;this._convertTicksToLabels(l?JY(this.ticks,a):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||o.source==="auto")&&(this.ticks=Cit(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),l&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,i,n;this.isHorizontal()?(i=this.left,n=this.right):(i=this.top,n=this.bottom,e=!e),this._startPixel=i,this._endPixel=n,this._reversePixels=e,this._length=n-i,this._alignToPixels=this.options.alignToPixels}afterUpdate(){nt(this.options.afterUpdate,[this])}beforeSetDimensions(){nt(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){nt(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),nt(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){nt(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const i=this.options.ticks;let n,r,s;for(n=0,r=e.length;n<r;n++)s=e[n],s.label=nt(i.callback,[s.value,n,e],this)}afterTickToLabelConversion(){nt(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){nt(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,i=e.ticks,n=WY(this.ticks.length,e.ticks.maxTicksLimit),r=i.minRotation||0,s=i.maxRotation;let o=r,a,l,c;if(!this._isVisible()||!i.display||r>=s||n<=1||!this.isHorizontal()){this.labelRotation=r;return}const u=this._getLabelSizes(),d=u.widest.width,f=u.highest.height,m=zr(this.chart.width-d,0,this.maxWidth);a=e.offset?this.maxWidth/n:m/(n-1),d+6>a&&(a=m/(n-(e.offset?.5:1)),l=this.maxHeight-sw(e.grid)-i.padding-ZY(e.title,this.chart.options.font),c=Math.sqrt(d*d+f*f),o=SB(Math.min(Math.asin(zr((u.highest.height+6)/a,-1,1)),Math.asin(zr(l/c,-1,1))-Math.asin(zr(f/c,-1,1)))),o=Math.max(r,Math.min(s,o))),this.labelRotation=o}afterCalculateLabelRotation(){nt(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){nt(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:i,options:{ticks:n,title:r,grid:s}}=this,o=this._isVisible(),a=this.isHorizontal();if(o){const l=ZY(r,i.options.font);if(a?(e.width=this.maxWidth,e.height=sw(s)+l):(e.height=this.maxHeight,e.width=sw(s)+l),n.display&&this.ticks.length){const{first:c,last:u,widest:d,highest:f}=this._getLabelSizes(),m=n.padding*2,g=mc(this.labelRotation),y=Math.cos(g),_=Math.sin(g);if(a){const b=n.mirror?0:_*d.width+y*f.height;e.height=Math.min(this.maxHeight,e.height+b+m)}else{const b=n.mirror?0:y*d.width+_*f.height;e.width=Math.min(this.maxWidth,e.width+b+m)}this._calculatePadding(c,u,_,y)}}this._handleMargins(),a?(this.width=this._length=i.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=i.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,i,n,r){const{ticks:{align:s,padding:o},position:a}=this.options,l=this.labelRotation!==0,c=a!=="top"&&this.axis==="x";if(this.isHorizontal()){const u=this.getPixelForTick(0)-this.left,d=this.right-this.getPixelForTick(this.ticks.length-1);let f=0,m=0;l?c?(f=r*e.width,m=n*i.height):(f=n*e.height,m=r*i.width):s==="start"?m=i.width:s==="end"?f=e.width:s!=="inner"&&(f=e.width/2,m=i.width/2),this.paddingLeft=Math.max((f-u+o)*this.width/(this.width-u),0),this.paddingRight=Math.max((m-d+o)*this.width/(this.width-d),0)}else{let u=i.height/2,d=e.height/2;s==="start"?(u=0,d=e.height):s==="end"&&(u=i.height,d=0),this.paddingTop=u+o,this.paddingBottom=d+o}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){nt(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:i}=this.options;return i==="top"||i==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let i,n;for(i=0,n=e.length;i<n;i++)zt(e[i].label)&&(e.splice(i,1),n--,i--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const i=this.options.ticks.sampleSize;let n=this.ticks;i<n.length&&(n=JY(n,i)),this._labelSizes=e=this._computeLabelSizes(n,n.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,i,n){const{ctx:r,_longestTextCache:s}=this,o=[],a=[],l=Math.floor(i/WY(i,n));let c=0,u=0,d,f,m,g,y,_,b,w,x,S,T;for(d=0;d<i;d+=l){if(g=e[d].label,y=this._resolveTickFontOptions(d),r.font=_=y.string,b=s[_]=s[_]||{data:{},gc:[]},w=y.lineHeight,x=S=0,!zt(g)&&!Ui(g))x=F$(r,b.data,b.gc,x,g),S=w;else if(Ui(g))for(f=0,m=g.length;f<m;++f)T=g[f],!zt(T)&&!Ui(T)&&(x=F$(r,b.data,b.gc,x,T),S+=w);o.push(x),a.push(S),c=Math.max(x,c),u=Math.max(S,u)}Lit(s,i);const I=o.indexOf(c),C=a.indexOf(u),M=E=>({width:o[E]||0,height:a[E]||0});return{first:M(0),last:M(i-1),widest:M(I),highest:M(C),widths:o,heights:a}}getLabelForValue(e){return e}getPixelForValue(e,i){return NaN}getValueForPixel(e){}getPixelForTick(e){const i=this.ticks;return e<0||e>i.length-1?null:this.getPixelForValue(i[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const i=this._startPixel+e*this._length;return wet(this._alignToPixels?Em(this.chart,i,0):i)}getDecimalForPixel(e){const i=(e-this._startPixel)/this._length;return this._reversePixels?1-i:i}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:i}=this;return e<0&&i<0?i:e>0&&i>0?e:0}getContext(e){const i=this.ticks||[];if(e>=0&&e<i.length){const n=i[e];return n.$context||(n.$context=Dit(this.getContext(),e,n))}return this.$context||(this.$context=Rit(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,i=mc(this.labelRotation),n=Math.abs(Math.cos(i)),r=Math.abs(Math.sin(i)),s=this._getLabelSizes(),o=e.autoSkipPadding||0,a=s?s.widest.width+o:0,l=s?s.highest.height+o:0;return this.isHorizontal()?l*n>a*r?a/n:l/r:l*r<a*n?l/n:a/r}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const i=this.axis,n=this.chart,r=this.options,{grid:s,position:o,border:a}=r,l=s.offset,c=this.isHorizontal(),d=this.ticks.length+(l?1:0),f=sw(s),m=[],g=a.setContext(this.getContext()),y=g.display?g.width:0,_=y/2,b=function(U){return Em(n,U,y)};let w,x,S,T,I,C,M,E,A,$,L,D;if(o==="top")w=b(this.bottom),C=this.bottom-f,E=w-_,$=b(e.top)+_,D=e.bottom;else if(o==="bottom")w=b(this.top),$=e.top,D=b(e.bottom)-_,C=w+_,E=this.top+f;else if(o==="left")w=b(this.right),I=this.right-f,M=w-_,A=b(e.left)+_,L=e.right;else if(o==="right")w=b(this.left),A=e.left,L=b(e.right)-_,I=w+_,M=this.left+f;else if(i==="x"){if(o==="center")w=b((e.top+e.bottom)/2+.5);else if(Et(o)){const U=Object.keys(o)[0],G=o[U];w=b(this.chart.scales[U].getPixelForValue(G))}$=e.top,D=e.bottom,C=w+_,E=C+f}else if(i==="y"){if(o==="center")w=b((e.left+e.right)/2);else if(Et(o)){const U=Object.keys(o)[0],G=o[U];w=b(this.chart.scales[U].getPixelForValue(G))}I=w-_,M=I-f,A=e.left,L=e.right}const F=it(r.ticks.maxTicksLimit,d),z=Math.max(1,Math.ceil(d/F));for(x=0;x<d;x+=z){const U=this.getContext(x),G=s.setContext(U),W=a.setContext(U),Z=G.lineWidth,X=G.color,oe=W.dash||[],se=W.dashOffset,le=G.tickWidth,de=G.tickColor,we=G.tickBorderDash||[],Re=G.tickBorderDashOffset;S=Oit(this,x,l),S!==void 0&&(T=Em(n,S,Z),c?I=M=A=L=T:C=E=$=D=T,m.push({tx1:I,ty1:C,tx2:M,ty2:E,x1:A,y1:$,x2:L,y2:D,width:Z,color:X,borderDash:oe,borderDashOffset:se,tickWidth:le,tickColor:de,tickBorderDash:we,tickBorderDashOffset:Re}))}return this._ticksLength=d,this._borderValue=w,m}_computeLabelItems(e){const i=this.axis,n=this.options,{position:r,ticks:s}=n,o=this.isHorizontal(),a=this.ticks,{align:l,crossAlign:c,padding:u,mirror:d}=s,f=sw(n.grid),m=f+u,g=d?-u:m,y=-mc(this.labelRotation),_=[];let b,w,x,S,T,I,C,M,E,A,$,L,D="middle";if(r==="top")I=this.bottom-g,C=this._getXAxisLabelAlignment();else if(r==="bottom")I=this.top+g,C=this._getXAxisLabelAlignment();else if(r==="left"){const z=this._getYAxisLabelAlignment(f);C=z.textAlign,T=z.x}else if(r==="right"){const z=this._getYAxisLabelAlignment(f);C=z.textAlign,T=z.x}else if(i==="x"){if(r==="center")I=(e.top+e.bottom)/2+m;else if(Et(r)){const z=Object.keys(r)[0],U=r[z];I=this.chart.scales[z].getPixelForValue(U)+m}C=this._getXAxisLabelAlignment()}else if(i==="y"){if(r==="center")T=(e.left+e.right)/2-m;else if(Et(r)){const z=Object.keys(r)[0],U=r[z];T=this.chart.scales[z].getPixelForValue(U)}C=this._getYAxisLabelAlignment(f).textAlign}i==="y"&&(l==="start"?D="top":l==="end"&&(D="bottom"));const F=this._getLabelSizes();for(b=0,w=a.length;b<w;++b){x=a[b],S=x.label;const z=s.setContext(this.getContext(b));M=this.getPixelForTick(b)+s.labelOffset,E=this._resolveTickFontOptions(b),A=E.lineHeight,$=Ui(S)?S.length:1;const U=$/2,G=z.color,W=z.textStrokeColor,Z=z.textStrokeWidth;let X=C;o?(T=M,C==="inner"&&(b===w-1?X=this.options.reverse?"left":"right":b===0?X=this.options.reverse?"right":"left":X="center"),r==="top"?c==="near"||y!==0?L=-$*A+A/2:c==="center"?L=-F.highest.height/2-U*A+A:L=-F.highest.height+A/2:c==="near"||y!==0?L=A/2:c==="center"?L=F.highest.height/2-U*A:L=F.highest.height-$*A,d&&(L*=-1),y!==0&&!z.showLabelBackdrop&&(T+=A/2*Math.sin(y))):(I=M,L=(1-$)*A/2);let oe;if(z.showLabelBackdrop){const se=Fs(z.backdropPadding),le=F.heights[b],de=F.widths[b];let we=L-se.top,Re=0-se.left;switch(D){case"middle":we-=le/2;break;case"bottom":we-=le;break}switch(C){case"center":Re-=de/2;break;case"right":Re-=de;break}oe={left:Re,top:we,width:de+se.width,height:le+se.height,color:z.backdropColor}}_.push({label:S,font:E,textOffset:L,options:{rotation:y,color:G,strokeColor:W,strokeWidth:Z,textAlign:X,textBaseline:D,translation:[T,I],backdrop:oe}})}return _}_getXAxisLabelAlignment(){const{position:e,ticks:i}=this.options;if(-mc(this.labelRotation))return e==="top"?"left":"right";let r="center";return i.align==="start"?r="left":i.align==="end"?r="right":i.align==="inner"&&(r="inner"),r}_getYAxisLabelAlignment(e){const{position:i,ticks:{crossAlign:n,mirror:r,padding:s}}=this.options,o=this._getLabelSizes(),a=e+s,l=o.widest.width;let c,u;return i==="left"?r?(u=this.right+s,n==="near"?c="left":n==="center"?(c="center",u+=l/2):(c="right",u+=l)):(u=this.right-a,n==="near"?c="right":n==="center"?(c="center",u-=l/2):(c="left",u=this.left)):i==="right"?r?(u=this.left+s,n==="near"?c="right":n==="center"?(c="center",u-=l/2):(c="left",u-=l)):(u=this.left+a,n==="near"?c="left":n==="center"?(c="center",u+=l/2):(c="right",u=this.right)):c="right",{textAlign:c,x:u}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,i=this.options.position;if(i==="left"||i==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(i==="top"||i==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:i},left:n,top:r,width:s,height:o}=this;i&&(e.save(),e.fillStyle=i,e.fillRect(n,r,s,o),e.restore())}getLineWidthForValue(e){const i=this.options.grid;if(!this._isVisible()||!i.display)return 0;const r=this.ticks.findIndex(s=>s.value===e);return r>=0?i.setContext(this.getContext(r)).lineWidth:0}drawGrid(e){const i=this.options.grid,n=this.ctx,r=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let s,o;const a=(l,c,u)=>{!u.width||!u.color||(n.save(),n.lineWidth=u.width,n.strokeStyle=u.color,n.setLineDash(u.borderDash||[]),n.lineDashOffset=u.borderDashOffset,n.beginPath(),n.moveTo(l.x,l.y),n.lineTo(c.x,c.y),n.stroke(),n.restore())};if(i.display)for(s=0,o=r.length;s<o;++s){const l=r[s];i.drawOnChartArea&&a({x:l.x1,y:l.y1},{x:l.x2,y:l.y2},l),i.drawTicks&&a({x:l.tx1,y:l.ty1},{x:l.tx2,y:l.ty2},{color:l.tickColor,width:l.tickWidth,borderDash:l.tickBorderDash,borderDashOffset:l.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:i,options:{border:n,grid:r}}=this,s=n.setContext(this.getContext()),o=n.display?s.width:0;if(!o)return;const a=r.setContext(this.getContext(0)).lineWidth,l=this._borderValue;let c,u,d,f;this.isHorizontal()?(c=Em(e,this.left,o)-o/2,u=Em(e,this.right,a)+a/2,d=f=l):(d=Em(e,this.top,o)-o/2,f=Em(e,this.bottom,a)+a/2,c=u=l),i.save(),i.lineWidth=s.width,i.strokeStyle=s.color,i.beginPath(),i.moveTo(c,d),i.lineTo(u,f),i.stroke(),i.restore()}drawLabels(e){if(!this.options.ticks.display)return;const n=this.ctx,r=this._computeLabelArea();r&&Rk(n,r);const s=this.getLabelItems(e);for(const o of s){const a=o.options,l=o.font,c=o.label,u=o.textOffset;Qy(n,c,0,u,l,a)}r&&Dk(n)}drawTitle(){const{ctx:e,options:{position:i,title:n,reverse:r}}=this;if(!n.display)return;const s=wr(n.font),o=Fs(n.padding),a=n.align;let l=s.lineHeight/2;i==="bottom"||i==="center"||Et(i)?(l+=o.bottom,Ui(n.text)&&(l+=s.lineHeight*(n.text.length-1))):l+=o.top;const{titleX:c,titleY:u,maxWidth:d,rotation:f}=Fit(this,l,i,a);Qy(e,n.text,0,0,s,{color:n.color,maxWidth:d,rotation:f,textAlign:Nit(a,i,r),textBaseline:"middle",translation:[c,u]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,i=e.ticks&&e.ticks.z||0,n=it(e.grid&&e.grid.z,-1),r=it(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==y0.prototype.draw?[{z:i,draw:s=>{this.draw(s)}}]:[{z:n,draw:s=>{this.drawBackground(),this.drawGrid(s),this.drawTitle()}},{z:r,draw:()=>{this.drawBorder()}},{z:i,draw:s=>{this.drawLabels(s)}}]}getMatchingVisibleMetas(e){const i=this.chart.getSortedVisibleDatasetMetas(),n=this.axis+"AxisID",r=[];let s,o;for(s=0,o=i.length;s<o;++s){const a=i[s];a[n]===this.id&&(!e||a.type===e)&&r.push(a)}return r}_resolveTickFontOptions(e){const i=this.options.ticks.setContext(this.getContext(e));return wr(i.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class LC{constructor(e,i,n){this.type=e,this.scope=i,this.override=n,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const i=Object.getPrototypeOf(e);let n;jit(i)&&(n=this.register(i));const r=this.items,s=e.id,o=this.scope+"."+s;if(!s)throw new Error("class does not have id: "+e);return s in r||(r[s]=e,zit(e,o,n),this.override&&Mn.override(e.id,e.overrides)),o}get(e){return this.items[e]}unregister(e){const i=this.items,n=e.id,r=this.scope;n in i&&delete i[n],r&&n in Mn[r]&&(delete Mn[r][n],this.override&&delete Ky[n])}}function zit(t,e,i){const n=bS(Object.create(null),[i?Mn.get(i):{},Mn.get(e),t.defaults]);Mn.set(e,n),t.defaultRoutes&&Vit(e,t.defaultRoutes),t.descriptors&&Mn.describe(e,t.descriptors)}function Vit(t,e){Object.keys(e).forEach(i=>{const n=i.split("."),r=n.pop(),s=[t].concat(n).join("."),o=e[i].split("."),a=o.pop(),l=o.join(".");Mn.route(s,r,l,a)})}function jit(t){return"id"in t&&"defaults"in t}class Bit{constructor(){this.controllers=new LC(wc,"datasets",!0),this.elements=new LC(wd,"elements"),this.plugins=new LC(Object,"plugins"),this.scales=new LC(y0,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,i,n){[...i].forEach(r=>{const s=n||this._getRegistryForType(r);n||s.isForType(r)||s===this.plugins&&r.id?this._exec(e,s,r):St(r,o=>{const a=n||this._getRegistryForType(o);this._exec(e,a,o)})})}_exec(e,i,n){const r=xB(e);nt(n["before"+r],[],n),i[e](n),nt(n["after"+r],[],n)}_getRegistryForType(e){for(let i=0;i<this._typedRegistries.length;i++){const n=this._typedRegistries[i];if(n.isForType(e))return n}return this.plugins}_get(e,i,n){const r=i.get(e);if(r===void 0)throw new Error('"'+e+'" is not a registered '+n+".");return r}}var cu=new Bit;class Uit{constructor(){this._init=[]}notify(e,i,n,r){i==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install"));const s=r?this._descriptors(e).filter(r):this._descriptors(e),o=this._notify(s,e,i,n);return i==="afterDestroy"&&(this._notify(s,e,"stop"),this._notify(this._init,e,"uninstall")),o}_notify(e,i,n,r){r=r||{};for(const s of e){const o=s.plugin,a=o[n],l=[i,r,s.options];if(nt(a,l,o)===!1&&r.cancelable)return!1}return!0}invalidate(){zt(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const i=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),i}_createDescriptors(e,i){const n=e&&e.config,r=it(n.options&&n.options.plugins,{}),s=Git(n);return r===!1&&!i?[]:qit(e,s,r,i)}_notifyStateChanges(e){const i=this._oldCache||[],n=this._cache,r=(s,o)=>s.filter(a=>!o.some(l=>a.plugin.id===l.plugin.id));this._notify(r(i,n),e,"stop"),this._notify(r(n,i),e,"start")}}function Git(t){const e={},i=[],n=Object.keys(cu.plugins.items);for(let s=0;s<n.length;s++)i.push(cu.getPlugin(n[s]));const r=t.plugins||[];for(let s=0;s<r.length;s++){const o=r[s];i.indexOf(o)===-1&&(i.push(o),e[o.id]=!0)}return{plugins:i,localIds:e}}function Hit(t,e){return!e&&t===!1?null:t===!0?{}:t}function qit(t,{plugins:e,localIds:i},n,r){const s=[],o=t.getContext();for(const a of e){const l=a.id,c=Hit(n[l],r);c!==null&&s.push({plugin:a,options:Wit(t.config,{plugin:a,local:i[l]},c,o)})}return s}function Wit(t,{plugin:e,local:i},n,r){const s=t.pluginScopeKeys(e),o=t.getOptionScopes(n,s);return i&&e.defaults&&o.push(e.defaults),t.createResolver(o,r,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function yz(t,e){const i=Mn.datasets[t]||{};return((e.datasets||{})[t]||{}).indexAxis||e.indexAxis||i.indexAxis||"x"}function Jit(t,e){let i=t;return t==="_index_"?i=e:t==="_value_"&&(i=e==="x"?"y":"x"),i}function Zit(t,e){return t===e?"_index_":"_value_"}function YY(t){if(t==="x"||t==="y"||t==="r")return t}function Yit(t){if(t==="top"||t==="bottom")return"x";if(t==="left"||t==="right")return"y"}function vz(t,...e){if(YY(t))return t;for(const i of e){const n=i.axis||Yit(i.position)||t.length>1&&YY(t[0].toLowerCase());if(n)return n}throw new Error(`Cannot determine type of '${t}' axis. Please provide 'axis' or 'position' option.`)}function XY(t,e,i){if(i[e+"AxisID"]===t)return{axis:e}}function Xit(t,e){if(e.data&&e.data.datasets){const i=e.data.datasets.filter(n=>n.xAxisID===t||n.yAxisID===t);if(i.length)return XY(t,"x",i[0])||XY(t,"y",i[0])}return{}}function Kit(t,e){const i=Ky[t.type]||{scales:{}},n=e.scales||{},r=yz(t.type,e),s=Object.create(null);return Object.keys(n).forEach(o=>{const a=n[o];if(!Et(a))return console.error(`Invalid scale configuration for scale: ${o}`);if(a._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${o}`);const l=vz(o,a,Xit(o,t),Mn.scales[a.type]),c=Zit(l,r),u=i.scales||{};s[o]=g2(Object.create(null),[{axis:l},a,u[l],u[c]])}),t.data.datasets.forEach(o=>{const a=o.type||t.type,l=o.indexAxis||yz(a,e),u=(Ky[a]||{}).scales||{};Object.keys(u).forEach(d=>{const f=Jit(d,l),m=o[f+"AxisID"]||f;s[m]=s[m]||Object.create(null),g2(s[m],[{axis:f},n[m],u[d]])})}),Object.keys(s).forEach(o=>{const a=s[o];g2(a,[Mn.scales[a.type],Mn.scale])}),s}function zme(t){const e=t.options||(t.options={});e.plugins=it(e.plugins,{}),e.scales=Kit(t,e)}function Vme(t){return t=t||{},t.datasets=t.datasets||[],t.labels=t.labels||[],t}function Qit(t){return t=t||{},t.data=Vme(t.data),zme(t),t}const KY=new Map,jme=new Set;function RC(t,e){let i=KY.get(t);return i||(i=e(),KY.set(t,i),jme.add(i)),i}const ow=(t,e,i)=>{const n=Gf(e,i);n!==void 0&&t.add(n)};class ent{constructor(e){this._config=Qit(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=Vme(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),zme(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return RC(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,i){return RC(`${e}.transition.${i}`,()=>[[`datasets.${e}.transitions.${i}`,`transitions.${i}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,i){return RC(`${e}-${i}`,()=>[[`datasets.${e}.elements.${i}`,`datasets.${e}`,`elements.${i}`,""]])}pluginScopeKeys(e){const i=e.id,n=this.type;return RC(`${n}-plugin-${i}`,()=>[[`plugins.${i}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,i){const n=this._scopeCache;let r=n.get(e);return(!r||i)&&(r=new Map,n.set(e,r)),r}getOptionScopes(e,i,n){const{options:r,type:s}=this,o=this._cachedScopes(e,n),a=o.get(i);if(a)return a;const l=new Set;i.forEach(u=>{e&&(l.add(e),u.forEach(d=>ow(l,e,d))),u.forEach(d=>ow(l,r,d)),u.forEach(d=>ow(l,Ky[s]||{},d)),u.forEach(d=>ow(l,Mn,d)),u.forEach(d=>ow(l,fz,d))});const c=Array.from(l);return c.length===0&&c.push(Object.create(null)),jme.has(i)&&o.set(i,c),c}chartOptionScopes(){const{options:e,type:i}=this;return[e,Ky[i]||{},Mn.datasets[i]||{},{type:i},Mn,fz]}resolveNamedOptions(e,i,n,r=[""]){const s={$shared:!0},{resolver:o,subPrefixes:a}=QY(this._resolverCache,e,r);let l=o;if(int(o,i)){s.$shared=!1,n=Hf(n)?n():n;const c=this.createResolver(e,n,a);l=Ab(o,n,c)}for(const c of i)s[c]=l[c];return s}createResolver(e,i,n=[""],r){const{resolver:s}=QY(this._resolverCache,e,n);return Et(i)?Ab(s,i,void 0,r):s}}function QY(t,e,i){let n=t.get(e);n||(n=new Map,t.set(e,n));const r=i.join();let s=n.get(r);return s||(s={resolver:EB(e,i),subPrefixes:i.filter(a=>!a.toLowerCase().includes("hover"))},n.set(r,s)),s}const tnt=t=>Et(t)&&Object.getOwnPropertyNames(t).reduce((e,i)=>e||Hf(t[i]),!1);function int(t,e){const{isScriptable:i,isIndexable:n}=_me(t);for(const r of e){const s=i(r),o=n(r),a=(o||s)&&t[r];if(s&&(Hf(a)||tnt(a))||o&&Ui(a))return!0}return!1}var nnt="4.3.0";const rnt=["top","bottom","left","right","chartArea"];function eX(t,e){return t==="top"||t==="bottom"||rnt.indexOf(t)===-1&&e==="x"}function tX(t,e){return function(i,n){return i[t]===n[t]?i[e]-n[e]:i[t]-n[t]}}function iX(t){const e=t.chart,i=e.options.animation;e.notifyPlugins("afterRender"),nt(i&&i.onComplete,[t],e)}function snt(t){const e=t.chart,i=e.options.animation;nt(i&&i.onProgress,[t],e)}function Bme(t){return Ime()&&typeof t=="string"?t=document.getElementById(t):t&&t.length&&(t=t[0]),t&&t.canvas&&(t=t.canvas),t}const CE={},nX=t=>{const e=Bme(t);return Object.values(CE).filter(i=>i.canvas===e).pop()};function ont(t,e,i){const n=Object.keys(t);for(const r of n){const s=+r;if(s>=e){const o=t[r];delete t[r],(i>0||s>e)&&(t[s+i]=o)}}}function ant(t,e,i,n){return!i||t.type==="mouseout"?null:n?e:t}function lnt(t){const{xScale:e,yScale:i}=t;if(e&&i)return{left:e.left,right:e.right,top:i.top,bottom:i.bottom}}class gu{static register(...e){cu.add(...e),rX()}static unregister(...e){cu.remove(...e),rX()}constructor(e,i){const n=this.config=new ent(i),r=Bme(e),s=nX(r);if(s)throw new Error("Canvas is already in use. Chart with ID '"+s.id+"' must be destroyed before the canvas with ID '"+s.canvas.id+"' can be reused.");const o=n.createResolver(n.chartOptionScopes(),this.getContext());this.platform=new(n.platform||Iit(r)),this.platform.updateConfig(n);const a=this.platform.acquireContext(r,o.aspectRatio),l=a&&a.canvas,c=l&&l.height,u=l&&l.width;if(this.id=cet(),this.ctx=a,this.canvas=l,this.width=u,this.height=c,this._options=o,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new Uit,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=Cet(d=>this.update(d),o.resizeDelay||0),this._dataChanges=[],CE[this.id]=this,!a||!l){console.error("Failed to create chart: can't acquire context from the given item");return}Th.listen(this,"complete",iX),Th.listen(this,"progress",snt),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:i},width:n,height:r,_aspectRatio:s}=this;return zt(e)?i&&s?s:r?n/r:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return cu}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():IY(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return xY(this.canvas,this.ctx),this}stop(){return Th.stop(this),this}resize(e,i){Th.running(this)?this._resizeBeforeDraw={width:e,height:i}:this._resize(e,i)}_resize(e,i){const n=this.options,r=this.canvas,s=n.maintainAspectRatio&&this.aspectRatio,o=this.platform.getMaximumSize(r,e,i,s),a=n.devicePixelRatio||this.platform.getDevicePixelRatio(),l=this.width?"resize":"attach";this.width=o.width,this.height=o.height,this._aspectRatio=this.aspectRatio,IY(this,a,!0)&&(this.notifyPlugins("resize",{size:o}),nt(n.onResize,[this,o],this),this.attached&&this._doResize(l)&&this.render())}ensureScalesHaveIDs(){const i=this.options.scales||{};St(i,(n,r)=>{n.id=r})}buildOrUpdateScales(){const e=this.options,i=e.scales,n=this.scales,r=Object.keys(n).reduce((o,a)=>(o[a]=!1,o),{});let s=[];i&&(s=s.concat(Object.keys(i).map(o=>{const a=i[o],l=vz(o,a),c=l==="r",u=l==="x";return{options:a,dposition:c?"chartArea":u?"bottom":"left",dtype:c?"radialLinear":u?"category":"linear"}}))),St(s,o=>{const a=o.options,l=a.id,c=vz(l,a),u=it(a.type,o.dtype);(a.position===void 0||eX(a.position,c)!==eX(o.dposition))&&(a.position=o.dposition),r[l]=!0;let d=null;if(l in n&&n[l].type===u)d=n[l];else{const f=cu.getScale(u);d=new f({id:l,type:u,ctx:this.ctx,chart:this}),n[d.id]=d}d.init(a,e)}),St(r,(o,a)=>{o||delete n[a]}),St(n,o=>{Ps.configure(this,o,o.options),Ps.addBox(this,o)})}_updateMetasets(){const e=this._metasets,i=this.data.datasets.length,n=e.length;if(e.sort((r,s)=>r.index-s.index),n>i){for(let r=i;r<n;++r)this._destroyDatasetMeta(r);e.splice(i,n-i)}this._sortedMetasets=e.slice(0).sort(tX("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:i}}=this;e.length>i.length&&delete this._stacks,e.forEach((n,r)=>{i.filter(s=>s===n._dataset).length===0&&this._destroyDatasetMeta(r)})}buildOrUpdateControllers(){const e=[],i=this.data.datasets;let n,r;for(this._removeUnreferencedMetasets(),n=0,r=i.length;n<r;n++){const s=i[n];let o=this.getDatasetMeta(n);const a=s.type||this.config.type;if(o.type&&o.type!==a&&(this._destroyDatasetMeta(n),o=this.getDatasetMeta(n)),o.type=a,o.indexAxis=s.indexAxis||yz(a,this.options),o.order=s.order||0,o.index=n,o.label=""+s.label,o.visible=this.isDatasetVisible(n),o.controller)o.controller.updateIndex(n),o.controller.linkScales();else{const l=cu.getController(a),{datasetElementType:c,dataElementType:u}=Mn.datasets[a];Object.assign(l,{dataElementType:cu.getElement(u),datasetElementType:c&&cu.getElement(c)}),o.controller=new l(this,n),e.push(o.controller)}}return this._updateMetasets(),e}_resetElements(){St(this.data.datasets,(e,i)=>{this.getDatasetMeta(i).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const i=this.config;i.update();const n=this._options=i.createResolver(i.chartOptionScopes(),this.getContext()),r=this._animationsDisabled=!n.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const s=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let o=0;for(let c=0,u=this.data.datasets.length;c<u;c++){const{controller:d}=this.getDatasetMeta(c),f=!r&&s.indexOf(d)===-1;d.buildOrUpdateElements(f),o=Math.max(+d.getMaxOverflow(),o)}o=this._minPadding=n.layout.autoPadding?o:0,this._updateLayout(o),r||St(s,c=>{c.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(tX("z","_idx"));const{_active:a,_lastEvent:l}=this;l?this._eventHandler(l,!0):a.length&&this._updateHoverStyles(a,a,!0),this.render()}_updateScales(){St(this.scales,e=>{Ps.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,i=new Set(Object.keys(this._listeners)),n=new Set(e.events);(!pY(i,n)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,i=this._getUniformDataChanges()||[];for(const{method:n,start:r,count:s}of i){const o=n==="_removeElements"?-s:s;ont(e,r,o)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const i=this.data.datasets.length,n=s=>new Set(e.filter(o=>o[0]===s).map((o,a)=>a+","+o.splice(1).join(","))),r=n(0);for(let s=1;s<i;s++)if(!pY(r,n(s)))return;return Array.from(r).map(s=>s.split(",")).map(s=>({method:s[1],start:+s[2],count:+s[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;Ps.update(this,this.width,this.height,e);const i=this.chartArea,n=i.width<=0||i.height<=0;this._layers=[],St(this.boxes,r=>{n&&r.position==="chartArea"||(r.configure&&r.configure(),this._layers.push(...r._layers()))},this),this._layers.forEach((r,s)=>{r._idx=s}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let i=0,n=this.data.datasets.length;i<n;++i)this.getDatasetMeta(i).controller.configure();for(let i=0,n=this.data.datasets.length;i<n;++i)this._updateDataset(i,Hf(e)?e({datasetIndex:i}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,i){const n=this.getDatasetMeta(e),r={meta:n,index:e,mode:i,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",r)!==!1&&(n.controller._update(i),r.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",r))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(Th.has(this)?this.attached&&!Th.running(this)&&Th.start(this):(this.draw(),iX({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:n,height:r}=this._resizeBeforeDraw;this._resize(n,r),this._resizeBeforeDraw=null}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const i=this._layers;for(e=0;e<i.length&&i[e].z<=0;++e)i[e].draw(this.chartArea);for(this._drawDatasets();e<i.length;++e)i[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const i=this._sortedMetasets,n=[];let r,s;for(r=0,s=i.length;r<s;++r){const o=i[r];(!e||o.visible)&&n.push(o)}return n}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let i=e.length-1;i>=0;--i)this._drawDataset(e[i]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const i=this.ctx,n=e._clip,r=!n.disabled,s=lnt(e)||this.chartArea,o={meta:e,index:e.index,cancelable:!0};this.notifyPlugins("beforeDatasetDraw",o)!==!1&&(r&&Rk(i,{left:n.left===!1?0:s.left-n.left,right:n.right===!1?this.width:s.right+n.right,top:n.top===!1?0:s.top-n.top,bottom:n.bottom===!1?this.height:s.bottom+n.bottom}),e.controller.draw(),r&&Dk(i),o.cancelable=!1,this.notifyPlugins("afterDatasetDraw",o))}isPointInArea(e){return Bh(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,i,n,r){const s=rit.modes[i];return typeof s=="function"?s(this,e,n,r):[]}getDatasetMeta(e){const i=this.data.datasets[e],n=this._metasets;let r=n.filter(s=>s&&s._dataset===i).pop();return r||(r={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:i&&i.order||0,index:e,_dataset:i,_parsed:[],_sorted:!1},n.push(r)),r}getContext(){return this.$context||(this.$context=rm(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const i=this.data.datasets[e];if(!i)return!1;const n=this.getDatasetMeta(e);return typeof n.hidden=="boolean"?!n.hidden:!i.hidden}setDatasetVisibility(e,i){const n=this.getDatasetMeta(e);n.hidden=!i}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,i,n){const r=n?"show":"hide",s=this.getDatasetMeta(e),o=s.controller._resolveAnimations(void 0,r);wS(i)?(s.data[i].hidden=!n,this.update()):(this.setDatasetVisibility(e,n),o.update(s,{visible:n}),this.update(a=>a.datasetIndex===e?r:void 0))}hide(e,i){this._updateVisibility(e,i,!1)}show(e,i){this._updateVisibility(e,i,!0)}_destroyDatasetMeta(e){const i=this._metasets[e];i&&i.controller&&i.controller._destroy(),delete this._metasets[e]}_stop(){let e,i;for(this.stop(),Th.remove(this),e=0,i=this.data.datasets.length;e<i;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:i}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),xY(e,i),this.platform.releaseContext(i),this.canvas=null,this.ctx=null),delete CE[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,i=this.platform,n=(s,o)=>{i.addEventListener(this,s,o),e[s]=o},r=(s,o,a)=>{s.offsetX=o,s.offsetY=a,this._eventHandler(s)};St(this.options.events,s=>n(s,r))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,i=this.platform,n=(l,c)=>{i.addEventListener(this,l,c),e[l]=c},r=(l,c)=>{e[l]&&(i.removeEventListener(this,l,c),delete e[l])},s=(l,c)=>{this.canvas&&this.resize(l,c)};let o;const a=()=>{r("attach",a),this.attached=!0,this.resize(),n("resize",s),n("detach",o)};o=()=>{this.attached=!1,r("resize",s),this._stop(),this._resize(0,0),n("attach",a)},i.isAttached(this.canvas)?a():o()}unbindEvents(){St(this._listeners,(e,i)=>{this.platform.removeEventListener(this,i,e)}),this._listeners={},St(this._responsiveListeners,(e,i)=>{this.platform.removeEventListener(this,i,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,i,n){const r=n?"set":"remove";let s,o,a,l;for(i==="dataset"&&(s=this.getDatasetMeta(e[0].datasetIndex),s.controller["_"+r+"DatasetHoverStyle"]()),a=0,l=e.length;a<l;++a){o=e[a];const c=o&&this.getDatasetMeta(o.datasetIndex).controller;c&&c[r+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const i=this._active||[],n=e.map(({datasetIndex:s,index:o})=>{const a=this.getDatasetMeta(s);if(!a)throw new Error("No dataset found at index "+s);return{datasetIndex:s,element:a.data[o],index:o}});!R$(n,i)&&(this._active=n,this._lastEvent=null,this._updateHoverStyles(n,i))}notifyPlugins(e,i,n){return this._plugins.notify(this,e,i,n)}isPluginEnabled(e){return this._plugins._cache.filter(i=>i.plugin.id===e).length===1}_updateHoverStyles(e,i,n){const r=this.options.hover,s=(l,c)=>l.filter(u=>!c.some(d=>u.datasetIndex===d.datasetIndex&&u.index===d.index)),o=s(i,e),a=n?e:s(e,i);o.length&&this.updateHoverStyle(o,r.mode,!1),a.length&&r.mode&&this.updateHoverStyle(a,r.mode,!0)}_eventHandler(e,i){const n={event:e,replay:i,cancelable:!0,inChartArea:this.isPointInArea(e)},r=o=>(o.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",n,r)===!1)return;const s=this._handleEvent(e,i,n.inChartArea);return n.cancelable=!1,this.notifyPlugins("afterEvent",n,r),(s||n.changed)&&this.render(),this}_handleEvent(e,i,n){const{_active:r=[],options:s}=this,o=i,a=this._getActiveElements(e,r,n,o),l=met(e),c=ant(e,this._lastEvent,n,l);n&&(this._lastEvent=null,nt(s.onHover,[e,a,this],this),l&&nt(s.onClick,[e,a,this],this));const u=!R$(a,r);return(u||i)&&(this._active=a,this._updateHoverStyles(a,r,i)),this._lastEvent=c,u}_getActiveElements(e,i,n,r){if(e.type==="mouseout")return[];if(!n)return i;const s=this.options.hover;return this.getElementsAtEventForMode(e,s.mode,s,r)}}ve(gu,"defaults",Mn),ve(gu,"instances",CE),ve(gu,"overrides",Ky),ve(gu,"registry",cu),ve(gu,"version",nnt),ve(gu,"getChart",nX);function rX(){return St(gu.instances,t=>t._plugins.invalidate())}function cnt(t,e,i){const{startAngle:n,pixelMargin:r,x:s,y:o,outerRadius:a,innerRadius:l}=e;let c=r/a;t.beginPath(),t.arc(s,o,a,n-c,i+c),l>r?(c=r/l,t.arc(s,o,l,i+c,n-c,!0)):t.arc(s,o,r,i+Cn,n-Cn),t.closePath(),t.clip()}function unt(t){return MB(t,["outerStart","outerEnd","innerStart","innerEnd"])}function hnt(t,e,i,n){const r=unt(t.options.borderRadius),s=(i-e)/2,o=Math.min(s,n*e/2),a=l=>{const c=(i-Math.min(s,l))*n/2;return zr(l,0,Math.min(s,c))};return{outerStart:a(r.outerStart),outerEnd:a(r.outerEnd),innerStart:zr(r.innerStart,0,o),innerEnd:zr(r.innerEnd,0,o)}}function rv(t,e,i,n){return{x:i+t*Math.cos(e),y:n+t*Math.sin(e)}}function j$(t,e,i,n,r,s){const{x:o,y:a,startAngle:l,pixelMargin:c,innerRadius:u}=e,d=Math.max(e.outerRadius+n+i-c,0),f=u>0?u+n+i+c:0;let m=0;const g=r-l;if(n){const z=u>0?u-n:0,U=d>0?d-n:0,G=(z+U)/2,W=G!==0?g*G/(G+n):g;m=(g-W)/2}const y=Math.max(.001,g*d-i/ln)/d,_=(g-y)/2,b=l+_+m,w=r-_-m,{outerStart:x,outerEnd:S,innerStart:T,innerEnd:I}=hnt(e,f,d,w-b),C=d-x,M=d-S,E=b+x/C,A=w-S/M,$=f+T,L=f+I,D=b+T/$,F=w-I/L;if(t.beginPath(),s){const z=(E+A)/2;if(t.arc(o,a,d,E,z),t.arc(o,a,d,z,A),S>0){const Z=rv(M,A,o,a);t.arc(Z.x,Z.y,S,A,w+Cn)}const U=rv(L,w,o,a);if(t.lineTo(U.x,U.y),I>0){const Z=rv(L,F,o,a);t.arc(Z.x,Z.y,I,w+Cn,F+Math.PI)}const G=(w-I/f+(b+T/f))/2;if(t.arc(o,a,f,w-I/f,G,!0),t.arc(o,a,f,G,b+T/f,!0),T>0){const Z=rv($,D,o,a);t.arc(Z.x,Z.y,T,D+Math.PI,b-Cn)}const W=rv(C,b,o,a);if(t.lineTo(W.x,W.y),x>0){const Z=rv(C,E,o,a);t.arc(Z.x,Z.y,x,b-Cn,E)}}else{t.moveTo(o,a);const z=Math.cos(E)*d+o,U=Math.sin(E)*d+a;t.lineTo(z,U);const G=Math.cos(A)*d+o,W=Math.sin(A)*d+a;t.lineTo(G,W)}t.closePath()}function dnt(t,e,i,n,r){const{fullCircles:s,startAngle:o,circumference:a}=e;let l=e.endAngle;if(s){j$(t,e,i,n,l,r);for(let c=0;c<s;++c)t.fill();isNaN(a)||(l=o+(a%Hi||Hi))}return j$(t,e,i,n,l,r),t.fill(),l}function pnt(t,e,i,n,r){const{fullCircles:s,startAngle:o,circumference:a,options:l}=e,{borderWidth:c,borderJoinStyle:u,borderDash:d,borderDashOffset:f}=l,m=l.borderAlign==="inner";if(!c)return;t.setLineDash(d||[]),t.lineDashOffset=f,m?(t.lineWidth=c*2,t.lineJoin=u||"round"):(t.lineWidth=c,t.lineJoin=u||"bevel");let g=e.endAngle;if(s){j$(t,e,i,n,g,r);for(let y=0;y<s;++y)t.stroke();isNaN(a)||(g=o+(a%Hi||Hi))}m&&cnt(t,e,g),s||(j$(t,e,i,n,g,r),t.stroke())}class Tx extends wd{constructor(i){super();ve(this,"circumference");ve(this,"endAngle");ve(this,"fullCircles");ve(this,"innerRadius");ve(this,"outerRadius");ve(this,"pixelMargin");ve(this,"startAngle");this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,i&&Object.assign(this,i)}inRange(i,n,r){const s=this.getProps(["x","y"],r),{angle:o,distance:a}=cme(s,{x:i,y:n}),{startAngle:l,endAngle:c,innerRadius:u,outerRadius:d,circumference:f}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],r),m=(this.options.spacing+this.options.borderWidth)/2,y=it(f,c-l)>=Hi||xS(o,l,c),_=Vh(a,u+m,d+m);return y&&_}getCenterPoint(i){const{x:n,y:r,startAngle:s,endAngle:o,innerRadius:a,outerRadius:l}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],i),{offset:c,spacing:u}=this.options,d=(s+o)/2,f=(a+l+u+c)/2;return{x:n+Math.cos(d)*f,y:r+Math.sin(d)*f}}tooltipPosition(i){return this.getCenterPoint(i)}draw(i){const{options:n,circumference:r}=this,s=(n.offset||0)/4,o=(n.spacing||0)/2,a=n.circular;if(this.pixelMargin=n.borderAlign==="inner"?.33:0,this.fullCircles=r>Hi?Math.floor(r/Hi):0,r===0||this.innerRadius<0||this.outerRadius<0)return;i.save();const l=(this.startAngle+this.endAngle)/2;i.translate(Math.cos(l)*s,Math.sin(l)*s);const c=1-Math.sin(Math.min(ln,r||0)),u=s*c;i.fillStyle=n.backgroundColor,i.strokeStyle=n.borderColor,dnt(i,this,u,o,a),pnt(i,this,u,o,a),i.restore()}}ve(Tx,"id","arc"),ve(Tx,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0}),ve(Tx,"defaultRoutes",{backgroundColor:"backgroundColor"}),ve(Tx,"descriptors",{_scriptable:!0,_indexable:i=>i!=="borderDash"});function Ume(t,e,i=e){t.lineCap=it(i.borderCapStyle,e.borderCapStyle),t.setLineDash(it(i.borderDash,e.borderDash)),t.lineDashOffset=it(i.borderDashOffset,e.borderDashOffset),t.lineJoin=it(i.borderJoinStyle,e.borderJoinStyle),t.lineWidth=it(i.borderWidth,e.borderWidth),t.strokeStyle=it(i.borderColor,e.borderColor)}function fnt(t,e,i){t.lineTo(i.x,i.y)}function mnt(t){return t.stepped?Fet:t.tension||t.cubicInterpolationMode==="monotone"?zet:fnt}function Gme(t,e,i={}){const n=t.length,{start:r=0,end:s=n-1}=i,{start:o,end:a}=e,l=Math.max(r,o),c=Math.min(s,a),u=r<o&&s<o||r>a&&s>a;return{count:n,start:l,loop:e.loop,ilen:c<l&&!u?n+c-l:c-l}}function gnt(t,e,i,n){const{points:r,options:s}=e,{count:o,start:a,loop:l,ilen:c}=Gme(r,i,n),u=mnt(s);let{move:d=!0,reverse:f}=n||{},m,g,y;for(m=0;m<=c;++m)g=r[(a+(f?c-m:m))%o],!g.skip&&(d?(t.moveTo(g.x,g.y),d=!1):u(t,y,g,f,s.stepped),y=g);return l&&(g=r[(a+(f?c:0))%o],u(t,y,g,f,s.stepped)),!!l}function ynt(t,e,i,n){const r=e.points,{count:s,start:o,ilen:a}=Gme(r,i,n),{move:l=!0,reverse:c}=n||{};let u=0,d=0,f,m,g,y,_,b;const w=S=>(o+(c?a-S:S))%s,x=()=>{y!==_&&(t.lineTo(u,_),t.lineTo(u,y),t.lineTo(u,b))};for(l&&(m=r[w(0)],t.moveTo(m.x,m.y)),f=0;f<=a;++f){if(m=r[w(f)],m.skip)continue;const S=m.x,T=m.y,I=S|0;I===g?(T<y?y=T:T>_&&(_=T),u=(d*u+S)/++d):(x(),t.lineTo(S,T),g=I,d=0,y=_=T),b=T}x()}function _z(t){const e=t.options,i=e.borderDash&&e.borderDash.length;return!t._decimated&&!t._loop&&!e.tension&&e.cubicInterpolationMode!=="monotone"&&!e.stepped&&!i?ynt:gnt}function vnt(t){return t.stepped?ytt:t.tension||t.cubicInterpolationMode==="monotone"?vtt:Vg}function _nt(t,e,i,n){let r=e._path;r||(r=e._path=new Path2D,e.path(r,i,n)&&r.closePath()),Ume(t,e.options),t.stroke(r)}function bnt(t,e,i,n){const{segments:r,options:s}=e,o=_z(e);for(const a of r)Ume(t,s,a.style),t.beginPath(),o(t,e,a,{start:i,end:i+n-1})&&t.closePath(),t.stroke()}const wnt=typeof Path2D=="function";function xnt(t,e,i,n){wnt&&!e.options.segment?_nt(t,e,i,n):bnt(t,e,i,n)}class wf extends wd{constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,i){const n=this.options;if((n.tension||n.cubicInterpolationMode==="monotone")&&!n.stepped&&!this._pointsUpdated){const r=n.spanGaps?this._loop:this._fullLoop;ctt(this._points,n,e,r,i),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=Ttt(this,this.options.segment))}first(){const e=this.segments,i=this.points;return e.length&&i[e[0].start]}last(){const e=this.segments,i=this.points,n=e.length;return n&&i[e[n-1].end]}interpolate(e,i){const n=this.options,r=e[i],s=this.points,o=$me(this,{property:i,start:r,end:r});if(!o.length)return;const a=[],l=vnt(n);let c,u;for(c=0,u=o.length;c<u;++c){const{start:d,end:f}=o[c],m=s[d],g=s[f];if(m===g){a.push(m);continue}const y=Math.abs((r-m[i])/(g[i]-m[i])),_=l(m,g,y,n.stepped);_[i]=e[i],a.push(_)}return a.length===1?a[0]:a}pathSegment(e,i,n){return _z(this)(e,this,i,n)}path(e,i,n){const r=this.segments,s=_z(this);let o=this._loop;i=i||0,n=n||this.points.length-i;for(const a of r)o&=s(e,this,a,{start:i,end:i+n-1});return!!o}draw(e,i,n,r){const s=this.options||{};(this.points||[]).length&&s.borderWidth&&(e.save(),xnt(e,this,n,r),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}ve(wf,"id","line"),ve(wf,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),ve(wf,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),ve(wf,"descriptors",{_scriptable:!0,_indexable:e=>e!=="borderDash"&&e!=="fill"});function sX(t,e,i,n){const r=t.options,{[i]:s}=t.getProps([i],n);return Math.abs(e-s)<r.radius+r.hitRadius}class ME extends wd{constructor(i){super();ve(this,"parsed");ve(this,"skip");ve(this,"stop");this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,i&&Object.assign(this,i)}inRange(i,n,r){const s=this.options,{x:o,y:a}=this.getProps(["x","y"],r);return Math.pow(i-o,2)+Math.pow(n-a,2)<Math.pow(s.hitRadius+s.radius,2)}inXRange(i,n){return sX(this,i,"x",n)}inYRange(i,n){return sX(this,i,"y",n)}getCenterPoint(i){const{x:n,y:r}=this.getProps(["x","y"],i);return{x:n,y:r}}size(i){i=i||this.options||{};let n=i.radius||0;n=Math.max(n,n&&i.hoverRadius||0);const r=n&&i.borderWidth||0;return(n+r)*2}draw(i,n){const r=this.options;this.skip||r.radius<.1||!Bh(this,n,this.size(r)/2)||(i.strokeStyle=r.borderColor,i.lineWidth=r.borderWidth,i.fillStyle=r.backgroundColor,mz(i,r,this.x,this.y))}getRange(){const i=this.options||{};return i.radius+i.hitRadius}}ve(ME,"id","point"),ve(ME,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),ve(ME,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});function Hme(t,e){const{x:i,y:n,base:r,width:s,height:o}=t.getProps(["x","y","base","width","height"],e);let a,l,c,u,d;return t.horizontal?(d=o/2,a=Math.min(i,r),l=Math.max(i,r),c=n-d,u=n+d):(d=s/2,a=i-d,l=i+d,c=Math.min(n,r),u=Math.max(n,r)),{left:a,top:c,right:l,bottom:u}}function xf(t,e,i,n){return t?0:zr(e,i,n)}function Snt(t,e,i){const n=t.options.borderWidth,r=t.borderSkipped,s=vme(n);return{t:xf(r.top,s.top,0,i),r:xf(r.right,s.right,0,e),b:xf(r.bottom,s.bottom,0,i),l:xf(r.left,s.left,0,e)}}function Tnt(t,e,i){const{enableBorderRadius:n}=t.getProps(["enableBorderRadius"]),r=t.options.borderRadius,s=Ey(r),o=Math.min(e,i),a=t.borderSkipped,l=n||Et(r);return{topLeft:xf(!l||a.top||a.left,s.topLeft,0,o),topRight:xf(!l||a.top||a.right,s.topRight,0,o),bottomLeft:xf(!l||a.bottom||a.left,s.bottomLeft,0,o),bottomRight:xf(!l||a.bottom||a.right,s.bottomRight,0,o)}}function Int(t){const e=Hme(t),i=e.right-e.left,n=e.bottom-e.top,r=Snt(t,i/2,n/2),s=Tnt(t,i/2,n/2);return{outer:{x:e.left,y:e.top,w:i,h:n,radius:s},inner:{x:e.left+r.l,y:e.top+r.t,w:i-r.l-r.r,h:n-r.t-r.b,radius:{topLeft:Math.max(0,s.topLeft-Math.max(r.t,r.l)),topRight:Math.max(0,s.topRight-Math.max(r.t,r.r)),bottomLeft:Math.max(0,s.bottomLeft-Math.max(r.b,r.l)),bottomRight:Math.max(0,s.bottomRight-Math.max(r.b,r.r))}}}}function BL(t,e,i,n){const r=e===null,s=i===null,a=t&&!(r&&s)&&Hme(t,n);return a&&(r||Vh(e,a.left,a.right))&&(s||Vh(i,a.top,a.bottom))}function Cnt(t){return t.topLeft||t.topRight||t.bottomLeft||t.bottomRight}function Mnt(t,e){t.rect(e.x,e.y,e.w,e.h)}function UL(t,e,i={}){const n=t.x!==i.x?-e:0,r=t.y!==i.y?-e:0,s=(t.x+t.w!==i.x+i.w?e:0)-n,o=(t.y+t.h!==i.y+i.h?e:0)-r;return{x:t.x+n,y:t.y+r,w:t.w+s,h:t.h+o,radius:t.radius}}class EE extends wd{constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:i,options:{borderColor:n,backgroundColor:r}}=this,{inner:s,outer:o}=Int(this),a=Cnt(o.radius)?SS:Mnt;e.save(),(o.w!==s.w||o.h!==s.h)&&(e.beginPath(),a(e,UL(o,i,s)),e.clip(),a(e,UL(s,-i,o)),e.fillStyle=n,e.fill("evenodd")),e.beginPath(),a(e,UL(s,i)),e.fillStyle=r,e.fill(),e.restore()}inRange(e,i,n){return BL(this,e,i,n)}inXRange(e,i){return BL(this,e,null,i)}inYRange(e,i){return BL(this,null,e,i)}getCenterPoint(e){const{x:i,y:n,base:r,horizontal:s}=this.getProps(["x","y","base","horizontal"],e);return{x:s?(i+r)/2:i,y:s?n:(n+r)/2}}getRange(e){return e==="x"?this.width/2:this.height/2}}ve(EE,"id","bar"),ve(EE,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),ve(EE,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});var Ent=Object.freeze({__proto__:null,ArcElement:Tx,BarElement:EE,LineElement:wf,PointElement:ME});const bz=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],oX=bz.map(t=>t.replace("rgb(","rgba(").replace(")",", 0.5)"));function qme(t){return bz[t%bz.length]}function Wme(t){return oX[t%oX.length]}function Ant(t,e){return t.borderColor=qme(e),t.backgroundColor=Wme(e),++e}function $nt(t,e){return t.backgroundColor=t.data.map(()=>qme(e++)),e}function Pnt(t,e){return t.backgroundColor=t.data.map(()=>Wme(e++)),e}function knt(t){let e=0;return(i,n)=>{const r=t.getDatasetMeta(n).controller;r instanceof dy?e=$nt(i,e):r instanceof b2?e=Pnt(i,e):r&&(e=Ant(i,e))}}function aX(t){let e;for(e in t)if(t[e].borderColor||t[e].backgroundColor)return!0;return!1}function Ont(t){return t&&(t.borderColor||t.backgroundColor)}var Lnt={id:"colors",defaults:{enabled:!0,forceOverride:!1},beforeLayout(t,e,i){if(!i.enabled)return;const{data:{datasets:n},options:r}=t.config,{elements:s}=r;if(!i.forceOverride&&(aX(n)||Ont(r)||s&&aX(s)))return;const o=knt(t);n.forEach(o)}};function Rnt(t,e,i,n,r){const s=r.samples||n;if(s>=i)return t.slice(e,e+i);const o=[],a=(i-2)/(s-2);let l=0;const c=e+i-1;let u=e,d,f,m,g,y;for(o[l++]=t[u],d=0;d<s-2;d++){let _=0,b=0,w;const x=Math.floor((d+1)*a)+1+e,S=Math.min(Math.floor((d+2)*a)+1,i)+e,T=S-x;for(w=x;w<S;w++)_+=t[w].x,b+=t[w].y;_/=T,b/=T;const I=Math.floor(d*a)+1+e,C=Math.min(Math.floor((d+1)*a)+1,i)+e,{x:M,y:E}=t[u];for(m=g=-1,w=I;w<C;w++)g=.5*Math.abs((M-_)*(t[w].y-E)-(M-t[w].x)*(b-E)),g>m&&(m=g,f=t[w],y=w);o[l++]=f,u=y}return o[l++]=t[c],o}function Dnt(t,e,i,n){let r=0,s=0,o,a,l,c,u,d,f,m,g,y;const _=[],b=e+i-1,w=t[e].x,S=t[b].x-w;for(o=e;o<e+i;++o){a=t[o],l=(a.x-w)/S*n,c=a.y;const T=l|0;if(T===u)c<g?(g=c,d=o):c>y&&(y=c,f=o),r=(s*r+a.x)/++s;else{const I=o-1;if(!zt(d)&&!zt(f)){const C=Math.min(d,f),M=Math.max(d,f);C!==m&&C!==I&&_.push({...t[C],x:r}),M!==m&&M!==I&&_.push({...t[M],x:r})}o>0&&I!==m&&_.push(t[I]),_.push(a),u=T,s=0,g=y=c,d=f=m=o}}return _}function Jme(t){if(t._decimated){const e=t._data;delete t._decimated,delete t._data,Object.defineProperty(t,"data",{configurable:!0,enumerable:!0,writable:!0,value:e})}}function lX(t){t.data.datasets.forEach(e=>{Jme(e)})}function Nnt(t,e){const i=e.length;let n=0,r;const{iScale:s}=t,{min:o,max:a,minDefined:l,maxDefined:c}=s.getUserBounds();return l&&(n=zr(jh(e,s.axis,o).lo,0,i-1)),c?r=zr(jh(e,s.axis,a).hi+1,n,i)-n:r=i-n,{start:n,count:r}}var Fnt={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(t,e,i)=>{if(!i.enabled){lX(t);return}const n=t.width;t.data.datasets.forEach((r,s)=>{const{_data:o,indexAxis:a}=r,l=t.getDatasetMeta(s),c=o||r.data;if(xx([a,t.options.indexAxis])==="y"||!l.controller.supportsDecimation)return;const u=t.scales[l.xAxisID];if(u.type!=="linear"&&u.type!=="time"||t.options.parsing)return;let{start:d,count:f}=Nnt(l,c);const m=i.threshold||4*n;if(f<=m){Jme(r);return}zt(o)&&(r._data=c,delete r.data,Object.defineProperty(r,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(y){this._data=y}}));let g;switch(i.algorithm){case"lttb":g=Rnt(c,d,f,n,i);break;case"min-max":g=Dnt(c,d,f,n);break;default:throw new Error(`Unsupported decimation algorithm '${i.algorithm}'`)}r._decimated=g})},destroy(t){lX(t)}};function znt(t,e,i){const n=t.segments,r=t.points,s=e.points,o=[];for(const a of n){let{start:l,end:c}=a;c=OB(l,c,r);const u=wz(i,r[l],r[c],a.loop);if(!e.segments){o.push({source:a,target:u,start:r[l],end:r[c]});continue}const d=$me(e,u);for(const f of d){const m=wz(i,s[f.start],s[f.end],f.loop),g=Ame(a,r,m);for(const y of g)o.push({source:y,target:f,start:{[i]:cX(u,m,"start",Math.max)},end:{[i]:cX(u,m,"end",Math.min)}})}}return o}function wz(t,e,i,n){if(n)return;let r=e[t],s=i[t];return t==="angle"&&(r=da(r),s=da(s)),{property:t,start:r,end:s}}function Vnt(t,e){const{x:i=null,y:n=null}=t||{},r=e.points,s=[];return e.segments.forEach(({start:o,end:a})=>{a=OB(o,a,r);const l=r[o],c=r[a];n!==null?(s.push({x:l.x,y:n}),s.push({x:c.x,y:n})):i!==null&&(s.push({x:i,y:l.y}),s.push({x:i,y:c.y}))}),s}function OB(t,e,i){for(;e>t;e--){const n=i[e];if(!isNaN(n.x)&&!isNaN(n.y))break}return e}function cX(t,e,i,n){return t&&e?n(t[i],e[i]):t?t[i]:e?e[i]:0}function Zme(t,e){let i=[],n=!1;return Ui(t)?(n=!0,i=t):i=Vnt(t,e),i.length?new wf({points:i,options:{tension:0},_loop:n,_fullLoop:n}):null}function uX(t){return t&&t.fill!==!1}function jnt(t,e,i){let r=t[e].fill;const s=[e];let o;if(!i)return r;for(;r!==!1&&s.indexOf(r)===-1;){if(!In(r))return r;if(o=t[r],!o)return!1;if(o.visible)return r;s.push(r),r=o.fill}return!1}function Bnt(t,e,i){const n=qnt(t);if(Et(n))return isNaN(n.value)?!1:n;let r=parseFloat(n);return In(r)&&Math.floor(r)===r?Unt(n[0],e,r,i):["origin","start","end","stack","shape"].indexOf(n)>=0&&n}function Unt(t,e,i,n){return(t==="-"||t==="+")&&(i=e+i),i===e||i<0||i>=n?!1:i}function Gnt(t,e){let i=null;return t==="start"?i=e.bottom:t==="end"?i=e.top:Et(t)?i=e.getPixelForValue(t.value):e.getBasePixel&&(i=e.getBasePixel()),i}function Hnt(t,e,i){let n;return t==="start"?n=i:t==="end"?n=e.options.reverse?e.min:e.max:Et(t)?n=t.value:n=e.getBaseValue(),n}function qnt(t){const e=t.options,i=e.fill;let n=it(i&&i.target,i);return n===void 0&&(n=!!e.backgroundColor),n===!1||n===null?!1:n===!0?"origin":n}function Wnt(t){const{scale:e,index:i,line:n}=t,r=[],s=n.segments,o=n.points,a=Jnt(e,i);a.push(Zme({x:null,y:e.bottom},n));for(let l=0;l<s.length;l++){const c=s[l];for(let u=c.start;u<=c.end;u++)Znt(r,o[u],a)}return new wf({points:r,options:{}})}function Jnt(t,e){const i=[],n=t.getMatchingVisibleMetas("line");for(let r=0;r<n.length;r++){const s=n[r];if(s.index===e)break;s.hidden||i.unshift(s.dataset)}return i}function Znt(t,e,i){const n=[];for(let r=0;r<i.length;r++){const s=i[r],{first:o,last:a,point:l}=Ynt(s,e,"x");if(!(!l||o&&a)){if(o)n.unshift(l);else if(t.push(l),!a)break}}t.push(...n)}function Ynt(t,e,i){const n=t.interpolate(e,i);if(!n)return{};const r=n[i],s=t.segments,o=t.points;let a=!1,l=!1;for(let c=0;c<s.length;c++){const u=s[c],d=o[u.start][i],f=o[u.end][i];if(Vh(r,d,f)){a=r===d,l=r===f;break}}return{first:a,last:l,point:n}}class Yme{constructor(e){this.x=e.x,this.y=e.y,this.radius=e.radius}pathSegment(e,i,n){const{x:r,y:s,radius:o}=this;return i=i||{start:0,end:Hi},e.arc(r,s,o,i.end,i.start,!0),!n.bounds}interpolate(e){const{x:i,y:n,radius:r}=this,s=e.angle;return{x:i+Math.cos(s)*r,y:n+Math.sin(s)*r,angle:s}}}function Xnt(t){const{chart:e,fill:i,line:n}=t;if(In(i))return Knt(e,i);if(i==="stack")return Wnt(t);if(i==="shape")return!0;const r=Qnt(t);return r instanceof Yme?r:Zme(r,n)}function Knt(t,e){const i=t.getDatasetMeta(e);return i&&t.isDatasetVisible(e)?i.dataset:null}function Qnt(t){return(t.scale||{}).getPointPositionForValue?trt(t):ert(t)}function ert(t){const{scale:e={},fill:i}=t,n=Gnt(i,e);if(In(n)){const r=e.isHorizontal();return{x:r?n:null,y:r?null:n}}return null}function trt(t){const{scale:e,fill:i}=t,n=e.options,r=e.getLabels().length,s=n.reverse?e.max:e.min,o=Hnt(i,e,s),a=[];if(n.grid.circular){const l=e.getPointPositionForValue(0,s);return new Yme({x:l.x,y:l.y,radius:e.getDistanceFromCenterForValue(o)})}for(let l=0;l<r;++l)a.push(e.getPointPositionForValue(l,o));return a}function GL(t,e,i){const n=Xnt(e),{line:r,scale:s,axis:o}=e,a=r.options,l=a.fill,c=a.backgroundColor,{above:u=c,below:d=c}=l||{};n&&r.points.length&&(Rk(t,i),irt(t,{line:r,target:n,above:u,below:d,area:i,scale:s,axis:o}),Dk(t))}function irt(t,e){const{line:i,target:n,above:r,below:s,area:o,scale:a}=e,l=i._loop?"angle":e.axis;t.save(),l==="x"&&s!==r&&(hX(t,n,o.top),dX(t,{line:i,target:n,color:r,scale:a,property:l}),t.restore(),t.save(),hX(t,n,o.bottom)),dX(t,{line:i,target:n,color:s,scale:a,property:l}),t.restore()}function hX(t,e,i){const{segments:n,points:r}=e;let s=!0,o=!1;t.beginPath();for(const a of n){const{start:l,end:c}=a,u=r[l],d=r[OB(l,c,r)];s?(t.moveTo(u.x,u.y),s=!1):(t.lineTo(u.x,i),t.lineTo(u.x,u.y)),o=!!e.pathSegment(t,a,{move:o}),o?t.closePath():t.lineTo(d.x,i)}t.lineTo(e.first().x,i),t.closePath(),t.clip()}function dX(t,e){const{line:i,target:n,property:r,color:s,scale:o}=e,a=znt(i,n,r);for(const{source:l,target:c,start:u,end:d}of a){const{style:{backgroundColor:f=s}={}}=l,m=n!==!0;t.save(),t.fillStyle=f,nrt(t,o,m&&wz(r,u,d)),t.beginPath();const g=!!i.pathSegment(t,l);let y;if(m){g?t.closePath():pX(t,n,d,r);const _=!!n.pathSegment(t,c,{move:g,reverse:!0});y=g&&_,y||pX(t,n,u,r)}t.closePath(),t.fill(y?"evenodd":"nonzero"),t.restore()}}function nrt(t,e,i){const{top:n,bottom:r}=e.chart.chartArea,{property:s,start:o,end:a}=i||{};s==="x"&&(t.beginPath(),t.rect(o,n,a-o,r-n),t.clip())}function pX(t,e,i,n){const r=e.interpolate(i,n);r&&t.lineTo(r.x,r.y)}var rrt={id:"filler",afterDatasetsUpdate(t,e,i){const n=(t.data.datasets||[]).length,r=[];let s,o,a,l;for(o=0;o<n;++o)s=t.getDatasetMeta(o),a=s.dataset,l=null,a&&a.options&&a instanceof wf&&(l={visible:t.isDatasetVisible(o),index:o,fill:Bnt(a,o,n),chart:t,axis:s.controller.options.indexAxis,scale:s.vScale,line:a}),s.$filler=l,r.push(l);for(o=0;o<n;++o)l=r[o],!(!l||l.fill===!1)&&(l.fill=jnt(r,o,i.propagate))},beforeDraw(t,e,i){const n=i.drawTime==="beforeDraw",r=t.getSortedVisibleDatasetMetas(),s=t.chartArea;for(let o=r.length-1;o>=0;--o){const a=r[o].$filler;a&&(a.line.updateControlPoints(s,a.axis),n&&a.fill&&GL(t.ctx,a,s))}},beforeDatasetsDraw(t,e,i){if(i.drawTime!=="beforeDatasetsDraw")return;const n=t.getSortedVisibleDatasetMetas();for(let r=n.length-1;r>=0;--r){const s=n[r].$filler;uX(s)&&GL(t.ctx,s,t.chartArea)}},beforeDatasetDraw(t,e,i){const n=e.meta.$filler;!uX(n)||i.drawTime!=="beforeDatasetDraw"||GL(t.ctx,n,t.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const fX=(t,e)=>{let{boxHeight:i=e,boxWidth:n=e}=t;return t.usePointStyle&&(i=Math.min(i,e),n=t.pointStyleWidth||Math.min(n,e)),{boxWidth:n,boxHeight:i,itemHeight:Math.max(e,i)}},srt=(t,e)=>t!==null&&e!==null&&t.datasetIndex===e.datasetIndex&&t.index===e.index;class mX extends wd{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,i,n){this.maxWidth=e,this.maxHeight=i,this._margins=n,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let i=nt(e.generateLabels,[this.chart],this)||[];e.filter&&(i=i.filter(n=>e.filter(n,this.chart.data))),e.sort&&(i=i.sort((n,r)=>e.sort(n,r,this.chart.data))),this.options.reverse&&i.reverse(),this.legendItems=i}fit(){const{options:e,ctx:i}=this;if(!e.display){this.width=this.height=0;return}const n=e.labels,r=wr(n.font),s=r.size,o=this._computeTitleHeight(),{boxWidth:a,itemHeight:l}=fX(n,s);let c,u;i.font=r.string,this.isHorizontal()?(c=this.maxWidth,u=this._fitRows(o,s,a,l)+10):(u=this.maxHeight,c=this._fitCols(o,r,a,l)+10),this.width=Math.min(c,e.maxWidth||this.maxWidth),this.height=Math.min(u,e.maxHeight||this.maxHeight)}_fitRows(e,i,n,r){const{ctx:s,maxWidth:o,options:{labels:{padding:a}}}=this,l=this.legendHitBoxes=[],c=this.lineWidths=[0],u=r+a;let d=e;s.textAlign="left",s.textBaseline="middle";let f=-1,m=-u;return this.legendItems.forEach((g,y)=>{const _=n+i/2+s.measureText(g.text).width;(y===0||c[c.length-1]+_+2*a>o)&&(d+=u,c[c.length-(y>0?0:1)]=0,m+=u,f++),l[y]={left:0,top:m,row:f,width:_,height:r},c[c.length-1]+=_+a}),d}_fitCols(e,i,n,r){const{ctx:s,maxHeight:o,options:{labels:{padding:a}}}=this,l=this.legendHitBoxes=[],c=this.columnSizes=[],u=o-e;let d=a,f=0,m=0,g=0,y=0;return this.legendItems.forEach((_,b)=>{const{itemWidth:w,itemHeight:x}=ort(n,i,s,_,r);b>0&&m+x+2*a>u&&(d+=f+a,c.push({width:f,height:m}),g+=f+a,y++,f=m=0),l[b]={left:g,top:m,col:y,width:w,height:x},f=Math.max(f,w),m+=x+a}),d+=f,c.push({width:f,height:m}),d}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:i,options:{align:n,labels:{padding:r},rtl:s}}=this,o=J_(s,this.left,this.width);if(this.isHorizontal()){let a=0,l=Ss(n,this.left+r,this.right-this.lineWidths[a]);for(const c of i)a!==c.row&&(a=c.row,l=Ss(n,this.left+r,this.right-this.lineWidths[a])),c.top+=this.top+e+r,c.left=o.leftForLtr(o.x(l),c.width),l+=c.width+r}else{let a=0,l=Ss(n,this.top+e+r,this.bottom-this.columnSizes[a].height);for(const c of i)c.col!==a&&(a=c.col,l=Ss(n,this.top+e+r,this.bottom-this.columnSizes[a].height)),c.top=l,c.left+=this.left+r,c.left=o.leftForLtr(o.x(c.left),c.width),l+=c.height+r}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;Rk(e,this),this._draw(),Dk(e)}}_draw(){const{options:e,columnSizes:i,lineWidths:n,ctx:r}=this,{align:s,labels:o}=e,a=Mn.color,l=J_(e.rtl,this.left,this.width),c=wr(o.font),{padding:u}=o,d=c.size,f=d/2;let m;this.drawTitle(),r.textAlign=l.textAlign("left"),r.textBaseline="middle",r.lineWidth=.5,r.font=c.string;const{boxWidth:g,boxHeight:y,itemHeight:_}=fX(o,d),b=function(I,C,M){if(isNaN(g)||g<=0||isNaN(y)||y<0)return;r.save();const E=it(M.lineWidth,1);if(r.fillStyle=it(M.fillStyle,a),r.lineCap=it(M.lineCap,"butt"),r.lineDashOffset=it(M.lineDashOffset,0),r.lineJoin=it(M.lineJoin,"miter"),r.lineWidth=E,r.strokeStyle=it(M.strokeStyle,a),r.setLineDash(it(M.lineDash,[])),o.usePointStyle){const A={radius:y*Math.SQRT2/2,pointStyle:M.pointStyle,rotation:M.rotation,borderWidth:E},$=l.xPlus(I,g/2),L=C+f;yme(r,A,$,L,o.pointStyleWidth&&g)}else{const A=C+Math.max((d-y)/2,0),$=l.leftForLtr(I,g),L=Ey(M.borderRadius);r.beginPath(),Object.values(L).some(D=>D!==0)?SS(r,{x:$,y:A,w:g,h:y,radius:L}):r.rect($,A,g,y),r.fill(),E!==0&&r.stroke()}r.restore()},w=function(I,C,M){Qy(r,M.text,I,C+_/2,c,{strikethrough:M.hidden,textAlign:l.textAlign(M.textAlign)})},x=this.isHorizontal(),S=this._computeTitleHeight();x?m={x:Ss(s,this.left+u,this.right-n[0]),y:this.top+u+S,line:0}:m={x:this.left+u,y:Ss(s,this.top+S+u,this.bottom-i[0].height),line:0},Cme(this.ctx,e.textDirection);const T=_+u;this.legendItems.forEach((I,C)=>{r.strokeStyle=I.fontColor,r.fillStyle=I.fontColor;const M=r.measureText(I.text).width,E=l.textAlign(I.textAlign||(I.textAlign=o.textAlign)),A=g+f+M;let $=m.x,L=m.y;l.setWidth(this.width),x?C>0&&$+A+u>this.right&&(L=m.y+=T,m.line++,$=m.x=Ss(s,this.left+u,this.right-n[m.line])):C>0&&L+T>this.bottom&&($=m.x=$+i[m.line].width+u,m.line++,L=m.y=Ss(s,this.top+S+u,this.bottom-i[m.line].height));const D=l.x($);if(b(D,L,I),$=Met(E,$+g+f,x?$+A:this.right,e.rtl),w(l.x($),L,I),x)m.x+=A+u;else if(typeof I.text!="string"){const F=c.lineHeight;m.y+=Xme(I,F)}else m.y+=T}),Mme(this.ctx,e.textDirection)}drawTitle(){const e=this.options,i=e.title,n=wr(i.font),r=Fs(i.padding);if(!i.display)return;const s=J_(e.rtl,this.left,this.width),o=this.ctx,a=i.position,l=n.size/2,c=r.top+l;let u,d=this.left,f=this.width;if(this.isHorizontal())f=Math.max(...this.lineWidths),u=this.top+c,d=Ss(e.align,d,this.right-f);else{const g=this.columnSizes.reduce((y,_)=>Math.max(y,_.height),0);u=c+Ss(e.align,this.top,this.bottom-g-e.labels.padding-this._computeTitleHeight())}const m=Ss(a,d,d+f);o.textAlign=s.textAlign(IB(a)),o.textBaseline="middle",o.strokeStyle=i.color,o.fillStyle=i.color,o.font=n.string,Qy(o,i.text,m,u,n)}_computeTitleHeight(){const e=this.options.title,i=wr(e.font),n=Fs(e.padding);return e.display?i.lineHeight+n.height:0}_getLegendItemAt(e,i){let n,r,s;if(Vh(e,this.left,this.right)&&Vh(i,this.top,this.bottom)){for(s=this.legendHitBoxes,n=0;n<s.length;++n)if(r=s[n],Vh(e,r.left,r.left+r.width)&&Vh(i,r.top,r.top+r.height))return this.legendItems[n]}return null}handleEvent(e){const i=this.options;if(!crt(e.type,i))return;const n=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const r=this._hoveredItem,s=srt(r,n);r&&!s&&nt(i.onLeave,[e,r,this],this),this._hoveredItem=n,n&&!s&&nt(i.onHover,[e,n,this],this)}else n&&nt(i.onClick,[e,n,this],this)}}function ort(t,e,i,n,r){const s=art(n,t,e,i),o=lrt(r,n,e.lineHeight);return{itemWidth:s,itemHeight:o}}function art(t,e,i,n){let r=t.text;return r&&typeof r!="string"&&(r=r.reduce((s,o)=>s.length>o.length?s:o)),e+i.size/2+n.measureText(r).width}function lrt(t,e,i){let n=t;return typeof e.text!="string"&&(n=Xme(e,i)),n}function Xme(t,e){const i=t.text?t.text.length+.5:0;return e*i}function crt(t,e){return!!((t==="mousemove"||t==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(t==="click"||t==="mouseup"))}var urt={id:"legend",_element:mX,start(t,e,i){const n=t.legend=new mX({ctx:t.ctx,options:i,chart:t});Ps.configure(t,n,i),Ps.addBox(t,n)},stop(t){Ps.removeBox(t,t.legend),delete t.legend},beforeUpdate(t,e,i){const n=t.legend;Ps.configure(t,n,i),n.options=i},afterUpdate(t){const e=t.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(t,e){e.replay||t.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(t,e,i){const n=e.datasetIndex,r=i.chart;r.isDatasetVisible(n)?(r.hide(n),e.hidden=!0):(r.show(n),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:t=>t.chart.options.color,boxWidth:40,padding:10,generateLabels(t){const e=t.data.datasets,{labels:{usePointStyle:i,pointStyle:n,textAlign:r,color:s,useBorderRadius:o,borderRadius:a}}=t.legend.options;return t._getSortedDatasetMetas().map(l=>{const c=l.controller.getStyle(i?0:void 0),u=Fs(c.borderWidth);return{text:e[l.index].label,fillStyle:c.backgroundColor,fontColor:s,hidden:!l.visible,lineCap:c.borderCapStyle,lineDash:c.borderDash,lineDashOffset:c.borderDashOffset,lineJoin:c.borderJoinStyle,lineWidth:(u.width+u.height)/4,strokeStyle:c.borderColor,pointStyle:n||c.pointStyle,rotation:c.rotation,textAlign:r||c.textAlign,borderRadius:o&&(a||c.borderRadius),datasetIndex:l.index}},this)}},title:{color:t=>t.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:t=>!t.startsWith("on"),labels:{_scriptable:t=>!["generateLabels","filter","sort"].includes(t)}}};class LB extends wd{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,i){const n=this.options;if(this.left=0,this.top=0,!n.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=e,this.height=this.bottom=i;const r=Ui(n.text)?n.text.length:1;this._padding=Fs(n.padding);const s=r*wr(n.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=s:this.width=s}isHorizontal(){const e=this.options.position;return e==="top"||e==="bottom"}_drawArgs(e){const{top:i,left:n,bottom:r,right:s,options:o}=this,a=o.align;let l=0,c,u,d;return this.isHorizontal()?(u=Ss(a,n,s),d=i+e,c=s-n):(o.position==="left"?(u=n+e,d=Ss(a,r,i),l=ln*-.5):(u=s-e,d=Ss(a,i,r),l=ln*.5),c=r-i),{titleX:u,titleY:d,maxWidth:c,rotation:l}}draw(){const e=this.ctx,i=this.options;if(!i.display)return;const n=wr(i.font),s=n.lineHeight/2+this._padding.top,{titleX:o,titleY:a,maxWidth:l,rotation:c}=this._drawArgs(s);Qy(e,i.text,0,0,n,{color:i.color,maxWidth:l,rotation:c,textAlign:IB(i.align),textBaseline:"middle",translation:[o,a]})}}function hrt(t,e){const i=new LB({ctx:t.ctx,options:e,chart:t});Ps.configure(t,i,e),Ps.addBox(t,i),t.titleBlock=i}var drt={id:"title",_element:LB,start(t,e,i){hrt(t,i)},stop(t){const e=t.titleBlock;Ps.removeBox(t,e),delete t.titleBlock},beforeUpdate(t,e,i){const n=t.titleBlock;Ps.configure(t,n,i),n.options=i},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const DC=new WeakMap;var prt={id:"subtitle",start(t,e,i){const n=new LB({ctx:t.ctx,options:i,chart:t});Ps.configure(t,n,i),Ps.addBox(t,n),DC.set(t,n)},stop(t){Ps.removeBox(t,DC.get(t)),DC.delete(t)},beforeUpdate(t,e,i){const n=DC.get(t);Ps.configure(t,n,i),n.options=i},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Ix={average(t){if(!t.length)return!1;let e,i,n=0,r=0,s=0;for(e=0,i=t.length;e<i;++e){const o=t[e].element;if(o&&o.hasValue()){const a=o.tooltipPosition();n+=a.x,r+=a.y,++s}}return{x:n/s,y:r/s}},nearest(t,e){if(!t.length)return!1;let i=e.x,n=e.y,r=Number.POSITIVE_INFINITY,s,o,a;for(s=0,o=t.length;s<o;++s){const l=t[s].element;if(l&&l.hasValue()){const c=l.getCenterPoint(),u=pz(e,c);u<r&&(r=u,a=l)}}if(a){const l=a.tooltipPosition();i=l.x,n=l.y}return{x:i,y:n}}};function au(t,e){return e&&(Ui(e)?Array.prototype.push.apply(t,e):t.push(e)),t}function Ih(t){return(typeof t=="string"||t instanceof String)&&t.indexOf(`
`)>-1?t.split(`
`):t}function frt(t,e){const{element:i,datasetIndex:n,index:r}=e,s=t.getDatasetMeta(n).controller,{label:o,value:a}=s.getLabelAndValue(r);return{chart:t,label:o,parsed:s.getParsed(r),raw:t.data.datasets[n].data[r],formattedValue:a,dataset:s.getDataset(),dataIndex:r,datasetIndex:n,element:i}}function gX(t,e){const i=t.chart.ctx,{body:n,footer:r,title:s}=t,{boxWidth:o,boxHeight:a}=e,l=wr(e.bodyFont),c=wr(e.titleFont),u=wr(e.footerFont),d=s.length,f=r.length,m=n.length,g=Fs(e.padding);let y=g.height,_=0,b=n.reduce((S,T)=>S+T.before.length+T.lines.length+T.after.length,0);if(b+=t.beforeBody.length+t.afterBody.length,d&&(y+=d*c.lineHeight+(d-1)*e.titleSpacing+e.titleMarginBottom),b){const S=e.displayColors?Math.max(a,l.lineHeight):l.lineHeight;y+=m*S+(b-m)*l.lineHeight+(b-1)*e.bodySpacing}f&&(y+=e.footerMarginTop+f*u.lineHeight+(f-1)*e.footerSpacing);let w=0;const x=function(S){_=Math.max(_,i.measureText(S).width+w)};return i.save(),i.font=c.string,St(t.title,x),i.font=l.string,St(t.beforeBody.concat(t.afterBody),x),w=e.displayColors?o+2+e.boxPadding:0,St(n,S=>{St(S.before,x),St(S.lines,x),St(S.after,x)}),w=0,i.font=u.string,St(t.footer,x),i.restore(),_+=g.width,{width:_,height:y}}function mrt(t,e){const{y:i,height:n}=e;return i<n/2?"top":i>t.height-n/2?"bottom":"center"}function grt(t,e,i,n){const{x:r,width:s}=n,o=i.caretSize+i.caretPadding;if(t==="left"&&r+s+o>e.width||t==="right"&&r-s-o<0)return!0}function yrt(t,e,i,n){const{x:r,width:s}=i,{width:o,chartArea:{left:a,right:l}}=t;let c="center";return n==="center"?c=r<=(a+l)/2?"left":"right":r<=s/2?c="left":r>=o-s/2&&(c="right"),grt(c,t,e,i)&&(c="center"),c}function yX(t,e,i){const n=i.yAlign||e.yAlign||mrt(t,i);return{xAlign:i.xAlign||e.xAlign||yrt(t,e,i,n),yAlign:n}}function vrt(t,e){let{x:i,width:n}=t;return e==="right"?i-=n:e==="center"&&(i-=n/2),i}function _rt(t,e,i){let{y:n,height:r}=t;return e==="top"?n+=i:e==="bottom"?n-=r+i:n-=r/2,n}function vX(t,e,i,n){const{caretSize:r,caretPadding:s,cornerRadius:o}=t,{xAlign:a,yAlign:l}=i,c=r+s,{topLeft:u,topRight:d,bottomLeft:f,bottomRight:m}=Ey(o);let g=vrt(e,a);const y=_rt(e,l,c);return l==="center"?a==="left"?g+=c:a==="right"&&(g-=c):a==="left"?g-=Math.max(u,f)+r:a==="right"&&(g+=Math.max(d,m)+r),{x:zr(g,0,n.width-e.width),y:zr(y,0,n.height-e.height)}}function NC(t,e,i){const n=Fs(i.padding);return e==="center"?t.x+t.width/2:e==="right"?t.x+t.width-n.right:t.x+n.left}function _X(t){return au([],Ih(t))}function brt(t,e,i){return rm(t,{tooltip:e,tooltipItems:i,type:"tooltip"})}function bX(t,e){const i=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return i?t.override(i):t}const Kme={beforeTitle:Qu,title(t){if(t.length>0){const e=t[0],i=e.chart.data.labels,n=i?i.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(n>0&&e.dataIndex<n)return i[e.dataIndex]}return""},afterTitle:Qu,beforeBody:Qu,beforeLabel:Qu,label(t){if(this&&this.options&&this.options.mode==="dataset")return t.label+": "+t.formattedValue||t.formattedValue;let e=t.dataset.label||"";e&&(e+=": ");const i=t.formattedValue;return zt(i)||(e+=i),e},labelColor(t){const i=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{borderColor:i.borderColor,backgroundColor:i.backgroundColor,borderWidth:i.borderWidth,borderDash:i.borderDash,borderDashOffset:i.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(t){const i=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{pointStyle:i.pointStyle,rotation:i.rotation}},afterLabel:Qu,afterBody:Qu,beforeFooter:Qu,footer:Qu,afterFooter:Qu};function mo(t,e,i,n){const r=t[e].call(i,n);return typeof r>"u"?Kme[e].call(i,n):r}class xz extends wd{constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const i=this.chart,n=this.options.setContext(this.getContext()),r=n.enabled&&i.options.animation&&n.animations,s=new Pme(this.chart,r);return r._cacheable&&(this._cachedAnimations=Object.freeze(s)),s}getContext(){return this.$context||(this.$context=brt(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,i){const{callbacks:n}=i,r=mo(n,"beforeTitle",this,e),s=mo(n,"title",this,e),o=mo(n,"afterTitle",this,e);let a=[];return a=au(a,Ih(r)),a=au(a,Ih(s)),a=au(a,Ih(o)),a}getBeforeBody(e,i){return _X(mo(i.callbacks,"beforeBody",this,e))}getBody(e,i){const{callbacks:n}=i,r=[];return St(e,s=>{const o={before:[],lines:[],after:[]},a=bX(n,s);au(o.before,Ih(mo(a,"beforeLabel",this,s))),au(o.lines,mo(a,"label",this,s)),au(o.after,Ih(mo(a,"afterLabel",this,s))),r.push(o)}),r}getAfterBody(e,i){return _X(mo(i.callbacks,"afterBody",this,e))}getFooter(e,i){const{callbacks:n}=i,r=mo(n,"beforeFooter",this,e),s=mo(n,"footer",this,e),o=mo(n,"afterFooter",this,e);let a=[];return a=au(a,Ih(r)),a=au(a,Ih(s)),a=au(a,Ih(o)),a}_createItems(e){const i=this._active,n=this.chart.data,r=[],s=[],o=[];let a=[],l,c;for(l=0,c=i.length;l<c;++l)a.push(frt(this.chart,i[l]));return e.filter&&(a=a.filter((u,d,f)=>e.filter(u,d,f,n))),e.itemSort&&(a=a.sort((u,d)=>e.itemSort(u,d,n))),St(a,u=>{const d=bX(e.callbacks,u);r.push(mo(d,"labelColor",this,u)),s.push(mo(d,"labelPointStyle",this,u)),o.push(mo(d,"labelTextColor",this,u))}),this.labelColors=r,this.labelPointStyles=s,this.labelTextColors=o,this.dataPoints=a,a}update(e,i){const n=this.options.setContext(this.getContext()),r=this._active;let s,o=[];if(!r.length)this.opacity!==0&&(s={opacity:0});else{const a=Ix[n.position].call(this,r,this._eventPosition);o=this._createItems(n),this.title=this.getTitle(o,n),this.beforeBody=this.getBeforeBody(o,n),this.body=this.getBody(o,n),this.afterBody=this.getAfterBody(o,n),this.footer=this.getFooter(o,n);const l=this._size=gX(this,n),c=Object.assign({},a,l),u=yX(this.chart,n,c),d=vX(n,c,u,this.chart);this.xAlign=u.xAlign,this.yAlign=u.yAlign,s={opacity:1,x:d.x,y:d.y,width:l.width,height:l.height,caretX:a.x,caretY:a.y}}this._tooltipItems=o,this.$context=void 0,s&&this._resolveAnimations().update(this,s),e&&n.external&&n.external.call(this,{chart:this.chart,tooltip:this,replay:i})}drawCaret(e,i,n,r){const s=this.getCaretPosition(e,n,r);i.lineTo(s.x1,s.y1),i.lineTo(s.x2,s.y2),i.lineTo(s.x3,s.y3)}getCaretPosition(e,i,n){const{xAlign:r,yAlign:s}=this,{caretSize:o,cornerRadius:a}=n,{topLeft:l,topRight:c,bottomLeft:u,bottomRight:d}=Ey(a),{x:f,y:m}=e,{width:g,height:y}=i;let _,b,w,x,S,T;return s==="center"?(S=m+y/2,r==="left"?(_=f,b=_-o,x=S+o,T=S-o):(_=f+g,b=_+o,x=S-o,T=S+o),w=_):(r==="left"?b=f+Math.max(l,u)+o:r==="right"?b=f+g-Math.max(c,d)-o:b=this.caretX,s==="top"?(x=m,S=x-o,_=b-o,w=b+o):(x=m+y,S=x+o,_=b+o,w=b-o),T=x),{x1:_,x2:b,x3:w,y1:x,y2:S,y3:T}}drawTitle(e,i,n){const r=this.title,s=r.length;let o,a,l;if(s){const c=J_(n.rtl,this.x,this.width);for(e.x=NC(this,n.titleAlign,n),i.textAlign=c.textAlign(n.titleAlign),i.textBaseline="middle",o=wr(n.titleFont),a=n.titleSpacing,i.fillStyle=n.titleColor,i.font=o.string,l=0;l<s;++l)i.fillText(r[l],c.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+a,l+1===s&&(e.y+=n.titleMarginBottom-a)}}_drawColorBox(e,i,n,r,s){const o=this.labelColors[n],a=this.labelPointStyles[n],{boxHeight:l,boxWidth:c}=s,u=wr(s.bodyFont),d=NC(this,"left",s),f=r.x(d),m=l<u.lineHeight?(u.lineHeight-l)/2:0,g=i.y+m;if(s.usePointStyle){const y={radius:Math.min(c,l)/2,pointStyle:a.pointStyle,rotation:a.rotation,borderWidth:1},_=r.leftForLtr(f,c)+c/2,b=g+l/2;e.strokeStyle=s.multiKeyBackground,e.fillStyle=s.multiKeyBackground,mz(e,y,_,b),e.strokeStyle=o.borderColor,e.fillStyle=o.backgroundColor,mz(e,y,_,b)}else{e.lineWidth=Et(o.borderWidth)?Math.max(...Object.values(o.borderWidth)):o.borderWidth||1,e.strokeStyle=o.borderColor,e.setLineDash(o.borderDash||[]),e.lineDashOffset=o.borderDashOffset||0;const y=r.leftForLtr(f,c),_=r.leftForLtr(r.xPlus(f,1),c-2),b=Ey(o.borderRadius);Object.values(b).some(w=>w!==0)?(e.beginPath(),e.fillStyle=s.multiKeyBackground,SS(e,{x:y,y:g,w:c,h:l,radius:b}),e.fill(),e.stroke(),e.fillStyle=o.backgroundColor,e.beginPath(),SS(e,{x:_,y:g+1,w:c-2,h:l-2,radius:b}),e.fill()):(e.fillStyle=s.multiKeyBackground,e.fillRect(y,g,c,l),e.strokeRect(y,g,c,l),e.fillStyle=o.backgroundColor,e.fillRect(_,g+1,c-2,l-2))}e.fillStyle=this.labelTextColors[n]}drawBody(e,i,n){const{body:r}=this,{bodySpacing:s,bodyAlign:o,displayColors:a,boxHeight:l,boxWidth:c,boxPadding:u}=n,d=wr(n.bodyFont);let f=d.lineHeight,m=0;const g=J_(n.rtl,this.x,this.width),y=function(M){i.fillText(M,g.x(e.x+m),e.y+f/2),e.y+=f+s},_=g.textAlign(o);let b,w,x,S,T,I,C;for(i.textAlign=o,i.textBaseline="middle",i.font=d.string,e.x=NC(this,_,n),i.fillStyle=n.bodyColor,St(this.beforeBody,y),m=a&&_!=="right"?o==="center"?c/2+u:c+2+u:0,S=0,I=r.length;S<I;++S){for(b=r[S],w=this.labelTextColors[S],i.fillStyle=w,St(b.before,y),x=b.lines,a&&x.length&&(this._drawColorBox(i,e,S,g,n),f=Math.max(d.lineHeight,l)),T=0,C=x.length;T<C;++T)y(x[T]),f=d.lineHeight;St(b.after,y)}m=0,f=d.lineHeight,St(this.afterBody,y),e.y-=s}drawFooter(e,i,n){const r=this.footer,s=r.length;let o,a;if(s){const l=J_(n.rtl,this.x,this.width);for(e.x=NC(this,n.footerAlign,n),e.y+=n.footerMarginTop,i.textAlign=l.textAlign(n.footerAlign),i.textBaseline="middle",o=wr(n.footerFont),i.fillStyle=n.footerColor,i.font=o.string,a=0;a<s;++a)i.fillText(r[a],l.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+n.footerSpacing}}drawBackground(e,i,n,r){const{xAlign:s,yAlign:o}=this,{x:a,y:l}=e,{width:c,height:u}=n,{topLeft:d,topRight:f,bottomLeft:m,bottomRight:g}=Ey(r.cornerRadius);i.fillStyle=r.backgroundColor,i.strokeStyle=r.borderColor,i.lineWidth=r.borderWidth,i.beginPath(),i.moveTo(a+d,l),o==="top"&&this.drawCaret(e,i,n,r),i.lineTo(a+c-f,l),i.quadraticCurveTo(a+c,l,a+c,l+f),o==="center"&&s==="right"&&this.drawCaret(e,i,n,r),i.lineTo(a+c,l+u-g),i.quadraticCurveTo(a+c,l+u,a+c-g,l+u),o==="bottom"&&this.drawCaret(e,i,n,r),i.lineTo(a+m,l+u),i.quadraticCurveTo(a,l+u,a,l+u-m),o==="center"&&s==="left"&&this.drawCaret(e,i,n,r),i.lineTo(a,l+d),i.quadraticCurveTo(a,l,a+d,l),i.closePath(),i.fill(),r.borderWidth>0&&i.stroke()}_updateAnimationTarget(e){const i=this.chart,n=this.$animations,r=n&&n.x,s=n&&n.y;if(r||s){const o=Ix[e.position].call(this,this._active,this._eventPosition);if(!o)return;const a=this._size=gX(this,e),l=Object.assign({},o,this._size),c=yX(i,e,l),u=vX(e,l,c,i);(r._to!==u.x||s._to!==u.y)&&(this.xAlign=c.xAlign,this.yAlign=c.yAlign,this.width=a.width,this.height=a.height,this.caretX=o.x,this.caretY=o.y,this._resolveAnimations().update(this,u))}}_willRender(){return!!this.opacity}draw(e){const i=this.options.setContext(this.getContext());let n=this.opacity;if(!n)return;this._updateAnimationTarget(i);const r={width:this.width,height:this.height},s={x:this.x,y:this.y};n=Math.abs(n)<.001?0:n;const o=Fs(i.padding),a=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;i.enabled&&a&&(e.save(),e.globalAlpha=n,this.drawBackground(s,e,r,i),Cme(e,i.textDirection),s.y+=o.top,this.drawTitle(s,e,i),this.drawBody(s,e,i),this.drawFooter(s,e,i),Mme(e,i.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,i){const n=this._active,r=e.map(({datasetIndex:a,index:l})=>{const c=this.chart.getDatasetMeta(a);if(!c)throw new Error("Cannot find a dataset at index "+a);return{datasetIndex:a,element:c.data[l],index:l}}),s=!R$(n,r),o=this._positionChanged(r,i);(s||o)&&(this._active=r,this._eventPosition=i,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,i,n=!0){if(i&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const r=this.options,s=this._active||[],o=this._getActiveElements(e,s,i,n),a=this._positionChanged(o,e),l=i||!R$(o,s)||a;return l&&(this._active=o,(r.enabled||r.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,i))),l}_getActiveElements(e,i,n,r){const s=this.options;if(e.type==="mouseout")return[];if(!r)return i;const o=this.chart.getElementsAtEventForMode(e,s.mode,s,n);return s.reverse&&o.reverse(),o}_positionChanged(e,i){const{caretX:n,caretY:r,options:s}=this,o=Ix[s.position].call(this,e,i);return o!==!1&&(n!==o.x||r!==o.y)}}ve(xz,"positioners",Ix);var wrt={id:"tooltip",_element:xz,positioners:Ix,afterInit(t,e,i){i&&(t.tooltip=new xz({chart:t,options:i}))},beforeUpdate(t,e,i){t.tooltip&&t.tooltip.initialize(i)},reset(t,e,i){t.tooltip&&t.tooltip.initialize(i)},afterDraw(t){const e=t.tooltip;if(e&&e._willRender()){const i={tooltip:e};if(t.notifyPlugins("beforeTooltipDraw",{...i,cancelable:!0})===!1)return;e.draw(t.ctx),t.notifyPlugins("afterTooltipDraw",i)}},afterEvent(t,e){if(t.tooltip){const i=e.replay;t.tooltip.handleEvent(e.event,i,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(t,e)=>e.bodyFont.size,boxWidth:(t,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:Kme},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:t=>t!=="filter"&&t!=="itemSort"&&t!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},xrt=Object.freeze({__proto__:null,Colors:Lnt,Decimation:Fnt,Filler:rrt,Legend:urt,SubTitle:prt,Title:drt,Tooltip:wrt});const Srt=(t,e,i,n)=>(typeof e=="string"?(i=t.push(e)-1,n.unshift({index:i,label:e})):isNaN(e)&&(i=null),i);function Trt(t,e,i,n){const r=t.indexOf(e);if(r===-1)return Srt(t,e,i,n);const s=t.lastIndexOf(e);return r!==s?i:r}const Irt=(t,e)=>t===null?null:zr(Math.round(t),0,e);function wX(t){const e=this.getLabels();return t>=0&&t<e.length?e[t]:t}class Sz extends y0{constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const i=this._addedLabels;if(i.length){const n=this.getLabels();for(const{index:r,label:s}of i)n[r]===s&&n.splice(r,1);this._addedLabels=[]}super.init(e)}parse(e,i){if(zt(e))return null;const n=this.getLabels();return i=isFinite(i)&&n[i]===e?i:Trt(n,e,it(i,e),this._addedLabels),Irt(i,n.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:i}=this.getUserBounds();let{min:n,max:r}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(n=0),i||(r=this.getLabels().length-1)),this.min=n,this.max=r}buildTicks(){const e=this.min,i=this.max,n=this.options.offset,r=[];let s=this.getLabels();s=e===0&&i===s.length-1?s:s.slice(e,i+1),this._valueRange=Math.max(s.length-(n?0:1),1),this._startValue=this.min-(n?.5:0);for(let o=e;o<=i;o++)r.push({value:o});return r}getLabelForValue(e){return wX.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const i=this.ticks;return e<0||e>i.length-1?null:this.getPixelForValue(i[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}ve(Sz,"id","category"),ve(Sz,"defaults",{ticks:{callback:wX}});function Crt(t,e){const i=[],{bounds:r,step:s,min:o,max:a,precision:l,count:c,maxTicks:u,maxDigits:d,includeBounds:f}=t,m=s||1,g=u-1,{min:y,max:_}=e,b=!zt(o),w=!zt(a),x=!zt(c),S=(_-y)/(d+1);let T=mY((_-y)/g/m)*m,I,C,M,E;if(T<1e-14&&!b&&!w)return[{value:y},{value:_}];E=Math.ceil(_/T)-Math.floor(y/T),E>g&&(T=mY(E*T/g/m)*m),zt(l)||(I=Math.pow(10,l),T=Math.ceil(T*I)/I),r==="ticks"?(C=Math.floor(y/T)*T,M=Math.ceil(_/T)*T):(C=y,M=_),b&&w&&s&&_et((a-o)/s,T/1e3)?(E=Math.round(Math.min((a-o)/T,u)),T=(a-o)/E,C=o,M=a):x?(C=b?o:C,M=w?a:M,E=c-1,T=(M-C)/E):(E=(M-C)/T,y2(E,Math.round(E),T/1e3)?E=Math.round(E):E=Math.ceil(E));const A=Math.max(gY(T),gY(C));I=Math.pow(10,zt(l)?A:l),C=Math.round(C*I)/I,M=Math.round(M*I)/I;let $=0;for(b&&(f&&C!==o?(i.push({value:o}),C<o&&$++,y2(Math.round((C+$*T)*I)/I,o,xX(o,S,t))&&$++):C<o&&$++);$<E;++$){const L=Math.round((C+$*T)*I)/I;if(w&&L>a)break;i.push({value:L})}return w&&f&&M!==a?i.length&&y2(i[i.length-1].value,a,xX(a,S,t))?i[i.length-1].value=a:i.push({value:a}):(!w||M===a)&&i.push({value:M}),i}function xX(t,e,{horizontal:i,minRotation:n}){const r=mc(n),s=(i?Math.sin(r):Math.cos(r))||.001,o=.75*e*(""+t).length;return Math.min(e/s,o)}class B$ extends y0{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,i){return zt(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:i,maxDefined:n}=this.getUserBounds();let{min:r,max:s}=this;const o=l=>r=i?r:l,a=l=>s=n?s:l;if(e){const l=hl(r),c=hl(s);l<0&&c<0?a(0):l>0&&c>0&&o(0)}if(r===s){let l=s===0?1:Math.abs(s*.05);a(s+l),e||o(r-l)}this.min=r,this.max=s}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:i,stepSize:n}=e,r;return n?(r=Math.ceil(this.max/n)-Math.floor(this.min/n)+1,r>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${n} would result generating up to ${r} ticks. Limiting to 1000.`),r=1e3)):(r=this.computeTickLimit(),i=i||11),i&&(r=Math.min(i,r)),r}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,i=e.ticks;let n=this.getTickLimit();n=Math.max(2,n);const r={maxTicks:n,bounds:e.bounds,min:e.min,max:e.max,precision:i.precision,step:i.stepSize,count:i.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:i.minRotation||0,includeBounds:i.includeBounds!==!1},s=this._range||this,o=Crt(r,s);return e.bounds==="ticks"&&lme(o,this,"value"),e.reverse?(o.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),o}configure(){const e=this.ticks;let i=this.min,n=this.max;if(super.configure(),this.options.offset&&e.length){const r=(n-i)/Math.max(e.length-1,1)/2;i-=r,n+=r}this._startValue=i,this._endValue=n,this._valueRange=n-i}getLabelForValue(e){return AT(e,this.chart.options.locale,this.options.ticks.format)}}class Tz extends B${determineDataLimits(){const{min:e,max:i}=this.getMinMax(!0);this.min=In(e)?e:0,this.max=In(i)?i:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),i=e?this.width:this.height,n=mc(this.options.ticks.minRotation),r=(e?Math.sin(n):Math.cos(n))||.001,s=this._resolveTickFontOptions(0);return Math.ceil(i/Math.min(40,s.lineHeight/r))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}ve(Tz,"id","linear"),ve(Tz,"defaults",{ticks:{callback:Lk.formatters.numeric}});const IS=t=>Math.floor(bf(t)),$m=(t,e)=>Math.pow(10,IS(t)+e);function SX(t){return t/Math.pow(10,IS(t))===1}function TX(t,e,i){const n=Math.pow(10,i),r=Math.floor(t/n);return Math.ceil(e/n)-r}function Mrt(t,e){const i=e-t;let n=IS(i);for(;TX(t,e,n)>10;)n++;for(;TX(t,e,n)<10;)n--;return Math.min(n,IS(t))}function Ert(t,{min:e,max:i}){e=ca(t.min,e);const n=[],r=IS(e);let s=Mrt(e,i),o=s<0?Math.pow(10,Math.abs(s)):1;const a=Math.pow(10,s),l=r>s?Math.pow(10,r):0,c=Math.round((e-l)*o)/o,u=Math.floor((e-l)/a/10)*a*10;let d=Math.floor((c-u)/Math.pow(10,s)),f=ca(t.min,Math.round((l+u+d*Math.pow(10,s))*o)/o);for(;f<i;)n.push({value:f,major:SX(f),significand:d}),d>=10?d=d<15?15:20:d++,d>=20&&(s++,d=2,o=s>=0?1:o),f=Math.round((l+u+d*Math.pow(10,s))*o)/o;const m=ca(t.max,f);return n.push({value:m,major:SX(m),significand:d}),n}class Iz extends y0{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(e,i){const n=B$.prototype.parse.apply(this,[e,i]);if(n===0){this._zero=!0;return}return In(n)&&n>0?n:null}determineDataLimits(){const{min:e,max:i}=this.getMinMax(!0);this.min=In(e)?Math.max(0,e):null,this.max=In(i)?Math.max(0,i):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!In(this._userMin)&&(this.min=e===$m(this.min,0)?$m(this.min,-1):$m(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:e,maxDefined:i}=this.getUserBounds();let n=this.min,r=this.max;const s=a=>n=e?n:a,o=a=>r=i?r:a;n===r&&(n<=0?(s(1),o(10)):(s($m(n,-1)),o($m(r,1)))),n<=0&&s($m(r,-1)),r<=0&&o($m(n,1)),this.min=n,this.max=r}buildTicks(){const e=this.options,i={min:this._userMin,max:this._userMax},n=Ert(i,this);return e.bounds==="ticks"&&lme(n,this,"value"),e.reverse?(n.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),n}getLabelForValue(e){return e===void 0?"0":AT(e,this.chart.options.locale,this.options.ticks.format)}configure(){const e=this.min;super.configure(),this._startValue=bf(e),this._valueRange=bf(this.max)-bf(e)}getPixelForValue(e){return(e===void 0||e===0)&&(e=this.min),e===null||isNaN(e)?NaN:this.getPixelForDecimal(e===this.min?0:(bf(e)-this._startValue)/this._valueRange)}getValueForPixel(e){const i=this.getDecimalForPixel(e);return Math.pow(10,this._startValue+i*this._valueRange)}}ve(Iz,"id","logarithmic"),ve(Iz,"defaults",{ticks:{callback:Lk.formatters.logarithmic,major:{enabled:!0}}});function Cz(t){const e=t.ticks;if(e.display&&t.display){const i=Fs(e.backdropPadding);return it(e.font&&e.font.size,Mn.font.size)+i.height}return 0}function Art(t,e,i){return i=Ui(i)?i:[i],{w:Net(t,e.string,i),h:i.length*e.lineHeight}}function IX(t,e,i,n,r){return t===n||t===r?{start:e-i/2,end:e+i/2}:t<n||t>r?{start:e-i,end:e}:{start:e,end:e+i}}function $rt(t){const e={l:t.left+t._padding.left,r:t.right-t._padding.right,t:t.top+t._padding.top,b:t.bottom-t._padding.bottom},i=Object.assign({},e),n=[],r=[],s=t._pointLabels.length,o=t.options.pointLabels,a=o.centerPointLabels?ln/s:0;for(let l=0;l<s;l++){const c=o.setContext(t.getPointLabelContext(l));r[l]=c.padding;const u=t.getPointPosition(l,t.drawingArea+r[l],a),d=wr(c.font),f=Art(t.ctx,d,t._pointLabels[l]);n[l]=f;const m=da(t.getIndexAngle(l)+a),g=Math.round(SB(m)),y=IX(g,u.x,f.w,0,180),_=IX(g,u.y,f.h,90,270);Prt(i,e,m,y,_)}t.setCenterPoint(e.l-i.l,i.r-e.r,e.t-i.t,i.b-e.b),t._pointLabelItems=Lrt(t,n,r)}function Prt(t,e,i,n,r){const s=Math.abs(Math.sin(i)),o=Math.abs(Math.cos(i));let a=0,l=0;n.start<e.l?(a=(e.l-n.start)/s,t.l=Math.min(t.l,e.l-a)):n.end>e.r&&(a=(n.end-e.r)/s,t.r=Math.max(t.r,e.r+a)),r.start<e.t?(l=(e.t-r.start)/o,t.t=Math.min(t.t,e.t-l)):r.end>e.b&&(l=(r.end-e.b)/o,t.b=Math.max(t.b,e.b+l))}function krt(t,e,i){const n=t.drawingArea,{extra:r,additionalAngle:s,padding:o,size:a}=i,l=t.getPointPosition(e,n+r+o,s),c=Math.round(SB(da(l.angle+Cn))),u=Nrt(l.y,a.h,c),d=Rrt(c),f=Drt(l.x,a.w,d);return{visible:!0,x:l.x,y:u,textAlign:d,left:f,top:u,right:f+a.w,bottom:u+a.h}}function Ort(t,e){if(!e)return!0;const{left:i,top:n,right:r,bottom:s}=t;return!(Bh({x:i,y:n},e)||Bh({x:i,y:s},e)||Bh({x:r,y:n},e)||Bh({x:r,y:s},e))}function Lrt(t,e,i){const n=[],r=t._pointLabels.length,s=t.options,{centerPointLabels:o,display:a}=s.pointLabels,l={extra:Cz(s)/2,additionalAngle:o?ln/r:0};let c;for(let u=0;u<r;u++){l.padding=i[u],l.size=e[u];const d=krt(t,u,l);n.push(d),a==="auto"&&(d.visible=Ort(d,c),d.visible&&(c=d))}return n}function Rrt(t){return t===0||t===180?"center":t<180?"left":"right"}function Drt(t,e,i){return i==="right"?t-=e:i==="center"&&(t-=e/2),t}function Nrt(t,e,i){return i===90||i===270?t-=e/2:(i>270||i<90)&&(t-=e),t}function Frt(t,e,i){const{left:n,top:r,right:s,bottom:o}=i,{backdropColor:a}=e;if(!zt(a)){const l=Ey(e.borderRadius),c=Fs(e.backdropPadding);t.fillStyle=a;const u=n-c.left,d=r-c.top,f=s-n+c.width,m=o-r+c.height;Object.values(l).some(g=>g!==0)?(t.beginPath(),SS(t,{x:u,y:d,w:f,h:m,radius:l}),t.fill()):t.fillRect(u,d,f,m)}}function zrt(t,e){const{ctx:i,options:{pointLabels:n}}=t;for(let r=e-1;r>=0;r--){const s=t._pointLabelItems[r];if(!s.visible)continue;const o=n.setContext(t.getPointLabelContext(r));Frt(i,o,s);const a=wr(o.font),{x:l,y:c,textAlign:u}=s;Qy(i,t._pointLabels[r],l,c+a.lineHeight/2,a,{color:o.color,textAlign:u,textBaseline:"middle"})}}function Qme(t,e,i,n){const{ctx:r}=t;if(i)r.arc(t.xCenter,t.yCenter,e,0,Hi);else{let s=t.getPointPosition(0,e);r.moveTo(s.x,s.y);for(let o=1;o<n;o++)s=t.getPointPosition(o,e),r.lineTo(s.x,s.y)}}function Vrt(t,e,i,n,r){const s=t.ctx,o=e.circular,{color:a,lineWidth:l}=e;!o&&!n||!a||!l||i<0||(s.save(),s.strokeStyle=a,s.lineWidth=l,s.setLineDash(r.dash),s.lineDashOffset=r.dashOffset,s.beginPath(),Qme(t,i,o,n),s.closePath(),s.stroke(),s.restore())}function jrt(t,e,i){return rm(t,{label:i,index:e,type:"pointLabel"})}class Cx extends B${constructor(e){super(e),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const e=this._padding=Fs(Cz(this.options)/2),i=this.width=this.maxWidth-e.width,n=this.height=this.maxHeight-e.height;this.xCenter=Math.floor(this.left+i/2+e.left),this.yCenter=Math.floor(this.top+n/2+e.top),this.drawingArea=Math.floor(Math.min(i,n)/2)}determineDataLimits(){const{min:e,max:i}=this.getMinMax(!1);this.min=In(e)&&!isNaN(e)?e:0,this.max=In(i)&&!isNaN(i)?i:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/Cz(this.options))}generateTickLabels(e){B$.prototype.generateTickLabels.call(this,e),this._pointLabels=this.getLabels().map((i,n)=>{const r=nt(this.options.pointLabels.callback,[i,n],this);return r||r===0?r:""}).filter((i,n)=>this.chart.getDataVisibility(n))}fit(){const e=this.options;e.display&&e.pointLabels.display?$rt(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(e,i,n,r){this.xCenter+=Math.floor((e-i)/2),this.yCenter+=Math.floor((n-r)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(e,i,n,r))}getIndexAngle(e){const i=Hi/(this._pointLabels.length||1),n=this.options.startAngle||0;return da(e*i+mc(n))}getDistanceFromCenterForValue(e){if(zt(e))return NaN;const i=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-e)*i:(e-this.min)*i}getValueForDistanceFromCenter(e){if(zt(e))return NaN;const i=e/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-i:this.min+i}getPointLabelContext(e){const i=this._pointLabels||[];if(e>=0&&e<i.length){const n=i[e];return jrt(this.getContext(),e,n)}}getPointPosition(e,i,n=0){const r=this.getIndexAngle(e)-Cn+n;return{x:Math.cos(r)*i+this.xCenter,y:Math.sin(r)*i+this.yCenter,angle:r}}getPointPositionForValue(e,i){return this.getPointPosition(e,this.getDistanceFromCenterForValue(i))}getBasePosition(e){return this.getPointPositionForValue(e||0,this.getBaseValue())}getPointLabelPosition(e){const{left:i,top:n,right:r,bottom:s}=this._pointLabelItems[e];return{left:i,top:n,right:r,bottom:s}}drawBackground(){const{backgroundColor:e,grid:{circular:i}}=this.options;if(e){const n=this.ctx;n.save(),n.beginPath(),Qme(this,this.getDistanceFromCenterForValue(this._endValue),i,this._pointLabels.length),n.closePath(),n.fillStyle=e,n.fill(),n.restore()}}drawGrid(){const e=this.ctx,i=this.options,{angleLines:n,grid:r,border:s}=i,o=this._pointLabels.length;let a,l,c;if(i.pointLabels.display&&zrt(this,o),r.display&&this.ticks.forEach((u,d)=>{if(d!==0){l=this.getDistanceFromCenterForValue(u.value);const f=this.getContext(d),m=r.setContext(f),g=s.setContext(f);Vrt(this,m,l,o,g)}}),n.display){for(e.save(),a=o-1;a>=0;a--){const u=n.setContext(this.getPointLabelContext(a)),{color:d,lineWidth:f}=u;!f||!d||(e.lineWidth=f,e.strokeStyle=d,e.setLineDash(u.borderDash),e.lineDashOffset=u.borderDashOffset,l=this.getDistanceFromCenterForValue(i.ticks.reverse?this.min:this.max),c=this.getPointPosition(a,l),e.beginPath(),e.moveTo(this.xCenter,this.yCenter),e.lineTo(c.x,c.y),e.stroke())}e.restore()}}drawBorder(){}drawLabels(){const e=this.ctx,i=this.options,n=i.ticks;if(!n.display)return;const r=this.getIndexAngle(0);let s,o;e.save(),e.translate(this.xCenter,this.yCenter),e.rotate(r),e.textAlign="center",e.textBaseline="middle",this.ticks.forEach((a,l)=>{if(l===0&&!i.reverse)return;const c=n.setContext(this.getContext(l)),u=wr(c.font);if(s=this.getDistanceFromCenterForValue(this.ticks[l].value),c.showLabelBackdrop){e.font=u.string,o=e.measureText(a.label).width,e.fillStyle=c.backdropColor;const d=Fs(c.backdropPadding);e.fillRect(-o/2-d.left,-s-u.size/2-d.top,o+d.width,u.size+d.height)}Qy(e,a.label,0,-s,u,{color:c.color})}),e.restore()}drawTitle(){}}ve(Cx,"id","radialLinear"),ve(Cx,"defaults",{display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:Lk.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(e){return e},padding:5,centerPointLabels:!1}}),ve(Cx,"defaultRoutes",{"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"}),ve(Cx,"descriptors",{angleLines:{_fallback:"grid"}});const Fk={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Oo=Object.keys(Fk);function Brt(t,e){return t-e}function CX(t,e){if(zt(e))return null;const i=t._adapter,{parser:n,round:r,isoWeekday:s}=t._parseOpts;let o=e;return typeof n=="function"&&(o=n(o)),In(o)||(o=typeof n=="string"?i.parse(o,n):i.parse(o)),o===null?null:(r&&(o=r==="week"&&(Eb(s)||s===!0)?i.startOf(o,"isoWeek",s):i.startOf(o,r)),+o)}function MX(t,e,i,n){const r=Oo.length;for(let s=Oo.indexOf(t);s<r-1;++s){const o=Fk[Oo[s]],a=o.steps?o.steps:Number.MAX_SAFE_INTEGER;if(o.common&&Math.ceil((i-e)/(a*o.size))<=n)return Oo[s]}return Oo[r-1]}function Urt(t,e,i,n,r){for(let s=Oo.length-1;s>=Oo.indexOf(i);s--){const o=Oo[s];if(Fk[o].common&&t._adapter.diff(r,n,o)>=e-1)return o}return Oo[i?Oo.indexOf(i):0]}function Grt(t){for(let e=Oo.indexOf(t)+1,i=Oo.length;e<i;++e)if(Fk[Oo[e]].common)return Oo[e]}function EX(t,e,i){if(!i)t[e]=!0;else if(i.length){const{lo:n,hi:r}=TB(i,e),s=i[n]>=e?i[n]:i[r];t[s]=!0}}function Hrt(t,e,i,n){const r=t._adapter,s=+r.startOf(e[0].value,n),o=e[e.length-1].value;let a,l;for(a=s;a<=o;a=+r.add(a,1,n))l=i[a],l>=0&&(e[l].major=!0);return e}function AX(t,e,i){const n=[],r={},s=e.length;let o,a;for(o=0;o<s;++o)a=e[o],r[a]=o,n.push({value:a,major:!1});return s===0||!i?n:Hrt(t,n,r,i)}class CS extends y0{constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,i={}){const n=e.time||(e.time={}),r=this._adapter=new Qtt._date(e.adapters.date);r.init(i),g2(n.displayFormats,r.formats()),this._parseOpts={parser:n.parser,round:n.round,isoWeekday:n.isoWeekday},super.init(e),this._normalized=i.normalized}parse(e,i){return e===void 0?null:CX(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,i=this._adapter,n=e.time.unit||"day";let{min:r,max:s,minDefined:o,maxDefined:a}=this.getUserBounds();function l(c){!o&&!isNaN(c.min)&&(r=Math.min(r,c.min)),!a&&!isNaN(c.max)&&(s=Math.max(s,c.max))}(!o||!a)&&(l(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&l(this.getMinMax(!1))),r=In(r)&&!isNaN(r)?r:+i.startOf(Date.now(),n),s=In(s)&&!isNaN(s)?s:+i.endOf(Date.now(),n)+1,this.min=Math.min(r,s-1),this.max=Math.max(r+1,s)}_getLabelBounds(){const e=this.getLabelTimestamps();let i=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY;return e.length&&(i=e[0],n=e[e.length-1]),{min:i,max:n}}buildTicks(){const e=this.options,i=e.time,n=e.ticks,r=n.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&r.length&&(this.min=this._userMin||r[0],this.max=this._userMax||r[r.length-1]);const s=this.min,o=this.max,a=Tet(r,s,o);return this._unit=i.unit||(n.autoSkip?MX(i.minUnit,this.min,this.max,this._getLabelCapacity(s)):Urt(this,a.length,i.minUnit,this.min,this.max)),this._majorUnit=!n.major.enabled||this._unit==="year"?void 0:Grt(this._unit),this.initOffsets(r),e.reverse&&a.reverse(),AX(this,a,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let i=0,n=0,r,s;this.options.offset&&e.length&&(r=this.getDecimalForValue(e[0]),e.length===1?i=1-r:i=(this.getDecimalForValue(e[1])-r)/2,s=this.getDecimalForValue(e[e.length-1]),e.length===1?n=s:n=(s-this.getDecimalForValue(e[e.length-2]))/2);const o=e.length<3?.5:.25;i=zr(i,0,o),n=zr(n,0,o),this._offsets={start:i,end:n,factor:1/(i+1+n)}}_generate(){const e=this._adapter,i=this.min,n=this.max,r=this.options,s=r.time,o=s.unit||MX(s.minUnit,i,n,this._getLabelCapacity(i)),a=it(r.ticks.stepSize,1),l=o==="week"?s.isoWeekday:!1,c=Eb(l)||l===!0,u={};let d=i,f,m;if(c&&(d=+e.startOf(d,"isoWeek",l)),d=+e.startOf(d,c?"day":o),e.diff(n,i,o)>1e5*a)throw new Error(i+" and "+n+" are too far apart with stepSize of "+a+" "+o);const g=r.ticks.source==="data"&&this.getDataTimestamps();for(f=d,m=0;f<n;f=+e.add(f,a,o),m++)EX(u,f,g);return(f===n||r.bounds==="ticks"||m===1)&&EX(u,f,g),Object.keys(u).sort((y,_)=>y-_).map(y=>+y)}getLabelForValue(e){const i=this._adapter,n=this.options.time;return n.tooltipFormat?i.format(e,n.tooltipFormat):i.format(e,n.displayFormats.datetime)}format(e,i){const r=this.options.time.displayFormats,s=this._unit,o=i||r[s];return this._adapter.format(e,o)}_tickFormatFunction(e,i,n,r){const s=this.options,o=s.ticks.callback;if(o)return nt(o,[e,i,n],this);const a=s.time.displayFormats,l=this._unit,c=this._majorUnit,u=l&&a[l],d=c&&a[c],f=n[i],m=c&&d&&f&&f.major;return this._adapter.format(e,r||(m?d:u))}generateTickLabels(e){let i,n,r;for(i=0,n=e.length;i<n;++i)r=e[i],r.label=this._tickFormatFunction(r.value,i,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const i=this._offsets,n=this.getDecimalForValue(e);return this.getPixelForDecimal((i.start+n)*i.factor)}getValueForPixel(e){const i=this._offsets,n=this.getDecimalForPixel(e)/i.factor-i.end;return this.min+n*(this.max-this.min)}_getLabelSize(e){const i=this.options.ticks,n=this.ctx.measureText(e).width,r=mc(this.isHorizontal()?i.maxRotation:i.minRotation),s=Math.cos(r),o=Math.sin(r),a=this._resolveTickFontOptions(0).size;return{w:n*s+a*o,h:n*o+a*s}}_getLabelCapacity(e){const i=this.options.time,n=i.displayFormats,r=n[i.unit]||n.millisecond,s=this._tickFormatFunction(e,0,AX(this,[e],this._majorUnit),r),o=this._getLabelSize(s),a=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h)-1;return a>0?a:1}getDataTimestamps(){let e=this._cache.data||[],i,n;if(e.length)return e;const r=this.getMatchingVisibleMetas();if(this._normalized&&r.length)return this._cache.data=r[0].controller.getAllParsedValues(this);for(i=0,n=r.length;i<n;++i)e=e.concat(r[i].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let i,n;if(e.length)return e;const r=this.getLabels();for(i=0,n=r.length;i<n;++i)e.push(CX(this,r[i]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return hme(e.sort(Brt))}}ve(CS,"id","time"),ve(CS,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function FC(t,e,i){let n=0,r=t.length-1,s,o,a,l;i?(e>=t[n].pos&&e<=t[r].pos&&({lo:n,hi:r}=jh(t,"pos",e)),{pos:s,time:a}=t[n],{pos:o,time:l}=t[r]):(e>=t[n].time&&e<=t[r].time&&({lo:n,hi:r}=jh(t,"time",e)),{time:s,pos:a}=t[n],{time:o,pos:l}=t[r]);const c=o-s;return c?a+(l-a)*(e-s)/c:a}class Mz extends CS{constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),i=this._table=this.buildLookupTable(e);this._minPos=FC(i,this.min),this._tableRange=FC(i,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:i,max:n}=this,r=[],s=[];let o,a,l,c,u;for(o=0,a=e.length;o<a;++o)c=e[o],c>=i&&c<=n&&r.push(c);if(r.length<2)return[{time:i,pos:0},{time:n,pos:1}];for(o=0,a=r.length;o<a;++o)u=r[o+1],l=r[o-1],c=r[o],Math.round((u+l)/2)!==c&&s.push({time:c,pos:o/(a-1)});return s}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const i=this.getDataTimestamps(),n=this.getLabelTimestamps();return i.length&&n.length?e=this.normalize(i.concat(n)):e=i.length?i:n,e=this._cache.all=e,e}getDecimalForValue(e){return(FC(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const i=this._offsets,n=this.getDecimalForPixel(e)/i.factor-i.end;return FC(this._table,n*this._tableRange+this._minPos,!0)}}ve(Mz,"id","timeseries"),ve(Mz,"defaults",CS.defaults);var qrt=Object.freeze({__proto__:null,CategoryScale:Sz,LinearScale:Tz,LogarithmicScale:Iz,RadialLinearScale:Cx,TimeScale:CS,TimeSeriesScale:Mz});const Wrt=[Ktt,Ent,xrt,qrt];gu.register(...Wrt);function Jrt(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var ege={exports:{}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function(t){(function(e,i,n,r){var s=["","webkit","Moz","MS","ms","o"],o=i.createElement("div"),a="function",l=Math.round,c=Math.abs,u=Date.now;function d(R,N,H){return setTimeout(x(R,H),N)}function f(R,N,H){return Array.isArray(R)?(m(R,H[N],H),!0):!1}function m(R,N,H){var te;if(R)if(R.forEach)R.forEach(N,H);else if(R.length!==r)for(te=0;te<R.length;)N.call(H,R[te],te,R),te++;else for(te in R)R.hasOwnProperty(te)&&N.call(H,R[te],te,R)}function g(R,N,H){var te="DEPRECATED METHOD: "+N+`
`+H+` AT 
`;return function(){var he=new Error("get-stack-trace"),Ce=he&&he.stack?he.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",bt=e.console&&(e.console.warn||e.console.log);return bt&&bt.call(e.console,te,Ce),R.apply(this,arguments)}}var y;typeof Object.assign!="function"?y=function(N){if(N===r||N===null)throw new TypeError("Cannot convert undefined or null to object");for(var H=Object(N),te=1;te<arguments.length;te++){var he=arguments[te];if(he!==r&&he!==null)for(var Ce in he)he.hasOwnProperty(Ce)&&(H[Ce]=he[Ce])}return H}:y=Object.assign;var _=g(function(N,H,te){for(var he=Object.keys(H),Ce=0;Ce<he.length;)(!te||te&&N[he[Ce]]===r)&&(N[he[Ce]]=H[he[Ce]]),Ce++;return N},"extend","Use `assign`."),b=g(function(N,H){return _(N,H,!0)},"merge","Use `assign`.");function w(R,N,H){var te=N.prototype,he;he=R.prototype=Object.create(te),he.constructor=R,he._super=te,H&&y(he,H)}function x(R,N){return function(){return R.apply(N,arguments)}}function S(R,N){return typeof R==a?R.apply(N&&N[0]||r,N):R}function T(R,N){return R===r?N:R}function I(R,N,H){m(A(N),function(te){R.addEventListener(te,H,!1)})}function C(R,N,H){m(A(N),function(te){R.removeEventListener(te,H,!1)})}function M(R,N){for(;R;){if(R==N)return!0;R=R.parentNode}return!1}function E(R,N){return R.indexOf(N)>-1}function A(R){return R.trim().split(/\s+/g)}function $(R,N,H){if(R.indexOf&&!H)return R.indexOf(N);for(var te=0;te<R.length;){if(H&&R[te][H]==N||!H&&R[te]===N)return te;te++}return-1}function L(R){return Array.prototype.slice.call(R,0)}function D(R,N,H){for(var te=[],he=[],Ce=0;Ce<R.length;){var bt=N?R[Ce][N]:R[Ce];$(he,bt)<0&&te.push(R[Ce]),he[Ce]=bt,Ce++}return H&&(N?te=te.sort(function(Hr,js){return Hr[N]>js[N]}):te=te.sort()),te}function F(R,N){for(var H,te,he=N[0].toUpperCase()+N.slice(1),Ce=0;Ce<s.length;){if(H=s[Ce],te=H?H+he:N,te in R)return te;Ce++}return r}var z=1;function U(){return z++}function G(R){var N=R.ownerDocument||R;return N.defaultView||N.parentWindow||e}var W=/mobile|tablet|ip(ad|hone|od)|android/i,Z="ontouchstart"in e,X=F(e,"PointerEvent")!==r,oe=Z&&W.test(navigator.userAgent),se="touch",le="pen",de="mouse",we="kinect",Re=25,ze=1,Ct=2,Ae=4,ke=8,jt=1,gn=2,_t=4,zs=8,Gr=16,fi=gn|_t,Fn=zs|Gr,xl=fi|Fn,Sl=["x","y"],Wi=["clientX","clientY"];function Ji(R,N){var H=this;this.manager=R,this.callback=N,this.element=R.element,this.target=R.options.inputTarget,this.domHandler=function(te){S(R.options.enable,[R])&&H.handler(te)},this.init()}Ji.prototype={handler:function(){},init:function(){this.evEl&&I(this.element,this.evEl,this.domHandler),this.evTarget&&I(this.target,this.evTarget,this.domHandler),this.evWin&&I(G(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&C(this.element,this.evEl,this.domHandler),this.evTarget&&C(this.target,this.evTarget,this.domHandler),this.evWin&&C(G(this.element),this.evWin,this.domHandler)}};function lo(R){var N,H=R.options.inputClass;return H?N=H:X?N=c1:oe?N=_0:Z?N=Sd:N=v0,new N(R,Ie)}function Ie(R,N,H){var te=H.pointers.length,he=H.changedPointers.length,Ce=N&ze&&te-he===0,bt=N&(Ae|ke)&&te-he===0;H.isFirst=!!Ce,H.isFinal=!!bt,Ce&&(R.session={}),H.eventType=N,Ze(R,H),R.emit("hammer.input",H),R.recognize(H),R.session.prevInput=H}function Ze(R,N){var H=R.session,te=N.pointers,he=te.length;H.firstInput||(H.firstInput=si(N)),he>1&&!H.firstMultiple?H.firstMultiple=si(N):he===1&&(H.firstMultiple=!1);var Ce=H.firstInput,bt=H.firstMultiple,Tr=bt?bt.center:Ce.center,Hr=N.center=or(te);N.timeStamp=u(),N.deltaTime=N.timeStamp-Ce.timeStamp,N.angle=l1(Tr,Hr),N.distance=xd(Tr,Hr),Mt(H,N),N.offsetDirection=ar(N.deltaX,N.deltaY);var js=yn(N.deltaTime,N.deltaX,N.deltaY);N.overallVelocityX=js.x,N.overallVelocityY=js.y,N.overallVelocity=c(js.x)>c(js.y)?js.x:js.y,N.scale=bt?Vk(bt.pointers,te):1,N.rotation=bt?zk(bt.pointers,te):0,N.maxPointers=H.prevInput?N.pointers.length>H.prevInput.maxPointers?N.pointers.length:H.prevInput.maxPointers:N.pointers.length,Ni(H,N);var Dc=R.element;M(N.srcEvent.target,Dc)&&(Dc=N.srcEvent.target),N.target=Dc}function Mt(R,N){var H=N.center,te=R.offsetDelta||{},he=R.prevDelta||{},Ce=R.prevInput||{};(N.eventType===ze||Ce.eventType===Ae)&&(he=R.prevDelta={x:Ce.deltaX||0,y:Ce.deltaY||0},te=R.offsetDelta={x:H.x,y:H.y}),N.deltaX=he.x+(H.x-te.x),N.deltaY=he.y+(H.y-te.y)}function Ni(R,N){var H=R.lastInterval||N,te=N.timeStamp-H.timeStamp,he,Ce,bt,Tr;if(N.eventType!=ke&&(te>Re||H.velocity===r)){var Hr=N.deltaX-H.deltaX,js=N.deltaY-H.deltaY,Dc=yn(te,Hr,js);Ce=Dc.x,bt=Dc.y,he=c(Dc.x)>c(Dc.y)?Dc.x:Dc.y,Tr=ar(Hr,js),R.lastInterval=N}else he=H.velocity,Ce=H.velocityX,bt=H.velocityY,Tr=H.direction;N.velocity=he,N.velocityX=Ce,N.velocityY=bt,N.direction=Tr}function si(R){for(var N=[],H=0;H<R.pointers.length;)N[H]={clientX:l(R.pointers[H].clientX),clientY:l(R.pointers[H].clientY)},H++;return{timeStamp:u(),pointers:N,center:or(N),deltaX:R.deltaX,deltaY:R.deltaY}}function or(R){var N=R.length;if(N===1)return{x:l(R[0].clientX),y:l(R[0].clientY)};for(var H=0,te=0,he=0;he<N;)H+=R[he].clientX,te+=R[he].clientY,he++;return{x:l(H/N),y:l(te/N)}}function yn(R,N,H){return{x:N/R||0,y:H/R||0}}function ar(R,N){return R===N?jt:c(R)>=c(N)?R<0?gn:_t:N<0?zs:Gr}function xd(R,N,H){H||(H=Sl);var te=N[H[0]]-R[H[0]],he=N[H[1]]-R[H[1]];return Math.sqrt(te*te+he*he)}function l1(R,N,H){H||(H=Sl);var te=N[H[0]]-R[H[0]],he=N[H[1]]-R[H[1]];return Math.atan2(he,te)*180/Math.PI}function zk(R,N){return l1(N[1],N[0],Wi)+l1(R[1],R[0],Wi)}function Vk(R,N){return xd(N[0],N[1],Wi)/xd(R[0],R[1],Wi)}var jk={mousedown:ze,mousemove:Ct,mouseup:Ae},Bk="mousedown",Uk="mousemove mouseup";function v0(){this.evEl=Bk,this.evWin=Uk,this.pressed=!1,Ji.apply(this,arguments)}w(v0,Ji,{handler:function(N){var H=jk[N.type];H&ze&&N.button===0&&(this.pressed=!0),H&Ct&&N.which!==1&&(H=Ae),this.pressed&&(H&Ae&&(this.pressed=!1),this.callback(this.manager,H,{pointers:[N],changedPointers:[N],pointerType:de,srcEvent:N}))}});var Gk={pointerdown:ze,pointermove:Ct,pointerup:Ae,pointercancel:ke,pointerout:ke},Hk={2:se,3:le,4:de,5:we},PT="pointerdown",kT="pointermove pointerup pointercancel";e.MSPointerEvent&&!e.PointerEvent&&(PT="MSPointerDown",kT="MSPointerMove MSPointerUp MSPointerCancel");function c1(){this.evEl=PT,this.evWin=kT,Ji.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}w(c1,Ji,{handler:function(N){var H=this.store,te=!1,he=N.type.toLowerCase().replace("ms",""),Ce=Gk[he],bt=Hk[N.pointerType]||N.pointerType,Tr=bt==se,Hr=$(H,N.pointerId,"pointerId");Ce&ze&&(N.button===0||Tr)?Hr<0&&(H.push(N),Hr=H.length-1):Ce&(Ae|ke)&&(te=!0),!(Hr<0)&&(H[Hr]=N,this.callback(this.manager,Ce,{pointers:H,changedPointers:[N],pointerType:bt,srcEvent:N}),te&&H.splice(Hr,1))}});var qk={touchstart:ze,touchmove:Ct,touchend:Ae,touchcancel:ke},Wk="touchstart",Jk="touchstart touchmove touchend touchcancel";function OT(){this.evTarget=Wk,this.evWin=Jk,this.started=!1,Ji.apply(this,arguments)}w(OT,Ji,{handler:function(N){var H=qk[N.type];if(H===ze&&(this.started=!0),!!this.started){var te=Zk.call(this,N,H);H&(Ae|ke)&&te[0].length-te[1].length===0&&(this.started=!1),this.callback(this.manager,H,{pointers:te[0],changedPointers:te[1],pointerType:se,srcEvent:N})}}});function Zk(R,N){var H=L(R.touches),te=L(R.changedTouches);return N&(Ae|ke)&&(H=D(H.concat(te),"identifier",!0)),[H,te]}var Yk={touchstart:ze,touchmove:Ct,touchend:Ae,touchcancel:ke},Xk="touchstart touchmove touchend touchcancel";function _0(){this.evTarget=Xk,this.targetIds={},Ji.apply(this,arguments)}w(_0,Ji,{handler:function(N){var H=Yk[N.type],te=Kk.call(this,N,H);te&&this.callback(this.manager,H,{pointers:te[0],changedPointers:te[1],pointerType:se,srcEvent:N})}});function Kk(R,N){var H=L(R.touches),te=this.targetIds;if(N&(ze|Ct)&&H.length===1)return te[H[0].identifier]=!0,[H,H];var he,Ce,bt=L(R.changedTouches),Tr=[],Hr=this.target;if(Ce=H.filter(function(js){return M(js.target,Hr)}),N===ze)for(he=0;he<Ce.length;)te[Ce[he].identifier]=!0,he++;for(he=0;he<bt.length;)te[bt[he].identifier]&&Tr.push(bt[he]),N&(Ae|ke)&&delete te[bt[he].identifier],he++;if(Tr.length)return[D(Ce.concat(Tr),"identifier",!0),Tr]}var K=2500,vi=25;function Sd(){Ji.apply(this,arguments);var R=x(this.handler,this);this.touch=new _0(this.manager,R),this.mouse=new v0(this.manager,R),this.primaryTouch=null,this.lastTouches=[]}w(Sd,Ji,{handler:function(N,H,te){var he=te.pointerType==se,Ce=te.pointerType==de;if(!(Ce&&te.sourceCapabilities&&te.sourceCapabilities.firesTouchEvents)){if(he)Ta.call(this,H,te);else if(Ce&&$e.call(this,te))return;this.callback(N,H,te)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function Ta(R,N){R&ze?(this.primaryTouch=N.changedPointers[0].identifier,b0.call(this,N)):R&(Ae|ke)&&b0.call(this,N)}function b0(R){var N=R.changedPointers[0];if(N.identifier===this.primaryTouch){var H={x:N.clientX,y:N.clientY};this.lastTouches.push(H);var te=this.lastTouches,he=function(){var Ce=te.indexOf(H);Ce>-1&&te.splice(Ce,1)};setTimeout(he,K)}}function $e(R){for(var N=R.srcEvent.clientX,H=R.srcEvent.clientY,te=0;te<this.lastTouches.length;te++){var he=this.lastTouches[te],Ce=Math.abs(N-he.x),bt=Math.abs(H-he.y);if(Ce<=vi&&bt<=vi)return!0}return!1}var sm=F(o.style,"touchAction"),$n=sm!==r,Td="compute",LT="auto",Ho="manipulation",Lc="none",Id="pan-x",je="pan-y",w0=e3();function x0(R,N){this.manager=R,this.set(N)}x0.prototype={set:function(R){R==Td&&(R=this.compute()),$n&&this.manager.element.style&&w0[R]&&(this.manager.element.style[sm]=R),this.actions=R.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var R=[];return m(this.manager.recognizers,function(N){S(N.options.enable,[N])&&(R=R.concat(N.getTouchAction()))}),Qk(R.join(" "))},preventDefaults:function(R){var N=R.srcEvent,H=R.offsetDirection;if(this.manager.session.prevented){N.preventDefault();return}var te=this.actions,he=E(te,Lc)&&!w0[Lc],Ce=E(te,je)&&!w0[je],bt=E(te,Id)&&!w0[Id];if(he){var Tr=R.pointers.length===1,Hr=R.distance<2,js=R.deltaTime<250;if(Tr&&Hr&&js)return}if(!(bt&&Ce)&&(he||Ce&&H&fi||bt&&H&Fn))return this.preventSrc(N)},preventSrc:function(R){this.manager.session.prevented=!0,R.preventDefault()}};function Qk(R){if(E(R,Lc))return Lc;var N=E(R,Id),H=E(R,je);return N&&H?Lc:N||H?N?Id:je:E(R,Ho)?Ho:LT}function e3(){if(!$n)return!1;var R={},N=e.CSS&&e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(H){R[H]=N?e.CSS.supports("touch-action",H):!0}),R}var Cd=1,co=2,Rc=4,_i=8,Tl=_i,Md=16,Ia=32;function Il(R){this.options=y({},this.defaults,R||{}),this.id=U(),this.manager=null,this.options.enable=T(this.options.enable,!0),this.state=Cd,this.simultaneous={},this.requireFail=[]}Il.prototype={defaults:{},set:function(R){return y(this.options,R),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(R){if(f(R,"recognizeWith",this))return this;var N=this.simultaneous;return R=S0(R,this),N[R.id]||(N[R.id]=R,R.recognizeWith(this)),this},dropRecognizeWith:function(R){return f(R,"dropRecognizeWith",this)?this:(R=S0(R,this),delete this.simultaneous[R.id],this)},requireFailure:function(R){if(f(R,"requireFailure",this))return this;var N=this.requireFail;return R=S0(R,this),$(N,R)===-1&&(N.push(R),R.requireFailure(this)),this},dropRequireFailure:function(R){if(f(R,"dropRequireFailure",this))return this;R=S0(R,this);var N=$(this.requireFail,R);return N>-1&&this.requireFail.splice(N,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(R){return!!this.simultaneous[R.id]},emit:function(R){var N=this,H=this.state;function te(he){N.manager.emit(he,R)}H<_i&&te(N.options.event+RT(H)),te(N.options.event),R.additionalEvent&&te(R.additionalEvent),H>=_i&&te(N.options.event+RT(H))},tryEmit:function(R){if(this.canEmit())return this.emit(R);this.state=Ia},canEmit:function(){for(var R=0;R<this.requireFail.length;){if(!(this.requireFail[R].state&(Ia|Cd)))return!1;R++}return!0},recognize:function(R){var N=y({},R);if(!S(this.options.enable,[this,N])){this.reset(),this.state=Ia;return}this.state&(Tl|Md|Ia)&&(this.state=Cd),this.state=this.process(N),this.state&(co|Rc|_i|Md)&&this.tryEmit(N)},process:function(R){},getTouchAction:function(){},reset:function(){}};function RT(R){return R&Md?"cancel":R&_i?"end":R&Rc?"move":R&co?"start":""}function DT(R){return R==Gr?"down":R==zs?"up":R==gn?"left":R==_t?"right":""}function S0(R,N){var H=N.manager;return H?H.get(R):R}function Zi(){Il.apply(this,arguments)}w(Zi,Il,{defaults:{pointers:1},attrTest:function(R){var N=this.options.pointers;return N===0||R.pointers.length===N},process:function(R){var N=this.state,H=R.eventType,te=N&(co|Rc),he=this.attrTest(R);return te&&(H&ke||!he)?N|Md:te||he?H&Ae?N|_i:N&co?N|Rc:co:Ia}});function T0(){Zi.apply(this,arguments),this.pX=null,this.pY=null}w(T0,Zi,{defaults:{event:"pan",threshold:10,pointers:1,direction:xl},getTouchAction:function(){var R=this.options.direction,N=[];return R&fi&&N.push(je),R&Fn&&N.push(Id),N},directionTest:function(R){var N=this.options,H=!0,te=R.distance,he=R.direction,Ce=R.deltaX,bt=R.deltaY;return he&N.direction||(N.direction&fi?(he=Ce===0?jt:Ce<0?gn:_t,H=Ce!=this.pX,te=Math.abs(R.deltaX)):(he=bt===0?jt:bt<0?zs:Gr,H=bt!=this.pY,te=Math.abs(R.deltaY))),R.direction=he,H&&te>N.threshold&&he&N.direction},attrTest:function(R){return Zi.prototype.attrTest.call(this,R)&&(this.state&co||!(this.state&co)&&this.directionTest(R))},emit:function(R){this.pX=R.deltaX,this.pY=R.deltaY;var N=DT(R.direction);N&&(R.additionalEvent=this.options.event+N),this._super.emit.call(this,R)}});function u1(){Zi.apply(this,arguments)}w(u1,Zi,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Lc]},attrTest:function(R){return this._super.attrTest.call(this,R)&&(Math.abs(R.scale-1)>this.options.threshold||this.state&co)},emit:function(R){if(R.scale!==1){var N=R.scale<1?"in":"out";R.additionalEvent=this.options.event+N}this._super.emit.call(this,R)}});function j(){Il.apply(this,arguments),this._timer=null,this._input=null}w(j,Il,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[LT]},process:function(R){var N=this.options,H=R.pointers.length===N.pointers,te=R.distance<N.threshold,he=R.deltaTime>N.time;if(this._input=R,!te||!H||R.eventType&(Ae|ke)&&!he)this.reset();else if(R.eventType&ze)this.reset(),this._timer=d(function(){this.state=Tl,this.tryEmit()},N.time,this);else if(R.eventType&Ae)return Tl;return Ia},reset:function(){clearTimeout(this._timer)},emit:function(R){this.state===Tl&&(R&&R.eventType&Ae?this.manager.emit(this.options.event+"up",R):(this._input.timeStamp=u(),this.manager.emit(this.options.event,this._input)))}});function re(){Zi.apply(this,arguments)}w(re,Zi,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Lc]},attrTest:function(R){return this._super.attrTest.call(this,R)&&(Math.abs(R.rotation)>this.options.threshold||this.state&co)}});function ce(){Zi.apply(this,arguments)}w(ce,Zi,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:fi|Fn,pointers:1},getTouchAction:function(){return T0.prototype.getTouchAction.call(this)},attrTest:function(R){var N=this.options.direction,H;return N&(fi|Fn)?H=R.overallVelocity:N&fi?H=R.overallVelocityX:N&Fn&&(H=R.overallVelocityY),this._super.attrTest.call(this,R)&&N&R.offsetDirection&&R.distance>this.options.threshold&&R.maxPointers==this.options.pointers&&c(H)>this.options.velocity&&R.eventType&Ae},emit:function(R){var N=DT(R.offsetDirection);N&&this.manager.emit(this.options.event+N,R),this.manager.emit(this.options.event,R)}});function Qe(){Il.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}w(Qe,Il,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Ho]},process:function(R){var N=this.options,H=R.pointers.length===N.pointers,te=R.distance<N.threshold,he=R.deltaTime<N.time;if(this.reset(),R.eventType&ze&&this.count===0)return this.failTimeout();if(te&&he&&H){if(R.eventType!=Ae)return this.failTimeout();var Ce=this.pTime?R.timeStamp-this.pTime<N.interval:!0,bt=!this.pCenter||xd(this.pCenter,R.center)<N.posThreshold;this.pTime=R.timeStamp,this.pCenter=R.center,!bt||!Ce?this.count=1:this.count+=1,this._input=R;var Tr=this.count%N.taps;if(Tr===0)return this.hasRequireFailures()?(this._timer=d(function(){this.state=Tl,this.tryEmit()},N.interval,this),co):Tl}return Ia},failTimeout:function(){return this._timer=d(function(){this.state=Ia},this.options.interval,this),Ia},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==Tl&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function oi(R,N){return N=N||{},N.recognizers=T(N.recognizers,oi.defaults.preset),new Ed(R,N)}oi.VERSION="2.0.7",oi.defaults={domEvents:!1,touchAction:Td,enable:!0,inputTarget:null,inputClass:null,preset:[[re,{enable:!1}],[u1,{enable:!1},["rotate"]],[ce,{direction:fi}],[T0,{direction:fi},["swipe"]],[Qe],[Qe,{event:"doubletap",taps:2},["tap"]],[j]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var Yt=1,Vs=2;function Ed(R,N){this.options=y({},oi.defaults,N||{}),this.options.inputTarget=this.options.inputTarget||R,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=R,this.input=lo(this),this.touchAction=new x0(this,this.options.touchAction),NB(this,!0),m(this.options.recognizers,function(H){var te=this.add(new H[0](H[1]));H[2]&&te.recognizeWith(H[2]),H[3]&&te.requireFailure(H[3])},this)}Ed.prototype={set:function(R){return y(this.options,R),R.touchAction&&this.touchAction.update(),R.inputTarget&&(this.input.destroy(),this.input.target=R.inputTarget,this.input.init()),this},stop:function(R){this.session.stopped=R?Vs:Yt},recognize:function(R){var N=this.session;if(!N.stopped){this.touchAction.preventDefaults(R);var H,te=this.recognizers,he=N.curRecognizer;(!he||he&&he.state&Tl)&&(he=N.curRecognizer=null);for(var Ce=0;Ce<te.length;)H=te[Ce],N.stopped!==Vs&&(!he||H==he||H.canRecognizeWith(he))?H.recognize(R):H.reset(),!he&&H.state&(co|Rc|_i)&&(he=N.curRecognizer=H),Ce++}},get:function(R){if(R instanceof Il)return R;for(var N=this.recognizers,H=0;H<N.length;H++)if(N[H].options.event==R)return N[H];return null},add:function(R){if(f(R,"add",this))return this;var N=this.get(R.options.event);return N&&this.remove(N),this.recognizers.push(R),R.manager=this,this.touchAction.update(),R},remove:function(R){if(f(R,"remove",this))return this;if(R=this.get(R),R){var N=this.recognizers,H=$(N,R);H!==-1&&(N.splice(H,1),this.touchAction.update())}return this},on:function(R,N){if(R!==r&&N!==r){var H=this.handlers;return m(A(R),function(te){H[te]=H[te]||[],H[te].push(N)}),this}},off:function(R,N){if(R!==r){var H=this.handlers;return m(A(R),function(te){N?H[te]&&H[te].splice($(H[te],N),1):delete H[te]}),this}},emit:function(R,N){this.options.domEvents&&pge(R,N);var H=this.handlers[R]&&this.handlers[R].slice();if(!(!H||!H.length)){N.type=R,N.preventDefault=function(){N.srcEvent.preventDefault()};for(var te=0;te<H.length;)H[te](N),te++}},destroy:function(){this.element&&NB(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function NB(R,N){var H=R.element;if(H.style){var te;m(R.options.cssProps,function(he,Ce){te=F(H.style,Ce),N?(R.oldCssProps[te]=H.style[te],H.style[te]=he):H.style[te]=R.oldCssProps[te]||""}),N||(R.oldCssProps={})}}function pge(R,N){var H=i.createEvent("Event");H.initEvent(R,!0,!0),H.gesture=N,N.target.dispatchEvent(H)}y(oi,{INPUT_START:ze,INPUT_MOVE:Ct,INPUT_END:Ae,INPUT_CANCEL:ke,STATE_POSSIBLE:Cd,STATE_BEGAN:co,STATE_CHANGED:Rc,STATE_ENDED:_i,STATE_RECOGNIZED:Tl,STATE_CANCELLED:Md,STATE_FAILED:Ia,DIRECTION_NONE:jt,DIRECTION_LEFT:gn,DIRECTION_RIGHT:_t,DIRECTION_UP:zs,DIRECTION_DOWN:Gr,DIRECTION_HORIZONTAL:fi,DIRECTION_VERTICAL:Fn,DIRECTION_ALL:xl,Manager:Ed,Input:Ji,TouchAction:x0,TouchInput:_0,MouseInput:v0,PointerEventInput:c1,TouchMouseInput:Sd,SingleTouchInput:OT,Recognizer:Il,AttrRecognizer:Zi,Tap:Qe,Pan:T0,Swipe:ce,Pinch:u1,Rotate:re,Press:j,on:I,off:C,each:m,merge:b,extend:_,assign:y,inherit:w,bindFn:x,prefixed:F});var fge=typeof e<"u"?e:typeof self<"u"?self:{};fge.Hammer=oi,typeof r=="function"&&r.amd?r(function(){return oi}):t.exports?t.exports=oi:e[n]=oi})(window,document,"Hammer")})(ege);var Zrt=ege.exports;const w2=Jrt(Zrt);/*!
* chartjs-plugin-zoom v2.0.1
* undefined
 * (c) 2016-2023 chartjs-plugin-zoom Contributors
 * Released under the MIT License
 */const MS=t=>t&&t.enabled&&t.modifierKey,tge=(t,e)=>t&&e[t+"Key"],RB=(t,e)=>t&&!e[t+"Key"];function qf(t,e,i){return t===void 0?!0:typeof t=="string"?t.indexOf(e)!==-1:typeof t=="function"?t({chart:i}).indexOf(e)!==-1:!1}function HL(t,e){return typeof t=="function"&&(t=t({chart:e})),typeof t=="string"?{x:t.indexOf("x")!==-1,y:t.indexOf("y")!==-1}:{x:!1,y:!1}}function Yrt(t,e){let i;return function(){return clearTimeout(i),i=setTimeout(t,e),e}}function Xrt({x:t,y:e},i){const n=i.scales,r=Object.keys(n);for(let s=0;s<r.length;s++){const o=n[r[s]];if(e>=o.top&&e<=o.bottom&&t>=o.left&&t<=o.right)return o}return null}function ige(t,e,i){const{mode:n="xy",scaleMode:r,overScaleMode:s}=t||{},o=Xrt(e,i),a=HL(n,i),l=HL(r,i);if(s){const u=HL(s,i);for(const d of["x","y"])u[d]&&(l[d]=a[d],a[d]=!1)}if(o&&l[o.axis])return[o];const c=[];return St(i.scales,function(u){a[u.axis]&&c.push(u)}),c}const Ez=new WeakMap;function Dn(t){let e=Ez.get(t);return e||(e={originalScaleLimits:{},updatedScaleLimits:{},handlers:{},panDelta:{}},Ez.set(t,e)),e}function Krt(t){Ez.delete(t)}function nge(t,e,i){const n=t.max-t.min,r=n*(e-1),s=t.isHorizontal()?i.x:i.y,o=Math.max(0,Math.min(1,(t.getValueForPixel(s)-t.min)/n||0)),a=1-o;return{min:r*o,max:r*a}}function $X(t,e,i,n,r){let s=i[n];if(s==="original"){const o=t.originalScaleLimits[e.id][n];s=it(o.options,o.scale)}return it(s,r)}function Qrt(t,e,i){const n=t.getValueForPixel(e),r=t.getValueForPixel(i);return{min:Math.min(n,r),max:Math.max(n,r)}}function o1(t,{min:e,max:i},n,r=!1){const s=Dn(t.chart),{id:o,axis:a,options:l}=t,c=n&&(n[o]||n[a])||{},{minRange:u=0}=c,d=$X(s,t,c,"min",-1/0),f=$X(s,t,c,"max",1/0),m=r?Math.max(i-e,u):t.max-t.min,g=(m-i+e)/2;return e-=g,i+=g,e<d?(e=d,i=Math.min(d+m,f)):i>f&&(i=f,e=Math.max(f-m,d)),l.min=e,l.max=i,s.updatedScaleLimits[t.id]={min:e,max:i},t.parse(e)!==t.min||t.parse(i)!==t.max}function est(t,e,i,n){const r=nge(t,e,i),s={min:t.min+r.min,max:t.max-r.max};return o1(t,s,n,!0)}function tst(t,e,i,n){o1(t,Qrt(t,e,i),n,!0)}const PX=t=>t===0||isNaN(t)?0:t<0?Math.min(Math.round(t),-1):Math.max(Math.round(t),1);function ist(t){const i=t.getLabels().length-1;t.min>0&&(t.min-=1),t.max<i&&(t.max+=1)}function nst(t,e,i,n){const r=nge(t,e,i);t.min===t.max&&e<1&&ist(t);const s={min:t.min+PX(r.min),max:t.max-PX(r.max)};return o1(t,s,n,!0)}function rst(t){return t.isHorizontal()?t.width:t.height}function sst(t,e,i){const r=t.getLabels().length-1;let{min:s,max:o}=t;const a=Math.max(o-s,1),l=Math.round(rst(t)/Math.max(a,10)),c=Math.round(Math.abs(e/l));let u;return e<-l?(o=Math.min(o+c,r),s=a===1?o:o-a,u=o===r):e>l&&(s=Math.max(0,s-c),o=a===1?s:s+a,u=s===0),o1(t,{min:s,max:o},i)||u}const ost={second:500,minute:30*1e3,hour:30*60*1e3,day:12*60*60*1e3,week:3.5*24*60*60*1e3,month:15*24*60*60*1e3,quarter:60*24*60*60*1e3,year:182*24*60*60*1e3};function rge(t,e,i,n=!1){const{min:r,max:s,options:o}=t,a=o.time&&o.time.round,l=ost[a]||0,c=t.getValueForPixel(t.getPixelForValue(r+l)-e),u=t.getValueForPixel(t.getPixelForValue(s+l)-e),{min:d=-1/0,max:f=1/0}=n&&i&&i[t.axis]||{};return isNaN(c)||isNaN(u)||c<d||u>f?!0:o1(t,{min:c,max:u},i,n)}function kX(t,e,i){return rge(t,e,i,!0)}const Az={category:nst,default:est},$z={default:tst},Pz={category:sst,default:rge,logarithmic:kX,timeseries:kX};function ast(t,e,i){const{id:n,options:{min:r,max:s}}=t;if(!e[n]||!i[n])return!0;const o=i[n];return o.min!==r||o.max!==s}function OX(t,e){St(t,(i,n)=>{e[n]||delete t[n]})}function a1(t,e){const{scales:i}=t,{originalScaleLimits:n,updatedScaleLimits:r}=e;return St(i,function(s){ast(s,n,r)&&(n[s.id]={min:{scale:s.min,options:s.options.min},max:{scale:s.max,options:s.options.max}})}),OX(n,i),OX(r,i),n}function LX(t,e,i,n){const r=Az[t.type]||Az.default;nt(r,[t,e,i,n])}function RX(t,e,i,n,r){const s=$z[t.type]||$z.default;nt(s,[t,e,i,n,r])}function lst(t){const e=t.chartArea;return{x:(e.left+e.right)/2,y:(e.top+e.bottom)/2}}function DB(t,e,i="none"){const{x:n=1,y:r=1,focalPoint:s=lst(t)}=typeof e=="number"?{x:e,y:e}:e,o=Dn(t),{options:{limits:a,zoom:l}}=o;a1(t,o);const c=n!==1,u=r!==1,d=ige(l,s,t);St(d||t.scales,function(f){f.isHorizontal()&&c?LX(f,n,s,a):!f.isHorizontal()&&u&&LX(f,r,s,a)}),t.update(i),nt(l.onZoom,[{chart:t}])}function sge(t,e,i,n="none"){const r=Dn(t),{options:{limits:s,zoom:o}}=r,{mode:a="xy"}=o;a1(t,r);const l=qf(a,"x",t),c=qf(a,"y",t);St(t.scales,function(u){u.isHorizontal()&&l?RX(u,e.x,i.x,s):!u.isHorizontal()&&c&&RX(u,e.y,i.y,s)}),t.update(n),nt(o.onZoom,[{chart:t}])}function cst(t,e,i,n="none"){a1(t,Dn(t));const r=t.scales[e];o1(r,i,void 0,!0),t.update(n)}function ust(t,e="default"){const i=Dn(t),n=a1(t,i);St(t.scales,function(r){const s=r.options;n[r.id]?(s.min=n[r.id].min.options,s.max=n[r.id].max.options):(delete s.min,delete s.max)}),t.update(e),nt(i.options.zoom.onZoomComplete,[{chart:t}])}function hst(t,e){const i=t.originalScaleLimits[e];if(!i)return;const{min:n,max:r}=i;return it(r.options,r.scale)-it(n.options,n.scale)}function dst(t){const e=Dn(t);let i=1,n=1;return St(t.scales,function(r){const s=hst(e,r.id);if(s){const o=Math.round(s/(r.max-r.min)*100)/100;i=Math.min(i,o),n=Math.max(n,o)}}),i<1?i:n}function DX(t,e,i,n){const{panDelta:r}=n,s=r[t.id]||0;hl(s)===hl(e)&&(e+=s);const o=Pz[t.type]||Pz.default;nt(o,[t,e,i])?r[t.id]=0:r[t.id]=e}function oge(t,e,i,n="none"){const{x:r=0,y:s=0}=typeof e=="number"?{x:e,y:e}:e,o=Dn(t),{options:{pan:a,limits:l}}=o,{onPan:c}=a||{};a1(t,o);const u=r!==0,d=s!==0;St(i||t.scales,function(f){f.isHorizontal()&&u?DX(f,r,l,o):!f.isHorizontal()&&d&&DX(f,s,l,o)}),t.update(n),nt(c,[{chart:t}])}function age(t){const e=Dn(t);a1(t,e);const i={};for(const n of Object.keys(t.scales)){const{min:r,max:s}=e.originalScaleLimits[n]||{min:{},max:{}};i[n]={min:r.scale,max:s.scale}}return i}function pst(t){const e=age(t);for(const i of Object.keys(t.scales)){const{min:n,max:r}=e[i];if(n!==void 0&&t.scales[i].min!==n||r!==void 0&&t.scales[i].max!==r)return!0}return!1}function ko(t,e){const{handlers:i}=Dn(t),n=i[e];n&&n.target&&(n.target.removeEventListener(e,n),delete i[e])}function x2(t,e,i,n){const{handlers:r,options:s}=Dn(t),o=r[i];o&&o.target===e||(ko(t,i),r[i]=a=>n(t,a,s),r[i].target=e,e.addEventListener(i,r[i]))}function fst(t,e){const i=Dn(t);i.dragStart&&(i.dragging=!0,i.dragEnd=e,t.update("none"))}function mst(t,e){const i=Dn(t);!i.dragStart||e.key!=="Escape"||(ko(t,"keydown"),i.dragging=!1,i.dragStart=i.dragEnd=null,t.update("none"))}function lge(t,e,i){const{onZoomStart:n,onZoomRejected:r}=i;if(n){const s=mu(e,t);if(nt(n,[{chart:t,event:e,point:s}])===!1)return nt(r,[{chart:t,event:e}]),!1}}function gst(t,e){const i=Dn(t),{pan:n,zoom:r={}}=i.options;if(e.button!==0||tge(MS(n),e)||RB(MS(r.drag),e))return nt(r.onZoomRejected,[{chart:t,event:e}]);lge(t,e,r)!==!1&&(i.dragStart=e,x2(t,t.canvas,"mousemove",fst),x2(t,window.document,"keydown",mst))}function cge(t,e,i,n){const r=qf(e,"x",t),s=qf(e,"y",t);let{top:o,left:a,right:l,bottom:c,width:u,height:d}=t.chartArea;const f=mu(i,t),m=mu(n,t);r&&(a=Math.min(f.x,m.x),l=Math.max(f.x,m.x)),s&&(o=Math.min(f.y,m.y),c=Math.max(f.y,m.y));const g=l-a,y=c-o;return{left:a,top:o,right:l,bottom:c,width:g,height:y,zoomX:r&&g?1+(u-g)/u:1,zoomY:s&&y?1+(d-y)/d:1}}function yst(t,e){const i=Dn(t);if(!i.dragStart)return;ko(t,"mousemove");const{mode:n,onZoomComplete:r,drag:{threshold:s=0}}=i.options.zoom,o=cge(t,n,i.dragStart,e),a=qf(n,"x",t)?o.width:0,l=qf(n,"y",t)?o.height:0,c=Math.sqrt(a*a+l*l);if(i.dragStart=i.dragEnd=null,c<=s){i.dragging=!1,t.update("none");return}sge(t,{x:o.left,y:o.top},{x:o.right,y:o.bottom},"zoom"),setTimeout(()=>i.dragging=!1,500),nt(r,[{chart:t}])}function vst(t,e,i){if(RB(MS(i.wheel),e)){nt(i.onZoomRejected,[{chart:t,event:e}]);return}if(lge(t,e,i)!==!1&&(e.cancelable&&e.preventDefault(),e.deltaY!==void 0))return!0}function _st(t,e){const{handlers:{onZoomComplete:i},options:{zoom:n}}=Dn(t);if(!vst(t,e,n))return;const r=e.target.getBoundingClientRect(),s=1+(e.deltaY>=0?-n.wheel.speed:n.wheel.speed),o={x:s,y:s,focalPoint:{x:e.clientX-r.left,y:e.clientY-r.top}};DB(t,o),i&&i()}function bst(t,e,i,n){i&&(Dn(t).handlers[e]=Yrt(()=>nt(i,[{chart:t}]),n))}function wst(t,e){const i=t.canvas,{wheel:n,drag:r,onZoomComplete:s}=e.zoom;n.enabled?(x2(t,i,"wheel",_st),bst(t,"onZoomComplete",s,250)):ko(t,"wheel"),r.enabled?(x2(t,i,"mousedown",gst),x2(t,i.ownerDocument,"mouseup",yst)):(ko(t,"mousedown"),ko(t,"mousemove"),ko(t,"mouseup"),ko(t,"keydown"))}function xst(t){ko(t,"mousedown"),ko(t,"mousemove"),ko(t,"mouseup"),ko(t,"wheel"),ko(t,"click"),ko(t,"keydown")}function Sst(t,e){return function(i,n){const{pan:r,zoom:s={}}=e.options;if(!r||!r.enabled)return!1;const o=n&&n.srcEvent;return o&&!e.panning&&n.pointerType==="mouse"&&(RB(MS(r),o)||tge(MS(s.drag),o))?(nt(r.onPanRejected,[{chart:t,event:n}]),!1):!0}}function Tst(t,e){const i=Math.abs(t.clientX-e.clientX),n=Math.abs(t.clientY-e.clientY),r=i/n;let s,o;return r>.3&&r<1.7?s=o=!0:i>n?s=!0:o=!0,{x:s,y:o}}function uge(t,e,i){if(e.scale){const{center:n,pointers:r}=i,s=1/e.scale*i.scale,o=i.target.getBoundingClientRect(),a=Tst(r[0],r[1]),l=e.options.zoom.mode,c={x:a.x&&qf(l,"x",t)?s:1,y:a.y&&qf(l,"y",t)?s:1,focalPoint:{x:n.x-o.left,y:n.y-o.top}};DB(t,c),e.scale=i.scale}}function Ist(t,e){e.options.zoom.pinch.enabled&&(e.scale=1)}function Cst(t,e,i){e.scale&&(uge(t,e,i),e.scale=null,nt(e.options.zoom.onZoomComplete,[{chart:t}]))}function hge(t,e,i){const n=e.delta;n&&(e.panning=!0,oge(t,{x:i.deltaX-n.x,y:i.deltaY-n.y},e.panScales),e.delta={x:i.deltaX,y:i.deltaY})}function Mst(t,e,i){const{enabled:n,onPanStart:r,onPanRejected:s}=e.options.pan;if(!n)return;const o=i.target.getBoundingClientRect(),a={x:i.center.x-o.left,y:i.center.y-o.top};if(nt(r,[{chart:t,event:i,point:a}])===!1)return nt(s,[{chart:t,event:i}]);e.panScales=ige(e.options.pan,a,t),e.delta={x:0,y:0},clearTimeout(e.panEndTimeout),hge(t,e,i)}function Est(t,e){e.delta=null,e.panning&&(e.panEndTimeout=setTimeout(()=>e.panning=!1,500),nt(e.options.pan.onPanComplete,[{chart:t}]))}const kz=new WeakMap;function Ast(t,e){const i=Dn(t),n=t.canvas,{pan:r,zoom:s}=e,o=new w2.Manager(n);s&&s.pinch.enabled&&(o.add(new w2.Pinch),o.on("pinchstart",()=>Ist(t,i)),o.on("pinch",a=>uge(t,i,a)),o.on("pinchend",a=>Cst(t,i,a))),r&&r.enabled&&(o.add(new w2.Pan({threshold:r.threshold,enable:Sst(t,i)})),o.on("panstart",a=>Mst(t,i,a)),o.on("panmove",a=>hge(t,i,a)),o.on("panend",()=>Est(t,i))),kz.set(t,o)}function $st(t){const e=kz.get(t);e&&(e.remove("pinchstart"),e.remove("pinch"),e.remove("pinchend"),e.remove("panstart"),e.remove("pan"),e.remove("panend"),e.destroy(),kz.delete(t))}var Pst="2.0.1";function zC(t,e,i){const n=i.zoom.drag,{dragStart:r,dragEnd:s}=Dn(t);if(n.drawTime!==e||!s)return;const{left:o,top:a,width:l,height:c}=cge(t,i.zoom.mode,r,s),u=t.ctx;u.save(),u.beginPath(),u.fillStyle=n.backgroundColor||"rgba(225,225,225,0.3)",u.fillRect(o,a,l,c),n.borderWidth>0&&(u.lineWidth=n.borderWidth,u.strokeStyle=n.borderColor||"rgba(225,225,225)",u.strokeRect(o,a,l,c)),u.restore()}var kst={id:"zoom",version:Pst,defaults:{pan:{enabled:!1,mode:"xy",threshold:10,modifierKey:null},zoom:{wheel:{enabled:!1,speed:.1,modifierKey:null},drag:{enabled:!1,drawTime:"beforeDatasetsDraw",modifierKey:null},pinch:{enabled:!1},mode:"xy"}},start:function(t,e,i){const n=Dn(t);n.options=i,Object.prototype.hasOwnProperty.call(i.zoom,"enabled")&&console.warn("The option `zoom.enabled` is no longer supported. Please use `zoom.wheel.enabled`, `zoom.drag.enabled`, or `zoom.pinch.enabled`."),(Object.prototype.hasOwnProperty.call(i.zoom,"overScaleMode")||Object.prototype.hasOwnProperty.call(i.pan,"overScaleMode"))&&console.warn("The option `overScaleMode` is deprecated. Please use `scaleMode` instead (and update `mode` as desired)."),w2&&Ast(t,i),t.pan=(r,s,o)=>oge(t,r,s,o),t.zoom=(r,s)=>DB(t,r,s),t.zoomRect=(r,s,o)=>sge(t,r,s,o),t.zoomScale=(r,s,o)=>cst(t,r,s,o),t.resetZoom=r=>ust(t,r),t.getZoomLevel=()=>dst(t),t.getInitialScaleBounds=()=>age(t),t.isZoomedOrPanned=()=>pst(t)},beforeEvent(t){const e=Dn(t);if(e.panning||e.dragging)return!1},beforeUpdate:function(t,e,i){const n=Dn(t);n.options=i,wst(t,i)},beforeDatasetsDraw(t,e,i){zC(t,"beforeDatasetsDraw",i)},afterDatasetsDraw(t,e,i){zC(t,"afterDatasetsDraw",i)},beforeDraw(t,e,i){zC(t,"beforeDraw",i)},afterDraw(t,e,i){zC(t,"afterDraw",i)},stop:function(t){xst(t),w2&&$st(t),Krt(t)},panFunctions:Pz,zoomFunctions:Az,zoomRectFunctions:$z};const Ost=(t,e)=>{t.map=new e.Map({basemap:"arcgis-topographic",ground:"world-elevation"})},Lst=(t,e)=>{const i=new e.MapView({map:t.map,center:t.defaultView.center,zoom:t.defaultView.zoom,container:"viewDiv",padding:{top:50},highlightOptions:{color:"rgba(0,0,0, 0.8)"},constraints:{minZoom:10,maxZoom:20}});i.ui.add("compass","top-left"),e.reactiveUtils.whenOnce(()=>!i.updating).then(()=>{t.stopLoader()}),i.popup.collapseEnabled=!1,i.popup.dockEnabled=!0,i.popup.visibleElements={featureNavigation:!1},i.popup.dockOptions={buttonEnabled:!1,breakpoint:!1,position:"top-right"},t.widgets={};const n=document.createElement("div");n.id="basemap-toggle",t.widgets.basemapToggle=new e.BasemapToggle({view:i,nextBasemap:"satellite",container:n}),e.reactiveUtils.whenOnce(()=>i.map.findLayerById("satellite-base-layer")).then(()=>{const s=i.map.findLayerById("satellite-base-layer");s.effect="sepia(50%) opacity(50%)"}),i.ui.add(t.widgets.basemapToggle,{position:"top-left"}),t.widgets.search=new e.Search({view:i,locationEnabled:!0,searchAllEnabled:!1,includeDefaultSources:!1}),i.ui.add(t.widgets.eS=new e.Expand({expandTooltip:"Search",expandIcon:"search",content:t.widgets.search}),"top-left"),t.widgets.layerList=new e.LayerList({view:i}),i.ui.add(t.widgets.eLayerList=new e.Expand({expandTooltip:"Layer List",expandIcon:"show-multiple-layers-at-a-time",content:t.widgets.layerList}),"top-left"),t.widgets.legend=new e.Legend({view:i}),i.ui.add(t.widgets.eLegend=new e.Expand({expandTooltip:"Legend",expandIcon:"legend",content:t.widgets.legend}),"top-left"),t.widgets.elevationProfile=new e.ElevationProfile({view:i,unit:"meters",unitOptions:["meters"],profiles:[{type:"ground"}],visibleElements:{legend:!1,chart:!0,clearButton:!0,settingsButton:!1,sketchButton:!0,selectButton:!1,uniformChartScalingToggle:!0}}),i.ui.add(t.widgets.eElevationProfile=new e.Expand({expandTooltip:"Elevation Profile",content:t.widgets.elevationProfile}),"top-left");const r=document.createElement("div");r.id="zoom-to-layer-extent",r.className="esri-widget esri-widget--button esri-interactive",r.title="Zoom to all gauges",r.innerHTML='<calcite-icon icon="layer-zoom-to" text-label="Zoom to all gauges"></calcite-icon>',document.body.appendChild(r),i.ui.add("zoom-to-layer-extent","top-left"),r.addEventListener("click",()=>{t.layers.rgToc.queryExtent().then(s=>{i.goTo(s.extent,{duration:1e3}).catch(o=>{console.error(o)})})}),t.view=i},Rst=(t,e)=>{const i=t.map;t.layers={},t.layers.sws=Dst(e.GeoJSONLayer),t.layers.ab=Nst(e.GeoJSONLayer),t.layers.lfps=Fst(e.GeoJSONLayer),t.layers.rgRelocation=zst(e.GeoJSONLayer),t.layers.rgToc=Vst(e.GeoJSONLayer,e.LabelClass,t.tocColors),jst(t,e.reactiveUtils),i.add(t.layers.sws),i.add(t.layers.lfps),i.add(t.layers.ab),i.add(t.layers.rgRelocation),i.add(t.layers.rgToc)},Dst=t=>{const e={type:"simple",symbol:{type:"simple-fill",color:"rgba(0,64,128,0.2)",outline:{color:"rgba(0,64,128,1)",width:1}}};return new t({id:"sws",title:"Subwatershed",url:"./gis/sws.json",displayField:"code",objectIdField:"code",outFields:["*"],orderBy:{field:"area"},renderer:e,definitionExpression:"code = ''",listMode:"hide"})},Nst=t=>{const e={type:"simple",symbol:{type:"simple-fill",style:"none",outline:{color:"#f0f",width:2,style:"short-dot"}}};return new t({id:"ab",title:"Gold Coast City Administrative Boundary",url:"./gis/ab.json",displayField:"lga_name",objectIdField:"fid",renderer:e,opacity:.5})},Fst=t=>{const e={type:"simple",symbol:{type:"simple-line",style:"short-dot",width:2,color:"rgb(0,64,128)"}};return new t({id:"lfps",title:"Longest Flow Path",url:"./gis/lfps.json",displayField:"code",objectIdField:"code",outFields:["*"],orderBy:{field:"length"},renderer:e,definitionExpression:"code = ''",listMode:"hide"})},zst=t=>{const e={type:"simple",symbol:{type:"simple-line",width:2,color:"rgb(128,0,128)"}};return new t({id:"rg-relocation",title:"Rainfall Gauge Relocation",url:"./gis/rg-relocation.json",displayField:"code",objectIdField:"code",outFields:["*"],renderer:e,visible:!1})},Vst=(t,e,i)=>{const n={type:"pie-chart",holePercentage:.3,othersCategory:{threshold:.05,color:"gray"},attributes:[{field:"toc_jbp",label:"TOC JBP",color:i[0]},{field:"toc_kir",label:"TOC Kirpich",color:i[1]},{field:"toc_pil",label:"TOC Pilgrim McDermott",color:i[2]},{field:"toc_bw_avg",label:"TOC Bransby Williams (avg)",color:i[3]},{field:"toc_bw_eqa",label:"TOC Bransby Williams (eqa)",color:i[4]}],size:15};n.visualVariables=[{legendOptions:{title:"TOC in hours"},type:"size",valueExpression:"($feature.toc_jbp + $feature.toc_kir + $feature.toc_pil + $feature.toc_bw_avg + $feature.toc_bw_eqa)/5",minSize:15,maxSize:60,minDataValue:0,maxDataValue:40}];const r=new t({id:"rgToc",title:"Rainfall Gauge - Time of Concentration",url:"./gis/rg-toc.json",displayField:"code",objectIdField:"fid",outFields:["*"],renderer:n,featureEffect:{filter:{where:"calc_toc > 0"},includedEffect:"drop-shadow(0px, 0px, 5px, #666)",excludedEffect:"opacity(80%)",excludedLabelsVisible:!0},popupTemplate:{title:"{code}, {name}",actions:[{title:"Show subwatershed",id:"show-sws",icon:"drive-time"}],content:[{type:"media",mediaInfos:[{type:"column-chart",caption:"Time of concentation (hours)",value:{fields:["toc_jbp","toc_kir","toc_pil","toc_bw_avg","toc_bw_eqa"],normalizeField:null,tooltipField:"TOC values for various methodologies"}}]},{type:"fields",fieldInfos:[{fieldName:"toc_jbp",label:"TOC JBP",format:{places:2,digitSeparator:!0},stringFieldOption:"text-box"},{fieldName:"toc_kir",label:"TOC Kirpich",format:{places:2,digitSeparator:!0},stringFieldOption:"text-box"},{fieldName:"toc_pil",label:"TOC Pilgrim McDermott",format:{places:2,digitSeparator:!0},stringFieldOption:"text-box"},{fieldName:"toc_bw_avg",label:"TOC Bransby Williams (avg)",format:{places:2,digitSeparator:!0},stringFieldOption:"text-box"},{fieldName:"toc_bw_eqa",label:"TOC Bransby Williams (eqa)",format:{places:2,digitSeparator:!0},stringFieldOption:"text-box"},{fieldName:"sw_area",label:"Subwatershed area:",format:{places:0,digitSeparator:!0},stringFieldOption:"text-box"},{fieldName:"lfp_len",label:"LFP length",format:{places:0,digitSeparator:!0},stringFieldOption:"text-box"},{fieldName:"lfp_dem_min",label:"LFP outlet elevation",format:{places:0,digitSeparator:!0},stringFieldOption:"text-box"},{fieldName:"lfp_dem_max",label:"LFP top elevation",format:{places:0,digitSeparator:!0},stringFieldOption:"text-box"}]}]},copyright:"QIT Plus"}),s=new e({labelExpressionInfo:{expression:"$feature.code"},symbol:{type:"text",color:i[1],haloSize:1,haloColor:"white"}});return r.labelingInfo=[s],r},jst=(t,e)=>{const i=t.view;e.on(()=>i.popup.viewModel,"trigger-action",s=>{s.action.id==="show-sws"&&n()});const n=()=>{const s=i.popup.selectedFeature.attributes.code;t.layers.rgToc.featureEffect={filter:{where:`code = '${s}'`},includedEffect:"drop-shadow(0px, 0px, 5px, #666)",excludedEffect:"opacity(25%)",excludedLabelsVisible:!1},t.layers.lfps.definitionExpression=`code = '${s}'`,t.layers.sws.definitionExpression=`code = '${s}'`,t.layers.sws.queryExtent().then(o=>{i.goTo(o.extent,{duration:1e3}).catch(a=>{console.error(a)})}),t.layers.lfps.queryFeatures().then(o=>{t.widgets.elevationProfile.input=o.features[0],t.widgets.eElevationProfile.expand()})},r=()=>{t.layers.rgToc.featureEffect={filter:{where:"calc_toc > 0"},includedEffect:"drop-shadow(0px, 0px, 5px, #666)",excludedEffect:"opacity(80%)",excludedLabelsVisible:!0},t.layers.lfps.definitionExpression="code = ''",t.layers.sws.definitionExpression="code = ''",t.widgets.eElevationProfile.collapse()};e.watch(()=>i.popup.selectedFeature,s=>{if(s&&(r(),s.layer.id=="rgToc")){const o=s.getEffectivePopupTemplate();o.actions.items[0].visible=!!s.attributes.calc_toc}}),e.watch(()=>i.popup.visible,()=>{r()}),t.widgets.search.sources=[{layer:t.layers.rgToc,searchFields:["code","name"],suggestionTemplate:"{code} - {name}",exactMatch:!1,outFields:["code","name"],name:"Gauges",placeholder:"Gauge code or name",maxSuggestions:6,minSuggestCharacters:2,zoomScale:5e4}]},Bst=()=>{const t=document.createElement("div");t.id="bottomContainer",t.className="collapsed",t.innerHTML=`
        <div id="tableDivToggle" class="active esri-widget--button">Table</div>
        <div id="chartDivToggle" class="esri-widget--button">Chart</div>
        <div id="eViewDivToggle" class="esri-widget--button">eView</div>
        <div id="bcDivToggle" class="esri-widget--button">&#8613;</div>
        <div id="bcDivResize" class="esri-widget--button">&#8597;</div>
        <div id="tableDiv"></div>
        <div id="chartDiv" class="hidden">
            <div id="tocLineChartDivToggle" class="active esri-widget--button">Line</div>
            <div id="tocBubbleChartDivToggle" class="esri-widget--button">Bubble</div>
            <div id="tocLineChartDiv">
                <canvas id="tocLineChartCanvas"></canvas>
            </div>
            <div id="tocBubbleChartDiv" class="hidden">
                <div id="tocBubbleChartToggle" class="esri-widget--button"><calcite-icon icon="round-about-right" text-label="Toggle chart"></calcite-icon></div>
                <canvas id="tocBubbleChartCanvas"></canvas>
            </div>
        </div>
        <div id="eViewDiv" class="hidden">View events log:</div>`,document.body.appendChild(t);const e=document.getElementById("tableDivToggle"),i=document.getElementById("chartDivToggle"),n=document.getElementById("eViewDivToggle"),r=document.getElementById("bcDivToggle"),s=document.getElementById("bcDivResize"),o=document.getElementById("tocLineChartDivToggle"),a=document.getElementById("tocBubbleChartDivToggle");e.addEventListener("click",()=>l(!0,"tableDiv")),i.addEventListener("click",()=>l(!0,"chartDiv")),n.addEventListener("click",()=>l(!0,"eViewDiv")),r.addEventListener("click",()=>l()),o.addEventListener("click",()=>d("tocLineChartDiv")),a.addEventListener("click",()=>d("tocBubbleChartDiv"));const l=(f=!1,m="")=>{if(!f||f&&t.classList.contains("collapsed")){const g=t.classList.toggle("collapsed");r.innerHTML=g?"&#8613;":"&#10515;",s.style.visibility=g?"hidden":"visible"}if(m){let g=["tableDiv","chartDiv","eViewDiv"];if(g.includes(m)){let y=document.getElementById(m);if(y.classList.contains("hidden")){y.classList.remove("hidden"),y=document.getElementById(m+"Toggle"),y.classList.add("active"),g=g.filter(_=>_!==m);for(const _ of g)y=document.getElementById(_),y.classList.add("hidden"),y=document.getElementById(_+"Toggle"),y.classList.remove("active")}}}};let c;s.addEventListener("mousedown",f=>{c=f.y,document.addEventListener("mousemove",u,!1)},!1),document.addEventListener("mouseup",()=>{document.removeEventListener("mousemove",u,!1)},!1);const u=f=>{const m=c-f.y;c=f.y,t.style.height=parseInt(getComputedStyle(t,"").height)+m+"px"},d=(f="")=>{if(f){let m=["tocLineChartDiv","tocBubbleChartDiv"];if(m.includes(f)){let g=document.getElementById(f);if(g.classList.contains("hidden")){g.classList.remove("hidden"),g=document.getElementById(f+"Toggle"),g.classList.add("active"),m=m.filter(y=>y!==f);for(const y of m)g=document.getElementById(y),g.classList.add("hidden"),g=document.getElementById(y+"Toggle"),g.classList.remove("active")}}}}},Ust=(t,e)=>{t.featureTable=new e.FeatureTable({lable:"Time of concentration",view:t.view,multiSortEnabled:!0,layer:t.layers.rgToc,container:document.getElementById("tableDiv"),tableTemplate:new e.TableTemplate({columnTemplates:[{type:"field",fieldName:"code",label:"Code",direction:"asc"},{type:"field",fieldName:"name",label:"Name"},{type:"field",fieldName:"catchment",label:"Catchment",visible:!1},{type:"field",fieldName:"sw_area",label:"Subwatershed area",visible:!1},{type:"field",fieldName:"lfp_len",label:"LFP length",visible:!1},{type:"field",fieldName:"lfp_dem_min",label:"LFP outlet elevation",visible:!1},{type:"field",fieldName:"lfp_dem_max",label:"LFP top elevation",visible:!1},{type:"field",fieldName:"lfp_dem_slope_avg",label:"Average slope",visible:!1},{type:"field",fieldName:"lfp_dem_slope_eqa",label:"Equal area slope",visible:!1},{type:"field",fieldName:"toc_jbp",label:"TOC JBP"},{type:"field",fieldName:"toc_kir",label:"TOC Kirpich"},{type:"field",fieldName:"toc_pil",label:"TOC Pilgrim McDermott"},{type:"field",fieldName:"toc_bw_avg",label:"TOC Bransby Williams (avg)"},{type:"field",fieldName:"toc_bw_eqa",label:"TOC Bransby Williams (eqa)"}]}),visibleElements:{header:!0,menu:!0,menuItems:{clearSelection:!1,refreshData:!1,toggleColumns:!0,selectedRecordsShowAllToggle:!1,selectedRecordsShowSelectedToggle:!1,zoomToSelection:!1},selectionColumn:!1,columnMenus:!1}})},Gst=(t,e)=>{t.charts={},e.defaults.color=getComputedStyle(document.body).getPropertyValue("--qitp-primary-color"),t.layers.rgToc.queryFeatures({where:"calc_toc = 1",outFields:["*"]}).then(i=>{i.features.length&&(t.charts.tocLineChart=Hst(t,e,i.features),t.charts.tocBubbleChart=qst(t,e,i.features),document.getElementById("tocBubbleChartToggle").addEventListener("click",()=>{Wst(t)}))})},Hst=(t,e,i)=>{const n=t.tocColors,r=document.getElementById("tocLineChartCanvas"),s=i.map(m=>m.attributes);s.sort((m,g)=>m.toc_kir-g.toc_kir);const o=s.map(m=>m.code),a=s.map(m=>m.toc_jbp?m.toc_jbp:NaN),l=s.map(m=>m.toc_kir),c=s.map(m=>m.toc_pil),u=s.map(m=>m.toc_bw_avg),d=s.map(m=>m.toc_bw_eqa),f=new e(r,{type:"line",data:{labels:o,datasets:[{label:"TOC JBP",data:a,pointRadius:5,borderColor:n[0]+"33",backgroundColor:n[0],tension:.4},{label:"TOC Kirpich",data:l,pointRadius:5,borderColor:n[1]+"33",backgroundColor:n[1],tension:.4},{label:"TOC Pilgrim McDermott",data:c,pointRadius:5,borderColor:n[2]+"33",backgroundColor:n[2],tension:.4},{label:"TOC Bransby Williams (avg)",data:u,pointRadius:5,borderColor:n[3]+"33",backgroundColor:n[3],tension:.4},{label:"TOC Bransby Williams (eqa)",data:d,pointRadius:5,borderColor:n[4],backgroundColor:n[4],tension:.4,hidden:!0}]},options:{maintainAspectRatio:!1,scales:{y:{title:{display:!0,text:"TOC (h)"},min:0,max:30}},onClick:(m,g)=>{if(g.length===0)return;const{dataIndex:y,raw:_}=g[0].element.$context,b=m.chart.data.labels[y];console.log(b),t.layers.rgToc.queryFeatures({where:`code = '${b}'`,returnGeometry:!0}).then(w=>{if(w.features.length){const x=w.features[0];t.view.goTo({target:x.geometry,zoom:15},{duration:1e3}),t.view.openPopup({features:[x]})}})},plugins:{zoom:{limits:{y:{min:0,max:30}},zoom:{wheel:{enabled:!0},drag:{enabled:!0,threshold:10}}},title:{display:!0,text:"Time of Concentration Methodologies per Gauge"}}}});return r.addEventListener("dblclick",()=>{f.resetZoom()}),f},qst=(t,e,i)=>{const n=t.tocColors;t.charts.tocBubbleData={},t.charts.tocBubbleData.lfp_len=[],t.charts.tocBubbleData.sw_area=[],t.charts.tocBubbleData.slope_avg=[],t.charts.tocBubbleData.mode=0,t.charts.tocBubbleData.params=[["LFP Length","km"],["Subwatershed Area","sqkm"],["TOC","h"],["Slope","m/km"]];const r=t.charts.tocBubbleData.params,s=document.getElementById("tocBubbleChartCanvas"),o=[],a=[],l=[],c=[],u=[],d=[],f=(x,S,T,I)=>{var C=T-x,M=(I-T)/(S-x);return function(E){return C+M*E}},m=i.map(x=>x.attributes),g=Math.max(...m.map(x=>x.lfp_len)),y=Math.max(...m.map(x=>x.sw_area)),_=f(0,g,5,50),b=f(0,y,5,50);for(const x of m){o.push(x.code);const S=Math.round(x.lfp_len/10)/100;t.charts.tocBubbleData.slope_avg.push(Math.round(x.lfp_dem_slope_avg*100)/100);const T=Math.round(_(x.lfp_len));t.charts.tocBubbleData.lfp_len.push([S,T]);const I=Math.round(x.sw_area/1e4)/100,C=Math.round(b(x.sw_area));t.charts.tocBubbleData.sw_area.push([I,C]),a.push({x:S,y:I,r:x.toc_jbp?x.toc_jbp:NaN}),l.push({x:S,y:I,r:x.toc_kir}),c.push({x:S,y:I,r:x.toc_pil}),u.push({x:S,y:I,r:x.toc_bw_avg}),d.push({x:S,y:I,r:x.toc_bw_eqa})}const w=new e(s,{type:"bubble",data:{labels:o,datasets:[{label:"TOC JBP",data:a,pointRadius:5,borderColor:n[0],backgroundColor:n[0]+"33"},{label:"TOC Kirpich",data:l,pointRadius:5,borderColor:n[1],backgroundColor:n[1]+"33"},{label:"TOC Pilgrim McDermott",data:c,pointRadius:5,borderColor:n[2],backgroundColor:n[2]+"33"},{label:"TOC Bransby Williams (avg)",data:u,pointRadius:5,borderColor:n[3],backgroundColor:n[3]+"33"},{label:"TOC Bransby Williams (eqa)",data:d,pointRadius:5,borderColor:n[4],backgroundColor:n[4]+"33",hidden:!0}]},options:{maintainAspectRatio:!1,scales:{x:{title:{display:!0,text:`${r[0][0]} (${r[0][1]})`}},y:{title:{display:!0,text:`${r[1][0]} (${r[1][1]})`}}},onClick:(x,S)=>{if(S.length===0)return;const{dataIndex:T,raw:I}=S[0].element.$context,C=x.chart.data.labels[T];t.layers.rgToc.queryFeatures({where:`code = '${C}'`,returnGeometry:!0}).then(M=>{if(M.features.length){const E=M.features[0];t.view.goTo({target:E.geometry,zoom:15},{duration:1e3}),t.view.openPopup({features:[E]})}})},plugins:{zoom:{zoom:{wheel:{enabled:!0},drag:{enabled:!0,threshold:10}}},title:{display:!0,text:`${r[2][0]} (${r[2][1]}) by ${r[0][0]} (${r[0][1]}) x ${r[1][0]} (${r[1][1]})`}}}});return s.addEventListener("dblclick",()=>{w.resetZoom()}),w},Wst=t=>{const e=t.charts.tocBubbleChart,i=t.charts.tocBubbleData.lfp_len,n=t.charts.tocBubbleData.sw_area,r=t.charts.tocBubbleData.slope_avg,s=t.charts.tocBubbleData.params;let o=t.charts.tocBubbleData.mode;o=o+1==4?0:o+1,console.log(o),t.charts.tocBubbleData.mode=o;for(const a of e.data.datasets)for(let l=0;l<i.length;l++)o==0?(e.options.scales.x.max=null,a.data[l].r=a.data[l].y,a.data[l].x=i[l][0],a.data[l].y=n[l][0],e.options.plugins.title.text=`${s[2][0]} (${s[2][1]}) by ${s[0][0]} (${s[0][1]}) x ${s[1][0]} (${s[1][1]})`,e.options.scales.x.title.text=`${s[0][0]} (${s[0][1]})`,e.options.scales.y.title.text=`${s[1][0]} (${s[1][1]})`):o==1?(a.data[l].y=a.data[l].r,a.data[l].x=i[l][0],a.data[l].r=n[l][1],e.options.plugins.title.text=`${s[1][0]} (Scaled to 5 - 50 px) by ${s[0][0]} (${s[0][1]}) x ${s[2][0]} (${s[2][1]})`,e.options.scales.y.title.text=`${s[2][0]} (${s[2][1]})`):o==2?(a.data[l].x=n[l][0],a.data[l].r=i[l][1],e.options.plugins.title.text=`${s[0][0]} (Scaled to 5 - 50 px) by ${s[0][0]} (${s[1][1]}) x ${s[2][0]} (${s[2][1]})`,e.options.scales.x.title.text=`${s[1][0]} (${s[1][1]})`):(a.data[l].x=r[l],a.data[l].r=i[l][1],e.options.plugins.title.text=`${s[0][0]} (Scaled to 5 - 50 px) by ${s[3][0]} (${s[3][1]}) x ${s[2][0]} (${s[2][1]})`,e.options.scales.x.title.text=`${s[3][0]} (${s[3][1]})`,e.options.scales.x.max=50);e.update(0)},Jst=(t,e)=>{const i=t.view,n=document.getElementById("eViewDiv"),r=o=>{o.name&&o.message&&`${o.name}${o.message}`,s(info)};i.when(()=>{s("<span> view.when </span> --- view loaded successfully")}).catch(r),i.map.allLayers.on("change",o=>{o.added.length>0&&o.added.forEach(a=>{const l=`<span> layer added: </span> ${a.id} - ${a.title}`;s(l)})}),i.on("layerview-create",o=>{const a=`<span> layer created: </span> ${o.layer.id} - ${o.layer.title} is ${o.layer.loadStatus}`;s(a)}),e.watch(()=>i.map.basemap,o=>{const a=`<span> Basemap changed: </span> ${o.id}`;s(a)}),i.on("click",o=>{const a=`<span> click: </span>
            x: ${o.mapPoint.x.toFixed(2)}
            y: ${o.mapPoint.y.toFixed(2)}
            long: ${o.mapPoint.longitude.toFixed(6)}
            lat: ${o.mapPoint.latitude.toFixed(6)}`;s(a)}),e.when(()=>i.stationary===!0,()=>{if(i.center){const o=`<span> center: </span>
                    x: ${i.center.x.toFixed(2)}
                    y: ${i.center.y.toFixed(2)}
                    long: ${i.center.longitude.toFixed(6)}
                    lat: ${i.center.latitude.toFixed(6)}`;s(o)}if(i.extent){const o=`<span> extent: </span>
                    xmin: ${i.extent.xmin.toFixed(2)}
                    xmax: ${i.extent.xmax.toFixed(2)}
                    ymin: ${i.extent.ymin.toFixed(2)}
                    ymax: ${i.extent.ymax.toFixed(2)}`;s(o)}if(i.zoom&&i.scale){const o=`<span> zoom/scale: </span>
                    zoom: ${i.zoom.toFixed(2)}
                    scale: ${i.scale.toFixed(2)}`;s(o)}}),e.watch(()=>i.popup.visible,()=>{const o=`<span> popup: </span> = ${i.popup.visible}`;s(o)});const s=o=>{n.innerHTML+="<br>"+new Date().toLocaleTimeString()+": "+o,n.scrollTop=n.scrollHeight}},dge="QIT Plus - Time of Concentration",Zst="";yge(dge);vge(dge,Zst);_ge();bge();const Oh=xge();gu.register(kst);Ost(Oh,Ok);Lst(Oh,Ok);Rst(Oh,Ok);Bst();Oh.view.when(()=>{Oh.view.whenLayerView(Oh.layers.rgToc).then(()=>{Ust(Oh,Ok),Gst(Oh,gu)})});Jst(Oh,cne);export{bU as $,LRe as A,Lr as B,qe as C,wa as D,to as E,Oy as F,RI as G,Yee as H,Zee as I,Jee as J,$_ as K,Xee as L,llt as M,dle as N,J1e as O,cy as P,o_ as Q,Ti as R,En as S,Px as T,Ff as U,xe as V,Nr as W,JC as X,tD as Y,Tt as Z,V as _,h as a,uct as a$,lct as a0,Yat as a1,ks as a2,gt as a3,n0 as a4,E2 as a5,ose as a6,NV as a7,$at as a8,e0 as a9,_ut as aA,ir as aB,pe as aC,Vr as aD,Ms as aE,Cf as aF,Le as aG,Rs as aH,jo as aI,ot as aJ,e1 as aK,vu as aL,wut as aM,sd as aN,GIe as aO,kc as aP,Nb as aQ,K$ as aR,ye as aS,Tlt as aT,D6 as aU,ct as aV,WC as aW,mP as aX,wU as aY,ult as aZ,Wlt as a_,rr as aa,VV as ab,xc as ac,q as ad,dbe as ae,tf as af,mle as ag,C1e as ah,M1e as ai,Uo as aj,Cht as ak,Eht as al,Oht as am,kse as an,jht as ao,Lke as ap,Eke as aq,Y as ar,Lx as as,Uae as at,Cat as au,Q$ as av,Vt as aw,fl as ax,nr as ay,lP as az,p as b,i0 as b$,Ee as b0,$P as b1,FEe as b2,iat as b3,_e as b4,Mu as b5,iu as b6,ZB as b7,pne as b8,br as b9,bQ as bA,Rve as bB,s6 as bC,a6 as bD,An as bE,ie as bF,Ln as bG,be as bH,Cc as bI,yCe as bJ,w$e as bK,S$e as bL,qbe as bM,_at as bN,ss as bO,lat as bP,zh as bQ,Y8 as bR,L$e as bS,U$e as bT,Pve as bU,Doe as bV,qLe as bW,Bwe as bX,Odt as bY,Rdt as bZ,Ldt as b_,jC as ba,tP as bb,rat as bc,xr as bd,tye as be,_R as bf,GP as bg,ect as bh,dct as bi,Me as bj,ad as bk,zft as bl,Fft as bm,act as bn,awe as bo,Sf as bp,mot as bq,qL as br,FPe as bs,JX as bt,PWe as bu,Eat as bv,Dge as bw,Oge as bx,Lve as by,_Q as bz,P as c,rs as c$,Db as c0,Ewe as c1,xu as c2,Xwe as c3,Mlt as c4,LR as c5,Clt as c6,kat as c7,NS as c8,ue as c9,vT as cA,ae as cB,wNe as cC,pct as cD,Tc as cE,zoe as cF,cH as cG,Bf as cH,Hy as cI,tft as cJ,jpt as cK,zpt as cL,l_ as cM,fNe as cN,Vpt as cO,Oi as cP,Os as cQ,$ee as cR,U$ as cS,G$ as cT,My as cU,ST as cV,IT as cW,ns as cX,Ii as cY,jr as cZ,io as c_,GA as ca,I6e as cb,rFe as cc,rVe as cd,z4 as ce,cce as cf,YDe as cg,qM as ch,vle as ci,XDe as cj,KDe as ck,cVe as cl,gA as cm,Vle as cn,l4 as co,SVe as cp,f4e as cq,eme as cr,bQe as cs,FNe as ct,Gi as cu,sr as cv,bNe as cw,eS as cx,PF as cy,igt as cz,Ds as d,Pc as d$,Ur as d0,Ub as d1,td as d2,er as d3,zre as d4,kt as d5,$k as d6,Li as d7,FK as d8,H$ as d9,hB as dA,uXe as dB,mgt as dC,m0t as dD,f0t as dE,S_ as dF,TK as dG,uB as dH,ift as dI,yl as dJ,an as dK,O6 as dL,Pge as dM,RS as dN,cj as dO,Wae as dP,jae as dQ,Gae as dR,_j as dS,ij as dT,$o as dU,A2 as dV,HRe as dW,Mae as dX,pj as dY,Go as dZ,Mf as d_,sV as da,JS as db,z2 as dc,ef as dd,ya as de,sTe as df,iP as dg,oTe as dh,BV as di,fct as dj,efe as dk,lne as dl,Uat as dm,cb as dn,Xpe as dp,is as dq,V9 as dr,Aee as ds,jn as dt,As as du,RZ as dv,gi as dw,_Xe as dx,bXe as dy,t0t as dz,jy as e,Opt as e$,Zae as e0,sDe as e1,Tae as e2,Ge as e3,Kmt as e4,ea as e5,uvt as e6,Bu as e7,aQ as e8,IV as e9,Sn as eA,xpt as eB,wpt as eC,N5e as eD,Mat as eE,md as eF,t_e as eG,pi as eH,fd as eI,gLe as eJ,_dt as eK,lb as eL,vj as eM,ylt as eN,yi as eO,Dh as eP,Ns as eQ,Pae as eR,dht as eS,Kot as eT,n_e as eU,ml as eV,ZA as eW,Zz as eX,GRe as eY,MM as eZ,dot as e_,ge as ea,It as eb,dc as ec,o0 as ed,Kat as ee,YIe as ef,alt as eg,Lee as eh,dl as ei,wl as ej,Ic as ek,j9 as el,pu as em,X_ as en,tl as eo,ut as ep,kb as eq,Iht as er,cot as es,Tht as et,Bht as eu,ES as ev,kS as ew,y6 as ex,_pt as ey,Qst as ez,He as f,sn as f$,ase as f0,TD as f1,db as f2,M$e as f3,MT as f4,lse as f5,$c as f6,rke as f7,BP as f8,hA as f9,sIe as fA,uat as fB,ht as fC,ri as fD,Fpe as fE,zpe as fF,bee as fG,eYe as fH,Mbe as fI,Ebe as fJ,tee as fK,_ee as fL,TT as fM,Ibe as fN,_Ie as fO,wu as fP,OIe as fQ,Zyt as fR,Lat as fS,qyt as fT,T_ as fU,sot as fV,Vpe as fW,TR as fX,sB as fY,Tf as fZ,Rb as f_,xt as fa,cd as fb,Ve as fc,VS as fd,Es as fe,pEe as ff,Rht as fg,R3e as fh,r0 as fi,fn as fj,zz as fk,E$e as fl,QL as fm,rwe as fn,Di as fo,Or as fp,I$e as fq,$ve as fr,ld as fs,wdt as ft,cLe as fu,Cbe as fv,X8 as fw,LIe as fx,fV as fy,bP as fz,oT as g,ZAe as g$,p0 as g0,oZe as g1,lyt as g2,cyt as g3,gZe as g4,hot as g5,gve as g6,K_ as g7,e6 as g8,Hge as g9,dj as gA,hj as gB,qP as gC,PLe as gD,BRe as gE,U5e as gF,G5e as gG,M_ as gH,Pu as gI,ll as gJ,pl as gK,DA as gL,$ae as gM,Cae as gN,qdt as gO,Hdt as gP,Udt as gQ,mne as gR,J$ as gS,sat as gT,Sht as gU,Nat as gV,mLe as gW,fj as gX,Dat as gY,Lh as gZ,Aat as g_,Ri as ga,Tce as gb,Po as gc,nb as gd,SP as ge,rd as gf,Fy as gg,ULe as gh,Swe as gi,xwe as gj,j1e as gk,$9 as gl,no as gm,Lu as gn,vot as go,hu as gp,dlt as gq,P5e as gr,DRe as gs,R5e as gt,H9 as gu,Xae as gv,nte as gw,URe as gx,lT as gy,q5e as gz,f$e as h,h5e as h$,DQ as h0,kK as h1,F_e as h2,Aot as h3,K0e as h4,Bpt as h5,Dht as h6,pot as h7,AP as h8,zRe as h9,Vlt as hA,Ec as hB,uCe as hC,ASe as hD,zyt as hE,Za as hF,oCe as hG,Rf as hH,tN as hI,bpt as hJ,jz as hK,Ou as hL,kv as hM,Aae as hN,JRe as hO,Mpt as hP,t0 as hQ,Qmt as hR,OE as hS,lae as hT,Ob as hU,lpt as hV,Yae as hW,gd as hX,Kb as hY,Xb as hZ,d5e as h_,Nz as ha,tn as hb,il as hc,ZF as hd,rn as he,n1 as hf,Ipe as hg,jJe as hh,gee as hi,VJe as hj,xZe as hk,_yt as hl,em as hm,_pe as hn,tyt as ho,Tk as hp,od as hq,xgt as hr,hZe as hs,sP as ht,Vde as hu,C$ as hv,yot as hw,Nde as hx,bk as hy,fpt as hz,_y as i,Wge as i$,u5e as i0,dpt as i1,ppt as i2,but as i3,Zdt as i4,Ydt as i5,Xdt as i6,Qdt as i7,ept as i8,tpt as i9,I6 as iA,vlt as iB,IA as iC,TWe as iD,uZ as iE,oee as iF,jf as iG,QX as iH,aZe as iI,zo as iJ,xut as iK,Sut as iL,CYe as iM,Lz as iN,Rz as iO,Adt as iP,_lt as iQ,$f as iR,eH as iS,k2 as iT,Oat as iU,sGe as iV,PJ as iW,uT as iX,cT as iY,OKe as iZ,R2 as i_,ipt as ia,npt as ib,rpt as ic,spt as id,opt as ie,apt as ig,B5e as ih,NG as ii,Tut as ij,N0e as ik,Vht as il,zht as im,su as io,vt as ip,Uht as iq,Lht as ir,XK as is,cpt as it,upt as iu,Cre as iv,Kdt as iw,Su as ix,Jdt as iy,qRe as iz,Je as j,a2 as j$,KX as j0,eot as j1,Rge as j2,wse as j3,qee as j4,hlt as j5,Y1e as j6,Wat as j7,GOe as j8,DLe as j9,Aht as jA,Mht as jB,Rpt as jC,Dpt as jD,Sy as jE,Mge as jF,k_ as jG,fot as jH,Jge as jI,Jot as jJ,slt as jK,Yy as jL,elt as jM,Nht as jN,L3e as jO,kht as jP,k3e as jQ,$ht as jR,Pht as jS,Fht as jT,V3e as jU,vSe as jV,Zt as jW,qi as jX,O as jY,Ru as jZ,uf as j_,cdt as ja,qSe as jb,gre as jc,DS as jd,n6 as je,R_e as jf,B_e as jg,rP as jh,bat as ji,tot as jj,yt as jk,oP as jl,ree as jm,Mx as jn,G9 as jo,rne as jp,Qa as jq,xne as jr,qge as js,nV as jt,Zlt as ju,qlt as jv,zde as jw,k as jx,cat as jy,AS as jz,Jf as k,lot as k$,eK as k0,Ro as k1,Qot as k2,X0e as k3,eP as k4,yat as k5,CT as k6,$pe as k7,zZe as k8,nmt as k9,ZMe as kA,Mk as kB,_D as kC,UXe as kD,RAe as kE,Kz as kF,li as kG,mV as kH,Nn as kI,wy as kJ,TOe as kK,vYe as kL,zJe as kM,NJe as kN,eee as kO,aYe as kP,tat as kQ,Fae as kR,L0 as kS,PRe as kT,A$e as kU,Bft as kV,Npt as kW,aNe as kX,uH as kY,Hg as kZ,aot as k_,sy as ka,Hb as kb,T6 as kc,$y as kd,wEe as ke,wA as kf,LJe as kg,T$e as kh,bAe as ki,PV as kj,eT as kk,b6 as kl,L6 as km,eat as kn,XX as ko,fQ as kp,t6 as kq,Xot as kr,c9 as ks,Nie as kt,TA as ku,YEe as kv,qg as kw,vpt as kx,M5e as ky,Cle as kz,Q as l,blt as l$,oot as l0,pve as l1,hIe as l2,RJe as l3,rIe as l4,oIe as l5,YX as l6,Bdt as l7,W0e as l8,Tie as l9,$V as lA,Jb as lB,Ke as lC,Ek as lD,I$ as lE,uyt as lF,wZe as lG,CWe as lH,Yde as lI,ayt as lJ,NWe as lK,XJe as lL,gpe as lM,yee as lN,P2 as lO,jbe as lP,ol as lQ,Ylt as lR,bdt as lS,vdt as lT,DV as lU,HE as lV,vr as lW,Z2 as lX,RRe as lY,Xmt as lZ,Ilt as l_,Gdt as la,eo as lb,Af as lc,aAe as ld,EV as le,ed as lf,bYe as lg,oYe as lh,Gat as li,Z1e as lj,eXe as lk,W2 as ll,Qpe as lm,_We as ln,fgt as lo,Rn as lp,lt as lq,mD as lr,vWe as ls,vXe as lt,Zbe as lu,IAe as lv,Qgt as lw,Kf as lx,dAe as ly,pAe as lz,Vo as m,nee as m$,xlt as m0,wlt as m1,Slt as m2,va as m3,sxe as m4,zae as m5,Vae as m6,A5e as m7,Lge as m8,q$e as m9,gpt as mA,ypt as mB,mpt as mC,zXe as mD,zu as mE,AXe as mF,vfe as mG,pat as mH,nD as mI,bZe as mJ,tb as mK,byt as mL,Lgt as mM,sCe as mN,Xf as mO,kAe as mP,TAe as mQ,Kbe as mR,S6 as mS,vee as mT,eZe as mU,r0t as mV,tr as mW,Cy as mX,Cpe as mY,vyt as mZ,kbe as m_,QOe as ma,J2 as mb,$gt as mc,Hde as md,_gt as me,vgt as mf,Egt as mg,Cgt as mh,Mpe as mi,wyt as mj,KJe as mk,dyt as ml,kgt as mm,eLe as mn,Dlt as mo,RTe as mp,Idt as mq,ci as mr,UPe as ms,vB as mt,MV as mu,Sge as mv,rlt as mw,Zat as mx,swe as my,owe as mz,Qn as n,XAe as n$,iee as n0,HLe as n1,C2 as n2,bie as n3,nd as n4,X7e as n5,fat as n6,mat as n7,hpt as n8,Agt as n9,QN as nA,e4 as nB,FA as nC,bO as nD,jNe as nE,aVe as nF,Jft as nG,cft as nH,t4e as nI,PVe as nJ,Wy as nK,Vft as nL,yce as nM,wq as nN,Sq as nO,nFe as nP,AH as nQ,Mj as nR,i0e as nS,YNe as nT,hse as nU,Cu as nV,LP as nW,Yre as nX,Xre as nY,VAe as nZ,Aut as n_,Mgt as na,PZ as nb,X$e as nc,K$e as nd,W$e as ne,WSe as nf,VJ as ng,xse as nh,Y_ as ni,ght as nj,nat as nk,Jy as nl,u0 as nm,Ppt as nn,qy as no,HM as np,wDe as nq,Ac as nr,kpt as ns,GNe as nt,nft as nu,oVe as nv,gat as nw,t1 as nx,yd as ny,UNe as nz,yht as o,Uce as o$,$ut as o0,mft as o1,fft as o2,Lo as o3,mce as o4,dft as o5,pft as o6,NH as o7,Fpt as o8,hft as o9,evt as oA,Y0t as oB,X0t as oC,K0t as oD,Q0t as oE,tvt as oF,mWe as oG,u_ as oH,Mc as oI,Sk as oJ,dat as oK,hat as oL,q8 as oM,$ne as oN,UWe as oO,rCe as oP,epe as oQ,hmt as oR,NP as oS,Rct as oT,nvt as oU,o2 as oV,dmt as oW,pmt as oX,Q6 as oY,fmt as oZ,LO as o_,$j as oa,Ore as ob,PP as oc,ub as od,QS as oe,fu as of,lNe as og,Xoe as oh,MLe as oi,tj as oj,Koe as ok,Phe as ol,CLe as om,zGe as on,FLe as oo,zLe as op,VLe as oq,gR as or,GZ as os,ivt as ot,Vu as ou,kk as ov,q0t as ow,W0t as ox,J0t as oy,Z0t as oz,HP as p,SH as p$,gmt as p0,m8e as p1,h8e as p2,mmt as p3,Fce as p4,a8e as p5,fSe as p6,x8e as p7,rgt as p8,jV as p9,ngt as pA,Dct as pB,fhe as pC,Dr as pD,WRe as pE,Df as pF,hQ as pG,zat as pH,G1e as pI,clt as pJ,Hat as pK,$6 as pL,Oee as pM,H1e as pN,cwe as pO,Q1e as pP,Vat as pQ,Jat as pR,b$e as pS,Upt as pT,eft as pU,Ypt as pV,Zpt as pW,Xpt as pX,Kpt as pY,xH as pZ,TH as p_,Uh as pa,jce as pb,bmt as pc,lA as pd,uA as pe,F2 as pf,lxe as pg,Zje as ph,cmt as pi,Imt as pj,umt as pk,vmt as pl,_mt as pm,I8e as pn,Vce as po,ymt as pp,xmt as pq,wmt as pr,Smt as ps,Tmt as pt,eGe as pu,wie as pv,xie as pw,GS as px,coe as py,qh as pz,OAe as q,IWe as q$,Wpt as q0,Jpt as q1,gP as q2,HA as q3,Hpt as q4,qpt as q5,Xat as q6,Qpt as q7,uNe as q8,hNe as q9,nP as qA,xP as qB,yV as qC,KS as qD,got as qE,sct as qF,A6 as qG,pyt as qH,pIe as qI,uIe as qJ,t1e as qK,aIe as qL,QYe as qM,ni as qN,DJe as qO,qat as qP,ek as qQ,f7 as qR,AZe as qS,Fyt as qT,vC as qU,Sct as qV,UJe as qW,fyt as qX,wIe as qY,eyt as qZ,cIe as q_,xle as qa,Gpt as qb,dNe as qc,R6 as qd,fy as qe,wXe as qf,zlt as qg,U2 as qh,n0t as qi,xWe as qj,bl as qk,i0t as ql,Fr as qm,Qlt as qn,rct as qo,yWe as qp,Flt as qq,g7 as qr,hK as qs,CZe as qt,Nlt as qu,hyt as qv,tCe as qw,nlt as qx,m7 as qy,Yf as qz,Gut as r,bct as r$,myt as r0,DIe as r1,hee as r2,xIe as r3,gl as r4,SAe as r5,pee as r6,fa as r7,eA as r8,i1e as r9,WS as rA,jdt as rB,Rne as rC,AAe as rD,s_e as rE,olt as rF,E6 as rG,RIe as rH,jEe as rI,Iut as rJ,pgt as rK,DOe as rL,vP as rM,XS as rN,YS as rO,Gb as rP,iae as rQ,OSe as rR,kdt as rS,e0t as rT,GSe as rU,HSe as rV,cct as rW,nct as rX,Cge as rY,dTe as rZ,tct as r_,CIe as ra,Tgt as rb,Fre as rc,wgt as rd,Sgt as re,$ot as rf,Gp as rg,nO as rh,OS as ri,not as rj,Igt as rk,kyt as rl,Cb as rm,Pyt as rn,Bo as ro,Pot as rp,$ye as rq,IIe as rr,tZe as rs,Bat as rt,jat as ru,X1e as rv,KOe as rw,lIe as rx,HS as ry,qS as rz,ne as s,_ct as s0,JSe as s1,rot as s2,Qyt as s3,mCe as s4,Xyt as s5,U0e as s6,Xlt as s7,Qat as s8,oct as s9,pD as sA,Fot as sB,MI as sC,Kyt as sD,iD as sE,Jyt as sF,Fat as sG,yP as sH,a0 as sI,yhe as sJ,tgt as sK,AR as sL,ilt as sM,KF as sN,yyt as sO,tlt as sP,x_e as sQ,kct as sR,c0 as sS,gdt as sT,Wdt as sU,Apt as sV,emt as sW,TZ as sX,ict as sa,tIe as sb,Jlt as sc,CNe as sd,lTe as se,gIe as sf,cCe as sg,khe as sh,Kst as si,Xst as sj,gyt as sk,nZe as sl,Lyt as sm,Klt as sn,hct as so,hb as sp,Jde as sq,Vre as sr,so as ss,Pat as st,yAe as su,RWe as sv,SZe as sw,NYe as sx,pb as sy,JMe as sz,kLe as t,Of as u,QK as v,on as w,L2 as x,But as y,ee as z};
